arXiv:1111.3660v1  [math.AG]  15 Nov 2011
POSITROID VARIETIES: JUGGLING AND GEOMETRY
ALLEN KNUTSON, THOMAS LAM, AND DAVID E SPEYER
ABSTRACT. While the intersection of the Grassmannian Bruhat decompositions for all co-
ordinate ﬂags is an intractable mess, the intersection of only the cyclic shifts of one Bruhat
decomposition turns out to have many of the good properties of the Bruhat and Richardson
decompositions.
This decomposition coincides with the projection of the Richardson stratiﬁcation of the
ﬂag manifold, studied by Lusztig, Rietsch, Brown-Goodearl-Yakimov and the present au-
thors. However, its cyclic-invariance is hidden in this description. Postnikov gave many
cyclic-invariant ways to index the strata, and we give a new one, by a subset of the afﬁne
Weyl group we call bounded juggling patterns. We call the strata positroid varieties.
Applying results from [KnLamSp], we show that positroid varieties are normal, Cohen-
Macaulay, have rational singularities, and are deﬁned as schemes by the vanishing of
Pl¨ucker coordinates. We prove that their associated cohomology classes are represented
by afﬁne Stanley functions. This latter fact lets us connect Postnikov’s and Buch-Kresch-
Tamvakis’ approaches to quantum Schubert calculus.
CONTENTS
1.
Introduction, and statement of results
1
2.
Some combinatorial background
7
3.
Afﬁne permutations, juggling patterns and positroids
9
4.
Background on Schubert and Richardson varieties
19
5.
Positroid varieties
20
6.
Examples of positroid varieties
27
7.
The cohomology class of a positroid variety
28
8.
Quantum cohomology, toric Schur functions, and positroids
35
References
41
1. INTRODUCTION, AND STATEMENT OF RESULTS
1.1. Some decompositions of the Grassmannian. This paper is concerned with the geo-
metric properties of a stratiﬁcation of the Grassmannian studied in [Lus98, Pos, Rie06,
BroGooYa06, Wi07]. It ﬁts into a family of successively ﬁner decompositions:
{Bruhat cells}, {open Richardson varieties}, {open positroid varieties}, {GGMS strata}.
We discuss the three known ones in turn, and then see how the family of positroid vari-
eties ﬁts in between.
Date: November 17, 2011.
AK was partially supported by NSF grant DMS-0604708.
TL was partially supported by NSF grants DMS-0600677, DMS-0652641, and DMS-0901111, and by a
Sloan Fellowship.
DES was supported by a Research Fellowship from the Clay Mathematics Institute.
1

The Bruhat decomposition of the Grassmannian of k-planes in n-space dates back, despite
the name, to Schubert in the 19th century. It has many wonderful properties:
• the strata are easily indexed (by partitions in a k × (n −k) box)
• it is a stratiﬁcation: the closure (a Schubert variety) of one open stratum is a union
of others
• each stratum is smooth and irreducible (in fact a cell)
• although the closures of the strata are (usually) singular, they are not too bad: they
are normal and Cohen-Macaulay, and even have rational singularities.
The Bruhat decomposition is deﬁned relative to a choice of coordinate ﬂag, essentially
an ordering on the basis elements of n-space. The Richardson decomposition is the common
reﬁnement of the Bruhat decomposition and the opposite Bruhat decomposition, using the
opposite order on the basis. Again, many excellent properties hold for this ﬁner decom-
position:
• it is easy to describe the nonempty intersections of Bruhat and opposite Bruhat
strata (they correspond to nested pairs of partitions)
• it is a stratiﬁcation, each open stratum is smooth and irreducible, and their closures
are normal and Cohen-Macaulay with rational singularities [Bri02].
At this point one might imagine intersecting the Bruhat decompositions relative to all
the coordinate ﬂags, so as not to prejudice one over another. This gives the GGMS decom-
position of the Grassmannian [GeGorMacSe87], and as it turns out, these good intentions
pave the road to Hell:
• it is infeasible to index the nonempty strata [Va78]
• it is not a stratiﬁcation [GeGorMacSe87, §5.2]
• the strata can have essentially any singularity [Mn88]. In particular, the nonempty
ones need not be irreducible, or even equidimensional.
This raises the question: can one intersect more than two permuted Bruhat decomposi-
tions, keeping the good properties of the Bruhat and Richardson decompositions, without
falling into the GGMS abyss?
The answer is yes: we will intersect the n cyclic permutations of the Bruhat decompo-
sition. That is to say, we will deﬁne an open positroid variety to be an intersection of n
Schubert cells, taken with respect to the the n cyclic rotations of the standard ﬂag. We
will deﬁne a positroid variety to be the closure of an open positroid variety. See section 5
for details.
It is easy to show, though not immediately obvious, that this reﬁnes the Richardson
decomposition. It is even less obvious, though also true, that the open positroid varieties
are smooth and irreducible (as we discuss in Section 5.4).
There is a similar decomposition for any partial ﬂag manifold G/P, the projection of
the Richardson stratiﬁcation from G/B. That decomposition arises in the study of several
seemingly independent structures:
• total nonnegativity, in e.g. [Lus98, Pos, Rie06], see §1.2;
• prime ideals in noncommutative deformations of G/P (though worked out only
for the Grassmannian, in [LauLeRig08]), and a semiclassical version thereof in
Poisson geometry [BroGooYa06, GooYa];
• the characteristic p notion of Frobenius splitting ([KnLamSp]).
2

We show that the positroid stratiﬁcation and the projected Richardson stratiﬁcation
coincide. Speciﬁcally, we prove:
Theorem (Theorem 5.9). If Xw
u is a Richardson variety in the full ﬂag manifold (u, w ∈Sn), then
its image under projection to Gr(k, n) is a positroid variety. If w is required to be a Grassmannian
permutation, then every positroid variety arises uniquely this way.
Theorem 5.9 has been suspected, but has not previously been proved in print, and is
surprisingly difﬁcult in its details. This result was already known on the positive part of
Gr(k, n), as we explain in Remark 1.2.
Once we know that positroid varieties are projected Richardson varieties, the follow-
ing geometric properties follow from the results of [KnLamSp]. Part (1) of the following
Theorem was also established by Billey and Coskun [BiCo] for projected Richardson va-
rieties.
Theorem ([KnLamSp] and Theorem 5.15).
(1) Positroid varieties are normal and Cohen-Macaulay, with rational singularities.
(2) Though positroid varieties are deﬁned as the closure of the intersection of n cyclically per-
muted Bruhat cells, they can also be deﬁned (even as schemes) as the intersection of the n
cyclically permuted Schubert varieties. In particular, each positroid variety is deﬁned as a
scheme by the vanishing of some Pl¨ucker coordinates.
Theorem ([KnLamSp]). The standard Frobenius spliting on the Grassmannian compatibly splits
all positroid varieties. Furthermore, positroid varieties are exactly the compatibly split subvarieties
of the Grassmannian.
Before going on, we mention a very general construction given two decompositions
{Ya}a∈A,{Zb}b∈B of a scheme X, one reﬁning the other. Assume that
• X = `
A Ya = `
B Zb,
• for each a ∈A, there exists a subset Ba ⊆B such that Ya = `
Ba Zb,
• each Ya is irreducible (hence nonempty), and each Zb is nonempty. (We do not
assume that each Zb is irreducible.)
Then there is a natural surjection B ։ A taking b to the unique a such that Zb ⊆Ya,
and a natural inclusion A ֒→B taking a to the unique b ∈Ba such that Zb is open in
Ya. (Moreover, the composite A ֒→B ։ A is the identity.) We will call the map B ։ A
the A-envelope, and will generally use the inclusion A ֒→B to identify A with its image.
Post this identiﬁcation, each a ∈A corresponds to two strata Ya, Za, and we emphasize
that these are usually not equal; rather, one only knows that Ya contains Za densely.
To each GGMS stratum X, one standardly associates the set of coordinate k-planes that
are elements of X, called the matroid of X. (While “matroid” has many simple deﬁnitions,
this is not one of them; only realizable matroids arise this way, and characterizing them
is essentially out of reach [Va78].) It is a standard, and easy, fact that the matroid charac-
terizes the stratum, so via the A ֒→B yoga above, we can index the strata in the Schubert,
Richardson, and positroid decompositions by special classes of matroids. Schubert ma-
troids have been rediscovered many times in the matroid literature (and renamed each
time; see [BoDM06]). Richardson matroids are known as lattice path matroids [BoDM06].
The matroids associated to the open positroid varieties are exactly the positroids [Pos]
(though Postnikov’s original deﬁnition was different, and we give it in the next section).
3

In our context, the observation two paragraphs above says that if a matroid M is a
positroid, then the positroid stratum of M is usually not the GGMS stratum of M, but
only contains it densely.
Remark 1.1. For each positroid M, Postnikov gives many parametrizations by Rℓ
+ of the
totally nonnegative part (whose deﬁnition we will recall in the next section) of the GGMS
stratum of M. Each parametrization extends to a rational map (C×)ℓ→Gr(k, n); if we
use the parametrization coming (in Postnikov’s terminology) from the Le-diagram of M
then this map is well deﬁned on all of (C×)ℓ. The image of this map is neither the GGMS
stratum nor the positroid stratum of M (although the nonnegative parts of all three coin-
cide). For example, if (k, n) = (2, 4) and M is the “uniform” matroid in which any two
elements of [4] are independent, this parametrization is
(a, b, c, d) 7→(p12 : p13 : p14 : p23 : p24 : p34) = (1 : d : cd : bd : (a + 1)bcd : abcd2).
The image of this map is the open set where p12, p13, p14, p23 and p34 are nonzero. It is
smaller than the positroid stratum, where p13 can be zero. The image is larger than the
GGMS stratum, where p24 is also nonzero.
One may regard this, perhaps, as evidence that matroids are a philosophically incorrect
way to index the strata. We shall see another piece of evidence in Remark 5.17.
1.2. Juggling patterns, afﬁne Bruhat order, and total nonnegativity. We now give a low-
brow description of the decomposition we are studying, from which we will see a natural
indexing of the strata.
Start with a k × n matrix M of rank k (≤n), and think of it as a list of column vectors
⃗v1, . . .,⃗vn. Extend this to an inﬁnite but repeating list . . . ,⃗v−1,⃗v0,⃗v1, . . . ,⃗vn,⃗vn+1, . . . where
⃗vi = ⃗vj if i ≡j mod n. Then deﬁne a function f : Z →Z by
f(i) = min {j ≥i : ⃗vi ∈span({⃗vi+1,⃗vi+2, . . .,⃗vj)}
Since ⃗vn+i = ⃗vi, each f(i) ≤n + i, and each f(i) ≥i with equality only if ⃗vi = ⃗0. It is fun to
prove that f must be 1 : 1, and has enough ﬁniteness to then necessarily be onto as well.
Permutations of Z satisfying f(i +n) = f(i) +n ∀i are called afﬁne permutations, and the
group thereof can be identiﬁed with the afﬁne Weyl group of GLn (see e.g. [EhRe96]).
This association of an afﬁne permutation to each k × n matrix of rank k depends only
on the k-plane spanned by the rows, and so descends to Gr(k, n), where it provides a
complete combinatorial invariant of the strata in the cyclic Bruhat decomposition.
Theorem (Theorem 3.16, Corollary 3.17). 1 This map from the set of positroid strata to the
afﬁne Weyl group is order-preserving, with respect to the closure order on positroid strata (Post-
nikov’s cyclic Bruhat order) and the afﬁne Bruhat order, and identiﬁes the set of positroids with
a downward Bruhat order ideal.
Consequently, the cyclic Bruhat order is Eulerian and EL-shellable (as shown by hand already
in [Wi07]).
We interpret these f physically as follows. Consider a juggler who is juggling k balls,
one throw every second, doing a pattern of period n. At time i ∈Z, they throw a ball
1This result is extended to projected Richardson varieties in partial ﬂag varieties G/P of arbitrary type
by He and Lam [HeLa].
4

that lands shortly2 before, to be thrown again at, time f(i). No two balls land at the same
time, and there is always a ball available for the next throw. If we let ti = f(i) −i be the
throw at time i, this cyclic list of n numbers (t1, . . . , tn) is a juggling pattern3 or siteswap (for
which our references are [Pol03, Kn93]; see also [BuEiGraWr94, EhRe96, War05, ChGra07,
ChGra08]). This mathematical model of juggling was developed by several groups of
jugglers independently in 1985, and is of great practical use in the juggling community.
If M is generic, then the pattern is the lowest-energy pattern, where every throw is a
k-throw.4 At the opposite extreme, imagine that M only has entries in some k columns.
Then n −k of the throws are 0-throws, and k are n-throws.5
If one changes the cyclic action slightly, by moving the ﬁrst column to the end and mul-
tiplying it by (−1)k−1, then one preserves the set of real matrices for which every k × k
submatrix has nonnegative determinant. This, by deﬁnition, lies over the totally non-
negative part Gr(k, n)≥0 of the Grassmannian. (This action may have period either n or
2n up on matrices, but it always has period n down on the Grassmannian.) Postnikov’s
motivation was to describe those matroids whose GGMS strata intersect this totally non-
negative part; it turns out that they are exactly the positroids, and the totally nonnegative
part of each open positroid stratum is homeomorphic to a ball.
Remark 1.2. Now that we have deﬁned the totally nonnegative part of the Grassmannian,
we can explain the antecedents to Theorem 5.9. Postnikov ([Pos]) deﬁned the totally
nonnegative part of the Grassmannian as we have done above, by nonnegativity of all
minors. Lusztig ([Lus98]) gave a different deﬁnition which applied to any G/P. That the
two notions agree is not obvious, and was established in [Rie09]. In particular, the cyclic
symmetry seems to be special to Grassmannians.6
Lusztig, using his deﬁnition, gave a stratiﬁcation of (G/P)≥0 by the projections of Richard-
son varieties. Theorem 3.8 of [Pos] (which relies on the results of [MarRie04] and [RieWi08])
states that Postnikov’s and Lusztig’s stratiﬁcations of Gr(k, n)≥0 coincide. This result says
nothing about how the stratiﬁcations behave away from the totally nonnegative region.
Theorem 5.9 can be thought of as a complex analogue of [Pos, Theorem 3.8]; it implies but
does not follow from [Pos, Theorem 3.8].
We thank Konni Rietsch for helping us to understand the connections between these
results.
1.3. Afﬁne permutations, and the associated cohomology class of a positroid variety.
Given a subvariety X of a Grassmannian, one can canonically associate a symmetric poly-
nomial in k variables, in a couple of equivalent ways:
(1) Sum, over partitions λ with |λ| = codim X, the Schur polynomial Sλ(x1, . . . , xk)
weighted by the number of points of intersection of X with a generic translate
2almost exactly at time f(i) −1
2, according to video analysis of competent jugglers
3Not every juggling pattern arises this way; the patterns that arise from matrices can only have throws
of height ≤n. This bound is very unnatural from the juggling point of view, as it excludes the standard
3-ball cascade (t1 = 3) with period n = 1.
4These juggling patterns are called “cascades” for k odd and “(asynchronous) fountains” for k even.
5These are not the most excited k-ball patterns of length n; those would each have a single kn-throw, all
the others being 0-throws. But juggling patterns associated to matrices must have each ti ≤n.
6Milen Yakimov has proven the stronger result that the standard Poisson structure on Gr(k, n), from
which the positroid stratiﬁcation can be derived, is itself cyclic-invariant [Ya10].
5

of Xλc (the Schubert variety associated to the complementary partition inside the
k × (n −k) rectangle).
(2) Take the preimage of X in the Stiefel manifold of k × n matrices of rank k, and the
closure X inside k × n matrices. (In the k = 1 case this is the afﬁne cone over a
projective variety, and it seems worth it giving the name “Stiefel cone” in general.)
This has a well-deﬁned class in the equivariant Chow ring A∗
GL(k)(Ck×n), which is
naturally the ring of symmetric polynomials in k variables.
The most basic case of X is a Schubert variety Xλ, in which case these recipes give the
Schur polynomial Sλ. More generally, the ﬁrst construction shows that the symmetric
polynomial must be “Schur-positive”, meaning a positive sum of Schur polynomials.
In reverse, one has ring homomorphisms
{symmetric functions} ։ Z[x1, . . ., xk]Sk ∼= A∗
GL(k)(Ck×n) ։ A∗
GL(k)(Stiefel) ∼= A∗(Gr(k, n))
and one can ask for a symmetric function f whose image is the class [X].
Theorem (Theorem 7.17). The cohomology class associated to a positroid variety can be repre-
sented by the afﬁne Stanley function of its afﬁne permutation, as deﬁned in [Lam06].
This is a surprising result in that afﬁne Stanley functions are not Schur-positive in gen-
eral, even for this restricted class of afﬁne permutations. Once restricted to the variables
x1, . . ., xk, they are! In Theorem 7.12 we give a much stronger abstract positivity result,
for positroid classes in T-equivariant K-theory.
Our proof of Theorem 7.1 is inductive. In future work, we hope to give a direct geomet-
ric proof of this and Theorem 3.16, by embedding the Grassmannian in a certain subquo-
tient of the afﬁne ﬂag manifold, and realizing the positroid decomposition as the trans-
verse pullback of the afﬁne Bruhat decomposition.
1.4. Quantum cohomology and toric Schur functions. In [BucKresTam03], Buch, Kresch,
and Tamvakis related quantum Schubert calculus on Grassmannians to ordinary Schubert
calculus on 2-step partial ﬂag manifolds. In [Pos05], Postnikov showed that the structure
constants of the quantum cohomology of the Grassmannian were encoded in symmetric
functions he called toric Schur polynomials. We connect these ideas to positroid varieties:
Theorem (Theorem 8.1). Let S ⊂Gr(k, n) be the union of all genus-zero stable curves of degree
d which intersect a ﬁxed Schubert variety X and opposite Schubert variety Y. Suppose there
is a non-trivial quantum problem associated to X, Y and d. Then S is a positroid variety: as a
projected Richardson variety it is obtained by a pull-push from the 2-step ﬂag variety considered
in [BucKresTam03]. Its cohomology class is given by the toric Schur polynomial of [Pos05].
The last statement of the theorem is consistent with the connection between afﬁne Stan-
ley symmetric functions and toric Schur functions (see [Lam06]).
7 Snider [Sni10] has given a direct geometric explanation of this result by identifying afﬁne patches on
Gr(k, n) with opposite Bruhat cells in the afﬁne ﬂag manifold, in a way that takes the positroid stratiﬁcation
to the Bruhat decomposition. Also, an analogue of this result for projected Richardson varieties in an
arbitrary G/P is established by He and Lam [HeLa]: the connection with symmetric functions is absent, but
the cohomology classes of projected Richardson varieties and afﬁne Schubert varieties are compared via
the afﬁne Grassmannian.
6

Acknowledgments. Our primary debt is of course to Alex Postnikov, for getting us ex-
cited about positroids. We also thank Michel Brion, Leo Mihalcea, Su-Ho Oh, Konni Ri-
etsch, Frank Sottile, Ben Webster, Lauren Williams, and Milen Yakimov for useful conver-
sations.
2. SOME COMBINATORIAL BACKGROUND
Unless otherwise speciﬁed, we shall assume that nonnegative integers k and n have
been ﬁxed, satisfying 0 ≤k ≤n.
2.1. Conventions on partitions and permutations. For integers a and b, we write [a, b]
to denote the interval {a, a + 1, . . ., b}, and [n] to denote the initial interval {1, 2, . . ., n}. If
i ∈Z, we let ¯i ∈[n] be the unique integer satisfying i ≡¯i mod n. We write
 S
k

for the set
of k-element subsets of S. Thus
 [n]
k

denotes the set of k-element subsets of {1, 2, . . ., n}.
As is well known, there is a bijection between
 [n]
k

and the partitions of λ contained in
a k × (n −k) box. There are many classical objects, such as Schubert varieties, which can
be indexed by either of these
 n
k

-element sets. We will favor the indexing set
 [n]
k

, and
will only discuss the indexing by partitions when it becomes essential, in §7.
We let Sn denote the permutations of the set [n]. A permutation w ∈Sn is written in
one-line notation as [w(1)w(2) · · ·w(n)]. Permutations are multiplied from right to left
so that if u, w ∈Sn, then (uw)(i) = u(w(i)). Thus multiplication on the left acts on
values, and multiplication on the right acts on positions. Let w ∈Sn be a permutation.
An inversion of w is a pair (i, j) ∈[n] × [n] such that i < j and w(i) > w(j). The length
ℓ(w) of a permutation w ∈Sn is the number of its inversions. A factorization w = uv is
called length-additive if ℓ(w) = ℓ(u) + ℓ(v).
The longest element [n(n −1) · · ·1] of Sn is denoted w0. The permutation [234 · · ·n1]
is denoted χ (for Coxeter element). As a Coxeter group, Sn is generated by the simple
transpositions {si = [12 · · ·(i −1)(i + 1)i(i + 2) · · ·n]}.
For k ∈[0, n], we let Sk × Sn−k ⊆Sn denote the parabolic subgroup of permutations
which send [k] to [k] and [k + 1, n] to [k + 1, n]. A permutation w ∈Sn is called Grass-
mannian (resp. anti-Grassmannian) if it is minimal (resp. maximal) length in its coset
w(Sk × Sn−k); the set of such permutations is denoted Smin
n,k (resp. Smax
n,k ).
If w ∈Sn and k ∈[0, n], then σk(w) ∈
 [n]
k

denotes the set w([k]). Often, we just write σ
for σk when no confusion will arise. The map σk : Sn →
 [n]
k

is a bijection when restricted
to Smin
n,k .
2.2. Bruhat order and weak order. We deﬁne a partial order ≤on
 [n]
k

as follows. For
I = {i1 < i2 < · · · < ik} and J = {j1 < j2 · · · < jk} ∈
 [n]
k

, we write I ≤J if ir ≤jr for r ∈[k].
We shall denote the Bruhat order, also called the strong order, on Sn by ≤and ≥. One
has the following well known criterion for comparison in Bruhat order: if u, w ∈Sn then
u ≤w if and only if u([k]) ≤w([k]) for each k ∈[n]. Covers in Bruhat order will be
denoted by ⋖and ⋗. The map σk : (Smin
n,k , ≤) →
 [n]
k

, ≤

is a poset isomorphism.
The (left) weak order ≤weak on Sn is the transitive closure of the relations
w ≤weak siw if ℓ(siw) = ℓ(w) + 1.
The weak order and Bruhat order agree when restricted to Smin
n,k .
7

2.3. k-Bruhat order and the poset Q(k, n). The k-Bruhat order [BeSo98, LasSch¨u82] ≤k
on Sn is deﬁned as follows. Let u and w be in Sn. Then u k-covers w, written u ⋗k w,
if and only if u ⋗w and σk(u) ̸= σk(w). The k-Bruhat order is the partial order on Sn
generated by taking the transitive closure of these cover relations (which remain cover
relations). We let [u, w]k ⊂Sn denote the interval of Sn in k-Bruhat order. It is shown in
[BeSo98] that every interval [u, w]k in (Sn, ≤k) is a graded poset with rank ℓ(w)−ℓ(u). We
have the following criterion for comparison in k-Bruhat order.
Theorem 2.1 ([BeSo98, Theorem A]). Let u, w ∈Sn. Then u ≤k w if and only if
(1) 1 ≤a ≤k < b ≤n implies u(a) ≤w(a) and u(b) ≥w(b).
(2) If a < b, u(a) < u(b), and w(a) > w(b), then a ≤k < b.
Deﬁne an equivalence relation on the set of k-Bruhat intervals, generated by the re-
lations that [u, w]k ∼[x, y]k if there is a z ∈Sk × Sn−k so that we have length-additive
factorizations uz = x and wz = y. If u ≤k w, we let ⟨u, w⟩denote the equivalence class
containing [u, w]k. Let Q(k, n) denote the equivalence classes of k-Bruhat intervals.
We discuss this construction in greater generality in [KnLamSp, §2]. To obtain the cur-
rent situation, specialize the results of that paper to (W, WP) = (Sn, Sk ×Sn−k). The results
we describe here are all true in that greater generality.
Proposition 2.2. If [u1, w1] ∼[u2, w2] then u−1
1 u2 = w−1
1 w2 and this common ratio is in Sk ×
Sn−k. Also ℓ(w1) −ℓ(w2) = ℓ(u1) −ℓ(u2).
Proof. This is obvious for the deﬁning equivalences and is easily seen to follow for a chain
of equivalences.
□
We will prove a converse of this statement below as Proposition 2.4. The reader may
prefer this deﬁnition of ∼.
Proposition 2.3. Every equivalence class in Q(k, n) has a unique representative of the form
[u′, w′] where w′ is Grassmannian. If [u, w] is a k-Bruhat interval, and [u′, w′] is equivalent to
[u, w] with w′ Grassmannian, then we have length-additive factorizations u = u′z and w = w′z
with z ∈Sk × Sn−k.
Proof. See [KnLamSp, Lemma 2.4] for the existence of a representative of this form. If
[u′, w′] and [u′′, w′′] are two such representatives, then (w′)−1w′′ is in Sk × Sn−k and both
w′ and w′′ are Grassmannian, so w′ = w′′. Then (u′)−1u′′ = (w′)−1w′′ = e so u′ = u′′ and
we see that the representative is unique.
Finally, let [u′, w′] be the representative with w′ Grassmannian, and let [u, w] ∼[u′, w′].
Set z = (u′)−1u = (w′)−1w with z ∈Sk × Sn−k. Since w′ is Grassmannian, we have
ℓ(w) = ℓ(w′) + ℓ(z). Then the equation ℓ(w) −ℓ(w′) = ℓ(u) −ℓ(u′) from Proposition 2.2
shows that ℓ(u) = ℓ(u′) + ℓ(z) as well. So the products u = u′z and w = w′z are both
length-additive, as desired.
□
We can use this observation to prove a more computationally useful version of the
equivalence relation:
Proposition 2.4. Given two k-Bruhat intervals [u1, w1] and [u2, w2], we have [u1, w1] ∼[u2, w2]
if and only if u−1
1 u2 = w−1
1 w2 and common ratio lies in Sk × Sn−k.
8

Proof. The forward implication is Proposition 2.2. For the reverse implication, let [u1, w1]
and [u2, w2] be as stated. Let [u′
1, w′
1] and [u′
2, w′
2] be the representatives with w′
i Grass-
mannian. Since (w′
1)−1w′
2 is in Sk × Sn−k, and both w′
i are Grassmannian, then w′
1 = w′
2.
Since (u′
1)−1u′
2 = (w′
1)−1w′
2 = e, we deduce that u′
1 = u′
2. So [u1, w1] ∼[u′
1, w′
1] = [u′
2, w′
2] ∼
[u2, w2] and we have the reverse implication.
□
We also cite:
Theorem 2.5 ([BeSo98, Theorem 3.1.3]). If u ≤k w and x ≤k y with wu−1 = yx−1, then the
map v 7→vu−1x induces an isomorphism of graded posets [u, w]k →[x, y]k.
We equip Q(k, n) with a partial order ≤given by q′ ≤q if and only if there are repre-
sentatives [u, w]k ∈q and [u′, w′]k ∈q′ so that [u′, w′] ⊆[u, w]. This partial order was
studied by Rietsch [Rie06], see also [Wi07, GooYa].
The poset Q(2, 4) already has 33 elements; its Hasse diagram appears in [Wi07]. See
also Figure 1.
3. AFFINE PERMUTATIONS, JUGGLING PATTERNS AND POSITROIDS
Fix integers 0 ≤k ≤n. In this section, we will deﬁne several posets of objects and prove
that the posets are all isomorphic. We begin by surveying the posets we will consider.
The objects in these posets will index positroid varieties, and all of these indexing sets
are useful. All the isomorphisms we deﬁne are compatible with each other. Detailed
deﬁnitions, and the deﬁnitions of the isomorphisms, will be postponed until later in the
section.
We have already met one of our posets, the poset Q(k, n) from §2.3.
The next poset will be the poset Bound(k, n) of bounded afﬁne permutations: these are
bijections f : Z →Z such that f(i + n) = f(i) + n, i ≤f(i) ≤f(i) + n and (1/n) Pn
i=1(f(i) −
i) = k. After that will be the poset Jugg(k, n) of bounded juggling patterns. The elements
of this poset are n-tuples (J1, J2, . . ., Jn) ∈
 [n]
k
n such that Ji+1 ⊇(Ji \ {1}) −1, where the
subtraction of 1 means to subtract 1 from each element and our indices are cyclic modulo
n. These two posets are closely related to the posets of decorated permutations and of
Grassmann necklaces, considered in [Pos].
We next consider the poset of cyclic rank matrices. These are inﬁnite periodic matrices
which relate to bounded afﬁne permutations in the same way that Fulton’s rank matrices
relate to ordinary permutations. Finally, we will consider the poset of positroids. Intro-
duced in [Pos], these are matroids which obey certain positivity conditions.
The following is a combination of all the results of this section:
Theorem 3.1. The posets Q(k, n), Bound(k, n), Jugg(k, n), the poset of cylic rank matrices of
type (k, n) and the poset of positroids of rank k on [n] are all isomorphic.
The isomorphism between Bound(k, n) and cyclic rank matrices is Corollary 3.12; the
isomorphism between Jugg(k, n) and Bound(k, n) is Corollary 3.13; the isomorphism be-
tween Q(k, n) and Bound(k, n) is Theorem 3.16; the isomorphism between Jugg(k, n) and
positroids is Proposition 3.21.
9

3.1. Juggling states and functions. Deﬁne a (virtual) juggling state S ⊆Z as a subset
whose symmetric difference from −N := {i ≤0} is ﬁnite. (We will motivate this and other
juggling terminology below.) Let its ball number be |S ∩Z+| −|−N \ S|, where Z+ :=
{i > 0}. Ball number is the unique function on juggling states such that for S ⊇S′, the
difference in ball numbers is |S \ S′|, and −N has ball number zero.
Call a bijection f : Z →Z a (virtual) juggling function if for some (or equivalently,
any) t ∈Z, the set f ({i : i ≤t}) is a juggling state. It is sufﬁcient (but not necessary) that
{|f(i) −i| : i ∈Z} be bounded. Let G be the set of such functions: it is easy to see that G is
a group, and contains the element s+ : i 7→i + 1. Deﬁne the ball number of f ∈G as the
ball number of the juggling state f(−N), and denote it av(f) for reasons to be explained
later.
Lemma 3.2. av : G →Z is a group homomorphism.
Proof. We prove what will be a more general statement, that if S is a juggling state with
ball number b, and f a juggling function with ball number b′, then f(S) is a juggling state
with ball number b + b′. Proof: if we add one element to S, this adds one element to f(S),
and changes the ball numbers of S, f(S) by 1. We can use this operation and its inverse to
reduce to the case that S = −N, at which point the statement is tautological.
Now let f, g ∈G, and apply the just-proven statement to S = g(−N).
□
For any bijection f : Z →Z, let
st(f, t)
:=
{f(i) −t : i ≤t}
=
st(st
+fs−t
+ , 0)
and if f ∈G, call it the juggling state of f at time t. By the homomorphism property just
proven av(f) = av
 sk
+fs−k
+

, which says that every state of f ∈G has the same ball number
(“ball number is conserved”). The following lemma lets one work with juggling states
rather than juggling functions:
Lemma 3.3. Say that a juggling state T can follow a state S if T = {t}∪
 s−1
+ · S

, and t /∈s−1
+ ·S.
In this case say that a t-throw takes state S to state T.
Then a list (Si)i∈Z is the list of states of a juggling function iff Si+1 can follow Si for each i. In
this case the juggling function is unique.
Proof. If the (Si) arise from a juggling function f, then the condition is satisﬁed where the
element ti added to s−1
+ ·Si−1 is f(i)−i. Conversely, one can construct f as f(i) = i+ti.
□
In fact the ﬁniteness conditions on juggling states and permutations were not necessary
for the lemma just proven. We now specify a further ﬁniteness condition, that will bring
us closer to the true functions of interest.
Lemma 3.4. The following two conditions on a bijection f : Z →Z are equivalent:
(1) there is a uniform bound on |f(i) −i|, or
(2) there are only ﬁnitely many different st(f, i) visited by f.
If they hold, f is a juggling function.
Proof. Assume ﬁrst that f has only ﬁnitely many different states. By Lemma 3.3, we can
reconstruct the value of f(i) −i from the states Si, Si+1. So f(i) −i takes on only ﬁnitely
many values, and hence |f(i) −i| is uniformly bounded.
10

For the reverse, assume that |f(i) −i| < N for all i ∈Z. Then f(−N) ⊆{i < N},
and f(Z+) ⊆{i > −N}. Since f is bijective, we can complement the latter to learn that
f(−N) ⊇{i ≤−N}. So st(f, 0), and similarly each st(f, t), is trapped between {i ≤−N}
and {i < N}. There are then only 22N possibilities, all of which are juggling states.
□
In the next section we will consider juggling functions which cycle periodically through
a ﬁnite set of states.
Deﬁne the height of the juggling state S ⊆Z as
ht(S) :=
X
i∈S∩Z+
i −
X
i∈−N\S
i,
a sort of weighted ball number. We can now motivate the notation av(f), computing ball
number as an average:
Lemma 3.5. Let a, b ∈Z, a ≤b and let f ∈G. Then
b
X
i=a+1
(f(i) −i) = (b −a) av(f) + ht(st(f, b)) −ht(st(f, a)).
In particular, if f satisﬁes the conditions of Lemma 3.4, then for any a ∈Z,
lim
b→∞
1
b −a
b
X
i=a+1
(f(i) −i) = av(f).
This equality also holds without taking the limit, if st(f, a) = st(f, b).
Proof. It is enough to prove the ﬁrst statement for b = a + 1, and add the b −a many
equations together. They are of the form
f(a + 1) −(a + 1) = av(f) + ht(st(f, a + 1)) −ht(st(f, a)).
To see this, start with S = st(f, a), and use f(a + 1) to calculate st(f, a + 1). The three sets
to consider are
S
=
f({i ≤a}) shifted left by a
S′
=
f({i ≤a}) shifted left by a + 1
st(f, a + 1)
=
f({i ≤a + 1}) shifted left by a + 1
By its deﬁnition, ht(S′) = ht(S) −av(f). And ht(st(f, a + 1)) = ht(S′) + f(a + 1) −(a + 1).
The equation follows.
For the second, if f only visits ﬁnitely many states then the difference in heights is
bounded, and dividing by b −a kills this term in the limit.
□
We now motivate these deﬁnitions from a juggler’s point of view. The canonical ref-
erence is [Pol03], though our setting above is more general than considered there. All
of these concepts originated in the juggling community in the years 1985-1990, though
precise dates are difﬁcult to determine.
Consider a idealized juggler who is juggling with one hand8, making one throw every
second, of exactly one ball at a time, has been doing so since the beginning of time and
8or as is more often assumed, rigidly alternating hands
11

will continue until its end. If our juggler is only human (other than being immortal) then
there will be a limit on how high the throws may go.
Assume at ﬁrst that the hand is never found empty when a throw is to be made. The
history of the juggler can then be recorded by a function
f(t) = the time that a ball thrown at time t is next thrown.
The number f(t) −t is usually called the throw at time t. If ever the juggler does ﬁnd the
hand empty i.e. all the balls in the air, then of course the juggler must wait one second for
the balls to come down. This is easily incorporated by taking f(t) = t, a 0-throw.
While these assumptions imply that f is a juggling function, they would also seem to
force the conclusion that f(i) ≥i, i.e. that balls land after they are thrown. Assuming that
for a moment, it is easy to compute the number of balls being juggled in the permutation
f: at any time t, count how many balls were thrown at times {i ≤t} that are still in the
air, f(i) > t. This is of course our formula for the ball number, in this special case. The
formula av(f) = av(st
+fs−t
+ ) then says that balls are neither created nor destroyed.
The state of f ∈G at time t is the set of times in the future (of t) that balls in the air
are scheduled to land. (This was introduced to study juggling by the ﬁrst author and,
independently, by Jack Boyce, in 1988.) The “height” of a state does not seem to have
been considered before.
Thus, the sub-semigroup of G where f(t) ≥t encodes possible juggling patterns. Since
we would like to consider G as a group (an approach pioneered in [EhRe96]), we must
permit f(t) < t. While it may seem fanciful to view this as describing juggling with
antimatter, the “Dirac sea” interpretation of antimatter is suggestive of the connection
with the afﬁne Grassmannian.
3.2. Afﬁne permutations. Let ˜Sn denote the group of bijections, called afﬁne permuta-
tions, f : Z →Z satisfying
f(i + n) = i + n for all i ∈Z.
Plainly this is a subgroup of G. This group ﬁts into an exact sequence
1 →Zn
t−→˜Sn ։ Sn →1
where for µ = (µ1, . . ., µn) ∈Zn, we deﬁne the translation element tµ ∈˜Sn by tµ(i) =
nµi+i for 1 ≤i ≤n. The map ˜Sn ։ Sn is evident. We can give a splitting map Sn →˜Sn by
extending a permutation π : [n] →[n] periodically. By this splitting, we have ˜Sn ≃Sn⋉Zn,
so every f ∈˜Sn can be uniquely factorized as f = w tµ with w ∈Sn and µ ∈Zn.
An afﬁne permutation f ∈˜Sn is written in one-line notation as [· · · f(1)f(2) · · ·f(n) · · ·]
(or occasionally just as [f(1)f(2) · · ·f(n)]). As explained in Section 1.2, jugglers instead list
one period of the periodic function f(i) −i (without commas, because very few people
can make 10-throws9 and higher), and call this the siteswap. We adopt the same conven-
tions when multiplying afﬁne permutations as for usual permutations. The ball number
9The few that do sometimes use A, B, . . . to denote throws 10, 11, . . ., which prompts the question of
what words are jugglable. Michael Kleber informs us that THEOREM and TEAKETTLE give valid juggling
patterns.
12

av(f) = 1
n
Pn
i=1(f(i) −i) is always an integer; indeed av(w tµ) = av(tµ) = P
i µi. Deﬁne
˜Sk
n = {f ∈˜Sn | av(f) = k} = sk
+˜S0
n
so that ˜S0
n = ker av is the Coxeter group with simple generators s0, s1, . . ., sn−1, usually
called the afﬁne symmetric group.10 Note that if f ∈˜Sa
n and g ∈˜Sb
n then the product fg is
in ˜Sa+b
n
. There is a canonical bijection f 7→f ◦(i 7→i + b −a) between the cosets ˜Sa
n and
˜Sb
n. The group ˜S0
n has a Bruhat order “≤” because it is a Coxeter group ]
An−1. This induces
a partial order on each ˜Sa
n, also denoted ≤.
An inversion of f is a pair (i, j) ∈Z × Z such that i < j and f(i) > f(j). Two inversions
(i, j) and (i′, j′) are equivalent if i′ = i+rn and j′ = j+rn for some integer r. The number
of equivalence classes of inversions is the length ℓ(f) of f. This is sort of an “excitation
number” of the juggling pattern; this concept does not seem to have been studied in the
juggling community (though see [EhRe96]).
An afﬁne permutation f ∈˜Sk
n is bounded if i ≤f(i) ≤i + n for i ∈Z. We denote the
set of bounded afﬁne permutations by Bound(k, n). The restriction of the Bruhat order to
Bound(k, n) is again denoted ≤.
Lemma 3.6. The subset Bound(k, n) ⊂˜Sk
n is a lower order ideal in (˜Sk
n, ≤). In particular,
(Bound(k, n), ≤) is graded by the rank function ℓ(f).
Proof. Suppose f ∈Bound(k, n) and g ⋖f. Then g is obtained from f by swapping the
values of i + kn and j + kn for each k, where i < j and f(i) > f(j). By the assumption on
the boundedness of f, we have i + n ≥f(i) > f(j) = g(i) ≥j > i and j + n > i + n ≥
f(i) = g(j) > f(j) ≥j. Thus g ∈Bound(k, n).
□
Postnikov, in [Pos, §13], introduces “decorated permutations”. A decorated permuta-
tion is an element of Sn, with each ﬁxed point colored either 1 or −1. There is an obvious
bijection between the set of decorated permutations and `n
k=0 Bound(k, n): Given an el-
ement f ∈Bound(k, n), form the corresponding decorated permutation by reducing f
modulo n and coloring the ﬁxed points of this reduction −1 or 1 according to whether
f(i) = i or f(i) = i + n respectively. In [Pos, §17], Postnikov introduces the cyclic Bruhat
order, CBkn, on those decorated permutations corresponding to elements of Bound(k, n).
From the list of cover relations in [Pos, Theorem 17.8], it is easy to see that CBkn is anti-
isomorphic to Bound(k, n).
Example 3.7. In the Gr(2, 4) case there are already 33 bounded afﬁne permutations, but
only 10 up to cyclic rotation. In Figure 1 we show the posets of siteswaps, afﬁne permua-
tions, and decorated permutations, each modulo rotation. Note that the cyclic symmetry
is most visible on the siteswaps, and indeed jugglers draw little distinction between cyclic
rotations of the “same” siteswap.
10One reason the subgroup ˜S0
n is more commonly studied than ˜Sn is that it is the Coxeter group ^
An−1;
its relevance for us, is that it indexes the Bruhat cells on the afﬁne ﬂag manifold for the group SLn. In §7 we
will be concerned with the afﬁne ﬂag manifold for the group GLn, whose Bruhat cells are indexed by all of
˜Sn.
13

[5247]
[2547]
[5634]
[3546]
[3456]
[3564]
[5346]
[5364]
[3654]
[5274]
[3 4 1 2]
[3 1 4 2]
[2 1 4 3]
[3 1 2 4]
[1 3 4 2]
[1 2 4 3]
[1 3 2 4]
[3 2 1 4]
[1 2 3 4]
[1 2 3 4]
2222
2312
1313
4013
4400
2330
4130
4112
2420
4040
FIGURE 1. The posets of siteswaps, bounded afﬁne permutations, and dec-
orated permutations for Gr(2, 4), each up to cyclic rotation. (The actual
posets each have 33 elements.)
3.3. Sequences of juggling states. A (k, n)-sequence of juggling states is a sequence
J = (J1, . . ., Jn) ∈
 [n]
k
n such that for each i ∈[n], we have that Ji+1 ∪−N follows Ji ∪−N,
where the indices are taken modulo n. Let Jugg(k, n) denote the set of such sequences.
Let f ∈Bound(k, n). Then the sequence of juggling states
. . ., st(f, −1), st(f, 0), st(f, 1), . . .
is periodic with period n. Furthermore for each i ∈Z, (a) −N ⊂st(f, i), and (b) st(f, i) ∩
[n] ∈
 [n]
k

. Thus
J (f) = (st(f, 0) ∩[n], st(f, 1) ∩[n], . . ., st(f, n −1) ∩[n]) ∈Jugg(k, n).
Lemma 3.8. The map f 7→J (f) is a bijection between Bound(k, n) and Jugg(k, n).
We now discuss another way of viewing (k, n)-sequences of juggling states which will
be useful in §5.1. Let S be a k-ball virtual juggling state. For every integer j, deﬁne
Rj(S) = k −#{x ∈S : x > j}.
These {Rj} satisfy the following properties:
• Rj(S) −Rj−1(S) is either 0 or 1, according to whether j ̸∈J or j ∈J respectively,
• Rj(S) = k for j sufﬁcently positive, and
• Rj(S) = j for j sufﬁciently negative.
Conversely, from such a sequence (Rj) one can construct a k-ball juggling state.
Let S1 and S2 be two k-ball juggling states. Deﬁne a 2×∞matrix (rij) by rij = Rj−i+1(Si).
Lemma 3.9. The state S2 can follow S1 if and only if r1j −r2j = 0 or 1 for all j ∈Z and there is
no 2 × 2 submatrix for which r1j = r2j = r2(j+1) = r1(j+1) −1.
Proof. It is easy to check that S2 = s−1
+ S1∪{t} if and only if r1j = r2j +1 for j ≤t and r1j = r2j
for j ≥t + 1. If this holds, it immediately follows that r1j −r2j = 0 or 1 for all j and that
there is no j for which r1j = r2j while r2(j+1) = r1(j+1) −1.
Conversely, suppose that r1j −r2j = 0 or 1 for all j ∈Z and there is no j for which
r1j = r2j = r2(j+1) = r1(j+1) −1. Then we claim that there is no j for which r1j = r2j and
r2(j+1) = r1(j+1) −1. Proof: suppose there were. If r2(j+1) = r2j, then we are done by our
hypothesis; if r2(j+1) = r2j then r1(j+1) = r1j +2, contradicting that r1(j+1) −r1j = 0 or 1. Since
r2(j+1) −r2j = 0 or 1, we have a contradiction either way. This establishes the claim. Now,
14

we know that r1j = r2j for j sufﬁcently positive and r1j = r2j + 1 for j sufﬁcently negative,
so there must be some t such that r1j = r2j + 1 for j ≤t and r1j = r2j for j ≥t + 1. Then S2
can follow S1.
□
It is immediate to extend this result to a sequence of juggling states. Let G be the group
of juggling functions introduced in §3.1 and let Gav=k be those juggling functions with
ball number k. For any f in Gav=k, let J (f) = (J1, J2, . . ., Jn) be the corresponding (k, n)-
sequence of juggling states. Deﬁne an ∞× ∞matrix by rij = R(j−i+1)(Ji ∪−N). Then,
applying Lemma 3.9 to each pair of rows of (rij) gives:
Corollary 3.10. The above construction gives a bijection between Gav=k and ∞× ∞matrices
such that
(C1) for each i, there is an mi such that rij = j −i + 1 for all j ≤mi,
(C2) for each i, there is an ni such that rij = k for all j ≥ni,
(C3) rij −r(i+1)j ∈{0, 1} and rij −ri(j−1) ∈{0, 1} for all i, j ∈Z, and
(C4) if r(i+1)(j−1) = r(i+1)j = ri(j−1) then rij = r(i+1)(j−1).
Under this bijection, rij = r(i+1)j = ri(j−1) > r(i+1)(j−1) if and only if f(i) = j.
Proposition 3.11. Let f, g ∈˜Sk
n ⊂Gav=k and let r and s be the corresponding matrices. Then
f ≤g (in Bruhat order) if and only if rij ≥sij for all (i, j) ∈Z2.
Proof. See [BjBre05, Theorem 8.3.1].
□
When rij = r(i+1)j = ri(j−1) > r(i+1)(j−1), we say that (i, j) is a special entry of r.
An easy check shows:
Corollary 3.12. Under the above bijection, Bound(k, n) corresponds to ∞× ∞matrices such
that
(C1’) rij = j −i + 1 for all j < i,
(C2’) rij = k for all j ≥i + n −1,
(C3) rij −r(i+1)j ∈{0, 1} and rij −ri(j−1) ∈{0, 1} for all i, j ∈Z,
(C4) if r(i+1)(j−1) = r(i+1)j = ri(j−1) then rij = r(i+1)(j−1), and
(C5) r(i+n)(j+n) = rij.
We call a matrix (rij) as in Corollary 3.12 a cyclic rank matrix. (See [Fu92] for the
deﬁnition of a rank matrix, which we are mimicking.) We now specialize Proposition 3.11
to the case of Bound(k, n): Deﬁne a partial order ≤on Jugg(k, n) by
(J1, . . ., Jn) ≤(J′
1, . . ., J′
n) if and only if Ji ≤J′
i for each i.
Corollary 3.13. The map f 7→J (f) is an isomorphism of posets from bounded afﬁne permutations
(Bound(k, n), ≤) to (k, n)-sequence of juggling states (Jugg(k, n), ≤).
Proof. One simply checks that the condition rij ≥r′
ij for all j is equivalent to Ji ≤J′
i.
□
Example 3.14. Let n = 4 and k = 2. Consider the afﬁne permutation [· · ·2358 · · ·], last
seen in Figure 1. Its siteswap is 4112, and the corresponding sequence of juggling states
is (14, 13, 12, 12). Below we list a section of the corresponding inﬁnite permutation matrix
15

and cyclic rank matrix. Namely, we display the entries (i, j) for 1 ≤i ≤4 and i ≤j ≤i+4.
The special entries have been underlined.




0
1
0
0
0
0
1
0
0
0
0
0
1
0
0
0
0
0
0
1








1
1
1
2
2
1
1
2
2
2
1
2
2
2
2
1
2
2
2
2




In §1.2 we associated an afﬁne permutation to each k × n matrix M of rank k; a modi-
ﬁcation of that rule gives instead a (k, n)-sequence of juggling states. Call a column of M
pivotal if it is linearly independent of the columns to its left. (If one performs Gaussian
elimination on M, a column will be pivotal exactly if it contains a “pivot” of the resulting
reduced row-echelon form.) There will be k pivotal columns, giving a k-element subset
of {1, . . ., n}; they form the lex-ﬁrst basis made of columns from M.
Now rotate the ﬁrst column of M to the end.
What happens to the set of pivotal
columns? Any column after the ﬁrst that was pivotal still is pivotal, but (unless the ﬁrst
column was all zeroes) there is a new pivotal column; the new state can follow the previ-
ous state. The n cyclic rotations of M thus give a (k, n)-sequence of juggling states.
3.4. From Q(k, n) to Bound(k, n). The symmetric group Sn acts on Zn (on the left) by
(1)
w · (ω1, . . ., ωn) = (ωw−1(1), . . .ωw−1(n)).
If w ∈Sn and tλ, tλ′ ∈˜Sn are translation elements, we have the following relations in ˜Sn:
(2)
wtλw−1 = tw·λ
tλtλ′ = tλ+λ′.
Let ωk = (1, . . ., 1, 0, . . ., 0) with k 1s be the kth fundamental weight of GL(n). Note
that tωk ∈˜Sk
n. Now ﬁx ⟨u, w⟩∈Q(k, n), the set of equivalence classes we deﬁned in §2.3.
Deﬁne an afﬁne permutation fu,w ∈˜Sk
n by
fu,w = utωkw−1.
The element fu,w does not depend on the representative [u, w]k of ⟨u, w⟩: if u′ = uz and
w′ = wz for z ∈Sk × Sn−k then
u′tωk(w′)−1 = uztωkz−1w−1 = utz·ωkw−1 = utωkw−1
since z stabilizes ωk.
Proposition 3.15. The map ⟨u, w⟩7→fu,w is a bijection from Q(k, n) to Bound(k, n).
Proof. We ﬁrst show that ⟨u, w⟩7→fu,w is an injection into ˜Sk
n. Suppose that fu,w = fu′,w′.
It is clear from the factorization ˜Sn ≃Sn ⋉Zn that there is some z ∈Sk × Sn−k such that
u = u′z and w = w′z. Using Proposition 2.4, we have [u, w] ∼[u′, w′].
We now show that for ⟨u, w⟩∈Q(k, n), we have fu,w ∈Bound(k, n). Let i ∈[1, n] and
a = w−1(i). Then
fu,w(i) =

u(a)
if a > k
u(a) + n
if a ≤k.
The boundedness of fu,w now follows from Theorem 2.1(1).
Conversely, if f ∈Bound(k, n) then it is clear from (2) that f has a factorization as
f = utωw−1
16

for u, w ∈Sn and ω ∈{0, 1}n. Since f ∈˜Sk
n, the vector ω has k 1s. By changing u and
w, we may further assume that ω = ωk and w ∈Smin
n,k . It remains to check that u ≤k w,
which we do via Theorem 2.1; its Condition (2) is vacuous when w ∈Smin
n,k and checking
Condition (1) is the same calculation as in the previous paragraph.
□
Theorem 3.16. The bijection ⟨u, w⟩7→fu,w is a poset isomorphism from the pairs (Q(k, n), ≤) to
bounded afﬁne permutations (Bound(k, n), ≤). Furthermore, one has ℓ(fu,w) =
 n
k

−ℓ(w)+ℓ(u).
Proof. It is shown in [Wi07] that (Q(k, n), ≤) is a graded poset, with rank function given
by ρ(⟨u, w⟩) = k(n−k) −(ℓ(w) −ℓ(u)). It follows that each cover in Q(k, n) is of the form
(1) ⟨u, w′⟩⋗⟨u, w⟩where w′ ⋖w, or
(2) ⟨u′, w⟩⋗⟨u, w⟩where u ⋖u′.
We may assume that w ∈Smin
n,k (Proposition 2.3). Suppose we are in Case (1). Then w′ =
w(ab) where a ≤k < b and w(a) > w(b). Here (ab) ∈Sn denotes the transposition
swapping a and b. Thus fu,w′ = fu,w(w(a)w(b)). Using the formula in the proof of
Proposition 3.15, we see that fu,w(w(a)) > n while fu,w(w(b)) ≤n. Thus fu,w′ > fu,w.
Suppose we are in Case (2), and that u′ = u(ab) where a < b and u(a) < u(b). It
follows that fu,w′ = (u(a)u(b))fu,w. Suppose ﬁrst that a ≤k < b. Then (tωk)−1(a) = a−n,
while (tω)−1(b) = b so we also have fu,w′ = fu,w((w(a)−n)w(b)) where w(a)−n is clearly
less than w(b). Thus fu,w′ > fu,w. Otherwise suppose that a, b ≥k (the case a, b ≤k is
similar). Then fu,w′ = fu,w(w(a)w(b)). Since w ∈Smin
n,k , we have w(a) < w(b). Again we
have fu,w′ > fu,w.
We have shown that ⟨u′, w′⟩≥⟨u, w⟩implies fu′,w′ ≥fu,w. The converse direction is
similar.
The last statement follows easily, using the fact that both of the posets (Q(k, n), ≤) and
(Bound(k, n), ≤) are graded.
□
3.5. Shellability of Q(k, n). A graded poset P is Eulerian if for any x ≤y ∈P such that
the interval [x, y] is ﬁnite we have µ(x, y) = (−1)rank(x)−rank(y), where µ denotes the M¨obius
function of P. A labeling of the Hasse diagram of a poset P by some totally ordered set Λ
is called an EL-labeling if for any x ≤y ∈P:
(1) there is a unique label-(strictly)increasing saturated chain C from x to y,
(2) the sequence of labels in C is Λ-lexicographically minimal amongst the labels of
saturated chains from x to y.
If P has an EL-labeling then we say that P is EL-shellable.
Verma [Ve71] has shown that the Bruhat order of a Coxeter group is Eulerian. Dyer
[Dy93, Proposition 4.3] showed the stronger result that every Bruhat order (and also its
dual) is EL-shellable. (See also [BjWac82].) Since these properties are preserved under tak-
ing convex subsets, Lemma 3.6 and Corollary 3.13 and Theorem 3.16 imply the following
result, proved for the dual of (Q(k, n), ≤) by Williams [Wi07].
Corollary 3.17. The posets (Q(k, n), ≤), (Bound(k, n), ≤), and (Jugg(k, n), ≤), and their du-
als are Eulerian and EL-shellable.
Remark 3.18. Williams’ result is stronger than Corollary 3.17: in our language, she shows
that the poset
\
Q(k, n), formed by adding a formal maximal element ^1 to Q(k, n), is
shellable.
17

3.6. Positroids. A matroid M on [n] with rank k is a non-empty collection of k-element
subsets of [n], called bases, satisfying the Unique Minimum Axiom: For any permutation
w ∈Sn, there is a unique minimal element of w · M, in the partial order ≤on
 [n]
k

. This
is only one of many equivalent deﬁnitions of a matroid; see [Bry86] for a compendium of
many others, in which this one appears as Axiom B2(6).
Let M be a matroid of rank k on [n]. Deﬁne a sequence of k-element subsets J (M) =
(J1, J2, . . ., Jn) by letting Jr be the minimal base of χ−r+1(M), which is well-deﬁned by
assumption. Postnikov proved, in the terminology of Grassmann necklaces,
Lemma 3.19 ([Pos, Lemma 16.3]). For a matroid M, the sequence J (M) is a (k, n)-sequence
of juggling states.
Let J = (J1, J2, . . ., Jr) ∈Jugg(k, n). Deﬁne
MJ =

I ∈
[n]
k

| χ−r+1(I) ≥Jr

.
Lemma 3.20 ([Pos, Oh]). Let J ∈Jugg(k, n). Then MJ is a matroid and J (MJ ) = J .
The matroids MJ are called positroids.
Proposition 3.21. The maps J 7→MJ and M 7→J (M) are inverse isomorphisms between the
poset Jugg(k, n) and the poset of positroids, J (M1) ≤J (M2) if and only if M1 ⊇M2.
Proof. The composition J 7→MJ 7→J (MJ ) is the identity by the above lemma and,
since the set of positroids is deﬁned as those matroids of the form MJ , the compositions
are inverse in the other order as well.
It is easy to see from the deﬁnitions, that M1 ⊇M2 implies J (M1) ≤J (M2) and that
J1 ≤J2 implies MJ1 ⊇MJ2. Since these correspondences are inverse, then J1 ≤J2 if
and only if MJ1 ⊇MJ2.
□
If M is an arbitrary matroid, then we call the positroid MJ (M) the positroid envelope
of M (see the discussion before Remark 1.1). Every positroid is a matroid. The positroid
envelope of a positroid is itself.
Example 3.22. Let M1 and M2 be the matroids {12, 13, 14, 23, 24, 34} and {12, 23, 34, 14}. In
both cases, J (Mi) is (12, 23, 34, 14) and, thus, M1 is the positroid envelope of both M1 and
M2. The corresponding afﬁne permutation is [· · ·3456 · · ·]. On the other hand, if M3 =
{12, 13, 14, 23, 24}, then J (M3) = {12, 23, 13, 14}, with corresponding afﬁne permutation
[· · ·3546 · · ·].
Remark 3.23. Postnikov [Pos] studied the totally nonnegative part Gr(k, n)≥0 of the Grass-
mannian. Each point V ∈Gr(k, n)≥0 has an associated matroid MV. Postnikov showed
that the matroids that can occur this way, called positroids, were in bijection with Grass-
mann necklaces of type (k, n) (similar to our (k, n)-sequences of juggling states), with
decorated permutations of [n] with k anti-exceedances, and with many other combinato-
rial objects. Oh [Oh], proving a conjecture of Postnikov, showed that positroids can be
deﬁned in the way we have done.
18

4. BACKGROUND ON SCHUBERT AND RICHARDSON VARIETIES
We continue to ﬁx nonnegative integers k and n, satisfying 0 ≤k ≤n. For S any subset
of [n], let ProjectS : Cn ։ CS denote the projection onto the coordinates indexed by S. (So
the kernel of ProjectS is Spans̸∈S es.)
4.1. Schubert and Richardson varieties in the ﬂag manifold. Let Fℓ(n) denote the vari-
ety of ﬂags in Cn. For a permutation w ∈Sn, we have the Schubert cell
˚Xw = {G• ∈Fℓ(n) | dim(Project[j](Gi)) = #{w([i]) ∩[j]} for all i, j}
and Schubert variety
Xw = {G• ∈Fℓ(n) | dim(Project[j](Gi)) ≤#{w([i]) ∩[j]} for all i, j}
which both have codimension ℓ(w); moreover Xw = ˚Xw. (For basic background on the
combinatorics of Schubert varieties, see [Fu92] or [MilStu05, Chapter 15].) We thus have
Fℓ(n) =
a
w∈Sn
˚Xw
and
Xw =
a
v≥w
˚Xv.
Similarly, we deﬁne the opposite Schubert cell
˚Xw = {G• ∈Fℓ(n) | dim(Project[n−j+1,n](Gi)) = #{w([i]) ∩[n −j + 1, n]} for all i, j}
and opposite Schubert variety
Xw = {G• ∈Fℓ(n) | dim(Project[n−j+1,n](Gi)) ≤#{w([i]) ∩[n −j + 1, n]} for all i, j}
It may be easier to understand these deﬁnitions in terms of matrices. Let M be an
n × n invertible matrix and let Gi be the span of the top i rows of M. Then G• is in ˚Xw
(respectively, Xw), if and only if, for all 1 ≤i, j ≤n, the rank of the top left i × j submatrix
of M is the same as (respectively, less than or equal to) the rank of the corresponding
submatrix of the permutation matrix w. Similarly, G• is in ˚Xw (respectively Xw) if the
ranks of the top right submatrices of M are equal to (respectively less than or equal to)
those of w. (The permutation matrix of w has 1s in positions (i, w(i)) and 0s elsewhere.)
Deﬁne the Richardson varieties as the transverse intersections
Xw
u = Xu ∩Xw
and
˚Xw
u = ˚Xu ∩˚Xw.
The varieties Xw
v and ˚Xw
v are nonempty if and only if v ≤w, in which case each has
dimension ℓ(w) −ℓ(v). Let E• be the ﬂag (Span(e1), Span(e1, e2), . . .) The coordinate ﬂag
vE• is in Xw
u if and only if u ≤v ≤w.
We will occasionally need to deﬁne Schubert cells and varieties with respect to a ﬂag
F•. We set
˚Xw(F•) = {G• ∈Fℓ(n) | dim(Gi/(Gi ∩Fn−j)) = #{w([i]) ∩[j]} for all i, j}
and deﬁne Xw(F•) by replacing = with ≤. Warning: under this deﬁnition Xw is Xw(w0E•).
19

4.2. Schubert varieties in the Grassmannian. Let Gr(k, n) denote the Grassmannian of
k-planes in Cn, and let π : Fℓ(n) →Gr(k, n) denote the natural projection. For I ∈
 [n]
k

,
we let
˚XI = {V ∈Gr(k, n) | dim Project[j](V)) = #(I ∩[j])}
denote the Schubert cell labeled by I and
XI = {V ∈Gr(k, n) | dim Project[j](V) ≤#(I ∩[j])}
the Schubert variety labeled by I.
Thus we have π(Xw) = Xπ(w) and
Gr(k, n) =
a
I∈([n]
k )
˚XI
and
XJ =
a
I≥J
˚XI.
We deﬁne
˚XI = {V ∈Gr(k, n) | dim Project[n−j+1,n](V) = #(I ∩[n −j + 1, n])},
XI = {V ∈Gr(k, n) | dim Project[n−j+1,n](V) ≤#(I ∩[n −j + 1, n])},
So, for J ∈
 [n]
k

, the k-plane Spanj∈J ej lies in XI if and only if I ≤J, and lies in XK if and
only if J ≤K.
To review: if u and w lie in Sn, then Xu is a Schubert variety, Xw an opposite Schubert
and Xw
u a Richardson variety in Fℓ(n). If I and J lie in
 [n]
k

, then XI, XJ and XJ
I mean
the similarly named objects in Gr(k, n). (Note that permutations have lower case letters
from the end of the alphabet while subsets have upper case letters chosen from the range
{I, J, K}.) The symbol ˚X would indicate that we are dealing with an open subvariety, in
any of these cases.
5. POSITROID VARIETIES
We now introduce the positroid varieties, our principal objects of study. Like the Schu-
bert and Richardson varieties, they will come in open versions, denoted ˚Π, and closed
versions, denoted Π.11 The positroid varieties will be subvarieties of Gr(k, n), indexed by
the various posets introduced in §3. For each of the different ways of viewing our posets,
there is a corresponding way to view positroid varieties. The main result of this section
will be that all of these ways coincide. Again, we sketch these results here and leave the
precise deﬁnitions until later.
Given [u, w]k, representing an equivalence class in Q(k, n), we can project the Richard-
son variety ˚Xw
u (respectively Xw
u ) to Gr(k, n). Given a (k, n)-sequence of juggling states
(J1, J2, . . ., Jn) ∈Jugg(k, n), we can take the intersection T χi−1˚XJi (respectively T χi−1XJi)
in Gr(k, n). (Recall χ is the cyclic shift [234 . . .n1].) Given a cyclic rank matrix r, we can
consider the image in Gr(k, n) of the space of k × n matrices such that the submatrices
made of cyclically consecutive columns have ranks equal to (respectively, less than or
equal to) the entries of r. Given a positroid M, we can consider those points in Gr(k, n)
whose matroid has positroid envelope equal to (respectively, contained in) M.
11Π stands for “positroid”, “Postnikov”, and “projected Richardson”.
20

Theorem 5.1. Choose our [u, w]k, (J1, . . . , Jn), r and M to correspond by the bijections in §3.
Then the projected open Richardson variety, the intersection of cyclically permuted open Schu-
bert varieties, the space of matrices obeying the rank conditions, and the space of matrices whose
matroids have the required positroid envelope, will all coincide as subsets of Gr(k, n).
The equalities of the last three spaces is essentially a matter of unwinding deﬁnitions.
The equality between the projected open Richardson variety, and the space of matrices
obeying the cyclic rank conditions, is nontrivial and is checked in Proposition 5.4.
We call the varieties we obtain in this way open positroid varieties or positroid vari-
eties respectively, and denote them by ˚Π or Π with a subscript corresponding to any of
the possible combinatorial indexing sets.
The astute reader will note that we did not describe how to deﬁne a positroid variety
using a bounded afﬁne permutation (except by translating it into some other combinato-
rial data). We hope to address this in future work using the geometry of the afﬁne ﬂag
manifold. The signiﬁcance of bounded afﬁne permutations can already be seen in this
paper, as it is central in our description in §7 of the cohomology class of Π.
5.1. Cyclic rank matrices. Recall the deﬁnition of a cyclic rank matrix from the end of
§3.1.
As we explained there, cyclic rank matrices of type (k, n) are in bijection with
Bound(k, n) and hence with Q(k, n) and with bounded juggling patterns of type (k, n).
Let V ∈Gr(k, n). We deﬁne an inﬁnite array r••(V) = (rij(V))i,j∈Z of integers as follows:
For i > j, we set rij(V) = j −i + 1 and for i ≤j we have
rij(V) = dim(Project{i,i+1,...,j}(V)}).
where the indices are cyclic modulo n. (So, if n = 5, i = 4 and j = 6, we are projecting
onto Span(e4, e5, e1).) Note that, when j ≥i + n −1, we project onto all of [n]. If V is the
row span of a k × n matrix M, then rij(V) is the rank of the submatrix of M consisting of
columns i, i + 1, . . . , j.
5.2. Positroid varieties and open positroid varieties.
Lemma 5.2. Let V ∈Gr(k, n). Then r••(V) is a cyclic rank matrix of type (k, n).
Proof. Conditions (C1’), (C2’), and (C5) are clear from the deﬁnitions. Let M be a k×n ma-
trix whose row span is V; let Mi be the ith column of M. Condition (C3) says that adding
a column to a matrix either preserves the rank of that matrix or increases it by one. The
hypotheses of condition (C4) state that Mi and Mj are in the span of Mi+1, Mi+2, . . . , Mj−1;
the conclusion is that dim Span(Mi, Mi+1, . . ., Mj−1, Mj) = dim Span(Mi+1, . . ., Mj−1).
□
For any cyclic rank matrix r, let ˚Πr be the subset of Gr(k, n) consisting of those k-planes
V with cyclic rank matrix r. We may also write ˚Πf, ˚ΠJ or ˚Πw
u where f is the bounded afﬁne
permutation, J the juggling pattern or ⟨u, w⟩the equivalence class of k-Bruhat interval
corresponding to r.
The next result follows directly from the deﬁnitions. Recall that χ = [23 · · ·(n −1)n1] ∈
Sn denotes the long cycle.
Lemma 5.3. For any J = (J1, J2, . . ., Jn) ∈Jugg(k, n), we have
˚ΠJ = ˚XJ1 ∩χ(˚XJ2) ∩· · · ∩χn−1(˚XJn).
21

By Lemma 5.2 and our combinatorial bijections, we have
Gr(k, n) =
a
J ∈Jugg(k,n)
˚ΠJ .
We call the sets ˚ΠJ open positroid varieties. Postnikov [Pos] showed that ˚ΠJ (and even
(˚ΠJ )≥0) is non-empty if J ∈Jugg(k, n) (this statement also follows from Proposition 5.4
below). We deﬁne the positroid varieties ΠJ to be the closures ΠJ := ˚ΠJ .
5.3. From Q(k, n) to cyclic rank matrices. We now describe a stratiﬁcation of the Grass-
mannian due to Lusztig [Lus98], and further studied by Rietsch [Rie06]. (This stratiﬁca-
tion was also independently discovered by Brown, Goodearl and Yakimov [BroGooYa06,
GooYa], motivated by ideas from Poisson geometry; we will not discuss the Poisson per-
spective further in this paper.) Lusztig and Rietsch’s work applies to any partial ﬂag
variety, and we specialize their results to the Grassmannian.
The main result of this section is the following:
Proposition 5.4. Let u ≤k w, and fu,w be the corresponding afﬁne permutation from §3.4. Recall
that ˚Xw
u denotes the open Richardson variety in Fℓ(n) and π the map Fℓ(n) →Gr(k, n). Then
˚Πf = π(˚Xw
u ).
Remark 5.5. If u ≤w, but u ̸≤k w, then π(˚Xw
u ) may not be of the form ˚Πf. See [KnLamSp,
Remark 3.5].
The projection π(˚Xw
u ) depends only on the equivalence class of [u, w]k in Q(k, n).
Proposition 5.6 ([KnLamSp, Lemma 3.1]). Suppose [u, w]k ∼[u′, w′]k in Q(k, n). Then
π(˚Xw
u ) = π(˚Xw′
u′ ).
We now introduce a piece of notation which will be crucial in the proof of Proposi-
tion 5.4, but will then never appear again. Let V ∈Gr(k, n). Given a ﬂag F• in Cn, we
obtain another ﬂag F•(V) containing V as the kth subspace, as follows. Take the sequence
F0 ∩V, F1 ∩V, . . ., Fn ∩V and remove repetitions to obtain a partial ﬂag F• ∩V inside Cn,
with dimensions 1, 2, . . . k. Next take the sequence V + F0, V + F1, V + F2, . . . , V + Fn and
remove repetitions to obtain a partial ﬂag F• + V inside Cn of dimensions k, k + 1, . . . , n.
Concatenating F• ∩V and F• + V gives a ﬂag F•(V) in Cn. The ﬂag F•(V) is the “closest”
ﬂag to F• which contains V as the kth subspace. This notion of “closest ﬂag” is related
to the notion of “closest Borel subgroup” in [Rie06, §5], and many of our arguments are
patterned on arguments of [Rie06].
Lemma 5.7. Let w be a Grassmannian permutation. Let F• be a complete ﬂag and let V = Fk.
Then F• ∈˚Xw if and only if
(1) V ∈˚Xσ(w) and
(2) F• = E•(V).
Proof. The ﬂag F• is in ˚Xw if and only if, for every i and j,
dim(Fi ∩Ej) = # (w([i]) ∩[j]) or, equivalently, dim(Fi + Ej) = (i + j) −# (w([i]) ∩[j]) .
When i = k, the equation above is precisely the condition that V ∈˚Xσ(w). Therefore, when
proving either direction of the equivalence, we may assume that V ∈˚Xσ(w).
22

Since V ∈˚Xσ(w),
E•(V) =
 Ew(1) ∩V, Ew(2) ∩V, . . . , Ew(k) ∩V, Ew(k+1) + V, Ew(k+2) + V, . . ., Ew(n) + V

.
Let i ≤k. If F• ∈˚Xw, then dim(Fi ∩Ew(i)) = # (w([i]) ∩[w(i)]) = i, where we have
used that w is Grassmannian. However, Fi ∩Ew(i) ⊆V ∩Ew(i), which also has dimension i
because V ∈˚Xσ(w). So F• ∈˚Xw implies that Fi = V ∩Ew(i). Similarly, for i > k, the equation
dim(Fi + Ew(i)) = i + w(i) −# (w([i]) ∩[w(i)]) implies that Fi = Ew(i) + V. So, if F• ∈˚Xx
then F• = E•(V). The argument is easily reversed.
□
Lemma 5.8. Let w be a Grassmannian permutation, with u ≤w and let V ∈Gr(k, n). Then
V ∈π(˚Xw
u ) if and only if
(3)
E•(V)i = V ∩Ew(i) for 1 ≤i ≤k
(4)
E•(V)i = V + Ew(i) for k < i ≤n
and
(5)
E•(V) ∈˚Xu.
Proof. By deﬁnition, V ∈π(˚Xw
u ) if and only if there is a ﬂag F• with V = Fk and F• ∈˚Xu∩˚Xw.
By Lemma 5.7, this ﬂag F•, should it exist, must be E•(V). By Lemma 5.7, E•(V) lies in ˚Xw if
and only if V lies in ˚Xσ(w). So E•(V) ∈˚Xu∩˚Xw if and only if V ∈˚Xσ(w) and E•(V) ∈˚Xu. Now,
conditions (3) and (4) determine the dimension of V ∩Ew(i) for all i. They are precisely
the condition on dim (V ∩w(j)) occuring in the deﬁnition of ˚Xσ(w). So conditions (3), (4)
and (5) are equivalent to the condition that V ∈˚Xσ(w) and E•(V) ∈˚Xu.
□
Proof of Proposition 5.4. First, note that by Proposition 5.6, and the observation that fu,w
only depends on the equivalence class ⟨u, w⟩in Q(k, n), we may replace (u, w) by any
equivalent pair in Q(k, n). We may thus assume that w is Grassmannian (Proposition 2.3).
By Lemma 5.8, V ∈π(˚Xw
u ) if and only if conditions (3), (4) and (5) hold.
Suppose that V ∈π(˚Xw
u ). Let r = r••(V). Let a ∈Z and let b = fu,w(a); without loss of
generality we may assume that 1 ≤a ≤n. Set i = w−1(a). We now check that (a, b) is a
special entry of r.
Case 1: i ̸∈[k]. In this case fu,w(a) = utωkw−1(a) ∈[n]. Since fu,w ∈Bound(k, n), we
deduce that a ≤b ≤n. (Occasionally, our notation will implicitly assume a < b, we
leave it to the reader to check the boundary case.) By conditions (4) and (5),
dim Project[b] (V + Ea) = # (u([i]) ∩[b]) .
We can rewrite this as
dim (V + Ea + w0En−b) = (n −b) + # (u([i]) ∩[b])
or, again,
dim Project[a+1,b](V) = # (u([i]) ∩[b]) −a.
(We have used a ≤b ≤n to make sure that dim Ea + w0En−b = n −b + a.) In conclusion,
r(a+1)b = # (u([i]) ∩[b]) −a.
23

A similar computation gives us
r(a+1)(b−1) = # (u([i]) ∩[b −1]) −a.
We now wish to compute rab and ra(b−1). This time, we have V + Ea−1 = E•(V)i−1. So
we deduce from condition (4) that
rab = # (u([i −1]) ∩[b]) −(a −1)
and
ra(b−1) = # (u([i −1]) ∩[b −1]) −(a −1).
Now, u(i) = u(w−1(a)) = b. So, r(a+1)b −r(a+1)(b−1) = 1 and, since b ̸∈u([i −1]), we also
have rab −ra(b−1) = 0. So (a, b) is special as claimed.
Case 2: i ∈[k]. In this case, b = u(i) + n and n + 1 ≤b ≤a + n. We mimic the previous
argument, using V ∩Ea ∩w0E2n−b in place of V +Ea +w0En−b, the conclusion again is that
(a, b) is a special entry of r.
We have now checked, in both cases, that (a, b) is a special entry of r. Therefore, the
afﬁne permutation g associated to r has g(a) = b. Since fu,w(a) = b, we have checked
that fu,w = g. We have thus shown that, if V ∈π(˚Xw
u ), then V ∈˚Πfu,w.
We now must prove the converse. Let r••(V) = r(fu,w). Let (u′, w′) be such that E•(V) ∈
˚Xw′
u′ , so we know that V ∈π(˚Xw′
u′ ). By Lemma 5.7, w′ is Grassmannian. So r••(V) =
r(fu′,w′) and fu′,w′ = fu,w. However, by Proposition 3.15, this shows that [u, w]k and
[u′, w′]k represent the same element of Q(k, n). Since w and w′ are both Grassmannian,
this means that u = u′ and w = w′, and V ∈π(˚Xw
u ) as desired.
□
5.4. Positroid varieties are projected Richardson varieties. Lusztig [Lus98] exhibited a
stratiﬁcation ` P(u,v,w) of Gr(k, n) indexed by triples (u, v, w) ∈Smax
n,k × (Sk × Sn−k) × Smin
n,k
satisfying u ≤wv, and showed that his strata satisfy
P(u,v,w) = π(˚Xwv
u ) = π(˚Xw
uv−1).
Furthermore, the projection π : Fℓ(n) →Gr(k, n) restricts to an isomorphism on ˚Xwv
u .
Using the bijection between the triples (u, v, w) and Q(k, n) (see §2.3), it thus follows
from Proposition 5.4 that
Theorem 5.9. The stratiﬁcation of Gr(k, n) by open positroid varieties is identical to Lusztig’s
stratiﬁcation. If f = fu,w corresponds to ⟨u, w⟩under the bijection Q(k, n) →Bound(k, n) of
§3.4, then π(˚Xw
u) = ˚Πf. The varieties Πf and ˚Πf are irreducible of codimension ℓ(f), and ˚Πf is
smooth. For any Richardson variety Xw
u , whether or not u ≤k w, the projection π(Xw
u) is a closed
positroid variety.
Proof. Open Richardson varieties in the ﬂag manifold are smooth and irreducible (by
Kleiman transversality). Lusztig’s strata are, by deﬁnition, the projected open Richardson
varieties, which we have just showed are the same as the open positroid varieties. Lusztig
shows that π restricted to ˚Xw
u is an isomorphism on its image, so dim Πf = dim Xw
u =
ℓ(w) −ℓ(u) and Πf is irreducible. By Theorem 3.16, ℓ(w) −ℓ(u) = k(n −k) −ℓ(f), so ˚Πf
has codimension ℓ(f), as does its closure Πf.
See [KnLamSp, Proposition 3.3] for the fact that the projection of any Richardson Xw
u is
equal to the projection of some Xw′
u′ with u′ anti-Grassmannian.
□
24

For u ≤k w, we shall call Xw
u a Richardson model for Πfu,w. We refer the reader to
[KnLamSp] for a discussion of projections of closed Richardson varieties. In particular, for
any u ≤w (not necessarily a k-Bruhat relation) there exists a bounded afﬁne permutation
f such that π(Xw
u ) = Πf.
Postnikov [Pos] parametrized the “totally nonnegative part” of any open positroid va-
riety, showing that it is homeomorphic to an open ball. Before one knows that positroid
varieties are actually irreducible, one can use this parametrizability to show that only one
component intersects the totally nonnegative part of the Grassmannian. A priori there
might be other components, so it is nice to know that in fact there are not.
We now describe the containments between positroid varieties:
Theorem 5.10. Open positroid varieties form a stratiﬁcation of the Grassmannian. Thus for
f ∈Bound(k, n) we have
Πf =
a
f′≥f
˚Πf′ = XJ1 ∩χ(XJ2) ∩· · · ∩χn−1(XJn).
where (J1, J2, . . ., Jn) ∈Jugg(k, n) corresponds to f.
Proof. Rietsch [Rie06] described the closure relations of Lusztig’s stratiﬁcation of partial
ﬂag varieties; see also [BroGooYa06]. The ﬁrst equality is Rietsch’s result, translated from
the language of Q(k, n) to Bound(k, n).
We know that XJ = `
I≥J ˚XI. Using this to expand the intersection XJ1 ∩χ(XJ2) ∩· · · ∩
χn−1(XJn) and applying Lemma 5.3 gives the second equality.
□
We note that Postnikov [Pos] also described the same closure relations for the totally
nonnegative Grassmannian, using Grassmann necklaces and decorated permutations.
For a matroid M let
GGMS(M) = {V ∈Gr(k, n) | ∆I(V) ̸= 0 ⇐⇒I ∈M}
denote the GGMS stratum of the Grassmannian [GeGorMacSe87]. Here for I ∈
 [n]
k

, ∆I
denotes the Pl¨ucker coordinate labeled by the columns in I. Recall that in Section 3.6, we
have deﬁned the positroid envelope of a matroid. It is easy to see that
˚Πf =
a
M: J (M)=J (f)
GGMS(M).
Proposition 5.11. Let M be a positroid. Then GGMS(M) is dense in ˚ΠJ (M).
Proof. Suppose f ∈Bound(k, n) is such that J (f) = J (M). Postnikov [Pos] showed
that the totally nonnegative part GGMS(M)≥0 of GGMS(M) is a real cell of dimension
k(n−k)−ℓ(f). Thus GGMS(M) has at least dimension k(n−k)−ℓ(f). By Theorem 5.9 ˚Πf
is irreducible with the same dimension. It follows that GGMS(M) is dense in ˚ΠJ (M).
□
Corollary 5.12. Let M be a positroid. Then as sets,
ΠJ (M) = GGMS(M) = {V ∈Gr(k, n) | I /∈M ⇒∆I(V) = 0}.
Proof. The ﬁrst equality follows from Proposition 5.11. The second follows from Theo-
rem 5.10 and the description of Schubert varieties by vanishing of Pl¨ucker coordinates:
XJ = {V ∈Gr(k, n) | I < σ(J) ⇒∆I(V) = 0}.
□
25

Consider the set on the right hand side of the displayed equation in Corollary 5.12.
Lauren Williams conjectured that this set was irreducible; this now follows from Corol-
lary 5.12 and Theorem 5.9.
5.5. Geometric properties of positroid varieties. The following results follow from The-
orem 5.9 and the geometric results of [KnLamSp].
Theorem 5.13. Positroid varieties are normal, Cohen-Macaulay, and have rational singularities.
Theorem 5.14. There is a Frobenius splitting on the Grassmannian that compatibly splits all the
positroid varieties therein. Furthermore, the set of positroid varieties is exactly the set of compatibly
split subvarieties of the Grassmannian.
Theorem 5.15. Let M be a positroid. Then the ideal deﬁning the variety ΠJ (M) inside Gr(k, n)
is generated by the Pl¨ucker coordinates {∆I : I /∈M}.
Proof. By Theorem 5.10, ΠJ (M) is the set-theoretic intersection of some permuted Schubert
varieties. By the Frobenius splitting results of [KnLamSp], it is also the scheme-theoretic
intersection.
Hodge proved that Schubert varieties (and hence permuted Schubert varieties) are de-
ﬁned by the vanishing of Pl¨ucker coordinates. (See e.g. [Ra87], where a great generaliza-
tion of this is proven using Frobenius splitting.) The intersection of a family of them is
deﬁned by the vanishing of all their individual coordinates.
As explained in [FoZ00, Proposition 3.4], it is easy to determine which Pl¨ucker coordi-
nates vanish on a T-invariant subscheme X of the Grassmannian; they correspond to the
ﬁxed points not lying in X.
□
Corollary 5.16. Let M be a positroid. Embed Gr(k, n) into P(n
k)−1 by the Pl¨ucker embedding.
Then the ideal of ΠJ (M) in P(n
k)−1 is generated in degrees 1 and 2.
Proof. By Theorem 5.15, the ideal of ΠJ (M) is the sum of a linearly generated ideal and the
ideal of Gr(k, n). It is classical that the ideal of Gr(k, n) is generated in degree 2.
□
Remark 5.17. For a subvariety X ⊆G/P ⊆PV of a general ﬂag manifold embedded in the
projectivization PV of an irreducible representation, one can ask whether X is deﬁned as
a set by the vanishing of extremal weight vectors in V. This is easy to show for Schubert
varieties (see [FoZ00]) and more generally for Richardson varieties.
Since the above collorary proves this property for positroid varieties, and [FoZ00] prove
it for Richardson varieties in G/B, one might conjecture that it would be true for projected
Richardson varieties in other G/Ps. This is not the case: consider the Richardson variety
X4231
1324 projecting to a divisor in the partial ﬂag manifold {(V1 ⊂V3 ⊂C4)}. One can check
that the image contains every T-ﬁxed point, so no extremal weight vector vanishes on it.
For any irreducible T-invariant subvariety X ⊆G/P, the set of T-ﬁxed points XT ⊆
(G/P)T ∼= W/WP forms a Coxeter matroid [BorGeWh03], and X is contained in the set
where the extremal weight vectors corresponding to the complement of XT vanish. If the
containment is proper, as in the above example, one may take this as evidence that the
Coxeter matroid is not a good description of X. We saw a different knock against matroids
in Remark 1.1.
26

6. EXAMPLES OF POSITROID VARIETIES
In this section, we will see that a number of classical objects studied in algebraic geom-
etry are positroid varieties, or closely related to positroid varieties.
First, for any I ∈
 [n]
k

, the Schubert variety XI in the Grassmannian is the positroid
variety associated to the positroid {J : J ≥I}. Similarly, the cyclically permuted Schubert
varieties χi · XI are also positroid varieties. Similarly, the Richardson varieties XK
I are
positroid varieties, corresponding to the positroid {J : I ≤J ≤K}.
Another collection of objects, closely related to Schubert varieties, are the graph Schubert
varieties. Let Xw be a Schubert variety in Fℓ(n). Considering Fℓ(n) as B−\GLn (where
B−is the group of invertible lower triangular matrices), let X′
w be the preimage of Xw
in GLn. The matrix Schubert variety MXw, introduced in [Fu92], is the closure of X′
w
in Matn×n. MXw is cut out of Matn×n by imposing certain rank conditions on the top-left
justiﬁed submatrices (as was explained in §4.1). Embed Matn×n into Gr(n, 2n) by the map
Γ which sends a matrix M to the graph of the linear map ⃗v 7→M⃗v; its image is the big
cell {∆[n] ̸= 0}. In coordinates, Γ(M) is the row span of the n × 2n matrix [ Id M ]. We will
abuse notation by also calling this matrix Γ(M). We introduce here the graph Schubert
variety, GXw, as the closure of Γ(MXw) in Gr(n, 2n). Graph Schubert varieties will be
studied further in a separate paper by the ﬁrst author, [Kn3].
Let us write M[1,i],[1,j] for the top-left i × j submatrix of M. Then the rank of M[1,i],[1,j]
is n −i less than the rank of the submatrix of Γ(M) using rows {i + 1, i + 2, . . ., n, n +
1, . . ., n+j}. So every point of GXw obeys certain rank bounds on the submatrices of these
types. These rank bounds are precisely the rank bounds imposed by r(f), where f is the
afﬁne permutation f(i) = w(i) + n for 1 ≤i ≤n, f(i) = i + n for n + 1 ≤i ≤2n. So
GXw is contained in Πf, with equality on the open set Γ(Matn×n). But Πf and GXw are
both irreducible, so this shows that GXw = Πf. In §7, we will see that cohomology classes
of general positroid varieties will correspond to afﬁne Stanley symmetric functions; un-
der this correspondence, graph Schubert varieties give the classical Stanley symmetric
functions.
The example of graph Schubert varieties can be further generalized [BroGooYa06, §0.7].
Let u and v be two elements of Sn and consider the afﬁne permutation f(i) = u(i) + n
for 1 ≤i ≤n, f(i) = v−1(i −n) + 2n for n + 1 ≤i ≤2n. (So our previous example
was when v is the identity.) Let us look at Πf ∩Γ(Matn×n). This time, we impose condi-
tions both on the ranks of the upper left submatrices and the lower right submatrices. In
fact, ˚Πf lies entirely within Γ(GLn) and is Γ (B−uB+ ∩B+vB−). This is essentially Fomin
and Zelevinsky’s [FoZ01] double Bruhat cell. Precisely, the double Bruhat cell GLu,v
n
is
B+uB+ ∩B−vB−. So the positroid variety Πf is the closure in Gr(n, 2n) of Γ(w0GLw0u,w0v
n
).
Finally, we describe a connection of positroid varieties to quantum cohomology, which
we discuss further in §8. For C any algebraic curve in Gr(k, n), one deﬁnes the degree
of C to be its degree as a curve embedded in P(n
k)−1 by the Pl¨ucker embedding; this can
also be described as
R
Gr(k,n)[C] · [X✷] where X✷is the Schubert divisor. Let I, J and K be
three elements of
 n
k

and d a nonnegative integer, d ≤k, such that codim XI + codim XJ +
codim XK = k(n −k) + dn.
Intuitively, the (genus zero) quantum product ⟨XIXJXK⟩d is the number of curves in
Gr(k, n), of genus zero and degree d, which meet XI(F•), XJ(G•) and XK(H•) for a generic
27

choice of ﬂags F•, G• and H•. This is made precise via the construction of spaces of stable
maps, see [FuPa97].
Deﬁne E(I, J, d) to be the space of degree d stable maps of a genus zero curve with three
marked points to Gr(k, n), such that the ﬁrst marked point lands in XI and the second
marked point lands in XJ. Let S(I, J, d) be the subset of Gr(k, n) swept out by the third
marked point. It is intuitively plausible that ⟨XIXJXK⟩d is
R
Gr(k,n)[S(I, J, d)] · [XK] and we
will show that, under certain hypotheses, this holds. We will show that (under the same
hypotheses) S(I, J, d) is a positroid variety.
7. THE COHOMOLOGY CLASS OF A POSITROID VARIETY
Let H∗(Gr(k, n)), H∗
T(Gr(k, n)) denote the ordinary and equivariant (with respect to the
natural action of T = (C∗)n) cohomologies of the Grassmannian, with integer coefﬁcients.
If X ⊂Gr(k, n) is a T-invariant subvariety of the Grassmannian, we let [X]0 ∈H∗(Gr(k, n))
denote its ordinary cohomology class, and [X] ∈H∗
T(Gr(k, n)) denote its equivariant co-
homology class. We also write [X]|p for the restriction of [X] to a T-ﬁxed point p. We
index the ﬁxed points of Gr(k, n) by
 [n]
k

. We use similar notation for the ﬂag manifold
Fℓ(n), whose ﬁxed points are indexed by Sn. Recall that π : Fℓ(n) →Gr(k, n) denotes the
(T-equivariant) projection.
In [Lam06], a symmetric function ˜Ff ∈Sym is introduced for each afﬁne permutation f.
Let ψ : Sym →H∗(Gr(k, n)) denote the natural quotient map. In this section, we show
Theorem 7.1. Let f ∈Bound(k, n). Then ψ(˜Ff) = [Πf]0 ∈H∗(Gr(k, n)).
7.1. Monk’s rule for positroid varieties. The equivariant cohomology ring H∗
T(Gr(k, n))
is a module over H∗
T(pt) = Z[y1, y2, . . ., yn]. The ring H∗
T(Gr(k, n)) is graded with the
real codimension, so that deg(yi) = 2 and deg([X]T) = 2 codim(X) for an irreducible T-
equivariant subvariety X ⊂Gr(k, n).
Let X□∈H∗
T(Gr(k, n)) denote the class of the Schubert divisor. Note that π∗(X□) ∈
H∗
T(Fℓ(n)) is the class [Xsk] of the kth Schubert divisor. We recall the equivariant Monk’s
formula (see for example [KosKu86]):
(6)
[Xsk].[Xw] = ([Xsk]|w).[Xw] +
X
w⋖kv
[Xv].
Proposition 7.2. Let Πf be a positroid variety with Richardson model Xw
u . Then
(7)
X□· [Πf] = (X□|σ(u)) · [Πf] +
X
u⋖ku′≤kw
[Πfu′,w].
Here σ is the map σk : Sn →
 [n]
k

.
28

Proof. Let Xw
u be a Richardson model for Πf. Then, using the projection formula and (6),
we have in H∗
T(Gr(k, n)),
X□· [Πf] = π∗(π∗(X□) · [Xw] · [Xu])
= ([Xsk]|u) · [Πf] + π∗(
X
u⋖ku′
[Xu′] · [Xw])
= (X□|σ(u)) · [Πf] +
X
u⋖ku′
π∗([Xw
u′]).
But
π∗([Xw
u′]) =

[Πfu′,w]
if u′ ≤k w,
0
otherwise.
□
Corollary 7.3. Let Πf be a positroid variety with Richardson model Xw
u , and let X□⊆Gr(k, n)
denote the Schubert divisor. Then as a scheme,
(u · X□) ∩Πf =
[
u⋖ku′≤kw
Πfu′,w.
Proof. The containment ⊇follows from Theorem 5.15. The above Proposition tells us that
the two sides have the same cohomology class, hence any difference in scheme structure
must occur in lower dimension; this says that (u·X□)∩Πf is generically reduced (and has
no other top-dimensional components). But since Πf is irreducible and normal (Theorem
5.9 and Theorem 5.13), a generically reduced hyperplane section of it must be equidimen-
sional and reduced.
□
Lemma 7.4. The collection of positroid classes [Πf] ∈H∗
T(Gr(k, n)) are completely determined
by:
(1) [Πf] is homogeneous with degree deg([Πf]) = 2ℓ(f),
(2) Proposition 7.2, and
(3) the positroid point classes

[Πtw.ωk] = [σ(w)] | w ∈Smin
n,k
	
.
Proof. Let f ∈Bound(k, n). We may assume by induction that the classes [Πf′] for ℓ(f′) >
ℓ(f) have all been determined. The case ℓ(f) = k(n −k) is covered by assumption (3), so
we assume ℓ(f) < k(n −k). Using Proposition 7.2, we may write
(X□−X□|σ(v)).[Πf] =
X
v⋖kv′≤kw
[Πf(v′,w)].
Now, the class X□−X□|σ(v) does not vanish when restricted to any ﬁxed point J ̸= π(v)
(see [KnTao03]), so the above equation determines [Πf]|J for every J ̸= π(v). Thus if a and
b are two classes in H∗
T(Gr(k, n)) satisfying (7), then a −b must be supported on π(v).
This means that a −b is a multiple of the point class [π(v)]. But deg([π(v)]) = 2k(n −k)
and deg(a) = deg(b) = ℓ(f) < 2k(n −k) so a = b. Thus [Πf] is determined by the three
assumptions.
□
29

7.2. Chevalley formula for the afﬁne ﬂag variety. Let f
Fℓ(n) denote the afﬁne ﬂag vari-
ety of GL(n, C). We let {ξf ∈H∗
T(f
Fℓ(n)) | f ∈˜Sn} denote the equivariant Schubert classes,
as deﬁned by Kostant and Kumar in [KosKu86].
Now suppose that f ∈˜Sn. We say that f is afﬁne Grassmannian if f(1) < f(2) <
· · · < f(n).
For any f ∈˜Sn, we write f0 ∈˜Sn for the afﬁne permutation given by
f0 = [· · ·g(1)g(2) · · ·g(n) · · ·] where g(1), g(2), · · · , g(n) is the increasing rearrangement
of f(1), f(2), · · · , f(n). Then f0 is afﬁne Grassmannian. Suppose that f ⋖g and f0 ̸= g0.
Then we say that g 0-covers f and write f ⋖0 g. These afﬁne analogues of k-covers were
studied in [LamLapMoSh10].
For a transposition (ab) ∈˜S with a < b, we let α(ab) (resp. α∨
(ab)) denote the corre-
sponding positive root (resp. coroot), which we shall think of as an element of the afﬁne
root lattice Q = Ln−1
i=0 Z · αi (resp. afﬁne coroot lattice Q∨= Ln−1
i=0 Z · α∨
i ). We have
α(ab) = αa + αa+1 + · · · αb−1, where the αi are the simple roots, and the indices on the
right hand side are taken modulo n. A similar formula holds for coroots. Note that
α(ab) = α(a+n,b+n).
In the following s0 denotes [· · · k, k + 2, k + 3, . . ., k + n −1, k + n + 1 · · · ] ∈˜Sn.
Lemma 7.5. Suppose that f ∈Bound(k, n). Then
ξs0 · ξf = ξs0|f · ξf +
X
f⋖0g∈Bound(k,n)
ξg + other terms,
where the other terms are a linear combination of Schubert classes not labeled by Bound(k, n).
Proof. We deduce this formula by specializing the Chevalley formula for Kac-Moody ﬂag
varieties in [KosKu86]12, which in our situation states that for any f ∈˜S,
ξs0 · ξf = ξs0|f · ξf +
X
f⋖g=f·(ab)
⟨α∨
(ab), χ0⟩ξg
where χ0 is a weight of the afﬁne root system satisfying ⟨α∨
i , χ0⟩= δi0. We see that
⟨α∨
(ab), χ0⟩= # ({. . . , −2n, −n, 0, n, 2n, . . .} ∩[a, b)).
Now suppose that g ∈Bound(k, n). Since i ≤g(i) ≤i+n, if g·(ab)⋖g then we must have
0 < b −a < n. In this case, the condition that [a, b) intersects {. . . , −2n, −n, 0, n, 2n, . . .}
is the same as f⋖0 g, and furthermore one has ⟨α∨
(ab), χ0⟩= 1. This proves the Lemma.
□
7.3. Positroid classes and Schubert classes in afﬁne ﬂags. For the subsequent discussion
we work in the topological category. Our ultimate aim is to calculate certain cohomology
classes, and changing from the algebraic to the topological category does not alter the
answers. We refer the reader to [PrSe86, Mag] for background material.
Let Un denote the group of unitary n × n matrices and let TR ≃(S1)n denote the sub-
group of diagonal matrices. We write LUn for the space of polynomial loops into Un, and
ΩUn for the space of polynomial based loops into Un. It is known that LUn/TR is weakly
homotopy equivalent to f
Fℓ(n), and that ΩUn ≃LUn/Un is weakly homotopy equivalent
to the afﬁne Grassmannian (see [PrSe86]).
12The formula in Kostant and Kumar [KosKu86], strictly speaking, applies to the afﬁne ﬂag variety
f
Fℓ(n)0 of SL(n). But each component of f
Fℓ(n) is isomorphic to f
Fℓ(n)0.
30

The connected components of ΩUn and LUn are indexed by Z, using the map L det :
LUn →LU1 = Map(S1, U(1)) ∼π1(U(1)) = Z. We take as our basepoint of the k-
component of ΩUn the loop t 7→diag(t, . . ., t, 1, . . ., 1), where there are k t’s. Abusing
notation, we write tωk ∈ΩUn for this point, identifying the basepoint with a translation
element.
The group LUn acts on ΩUn by the formula
(a · b)(t) = a(t)b(t)a(t)−1
where a(t) ∈LUn and b(t) ∈ΩUn. The group Un embeds in LUn as the subgroup of
constant loops. The action of LUn on ΩUn restricts to the conjugation action of U(n) on
U(n). It then follows that the orbit of the basepoint under the action of Un
(8)
Un · tωk ≃Un/(Uk × Un−k)
is isomorphic to the Grassmannian Gr(k, n).
Thus we have a map q : Gr(k, n) ֒→ΩUn. Let r : ΩUn →LUn/T be the map obtained
by composing the natural inclusion ΩUn ֒→LUn with the projection LUn ։ LUn/T. We
let
p := r ◦q : Gr(k, n) −→LUn/T
denote the composition of q and r. All the maps are TR-equivariant, so we obtain a ring
homomorphism p∗: H∗
T(f
Fℓ(n)) →H∗
T(Gr(k, n)).
Lemma 7.6. Suppose w ∈Smin
n,k and I = σ(w), which we identify with a T-ﬁxed point of Gr(k, n).
Then p(I) = tw·ωkTR ∈LUn/TR.
Proof. It follows from the action of Sn ≤Un on ΩUn that q(I) = tw·ωk ∈ΩUn. But by
deﬁnition r(tw·ωk) = tw·ωk ∈LUn.
□
Lemma 7.7.
(1) Suppose w ∈Smin
n,k . Then p∗(ξtw·ωk) = [σ(w)].
(2) p∗(ξs0) = X□.
Proof. We prove (1). Let f = tw·ωk. It is enough to check that ξf|tu·ωk = [π(w)]|σ(u) for
each u ∈Smin
n,k . We have [π(w)]|σ(u) = 0 unless u = w. By [KosKu86, Proposition 4.24(a)],
ξf|g = 0 unless f ≤g. Since f is maximal in Bound(k, n), it is enough to calculate
ξf|f =
Y
α∈f−1(∆−)∩∆+
θ(α).
Here ∆+ (resp. ∆−) are the positive (resp. negative) roots of the root system of ˜Sn, and
θ(α) ∈H∗
T(pt) = Z[y1, y2, . . ., yn] denotes the image of α under the linear map deﬁned by
θ(αi) =

yi −yi+1
for i = 1, 2, . . ., n −1,
yn −y1
for i = 0.
Applying θ corresponds to specializing from H∗
T×S1(f
Fℓ(n)) to H∗
T(f
Fℓ(n)).
With this terminology, α(ab) ∈f−1(∆−) if and only if f(a) > f(b). We have θ(α(ab)) =
ya −yb, where the indices are taken modulo n. Thus
ξf|f =
Y
i∈σ(w) and j∈[n]\σ(w)
(yi −yj)
31

which is easily seen to agree with [π(w)]|σ(w).
Now we prove (2). The class p∗(ξs0) ∈H∗
T(G/P) is of degree 2. So by [KnTao03, Lemma
1], it is enough to show that it vanishes when restricted to the identity basepoint, and
equals X□|sk = yk −yk+1 when restricted to sk. We know that
ξs0|id = 0
and
ξs0|s0 = yk −yk+1
since id < s0, and the inversions of s−1
0
are exactly {αk}. (Here id denotes [· · · k + 1, k +
2, . . ., k + n · · · ].) But we have that tωk is in the same (right) Sn-coset as id and tsk·ωk is
in the same Sn-coset as s0. Since ξs0 is a Grassmannian class, it follows that [KosKu86]
ξs0|id = ξs0|tωk and ξs0|s0 = ξs0|tsk·ωk. Applying Lemma 7.6, we see that p∗(ξs0) has the
desired properties.
□
Theorem 7.8. For each f ∈˜Sk
n, we have in H∗
T(Gr(k, n)),
p∗(ξf) =

[Πf]
if f ∈Bound(k, n),
0
otherwise.
Proof. Suppose f /∈Bound(k, n). Then by [KosKu86, Proposition 4.24(a)], ξf|g = 0 unless
f ≤g, so that ξf|g = 0 for g ∈Bound(k, n) (using Lemma 3.6). It follows that p∗(ξf)
vanishes at each T-ﬁxed point of Gr(k, n), and so it is the zero class.
We shall show that the collection of classes {p∗(ξf) | f ∈Bound(k, n)} satisﬁes the con-
ditions of Lemma 7.4. (1) is clear. (3) follows from Lemma 7.7(1). We check (2). The map
p∗is a ring homomorphism, so the formula in Lemma 7.5 holds for the classes p∗(ξf) as
well. Suppose f ⋖g ∈Bound(k, n) and f = fu,w and g = fu′,w′. As in the proof of Theorem
3.16, we may assume that either (1) u′ = u and w′ ⋖w, or (2) u′ ⋗u and w′ = w. If
f ⋖0 g, then writing fu,w = tu·ωkuw−1 and recalling that right multiplication by uw−1 acts
on the positions, we see that we must have u · ωk ̸= u′ · ωk. This implies that we are in
Case (2), and that u′ ⋗k u. Conversely, if w′ = w and u′ ⋗k u then we must have f ⋖0 g.
Comparing Lemma 7.5 and Proposition 7.2, and using Lemma 7.7(2), we see that we may
apply Lemma 7.4 to the classes {p∗(ξf) | f ∈Bound(k, n)}.
Thus p∗(ξf) = [Πf] for every f ∈Bound(k, n).
□
7.4. Afﬁne Stanley symmetric functions. Let Sym denote the ring of symmetric func-
tions over Z. For each f ∈˜S0
n, a symmetric function ˜Ff ∈Sym, called the afﬁne Stanley
symmetric function is deﬁned in [Lam06]. This deﬁnition extends to all f ∈˜Sn via the
isomorphisms ˜Sk
n ≃˜S0
n.
We will denote the simple reﬂections of the Coxeter group ˜S0
n by s0, s1, . . ., sn−1, where
the indices are taken modulo n. Let w ∈˜S0
n. We say that w is cyclically decreasing if there
exists a reduced expression si1si2 · · ·siℓfor w such that (a) no simple reﬂection is repeated,
and (b) if si and si+1 both occur, then si+1 precedes si. Then the afﬁne Stanley symmet-
ric function ˜Ff is deﬁned by letting the coefﬁcient of xa1
1 xa2
2 · · ·xar
r
in ˜Ff(x1, x2, . . .) to be
equal to the number of factorizations w = w(1)w(2) · · · w(r), where each w(i) is cyclically
decreasing, ℓ(w(i)) = ai, and ℓ(w) = ℓ(w(1)) + ℓ(w(2)) + · · · + ℓ(w(r)).
For example, consider k = 2, n = 4 and f = [5, 2, 7, 4]. The corresponding element of
˜S0
n is f0 = [3, 0, 5, 2]; the reduced words for f0 are s1s3s0s2, s1s3s2s0, s3s1s0s2 and s3s1s2s0.
32

So the coefﬁcient of x1x2x3x4 in ˜Ff is 4, corresponding to these 4 factorizations. Similar
computations yield that ˜Ff = 4m1111 + 2m211 + m22 = s22 + s211 −s1111 where the m’s are
the monomial symmetric functions and the s’s are the Schur functions. Note that afﬁne
Stanley symmetric functions are not necessarily Schur positive!
The ordinary cohomology H∗(ΩSUn) can be identiﬁed with a quotient of the ring of
symmetric functions:
H∗(ΩSUn) ≃Sym/⟨mλ | λ1 > n⟩,
where mλ denotes the monomial symmetric function labeled by λ. We refer to [Sta99] for
general facts concerning symmetric functions, and to [Lam08] for more about H∗(ΩSUn).
Let sλ ∈Sym denote the Schur functions, labeled by partitions. As each component
of ΩUn is homeomorphic to ΩSUn, the inclusion q : Gr(k, n) →ΩUn (deﬁned after (8))
induces a map ˜ψ : H∗(ΩSUn) →H∗(Gr(k, n)). Let ψ : Sym →H∗(Gr(k, n)) denote the
composition of the quotient map Sym ։ H∗(ΩSUn) with ˜ψ : H∗(ΩSUn) →H∗(Gr(k, n)).
For a partition λ = (λ1, λ2, . . ., λk) with λ1 ≤n−k, let σ(λ) be {λk+1, λk−1+2, . . . , λ1+k}.
This is a bijection from partitions with at most k parts and largest part at most n −k to
 [n]
k

. We denote the set of such partitions by Par(k, n).
Lemma 7.9. The map ψ : Sym →H∗(Gr(k, n)) is the natural quotient map deﬁned by
ψ(sλ) =

[Xσ(λ)]0
λ ∈Par(k, n),
0
otherwise.
Proof. The copy of Gr(k, n) inside ΩUn is the union of the
 n
k

Schubert varieties labeled
by the translation elements {tw·ωk | w ∈Smin
n,k }. It follows that the map ˜ψ : H∗(ΩSUn) →
H∗(Gr(k, n)) sends Schubert classes to Schubert classes.
It is well known that H∗(Gr(k, n)) is isomorphic to the quotient ring of Sym as stated
in the Lemma. To check that the quotient map agrees with ψ, it sufﬁces to check that
they agree on the homogeneous symmetric functions hi ∈Sym, which generate Sym. In
[Lam08, Theorem 7.1] it is shown that the Schubert classes of H∗(ΩSUn) are the “afﬁne
Schur functions”, denoted ˜Fλ. When λ is a single row, we have ˜F(r) = hr ∈Sym/⟨mλ |
λ1 > n⟩. Furthermore, the ﬁnite-dimensional Schubert variety in ΩUn with dual Schubert
class ˜F(r) lies in Gr(k, n) ⊂ΩUn exactly when r ≤n −k. It follows that ψ(hr) = [X(r)]0 ∈
H∗(Gr(k, n)) for r ≤n −k, and ψ(hr) = 0 for r ≥n −k. Thus ψ is the stated map.
□
Proof of Theorem 7.1. Let ξf
0 ∈H∗(f
Fℓ(n)) denote the non-equivariant Schubert classes. It is
shown13 in [Lam08, Remark 8.6] that we have r∗(ξf
0) = ˜Ff ∈H∗(ΩSUn), where we identify
˜Ff ∈Sym with its image in H∗(ΩSUn) = Sym/⟨mλ | λ1 > n⟩. Thus we calculate using the
non-equivariant version of Theorem 7.8
[Πf]0 = p∗(ξf
0) = q∗r∗(ξf
0) = ψ(˜Ff).
□
Recall our previous example where k = 2, n = 4 and f = [5274], with siteswap 4040.
This positroid variety is a point. The afﬁne Stanley function ˜Ff was s22 + s211 −s1111, so
ψ(˜Ff) = ψ(s22), the class of a point.
13The setup in [Lam08] involves ΩSUn, but each component of ΩUn is isomorphic to ΩSUn so the
results easily generalize.
33

Example 7.10. Stanley invented Stanley symmetric functions in order to prove that the
number of reduced words for the long word w0 in Sm was equal to the number of standard
Young tableaux of shape (m −1, m −2, . . ., 2, 1). He showed that Fw0 = s(m−1)(m−2)···21, so
the number of reduced words for w0 is the coefﬁcient of the monomial m11···1 in the Schur
polynomial s(m−1)(m−2)···21, as required. See [Sta84] for more background. We show how to
interpret this result using positroid varieties.
Let (k, n) = (m, 2m). The Stanley symmetric function Fw0 is the afﬁne Stanley associ-
ated to the afﬁne permutation
v : i 7→

i + n
1 ≤i ≤n
w0(i −n) + 2n
n + 1 ≤i ≤2n
As discussed in section 6, the positroid variety Πv is a graph matrix Schubert variety,
and can be described as the Zariski closure, within G(m, 2m), of m-planes that can be
represented in the form
RowSpan






1
0
0
0
0
0
0
0
0
∗
0
1
0
0
0
0
0
0
∗
∗
0
0
1
0
0
0
0
∗
∗
∗
0
0
0
1
0
0
∗
∗
∗
∗
0
0
0
0
1
∗
∗
∗
∗
∗






(The example shown is for m = 5.)
Reordering columns turns Πv into the Zariski closure of those m-planes that can be
represented in the form
RowSpan






0
0
0
0
0
0
0
0
1
∗
0
0
0
0
0
0
1
∗
0
∗
0
0
0
0
1
∗
0
∗
0
∗
0
0
1
∗
0
∗
0
∗
0
∗
1
∗
0
∗
0
∗
0
∗
0
∗






This is the Schubert variety X1357···(2m−1), which is associated to the partition (m −1)(m −
2) · · ·321. Reordering columns acts trivially in H•(G(k, n)), so the cohomology classes of
Πv and X135···(2m−1) are the same, and they thus correspond to the same symmetric function.
This shows that Fw0 = s(m−1)(m−2)···21.
7.5. The K- and KT-classes of a positroid variety. We conjecture that the K-class of a
positroid variety is given by the afﬁne stable Grothendieck polynomials deﬁned in [Lam06].
These symmetric functions were shown in [LamSchiSh10] to have the same relationship
with the afﬁne ﬂag manifold as afﬁne Stanley symmetric functions, with K-theory replac-
ing cohomology.
Conjecture 7.11. The K-theory class of the structure sheaf of a positroid variety Πf is given by
the image of the afﬁne stable Grothendieck polynomial ˜Gf, when K∗(Gr(k, n)) is identiﬁed with a
ring of symmetric functions as in [Buc02].
This conjecture would follow from suitable strengthenings of Proposition 7.2, Lemma
7.4, and Lemma 7.5. We have the necessary characterization of the KT positroid classes:
Corollary 7.3 and the main result of [Kn2] give the KT-analogue of Proposition 7.2. The
34

degree-based argument used in Lemma 7.4 must be modiﬁed, in the absence of a grad-
ing on K-theory, to comparing pushforwards to a point, and it is easy to show using
[KnLamSp, Theorem 4.5] that the pushforward of a positroid class is 1. What is currently
missing are the two corresponding results on afﬁne stable Grothendieck polynomials.
While the class associated to an algebraic subvariety of a Grassmannian is always a
positive combination of Schubert classes, this is not visible from Theorem 7.1, as afﬁne
Stanley functions are not in general positive combinations of Schur functions sλ.
We can give a much stronger positivity result on positroid classes:
Theorem 7.12. Let X be a positroid variety, and [OX] ∈KT(Gr(k, n)) the class of its structure
sheaf in equivariant K-theory. Then in the expansion [OX] = P
λ aλ[Oλ] into classes of Schubert
varieties, the coefﬁcient aλ ∈KT(pt) lies in (−1)|λ|−dim XN [{e−αi −1}], where the {αi} are the
simple roots of GL(n).
Proof. This is just the statement of [AGriMil, Corollary 5.1], which applies to any T-
invariant subvariety X of a ﬂag manifold such that X has rational singularities (as positroid
varieties do, [KnLamSp, Corollary 4.8]).
□
After our ﬁrst version of this preprint was circulated, a very direct geometric proof
of Theorem 7.8 was given in [Sni10], which also proves the corresponding statement in
equivariant K-theory. Snider identiﬁes each afﬁne patch on Gr(k, n) with an opposite
Bruhat cell in the afﬁne ﬂag manifold, T-equivariantly, in a way that takes the positroid
stratiﬁcation to the Bruhat decomposition, thereby corresponding the KT-classes.
8. QUANTUM COHOMOLOGY, TORIC SCHUR FUNCTIONS, AND POSITROIDS
8.1. Moduli spaces of stable rational maps to the Grassmannian. For background mate-
rial on stable maps we refer the reader to [FuWo04]. Let I, J ∈
 [n]
k

, which we assume to be
ﬁxed throughout this section. We now investigate the variety S(I, J, d) consisting of points
lying on a stable rational map of degree d, intersecting XJ ⊂Gr(k, n) and XI ⊂Gr(k, n).
Let M0,3(d) denote the moduli space of stable rational maps to Gr(k, n) with 3 marked
points and degree d. Write p1, p2, p3 : M0,3(d) →Gr(k, n) for the evaluations at the three
marked points.
Denote by E(I, J, d) the subset
E(I, J, d) = p−1
1 (XJ) ∩p−1
2 (XI) ⊂M0,3(d).
It is known [FuWo04] that E(I, J, d) is reduced and locally irreducible, with all com-
ponents of dimension dim(XJ) + dim(XI) + dn −k(n −k). Furthermore, the pushfor-
ward (p3)∗([E(I, J, d)]) ∈H∗(Gr(k, n)) is a generating function for three-point, genus zero,
Gromov-Witten invariants, in the sense that
(9)
(p3)∗([E]) · σ = ⟨[XJ], [XI], σ⟩d
for any class σ ∈H∗(Gr(k, n)). We now deﬁne S(I, J, d) := p3(E(I, J, d)). Let us say that
there is a non-zero quantum problem for (I, J, d) if ⟨[XJ], [XI], σ⟩d is non-zero for some
σ ∈H∗(Gr(k, n)). It follows from (9) that S(I, J, d) and E(I, J, d) have the same dimension
whenever there is a non-zero quantum problem for (I, J, d), namely,
(10)
dim(S(I, J, d)) = dim(E(I, J, d)) = dim(XJ) + dim(XI) + dn −k(n −k).
35

The torus T acts on M0,3(d) and, since XJ and XI are T-invariant, the space E(I, J, d) also
has a T-action. The torus ﬁxed-points of E(I, J, d) consist of maps f : C →Gr(k, n), where
C is a tree of projective lines, such that f∗(C) is a union of T-invariant curves in Gr(k, n)
whose marked points are T-ﬁxed points, satisfying certain stability conditions. Since p3
is T-equivariant, we have S(I, J, d)T = p3(E(I, J, d)T). The T-invariant curves in Gr(k, n)
connect pairs of T-ﬁxed points labeled by I, J ∈
 [n]
k

satisfying |I ∩J| = k −1. We’ll write
T(I, J, d) for S(I, J, d)T, considered as a subset of
 [n]
k

.
We now survey the rest of this section. In §8.2, we use the ideas of the previous para-
graph to give an explicit combinatorial description of T(I, J, d). We then deﬁne an ex-
plicit afﬁne permutation f associated to (I, J, d) in (11) below.
We say that (I, J, d) is
valid if for i ∈I, we have i + k ≤f(I, J, d)(i) ≤i + n and, for m ∈[n] \ I, we have
m ≤f(I, J, d)(m) ≤m + k. In particular, (I, J, d) is valid implies f(I, J, d) is bounded. The
main result of this section is:
Theorem 8.1. When (I, J, d) is valid, the image p3(E(I, J, d)) is Πf. Moreover, there is one
component F0 of E(I, J, d) for which p3 : F0 →Πf is birational; on any other component F of
E(I, J, d), we have dim p3(F) < dim F.
When (I, J, d) is not valid, then dim p3(F) < dim F for every component F of E(I, J, d). Thus,
(I, J, d) is valid if and only if there is a non-zero quantum problem for (I, J, d).
Our key combinatorial result is
Proposition 8.2. Let (I, J, d) be valid.
Then T(I, J, d) is the positroid corresponding to the
bounded afﬁne permutation f(I, J, d).
We should point out that we use previously known formulas for Gromov-Witten invari-
ants to establish part of Theorem 8.1. Namely, when f is valid, we can establish directly
that p3(E(I, J, d)) ⊆Πf. To prove that (p3)∗([E]) = [Πf], we combine previous work of
Postnikov with Theorem 7.1.
It was shown in [Lam06] that ψ(˜Ff) is Postnikov’s “toric Schur function”. Postnikov
showed that this toric Schur function computed Gromov-Witten invariants but did not
provide a subvariety of Gr(k, n) representing his class; Theorem 8.1 can thus be viewed
as a geometric explanation for toric Schur functions.
8.2. Formulas for T(I, J, d) and f(I, J, d). We proceed to describe S(I, J, d)T explicitly.
If I ∈
 [n]
k

, then we let A(I) (resp. B(I)) denote the upper (resp. lower) order ideals
generated by I. Thus A(J) = {K ∈
 [n]
k

| K ≥J} is the set of T-ﬁxed points lying in XJ
and B(I) is the set of T-ﬁxed points lying in XI. Deﬁne the undirected Johnson graph Gk,n
with vertex set
 [n]
k

, and edges I ↔J if |I ∩J| = k −1. The distance function dist(I, J) in
Gk,n is given by dist(I, J) = k −|I ∩J|. Then one has
S(I, J, d)T = T(I, J, d) :=

K ∈
[n]
k

| dist(K, B(I)) + dist(K, A(J)) ≤d

.
For a pair (I, J), it is shown in [FuWo04] the minimal d such that T(I, J, d) is non-empty
(or equivalently, that there is a path of length d from I to J in Gk,n), is equal to the minimal
d such that a non-zero quantum problem for (I, J, d) exists.
Denote by M = {m1 < m2 < · · · < mn−k} the complement of I in [n] and similarly
L = {l1 < l2 < · · · < ln−k} the complement of J. We deﬁne a bi-inﬁnite sequence ˜i such
36

that ˜ia = ia for 1 ≤a ≤k and ˜ia+k = ˜ia + n. Similarly, we extend J, M and L to bi-inﬁnite
sequences˜j, ˜m and ˜l, such that˜ja+k = ˜ja +n, ˜ma+n−k = ˜ma +n and ˜la+n−k = ˜la +n. Deﬁne
an afﬁne permutation f(I, J, D) by
(11)
f(I, J, d)(˜ir) = ˜jr+k−d
f(I, J, d)( ˜mr) = ˜lr+d
We say that (I, J, d) is valid if, for i ∈I, we have i + k ≤f(I, J, d)(i) ≤i + n and, for
m ∈M, we have m ≤f(I, J, d)(m) ≤m + k. In particular, if (I, J, d) is valid, then f(I, J, d)
is bounded.
For example, let k = 2 and n = 6. Pick I = {1, 4}, J = {2, 4}, d = 1. Then M =
{2, 3, 5, 6} and L = {1, 3, 5, 6}. The equation f(˜ir) = ˜jr+k−d gives f(1) = 4 and f(4) = 8. The
equation f( ˜mr) = ˜lr+d gives f(2) = 3, f(3) = 5, f(5) = 6 and f(6) = 7. Thus f(I, J, d) =
[· · ·435867 · · ·].
Our next task is to prove proposition 8.2; we shorten f(I, J, d) to f. Our approach is to
ﬁrst ﬁnd the cyclic rank matrix for f. Let ˜I and ˜J be the preimages of I and J under the pro-
jections Z →Z/nZ. For integers a ≤b, we adopt the shorthand I[a, b] for #

˜I ∩[a, b]

and similar notations J[a, b) etcetera. For 1 ≤a ≤b ≤a + n, deﬁne
(12)
rab := min (b −a + 1, d + J[1, b] −I[1, a), k)
and deﬁne rab for all rab such that ra+n,b+n = rab; by rab = b −a + 1 for a > b and by
rab = k for a + n < b.
Lemma 8.3. If (I, J, d) is valid, then the matrix rab is the cyclic rank matrix for f.
It will be convenient to introduce the functions α1(a, b) = b −a + 1, α2(a, b) = d +
J[1, b] −I[1, a) and α3(a, b) = k, so that rab = min(α1(a, b), α2(a, b), α3(a, b)).
Proof. We ﬁrst check that rab is a cyclic rank matrix, meaning that it obeys the conditions
in Corollary 3.12. Conditions (C1′), (C2′) and (C5) hold by deﬁnition.
For r = 1, 2 or 3, it is easy to see that, αr(a, b) −αr(a + 1, b) and αr(a, b + 1) −αr(a, b)
are clearly either 0 or 1, and are integer valued. So rab −r(a+1)b) and rab −ra(b−1) are either
0 or 1. This veriﬁes (C3).
Similarly, for any (a, b) and r = 1, 2 or 3, the 2 × 2 matrix

αr(a,b−1)
αr(a,b)
αr(a+1,b−1) αr(a+1,b)

is of one
of the forms

s
s
s
s


s
s + 1
s
s + 1


s + 1
s + 1
s
s


s + 1
s + 2
s
s + 1

for some integer s. Looking at what happens when we take the minimum of three ma-
trices of this form (where we never take both the two middle matrices), we see that we
always get one of the above forms, or
  s+1 s+1
s
s+1

. In particular, condition (C4) holds. We
have now shown that rab is a cyclic rank matrix. Let g be the associated permutation.
We now show that g = f. Let (a, b) = (ir,˜jr+k−d) for some r between 1 and k. Then
#

˜I ∩[1, a)

= r−1 and #

˜J ∩[1, b]

= r+k−d, so α2(a, b) = k+1. Similar arguments
let us compute

α2(a, b −1)
α2(a, b)
α2(a + 1, b −1)
α2(a + 1, b)

=

k
k + 1
k −1
k

.
37

The assumption that ir + k ≤f(I, J, d)(ir) = ˜jr+k−d translates into b −a ≥k, so the α1 term
in (12) has no effect and we deduce that

ra,b−1
ra,b
ra+1,b−1
ra+1,b

=

k
k
k −1
k

.
By the last sentence of Corollary 3.10, this means that g(a) = b.
Similarly, if (a, b) = (mr,˜lr+d) we can show that g(a) = b. So, for every a ∈Z, we have
shown that g(a) = f(a), as desired.
□
We now begin proving the lemmas which will let us prove Proposition 8.2.
Lemma 8.4. We have dist(K, B(I)) ≤s if and only if for all r ∈[n], one has I[1, r) −K[1, r) ≤s.
Proof. Suppose dist(K, B(I)) ≤s. Then dist(K, L) ≤s for some L ≤I. Thus for each r, we
have I[1, r) −K[1, r) ≤L[1, r) −K[1, r) ≤s.
Now suppose I[1, r) −K[1, r) ≤s for each r. Construct L ≤I recursively, starting with
L = ∅. Assume L ∩[1, r) is known. If r ∈K, place r in L. Otherwise, if r /∈K, place r in L
only if r ∈I and L[1, r) = I[1, r). Repeat until we have constructed a k-element subset L
which clearly satisﬁes L ≤I. The elements in L \ K are all in I. Let ℓbe the largest element
in L\K. Then I[1, ℓ] differs from K[1, ℓ] by |L\K|, and so |L\K| ≤s. Thus dist(K, L) ≤s.
□
Lemma 8.5. We have K ∈T(I, J, d) if and only if
(13)
I[1, r) −K[1, r) + K[1, s) −J[1, s) ≤d
for all 1 ≤r, s, ≤n + 1.
Proof. By Lemma 8.4, we have K ∈T(I, J, d) if and only if
(14)
max(I[1, r) −K[1, r), 0) + max(K[1, s) −J[1, s), 0) ≤d
for all 1 ≤r, s, ≤n+1. Equation (14) certainly implies the stated condition. Conversely, if
(13) holds, but (14) fails, then we must have I[1, r) −K[1, r) > d or K[1, s) −J[1, s) > d for
some r, s. In the ﬁrst case setting s = 1 in (13) gives a contradiction. In the second case,
setting r = 1 gives a contradiction.
□
Proof of Proposition 8.2. First, suppose that K ∈T(I, J, d).
By Lemma 8.3, K is in the positroid corresponding to f(I, J, d) if and only if for each
cyclic interval [a, b] ⊂[n] we have
K[a, b] ≤min(b −a + 1, d + J[1, b] −I[1, a), k).
Since #[a, b] = b−a+1 and #(K) = k, we always have K[a, b] ≤b−a+1 and K[a, b] ≤k,
so we must check that K[a, b] ≤d + J[1, b] −I[1, a).
First, suppose that 1 ≤a ≤b ≤n. Then K[a, b] = K[1, b] −K[1, a) so the required
equation is
K[1, b] −K[1, a) ≤d + J[1, b] −I[1, a).
This is easily equivalent to (13) for (r, s) = (a, b). Now, suppose that a ≤n < b. Then
K[a, b] := K[1, b] −K[1, a) and we again want to show that K[1, b] −K[1, a) ≤d + J[1, b] −
I[1, a). Let b = b′ + n. Then K[1, b] = K[1, b′] + n and J[1, b] = J[1, b′] + n. So it is
equivalent to show
K[1, b′] −K[1, a) ≤d + J[1, b′] −I[1, a)
38

which is (13) for (r, s) = (a, b′).
The reverse implication is similar.
□
8.3. Toric shapes and toric Schur functions. In [Pos05], Postnikov introduced a family
of symmetric polynomials, called toric Schur polynomials, and showed that the expansion
coefﬁcients of these symmetric functions in terms of Schur polynomials gave the three-
point, genus zero, Gromov-Witten invariants of the Grassmannian. In [Lam06], it was
shown that toric Schur functions were special cases of afﬁne Stanley symmetric functions.
We now put these results in the context of Theorem 7.1 and equation (9): the subvariety
S(I, J, d) ⊂Gr(k, n) is a positroid variety whose cohomology class is a toric Schur poly-
nomial.
We review the notion of a toric shape and refer the reader to [Pos05] for the notion of a
toric Schur function. A cylindric shape is a connected, row and column convex subset of
Z2 which is invariant under the translation (x, y) 7→(x + n −k, y −k). Also, every row
or column of a cylindric shape must be ﬁnite, and in addition the “border” of a cylindric
shape is an inﬁnite path which has steps going north and east only (when read from the
southwest). A toric shape is a cylindric shape such that every row has at most n −k
boxes, and every column has at most k boxes. For example, the following is a toric shape
for k = 2, n = 5:
where a fundamental domain for the action of the translation has been highlighted. In
[Pos05], Postnikov associated a toric shape θ(I, J, d) to each triple (I, J, d) for which a non-
trivial quantum problem could be posed involving the Schubert varieties XI and XJ, and
rational curves of degree d. The steps of the upper border of θ is determined by I, the
lower border by J. The gap between the two borders is determined by d. We do not give
a precise description of Postnikov’s construction here as our notations differ somewhat
from Postnikov’s.
If θ is a cylindric shape, we can obtain an afﬁne permutation as follows. First label
the edges of the upper border of θ by integers, increasing from southwest to northeast.
Now label the edges of the lower border of θ by integers, so that if e and e′ are edges
on the upper border and lower border respectively, and they lie on the same northwest-
southeast diagonal, then e′ has a label which is k bigger than that of e. One then deﬁnes
f(θ) as follows: if a ∈Z labels a vertical step of the upper border, then f(a) is the label of
the step of the lower border on the same row; if a ∈Z labels a horizontal step, then f(a)
is the label of the step of the lower border on the same column. This determines θ(I, J, d)
from f(I, J, d) up to a translation: the equations (11) say that the labels inside I or J are
vertical steps, while labels in M and L are horizontal steps.
The condition that (I, J, d) is valid translates to θ(I, J, d) being toric. In our language,
Postnikov [Pos05, Lemma 5.2 and Theorem 5.3] shows that a non-trivial quantum prob-
lem exists for (I, J, d) if and only if the toric shape θ(I, J, d) is well-deﬁned. Thus:
39

Lemma 8.6. A non-trivial quantum problem exists for (I, J, d) if and only if (I, J, d) is valid.
Lemma 8.7. Suppose (I, J, d) is valid. Then
ℓ(f(I, J, d)) = |θ(I, J, d)| = codim(XJ) + codim(XI) −dn.
where |θ(I, J, d)| is the number of boxes in a fundamental domain for θ(I, J, d).
Proof. The ﬁrst equality follows from [Lam06], and can be explained simply as follows:
each box in a fundamental domain for θ(I, J, d) corresponds to a simple generator in a
reduced expression for f(I, J, d). Indeed, the equations (11) can be obtained by ﬁlling
θ(I, J, d) with a wiring diagram, where each wire goes straight down (resp. across) from
a horizontal (resp. vertical) step. The second equality follows from [Pos05]. A simple
proof is as follows: if we decrease d by 1, then the lower border of d is shifted one step
diagonally southeast, increasing |θ(I, J, d)| by n. When the upper and lower borders are
far apart, then changing codim(XI) or codim(XJ) by one also changes |θ(I, J, d)| by one.
Finally, when I = J and d = 0, one checks that |θ(I, J, d)| is k(n −k).
□
Proof of Theorem 8.1. Suppose that (I, J, d) is valid.
Consider any index K ∈
 [n]
k

\ T(I, J, d). Then the Pl¨ucker coordinate pK is zero on
T(I, J, d), and hence on S(I, J, d). By Corollary 5.12, Πf is cut out by {pK = 0 | K /∈T(I, J, d)},
so S(I, J, d) ⊆Πf.
By Lemma 8.7, (10) and Theorem 5.9, S(I, J, d) and Πf(I,J,d) have the same dimension and
Πf is irreducible. So S(I, J, d) = Πf. Now, let F1, F2, . . . , Fr be the components of E(I, J, d);
let c1, c2, . . . , cr be the degrees of the maps p3 : Fi →S(I, J, d). Using again that Πf is
irreducible, we know that (p3)∗(E(I, J, d)) = (Pr
i=1 ci) [Πf]. By the main result of [Pos05],
the left hand side of this equation is the toric Schur polynomial with shape θ(I, J, d) and
by [Lam06, Proposition 33], this is the afﬁne Stanley function ψ(˜Ff). But by Theorem 7.1,
the right hand side is (Pr
i=1 ci) ψ(˜Ff). So Pr
i=1 ci = 1. We deduce that p3 is birational on
one component of S(I, J, d) and collapses every other component.
Finally, if (I, J, d) is not valid, then there is no nonzero quantum product for (I, J, d) by
Lemma 8.6, so p3 must collapse all components of E(I, J, d) in this case.
□
8.4. Connection with two-step ﬂag varieties. Let Fℓ(k −d, k, k + d; n) and Fℓ(k −d, k +
d; n) be the spaces of three-step and two-step ﬂags of dimensions (k −d, k, k + d) and
(k −d, k + d) respectively. We have maps q1 : Fℓ(k −d, k, k + d; n) →Gr(k, n) and
q2 : Fℓ(k −d, k, k + d; n) →Fℓ(k −d, k + d; n). For a subvariety X ⊂Gr(k, n) we deﬁne,
following [BucKresTam03],
X(d) = q2(q−1
1 (X)) ⊂Fℓ(k −d, k + d; n).
Let us now consider the subvariety
Y(I, J, d) = (XJ)(d) ∩(XI)(d) ⊂Fℓ(k −d, k + d; n).
Buch-Kresch-Tamvakis studied varieties similar to Y(I, J, d), which arise from intersec-
tions of three Schubert varieties, and showed in a bijective manner that these intersec-
tions solved quantum problems. Let us now consider the subvariety q1(q−1
2 (Y(I, J, d))) ⊂
Gr(k, n). The subvarieties (XJ)(d), (XI)(d) ⊂Fℓ(k −d, k + d; n) are Schubert (and oppo-
site Schubert) subvarieties. Thus q1(q−1
2 (Y(I, J, d))) ⊂Gr(k, n) is a positroid variety by
Theorem 5.9.
40

The following result can also be deduced directly from [BucMih].
Proposition 8.8. Suppose (I, J, d) is valid. Then q1(q−1
2 (Y(I, J, d))) = S(I, J, d).
Proof. Let us ﬁrst show that S(I, J, d) ⊂q1(q−1
2 (Y(I, J, d))). Since (I, J, d) is valid, we know
that dim S(I, J, d) = dim(XJ) + dim(XI) + dn −k(n −k) =: N. Choose K ∈
 [n]
d

such that
codim XK = N and ⟨[S(I, J, d)], [XK]⟩̸= 0. Then, for a general ﬂag F•, S(I, J, d) intersects
XK(F•) at a ﬁnite set of points. Moreover, the set of all points that occur as such intersec-
tions is dense in S(I, J, d). (If this set were contained in a subvariety of smaller dimension,
then XK(F•) would miss S(I, J, d) for generic F•, contradicting our choice of K.)
So, for V in a dense subset of S(I, J, d), we know that V also lies on some XK(F•) and we
can impose furthermore that F• is in general position with both E• and w0E•. It follows
from [BucKresTam03, Theorem 1] that there is a corresponding point W ∈Y(I, J, d) such
that V ∈q1(q−1
2 (W)). Thus S(I, J, d) ⊂q1(q−1
2 (Y(I, J, d))).
Conversely, let W ∈Y(I, J, d) be a generic point, and Z = q1(q−1
2 (W)) ⊂Gr(k, n).
The space Z is isomorphic to Gr(d, 2d). Pick a point U ∈Z ∩XJ and V ∈Z ∩XI, and
another generic point T ∈Z. By [BucKresTam03, Proposition 1], there is a morphism
f : P1 →Z ⊂Gr(k, n) of degree d which passes through U, V, and T. It follows that a
generic point in Z lies in S(I, J, d). Thus q1(q−1
2 (Y(I, J, d))) ⊂S(I, J, d).
□
8.5. An example. Let k = 2 and n = 5. We take I = J = {1, 4} and d = 1. The afﬁne
permutation f(I, J, d) is [· · ·43567 · · ·], with siteswap 31222. The positroid T(I, J, d) is
{12, 13, 14, 15, 24, 25, 34, 35, 45}and the juggling states are J (f(I, J, d)) = (12, 13, 12, 12, 12).
If we pull back Y(I, J, d) to Fℓ(n) we get the Richardson variety X45132
12435. (Following the de-
scription given in [BucKresTam03], we obtained 12435 by sorting the entries of the Grass-
mannian permutation 14235 in positions k−d+1, k−d+2, . . . , k+d in increasing order.
For 45132, we ﬁrst applied w0 to J = {1, 4} to get {2, 5}. Then we did the sorting, and
left-multiplied by w0 again.)
By [KnLamSp, Proposition 3.3], we have π(X45132
12435) = π(X54312
21543). With (u, w) = (21543, 54312),
we have fu,w = [2, 1, 5, 4, 3] · t(1,1,0,0,0) · [4, 5, 3, 2, 1] = [4, 3, 5, 6, 7], agreeing with f(I, J, d).
Alternatively, one can check that the T-ﬁxed points inside X54312
21543, that is, the interval
[21543, 54312], project exactly to T(I, J, d).
REFERENCES
[AGriMil] D. ANDERSON, S. GRIFFETH, E. MILLER: Positivity and Kleiman transversality in equivariant
K-theory of homogeneous spaces. http://arxiv.org/abs/0808.2785 (In §7.5)
[BeSo98] N. BERGERON, F. SOTTILE: Schubert polynomials, the Bruhat order, and the geometry of ﬂag
manifolds, Duke Math. J. 95 (1998), no. 2, 373–423. http://arxiv.org/abs/alg-geom/9703001 (In
§2.3, 2.1, and 2.5)
[BiCo] S. BILLEY,
I. COS¸KUN:
Singularities of generalized Richardson varieties,
preprint 2010.
http://arxiv.org/abs/1008.2785 (In §1.1)
[BjBre05] A. BJ ¨ORNER, F. BRENTI: Combinatorics of Coxeter Groups, Graduate Texts in Mathematics, 231.
Springer-Verlag, New York, 2005. (In §3.3)
[BjWac82] A. BJ ¨ORNER, M. WACHS: Bruhat order of Coxeter groups and shellability, Adv. in Math. 43
(1982), no. 1, 87–100. (In §3.5)
[BoDM06] J. BONIN, A. DE MIER: Lattice path matroids: Structural properties, European Journal of Com-
binatorics, 27 (2006) 701–738. http://arxiv.org/abs/math.CO/0403337 (In §1.1)
41

[BorGeWh03] A. BOROVIK, I. GELFAND, N. WHITE: Coxeter matroids. Progress in Mathematics, 216.
Birkh¨auser Boston, Inc., Boston, MA, 2003. (In §5.17)
[Bri02] M. BRION: Positivity in the Grothendieck group of complex ﬂag varieties, J. Algebra (special vol-
ume in honor of Claudio Procesi) 258 (2002), 137–159. (In §1.1)
[Bri05]
: Lectures on the Geometry of Flag Varieties, in Topics in cohomological studies of algebraic
varieties, ed. Piotr Pragacz, Trends in Mathematics. Birkh¨auser Verlag, 2005, 33–85.
[BroGooYa06] K.
BROWN,
K.
GOODEARL,
M.
YAKIMOV:
Poisson
structures on afﬁne spaces
and
ﬂag
varieties
I.
Matrix
afﬁne
Poisson
space,
Adv.
Math.
206
(2006),
567–629.
http://arxiv.org/abs/math.QA/0501109 (In §1.1, 5.3, 5.4, and 6)
[Bry86] T. BRYLAWSKI: Appendix of Matroid Cryptomorphisms, Theory of Matroids, N. White ed. Encyclo-
pedia Math. Appl. 26 (1986), 298–312. (In §3.6)
[Buc02] A. S. BUCH: A Littlewood-Richardson rule for the K-theory of Grassmannians, Acta Math. 189
(2002), 37–78. http://arxiv.org/abs/math.AG/0004137 (In §7.11)
[BucKresTam03] A. S. BUCH, A. KRESCH, H. TAMVAKIS: Gromov-Witten invariants on Grassmannians,
J. Amer. Math. Soc. 16 (2003), no. 4, 901–915 (electronic). http://arxiv.org/abs/math.AG/0306388
(In §1.4, 8.4, 8.4, and 8.5)
[BucMih] A. S. BUCH, L. MIHALCEA: Quantum K-theory of Grassmannians, to appear in Duke Math. J.
http://arxiv.org/abs/0810.0981 (In §8.4)
[BuEiGraWr94] J. BUHLER, D. EISENBUD, R. GRAHAM, C. WRIGHT: Juggling drops and descents, Amer.
Math. Monthly 101 (1994), no. 6, 507–519. http://www.msri.org/~de/papers/pdfs/1994-001.pdf
(In §1.2)
[ChGra07] F. CHUNG, R. GRAHAM: Universal juggling cycles, Combinatorial Number Theory, B. Landman,
M.B. Nathanson, J. Nesetril, R.J. Nowakowski, C. Pomerance, eds. (2007), 121–130. (In §1.2)
[ChGra08]
,
: Primitive juggling sequences, Amer. Math. Monthly 115 (2008), no. 3, 185–194.
(In §1.2)
[DeLak81] C. DE CONCINI, V. LAKSHMIBAI: Arithmetic Cohen-Macaulayness and arithmetic normality
for Schubert varieties, Amer. J. Math. 103 (1981), no. 5, 835–850.
[Dy93] M. DYER: Hecke algebras and shellings of Bruhat intervals, Compositio Math. 89 (1993), 91–115.
(In §3.5)
[EhRe96] R. EHRENBORG, M. READDY: Juggling and applications to q-analogues, Discrete Math. 157
(1996), no. 1-3, 107–125. (In §1.2, 3.1, and 3.2)
[FoZ00] S. FOMIN, A. ZELEVINSKY: Recognizing Schubert cells, Journal of Algebraic Combinatorics 12
(2000), 37–57. http://arxiv.org/abs/math/9807079 (In §5.5 and 5.17)
[FoZ01]
,
: Double Bruhat cells and total positivity, J. Amer. Math. Soc. 12 (1999), no. 2, 335–
380. http://arxiv.org/abs/math.RT/9802056 (In §6)
[Fu92] W. FULTON: Flags, Schubert polynomials, degeneracy loci, and determinantal formulas, Duke
Math. J. 65 (1992), no. 3, 381–420. (In §3.3, 4.1, and 6)
[FuPa97] W. FULTON, R. PANDHARIPANDE: Notes on stable maps and quantum cohomology. Algebraic
geometry—Santa Cruz 1995, 45–96, Proc. Sympos. Pure Math., 62, Part 2, Amer. Math. Soc., Provi-
dence, RI, 1997. http://arxiv.org/abs/alg-geom/9608011 (In §6)
[FuWo04] W. FULTON, C. WOODWARD: On the quantum product of Schubert classes, J. Algebraic Geom.
13 (2004), no. 4, 641–661. http://arxiv.org/abs/math.AG/0112183 (In §8.1 and 8.2)
[GeGorMacSe87] I. GEL ′FAND, M. GORESKY, R. MACPHERSON, V. SERGANOVA: Combinatorial geome-
tries, convex polyhedra, and Schubert cells, Adv. in Math. 63 (1987), no. 3, 301–316. (In §1.1 and 5.4)
[GooYa] K. GOODEARL, M. YAKIMOV: Poisson structures on afﬁne spaces and ﬂag varieties. II. Trans.
Amer. Math. Soc. 361 (2009), no. 11, 5753–5780. http://arxiv.org/abs/math/0509075v2 (In §1.1,
2.3, and 5.3)
[Ha77] R. HARTSHORNE: Algebraic Geometry, Graduate Texts in Mathematics, 52. Springer-Verlag, New
York, 1977.
[HeLa] X. HE, T. LAM:
Projected Richardson varieties and afﬁne Schubert varieties, preprint 2011.
http://arxiv.org/abs/1106.2586 (In §1 and 7)
[Ho72] M. HOCHSTER: Rings of invariants of tori, Cohen-Macaulay rings generated by monomials, and
polytopes, Ann. of Math. (2) 96 (1972), 318–337.
42

[Kn93] A. KNUTSON: The siteswap FAQ. (1993) http://www.juggling.org/help/siteswap/faq.html(In
§1.2)
[Kn2]
: Frobenius splitting and M¨obius inversion, preprint. http://arxiv.org/abs/0902.1930(In
§7.5)
[Kn3]
: Matroids, shifting, and Schubert calculus, in preparation. (In §6)
[KnLamSp]
,
,
: Projections of Richardson varieties, preprint, 2010; arXiv:1008.3939.
(In §(document), 1.1, 1.1, 2.3, 2.3, 5.5, 5.6, 5.4, 5.5, 5.5, 7.5, 7.5, and 8.5)
[KnTao03]
, T. TAO: Puzzles and (equivariant) cohomology of Grassmannians, Duke Math. J. 119
(2003), no. 2, 221–260. http://arxiv.org/abs/math.AT/0112150 (In §7.1 and 7.3)
[KosKu86] B. KOSTANT, S. KUMAR: The nil Hecke ring and cohomology of G/P for a Kac-Moody group
G, Adv. in Math. 62 (1986), no. 3, 187–237. (In §7.1, 7.2, 7.2, 12, 7.3, and 7.3)
[KreiLak04] V. KREIMAN, V. LAKSHMIBAI: Richardson Varieties in the Grassmannian, Contributions to
automorphic forms, geometry, and number theory, 573–597, Johns Hopkins Univ. Press, Baltimore,
MD, 2004. http://arxiv.org/abs/math.AG/0203278
[Lam06] T. LAM:
Afﬁne Stanley symmetric functions, American J. of Math., 128 (2006), 1553–1586.
http://www.arxiv.org/abs/math.CO/0501335 (In §1.3, 1.4, 7, 7.4, 7.5, 8.1, 8.3, and 8.3)
[Lam08]
: Schubert polynomials for the afﬁne Grassmannian, J. Amer. Math. Soc., 21 (2008), 259–
281. http://www.arxiv.org/abs/math.CO/0603125 (In §7.4, 7.4, and 13)
[LamLapMoSh10]
,
L.
LAPOINTE,
J.
MORSE,
M.
SHIMOZONO:
Afﬁne
insertion
and
Pieri
rules
for
the
afﬁne
Grassmannian,
Memoirs
of
the
AMS,
208
(2010),
no.
977.
http://www.arxiv.org/abs/math.CO/0609110 (In §7.2)
[LamSchiSh10]
, A. SCHILLING, M. SHIMOZONO: K-theory Schubert calculus of the afﬁne Grass-
mannian, Compositio Mathematica, 146 (2010), 811–852. http://arxiv.org/abs/0901.1506 (In
§7.5)
[LasSch¨u82] A. LASCOUX, M. SCH ¨UTZENBERGER: Symmetry and ﬂag manifolds, in Invariant Theory,
(Montecatini, 1982), vol. 996 of Lecture Notes in Math., Springer-Verlag, 1983, pp. 118144. (In §2.3)
[LauLeRig08] S. LAUNOIS, T. LENAGAN, L. RIGAL: Prime ideals in the quantum grassmannian, Selecta
Mathematica 13 (2008), 697–725. http://arxiv.org/abs/0708.0744 (In §1.1)
[Lus98] G. LUSZTIG: Total positivity for partial ﬂag varieties, Represent. Theory 2 (1998), 70–78. (In §1.1,
1.2, 5.3, and 5.4)
[Mag] P. MAGYAR: Notes on Schubert classes of a loop group, preprint.
http://arxiv.org/abs/0705.3826 (In §7.3)
[MarRie04] R. MARSH, K. RIETSCH: Parametrizations of ﬂag varieties, Represent. Theory, 8 (2004), 212–
242. http://arxiv.org/abs/math.RT/0307017 (In §1.2)
[MilStu05] E. MILLER, B. STURMFELS: Combinatorial commutative algebra, Graduate Texts in Mathemat-
ics, 227. Springer-Verlag, New York, 2005. (In §4.1)
[Mn88] N. E. MN¨EV: The universality theorems on the classiﬁcation problem of conﬁguration varieties
and convex polytopes varieties. Topology and geometry—Rohlin Seminar, 527–543, Lecture Notes
in Math., 1346, Springer, Berlin, 1988. (In §1.1)
[Oh]
S. OH: Positroids and Schubert matroids, preprint. http://arxiv.org/abs/0803.1018 (In §3.20
and 3.23)
[Pol03] B. POLSTER: The Mathematics of Juggling, Springer-Verlag, New York, 2003. (In §1.2 and 3.1)
[Pos05] A. POSTNIKOV: Afﬁne approach to quantum Schubert calculus, Duke Mathematical Journal, 128
(2005), no. 3, 473–509. http://arxiv.org/abs/math.CO/0205165 (In §1.4, 8.3, and 8.3)
[Pos]
A. POSTNIKOV: Total positivity, Grassmannians, and networks, preprint.
http://www-math.mit.edu/~apost/papers/tpgrass.pdf (In §1.1, 1.1, 1.2, 3, 3.2, 3.19, 3.20, 3.23,
5.2, 5.4, 5.4, and 5.4)
[PrSe86] A. PRESSLEY, G. SEGAL: Loop groups. Oxford Mathematical Monographs, Oxford University
Press, 1986. (In §7.3)
[Ra87] A. RAMANATHAN: Equations deﬁning Schubert varieties and Frobenius splitting of diagonals,
Publ. Math. IHES 65 (1987), 61–90. (In §5.5)
[Rie06] K. RIETSCH: Closure relations for totally nonnegative cells in G/P, Mathematical Research Letters,
13 (2006), 775–786. http://arxiv.org/abs/math.AG/0509137 (In §1.1, 2.3, 5.3, 5.3, and 5.4)
43

[Rie09] K. RIETSCH: Private communication, 2009. (In §1.2)
[RieWi08] K. RIETSCH, L. WILLIAMS: The totally nonnegative part of G/P is a CW complex, Transform.
Groups, 13, (2008), 839–853. http://arxiv.org/abs/0802.0889 (In §1.2)
[Sni10] M. SNIDER, Afﬁne Patches on Positroid Varieties and Afﬁne Pipe Dreams, Ph. D. Dissertation,
Cornell University 2010 http://arxiv.org/abs/1011.3705 (In §7 and 7.5)
[Sta99] R. STANLEY: Enumerative Combinatorics Vol. 2. Cambridge Studies in Advanced Mathematics, 62.
Cambridge University Press, Cambridge, 1999. (In §7.4)
[Sta84] R. STANLEY, On the number of reduced decompositions of elements of Coxeter groups, European
Journal of Combinatorics, 5, (1984), 359–372 (In §7.10)
[Va78] P. V ´AMOS: The missing axiom of matroid theory is lost forever, J. London Math. Soc. (2) 18 (1978),
no. 3, 403–408. (In §1.1 and 1.1)
[Ve71] D.-N. VERMA: M¨obius inversion for the Bruhat order on a Weyl group, Ann. Sci. ´Ecole Norm. Sup.
4 (1971), 393–398. (In §3.5)
[War05] G. WARRINGTON: Juggling probabilities, American Mathematical Monthly 112, no. 2 (2005), 105–
118. http://arxiv.org/abs/math.PR/0302257 (In §1.2)
[Wi07] L. WILLIAMS: Shelling totally nonnegative ﬂag varieties, Journal fur die Reine und Angewandte
Mathematik (Crelle’s Journal), issue 609 (2007), 1–22. http://arxiv.org/abs/math.RT/0509129(In
§1.1, 1.2, 2.3, 3.4, and 3.5)
[Ya10] M. YAKIMOV: Cyclicity of Lusztig’s stratiﬁcation of Grassmannians and Poisson geometry, in:
Noncommutative structures in mathematics and physics, Eds: S. Caenepeel, J. Fuchs, S. Gutt, Ch.
Schweigert, A. Stolin, and F. Van Oystaeyen, pp. 258-262, Royal Flemish Acad. of Belgium for Sci-
ences and Arts, 2010. http://arxiv.org/abs/0902.2181 (In §6)
DEPARTMENT OF MATHEMATICS, CORNELL UNIVERSITY, ITHACA, NY 14853 USA
E-mail address: allenk@math.cornell.edu
DEPARTMENT OF MATHEMATICS, UNIVERSITY OF MICHIGAN, ANN ARBOR, MI 48109 USA
E-mail address: tfylam@umich.edu
DEPARTMENT OF MATHEMATICS, UNIVERSITY OF MICHIGAN, ANN ARBOR, MI 48109 USA
E-mail address: speyer@umich.edu
44

