Mechanisms and Machine Science
Martín Pucheta
Alberto Cardona
Sergio Preidikman
Rogelio Hecker   Editors
Multibody 
Mechatronic 
Systems
MuSMe 2021

Mechanisms and Machine Science
Volume 110
Series Editor
Marco Ceccarelli
, Department of Industrial Engineering, University of Rome Tor
Vergata, Roma, Italy
Advisory Editors
Sunil K. Agrawal, Department of Mechanical Engineering, Columbia University,
New York, USA
Burkhard Corves, RWTH Aachen University, Aachen, Germany
Victor Glazunov, Mechanical Engineering Research Institute, Moscow, Russia
Alfonso Hernández, University of the Basque Country, Bilbao, Spain
Tian Huang, Tianjin University, Tianjin, China
Juan Carlos Jauregui Correa, Universidad Autonoma de Queretaro, Queretaro,
Mexico
Yukio Takeda, Tokyo Institute of Technology, Tokyo, Japan

This book series establishes a well-deﬁned forum for monographs, edited Books,
and proceedings on mechanical engineering with particular emphasis on MMS
(Mechanism and Machine Science). The ﬁnal goal is the publication of research that
shows the development of mechanical engineering and particularly MMS in all
technical aspects, even in very recent assessments. Published works share an
approach by which technical details and formulation are discussed, and discuss
modern formalisms with the aim to circulate research and technical achievements
for use in professional, research, academic, and teaching activities.
This technical approach is an essential characteristic of the series. By discussing
technical details and formulations in terms of modern formalisms, the possibility is
created not only to show technical developments but also to explain achievements
for technical teaching and research activity today and for the future.
The book series is intended to collect technical views on developments of the
broad ﬁeld of MMS in a unique frame that can be seen in its totality as an
Encyclopaedia of MMS but with the additional purpose of archiving and teaching
MMS achievements. Therefore, the book series will be of use not only for
researchers and teachers in Mechanical Engineering but also for professionals and
students for their formation and future work.
The series is promoted under the auspices of International Federation for the
Promotion of Mechanism and Machine Science (IFToMM).
Prospective authors and editors can contact Mr. Pierpaolo Riva (publishing
editor, Springer) at: pierpaolo.riva@springer.com
Indexed by SCOPUS and Google Scholar.
More information about this series at http://www.springer.com/series/8779

Martín Pucheta
• Alberto Cardona
•
Sergio Preidikman
• Rogelio Hecker
Editors
Multibody Mechatronic
Systems
MuSMe 2021
123

Editors
Martín Pucheta
CIII
Facultad Regional Córdoba - Universidad
Tecnológica Nacional & CONICET
Córdoba, Argentina
Sergio Preidikman
IDIT
Universidad Nacional de Córdoba -
CONICET
Córdoba, Argentina
Alberto Cardona
CIMEC
Universidad Nacional del Litoral -
CONICET
Santa Fe, Argentina
Rogelio Hecker
Facultad de Ingeniería
Universidad Nacional de
La Pampa & CONICET
General Pico, Argentina
ISSN 2211-0984
ISSN 2211-0992
(electronic)
Mechanisms and Machine Science
ISBN 978-3-030-88750-6
ISBN 978-3-030-88751-3
(eBook)
https://doi.org/10.1007/978-3-030-88751-3
© The Editor(s) (if applicable) and The Author(s), under exclusive license
to Springer Nature Switzerland AG 2022
This work is subject to copyright. All rights are solely and exclusively licensed by the Publisher, whether
the whole or part of the material is concerned, speciﬁcally the rights of translation, reprinting, reuse of
illustrations, recitation, broadcasting, reproduction on microﬁlms or in any other physical way, and
transmission or information storage and retrieval, electronic adaptation, computer software, or by similar
or dissimilar methodology now known or hereafter developed.
The use of general descriptive names, registered names, trademarks, service marks, etc. in this
publication does not imply, even in the absence of a speciﬁc statement, that such names are exempt from
the relevant protective laws and regulations and therefore free for general use.
The publisher, the authors and the editors are safe to assume that the advice and information in this
book are believed to be true and accurate at the date of publication. Neither the publisher nor the
authors or the editors give a warranty, expressed or implied, with respect to the material contained
herein or for any errors or omissions that may have been made. The publisher remains neutral with regard
to jurisdictional claims in published maps and institutional afﬁliations.
This Springer imprint is published by the registered company Springer Nature Switzerland AG
The registered company address is: Gewerbestrasse 11, 6330 Cham, Switzerland

Dedication
To the family, friends, and colleagues of Prof.
Ricardo Emmanuel Campa Cocom who
passed away after COVID-19 disease on 19th
November 2020 at the age of 49 years. He
was an author of the 7th MuSMe and a
generous and recognized researcher from the
Instituto Tecnológico de La Laguna, Torreon
Coahuila, Mexico.

Preface
The International Symposium on Multibody Systems and Mechatronics (MuSMe
2021) will be the seventh event of a series that started in 2002 as a joint activity
of the FeIbIM Technical Commission for Mechatronics (currently, Robotics and
Mechanisms) and the IFToMM Technical Committees for Multibody Dynamics,
and Robotics and Mechatronics. The MuSMe 2020 Conference was planned as an
in-person meeting to be held in Córdoba, Argentina, in October 2020, but due to the
COVID-19 pandemic the Organizing Committee postponed its realization, in vir-
tual modality, to October 2021. The International Symposium is a conference
initiative to bring together researchers from the broad array of disciplines referring
to multibody systems and mechatronics.
Modern systems can be considered as integrated systems that can be properly
studied, designed, and operated using mechatronics viewpoints, but considering the
multibody architecture from the outset results in systems that are physically more
realistic and accurate. In particular, the aim of the MuSMe Symposium is to
exchange views, opinions, and experiences, and stimulate integration between
mechatronics and multibody systems disciplines, a forum to facilitate communi-
cation, understanding, and the sharing of ideas and experience between researchers
and students.
The proceedings of this conference contains two volumes with papers written by
the authors from all around the world; 39 papers were published in 2020, and 23
papers were submitted and evaluated in 2021. The contributions address mainly to
synthesis of mechanisms and robots, kinematics, static and dynamic analysis,
control of mechatronic systems, mechatronic systems for assistive technology and
rehabilitation, multibody modeling and simulation, prototypes and experimental
validations, railway and vehicle dynamics, and energy harvesting.
This proceedings can be of interest to researchers, graduate students, and
engineers specializing in or working with mechatronics. We believe that the reader
will take advantage of these papers and that they will increase his or her motivation
for teaching and researching mechatronic systems.
vii

We would like to express our grateful thanks to the members of the International
Scientiﬁc Committee of the Symposium for cooperating enthusiastically for the
success of the MuSMe initiative, in particular to Prof. Marco Ceccarelli (University
of Rome Tor Vergata, Italy), President of the IFToMM from 2016 to 2019, and to
the authors who have contributed with interesting papers in several subjects, cov-
ering many ﬁelds of mechatronics and multibody systems. We are grateful to the
reviewers for the effort and time spent evaluating the papers. Finally, we greatly
acknowledge the participation of Bahram Ravani (University of California, Davis,
USA) as jury in the Springer Best Paper Awards Committee.
The Organizing Committee would like to thank the Córdoba Regional Faculty
of the National Technological University, Argentina, for supporting MuSMe 2021
and hosting the event. We would also like to thank the sponsorship of IFToMM—
the International Federation for the Promotion of Mechanisms and Machine
Science, FeIbIM—the Iberoamerican Federation of Mechanical Engineering,
CONICET—National Scientiﬁc and Technical Research Council from Argentina,
and Springer, for their ﬁnancial support, acknowledging that without their part-
nership it would not be possible to organize this meeting.
The Editors
October 2021
viii
Preface

7th MuSMe Organization
Local Organizing Committee (from Argentina)
Chair
Martín Pucheta
CIII/UTN-FRC and CONICET, Argentina
Co-chair
Alberto Cardona
CIMEC/UNL-CONICET, Argentina
Members
Gastón Araguás
CIII–UTN-FRC, Argentina
Gonzalo Perez-Paina
CIII–UTN-FRC, Argentina
Claudio Paz
CIII–UTN-FRC, Argentina
Alejandro Gallardo
CIII–UTN-FRC and CONICET, Argentina
Javier Salomone
GIDMA–UTN-FRC, Argentina
Sebastián Giusti
GIDMA–UTN-FRC and CONICET, Argentina
Augusto Romero
GIDMA–UTN-FRC, Argentina
Federico Cavalieri
CIMEC and UTN-FRSF, Argentina
Alejandro Albanesi
CIMEC and UTN-FRSF, Argentina
Sergio Preidikman
IDIT/UNC-CONICET, Argentina
Bruno Roccia
IDIT/UNC-CONICET, Argentina
Rogelio Hecker
UN La Pampa and CONICET, Argentina
Ricardo Carelli
INAUT/UNSJ-CONICET, Argentina
International Scientiﬁc Committee
Chair
Mario Acevedo, Mexico
ix

Members
Marco Ceccarelli, Italy
Jorge Ambrosio, Portugal
Paulo Flores, Portugal
Martín Pucheta, Argentina
Silvia Rodrigo, Argentina
Josep María Font Llagunes, Spain
Pietro Fanghella, Italy
Mario Fernández Fernández, Chile
Glauco Caurin, Brazil
Daniel Martins, Brazil
Manfred Husty, Austria
Vicente Mata Amela, Spain
Carlos Munares Tapia, Peru
Eusebio Hernández, Mexico
Honorary Members
Osvaldo Penisi, Argentina
Joao Carlos Mendes Carvalho, Brazil
Tatu Leinonen, Finland
Springer Awards Committee
Marco Ceccarelli, Italy
Rogelio Hecker, Argentina
Barham Ravani, USA
Sponsor
x
7th MuSMe Organization

Contents
Synthesis of Mechanisms
Synthesis of a Tip-Tilt-Piston Flexure System with Decoupled
Actuators . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
3
Alejandro G. Gallardo and Martín A. Pucheta
Synthesis and Sensitivity Analysis of a Prosthetic Finger . . . . . . . . . . . .
13
Nícolas Arroyo, Del Piero Flores, Diego Palma, Renzo Solórzano,
and Elvis J. Alegria
Synthesis of an Exoskeleton and Walking Pattern Identiﬁcation
for a Rehabilitation System . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
24
Yanpierrs Figueroa, Joseph Díaz, Gustavo Quino, and Elvis J. Alegria
Mechanisms Analysis
Analysis of a Proposal for a Self-aligning Mechanism for Cartesian
Robot in Greenhouses . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
37
Lucas Bernardon Machado, Antonio Carlos Valdiero, Henrique Simas,
and Daniel Martins
Historical and Technical Analysis of Harmonic Drive Gear Design . . . .
46
Vivens Irakoze, Marco Ceccarelli, and Matteo Russo
Design of Variable Moment of Inertia Flywheel . . . . . . . . . . . . . . . . . . .
56
Vigen Arakelian
Kinematics of a Robotic System for Rehabilitation of Lower Members
in Hypotonic Infants. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
64
Marco García, Esther Lugo-González, Manuel Arias-Montiel,
and Ricardo Tapia-Herrera
xi

Modelling and Simulation of Multibody Systems
Modeling and Simulation of Frictional Contacts in Multi-rigid-
Body Systems . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
77
Paulo Flores
Modelling Spherical Joints in Multibody Systems . . . . . . . . . . . . . . . . .
85
Mariana Rodrigues da Silva, Filipe Marques, Miguel Tavares da Silva,
and Paulo Flores
Multibody Dynamics Modeling of Delta Robot with
Experimental Validation. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
94
Mohamed Elshami, Mohamed Shehata, Qingshun Bai, and Xuezeng Zhao
Railway and Vehicle Dynamics
Railway Dynamics with Curved Contact Patch . . . . . . . . . . . . . . . . . . .
105
Filipe Marques, Hugo Magalhães, João Pombo, Jorge Ambrósio,
and Paulo Flores
On the Utilization of Simpliﬁed Methodologies for the Wheel-Rail
Contact . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
114
José Ferreira, Paulo Flores, and Filipe Marques
Optimization Tools Applied in the Design of a Hydraulic Hybrid
Powertrain for Minimal Fuel Consumption . . . . . . . . . . . . . . . . . . . . . .
122
Társis Prado Barbosa, Aline de Faria Lemos,
Luiz Otávio Ferreira Gonçalves, Ricardo Poley Martins Ferreira,
Leonardo Adolpho Rodrigues da Silva, and Juan Carlos Horta Gutiérrez
Determination of the Effect of Sloshing on the Railcar-Track
Dynamic Behavior . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
131
Juan Carlos Jauregui-Correa, Frank Otremba, Jose A. Romero-Navarrete,
and Gerardo Hurtado-Hurtado
Mechatronic Systems for Energy Harvesting
A Three-Dimensional Piezoelectric Timoshenko Beam Model
Including Torsion Warping . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
143
Emmanuel Beltramo, Bruno A. Roccia, Martín E. Pérez Segura,
and Sergio Preidikman
On the Effect of Hardening/Softening Structural Non-linearities
on an Array of Aerodynamically Coupled Piezoelectric Harvesters . . . .
151
Bruno A. Roccia, Marcos L. Verstraete, Luis R. Ceballos,
Grigorios Dimitriadis, and Sergio Preidikman
xii
Contents

Hybrid System Design for Energy Harvesting from Low-Amplitude
Ocean Waves . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
159
Gabriel Gutiérrez-Diaz, Arturo Solis-Santome,
and Christopher René Torres-SanMiguel
Robot Design and Optimization
Modelling of a Hydrodynamically Actuated Manipulator Based
on Strip Theory . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
171
R. Santiesteban Cos, J. A. Carretero, and J. Sensinger
Shaking Force Balancing of the 2RRR PPM Specifying
Tool’s Motion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
181
Mario Acevedo and Ramiro Velázquez
Energy Optimization of a Parallel Robot in Pick and Place Tasks . . . . .
191
Juan Pablo Mora, Juan Pablo Barreto, and Carlos F. Rodriguez
Gravity Compensation of Articulated Robots Using Spring
Four-Bar Mechanisms . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
201
Vu Linh Nguyen
Mechatronic Design
Structural Design and Sliding Mode Control Approach
of a 4-DoF Upper-Limb Exoskeleton for Post-stroke Rehabilitation . . . .
213
Johan Nuñez-Quispe, Alvaro Figueroa, Daryl Campusano,
Johrdan Huamanchumo, Axel Soto, Ebert Chate, Jesus Acuña,
Juan Lleren, Jose Albites-Sanabria, Leonardo Paul Milián-Ccopa,
Kevin Taipe, and Briggitte Suyo
Mechatronic Design of a Planar Robot Using
Multiobjective Optimization . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
224
Alejandra Rios Suarez, S. Ivvan Valdez, and Eusebio E. Hernandez
Author Index. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
233
Contents
xiii

Synthesis of Mechanisms

Synthesis of a Tip-Tilt-Piston Flexure
System with Decoupled Actuators
Alejandro G. Gallardo and Mart´ın A. Pucheta(B)
Centro de Investigaci´on en Inform´atica para la Ingenier´ıa (CIII) and Consejo
Nacional de Investigaciones Cient´ıﬁcas y T´ecnicas (CONICET), Facultad Regional
C´ordoba, Universidad Tecnol´ogica Nacional, Maestro M. L´opez esq. Cruz Roja
Argentina, X5016ZAA C´ordoba, Argentina
{agallardo,mpucheta}@frc.utn.edu.ar
Abstract. Parallel ﬂexure mechanisms are used in high-precision posi-
tioning systems for a wide range of scientiﬁc, medical, and industrial
applications. In particular, tip-tilt-piston mechanisms have great rele-
vance in the ﬁeld of optics for steering light and laser beams. The con-
trollability of the ﬂexure system is optimized when actuators are decou-
pled such that the output of any actuator does not aﬀect the output of
the other actuators. This work presents a systematic procedure to design
ﬂexure mechanisms with decoupled actuators. Screw Theory and Linear
Algebra are used to manipulate the motion and constraint screw sys-
tems in combination with a graph representation of the mechanism. The
methodology is illustrated with the redesign of two parallel tip-tilt pis-
ton ﬂexure stages where the actuators have directions: (i) parallel to the
rotations plane; (ii) normal to the rotations plane. The solutions are val-
idated using ﬁnite element analyses. The designed ﬂexure systems have
very simple structures, high accuracy, and controllability.
Keywords: Precision mechanisms · Tip-tilt piston ﬂexible
mechanism · Screw theory · Graph theory · Finite element analysis
1
Introduction
Flexible tip-tilt-piston mechanisms have great relevance due to their application
in the ﬁeld of optics and precise positioning of measurement and scientiﬁc instru-
ments, in biomedical and electronic devices, and in a wide range of industrial
applications. These mechanisms have three degrees of freedom, two coplanar
rotations, and a translation perpendicular to the axes of rotation.
Among the several techniques for designing ﬂexible mechanisms [6], the
methodology based on exact constraint using Screw Theory [1,3,8,9] is the more
relevant in last years because its great potential to be automated by computa-
tional techniques. Recently, this methodology has been applied in conjunction
with Graph Theory [10] for the systematic design ﬂexible mechanisms with high
complexity in terms of their topology. Flexible mechanisms generally have com-
plex geometric design constraints such as spatial restrictions, maximum volume
c
⃝The Author(s), under exclusive license to Springer Nature Switzerland AG 2022
M. Pucheta et al. (Eds.): MuSMe 2021, MMS 110, pp. 3–12, 2022.
https://doi.org/10.1007/978-3-030-88751-3_1

4
A. G. Gallardo and M. A. Pucheta
of the mechanism, speciﬁc clamping surfaces, and speciﬁed actuation volume.
Hopkins et al. [4,5] addresses the synthesis of mechanism subject to a decoupled
actuation space. He considers that the actuation forces must be decoupled since
it allows a better controllability of the mechanism. On the other hand, Pucheta
and Gallardo [7] implements the synthesis of mechanisms considering spatial
design restrictions.
This work presents a synthesis method to design ﬂexible tip-tilt-piston mech-
anisms with decoupled actuators and spatial design requirements. This method
is a simpliﬁcation of the method proposed by Sun and Hopkins [10]. This sim-
pliﬁcation is the consequence of imposing that the actuators of the mechanism
must be decoupled. As the movement of an actuator must not interfere with the
movement of another actuator, the topology of the mechanism can be split into
parallel and/or series sub-mechanisms. The synthesis of two mechanisms with
diﬀerent actuation spaces is proposed, the spatial constraints are taken from
Hao and He [2], and the designs obtained are veriﬁed through ﬁnite element
simulations.
This article is organized as follows: Sect. 2 introduces the screw theory back-
ground and also describes the steps of the methodology for designing a ﬂexi-
ble mechanism system. Section 3 details the steps for designing a tip-tilt-piston
example and Sect. 4 summarizes the conclusions.
2
Theoretical Background and Methodology
This work uses the screw theory deﬁnitions and nomenclature previously pre-
sented by Pucheta and Gallardo [1]. The inﬁnitesimal displacement screw or
Twist is represented by the 6 × 1 vector
t =
θ
δ

=

θ
c × θ + pθ

(1)
where, θ is a vector that coincides with the screw direction and collects rotational
displacements, δ is the linear displacement, c is a location vector going from the
origin to any point of the screw axis, and p is the pitch of the screw. The Wrench
screw is deﬁned as
w =

f
m

=

f
r × f + qf

(2)
where, f is a vector in the direction of the screw, m represents the moment around
the screw axis, r is a location vector going from the origin to any point of the
screw axis, and q is the pitch of the screw. A freedom space T = [t1, t2, . . . , tn]
is generated by n = rank(T) unit basis screws and its complementary space is
the constraint or wrench space W
W = [w1, w2, . . . , w6−n] = QT⊥,
Q =

O3 I3
I3 O3

,
(3)
where, O3 is a 3 × 3 block of zeros, I3 is a 3 × 3 identity matrix, and T⊥is null
space of T.

Synthesis of a Tip-Tilt-Piston Flexure System
5
In this work, the methodology proposed by Sun and Hopkins [10] is adapted
to develop a synthesis approach based on these steps:
• Step 1: Identify the desired motion and design constraints.
• Step 2: Represent the topology of the mechanism by its graph GT where
the vertices are the bodies and the edges represent the freedom space allowed
between a pair of bodies. Each freedom space has an associated complemen-
tary constraint space as shown in Eq. (3).
• Step 3: Analyze the freedom space for every path from the ground body G
to the stage body S.
• Step 4: Compute the physical implementation of the constraint beams that
allow the freedom space for each edge of the graph and also meet spatial
design constraints.
3
Case Study: Tip-Tilt Piston Flexure Stage
The methodology is illustrated with the redesign of two tip-tilt piston ﬂexure
stages where the actuators have directions: (i) parallel to the rotations plane;
(ii) normal to the rotations plane. The ﬁrst case is validated with the mechanism
presented by Hao and He [2] and is described in Subsect. 3.1. The second case
is validated with the mechanism presented by Hopkins et al. [5] and is described
in Subsect. 3.2.
3.1
Case 1: Actuators on a Plane Parallel to the Rotations Plane
A Tip-tilt piston ﬂexure stage has three desired motions: two orthogonal rota-
tions and one translation perpendicular to the rotations space as shown in
Fig. 1(a).
Fig. 1. Problem deﬁnition: (a) Sketch of the stage with the set of desired motions
(rotations Rx and Ry, and translations Tz); (b) Graph representation of the parallel
stage; (c) Parallel mechanisms build with beam ﬂexure elements; (d) Actuation pattern
of three rotations (R1, R2, and R3) located on a hoop that also produce the desired
motion.
Step 1: A tip-tilt-piston mechanism has three degrees of freedom equal to the
rank of the Twist System composed by three unit screws multiplied by their
motion magnitudes

6
A. G. Gallardo and M. A. Pucheta
[T] =
⎡
⎣
1 0 0 0 0 0
0 1 0 0 0 0
0 0 0 0 0 1
⎤
⎦
T
·
⎡
⎣
θx
θy
δz
⎤
⎦
(4)
The constraint space is the Wrench System Eq. (5) which is reciprocal to [T]
[W] =
⎡
⎣
1 0 0 0 0 0
0 1 0 0 0 0
0 0 0 0 0 1
⎤
⎦
T
·
⎡
⎣
fx
fy
mz
⎤
⎦
(5)
In its simplest form, the constraint space can be implemented as a parallel
ﬂexure represented by the graph shown in Fig. 1(b), where G represents the
ground body and S represents the stage where the guided body (a mirror, a
robotic end eﬀector, or another device) has to be mounted. A parallel ﬂexure
system with such degrees of freedom can be build by beam ﬂexure elements as
shown in Fig. 1(c).
The goal is to actuate the mechanism in a decoupled way. Therefore, each
actuation will contain an intermediate body which links the stage and the
ground. As the freedom space has rank 3, three intermediate bodies (B1, B2,
and B3) are added as shown in Fig. 2. The design constraints and geometrical
data of the problem are taken from Hao and He [2].
In this case, the proposed actuation forces are all translational (linear); they
are located on the same plane and their directions are symmetrically arranged
at 120◦with respect to each other. This requirement in the actuation of the
mechanism can be expressed by the input motions
[T]A = δ ·
⎡
⎣
0 0 0
−1
0
0
0 0 0 cos(30) −sin(30) 0
0 0 0 cos(30) sin(30) 0
⎤
⎦
T
.
(6)
Fig. 2. Spatial design constraints: (a) spatial arrangement of the rigid bodies of the
ﬂexible mechanism; (b) dimensions of the rigid bodies. (c) Graph representation of the
mechanism.
The constraints of the actuation system determines the geometrical arrange-
ment of the intermediate bodies as shown in Fig. 2(a). Additionally, a set

Synthesis of a Tip-Tilt-Piston Flexure System
7
of geometric design constraints are deﬁned as depicted in Figs. 2(a) and (b):
r1 = 17, 5 mm; r2 = 37, 5 mm; r3 = 42, 9 mm; h1 = 10 mm; h2 = 14 mm;
l1 = 16 mm y l2 = 10 mm.
Once the input motions are deﬁned, it is necessary to establish which individ-
ual output motion is obtained for each input. The freedom space were previously
described by three basis screws in Eq. 4. Nevertherless, another three basis screws
can be chosen as generators. In this example, the freedom space can be build
as three rotations around three coplanar axes arranged as shown in Fig. 1(d). In
terms of screws it can be expressed as
[T]F =
⎡
⎣
0
−1
0 0 0 r
cos(30◦) sin(30◦) 0 0 0 r
−cos(30◦) sin(30◦) 0 0 0 r
⎤
⎦
T
·
⎡
⎣
θ1
θ2
θ3
⎤
⎦
(7)
Note that these new generator twists are conveniently chosen to be symmet-
rically arranged at 120◦with respect to each other, as well as the input motions.
In this way, the submechanisms that link the platform and the intermediate
bodies are also symmetrically arranged at 120◦.
As the input motion TAi (i = {1, 2, 3}) is applied, the output motion TF i is
obtained.
Step 2: The selected graph must have decoupled actuation. This implies that
there must be as many paths between vertices G and S (that represent the
ground and the stage bodies, respectively) as the number of desired degrees of
freedom. For each path between G and S, there must exist at least one inter-
mediate body where the actuation is to be applied. The simplest graph meeting
these topological requirements is shown in Fig. 2(c).
Step 3: The input motion TA1 must produce the motion TF1 on the platform.
The path that connects G and S and passes through B1 is (e1−e4); see Fig. 2(c).
Each edge of the graph represents a submechanism that joints two rigid
bodies. Then, the freedom space for each edge is denoted [j]ei. The screws that
represents this freedom space are normalized with respect to its direction vector
such that [j]ei is multiplied by a vector Xi that collects the motion magnitudes.
The addition of the freedom spaces of edges e1 and e4 must result in TF1.
[j]e1X1 + [j]e4X4 = TF1
(8)
The body B1 must also move in agreement with its associated input motion,
such that [j]e1X1 = TA1. Therefore, the unknown is the freedom space of the
edge e4
[j]e4X4 = TF1 −TA1 =
0 −1 0 δ/θ1 0 r	
θ1
(9)
When the input motion TA2 is applied on body B2, the platform motion is
TF2. By considering the same path as before it results in
[j]e1X1 + [j]e4X4 = TF2
(10)

8
A. G. Gallardo and M. A. Pucheta
Because no motion is applied on B1, then TA1 = 0, X1 = 0, and
[j]e4X4 = TF2.
(11)
Also, there is no motion applied on B3 such that
[j]e4X4 = TF3.
(12)
As a result, [j]e4 must have a minimum of 3 degrees of freedom:
[j]e4X4 =
⎡
⎣
0
−1
0 δ/θ1 0 r
cos(30◦) sin(30◦) 0
0
0 r
−cos(30◦) sin(30◦) 0
0
0 r
⎤
⎦
T
·
⎡
⎣
θ1
θ2
θ3
⎤
⎦
(13)
By following a similar analysis for the paths (e2 −e5) and (e3 −e6), the
freedom spaces for the edge e5 and e6 are
[j]e5X5 = [TF1
(TF2 −TA2)
TF3]
(14)
[j]e6X6 = [TF1
TF2
(TF3 −TA3)]
(15)
As a result, the freedom spaces [j]e4, [j]e5 and [j]e6 must have a minimum of
3 degrees of freedom each one.
Step 4: The methodology used for the construction of the constraint spaces by
using beam elements was previously reported by the authors [1,7] and is based
on Blanding’s rules.
Firstly, the constraint space between the intermediate bodies and the ground
is analyzed. The freedom space of the edge e1 is a translation along the x axis.
Therefore, the beams axes must be located in planes perpendicular to the trans-
lation direction, see Fig. 3(a). In this case, the constraint space can also be
implemented as ﬂexure elements of blade type. As proposed by Hao and He [2],
a number of redundant blades increase the accuracy and reduces the of parasitic
motions; four blades per intermediate body are shown in Fig. 3(c). In this ﬁgure,
the mechanisms for edges e2 and e3 are the same as for e1 but rotated 120◦
around the z axis to further provide symmetry.
Secondly, the constraint space between the intermediate bodies and the plat-
form is analyzed. The freedom space for edge e4 was computed in Eq. 13. Such
space was represented in Fig. 3(b) as three rotations: R2 and R3 are respectively
TF2 and TF3, and J4 is TF1 whose axis was displaced and amount of h along the
z axis. To build the mechanism associated to this edge, the chosen beam elements
must connect the rigid body B1 to the platform S and must be parallel or must
intersect the rotation axes of Eq. 13. Two beams that satisfy those requirements
are shown in Fig. 3(b). This mechanism composed by two ﬂexures permits the
freedom space required in Eq. 13 plus a translation perpendicular to the plane
containing both beams. The same design for e4 is used for the mechanisms that
represent edges e5 and e6. These mechanisms are rotated 120◦around the z
axis, clockwise and counterclockwise, respectively. The freedom spaces for e4,

Synthesis of a Tip-Tilt-Piston Flexure System
9
Fig. 3. Physical implementation of the constraint spaces by using beam elements: (a)
Minimal number of beams necessary for the constraint space of edge e1 that will be
replaced for blades; (b) Beams satisfying the constraint space for edge e4; (c) Model of
the tip-tilt-piston mechanism with beam and blade ﬂexure elements; (d) Rotation TF1
generated by a force with direction TA1 and magnitude of 15 N; (e) Rotation of the
platform around the x axis generated by actuation TA2 and −TA3with magnitude of
15 N each one; (f) Translation of the platform along the z axis generated by actuation
TA1, TA2, and TA3.
e5, and e6 surpass in one the number of degree of freedom required. Therefore,
so it should be veriﬁed the platform S does not increase the rank of its freedom
space.
Lastly, the freedom space of the platform S is computed as the intersection of
the freedom space of each path existing between G and S. The freedom space for
the path (e1−e4) is {[T]F ∪TA1∪t1}, where t1 is the translation perpendicular to
the ﬂexures of e4. For the path (e2−e5) the freedom space is {[T]F ∪TA2∪t2} and
for the path (e3 −e6) the freedom space is {[T]F ∪TA3 ∪t3}. The intersection of
the freedom spaces for the paths is exactly [T]F . Therefore, the platform freedom
space of S meets the requirements of Step 1.

10
A. G. Gallardo and M. A. Pucheta
3.2
Case 2: Actuators Directions are Normal to the Rotations Plane
The same problem solved in the previous subsection is here developed with an
alternative layout of the direction of the input motion provided by the linear
actuators, they are normal to the rotations plane.
Step 1: The freedom space was deﬁned in Eq. 7. The design constraints are also
those established in the Fig. 2(a). The input motion for each of the intermediate
bodies, Bi (i = {1, 2, 3}), is a translation along an axis parallel to the z axis
Ta = δ

0 0 0 0 0 1
	T
(16)
Step 2: The graph of the topology is also that represented in Fig. 2(c).
Step 3: For the path (e1 −e4), the motion of the platform S must be TF1 when
the input motion Ta is applied on the body B1. The freedom space of the edge
e1 must be equal to the input motion, [j]e1X1 = Ta. Therefore,
[j]e4X4 = TF1 −Ta =
0 −1 0 0 0 (r −δ/θ1)	T θ1
(17)
By following a similar analysis, the freedom space for the edge e4 is
[j]e4X4 = [(TF1 −Ta)
TF2
TF3]
(18)
Step 4: The edge e1 must permit a translation, as in the previous case study,
but along an axis parallel to the z axis, see Fig. 4(a). The constraint space is
again physically implemented as a set of four ﬂexures of blade type connecting
each intermediate body with the ground; see Fig. 4(c).
The freedom space that must posses the edge e4 is drawn in Fig. 4(b). The
three degrees of freedom are coplanar rotations. The constraint space can be
implemented either as set of three ﬂexures of beam type or as one ﬂexure of
blade type. The submechanisms that represent the paths (e2 −e5) and (e3 −e6)
are equal to that of the path (e1 −e4) but rotated 120◦around the z axis,
clockwise and counterclockwise, respectively. In this case, the freedom space of
each edge is exactly the one determined in Step 3. Therefore, the platform S
will have exactly the desired movements. It is not necessary to verify it as in the
previous case.

Synthesis of a Tip-Tilt-Piston Flexure System
11
Fig. 4. Physical implementation of the constraint spaces by using beam elements: (a)
Minimal number of beams necessary for the constraint space of edge e1 that will be
replaced for blades; (b) Beams satisfying the constraint space for edge e4; (c) Model of
the tip-tilt-piston mechanism with all ﬂexure elements of blade type; (d) Rotation TF1
generated by a force with direction TA1 and magnitude of 15 N; (e) Rotation of the
platform around the x axis generated by actuation TA2 and −TA3 with a magnitude of
15 N each one; (f) Translation of the platform along the z axis generated by actuation
TA1, TA2, and TA3.
4
Conclusions
A systematic synthesis of ﬂexure systems with decoupled actuators satisfying
spatial design constraints was presented. Screw Theory and Linear Algebra were
used to manipulate the motion and constraint screw systems in combination
with a graph representation of the mechanism. The methodology was illustrated
with the redesign of two parallel tip-tilt piston ﬂexure stages where the actuators
have directions: (i) parallel to the rotations plane; (ii) normal to the rotations

12
A. G. Gallardo and M. A. Pucheta
plane. The analytical solutions were validated using ﬁnite element analyses. The
solutions can be combined with redundant constraints applied to the platform
to further reduce parasitic motions.
Acknowledgements. The authors acknowledge the ﬁnancial support from Consejo
Nacional de Investigaciones Cient´ıﬁcas y T´ecnicas for the Ph.D. fellowship granted
to the ﬁrst author. We also acknowledge to Universidad Tecnol´ogica Nacional (UTN)
through projects PID-UTN 7819 and 4967. We gratefully acknowledge the friendly
assistance of Rodrigo Tom´as Gonz´alez and Juan Augusto Bernad from UTN-FRC.
References
1. Gallardo, A.G., Pucheta, M.A.: Synthesis of precision ﬂexible mechanisms using
screw theory and beam constraints. Int. J. Mech. Robot. Syst. 4(4), 277–304 (2018)
2. Hao, G., He, X.: Designing a monolithic tip-tilt-piston ﬂexure manipulator. Arch.
Civil Mech. Eng. 17(4), 871–879 (2017). https://doi.org/10.1016/j.acme.2017.04.
003
3. Hopkins, J., Culpepper, M.: Synthesis of multi-degree of freedom, parallel ﬂexure
system concepts via freedom and constraint topology (FACT) - Part I: Principles.
Precis. Eng. 34(2), 259–270 (2010)
4. Hopkins, J., McCalib Jr., D.: Synthesizing multi-axis ﬂexure systems with
decoupled actuators. Precis. Eng. 46, 206–220 (2016). https://doi.org/10.1016/
j.precisioneng.2016.04.015
5. Hopkins, J.B., Panas, R.M., Song, Y., White, C.D.: A high-speed large-range tip-
tilt-piston micromirror array. J. Microelectromech. Syst. 26(1), 196–205 (2017).
https://doi.org/10.1109/JMEMS.2016.2628723
6. Howell, L.L., Magleby, S.P., Olsen, B.M.: Handbook of Compliant Mechanisms.
Wiley, New York (2013)
7. Pucheta, M.A., Gallardo, A.G.: Synthesis of hybrid ﬂexible mechanisms using
beams and spatial design constraints. In: Pucheta, M., Cardona, A., Preidikman,
S., Hecker, R. (eds.) MuSMe 2021. MMS, vol. 94, pp. 47–56. Springer, Cham (2021).
https://doi.org/10.1007/978-3-030-60372-4 6
8. Qiu, C., Dai, J.S.: Analysis and Synthesis of Compliant Parallel Mechanisms—
Screw Theory Approach. STAR, vol. 139. Springer, Cham (2021). https://doi.org/
10.1007/978-3-030-48313-5
9. Su, H., Dorozhkin, D.V., Vance, J.M.: A screw theory approach for the conceptual
design of ﬂexible joints for compliant mechanisms. ASME J. Mech. Rob. 1(4),
041009, 8 p. (2009)
10. Sun, F., Hopkins, J.: Mobility and constraint analysis of interconnected hybrid
ﬂexure systems via screw algebra and graph theory. J. Mech. Robot. 9(3) (2017).
https://doi.org/10.1115/1.4035993

Synthesis and Sensitivity Analysis
of a Prosthetic Finger
N´ıcolas Arroyo, Del Piero Flores, Diego Palma(B), Renzo Sol´orzano,
and Elvis J. Alegria
Universidad de Ingenieria y Tecnologia - UTEC,
Jr. Medrano Silva 165, Barranco, Lima, Peru
{nicolas.arroyo,delpiero.flores,diego.palma,
renzo.solorzano,ejara}@utec.edu.pe
Abstract. A prosthetic ﬁnger based on a one degree of freedom mecha-
nism is synthesized in this paper using a genetic algorithm optimization
method. The features of this method are deﬁned so that the mechanism
performs an anatomical movement of a hand ﬁnger. Then, a sensitivity
analysis is proposed to identify which links most aﬀect the end-eﬀector
position. Some simulation results are presented to analyze this proposal.
Keywords: Prosthetic ﬁnger · Sensitivity analysis · Synthesis of
mechanisms · Genetic algorithms
1
Introduction
Researchers are currently interested in bionic prosthesis because it covers a part
of the body aesthetically, and it imitates biomechanical processes. They are par-
ticularly interested in replicating functionalities of biological extremities; there-
fore, it has improved the people’s lives quality [1]. Prosthetic mechanisms can
be based on robotic systems with multiple degrees of freedom (DOF), each con-
trolled by an actuator [2]. However, the control of each actuator and a correct
determination of the inertial properties of the links make the implementation of
these systems diﬃcult, especially when the mechanisms are small enough to be
manufactured and actuated by standard methods. In this paper, we are inter-
ested in a ﬁnger prosthesis, which in addition to being a small mechanism, must
be light and anatomical.
Underactuated linkages for ﬁnger prosthesis are preferred for small mecha-
nisms in the literature, see for example [4]. One-DOF mechanisms are mainly
convenient for the actuator control since it becomes a simple motor ﬁxed speed
control [8]. For instance, an experimental prosthetic mechanism of an aesthet-
ically human ﬁnger with ﬂexion movements is proposed in [7]. Another useful
reference, where a three-ﬁnger prosthetic hand is focused on the opening and
closing movements but not in the mechanical analysis, was proposed in [6]. In
both references, the proposed mechanism is referred to as the Toronto mechanism
[16].
c
⃝The Author(s), under exclusive license to Springer Nature Switzerland AG 2022
M. Pucheta et al. (Eds.): MuSMe 2021, MMS 110, pp. 13–23, 2022.
https://doi.org/10.1007/978-3-030-88751-3_2

14
N. Arroyo et al.
In this paper, the Toronto mechanism is analyzed and synthesized using
genetic algorithms to allow the ﬁnger to grab a speciﬁc object naturally. Fur-
thermore, we propose to drive this mechanism using a slider-crank due to a
linear movement requirement [7]. Additionally, a sensitivity analysis is done to
discover which variables have a signiﬁcant causality in the end-eﬀector trajectory
[15]. These variables could be manipulated to reach the desired trajectory as a
re-conﬁgurable version of this proposal.
This mechanism was chosen among the other one-degree of freedom ones
mentioned by [8], such as the Yeong-Jin Choi or the Rodriguez ﬁnger mech-
anisms, since it simulates a desired natural motion of a real ﬁnger and has a
simple design of four bar linkages, instead of other complex mechanisms that
add springs in some joints to keep the ﬁnger in a speciﬁc position. The latest is
not necessary for the Toronto mechanism. The simplicity of its design also helps
the synthesis process and the selection of optimization parameters.
This paper is organized as follows. The kinematic and kinetic analysis of
the Toronto mechanism is shown in Sect. 2. Section 3 focuses on determining the
mechanism parameters using genetic algorithms and the mechanism’s sensitivity
analysis. Finally, some conclusions are shown.
2
Kinematic and Kinetic Analysis
The phalanges and linkers compose the Toronto mechanism. The ﬁrst ones are
represented by three triangular links, which correspond to the proximal, mid-
dle, and distal phalanges, see Fig. 1. The second ones are the three remaining
links that allow the ﬁnger movement. Three parameters: length, height, and the
perpendicular distance from the axis are also shown in Fig. 1 for each triangular
link. The length and angle parameters of the remaining links intersection are
shown, as well.
An additional slider-crank (blue links) is used as an actuated driver responsi-
ble for generating the linear movement necessary to drive the ﬁnger. We propose
this slider-crank based on a kinetic analysis shown in Sect. 2.2. The grounded
points of this mechanism are J1 = [0, 0] mm (reference frame) and J9 = [30, 11]
mm. The parameters values are presented in Table 1, which are based on the sug-
gestions shown in [16].
Table 1. Parameters values of the mechanism
Distances [mm]
Angles [◦]
Proximal Middle
Distal
Lower lengths
PL
PA
ML
MA
DL
DA
L
a1
b1
b2
a3
b3
a4
b4
γ1
γ2
γP
γM
γD
45
11
25
8
21
6
10 10
20
10
10
41
7
21
110 110 47.73 38.66 30.96

Synthesis and Sensitivity Analysis of a Prosthetic Finger
15
Fig. 1. Toronto mechanism’s parameters driven by an slider-crank {J1, J2, J3}.
2.1
Non-linear Position Analysis of the End-Eﬀector
First, the equations representing the mechanism kinematic must be established.
For this purpose, a vector position analysis is done [3,5,11,14]. Speciﬁcally, vec-
tors following each of the link’s orientations. Then, the position analysis of the
Toronto mechanism is determined by the following equations:
a1e2 + b1e3 −d1e0 = 0,
(1)
a1e2 + b1e3 −b2e4 −a2e7 −p19e19 = 0,
(2)
a1e2 + b1e3 −b2e4 + a3e45 + b3e5 −c3e8 −PLe7γP −p19e19 = 0,
(3)
a1e2 + b1e3 −b2e4 + a3e45 + b3e5 + a4e5γ + b4e6 −c4e9
−MLe8γ −PLe7γ −p19e19 = 0,
(4)
where 0 =
0 0⊺, ei is the ith unit vector of its associated link, e.g. a1e2 in (1) is
the position vector of J2 respect to J1, see Fig. 1, and the vector of unknowns is
q =

θ3 θ4 θ5 θ6 θ7 θ8 θ9 d1
⊺. Considering a vector Φ(q) ∈R8×1 that contains
the nonlinear equations (1)–(4), then the Jacobian of Φq can be calculated by
deriving this vector with respect to q:
Jq = ∂Φq
∂q =
⎡
⎢⎢⎣
J11
0
0
0
0
0
0 −e0
J21 J22
0
0 J25
0
0
0
J31 J32 J33
0 J35 J36
0
0
J41 J42 J43 J44 J45 J46 J47
0
⎤
⎥⎥⎦
8×8
,
(5)
where J11 = J21 = J31 = J41 = b1n3, J22 = −b2n4, J25 = −a2n7, J32 =
J42 = −b2n4 +a3nθ4−γ1, J33 = b3n5, J35 = −PLn(θ7−γP ), J36 = −c3n8, J43 =
b3n5 + a4n(θ5−π−γ2), J44 = b4n6, J45 = −PLn(θ7+γP ), J46 = −MLn(θ8+γM),
and J47 = −c4n9. The vector ni is the ith unit normal vector referred to ei.
Since this is a system of non-linear equations, the unknowns can be calculated
iteratively using the Newton-Raphson method, i.e. considering that in the i−th
iteration Δqi = −Jq,i
−1Φ(qi), where Δqi+1 = qi + Δq. Once the orientation
angles of each link have been calculated, it is possible to calculate the position
of each pin at any instant of time. However, in this case the vector equation of
interest to determine the end-eﬀector position J12 is a1 + b1 −b2 + a3 + b3 +

16
N. Arroyo et al.
a4 + b4 −c4 + DL = 0, where a1 is the associated vector of the link a1, i.e.
a1 = a1e2, and it is similar for the other ones.
2.2
Kinetic Analysis
For the kinetic analysis, the inertial properties of each link are determined. A
CAD software allow us to determine their inertial properties with respect to the
center of mass of each link in the ˆk direction, considering a plastic ABS material
for the prosthesis. These values are shown in Table 2.
Table 2. Inertial properties of each link
Link
Crank J2, J3 J3, J4, J5 J5, J6, J7 J7, J8 J4, J9, J10 J6, J10, J11 J8, J11, J12
Mass [g]
0.123
0.229
0.219
0.516
0.239
1.176
0.564
0.415
I [g · mm2] 1.782
9.638
7.386
99.181
10.965 177.783
30.204
16.704
Subsequently, the free body diagram of each link is done. Applying the New-
ton’s second law to all the links of the mechanism links, the required torque
(Fig. 2a) by the crank to drive the mechanism during its whole trajectory is
obtained and it is shown in Fig. 2b. For this analysis, it is considered an external
1N force applied in the point J12, see Fig. 2a. This force is perpendicular to the
J8, J12 projection which simulates the reaction caused by holding an object with
the prosthesis ﬁngers.
According to Fig. 2b, the maximum torque is about 0.11 N.m. Then, a slider-
crank is proposed to generate the linear movement of the mechanism since it does
not need a high torque to move and occupies less space than other alternatives
because of its simplicity.
Fig. 2. Torque required by the crank to drive the mechanism. External force (a), and
driving torque vs crank angle (b).

Synthesis and Sensitivity Analysis of a Prosthetic Finger
17
3
Synthesis and Sensitivity Analysis of the Mechanism
The proposed prosthesis is ﬁtted to a speciﬁc predeﬁned trajectory for opening
and closing hand movements since it has one degree of freedom [16], which
is convenient to simplify the control problem to a motor ﬁxed speed control.
However, it may be a drawback when a human ﬁnger needs to follow diﬀerent
trajectories, for instance, when it grabs things of diﬀerent sizes, see Fig. 3b. We
solve this problem adjusting some link dimensions to reconﬁgure the ﬁnger’s
trajectory. These links, which mainly inﬂuence the mechanism trajectory, are
identiﬁed in this paper using a genetic algorithm optimization method. This
process corresponds to a sensitivity analysis of the mechanism, as we call in
this paper [10,15]. Although changing the dimension of links can be understood
as adding degrees of freedom to the system, this process does not necessarily
imply adding actuators. As can be seen, many possibilities open up as a result
of this proposal, from simple mechanisms with interchangeable parts to more
sophisticated ones with multiple linear actuators.
3.1
Desired Trajectories
Reference points are determined from diﬀerent paths that a real human ﬁnger
follows. Therefore, ﬁve desired trajectories with broader and narrower ampli-
tudes are deﬁned and shown in Fig. 3a. These points are obtained by following
the trajectory of real ﬁngers as they are opened and closed while holding objects
of diﬀerent sizes, see Fig. 3b. The number of points was limited to ﬁve due to
computational limitations, since the amount of points increases the computa-
tional time exponentially does as well. Also, the points are established every 45◦
of the crank so that it would occupy the 180◦that it requires to close or open.
They are compared with the actual trajectory based on the kinematic analysis
shown in Sect. 2.
3.2
Optimization Using Genetic Algorithms
Genetic algorithms are computational techniques for heuristic search inspired
by natural evolution [12]. They pretend to make optimization by reducing a
cost function, which maximizes the ﬁtness of the individuals in a population. In
order to achieve a minimum cost function, the set of variables which forms an
individual ﬁnger and deﬁnes its movement is determined. The unknown variables
are shown in (6) and their initial values are established in (7). The values of the
lengths are in mm and the angles in degrees.
x = [a1, b1, b2, a3, b3, γ1, a4, b4, γ2, J1x],
(6)
xinit = [10, 20, 10, 10, 41, 110◦, 7, 21, 110◦, −30].
(7)

18
N. Arroyo et al.
Fig. 3. Initial end-eﬀector trajectory, dashed line, and ﬁve alternative end-eﬀector
paths references (a). Closing movements for diﬀerent object’s sizes (b).
The remaining variables are intentionally ﬁxed because they give a typical
proportion of the ﬁnger phalanges to the linkage. Then, an analytical function
calculates the extreme position of the ﬁnger using a kinematic analysis. Once the
position is obtained, the cost function is calculated using the Euclidean distance:
f(x) = 
n
i=0[(Pxi −Pxdi)2 + (Pyi −Pydi)2], where Pxi and Pxdi are the actual
and desired positions of P = J12 in the x-axis, respectively; similarly for Pyi and
Pydi.
The next stage consisted of establishing restrictions to the variables that
deﬁne the mechanism. These values are shown in (8) and (9) which are the
parameters with smaller and larger amplitude, respectively. These bounds are
obtained through trial and error until the ﬁnger trajectory was not completely
deformed during optimization.
lbound = [5, 15, 8, 5, 36, 90◦, 5, 18, 70◦, −40],
(8)
ubound = [15, 25, 12, 11, 66, 130◦, 13, 28, 130◦, −30].
(9)
The relationships between variables are also considered; these refer to the
restrictions necessary for a correct movement of this mechanism, such as
Grashof’s condition, shown in (10), in four-bar linkages to allow the complete
revolution of the crank.
S + L ≤R + Q.
(10)
where S is the distance of the shorter link, L the longest and variables R and
Q correspond to the remainder links [5,14]. These are deﬁned as the vector
inequality restrictions Arestxinit ≤Brest, whose values are shown in (11). The

Synthesis and Sensitivity Analysis of a Prosthetic Finger
19
inequality constraints were obtained so that the added slider crank can give a
complete revolution. The other sub-mechanisms do not require these constraints
because they are non-Grashof, i.e., they do not need to satisfy (10).
Arest =
⎡
⎢⎢⎣
1 −1 1 0 01×5 0
1 −1 0 0 01×5 −1
1 1 0 0 01×5 1
0 0 0 1 01×5 0
⎤
⎥⎥⎦,
Brest =
⎡
⎢⎢⎣
0
25
0
12.4
⎤
⎥⎥⎦.
(11)
Finally, the MATLAB function ga(func, nvars, A, b, Aeq, beq, lb,
ub) is used in the genetic algorithm optimization [13,17]. This function requires
eight parameters as reference, which are shown in Table 3. Based on that, the
ga() function ﬁnds the local minimum x to f(x), subject to the linear inequal-
ities Arestx ≤Brest. Since there are not linear equalities, A and b were set as
empty vectors. In addition, the optimal solution found must be in the range
lbound ≤x ≤ubound.
In order to ﬁnd an optimal x, the genetic algorithm uses a random initial
population, called parents. Then, it creates a sequences of new populations, called
children, based on the current population either by making random changes
on the parent (mutation) or by combining a pair of parents (crossover), and
evaluating its ﬁtness scores. After that, the current population is replaced by
the children one to form the next generation. This process is repeated until the
conditions established are met by the current population and, therefore, the local
minimum x is found [9].
Table 3. Parameters of the MATLAB function ga()
MATLAB function inputs Description
Values
func
Cost function
f(x)
nvars
Number of variables
10
A
Matrix A of liner inequalities
Arest
b
Matrix b of linear inequalities
Brest
Aeq
Matrix A of linear equalities
[]
beq
Matrix b of linear equalities
[]
lb
Lower bounds on the design variable x
(8)
ub
Upper bounds on the design variable x (9)
3.3
Sensitivity Analysis of the Optimized Mechanism
A sensitivity analysis consists of investigating the eﬀects of the parameter
changes on a mathematical model’s solution [10]. Hence, this can be used now
to determine which parameters have a greater variation to the initial trajectory.
Therefore, multiple paths are performed using the genetic algorithm method

20
N. Arroyo et al.
and the optimized variables for each path are shown in Table 4. Nevertheless,
the most noticeable consequence of modifying all the mechanism variables was
that the initial ﬁnger conﬁguration became non-anatomical, despite the cost
function being relatively small. Figure 4 shows the ﬁnger conﬁguration for the
fourth path, and it is possible to notice that the ﬁnger is stretched and curved
out. These characteristics could aﬀect the primary function of the prosthesis
since the ﬁnger must look as anatomical as possible.
Table 4. Parameters that changed for each desired trajectory
Variable x
a1
b1
b2
a3
b3
γ1
a4
b4
γ2
J1,x
Initial
xinit 10
20
10
10
41
110◦
7
21
1100◦
−30
Path 1
x1
9.6
23.7 8.9
9.2 44.8 104.850◦11
21.4 73.910◦
−33.1
Path 2
x2
10.4 21.2 11.1 9.9 43.5 103.130◦8.8
20
105.420◦−32.1
Path 3
x3
8.5
21
9.8
9.7 43.2 114.020◦6.8
22.9 83.8410◦−31.6
Path 4
x4
10.1 20
9.1
8.2 45.5 104.280◦11.3 22.7 84.620◦
−30.9
Path 5
x5
9.5
23.7 9.1
8.5 41.9 120.890◦6.5
22.6 103.130◦−34.6
Fig. 4. Optimized mechanism but with a non-anatomical shape.
Based on Table 4, the variables which were modiﬁed the most in the trajec-
tories are veriﬁed. A graphic of the mean variation of each variable of the ﬁve
paths compared to their initial value established in (7) can be seen in Fig. 5.
The variables that varied the most were b1, a4 and γ2, considering a threshold
of λ = 10% of variation. This percentage represents the average total variation.
In other words, the averages shown in Fig. 5 are used to detect which variables
inﬂuence the most. For this reason, b1 and a4 should be adjusted to the mecha-
nism adaptation. For instance, a reconﬁgurable version of the mechanism could
be designed using tiny linear actuators for links b1 and a4, and a rotary actuator,

Synthesis and Sensitivity Analysis of a Prosthetic Finger
21
such as a servo motor, to change the angle γ2; in order to have the capacity of
picking things of diﬀerent shapes and sizes comfortably but adding some DOF.
It should be emphasized that small variations of links imply a greater demand
for manipulation precision. For example, the link a1 requires a resolution of
approximately 0.1mm, which is not easy to reach for a linear actuator. It is
worth noticing that the threshold λ = 10% shown in Fig. 5, is proposed only
for small links such as Toronto’s mechanism. Notice that for bigger mechanisms,
it may be convenient that reduced variation in the actuators yields signiﬁcant
variations in the end eﬀector, then their reconﬁgurable links must be those with
a degree of aﬀectation lower than the threshold λ.
In such manner, it was achieved to conﬁgure the genetic algorithm restrictions
for varying the selected variables. Consequently, it was possible to ﬁnd conﬁgu-
rations for the ﬁnger trajectory to pass through most of the desired points, as
shown in Fig. 6.
Fig. 5. Porcentual variation of each one of the modiﬁed parameters
Fig. 6. Optimized path of the ﬁnger with anatomical shape

22
N. Arroyo et al.
4
Conclusions
In this paper, the synthesis and sensitivity analysis of the Toronto mechanism
used in prosthetic hands have been done, which simulate the ﬂexion movement
of a ﬁnger. A slider-crank was conveniently proposed as a driver, i.e. to gener-
ate the necessary linear movement and to drive the mechanism. The position
of each link was determined using the Newton-Raphson method. With these
results, the trajectory of the point of interest J12 was obtained. Furthermore,
the synthesis and sensitivity of the mechanism have been studied by optimizing
it with genetic algorithms, so the end-eﬀector tracks a group of desired points.
It was accomplished to diﬀerentiate the variables that inﬂuence the most in the
trajectory and deﬁne the necessary restrictions to some variables to keep them
constant and maintain the mechanism ﬁnger shape. The ﬁnger trajectory cannot
be changed signiﬁcantly due to the mechanism restrictions; however, it would be
possible to modify the trajectory with reconﬁgurable links, or adding actuators,
to grab things of diﬀerent sizes.
References
1. Basumatary, H., Hazarika, S.M.: State of the art in bionic hands. IEEE Trans.
Hum. Mach. Syst. 50(2), 116–130 (2020)
2. Bottin, M., Rosati, G.: Trajectory optimization of a redundant serial robot using
cartesian via points and kinematic decoupling. Robotics 8(4), (2019). https://doi.
org/10.3390/robotics8040101
3. Castro, O., C´espedes, A., Alegria, E.J.: An adaptable four-bar mechanism for data-
based model validation. In: Pucheta, M., Cardona, A., Preidikman, S., Hecker, R.
(eds.) MuSMe 2021. MMS, vol. 94, pp. 119–127. Springer, Cham (2021). https://
doi.org/10.1007/978-3-030-60372-4 14
4. Ceccarelli, M., Yao, S., Carbone, G., Zhan, Q., Lu, Z.: Analysis and optimal design
of an underactuated ﬁnger mechanism for robotic ﬁngers, pp. 242–256 (2012).
https://doi.org/10.1177/0954406211412457
5. Constans, E., Dyer, K.B.: Introduction to Mechanism Design: With Computer
Applications. CRC Press, Boca Raton (2018)
6. Dechev, N., Cleghorn, W., Naumann, S.: Multi-segmented ﬁnger design of an exper-
imental prosthetic hand. In: Mechanism and Machine Theory (2000)
7. Dechev, N., Cleghorn, W., Naumann, S.: Multiple ﬁnger, passive adaptive grasp
prosthetic hand. Mech. Mach. Theory 36(10), 1157–1173 (2001)
8. Difonzo, E., Zappatore, G., Mantriota, G., Reina, G.: Advances in ﬁnger and partial
hand prosthetic mechanisms. Robotics 9(4), 80 (2020)
9. Goldberg, D.E.: Genetic Algorithms in Search, Optimization, and Machine Learn-
ing, 1st edn. Addison-Wesley Professional, Boston (1989)
10. Grenga, T., Paolucci, S., Valorani, M.: Sensitivity analysis and mechanism simpli-
ﬁcation using the G-scheme framework. Combust. Flame 189, 275–287 (2018)
11. Gutarra, A., Palomino, S., Alegria, E.J.: Hexapod walking mechanism based on the
Klann linkage for a 2DoF amphibious robot. In: Pucheta, M., Cardona, A., Prei-
dikman, S., Hecker, R. (eds.) MuSMe 2021. MMS, vol. 94, pp. 302–310. Springer,
Cham (2021). https://doi.org/10.1007/978-3-030-60372-4 34

Synthesis and Sensitivity Analysis of a Prosthetic Finger
23
12. McCall, J.: Genetic algorithms for modelling and optimisation. J. Comput. Appl.
Math. 184, 205–222 (2005)
13. Messac, A.: Optimization in Practice with MATLAB R
⃝: For Engineering Students
and Professionals, 1st edn. Cambridge University Press, Cambridge (2015)
14. Norton, R.L.: Design of Machinery: An Introduction to the Synthesis and Analysis
of Mechanisms and Machines, 6th edn. McGraw-Hill Series in Mechanical Engi-
neering (2020)
15. Saltelli, A.: Sensitivity analysis for importance assessment. In: Proceedings of the
3rd International Symposium on Sensitivity Analysis of Model Output, pp. 3–18
(2001)
16. Sospedra, B.: Dise˜no mec´anico de pr´otesis de mano multidedo antropom´orﬁca
infractuada. Ph.D. thesis, Universitat Jaume I (2015)
17. Stephen Boyd, L.V.: Convex Optimization. Cambridge University Press, Cam-
bridge (2004)

Synthesis of an Exoskeleton and Walking
Pattern Identiﬁcation for a Rehabilitation
System
Yanpierrs Figueroa1(B), Joseph D´ıaz1, Gustavo Quino2, and Elvis J. Alegria1
1 University of Engineering and Technology UTEC, Jr. Medrano Silva 165,
Barranco, Lima, Peru
{yanpierrs.figueroa,joseph.diaz,ejara}@utec.edu.pe
2 University of Oxford, Parks Road, Oxford OX1 3PJ, UK
gustavo.quinoquispe@eng.ox.ac.uk
Abstract. This paper proposes a modiﬁed Theo-Jansen mechanism to
develop an exoskeleton for people with muscle weakness in the lower
extremities. The synthesis of this modiﬁed mechanism is performed using
genetic algorithms to adjust its movement to a conventional human walk-
ing or jogging. The movement patterns of real leg’s trajectories are exper-
imentally obtained through image processing. According to their rele-
vance, these patterns are analyzed and weighted, to optimize a weighted
cost function. Furthermore, the kinematic and kinetic analysis of the
mechanism are brieﬂy shown.
Keywords: Synthesis of mechanisms · Theo-Jansen linkage ·
Exoskeleton · Genetic algorithm · Movement patters.
1
Introduction
Lower limb physical rehabilitation is a process to regain the leg’s motor skills due
to, for example, an injury or illness. Technological systems based on mechanisms
and robots have been shown to improve the eﬃciency of physical rehabilitation
based on adequate movement control. In addition, these systems manage to
follow the desired trajectory, which must be adjusted to a typical leg movement.
A physical rehabilitation system is usually based on a serial robot or an
underactuated mechanism [1]. In the ﬁrst one, each joint is usually associated
with a one-degree-of-freedom actuator. The position control is determined by
its inverse kinematics, whose performance depends mainly on three factors: the
robustness of each motor control [2], the stiﬀness of the links, and correct dis-
tribution of masses to reduce the robot’s vibration [5]. These factors are often
complex to address and also make this type of equipment more expensive.
On the other hand, the second one proposes a one-degree-of-freedom mech-
anism driven by a single motor at a constant speed [3,4,15,16], which greatly
simpliﬁes the required control to a motor constant speed control. Based on inter-
connected links, this mechanism produces repetitive movements at the same
c
⃝The Author(s), under exclusive license to Springer Nature Switzerland AG 2022
M. Pucheta et al. (Eds.): MuSMe 2021, MMS 110, pp. 24–33, 2022.
https://doi.org/10.1007/978-3-030-88751-3_3

Synthesis Walking Pattern Identiﬁcation of the Exo-Jansen
25
frequency as the rotation of the crank. This repeatability is a desired charac-
teristic in a lower limb rehabilitation process [14]. In addition to the ease of
motor control, the rigidity and mass distribution requirements in underactuated
mechanisms are often simpler than those of a serial robot, which reduces costs
[12].
Some mechanisms for walking movements based on linkages are presented
in the literature. For example, a Stephenson III six-bar linkage that mimics the
ankle movement of one leg based on a combined direct solution of the synthesis
equations with an optimization strategy is shown in [4]. This mechanism does not
consider the movement of the knee, which is also an important point to analyze
in order for the mechanism to better mimic a walk. Thus, a mechanism that
adjusts simultaneously to the movement of the knee and the ankle, relative to
a ﬁxed point located on the hip, allows a more adequate rehabilitation process.
This also turns the mechanism into an exoskeleton that can be attached to a leg
at three points: the hip, knee and ankle.
In this paper we are interested on a low-cost portable rehabilitation sys-
tem, based on a one-degree-of-freedom linkage, so that the patient can use it
at home. Our rehabilitation system is based on a modiﬁed Theo-Jansen mech-
anisms (TJM), which is portable and attachable to a conventional treadmill.
The TJM crank is attached to a transmission shaft to drive the mechanism. The
Fig. 1 shows a 3D model of the proposed system. The top part of the structure,
is detachable to allow the patient to be comfortably installed into the tread-
mill. Furthermore, an adjustable seat is included for the patient’s rest, when
entering or leaving the treadmill. This system considers the active and passive
modes, depending on the patient’s autonomy. Two main contact points between
the patient and the rehabilitation system: the ankle and the knee, which should
adjust the natural movement of a human leg, are being considered also. An
adjustable fasteners is included in both contact points to ensure safety and bet-
ter performance of the mechanism.
This paper focuses on the analysis and synthesis of a modiﬁed TJM, here
referred to as Exo-Jansen, so that a more anatomical movement is achieved.
The TJM is performed as an exoskeleton for the lower body using a modiﬁed
Theo-Jansen mechanism for two rehabilitation exercises: walking and jogging.
The modiﬁed TJM shown in Fig. 1, after an optimization process, based on real
walking patterns of both the knee and ankle, achieves a human-like walking.
The walking patterns are obtained using a motion tracking algorithm and then
calibrated. These patterns deﬁne trajectories used as reference in the genetic
algorithms optimization of the Exo-Jansen. Experimentally, we note that the cost
function requires two reference points: the ankle (point P) and the knee (point
F). Likewise, the initial lengths of each link are obtained from the experimental
measurement of four people with average heights among 1.65 to 1.75 m for the
anatomical purpose described.
Section 2 introduces the kinematic and kinetic analysis of the Exo-Jansen,
respectively. The optimization analysis is shown in Sect. 3. Finally, some conclu-
sions and discussions are presented.

26
Y. Figueroa et al.
Fig. 1. CAD model of the system (left) and diagram of the leg mechanism (right)
2
Kinematic and Kinetic Analysis of the Exo-Jansen
A kinematic analysis is conducted to determine the position, velocity and accel-
eration of the entire mechanism in function of the crank kinematic state [7]. To
analyze the mechanism kinematic, we divide the Exo-Jansen into three simple
fourbar linkages, as [8,16] lays out, deﬁned by the points: ABCD, ABGD, and
DHFE, each group of points forms a loop, so there is three loops in the entire
linkage, see Fig. 1. Each loop is characterized by a vector equation, which is used
in position, velocity, and acceleration analysis. The angles θ1, θ2, θ3, θ4, θ5, θ6, θ8,
and θ9 are the orientation of the links AD, AB, BC, DC, BG, DG, EF, and
HF, respectively.
To begin the analysis, it is necessary to establish the unknowns in each loop
that solve vector equations. Taking into account that: link AB is the crank,
link AD is grounded, all the link’s lengths are a priori known, links DG and
GH are collinear, the geometrical relationships {θ7 = θ4 + δce, θ10 = θ9 + δlp}
exist, where δce and δlp are constants; then the unknowns of the Exo-Jansen are:
θ3, θ4, θ5, θ6, θ8, and θ9. Furthermore, the angular velocity and angular accelera-
tion related with each one are also unknown and must be calculated.
Once the unknowns are established, the kinematic analysis is straightforward.
For the analysis of position, which is nonlinear in the unknown variables, the
Newton-Raphson method is used. For the velocity and acceleration analysis,
which is a system of linear equations, the position vector equations are derived
once and twice respectively, then the unknowns are matrix cleared to solve a
simple linear equations system for each fourbar linkage loop. The vector equation
of each loop for each kinematic analysis are in Table 1. For a more detailed
analysis of this, see [6,15].

Synthesis Walking Pattern Identiﬁcation of the Exo-Jansen
27
Table 1. Kinematic equations of the Theo Jansen mechanism shown in Fig. 1
Variables
Kinematic equations
(ABCD)
{θi}i=3,4
ae2 + be3 −de1 −ce4 = 0
{ωi}i=3,4
aω2n2 + bω3n3 −cω4n4 = 0
{αi}i=3,4
aα2n2 −aω2
2e2 + bα3n3 −bω2
3e3 −cα4n4 + cω2
4e4 = 0
(ABGD)
{θi}i=5,6
ae2 + ge5 −me6 −de1 = 0
{ωi}i=5,6
aω2n2 + gω3n5 −mω6n6 = 0
{αi}i=5,6
aα2n2 −aω2
2e2 + gα3n5 −gω2
3e5 −mα6n6 + mω2
6e6 = 0
(DHFE)
{θi}i=8,9
(m + h)e6 + le9 −ee7 −fe8 = 0
{ωi}i=8,9
(m + h)ω6n6 + lω9n9 −eω4n7 −fω8n8 = 0
{αi}i=8,9
(m + h)α6n6 −(m + h)ω2
6e6 + lα2
9e9 −eα4n7 + eω2
4e7 −fα8n8 = 0
The kinetic analysis is about determining the forces and torques acting on
the internal parts of the mechanism. The analysis process is based on the free
body diagram corresponding to each element of the Exo-Jansen, see Fig. 2.
A dynamic analysis is performed using Newton’s laws applied to rigid bod-
ies that allows obtaining the equations shown in Table 2, where Fi and Wj
are the internal force and weight of the links which are the only known forces,
i = {A, B1, B2, C, D, E, F, G, H} and j = {crank, BC, DCE, DGH, BG, EF, P},
respectively; and the ith unitary vector si is a π/2 rotated vector of ri, shown
in Fig. 2. An external force acting on link FHP is nor considered here, because
the Exo-Jansen is not expected to touch the ground, as well as the forces gener-
ated from the interaction with the patient are not considered in this work either.
Furthermore, to solve the kinetic equations, the matrix system is used together
with the kinematic analysis found in Sect. 2, to calculate the unknowns of the
linear equation system, see [13].
Table 2. Links Kinetic Equations
Crank AB
Link BC
FA −FB1 −FB2 + Wcrank = mcrankacrank
−FC + FB1 + WBC = mBCaBC
−sT
gB1(FB1 + FB2) + T = Icrankαcrank
−sT
gC1FC + sgB2FB1 = IBCαBC
Link DCE
Link BG
FC −FE + FD1 −FD + WDCE = mDCEaDCE
FB1 −FG + WBG = mBGaBG
−sT
gC2FC −sT
gE1FE + sT
gD1(FD1 −FD) = IDCEαDCE sT
gB3FB1 −sT
gG1FG = IBGαBG
Link EF
Link FHP
FE −FF + WEF = mEFaEF
FF + FH + WP = mPaP
sT
gE2FE −sT
gF1FF = IEFαEF
sT
gF2FF + sT
gH2FH = IPαP
Link DGH
FD −FD1 + FG −FH + WDGH = mDGHaDGH
sT
gD2(FD −FD1) + sT
gG2FG −sT
gH1FH = IDGHαDGH

28
Y. Figueroa et al.
Fig. 2. Link’s free body diagram.
In this analysis the eﬀect of gravity is taken into account. For this, it is
necessary to know the mechanical properties of the element to be analyzed, such
as mass m, mass moment of inertia I, and distance to the center of mass in the
x-axis CMx, as well as in the y-axis CMy. These properties appear in Table 3, it
should be noted that the material chosen for the parts is 20 mm thick aluminum.
Table 3. Link’s Mechanical properties
Link
m[kg] I[kg/cm2] CMx[cm] CMz[cm]
AB
0.02
3.68
0
0
BC
0.01
3.06
12.9
0
DCE
0.02
6.13
4.14
7.585
BG
0.02
3.68
10.4
0
DGH 0.01
2.77
22
0
EF
0.08
2.1
24.1
0
FPH
0.04
77.28
3.398
24.323
Figure 3 (left) shows the trajectory of point P, based on Table 1, which is sim-
ilar to an ankle trajectory, but requires to be optimized for human-like walking
and jogging movements. Moreover, Fig. 3 (right) shows the torque required due
to the movement of the crank for a complete cycle of motion, which presents a
sinusoidal-motion that evidences the smooth behavior of the system. Likewise, it
is possible to identify the minimum and maximum torque necessary to start the

Synthesis Walking Pattern Identiﬁcation of the Exo-Jansen
29
0
100
200
300
Crank Angle 
2 [deg°]
-5
0
5
Crank Torque [Nm]
-30
-20
-10
0
10
x-axis [cm]
-90
-85
-80
-75
y-axis [cm]
Fig. 3. Trajectory of point P, left, and torque required for the crank, right.
mechanism, with an approximate peak magnitude of 4.2 Nm, this would facili-
tate the identiﬁcation of the ideal actuator that will be in charge of performing
the movement.
3
Computational Synthesis of the Mechanism
In this section, the synthesis of the Exo-Jansen mechanism is done using a
gradient-based optimization method so that trajectories for both walking and
jogging are ﬁtted to two reference paths, which are obtained experimentally.
Representative points of the desired paths are selected and used to calculate a
cost function. The variables to optimize are some link’s lengths and angles of
the mechanism.
It is worth noting that the crank drives the mechanism at a constant speed.
Therefore, the mechanism adjusts the knee and ankle to the desired position
and the desired speed of a typical leg movement. A typical angular velocity of
the crank for walking and jogging, obtained experimentally, are 53.5RPM and
222RPM, respectively.
3.1
Real Movement Patterns Sampling
The real movement trajectories are sampled using a motion tracking algorithm.
To do this, real walking and jogging sequences are recorded on video using a
treadmill, see Fig. 4. Two point markers with a phosphorescent color are located
on the knee and ankle. These points are ﬁltered using a thresholding process so
that only the trajectories of the ankle and knee are sampled, which are properly
calibrated considering that point A, see Fig. 1, is the system reference. In this
paper, the following points are conveniently selected for the optimization process:
P Walking
ankle
=
(7, −83.3); (15.4, −79.8); (6.2, −70.6); (−35.3, −79.9); (−6.4, −83.5) 
,
(1)
P Walking
knee
=
(−9.3, −43.2); (−38, −43.5) 
,
(2)
P Jogging
ankle
=
(7.5, −79.5); (14.6, −73.8); (2.5, −67.1); (−33.2, −79.2); (−6.4, −83.5) 
,
(3)
P Jogging
knee
=
(−11.9, −42.7); (−41.4, −40) 
.
(4)
This point is placed in the origin with the whole set. All the process is shown
in Fig. 4. For more information see [10].

30
Y. Figueroa et al.
Fig. 4. Tracking of walking and jogging trajectory, left and right, respectively (a), and
calibrated movement patterns (b).
3.2
Cost Function with Weighting Factor
The cost function f is determined by the Euclidean norm between each desired
point and the actual point, according to points P and F , ankle and knee respec-
tively. The cost function is expressed in (5), which depends on the weigh factor
λi, i = 1, . . . , n assigned to each desired point. So we can adjust the relevance
of the ith reference point, in the optimization process, by adjusting λi. In this
project, we propose, λ = [1.25, 0.9, 1.25, 0.9], for the desired points (1)–(4).
f(X) =
n

i=0
λi

(Pxi −Pxid)2 + (Pyi −Pyid)2,
(5)
This constrained nonlinear multivariable function is optimized using the Mat-
lab function, fmincon; which ﬁnds the minimun values. For details see [9].
3.3
Links Measurement Using Optimization
In Fig. 5(a) the desired points are shown. For the links optimization, boundaries
are required, otherwise this method would search a solution into a big range of
possibilities, making the process slower and even having singularity problems.
Furthermore, boundaries are important to impose an anatomic behavior to the
mechanism. For these reasons we ﬁxed the lengths of links a and d, and the

Synthesis Walking Pattern Identiﬁcation of the Exo-Jansen
31
remaining should be optimized. In this work, the adjustable links where bounded
with ±10% of their initial lengths, see Table 3. As a result of the optimization
process, it is shown Fig. 5(b) and Fig. 5(c). We can see that the costs, in both,
are low compared with their initial costs.
Fig. 5. Exo-Jansen before and after the optimizations. Walking desired points (yellow
marks), jogging desired points (red marks), and actual trajectories (blue dots).
The restrictions for the optimization were collected experimentally, i.e., mea-
surements of the lower body were taken from 4 people between 1.68–1.76 m tall
and with an average physical build, to keep the proposed model as close to reality
as possible, these measurements were taken from the joint points of the proposed
TJM (Table 4).
Table 4. Link’s boundaries for optimization
Link Lower boundary Initial value Upper boundary
a
4.5
4.5
4.5
b
20
22.5
3.68
c
19
21
23
d
15.8
15.8
15.8
e
15
17.5
20
f
57
58.5
60
g
22
25
28
h
19
23
27
l
8
8.5
9
m
16
19
22
p
40
41
42

32
Y. Figueroa et al.
3.4
Discussions on the Optimization Method
As shown in the optimization method, two points of the knee were considered
as constraints of our model, to achieve both an anatomical trajectory of the
ankle and the knee, as well as to restrict the sizing of the TJM towards a more
anatomical ﬁgure. However, this does not guarantee to avoid problems of hyper-
extension or hyper compression of the knee, to solve these problems the knee
joint can be replaced by a six-bar mechanism, such as the one proposed in [4],
which ensures a smoother and more natural motion for that point.
4
Conclusions
The synthesis of an exoskeleton and walking pattern identiﬁcation for a rehabil-
itation system was shown in this paper. The kinematic and kinetic analysis was
ﬁrstly shown. For the synthesis process, movement patterns are required, then
we collect data experimentally for the reference points. A weighted cost func-
tion was proposed also to impose that some reference points are more impor-
tant than others, so that an anatomical movement is reached. Furthermore, the
mechanism was optimized for both rehabilitation exercises, walking and jogging,
decreasing the initial costs by 89.8% for walking and 93.6% for jogging. Also, the
optimization of point F, which simulates the patient’s knee, was arranged, all
accompanied by restrictions in the sizing of the links that make up the mecha-
nism, to maintain anatomical proportions to ensure greater patient comfort and
safety when performing the movement. Our main future work is the adaptability
of the Exo-Jansen for other users of diﬀerent sizes by adding a proportionality
constant.
References
1. Dollar, A.M., Herr, H.: Lower exrewmity exoskeletons and active orthoses: chal-
lenges and state-of-the-art. IEEE Trans. Rob. 24, N1 (2008)
2. Lee, J., Kim, H., Jang, J., Park, S.: Virtual model control of lower extremity
exoskeleton for load carriage inspired by human behavior. Auton. Robot 38, 211–
223 (2015). https://doi.org/10.1007/s10514-014-9404-1
3. Nansai, S., Rojas, N., Elara, M.R., Sosa, R., Iwase, M.: On a Jansen leg with
multiple gait patterns for reconﬁgurable walking platforms. Adv. Mech. Eng. 7,
1–4 (2015)
4. Tsuge, B., Plecnik, M., McCarthy, J.: Homotopy directed optimization to design
a six-bar linkage for a lower limb with a natural ankle trajectory. J. Mech. Robot.
8(6), 1–7 (2016)
5. Acevedo, M., Gherrero, M.: An exoskeleton for enhancing strength and endurance
during walking. Industrial and Robotics Systems, LASIRS (2019)
6. Constans, E., Dyer, K.: Introduction to Mechanism Design: With Computer Appli-
cations. CRC Press, Boca Raton (2018)
7. Bovi, G., Rabuﬀetti, M., Mazzoleni, P., Ferrarin, M.: A multiple-task gait analysis
approach: kinematic, kinetic and EMG reference data for healthy young and adult
subjects. Gait Posture 33(1), 6–13 (2011)

Synthesis Walking Pattern Identiﬁcation of the Exo-Jansen
33
8. Cuadrado, K.: An´alisis Cinem´atico y cin´etico del mecanismo de Theo Jansen.
Dise˜no y construcci´on de juguete prototipo, Escuela Polit´ecnica Nacional (2018)
9. Li, J.: The optimization design of the four-bar linkage based on MATLAB. In:
2015 International Conference on Intelligent Systems Research and Mechatronics
Engineering (ISRME), Zhengzhou, China (2015)
10. MathWorks Student Competitions Team. Computer Vision for Student Competi-
tions: Object Detection using Blob Analysis, GitHub (2021). https://github.com/
mathworks/auvsi-cv-blob
11. Landmine and Cluster Munition Monitor: Monitor, The-monitor.org (2021).
http://www.the-monitor.org/en-gb/home.aspx. Accessed 10 Mar 2021
12. Sabaapour, M.R., Lee, H., Afzal, M.R., Eizad A., Yoon, J.: Development of a novel
gait rehabilitation device with hip interaction and a single DOF mechanism. In:
2019 International Conference on Robotics and Automation (ICRA), pp. 1492–
1498 (2019)
13. Norton, R., Rios, M., Osornio, C., Acevedo, M.: Dise˜no de maquinaria. McGraw-
Hill, Mexico, D.F. (2013)
14. Shao, Y., Xiang, Z., Liu, H., Li, L.: Conceptual design and dimensional synthesis of
cam-linkage mechanisms for gait rehabilitation. Mech. Mach. Theory 104, 31–42
(2016)
15. Castro, O., C´espedes, A., Alegria, E.J.: An adaptable four-bar mechanism for data-
based model validation. In: Pucheta, M., Cardona, A., Preidikman, S., Hecker, R.
(eds.) MuSMe 2021. MMS, vol. 94, pp. 119–127. Springer, Cham (2021). https://
doi.org/10.1007/978-3-030-60372-4 14
16. Gutarra, A., Palomino, S., Alegria, E.J.: Hexapod walking mechanism based on the
Klann linkage for a 2DoF amphibious robot. In: Pucheta, M., Cardona, A., Prei-
dikman, S., Hecker, R. (eds.) MuSMe 2021. MMS, vol. 94, pp. 302–310. Springer,
Cham (2021). https://doi.org/10.1007/978-3-030-60372-4 34

Mechanisms Analysis

Analysis of a Proposal for a Self-aligning
Mechanism for Cartesian Robot in Greenhouses
Lucas Bernardon Machado(B), Antonio Carlos Valdiero, Henrique Simas,
and Daniel Martins
Federal University of Santa Catarina, Florianópolis, Brazil
lucas.bernardon@posgrad.ufsc.br, {antonio.valdiero,
henrique.simas,daniel.martins}@ufsc.br
Abstract. The advances in technologies that include agriculture have reached
relevant proportions, when dealing with the process of automation of agricultural
greenhouses, made in “smart greenhouses”. In general, the 3DoF Cartesian robots
PPP-type Gantry perform development in a movement composed of three transla-
tions, with their axis of movement coinciding with a Cartesian reference coordi-
nate system. This work proposes and develop a self-aligning analysis in a Gantry
robot, verifying its redundant mobility and constraints highlighting the respective
advantages and properties, both in the mechanism assembly and in full operation,
avoiding misalignments, since the robot will move along rails. The development
base uses the Reshetov method to analyze the parameters of the mechanism, to
propose a self-aligned conception and its possible representations.
Keywords: Cartesian robot · Greenhouses · Reshetov · Self-alignment
1
Introduction
The use of manipulators in agriculture has grown signiﬁcantly, a fact that is directly
associated with the improvement of operating conditions, thus guaranteeing new stan-
dards of efﬁciency and agility in activities, both planting and harvesting, in agricultural
greenhouses. Agriculture has past several moments of evolution and improvement in
the 20th century, it started with Agriculture 1.0 characterized by animal traction, right
after Agriculture 2.0, it replaced animal traction with combustion engines, following by
Agriculture 3.0 the Global Positioning System (GPS) was developed and ﬁnally Agri-
culture 4.0 incorporated connectivity and automation with the use of vehicles, machines
and robots, agreeing on precision agriculture with automation and robotics [12].
According to the International Federation for the Promotion of Mechanism and
Machine Science (IFToMM), a mechanism is deﬁned as a “system of bodies designed to
transform movements into forces for one or more bodies to be moved” [3]. Kinematics
can be deﬁned as the branch of dynamics that deals with movement on its own, isolated
from forces associated with movement [2, 14].
Gantry Cartesian robots have three prismatic joints (PPP) resulting in a movement
composed of three translations, whose axes of motion coincide with a Cartesian refer-
ence coordinate system, that is, we have 3DoF of work and operation. Such a mechanism
© The Author(s), under exclusive license to Springer Nature Switzerland AG 2022
M. Pucheta et al. (Eds.): MuSMe 2021, MMS 110, pp. 37–45, 2022.
https://doi.org/10.1007/978-3-030-88751-3_4

38
L. Bernardon Machado et al.
operates in a suspended manner in relation to the ground, ideal for optimizing the work-
ing space and operation inside the greenhouses. Its use encompasses several practices,
namely: planting, harvesting, spraying, weed control, localized application of fertilizers
and pesticides [9].
This work studies the main movements (mobility and self-alignment) of a Cartesian
robot during its operation in protected cultivation, since the robot moves through linear
guides (rails). The main objective is to develop a self-alignment analysis of the moving
mechanism, where mainly are analyzed components of the rails, the pulleys and the
robot’s chassis. Due to manufacturing and assembly errors, the rails often do not provide
a linear (irregular) displacement to the mechanism, thus causing misalignment problems
that causes lock in the rollers, affecting the entire functioning of the robot.
Thus, an analysis based on the method proposed by Reshetov [11] whose objective
is to eliminate the redundant constraints by increasing the DoF (Degree of Freedom)
of the Cartesian robot, thus improving its functioning, design and excessive movement
restrictions.
This article is organized as follows. Section 2 presents an analysis of the geometry
of the Cartesian robot, analyzing its mobility and restrictions, then Sect. 3 presents
the development of the Reshetov method, proposing a possible self-alignment solution.
Section 4 presents the analyzed proposal and ﬁnally, Sect. 5 presents the ﬁnal conclusion.
2
Cartesian Robot Geometry for Agricultural Greenhouses
For the analysis and development of the work in question, it was necessary to deter-
mine some restrictions and design requirements, directly linked with the constructive
(dimensions) and operational (operational requirements of the activities to be carried
out) aspects of the greenhouses, in accordance with the Table 1:
Table 1. Design constraints.
Width 
(m)
Ceiling 
height 
(m)
Total 
height 
(m)
Length 
(m)
Lubrification
Operating 
temperature 
(ºC)
Operating 
speed 
(m/s)
Weight 
transported
(kg)
6.50
3.00
4.50
30.00
Low
0 - 40
1
3
7.00
3.50
5.00
8.00
4.00
5.50
10.00
4.50
6.00
The structure in which the analyzed mechanisms move is shown in Fig. 1, where the
rails (irregular, that is, a non-linear trajectory) are located at the top of the greenhouse,
thus composing an irregular path to be traversed. The blue rail was considered the
reference rail for analyzing the problem, which is less irregular than the black rail.
The analyzed robot has 6 links and 8 joints (Fig. 2a). The kinematic pairs formed
from the contact between the pulleys and the rail are two pairs of linear contact, that is,

Analysis of a Proposal for a Self-aligning Mechanism
39
Fig. 1. Simpliﬁed greenhouse structure with rails and benches.
it forms a line of contact, thus there are four kinematic pairs of type IV [11] that allow
a translation along the x-axis and a rotation around the z-axis [11]. The other kinematic
pairs, of the pulley assembly with the chassis of the mechanism, are all of revolution, the
only movement of the pulley in relation to the assembly. Then, the representation of the
mechanism was deﬁned by means of a graph (Fig. 2b), where the links are represented by
pointsandthejointsbytheedges.Thus,itispossibletodeﬁnesomeanalysisrequirements
for mobility, such as the number of independent circuits, that is, loops that have exclusive
joints [4, 6, 7, 13].
a-) 
b-) 
Fig. 2. Schematic drawing of links and joints (a) and graph of the mechanism (b).
The number of independent circuits (V) is given through the graph (Fig. 2a) or
according to the Euler Equation (Eq. 1) [6, 7], where j is the number of joints and n is
the number of determined links in Fig. 1 [1, 7]:
v −1 = j −n
v −1 = 8 −6 →v = 3
(1)

40
L. Bernardon Machado et al.
Performing the analysis in space, that is, λ = 6, it is possible to calculate the mobil-
ity (M) of the system using the following equation that considers the performance
redundancies (q) [1, 7]:
M −q = (n −j −1) × λ +
j
i=1 fi
M −q = (n −j −1) × λ +

fa + fb + fc + fd + fe + ff + fg + fh

(2)
One must remember the freedoms and restrictions of joint according to Reshetov
[11]. Thus, the joints “a, b, c, d” are type IV [11] joints (linear contact) where they
release only two movements (a translation along the x-axis and a rotation around the
z-axis). The joints “e, f, g, h” are all rotary joints, that is, they release only one rotation
movement around the y-axis [11]. Therefore, according to Eq. 2 the mobility of the
system was deﬁned [1, 7]:
M −q = (n −j −1) × λ +
j
i=1 fi
M −q = (6 −8 −1) × 6 + (2 + 2 + 2 + 2 + 1 + 1 + 1 + 1)
M −q = (−3) × 6 + (12) →M −q = −6
When manipulating the Euler equation (Eq. 1), we can obtain the same relation for
mobility:
M = −v × λ +
j
i=1 fi
M = −v × λ +

fa + fb + fc + fd + fe + ff + fg + fh

M = −3 × 6 + (4 + 4 + 4 + 4 + 1 + 1 + 1 + 1) = −18 + 12 = −6
(3)
To determine the restrictions and extra mobility of the mechanism in question, the
method proposed by Reshetov [11] can be applied. The main objective of Reshetov’s
self-aligning analysis is to eliminate the constraining constraints of the system, thus
increasing the degrees of freedom (DoF) of the mechanism.
3
Analysis of the Mechanism Using the Reshetov’s Method
The Reshetov method [11] aims to help the problem in Fig. 3, where there are restrictions
on the displacement of the pulleys in relation to the irregular track, since they were
designed to satisfy the ideal conditions of the linear track. Thus, the pulleys are subject to
undesirable trajectories, precisely because they have freedom of rotation only in relation
to such, and it would be necessary a freedom of translation to follow the irregular path
without compromising the functioning of the mechanism.
Such a method is a technique of analysis where the freedoms and restrictions found
in the mechanism are all organized in a table (table method). The table consists of
two columns, one representing the freedom of rotation and the other the freedom of
translation,accordingtoeachjointinthesystem.So,aftercompletingthis,itispossibleto
determine all the freedoms and restrictions present, since the mobilities can be rearranged

Analysis of a Proposal for a Self-aligning Mechanism
41
Fig. 3. Schematic ﬁgure of the mechanism on the rails.
according to what needs to be ﬁlled in the table [8, 11]. It is worth mentioning that in this
distribution of extra mobilities (if contains) cannot be rearranged for the same axis, for
example, if we have one rotation left on the x-axis, such rotation can only be reallocated
foratranslationontheyorz-axis[5–7].Finally,thenumberofabsent(missing)freedoms
indicates the number of restrictions of the mechanism and, consequently, the number
of extra freedoms, after satisfying the previous condition, indicates the mobility of the
mechanism [8].
3.1
Analysis for the Robotic Mechanism
The analysis for the mechanism that couples the Cartesian robot is separated into three
parts, one for each loop (independent circuit). Thus the circuits are: abef, cg, dh, as
shown in Fig. 2. Therefore, the freedoms were distributed according to the joints deﬁned
in Sect. 2 (mechanism geometry), taking into account the referential coordinate axis of
Fig. 1, therefore, we have the following analysis [8, 11] (Fig. 4):
For circuit 1 (a, b, e, f ), a rotation around the y-axis (f - in green) was replaced
by a translation in the z-axis (in pink), and a rotation around the z-axis (b - in green)
was replaced by a translation along the y-axis (in yellow), so the extra mobilities were
rearranged and what “came out” was a translation around the x-axis (b - in blue), which
represents the mechanism’s mobility. Therefore, the rotations and translations that have
not received any mobility are considered as system constraints (in red), thus, there is
mobility equal to 1 and a number of restrictions equal to 7, which proves the value found
for the relation of Eq. 2, where [7]:
M −q = (n −j −1) × λ +
j
i=1 fi = −6 →1 −7 = −6
(4)

42
L. Bernardon Machado et al.
Fig. 4. Reshetov’s method.
4
Self-aligned Mechanism Proposal
Using a step-by-step guide to obtain kinematic chains [10] and a guide to obtain all
possible structures [5] leads to a more in-depth approach. Therefore, there are some
viable possibilities that serve as a new conception for a self-alignment of the mecha-
nism, eliminating redundant constraints and providing adequate mobility for the robot
to move on the irregular track without compromising the efﬁciency of operation and
safety of the operation, just as the mechanism is supposed to in relation to the soil and
Fig. 5. Proposed self-aligned mechanism.

Analysis of a Proposal for a Self-aligning Mechanism
43
Fig. 6. Prototype design of cartesian robot in greenhouse for future validating experimentally.

44
L. Bernardon Machado et al.
the greenhouse benches. The proposal for a self-aligning mechanism for the problem
in question, according to the step-by-step mentioned above [7] suggests the following
solution: replace the revolution joints that connect the pulley with the chassis with a
type IV joint [11], which allows both a rotation around the z-axis and a translation along
the x-axis, thus eliminating the difﬁculty of locomotion on the irregular track. This new
joint suggested can be prismatic (allows translation) combined with a revolute joint, thus
obtaining a new kinematics structure, as shown in the following Fig. 5:
The next activity of the project is the experimental validation of a prototype, whose
design is shown in Fig. 6 (real scale). After modeling, the next step to be performed is
the construction of a reduced scale model, assisting in the most diverse analyzes related
to greenhouses, in addition to serving as a learning tool.
5
Conclusions
This paper presented an analysis of mobility and restrictions of a new manipulative mech-
anism for agricultural greenhouses used for the most diversiﬁed activities in protected
cultivation. From an analysis using the mobility and Euler equations, it was found the
presence of undesirable constraints for this case, since the mechanism found it difﬁcult
to move on non-linear guides (irregular rails).
The use of a self-aligning mechanism for greenhouse allows the construction of
prototypes with low costs, not-complex assembly and adequate precision. Thus, the
Reshetov method was used, which in turn proved the existence of extra mobility in
the mechanism and its respective redundant restrictions. Based on the problem it was
proposed some changes in joints of the mechanism, in order to eliminate redundant
constraints and unwanted mobility.
It is important to note that there are several options of a proposal for self-alignment
in relation to the analyzed mechanism. Therefore, the choices described in the article
did not provide signiﬁcant changes in the structure as a whole (it would need a more
in-depth analysis of the number, synthesis and type), but small changes in some joints
that have already partially met the need for the theme displayed. As future work, analysis
will be carried out for the complete system, which involves its activation, trajectory and
control of greenhouse parameters (humidity, brightness, ventilation, irrigation), thus,
new components will be subject to a more in-depth self-aligning analysis.
Acknowledgments. The authors would like to express their gratitude to CNPQ (National Council
for Scientiﬁc and Technological Development) and UFSC (Federal University of Santa Catarina)
for the support this project (SIGPEX Number: 202002173, 202023266 and 202002437) with
scientiﬁc initiation, master and doctoral research.
References
1. Carreto, V.: Study of self-aligning mechanisms using static and kinematic dependence
analysis. Ph.D. thesis, Federal University of Santa Catarina, Brazil (2010)
2. Hunt, K.H.: Kinematic Geometry of Mechanisms. Oxford University Press (1978)

Analysis of a Proposal for a Self-aligning Mechanism
45
3. Ionescu, T.G.: IFTOMM deﬁnitions. Mech. Mach. Theory 38, 767–776 (2003)
4. Li, Z., Lou, Y., Zhang, Y., Liao, B., Li, Z.: Type synthesis, kinematic analysis, and optimal
design of a novel class of Schonﬂies-motion parallel manipulators. IEEE Trans. Autom. Sci.
Eng. 10(3), 674–686 (2012)
5. Martins, D., Murai Hideki, E.: Mechanisms: synthesis and analysis with applications in
robotics. EdUFSC, Florianópolis (2019)
6. Martins, D., Guenther, R., Simas, H.: Hierarchical singularity analysis of an articulated robot.
In: Proceedings of the Brazilian Congress of Mechanical EngineeringIX COBEM, Uberlandia
(2001)
7. Martins, D.: Hierarchical kinematic analysis of manipulator robots. Ph.D. thesis, Federal
University of Santa Catarina, Brazil (2002)
8. Meneghini, M., Artmann, V.N., Simoni, R., Simas, H.: Mobility analysis and self-alignment
of a novel asymmetric 3T parallel manipulator. In: Pucheta, M. Cardona, A., Preidikman,
S., Hecker, R. (eds.) Multibody Mechatronic Systems 2020, MUSME. Cordoba, Argentina
(2020)
9. Porsch, M.R.M.H., Rasia, L.A., Thesing, N.J., Pedrali, P.C., Valdiero, A.C.: Low-cost robotic
manipulator for family agriculture. J. Agric. Stud. 7(4), 225–239 (2019)
10. Pucheta, M., Ulrich, N., Cardona, A.: Combined graph layout algorithms for automated
sketching of kinematic chains (2012). https://doi.org/10.1115/DETC2012-70665
11. Reshetov, L.: Self-aligning Mechanism. MIR, Moscow (1979)
12. Santos, T., Esperidião, T., Amarante, M.: Agriculture 4.0. Res. Action Mag. 5(4), 122–131
(2019)
13. Simoni, R., Martins, D., Carboni, A.: Enumeration of kinematic chains and mechanisms. J.
Mech. Eng. Sci. 223(4), 1017–1024 (2009)
14. Tsai, L.W.: Mechanism Design: Enumeration of Kinematic Structures According to Function.
CRC Press, Boca Raton (2000)

Historical and Technical Analysis of Harmonic
Drive Gear Design
Vivens Irakoze1, Marco Ceccarelli1(B)
, and Matteo Russo2
1 Department of Industrial Engineering, University of Rome Tor Vergata, Rome, Italy
marco.ceccarelli@uniroma2.it
2 Faculty of Engineering, University of Nottingham, Nottingham, UK
matteo.russo@nottingham.ac.uk
Abstract. This paper presents a historical and technical analysis of the Harmonic
Drive Gear Design by taking into consideration the original patent by Clarence
Walton Musser, the inventor of “Strain Wave Gear” and by studying a perfor-
mance evaluation of it. The main original design peculiarities are highlighted, and
the main characteristics are outlined using a numerical analysis of the operation
principle and its efﬁciency.
Keywords: History of gears · Mechanical transmissions · Harmonic drive gear ·
Modelling · FEA analysis · Student paper
1
Introduction
The gear technology addresses interest also in terms of historical investigations to give
merits to achievements and to track evolutions towards new solutions, as reported in
a wide literature with papers, books and encyclopedia chapters. A speciﬁc interest is
addressed to Harmonic Drive gear design as an emblematic example of modern achieve-
ments that have been requested and stimulated improvements and new solutions in
mechatronic machines.
In this paper the peculiar history of Harmonic Drive design is presented referring
to its inventor Clarence Walton Musser and his original patent designs. In addition,
a technical analysis is worked out to explain the original principles of structure and
operation of a Hormonic Drive by also giving an example of an evaluation of today
efﬁcient solutions.
2
Original Concept by Musser
In January 1955 Clarence Walton Musser announced the new design and then in 1957
received a patent for a mechanism called “Strain Wave Gearing” which was later referred
to as “Harmonic Drives”, since a use of ﬂexible geared wheel with harmonic response.
Ofﬁcial information about the patent was issued in 1959 as it is illustrated in Fig. 1,
[1]. At that time even the combination of the words “Strain Wave Gears” was a puzzle
© The Author(s), under exclusive license to Springer Nature Switzerland AG 2022
M. Pucheta et al. (Eds.): MuSMe 2021, MMS 110, pp. 46–55, 2022.
https://doi.org/10.1007/978-3-030-88751-3_5

Historical and Technical Analysis of Harmonic Drive Gear Design
47
and raised a lot of questioning since mechanical engineers were used only to the law
of “rigid-body mechanics” for traditional gears systems. This meant that ﬂexibility was
considered driven out from the gearing system and design.
Fig. 1. Main drawings in the patent of 1959 by Clarence Walton Musser [1].
In1960,almost5yearsafterthebasicpatentwasreleased,WaltonMusserpublisheda
paper “Breakthrough in Mechanical Design: The Harmonic Drive” [2] where for the ﬁrst
time, he explained the operation principles and mechanism as “A continuous deﬂection
wave generated in a ﬂexible spline element achieves high mechanical leverage between
concentric parts”.
Clarence Walton Musser was born on 1909 in Lancaster, Pennsylvania (USA). He
grew up on a farm where he spent many hours in his father’s workshop which led him
to studying topics of his speciﬁc interest. At the age of 10, Walton Musser sketched and
crafted his ﬁrst invention that was on a rubber band gun. He studied in several universities
including Chicago Technical College, MIT, and University of Pennsylvania. In the early
1930’s he worked in a tool and die shop under a cruel foreman who gave him the worst
jobs during a period he later recalled as “some of the best training” of his career. This
experience taught Musser to work under pressure and to solve difﬁcult problems on his
own as a self-education that paid off when he began work on his many other inventions
[5].

48
V. Irakoze et al.
  
  
   
.a)  
 
 
 
b)
Fig. 2. (a) A portrait of Clarence Walton Musser; (b) The title page of 1959 patent, [1].
In 1935 he started his own company designing and manufacturing special machinery
as a proliﬁc inventor. The greatest of those inventions, which came in 1957 can be consid-
ered leverages with elastic deﬂection. In 1955 Walton Musser invented the strain wage
gear and received a patent as shown in Fig. 2(b). As a research adviser at United Shoe
Machinery Corp., he explored non-rigid-body mechanics, using controlled deﬂection as
an operating medium for manufacturing.
3
Structure and Operation
A Harmonic Drive (HD) is made of three main components shown in Fig. 3. These
components include: a Circular Spline, which is a rigid crowned ring; a Flexspline,
which is a ﬂexible thin-walled cylinder whose teeth mesh with the circular spline teeth;
and the Wave Generator which is a thin raced ball bearing ﬁtted on the elliptical plug
generating a high input torque to the whole system.
The Harmonic Drive is basically dependent on the elastic behavior that is due to the
ﬂexibility of metal. This property is a result of signiﬁcant ﬂexibility of the ﬂexspline
walls at the open end and its teeth positioning radially around its outside. The ﬂexspline
ﬁts tightly over the wave generator so that it deforms with the shape of the rotating ellipse
but does not rotate with the wave generator. On the other side the circular spline is a rigid
circular ring that is expected to be stationary regardless of the ﬂexspline movements. The
ﬂexspline and wave generator are placed inside the circular spline, meshing the teeth
of the ﬂexspline and those of the circular spline [3]. The joint connecting ﬂexspline
and wave generator can be considered as a pseudo-revolute kinematic pair. In fact, the
kinematic element of the ﬂexspline is ﬂexible and adapts to the quasi-elliptic shape of
the wave generator. A kinematic structure of the single stage harmonic drive gearing can
be represented by means of the graph shown in Fig. 4(a), bearing similarities with the
one of a basic epicyclic gear (EG) drive in Fig. 4(b).
The meshing gears are those cut on the spline and ﬂexspline whereas the wave
generator plays a role almost like a gear carrier (coaxial). However, within the basic

Historical and Technical Analysis of Harmonic Drive Gear Design
49
Fig. 3. The basic structure of a Harmonic drive, [7]
Fig. 4. Kinematic design of: a) single stage harmonic drive; (b) a conventional epicyclic gear
drive kinematic structure.
EG the axes of the revolute joints are on different levels (i.e., not coaxial). With the
simpliﬁcation discussed above, all the HD revolute joints axes are placed on the same
level [6]. It is assumed that the class of combined harmonic-epicyclic gear trains herein
considered obey the Grubler’s degrees-of-freedom as
m = 3(l −1) −2JR −JG
(1)

50
V. Irakoze et al.
where m represents the degree-of-freedom; l, the number of links; JR and JG are the
number of revolute and gear pairs, respectively. A simple analysis reveals that, in its
simplest form, the HD device has l = 3 links, two coaxial revolute joints (JR = 2) and
one gear pair (JG = 1). Therefore, referring to Fig. 4a, the basic model of HD, once the
support frame is considered, features a single degree-of-freedom as per m = 1.
The dimensions and weight of the Harmonic Drive parts are smaller than those of
other transmission devices with similar kinematic and power characteristics. For this
reason, the distinctiveness of the Harmonic Drive spans a wide range of application
in early and modern devices. Regardly, there has been several developments in the
ﬁeld of industrial engineering that offer improved options in terms of performance and
efﬁciency. The zero-backlash property is a feature that makes it popular in robotic system
yet. Among these, there is a new class of joint torque sensors embedded in Harmonic
Drive using order tracking method as for example in robot arm of Fig. 5, [8].
Fig. 5. An example of integrated Harmonic Drive and torque sensor in robot joint, [8].
4
Harmonic Drive Model
A model of the harmonic drive has been elaborated with Autodesk Fusion360-
engineering software 2021 [4]. After modelling, all the parts are assembled in Autodesk
Inventor as shown in Fig. 6. Generally, all the parts are made of steel as material except
for the ﬂexspline which is made of a ﬂexible stainless steel. Color appearances in Fig. 6
were added to easily differentiate the components and the parts from each other.

Historical and Technical Analysis of Harmonic Drive Gear Design
51
a)
b)
Fig. 6. The modelled Harmonic gear drive assembly: (a) mechanical design; (b) a cross-section
view
5
Finite Element Analysis
The here-in presented 3D simulation focuses on the displacements, reaction forces and
stress analysis for a case with a given input torque of 100 Nm. Data are reported in terms
of maximum and minimum values of these parameters expected to be below the yield
strengths of the assumed materials for a safe operation. In particular, the circular spline
and wave generator are assumed made of steel with yield strength of 207 MPa and shear
modulus of 80.76 GPa, and the Flexpline is assumed made of stainless steel with yield
strength of 250 MPa and shear modulus of 74.23 GPa. A simulation was carried out for
a typical operation using Autodesk Nastran-2021 engineering simulation software. The
circular spline was locked using constraints and the ﬂexible spline was loaded with a
torque of 100 Nm, ﬁrst in the direction of rolling of the gear, then in the opposite direction
for the wave generator. The Fig. 7 shows the computed displacements and deformations
after the simulation has been completed with numerical results and Fig. 8 illustrates the
variation of the displacements recorded on the wave generator’s bearings.
The geometry of the FEA mesh is automatically generated in the used simulation
package with the peculiarity to design smaller nodal distance as function of the expected
deformation instressed areas. Figures 9 and Fig. 10 show results on the applied load and
contact forces analysis, respectively. Firstly, the contact forces are considered between
the teeth of the ﬂexspline and the circular spline. However, the interference between the
gear teeth is very large due to the software’s limitations. Thus, the reaction force values
that were extracted from one ﬂexspline tooth (it is expected similar action to the all the
teeth) are not accurate and the relative stress error was of 0.1974 MPa, which is indeed
a small value.

52
V. Irakoze et al.
             
a)
 
 
b)
Fig. 7. Computed displacement and deformation in a simulated typical operation: (a) Front view;
(b) Rear view
Fig. 8. Graph showing recorded displacements of bearing vs nodal distance

Historical and Technical Analysis of Harmonic Drive Gear Design
53
Fig. 9. Trend of computed applied loads on the ﬂexspline’s tooth
In the stress analysis, the maximum stress value by Von Mises, was computed as
167.5 MPa in the region of the bearings and outer ﬂexible bearing ring. This is a well
satisfactory result considering the ultimate tensile strength of about 345 MPa for the
assumed steel in the simulated mechanical design (Fig. 11).
Fig. 10. Computed reaction forces on the ﬂexspline’s tooth

54
V. Irakoze et al.
Fig. 11. Computed Von Mises stress across the harmonic drive’s main components for a simulated
typical operation
6
Conclusion
This paper summarizes a historical-technical evaluation of Harmonic Drive gearing
design by outlining the sources of the conception by its inventor Clarence W. Musser
and the main operation characteristics. It took quite a while to have the Harmonic Drive
transmission to be well understood and then it has been and it is yet widely used in many
mechatronic systems. A typical operation has been simulated to characterize the perfor-
mance in terms of teeth stress well below the strength limits, motion high transmission
ratios, and reaction forces within the mechanical design.
References
1. Musser, C.W.: US Patent No. 2,906,143 (1959)
2. Musser, C.W.: Breakthrough in mechanical drive design: the harmonic drive. Mach. Des. 14,
160–172 (1960)
3. Timofeyev, G.A., Kostikov, Y.V., Yaminsky, A.V, Podchasov, Y.O.: Theory and practice of
harmonic drive mechanisms. Sci. Eng. 468, 012010 (2018)
4. Autodesk Nastran: Autodesk (2021). https://www.autodesk.com/products/nastran/overview.
Accessed 16 Mar 2021
5. Musser, C.W. (2020). http://www.waltmusser.org/. Accessed 08 Oct 2020
6. Tao, T., Jiang, G.: A harmonic drive model considering geometry and internal interaction.
In: ARCHIVE Proceedings of the Institution of Mechanical Engineers. Part C Journal of
Mechanical Engineering Science, pp. 203–210, 16 December 2015

Historical and Technical Analysis of Harmonic Drive Gear Design
55
7. Toulas, B.: How does a Harmonic Drive work? Why are they used?, September 2019. https://
www.engineeringclicks.com/harmonic-drive/. Accessed 28 June 2020
8. Jung,B.-J.,Kim,B.,Koo,J.C.,Choi,H.R.,Moon,H.:Jointtorquesensorembeddedinharmonic
drive using order tracking method for robotic application. IEEE/ASME Trans. Mechatron.
22(4), 1594–1599 (2017)

Design of Variable Moment of Inertia Flywheel
Vigen Arakelian(B)
LS2N/ECN, UMR 6004 and MECAPROCE, INSA de Rennes, 20 av. des Buttes de Coesmes,
CS 70839, 35708 Rennes, France
vigen.arakelyan@ls2n.fr, vigen.arakelyan@insa-rennes.fr
Abstract. This paper considers the problem of a mechanical system design with
a variable moment of inertia. The suggested system consists of a rotating disc
with the ability to change the angle of inclination by means of a rod and a slider
mounted on the rotation axis. Design equations and techniques are described,
making possible the dynamic substitution of the mass of the connecting rod by
two concentrated masses. By application of the suggested dynamic model of the
coupling rod, a weightless link with two concentrated masses has been obtained.
This allows a more precise estimation of the inﬂuence of the connecting rod
position on the moment of inertia about the rotation axis. A numerical example
illustrates the proposed design of variable moment of inertia ﬂywheel.
Keywords: Flywheel · Mechanism design · Energy storage · Variable moment
of inertia · Dynamic substitution of masses
1
Introduction
The energy storage by ﬂywheel consists in storing kinetic energy thanks to the rotation of
a heavy object (a wheel or a cylinder), generally moved by a drive mechanism, and then
to restore this energy as a generator. Due to its very simple conﬁguration, the ﬂywheel
has had many applications in the past and poses new possibilities for innovative use in
the future. New approaches to design of ﬂywheels have continued to attract the attention
of researchers and different solutions are constantly being reported. One of the most
challenging areas in this ﬁeld is the development of variable-inertia ﬂywheels. One of
the earliest variable inertia ﬂywheels was the ﬂyball governor by James Watt.
Ullman [1] proposes four original variable-inertia ﬂywheel solutions, which are
variations of Watt’s concept. One attempt to apply the use of a variable-inertia ﬂywheel
to a moving vehicle, albeit a toy, has been proposed in [2]. Gulia [3] proposed one of
the most interesting design concept for a variable-inertia ﬂywheel called band ﬂywheel.
This concept was further developed in [4, 5]. Ullman also analyzed the concept of a band
variable-inertia ﬂywheel applied it to powering an inertia load [6–8]. In [9], by means
of computer simulation, the potential of a Band Variable-Inertia Flywheel as an energy
storage device for a diesel engine city bus was also evaluated. It has been shown that the
regenerative braking system reduces brake wear by a factor of ﬁve in comparison with
the conventional vehicle.
© The Author(s), under exclusive license to Springer Nature Switzerland AG 2022
M. Pucheta et al. (Eds.): MuSMe 2021, MMS 110, pp. 56–63, 2022.
https://doi.org/10.1007/978-3-030-88751-3_6

Design of Variable Moment of Inertia Flywheel
57
A ﬂywheel of regulated moment of inertia comprising a heavy rim, which is a link for
half-clutches, set on the shafts of electric motor and initial mechanism segment was also
developed [10]. In the proposed system, the heavy sliders can travel in radial grooves of
the rim and form rectilinear sliding pairs with the latter. Spokes form rotating kinematic
pairs with half clutches and sliders.
Fluidic variable inertia ﬂywheel was also developed [11–14], which can acquire
variable inertia through the valve’s control over the ﬂuid ﬂow. A kind of variable inertia
ﬂywheels was proposed by Elliott, Mintah and Lapen [15], the centrifugal force can
change the displacement of the mass block and the control system can lock the position
of mass block with hydraulic ﬂuid and control valve. The variable inertia ﬂywheel starts
with small inertia and rotate at high speed with big inertia improving the stability of
machinery. The inertia of ﬂywheel in the invention of Jayakar and Das [16] can be
changed by ﬁlling and draining.
Based on the ﬂywheel concept proposed by Jauch [17] applied to wind turbine and
the ﬂywheel design developed by Hamzaoui et al. [18] and Yang et al. [19] applied to
hydraulic system, in [20], a variable inertia ﬂywheel for diesel generator, was considered.
This paper proposes a new solution, which consists in adjusting the moment of inertia
with respect to its axis of rotation by setting the inclination angle of the ﬂywheel disc.
2
Design of the Variable Inertia Flywheel
When solving various technical problems, it becomes necessary to use ﬂywheels with a
variable moment of inertia. Thereby, it is often required to adjust the moment of inertia
based on dynamic behavior of the mechanical system.
Consider an adjustable ﬂywheel based on the variation of the inclination of the disc
with respect to its axis of rotation (Fig. 1). It consists of a disc 1 connected to its rotating
axis 2 by means of revolute joint 3. The slider 4 and the rod 5 are connected by spherical
joints. The special form of the connecting rod 5 is discussed below. Thus, the slider 4
and the connecting rod 5 carry out the variation of the inclination angle α of the disc 1.
Let us see how this system works. Suppose that it is necessary to ensure the given
moment of inertia Iz1.
The relation between Iz1 and Ix′
1, Iz′
1, i.e. the moment of inertia about the rotation
axis z of the disc and its axes of symmetry is as follows [21]:
Iz1 = Ix′
1sin2α + Iz′
1cos2α
(1)
with
Ix′
1=Iy′
1 = m1

R2
D/4 + h2
D/12

(2)
Iz′
1 = 0.5m1R2
D
(3)
where, m1 is the mass of the disc 1; RD and hD are the radius and the width of the
disc 1 (Fig. 2). Please note that Ix′
1y′
1 = Ix′
1z′
1 = Iy′
1z′
1 = 0, since the axes of the coordinate
system x
′
1y
′
1z
′
1 directed along the axes of symmetry of the disc 1.

58
V. Arakelian
Fig. 1. Variable inertia ﬂywheel.
From (1), we determine the inclination angle α of the disc 1, which ensure the given
inertia moment Iz1:
α = cos−1
Iz1 −Ix′
1

/

Iz′
1 −Ix′
1
1/2
(4)
Thus, knowing the angles α and β (see Fig. 1), we determine the displacement d to
adjust the position of the disc 1:
d =

(lOC + lCD)2 −e21/2
−lOCcosϕ −lCD

1 −(lOCsinϕ −e)2l−2
CD
1/2
(5)
where, lOC is the distance between the centers of joints O and C; lCD is the length
of the connecting rod 5; e is the eccentricity of slider guide 5 (see Fig. 1).
Thus, by controlling the inclination angle α of the disc 1 through the slider’s
displacements, a given moment of inertia Iz1 can be provided.
Fig. 2. Disc’s parameters about its axes of symmetry.
However, the position of the connecting rod 5 will affect the moment of inertia of the
system about axis z should be taken into account. To simplify this task, consider a special

Design of Variable Moment of Inertia Flywheel
59
shape of the connecting rod 5 making possible the dynamic substitution of its mass by
two concentrated masses located in the joint centers C and D. Standard connecting rod
represents two spheres connected with a cylinder. Such a shape of the coupler is not
optimal for the realization of the dynamic modeling by masses substitution [22].
Figure 3 shows a special coupling rod shape composed by two elements: the segments
of a sphere and a cylinder.
a) 
                                                                       b)
Fig. 3. A special coupler shape: (a) CAD model in 3D; (b) drawing in 2D.
Fig. 4. Segment of a sphere.
Fig. 5. Circular cylinder.
Segments of sphere (Fig. 4).
– Masse:
m
′
5 = πh2(3R −h)ρ/3
(6)
where, ρ is the coefﬁcient of the material density, which is same for all elements of
the coupler; h and R are geometric parameters shown in Fig. 4.
– The location of the center of masses S
′ of the segment of a sphere can by found by
the expression:
x
′
S = 0.25h(8R −3h)/(3R −H)
(7)
– Mass moments of inertia:
Ix′x′ = 0.1m
′
5h

5R(4R −3h) + 3h2
/(3R −h)
(8)

60
V. Arakelian
Iy′y′ = Iz′z′ = 0.5Ix′x′ + m
′
5h2
8R(5R −3h) + 3h2
/

80(3R −h)2
(9)
Circular cylinder (Fig. 5).
– Mass:
m
′′
5 = πr2Lρ
(10)
where, r is the radius of the circular cylinder and L its length (see Fig. 5).
– The location of the center of masses S
′′ of the segment of a sphere can by found by
the expression:
x
′′
S = 0.5L
(11)
– Mass moments of inertia:
Ix′′x′′ = 0.5m
′′
5r2
(12)
Iy′′y′′ = Iz′′z′′ = 0.25m
′′
5r2 + m
′′
5L2/12 = m
′′
5

3r2 + L2
/12
(13)
Taking into account that the suggested coupler shape is symmetric and the rotation
around the longitudinal axis is locked by a pin, the condition of the dynamic substitution
of the coupler mass by the concentrated masses m5C and m5D located at the centers C
and D of the spherical joints can be reduced to the expression:
2Iz′z′ + 2m
′
5

R −x
′
S + 0.5l
2
+ Iz′′z′′ = (m5B + m5C)(0.5l)2
(14)
where, m5C = m5D = m
′
5 + 0.5m
′′
5.
Introducing the relationsips (6)–(13) into Eqs. (14), we obtain the folloxing equation:
2πh2
3
(3R −h)
 h
20 · 5R(4R −3h) + 3h2
3R −h
+ h2
80 · 8R(5R −3h) + 3h2
(3R −h)2

+

2πh2(3R −h)/3

×

R −x
′
S + 0.5l
2
+ πr2L

3r2 + L2
/12
= (0.5l)2
2

πh2(3R −h)/3

+ πr2L

(15)
From which we determine the radius of the connecting cylinder:
r1,2 = 0.25a−2

−b ±
	
b2 −4ac
(16)
where,
a = 3πL/12
(17)

Design of Variable Moment of Inertia Flywheel
61
b = πL3/12 −πLl2/4
(18)
c =

2πh2(3R −h)/3

0.05h

5R(4R −3h) + 3h2
/(3R −h)+

h2/80

8R(5R −3h) + 3h2
/

(3R −h)2
+

2πh2(3R −h)/3

×

R −x
′
S + 0.5l
2
−0.5l2
πh2(3R −h)/3

(19)
Thus, after applying such a special rod shape, we obtain a system of two point masses
m5C and m5D dynamically equivalent to the coupling rod 5.
This makes it easy to express the moment of inertia of all elements of the system in
relation to the z-axis:
Iz = Iz1 + Iz2 + Iz4 + m5Cl2
OCsin2ϕ + m5De2
(20)
Let us consider a numerical example.
3
Illustrative Example
Let us consider the design of the suggested system ensuring Iz = 4.5 kgm with following
parameters of links: RD = 0.3 m; hD = 0.05 m; m1 = 110 kg; β = 20◦; lOC = 0.18 m;
lCD = 0.3 m; e = 0.08 m; Iz2 = 0.1 kgm2; Iz4 = 0.08 kgm2.
By selecting the geometrical parameters R = 0.04 m and h = 0.06 m, we ﬁnd from
(16) the radius r = 0.0083 m of the connecting cylinder of the rod 5. Then, we determine
the concentrated masses: m5C = m5D = 2 kg.
Taking into account that Ix′
1=Iy′
1 = m1

R2
D/4 + h2
D/12

= 2.27 kgm and Iz′
1 =
0.5 m1R2
D = 4.95 kgm2, from (20), we determine the inclination angle = 30◦of the disc
1, which ensure the given value of the moment inertia Iz.
Thus, by setting a new value of the moment of inertia Iz, the new angle of inclination
α will be determined that will adjust the moment of inertia. It is obvious that the change
in the moment of inertia Iz will be limited by the capabilities of the system.
4
Conclusions
During the last century, ﬂywheel mechanical energy storage has advanced from simple
inertial rotating machines operating at low speeds to fully integrated electro-mechanical
systems. These systems are now becoming enabling technologies for many applications.
One of the ways to develop the new concepts is the creation of ﬂywheels with a variable
moment of inertia. Adjustment of the ﬂywheel moment of inertia depending on the
operating mode of the machine expands their technological capabilities.
The paper proposes a new solution, which consists in adjusting the ﬂywheel moment
of inertia by setting the inclination angle of the disc. A heavy disc that is the ﬂywheel
mounted on a rotating axis through a revolute joint. This allows one to set the required
angle of inclination of the cylinder in relation to its axis of rotation. Thus, the disc

62
V. Arakelian
inclination angle determine the moment of inertia of the ﬂywheel. The paper describes
in detail how to determine this inclination angle of the disc to establish the required inertia
of ﬂywheel. A numerical example illustrates the variable moment of inertia ﬂywheel. It
should be noted that in the paper a cylindrical disc is considered. However, it is obvious
that it is possible to apply a similar approach to other shapes, such as wheels, coiled
band mechanisms, systems with moving sliders, etc.
The paper also discusses a connecting rod with spatial shape that allows the dynamic
substitution of the rod’s mass by two concentrated masses located on its joint axes. This
allows a more precise estimation of the inﬂuence of the connecting rod position on
the moment of inertia about the rotation axis. However, observation shows that the
inﬂuence of additional links of the suggested ﬂywheel system, such as connecting rods
and slider, on the change in the moment of inertia is not signiﬁcant. Therefore, the use
of a connecting rod with a special shape can be considered as an additional design step.
References
1. Ullman, D.G.: A Variable Inertia Flywheel as an Energy Storage System. Ph.D. Dissertation,
Ohio State University (March 1978)
2. Lin, S.T.: Variable Inertia Flywheel. US Patent 3,968,593, 13 July 1976
3. Gulia, N.V.V: Variable Moment-of-Inertia Flywheel. SU 1182724/24-27 (July 1969)
4. Dvali, R.R., Gulia, N.V.: A coiled band mechanism for the recovery of a vehicle’s mechanical
energy. J. Mech. 3(3), 113–118 (1969)
5. Gulia, N.V.: Centrifugal Accumulator, SU 1131894/25-28 (November 1969)
6. Ullman, D.G., Velkoff, H.R.: An introduction to the variable inertia ﬂywheel, VIF. J. Appl.
Mech. 46(1), 186–190 (1979). https://doi.org/10.1115/1.3424494
7. Ullman, D.G.: The Band Type Variable Inertia Flywheel and Fixed Ratio Power Recirculation
Applied to it. Presented at the Mechanical and Magnetic Energy Storage Technology Meeting
(October 1978)
8. Ullman, D.G., Corey, J.: Continued Development of the Band Variable Inertia Flywheel.
Report of Union College, Schenectady, New York (1980)
9. Moosavi-Rad, H., Ullman, D.G.: A band variable-inertia ﬂywheel integrated-urban transit
bus performance. SAE Trans. J. Commer. Veh. 99(Section 2), 933–942 (1990)
10. Eliseev, S.V., et al.: Flywheel of regulated moment of inertia. RU Patent 2498127C1, 10
November 2013
11. Van de Ven, J.: Fluidic variable inertia ﬂywheel. In: 7th International Energy Conversion
Engineering Conference, 2–5 August 2009, Denver, Colorado (2009)
12. Dugas, P.J.: Variable Inertia Flywheel. US 2011/0277587, 17 November 2011
13. Van de Ven, J.: Fluidic Variable Inertia Flywheel and Flywheel Accumulator System. US
Patent 8,590,420, 26 November 2013
14. Dugas, P. J.: Variable inertia ﬂywheel. US 20150204418, 23 July 2015
15. Elliott, Ch., Mintah, B., Lapen D.: Variable Inertia Flywheel. US20090320640, 31 December
2009
16. Jayakar, V., Das, S.K., Variable Inertia Flywheel. US 20120291589, 22 November 2012
17. Jauch, C.: A ﬂywheel in a wind turbine rotor for inertia control. Wind Energy 18(9), 1645–
1656 (2015)
18. Hamzaoui, I., Bouchafaa, F., Talha, A.: Advanced control for wind energy conversion systems
with ﬂywheel storage dedicated to improving the quality of energy. Int. J. Hydrog. Energy
41(45), 20832–20846 (2016)

Design of Variable Moment of Inertia Flywheel
63
19. Yang, S., Xu, T., Li, C., Liang, M., Baddour, N.: Design, modeling and testing of a two-
terminal mass device with a variable inertia ﬂywheel. J. Mech. Des. 138(9), 095001 (2016).
https://doi.org/10.1115/1.4034174
20. Zhang, Y., et al.: Modeling and simulation of a passive variable inertia ﬂywheel for diesel
generator. Energy Rep. 6, 58–68 (2020)
21. Uicker J.J., Jr., Pennock, G.R. and Shigley J.E.: Theory of Machines and Mechanisms, p. 752.
OUP, USA (2003)
22. Arakelian, V., Briot, S.: Balancing of Linkages and Robot Manipulators. Advanced Methods
with Illustrative Examples. Springer, Heidelberg (2015)

Kinematics of a Robotic System
for Rehabilitation of Lower Members
in Hypotonic Infants
Marco García1(B), Esther Lugo-González2, Manuel Arias-Montiel2,
and Ricardo Tapia-Herrera3
1 Universidad Tecnológica de la Mixteca, Carretera a Acatlima Km. 2.5, Acatlima,
69000 Huajuapan de León, Oax, México
2 Institute of Electronics and Mechatronics, Universidad Tecnológica de la Mixteca,
Carretera a Acatlima Km. 2.5, Acatlima, 69000 Huajuapan de León, Oax, México
{elugog,mam}@mixteco.utm.mx
3 CONACYT-Universidad Tecnológica de la Mixteca, Carretera a Acatlima Km. 2.5,
Acatlima, 69000 Huajuapan de León, Oax, México
rtapiah@conacyt.mx
Abstract. This paper develops the kinematics of a parallel mechanism
with topology 5R. This mechanism focuses on the lower limb rehabili-
tation of hypotonic infants. At ﬁrst, the inverse kinematics is solved to
generate circular and ellipsoidal trajectories with the objective of demon-
strating that speciﬁc trajectories, such as ﬂexion/extension, can be gen-
erated during the rehabilitation for an infant with hypotonia. The per-
formed analysis to obtain the dimensions of the links is shown, as well
as the equations of the proposed mechanism motion. The velocity anal-
ysis is also obtained, which will be later used to design and implement
the control system necessary to generate the movement in the rehabili-
tation therapy. As a numerical result, the inverse kinematics validation
is presented by performing simulations in ADAMS View software.
Keywords: Inverse kinematics · Parallel robot · Trajectory ·
Hypotonia
1
Introduction
Hypotonia is a condition characterized by a deﬁciency of muscle tone which
mainly occurs in infants. Palliative treatment is a passive therapy, and to the
best of the authors’ knowledge, there are no robotic devices for infants with this
pathology as the dimension, weight, materials, or mobility values must be very
speciﬁc [1]. The basic passive therapy applied to the lower limbs of hypotonic
infants focuses on the hip, knee and ankle, movements generated on the sagittal
plane. For this condition, parallel robots have been used to generate movements
and speciﬁc trajectories in this type of rehabilitation.
c
⃝The Author(s), under exclusive license to Springer Nature Switzerland AG 2022
M. Pucheta et al. (Eds.): MuSMe 2021, MMS 110, pp. 64–73, 2022.
https://doi.org/10.1007/978-3-030-88751-3_7

Robotic System for Rehabilitation
65
The 5R parallel manipulator is a plane mechanism with two degrees of free-
dom that has been widely studied using analytical and numerical methods, as
reported in [8,11]. An application of a 5R parallel manipulator is found in [4],
where a lower limb rehabilitation device was developed with the proposed mech-
anism providing exercises for knee rehabilitation. For lower limb mobilization,
there are devices such as the plane Lambda [3] mechanism which is composed
of 3 links and 3 active joints: 2 translational and one rotational. Furthermore
RECOVER [6] is a parallel robotic system designed for lower limb rehabilitation.
This kinematic model was formulated to achieve a direct correlation between
the robot’s active joints and anatomical joint angles. It is composed of two
modules: the hip-knee module that has 2 DOF and facilitates ﬂexion/extension
movements of the hip and knee, while the ankle module with 2 DOF performs
ﬂexion/extension and inversion/eversion of the ankle. In another study, Calin
Vaida et al. in [12] proposed a parallel robot that has a modular construction
allowing hip, knee and ankle mobility. The kinematics of the robotic system was
presented and singularities were found. A detailed kinematic analysis was per-
formed to demonstrate that the robot performs the required movements safely
through numerical simulations. Moreover, the HyPO [9] is a robot designed with
parallel links instead of gear systems or timing belt systems to transmit the
torques generated by the actuators to the knee and hip joints. The links are
four-bar mechanisms in which one link is connected to the actuator to transfer
the generated torque. All the aforementioned parallel robots and mechanisms
are designed for adults and are generally used for rehabilitation after a stroke or
surgery.
For children (between 3 and 12 years old), exoskeleton robots have been
mainly developed to support walking. This is achieved by generating movement
in the sagittal and/or frontal plane, and some of these designs are those presented
by [2,5,7,10]. These works develop hip, knee and ankle movements, mainly gener-
ating ﬂexion/extension in each limb, but most are used with the infant standing
or using the upper limb. The previously mentioned designs have no dimension
and angle of movement required for hypotonic infant therapy, but give the basis
for designing a robotic system that is 500 mm in length, supports a weight of
approximately 2.5 kg and automatically develops hip, knee and ankle movements
in the supine position.
2
Robot Proposal
For generating ﬂexion/extension movements, a mechanism that considers the
dimensions of infants (500 mm in length as the maximum value) is required.
ANTROPROJETO R⃝software is used to achieve this, which receives as input
the length of the infant and as output returns the anthropometric values.
To generate the necessary trajectories, parallel robots work appropriately
and are positioned horizontally parallel to the infant’s lower limbs in the sagittal
plane. The mobile platform of the parallel robot can be located at the infant’s
ankle. In this case, a ﬁve-bar mechanism is the basis of the robot. Kinematic

66
M. García et al.
analysis and simulations that generate ﬂexion/extension movements of the hip,
knee and ankle in this robot to achieve one of the infant’s rehabilitation phases
are presented.
The parallel robot design consists of nine links and ten articulated joints,
as shown in Fig. 1. With these elements, three basic mechanisms are formed,
two with four bars and one with ﬁve. The ﬁrst four-bar mechanism is created
with a conﬁguration to give mobility to the femur, while two links are added to
conﬁgure a ﬁve-bar mechanism thereby giving mobility to the tibia and ﬁbula
joints. Finally, there is a four-bar mechanism providing movement to the ankle.
Fig. 1. a) Mechanism for rehabilitation of the lower limbs.
The ﬁve-bar mechanism has two degrees of freedom which generates two inde-
pendent movements for carrying out a previously established trajectory (ﬂex-
ion/extension movement). The infant’s characteristics (500 mm of length), pro-
vides the dimensions of the OB and BE links, meaning that the links for BF,
FG, GH, and HO can be calculated. For restriction and calculation purposes,
the dimensions of the OB and BE links are ﬁxed, but can vary to adapt to an
infant’s development. To calculate the ﬁve-bar mechanism trajectory synthesis,
consider Fig. 2 and the Eqs. (1) and (2):
L2 + L3 −L1 −L5 −L4 = 0
(1)
Writing in complex numbers
L2ejθ2 + L3ejθ3 −L1ejθ1 −L5ejθ5 −L4ejθ4 = 0
(2)
Rewriting and using Euler’s formula for complex numbers
L2cosθ2 + L3cosθ3 −L1 −L5cosθ5 −L4cosθ4 = 0
(3)
L2sinθ2 + L3sinθ3 −L5sinθ5 −L4sinθ4 = 0
(4)

Robotic System for Rehabilitation
67
Fig. 2. The diagram for obtaining the ﬁve-bar mechanism synthesis.
With this proposal, the hip, knee and ankle joints will have movement but
they are restricted to a single plane and with only two degrees of freedom. In
Table 1 the lengths of links are observed, and the actuators that give the system
its mobility are denoted by θ2 and θ5 located in joints O and H in Fig. 2.
Table 1. Length of links
Link Length (mm)
L1
60
L2
122
L3
40
L4
122
L5
40
2.1
Kinematic of Five-Bar Mechanism
The parallel manipulator 5R, shown in Fig. 2, moves the point F = Pxy in the
plane with a ﬁxed link OH, while the actuated joints are the points O, H and
are measured as θ2 and θ5, with regard to the x-axis.
For inverse kinematics, the coordinates or trajectory of point Pxy are known
and the input angles of the manipulator must be calculated. The output point
Pxy in reference frame Oxy can be described by position vector P, and
P = (x
y)T
(5)

68
M. García et al.
Considering Oxy, position vectors of bi of points Bi are written as:
b1 =
L1cosθ2 −L3
L1sinθ2
T
(6)
b2 =
L1cosθ5 −L3
L1sinθ5
T
(7)
Therefore, the inverse kinematics problem can be solved by writing the con-
straint equations |pb1| = r2 and |pb2| = r5, in this way
(x −L1cosθ2 + L3)2 + (y −L1sinθ2)2 = L2
2
(8)
(x −L4cosθ5 + L6)2 + (y −L4sinθ5)2 = L2
5
(9)
By knowing the position of output point Pxy, inputs to reach this point can
be obtained as
θ2 = 2 arctan(z1)
(10)
θ5 = 2 arctan(z2)
(11)
where
z1 = −b1 ±

b2
1 −4a1c1
2a1
(12)
z2 = −b2 ±

b2
2 −4a2c2
2a2
(13)
after developing Eqs. (12) and (13), terms are:
a1 = L2
1 + y2 + (x + L3)2 −L2
2 + 2(x + L3)L1
a2 = L2
4 + y2 + (x −L6)2 −L2
5 + 2(x −L6)L4
b1 = −4yL1
b2 = −4yL4
c1 = L2
1 + y2 + (x + L3)2 −L2
2 −2(x + L3)L1
c2 = L2
4 + y2 + (x −L6)2 −L2
5 −2(x −L6)L4
Equations (12) and (13) have four possible solutions for inverse kinematics.
The Fig. 2 conﬁguration can obtain the sign (±), while Eq. (12) is positive (+)
and Eq. (13) sign is positive (+). The resulting conﬁguration is known as (+−)
model. The graphs obtained with MATLAB (Fig. 3) to show inverse kinematics
implementation in 5-bars mechanisms are two trajectories, a circumference, given
by Eq. (14) and an ellipse given by Eq. (15).
Px = 40 + 25cos(φ), Py = 120 + 25sin(φ)
(14)
Px = 40 + 50cos(φ), Py = 120 + 25sin(φ)
(15)

Robotic System for Rehabilitation
69
Fig. 3. Circular and elliptical path.
As can be seen, the mechanism follows speciﬁc trajectories, validating the
links’ dimensions. The next point is to verify that speciﬁc angles for a rehabili-
tation sequence are generated.
3
Results and Discussion
The kinematics validation is carried out by taking the results of Matlab simi-
larity. With the point F position at each instant of time and the use of polyfit
tool, two polynomials are constructed which describe the behavior of angles θ2
and θ5 as shown in Eqs. (16) and (17). These polynomials are the input of the
angles θ2 and θ5 of actuators in ADAMS View.
θ2 = −0.0003t2 −0.148t + 78.3768
(16)
θ5 = −0.0005t2 + 0.4712t −0.2529
(17)
The polynomials constructed in Matlab are introduced in the inputs θ2 and θ5
of the model in ADAMS View to generate the movement in the mechanism. The
angular displacement is also measured and compared with the results obtained
from the mathematical model. Figure 4 shows the graphs of the mathematical
model and the Matlab polynomials when comparing with the results of the model
in ADAMS View, thereby verifying the mechanism movement.

70
M. García et al.
Fig. 4. Values of θ2 and θ5 measured in a) the ADAMS View and b) MATLAB simu-
lation.
The results obtained from trajectory of point F = Pxy in Fig. 2 correspond
to the proposed trajectory, and similar results were observed in Fig. 5 obtained
with MATLAB and ADAMS View software.
To perform the velocity analysis, Eqs. (8) and (9) were derived with regard
to time and simpliﬁed as
L1(ycosθ2 −(x + L3)sinθ2) ˙θ2 = (x + L3 −L1cosθ2) ˙x + (y −L1sinθ2) ˙y
(18)
L4(ycosθ5 + (L6 −x)sinθ5) ˙θ5 = (x −L6 −r4cosθ5) ˙x + (y −L4sinθ5) ˙y
(19)
Writing Eqs. (18) and (19) in matrix form.
A ˙θ = B ˙p ⇔Jq ˙q = Jx ˙x
(20)
˙θ = [ ˙θ2 ˙θ5]T ⇔˙q
(21)

Robotic System for Rehabilitation
71
Fig. 5. Result of the simulation in MATLAB and ADAMS View for Px and Py.
˙p = [ ˙x ˙y]T ⇔˙x
(22)
A =

[ycosθ2 −(x + L3)sinθ2]L1
0
0
[ycosθ5 + (L6 −x)sinθ5]L4

(23)
B =
x + L3 −L1cosθ2 y −L1sinθ2
x −L6 −L4cosθ5 y −L6sinθ5

(24)
For the velocity simulation, a circumference trajectory was used, and the test
was performed with 10 mm/s with the results shown in Fig. 6. As can be seen,
the velocity ω2 of actuator one starts at 0 deg/s and increases as time progresses
until it reaches 0.9 deg/s after 180 s. For the case of actuator two, it has an initial
velocity of 0.34 deg/s denoted by ω5 and decreases until it reaches 0.14 deg/s over
a period of 180 deg/s. With these angular velocities of the actuators, the 10 mm/s
at the point F of the 5R mechanism is achieved.
As a ﬁnal result, the simulated mechanism in Adams View (Fig. 7) is shown,
and the ﬂexion position of the lower limbs in the sagittal plane can be observed.
The symmetry of the infant’s lower limbs compared to the mechanism’s position
is also observed.

72
M. García et al.
0
50
100
150
0
0.1
0.2
0.3
0.4
Angle (º)
Fig. 6. Angular velocity values, to have a velocity of 10 mm/s.
Fig. 7. Similarity between the posture of an infant and the posture of the whole mech-
anism.
4
Conclusions
A mechanism was presented to be used in the design for children with hypo-
tonia rehabilitation prototype and it was observed that it is necessary for the
mechanism to follow the pre-established trajectory in rehabilitation sessions. In
this work, the following of a circular trajectory and an ellipse was presented
to show that the designed mechanism can follow a speciﬁc movement such as
ﬂexion/extension generated by the hip, knee and ankle in the sagittal plane.
The rehabilitation device is made up of a 5-link parallel robot divided into three
parts: two with four bars and one with ﬁve, with this last bar the main focus
of this study. For the dimensional synthesis of the 5-bar mechanism, only the
BF, FG, GH and H0 links were calculated because the rest were used from
the length of the infant’s lower limb. For inverse kinematics calculations, the
constraint equations were considered for obtaining the behavior in position and
velocity. The graphical results were validated with the mathematical model in
Matlab which has a similar behavior to the model in ADAMS View compared to
velocity and position, which provides the basis for the design and construction
of the rehabilitation prototype.

Robotic System for Rehabilitation
73
References
1. Alfonso, I., Papazian, O., Valencia, P.: Hipotonía neonatal generalizada. Rev. Neu-
rol. 37(3), 228–239 (2003)
2. Andrade, R.M., Sapienza, S., Bonato, P.: Development of a “transparent operation
mode” for a lower-limb exoskeleton designed for children with cerebral palsy. In:
2019 IEEE 16th International Conference on Rehabilitation Robotics (ICORR),
pp. 512–517. IEEE (2019)
3. Bouri, M., Le Gall, B., Clavel, R.: A new concept of parallel robot for rehabilitation
and ﬁtness: the lambda. In: 2009 IEEE International Conference on Robotics and
Biomimetics (ROBIO), pp. 2503–2508 (2009). https://doi.org/10.1109/ROBIO.
2009.5420481
4. Chaparro-Rico, B.D., Castillo-Castaneda, E., Maldonado-Echegoyen, R.: Design of
a parallel mechanism for knee rehabilitation. In: Ceccarelli, M., Hernández Mar-
tinez, E.E. (eds.) Multibody Mechatronic Systems. MMS, vol. 25, pp. 501–510.
Springer, Cham (2015). https://doi.org/10.1007/978-3-319-09858-6_47
5. Eguren, D., Cestari, M., Luu, T.P., Kilicarslan, A., Steele, A., Contreras-Vidal,
J.L.: Design of a customizable, modular pediatric exoskeleton for rehabilitation and
mobility. In: 2019 IEEE International Conference on Systems, Man and Cybernet-
ics (SMC), pp. 2411–2416. IEEE (2019)
6. Gherman, B., Birlescu, I., Plitea, N., Carbone, G., Tarnita, D., Pisla, D.: On the
singularity-free workspace of a parallel robot for lower-limb rehabilitation. Proc.
Rom. Acad. 20(4), 383–391 (2019)
7. Giergiel, M., Budziński, A., Piątek, G., Wacławski, M.: Personal lower limb reha-
bilitation robot for children. In: Awrejcewicz, J., Szewczyk, R., Trojnacki, M.,
Kaliczyńska, M. (eds.) Mechatronics - Ideas for Industrial Application. AISC,
vol. 317, pp. 169–176. Springer, Cham (2015). https://doi.org/10.1007/978-3-319-
10990-9_17
8. Liu, X.J., Wang, J., Zheng, H.J.: Optimum design of the 5R symmetrical parallel
manipulator with a surrounded and good-condition workspace. Robot. Auton. Syst.
54(3), 221–233 (2006)
9. Obinata, G., et al.: Hybrid control of powered orthosis and functional neuromus-
cular stimulation for restoring gait. In: 2007 29th Annual International Conference
of the IEEE Engineering in Medicine and Biology Society, pp. 4879–4882. IEEE
(2007)
10. Sancho-Perez, J., Perez, M., Garcia, E., Sanz-Merodio, D., Plaza, A., Cestari,
M.: Mechanical description of atlas 2020, a 10-DOF paediatric exoskeleton. In:
Advances in Cooperative Robotics, pp. 814–822. World Scientiﬁc (2017)
11. Sosa-López, E.D., Arias-Montiel, M., Lugo-Gónzalez, E.: A numerical approach
for the inverse and forward kinematic analysis of 5R parallel manipulator. In: 2017
14th International Conference on Electrical Engineering, Computing Science and
Automatic Control (CCE), pp. 1–6. IEEE (2017)
12. Vaida, C., et al.: Systematic design of a parallel robotic system for lower limb
rehabilitation. IEEE Access 8, 34522–34537 (2020)

Modelling and Simulation of Multibody
Systems

Modeling and Simulation of Frictional Contacts
in Multi-rigid-Body Systems
Paulo Flores(B)
CMEMS-UMinho, Department of Mechanical Engineering, University of Minho, Campus de
Azurém, 4804-533 Guimarães, Portugal
pflores@dem.uminho.pt
Abstract. Fictional contacts occur in many mechanical systems, and often affect
their dynamic response, since the collisions cause a signiﬁcant change the systems’
characteristics, namely in terms of velocities. This work describes and compared
different formulations to handle frictional contacts in multi-rigid-body dynamics.
For that, regularized and non-smooth techniques are revisited. In a simple manner,
the regularized methods describe the contact forces as a continuous function of
the indentation, while the non-smooth formulations use unilateral constraints to
model the contact problems, which prevent the indentation from occurring. The
main motivation for the performing this study came from the permanent interest
in developing computational models for the dynamic modeling of contact-impact
events under the framework of multibody systems methodologies. The problem
of modeling and simulating contacts with friction in multibody systems includes
several steps, the deﬁnition of the contact geometry; the determination of the con-
tact points; the resolution of the contact itself; and the evaluation of the transitions
between different contact regimens. The last two aspects are investigated in this
work within the context of contact dynamics. In the sequel of this process, an
application example is utilized to show the effectiveness of the modelling pro-
cess of contact problems in multibody systems. Finally, future developments and
new perspectives for further developments related to contact-impact problems are
presented and discussed in this study.
Keywords: Frictional contacts · Contact dynamics · Contact detection · Contact
resolution · Regularized methods · Non-smooth techniques · Linear
complementarity problem · Multibody dynamics
1
Introduction
By and large, frictional contacts involves the problem of the modeling the interaction
of colliding bodies in the presence of frictional phenomena. This discipline is often
named as contact dynamics and deals with the motion of multibody systems subjected
to contact-impact forces/impulses. Contact dynamics is omnipresent in many multibody
applications, and in most of the cases the function of the systems depends on contact
modeling process. Over the last decades, contact dynamics has been one of the most
challenging and demanding areas of research in engineering that play a crucial role in
© The Author(s), under exclusive license to Springer Nature Switzerland AG 2022
M. Pucheta et al. (Eds.): MuSMe 2021, MMS 110, pp. 77–84, 2022.
https://doi.org/10.1007/978-3-030-88751-3_8

78
P. Flores
vehicle systems, robotics, railway models, mechanisms and machinery, biomechanics,
granular systems, toys, just to mention some examples under the framework of multibody
systems [1–4].
Contact-impact events are complex phenomena characterized by short duration and
high forces that cause rapid changes or discontinuities in systems’ velocities and even-
tually energy dissipation [5]. The key ingredients of the modeling process of a frictional
contact problem include the several issues that can be condensed in two independent
steps, chieﬂy the determination of the contact points and the evaluation of the contact
forces/impulses [6]. The determination of the contact points focuses on the resolution
of two main issues: the geometric description of the contacting surfaces, and the detec-
tion of the potential contact points. In turn, the resolution task can be performed used
two main approaches in dynamical systems: the regularized approaches [7], and the
non-smooth models [8].
This work aims at analyzing the main aspects related to the modeling problem of
frictional contacts in multibody dynamics. The emphasis of the study in on the regular-
ized approaches and non-smooth formulations, where the fundamental issues associated
with each technique are highlighted when treating collisions. Discussion of the extensive
literature on computational schemes for contact detection is beyond the scope of this
study. Anyway, the evaluation of the geometry of contact and search for contact (contact
detection) is the same regardless of the choice of the technique utilized to handle the
contact interaction between the colliding bodies (contact resolution), being based on
regularized or non-smooth methods.
2
Techniques to Model Frictional Contacts
There are two main techniques to solve problems, namely the regularized approaches
(continuous methods) and the non-smooth formulations (piecewise methods). In the
former techniques, also known as compliance or elastic methods, the contacting bodies
are considered to be deformable at the contact zone, and the contact forces can be
expressed as a continuous function of the local deformation between the contacting
surfaces. In the non-smooth formulations, also called instantaneous or rigid methods,
the contacting bodies are assumed to be truly rigid, and the contact dynamics is resolved
by applying unilateral constraints in order to avoid the penetration from occurring.
The regularized approaches are quite important in the context of multibody dynam-
ics because of their good efﬁciency and extreme simplicity to be implemented. In some
circumstances, numerical problems can arise, resulting from bad conditioned system
matrices [9]. The transition between contact and non-contact situations can easily be
handled from the system conﬁguration and contact kinematics. With the regularized
methods, the contact forces include spring-damper elements to prevent interpenetration
from occurring. In the regularized approaches, the location of the contact point does not
coincide in the contacting bodies, and a large number of potential contact points exists,
being the actual contact point the one associated with the maximum indentation. The
pseudo-penetration plays a key role as it is utilized to calculate the contact forces accord-
ing to an appropriate constitutive law [10]. The existence of friction in the continuous
methods can easily be incorporated by considering any regularized friction model [11].

Modeling and Simulation of Frictional Contacts
79
Assuming that the contacting bodies are absolutely rigid, as opposed to locally
deformablebodies as intheregularizedapproaches, thenon-smoothformulations resolve
the contact problems using unilateral constraints to determine impulses to avoid pen-
etration from occurring. The central idea of the non-smooth formulations is the non-
penetration condition that prevents bodies from moving toward each other and not apart
[12]. A complementarity formulation is used to describe the relation between the contact
force and gap distance at the contact point. Such unilateral constraint does not permit the
interpenetration of the two colliding bodies, and ensures that either contact force or gap
distance is null. When the gap distance is positive (inactive contact), the corresponding
contact force is null. Conversely, when the contact force is positive (active contact), the
gap distance is null [13]. This formulation leads to a complementarity problem, which
constitutes the rule that permits to treat multibody systems with unilateral constraints
[14].
Figure 1 shows the graphical representation of the normal and tangential contact
forces for the regularized approaches and non-smooth formulations. The regularized
approaches and the non-smooth methods, utilized to handle contact-impact events under
the framework of multibody dynamics, have inevitably advantages and disadvantages.
None of these techniques can be identiﬁed as superior. In fact, a particular multibody
system with collisions might be easily described by one method, nevertheless, this does
not automatically implies a general predominance of that formulation in all multibody
applications.
(a)                     
(b)                                  (c)                
(d)
fn
δ
fn
ft
μfn
-μfn
ft
vt
μfn
-μfn
vt
δ
Fig. 1. (a) Regularized normal contact force model; (b) Non-smooth normal contact force model;
(c) Regularized tangential contact force model; (d) Non-smooth tangential contact force model
3
Regularized Methods for Contact Dynamics
The oldest contact force model is the one associated with Hooke’s theory, which can be
used when a contact is active. This regularized force model considers a linear spring to
mimic the contact interaction, and can be expressed as [10]
fn = kδ
(1)
where k represents the spring stiffness related to the contact materials, and δ is the
penetration between the contacting surfaces.

80
P. Flores
A more advanced contact force model was developed by Hertz, which considers a
nonlinear relation between force and penetration as [10]
fn = Kδn
(2)
where the nonlinear exponent, n, is typically equal to 3/2. The contact stiffness, K,
can be determined analytically as function of the material properties and geometry of
the contacting surfaces.
Hunt and Crossley presented a contact force model that associates as nonlinear spring
with a nonlinear damper in parallel to mimic the contact interaction. This force model
can be expressed as [15]
fn = Kδn

1 + 3(1 −cr)
2
˙δ
˙δ(−)

(3)
where the ﬁrst term is the nonlinear elastic Hertz’s law, and the second term is the
dissipative parcel, being cr the coefﬁcient of restitution, ˙δ represents the contact velocity,
and ˙δ(−) is the contact normal velocity at the initial instant of impact.
The most popular contact force model in the multibody dynamics community is the
one proposed by Lankarani and Nikravesh [5], which was developed with basis on the
hertzian contact theory and on the damping approach by Hunt and Crossley, and can be
is written as
fn = Kδn

1 + 3(1 −c2
r )
4
˙δ
˙δ(−)

(4)
in which is valid for collisions with high values of the coefﬁcient of restitution, that
is, this model is applicable to elastic impacts.
More recently, Flores et al. [16] described a contact force model applicable to the
entire domain of the possible values for the coefﬁcient of restitution, which is given by
fn = Kδn

1 + 8(1 −cr)
5cr
˙δ
˙δ(−)

(5)
Over the last decades, a good number of contact force models have been presented in
the literature, being the interested reader in speciﬁc information referred to the following
references [10].
The most well-known friction force model is undoubtedly the one represented by
Coulomb’s law, which can be expressed as [17]
ft =

≤μsfn
if vt = 0
μdfnsgn(vt)
if vt ̸= 0
(6)
sgn(vt) =

0
if ∥vt∥= 0
vt
∥vt∥
if ∥vt∦= 0
(7)
in which μs and μd represent the static and dynamic coefﬁcient of friction, respec-
tively, fn denotes the normal contact force, and vt is the relative contact tangential velocity
of the contacting elements.

Modeling and Simulation of Frictional Contacts
81
Threlfall [18] proposed a regularized friction force model that does not present
discontinuities, which can be written as
ft =
⎧
⎨
⎩
μdfn
	
1 −e−3vt
v0

sgn(vt)
if vt ≤v0
0.95μdfn
if vt > v0
(8)
where v0 is the threshold velocity.
Bengisu and Akay [19] presented an alternative friction force model as
ft =


−μsfn
v0 (∥vt∥−v0)2 + μsfn

sgn(vt)
if vt ≤v0

μdfn + (μsfn −μdfn)e−κ(∥vt∥−v0)
sgn(vt)
if vt > v0
(9)
where κ is a positive parameter representing the negative slope of the sliding state.
Ambrósio [20] proposed another regularized approach for the Coulomb’s law that
includes a ramp to avoid the numerical difﬁculties, which can be expressed as
ft = cdμdfnsgn(vt)
(10)
cd =
⎧
⎪⎨
⎪⎩
0
if vt < v0
vt−v0
v1−v0
if v0 ≤vt ≤v1
1
if vt > v1
(11)
in which the dynamic correction factor, cd, prevents that the friction force changes
direction for almost null values of the relative tangential velocity.
The use of the friction force models given by Eqs. (8), (9) and (10) has the advantage
of allowing the numerical stabilization of the integration algorithm used during the
resolution of the equations of motion for multibody systems. It must be noticed that
several alternative friction force models have been proposed over last decades, being the
interested readers referred to the following references [11].
4
Non-smooth Formulations for Contact Dynamics
The equations of motion suitable appropriate to describe multibody systems involving
impacts can be expressed at the velocity level as [8]
Mdu −hdt −wndPn −wtdPt = 0
(12)
where M is the positive deﬁnite and symmetric mass matrix, h represents the vector
of all external and gyroscopic forces acting on the system, wn and wt are the generalized
normal and tangential force directions. The measure for the velocities du = ˙udt +(u+ −
u−)dη is split in Lebesgue measurable part ˙udt, that is continuous, and the atomic parts,
which occur at the discontinuity points with the left and right limits u– and u+ and
the Dirac point measure dη. For impact free motion it holds that du = ˙udt. Similarly,
the measure for the so-called percussions corresponds to a Lagrangian multiplier which

82
P. Flores
gathers both ﬁnite contact forces, λ, and impulsive contact forces, , that is, dP =
λdt+dη [21].
Let consider a multibody system with a total f of unilateral constraints, which can
be represented by f inequalities as
gni(q, t) ≥0
(i = 1, . . . , f )
(13)
in which the quantities gni are the normal gap functions of the contacts. They are
formulated such that, gni > 0 indicates an inactive, gni = 0 corresponds to an active
contact, and gni < 0 indicates the forbidden interpenetration between rigid bodies.
The normal and tangential relative velocities at the contacts as [13]
γni = wT
niu + ˜wni
(14)
γti = wT
tiu + ˜wti
(15)
The equations of motion (12) can be complemented with constitutive laws for normal
and tangential contact-impact forces, for that, a unilateral version of the Newton’s impact
law is considered for the normal direction with local coefﬁcient of restitution εni. The
Coulomb’s friction law is used for the tangential direction with coefﬁcient of friction
μi, which is complemented by a tangential coefﬁcient of restitution εti. Normal and
tangential impact laws can be stated as inclusions
−dPni ∈Upr(ξni)
(16)
−dPti ∈μidPniSgn(ξti)
(17)
with
ξni := γ +
ni + εniγ −
ni
(18)
ξti := γ +
ti + εtiγ −
ti
(19)
The complete description of the dynamics of non-smooth system, which accounts
for both impact and impact-free phases, is given by Eqs. (12)−(19). This problem can
be solved by using the Moreau’s time-stepping method [13].
5
Demonstrative Example of Application
Figure 2 shows a hexapod system, which consists of one rigid, load carrying mainframe
with six legs, similar and symmetrically distributed. Each leg is composed by four links,
interconnected by four revolute joints and attached to the main body by means of a ﬁfth
revolute joint. Revolute motors and linear actuators accomplish traction movement and
elevation, respectively. Two representative virtual simulations are presented in order to
study the behavior of the movement characteristics of the proposed legged robot model.
In the ﬁrst simulation, a straight path on a planar, horizontal and non-rough surface

Modeling and Simulation of Frictional Contacts
83
is considered. The second one deals with climbing a standard set of stairs (height of
170 mm, deep of 280 mm). In the former simulation it was considered both static and
dynamic stability, while in the later only static stability was used to simulate the motion.
Figure 2 shows an animation sequence of the virtual simulation that corresponds to the
second situation.
Fig. 2. Snapshots of the hexapod robot system climbing a set of stairs
One crucial issue deals with the selection of the time step used to perform the
computational analysis, since it plays a key role in the contact detection and, hence, on
the contact-impact forces that can be artiﬁcially large and affect the outcomes. Secondly,
the identiﬁcation of the contact parameters, namely in terms of restitution and friction
coefﬁcients is also of paramount importance in order to properly handle the different
contact regimens and the transition between them.
6
Concluding Remarks
In this work, the problem of modeling frictional contact problems in dynamical sys-
tems was revisited. The regularized and non-smooth approaches were considered. A
hexapod system was used as a demonstrative example of application. It was clear the
contact dynamics is complex problem, requiring more research to reach better mod-
els and approaches. Future research can include the development of new algorithms to
deal with contact analysis and systems with contact transition regimens. Investigation
on parameters identiﬁcation and estimation, using the input date from physical exper-
iments to drive the simulation of uncertain model parameters will be also a potential
future direction for further research.
Acknowledgments. This work has been supported by FCT, under the national support to R&D
units grant, with the reference project UIDB/04436/2020 and UIDP/04436/2020.
References
1. Dong, H., Qiu, C., Prasad, D.K., Pan, Y., Dai, J., Chen, I.-M.: Enabling grasp action: general-
ized quality evaluation of grasp stability via contact stiffness from contact mechanics insight.
Mech. Mach. Theory 134, 625–644 (2019)

84
P. Flores
2. Marques,F.,Magalhães,H.,Pombo,J.,Ambrósio,J.,Flores,P.:Athree-dimensionalapproach
for contact detection between realistic wheel and rail surfaces for improved railway dynamic
analysis. Mech. Mach. Theory 149, 103825 (2020)
3. Pazouki, A., et al.: Compliant contact versus rigid contact: a comparison in the context of
granular dynamics. Phys. Rev. E 96(4), 042905 (2017)
4. Leine, R.I., Van Campen, D.H., Glocker, C.: Nonlinear dynamics and modeling of various
wooden toys with impact and friction. J. Vib. Control 9(1–2), 25–78 (2003)
5. Lankarani, H.M., Nikravesh, P.E.: A contact force model with hysteresis damping for impact
analysis of multibody systems. J. Mech. Des. 112(3), 369–376 (1990)
6. Machado, M., Flores, P., Ambrosio, J., Completo, A.: Inﬂuence of the contact model on the
dynamic response of the human knee joint. Proc. Inst. Mech. Eng. Part K J. Multi-body Dyn.
225(4), 344–358 (2011)
7. Khulief, Y.A.: Modeling of impact in multibody systems: an overview. J. Comput. Nonlinear
Dyn. 8(2), 021012 (2013)
8. Pfeiffer, F., Glocker, C.: Contacts in multibody systems. J. Appl. Math. Mech. 64(5), 773–782
(2000)
9. Klisch, T.: Contact mechanics in multibody dynamics. Mech. Mach. Theory 34(5), 665–675
(1999)
10. Alves, J., Peixinho, N., Da Silva, M.T., Flores, P., Lankarani, H.M.: A comparative study of
the viscoelastic constitutive models for frictionless contact interfaces in solids. Mech. Mach.
Theory 85, 172–188 (2015)
11. Marques, F., Flores, P., Pimenta Claro, J.C., Lankarani, H.M.: A survey and comparison
of several friction force models for dynamic analysis of multibody mechanical systems.
Nonlinear Dyn. 86(3), 1407–1443 (2016). https://doi.org/10.1007/s11071-016-2999-3
12. Pfeiffer, F.: The idea of complementarity in multibody dynamics. Arch. Appl. Mech. 72,
807–816 (2003)
13. Glocker, C., Studer, C.: Formulation and preparation for numerical evaluation of linear
complementarity systems in dynamics. Multibody Sys. Dyn. 13(4), 447–463 (2005)
14. Trinkle, J.C., Tzitzouris, J.A., Pang, J.S.: Dynamic multi-rigid-body systems with concurrent
distributed contacts. Philos. Trans. Math. Phys. Eng. Sci. 359(1789), 2575–2593 (2001)
15. Hunt, K.H., Crossley, F.R.E.: Coefﬁcient of restitution interpreted as damping in vibroimpact.
J. Appl. Mech. 42(2), 440–445 (1975)
16. Flores, P., Machado, M., Silva, M.T., Martins, J.M.: On the continuous contact force models
for soft materials in multibody dynamics. Multibody Sys. Dyn. 25, 357–375 (2011)
17. Coulomb, C.A.: The theory of simple machines. Mem. Math. Acad. Sic. 10, 161–331 (1785)
18. Threlfall, D.C.: The inclusion of Coulomb friction in mechanisms programs with particular
reference to DRAM. Mech. Mach. Theory 13, 475–483 (1978)
19. Bengisu, M.T., Akay, A.: Stability of friction-induced vibrations in multi-degree-of-freedom
systems. J. Sound Vib. 171, 557–570 (1994)
20. Ambrósio, J.A.C.: Impact of rigid and ﬂexible multibody systems: deformation description
and contact model. Virtual Nonlinear Multibody Syst. 103, 57–81 (2003)
21. Glocker, C.: On frictionless impact models in rigid-body systems. Philos. Trans. Math. Phys.
Eng. Sci. 359(1789), 2385–2404 (2001)

Modelling Spherical Joints in Multibody
Systems
Mariana Rodrigues da Silva1(B), Filipe Marques1, Miguel Tavares da Silva2,
and Paulo Flores1
1 CMEMS-UMinho, Departamento de Engenharia Mecânica, Universidade Do Minho, Campus
de Azurém, 4804-533 Guimarães, Portugal
{m.silva,fmarques,pflores}@dem.uminho.pt
2 IDMEC, Instituto Superior Técnico, Universidade de Lisboa, Av. Rovisco Pais, 1, 1049-001
Lisbon, Portugal
MiguelSilva@tecnico.ulisboa.pt
Abstract. Spherical joints are commonly utilized in many real-world scenarios.
From the more simplistic to the more complex perspectives, spherical joints might
be modelled considering different cases. Thus, the aim of this study is to ana-
lyze and compare the inﬂuence of different spherical joint modelling approaches,
namely the ideal, dry, lubricated, and bushing models, on the dynamic response of
multibody systems. Initially, the kinematic and dynamic aspects of the spherical
joint models are comprehensively reviewed. In this process, several approaches are
explored and studied considering the normal, tangential, lubrication and bushing
forces experienced by the multibody systems in such cases of spherical joints. The
application of the spherical joint models in the dynamic modeling and simulation
of the spatial four bar mechanism is investigated. From the results obtained, it can
be stated that the choice of the spherical joint model can signiﬁcantly affect the
dynamic response of mechanical multibody systems.
Keywords: Spherical joints · Dry joints · Lubricated joints · Bushing joints ·
Contact mechanics · Multibody dynamics
1
Introduction
Considering the type of applications in which they are designed to operate, spherical
joints may be characterized using different models. The simplest approach is to consider
the spherical joint as an ideal joint, that is, with no clearance between the socket and the
ball. However, in many applications there is clearance between these components. In
this case, the dynamics of the joint is controlled by contact-impact forces that develop on
the ball and socket and that result from their collision. In multibody systems, instead of
dealing with kinematic constraints as in the ideal joint, the spherical clearance joint deals
with force constraints. The contact-impact forces developed can signiﬁcantly affect the
dynamic response of the system [3].
One of the most commonly utilized solutions to avoid or reduce the contact within dry
clearance joints and to minimize the energy dissipation, is to add a lubricant ﬂuid in the
© The Author(s), under exclusive license to Springer Nature Switzerland AG 2022
M. Pucheta et al. (Eds.): MuSMe 2021, MMS 110, pp. 85–93, 2022.
https://doi.org/10.1007/978-3-030-88751-3_9

86
M. Rodrigues da Silva et al.
space between the socket and the ball, that is, in the clearance space. The high pressures
that develop in this ﬂuid act to keep the ball and the socket apart, preventing the contact
between these two components [4, 5]. In other applications, bushing elements may be
utilized. These are usually composed of elastomeric materials and are used to absorb
shocks and vibrations, handle misalignments, reduce noise and wear, and decrease the
transmissibility of irregularities to the system [1].
With this knowledge in perspective, the aim of this study is to analyze and compare
the inﬂuence of different spherical joint models on the dynamic response of multibody
systems. For this purpose, the kinematic and dynamic aspects of the ideal, dry, lubricated,
and bushing models are presented. In the aftermath of this process, the spatial four bar
mechanism is considered as a demonstrative example of application. This study provides
a simple and direct comparison between different methodologies that can be applied to
mechanical systems with spherical joints, allowing a better choice of the model to adopt
for speciﬁc applications.
2
Kinematics of Spherical Joints
This section includes a description of the formulations utilized in multibody systems to
model the kinematic aspects of spherical joints. Several cases are presented, namely the
ideal, dry, lubricated, and bushing joint models.
Ideal spherical joints allow the relative rotations between two adjacent bodies i and
j, constraining three relative translations. Consequently, the center of the ideal spherical
joint has constant coordinates with respect to any of the local coordinate systems of the
connected bodies. This means that point Pi on body i is coincident with point Pj on
body j. Points Pi and Pj represent the center of the socket and ball, respectively [2]. The
condition of the coincidence of points Pi and Pj is as follows:
(s,3) ≡rP
j −rP
i = rj + sP
j −ri −sP
i = 0
(1)
where rP
k represents the global position vector of point P located on body k, rk denotes the
position vector of the center of mass of body k described in global coordinates and sP
k is
the global position vector of point P located on body k with respect to local coordinates.
The velocity constraint equations for an ideal spherical joint are obtained by taking
the ﬁrst time derivative of Eq. (1), and can be expressed as [2]:
˙(s,3) = ˙rj + ˙sP
j −˙ri −˙sP
i = 0
(2)
in which the dot represents the derivative with respect to time.
Considering the following condition:
˙s = ˜ωs = −˜sω
(3)
where the symbol ~ represents the skew symmetric matrix and ω is the angular velocity,
then Eq. (2) can be rewritten as follows [2].
˙(s,3) = ˙rj −˜sP
j ωj −˙ri + ˜sP
i ωi = 0
(4)

Modelling Spherical Joints in Multibody Systems
87
In this sense, the time derivative of Eq. (4) yields the acceleration constraint equations
of the ideal spherical joint as follows [2]:
¨(s,3) = ¨rj −˜˙s
P
j ωj −˜sP
j ˙ωj −¨ri + ˜˙s
P
i ωi + ˜sP
i ˙ωi = 0
(5)
The multibody formulation for the case of ideal spherical joints was presented. How-
ever, in real-world application scenarios spherical joints present some level of clearance
between the socket and the ball. The condition of coincidence between point Pi and point
Pj assumed for the ideal joint case is disregarded in the case of the spherical clearance
joint. Thus, the three kinematic constraints shown in Eq. (1) are removed and the two
bodies are separated and free to move relative to one another. Contrary to the ideal joint
case, the spherical clearance joint does not constrain any degree of freedom from the
system [4, 5].
In a spherical clearance joint, a spherical part of body j, the ball, resides inside a
spherical part of body i, the socket. The radii of the socket and the ball are Ri and Rj,
respectively, and the difference between these parameters deﬁnes the size of the radial
clearance as [4, 5]:
c = Ri −Rj
(6)
The vector connecting point Pi to point Pj is deﬁned as the eccentricity vector, e,
which is obtained as:
e = rP
j −rP
i
(7)
The magnitude of the eccentricity vector is given by:
e =
√
eTe
(8)
and the time rate of change of the eccentricity in the radial direction, that is, in the
direction of the line of centers of the socket and the ball, is written as follows:
˙e = eT˙e
e
(9)
In spherical clearance joints, the situation in which the socket and the ball are con-
tacting with each other is identiﬁed by a relative pseudo-penetration δ. The geometric
condition for contact between the socket and the ball is deﬁned as:
δ = e−c
(10)
and the relative normal contact velocity, ˙δ, is given by:
˙δ =

˙rQ
j −˙rQ
i
T e
e
(11)
where Qi and Qj are the contact points on bodies i and j.
When the clearance joints are considered dry, normal and friction forces are the only
effects present when physical contact is detected between the surfaces. However, in most

88
M. Rodrigues da Silva et al.
mechanisms and machines, the joints are designed to operate with some lubricant ﬂuid
with the purpose of ensuring better performance of the mechanical systems by reducing
friction and wear, providing load-carrying capacity, and adding damping to dissipate
undesirable vibrations [4, 5]. In the case of a spherical joint with lubrication, the space
between the ball and the socket is ﬁlled with a lubricant. Under applied load, the ball
center is displaced from the socket center and the lubricant is forced into the clearance
space, provoking a buildup of pressure. The high pressures generated in this lubricant
ﬁlm act to keep the bodies apart. Lubricated joints are designed so that, even when the
maximal load is applied, the socket and the ball do not come in contact [5].
Bushing elements are utilized in many mechanical systems to absorb shocks and
vibrations, handle misalignments and decrease the transmissibility of irregularities to
the system [1]. The formulation utilized in this study closely follows the methodology
presented by Ambrósio and Veríssimo [1], in which the bushing element is modelled in
the multibody code as a nonlinear restrain that relates the relative displacements between
the bodies connected with the joint reaction forces.
The kinematic aspects of spherical clearance joints with lubrication and with bushing
elements are similar to those of the dry spherical joint.
3
Dynamics of Spherical Joints
This section includes a description of the formulations utilized in multibody systems to
model the dynamics of spherical joints. The normal, tangential, lubrication and bushing
force models are presented. These forces are introduced in the equations of motion of a
multibody system as external generalized forces.
Inthecaseof thedryspherical clearancemodel, thedynamics of thejoint is controlled
by contact-impact forces arising from the collision between the connected bodies. This
type of joint can, thus, be referred to as force joint, since it deals with force effects rather
than kinematic constraints [4, 5].
Within the scope of this study, the model developed by Lankarani and Nikravesh
[6] is analyzed. The authors proposed a continuous contact force model for the contact-
impact analysis of multibody systems using the general trend of Hertz contact law
incorporated with a hysteresis damping factor to include energy dissipation in terms of
internal damping. The contact force model is expressed as:
fn = Kδn

1 + 3(1 −c2
r )
4
˙δ
˙δ(−)

(12)
where K denotes the generalized stiffness parameter, δ is calculated by Eq. (10), n
represents the nonlinear exponent factor, cr is the restitution coefﬁcient, ˙δ(−) denotes the
initial contact velocity and ˙δ is obtained from Eq. (11).
In real-world applications of mechanical systems involving contacting surfaces with
relative motion, friction forces of complex nature might arise. Thus, a rigorous evaluation
of these forces is warranted to obtain an accurate modelling of the dynamic response of
the system. In the model proposed by Threlfall [7], the friction force and velocity are
related by an exponential function whose purpose is to address the numerical difﬁculties

Modelling Spherical Joints in Multibody Systems
89
associated with the discontinuity in Coulomb’s law. The model was the basis for other
friction force models, such as the continuous function expressed as:
ft = fc tanh
 vt
v1
vt
vt
(13)
where vt is the tangential velocity of the contact point, vt denotes the magnitude of the
tangential velocity, v1 represents the tolerance for the velocity and f c is the magnitude
of the Coulomb friction represented as follows:
fc = μkfn
(14)
in which μk is the kinetic coefﬁcient of friction and f n is the normal contact force.
Concerning lubricated spherical joints, the squeeze-ﬁlm and the wedge-ﬁlm actions
comprise the two main groups in which these joints can be categorized into. The squeeze-
ﬁlm action is associated with situations in which the ball does not rotate signiﬁcantly
about is center, but instead it moves along some path inside the socket boundaries. The
wedge-ﬁlm action refers to situations in which the ball has signiﬁcant rotation, which this
is usually observed in high-speed rotating machinery [5]. In this study, the squeeze-ﬁlm
action is considered.
The lubrication force due to squeeze-ﬁlm action developed between the socket and
the ball when there is lubricant ﬂuid between these two components can be modelled
using a law developed by Flores and Lankarani [2] as follows:
fl = 6πν˙eRi
(c/Ri)3
 1
ε3 ln(1 −ε) +
1
ε2(1 −ε) −1
2ε

(15)
where ν represents the dynamic lubricant viscosity, ˙e is given by Eq. (9), and ε denotes
the eccentricity ratio given by:
ε = e
c
(16)
where c and e are given by Eqs. (6) and (8), respectively.
For nonideal spherical joints, vector e given by Eq. (7) can be characterized as
the gap between the ball and the socket. However, this vector can be deﬁned as the
deformation of the elastomer in a spherical joint with a bushing element [1]. Considering
this statement, the force due to the bushing deformation adopted in this study is based
on the formulation developed by Ambrósio and Veríssimo [1], and it is represented by
the following condition:
fb =

k
	
δ + b˙δ

e
e
(17)
where k is the stiffness of the bushing element, δ denotes the bushing deformation and
b represents the stiffness proportional damping parameter.
As previously determined, the length of vector e is given by Eq. (8). Assuming that
no gap exists between the bushing element and the ball, then e = δ and, thus, the time
derivative of δ is given by Eq. (9).

90
M. Rodrigues da Silva et al.
4
Demonstrative Example of Application
The objective of this section is to examine the inﬂuence of the different cases for mod-
elling spherical joints on the dynamic response and behavior of multibody systems. To
this end, a spatial four-bar mechanism is utilized.
The spatial four-bar mechanism is composed by four rigid bodies, namely the ground,
crank, coupler, and rocker. The numbers of each body and their corresponding local
coordinate systems are shown in Fig. 1.
η1 η2
ζ2
ζ1
≡
Rocker
Ground
Coupler
Crank
0.085
0.040
x
y
z
0.020
ξ2
ξ3
ξ4
ζ4
η4
η3
ζ3
ξ1
≡
≡
Fig. 1. Schematic representation of the spatial four-bar mechanism
The bodies of the spatial four bar mechanism are kinematically connected to each
other by means of two revolute joints, connecting the ground to the crank and the ground
to the rocker, and two spherical joints, connecting the crank to the coupler and the coupler
to the rocker. Clearance and bushing are introduced in the spherical joint connecting the
coupler and the rocker to analyze the dry, lubricated, and bushing models. The remaining
joints are considered ideal.
The initial conﬁguration of the spatial four-bar mechanism is presented in Fig. 1 and
the corresponding initial values are presented in Table 1. The system is released from the
initial position with null velocities and under the action of gravitational force, acting on
the negative z-direction. For the nonideal joint models, initially the ball and the socket
of the spherical clearance joint are concentric.
Table 1. Initial conﬁguration of the spatial four-bar mechanism
Body Nr
x [m]
y [m]
z [m]
e0
e1
e2
e3
2
0.00000
0.00000
0.00000
1.0000
0.0000
0.0000
0.0000
3
−0.03746
−0.04250
0.04262
0.9186
−0.1764
0.06747
−0.3472
4
−0.05746
−0.08500
0.03262
0.3634
−0.6066
−0.6066
0.3634
The dimensions and inertial properties of each body of the spatial four bar mechanism
are presented in Table 2.

Modelling Spherical Joints in Multibody Systems
91
Table 2. Dimensions and inertial properties of the spatial four-bar mechanism
Body Nr
Length [m]
Mass [kg]
Moment of inertia [kgm2]
Iζζ
Iηη
Iζζ
2
0.02
0.0196
0.0000392
0.0000197
0.0000197
3
0.122
0.1416
0.0017743
0.0000351
0.0017743
4
0.074
0.0316
0.0001456
0.0000029
0.0001456
The simulation parameters used in all dynamic simulations and in the numerical
methods required to solve the dynamics of the system are displayed in Table 3.
Table 3. Common and speciﬁc simulation parameters for the four-bar mechanism
Common
Baumgarte
coefﬁcient, α
5
Reporting time step
0.00001s
Baumgarte
coefﬁcient, β
5
Integration tolerance
10–10
Integrator
algorithm
ode15s
Simulation time
2 s
Dry Model
Young’s modulus,
E
207 GPa
Velocity tolerance, v1
0.0010 m/s
Poisson’s ratio, v
0.3
Kinetic coefﬁcient of
friction, μk
0.1
Nonlinear
exponent, n
1.5
Socket radius, Ri
10 mm
Restitution Coefﬁcient, cr
0.9
Ball radius, Rj
9.9 mm
Lubricated Model
Dynamic lubricant viscosity, ν – 400 cP
Bushing Model
Bushing stiffness, k - 2.146 × 107 N/m
Stiffness proportional damping, b - 0.01
The results obtained for the spherical joint models studied are shown in Fig. 2.
It can be observed that the dynamic performance of the four-bar mechanism is
signiﬁcantly affected by the model chosen to characterize the spherical joint. In general,
the frictionless joint model, exhibits more oscillations and produces signiﬁcantly larger
velocities and accelerations than the other models, suggesting that the response of the
system becomes chaotic. In fact, the addition of friction to the dry spherical clearance
joint tends to smooth the behavior of the system, leading to a less chaotic behavior. The

92
M. Rodrigues da Silva et al.
Fig. 2. Inﬂuence of the spherical joint model on the response of the spatial four-bar mechanism.
a) Position, b) velocity, c) acceleration of the rocker and d) mechanical energy of the system.
observation of Fig. 2 (c) also indicates that the spatial four-bar mechanism produces
signiﬁcantly lower accelerations with the ideal joint model when compared to the other
models. Concerning the variation of the mechanical energy, the model with friction
presents higher energy dissipation, followed by the frictionless and lubricated models,
as observed in Fig. 2 (d). As expected, the bushing model produces positions, velocities
and accelerations close to the ideal joint case, which means that the bushing element
is, in fact, decreasing the noise associated with clearance and stabilizing the system,
making it less chaotic. This model dissipates the least amount of energy comparing to
the others.
5
Conclusions
The dynamic modeling and analysis of spatial mechanisms with different models for
spherical joints has been presented in this work. The main kinematic and dynamic aspects
related to these models were described under the framework of multibody systems
methodologies. A classic spatial four bar mechanism was considered as a demonstrative
application example to study the effect of the joint modeling approaches. Overall, the
joint models strongly affect the performance of the system, essentially visible in terms
of accelerations and mechanical energy.

Modelling Spherical Joints in Multibody Systems
93
Acknowledgments. This work has been supported by Portuguese Foundation for Science
and Technology, under the national support to R&D units grant, with the reference project
UIDB/04436/2020 and UIDP/04436/2020, as well as through IDMEC, under LAETA, project
UIDB/50022/2020.
References
1. Ambrósio, J., Verissimo, P.: Improved bushing models for general multibody systems and
vehicle dynamics. Multibody Sys.Dyn. 22, 341–365 (2009). https://doi.org/10.1007/s11044-
009-9161-7
2. Flores, P.: Concepts and Formulations for Spatial Multibody Dynamics. Springer, Heidelberg
(2015). https://doi.org/10.1007/978-3-319-16190-7
3. Flores, P., Ambrósio, J., Pimenta Claro, J.C., Lankarani, H.M.: Dynamics of multibody systems
with spherical clearance joints. ASME J. Comput. Nonlinear Dyn. 1, 240–247 (2006). https://
doi.org/10.1115/1.2198877
4. Flores, P., Ambrósio, P., Pimenta Claro, J.C., Lankarani, H.M.: Kinematics and Dynamics of
Multibody Systems with Imperfect Joints - Models and Case Studies. Springer, Heidelberg
(2008). https://doi.org/10.1007/978-3-540-74361-3
5. Flores,P.,Lankarani,H.M.:Spatialrigid-multibodysystemswithlubricatedsphericalclearance
joints: modeling and simulation. Nonlinear Dyn. 60, 99–114 (2010). https://doi.org/10.1007/
s11071-009-9583-z
6. Lankarani, H.M., Nikravesh, P.E.: A contact force model with hysteresis damping for impact
analysis of multibody systems. J. Mech. Des. 112, 369–376 (1990). https://doi.org/10.1115/1.
2912617
7. Threlfall, D.C.: The inclusion of Coulomb friction in mechanisms programs with particular
reference to DRAM au programme DRAM. Mech. Mach. Theory 13, 475–483 (1978). https://
doi.org/10.1016/0094-114X(78)90020-4

Multibody Dynamics Modeling of Delta
Robot with Experimental Validation
Mohamed Elshami, Mohamed Shehata(B), Qingshun Bai, and Xuezeng Zhao
Harbin Institute of Technology, Harbin, China
{mohamed elshami,qshbai,zhaoxz}@hit.edu.cn,
mohamed.saleh@stu.hit.edu.cn
Abstract. Delta robot is one of the most known parallel systems which
possesses high stiﬀness and accuracy. In order to build a system that
endows the robot to perform the desired tasks, an accurate and vali-
date the dynamic model is required. In recent years, researchers have
been focused on the construction of serial structured robots. However,
few researchers tried to evolve the delta robots in such a system. In this
work, the multibody system dynamics (MBS) approach is used to study
the kinematics and dynamics of delta robots. A systematic approach is
developed based on load assumption due to end-eﬀector movements. The
multibody model is constructed using Matlab Symbolic Toolbox. More-
over, D3S-800 is utilized in this study to validate the multibody model.
The comparison of experimental data and numerical solution shows a
very good agreement and consequently, the multibody model obtained
is suitable for parameter identiﬁcation, control and design optimization
of a delta robot system.
Keywords: Multibody system dynamics · Delta robot · Matlab
symbolic toolbox · Euler parameters
1
Introduction
Robot structures possess a good variety of architectural designs adapted to the
diﬀerent industrial and non-industrial operations. While serial manipulators are
the most common dominant type of robots in the industry because of their
high ﬂexibility. The parallel structured robots provide a good solution to some
inconvenient situations of the serial manipulators, such as the situations where
the robot is required to resist high loads [10].
Delta robot is one common conﬁguration of parallel robots and what makes
the delta robot fascinating is that unlike most of robotic applications which
are biologically inspired [14]. Delta robot perception was a mechanical structure
design that depended completely on the theory of machines and the correlated
relation between the mechanical linkages [5]. Recently, researchers made a lot of
eﬀort into modeling, design and control of delta robots using traditional dynam-
ics methods [6,8]. On the other hand, the multibody system serves as a basis for
c
⃝The Author(s), under exclusive license to Springer Nature Switzerland AG 2022
M. Pucheta et al. (Eds.): MuSMe 2021, MMS 110, pp. 94–102, 2022.
https://doi.org/10.1007/978-3-030-88751-3_10

Multibody Dynamics Modeling of Delta Robot with Experimental Validation
95
many modern models of complex systems and has been applied in many areas
of science. The multibody system approach will be used for the dynamic model-
ing of delta robot in order to increase the eﬃciency of the system and enhance
system control [2]. Also, the multibody model results were veriﬁed using actual
delta robot system.
The remainder of this study is organized as follows: Sect. 2 introduces the
delta robot as a multibody system. In Sect. 3, the constraint’s function is
expressed, and the model is constructed. Section 4 presents numerical simula-
tion and experimental validation that are followed by the conclusion in Sect. 5.
2
Delta Robot as a Multibody System
In this study, D3S-800 delta robot used, in which The robot has three degrees
of freedom, the end-eﬀector is free to move in three translational motions along
XYZ axes, see Fig. 1. In addition, The manipulator can achieve rotational motion
about Z-axis by means of an actuator installed to the ﬁxed base and the rota-
tional motion is transmitted mechanically to the end-eﬀector [3]. The compu-
tational model is established to determine the kinematic relationship between
the system coordinates. We apply the MBS mathematical calculation process to
the incremental robot mechanism and for simpliﬁcation, the rotational degree
of freedom about Z-axis is not considered. Delta robot as a multibody system
consists of a ﬁxed base, three arms, six forearms, six rods and an end-eﬀector.
To deﬁne system bodies, local frames are assigned to delta robot bodies and the
base frame is considered the reference coordinate. For simplicity of the compu-
tations, the global frame is assigned to the projection of the ﬁxed platform in
the same plane enclosing the three points ai, which are the positions of revolute
joints between the base frame and the active arms [13]. Each single chain shown
in Fig. 1b consists of a revolute joint directly actuated by means of an electri-
cal motor. The forearms or the passive arms are connected to the active arms
at points bi1 and bi2, the above two points are connected to the movable plat-
form in points ci2 and ci1 forming the closed loop bi1, bi2, ci2 and ci1. Another
closed-loop si1, si2, ti2 and ti1 formed by the connecting rods which functions
are to maintain the connectivity of the spherical joints and to prevent the fore-
arms from the undesired rotations about their longitudinal axis. At the initial
home position, an end-eﬀector frame is collinear with the Z-axis of the reference
coordinate.

96
M. Elshami et al.
(a) CAD Model of delta robot system
(b) Parameters assignment of a general chain
Fig. 1. Multibody model of delta robot system
3
Mathematical Model of Delta Robot
The model of the delta robot shown in Fig. 1a, can be constructed, without loss
of generality, as shown in Table 1 for the ﬁrst chain. Let the contact point P
be located on the end-eﬀector frame. The system of generalized coordinates is
denoted by q and can deﬁne function in Euler angles φ, θ and ψ [4]. To avoid a
singularity during simulation, the three Euler angles will convert to four Euler
parameters [q1
0 q1
1 q1
2 q1
3] [12]. The generalized coordinates of the ﬁxed base
including translation and orientation are deﬁned as:
q1 =

x1 y1 z1 q1
0 q1
1 q1
2 q1
3

(1)
The global portion vector of that point can be expressed as:
ri = Ri + Ai ¯ui
p
(2)
Table 1. Components of Delta robot system
Joint number Joint type Body(i)
Body(j)
1
Fixed
Fixed Base Ground
2
Revolute
Arm
Fixed Base
3
Spherical
Forearam1
Arm
4
Revolute
Rod1
Forearam1
5
Revolute
Forearam2
Rod1
6
Revolute
Rod2
Forearam2
7
Spherical
Forearam1
End-eﬀector

Multibody Dynamics Modeling of Delta Robot with Experimental Validation
97
where ri, is the global position of an arbitrary point, Ri, is the global position
of the origin of the end-eﬀector coordinate system, and Ai is the transformation
matrix function on the generalized coordinates. It is clear from Eq. (2) that the
global position vector of an arbitrary point on the body coordinate system can
be written in terms of the rotational coordinate of the body, as well as the
translation of the frame-origin of the body. In order to avoid singularities, Euler
parameters are used to describe the orientation of the system bodies and result
coordinates can be converted back to cartesian coordinates [11]. The constraints
function of delta robot can be obtained using multibody constraints equation of
Rigid, Revolute and Spherical joints. Equation 3 illustrates constraints equations
of rigid joint between ﬁxed base and ground.
C1
(qg,q1,t) =
⎡
⎢⎢⎢⎢⎢⎢⎢⎢⎣
x1
y1
z1
1 −2(q1
2)2 −2q1
0q1
2 −2q1
1q1
3 −2(q1
1)2
2(q1
1)2 + 2(q1
2)2 −2q1
0q1
2 −2q1
1q1
3 −1
2(q1
1)2 + 2(q1
2)2 −2q1
0q1
2 −2q1
1q1
3 −1
(q1
0)2 + (q1
1)2 + (q1
2)2 + (q1
3)2 −1
⎤
⎥⎥⎥⎥⎥⎥⎥⎥⎦
= 0
(3)
where qg is generalized coordinate vector for ground and it equal zero and
q1 is generalized coordinate vector of the ﬁxed base. Figure 2a shows revolute
joint between Arm1 and ﬁxed base. The constraints equations of revolute joints
between Arm1 and ﬁxed base can be written as:
C2
(q1,q2,t) =
⎡
⎢⎢⎢⎢⎢⎢⎣
x1 −x2
y1 −y2
z1 −z2
1 −2(q1
2)2 −2q1
0q1
2 −2q1
1q1
3 −2(q1
1)2
2(q1
1)2 + 2(q1
2)2 −2q1
0q1
2 −2q1
1q1
3 −1
(q2
0)2 + (q2
1)2 + (q2
2)2 + (q2
3)2 −1
⎤
⎥⎥⎥⎥⎥⎥⎦
= 0
(4)
(a) Revolute joint
(b) Spherical joint
Fig. 2. Multibody joint constraints

98
M. Elshami et al.
where generalized coordinates of Arm1 is deﬁne as q2 = [x2 y2 z2 q2
0 q2
1 q2
2 q2
3].
Figure 2b shows spherical joint between the forearm and end-eﬀector. The con-
straints equation of spherical joints between Forearam1 and Arm can be written
function on translation constraints as:
C3
(q2,q3,t) =
⎡
⎣
x2 −x3
y2 −y3
z2 −z3
⎤
⎦= 0
(5)
Constraints equations for other joints can be deﬁned similarly to spherical and
revolute joints. The dynamic equations that govern the motion of system bodies
can be systematically obtained using Lagrange formulation as [1]:

 M CT
q
Cq 0
 
 ¨q
λ

=

 Q
Qd

(6)
where M is the system mass matrix, Cq is the system Jacobian matrix Cq =
∂C(q,t)
∂q
, λ the vector of Lagrange multipliers and Qd is a vector absorb terms
that are quadratic in the velocity and Q is a vector of external applied forces
and can be written as:
Q =

Qi
exR
Qi
exθ

=

F i
GiT M i

=

F i
¯GiT ¯
M i

(7)
where Qi
exR is the force associated with the translation coordinates and Qi
exθ is
the force associated with the orientation coordinates. F i and ¯
M i are the forces
and moment vectors deﬁned in the local coordinate system of the body. The
matrix ¯Gi is deﬁne function on Euler parameter generalized coordinates and
can be written as:
¯Gi = 2 ∗
⎡
⎣
−q1 q0
q3 −q2
−q2 −q3 q0
q1
−q3 q2 −q1 q0
⎤
⎦
(8)
Equation of motion Eq. 6 yields a system of diﬀerential algebraic equations [7]. A
set of initial parameters including positions and velocities from the CAD model
are used to start the dynamic simulation [4]. The vector ¨q can be integrated in
order to determine the coordinates and velocities. The vector λ can be used to
determine the generalized reaction forces that can be used to establish optimiza-
tion of the design process. Because the direct numerical solution of diﬀerential
algebraic equations associated with the constrained dynamics of a multibody
system poses several computational diﬃculties, a post-stabilization process is
used to brings the solution back to the invariant manifold.
4
Numerical Simulation and Experimental Validation
In this section, Multibody model results are represented and compared with
experimental data. A mathematical model of the delta robot is developed

Multibody Dynamics Modeling of Delta Robot with Experimental Validation
99
by applying multibody dynamics theory based on the Lagrange formulation
described in the previous section. Kinematics results include system displace-
ments and dynamic results included reaction forces and torques acting on delta
robot bodies are computed. The parameters of the D3S-800 delta system are pro-
vided in Table 2. The ﬁxed base radius is the radius of a circle that passes through
the three points of the revolute joints of arms, while the radius of the movable
platform that carries end-eﬀector is the radius of a circle that passes through the
six points of the lower spherical joints between the platform and the forearms.
By applying an initial motion of 100 mm/s with 45◦in XY-plane on the end-
eﬀector and keep the distance between the ﬁxed frame and end-eﬀector frame
847 mm in the negative Z direction, the corresponding structural displacement of
the delta robot links can be obtained. The simulation is performed using Matlab
and Adams-Bashforth-Moulton (ODE113) as the numerical integrator for 5 s.
Figure 3a shows the constraints violation due to the revolute joint between the
arm and ﬁxed base [9]. The violation does not exceed 3 ∗10−13 which indicates
the computational eﬃciency of the multibody system model. Noted that, the
constraint equation C6 is an Euler parameter constraint that must be added
in case of using Euler parameter to deﬁne system generalized coordinates. By
integrating the system accelerations forward, the system bodies velocities and
conﬁgurations are computed. According to initial input, the end-eﬀector dis-
placement in XY-plane and the distances in Z-direction constant, see Fig. 3b.
Reactions forces acting on deferent bodies of delta robot system are computed
from the MBS model as a function of generalized coordinates using Lagrange
multipliers. Figures 4 show reaction forces acting on a ﬁxed base including trans-
lation forces and moments. As shown in Fig. 4a, the reaction force in Z-direction
is due to the wight. Likewise, other system body’s reaction forces can be com-
puted. Experimental work is carried out in order to validate the dynamic model
of the delta robot. As shown in Fig. 5, the D3S-800 delta robot system consists
of robot arms, motors, control unite, encoder and programming unite. Figure 6
shows the comparisons between the output rotor velocity of the MBS model and
the experimental data. Since the multibody model and experiment data have
similar results, the MBS model is accurate and can be useful for establishing the
optimization process of delta robot system design and control.
Table 2. Delta robot parameters employed in the numerical simulation
Components
Dimensions (mm)
Mass (kg)
Ixx(Kg · m2) Iyy(Kg · m2) Izz(Kg · m2)
Fixed base
R = 125
30
0.52202
0.52202
0.88497
Arm
L = 370
6.2
0.00510
0.12448
0.125448
Forearm
L = 960
1.65
0.13940
0.00006
0.13940
Connecting rod
L = 95
0.2
0.0000147
0.000101
0.000101
End-eﬀector
r = 62
0.9
0.001031
0.001031
0.002019

100
M. Elshami et al.
Fig. 3. Constraints violation and global position of the point P
Fig. 4. Reaction forces due to revolute joint
Fig. 5. D3S-800 delta robot system

Multibody Dynamics Modeling of Delta Robot with Experimental Validation
101
0
0.5
1
1.5
2
2.5
3
3.5
4
4.5
5
Time [sec] 
-15
-14
-13
-12
-11
-10
-9
-8
-7
-6
-5
Angular Velocity[deg/sec]
MBS model
Expermintal data
Fig. 6. Angular speed of motor 1
5
Conclusion
In this paper, an eﬃcient modeling procedure for the delta robot system is devel-
oped based on Multibody system dynamics. The symbolic and computational
work have been carried out using Matlab. The symbolic derivation is carried
out and the explicit equations of motion of the delta robot have been derived.
The solution of the equations of motion involves the system coordinates and the
associated Lagrange multipliers as well. The paper describes an experimental
test-rig of the D3S-800 delta robot system in front of end-eﬀector movement
and the measured motors speed is collected and compared with the multibody
model. The comparison shows a very good agreement which encourages the
enhancement of the model by examining unconventional operating conditions.
Moreover, Lagrange multipliers can be used to estimate the generalized reaction
forces which can be utilized in the optimization of delta robot design. In going
and future work, multibody model will be used for parameters identiﬁcation and
design optimization of the delta robot.
Acknowledgement. This research was supported by National Natural Science Foun-
dation of China (Grant No.71175102 and 52075129).
References
1. Bai, Q., Shehata, M., Nada, A.: Eﬃcient modeling procedure of novel grating tiling
device using multibody system approach. In: Pucheta, M., Cardona, A., Preidik-
man, S., Hecker, R. (eds.) MuSMe 2021. MMS, vol. 94, pp. 168–176. Springer,
Cham (2021). https://doi.org/10.1007/978-3-030-60372-4 19
2. Barreto, J.P., Corves, B.: Matching the free-vibration response of a delta robot with
pick-and-place tasks using multi-body simulation. In: 2018 IEEE 14th International
Conference on Automation Science and Engineering (CASE), pp. 1487–1492. IEEE
(2018)
3. Chang, Z., Ali, R.A., Ren, P., Zhang, G., Wu, P.: Dynamics and vibration analysis
of delta robot. In: 5th International Conference on Information Engineering for
Mechanics and Materials, pp. 1408–1417. Atlantis Press (2015)

102
M. Elshami et al.
4. Flores, P.: Concepts and Formulations for Spatial Multibody Dynamics. Springer,
Heidelberg (2015)
5. Fumagalli, A., Masarati, P.: Real-time inverse dynamics control of parallel manip-
ulators using general-purpose multibody software. Multibody Syst. Dyn. 22(1),
47–68 (2009)
6. Hamdoun, O., Bakkali, L.E., Baghli, F.Z.: Analysis and optimum kinematic
design of a parallel robot. Procedia Eng. 181, 214–220 (2017). https://doi.org/
10.1016/j.proeng.2017.02.374. https://www.sciencedirect.com/science/article/pii/
S1877705817309578. 10th International Conference Interdisciplinarity in Engineer-
ing, INTER-ENG 2016, Tirgu Mures, Romania, 6–7 October 2016
7. Kunkel, P., Mehrmann, V.: Diﬀerential-Algebraic Equations: Analysis and Numer-
ical Solution, vol. 2. European Mathematical Society (2006) https://doi.org/10.
1016/j.proeng.2017.02.374. URL https://www.sciencedirect.com/science/article/
pii/S1877705817309578
8. Lenarcic, J., Wenger, P.: Advances in Robot Kinematics: Analysis and Design.
Springer, Heidelberg (2008)
9. Marques, F., Souto, A.P., Flores, P.: On the constraints violation in forward dynam-
ics of multibody systems. Multibody Syst. Dyn. 39(4), 385–419 (2016). https://
doi.org/10.1007/s11044-016-9530-y
10. Merlet, J.P.: Parallel Robots, vol. 128. Springer, Heidelberg (2005)
11. Pappalardo, C.M., Guida, D.: On the use of two-dimensional Euler parameters
for the dynamic simulation of planar rigid multibody systems. Arch. Appl. Mech.
87(10), 1647–1665 (2017)
12. Shabana, A.A.: Euler parameters kinetic singularity. Proc. Inst. Mech. Eng. Part
K: J. Multi-body Dyn. 228(3), 307–313 (2014)
13. Stock, M., Miller, K.: Optimal kinematic design of spatial parallel manipulators:
application to linear delta robot. J. Mech. Des. 125(2), 292–301 (2003)
14. Yang, X., Feng, Z., Liu, C., Ren, X.: A geometric method for kinematics of delta
robot and its path tracking control. In: 2014 14th International Conference on
Control, Automation and Systems (ICCAS 2014), pp. 509–514. IEEE (2014)

Railway and Vehicle Dynamics

Railway Dynamics with Curved Contact Patch
Filipe Marques1(B), Hugo Magalhães2,3, João Pombo2,3, Jorge Ambrósio3,
and Paulo Flores1
1 CMEMS-UMinho, Departamento de Engenharia Mecânica, Universidade do Minho, Campus
de Azurém, 4804-533 Guimarães, Portugal
{fmarques,pflores}@dem.uminho.pt
2 Institute of Railway Research, School of Computing and Engineering,
University of Huddersﬁeld, Huddersﬁeld, UK
{h.magalhaes,j.pombo}@hud.ac.uk
3 IDMEC, Instituto Superior Técnico, Universidade de Lisboa, Av. Rovisco Pais, 1,
1049-001 Lisbon, Portugal
jorge.ambrosio@tecnico.ulisboa.pt
Abstract. The wheel-rail contact modeling is of paramount importance for the
dynamics of railway vehicles since it represents the interaction between the vehi-
cle and the track. Although, in most cases, the contact generated occurs between
convex surfaces which results in planar contact areas, the contact might take place
in concave surfaces when negotiation sharp curves or due to the wear of pro-
ﬁles. In that cases, the resulting contact area is not planar. This work proposes
a methodology to determine the shape of the contact patch in a curved surface,
where the normal direction varies along its lateral direction. This method is based
on a semi-Hertzian approach and discretizes the contact into longitudinal strips.
The normal pressure distribution is computed in each strip separately using a
non-Hertzian contact model and it is summed in a vector form to obtain the total
normal force magnitude. Regarding the tangential forces, a look up table approach
is considered. Finally, a trailer vehicle negotiating a curve is used to demonstrate
the effectiveness of this methodology.
Keywords: Railway dynamics · Contact forces · Conformal contact ·
Non-Hertzian
1
Introduction
The utilization of multibody systems methodologies to model the dynamic behavior of
railway vehicles has been gaining relevance in their design and development [1]. In that
sense, the wheel-rail contact interaction plays a preponderant role since it represents
the interface between vehicles and track system. The accurate modeling of the wheel-
rail contact is fundamental to analyze the dynamic response of the vehicle, in terms of
comfort and safety, for any running conditions, requiring taking into account several
complex phenomena that occur during contact [2].
Most of the wheel-rail contact force models available in the literature are limited
to their application in planar contact patches, i.e., non-conformal contact cases, or even
© The Author(s), under exclusive license to Springer Nature Switzerland AG 2022
M. Pucheta et al. (Eds.): MuSMe 2021, MMS 110, pp. 105–113, 2022.
https://doi.org/10.1007/978-3-030-88751-3_11

106
F. Marques et al.
to point contact simpliﬁcation [3, 4]. Although the planar contact assumption covers
most of the possible interaction scenarios, in which the rail interacts directly with the
tread or ﬂange, when negotiating sharp curves or due to worn proﬁles, the conformal
contact tends to occur in the running proﬁle ﬁllet zone. The common methods of contact
search tend to fail in ﬁnding a unique solution in a con-formal case, either using elastic
or constraint approach.
In this work, a methodology to consider a curved contact between wheel and rail
elements is proposed. In the case of interaction between a convex body and a concave
body, under the assumption of rigid bodies, an interpenetration region exists, and the
effective contact area is smaller due to the elastic deformation of the surfaces. However,
in the conformal case, the resultant contact patch tends to have a curved shape [5].
2
Curved Wheel-Rail Contact Model
In the context of the presented methodology, wheels and rails are mathematically rep-
resented by parametrized surfaces, i.e., the location of any point on each of surface can
be deﬁned by two parameters. The surface of each rail is obtained through the sweep
of its cross-section along a given path, which is represented by a set of nodal points
and interpolated with a suitable spline. These nodal points deﬁne the position and ori-
entation of the rail as function its arc length, sr. Then, the rail proﬁle is represented
by a two-dimensional function, in which the proﬁle vertical coordinate f r is deﬁned as
a function of the surface parameter that deﬁnes the lateral rail coordinate, ur. In turn,
since the wheelset is a body of revolution, the wheel surface can be deﬁned by the
rotation of its cross-section about its own axis. Thus, any point in the wheel surface
is characterized by an angular position and a lateral coordinate. Similar to the rail, the
wheel proﬁle is represented by a two-dimensional function, in which the wheel vertical
coordinate, f w, is dependent on the proﬁle lateral position. The schematic representation
of this parametrization of the wheel and rail surfaces is given in Fig. 1, in which the
superscripts ‘L’ and ‘R’ denote the left and right elements, respectively.
The half-space approach is widely employed in the development of most wheel-rail
contact theories, for which the only exception is when using the ﬁnite element method
that is computationally intensive. This concept involves several assumptions, namely (i)
the characteristic sizes of the contacting bodies are large compared to the size of the
contact patch; (ii) the materials are homogeneous, isotropic and linearly elastic, and (iii)
the strains are small, and the inertia effects can be neglected [6]. Having in mind that
the size of the contact patch tends to increase due to the conformality between surfaces,
the ﬁrst assumption can be violated. However, the elastic half-space assumption can be
kept since it is valid for smaller variations of the contact angle, as it is considered here.
The procedure proposed is here to compute the shape of a curved patch is illustrated
in Fig. 2, in which the contact dimension is exaggerated for sake of understandability.
The ﬁrst step consists of identifying the interpenetration region which limits are
obtained with the methodology provided in [3] and denoted by uw,lower and uw,upper for
the wheel lateral parameter, and by ur,lower and ur,upper for the rail lateral parameter.
Since the patch is not ﬂat, there is no preferential direction, therefore, the proﬁles must
be parametrized according to their arc length. The wheel potential contact points can

Railway Dynamics with Curved Contact Patch
107
L
rs
L
ru
L
rf
y
z
x
L
w
s
R
w
s
L
w
u
R
w
u
R
wf
L
wf
ws
ξ
ws
ζ
ws
η
R
rs
R
rf
R
ru
Fig. 1. Schematic representation of the wheel and rail surfaces parametrization
be represented by a three-dimensional curve and the angular parameter, sw, is given
as function of the lateral parameter and yaw angle, α. Hence, to perform this length’s
parametrization, the wheel has to be projected into the rail proﬁle plane, since the rail is
considered an extruded body. This strategy transforms the identiﬁcation of the contact
patch in a two-dimensional problem, which simpliﬁes the process of evaluation the pen-
etration over the patch. Hence, after some mathematical manipulation, the expressions
to obtain the arc length for rail and the wheel interpenetration region are
Lr(ur) =
 ur
ur,lower

1 + f ′r dur
(1)
Lw(uw) =
 uw
uw,lower



−sin2α

f ′4
w + 2fwf ′2
w f ′′
w + 2f ′2
w + 2fwf ′′
w

+ cos2α
+ f ′2
w + tan2αf 2
wf ′′2
w
	 tan2αf ′2
w
1−tan2αf ′2
w + sin2α

 duw
(2)
It must be noticed that the rail’s arc length just depends on the proﬁle shape and
the boundaries of the interpenetration region, while the wheel’s arc length also depends
on the yaw angle and, therefore, requires its identiﬁcation for each wheel-rail conﬁg-
uration. Then, both proﬁles are discretized in NS equally sized spaces, as schematized

108
F. Marques et al.
Wheel
Rail
Δ
w
L
Δ
rL
(a)
(b)
Wheel
Rail
( )
rn s
( )
r
t s
s
Δs
s
y
s
x
(
)
s,
s,
,
i
i
x
y
(c)
(d)
s
cp
δ
( )
rn
is
( )
r
t
is
s
(
)
w,
,
i
i
s n
( )
cp
i
δ
s
(
)
r,
,
i
i
s n
(e)
(f)
Fig. 2. Deﬁnition of the penetration along the interference region in the wheel lateral direction
for conformal contacts: (a) interaction of wheel and rail in a conformal region; (b) discretization
of the interpenetration zone by its arc length; (c) identiﬁcation of the contact patch’s curved axis;
(d) establishment of size and center point of each strip; (e) evaluation of penetration in each strip;
(f) representation of the penetration along the interference region
in Fig. 2b. Consequently, the curved surface, s, in which the contact patch is contained
can be determined through the evaluation of the middle position between wheel and rail
points, as pictured in red in Fig. 2c. Since the points obtained are not necessarily equally
spaced in this curve, they have to be resampled and treated in a local coordinate system.
Furthermore, (xs,i, ys,i) expresses the coordinates of the ith strip, and s is the width of
each strip, as depicted in Fig. 2d.
A curved axis s is established representing the direction along the contact patch for
which the normal and tangential directions are variable. Thus, the normal and tangential
vectors are found for each strip as
ns,i =

−sin θi cos θi
T
(3)

Railway Dynamics with Curved Contact Patch
109
ts,i =

cos θi sin θi
T
(4)
in which the angle of each strip is deﬁned as
θi = arctan

y′
s,i

(5)
where y’s,i denotes the derivative of ys in xs,i that is calculated from the splines produced.
Then, the penetration along the curved contact patch, which is measured in the normal
direction of each strip, as represented in Fig. 2e, is evaluated. Both points on rail and
wheel which deﬁne the limits of the interference of a given strip can be obtained through
the intersection between a straight line normal to the patch surface and the rail and
wheel proﬁles, respectively. After determining the intersection points for a given strip,
the penetration on that strip, δcp(si), is the distance between those points. Since the wheel
and rail contact is considered locally elastic, their surfaces tend to deform and, therefore,
establish an effective contact area which is smaller than the interpenetration region [7].
Hence, the limits of the contact patch, ss and se, are determined by solving the following
equation
δcp(s) = (1 −ε)δmax
(6)
where ε is the correction factor, which takes into account the deformation of the con-
tacting surfaces and δmax denotes the maximum penetration in the interference region.
This procedure is represented in Fig. 3, and it must be noticed that the ﬁrst and last
strips have a smaller width compared with the remaining ones. For the effective contact
zone, the semi-Hertzian approach is considered where the contact pressure distribution
is elliptical only for the rolling direction. Thus, the longitudinal size of the i-th strip can
be given by the location of the leading edge as
xL(si) =

2Rsw(si)

δcp(si) −(1 −ε)δmax

(7)
in which Rs
W is the radius of curvature of the wheel surface in the longitudinal direction
for a given strip.
s
cp
δ
max
δ
(
)
−
max 1
δ
ε
ss
e
s
s
Δ
1
i −
i
j
1
j +
s
< Δ
s
< Δ
Fig. 3. Schematic representation of the identiﬁcation of the contact patch limits

110
F. Marques et al.
Subsequently to the identiﬁcation of the shape and size of the contact patches, the
normal pressure distribution evaluation on each patch is needed. Some of the methods
available on the literature depend on the location of the maximum penetration point to
calculate the contact pressure [7], which might produce numerical problems when two
peaks of penetration are found in the same contact area. A method proposed by Sun et al.
[8] is adapted to the curved contact model. In that sense, the contribution of each strip
for the normal contact force is computed as
fn,i = π2Eδcp(si)x2
L(si)s
4

1 −σ 2
⎛
⎝
 se
ss
 xL
−xL

x2
L(η) −ξ2
ξ2 + (si −η)2 dξdη
⎞
⎠
−1
(8)
where E is the Young’s modulus and σ denotes the Poisson ratio. Since the normal
direction varies along the contact patch, the normal force magnitude cannot be summed,
thus, it is given by the vector sum of the force originated in each strip as
fn =
Ns

i=1
fn,ins,i
(9)
This model is purely elastic, and a damping component can be added as
fd
n = fncd
(10)
where the damping factor is given as
cd =
⎧
⎨
⎩
ce
˙δ ≤−v0

ce + (1 −ce)

3r2 −2r3
−v0 < ˙δ < v0
1
˙δ ≥v0
in which r =
˙δ + v0
2v0
(11)
where ce expresses the coefﬁcient of restitution, ˙δ represents the penetration velocity
and v0 is a tolerance velocity.
Regarding the evaluation of creep forces and spin moment, a lookup table with a reg-
ularization for a simple double-elliptical contact region, based on CONTACT software,
is considered [9]. This lookup table requires, as input variables, the parametrized spin
creepage, semi-axes ratio, creepage angle, parametrized creepage modulus and shape
number. An enhanced version of this lookup table is used, in which its discretization
was obtained after minimizing the interpolation error [10].
3
Example of Application
A multibody model of trailer vehicle negotiating a left curve is utilized as example of
application of the proposed methodology for the wheel-rail contact model. This model
includes 11 rigid bodies, namely 4 wheelsets, 4 axleboxes, 2 bogie frames and the
carbody. All details of this model can be found in [11]. The vehicle starts the simulation
with a forward velocity of 18.3 m/s and a lateral misalignment of 2 mm with respect to
the track centerline to promote some hunting motion.

Railway Dynamics with Curved Contact Patch
111
Fig. 4. Representation of (a) the location of the main contact point for each patch and their shape
for (b) t = 1 s (c) t = 6 s (d) t = 20 s and (e) t = 36.4 s for the right wheel of the leading wheelset.

112
F. Marques et al.
To analyze the obtained results, the contact in the right wheel of the leading wheelset
is examined in detail, since it is external to the curve and, therefore the contact can occur
in the wheel transition zone. Figure 4a shows the location of the contact points on the
wheel proﬁle during the simulation. From the results, it is concluded that the rail interacts
with the wheel transition zone during negotiation where two different contact patches are
identiﬁed. The different shapes of contact patches determined are displayed in Figs. 4b–
e, where four different instants of simulation are considered. Figure 4d exhibits the
most non-elliptical contact scenario and coincides with the location in which the wheel
presents a concave surface.
4
Conclusions
A method for the determination of a curved contact patch on the interaction between
wheel and rail surfaces is presented in this work. This methodology considers that normal
contact direction might vary along lateral direction of the contact area and determines
the local penetration based on that assumption. A non-Hertzian method for the nor-
mal pressure evaluation is adapted to be applied in the curved contact. This contact
model has been applied to a dynamic simulation and demonstrated to be effective in the
determination of the contact patches and corresponding forces.
Acknowledgments. The ﬁrst author is supported by the Portuguese Foundation for Science
and Technology (FCT) under grant PD/BD/114154/2016, MIT Portugal Program. This work has
been supported by FCT with the reference project POCI-01-0145-FEDER-028424, by FEDER
funds through the COMPETE 2020 - Programa Operacional Competitividade e Internacionaliza-
ção. This work has been also supported by Portuguese Foundation for Science and Technology,
under the national support to R&D units grant, with the reference project UIDB/04436/2020 and
UIDP/04436/2020, as well as through IDMEC, under LAETA, project UIDB/50022/2020.
References
1. Bruni, S., Meijaard, J.P., Rill, G., Schwab, A.L.: State-of-the-art and challenges of railway and
road vehicle dynamics with multibody dynamics approaches. Multibody Syst. Dyn. 49(1),
1–32 (2020). https://doi.org/10.1007/s11044-020-09735-z
2. Meymand, S.Z., Keylin, A., Ahmadian, M.: A survey of wheel-rail contact models for rail
vehicles. Veh. Syst. Dyn. 54(3), 386–428 (2016)
3. Marques,F.,Magalhães,H.,Pombo,J.,Ambrósio,J.,Flores,P.:Athree-dimensionalapproach
for contact detection between realistic wheel and rail surfaces for improved railway dynamic
analysis. Mech. Mach. Theory 149, 103825 (2020)
4. Magalhães, H., et al.: Implementation of a non-Hertzian contact model for railway dynamic
application. Multibody Syst. Dyn. 48(1), 41–78 (2019). https://doi.org/10.1007/s11044-019-
09688-y
5. Vollebregt, E.: Detailed wheel/rail geometry processing with the conformal contact approach.
Multibody Syst. Dyn. 52(2), 135–167 (2020). https://doi.org/10.1007/s11044-020-09762-w
6. Vollebregt, E., Segal, G.: Solving conformal wheel-rail rolling contact problems. Veh. Syst.
Dyn. 52(S1), 455–468 (2014)

Railway Dynamics with Curved Contact Patch
113
7. Piotrowski, J., Kik, W.: A simpliﬁed model of wheel/rail contact mechanics for non-Hertzian
problems and its application in rail vehicle dynamic simulations. Veh. Syst. Dyn. 46(1–2),
27–48 (2008)
8. Sun, Y., Zhai, W., Guo, Y.: A robust non-Hertzian contact method for wheel–rail normal
contact analysis. Veh. Syst. Dyn. 56(12), 1899–1921 (2018)
9. Piotrowski, J., Liu, B., Bruni, S.: The Kalker book of tables for non-Hertzian contact of wheel
and rail. Veh. Syst. Dyn. 55(6), 875–901 (2017)
10. Marques, F., et al.: On the generation of enhanced lookup tables for wheel-rail contact models.
Wear, 434–435, 202993 (2019)
11. Marques, F.: Modeling complex contact mechanics in railway vehicles for dynamic reliability
analysis and design. Ph.D. thesis, Universidade do Minho (2020)

On the Utilization of Simpliﬁed Methodologies
for the Wheel-Rail Contact
José Ferreira, Paulo Flores, and Filipe Marques(B)
CMEMS-UMinho, Departamento de Engenharia Mecânica, Universidade do Minho,
Campus de Azurém, 4804-533 Guimarães, Portugal
id9286@alunos.uminho.pt, {pflores,fmarques}@dem.uminho.pt
Abstract. The utilization of multibody systems formulation allows to study the
railway vehicle dynamics, as well study local damaging phenomena that occur in
the wheel-rail interaction. However, the analysis of these phenomena requires long
simulations to perform a signiﬁcant prediction of their evolution. Having that in
mind, the utilization of simpliﬁed approaches for the different steps of calculation
of wheel-rail contact interaction are addressed, in particular, the utilization of
planar or spatial approaches for the contact detection. Two parametric surfaces
are used to describe both wheel and rail geometries, namely a revolution and an
extruded body, respectively. Regarding the normal and tangential contact forces,
an elastic approach is considered, therefore, these forces are treated as external
forces acting on the multibody system and an Hertzian model with damping is
employed for their evaluation. Finally, a trailer vehicle is considered as example
of application to study different modeling strategies.
Keywords: Wheel-rail contact · Railway dynamics · Surfaces deﬁnition ·
Multibody dynamics
1
Introduction
The modeling of wheel-rail contact plays a preponderant role on the dynamic analysis
of railway vehicles, since it represents the vehicle-track interaction where the developed
forces are responsible for supporting and guiding the vehicle, as well as the traction
and braking actions [1]. For an efﬁcient multibody simulation of a railway vehicle,
the methodology for assessing the wheel-rail contact forces has a critical importance,
since it is often the bottleneck for achieving a lower simulation time [2]. This can be a
critical issue when it is needed to perform long time simulations to predict the wheel-rail
damaging phenomena, as wear or rolling contact fatigue [3]. There are several issues
which might contribute for the improving of the numerical efﬁciency, namely, the contact
detection methods [4], the integration algorithms, the degree of detail of the normal and
creep force models [5], just to mention a few.
© The Author(s), under exclusive license to Springer Nature Switzerland AG 2022
M. Pucheta et al. (Eds.): MuSMe 2021, MMS 110, pp. 114–121, 2022.
https://doi.org/10.1007/978-3-030-88751-3_12

On the Utilization of Simpliﬁed Methodologies
115
2
Wheel and Rail Geometric Deﬁnition
The mathematical description of the wheel and rail proﬁles consists of a two-dimensional
representation which can be extended to the three-dimensional space by deﬁning their
external surfaces. A bi-dimensional approach for the description of the wheel and rail
has the advantage of allowing fast and straightforward numerical models but poses
signiﬁcant limitations regarding an accurate representation of the contact scenarios, as,
for instance, in the presence of angular misalignments. Typically, the wheel and rail can
be represented by two parametric surfaces [6], as represented in Fig. 1. The surface of
each rail can be achieved through the sweep of its cross-section along a given path, in
turn, the wheel surface is characterized as a revolution of its cross-section about its own
axis. Since both cross-sections are deﬁned as function of their lateral coordinate, each
of these of surfaces can be described by two independent parameters, i.e., a point on the
rail surface is deﬁned by the lateral (ur) and longitudinal (sr) coordinates, and a point
located on the wheel surface is given by its lateral (uw) and angular (sw) coordinates.
Based on the proposed surface parametrization, it is possible to write the equations
that allow the determination of a location of given point on the wheel and on the rail
as function of the surface parameters. Thus, following the representation of Fig. 1, the
position of a point P on the rail surface is calculated as
rside
P
= rside
r
+ rside
r,P
(1)
where rside
r
represents the location of the origin of the rail proﬁle given as function of its
arclength, and rside
r,P expresses the distance vector from the rail origin and point P, which
can be computed as
rside
r,P = Aside
r

0 uside
r,P f side
r,P
T
(2)
in which f side
r,P
represents the ordinate of the rail proﬁle, given as function of its lateral
coordinate, as schematized in Fig. 2a, and Aside
r
denotes the rail transformation matrix
and can deﬁned as
Aside
r
=

tside
r
nside
r
bside
r

(3)
where tside
r
, nside
r
and bside
r
are the local tangent, normal and binormal vectors of the rail,
respectively, and also given as function of its arclength.
In a similar manner, based on the representation of Fig. 1, the location of an arbitrary
point Q on the wheel proﬁle can be calculated as
rside
Q
= rws + hside
w
+ rside
w,Q
(4)
where rws denotes location of the center of mass of the wheelset, hside
w
represents a
local position vector from the center of mass of the wheelset until the origin of the wheel
proﬁle deﬁned to the left or right side accordingly, and rside
w,Q expresses the distance vector
from the wheel origin and point Q, given by the following expression
rside
w,Q = AwsAside
w,s

0 uside
w,Q f side
w,Q
T
(5)

116
J. Ferreira et al.
r
ws
r
rLrQ
rL
w,
r
Q
rL
w
h
rR
w,
r
Q
rR
rQ
L
w
s
R
w
s
rLrP
rR
rP
rL
r,r P
rL
rt
rR
rt
rR
r,r P
rL
rr
rR
rr
R
rs
L
rs
≡
rL
L
r
r
n
u
≡
rL
L
r
r
b
f
≡
rR
R
r
r
b
f
y
z
x
L
w
u
R
w
u
R
wf
L
wf
ws
ξ
ws
ζ
≡r
ws
ws
a
η
rR
w
h
≡
R
rnr
R
ru
Fig. 1. Parametrization of the wheel and rail surfaces
in which Aws denotes the wheelset transformation matrix, f side
w,Q corresponds to the ordi-
nate of the wheel proﬁle which, similarly to the rail, is deﬁned as function of its lateral
coordinate, as represented in Fig. 2b, and Aside
w,s is a transformation matrix that deﬁnes
the rotation about the wheel axis, and it is computed differently for both sides as
AL
w,s =
⎡
⎢⎢⎣
cos
	
sL
w,Q

0 sin
	
sL
w,Q

0
1
0
−sin
	
sL
w,Q

0 cos
	
sL
w,Q

⎤
⎥⎥⎦
or AR
w,s =
⎡
⎢⎢⎣
−cos
	
sR
w,Q

0 −sin
	
sR
w,Q

0
−1
0
−sin
	
sR
w,Q

0
cos
	
sR
w,Q

⎤
⎥⎥⎦
(6)
The deﬁnition of the normal and tangent vectors to the wheel and rail surfaces can be
achieved using the derivative of the proﬁles functions as schematized in Fig. 2. Hence,
the contact angle obtained from the proﬁle data, which is typically given by a set of nodal
points and, then, approximated by spline functions. These data can also be utilized to
calculate the proﬁle’s local curvature which it is utilized to estimate the contact stiffness.

On the Utilization of Simpliﬁed Methodologies
117
w
u
wf
w,Q
γ
Q
r
w,u,
t
Q
r
w,
n
Q
ru
rf
r,P
γ
P
r
r,
n P
r
r,u,
t
P
(a)
(b)
Fig. 2. Representation of an arbitrary point on (a) rail and (b) wheel proﬁles
3
Contact Detection
In this work, two methodologies for the identiﬁcation of contact points are analyzed and
compared. It must be noted that the deﬁnition of the surfaces’ geometry described in the
previous section is of paramount importance for the development and implementation
of contact detection methodologies, as well as to enhance their efﬁciency and accuracy.
The ﬁrst approach consists of a simpliﬁed methodology which performs the contact
detection by the intersection between the 2D wheel and rail proﬁles, as illustrated in
Fig. 3(a). Although the geometric parametrization of the contacting elements describes
spatial surfaces, as shown in Sect. 2, this simpliﬁed approach searches the contact points
through the comparison of the proﬁles position. First, the closest rail proﬁle to the wheel
is found, then the intersections between the rail proﬁle at that position and the wheel
transversal proﬁle are identiﬁed and, ﬁnally, the maximum penetration in each contact
patch is determined.
Alternatively, a spatial contact detection methodology is utilized to compare the
perks of the utilization of these different procedures. In this method, the contact point
can be located outside of the plane in which their planar proﬁles lie, as schematized in
Fig. 3(b). This approach follows the methodologies developed by Marques et al. [7] in
which the maximum penetration point is found by analyzing independently the strips of
the wheel surface.
4
Contact Force Model
In this work, the normal contact force is estimated according to an Hertzian-based model
which assumes elliptical contact area but considers a viscoelastic force-displacement
behavior. Therefore, the normal force is computed as
fn = Kδncd
(7)

118
J. Ferreira et al.
(a)
(b)
Fig. 3. Schematic representation of (a) bidimensional contact detection between wheel and rail
proﬁles and (b) three-dimensional contact detection between wheel and rail surfaces
where K expresses the generalized contact stiffness, which depends on the local contact
geometry and material properties [8], δ is the pseudo-penetration or indentation between
contacting surfaces, n deﬁnes the degree of nonlinearity of the model and it is 1.5 for
metallic contacts, and cd represents the damping factor calculated according to [9]. After
the normal force evaluation, the size of the contact ellipse is determined using the local
surfaces curvature.
Regarding the tangential or creep forces, a Lookup Table established from a con-
tact patch parametrization with ﬁve input variables and computed based on CONTACT
software is employed here [10, 11]. Although this approach was developed for simple
double elliptical contact area, which is generally a non-Hertzian shape, it is adapted here
for the Hertzian case.
5
Multibody Systems Formulation
The normal and tangential contact forces determined during the wheel and rail interac-
tion are included in the dynamic equations of motion as external forces. Bearing that
in mind, the equations of motion for a constrained multibody mechanical system can
be formulated recurring to the Newton-Euler formulation with absolute or Cartesian
coordinates together with the standard Lagrange multipliers technique [12]. In order to
control the violation of the kinematic constraints, the Baumgarte stabilization technique
is considered [13, 14], and the system of equations of motion can be written in the

On the Utilization of Simpliﬁed Methodologies
119
following form
M DT
D 0
 ˙v
λ

=

g
γ −2α ˙ −β2

(8)
where M is the global mass or inertia matrix of the system, D denotes the Jacobian
matrix of the constraints equations, ˙v represents the generalized accelerations vector,
λ expresses the Lagrange multipliers vector, which represents the reaction forces and
moments on the kinematic joints, g denotes the external generalized forces vector, in
which the contact forces are included, γ is the commonly named right-hand side vector of
acceleration constraints,  and ˙ denote the position and velocity constraints vectors,
respectively, and α and β are positive constants that represent the feedback control
parameters for the velocity and position constraints violation.
6
Example of Application
A multibody model of a single wheelset running on a tangent track is utilized as example
of application. In the beginning of the simulation, the wheelset has a lateral displace-
ment of 2 mm to promote the hunting motion, and its initial velocity is 20 m/s. These
dynamic simulations are performed in MATLAB code for spatial multibody dynamics,
the simulation time is 10 s and the ode45 algorithm is used for the time integration of the
equations of motion. Figure 4 show the lateral motion of the wheelset using the 2D and
3D contact detection methods, which demonstrate equivalent results. The same inter-
pretation can be made with the analysis of the contact point location on the wheel and
rail proﬁles represented in Fig. 5. In terms of computational efﬁciency, the 2D detection
method took around 90% of the computing time of 3D approach.
Fig. 4. Wheelset lateral position during the dynamic simulation

120
J. Ferreira et al.
Fig. 5. Location of the contact points on the (a) rail and (b) wheel proﬁles
7
Conclusions
This work addresses the utilization of simpliﬁed methodologies on the evaluation of the
forcesdevelopedonthewheel-railcontactinteraction.Forthispurpose,twoparametrized
surfaces are employed for the deﬁnition of the contact geometries, and an Hertzian-based
model is adopted for the normal and creep forces calculation. This allowed to study the
impact of the modeling approaches on different running conditions. Further studies using
different multibody models and running conditions will be addressed in the future to
better understand the beneﬁts and limitations of the utilization of simpliﬁed approaches
on the wheel -rail contact modeling.
Acknowledgments. This work has been supported by FCT with the reference project POCI-01-
0145-FEDER-028424, by FEDER funds through the COMPETE 2020 - Programa Operacional
Competi-tividade e Internacionalização. This work has been also supported by Portuguese Founda-
tion for Science and Technology, under the national support to R&D units grant, with the reference
project UIDB/04436/2020 and UIDP/04436/2020.
References
1. Meymand, S.Z., Keylin, A., Ahmadian, M.: A survey of wheel-rail contact models for rail
vehicles. Veh. Syst. Dyn. 54(3), 386–428 (2016)
2. Bruni, S., Meijaard, J.P., Rill, G., Schwab, A.L.: State-of-the-art and challenges of railway and
road vehicle dynamics with multibody dynamics approaches. Multibody Syst. Dyn. 49(1),
1–32 (2020). https://doi.org/10.1007/s11044-020-09735-z
3. Soleimani, H., Moavenian, M.: Tribological aspects of wheel-rail contact: a review of wear
mechanisms and effective factors on rolling contact fatigue. Urban Rail Transit 3(4), 227–237
(2017)
4. Shabana, A.A., Tobaa, M., Sugiyama, H., Zaazaa, K.E.: On the computer formulations of the
wheel/rail contact problem. Nonlinear Dyn. 40(2), 169–193 (2005)
5. Burgelman, N., Sichani, M.S., Enblom, R., Berg, M., Li, Z., Dollevoet, R.: Inﬂuence of wheel-
rail contact modelling on vehicle dynamic simulation. Veh. Syst. Dyn. 53(8), 1190–1203
(2015)

On the Utilization of Simpliﬁed Methodologies
121
6. Pombo, J., Ambrósio, J., Silva, M.: A new wheel-rail contact model for railway dynamics.
Veh. Syst. Dyn. 45(2), 165–189 (2007)
7. Marques,F.,Magalhães,H.,Pombo,J.,Ambrósio,J.,Flores,P.:Athree-dimensionalapproach
for contact detection between realistic wheel and rail surfaces for improved railway dynamic
analysis. Mech. Mach. Theory 149, 103825 (2020)
8. Goldsmith, W.: Impact – The Theory and Physical Behaviour of Colliding Solids. Edward
Arnold Ltd., London (1960)
9. Ambrósio, J., Pombo, J.: A uniﬁed formulation for mechanical joints with and without clear-
ances/bushings and/or stops in the framework of multibody systems. Multibody Syst. Dyn.
42(3), 317–345 (2018). https://doi.org/10.1007/s11044-018-9613-z
10. Piotrowski, J., Liu, B., Bruni, S.: The Kalker book of tables for non-Hertzian contact of wheel
and rail. Veh. Syst. Dyn. 55(6), 875–901 (2017)
11. Marques, F., et al.: On the generation of enhanced lookup tables for wheel-rail contact models.
Wear 434–435, 202993 (2019)
12. Nikravesh, P.E.: Computer-Aided Analysis of Mechanical Systems. Prentice Hall, Engewood
Cliffes (1988)
13. Baumgarte, J.: Stabilization of constraints and integrals of motion in dynamical systems.
Comput. Methods Appl. Mech. Eng. 1(1), 1–16 (1972)
14. Marques, F., Souto, A.P., Flores, P.: On the constraints violation in forward dynamics of
multibody systems. Multibody Syst. Dyn. 39(4), 385–419 (2016). https://doi.org/10.1007/
s11044-016-9530-y

Optimization Tools Applied in the Design
of a Hydraulic Hybrid Powertrain
for Minimal Fuel Consumption
T´arsis Prado Barbosa1(B), Aline de Faria Lemos2,
Luiz Ot´avio Ferreira Gon¸calves1, Ricardo Poley Martins Ferreira3,
Leonardo Adolpho Rodrigues da Silva1, and Juan Carlos Horta Guti´errez3
1 Department of Telecommunications and Mechatronics Engineering,
Federal University of Sao Joao Del-Rei,
MG 443, Km 7, Ouro Branco, MG 36420-000, Brazil
{tarsisbarbosa,leonardo}@ufsj.edu.br
2 Department of Mechatronics, Optics and Mechanical Engineering Informatics,
Budapest University of Technology and Economics, M˝uegyetem rakpart 3,
Budapest 1111, Hungary
alinefaria@mogi.bme.hu
3 Department of Mechanics Engineering, Federal University of Minas Gerais,
Avenida Presidente Antˆonio Carlos, 6627 - Pampulha, 31270-901 Belo Horizonte,
MG, Brazil
horta@demec.ufmg.br
Abstract. This work aims to design a hydraulic hybrid vehicle model
with a series transmission architecture. The hydraulic hybrid transmis-
sion uses hydro-pneumatic accumulators to store energy instead of bat-
teries or capacitors and, although less well known, can oﬀer several
advantages compared to hybrid-electric systems. In the implemented
model, a pump is connected to an engine and supplies hydraulic power
to a hydraulic motor, linked to the vehicle wheels axle. Regenerative
braking is enabled with the hydraulic motor, working as a pump, and
returning ﬂuid power to the accumulator. Optimization tools were used
to select the dimensions of the components and to determine the values
of the control variables for activating the pump/accumulator. The model
implemented had its consumption reduced by about 50 % in relation to
the reference values, and the accumulator volume was reduced about
11 % concerning the calculated analytical values.
Keywords: Fluid power · Hydraulic hybrid transmission ·
Fuel-saving · Genetic algorithm · Optimization tools
1
Introduction
Automotive vehicles with higher energy eﬃciency and which cause lower envi-
ronmental impacts are currently the two main demands of society concerning
c
⃝The Author(s), under exclusive license to Springer Nature Switzerland AG 2022
M. Pucheta et al. (Eds.): MuSMe 2021, MMS 110, pp. 122–130, 2022.
https://doi.org/10.1007/978-3-030-88751-3_13

Optimization of a Hydraulic Hybrid Powertrain
123
the automotive industry. Although less well known, hydraulic hybrid powertrain
solutions oﬀer an eﬃcient and high-performance alternative to hybrid-electric
systems, which are already in the market [9].
In a hybrid hydraulic vehicle (HHV), at least one reversible hydrostatic
motor/pump unit is used, acting as a motor to transmit torque and rotation
to the wheels during the acceleration phases and, as a pump, perform the regen-
eration of kinetic energy during braking events. One of the most used archi-
tectures in hybrid vehicles is the series architecture (Fig. 1), in which the com-
bustion engine drives a hydraulic pump that will provide the power to drive the
motor/pump, which will be connected to the wheels diﬀerential axle. In this con-
ﬁguration, the combustion engine operates in regions of higher eﬃciency, since
it will work decoupled from the wheels and its speed can be set independently
[1].
Internal
Combustion
Engine
Accumulator
Pump
Motor/Pump
Fig. 1. Hybrid hydraulic vehicle - series architecture (adapted from [10]).
The storage system hole of batteries in HEV is occupied by a hydro-
pneumatic accumulator in HHV. A bladder type accumulator consists of a steel
hull with an elastomeric bladder inside that is ﬁlled with gas (normally nitrogen).
The bladder separates the gas from the oil that externally ﬁlls the remaining vol-
ume of the tank. Therefore, the accumulator stores potential energy and return
it to the circuit on demand [7]. Hydraulic accumulators are characterized by
higher power density and lower energy density than electrochemical batteries.
They can accept high frequencies, high charge/discharge rates and can recover
more eﬃciently power during regenerative braking under city traﬃc conditions in
a hybrid vehicle. However, the relatively low energy density of the hydraulic accu-
mulators, which could lead to low vehicle autonomy, requires a carefully designed
powertrain and energy management strategies to avoid increasing accumulator
size and still obtain fuel savings [2].
In this context, this work proposes using the optimization tools from Matlab
toolbox - pattern search and genetic algorithm (GA) to evaluate the possibilities
of reducing the volume of the hydro-pneumatic accumulator and ﬁnding opti-
mized operating pressures. In this case, the pattern search tool was used only to
ﬁnd a vector of initial values to feed the genetic algorithm.

124
T. Prado Barbosa et al.
2
Methods
2.1
Vehicle Model
The model of the hydraulic hybrid vehicle was implemented in the present work
in the Simulink environment and is shown in Fig. 2. The connections between
the hydraulic components, which compose the transmission system, are identi-
ﬁed with the color beige. The black lines interconnect blocks related to vehicle
control, and may contain signals from sensors (pressure, ﬂow rate) and control
commands (control of the pump volumetric displacement, reference speed, etc.).
Fig. 2. Hydraulic hibrid vehicle model implemented on Simulink.
The vehicle was represented as having a total mass M, an eﬀective frontal
area given by the product of the drag coeﬃcient and the frontal area (cd · Af),
and dynamic radius of the wheel rw. The model considers movement resistance
forces related to aerodynamic drag and rolling resistance (product of the rolling
resistance coeﬃcient fr and the vehicle weight −M · g) and neglects the slope of
the track and the existence of curves. Thus, by Newton’s second law, the torque
(T) that acts on the vehicle’s axis is given by:
T = rw ·

M ˙v + Mgfr + cdAfρv2
2

(1)
where ρ is the air density and v is the vehicle speed at the time considered [7].
The movement resistance forces in Eq. (1) were inserted in the model of Fig. 2
in the block called Road Loads.
The characteristics of the vehicle designed in this work follow the same values
as those used by [10] and by [11], in order to compare both studies. The vehicle
simulation was performed by using the EPA UDDS driving cycle: distance of
12.07 km and total time of 1325 s - about 22 min [4]. The parameters considered
in the vehicle model are shown in Table 1.

Optimization of a Hydraulic Hybrid Powertrain
125
Table 1. Parameters used in the HHV computational model
Parameter
Value
Total mass (M)
1325 kg
Front area (Af)
2.16 m2
Drag coeﬃcient (cd)
0.26
Wheel radius (rw)
0.3 m
Rolling resistance coeﬃcient (fr)
0.011
Air density (ρ)
1.20 kg/m3
Maximum speed - UDDS cycle (v) 90 km/h
Maximum accumulator pressure
35 MPa
Accumulator volume (Vacul)
30 L
In Eq. (1), considering the vehicle starting from rest and neglecting the resis-
tance forces, the minimum torque required to move the car would be 596.25 Nm.
Based on this value, the theoretical lower volumetric displacement (D) of the
motor/pump can be found after setting the minimum pressure value (Pmin) of
the hydraulic circuit. Stelson et al. [10] considered the minimum working pressure
of the hydraulic circuit equal to 60% of the maximum working pressure of the
hydro-pneumatic accumulator (Table 1), therefore, equal to 21 MPa. Thus, the
calculation of the volumetric displacement of the motor/pump can be performed
as follows:
D = 2π · T
Pmin
(2)
Therefore, the calculated value of the volumetric displacement was 1.8 ·10−4
[m3]. The hydraulic pump connected to the combustion engine was considered
to have a constant ﬂow rate. An ideal ﬂow source was chosen for the simulation
in such a manner that the insertion of the combustion engine to drive the pump
was not necessary for this approach (see Fig. 2). As a simpliﬁcation of the model,
the diﬀerential gearbox was also not included in the transmission system.
The calculations performed to obtain the ﬂow rate of the pump (Q) connected
to the combustion engine were made considering that the hydraulic power pro-
vided (Pmin ·Q) should be equal to the mechanical power necessary to overcome
the movement resistance forces. Then, the following relationship was found:
Pmin · Q =

Mgfr + cdAfρv2
2

· v
(3)
Considering the vehicle maximum speed in the urban driving cycle (UDDS)
equal to 90 km/h (25 m/s), the pump should provide a ﬂow rate of 5 · 10−4
m3/s (0.5 liters per second). To compensate losses due to leaks, viscous and
mechanical friction, the ﬂow was considered equal to 1 · 10−3 m3/s, as adopted
by [10].

126
T. Prado Barbosa et al.
The maximum working pressure must be lower than the pressure of the accu-
mulator. Stelson et al. [10] considered the accumulator volume equal to 0.03 m3
(30 l) and the maximum working pressure Pmax equal to 90% of the maximum
accumulator pressure (Table 1). These parameters were replicated as initial val-
ues of the reference model and the pattern search function. The pre-charge pres-
sure of the gas inside the accumulator was considered to be 0.9 · Pmin [5].
The variation of the volumetric displacement of the motor/pump, which pro-
duces the variation of the speed of the wheels, was done by a proportional con-
trol in a closed-loop using the UDDS driving cycle speed as reference. The logic
blocks related to the controller are also shown in Fig. 2. The hydraulic pump was
turned on and oﬀbased on the pressure value of the accumulator, similarly to a
pressure switch (on-oﬀcontrol). When the pressure of the accumulator was lower
than the stipulated minimum pressure, the pump started operating providing a
constant ﬂow, remaining on until the stipulated maximum pressure was reached.
Based on the average power consumed in the cycle, fuel consumption can be
estimated to meet demand based on the speciﬁc fuel consumption map value from
the used internal combustion engine [7]. In the work of [10] and [11], the used
combustion engine was a diesel engine with a power of 13.7 kW at an angular
speed of 2200 RPM and with an eﬃciency of 32.1%. The speciﬁc fuel consump-
tion, obtained based on these data and used in this work, was 210 g/kWh. The
values returned by the simulation for the optimization routine were, ﬁrstly, the
absolute value of the diﬀerence between the speed achieved by the vehicle and
the reference speed, and secondly the fuel consumption in the driving cycle.
2.2
Optimization Tools and Program Routine
The structure of the implemented optimization problem was divided into four
hierarchical levels, according to the diagram shown in Fig. 3. The ﬁrst level
consists of a .m ﬁle that initializes all HHV parameters and deﬁnes the starting
values for the variables (u) to be optimized: maximum pressures, accumulator
volume, and angular speed of the motor/pump. Subsequently, the parameters of
the optimization tools in the Matlab toolbox were conﬁgured on the second level:
upper and lower bounds for the problem-solution vector, maximum number of
iterations, function tolerance, etc. Table 2 shows the initial values of the pattern
search function and the adopted bound values.
In the third level, the objective function F(u) was deﬁned in a new .m ﬁle as
the fuel consumption of the model in the UDDS cycle. At this level, a constraint
was also deﬁned, in which the absolute value of the diﬀerence between the ref-
erence speed and the model speed could not be greater than 1 m/s, similarly
to the method adopted in the Advanced Vehicle Simulator software – Advisor
[3,8].

Optimization of a Hydraulic Hybrid Powertrain
127
Fig. 3. Structure of the optimization problem.
Table 2. Initial and boundary values used within the optimization tools
Parameters
Initial value Lower bound Upper bound
Pmax [MPa] 31.5
20
33
Vacul [l]
30
10
50
ω [rad/s]
80
50
110
In order to obtain the consumed power, the model created in Simulink was
called to perform the driving cycle with the updated values of the variables (u),
this model being the fourth level. All variables in the .m ﬁles were deﬁned as
global variables, thus allowing the calculation of consumption by accessing the
results obtained in Simulink.
In the implemented routine, in order to maintain the minimum working pres-
sure (Pmin) coupled with the maximum pressure (Pmax), the equation described
by [6] was used, which relates to the kinetic energy that can be recovered in
braking equal to the isothermal work of the accumulator, calculated based on
the ratio of accumulator pressure, as follows:
Pmin =
Pmax
e

M·v2
Pmax·Vacul

(4)
In addition, the increase in the volume of the accumulator represents an
increase in vehicle mass. This increase was equated based on the density of the
hydraulic oil used in the simulation (ISO VG 46, ρ = 855.69 kg/m3). Also,
one consideration adopted was that the initial mass of a full 30 L accumulator
had already been counted in the vehicle’s initial mass (1325 kg). Therefore, the
increase in mass with the increase in volume was deﬁned as:
Mk+1 = Mk + ρ · (Vacul −0.03)
(5)
As an initial condition for optimization using GA, the best values obtained
with the pattern search tool were used, as will be shown in the next section.
Table 3 shows the parameters of the GA implemented in this work.

128
T. Prado Barbosa et al.
3
Results and Discussion
Figure 4 shows the UDDS driving cycle with the reference speed and the speed
performed by the hydraulic hybrid vehicle. The reference consumption value
obtained in this situation was 7.40 l/100 km (autonomy of 13.51 km/l), which
was the same value obtained in the HHV model implemented by [10]. Moreover,
the proportional speed control operated satisfactorily, since the error between
the reference speed value and the vehicle model speed was low.
Table 3. Parameters of the implemented genetic algorithm
Parameters
Values
Population size
20
Number of generations
50
Crossover probability (%) 80
Mutation function
Adaptive
Elitism’s individuals
1
Minimum tolerance
1e−6
Stopping criteria
Minimum tolerance
(a)
(b)
Fig. 4. a) Comparison between speed reference and the hybrid vehicle speed in the
UDDS cycle. b) Comparison between the ﬂow rate provided by the hydraulic pump
before and after optimization.
After 197 iterations, the values obtained by the pattern search tool were
26.00 MPa and 13.18 MPa for the maximum and minimum pressures, respec-
tively, and the accumulator volume was 35.54 l. With these new values, it was
already possible to obtain a fuel consumption of 5.34 l/100 km, a reduction of
27.8% to the reference value.

Optimization of a Hydraulic Hybrid Powertrain
129
The values obtained by the pattern search tool were used as initial input
values for the genetic algorithm, as mentioned before. In addition, the angular
speed of the motor/pump was also used as a variable to be optimized using
the GA tool, since this parameter is related to the ﬂuid ﬂow, therefore, it can
inﬂuence the power consumed in the execution of the selected trajectory.
The GA solution process was stopped after completing a total of 34 gen-
erations, once the minimum tolerance value stipulated in the function was
reached (see Table 3). The lowest fuel consumption value found at this step
was 3.60 l/100 km, which corresponds to a reduction of approximately 51.4% to
the reference consumption value. The accumulator volume found was 26.62 l, a
reduction of 11.3% in volume and weight compared to the initial reference value.
Regarding the dimensions of the optimized accumulator, a 26.62 l accumulator
has a diameter of approximately 230 mm and 1.4 m length. This component could
be installed in the vehicle trunk.
The pressures also decreased: 21.62 MPa and 9.55 MPa for the maximum and
minimum pressures, respectively. The angular speed (ω) found was 56.0 rad/s.
Table 4 shows the comparison between the values of the control variables before
and after the optimization with GA. Figure 4b shows the comparison between
the ﬂow rate delivered by the pump before (blue line) and after the optimization
process (red line). In Fig. 4b, a decrease in the pump operation demand was
observed. Since this pump is driven by the output shaft of the combustion engine
controlled by an on-oﬀcontrol, the reduction in the number of pump starts
explains the reduction in fuel consumption obtained in the optimization.
Table 4. Comparison between the values of the reference parameters [10] with the
values obtained from the genetic algorithm method; and comparison between the fuel
consumption of the implemented series HHV and the work of [10]
The comparison of the fuel consumption values found with the values
obtained by [10] is also shown in Table 4. The fuel consumption reduction was
very similar to the one obtained by these authors in the UDDS cycle applying
diﬀerent optimization methods. The tools applied proved to be useful for new
explorations in the design of hybrid powertrain.

130
T. Prado Barbosa et al.
4
Conclusion
In this work, a hydraulic hybrid vehicle with a series transmission architecture
was modeled and simulated in an urban driving cycle (UDDS). The implemented
model and the optimization tools applied allowed to ﬁnd conditions to reduce
the operating time of the hydraulic pump coupled to the combustion engine and
also the hydraulic components size, reducing the fuel consumption 50 % about
the initial hydraulic hybrid vehicle considered as reference.
Acknowledgements. The authors are grateful to PPGMEC- UFMG and NIPEM -
UFSJ for their support.
References
1. Achten, P., Vael, G., Sokar, M.I., Kohm¨ascher, T.: Design and fuel economy of a
series hydraulic hybrid vehicle. In: Proceedings of the JFPS international sympo-
sium on ﬂuid power, vol. 2008, pp. 47–52. The Japan Fluid Power System Society
(2008)
2. Barbosa, T.P., Eckert, J.J., Roso, V.R., Pujatti, F.J.P., da Silva, L.A.R., Guti´errez,
J.C.H.: Fuel saving and lower pollutants emissions using an ethanol-fueled engine
in a hydraulic hybrid passengers vehicle. Energy 121361 (2021)
3. Eckert, J.J., Corrˆea, F.C., Santiciolli, F.M., Costa, E.D.S., Dion´ısio, H.J., Dedini,
F.G.: Vehicle gear shifting strategy optimization with respect to performance and
fuel consumption. Mech. Based Design Struct. Mach. 44(1–2), 123–136 (2016)
4. EPA: Enviroment Protection Agency – Urban Dynanometer Driving Sched-
ule, 28 November 2017. https://www.epa.gov/emission-standards-reference-guide/
epa-urban-dynamometer-driving-schedule-udds
5. Hydac: Hydraulic Accumulators Catalog, 01 December 2017. https://m.hydac.
com/ﬁleadmin/pdb/pdf/PRO0000000000000000000003000000051.pdf
6. Ibrahim, M.S.A.: Investigation of hydraulic transmissions for passenger cars.
Shaker (2011)
7. Guzzella, L., Sciarretta, A.: Vehicle Propulsion Systems, Introduction to Model-
ing and Optimization. Springer, Berlin (2013). https://doi.org/10.1007/978-3-642-
35913-2
8. Mashadi, B., Amiri-Rad, Y., Afkar, A., Mahmoodi-Kaleybar, M.: Simulation of
automobile fuel consumption and emissions for various driver’s manual shifting
habits. J. Cent. South Univ. 21(3), 1058–1066 (2014)
9. Rydberg, K.E.: Energy eﬃcient hydraulic hybrid drives. In: 11th Scandinavian
International Conference on Fluid Power, SICFP 2009, 2-4 June 2009, Link¨oping,
Sweden (2009)
10. Stelson, K.A., Meyer, J.J., Alleyne, A.G., Hencey, B.: Optimization of a passenger
hydraulic hybrid vehicle to improve fuel economy. In: Proceedings of the JFPS
International Symposium on Fluid Power, vol. 2008, pp. 143–148. The Japan Fluid
Power System Society (2008)
11. Van de Ven, J.D., Olson, M.W., Li, P.Y.: Development of a hydro-mechanical
hydraulic hybrid drive train with independent wheel torque control for an urban
passenger vehicle. In: Proceedings of the National Conference on Fluid Power,
vol. 51, p. 503. Citeseer (2008)

Determination of the Effect of Sloshing
on the Railcar-Track Dynamic Behavior
Juan Carlos Jauregui-Correa1(B), Frank Otremba2, Jose A. Romero-Navarrete2,
and Gerardo Hurtado-Hurtado1
1 Universidad Autonoma de Queretaro, 76010 Querétaro, Mexico
jc.jauregui@uaq.mx
2 Federal Institute for Materials Research and Testing (BAM), Berlin, Germany
Abstract. This paper presents the study of the impact caused by a liquid cargo
on a railway infrastructure. The dynamic behavior of a tank car corresponds to
a multibody dynamic system with several degrees of freedom. This study’s data
were obtained from a scale experimental ﬁxture consisting of a track and a railcar
with a tank. The track was instrumented with strain gauges and the railcar with
accelerometers. The data showed non-periodic and periodic terms; therefore, the
results were analyzed with the Empirical Mode Decomposition method (EMD).
It was found that the EMD identiﬁed the signal components that were related to
the sloshing. These components represent the mode shapes of the original signal.
The location of the sloshing in the track was found applying spectrograms to the
accelerometer data. This paper’s experimental outputs suggest that the sloshing
effect is detectable at the track and in the vehicle dynamics.
Keywords: Sloshing effect · Empirical Mode Decomposition · Wheel/track
interaction · Multibody dynamics
1
Introduction
The dynamic interaction between the track and the train has many safety implications,
and it determines the life of rails, wheels, and train components [1, 2]. It also determines
the passenger’s comfort and safety, as well as the cargo’s integrity. It is a multibody
problem since the train has several cars connected through elastic elements, and each
car has different bodies interconnect through elastic elements. All these bodies are linked
to the rail at the contact point, and this connection has a complex physical representa-
tion that determines the dynamic interaction. The dynamic interaction study requires
better analytical models and experimental methods that explain anomalous interactions
between the track geometry and the car suspensions.
One of the critical vehicles representing a complex dynamic behavior is liquid cargo
since the liquid has a dynamic behavior that involves the premature damage of rail-
ways and derailment in turning infrastructures [1, 2]. There are few publications about
the dynamic behavior of liquid cargos and rail dynamics up to the author’s knowl-
edge. Romero and Otremba [3] reported the effects of sloshing on the force magnitude
© The Author(s), under exclusive license to Springer Nature Switzerland AG 2022
M. Pucheta et al. (Eds.): MuSMe 2021, MMS 110, pp. 131–140, 2022.
https://doi.org/10.1007/978-3-030-88751-3_14

132
J. C. Jauregui-Correa et al.
on vehicle suspension. There are many experimental and analytical publications about
the wheel/track interaction. Fermer and Nielsen [4] presented an experimental work to
determine the interaction between a railcar and the track; they estimated the rail param-
eters from a frequency analysis, and they presented a full multi-body dynamic model.
Different publications contribute to theoretical models [5–8].
From a multibody dynamic point of view, it is essential to understand the correlation
between the force and the acceleration data sets. With this correlation, it would be
possible to estimate the wheel forces on the track on the basis of the acceleration data
of the railcar. Davis and Sanayei [9] characterized the effect of vehicles passing over a
metallic bridge. They estimated the relationship between forces and accelerations in the
frequency domain using a similar approach as [10]. Other researchers have applied the
Hilbert transform [11] or the Empirical Mode Decomposition technique to identify the
features of the track’s vibration measurements [12].
This paper presents the analysis of the interaction between a liquid cargo and the
track. The analysis data came from a scale-down experimental facility [13], the forces
on the track were recorded with strain gauges, and the railcar acceleration was recorded
with a tri-axial accelerometer and three gyroscopes. As the frequency-domain analysis
is valid only for periodic functions, the data were decomposed using the Empirical Mode
Decomposition technique. The correlation between the force data and the acceleration
data was determined at those modes with similar behavior. Each “mode” presented a
characteristic frequency located along the railcar trajectory, with spectrograms produced
with the Continuous Wavelet Transform.
2
Experimental Test Facility
The scaled down experimental facility consisted of a track, a railcar with a tank, and the
instrumentation.
2.1
The Track
The track (Fig. 1) has a rectilinear accelerating entrance, a 180° curve, and a rectilinear
decelerating ending. The track is instrumented with strain gauges along the curve, and a
railcar runs freely on the track. A ﬂat straight surface supports the track, and the rail car
moves by the effect of the surface’s inclination. The structure that supports the surface
is sufﬁciently rigid to avoid perturbations on the railcar.
The track has an adjustable mechanism that modiﬁes its slope, to further control the
speed of the vehicle. The gravity pushes the vehicle downwards, enters the curve, and
goes upwards until it stops; then, it goes backwards.

Determination of the Effect of Sloshing
133
2.2
The Rail Car
The railcar (Fig. 2) was instrumented with an optical sensor for measuring its speed;
a tri-axial accelerometer for measuring the accelerations in the orthogonal directions;
and three gyroscopes for measuring the rotations of the tank. The vehicle’s design has
a scale factor of 1/10 [13], and it has a spring suspension between the bogies and the
platform. The rotation between the bogies and the platform is friction-free through a
roller bearing, and this design eliminates the yaw stiffness. The liquid cargo consisted
of a 110 mm diameter glass tank.
Fig. 1. Sketch representing the track and the support structure
Fig. 2. Description of the railcar with a tank

134
J. C. Jauregui-Correa et al.
2.3
Instrumentation
The track has a set of strain gauges at different positions along the curve (Fig. 3). They
start at the beginning of the curve, following the rail car’s downward direction, and
the last one covers the maximum trajectory before the railcar returns backward. The
strain gauges have a resistance of 120 Ohms connected to a one-quarter-of-a-bridge
conﬁguration. A data-acquisition system records the strain values and stores the data in
ASCII ﬁles for further analysis. The velocity marks are located along the straight section
(forward direction), with a separation of 200 mm between each other. The sample rate
was set a 2400 Hz, and the data were recorded into de database. Figure 3 describes
the strain gauge location, the velocity marks, and the junction between two sections of
the track (gap). This point creates an impact on the vehicle that is only recorded with
the accelerometers. The accelerometers box contains three orthogonal accelerometers
and three gyroscopes, all of them are MEM’s, while the data were stored in a portable
memory during the entire test. A light battery powers the system for more than 24 h.
and the data are recorded continuously at a sample rate of 1594 Hz. For synchronizing
the two devices’ measurements, a trigger set an impulse on the track, and both systems
identiﬁed the beginning of the data acquisition period.
The tank has camera that recorded the ﬂuid motion during the test. The natural
frequency of the ﬂuid was estimated from these videos.
(a) 
(b) 
Fig. 3. (a) Strain gauge instrumentation and velocity marks location. (b) Direction of motion
2.4
Test Procedure
The rail car starts moving from the highest position; it travels about 2 m before reaching
the curve, continues along the curve, and it stops after passing the location of the strain
gauge, Channel 8. Then, it returns to the lower part of the curve and rests at the strain
gauge Channel 2 location. The sloshing occurred when the railcar is turning, stops, and
returns, and the motion sequence when the sloshing was higher started at strain gauge
Channel 3, continued until the rail car stopped at strain gauge Channel 8, and went
backwards passing over the strain gauge Channel 3. The glass tank showed the water
movement, and a video allowed the estimation of sloshing frequencies. The natural
frequencies of the railcar were determined through an impact test, when the railcar was
on the track, and the vehicle response was recorded with the accelerometers.

Determination of the Effect of Sloshing
135
3
Experimental Results
Table 1 includes the principal frequencies obtained with the impact test. When the railcar
runs, the excitation forces derive from i) the impulse at the gap; ii) the uncontrolled align-
ment variations in the track; and iii) the liquid cargo sloshing. The sloshing effect was
greater at the end of the railcar trajectory, when the vehicle started to move backwards.
Fig. 4. Strain gauge measurements when sloshing was higher.
The data used for this analysis corresponds to the backward movement. It started
when the railcar touches the strain gauge at Channel 3, passed over Channel 2, and rests
on Channels 2, 3, 4, and 5. When the rail car returns to Channel 5, the water motion
was minimum and the sloshing was negligible, the maximum amplitude occurred from
Channel 3 to Channel 8 and backwards. Figure 4 shows the measurements during this
period. The events on this period are recorded from the instant when the railcar hits
Channel 4, stops at Channel 8 (this is the last sensor in the trajectory), and returns to
Channel 3. The low amplitudes at Channel 8 are due to the railcar’s low speed.
Table 1. Natural frequencies, impact test.
Direction
First [Hz]
Second [Hz]
Third [Hz]
Lateral (x)
26.4
176.0
248.0
Longitudinal
(y)
157.0
260.0
480.0
Vertical (z)
16.2
54.7
340.0

136
J. C. Jauregui-Correa et al.
The acceleration data were recorded simultaneously as the strain gauge data; the
recording data comprised the entire railcar displacement. Figures 5, 6, and 7 show the
acceleration data for the three orthogonal directions (Lateral (x), Longitudinal (y), and
Vertical (z)).
4
Data Analysis and Discussion
Since the time-series have non-periodic terms related to the vehicle dynamics, it is
impossible to apply the spectrum analysis. Therefore, it was decided to separate the
non-periodic terms from the periodic terms. This situation leads to the application of
the Empirical Mode Decomposition (EMD). Although it has some limitations (as deﬁne
by [14]), the EMD is an analysis method that adapts the time-space domain to process
non-stationary or non-linear time series. The procedure consists of separating the time
series into “modes” that have speciﬁc characteristics. These modes are computed with
the Intrinsic Mode Functions using Hilbert’s transform. In the end, the addition of all
the modes recovers the original function.
Fig. 5. Vibrations along the lateral direction (x). (in g’s)
Fig. 6. Vibrations along the longitudinal direction (y). (in g’s)

Determination of the Effect of Sloshing
137
The accelerometer in the vertical direction has a compensation value of -1 that
corresponds to gravity.
Fig. 7. Vibrations along the vertical direction (z). (in g’s)
The following ﬁgures show the results of separating the non-periodic and periodic
terms. The term “non-periodic modes” is the addition of those modes without a well-
deﬁned periodic function, and the other term is the addition of the remaining modes.
Depending on the “shape” of the signal, the EMD produced between 10 to 12 modes.
The original signal can be reconstructed by adding all the intrinsic modes. The modes
were organized into modes with non-periodic time series and modes with periodic time
series. Figure 8 shows the periodic and non-periodic modes of the strain gauge signal
(Channel 3). Similarly, Figs. 9, 10 and 11 show the non-periodic and periodic terms of the
acceleration data. The non-periodic modes in the x and y direction show how the railcar
reduced its speed and then stops. The movement along the z-direction continuously
oscillates. The sloshing effect is noticeable in the periodic modes, and the water motion
modiﬁes the entire dynamic behavior. The bottom part of Fig. 10 shows the periodic
Fig. 8. Non-periodic and periodic modes. Strain gauge Channel 3.

138
J. C. Jauregui-Correa et al.
Fig. 9. Non-periodic and periodic modes. Lateral direction (x). (in g’s)
modes along the direction of the railcar’s movement. Around t = 1, there is a sudden
change in amplitude; this behavior change corresponds to the instant when the water
started sloshing in the tank.
Table 2 shows the characteristic frequency of each mode. The table is limited to those
frequencies below the natural frequency (Table 1) for each direction. The highlighted
values correspond to the equivalent sloshing frequency.
Fig. 10. Non-periodic and periodic modes. Longitudinal direction (y). (in g’s)

Determination of the Effect of Sloshing
139
Fig. 11. Non-periodic and periodic modes. Vertical direction (z). (in g’s)
The vertical direction shows the sloshing vibration at the ﬁrst mode. The force signal
shows the sloshing at the third mode, whereas the lateral direction and the longitudinal
direction show the sloshing vibration at modes 2 and 3.
Table 2. Mode frequencies [Hz]
Mode
1
2
3
4
5
6
Lateral (x)
0.44 0.70 3.79 6.22 14.9
28.5
Longitudinal (y) 0.22 0.24 0.64 1.82
4.88
9.01
Vertical (z)
0.60 1.26 2.26 7.32
7.50 15.5
Force
0.22 0.46 0.95 3.98
8.77 28.0
5
Conclusions
Transporting liquid cargo has a signiﬁcant impact on the interface wheel-track inter-
action dynamics. The liquid motion, sloshing, affects the load on the track and the
railcar’s dynamic behavior. The experimental work presented in this paper showed that
the sloshing effect is detectable at the track level and in the vehicle dynamics behavior.
Nevertheless, the characterization of such an effect requires combining different anal-
ysis techniques, being the Empirical Mode Decomposition (EMD) a fundamental tool
for identifying the sloshing effect. It was found that sloshing occurred when signiﬁcant
changes occurred in the railcar dynamics, particularly when the railcar entered a curve

140
J. C. Jauregui-Correa et al.
and reduced its travel speed. A railcar with a tank is a clear example of a multibody
dynamic system with a nonlinear behavior.
The slosh motion has a low-frequency response in several directions, and EMD
analysis identiﬁed those waveforms corresponding to the sloshing frequencies, and this
method was the basis for locating the position on the track. The location was found using
time-frequency maps constructed at each mode.
Further work should involve the determination of the transfer function between the
acceleration measurements and the force measurements. This transfer function will help
to predict the sloshing cargo effect on the track response from the railcar dynamics
perspective.
References
1. F.R.A. FRA: Joseph C. Szabo prepared oral testimony. 10 Apr 2014. Testimony. U.S. Depart-
ment of transportation. Federal Railroad Administration (2014). https://www.fra.dot.gov/
eLib/details/L05001
2. F. R. A. FRA: Rail moving America forward. Current research projects. In: 2019 TRB Annual
Conference (2019). https://railroads.dot.gov/sites/fra.dot.gov/ﬁles/fra_net/18429
3. Romero Navarrete, J.A., Otremba, F.: Vehicle’s components damage potentials of liquid cargo.
In: Proceedings of the Institution of Mechanical Engineers, Part D: Journal of Automobile
Engineering, vol. 235, no. 2–3, pp. 446–454 (2020)
4. Fermér, M., Nielsen, J.C.O.: Vertical interaction between train and track with soft and stiff
railpads—full-scale experiments and theory. In: Proceedings of the Institution of Mechanical
Engineers, Part F: Journal of Rail and Rapid Transit, vol. 209, no. 1, pp. 39–47 (1995). https://
doi.org/10.1243/PIME_PROC_1995_209_253_02
5. Dumitriu, M., Ghe¸ti, M.A.: Cross-correlation analysis of the vertical accelerations of railway
vehicle bogie. Procedia Manuf. 32, 114–120 (2019)
6. Chen, Z., Fang, H.: An alternative solution of train-track dynamic interaction. Shock Vib.
2019, 1–14 (2019). https://doi.org/10.1155/2019/1859261
7. Chang, C., Ling, L., Han, Z., Wang, K., Zhai, W.: High-speed train-track-bridge dynamic
interaction considering wheel-rail contact nonlinearity due to wheel hollow wear. Shock
Vibr. 2019, 1–18 (2019). https://doi.org/10.1155/2019/5874678
8. Ciotlaus, M., Kollo, G., Marusceac, V., Orban, Z.: Rail-wheel interaction and its inﬂuence on
rail and wheels wear. Procedia Manuf. 32, 895–900 (2019)
9. Davis, N.T., Sanayei, M.: Foundation identiﬁcation using dynamic strain and acceleration
measurements. Eng. Struct. 208, 109811 (2020)
10. De Santiago, O., San Andrés, L.: Field methods for identiﬁcation of bearng support parame-
ters—part i: identiﬁcation from transient rotor dynamic response due to impacts. J. Eng. Gas
Turb. Power 129(1), 205–212 (2007)
11. Malekjafarian, A., OBrien, E., Quirke, P., Bowe, C.: Railway track monitoring using train
measurements: an experimental case study. Appl. Sci. 9(22) (2019)
12. Li, J., Shi, H.: Rail corrugation detection of high-speed railway using wheel dynamic
responses. Shock Vib. 2019, 1–12 (2019). https://doi.org/10.1155/2019/2695647
13. Romero, J.A., Navarrete, F.O.: A testing facility to assess railway car infrastructure damage.
A conceptual design. Int. J. Transp. Dev. Integr. 4(2), 142–151 (2020). https://doi.org/10.
2495/TDI-V4-N2-142-151
14. Singh, P., Joshi, S.D., Patney, R.K., Saha, K.: The Fourier decomposition method for nonlinear
and non-stationary time series analysis. Proc. R. Soc. A: Math. Phys. Eng. Sci. 473(2199),
20160871 (2017). https://doi.org/10.1098/rspa.2016.0871

Mechatronic Systems for Energy
Harvesting

A Three-Dimensional Piezoelectric
Timoshenko Beam Model Including
Torsion Warping
Emmanuel Beltramo1(B), Bruno A. Roccia2, Mart´ın E. P´erez Segura1,
and Sergio Preidikman1
1 Instituto de Estudios Avanzados en Ingenier´ıa y Tecnolog´ıa (IDIT) - CONICET
and Departamento de Estructuras, FCEFyN, UNC, C´ordoba, Argentina
{ebeltramo,mperezsegura}@unc.edu.ar, spreidik@umd.edu
2 Grupo de Matem´atica Aplicada, UNRC, Argentina and Instituto de Estudios
Avanzados en Ingenier´ıa y Tecnolog´ıa (IDIT) - CONICET, C´ordoba, Argentina
Abstract. In this article, the authors present a three-dimensional for-
mulation of a Timoshenko beam element intended for energy harvest-
ing. The beam cross-section is idealized as an arbitrary number of lam-
inate piezoelectric transducers embedded within an elastic substrate.
In addition, each transducer is connected to three diﬀerent electronic
components: a resistance, a capacitor, and an inductor. Unlike standard
Timoshenko-like beam theories, the model presented here is enhanced
by including warping displacements due to homogeneous torsion. The
resulting governing equations are spatially discretized through the ﬁnite
element method (FEM) and numerically integrated in the time domain
using the ODE solvers available in MATLAB R
⃝. The performance, advan-
tages and disadvantages of the proposed model are evaluated by per-
forming a mesh convergence analysis and a shear locking test. Finally,
a comparative study between the current model and an Euler-Bernoulli
model, in terms of harvested output power, is presented for diﬀerent
beam lengths.
Keywords: Energy harvesting · Timoshenko beam · Warping
function · Finite element method
1
Introduction
In last decade, the drastic reduction in size and energy requirements of elec-
tronic devices has promoted the concept of energy harvesting from environmental
sources. Mechanical vibrations of structures like wings or bridges can be turned
into electrical signals by means of transducers. This electric signal could be har-
nessed for powering a wide variety of small-sized and low-power devices such
as: wireless sensor networks for data collection, micro electromechanical devices,
and low maintenance actuators, among others. Regarding transduction mech-
anisms, piezoelectricity ranks among the top ones for transforming mechanical
c
⃝The Author(s), under exclusive license to Springer Nature Switzerland AG 2022
M. Pucheta et al. (Eds.): MuSMe 2021, MMS 110, pp. 143–150, 2022.
https://doi.org/10.1007/978-3-030-88751-3_15

144
E. Beltramo et al.
strain energy into usable electrical energy. In addition, once the electrical signal
is obtained by piezoelectric transducers, it may be used without post-processing;
feature which is often stressed as one of its main advantages.
Diﬀerent structural approaches to evaluate the response of piezoelectric
energy harvesters are available in the literature, namely: lumped-parameter mod-
els [2], analytical solutions for distributed-parameter models [4], assumed-modes
approximations [3], and some models taking into account geometric/material
non-linearities. In general, distributed-parameter models represent harvester
devices as cantilever beams, bonded by one or two piezoelectric layers, and
excited harmonically at their fundamental frequency. However, more recently,
a number of ﬁnite element formulations have been published. The versatility
of FEM-based models have made it possible to impulse the study of built-in
harvesting structures [5].
In this article, the authors expose a brief description of the most important
modeling aspects of a three-dimensional piezoelectric beam formulation. The
Timoshenko beam element presented here is enhanced by the inclusion out-of-
plane displacements due to torsion warping. Furthermore, a through-thickness
electric ﬁeld distribution is consistently integrated with Timoshenko’s theory [8].
The numerical stability and precision of the current FEM model is assessed by
performing a mesh convergence analysis and a shear locking test (for two diﬀerent
sets of shape functions). Finally, a comparative study between the current model
and an Euler-Bernoulli (EB) model is presented.
2
Model Description
The main aspects of the structural model are summarized next. As shown in
Fig. 1, the cross-section consist of an elastic substrate and nt laminate piezo-
electric transducers that can be embedded in or bonded to its exterior surfaces.
The cross-section A is decomposed in nt + 1 sub-domains Ai, i.e. A = nt+1
i=1 Ai,
where Ant+1 is the cross-section of the elastic layer, and Ai for i ranging from 1
to nt denote the cross-section of the diﬀerent piezoelectric layers. Furthermore,
each transducer is covered by a pair of electrodes, on its top and bottom surfaces.
These electrodes are assumed to be perfectly conductive and to have negligible
mechanical properties. Regarding the material properties, the elastic layer is
assumed to be homogeneous and isotropic. On the other hand, the piezoelectric
layers are idealized as transversely isotropic materials, with their isotropic plane
normal to the poling direction. A schematic representation of the k-th electrical
circuit for serial and parallel connections is shown in Fig. 1b and 1c. The circuit
is composed of a piezoelectric transducer, a resistance Rk, an inductance Lk, and
a capacitance Ck. The electric coordinate utilized to represent the conﬁgura-
tion space (C-space) of each circuit is connection-dependent. On this basis, the
electric ﬂux-linkage λk(t) and the electric charge qE
k (t) are used as generalized
electric coordinates for parallel and serial connections, respectively.
As exposed in the literature, the through-thickness electric potential varia-
tion is expressed as the sum of a linear term and a quadratic term. The quadratic

Piezoelectric Beam Formulation
145
term, known as induced potential, is proportional to bending and shear strains,
and it is often neglected in most works. Nevertheless, when the cross-section
area of each transducer is comparable to that of the elastic substrate, the eﬀect
of the induced potential is signiﬁcant and should not be omitted. Furthermore,
the overall structure stiﬀness changes as a consequence of the coupling triggered
by this term. To fulﬁll this requirement, a proper through-thickness electric ﬁeld
distribution consistent with Timoshenko’s beam theory should be derived from
the electrostatic equilibrium equation. In this work, a three-dimensional exten-
sion of the 2D electric potential term proposed by Sulbhewar and Raveendranath
[8] is considered.
Fig. 1. (a) Schematic representation of an arbitrary cross-section composed of an elastic
layer and nt piezoelectric layers. (b) Parallel RLC circuit. (c) Serial RLC circuit.
In this eﬀort, a Timoshenko beam element is assumed satisfying the follow-
ing kinematic hypothesis: i) the cross-section does not remain orthogonal to the
beam axis (X1) after deformation; ii) the cross-section does not suﬀer in-plane
deformations, which implies that in plane shear strains and Poisson’s eﬀect due to
axial strains are neglected; iii) the only out-of-plane deformations come from tor-
sion warping; iv) warping of the cross-sections remain constant along the beam
(Saint-Venant torsion hypothesis); v) the displacement of beam axis U0(X1, t) is
small compared to the beam length L; vi) the rotations of the cross-section are
small enough so that the rotation tensor Λ(X1, t) may be approximated to ﬁrst
order, that is to say Λ(X1, t) ≈I + Θ(X1, t), where I is the identity tensor and
Θ(X1, t) is a skew-symmetric tensor whose components may be interpreted as
inﬁnitesimal rotations; vii) all higher-order strain terms in the Green-Lagrange
strain tensor are neglected; viii) the substrate and the piezoelectric layers are
perfectly bonded, which means that the strain ﬁeld is continuous; and, ix) the
reference frame located at each piezoelectric layer is obtained by a translation
of the main reference frame {X1, X2, X3}. Regarding the stress-strain constitutive
relations, both materials are assumed to be linearly elastic and governed by the
generalized Hooke’s law.

146
E. Beltramo et al.
The variational formulation of the continuum is obtained from Hamilton’s
Principle for electromechanical systems. In this case, both the displacement of
beam axis U0(X1, t) and the skew-symmetric tensor Θ(X1, t) depend continuously
on space and time. On the other hand, the ﬂux-linkage λ(t) and the electric
charge q(t) only depend on time. In this regard, inertial and elastic properties of
the beam are modeled using a distributed-parameter approach, while electrical
modeling is based on a lumped-parameter formulation.
3
Finite Element Model
This section presents the FEM governing equations for the electromechanical
model described above. Following the classic approach, the one-dimensional
beam domain [0, L] is divided into nel sub-domains Ie such that [0, L] = nel
e=1 Ie
and Ii ∩Ij =  for i  j and i, j ∈{1, 2, ..., nel}. Here, each sub-domain Ie ⊂[0, le]
denotes a typical element with length le > 0 and nel refers to the total number of
elements. In this implementation, a two-node ﬁnite element with constant cross-
section is adopted. Each node has six degrees of freedom, three translations and
three rotations, which are arranged in a column array qe(t) = [q1(t), ..., q12(t)]T
e .
Within each sub-domain Ie, the continuous functions describing the beam
axis displacement U0(X1, t) and the cross-section rotations Θ(X1, t) can be approx-
imated, at the element level, as Ue
0(ηe, t) = Ne(ηe)qe(t) and Θe(ηe, t) = Pe(ηe)qe(t)
for ηe ∈[0, le], where Ne(ηe) and Pe(η) are the so-called shape function matrices.
In this work, we adopt two diﬀerent sets of interpolation functions. The ﬁrst set
of functions (called S1) is obtained from the homogeneous general solution for
a Timoshenko beam [6]. The second set (called S2) is obtained from a three-
dimensional extension of the linked interpolation procedure proposed by O˜nate
[7]. Finally, the system of electromechanical equations of motion for the e-th
ﬁnite element can be expressed as follow:
Me qe(t) +

Ke +
nsc

k=1
kK
s
e −
npc

k=1
kK
p
e

qe(t) + kθs
eqk(t) −kθp
e λk(t) = fe(t),
nsc

k=1
[kθs
e]Tqe(t) + 1
Cs
k
qE
k (t) + Rk qE
k (t) + Lk qE
k (t) = 0,
npc

k=1
[kθ p
e ]Tqe(t) + Cp
k λk(t) + 1
Rk
λk(t) + 1
Lk
λk(t) = 0,
(1)
where Me is the local mass matrix, Ke is the local elastic stiﬀness matrix, fe(t)
is the local nodal force vector, kKs
e (kKp
e ) denotes the local stiﬀness matrix
induced by the k-th serial (parallel) circuit, kθs
e (kθ p
e ) represents the k-th local
electromechanical coupling vector associated with the serial (parallel) circuit, nsc
(npc) indicates the number of serial (parallel) circuits, and the over-dot stands

Piezoelectric Beam Formulation
147
for diﬀerentiation with respect to time. It should be mentioned that Cs
k (Cp
k )
represents the equivalent capacitance of the k-th serial (parallel) circuit, which
collects both the inherent piezoelectric material capacitance and the external
capacitance. All matrices (vectors) introduced above belongs to R12×12 (R12).
4
Numerical Results
In this section, the authors present two simple case studies. In the ﬁrst case,
the previously introduced beam element is analyzed by conducting a mesh con-
vergence study along with a shear locking test for both sets of shape functions
(S1 and S2). In the second case, the output power for a typical cantilever energy
harvester is estimated. The outcomes are compared against those obtained from
a EB-based model.
4.1
Case I
This subsection aims to assess the performance of the beam element developed.
For this purpose, a simply supported square cross-section beam is considered.
The structural member is entirely made of an aluminum elastic substrate with-
out piezoelectric layers, whose mechanical properties are presented by Beltramo
et al. [1]. Figure 2 shows a beam schematic, where b denotes the cross-section
dimension and L indicates the beam length.
Fig. 2. (a) Schematic of a beam discretized by nel ﬁnite elements and nn nodes. (b)
Cross-section of the beam.
The ﬁrst (1F) and the third (3F) beam vibration natural frequencies are
adopted as parameters for both analysis (mesh convergence and shear locking
test).

148
E. Beltramo et al.
Fig. 3. (a) Variation of 1F with nel for both sets of shape functions. (b) Variation
of 3F with nel for both sets of shape functions. (c) 1F - Relative percentage diﬀer-
ence between the current and an Euler-Bernoulli model. (d) 3F - Relative percentage
diﬀerence between the current and an Euler-Bernoulli model.
Figures 3a and 3b present the evolution of the ﬁrst and third natural fre-
quencies as a function of the number of elements. For a coarse mesh, it can be
observed that the results given by S1 are closer to the analytical frequencies than
those given by S2. However, as the number of elements increases, the frequen-
cies obtained with the set S2 approach the analytical solution faster than those
obtained with S1. In consequence, the set S2 is more accurate than the set S1 for
the same number of elements when a ﬁne mesh (≈nel > 16) is utilized.
On the other hand, Figs. 3c and 3d shows the evolution of the relative dif-
ference between the current model and an EB-based model [1] for 1F and 3F.
Results show that such diﬀerence is less than 1% when β > 15 for both fre-
quencies. Clearly, as the parameter β increases, the relative diﬀerence between
models decreases signiﬁcantly for both sets of shape functions. Therefore, one
can infer that both S1 and S2 can avoid the shear locking phenomenon.

Piezoelectric Beam Formulation
149
4.2
Case II
In this subsection, the output power of a cantilever harvester device harmonically
excited at its fundamental natural frequency (ω) is analyzed.
Fig. 4. (a) Cantilever harvester device with two pure resistive loads. (b) Cross-section
of the beam (b = 10 mm). Both piezoelectric layers have a thickness t = 0.26 mm.
As it can be observed in Fig. 4, the cross-section of the beam is composed of a
square elastic substrate bonded by two piezoelectric layers located on the upper
and lower surfaces. As before, b denotes the width and the height of the elastic
substrate, t is the piezoelectric layer thickness, and L indicates the beam length.
For simplicity, two purely resistive electrical circuits are considered. As the Case
I, the mechanical properties for both materials are adopted from Beltramo et al.
[1]. Additionally, a proportional damping matrix is added such that the damping
ratio ζ of the ﬁrst two vibration modes is 0.1. To avoid overcrowded the ﬁgures,
in this subsection only the results obtain using the set of shape functions S2 are
presented.
Fig. 5. (a) Maximum output power as a function of β. (b) Relative percentage diﬀerence
between the estimations of maximum output power obtained using Timoshenko and
Euler-Bernoulli theories.
The maximum output power for low values of β shows an exponential growing
for both the current model and EB-based model (see Fig. 5a). However, from
a certain value of β the output power behavior becomes linear. Furthermore,
a discrepancy between these models can be observed for low values of β (see

150
E. Beltramo et al.
Fig. 5b). Such a discrepancy can be attributed, at ﬁrst, to the inﬂuence of shear
deformations on the piezoelectric behavior. As it is well-known, as the beam
slenderness decreases, beam theories based on Euler-Bernoulli hypothesis become
inaccurate. This drawback can be overcome by resorting to more sophisticated
theories, such as a Timoshenko formulation. Summarizing, it is convenient to
employ a Timoshenko model rather than an EB-based model when β < 10.
5
Conclusions
In this work, a brief summary of the most important aspects of a three-
dimensional formulation of a piezoelectric Timoshenko beam model for energy
harvesting is presented. Some important inferences can be deduced from the
preceding sections. Both sets of shape functions showed excellent behavior for
a wide range of β values, which means that they can successfully avoid shear
locking phenomena. However, the set S1 exhibited a better behavior for coarse
meshes, while the set S2 showed a faster convergence than S1 as the number of
elements increases.
Finally, as the beam slenderness decreases (β < 15) it is convenient to switch
to a Timoshenko formulation to better estimate the power harvested by a piezo-
electric beam. On the contrary, as β increases, the power calculated by using
either Timoshenko’s theory or EB-based models get closer to each other (diﬀer-
ence of 1% for β > 15). In this way, for β > 15, the eﬀect of shear deformations
(on the harvested electrical power) becomes negligible and, therefore, the use of
EB-based models is recommended.
References
1. Beltramo, E., Balachandran, B., Preidikman, S.: Three-dimensional formulation of
a strain-based geometrically nonlinear piezoelectric beam for energy harvesting.
J. Intell. Mater. Syst. Struct. 1045389X20988792 (2020). https://doi.org/10.1177/
1045389X20988792
2. Dutoit, N.E., Wardle, B.L., Kim, S.G.: Design considerations for mems-scale piezo-
electric mechanical vibration energy harvesters. Integr. Ferroelectr. 71(1), 121–160
(2005)
3. Erturk, A.: Assumed-modes modeling of piezoelectric energy harvesters: Euler-
Bernoulli, Rayleigh, and Timoshenko models with axial deformations. Comput.
Struct. 106, 214–227 (2012)
4. Erturk, A., Inman, D.J.: A distributed parameter electromechanical model for can-
tilevered piezoelectric energy harvesters. J. Vibr. Acoust. 144(3), 15 (2008). Article
ID 041002
5. Junior, C.D.M., Erturk, A., Inman, D.J.: An electromechanical ﬁnite element model
for piezoelectric energy harvester plates. J. Sound Vib. 327(1–2), 9–25 (2009)
6. Luo, Y.: An eﬃcient 3D Timoshenko beam element with consistent shape functions.
Adv. Theor. Appl. Mech 1(3), 95–106 (2008)
7. O˜nate, E.: Structural Analysis with the Finite Element Method. Linear Statics:
Volume 2: Beams, Plates and Shells. Springer, Heidelberg (2013)
8. Sulbhewar, L.N., Raveendranath, P.: An accurate novel coupled ﬁeld Timoshenko
piezoelectric beam ﬁnite element with induced potential eﬀects. Latin Am. J. Solids
Struct. 11(9), 1628–1650 (2014)

On the Eﬀect of Hardening/Softening
Structural Non-linearities on an Array
of Aerodynamically Coupled Piezoelectric
Harvesters
Bruno A. Roccia1,2(B), Marcos L. Verstraete1, Luis R. Ceballos1,
Grigorios Dimitriadis3, and Sergio Preidikman2
1 Grupo de Matem´atica Aplicada, Universidad Nacional de R´ıo Cuarto,
Ruta Nacional 36, Km 601, R´ıo Cuarto, Argentina
{broccia,mverstraete,lceballos}@ing.unrc.edu.ar
2 CONICET, Consejo Nacional de Investigaciones Cient´ıﬁcas y Tecnol´ogicas,
Dep. de Estructuras, F.C.E.F.yN., Universidad Nacional de C´ordoba,
C´ordoba, Argentina
spreidik@umd.edu
3 Department of Aerospace and Mechanical Engineering, University of Li`ege,
All´ee de la D´ecouverte 9, 4000 Li`ege, Belgium
gdimitriadis@uliege.be
Abstract. In this work, we study the non-linear dynamic response
of two vertically-arranged aero-piezoelastic harvesters. The numerical
framework consists of the following: i) an aerodynamic model based
on the unsteady vortex-lattice method; ii) a three degree-of-freedom
lumped-parameter model for each harvester; iii) an inter-model connec-
tion to exchange information between models at each time step; and iv) a
numerical scheme based on Hamming’s fourth-order predictor–corrector
method to integrate all the governing equations. Particularly, the eﬀect of
nonlinear hardening/softening springs on the harvested output power is
investigated. Among the results obtained, an interesting ﬁnding is that
hardening springs yield larger LCO amplitudes and higher harvested
power than softening springs.
Keywords: Energy harvesting · Structural nonlinearities · UVLM ·
Piezoelectricity · Aeroelastic ﬂutter
1
Introduction
Recent improvements in the development of small-sized, low-power, portable,
and remote devices have promoted the concept of harvesting energy from envi-
ronmental sources [1]. Particularly, those designs which extract energy from the
wind (through aeroelastic phenomena) have become a key option for power-
ing small electronic devices in remote and diﬃcult-to-access areas (Antarctica,
suspension bridges, skycrapers, etc.).
c
⃝The Author(s), under exclusive license to Springer Nature Switzerland AG 2022
M. Pucheta et al. (Eds.): MuSMe 2021, MMS 110, pp. 151–158, 2022.
https://doi.org/10.1007/978-3-030-88751-3_16

152
B. A. Roccia et al.
Among the diﬀerent aeroelastic phenomena, ﬂutter has been extensively stud-
ied over several decades, as this instability has been a key for many catastrophic
accidents in aeronautical and civil structures. However, scientists have envis-
aged the possibility of using this nonlinear phenomenon as a desirable means for
electric energy generation.
Since the mid-2000s, several works have been published on ﬂutter-based
energy harvesters (FEH) [9]. Although these works have provided new insights on
the design of harvester devices, the risks and potential of energy harvesting from
wing aeroelastic systems can be best evaluated by means of nonlinear analysis
[2,3,6]. Actually, an aeroelastic system can exhibit a wide variety of nonlinear
responses, such as: limit-cycle oscillations (LCOs) [10], bifurcations [4], internal
resonances [11], and chaotic motions [5]. These possibilities make the analysis of
FEH much more complex and expensive (from a computational point of view)
than linear analysis. Despite the progress made, most works in the literature
highlight the low amount of energy produced by aeroelastic harvesters; a fact
that has driven diﬀerent proposals to make this technology sustainable, such as
the idea of using harvester arrangements to enhance the power output over a
wide range of wind speeds [7,8,15]. Notwithstanding these pioneering studies,
the integration of several harvesters as a possible technological solution involves
a large number of challenges, among which, the output power dependence on
the spatial distribution of harvesters and the eﬀect of structural non-linearities
remain poorly understood topics.
This work is an extension of the study by Roccia et al. [15], whose main
goal is to shed some light on the eﬀect of structural non-linearities on the aero-
piezoelastic behavior of harvester arrays. Although the piezoelastic model is sim-
ilar to that used in [9,15], the 3-degree-of-freedom (3-DOF) lumped-parameter
approach presented here is enhanced by including nonlinear springs. The loads
coming from the ﬂow ﬁeld around each harvester are predicted using a two-
dimensional (2D) version of the unsteady vortex-lattice method (UVLM).
2
Numerical Framework for Aero-Piezoelastic
Simulations
In this section, we present a brief description of the aero-piezoelastic framework
used to study the dynamic and aerodynamic behavior of harvester arrays. The
numerical tool is designed by following a co-simulation strategy, where the entire
system is partitioned into two subsystems: i) the piezoelastic model (called Sim-
ulator 1), and ii) the aerodynamic model (called Simulator 2). Although these
subsystems come from diﬀerent modeling processes, the coupling procedure is
strong because information can be bi-directionally exchanged, and the chosen
time step advance is the same for both models. The numerical scheme used by
Simulator 2 is well-known and can be found in the literature [14]. On the other
hand, the numerical procedure adopted for Simulator 1 to solve the equations
of motion (EoMs) of the harvester array is based on Hamming’s fourth-order
predictor–corrector method.

On the Eﬀect of Hardening/Softening Structural Non-linearities
153
Fig. 1. Left: Array of two harvesters, Right: Scheme of a piezo-aeroelastic harvester.
2.1
Piezoelastic Model
The array of harvesters analyzed here consists of two vertically-separated aero-
piezoelastic devices; each of them idealized as a two-dimensional airfoil (see
Fig. 1). The elastic properties of each harvester are modeled through a lumped-
parameter approach, where the torsional and bending stiﬀnesses are represented
by nonlinear springs. Under these assumptions, the conﬁguration space (or c-
space) for the k-th harvester can be described by Ck = R2 × SO(2), where
SO(2) is the special orthogonal group in two dimensions. On this basis, the
conﬁguration coordinate vector qk(t) ∈Ck is given by qk(t) = (h(t), θ(t), V (t))T
k ,
where h(t) is the plunging displacement, θ(t) is the pitching angle, and V (t) is
the voltage generated.
Due to the lack of constraint equations in the system, the number of degrees-
of-freedom for each piezoelastic airfoil is equal to the c-space dimension, i.e.,
nDOF = dim(Ck) = 3. It follows that the DOF number for the entire system is
NDOF = N nDOF , where N is the number of harvesters. In this work N = 2,
and therefore NDOF = 6. It should be stressed that the piezoelectric materials
are only activated by the plunge degree of freedom.
The aero-piezoelastic equations of the system presented in Fig. 1 are obtained
by modifying the linear aeroelastic equations of a typical section [12]. Following
the same procedure as in prior studies [9,15], the EoMs for one aero-piezoelastic
harvester are obtained in matrix form as,

m + mf
mxθb cos θ
mxθb cos θ
IP

k
¨h
¨θ

k
+

dh 0
0 dθ

k
˙h
˙θ

k
−
 λ
l V
0

k
+

mxθb ˙θ2 sin θ
0

k
+
k1,h
0
0
k1,θ

k
h
θ

k
±
k2,h h3
k2,θ θ3

k
=
La(t) cos θ
Ma(t)

k
,

λ ˙h + Ceq ˙V + 1
RV

k
= 0,
(1)
where m is the airfoil mass per length, mf accounts for the ﬁxture mass per
length, IP is the moment of inertia per length about the reference point (spring

154
B. A. Roccia et al.
joints), b is the semichord length, l is the span length, xθ is the dimensionless
chordwise oﬀset of the reference point from the mass center (mc), dh (dθ) is
the structural damping coeﬃcient in the plunge DOF (pitch DOF), k1,h (k1,θ)
is the linear stiﬀness per length in the plunge DOF (pitch DOF), k2,h (k2,θ)
is the nonlinear stiﬀness per length in the plunge DOF (pitch DOF), La is the
aerodynamic lift per length, Ma is the aerodynamic pitching moment per length,
R is the load resistance, Ceq is the equivalent capacitance of the piezoceramic
layers, λ is the electromechanical coupling term, and the overdot represents
diﬀerentiation with respect to time.
It should be noted that the spring non-linearities are of cubic order. Conse-
quently, it is possible to account for a hardening/softening behavior according
to the sign of the term which collects the stiﬀness k2,h and k2,θ.
Finally, the EoMs for the complete dynamic system shown in Fig. 1 are
obtained by assembling the EoMs for each harvester. Due to the uncoupled
nature of the system, from a mechanical point of view, the global mass, damp-
ing and stiﬀness matrices are all in block diagonal form. The set of ODEs is only
coupled through the aerodynamics forces, which are included on the right-hand
side.
2.2
Aerodynamic Model
The main objective of the aerodynamic model is to predict the forces coming
from the surrounding ﬂow on the array of harvesters. On this basis, the authors
have adopted a two-dimensional version of the well-known UVLM to compute
the aerodynamic loads. A signiﬁcant advantage of the UVLM is the desirable
trade-oﬀbetween a relatively high precision (in terms of capturing all possible
aerodynamic interferences) and a moderate computational cost when compared
to ﬂow solvers based on computational ﬂuid dynamics (CFD) techniques.
Vortex methods are based on the spatial discretization of the continuous vor-
tex sheets into straight elements of concentrated vorticity. As a consequence, the
vorticity of each element has associated with it a single point vortex (denoted as
vortex point, VP) whose circulation is such that the non-penetration condition
is satisﬁed at the so-called control points (CPs) (see Fig. 2). The imposition of
the no-penetration condition at each CP along with Kelvin’s circulation theorem
leads to a set of linear algebraic equations for the harvester system, whose solu-
tion allows to obtain the circulations Γk associated with all of the aerodynamic
elements making up the array of harvesters, as well as, all those vortices located
at the trailing edges.
Then, the aerodynamic loads acting on the airfoils are computed by the
following three steps: i) for each element, the pressure jump ΔCp at the control
point is computed by integrating the unsteady Bernoulli equation [15]; ii) the
force on the j-th aerodynamic element is computed as the product of the pressure
jump times the element area times the normal unit vector located at the j-th
CP; and iii) the resultant forces and moments are computed as the vector sum
of the forces and their moments about a common point. For the k-th harvester,
the external load vector, Fk = (La cos θ, Ma)T
k , is given by,

On the Eﬀect of Hardening/Softening Structural Non-linearities
155
Fig. 2. Discretization of bounded-vortex sheets and free-vortex sheets.
Fk = 1
2ρ∞V 2
∞
⎛
⎝−cos θk
ne

j=1
(ΔCp)j,
ne

j=1
(ΔCp)jxj
⎞
⎠
T
,
(2)
where ρ∞is the air density, V∞is the magnitude of the free-stream velocity
vector, xj is the distance from the j-th CP to the reference point (here the
spring joint), and ne is the number of aerodynamic elements per harvester. Once
the loads have been computed, each VP of the wakes is “convected” to its new
position by means of a ﬁrst-order method; for instance, the Euler method. For
a detailed description of the UVLM, the reader is referred to [13–15].
3
Numerical Results
In this section, the authors present a postcritical analysis for two vertically-
separated harvesters obtained from the implementation in Fortran 90 of the
proposed methodology. Since the most expensive part of the simulation process is
associated with the aerodynamic simulator, speciﬁcally the wake convection, the
code has been explicitly parallelized by using a domain decomposition strategy
via an OpenMP* library.
The simulation framework presented in this work has been veriﬁed and vali-
dated by comparing the response of an isolated harvester against the analytical
and experimental data reported by Erturk et al. [9]. The experiment carried out
by Erturk’s team consists of an airfoil connected to the ground through four steel
beams, of which two have two PZT-5A piezoceramic patches attached close to the
ﬁxed ends in a symmetrical conﬁguration. For their analytical model, they used
a linear lumped-parameter two-dimensional approach along with Theodorsen’s
unsteady thin airfoil theory for predicting the aerodynamic loads.
The ﬂutter speed VF obtained through numerical simulations, for 30 aero-
dynamic elements, is 9.451 m/s. Although it is slightly lower than the ana-
lytical value of 9.56 m/s reported by Erturk et al., the relative error is only
1.14%. It should be mentioned that the discretization used for the bound vortic-
ity sheet comes from a convergence study carried out in advance, which shows
that increasingly dense aerodynamic meshes allows this error to be substantially
reduced [15]. On the other hand, the experimental VF reported by Erturk et al.

156
B. A. Roccia et al.
is 9.3 m/s, which represents an excellent agreement with the current predicted
value (relative error of 1.6%). For more details on the veriﬁcation and validation
process of the numerical framework, the reader is referred to [15].
3.1
Case Study
In this subsection, we study the eﬀect of nonlinear springs (hardening/softening)
on an array of two harvesters, separated at d = b, operating in a postcritical
region. Both piezoelectric and structural data used here are the same as those
used in [9,15], which are: λ = 1.55 mN/V, Ceq = 120 nF, m = 1.7799 Kg/m,
mf = 2.8425 Kg/m, Ip = 7.06445 × 10−3 Kgm, b = 0.125 m, xθ = 0.260, l = 0.5
m, k1,h = 4.6808 × 103 N/m2, k1,θ = 1.67540 N, dh = 9.6110 × 10−1 Ns/m2,
dθ = 1.32504 × 10−2 Ns, and R = 100 kΩ. In this ﬁrst stage, we adopt the
following values for the nonlinear spring stiﬀness: (k2,h, k2,θ) = CspX (k1,h, k1,θ)
for Csp = +/ −1, +/ −3, +/ −5. It should be noted that the optimal resistive
load R calculated for a single harvester is not necessarily the optimum value for
the array of harvesters like the one proposed in this study.
In Fig. 3a we show the Hopf bifurcation associated with the plunging motion
for d/b = 1. As can be gathered, this bifurcation is supercritical, and hence, the
LCOs occur above the ﬂutter speed. For a hardening spring with Csp = 5, the
plunge LCO amplitude initially increases, reaches a maximum, and then begins
to decrease. This trend was found to be quite similar to the results considering
linear stiﬀness springs reported by Roccia et al. [15]. Further increments of the
wind speed beyond V = 8.5 m/s result in a substantial change in the nature
of the plunge-LCO phase portrait (period 2 motion). As the nonlinear stiﬀness
decreases, the shape-change point is shifted to the right. Although for softening
springs (with Csp = 3 and Csp = 5) the appearance of period 2 motions seems
to disappear, they are expected to arise for higher air velocities (larger than 9.00
m/s). In this work, the LCO amplitudes were determined by means of a standard
least-squares ﬁtting procedure for ellipses [15]. Similar behavior was found for
the pitching response.
Regarding the eﬀect of hardening/softening springs on the aero-piezoelastic
response, a clear increase in the LCO amplitudes and mean output power
(Fig. 3b) can be observed as we move from Csp = −5 (softening) to Csp = +5
(hardening). In principle, this increase can be attributed to the following fact:
the more rigid a structure is, the higher its frequency of oscillation. In conse-
quence, its motion will be characterized by higher velocities. Oversimplifying
the situation, mechanical power ultimately depends on the force and velocity,
therefore it can be surmised that, in general, hardened spring-based harvester
systems will increase energy harvesting.
According to [15], the introduction of a second harvester into the system
produces the undesired eﬀect of decreasing the output power. However, for two
harvesters separated by d/b = 1, the ﬂutter onset speed decreases from 9.451
to 7.78 m/s (about 18% lower than the ﬂutter speed for a single harvester).
This fact highlights the tremendous advantage of generating energy, at low wind
speeds, by means of an arrangement of harvesters. On this basis, the design of

On the Eﬀect of Hardening/Softening Structural Non-linearities
157
Fig. 3. (a) Plunging LCO amplitude versus free-stream speed for d/b = 1. A super-
critical Hopf bifurcation occurs at 7.78 m/s, (b) Mean output power. Solid line with
circular markers indicates Csp = 5, dotted line indicates Csp = 3, and solid line indi-
cates Csp = 1.
self-conﬁguring harvester arrays with hardening structural members will allow
us to increase the harvested energy over a wide range of wind speeds.
4
Conclusions
In this work, a simulation framework for studying the nonlinear aero-piezoelastic
behavior of an array of two vertically-separated harvesters has been presented.
Some important preliminary conclusions can be drawn from the preceding sec-
tions. The use of hardening/softening springs was found to have an interesting
inﬂuence on the mean output power. Speciﬁcally, when the spring stiﬀness is
changed from Csp = −5 (softening) to Csp = +5 (hardening), both the LCO
amplitudes and the harvested power show a signiﬁcant increase. At ﬁrst, this
behavior is attributed to the high frequencies of oscillation that take place as a
consequence of the stiﬀening of the structure.
Although more investigations are needed, these ﬁndings suggest the strong
possibility of using airfoil arrays with hardening features as harvester devices for
energy generation over a wide range of wind speeds.
Acknowledgements. The
authors
gratefully
acknowledge
the
partial
support
received from the Consejo Nacional de Investigaciones Cient´ıﬁcas y T´ecnicas (CON-
ICET), Argentina.
References
1. Energy harvesting: What is energy harvesting (2014). http://www.energyharv
esting.net/

158
B. A. Roccia et al.
2. Abdelkeﬁ, A., Ghommem, M., Nuhait, A., Hajj, M.: Nonlinear analysis and
enhancement of wing-based piezoaeroelastic energy harvesters. J. Sound Vib.
333(1), 166–177 (2014)
3. Abdelkeﬁ, A., Nayfeh, A.H., Hajj, M.: Modeling and analysis of piezoaeroelastic
energy harvesters. Nonlinear Dyn. 67(2), 925–939 (2012). https://doi.org/10.1007/
s11071-011-0035-1
4. Abdelkeﬁ, A., Vasconcellos, R., Marques, F.D., Hajj, M.R.: Bifurcation analysis
of an aeroelastic system with concentrated nonlinearities. Nonlinear Dyn. 69(1),
57–70 (2012). https://doi.org/10.1007/s11071-011-0245-6
5. Afonso, F., Vale, J., Oliveira, ´E., Lau, F., Suleman, A.: A review on non-linear
aeroelasticity of high aspect-ratio wings. Prog. Aerosp. Sci. 89, 40–57 (2017)
6. Bae, J.S., Inman, D.J.: Aeroelastic characteristics of linear and nonlinear piezo-
aeroelastic energy harvester. J. Intell. Mater. Syst. Struct. 25(4), 401–416 (2014)
7. Beltramo, E., P´erez Segura, M.E., Roccia, B.A., Valdez, M.F., Verstraete, M.L.,
Preidikman, S.: Constructive aerodynamic interference in a network of weakly cou-
pled ﬂutter-based energy harvesters. Aerospace 7(12), 167 (2020)
8. Bryant, M., Mahtani, R.L., Garcia, E.: Wake synergies enhance performance in
aeroelastic vibration energy harvesting. J. Intell. Mater. Syst. Struct. 23(10), 1131–
1141 (2012)
9. Erturk, A., Vieira, W., De Marqui Jr, C., Inman, D.J.: On the energy harvesting
potential of piezoaeroelastic systems. Appl. Phys. Lett. 96(18), 184103 (2010)
10. Eskandary, K., Dardel, M., Pashaei, M.H., Kani, A.M.: Eﬀects of aeroelastic nonlin-
earity on ﬂutter and limit cycle oscillations of high-aspect-ratio wings. In: Applied
Mechanics and Materials, vol. 110, pp. 4297–4306. Trans Tech Publ (2012)
11. Gilliatt, H.C., Strganac, T.W., Kurdila, A.J.: An investigation of internal reso-
nance in aeroelastic systems. Nonlinear Dyn. 31(1), 1–22 (2003). https://doi.org/
10.1023/A:1022174909705
12. Hodges, D.H., Pierce, G.A.: Introduction to Structural Dynamics and Aeroelastic-
ity, vol. 15. Cambridge University Press, Cambridge (2011)
13. Katz, J., Plotkin, A.: Low-Speed Aerodynamics, vol. 13. Cambridge University
Press, Cambridge (2001)
14. Preidikman, S.: Numerical simulations of interactions among aerodynamics. Ph.D.
dissertation, Department of Engineering Science and Mechanics, Virginia Polytech-
nic Institute and State University, Blacksburg, VA (1998)
15. Roccia, B., Verstraete, M., Ceballos, L., Balachandran, B., Preidikman, S.: Com-
putational study on aerodynamically coupled piezoelectric harvesters. J. Intell.
Mater. Syst. Struct. 31(13), 1578–1593 (2020)

Hybrid System Design for Energy Harvesting
from Low-Amplitude Ocean Waves
Gabriel Gutiérrez-Diaz1
, Arturo Solis-Santome2
,
and Christopher René Torres-SanMiguel2(B)
1 Instituto Politécnico Nacional, Escuela Superior de Ingeniería y Arquitectura,
07738 Mexico City, Mexico
gagutierrez@ipn.mx
2 Instituto Politécnico Nacional, Escuela Superior de Ingeniería Mecánica y Eléctrica, SEPI
Unidad Zacatenco, 07738 Mexico City, Mexico
{asoliss,ctorress}@ipn.mx
Abstract. This paper describes a hybrid system design consisting of a marine noz-
zle and a wave energy converter to enhance energy harvesting from low-amplitude
ocean waves. The main goal of the proposed design is to get energy from water
sea waves. Laboratory experiments show the efﬁciency and effects for the energy
conversion/harvesting system in the case of three sets of low-amplitude waves
against the designed nozzle’s hybrid system with a mechanical wave converter to
store the energy in a laboratory tank. The results show a satisfactory operation of
the system managing low-amplitude sea waves to produce energy conversion.
Keywords: Design · Energy sustainable systems · Energy wave converter ·
Hybrid marine nozzle system · Low -amplitude sea waves · Lab testbed
1
Introduction
The global energy consumption in 2018 was 14,230 Mtoe/165,500 TWh/year [1], the
potential energy in oceans is estimated at 80 000 TWh/year [2]. This resource is a chal-
lenge and alternative exploitation of ocean waves, tidal movements, gradient thermal or
saline at sea [3, 4]. Compared with wind or solar energy, wave energy has more signif-
icant advantages due to its availability most of the year and the time of day [5, 6]. A
wide variety of harvesting devices for wave energy had built (DCEU) [7]. These still
have unfavourable aspects of comprehensive safety, reliability, economics, or mainte-
nance, so there is no mainstream technology for harvesting energy from the sea. [8, 9].
Additionally, there is no consensus for the design of WECs, or else, there is a need to
establish protocols for their design and testing in extreme weather conditions to achieve
their survival [10].
A wave energy converter (WEC) is a concept used to crop power from ocean waves.
Asaconsensus,WECsworkontheprincipleofanactivatedbodythatoscillatesrelativeto
a ﬁxed part of the device due to wave action. The WECs are classiﬁed into four categories:
those that use the ocean waves’ kinetic energy, tidal induced currents, ocean currents,
© The Author(s), under exclusive license to Springer Nature Switzerland AG 2022
M. Pucheta et al. (Eds.): MuSMe 2021, MMS 110, pp. 159–167, 2022.
https://doi.org/10.1007/978-3-030-88751-3_17

160
G. Gutiérrez-Diaz et al.
and thermic gradient or saline [11]. WECs, which harness ocean waves, categorize them
on their operation principle, size, or how they interact with ocean waves [12]. According
to this principle, there are three predominant design types: oscillating body (WAB),
oscillating water column (OWC), and overtopping wave (OTD). Currently, WAB WECs
include three categories: point extraction, attenuators, and terminators [13], which are
classiﬁed according to the power take-off (PTO) system, which has the function of
converting the kinetic energy of the waves into electrical energy [14]. Mexico has 11
122 km of coastline and is considered a country with high potential for energy production
from marine sources, especially the area of California Gulf (Sea of Cortés) [15]. On the
southwest coast (Paciﬁc Ocean side), the wave potential is lower, in the order of 10 kW/m
[16].
This work aims to design a wave energy harvesting mechanism using a hybrid system
of a marine nozzle (MN) and a mechanical WEC. The work organization is as follows:
In material and methods, it ﬁnds a series of steps leading to a hybrid system design.
The results show equipment capable of harvesting energy from waves, and the con-
clusions show a rich discussion of the energy harvesting parameters evaluated through
experimental tests.
2
Design Requirements and Experimental TESTBED
Most WECs, are designed to work in deepwater areas since the wave’s energy decreases
signiﬁcantly to the coastline located at latitudes more signiﬁcant than 30°, resulting
in good efﬁciency in capturing energy. The minimum height wave used by WECs is
designed greater than 2m, limiting for locations where the wave height is less than this
value [17]. This paper uses the following methodological (Fig. 1) framework to design
a hybrid system of harvesting wave energy.
Fig. 1. Block diagram of the design hybrid crop energy
2.1
Hybrid System; Marine Nozzle + Wave Energy Converter
The Marine Nozzle (MN) walls were constructed with 22 plastic buckets ﬁxed to the
tank’s bottom by gravity for the initial stage. Measures cubes are 300 x 250 x 450 [mm],

Hybrid System Design for Energy Harvesting
161
arranged in two rows of vertical walls that form a converging channel with a nozzle
shaped, Fig. 2a. The WEC is implemented in the system as an oscillating body (the
extraction point). Consider or interact with an incident wave to regulate low amplitude
in the system hybrid MN-WEC prototype. The scale used for the wave was 1:10 in a wave
tank of 7 m x 11 m. Marine nozzle causes an exchange of waves incident momentum to
the walls, causing a ﬂow energy zone more densely, enabling this energy to be harvested
by WEC installed. The design criteria of the WECs (Fig. 2b) are based on some general
rules [18], as well as design guidelines that consider economic aspects [19].
Fig. 2. Hybrid system arrangement; a) Marine Nozzle (MN), b) Wave Generator (WG)
The wave generator (WG) consists of a steel palette of 0.80 × 7 m, actuated by a
transmission with a variable speed of 3 kW and is located at the beginning of the waves
tank. The WG speed variation is carried on by ﬁnite steps, with regular wave spectra
(Fig. 3).
 
WG = wave generator (flat paddle).
θ = angle of oscillation of the blade
= elevation above water level
h = depth of wave tank
=medium level water surface
= phase velocity (wave speed)
Fig. 3. Wave generator
The operating was adjusted to reproduce 3 sets of regular wave spectra (Fig. 4).
The mathematical model to quantify the incident energy (1) in the DCEU ﬂoat
considers the parameters of the height of the signiﬁcant wave (H0), period (Te) in addition
to the density of the water (ρ°) and the typical gravitational acceleration (g) and for the

162
G. Gutiérrez-Diaz et al.
1. Movable trowel generator paddle.
2. Wave train.
3. Symmetrical vertical walls (Nozzle)
4. Energy harvest area.
Fig. 4. MN-WEC location in the wave tank.
wave height above graphical water level (2).
P = ρg2
64π H 2
o Te
(1)
ηG = ηmax cos(ωt −kx)
(2)
Where:
ηG = wave elevation respect of z0 at any interesting point.
ηmax = ultimate amplitude.
ωt = phase of wave (where t it’s time).
(x) = position of wave on + x direction.
(k) = wave number.
For regular incident waves, an energy analysis was considered. The application of
the black box model was chosen to obtain an approximation of the Analysis of the
phenomenon (Fig. 5).
F = float of the WEC
P = vertical facing crest
ho = crop area depth
= elevation above water level
=medium level water surface
Fig. 5. MN harvesting zone.

Hybrid System Design for Energy Harvesting
163
An oscillating body makes the WEC design of point extraction activated by the swell.
It consists of a 4-bar mechanism with one degree of freedom, which at the free end has
a prismatic ﬂoat installed to capture the wave energy, and at the other, it transmits the
torque received to the PTO’s shaft. The PTO is a multiplier transmission box that receives
the torque from the oscillating arm and handover it to an electric generator’s shaft. It has
a pair of unidirectional clutches to transfer power in a single direction of rotation to the
generator, taking advantage of the arm’s oscillation cycle with ﬂoat (Fig. 6).
Fig. 6. WEC block diagram
The following table lists the components and speciﬁcations of the WEC device (Table
1).
Table 1. WEC components
Float
A prismatic body made of 3 mm thick acrylic sheet
with external dimensions 40 × 35 × 14 cm
Swingarm
Four bars mechanism articulated made with tubular
aluminum 10 mm diameter with longitudes L1 = L2
= 10 cm and L3 = L4 = 38 cm
Arm swing axis and transmission input
Steel of 8 mm diameter × 1 4 0 mm long, supported
on bushings Nylamid self-lubricate
Transmission gear train
The number of teeth (Z) of multiplier transmission
gears are: Z1 = 50, Z2 = 10, Z3 = 38 and Z4 = 11,
made with Nylamid
Transmission output shaft
Steel 8mm diameter ground x length 158mm,
supported on self-lubricating Nylamid bushings
Coupling with generator shaft
Flexible silicone. Dimensions D = 18 mm × d =
8 mm × L = 22 mm
(continued)

164
G. Gutiérrez-Diaz et al.
Table 1. (continued)
Electric generator
24 VDC, 2 A
The frame (chassis)
Steel sheet caliber 18. General measures 110 mm ×
120 mm × 8 mm of perimeter fold to increase rigidity
Assembly system
Galvanized steel screws d = 5/32 inch x L = 3/8 inch
thread 32 unf
Clutches
Double cam clutch with two gear sets output Z3 = 38
and Z4 = 11
Flywheel
It is mounted on the shaft of the electric generator to
stabilize shaft rotation
3
Experimental Results
The proposed mechanisms were adjusted to perform three series of 5 tests with a duration
of 7 min each, varying the wave frequency and the angle of the MN faces, to reproduce
7 cm high waves at a scale of 1:10 at the nozzle inlet. The (h) and (ho) strains are 0.50
and 0.35 m, respectively, in all tests (Table 2).
The results shown in the table establish that for angles between the nozzle faces of
90°, the incident wave train in the MN inlet section tends to produce a considerable
reﬂection within it. Therefore, the waves in that area act destructively against each other,
making it impossible for the swell to grow, which may be optimal for harvesting energy
within the nozzle. However, in the tests with an angle of 60°, the MN usable energy is
signiﬁcant, so the waves’ caused is not optimal. Test series with the angle of 34° achieved
within the nozzle a remarkable growth up to around 3.4 times of wave height, which
is at the same input, thanks to the exchange of momentum with the nozzle’s internal
walls. The frequency with which the waves affect the nozzle does not reﬂect signiﬁcant
changes in the wave’s height.
MN-WECs systems in marine farms, it is possible to crop energy even on low-
amplitude wave areas, and the additional beneﬁt of signiﬁcantly avoiding coastal erosion
[20] is obtained and achieving a more uniform energy production on the farm [21]. It
is known that marine waves are mainly composed of distant waves (Swell type), which
originate even from thousands of kilometers, and local waves (Sea type), which are
generated due to the wind produced within areas at distances relatively close to the coast.
In real conditions, the waves are irregular and are the result of complex combinations
of different waves. This condition is called the State of the Sea, and it is common for
local and distant waves (Sea and Swell types) to predominate most of the time. It is
interesting to note that various software has been developed globally in recent years,
such as WAVE WATCH III, SWAN, and WAM, which allow to establish predictive
models of waves, with excellent approximation or software for ﬂow simulation such as
Dual SPHysics, SW. In future work, it is important to consider the control loop that is
going to manipulate the energy harvesting contemplating the gravity compensation in
the system [22] and various mechanisms that will be more efﬁcient as the Slider-Crank
on the layout proposed [23].

Hybrid System Design for Energy Harvesting
165
Table 2. Results obtained for each series
Serie
One
WG
frequency
10Hz
Time: 420 s
(ηo/ηe) *
Angle MN
ηo (cm)
ηe (cm)
L (m)
V (m/s)
(1/10)%
90°
7
8
1.50
1.40
1.14
60°
7
7
1.65
1.49
1.00
34°
7
18.8
1.74
1.55
2.69
Serie
Two
WG
frequency
12Hz
Time: 420 s
(ηo/ηe)*
Angle MN
ηo (cm)
ηe (cm)
L (m)
V (m/s)
(1/10)%
90°
7
9
1.78
1.60
1.29
60°
7
8
1.75
1.65
1.14
34°
7
21.5
1.74
1.70
3.10
Serie
Three
WG
frequency
14 Hz
Time: 420 s
(ηo/ηe)*
Angle MN
ηo (cm)
ηe (cm)
L (m)
V (m/s)
(1/10)%
90°
7
9
1.80
1.40
1.29
60°
7
8
1.75
1.72
1.14
34°
7
23.8
1.74
1.76
3.40
(ηo/ηe)*=waveelevationwithintheMN/waveelevationbeforeentering
the MN.
4
Conclusions
The biggest challenge in implementing marine farms for harvesting and wave energy is
these technologies’ higher cost. The MN’s design contemplates that the elements that
set up the same walls may have movement with a degree of freedom (DOF) to take
advantage of the possibility of oscillating the same and harvest energy directly from
the waves that exchange momentum with them. It is needed to carry out the hybrid
system’s tests in irregular and height waves as it is presented in the coastlines of Oaxaca
or Chiapas, Mexico.
Acknowledgments. The authors are grateful for partial support for this work provided to the
Mexican Government by the Consejo Nacional de Ciencia y Tecnología (CONACYT), the Instituto
Politécnico Nacional. The authors also acknowledge the support of project 20210282 and an EDI
grant, all from SIP/IPN. Finally, the support of M.en C. G. Rendón-Ricardi, Head of the LIH-TV
of the ESIA Zacatenco of the IPN, makes it possible using the wave’s laboratory and the support
of Ing. S. Rosas-Labastida. and J.E. Olmedo-García for the information provided.

166
G. Gutiérrez-Diaz et al.
References
1. International Energy Agency (IEA): Data and statistics (2018). https://www.iea.org/data-and-
statistics?country=WORLD&fuel=Energy%20supply&indicator=TPESbySource
2. Alifdini, I., et al.: Technology application of oscillating water column on the sungai suci beach
as solutions for make a renewable energy in coastal Bengkulu, Indonesia. In: Proceedings of
the 3rd Asian Wave and Tidal Energy Conference (AWTEC), Singapore, vol. 2 (2016)
3. Asian development bank: Wave energy conversion and ocean thermal energy conversion
potential in developing member countries. Asian Development Bank, ADB, Mandaluyong
City, Philippines, pp. 1–136 (2014)
4. Garcia, M.O., et al.: Generación de Energía con dos tipos de WECs en México: Resulta-
dos experimentales y avances en su implementación. In: IX Congreso Internacional de la
Asociación Mexicana de Ingeniería Portuaria, Marítima y Costera A.C, pp. 15–17 (2015)
5. Chen, J., et al.: Networks of triboelectric nanogenerators for harvesting water wave energy:
a potential approach toward Blue Energy. ACS Nano 9(3), 3324–3331 (2015)
6. Khan, N., et al.: Review of ocean tidal, wave and thermal energy technologies. Renew. Sustain.
Energy Rev. 72, 590–604 (2017)
7. Barbosa, A.L., et al.: Overtopping device numerical study: openfoam solution veriﬁcation
and evaluation of curved ramps performances. Int. J. Heat Mass Transf. 131, 411–423 (2019)
8. Gomes, M.N., et al.: Constructal design applied to the geometric evaluation of an oscillating
water column wave energy converter considering different real scale wave periods. J. Eng.
Thermophys. 27(2), 173–190 (2018). ISSN 1810-2328
9. Mendoza, E., et al.: Hydrodynamic behavior of a new wave energy converter: the blow-jet.
Ocean Eng. 106, 252–260 (2015)
10. Coe, R.C., et al.: Extreme conditions modeling Workshop Report. Nrel-sandia national
laboratories. Technical report. Nrel/tp-5000–62305, snl/sand 16384r. pp. 1–42 (2014)
11. Hammar, L., et al.: Introducing ocean energy industries to a busy marine environment. Renew.
Sustain. Ener. Rev. 74, 178–185 (2017)
12. Gomes, M.D.N., et al.: Analysis of the geometric constraints employed in constructal design
for oscillating water column devices submitted to the wave spectrum through a numerical
approach. 390, 193–210 (2019)
13. Philen, M., et al.: Wave energy conversion using ﬂuidic ﬂexible matrix composite power
take-off pumps. Energy Convers. Manag. 171, 1773–1786 (2018)
14. Sang, Y., et al.: Energy extraction from a slider-crank wave energy under irregular wave con-
ditions. National Renewable Energy Laboratory (NREL). Presented at Oceans Washington,
D.C. Conference paper NREL/CP-5D00-64875. pp. 1–9 (2015)
15. Lithgow, D., et al.: Integración de los dispositivos conversores de la energía marina a los
ecosistemas costero-marinos en México, pp. 241–254 (2019)
16. Felix, A., et al.: Wave energy in tropical regions: deployment challenges, environmental and
social perspectives. J. Mar. Sci. Eng. 7(7), 2–21 (2019)
17. Soares, C.G., et al.: Overview and prospects for development of wave and offshore wind
energy. Centre for Marine Technology and Engineering (CENTEC), 65(2) (2014)
18. Pecher, A., Kofoed, J.P. (eds.). Handbook of Ocean Wave Energy. Ocean Engineering and
Oceanography, vol. 7 (2017)
19. Neary,V.S.,etal.:Methodologyfordesignandeconomicanalysisofmarineenergyconversion
(MEC) technologies. In: Proceedings of the 2nd Marine Energy Technology Symposium.
METS2014. SAND2014-3561C, Seattle, WA, 15–18 April 2014
20. Mendoza, E., et al.: Beach response to wave energy converter farms acting as coastal
defense. Coast. Eng. 87(2014), 97–111 (2013). https://doi.org/10.1016/j.coastaleng.2013.10.
018.0378-3839

Hybrid System Design for Energy Harvesting
167
21. Flocard, F., Finnigan, T.D.: Laboratory experiments on the power capture of pitching vertical
cylinders in waves. Ocean Eng. 37(989–997), 0029–8018 (2010). https://doi.org/10.1016/j.
oceaneng.2010.03.011
22. Perrusquia, A., Flores-Campos, J.A., Torres-San-Miguel, C.R.: A novel tuning method of PD
with Gravity compensation controller for robot manipulators. IEEE Access 8, 114773–114783
(2020). https://doi.org/10.1109/ACCESS.2020.3003842
23. Perrusquia, A., Flores-Campos, J.A., Torres-Sanmiguel, C.R., Gonzalez, N.: Task space posi-
tion control of slider-crank mechanisms using simple tuning techniques without linearization
methods. IEEE Access 8, 58435–58442 (2020). https://doi.org/10.1109/ACCESS.2020.298
1187

Robot Design and Optimization

Modelling of a Hydrodynamically
Actuated Manipulator Based on Strip
Theory
R. Santiesteban Cos1,2(B), J. A. Carretero1,2, and J. Sensinger1,2
1 Department of Mechanical Engineering, University of New Brunswick,
Fredericton, NB, Canada
{raul.sncos,juan.carretero,j.sensinger}@unb.ca
2 Department of Electrical and Computer Engineering, University of New Brunswick,
Fredericton, NB, Canada
Abstract. In this paper, mathematical modelling based on strip theory
of the Hydrodynamically Actuated Manipulator (HAM) is proposed to
use it for analysis and control synthesis. A set of Nonlinear Ordinary
Diﬀerential Equations (ODEs) describes the behaviour of the HAM.
First, considering the Euler-Lagrange methodology, the motion of the
R ⊥R ∥P manipulator is obtained. Then, a Newtonian approach is
under study to add the eﬀects of a ﬂuid surrounding the 3-DOF manip-
ulator. In order to describe this interaction, each link of the manipulator
aﬀected by hydrodynamic forces is discretized on small elements. Their
contribution is added to obtain the net acceleration of each link of the
HAM. In order to qualitatively validate the model, a numerical simula-
tion are under study. The experiment consists of a comparison between
the Lagrangian of the 3-DOF manipulator and its motion when is aﬀected
by each added hydrodynamic force.
Keywords: Modelling · Nonlinear systems · Euler-Lagrange
1
Introduction
Defense Research and Development Canada has been working with the Robotics
and Mechanisms (RAM) Laboratory at University of New Brunswick and other
partners to develop a reliable method to dock Unmanned Underwater Vehicles
(UUVs) to moving submarines or surface vessels. The proposal consists of attach-
ing to the outer hull of the vessel a robotic arm which, using an array of sensors
and actuators, will be able to autonomously capture a UUV. In [1] and [3], both
undergraduate senior design projects, multiple UUV tracking manipulators were
proposed, one of them being a serial manipulator with three degrees of freedom
(three joints).
As in the wheel of inertia, cart-pendulum, or pendubot [7,11,19], the hydro-
dynamically actuated manipulator may be used as an interesting test bed for
analysis and control synthesis because it can be seen as two interacting dynamic
c
⃝The Author(s), under exclusive license to Springer Nature Switzerland AG 2022
M. Pucheta et al. (Eds.): MuSMe 2021, MMS 110, pp. 171–180, 2022.
https://doi.org/10.1007/978-3-030-88751-3_18

172
R. Santiesteban Cos et al.
Fig. 1. Docking envelope in relation
to the submarine [17].
Fig. 2. The 3-DOF mechanical manipulator.
systems: a ﬂuid and a solid [12,14,15]. There are some features that make this
manipulator an interesting test bed for analysis and control synthesis. First, the
manipulator by itself could be analyzed as an inverted pendulum that moves
with a force caused by a ﬂuid [16]. Depending on the position of the reference
frame, there will be gravity-bounded nonlinear terms aﬀecting the behaviour
of the system. Second, considering the eﬀects of ﬂuid on the solid, nonlinear
quadratic dynamics will aﬀect the mechanical system (e.g., [2,8]). Third, non-
collocated dynamics will also aﬀect the behaviour of the entire system because of
the underactuated operation mode, which is very interesting for control design
purposes (see [18]).
Figures 1 and 2 show a sketch of the robot. The only rotation between the
frame (x, y, z) and (x′, y′, z′) is a rotation around axis z. The constant l0 is
the distance from the platform of the manipulator to the centre of mass of the
hydraulic actuator, and l1 denotes the half of the span of the wing. θ is the angle
between the axis x and the axis y′. λ is the distance from the centre of mass of
the hydraulic actuator to the center of mass of the wing along axis x′. γ is the
angle between the axis z and the axis x′ (see [4,17,20]).
At its inception ([1] and [3]), the UUV tracking manipulator was a serial
manipulator with four degrees of freedom (four joints). The manipulator’s full
scale has three mutually perpendicular revolute (R) joints and one prismatic
(P) joint perpendicular to the ﬁrst two. This results in an architecture that
is denoted by R ⊥R ⊥R ∥P (with ⊥denoting the perpendicularity relation
between two consecutive joints).
More speciﬁcally, the arm is to have the ﬁrst revolute joint (the base joint)
with the axis vertical to bring the arm perpendicular to the submarine’s hull. The
base joint is conceptualized to be primarily used when deploying or concealing
the arm, allowing it to swing to a more compact or streamlined position when
not in use. However, before capture, the arm is brought to be perpendicular to
the hull and the base joint is then locked. At that point, the second revolute
joint (the shoulder joint) will have its axes aligned with the main axis of the
submarine. This second joint will then allow rolling (in other words to elevate)
the arm in the vertical direction. The third revolute joint is designed to rotate

Modelling of a Hydrodynamically Actuated Manipulator
173
the wing. The fourth joint, the linear or prismatic joint will enable to arm to
extend further away or closer to the submarine essentially changing the radius
of the circle traced by the end eﬀector relative to the base joint. This conceptual
design is illustrated in Fig. 2 (see [17]).
The design showed in Fig. 2 and the one analysed in here is meant as a half-
scale model. This half-scale model is ﬁxed perpendicular to the hull position
during its whole operation (i.e., the ﬁrst revolute joint is ﬁxed and thus not
modelled herein). However, the new architecture of the manipulator still has a
R ⊥R ∥P conﬁguration, where the last revolute joint is used to actively pitch
the wing.
An interesting design concept is that the hydraulic cylinder can be either a)
directly actuated (using a hydraulic actuator) [10] or b) indirectly actuated via
hydrodynamic action produced by the interaction of the incoming water ﬂow
with the actively pitching wing placed at the end of the arm (see [4] and [20]).
In the latter case, the robot is designed to take advantage of the motion of the
support vessel by actively controlling the pitch of a wing. This allows the arm
to move much like one’s arm would move when sticking the hand out on a fast-
moving vehicle and changing the angle of the hand relative to the direction of
the incoming wind.
Considering the hydrodynamically actuated mode, the manipulator will be
actuated using the hydrodynamic force of the water through a wing. Figure 2
shows a sketch of the robot, where θ is the roll angle or the orientation of the axis
of the hydraulic cylinder relative to the vertical (upward) direction. That is, θ is
measured around z0 as the axis of the cylinder always lies on in the x0-y0 plane.
In this model, γ denotes the angular position around the cylinder’s axis while λ is
associated with the length of the hydraulic cylinder. Using an actuator to change
the angle of attack α of the wing and the length λ of the hydraulic cylinder, it
is possible to change the unactuated angular position θ of the manipulator. The
main contribution of this paper is a proposal of a mathematical model of a
hydrodynamically actuated mechanical system.
2
Modelling: R ⊥R ∥P Manipulator
Due to the complexity of the 3-DOF manipulator, let us consider the Euler-
Lagrange formulation instead of Newton’s formulation. The Euler–Lagrange
equation is given by
d
dt
 ∂L
∂˙qi

−∂L
∂qi
= Fi,
(1)
where q = [θ λ γ]T , Fi denotes the non-conservative and viscous forces on each
link, and
L = K −U = K0 + K1 −(U0 + U1) .
(2)
The kinetic energy of the hydraulic cylinder associated to its rotational motion
is given by
K0 = 1
2m0v2
0 + Iz0 ˙θ2 = 1
2

m0l2
0 + Iz0
 ˙θ2,
(3)

174
R. Santiesteban Cos et al.
with Iz0 as the moment of inertia of the hydraulic cylinder around axis z. In
order to calculate the potential energy of the hydraulic cylinder, let us consider
that its position of rest (θ = 0) has potential energy equal to zero.
U0 = m0gy0 = m0gl0(1 −cos(θ)).
(4)
The wing is rotating with respect the axis z but also is rotating with respect
the hydraulic cylinder or axis x′. Then, the wing has two degrees of freedom
and the kinetic energy associated with its rotational and translational motion is
given by
K1 = 1
2m1v2
1 + 1
2Ix1 ˙γ2 + 1
2Iz1 ˙θ2
(5)
Since v2 = ˙x2 + ˙y2 + ˙z2, the kinetic energy of link 1 can be written as follows
K1 =
1
2m1

˙λ −c sin(γ) ˙θ
2
+

L0 ˙θ + c cos(γ)˙γ
2
+ c2 sin2(γ)˙γ2
	
+1
2Ix1 ˙γ2 + 1
2Iz1 ˙θ2
(6)
where c is the distance of the centre of mass of the wing relative to x′ (see Fig. 3).
Finally, the potential energy of link 1 is given by
U1 = m1 gy = gm1 ((l0 + λmax) −(l0 + λ) cos(θ) + c sin(γ) sin(θ))
(7)
2.1
The R ⊥R ∥P Manipulator Subjected to Hydrodynamic
Forces
2.1.1
Preliminaries: Nomenclature and Flow Conditions
Several works have been conducted to model underwater manipulator dynamics.
For instance, in [13] and [14], the authors estimated the added mass and drag
forces using and developing potential ﬂow theory and experimental tests. The
eﬀect on the underwater manipulator is modelled in a simpliﬁed way assuming
an irrotational, incompressible ﬂow [6,8,9]. In this section, for readability some
variables are deﬁned: L(λ) = l0 + λ −l1 and ri(λ) = (L(λ) + 2l1)i −Li(λ) for
i = 2, 3, 4. Let F ˙q = [f ˙θ f ˙λ f ˙γ]T denotes a source of friction such as viscous
friction, drag friction and added mass but also a source of energy from the
aerodynamic proﬁle such as lift force.
Then, F ˙q can be written as
F(q, ˙q, ¨q) =
⎡
⎣
−fθv( ˙θ) −fθD(q, ˙θ, αh) + fθL( ˙q, αh) + fθB(q) −fθam(q, ¨θ)
−fλv( ˙λ) + fλB(θ)
−fγv(˙γ) −fγD( ˙q, αh) + fγB(γ) −fγam(q, ¨γ)
⎤
⎦
(8)
where fθv, fλv, and fγv denote the viscous friction at each joint, fθB, fλB, and
fγB denote the buoyancy force, fθam, and fγam denote the added mass, fθD,
while fγD and fθL denote the drag and lift forces, respectively.

Modelling of a Hydrodynamically Actuated Manipulator
175
Fig. 3. The lift and drag forces with
respect to the ﬂow in the negative z0
direction.
Fig. 4. The lift force with respect to the
ﬂow.
2.1.2
Buoyancy Force
For the 3-DOF manipulator, the buoyancy force can be calculated in two parts:
the hydraulic cylinder and the wing. The buoyancy of the hydraulic cylinder
depends on the volume displaced and can be calculated as V = πR2L(λ). The
buoyancy of the wing depends on two things: the distance of the wing from axis
z and the angle of rotation γ. Then, fB(q) can be written as
fB(q) =
⎡
⎣
gρ
 1
2πR2 L2(λ) + V1L0(λ)

sin(θ) + V1c sin(γ) cos(θ)

−gρV1 cos(θ)
gρV1c cos(γ) sin(θ)
⎤
⎦,
(9)
where L0 = l0 + x2, L = l0 + x2 −l1, V0 = πR2L(λ) denotes the volume of the
exposed hydraulic cylinder, V1 = 2l1Acw denotes the volume of the wing.
2.1.3
Added Mass Force
Based on [5], for the 3-DOF manipulator, the added mass force can be calculated
in two parts: the hydraulic cylinder and the wing. The added mass of a cylinder
in potential ﬂow is equal to the mass of ﬂuid displaced by the body ρπR2.
For a wing with chord c0, ρπ
 c0
2
2 U(t)˙γ is a Coriolis-like term aﬀecting the
acceleration of the wing, which is due to the added mass when the hydraulic
cylinder is accelerating around axis z (see [5], Chap. 7). Due to the motion of the
wing around axis x′, the eﬀect of the added mass on the wing can be projected
to the plane x −y. This projection can be calculated as ρ sin(γ)¨θdVxy, where
dVxy is the volume of a thin segment of the wing at a distance z′ from the axis
x′ and distance L(λ) from axis z. A simpliﬁed version of the added mass term
can be described as
˜fam(q, ¨q) =
⎡
⎢⎣
ρπ

1
3 ¨θ

R2L3(λ) +
 c0
2
2 cos(γ)r3(λ)

+ 1
2
 c0
2
2 U(t)˙γr2

0
0
⎤
⎥⎦(10)

176
R. Santiesteban Cos et al.
2.1.4
Quasy-Steady Lift and Drag Forces
A ﬂuid ﬂowing around the surface of an object exerts a force on it. The lift
force is the component of this force that is perpendicular to the oncoming ﬂow
direction while the drag is the one aligned with it (see Fig. 3).
Although the main ﬂow is parallel to the z axis, one needs to also consider
that the wing has a rotational motion around both the z and x′ axes. Thus,
the true velocity of the ﬂow v = U′(t) aﬀecting a thin segment of the wing can
be calculated as (U′)2 = U2 + ( ˙θr)2 where r is the distance from z to the thin
segment of the wing. The eﬀective angle of attack αh also considers the angle
between the thin segment of the wing and the incident ﬂow, and thus depends
on the ﬂow velocity U(t) and ˙θ (Fig. 3). That is,
αh = −γ −atan2(V, U) = −γ −atan2
1
2
˙θl, U

(11)
where atan2 refers to the quadrant-corrected inverse tangent function.
For simplicity, only the quasi-steady lift force is considered here. Considering
the value CL for a wing at a speciﬁed angle of attack, the lift produced for
speciﬁc ﬂow conditions can be determined:
L = 1
2ρv2SCL
(12)
where v is the speed of the wing relative to the ﬂow and S is the planform wing
area. In this case, the wing has a planform area S = 2c0l1. However, the wing is
at a distance L(λ) = l0 + λ −l1 from the axis of rotation z. Moreover, the wing
has rotational motion with respect to axis x′. Therefore, the projected force with
respect to z −x′ should be considered (see Figs. 4 and 3).
Since the eﬀective angle of attack in Eq. (11) depends on the distance on each
strip of the wing, to solve analytically the torque Equation (12) comes to be very
complex for simulation purposes. To solve this issue, an average eﬀective angle
of attack is implemented. Therefore, the lift force fL(q, ˙q, αh) can be written as
fL(q, ˙q, αh) =
⎡
⎢⎣
1
4ρc0 sin(αh)CL(αh)

U2r2 + 1
2 ˙θ2r4

0
0
⎤
⎥⎦
(13)
where CL(αh) is the lift coeﬃcient which itself is a function of αh [4].
In the case of the 3-DOF manipulator, the wing has a NACA 0020 proﬁle
and a chord lenght of c0 = 0.6 m. The wing cover moves away or towards the z0
axis as it is part of the hydraulic cylinder. Therefore, the exposed cross section
area of the cylinder is Ac = 2R(l0 + λ −l1) = 2RL(λ) (see Fig. 4). The drag
force around axis z depends on the angular velocity ˙θ, and the drag force around
x′ depends on the angular velocity ˙γ but also depends on the eﬀective angle of
attack αh. Then, the drag force fD(q, ˙q) can be written as
fD(q, ˙q, αh) =
⎡
⎢⎣
−1
4ρ| ˙θ| ˙θ

RCDcL4(λ) + 1
2c0 cos(γ)CD(αh)r4

0
−1
4ρc0 sin(αh)CD(αh)

U2r2 + 1
2 ˙θ2r4

−0.4112
4
ρl1|˙γ|˙γc4
0
⎤
⎥⎦

Modelling of a Hydrodynamically Actuated Manipulator
177
Fig. 5. Simulation results: wing elevation (θ)
3
Numerical Simulation
A simulation is considered in order to conﬁrm the behaviour of the mechanical
system aﬀected by the hydrodynamic forces. In Figs. 5, 6 and 7, the motion of
the mechanical system inside the water is shown. In this simulation, the initial
conditions for the 3-DOF system are ﬁxed as: θ(0) = π
2 +0.2 rad and λ(0) = 0 m,
and γ(0) = 0.5 rad, and the velocities of the joint variables are set equal to zero,
with the ﬂow U as a function of time (t) expressed as U(t) = t m/s at t = 0.1 s.
Figures 5, 6 and 7 show the Lagrangian (red line) and the Lagrangian aﬀected
by hydrodynamic forces (blue line). The ﬁrst graph in every ﬁgure shows the
position of the joint manipulator while the second graph shows the rate of change
of the corresponding joint variable.
The main idea of this simulation is to show how the hydrodynamic forces
aﬀect the 3-DOF manipulator when the wing is forced to slow its motion, and it
creates a lift force driving the hydraulic cylinder upwards. A high level of viscous
friction, around the axis x′, will force the wing to slow its motion for a small
period of time. When the Lagrangian is aﬀected by hydrodynamic forces, the lift
force, created by a positive angle of attack of the wing, overcomes the gravita-
tional, friction, and drag forces aﬀecting the hydraulic cylinder. The hydraulic
cylinder starts with a horizontal position and it tends to go upwards while the
prismatic joint goes in a negative direction, showing that the hydraulic cylinder
is contracting. In the case of the Lagrangian, the cylinder starts to fall from

178
R. Santiesteban Cos et al.
Fig. 6. Simulation results: wing extension (λ)
Fig. 7. Simulation results: wing pitch (γ)

Modelling of a Hydrodynamically Actuated Manipulator
179
the initial position and oscillates around the position of rest while the prismatic
joint grows almost linearly, showing that the hydraulic cylinder is extending.
Even high viscous friction is imposed on the wing, it tends to align to the ﬂow
U(t). At the time that the wing is aligned with the ﬂow U(t), the generated lift
force tends to zero and the hydraulic cylinder falls and starts to oscillate around
its rest position θ = 0 rad. In the case of the Lagrangian, the wing remains in
the same position due to the high friction.
4
Conclusions
A Euler-Lagrange formulation was considered to obtain a model for a R ⊥R ∥P
hydrodynamically actuated manipulator (HAM). Based on the potential and
kinetic energy, the Lagrangian was calculated considering a dissipative force
such as viscous friction. The hydrodynamic forces, aﬀecting the motion of the
mechanical system, were added one by one considering a Newtonian approach.
Forces such as buoyancy, added mass, drag, and lift were calculated using a strip
theory approach.
Through a simulation, the system’s model was conﬁrmed by observing its
behaviour follows basic principles. Although the ﬁdelity of the model may only be
veriﬁed through lengthy Computational Fluid Dynamics (CFD) simulations or
costly physical experiments, the proposed model is believed to replicate enough
of the eﬀects to allow for studies on controls to be performed.
References
1. Aske, T., Barton, M., MacKay, T.: Docking of unmanned underwater vehicles with
submarines. Master’s thesis, University of New Brunswick (2011)
2. Caldeira, A.F., Prieur, C., Coutinho, D., Leite, V.J.: Regional stability and stabi-
lization of a class of linear hyperbolic systems with nonlinear quadratic dynamic
boundary conditions. Eur. J. Control 43, 1–11 (2018)
3. Cote, J., Gillis, C., Hilton, K.: Docking autonomous underwater vehicles (UUV) on
submarines. Senior Design Project Report, Department of Mechanical Engineering
(2011)
4. Currie, J.: Dynamic modelling and control of an active autonomous wing dock for
subsurface recovery of AUVs. Master’s thesis, University of New Brunswick (2015)
5. Drela, M.: Flight Vehicle Aerodynamics. MIT Press, Cambridge (2014)
6. Fackrell, S.: Study of the Added Mass of Cylinders and Spheres (2011)
7. Fantoni, I., Lozano, R.: Non-Linear Control for Underactuated Mechanical Sys-
tems. Springer, Heidelberg (2002). https://doi.org/10.1007/978-1-4471-0177-2
8. Fossen, T.I.: Guidance and Control of Ocean Vehicles. Wiley, New York (1994)
9. Gianluca, A., Antonelli, G.: Underwater Robots, vol. 3. Springer, Heidelberg
(2014). https://doi.org/10.1007/978-3-319-02877-4
10. Gillis, C.B.: Dynamic model development and simulation of an autonomous active
AUV docking device using a mechanically actuated mechanism to recover AUVs
to a submerged slowly moving submarine in waves. Master’s thesis, University of
New Brunswick (2014)

180
R. Santiesteban Cos et al.
11. Goryanina, K.I., Lukyanov, A.D., Katin, O.I.: Review of robotic manipulators and
identiﬁcation of the main problems. In: MATEC Web of Conferences, vol. 226, pp.
1–7. EDP Sciences (2018)
12. Kolodziejczyk, W.: Preliminary study of hydrodynamic load on an underwater
robotic manipulator. J. Autom. Mobile Robot. Intell. Syst. 9, 11–17 (2015)
13. Leabourne, K.N., Rock, S.M.: Model development of an underwater manipulator
for coordinated arm-vehicle control. In: IEEE Oceanic Engineering Society. Pro-
ceedings of OCEANS’98 Conference, vol. 2, pp. 941–946. IEEE (1998)
14. McLain, T.W., Rock, S.M.: Experiments in the hydrodynamic modeling of an
underwater manipulator. In: Proceedings of the 1996 Symposium on Autonomous
Underwater Vehicle Technology, pp. 463–469. IEEE (1996)
15. Mueller, T., DeLaurier, J.D.: An overview of micro air vehicle aerodynamics. Prog.
Astronaut. Aeronaut. 195, 1–10 (2001)
16. Onishi, H., Kitamoto, T., Maeda, T., Shimohara, H., Tanigawa, H., Hirata, K.:
Added-mass and viscous-damping forces acting on various oscillating 3D objects.
In: ASME 2014 Pressure Vessels and Piping Conference, pp. 1–10. American Soci-
ety of Mechanical Engineers (2014)
17. Prosser, T.W., Carretero, J.A., Dubay, R.: Construction and evaluation of an actu-
ated arm for capturing unmanned underwater vehicles from submarines. In: 2016
CCToMM Symposium on Mechanisms, Machines and Mechatronics, pp. 26–29
(2016)
18. Spong, M.W.: Underactuated mechanical systems. In: Siciliano, B., Valavanis,
K.P. (eds.) Control Problems in Robotics and Automation, vol. 230, pp. 135–150.
Springer, Heidelberg (1998). https://doi.org/10.1007/BFb0015081
19. Spong, M.W., Hutchinson, S., Vidyasagar, M.: Robot Modeling and Control, vol.
3. Wiley, New York (2006)
20. Watt, G.D., et al.: A concept for docking a UUV with a slowly moving submarine
under waves. IEEE J. Oceanic Eng. 41(2), 471–498 (2016)

Shaking Force Balancing of the 2RRR
PPM Specifying Tool’s Motion
Mario Acevedo1(B)
and Ramiro Vel´azquez2
1 Facultad de Ingenier´ıa, Universidad Panamericana, ´Alvaro del Portillo 49,
45010 Zapopan, Jalisco, Mexico
mario.acevedo@up.edu.mx
2 Facultad de Ingenier´ıa, Universidad Panamericana, Josemar´ıa Escriv´a de
Balaguer 101, 20290 Aguascalientes, Aguascalientes, Mexico
Abstract. Shaking force balancing of mechanisms usually is achieved
by an optimal redistribution of the moving masses. This allows the can-
cellation or the reduction of the variable dynamic loads on the mech-
anism’s frame. The procedure generally leads to a considerable incre-
ment in the mass. Addition of counterweights and counter-inertias are
required, thus the driving torques and the shaking moment are incre-
mented too. Recently the shaking force balancing has been successfully
achieved by specifying the acceleration motion of the global Center of
Mass (CoM) of the robot. Additional masses are avoided. But this may
be diﬃcult to apply in practice. Therefore it has been proposed a com-
bined procedure, based on imposing an acceleration motion planning to
the manipulator’s tool, and on the selective mass redistribution. This last
concept is resumed here using Natural Coordinates, a direct and easy to
automate alternative. The force balancing of a 2RRR Planar Parallel
Manipulator (PPM), also known as the ﬁve-bar mechanism, is used as
an application example. The shaking force and the shaking moment are
obtained analytically using the proposed direct approach. Linear relation
between the acceleration of the CoM and the acceleration of the tool is
shown in a clear and explicit way, making it easy to identify the required
mass redistribution. A generic CAD model made in Solidworks is used
to show the application of the technique and to validate the balancing’s
results, obtained from inverse kinematics simulations, through dynamic
simulation.
Keywords: Dynamic balancing · Shaking force · Shaking moment ·
Parallel manipulator · Manipulator’s tool motion
1
Introduction
Robotic industrial manipulators deal with the problem of vibrations transmitted
to the ﬁxed frame during high-speed motion. These vibrations are due to diﬀerent
factors, one of them is the unbalanced inertia forces which ﬁnally produce the
increment of the shaking force and shaking moment. Thus, a primary objective
c
⃝The Author(s), under exclusive license to Springer Nature Switzerland AG 2022
M. Pucheta et al. (Eds.): MuSMe 2021, MMS 110, pp. 181–190, 2022.
https://doi.org/10.1007/978-3-030-88751-3_19

182
M. Acevedo and R. Vel´azquez
in the dynamic balancing of manipulators is to eliminate or reduce the variable
dynamic loads transmitted to the base and surrounding structures.
A traditional method used for the dynamic balancing of manipulators has
been the mass redistribution. In this case the objective is to maintain the total
center of mass of the moving links stationary, see [3,6,9]. In practice this is done
adding a set of counterweights and counter-inertias increasing considerably the
mass. This causes an increment in the overall size of the robot-manipulator and
in the eﬀorts at the joints.
Another alternative also traditionally explored is the use of auxiliary struc-
tures. In the same way the aim is to keep the total center of mass of the mech-
anism static. The structures proposed and generally used are the parallelogram
and the pantograph, [7,8,12]. Although this solution leads to relatively complex
mechanical system increasing manipulator’s sizes.
Recently a new successful approach has been proposed. It is based on impos-
ing constant acceleration motion to the robot-manipulator global Center of Mass
(CoM), [5,11]. But this may be diﬃcult to apply in practice. Therefore a com-
bined procedure based on imposing constant acceleration to the robot’s tool
along with a selective optimal mass redistribution has been proposed in [4]. Lin-
ear relation between the motion of the tool and the motion of the global CoM is
found imposing selected balancing conditions, fulﬁlled by the addition of some
appropriate counterweights. The tool’s trajectory is deﬁned as a straight line
imposing a “bang-bang” acceleration proﬁle. This ensures a linear trajectory of
the CoM with constant acceleration. Thus leading to a reduction in the shaking
force. In this work this approach is presented using fully Cartesian coordinates
[10], introducing a model of a 2RRR Planar Parallel Manipulator (2RRR PPM).
A complete explanation on the use of this modeling technique along with diﬀer-
ent practical balancing alternatives for this robot have been presented in detail
in [1].
The advantage of using fully Cartesian coordinates is that the expressions
relating the motion of the general CoM and the motion of the manipulator’s
gripper, the shaking force, and the shaking moment, are obtained in a direct
and explicit form. This allows the use of software for symbolic computation,
making the method easy to program and faster in execution. In this article the
acceleration of the robot’s global CoM and the acceleration of the robot’s gripper
are related. The resulting expression helps to identify the appropriate balanc-
ing conditions that should be used to redistribute the mass and to relate the
accelerations linearly. The practical application is shown through a numerical
example. A generic CAD model made in Solidworks is used to show the appli-
cation of the technique and to validate the balancing’s results, obtained from
inverse kinematics simulations, through dynamic simulation.

Shaking Force Balancing Specifying Tool’s Motion
183
2
Modeling of a 2RRR-PPM
In Fig. 1 a generic 2RRR-PPM (ﬁve-bar mechanism) is presented. All links con-
sidered rigid. Kinematic revolute joints are identiﬁed with points A through E,
and points A and E are ﬁxed to the frame. Link lengths are indicated as li, where
i = 1, 2, 3, 4. In this case the centers of mass of the links can be identiﬁed with
the letter gi, respectively.
The masses of the bodies are distributed to the “basic points”. In this case
points A through E. Thus the system can be seen as a cloud of moving point
masses. Thanks to this change, it is possible to work exclusively with Cartesian
coordinates. Angular coordinates can be avoided, as well as the explicit use of
the moments of inertia. In this case this facilitates the dynamic analysis.
Fig. 1. Model of the 2RRR Planar Parallel Manipulator, showing the local reference
frames orientation. The centers of mass are considered in a general position.
The manipulator has been modeled using the “basic points”, that can be
organized in a positions vector q:
q =

rA rB rC rD rE
T
(1)
where rj = [xj yj], i = {A, . . . , E}, are the position vectors that locate the basic
points A through E with respect to the origin of the reference frame.
These dependent coordinates are related by a set of four kinematic con-
straints, obtained from the rigid body condition of the bodies:
Φ(q) =
⎡
⎢⎢⎣
(xB −xA)2 + (yB −yA)2 −l2
1
(xC −xB)2 + (yC −yB)2 −l2
2
(xC −xD)2 + (yC −yD)2 −l2
3
(xD −xE)2 + (yD −yE)2 −l2
4
⎤
⎥⎥⎦= 0
(2)

184
M. Acevedo and R. Vel´azquez
These coordinates and their time derivatives can be used to calculate the
position of the global CoM of the system, the shaking force, and the shaking
moment directly with respect to the global reference frame (inertial frame). In
this procedure the mass matrix plays a key role. The general procedure to obtain
the mass matrix has been described in [10] and to this speciﬁc manipulator in
[1]. Their terms can be reorganized to form the (10 × 10). Its detailed form can
be seen in [2]. This matrix is symmetric and positive deﬁnite.
2.1
Calculation of the Global Center of Mass
The global center of mass of the system can be calculated directly as:
mtgt = BMq
(3)
where mt = 
4
i=1 mi, is the total mass or the system, gt is the position vector
of the location of the global center of mass, q is vector of dependent Cartesian
coordinates, and M is mass matrix. Matrix B is introduced here to sum x and y
components in an automatic way and is composed by (2 × 2) identity matrices,
I2×2, its form is:
B =

I2×2 I2×2 I2×2 I2×2 I2×2

(4)
2.2
Calculation of the Shaking Force
The shaking force is the time derivative of the linear momentum. The linear
momentum can be calculated directly deriving Eq. (3) with respect to time:
mt ˙gt = BM ˙q
(5)
where ˙q is the vector of velocities, the time derivative of vector q.
The shaking force, fsh, can be calculated as the time derivative of the linear
momentum. Thus, taking into account the constant mass matrix and that the
velocities of point A and of point E are zero, the shaking force of the manipulator
can be expressed in extended form as:
fsh = mt¨gt =
⎡
⎣
a b c d e f
−b a −d c −f e
⎤
⎦
⎡
⎢⎢⎢⎢⎢⎢⎣
¨xB
¨yB
¨xC
¨yC
¨xD
˙yD
⎤
⎥⎥⎥⎥⎥⎥⎦
(6)

Shaking Force Balancing Specifying Tool’s Motion
185
where:
a =

−m2 x2
l2
+ m1 x1
l1
+ m2

(7)
b =
m2 y2
l2
−m1 y1
l1

(8)
c =
m3 x3
l3
+ m2 x2
l2

(9)
d =

−m3 y3
l3
−m2 y2
l2

(10)
e =
m4 x4
l4
−m3 x3
l3
+ m3

(11)
f =
m4 y4
l4
−m3 y3
l3

(12)
and where (xi, yi) with i = 1 . . . 4 are the coordinates of the corresponding center
of mass of body i expressed in the local reference frame, see Fig. 1. The origin
of the global reference frame coincides with point A, thus (xA, yA) = (0, 0).
Note that it is possible to relate the global CoM acceleration exclusively to the
acceleration of the manipulator’s gripper making some coeﬃcients of the mass
matrix zero, particularly a = b = e = f = 0. These are precisely the balancing
conditions than lead to the optimal mass redistribution. Thus performing the
suggested mass redistribution the shaking force can be espressed as:
fsh = mt¨gt =
⎡
⎣
c d
−d c
⎤
⎦
¨xC
¨yC

(13)
The balancing conditions can be fulﬁlled in diﬀerent ways. The most common
and the ones used in this work are: ﬁrst to consider that all the links are in-line,
which means that their CoM are in the line deﬁned by their corresponding joints,
second to use a counterweight at link 1 and at link 4 respectively. The form, size
and distance from the link’s origin to the counterweight are up to the designer
election. Inﬁnite number of solutions can be proposed. In this case a generic
solution has been used, although the future use of an optimization procedure
could come to mind.
It can be noted that considering the mass redistribution a new simpliﬁed
expression for the position of the CoM can be calculated:
mtgt =
⎡
⎣
c d
−d c
⎤
⎦

xC
yC

(14)
2.3
Calculation of the Shaking Moment
The shaking moment can be obtained by deriving the angular momentum with
respect to time. The angular momentum can be calculated as:

186
M. Acevedo and R. Vel´azquez
h = ˜rM ˙q
(15)
where ˜r is a row vector of cross products as:
˜r =
˜rA ˜rB ˜rC ˜rD ˜rE

(16)
where ˜ri ≡[−yi, xi], i = {A, . . . , E} is a 1 × 2 row vector. Thus the shaking
moment can be calculated by:
τ sh = ˙˜rM ˙q + ˜rM¨q
(17)
where ¨q is the vector of accelerations.
Considering that the mechanism is in-line (two of the balancing conditions),
˙˜rM ˙q = 0, thus the shaking moment of the manipulator can be reduced to:
τ sh = ˜rM¨q
(18)
that in extended form can be expressed as:
τ sh =

m2 −2m2x2
l2
+ I2
l2
2
+ I1
l2
1

(˜rB¨rB) +
m2x2
l2
−I2
l2
2

(˜rB¨rC + ˜rC¨rB)
+
I2
l2
2
+ I3
l2
3

(˜rC¨rC) +
m3x3
l3
−I3
l2
3

(˜rC¨rD + ˜rD¨rC)
+
m4x4
l4
−I4
l2
4

(˜rE¨rD) +

m3 −2m3x3
l3
+ I3
l2
3
+ I2
l2
2

(˜rD¨rD)
(19)
where Ii, i = 1...4, are the moments of inertia with respect to the corresponding
local reference frame, no with respect to the corresponding link’s CoM. This is
a characteristic of the model obtained using Natural coordinates.
3
Numerical Example
To show the application of the equations developed in the previous sections, a
speciﬁc 2RRR PPM has been selected. A model with the following geometric
parameters have been used: l1 = l4 = 0.36 m, l2 = l3 = 0.3 m, and xE = 0.35 m.
To locate the centers of mass the following values where used: x1 = x4 = 0.18 m,
x2 = x3 = 0.15 m, and y1 = y2 = y3 = y4 = 0. The corresponding masses are:
m1 = m4 = 0.2028823 kg and m2 = m3 = 0.1704823 kg, and moments of
inertia with respect to the link’s CoM are: Ig1 = Ig4 = 0.00239421 kg·m2 and
Ig2 = Ig3 = 0.1704823 kg·m2. Note that Ii ̸= Igi. These values are obtained
from a generic model of a 2RRR PPM made in Solidworks and presented in
Fig. 2.

Shaking Force Balancing Specifying Tool’s Motion
187
3.1
Motion Given to the End-Eﬀector
The trajectory of the end-eﬀector at C is a straight line limited between the
initial position Pi, with the coordinates xi = −0.15 m, and yi = 0.4 m, and the
ﬁnal position Pf, with the coordinates xf = 0.33296 m, and yf = 0.52941 m.
The straight line is traveled following a bang-bang motion proﬁle.
Fig. 2. Model of the 2RRR Planar Parallel Manipulator in Solidworks. Up, the original
model compared to the partially balanced model (conditions a and e applied). Bottom,
the original inferior link compared to the balanced link (conditions a and e applied).
All lengths in mm and angles in degrees.
Mass redistribution was performed using the balancing conditions: a = 0,
b = 0, e = 0, and f = 0. A generic useful design was selected, its form and
dimensions are shown in Fig. 2. The CoM of bodies 1 and 4 were located at
x1 = x4 = −80.4347 mm. Additionally the masses and moments of inertia
changed as: m1 = m4 = 0.38128 kg, and Ig1 = Ig4 = 0.0143679 kg·m2.
Equations (3), (14), have been used to calculate the CoM trajectory before
and after the mass redistribution. The Fig. 3 shows the comparison of results.
Equations (6) and (13) were used to calculate the Shaking Force before and
after the mass redistribution. In the same way Eqs. (17) and (19) were used to
calculate the Shaking Moment before and after the mass redistribution. Results
are shown in Fig. 4.
The resulting dynamic reactions presented in Fig. 4, have been obtained solv-
ing multiple inverse kinematics problems, then substituting values in the equa-
tions developed in Sect. 2. Positions, velocities, and accelerations correspond-
ing to the “bang-bang” proﬁle where assigned to the manipulator’s end-eﬀector

188
M. Acevedo and R. Vel´azquez
Fig. 3. Trajectories of the manipulator’s CoM before and after mass redistribution.
Fig. 4. Shaking force and Shaking Moment compared.
Fig. 5. Shaking force and Shaking Moment obtained from the direct dynamics simu-
lation performed in Solidworks.
(point C). The corresponding angular motion generated at links 1 and 4 were
recorded as data points and used to solve the direct dynamics problem in Solid-

Shaking Force Balancing Specifying Tool’s Motion
189
works. This could be considered as an preliminary validation of the method
before building a prototype. The resulting reactions from this simulation is
presented in Fig. 5.
4
Conclusions
A combined method, originally presented in [4], based on specifying the accel-
eration proﬁle of the tool and the selective mass redistribution is summarized
here, using an eﬃcient and direct modeling technique. The balancing procedure
is presented, and the analytical expressions of the global CoM, the shaking force,
and the shaking moment are presented for a generic 2RRR PPM. These expres-
sions along with multiple inverse kinematics simulations, are taken to calculate
the CoM trajectory as well as the shaking force and shaking moment. These
results are compared to the ones obtained with a generic not balanced model.
A model of the resulting balanced mechanism is made in Solidworks to validate
its behavior and performance in direct dynamics.
References
1. Acevedo, M.: Conditions for dynamic balancing of planar parallel manipulators
using natural coordinates and their application. In: 14th World Congress in Mech-
anism and Machine Science, Taipei, Taiwan, 25–30 October 2015 (2015)
2. Acevedo, M., Orva˜nanos-Guerrero, M.: Force balancing of the 2rrr planar parallel
manipulator via center of mass acceleration control using fully cartesian coordi-
nates. In: Hernandez, E., Keshtkar, S., Valdez, S. (eds.) LASIRS 2019. MMS, vol.
86. Springer, Cham (2020). https://doi.org/10.1007/978-3-030-45402-9 4
3. Agrawal, S., Fattah, A.: Reactionless space and ground robots: novel design and
concept studies. Mech. Mach. Theory 39(1), 25–40 (2004). https://doi.org/10.
1016/S0094-114X(03)00102-2
4. Arakelian, V., Geng, J., Fomin, A.S.: Minimization of inertial loads in planar par-
allel structure manipulators by means of optimal control. J. Mach. Manuf. Reliab.
47(4), 303–309 (2018). https://doi.org/10.3103/S1052618818040027
5. Briot, S., Arakelian, V., Le Baron, J.P.: Shaking force minimization of high-speed
robots via center of mass acceleration control. Mech. Mach. Theory 57, 1–12 (2012).
https://doi.org/10.1016/j.mechmachtheory.2012.06.006
6. Buganza, A., Acevedo, M.: Dynamic balancing of a 2-DOF 2RR planar parallel
manipulator by optimization. In: 13th World Congress in Mechanism and Machine
Science, Guanajuato, Mexico, 19–25 June 2011 (2011)
7. Fattah, A., Agrawal, S.: Design and modeling of classes of spatial reactionless
manipulators. In: Proceedings of the IEEE International Conference on Robotics
and Automation (ICRA 2003), Taipei, Taiwan, pp. 3225–3230 (2003)
8. Fattah, A., Agrawal, S.: Design arm simulation of a class of spatial reac-
tionless manipulators. Robotica 3(1), 75–81 (2005). https://doi.org/10.1017/
S0263574704000670
9. Filaretov, V., Vukobratovic, M.: Static balancing and dynamic decoupling of the
motion of manipulation robots. Mech. Mach. Theory 3(6), 767–783 (1993). https://
doi.org/10.1016/0957-4158(93)90062-7

190
M. Acevedo and R. Vel´azquez
10. de Jal´on, J.G., Bayo, E.: Kinematic and Dynamic Simulation of Multibody Sys-
tems. The Real-Time Challenge. Springer, New York (1994). https://doi.org/10.
1007/978-1-4612-2600-0
11. Nenchev, D.N.: Reaction null space of a multibody system with applications in
robotics. Mech. Sci. 4, 97–112 (2012). https://doi.org/10.5194/ms-4-97-2013
12. van der Wijk, V., Herder, J.L.: Synthesis method for linkages with center of mass
at invariant link point – pantograph based mechanisms. Mech. Mach. Theory 48,
15–28 (2012). https://doi.org/10.1016/j.mechmachtheory.2011.09.007

Energy Optimization of a Parallel Robot in Pick
and Place Tasks
Juan Pablo Mora1(B), Juan Pablo Barreto2, and Carlos F. Rodriguez1
1 Department of Mechanical Engineering, Universidad de los Andes, Bogotá, Colombia
{jp.mora807,crodrigu}@uniandes.edu.co
2 Institute of Mechanism Theory, Machine Dynamics and Robotics, RWTH Aachen University,
Aachen, Germany
juan.barreto@rwth-aachen.de
Abstract. The increase in the number of industrial robots and the requirements for
sustainable production have drawn attention to the study of energy consumption.
The present research work studies the energy optimization of a ﬁve-bar linkage
when performing pick and place tasks, combining trajectory optimization and the
addition of springs in parallel to the actuators. First, a method to reduce the energy
consumption for a general task is presented. Second, an algorithm to calculate the
free vibration response and the springs parameters for a nominal task is explained.
Finally, a new energy optimization method is presented to improve the versatility
of the robot when a new task is required, while reducing the necessary changes
on the system. The experimental results, regarding the free vibration trajectory,
encourage the adequate implementation of the calculated springs in the prototype.
Moreover, the results of the simulations, regarding the new method, indicate the
versatility of the system if the nominal task changes.
Keywords: Five-bar linkage · Natural motion · Free vibration response · Pick
and place · Energy optimization
1
Introduction
Nowadays, the study of energy consumption of industrial robots is very important due
to the increase of installed units [1]. One of the most common operations of robotic
manipulators are pick and place tasks, where both serial and parallel robots are used
to achieve fast motion cycles [2, 3]. Therefore, some strategies have been studied to
reduce the energy consumption of these systems. In [4, 5] comprehensive studies, that
compile some important contributions on energy saving strategies, are presented. One of
the strategies is based on the natural motion, which considers the dynamic response of
the mechanical system due to the conversion of potential energy into kinetic energy [5].
Hence, the addition of elastic elements is required to exploit the free vibration response
(FVR) of the system [6]. As a result, an oscillatory system suited for pick and place
operations will be obtained. However, the natural motion in parallel robots is a subject
© The Author(s), under exclusive license to Springer Nature Switzerland AG 2022
M. Pucheta et al. (Eds.): MuSMe 2021, MMS 110, pp. 191–200, 2022.
https://doi.org/10.1007/978-3-030-88751-3_20

192
J. P. Mora et al.
that is still under development [5]. For example, in [7] the natural motion of a ﬁve bar-
linkage is studied using a multibody simulation, while in [8, 9] the same topic is studied
for a delta robot.
In this contribution energy optimization of a ﬁve-bar linkage performing pick and
place tasks is studied mainly in ﬁve stages. First, a computational model of the ﬁve-bar
linkage is developed to simulate the motion between several pick and place points and
estimate the energy consumption. Second, a method to ﬁnd a minimum-energy trajectory
for a general task is implemented. Third, an algorithm to calculate the FVR for a speciﬁc
task and the springs parameters, namely the stiffnesses (ki for i = 1, 4) and the torque
exerted by the spring when the proximal link angle is zero

T0i for i = 1, 4

, is explained.
Fourth, free vibration trajectories are implemented in an experimental prototype. Fifth,
a method is presented to reduce the energy consumption when the robot must perform
tasks that vary signiﬁcantly from the nominal task that was used for the design of the
springs. Finally, some conclusions and ideas for future work are presented.
2
Prototype and Computational Model
The prototype studied (Fig. 1a) is a ﬁve-bar linkage designed and manufactured in
[10, 11]. The system is a planar parallel robot with two degrees of freedom actuated
by two rotational servomotors at the ground joints. The control system is composed of
commercial devices and software used in typical industrial systems. This should facilitate
the transfer of the proposed methods.
The generalized coordinates approach [12, 13] was used for the kinematic and kinetic
analysis. A coordinate system is set at each physical link of the mechanism (Fig. 1b)
with a deﬁned orientation. When the vector of generalized coordinates q
−is speciﬁed, the
position of the complete mechanism is known.
q
−=

x1 y1 φ1 x2 y2 φ2 x3 y3 φ3 x4 y4 φ4
T,
(1)
The angles φ1 and φ4 can be obtained solving the inverse kinematics problem from the
workspace coordinates of the end effector that is placed at joint B (Fig. 1b). However,
to obtain the whole information stored in Eq. (1), a set of twelve equations is needed.
Thus, these equations built up the vector of constraints:

−

q
−, t

=

−
K

−
D
	
= 0
(2)
The vector of constraints comprises the vector of kinematic constraints 
−
K and the
vector of drive constraints 
−
D. The ﬁrst vector (
−
K) consists of ten scalar equations
that are obtained gathering two equations per joint. The vector of drive constraints (
−
D)
comprises two scalar equations to describe the motion of the two proximal links. Hence,
they correspond to two time functions φi(t) for i = 1, 4. Finally, all equations must be
written as shown in Eq. (2) and the kinematic scalar equations must be arranged in order

Energy Optimization of a Parallel Robot in Pick and Place Tasks
193
a) 
b) 
Fig. 1. a) CAD model of the parallel robot. b) Five-bar linkage with generalized coordinates.
from the joint G1 to the joint G4, this organizes the relative kinematic equations at the
middle of 
−
K.
Velocities and accelerations are obtained when Eq. (2) is differentiated:
˙q
−= −−1
q t,
(3)
¨q
−= −−1
q

q˙q
−

q
˙q
−+ 2qt ˙q
−+ tt
	
(4)
Where q and t are the partial derivatives of  with respect to the components of q
−
and t, respectively. qt corresponds to the partial derivative of q with respect to t, and
tt to the partial derivative of t with respect to t.
Regarding the kinetic analysis of the whole system of constrained links, the Newton-
Euler equations of motion are [12, 13]:
M¨q
−= Q
−a
+ T
q λ
−
(5)
Where Q
−a
is the generalized vector of external forces and moments at each link, M the
diagonal matrix of masses and inertias, and λ
_ the vector of Lagrange multipliers used
to obtain the internal forces. In this way, with Eq. (2) and Eq. (5) the driving torques
(Ti for i = 1, 4.) that must be applied to the proximal links are calculated.
The scalar time functions of the motion of the proximal links, that are contained
in vector 
−
D, are made up of polynomial functions of time. First, in order to deﬁne
these functions, N points, χ
−i
(i = 1, . . . , N), by which the end effector must go
through, are selected in the workspace. Second, the N angles of each proximal link
are obtained throughout the inverse kinematics solution. Then, between these angles,
N −1 polynomial functions, of order k and equal duration, are generated as explained
in [14]:
fi(t) =

k
j=0aij(t −ti)j, i ∈[1, N −1], ti ≤t ≤ti+1
(6)

194
J. P. Mora et al.
For the calculation of the (N −1)(k + 1) coefﬁcients the following conditions must be
satisﬁed:
fi(t = ti) = φi,
fi(t = ti+1) = φi+1,
i ∈[1, N −1]
(7)
f (n)
i
(t = ti+1) = f (n)
i+1(t = ti+1),
i ∈[1, N −2]
n ∈[1, k −1]
(8)
Additionally, a set of (k −1) boundary conditions are deﬁned to determine all
coefﬁcients. At the end, a piecewise time function for each proximal link is determined.
The performance of the system in terms of energy consumption is estimated using
Eq. (9) and Eq. (10). The calculation of the power, Eq. (9), assuming that no energy recu-
peration is possible, is based on the mechanical power and an estimation of the electrical
losses. Then, an estimation of the energy consumption is obtained by integrating the
power over time, Eq. (10). This will be used later as cost function for the optimization
of the trajectory:
P =

i=1,4

max

Ti ˙φi, 0

+ R
 Ti
GikT
2
(9)
E =
 t
0
Pdt
(10)
Where Ti is the torque at the motor i, kT is the torque constant, R the resistance of the
motors and Gi is the gear ratio, which in the prototype is equal to one (direct drive).
3
Results and Discussion
In this contribution, to study the natural motion, the following optimization problem was
developed for two objective functions (J):
argmin
ξ∈R(N−2)×2
J,
(11)
In both problems an objective function J is minimized by the iterative calculation of
a matrix (ξ) that comprises the intermediate N −2 points that deﬁne the trajectory in the
workspace, as the initial and ﬁnal rows are ﬁxed by the pick and place points of the task.
Both optimization problems were solved using the function fminunc of MATLAB® and
the BFGS (Broyden, Fletcher, Goldfarb and Shanno) quasi-Newton algorithm [15]. This
function ﬁnds the minimum of an unconstrained multivariable nonlinear function [16].
The input arguments were the objective function J and an initial guess ξ0. Moreover,
the feasibility of the solution was veriﬁed in terms of the workspace of the robot as well
as the maximum torque, velocity and acceleration of the motors.
The ﬁrst optimization problem, based on [14], deals with the reduction of the esti-
mated energy consumption for a given task using Eq. (10) as the objective function (i.e.
J1 = E). This procedure works for both the mechanism with and without springs. Thus,

Energy Optimization of a Parallel Robot in Pick and Place Tasks
195
on each iteration, the points deﬁning the trajectory are changed and the cost function
Eq. (10), is calculated. Figure 2 shows the evolution of the optimization process for
the mechanism without springs presenting two intermediate iterations (Tr. 2 and Tr. 4).
The method starts with an arbitrary initial guess (Tr. 1) and, as shown in Fig. 2c, the
value of the estimated energy consumption is gradually reduced until it converges to a
minimum-energy trajectory (Tr. 5). A typical point-to-point trajectory (Tr. 3), namely a
ﬁfth-order polynomial [17], is also included for comparison.
a)
b)
c)
Fig. 2. Minimum energy algorithm. Polynomial trajectories with N = 7 and k = 5. Velocities and
accelerations at pick and place points are zero. a) Trajectories at workspace. b) Power requirement.
c) Energy consumption. The colors in each ﬁgure correlate.
The second optimization problem, based on the contributions in [6, 9], calculates the
optimal spring parameters of two torsional springs mounted in the ground joints. In this
case, the trajectory is modiﬁed until the relation between the angle of each proximal link
(φi) and the driving torque (Ti) is linear. Consequently, on each iteration, the torque is
calculated for the trajectory guess and a linear regression is applied between the torque
and the angle of the proximal link to obtain an estimator (T

i) for the torque. Once the
regression is good enough, the spring stiffness ki will be the negative of the slope (k∗
i )
of the resulting linear function, and the other spring parameter T0i will be the intercept.
Consequently, the equilibrium angle of the spring would be φeqi = T0i/ki.
T

i = k∗
i φi + T0i, i = 1, 4
(12)
For this optimization, the objective function, deﬁned by the sum of the mean squared
errors (MSE) of both regressions, is given by Eq. (13):
J2 =

i=1,4 (MSE)i i = 1, 4
(13)
Where each MSE, deﬁned as the average squared difference between the estimated
and the actual torque, is given by Eq. (14):
MSEi =

n
j=1
1
n

ˆTij −Tij
2
n →Observations and i = 1, 4
(14)

196
J. P. Mora et al.
If a perfect linear relation is obtained, the resulting trajectory would correspond to
the FVR of the mechanism with springs. Therefore, in absence of dissipative forces and
starting from the pick position, the system would oscillate between the pick and place
positions without any intervention from the motors.
Figure 3 and Table 1 summarize the results of this optimization. For eight different
tasks, the FVR and the corresponding spring parameters were calculated. Figure 3a
illustrates the motion of the end effector in the workspace and Fig. 3b, c show the
resulting linear relationship between the torque and the angle of the proximal links.
Additionally, Table 1 shows the resulting springs parameters and each of the MSE values
that were obtained with the linear ﬁts. The low values of the mean squared errors, MSE1
and MSE4, indicate that the behavior between the torque and the angle is very close to
be linear and that the algorithm works for several trajectories.
a) 
b)
c)
Fig. 3. FVR Trajectories. Polynomial trajectories with N = 7 and k = 5. No detention time and
task period of 2 s. Velocities and jerk at pick and place points are zero. a) Trajectories at workspace.
b) and c) Relationship between torque and angle. The colors in each ﬁgure correlate.
Table 1. Torsional spring parameters for each task and MSE for each regression.
Task
k1

Nm
rad

T01[Nm]
MSE1
×10−6[Nm]2
k4

Nm
rad

T04[Nm]
MSE4
×10−6[Nm]2
1
0.852
2.124
4.696
1.043
0.997
1.196
2
0.892
2.485
4.399
0.607
0.005
8.292
3
0.819
1.974
9.879
0.951
0.567
9.283
4
0.857
2.235
3.827
1.325
1.728
2.406
5
1.046
1.790
0.908
0.961
0.507
2.239
6
0.547
1.331
2.624
0.547
0.389
2.609
7
0.987
1.455
3.879
1.055
0.291
1.929
8
0.361
0.576
3.399
0.590
-0.327
0.490

Energy Optimization of a Parallel Robot in Pick and Place Tasks
197
Some experimental tests were performed in order to evaluate the possibility of imple-
menting springs and the free vibration trajectories. The FVR and the springs parameters
were calculated for Task 3 using a task period of 2 s and 0.67 s, then the motions
were implemented in the experimental prototype (without springs). Figure 4 illustrates
the experimental measurements and the simulation results of the torque (Ti) versus the
angle of each proximal link. Furthermore, a linear regression of the experimental data
was performed to assess the goodness of ﬁt of the measurements compared to the springs’
parameters obtained in the simulation.
a) 
b) 
Fig. 4. Experimental (Exp.) and simulated (Sim.) torque and angle for each proximal link. Task
period of a) 2 s, b) 0.67 s
The experimental results show a good correspondence with the simulations. The
relative error between the experimental and the simulated value of k∗and T0 indicates
that the required torque for the motion of the links during this trajectory could effectively
be balanced by constant-stiffness springs. However, Fig. 4 also shows that the springs
can only balance the inertial terms, while friction and other unmodeled forces still must
be compensated by the motors. Similarly, it is observed that the reduction of the cycle
time signiﬁcantly increases the effect of the inertial forces, especially because a direct
drive was employed (Table 2).
The method in [6, 9] is based on the idea of calculating the springs parameters for
a nominal task and keeping them ﬁxed independently of the task changes. However,
this can lead to an increase in the energy consumption for tasks that differ signiﬁcantly
from the nominal task. Thus, this contribution presents one alternative to improve the
versatility of the robot, while reducing the necessary changes on the system. The main
idea is that T0i can be modiﬁed when a new task, that differs signiﬁcantly from the
nominal one, is required. The new optimization problem in Eq. (15) also takes Eq. (10)
as the objective function but uses a new argument.
arg min
K∈R(N−1)×2
J1,
(15)

198
J. P. Mora et al.
Table 2. Slope and intercepts of the experimental and simulated results. The percentage errors
are shown.
Results
Task period of 2 s
Task period of 0.67 s
Sim.
Exp.
PE [%] Sim.
Exp.
PE [%]
k∗
1

Nm
rad

−0.82 −0.80 2.44
−7.38 −7.47 1.22
T01[Nm]
1.97
1.91 3.05
17.77
17.86 0.51
k∗
4

Nm
rad

−0.95 −0.93 2.11
−8.56 −8.65 1.05
T04[Nm]
0.57
0.53 7.02
5.10
5.32 4.31
Where, K is a (N −1) × 2 matrix, in which the ﬁrst row contains the values T01 and
T04, while the remaining rows contain the intermediate points of the trajectory.
a) 
b) 
Fig. 5. a) Trajectories for tasks 1, 2, 3, 6 and 8. b) Energy consumption of each method and task.
Figure 5 shows the results of this optimization problem. The springs were designed
for task number one (nominal), but four additional tasks were simulated. For this tasks,
three different methods were employed. Namely, a minimum-energy trajectory without
springs (ME), a minimum-energy trajectory with ﬁxed springs parameters (MES) and
a minimum-energy trajectory, in which the spring stiffness remains ﬁxed, but T0i is
optimized for each task (MET). Figure 5a shows the calculated trajectories for each
task and Fig. 5b. shows their corresponding estimated energy consumption. The MES
method leads to a reduction of the estimated energy consumption, with respect to the
ME method, of 60.7% for task 2, 92.0% for task 3, and 1.2% for task 6. Nevertheless,
when the MES method is applied to task 8, no reduction in the energy consumption is
obtained due to the big difference between the tasks.
Thereby, the MET method is presented as an alternative, in which T0i and the tra-
jectory are changed, to produce a drop in the energy consumption. Energy reductions

Energy Optimization of a Parallel Robot in Pick and Place Tasks
199
of 33.0%, 90.6%, 59.3% and 98.3%, with respect to the MES method, are obtained for
tasks 2, 3, 6 and 8, respectively. Similarly, energy reductions of 73.7%, 99.2%, 59.7%
and 51.3%, with respect to the ME method, are obtained for tasks 2, 3, 6 and 8, respec-
tively. This drop in the estimated energy consumption shows the great advantage of the
proposed method. However, it is important to consider the feasibility of implementing
these ideas, in terms of achieving the required spring parameters and trajectories, since
for some tasks high deﬂections on the springs may be obtained during the motion. This
should be examined in future work.
4
Conclusions
One strategy that has been proposed to reduce the energy consumption of industrial
robots performing pick and place tasks is to use constant-stiffness springs, incorporated
in parallel to the motors and designed for a nominal task, and to adjust the trajectory
that the robot follows for a general task. The underlying idea is that the springs provide
some of the necessary torque for the motion. In absence of dissipative forces, the robot
with springs should oscillate between the pick and place points without additional inter-
vention of the actuators. Moreover, the relation between the required torque to move the
mechanism without springs, following the free vibration response (FVR), and the angle
of the proximal links should be linear. The experimental results of this contribution show
a good correspondence between the simulated linear relation and the measured data. This
encourages the usage of this strategy to obtain a reduction in the energy consumption.
An adequate assembly of the calculated springs and the implementation of optimal
trajectories should reduce the energy consumption of robots performing pick and place
tasks. However, as the springs parameters are calculated for a nominal task, a signiﬁcant
changeinthetaskcouldgeneratearaiseintheenergyconsumption.Tostudytheinﬂuence
of the task variation, the MES method (optimal trajectory with ﬁxed spring parameters)
was implemented for a set of tasks. The results indicate that for some tasks that differ
signiﬁcantly from the nominal, no energy reduction is obtained by using the MES method
or the energy consumption is even increased. Consequently, a possible method to solve
this issue was presented in this contribution.
The proposed method (MET) consists in varying T0i, while keeping the same stiff-
ness that was calculated for the nominal task. The results show that even for tasks that
differ signiﬁcantly from the nominal, the MET method achieves a reduction on the esti-
mated energy consumption with respect to the mechanism without springs following a
minimum-energy trajectory (ME). Consequently, this method could be used to increase
the versatility of the robot with springs (the possibility to fulﬁll multiple tasks using a
single set of springs) and to compensate eventual variations between the designed and
the manufactured springs.
The results of the simulations indicate that the implementation of springs and the
studied optimization methods should reduce the energy consumption of the ﬁve-bar
linkage performing pick-and-place tasks. However, a deeper study on the experimental
implementation of the springs and the optimal trajectories is required and recommended
for future work. Finally, a further study on the variation of the task characteristics (pick
and place positions and cycle time) are suggested for future work.

200
J. P. Mora et al.
References
1. International Federation of Robotics. IFR. Executive Summary World Robotics 2020
Industrial Robots (2020)
2. Angeles, J.: Trajectory planning: pick and place operations. In: Angeles, J. (ed.) Fundamentals
of Robotic Mechanical Systems, pp. 233–256. Springer, Boston (2007). https://doi.org/10.
1007/978-0-387-34580-2_6
3. SP Automation & Robotics: Pick & Place Automation/Robotic Material Handling. https://
sp-automation.co.uk/pick-place-application/. Accessed 15 Dec 2020
4. Carabin, G., Wehrle, E., Vidoni, R.: A review on energy-saving optimization methods for
robotic and automatic systems. Robotics 6(4), 39 (2017)
5. Scalera, L., Palomba, I., Wehrle, E., Gasparetto, A., Vidoni, R.: Natural motion for energy
saving in robotic and mechatronic systems. Appl. Sci. 9(17), 3516 (2019)
6. Barreto, J.P.: Exploiting the natural dynamics of parallel robots for energy-efﬁcient pick-and-
place tasks. Dissertation/Ph.D. Thesis, Institute of Mechanism Theory, Machine Dynamics
and Robotics. RWTH Aachen University, Aachen (2021)
7. Barreto, J.P., Schöler, F. J.-F., Corves, B.: The concept of natural motion for pick and place
operations. In: Corves, B., Lovasz, E.-C., Hüsing, M., Maniu, I., Gruescu, C. (eds.) New
Advances in Mechanisms, Mechanical Transmissions and Robotics. MMS, vol. 46, pp. 89–98.
Springer, Cham (2017). https://doi.org/10.1007/978-3-319-45450-4_9
8. Barreto, J.P., Corves, B.: Matching the free-vibration response of a delta robot with pick-
and-place tasks using multi-body simulation. In: 2018 IEEE 14th International Conference
on Automation Science and Engineering (CASE), Munich, pp. 1487–1492 (2018)
9. Barreto, J.P., Corves, B.: Resonant delta robot for pick-and-place operations. In: Uhl, T. (ed.)
Advances in Mechanism and Machine Science IFToMM WC 2019. Mechanisms and Machine
Science, vol. 73, pp. 2309–2318. Springer, Cham (2019). https://doi.org/10.1007/978-3-030-
20131-9_228
10. Gallego Rivera, J.: Prototipo para el estudio de ahorro energético en operaciones pick and
place. Bachelor thesis (in Spanish), Universidad de los Andes, Bogotá, Colombia (2019)
11. Hermoza Franco, D.Y.: Mechanical design of a planar parallel kinematic manipulator
including elastic elements for energy recuperation. Mini thesis, Institut für Getriebetechnik,
Maschinendynamik und Robotik, RWTH Aachen University, Aachen, Germany (2019)
12. Rodríguez Herrera, C.F.: Modelado de mecanismos con coordenadas generalizadas. Depar-
tamento de Ingeniería Mecánica, Universidad de los Andes, Bogotá, Colombia
13. Huang, E.J.: Computer-Aided Kinematics and Dynamics of Mechanical Systems, vol. II:
Modern Methods, ResearchGate (2020)
14. Lorenz, M., et al.: Energy-efﬁcient trajectory planning for robot manipulators. In: ASME 2017
International Design Engineering Technical Conferences and Computers and Information in
Engineering Conference: Volume 5B: 41st Mechanisms and Robotics Conference, Cleveland
(2017)
15. Dai, Y.-H.: Convergence properties of the BFGS algorithm. SIAM J. Optim. 13, 693–701
(2002)
16. MathWorks: fminunc. https://www.mathworks.com/help/optim/ug/fminunc.html#but9rn9-5.
Accessed 13 July 2021
17. Biagiotti, L., Melchiorri, C.: Trajectory Planning for Automatic Machines and Robots.
Springer, Heidelberg (2008)

Gravity Compensation of Articulated Robots
Using Spring Four-Bar Mechanisms
Vu Linh Nguyen(B)
National Chin-Yi University of Technology, Taichung 411030, Taiwan
vlnguyen@ncut.edu.tw
Abstract. This paper presents a design method for gravity compensation of artic-
ulated robots. The method is realized by installing spring four-bar mechanisms
onto the robot to eliminate the gravity effect on its joints. This elimination allows
reducing the actuation torque and energy consumption of the robot during opera-
tion. The design of the spring mechanisms is obtained by solving an optimization
problem for minimizing the actuation torque of the robot. A numerical exam-
ple is provided to demonstrate the proposed design method, by which a signif-
icant reduction in the actuation torque over the robot workspace is received. A
simulation-based validation showed that the actuation torque of the robot could
be reduced by approximately 90% when the design method is applied.
Keywords: Gravity compensation · Static balancing · Planar four-bar linkage
1
Introduction
Reducing the motor effort and actuation torques of robotic manipulators has become
one of the main focuses in the advancement of green robotic systems [1]. The reduction
of actuation torque allows decreasing the energy consumption of the robot and operat-
ing costs [2]. When robots are performed at a low speed, the gravitational torques are
more signiﬁcant than the dynamic torques [3]. In this situation, the design for decreasing
the gravitational torques, i.e., gravity compensation, is beneﬁcial to reduce the actua-
tion torques and energy consumption. Gravity compensation can also increase robot
performance, safety, and efﬁciency [4].
To design a robotic manipulator with gravity compensation, passive energy elements,
such as counterweights [5, 6] or mechanical springs [7–9], are attached to the robot to
compensate for the variation of the potential energy of the robot. This compensation will
lead to decreasing the actuation torques of the robot. There are many gravity compen-
sation methods applied to robotic manipulators in the literature. For example, Lacasse
et al. [10] showed a seven-degrees-of-freedom (7-DoF) partially statically balanced
robot, where remote counterweights are connected to the robot through a low-pressure
hydraulic transmission. Kim et al. [11] presented a gravity compensation mechanism
based on a slider-crank mechanism and a spring. The spring mechanism is installed onto
a multi-DoF robot arm using a double-parallelogram mechanism and bevel gear units.
Nguyen et al. [12] proposed the design concept of a gear-spring module, and a series
© The Author(s), under exclusive license to Springer Nature Switzerland AG 2022
M. Pucheta et al. (Eds.): MuSMe 2021, MMS 110, pp. 201–209, 2022.
https://doi.org/10.1007/978-3-030-88751-3_21

202
V. L. Nguyen
of the modules were used for the gravity compensation of multi-DoF planar articulated
manipulators. Lee et al. [13] presented a wire-driven gravity compensation mechanism
and integrated it with timing belts and pulleys to build a multi-DoF gravity-balanced
robotic manipulator.
This paper will put forward a gravity compensation method for articulated robots to
reducetheactuationtorqueandenergyconsumption.Aspringfour-barmechanismisﬁrst
conceptualized for compensating the gravitational torque induced by a single rotating
weight. The signiﬁcance of the proposed mechanism is that it has a simple kinematic
structure and provides an excellent balancing performance. The spring mechanism is
then installed onto the robot for gravity compensation. A numerical example and a
simulation-based validation are provided to exhibit the performance of the proposed
design method.
The conceptual design for the gravity compensation of articulated robots is presented
in Sect. 2. Then, Sect. 3 details the gravity compensation method and design procedure.
The performance evaluation of the design method is shown in Sect. 4. Last, Sect. 5
concludes the present paper.
2
Conceptual Design
The gravity compensation design of an articulated robot is depicted in Fig. 1. A KUKA
KR 210 R3100 industrial robot [14] is taken as an example. Since the gravitational torque
of a joint is accumulated to its preceding joints, the last three joints near the end-effector
can be neglected in the compensation design. The ﬁrst joint (between links 0 and 1)
aligns with the direction of gravity. Thus, the gravity effect on this joint is theoretically
zero and also ignored.
For gravity compensation, two spring four-bar mechanisms OiAiBiCi (i = 1, 2) are
attached to the robot so that joints O1 and O2 are coincident with the shoulder (2nd)
joint (between links 1 and 2) and the elbow (3rd) joint (between links 2 and 3) of the
robot, respectively. Links OiAi and OiEi are ﬁxed to links i and i + 1, respectively. An
additional link A1A2 is used to maintain the direction of link O2A2 when link 2 is rotated.
Two tension springs ki are used, and each spring ki is connected from link BiCi (at point
Di) to link i + 1 (at point Hi).
3
Gravity Compensation Method
3.1
Gravitational Torques
Let mci, Li, lci denote the mass, link length, and location of the mass center of link i
+ 1 (i = 1, 2 for the robot links; i = 3 for a payload), respectively. Note that mc2 also
includes the masses of links 4, 5, and 6. Then, the gravitational torques Tgi at joints Oi
can be expressed as:
Tg1 = M1LC1g cos θ1 + M2LC2g cos θ2
(1)
Tg2 = M2LC2g cos θ2
(2)

Gravity Compensation of Articulated Robots
203
G1
x
y
θ1
k2
O2
θ2
G2
mc2g
mc3g
mc1g
k1
Payload
O3
G3
L1 = O1O2
L2 = O2O3
L3 = O3E
lc1 = O1G1
lc2 = O2G2
E
Shoulder 
(2nd) joint
Elbow 
(3rd) joint
O1
Link 0
A1
A2
B1
C1
E1
D1
Gravity
B2
D2
C2
E2
H1
H2
Link 1
Link 2
Link 3
Fig. 1. Conceptual design for the gravity compensation of an articulated robot.
where
M1 = mc1 + mc2 + mc3, M2 = mc2 + mc3, LC1 = mc1lc1 + (mc2 + mc3)L1
mc1 + mc2 + mc3
LC2 = mc2lc2 + mc3L2
mc2 + mc3
(3)
In Eqs. (1)–(3), θi and g represent the joint angle of link i + 1 and the gravitational
acceleration (g = 9.81 m/s2), respectively; Mi and LCi stand for the equivalent rotating
mass applying to joint Oi and its location, respectively.
Equation (2) shows that the gravitational torque Tg2 is independent of the joint
angle θ1. This means that the compensation design for this joint can be done without
considering the conﬁguration of link 2. If the gravitational torque Tg2 is canceled by the
elastic forces induced by the spring k2, the gravitational torque Tg1 in Eq. (1) will also
be independent of the joint angle θ2. Therefore, the compensation design for these two
joints can separately be performed if their equivalent masses (to be gravity compensated)
and their locations are known.
3.2
Actuation Torques
Figure 2 illustrates the free-body diagram of a spring four-bar mechanism. The mecha-
nism is assumed to counterbalance a weight mc with a distance lc from the mass center
G to the rotation joint O. Let Fs = [Fsx, Fsy]T denote the spring force vector applied at
point D, and it can be derived as:
Fs =
Fsx
Fsy

=
Fs cos γD
Fs sin γD

(4)

204
V. L. Nguyen
where
Fs = k(s1 + s0), γD = cos−1
 x • DH
∥x∥∥DH∥

(5)
In Eqs. (4) and (5), k, s1, s0, γ D, and x represent the spring stiffness coefﬁcient, spring
displacement, spring pre-extension, angle representing the direction of the spring force
Fs, and the unit vector of the x-axis, respectively.
O
A
B
D
x
y
G
H
E
-Fs
Fs = Fsμs
θ
F32
F34
-F32
-F34
l2
l3
l4
B
C
l3a
l3b
γD
Fsy
Fsx
C
T34
F32x
F32y
F34y
Tg
mcg
l4a
l4b
l1
TH
m2g
P2
m3g
P3
P4
m4g
F34x
H
D
Gravity
Fig. 2. Free-body diagram of a spring four-bar mechanism.
Recall that the equilibrium of forces for a body link i under static conditions can be
written as:

j
Fij +

k
Fik + mig = 0
(6)
where Fij and Fik stand for the reaction force vector and external force vector (i.e., the
gravitational and spring forces) exerted on the i-th link, respectively.
Next, the equilibrium of torques (or moments) for the i-th link is expressed as:

j

rij × Fij

+

k
(rik × Fik) + mi(rci × g) + Tmi = 0
(7)
where rij, rik, and rci are the position vectors associated with the reaction force Fij,
the external force Fik, and the mass center of link i, respectively; and Tmi denotes the
actuation torque acting on the i-th link.
By applying Eqs. (6) and (7) to links 2, 3, and 4, the actuation torque Tm at joint O
can be derived as:
Tm = T34 + TH −Tg
(8)

Gravity Compensation of Articulated Robots
205
where
T34 = xCF34y −yCF34x −xP4m4g
(9)
TH = xHFsy + yHFsx
(10)
Tg = −xGm4g
(11)
3.3
Design Procedure
The design of the spring four-bar mechanism aims to reduce the actuation torque Tm.
Alternatively, minimizing the torque reduction ratio (TRR), i.e., the actuation torque Tm
over the gravitational torque –Tg, can be considered a design objective. For a range of the
joint angle θ, only the peak actuation torque is considered. Therefore, an optimization
design problem is established as:
Minimize
max{|Tm(X, θ)|}
max
	

−Tg(X, θ)



with
X = [l1, l2, l3, l4, ls, l3a, l3b, l4a, l4b, k, s0], X ∈ℜ
subject to
θ = [θint, θend]
l1, l2, l3, l4, ls, l3a, l3b, l4a, l4b, k > 0
s0 ≥0
(12)
where θint and θend stand for the initial and end joint angles of the spring four-bar
mechanism,respectively.Thesetwoanglescanalsobeusedtodeﬁnetherobotworkspace
(see Fig. 1).
The design procedure for the gravity compensation of an articulated robot using the
spring four-bar mechanisms (see Fig. 2) can be detailed as:
– Step 1. Determine the equivalent rotating masses impacting the shoulder and elbow
joints and their locations using Eq. (3);
– Step 2. Deﬁne the input parameter vector X of each spring mechanism and the joint
angles (θ1, θ2);
– Step 3. Use the Genetic Algorithm (GA) to solve the optimization design problem in
Eq. (12) for each spring mechanism.
4
Performance Evaluation
This section shows a case study for the gravity compensation of the KUKA robot in
Fig. 1. The link lengths and masses of the robot are estimated from the CAD model of
the robot, as listed in Table 1. The joint angles of the robot are limited within θ1 = [0,
π/2] and θ2 = [–π/3, π/3].

206
V. L. Nguyen
Table 1. Estimated parameters of the KUKA KR 210 R3100 robot.
L1 (m)
L2 (m)
L3 (m)
lc1 (m)
lc2 (m)
mc1 (kg)
mc2 (kg)
mc3 (kg)
1.35
1.4
0.256
0.525
0.482
349
324
30
Table 2. Optimal parameters of the spring four-bar mechanisms.
4-bar
l1 (m)
l2 (m)
l3 (m)
l4 (m)
ls (m)
l3a (m)
l3b (m)
l4a (m)
l4b (m)
k (N/mm)
s0 (m)
1st
0.10
0.25
0.294
0.284
1.147
0.298
0.197
0.244
0.17
616
0.113
2nd
0.132
0.244
0.237
0.236
0.86
0.249
0.13
0.28
0.146
231.8
0.065
By solving the optimization design problem in Eq. (12) using the GA method, the
best objectives of the compensation designs for joints O1 and O2 are illustrated in Fig. 3.
It shows that the best objective for joint O1 converges to a minimum value of 0.018529
within 119 iterations. The design for joint O2 provides a smaller best objective, i.e.,
0.018418, but it requires 344 iterations for convergence. Based on the obtained results,
the optimal parameters of the spring four-bar mechanisms can be found, as presented in
Table 2.
Number of iteration
Best objective (TRR)
O1
O2
Fig. 3. Convergence of the best objectives with GA optimization.
By adopting the data given in Table 1 and Table 2, the total actuation torques before
and after gravity compensation (called the original and compensated torques) over the
considered workspace are illustrated in Fig. 4. There is a signiﬁcant reduction in the actu-
ation torque at any position in the workspace. The maximum original torque (Fig. 4(a))
is about 9096.4 N-m, which is much higher than the compensated one (Fig. 4(b)), i.e.,

Gravity Compensation of Articulated Robots
207
167.8 N-m. These results indicate that the actuation torque of the robot can be reduced
by up to 98.2%.
Fig. 4. Distribution of the total actuation torque: (a) original and (b) compensated torque.
Let us take the KUKA robot into the MSC Adams simulation. The robot is assumed
to track a trajectory, as depicted in Fig. 5(a). During the tracking, the original and
compensated torques of the robot at the 2-nd and 3-rd actuation joints are measured,
and the results are shown in Fig. 5(b). The compensated torques at the two joints are
considerably smaller than the original ones. At the 2-nd joint, the maximum actuation
torque is about 6204 N-m, and it is reduced to 663 N-m when the compensation design
is applied. These results mean that the torque reduction rate at this joint could be up
to 89.3%. Similarly, the actuation torque at the 3-rd joint is reduced from 2000 N-m to
82 N-m, equivalent to 95.9%. Note that when the payload mc3 is varied, it is necessary
to rerun the optimization algorithm.
5
Conclusion
This paper has proposed a gravity compensation method for articulated robots using
the spring four-bar mechanisms. The design of the spring mechanisms was realized
via minimizing the actuation torques of the robot with GA optimization. A case study
was presented where the total torque of the robot was considerably reduced over its
workspace. The effectiveness of the design method was also validated using MSC Adams
simulation. A simulation example showed that the actuation torque of the robot could
be reduced by more or less 90%.

208
V. L. Nguyen
Fig. 5. Simulation with the KUKA robot: (a) studied trajectory and (b) actuation torques.
Acknowledgments. This paper was supported by the Ministry of Science and Technology
(MOST), Taiwan (grant number MOST 110-2222-E-167-004).
References
1. Brossog, M., Bornschlegl, M., Franke, J.: Reducing the energy consumption of industrial
robots in manufacturing systems. Int. J. Adv. Manuf. Technol. 78(5–8), 1315–1328 (2015)
2. Richiedei, D., Trevisani, A.: Optimization of the energy consumption through spring
balancing of servo-actuated mechanisms. ASME J. Mech. Design 142(1), 012301 (2020)
3. Arakelian, V.: Gravity compensation in robotics. Adv. Robot. 30(2), 79–96 (2016)
4. Carricato, M., Gosselin, C.: A statically balanced Gough/Stewart-type platform: conception,
design, and simulation. ASME J. Mech. Robot. 1(3), 031005 (2009)
5. Van der Wijk, V.: Design and analysis of closed-chain principal vector linkages for dynamic
balance with a new method for mass equivalent modeling. Mech. Mach. Theory 107, 283–304
(2017)
6. Kuo, C.-H., Nguyen, V.L., Robertson, D., Chou, L.-T., Herder, J.L.: Statically balancing a
reconﬁgurable mechanism by using one passive energy element only: a case study. ASME J.
Mech. Robot. 13(4), 040904 (2021)
7. Herder, J.L.: Energy-free systems: theory, conception and design of statically balanced spring
mechanisms. Ph.D. thesis, Delft University of Technology, Delft, The Netherlands (2001)
8. Nguyen, V.L., Lin, C.-Y., Kuo, C.-H.: Gravity compensation design of Delta parallel robots
using gear-spring modules. Mech. Mach. Theory 154, 104046 (2020)
9. Essomba, T.: Design of a ﬁve-degrees of freedom statically balanced mechanism with multi-
directional functionality. Robotics 10(1), 11 (2021)
10. Lacasse, M.-A., Lachance, G., Boisclair, J., Ouellet, J., Gosselin, C.: On the design of a
statically balanced serial robot using remote counterweights. IEEE International Conference
on Robotics and Automation (ICRA), Karlsruhe, Germany, pp. 4189–4194 (2013)
11. Kim, H.-S., Min, J.-K., Song, J.-B.: Multiple-degree-of-freedom counterbalance robot arm
based on slider-crank mechanism and bevel gear units. IEEE Trans. Rob. 32(1), 230–235
(2016)

Gravity Compensation of Articulated Robots
209
12. Nguyen, V.L., Lin, C.-Y., Kuo, C.-H.: Gravity compensation design of planar articulated
robotic arms using the gear-spring modules. ASME J. Mech. Robot. 12(3), 031014 (2020)
13. Lee, D., Seo, T.: Lightweight multi-DOF manipulator with wire-driven gravity compensation
mechanism. IEEE/ASME Trans. Mechatron. 22(3), 1308–1314 (2017)
14. KUKA Robotics: The KR QUANTEC series, KR 210 R3100. KUKA Industrial Robotics-
High Payloads (2016)

Mechatronic Design

Structural Design and Sliding Mode
Control Approach of a 4-DoF
Upper-Limb Exoskeleton for Post-stroke
Rehabilitation
Johan Nu˜nez-Quispe(B), Alvaro Figueroa, Daryl Campusano,
Johrdan Huamanchumo, Axel Soto, Ebert Chate, Jesus Acu˜na, Juan Lleren,
Jose Albites-Sanabria, Leonardo Paul Mili´an-Ccopa, Kevin Taipe,
and Briggitte Suyo
Advanced Biomechatronics Research and Innovation Laboratory,
Universidad Nacional de Ingenier´ıa, Lima, Peru
{johan.nunez.q,efigueroac}@uni.pe
Abstract. In this research, a 4-DoF upper limb exoskeleton was
designed to assist patients while performing cross-pattern movements in
a Proprioceptive Neuromuscular Facilitation (PNF) rehabilitation task.
The mechanical design included 3 DoF for the shoulder and one for the
elbow. The exoskeleton was designed and validated by structural sim-
ulation based on ﬁnite element analysis. The rehabilitation trajectory
was obtained from a healthy person by image processing and a Sliding
Mode Control (SMC) strategy was applied for tracking. Results from the
structural simulation show that the factor of safety is over 1.3 on average
for the proposed exoskeleton design. In addition, results show that the
controller is robust to variations in the arm weight, with a tracking error
of less than 0.0025 rad.
Keywords: Upper-limb exoskeleton · Sliding mode control ·
Mechanical design · Finite element analysis · Robot-aided rehabilitation
1
Introduction
PNF is an approach to exercise therapy that uses speciﬁc movement patterns
in diagonal and spiral directions together with speciﬁc techniques that facilitate
the increase in strength and muscle function. An important principle of PNF is
that after a muscle has contracted maximally, it will then relax maximally. Then,
its opposite counterpart (antagonist) will relax maximally. This can be used by
asking the patient to maximally contract the agonist to the muscle to be mobi-
lized followed by application of a stretch [1,3,16]. Regarding great precision and
accuracy for repetitive movements with robotic systems, exoskeletons for assisted
therapy have been widely adopted in recent years to improve and evaluate motor
skills such as muscle strength, velocity, and proﬁciency in activity of daily life
c
⃝The Author(s), under exclusive license to Springer Nature Switzerland AG 2022
M. Pucheta et al. (Eds.): MuSMe 2021, MMS 110, pp. 213–223, 2022.
https://doi.org/10.1007/978-3-030-88751-3_22

214
J. Nu˜nez-Quispe et al.
[5]. In recent years, diﬀerent exoskeleton models have been developed to achieve
optimal trajectory tracking. The design, modelling and implementation of an
upper limb exoskeleton controlled by movement commands was designed in [11].
The authors analyzed the mean error and response time for each joint angle,
but they did not reduce the tracking error using control methods. In [9], a fuzzy
sliding mode controller was applied to a 5-DoF upper-limb exoskeleton robot for
position tracking, although they achieved a chattering-free control and reduced
mathematical calculation volume, their motors required a very high torque value
to control the system.
The application of these technologies seeks a physical conﬁguration of the
robotic system that adapts, mainly, to a comfortable position of the patient’s
limb on the robotic arm [4,7]. For the mechanical modeling and simulation, the
exoskeleton design was simpliﬁed in order to reduce simulation time keeping the
material properties for each piece, as developed in [2,4], and virtual materials as
explained below.
2
Methodology
2.1
Mechanical Design
For the mechanical design, the following degrees of freedom were considered: 3
DoF for the shoulder and 1 DoF for the elbow. [2,5]. In contrast with other
exoskeleton designs [2,13], the proposed structure allows to be manufactured
without cutting and excessive welding and only need manufacturing processes
such as folding and milling (see Fig. 1).
In order to validate the proposed mechanical design, a mechanical model was
prepared with the real boundary conditions, contacts, interactions and materials
as shown in Fig. 2a according to [4,7]. Regarding boundary conditions (Fig. 2b),
they were reduced to 3 conditions to reduce the simulation time. To have a
good mass estimation for these components, two new virtual materials, which
represent only the mass properties of the components, were set up. In Eqs. (1)
and (2), the mass estimation and density for each component are described,
respectively.
mc =
nc

i=1
mi
(1)
ρc = mc
Vc
(2)
Where nc is the number of pieces in each component. This means that the mass of
complex components were approximated while maintaining general mechanical
properties to reduce simulation time. Table 1 shows the properties of the obtained
virtual materials for the motor and gearbox.

Structural Design and Sliding Mode Control Approach
215
Fig. 1. Mechanical design scheme and applied manufacturing processes.
Fig. 2. Upper-limb exoskeleton. (a) Contacts and joints. (b) Boundary conditions.
Table 1. Materials properties used on the exoskeleton design and simulation
Material
Elastic
module [MPa]
Poisson’s
ratio
Mass density
[kg/m3]
Elastic limit
[MPa]
Duraluminum
73000
0.33
2800
480
Motor
69000
0.33
3475.421
255
Gearbox
200000
0.26
4653.378
550

216
J. Nu˜nez-Quispe et al.
After the boundary conditions were set up, the model was fully prepared
for the structural simulation after modeling the CAD assembly on Solidworks
software, according to the procedure explained above. Results for mechanical
model were interpreted by the authors by analyzing the structural simulation,
speciﬁcally for Von Mises stress deﬁned in Eq. (3), contacts interaction and factor
of safety (FOS) determined by Eq. (4) according to [15], given as follows:
σV m =

1
2[(σ1 −σ2)2 + (σ1 −σ3)2 + (σ2 −σ3)2]
(3)
FOS =
σy
σV m
(4)
Where σV m is the stress according to Von Mises failure theory in MPa, σi:1,2,3
are the main stress on a certain point, σy is the tensile yield stress for the
material in MPa, and FOS is the factor of safety [15]. As mentioned before,
the structural simulation software use mathematical models based on Eq. (3),
Eq. (4) to determine the mentioned parameters [4,8].
2.2
Rehabilitation Trajectory
PNF therapy of the upper limb rehabilitation process was performed by a healthy
person for 10 s (see Fig. 3a). To obtain the trajectory, the Kinect for Xbox 360
was employed. This camera is widely used for trajectory tracking [10]. It has two
sensors: an infrared depth sensor and an RGB color sensor. The Brekel Kinect
Pro V1 software was used to record the elbow and shoulder data. This data was
collected in a ﬁle with the extension bvh (biovision hierarchy), which provides
motion capture data. Twenty four points of the human skeleton were registered,
but only the points located in the wrist, elbow and shoulder of the right arm were
considered. For the calculation of the rotation angles q1, q2, q3 and q4, shown in
Fig. 3b, transformation matrices were used. The vectors that join the shoulder-
elbow in the front and top plane allows to ﬁnd q1 and q2 respectively. Similarly,
the vectors that join the shoulder-elbow and elbow-wrist in the lateral plane
were used to ﬁnd q3 and q4 respectively. In addition, due to small ﬂuctuations
in the movement of the upper limb, a ﬁrst-order Butterworth low-pass ﬁlter was
applied to smooth the trajectory.

Structural Design and Sliding Mode Control Approach
217
Fig. 3. (a) Recording of skeleton coordinates in Brekel Kinect Pro V1 software. (b)
Obtaining the rotation angles in the MATLAB IDE.
2.3
Control Design
2.3.1
Dynamic Analysis
To deﬁne the dynamics of the exoskeleton, the reference frames are ﬁrst attached
according to Denavit-Hartenberg (DH) convention. Table 2 shows the DH param-
eters of the exoskeleton. The dynamic model of the 4-DoF exoskeleton is deﬁned
using the energy method based on the Lagrange Euler equation [6], which is
expressed as:
D(q)¨q + N(q, ˙q) = u
(5)
N(q, ˙q) = C(q, ˙q) ˙q + g(q) + FF( ˙q)
(6)
where q ∈R4 are the angular positions of each joint, u is the control signal,
D(q) ∈R4x4 is the inertia matrix, C(q, ˙q) ∈R4x4 is the Coriolis matrix and
g(q) ∈R4 is the gravity vector, FF( ˙q) ∈R4 the viscous friction torque. N(q, ˙q)
represents the internal forces and torques of the system.
Table 2. DH parameters of the exoskeleton
Joint a
d
θ
α
1
0
d1 q1
π/2
2
0
d2 q2 + π/2 π/2
3
a3 0
q3 + π/2 0
4
a4 0
q4
0

218
J. Nu˜nez-Quispe et al.
2.3.2
Sliding Mode Control
The sliding surface for each joint is expressed in Eq. (7) as:
si = λei + ˙ei,
1 ≤i ≤4 ∧λi > 0
(7)
where ei is the tracking error for each joint, and is deﬁned in Eq. (8) as:
ei = qi −qdi
1 ≤i ≤4
(8)
where qi is the angular position of each joint and qdi the desired angular position.
The control law must satisfy the condition deﬁned in Eq. (9), considering the
Lyapunov candidate function for each component:
Vi = 1
2S2
i
(9)
Finally, the control law is expressed as:
u = D.(¨qd −λ˙e + N −k.sat( s
φ))
(10)
where ki are the required control resources and λi are scalar gains to establish
the rate of exponential convergence to zero of the tracking error after the system
reaches si = 0. ki are deﬁned in Eq. (11) from [12]:
ki > D+
ii.(λi.|˙ei| + |¨qdi| +
1
D−
ii
.(N +
i +
n

j=1,j̸=i
D+
ij.|¨qj|))
(11)
Where D−
ij(q) ≤Dij(q) ≤D+
ij(q) and N −
i (q, ˙q) ≤Ni(q, ˙q) ≤N +
i (q, ˙q), 1 ≤i ≤
4, 1 ≤j ≤4.
3
Results
3.1
Structural Simulation
In this analysis, the critical zones that concentrate the stress are determined (see
Fig. 4). This information is used to ﬁnd the factor of safety (FOS) of the whole
assembly [4]. Besides, the stress on every contact and joint was calculated using a
Finite Element Analysis (FEA) software to determine if it was necessary to add
any additional layer between each contact. For this assembly, a rigid neoprene
layer between two pieces made of duraluminum and aluminum was added.
After running the simulation, the FOS had a minimum value of 1.3007 as
shown in Fig. 4. In order to improve and assure a good material selection and
mechanical design, it was necessary to check if any contact or joint had a stress

Structural Design and Sliding Mode Control Approach
219
over the elastic limit. Analyzing the results, it is clear that the maximum equiv-
alent stress is under the limit for each piece in the assembly (see Table 1).
Fig. 4. Structural simulation for exoskeleton assembly, contacts and FOS.
3.2
Controller Performance
In this section, the performance of the Sliding Mode control algorithm for the
exoskeleton with and without load is shown. The load is represented by a human
arm, whose density and length were extracted from [14].
The values of the parameters that deﬁne k (see Eq. (11)) are shown in Table 3.
Table 3. Parameters of the control resources ki
k1
k2
k3
k4
N +
1 = 20.384 N +
2 = 23.570 N +
3 = 18.019 N +
4 = 6.461
D+
11 = 0.622
D+
22 = 0.502
D+
33 = 0.309
D+
44 = 0.012
D−
11 = 0.225
D−
22 = 0.201
D−
33 = 0.309
D−
44 = 0.012
D+
12 = 0.622
D+
21 = 0.147
D+
31 = 0.347
D+
41 = 0.015
D+
13 = 0.622
D+
23 = 0.157
D+
32 = 0.157
D+
42 = 0.003
D+
14 = 0.622
D+
24 = 0.003
D+
34 = 0.014
D+
43 = 0.014
∅1 = 0.8
∅2 = 0.8
∅3 = 0.8
∅4 = 0.8
λ1 = 16
λ2 = 16
λ3 = 40
λ4 = 40

220
J. Nu˜nez-Quispe et al.
Results of the trajectory tracking simulation applying an SMC controller
without load are shown in Fig. 5. The joint angles converge rapidly to the desired
path. The convergence time is less than 0.5 s and the tracking error is less than
0.00012 rad.
Fig. 5. (a) Desired and actual trajectory of each joint. (b) Torques and tracking error
of each joint.
Results of the trajectory tracking simulation applying an SMC controller
with load are shown in Fig. 6. The joint angles converge faster to the desired
trajectory despite the applied load. The convergence time is less than 0.5 ss and
the tracking error is less than 0.0025 rad.

Structural Design and Sliding Mode Control Approach
221
Fig. 6. (a) Desired and actual trajectory of each joint. (b) Torques and tracking error
of each joint.
4
Conclusions
The structural simulation for the proposed upper-limb exoskeleton design showed
a stress concentration on the contacts and joints between the harmonic gearboxes
and manufactured parts. The obtained FOS, which indicates safety against fail-
ure, is over 1.3007 for the proposed mechanical structure. The structural sim-
ulation workﬂow can be applied to other robotic systems based on exoskele-
tons in order to validate their minimum requirements. The results of the image
processing with the Kinect for Xbox 360 allowed to model the desired trajec-
tory in 3D eﬀectively and the post-processing done in MATLAB for PNF ther-
apy was optimal for the control process, due to the similarities of the captured
and simulated motion. A SMC controller was designed for the exoskeleton for
trajectory-tracking tasks. According to the error values shown in Fig. 5 and 6,
there is a small variation between both tests, which shows the robustness of the
SMC algorithm, so it is adaptable to diﬀerent arm weights. According to the

222
J. Nu˜nez-Quispe et al.
obtained results, the required torque to complete the task without load was less
than 20 N.m, but there was a small increase with load, and to move the ﬁrst
and third articulations, the highest torque values are needed. In future works,
the controller will be implemented using a digital signal processor to verify its
performance.
References
1. Aguirre Izurieta, G.I.: Facilitaci´on neuromuscular propioceptiva en hemiplej´ıa. B.S.
thesis, Universidad Nacional de Chimborazo, 2019 (2019)
2. bin Abdul Hamid, M.F., bin Mohd Ramli, M.H., Che Zakaria, N.A., Mohamed, Z.:
Conceptual design and FEM analysis of an exoskeleton suit for post-stroke patient:
a lower limbs Exo suit. In: Shiraishi, Y., Sakuma, I., Naruse, K., Ueno, A. (eds.)
APCMBE 2020. IP, vol. 82, pp. 126–134. Springer, Cham (2021). https://doi.org/
10.1007/978-3-030-66169-4 17
3. Hsieh, H.C., Chen, D.F., Chien, L., Lan, C.C.: Design of a parallel actuated
exoskeleton for adaptive and safe robotic shoulder rehabilitation. IEEE/ASME
Trans. Mechatron. 22, 2034–2045 (2017)
4. Johan, N., et al.: Preliminary design of an intention-based semg-controlled 3 dof
upper limb exoskeleton for assisted therapy in activities of daily life in patients
with hemiparesis. In: 2020 8th IEEE RAS/EMBS International Conference for
Biomedical Robotics and Biomechatronics (BioRob), pp. 292–297 (2020). https://
doi.org/10.1109/BioRob49111.2020.9224397
5. Kapsalyamov, A., Hussain, S., Jamwal, P.K.: State-of-the-art assistive powered
upper limb exoskeletons for elderly. IEEE Access 8, 178991–179001 (2020)
6. Lorenzo Sciavicco, B.S.: Modelling and Control of Robot Manipulators. Springer,
Heidelberg (2000)
7. Quispe, J.N., Solis, D.C., Le´on, J.H., Ccopa, L.M.: Performance comparison
between pd and pid controller in an upper limb exoskeleton by analyzing an arm
trajectory modeled with image recognition. In: 2020 IEEE Engineering Interna-
tional Research Conference (EIRCON), pp. 1–4 (2020). https://doi.org/10.1109/
EIRCON51178.2020.9254082
8. Ravindran, M., Aswatha, M., Santhosh, N., Ravichandran, G., Madhusudhan, M.:
Eﬀect of heat treatment on fatigue characteristics of en8 steel. IOP Conference
Series: Mater. Sci. Eng. 1013, 012009 (2021). https://doi.org/10.1088/1757-899x/
1013/1/012009
9. Razzaghian, A., Moghaddam, R.K.: Fuzzy sliding mode control of 5 dof upper-limb
exoskeleton robot. In: 2015 International Congress on Technology, Communication
and Knowledge (ICTCK), pp. 25–32. IEEE (2015)
10. Saha, S., Lahiri, R., Konar, A., Banerjee, B., Nagar, A.K.: Hmm-based gesture
recognition system using kinect sensor for improvised human-computer interaction.
In: 2017 International Joint Conference on Neural Networks (IJCNN), pp. 2776–
2783 (2017)
11. Morales, M., Mosquera, G., S´anchez, M., Chamorro, W.: Upper limb exoskeleton
design and implementation to control a robotic arm. In: 2017 International Con-
ference on Information Systems and Computer Science (INCISCOS), pp. 73–78
(2017). https://doi.org/10.1109/INCISCOS.2017.51
12. Utkin, V., Guldner, J., Shi, J.: Sliding Mode Control in Electro-Mechanical Sys-
tems. CRC Press, Boca Raton (2009)

Structural Design and Sliding Mode Control Approach
223
13. Wang, X., Song, Q., Wang, X., Liu, P.: Kinematics and dynamics analysis of a 3-
dof upper-limb exoskeleton with an internally rotated elbow joint. Appl. Sci. 8(3),
464 (2018)
14. Winter, D.A.: Biomechanics and Motor Control of Human Movement. Wiley, Hobo-
ken (2009)
15. Zhang, J., Jiang, H., Kang, G., Jiang, C., Lu, F.: A new form of equivalent stress for
combined axial-torsional loading considering the tension-compression asymmetry
of polymeric materials. RSC Adv. 5, 72780–72784 (2015). https://doi.org/10.1039/
C5RA15230E
16. Zhang, L., Li, J., Su, P., Song, Y., Dong, M., Cao, Q.: Improvement of human-
machine compatibility of upper-limb rehabilitation exoskeleton using passive joints.
Robot. Auton. Syst. 112, 22–31 (2019)

Mechatronic Design of a Planar Robot
Using Multiobjective Optimization
Alejandra Rios Suarez1, S. Ivvan Valdez2, and Eusebio E. Hernandez1(B)
1 Instituto Politecnico Nacional ESIME Ticoman, Av. Ticoman 600,
Mexico City, Mexico
arioss1000@alumno.ipn.mx, euhernandezm@ipn.mx
2 CONACYT-Centro de Investigaci´on en Ciencias de Informaci´on Geoespacial,
CENTROGEO, A.C., Parque Tecnol´ogico San Fandila, C.P. 76703 Mexico City,
Quer´etaro, Qro, Mexico
sergio.valdez@conacyt.mx
Abstract. The concurrent design optimization of robots refers to the
problem of optimizing parameters that aﬀects diﬀerent kinds of features
at the same time. For instance, this work presents a study case for the
concurrent design optimization of the structure and control of a paral-
lelogram mechanism. The main contribution of this work is the deﬁni-
tion of an integrated optimization model that considers two conﬂicting
objectives, deﬁned as the energy and error during a trajectory tracking.
In addition, the optimization model considers an error constraint, with
the purpose of automatically discarding designs that can not closely fol-
low the trajectory, and the simulation considers a saturation constraint
that avoids to deliver torques above a threshold. The multi-objective
optimization problem is solved using the Multi-objective Evolutionary
Algorithm Based on Decomposition (MOEA/D), the resulting solutions,
named Pareto set, are delivered to a ﬁnal decision maker, to select the
adequate design among those with the best compromise between mini-
mum tracking error and energy consumption. A design is a set of lengths
and control gains, hence, notice that the control gains are optimized for
the corresponding geometry.
Keywords: Concurrent design · Multi-objective optimization · Two
input parallelogram mechanism · Pareto set solution
1
Introduction
Traditionally, the mechanism to be controlled is designed ﬁrst and independently
of the control scheme. Thus, the control of parallel robots for high performance
and high-speed tasks can be a challenge to control engineers. The design pro-
cess of robotic systems can beneﬁt greatly from the mechatronic design, which
is the concurrent optimal design of a mechanical system and its embedded con-
trol for a given objective function during the same optimization process [3,16].
c
⃝The Author(s), under exclusive license to Springer Nature Switzerland AG 2022
M. Pucheta et al. (Eds.): MuSMe 2021, MMS 110, pp. 224–231, 2022.
https://doi.org/10.1007/978-3-030-88751-3_23

Mechatronic Design Using Multiobjective Optimization
225
The optimal design of parallel structures can be stated as a traditional opti-
mization problem, but it can be attracted by local minima, it can be sensitive
to initial conditions or involve the computation of gradients of the objective
function. In [10], a least-square based scheme for the dimensional optimization
of a double-rocker linkage is presented. The optimum dynamic balancing of the
four-bar mechanism is reported in [1]. Referring the parallelogram structure:
the design of a haptic device by considering size, workspace, inertia, and struc-
tural properties is described in [9]; in [11], authors consider the mass balancing
to simplify the dynamic model, and so design a controller for tracking path.
The simultaneous plant-controller design optimization of mechatronics systems
is a complex nonlinear optimization problem due to the presence of non-convex,
non-diﬀerentiable, multiple, dynamic objectives and constraints. To circumvent
the above-described problems of classical approaches, optimization techniques
based on metaheuristic methods [5] have been used in the design process of dif-
ferent mechatronic systems. For instance, an evolution strategy has been selected
for optimizing both the design parameters and non linear PD controller gains
of a two-link planar manipulator [14]. In [13], diﬀerential evolution is used to
improve the parametric reconﬁguration of a ﬁve-bar linkage. Others works have
used genetic algorithm [2], non-dominated sorting genetic algorithm II [6,8,12]
or estimation of distributions algorithms [17] for the optimization process.
There are two basic approaches for concurrent optimization; the ﬁrst is to
convert the multiobjective problem to a mono-objective problem via a scalar-
ization function. This approach makes assumptions about the ﬁnal solution to
set a priori weights or the target point. The second approach is to deal with
the multiobjective problem by searching for a set of solutions that are con-
sidered equally optimal, then a posteriori, a single solution is selected. In this
context, some authors have preferred to circumvent the problem of multiob-
jective optimization, for instance, in [4] the authors convert a multiobjective
problem into a single objective problem via a scalarization function that assigns
a reward to a combination of distance to the target position and stiﬀness val-
ues. In the same regard, in [15], a task-oriented optimization for the path and
geometry of a robot is approached. The authors convert a bi-objective problem
into a two-stage optimization problem, optimizing two single objective functions
sequentially. In contrast, our approach is to concurrently optimize two conﬂict-
ing objective functions, deﬁned as the energy and error during a speciﬁc path,
to ﬁnd the Pareto front. Thus, both the structure and the controller designs are
synthesized. The multi-objective optimization problem is formulated and solved
by using the MOEA/D. Notice that the Pareto front provides information about
the trade-oﬀbetween optimal solutions and the best and worst performed solu-
tions in the optimal set; hence, having the whole solution set is essential for
making informed engineering decisions.

226
A. R. Suarez et al.
2
Mechanism Description
Fig. 1. A mechanical diagram of the parallelogram mechanism system used as a case
of study
2.1
Kinematics
In reference to Fig. 1, Li denotes the element lengths, lci refers to the location
of the center of mass of each element and ϕ1,2 is the angular positions for both
actuated elements, the direct kinematics is given as follows:
x
y

=
L1 cos ϕ1 −L4 cos ϕ2
L1 sin ϕ1 −L4 sin ϕ2

.
(1)
Therefore, the inverse kinematics is computed according to Eqs. (2) and (3),
ϕ1 = tan−1 y
x

−tan−1

L4 sin γ
L1 + L4 cos γ

and
ϕ2 = ϕ1 + (γ + π),
(2)
where γ = tan−1

−
√
1 −d2
d
	
and
d = cos γ = x2 + y2 −L2
1 −L2
4
2L1L4
(3)
Moreover, the Jacobian of this mechanism is deﬁned in terms of the Cartesian
velocities ˙x and ˙y and the derivative of the generalized coordinates vector ˙q =
[ ˙ϕ1 ˙ϕ2]′ with the following expression: ˙x = J(q) ˙q. The Jacobian matrix is deﬁned
for this problem as in the Eq. (4) below,
J(q) =

−L1 sin ϕ1 L4 sin ϕ2
L1 cos ϕ1 −L4 cos ϕ2

(4)
2.2
Dynamic Model
The dynamic model without friction consideration is described as follows [17]:
d11 ¨
ϕ1 + dd12 ¨
ϕ2 + (m3L2lc3 −m4L1lc4) sin ϕ2 −ϕ1 ¨
ϕ2
2 + φ1(ϕ1) = τ1
(5)
d21 ¨
ϕ1 + dd22 ¨
ϕ2 + (m3L2lc3 −m4L1lc4) sin ϕ2 −ϕ1 ¨
ϕ1
2 + φ2(ϕ2) = τ2
(6)

Mechatronic Design Using Multiobjective Optimization
227
with
d11 = m1l2
c1 + m3l2
c3 + m4L2
1 + I1 + I3, d12 = (m3L2lc3 −m4L1lc4) cos(ϕ2 −ϕ1),
d21 = d12,
φ(ϕ1) = g cos ϕ1(m1lc1 + m3Lc3 + m4L1),
d22 = m2l2
c2 + m3L2
2 + m4l2
c4 + I2 + I4, φ(ϕ2) = g cos ϕ2(m2lc2 + m3L2 + m4lc4).
I1, I2, I3, I4 are the moments of inertia of the elements, m1, m2, m3, m4 are
their masses and g is the acceleration of gravity. Besides, τ1 and τ2 denote
the input torques. Notice that assuming the equality (m3L2lc3 = m4L1lc4) the
dynamic model is simpliﬁed since the centrifugal terms are eliminated from the
inertial matrix, yielding the following decoupled form:
d11 ¨
ϕ1 + φ1(ϕ1) = τ1
and
d22 ¨
ϕ2 + φ2(ϕ2) = τ2
(7)
3
Optimization Approach
The
Multi-Objective
Evolutionary
Algorithm
based
on
Decomposition
(MOEA/D) is used for the optimal design task. This optimization looks for
the best dimensional and control parameters for the robot to track a pre-deﬁned
trajectory. The error in the tracked trajectory and consumed energy are both
intended to be minimized. The proposed trajectory is the Pascal snail path, that
is described as a parametric equation with polar coordinates r = a cos θ +b. The
simulation is conﬁgured to have a duration of 30 s, and the dynamic model is
adjusted for convenience under the condition L1 = L3. Elements lengths Li have
a constant rectangular cross-section with dimensions 1cm × 3cm. For the sake
of simpliﬁcation, it is also assumed that (m3L2lc3 = m4L1lc4), as it is explained
in Sect. 2.2. This consideration implies the compliance of Eq. (8). Notice that
the equality lci = Li/2 is fulﬁlled. In consequence, Eq. (8) can be simpliﬁed as
follows,
L2 = L1
m4lc4
m3lc3
,
lci = Li/2,
→L2 = L1
m4l4
m3l3
.
(8)
Nevertheless, this assumption results too straight for the solution of the
inverse kinematics causing singular positions in some conﬁgurations. Thus, the
simulation has been restricted to avoid singularities by adding an additional
constraint, with the inverse of the condition number of the Jacobian matrix as
κ−1(J) ≤0.2. The limitation of κ−1(J) helps the robot be protected from sin-
gularities during the tracking. Besides, the vector of decision variables has been
proposed as in Eq. (9), in terms of the PID gains for actuated elements and
the element’s lengths, and the objective function is formalized through Eq. (12)
where e denotes the error over the trajectory in the XY plane, and τi ·dϕi is the
work done (and consequently, the energy expended) by the actuated elements at
each step of time. The computation is eﬀected in the SI units. The integration
of both terms is eﬀected to evaluate the accumulation of both measures during
the simulation time.

228
A. R. Suarez et al.
d = [kp1, ki1, kd1, kp2, ki2, kd2, L1, L4]′,
with
(9)
0 ≤[kp1,2, ki1,2, kd1,2] ≤300,
0.1 ≤L1, L4 ≤1
(10)
error(t, d) ≤0.1,
τi(t) ≤|10|,
(11)
f(d) =

 t
0
|error|dt,

 t
0

|τi · dϕi

dt′
(12)
To reduce the computational cost generated by each evaluation, we restrict
the model to discard those robot conﬁgurations showing a rapid accumulation
of the error in the trajectory. This limit is set equal to 0.1 m. Moreover, the
signal torque in both actuated elements is saturated in a range of [−10, 10]N ·m.
This is modeled in Eqs. (11). Thus, the optimization model considers the deci-
sion variables in Eq. (9), the constraints in Eq. (8), that permits independent
control of the actuated elements, limitation of κ−1(J), that avoids singularities,
Inequalities (10), that are box constraints for bounding the search, Inequalities
(11), that limits the maximum error and torque of any solution, and the objec-
tives in Eq. (12), that are the energy and error to minimize. The MOEA/D is
adjusted with a population of 80 and 200 maximal iterations, that is to say, a
total of 16,000 evaluations.
4
Optimization Results
As a result of this bi-objective optimization we show the Pareto front for the
minimization of the error and the expended energy on the left graphic in Fig. 2.
This Pareto front shows a set of optimal designs so that the designer can decide
the adequate according to the requirements of the application. On the other
hand, we chose one of this optimal solutions located in the center of the Pareto
front and compared the resulting traced trajectory to the expected one with the
related decision variables obtained (see Fig. 2). We also provide the plot for the
angular displacement, angular error and torques for the actuated elements for
the given traced trajectory (Fig. 3). The decision variables yielding the optimal
values were found to be as follows (Table 1).
Table 1. Optimization results for the extremes and center of the Pareto front
[Error,Energy]
kp1
ki1
kd1
kp2
ki2
kd2
L1
L4
[0.0134,0.0113] 274.62 108.57
62.62
81.72 258.21 8.47 0.51 0.26
[0.0153,0.0106] 219.12 108.58
62.62
81.72 258.21 8.47 0.51 0.26
[0.0242,0.0085] 241.94 166.44 140.93 117.28 154.87 3.22 0.52 0.47

Mechatronic Design Using Multiobjective Optimization
229
0.012
0.014
0.016
0.018
0.02
0.022
0.024
0.026
Error [m]
0.0085
0.009
0.0095
0.01
0.0105
0.011
0.0115
Energy [J]
Pareto set
0.38
0.4
0.42
0.44
0.46
0.48
X Axis
0.25
0.26
0.27
0.28
0.29
0.3
0.31
0.32
0.33
0.34
0.35
Y Axis
Desired trajectory vs Traced trajectory
Error 0.0153434
Energy 0.0105767
Fig. 2. Obtained Pareto front and trajectory traced from the selected optimal solution
in coordinates [0.01534, 0.01057]
0
5
10
15
20
25
30
1
1.05
1.1
1.15
1.2
Angle [rad]
0
5
10
15
20
25
30
2.3
2.4
2.5
2.6
2.7
Angle [rad]
0
5
10
15
20
25
30
0
10
20
Error [rad]
10-3
0
5
10
15
20
25
30
-20
-15
-10
-5
0
Error [rad]
10-3
0
5
10
15
20
25
30
Time [s]
1
2
3
4
Torque [N.m]
0
5
10
15
20
25
30
Time [s]
-1.5
-1
-0.5
0
Torque [N.m]
Fig. 3. Angular displacement, angular error and torques experimented in the actuated
elements for the traced trajectory in Fig. 2
5
Conclusions
We introduce an optimization model applied to a parallelogram linkage sys-
tem, it considers a bi-objective optimization problem with several constraints,
in one hand, box constraint are the most common in optimization problems, they
limit the search, on the other hand, we introduce an error constraint that limits
implicitly the search to those mechanism with a lower tracking error, without
this constraint, the algorithm will look for the minimum energy without consid-

230
A. R. Suarez et al.
ering the error, such solution is a static mechanism with all control gains equal
to zero, it is trivial and undesirable. In the same regard, the torque constraint,
is introduced for emulating the maximum physical torque of the actuators, this
constraint provides of physical meaning of the control gains, and ﬁnally, the
constraint on the Jacobian condition number, provides a way of requiring an
acceptable dexterity during the task and avoid singularities that are possible
poses in numerical simulations but not in a real mechanism.
The MOEA/D reports a set of solutions that actually perform adequately
the task. The designer can choose among a set of the best conﬂicting solutions,
he/she is in charge of selecting the pay oﬀin energy of a tracking error, or
viceversa. Notice that this compromise among the best solutions is not known a
priori, so, such selection can not be done before applying this optimization pro-
cess. Currently, there are novel numerical strategies for the selection of a single
solution from the Pareto front [7]. Nevertheless, this selection should not be done
a priori, without the knowledge of the assigned task for the mechanism. Design
is not only reduced to the parameters included in the optimization, further, they
have to accomplish quality standards. For this reason, we leave the selection of
the single optimal solution open to the designer, with the conscience of how
much each objective could be enhanced or sacriﬁced for the engineering appli-
cation thought for the robot. Finally, according to our experiments the torques
do not reach saturation, this could be due to the error constraint, that avoid
large errors, which reduces the computed τi, and to the gains box constraints.
Our experiments demonstrate, how it is possible to introduce and deal with con-
straints that guide the search to the most useful solutions without complicated
procedures, we basically consider most of them as conditions in our numerical
simulation. Future work contemplate to apply the very same method to other
tasks and robots.
Acknowledgements. The authors are grateful to SIP-IPN Mexico for supporting
part of this work through project SIP-20210243. S. Ivvan Valdez is supported by
Catedra-CONACYT 7795.
References
1. Acevedo, M., Haro, E., Mart´ınez, F.: An alternative method for the optimum
dynamic balancing of the four-bar mechanism. In: Ceccarelli, M., Hern´andez Mar-
tinez, E.E. (eds.) Multibody Mechatronic Systems. MMS, vol. 25, pp. 177–187.
Springer, Cham (2015). https://doi.org/10.1007/978-3-319-09858-6 17
2. Aﬃ, Z., EL-Kribi, B., Romdhane, L.: Advanced mechatronic design using a multi-
objective genetic algorithm optimization of a motor-driven four-bar system. Mecha-
tronics 17, 489–500 (2007)
3. Amerongen, J.: Mechatronic design. Mechatronics 13(10), 1045–1066 (2003)
4. Ansari, Y., Manti, M., Falotico, E., Cianchetti, M., Laschi, C.: Multiobjective
optimization for stiﬀness and position control in a soft robot arm module. IEEE
Robot. Autom. Lett. 3(1), 108–115 (2017)
5. Bottin, M., Rosati, G.: Trajectory optimization of a redundant serial robot using
cartesian via points and kinematic decoupling. Robotics 8(4), 101 (2019)

Mechatronic Design Using Multiobjective Optimization
231
6. da Silva, M.M., Bruls, O., Desmet, W., Van Brussel, H.: Integrated structure and
control design for mechatronic systems with conﬁguration-dependent dynamics.
Mechatronics 19(6), 1016–1025 (2009)
7. de la Fuente, D., Vega-Rodr´ıguez, M.A., P´erez, C.J.: Automatic selection of a
single solution from the pareto front to identify key players in social networks.
Knowl.-Based Syst. 160, 228–236 (2018)
8. EL-Kribi, B., Houidi, A., Aﬃ, Z., Romdhane, L.: Application of multi-objective
genetic algorithms to the mechatronic design of a four bar system with continuous
and discrete variables. Mechanism and Machine Theory 61, 68–83 (2013)
9. Hayward, V., Choksi, J., Lanvin, G., Ramstein, C.: Design and multi-objective
optimization of a linkage for a haptic interface. In: Lenarˇciˇc, J., Ravani, B.
(eds.) Advances in Robot Kinematics and Computational Geometry, pp. 359–368.
Springer, Dordrecht (1994). https://doi.org/10.1007/978-94-015-8348-0 36
10. Hsieh, C.Y., Shieh, W.B., Chen, C.K., Lee, J.J.: Synthesis of double-rocker mech-
anisms for motion generation using fourier descriptor. In: Uhl, T. (ed.) Advances
in Mechanism and Machine Science, pp. 1285–1294. Springer International Pub-
lishing, Cham (2019)
11. Li, Q.: Experimental validation on the integrated design and control of a parallel
robot. Robotica 24(2), 173–181 (2006)
12. Liu, D., Li, G., Shang, Y.: Dynamic modeling and multiobjective optimization of
forging manipulator during one forging stroke. Mech. Based Des. Struct. Mach.
40(2), 241–252 (2012)
13. Portilla-Flores, E.A., Mezura-Montes, E., Alvarez-Gallegos, J., Coello-Coello, C.A.,
Cruz-Villar, C.A., Villarreal-Cervantes, M.G.: Parametric reconﬁguration improve-
ment in non-iterative concurrent mechatronic design using an evolutionary-based
approach. Eng. Appl. Artif. Intell. 24(5), 757–771 (2011)
14. Ravichandran, T., Wang, D., Heppler, G.: Simultaneous plant-controller design
optimization of a two-link planar manipulator. Mechatronics 16(3), 233–242 (2006)
15. Russo, M., Raimondi, L., Dong, X., Axinte, D., Kell, J.: Task-oriented opti-
mal dimensional synthesis of robotic manipulators with limited mobility. Robot.
Comput.-Integr. Manuf. 69, 102096 (2021)
16. Valdez, S.I., Botello-Aceves, S., Becerra, H.M., Hern´andez, E.E.: Comparison
between a concurrent and a sequential optimization methodology for serial manip-
ulators using metaheuristics. IEEE Trans. Ind. Inf. 14(7), 3155–3165 (2018)
17. Valdez, S.I., Ch´avez-Conde, E., Hernandez, E.E., Ceccarelli, M.: Structure-control
design of a mechatronic system with parallelogram mechanism using an estimation
of distribution algorithm. Mech. Based Des. Struct. Mach. 44(1–2), 58–71 (2016)

Author Index
A
Acevedo, Mario, 181
Acuña, Jesus, 213
Albites-Sanabria, Jose, 213
Alegria, Elvis J., 13, 24
Ambrósio, Jorge, 105
Arakelian, Vigen, 56
Arias-Montiel, Manuel, 64
Arroyo, Nícolas, 13
B
Bai, Qingshun, 94
Barreto, Juan Pablo, 191
Beltramo, Emmanuel, 143
Bernardon Machado, Lucas, 37
C
Campusano, Daryl, 213
Carretero, J. A., 171
Ceballos, Luis R., 151
Ceccarelli, Marco, 46
Chate, Ebert, 213
D
de Faria Lemos, Aline, 122
Díaz, Joseph, 24
Dimitriadis, Grigorios, 151
E
Elshami, Mohamed, 94
F
Ferreira, José, 114
Ferreira Gonçalves, Luiz Otávio, 122
Figueroa, Alvaro, 213
Figueroa, Yanpierrs, 24
Flores, Del Piero, 13
Flores, Paulo, 77, 85, 105, 114
G
Gallardo, Alejandro G., 3
García, Marco, 64
Gutiérrez-Diaz, Gabriel, 159
H
Hernandez, Eusebio E., 224
Horta Gutiérrez, Juan Carlos, 122
Huamanchumo, Johrdan, 213
Hurtado-Hurtado, Gerardo, 131
I
Irakoze, Vivens, 46
J
Jauregui-Correa, Juan Carlos, 131
L
Lleren, Juan, 213
Lugo-González, Esther, 64
M
Magalhães, Hugo, 105
Marques, Filipe, 85, 105, 114
Martins, Daniel, 37
Martins Ferreira, Ricardo Poley, 122
Milián-Ccopa, Leonardo Paul, 213
Mora, Juan Pablo, 191
© The Editor(s) (if applicable) and The Author(s), under exclusive license
to Springer Nature Switzerland AG 2022
M. Pucheta et al. (Eds.): MuSMe 2021, MMS 110, pp. 233–234, 2022.
https://doi.org/10.1007/978-3-030-88751-3

N
Nguyen, Vu Linh, 201
Nuñez-Quispe, Johan, 213
O
Otremba, Frank, 131
P
Palma, Diego, 13
Pérez Segura, Martín E., 143
Pombo, João, 105
Prado Barbosa, Társis, 122
Preidikman, Sergio, 143, 151
Pucheta, Martín A., 3
Q
Quino, Gustavo, 24
R
Roccia, Bruno A., 143, 151
Rodrigues da Silva, Leonardo Adolpho, 122
Rodrigues da Silva, Mariana, 85
Rodriguez, Carlos F., 191
Romero-Navarrete, Jose A., 131
Russo, Matteo, 46
S
Santiesteban Cos, R., 171
Sensinger, J., 171
Shehata, Mohamed, 94
Simas, Henrique, 37
Solis-Santome, Arturo, 159
Solórzano, Renzo, 13
Soto, Axel, 213
Suarez, Alejandra Rios, 224
Suyo, Briggitte, 213
T
Taipe, Kevin, 213
Tapia-Herrera, Ricardo, 64
Tavares da Silva, Miguel, 85
Torres-SanMiguel, Christopher René, 159
V
Valdez, S. Ivvan, 224
Valdiero, Antonio Carlos, 37
Velázquez, Ramiro, 181
Verstraete, Marcos L., 151
Z
Zhao, Xuezeng, 94
234
Author Index

