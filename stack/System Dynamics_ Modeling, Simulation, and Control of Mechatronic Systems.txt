SYSTEM DYNAMICS
System Dynamics: Modeling, Simulation, and Control of Mechatronic Systems, Fifth Edition
Dean C. Karnopp, Donald L. Margolis and Ronald C. Rosenberg
Copyright © 2012 John Wiley & Sons, Inc.

SYSTEM DYNAMICS
Modeling, Simulation, and Control
of Mechatronic Systems
Fifth Edition
DEAN C. KARNOPP
Department of Mechanical and Aerospace Engineering
University of California
Davis, California
DONALD L. MARGOLIS
Department of Mechanical and Aerospace Engineering
University of California
Davis, California
RONALD C. ROSENBERG
Department of Mechanical Engineering
Michigan State University
East Lansing, Michigan
JOHN WILEY & SONS, INC.

This book is printed on acid-free paper.
Copyright © 2012 by John Wiley & Sons, Inc. All rights reserved
Published by John Wiley & Sons, Inc., Hoboken, New Jersey
Published simultaneously in Canada
No part of this publication may be reproduced, stored in a retrieval system, or transmitted in any
form or by any means, electronic, mechanical, photocopying, recording, scanning, or otherwise,
except as permitted under Section 107 or 108 of the 1976 United States Copyright Act, without
either the prior written permission of the Publisher, or authorization through payment of the
appropriate per-copy fee to the Copyright Clearance Center, 222 Rosewood Drive, Danvers, MA
01923, (978) 750-8400, fax (978) 646-8600, or on the web at www.copyright.com. Requests to the
Publisher for permission should be addressed to the Permissions Department, John Wiley & Sons,
Inc., 111 River Street, Hoboken, NJ 07030, (201) 748-6011, fax (201) 748-6008, or online at
www.wiley.com/go/permissions.
Limit of Liability/Disclaimer of Warranty: While the publisher and the author have used their best
efforts in preparing this book, they make no representations or warranties with respect to the
accuracy or completeness of the contents of this book and speciﬁcally disclaim any implied
warranties of merchantability or ﬁtness for a particular purpose. No warranty may be created or
extended by sales representatives or written sales materials. The advice and strategies contained
herein may not be suitable for your situation. You should consult with a professional where
appropriate. Neither the publisher nor the author shall be liable for any loss of proﬁt or any other
commercial damages, including but not limited to special, incidental, consequential, or other
damages.
For general information about our other products and services, please contact our Customer Care
Department within the United States at (800) 762-2974, outside the United States at (317)
572-3993 or fax (317) 572-4002.
Wiley publishes in a variety of print and electronic formats and by print-on-demand. Some
material included with standard print versions of this book may not be included in e-books or in
print-on-demand. If this book refers to media such as a CD or DVD that is not included in the
version you purchased, you may download this material at http://booksupport.wiley.com. For more
information about Wiley products, visit www.wiley.com.
Library of Congress Cataloging-in-Publication Data:
Karnopp, Dean.
System dynamics : modeling, simulation, and control of mechatronic systems /
Dean C. Karnopp, Donald L. Margolis, Ronald C. Rosenberg. – 5th ed.
p. cm.
Includes bibliographical references and index.
ISBN 978-0-470-88908-4 (cloth); ISBN 978-1-118-15281-2 (ebk); ISBN 978-1-118-15282-9
(ebk); ISBN 978-1-118-15283-6 (ebk); ISBN 978-1-118-15982-8 (ebk); ISBN 978-1-118-16007-7
(ebk); ISBN 978-1-118-16008-4 (ebk)
1. Systems engineering. 2. System analysis. 3. Bond graphs. 4. Mechatronics. I. Margolis,
Donald L. II. Rosenberg, Ronald C. III. Title.
TA168.K362 2012
620.001′1–dc23
2011026141
Printed in the United States of America
10 9 8 7 6 5 4 3 2 1

CONTENTS
Preface
xi
1
Introduction
1
1.1
Models of Systems, 4
1.2
Systems, Subsystems, and Components, 7
1.3
State-Determined Systems, 9
1.4
Uses of Dynamic Models, 10
1.5
Linear and Nonlinear Systems, 11
1.6
Automated Simulation, 12
References, 13
Problems, 14
2
Multiport Systems and Bond Graphs
17
2.1
Engineering Multiports, 17
2.2
Ports, Bonds, and Power, 24
2.3
Bond Graphs, 27
2.4
Inputs, Outputs, and Signals, 30
Problems, 33
3
Basic Bond Graph Elements
37
3.1
Basic 1-Port Elements, 37
3.2
Basic 2-Port Elements, 50
3.3
The 3-Port Junction Elements, 57
3.4
Causality Considerations for the Basic Elements, 63
v

vi
CONTENTS
3.4.1
Causality for Basic 1-Ports, 64
3.4.2
Causality for Basic 2-Ports, 65
3.4.3
Causality for Basic 3-Ports, 66
3.5
Causality and Block Diagrams, 67
Reference, 71
Problems, 71
4
System Models
77
4.1
Electrical Systems, 78
4.1.1
Electrical Circuits, 78
4.1.2
Electrical Networks, 84
4.2
Mechanical Systems, 91
4.2.1
Mechanics of Translation, 91
4.2.2
Fixed-Axis Rotation, 100
4.2.3
Plane Motion, 106
4.3
Hydraulic and Acoustic Circuits, 121
4.3.1
Fluid Resistance, 122
4.3.2
Fluid Capacitance, 125
4.3.3
Fluid Inertia, 130
4.3.4
Fluid Circuit Construction, 132
4.3.5
An Acoustic Circuit Example, 135
4.4
Transducers and Multi-Energy-Domain Models, 136
4.4.1
Transformer Transducers, 137
4.4.2
Gyrator Transducers, 139
4.4.3
Multi-Energy-Domain Models, 142
References, 144
Problems, 144
5
State-Space Equations and Automated Simulation
162
5.1
Standard Form for System Equations, 165
5.2
Augmenting the Bond Graph, 168
5.3
Basic Formulation and Reduction, 175
5.4
Extended Formulation Methods—Algebraic Loops, 183
5.4.1
Extended Formulation Methods—Derivative Causality, 188
5.5
Output Variable Formulation, 196
5.6
Nonlinear and Automated Simulation, 198
5.6.1
Nonlinear Simulation, 198
5.6.2
Automated Simulation, 202
Reference, 207
Problems, 207

CONTENTS
vii
6
Analysis and Control of Linear Systems
218
6.1
Introduction, 218
6.2
Solution Techniques for Ordinary Differential
Equations, 219
6.3
Free Response and Eigenvalues, 222
6.3.1
A First-Order Example, 223
6.3.2
Second-Order Systems, 225
6.3.3
Example: The Undamped Oscillator, 230
6.3.4
Example: The Damped Oscillator, 232
6.3.5
The General Case, 236
6.4
Transfer Functions, 239
6.4.1
The General Case for Transfer Functions, 241
6.5
Frequency Response, 244
6.5.1
Example Transfer Functions and Frequency
Responses, 249
6.5.2
Block Diagrams, 255
6.6
Introduction to Automatic Control, 258
6.6.1
Basic Control Actions, 259
6.6.2
Root Locus Concept, 273
6.6.3
General Control Considerations, 285
6.7
Summary, 310
References, 311
Problems, 311
7
Multiport Fields and Junction Structures
326
7.1
Energy-Storing Fields, 327
7.1.1
C-Fields, 327
7.1.2
Causal Considerations for C-Fields, 333
7.1.3
I -Fields, 340
7.1.4
Mixed Energy-Storing Fields, 348
7.2
Resistive Fields, 350
7.3
Modulated 2-Port Elements, 354
7.4
Junction Structures, 357
7.5
Multiport Transformers, 359
References, 364
Problems, 365
8
Transducers, Ampliﬁers, and Instruments
371
8.1
Power Transducers, 372
8.2
Energy-Storing Transducers, 380

viii
CONTENTS
8.3
Ampliﬁers and Instruments, 385
8.4
Bond Graphs and Block Diagrams for Controlled Systems, 392
References, 397
Problems, 397
9
Mechanical Systems with Nonlinear Geometry
411
9.1
Multidimensional Dynamics, 412
9.1.1
Coordinate Transformations, 416
9.2
Kinematic Nonlinearities in Mechanical Dynamics, 420
9.2.1
The Basic Modeling Procedure, 422
9.2.2
Multibody Systems, 433
9.2.3
Lagrangian or Hamiltonian IC-Field Representations, 440
9.3
Application to Vehicle Dynamics, 445
9.4
Summary, 452
References, 452
Problems, 453
10
Distributed-Parameter Systems
470
10.1 Simple Lumping Techniques for Distributed Systems, 471
10.1.1 Longitudinal Motions of a Bar, 471
10.1.2 Transverse Beam Motion, 476
10.2 Lumped Models of Continua through Separation of Variables, 482
10.2.1 The Bar Revisited, 483
10.2.2 Bernoulli–Euler Beam Revisited, 491
10.3 General Considerations of Finite-Mode Bond Graphs, 499
10.3.1 How Many Modes Should Be Retained?, 499
10.3.2 How to Include Damping, 503
10.3.3 Causality Consideration for Modal Bond Graphs, 503
10.4 Assembling Overall System Models, 508
10.5 Summary, 512
References, 512
Problems, 512
11
Magnetic Circuits and Devices
519
11.1 Magnetic Effort and Flow Variables, 519
11.2 Magnetic Energy Storage and Loss, 524
11.3 Magnetic Circuit Elements, 528
11.4 Magnetomechanical Elements, 532
11.5 Device Models, 534
References, 543
Problems, 544

CONTENTS
ix
12
Thermoﬂuid Systems
548
12.1 Pseudo-Bond Graphs for Heat Transfer, 548
12.2 Basic Thermodynamics in True Bond Graph Form, 551
12.3 True Bond Graphs for Heat Transfer, 558
12.3.1 A Simple Example of a True Bond Graph Model, 561
12.3.2 An Electrothermal Resistor, 563
12.4 Fluid Dynamic Systems Revisited, 565
12.4.1 One-Dimensional Incompressible Flow, 569
12.4.2 Representation of Compressibility Effects in True Bond
Graphs, 573
12.4.3 Inertial and Compressibility Effects in
One-Dimensional Flow, 576
12.5 Pseudo-Bond Graphs for Compressible Gas Dynamics, 578
12.5.1 The Thermodynamic Accumulator—A Pseudo-Bond
Graph Element, 579
12.5.2 The Thermodynamic Restrictor—A Pseudo-Bond
Graph Element, 584
12.5.3 Constructing Models with Accumulators and Restrictors, 587
12.5.4 Summary, 590
References, 592
Problems, 592
13
Nonlinear System Simulation
600
13.1 Explicit First-Order Differential Equations, 601
13.2 Differential Algebraic Equations Caused by Algebraic Loops, 604
13.3 Implicit Equations Caused by Derivative Causality, 608
13.4 Automated Simulation of Dynamic Systems, 612
13.4.1 Sorting of Equations, 613
13.4.2 Implicit and Differential Algebraic Equation Solvers, 614
13.4.3 Icon-Based Automated Simulation, 614
13.5 Example Nonlinear Simulation, 616
13.5.1 Some Simulation Results, 620
13.6 Summary, 623
References, 624
Problems, 624
Appendix: Typical Material Property Values Useful in Modeling
Mechanical, Acoustic, and Hydraulic Elements
630
Index
633

PREFACE
This is the ﬁfth edition of a textbook originally titled system Dynamics: A Uni-
ﬁed Approach, which in subsequent editions acquired the title System Dynamics:
Modeling and Simulation of Mechatronic Systems. As you can see, the subtitle has
now expanded to be Modeling, Simulation, and Control of Mechatronic Systems.
The addition of the term control indicates the major change from previous
editions. In older editions, the ﬁrst six chapters of the book typically have been
used as an undergraduate text and the last seven chapters have been used for more
advanced courses. Now the latter part of Chapter Six can be used to introduce
undergraduate students to a major use of mathematic models; namely, as a basis
for the design control systems. In this case we are not trying to replace the many
excellent books dealing with the design of automatic control systems. Rather we
are trying to provide a contrasting approach to such books that often have a single
chapter devoted to the construction of mathematical models from physical prin-
ciples, while the rest of the book is devoted to discussing the dynamics of control
systems given a model of the control system in the form of state equations, trans-
fer functions, or frequency response functions. It is our contention that while the
design of control systems is very important, the skills of modeling and computer
simulation for a wide variety of physical systems are of fundamental importance
even if an automatic control system is not involved.
Furthermore, we contend that the bond graph method is uniquely suited to the
understanding of physical system dynamics. The basis of bond graphs lies in the
study of energy storage and power ﬂow in physical systems of almost any type. In
this edition, we have tried to simplify the earlier chapters to focus on mechanical,
electrical, and hydraulic systems that are relatively easy to model using bond
graphs, leaving the more complex types of systems to the later chapters. It would
be easy for an instructor to choose some topics of particular interest from these
chapters to supplement the types of systems studied in the earlier part of the
book if desired.
xi

xii
PREFACE
It has been gratifying to see that over the years, instructors and researchers
world wide have learned that the bond graph technique is uniquely suited to the
description of physical systems of engineering importance. It is our hope that
this book will continue to provide useful information for engineers dealing with
the analysis, simulation, and control of the devices of the future.

1
INTRODUCTION
This book is concerned with the development of an understanding of the dynamic
physical systems that engineers are called upon to design. The type of systems
to be studied can be described by the term mechatronic, which implies that
while the elements of the system are mechanical in a general sense, electronic
control will also be involved. For the design of a computer-controlled system,
it is crucial that the dynamics of systems that exchange power and energy in
various forms be thoroughly understood. Methods for the mathematical modeling
of real systems will be presented, ways of analyzing systems in order to shed
light on system behavior will be shown, and techniques for using computers to
simulate the dynamic response of systems to external stimuli will be developed. In
addition, methods of using mathematical models of dynamic systems to design
automatic control systems will be introduced. Before beginning the study of
physical systems, it is worthwhile to reﬂect a moment on the nature of the
discipline that is usually called system dynamics in engineering.
The word system is used so often and so loosely to describe a variety of
concepts that it is hard to give a meaningful deﬁnition of the word or even to
see the basic concept that unites its diverse meanings. When the word system is
used in this book, two basic assumptions are being made:
1. A system is assumed to be an entity separable from the rest of the universe
(the environment of the system) by means of a physical or conceptual
boundary. An air conditioning system, for example, can be thought of as
a system that reacts to its environment (the temperature of the outside
air, for example) and that interchanges energy and information with its
environment. In this case the boundary is physical or spatial. An air trafﬁc
control system, however, is a complex system, the environment of which
is not only the physical surroundings but also the ﬂuctuating demands for
air trafﬁc, which ultimately come from human decisions about travel and
1
System Dynamics: Modeling, Simulation, and Control of Mechatronic Systems, Fifth Edition
Dean C. Karnopp, Donald L. Margolis and Ronald C. Rosenberg
Copyright © 2012 John Wiley & Sons, Inc.

2
INTRODUCTION
the shipping of goods. The unifying element in these two disparate systems
is the conceptual boundary between what is considered to be part of the
system and what represents an external disturbance or command originating
from outside the system.
2. A system is composed of interacting parts. In an air conditioning system,
we recognize devices with speciﬁc functions, such as compressors and fans,
sensors that transmit information, and actuators that act on information, and
so on. The air trafﬁc control system is composed of people and machines
with communication links between them. Clearly, the reticulation of a sys-
tem into its component parts is something that requires skill and art, since
most systems could be broken up into so many parts that any analysis would
be swamped with largely irrelevant detail. The art and science of system
modeling has to do with the construction of a model complex enough to
represent the relevant aspects of the real system but not so complex as to
be unwieldy.
These two aspects of systems can be recognized in everyday situations as well
as in the more speciﬁc and technical applications that form the subject matter of
most of this book. For example, when one hears a complaint that the transporta-
tion system in this country does not work well, one may see that there is some
logic in using the word system. First of all, the transportation system is roughly
identiﬁable as an entity. It consists of air, land, and sea vehicles and the human
beings, machines, and decision rules by which they are operated. In addition,
many parts of the system can be identiﬁed—cars, planes, ships, baggage han-
dling equipment, computers, and the like. Each part of the transportation system
could be further reticulated into parts (i.e., each component part is itself a system),
but for obvious reasons we must exercise restraint in this division process.
The essence of what may be called the “systems viewpoint” is to concern
oneself with the operation of a complete system rather than with just the operation
of the component parts. Complaints about the transportation system are often real
“system” complaints. It is possible to start a trip in a private car that functions
just as its designers had hoped it would, transfer to an airplane that can ﬂy at its
design speed with no failures, and end in a taxi that does what a taxi is supposed
to do, and yet have a terrible trip because of trafﬁc jams, air trafﬁc delays, and the
like. Perfectly good components can be assembled into an unsatisfactory system.
In engineering, as indeed in virtually all other types of human endeavor, tasks
associated with the design or operation of a system are broken up into parts that
can be worked on in isolation to some extent. In a power plant, for example, the
generator, turbine, boiler, and feed water pumps typically will be designed by
separate groups. Furthermore, heat transfer, stress analysis, ﬂuid dynamics, and
electrical studies will be undertaken by subsets of these groups. In the same way,
the bureaucracy of the federal government represents a splitting up of the various
functions of government. All the separate groups working on an overall task must
interact in some manner to make sure that not only will the parts of the system
work, but also the system as a whole will perform its intended function. Many

INTRODUCTION
3
times, however, oversimpliﬁed assumptions about how a system will operate are
made by those working on a small part of the system. When this happens, the
results can be disappointing. The power plant may undergo damage during a
full load rejection, or the economy of a country may collapse because of the
unfavorable interaction of segments of government, each of which assiduously
pursues seemingly reasonable policies.
In this book, the main emphasis will be on studying system aspects of behavior
as distinct from component aspects. This requires knowledge of the component
parts of the systems of interest and hence some knowledge in certain areas of
engineering that are taught and sometimes even practiced in splendid isolation
from other areas. In the engineering systems of primary interest in this book,
topics from vibrations, strength of materials, dynamics, ﬂuid mechanics, thermo-
dynamics, automatic control, and electrical circuits will be used. It is possible,
and perhaps even common, for an engineer to spend a major part of his or
her professional career in just one of these disciplines, despite the fact that few
signiﬁcant engineering projects concern a single discipline. Systems engineers,
however, must have a reasonable command of several of the engineering sciences
as well as knowledge pertinent to the study of systems per se.
Although many systems may be successfully designed by careful attention
to static or steady-state operation in which the system variables are assumed
to remain constant in time, in this book the main concern will be with dynamic
systems, that is, those systems whose behavior as a function of time is important.
For a transport aircraft that will spend most of its ﬂight time at a nearly steady
speed, the fuel economy at constant speed is important. For the same plane,
the stress in the wing spars during steady ﬂight is probably less important than
the time-varying stress during ﬂight through turbulent air, during emergency
maneuvers, or during hard landings. In studying the fuel economy of the aircraft,
a static system analysis might sufﬁce. For stress prediction, a dynamic system
analysis would be required.
Generally, of course, no system can operate in a truly static or steady state, and
both slow evolutionary changes in the system and shorter time transient effects
associated, for example, with startup and shutdown are important. In this book,
despite the importance of steady-state analysis in design studies, the emphasis will
be on dynamic systems. Dynamic system analysis is more complex than static
analysis but is extremely important, since decisions based on static analyses can
be misleading. Systems may never actually achieve a possible steady state due to
external disturbances or instabilities that appear when the system dynamics are
taken into account.
Moreover, systems of all kinds can exhibit counterintuitive behavior when con-
sidered statically. A change in a system or a control policy may appear beneﬁcial
in the short run from static considerations but may have long-run repercussions
opposite to the initial effect. The history of social systems abounds with some-
times tragic examples, and there is hope that dynamic system analysis can help
avoid some of the errors in “static thinking” [1]. Even in engineering with rather

4
INTRODUCTION
simple systems, one must have some understanding of the dynamic response of
a system before one can reasonably study the system on a static basis.
A simple example of a counterintuitive system in engineering is the case of
a hydraulic power generating plant. To reduce power, wicket gates just before
the turbine are moved toward the closed position. Temporarily, however, the
power actually increases as the inertia of the water in the penstock forces the
ﬂow through the gates to remain almost constant, resulting in a higher velocity
of ﬂow through the smaller gate area. Ultimately, the water in the penstock
slows down and power is reduced. Without an understanding of the dynamics of
this system, one would be led to open the gates to reduce power. If this were
done, the immediate result would be a gratifying decrease of power followed by
a surprising and inevitable increase. Clearly, a good understanding of dynamic
response is crucial to the design of a controller for mechatronic systems.
1.1
MODELS OF SYSTEMS
A central idea involved in the study of the dynamics of real systems is the idea of
a model of a system. Models of systems are simpliﬁed, abstracted constructs used
to predict their behavior. Scaled physical models are well known in engineering.
In this category fall the wind tunnel models of aircraft, ship hull models used in
towing tanks, structural models used in civil engineering, plastic models of metal
parts used in photoelastic stress analysis, and the “breadboard” models used in
the design of electric circuits.
The characteristic feature of these models is that some, but not all, of the
features of the real system are reﬂected in the model. In a wind tunnel aircraft
model, for example, no attempt is made to reproduce the color or interior seating
arrangement of the real aircraft. Aeronautical engineers assume that some aspects
of a real craft are unimportant in determining the aerodynamic forces on it, and
thus the model contains only those aspects of the real system that are supposed
to be important to the characteristics under study.
In this book, another type of model, often called a mathematical model, is
considered. Although this type of model may seem much more abstract than the
physical model, there are strong similarities between physical and mathematical
models. The mathematical model also is used to predict only certain aspects
of the system response to inputs. For example, a mathematical model might be
used to predict how a proposed aircraft would respond to pilot input command
signals during test maneuvers. But such a model would not have the capability of
predicting every aspect of the real aircraft response. The model might not contain
any information on changes in aerodynamic heating during maneuvers or about
high-frequency vibrations of the aircraft structure, for example.
Because a model must be a simpliﬁcation of reality, there is a great deal of
art in the construction of models. An unduly complex and detailed model may
contain parameters virtually impossible to estimate, may be practically impossible
to analyze, and may cloud important results in a welter of irrelevant detail if it can

MODELS OF SYSTEMS
5
be analyzed. An oversimpliﬁed model will not be capable of exhibiting important
effects. It is important, then, to realize that no system can be modeled exactly and
that any competent system designer needs to have a procedure for constructing a
variety of system models of varying complexity so as to ﬁnd the simplest model
capable of answering the questions about the system under study.
The rest of this book deals with models of systems and with the procedures
for constructing models and for extracting system characteristics from models.
The models will be mathematical models in the usual meaning of the term even
though they may be represented by stylized graphs and computer printouts rather
than the more conventional sets of differential equations.
System models will be constructed using a uniform notation for all types of
physical systems. It is a remarkable fact that models based on apparently diverse
branches of engineering science can all be expressed using the notation of bond
graphs based on energy and information ﬂow. This allows one to study the
structure of the system model. The nature of the parts of the model and the
manner in which the parts interact can be made evident in a graphical format.
In this way, analogies between various types of systems are made evident, and
experience in one ﬁeld can be extended to other ﬁelds.
Using the language of bond graphs, one may construct models of electrical,
magnetic, mechanical, hydraulic, pneumatic, thermal, and other systems using
only a rather small set of ideal elements. Standard techniques allow the mod-
els to be translated into differential equations or computer simulation schemes.
Historically, diagrams for representing dynamic system models developed sep-
arately for each type of system. For example, parts a, b, and c of Figure 1.1
each represent a diagram of a typical model. Note that in each case the elements
in the diagram seem to have evolved from sketches of devices, but in fact a
photograph of the real system would not resemble the diagram at all. Figure 1.1a
might well represent the dynamics of the heave motion of an automobile, but
the masses, springs, and dampers of the model are not directly related to the
parts of an automobile visible in a photograph. Similarly, symbols for resistors
and inductors in diagrams such as Figure 1.1b may not correspond to separate
physical elements called resistors and chokes but instead may correspond to the
resistance and inductance effects present in a single physical device. Thus, even
semipictorial diagrams are often a good deal more abstract than they might at
ﬁrst appear.
When mixed systems such as that shown in Figure 1.1d are to be studied,
the conventional means of displaying the system model are less well developed.
Indeed, few such diagrams are very explicit about just what effects are to be
included in the model. The basic structure of the model may not be evident from
the diagram. A bond graph is more abstract than the type of diagrams shown
in Figure 1.1, but it is explicit and has the great advantage that all the models
shown in Figure 1.1 would be represented using exactly the same set of symbols.
For mixed systems such as that shown in Figure 1.1d, a universal language such
as bond graphs provide is required in order to display the essential structure of
the system model.

6
INTRODUCTION
R1
L1
R2
L2
C1
C2
R3
M1
M2
k1
k2
b1
b2
(a)
(b)
(c)
(d)
FIGURE 1.1. (a) Typical schematic diagram; (b) typical electric circuit diagram; (c) typ-
ical hydraulic diagram; (d) schematic diagram of system containing mechanical, electrical,
and hydraulic components.

SYSTEMS, SUBSYSTEMS, AND COMPONENTS
7
1.2
SYSTEMS, SUBSYSTEMS, AND COMPONENTS
To model a system, it is usually necessary ﬁrst to break it up into smaller parts
that can be modeled and perhaps studied experimentally and then to assemble the
system model from the parts. Often, the breaking up of the system is conveniently
accomplished in several stages. In this book major parts of a system will be
called subsystems and primitive parts of subsystems will be called components
or, at the most primitive level, elements. Of course, the hierarchy of components,
subsystems, and systems can never be absolute, since even the most primitive
part of a system could be modeled in such detail that it would be a complex
subsystem. Yet in many engineering applications, the subsystem and component
categories are fairly obvious.
Basically, a subsystem is a part of a system that will be modeled as a system
itself; that is, the subsystem will be broken into interacting component parts. A
component, however, is modeled as a unit and is not thought of as composed
of simpler parts. One needs to know how the component interacts with other
components and one must have a characterization of the component, but otherwise
a component is treated as a “black box” without any need to know in detail what
causes it to act as it does.
To illustrate these ideas, consider the vibration test system shown in Figure 1.2.
The system is intended to subject a test structure to a vibration environment
speciﬁed by a signal generator. For example, if the signal generator delivers a
random-noise signal, it may be desired that the acceleration of the shaker table be
a faithful reproduction of the electrical noise signal waveform. In a system that is
assembled from physically separate pieces, it is natural to consider the parts that
are assembled by connecting wires and hydraulic lines or by mechanical fasteners
as subsystems. Certainly, the electronic boxes labeled signal generator, controller,
and electrical ampliﬁer are subsystems, as are the electrohydraulic valve, the
FIGURE 1.2. Vibration test system.

8
INTRODUCTION
hydraulic shaker, and the test structure. It may be possible to treat some of these
subsystems as components if their interactions with the rest of the system can be
speciﬁed without knowledge of the internal construction of the subsystem. The
electrical ampliﬁer is obviously composed of many components, such as resistors,
capacitors, transistors, and the like, but if the ampliﬁer is sized correctly so that
it is not overloaded, then it may be possible to treat the ampliﬁer as a component
speciﬁed by the manufacturer’s input–output data. Other subsystems may require
a subsystem analysis in order to achieve a dynamic description suitable for the
overall system study.
Consider, for example, the electrohydraulic valve. A typical servo valve is
shown in Figure 1.3. Clearly, the valve is composed of a variety of electri-
cal, mechanical, and hydraulic parts that work together to produce the dynamic
response of the valve. For this subsystem the components might be the torque
motor, the hydraulic ampliﬁer, mechanical springs, hydraulic passages, and the
spool valve. A subsystem dynamic analysis can reveal weaknesses in the sub-
system design that may necessitate the substitution of another subsystem or a
reconﬁguration of the overall system. Yet such an analysis may indicate that,
from the point of view of the overall system, the subsystem may be adequately
characterized as a simple component. A skilled and experienced system designer
often makes a judgment on the appropriate level of detail for the modeling of
a subsystem on an intuitive basis. A major purpose of the methods presented in
this book is to show how system models can be assembled conveniently from
component models. It is then possible to experiment with subsystem models of
varying degrees of sophistication in order to verify or disprove initial modeling
decisions.
FIGURE 1.3. Electrohydraulic valve.

STATE-DETERMINED SYSTEMS
9
1.3
STATE-DETERMINED SYSTEMS
The goal of this book is to describe means for setting up mathematical mod-
els for systems. The type of model that will be found is often described as a
state-determined system. In mathematical notation, such a system model is often
described by a set of ordinary differential equations in terms of so-called state
variables and a set of algebraic equations that relate other system variables
of interest to the state variables. In succeeding chapters an orderly procedure,
beginning with physical effects to be modeled and ending with state differential
equations, will be demonstrated. Even though some techniques of analysis and
computer simulation do not require that the state equations be written explictly,
from a mathematical point of view all the system models that will be discussed
are state-determined systems.
The future of all the variables associated with a state-determined system can
be predicted if (1) the state variables are known at some initial time and (2) the
future time history of the input quantities from the external environment is known.
Such models, which are virtually the only types used in engineering, have
some built-in philosophical implications. For example, events in the future do
not affect the present state of the system. This implication is correlated with
the assumption that time runs only in one direction—from past to future. That
models should have these properties probably seems plausible, if not obvious,
yet it is remarkably difﬁcult to conceive of a demonstration that real systems
always have these properties.
Clearly, past history can have an effect on a system; yet the inﬂuence of
the past is exhibited in a special way in state-determined systems. All the past
history of a state-determined system is summed up in the present values of its
state variables. This means that many past histories could have resulted in the
same present value of state variables and hence the same future behavior of
the system. It also means that if one can condition the system to bring the state
variables to some particular values, then the future system response is determined
by the future inputs and nothing is important about the past except that the state
variables were brought to those values.
Scientiﬁc experiments are run as if the systems to be studied were state deter-
mined. The system is always started from controlled conditions that are expressed
in terms of carefully monitored variables. If the experiment is repeatable, then
the assumption is that the state variables are properly initialized by the opera-
tions used to set up the experiment. If the experiment is not repeatable, then the
assumption is that some important inﬂuence has not been controlled. This inﬂu-
ence can be either a state variable that was not monitored and initialized properly
or an unrecognized input quantity through which the environment inﬂuences the
system.
State-determined system models have proved useful over centuries of sci-
entiﬁc and technical work. For the usual macroscopic systems encountered in
engineering, state-determined system models are nearly universal, and there is
continuing interest in developing such models for social and economic systems.

10
INTRODUCTION
This book can be regarded as a textbook devoted to the establishment and study
of state-determined system models using well-deﬁned physical systems of interest
to engineers as examples.
1.4
USES OF DYNAMIC MODELS
In Figure 1.4 a general dynamic system model is shown schematically. The
system S is characterized by a set of state variables, indicated by X, that are
inﬂuenced by a set of input variables U that represent the action of the system’s
environment on the system or variables that could be manipulated by a control
system. The set of output variables Y are either back effects from the system onto
the environment or variables that can be sensed and used by a control system.
This type of dynamic system model may be used in four quite distinct ways:
1. Analysis. Given U for the future, X at the present, and the model S,
predict the future of Y . Assuming that the system model is an accurate
representation of the real system, analysis techniques allow one to predict
system behavior. In some cases, this analysis will indicate the need of a
control system in order for the system to respond in a desirable way.
2. Identiﬁcation. Given time histories of U and Y , usually by experimentation
on real systems, ﬁnd a model S and state variables X that are consistent
with U and Y . This is the essence of scientiﬁc experimentation. Clearly, a
“good” model is one that is consistent with a great variety of sets U and Y .
3. Synthesis. Given U and some desired Y , ﬁnd S such that U acting on S will
produce Y . Most of engineering deals with synthesis, but only in limited
contexts are there direct synthesis methods. Often we must be content to
accomplish synthesis of systems via a trial-and-error process of repetitive
analysis of a series of candidate systems. In this regard, dynamic models
pay a vital role, since progress would be slow indeed if one had to construct
each candidate system “in the metal” in order to discover its properties.
4. Control. Given the system model S, design a control system that uses those
variables in the output Y available from sensors to produce the some of
the inputs in U in order to make the system respond properly.
FIGURE 1.4. General dynamic system model.

LINEAR AND NONLINEAR SYSTEMS
11
In this book we will concentrate on setting up system models and predicting
the behavior of the systems using analytical or computational techniques. Thus,
we will concentrate on analysis, but it is important to remember that the tech-
niques are useful for identiﬁcation problems and that the major challenge to a
systems engineer is to synthesize desirable systems. It may not be too much to
say that analysis, except in the service of synthesis, is a rather sterile pursuit
for an engineer. Also, a brief introduction to automatic control techniques will
be given.
1.5
LINEAR AND NONLINEAR SYSTEMS
An overall system model, consisting of subsystems and their components, requires
modeling decisions as to what dynamic effects must be included in order to
use the model for its intended purpose. The result of these modeling decisions
is typically a system schematic that indicates the important dynamic effects.
Figures 1.1 and 1.2 are examples of system schematics where modeling decisions
have been made. In Figure 1.1d, the important dynamic effects at the component
level are indicated by labeling inertial, compliance, and resistance effects. In
Figure 1.2, modeling decisions are indicated at the subsystem level, while the
detail modeling of each subsystem remains to be done. A very important aspect
of the modeling process is whether components of subsystems behave linearly
or nonlinearly. As we progress through the chapters, it will become very clear
as to what is meant by linear or nonlinear behavior. For now it is simply stated
that linear systems are represented by sets of linear, ﬁrst-order differential state
equations, and nonlinear systems, while still state determined, are represented by
sets of nonlinear, ﬁrst-order differential equations.
If it is justiﬁed to assume that an overall system can be represented as linear,
then there exist an abundance of analytical tools for obtaining exact analytical
solutions to the linear equations and for extracting detailed information about
the response of the system. Some of the analytical information that is covered in
later chapters includes eigenvalues, transfer functions, and frequency response. If
the systems have large numbers of state variables, then pencil and paper analysis
may be virtually impossible, and one must resort to numerical computation to
obtain the properties of the system.
If a single component in a system model is represented as a nonlinear element,
then the system is nonlinear, and linear analysis tools will not work. Sliding
friction is an example of a common nonlinear phenomenon. If friction is important
in a system, eigenvalues, transfer functions, and frequency response concepts
do not apply as they would to a strictly linear system. To extract information
about the response of nonlinear systems, one must resort to time step simulation.
Fortunately, there is an abundance of commercial programs to simulate nonlinear
systems so that the use of nonlinear models is not the stumbling block it was
before the advent of computers.

12
INTRODUCTION
The fact is that there are no real physical systems that are truly linear. How-
ever, in order to introduce the concepts of constructing overall system models
of interacting electrical, mechanical, hydraulic, and thermal components, it is
easier to start with linear systems and then extend the procedures to nonlinear
systems. In addition, it is hard to understand the dynamics of system without
ﬁrst concentrating of the special case of linear systems. In the following ﬁve
chapters, the emphasis is on linear system models, but whenever possible, the
reader is reminded that real physical systems are nonlinear and simulation tools
must be used to obtain system responses. The more advanced topics dealt with
in Chapters 7–13 are largely concerned with nonlinear phenomena.
1.6
AUTOMATED SIMULATION
Mathematical models of dynamic physical systems have been made ever since
the invention of differential equations. But until the development of powerful
computers, there were severe limitations on the analysis of these models. Prac-
tically speaking, dynamic system behavior could generally be predicted only for
low-order linear models that often were not very accurate representatives of real
systems.
There is a lot to be said for the study of low-order linear models in order to
gain an appreciation of system dynamics, and the ﬁrst six chapters of this book
deal primarily with just such system models. However, computer simulation can
now be used to gain experience with system dynamics even when the system
models become large and when they contain nonlinear elements. Chapter 13
discusses some of the issues that arise when dealing with complex but realistic
models.
The next Chapters, 2, 3, and 4, present techniques for representing elements
of mechanical, electrical, and ﬂuid systems (and combination systems) in the
abstract form of bond graphs instead of the schematic diagrams usually used to
show vibratory systems, electric circuits, or hydraulic systems. For some, this
may seem to be an unnecessary step away from physical reality, but it has useful
consequences.
First of all, a bond graph is a precise way to represent a mathematical model.
Often schematic diagrams are not entirely clear about whether certain effects are
to be included or neglected in the model. Second, for many systems involving
two or more forms of energy, such as mechanical, electrical, and hydraulic, there
are no standard schematic diagrams that clearly indicate assumptions made in the
modeling process. Finally, it is much easier to communicate a bond graph model
unambiguously to a computer than a schematic diagram.
The bond graph uses only a few standard symbols, whereas typical schematic
diagrams for the same system model drawn by different people are almost never
identical. Just as computers more easily read bar codes than handwriting, they
more easily interpret bond graphs than schematic diagrams.

REFERENCES
13
Computer programs have been developed that recognize bond graphs and can
process them in the same manner that a human would in order to extract differ-
ential equations for analysis or simulation. In the process, useful facts about the
mathematics of the model are discovered even before any numerical parameters
or laws have been supplied. Furthermore, when the parameters of the elements
and the forcing functions for the system have been speciﬁed, the programs can
then simulate the response of the system. In this process, only a minimum of
human intervention is required.
Although it is important for a system engineer to understand the entire process
of modeling and simulation, the use of bond graphs and bond graph simulation
programs allows a beginner to start developing the skills associated with computer
simulation even before all the bond graph modeling techniques have been learned.
This has proved to be very effective in teaching. From the ﬁrst day, a student
given a bond graph model and a bond graph simulation program can see how
the model reacts to various input forcing functions and to variations in system
parameters. Simple design studies on dynamic systems can be assigned without
waiting until the student has learned to make models, derive equations, and use
an equation solver. This provides motivation to learn about bond graph dynamic
system modeling and numerical simulation techniques.
The fact that the simulation programs are effective for nonlinear as well as
linear models, and for large models as well as small ones, may not be fully appre-
ciated by a beginning student. However, in the course of time the signiﬁcance of
this fact should become apparent.
References [2–4] give the names of some of the more well-known commercial
bond graph processors, some of which are used in conjunction with simulation
programs to solve the differential equations. A web search will reveal that there
are a number of other bond graph processor programs.
Another category of program is based on a stored library of predetermined
bond graph submodels, but in use, replaces bond graph submodels with icons.
See Reference [5], for example. Such programs are useful for studying large
engineering models but they are less useful for learning about bond graph
modeling.
REFERENCES
[1] J. W. Forrester, Urban Dynamics, Cambridge, MA: MIT Press, 1969.
[2] CAMP-G, Cadsim Engineering, P.O. Box 4083, Davis, CA 95616.
[3] 20-SIM, Controllab Products B.V., Drienerlolaan 5, EL-CE, 7255 NB
Enschede, Netherlands.
[4] SYMBOLS 2000, Hightech Consultants, STEP IIT Ktragpur-721302, WB,
India.
[5] The LMS Imagine. Lab AMESim Introduction, http://www.imsintl.com/
imagine-amesim-intro.

14
INTRODUCTION
PROBLEMS
1-1. Suppose you were a heating engineer and you wished to consider a house as
a dynamic system. Without a heater, the average temperature in the house
would clearly vary over a 24-h period. What might you consider for inputs,
outputs, and state variables for a simple dynamic model? How would you
expand your model so that it would predict temperatures in several rooms
of the house? How does the installation of a thermostatically controlled
heater change your model?
1-2. For a particular car operated on a level road at steady conditions there is a
relation between throttle position and speed. Sketch the general shape you
would expect for this curve. If recordings were made of instantaneous speed
and throttle position while the car was driven normally for several miles
on ordinary roads, do you think that the instantaneous values of speed and
throttle position would fall on the steady-state curve? What inputs, outputs,
and state variables might prove useful in trying to ﬁnd a dynamic model
useful in predicting dynamic speed variations?
1-3. A car is driven over a curb twice—once very slowly and once quite rapidly.
What would you need to know about the car in the second case that you
did not need to know in the ﬁrst case if you were required to ﬁnd the tire
force that resulted from going over the curb?
1-4. In the steady state a good weather vane points into the wind, but when the
wind shifts, the vane cannot always be trusted to be pointing into the wind.
Identify inputs, outputs, and the parameters of the weather vane system that
affect its response to the wind. Sketch your idea of how the position of the
vane would change in time if the wind suddenly shifted 10◦.
1-5. The height of water in a reservoir ﬂuctuates over time. If you had to con-
struct a dynamic system model to help water resource planners predict
variations in the height, what input quantities would you consider? How
many state variables do you think you would need for your model?
1-6. A mass, M , and spring, k, are at rest in a gravity ﬁeld, about to be struck
by a mass, m, falling from a height, h. The mass, m, sticks to M , and
the two move downward. The variable, x, keeps track of the displacement
after impact. Sketch the general motion of x for some period of time after
impact. How many equations do you think are needed to describe this
system mathematically? If the system ever came to rest, what would be the
deﬂection of the spring?

PROBLEMS
15
m
M
x
g
k
k
m
M
1-7. The system is an electric circuit consisting of an input voltage, e(t), and a
capacitor, resistor, and inductor, C, R, L. As will be seen in later chapters, if
a voltage is applied to a capacitor, current ﬂows easily at ﬁrst and then slows
as the capacitor becomes charged. Inductors behave just the opposite, in that
they reluctantly pass current when a voltage is ﬁrst applied, and then the
current passes easily as time passes. If the input voltage is suddenly raised
from zero to some constant value, sketch the current in the capacitor, i C ,
and the inductor, i L, as a function of time. What is the steady-state current
in the capacitor and inductor?
e(t)
C
R
iC
iL
L
1-8. A hydraulic system consists of a supply pressure, Ps, and a long ﬂuid-
ﬁlled tube. Branching from the tube is an accumulator, C a, consisting of a
compliant gas separated from the ﬂuid by a diaphragm. The long tube has
inertia and resistance, I f and Rf . It may be hard to believe at this point,
but this hydraulic system exhibits identical behavior to that of the electric
circuit of Problem 1-7. Armed with this information, sketch the volume ﬂow
rate of the ﬂuid into the accumulator, Qa, and in the tube, QI , as a function
of time.

16
INTRODUCTION
Ps
gas
Ca
If
Rf
Qa
QI
1-9. Shown here is the hydraulic system in Problem 1-8 connected to a hydraulic
cylinder of piston area Ap. The piston is connected to a mass, m, attached
to the ground through the spring and damper, k and b. This is a “system”
consisting of interacting hydraulic and mechanical components. How many
variables do you think are needed to fully describe the motion of the system?
Sketch how you think the volume ﬂow rate in the accumulator and in the
tube will respond to a sudden elevation of the supply pressure. Sketch the
motion, x, of the mass.
Accumulator
Ca
m
k
b
Cylinder
Qa
Ps
If
Q1
Rf
Ap
x
gas

2
MULTIPORT SYSTEMS AND BOND
GRAPHS
In this chapter the ﬁrst steps are taken toward the development of system-
modeling techniques for engineering systems involving power interactions. First,
major subsystems are identiﬁed, and the means by which the subsystems are
interconnected are studied. The fact that interacting physical systems must trans-
mit power then is used to unify the description of interconnected subsystems.
A uniform classiﬁcation of the variables associated with power and energy is
established, and bond graphs showing the interconnection of subsystems are intro-
duced. Finally, the notions of inputs, outputs, and pure signal ﬂows are discussed.
2.1
ENGINEERING MULTIPORTS
In Figure 2.1 a representative collection of subsystems or components of engi-
neering systems is shown. Although the subsystems sketched are quite elemen-
tary, they will serve to introduce the concept of an engineering multiport. The
term “engineering” is used to imply that the devices are physical subsystems
used to build up systems such as automobiles, television sets, machine tools, or
electric power plants that are designed to accomplish some speciﬁc objectives.
The term “multiport” refers to a point of view taken in the description of the
subsystems.
Inspection of Figure 2.1 reveals that a number of variables have been labeled
on the subsystems. These variables are torques, angular speeds, forces, velocities,
voltages, currents, pressures, and volume ﬂow rates. The variables occur in pairs
associated with points at which the subsystems could be connected with other
subsystems to form a system. It would be possible, for example, to couple the
shaft of the electric motor (a) to one end of the drive shaft (c) and the hydraulic
motor shaft (b) to the other end of the drive shaft. After the coupling, the motor
torque and speed would be identical to the torque and speed of one end of the
17
System Dynamics: Modeling, Simulation, and Control of Mechatronic Systems, Fifth Edition
Dean C. Karnopp, Donald L. Margolis and Ronald C. Rosenberg
Copyright © 2012 John Wiley & Sons, Inc.

18
MULTIPORT SYSTEMS AND BOND GRAPHS
FIGURE 2.1. A collection of engineering multiports. (a) Electric motor: torque τ, angular
speed ω, voltage e, current i; (b) hydraulic pump: torque τ, angular speed ω, pressure
P, volume ﬂow rate Q; (c) drive shaft: torque τ, angular speeds ω1 and ω2; (d) spring
shock absorber unit: force F, velocities V 1 and V 2; (e) transistor: voltages e1 and e2,
currents i 1 and i 2; (f ) loudspeaker: voltage e, current i; (g) crank and slider mechanism:
torque τ, angular speed ω, force F, velocity V ; (h) wheel: force F, velocity V , torque τ,
angular speed ω; (i) separately excited direct current (dc) motor: torque τ, angular speed
ω, voltages ea and ef , currents i a and i f .
drive shaft. Similarly, the torque and speed of the other end of the drive shaft
would be identical to the torque and speed of the hydraulic pump. (If the drive
shaft were not rigid, then the two angular speeds, ω1 and ω2, on the drive shaft
ends would not necessarily be equal at all times.) Similarly, one could connect
the two terminals of the transistor (e) associated with e2 and i 2 to the terminals
of the loudspeaker (f ). After the connection, the voltage and current associated

ENGINEERING MULTIPORTS
19
with one terminal pair of the transistor would be identical to the voltage and cur-
rent associated with the loudspeaker terminals. Generally, when two subsystems
or components are joined together physically, two complementary variables are
simultaneously constrained to be equal for the two subsystems.
Places at which subsystems can be interconnected are places at which power
can ﬂow between the subsystems. Such places are called ports, and physical
subsystems with one or more ports are called multiports. A system with a single
port is called a 1-port, a system with two ports is called a 2-port, and so on.
The multiports in Figures 2.1a –h are shown as 2-ports. Figure 2.1f is a 1-port
as long as it is considered only as an electrical element and not as an element
coupling electrical and acoustic subsystems. Figure 2.1i is shown as a 3-port.
The variables listed for the multiports in Figure 2.1 and the variables that are
forced to be identical when two multiports are connected are called power vari-
ables, because the product of the two variables considered as functions of time is
the instantaneous power ﬂowing between the two multiports. For example, if the
electrical motor (Figure 2.1a) were coupled to the hydraulic pump (Figure 2.1b),
the power ﬂowing from the motor to the pump would be given by the product of
the angular speed and the torque. Since power could ﬂow in either direction over
time, a sign convention for the power variables will be established. Similarly,
power can be expressed as the product of a force and a velocity for a multiport in
which mechanical translation is involved, as the product of voltage and current
for an electrical port, and as the product of pressure and volume ﬂow rate for a
port at which hydraulic power is interchanged.
Since power interactions are always present when two multiports are con-
nected, it is useful to classify the various power variables in a universal scheme
and to describe all types of multiports in a common language. In this book all
power variables are called either effort or ﬂow. Table 2.1 shows effort and ﬂow
variables for several types of power interchange.
As Table 2.1 indicates, in general discussions the symbols e(t) and f (t) are
used to denote effort and ﬂow quantities as functions of time. For speciﬁc appli-
cations, more traditional notation suggestive of the physical variable involved
may be used. A curse of system analysis that becomes evident as soon as prob-
lems involving several energy domains are studied is that it is hard to establish
notation that does not conﬂict with conventional usage. In Table 2.1, for example,
a force is an effort quantity, e(t), even though the common use of the letter F
to stand for a force might be confused with the f (t), which stands for a ﬂow
quantity. These notational difﬁculties are bothersome but not fundamental, and
cannot be avoided except by using entirely new notation. For example, the letter
Q has been used for charge in electric circuits, volume ﬂow rate in hydraulics,
and heat energy in heat transfer. In this book, both the generalized notation e
and f and the physical notation in Figure 2.1 and Table 2.1 are used. The context
in which the symbols are used will resolve any possible ambiguities in meaning.
The power, P(t), ﬂowing into or out of a port can be expressed as the product
of an effort and a ﬂow variable, and thus in general notation is given by the

20
MULTIPORT SYSTEMS AND BOND GRAPHS
TABLE 2.1. Some Effort and Flow Quantities
Domain
Effort, e(t)
Flow, f (t)
Mechanical translation
Force component, F(t)
Velocity component, V (t)
Mechanical rotation
Torque component, τ(t)
Angular velocity component, ω(t)
Hydraulic
Pressure, P(t)
Volume ﬂow rate, Q(t)
Electric
Voltage, e(t)
Current, i(t)
following expression:
P(t) = e(t)f (t).
(2.1)
In a dynamic system the effort and the ﬂow variables, and hence the power, ﬂuc-
tuate in time. Two other types of variables turn out to be important in describing
dynamic systems. These variables, sometimes called energy variables for reasons
that will become clearer later, are called the momentum p(t) and the displacement
q(t) in generalized notation.
The momentum is deﬁned as the time integral of an effort. That is,
p(t) ≡
 t
e(t) dt = p0 +
 t
t0
e(t) dt,
(2.2)
in which either the indeﬁnite time integral can be used or one may deﬁne p0 to
be the initial momentum at time t0 and use the deﬁnite integral from t0 to t. In
the same way, a displacement variable is the time integral of a ﬂow variable:
q(t) ≡
 t
f (t) dt = q0 +
 t
t0
f (t) dt.
(2.3)
Again, the second integral expression in Eq. (2.3) indicates that at time t0 the
displacement is q0.
Other ways of writing the deﬁnitions in Eqs. (2.2) and (2.3) follow by con-
sidering the differential rather than the integral forms:
dp(t)
dt
= e(t),
dp = e dt;
(2.2a)
dq(t)
dt
= f (t),
dq = f dt.
(2.2b)
The energy, E(t), which has passed into or out of a port is the time integral of
the power, P(t). Thus,
E(t) ≡
 t
P(t) dt =
 t
e(t)f (t) dt.
(2.4)

ENGINEERING MULTIPORTS
21
The reason p and q are sometimes called energy variables is that in Eq. (2.4),
one may be able to write e dt as dp or f dt as dq by using Eq. (2.2a) or (2.2b).
Alternative expressions for E then follow:
E(t) =
 t
e(t) dq(t) =
 t
f (t) dp(t).
(2.5)
In the next chapter, cases will be encountered in which an effort is a function
of a displacement or a ﬂow is a function of a momentum. Then the energy can
be expressed not only as a function of time but also as a function of one of the
energy variables; thus,
E(q) =
 q
e(q) dq
(2.5a)
or
E(p) =
 p
f (p) dp.
(2.5b)
This provides the motivation for calling p and q energy variables in distinction
to the power variables e and f .
In Figure 2.2 a mnemonic device, fancifully called the “tetrahedron of state,”
is shown. The four variable types, e, f , p, and q, are associated with the four
vertices of a tetrahedron. Along two of the edges of the tetrahedron are indicated
the relationships between e and p and between f and q. In Chapter 3 the same
ﬁgure will be augmented to display the variables related by certain basic multiport
elements.
It is an interesting fact that the only types of variables that will be needed to
model physical systems are represented by the power and energy variables, e, f ,
p, and q. To make this statement more plausible, let us study the variables in
several energy domains in more detail.
FIGURE 2.2. The tetrahedron of state.

22
MULTIPORT SYSTEMS AND BOND GRAPHS
TABLE 2.2. Power and Energy Variables for Mechanical Translational Systems
Generalized
Mechanical
Variables
Translation
SI Units
Effort, e
Force, F
newtons (N)
Flow, f
Velocity, V
meters per second (m/s)
Momentum, p
Momentum, P
N-s
Displacement, q
Displacement, X
m
Power, P
F(t)V (t)
watts (N-m/s = W)
Energy, E
 x F dx,
 p V dP
joules (N-m = J)
Table 2.2 shows power and energy variables for mechanical translational ports.
Since the power variables force and velocity are considered primitive, the units
of the remaining variables follow from a choice in units for the power variables.
Units are the shoals on which many a system analysis has foundered, and it
is worthwhile to consider the great advantage that the metric or International
System of Units (SI) has for system dynamic studies as compared with the many
other unit systems that have been used in the past. In the SI system, power is
always measured in newton-meters per second (N-m/s) or the equivalent watts
(W), no matter what type of physical system is being studied. Similarly, energy
will always be measured in newton-meters or the equivalent joules (J) for an
electrical, mechanical, hydraulic, or any other type of physical system. Thus, if
the e, f , p, and q variables are given SI units, no bothersome unit conversions
will be necessary to properly account for power and energy interactions.
Anyone who has attempted to describe a complex system using traditional
units such as pounds, slugs, feet, volts, pounds per square inch, gallons per hour,
and the like will appreciate how difﬁcult it is to ensure that the proper unit
conversions have been incorporated. In fact, computer programs for processing
bond graphs into the equivalent differential equations for subsequent analysis and
simulation are incapable of incorporating conversion factors and thus essentially
assume that the SI system will be used. In this text, we will make the same
assumption. After an analysis or simulation has been completed, it is a relatively
simple matter to convert some results to a traditional unit system if desired. The
power demand of an electric car in kilowatts (kW), for example, could readily
be converted to horsepower if this would be better understood by consumers, but
we believe that it is a mistake to create a mathematical model using units that
require conversion factors internally.
Table 2.3 gives power and energy variables for ports involving mechanical
rotation. The shafts of motors, pumps, gears, and many other useful devices
represent such ports.
The entries in Table 2.4 for hydraulic power again are related to the variables
used in solid mechanics, but some unusual quantities are deﬁned. The momentum
quantity is deﬁned according to Eq. (2.2) as the integral of the effort, or in this
case, the pressure. Not only is the pressure momentum a quantity not often

ENGINEERING MULTIPORTS
23
TABLE 2.3. Power and Energy Variables for Mechanical Rotational Ports
Generalized
Mechanical
Variables
Rotation
SI Units
Effort, e
Torque, τ
newton-meters (N-m)
Flow, f
Angular velocity, ω
radians per second (rad/s)a
Momentum, p
Angular momentum, pτ
N-m-s
Displacement, q
Angle, θ
rada
Power, P
τ(t)ω(t)
N-m/s = W
Energy, E
 θ τ dθ,
 pτ ω dpτ
N-m = J
aRadians and other angular measures are dimensionless, but there are scale factors between, say,
radians, revolutions, and degrees which can cause errors not discoverable by dimensional analysis.
The formulas used in this book all are based on the radian as the unit of angular measure.
TABLE 2.4. Power and Energy Variables for Hydraulic Ports
Generalized
Hydraulic
Variables
Variables
SI Units
Effort, e
Pressure, P
newtons per square meter
Pa = (N/m2)a
Flow, f
Volume ﬂow rate, Q
cubic meters per second (m3/s)
Momentum, p
Pressure momentum, pp
N-s/m2
Displacement, q
Volume, V
m3
Power, P
P(t)Q(t)
N-m/s = W
Energy, E
 v P dV,
 pp Q dpp
N-m = J
aIn subsequent tables, when pressure is involved, the units will be given as N/m2 rather than the
equivalent pascals (Pa) for clarity.
encountered in conventional ﬂuid mechanics, but it is also a quantity without an
obvious symbol. The symbol pp is meant to indicate a momentum quantity that is
the integral of P(t), just as in Table 2.3 pτ was a momentum quantity deﬁned as
the time integral of τ(t). Fortunately, the lack of a commonly accepted symbol
for certain variables is not a serious handicap. When some facility in system
modeling has been developed, the generalized variables, e, f , p, and q, can be
used for variables in all the energy domains, if desired.
Finally, Table 2.5 gives power and energy variables for electrical ports. The
only new quantity that needs to be deﬁned is the unit of electrical charge, the
coulomb. It is common to use volts and amperes for the units of voltage and
current rather than their equivalents in terms of coulombs and SI units. Most
of the variables in Table 2.5 should be familiar, with the possible exception of
the momentum or ﬂux linkage variable λ. The usefulness of this variable will
become evident when inductors are studied in Chapter 3.

24
MULTIPORT SYSTEMS AND BOND GRAPHS
TABLE 2.5. Power and Energy Variables for Electrical Ports
Generalized
Electrical
Variable
Variable
Units
Effort, e
Voltage, e
volt (V) = newton-meter per
coulomb (N-m/C)
Flow, f
Current, i
ampere (A) = coulomb per sec-
ond (C/s)
Momentum, p
Flux linkage variable, λ
V-s
Displacement, q
Charge, q
C = A −s
Power, P
e(t)i(t)
V-A = W = N-m/s
Energy, E
 q e dq,
 λ i dλ
V-A-s = W-s = N-m = J
The tables of variables presented give at least preliminary evidence that the
variables associated with a variety of physical systems can be ﬁtted into the
scheme of Figure 2.2. The usefulness of this viewpoint will become increasingly
evident as systems are modeled in detail. In the next sections the ways in which
subsystem interconnections can be indicated graphically using the e, f , p, q
classiﬁcation will be shown.
2.2
PORTS, BONDS, AND POWER
The devices sketched in Figure 2.1 can all be treated as multiport elements with
ports that can be connected to other multiports to form systems. Further, when
two multiports are connected, power can ﬂow through the connected ports and
the power can be expressed as the product of an effort and a ﬂow quantity, as
given in Tables 2.2–2.5. We now develop a universal way to represent multiports
and systems of interconnected multiports based on the variable classiﬁcations in
the tables.
Consider the separately excited dc motor shown in Figure 2.3. Physically,
such motors have three obvious ports. The two electrical ports are represented
by armature and ﬁeld terminal pairs, and the shaft is a rotary mechanical port
as sketched in Figure 2.3a. Figure 2.3b is a conventional schematic diagram in
which the mechanical shaft is represented by a dashed line, the ﬁeld coils are
represented by a symbol similar to the circuit symbol for an inductance, and
the armature is represented by a highly schematic sketch of a commutator and
brushes. Note that the schematic diagram does not indicate what the detailed
internal model of this subsystem or component will be. To write down equations
describing the motor, an analyst must decide how detailed a model is necessary.
Figure 2.3c represents a further step in simplifying the representation of this
engineering multiport. The name dc motor is used to stand for the device, and the
ports are simply indicated by single lines emanating from the word representing
the device. In a system in which several subsystems are connected, these port

PORTS, BONDS, AND POWER
25
FIGURE 2.3. Separately excited dc motor: (a) sketch of motor; (b) conventional
schematic diagram; (c) multiport representation; (d) multiport representation with sign
convention for power.
lines will be called bonds. As a convenience, the effort and ﬂow variables may be
written next to the lines representing the ports. The notation can reﬂect the typical
variables used in the particular energy domains involved. Whenever the port lines
are either horizontal or vertical, it is useful to use the following convention:
• Efforts are placed either above or to the left of the port lines.
• Flows are placed either below or to the right of port lines.
• When diagonal lines are used, some judgment is required for placement of
the effort and ﬂow variables.
Note that Figures 2.3a, b, and c all contain the same information, namely,
that the dc motor is a 3-port with power variables τ, ω, ef , i f , ea, and i a. In
Figure 2.3d, a sign convention has been added: The half-arrow on a port line
indicates the direction of power ﬂow at any instant of time when the product of
the effort and ﬂow variables happens to be positive.
For example, if ω is positive in the direction shown in Figure 2.3a and if
τ is interpreted to be the torque on the motor shaft resulting from a connection
to some other multiport and is positive in the direction shown in Figure 2.3a,

26
MULTIPORT SYSTEMS AND BOND GRAPHS
then when τ and ω are both positive (or, for that matter, both negative), the
product τω is positive and represents power ﬂowing from the motor to some
other multiport coupled to the motor shaft. Thus, the half-arrow in Figure 2.3d
points away from the dc motor. Similarly, when ef , i f , ea, and i a are positive,
power ﬂows to the motor from whatever other multiports are connected to the
ﬁeld and armature terminals. Hence, the half-arrows associated with the ﬁeld
and armature ports point toward the motor.
Anytime one desires to be speciﬁc about the characteristics of a multiport—for
instance, in equation form or in the form of tabulated data—then a sign conven-
tion is necessary. The establishment of sign conventions is fairly straightforward
for electric circuits or for the circuit-like parts of representations of multiports
such as those of Figures 2.3a and b.
In mechanics, however, anyone who has struggled with the deﬁnition of forces
and moments on interconnected rigid bodies using “free-body diagrams” knows
that the establishment of sign conventions in mechanical systems is not trivial.
The problem is that the action and reaction forces show up as oppositely directed
in most representations. Thus, in Figure 2.3a, one must decide whether τ repre-
sents the torque on the motor shaft or from the motor onto some other multiport.
On diagrams such as Figure 2.3b, the mechanical signs are often not indicated
at all, and it is up to the analyst to insert plus or minus signs in the equations
without much help from the schematic diagram of the system.
When two multiports are coupled together so that the effort and ﬂow variables
become identical, the two multiports are said to have a common bond, in analogy
to the bonds between component parts of molecules. Figure 2.4 shows part of a
system consisting of three multiports bonded together. The motor and pump have
a common angular speed, ω, and torque at the coupling, τ. The battery and the
motor have a common voltage and current deﬁned at the terminals at which the
battery leads connect to the motor armature. To represent this type of subsystem
interconnection in the manner of Figure 2.3c or d is very straightforward; the
FIGURE 2.4. Partially assembled system.

BOND GRAPHS
27
FIGURE 2.5. Word bond graph for system of Figure 2.4.
joined ports are represented by a single line or bond between the multiports. This
has been done in Figure 2.5. The line between the pump and motor in Figure 2.5
implies that a port of the motor and a port of the pump have been connected, and
hence a single torque and a single angular speed pertain to both the pump and the
motor. The half-arrow on the bond means that the torque and the speed are deﬁned
in such a way that when their product, τω, is positive, power is ﬂowing from
the motor to the pump. Thus, lines associated with isolated multiports indicate
ports or potential bonds. For interconnected multiports, a single line represents
the conjunction of two ports, that is, a bond.
2.3
BOND GRAPHS
The mechanism for studying dynamic systems to be used subsequently in this
book is the bond graph. A bond graph simply consists of subsystems linked
together by lines representing power bonds, as in Figure 2.5. When major sub-
systems are represented by words, as in Figure 2.5, then the graph is called a
word bond graph. Such a bond graph establishes multiport subsystems, the way
in which the subsystems are bonded together, the effort and ﬂow variables at the
ports of the subsystems, and sign conventions for power interchanges.
Since the word bond graph serves to make some initial decisions about the
representation of dynamic systems, it is worthwhile to consider some example
systems even before the details of dynamic systems models have been presented.
In Figure 2.6 part of a positioning system for a radar antenna is shown. The
word bond graph indicates the major subsystems to be considered, and the bonds
with the effort and ﬂow variables indicated introduce some variables that will be
useful in characterizing the subsystems at a later stage in the analysis. You should
be able to associate all the efforts and ﬂows on the bond graph with physical
quantities associated with the physical system being modeled. Try it.
In Figure 2.7 another example system is shown. Again, it is instructive to try
to understand the effort and ﬂow quantities associated with the bonds in the word
bond graph. For example, what are the three efforts and three ﬂows associated
with the 3-port —Diff—? Can you see that —Wheel— is a 2-port that relates
a torque and an angular speed to a force and a velocity? Do not be surprised
if the construction of a word bond graph for a dynamic system seems less than

28
MULTIPORT SYSTEMS AND BOND GRAPHS
FIGURE 2.6. Schematic diagram and word bond graph for radar antenna pedestal drive
system.
obvious at this stage. As you progress in the details of system modeling, it will
become easier to recognize ports and bonds and, hence, multiport subsystems.
In Figure 2.7 you will notice that the inﬂuences of throttle position, clutch
linkage position, and gear selector position are indicated using a bond with a
full arrowhead. This notation, which is discussed in more detail in the next
section, indicates that an inﬂuence on the system from its environment occurs at
essentially zero power ﬂow. In the present example, the driver of the car is part

BOND GRAPHS
29
FIGURE 2.7. Automotive drive train example: (a) schematic diagram; (b) word bond
graph.
of the environment of the car and can control the car using the accelerator pedal,
clutch pedal, and gear shift using low power, as compared with the power present
in the drive train. A bond with a full arrow is an active bond, and it indicates a
signal ﬂow at very low power. In the present case, we assume that the controls
of the car can be moved by the driver at will, and our dynamic model need not
concern itself with the forces required to move the controls. A word bond graph
is useful for sorting true power interactions (which involve action and reaction)
from the one-way inﬂuences of active bonds.
Bond graphs will subsequently be used to model subsystems in detail inter-
nally. For this purpose, a set of basic multiport elements denoted not by words,
but by letters and numbers, will be developed in the next chapter. Ultimately,
detailed bond graphs must be substituted for the multiports designated by words
in a word bond graph. From a sufﬁciently detailed bond graph, state equations
may be derived using standard techniques or computer simulations of the system
can be made. Several computer programs will accept a wide variety of bond
graphs directly and produce either state equations for subsequent analysis or
system response predictions through computer simulation by solving the state
equations numerically. In addition, some types of analyses can be performed on
a bond graph without either writing the state equations or using a computer.

30
MULTIPORT SYSTEMS AND BOND GRAPHS
2.4
INPUTS, OUTPUTS, AND SIGNALS
Multiport subsystem characteristics typically are determined by a combination
of experimental and theoretical methods. It might be fairly easy to compute the
moment of inertia of a rotor, for example, merely by knowing the density of the
material of which the rotor was made and having a drawing of the part, but to
predict the port characteristics of a fan in great detail by theoretical means might
be much more difﬁcult than by measuring the characteristics using a prototype.
In performing experiments on a subsystem, the notions of input and output or,
equivalently, excitation and response, arise. The same concepts will carry over
when “mathematical” models of subsystems are assembled into a system model.
In performing experiments on a multiport, one must make a decision about
what is to be done at the ports. At each port, both an effort and a ﬂow variable
exist, and one can control either one but not both of these variables simulta-
neously. As an example, consider the problem of determining the steady-state
characteristics of a dc motor such as the one shown in Figures 2.3–2.5.
Figure 2.8a shows a sketch of equipment that could be used in experimenting
on the motor. The dynamometer is supposed to be capable of setting the speed
of the motor regardless of the torque delivered by the motor. This speed, ω, is
then an input variable to the motor. The torque being delivered by the motor
is then measured by means of a torque gage. The torque, τ, is thus an output
variable of the motor. Note that it is not possible to adjust the dynamometer so
that both torque and speed have arbitrary values. The nature of the experiment
is to discover what the motor torque is at a given speed.
Similarly, if voltages are supplied to the two electrical ports, that is, if voltages
are input variables, then the motor responds with measurable currents that are
output variables of the motor. Figure 2.8b is an attempt to use lines and arrows to
show which quantities are inputs to the motor and which are outputs. Figure 2.8b
is a simple example of a block diagram, in which lines with arrows indicate
the direction of ﬂow of signals. For multiports each port or bond has both an
effort and a ﬂow, and when these two types of variables are represented as paired
signals, it is possible for only one of these signals to be an input and the other
will be an output.
To know which of the effort and ﬂow signals at a port is the input of the
multiport, only one piece of information must be supplied to Figure 2.3c, 2.3d, or
2.5. This is because if either the effort or ﬂow variable is an input, the other must
be an output. In bond graphs the way in which inputs and outputs are speciﬁed
is by means of the causal stroke. The causal stroke is a short, perpendicular
line made at one end of a bond or port line. It indicates the direction in which
the effort signal is directed. (By implication, the end of a bond that does not
have a causal stroke is the end toward which the ﬂow’s signal arrow points.)
In Figure 2.8c causal strokes have been added to the multiport representation
of Figure 2.3d. By comparing Figures 2.8a –c, all of which contain the same
information regarding input and output variables, the meaning of causal strokes
may be appreciated.

INPUTS, OUTPUTS, AND SIGNALS
31
FIGURE 2.8. Experimental testing of a dc motor: (a) sketch of the test apparatus;
(b) block diagram showing input and output signal ﬂow; (c) causal strokes added to
multiport representation.
The meaning of causal strokes is summarized in Figure 2.9, in which both bond
graphs and block diagrams are shown. Note that the half-arrow sign convention
for power ﬂow and the causal stroke are completely independent. Thus, using A
and B to stand for subsystems as in Figure 2.9, all the following combinations
of sign convention and causal strokes are possible: A
B, A
B, A
B,
A
B. The study of input–output causality, which is a uniquely useful feature
of bond graphs, will be dealt with at length in succeeding chapters.

32
MULTIPORT SYSTEMS AND BOND GRAPHS
FIGURE 2.9. The meaning of causal strokes: (a) effort is output of A, input to B; ﬂow
is output of B, input to A; (b) effort is output of B, input to A; ﬂow is output of A, input
to B.
Finally, we come to the question of pure signal ﬂow, or the transfer of informa-
tion with negligible power ﬂow, which we already encountered in the example of
Figure 2.7. Multiports in principle all transmit ﬁnite power when interconnected.
This is correlated with the fact that both an effort and a ﬂow variable exist when
multiports are coupled. Thus, systems are interconnected by the matching of a
pair of signals representing the power variables.
In many cases, however, systems are so designed that only one of the power
variables is important, that is, so that a single signal is transmitted between two
subsystems. For example, an electronic ampliﬁer may be designed so that the
voltage from a circuit inﬂuences the ampliﬁer, but the current drawn by the
ampliﬁer has virtually no effect on the circuit. Essentially, the ampliﬁer reacts
to a voltage but extracts negligible power in doing so, as compared with the rest
of the power levels in the circuit. No information can really be transmitted at
exactly zero power, but, practically speaking, information can be transmitted at
power levels that are negligible, as compared with other system power levels.
Every instrument is designed to extract information about some system variable
without seriously disturbing the system to which the instrument is attached. An
ideal ammeter indicates current but introduces no voltage drop, an ideal voltmeter
reads a voltage while passing no current, an ideal pressure gage reads pressure
with no ﬂow, an ideal tachometer reads angular speed with no added torque, and
the like. When an instrument reads an effort or ﬂow variable, but with negligible
power, there is a signal connection between subsystems without the back effect
associated with ﬁnite power interaction.
The block diagrams of control engineering or the signal ﬂow graphs that were
developed ﬁrst for electrical systems ideally show signal coupling. As Figure 2.8b
shows, when multiports are considered, power interactions require a pair of bilat-
erally oriented signals. The bond graph, in which each bond implies the existence
of both an effort and a ﬂow signal, is a more efﬁcient way of describing mul-
tiports than are block diagrams or signal ﬂow graphs. Yet when the system is

PROBLEMS
33
dominated by signal interactions due to the presence of instruments, isolating
ampliﬁers, and the like, then either an effort or a ﬂow signal may be suppressed
at many interconnection points. In such a case, a bond degenerates to a single
signal and may be shown as an active bond. The notation for an active bond is
identical to that for a signal in a block diagram; for example, A
e
−→B indicates
that the effort, e, is determined by subsystem A and is an input to subsystem B.
Normally, this situation would be indicated by A e
f B, in which the ﬂow, f , is
determined by B and is an input to A. When e is shown as a signal (by means of
the full arrow on the bond) or, in other words, an activated bond, the implication
is that the ﬂow, f , has a negligible effect on A.
When automatic control systems are added to physical systems, the control
systems usually receive signals by means of nearly ideal instruments and affect
the systems through nearly ideal ampliﬁers. The use of active bonds for such
cases simpliﬁes the analysis of the systems. Notice that in using bond graphs,
one always assumes that multiports are coupled with both forward and back-
ward effects unless a speciﬁc modeling decision has been made that a back
effect is negligible and an active bond is speciﬁed. As we will see in Chapter
6, active bonds and block diagrams are often useful in studying control systems
but for systems that involve real power interactions, the bond graph provides an
ideal means for assuring the action–reaction effects on power bonds are properly
represented.
In the following chapter we begin the detailed modeling of subsystems by con-
sidering a basic idealized set of multiports that can be assembled to model the
pertinent physical effects in a subsystem. At this detailed level, physical param-
eters must be estimated and the rules of causality among ideal multiports must
be discovered and obeyed in assembling the subsystem model from elemental
multiports. As this process goes on, the notation and concepts brieﬂy introduced
in this chapter will become more familiar and useful.
PROBLEMS
2-1. Construct four tetrahedra of state similar to that shown in Figure 2.2 for
the following four physical domains: mechanical translation, mechanical
rotation, hydraulic systems, electrical systems. Replace e, f , p, and q
with their physical counterpart variables, and list the dimensions of each
variable.
2-2. For each multiport in Figure 2.1 construct a word bond graph similar to
that shown in Figure 2.3. Construct several systems by bonding several
multiports together.
2-3. Suppose a pump was tested by running it at various speeds and measuring
the volume ﬂow rate and torque for various pressures at the pump outlet.
Draw a schematic diagram, block diagram, and bond graph for the pump
test analogous to those shown in Figure 2.8 for an electric motor test.

34
MULTIPORT SYSTEMS AND BOND GRAPHS
2-4. If the system of Figure 2.5 had the causality show how the signals ﬂow by
using a block diagram of the type used in Figure 2.8b for each multiport.
See also Figure 2.9.
2-5. Apply causal strokes in an arbitrary manner to each bond in the bond graph
of Figure 2.6. Construct an equivalent block diagram for this system using
one block for each multiport as in Figure 2.8b. Indicate the signal ﬂow
directions that correspond to your causal marks as in Figure 2.9.
2-6. Repeat Problem 2-5 for the system of Figure 2.7. (Note that active bonds
act just like one-way signal ﬂows in a block diagram, but that normal
bonds each result in two signal ﬂows for e and f .)
2-7. Consider the system of Problem 2-4. Identify the system input variables
that come from the environment of the system, given the causal stroke
pattern indicated. What variables are indicated as system outputs (and
hence inputs to the environment)?
2-8. How long would a 100-W light bulb have to burn to use up the same
energy that would be required to raise a 10-kg mass 30 m up in the earth’s
gravity ﬁeld?
2-9. Represent an electric drill as a multiport. Consider the switch position
inﬂuence as occurring on an active bond. Apply causal strokes to your
bond graph, assuming that the drill is plugged into a 100-V outlet and
that the torque is determined by the material being drilled. Show a block
diagram for the drill corresponding to your choice of causality at the ports.
2-10. If a positive-displacement hydraulic pump is 100% efﬁcient (so that the
mechanical power is always instantaneously equal to the hydraulic power)
and if a torque of 5 N-m produces a pressure of 7.0 MPa, what is the
relationship between volume ﬂow and angular speed? (7.0 MPa = 7.0 ×
106 N/m2.)
2-11. The slider-crank mechanism is the fundamental kinematic device in vir-
tually all internal combustion engines. This device relates the rotational
motion of the crankshaft to the reciprocating motion of the piston. In
its most idealized representation, the slider-crank is massless, friction-
less, and constructed from rigid components. Under these assumptions,
the device is power conserving, in that τω = Fν, where τ is the torque

PROBLEMS
35
on the crankshaft, F is the force on the end of the connecting rod, ω is
the angular velocity of the crank, and ν is the velocity of the rod end. If
we can derive how ν and ω are related, then we automatically know how
F and τ are related.
l
θ, θ = ω
x
F
v
τ
α
(a) Slider-crank device
Slider-crank device
(b) Word bond graph
τ
ω
F
v
.
As a word bond graph, the slider-crank will be represented as indicated in
the ﬁgure. We will soon learn that this device is a modulated transformer.
Derive the relationship between ν and ω. Here is some help:
x = R cos θ + l cos α
l sin α = R sin θ
Solve the second equation for sin α and then use cos α =

1 −sin2 α.
Substitute into the ﬁrst equation. Then differentiate the result to relate
˙x = −v to ˙θ = ω. If you complete these steps, you will have derived
ν = m(θ)ω, where m(θ) is a function of the crank angle. Since this device
is power conserving, we immediately know that τ = m(θ)F.

36
MULTIPORT SYSTEMS AND BOND GRAPHS
Now try to derive the relationship between τ and F by using force and
moment equilibrium conditions. You will ﬁnd this far more difﬁcult than
deriving the velocity–angular velocity relationship.
2-12. The hydraulic system from Problem 1-9 has the word bond graph shown
in the following ﬁgure. Causality has been assigned to the bonds. Identify
the inputs and outputs for each element.
Tube
Ps
Qa
Pc
QI
Fm
vm
Fs
vs
Fd
vd
Qs
Accumulator
Supply
pressure
Cylinder
Mass
Spring
Damper

3
BASIC BOND GRAPH ELEMENTS
In Chapter 2 real devices were considered as subsystems from the point of view
of power exchanges and external port variables. In this chapter a basic set of
multiport elements is deﬁned that can be used to model subsystems in detail.
These elements function as components of subsystem and system models and
are, in many cases, idealized mathematical models of real components, such as
resistors, capacitors, masses, springs, and pipes. In other cases, however, the basic
elements are used to model physical effects in a device and cannot be put into a
one-to-one correspondence with physical components of the device. For example,
one might create a model of an electrical or ﬂuid transmission line using a ﬁnite
collection of resistance, capacitance, and inertia elements, even though in the real
device the effects being modeled are distributed along the transmission line and
not concentrated into lumps as in the model.
Using bond graphs and the classiﬁcation of power and energy variables pre-
sented in the previous chapter, it turns out that only a few basic types of multiport
elements are required in order to represent models in a wide variety of energy
domains. The bond graph notation often allows one to visualize aspects of the
system more easily than would be possible with just the state equations or with
some other graphical notation designed for a single energy domain or for signal
ﬂow rather than power ﬂow. The search for a bond graph model of a complex
system frequently increases one’s understanding of the physical system.
3.1
BASIC 1-PORT ELEMENTS
A 1-port element is addressed through a single power port, and at the port a
single pair of effort and ﬂow variables exists. In principle, a 1-port can be a very
complex subsystem. For example, an ordinary electrical wall outlet can sometimes
be represented as 1-port element in a system analysis. The port actually connects
37
System Dynamics: Modeling, Simulation, and Control of Mechatronic Systems, Fifth Edition
Dean C. Karnopp, Donald L. Margolis and Ronald C. Rosenberg
Copyright © 2012 John Wiley & Sons, Inc.

38
BASIC BOND GRAPH ELEMENTS
FIGURE 3.1. The 1-port resistor: (a) bond graph symbol; (b) deﬁning relation;
(c) representations in several physical domains.
to a vast network of power generation and distribution equipment, yet from the
point of view of a system model, a relatively simple characterization of what is
behind the wall outlet as a 1-port may sufﬁce.
Here we ﬁrst deal with the most primitive 1-ports. We consider, in order,
1-port elements that dissipate power, store energy, and supply power.
The 1-port resistor is an element in which the effort and ﬂow variables at
the single port are related by a static function. Figure 3.1 shows the bond graph
symbol for the resistor, a typical graph of the constitutive relation between e and
f , and sketches of resistors in several energy domains. The electrical resistor is
an R-element if it can be characterized by a volt–current constitutive relationship
such as
e = Ri.
Since e is an effort variable and i is a ﬂow variable, this constitutive relationship
exactly ﬁts our deﬁnition of a linear 1-port resistor.
The mechanical dashpot is a 1-port resistor for the same reason as in the elec-
trical resistor. If an ideal dashpot is characterized by a force–velocity relationship
such as
F = bV,
where b is the dashpot constant, then it is represented as a 1-port R element.
Since F is an effort and is V a ﬂow, the constitutive relationship also ﬁts our
deﬁnition of a 1-port resistor.

BASIC 1-PORT ELEMENTS
39
The hydraulic example is a 1-port resistor because it is characterized by a
pressure–volume ﬂow rate relationship and pressure and volume ﬂow rate are
bond graph effort and ﬂow variables. In most hydraulic cases the effort–ﬂow
relationship is more complicated than the ﬁrst two examples. This is dealt with
in great detail in Chapters 4 and 12; here we just specify that for turbulent ﬂow
through a restriction, the pressure–ﬂow relationship is
P1 −P2 =
1
2A2 ρQ|Q|
or
Q = A

2
ρ |P1 −P2| sgn(P1 −P2),
where A is the ﬂow area. These relationships are effort–ﬂow relationships and
again ﬁt our deﬁnition of a one-port resistor.
Usually, resistors dissipate energy; that is, power ﬂows into the resistor but
never comes out of it. From the point of view of a system connected to a resistor,
over time, energy seems to disappear into a resistor. This must be true for simple
electrical resistors, mechanical dampers or dashpots, porous plugs in ﬂuid lines,
and other analogous elements. Noting from Figure 3.1a that power ﬂows into
the port when the product of e and f is positive according to the sign convention
shown, we may deduce that power is always dissipated if the deﬁning constitutive
relation between e and f lies only in the ﬁrst and third quadrants of the e–f plane
as shown in Figure 3.1b, for then the product ef is positive when both e and f
are positive or when both are negative. Because the resistance function cannot
lie in the second or fourth quadrant, the law must pass through the origin.
When the relation between e and f for a 1-port resistor plots as a curved line
as in Figure 3.1b, then the resistor is a nonlinear element. If the relation is a
straight line, then it is a linear element. In the special case of a linear element, a
coefﬁcient, the resistance, or its inverse, the conductance, may be deﬁned. These
parameters are actually just the slopes of the straight line laws when plotted as
e versus f or f versus e.
When a resistive element is assumed to be linear, it is conventional to indicate
this on the bond graph by appending a colon (:) next to the −R and noting the
physical symbol for the resistance parameter. This is done in Figure 3.1 for the
electrical resistance and the mechanical dashpot. For the hydraulic resistor, no
parameter is indicated since this is a nonlinear element and no single resistance
parameter can be identiﬁed.
Table 3.1 shows the resistor constitutive laws in general form and in speciﬁc
form for several energy domains. Note that for power-dissipating linear resistors,
with the sign convention shown in Figure 3.1 and Table 3.1, the general resis-
tance and conductance parameters, R and G, respectively, are positive, as are the
corresponding parameters in the speciﬁc energy domains.
For simplicity, we establish the following arbitrary but useful rule: For passive
(power dissipating) resistors, establish the power sign convention by means of

40
BASIC BOND GRAPH ELEMENTS
TABLE 3.1. The 1-Port Resistor,
e⇀
f R
General
Linear
SI Units for Linear
Relation
Relation
Resistance Parameter
Generalized variables
e = R(f )
e = Rf
R = e/f
f = −1
R (e)
f = Ge = e/R
Mechanical translation
F = R(V )
F = bV
b = N-s/m
V = −1
R (F)
Mechanical rotation
τ = R(ω)
τ = cω
c = N-m-s
ω = −1
R (τ)
Hydraulic systems
P = R(Q)
P = RQ
R = N-s/m5
Q = −1
R (P)
Electrical systems
e = R(i)
e = Ri
R = V/A = (ohm)
i = −1
R (e)
i = Ge
a half-arrow pointing toward the resistor. Then linear resistance parameters will
be positive, and nonlinear relations will fall in the ﬁrst and third quadrants of the
e–f plane.
Since linear models are of great usefulness in certain ﬁelds (vibrations and
electric circuits, for example), the linear versions of resistance relations in various
energy domains are shown in Table 3.1 with the same notation employed in
Chapter 2. The units of the linear resistance parameter are simply the units of
effort divided by the units of ﬂow. The units displayed in Table 3.1 are worth
studying, since many of them may not be familiar. The only resistance unit
digniﬁed with its own name is the electrical ohm.
Next consider a 1-port device in which a static constitutive relation exists
between an effort and a displacement. Such a device stores and gives up energy
without loss. In bond graph terminology, an element that relates e to q is called
a 1-port capacitor or compliance. In physical terms, a capacitor is an idealiza-
tion of such devices as springs, torsion bars, electrical capacitors, gravity tanks,
and hydraulic accumulators. The bond graph symbol, the deﬁning constitutive
relation, and some physical examples are shown in Figure 3.2.
As with the 1-port resistor, there are idealized linear compliance elements
as well as nonlinear ones. In Figure 3.2b, a general nonlinear constitutive e, q
relationship is shown. If the element can be assumed linear, then the e versus q
curve will be a straight line and a compliance parameter can be deﬁned such that
e = q/C. Note that it is customary to deﬁne the linear compliance relationship
using the inverse of the slope of the e versus q curve. The reason for this will
become clear when more physical elements are presented in the next chapter.
For the linear case, it is customary to indicate the compliance parameter on the
bond graph as shown in Figure 3.2.

BASIC 1-PORT ELEMENTS
41
FIGURE 3.2. The 1-port capacitor. (a) Bond graph symbol; (b) deﬁning relation;
(c) representation in several physical domains.
The electrical capacitor, of capacitance C farads, is a compliance element
because its idealized behavior is
e = q
C ,
where q =

i dt is the charge on the capacitor. This ﬁts perfectly with our
deﬁnition of a linear 1-port capacitor. The spring of stiffness, k, is a 1-port
capacitor because it is characterized by
F = kx,

42
BASIC BOND GRAPH ELEMENTS
TABLE 3.2. The 1-Port Capacitor,
e⇀
f = ˙q C
General
Linear
SI Units for Linear
Relation
Relation
Capacitance Parameter
Generalized
q = C(e)
q = Ce
C = q/e
e = −1
C (q)
e = q/C
1/C = e/q
Mechanical
X = C(F)
X = CF
C = m/N
Translation
F = −1
C (X)
F = kX
k = N/m
Mechanical
θ = C(τ)
θ = Cτ
C = rad/N-m
Rotation
τ = −1
C (θ)
τ = kθ
k = N-m/rad
Hydraulic
V = C(P )
V = CP
C = m5/N
Systems
P = −1
C (V )
P = V /C
Electrical
q = C(e)
q = Ce
C = A-s/V
Systems
e = −1
C (q)
e = q/C
= farad (F)
where x =

V dt is the relative displacement across the spring. This deﬁnition
ﬁts the general deﬁnition of a 1-port capacitor and the speciﬁc deﬁnition of a
linear 1-port C-element as indicated in Table 3.2. In this case, as indicated on
the bond graph, the compliance parameter is C = 1/k.
A water storage tank is discussed in the next chapter, and it is ideally a linear
compliance element. The torsional spring of stiffness, kτ, N-m/rad, is a linear
1-port compliance for the identical reason as in the linear spring. The compliance
parameter for the torsional spring is 1/kτ, as indicated on the bond graph of
Figure 3.2.
An air bladder is also discussed in the next chapter. There are circumstances in
which it may be modeled as a linear C-element, at least for small pressure excur-
sions. However, in general, compressing air is a nonlinear process. If the process
was isentropic, then the behavior of the air bladder could be characterized by
P = P0V γ
0
V γ
,
where V = ∫Q dt, P0, V 0 are initial pressure and volume in the bladder, and
γ is the ratio of speciﬁc heats for air. This behavior is nonlinear, but still ﬁts
our general deﬁnition of a 1-port capacitor as indicated in Table 3.2. Thus, for
the case here, the air bladder is a compliance element, but it is not a linear one,
and no compliance parameter can be identiﬁed nor indicated on the bond graph.
Note that when a sign convention similar to that used for the resistor, namely,
⇀C, is used for the C-element, then ef represents power ﬂowing to the capacitor
and
E(t) =
 t
0
e(t)f (t) dt + E0
(3.1)

BASIC 1-PORT ELEMENTS
43
represents the energy stored in the capacitor at any time t. The energy stored
initially at t = 0 (if any) is called E0.
Since from Eq. (2.2b) the displacement q is deﬁned so that f dt ≡dq, and the
constitutive relation of a C-element implies that e is a function of q, e = e(q),
then Eq. (3.1) can be rewritten as
E(q) =
 q
q0
e(q) dq + E0
(3.2)
where E0 is the energy stored when q = q0. Usually, it is convenient to deﬁne
the energy stored to be zero when the effort is zero. Then, if q0 is that value of
q at which e = 0, and E0 = 0, Eq. (3.2) may be written as
E(q) =
 q
q0
e(q) dq.
(3.2a)
The operation indicated in Eq. (3.2a) may be interpreted graphically as shown
in Figure 3.3. As q varies, the area under the curve of e versus q varies, and
this area is equal to the stored energy, E. The conservation of energy for —C is
almost obvious. If q goes from q0 to ˆq as in Figure 3.3a, then energy is stored;
if q then ever returns to q0, the shaded area disappears and all the stored energy
disappears. The power ﬂow into the port, which resulted in the storage of energy,
reverses and power ﬂows out of the port. During the process, no energy is lost;
in other words, energy is conserved.
Table 3.2 summarizes the relationships characterizing capacitors. The units
for linear capacitance parameters are given, and again it may be noted that only
the electrical unit is given a name, the farad. For linear mechanical systems, it
is common to use the spring constant, k, rather than the compliance, C ≡1/k,
which is analogous to the electrical capacitance, C, and the parameter C in
generalized variables. In mixed electrical–mechanical systems, one must simply
be careful to note whether a numerical parameter corresponds to C or the inverse
of C in a bond graph. Once again, the reader is urged to study the units shown,
since some units will probably be unfamiliar.
A second energy-storing 1-port arises if the momentum p is related by a static
constitutive law to the ﬂow f . Such an element is called an inertia in bond graph
terminology. The bond graph symbol for an inertia, the constitutive relation, and
several physical examples are shown in Figure 3.4. The inertia is used to model
inductance effects in electrical systems, and mass or inertia effects in mechanical
or ﬂuid systems.
The 1-port inertia is characterized by an f , p relationship as indicated in
Figure 3.4b. If the relationship is linear, then it will plot as a straight line and
the constitutive relationship will have the form f = p/I , where I is the inertia
parameter and p = ∫e dt. Note that, as with the linear compliance element, it is
customary to deﬁne the inertance parameter as the inverse of the slope of the
linear relationship of f versus p. Shown in Figure 3.4 is an electrical inductor

44
BASIC BOND GRAPH ELEMENTS
FIGURE 3.3. Area interpretation of stored energy for a 1-port capacitor: (a) nonlinear
case; (b) linear case.
with inductance L, a mass m, a section of ﬂuid-ﬁlled pipe with ﬂuid inertia, I f ,
and a rotating disk with moment of inertia, J . These are all examples of linear
1-port inertia elements. The inductor is ideally represented by the constitutive
relationship i = λ/L, where λ = ∫e dt; the mass is represented by V = p/m,
where p = ∫Fdt; and the rotating disk has the ideal behavior, ω = pτ/J, where
pτ = ∫τ dt. All these elements ﬁt exactly our deﬁnition of a 1-port inertia as
shown in Table 3.3. The ﬂuid inertia is also a linear 1-port inertia, which is
covered thoroughly in Chapter 4.
Using the sign convention ⇀I, the power ﬂowing into the inertia is given
by the expression in Eq. (3.1). In the present case, Eq. (2.2a) allows us to write

BASIC 1-PORT ELEMENTS
45
FIGURE 3.4. The 1-port inertia: (a) bond graph symbol; (b) deﬁning relation; (c) rep-
resentation in several physical domains.
e dt ≡dp, and if f = f (p), then Eq. (3.1) can be written thus:
E(p) =
 p
p0
f (p) dp + E0.
(3.3)
If the energy is deﬁned to vanish when f vanishes and if p0 corresponds to
that point in the plot of f versus p at which f = 0, then
E(p) =
 p
p0
f (p) dp.
(3.3a)
The similarities between Eqs. (3.2) and (3.3) should be noted. Often the energy
associated with a capacitor is called potential energy, whereas the energy associ-
ated with an inertia is called kinetic energy. These names are applied primarily to

46
BASIC BOND GRAPH ELEMENTS
FIGURE 3.5. Area interpretation of stored energy for 1-port inertia. (a) Nonlinear case;
(b) linear case.
mechanical systems. In electrical systems, the corresponding two forms of stored
energy are sometimes called electric and magnetic energy.
As in the case of the capacitor, if the constitutive relation of the inertia is
plotted, then there is an area interpretation of the stored energy. This interpretation
is shown in Figure 3.5, and, again, you should be able to demonstrate that any
energy stored in an I-element can be recovered without loss.
Table 3.3 shows the constitutive relations for inertias and gives units for iner-
tance parameters for the linear case. Since most engineering work is accomplished
successfully using Newton’s law rather than the postulates of relativity, the rela-
tion between velocity and momentum is linear and the mass or moment of inertia
is the inertia parameter. Although it is common to think of mass as a ratio of
force to acceleration from the equation
F = ma,
a ≡˙V ,
(3.4)

BASIC 1-PORT ELEMENTS
47
TABLE 3.3. The 1-Port Inertia,
e= ˙p
⇀
f I
General
Linear
SI Units for Linear
Relation
Relation
Inertance Parameter
Generalized
p = I(f )
p = If
I = p/f
variables
f = −1
1 (p)
f = p/I
1/I = f /p
Mechanical
p = I(V )
p = mV
m = N-s2/m = kg
translation
V = −1
1 (p)
V = p/m
Mechanical
pτ = I(ω)
pτ = Jω
J = N-m-s2 = kg-m2
rotation
ω = −1
1 (pτ)
tω = pτ/J
Hydraulic
pp = I(Q)
pp = IQ
I = N-s2/m5
systems
Q = −1
1 (pp)
Q = pp/I
Electrical
λ = I(i)
λ = Li
L = V-s/A
systems
i = −1
1 (λ)
i = λ/L
= henrys (H)
the table gives the fundamental deﬁnition of a mass according to
p ≡mV
(3.5)
with
˙p ≡F.
(3.6)
Clearly, when Eq. (3.5) is differentiated with respect to time, and Eq. (3.6) is
used, then Eq. (3.4) can be derived. If, on the other hand, Eq. (3.5) is replaced
with a nonlinear relation,
p = I(V ) =
mV
(1 −V 2/c2)1/2 ,
(3.7)
where m is the rest mass and c is the velocity of light, then Eqs. (3.5) and (3.6)
hold for the special theory of relativity. See Reference [1, p. 19], for example.
Thus, there is some justiﬁcation for the general constitutive relations given for
mechanical systems, even though engineering is overwhelmingly concerned with
the linear case. For electrical systems, however, the relation between the ﬂux
linkage variable (the time integral of the voltage) and the current in an inductor
is nonlinear in typical cases. The use of the linear parameter L is then the result
of a modeling decision. It is more satisfactory to generalize λ = Li to λ = I(i)
with ˙λ = e than to try to generalize e = L di/dt to the nonlinear case.
As an aid in remembering the three 1-port relationships, the tetrahedron of state
introduced in Figure 2.2 may be used. See Figure 3.6. We now know something
about ﬁve of the six edges of the tetrahedron. The sixth edge, which stretches

48
BASIC BOND GRAPH ELEMENTS
FIGURE 3.6. The three 1-ports placed on the tetrahedron of state according to the vari-
ables to which they relate.
between the vertices representing p and q, is hidden from view in Figure 3.6.
This is just as well, since no basic element will relate p and q.∗
Finally, two useful and rather simple 1-ports must be deﬁned—the effort source
and the ﬂow source: the 1-port sources are idealized versions of voltage supplies,
pressure sources, vibration shakers, constant-ﬂow systems, and the like. In each
case, an effort or ﬂow is either maintained reasonably constant, independent
of the power supplied or absorbed by the source, or constrained to be some
particular function of time. As an example of a constant-effort source, consider
the gravity force on a mass. Near the surface of the earth, this force is essentially
independent of the velocity of the mass. As an example of a time-varying source,
the electrical wall outlet will serve. The wall outlet enforces a sinusoidal voltage
across the power cord wires of most small appliances. Over a reasonable range
of currents, the voltage is independent of ﬂuctuations in the current. Of course,
the voltage is actually affected by large currents, and a fuse will blow to protect
the circuits if very large currents build up, but this simply means that the real
outlet is not modeled exactly by an ideal source of effort. Real sources can be
modeled as combinations of effort and ﬂow sources combined with other bond
graph elements.
Table 3.4 presents bond graph symbols and the constitutive relations for
sources. In this table, physical names are given for the respective energy domains.
There are sources of velocity, SV , sources of force, SF , sources of pressure, SP ,
and so forth. In general, it is best to use the generalized name for the effort
∗One can, in fact, deﬁne an element corresponding to the hidden edge, the “memristor.” While
interesting and occasionally useful, memristors can be represented in terms of other elements to be
introduced later, so the memristor will not be considered to be a basic element. See G. F. Oster and
D. M. Auslander, “The memristor: a new bond graph element,” Trans. ASME, J. Dynamic Systems,
Measurement, and Control, 94, Ser. G, no. 3, pp. 249–252 (Sept. 1972).

BASIC 1-PORT ELEMENTS
49
TABLE 3.4. The 1-Port Source Elements
Bond Graph Symbol
Deﬁning Relation
Generalized variables
Se ⇀
e(t) given, f (t) arbitrary
Sf ⇀
f (t) given, e(t) arbitrary
Mechanical translation
SF ⇀
F(t) given, V (t) arbitrary
SV ⇀
V (t) given, F(t) arbitrary
Mechanical rotation
Sτ ⇀
τ(t) given, ω(t) arbitrary
Sω ⇀
ω(t) given, τ(t) arbitrary
Hydraulic systems
SP ⇀
P(t) given, Q(t) arbitrary
SQ ⇀
Q(t) given, P(t) arbitrary
Electrical systems
Se ⇀
e(t) given, i(t) arbitrary
Si ⇀
i(t) given, e(t) arbitrary
or ﬂow source, Se or Sf , and denote next to the generalized name the speciﬁc
energy domain being represented. This is done by example in most of the fol-
lowing chapters. It should be further noted that the symbols SE and SF for effort
and ﬂow source are often used in computer programs.
Typically, source elements are thought of as supplying power to a system. This
accounts for the sign-convention half-arrow shown, which implies that when e(t)
f (t) is positive, power ﬂows from the source to whatever system is connected to
the source. Later we will encounter modeling situations in which it is convenient
to have the half-arrow pointing in the opposite direction to the directions shown
in Table 3.4.
Since a source maintains one of the power variables constant or a speciﬁed
function of time no matter how large the other variable may be, a source can
supply an indeﬁnitely large amount of power. This is, of course, not a realistic
assumption, and real devices are not really ideal sources even though they may
be modeled approximately by sources. As an example, consider the problem of
predicting the current ﬂowing from a 12-V automotive battery into a variable
resistor connected to the battery. Figure 3.7 shows a circuit diagram, a bond
graph, and a plot of voltage versus current. This is a static system operating at
points at which the source characteristic intersects the resistor characteristics. For
small currents (or high values of the resistance R), the battery is almost a constant-
voltage source. When the resistance is lowered toward zero, the predicted current
approaches inﬁnity. Actually, when the current gets large, the internal resistance
in the battery reduces the voltage below the nominal 12 V. In fact, if the resistance
approaches zero, as it will when a shorting bar is put across the battery terminals,
the battery current will approach a ﬁnite value, labeled “short-circuit current” in
Figure 3.7c. When more basic multiports have been deﬁned, it will be possible
to model the battery with an ideal source and a resistor in such a way that the
actual characteristics in Figure 3.7 will be reproduced by the model. For now,
we simply note that ideal sources are useful in modeling real devices but should

50
BASIC BOND GRAPH ELEMENTS
FIGURE 3.7. Study of a battery connected to a variable resistance: (a) electric circuit
diagram; (b) bond graph; (c) plot of source, real battery, and resistance characteristics.
not be expected to be realistic models in all power ranges unless supplemented
by other multiports.
A universe made up only of 1-ports would be very simple, since bond graphs
more complicated than that in Figure 3.7b would be impossible. This leads one to
anticipate that 1-ports are not the whole story. A logical next step is to consider
2-ports.
3.2
BASIC 2-PORT ELEMENTS
One might expect that it would be necessary to deﬁne more basic types of 2-ports
than 1-ports, but, in fact, only two basic types of 2-ports need to be deﬁned here.
There are, of course, an unlimited number of 2-port subsystems, but we need to
discuss here only those that cannot be modeled using the basic 1-ports of the
previous section and other elements to be deﬁned later. (Chapter 7 discusses the
more advanced topic of 2-port and multiport versions of the 1-port R-, C-, and
I-elements discussed above.)

BASIC 2-PORT ELEMENTS
51
The 2-ports to be discussed here are ideal in the speciﬁc sense that power is
conserved. If any 2-port, —TP—, has the sign convention
e1
⇀
f1
TP
e2
⇀
f2
,
then power conservation means that at every instant of time
e1(t)f1(t) = e2(t)f2(t),
(3.8)
where the bonds are numbered so that all variables can be simply described as a
type, e, f, p, or q with a bond number subscript.
The power sign convention implied in Eq. (3.8) and shown in the bond graph
just above is a through power sign convention in the sense that power is thought
of as ﬂowing through the 2-port. Equation (3.8) states that whatever power is
ﬂowing into one side of the 2-port is simultaneously ﬂowing out of the other side.
One way in which Eq. (3.8) can be satisﬁed is found in the 2-port known as
a transformer and given in the bond graph symbol ⇀TF ⇀. The constitutive
laws of the ideal 2-port transformer are
e1 = me2,
mf1 = f2,
(3.9)
in which the parameter m is called the transformer modulus∗and the subscripts
1 and 2 correspond to the two ports, as shown in Figure 3.8a. Multiplying the
two equations in Eq. (3.9) yields Eq. (3.8). Note that Eqs. (3.9) and (3.8) both
imply the use of the through sign convention shown in the ﬁgure.
Also shown in Figure 3.8 are a number of devices that in idealized form are
modeled by transformers. In no case is the physical device exactly a transformer.
For example, the lever in Figure 3.8b would only be a ⇀TF ⇀if it were
massless, rigid, and frictionless. Similar restrictions can be made on the validity
of the transformer as a model for the other physical devices. Actual models of the
devices can be made using the ideal transformer and other multiports to account
for nonideal effects if these effects are important to the system under study.
The lever is an ideal transformer because kinematics dictates that (b/a)V1 =
V2 and moment equilibrium requires F1 = (b/a)F2. This is exactly the deﬁnition
for the ideal transformer from Eq. (3.9) with the ratio (b/a) playing the role
of the modulus m. If the velocity relationship had been derived ﬁrst, then there
would be no need to derive the force relationship, as it comes automatically due
to the power conserving nature of the transformer.
Similarly, the gear set is an ideal transformer because kinematics dictates that
(r1/r2)ω1 = ω2 and moment equilibrium requires τ1 = (r1/r2)τ2. This also ﬁts
exactly the deﬁnition from Eq. (3.9). If the angular velocity relationship had been
∗There is an ambiguity here since one could just as well write Eq. (3.9) as, me1 = e2, f 1 = mf 2,
in which case the modulus would be deﬁned as the inverse of the modulus in Eq. (3.9).

52
BASIC BOND GRAPH ELEMENTS
FIGURE 3.8. Transformers: (a) bond graph; (b) ideal rigid lever; (c) gear pair;
(d) electrical transformer; (e) hydraulic ram.
derived ﬁrst, then there would be no need to derive the torque relationship, as it
also comes automatically due to the power conserving nature of the transformer.
The electrical transformer from Figure 3.8d is a transformer in the bond graph
sense because the voltage is stepped up or down as the current is stepped down
or up according to the turns ratio of the windings of the transformer. In these
ﬁrst three cases, the transformer relates similar power variables on each side of
the device. An extremely important use of the transformer is to cross from one
energy domain to another. The hydraulic ram is a ﬁrst example of this.
The hydraulic ram is shown in Figure 3.8e. Hydraulic power is transduced
into mechanical power. In such a case, the transformer can also be called a
transducer. The constitutive laws of the ideal version of this device are
F = AP,
AV = Q,
(3.10)
in which the area of the piston, A, functions as the transformer modulus, m, as it
appears in Eq. (3.9). The two equations of (3.10) can be derived separately from
physical considerations, or if one is derived, the other follows because of power
conservation, FV = PQ. The fact that only a single modulus exists serves as a
useful check on constitutive equations such as in Eq. (3.10).

BASIC 2-PORT ELEMENTS
53
Another way in which the power balance of Eq. (3.8) may be satisﬁed is
embodied in the gyrator, which is symbolized thus: ⇀GY ⇀. If the bonds are
numbered 1 and 2, the constitutive laws of the gyrator are
e1 = rf2,
rf1 = e2,
(3.11)
in which r is the gyrator modulus and the through sign convention of Figure 3.9a
is implied. The modulus is called r because Eq. (3.11) reminds one of the 1-
port linear resistance law, as shown in Table 3.1. In Eq. (3.11), however, the
effort and ﬂow at two different ports are statically related. Thus, a 1-port resistor
dissipates power, whereas the 2-port gyrator conserves power, as can be seen by
multiplying the two equations in (3.11) together.
Figure 3.9 shows some physical devices that are at least approximately gyra-
tors. The electric circuit symbol is used to represent gyrators in electric network
diagrams. Electric gyrators can be made using the Hall effect, and the gyrator
is needed to model effects at microwave frequencies even though in that case it
cannot be identiﬁed as a separate physical device.
Anyone who has played with a toy gyroscope has observed a gyrator. If the
rotor of Figure 3.9c spins very rapidly, a gentle push in the direction of F1 will
yield a proportional velocity V2. Similarly, a force F2 will result in a velocity V1.
The counterintuitive behavior of the gyroscope is predicted by Eq. (3.11). For
example, if the gravity force is in the direction of F2, then the device precesses
in a horizontal path. If a gyroscope rotates slowly, or if large disturbances are
applied, the gyroscope must be modeled as a multidimensional rigid body. The
bond graph, then, is much more complex than a simple ⇀GY ⇀, but even then
FIGURE 3.9. Gyrators: (a) bond graph; (b) symbol for electrical gyrator; (c) mechanical
gyrator; (d) voice coil transducer.

54
BASIC BOND GRAPH ELEMENTS
the model does contain gyrators. For a restricted range of spin speeds and forces,
the gyroscope is approximately a gyrator and gives the gyrator its name.
Figure 3.9d shows a useful transducer, which is a gyrator if certain nonideal
effects may be neglected. It is the voice coil used in electrodynamic loudspeakers,
vibration shakers, seismic mass accelerometers, and many other devices. The
voice coil and other similar electromechanical conversion devices are covered
thoroughly in Chapter 4. Here we simply specify its behavior as an example of
a gyrator transducer.
The constitutive laws of the device are
e = T V,
T i = F,
(3.12)
in which T plays the role of r in Eq. (3.11) and is the coupling constant for the
device. The units of T might be thought of as volts per feet per second from
one equation and pounds per ampere from the other equation. Thus, one might
be tempted to measure the two versions of T that have such different units
in two separate experiments. Actually, there is only a single T for a gyrator
when power is measured in consistent units. The different units merely arise if
power is measured in volt-amperes (watts) on one side of the transducer and in
foot-pounds per second on the other.
Thus, one may measure T using one of the equations (3.12), invoke power
conservation using the conversion factor between W and ft-lb/s to deduce the T
in the other equation. The two values of T are numerically different only because
of the choice of units. The recognition that the device is power conserving and
representable as a gyrator helps one avoid the mistake of using two approximate
numerical values for the two Ts in Eq. (3.12). Unless the two values of T are
exactly correct, the model will inappropriately create or dissipate power.
An important advantage of the SI system (International System of Units) is
that the numerical values of T in the two parts of Eq. (3.12) are identical because
power in all physical domains is measured in watts. We recommend that the SI
system always be used in order to avoid any unit inconsistencies, especially when
multiple energy domains are being modeled. Practically, the SI system avoids
the troublesome necessity of making unit conversions when power in different
domains is involved.
The gyrator always seems to be a more mysterious element than the trans-
former. Before the signiﬁcance of the gyrator was recognized, it was common to
make equivalent electrical network diagrams for electromechanical or electrohy-
draulic systems using only transformers. This is not possible, in general, but in
many special cases one may apply the analogy between electrical and mechanical
or hydraulic variables so that a gyrator is treated as a transformer. In bond graph
terms, the voice coil is a transformer if, for example, we call current an effort
and voltage a ﬂow. This switching of the identiﬁcation of effort–ﬂow variables is
entirely unnecessary if one only recognizes that gyrators are really necessary in
order to model systems containing devices such as those shown in Figures 3.9b
and c, in general.

BASIC 2-PORT ELEMENTS
55
In fact, a gyrator is a more fundamental element than a transformer. Two
gyrators cascaded are equivalent to a transformer:
e1
⇀
f1
GY1
e2
⇀
f2
GY2
e3
⇀
f3
=
e1
⇀
f1
TF3
e3
⇀
f3
e1 = r1f2,
r2f2 = e3 →e1 = (r1/r2)e3,
r1f1 = e2,
e2 = r2f3 →(r1/r2)f1 = f3.
In contrast, cascaded transformers are equivalent only to another transformer
e1
⇀
f1
TF1
e2
⇀
f2
TF2
e3
⇀
f3
=
e1
⇀
f1
TF3
e3
⇀
f3
e1 = m1e2,
e2 = m2e3 ⇀e1 = m1m2e3,
m1f1 = f2,
m2f2 = f3 ⇀m1m2f1 = f3.
Thus, one could, in principle, consider every transformer as a cascade combi-
nation of two gyrators and dispense with ⇀TF ⇀as a basic 2-port. It is more
convenient, however, to retain ⇀TF ⇀as a basic bond graph element.
It is also important to realize that the gyrator essentially interchanges the roles
of effort and ﬂow. This may be seen by replacing r in Eq. (3.11) with unity.
Then the effort at one port of the ⇀GY ⇀is just the ﬂow at the other, and
vice versa. Thus, the combination ⇀GY ⇀I is equivalent to ⇀C. To see this,
recall that ⇀I relates f to the integral of e, or p. After the gyrator is added and
the roles of e and f are interchanged, the combination relates e and the integral
of f or q at the external port. The element relating e to q is ⇀C. Similarly,
⇀GY ⇀C is equivalent to ⇀I. Thus, one could in principle dispense with
either ⇀C or ⇀I as a basic 1-port as long as ⇀GY ⇀was available. Again,
it is more convenient and natural to retain both ⇀C and ⇀I as basic 1-ports.
As an example of a deduction about a system based purely on its bond graph
representation, consider the equivalence I1 ⇀GY ⇀I2 = I1 ⇀C, in which
⇀GY ⇀I2 has been replaced by ⇀C. An ⇀I bonded to a ⇀C is an oscil-
lator. In physical terms, it could be a mass–spring or inductor–capacitor system.
Thus, we see that I1 ⇀GY ⇀I2 (or, for that matter, C1 ⇀GY ⇀C2) will act
just like an inertia–capacitor system.
Finally, there is a generalization of the transformers and gyrators discussed
above, based on the curious fact that in both Eqs. (3.9) and (3.11) the power
conservation between the two ports is maintained even when the moduli m and r
are not constant. This gives rise to the modulated transformer and the modulated
gyrator, denoted in bond graph symbolism by
↓m
e1
⇀
f1
MT F
e2
⇀
f2
and
↓r
e1
⇀
f1
MGY
e2
⇀
f2
.
Note that m and r are shown as signals on an activated bond. This means that
no power is associated with the changes in m and r, and e1 f 1 is always exactly
equal to e2 f 2, as in the case of the constant modulus, ⇀TF ⇀and ⇀GY ⇀.

56
BASIC BOND GRAPH ELEMENTS
Many physical devices may be modeled by the modulated 2-ports. For
example, the electrical autotransformer contains a mechanical wiper, which,
when moved, alters the turns ratio between the primary and secondary coils and
thus changes the transformer ratio. This alteration takes no power (if we can
assume mechanical friction is negligible), and for any wiper position the device
essentially conserves electrical power.
Both gyrators in Figure 3.9c and d have moduli that can be changed without
changing the fact that power is conserved at the two ports. For the gyroscope,
a motor can be made to change the spin speed of the rotor, which changes r.
Similarly, for the voice coil, if an electromagnet is substituted for a permanent
magnet, then the transduction coefﬁcient T in Eqs. (3.12) may be varied. At
every instant, the power is conserved at the two ports, but the characteristics of
the device change.
In mechanics, the MTF is particularly important and may be used to represent
geometric transformations or kinematic linkages. As a simple example, consider
the rotating arm shown in Figure 3.10. The arm is in equilibrium under the action
of the torque τ and force F, and it provides a relation between θ and y or ˙θ ≡ω
and ˙y ≡Vy. Writing the displacement relation ﬁrst,
y = l sin θ,
(3.13)
we can differentiate this to yield a constitutive relation for velocities,
˙y = (l cos θ) ˙θ
or
Vy = (l cos θ)ω.
(3.14)
The equilibrium relation between τ and F is
(l cos θ)F = τ.
(3.15)
The occurrence of l cos θ in both Eqs. (3.14) and (3.15) might appear to be
coincidental until we remember that the device must conserve power. Equations
(3.14) and (3.15) are embodied in the bond graph of Figure 3.10b. The MTF
is called a displacement-modulated transformer because the modulus m is a
function of the displacement variable, θ. Such transformers allow one to create
a bond graph for the extremely complex dynamic systems associated with three-
dimensional rigid-body motion.
Although some useful 2-port components have been deﬁned, still only very
simple bond graphs can be assembled from 2-ports and 1-ports. Only chains of
2-ports with 1-ports at the ends can be made. To create the complex models
necessary in engineering system dynamics, it turns out that 3-ports are required.
But surprisingly, only two basic 3-ports are required to model a very rich variety
of systems.

THE 3-PORT JUNCTION ELEMENTS
57
FIGURE 3.10. A displacement-modulated transformer: (a) sketch of rigid, massless rotat-
ing arm; (b) bond graph.*
3.3
THE 3-PORT JUNCTION ELEMENTS
Imagine that you are surrounded with electrical components such as resistors,
capacitors, inductors, motors, and so forth, mechanical components such as
springs, shock absorbers, ﬂywheels, and the like, and hydraulic components such
as pipes, tees, accumulators, and so on. Further imagine that you are to connect
these components any way you desire. You might imagine that there are hun-
dreds of ways these diverse components could be connected. In fact, any
possible connection of components can be realized using only two different
connection patterns, and this brings us to the 3-port junction elements that allow
elements in all energy domains to be assembled into overall system models.
∗If one wishes to follow the convention of Figure 3.8 and Eq. (3.9), one might wish to indicate
the modulus as the inverse of l cos θ. Equations (3.14) and (3.15) show unambiguously how the
modulus l cos θ is to be used.

58
BASIC BOND GRAPH ELEMENTS
We now introduce these two connection patterns as 3-port components them-
selves, which, like the 2-ports of the previous section, are power conserving.
These 3-ports are called junctions, since they serve to interconnect other multi-
ports into subsystem or system models. These 3-ports represent one of the most
fundamental ideas behind the bond graph formalism. The idea is to represent
in multiport form the two types of connections, which, in electrical terms, are
called the series and parallel connections. As we shall see, such connections
really occur in all types of systems, even though traditional treatments may not
recognize the existence of the junctions as multiports.
First, consider the ﬂow junction, 0-junction, or common effort junction. The
symbol for this junction is a zero with three bonds emanating from it (as will
become evident, it is easy to extend the deﬁnition to a 4-, 5-, or more-port version
of this 3-port element):
—
— 0 —,
—
2
—
1 0 —
3 ,
2
⇀
⇀
⇀
1 0
3 .
This element is ideal in that power is neither dissipated nor stored. Using
the inward power sign convention shown in the last version of the junction, this
implies
e1f1 + e2f2 + e3f3 = 0.
(3.16)
The 0-junction is deﬁned such that all efforts are the same, thus,
e1(t) = e2(t) = e3(t).
(3.17)
Combining (3.16) and (3.17) yields
f1(t) + f2(t) + f3(t) = 0.
(3.18)
In words, the efforts on all bonds of a 0-junction are always identical, and the
algebraic sum of the ﬂows always vanishes. In other words, if power is ﬂowing
in on two ports of the three, then it must be ﬂowing out of the third port.
The use of the 0-junction is suggested by Figure 3.11a. The most obvious
examples of 0-junctions are the electrical conductors connected as shown to
provide three terminal pairs and the pipe tee junction, which is an idealized
version of the hardware store variety. The mechanical example may seem obscure,
and it is contrived. Mechanical 0-junctions are just as necessary as electrical or
hydraulic ones, but they do not appear so readily in gadget form. The two carts in
the mechanical example of Figure 3.11a are supposed to be rigid and massless.
Note that V3 = −V1 −V2, which conforms with Eq. (3.18). If F is the force
across the gap, X 3, then F is the port effort for V 1, V 2, and V 3, in accordance
with Eq. (3.17). Such a force would, in fact, exist if F were due to a massless
spring or damper connected between the two carts.

THE 3-PORT JUNCTION ELEMENTS
59
FIGURE 3.11. Basic 3-ports in various physical domains: (a) 0-junction; (b) 1-junction.
It is important to note that power conservation Eq. (3.16) and ﬂow variable
summation Eq. (3.18) change if not all the power half-arrows point inward as
in the example above. Suppose that bond 3 had a half-arrow pointing outward
instead of inward as is the case for bonds 1 and 2. Then a minus sign would
appear in the power conservation equation and the ﬂow summation, thus:
e1f1 + e2f2 −e3f3 = 0.
(3.16a)
f1(t) + f2(t) −f3(t) = 0.
(3.18a)
This is why we stress that for a 0-junction, the ﬂows add algebraically to
zero. Depending on the orientation of the sign-convention half-arrows on the
bonds, minus signs or plus signs will appear in the equations of the junction.
One simple way to decide on the proper signs in equations such as Eq. (3.18) or
Eq. (3.18a) is to use a plus sign for all bonds with inward-pointing half-arrows
and a minus sign for bonds with outward-pointing half-arrows. Note however,
that the half-arrow directions have no effect on the strict equality of the efforts
on all bonds of a 0-junction.

60
BASIC BOND GRAPH ELEMENTS
Before considering more examples in which the 0-junction is used, consider
the dual of the 0-junction, that is, a multiport element in which the roles of effort
and ﬂow are interchanged. Such an element is an effort junction, a 1-junction, or
a common ﬂow junction. The symbol for this multiport is a 1 with three bonds:
—
— 1 —,
—
2
—
1 1 —
3 ,
e2
f2
e1
f1
1
e3
f3
This element is again power conserving according to Eq. (3.16) if all half-
arrows point inward; however, this time the element is deﬁned such that every
bond has the identical ﬂow, thus,
f1(t) = f2(t) = f3(t),
(3.19)
which, when combined with the power conserving idealization, requires
e1(t) + e2(t) + e3(t) = 0.
(3.20)
As with the 0-junction, the constitutive equations for the 1-junction, Eqs.(3.19
and 3.20), combine to ensure power conservation in the form of Eq. (3.16) as
long as all bonds have an inward sign convention.
If a 1-junction should have an inward sign convention on bonds 2 and 3 but an
outward sign convention on bond 3, the power conservation would be expressed
as in Eq. (3.16a) and the effort summation of Eq. (3.20) would change to
e1(t) + e2(t) −e3(t) = 0.
(3.20a)
The equality of the 1-junction ﬂows, Eq. (3.19), is not affected by the power
sign conventions on the bonds.
The 1-junction has a single ﬂow, and the algebraic sum of the effort variables
on the bonds vanishes. Figure 3.11b shows some instances in which a 1-junction
can be used to model physical situations. Both the electrical conductors and the
hydraulic passages are arranged so that if 1-port components were attached to
the ports, one could describe the resulting connection as a series connection. A
single current or volume ﬂow would circulate, and the voltages and pressures at
the ports would sum algebraically to zero. In the mechanical example, the three
forces are all associated with a common velocity, and the forces must sum to
zero, since the cart is assumed to be massless.
An understanding of the meaning of the 0- and 1-junctions is important for
anyone learning bond graph techniques, and it may be helpful to give some
physical interpretation for these multiports in several physical domains.

THE 3-PORT JUNCTION ELEMENTS
61
Electrical
circuits:
—
— 0 —,
represents Kirchhoff’s current law for a node
where three conductors join
—
— 1 —,
represents Kirchhoff’s voltage law written along
a loop in which a current ﬂows and experiences
three voltage drops
Mechanical
systems:
—
— 0 —,
represents geometric compatibility for a situation
involving a single force and three velocities that
algebraically sum to zero
—
— 1 —,
represents dynamic equilibrium of forces asso-
ciated with a single velocity—when an inertia
element is involved, the junction enforces New-
ton’s law for the mass element
Hydraulic
systems:
—
— 0 —,
represents the conservation of volume ﬂow rate
at a point where three pipes join
—
— 1 —,
represents the requirement that the sum of pres-
sure drops around a circuit involving a single ﬂow
must sum algebraically to zero
As might be expected, the existence of 0- and 1-junctions within complex
systems is not always obvious, but in succeeding chapters formal techniques for
modeling systems using these basic elements are presented.
To make clear the utility of the junctions, four elementary example systems are
displayed in Figure 3.12. Note that only two bond graphs are involved. The series
and parallel aspects of the junctions are more obvious in the electrical than in the
mechanical cases. The reader should study these examples to understand how the
sign conventions are transferred from the physical sketches to the bond graph.
Note that in Figure 3.12 the 1-ports have the sign-convention half-arrows as
they were presented in the tables at the beginning of this chapter, but the junction
signs are not all inward pointing. As we have noted, when the sign-convention
arrows are changed from the inward-pointing convention used to introduce the
3-ports, Eqs. (3.18) and (3.20) must be modiﬁed with a minus sign for each port
with an outward-pointing sign. Equations (3.17) and (3.19) remain invariant,
however, under changes in a sign convention. Remember, a 0-junction has only
a single effort and a 1-junction has only a single ﬂow, independent of the sign
convention. As an example, consider
e1
⇀
f1
e2↿f2
1
e3
⇀
f3
,
the equations of which are
f1 = f2 = f3,
e1 −e2 −e3 = 0.
(3.21)
The reader should verify that the systems and bond graphs are consistent by
writing equations such as (3.21).

62
BASIC BOND GRAPH ELEMENTS
FIGURE 3.12. Example systems involving basic 3-ports. (a) Systems using 0-junctions;
(b) systems using 1-junctions.
The slight generalization from 3-port junctions to 4- or n-port junctions is
worth emphasizing. In bond graph symbolism, two similar 3-ports may be com-
bined into a 4-port thus:
—
—
0 — 0
—
— = —
—
0
—
—
—
—
1 — 1
—
— = —
—
1
—
—.
An n-port 0- or 1-junction has a common effort or ﬂow on all bonds, and
the algebraic sum of the complementary power variables on the bonds vanishes.

CAUSALITY CONSIDERATIONS FOR THE BASIC ELEMENTS
63
Occasionally, 2-port junctions arise, and, in some cases, these are precisely equiv-
alent to a single bond. The following bond graph identities are always valid:
⇀0 ⇀=⇀,
⇀1 ⇀=⇀.
However, with some sign patterns, the 2-port 0- and 1-junctions serve to
reverse the sign deﬁnition of an effort or ﬂow. For example,
e1
⇀
f1
0
e2
↼
f2
implies
e1 = e2, f1 = −f2,
and
e1
⇀
f1
1
e2
↼
f2
implies
f1 = f2, e1 = −e2.
Such 2-ports are sometimes necessary when two multiports are to be joined
by a bond, but the two multiports have been deﬁned with signs that are not
compatible with a single bond. For example, in connecting a spring, —C, to a
mass, —I , one could deﬁne a common velocity but use a 2-port 1-junction to
express the fact that the spring force is the negative of the force on the mass.
The resulting bond graph would then be C ↼1 ⇀I, in which the two passive
1-ports have the appropriate inward sign convention. In this case, both bonds
have the same ﬂow but one effort is the negative of the other.
The constitutive relations for 0- and 1-junctions are summarized in Table 3.5.
3.4
CAUSALITY CONSIDERATIONS FOR THE BASIC ELEMENTS
The concept of causality was discussed in general terms in Section 2.4, and we
may now consider some more speciﬁc uses of the idea with respect to the basic
multiports. Some of the causal properties developed here will be applied in later
chapters. For now, we simply note that some of the basic multiports are heavily
constrained with respect to possible causalities, some are relatively indifferent
to causality, and some exhibit their constitutive laws in quite different forms for
different causalities.
TABLE 3.5. Summary of Basic 3-Ports
Flow junction, or 0-junction
e1
⇀
f1
0
e2↿f2
e3
↼
f3
e1 = e2 = e3,
f1 + f2 + f3 = 0
Effort junction, or 1-junction
e1
⇀
f1
1
e2↿f2
e3
↼
f3
f1 = f2 = f3,
e1 + e2 + e3 = 0

64
BASIC BOND GRAPH ELEMENTS
3.4.1
Causality for Basic 1-Ports
The effort and ﬂow sources are the most easily discussed from a causal point of
view, since, by deﬁnition, a source impresses either an effort or ﬂow time history
upon whatever system is connected to it. Thus, if we use the symbols S e— and
S f — for the abstract effort and ﬂow sources, the only permissible causalities for
these elements are
Se
and Sf
.
in which the causal stroke indicates the direction that the effort signal is oriented.
(Remember that a sign-convention half-arrow could be placed on either end of
the bond without affecting the causality.) The causal forms for effort and ﬂow
sources are summarized in the ﬁrst two rows of Table 3.6.
In contrast to the sources, the 1-port resistor is normally indifferent to the
causality imposed upon it. The two possibilities may be represented in equation
form as follows:
e = R(f ),
f = −1
R (e),
where we use the convention that the variable on the left of the equality sign
represents the output of the resistor (the dependent variable), and that appearing
in the function of the right side is the input (independent) variable for the element.
This convention is used commonly, but not universally, in writing equations and
corresponds to the notation used in computer programming.
The correspondences between the causally interpreted equations and the causal
strokes on the bond of the R— element are shown in the third row of Table 3.6.
As long as both the functions R and −1
R
exist and are known, either causal
version of them could be used in a system model. It is possible, however, that
the static relation between e and f shown in Figure 3.1 is multiple valued in one
direction or the other; that is, either R or −1
R
might be multiple valued. In
TABLE 3.6. Causal Forms for Basic 1-Ports
Element
Acausal Form
Causal Form
Causal Relation
Effort source
Se ⇀
S e
e(t) = E(t)
Flow source
Sf ⇀
Sf
f (t) = F(t)
Resistor
R ↼
R
e = R(f )
R
f = −1
R (e)
Capacitor
C ↼
C
e = −1
C
 t f dt

C
f = d
dt C(e)
Inertia
I ↼
I
f = −1
I
 t e dt

I
e = d
dt I(f )

CAUSALITY CONSIDERATIONS FOR THE BASIC ELEMENTS
65
such a case, the single-valued causality would be clearly preferable. In the linear
case, with a ﬁnite slope of the e–f characteristic, the 1-port resistor is indifferent
to the causality imposed upon it, although the resistance law would be written in
two forms:
e = Rf
or
f = (1/R)e = Ge.
The constitutive laws of the C— and I — elements are expressed as static
relations between e and q =
t
fdt and f and p =
t
edt, respectively. In express-
ing causal relations between e’s and f’s, we will ﬁnd that the choice of causality
has an important effect. Taking the capacitor, we may rewrite the relations from
Table 3.2 as follows:
e = −1
C
 t
f dt

, f = d
dt C(e),
(3.22)
in which causality is implied by the form of the equation. Note that when f is
the input to the C—, e is given by a static function of the time integral of f ,
but when e is the input, f is the time derivative of a static function of e. The
correspondences between these causal equations and the causal stroke notation
for the capacitance are shown in the fourth row of Table 3.6. The implications
of the two types of causality, which are called integral causality and derivative
causality, respectively, will be discussed in some detail in later chapters.
Since inertia is the dual∗of the capacitor, similar effects occur with the two
choices of causality. Rewriting the inertia element relations from Table 3.3, we
have
f = −1
I
 t
e dt

, e = d
dt I(f ).
(3.23)
In this case, integral causality exists when e is the input to the inertia, and
derivative causality exists when f is the input. These observations are summarized
in the ﬁfth row of Table 3.6. Equations (3.22) and (3.23) are written in a form
suitable for nonlinear C— and I — elements, but the distinction between integral
and derivative causality remains for the special case of linear elements with their
compliance and inertance parameters.
3.4.2
Causality for Basic 2-Ports
Proceeding now to the basic 2-ports, one might think initially that there would
be a total of four possibilities for the assignment of causality of a transformer,
namely, any combination of the two possible causalities for each of the two
ports. However, there are only two possible causality assignments, as the deﬁning
∗Dual elements have identical types of constitutive laws except that the roles of effort and ﬂow
are interchanged.

66
BASIC BOND GRAPH ELEMENTS
relations (3.9) and (3.11) show. As soon as one of the e’s or f ’s has been
assigned as an input to the —TF—, the other e or f is constrained to be an
output by Eq. (3.9). Thus, in fact, the only two possible choices for causality for
the transformer are
T F
and
T F
. The possible causalities are tabulated
in the ﬁrst row of Table 3.7. Again, causal equation equivalents to the causal
stroke notation are given for all elements in Table 3.7.
For the gyrator, Eqs. (3.11) show that as soon as the causality for one bond has
been determined, the causality for the other is also. Thus, the only permissible
causal choices for the —GY — are
GY
and
GY
. The choices for the
causality for the gyrator are summarized in the second row of Table 3.7.
3.4.3
Causality for Basic 3-Ports
The causal properties of 3-port 0- and 1-junctions are somewhat similar to those
of the basic 2-ports. Although each bond of the 3-ports, considered alone, could
have either of the two possible causalities assigned, not all combinations of bond
causalities are permitted by the constitutive relations of the element. For example,
the constitutive relations for the 0-junction given in Table 3.5 indicate that all
efforts on all the bonds are equal and the ﬂows must sum to zero. Thus, if on any
bond the effort is an input to a 0-junction, then all other efforts are determined,
and on all other bonds they must be outputs of the 0-junction. Conversely, if all
the ﬂows on all bonds except one are inputs to the 0-junction, the ﬂow on the
remaining bond is determined and must be an output of the junction. A typical
TABLE 3.7. Causal Forms for Basic 2-Ports and 3-Ports
Element
Acausal Graph
Causal Graph
Causal Relations
Transformer
e1 = me2
f2 = mf1
1 T F
2
1 T F
2
1 T F
2
f1 = f2/m
e2 = e1/m
Gyrator
1 GY
2
1 GY
2
e1 = rf2
e2 = rf1
1 GY
2
f1 = e2/r
f2 = e1/r
0-Junction
e2 = e1
1 0
3
2
1 0
3
2
e3 = e1
f1 = −(f2 + f3)
1-Junction
f 2 = f 1
1 1
3
2
1 1
3
2
f 3 = f 1
e1 = −(e2 + e3)

CAUSALITY AND BLOCK DIAGRAMS
67
permissible causality for a 0-junction is shown in the third row of Table 3.7.
Here the causal stroke on the end of bond 1 nearest the 0 indicates that e1 is
an input to the junction and that all other bonds must have causal strokes at the
end away from the 0. To interpret the diagram another way, the ﬂows on bonds
2 and 3 are inputs to the 0-junction. These considerations are also expressed by
the causal equations shown in Table 3.7. For a 3-port 0-junction, then, there are
only three different permissible causalities in which each of the three bonds in
succession plays the role assigned to bond 1 in the example shown in the table.
For an n-port 0-junction this description of the constraints on causality is still
valid, and there are exactly n different permissible causal assignments.
For a 1-junction the same considerations apply as for a 0-junction except that
the roles of the efforts and ﬂows are interchanged. Table 3.5 indicates that ﬂows
on all the bonds are equal and the efforts sum to zero. Thus, if the ﬂow on
any single bond is an input to the 1-junction, the ﬂows on all other bonds are
determined and must be considered outputs of the junction. Alternatively, when
the efforts on all bonds except one are inputs to the 1-junction, the effort on the
remaining bond is determined and must be an output of the junction. A typical
permissible causality is shown in the fourth row of Table 3.7. In this example,
bond 1 plays the special role of determining the common ﬂow at the junction,
and the remaining bonds supply effort inputs that sufﬁce to determine the effort
on bond 1. Clearly, there are three permissible causalities for a 3-port 1-junction,
and there are n permissible different causal assignments for an n-port 1-junction.
Although the causal considerations have been stated for all the basic multiports
deﬁned so far (summarized in Tables 3.6 and 3.7), it can hardly be clear as to
what all the implications of causality are. The study of causality is very important,
and bond graphs are uniquely suited to this study. However, only when some
real system models have been assembled is it clear why causal information is
so important. In the next chapter, system models are built up using the basic
multiports just discussed. Using the rules of causality, it is then possible to predict
many important features of these systems even before the constitutive laws for all
the elements have been decided upon. For instance, it will be possible to predict
the mathematical order of the system model before any equations are written and
before a decision has been made about whether the model should be linear or
nonlinear. In addition, causal considerations will prove invaluable in writing a set
of state equations or in setting up computational program for system simulation.
3.5
CAUSALITY AND BLOCK DIAGRAMS
Block diagrams indicate how input and output signals ﬂow in a system. The
blocks show how the signals are transformed, for example, by integration, differ-
entiation, multiplication by a constant or through some other functional relation-
ship. Block diagrams are inherently causal since they show how an input signal
is transformed into an output signal.

68
BASIC BOND GRAPH ELEMENTS
When causal strokes are added to a bond graph, one may represent the infor-
mation in the bond graph by a block diagram. For example, the block-diagram
versions of the causal forms for the R, C, and I 1-ports shown in Table 3.6 are
given in Figure 3.13. Similarly, block diagrams for 2-ports and 3-ports corre-
sponding to entries in Tables 3.7 are shown in Figures 3.14 and 3.15. It should
be possible for you to correlate the signal ﬂow paths in the block diagrams with
the equations in the tables and with the bond graph representation. Note that
when one rigorously maintains the spatial arrangements with efforts above and
to the left of bonds and ﬂows below and to the right, the block diagrams have
ﬁxed patterns.
It may also be seen that block diagrams are more complex graphically than
bond graphs because a single bond implies two signal ﬂows on a block diagram.
A single causal mark indicates the signal ﬂow directions on two (effort and ﬂow)
signals. Also, a single sign-convention half-arrow on a bond is replaced on the
equivalent block diagram by a plus or minus sign at summation points.
FIGURE 3.13. Block diagrams for 1-ports.

CAUSALITY AND BLOCK DIAGRAMS
69
FIGURE 3.14. Block diagrams for 2-ports.
FIGURE 3.15. Block diagrams for 3-ports.
Initially, block diagrams may be easier to understand than bond graphs because
they contain redundant information. For systems with some complexity, however,
block diagrams rapidly become so complicated that the conciseness of equiv-
alent bond graphs is an advantage. For example, Figure 3.16 shows a block
diagram equivalent to a bond graph model of the automotive drive train system
of Figure 2.7. Note that the sign-convention half-arrows have yet to be put on

70
BASIC BOND GRAPH ELEMENTS
FIGURE 3.16.
Interconnected drive train model. (a) Bond graph; (b) block diagram.
the bond graph, and the corresponding + and −signs do not appear in the block
diagram near the circles representing signal summation.
After procedures for constructing bond graph models and adding causal strokes
to them have been discussed in the following chapters, one option is to construct
a block diagram from the bond graph. There are computer programs that accept
block diagram models for the analysis and simulation of systems so there are
some reasons for converting a bond graph model of a system to a block diagram.
In the following chapters we will focus more on deriving state equations for
bond graph models but the ability to show a block diagram for a bond graph is
often useful in explaining the assumptions behind a model to those unfamiliar
with bond graph techniques. Also, particularly in the case of linearized system
models, block diagrams are commonly used in the design of control systems.
It is also true that a detailed block diagram for a complex system model may

PROBLEMS
71
become so complex as to be virtually useless in understanding the assumptions
that have been made.
REFERENCE
[1] S. H. Crandall, D. C. Karnopp, E. F. Kurtz, and D. C. Pridmore-
Brown, Dynamics of Mechanical and Electromechanical Systems, New York:
McGraw-Hill, 1968.
PROBLEMS
3-1. A nonlinear dashpot has as its constitutive relation the “absquare law,”
F = AV |V | ,
where F and V are the force and velocity across the dashpot and A is a
constant. Plot this relation in a sketch, and indicate the bond graph sign
convention implied if A > 0 and which causality the equation implies in
the form given. Try to invert the constitutive law to yield the velocity as
a function of the force.
3-2. A ﬂuid of mass density ρ is pumped into an open-topped tank of area A. If
P is the pressure at the tank bottom and Q the volume ﬂow rate, the tank
is approximately a —C for slow changes in the volume of ﬂuid stored. Is
the —C a linear element in this case, and, if so, what is the capacitance?
Hint: It is useful to compute the height of ﬂuid, h, as a function of the
total volume of ﬂuid as an intermediate step.

72
BASIC BOND GRAPH ELEMENTS
3-3. Reconsider Problem 3-2, but let the tank have sloping walls as shown.
What does this do to the constitutive law for the device?
3-4. Consider a uniform cantilever beam of length L, elastic modulus E, and
area moment of inertia I . If a force F is applied at the tip of the beam, it
will deﬂect. If the beam is supposed to be massless, decide what type of
1-port it is and compute its constitutive law.
3-5. Linear electrical inductors can be characterized by a law relating the volt-
age e to the rate of change of current:
Ldi
dt = e.
Convert this to a law relating the ﬂow i to the momentum λ, which in
this case is the time integral of e and is called the ﬂux linkage. Plot
a linear ﬂow–momentum constitutive law, and show on the plot where
the inductance L appears. Now sketch a nonlinear ﬂow–momentum law.
Convert the nonlinear law back to a relation between e and di/dt if this
is possible.
3-6. A rigid pipe ﬁlled with incompressible ﬂuid of mass density ρ has length
L and cross-sectional area A.

PROBLEMS
73
If P1 and P2 are the pressures at the ends of the pipe and the volume ﬂow
rate is Q2, convince yourself that the bond graph shown correctly repre-
sents the pipe in the absence of friction. Show that the correct constitutive
law relating pressure momentum and volume ﬂow is
pP2 =
 t
P2dt =

ρ L
A

Q2
by writing Newton’s law for the slug of ﬂuid in the pipe. (It should come
as a surprise that small-area tubes have a lot of inertia when P, Q variables
are used.)
3-7. An accumulator consists of a heavy piston in a cylinder. If the pressure is
determined primarily by the weight of the piston, sketch the constitutive
law for this 1-port device.
3-8. A ﬂywheel is a uniform disk of radius R and thickness t and is made
of a material of mass density ρ. Write the constitutive law for the 1-
port representing the ﬂywheel in its ﬂow–momentum form. Evaluate the
inertance parameter for a steel disk 1 in. in thickness and 10 in. in diameter.
3-9. Assume any needed dimensions for the hydraulic ram of Figure 3.8e, and
write the constitutive law for this 2-port.
3-10. Repeat Problem 3-9 for the devices of Figure 3.8b and c.
3-11. In Figure 3.9c assume that the rotor has moment of inertia J and spins
at a high angular rate . If the rotor is centered on an axle of length
L, relate F 1, V 1, F 2, V 2, and thus demonstrate that the device is indeed
approximately a —GY —.

74
BASIC BOND GRAPH ELEMENTS
3-12. Draw block diagrams for the following bond graphs, assuming all 1-ports
are linear:
3-13. Draw a block diagram for the oscillator using the bond graph shown.

PROBLEMS
75
3-14. Consider an ideal rack and pinion with no friction losses:
If the pinion has radius r and torque and speed τ and ω, and if the rack
has velocity V and force F, what type of element would represent the
device? Write the appropriate constitutive laws.
3-15. An electrodynamic loudspeaker is driven by a voice coil transducer
described by Eq. (3.12). Show that if only the mass of the speaker cone
is considered, then at the electrical terminals the device will act like a
capacitor. The bond graph identity
e⇀
i
T
˙G ˙Y
F⇀
V I =
e⇀
i C
is to be veriﬁed using the element constitutive equations directly.
3-16. An air spring is idealized as a piston in a cylinder with no leakage and no
heat transfer through the cylinder walls. The process the air undergoes is
assumed to be isentropic, such that
PV γ = P0V γ
0 ,
where V is the instantaneous volume,
V = V0 −Apx,
V 0 is the volume when x = 0, P0 is atmospheric pressure, γ is the ratio
of speciﬁc heats (≈1.4 for air), and P is the absolute cylinder pressure.
Derive the nonlinear constitutive relationship for F = F(x).

76
BASIC BOND GRAPH ELEMENTS
AP
x
F
Air
3-17. Three springs are used in a parallel conﬁguration as shown. Sketch the
constitutive behavior as seen from the F –v port. Show both compression
and tension.
F
k
k
v
x
k
δ1
δ2
3-18. Friction is always dissipative and is therefore a resistance in a bond graph
model. Its constitutive behavior is sketched in an ideal sense.
(a)
Discuss the only possible causality for this element.
(b)
Discuss the problem of using this device near ν = 0. Propose a
change to the constitutive behavior that will retain its fundamental
character but avoid the problem near ν = 0.
v
v
v
R
Ff
Ff
Ff

4
SYSTEM MODELS
Using the bond graph arsenal of R, C, I , S e, S f , 0, 1, TF, and GY it is possi-
ble to create bond graph mathematical models for a surprisingly wide variety of
physical systems. However, it is not true that every system you may encounter
can be modeled as a simple bond graph with the elements deﬁned so far. For
electrical circuits, certain classes of mechanical systems, hydraulic circuits, and
some transducer systems, the elements studied so far will be sufﬁcient. Chapters 7
through 12 present advanced techniques for an even broader class of systems.
From this chapter through Chapter 6, we purposely limit the systems to be con-
sidered in order to present the concepts of modeling, analysis, simulation, and
control without introducing undue complexity.
In this chapter we ﬁrst show how to represent any electrical circuit in bond
graph form by using a direct, simple modeling procedure. Then we use a similar
approach to problems involving mechanical translation. With slight extensions of
the procedure, the next class of problems we treat contains ﬁxed-axis rotation.
We next couple translation and rotation and introduce plane motion dynamics. By
generalizing our approach slightly, we are able to model hydraulic and acoustic
circuits effectively, since they are similar in several respects to systems already
treated.
All of the previously mentioned systems involve only a single type of power
within a single system. For that reason they are said to be single-energy-domain
systems. However, many devices involve two or more types of power. These must
have transducer elements such as motors, pumps, sensors and actuators coupling
subsystems in the different energy domains. Just imagine all the mechanical,
hydraulic, electrical, and thermal subsystems present in a modern automobile—a
device that illustrates the utility of the term mechatronic to indicate that a system
uses electronic computer control of subsystems in several energy domains.
77
System Dynamics: Modeling, Simulation, and Control of Mechatronic Systems, Fifth Edition
Dean C. Karnopp, Donald L. Margolis and Ronald C. Rosenberg
Copyright © 2012 John Wiley & Sons, Inc.

78
SYSTEM MODELS
Some basic transducer system models are introduced as the next topic. The
last section of this chapter is devoted to constructing bond graph models of multi-
energy-domain systems. We will combine electrical, hydraulic, and mechanical
devices to yield realistic overall physical systems that are ready for analysis and
simulation.
In succeeding chapters, you will learn how to derive differential equations
from a bond graph model, how to analyze certain types of equations, and how
complex nonlinear systems can be handled in a computer. In this chapter, how-
ever, we want to emphasize that bond graphs are themselves precise mathematical
models of systems that can be processed automatically by a computer program
and that can, in many cases, yield time histories of interesting variables almost
automatically, requiring only the speciﬁcation of parameters, initial conditions,
and forcing functions. A variety of computer programs are now available that
will process bond graphs and put the implied equations into a form suitable for
computational solution by a simulation program. The use of graphical displays of
the results allows one to understand the dynamic responses of the system model
and to optimize the system.
After studying the succeeding chapters, you will have an understanding of how
automated simulation programs work, as well as the mathematical difﬁculties that
may arise from some modeling decisions. For now, we wish only to emphasize
that after a bond graph model has been devised, in most cases it is easy and
convenient to perform computer experiments on the model and thus to size com-
ponents or to change the system conﬁguration if the predicted system behavior is
not satisfactory. Beyond this, the dynamic bond graph model will prove useful in
the design of control systems to improve the performance of the overall system.
4.1
ELECTRICAL SYSTEMS
We begin by observing that any electrical circuit can be modeled by a bond graph
containing elements of the set {0, 1, R, C, I, Se, Sf }. Notice that the elements TF
and GY are not included. That is because these elements are properly used in
representing electrical networks, a more general class than circuits. First we shall
model circuits; then we shall extend the procedure to include network elements.
4.1.1
Electrical Circuits
In Chapter 3, the electrical resistance, inductance, and capacitance were shown
to be bond graph —R, —I , and —C elements. It remains to determine how
to use the junction elements (0- and 1-junctions) to construct an overall bond
graph model of an electrical circuit. Sometimes, for simple circuits, it is easy
to recognize that some elements have the same current (ﬂow) and others have
the same voltage (effort). For these circuits, bond graph construction can be
accomplished by inspection. For example, Figure 4.1a shows a simple circuit with
positive voltage drops and current directions deﬁned and node voltages labeled.

ELECTRICAL SYSTEMS
79
a
a
b
c
c
c
+
+
+
+
−
−
−
−
C
L
R1
R2
iC
iL
iR1
iR2
(a)
(b)
0
1
I : L
R : R1
R : R2
C
C
iC
iR1
iL
iR2
:
FIGURE 4.1. A simple electric circuit. Example 1.
For convenience, some node voltages are repeated to emphasize their association
with speciﬁc elements. The circuit is grounded at the bottom, meaning that the
voltage labeled c is considered to be zero, vc = 0.
To arrive at the bond graph in part b, we argue as follows: The elements C
and R1 have the same voltage (va −vc = va −0 = va) and thus are attached to
the same 0-junction (common effort junction); the elements L and R2 have the
same current (iL = iR2), so they are attached to the same 1-junction (common
ﬂow junction). The bond joining the 0- and 1-junctions enforces the fact that
the current through the inductor is the sum of the currents through the capacitor
and the resistor, R1 (actually, with the sign convention shown in Figure 4.1a,
iL = −iC −iR1). Notice that all the 1-port R, C, and I elements have the power
half-arrows deﬁned such that whenever the voltage drop across the element is in
the direction deﬁned as positive in Figure 4.1a, and the current is simultaneously
in the deﬁned positive direction, the power is ﬂowing into the element. We always
deﬁne positive power directions for R, C, and I such that this is true by pointing
the half-arrows toward the elements.
Most of the time, electric circuits are too complex to model by inspection.
There may be some parts that are obviously in series or parallel (common current
or common voltage), but constructing the overall bond graph model is much easier
if a procedure can be followed that ensures success regardless of the complexity
of the circuit. Here we present a foolproof circuit construction procedure and
develop the procedure along with an example shown in Figure 4.2. This is a
voltage-excited circuit, grounded at the bottom, and open circuited at the right
side, exposing an output voltage, eout.

80
SYSTEM MODELS
Circuit Construction Procedure
1. Assign a power convention to the circuit schematic diagram.
This step must always be done regardless of the modeling procedure being
used. On the circuit, this is done by showing the positive voltage drop
and current directions. For the —I , —R, and —C elements, the positive
voltage drop (+ to −) is shown in the same direction as the positive current.
R2
L1
a
b
c
ie
iC1
iC2
iR2
iL1
e
e(t)
+
+
+
−
−
−
+
C1 −
R1
+
−
+
−
C2
d
+
+
−
−
C 
iC3
L2
eout
iL2
(a)
0a
0b
0c
0e
0e
0e
0e
0d
(b)
(c)
0
0
0
0
0
0
0
0
eb
ea
ec
ed
ee
1
I
R
C
Se
:
e(t)
1
R1
1
C1
1
1
C
C2
L1
1
R
R2
1
1
C C3
I
L2
1
Sf
0
eout
ee
ee
ee
:
:
:
:
:
:
:
:
FIGURE 4.2. A complicated electric circuit. Example 2.

ELECTRICAL SYSTEMS
81
0
0
0
0
ea
eb
ec
ed
1
I
R
C
Se
e(t)
1
R1
1
C1
1
1
C
C2
L1
1
R
R2
1
1
C C3
I L2
1
Sf
0
eout
:
:
:
:
:
:
:
:
:
(d)
0
0
0
eb
ec
ed
I
R
C
Se
e(t)
1
R1
C1
1
C
C2
L1
1
R
R2
C
C3
I L2
Sf
0
eout
0
:
:
:
:
:
:
:
:
:
(e)
FIGURE 4.2. (Continued)
This ensures that when the power is positive, power is ﬂowing toward the
passive 1-ports.
For the source elements (S f for current source and S e for voltage
source), it is not automatic which directions should be chosen for positive
voltage drop and positive current (and eventually which end of the bond
should have the half-arrow). If positive current is deﬁned such that the cur-
rent moves “uphill” against the positive voltage as is done in Figure 4.2a,
then if the current is positive, power will come from the source into the rest
of the circuit. If either the positive voltage direction or current direction is
chosen in the opposite direction, then positive power will ﬂow toward the
source and negative power will ﬂow away from the source. There is abso-
lutely nothing wrong with this, and, in fact, real time-varying sources may
sometimes absorb power from the attached system and sometimes supply
power to the attached system.
2. Label each node voltage on the circuit schematic diagram and use a
0-junction to represent each node voltage as shown in Figure 4.2b.
Node voltages are all the independent voltages that exist at points in the
circuit, including the ground node voltage that later will be set to zero. The

82
SYSTEM MODELS
node voltages in Figure 4.2b appear above and below or to the left and
right of each circuit element. In the ﬁgure, the node voltages are labeled
using letters. For convenience, the ground voltage, e, is repeated several
times. Remember, every bond that touches a particular 0-junction has the
voltage associated with that junction.
3. Establish the positive voltage drops across the circuit elements using
1-junctions.
Remember that 1-junctions add efforts (voltages) algebraically accord-
ing to the power convention represented by the half-arrows. By properly
directing the half-arrows on 1-junctions, the voltage drop can be established
across each bond graph element. See the discussion about signs on 0- and 1-
junctions in Section 3.3 and particularly the example leading to Eq. (3.21).
(This step will require practice to accomplish rapidly with conﬁdence but
this is a worthwhile endeavor.)
In every case the sign half-arrows ﬂow through the 1-junctions, indicat-
ing that the circuit elements react to node voltage differences, never node
voltage sums. Which way the arrows ﬂow through the 1-junctions depends
on the sign of the voltage difference established in step 1.
Figure 4.2c shows this construction. For example, for the —R element
representing the resistor, R1, the effort on the bond attached to the R is ea
−eb, which corresponds to the positive voltage drop deﬁned in the circuit
schematic.
Notice that positive power ﬂows out of the voltage source element and
the voltage on the source bond is ea −ee, as was deﬁned in the schematic.
Also, the output voltage, eout, is exposed using a ﬂow source, S f , of zero
current. (The idea of an open circuit is that no current ﬂows even if there
is a voltage across the terminals.) The voltage drop across this ﬂow source
is eout = ec −ee. The reader should check the other elements and ensure
that all have their deﬁned positive voltages.
4. Chose a ground or reference node and remove all bonds that have zero
power.
Before the bond graph can be used for equation derivation or simulation,
the reference or ground node must be established. (The reference node is
the point at which we would put the black probe of a voltmeter if we
were measuring voltages in the circuit. In other words it is the voltage we
assume to be zero when we measure other voltages.)
The reference in Figure 4.2 has been chosen to be ee, which we now
set to zero. Since every bond that touches a 0-junction has the identical
voltage, all the bonds inside the dotted line in Figure 4.2c have zero voltage
and therefore each of those bonds carries no power. We can either append
an effort source of zero voltage to one of the 0-junctions representing ee,
or we can simply erase all the bonds that carry no power, with the result
shown in Figure 4.2d.

ELECTRICAL SYSTEMS
83
5. Simplify the bond graph by using the bond graph identities deﬁned in
Chapter 3.
This is not an absolutely necessary step but it is generally useful. By
removing any 2-port 0- and 1-junctions that happen to have a through power
convention, a much neater picture emerges, as shown in Figure 4.2e. (These
identities were discussed in Section 3.3.)
Also, the loop structure from eb to ec has been reduced using another
type of bond graph identity. Noticing that L1 and C 2 actually have the
same voltage drop, we establish the voltage drop eb −ec once using a
1-junction, and then establish a 0-junction having this voltage difference.
Finally, the —I and —C elements associated with L1 and C 2 are attached
to this 0-junction, yielding the bond graph of Figure 4.2e.
For equation derivation or automated simulation as described in Chapter
5, it is not necessary to reduce the bond graph to its simplest form, but it
does make the ﬁnal bond graph easier to use and understand.
Note that the ﬂow source introduced to expose the output voltage, eout,
may also be erased since there is no power associated with the source bond.
It is left in Figure 4.2e as a convenience to remind us that we are interested
in that particular output voltage. Later we will see that any effort or ﬂow
on any bond can be simply established as an output, and we will not have
to construct an artiﬁcial means to expose desired outputs.
The trick to creating arbitrary circuit connections exclusively out of series
and parallel connections (or 0- and 1-junctions in bond graph terms) lies in ﬁrst
representing every node voltage, including what will be the ground or reference
voltage, by establishing a set of 0-junctions. Only after representing voltage
differences using 1-junctions for each circuit element in step 3, do we set the
ground voltage to zero.
This means that different bond graphs will result for a given circuit if we
chose different ground nodes. This corresponds to the fact that if different points
in a real circuit are used as a reference point for voltage measurements, the mea-
sured voltages will have different values. The different bond graphs will correctly
predict the voltages with respect to the different choices for the ground node.
As a ﬁnal example of circuit modeling using the procedure just presented,
consider the Wheatstone bridge shown in Figure 4.3a. This circuit is typically
used with strain gages as the resistive elements R1 through R4, and the voltage
across the load resistance, RL, is the output that is indicative of any change in the
bridge resistances. We are simply going to model this circuit as an exercise in
using the bond graph circuit construction procedure. In Figure 4.3a, the positive
voltage drop and current directions are shown along with labels for the node
voltages. This is step 1 of the procedure.
Step 2 of the procedure is done in Figure 4.3b, where the node voltages are
represented by 0-junctions. Step 3 is shown in Figure 4.3c, where 1-junctions
are used to appropriately add voltages such that the proper positive voltage drops
are across each element. Also shown in c is the dotted line surrounding all the

84
SYSTEM MODELS
0
0
0
ea
ed
eb0
ec
e(t)
R1
R3
R2
R4
RL
+
+
+
+
−
−
−
−
−
a
b
c
d
ie
iR1
iR2
iR3
iR4
i L
+
0
0
0
0
ea
ed
eb
ec
1
R
Se
1
1
1
1
1
R
R
R
R
R1
R3
R4
R2
RL
e(t)
:
:
:
:
:
:
0
0
ea
eb
ec
1
R
Se
1
1
R
R
R
R
R1
R3
R4
R2
RL
e(t)
0
:
:
:
:
:
:
(a)
(b)
(c)
(d)
FIGURE 4.3. A Wheatstone bridge circuit. Example 3.
bonds at the ground voltage, ed = 0. Steps 4 and 5 are done in Figure 4.3d. The
bonds with no power are erased, and the bond graph simpliﬁcations have been
done, where all 2-port 1-junctions with a “through” power convention have been
reduced to single bonds.
The resulting ﬁnal bond graph reveals a beautiful structural symmetry quite
similar to that of the bond diagram for the hydrocarbon molecule called the
“benzene ring.” It was this similarity to chemical bond diagrams that prompted
the “bond graph” name of our modeling approach. The idea is that physical
systems consist of components or elements bonded together by power interactions
much as atoms are bonded together in chemistry.
4.1.2
Electrical Networks
An electrical network is an extension of electrical circuits to include idealized
transformers and gyrators (see Reference [3]). An electrical transformer is a
common electromagnetic device used to step voltages up or down while doing the

ELECTRICAL SYSTEMS
85
opposite to the current. Electrical gyrators are exhibited in Hall effect transducers
(see Reference [1]), where voltage across a semiconductor material is related to
a current through the material perpendicular to the voltage drop direction. The
basic rules for bond graph construction remain unchanged.
Figure 4.4a shows the electrical symbol for a transformer, where N indicates
the turns ratio across the device. Positive voltage drops and current directions
are chosen such that positive power is into the device on the left side and out of
the device on the right side.
Since ideal transformers and gryrators are power-conserving elements, it is
logical to always deﬁne positive power such that it ﬂows in on one side and
out on the other. In Figure 4.4b, 1-junctions are used to establish the positive
voltage drops across the input and output sides of the transformer. Notice that
on the input side the voltage is ea −eb and on the output side the voltage on the
transformer output bond is ec −ed. These voltages are as deﬁned in the schematic
of Figure 4.4a. (It may require some thought to see that the sign-convention half-
arrows on the two 1-junctions correctly imply the deﬁned voltage differences at
the two transformer bonds.)
Although the 2-port transformers and gyrators seem to involve four voltages,
one at each terminal, they really relate only the voltage differences at the two
ports. This means that we may have to choose two reference voltages on the two
sides of the transformer. It is not necessary to have any direct metallic connection
between the windings of a transformer so such an isolating transformer can be
used to decouple the voltages in one part of a network from another part. If
the two ground nodes are selected at the two sides of the transformer as in
Figure 4.4b, then the transformer appears as in Figure 4.4c.
+
+
−
−
a
b
c
d
ia
ic
0
0
0
0
1
1
TF
ea
eb
ec
ed
N
TF
N
ea
ec
ia
ic
ea
Nec
Nia = ic
=
:
:
(a)
(b)
(c)
FIGURE 4.4. The ideal electrical transformer and its bond graph representation.

86
SYSTEM MODELS
In some networks, each side of a transformer is connected to a common
ground. If this is the case, eb = ed = 0. Then their associated bonds can be erased,
some reductions can be performed, and the typical appearance of a transformer
emerges as shown in Figure 4.4c.
An electrical network with an isolating transformer is shown in Figure 4.5a.
Positive voltage drops and current directions are shown in this ﬁgure. Notice
R3
R2
L1
1
C
2
C
a
b
d
c
f
ie
iR1
iC1
iC2
iR2
iL1
e
R1
e(t)
+
−
+
+
+
+
+
+
+
+
+
+
+
−
−
−
−
−
−
−
−
−
−
I(t)
g
h
j
R4
C3
iR3
−
iC3
Ii
iR4
iL
R
i
Transformer of
turns N
(a)
0
0
0
0
0
0
0
0
0
ea
eb
ec
ed
ef
eg
ee
ej
eh
(b)
0
0
0
0
0
0
0
0
0
ea
eb
c
e
ed
ef
eg
ee
ej
eh
1
R:R1
Se
Sf
TF
1
1
R:R2
1
R3:R
1
C1:C
1
L1:I
1
e(t)
1
1
2
C
C
1
C3:C
1
R4:R
1
I(t)
N
:
:
:
:
(c)
FIGURE 4.5. An electrical network with an isolating transformer.

ELECTRICAL SYSTEMS
87
0
0
0
0
eb
ec
ed
eg
1
R:R1
C:C1
Se
Sf
TF
1
1
R:R2
1
R3:R
1
L1:I
e(t)
I(t)
1
2
C
C
C:C3
R
4
R
N
:
:
:
:
:
(d)
FIGURE 4.5. (Continued)
that positive power ﬂows in on the left side of the transformer and out on
the right side and that two ground nodes are speciﬁed for the two parts of the
network coupled only by the transformer. Following the bond graph construction
procedure of the previous section, Figure 4.5b uses 0-junctions to expose the
node voltages labeled in part a, and Figure 4.5c uses 1-junctions to establish
the proper voltage drops across all the elements. Also in part c are dotted lines
enclosing all the bonds with zero power. These are erased in Figure 4.5d, and
bond graph simpliﬁcations have been performed to yield the ﬁnal result.
A ﬁnal example of the using the construction procedure is the network shown
in Figure 4.6a. Most of the network is composed of circuit elements that must be
looking pretty routine by now, but the new component is the voltage-modulated
current source, or “controlled current source,” labeled I (t) in the ﬁgure. The
meaning of this schematic symbol is that the voltage, e, from the left side of the
circuit modulates, with virtually no power, the current source that is an input to
the right side of the circuit.
Active bonds were introduced in Section 2.4 and here an active bond is used
to model a device such as a transistor in which a voltage on one terminal has a
major effect on the current ﬂowing out of another terminal. Almost no current is
associated with the controlling voltage. Of course, this model is valid only for
a limited range of voltages and currents, but the point is that, in the model, the
voltage signal has zero current associated with it. Thus, the active bond with a
full arrow resembles a signal in a block diagram without the back effect normal
power bonds have.
Positive voltage and current directions are shown in the schematic diagram
of Figure 4.6a. The labeled node voltages are shown using 0-junctions in
Figure 4.6b, and 1-junctions are used in Figure 4.6c to establish voltage drops
across the elements. Of particular interest is the establishment of the modulating
voltage, e, and the use of the modulated ﬂow source, S f , for the current source
generating I (t).
Note that the 2-port 0-junction on which the voltage e appears has both an active
bond and a normal bond. However, since the active bond implies zero current, the

88
SYSTEM MODELS
e(t)
R3
R2
L1
L2
1
C
C2 I(t)
a
b
d
c
f
+
+
+
+
+
+
+
+
−
−
−
−
−
−
−
−
−
+
ie
iR1
iC1
iC2
iR2
iR3 
iL1
iL2
e
R1
(a)
0
0
0
0
0
0
0
0
0
ea
ea
eb
eb
ec
ec
ed
ed
ee
ee
ef
ef
ef
ef
ef
ef
ef
ef
(b)
0
0
0
0
0
0
0
0
0
1
I
C
Se
fS
1
1
1
1
1
1
1
1
1
C
R
C1
C2
I(t)
e
2
L
e(t)
e(t)
R3
I:L1
:
:
:
:
:
(c)
0
0
0
1
I
R:R1
e
S
f
S
1
1
I:L1
R:R2
C1:C
C2:C
I(t)
L2
R3:R
:
:
:
(d)
R:R1
R:R2
FIGURE 4.6. An electrical network with a controlled source.
normal bond also has zero current. (On any 2-port 0-junction the sum of the currents
adds to zero—so if one current is zero, so is the other.) This normal bond is attached
to a 1-junction, which also then has zero current on all of its bonds.
Altogether, the bond graph elements imply that the active bond is an effort
signal (since it stems from a 0-junction) and that the effort is e = ec −ef (because
of the signs on the 1-junction bonds) and that the currents on all the local bonds
are zero (because of the active bond). The schematic diagram is intended to imply

ELECTRICAL SYSTEMS
89
all of this, but the bond graph makes these modeling assumption more explicit.
The rest of the network is processed in Figure 4.6c and d in the same fashion as
in the previous examples.
The zero ground voltage applies to the bonds enclosed by the dotted line, and
the zero power bonds have been erased and simpliﬁcations performed to yield
the ﬁnal result of Figure 4.6d.
The network construction method presented here will allow you to model the
most complicated electrical networks once you have acquired facility with the
basic steps of node representation, element insertion, power deﬁnition, ground
deﬁnition, and graph simpliﬁcation. With practice you will begin to observe cer-
tain recurrent patterns, and your ability to do more by inspection will increase.
Many interesting discoveries await you as you explore systems containing struc-
tures like ladders, pi’s, and tees.
Speaking of ladders, let us make use of our ability to model the topology of
circuits by bond graph junction structures in order to examine the bond graph
form of a ladder network. An example of a resistive ladder circuit is given in
Figure 4.7a. We are not really concerned with the nature of the 1-ports (source and
resistances), but rather with their interconnection patterns (or circuit topology).
FIGURE 4.7. A ladder network example.

90
SYSTEM MODELS
The bond graph of part b may be found by inspection, using arguments like
“ . . . , R2 in parallel, R3 in series, R4 in parallel, . . . ” Or the formal construction
procedure may be used. To display the system structure without regard to what
is (or might be) connected to it, we use a bond graph like that of Figure 4.7c,
which is a direct representation of the ladder structure. So ladders are nothing
more than chains of alternating 3-port 0- and 1-junctions.
Next we shall use such a graph to explore the idea of dual topologies in
circuits. A pi network is shown in Figure 4.8a in resistive form. The pi gets
its name because of the Greek letter pi-like appearance of the schematic. The
structure is represented as parallel–series–parallel in part b by the bond graph.
Resistances 1, 2, and 3 would go on the corresponding bonds to complete the
model. In Figure 4.8c a tee network is shown, again in resistive form. The tee
gets its name from the T-like appearance of the schematic. The bond graph in
part d is a series–parallel–series type. We observe that part d can be obtained
from part b by switching the roles of 0 and 1, and part b can be obtained from
part d similarly. The formal idea behind the switching is that if the roles of
voltage and current are interchanged, a dual network results. In terms of bond
graph structure, this implies a switching of 0 and 1 elements. By this technique
the topological dual of a complex circuit may be obtained from its bond graph
in a very simple fashion.
The pi and tee structures are simpliﬁed versions of the ladder structure of
Figure 4.7. We will see later in the text that electrical transmission lines and
long hydraulic lines have models that can be represented by ladder structures
that represent a large number of short segments cascaded in the manner of ﬁnite
element representations. The pi and tee structures become truncations of the
ladder structure that allow for reasonable inclusion of some of the transmission
line dynamics without having the overall system become too large.
FIGURE 4.8. Truncations of the ladder structure—the pi and tee structures.

MECHANICAL SYSTEMS
91
4.2
MECHANICAL SYSTEMS
Mechanical systems are those composed of such components as masses, springs,
dampers, levers, ﬂywheels, gears, shafts, and so forth. When dynamic systems are
put together from these components, we must interconnect rotating and translating
inertial elements with axial and rotational springs and dampers, and we must
appropriately account for the kinematics of the systems. Bond graphs are well
suited for this task. In the next section we address the speciﬁcs of mechanical
translation; that is, we restrict our attention to mechanical systems moving in a
straight line. Then in Section 4.2.2 we focus on mechanical systems that rotate,
such as ﬂywheels connected by a torsionally ﬂexible shaft or a gear pair in a
transmission. Finally, in Section 4.2.3, we study the dynamics of plane motion
where inertial elements have both mass and rotational inertia and bodies can
rotate and translate simultaneously.
4.2.1
Mechanics of Translation
In the previous sections dealing with electrical systems, the construction proce-
dure started with identifying the important node voltages and representing them
with 0-junctions. Then 1-junctions were used to create appropriate voltage drops
across the elements. Finally, the reference voltage had to be identiﬁed and elim-
inated to yield the ﬁnal model.
For mechanical systems, the effort variable is the force and the ﬂow variable is
the absolute velocity (velocity with respect to inertial space). It has been found
from years of experience that constructing bond graph models for mechanical
systems is easier if a procedure is followed that is dual to the procedure for elec-
trical systems. For mechanical systems, we start by representing system velocities
using 1-junctions (common velocity, forces add) and then we create the appropri-
ate relative velocities across the springs and dampers using 0-junctions (common
force, velocities add). This is best illustrated with a simple example as shown
in Figure 4.9. The system consists of a mass, m, suspended in a gravity ﬁeld
from a spring with stiffness and damper with damping constant b, attached to an
inertial frame.
Just as with the electrical systems, a power convention must be established
using the schematic diagram. This is a necessary step regardless of the modeling
procedure being used. Figure 4.9a shows the assumed positive velocity direction
for the mass and that the spring and damper relative velocities are assumed to be
positive in extension rather than in compression. This is indicated by the symbol
+T (for tension) in Figure 4.9a.
Notice that the inertial reference is labeled as a velocity equal to zero. This
is our reference velocity. This 1-junction and all its bonds ultimately will be
erased, just as the ground 0-junction was eliminated in electrical systems. (In
later examples, it will be seen that as long as we always deﬁne mass velocities

92
SYSTEM MODELS
k
m
mg
v1
vref = 0
vref = 0
(a)
1
1
Se : mg
Sf : 0
I : m
v1
(b)
1
I : m
C
1/ k
R : b
Se : mg
v1
(d)
1
1
I : m
Se : mg
Sf : 0
v1
vref = 0
(c)
0
0
R : b
C
1/ k
+T
:
:
b
FIGURE 4.9. Mechanical translation. Example 1.
with respect to inertial space, we will not need to deﬁne an inertial velocity
1-junction to be subsequently be removed.)
In Figure 4.9b, a 1-junction is shown such that any bonds that are connected
to this junction will have the velocity v1, and a second 1-junction is shown such
that any bonds connected to it will have the reference velocity of zero. The
mass is a 1-port inertia that has the absolute velocity, v1, so the —I element is
attached to that 1-junction. The gravity force, mg, is modeled as an effort source
in the bond graph (any force that is a known input to a system, whether time
varying or constant, is modeled as an effort source in a bond graph). Since this
force is moving at the velocity v1, the effort source is attached to the 1-junction
representing this velocity. The power out convention on the effort source comes
from the fact that if the velocity is in the positive, downward direction and the
gravity force is acting downward, then positive power is coming from the source

MECHANICAL SYSTEMS
93
into the system. A ﬂow source equal to zero is attached to the reference 1-junction
to enforce that the velocity is zero.
The spring and damper in general react to the relative velocity across them.
The choice of how to properly add the velocity components at each end of these
elements is a topic that causes much student frustration. For this ﬁrst example,
we simply note that for the elements with forces positive in tension, with the
positive velocity directions indicated, the relative velocity across both the spring
and damper should be v1 −vref. That is, if vrel = v1 −vref is positive, then the
spring and the damper are extending. This is accomplished using 0-junctions with
the power convention indicated in Figure 4.9c.
The reader should verify that the velocities on the C-element and the
R-element bonds really do represent the rate of extension of these elements. If
this is so, when the forces are positive in tension, power will ﬂow toward the C-
and R-elements as indicated by their sign half-arrows. One should review the
velocity summations in Eqs. (3.18) and (3.18a) to check the sign conventions
used in Figure. 4.9c.
Finally, in Figure 4.9d, the bonds with zero power are removed and the ﬁnal
bond graph emerges after some bond graph reductions are used. It makes sense
that, since all the elements have the same velocity, they all end up on the same
1-junction. We will be able to do many mechanical system models by inspection
after we gain some experience.
To formalize the bond graph construction procedure for mechanical translation,
here are the steps to follow:
Construction Procedure for Mechanical Translation
1. On a schematic diagram of the physical system, use arrows and symbols
to indicate the positive direction of absolute velocity components.
These elements include all individual mass elements, all prescribed
input velocities, and the velocities of any other physical locations that
may prove useful in establishing useful relative velocities. State whether
force-generating elements, springs and dampers, are positive in tension or
compression using symbols such as +T or +C.
2. Use 1-junctions to represent each distinct velocity from step 1.
Label the 1-junction with the velocity symbol from the schematic dia-
gram. This will help to remind you which junction is associated with which
velocity component. You might use a 1-junction to represent the reference
of zero absolute velocity. This will later be eliminated, but it might be
helpful for establishing relative velocities.
3. Attach to each 1-junction any element that relates to the absolute veloc-
ity represented by the junction.
In general, mass elements are inertias associated with absolute veloci-
ties represented by some of the 1-junctions. Remember, positive power is
always directed into an —I , —R, or —C element.

94
SYSTEM MODELS
4. Use 0-junctions to establish proper relative velocities.
Use sign-convention half-arrows so that the connecting elements are pos-
itive in compression or tension as was assumed in the schematic diagram.
This involves the sign-convention rules discussed in Section 3.3.
5. Eliminate the bonds with zero velocity and reduce to the ﬁnal model.
As an example of the use of the construction procedure, consider the so-called
quarter-car model of Figure 4.10. This represents one corner of an automobile
(a)
1
1
1
vs
vus
vin
(b)
(c)
(d)
1
1
1
vs
vus
vin
I
Se
Sf : vin
I
e
S
us
m
s
m
msg
musg
:
:
:
:
0
C
1
1
1
sv
us
v
in
v
I : ms
Se
Sf : vin
I : mus
e
S
msg
musg
0
0
R : bs
C
1/ s
k
1/kt
:
:
:
:
msg
musg
vin
vus
vs
ms
mus
ks
kt
bs
+C
+C
FIGURE 4.10. Quarter-car model. Example 2.

MECHANICAL SYSTEMS
95
where ms is the sprung mass (one-quarter of the body mass); mus is the unsprung
mass, which includes the tire, wheel, and some part of the brakes and suspension;
ks, bs are the suspension spring and damper constants; and kt is the tire stiffness.
Quite some liberty has been taken in this model in representing the suspension
and tire as linear elements. The system is constrained to move only vertically,
and the velocity input, vin(t), at the base is representing the roadway unevenness
experienced as the vehicle moves forward. The vehicle is also under the inﬂuence
of gravity acting vertically downward.
Construction rule 1 is used in the schematic diagram of Figure 4.10a. The
distinct velocities are labeled with arrows indicating positive directions, and, as
indicated, the springs and dampers are all assumed positive in compression. In
Figure 4.10b, step 2 is performed, where 1-junctions are used to represent each
distinct velocity, and the junctions are labeled to remind us which velocity they
represent. In this case, all the velocities are inertial velocities and we have not
included a reference velocity as was done in the ﬁrst example.
Step 3 is accomplished in Figure 4.10c, where the inertial —I elements, with
inward power convention, are attached to the appropriate 1-junctions and labeled
to indicate which mass they represent. Notice that the velocity input is represented
by a ﬂow source, S f , attached to the 1-junction for vin. The power arrow is out
from the ﬂow source because if the tire spring is in compression (positive by
assumption) and the input velocity is up (positive by assumption), then power is
ﬂowing from the source into the system.
The weight of each mass element, msg and musg, is modeled as an effort
source attached to the 1-junctions having the velocity of the associated mass.
The power arrow is directed away from the 1-juntion and into the source because
if the respective mass element is moving upward (positive by assumption) and
the gravity force is acting downward (as it always must), then power is ﬂowing
from the system and into the source representing the gravity force. (The weight
force source in the ﬁrst example had a different sign convention because there,
the absolute velocity was deﬁned to be positive downward whereas here the
velocities are positive upward.)
For step 4, shown in Figure 4.10d, 0-junctions are used to establish rela-
tive velocities across the remaining elements. For the positive velocity directions
deﬁned, and the positive in compression force directions deﬁned, the proper rel-
ative velocity across the tire spring is vin −vus and the proper relative velocity
across the suspension spring and damper is vus −vs. These are the proper relative
velocities because, if they are positive, then the respective elements will, in fact,
be compressing. Notice that the relative velocities across the suspension spring
and suspension damper are independently constructed, as dictated by the con-
struction procedure. This is perfectly correct and can always be done; however,
a simpler realization for these relative velocities will be shown below. There
is one simpliﬁcation that could be done for this model. The 2-port 1-junction
at the bottom of Figure 4.10d could be removed because it has the sign half-
arrows passing “through” it, and the ﬂow source could be attached directly to
the 0-junction. (See again Section 3.3.)

96
SYSTEM MODELS
It should be recognized that we paid attention only to establishing the proper
velocity components for this construction procedure, and we paid no attention
to the forces. The beauty of using the power conservation properties of bond
graph junctions is that we need only to constrain the velocities and the forces
will automatically be balanced. For mechanical systems, if we establish proper
velocities, the forces are guaranteed to be correct.
To see this, consider the free-body diagram for the quarter-car example, shown
in Figure 4.11. The masses are isolated and the forces from the springs, dampers,
and gravity are exposed. The arrows for the forces are directed in the assumed
positive directions, namely, in compression for this example, and the positive
velocities are directed upward as was assumed positive previously. Notice that
we must show all the forces as having equal but opposite effects, as required
by Newton’s laws. If we were to sum the forces on the sprung mass, positive
upward, the resultant force, F s, would be
Fs = Fks + Fbs −msg,
(4.1)
and for the unsprung mass, the resultant force, F us, would be
Fus = Fk1 −Fks −Fbs −musg.
(4.2)
On the bond graph of Figure 4.10d, the forces on the respective mass elements
are the efforts associated with the —I elements emanating from the 1-junctions
labeled vs and vus. The 1-junctions, in addition to being common ﬂow or velocity,
add efforts, or forces, according to the power convention. Amaze yourself by
Fks
Fks
tk
F
tk
F
Fbs
Fbs
msg
musg
vin
vus
vs
FIGURE 4.11. Free-body diagram of the quarter-car system.

MECHANICAL SYSTEMS
97
adding the forces on the —I element bonds and seeing that the forces add exactly
as required by Eqs. (4.1) and (4.2). The forces were constrained without further
effort (no pun intended) after enforcing the velocity constraints. And we never
had to show equal and opposite reaction forces.
The construction procedure used in the example for the suspension spring and
damper calls for the establishment of the relative velocity across each element
using 0-junctions to appropriately add velocity components. Such adherence to
the construction rules will always produce a correct result. The resulting bond
graph structure, referred to as a loop with a through power convention or a
reducible loop, comes up a lot in bond graph modeling. (We saw a similar loop
in the electrical system of Figure 4.2.)
This loop is isolated in Figure 4.12a, where it has been generalized using
efforts and ﬂows rather than forces and velocities. The relative velocities across
the spring and damper are identical, and each is equal to f1 −f2.
In Figure 4.12b, the relative velocity is established using a single 0-junction,
and then a 1-junction is used to ensure that any bond attached to that 1-junction
will have the relative velocity, f1 −f2. Since both the —C and —R elements
have this relative velocity, they both get attached to the 1-junction as shown in
Figure 4.12b. The reader can check to see that the forces still add up properly
in this alternative representation. The result is a slightly simpler bond graph
emphasizing that several elements have the exactly the same relative velocity.
(It is possible to make a mistake with a loop by deﬁning one side as positive in
extension and the other in compression, which doesn’t square with the schematic
diagram. The pattern in Figure 4.12b prevents that type of mistake, since in that
version, both elements clearly have the same relative velocity.)
In addition to mechanical systems having one-directional translational motion,
it requires only a modest extension of our procedure to deal with translational
systems containing levers, pulleys, and other simple motion–force transforming
devices. Consider the system shown in Figure 4.13a. A velocity input is pre-
scribed in the horizontal direction on the end of a spring with constant k1. The
0
1
R
C
1
0
f1
f1
f1
f1
f2
f2
f2
f2
f1 − f2
f1 − f2
f1 − f2
(a)
0
1
R
C
(b)
FIGURE 4.12. Loop with through power convention that can be reduced.

98
SYSTEM MODELS
1
k
2
k
1v
2
v
3v
a
b
c
1
b
0
ref
v
=
in
v
p
T
+
T
+
(a)
1
1
1
1
in
v
1v
2
v
0
ref
v
=
1 3v
(b)
1
1
1
1
in
v
1v
2
v
0
ref
v
=
1
3v
Sf
0
0
0
fS
0
C
R
C
1
1/ k
2
1/ k
1
b
in
v
:
:
:
:
(c)
1
1v
Sf
0
C
R
C
1
1/ k
2
1/ k
1
b
in
v
TF
TF
b/a
c/a
2
v
3v
(d)
:
:
:
FIGURE 4.13. A pulley–lever mechanism.

MECHANICAL SYSTEMS
99
other end of this spring goes around a pulley and causes vertical motion at one
end of the massless lever. A spring with constant k2 and a damper with constant
b1 are located on the right side of the lever with one end of each attached to
inertial ground. The pivot for the lever is located a distance a from the left end,
while the spring and damper are located at distances b and c to the right of the
pivot. Figure 4.13a in addition shows positive velocity directions and indicates
that both springs and the damper are assumed positive in tension. Notice that
v1 is labeled only on the end of the lever, but it is the same as the horizontal
velocity at the point P.
Following the construction procedure, we ﬁrst use 1-junctions to represent
the distinct velocities. A good question is why these particular velocities were
chosen as distinct and worthy of representation with their own 1-junctions. As
mentioned in step 1 of the construction procedure, velocities are always assigned
to distinct masses, as well as to other physical locations that might prove useful
in establishing relative velocities across elements. You can never overspecify
velocity components. If some 1-junctions turn out to not be needed or redundant,
they can be eliminated during bond graph simpliﬁcation.
Looking carefully at Figure 4.13a, we see that v1 (which is the velocity at
point p) will be useful for establishing the relative velocity across the horizontal
spring, and velocities v2 and v3 are needed for the relative velocities across the
vertical spring and damper. Figure 4.13b shows the 1-junctions with the important
velocities labeled. The only elements that have any of these speciﬁc absolute
velocities are the source elements that establish the input velocity, vin(t), and the
reference velocity, vref = 0. These are shown in Figure 4.13c, where the relative
velocities across the R- and C-elements have been established using 0-junctions.
Convince yourself that the half-arrows are correct for having all elements
positive in tension. For example, with the velocities deﬁned positive as they are,
the spring with constant k1 will be put into tension by the relative velocity,
vin −v1, and this is how the ﬂows add on the corresponding 0-junction. The
other elements follow a similar argument. The rules of construction have been
followed but the model is obviously not complete. There is no connection between
the 1-junctions for v1, v2, and v3.
From Chapter 3 we know that a massless lever is a transformer relating veloc-
ities and forces across it according to the constitutive relationships,
b
a v1 = v2
and
c
a v1 = v3.
(4.3)
(We are assuming that the lever moves through a small enough angle such that
the motion of the points at which other elements are attached is nearly in the
vertical direction.)
Figure 4.13d shows the ﬁnal model with the transformers installed, the refer-
ence velocity eliminated, and some simpliﬁcations performed.
One of the many valuable features of bond graph modeling is the relative
ease with which models can be modiﬁed. Let’s say that a mass that we neglected

100
SYSTEM MODELS
vin
k1
k2
v1
v2
v3
m1
a
b
c
(a) 
0
1
I : m1
R : b1
C : 1/k1
TF
C : 1/k2
TF
vinSf
b1
b/a
c/a
(b) 
FIGURE 4.14. Modiﬁed pulley–lever mechanism.
in the schematic diagram of Figure 4.13a turns out to be important. The
modiﬁed schematic is shown in Figure 4.14a. No additional velocities need be
labeled, since v1 was needed in the previous version of the model. Looking at
Figure 4.13c where v1 is exposed, the new mass element, m1, simply becomes
an —I element attached to the v1 1-junction. Nothing else changes, and the
ﬁnal result is shown in Figure 4.14b.
A straightforward extension of translational mechanical systems is ﬁxed-axis
rotation, presented next.
4.2.2
Fixed-Axis Rotation
Fixed-axis rotation occurs in the mechanics of rotating machines, such as elec-
tric motors and internal combustion engines. Gear boxes, transmissions, transfer
cases, differentials, and drive shafts are all examples of systems that have some
aspect of ﬁxed-axis rotation. The procedure for modeling mechanical transla-
tion need only be modiﬁed slightly to handle systems with ﬁxed-axis rotation.
Because it is a straightforward extension of what we just did, this section starts
with the procedure for bond graph construction of ﬁxed-axis rotation.

MECHANICAL SYSTEMS
101
Construction Procedure for Fixed-Axis Rotation
1. On a schematic diagram of the physical system, use arrows and sym-
bols to indicate the positive direction of absolute angular velocity for
components.
These components include all individual rotational inertial elements, all
prescribed input angular velocities, and the angular velocity of any other
physical locations that may prove useful in establishing useful relative
angular velocities. Decide on positive directions of twist for elements such
as rotational springs and dampers. (The positive direction of relative rate
of twist is hard to show in a schematic diagram but will be easy to see in
a bond graph.)
2. Use 1-junctions to represent each distinct angular velocity from step 1.
Label the 1-junction with the angular velocity symbol from the schematic
diagram. This will help to remind you which junction is associated with
which angular velocity component. You might use a 1-junction to represent
the reference of zero angular velocity. This will later be eliminated, but it
might be helpful for establishing relative angular velocities.
3. Attach to each 1-junction any element that has that angular velocity.
In general, distinct rotational inertias are —I elements associated with
distinct angular velocities represented by some of the 1-junctions. Remem-
ber, positive power is always directed into an —I , —R, or —C element.
4. Use 0-junctions to establish proper relative angular velocities.
Use the sign conventions on the 0-junctions to make the relative veloci-
ties for the connecting elements conform with the twist directions assumed
in the schematic diagram.
5. Eliminate the bonds with zero angular velocity and reduce to the ﬁnal
model.
As the ﬁrst example, consider a model of a grinding wheel at the end of a
torsionally ﬂexible shaft, shown in Figure 4.15a. An electric motor is assumed to
prescribe an input angular velocity, ωin(t), at the left end of the shaft. The shaft
is ﬂexible and characterized by its torsional stiffness, kτ, with units N-m/rad. The
right end of the shaft has a disk of rotational inertia, J , with units kg-m2. There
is also rotational damping with a coefﬁcient having bτ the units N-m/(rad/s),
attached between the disk and ground.
Figure 4.15b is a schematic diagram of the physical system with angular
velocities labeled and positive directions given. The twist in the shaft is assumed
to be positive in the clockwise direction as viewed looking into the ends of
the shaft, and the rotational damper torque is positive for clockwise rotation as
viewed looking into end of the damper. You will notice that it is harder to show
positive angular velocities clearly in a two dimensional sketch than it is to show
positive linear velocities.

102
SYSTEM MODELS
Motor 
Flexible shaft 
disk 
Rotational damper
(a)
ωin
ω1
ωref = 0
kτ
bτ
J
(b)
1
1
1
ωin
ω1
ωref = 0
(c)
1
1
1
ωin
ω1
0
ref
ω
=
Sf
I
ωin
J
f
S
0
:
:
:
(d)
0
1
1
1
ωin
ω1
ωref = 0
Sf
I
ωin
J
Sf : 0
C 1/ kτ
0
R bτ
:
:
:
:
Sf
ωin
:
(e)
0
1
ω1
I J
C 1/ kτ
R bτ
:
:
:
(f)
FIGURE 4.15. A grinding wheel model to demonstrate ﬁxed-axis rotation. Example 1.

MECHANICAL SYSTEMS
103
Figure 4.15c shows 1-junctions representing the distinct angular velocity com-
ponents, including the reference of zero angular velocity. In Figure 4.15d, the
ﬂow source that prescribes ωin(t) is attached to the appropriate 1-junction, and
the rotational inertia is attached to its appropriate 1-junction. In Figure 4.15e,
0-junctions are used to establish relative angular velocities across the torsional
spring and torsional damper. Note that the rate of twist of the torsion spring
is ωin −ω1, which is hard to indicate on the schematic diagram without using
equations. In Figure 4.15f , the inertial reference is removed and some simpliﬁ-
cations are carried out to reduce to the ﬁnal model.
A more complex example of ﬁxed-axis rotation is shown in Figure 4.16. Disks
of rotational inertias J 1 and J 2 are rigidly attached to each end of a ﬂexible shaft
4
τin
J1
J3
J2
J
J5
kτ1
kτ2
kτ3
bτ
ω1
ω3
ω2
ω4
ω′
ω5
R3
R4
ω1
ω2
τ
τ
(a)
1
1
1
1
1
1
I
I
I
I
I
ω1
ω3
ω2
1
J
3
J
2
J
5
J
4
J
ω′
4
ω
5
ω
e
S
in
τ
:
:
:
:
:
:
(b)
FIGURE 4.16. A system of shafts and gears. Example 2.

104
SYSTEM MODELS
1
1
1
1
1
1
I
I
I
I
I
1
ω
ω3
ω2
1
J
3
J
2
J
5
J
4
J
ω′
4
ω
ω5
e
S
in
τ
0
C
0
C : 1/kτ2
0
0
C : 1/kτ3
R
1
1/ kτ
bτ
:
:
:
:
:
:
:
:
(c)
1
1
1
1
I
I
I
I
I
ω1
ω3
ω2
J1
3
J
2
J
5
J
4
J
ω4
ω5
Se
in
τ
0
C : 1/kτ1
0
C : 1/kτ2
0
C : 1/kτ3
R bτ
TF
3
4
/R
R 
:
:
:
:
:
:
:
:
(d)
FIGURE 4.16. (Continued)

MECHANICAL SYSTEMS
105
with torsional stiffness, kτ1. Disk 2 is attached at one end to a second torsional
spring with constant kτ2, which is attached to a third disk, J 3, that is free to rotate
on the shaft. This third disk is of radius R3 and forms a gear set with the fourth
disk with moment of inertia J 4 and radius R4. Finally, disk 4 is attached through
a torsional spring and damper, parameters kτ3 and bτ, to a ﬁfth disk of rotational
inertia, J 5. Note that an intermediate angular velocity, ω′, has been labeled in
between the rotational spring and damper. This was done for convenience in
anticipation of the need to establish the relative angular velocities across these
two elements. We would ultimately like to predict the motion–time behavior of
this system for a speciﬁed input torque, τ in(t).
On the physical schematic the positive angular velocity directions are indicated
with arrows and labels, and the positive torque directions for the springs are
indicated by the lines with full arrows using the right-hand-rule. The isolated
shaft accompanying the schematic shows this notation.
In Figure 4.16b, 1-junctions have been used to represent all the distinct
angular velocities from the schematic. Moreover, the bond graph elements
that have these speciﬁc angular velocities have been attached directly to these
1-junctions. These include the rotational inertias and the input torque source
that is moving at the angular velocity ω1. In Figure 4.16c, 0-junctions have
been used to establish relative angular velocities across the rotational spring
and damper elements. The power convention for the 0-junctions was chosen to
establish the positive torque directions from the schematic. Notice how useful
the 1-junction for ω′ is for establishing the relative angular velocities across
the spring and damper with parameters kτ3 and bτ. Also notice that there is no
connection between ω3 and ω4. The two disks of rotational inertias J 3 and J 4
are a gear set with the kinematic relationship
R3
R4
ω3 = ω4.
(4.4)
This relationship is enforced by a transformer as shown in Figure 4.16d. In
this ﬁgure, some ﬁnal simpliﬁcations were done, including the removal of the
unnecessary 1-junction representing ω′. After this 1-junction was removed, the
two remaining 0-junctions were connected by a common bond enforcing that all
connected bonds had the same torque (effort). All the bonds with a common
effort can then be connected to a common 4-port 0-junction as was done in
the ﬁnal step, Figure 4.16d. This is a nice example of introducing 1-junctions
for ﬂows that might be convenient for model construction, and then having the
modeling procedure dictate whether these 1-junctions remain in the ﬁnal model.
The modeler is free to deﬁne and introduce as many ﬂows on 1-junctions (or
efforts on 0-juntions) as desired. If these extra junctions are actually unnecessary,
simpliﬁcation can remove them.
We now go on to model systems containing rigid bodies that can move in
translation as well rotation. Here we treat the important case of plane motion.

106
SYSTEM MODELS
4.2.3
Plane Motion
For mechanical translation it was ﬁne to imagine the mass elements as point
masses, and for ﬁxed-axis rotation it was ﬁne to consider only the rotational
inertia of a mass element. But, in general, mechanical bodies with ﬁnite mass
both translate and rotate in real applications. Consider an automobile as it moves
over roadway unevenness. The body of the vehicle moves forward, sideways, and
vertically, and it rolls side to side, pitches front to rear, and rotates about a vertical
axis as it turns. If we modeled the car body as rigid, we would have to characterize
the body by its mass and the moments of inertia about three perpendicular axes.
The motion of the vehicle would be quite complex and certainly not able to be
described by mechanical translation alone or ﬁxed-axis rotation alone. Instead, the
dynamics are governed by a simultaneous combination of translation and rotation.
To describe this motion in three dimensions is quite complicated, but is greatly
facilitated by using bond graphs. Chapter 9 discusses this complex topic. When
our attention is restricted to plane motion, model construction is straightforward.
Plane motion results when the inertial bodies of a physical system are con-
strained to translate in two dimensions and to rotate only about an axis perpen-
dicular to the plane of motion. Figure 4.17a shows a rigid body of mass, m, and
moment of inertia, J , about its center of mass. The X- and Y -axes are assumed to
be inertial axes. The body is translating in the XY -plane and it is rotating about
the inertial Z-axis, which points out of the page according to the right-hand-rule.
Any forces acting on the body from attached devices are not shown in the ﬁgure.
It is useful to describe the motion of the body by describing the translation
of the center of mass and the angular velocity of the body. The center of mass
has an absolute velocity vector pointing in some direction in the XY -plane. This
vector is resolved into two mutually perpendicular components, vX, vY , aligned
in the XY -directions as shown on the ﬁgure. The angular velocity is the angular
rate of change of any line ﬁxed to the body with respect to the XY -axes.
The kinetic energy T of a rigid body is characterized in a particularly simple
way by the velocity of the center of mass and the angular velocity of the body,
T = 1
2mv2
X + 1
2mv2
Y + 1
2Jω2
(4.5)
in which it is notable that by focusing on the motion of the center of mass and
using the moment of inertia about the center of mass the energies of translation
and rotation are uncoupled.
Since bond graphs bookkeep energy, to account for all the energy of a rigid
body in plane motion we must represent the translation velocity of the body in
two perpendicular directions as well as the angular velocity. This is done in the
bond graph fragment of Figure 4.17b. The 1-junctions are used to represent each
center of mass velocity component and the angular velocity. Attached to the
velocity 1-junctions are —I elements with inertia parameter equal to the mass,
m, and attached to the 1-junction for the angular velocity is an —I element with
the moment of inertia, J , as the parameter. This fragment characterizes all the

MECHANICAL SYSTEMS
107
X
Y
vX
vY
ω
rp
xp
yp
p
vpX
vpY
(a)
1
1
1
I
I
I
m, J
m
m
J
ω
vX
vY
(b)
:
:
:
FIGURE 4.17. General plane motion of a rigid body.
energy of a body in plane motion. Any devices, such as springs and dampers,
that interact with the rigid body will end up communicating with the 1-junctions
of Figure 4.17b when incorporated into a bond graph model.
In general, devices will be attached to rigid bodies at different places on the
body. For example, the point p indicated in Figure 4.17a might be such a point.
We will discover that we need the velocity components of the attachment points
indicated as vPX, vPY in the ﬁgure. The attachment point is located with respect
to the center of mass by the position vector ⃗rP composed of the components xP,
yP. The kinematic relationship (see Reference [2]) that allows determination of
the velocity of any point on a rigid body is
⃗vP = ⃗vcm + ⃗ω × ⃗rP
(4.6)
where the cross-product term accounts for the contribution of ω to the velocity of
the point in question. This relationship gets used over and over when modeling
rigid bodies in plane motion. In plane motion, the angular velocity vector is
always perpendicular to the position vector, thus making the use of Eq. (4.6)
particularly simple.

108
SYSTEM MODELS
For the geometry of Figure 4.17a, application of Eq. (4.6) yields
vPx = vX −yP ω
and
vPY = vY + xP ω.
(4.7)
It should be noted that for large angular motions of the body, xP and yP will
change as the body moves. In this case, if rP is the length of the vector ⃗rP , then
xP = rP cos θ and yP = rP sin θ, where is the angle between ⃗rP and the axis
with ˙θ = ω. Equation (4.7) then becomes
vPx = vX −(rP sin θ)ω
and
vPY = vY + (rP cos θ)ω,
(4.7a)
and one can recognize that displacement modulated transformers as discussed in
Section 3.2 and shown in Figure. 3.10 will be involved in the bond graph of the
system. This type of geometrically nonlinear mechanical system is discussed at
length in Chapter 9.
As a simpler ﬁrst example in which the angle of the rigid body is assumed not
to experience large excursions, consider the heave–pitch vehicle model shown
in Figure 4.18a. This is an extension of the quarter-car model done previously in
Figure 4.10. This model is sometimes called the half-car model. We are looking
at the side of the vehicle with the front at the right and the rear at the left. The
front and rear suspensions each consist of a tire springs with stiffnesses ktf , ktr,
unsprung masses musf , musr, and suspension springs and dampers with parameters
ksf , bsf , and ksr, bsr. The inputs to the system are the prescribed input velocities
at the front and rear, vif (t) and vir(t). The body is modeled as a rigid body with
center of mass located a distance a from the front suspension connection and
a distance b from the rear suspension connection. The body has mass, m, and
centroidal moment of inertia, J . Gravity is acting vertically downward.
For this model the vehicle is not moving forward but is mounted in a test
rig that supplies the input velocities to the tire springs as if a bumpy road were
passing under the vehicle. The body is assumed to move only vertically and
to rotate, or pitch, through small angles. Thus, the rigid body is characterized
by the vertical center of mass velocity, vg, and the pitch angular velocity, ω.
Other important velocities are oriented and labeled in the ﬁgure, including the
vertical velocity components at the front and rear of the body, vf and vr. These
components are introduced for convenience in anticipation of construction of
the relative velocity across the front and rear suspension units. As indicated in
Figure 4.18a, all spring and damper forces are assumed positive in compression.
The procedure for constructing a bond graph model of a system with rigid
bodies in plane motion is basically identical to the procedure for mechanical
translation and ﬁxed-axis rotation, but with the added complexity of dealing with
kinematics described by Eq. (4.6). Figure 4.18b shows the use of 1-junctions to
represent all the distinct velocities and angular velocities of the system. Attached
to these 1-junctions are bond graph elements that have these speciﬁc velocity and
angular velocity components. The front and rear suspension unsprung masses and
input velocities should look familiar because of the earlier quarter-car example.

MECHANICAL SYSTEMS
109
g
g
v
ω
a
b
fv
rv
r
us
v
fiv
riv
f
us
v
m, J
f
us
m
r
us
m
fsk
rsk
fsb
rsb
All springs and
dampers are + in
compression 
ftk
rtk
(a)
1
1
1
1
1
1
1
vg
ω
vf
vr1
vusf
vusr
vif
vir
Sf vif
Sf : vir
I:m
I:J
Se:musfg
I:musf
musrg:Se
musr:I
mg:Se
(b)
FIGURE 4.18. Heave–pitch vehicle model. Example 1 of plane motion.

110
SYSTEM MODELS
The rigid body is characterized by the center-of-mass velocity and angular
velocity, so —I elements for the mass, m, and centroidal moment of inertia, J ,
are attached to the appropriate 1-junctions. The weight of the body is an effort
source attached to the center-of-mass vertical velocity 1-junction. Positive power
is directed into the source owing to the velocity convention (positive upward)
adopted for this example. The same is true for the effort sources representing the
weights of the unsprung masses, front and rear.
In Figure 4.18c, 0-junctions have been used to establish the relative velocities
across the springs and dampers. The power convention is such that all elements
are positive in compression as indicated for this system. Some simpliﬁcations
have already been done. Notice how the 1-junctions for vf and vr were used to
help in constructing the relative velocities across the front and rear suspensions.
1
1
1
1
1
1
fv
rv
f
us
v
r
us
v
fiv
riv
f
S
f
S
I
I
e
S
e
S
r
us
m
f
us
m
riv
fiv
f
us
m
g
r
us
m
g
0
0
1
R
C
0
C
1
R
C
0
C
1/
fsk
1/
rs
k
1
1
gv
ω
I
I
e
S
mg
J
m
fsb
rsb
1/
rtk
1/
ftk
:
:
:
:
:
:
:
:
:
:
:
:
:
:
:
(c)
1
1
ω
1
rv
1
fv
0
0
TF
TF b
a
/
1
g
v
1
1
ω
1
rv
1
fv
0
0
TF
TF
b
/
1
a
g
v
bω
aω
bω
aω
:
:
:
:
(d)
FIGURE 4.18. (Continued)

MECHANICAL SYSTEMS
111
1
1
1
1
1
1
vf
rv
r
us
v
vif
vir
Sf : vif
Sf : vir
Se : musf
musr : I
bsr : R
musrg : Se
0
0
1
0
1
R : bsf
C : 1/ksf
0
C : 1/ktf
1/ksr : C
1
1
vg
ω
I : m
mg : Se
0
0
TF : 1/a
TF : b
I : J
I : musf
(e)
vusf
1/ktr : C
FIGURE 4.18. (Continued)
Also notice that for the suspension elements, the relative velocities were con-
structed only once, and then 1-junctions were used to enforce that the respective
springs and dampers have the same relative velocity as in Figure 4.12. From
Figure 4.18c it is obvious that the model is not complete, and yet all elements
have been incorporated. This is where the kinematics plays a major role.
For small angular motions, using Eq. (4.6) and using the right-hand-rule for
cross products, we can derive that
vf = vg + aω
and
vr = vg −bω.
(4.8)
(These relations may seem almost obvious but they are special cases of the
vertical velocity relation in Eq. (4.7a) when remains near 0 for vf and π for vr.)
These kinematic constraints must be enforced to complete the model. Until
now, it has been recommended that positive directions be shown on a schematic
and then transferred to the bond graph model. If this is not done then the model
may still be all right. But in a simulation of the system response, we might not
know whether a positive velocity was up or down, or whether a positive force was
compressive or extensive. This is important information to have, so it is always
a good idea to have a power convention in mind. However, if the kinematic
constraints are not enforced correctly, then the model is just plain wrong.

112
SYSTEM MODELS
Kinematic constraints are always relationships among ﬂow variables. To add
the ﬂows according to the constraints we use 0-junctions. We just need to pay
particular attention to the power convention when adding up the ﬂows to enforce
the constraints. In Figure 4.18d the constraints from Eqs. (4.8) are enforced with
two different half-arrow patterns using 0-junctions. The reader should check that
in both cases the velocity components add correctly to produce Eqs. (4.8). Trans-
formers are used to convert the angular velocity into velocity components, that
is, ω into aω or bω. On the transformers in the ﬁgure, the moduli are appended
according to the deﬁnition of the transformer given in Chapter 3. Although either
version in Figure 4.18d can be used, if the right-hand version of part (d) is used,
as is done in Figure 4.18e, then a bond graph simpliﬁcation can be done at the
1-junctions for vf and vr.
A second example of plane motion is the system shown in Figure 4.19a. The
system is a cart of mass, m, acted upon by an input force, F(t). Attached to the
cart through a spring and damper, k and b, is a cylinder that rolls without slip
on the cart. The cylinder is a rigid body of mass, mc, with center of mass in
mc, Jc
cv
ω
R
k
b
vm
F(t)
m
+ in tension
(a)
1
1
1
vc
ω
vm
I
I
I
Se
F(t)
m
mc
cJ
(b)
1
1
vc
vm
I
I
Se
F(t)
m
mc
1ω
I
cJ
0
1
C
b : R
1/k
(c)
1
1
cv
vm
I
I : m
e
S
F(t)
mc
1ω
I
Jc
0
1
C : 1/k
b : R
0
TFR
Rω
(d)
:
:
:
:
:
:
:
:
:
:
:
:
:
FIGURE 4.19. Cart with rolling cylinder. Example 2 of plane motion.

MECHANICAL SYSTEMS
113
the center and moment of inertia about its center of mass, J c, and is of radius
R. We desire a model that, if solved analytically or simulated, will predict the
motion–time history of this system for any prescribed input force.
The schematic shows positive velocity and angular velocity directions, and the
spring and damper are assumed positive in tension. Figure 4.19b uses 1-junctions
to represent the distinct velocities and angular velocities, and the elements that
have these distinct ﬂows have been attached to the 1-junctions. The rigid-body
cylinder is a body in plane motion and is represented by its center-of-mass veloc-
ity, vc, and its angular velocity, ω, and thus has the —I elements for its mass and
moment of inertia appropriately attached. In Figure 4.19c the relative velocity is
established across the spring and damper. Perusal of this ﬁgure clearly indicates
that the model is not complete, even though all energy has been accounted for.
Again, there is a kinematic relationship that must be derived before we can
complete the model. Application of Eq. (4.6) to the velocity of the point at the
bottom of the cylinder, vp, positive to the right, yields
vP = vc −Rω.
(4.9)
Since the cylinder rolls without slip, the velocity at the bottom of the cylinder
must be the same as the velocity of the cart at the same point. Thus, the kinematic
constraint is
vm = vc −Rω.
(4.10)
In Figure 4.19d this constraint is enforced using a 0-junction and the model
is complete.
As a ﬁnal example of systems with plane motion dynamics, consider the
system in Figure 4.20a. An input velocity, vin(t), is prescribed on one end of
a spring, k1, and the other end is attached to an inextensible rope that wraps
around a ﬂoating cylinder of mass m1, radius R1, and moment of inertia J 1. The
rope then passes over a second cylinder that is pinned at its center and has radius
R2 and moment of inertia J 2. The rope ﬁnally is attached to a mass, m2, which
is attached to ground through the spring and damper, k2 and b. The idea is to
formulate a model that, if simulated, would predict the motion–time history of
the system to a prescribed input velocity. Positive velocity and angular velocity
directions are shown in the ﬁgure, and all springs and dampers are assumed
positive in extension.
In Figure 4.20b, 1-junctions are used to represent the distinct velocities and
angular velocities. The ﬂoating cylinder requires a 1-junction for its center-of-
mass vertical velocity and a 1-junction for its angular velocity. Notice that the
velocities at the left and right of the ﬂoating cylinder have been deﬁned. The one
at the left, vl1, has been introduced as a convenience for establishing the relative
velocity across the spring with constant k1. The velocity at the right of the
cylinder, vr1, will be useful for relating to the angular velocity, ω2, of the pinned
cylinder. Also, we can see that, since the rope is inextensible, vr1 is equal to the
mass velocity, vm2. Attached to these 1-junctions are the bond graph elements that

114
SYSTEM MODELS
have these distinct ﬂows. The power arrow for the ﬂow source, —S f , is directed
out of the source and into the system, because if the spring with constant k1 is
deﬁned as positive in tension and if the top end of the spring is moving upward
(deﬁned as positive), then power would be ﬂowing into the system.
In Figure 4.20c, 0-junctions are used to establish the proper relative velocities
across the springs and dampers so as to put these elements positive in tension.
The spring and damper attached to m2 have been modeled using the “reducible
+T
+T
(a)
vin
k1
vl1
vr1
R1
v1
ω1
ω2
R2
vm2
m2
k2
b
vref = 0
m1, J1
J2
1
1
vl11
1
1
1
1
Sf : vin
I : J2
I : m2
I : J1
I : m1
vref = 0
vm2
ω2
vin
vr11
v1
ω1
(b)
FIGURE 4.20. System with a ﬂoating pulley. Example 3 of plane motion.

MECHANICAL SYSTEMS
115
1
1
vl11
vr11
1
1
1
1
Sf : vin
I : J2
I : m2
I : J1
I : m1
vref = 0
vm2
ω2
vin
v1
ω1
(c)
Sf : 0
0
1
R:b
C:1/k2
0
1/k1 : C
1
vl11
1
1
1
1
f
S
I : J2
I : m2
I : J1
I : m1
vm2
ω2
in
v
vr1
v1
ω1
(d)
0
1/k1 : C
R:b
C:1/k2
0
0
TF
TF : 1/R1
1/R1
1/R2 : TF
:
:
FIGURE 4.20. (Continued)
loop” simpliﬁcation of Figure 4.12. The reference velocity, vref = 0, can be erased
in the ﬁnal bond graph. Clearly, the model in Figure 4.20c is not complete.
For cylinder 1, application of Eq. (4.6) yields the kinematic constraints
vl1 = v1 + R1ω1
and
vr1 = −v1 + R1ω1.
(4.11)

116
SYSTEM MODELS
Moreover, since the rope is inextensible, the velocity at the rim of cylinder 2
is the same as vr1, thus,
vr1 = R2ω2.
(4.12)
Equations (4.11) are enforced using 0-junctions as shown in Figure 4.20d. The
velocity vr1 is related to ω2, as required by Eq. (4.12). And vr1 is set equal to vm2
by simply connecting the 1-junctions with a bond. The model in Figure 4.20d is
now complete. Some simpliﬁcations are possible, but this is left to the reader.
As has been demonstrated in all examples of mechanical systems with ele-
ments in plane motion, bond graph models are constructed by ﬁrst establishing
distinct velocities and angular velocities using 1-junctions that assign the same
ﬂow to each attached bond and add the efforts according to the power convention.
This is followed by establishing the proper relative motions across compliances
and resistances, using 0-junctions that add ﬂows according to the power conven-
tion and assign the same effort to each attached bond. This part of the modeling
procedure is straightforward and invariant. With some practice these steps will
become automatic. The most difﬁcult part of model construction is deriving and
enforcing the kinematic constraints. There is no easy set of rules for recognizing
and deriving these relationships. The constraints will always involve ﬂow vari-
ables and will always involve application of the vector relationship, Eq. (4.6).
Practice is the only way to become comfortable with this aspect of modeling.
A major advantage to the use of bond graphs is that if the velocities are prop-
erly constrained using power-conservative elements, then the force and torque
relationships will automatically be correctly represented.
Body-ﬁxed Coordinates. The concepts of plane motion were developed using the
general motion of a rigid body, shown in Figure 4.17. In order to characterize all
the energy of a rigid body in plane motion it is necessary to know the velocity
of the center of mass and the angular velocity of the body. In Figure 4.17, the
velocity vector of the center of mass was resolved into two mutually perpendicular
components aligned in the inertial XY -directions. When there are several places
where a rigid body interacts with other parts of a system and when the rigid body
can execute large angular motions, it is convenient to introduce the concept of
body-ﬁxed coordinates. This is a coordinate frame that remains attached to the
body at the center of mass and moves with the body as it translates and rotates
under the action of whatever is attached to it. The virtue of such a frame is that the
attachment points remain at ﬁxed locations relative to this frame, and the inertial
properties, that is, moments and products of inertia, remain invariant with respect
to this frame. These properties are very important for three-dimensional rigid-
body motion, which is discussed fully in Chapter 9. We introduce the concept
here for plane motion.
The general rigid body of Figure 4.17 is shown again in Figure 4.21a with
body-ﬁxed coordinates. The xy-coordinate frame is attached to the body at the
∗This section can be omitted without any loss of generality.

MECHANICAL SYSTEMS
117
X
Y
x
y
vpx
vpy
vx
vy
ω
xp
yp
m, J
(a)
1
1
1
I:m
I : m
I : J
vx
vy
ω
∑Fx
∑Fy
∑τ
(b)
1
I:m
vx
∑Fx
1
I:m
vy
∑Fy
1
I:J
ω
∑τ
(c)
mω
MGY
θ, θ = ω
.
FIGURE 4.21. General plane motion with body-ﬁxed coordinates.
center of mass, and it is aligned in principal directions, although this is not
essential. The instantaneous velocity vector that is pointing in some direction
in the plane of motion is resolved into two mutually perpendicular directions
aligned along the body-ﬁxed axes. These components, vx and vy, are different
from the inertial components in Figure 4.17, since they change direction as the
body rotates. This change in direction of velocity vector components results in
acceleration components that must be accounted for. Also shown in Figure 4.21a

118
SYSTEM MODELS
is the attachment point, P, that is located with respect to the xy-coordinates by
the ﬁxed lengths xp, yp.
In Reference [2], it is shown that for any vector, say the velocity vector, ⃗v,
referred to a rotating frame, the absolute time rate of change of the vector, or
acceleration in this case, is
d
dt ⃗v = ∂
∂t ⃗v|rel + ⃗ωx⃗v,
(4.13)
where the ﬁrst term on the right is the acceleration as observed relative to the
moving frame, and the second term accounts for the contribution of the frame
rotation to the absolute acceleration. Applying this relationship to the rigid body
of Figure 4.21a yields the center of mass absolute acceleration, ax, ay, as
ax = ˙vx −ωvy
and
ay = ˙vy + ωvx,
(4.14)
where the components due to rotation are derived by carrying out the cross
products using the right-hand-rule. For example, the ω-vector pointing out of the
page, when crossed into the x-direction velocity component, vx, yields a vector
of length ωvx pointing in the y-direction.
Newton’s laws apply to the absolute acceleration of the center of mass, and
become

Fx + mωvy = m˙vx
and

Fy −mωvx = m˙vy,
(4.15)
where the sum of forces in the x- and y-directions come from any attached
systems to the body, and the rotational contributions to the acceleration have
been brought to the force side of the equation after multiplying by the body
mass, m.
Returning now to Figure 4.21b, it is tempting to represent the plane motion of
the rigid body as shown, where the body-ﬁxed velocity components, vx, vy, are
used rather than the inertial components, vX, vY from Figure 4.17. The kinetic
energy of the body is accounted for, but the absolute acceleration is not. In other
words, if the forces from external elements were added using the 1-junctions of
Figure 4.21b, then the resulting equations of motion would not be correct. The
ﬁx to this problem lies in Eqs. (4.15).
The cross-product terms of Eqs. (4.15) have a remarkable symmetry. In the
ﬁrst equation, there is a force component in the x-direction that is equal to mω
times the velocity in the y-direction. And in the second equation there is a force
component in the y-direction equal to mω times the velocity in the x-direction.
Since gyrators relate efforts to ﬂows across them, consider Figure 4.21c where
a modulated gyrator has been inserted between the 1-junctions representing vx
and vy. A modulated gyrator is used because the modulus, mω, is not constant
but varies as the body moves and changes. Convince yourself that the forces
on the —I elements exactly duplicate the left-hand side of Eqs. (4.15). When
body-ﬁxed coordinates are used, the —MGY — must be part of the bond graph.

MECHANICAL SYSTEMS
119
For the attachment point in Figure 4.21a, the velocity components in the
body-ﬁxed directions are related to the center of mass velocity components using
Eq. (4.6), with the result
vpx = vx −ypω
and
vpy = vy + xpω.
(4.16)
As an example of the use of body-ﬁxed coordinates, consider the system in
Figure 4.22a. The rigid body of mass, m, and centroidal moment of inertia, J ,
is attached to ground at points 1 and 2 through springs and dampers as shown.
The ground side ends of the springs and dampers are on frictionless carts that
ensure that horizontal elements remain horizontal regardless of the motion of the
body. Horizontal spring 1 has a velocity input at its ground side end. The body
is shown displaced from its starting orientation, and body-ﬁxed coordinates are
attached at the center of mass. The attachment points are located with respect to
the body-ﬁxed coordinate frame by the ﬁxed distances x1, y1 for point 1 and x2,
y2 for point 2, where x2 is a negative quantity. In Figure 4.22b the body-ﬁxed
velocity components at the attachment points are indicated, and in Figure 4.22c
,
m, J
k2
k1
b2
b1
vin
x
y
x1
x2
y1
y2
vx
vy
ω
+T
+T
(a)
vx
vx
vy
ω
vx1 = vx − y1ω
vx2 = vx − y2ω
vy1 = vy + x1ω
vy2 = vy + x2ω
(b)
θ, θ = ω
.
FIGURE 4.22. A rigid body attached to a frame undergoing large motions.

120
SYSTEM MODELS
1
1
1
1
1
1
1
1
1
Sf
I :J
I :m
1
I :m
vx
vy
ω
mω
MGY
vx2
vx1
vx1
vy2
vy1
vy1
vh2
vh2
vh1
vh1
vin
(c)
1
1
1
1
1
1
1
1
I :J
I:m
1
I:m
1
Sf :vin
vx
vy
ω
vx2
vy2
(d)
0
0
0
0
0
0
MTF : 1/sinθ
MTF : 1/sinθ
TF
TF
TF:y1
TF : 1/x1
C:1/k2
C:1/k1
0
1
b2:R
R:b1
y2
1/x2
cosθ : MTF
cosθ : MTF
:
:
:
mω
MGY
:
FIGURE 4.22. (Continued)

HYDRAULIC AND ACOUSTIC CIRCUITS
121
1-junctions are used to represent all distinct velocities. Attached to these
1-junctions are elements that have these absolute velocities. Notice the represen-
tation of the body when using body-ﬁxed coordinates. The body-ﬁxed velocity
components at the attachment points are indicated using 1-junctions. These are
deﬁned as a convenience for ultimately determining the horizontal velocity at the
attachment points for use as inputs to the horizontal spring–damper elements.
As noted in Figure 4.22b, the body-ﬁxed velocities at the attachments are
vx1 = vx −y1ω,
vy1 = vy −x1ω,
vx2 = vx −y2ω,
vy2 = vy + x2ω,
(4.17)
and the horizontal velocity at the attachments are
vh1 = vx1 cos θ −vy1 sin θ,
vh2 = vx2 cos θ −vy2 sin θ.
(4.18)
These kinematic relationships are enforced using 0-junctions as shown in
Figure 4.22d. The transformers used to enforce constraints from Eqs. (4.18) are
modulated transformers, —MTF—, because the moduli of these elements vary as
the body moves. Figure 4.22d is the ﬁnal bond graph for this example. The bond
graph does appear a bit busy, but it contains a lot of information. In Chapter 9,
some shorthand notation is introduced for complex systems that allows the bond
graph to be constructed while showing fewer bonds.
4.3
HYDRAULIC AND ACOUSTIC CIRCUITS
In this section, special but important classes of ﬂuid-ﬂow systems will be modeled
using bond graphs. The models to be used exhibit a close analogy to the mechani-
cal and electrical systems studied in the previous section of this chapter. The vari-
ables to be used here have been discussed in Chapter 2 (Table 2.4), and the basic
ﬂuid system elements have been discussed in Chapter 3. Tables 3.1, 3.2, 3.3, and
3.4 and Figures 3.1, 3.2, and 3.4 show the type of 1-port ﬂuid elements to be used
in this section. Figure 3.8 shows a 2-port transformer with a ﬂuid port, and Figure
3.11 shows 0- and 1-junction ﬂuid elements. So far the discussion has been fairly
general, but it is now time to be more speciﬁc about the modeling of ﬂuid systems.
One category of systems that is important in engineering and can be mod-
eled using the elements shown previously is commonly called hydrostatic. These
are systems composed of pumps, motors, pipes, pistons, valves, ﬁlters, and
accumulators that use nearly incompressible ﬂuids, such as water or hydraulic
oil. Such systems are found in machine tools, earth-moving equipment, power

122
SYSTEM MODELS
transmissions, and aircraft control surface servomechanisms. Generally, these
systems have high pressures and low ﬂuid velocities so that the static pressure
dominates the dynamic pressure. This is the origin of the name hydrostatic, even
though the dynamics of such systems are typically of great interest.
A second category of ﬂuid systems that can be treated with the elements to
be used here involves compressible gases (such as air) but in which the pressure
deviations are small enough that the acoustic approximation applies. Acoustic
circuits can often be used to design some types of mufﬂers to reduce noise in air-
conditioning systems, for example. However, pneumatic systems in which large
pressure variations are expected need a more complicated modeling treatment
since they are general thermoﬂuid systems, as discussed in Chapter 12.
Most engineers are familiar with lumped parameter elements of mechanical
and electrical systems such as rigid bodies, springs, dampers, resistors, capacitors,
and inductors. The equivalent ﬂuid elements are generally less familiar and less
obvious. Thus, it is worthwhile to describe some 1-port elements that can be used
to model hydraulic and acoustic circuits before showing how to assemble bond
graph models of these systems.
4.3.1
Fluid Resistance
Figure 3.1 showed a 1-port ﬂuid resistor that relates an effort, a pressure drop,
P, to a ﬂow, a volume ﬂow rate, or volume velocity, Q. Figure 4.23 shows
how resistors typically appear in a bond graph, together with example devices
represented by a resistor. Part a of Figure 4.23 is a combination of a resistor and
a 1-junction. This combination implies that the pressure drop, P3, is related to
the pressures P1 and P2 by the equation
P3 = P1 −P2,
(4.19)
and that all volume ﬂow rates are equal,
Q1 = Q2 = Q3.
(4.20)
Following Table 3.1, the resistor implies that the pressure drop is related to
the volume ﬂow rate by a nonlinear function,
P3 = R(Q3),
(4.21)
or, if a linear relation is assumed, by a resistance coefﬁcient R3
P3 = R3Q3.
(4.22)
It is an unfortunate fact that in many hydraulic and acoustic systems it is not
easy to predict resistance functions or coefﬁcients for parts of the system before it
is constructed. However, experimentally it not difﬁcult to measure pressure drops

HYDRAULIC AND ACOUSTIC CIRCUITS
123
(c)
P1
P2
Q1
Q2
(d)
(e)
Q1
Q1
Q2
Q2
P1
P1
P2
P2
x
(a)
P1
P2
Q1
Q2
(b)
1
R
P3 Q3
P1
Q1
P2
Q2
FIGURE 4.23. Fluid resistors: (a) bond graph; (b) porous plug; (c) long pipe; (d) oriﬁce;
(e) valve with variable area, A(x).
and ﬂow rates under steady conditions and to characterize resistance effects. This
means that there are at least guidelines in the engineering literature for suitable
resistance law assumptions.
Part b of Figure 4.23 is intended to represent a porous plug in a pipe for which
viscous forces on the ﬂuid from the plug might be assumed to dominate. In this
case it would be logical to use Eq. (4.22). In the absence of experimental data
relating to the plug, one would have to experiment with values of the coefﬁcient
R3 in studying a system model.
Another case in which a linear resistance can be assumed is shown in part c
of Figure 4.23, which is supposed to represent a long, thin tube in which laminar
ﬂow of an incompressible ﬂuid develops. In this case a theoretical value for the
resistance can be given, (see Reference [4], Section 7.4):
R3 = 128μl/πd4,
(4.23)
where μ[Pa · s] is the ﬂuid viscosity coefﬁcient, l [m] is the length and d [m]
is the inside diameter. (Note that the Appendix lists typical property values,
such as viscosity, for a number of materials. These are particularly useful for
estimating 1-port element parameters and functions for the types of systems
treated in this section.)

124
SYSTEM MODELS
For incompressible ﬂow in long pipes, it is useful to compute a Reynolds
number, Re, deﬁned as
Re = 4ρQ/πdμ,
(4.24)
where ρ [kg/m3] is the ﬂuid mass density. When the Reynolds number is low,
say about 200 or less, viscous forces predominate and Eqs. (4.22) and (4.23)
can be used. At a higher Reynolds number, the ﬂow becomes turbulent and
the pressure–ﬂow relationship under steady-ﬂow conditions is nonlinear. The
transition to turbulent ﬂow depends on the pipe dimensions l and d, the pipe
surface roughness, and ﬂuid properties.
For Reynolds numbers greater than about 5000, the ﬂow is likely to be turbu-
lent, and a general function for the nonlinear relation from Eq. (4.21) is
P3 = atQ3|Q3|3/4.
(4.25)
In this formula, the absolute value sign is necessary to make sure that P3 is
negative if Q3 is negative. The constant at is often determined experimentally
(see Reference [5]). Even when Eq. (4.25) is known to be valid for steady ﬂow,
its use in studying transient conditions is not necessarily valid. For oscillatory
ﬂows or other dynamic conditions, turbulence may not develop fully, so in these
conditions, Eq. (4.25) should be regarded only as an approximation.
Parts d and e of Figure 4.23 show two important cases in which a pressure drop
occurs over short lengths. The oriﬁce is assumed to have a ﬁxed area A0, while
the valve has a variable area A(x), where x is a position coordinate. Although
the valve is shown as if it were a gate valve, the basic equation for the pressure
drop applies to a variety of other valve conﬁgurations. It is a standard exercise
in ﬂuid mechanics texts to derive the laws of an oriﬁce using considerations of
energy, momentum, and continuity. The main result is that the pressure drop is
proportional to the square of the volume ﬂow rate. One form of the law is (see
Reference [6], Section 3.8)
P3 = (ρQ3|Q3|)/2C2
dA2
0,
(4.26)
where again the use of the absolute value sign corrects the sign of the pressure
drop P3 if Q3 happens to be negative and C d is a discharge coefﬁcient. For a
round, sharp-edged oriﬁce, C d can be predicted to have a value of 0.62, but for
other shapes of holes, the values of C d vary somewhat.
For valves, the area depends on a position coordinate and the discharge coef-
ﬁcient may also vary, so the relation equivalent to Eq. (4.26) can be written
P3 = (ρQ3|Q3|)/2C2
d(x)A2(x).
(4.27)
In case it turns out that a causal analysis of the system model ultimately
requires that the ﬂow must be expressed in terms of pressure drop, the

HYDRAULIC AND ACOUSTIC CIRCUITS
125
relationships of Eqs. (4.26) and (4.27) must be inverted. For example, the
inverse version of Eq. (4.26) is
Q3 = CdA0(2|P3|/ρ)1/2 sgn P3.
(4.28)
This form is slightly more complicated than the form usually given to allow the
pressure drop and volume ﬂow rate to take on both positive and negative values.
(The signum function “sgn” is just +1 if P3 is positive and −1 if it is negative.)
In dynamic systems in which oscillating ﬂows may exist, one must make sure
that both plus and minus values of the variables are computed correctly.
Equation (4.28) is the inverse form of a nonlinear relation as indicated by
Eq. (4.21). When a linear relation can be assumed as shown in Eq. (4.22), the
inverse relation is much simpler:
Q3 = P3/R3.
(4.29)
Chapter 5 will present methods for deciding which causal form of resistance
laws are required for formulating the state equations of a system to be analyzed
or simulated.
4.3.2
Fluid Capacitance
As shown in Table 3.2, a ﬂuid capacitor imposes a relationship between a pressure
(an effort variable) and the integral of the volume ﬂow rate (a displacement
variable). This integrated variable is a volume of ﬂuid in the cases at hand.
Figure 4.24 shows the common case in which capacitors are combined with
common effort junctions (0-junctions). The nonlinear form of the capacitance
constitutive relation for the bond graph of Figure 4.24a is
P3 = −1
C (V3),
(4.30)
where
V3 =
 t
0
Q3dt.
(4.31)
If the capacitor can be considered to be linear, a capacitance parameter, C 3,
can be deﬁned and the capacitor law of Eq. (4.30) simpliﬁes to
P3 = V3/C3.
(4.32)
The 0-junction laws are
P1 = P2 = P3
and
Q3 = Q1 −Q2,
(4.33)
so V 3 in this case is the integral of the difference in the volume ﬂow rates Q1
and Q2.

126
SYSTEM MODELS
0
C
P3
.
P1
Q1
Q3 = V3
P2
Q2
Q1
Q2
Q1
Q1
Q2
Q2
Q3
P1 = P2 = P3
P1, P2, P3
P1, P2, P3
(a)
(b)
g
l
r0
r0
l
(c)
(d)
Δr
FIGURE 4.24. Fluid capacitors: (a) bond graph; (b) water tank; (c) rigid pipe segment;
(d) elastic pipe segment.
The ﬁrst example, shown in Figure 4.24b, is a straight-walled water tank in
a gravity ﬁeld. In this case V 3 is the volume of water that has been stored in
the tank. If h represents the height of the water above the horizontal connecting
pipes, then the pressure at the bottom of the tank is just the hydrostatic value of
ρgh. (Strictly speaking, this is the gage pressure, counting atmospheric pressure
to be zero. We also assume that the bottom of the tank is essentially at the
location of the EET junction connecting the pipes. The little stub shown entering
the tank bottom is supposed to be very short.).
If the tank area is A3, the volume of water in the tank, V 3, is A3h, and the
pressure at the bottom of the tank is therefore
P3 = ρgV3/A3.
(4.34)
Comparing Eqs. (4.34 and 4.32) we see that the capacitance of the tank is
C3 = A3/ρg.
(4.35)
A gravity tank with straight sides can be represented as a linear ﬂuid capacitor.
The next example shown in Figure 4.24c is a segment of a rigid pipe that has
a physical volume of
V0 = πr2l.
(4.36)

HYDRAULIC AND ACOUSTIC CIRCUITS
127
For a truly incompressible ﬂuid, the volume ﬂow rate into the pipe, Q1, and
the ﬂow rate coming out of the pipe, Q2, would have to be equal, and thus the
ﬂow Q3, according to Eq. (4.33), would be zero. On the other hand, if Q1 and
Q2 were not exactly equal, Q3 would represent the rate of compression of the
ﬂuid in the pipe. More important, V 3 according to Eq. (4.31), would represent
the decrease in volume of the ﬂuid in the pipe segment.
For liquids such as water or hydraulic oil that are only slightly compressible,
a bulk modulus B is deﬁned by the relation (see Reference [6])
dP = −B(dV |V ).
(4.37)
The minus sign in Eq. (4.37) is due to the fact that when the volume of the
ﬂuid increases incrementally by an amount dV , the pressure decreases by the
amount dP. For the capacitance model we will extend the relation of Eq. (4.37)
to small but ﬁnite changes and note that 	 V 3 represents a small decrease in the
volume of ﬂuid in the pipe segment, so the minus sign in Eq. (4.37) disappears
and the capacitance law for the pipe segment is
	P3 = (B/V0)	V3,
(4.38)
where V 0 comes from Eq. (4.36) and the 	 may be eliminated if it is remembered
that P3 and V 3 in the bond graph of Figure 4.24a represent deviations from
steady-state values in this case.
Comparing Eq. (4.32) with Eq. (4.38), we see that the capacitance for the rigid
pipe segment is
C3 = V0/B.
(4.39)
The Appendix gives values for the bulk modulus for some common liquids.
If the ﬂuid is a gas and if the pressure and volume variations are small enough
that the so-called acoustic approximation is valid, another relation can be given
relating pressure change to volume change (Reference [7]):
	P3 = ρ0c2V3/V0,
(4.40)
where ρ0 is the density of the gas at the reference pressure and c is the speed of
sound. This means that the capacitance for this case is
C3 = V0/ρ0c2.
(4.41)
Densities and speeds of sound for common gases can be found in the
Appendix.
Figure 4.24d shows a case in which the capacitance in a ﬂuid system is due
to the elasticity of the vessel containing the ﬂuid, rather than the compressibility
of the ﬂuid itself. The pipe segment has thin walls and is made of an elastic
material. (It might represent a nonmetallic hydraulic brake line, for example.)

128
SYSTEM MODELS
An approximate analysis will be made in which 	V 3 represents the increase
in volume of the pipe segment due to an increase in pressure with the ﬂuid
being assumed incompressible. The stress and strain effects in the longitudinal
direction will be neglected, and only the volume change due to the hoop stress
in the pipe will be computed.
An elementary analysis yields the hoop stress in the pipe:
σ = r0P/tw,
(4.42)
where r0 is the nominal pipe radius and tw is the (small) wall thickness. The
circumferential strain is then
ε = σ/E = r0P/twE = 	(2πr)/2πr0 = 	r/r0,
(4.43)
where E is the elastic modulus (see the Appendix). The change in volume is
	V = 	(πr2l) = πl2r0	r.
(4.44)
Combining Eqs. (4.43) and (4.44), yields
	V = (2πlr3
0/twE)	P = (2r0V0/twE)	P.
(4.45)
In terms relating to the bond graph of Figure 4.24a the result is
	P3 = (twE/2r0V0)	V3.
This means that the capacitance due to pipe elasticity is
C3 = 2r0V0/twE.
(4.46)
Combining Capacitances. It sometimes happens that both ﬂuid compressibility
and pipe elasticity contribute to a compliance effect. One possibility is to use
two separate bond graphs like Figure 4.24a in cascade with parameters for the
two cases of Figure 4.24c and d, but another possibility is to construct a single
equivalent compliance. Figure 4.25 shows another way to think about the two
sources of compliance. Bond 3 in the ﬁrst bond graph has a C-element dealing
with ﬂuid compressibility with capacitance from Eq. (4.39), and bond 4 has
a compliance dealing with pipe wall elasticity and using a capacitance from
Eq. (4.46). The 4-port 0-junction implies that all bonds have the identical pressure
and that the algebraic sum of the ﬂows (considering the sign half-arrows) add to
zero. The bond graph implies that the difference between Q1 and Q2 is the sum
of Q3 and Q4, that is, the difference between inlet and outlet ﬂows is partly due
to ﬂuid compression and partly to pipe expansion. After integration, the volume
variables are related as follows:
	V3 + 	V4 =
 t
0
(Q1 −Q2) dt.
(4.47)

HYDRAULIC AND ACOUSTIC CIRCUITS
129
0
C
C
V0/B
2r0V0/twW
Q3
Q4
P3
P1
P1
P2
P2
P4
Q1
Q1
Q2
Q2
0
C
Ceq
FIGURE 4.25. Single equivalent capacitance for liquid compressibility and pipe
elasticity.
Using the capacitances from Eqs. (4.39) and (4.46) and calling the common
pressure 	P, Eq. (4.47) becomes
(V0/B + 2r0V0/twE)	P =
 t
0
(Q1 −Q2) dt,
(4.48)
which implies that capacitances add on a 0-junction. The equivalent single capac-
itance shown in Figure 4.25 is just
C3 = V0(1/B + 2r0/twE).
(4.49)
Note that this formula enables one to decide whether ﬂuid compressibility or
pipe wall elasticity is the more important factor or whether both effects should
be considered together. Both effects have to do with the volume of the pipe
segment, but other physical parameters and dimensions are also involved.
Nonlinear Capacitances. Although much of the dynamic modeling of ﬂuid sys-
tems can be usefully accomplished using linearized component laws, there are
circumstances in which nonlinear models are essential. This is the case for some
types of ﬂuid resistance and for some ﬂuid capacitance devices. Consider, for
example, the compressed gas accumulator shown in Figure 4.26. It consists of
a pressure vessel in which a ﬂexible bladder contains a compressed gas. Such
devices are often used to smooth out pressure and ﬂow ﬂuctuation in hydraulic
systems or to provide short bursts of power under transient conditions.
The incompressible ﬂuid ﬂow, Q3, compresses the gas in the bladder, and the
volume of the compressed gas determines the pressure in the accumulator and
at the 0-junction. Under dynamic conditions, the gas usually does not have time
to exchange much heat with its surroundings. If this is the case, the isentropic
pressure–volume law
PV γ = P0V γ
0 = constant
(4.50)
is a good approximation. In this equation, γ is the ratio of speciﬁc heats at
constant pressure and volume (see the Appendix), P and V are the instantaneous
pressure and volume of the gas, and P0 and V 0 are values at some initial time.

130
SYSTEM MODELS
Q1
Q1
P1
P2
Q2
Q2
Q3
0
C
Rubber bladder
Compressed gas
.
Q3 = V3
FIGURE 4.26. Compressed gas accumulator.
The bond graph of Figure 4.26 indicates that the gas volume is
V = V0 −V3 = V0 −
 t
0
Q3 dt =
 t
0
(Q1 −Q2) dt.
(4.51)
This means the nonlinear capacitance relation between P3 and V 3 is
P3 = P0V γ
0 /(V0 −V3)γ ,
(4.52)
upon use of Eq. (4.50).
4.3.3
Fluid Inertia
The ﬁnal passive 1-port element that needs to be discussed for ﬂuid circuits
concerns the inertia associated with ﬂuid in a pipe segment. Table 3.3 shows that
ﬂuid systems have inertia effects analogous to those of mechanical and electrical
systems, but for most people the variables involved, volume ﬂow rate and pressure
momentum are much less familiar than the corresponding mechanical or electrical
variables. Also, as we will see, the inertia coefﬁcient for a ﬂuid circuit element
is related to the parameters of a pipe segment in a counterintuitive way.
Figure 4.27 shows the simplest case of a straight pipe section of area A and
length l ﬁlled with a ﬂuid of density ρ. The bond graph shows the common
situation in which the 1-port appears connected to a 1-junction. In this case, the
volume ﬂow rates at both ends of the pipe are equal and the pressure difference
acting on the inertia element is
P3 = P1 −P2.
(4.53)
The pressure momentum variable for the inertia element, as deﬁned in
Table 2.4, is
PP3 ≡
 t
P3 dt =
 t
(P1 −P2) dt.
(4.54)

HYDRAULIC AND ACOUSTIC CIRCUITS
131
l
Area A
1
I
.
Q1
Q1
Q2
Q2
Q3
P1
P1
P2
pP3 = P3
P2
FIGURE 4.27. Fluid inertia for a pipe segment.
A linear inertia coefﬁcient for this I -element is deﬁned by a relation between
the volume ﬂow rate and the pressure momentum:
I3Q3 = pP3 or Q3 = pP3/I3.
(4.55)
A simple derivation of the inertia coefﬁcient for this case involves writing
Newton’s law for the ﬂuid in the pipe. (A more thorough analysis is given in
Section 12.4.1.) Assuming that the slug of ﬂuid in the pipe moves as a rigid
body, its velocity is Q3/A, its acceleration is ˙Q3/A and its mass is ρAl. The net
force accelerating the slug involves the pressure times the area at the two ends,
P1A −P2A. Then Newton’s law becomes
(ρAl) ˙Q3/A = (P1 −P2)A.
(4.56)
Using Eqs. (4.53), (4.54), and (4.55), the results are
(ρl/A) ˙Q3 = P3
(4.57)
or
(ρl/A)Q3 = pP3,
(4.58)
which means that the inertia coefﬁcient is
I3 = ρl/A.
(4.59)
This coefﬁcient for the inertia of ﬂuid in a pipe segment is analogous to the
mass for a body in translation or the inductance in an electric circuit.
It is no surprise that the inertia coefﬁcient is proportional to the mass density
and length of the ﬂuid slug, but that it is inversely proportionate to the area seems
counterintuitive. The reason is that we are using pressure and volume ﬂow rate
as effort and ﬂow variables instead of force and velocity. Many engineers have
assumed that narrow tubes would exhibit little inertia effect since they contain

132
SYSTEM MODELS
little ﬂuid mass, but, in fact, the narrower the tube, the more inertia the ﬂuid in the
tube will have when it is used in a ﬂuid circuit. Oddly enough, ﬂuid circuits with
long, small-diameter pipes react sluggishly, as would mechanical systems with
large masses.
As discussed in Section 12.4.1, the inertia coefﬁcient for a pipe whose area
varies with distance s along the pipe, A(s), is given by the formula
I3 =
 t
0
ρds/A(s),
(4.60)
which shows that it is the parts of the pipe where the area is the smallest that
contribute the most to the inertia coefﬁcient.
It should be noted that although the inertia formula, Eq. (4.59), applies to
both hydraulic systems and acoustic systems, there is a subtlety connected with
the inertia coefﬁcient for an open-ended pipe in an acoustic circuit. If the pipe
is unﬂanged, the length in Eq. (4.59) should be corrected by adding about 0.6
times the radius to the physical length at both ends. This takes into account
the radiation impedance associated with the connection to the atmosphere (see
Reference [7], Section 9.2).
4.3.4
Fluid Circuit Construction
Hydraulic and acoustic circuits have a lot in common with electrical circuits.
Remember that for electrical circuits, it was easy to establish a 0-junction for
each location in a circuit at which a voltage could be deﬁned. The passive 1-
port elements were then inserted between the appropriate 0-junctions using 1-
junctions to establish the voltage differences acting on the elements. Finally, one
of the 0-junctions was picked as representing a reference or ground voltage and
was eliminated together with all the bonds emanating from it. For ﬂuid circuits,
pressures act like voltages and volume ﬂow rates act like electrical currents, so
a short version of the circuit construction procedure is as follows:
1. Show positive directions for ﬂuid ﬂows and pressures on a schematic
diagram.
2. For each distinct absolute pressure establish a 0-junction.
Attach elements if they happen to react to one of the absolute pressures.
If necessary, include a 0-junction for atmospheric pressure.
3. Insert R-, C-, and I -elements between appropriate 0-junctions using
1-junctions.
The 1-junctions, (with through power signs) establish pressure differ-
ences, which act on passive elements.
4. The 0-junction for atmospheric pressure can be eliminated if “gage”
pressures are to be used.

HYDRAULIC AND ACOUSTIC CIRCUITS
133
5. Simpliﬁed the graph.
If there are any 2-port 0- or 1-junctions with through-sign-convention
half-arrows or branches that resulted in reducible loops, it will be possible
to simplify the graph.
Figure 4.28a shows a hydraulic pump–motor unit with a pressure-relief-valve
bypass. We shall assume the pump to be a ﬂow source, the relief valve and
motor both to be resistances, and the reservoir to be at atmospheric pressure.
For now we shall not deal with the fact that both the pump and the motor are
transducers relating hydraulic and mechanical powers. We also shall ignore the
ﬁlter. In Figure 4.28b the two distinct pressures are identiﬁed. In part c the
pump, valve, and motor are inserted. This is a correct bond graph model. Next
we deﬁne the pressure at B with respect to atmospheric pressure and eliminate
the PA junction. Simpliﬁcation yields the system bond graph of Figure 4.28d.
The model now deals with “gage” pressures.
FIGURE 4.28. A hydraulic pump–motor unit.

134
SYSTEM MODELS
Frequently, hydraulic elements must be represented that do not show their
pressure points quite so distinctly as in the previous example. Consider a length
of ﬂexible line connecting a pump to a load. If the line is long, if the pressure
varies rapidly or widely, or if great accuracy in prediction is required, it may
be necessary to include the effects of ﬂuid inertia in the line, the ﬂexibility of
the line walls, and the internal line resistance to ﬂow. In fact, all these effects
are distributed throughout the line. Fortunately, it is often possible to get good
predictive models by making a few simple assumptions. A long, ﬂexible line
is shown in Figure 4.29a. In part b a simple dynamic model indicating inertia,
resistance, and compliance is shown; notice the pressure points deﬁned in the
process. The inertia acts to generate a ﬂow (Q12) in dynamic response to a pres-
sure difference (P1 −P2). The resistance also generates a ﬂow (Q23) in response
to a pressure difference (P2 −P3). Wall compliance generates a pressure (P3)
(relative to atmosphere) in dynamic response to a net ﬂow. These pressures are
FIGURE 4.29. Hydraulic system with a long, ﬂexible line.

HYDRAULIC AND ACOUSTIC CIRCUITS
135
displayed in Figure 4.29c. Elements are inserted as shown in part d. The inertia
and resistance effects are inserted directly; the compliance goes between local
pressure and atmospheric. Finally, the pump is added as a pressure source, the
load as a resistance, and the graph is simpliﬁed. All pressures are measured
relative to atmospheric pressure.
Inspection of Figure 4.29e with regard to the line model itself shows that
a simple 1–0 structure with I , R, and C attached is the basic 2-port line rep-
resentation. By subdividing the line, making such a model for each unit, and
then adjoining them port to port in cascade, a model of greater accuracy (albeit
greater complexity) can be constructed. This approach applies equally well to
many other types of devices that are distributed, such as rods, shafts, plates, and
electrical lines. It is discussed in more detail in Chapter 10.
4.3.5
An Acoustic Circuit Example
Figure 4.30 shows a reactive type of mufﬂer that works primarily through the
interaction of inertia and capacitive effects. (This is why it is called a reactive
mufﬂer.) Part a of the ﬁgure represents a cross section of a straight-through design
consisting of a shell divided into two cavities, of volumes V c and V b, and by
an internal plate and having two tubes allowing a steady ﬂow to pass through.
An imposed ﬂow, having both steady and pulsating components, is imposed at
the left side and a ﬂow exits at the right into the atmosphere. If the mufﬂer is
effective, the pulsating components of the ﬂow at the exit should be reduced, as
compared with the input ﬂuctuations for the frequency range of interest.
For this example, we will assume that the frequencies of interest are suf-
ﬁciently low that the tubes can be represented as a single I -element and the
cavities can be represented by C-elements. For higher frequencies, a much more
complex model might be required similar to the long line model shown in
Figure 4.29. (It should also be noted that this model applies better to an air-
conditioning duct mufﬂer in which the acoustic approximation is valid than to
an automobile mufﬂer that has very large pressure ﬂuctuations from the engine
exhaust ports.).
The bond graph shown in Figure 4.30b can be constructed by following the
procedure outlined above. First, we establish three 0-junctions for the pressures
Pa, Pb, and Pc. The I -elements representing the tubes are inserted between the
appropriate 0-junctions using 1-junctions, as in Figure 4.27. A minor compli-
cation at the exit is the R-element representing the radiation impedance of the
ﬂow as it enters the inﬁnite atmosphere. It is a standard exercise in acoustics to
derive an expression for this impedance and to show that for low frequencies, the
impedance can be represented as a resistance and an added inertia effect. The iner-
tia effect can be included by assuming that the ﬁnal tube is longer than its physical
length by an amount called the end correction, which has been mentioned pre-
viously. (For a more thorough discussion of these effects, see Reference [7],
Sections 8.12 and 9.3.)

136
SYSTEM MODELS
Q0(t)
Q0(t)
Qcb
Qcb
Qcb
Qba
Qba
Qba
Qba
Pc
Pc
Pc
Vc
Vb
Pb
Pb
Pb
Pa
Pa
0
0
1
(a)
1
1
C
C
I
I
R
e
S
Sf
(b)
0
0
1
1
C
C
I
I
R
f
S
(c)
0
FIGURE 4.30. Low-frequency shell and tube reactive mufﬂer model.
The ﬂow through the radiation impedance R-element is the same as the ﬂow
through the last tube, so an extra 1-junction is used. Equivalently, a single 4-port
1-junction could be used for the I - and R-elements.
The atmospheric pressure is set by an effort source, and the internal pressures
are set by capacitances, as in Figure 4.24. The input ﬂow is determined by a
ﬂow source. The capacitance parameters are evaluated using Eq. (4.41), and the
inertia parameters using Eq. (4.59).
A simpliﬁcation is possible if all pressures are deﬁned as deviations from
atmospheric pressure. This means that Pa ≡0 and allows all bonds on which
atmospheric pressure appears to be eliminated. When this is done and a 2-port
1-junction with a through sign convention to the R-element is eliminated, the
bond graph of Figure 4.30c results.
Although the techniques and limitations of modeling hydraulic and acoustic
circuits are quite complex in detail, it should be clear that there is a useful analogy
between ﬂuid and electrical circuit models.
4.4
TRANSDUCERS AND MULTI-ENERGY-DOMAIN MODELS
Transducers are devices that couple subsystems of distinct energy domains. For
example, there are electromechanical devices such as motors, generators, and
relays, there are hydraulic-mechanical devices such as pumps, motors, and rams,

TRANSDUCERS AND MULTI-ENERGY-DOMAIN MODELS
137
and there are even devices such as electrohydraulic valves that involve electrical,
mechanical, and hydraulic power. Chapter 8 deals in some detail with various
types of transducers, so here we will discuss only some relatively simple transduc-
ers based on 2-port transformers and gyrators. Some of these devices have already
been shown schematically in Figures 3.8 and 3.9. These common transducers
will allow the modeling of multi-energy-domain systems using bond graphs.
A major reason for studying bond graphs is that they provide a uniform and
precise way to represent system models when several forms of power and energy
are involved in a system to be modeled. Bond graphs practically force the modeler
to consider how power and energy are conserved across an ideal transducer and
how added R-elements modeling dissipative effects account for efﬁciencies of
less than 100% for real devices. Finally, it is straightforward to add I - and
C-elements to a bond graph to model the dynamics of transducers.
4.4.1
Transformer Transducers
Some transducers are quite easy to understand. Consider, for example, the
hydraulic ram shown in Figure 3.8e and again in Figure 4.31.
From the schematic diagram in Figure 4.31a, it is clear that the pressure in
the hydraulic ﬂuid acts on the piston face of area A to create a force. It should
also be clear that the velocity of the piston times the area equals the volume ﬂow
rate, Q. Thus, the ideal transducer is represented by the bond graph in part b,
which implies the Eqs. (3.10) given previously in Chapter 3:
F = AP,
AV = Q,
FV = PQ,
(4.61)
Note that the sign-convention half-arrows are consistent with the schematic
diagram. If at some instant the force and velocity are positive in the directions
P
Q
F
A
V
(a)
TF
1
0
TF
A
A
R
R
F
F
V
V
P
P
Q
Q
(b)
(c)
FIGURE 4.31. Hydraulic ram transducer: (a) schematic diagram; (b) ideal transformer
model; (c) friction and leakage resistors added.

138
SYSTEM MODELS
indicated, then mechanical power is being supplied to the device and hydraulic
power is being delivered to some other device. This “through” power convention
for transformers ensures that the area A that appears twice in the equations has
the same sign both times. (When the sign half-arrows do not ﬂow through the
transformer, then–A must appear in one of the equations and the mechanical
power would always be the negative of the hydraulic power.)
Actually, the ideal transformer transducer really applies only to the effects at
the face of the piston. All real devices contradict the idea that mechanical power
can be converted with no loss to hydraulic power. As pointed out in Chapter 8, the
modeling of a real transducer involves adding a number of elements to the ideal
transducer to account for power losses and, possibly, for inertia and capacitance
dynamic effects as well. Part c of Figure 4.31 shows how loss effects could be
added to the simple ideal model.
On the mechanical side, the added 1-junction and resistor are used to include
mechanical friction effects. Typical pistons have piston rings or packing that
introduce frictional forces on the piston. This means that the net force on the
piston rod is not just AP but also includes the frictional force. The 1-junction
adds the forces and also enforces that the piston rod, the friction force element,
and the piston all have the same velocity, V . Since the piston ring R-element can
only absorb power, the hydraulic power will now be less than the mechanical
power at the piston rod. On the hydraulic side, the combination of the 0-junction
and resistance represent possible leakage past the piston. The pressure at the
hydraulic outlet, that on the piston face, and that at the piston ring leakage
location are assumed to be equal. The 0-junction makes the volume ﬂow rate out
of the ram to be AV minus the leakage ﬂow through the leakage resistor. This
hydraulic resistor also reduces the power efﬁciency of the transducer.
Positive displacement hydraulic pumps and motors consist of a number of
pistons and a mechanism for moving them back and forth as a function of the
angular position of a shaft. When there are a fairly large number of pistons, say
seven or nine, the angular speed of the shaft ω is related to the volume ﬂow rate
Q by a nearly constant coefﬁcient, T. (The coefﬁcient actually varies a little with
the position of the shaft. This makes the ﬂow rate have a little ripple on top of a
steady ﬂow when the shaft rotates steadily.) Considering that the hydraulic ram
can be represented by a transformer, it is not surprising that positive displacement
machines can also be modeled using transformers, as shown in Figure 4.32.
In part a, the schematic diagram shows the torque and the angular speed of the
shaft and the pressures at the inlet and outlet ports PA and PB. When the leakage
is negligible, the same ﬂow Q enters and leaves the device. The hydraulic power
has to do with the ﬂow Q and the pressure difference PB −PA.
The ideal model of the pump or motor is shown in bond graph form in
Figure 4.32b. You should check to see that the 1-junction half-arrows correctly
relate the pressures PA, PB and (PB −PA). If the transduction coefﬁcient relating
angular speed and volume ﬂow rate is deﬁned by the relation
T Q = ω,
(4.62)

TRANSDUCERS AND MULTI-ENERGY-DOMAIN MODELS
139
Q
Q
PA
PA
PB − PA
τ
ω
TF
τ
ω
1
Q
(b)
(a)
T..
PB
PB
FIGURE 4.32. Hydraulic pump or motor modeled using a transformer.
then it follows that the torque–pressure relation must be
PB −PA = T τ,
(4.63)
since the power relation for the ideal case must be
(PB −PA)Q = τω.
(4.64)
The choice of signs on the transformer may seem to indicate that the model
represents a pump, but even with these sign choices, the mechanical and hydraulic
powers could both be negative, indicating that the device model could as well
represent a hydraulic motor.
Although the bond graph in its present form is ideal with no losses and no
dynamic behavior, it should be clear that the model could be augmented by
adding resistors to model losses, as was done in Figure 4.31, and one could add
an I -element on a 1-junction on the mechanical side to represent the moment of
inertia of the rotating parts. Chapter 8 discusses the modeling procedure based
on starting with an ideal model and then adding loss and dynamic elements as
appropriate.
4.4.2
Gyrator Transducers
While many types of transducers that can be represented as transformers are easily
understood, those represented by gyrators often seem harder to understand. The
importance of electromechanical transducers, such as rotary and linear motors or
voice coils in electrodynamic loudspeakers, justiﬁes a short discussion of why
gyrators are used to describe a number of useful devices.
Figure 4.33 shows the basis of the gyrator models. A current-carrying con-
ductor is moving in a magnetic ﬁeld under the action of an applied force that is
equal but opposite to a magnetic force. Because of the motion of the conductor,
a voltage is induced in the conductor.
Because all the various vectors are at right angles to each other, the laws
governing this situation take particularly simple forms. Faraday’s law of magnetic

140
SYSTEM MODELS
voltage,e
l, length
V, velocity
F, applied force
 
magnetic force, Fm
magnetic flux density, B
current,i
Bl
GY
F
V
e
i
FIGURE 4.33. Gyrator model of a current-carrying conductor moving in a magnetic
ﬁeld.
induction relates the induced voltage to the velocity:
e = BlV.
(4.65)
The Lorentz force law relates the applied force to the current:
Bli = F.
(4.66)
Note that, by multiplying Eq. (4.65) by Eq. (4.66), the electrical and mechan-
ical powers are shown to be always equal,
ei = FV,
(4.67)
and in both Eqs. (4.65 and 4.66) an effort at one port is related to a ﬂow at
the other port. Thus, the power-conserving 2-port transducer of Figure 4.33 is
properly represented as a gyrator.
Just as the simple case of the hydraulic ram leads to the representation of
hydraulic pumps and motors as transformers, so too does the case of a conductor
in a magnetic ﬁeld lead to the representation of electric motors and generators as
gyrators. Figure 4.34 shows several representations of dc motors or generators.
Internally, most motors have complex arrangements of coils of wires carrying

TRANSDUCERS AND MULTI-ENERGY-DOMAIN MODELS
141
dc motor/generator
transduction
coefficient, T
i
i
ω
τ
GY
(a)
(b)
L
R
J
e
e
i
ω
τ
GY
1
1
I
I
R
T
e
i
e
i
τ
ω
τ
ω
(c)
(d)
T
FIGURE 4.34. Motor/generator models: (a) sketch of device; (b) bond graph of ideal
model; (c) schematic diagram of extended model; (d) bond graph of extended model.
currents moving in magnetic ﬁelds. In the case shown, it is assumed that the
ﬁeld is due to permanent magnets and a commutator or other means switches
the coils of wire in such a way that the voltage at the terminals induced by the
rotary motion is essentially proportional to the angular speed of the rotor. In
addition, the torque produced is proportional to the current at the terminals of
the device. (More detailed models of motors are able to predict minor ripples
in the torque of actual dc motors as well as small voltage ﬂuctuations in dc
generators.)
Using the symbol T as a transduction coefﬁcient, the equations for the ideal
model of Figure 4.34b are
e = T ω,
T i = τ,
ei = τω.
(4.68)
The gyrator correctly represents the essence of the transduction process, but
in many cases it needs to be supplemented to model real devices that are never
completely ideal. The schematic diagram of Figure 4.34c indicates that the wind-
ings of the motor have inductance and resistance and that the rotor has a moment
of inertia, J . Part d of the ﬁgure shows an extended bond graph including these
effects. The 1-junction on the electrical side enforces the fact that the same
current ﬂows from the terminals through the inductance and the resistance and
participates in the transduction.
On the mechanical side, the 1-junction indicates that there is a single angular
velocity for the output shaft, the rotary inertia, and the transduction process. In
this model, the electrical power is not instantaneously equal to the mechanical
power, as it was for the ideal gyrator model. Not only is there now a loss
element, R, but also the I -elements can store and release energy during transient

142
SYSTEM MODELS
conditions. The idea of starting with ideal transducers and adding realistic effects
is developed further in Chapter 8.
4.4.3
Multi-Energy-Domain Models
Figure 4.35a shows a system for positioning a machine tool table bed. It includes
an electric dc motor connected to a power supply driving a hydraulic pump. The
power supply is modeled as a voltage source. The motor and pump may run
continuously, because the combination valve (with handle position variable, x)
can recycle some of the hydraulic ﬂuid to the sump and can divert some of the
ﬂow to the hydraulic motor. The hydraulic motor in turn drives a rack and pinion
arrangement that moves the table bed.
There are a number of transducer devices in this system. The dc motor
changes electrical power to mechanical power, and the hydraulic pump and motor
exchange mechanical and hydraulic power. One could even consider the rack
and pinion as a transducer between rotary and translational mechanical power.
(A transformer represents the rack and pinion, because the contact radius of the
dc
motor
pump
sump
motor
valve
table bed
rack and pinion
e
i
ω
Ω
V
0
P
P1
P2
P3
(a)
TF
1
1
0
1
R
R
0
x
x
x
P1
(b)
P0
Se
1
GY
1
I
R
I
R
i
ω
Se
1
GY
1
I
R
I
R
i
ω
TF
1
0
1
0
I
R
P2
P3
1
0
1
I
R
P2
P3
P1
TF
TF
1
I
R
Ω
V
TF
TF
1
I
R
Ω
V
R
R
x
x
(c)
voltage
source
FIGURE 4.35. An electrical–hydraulic–mechanical system: (a) schematic diagram;
(b) bond graph including atmospheric pressure; (c) bond graph using gage pressures.

TRANSDUCERS AND MULTI-ENERGY-DOMAIN MODELS
143
pinion relates the angular velocity of the pinion to the linear velocity of the
table, as well as the force on the table to the torque on the pinion.) This system
is intended to demonstrate that bond graph models are capable of representing
multi-energy-domain systems in a uniform and precise manner.
The schematic diagram of the system shown in part a of Figure 4.35 shows a
number of important system variables, such as pressures and angular velocities,
but it does not make clear just how the various devices are to be modeled. The
ﬁrst stage in the construction of the bond graph for the system shown in part
b of Figure 4.35 begins to make clear the assumptions that are being made to
model the various devices.
The left side of the bond graph in part b represents the voltage source and the
dc motor. The motor model of Figure 4.34 has been used with some modiﬁcations.
The ﬁrst I - and R-elements clearly represent the inductance and resistance of the
armature windings, but the next I –R combination attached to the 1-junction, with
ω as the common ﬂow, requires some explanation. The I -element represents not
only the rotary inertia of the motor, as in Figure 4.34, but also the inertia of the
pump, since both devices are assumed to rotate with the same angular speed ω.
The R-element represents frictional losses associated with both the electric motor
and the pump.
Transformers represent the hydraulic pump and motor, as in Figure 4.32. The
hydraulic pressures P0, P1, P2, and P3 are represented as existing on 0-junctions,
as in the hydraulic circuit construction method described in Section 4.3.4. A study
of the sign half-arrows will reveal that the pressure difference acting on the pump
is P1 −P0 and the pressure difference acting on the motor is P3 −P0.
The line between the pump outlet and the combination valve has been modeled
as an I –R combination that includes ﬂuid inertia, as in Figure 4.27, and ﬂuid
resistance, as in Figure 4.23. Evidently, no ﬂuid or pipe compliance effects are
included in the model. This is a modeling decision that may or may not be
justiﬁed in a particular case. In any case, the bond graph is absolutely clear
about which possible effects are included in the model and which are not.
The combination valve has a variable resistance reacting to the pressure differ-
ence P2 −P0 and another variable resistance reacting to the pressure difference
P2 −P3. Both these valve resistances change with the handle position, x. The
double-arrow active bond carrying the variable x indicates this. It is thus assumed
that moving the handle does not transfer any signiﬁcant power to the system,
although the handle position does change the valve resistance laws relating pres-
sure and volume ﬂow rate.
Finally, the rack and pinion transformer connects the hydraulic motor to the
table bed model, which is represented by an I -element for the table mass and an
R-element for the table friction.
The last step to arrive at the bond graph of Figure 4.35c is to consider that
the atmospheric pressure P0 is zero. This allows three bonds to be removed and
several 2-port 0- and 1-junctions with “through” sign half-arrows to be eliminated.
This procedure is similar to the procedure for electrical circuits, but in this case

144
SYSTEM MODELS
the result is that the efforts representing pressures are to be considered gage
pressures.
As this example should make clear, there is an art, as well as a science, to mak-
ing a useful mathematical model. There is a scientiﬁc basis for the ideal models
that involve power or energy conservation, and these are elegantly incorporated
in bond graph elements. However, there are a number of effects that can be added
to the ideal elements to account for effects that occur in real systems. These extra
loss and dynamic elements must be added with restraint, since an unduly com-
plicated model that is hard to understand is often just as bad as an oversimpliﬁed
model. In every case the model should be adjusted to provide guidance for the
speciﬁc problems at hand. The best model is generally the simplest model capa-
ble of demonstrating those aspects of the behavior of the system that need to be
understood.
Good modelers are always ready to modify a preliminary model by simplifying
it, by removing elements, or by adding elements to bring in new effects. Often
the changes are suggested based on the results of analysis or simulation of the
model, particularly if there is a lack of agreement between the model predictions
and experimental results.
REFERENCES
[1] D. K. Schroder, Semiconductor Material and Device Characterization, New
York: Wiley, 1998.
[2] J. L. Merriam and L. G. Kraige, Engineering Mechanics: Statics and Dynam-
ics, 4th ed., New York: Wiley, 1997.
[3] A. G. Bose and K. N. Stevens, Introduction to Network Theory, New York:
Harper & Row, 1965.
[4] R. H. Sabersky, A. J. Acosta, and E. G. Hauptmann, Fluid Flow: A First
Course in Fluid Mechanics, 2nd ed., New York: Macmillan, 1971.
[5] J. F. Blackburn, G. Reethhof, and J. L. Shearer, Fluid Power Control, New
York: Wiley, 1960.
[6] J. Thoma, Modern Hydraulic Engineering, London: Trade and Technical
Press, 1970.
[7] L. E. Kinsler, A. R. Frey, A. B. Coppens and J. V. Sanders, Fundamentals
of Acoustics, 3rd ed., New York: Wiley, 1982.
PROBLEMS
4-1. Make a bond graph model for each of the following electrical circuits. Use
the inspection method whenever possible. If the circuit has voltage and
current orientations, make the bond graph have equivalent power direc-
tions.
Note: The E-meter may be modeled as an open-circuit pair, and the auditor
may be modeled as a resistance, RA.

PROBLEMS
145

146
SYSTEM MODELS
4-2. Make a bond graph model of each of the electrical networks shown below.
4-3. Make a bond graph model of each of the translational mechanical systems
shown below.

PROBLEMS
147
4-4. Find a bond graph model for the following mechanical networks.

148
SYSTEM MODELS
4-5. For the following mechanical systems involving ﬁxed-axis rotation, ﬁnd
a bond graph model in each case. In the rack-and-pinion system shown,
several frictionless guides and bearings are omitted for clarity.

PROBLEMS
149
4-6. Two hydraulic systems that are closely related but not identical are shown
below. Make a bond graph model for each.
4-7. A simpliﬁed model of a water storage system is shown below. Assume the
three tanks behave as (nonlinear) capacitances. Assume the three conduits
have resistance only.
(a)
Make a bond graph model.
(b)
Introduce inertance effects for each of the conduits into your model
for (a).

150
SYSTEM MODELS
4-8. In the hydraulic system shown below, the pipes containing ﬂows Q4 and
Q5 have both inertia and friction effects present. The outﬂow line (Q6)
has only friction effects. The control pump maintains a desired ﬂow, QC ,
independent of pressure. Make a bond graph model of the system.
4-9. In the positive-displacement pump shown below, the piston moves back
and forth and the check valves act like unsymmetrical resistances, allowing
relatively free forward ﬂow while impeding the backﬂow greatly. Inertia
effects are important in the outlet line, while the nozzle is a resistive
restriction.
(a)
Make a bond graph model that can be used to relate the mechanical
port variables (F, V ) to the ﬂuid port variables (P, Q).
(b)
Noting that an electrical diode is analogous to a ﬂuid check valve,
use the bond graph of part (a) to ﬁnd an equivalent electrical network
to the pump system.

PROBLEMS
151
4-10. Consider a permanent-magnet generator of the type often used to power
bicycle lights:
(a)
Suppose the generator to be an ideal gyrator in its transducer action.
Make a bond graph model of the system.
(b)
Suppose the lamp shortcircuits. Is your model from (a) still useful?
If not, modify it so that it can handle this situation.
4-11. Two related hydraulic devices are shown below, a hydraulic jack and a ram.
(a)
If the inertia of the sliding parts and friction at the seals are important,
modify the models given in the ﬁgure for the devices to include these
effects.
(b)
If compliance of the working ﬂuid for the jack and of the shaft for
the ram is important, modify your models from (a) to include these
effects.

152
SYSTEM MODELS
4-12. A schematic diagram of a basic dc machine is shown below. The prin-
cipal electrical effects are armature resistance and inductance and ﬁeld
resistance and inductance. The coupling between armature and shaft pow-
ers is modulated by the strength of the magnetic ﬁeld, set by i f . A simple
assumption for coupling is
τ = T (if )ia = (Kif )ia
and
ea = T (if )ω = (Kif )ω
where T(i f ) is the modulating value, assumed linear with i f .
(a)
Make a bond graph model of the basic dc machine using a modulated
gyrator (MGY ) as the heart of the coupling.
(b)
Introduce mechanical rotational inertia and dissipation effects into
your model from (a).
(c)
Operate your model from (b) in the generator mode. What changes
must be made?
(d)
Calculate the power efﬁciency for the dc machine operating as a
motor and as a generator.
4-13. The network shown below includes a voltage-controlled current source.
Make a bond graph model of the network using an active 2-port as the
coupling element.

PROBLEMS
153
4-14. A load of mass M is suddenly dropped onto piston 1 from height L.
(a)
Make a bond graph model of the system, assuming piston 2 is locked
in place by pins. Also assume the load stays joined to piston 1.
(b)
If piston 2 is not locked in place, but pistons 1 and 2 were in equi-
librium before the load was dropped, modify the model in (a).
4-15. Model the spring-loaded accumulator device shown below. Include inertia
and dissipation effects.
4-16. For the device shown, construct a bond graph model. For the positive
directions indicated, assign a power convention.
m2
υ2
υ1
υi(t)
υ3
m1
m3
b
a

154
SYSTEM MODELS
4-17. The coupled mechanical and hydraulic system is used to isolate the mass,
m, from the ground motion, vi(t). Construct a bond graph model, show
your assumed positive e and f directions, and assign an appropriate power
convention.
Ap
At
Rf
If
vi(t)
Fluid-filled tube
of length L with fluid
inertia, If, and resistance, Rf
Air compliance, Ca
m
4-18. A quarter-car model of a vehicle is shown with an idealized actuator
capable of generating any control force, F c.
(a)
Construct a bond graph model, identify positive directions, and assign
a power convention.
υi(t)
ms
mu
(a)
ks
bs
kt
Fc
υ1
υ2
(b)
A voice coil actuator with winding resistance, Rw, is to be installed
as the force actuator to replace the idealized control force. The actu-
ator will be voltage, ec, controlled. Include the force actuator in the
quarter-car model and construct the overall bond graph model.

PROBLEMS
155
winding resistance, Rw
coil length, l
permanent magnetic with ﬂux density B
transduction constant T = BL
force, F = Ti
(b)
υ2
ec
i
υ1
F
4-19. The hydraulic piston cylinder device is a fundamental component of many
motion control systems. Hydraulics can generate large forces over large
distances, which is necessary for big motion platforms such as ﬂight sim-
ulators. The ideal form of the device shown is a transformer, as indicated
in the bond graph.
Ar
Ap
Q1
Q2
Q1
Q1
υ
F
P1
P2
Q2
Q2
P1
p1
P2
p2
υ
F
(a)
(b)
0
0
1
TF
TF
Ap
:
Ap – Ar
Ap – Ar
v
F
Mass, m
Friction
Volume
compliance, C2
Volume
compliance, C1
Leakage
resistance, RL
Ap
Ap
An actual device has inertia, friction, leakage past the piston, and compliance
ofthevolumesofoilonbothsidesofthepiston.Fortherealisticeffectsshown,
construct a bond graph model and assign a power convention.

156
SYSTEM MODELS
4-20. Shock absorbers for automobiles are very sophisticated devices. The pis-
ton head has several levels of check valves to generate a force–velocity
characteristic quite different from what might be expected from simply
forcing oil through an oriﬁce. Also, to provide volume for the piston rod
as the shock is compressed, most shock absorbers are of a twin-tube con-
struction, as shown below. The valve that connects the inner and outer
tubes is called the foot valve.
v2
v1
F
Ap
Ar
Oil
Piston resistance, Rp
Air
Foot valve resistance, Rf
Outer tube
Inner tube
(a)
Construct a bond graph model incorporating the dynamic elements
shown and assign a power convention.
(b)
State your assumptions about more realistic dynamic effects and
include them in your model.
4-21. Install the shock absorber model from Problem 4-20 into the quarter-car
model of Problem 4-18. Replace the damper with the shock model.
4-22. The system is similar to the example system of Figure 4.14. For this
problem, the lever has mass, m, and center of mass moment of inertia,
J l. In addition, the pivot point has prescribed vertical motion set by the
speciﬁed velocity, vi2(t). The spring at the left end has prescribed vertical
velocity at the top, and there is a mass with spring and damper attached
at the right end of the lever. The lever executes plane motion since it
simultaneously translates and rotates.
(a)
Derive the kinematic constraints for this system by relating vl, vi2,
and vm to the center of mass velocity and angular velocity, vg and ω.
(b)
State whether springs and dampers are positive in compression or
tension and construct a bond graph model for this system.

PROBLEMS
157
vi1(t)
k1
k2
vl
vm
m
a
b
g
bd
vi2(t)
vg
ω
ml, Jl
4-23. Masses m1 and m2 move only horizontally. Mass m1 has an input force
prescribed, and m2 has an attached spring, k. The two masses are connected
by a rolling element of mass, mc, center of mass moment of inertia, J c,
and radius, R. The rolling element rolls without slip at the contact point
with each mass.
v1
v2
m1
m2
k
F(t)
vc
ωc
mc, Jc
R
(a)
Derive the kinematic constraints relating the mass velocities v1 and
v2 to the velocity and angular velocity of the rolling element.
(b)
Construct a bond graph model of this system and show an appropriate
power convention.
4-24. A gantry robot is a large manufacturing machine that consists of a very
stiff table-like structure, atop which sits a platform that can be driven in
the XY -plane. Suspended below the platform is the robot arm that will
have a cutting tool of some kind attached at its lower end. The robot arm
can be moved vertically, and the cutting tool can be moved in several
directions. The result is a multiaxis cutting tool that can create large 3-D
shapes. Although gantry robots are made as stiff and rigid as possible,
sometimes small motions at the cutting tool end can limit the speed or
precision of the machine.

158
SYSTEM MODELS
F(t)
kτ
θ, θ = ω
.
k
m
b
vm
vB
vT
vg
arm of mass, ma,
moment of
inertia about the
center of mass, Ja
and length, L
A simple model of the gantry robot is shown in the ﬁgure. An input
force, F(t), is used instead of the actual drive motors, and the top of the
arm is constrained to move horizontally. The arm is rigid and has mass,
ma, moment of inertia about the center of mass, J a, and length, L. The
center of mass is located in the middle of the arm. The ﬂexibility in the
frame is represented by the torsional spring, kτ, and the load being cut is
represented by the spring, mass, damper, k, m, b, attached to the lower
end of the arm. We desire a model that will allow the prediction of the
motion–time history of the system for small angular deﬂections. Perhaps
we can come up with some control strategy for the drive motors that will
limit the vibratory motion of the arm end. For now,
(a)
Derive the kinematic constraints relating vT and vB to the arm
motion, vg, and ω.
(b)
Construct a bond graph model of this system and show an appropriate
power convention.
4-25. Consider a simple model of a so-called Helmholtz oscillator formed by
attaching a circular tube of diameter d and length l to a larger circular tube
of diameter D and length L that is sealed at the end to form an acoustic
volume.
d
D
l
L
1
I
C

PROBLEMS
159
Using the elementary bond graph shown, which neglects any resistance
effects, the natural frequency of the oscillator is given by the formula
ωn = (1/IC)1/2[rad/s] or fn = (1/IC)1/2/2π[cycles/s] or [Hz].
(a)
Using the formulas for acoustic inertia and capacitance given in the
text, ﬁnd an expression for ωn and f n in terms of the dimensions of
the device.
(b)
What would be the natural frequency in air at standard conditions if
d = 0.01 m and D = l = L = 0.1 m? Do you think you could hear
this frequency if you blew across the end of the open tube as you
would across an empty bottle?
4-26. Consider a length of hydraulic hose to be used to operate the ram of a
high-speed actuator. There is a concern that the compliance in the sys-
tem may slow down the system response. You are to decide whether the
hydraulic compliance due to the compressibility of the hydraulic ﬂuid or
the ﬂexibility of the hose walls is most important. Use these dimensions:
nominal radius of the hose 15 mm, wall thickness 5 mm. Assume that the
modulus of elasticity for the hose is about the same as for hard rubber and
the bulk modulus for hydraulic oil has the value given in the Appendix.
4-27. Consider a system that is a combination of Figure 4.28 and Figure 4.29.
That is, a hydraulic pump is connected to a hydraulic motor by one line
to a relief valve and by another line from the valve to the motor. In the
new system, both lines are long and to be represented by a combination
of inertia, resistance, and capacitance, as in Figure 4.29. In addition, both
the pump and the hydraulic motor are positive displacement machines,
represented as in Figure 4.32. The hydraulic motor is driven by a dc
electrical motor as represented by the gyrator in Figure 4.34.
The load that the hydraulic motor drives can be represented by a com-
bination of a rotary mechanical inertia and a rotary resistance. Show a
complete bond graph for the system after setting the atmospheric pressure
to zero (using gage pressures).
4-28. The ﬁgure shows an accumulator similar to the one in Figure 4.26. In this
case, there is a distinction between the ﬂuid pressure P3 and the pressure
of the gas in the rubber bladder under some conditions. Before the ﬂuid
system is pressurized, when P3 is zero, the pressure in the gas is P0
and the volume of the gas is V 0. The bladder has a rigid section at the
base that prevents it from expanding into the inlet pipe. Until the ﬂuid
pressure exceeds P0, no ﬂuid enters the accumulator; Q3 = 0. However,
after some ﬂuid has entered the accumulator, the gas is compressed and
the gas pressure and the ﬂuid pressure are essentially identical.
Consider the volume of ﬂuid that has entered the accumulator, V3 =
 t
0 Q3 dt, to be zero at t = 0 when the system is unpressurized. Make

160
SYSTEM MODELS
a sketch of the nonlinear capacitance relationship between P3 and V 3
using the isentropic assumption discussed in the text. Note that the P3 can
rise to P0 even when V 0 = 0 and that P3 →∞when V3 →V0.
Q3
P3
P0, V0
4-29. The ﬁgure shows a pipe of area a and length l, containing hydraulic ﬂuid,
connected to a hydraulic ram of area A. This combination will eventually
be used to model a hydraulic system, and the concern is whether the pipe
hydraulic inertia, ρl/a, is signiﬁcant in comparison with the mass, m, of
the ram and its connected load mass.
A
a
m
l
Q
V
I
I
1
TF
1
P
P
Q
Q
V
V
1
TF
eq
I
A
A
F
F
The bond graph on the right shows the two inertia elements separately, and
the one on the left shows the two inertias combined into a single equivalent
inertia associated with the velocity of the ram, V . One way to compute the
equivalent inertia is to express the kinetic energy T = mV 2/2 + IQ2/2
(where I = ρl/a) in terms of the mass velocity by recognizing that the
mass velocity and the volume ﬂow rate are related by the transformer law
Q = AV .
(a)
Give an expression for the equivalent inertia (or equivalent mass) of
the ram and pipe combination.

PROBLEMS
161
(b)
Perform a sample calculation to ﬁnd out what radius the pipe should
have to make the ﬂuid inertia of the pipe have the same effect on the
effective mass of the system as the mass of the ram and load mass.
Use the following parameters:
ρ = 900 [kg/m3],
l = 0.5 [m],
m = 740 [kg],
A = πR2,
R = 50 [mm],
a = πr2
Answers:
(a)
Ieq = (m + ρlA2/a),
(b)
a = ρlA2/m, r = 15 [mm].
4-30. The ﬁgure shows the physical part of a load-positioning system without the
sensors and the controller electronics that control the voltage source. You
are to make a bond graph model of the system, including the following
effects:
voltage
source
load
mass
E(t)
dc motor
V1
V2
ω
(a)
The voltage is a controlled effort source. Indicate this by including
a signal or active bond with a double arrow impinging on an effort
source.
(b)
The dc motor has inductance and resistance in the armature coils.
(c)
Include a rotary inertia for the motor armature and the screw drive.
(d)
Use a resistor to model the friction moment associated with the motor
and the screw drive.
(e)
A constant S relates the angular velocity of the screw with the nut:
V1 = Sω.
(f)
The tube connecting the nut with the load mass is elastic with a
spring constant k.
(g)
The load mass has signiﬁcant friction with the ground.

5
STATE-SPACE EQUATIONS
AND AUTOMATED SIMULATION
In Chapter 4, bond graph models were developed for many physical engineering
systems. We ﬁrst treated each energy domain separately, but our goal was always
to connect the energy domains into overall system models using the same symbols
and structure for the entire system. This was done in Section 4.4 and will continue
to be done for the rest of this text. The nine basic bond graph elements are capable
of representing a very large cross section of engineering systems.
One reason for constructing bond graph models will become apparent in this
chapter. It will be demonstrated just how straightforward it is to derive system
equations and to obtain computer solutions to these equations. In some cases we
can go from a bond graph directly to a simulation using a computer program
without ﬁrst obtaining equations of motion manually. This is particularly impor-
tant when part of the model involves nonlinear constitutive laws since analytical
results are rarely possible for such models.
In other cases, when linearized equations of motion are appropriate, we can use
them to obtain analytical information about the system behavior. The real virtue
of bond graph modeling becomes overwhelmingly apparent when one considers
that, from a bond graph point of view, all systems models use the same symbols.
Thus, only one formulation and solution procedure is needed for any of the
systems we model.
To emphasize the virtue of having a formulation procedure that works for any
bond graph, consider the physical system shown schematically in Figure 5.1a for
part of an electric power steering system. A dc motor with winding resistance,
Rw, rotor inertia, Jm, and rotary damping, bτ, drives a ﬂexible output shaft of
rotary stiffness, kτ. The shaft is connected to a rack and pinion setup where the
gear has contact radius, R, and the rack has mass, m. The rack is attached to a
spring and damper with parameters k and b. We desire to predict the motion of
this system for a voltage input to the motor.
162
System Dynamics: Modeling, Simulation, and Control of Mechatronic Systems, Fifth Edition
Dean C. Karnopp, Donald L. Margolis and Ronald C. Rosenberg
Copyright © 2012 John Wiley & Sons, Inc.

STATE-SPACE EQUATIONS AND AUTOMATED SIMULATION
163
ei
i
Rw
Jm, bτ
qm
wm
wm
wp
wp
te
qp
R
m
xm
vm
kτ
k
b
(a)
i
Rw
ei
emf
bτθm
.
kτ(θm−θp)
F
F
kxm
bxm
.
(b)
0
1
I:Jm
R:bτ
C:kτ
Se
TF
GY
1
1
R:b
R:Rw
I:m
C:1/k
ei
T
R
(c)
vm
:
:
FIGURE 5.1. Part of an electric power steering system.

164
STATE-SPACE EQUATIONS AND AUTOMATED SIMULATION
Without a procedure for deriving equations of motion, one might start by
drawing a free-body diagram of the entire system. This is done in Figure 5.1b.
The electric circuit voltage, emf, is the back emf of the motor. The electrical
torque, τe, is the torque on the rotor due to the electromechanical coupling of
the motor. The torque in the output shaft is shown acting on the rotor and the
gear. And the internal force, F, is shown acting on the gear and the rack. With
bond graphs, we always deﬁne efforts and ﬂows, regardless of the energy domain
involved. This is done in the system schematic diagram. The more conventional
approach to formulation often starts with displacement variables, and these are
also indicated in the schematic.
The next step is to use Kirchhoff’s law for the circuit, with the result
ei −Rwi −emf = 0.
(5.1)
Then use Newton’s laws for translation and rotation, with the result
τe −bτ ˙θm −kτ(θm −θp) = Jm ¨θm,
(5.2)
F −kx −b ˙x = m¨x.
(5.3)
We must recognize the kinematic, no-slip constraint between the pinion gear
and the rack,
˙x = R ˙θp,
(5.4)
and the moment equilibrium for the inertia-free pinion gear,
kτ(θm −θp) = FR.
(5.5)
At this point it might be useful to count the unknowns and see how we
are doing. The unknowns are i, emf, τe, θm, θp, x, and F. Thus, we have seven
unknowns and ﬁve equations. We are not done yet. The missing information is
the electromechanical physics relating the electrical torque to the current and the
back emf to the motor speed. These relationships are
τe = Ti, emf = T ˙θm,
(5.6)
where T is the coupling constant for the motor. We now have equal numbers of
equations and unknowns and can theoretically proceed to a solution.
If we were to pursue this example further, we would next have to ﬁgure
out substitutions to make to eliminate unwanted variables while retaining desired
variables. There is no set procedure for this substitution; we just use our intuition
and start substituting. If we are successful at coming up with a computable set
of equations, the act of doing so will not beneﬁt us much the next time we are
confronted with a new physical system.

STANDARD FORM FOR SYSTEM EQUATIONS
165
With bond graphs there is a deﬁnite procedure for choosing the proper vari-
ables. There is also a procedure for deriving a computable set of equations. It
is the same procedure each time equations are derived. If one struggles the ﬁrst
time, it will be a little easier the second time, and easier each successive time.
Figure 5.1c is a bond graph of the example system. All the dynamic elements in
the schematic diagram are included in the bond graph. (Problem 5-16 revisits this
system.) You will be surprised to learn how easy it is to derive the governing
equations for system models using bond graph techniques compared with the
unstructured conventional approach illustrated above. The formulation procedure
is presented next.
5.1
STANDARD FORM FOR SYSTEM EQUATIONS
One of the most remarkable features of bond graphs is that a study of equation
formulation may be carried out prior to writing any equations. To understand how
this can be so, we ﬁrst consider some particular forms of equations that are used
to represent a system, and select one form—the state-space type—as our primary
goal. All the models of dynamic systems discussed in this text involve ordinary
differential equations. (Some models do represent approximations for the partial
differential equations of distributed systems such as transmission lines.)
There are two limit forms for systems of differential equations, plus a
wide range of possibilities within these limits. An nth-order system may be
represented by
1. A single nth-order differential equation in terms of one unknown variable
2. n ﬁrst-order coupled differential equations in terms of n unknown variables,
or
3. Various combinations of unknowns and equations of appropriate orders (not
necessarily equal)
Many important mathematical problems, methods, and results are organized
in terms of the ﬁrst form. At ﬁrst, almost all engineering mathematics was cast
in that form. The second form has certain advantages that have recommended it
to mathematicians∗for development of theory, but, even more important from
our point of view, it is a convenient form for use by engineering system analysts,
control engineers, and people conducting digital and analog computer studies. An
interesting example of the third form is to be found in the sets of second-order
equations generated by the Lagrangian approach to system analysis.
To illustrate each of the forms, and to give an appreciation of some of the
differences, let us consider the mechanical double-oscillator example shown in
∗See, for example, G. D. Birkhoff, Dynamical Systems, Providence, RI: American Mathematical
Society, 1966.

166
STATE-SPACE EQUATIONS AND AUTOMATED SIMULATION
FIGURE 5.2. Mechanical double-oscillator example.
Figure 5.2. There are several choices of unknowns available. First, let us choose
the position x2 and describe the system in terms of that single displacement. The
system equation in terms of x2 turns out to be
¨¨x2 +
 k2
m2
+ k1
 1
m1
+ 1
m1

¨x2 + k1k2
m1m2
x2 = k1
 1
m1
+ 1
m2

g.
(5.7)
If a Lagrange equation approach is used, with x3 and x4 (the spring extensions)
shown in Figure 5.1b as the generalized coordinates, the following pair of coupled
second-order equations may be developed:
¨x3 + k1
 1
m2
+ 1
m1

x3 −k2
m2
x4 = 0,
¨x4 −k1
m2
x3 + k2
m2
x4 = g.
(5.8)
Finally, if one concentrates closely on the energy in the system, associating a
momentum or displacement variable with each distinct energy element, a set of
four coupled ﬁrst-order equations in terms of p1, p2, x3, and x4 may be found,
as shown in Eq. (5.9). Clearly, this set could also be converted to a geometric-
variable form by replacing the momentum variables by the velocities to which
they are related:
˙p1 = −k1x3 + m1g,
˙p2 = k1x3 −k2x4 + m2g,
˙x3 = p1
m1
−p2
m2
,
˙x4 = p2
m2
.
(5.9)

STANDARD FORM FOR SYSTEM EQUATIONS
167
It is possible, in principle, to transform from one of the given forms to any
other, whether the system is linear or nonlinear. However, for nonlinear systems
the desired transformations may be very difﬁcult to discover. Furthermore, if
one starts with the form (5.7), for example, choosing additional unknowns is
a rather haphazard process unless one has considerable insight into the system
being studied. Yet if a physically meaningful set of variables is already available
(e.g., as displayed by (5.9)), elimination of unwanted variables can be carried out
with considerable insight.
In studying engineering systems using bond graphs, there is an ideal oppor-
tunity to start the formulation in terms of signiﬁcant physical variables and to
generate simultaneous sets of ﬁrst-order equations from the bond graphs. This is
the approach we shall follow. When the system being studied is nonlinear, the
form we seek is given by
˙x1(t) = φ1(x1, x2, . . . , xn;
u1, u2, . . . , ur),
˙x2(t) = φ2(x1, x2, . . . , xn;
u1, u2, . . . , ur),
...
˙xn(t) = φn(x1, x2, . . . , xn;
u1, u2, . . . , ur),
(5.10)
where the xi are the state variables, the ˙xi are the time derivatives of the xi, the
ui are inputs to the system, and the φi are a set of static (or algebraic) functions.∗
If the system is linear, Eqs. (5.10) take on a simpler form:
˙x1(t) = a11x1 + a12x2 + · · · + a1nxn + b11u1 + b12u2 + · · · + b1rur,
˙x2(t) = a21x1 + a22x2 + · · · + a2nxn + b21u1 + b22u2 + · · · + b2rur,
...
˙xn(t) = an1x1 + an2x2 + · · · + annxn + bn1u1 + bn2u2 + · · · + bnrur,
(5.11)
where the aij and bij are constants in most cases. The example Eqs. (5.9) are of
the type of Eq. (5.11).
For linear systems, equations of the form (5.11) can be put into a standard
matrix formulation,
˙X = AX + BU,
(5.11a)
where X is the vector of state variables,
X =
⎡
⎢⎢⎢⎢⎣
x1
x2
•
•
xn
⎤
⎥⎥⎥⎥⎦
,
∗This simply means that, given the values of the arguments on the right-hand side of Eq. (5.4),
a set of values for the derivatives may be found by algebraic means.

168
STATE-SPACE EQUATIONS AND AUTOMATED SIMULATION
and U is the vector of inputs,
U =
⎡
⎢⎢⎢⎢⎣
u1
u2
•
•
ur
⎤
⎥⎥⎥⎥⎦
,
The A-matrix is composed of the coefﬁcients, aij, where
A =
⎡
⎢⎢⎢⎢⎣
a11
a12
•
•
a1n
a21
•
•
•
a2n
•
•
•
•
•
•
•
•
•
•
an1
an2
•
•
ann
⎤
⎥⎥⎥⎥⎦
,
and the B-matrix contains the coefﬁcients, bij, where
B =
⎡
⎢⎢⎢⎢⎣
b11
b12
•
•
b1r
b21
•
•
•
b2r
•
•
•
•
•
•
•
•
•
•
bn1
bn2
•
•
bnr
⎤
⎥⎥⎥⎥⎦
.
We will discover how useful this formulation is when the system being studied
can be modeled as a linear one.
Our task for the rest of this chapter is to learn how to select signiﬁcant
system variables from among the many effort, ﬂow, momentum, and displacement
variables contained in a bond graph and to organize them into relations of the
form (5.10) or, for linear models, the matrix form (5.11a).
5.2
AUGMENTING THE BOND GRAPH
In the previous chapters we have developed an orderly procedure for representing
all kinds of interacting physical systems using bond graphs. At this point we
assume that a bond graph has been constructed and that an appropriate power
convention has been assigned. Before writing any equations, it is desirable to
prepare the bond graph with additional information that will make writing of
equations take on a very orderly pattern. Providing the additional information
consists of
1. Numbering all the bonds in consecutive order
2. Assigning to each bond a causal sense for the e and f variables
By numbering the bonds, every element and variable can be referred to unam-
biguously. Thus, I4 is the inertia on bond 4, e6 is the effort on bond 6, q11 is

AUGMENTING THE BOND GRAPH
169
the displacement on bond 11, and so forth. For beginners, it is suggested that
after the physical system has been modeled and a bond graph exists with phys-
ically motivated labels (e.g., mass, inductance, force, volume ﬂow, pressure or
piston area symbols) a second, identical bond graph be drawn without the phys-
ical labels but with bond numbers. We call this bond graph the computational
bond graph since it is easily processed by computers as well as humans. Since
bond graphs for all physical systems are so similar, it is also suggested that the
physically notated bond graphs be kept nearby so that the user can keep track of
the physical effects involved in the numbered bond graph.
The second step in the augmentation process is the assignment of causality.
Basic considerations of causality for the various elements were introduced earlier
(Section 3.4). It is now appropriate to apply such information to the entire system
in an orderly fashion.
In a causal sense there are two distinct types of bond graph elements. Source
elements (Se and Sf ) and junction elements (0, 1, TF, and GY ) must meet certain
causal conditions or their basic deﬁnitions are no longer valid. As an obvious
example, if a source of force does not have a causality showing that it applies
a deﬁned force on the system to which it is connected, then it has no meaning.
We generalize this observation and assert that every source element must have its
appropriate causal form assigned to it.
For each of the 2-port junction elements, TF and GY , there are two possible
causal forms that preserve the basic deﬁnition of the element. If neither of these
forms can be assigned, the concept of input and output associated with the element
is not valid. Consequently, we assert that every TF and GY must have one of its
two allowable causal forms assigned to it. The choice of form will generally
be indicated by the adjoining system on the basis of other considerations to be
discussed.
In a similar vein, we argue with respect to the ideal multiport junctions 0 and
1 that each 0 and 1 must have one of its appropriate causal forms assigned to it
or the basic deﬁnition of the particular element will not be valid. The selection
of a particular causal form will be motivated by other system considerations in
general.
If a system cannot meet the causal conditions outlined above, the basic phys-
ical model on which the bond graph is based must be restudied. The indications
are that an impossible situation has been created that is not capable of sensi-
ble mathematical resolution. Two such examples are shown in Figure 5.3. In
part a, source element 2 is deﬁned invalidly. Inspection of an electrical circuit
interpretation indicates the nature of the difﬁculty: obviously, a modeling error
has been made in putting two supposedly independent current sources in series.
(Each source seeks to impose its own current but the two must be equal if they
act in series.) In part c of Figure 5.3, a TF is found to have invalid causality.
If this bond graph were derived from a ﬂuid circuit, as shown in part d, the
interpretation would be that two independent pressure sources had been joined
by an ideal transformer of pressure (the TF), leading to a physically incompatible

170
STATE-SPACE EQUATIONS AND AUTOMATED SIMULATION
FIGURE 5.3. Two examples of invalid causality and physical interpretations.
situation. The next step is up to the system modeler, who must correct the model
in an appropriate way.
Continuing our discussion of assigning causality, we come to the energy
storage elements, —I and —C. Bond graphs “bookkeep” energy, and the instan-
taneous energy of the system is indicated by the energy variables (p’s on —I ’s
and q’s on —C’s) associated with the energy storage elements. The junction
structure elements,
— 0
| —, — 1
| —, —TF—, —GY—,
merely shuttle the power around between the source elements, the energy storage
elements, and the dissipative elements. We choose to use the energy variables as
the state variables for the systems we model. Knowledge of the energy variables
dictates the energy state of the system at each instant of time. As we shall see, an
energy storage element is independent if it can accept integral causality. Thus,
in our causal assignments, we make every effort to assign integral causality
to each energy storage element. We will see that this is not always possible.
If an energy storage element is forced to accept derivative causality, then that
element is not independent, and its energy variable is algebraically related to the
other energy variables in the system. The energy storage element in derivative
causality still stores energy, but its contribution to the system energy can be
calculated algebraically from knowledge of the other energy variables, and, if
the energy variable of the derivative element should happen to enter the equation
formulation, it can be eliminated from the ﬁnal state equations. Thus, for the
formulation procedure proposed here, the state variables are the p-variables on
I-elements and the q-variables on C-elements that are in integral causality.

AUGMENTING THE BOND GRAPH
171
At the system level the causality associated with R-elements is largely a matter
of indifference. The major exception is in the case of a nonlinear constitutive
law that is not bi-unique (e.g., Coulomb friction). Then the causality associated
with a unique input–output relation for the element should be used. Otherwise,
R-elements accept whatever causality they are assigned by other elements in the
system.
The basic causality assignment procedure is summarized as follows:
Sequential Causal Assignment Procedure
1. Choose any source (Se, Sf ), and assign its required causality. Immediately
extend the causal implications through the graph as far as possible, using the
elements (0, 1, GY , TF) which may be connected to the source. These four
elements called constraint elements because only certain causal patterns are
allowed.
2. Repeat step 1 until all sources have been assigned their required causality.
3. Choose any storage element (C or I ), and assign its preferred (integral)
causality. Immediately extend the causal implications through the graph as
far as possible, using the constraint elements (0, 1, GY , TF).
4. Repeat step 3 until all storage elements have been assigned a causality.
In many practical cases all bonds will be causally oriented after this stage. In
some cases, however, certain bonds will not yet have been assigned. We then
complete the causal assignment as follows:
5. Choose any unassigned R-element and assign a causality to it (basically
arbitrary). Immediately extend the causal implications through the graph as
far as possible, using the constraint elements (0, 1, GY , TF).
6. Repeat step 5 until all R-elements have been used.
7. Choose any remaining unassigned bond (joined to two constraint elements),
and assign a causality to it arbitrarily. Immediately extend the causal impli-
cations through the graph as far as possible, using the constraint elements
(0, 1, GY , TF).
8. Repeat step 7 until all remaining bonds have been assigned.
The procedure is straightforward and orderly. Some practice on examples will
convince you of the ease and rapidity with which causality can be assigned.
It is important to recognize that the constraint elements represent the physical
structure in the system (e.g., Kirchhoff’s voltage and current laws, Newton’s law
and geometric compatibility), and assigning causality to them means that they
will be used correctly in a particular input–output fashion. Further discussion of
the use and interpretation of causality in more complex bond graphs is given in
Chapter 7.
Several situations can arise when applying causality according to the procedure
given:

172
STATE-SPACE EQUATIONS AND AUTOMATED SIMULATION
1. All storage elements have integral causality, and the graph is complete after
step 4. This simple, common case is discussed in Section 5.3.
2. Causality is completed by using R-elements or bonds, as indicated in
steps 5–8. This situation is discussed in Section 5.4.
3. Some storage elements are forced into derivative causality at step 3. This
case is discussed in Section 5.5.
Now let us consider several examples of using the procedure.
Assignment of causality is carried out step by step in the example in Figure 5.4.
Part a shows a numbered bond graph without causality or power convention.
We would normally have assigned a power convention by the time we arrived at
causality assignment. However, to enforce upon the reader that power convention
and causality assignment are totally unrelated, we work a few examples in which
the reader is not distracted by a power sign convention.
A graph without causality is sometimes said to be acausal. In part b of
Figure 5.4 bond 1 is directed according to the meaning of the source element (a
source of ﬂow). Since the 0-junction connected to the source has only one ﬂow
variable determined, f1, the other bonds cannot yet be assigned a causality. (The
FIGURE 5.4. Causality assignment and complete augmentation of a bond graph.
Example 1.

AUGMENTING THE BOND GRAPH
173
3-port 0-junction 01,2,3 will have two ﬂow inputs and one effort input. We now
have determined only one of the two ﬂow inputs f1.)
There are no more sources, so we turn to step 3. In part c, C2 is put is put
into integral causality. Immediately, bond 3 must be causally directed because of
the 0-junction, which can have only one effort input, e2. However, bonds 4 and
5 are as yet undirected. (The 3-port 1-junction 13,4,5 will have two effort inputs
but only one ﬂow input. At this point we have determined only one of the effort
inputs, e3.)
Now I5 is assigned integral causality as shown in Figure 5.4d. Immediately,
bond 4 must be causally directed as shown, due to the 1-junction, 13,4,5, which
can have only one ﬂow input, f5. At this point, all bonds have been causally
oriented.
In part e we have added a set of power directions to the graph; the result
is a completely augmented bond graph. That is, the bonds are labeled, power
directions have been chosen, and causality has been assigned. Such a graph will
yield its state equations to us with very little resistance, as we shall show in the
next section. However, let us ﬁrst augment another graph or two to gain some
experience.
Figure 5.5 shows a bond graph derived from a ﬂuid example involving
pipes and reservoirs. There are three pressure sources (Se1, Se2, and Se3)
FIGURE 5.5. Augmentation of a bond graph. Example 2.

174
STATE-SPACE EQUATIONS AND AUTOMATED SIMULATION
feeding through three pipes (roughly, the 1-junction complexes) into a tank (the
0-junction and C10). In part a, the graph is labeled. In part b, bonds 1, 2, and 3
associated with the sources have been assigned causality. In each case no exten-
sion of causality was possible. In addition, bond 10 has been directed according
to integral causality for the element C10 and causality has been extended to
bonds 11, 12, and 13 by the 0-junction, because the common effort has been
determined by the e10 input.
In part c, I4 has been given integral causality which determines the causality
on bond 7 due to the 1-junction. The process continues with the assignment of
integral causality to I5 and I6 which determine the causality of bonds 8 and 9.
Finally, power directions have been added to produce the fully augmented graph
shown in part d. In the next section, we shall show how this graph yields four
ﬁrst-order equations with three inputs to the system.
As a ﬁnal example in this section, consider the acausal bond graph in
Figure 5.6a. The model is derived from a study of a pressure-controlled
valve and includes both mechanical and ﬂuid mechanical power. The elements
Se1 and Se2 represent sources of pressure and force, respectively, and the
element TF couples the two power domains. In part b, bonds 1 and 2 are
causally assigned, one at a time. The causal information cannot be extended
using constraint elements at this point. Bonds 3 and 4 are assigned next, and
causality is extended as shown in part c. Bond 4 causality does not extend to
FIGURE 5.6. Augmentation of a bond graph. Example 3.

BASIC FORMULATION AND REDUCTION
175
other bonds, but bond 3 has implications for bonds 8 and 9, as well as for bonds
10 and 11. Inspection of Figure 5.6d reveals that assigning causality to bond 5
(associated with the element I5) determines the causality on bonds 6 and 7. With
powers assigned as shown in part e, the bond graph is completely augmented.
Two further points may be made with respect to augmentation. The ﬁrst is that,
in assigning causality, the results do not depend on the order of bonds chosen
except in special circumstances to be discussed later in Section 5.4. The second
point is that assignment of causality and assignment of power directions are two
entirely independent operations. Either one may be performed ﬁrst. Typically,
power directions will be ﬁrst, but on occasion one may not bother to assign
powers in studying aspects of system equation formulation.
5.3
BASIC FORMULATION AND REDUCTION
Once a fully augmented bond graph model is available, the equations for the
system can be developed in a very orderly fashion. Frequently, when the system
is small or uncomplicated in structure, state-space equations can be written down
directly. However, as system size and complexity grow, the need for an organized
procedure for equation generation becomes apparent.
Very general and powerful procedures are available for producing sets of sys-
tem equations. In this section we concentrate on a basic pattern that is applicable
in a large majority of cases encountered in engineering practice. There are three
simple steps to be followed:
1. Select input and energy state variables,
2. Formulate the initial set of system equations,
3. Reduce the initial equations to state-space form.
Selection of inputs is straightforward. For each source element write on the
graph the input variable to the system. These variables will appear in the ﬁnal
state-space equations if they have any effect on system behavior. The list of input
variables will be called U .
As mentioned earlier, the state variables are the p-variables on the I -elements
and the q-variables on the C-elements that are in integral causality. For many
system models, we will discover that after assigning causality sequentially by
the rules of the previous section, all energy storage elements are in integral
causality and there are no unassigned bonds. It is this case that is discussed in this
section on basic formulation procedures. When this causal pattern emerges, then
explicit ﬁrst-order differential equations of the type indicated in Eqs. (5.10) for
nonlinear systems or Eq. (5.11a) for linear systems result, and equation derivation
is straightforward.
The state variables can be placed in a vector called the state vector, X. The
derivative of the state variables will always be either an effort or a ﬂow variable,
since ˙p = e and ˙q = f. On the computational bond graph it is convenient to

176
STATE-SPACE EQUATIONS AND AUTOMATED SIMULATION
FIGURE 5.7. Equation formulation. Example 1.
show ˙p’s as the efforts on the I -elements in integral causality and ˙q’s as the
ﬂows on C-elements in integral causality. In addition, it will prove useful to
indicate the co-energy variables on the energy storage elements. These are the
ﬂow variables on the I -elements and the effort variables on the C-elements. We
will discover that the co-energy variables will appear in the initial formulation
and then will be eliminated during the reduction process. As a ﬁrst example of
basic formulation, consider the augmented bond graph in Figure 5.7a, which
is repeated from Figure 5.4e. The causality has been assigned, and all energy
storage elements are in integral causality, all bonds have a causal assignment,
and there are no causal conﬂicts on the bonds of the constraint elements. The
state variables are q2 and p5. The formulation always starts by writing the rate
of change of a state variable equals an effort or a ﬂow. We then use causality
to track the efforts and ﬂow through the bond graph. Causality will show us the
substitutions to make to eliminate unwanted variables while retaining appropriate
ones, as the procedure leads us to explicit ﬁrst-order equations. It makes no
difference which state variable we start with. We will later learn that computer
programs exist that can derive the equations following the same rules we use.
These programs number the bonds consecutively and derive equations starting
with the state variable with the lowest bond number. We will do the same here.
Thus, starting with q2, we write,
˙q2 = f2,
(5.12)
and follow the causality of the model to direct us through the bond graph and
lead us directly to the state equations. From Figure 5.7 we see that f2 is an input
to the C-element and an output from the 0-junction. This causal output is caused
by the inputs, f1(t) and f3, and according to the power convention,
˙q2 = f1(t) −f3.
(5.13)

BASIC FORMULATION AND REDUCTION
177
The ﬂow f1(t) is the input ﬂow from the ﬂow source, and this variable is
known and remains in the formulation. (The notation f1(t) may be used to
remind us that f1 is a known input function of time.) The ﬂow, f3, is not wanted
in the formulation, so we must look further.
We just used f3 as an input to the 0-junction, but it is also an output from the
1-junction. It is true that f3 equals both f4 and f5, but it is caused by f5 (look
at the causality on the 1-junction). Thus, we write
˙q2 = f1(t) −f5.
(5.14)
The ﬂow, f5, is a co-energy variable and directly related to the state variable,
p5, through the constitutive relationship for the element. If I5 is a nonlinear
element, then
f5 = −1
I (p5),
(5.15)
and, if I5 is a linear element, as it is for this example, then
f5 = p5
I5
.
(5.16)
With this substitution we obtain the ﬁrst state equation as
˙q2 = f1(t) −p5
I5
.
(5.17)
The second state equation starts with
˙p5 = e5,
(5.18)
and we need to follow the causal path and track down e5. From Figure 5.7 we
see that e5 is an input to the I -element and an output from the 1-junction. The
1-junction indicates that e5 is caused by e3 and e4, and according to the power
convention,
e5 = e3 −e4;
(5.19)
thus,
˙p5 = e3 −e4.
(5.20)
Neither of these efforts is wanted in the ﬁnal formulation, so we must continue
to use causality to determine what substitutions to make. The effort e3 is an output
from the 0-junction and is caused by e2. But e2 is a co-energy variable and is
directly related to the state variable, q2, by the constitutive relationship for the
C-element,
e2 = −1
C (q2),
(5.21)

178
STATE-SPACE EQUATIONS AND AUTOMATED SIMULATION
or, for the linear element used in this example,
e2 = q2
C2
.
(5.22)
This substitution will be made in (5.20), but ﬁrst let’s track down e4. The
effort, e4, is an output from a resistance element where, in this causality,
e4 = R(f4),
(5.23)
or, for the linear assumption being used for this example,
e4 = R4f4.
(5.24)
Eq. (5.24) is used in (5.20) to eliminate e4, but we introduce, f4. This ﬂow
is a causal output from the 1-junction where the causal ﬂow input is the co-
energy variable, f5, which is directly related to the state variable p5, as indicated
in (5.16). Using the substitutions from (5.22), (5.24), and (5.16) in (5.20), we
obtain the second state equation as
˙p5 = (1/C2)q2 −(R4/I5)p5.
(5.25)
Equations (5.17) and (5.25) are the two state equations for this system. Since
this example is linear, the ﬁnal step is to place these equations into the standard
matrix form of (5.11),
d
dt
q2
p5

=

0
−1/I5
1/C2
−R4/I5
 q2
p5

+
1
0

f1(t).
(5.26)
This is the perfect starting point for analysis if the system is linear. One need
only follow the causality, and the substitutions needed to eliminate unwanted
variables while retaining state and source variables automatically occur. The
reader may not believe this yet, so we present a second example.
Figure 5.8 shows an augmented bond graph that originally came from an
electrical circuit. When causality was assigned, all energy storage elements ended
up in integral causality, and all bonds had a causal assignment. This is always an
indication that formulation of equations is straightforward. The state variables for
this example are the momentum variable on bond 2, p2, and the displacement
variable on bond 5, q5 and input variable is ei(t). If the physical bond graph
were nearby we would realize that the momentum variable is the ﬂux linkage
for the inductor of L2 henrys and the displacement variable is the charge on the
capacitor of C5 farads. The derivatives of the state variables are indicated on the
energy storage elements, as are the associated co-energy variables, f2 and e5.
The formulation starts by writing
˙p2 = e2
(5.27)

BASIC FORMULATION AND REDUCTION
179
e1(t)
1
FIGURE 5.8. Equation formulation. Example 2.
and then pursuing e2 by using the causality of the bond graph. The effort, e2, is
an output from the 1-junction and is caused by e1, e3, and e4, according to the
power convention; thus,
˙p2 = e1(t) −e3 −e4.
(5.28)
The effort, e1(t), is a source variable and remains in the ﬁnal equations. The
effort e4 is an output from the 0-junction and is caused by the causal input, e5.
But e5 is a co-energy variable directly related to a state variable by
e5 = q5
C5
.
(5.29)
Before substituting into (5.28), notice that e3 is an output from a resistance
with causality dictating
e3 = R3f3,
(5.30)
and f3 is caused by the co-energy variable, f2, and f2 is related directly to a
state variable by
f2 = (1/I2)p2.
(5.31)
Using (5.29), (5.30), and (5.31) in (5.28) yields the state equation
˙p2 = e1(t) −(R3/I2)p2 −(1/C5)q5.
(5.32)
The second state equation starts with
˙q5 = f5,
(5.33)
followed by using causality to track the path for f5. The ﬂow, f5, is the input to
C5 and the output from the 0-junction. This output is caused by the causal inputs
f4 and f6, according to the power convention; thus,
˙q5 = f4 −f6.
(5.34)

180
STATE-SPACE EQUATIONS AND AUTOMATED SIMULATION
The ﬂow f4 is the output from the 1-junction, caused by the co-energy variable,
f2, where
f2 = (1/I2)p2.
(5.35)
The ﬂow f6 is the causal output from a resistance, where causality indicates
that
f6 = −1
R (e6) = (1/R6)e6
(5.36)
for this linear example. But e6 is caused by the co-energy variable, e5, which is
directly related to a state variable according to (5.29). Using (5.35) and (5.36) in
(5.34) yields the ﬁnal state equation as
˙q5 = (1/I2)p2 −(1/R6C5)q5.
(5.37)
The ﬁnal step for linear systems is to put state equations (5.32) and (5.37)
into the standard matrix format,
d
dt
p2
q5

=
−R3/I2
−1/C5
1/I2
−1/R6C5
 p2
q5

+
1
0

e1(t).
(5.38)
Perhaps the reader is starting to see the power of using causality and the
equation formulation procedure presented in this section. Any approach to
equation derivation always requires elimination of some variables in favor of
others in order to end up with a computable set of equations. Bond graphs and
causality simply make the substitutions obvious so that appropriate variables are
eliminated while others are retained, without having to guess the appropriate
substitutions to make. One more example should be sufﬁcient to demonstrate
the consistency of our approach to the formulation of state equations.
Figure 5.9 is the augmented bond graph originally shown in Figure 5.6 for
development of causality. The bond graph represents a physical system with
hydraulic and mechanical parts. To keep track of what parts are hydraulic and
what parts are mechanical, we really need to have the physical bond graph.
For equation formulation, we need only have the augmented bond graph since
equation formulation follows the same procedure regardless of the physical sys-
tem. This example has a transformer that couples the hydraulic and mechanical
sides of the model. The modulus of the transformer is physically an area, A. In
Figure 5.9, the modulus, m, is deﬁned by noting the constitutive relationships for
the transformer. We will derive the equations in terms of the generic deﬁnition of
the transformer shown in the ﬁgure, but before we can actually use the equations
to predict system response, we will have to determine how the modulus, m,
relates to the area, A. (A physical variable bond graph would tell us whether m
as deﬁned is actually A or 1/A. How the transformer modulus is actually used
depends on the causality that was determined for the transformer bonds.)
The causal assignment once again yielded all energy storage elements in inte-
gral causality and no bonds were left unassigned. The state variables are q3, the

BASIC FORMULATION AND REDUCTION
181
FIGURE 5.9. Equation formulation. Example 3.
displacement variable on C3; q4, the displacement variable on C4; and p5, the
momentum variable on I5. The input variables from the sources are e1 and e2.
Also noted on the bond graph are the associated co-energy variables. Equation
derivation starts with
˙q3 = f3,
(5.39)
but
f3 = f9 −f10,
and
f9 = f8 = (1/R8)e8 = (1/R8)(e1 −e9)
= (1/R8)(e1 −e3) = (1/R8) (e1 −(1/C3)q3) .
(5.40)
The ﬂow f10 is the output ﬂow from the transformer, caused by the input
ﬂow, f11, according to
f10 = (1/m)f11 = (1/m)f5 = (1/mI5)p5.
(5.41)
Substituting (5.40) and (5.41) into (5.39) yields the ﬁrst state equation as
˙q3 = (1/R8) (e1 −(1/C3)q3) −(1/mI5)p5.
(5.42)
The second state equation is particularly simple,
˙q4 = f4 = f5 = (1/I5)p5.
(5.43)

182
STATE-SPACE EQUATIONS AND AUTOMATED SIMULATION
And the ﬁnal state equation is
˙p5 = e5 = e2 −e4 −e6 −e7 + e11.
(5.44)
The effort e2 is a source variable and remains in the ﬁnal formulation. The
effort e4 is directly related to a state variable,
e4 = (1/C4)q4.
(5.45)
The efforts e6 and e7 are outputs from resistances, where
e6 = R6f6 = R6f5 = (R6/I5)p5
e7 = R7f7 = R7f5 = (R7/I5)p5
(5.46)
and e11 is the output effort from the transformer,
e11 = (1/m)e10 = (1/m)e3 = (1/m)q3/C3.
(5.47)
Substituting (5.45), (5.46), and (5.47) into (5.44) yields the ﬁnal state
equation as
˙p5 = e2 −(1/C4)q4 −[(R6 + R7)/I5]p5 + (1/mC3)q3.
(5.48)
Equations (5.42), (5.43), and (5.48) are a complete set of linear state equations
and can be cast into the standard matrix format,
d
dt
⎡
⎢⎣
q3
q4
p5
⎤
⎥⎦=
⎡
⎢⎣
−(1/R8C3)
0
−(1/mI5)
0
0
1/I5
1/mC3
−1/C4
−(R6 + R7)/I5
⎤
⎥⎦
⎡
⎢⎣
q3
q4
p5
⎤
⎥⎦+
⎡
⎢⎣
1/R8
0
0
0
0
1
⎤
⎥⎦
e1
e2

.
(5.49)
We hope that by now the reader is convinced that by choosing the state
variables to be the p’s on I ’s and the q’s on C’s in integral causality, and by
following the input/output causal paths, the state equations are straightforwardly
derived. If the system is linear, then the resulting equations can be put into a
standard matrix format that is the perfect starting point for linear analysis, which
is covered in the next chapter. If the system is nonlinear, equations are still
derived easily by using bond graphs and causality, but there is no nice matrix
representation from which to launch an analysis. Instead, computer simulation
is required, which is covered later in this chapter and at an advanced level in
Chapter 13.
Unfortunately, models do not always lend themselves to straightforward for-
mulation. Sometimes modeling assumptions lead to perfectly good models that
have mathematical formulation difﬁculties. Such problems are the topic of the
next two sections.

EXTENDED FORMULATION METHODS—ALGEBRAIC LOOPS
183
5.4
EXTENDED FORMULATION METHODS—ALGEBRAIC LOOPS
Constructing models of physical systems always requires modeling assumptions.
Any physical system can be inﬁnitely complicated. It is we, as engineers, who
must construct models that are simple enough to work with and yet retain sufﬁ-
cient dynamics to answer the questions being asked. Along the way we decide
whether the mass of some component is important, whether a part is sufﬁciently
stiff to be modeled as rigid, whether components can be represented as linear
over some operating range, and so forth. The result of these assumptions can
sometimes lead to mathematical formulation problems that have nothing to do
with the quality of the model, yet they must be addressed in order to make use
of the model. One of these formulation problems is caused by algebraic loops.
This topic is discussed at an advanced level in Section 13.2 of Chapter 13. Here,
the basic problem is introduced.
Consider the physical system in Figure 5.10a. It consists of a mass, m, acted
upon by the input force, F(t). The mass is attached to some dampers and a
spring, as shown, and the spring has an input velocity at its right end, vi(t). The
mass velocity is labeled vm, and the attachment point of the dampers and spring
is indicated as v′. The dampers and spring are assumed positive in tension, and
mass at the attachment point of these elements, m′, is assumed to be negligible.
This model is perfectly reasonable, and yet it has a serious formulation problem
that is vividly exposed with the use of bond graph causality.
Figure 5.10b shows the bond graph for this system constructed using the
procedure for mechanical translation. Some liberty has been taken in that physical
labels are on the bond graph along with numbering the bonds. Normally, we
would have a physical bond graph and a separate computational bond graph.
Also in Figure 5.10b, causality has been assigned up through step 4 of the
sequential assignment procedure presented in Section 5.2.
From the sequential assignment of causality, the inertial element, I2, has set
the ﬂow input to the 1-junction, constraining bond 3 to have ﬂow output from the
1-junction. Since f3 is a causal ﬂow input to a 0-junction, there is no constraint to
assign further causality. The compliance element, C8, is in integral causality, and
e8 sets the effort on the 0-junction. This constrains the effort, e7, to be an output
from the 0-junction and an input to the 1-junction with bonds 5 and 6 unassigned.
At this point there are no further causal assignments that we are constrained to
make. Both of the energy storage elements are in integral causality, but there
remain causally unassigned bonds.
Whenever causality has been assigned according to the procedure of
Section 5.2 and one must proceed to step 5, because there are causally
unassigned bonds remaining, state equations of the form (5.10) or (5.11) cannot
be derived in the straightforward manner of the previous section. When this
situation arises, it means that there is an algebraic loop where some effort or
ﬂow variables are algebraically related to themselves as well as to other source
variables and state variables. We will demonstrate what happens if this condition
is ignored.

184
STATE-SPACE EQUATIONS AND AUTOMATED SIMULATION
vi(t)
v′
vm
F(t)
F(t)
m
b1
b2
k
m′
(a)
0
1
C:1/k
Se
Sf:vi(t)
1
0
I:m
R:b2
R:b1
1
2
3
4
9
8
6
7
5
vm
v′
(b)
0
1
R
C
e
S
Sf
1
0
R:b1
I
1
2
3
4
9
8
6
7
5
vm
0
1
R
C
e
S
Sf
1
0
R:b1
I
1
2
3
4
9
8
6
7
5
vm
(d)
(c)
:
FIGURE 5.10. Extended formulation—algebraic loop. Example 1.

EXTENDED FORMULATION METHODS—ALGEBRAIC LOOPS
185
The procedure for handling algebraic loops is to ﬁrst make an arbitrary causal
assignment on one of the causally unassigned bonds and then propagate the
causal information as far as possible. If the causality completes after one arbitrary
assignment, then there is one algebraic loop. If a second arbitrary assignment is
required, then a second algebraic loop is present, and so on. The more loops
involved, the more difﬁcult the ﬁnal formulation becomes. In Figure 5.10c an
arbitrary assignment has been made on R4, which remained causally unassigned
after the sources and energy storage elements had been assigned according to the
procedure. The effort, e4, has been assigned as an output from the R-element.
This requires e5 to be an output from the 0-junction, and now with e5 and e7 as
inputs to the 1-junction, we are constrained to have R6 in the causality indicated.
Thus, making one arbitrary assignment has yielded a causally complete bond
graph, and thus there is only one algebraic loop for this example.
From the appearance of Figure 5.10c, one would not realize that there is a
problem. The bond graph causality is complete, all energy storage elements are in
integral causality, and there are no causal conﬂicts. Let’s see what happens if we
attempt to derive the state equations using the procedure of the previous section.
The state variables are p2 and q8, and the co-energy variables are f2 and e8. The
input variables from sources are e1 and fa. Then,
˙p2 = e1 −e3 = e1 −e4 = e1 −R4f4 = e1 −R4 (p2/I2 −f6) .
(5.50)
So far, all looks ﬁne. But,
f6 = (1/R6)e6 = (1/R6)(e5 −e7) = (1/R6) (e4 −(1/C8)q8) ,
(5.51)
and
e4 = R4f4 = R4(f3 −f5) = R4 (p2/I2 −f6) = · · ·
(5.52)
The ﬂow, f6, in Eq. (5.52) comes from Eq. (5.51), which leads back to e4
again and we ﬁnd ourselves in an endless loop of substitutions. This loop is not
the fault of bond graphs. It is a direct result of the modeling assumptions that
went into the schematic of Figure 5.10a. However, bond graphs and causality let
you know there is a problem before any equations are derived.
The procedure for handling algebraic loops is to ﬁrst recognize the problem
from the resulting incomplete causality. This is followed by making an arbitrary
causal assignment and extending the information according to the sequential
assignment rules. This continues until all bonds are assigned. While it makes
no difference which bond is selected for the arbitrary assignment, it is recom-
mended from step 5 of the sequential causality assignment procedure that when
a resistance element is involved in the algebraic loop (i.e., it has a causally unas-
signed bond), the resistance element be chosen for the arbitrary assignment. This
was done in Figure 5.10c where the element R4 was chosen for the arbitrary
assignment.

186
STATE-SPACE EQUATIONS AND AUTOMATED SIMULATION
As mentioned earlier, an algebraic loop is an indicator that some effort or ﬂow
variable involved in the loop is algebraically related to itself and other source
and state variables. The next step in the procedure is to derive this algebraic
relationship. When a resistance element is involved in the loop, it is customary
to choose the variable that was arbitrarily selected to be the output from the
R-element and the input to the rest of the system. For the example here, since
R4 was assigned arbitrarily, we select e4 as the variable to be related to itself.
Thus, we write e4 on the left-hand side of an equation and then use causality in
the normal way to derive the desired relationship, thus,
e4 = R4f4 = R4(f3 −f5) = R4 ((1/I2)p2 −f6) = R4 ((1/I2)p2 −(1/R6)e6)
= R4 ((1/I2)p2 −(1/R6) (e4 −(1/C8)q8)) .
(5.53)
Equation (5.53) is an algebraic relationship that relates e4 to source variables,
state variables, and to e4 itself.
The next step is to solve the resulting relationship for the algebraic variable,
e4 in this case,
(5.54)
e4 =
(R4/I2)
(1 + R4/R6)p2 + (R4/R6C8)
(1 + R4/R6)q8.
The ﬁnal step is to derive the state equations following the standard procedure,
only stop the formulation when the algebraic variable enters the formulation. For
our example,
˙p2 = e1 −e3 = e1 −e4,
˙q8 = f9 + f7 = f9 + f6 = f9 + (1/R6) (e4 −(1/C8)q8) .
(5.55)
We now substitute (5.54) into (5.55) and end up with the state equations in
standard explicit form,
˙p2 = e1 −
(R4/I2)
(1 + R4/R6)p2 −(R4/R6C8)
(1 + R4/R6)q8,
˙q8 = f9 −(1/R6C8)q8 + 1
R6

R4/I2
(1 + R4/R6)p2 +
R4/R6C8
(1 + R4/R6)q8

.
(5.56)
To complete this discussion of algebraic loops, Figure 5.10d shows the same
example system with a different arbitrary causal assignment. This time f4 is
assigned as the output from R4, and the causality completes as shown. It makes
no difference what bond is assigned arbitrarily. This system has an algebraic

EXTENDED FORMULATION METHODS—ALGEBRAIC LOOPS
187
problem consisting of one algebraic loop. Choosing f4 as the variable to relate
to itself, we write,
f4 = (1/R4)e4 = (1/R4)e5 = (1/R4)(e6 + e7) = (1/R4) (R6f6 + (1/C8)q8)
= (1/R4) (R6(f3 −f4) + (1/C8)q8)
= (1/R4) (R6 ((1/I2)p2 −f4) + (1/C8)q8) .
(5.57)
Solving for f4 yields
f4 =
R6
(1 + R6/R4)R4I2
p2 +
1
(1 + R6/R4)R4C8
q8.
(5.58)
Equation derivation would follow the standard procedure except that we would
stop when f4 enters the formulation,
˙p2 = e1 −R4f4,
˙q8 = f9 + f5 = f9 + (1/I2)p2 −f4.
(5.59)
The formulation is completed when (5.58) is substituted into (5.59). It is left
to any non-believing reader to show that the resulting state equations are identical
to (5.56).
So far in this section we have determined that some modeling assumptions
can lead to algebraic formulation problems, and that bond graphs identify such a
problem by the presence of incomplete causality after using the sequential causal
assignment procedure up to step 4. A procedure has been presented through an
example of a linear system that shows how to solve the algebraic problem and
end up with state equations in standard form.
For linear systems, this procedure will work for multiple loops involving
several algebraic variables, although solving by hand becomes formidable rather
quickly. For nonlinear systems, it may not be possible to invert some of the
algebraic relationships. For example, friction is a very common resistance effect
in mechanical systems and is represented by an R-element in a bond graph.
For the most common friction representation (see Figure 8.2 in Section 8.1 of
Chapter 8), the velocity (or ﬂow) must be an input and the friction force (or effort)
must be an output from the element. If the friction element was involved in an
algebraic loop that required its inversion (calculation of velocity from knowledge
of the force), in many cases it could not be done because a given force may have
no corresponding velocity or several.
We probably should look into the modeling assumptions that created the prob-
lem in the ﬁrst place. In Figure 5.10a, the connection of the spring and damper
was assumed to be massless. The connection is not actually massless, it was just
assumed to be and the assumption was probably justiﬁable during the modeling
process. Consider Figure 5.11a, where a small mass, m′, has been associated with
the connection point. Figure 5.11b shows the bond graph for the system with
causality assigned. No arbitrary assignment is required and there is no algebraic

188
STATE-SPACE EQUATIONS AND AUTOMATED SIMULATION
vi(t)
v′
vm
F(t)
m
b1
b2
k
m′
(a)
(b)
0
1
I:m′
R:b2
C:1/k
Se
Sf:vi(t)
1
0
R:b1
I:m
1
2
3
4
9
8
6
7
10
5
F(t)
vm
v′
:
FIGURE 5.11. Eliminating an algebraic loop by revisiting modeling assumptions in
Example 1.
loop. Equation derivation is straightforward for this system. If this had been the
ﬁrst model constructed, we would never have known that a potential problem
exists. In Chapter 13, the concept of algebraic loops is dealt with more formally,
and the idea of revisiting modeling assumptions when formulation issues arise
is developed in much more detail. Reference [1] describes a formal vector-ﬁeld
method for generating state space equations.
5.4.1
Extended Formulation Methods—Derivative Causality
In this section we study systems where, after sequential causal assignment, one
or more energy storage elements are forced into derivative causality. As with
algebraic loops, the occurrence of derivative causality is due to the modeling
assumptions made during the model construction. Storage elements in derivative
causality are not dynamically independent of the remaining storage elements, and
they do not contribute a state variable to the ﬁnal equations.
Mathematically, Eqs. (5.10) or (5.11), are called explicit differential equations
because the state variable derivatives are given as explicit functions of the state
variables and the input variables. It is this form of the equations of motion that is
best suited to analysis and simulation. When derivative causality arises, the state
equations become implicit, meaning that some of the state variable derivatives

EXTENDED FORMULATION METHODS—ALGEBRAIC LOOPS
189
become functions of themselves as well as of the state and input variables. In
principle, implicit state equations can be algebraically transformed to explicit
ones but, as we will see, this is not necessarily a simple task and many computer
simulation programs are not equipped to do it.
The independent state variables remain the p’s on I ’s and the q’s on C’s in
integral causality. The derivative elements do still store energy, and this energy
is accounted for in the bond graph. By being dynamically dependent, their asso-
ciated energy variable, p or q, is algebraically related to the independent state
variables. So, knowledge of the independent state variables allows algebraic deter-
mination of the energy variables on the derivative elements, and thus calculation
of their contribution to the system energy. The algebraic relationships, relating
the dependent and the independent energy variables must be derived before it
is possible to have a state representation in explicit form. This is demonstrated
through example.
Consider the physical system shown in Figure 5.12a. It consists of a perma-
nent magnet dc motor driving a rotational load, J , through a ﬂexible shaft of
torsional stiffness, kτ. There is also some rotational damping with constant, bτ.
On the electrical side of the motor, the winding resistance, Rw, and the winding
inductance, L, are important dynamic effects. It has been decided, for this appli-
cation, that the rotational inertia of the motor is negligible and it is not included.
Figure 5.12b shows a bond graph for this system where the motor has been
characterized as a gyrator with coupling constant, T [N · m/A] (see Section 4.4.2
to remind you how to model dc motors).
In the ﬁgure, the bonds have been numbered and causality has been assigned
using the sequential assignment procedure. The inductance, I3, has been put into
integral causality. As a result, the compliance, C6, was constrained to be in
derivative causality. The state variables for this system are p3 and p8, and only
two state equations need to be derived. The single input variable is ec. The energy
variable, q6, is not an independent state variable, but is algebraically dependent
on the independent state variables.
We cannot simply ignore the presence of the derivative element. If we try to
derive the equations without its consideration, then we would write,
˙p3 = e1 −e2 −e4 = e1 −(R2/I3)p3 −Tf5
= e1 −(R2/I3)p3 −T (f6 + (1/I8)p8) .
(5.60)
The appearance of f6 is where the derivative element enters the formulation,
and f6 must be dealt with before ﬁnal formulation can be done.
We next recognize that
f6 = ˙q6,
but there is no state equation for q6, and more work must be done.
The next step is to derive the algebraic relationship relating q6 to the state vari-
ables and source variables. When we do this, we start by writing the constitutive

190
STATE-SPACE EQUATIONS AND AUTOMATED SIMULATION
bτ
J
kτ
ec
(a)
T
e5 = Tf4
e5 = Tf4
ec:Se
0
1
R:Rw
C
GY
1
I:J
R:bτ
1
2
4
5
7
9
q6
.
e6
p8
.
f8
I:L
1kτ
(b)
p3
.
f3
0
1
R
C
e
S
GY
1
I
R
1
2
4
5
7
9
q6
.
e6
p8
.
f8
I
p3
.
f3
T
(c)
Rw
wm
wd
wm
wd
L
0
1
R
C
e
S
GY
1
I
R
1
2
4
5
7
9
q6
.
e6
p8
.
f8
I
p3
.
f3
T
(d)
1
I
11
.
f10
:
:
:
:
p10
FIGURE 5.12. Derivative causality in a bond graph. Example 1.
law “backwards,” that is,
q6 = C6e6.
(5.61)
(For an I -element in derivative causality, we would write pi = Iifi. Also, for
nonlinear elements, we would start with q6 = C(e6) for compliance elements
in derivative causality, and pi = I(fi) for inertial elements in derivative
causality.)

EXTENDED FORMULATION METHODS—ALGEBRAIC LOOPS
191
Starting with Eq. (5.61), we follow causality in the standard fashion to ﬁnd
out how e6 is determined:
e6 = e5 = Tf4 = Tf3 = (T /I3)p3.
(5.62)
Thus,
q6 = (C6T /I3)p3.
(5.63)
This is the algebraic relationship that allows the energy variable, q6, to be
algebraically determined from the state variable, p3. Taking the derivative of
(5.63) yields
˙q6 = (C6T /I3) ˙p3.
(5.64)
We can now substitute (5.64) into (5.60), with the result
˙p3 = e1 −(R2/I3)p3 −T ((C6T /I3) ˙p3 + (1/I8)p8) .
(5.65)
When dealing with derivative causality, we end up with an implicit equation
with derivatives of state variables on both sides of the equation. Equation (5.65)
is particularly simple to reduce to the explicit form because q6 depends on only
one state variable. We can simply bring ˙p3 from the right side to the left, with
the result
˙p3 =
e1
(1 + C6T 2/I3) −
(R2/I3)p3
(1 + C6T 2/I3) −
(T /I8)p8
(1 + C6T 2/I3).
(5.66)
The second and last state equation starts with
˙p8 = e7 −(R9/I8)p8.
But e7 is not caused by the compliance element; instead,
e7 = e5 = Tf4 = (T /I3)p3,
(5.67)
with the ﬁnal result
˙p8 = (T /I3)p3 −(R9/I8)p8.
(5.68)
Equations (5.66) and (5.68) can be put into the standard matrix format for
linear systems,
d
dt
p3
p8

=
−R2/I3Q
−T /I8Q
T /I3
−R9/I8
 p3
p8

+
1/Q
0

e1,
(5.69)
where
Q = 1 + C6T 2/I3.

192
STATE-SPACE EQUATIONS AND AUTOMATED SIMULATION
When this example was presented, the I -element on bond 3 in Figure 5.12b
was put into integral causality and this resulted in the C6 element being in
derivative causality. In Figure 5.12c the bond graph is repeated, but this time the
C6 element is put into integral causality, with the result that the I3 element ends
up in derivative causality. We have some ﬂexibility in choosing which elements
are in integral causality, but, once chosen, some elements will be constrained
to be in derivative causality. The derivative causality resulted from the original
modeling assumptions, and without changing these assumptions, the model will
have derivative causality regardless of causal assignment choices deﬁning which
of the energy variables are considered to be independent.
When deriving equations for Figure 5.12c, the effort e3 = ˙p3 will enter the
formulation. Thus, we will need to write the constitutive law “backwards” for the
I3 element and determine how the energy variable, p3, is algebraically related to
the state variables. Thus,
p3 = I3f3 = I3f4 = (I3/T )e5 = (I3/TC6)q6
(5.70)
and
e3 = ˙p3 = (I3/TC6)˙q6.
(5.71)
Now we can derive the equations using standard procedures, starting with
˙q6 = f5 −f7 = (1/T )e4 −(1/I8)p8 = (1/T )(e1 −e2 −e3) −(1/I8)p8.
(5.72)
We see that e3 entered the formulation, and we will eliminate it using (5.71);
we should note that e2 = R2f2 and f2 is not caused by I3, but must be tracked
through the causal information. Continuing,
˙q6 = (1/T ) (e1 −(R2/T C6)q6 −(I3/T C6)˙q6) −(1/I8)p8.
(5.73)
Again we see that a derivative of a state variable is on both sides of the
equation. And again, this equation is very simple to get into the standard form
by simply bringing the ˙q6 terms from the right-hand side to the left, eventually
resulting in
˙q6 =
1/T
(1 + I3/T 2C6)e1 −
R2/T 2C6
(1 + I3/T 2C6)q6 −
1/I8
(1 + I3/T 2C6)p8.
(5.74)
The second state equation is
˙p8 = (1/C6)q6 −(R9/I8)p8.
(5.75)
Comparing (5.66) and (5.68) with (5.74) and (5.75), we see that the two
state representations of the same system have different appearances. This is not

EXTENDED FORMULATION METHODS—ALGEBRAIC LOOPS
193
surprising since we are using different state variables for the two representations.
Rest assured that if both sets of equations were solved, the predicted system
dynamics would be identical from both state representations.
It has been emphasized that modeling assumptions are the cause of algebraic
problems in formulations. For the example system we have just shown it was
assumed that the rotational inertia of the electric motor was negligible and was
not included in the model. Figure 5.12d shows the bond graph for the system
when the rotational inertia of the motor, Jm, is included. The angular velocity
of the motor, ωm, is on bond 5 in the bond graphs in parts b and c. In part d,
a 1-junction has been inserted, exposing ωm, and the I -element representing the
motor inertia has been attached (it is bond 10 in Figure 5.12d). Causality has
been assigned, and there is no derivative causality.
The new modeling assumption has eliminated any formulation problems. If
these modeling assumptions had been made originally, we would have never
known that a potential formulation problem exists. It should be noted that the
model in Figure 5.12d has four state variables and four state equations, whereas
the model in part b has only two state variables and two state equations. Including
the motor inertia has increased the number of state variables by two, one being
the new I -element in integral causality and the other coming from the storage
element formerly in derivative causal element that is now in integral causality. If
we were going to do pencil and paper analysis, then two additional equations is
a signiﬁcant further complication. If our intention is computer solution, then the
change is almost insigniﬁcant. The concept of revisiting modeling assumptions
to alleviate formulation problems is discussed in detail in Chapter 13.
One more example involving derivative causality may serve to sufﬁciently
illustrate the pattern of formulation and reduction. Figure 5.13a shows masses
m1 and m2 on the left and right ends of a massless lever. A force, F(t), acts on
m1, and a spring, k, is attached to m2. Positive force and velocity directions are
indicated. Part b of the ﬁgure shows a bond graph for this system, with bonds
numbered and the transformer modulus deﬁned by the relationships shown for the
transformer and representing the input force by e4. In part c causality has been
assigned, putting I2 into integral causality, with the result that I1 is in derivative
causality. The independent state variables are p2 and q3, and the dependent vari-
able p1 is not a state variable but will impact the equation formulation. Thus, we
write the constitutive law backwards for this element and derive the algebraic
relationship relating p1 to the other state variables. Thus,
p1 = I1f1 = I1(a/b)f6 = (I1/I2)(a/b)p2
(5.76)
and, taking the derivative of Eq. (5.76),
e1 = ˙p1 = (I1/I2)(a/b) ˙p2.
(5.77)
Equation derivation starts with
˙p2 = e6 −e3 = (a/b)e5 −(1/C3)q3 = (a/b)(e4 −˙p1) −(1/C3)q3.
(5.78)

194
STATE-SPACE EQUATIONS AND AUTOMATED SIMULATION
FIGURE 5.13. Derivative causality in a bond graph. Example 2.
We substitute from (5.77), with the result
˙p2 = (a/b) (e4 −(I1/I2)(a/b) ˙p2) −(1/C3)q3,
(5.79)
where the state variable derivative ˙p2 appears on both sides of the equation. The
ﬁnal result is
˙p2 =
(a/b)
1 + (I1/I2)(a/b)2 e4 −
1/C3
1 + (I1/I2)(a/b)2 q3,
(5.80)
and the second state equation is
˙q3 = (1/I2)p2.
(5.81)
The reader must appreciate that the two examples shown for derivative causal-
ity are quite simple in that (1) only one energy storage element was in derivative
causality and (2) the dependent energy variable was algebraically related to only
one independent state variable. For more complex systems the algebra required
to reduce a set of equations to a standard equation format can be formidable at
best, and, for nonlinear systems, practically impossible at worst.
It is always possible to revisit the modeling assumptions that resulted in the for-
mulation problem and change these assumptions to yield a model that is virtually
the same as the one originally intended but without the formulation problems.
There are some computational penalties that accompany the addition of very

EXTENDED FORMULATION METHODS—ALGEBRAIC LOOPS
195
small added inertias or very stiff added compliances in a model. But for some
systems these penalties are a very small price to pay for eliminating formulation
problems. As mentioned, this topic is discussed in detail in Chapter 13.
For the system in Figure 5.13, it is interesting to see how derivative causality
could have been avoided. Figure 5.14a shows a physical system where the lever
has been divided into two massless pieces, with the right end of one and the
left end of the other pivoted at the same point. The two pieces are coupled by
a torsional spring of stiffness, kτ, which represents the fact that the lever is
not actually rigid, but has some ﬂexibility. The system is otherwise identical to
the system of Figure 5.13a. The angular velocity of the left side lever is ω1
and that of the right side lever is ω2. The torsional spring “sees” the difference
m1
m2
vm1
vm2
ω1
ω2
a
b
k
kτ
F(t)
0
1
C:1/kτ
Se : F(t)
TF
1
1
TF
C:1/kτ
ω1
ω2
m1:I
m2:I
1 a
b
0
1
C:1/kτ
Se : F(t)
TF
1
TF
C:1/kτ
m1:I
m2:I
1a
b
1
2
3
4
5
6
7
8
ω1
ω2
(a)
(b)
(c)
:
:
:
:
FIGURE 5.14. Avoiding derivative causality by changing the modeling assumptions for
Example 2.

196
STATE-SPACE EQUATIONS AND AUTOMATED SIMULATION
between these angular velocities, and the bond graph for the system is shown in
Figure 5.14b.
Figure 5.14c shows the bond graph reduced and with causality assigned. There
is no derivative causality, and equation formulation would be straightforward. If
the torsional spring is made stiff enough, then there will be very little difference
between ω1 and ω2, and a close approximation to the original system will result.
5.5
OUTPUT VARIABLE FORMULATION
We have seen that it is very convenient to derive state equations for all types of
systems using the energy variables, p’s and q’s, as the state variables. More often
than not, however, the system outputs that we want to observe and plot are not
the p and q variables. Can you imagine interpreting the motion of a mechanical
system from a plot of a mass momentum, or the behavior of a circuit from a plot
of the ﬂux linkage in a coil? You might want to look at these responses, but you
also might want to look at mass velocities and displacements, circuit voltages and
currents, hydraulic pressures, and so on. It turns out that any effort or ﬂow on any
bond in a bond graph can be related to the state variables. Thus, we solve systems
of equations in terms of the state variables, and then derive output equations that
relate the desired outputs to the state variables. If the system solution is done
computationally, then it is a simple matter to append output equations at the end
of the program so that desired outputs can be viewed.
Consider the system in Figure 5.9, which was used earlier to demonstrate
equation formulation. If we desire the ﬂow on bond 1 as an output, then we
simply follow the causal path and relate f1 to the state and source variables.
Thus,
f1 = f8 = (1/R8)e8 = (1/R8) (e1 −e9) = (1/R8) (e1 −(1/C3)q3) .
(5.82)
By following causality we have related the desired output to the known source
variable, e1, and the state variable, q3. If we wanted the effort on bond 5, then
e5 = e2 −e6 −e7 −e4 + e11
= e2 −(R6 + R7) (1/I5)p5 −(1/C4)q4 + (1/mC3)q3.
(5.83)
In this case, q3, q4, and p5 are state variables and e2 is an input variable from
a source.
These two output equations were derived assuming that the system was linear,
which was assumed when this system was used for equation derivation. When
the system is linear, the output equations can be put into a matrix format,
Y = CX + DU,
(5.84)

OUTPUT VARIABLE FORMULATION
197
where Y is a vector of desired outputs,
Y =
⎡
⎢⎢⎢⎢⎣
y1
y2
•
•
yk
⎤
⎥⎥⎥⎥⎦
,
(5.85)
U is the vector of inputs,
U =
⎡
⎢⎢⎢⎢⎣
u1
u2
•
•
ur
⎤
⎥⎥⎥⎥⎦
,
(5.86)
and C is a k × n matrix of coefﬁcients and D is a k × r matrix of coefﬁcients
where the coefﬁcients are made up of system parameters. For the output equation
(5.82) and (5.83), the matrix form would be
f1
e5

=
−1/R8C3
0
0
1/mC3
−1/C4
−(R6 + R7)/I5

⎡
⎢⎣
q3
q4
p5
⎤
⎥⎦+
1/R8
0
0
1
e1
e2

,
(5.87)
If the system is nonlinear, the desired outputs can still be expressed in terms
of the state variables and source variables, but the nice matrix notation of Eq.
(5.84) is not available. For example, in Figure 5.9, if the resistance element R8
and the compliance element C3 are nonlinear such that f8 is a function of e8,
f8 = −1
R (e8) ,
(5.88)
and e3 is a function of q3,
e3 = −1
C (q3) ,
(5.89)
then the output, f1, would be derived as
f1 = f8 = −1
R (e8) = −1
R (e1 −e3) = −1
R

e1 −−1
C (q3)

.
(5.90)
Causality still shows us the path from the output of interest to the known
variables, but the relationships are not linear. From a computational point of view
it makes theoretical difference whether the equations are linear or nonlinear. If
the output we desire is the power on some bond, then the output equation will be
nonlinear whether or not the system is linear. Power is always composed of the

198
STATE-SPACE EQUATIONS AND AUTOMATED SIMULATION
product of an effort and a ﬂow. In Figure 5.9, if we desire the power on bond 1,
P1, as an output variable, then
P1 = e1f1 = (e1/R8) (e1 −(1/C3)q3) ,
(5.91)
where f1 is the linear version from Eq. (5.82). Since we are most often dealing
with computational solutions of system equations, it really does not matter as to
the complexity or linearity of the output equations, other than getting them typed
and formatted correctly for the program being used.
5.6
NONLINEAR AND AUTOMATED SIMULATION
A primary reason for constructing a physical engineering model of a dynamic
system is to predict the response of the system prior to actually building it. A
good model can go a long way toward avoiding mistakes in a ﬁrst prototype
of a complex system. Sometimes it is justiﬁed to assume that a system behaves
linearly, thus allowing the model to be constructed from linear inertance, compli-
ance, and resistance elements and restricted to small motions with no nonlinear
kinematics. When this is justiﬁed, linear analysis can be performed, sometimes
analytically but most often computationally. Some of the more important linear
concepts for engineers are developed in the next chapter.
More often than not, at some point in the system development process, a
more realistic nonlinear model must be developed in order to really understand
the system, or to test a control strategy that was developed using linear think-
ing, or to see what happens when displacements hit hard boundaries or power
ampliﬁers saturate, for example. For nonlinear systems there is really only one
choice for predicting the system response, and that is computer simulation. This
topic is discussed thoroughly in Chapter 13. Here we discuss how to organize
system equations for computer simulation and demonstrate with an example. We
also discuss the concept of automated simulation where bond graph models are
communicated graphically to the computer and causality and the equivalent of
state equations are automatically generated in symbolic form even for nonlinear
systems.
5.6.1
Nonlinear Simulation
Figure 5.15a is the quarter-car model repeated from Figure 4.10, where it was
used to demonstrate bond graph construction procedures. This time, the suspen-
sion spring and damper and tire spring are all treated as nonlinear elements. A
sketch of the constitutive relationships for each element is in the schematic. Also
shown next to vi(t) is a roadway bump the vehicle is going to hit. This bump is
shown as a height versus distance and has the appearance of a speed bump such
as found in parking lots. We will characterize the bump as 1
2 of a sine wave,
and interpret the bump as an equivalent velocity as required for bond graph ﬂow

NONLINEAR AND AUTOMATED SIMULATION
199
(a)
(b)
0
1
I:ms
R
C
Sf:vi
0
1
1
I:mus
C
msg:Se
musg:Se
1
.
3
4
.
6
7
8
q9
.
e9
10
11
p12
p5
e2
q2
f5
.
f12
Fd
vd
Ft
qt
kt
Fs
sq
0
sq
ks1 ks2
ms
mus
vi
vus
vs
h
d
x
y
FIGURE 5.15. Quarter-car simulation example with nonlinear elements.
inputs. For the spatially distributed input,
y = h sin π x
d
for 0 < x
d ≤1
and
y = 0
for (x/d) > 1.
(5.92)
If we imagine the vehicle traveling at constant horizontal velocity, U , toward
the right, then x = Ut and (5.92) becomes
y = h sin π(U/d)t
for 0 < (U/d)t ≤1.
(5.93)
A reasonable characterization of the vertical input velocity is to multiply the
forward velocity times the slope of the roadway, dy/dx, thus,
vi(t) = (h/d)πU cos π(U/d)t
for 0 < (U/d)t ≤1,
vi(t) = 0 otherwise.
(5.94)
We will characterize the suspension spring as a linear spring with slope, ks1,
up until a compressive displacement of qs0, at which point the slope changes to
a stiffer spring, ks2. Thus,
Fs = ks1qs
for qs ≤qs0,
Fs = ks1qs0 + ks2 (qs −qs0)
for qs > qs0.
(5.95)

200
STATE-SPACE EQUATIONS AND AUTOMATED SIMULATION
The damper will be characterized as
Fd = Bv3
d,
(5.96)
and, ﬁnally, the tire spring will be characterized as linear in compression while
generating no force in extension, that is, no force when the tire is off the ground.
Thus,
Ft = ktqt
for qt ≥0,
Ft = 0
for qt < 0.
(5.97)
The bond graph for the example system is shown in Figure 5.15b. Causality
has been assigned and bonds have been numbered. Notice that there are no param-
eters listed with the suspension spring and damper or with the tire spring. These
are nonlinear elements and this is indicated on the bond graph by the absence of
a single identifying parameter. The state variables are q2, p5, q9, and p12.
Equations (5.10) are the functional form of standard nonlinear state-space
equations. These are called explicit ﬁrst-order differential equations and can be
expressed in shorthand form as
˙X = F (X, U)
(5.98)
where x is the vector of state variables,
˙X =
⎡
⎢⎢⎢⎢⎣
x1
x2
•
•
xn
⎤
⎥⎥⎥⎥⎦
,
U is the vector of inputs,
U =
⎡
⎢⎢⎢⎢⎣
u1
u2
•
•
ur
⎤
⎥⎥⎥⎥⎦
,
and f is a vector of functions of states and inputs,
F(•) =
⎡
⎢⎢⎢⎢⎣
f1(X, U)
f2(X, U)
•
•
fn(X, U)
⎤
⎥⎥⎥⎥⎦
.
It turns out that equations that can be derived in this condensed form are
particularly easy to solve numerically (see Chapter 13). However, it is enough to

NONLINEAR AND AUTOMATED SIMULATION
201
know that equations could be put into this form, but it is not necessary to do so
in order to carry out numerical simulation. In fact, it is rare to derive equations
in the explicit form of (5.98) when the intention is numerical simulation. This is
demonstrated with our example.
Equation formulation for the bond graph of Figure 5.15b begins with
˙q2 = f1 −(1/I5)p5,
(5.99)
where f1 is the input velocity, vi(t), from (5.94). This state equation turns out
to be linear even though the system is nonlinear. The second equation is
˙p5 = −e4 + e2 −e7.
(5.100)
The effort e4 = musg, the effort, e2 comes from the nonlinear tire spring char-
acterized by (5.97), and
e7 = e8 + e9.
(5.101)
The effort e8 is the damper force from (5.96), and the effort e9 is from the
nonlinear suspension spring from Eq. (5.95).
The next state equation is
˙q9 = (1/I5)p5 −(1/I12)p12,
(5.102)
which is another linear state equation.
The ﬁnal state equation is
˙p12 = −e11 + e7,
(5.103)
where e11 = msg and e7 has already been discussed.
The equation formulation is now complete. Bond graph causality told us that
explicit equations would result, but there is no need to reduce the equations to
this ﬁnal form. It is perfectly all right to leave the equations in uncondensed
form as long as all the variables are accounted for. Equations (5.94)–(5.97) with
(5.99)–(5.103) are a complete, computable set of equations ready to simulate the
quarter-car system. We need only specify initial conditions for the state variables,
and the simulation can proceed.
In addition, many commercial equation solvers have a sort feature. This means
that the user need not pay any attention to the order in which the equations appear
in the program. The program determines the order in which the equations must
be used and properly sorts the equations for the user. For example, Eq. (5.100)
requires e7 to evaluate ˙p5, but e7 appears in order below Eq (5.100) in Eq.
(5.101). If a program were proceeding in order to evaluate the state variable
derivatives, an error would occur, because the current value of e7 would not be
known at the time when the program attempts to compute ˙p5. A sort program
assures that all equations needed to compute state variable derivatives have been

202
STATE-SPACE EQUATIONS AND AUTOMATED SIMULATION
evaluated before the derivatives are computed. (This is possible in the absence
of algebraic loops and derivative causality.)
Some simulation results for this example are presented below, but ﬁrst we
discuss automated simulation.
5.6.2
Automated Simulation
It is hoped that the reader recalls how straightforward it is to assign causality to
a bond graph and thus know, before deriving any equations, if any formulation
problems such as algebraic loops or derivative causality exist. With causality
assigned, state variables and input variables are determined. Computers can fol-
low the same rules as humans and can assign sequential causality to a bond graph,
choose state variables, and derive the ﬁrst-order state equations. There are several
commercial programs that start from a graphical description of a bond graph and
automatically deliver state equations ready for simulation. The user need only
input the parameters, deﬁne any nonlinearities, specify the input functions, and
specify the initial conditions. The program will then simulate the system and
plot any desired outputs, including any state variable, any effort or ﬂow variable,
or any output deﬁned by the user as a combination of state variables and input
variables. These programs are so straightforward to use that a user unfamiliar
with bond graph modeling could carry out a simulation if a bond graph model
including sign half-arrows were provided. In Chapter 1 some references are given
that describe some of the better known commercial bond graph processors.
For our example system, a bond graph processor program would follow the
causality of Figure 5.15b and deliver the following uncondensed equations:
e1 = e2
e7 = e8 + e9
e3 = e2
˙q9 = f9
f2 = f1 −f3
e8 = R8f8??
˙q2 = f2
f10 = f12
f3 = f5
f11 = f12
f4 = f5
e12 = e10 −e11
f6 = f5
˙p12 = e12
e5 = e3 −e4 −e6
e2 = (1/C2)q2??
˙p5 = e5
f5 = (1/I5)p5??
e6 = e7
e9 = (1/C9)q9??
e10 = e7
f12 = (1/I12)p12??
f7 = f6 −f10
f8 = f7
f9 = f7
(5.104)

NONLINEAR AND AUTOMATED SIMULATION
203
If the reader follows the causality of Figure 5.15b it will be discovered that
every input/output causal implication is reﬂected in Eqs. (5.104). Of particular
interest are the equations with question marks next to them. When an auto-
mated program derives equations, it has no idea which components are linear
or nonlinear nor how to characterize any speciﬁc nonlinearities. The program
does recognize which elements might be nonlinear, and it highlights these with a
question mark or some other indicator. For this example, the resistance element,
R8, is nonlinear and the user would have to modify the linear equation in (5.104)
with
e8 = Bf 3
8
(5.105)
from (5.96) above. Neither of the inertial elements is nonlinear, so the user would
only need to provide the inertia parameter for each. Both compliance elements
are nonlinear, so the equation for e2 in Eq. (5.104) would have to be modiﬁed
using Eq. (5.97), and the equation for e8 would have to be modiﬁed according
to Eq. (5.95). Finally, the input, f1, would be deﬁned according to Eq. (5.94),
and e4 and e11 must be deﬁned as the respective weights of the unsprung and
sprung vehicle masses. Along with initial conditions (initial values of the state
variables), the simulation is ready to be run as long as a sorting equation solver
is used.
For the example system, the parameters used in the simulation are shown in
Table 5.1.
The system was simulated using a commercial equation solver for two different
forward speeds, U , listed in Table 5.1. Figure 5.16 shows the velocity input
from (5.94) for the lower vehicle forward speed of 2 mph. Figure 5.17 shows
the suspension spring and damper forces along with the tire spring force. The
vehicle starts from static conditions where the masses are not moving vertically
TABLE 5.1. Parameters for the Example Simulation
ms = 320 kg
mus
ms
= 1
6
fs, suspension frequency, = 1.0 Hz
ωs = 2πfs, rad/s
For the suspension spring, ks1 = msω2
s , N/m
ks2 = 10ks1, N/m
For the tire spring, kt = 10ks1, N/m
Initial conditions for springs, qs−ini = msg/ks1 qus−ini = (ms + mus)g/kt
Breakpoint for suspension spring, qs0 = 1.3qs−ini
B, damper parameter, = 1500.0 N/(m/s)3
For the input bump, h = 0.25 m
d = 1.0 m
Forward velocity, U = 2 and 30 mph = 0.9 and 13.5 m/s

204
STATE-SPACE EQUATIONS AND AUTOMATED SIMULATION
FIGURE 5.16. Input velocity for the simulation example for a vehicle speed of 2 mph.
FIGURE 5.17. Suspension spring and damper forces and tire forces for a vehicle speed
of 2 mph.

NONLINEAR AND AUTOMATED SIMULATION
205
FIGURE 5.18. Suspension spring and damper forces and tire forces for a vehicle speed
of 30 mph.
and the springs are compressed to their initial values. As the bump is traversed,
the springs become more compressed and the damper force becomes nonzero as
a relative velocity is established across the suspension. The sharp change in slope
of the suspension spring force at about 1.2 s is due to the spring displacement
becoming more compressed than the breakpoint, qs0, and thus the spring becomes
much stiffer. The tire displacement never becomes negative in this simulation,
and thus the tire force follows a linear law as indicated in (5.97).
When the vehicle forward speed is increased to 30 mph, the force results are
as shown in Figure 5.18. This time the tire force becomes zero just after the
vehicle strikes the bump. The tire spring ﬁrst compresses and then uncompresses
until the tire deﬂection becomes negative, the wheel is off the ground, and the
tire force becomes zero. When the wheel returns to the ground, the tire spring
becomes compressed once again. It is interesting to plot the damper force versus
the relative velocity across the suspension as shown in Figure 5.19. The cubic
constitutive law is very obvious in this view. Figure 5.20 shows the suspension
spring force versus the suspension deﬂection, and again the nonlinear constitutive
behavior is very apparent. Finally, Figure 5.21 shows the tire force plotted against
the tire deﬂection, and once again the nonlinear behavior is exposed.
It is hoped that the reader has gained some appreciation for the virtues of bond
graph modeling for obtaining simulation results for nonlinear systems. Chapter 13
covers this topic more thoroughly. In the previous chapters, we felt it necessary
to introduce the modeling concepts using linear systems, since there are a lot of
new concepts to learn, including system construction rules, power convention,
causality, and equation derivation. While linear systems play a very large part

206
STATE-SPACE EQUATIONS AND AUTOMATED SIMULATION
FIGURE 5.19. Damper force versus relative velocity across the suspension.
FIGURE 5.20. Suspension spring force versus suspension deﬂection.

PROBLEMS
207
FIGURE 5.21. Tire spring force versus tire deﬂection.
in understanding the basic behavior of systems, the fact is that most systems
are nonlinear, and, at some point in the development of an engineering system,
the nonlinear behavior will have to be included. The nonlinear model of the
system will probably be computer simulated since there is almost no chance that
analytical methods can be useful.
In Chapter 6, some of the more important linear system analysis tools are pre-
sented. These linear techniques are important in understanding system dynamics
and designing control systems and they are widely used even when they are not
strictly appropriate. Later chapters are devoted to advanced bond graph methods
for constructing realistic overall system models that include nonlinear constitutive
laws when appropriate.
REFERENCE
[1] R. C. Rosenberg, “State space formulation for bond graph models of multiport
systems,” Trans. ASME J . Dyn. Syst. Meas. Control, 93, Ser. G, No. 1, 35–40
(Mar. 1971).
PROBLEMS
5-1. For each of the following bond graphs, assign causality, predict the number
of state variables, and write a set of state equations. All elements may be
assumed to be linear with constant coefﬁcients.

208
STATE-SPACE EQUATIONS AND AUTOMATED SIMULATION
5-2. For each of the problems below, you are asked to ﬁnd an equivalent expres-
sion for the system given. Try it ﬁrst for constant-coefﬁcient elements and
then for nonlinear characteristics using the ﬁrst case as a guide.

PROBLEMS
209
5-3. For the problems listed below, in each case make a bond graph model of
the circuit, schematic, or network diagram. Then augment the graph and
write state equations. Interpret the equations physically. You may assume
the elements are linear.
(a)
Problem 4-1(e), electrical circuit
(b)
Problem 4-3(h), mechanical translation
(c)
Problem 4-5(a), mechanical rotation
(d)
Problem 4-6(a) and (b), hydraulic
(e)
Problem 4-5(c), mechanical transduction
(f)
Problem 4-5(e), mechanical transduction
5-4. For the electrical circuit shown below, verify the bond graph, write state
equations, and develop an output equation for the voltage across the load
resistor (RL) in terms of state variables and input variables. Assume all
elements have constant coefﬁcients.
5-5. The mechanical system shown below has two nonlinear springs with con-
stitutive laws, as shown. Note that δ is a deﬂection. The friction relations
are also nonlinear, with a signum (sign) characteristic as shown. Make a
bond graph and write state equations.

210
STATE-SPACE EQUATIONS AND AUTOMATED SIMULATION
5-6. Make a bond graph model of the pulley system shown in part b of Prob-
lem 4-4. Augment the graph and predict the number of state variables.
Write a suitable set of state equations. Modify the graph to include pulley
inertias and pin-joint friction. Write state equations for the resulting graph.
5-7. A ball is suspended at the end of a spring in a container of ﬂuid, as shown
below. The extension of the spring measured from free length is xs, and
the velocity of the mass is v, measured downward. The spring is nonlinear,
characterized by the relation
Fs = φs(xs).
The damping effect of the ﬂuid is proportional to the square of the velocity,
corrected for sign:
FD = b |v| v.
(a)
Formulate state equations for the system in terms of xs and p (mass
momentum).
(b)
Transform the equations from xs, p variables to xs, v variables.
5-8. Consider the simple model of a vehicle shown below, where the suspended
mass is M ; the main suspension stiffness is K; the damper coefﬁcient is
B; the tire mass is m; the tire spring stiffness is k; and the velocity input
from the roadway is V (t).

PROBLEMS
211
(a)
Make a bond graph model, augment the graph, and write state
equations.
(b)
The tire mass is assumed to be negligible: let m →0, but retain all
other values. Make a bond graph and derive state equations.
5-9. A commercial type of air spring isolator is shown. The mass is supported
by air pressure contained by means of a virtually frictionless bellows
arrangement (not shown). Damping is provided by adjusting the area of
the oriﬁce between the two chambers. The oriﬁce resistance law is gen-
erally nonlinear, as is the capacitance relation, since the pressure–volume
relation for the gas is approximately PVn = const.
(a)
Make a bond graph for the system that allows both ground motion
Z(t) and force F(t) as inputs.
(b)
Write state equations, using general functions for resistance and
capacitance relations.
(c)
Using the bond graph, show an analogous all-mechanical system.

212
STATE-SPACE EQUATIONS AND AUTOMATED SIMULATION
5-10. For the water storage system of Problem 4-7, including the inertia effects
introduced in part b, augment the graph, predict the number of state vari-
ables, and write state equations. (If you encounter formulation difﬁculties,
indicate clearly the steps to be taken to achieve state equations in standard
form.)
5-11. On the diagram, physical-system variables and parameters are identiﬁed,
where
θ0 = output position angle;
vin = input voltage;
va = output voltage of linear ampliﬁer;
ia = motor armature current;
if = motor ﬁeld current, assumed constant;
Ka = gain of linear ampliﬁer, assumed to have no signiﬁcant
time constants;
Ra = resistance of armature winding;
La = inductance of armature winding;
J = inertial load;
b = viscous-damping constant;
KT = torque constant of motor;
K = back-emf constant of motor.
The differential equations that govern the dynamics of the system are
J ¨θ0 + β ˙θ0 = KT ia,
La˙ia + Raia = Va −Kv ˙θ0.
(a)
Construct a bond graph for the system.
(b)
Write state-space equations, and verify that they are equivalent to
those listed above.
(c)
Compare the two methods for analyzing this system. For example, is
the system third or second order? Are KT and Kv related in any way?

PROBLEMS
213
5-12. Consider the seismometer sketched below:
The input is ground motion Vg(t); an electrical transducer using a perma-
nent magnet moving in a coil reacts to the relative motion between the
case and the seismic mass m.
(a)
Construct a bond graph model of the device, leaving the electrical
port as a free bond.
(b)
Assume the device is connected to a voltage ampliﬁer, so that i =
0. Find an expression relating Vg(t) and e1.
(c)
Sometimes it is preferable to use current rather than voltage as output,
due to noise considerations. Suppose a current ampliﬁer is used, so
that e1 = 0. Relate output current i to input signal Vg(t) for the case
when coil resistance and inductance are neglected.
(d)
Reconsider the problem of (c) with coil resistance included.
5-13. The three systems shown below each possess a feature that makes the
writing of state-space equations interesting. In each case assign causality
sequentially and predict any difﬁculties. Where possible, write state-space
equations assuming linear element characteristics.

214
STATE-SPACE EQUATIONS AND AUTOMATED SIMULATION
5-14. Consider the mechanical system shown below.
The mass, m, plays a somewhat unusual role in the system.
(a)
Show that a state space for the system can be found that does not
even depend on m1.
(b)
Show that most system output variables depend statically on the state
variables and the inputs, F and V , but because of m1 this is not true
of f (deﬁned above).
5-15. The resistive circuit shown below offers an opportunity to exploit the use
of causality and helping (or auxiliary) variables.
(a)
Make a bond graph model of the circuit, and assign causality.
(b)
Find eout in terms of ein.
(c)
Find i4 in terms of ein.
(d)
If a load resistance RL is put on at the eout port, modify the graph
and your solution to part (b) above.
5-16. The dc motor shown has winding resistance Rw, rotary inertia Jm, and
output shaft compliance kT . The pinion gear of radius R drives a rack
of mass m with attached spring k and damper b. The bond graph for
this system is shown below, where T is the motor constant such that the
motor torque τ is related to the current i by τ = Ti. Derive a state-space
representation of this system and put into matrix form, ˙x = Ax + be:

PROBLEMS
215
(a)
(b)
e(t)
i
Rw
R
k
b
m
ωm
ωg
Jm
kT
1
1
GY
TF
C:1/k
C:1/kT
I:Jm
R:Rw
I:m
R:b
R
T
Se
1
1
0
3
4
6
8
9
11
10
12
2
5
7
:
:
e4 = T f3
e3 = T f4
e9 = 
f8 = 
e8
 
1
R
1
R f9
Write output equations for e4, f7, and e2.
5-17. A one-story building model is shown with a dc motor on the “roof.” The
motor can be accelerated such that a reaction force is generated. The idea
would be to control the motor voltage so that the reaction force helps calm
the building in the event of an earthquake, represented by input velocity
vi(t).

216
STATE-SPACE EQUATIONS AND AUTOMATED SIMULATION
1
1
GY
C
1/kw
I
Im
R:Rw
I
e
SE
1
0
0
1
3
4
6
7
9
11
13
10
12
2
5
I:Mm
Mf
8
:
τ
:
:
TF
SF:vi
R
:
:
:
kw
vi(t)
vm = vf + Rωm
vf
e
ωm
mf
dc motor,
Mm, Jm, R
The bond graph for this system has derivative causality. Using procedures
from this chapter, derive the state equations for this system. The algebra
may become tedious, but describe with equations and words how you
would come up with ﬁnal state equations.
5-18. For Problem 5-17, propose the addition of a physical energy storage ele-
ment that eliminates derivative causality. Redraw the bond graph and
describe what the added element represents. Derive the state equations.

PROBLEMS
217
5-19. The system shown has an algebraic loop:
m
F
b1
k
b2
(1)
Construct a bond graph model, assign causality, and expose the alge-
braic loop.
(2)
Make an arbitrary causal assignment and perform the algebra neces-
sary to allow derivation of state equations. Derive the state equations.
(3)
Add a physical energy storage element that will eliminate the alge-
braic loop, and redraw the bond graph. Derive the system equations.

6
ANALYSIS AND CONTROL
OF LINEAR SYSTEMS
6.1
INTRODUCTION
In the past, a major reason for studying linear models of systems was convenience,
both in the model formulation and in the solution of the resulting differential
equations. But in this book, we have taken pains to point out that with the use of
bond graph methods, nonlinear models are not much more difﬁcult to formulate
than linear ones. This is particularly true when only the 1-port elements have
nonlinear characteristics. Chapters 7, 9, and 12 demonstrate that some types of
physical systems have even more complicated types of nonlinearities, but even
in these cases bond graph methods result in equation sets that can be handled by
computer simulation, as discussed in Chapter 13.
An important reason for the study of linear system models is that complete
analytical solutions to linear differential equations exist, and this allows one to
develop an intuitive feeling for system dynamics in general that is hard to acquire
if only computer solutions are available. Everyone dealing with system dynamics
is expected to be familiar with concepts relating to eigenvalues, free response,
transfer functions and frequency response, even though they do not strictly apply
to real (nonlinear) systems.
In addition, there are many ﬁelds of engineering, such as acoustics, electric
circuit design, structural vibration, and the design of actuators of various types,
in which linear models have proved to be particularly effective. Moreover, the
theory and practice of automatic control have traditionally been based on linear
system theory. So there are good reasons for taking time in this chapter to review
linear system theory and its application to automatic control.
Since linear ordinary differential equations are treated in virtually all engi-
neering and scientiﬁc curricula, we will not attempt to present a mathematically
218
System Dynamics: Modeling, Simulation, and Control of Mechatronic Systems, Fifth Edition
Dean C. Karnopp, Donald L. Margolis and Ronald C. Rosenberg
Copyright © 2012 John Wiley & Sons, Inc.

SOLUTION TECHNIQUES FOR ORDINARY DIFFERENTIAL EQUATIONS
219
rigorous and complete account here. Our purpose is rather to point out some
features of the theory of linear ordinary differential equations that are signiﬁcant
for the understanding and design of dynamic systems and methods of controlling
such systems so as to perform in a desirable manner.
Although a system model can, in principle, be described by a single high-order
differential equation as mentioned in Chapter 5, in this chapter we concentrate on
equivalent sets of ﬁrst-order equations. As shown in Chapter 5 this state equation
form is produced naturally by bond graph models, and it is particularly suitable
for machine computations. When the model is linear, it is convenient to use a
vector matrix form as a way of representing the equations. In fact, matrices will
be used mainly as a convenient notation to describe system models of any order.
Only minimal knowledge of matrix operations will be assumed.
It is still quite common for books on system dynamics or automatic control to
introduce Laplace transforms for solving constant coefﬁcient linear differential
equations (see Reference [1]). This technique changes a differential equation
problem to an algebraic problem involving the Laplace variable s instead of time,
t. At one time, the use of Laplace transform techniques was one of the convenient
ways to solve linear differential equations analytically. But with the advent of
computer simulation it has become easy to solve linear equations numerically,
so now this aspect of Laplace transform methods is of diminished utility.
In the present exposition an alternative approach will be used based on the
general assumption that solutions are of the form Aest for special values of the
variable s. The results derived below are the same as if Laplace transforms had
been used, but the approach seems more fundamental and avoids the necessity
of discussing the transform techniques in detail.
6.2
SOLUTION TECHNIQUES FOR ORDINARY
DIFFERENTIAL EQUATIONS
Before discussing the characteristics of linear state equations, it is useful to note
that it is not difﬁcult in principle to ﬁnd one or more solutions to general state
equations, using a computer if necessary. In most of the examples encountered
so far, the physical system model yielded state equations of the form
˙x1 = f1(x1, x2, . . . , xn; u1, u2, . . . , ur),
˙x2 = f2(x1, x2, . . . , xn; u1, u2, . . . , ur),
...
˙xn = fn(x1, x2, . . . , xn; u1, u2, . . . , ur),
(6.1)
where x1, . . . , xn are state variables (typically p’s or q’s in bond graph terms)
and u1, . . . , ur are input variables (typically e’s or f ’s from sources).

220
ANALYSIS AND CONTROL OF LINEAR SYSTEMS
In addition, there may be output variables y1, . . . , ys statically related to the
state and input variables:
y1 = g1(x1, x2, . . . , xn; u1, u2, . . . , ur),
y2 = g2(x1, x2, . . . , xn; u1, u2, . . . , ur),
...
ys = gs(x1, x2, . . . , xn; u1, u2, . . . , ur).
(6.2)
In general, the f and g functions are nonlinear, but we will mainly consider
linear functions. The linear versions of Eqs. (6.1) and (6.2) are
˙x1 = a11x1 + a12x2 + · · · + a1nxn + b11u1 + b12u2 + · · · + b1rur,
˙x2 = a21x1 + a22x2 + · · · + a2nxn + b21u1 + b22u2 + · · · + b2rur,
...
˙xn = an1x1 + an2x2 + · · · + annxn + bn1u1 + bn2u2 + · · · + bnrur,
(6.1a)
and
y1 = c11x1 + c12x2 + · · · + c1nxn + d11u1 + d12u2 + · · · + d1rur,
y2 = c21x1 + c22x2 + · · · + c2nxn + d21u1 + d22u2 + · · · + d2rur,
...
ys = cs1x1 + cs2x2 + · · · + csnxn + ds1u1 + ds2u2 + · · · + dsrur.
(6.2a)
Instead of writing out all the a, b, c, and d coefﬁcients for linear systems,
as in Eqs. (6.1a) and (6.2a), one can write the equations in a condensed vector
matrix form as follows:
[˙x] = [A][x] + [B][u],
(6.1b)
[y] = [C][x] + [D][u].
(6.2b)
A comparison of this symbolic form with the explicit forms, Eqs. (6.1a) and
(6.2a), should make it clear that [x] is an n-dimensional column vector of the
state variables, [˙x] is a vector of the derivatives of the state variables, [u] is an
r-dimensional column vector of the input variables, [A] is an n × n matrix of
the aij coefﬁcients, [B] is an n × r matrix of the bij coefﬁcients, [C] is an s × r
matrix of the cij coefﬁcients, and [D] is an s × r matrix of the dij coefﬁcients.
All that one needs to know at this point is that row by column multiplication of
matrices and column vectors in Eqs. (6.1b) and (6.2b) yields the explicit forms
of Eqs. (6.1a) and (6.2a).
In this chapter we will be concerned with the special case of system equations
that not only are linear but also have constant coefﬁcients. Occasionally, the

SOLUTION TECHNIQUES FOR ORDINARY DIFFERENTIAL EQUATIONS
221
situation arises in which linear equations have coefﬁcients that vary in time. In
matrix form this could be represented as
[˙x] = [A(t)] [x] + [B(t)] [u].
(6.3)
The theory of systems in which some of the coefﬁcients vary in time is quite
complicated, and since such equations do not arise often, we will not deal with
them here.
Equations (6.1), (6.1a), (6.1b), (6.2), (6.2a), and (6.2b) describe state-
determined systems. To completely specify a problem to be solved, more informa-
tion than just the equations is needed. Typically, the input variables are speciﬁed
as functions of time:
u1 = u1(t),
u2 = u2(t),
...
ur = ur(t).
(6.4)
In addition, a particular trajectory in state space must be singled out for atten-
tion. One main concern will be with initial-condition problems in which the state
at some initial time, t0, is known:
x1(t0) = x10,
x2(t0) = x20,
...
xn(t0) = xn0,
(6.5)
where x10 to xn0 are the initial states. Note that given the information in Eqs. (6.4)
and (6.5), the initial output variables are determined; for example,
y1(t0) = g1[x10, x20, . . . , xn0; u1(t0), u2(t0), . . . , ur(t0)].
One may also determine ˙x1(t0) to ˙xn(t0) using Eq. (6.1); for example,
˙x1(t0) = f1[x10, x20, . . . , xn0; u1(t0), u2(t0), . . . , ur(t0)].
In principle, it is easy to compute how the system changes in a short interval
of time, t, using the concept of a derivative directly. For example,
x1(t0 + t) ∼= x1(t0) + ˙x1(t0)t = x10 + ˙x1(t0)t.
(6.6)
This equation is really just a rearrangement of the deﬁnition of a derivative,
˙x1 ≡dx1
dt = lim
t→0
x1(t0 + t) −x1(t0)
t

,
in which t is small but ﬁnite. Since ˙x1(t0) depends on the initial state and
the u’s at t0 that are known, one can use Eq. (6.6) to ﬁnd the state at t0 + t.

222
ANALYSIS AND CONTROL OF LINEAR SYSTEMS
This is sometimes called Euler’s formula for integrating equations, and it may
be applied to all the state equations at t = t0. It can be reapplied at t = t0 + t,
since the u’s are known at any time, and after applying Eq. (6.6) at t0, the state
at t0 + t is then known. The equation may then be applied recursively to march
the solution along in time as far as desired. The process described above is readily
adapted to automatic digital computation, but there is a snag. Equation (6.6) is
not exactly correct except in the limit as t →0. As t is made very small, the
approximation generally becomes increasingly accurate, but it takes more steps
and more evaluations of the functions to cover any given time span of interest.
The problem of choosing suitable time increments t and recursion formulas
analogous to Eq. (6.6) to optimize digital integration accuracy falls in the domain
of numerical methods, and there is a wealth of literature on this subject. Here it
sufﬁces to note that methods to integrate state equations exist in profusion and
that, despite its obviousness, Euler’s formula often turns out to be quite inefﬁcient
compared to other techniques.
The integration of state equations is straightforward, but when the equations
are linear, one may say a great deal about the totality of possible systems behavior
without the necessity of ﬁnding many solutions for various initial conditions and
forcing functions. As will be demonstrated, linear systems obey the principle
of superposition, which states that any scaled sum of solutions to linear state
equations is also a solution. The superposition property allows one to consider a
particular solution to the state equations to be the sum of a response due to initial
conditions, or free response (in which all input variables vanish), and a response
due to inputs or forced response. Additionally, if we know the forced response of
a linear system to several inputs, each acting one at a time, then the solution when
all inputs are acting together is just the sum of each individual response. Also,
since the free-response component of the total system response has to do only with
the [A] matrix in the state equations, this response may be used to characterize the
system in a useful manner. We may discover natural frequencies, time constants,
and stability properties that, in contrast to the general case, have nothing to do
with initial conditions or forcing terms and help in understanding how the system
would behave in a variety of situations.
There are three extremely important linear system concepts that contribute
the most to our understanding the dynamics of physical systems and our ability
to develop controllers that can change a systems natural behavior. These con-
cepts are associated with the words eigenvalue, transfer function, and frequency
response and they are presented in the next sections.
6.3
FREE RESPONSE AND EIGENVALUES
Consider now the linear case represented in the form of Eqs. (6.1a) and (6.2a)
or in the vector matrix form of Eqs. (6.1b) and (6.2b) and assume that the input
variables are all zero. When a solution for this case is found, it will be called
the free response and it will have to do only with initial conditions, not input

FREE RESPONSE AND EIGENVALUES
223
variable forcing. We consider a ﬁrst-order system at the onset and then move on
to an example with multiple state variables.
6.3.1
A First-Order Example
Figure 6.1 shows a simple model of an elastomeric mount commonly used to
provide isolation between a load (not shown) and the ground. The mount exhibits
some spring-like effect and some damping-like effect and these are represented
by the linear spring with spring constant k and the damper with constant b. The
applied force at the top Fin completes this simple model. The bond graph for this
system is also shown in Figure 6.1 and causality dictates that there is one state
variable q, the displacement across the spring.
The state equation for this ﬁrst-order system is
˙q = −(k/b)q + (1/b)Fin.
(6.7)
The free response of the system does not depend on the external forcing so
we let Fin = 0 in order to pursue the free response. Thus, the governing equation
simpliﬁes to
˙q = −(k/b)q.
(6.8)
For all free-response equations such as Eq. (6.8), there is a trivial solution in
which the state variables as well as their derivatives are all zero. (In this case, the
trivial solution to Eq. (6.8) is obviously ˙q = q = 0.) A more general assumption
that proves useful for all linear systems is that the solution is exponential, for
example,
q(t) = Qest,
(6.9)
where the constants Q and s are to be adjusted, if possible, to make sure that
q(t) ﬁts the differential equation and the initial conditions.
Substituting Eq. (6.9) into Eq. (6.8) (noting that ˙q = Qsest), we ﬁnd
Qsest = −(k/b)Qest
(6.10)
or
(s + k/b) Qest = 0.
(6.11)
1
R
1/k:C
e
S
Fin
k
b
(a)
(b)
v
:b
:
in
F
q.
FIGURE 6.1. First-order example system: (a) schematic diagram; (b) bond graph.

224
ANALYSIS AND CONTROL OF LINEAR SYSTEMS
For a solution to exist, either
Qest = 0,
in which case we return to the trivial solution, or else
s + k/b = 0
or
s = −k/b.
(6.12)
Equation (6.12) is called the characteristic equation and the value of s that is
a solution to the characteristic equation is called the eigenvalue.
The solution of Eq. (6.9) using the eigenvalue of Eq. (6.12) is
q(t) = Qe−(k/b)t = Qe−t/τ,
(6.13)
where the time constant, τ, has been deﬁned as τ = b/k seconds. (The time
constant must have the same units as t so that the exponent −t/τ is dimensionless,
as it must be.)
To complete the solution, the constant Q can be found from the initial value
of the displacement q(0) = q0:
q(0) = Qe−0 = Q,
(6.14)
where the constant q(0) is simply the value of the spring displacement at t = 0.
The solution is then
q(t) = q(0)e−t/τ,
t ≥0.
(6.15)
This solution is shown in Figure 6.2. For this simple exponential solution, it is
readily shown that, at any point on the curve, if one extends a straight line along
the local slope of the curve to the steady-state value of q (zero in this case), it
will intersect after τ time units have elapsed. Thus, τ sets the basic timescale
of the response. If a system response is measured experimentally, one can easily
estimate τ as shown in Figure 6.2 and one can check to see how well a linear,
ﬁrst-order constant-parameter system would reproduce the measured response
t
q(0)
e
e2
2τ
τ
3τ
q(t)
q(0)
q(0)
FIGURE 6.2. Free response of the system in Figure 6.1.

FREE RESPONSE AND EIGENVALUES
225
by computing τ at several points on the experimental curve. In the parlance of
system dynamics we say that the response is 63% complete after 1 time constant
(e−1 = 0.37) and virtually complete after about 4 time constants (e−4 ≈0.02).
Theoretically, of course, q(t) would continue to approach zero exponentially for
a truly linear system but for a real physical system, nonlinear effects will become
important for very small values of q.
6.3.2
Second-Order Systems
Although knowledge of ﬁrst-order system response will prove very useful, it
must be obvious that more complex systems respond in ways much more com-
plicated than the exponential of Figure 6.2. Surprisingly, the pattern of analysis,
somewhat generalized, does carry over for arbitrarily high-order systems. In fact,
understanding the response of a ﬁrst-order system and then the response of a
second-order system, the pattern will become evident, and the extension to nth-
order systems is straightforward.
Consider, then, the simple second-order example shown in Figure 6.3. The
spring and damper connecting the cart to the load mass could very well be the
mount from Figure 6.1. To make the correspondence between the system from
Figure 6.3 and the general equations (6.1a) and (6.2a), we write the state equations
in a standard form using causality and the formulation procedure from Chapter 5.
Thus,
˙x = 0x −(1/m)p + 1V + 0F,
˙p = kx −(b/m)p + bV + 1F.
(6.16)
These equations are shown in Figure 6.3c.
FIGURE 6.3. Example system: (a) schematic diagram; (b) bond graph; (c) state
equations.

226
ANALYSIS AND CONTROL OF LINEAR SYSTEMS
The force f , which is the sum of the forces in the spring and damper, is just
one of several possible output variables. Following the causal information in the
bond graph yields
f = kx −(b/m)p + bV + 0F.
(6.17)
The system has two state variables, x1 = x, x2 = p; two input variables, u1 =
V , u2 = F, and one output variable, y1 = f . The matrices for the forms of
Eqs. (6.1b) and (6.2b) are then related to the system parameters as follows:
[A] =
0
−1/m
k
−b/m

, [B] =
1
0
b
1

, [C] = [k
−b/m], [D] = [b
0].
(6.18)
Note that in Figure 6.3c the notations V (t) and F(t) are used as a reminder
that these input quantities must be speciﬁed functions of time before the state
equations can be solved.
For the free response and to derive the eigenvalues there is no dependence on
the external inputs so we let V (t) = F(t) = 0, such that
 ˙x
˙p

=
0
−1/m
k
−b/m
 x
p

.
(6.19)
In general terms, this equation could be written simply as [˙x] = [A][x], which
is Eq. (6.1b) with [u] = [0].
The trivial solution to Eq. (6.19) is evident. It is
x ≡0,
p ≡0.
(6.20)
This solution corresponds to the case in which the spring is unstretched and
the mass has no momentum (or velocity). In other words, a possible solution for
the free response of a linear system is that it does absolutely nothing. As in the
ﬁrst-order system example, this solution is, again, not very useful and is of no
help in ﬁtting given initial conditions. Suppose a solution satisfying
x(t0) = x0,
p(t0) = p0
(6.21)
is desired, where x0 is the initial stretch in the spring and p0 = mv0 is the initial
momentum of the mass.
To ﬁnd the solution, assume that both energy-state variables may be repre-
sented by an amplitude times an exponential time function. In the example, we
assume
x(t) = Xest,
p(t) = Pest,
(6.22)
where X and P are constant amplitudes and s is a number with the dimension of
inverse time. (A complication not evident in the ﬁrst-order example is that X, P,
and s all may turn out to be complex numbers.) If the assumption of Eq. (6.22)

FREE RESPONSE AND EIGENVALUES
227
is substituted into Eq. (6.19), the result is

sX
sP

est =

0
−1/m
k
−b/m
 
X
P

.
(6.23)
The left side of Eq. (6.23) can be written in a form similar to the right side
by using the 2 × 2 unit matrix
[I] =

1
0
0
1

(6.24)
such that

sX
sP

est = s

1
0
0
1
 
X
P

est =

s
0
0
s
 
X
P

est.
(6.25)
With this idea, the two sides of Eq. (6.23) can be combined. A single matrix
is then involved.

s
1/m
−k
s + b/m
 
X
P

est =

0
0

.
(6.26)
We can see now that the single matrix on the left side of Eq. (6.26) is just
[sI −A]. This is a very important matrix that is composed simply of the negative
of the [A]-matrix with [sI] adding s terms along the main diagonal. This matrix
will be important for systems of any order when analyzing the free response
where [I] is the general n × n unit matrix with 1’s on the main diagonal and 0’s
elsewhere, and [A] is the system matrix from Eq. (6.1b).
Now Eq. (6.26) shows that the assumption of Eq. (6.22) has reduced the dif-
ferential equation problem to an algebraic problem. (The Laplace transformation
also achieves this reduction.) One way to solve Eq. (6.26) would be to have est
vanish. Not only is this not really possible for any ﬁnite value of s, but the result
leads only to the trivial solution of Eq. (6.20). Rejecting this possibility, one can
divide out the est term and concentrate on solving for X and P that satisfy

s
1/m
−k
s + b/m
 
X
P

=

0
0

.
(6.27)
Once again, the trivial solution appears, since clearly X = 0, P = 0 is a
solution to Eq. (6.27). The elementary theory of linear algebra contains the result
that if the determinant of the matrix [sI −A] is not zero, there is a single unique
solution. Since we know that there always is a trivial solution, we look for the
condition for which nonzero values of X and P can result. This requires that the
determinant of the matrix [sI −A] should be zero. To continue with our pursuit
of a nontrivial solution, then, we require
Det

s
1/m
−k
s + b/m
 = 0
(6.28)
or
s2 + (b/m)s + (k/m) = 0.
(6.29)

228
ANALYSIS AND CONTROL OF LINEAR SYSTEMS
The requirement that this determinant vanish leads to the requirement that
a polynomial in s must vanish. Equation (6.29) is the characteristic equation
for this system and leads to a set of eigenvalues or characteristic values for s.
Equation (6.6) was the characteristic equation for our ﬁrst example. (In German,
a characteristic value is called an eigenwert, and in English the mongrel term
eigenvalue is commonly used. Why “characteristic wert” never caught on remains
a mystery.) In what follows, we will generally use the term eigenvalue in place
of the words characteristic value.
Solving Eq. (6.29), we ﬁnd two eigenvalues for this second-order system:
s1 = −(b/2m) + [(b/2m)2 −(k/m)]1/2,
s2 = −(b/2m) −[(b/2m)2 −(k/m)]1/2.
(6.30)
Note that s1 and s2 will be complex for small values of the damping constant
b since then Eq. (6.30) will involve the square root of a negative number. For
each value of s that is determined from an equation such as Eq. (6.29), a nonzero
solution satisfying Eq. (6.27) may be found. For an nth-order system, there will
be n eigenvalues. In our second-order example, there are two. For high-order
systems it will generally not be possible to solve for the characteristic values
without resorting to numerical methods, but the existence of n roots of an nth-
order characteristic equation is ensured by the theory of linear algebra.
Much useful information is contained in the eigenvalues of Eq. (6.30) them-
selves, but before discussing what insights can be attained by simply solving the
characteristic equation, let us outline the procedure for ﬁnding a complete free
response satisfying given initial conditions.
Having pursued the solution to this point, the next question might be: Since we
used the condition for there to exist nonzero values of X and P, what are these
nonzero values? For each value of s, s1, and s2, let us attempt to determine X and
P values from Eq. (6.27). For s1 we attempt to ﬁnd X1 and P1 by substituting
the eigenvalue back into Eq. (6.27) with the result for s1:
s1X1 + (1/m)P1 = 0,
−kX1 + (s1 + b/m) P1 = 0.
(6.31)
By all appearances it looks like we have two equations for the two unknowns
X1, P1 and we should be able to solve for each individually. However, the con-
dition that Det[sI −A] = 0 has additionally guaranteed that the two equations in
(6.31) are not independent. In fact, when s1 is substituted into Eqs. (6.31), they
each will be found to contain the same information. Thus, the best we can do is
determine one of the constants in terms of the other, thus:
X1 = −(1/ms1)P1
or
X1 = (1/k)[s1 + (b/m)]P1.
(6.32)
If the value of s1 from Eq. (6.30) is substituted into either of the equations in
Eq. (6.32) it will be found that they both give the same relation between X1 and
P1. Whenever an eigenvalue is substituted into equations for amplitudes, such
as Eq. (6.27), the equations will be found not to be independent. In the present

FREE RESPONSE AND EIGENVALUES
229
example this means that the ratio of X1 to P1 in (6.32) is determined, but not
the magnitude of either one. In general for higher-order systems, the most one
can expect to solve for is the ratios of n −1 amplitudes in terms of one arbitrary
amplitude.
If we return to Eq. (6.27) and use s2 from Eq. (6.30) to solve for amplitudes
X2 and P2, we again ﬁnd that both equations are equivalent so only the ratio of
X2 to P2 is determined:
X2 = −(1/ms2)P2
or
X2 = (1/k)[s2 + (b/m)]P2.
(6.33)
Now whenever X1 and P1 are related according to Eq. (6.32), Eq. (6.27) will
be satisﬁed, and the original differential equation Eq. (6.26) will be satisﬁed by
x(t) = X1es1t,
P(t) = P1es1t.
Similarly, another solution is
x(t) = X2es2t,
p(t) = P2es2t
whenever X2 and P2 satisfy Eq. (6.33). It is also easy to verify that another valid
free-response solution is obtained by adding the two solutions together:
x(t) = X1es1t + X2es2t,
p(t) = P1es1t + P2es2t.
(6.34)
This is an example of the principle of superposition for linear systems and is
readily veriﬁed by simply substituting Eq. (6.34) into Eq. (6.27) and noting that
as long as the components of the sum satisfy the differential equations, so does
the sum.
Although s1 and s2 are completely determined by Eq. (6.30), the four quantities
X1, X2, P1, and P2 are so far related only by the two relations (6.32) and (6.33).
Two more conditions are necessary to specify the free response completely, and
these are provided by the two initial conditions of Eq. (6.21) and solving:
x0 = x(t0) = X1es1t0 + X2es2t0,
(6.35)
p0 = p(t0) = P1es1t0 + P2es2t0.
(6.36)
Thus, the four equations (6.32), (6.33), (6.35), and (6.36) completely specify
the free response of the system, satisfying the given initial conditions. Although
in this simple case one could actually solve these equations completely, this is
rarely attemped now that computer simulation is so easy.
What is important at this point in the development is that the eigenvalues
appear as arguments of exponentials and appear in the system response as shown
in Eq. (6.34). It is nice to know that we could solve for the complete free
response but we are rarely interested in the free response alone. We are much more
concerned with the forced response or the total response including both the free
response and the response due to forcing. It is understanding the nature of the free
response that is important and we pursue this goal in the next section.

230
ANALYSIS AND CONTROL OF LINEAR SYSTEMS
6.3.3
Example: The Undamped Oscillator
To gain understanding of the physical system response from Figure 6.3 we ﬁrst
set the dashpot parameter b to zero, leaving a system composed of only a spring
and a mass. The characteristic equation (6.29) becomes
s2 + (k/m) = 0,
(6.37)
which yields the eigenvalues
s1 = +j (k/m)1/2 = jωn,
s2 = −j (k/m)1/2 = −jωn,
(6.38)
where j ≡(−1)1/2 and the undamped natural frequency ωn is deﬁned as
(k/m)1/2. In distinction to the ﬁrst-order example that had a real eigenvalue,
we now have encountered purely complex eigenvalues.
The solution from Eq. (6.34) then becomes
x(t) = X1ejωnt + X2e−jωnt,
(6.39)
p(t) = P1ejωnt + P2e−jωnt
(6.40)
where the purely complex eigenvalues end up in complex exponentials in the
solution.
Recall, if you can, that the sine and cosine functions can be expressed in terms
of complex exponentials as
cos ωnt = ejωnt + e−jωnt
2
(6.41)
sin ωnt = ejωnt −e−jωnt
2j
,
(6.42)
yielding the Euler relationships:
e+jωnt = cos ωnt + j sin ωnt
(6.43)
e−jωnt = cos ωnt −j sin ωnt.
(6.44)
Thus, the complex eigenvalues indicate an oscillatory time response at the
frequency ωn rad/s.
If Eqs. (6.43) and (6.44) are substituted into the solution from Eqs. (6.39) and
(6.40), it appears that the real response x(t) and p(t) have the complex number
j =
√
−1 as part of the solution. It is not difﬁcult to show that while X1, X2
and P1, P2 are constants, they are complex constants and, in fact, are complex
conjugate constants. That is, if
X1 = ax + jbx
(6.45)
then
X2 = ax −jbx;
(6.46)

FREE RESPONSE AND EIGENVALUES
231
and similary, if
P1 = ap + jbp,
(6.47)
then
P2 = ap −jbp.
(6.48)
There are still only two constants associated with x(t) and two constants
associated with p(t), so nothing has changed with respect to obtaining a solution
if one chooses to pursue it.
Using (6.45) through (6.48) with (6.43) and (6.44) in the solution expressions
(6.39) and (6.40) will yield the time response as
x(t) = Ax cos ωnt + Bx sin ωnt,
p(t) = Ap cos ωnt + Bp sin ωnt,
(6.49)
where, if all the algebra was carried out, one would discover:
Ax = 2ax, Bx = −2bx, Ap = 2ap, Bp = −2bp.
(6.50)
The real constants Ax, Bx, Ap, Bp would be determined from initial condi-
tions.
The really important result here is that the complex eigenvalues s1,2 = ±jωn
indicate an oscillatory response at the frequency ωn rad/s or a cyclic frequency
fn = ωn/2π Hz.
Another way to represent Eq. (6.49) is as a single harmonic with a phase angle
ϕ and an amplitude A, thus:
x(t) = A cos(ωnt + ϕ)
(6.51)
and
A =

A2
x + B2
x
1/2 ,
φ = tan−1(Bx/Ax).
(6.52)
There are still just two unknown constants, A and φ. A similar expression can
be written for p(t).
Another commonly used notation involves the “real part of” operator Re( • )
and the “imaginary part of,” operator Im( • ). Sine and cosine functions are readily
expressed in terms of these functions as follows:
cos ωnt = Re

ejωnt
,
(6.53)
sin ωnt = Im

ejωnt
.
(6.54)
Then x(t) may be expressed in yet another way as
x(t) = A Re

ej(ωnt+φ)
= Re

Aejφejωnt
.
(6.55)
Equation (6.55) is sometimes simpler to use than some other equivalent rep-
resentations, since it deals with only an amplitude A, the angle φ and one of the
pair e+jωnt, e−jωnt.

232
ANALYSIS AND CONTROL OF LINEAR SYSTEMS
6.3.4
Example: The Damped Oscillator
When the dashpot coefﬁcient b is positive and not too large, the free response of
the system will be oscillatory but will eventually damp out. The eigenvalues of
Eq. (6.30) clearly change character, depending on whether the expression under
the radical is positive or negative. If
(b/m)2 < 4k/m,
(6.56)
the system is said to be underdamped; if
(b/m)2 > 4k/m,
(6.57)
the system is said to be overdamped; and if
(b/m)2 = 4k/m,
(6.58)
the system is said to be critically damped.
Often the characteristic equation (6.29) is written as follows:
s2 + 2ζωns + ω2
n = 0,
(6.59)
in which the undamped natural frequency ωn is as deﬁned by Eq. (6.38), and the
damping ratio ζ is given as
ζ ≡b/2mωn = b/2(mk)1/2.
(6.60)
Then the system is underdamped, overdamped, or critically damped, depending
on whether ζ < 1, ζ > 1, or ζ = 1. With these deﬁnitions, the eigenvalues for
the underdamped case of Eq. (6.30) may be written
s1 = −ζωn + jωn(1 −ζ 2)1/2,
s2 = −ζωn −jωn(1 −ζ 2)1/2.
(6.61)
We would still interpret the imaginary part of the eigenvalue as a frequency
and it is customary to deﬁne the damped natural frequency as
ωd ≡ωn
	
1 −ς2,
(6.62)
allowing the eigenvalues to be expressed as
s1 = −ζωn + jωd, s2 = −ζωn −jωd.
(6.63)
The free-response solution, Eq. (6.34), becomes a bit more complicated than
in the undamped case because the eigenvalues are now complex numbers rather
than pure imaginary numbers. For x(t) the free response looks like
x(t) = X1e(−ςωn+jωd)t + X2e(−ςωn−jωd)t.
(6.64)

FREE RESPONSE AND EIGENVALUES
233
From the rules for multiplication of exponentials, Eq. (6.64) can be written as
x(t) = e−ςωnt(X1ejωdt + X2e−jωdt).
(6.65)
The term e−ζωnt is real and decreases exponentially with time. (In the previous
section, ζ was equal to zero, and this factor remained unity.) The second factor in
Eq. (6.65) looks very much like the response from Eq. (6.39) and can be reduced
to a harmonic oscillation at the damped natural frequency ωd with the general
form
x(t) = e−ςωnt(Ax cos ωdt + Bx sin ωdt).
(6.66)
The end result is a decaying exponential multiplying an oscillatory term.
Figure 6.4 shows the general appearance of a decaying oscillatory response.
It appears that interpreting the meaning of eigenvalues is not that difﬁcult.
They can be complex numbers, meaning they have a real part and an imaginary
part. It appears that if one eigenvalue is a complex number, then another eigen-
value is the complex conjugate of the ﬁrst. It also appears that the real parts of
both eigenvalues, −ςωn in this example, indicates decay of the response. (What
if the real part were positive?) The imaginary part of the eigenvalue, ωd in this
example, indicates that the system can oscillate.
From Eq. (6.62) it is apparent that when damping is present, the oscillation
frequency is different than the undamped natural frequency. From (6.62) we can
derive

ωd
ωn
2
+ ζ 2 = 1.
(6.67)
This relationship is plotted in Figure 6.5. From this ﬁgure it is apparent that the
damping ratio must be quite high to reduce the oscillation frequency signiﬁcantly.
FIGURE 6.4. Time response for underdamped system.

234
ANALYSIS AND CONTROL OF LINEAR SYSTEMS
FIGURE 6.5. Variation of damped natural frequency with damping ratio.
Since so much understanding of the general nature of the free response is con-
tained in the roots of the characteristic equation (i.e., the eigenvalues), it is useful
to show how the damping ratio and the damped and undamped natural frequen-
cies are correlated with the locations in the “complex” plane of the eigenvalues s1
and s2. This is shown in Figure 6.6, where the real part of the eigenvalue is shown
along the horizonatal R -axis and the imaginary part is along the vertical I -axis.
For the underdamped case with ς < 1 the eigenvalues are complex conjugates
and this is shown as s1 and s2 in the ﬁgure.
FIGURE 6.6. Correlation of natural frequencies and damping ratio with location of eigen-
values in the complex plane for underdamped case.

FREE RESPONSE AND EIGENVALUES
235
Stable systems have all their eigenvalues in the left half of the complex
plane; that is, for stable systems the real components of all the esit factors in the
free response represent decreasing exponentials. Starting from any initial condi-
tions, all stable systems have only components that decay toward the zero state.
Unstable systems have at least one eigenvalue in the right half plane so that
some components increase exponentially with time. The intermediate case of the
undamped oscillator corresponds to purely imaginary values of s on the jω-axis.
For the overdamped oscillator, ζ > 1, the character of the eigenvalues of
Eq. (6.30) changes, and it is convenient to rewrite Eqs. (6.61) as
s1 = −ζωn + ωn(ζ 2 −1)1/2,
s2 = −ζωn −ωn(ζ 2 −1)1/2.
(6.68)
These roots are plotted in Figure 6.7. Note that for 1 < ζ < ∞the roots s1 and
s2 are negative and real. In such a case, terms of the form est are conveniently
written in terms of a time constant τ, as was done for the ﬁrst-order case. Thus,
in Figure 6.7, s-values far out on the negative real axis correspond to quickly
decreasing real exponentials.
Also, it is clear that the real part of s1 and s2 in Figure 6.6, ζωn, corresponds
to a time constant of 1/ζωn (in fact, time constants are always τi = 1/Re(si)).
Eigenvalues on the positive real axis also possess time constants but represent
exponential solutions that increase in time. A value of s = 0 implies a time-
response component of e0t = 1, or a constant component: an inﬁnite time
constant.
Before leaving this section it is useful to summarize our observations about
eigenvalues.
1. There is always the same number of eigenvalues as there are system state
variables when using a bond graph to model a system.
2. Eigenvalues can be real numbers, imaginary numbers, and/or complex num-
bers with real and imaginary parts.
3. Complex eigenvalues will always appear as complex conjugate pairs.
Eigenvalues always appear in the system response as arguments of exponen-
tials. This allows the interpretation that real parts of eigenvalues always indicate
FIGURE 6.7. Eigenvalues for overdamped case.

236
ANALYSIS AND CONTROL OF LINEAR SYSTEMS
exponential growth or decay and imaginary parts of eigenvalues are frequencies
at which the system response oscillates.
System stability is indicated by the signs of the real eigenvalues and/or the
real parts of the complex eigenvalues. A system with all its eigenvalues in the left
half of the complex plane is stable. A system with one or more of its eigenvalues
in the right half of the complex plane will have at least part of its free response
increasing exponentially with time and is thus unstable.
A study of the coefﬁcients of the characteristic equation can often determine
the nature of the eigenvalues without actually solving for them numerically. See
the discussion of the Routh stability criterion in Reference [1], for example.
6.3.5
The General Case
Although only ﬁrst- and second-order systems have been studied above, the
characteristics of the free response of all linear systems are not much more
complicated. The procedure for ﬁnding the free response is summarized below:
1. Neglect all forcing terms. In the general equations of (6.1a) or (6.1b), let
u1, u2, . . . , ur all vanish.
2. Assume each state variable xi will possess solutions of the form Xiest.
After canceling out the est terms, Eq. (6.1a) becomes a purely algebraic
equation:
(s −a11)X1 −a12X2 −· · · −a1nXn = 0,
−a21X1 + (s −a22)X2 −· · · −a2nXn = 0,
...
−an1X1 −an2X2 −· · · + (s −ann)Xn = 0.
(6.69)
Note that this equation is the general version of Eq. (6.36b) and, in con-
densed form, can be written [sI −A][X] = [0]. This set of equations always
possesses a trivial solution, X1 = X2 = · · · = Xn = 0, which is the only
solution unless the determinant of [sI −A] is zero:
Det

s −a11
−a12
· · ·
−a1n
−a21
s −a22
· · ·
−a2n
...
...
...
...
−an1
−an2
· · ·
s −ann

= 0.
(6.70)
This is the general version of the example determinant shown in Eq. (6.28).
When the determinant is expanded out into an nth-order polynomial in
s, the characteristic equation results.
3. Solve the characteristic equation for the n eigenvalues s1, s2, . . . , sn. The
s-values will either be real or, if complex, will occur in complex conjugate
pairs. The location of the eigenvalues in the complex plane indicates the

FREE RESPONSE AND EIGENVALUES
237
type of component of the free response that is associated with the eigen-
values. Figure 6.8 indicates how root location may be correlated with time
response. Stable systems possess eigenvalues with negative real parts.
4. For each value of s corresponding to an eigenvalue, Eq. (6.69) yields a
partial solution. When the eigenvalues are distinct, that is, when no two
of the n eigenvalues are exactly equal, then n −1 of the n equations in
Eq. (6.69) will be found to be independent when an eigenvalue is substituted
for s.∗One could then solve for n −1 of the X’s in terms of the last X,
for example. The total solution for the free response is
x1(t) = X11es1t + X12es2t + · · · + X1nesnt,
x2(t) = X21es1t + X22es2t + · · · + X2nesnt,
...
xn(t) = Xn1es1t + Xn2es2t + · · · + Xnnesnt,
(6.71)
where X11, X21, X31, . . . , Xn1 appear in Eq. (6.69) when s = s1; X12, X22,
X32, . . . , Xn2 appear in Eq. (6.69) when s = s2; and so on. The n2 values
of Xji in Eq. (6.71) cannot be completely determined by writing Eq. (6.69)
for each eigenvalue si, since in this manner only n(n −1) independent
equations will be obtained. The remaining n conditions are represented by
the n arbitrary initial conditions
x1(t0) = x10 = X11es1t0 + X12es2t0 + · · · + X1nesnt0,
x2(t0) = x20 = X21es1t0 + X22es2t0 + · · · + X2nesnt0,
...
xn(t0) = xn0 = Xn1es1t0 + Xn2es2t0 + · · · + Xnnesnt0,
(6.72)
where x10, x20, . . . , xn0 are the given initial conditions.
Only for very low-order systems is it possible to carry out the operations
outlined in Eqs. (6.71) and (6.72) that lead to analytical expressions for the
free response. Yet any number of computer simulation programs can numerically
solve the unforced equations, given the matrix and the initial conditions. Thus,
it is easy to obtain plots of the free response of all the state and output variables
if desired.
Furthermore, there are many programs that will calculate the eigenvalues,
given only the [A] matrix. Thus, one can understand the qualitative nature of all
the components of a system’s free response using the ideas behind Figure 6.8
without computing any speciﬁc free responses. For example, it is easy to see if
∗The special case when roots of the characteristic equation are repeated is treated in all books
on differential equations. It is rarely important in practice, so we will not discuss it here.

238
ANALYSIS AND CONTROL OF LINEAR SYSTEMS
FIGURE 6.8. Correlation of time response with complex eigenvalues.

TRANSFER FUNCTIONS
239
the system is unstable by looking for one or more eigenvalues with positive real
parts. One can also look for lightly damped oscillations and ﬁnd their frequencies
by using representations like that of Figure 6.6, and one can ﬁnd the fastest and
slowest response components just by considering the locations of the various
eigenvalues in the s-plane. Eigenvalues farthest from the origin of the s-plane in
any direction represent the fastest response components, and those closest to the
origin represent the slowest response components. Often one can make design
decisions about a dynamic system simply by considering the eigenvalue locations.
6.4
TRANSFER FUNCTIONS
Section 6.3 developed the concept of eigenvalues and showed how the nature
of the system’s initial condition response is dictated by the eigenvalues. It is
deﬁnitely worth the reader’s time to become comfortable with deriving system
equations directly from bond graphs, casting the state equations into the s-domain,
and deriving the characteristic equation from which eigenvalues can be evaluated.
A second very important concept in linear system analysis is the transfer func-
tion. It is the ratio of an output to an input expressed in terms of the s variable
rather than time. As mentioned earlier, the Laplace transform is often used to
convert linear, constant coefﬁcient differential equations in the time domain into
equivalent algebraic equations in the s-domain. It is perhaps more physically
intuitive to convert from the time domain to the s-domain using an exponen-
tial representation and we continue to do this for the development of transfer
functions.
A transfer function is the ratio of output to input in the s-domain. Consider
the ﬁrst-order example from the previous section 6.3.1, where the equation of
motion from Eq. (6.1) is
˙q = −(k/b)q + (1/b)Fin.
(6.73)
To obtain the eigenvalue we previously set the forcing to zero. To pursue the
transfer function relating the response Q(s) to the input F(s) we assume that the
response and input have the form,
Fin(t) = F(s)est, q(t) = Q(s)est, ˙q(t) = sQ(s)est.
(6.74)
Substituting into Eq. (6.73), the transfer function becomes
Q(s)
F(s) =
1/b
s + k/b =
1/b
s + 1/τ =
τ/b
τs + 1.
(6.75)
In automatic control it is typical to represent transfer functions using blocks,
as shown in Figure 6.9. The interpretation is that the input is multiplied by the
contents of the block to produce the output.

240
ANALYSIS AND CONTROL OF LINEAR SYSTEMS
F(s)
Q(s)
1
1
b s
τ
τ +
FIGURE 6.9. Block diagram of the transfer function from Eq. (6.75).
For the second-order example from Section 6.3.2 the state equations repeated
here are
˙x = 0x −(1/m)p + 1V + 0F,
˙p = kx −(b/m)p + bV + 1F.
(6.76)
or in matrix form
d
dt

x
p

=

0
−1/m
k
−b/m
 
x
p

+

1
b

V +

0
1

F.
(6.77)
For the eigenvalue analysis the forcing terms were set to zero. To obtain
transfer functions relating desired outputs to the inputs, we assume
V (t) = V (s)est
F(t) = F(s)est,
x(t) = X(s)est
p(t) = P(s)est,
(6.78)
and substitute into Eq. (6.77) with the result:

s
1/m
−k
s + b/m
 
X(s)
P(s)

=

1
b

V (s) +

0
1

F(s).
(6.79)
The astute reader will recognize that the matrix on the left side of Eq. (6.79)
is identical to the matrix [sI −A] from the eigenvalue analysis using Eq. (6.27).
A general expression for transfer functions obtained from starting points such
as Eq. (6.79) will be shown below. If a speciﬁc input/output transfer function is
desired, then Cramer’s rule [4] can be used to obtain the result. For example, if
you want the transfer function relating the output X(s) to the input V (s), ﬁrst
let the force input F(s) be zero. Then Eq. (6.79) is two algebraic equations for
two unknowns X and P with V as a known forcing quantity.
Cramer’s rule states that the solution for the unknowns will always be the
ratio of two determinants. The denominator will always be the determinant of
the matrix, Det [sI −A]. The numerator determinant will be the determinant of
this matrix but with one column replaced by the forcing column of interest. In
this ﬁrst example, the forcing column is just

1V
bV

. This column is placed in the
[sI −A] matrix in the ﬁrst column to ﬁnd the ﬁrst variable (X), in the second
column to ﬁnd the second variable (P), and so on for higher-order systems.
Since X is the ﬁrst entry in the response vector, the numerator comes from the

TRANSFER FUNCTIONS
241
determinant of the left-side matrix having ﬁrst substituted the forcing vector for
the V input for the ﬁrst column. The denominator for the transfer function is the
determinant of the left-side matrix with no changes made. Since we desire the
ratio X/V we can divide out the V in the forcing column, with the result
X
V (s) =

1
1/m
b
s + b/m


s
1/m
−k
s + b/m

=
s
s2 + (b/m)s + (k/m).
(6.80)
If the response of X to the input F is desired, we assume that V is zero and
use the forcing column appropriate for F. Cramer’s rule then yields
X
F (s) =

0
1/m
1
s + b/m


s
1/m
−k
s + b/m

=
−1/m
s2 + (b/m)s + (k/m).
(6.81)
Notice that the denominator is unchanged from Eq. (6.80).
For the response of P(s) to the input V (s) we put the forcing column for V
in the second column of [sI −A], because P is the second-state variable, to get
P
V (s) =

s
1
−k
b


s
1/m
−k
s + b/m

=
bs + k
s2 + (b/m)s + (k/m).
(6.82)
Notice again that the denominator of the transfer function in Eq. (6.82) is
the same for all the transfer functions we have evaluated. The denominator in
all the transfer functions is exactly the polynomial in s that we found in the
characteristic equation, Eq. (6.29), for this second-order system. This is not a
coincidence and the same idea proves to be true for all systems. Figure 6.10 shows
these transfer functions in block diagram form.
6.4.1
The General Case for Transfer Functions
The general starting point for linear analysis is the matrix format,
[˙x] = [A][x] + [B][u],
[y] = [C][x] + [D][u],
(6.83)
where [x] is the vector of state variables (p’s and q’s from a bond graph), [u] is
the vector of inputs (efforts and ﬂows from source elements from a bond graph),

242
ANALYSIS AND CONTROL OF LINEAR SYSTEMS
V(s)
X(s)
X(s)
P(s)
F(s)
V(s)
s
b
k
s2
s
m
m
+
+
1
m
b
k
s2
s
m
m
−
+
+
bs + k
b
k
s2
s
m
m
+
+
FIGURE 6.10. Block diagram representation of the transfer functions for the second-
order example.
and [y] is a vector of outputs (efforts and ﬂows of interest on various bonds). To
obtain transfer functions we let
[x(t)] = [X(s)]est,
[U(t)] = [U(s)]est.
(6.84)
It is convenient to consider one input at a time and one output at a time such
that substituting (6.84) into (6.83) yields
[sI −A] [X(s)] = [b]U(s).
(6.85)
It is typical to use a lowercase [b] to indicate a column vector when considering
only one input at a time. In fact, (6.83) with (6.84) could be written in terms of
the separate inputs as
[sI −A] [X(s)] = [b1] U1(s) + [b2] U2(s) + [b3] U3(s) + · · · .
(6.86)
Also, when considering only one output at a time it is typical to write the
output equation as
y = [c]t[x],
(6.87)
where [c]t indicates a vector on its side, i.e., a row vector. For simplicity the
single output y is assumed to not have dependence on any inputs. In other words,
the components of the [D] matrix in Eq. (6.83) pertaining to this output happen
to be zero. Some other output certainly could depend explicitly on inputs, which
would somewhat complicate the presentation here.

TRANSFER FUNCTIONS
243
The s-domain representation of the output equation becomes
Y(s) = [c]t[X](s).
(6.88)
We now can symbolically exhibit the transfer function between an output and
input by starting with (6.85) and writing
[X(s)] = [sI −A]−1[b]U(s),
(6.89)
and then use (6.88) with the result
Y(s) = [c]t [X(s)] = [c]t[sI −A]−1[b]U(s).
(6.90)
Finally, the general expression for a transfer function comes from Eq. (6.90) as
Y(s)
U(s) = [c]t[sI −A]−1[b].
(6.91)
Note that for each output and input under consideration there will be speciﬁc
[c]t and [b] vectors.
There is one further symbolic manipulation that can be made to Eq. (6.91)
using the formula for the inverse of a matrix to arrive at the expression
Y(s)
U(s) = [c]tAdj[sI −A][b]
Det[sI −A]
(6.92)
where Adj[ • ] is the adjoint and Det [ • ] is the determinant of the argument matrix.
Although we would rarely attempt carry out the indicated operations in
Eq. (6.92) to derive a transfer function by hand, this formula shows that the
Det[sI −A] is the denominator of all input/output transfer functions for a given
dynamic system and this denominator is the characteristic polynomial that was
used to determine the eigenvalues in Eq. (6.70).
For a given dynamic system characterized by the linear Eqs. (6.83), the numer-
ator of any input/output transfer function is different for each input and each
output. For low-order systems, Cramer’s rule can be used to determine the trans-
fer function between ith-state variable Xi and the jth input Uj. It functionally
appears as shown in Eq. (6.93):
Xi(s)
Uj(s) =

Determinant of [sI −A]
having ﬁrst substituted the

bj

vector
for the ith column

|sI −A|
.
(6.93)
Then the transfer function for any desired output can be constructed as a com-
bination of the state variable transfer functions according to the output equation.
This has been a brief introduction to the topic of transfer functions. We will
be using transfer functions extensively when the topic of automatic control is
discussed.

244
ANALYSIS AND CONTROL OF LINEAR SYSTEMS
It is important to know that there are many linear analysis computer programs,
such as Matlab [5], that can determine transfer functions even for very large
systems. As an example, in Matlab, after creating a system model and deriving a
linear set of governing equations in the matrix form of Eq. (6.83) we would ﬁrst
create a system using the Matlab state-space function with a command such as
‘‘System=ss(A,b,c_t,0)’’. The focus on a single input and output deﬁnes the b
and c vectors as in Eqs. (6.85) and (6.87). This is followed by the command that
turns the system into a transfer function ‘‘TF_system=tf(System)’’. The result,
‘‘TF_system’’, can be viewed symbolically as a ratio of polynomials in the s-
domain as well as being used for other analysis applications. With programs that
can handle linear systems, the translation of state equations and output equations
to transfer functions is routine.
6.5
FREQUENCY RESPONSE
We now turn to the problem of ﬁnding solutions to Eqs. (6.1a) or (6.1b) that are
compatible with given time functions for u1(t), u2(t), . . . , ur(t). Again, the prin-
ciple of superposition will prove useful for the linear system, since it will allow
us to ﬁnd solutions for each input separately and then permit the simple addition
of the solutions to ﬁnd a solution for all the inputs acting simultaneously.
In principle, any time function may be studied as an input, but in practice,
sinusoidal forcing is of overwhelming importance. This is partly because periodic
forcing can be decomposed into sinusoidal components using the Fourier series
with the effects of the component forcing functions superposed using the principle
of superposition, and partly because the testing of real devices is conveniently
accomplished in many cases by using sinusoidal inputs at frequencies varied over
a range of interest.
Most industries that do any kind of vibration testing will have shaker facilities
that can generate sinusoidal inputs and monitor the response of system compo-
nents. Automotive companies also have shaker facilities for testing suspensions,
and even entire vehicles can be shaken in larger facilities. Computer and elec-
tronic components are tested using shaker tables that can sweep through many
frequencies and determine if components break, and their electrical input–output
properties are similarly tested using sinusoidal voltage inputs.
Frequency response is the response of various system outputs to ﬁxed ampli-
tude, ﬁxed frequency inputs. One might guess that if the input to a system is a
ﬁxed-frequency sinusoid, then the outputs from that system will also be ﬁxed-
amplitude sinusoids at the same frequency as the input. It turns out that this is true
for linear systems but not necessarily for nonlinear systems. For more realistic
nonlinear systems the response to a ﬁxed-frequency input can be a much distorted
looking periodic wave and can even have a different fundamental frequency than
the input. Nevertheless, the ﬁxed-frequency sinusoidal input is used pervasively
in engineering applications and yields useful approximate results even for most
nonlinear systems.

FREQUENCY RESPONSE
245
0
0.5
1
1.5
2
2.5
3
3.5
4
−1
−0.8
−0.6
−0.4
−0.2
0
0.2
0.4
0.6
0.8
1
Time, s
Input, F
FIGURE 6.11. Fixed-frequency input force of 1 N amplitude at a frequency of 1 Hz.
One way to present a frequency response is to show the time histories of
the input and response. For the second-order example system that generated
Eq. (6.16) some parameters were chosen and the response was generated for
a sinusoidal input at a frequency of 1 Hz. The ﬁxed-amplitude input and the
corresponding displacement response are shown in Figures 6.11 and 6.12. Notice
that after a brief transient the output becomes a ﬁxed-amplitude sinusoid. The
term frequency response refers to the steady-state response of the system after
transients have died away. (You can see why frequency-response analysis doesn’t
work for unstable systems.) Note that the response is not synchronized in time
with the input. We will describe this time shift as the response having a phase
relationship to the input. We could change the frequency and run the simulation
again and the response would have a different amplitude and phase relationship.
We could do this procedure for many frequencies and generate many plots of the
time history of the response.
What is of more interest is the response amplitude and phase as they depend
on the forcing frequency. For the second-order example system from Figure 6.3
the state equations were derived as Eqs. (6.16). This state representation is the
preferred starting point for most analysis and simulation. However, for demon-
stration purposes, Figure 6.13 shows a simpliﬁed version of the second-order
example of Figure 6.3. In terms of the displacement of the mass y due to the

246
ANALYSIS AND CONTROL OF LINEAR SYSTEMS
0
0.5
1
1.5
2
2.5
3
3.5
4
−8
−6
−4
−2
0
2
4
6
8 × 10−3
Time, s
Response, X
FIGURE 6.12. Response to a ﬁxed-frequency force input.
m
k
b
. ..
y, y, y
F(t)
FIGURE 6.13. Simpliﬁed version of the system from Figure 6.3.
force input F(t), the single equation of motion can be written as
¨y + (b/m) ˙y + (k/m)y = (1/m)F(t).
(6.94)
(Note that we now deﬁne the mass position to be the negative of the spring
deﬂection as shown in the original bond graph, y = −x. Thus, the transfer func-
tion Y(s)/F(s) from Eq. (6.94) is the same as X(s)/F(s) in Eq. (6.81) except
for the missing minus sign.)
If the input is
F(t) = F0 cos(ωt),
(6.95)

FREQUENCY RESPONSE
247
then the steady-state response of mass displacement will be
y(t) = Y0 cos(ωt + φ).
(6.96)
We are not so much interested in plotting the time histories. We really would
like to determine how Y0 and φ depend on the forcing frequency ω. When the
response amplitude divided by the input amplitude is plotted versus the forcing
frequency, and the response phase angle is plotted versus the forcing frequency,
the results are called the frequency-response plots of the system. Such a presen-
tation is called a Bode plot when the amplitude vs. frequency plot is shown on
log–log scales and the phase angle vs. frequency plot is shown on a linear-log
scale. The goal of frequency-response analysis is to determine the amplitude and
phase dependence on forcing frequency.
One way to determine a frequency response for the single second-order
Eq. (6.94) is to use Eq. (6.95) for the input and Eq. (6.96) for the response and
substitute into the governing equation. This will generate a lot of algebra to
solve for Y0 and φ as functions of ω. Another approach is to use the real part
of operator introduced in Section 6.3.3,
F(t) = F0 cos(ωt) = Re(F0ejωt)
(6.97)
and
y(t) = Y0 cos(ωt + φ) = Re(Y0ej(ωt+φ)) = Re(Y0ejφejωt) = Re(Hyejωt),
(6.98)
where Hy is a complex number that can be expressed as
Hy = Y0ejφ.
(6.99)
The magnitude of this complex number is the response amplitude we desire
and the angle of this complex number is the phase angle we desire. Thus,
Hy
 = Y0
and
∠Hy = φ.
(6.100)
In other words, if we can obtain the complex number Hy, then we can recover
the response amplitude by taking the magnitude of Hy and the response phase
angle by determining the angle of the complex number Hy. The complex number
Hy is called the complex frequency response function. (Often instead of Hy, we
will consider the ratio Hy/F0, since for linear systems the response is always
proportional to the input amplitude.)
It turns out that it is simple to compute the complex frequency-response func-
tion using the real operator and far more difﬁcult to perform the algebra if one
starts with the real-time functions from (6.95) and (6.96).
To obtain the complex frequency response function Hy = Y0ejφ for the
example system in Figure 6.13 we would assume that the input F(t) is
F(t) = Re(F0ejωt)
(6.101)

248
ANALYSIS AND CONTROL OF LINEAR SYSTEMS
and the response is
y(t) = Re(Hyejωt),
(6.102)
then substitute these into the governing differential equation Eq. (6.94) and carry
out the indicated operations to obtain Hy. It turns out that the real part of operator
Re( • ) can be understood but suppressed during the operations necessary to ﬁnd
the frequency response. Thus, the input and output can be expressed simply as
F(t) = F0ejωt,
y(t) = Hyejωt.
(6.103)
Comparing Eqs. (6.103) with the input/output assumption for transfer functions
from Eqs. (6.78), we notice that these forms are identical if s = jω.
We now state without proof that the complex frequency response function
is obtained by simply substituting s = jω in the transfer function between any
output and any input. For the example system from Figure 6.13 and governed by
the equation of motion (6.94), to derive the transfer function between the output
Y(s) and input F(s), let
F(t) = F(s)est,
y(t) = Y(s)est,
(6.104)
with the result
Y
F (s) =
1
ms2 + bs + k .
(6.105)
If the input is a ﬁxed-frequency cosine wave,
F = F0 cos ωt,
(6.106)
then we expect the steady-state response to be
y(t) = Y cos(ωt + φ).
(6.107)
The complex frequency response would be
Y(jω)
F(jω) =
1
m(jω)2 + bjω + k =
1
k −mω2 + jbω.
(6.108)
The response amplitude divided by the input amplitude comes from the ﬁrst
of (6.100) as

Y
F
 =
1

(k −mω2)2 + (bω)21/2 ,
(6.109)
where the reader should recall that the magnitude of a complex number comes
from the square root of the sum of the squares of the real and imaginary parts.
The response phase angle comes from the second of (6.100) as
∠Y
F = 0 −tan−1
bω
k −mω2 ,
(6.110)

FREQUENCY RESPONSE
249
where we have made use of the fact that the associated angle of the ratio of
complex numbers is the angle of the numerator complex number minus the angle
of the denominator complex number. We have also used the fact that the angle
of a complex number is the arctangent of the imaginary part divided by the real
part. For this example the numerator has no imaginary part and the arctangent of
zero is zero. We could now plot or sketch the magnitude and phase relationships
versus the forcing frequency.
For low-order linear systems with only a few governing equations, carrying
out the analytical steps shown here is a reasonable exercise. For larger systems
we would resort to a computational solution. For example, the commercial pro-
gram Matlab [5] can produce the frequency response directly from the matrix
formulation for linear systems in the form of Eqs. (6.83). The Matlab program
was used to produce the displacement frequency response shown in Figure 6.14.
6.5.1
Example Transfer Functions and Frequency Responses
In this section the analytical tools developed in the previous sections are demon-
strated for several physical systems.
Simple Vehicle Model. Consider ﬁrst the system shown in Figure 6.15. This
model is often used to represent the vertical dynamics of an automotive sus-
pension in its simplest form. The velocity input vin(t) at the base of the system
represents the roadway unevenness and the control force Fc(t) between the base
and the mass represents an actuator that can be controlled to produce a desired
response of the suspension. Also shown in Figure 6.15 is the bond graph for the
system with state variables identiﬁed.
Using procedures from Chapter 5, the state equations come directly from the
bond graph as
˙pm = kqk + bvin −(b/m)pm + Fc,
˙qk = vin −(1/m)pm,
(6.111)
or, in matrix form,
d
dt

pm
qk

=

−b/m
k
−1/m
0
 
pm
qk

+

b
1

vin +

1
0

Fc.
(6.112)
If we desire eigenvalues, transfer functions, and/or frequency response, then
we start with
pm(t) = Pm(s)est, qk(t) = Qk(s)est, vin(t) = Vin(s)est, Fc(t) = Fc(s)est.
(6.113)
This substitution into (6.112) yields

s + b/m
−k
1/m
s
 
Pm
Qk

=

b
1

Vin +

1
0

Fc.
(6.114)

250
ANALYSIS AND CONTROL OF LINEAR SYSTEMS
0
0.5
1
1.5
2
2.5
3
3.5
4
4.5
5
−180
−160
−140
−120
−100
−80
−60
−40
−20
0
Frequency, Hz
0
0.5
1
1.5
2
2.5
3
3.5
4
4.5
5
Frequency, Hz
Phase (Y/F), degrees
0
1
2
3
4
5
6
7
8 × 10−3
Mag (Y/F), m/N
FIGURE 6.14. The frequency-response plots for the system of Figure 6.13.

FREQUENCY RESPONSE
251
0
1
m : I
R : b
C : k
Se : Fc
Sf
m
k
b
Fc
vm
pm
qk
vin(t)
vin(t)
FIGURE 6.15. Simple vehicle suspension and bond graph.
The reader should recognize Eq. (6.114) as a particular version of the general
form
[sI −A][X] = [bin] Vin + [bF ] Fc.
(6.115)
Let’s look at the transfer functions relating the mass velocity vm to the base
velocity vin and the control force Fc. Since the mass velocity is the momentum
state variable pm divided by the mass parameter m, it is most convenient to
derive the transfer function for Pm in Eq. (6.114) and simply divide the result
by m. Using Cramer’s rule,
Pm
Vin
(s) =

b
−k
1
s

s2 + (b/m)s + k/m, Pm
Fc
(s) =

1
−k
0
s

s2 + (b/m)s + k/m
(6.116)
or
Vm
Vin
(s) =
(b/m)s + k/m
s2 + (b/m)s + k/m, Vm
Fc
(s) =
(1/m)s
s2 + (b/m)s + k/m.
(6.117)
If we want to compute the eigenvalues, the characteristic equation is the
denominator of the transfer functions,
s2 + (b/m)s + k/m = 0.
(6.118)
If the frequency response is desired, then let s = jω in the transfer functions
and generate the complex frequency-response function. For the mass velocity
response to the base velocity input the result using the ﬁrst of Eqs. (6.117) is
Vm
Vin
(jω) =
(b/m)(jω) + k/m
(jω)2 + (b/m)(jω) + k/m =
k/m + j(b/m)ω
k/m −ω2 + j(b/m)ω.
(6.119)
The magnitude of the frequency response is the magnitude of the complex
number from Eq. (6.119),

Vm
Vin
 =

(k/m)2 + ((b/m)ω)21/2

k/m −ω22 + ((b/m)ω)21/2 ,
(6.120)

252
ANALYSIS AND CONTROL OF LINEAR SYSTEMS
and the phase angle between the mass velocity and the base input velocity is the
angle of the complex number from Eq. (6.119),
∠Vm
Vin
(jω) = tan−1 (b/m)ω
k/m
−tan−1 (b/m)ω
k/m −ω2 ,
(6.121)
which is the angle of the numerator complex number minus the angle of the
denominator complex number.
Using the deﬁnitions of natural frequency and damping ratio from Section
6.3.4, the magnitude and phase can also be expressed as

Vm
Vin
 =

1 + (2ς(ω/ωn))21/2

1 −(ω/ωn)22 + (2ς(ω/ωn))21/2
(6.122)
and
∠Vm
Vin
(jω) = tan−1 2ς(ω/ωn) −tan−1
2ς(ω/ωn)
1 −(ω/ωn)2 .
(6.123)
Figure 6.16 shows the magnitude and phase for a few values of the damping
ratio.
Side Branch Accumulator. As another example consider the system shown in
Figure 6.17. It is ﬂuid-ﬁlled tube with a side branch consisting of a length of
tube terminating into a volume that separates liquid from gas using a piston with
a seal around the edge.
There is an oriﬁce downstream of the side branch that is modeled as a linear
resistance Rf. Upstream there is a pump that injects ﬂuid into the tube, and
the unsteady ﬂow induced by the pump is represented as a speciﬁed input ﬂow
Qin(t). The side branch has ﬂuid inertia If and the volume termination has volume
compliance Ca. If the side branch tube has length Lt and cross-sectional area At,
then a good estimate of the ﬂuid inertia parameter is
If = ρ0Lt/At,
where ρ0 is the density of the liquid. This formula was presented in Chapter 4.
Furthermore, if the air volume in the accumulator is V , then a good estimate
of the compliance parameter is
Ca = V/ρac2
where ρa is the density of air and c is the acoustic wave speed in the ﬂuid. This
was also presented in Chapter 4.
The bond graph for this system is also shown in Figure 6.17 and the two state
variables are identiﬁed on the bond graph. Following causality, the equations of

FREQUENCY RESPONSE
253
0
0.2
0.4
0.6
0.8
1
1.2
1.4
1.6
1.8
2
Mag (Vm/Vin)
z = 0.3
z = 0.5
z = 0.7
0
0.5
1
1.5
2
2.5
3
3.5
4
4.5
5
−120
−100
−80
−60
−40
−20
0
w/wn
0
0.5
1
1.5
2
2.5
3
3.5
4
4.5
5
w/wn
Phase (Vm/Vin)
z = 0.3
z = 0.5
z = 0.7
FIGURE 6.16. Frequency response for the system of Figure 6.15.

254
ANALYSIS AND CONTROL OF LINEAR SYSTEMS
Oscillating
piston
gas
liquid
Qin (t)
Qin(t)
Q0
Q0
Ca
0
1
R
C : Ca
I : If
1
Rf
Sf
.
If
qa .pf
FIGURE 6.17. Side branch oscillator and bond graph.
motion come directly from the bond graph as
˙pf = −(1/Ca)qa + RfQin −(Rf/If)pf
˙qf = (1/If)pf
(6.124)
The desired output is the ﬂow through the oriﬁce Q0 and this can be
expressed as
Q0 = Qin −(1/If)pf.
(6.125)
Equations (6.124) can be expressed in the matrix form as
d
dt

pf
qa

=

−Rf/If
−1/Ca
1/If
0
 
pf
qa

+

Rf
0

Qin
(6.126)
For eigenvalues, transfer functions, and frequency response, we always start
with the s-domain; thus, let
Qin(t) = Qin(s)est, pf = Pf(s)est, qa = Qa(s)est,
(6.127)
with the result

s + Rf/If
1/Ca
−1/If
s
 
Pf
Qa

+

Rf
0

Qin.
(6.128)
We desire the transfer function relating Q0(s) to Qin(s). From (6.125) we see
that
Q0
Qin
(s) = 1 −1
If
Pf
Qin
(s).
(6.129)
The simplest way to derive the desired transfer function is to ﬁrst derive the
transfer function between Pf(s) and Qin(s) and then carry out the operations
indicated in Eq. (6.129) to obtain the ﬁnal result. Thus,
Pf
Qin
(s) =

Rf
1/Ca
0
s

s2 + (Rf/Ir)s + /If Ca
=
Rf s
s2 + (Rf/Ir)s + /If Ca
.
(6.130)

FREQUENCY RESPONSE
255
Carrying out the operations from Eq. (6.129) yields the ﬁnal transfer func-
tion as
Q0
Qin
(s) =
s2 + 1/If Ca
s2 + (Rf/If)s + 1/If Ca
.
(6.131)
If we desire the eigenvalues, then we recognize the denominator polynomial
as the characteristic equation,
s2 + (Rf/If)s + 1/If Ca = 0.
(6.132)
For frequency response, the complex frequency-response function is generated
by letting s = jω in the transfer function, with the result
Q0
Qin
(jω) =
−ω2 + 1/If Ca
−ω2 + (Rf/If)jω + 1/If Ca
=
ω2
0 −ω2
ω2
0 −ω2 + j2ς0ω0ω,
(6.133)
where a frequency ω0 has been deﬁned as
ω2
0 = 1/If Ca,
and a damping ratio has been introduced,
2ς0ω0 = Rf/If.
Recognizing that the numerator of (6.133) is a complex number with no imag-
inary part, the magnitude of the frequency response is

Q0
Qin
 =

(ω2
0 −ω2)21/2

(ω2
0 −ω2)2 + (2ς0ω0ω)21/2 .
(6.134)
This is an interesting result. Notice that there is a “special” forcing frequency
where the oscillatory output ﬂow goes to zero, because when ω = ω0, the numer-
ator of the magnitude response is zero. These side branch accumulators are
used frequently in hydraulic systems to attenuate unsteadiness in the ﬂow that is
induced by reciprocating piston pumps. They are “tuned” to the proper frequency
by adjusting the pressure and volume of air in the accumulator. Figure 6.18 shows
this magnitude response for some selected parameter values.
6.5.2
Block Diagrams
Block diagrams were introduced brieﬂy in Section 6.4 as a graphical represen-
tation of a transfer function. Such a representation is used frequently in the
development of control systems. Consider the example system from Figure 6.3

256
ANALYSIS AND CONTROL OF LINEAR SYSTEMS
0
0.2
0.4
0.6
0.8
1
1.2
1.4
1.6
1.8
2
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
w/w0
Mag Q0 / Qi
FIGURE 6.18. Magnitude response for the side branch accumulator.
with the state equations, repeated here from Eqs. (6.16),
˙x = 0x −(1/m)p + 1V + 0F,
˙p = kx −(b/m)p + bV + 1F.
(6.135)
One possible output is the force indicated on the bond graph of Figure 6.3b,
which is the sum of the forces in the spring and damper,
f = kx −(b/m)p + bV + 0F.
(6.136)
It is straightforward to derive the transfer function relating the output f to the
input F as
f
F (s) = Hf/F =
−((b/m)s + k/m)
(s2 + (b/m)s + k/m) =
−(2ςωns + ω2
n)
(s2 + 2ςωns + ω2n).
(6.137)
Block diagrams are commonly used to represent transfer functions, and the
block diagram shown in Figure 6.19a indicates that the output signal f is the
product of the input signal F and the transfer function Hf/F.
For signals with the time dependence est, differentiation is equivalent to mul-
tiplication by s and integration is equivalent to dividing by s. Thus, the trans-
fer function for an integrator is 1/s. Using this notion, the block diagram of
Figure 6.19b represents the state equations and output Eqs. (6.135) and (6.136)
directly and shows that causally F is an input and f is an output.

FREQUENCY RESPONSE
257
FIGURE 6.19. Block diagrams representing transfer functions between F and f : (a)
combined transfer function; (b) direct representation of state and output equations.
The construction of the block diagram in Figure 6.19b is characteristic of the
construction procedure for any set of state equations. One starts with an integrator
and summing junction for each state variable. The derivative of the state variable
is the input to the integrator and the state variable itself is the output from the
integrator. The summing junctions add all the terms on the right sides of the
state equations that are needed to construct the respective state derivatives. One
can imagine ideal measurements of the state variables x and p in this example,
which are indicated by “tapping” into the output of the respective integrators
and “feeding” these measurements back to the summing junctions. For example,
state variable p is measured and fed through the block containing 1/m such that
(1/m)p is fed into the upper summing junction with an appended minus sign.
The output of the summing junction is ˙x = −(1/m)p, which is one of the state
equations from Eq. (6.135).
It is possible to show that Figure 6.19b is equivalent to Figure 6.19a using
essentially graphical means. The major tool is the well-known relation shown
in the general input/output block diagram of Figure 6.20. As indicated in
Figure 6.20a, the output y is related to the input x by
y(s) = H(s)e(s) = H(s)(x(s) −G(s)y(s))
(6.138)
or
y(s) =
H(s)
1 + G(s)H(s)x(s),
(6.139)
as indicated in Figure 6.20b.

258
ANALYSIS AND CONTROL OF LINEAR SYSTEMS
x(s)
x(s)
e(s)
y(s)
y(s)
H(s)
G(s)
(a)
(b)
1 + GH
H
FIGURE 6.20. Block diagram reduction for feedback loops.
Although much of classical control theory and linear system analysis is con-
cerned with block diagram algebra, it should be noted that since bond graphs
generate highly organized state equations, only the simple algebra needed to solve
equations such as (6.135) and (6.136) is required to generate transfer functions
between any input and any output. There are some cases where block dia-
gram reduction techniques provide convenient guides to accomplishing algebraic
manipulation, but for large systems the computer-automated algebraic methods
presented in Reference [2] for example, are far superior to graphical techniques
in avoiding human error.
6.6
INTRODUCTION TO AUTOMATIC CONTROL
The primary emphasis of this book is physical understanding, modeling, and
simulation of multienergy-domain engineering systems. Such understanding is
essential to the design of actual hardware that is intended to accomplish some
speciﬁc goal. We do not want to be confronted with vibration and noise problems,
or thermal problems, or stability problems because of not understanding the
physics of a proposed system. Hopefully, you are starting to appreciate that bond
graphs help enormously in representing the physics of complex systems and in
coming up with state representations of such systems.
Another primary reason for understanding the physics of a proposed system is
so that an automatic controller can be developed that can change the behavior of
the system in some desired fashion. An uncontrolled system (sometimes called
an open-loop system) might not respond fast enough or with acceptable accuracy,
and it may not be possible to correct such deﬁciencies by simply changing or
redesigning the system. (Although having a model of the overall system will
help a lot in assessing whether system changes can help). Automatic control uses

INTRODUCTION TO AUTOMATIC CONTROL
259
sensors, signal processing units, and actuators to change the inherent behavior of a
system into a response that is speciﬁed and desirable. When a system incorporates
automatic control it is often referred to as a closed-loop system.
As mentioned, when automatic control is proposed then sensors, signal pro-
cessing, and actuators are needed. The sensors are used to measure speciﬁc system
outputs, such as positions, velocities, pressures, and temperatures, that are going
to be used as error-generating signals. These measurements are compared to
some desired values of these outputs and the difference between the current value
of an output and its desired value is the error which is sent to a signal processing
unit. The signal processor is typically a computer algorithm that decides what
actuation is needed to reduce the error signals. This unit then commands actuators
that generate control forces, torques, pressures, etc., that move the system in such
a way that error signals are reduced. Actuators require power to generate their
output variables. Thus, power devices are also needed in a control system. All of
the necessary devices for implementing automatic control can lead to substantial
expense. Thus, a control system is rarely implemented without thorough analysis.
It is typical to start the design of an automatic control system using linear
system models in which the controllable actuators can provide their respective
outputs with no magnitude restrictions and without delay. There is initially no
concern with power or speed of response limitations. In other words, we typically
start the controller development as a complete ﬁction. It turns out that it is
beneﬁcial to ﬁrst determine the best performance a controller can deliver before
restricting the design to realistic actuators, realistic response times, and realistic
power requirements. There is a wealth of literature on the topic of linear systems
control and References [6], [7], and [8] are good starting points. In this chapter we
emphasize control applications to physical systems and develop an understanding
of what control can and cannot accomplish.
6.6.1
Basic Control Actions
Figure 6.21 shows a very simple system consisting of a mass acted upon by a
control force. With respect to some inertial reference, the position, velocity, and
acceleration are indicated.
m
Fc
x, x, x
. ..
FIGURE 6.21. System consisting of a mass acted upon by a control force.

260
ANALYSIS AND CONTROL OF LINEAR SYSTEMS
The equation of motion is simply
Fc = m¨x.
(6.140)
For Fc(t) = Fc(s)est, x(t) = X(s)est, the transfer functions between position
and input force, velocity and input force, and acceleration and input force are
X
Fc
(s) =
1
ms2 , Vm
Fc
(s) = s X
Fc
(s) = 1
ms , Am
Fc
(s) = s2 X
Fc
(s) = 1
m.
(6.141)
These transfer functions are shown as block diagrams in Figure 6.22.
Proportional Control. A very basic control action is called proportional con-
trol, where the control variable (Fc in this example) is proportional to the error
between the system output and the desired value of the output. The controller
block diagram is shown in Figure 6.23. Virtually all feedback control systems
have proportional control as part of the control action.
Imagine ﬁrst that we desire to control the acceleration of the mass. From
Figure 6.22c we can derive the “closed loop” transfer function as
Am = (1/m)Fc = (1/m)Kp(Amdes −Am)
(6.142)
or
Am
Amdes
=
Kp/m
Kp/m + 1.
(6.143)
Note that for this control action Kp has the dimensions of mass. As the
proportional gain is increased such that Kp/m ≫1, the response acceleration
approaches the desired acceleration. Keep in mind that as Kp is increased, the
control force is also increased and there are practical limitations that are not being
considered at this juncture. For now, we simply note that proportional control
works well for controlling acceleration of the idealized system.
1
ms2
X
1
ms
1
m
Fc
Am
Fc
Vm
Fc
FIGURE 6.22. Block diagram representation of the transfer functions from Eqs. (6.141).

INTRODUCTION TO AUTOMATIC CONTROL
261
1
ms2
X
1
ms
1
m
Xdes
Vmdes
Amdes
Ex
Ev
Ea
Fc
Am
Fc
Vm
Fc
Kp
Kp
Kp
+
−
+
−
+
−
(a)
(b)
(c)
FIGURE 6.23. Controller block diagrams for proportional control of the transfer func-
tions from Eqs. (6.141).
Next consider velocity control of the same single-mass system. For this con-
troller, shown in Figure 6.23b, it proposed that the system velocity is measured
and compared to some desired velocity to generate an error. A proportional con-
troller is proposed such that the control force Fc is proportional to the velocity
error. The closed-loop transfer function becomes
Vm
Vmdes
=
Kp/m
s + Kp/m.
(6.144)
For this idealized system the proportional gain Kp has the dimensions of
a mechanical damping constant. The denominator of the closed-loop transfer
function is the characteristic polynomial from which the closed-loop eigenvalue
can be calculated; thus,
s + Kp/m = 0
(6.145)
or
s = −Kp/m.
(6.146)
The eigenvalue is negative real for positive values of the controller gain. It is
common to show closed-loop eigenvalues on a root locus plot, such as shown in
Figure 6.24. This shows the path of the closed-loop eigenvalue as Kp is varied
from zero to a large value. Obviously the closed-loop eigenvalue is equal to the
open-loop eigenvalue when Kp = 0 and there is no control action. As the gain

262
ANALYSIS AND CONTROL OF LINEAR SYSTEMS
X
jw
a
s-plane
Kp increasing
Kp = 0
Closed-loop eigenvalue for
some value of controller gain
FIGURE 6.24. Root locus for the velocity controller of Eq. (6.144).
is increased the eigenvalue moves to the left and indicates a faster and faster
system response.
Another way to view the effect of control is to rewrite Eq. (6.144) as
Vm
Vmdes
=
1
τs + 1,
(6.147)
where the time constant is τ = m/Kp. This transfer function is sometimes
referred to as a ﬁrst-order lag or a low-pass ﬁlter. Its frequency response comes
from letting s = jω, generating the magnitude response

Vm
Vmdes
 =
1

1 + (τω)21/2 .
(6.148)
This response is shown in Figure 6.25 for a few values of the time constant τ.
The term low-pass ﬁlter comes from the fact that if Vmdes is a low-frequency
signal,
Vm/Vmdes
 ≃1 and the magnitude of Vm is almost equal to the magnitude
of Vmdes, but as frequency is increased the response becomes attenuated relative
to the input magnitude
Vm/Vmdes
 ≪1. For long time constants (control gain Kp
low) the attenuation begins at fairly low frequencies, while as the time constant
is shortened (Kp increased) the attenuation begins at higher frequencies.
Figure 6.26 shows the step response of the closed-loop transfer function for
several values of the time constant.
For short time constants (Kp high) the response rises to its ﬁnal value quickly
and rises less quickly as the time constant is increased (Kp low). For velocity
control this proportional controller does an excellent job of tracking the desired
velocity. Figures 6.25 and 6.26 were generated computationally using Matlab [5].
With a little experience one could have sketched these responses by hand for this
low-order system.
Returning to the example system of Figure 6.21, it is now proposed to try
proportional control for the position of the mass. It is assumed that mass position

INTRODUCTION TO AUTOMATIC CONTROL
263
0
2
4
6
8
10
12
14
16
18
20
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
Frequency, Hz
Magnitude
tau = 0.03
tau = 0.02
tau = 0.01
FIGURE 6.25. Magnitude response of the ﬁrst-order lag transfer function.
0
0.02
0.04
0.06
0.08
0.1
0.12
0.14
0.16
0.18
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
Time, s
step response
tau = 0.03
tau = 0.02
tau = 0.01
FIGURE 6.26. Step response of the ﬁrst-order lag transfer function.

264
ANALYSIS AND CONTROL OF LINEAR SYSTEMS
is measured and compared to some desired position and then the control force
is set by multiplying the position error by a gain Kp. This control is shown
in Figure 6.23a. The block diagram reduction yields the closed-loop transfer
function as
X
Xdes
=
Kp/m
s2 + Kp/m.
(6.149)
This time the controller gain Kp has the dimensions of a spring stiffness, and
the closed-loop eigenvalues come from setting the denominator polynomial to
zero, with the result
s1,2 = ±jωn,
(6.150)
where ωn = 	Kp/m. We know this indicates a continuously oscillatory response
at the undamped natural frequency. We can affect the frequency by adjusting the
controller gain, but we cannot make the response damp out. The root locus is
shown in Figure 6.27.
As a ﬁnal step in this ﬁrst example of a control system let’s recognize that the
position is not actually measured and controlled but instead is the output from
a transducer that measures a position signal and exhibits some time lag in this
measurement. If the position measurement device had a characteristic such as
Xmeas
X
(s) =
1
τs + 1,
(6.151)
then the measured position would respond to the actual position identically to
the step response of Figure 6.26. The control system would appear as shown in
Figure 6.28.
Block diagram reduction yields the closed-loop transfer function as
Xmeas
Xdes
=
Kp/m
τs3 + s2 + Kp/m
(6.152)
X
jw
a
s-plane
Kp increasing
Kp = 0
Closed-loop eigenvalue
for some value of
controller gain
X
FIGURE 6.27. Root locus for the position controller of Eq. (6.149).

INTRODUCTION TO AUTOMATIC CONTROL
265
1
ms2
Fc
Kp
Xdes
ex
+
−
1
ts + 1
Xmeas
X
FIGURE 6.28. Position control with some measurement lag.
Notice that if τ = 0 such that there is no delay in position measurement, then
(6.152) reduces to (6.149). The characteristic equation again is the denominator
of the transfer function set equal to zero. It can be shown that since the s-term is
missing, this closed loop, controlled system is unstable using proportional control.
See Routh stability criterion in Reference [1]. This instability is demonstrated in
the root locus of Figure 6.29. Notice that a complex conjugate pair of closed-loop
eigenvalues immediately move into the right half of the s-plane as the controller
gain is increased from zero.
While proportional control is part of virtually all control systems, it is clearly
not all that is needed as systems become more dynamically complex.
Proportional plus Derivative Control. A second control action that is often part of
a control system is called derivative control. This action sets the control variable
(force, torque, voltage, current, etc.) proportional to the derivative of the error,
−70
−60
−50
−40
−30
−20
−10
0
10
20
30
−60
−40
−20
0
20
40
60
Root Locus
Real Axis
Imaginary Axis
Kp increasing
FIGURE 6.29. Root locus of the position control system with measurement lag.

266
ANALYSIS AND CONTROL OF LINEAR SYSTEMS
such that the control force for the example system of Figure 6.21 would be
Fc = Kd
d
dte
(6.153)
or in the s-domain,
Fc(s) = KdsE(s).
(6.154)
Derivative control is somewhat anticipatory in that the control variable reacts
to the rate of change of the error rather than the error itself. If at some time,
the error is passing through zero with a positive slope there will be no control
action from a proportional controller but there will be some control action from
the derivative control. The controller anticipates that the error is about to become
larger and some control action is taken to slow the growth of the error.
If position control is the main function of the controller, then derivative action
is identical to proportional control of velocity since velocity is the time derivative
of the position. In a mechanical system a force component that opposes the
velocity is a damping-like force, so it is often said that derivative control adds
damping to a system.
Derivative control action is often combined with proportional control, resulting
in the PD controller (proportional plus derivative control),
Fc(s) = (Kp + Kds)E(s).
(6.155)
For the position controller from Figure 6.23a, this control action is shown as
a block diagram in Figure 6.30.
Using block diagram reduction the closed-loop transfer function becomes
X
Xdes
=
Kp/m + (Kd/m)s
s2 + (Kd/m)s + Kp/m.
(6.156)
The closed-loop eigenvalues come from setting the denominator polynomial
to zero, with the result
s1,2 = −ςωn ± jωd,
(6.157)
where ωn = 	Kp/m, ς = Kd/2mωn, and ωd = ωn
	
1 −ς2. The proportional
control gain allows adjustment of the system frequency, and the derivative gain
allows adjustment of the system damping. For this second-order, open-loop
system, PD control allows arbitrary placement of the closed-loop eigenvalues
1
ms2
X
Fc
ex
Xdes +
−
Kp + Kds
FIGURE 6.30. Controller block diagram for proportional plus derivative control of posi-
tion modiﬁed from Figure 6.23a.

INTRODUCTION TO AUTOMATIC CONTROL
267
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0
0.5
1
1.5
Time, s
X/Xdes step response
z = .3
z = .5
z = .7
FIGURE 6.31. Step response of position controller with PD control.
anywhere in the s-plane. The derivative control term does appear in the numer-
ator of the closed loop system and certainly does affect the dynamic response.
But total adjustability of the closed-loop eigenvalues assures system stability.
Figure 6.31 shows the step response of the closed-loop system for several val-
ues of the damping ratio ς and a natural frequency fn = 5 Hz. Notice that for
increased damping, i.e., higher values of the derivative gain Kd, there is dimin-
ished overshoot and faster settling to the ﬁnal response value.
An alternative way to represent PD control from Eq. (6.155) is
Fc(s) = (Kp + Kds)E(s) = Kd(s + Kp/Kd)E(s) = K(s + z)E(s),
(6.158)
where an overall system gain K is introduced along with a parameter z. Instead
of specifying the proportional and derivative gains Kp and Kd, we specify the
parameter z and the overall system gain K. The control system from Figure 6.30
is shown with this alternative controller in Figure 6.32.
1
ms2
X
Xdes
ex
Fc
K(s + z)
+
−
FIGURE 6.32. Controller block diagram for alternative representation of proportional
plus derivative control of position modiﬁed from Figure 6.30.

268
ANALYSIS AND CONTROL OF LINEAR SYSTEMS
Block diagram reduction yields the closed-loop transfer function as
X
Xdes
=
(K/m)(s + z)
s2 + (K/m)s + (K/m)z
(6.159)
Speciﬁcation of the system gain and the parameter z allows arbitrary placement
of the closed-loop eigenvalues in much the same way as independent speciﬁcation
of Kp and Kd. There is really no difference in the two representations of PD
control, but the appearance of the numerator polynomial in Eq. (6.159) allows
introduction of the concept of zeros and poles.
Transfer functions are always ratios of polynomials, with the general form
Y
U (s) = K(sm + b1sm−1 + · · · + bm−1s + bm)
sn + a1sn−1 + · · · + an−1s + an
.
(6.160)
The solutions to the denominator polynomial set to zero are the eigenvalues
or poles of the system. For the uncontrolled system there are open-loop poles
and for the controlled system there are closed-loop poles. The solutions for the
numerator polynomial set to zero are the system zeros, and there can be open-
and closed-loop zeros for a system.
Much like the poles or eigenvalues, the zeros can be real or they can appear
as complex conjugate pairs. It is typical to show the open-loop poles and zeros
on the complex s-plane, as is done in Figure 6.33 for the example system.
When the control system is represented as shown in Figure 6.32 it is typical
to generate the root locus as the overall system gain is varied. For this example
we ﬁx the location of the zero and then vary the overall gain to determine the
path of the closed-loop poles. This root locus is shown in Figure 6.34.
jω
a
s-plane
X
X
0
Open loop poles. Note
that these poles are
actually at the origin
Open loop zero
FIGURE 6.33. Open-loop poles and zeros for the control system of Figure 6.32.

INTRODUCTION TO AUTOMATIC CONTROL
269
−90
−80
−70
−60
−50
−40
−30
−20
−10
0
10
−25
−20
−15
−10
−5
0
5
10
15
20
25
Root Locus
Real Axis
Imaginary Axis
Double
pole at
s = 0
K = 0 at
this point
Path of the closed
loop poles as K
Is increased
K→ ∞
FIGURE 6.34. Root locus for PD position control of the system from Figure 6.32.
The closed-loop poles start at the open-loop poles for K = 0 and then become
complex conjugate poles as the gain is increased. Ultimately, the root locus rejoins
the real axis and we get repeated poles followed by one pole moving toward the
open-loop zero and the other pole moving toward inﬁnity as the gain is increased.
It is useful to be able to sketch a root locus by hand to determine the possibility
of attaining desirable closed-loop behavior. The rules for doing this are discussed
in the next section.
Looking again at the step response for the closed-loop system, Figure 6.31, we
see that the ﬁnal value of the response is equal to the magnitude of the step input.
For the demonstration system the step input magnitude is unity. The value of the
response as time goes toward inﬁnity is called the ﬁnal value. This value can be
determined by simply letting s = 0 in the closed-loop transfer function from Eq.
(6.156) or Eq. (6.159). Evaluating the ﬁnal value of a response formally comes
from the ﬁnal value theorem and the interested reader can see the derivation
of this theorem in Reference [8]. For the example used here to develop the
concepts of feedback control, the response had the desirable attribute of having
its ﬁnal value equal to the desired step input. This is common but not always
the case.
Proportional plus Derivative plus Integral Control. Consider the example system
shown in Figure 6.35. It consists of a mass-spring-damper with a control force Fc.

270
ANALYSIS AND CONTROL OF LINEAR SYSTEMS
1
I : m
R : b
C : 1/k
Fc
Fc : Se
m
k
b
x, x.
.p
.q
FIGURE 6.35. Example system and bond graph.
It is desired to design a position controller for the mass. The bond graph for
the system is shown in the ﬁgure and the state equations come from the bond
graph:
˙p = Fc −kq −(b/m)p,
˙q = (1/m)p.
(6.161)
In the s-domain these become

s + b/m
k
−1/m
s
 
P(s)
Q(s)

=

1
0

Fc(s).
(6.162)
Recognizing that the mass displacement x is the state variable q we derive
the transfer function relating Fc to q using Cramer’s rule, with the result
X
Fc
(s) =
1/m
s2 + (b/m)s + k/m.
(6.163)
Equation (6.163) is the open-loop transfer function, shown with PD control in
Figure 6.36.
Block diagram reduction yields the closed-loop transfer function between
desired and actual response as
X
Xdes
(s) =
(Kd/m)s + Kp/m
s2 + (b/m + Kd/m)s + k/m + Kp/m
(6.164)
From the denominator we see that the closed-loop eigenvalues can be placed
arbitrarily in the s-plane, which suggests good adjustment of the system response,
X
Xdes
Ex
Fc
Kp + Kds
+
−
1
m
k
m
b s
s2
m +
+
FIGURE 6.36. Controller block diagram for proportional plus derivative control of posi-
tion for the system from Figure 6.35.

INTRODUCTION TO AUTOMATIC CONTROL
271
but letting s →0 in the transfer function shows that the ﬁnal value of the response
to a step change in desired position is not unity:
X
Xdes
|s→0 =
Kp/m
k/m + Kp/m.
(6.165)
From the block diagram of Figure 6.36 we can also derive the error between
Xdes and X, with the result
Ex
Xdes
(s) =
s2 + (b/m)s + k/m
s2 + (b/m + Kd/m)s + k/m + Kp/m.
(6.166)
Letting s →0 yields the ﬁnal value of the error and we note that its ﬁnal
value is nonzero:
Ex
Xdes
|s→0 =
k/m
k/m + Kp/m.
(6.167)
As the gain Kp is made larger and larger, the ﬁnal value of the response
approaches the desired response and the error is driven toward zero.
The issue with this physical system is that when the mass motion comes to
rest, the control force must oppose the spring force. Using PD control, the only
component of the control force that is nonzero when the system is at rest is the
part due to proportional control, and proportional control can generate a force
only when an error is present. Thus, there is ﬁnite error when the mass is at its
ﬁnal position.
To alleviate this problem we introduce the concept of integral control. Integral
control generates a control force proportional to the integral of the error such that
Fc = KI

edt
(6.168)
or, in the s-domain,
Fc(s) = (KI/s)E(s).
(6.169)
If a component of the control force is related to the integral of the error then
that component will continue to get larger as long as an error is present and, with
proper usage, will drive the error toward zero.
When integral control is added to the proportional plus derivative control we
obtain proportional plus integral plus derivative control or PID control. It is
represented as
Fc(t) = Kpe + Kd ˙e + KI

e dt,
(6.170)
in the time domain or in the s-domain as
Fc(s) = [Kp + Kds + (KI/s)]E(s)
(6.171)
For the example system of Figure 6.35, the controller block diagram using a
PID controller is shown in Figure 6.37.

272
ANALYSIS AND CONTROL OF LINEAR SYSTEMS
X
Xdes
ex
Fc
+
−
1
m
k
m
b s
s2
m +
Kp + Kds
KI
s
+
+
FIGURE 6.37. Controller block diagram for proportional plus derivative plus integral
control of position for the system from Figure 6.35.
It is straightforward to derive the closed-loop transfer function, with the result
X
Xdes
(s) =
(Kd/m)s2 + (Kp/m)s + KI/m
s3 + (b/m + Kd/m)s2 + (k/m + Kp/m)s + KI/m.
(6.172)
To test for the ﬁnal value of a step response, let s = 0 in this transfer function,
with the result
X
Xdes
|s→0 = KI/m
KI/m = 1
(6.173)
Thus, the integral control component of the control force moved the mass
position to the desired ﬁnal position while driving the position error to zero.
However, another result of the integral control component was to increase the
order of the system from 2 to 3. Notice that the denominator of the closed-
loop system from Eq. (6.172) is now third order, thus there are three closed-loop
eigenvalues where the open-loop system has only two. It turns out that the higher-
order systems are more easily made unstable due to the action of control systems,
thus integral control should be introduced with careful consideration.
The s-domain representation of PID control can be put into the form
Fc(s) = (Kp + Kds + KI/s)E(s) = [(Kds2 + Kps + KI)/s]E(s),
(6.174)
and this can be further reduced to
Fc(s) = [K(s2 + 2ς0ω0s + ω2
0)/s]E(s),
(6.175)
where
K = Kd, 2ς0ω0 = Kp
Kd
, ω2
0 = KI
Kd
.
(6.176)
Rather than independent speciﬁcation of the three controller gains KP , Kd, KI,
we can think of PID control as allowing placement of two arbitrary zeros any-
where in the s-plane plus an overall system gain K. There is a pole at the origin
that always accompanies PID control. If we choose to have a complex zero,
then we ﬁnd that the complex conjugate will also be a zero. The path of the
closed-loop poles as the system gain is varied over a broad range is shown in
Figure 6.38 for the case where the physical system is lightly damped and oscil-
latory at 5 Hz and the zeros of the PID controller are placed as shown. Notice
that there is a range of overall system gain K where the closed-loop system is

INTRODUCTION TO AUTOMATIC CONTROL
273
−120
−100
−80
−60
−40
−20
0
20
−100
−80
−60
−40
−20
0
20
40
60
80
100
Root Locus
Real Axis
Imaginary Axis
Pole of the PID
controller
Arbitrary zeros of
the PID controller
Path of closed loop
poles as gain is
increased
Open loop
poles of the
physical system
FIGURE 6.38. Root locus for PID control of position for the system from Figure 6.35.
unstable, i.e., closed-loop eigenvalues are in the right half of the s-plane. It is also
true that PID control can produce desirable closed-loop poles and the integral
control component assures zero steady-state error.
6.6.2
Root Locus Concept
In the example systems used to demonstrate the concepts of automatic control
the concept of a root locus was introduced. The root locus shows the path of the
closed-loop eigenvalues in the complex s-plane as some system gain is varied.
Since we now have a good understanding of the meaning of an eigenvalue with
respect to speed of system response, tendency to oscillate, stability, and so forth,
the root locus is a very useful tool for visualizing the potential response of a
system for a given control action.
In 1950 W. R. Evans developed a formal graphical procedure for creating a
root locus from knowledge of the open-loop poles and zeros of the system and
the poles and zeros of the proposed controller. References [9] and [10] are the
original publications of his method and References [6], [7], and [8] all show
how to apply the rules of construction. Before the availability of modern linear
system analysis computer programs, the root locus method was used to actually
determine the gain values needed to place closed-loop poles in desired locations.
With programs such as Matlab [5] there is no need to use Evan’s formalism and
we can obtain a root locus easily. However, it is still useful to be able to sketch
a root locus and one does not need all the formal development to be able to do
this. The basic rules are presented next. The interested reader should see any of
the above-mentioned references for a more complete development.

274
ANALYSIS AND CONTROL OF LINEAR SYSTEMS
The Starting Point. A bond graph model of a linear physical system allows
derivation of state and output equations useful for control studies in the form
[˙x] = [A][x] + [bd] ud + [bc] uc,
y = [c]t[x],
(6.177)
where [x] is the vector of state variables composed of momentum and displace-
ment variables (p’s and q’s) from I- and C-elements in integral causality, ud
is a single disturbance input (effort or ﬂow), i.e., an input over which we have
no control, and uc is a single control input (effort or ﬂow) over which we do
have control. The single output y is some combination of the states and we want
to control this output to have some desired response. Obviously, in any given
system there can be multiple disturbance inputs and/or multiple controlled inputs.
There can also be multiple outputs we would like to control. For now we propose
a single control variable uc and a single output variable y and develop concepts
for single input–single output (SISO) systems.
In Section 6.4 the concept of an input/output transfer function was introduced.
The transfer function between the output y and control input uc is called the
plant transfer function,
Gp(s) = Y(s)
Uc(s).
(6.178)
This transfer function is typically the ratio of two polynomials, such that
Gp(s) = K(sm + b1sm−1 + · · · + bm−1s + bm)
sn + a1sn−1 + · · · + an−1s + an
.
(6.179)
We know that the denominator polynomial is the plant characteristic equation,
which delivers the plant or open-loop eigenvalues when set to zero and solved.
The eigenvalues are called poles of the transfer function. The numerator, when
set to zero and solved, yields the open-loop zeros. Thus, Eq. (6.179) can be
represented as
Gp(s) = Kp(s + z1)(s + z2) · · · (s + zm)
(s + p1)(s + p2) · · · (s + pn)
= Kp
Np(s)
Dp(s),
(6.180)
where the zeros and poles, zi and/or pi, can be real or complex conjugate pairs.
The controller is also typically represented by a transfer function. (See
Eq. (6.175) for a PID controller for example.) The closed-loop system can
be represented in block diagram form as shown in Figure 6.39 in which the
controller can also be expanded into its poles and zeros:
Gc(s) = Kc(smc + b1csmc−1 + · · · + bmc−1s + bmc)
snc + a1csnc−1 + · · · + anc−1s + anc
= Kc(s + zc1)(s + zc2) · · · (s + zcm)
(s + pc1)(s + pc2) · · · (s + pcn) = Kc
Nc(s)
Dc(s).
(6.181)

INTRODUCTION TO AUTOMATIC CONTROL
275
Gc(s)
Uc(s)
Gp(s)
Y
Ydes +
−
E(s)
FIGURE 6.39. Block diagram of the plant and controller transfer functions.
The fundamental rule for determining a root locus comes from the block
diagram reduction of Figure 6.39,
Y
Ydes
(s) =
KGc(s)Gp(s)
1 + KGc(s)Gp(s),
(6.182)
where K = KcKp is the overall system gain, GcGp is called the open-loop trans-
fer function, and the poles and zeros from Eqs. (6.180) and (6.181) are called the
open-loop poles and open-loop zeros, respectively. The denominator of (6.182)
is the closed-loop characteristic equation, and the closed-loop eigenvalues come
from the solution of
1 + KGc(s)Gp(s) = 0
or
KGc(s)Gp(s) = −1.
(6.183)
Since Gc and Gp can each be written in terms of numerator and denomina-
tor polynomials as shown in Eqs. (6.180) and (6.181), Eq. (6.183) can also be
written as
K Nc
Dc
Np
Dp
+ 1 = K N
D + 1 = 0,
(6.184)
where N = NcNp, D = DcDp. This can be further expanded into
D + KN = 0
(6.185)
Equation (6.185) indicates that if the overall system gain K is zero, then
D = 0 and the closed-loop eigenvalues equal the open-loop eigenvalues, and
the root locus starts at the open-loop eigenvalues. As K →∞, D is no longer
important in (6.185) and the only solution is N = 0, which can be true only if
the closed-loop eigenvalues equal the open-loop zeros. Thus, we say that the root
locus starts at the open-loop poles and ends at the open-loop zeros. We will see
that the root locus may approach inﬁnity in the s-plane as the gain is increased,
so we consider s →∞as a possible open-loop zero location.
Equation (6.183) indicates that if some complex number s = α + jω is a
closed-loop eigenvalue, then
KGc(s)Gp(s)
 = 1
∠KGc(s)Gp(s) = n180◦, n = ±1, ±3, ±5, . . . .
(6.186)

276
ANALYSIS AND CONTROL OF LINEAR SYSTEMS
In words this states that for any complex number s substituted into the open-
loop transfer function KGc(s)Gp(s), that complex number is also a closed-loop
eigenvalue if the magnitude of the open-loop transfer function is unity and the
angle of the open-loop transfer function is 180◦or an appropriate multiple of
180◦. Keep in mind that, from Eqs. (6.180) and (6.181),
KGc(s)Gp(s)
 = K
s + zc1
 s + zc2
 · · · |s + z1| |s + z2|
s + pc1
 s + pc2
 · · · |s + p1| |s + p2|
(6.187)
and
∠KGc(s)Gp(s) = ∠(s + zc1) + ∠(s + zc2) + · · · + ∠(s + z1) + ∠(s + z2) + · · ·
−∠(s + pc1) −∠(s + pc2) −· · · −∠(s + p1)
−∠(s + p2) −· · · .
(6.188)
A graphical interpretation of the magnitude and angle contribution of a pole
or zero is shown in Figure 6.40.
For this example a real pole is used. This real pole is shown at s = −p
in the complex s-plane. Also shown is the complex number (p + j0) and the
“test” point s. Vectors are drawn from the origin to the complex number +p
and from the origin to the test point. A vector sum is taken producing the vector
s + p. The length of this vector is |s + p| and the angle relative to the positive
real axis is ∠(s + p). The magnitude and angle would then be used as their
respective contributions to Eqs. (6.187) and (6.188) to determine if the test point
is a closed-loop eigenvalue and thus on the root locus.
s-plane
jw
x
−p
x
+p
Test point s. Is this
complex number on
the root locus?
s
s + p
∠(s + p)
a
Pole at s = −p
Vector drawn from pole
location to test points
FIGURE 6.40. Graphical interpretation of magnitude and angle of a pole or zero.

INTRODUCTION TO AUTOMATIC CONTROL
277
There is a much simpler way to determine the magnitude and angle contri-
bution of the poles and zeros. Figure 6.40 also shows a vector drawn from the
pole location −p to the test point. This vector is identical to the vector s + p.
Thus, the simplest way to determine the magnitude and angle contribution of
each open-loop pole and zero is to draw a vector from each to a test point. Then
the length of each vector is the respective magnitude contribution and the angle
of each vector is the angle contribution. This is also true for complex poles and
it is left as an exercise for the reader to show this. Figure 6.41 shows a few poles
and zeros and their magnitude and angle contributions for a test point.
A root locus sketch starts by showing the open-loop poles and zeros on the
complex s-plane. As mentioned at the beginning of this section, in the past the
poles and zeros were represented accurately in the s-plane and magnitudes and
angles were calculated or measured so that the root locus could be precisely
drawn. We are now able to obtain a root locus using computational procedures.
But it is still useful to be able to sketch an approximate root locus to determine
the utility of a proposed control action. Here are several rules for sketching a
root locus.
Rule 1. As shown in Figure 6.41 and repeated here, the root locus starts at
the open-loop poles for K = 0 and terminates at the open-loop zeros (including
possibly the zeros at inﬁnity) for K →∞.
Rule 2. The root locus exists on the real axis only to the left of an odd number
of real poles and/or zeros. This requirement comes from the angle condition of
Eq. (6.186). Consider the poles and zeros shown in Figure 6.42.
There is a real pole and real zero and a complex conjugate pair of poles. One
test point is located between the real pole and real zero. The angle contribution
of the real pole to the test point is 180◦and the angle contribution of the zero is
zero degrees. Notice that the complex poles (or complex zeros) always contribute
a total of 360◦to any test point on the real axis and thus need not be considered
s-plane
jw
x
−p3
x
−p2
x
−p1
0
s
−z1
∠p2
a
∠z1
∠p1
∠p3
FIGURE 6.41. Graphical interpretation of magnitude and angle contribution of several
poles and zeros.

278
ANALYSIS AND CONTROL OF LINEAR SYSTEMS
x
x
x
0
FIGURE 6.42. Angle condition for the real axis.
further. If we add the total contribution of the zeros (1 in this case) and subtract
the total contribution of the poles according to Eq. (6.188), we see that the
resulting angle at the ﬁrst test point is −180◦, which shows that this part of the
real axis is on the root locus.
The second test point is to the left of the real zero in Figure 6.42. The angle
contribution of the real pole is 180◦and the angle contribution of the real zero
is 180◦. By adding the angle contributions of the zero and subtracting the angle
contribution of the pole, the resulting total is 0 degrees, which does not meet
the angle requirement for being on the root locus. Thus, to the left of an even
number of poles and/or zeros the root locus does not exist on the real axis.
Rule 3. Complex poles and zeros, i.e., those with imaginary parts, will always
appear in complex conjugate pairs. Thus, the root locus is symmetrical with
respect to the real axis.
Rule 4. Remember that the root locus starts at the open-loop poles and ends
at the open-loop zeros, which might include zeros at inﬁnity. If there are several
more poles than zeros then parts of the root locus must approach inﬁnity. They
do so on asymptotes and it is useful to know how many asymptotes there are,
what angle these asymptotes make with respect to the real axis, and where these
asymptotes intersect the real axis.
In general, the open-loop transfer function has the appearance shown in
Eqs. (6.179) and (6.181), where these two transfer functions are multiplied to
generate the ﬁnal open-loop transfer function. As the test point s →∞, the
open-loop transfer function would approach
KGc(s)Gp(s)|s→∞→
K
s(ntot−mtot) ,
(6.189)
where mtot = mc + m is the total number of ﬁnite zeros, and ntot = nc + n is the
total number of poles.

INTRODUCTION TO AUTOMATIC CONTROL
279
The angle of the open loop transfer function is the angle of the asymptote and
to be on the root locus,
−(ntot −mtot)∠s = ±n180
n = 1, 3, 5, . . . .
(6.190)
Thus, the angles of the asymptotes become
∠s =
±n180◦
(ntot −mtot)
n = 1, 3, 5, . . . .
(6.191)
The quantity ntot −mtot is called the pole/zero excess and the number of
asymptotes is equal to this quantity.
Rule 5. The asymptotes intersect the real axis at the centroid of the pole/zero
conﬁguration. Stated without proof, the centroid is located on the real axis at
σ =

pi −

zj
ntot −mtot
,
(6.192)
where  pi is the sum of all the poles and  zi is the sum of all the zeros. Note
that the imaginary part of any pole or zero does not contribute to this calculation
since the conjugate is also part of the calculation. Also note that real parts of
poles located in the left half plane move the centroid to the left while real parts
of zeros located in the left half plane move the centroid to the right.
Figure 6.43 shows some pole/zero conﬁgurations. In part (a) there are two
poles and no zeros. Thus, the pole/zero excess is 2 and there are two asymptotes.
The angle of the asymptotes from Eq. (6.191) is
∠s = ±180◦
2
= ±90◦
and the centroid from Eq. (6.192) is
σ = −p + (−p)
2
= −p.
This shows that for large values of the system gain the root locus (i.e., the closed
loop poles) will approach inﬁnity on these asymptotes.
Figure 6.43b shows two poles and one zero, thus the pole/zero excess equals 1.
This tells us there is 1 asymptote and the angle of this asymptote is
∠s = ±180◦
1
= 180◦.
The centroid has no signiﬁcance in this case.
Figure 6.43c shows three poles and no zeros, thus the pole/zero excess
equals 3. There are three asymptotes and their angles are
∠s = ±180◦
3
= ±60◦(this accounts for 2 of the 3 asymptotes)

x
x
a
Centroid
Angle of asymptote
x
x
a
a
jw
jw
jw
0
Angle of asymptote
x
x
(c)
(b)
(a)
x
Angle of asymptotes
180°
90°
−90°
60°
−60°
180°
FIGURE 6.43. Some pole/zero conﬁgurations and associated asymptotes.
280

INTRODUCTION TO AUTOMATIC CONTROL
281
and
∠s = ±3(180◦)
3
= 180◦.
The centroid of the asymptotes comes from (6.192) with the approximate result
as shown.
Rule 6. If the root locus exists between two poles on the real axis then the
root locus, which starts at these poles, must break away from the real axis at
some point between them. If the root locus exists between two zeros on the real
axis then a break-in point must exist. This rule follows from the fact that the
root locus starts (for low gain values) at the open-loop poles and ends (for large
gain values) at the open-loop zeros. If the root locus lies between two poles on
the real axis, then, as the gain is increased, the locus must escape the real axis
to move toward the zeros.
There are formal ways to determine the exact location of breakaway or break-
in points, but for purposes of sketching the root locus we need only realize that
such points exist.
There are more features of root loci that could be developed. For example, the
root locus must depart from complex conjugate poles and must arrive at complex
conjugate zeros. It is possible to determine the angle of departure from the poles
and angle of arrival at zeros. The interested reader should consult the references
at the end of this chapter for details. For sketching purposes we need only realize
that such departures and arrivals exist.
Let’s revisit the physical system consisting of the position control of a single
mass where we postulate the use of PID control. The physical system and block
diagram are shown in Figure 6.44. The PID controller is shown in the form
presented earlier in Eq. (6.175). We would ﬁrst choose the damping and frequency
ς0, ω0 and then vary the gain K to sketch the root locus.
Figure 6.45 sketches the root locus using the rules just presented.
First note that the system contributes a double pole at zero and the controller
contributes an additional pole at zero. These poles are all together at zero, but it is
Fc
Fc
m
y
1
ms2
Y
K(s2 + 2ς0w0s + w0)
2
s
Yref
E
+
−
FIGURE 6.44. Physical system and block diagram for PID control of mass position.

282
ANALYSIS AND CONTROL OF LINEAR SYSTEMS
jw
a
x
x
x
0
0
Closed loop poles or
eigenvalues
FIGURE 6.45. Sketch of root locus for the system of Figure 6.44.
easier to sketch the root locus if we “think” of them as being very close together
at zero. The two zeros of the PID controller are shown in arbitrary positions
and could be moved to other locations to see their effect on the location of the
closed-loop eigenvalues.
Application of rule 2 indicates that the root locus exists on the real axis
between the real pole at the origin and the ﬁrst zero, and between the second
zero and the zero at inﬁnity. Since the pole/zero excess equals 1, rule 4 indicates
that there is one asymptote and its angle is 180◦. Finally, from rule 6 there must
be a break in point between the second zero on the real axis and the zero at
inﬁnity. As the system gain is increased the root locus must leave the open-loop
poles and move toward the open loop zeros. The closed loop eigenvalues must
lie on the root locus, and the root locus will appear as sketched in Figure 6.45.
Figure 6.46 shows the sketch of the root locus if the zeros of the PID controller
are chosen as complex conjugate roots.
The root locus exists on the real axis between the pole at the origin and the
zero at inﬁnity. There is still only one asymptote. The root locus must leave the
open-loop poles for small gain values and arrive at the open-loop zeros as the
gain is increased. Thus, the root locus will appear as shown in the sketch and
the closed-loop poles will lie on this root locus.
jw
a
x
x
x
0
0
Closed loop poles or
eigenvalues
FIGURE 6.46. Sketch of root locus from Figure 6.45 with different controller zero loca-
tions.

INTRODUCTION TO AUTOMATIC CONTROL
283
0
1
R
vus
vs
ps.
pus
.
qt.
.
ms
bs
ms
mus
kt
bs
ks
Fc
vin
0
1
I
vin
Sf
C ks
Se Fc
I mus
C kt
qs
FIGURE 6.47. Schematic and bond graph of a quarter-car model with active suspension.
As a ﬁnal example of obtaining a root locus consider the quarter-car model
shown in Figure 6.47. The model consists of sprung and unsprung mass elements
ms, mus, suspension stiffness and damping ks, bs, base disturbance velocity input
vin, and controllable force Fc. Ultimately we need to model a real actuator that
can generate this ﬁctitious force, but for now we simply propose that we can
generate and control a prescribed force.
A bond graph of the model is also included in Figure 6.47, and causality
indicates that there are four state variables, which are labeled on the bond graph.
The equations of motion come directly from the bond graph as
d
dt
⎡
⎢⎢⎣
ps
pus
qs
qt
⎤
⎥⎥⎦=
⎡
⎢⎢⎣
−bs/ms
bs/mus
ks
0
bs/ms
−bs/mus
−ks
kt
−1/ms
1/mus
0
0
0
−1/mus
0
0
⎤
⎥⎥⎦
⎡
⎢⎢⎣
ps
pus
qs
qt
⎤
⎥⎥⎦+
⎡
⎢⎢⎣
1
−1
0
0
⎤
⎥⎥⎦Fc +
⎡
⎢⎢⎣
0
0
0
1
⎤
⎥⎥⎦vin.
(6.193)
If these equations are put into the s-domain, the transfer function between the
sprung mass velocity vs and the control force Fc can be derived as
Vs
Fc
(s) =
(1/ms)s(s2 + kt/mus)
s4 + (bs/ms + bs/mus)s3 + (ks/mus + kt/mus + ks/ms)s2
+ (bskt/msmus)s + kskt/msmus
. (6.194)
If we are interested in the frequency response of the sprung mass velocity
to a harmonic input of the control force, we would let s = jω and follow the
procedure from Section 6.5. Without carrying out all the steps we can observe that
the denominator indicates there are two distinct natural frequencies (if we think
of the damping being temporarily equal to zero). From the numerator dynamics
there is a special frequency where the sprung mass will remain motionless under

284
ANALYSIS AND CONTROL OF LINEAR SYSTEMS
the action of the control force. This frequency is
ω2
0 = kt/mus
and is often referred to as the wheelhop frequency, since it involves the tire
stiffness and the unsprung mass.
For the root locus we observe that the open-loop transfer function has
three zeros and four poles and they are distributed approximately as shown
in Figure 6.48. There is a zero at the origin and complex conjugate zeros on
the imaginary axis. There are two sets of complex conjugate poles, which are
shown in Figure 6.48 as lightly damped.
Since the pole/zero excess is unity, there is only one asymptote along the real
axis. The root locus would look something like that shown in the ﬁgure.
In the area of vibration control we often look at the response of a system to a
disturbance input rather than a desired input. For the quarter-car the disturbance
input is the ground input vin(t). Equations (6.193) yield the open-loop transfer
function between the sprung mass velocity vs and the disturbance velocity:
Vs
Vin
(s) =
(kt/mus)[(bs/ms)s + ks/ms]
s4 + (bs/ms + bs/mus)s3 + (ks/mus + kt/mus + ks/ms)s2
+ (bskt/msmus)s + kskt/msmus
. (6.195)
−10
−5
0
5
−60
−40
−20
0
20
40
60
Root Locus
Real Axis
Imaginary Axis
+
+
+
−
(
)
Vs
Fc
(
)
Vs
Vin
Vdes
Kp
Vin
vs
FIGURE 6.48. Block diagram representation and root locus for the quarter-car model
with proportional control.

INTRODUCTION TO AUTOMATIC CONTROL
285
We can see that the passive damping bs will control the resonant behavior
dictated by the denominator but will also affect the high-frequency behavior
dictated by the numerator. With proportional control the closed-loop transfer
function becomes
Vs
Vin
|CL =

 Vs
Vin

1 + Kp

Vs
Fc

=
(kt/mus)[(bs/ms)s + ks/ms]
s4 + (bs/ms + bs/mus + Kp/ms)s3 + (ks/mus + kt/mus + ks/ms)s2
+ [(bskt + Kpkt)/msmus]s + kskt/msmus
.
(6.196)
We see that the proportional control effects the damping terms of the denomi-
nator and thus this type of control may prove useful for ride control of a vehicle
suspension.
Lead-lag Control. Before leaving this section on root locus it is appropriate to
introduce another control action that can prove useful. It is called lead-lag control
and is represented by the transfer function,
Gc(s) = K(s + z)
(s + p) ,
(6.196a)
where the pole p is located in the complex plane much further to the left than the
zero z. This control action does not effect the pole/zero excess as one pole and
one zero are added to the open-loop transfer function of the system. However,
from Eq. (6.192) we see that the centroid of the asymptotes is moved to the left
by the action of this controller. Thus, this control action tends to extend the range
of system gain K over which the closed-loop system is stable. Consider part (a)
of Figure 6.48A, where there are three open loop poles and no zeros. There are
three asymptotes located at angles 180◦and at ±60◦. The centroid is located as
shown. Proportional control will move the closed-loop poles immediately into
the unstable right half plane.
Now consider the addition of the lead-lag controller with added pole and zero
located as shown in part (b) of Figure 6.48A. We see that the centroid is moved
to the left and there is a range of system gain that yields stable closed loop
behavior.
6.6.3
General Control Considerations
In the previous section the concept of automatic control was introduced using
position control of a single mass acted upon by a controllable force. The concept
of proportional, derivative, and integral control actions was presented. Virtually
all control systems will have these actions as part of the overall control system.

286
ANALYSIS AND CONTROL OF LINEAR SYSTEMS
x
x
x
(a) Proportional control of a 3-pole
open-loop system
jw
jw
a
a
x
x
x
Potential closed loop
poles
Potential closed loop
poles
(b) Proportional control of a 3-pole
open-loop system with added lead-lag control
x
0
FIGURE 6.48A. The effect of lead-lag control on the root locus.
Also introduced by example was the concept of a root locus, where the path of
the closed-loop eigenvalues is shown in the complex s-plane as some controller
gain is varied. It is useful to be able to sketch a root locus to determine if a
proposed controller has the potential to deliver a desired closed-loop response.
In this section the concept of automatic control is developed more generally
and more formally. This development is followed by some realistic physical
examples.
Setting Up the Problem. As presented previously, it is proposed that some physi-
cal system can be justiﬁably modeled as a linear system, and a bond graph model
of this system yields the state equations in the form
[˙x] = [A][x] + [bd] ud + [bc] uc,
y = [c]t[x],
(6.197)

INTRODUCTION TO AUTOMATIC CONTROL
287
where [x] is the vector of state variables composed of momentum and displace-
ment variables (ps and qs) from I- and C-elements in integral causality, ud is a
single disturbance input (effort or ﬂow), over which we have no control, and uc
is a single control input (effort or ﬂow), over which we have control. The single
output y is some combination of the states and we want to control this output
to have some desired response. When we have one controllable input and one
controlled output the control system is classiﬁed as a SISO (single input–single
output) system.
Next, derive the transfer functions relating the output y to the controllable
input uc and the output to the disturbance input ud; thus derive,
Gp(s) = [c]t Adj[sI −A]
Det[sI −A] [bc] = Y(s)
Uc(s) = Np
D ,
Gd(s) = [c]t Adj[sI −A]
Det[sI −A] [bd] = Y(s)
Ud(s) = Nd
D .
(6.198)
The block diagram representation of the control system is shown in
Figure 6.49.
The controller is represented by the transfer function KGc(s) and could be as
simple as a proportional gain or a PID controller, a complex transfer function,
or even a series of instructions or rules. The basic concept is that when an error
exists between the desired output and the actual output, a control action takes
place that reduces the error and results in a desirable system response.
The plant transfer function is Gp(s) and the open-loop or forward-loop trans-
fer function is KGc(s)Gp(s). The disturbance transfer function is Gd(s). Block
diagram algebra yields the closed-loop transfer function relating Y to Ydes as
Y
Ydes
(s) =
KGcGp
1 + KGcGp
(6.199)
and the closed-loop transfer function relating the output to the disturbance input as
Y
Ud
(s) =
Gd
1 + KGcGp
.
(6.200)
+
+
+
−
KGc(s)
Uc(s)
Gp(s)
Gd(s)
Ud(s)
Y(s)
Ydes(s)
FIGURE 6.49. Starting block diagram for controller development.

288
ANALYSIS AND CONTROL OF LINEAR SYSTEMS
Note that if it were possible to have the overall controller gain K become
arbitrarily large then Y would approach Ydes and the response to the disturbance
would approach zero. In general, the overall system gain is limited by power and
stability considerations.
From Section 6.6.2 dealing with root locus we know that the main effect of
feedback control is to place the closed-loop poles in some desirable locations.
We know that the closed-loop poles equal the open-loop poles when there is
no control and that they approach the open-loop zeros as the system gain is
increased. A goal of the controller design is to have some dominant poles with
desired frequency and damping and to have the remaining poles be signiﬁcantly
faster and well damped (further to the left in the complex plane). Normally,
the fast poles have little signiﬁcant inﬂuence on the closed-loop response. It is
typical to assess the overall system response by considering the time response of
the output to a step change in the desired output and by evaluating the closed-loop
frequency response.
Consider a plant transfer function,
Gp(s) = Y
Uc
=
ω2
p
s2 + 2ζpωps + ω2p
,
(6.201)
with ζp = 0.1 and fp = ωp
2π = 1.0 Hz. Lets propose the use of a PID controller
such that
KGc(s) = K (s2 + 2ζ0ω0s + ω2
0)
s
,
(6.202)
where we specify values for ζ0 and ω0. A sketch of the root locus is shown in
Figure 6.50 and it indicates that we can place the closed-loop poles in desirable
locations with the proposed controller.
Figure 6.51 shows the step response for several values of the system gain K
with ζ0 = 0.7 and f0 = ω0/2π = 2.0 Hz. Notice that we can affect the speed of
jw
a
x
x
0
x
0
Potential closed
loop poles
FIGURE 6.50. Approximate root locus for PID control of a second-order plant.

INTRODUCTION TO AUTOMATIC CONTROL
289
0
0.05
0.1
0.15
0.2
0.25
0.3
0.35
0.4
0.45
0.5
0
0.2
0.4
0.6
0.8
1
1.2
1.4
Time ,s
Step response to a unit step
K = 1
K = 1.5
K = 2.0
K = 2.5
FIGURE 6.51. Step response of the second-order plant with PID control.
response, the overshoot of the ﬁnal value, and the settling time by adjusting the
controller parameters.
Our ﬁrst concern in designing the control action is that the system be stable
over some range of system gain. The next concern is that a desirable closed-
loop response results. Considering that we are designing controllers for physical
systems, we should keep in mind the power required to accomplish the closed-
loop response we specify. Since the system model is a linear representation of
a “real” system we should ultimately test the controller with a more realistic
system model to determine the range over which our controller will be effective.
This test model will often be nonlinear even when we continue to use a linear
controller.
Motion Control. A main use of feedback control is to have the output from a
system follow some desired output. Another use of such a control system is to
keep the system at the desired output when a disturbance acts on the system.
Such control systems are called “regulators” and come under the broad category
of motion control.
Consider the physical system shown in Figure 6.52. It consists of a dc motor
driving a rotary inertia. The dc motor has winding resistance Rw and coupling
constant T . The rotary inertia has moment of inertia J. Also shown in the ﬁgure
is a bond graph of the system with causality and state variable identiﬁed.
The single state equation from the bond graph is
˙pJ = τd + (T /Rw)(ec −(T /J)pJ)
(6.203)
We need the plant transfer function Gp(s) relating rotational angle to the
control voltage ec and we also need the disturbance transfer function Gd(s)
relating the rotational angle to the disturbance torque τd. These transfer functions
are most easily derived by ﬁrst deriving the transfer functions for the angular

290
ANALYSIS AND CONTROL OF LINEAR SYSTEMS
ec
Rw
i
q
td
J
1
R : Rw
pJ
.
ecSe
Setd
I : J
GY
1
T
i
FIGURE 6.52. Schematic and bond graph of an angular position control system.
velocity and then simply integrating the angular velocity by dividing by s. The
angular velocity ω is the angular momentum pJ divided by moment of inertia J.
Thus,

Ec
(s) =
T /RwJ
s + T 2/RwJ , 
Td
(s) =
1/J
s + T 2/RwJ
(6.204)
and, therefore,
Gp(s) = 
Ec
(s) =
T /RwJ
s(s + T 2/RwJ), Gd(s) = 
Td
(s) =
1/J
s(s + T 2/RwJ).
(6.205)
Figure 6.53 shows the approximate root locus if we propose PD control for
this system where the controller Gc(s) is
Gc(s) = K(s + z).
(6.206)
jw
x
x
0
Potential closed loop
poles
a
FIGURE 6.53. Approximate root locus of the angular position control system.

INTRODUCTION TO AUTOMATIC CONTROL
291
For this low-order system we can derive the closed-loop transfer functions
using block diagram algebra as indicated by Eqs. (6.199) and (6.200). Thus,

des
|CL(s) =
(KT /RwJ)(s + z)
s2 + [(T 2 + KT )/RwJ]s + (KT /RwJ)z,

Td
|CL(s) =
1/J
s2 + [(T 2 + KT )/RwJ]s + (KT /RwJ)z.
(6.207)
The closed-loop denominator shows that we are able to adjust the constant
term through our choice of Kz and we can adjust the s-term through our choice
of K. Thus, the closed-loop eigenvalues are completely adjustable using this
PD controller. Furthermore, if we set s = 0 we can determine the ﬁnal value of
the response to a step input in θdes or τd. The ﬁrst of Eqs. (6.207) shows that
θ →θdes, and the second equation indicates that

Td
|CL|s→0 =
1
(KT /Rw)z.
(6.208)
For θ to have a very small response to the disturbance torque the system gain
will have to be large, and this may force a compromise with the desired dynamic
response of the system or the power required to accomplish the control. This can
be demonstrated computationally using the parameters listed in Table 6.1.
Figure 6.54 shows the step response of the controlled system for two values
of the overall system gain. It appears that we can make the system arbitrarily
fast by simply increasing the gain.
Figure 6.55 shows the step response of the rotational angle to a disturbance
torque. Increasing the system gain indicates that we can reduce the response to
a disturbance to an arbitrarily small value.
Figure 6.56 shows the control voltage needed to accomplish the control. We see
that there is a price to be paid for increasing the system performance. The voltage
required increases, as does the current and the power. Thus, in a real controller
TABLE 6.1. Parameters for the control
system of Figure 6.52
Winding resistance, Rw = 1 
Coupling constant, T = 0.5 Nm/A
Mass of rotating disk, m = 5/2.2 kg
Radius of rotating disk, R = 4.0(0.0254) m
J = mR2
2
kg-m2
Location of the controller zero, z = 20
Overall system gain, K = 0.1, 0.2

292
ANALYSIS AND CONTROL OF LINEAR SYSTEMS
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
Time, s
theta/thetades
K = .1
K = .2
FIGURE 6.54. Step response of the angular position control system for two values of
overall system gain.
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
Time, s
theta/taud
K = .1
K= .2 
FIGURE 6.55. Step response to a disturbance torque input of the angular position control
system for two values of overall system gain.

INTRODUCTION TO AUTOMATIC CONTROL
293
0
0.01
0.02
0.03
0.04
0.05
0.06
0.07
0.08
0.09
0.1
0
10
20
30
40
50
Time, s
Control voltage
K = .1
K = .2
FIGURE 6.56. Control voltage for two values of overall system gain.
design we must consider the trade-offs between desired system performance,
actuator capabilities, and power limitations.
Consider now a modiﬁed version of the system from Figure 6.52. There is
now twisting of the shaft that couples the motor to the rotating inertia and it has
stiffness kτ Nm/rad. The schematic and bond graph are shown in Figure 6.57.
There are two state variables, pJ , the angular momentum of the rotating mass,
and qτ the twist angle in the shaft. Using the derivation procedure from Chapter 5,
the state equations are
d
dt

pJ
qτ

=

0
kτ
−1/J
−Rwkτ/T 2
 
pJ
qτ

+

0
1/T

ec +

1
0

τd.
(6.209)
J
1
GY
I : J
C : kt
qt
.
pJ
.
R : Rw
1
T
i
0
ec
Rw
Setd
ecSe
kt
i
q
td
FIGURE 6.57. Modiﬁed physical system from Figure 6.52.

294
ANALYSIS AND CONTROL OF LINEAR SYSTEMS
And in the s-domain these become
 s
−kτ
1/J
s + Rwkτ/T 2
 
PJ (s)
Qτ(s)

+

0
1/T

Ec(s) +

1
0

Td(s).
(6.210)
The transfer functions relating the angular velocity of the rotating mass to the
control voltage and the disturbance torque are straightforwardly derived as

Ec
(s) =
kτ/JT
s2 + (Rwkτ/T 2)s + kτ/J , 
Td
(s) =
(1/J)(s + Rwkτ/T 2)
s2 + (Rwkτ/T 2)s + kτ/J ,
(6.211)
and the transfer functions for the angular displacement are derived by simply
dividing by s (integrating ω), yielding the plant transfer function and the distur-
bance transfer function as
Gp(s) = 
Ec
(s) =
kτ/JT
s[s2 + (Rwkτ/T 2)s + kτ/J],
Gd(s) = 
Td
(s) =
(1/J)(s + Rwkτ/T 2)
s[s2 + (Rwkτ/T 2)s + kτ/J].
(6.212)
The open-loop poles of the plant are sketched in Figure 6.58 along with the
additional poles and zeros associated with proposed control actions. It should be
clear that proportional control will yield an unstable system. With three open-
loop poles and no open-loop zeros, there are three asymptotes with angles of
±60◦and 180◦. The intersections of the asymptotes with the real axis is going
to be very near the cluster of open-loop poles, as indicated by Eq. (6.192).
It is proposed to combine PD control and lead-lag control in order to have
stable closed-loop poles for a range of system gain. The PD control allows
placement of an additional zero, which reduces the pole zero excess from 3 to
2 and makes the angle of the asymptotes ±90◦. But the intersection with the
real axis is moved further to the right as indicated by Eq. (6.192). By adding the
lead-lag control action, the asymptotes are moved to the left, yielding a range of
system gain where the closed-loop poles are in an acceptable location. Thus, the
control action will be
Gc(s) = K s + z
s + p(s + zpd),
(6.213)
where z and p are the zero and pole of the lead-lag controller and zpd is the zero
associated with the PD control action.
The system parameters are the same as given in Table 6.1 with the addition
of the torsional stiffness. Let’s assume that the torsional spring is fairly soft
and the combined rotary inertia and spring yield a frequency of 1 Hz, such that
ω2
n = (2π1)2 and kτ = Jω2
n.
The program Matlab [5] was used to evaluate the closed-loop step response of
the system as shown in Figure 6.59. The controller poles and zeros were selected
through some numerical experimentation. As can be seen in the ﬁgure, there is

INTRODUCTION TO AUTOMATIC CONTROL
295
x
x
x
(a) Approximate location
of the plant poles
jw
jw
x
x
x
(b) Approximate root
locus with PD and lead-
lag control
0
0
x
Pole and zero of lead-
lag controller
Zero of PD controller
asymptotes
a
a
FIGURE 6.58. Approximate root locus for the system of Figure 6.57 using PD and
lead-lag control.
some overshoot at the beginning of the response followed by a settling to the
ﬁnal value of
θ
θdes →1. It would appear to be possible to obtain a faster response
using different controller parameters and a different system gain, but the physical
system itself indicates that this is really not possible. We are trying to control
the position of a rotary inertia by twisting the end of a relatively soft spring. A
fast response of such a system requires much twisting of the shaft, as shown in
Figure 6.60. This example shows that it is important to couple one’s physical
system understanding with the principles of automatic control to obtain a realistic
overall system design.

296
ANALYSIS AND CONTROL OF LINEAR SYSTEMS
0
0.2
0.4
0.6
0.8
1
1.2
1.4
1.6
1.8
2
0
0.2
0.4
0.6
0.8
1
1.2
1.4
Time, s
theta/thetades
FIGURE 6.59. Step response of the angular position control system.
Motion Control Using State Variable Feedback. In classical control we measure
one output and compare the measurement to some desired output and generate an
error signal upon which the controller compensator operates to generate actuator
commands. The system is composed of perhaps many states and if all the states
can be continuously measured, then certainly they contain more information than
just a single output measurement. Consider our typical starting point for linear
system analysis,
[˙x] = [A][x] + [bd] ud + [bc] uc,
y = [c]t[x],
(6.214)
where there is one control input uc, one disturbance input ud, and one output y.
Let’s propose that the control input depends on the state variables such that
uc = K(ydes −[k]t[x]),
(6.215)
where K is an overall system gain and [k]t is a row vector of gains multiplying
the state variables. Using this control action in Eqs. (6.214) yields
[˙x] = [A −[bc] K[k]t][x] + [bc] Kydes + [bd] ud,
y = [c]t[x].
(6.216)

INTRODUCTION TO AUTOMATIC CONTROL
297
0
0.2
0.4
0.6
0.8
1
1.2
1.4
1.6
1.8
2
−20
−10
0
10
20
30
40
50
60
Time, s
twist angle/thetades
FIGURE 6.60. Step response of the shaft twist angle corresponding to the position
response of Figure 6.59.
From Eq. (6.216) we see that state variable feedback modiﬁes the original
[A]-matrix into the closed-loop [A]-matrix,
[A]∗= [A −[bc] K[k]t],
(6.217)
such that the closed-loop eigenvalues come from the closed-loop characteristic
equation
Det[sI −A∗] = 0.
(6.218)
It is straightforward to show that state variable feedback allows arbitrary
placement of closed-loop poles anywhere in the s-plane (see References [6] and
[7]). It is demonstrated here using the angular displacement control system from
Figure 6.57.
The state equations were derived previously as Eqs. (6.209) and are repeated
here with the substitution of state variable feedback control,
ec = K(θdes −[k]t[x]) = K
⎛
⎝θdes −[kpJ
kqτ
kθ]
⎡
⎣
pJ
qτ
θ
⎤
⎦
⎞
⎠.
(6.219)
One modiﬁcation to state equations (6.209) is the inclusion of the rotational
angle of the rotary inertia as an additional state variable.

298
ANALYSIS AND CONTROL OF LINEAR SYSTEMS
Using (6.219) in the state equations results in
d
dt
⎡
⎣
pJ
qτ
θ
⎤
⎦=
⎡
⎣
0
kτ
0
−1/J
−Rwkτ/T 2
0
1/J
0
0
⎤
⎦
⎡
⎣
pJ
qτ
θ
⎤
⎦
−
⎡
⎣
0
1/T
0
⎤
⎦K
kpJ
kqτ
kθ

⎡
⎣
pJ
qτ
θ
⎤
⎦+
⎡
⎣
0
1/T
0
⎤
⎦Kθdes +
⎡
⎣
1
0
0
⎤
⎦τd
(6.220)
or
d
dt
⎡
⎣
pJ
qτ
θ
⎤
⎦=
⎡
⎣
0
kτ
0
−1/J −KkpJ /T
−Rwkτ/T 2 −Kkqτ /T
−Kkθ/T
1/J
0
0
⎤
⎦
⎡
⎣
pJ
qτ
θ
⎤
⎦
+
⎡
⎣
0
1/T
0
⎤
⎦Kθdes +
⎡
⎣
1
0
0
⎤
⎦τd,
(6.221)
yielding
A∗=
⎡
⎣
0
kτ
0
−1/J −KkpJ /T
−Rwkτ/T 2 −Kkqτ /T
−Kkθ/T
1/J
0
0
⎤
⎦.
(6.222)
The closed-loop characteristic equation is
Det[sI −A∗] = Det
⎡
⎣
s
−kτ
0
1/J + KkpJ /T
s + Rwkτ/T 2 + Kkqτ /T
Kkθ/T
−1/J
0
s
⎤
⎦= 0
or
s3 + (Rwkτ/T 2 + Kkqτ /T )s2 + kτ(1/J + KkpJ /T )s + kτKkθ/JT = 0
(6.223)
Since the adjustable gains kpJ , kqτ , kθ appear in the coefﬁcients of s2, s1, s0,
these coefﬁcients are totally adjustable and the three-closed loop eigenvalues can
be placed arbitrarily.
It is instructive to complete this derivation by looking at the closed-loop
transfer functions relating θ to θdes and θ to τd. This comes from using Cramer’s
rule on the s-domain representation of Eqs. (6.221). The result of the algebra is

des
=
Kkτ/T J
s3 + (Rwkτ/T 2 + Kkqτ /T )s2 + kτ(1/J + KkpJ /T )s + kτKkθ/JT ,

Td
=
(1/J)(s + Rwkτ/T 2 + Kkqτ /T )
s3 + (Rwkτ/T 2 + Kkqτ /T )s2 + kτ(1/J + KkpJ /T )s + kτKkθ/JT .
(6.224)

INTRODUCTION TO AUTOMATIC CONTROL
299
One observation is that state variable feedback does not insure the absence of
steady-state error. In the ﬁrst of Eq. (6.224) the ﬁnal value of the step response
to a unit change in θdes is obtained from the transfer function by letting s →0.
This results in
θ
θdes
|s→0 →1
kθ
,
(6.225)
which is not unity unless kθ = 1. While not proven here, it is also a true that state
variable feedback does not change the location of any open-loop zeros for the
closed-loop response to the reference input. The ﬁrst of Eqs. (6.212) is the open-
loop plant transfer function. Notice that the numerator of this transfer function is a
constant. Using state variable feedback, the closed-loop response to the reference
is the ﬁrst of Eqs. (6.224). The numerator is again a constant, unaffected by
the feedback gains. It is provable that the open-loop and closed-loop zeros are
the same when using state variable feedback. This observation is not true for the
disturbance response. As seen from the second of Eqs. (6.224), the feedback gains
do affect the numerator of the disturbance transfer function.
Figure 6.61 shows the step response of the angular position control system
having chosen the state variable gains to yield an acceptable response with the
gain kθ = 1, such that there is zero steady-state error.
0
0.2
0.4
0.6
0.8
1
1.2
1.4
1.6
1.8
2
0
0.2
0.4
0.6
0.8
1
1.2
1.4
Time, s
theta/thetades
FIGURE 6.61. Step response of the angular control system to a unit step change in
desired angular position.

300
ANALYSIS AND CONTROL OF LINEAR SYSTEMS
−10
−5
0
5
10
15
20
25
Twist angle
0
0.2
0.4
0.6
0.8
1
1.2
1.4
1.6
1.8
2
Time, s
FIGURE 6.62. Step response of the shaft twist angle to a unit step change in desired
angular position.
Figure 6.62 shows the twist angle in the shaft and we see that we are able
to accomplish the position control with a more reasonable twist angle than was
needed for the compensated system of Figure 6.60.
This example indicates that state variable feedback is a powerful tool for
designing control systems. Since closed-loop poles can be arbitrarily speciﬁed,
system stability can be guaranteed. The practical problem in using state variable
feedback for complex multistate systems is that each state must be measured in
order to be fed back as part of the control system. As the number of sensors grows
so does cost of implementation. Keep in mind that state variables are “man-made”
and are part of a model that is a representation of a physical system. It may not
be possible to measure a system state, as that state may be just a ﬁgment of the
imagination of the modeler. Furthermore, it is not practical to expect multiple
sensors to remain calibrated and operational over the long term. Nevertheless,
state variable feedback is often part of an overall control system design, as it is
indicative of the level of control that is theoretically attainable and provides an
excellent target for more practical control approaches.
The interested reader should see References [3] and [6]–[8] to learn more
about state variable feedback and the possibility of estimating some states in order
to reduce the number of actual measurements. The computer program Matlab [5]
contains many procedures to assist in the design of state variable controllers.

INTRODUCTION TO AUTOMATIC CONTROL
301
Vibration Control. In the previous section on motion control the idea was to use
controlled actuators to force a system to follow a desired trajectory while simul-
taneously responding as little as possible to a disturbance input. Another use of
automatic control is to force a structure to behave in a prescribed way to external
disturbances. This use of automatic control comes under the heading of vibration
control. When a structure requires isolation from its environment it is typical to ﬁrst
use passive means to provide the isolation. Commercial “isolators” are available
in all shapes and sizes to provide such passive isolation. These devices all have
compliance and dissipative properties in the form of springs, rubber pads, shock
absorbers, air springs, and so forth. When isolation beyond that possible with pas-
sive elements is required, then automatic control becomes a candidate solution.
The approach to developing the control is somewhat different than that for
motion control and is demonstrated using the example from Figure 6.63. This
example system was used earlier in Section 6.5.1 to demonstrate frequency
response. It is repeated here for convenience. The system consists of a mass
to be isolated from the ground motion with a proposed controlled force element
located between the mass and ground input. Also shown in the ﬁgure is the
“desired” system as well as system bond graphs.
0
1
m  I
m  I
R  b
C1/k
C1/k
m
b
k
Fc
bc
v
vin
vin
vin  Sf
Sf  vin
R  bc
Se  Fc
qk
.
qk
.
pm
.
pm
.
v
0
m
k
(a) Physical system with a
controlled force and its
bond graph
1
(b) Desired system with a
damper to inertial ground
and its bond graph
FIGURE 6.63. Vibration isolation system.

302
ANALYSIS AND CONTROL OF LINEAR SYSTEMS
In vibration control it is typical to specify the desired performance in the
frequency domain. We are not so much interested in having the response to a
disturbance approach zero but rather we would like the system to respond in a
prescribed way over some range of frequencies.
The state equations for the controlled system come directly from the bond
graph as
˙pm = bvin −(b/m)pm
m + kqk + Fc,
˙qk = vin −(1/m)pm,
(6.226)
where pm is the momentum of the mass and qk is the displacement across the
spring (with the spring, damper, and control force all positive in compression).
In the s-domain these equations become

s + b/m
−k
1/m
s
 
Pm(s)
Qk(s)

=

b
1

Vin(s) +

1
0

Fc(s),
(6.227)
yielding the transfer functions
V
Vin
(s) =
(b/m)s + k/m
s2 + (b/m)s + k/m =
2ζωns + ω2
n
s2 + 2ζωns + ω2n
V
Fc
(s) =
(1/m)s
s2 + (b/m)s + k/m =
(1/m)s
s2 + 2ζωns + ω2n
,
(6.228)
where the damping ratio ζ and natural frequency ωn have been deﬁned previously.
For the desired system shown in Figure 6.63b the state equations are
˙pm = −(bc/m)pm + kqk
˙qk = vin −(1/m)pm,
(6.229)
with an s-domain representation of

s + bc/m
−k
1/m
s
 
Pm(s)
Qk(s)

=

0
1

Vin(s),
(6.230)
yielding the transfer functions

 V
Vin

des
=
k/m
s2 + (bc/m)s + k/m =
ω2
n
s2 + 2ζcωns + ω2n
,

Vrel
Vin

des
=
s(s + bc/m)
s2 + (bc/m)s + k/m =
s(s + 2ζcωn)
s2 + 2ζcωns + ω2n
,
(6.231)
where ζc is the desired damping ratio.
Note that the transfer function for Vrel(s) comes from ﬁrst deriving the transfer
function for Qk(s), the relative displacement across the suspension, and then

INTRODUCTION TO AUTOMATIC CONTROL
303
multiplying by s to take the derivative and yield the relative velocity, Vrel(s) =
sQk(s). We make use of this transfer function below.
The reason that the system in Figure 6.63b is the desired system becomes
apparent from the frequency responses shown in Figure 6.64. Remember, the
frequency response is obtained from the transfer functions by letting s = jω
and carrying out the steps shown in Section 6.5. The program Matlab [5] can
numerically perform these steps and produce the responses shown in Figure 6.64.
In Figure 6.63a, the damper is located in the conventional location between
the ground excitation and the structure mass. As a result, the frequency response
from Figure 6.64a shows increasing high-frequency response as the damping is
increased to reduce the resonant response. The system in Figure 6.63b has the
damper attached to the mass at one end and to inertial ground at the other. This
inertial damping produces the frequency response of Figure 6.64b. In this case we
can control the resonant behavior and retain excellent high-frequency isolation.
For most applications it is not possible to attach one end of a damper to inertial
space; thus, this system is “desired” but not attainable using passive devices.
The challenge is to use the control force to make the actual physical system
perform like the desired system over some frequency range. Because the systems
are linear, superposition dictates that
V (s) =

 V
Vin

Vin(s) +

 V
Fc

Fc(s),
(6.232)
where the terms in parentheses are the transfer functions from Eqs. (6.228). We
want the response to be identical to the ﬁrst of Eqs. (6.231); thus,

 V
Vin

Vin(s) +

 V
Fc

Fc(s) =

 V
Vin

des
Vin(s).
(6.233)
Solving for the control yields
Fc(s) =


 V
Vin

des
−

 V
Vin


 V
Fc

Vin(s).
(6.234)
Identify the numerator and denominator of the transfer functions from
Eqs. (6.228) and (6.231) as
Numerator of

 V
Vin

= N(s) = 2ζωns + ω2
n from Eq. (6.228)
Numerator of

 V
Fc

= 1
ms from Eq. (6.228)
Denominator of

 V
Vin

= D(s) = s2 + 2ζωns + ω2
n from Eq. (6.228)

304
ANALYSIS AND CONTROL OF LINEAR SYSTEMS
0
0.2
0.4
0.6
0.8
1
1.2
1.4
1.6
1.8
2
z = 0.3
z = 0.5
z = 0.7
0
0.5
1
1.5
2
2.5
3
3.5
4
4.5
5
0
0.2
0.4
0.6
0.8
1
1.2
1.4
1.6
1.8
w/wn
0
0.5
1
1.5
2
2.5
3
3.5
4
4.5
5
w/wn
Mag(Vm/Vin)
Mag(Vm/Vin)
z = 0.3
z = 0.5
z = 0.7
(a) Frequency response of the passive system
(b) Frequency response of the desired system
FIGURE 6.64. Frequency response of the passive and desired systems.

INTRODUCTION TO AUTOMATIC CONTROL
305
Numerator of

 V
Vin

des
= ω2
n from Eq. (6.231)
Denominator of

 V
Vin

des
= s2 + 2ζcωns + ω2
n from Eq. (6.231)
Use these deﬁnitions in Eq. (6.234) and obtain
Fc(s) = −
2ζcω3
ns
(1/m)s(s2 + 2ζcωns + ω2n)Vin(s) −
2ζωns2(s + 2ζcωn)
(1/m)s(s2 + 2ζcωns + ω2n)Vin(s)
(6.235)
The interpretation of this result is that if the input disturbance could be mea-
sured and then processed through the ﬁlter of Eq. (6.235), then the output force
would cause the controlled system to behave identically to the desired system.
It is not practical to measure the disturbance and there are simpliﬁcations to be
carried out.
The ﬁrst simpliﬁcation is to recognize that if the control force of (6.235) were
applied then the resulting response is the desired one of Eq. (6.231). Thus, solving
for Vin(s), Vin = s2 + 2ζcωns + ω2
n
ω2n
V (s), and substituting into the ﬁrst term of
Eq. (6.235) yields
Fc(s) = −2ζcωnmV (s) −
2ζωns2(s + 2ζcωn)
(1/m)s(s2 + 2ζcωns + ω2n)Vin(s).
(6.236)
The ﬁrst term on the right-hand side indicates that one part of the control force
simply opposes the absolute velocity of the structure mass. From the second of
Eqs. (6.231), solving for Vin(s) yields
Vin(s) = s2 + 2ζcωns + ω2
n
s(s + 2ζcωn)
Vrel(s),
such that Eq. (6.236) reduces to
Fc(s) = −2ζcωnmV (s) −2ζωnmVrel(s)
(6.237)
The end result is one that we could have observed from the physical systems
directly. The second term in (6.237) is the force produced by the passive damper
and the control action is to simply cancel this force and substitute a force (the ﬁrst
term in (6.237)) that would be generated by a damper attached to inertial space.
The idea of using active control to generate a force on a structure like a
damper to inertial ground turns out to be a very good strategy in vibration control.
Commercial devices for ground vehicle suspensions use this strategy as a major
part of their control action.
When it is not possible to locate a controlled actuator between two moving
parts of a structure, then the only way to generate a controlled force on the
structure is to use an inertial actuator. A major application area for inertial

306
ANALYSIS AND CONTROL OF LINEAR SYSTEMS
0
1
I
R
C1/k
m
b
k
vin
vin Sf
ec
va
ma
ma
Fc
ec
Se
Rw
pa
.
pm
.
qk
.
v
b
m
1
0
I
GY
1
R
T
FIGURE 6.65. Vibrating structure with an inertial actuator for control.
actuators is for vibration control on helicopters and ﬁxed-wing aircraft. Consider
the system of Figure 6.63 with the voice coil actuator attached to the structure
mass as shown in Figure 6.65.
A voice coil actuator is attached to the structure mass and, through electro-
magnetic coupling, can accelerate the proof-mass ma, thus creating a reaction
force on the structure. The bond graph of the physical system is also shown
in Figure 6.65 and state variables are identiﬁed on the bond graph along with
causality. The state equations come directly from the bond graph as
˙pm = kqk + bvin −(b/m)pm −T /Rw (ec −T (pa/ma −pm/m)) ,
˙pa = (T /Rw) (ec −T (pa/ma −pm/m)) ,
˙qk = vin −pm/m,
(6.238)
or in matrix form
d
dt
⎡
⎣
pm
pa
qk
⎤
⎦=
⎡
⎣
−b/m −T 2/Rwm
T 2/Rwma
k
T 2/Rwm
−T 2/Rwma
0
−1/m
0
0
⎤
⎦
⎡
⎣
pm
pa
qk
⎤
⎦
+
⎡
⎣
−T /Rw
T /Rw
0
⎤
⎦ec +
⎡
⎣
b
0
1
⎤
⎦vin.
(6.238a)
The actuator force Fc is labeled on the bond graph and, by following causality,
can be related to the state variables by
Fc = (T /Rw) (ec −T (pa/ma −pm/m)) .
(6.239)
From the previous example it has been established that a good strategy in
vibration control is to have the structure behave as though it has inertial damping

INTRODUCTION TO AUTOMATIC CONTROL
307
bc. For the sign convention shown in Figure 6.65, this requires the control force
to be
Fc = (bc/m)pm = (T /Rw) (ec −T (pa/ma −pm/m)) ,
(6.240)
which allows the control voltage to be derived as
(T /Rw)ec = (bc/m)pm + (T 2/Rw)(pa/ma −pm/m).
(6.241)
There are two ways to look at this control action. In terms of the velocities
of the structure mass and proof-mass we obtain,
(T /Rw)ec = bcv + (T 2/Rw)vrela
(6.242)
where vrela is the relative velocity between the proof-mass and the structure mass,
positive in extension. By measuring the absolute velocity of the structure mass
and the relative velocity across the actuator, the control voltage can be established
such that inertial damping results.
Equation (6.241) allows the control voltage to be set using state variable
feedback as described above. The control voltage can be written as
(T /Rw)ec =

bc/m −T 2/Rwm
T 2/Rwma
0

⎡
⎣
pm
pa
qk
⎤
⎦,
(6.243)
which modiﬁes the state equations to
d
dt
⎡
⎣
pm
pa
qk
⎤
⎦=
⎡
⎣
−b/m −bc/m
0
k
bc/m
0
0
−1/m
0
0
⎤
⎦
⎡
⎣
pm
pa
qk
⎤
⎦+
⎡
⎣
b
0
1
⎤
⎦vin.
(6.244)
In the s-domain the controlled system representation becomes
⎡
⎣
s + b/m + bc/m
0
−k
−bc/m
s
0
1/m
0
s
⎤
⎦
⎡
⎣
Pm(s)
Pa(s)
Qk(s)
⎤
⎦=
⎡
⎣
b
0
1
⎤
⎦vin.
(6.245)
The transfer function relating the structure mass velocity to the input velocity
comes from using Cramer’s rule, with the result
V
Vin
(s) =
s((b/m)s + k/m)
s(s2 + (b/m + bc/m)s + k/m).
(6.246)
The appearance of the control parameter bc in the denominator indicates that
the frequency response can be reduced at the resonant frequency while also reduc-
ing the response at high frequency. The control voltage needed to accomplish
this control comes from Eq. (6.243) as
T
Rw
Ec
Vin
(s) =

bc
m −T 2
Rwm
 Pm
Vin
(s) +
T 2
Rwma
Pa
Vin
(s).
(6.247)

308
ANALYSIS AND CONTROL OF LINEAR SYSTEMS
Again using Cramer’s rule, the appropriate transfer functions can be derived
and the result is
T
Rw
Ec
Vin
(s) =

 b
ms + k
m
 
(bc −T 2/Rw)s + bcT 2/Rwma

s(s2 + (b/m + bc/m)s + k/m)
.
(6.248)
Using the deﬁnitions, b
m = 2ζωn, bc
m = 2ζcωn, and ω2
n = k
m, Eqs. (6.246)
and (6.248) can be placed in the nondimensional format,
V
Vin
(s) =
2ζ s
ωn
+ 1
s2
ω2n
+ (2ζ + 2ζc) s
ωn
+ 1
,
T
mRwωn
Ec
Vin
(s) =

2ζ s
ωn
+ 1
 
2ζc −
T 2
mRwωn
 s
ωn
+ 2ζc
T 2
mRwωnma
m

s
ωn

 s2
ω2n
+ (2ζ + 2ζc) s
ωn
+ 1

.
(6.249)
Table 6.2 lists some parameters for the physical system of Figure 6.65 and the
program Matlab [5] was used to generate some system responses.
Figure 6.66a shows that the inertial actuator is quite capable of generating
a force on the structure that emulates an inertial damper. Figure 6.66b shows
the nondimensional control voltage required to produce the respective level of
isolation.
If this was an analysis performed for system design purposes, we would next
perform extensive parameter studies by assessing the effect of the electromagnetic
coupling constant, winding resistance, size of the proof mass, and so forth. Such
an analysis proves invaluable in the initial design and prototyping of a vibration
control system.
TABLE 6.2. Parameters for the system of Figure 6.65
Structure mass, m = 50/2.2 kg
Natural frequency, ωn = 2π2 rad/s, such that
k = mω2
n
Passive damping ratio, ζ = 0.3, such that
b = 2ζωnm
Coupling constant for the inertial actuator, T = 0.5 N/A
Winding resistance, Rw = 2 
Ratio of actuator proof mass to structure mass, ma
m = 1
20

INTRODUCTION TO AUTOMATIC CONTROL
309
0
0.2
0.4
0.6
0.8
1
1.2
1.4
1.6
1.8
2
0.4
0.5
0.6
0.7
0.8
0.9
1
1.1
1.2
1.3
Nondimensional frequency
0
0.2
0.4
0.6
0.8
1
1.2
1.4
1.6
1.8
2
Nondimensional frequency
V/Vin
zc = 0.2
zc = 0.4
zc = 0.6
0
0.5
1
1.5
2
2.5
3
3.5
4
(T/mRw wn)Ec/Vin
zc = 0.2
zc = 0.4
zc = 0.6
(a) Velocity response for various control gains
(b) Input voltage to actuator for various control gains
FIGURE 6.66. Frequency response of the controlled system from Figure 6.65.

310
ANALYSIS AND CONTROL OF LINEAR SYSTEMS
6.7
SUMMARY
This chapter was devoted to linear system analysis. It is an important topic
because some aspects of the behavior of many engineering systems can be prof-
itably studied using linear models. For such systems an abundance of analytical
tools are available, which have been conveniently packaged into a number of
computer programs.
In the experience of the authors, there are three extremely important linear
system concepts for engineers dealing with dynamic physical systems: eigenval-
ues, transfer functions, and frequency response. Eigenvalues have nothing to do
with system inputs but only with the inherent system dynamics. For low-order
systems we can obtain analytical expressions for the eigenvalues and determine
system natural frequencies and damping. When a system is modeled and state
variables are identiﬁed, we know how many eigenvalues there are and how each
contributes to the system response. Eigenvalues reveal stability issues before any
system responses are generated. It is worth one’s time to understand the message
of eigenvalues.
Transfer functions are the ratio of an output to an input in the s-domain. They
are straight forwardly derived from the state-space representation of a system.
Transfer functions and their block diagram representations are the starting point
for virtually all development of automatic control.
Frequency response is the response of a system output variable to a ﬁxed-
frequency system input variable. It is a convenient test to perform on actual
physical systems because a ﬁxed-frequency sinusoidal input is relatively easy to
generate in a laboratory environment. By substitution of s = jω in a transfer
function, the complex frequency-response function is generated and from the
complex frequency-response function it is straightforward to obtain magnitude
and phase information. The frequency response reveals troublesome resonances,
high-frequency behavior, frequencies where the response is small, and more.
The ﬁnal part of this chapter introduced the topic of automatic control, which
deals with using sensors and actuators to change the inherent behavior of a
physical system. Control systems typically act on the error between a desired
response and the actual response, and controller design deals with the control
action that operates on the error signal and outputs commands to the actuators,
which then move the system so as to reduce the error. The “controller” can take
many forms, but in the initial design phase it tends to be a transfer function with
characteristics that come from the design concepts presented in this chapter.
This book is devoted to modeling physical engineering systems and the ﬁrst
chapters have been devoted to linear system concepts. The fact is there are no truly
linear systems. The second half of this book deals with more realistic nonlinear
systems modeled using the same procedures as already presented. So the reader
should be careful when modeling a system as linear or linearizing a nonlinear sys-
tem so that linear analysis tools can be used. It is typical in model development to
linearize a nonlinear model, develop controls for the linear system, and then test
the ability of the controller on the nonlinear system using computer simulation.

PROBLEMS
311
REFERENCES
[1] K. Ogata, System Dynamics, 3rd ed., Upper Saddle River, NJ: Prentice-Hall,
1998.
[2] J. L. Melsa and S. K. Jones, Computer Programs for Computational Assis-
tance in the Study of Linear Control Theory, 2nd ed., New York: McGraw-
Hill, 1973.
[3] W. J. Grantham and T. L. Vincent, Modern Control Systems Analysis and
Design, New York: Wiley, 1993.
[4] Wylie, C. R. Advanced Engineering Mathematics, New York: McGraw-Hill,
1960.
[5] Matlab and Simulink software, Natick, MA: Mathworks Co.
[6] K. Ogata, Modern Control Engineering, Upper Saddle Rriver, NJ: Prentice
Hall, 2010.
[7] G. Franklin, J. D. Powell, and Emami-Naeini, Feedback Control of Dynamic
Systems, 6th ed., Upper Saddle River, NJ: Prentice Hall, 2010.
[8] R. C. Dorf and R. H. Bishop, Modern Control Systems, 11th ed., Upper
Saddle River, NJ: Prentice Hall, 2008.
[9] Evans, W. R., Control system synthesis by root locus method, Trans. AIEE,
vol. 69, 1950.
[10] Evans, E. R., The use of zeros and poles for frequency response or transient
response, Trans. ASME, vol. 76, 1954.
PROBLEMS
6-1. Consider the undamped oscillator with natural frequency of 10 rad/s. See
Eq. (6.16). Determine the free response starting from zero initial position
and an initial velocity.
Apply Euler’s integration method, Eq. (6.6), for a few steps. What
would be a reasonable way to pick t so that the digital solution would
be accurate?
6-2. For the ﬁlter circuit shown, write state and output equations with the
voltage E(t) as the input and the terminal voltage as the output. Write the
characteristic equation from which the eigenvalues could be determined.

312
ANALYSIS AND CONTROL OF LINEAR SYSTEMS
6-3. Consider the bond graph shown below:
Assuming that all elements are linear, write state equations. Pick two
variables that could be output variables, and write output equations for
them. Identify the coefﬁcients in Eqs. (6.1a) and (6.2a) with your equation
coefﬁcients, as was done in Eq. (6.18). Sketch mechanical, electrical, and
hydraulic systems that could be modeled with this bond graph.
6-4. Using equations such as Eq. (6.43) or sketches in the complex plane,
demonstrate that
d
dt Re(ejωt) = Re

 d
dtejωt

.
6-5. If an automobile weighs 3000 lb and has an undamped natural frequency
of 1.0 Hz when it oscillates on its main suspension springs, what should
the total stiffness of the four shock absorbers be if a damping ratio of 0.707
is to be achieved? Consider the shock absorbers to be linear dampers even
though, in practice, shock absorbers are distinctly nonlinear.
6-6. Sketch a frequency-response plot for the output voltage divided by the
input voltage for the system of Problem 6-2.
6-7. In the system shown, consider V (t) to be a velocity input. Set up state
equations for the system, and let the acceleration of the top mass be a
system output. (Note that the acceleration is proportional to the total force
on the mass.) Find the ratio of the acceleration to the input velocity when
the velocity is sinusoidal, and sketch the frequency response plot.

PROBLEMS
313
6-8. If a ﬁrst-order system is excited by a cosine wave starting from a zero
initial condition at t = 0, sketch the forced response, free response, and
total response.
6-9. By labeling signals and writing equations implied by the blocks, demon-
strate the validity of the block diagram identity of Figure 6.20.
6-10. Using Figure 6.20, reduce Figure 6.19a to Figure 6.19b.
6-11. The rotor of the motor shown is connected through a ﬂexible shaft to
the pinion, which drives the rack and load mass M . Assuming the pinion
may be modeled as having no rotary inertia, construct a bond graph for
the free motion of the system. Find the eigenvalues of the system and
interpret them.
6-12. Figures a and b below depict two linear ﬁlters that are supposed to remove
unwanted high-frequency noise from a voltage signal E(t). In Figure a
the output voltage measured when no current is allowed to ﬂow is ea; in
Figure b the output is eb. All resistors have the same resistance R, and all
capacitors have the capacitance C.
(a)
For Figure a derive state equations, and relate the output, ea, to the
state variables. For Figure b ﬁnd state equations, and relate both ea
and eb to the state variables.
(b)
For Figure a ﬁnd the transfer function Hea/E(s) relating ea and E.
For Figure b ﬁnd transfer functions for Hea/E and Heb/E(s) ea and eb.

314
ANALYSIS AND CONTROL OF LINEAR SYSTEMS
(c)
Should the two transfer functions for ea in Figures a and b not be
equal? Should the transfer function for eb not be the square of the
transfer function for ea? If so, why?
6-13. Consider the bond graphs and state equations below.
(a)
Draw the corresponding circuits.
(b)
Describe qualitatively the effect in both cases when R →0 and
R →∞.
(c)
Find relations for the system eigenvalues in both cases, using the
following procedure:
i.
Let ˙x = Ax be the state equation.
ii.
If x = Xest, then sX = AX, or [sI −a][X] = [0] if [I ] is the
unit matrix.
iii.
The eigenvalues are values of s for which Det[sI −A] = 0,
since only when the determinant vanishes can X be nontrivial.
Note that A is given, so all that is required is to form sI −A and set
its determinant equal to zero. The results should square with (b).
6-14. The sketches below show a schematic diagram of a rotating eccentric
vibrator and a “mechanical network” representation of the device. The
assumption is that the motor produces a simple harmonic relative horizon-
tal velocity of
V cos ωt = rω cos ωt = Re

V ejωt
between the rotating mass m and the main mass M . Because of the
assumed constraints, we do not discuss vertical forces or vertical motion.

PROBLEMS
315
(a)
Construct a bond graph for the system, and fully augment it. Assume
FB is a known force applied to the system.
(b)
Write a state equation for the system, and write output equations for
VA and VB.
(c)
Verify, using the results of (b), that the following terms sometimes
used to describe the exciter are valid when Vejωt is the complex
representation of V cos ωt for the velocity source:
i.
The internal mobility looking back at B is the ratio of velocity
to force when the velocity generator is stopped and locked in
position:
VB
FB
=
1
jω (M + m).
ii.
The blocked force output at B is FB when some external agent
prevents motion of B:
FB(blocked) = jωmV.
iii.
The free-velocity output at B is the velocity at B when there is
no force FB:
VB(free) =
m
M + mV.
iv.
A general network theorem states that the internal mobility is
the quotient of the free velocity and the blocked force. See H. H.
Skilling, Electrical Engineering Circuits, New York: John Wiley
& Sons, 1957, p. 339. Verify the theorem for this example.
6-15. Reinterpret the bond graph in Figure 6.3b as if it referred to an electric
circuit with parameters R, C, and L. After showing the circuit, redraw the
Bode plots of Figure 6.14 showing the signiﬁcant points on the plot in
terms of the electrical rather than the mechanical parameters.
6-16. A transfer function between an output Y and an input X is
Y(x)
X(s) =
G(s2 + ω2
0)
s2 + 2ζωns + ω2n
ωn < ω0.
(a)
Let s = jω and write down the complex frequency-response function.
(b)
If x(t) is a harmonic input,
x = x cos(ωt);
then, for a linear system, we know
Y = Y cos(ωt + ϕ).
Derive expressions for Y and ϕ.
(c)
Sketch Y/X versus ω for low, medium, and high ζ, and imagine a
physical system that would behave like this.

316
ANALYSIS AND CONTROL OF LINEAR SYSTEMS
6-17. The system below is supposed to isolate the mass, m, from ground motion,
vi(t). The mass sits on a ﬂuid-ﬁlled displacer that is attached to an air
compliance using a long, ﬂuid-ﬁlled tube. The tube has area At, length L,
and ﬂuid density ρ. The nominal air volume is V . Construct a bond graph
for this device and show that yours is the same as the one given.
Ap
At
L, ζ
m
Rf
If
vi
vm
Ca
I:m
R
0
C:Ca
SF:vi
1
I:If
R
TF
qa
pm
.
.
Ap
:
(a)
Derive the state equations. There is some derivative causality, so use
procedures from Chapter 5 to deal with this problem.
(b)
Derive the transfer function relating output, vm, to input, vi.
(c)
Compare this transfer function with the one from Problem 6-16. What
do you think of this device as a vibration isolator?
(d)
From your knowledge of how the ﬂuid inertia, If , relates to physical
system parameters, can you suggest design changes that will improve
the high-frequency isolation?
6-18. For the two devices below, construct bond graph models, derive state
equations, and derive transfer functions relating vm(s) to vi(s). Turn these
transfer functions into frequency-response functions and sketch |vm/vi|
versus frequency. Comment on how these devices compare with respect
to vibration isolation.

PROBLEMS
317
vm
vi
b
k
m
vi
vm
k
b
m
6-19. In control systems, an error is generated between a desired output and
an actual output, and this error is passed through a controller ﬁlter, the
output of which is an effort or ﬂow that moves the system in a direction
that reduces the error. A typical control ﬁlter is the PID controller, which
produces a component of actuator output proportional (P) to the error, pro-
portional to the integral (I) of the error, and proportional to the derivative
(D) of the error. In the s-domain, this is given by
Gc(s) = KP + KDS + KI
s .
It is proposed to use the PID controller in a position control system. The
physical system is modeled as shown below, where we have control of
the force, Fc.
Fc
b
k
x, x.
xdes
m
(a)
Construct a bond graph model of this system and derive the transfer
function relating mass position, x, to force, Fc. Call this transfer
function Gp(s).
(b)
A block diagram of the entire control system is shown. Derive the
closed-loop transfer function relating the output, x, to the desired
position, xdes.

318
ANALYSIS AND CONTROL OF LINEAR SYSTEMS
xdes
x
Fc
Gc
Gp
e
+
−
(c)
Compare the system eigenvalues without control (open loop) to those
when the controller is operating (closed loop). Show how the con-
troller gains can change the eigenvalues.
(d)
Sketch the response of x to a step change in xdes and comment on
the ability of the PID controller to produce a reasonable response.
6-20. The ﬁgure shows a relatively simple electric circuit and a numbered bond
graph. The circuit has two energy storage elements, an inductor and a capac-
itor, so unless there is derivative causality involved, this should be a second-
order system. Assume that all elements are linear, with coefﬁcients as shown
in general or physical form in the table to the right of the bond graph.
(a)
Apply causality to the bond graph and write the state equations in
matrix form using either version of the coefﬁcients. The results should
be of the form of Eq. (6.1b) and the matrices should resemble those
in Eq. (6.18).
(b)
Find the characteristic equation as was done in Eqs. (6.29) and (6.30)
by setting the determinant of the matrix [sI −A] to zero.
(c)
By matching your characteristic equation coefﬁcients to the coefﬁ-
cients in the version shown in Eq. (6.29), determine the undamped
natural frequency, ωn, and the damping ratio, ζ, in terms of the
physical parameters L, C, Ra, and Rb.
L
C
Ra
Rb
E(t)
Se
1
0
R
I
C
R
1
2
3
4
5
6
I4 = L
C5 = C
R2 = Ra
R6 = Rb
6-21. The ﬁgure below shows a simple mechanical system consisting of a mass,
two dashpots, and a velocity source with friction between the mass and

PROBLEMS
319
the stationary base. The dashpots and the ground friction are represented
as if they are linear friction elements with coefﬁcients B2, B3, and B5.
The input forcing function is the velocity V6(t), which can be represented
in general terms as the ﬂow source f6(t).
V1
B5
B3
Sf
V6(t)
B2
M
1
0
R
R
R
I
1
2
3
4
5
6
(a)
First, convince yourself that the bond graph does represent the sys-
tem. Then apply causality and write the state equation using general
effort and ﬂow variables and generalized coefﬁcients such as, I1, R2,
and so on. Based on the equation, determine the time constant in
terms of the generalized coefﬁcients as well as the corresponding
physical coefﬁcients, M , B2, and so forth.
(b)
Now suppose that the applied velocity, V6(t), is replaced by an
applied force, F6(t). (The applied force is represented in general
terms as the effort e6(t). It is too bad that force and ﬂow both start
with F. In part a, f6 = V6, but here e6 is the force F6.) Again apply
causality and write the state equation. What is the time constant now
under the new type of forcing?
6-22. The ﬁgure shows a dc motor with winding resistance and inductance
attached to rotating inertia.
ec
Rw
L
J
ω

320
ANALYSIS AND CONTROL OF LINEAR SYSTEMS
(a)
Construct a bond graph model of this system, assign causality, iden-
tify the state variables, and derive the state equations. Put these into
standard matrix format [˙x] = [A][x] + [b]u.
(b)
Put the system into the s-domain and derive the characteristic
equation. Solve for and interpret the eigenvalues. Is there a natural
frequency? What is the damping ratio?
(c)
Derive the transfer function relating the output angular velocity to
the input voltage.
(d)
Modify this transfer function and show the transfer function relating
the output angular position of the rotating inertia to the input voltage.
6-23. The ﬁgure shows a part of a piping system with an oscillatory ﬂow input
Qi at one end, a side branch accumulator with ﬂuid inertia If and ﬂuid
compliance Ca, and an oriﬁce resistance with ﬂow output Qo. The bond
graph for the system is also shown with state variables identiﬁed.
(a)
Derive the state equations and put into matrix form [˙x] = [A][x] +
[b]u.
(b)
Put into the s-domain and derive the characteristic equation and the
eigenvalues.
(c)
Derive the transfer function Qo
Qi
(s).
(d)
Derive the complex frequency response function and sketch the mag-
nitude response. Comment on any interesting behavior.
Qi(t) = Qi0coswt
0
1
I
R
C
Sf
Qo
Qo
Ca
qa.
pf
Rf
If
.
Qi
Side branch
accumulator
6-24. The classic starting point for single input–single output control is the
block diagram shown here where poles and zeros of the forward loop
come from the plant and the controller transfer functions. Shown also are
several open-loop pole/zero conﬁgurations. It is interesting that once poles
and zeros are shown on the s-plane, we lose knowledge of which poles
and zeros are part of the plant and which come from the controller.
For each of the pole/zero conﬁgurations shown, sketch the root locus.
Show the asymptotes and where the locus exists on the real axis.

PROBLEMS
321
x(s)
e(s)
u(s)
y(s)
Gc(s)
Gp(s)
jw
jw
a
a
a
a
jw
jw
x
x
0
x
x
0
0
x
x
x
x
x
x
0
0
6-25. Some linear physical systems have open-loop pole/zero conﬁgurations
shown in the ﬁgure below. Using approximate root locus, show how P,
PD, PID, and/or lead-lag control will affect stability of the closed-loop
systems.
jw
jw
jw
jw
a
a
a
a
x
x
x
x
x
x
x
x
x
x
0
0
x

322
ANALYSIS AND CONTROL OF LINEAR SYSTEMS
6-26. A velocity control system is shown in the ﬁgure below. It consists of
a voice coil actuator with control voltage input ec, coupling constant T ,
winding resistance Rw, and inductance L. The actuator acts through a
damper b to ultimately move the load mass m. A disturbance force Fd can
also act on the load mass. A bond graph of the system is included in the
ﬁgure with causality assigned and state variables identiﬁed.
(a)
Derive the state equations and put into standard matrix format [˙x] =
[A][x] + [b]u.
(b)
Put your state equations in the s-domain and derive the plant transfer
function relating the load mass velocity to the control voltage and
the disturbance transfer function relating the load mass velocity to
the disturbance force.
(c)
Draw a block diagram that includes both the plant transfer function
and the disturbance transfer function. Close the loop and show a
general controller operating on the error between the desired and
actual velocity.
(d)
Show the open-loop poles and zeros of the plant and discuss the
control action that potentially produces an acceptable step response.
(e)
Discuss how the proposed controller works when the disturbance is
acting.
m
Fd(t)
Se Fd(t)
pm
Rw
Se
.
pL
.
ec
b
Voice coi lhas winding
resistance, Rw
winding inductance, L
and coupling constant, T
0
1
I
R
GY
R
I
L
b
m
1
T
6-27. Problem 6-26 can be turned into a position control system by simply divid-
ing the transfer functions for velocity by s. Derive the position transfer
functions and carry out the same procedure as Problem 6-26.
6-28. The ﬁgure shows a simple representation of a load-leveling system. This
might be a truck suspension where a load change represented by the dis-
turbance force Fd will change the height of the structure mass and we

PROBLEMS
323
desire the structure mass to return to its original position. On trucks, this
control is most often done using pneumatic devices, but here we simply
postulate a controllable velocity source vc.
0
1
I
R
C
Fd
ms
ms
ps
.
qs
.
vs
ks
bs
vc
vin = 0
vin = 0
bs
Se
Sf
Fd
Sf
1/ks
vc
1
0
The ﬁgure also shows the system bond graph. The reader should derive
the state equations, with the result
d
dt
⎡
⎣
ps
qs
x
⎤
⎦=
⎡
⎢⎢⎢⎢⎢⎢⎣
−bs
ms
k
0
−1
ms
0
0
1
ms
0
0
⎤
⎥⎥⎥⎥⎥⎥⎦
⎡
⎣
ps
qs
x
⎤
⎦+
⎡
⎣
0
1
0
⎤
⎦vc +
⎡
⎣
1
0
0
⎤
⎦Fd
where the position of the mass x has been added as a state.
X
X
KGc(s)
(s)
Xref
Vc
Fd
Vc
X (s)
Fd
(a)
Derive the transfer functions X
Vc
(s) and X
Fd
(s). The block diagram
for the control system is shown above.
(b)
Using root locus, demonstrate a control action KGc(s) that will pro-
duce stable closed-loop eigenvalues.
(c)
Will this control also produce zero steady-state error to a step change
in Fd?

324
ANALYSIS AND CONTROL OF LINEAR SYSTEMS
6-29. In Problem 6-28 propose state variable feedback of the form
vc = K
⎛
⎝xref −[kps kqs kx]
⎡
⎣
ps
qs
x
⎤
⎦
⎞
⎠
and derive the closed-loop transfer function between X and Fd. Com-
ment on possible placement of closed-loop poles and on the steady-state
response to step change in Fd.
6-30. A vibration control system similar to that of Figure 6.65 is shown below
along with a bond graph model and identiﬁed state variables. A base
excited spring–mass–damper system has an inertial actuator attached to
the structure mass. The force generated by the actuator is simply repre-
sented by the control force Fc. In this system the actuator mass is attached
to the structure through a spring and damper ka, ba.
0
1
I
R
C
va
ma
Se Fc
ba
qa
.
qs
.
pa
.
ps
.
1/ka
1/k
vs
Sf
vin
vin
ma
m
ba
ka
Fc
b
k
1
0
I
1
C
R
m
b
In vibration control we often are concerned with isolation of a single
frequency. Helicopters, propeller aircraft, and power-generating equipment
are examples of systems that operate at near constant rotational speed and
thus exhibit ﬁxed-frequency vibration. For such systems it can be beneﬁcial
for the actuator to have its own natural frequency.
(a)
For the system here derive the state equations and put them into the
standard matrix representation ˙x = Ax + bdvin + bcFc.
(b)
Put the state equations in the s-domain and derive the open-loop
transfer functions relating the structure mass velocity to the distur-
bance velocity and the structure mass velocity to the control force,
i.e., derive
Vm
Vin
(s)
and
Vm
Fc
(s).

PROBLEMS
325
(c)
Derive the complex frequency response functions and note particu-
larly the numerator of Vm
Vin (s). You should observe that if the actuator
damping ba is zero, then the structure mass motion is zero at the
special frequency, ω2
0 = ka
ma . If we know the single frequency distur-
bance, then we can “tune” the actuator to produce a small response
at this frequency without using any control power.
(d)
Propose a control action that simply cancels the effect of actuator
damping, derive the closed loop response of Vm
Vin (s), and demonstrate
that such a control action allows zero response at the “tuned” fre-
quency. Also demonstrate what happens if you go too far with your
control action and overcompensate for the actuator damping.

7
MULTIPORT FIELDS
AND JUNCTION STRUCTURES
In the ﬁrst part of this book, dynamic models for a variety of physical systems
were constructed using the 1-port elements —R, —C, —I , S e—, S f —; the 2-port
elements —TF— and —GY —; and the 3-port 0- and 1-junctions. In this chapter,
ﬁelds, which are multiport generalizations of —R, —C, and —I elements, are
introduced We also introduce the concept of a junction structure, which is an
assemblage of power-conserving elements,
—
|
0, —
|
1 —, —TF—, and GY—·
Using ﬁelds and junction structures, one may conveniently study systems con-
taining complex multiport components using bond graphs. In fact, bond graphs
with ﬁelds and junction structures prove to be a most effective way to handle the
modeling of certain multiport systems, combining both structural detail and clar-
ity with ease of visualization. Succeeding chapters demonstrate the application
of the elements introduced here to the modeling of systems containing multiport
devices.
In this chapter, we will be dealing with true bond graphs in which the product
of effort and ﬂow variables represents power ﬂowing on a bond. In Chapter 12,
pseudo-bond graphs will be introduced to represent thermoﬂuid systems. Pseudo-
bond graphs use variables that are not power variables. In many cases, the pseudo-
bond graph yields a simpler model than the equivalent true bond graph for such
systems. On the other hand, what appear to be R-ﬁelds and C-ﬁelds for pseudo-
bond graphs do not have all the properties to be discussed here because the power
and energy associated with a bond are not related to the effort and ﬂow variables
in the same way as they are for true bond graphs.
326
System Dynamics: Modeling, Simulation, and Control of Mechatronic Systems, Fifth Edition
Dean C. Karnopp, Donald L. Margolis and Ronald C. Rosenberg
Copyright © 2012 John Wiley & Sons, Inc.

ENERGY-STORING FIELDS
327
7.1
ENERGY-STORING FIELDS
In Chapter 3 it was shown that the elements —C and —I can store energy and can
give back stored energy without loss. This is true no matter what the constitutive
laws for these elements happen to be. Any single-valued functional relationship
between effort and displacement deﬁnes an energy-conservative capacitance ele-
ment, and any single-valued relationship between ﬂow and momentum deﬁnes an
energy-conservative inertia element. The multiport generalizations of —C and
—I , which we shall call C-ﬁelds and I -ﬁelds, respectively, will also be conser-
vative. As we shall see, the conservation of energy in the multiport cases imposes
a special constraint on the constitutive laws for C- and I -ﬁelds.
7.1.1
C-Fields
The symbol for a C-ﬁeld is simply the letter C, with as many bonds as the
C-ﬁeld has ports. An n-port C-ﬁeld is shown in Figure 7.1. Note that the ﬂow at
the ith port has been labeled ˙qi and that an inward sign convention is assumed.
The energy E stored in the C-ﬁeld can then be expressed as
E =
 t
t0
n

i=1
(eifi) dt =
 t
t0
n

i=1
ei ˙qi dt
=
 q
q0
n

i=1
ei(q) dqi =
 q
q0
e(q) dq = E(q),
(7.1)
in which the identity fi dt = dqi has been used, and column vectors of efforts
and ﬂows have been deﬁned thus:
q ≡
⎡
⎢⎢⎢⎢⎢⎣
q1
q2
q3
...
qn
⎤
⎥⎥⎥⎥⎥⎦
,
e(q) ≡
⎡
⎢⎢⎢⎢⎢⎣
e1(q)
e2(q)
e3(q)
...
en(q)
⎤
⎥⎥⎥⎥⎥⎦
,
(7.2)
FIGURE 7.1. The symbol of an n-port C-ﬁeld.

328
MULTIPORT FIELDS AND JUNCTION STRUCTURES
FIGURE 7.2. An elastic beam deformed by the action of two forces and represented as
a 2-port C-ﬁeld. Uniform beam: elastic modulus E; area moment of inertia I .
and e dq represents the scalar or inner product, which could also be represented
as et dq using the transpose of the column matrix e. Note that we have assumed
that each effort is a function of all the displacement variables.
At time t0, q = q0, and at time t, e = e(q) represents the constitutive laws of
the C-ﬁeld evaluated at q(t), the instantaneous value of the vector of displace-
ments.
Before going on to study the properties of general C-ﬁelds as deﬁned by Eqs.
(7.1) and (7.2), it may be worthwhile to exhibit some relatively simple C-ﬁelds
as they arise in practice. Some components of systems are described naturally
by C-ﬁelds. The beam of Figure 7.2, for example, might be part of a vibratory
system with masses or other elements attached at the locations indicated by
the F 1, ˙x1 and F 2, ˙x2 ports. If one neglects the mass of the beam (which is
permissible if the system frequencies are sufﬁciently low) and if one neglects
at least temporarily the possible power losses associated with inelastic material
behavior and the support pivots, then the beam is a purely elastic structure and
can be represented as a 2-port C-ﬁeld. The beam then may be represented by
constitutive relations among F 1, F 2, x1, and x2.
Many engineering undergraduates could ﬁnd the constitutive laws for this C-
ﬁeld at some point in their careers, although later they may forget just how to do
it. A convenient way to represent the beam is through the use of superposition
to add up the effects on x1 and x2 of the forces F 1 and F 2. This procedure (see
Reference [1], for example) works only because the beam is represented for a
linear range of strains and deﬂections. The result is conveniently expressed in a
matrix form:

x1
x2

=
L3
243 EI

4
7
2
7
2 4
 
F1
F2

.
(7.3)
This form of the constitutive laws, which gives displacements as a function of
efforts, is the compliance form. As long as the matrix in Eq. (7.3) is invertible,
one could solve the equation for F 1 and F 2 in terms of x1 and x2. This would
be the stiffness form for the constitutive laws.

ENERGY-STORING FIELDS
329
When an element is described from the beginning as a set of effort–
displacement relations at n ports, as in the beam example, we call the model
of the element an explicit ﬁeld. Generally, it is much more convenient to treat
explicit-ﬁeld elements as ﬁelds, although in some cases it would be possible to
ﬁnd an equivalent system of 1-port energy-storing elements bonded together with
junction structure elements that would have the same port constitutive laws as
the ﬁeld. On the other hand, when systems are assembled, it often happens that
a group of 1-port energy-storing elements, say —C’s, are interconnected with
—
|
0, —
|
1 —,
and
—TF—
elements. Such a subsystem often can be usefully treated as a ﬁeld. Such a ﬁeld is
called an implicit ﬁeld, since the ﬁeld constitutive laws at the external ports must
be deduced from the constitutive laws of the elements constituting the ﬁeld. An
example is shown in Figure 7.3. Except for the sign convention on one internal
bond, the electrical and mechanical systems shown in Figure 7.3 have the same
bond graph. If one imposes integral causality on the 1-port C-elements as in
Figure 7.3a, then it is clear that the state variables are x1 and δ2, namely, the
deﬂections of the two springs. Thus, it is not immediately clear that the C-ﬁeld
representation in terms of x1 and x2 is possible. Using the mechanical example,
let us work out the C-ﬁeld constitutive laws.
The causal strokes indicate that we can ﬁnd F 1 and F 2 as output variables in
terms of the state variables x1 and δ2:
F1 = k1x1 −k2δ2,
F2 = 0x1 + k2δ2,
(7.4)
FIGURE 7.3. A C-ﬁeld composed of 1-port C-elements and junction elements: (a) A me-
chanical example; (b) an electrical example.

330
MULTIPORT FIELDS AND JUNCTION STRUCTURES
where, for the sake of preserving simplicity in the example, the springs have
been assumed to be linear. The state equations are
˙x1 = ˙x1(t)
(given),
(7.5)
˙δ2 = ˙x2(t) −˙x1(t),
(7.6)
in which ˙x1 and ˙x2 are determined by some system external to the C-ﬁeld and
thus function as input variables.
Using Eq. (7.6), we see that δ2 may be expressed in terms of the C-ﬁeld
variables, x1 and x2, by means of a time integration:
δ2 = x2 −x1 + const.
(7.7)
Referring to Figure 7.3a, it can be seen that x1 and x2 can be deﬁned such
that when x1 = x2 = 0, F 1 = F 2 = δ2 = 0. Thus, the integration constant
in Eq. (7.7) can be set to zero when x1 and x2 represent deviations from the
positions at which the springs are unstretched. Using Eq. (7.7), we can eliminate
δ2 from Eq. (7.4). Then

F1
F2

=

k1 + k2 −k2
−k2
k2
 
x1
x2

,
(7.8)
which represents the constitutive laws of a 2-port C-ﬁeld in stiffness matrix
form. (The reader may beneﬁt from carrying out the steps required to express
the constitutive laws of the electrical C-ﬁeld of Figure 7.3b in a form analogous
to Eq. (7.8).)
An inspection of the constitutive laws of Eqs. (7.3) and (7.8) shows that for
these linear C-ﬁelds, the compliance matrix (Eq. (7.3)) and the stiffness matrix
(Eq. (7.8)) are symmetric. In general, compliance matrices and stiffness matrices,
which are inverses of each other, are always symmetric. This can be proven in
a form valid for even nonlinear C-ﬁelds by studying the stored-energy function
(7.1).
A change in any component of q, say qi, will produce a change in E, say
E. By a direct inspection of Eq. (7.1), one can deduce that the coefﬁcient
relating E to qi is, in fact, ei. Thus, the partial derivative of E with respect
to qi is just ei, or
∂E
∂qi
= ei(q),
i = 1, 2, . . . , n.
(7.9)
Because E = E(q) is supposed to represent the stored-energy function, which
we assume to be a single-valued scalar function of the vector q, if E is smooth
enough to have second derivatives, then
∂ei
∂qj
=
∂2E
∂qj∂qi
= ∂ej
∂qi
,
i, j = 1, 2, 3, . . . , n,
(7.10)

ENERGY-STORING FIELDS
331
which shows how ei(q) and ej(q) are constrained by the existence of the stored-
energy function, E. In other words, not every set of constitutive laws expressing
efforts in terms of displacements could come from an energy-storing, or energy-
conservative, C-ﬁeld. Physically, it is clear that elastic structures, capacitor
networks, and the like cannot supply more energy than the amount previously
stored, so Eq. (7.10) will apply to such devices.
In the linear case, Eq. (7.10) implies that stiffness matrices are necessarily
symmetrical for any conservative C-ﬁeld. If we use kij for stiffness matrix coef-
ﬁcients and k for the matrix itself, then the C-ﬁeld constitutive laws for an n-port
can be written thus:
ei =
n

j=1
kijqj
or
e = kq,
and Eq. (7.8) is a particular example. The stored energy is
E(q) = 1
2
n

i=1
n

j=1
kijqiqj = 1
2qtkq.
(7.11)
Application of Eq. (7.10) to Eq. (7.11) yields
kij = kji,
or
kt = k,
(7.12)
and since compliance matrices such as that in Eq. (7.3) are inverses of stiffness
matrices and the inverse of a symmetric matrix is also symmetric, we conclude
that compliance matrices must also be symmetric. The equations (7.12), which
are often called Maxwell’s reciprocal relations, are most easily derived from
the more general nonlinear relations (7.10), but graphical derivations based on
special integration paths are often used for the linear case. See Reference [2], for
example.
The reciprocal relations for C-ﬁelds and other energy-storing ﬁelds are more
useful and informative in some cases than it might at ﬁrst appear. In later chapters
dealing with a variety of applications, these relations will prove to be very impor-
tant. For now, we show only a few examples that are less obvious than our ﬁrst
ones. The system of Figure 7.4 shows how the end of a cantilever beam can inter-
act with a rotational and a translational port. Using beam superposition tables or
any other method to ﬁnd the beam deﬂections, the compliance matrix may be
found and inverted to ﬁnd the stiffness matrix:

F
τ

= EI

12/L3 −6/L2
−6/L3
4/L
 x
θ

.
(7.13)

332
MULTIPORT FIELDS AND JUNCTION STRUCTURES
FIGURE 7.4. Cantilever beam represented as a C-ﬁeld.
The symmetry of this matrix serves as a useful check on the correctness of
the computations leading up to it. Furthermore, we can make statements such
as the following. The number of newtons (the force) required to keep x at zero
when θ = 0.1 rad is equal to the number of newton-meters (the torque) required
to keep θ at zero when x = 0.1 m. Or, if F = 1 N and τ = 0, then θ in radians
will be numerically equal to x in meters when F = 0 and τ = 1 N-m. (The latter
statement is based on the symmetry of the compliance matrix.)
Nonlinear C-ﬁelds are common in certain application areas. Here we show
how a mechanical element that behaves as a linear 1-port in some restricted
cases can be modeled as a nonlinear 2-port C-ﬁeld when two-dimensional motion
is permitted. The element, shown schematically in Figure 7.5, is a simple lin-
ear spring attached to ground at one end and deﬂecting under the action of
forces F x and F y at the other end. It is possible to express F x and F y in
FIGURE 7.5. A nonlinear C-ﬁeld representation of a linear spring, one end of which
can move in a plane.

ENERGY-STORING FIELDS
333
terms of x and y and thus to consider this device as a C-ﬁeld. The constitutive
relations are
Fx = kx −k(x2 + y2)−1/2L0x,
Fy = ky −k(x2 + y2)−1/2L0y,
(7.14)
where k is the spring constant and L0 is the free length of the spring.
A check on (7.14) is given by Eq. (7.10):
∂Fx
∂y = −k(x2 + y2)−3/2L0x2y,
(7.15)
∂Fy
∂x = −k(x2 + y2)−3/2L0y2x.
(7.16)
Because the expressions on the right-hand sides in Eqs. (7.15) and (7.16)
are identical, the constitutive laws (7.14) do represent a nonlinear conservative
C-ﬁeld.
Actually, it is easiest to derive Eqs. (7.14) by using energy methods. The
stored energy E is easily expressed in terms of the radius r:
E = 1
2k(r −l0)2 = 1
2k

r2 −2rl0 + l2
0

,
and, using r2 = x2 + y2, we have
E = 1
2k

x2 + y2 −2l0

x2 + y21/2 + l2
0

.
(7.17)
When Eq. (7.17) is used according to Eq. (7.9) to derive Eq. (7.14), the
reciprocal relations, Eqs. (7.15) and (7.16), must follow immediately.
7.1.2
Causal Considerations for C-Fields
As in the case of 1-port C-elements, we may distinguish between integral and
derivative causality for multiport C-ﬁelds, but multiport ﬁelds also admit mixed
integral–derivative causalities. The completely integral causality form is
and the constitutive laws may be stated thus:
ei = −1
ci (q1, q2, . . . , qn) ,
i = 1, 2, . . . , n.
(7.18)

334
MULTIPORT FIELDS AND JUNCTION STRUCTURES
The completely derivative causality form is
and the constitutive laws may be restated in the form
qi = ci (e1, e2, . . . , en) ,
i = 1, 2, . . . , n.
(7.19)
In Eqs. (7.18) and (7.19), the generally nonlinear functions −1
ci
and ci are
named in analogy with their 1-port counterparts from Chapter 3. In mechanical
systems the compliance form corresponds to derivative causality and the stiffness
form to integral causality. When the ports are numbered so that the ﬁrst j ports
have integral causality and the remainder have derivative causality, then a mixed
causal form appears as
and the constitutive laws are
ei = i(q1, q2, . . . , qj, ej+1, . . . , en),
i = 1, 2, . . . , j;
(7.20)
qk = k(q1, q2, . . . , qj, ej+1, . . . , en),
k = j + 1, , . . . , n.
(7.21)
The question of which causal forms are possible for an energy-storing ﬁeld is
an interesting one. For an explicit ﬁeld that is speciﬁed by a set of constitutive
laws in a particular causal form, the question is an algebraic one in which each
causal form involves solving the given relationships again in terms of different
input and output variables. For nonlinear ﬁelds, it can be very hard to decide
whether this will be possible, and even for linear ﬁelds the problems are not
trivial. Of course, to convert from completely integral to completely derivative
causality or the reverse, one needs only to invert a matrix in the linear case.
Since there are straightforward tests of matrices to determine whether or not
the inverse exists, it is not hard to decide, for example, whether given a ﬁeld
in derivative causality the integral causality form is permissible. It is harder,
however, to establish a universal rule for testing all the mixed causal forms that
an n-port ﬁeld can exhibit.
For implicit ﬁelds, on the other hand, the rules of causality can often be used on
the elements of the ﬁeld to deduce which causal forms of the ﬁeld are possible. As
a very simple example, consider the implicit ﬁeld formed by a 1-port C-element

ENERGY-STORING FIELDS
335
and a 0-junction, as shown in Figure 7.6. This system is readily treated as a
2-port C-ﬁeld in integral causality (see Figure 7.6a). Reading the implicit-ﬁeld
causality, we may ﬁnd e1 and e3, assuming that the 1-port C is linear:
e1 = e3 = q3
C3
,
(7.22)
e2 = e3 = q3
C3
.
(7.23)
Now we wish to convert from q3 as a state variable to the ﬁeld state variables,
q1 and q2. Reading the bond graph, we have
˙q3 = ˙q1 + ˙q2,
(7.24)
or
q3 = q1 + q2 + const.
(7.25)
If for simplicity we deﬁne q1, q2, and q3 so that the integration constant
vanishes in Eq. (7.25), then the ﬁeld equations follow by substitution in Eqs.
(7.22) and (7.23):

e1
e2

=

1/C3 1/C3
1/C3 1/C3
 
q1
q2

.
(7.26)
FIGURE 7.6. A simple implicit ﬁeld: (a) integral causality; (b,c) mixed causality.
(Derivative causality for this ﬁeld is not possible.)

336
MULTIPORT FIELDS AND JUNCTION STRUCTURES
There are two ways to see that the completely derivative causal form is not
possible: (1) the rules of causality when applied to the implicit ﬁeld of Figure 7.6
do not allow the imposition of both e1 and e2 as inputs to the 0-junction, and
(2) the determinant of the matrix in Eq. (7.26) clearly vanishes, indicating that
Eq. (7.26) cannot be solved for q1, q2 in terms of e1 and e2.
On the other hand, two mixed causal forms are possible, as shown in
Figure 7.6b and c. For the form of Figure 7.6b, the relations are derived by
reading the implicit-ﬁeld bond graph:
e1 = e2,
(7.27)
˙q2 = −˙q1 + ˙q3 = −˙q1 + d
dt(C3e3) = −˙q1 + d
dt(C3e2).
(7.28)
Equation (7.28) must be integrated in time, and if q1 and q2 are properly
deﬁned, the integration constant can be made to vanish:
q2 = −q1 + C3e2.
(7.29)
In matrix form, the mixed causal form is

e1
q2

=

0
1
−1 C3
 
q1
e2

.
(7.30)
Note that the integral form, Eq. (7.26), is symmetric, as it must be according
to the energy argument, but mixed forms such as Eq. (7.30) will generally have
antisymmetric terms.
Although almost any nontrivial system may be considered to contain an
energy-storing ﬁeld (as we have just seen, even a single —C and a 0-junction
can be treated as a 2-port ﬁeld), it is often not worthwhile to consider the manip-
ulation of a bond graph into a form in which an implicit ﬁeld is obvious. An
exception to this general rule occurs when, in the course of assigning causal-
ity, it is found that one or more elements must be assigned derivative causality.
Often this occurrence signals the presence of an implicit ﬁeld that can usefully
be converted into explicit form, thus simplifying further equation formulation.
Of course, the methods of equation formulation presented in Chapter 5 for the
cases involving derivative causality permit equation formulation without identi-
fying ﬁelds. Although there is no less labor involved in converting an implicit
ﬁeld with derivative causality into explicit form, as we do here, this process may
increase one’s insight into the causes and nature of derivative causality. Also, the
explicit-ﬁeld representation can be used repeatedly, thus avoiding the necessity
of handling derivative causality in each system of which the ﬁeld is a part.
As an example, consider the electrical subsystem shown in Figure 7.7a. The
bond graph of Figure 7.7b does not appear to have any unusual characteristics,
but a little experimentation with causal assignments will show that the three
—C elements cannot all have integral causality. What this means is that the
three displacements—in this case, three electrical charge variables—cannot be

ENERGY-STORING FIELDS
337
independent. In Figure 7.7c, the C-ﬁeld is singled out for study. In this form,
the charges q2 and q6, for example, can play the roles of state variables, and the
charge q4 will be statically related to q2 and q6. Let us now ﬁnd the explicit-ﬁeld
representation shown in Figure 7.7d, in which the charge variables q1 and q7
will play the roles of state variables.
Reading the graph of Figure 7.7c, we ﬁnd that the port output variables, e1 and
e7, can be expressed in terms of the state variables, q2 and q6 (for simplicity, we
assume all the —C elements are linear, although our operations could be carried
out for nonlinear —C elements as well):
e1 = e2 = q2
C2
,
e7 = e6 = q6
C6
.
(7.31)
The state equations may be used to relate q2 and q6 and q7:
˙q2 = f1 −f3 = f1 −f4 = f1 −d
dtq4
= f1 −d
dtC4e4 = f1 −d
dtC4(e3 + e5)
= f1 −d
dtC4(e2 + e6) = f1 −d
dtC4
 q2
C2
+ q6
C6

.
(7.32)
Similarly,
˙q6 = f7 −d
dtC4
 q2
C2
+ q6
C6

.
(7.33)
These equations may be rearranged in matrix form:

(C2 + C4)/C2
C4/C6
C4/C2
(C6 + C4)/C6
 
 ˙q2
˙q6

=

f1
f7

.
(7.34)
Basically, we wish to integrate Eq. (7.34) in order to relate q2 and q6 to
q1 and q7, but, because of the differential causality, a matrix inversion will be
required. The result is

 ˙q2
˙q6

=
1
C2C4 + C2C6 + C4C6

C2C6 + C2C4
C2C4
−C4C6
C2C6 + C4C6
 
 ˙q1
˙q7

,
(7.35)
where ˙q1 = f1, ˙q7 = f7.
Since Eq. (7.35) is a relation between derivatives of charge variables, it can
be integrated in time to yield the desired relations between the charges. Again,
one must consider the charges at some initial time in order to evaluate integration

338
MULTIPORT FIELDS AND JUNCTION STRUCTURES
FIGURE 7.7. System containing an implicit C-ﬁeld: (a) section of an electrical network;
(b) bond graph; (c) implicit ﬁeld identiﬁed; (d) explicit-ﬁeld representation; (e) bond
graph of (a) using explicit-ﬁeld representation.
constants. If the system is assembled out of initially uncharged capacitors, then
q2, q6, q1, and q7 can all vanish initially and the integration constants also vanish.
Then Eq. (7.35) can be integrated by simply removing the dots over the qs. When
this is done, a substitution into Eq. (7.31) yields the explicit-ﬁeld equations:

e1
e7

=
1
C2C4 + C2C6 + C4C6

C6 + C4
−C4
−C4
C2 + C4
 
q1
q7

.
(7.36)
This relation is the constitutive law for the 2-port C-ﬁeld of Figure 7.7d in
integral causality form. Note that we have arranged an inward sign convention
for the C-ﬁeld. This means that Eq. (7.36) should have a symmetric matrix, and
it does. Now, the explicit-ﬁeld representation, which does not have derivative
causality problems, can be used in the original system, as shown in Figure 7.7e.
The same ﬁeld might appear in many systems, and the explicit representation
would eliminate the need to perform algebraic manipulations associated with
derivative causality in each system.

ENERGY-STORING FIELDS
339
Finally, it should be mentioned that it is sometimes convenient to reduce
implicit ﬁelds to an explicit form, regardless of whether or not derivative causality
is involved. Figure 7.8 shows two examples in which 1-ports, 2-ports, and 3-ports
are connected and form implicit ﬁelds. In Figure 7.8a, the presence of the ﬁeld
is signaled by the derivative causality required on one of the —C elements. In
Figure 7.8b, no derivative causality is required, but by deﬁning an explicit ﬁeld,
one can reduce the number of state variables required.
Reading the bond graph of Figure 7.8a, one ﬁnds
F4 = F2 = a
bF1 = a
bk1X1.
˙X1 = a
bV2 = a
b(V4 −V3) = a
b

V4 −d
dt
F3
k3

= a
b

V4 −d
dt
F2
k3

= a
b

V4 −d
dt
a
b
F1
k3

= a
b

V4 −d
dt
a
b
k1X1
k3

(7.37)
or
˙X1 =
b2k3
a2k1 + b2k3
a
b V4
FIGURE 7.8. Two implicit ﬁelds: (a) a 1-port ﬁeld with internal derivative causality;
(b) 1-port ﬁeld without internal derivative causality.

340
MULTIPORT FIELDS AND JUNCTION STRUCTURES
or
X1 =
b2k3
a2k1 + b2k3
a
bX4
(7.38)
assuming that X 1 and X 4 represent deﬂections away from equilibrium. Sub-
stituting Eq. (7.38) into Eq. (7.37), the characteristics of an equivalent 1-port
compliance ﬁeld are found:
F4 =
a2k1k3
a2k1 + b2k3
X4.
(7.39)
The system of Figure 7.8b is easily described, since no derivative causality is
involved:
F4 = F2 + F3 = (a/b)F1 + F3 = (a/b)k1X1 + k3X3.
(7.40)
Two state equations are involved:
˙X1 = (a/b)V2 = (a/b)V4,
(7.41)
˙X3 = V4,
(7.42)
but both equations can be integrated to yield
X1 = (a/b)X4,
X3 = X4,
(7.43)
again assuming that integration constants vanish, that is, that X1 = X3 = X4 = 0
represents the condition when all springs are unstretched. Substituting Eqs. (7.43)
into Eq. (7.40), the equivalent 1-port C-ﬁeld constitutive law is found:
F4 =

(a2/b2)k1 + k3

X4.
(7.44)
Both C-ﬁeld representations (7.39) and (7.44) are practically useful, the ﬁrst
because the algebra associated with different causality is solved once and for
all, and the second because an essentially trivial extra state equation has been
integrated once and for all.
7.1.3
I -Fields
Inertial ﬁelds are just the duals of the capacitive ﬁelds just discussed. Instead
of constitutive laws relating efforts to displacements, inertial elements have con-
stitutive laws relating ﬂows to momenta. All the results for C-ﬁelds will hold
for I -ﬁelds if ﬂows are substituted for efforts and momenta are substituted for
displacements.

ENERGY-STORING FIELDS
341
FIGURE 7.9. The symbol for an n-port I -ﬁeld.
For example, the energy stored in the n-port I -ﬁeld shown in Figure 7.9 is
just
E =
 t
t0
n

i=1
fiei dt
=
 t
t0
n

i=1
fi ˙pi dt
=
 p
p0
n

i=1
fi(p) dpi
=
 p
p0
f(p) dp = E(p),
(7.45)
in which, as in Eq. (7.1), column vectors for the ﬂows and momenta have been
deﬁned:
p ≡
⎡
⎢⎢⎢⎢⎢⎣
p1
p2
p3
...
pn
⎤
⎥⎥⎥⎥⎥⎦
,
f ≡
⎡
⎢⎢⎢⎢⎢⎣
f1(p)
f2(p)
f3(p)
...
fn(p)
⎤
⎥⎥⎥⎥⎥⎦
.
(7.46)
The analogs of Eq. (7.9) are
∂E
∂pi
= fi(p),
i = 1, 2, . . . , n,
(7.47)
and the reciprocity relations are
∂fi
∂pj
=
∂2E
∂pj∂pi
= ∂fi
∂pi
.
(7.48)
Equation (7.48), which is valid for nonlinear ﬁelds, carries the implication for
the linear cases that mass matrices, inductance matrices, and the like must be
symmetric because energy must be conserved.

342
MULTIPORT FIELDS AND JUNCTION STRUCTURES
In common with C-ﬁelds, I -ﬁelds occur in both implicit and explicit forms.
Often the form that an I -ﬁeld takes depends on the system modeler’s point
of view, and it is important to realize that manipulations of ﬁelds may result
in practically useful, simpliﬁed means of representing system components. In
mechanics, for example, the concept of a rigid body implies that elemental masses
are constrained to move in ways such that the distances between them do not
vary. This means that all rigid bodies are I -ﬁelds, and in Chapter 9, the general
means of describing mechanical systems containing rigid bodies will be discussed
in some detail. For now, a single example may sufﬁce to show how an analyst
could construct either an implicit- or an explicit-ﬁeld representation of a rigid
body.
The long, thin, rigid bar of Figure 7.10a has cross-sectional area A, mass
density ρ, and length L. Thus, its total mass m is
m = ρAL,
(7.49)
FIGURE 7.10. I -ﬁeld representation of a rigid body in plane motion: (a) schematic
diagram; (b) implicit ﬁeld using total mass and centroidal moment of inertia; (c) implicit
ﬁeld using differential elements; (d) explicit ﬁeld.

ENERGY-STORING FIELDS
343
and its centroidal moment of inertia J about an axis perpendicular to the long
dimension is
J = mL2
12 .
(7.50)
If we consider plane motion of the bar and allow only vertical motion of
the center of mass and a small angular rotation relative to a horizontal axis,
and if we consider two ports at the end of the bar with forces F 1 and F 2 and
velocities V 1 and V 2, then this rigid body can be described by a linear 2-port
I -ﬁeld.
One way to ﬁnd the constitutive laws for the I -ﬁeld is to describe the motion
ﬁrst in terms of the velocity of the center of mass, V c, and the angular velocity,
ω = ˙θ. The net force on the bar is then the rate of change of the linear momentum,
and the momentum is related to V c by the mass Vc = pc/m). Similarly, the net
torque about the center of mass is the rate of change of the angular momentum,
and the angular momentum is related to ω = ˙θ by the moment of inertia (ω =
pθ/J). In Figure 7.10b, these constitutive laws are represented by the two 1-port
inertial elements. The remainder of the graph serves to relate V 1 and V 2 to V c
and ω, and also to relate the net force and net torque to F 1 and F 2. (The part
of the graph involving 0- and 1-junctions and transformers is a special kind of
junction structure that appears frequently in mechanics and will be discussed
further in Chapter 9.)
From the bond graph (or the schematic diagram) we may now write the output
equations:
V1 = Vc −(L/2)ω = (1/m)pc −(L/2J)pθ,
(7.51)
V2 = Vc −(L/2)ω = (1/m)pc + (L/2J)pθ,
(7.52)
where pc and pθ designate the linear and angular momentum variables, respec-
tively. The state equations are
˙pc = F1 + F2,
(7.53)
˙pθ = −(L/2)F1 + (L/2)F2.
(7.54)
In order to have an explicit ﬁeld at the external ports, these equations must
be integrated in time. If pc and pθ (and, hence, V c and ω) vanish at the initial
time in the integration, then the possible integration constants vanish, and the
results are
pc = p1 + p2,
(7.55)
pθ = −(L/2)p1 + (L/2)p2.
(7.56)

344
MULTIPORT FIELDS AND JUNCTION STRUCTURES
Substituting Eqs. (7.55) and (7.56) into Eqs. (7.51) and (7.52), the result is an
explicit I -ﬁeld constitutive law:

V1
V2

=

(1/m) + (L2/4J) (1/m) + (L2/4J)
(1/m) + (L2/4J) (1/m) + (L2/4J)
 
p1
p2

.
(7.57)
A different, more fundamental, but less convenient approach to this problem
will generate an explicit I -ﬁeld representation directly. We consider the bar to
be a rigid massless rod on which are attached an inﬁnite number of masses of
value ρA dx at the generic position x. The velocity V x of such a mass is
Vx = L −x
L
V1 + x
LV2.
(7.58)
The bond graph of Figure 7.10c shows how these elemental masses are related
to the external ports. Since the forces F 1 and F 2 are the sums of forces generated
by the elemental masses, the derivative causality shown is convenient. Reading
the bond graph, we have F 1 and F 2 expressed as the sum (integral) of the
components due to the elemental masses:
F1 =
 L
0
L −x
L
d
dt[(ρA dx)V x] =
 L
0
ρAL −x
L
L −x
L
˙V1 + x
L
˙V2

dx, (7.59)
F2 =
 L
0
x
L
d
dt[(ρA dx)V x] =
 L
0
ρA x
L
L −x
L
˙V1 + x
L
˙V2

dx,
(7.60)
where Eq. (7.58) has been used. The result of the integration in x is

F1
F2

=

 ˙p1
˙p2

= ρAL
6

2 1
1 2
 
 ˙V1
˙V2

,
(7.61)
or, if we agree to deﬁne velocities such that p1 and p2 vanish when V 1 and V 2
vanish, then

p1
p2

= ρAL
6

2 1
1 2
 
V1
V2

.
(7.62)
This is the constitutive law for the explicit ﬁeld of Figure 7.10d in derivative
causality (or mass matrix) form. It is left as an exercise for the reader to show
that, using Eqs. (7.49) and (7.50), the constitutive laws of Eqs. (7.57) and (7.62)
are the same except for the different causality.
Electrical circuits containing mutually interacting coils can be conveniently
represented using explicit I -ﬁelds. In order to write the constitutive laws for
such ﬁelds, one requires not only a sign convention for currents and voltages,

ENERGY-STORING FIELDS
345
FIGURE 7.11. Mutual inductance in electrical systems: (a,b) 2-port I -ﬁelds with differ-
ent coil orientation; (c) 3-port I -ﬁeld.
but also a convention dealing with the relative orientation of the coils. One such
convention is shown in the circuit diagrams of Figure 7.11a and b as dots placed
near the ends of the coils. The idea is that if the currents, i 1 and i 2, are deﬁned
so that when positive, they both enter or both leave dotted ends of their coils,
then the mutual-inductance effects will be positive. If, on the other hand, the
dots are placed as in Figure 7.11b, so that one of the currents enters through a
dotted end and the other leaves through a dotted end, then the mutual-inductance
effects are negative. The convention is most readily illustrated for the linear case,
but it applies equally well for the nonlinear case. For example, if one denotes
self-inductance coefﬁcients by the letter L and mutual-inductance coefﬁcients by
the letter M , as is the usual convention, then the system of Figure 7.11a has the
constitutive law

λ1
λ2

=

L1
M12
M12
L2
 
i1
i2

.
(7.63)
Note that this ﬁeld representation is in derivative causality form and is sym-
metric, as it must be. The ﬁeld of Figure 7.11b has the constitutive law

λ1
λ2

=

L1
−M12
−M12
L2
 
i1
i2

.
(7.64)

346
MULTIPORT FIELDS AND JUNCTION STRUCTURES
For three or more interacting coils, it is rather awkward to show the orien-
tations. In Figure 7.11c, the dots have become circles, squares, and triangles to
indicate the signs of the three mutual-inductance coefﬁcients. The ﬁeld laws are
readily written:
⎡
⎢⎣
λ1
λ2
λ3
⎤
⎥⎦=
⎡
⎢⎣
+L1
−M12 −M13
−M12
+L2
+M23
−M13 +M23
+L3
⎤
⎥⎦
⎡
⎢⎣
i1
i2
i3
⎤
⎥⎦.
(7.65)
In the bond graph I -ﬁeld representation, the convention indicated by the cir-
cles, squares, and triangles is evident in the sign pattern of the mutual-inductance
coefﬁcients. Note that with the inward sign convention shown, the self-inductance
terms must be positive for physical coils. Also, independently of the coil orien-
tation convention, the inductance matrix and its inverse will be symmetric if the
I -ﬁeld is conservative.
When energy-storing ﬁelds are used in systems, it sometimes happens that
explicit representations such as Eq. (7.65) must be algebraically manipulated. For
example, if the coils of Figure 7.11c are interconnected, as shown in Figure 7.12a,
then the rules of causality indicate that integral causality cannot be applied to all
three I -ﬁeld ports. If there were no mutual inductance, the system would be as
shown in Figure 7.12b. This system has one element in differential causality, but
FIGURE 7.12. A network of interacting coils: (a) the coils of Figure 7.11 interconnected;
(b) system bond graph if mutual inductance is absent; (c) system bond graph with I -ﬁeld.

ENERGY-STORING FIELDS
347
the formulation methods of Chapter 5 would handle the system without trouble.
In fact, this system is just the dual of the C-ﬁeld of Figure 7.7. On the other hand,
when mutual-inductance effects are considered, the system appears as shown in
Figure 7.12c. If one assigns integral causality on bonds 1 and 3, then bond 2
must have derivative causality.
It is not particularly difﬁcult to switch the constitutive law of Eq. (7.65)
into the mixed causal form of Figure 7.12c. Rewriting parts of Eq. (7.65),
we have

 λ1
λ3

=

L1
−M13
−M13
L3
 
i1
i3

+

−M12
M23

[i2].
(7.66)
Inverting this relation to yield i1 and i3 in terms of λ1, λ3, and i2 gives

i2
i3

=
1
L1L3 −M2
13

L3
M13 L3M12 −M13M23
M13
L1
M13M12 −L1M23
 ⎡
⎣
λ1
λ3
i2
⎤
⎦.
(7.67)
Substituting Eq. (7.67) into the second equation of (7.65), we can also obtain
the third equations for λ2 in terms of λ1, λ3, and i2:
λ2 ≡λ2 (λ1, λ2, i2) .
(7.68)
When mutual-inductance effects are present, the writing of state equations
is not quite as straightforward as when there is no mutual inductance. Basi-
cally, this is because of the role of i 2 in Eq. (7.67). We start with the equation
for λ1,
˙λ1 = e4 −e2 = e4 −d
dtλ2(λ1, λ3, i2).
(7.69)
Now,
i2 = i1 + i3,
(7.70)
and we can use Eq. (7.67) to ﬁnd i 1 and i 3 (and hence i 2) in terms of λ1, λ3,
and i2. But now we are in an algebraic loop reminiscent of those discussed
Chapter 5 when the imposition of integral causality did not sufﬁce to determine
the causality of all bonds. Using Eqs. (7.70) and (7.67), we can express i 2 in
terms of itself and then solve this algebraic equation for i 2 in terms of λ1, λ3
in order to compute the state equation (7.69). Failure to do this will result in an
endless looping through the equations in an attempt to eliminate zi 2.
Although one could write state equations for the system in the manner out-
lined above, there is a simpler way to handle the system. In Figure 7.13, it
is shown that the imposition of complete differential causality (which corre-
sponds to Eq. (7.65) anyway) allows one to compute the explicit 2-port ﬁeld

348
MULTIPORT FIELDS AND JUNCTION STRUCTURES
FIGURE 7.13. Reduction of the system of Figure 7.12 to explicit 2-port I -ﬁeld form.
without solving any algebraic equations. Reading the graph, and using Eq. (7.65),
we have
e4 = e1 + e2 = d
dt(λ1 + λ2)
= d
dt[(L1 −M12)i1 + (L2 −M12)i2 + (M23 −M13)i3]
= d
dt[(L1 −M12)i4 + (L2 −M12)(i4 + i5) + (M23 −M13)i5],
or
λ4 = (L1 + L2 −2M12)i4 + (L2 −M12 −M13 + M23)i5
(7.71)
upon integration. Similarly,
λ5 = (L2 −M12 −M13 + M23)i4 + (L2 + L3 + 2M23)i5.
(7.72)
These equations represent the constitutive laws for the 2-port I -ﬁeld in
derivative causality form. The all-integral-causality form follows by inverting
the equations. Thus, λ4 and λ5 can readily be used as the two independent
state variables. Clearly, the 2-port I -ﬁeld is much more convenient to use in
equation formulation than the 3-port ﬁeld and its associated junction structure.
Such studies of ﬁelds are, of course, as useful for C-ﬁeld problems as they are
for I -ﬁelds.
7.1.4
Mixed Energy-Storing Fields
There are occasions when an energy-storing device cannot be described as a C-
ﬁeld or an I -ﬁeld but rather acts as a C-ﬁeld at some ports and an I -ﬁeld at others.
Within a single-energy domain, the need for such an element is far from evident,
but when transducers are studied in Chapter 8, it will be seen that many trans-
ducers are essentially energy conservative but are not pure I -ﬁelds or C-ﬁelds.
Even in the case of transducers, it has been a common practice to arrange the
analogies between variables in the two energy domains linked by the transducer
in such a way that the transducer is a pure ﬁeld. There is no real need to do this,

ENERGY-STORING FIELDS
349
however, and in bond graphs we prefer to retain our identiﬁcation of effort, ﬂow,
displacement, and momentum quantities for all energy domains. We need, then,
to discuss what will be called IC-ﬁelds. Not only is this policy just as convenient
as the policy of switching analogies to suit the problem at hand; it is required in
principle for some systems. There is no way, for example, to pick an effort–ﬂow
identiﬁcation for an electromechanical system containing both a movable-plate
capacitor and a solenoid transducer such that both transducers would be described
as pure I - or C-ﬁelds.
Figure 7.14 shows the general n-port IC-ﬁeld. The ports are numbered so that
the ﬁrst j-ports (1 ≤j ≤n) are inertial in character and the ports from j + 1 to
n are capacitive in character. In integral causality form as shown, the ﬁrst j state
variables are momenta and the remainder are displacements. The stored energy,
E, is a function of this mixed set of state variables:
E =
 t
n

i=1
eifi dt =
 p
j

i=1
fi dpi +
 q
n

k=j+1
ek dqk,
(7.73)
where p represents the vector of momenta and q represents the vector of dis-
placements. From Eq. (7.73), we see that
fi = ∂E
∂Pi
,
i = 1, 2, . . . , j,
(7.74)
ek = ∂E
∂pk
,
k = j + 1, j + 2, . . . , n.
(7.75)
The reciprocity conditions for the constitutive laws can be easily derived
by computing second partial derivatives of E. For example, the second partial
derivatives of E with respect to a momentum from the ﬁrst set of ports and a
displacement from the second set of ports yields
∂fi
∂qk
=
∂2E
∂qk∂pi
= ek
∂pi
,
(7.76)
where 1 ≤i ≤j, j + 1 ≤k ≤n. These results should be compared with the
results for pure C-ﬁelds and I -ﬁelds (Eqs. (7.1), (7.10), (7.45), and (7.46)).
Physical examples involving IC-ﬁelds will be found in Chapter 8.
FIGURE 7.14. The general mixed energy-storage ﬁeld.

350
MULTIPORT FIELDS AND JUNCTION STRUCTURES
7.2
RESISTIVE FIELDS
An R-ﬁeld is an n-port, the constitutive laws of which relate the n-port efforts
and the n-port ﬂows by means of static (or algebraic) functions. This deﬁnition
includes power-conservative elements such as 0- and 1-junctions and elements
containing sources as R-ﬁelds, but in practice most R-ﬁelds studied dissipate
power. Both explicit and implicit R-ﬁelds exist. Explicit multiport R-ﬁelds arise
frequently in modeling nonlinear devices. Implicit ﬁelds arising from the inter-
connection of 1-port resistances, transformers, gyrators, and junction 3-ports may
be conveniently represented in R-ﬁeld form as relations between external port
efforts and ﬂows.
The causality for R-ﬁelds usually is determined by the source and energy-
storing elements in the system. Two fundamental causal patterns are shown
in Figure 7.15. The constitutive laws for the resistance causality shown in
Figure 7.15a may be written
ei = Ri(f1, f2, . . . , fn),
i = 1, 2, . . . , n.
(7.77)
The conductance causality shown in Figure 7.15b has constitutive laws that
may be represented by the following:
fi = −1
Ri (e1, e2, . . . , en),
i = 1, 2, . . . , n.
(7.78)
In addition to these two fundamental causal forms, a large number of other
forms are possible in which some of the bonds are causally oriented as in
Figure 7.15a and the remainder are oriented as in Figure 7.15b. Although
R-ﬁelds are basically neutral with respect to causality, we shall encounter some
constitutive laws for R-ﬁelds that cannot be unique for certain causalities (this
happens, of course, only in the nonlinear case).
Although there is no stored energy function for R-ﬁelds as there is for energy-
storing ﬁelds, and hence there is no simple way to show that R-ﬁeld constitutive
laws are constrained, still, for special classes of R-ﬁelds, some useful properties
of the constitutive laws may be found. We will illustrate some of these properties
by example.
First, let us consider linear R-ﬁelds which contain no sources and no gyrators.
A typical example is shown in Figure 7.16. This R-ﬁeld will accept resistance
FIGURE 7.15. The general R-ﬁeld: (a) resistance form; (b) conductance form.

RESISTIVE FIELDS
351
FIGURE 7.16. An implicit R-ﬁeld: (a) circuit graph; (b) bond graph showing resistance
causality; (c) bond graph showing conductance causality; (d) bond graph showing mixed
causality.
causality on the three external ports, as shown in Figure 7.16b. Reading the bond
graph, the constitutive laws are readily derived:
⎡
⎢⎣
e1
e2
e3
⎤
⎥⎦=
⎡
⎢⎣
R4
R4
0
R4 R4 + R5 + R6 R6
0
R6
R6
⎤
⎥⎦
⎡
⎢⎣
f1
f2
f3
⎤
⎥⎦.
(7.79)
As the bond graph of Figure 7.16c demonstrates, this R-ﬁeld will also accept
conductance causality. So, by inverting Eq. (7.79) or, more simply, by reading
the bond graph of Figure 7.16c, the constitutive laws in conductance form may
be found:
⎡
⎢⎣
f1
f2
f3
⎤
⎥⎦=
⎡
⎢⎣
1/R4 + 1/R5 −1/R5
1/R5
−1/R5
1/R5
−1/R5
1/R5
−1/R5 1/R5 + 1/R6
⎤
⎥⎦
⎡
⎢⎣
e1
e2
e3
⎤
⎥⎦.
(7.80)
Notice that both Eqs. (7.79) and (7.80) are symmetric. These forms may be
called Onsager forms in analogy to the well-known Onsager reciprocal relations
of irreversible thermodynamics [3]. Onsager proposed his reciprocity conditions
for variables called “afﬁnities” and “ﬂuxes” that are analogous to the efforts and

352
MULTIPORT FIELDS AND JUNCTION STRUCTURES
ﬂows of bond graphs. In general, implicit R-ﬁelds composed of linear 1-port
resistances, 0- and 1-junctions, and transformers will obey Onsager reciprocity;
that is, when expressed in resistance or conductance form, the matrix in the consti-
tutive laws will be symmetric. On the other hand, for mixed causality, the matrix
will have antisymmetrical terms, and if gyrators are present, the Onsager reci-
procity relations do not hold. Thus, the reciprocity of energy-storing ﬁelds, which
may be called Maxwell reciprocity, is more general than Onsager reciprocity. A
perfectly reasonable explicit R-ﬁeld characterization expressed in resistance or
conductance form can be unsymmetrical. One may think of the unsymmetrical
part of the matrices as arising from gyrational effects that introduce antisym-
metrical terms, although in an explicit ﬁeld one cannot identify a gyrator unless
one can ﬁnd some implicit ﬁeld that has the same port constitutive laws as the
explicit ﬁeld.
Using our example, let us ﬁrst show that an R-ﬁeld in mixed causality has
antisymmetric terms. A possible mixed causal pattern is shown in Figure 7.16d.
Reading the bond graph, the constitutive laws are as follows:
⎡
⎢⎣
f1
e2
f3
⎤
⎥⎦=
⎡
⎢⎣
1/R4 −1
0
1
R5
1
0
−1 1/R6
⎤
⎥⎦
⎡
⎢⎣
e1
f2
e3
⎤
⎥⎦,
(7.81)
in which the antisymmetric terms are evident. Such a form, which results when
some of the input and output variables are interchanged for an R-ﬁeld that obeys
the Onsager reciprocal relations in resistance or conductance causality, is some-
times called a Casimir form [4].
It may be tempting to conclude that if R-ﬁelds are described with either resis-
tance or conductance causality, they will exhibit Onsager reciprocity, and if they
are described with a mixed causality, they will show a Casimir form. But it is
easy to show that if gyrators are allowed in an implicit R-ﬁeld, then this conclu-
sion is false. Consider, for example, the R-ﬁeld of Figure 7.17, which is formed
from the ﬁeld of Figure 7.16 by adding a single gyrator. In the conductance
causality shown in Figure 7.17a, the ﬁeld exhibits a Casimir form rather than an
Onsager form:
⎡
⎢⎣
f1
f2
f3
⎤
⎥⎦=
⎡
⎢⎣
1/R4 −1/r
0
1/r
R5/r2
1/r
0
−1/r 1/R6
⎤
⎥⎦
⎡
⎢⎣
e1
e2
e3
⎤
⎥⎦,
(7.82)
in which r is the gyrator parameter. Similarly, for the mixed causality of
Figure 7.17b, the R-ﬁeld is symmetric:
⎡
⎢⎣
f1
e2
f3
⎤
⎥⎦=
⎡
⎢⎣
1/R4 + 1/R5 −r/R5
1/R5
−r/R5
r2/R5
−r/R5
1/R5
−r/R5 1/R5 + 1/R6
⎤
⎥⎦
⎡
⎢⎣
e1
f2
e3
⎤
⎥⎦.
(7.83)

RESISTIVE FIELDS
353
FIGURE 7.17. Modiﬁed version of the R-ﬁeld of Figure 7.15: (a) conductance causality;
(b) mixed causality.
A general R-ﬁeld is not necessarily representable in either an Onsager or a
Casimir form. A simple example is shown in Figure 7.18. Its constitutive laws
in resistance form are

e1
e2

=

R3 + R4
r + R4
−r + R4 R4 + R5
 
f1
f2

,
(7.84)
in which a symmetrical part due to the elements that obey Onsager reciprocity
and an antisymmetrical part due to the gyrator can be recognized. If Eq. (7.84)
were presented with numerical values for the parameters, it would have a rather
undistinguished appearance, being neither an Onsager nor a Casimir form, i.e.,
neither symmetric nor having antisymmetric terms.
Note that if positive resistance parameters are used, then all of the example
ﬁelds will dissipate power for any possible port conditions. This is true because
the 1-port resistors can only dissipate power, and the junction elements and
the 2-ports, —TF— and —GY —, conserve power. A way to check for power
FIGURE 7.18. An R-ﬁeld containing a gyrator.

354
MULTIPORT FIELDS AND JUNCTION STRUCTURES
dissipation given an explicit linear ﬁeld is to check whether the matrix of
coefﬁcients is positive deﬁnite or not. In the resistance form, for example, if e is
the column vector of efforts, f the column vector of ﬂows, and R the resistance
matrix, then the power P is
P = f te,
and the constitutive law for the ﬁeld is
e = Rf,
so that
P = f tRf,
(7.85)
where t stands for the transpose of a vector or matrix.
Equation (7.85) shows that power will be dissipated for any f if R is positive
deﬁnite. If one can only say that no power should be created, then R must be
positive semideﬁnite; that is, there may be some ﬁnite ﬂows for which zero power
is dissipated. Using the rules for checking a matrix for positive deﬁniteness,
the reader may demonstrate that all the examples of R-ﬁelds given above are
at least positive semideﬁnite. In this regard, it is useful to remember that the
antisymmetric part of any matrix contributes nothing to the deﬁniteness of the
matrix. This correlates with the idea that the antisymmetric terms due to the
presence of a gyrator represent no power generation or dissipation in a ﬁeld such
as that associated with Eq. (7.84).
7.3
MODULATED 2-PORT ELEMENTS
The 2-port elements —TF— and —GY — are linear, power-conserving elements,
the usefulness of which has been demonstrated in previous chapters. Here we
discuss the modulated transformer, —MTF—, and modulated gyrator, —MGY —,
which are nonlinear, power-conserving generalizations of —TF— and —GY —.
Basically, the parameters of the elements —TF— and —GY — are allowed to
be a function of some parameter, say ξ, in the modulated 2-ports. The usual
symbols and constitutive laws or these elements are shown below:
m(ξ)
↓
⇀
1 MTF ⇀
2 ,
m(ξ)e1 = e2,
f1 = m(ξ)f2,
r(ξ)
↓
⇀
1 MGY ⇀
2 ,
e1 = r(ξ)f2,
r(ξ)f1 = e2.
(7.86)
Notice that for both elements the power e1f1 is always equal to the power
e2f2 no matter what the value of m(ξ) or r(ξ) may be. Also, the parameters m

MODULATED 2-PORT ELEMENTS
355
and r are shown as changing by means of a signal or active bond rather than by
means of a power bond. Thus, it is characteristic of these modulated-parameter
elements that the parameters change value without a directly associated power
ﬂow.
The modulated elements will prove useful for modeling certain classes of sys-
tems in Chapters 8 and 9. In Figure 7.19, two examples are shown that illustrate
typical uses of the modulated elements. The modulated transformer is particularly
useful in describing mechanical systems moving though large angles. The rigid,
pivoted bar of Figure 7.19a may be described thus:
τ = (l cos θ)F,
(7.87)
(l cos θ)ω = V,
(7.88)
where the variables are deﬁned in the ﬁgure.
These constitutive relations may be derived by applying the laws of
mechanics to the linkage. Equation (7.87) is a torque equilibrium statement, and
FIGURE 7.19. Examples of modulated 2-port elements: (a) mechanical linkage; (b)
modulated transformer for (a); (c) electromechanical system; (d) modulated gyrator for
(c). Note that the modulus for (b) is deﬁned unambiguously by Eqs. (7.87) and (7.88).

356
MULTIPORT FIELDS AND JUNCTION STRUCTURES
Eq. (7.88) is an angular velocity–velocity relation which could be derived by
time-differentiating the equation
l sin θ = x.
(7.89)
The bond graph of Figure 7.19b represents Eqs. (7.87) and (7.88), where the
transformer modulus is l cos θ and θ plays the role of ξ in the general equations
(7.86). It is a peculiarity of the MTFs of mechanics that the modulus varies with
the displacements at the ports. For this reason, these MTFs are sometimes called
displacement-modulated transformers.
Figure 7.19c shows an electromechanical system in which a ﬁeld current
i f is responsible for establishing a magnetic ﬁeld B(if ) in a gap. If then a
current-carrying conductor of length l moves with velocity V , as shown, it is a
consequence of Faraday’s law that a voltage e will be induced along the conductor
according to the following relation:
e = B(if )lV.
(7.90)
The force F required to move the conductor is found from the Lorentz force
law to be
B(if )li = F.
(7.91)
The modulated gyrator of Figure 7.19d represents these laws, with B(if )l
representing the modulus r and i f the parameter ξ in the general form of Eq.
(7.86). Note that ei = FV (as long as the electrical and the mechanical power are
measured in the same units), and i f can be changed with no power associated with
the MGY . On the other hand, i f is also associated with a self-inductance effect
and coil resistance, so that there is power ﬂow and energy storage associated with
i f . The point is that no energy is associated with changes in Bl from the point of
view of the MGY . The modulated gyrator will be used in modeling voice coils,
electrical motors, and similar devices in Chapter 8.
Since the sign conventions and causal restrictions for the modulated elements
are the same as for the —TF— and —GY — elements studied earlier, there is
little new to be said here. A few words of caution are in order, however. Since
the modulated elements incorporate a pure signal interaction, it is quite possible
to construct bond graphs that do not have physical interpretations by imagining
that the modulus of a transformer or gyrator can be a function of any variable
at all. Just as it is easy to make incorrect block diagrams, signal ﬂow graphs,
or other signal descriptions that violate power and energy constraints that exist
in real physical systems, so too is it rather easy to assume that an element can
be modeled using a modulated 2-port when, in fact, the element may really be
a true 3-port or when the physical system may not allow the modulus to be a
function of the signal assumed.
To show just one example of the trap into which one may sometimes fall,
consider the rack-and-pinion system shown in Figure 7.20. Clearly, if the pin-
ion is small (r << l), then the rack is nearly a lever with a lever ratio of

JUNCTION STRUCTURES
357
FIGURE 7.20. Rack-and-pinion system: (a) schematic diagram; (b) incorrect bond graph;
(c) correct bond graph.
(l/2 −rθ)/(l/2 + rθ) if the rack is centered when θ = 0. Furthermore, if we
rotate the pinion to some position and then hold θ ﬁxed, the rack will function
almost as a —TF— with the transformer modulus set by the value of θ. Thus,
it seems reasonable to represent the system as in Figure 7.20b. However, this
representation is false. The reason is that, whenever F 1 and F 2 are not zero, θ
cannot be changed with no power. In fact, the torque τ is proportional to F 1
or F 2. Thus, the device is a true 3-port as shown in Figure 7.20c. It can be
modeled using MTF elements and 0- and 1-junctions as a multiport—modulated
transformer, as will be shown in Chapter 9, but the representation of Figure 7.20b
is fundamentally incorrect.
7.4
JUNCTION STRUCTURES
Junction structures, which are assemblages of 0- and 1-junctions, transformers,
and gyrators, are the energy switchyards that enforce the constraints among parts
of dynamic systems. No power is dissipated or generated in a junction structure,

358
MULTIPORT FIELDS AND JUNCTION STRUCTURES
so the net power into a junction structure at its ports always vanishes. Since
junction structures do provide relations between efforts and ﬂows at their ports,
they are special types of R-ﬁelds that never dissipate power. One might expect,
for linear junction structures, to ﬁnd the Onsager and Casimir forms that were
found for general R-ﬁelds. These forms are indeed found, but junction structures
typically cannot accept all possible causal assignments at their ports, so some
forms for the constitutive laws simply cannot exist.
Some example junction structures are shown in Figure 7.21. Note that all these
structures are shown with an inward sign convention, so that the sum of the port
powers must vanish. This means that, in each case, the matrix relating inputs to
outputs must be antisymmetric; that is, zeros must appear on the main diagonal,
and the ijth component must be the negative of the jith component.
For systems without gyrators and in mixed resistance–conductance causality,
such as Figures 7.21a, c, and d, the relations are Casimir forms (but with zeros
on the main diagonal). The system of Figure 7.20b is in conductance form but,
because it contains a gyrator, does not obey Onsager reciprocity and is instead
antireciprocal. Figure 7.21e is antisymmetric partly because of mixed causality
(which contributes two antisymmetric terms) and partly because of the gyrator
(which contributes the other two).
FIGURE 7.21. Constitutive laws for some simple junction structures.

MULTIPORT TRANSFORMERS
359
Since an R-ﬁeld that contains no gyrators must obey Onsager reciprocity in
resistance or conductance form, and any junction structure must have antisym-
metric constitutive laws, we conclude that junction structures without gyrators
cannot accept resistance or conductance causality on all ports.
7.5
MULTIPORT TRANSFORMERS
Another interesting viewpoint about junction structures involves the transforma-
tions of variables that they provide. Consider, for example, the junction struc-
ture of Figure 7.22. It transforms the variables e3 and e4 into the variables
e1 and e2:

e1
e2

=

−1
−1
−m1 −m2
 
e3
e4

.
(7.92)
But this transformation of efforts is accompanied by a transformation of ﬂows:

f3
f4

=

1 m1
1 m2
 
f1
f2

,
(7.93)
and, since the junction structure is accomplishing the transformations, the trans-
formations must conserve power. Rearranging the equations, the antisymmetric
form characteristic of power conservation appears:
⎡
⎢⎢⎢⎢⎣
e1
e2
f3
f4
⎤
⎥⎥⎥⎥⎦
=
⎡
⎢⎢⎢⎢⎣
0
0
−1
−1
0
0
−m1 −m2
1 m1
0
0
1 m2
0
0
⎤
⎥⎥⎥⎥⎦
⎡
⎢⎢⎢⎢⎣
f1
f2
e3
e3
⎤
⎥⎥⎥⎥⎦
.
(7.94)
Such a structure is usefully considered to be a multiport generalization of a
2-port transformer. It is appropriate to change from an “all inward” sign conven-
tion which has been used in studying general junction structures to a “through”
sign convention for the external ports, as shown in Figure 7.23. With this type of
FIGURE 7.22. A junction structure that is a 2 × 2 bilateral transformation of variables.

360
MULTIPORT FIELDS AND JUNCTION STRUCTURES
1
0
1
1
2
3
4
3
1
0
2
4
TF
m2
TF
:
m1
TF
:
=
FIGURE 7.23. Structure of Figure 7.22 with modiﬁed sign half-arrows at ports 1 and 2.
sign convention, the signs in Eq. (7.92) change and the transformation equations
can be written in a form analogous to the form used for 2-port transformers:

e1
e2

=

1
1
m1 m2
 
e3
e4

,
(7.92a)

1 m1
1 m2
 
f1
f2

=

f3
f4

.
(7.93a)
In this example, it may be seen that the matrix that relates the efforts is simply
transposed to form the matrix that transforms the ﬂows. In general, a multiport
transformer is characterized by a matrix (and its transpose), just as a 2-port
transformer is characterized by a modulus that appears in both the effort and the
ﬂow relations. (One can even think of the modulus of a 2-port TF as a 1 × 1
matrix which is equal to its transpose.)
Although this example involves a 2 × 2 matrix since there are two ports on
either side of the transformer, there can be n ports on one side of the transformer
and m ports on the other side. Then the matrix will be n × m and its transpose
will be m × n.
It is easy to prove that transformations involving a matrix and its transpose
imply that power ﬂowing into one side of a multiport transformer must equal the
power ﬂowing out of the other side [7]. Let [e1], [f 1] be column vectors of efforts
and ﬂows on one side of a multiport transformer and [e2], [f 2] be vectors of efforts
and ﬂows on the other side. Then let [M ] be a transformation matrix of appropri-
ate dimensions so that the equations analogous to Eqs. (7.92a) and (7.93a) are
[e1] = [M] [e2] ,
(7.95)

Mt 
f1

=

f2

.
(7.96)
By transposing Eq. (7.96) and postmultiplying both sides by [e2], the result is

f1
t [M] [e2] =

f2
t [e2] ,
(7.97)

MULTIPORT TRANSFORMERS
361
or, upon using Eq. (7.95),

f1
t [e1] =

f2
t [e2] ,
(7.98)
which simply states that the sum of the port powers on the number 1 side equals
the sum of the port powers on the number 2 side. With the new sign convention
this means the net power ﬂowing in on one side equals the power ﬂowing out
of the other side.
It is interesting that in the above proof, not only can there be any number of
ports on the two sides of the transformer, but there is no requirement that the
elements of the matrix be constant. Thus, the considerations apply not only to
multiport transformers with constant matrices, which occur in many types of sys-
tems, but also for multiport-modulated transformers in which the elements of the
matrix change with time. An important application of multiport-modulated trans-
formers is in mechanics, where geometric nonlinearities often arise. This topic is
explored in depth in Chapter 9, but here we merely point out that when geomet-
ric constraints or transformations among displacements are converted to velocity
relations, they always can be represented by multiport-modulated transformers
or transformer junction structures. Furthermore, when the velocity relationships
have been determined and incorporated in a matrix of functions, the transpose of
the matrix will automatically relate the forces.
Consider, for example, the transformation between rectangular coordinates
and polar coordinates, as shown in Figure 7.24. (This will be involved in an
introductory example in Chapter 9.) The relationships between r and θ and x
and y are rather complicated nonlinear functions which can be expressed in
several forms. For example, to convert from r and θ to x and y we can write
x = r cos θ,
y = r sin θ.
(7.99)
The inverse relationship is
r =

x2 + y21/2 ,
θ = tan−1 (y/x) .
(7.100)
r
r
θ
θ
r
x
x
y
y
FIGURE 7.24. Rectangular and polar coordinates.

362
MULTIPORT FIELDS AND JUNCTION STRUCTURES
These displacement relationships can be arbitrarily complicated, but the
corresponding velocity relationships have a particular structure. Starting with
Eq. (7.99), for example, we ﬁnd
dx
dt = ∂x
∂r
dr
dt + ∂x
∂θ
dθ
dt ,
and
dy
dt = ∂y
∂r
dr
dt + ∂y
∂θ
dθ
dt .
(7.101)
Working this out, we ﬁnd a relation among ﬂow variables,

 ˙x
˙y

=

cos θ −r sin θ
sin θ
r cos θ
 
 ˙r
˙θ

.
(7.102)
If this transformation is represented by a modulated multiport transformer,
then we know that the transformation of the corresponding efforts (forces or
torques) must involve the transpose of the matrix in Eq. (7.102):

cos θ
sin θ
−r sin θ r cos θ
 
Fx
Fy

=

Fr
τ

.
(7.103)
The validity of Eq. (7.103) is easily checked by imagining forces F x and
F y acting on the point in Figure 7.24 and then computing the radial force and
the torque exerted by these forces. Note that instead of a representation as a
multiport transformer, as in Figure 7.25, one could create a junction structure
version involving four 2-port MTFs in the manner of Figure 7.23. Because of
the implied causality, the 0- and 1-junctions in Figure 7.23 would interchange
places.
It is not always necessary to derive velocity relationships by differentiating
displacement relations. In this example, one could ﬁnd ˙r and ˙θ by direct consid-
eration of the velocity components sketched in Figure 7.24. The result is

 ˙r
˙θ

=

cos θ
sin θ
−sin θ/r cos θ/r
 
 ˙x
˙y

,
(7.104)
MTF
:
Fx
x
y
Fr
r
τ
θ
Fy
[M(r, θ]
FIGURE 7.25. An MTF representation of the polar-to-rectangular coordinate transfor-
mation.

MULTIPORT TRANSFORMERS
363
which implies

cos θ −sin θ/r
sin θ
cos θ/r
 
Fr
τ

=

Fx
Fy

.
(7.105)
This representation reverses the causality shown in Figure 7.25 and involves
the inverse of the matrices used in Eqs. (7.102) and (7.103). Of course, if this
were not a transformer with equal numbers of ports on both sides, the matrix
would not be square, it would not be possible to reverse causality, and there
would be no inverse matrix.
A ﬁnal example will make some points regarding geometric constraints in
mechanical systems. The rod in Figure 7.26 is rigid and acted upon by three
forces. The force F 3 is perpendicular to the rod and F 1 and F 2 are horizontal
and vertical, respectively. The corresponding velocities are V 1, V 2, and V 3.
Geometrically, there is only a single degree of freedom, so if one velocity is
known, the remaining two can be determined.
The MTF shows that V 1 and V 2 are determined by V 3 and that F 3 is deter-
mined by F 1 and F 2. By consideration of the kinematics of the system, one can
derive the following velocity relations directly:

V1
V2

=

−2 sin θ
2 cos θ

[V3] .
(7.106)
The transpose of the matrix in Eq. (7.106) relates the forces,
[−2 sin θ|2 cos θ]

F1
F2

= [F3] .
(7.107)
The fact that the angle θ appears in the transformer matrices while is not
one of the ﬂows involved points up an interesting aspect of mechanical systems
involving modulated transformers. In principle, the coefﬁcients in the transformer
F3
V3
F2
V2
F1
V1
l/2
Forces
Velocities
MTF
θ
θ
θ
1
2
3
l/2
FIGURE 7.26. A rigid rod with three applied forces.

364
MULTIPORT FIELDS AND JUNCTION STRUCTURES
matrices are functions of displacements associated with ﬂows at the transformer
ports. This is obvious if displacement relations such as Eq. (7.99) are differenti-
ated as shown in Eq. (7.101) to produce equations such as (7.102) and (7.103).
In the present case, θ has been used even though was not a ﬂow of interest. In
this case, θ must be considered to be a state variable just like the p’s and q’s
associated with the I ’s and C’s in the system. This means that the MTF forces
us to write an equation for ˙θ even though there may be no C-element for which
θ would be a state variable. Since V 3 determined all the velocities of the rod, it
also determines ˙θ, so we must only write a separate state equation,
˙θ = V3
l/2,
(7.108)
to complete the system formulation.
Often, C-elements attached to modulated transformers automatically make the
integrals of some port ﬂows into displacement state variables. These displace-
ments are then available for use in computing the variable coefﬁcients in the
transformation matrices. In this example, however, does not appear on any bond
so the extra state equation (7.108) is necessary.
As will become clear in Chapter 9, there are often many ways to describe the
geometrical constraints in complex mechanical systems. Some choices may lead
to straightforward formulations, while others may be nearly intractable. These
difﬁculties are inherent in mechanics and arise whether bond graph methods or
other techniques are used.
REFERENCES
[1] S. H. Crandall and N. C. Dahl, eds., An Introduction to the Mechanics of
Solids, New York: McGraw-Hill, 1959, p. 378.
[2] S. H. Crandall, D. C. Karnopp, E. F. Kurtz, and D. C. Pridmore-
Brown, Dynamics of Mechanical and Electro-mechanical Systems, New York:
McGraw-Hill, 1968, pp. 220, 294, 296.
[3] I. Prigogine, Introduction to the Thermodynamics of Irreversible Processes,
Springﬁeld, IL: C. C. Thomas, 1955.
[4] J. Meixner, “Thermodynamics of electric networks and the Onsager–Casimir
reciprocal relations,” J. Math. Phys., 4, 154 (1963).
[5] G. Kron, Tensor Analysis of Networks, New York: Wiley, 1939.
[6] R. C. Rosenberg, “State space formulation for bond graph models of multiport
systems,” Trans. ASME, J. Dyn. Syst. Meas. Control, 93, Ser. G, No. 1, 35–40
(Mar. 1971).
[7] D. C. Karnopp, “Power-conserving transformations: physical interpretations
and applications using bond graphs,” J. Franklin Inst., 288, No. 3, 175–201
(Sept. 1969).

PROBLEMS
365
PROBLEMS
7-1. Three linear springs are attached to massless carts, as shown. Make a bond
graph for this system, and manipulate the relations for the implicit C-ﬁeld
into the relation for the explicit 1-port C-ﬁeld shown. Assume that when
X = 0, all the springs are relaxed.
7-2. Two linear springs are pin-joined together as shown. Consider small
motions, x and y, and small spring extensions, e1, e2. Show that the
implicit ﬁeld shown represents the system, and ﬁnd the transformer
moduli. Convert to an explicit-ﬁeld form at the x and y ports.
7-3. Three concentrated mass points are mounted on a massless rigid bar.
Consider plane vertical motion such that the bar moves through only
small angles. By expressing the motion of each mass in terms of V1 = ˙X1
and V2 = ˙X2, show that this system may be represented as a 2-port,
implicit I -ﬁeld. Find the constitutive relations for the I -ﬁeld as seen at
the F 1, F 2 ports.

366
MULTIPORT FIELDS AND JUNCTION STRUCTURES
7-4. Three equal pipes carrying an incompressible ﬂuid join at a tee junction.
If each pipe has ﬂuid inertia ρl/A, show an implicit I -ﬁeld representation.
Demonstrate that all three 1-port inertial elements cannot simultaneously
have integral causality. Find a 3-port, explicit I -ﬁeld representation.
7-5. Write the equations of motion for the system shown, assuming the consti-
tutive laws for the transformer are given by Eq. (7.63).
7-6. For the R-ﬁeld shown, show causalities that would result in (a) Onsager
forms, and (b) Casimir forms.
7-7. Construct an implicit R-ﬁeld that is expressible in neither an Onsager nor a
Casimir form, and write out its constitutive laws as was done in Eq. (7.84).
7-8. Prove that if a resistance matrix were antisymmetric (with zeros on the
main diagonal), then the net power dissipated would always be zero,
assuming an inward sign convention on all external bonds.
7-9. Two bond graph representations are shown in (a) and (b) below:
In (a) assume q3 = m1q1 + m2q2 and e3 = C−1
3 (q3), a nonlinear capacitor.
If the representation of (b) is to be valid, and the 2-port C-ﬁeld is energy
conservative, then
∂e1
∂q2
= ∂e2
∂q1
.
Prove that this expression is valid for the system of (a). Extend the proof
to the case in which the TFs in (a) become MTFs and q3 is a general
function of q1 and q2, q3 = q3(q1, q2).

PROBLEMS
367
7-10. Study of some 2-port ﬁelds:
[L] =
=
L11 + rM
L22 + M/r
M
M
Inductance
Matrix
(i)
Draw (a), (b), and (c) as 2-port ﬁelds, and for (a) and (b) show the
ﬁelds in terms of 0, 1, TF, I , C elements.
(ii)
Show that the mass matrix for (a) is

m1 +

ml2
2/l2
m

l1l2/l2
m(l1l2/l2)
m2 +

ml2
1/l2

.
Show that the compliance matrix for (b) is

1/k1 + (1/k)(l2
2/l2
3)
−(1/k)(l1l2/l2
3)
−(1/k)(l1l2/l2
3)
1/k2 + (1/k)(l2
2/l2
3)

.
Compare these results with the inductance matrix for case (c).
(iii)
Show that
for (a):
for (b):
if m1 ≪m, m2 ≪m,
if k1 ≫k, k2 ≫k,
then
then
(l1/l2)p1 = p2,
(l2/l1)x1 = x2,
v1 = (l1/l2)v2 + (l2/ml2
2)p2.
F1 = (l2/l1)F2 + (kl/2
3/l2
1)x1.

368
MULTIPORT FIELDS AND JUNCTION STRUCTURES
for (c):
if L11 ≪M, L22 ≪M,
then
λ1 = rλ2,
ri1 = i2 + λ1/M.
(iv)
Show that for (a) if m →∞, for (b) if k →0, and for (c); if
M →∞, all systems become —TF—.
(v)
Show that saturation of the iron in (c) is analogous to the limiting
of motion by stops in (b), and thus dc voltages will not pass in (c)
and dc velocities will not pass in (b).
7-11. Consider the bond graphs below:
System 1:
System 2:
(a)
If the graphs are not in the standard form for sign conventions, insert
extra 0- or 1-junctions to bring them into the standard form.
(b)
Add causality to the system, and list the state vectors.
7-12. Consider a linear, multiport C-ﬁeld with stiffness matrix K. The constitu-
tive relations are then
e = Kq,
(i)

PROBLEMS
369
where e and q are n-vectors and K is an n × n matrix. The stored energy
E is then
E = 1
2qtKq.
(ii)
The text argues that if energy is conserved, then K in Eq. (i) must be
symmetrical, that is, K = K t.
(a)
Convince yourself that any square matrix may be decomposed into
a symmetrical part and an unsymmetrical part. For example,
K = Kt
s + Ka;
Ks = K + Kt
2
,
Ka = K −Kt
2
;
Ks = Kt
s,
Ka = −Kt
a.
(b)
Using a 2 × 2 example with
K =

k11
k12
k21
k22

, k12 ̸= k21,
show that E(q) depends on the symmetrical part of K, that is, that
1
2qtKq = 1
2qtKsq,
and that, hence, e = Ksq if the constitutive laws are derived by dif-
ferentiation of the stored-energy function.
7-13. The linear R-ﬁeld is shown in a mixed-causal form, that is, the input and
output port variables are related by a matrix K thus:
(a)
What can you predict about K before writing out the R-ﬁeld
equations?

370
MULTIPORT FIELDS AND JUNCTION STRUCTURES
(b)
Suppose the R-ﬁeld were forced to accept resistance or conductance
causality. What characteristics would the resistance and conductance
matrices have?
(c)
Using causality, prove that the resistance matrix does not exist.
(d)
Write out the matrix K and the conductance matrix to verify your
predictions in (a) and (b). Using the equations for mixed-causal form,
show that the equations cannot be manipulated into the resistance
causality form.
7-14. Find a mechanical system having the implicit C-ﬁeld shown in Figure 7.7c.
7-15. Consider a lightweight horizontal rod on which three masses are fastened,
one each at both ends and one at the midpoint. Assume that the end masses
move vertically in such a way that the angle of the rod with the horizontal
remains small. Show that this system has a bond graph similar to the bond
graph shown in Figure 7.12b for interconnected self-inductances.

8
TRANSDUCERS, AMPLIFIERS,
AND INSTRUMENTS
This chapter deals primarily with models of devices that link two subsystems in
two distinct energy domains. In some cases, the efﬁciency of power transduction
is important. Motors, generators, pumps, and transmissions, for example, usually
are designed so that they can transduce energy without much loss, at least when
operating normally. Instruments and ampliﬁers, on the other hand, are designed to
operate at low power-efﬁciency. An ideal instrument would extract information
from a system without power absorption and could communicate at ﬁnite power
to another system. An ampliﬁer accepts an input signal at near-zero power level
and inﬂuences another system in response to the input signal at ﬁnite power.
The high-efﬁciency transducers are usually passive; that is, they contain no
sources of power. The instruments and ampliﬁers are often active in the sense that
they need a power supply in order to satisfy the ﬁrst law of thermodynamics. Most
practical transducers are themselves rather complex systems that can be modeled
in detail by bond graphs. On the other hand, designers of large systems containing
transducers as components cannot afford the luxury of modeling transducers in
detail and must use good approximate models. In this chapter, we will show the
main features of several types of transducers and demonstrate a philosophy of
modeling in which nonideal effects may be progressively added to an idealized
basic model. We concentrate ﬁrst on passive transducers and then brieﬂy study
instruments and ampliﬁers.
Passive transducers that contain loss elements can, on the average, only trans-
mit less power than they receive. Some transducers do, however, have the
capability of storing energy so that they can temporarily deliver excess power. We
call the two types of passive transducers power transducers and energy-storing
transducers.
371
System Dynamics: Modeling, Simulation, and Control of Mechatronic Systems, Fifth Edition
Dean C. Karnopp, Donald L. Margolis and Ronald C. Rosenberg
Copyright © 2012 John Wiley & Sons, Inc.

372
TRANSDUCERS, AMPLIFIERS, AND INSTRUMENTS
8.1
POWER TRANSDUCERS
Ideal power transducers were introduced in Chapter 4 as transformers and gyra-
tors. Devices such as hydraulic rams, positive-displacement pumps and motors,
permanent-magnet dc motors and generators, and the like behave roughly as
power-conserving elements. Real devices, of course, do exhibit power losses and
also contain energy-storing mechanisms and associated inertial and capacitance
effects. Although clever design of transducers can result in rather small values
for these parasitic effects, they still impose an ultimate limit on the performance
of any real device. When a very accurate model of a real transducer is desired, it
will almost invariably be necessary to replace linear elements of the model with
more accurate nonlinear ones. The process of starting with a highly idealized
model, adding parasitic elements, and replacing linear elements with nonlinear
ones to achieve increasingly accurate transducer models will be illustrated for
some typical power transducers.
In Figure 8.1, two hydraulic ram conﬁgurations are shown schematically, and
a series of bond graph models are also shown. The model of Figure 8.1b for the
basic ram has been used in Chapter 4. This transformer model instantaneously
and without loss of power transduces the hydraulic power, PQ, into mechanical
power, FV . In some cases, this model may be quite adequate for a system
analysis. On the other hand, in real pistons the mass effects and frictional losses
associated with piston rings, packing, or tight ﬁts to prevent leakage can be
appreciable. The bond graph of Figure 8.1c essentially provides for a loss in the
force F due to the force required to accelerate the piston and the frictional loss.
The mass effect of the piston is quite straightforward, and in many cases,
when the piston rod is stiff and connects directly with a load mass, the piston
mass and the load mass may simply be lumped together. But the friction force
is more complex. A friction force may be small, and therefore negligible for
some purposes, but the next simplest representation, the linear friction force as a
function of velocity, is virtually never an accurate representation of mechanical
friction. In Figure 8.2, several possible friction force laws are shown. The linear
law is often used in order to study systems using the analytically convenient
linear methods, but usually the friction coefﬁcient is left as a variable so that
the model can be “tuned” to reproduce experimental results. Real friction usually
includes a component of dry friction, represented by Ff = F0 sgn V , where sgn
V is +1 if V > 0 and −1 if V < 0. This law is not as convenient to work with
as the linear law, particularly near V = 0. A more complicated phenomenon is
sometimes called “stiction.” It is easily observed that it takes more force to start a
block lying on a table moving than to keep it moving at low speeds. The general
friction law shown in Figure 8.2 attempts to model this phenomenon. When this
type of friction is present, there is a tendency for the system to chatter. This is
ﬁne if the system is a violin string and bow but is distinctly unpleasant if the
system is chalk on a blackboard, a machine tool and workpiece, or a computer
simulation program with numerical stability problems. The experienced system

POWER TRANSDUCERS
373
FIGURE 8.1. Hydraulic rams: (a) basic ram; (b –d) models of basic ram; (e) hydraulic
cylinder; (f–h) models of hydraulic cylinder.
modeler treads a ﬁne line between realistic but intractable friction models and
useful but possibly oversimpliﬁed models.
Another phenomenon that is important in high-performance hydraulic systems
involves the compliance of the working ﬂuid. Since hydraulic ﬂuids are not usu-
ally very compliant, small density changes accompany large pressure changes,
and a linear constitutive relation usually sufﬁces. One may deﬁne the bulk mod-
ulus β as the coefﬁcient relating the pressure P and the decrease in volume, V ,
of a mass of ﬂuid that occupies volume V 0 when P = 0:
P = β V
V0
.
(8.1)

374
TRANSDUCERS, AMPLIFIERS, AND INSTRUMENTS
FIGURE 8.2. Several mechanical friction laws.
Actually, β, which is expressed in pressure units, varies somewhat with mean
pressure, temperature, amount of air in the working ﬂuid, and so on, so a more
useful form of Eq. (8.1) is
P = P0 + β V
V0
= P0 + β
V0
 t
Q dt,
(8.2)
where P0 is an equilibrium pressure, V 0 is a nominal volume, and Q = ˙V is the
volume ﬂow rate into the nominal volume. Then β is more obviously the slope
of a nonlinear constitutive law relating pressure and the compressed volume of
the ﬂuid. The bond graph of Figure 8.1d shows a —C element that models
this compliance effect. Clearly, there is an oscillatory phenomenon that occurs
as energy is exchanged between the mass of the piston and the compliance of
the hydraulic ﬂuid. Note that for the linear theory of Eq. (8.2), one must pick a
nominal volume, V0 = Ax0, where x0 is an average position of the piston (see
Figure 8.1a). Thus, the hydraulic ﬂuid stiffness is high when x0 is small and gets
lower as x0 is increased.
Figure 8.1e shows a 3-port transducer in which, because of the area of the
piston rod, the areas that transduce the two pressures, P1 and P2, into force
components are not equal. Also, the ﬂows, Q1 and Q2, are not equal. The bond
graph of Figure 8.1f represents this system in its most highly idealized form. In
Figure 8.1g the hydraulic leakage resistance across the piston has been included,
and in Figure 8.1h mechanical inertia and friction and hydraulic compliance
effects have also been modeled. As one may see from this example, even the
simplest transducer models can become rather complex when many nonideal
effects are accounted for.
Another useful example of power transducers is the dc motor or generator. The
basic ideal transducer is shown in Figure 8.3a. The power in the armature circuit,
eai a, is transduced to shaft power, τω, when the device operates as a motor and

POWER TRANSDUCERS
375
FIGURE 8.3. Direct-current electric motor–generator models: (a) basic ideal transducer;
(b) self-inductances, resistances, inertia, friction, and windage effects added; (c) shunt
motor; (d) series motor.
the power ﬂow reverses during generator operation. The ﬁeld port establishes
a magnetic ﬁeld, which provides the coupling between electric variables and
mechanical variables for the individual conductors on the rotor. For a permanent-
magnet motor, this ﬁeld is constant, but for the separately excited motor shown
in Figure 8.3a, the ﬁeld is a function of the ﬁeld current i f . The commutator of
the motor essentially maintains the ﬁeld due to the armature current in a direction
perpendicular to the ﬁeld generated by i f . For this reason, although i f inﬂuences
the transduction, there is virtually no back effect on ef due to ea or i a. Thus,
the ﬁeld port inﬂuence is shown acting on an activated bond.
The equations corresponding to Figure 8.3a are as follows:
ea = T (if )ω,
T (if )ia = τ,
ef = 0.
(8.3)

376
TRANSDUCERS, AMPLIFIERS, AND INSTRUMENTS
Note that the transduction coefﬁcient T, which is a gyrator parameter, can
assume two different values if electrical and mechanical powers are measured in
different units. Thus Eq. (8.3) is sometimes rewritten in the form
ea = Temω,
Tmeia = τ,
(8.3a)
with Tem expressed, for example, in volts per radian per second, and Tme in
foot-pounds per ampere, for example. Power conservation is then
eaia = Tem
Tme
τω,
(8.4)
with Tem/Tme relating volt-amperes to foot-pounds per second. One must not
assume, however, that because Tme and Tem differ numerically, the device is
not power conserving. In the SI system, one volt-ampere is identical to one
newton-meter per second, so that Tem is exactly equal to Tme.
The parameter T involves the strength of the ﬁeld as well as the number and
effective lengths of the armature conductors that interact with the ﬁeld. (See the
discussion of the modulated gyrator in Chapter 7 for a discussion of this type of
interaction with simpliﬁed geometry.) In some cases, it is reasonable to assume
that the ﬁeld is proportional to i f . Then
T (if ) ∼= Aif ,
(8.5)
where A is a constant. Thus, if i f is a constant, torque is proportional to i a,
and if i a is a constant, torque is proportional to i f . In such special cases, the
device behaves linearly, even though it is basically nonlinear in a multiplicative
sense. In real devices, saturation of the magnetic material limits the ﬁeld, so that
the relation between T and i f does not remain linear for large currents. Also,
magnetic hysteresis effects, when present, mean that the ﬁeld is not a single-
valued function of i f but rather depends on the previous history of magnetization.
(The permanent-magnet motor is an extreme example of this—even though there
is no i f , a ﬁeld exists, and hence, T = const.)
In most cases, the ideal transducer must be supplemented with loss and energy
storage elements to model practically important effects. In Figure 8.3b a com-
mon motor model is shown. The self-inductance and resistance of the ﬁeld and
armature coils are included, as well as the moment of inertia of the rotor and a
mechanical resistor that models bearing losses and windage from the rotor and
any built-in cooling fans. The electrical I- and R-elements are typically assumed
to be linear unless a very accurate model is required. The mechanical resistor is
rarely linear in reality, but sometimes an effective linear resistor will give good
results if the mechanical friction is small enough that its detailed nature is not
critical in determining system performance.
Two common 2-port motors can be constructed from the separately excited
motor model. These are the shunt-wound and series-wound motors of Figure 8.3c

POWER TRANSDUCERS
377
FIGURE 8.4. Elementary ac generator: (a) schematic diagram; (b) bond graph using
MGY ; (c) bond graph using GY and MTF. Note: The modulus will be deﬁned by
Eqs. (8.13) and (8.14).
and d. Note that, in Figure 8.3d, i a and i f are identical, so that one could simplify
the bond graph by combining the ﬁeld and armature inductances and resistances.
Before leaving the subject of power transducers, let us consider two examples
in which the ideal transducer is fairly complicated even when loss and parasitic-
energy-storage effects are neglected. In Figure 8.4a an alternating-current (ac)
generator employing a permanent magnet is shown in highly schematic form. As
the square coil rotates in the uniform B-ﬁeld, there is an interaction relating the
electric power variables, e and i, and the mechanical variables, τ and ω.
One of the constitutive laws of the device may be found by using the basic
deﬁnition of the ﬂux linkage λ. The amount of ﬂux linked by the current path is
B times the projected area of the coil times the number of turns in the coil, n:
λ = Bl2l1(sin θ)n.
(8.6)

378
TRANSDUCERS, AMPLIFIERS, AND INSTRUMENTS
Using the fact that ˙λ = e, one may differentiate Eq. (8.6) to ﬁnd a relation
between e and ω = ˙θ:
e = (nBl1l2 cos θ)ω.
(8.7)
Then, noting that power must be conserved according to ei = τω, the remain-
ing constitutive law is
(nBl1l2 cos θ)i = τ,
(8.8)
where the variables are expressed in metric units so that ei and τω are both in
the same units of power. The constitutive equations of the device, Eqs. (8.7) and
(8.8), are embodied in the bond graph of Figure 8.4b. Note that the modulating
function involves θ, the integral of the local ﬂow ω.
Another way to derive the laws for this device involves computing the force
F on the lengths of wire that cut the ﬂux lines. Note that the lengths of wire
associated with l2 cut ﬂux lines, while the lengths associated with l1 do not.
If F is the force perpendicular to the direction of B, and V is the velocity in
this direction, then for a typical conductor of length l2, the basic equations as
discussed in Chapter 7 are
e1 = Bl2V,
(8.9)
Bl2i1 = F,
(8.10)
where e1 and i 1 are the voltage and current associated with a single length of
conductor. There are, however, 2n such lengths of conductor, so that the terminal
voltage is 2ne1:
e = 2nBl2V.
(8.11)
Also, each length of conductor has the same current, and each produces a force
that ultimately will add to produce the torque τ. Calling the total torque-producing
force F t, we have
2nBl2i = Ft.
(8.12)
Now, the cutting velocity V is
V =
l1
2 cos θ

ω,
(8.13)
and the relation between F t and τ is
l1
2 cos θ

Ft = τ.
(8.14)
Thus, the entire device can be represented by a gyrator with modulus 2nBl2
and a modulated transformer with modulus (l1 cos θ)/2, as shown in Figure 8.4c.
Clearly, the two representations of Figure 8.4b and c, that is, those of Eqs. (8.7)
and (8.8) and Eqs. (8.11)–(8.14), are equivalent. Loss and energy-storing ele-
ments could be added to this power-conserving model.

POWER TRANSDUCERS
379
There are many analogies between rotary electromechanical devices and
hydromechanical devices. Just as a dc motor with multiple windings and a
commutator functions as a gyrator, a pump with several pistons and a porting
arrangement functions essentially as a transformer. The ﬁeld port of a dc motor
allows modulation of the gyrator parameter, and a stroke control on a pump,
if it exists, allows modulation of the transformer ratio. The ac machines are
often physically simpler but functionally more complex. The ac generator of
Figure 8.4 is similar to the single piston and crank arrangement of Figure 8.5,
which could form part of a pump if suitable valving were added. Although the
relation between the piston force and velocity and the pressure and ﬂow of the
hydraulic ﬂuid is readily represented by a transformer, the relation between the
torque τ, the angular speed ω, and the other power variables is more complex.
One way to ﬁnd a relation between ω and the piston speed V is to start with a
relation between x and θ (see Figure 8.5a). Working out the geometry, one ﬁnds
x = a cos θ + (b2 −a2 sin2 θ)1/2.
(8.15)
If ˙x = V and ˙θ = ω, then the result of differentiating Eq. (8.15) is
V = [−a sin θ −(b2 −a2 sin2 θ)−1/2a2 sin θ cos θ]ω.
(8.16)
Since FV = τω if F is the force on the piston, the remaining constitutive
relation must be
[−a sin θ −(b2 −a2 sin2 θ)−1/2a2 sin θ cos θ]F = τ.
(8.17)
FIGURE 8.5. Crank and piston transducer: (a) schematic diagram; (b) bond graph.

380
TRANSDUCERS, AMPLIFIERS, AND INSTRUMENTS
Recognizing the complicated function of θ as a transformer modulus, and call-
ing it f (θ) for convenience, one may represent the device by the bond graph of
Figure 8.5b. Note the similarity between this bond graph and that of Figure 8.4c.
It should be evident from these examples that considerations of power conserva-
tion can greatly aid in modeling power transducers.
8.2
ENERGY-STORING TRANSDUCERS
The transducers of the previous section were modeled, in ideal form, by trans-
former and gyrator elements. They were energy conservative, but beyond that,
power in one domain was instantaneously transduced into another domain. In
this section, we study transducers that are also ideally energy conservative but in
which energy storage plays an indispensable role. Thus, for these energy-storing
transducers, energy from one domain may be stored and released in another
domain at a later time.
The transducer models in this section are based on C-ﬁelds, I -ﬁelds, and
mixed IC-ﬁelds, which were discussed in Chapter 7. Here, we merely discuss
some example systems and use the results of Chapter 7 without much discussion.
As in the previous section, models of real transducers can be assembled from
ideal models supplemented with loss and dynamic elements to account for effects
that are present in real devices but not accounted for in the ideal transducer.
A typical energy-storing transducer of practical interest is the condenser
microphone or electrostatic loudspeaker, which can be described as a two-port
C-ﬁeld. The sketch of Figure 8.6a shows roughly how these devices may
be constructed. A capacitor is formed by mounting a movable plate near a
rigidly mounted plate and providing electrical connections as one would in
a conventional parallel-plate capacitor. In practice, the movable plate might
be a thin diaphragm or a tightly stretched membrane on which a thin layer
of conducting material is ﬁxed. Such distributed-parameter “plates” could
actually move in complicated ways, but for simplicity we will consider a
system with only one mechanical coordinate, X, as shown in Figure 8.6b.
(One may think of X as the displacement of the ﬁrst normal-mode shape
of a diaphragm for those cases in which the contribution of higher modes
may be neglected.) The force F, which may be due to acoustical pressure in
practical cases, is deﬁned so that the mechanical power is F ˙X = FV , where
V is the (generalized) velocity of the moving plate. The electrical power is, of
course, ei.
When X is ﬁxed, the device is an ordinary electrical capacitor, and when the
charge q is ﬁxed, F depends on X as in a mechanical spring. In general, we may
hypothesize that both e and F depend on q and X:
e = e(q, X),
(8.18)
F = F(q, X).
(8.19)

ENERGY-STORING TRANSDUCERS
381
FIGURE 8.6. The movable-plate capacitor: (a) sketch of microphone or speaker; (b)
schematic diagram; (c) bond graph representation.
But the constitutive relations above are certainly not arbitrary, since the device
can at best conserve energy if we temporarily ignore loss effects. The stored
energy, E, is readily computed:
E(t) = E0 +
 t
0
(ei + FV ) dt
= E0 +
 q,X
0,0
e(q, X) dq + F(q, X) dX = E(q, X),
(8.20)
where E0, which will generally be assumed to vanish, represents an initial energy
at t = 0 or when q = X = 0.
A close inspection of Eq. (8.20) shows that the constitutive laws of Eqs. (8.18)
and (8.19) can be recovered from E(q, X),
e = ∂E
∂q ,
F = ∂E
∂X,
(8.21)
and the required relation between the two constitutive laws is
∂e
∂X =
∂2E
∂X∂q = ∂F
∂q .
(8.22)

382
TRANSDUCERS, AMPLIFIERS, AND INSTRUMENTS
This result is the integrability or Maxwell reciprocity conditions which the laws
of the device must satisfy in order that energy be conserved. These considerations
mirror those discussed in Chapter 7 for general C-ﬁelds, so the bond graph
representation is simply that shown in Figure 8.6c. The constitutive laws for the
C-ﬁeld are Eqs. (8.18) and (8.19), which must obey Eq. (8.22).
A useful approximation to the constitutive laws may be found by assuming
that the device is electrically linear, that is, that a capacitance C may be deﬁned
for every X and that
e =
q
C(X)
(8.23)
is the form of Eq. (8.18). Noting that from physical reasoning F = 0 when
q = 0, we may evaluate E using Eq. (8.20) by letting q = 0, taking X to any
particular value, and then charging the capacitor with X = const (or dX ≡0).
Then the integral in Eq. (8.20) is just
E(q, X) =
 q
0
q
C(X)dq =
q2
2C(X).
(8.24)
The force law corresponding to Eq. (8.23) is then
F = ∂E
∂X = q2
2
d[C(X)]−1
dX
,
(8.25)
so that F may be determined from measurements of the variation of C with X.
(For an ideal parallel-plate capacitance as sketched in Figure 8.6b, the law would
be C(X) = εA/X, where ε is the dielectric constant of the medium between the
plates and A is the area of the plates.) The use of the stored energy E to ﬁnd
the force law is far more convenient than a direct calculation or an experimental
measurement.
Note that even when one assumes that this device is electrically linear, the
force law is decidedly nonlinear. In use, the device is normally subjected to both
a high polarizing voltage together with a ﬂuctuating signal voltage. Under these
conditions, the plates tend to move together and to short the electrical circuit. This
is prevented by the mechanical spring of the diaphragm, which supplies a force
in the direction of F in Figure 8.6b. In addition, all real diaphragms have mass
and exhibit some energy loss when in motion. Such effects are readily modeled
by adding elements to the C-ﬁeld of Figure 8.6c. This device is discussed in
more detail in Reference [1], Chapter 6.
Another common electromechanical transducer, the electrical solenoid (shown
in Figure 8.7), can serve as a prototype of a mixed IC-ﬁeld transducer. The
device consists simply of a coil of wire in which a soft-iron slug can freely slide.
When current ﬂows in the coil, the slug is pulled into the coil. In analyzing this
device, it is clear that from the electrical port, the coil will certainly exhibit the
characteristic self-inductance effects of any coil, although the position of the coil,

ENERGY-STORING TRANSDUCERS
383
FIGURE 8.7. The solenoid. (a) sketch of device; (b) bond graph representation.
X, will presumably affect the electrical behavior. From the point of view of the
mechanical port, it seems clear that the force on the slug, F, will depend on X,
that is, the device will possess some of the properties of a mechanical spring,
although the electrical variables will also affect F. If we assume that the current
in the coil depends on the ﬂux linkage λ as well as X, and that F also depends
on λ and X,
i = i(λ, X),
(8.26)
F = F(λ, X),
(8.27)
then the stored energy E is
E = E0 +
 t
0
(ie + FV ) dt = E0 +
 λ,X
0,0
idλ + F dX,
(8.28)
where ˙λ = e and ˙X = V and we will assume that E0 = 0.
By direct examination of Eq. (8.28), one may see that
i = ∂E
∂λ ,
F = ∂E
∂X,
(8.29)
and
∂i
∂X = ∂2E
∂X∂λ = ∂F
∂λ ,
(8.30)
which is the integrability condition or Maxwell reciprocal condition constraining
Eqs. (8.26) and (8.27) as discussed in Chapter 7. The bond graph of Figure 8.7b
represents this ideal transducer. For mnemonic purposes the electrical port is
shown impinging on the I and the mechanical port on the C.
Further insight into the device may be gained by assuming that the device is
electrically linear. We assume that an inductance, L(X), exists that relates i and

384
TRANSDUCERS, AMPLIFIERS, AND INSTRUMENTS
λ for any position of the slug. Thus, Eq. (8.26) becomes
i =
λ
L(X).
(8.31)
Also, on physical grounds, when i and λ vanish, F must also vanish, so that in
evaluating E in Eq. (8.28), we may establish the slug at some particular position,
X, with λ = 0, without doing any work on the device and then hold X ﬁxed
while λ is brought to its ﬁnal value. During the change in λ, dX = 0, so only
electrical energy is stored. The energy is then
E(λ, X) =
 λ
0
λ
L(X)dλ =
λ2
2L(X).
(8.32)
The constitutive law corresponding to Eq. (8.27) can now be found using
Eq. (8.29):
F = λ2
2
d[L(X)]−1
dX
= −λ2
2
L′
L2 ,
(8.33)
where L′ is dL/dX. The general forms for L(X) and L′(X) are sketched in
Figure 8.8. From these sketches and Eq. (8.33), one can see that the slug will
experience a force tending to center it, but even when the simple law (8.31) is
assumed, the corresponding force law is rather complex and inherently nonlinear
in both the electrical and the mechanical variables.
The IC-ﬁeld concept is particularly useful for electromagnetic devices,
which often involve interacting magnetic ﬁelds associated with moving parts.
FIGURE 8.8. Inductance functions for the solenoid.

AMPLIFIERS AND INSTRUMENTS
385
Alternating-current motors and generators, for example, typically involve coils
that rotate with respect to each other. The electrical ports of these devices
are inertial, and the rotary mechanical port is capacitive when the device is
described as an IC-ﬁeld. Examples of such devices appear in the problems and
in Reference [1], Chapter 6.
8.3
AMPLIFIERS AND INSTRUMENTS
The central idea behind the words “ampliﬁer” and “instrument” is a low-power
or a one-way interaction without signiﬁcant back effect. The description of ideal
ampliﬁers and instruments is functional rather than physical, and thus the physi-
cal, bilateral power interactions of bond graphs must be degenerated into signal
interactions by the use of activated bonds in order to represent these devices. One
assumes frequently that an ideal ampliﬁer supplies an output power variable such
as a voltage or current at ﬁnite power in response to an input signal at essentially
zero power. Similarly, an instrument is supposed to extract information about
some variable without affecting the system in which the variable appears and to
transmit the information, often at ﬁnite power levels.
Clearly, ideal instruments and ampliﬁers violate even more physical laws
than the ideal power- and energy-storing transducers discussed previously. For
example, the usual functional descriptions violate even the ﬁrst law of thermody-
namics, since ﬁnite output power is somehow produced from zero input power.
In reality, of course, most ampliﬁers have a readily identiﬁable power supply that
is built into the functional relationships. The bond graphs of Figure 8.9 show the
power supply and show that power is not created from a vacuum.
On the other hand, the active bond that indicates a signal ﬂow with no asso-
ciated power can only be approximate. At the microscopic level, the Heisenberg
uncertainty principle is essentially a statement that signal interactions without
FIGURE 8.9. Ampliﬁers and instruments: (a) basic bond graph representation of an
ampliﬁer; (b) instrumentation system with signal level transducer and associated ampliﬁer.

386
TRANSDUCERS, AMPLIFIERS, AND INSTRUMENTS
back effect are impossible, but at a macroscopic level we know that ampliﬁers
with extremely high power gain can be built and that instruments that have vir-
tually no effect on the observed system are available in many cases. But no
absolute statements about the appropriateness of an active bond representation
can be made.
Probably every engineering student has had the experience of thinking of some
real instrument as an ideal signal transducer and ampliﬁer only to ﬁnd that, in
some cases, the attachment of the instrument to some system greatly distorted
the behavior of the system to be measured. An oscilloscope, for example, has
a high but ﬁnite input impedance. Therefore, it cannot be expected to measure
voltages in a system having impedances of the same order of magnitude as its
own without a large effect on those voltages due to the current ﬂowing to the
instrument. Similarly, the ﬁnal stage of a hydraulic ampliﬁer of the size, say, of
a ship steering engine requires sizable power levels at its input. The input can be
considered to be an active bond only under restricted circumstances, for example,
if the next to last stage of the ampliﬁer is sized so that the load of the input to
the last stage does not cause a signiﬁcant effect on the response of the next to
last stage.
In low-power applications, power efﬁciency is generally not very important,
and ampliﬁers are designed to provide a drastic decoupling of input and out-
put back effects. In high-power applications, on the other hand, ampliﬁers must
usually be treated more physically, since it is not feasible to build such high-
power-gain components that the input to an ampliﬁer stage can reasonably be
considered an active signal. Thus, it is a modeling decision whether or not to rep-
resent an ampliﬁer or instrument with an active bond, and such a representation
must be justiﬁed for each system of which the real device is to be a part.
With these caveats in mind, let us consider some useful bond graph representa-
tions of ideal elements, incorporating active bonds. The simplest type of ampliﬁer
model consists of a signal-controlled effort or ﬂow source. In Figure 8.10a, the
ubiquitous electrical voltage ampliﬁer is shown in bond graph form. The output
voltage e0 is assumed to be a static or dynamic function of the input voltage ei.
In the static, linear case, there is a voltage gain G and
e0 = Gei(t).
(8.34)
FIGURE 8.10. Ampliﬁer models using controlled sources: (a) voltage-controlled voltage
source; (b) vibration shaker shown as a velocity source.

AMPLIFIERS AND INSTRUMENTS
387
In the dynamic case, the output voltage may be related to the input voltage
by a differential equation, or in the common linear case by means of a transfer
function. In the latter case, one may ﬁnd internal state variables for the ampliﬁer
that yield the desired transfer function. Generally, these state variables are non-
physical and merely serve to provide state equations equivalent to the speciﬁed
frequency-domain representation of the ampliﬁer. Such state equations may be
used in time-domain analysis of the complete system.
The input voltage ei in Figure 8.10a is shown as coming from a 0-junction as
a signal on an active bond. In writing the current sum relation for all the bonds
incident on the 0-junction, one assumes that there is no current associated with
the active bond. Thus, the ideal ampliﬁer does not affect the 0-junction from
which it obtains its input voltage. At the output, a ﬁnite current i 0 may exist, but
e0 is not affected by i 0. Thus, the power gain is inﬁnite in this ideal case.
In well-designed systems, ampliﬁers may indeed function as controlled
sources, but in some cases, the controlled-source assumption is made even when
a more detailed and physical model would be preferable. In Figure 8.10b, for
example, a vibration shaker is modeled as a controlled velocity source in which a
desired velocity time history is generated as V i and a complex servomechanism
system is supposed to enforce V 0(t) at a port of a test system in response to
V i(t). In many cases, the reaction force does affect the servo, so that V 0 does
not faithfully track V i. In such a case, the simple model of Figure 8.10b is
clearly inadequate, but the simplicity of controlled-source models often tempts
system engineers to use them, particularly when the dynamics of the real devices
have not been well explored or documented.
Many physical devices function essentially as ampliﬁers or transducers but
are inadequately modeled as simple controlled sources. For example, a gaso-
line engine clearly ampliﬁes the power of a human or automatic controller. The
torque–speed curves of an engine, as sketched in Figure 8.11a, are drastically
modiﬁed by the position of the throttle valve, which has been indicated by the
angle θ. Also, the power required to move the throttle valve is often extremely
small, not only in comparison with the engine power, but also in comparison with
spring forces, inertial forces, and pivot-friction forces in the throttle linkage. Thus,
it may be reasonable to consider that the torque associated with movement of
the throttle linkage is negligible, but we cannot merely assume that θ controls
a source, since the torque τ is always a function of the angular velocity of the
output shaft, ω. Since torque is related to speed (effort is related to ﬂow), one
may describe the engine as a resistor, albeit an unusual one in which power is
normally supplied rather than dissipated. (The power supply in the gasoline has
been absorbed into the torque–speed curves.) Thus, the ampliﬁer representation
of the engine can be shown as a controlled resistance, as in Figure 8.11b.
The active bond indicating that there is no torque on the throttle linkage
corresponding to ˙θ is equivalent to a signal, so one may use block diagram
notation to show that ˙θ is integrated into the signal θ that controls the resistor
representing the engine. In general, when ampliﬁers and instruments are part of a

388
TRANSDUCERS, AMPLIFIERS, AND INSTRUMENTS
FIGURE 8.11. Static model of gasoline engine as ampliﬁer: (a) torque–speed curves
as a function of throttle linkage angle θ; (b) ampliﬁer model of engine using controlled
resistance.
system, the use of block diagrams for showing dynamic relations for active-bond
signals in a bond graph can be very useful.
As another example of the use of a controlled resistance, consider the strain-
gage instrument shown in Figure 8.12. The idea behind a resistance strain gage
is that the electrical resistance of the gage is a function of the mechanical strain
of the member to which the gage is attached. In many applications, the member
functions as an elastic element that relates strain to stress and, ultimately, to
force in the structure. Thus, when the strain gage is put into the bridge circuit
of Figure 8.12a, and the bridge is supplied with the voltage ei, then the voltage
e0 reacts to the force F in the structure. A bond graph representation of the
basic instrument can be constructed out of a force-controlled resistance and the
bond graph version of a bridge circuit, as shown in Figure 8.12b and c. Of
course, one could continue to simplify this instrumentation system. For example,
if ei were supplied by a constant source, then one could reduce the system to a
force-modulated resistance at the output port with the voltage supply built into
the resistance relation. Furthermore, if an ampliﬁer were connected to the output
port, it could be arranged to supply an output voltage as a function of the force.
Thus, the entire system might simplify to a force-controlled voltage source.
Although virtually any transducer might be arranged to act as an instrument
under certain conditions and, in conjunction with a power supply, could function
as an ampliﬁer, variable-resistance elements are particularly important. In this
category fall most electronic devices, such as transistors, vacuum tubes, and
the like, and the important valve-controlled hydromechanical devices. Perhaps
a ﬁnal example will help indicate how such devices may be modeled in bond
graph terms.
Valves are devices in which the position of a mechanical part inﬂuences the
hydraulic resistance. This change in resistance can be converted to a change
in pressure drop across the valve, and thus one may deduce the position of

AMPLIFIERS AND INSTRUMENTS
389
FIGURE 8.12. Strain-gage instrument. (a) circuit diagram; (b) bond graph; (c) simpliﬁed
bond graph after choice of ground voltage.
the movable member; that is, the valve can be made into a position-indicating
instrument. Also, by moving the valve, large amounts of ﬂuid power may be
controlled, and the valve may be made into an ampliﬁer. It is this latter application
that we now consider.
The so-called four-way valve shown in Figure 8.13 is common in hydraulic
power systems. Actually, four resistances in the valve are modulated by the valve
spool position z simultaneously. When the valve is connected to a pressure supply
and a load (typically a hydraulic ram or a positive-displacement rotary hydraulic
motor), a large ﬂow of hydraulic power, PmQm, is controlled by a small amount
of power associated with the movement of the spool, ˙z. As shown in Figure 8.13,
the hydraulic circuit is a bridge.
Such systems involving hydraulic valves are complicated by the intrinsic
nonlinearity of hydraulic resistors. These systems have been extensively stud-
ied, however, and rather simple models may often sufﬁce. From Chapter 7 of

390
TRANSDUCERS, AMPLIFIERS, AND INSTRUMENTS
FIGURE 8.13. The general four-way valve and its equivalent circuit.
Reference [2], for example, we ﬁnd the curves of Figure 8.14, which give the
relation between motor ﬂow Qm and motor pressure Pm (Pm = P1 – P4 in
Figure 8.13) for various values of the valve spool position z. Clearly, this ampli-
ﬁer is represented as a displacement-modulated resistance, and the curves of
Figure 8.14 are the constitutive laws of the device. (Various characteristic curves
for different valve geometries are given in Reference [2].) The bond graphs of
Figure 8.15 show how the ampliﬁer may be represented. In Figure 8.15a, the
supply pressure is merely absorbed into the constitutive laws of the resistor. In
Figure 8.15b, the valve is shown in 2-port resistance form. In this case, the effect
on the ampliﬁer of operating with various supply pressures can be studied. In
either model a complex physical system is represented in a simple functional form
that is valid only under restricted conditions. Naturally, more accurate physically
based models of the device may be made using standard bond graph methods,

AMPLIFIERS AND INSTRUMENTS
391
FIGURE 8.14. Pressure ﬂow characteristics for a four-way valve.
FIGURE 8.15. Bond graph models of the four-way hydraulic valve: (a) Displacement-
modulated resistance with Ps built into constitutive law; (b) representation showing
pressure supply.
but such models will be more complex than the functional model, and they may
not add much to the usefulness of the overall system model. For this reason, the
functional model may at least serve the purposes of a ﬁrst system analysis. Later,
a more reﬁned model may prove desirable.

392
TRANSDUCERS, AMPLIFIERS, AND INSTRUMENTS
8.4
BOND GRAPHS AND BLOCK DIAGRAMS
FOR CONTROLLED SYSTEMS
As discussed in Chapter 6, feedback control systems are widely used to modify
the dynamic behavior of engineering systems. They require sensors to measure
some aspects of the system response, signal processors to realize the control law,
and actuators to affect the system. The sensors and actuators are usually very
similar to instruments and ampliﬁers discussed in the last section and thus are
typically modeled using active bonds. The signal processor, which is usually a
special-purpose analog or digital computer, is normally described by its action
on certain signals without regard to any physical power required.
Naturally, a sensor or an actuator is really a physical system and could be
described by a bond graph—as could, in principle, a computer. For a well-
designed system this is neither necessary nor desirable, and it is common practice
to use signal ﬂow graphs, block diagrams, or computer programs to describe the
information processing that goes on between the sensor output and the actuator
input in a controlled system. When the sensors or actuators have dynamics that
cannot be neglected, they can be incorporated either as part of the physical system
or, more artiﬁcially, as part of the dynamic laws of the control system itself.
For controlled systems, then, it is advantageous to use composite represen-
tations in which the physical system is represented using bond graphs and the
controller is represented as a signal processor. We illustrate the choices of repre-
sentation through an example. The signal processing will be represented through
the use of block diagrams of various degrees of speciﬁcity. The combination of
bond graphs and block diagrams is particularly useful when a continuous system
simulation program that can accept bond graph models directly is available. (See
Chapter 13.) In such a program the bond graph equations are generated auto-
matically and the block diagram or control algorithm only needs to be added.
Alternatively, one could represent even the physical system in block diagram or
equivalent form, since an augmented bond graph is nothing more than a very
compact representation of the information in a block diagram or equation set.
For simple systems, the resulting combined block diagram may yield insight, but
for more complex systems, the resulting block diagram may be too complicated
to be of much use.
Figure 8.16 shows a schematic diagram of an electronically controlled auto-
motive suspension featuring a fast-acting load leveler and a semi-active damper.
See References [3–5] for details on the systems. For simplicity, the system shown
is only a “quarter-car” model with the mass M representing the body and m the
wheel. The velocity V 0 represents vertical velocity inputs from roadway uneven-
ness, and k is a linearized tire spring constant. A sensor is supposed to generate
an approximation to V , the absolute vertical velocity of the car body, and another
measures X, the wheel-to-body deﬂection.
The controller drives one actuator which provides the relative velocity V c of
the main suspension spring attachment point as a conventional load leveler does.
(The sketch shows the mechanical equivalent of systems which might actually

BOND GRAPHS AND BLOCK DIAGRAMS FOR CONTROLLED SYSTEMS
393
FIGURE 8.16. Quarter car model with electronically controlled suspension system incor-
porating a semi-active damper and a fast load leveler.
be realized using pneumatic or hydro-pneumatic means.) The other controller
output is F c, a command force that is to be realized by a semi-active damper.
The damper is a variable resistor—for example, a hydraulic shock absorber with
electromechanical valves. Obviously such a device cannot provide an arbitrary
F c, since its force times its relative velocity ˙X must always represent power
dissipation. Thus, in the model, a nonlinear function 
 will be used to relate the
actual damper force to F c and ˙X. The details of 
 depend on the philosophy of
the particular semi-active damper law and the physical construction of the device.
In this simple case, the schematic diagram is explicit enough that from it alone
equations for the physical system could be written easily; but often this is not the
case. A bond graph model combined with a schematic bock diagram is shown
in Figure 8.17. In this representation, it is clear that the physical system model
is completely deﬁned. Active bonds show that it is assumed that V and X can
be measured by the sensors with no signiﬁcant dynamics. The 1/s block merely
indicates that the ˙X-signal on the active bond is integrated to obtain X. (The
symbol s represents the Laplace transform generalized frequency variable, so 1/s
is the transfer function of an integrator. This is discussed in Chapter 6.) This is an
instance in which an active bond is treated exactly as a block diagram signal. The
controller has a command input X c(t), which is related to the desired ride height
and could come from another supervisory controller. (The ride height might vary
with travel speed for aerodynamic reasons or because of driver manual inputs.)
The controller output V c drives an ideal velocity source. Actuator dynam-
ics could be included if desired by replacing the ideal source with a physical

394
TRANSDUCERS, AMPLIFIERS, AND INSTRUMENTS
FIGURE 8.17. Bond graph for system of 8.16 using active bonds for controller input
and output signals.
FIGURE 8.18. Bond graph incorporating block diagram for controller.

BOND GRAPHS AND BLOCK DIAGRAMS FOR CONTROLLED SYSTEMS
395
model of the actuator—perhaps a voltage source acting on a model of an electric
motor and gearbox. Alternatively, some lag or delay might be incorporated in
the controller block diagram or algorithm to model the actuator dynamics more
accurately. The signal F c modulates the R-element representing the controlled
shock absorber. Again, engineering judgment is required to decide whether or
not actuator dynamics in the semi-active damper should be included.
To simulate the system of Figure 8.17, one would only need to represent the
bond graph without active bonds to a bond graph processor and then add to the
program the relationships relating F c and V c to V , X, and X c from a control
law such as the one shown in Figure 8.16. In fact, for that rather simple control
law, an explicit bond graph block diagram can be shown. See Figure 8.18. In this
combined diagram, virtually all relationships are clear except for the semi-active
FIGURE 8.19. Block diagram derived directly from bond graph and combined with
controller diagram.

396
TRANSDUCERS, AMPLIFIERS, AND INSTRUMENTS
damper. Here only the command force to the damper is shown, but what the
actual force will be must still be speciﬁed.
Since the bond graph of Figure 8.18 is equivalent to a block diagram, it is possible
to convert to a complete block diagram representation. As shown in Figure 8.19,
this results in a very explicit but rather complex representation because all of the
internal efforts and ﬂows are shown. Despite some theoretical advantages to such a
block diagram, few control engineers would be enthusiastic about it.
By combining some linear operations and rearranging the diagram of
Figure 8.19, a diagram more to the liking of control engineers can be developed.
It is shown in Figure 8.20. Here the command X c, response X, and disturbances
F 0 and V 0 are shown together with feedback loops from V and X in a
conventional layout. Certainly such a diagram helps one to understand the
control aspects of the system. However, the distinction between ﬁnite-power
and zero-power signals has been lost completely.
The lesson is that every system representation from schematic diagrams to
mixed bond graph signal diagrams to pure signal graphs or computational dia-
grams has its place. Success in system dynamics and control is likely to come to
those who can use all types of representations. The bond graph representation is
FIGURE 8.20. Block diagram of 8.19 simpliﬁed and rearranged into typical feedback-
controlled form.

PROBLEMS
397
of particular use to make sure that power and energy interaction are consistently
represented.
REFERENCES
[1] S. H. Crandall, D. C. Karnopp, E. F. Kurtz, and D. C. Pridmore-Brown,
Dynamics of Mechanical and Electromechanical Systems, Melbourne, FL:
Krieger, 1968.
[2] J. F. Blackburn, G. Reethof, and J. L. Shearer, Fluid Power Control, Cam-
bridge, MA: MIT Press, 1960.
[3] D. Karnopp, Active suspensions based on fast load levelers, Vehicle Syst.
Dynam., 16, No. 5–6, 335–380 (1987).
[4] D. Karnopp, Active damping in road vehicle suspension systems, Vehicle
Syst. Dynam., 12, No. 6, 291–311 (1983).
[5] D. Karnopp, M. J. Crosby, and R. A. Harwood, Vibration control using
semi-active force generators, Trans. ASME J . Eng. Ind., 96, Ser. B, No. 2,
619–626 (1974).
PROBLEMS
8-1. The diagram shows a positioning system using a separately excited dc
motor. Physical system variables and parameters are identiﬁed:
θ0 = output position angle;
ein = input voltage;
ea = output voltage of linear ampliﬁer;
ia = motor armature current;
if = motor ﬁeld current, assumed constant;
Ka = gain of linear ampliﬁer, assumed to have
no signiﬁcant time constants;
Ra = resistance of armature winding;
La = inductance of armature winding;
J = inertial load;
β = viscous–damping constant;
KT = torque constant of motor;
Kv = back–emf constant of motor
(emf = electromotive force)

398
TRANSDUCERS, AMPLIFIERS, AND INSTRUMENTS
The differential equations that govern the dynamics of the system are
J ¨θ0 + β ˙θ0 = KT ia,
La˙ia + Raia = Va −Kv ˙θ0.
(a)
Construct a bond graph for the system.
(b)
Write state-space equations, and verify that your equations are equiv-
alent to those listed above.
(c)
Compare the two methods for analyzing this system. For example,
is the system third or second order? Are K T and K v related in any
way?
8-2. Consider the seismometer sketched below:
The input is ground motion, V g(t), and an electrical transducer using a
permanent magnet moving in a coil reacts to the relative motion between
the case and the seismic mass m.
(a)
Construct a bond graph for the device, leaving the electrical port as
a free bond and neglecting coil resistance and inductance.
(b)
Assume that the device is connected to a voltage ampliﬁer, so that
i ≃0. Find the transfer function between V g(t) and e.
(c)
It is sometimes preferable to use current rather than voltage as a
signal for reasons connected with noise pickup. Suppose that a current
ampliﬁer is connected to the seismometer terminals, so that e ∼= 0.
Show that when the coil resistance is neglected, one can still ﬁnd
a transfer function between V g and i, even though the system state
equations degenerate.

PROBLEMS
399
(d)
Reconsider the case of (c) when the coil resistance Rc is not
neglected.
8-3. Consider the solenoid shown in Figure 8.7, but include the mass m of
the moving element as well as a Coulomb friction force F f , with the
constitutive law
Ff = F0 sgn V = F0V
|V | ,
where F 0 is the magnitude of the friction force. Show a bond graph for
this transducer, and write state equations for it assuming electrical linearity
and a voltage source input.
8-4. The ﬂoat shown is cylindrical and is immersed in water in a cylindrical
container. The cross-sectional area of the ﬂoat is not negligible with respect
to the tank area. The pressure P at the tank inlet is γ h, where γ is the
weight density of the water and h is the height of the water. The volume
of water, V , is the time integral of the ﬂow rate Q. If we assume that
P = P(V, x),
F = F(V, x),
what type of bond graph element is this device? Are the functions (P and
F) related in any way? Can you sketch them?
8-5. An electrostatic loudspeaker system is shown in which a high charging
voltage E and a signal voltage e(t) are applied through a current-limiting
resistor R. The moving plate or membrane may be assumed to have
effective mass m and a mechanical spring constant k. (The mechanical
spring represents the combined effect of membrane tension and the air
spring formed by the sealed cabinet.) The effect of the acoustic loading
is shown by the bond graph fragment, in which A is the effective area
of the speaker and P represents the acoustic overpressure. The I and R

400
TRANSDUCERS, AMPLIFIERS, AND INSTRUMENTS
elements may be adjusted at any single frequency to match the impedance
of the air:
Assuming the basic transducer is an electrically linear device with capac-
itance C(x) = εA/x, where ε is the dielectric constant for the air in the
cabinet, construct a bond graph for the system. Let the mechanical spring
be relaxed at x = x0 when E = 0. Write the state equations for the system,
letting the acoustic inertia and resistance be called I 1 and R2, respectively.
8-6. The basic transduction mechanism for electrical alternators and motors
may be understood by studying the ideal energy-storing transducer shown
below, consisting of a ﬁxed and a moving coil. Assume the two currents
and the torque τ are related to two ﬂux-linkage variables λ1, λ2 and the
angular position θ:
i1 = i1(λ1, λ2, θ),
i2 = i2(λ1, λ2, θ),
τ = τ(λ1, λ2, θ).

PROBLEMS
401
For the electrically linear case, it is conventional to specify self- and
mutual-inductance parameters; for example,

L1
L0 cos θ
L0 cos θ
L2
 
i1
i2

=

λ1
λ2

,
where L0, L1, L2 are constants and L1L2 ≥L2
0
(a)
What kind of bond graph element describes this device?
(b)
Derive the torque relation from the inductance matrix above by com-
puting the stored energy at ﬁxed θ when λ1 and λ2 are brought from
zero to ﬁnal values and then differentiating the energy function with
respect to θ (see Reference [1], pp. 322–323).
8-7. A model of a doorbell chime is shown that features a solenoid, return
spring, frictional force, and a striker and chime. The schematic diagram
attempts to depict the physical effects to be modeled for the case in which
the button switch is closed. Make a bond graph for the system, including
all physical effects. Let the striker–chime interaction be modeled by a
nonlinear spring with zero force until the striker contacts the chime. Write
the equations of motion for this device, assuming electrical linearity for
the solenoid. Leave your results in functional form; that is, let L(x) be the
inductance and F(x) be the striker spring force. Sketch the shape of L(x)
and F(x).
8-8. A speed control system uses a dc motor with the following parameters:
Lf = ﬁeld inductance;
Rf = ﬁeld resistance;

402
TRANSDUCERS, AMPLIFIERS, AND INSTRUMENTS
La = armature inductance;
Ra = armature resistance;
J = total moment of inertia;
B = rotary dashpot coefﬁcient;
T (if ) = transduction coefﬁcient (see Figure 8.3).
The control voltage, ei, drives an ampliﬁer that functions as a voltage-
controlled voltage source:
ei
−→Se
e0
⇀,
e0 = Gei(t).
The tachometer is a permanent-magnet device that functions as a instru-
ment, so that its mechanical bond may be activated:
1ω→−−
Kt¨GY
et⇀
it ,
et = KT ω
Write a bond graph for the system, write state equations, and ﬁnd the
transfer function between ei and ω when i a = const.
8-9. An ac bicycle generator is shown in which a small wheel of the diameter
d bears upon the bicycle wheel of diameter D. Assume the generator
functions exactly like the one shown in Figure 8.4, although in reality it
is more common for a magnet to rotate inside a ﬁxed coil. Set up a bond
graph representation that models the coil self-inductance and resistance
and the bulb resistance and that would sufﬁce to predict how the bulb
voltage would vary with forward speed,
Explain the self-regulation feature of the L–R circuit that allows the bulb
voltage to rise less than proportionally to V due to frequency response
effects.

PROBLEMS
403
8-10. It is desired to study the response of the generating system shown to
changes in throttle setting, θ(t), and load resistance, R(t). Use the bond
graph model of Figure 8.11 to represent the engine, and let the load resis-
tance be controlled by an active bond, —R −←.
Show a bond graph for the system, and write the equations of motion in
functional form. See Figure 8.3.
8-11. A simple pump is sketched in part a below. The check valves are rep-
resented by nonlinear resistors with characteristics such as that shown in
part b.
(a)
Verify the bond graph shown in part c, and compute the modulation
function f (θ).
(b)
Suppose the speed, ω = ˙θ, is essentially constant. Sketch how the
discharge ﬂow and the suction ﬂow vary as functions of time.
(c)
You should be able to see that this pump acts like an electrical half-
wave rectiﬁer circuit. Invent a pump that acts like a full-wave rectiﬁer
circuit, and show a bond graph for your pump.

404
TRANSDUCERS, AMPLIFIERS, AND INSTRUMENTS
8-12. Consider the high-performance speed control system shown below. The
idea is to drive a hydraulic pump with a shunt-wound dc motor and to
control the speed ω2 by stroking the bypass valve in a hydrostatic trans-
mission. The valve stroke is x(t), which may be changed manually or,
ultimately, automatically by a servocontrol system. The system should
have fast response, since if the valve is slammed shut, the hydraulic motor
pump will suddenly be directly coupled so that energy stored in the rotating
inertia J 1 will be available to accelerate J 2 very rapidly.
(a)
Draw a bond graph for the system including all the effects shown
in the sketch. Augment the bond graph, and list the state variables
required.
(b)
Either write out the state equations or construct a block diagram
corresponding to the bond graph. Identify the input variables to your
dynamic equations.
The basic motor characteristic is
T (if )ia = τ,
ea = T (if )ω1.
The pressure–ﬂow law for a valve depends on the stroke x, that is,
P = A(x)Q |Q| = A(x)Q2 sgn Q.
The model should include armature and ﬁeld inductance and resis-
tance. The constitutive laws for a pump and hydraulic motor are

PROBLEMS
405
(1) for a pump,
τp = αpPp,
αpωp = Qp;
(2) for a motor,
τm = αmPm,
αmωm = Qm.
Neglect leakage in the pump and motor and compressibility in the
oil lines.
8-13. In the diagram, a conventional hydropneumatic suspension system such as
those found on certain automobiles has been made active by the addition of
a valve. A simple model of the valve is indicated in which the ﬂow of oil,
Q, is simply proportional to the relative displacement of the suspension,
x. We assume a very high-pressure source of oil (not shown) so that the
valve can act as a source of ﬂow modulated by x,
→−
x SQ| 	→,
independent of the pressure in the suspension. With this system, the “static
deﬂection” of the suspension is always zero for any gain g, but as g is
increased, it is not so clear that the system will remain stable.
(a)
Find a bond graph for the system.
(b)
Decide on appropriate system inputs, and write a set of state-space
equations for the system.

406
TRANSDUCERS, AMPLIFIERS, AND INSTRUMENTS
(c)
Assuming linearized characterizations for all elements of the sys-
tem, set up an expression that will yield system eigenvalues for any
particular numerical values of parameters.
8-14. A servomechanism has been constructed by connecting a spool valve and
hydraulic ram with feedback linkage:
Using the text discussion and Figures 8.13, 8.14, and 8.15, construct a
bond graph for this device. Assume the following:

PROBLEMS
407
(a)
The force required to move the valve is Fr = F0 sgn ˙z, where F 0 =
const.
(b)
The load force is inertial and resistive, and oil compressibility is
included.
(c)
The linkage is light and frictionless and moves only through very
small angles.
(d)
The working area of the ram is A, and the supply pressure is Ps.
Using your bond graph, answer the following questions:
i.
What is the force required to move the input, and what is the
maximum load force possible?
ii.
With zero load force, what is the maximum velocity of the ram?
iii.
Write the equations of motion, leaving the valve constitutive
laws in a general functional form, for example, Qm = Qm(z,
Pm).
8-15. Add a control system block diagram to the bond graph for the motor shown
in Problem 8-1 for two cases:
(a)
A speed control system such that ein = g( ˙θc −˙θ0), in which g is a
gain and ˙θc is a command angular speed.
(b)
A position control in which ein = −g ˙θ0 + h(θc −θ0), g and h are
gains, and θc is an angular position command signal.
In each case, note the order of the controlled system. Write the state
equations for (b).
8-16. A mass–spring–damper system has an equation of motion
m¨x + b ˙x + kx = f,
where f is an applied force. A standard way to make a block diagram for
such a system results in the following:
Make a bond graph for this system and convert it directly into a block
diagram in the fashion of Figure 8.19. Then rearrange the block diagram
and show that it is equivalent to the one shown above.

408
TRANSDUCERS, AMPLIFIERS, AND INSTRUMENTS
8-17. Consider an electrically linear parallel-plate capacitor as described by
Eqs. (8.23) and (8.25). Rewrite the force law in the form
F = −q2C′
2C2 ,
C′ = dC(X)
dX
,
in analogy to the solenoid force law in Eq. (8.33).
(a)
Use Eq. (8.23) to ﬁnd the force for the case when the voltage is held
constant at the value e0 by eliminating q in favor of e0.
(b)
Using the approximate expression C(X) = εA/X mentioned below
Eq. (8.25), show that when q is constant, the force does not vary
with X under this assumption, but if the voltage is held constant, the
force does vary with X.
8-18. A butterﬂy condenser has a capacitance that varies with the angular posi-
tion of a rotor, θ, rather than with a linear position X as in Problem 8-17.
This requires a torque, τ, in analogy with the force F for a parallel-plate
capacitor. Assuming the capacitance varies with θ according to
C(θ) = C0 + C1 cos 2θ
with
C0 = 15 × 10−12F,
C1 = 10 × 10−12F,
and assuming the condenser is attached to a 1000-V source, compute the
magnitude of the torque resulting at an angle when it is a large as possible.
8-19. An inertial actuator is a device in which, by appropriate acceleration of an
internal mass, a prescribed reaction force can be generated. By attaching
the actuator to a structure, the structure motion can be controlled.
ec control voltage
Permanent magnet
Flux density, B
Coil length, L
v1
v2
m
b
FR
k
neglect magnet mass
The device shown is voice coil driven, where only the winding resistance
is important on the electrical side. The mass m is attached to the base with
spring k and damper b.

PROBLEMS
409
Here, F R is the output force. Assume the base has prescribed motion,
v2(t). Construct a bond graph model and derive state equations. Derive
the output equation for F R.
8-20. From the state equations of Problem 8-19, derive the transfer functions
relating F r to v2 and F r to ec. Derive
Fr
v2
= GFv(s)
and
Fr
ec
= GFc(s).
8-21. Since Problem 8-19 is treated as a linear system, we can express the output
force in terms of the transfer functions from Problem 8-20 as
FR(s) = GFvv2 + GFcec.
Sometimes we desire the reaction force to mimic the effect of a damper
attached between the base and inertial ground. In other words, we desire
FR = bcv2,
where bc is a controller gain. Derive the ideal control ﬁlter that will yield
the desired reaction force from the inherent dynamics of the device.
8-22. Shown below is the device from Problem 8-19 attached to a structure
consisting of a mass, ms, spring, ks, and damper, bs. A force, F d, acts
upon the structure mass. Construct a bond graph model for this total system
and derive state equations.
ec
v2
v1
Fd
m
ms
b
k
bs
ks

410
TRANSDUCERS, AMPLIFIERS, AND INSTRUMENTS
Derive the open-loop (ec = 0) transfer function relating output, v2, to
input, F d. Using the control transfer function from Problem 8-21, derive
the closed-loop transfer function between v2 and F d. Does the result have
a component similar to a damper to ground?
8-23. Repeat Problems 8-19 through 8-22, but assume that the voice coil is
current driven, i c, rather than voltage driven.

9
MECHANICAL SYSTEMS
WITH NONLINEAR GEOMETRY
Bond graphs straightforwardly indicate, through causality assignment, the state
variables appropriate for the system model. But we know that algebraic loops and
derivative causality may exist. Methods of dealing with these problems were pre-
sented in Chapter 5. However, some algebraic problems may be so complicated,
involving so many variables in nonlinear functions, that a computable version
of the model is virtually impossible to formulate unless the model is carefully
constructed.
This chapter deals with multidimensional rigid-body mechanics and the inclu-
sion of such complex mechanical elements in overall system models. Geometric
nonlinearities are common in such systems and are notorious for causing equation
formulation problems. It turns out that it is possible to cast rigid-body mechanics
into a bond graph format such that the resulting bond graph fragment can readily
be used in the construction of overall models.
This chapter starts out with a general exposition of a bond graph representa-
tion of three-dimensional rigid-body dynamics in which the complexities of the
geometric nonlinearities of mechanical systems is made evident. There follow
several methods for representing mechanical subsystems in bond graph terms.
The desired form for these models is presented, although sometimes algebraic
difﬁculties make the achievement of the this form difﬁcult. Next, the problems
that arise when several rigid bodies are rigidly connected (the multibody prob-
lem) is discussed and ways to circumvent formulations problems using inserted
compliance elements is discussed. Then, the use of IC-ﬁelds to represent system
described with Lagrange equations is presented. This technique is particularly
suited to complex multibody subsystems. Finally, the application to bond graph
modeling in the study of vehicle dynamics is presented. Vehicle systems are
an example of the engineering use of nonlinear mechanics, although there are
many others. Starting with a rigid body vehicle model, one can add suspension
411
System Dynamics: Modeling, Simulation, and Control of Mechatronic Systems, Fifth Edition
Dean C. Karnopp, Donald L. Margolis and Ronald C. Rosenberg
Copyright © 2012 John Wiley & Sons, Inc.

412
MECHANICAL SYSTEMS WITH NONLINEAR GEOMETRY
components, tires, engines and engine mounts, brakes, and so on in a manner
that is the computational equivalent to bolting the hardware together.
The theory presented in this chapter is not simple. However, with some per-
sistence the reader will be rewarded with the ability to construct reasonably
low-order system models that include three-dimensional motion of rigid bodies
and yet are straightforwardly formulated into state equations, ready for compu-
tation.
9.1
MULTIDIMENSIONAL DYNAMICS
Figure 9.1 shows a general rigid body both translating and rotating in space.
Inertial axes X, Y , Z are shown as well as the x, y, z axes, which are attached to
the body, at its center of mass, and aligned with the principal axes of the body.
With respect to these body-ﬁxed coordinates, the rotational inertial properties
remain invariant and the products of inertia are all zero. While these body-ﬁxed
coordinates are not the best from which to view the body motion, they are
practical coordinates for the computation of body motion.
At the instant shown, the body has absolute velocity v and absolute angu-
lar velocity ω. These vectors have been cast into three mutually perpendicular
FIGURE 9.1. Body in general 3-D motion.

MULTIDIMENSIONAL DYNAMICS
413
components: vx, vy, vz and ωx, ωy, ωz. According to Newton’s law, the net force
F acting on the body changes its momentum:
F = d
dt p,
(9.1)
where the momentum is related to the velocity of the center of mass,
p = mv.
(9.2)
If v is expressed with respect to the rotating body centered frame, see Ref [1],
then
F = ∂p
∂t

rel
+ ω × p,
(9.3)
where
∂p
∂t

rel indicates the rate of change of momentum relative to the moving
frame.
An angular momentum law analogous to Eq. (9.1) can be derived if the net
torque acting on the body τ and the angular momentum h are evaluated with
respect to either a ﬁxed point, if one exists for the body, or the center of mass,
τ = d
dth.
(9.4)
If the x –y –z axis system is assumed to be aligned with the principal axes of the
body, then the angular momentum is related to the angular velocity by
h = Jω,
(9.5)
in which J is a diagonal matrix of the principal moments of inertia, Jx, Jy, Jz.
For h expressed with respect to the rotating body centered frame,
τ = ∂h
∂t

rel
+ ω × h.
(9.6)
Using the right-hand rule, it is straightforward to write down the component
equations for (9.3) and (9.6). They are
Fx = m˙vx + mωyvz −mωzvy,
(9.7)
Fy = m˙vy + mωzvx −mωxvz,
(9.8)
Fz = m˙vz + mωxvy −mωyvx
(9.9)
and
τx = Jx ˙ωx + ωyJzωz −ωzJyωy,
(9.10)
τy = Jy ˙ωy + ωzJxωx −ωxJzωz,
(9.11)
τz = Jz ˙ωz + ωxJyωy −ωyJxωx.
(9.12)

414
MECHANICAL SYSTEMS WITH NONLINEAR GEOMETRY
These nonlinear differential equations are known as Euler’s equations. They have
no general solution and can only be solved analytically for some special cases.
If they were solved, then we would know vx, vy, vz, ωx, ωy, ωz, with respect to
a frame that will be aiming in a different direction at every instant, which makes
interpreting the body motion a bit difﬁcult. Furthermore, the force and torque
components (coming from attached systems) must be aligned with the body-
ﬁxed coordinates in order to use these equations. This rarely occurs naturally, so
the utility of these equations is questionable at this stage of development.
If we treat the cross-product terms as forces in Eqs. (9.7), (9.8), and (9.9) and
as torques in Eqs. (9.10), (9.11), and (9.12), then an elegant bond graph repre-
sentation results for translation and rotation, as shown in Figure 9.2. The reader
should add the forces and torques at the respective 1-junctions and be convinced
that Euler’s equations are, in fact, represented by these bond graph fragments.
These gyrator ring constructions appropriately introduce the momenta px, py, pz
and angular momenta pJx, pJy, pJz as state variables. The modulated gyrator
FIGURE 9.2. Bond graphs for 3-D rigid-body motion.

MULTIDIMENSIONAL DYNAMICS
415
(—MGY —) elements represent the cross-product terms in Eqs. (9.7)–(9.12),
and the gyrator moduli are time varying and depend on the angular momentum
state variables.
As long as external forces Fx, Fy, Fz and torques τx, τy, τz, are causal inputs
to the bond graph fragments, integral causality exists for all I -elements. If we
agree to always use these fragments with forces and torques as causal inputs and
with velocities and angular velocities as causal outputs, then we can write the
state equations, once and for all, for these submodels, ready to be appropriately
connected to any external systems in the process of constructing an overall model.
We make this agreement, and write the state equations as
˙px = Fx + mωz
py
m −mωy
pz
m ,
(9.13)
˙py = Fy + mωx
pz
m −mωz
px
m ,
(9.14)
˙pz = Fz + mωy
px
m −mωx
py
m ,
(9.15)
˙pJx = τx + Jyωy
pJz
Jz
−Jzωz
pJy
Jy
,
(9.16)
˙pJy = τy + Jzωz
pJx
Jx
−Jxωx
pJz
Jz
,
(9.17)
˙pJz = τz + Jxωx
pJy
Jy
−Jyωy
pJx
Jx
,
(9.18)
where
ωx = pJx /Jx,
(9.19)
ωy = pJy /Jy,
(9.20)
ωz = pJz /Jz.
(9.21)
A shorthand notation for the bond graphs of Figure 9.2 is shown in Figure 9.3.
FIGURE 9.3. Shorthand representation of 3-D rigid-body mechanics.

416
MECHANICAL SYSTEMS WITH NONLINEAR GEOMETRY
9.1.1
Coordinate Transformations
Since it is unlikely that external forces and torques will be conveniently lined up
with the continuously changing principal directions, and since the body motion
is difﬁcult to interpret with respect to the body-ﬁxed coordinates, it is necessary
to transfer from body-ﬁxed coordinates to other more convenient frames through
a series of coordinate transformations. There are many possible coordinate trans-
formations that can take us from body-ﬁxed coordinates to inertial coordinates,
the most familiar probably being the transformation involving Euler angles. The
transformation used depends largely on the system being analyzed: Spinning bod-
ies of revolution, typical of gyroscopic motion, are most conveniently analyzed
using Euler angles, while multibody systems, such as robotic arms, often some
use other transformations.
The concept of a coordinate transformation will be developed here using
ground vehicles as an example, and we shall introduce the Cardan angles, which
correspond to the familiar yaw, pitch, and roll angles of an automobile. Figure 9.4
shows an inertial frame (X, Y , Z), a body-ﬁxed frame (x, y, z), and two inter-
mediate frames (x′, y′, z′ and x′′, y′′, z′′). The body-ﬁxed frame is arrived at by
ﬁrst rotating about Z through angle ψ (yaw), yielding the frame x′, y′, z′. We
next rotate about the y′-axis through the angle θ (pitch), yielding the x′′, y′′, z′′
axes. Finally, we rotate about the x′′-axis through the angle φ (roll), yielding the
instantaneous body-ﬁxed frame, x, y, z.
Let us now assume that body-ﬁxed angular velocities ωx, ωy, ωz are known
(outputs, by agreement, from the gyrator-ring bond graph fragments), and write
down the angular velocity components in the intermediate frames and ﬁnally in
the inertial frame:
ωx′′ = ωx,
(9.22)
ωy′′ = ωy cos φ −ωz sin φ,
(9.23)
ωz′′ = ωy sin φ + ωz cos φ;
(9.24)
ωx′ = ωx′′ cos θ + ωz′′ sin θ,
(9.25)
ωy′ = ωy′′,
(9.26)
ωz′ = −ωx′′ sin θ + ωz′′ cos θ;
(9.27)
ωX = ωx′ cos ψ −ωy′ sin ψ,
(9.28)
ωY = ωx′ sin ψ + ωy′ cos ψ,
(9.29)
ωZ = ωz′.
(9.30)
We can write these relationships in matrix form as
⎡
⎣
ωx′′
ωy′′
ωz′′
⎤
⎦=
⎡
⎣
1
0
0
0
cos φ
−sin φ
0
sin φ
cos φ
⎤
⎦
⎡
⎣
ωx
ωy
ωz
⎤
⎦,
(9.31)

MULTIDIMENSIONAL DYNAMICS
417
FIGURE 9.4. Cardan angle coordinate transformations.
⎡
⎣
ωx′
ωy′
ωz′
⎤
⎦=
⎡
⎣
cos θ
0
sin θ
0
1
0
−sin θ
0
cos θ
⎤
⎦
⎡
⎣
ωx′′
ωy′′
ωz′′
⎤
⎦,
(9.32)
⎡
⎣
ωX
ωY
ωZ
⎤
⎦=
⎡
⎣
cos ψ
−sin ψ
0
sin ψ
cos ψ
0
0
0
1
⎤
⎦
⎡
⎣
ωx′
ωy′
ωz′
⎤
⎦.
(9.33)

418
MECHANICAL SYSTEMS WITH NONLINEAR GEOMETRY
Thus, if we know ωx, ωy, ωz, then we can determine the angular velocity compo-
nents in all frames, including the inertial frame. If we denote the transformation
matrices as
 =
⎡
⎣
1
0
0
0
cos φ
−sin φ
0
sin φ
cos φ
⎤
⎦,
(9.34)
	 =
⎡
⎣
cos θ
0
sin θ
0
1
0
−sin θ
0
cos θ
⎤
⎦,
(9.35)

 =
⎡
⎣
cos ψ
−sin ψ
0
sin ψ
cos ψ
0
0
0
1
⎤
⎦,
(9.36)
then
⎡
⎣
ωX
ωY
ωZ
⎤
⎦= 
	
⎡
⎣
ωx
ωy
ωz
⎤
⎦.
(9.37)
It should be realized that the exact same relationship exists for transforming
velocity components in the body-ﬁxed directions to velocity components in the
inertial directions. Thus,
⎡
⎣
vX
vY
vZ
⎤
⎦= 
	
⎡
⎣
vx
vy
vz
⎤
⎦.
(9.38)
This transformation from body-ﬁxed components to inertial components is a
power-conserving transformation and is shown as a bond graph in Figure 9.5.
The modulated transformers, —MTF—, indicate the three transformations , ,
, which take the body-ﬁxed velocity and angular velocity components through
the intermediate frames and produce the inertial velocity and angular velocity
components.
We now make use of the power-conserving nature of this transformation of
coordinates. Since no energy is stored or dissipated by the transformation, power
must be instantaneously conserved. This was shown in Chapter 7 to result in the
following relationship among the forces and torques:
⎡
⎣
Fx
Fy
Fz
⎤
⎦= (
	)t
⎡
⎣
FX
FY
FZ
⎤
⎦,
(9.39)
⎡
⎣
τx
τy
τz
⎤
⎦= (
	)t
⎡
⎣
τX
τY
τZ
⎤
⎦,
(9.40)

MULTIDIMENSIONAL DYNAMICS
419
FIGURE 9.5. Bond graph of coordinate transformation.
or
⎡
⎣
Fx
Fy
Fz
⎤
⎦= t	t
t
⎡
⎣
FX
FY
FZ
⎤
⎦,
(9.41)
⎡
⎣
τx
τy
τz
⎤
⎦= t	t
t
⎡
⎣
τX
τY
τZ
⎤
⎦.
(9.42)
Thus, the transformation indicated in Figure 9.5 not only transforms the body-
ﬁxed velocities and angular velocities to inertial components; it also transforms
inertial forces and torques into the body-ﬁxed directions. This bilateral transfor-
mation is indicated by the causality in Figure 9.5.
Let us agree to always use the coordinate transformation of Figure 9.5 with
the causality shown. With this agreement we can now connect the bond graph of
Figure 9.5 to the rigid-body dynamics of Figure 9.3, and we now have the capa-
bility of formulating a complete state representation of 3-D rigid-body dynamics.

420
MECHANICAL SYSTEMS WITH NONLINEAR GEOMETRY
This model can accept forces and torques in inertial coordinate directions, prop-
erly align these efforts into the instantaneous principal directions, and then,
through integration of ﬁrst-order equations, deliver velocities and angular veloc-
ities in principal directions and transform these to inertial directions. This is a
very nice package.
We should note that the angles φ, θ, and ψ are needed to perform the coordi-
nate transformations. It is relatively simple to relate ˙φ, ˙θ, and ˙ψ to the body-ﬁxed
components ωx, ωy, and ωz. From Figure 9.4,
ωx = ˙φ −˙ψ sin θ,
(9.43)
ωy = ˙θ cos φ + ˙ψ cos θ sin φ,
(9.44)
ωz = −˙θ sin φ + ˙ψ cos θ cos φ.
(9.45)
Equations (9.44) and (9.45) can be solved for ˙θ and ˙ψ:
˙θ = cos φ ωy −sin φ, ωz,
(9.46)
˙ψ = sin φ
cos θ ωy + cos φ
cos θ ωz.
(9.47)
Then, from (9.43),
˙φ = ωx + sin φ sin θ
cos θ ωy + cos φ sin θ
cos θ ωz.
(9.48)
Equations (9.46), (9.47), and (9.48) are three additional state equations that must
be integrated along with the others so that φ, θ, and ψ are continuously available
as modulating variables.
A very nice shorthand notation for the rigid-body mechanics and coordinate
transformation is shown in Figure 9.6. For computational purposes, the building
blocks of Figure 9.6 could not be better organized, or more ready for interaction
with external dynamic systems. However, remember our agreement. The causality
shown in Figures 9.3 and 9.6 must be maintained.
9.2
KINEMATIC NONLINEARITIES IN MECHANICAL DYNAMICS
This section is addressed to the following problem: Given a schematic repre-
sentation of a mechanical system plus accompanying verbal and mathematical
descriptions of the parts, ﬁnd a convenient way to model the system so as to
predict its dynamic behavior.
The importance of the problem hardly needs emphasizing. It has been worked
on in essentially modern form at least since the time of Newton and has attracted
the attention of many notable scientists, including Hamilton and Lagrange. The
development since the time of Newton has relied, not upon pictorial or graphical

KINEMATIC NONLINEARITIES IN MECHANICAL DYNAMICS
421
FIGURE 9.6. Shorthand bond graph for the complete 3-D mechanics plus coordinate
transformation.
representation, but upon analytically oriented notation in the form of operators
and equations of various types. Since we now know how to formulate mechanics
problems in a variety of ways, it is fair to say that the basic problem has been
solved [1, 2].
The principal purpose of this section is to present and develop the use of certain
bond graph forms as standard models in mechanics, thereby bringing the study

422
MECHANICAL SYSTEMS WITH NONLINEAR GEOMETRY
of this very important class of generally nonlinear problems into the multiport-
systems pattern. We shall study mechanical systems involving the large-scale
motion of particles and rigid bodies. A variety of techniques are used, including
the selection by the modeler of key variables for formulation, the determination of
certain required transformations by simple analytic means, and the combination
of all the parts into a uniﬁed representation by a bond graph.
The development begins with the simplest type of system, involving straight-
forward coupling between inertial and compliance elements.
9.2.1
The Basic Modeling Procedure
Let us start by considering the result we would like to achieve. For a given
problem in mechanics involving particles, rigid bodies, and elastic elements, we
wish to obtain a set of ﬁrst-order differential equations in terms of variables that
yield physical insight into system behavior. We anticipate that the equations will
be coupled and, if possible, explicit (i.e., one derivative in each equation), having
the following form:
C-ﬁeld:
fC = φC(qC),
(9.49)
I-ﬁeld:
vI = φI (pI ),
(9.50)
Junction structure:
˙qC = [TCI(qC)]vI
(9.51)
˙pI = [−Tt
CI(qC)]fC,
(9.52)
where fC is the set of efforts deﬁning the potential co-energy, qC is the set of
displacements deﬁning the potential energy, vI is the set of (inertial) velocities
or ﬂows deﬁning the kinetic co-energy; pI is the set of momenta deﬁning the
kinetic energy, and ˙qC and ˙pI are the time derivatives of qC and pI , respectively.
Inspection of the equations indicates that Eq. (9.49) arises directly from the
compliance elements’ constitutive laws. The set of relations may be linear or
nonlinear and coupled or decoupled according to the nature of the C-ﬁeld.
Equation (9.50) is obtainable directly from the inertia elements in the system.
The vector vI is deﬁned with respect to an inertial frame and represents trans-
lational velocities of the centers of mass of rigid bodies and angular velocities
with respect to nonrotating coordinate systems.
Typically, the most difﬁcult aspect of mechanics is the generally nonlinear cou-
pling of C-ﬁelds and I -ﬁelds introduced by the geometry of large-scale motions.
Such coupling is represented in Eqs. (9.51) and (9.52) by the transformation
array TCI(qC) and its transpose, and in bond graphs by multiport displacement-
modulated transformers as discussed in Section 7.5. For now, let us assume that
each element of TCI is, in principle, a scalar function of all the elements of the
vector qC.
Before we discuss an example, let us observe that Eqs. (9.49)–(9.52) may be
combined to eliminate fC and vI , giving
˙qC = [TCI(qC)]I (pI ),
(9.53)

KINEMATIC NONLINEARITIES IN MECHANICAL DYNAMICS
423
FIGURE 9.7. Symbolic bond graph model of basic nonlinear conservative system:
(a) coupled C- and I -ﬁelds; (b) 1-port C- and I -ﬁelds.
˙pI = [−Tt
CI(qC)]C(qC).
(9.54)
These are the equations of a nonlinear conservative system expressed in terms of
state variables qC and pI . They can be modiﬁed easily to include nonconservative
force effects.
Bond graph models representing the type of system discussed thus far are
shown in Figure 9.7. The compliances are represented by the coupled C-ﬁeld in
part a and the “M ” C-elements in part b. The inertias are represented by the
coupled I -ﬁeld in part a and the “P” I -elements in part b. The transformation
coupling is represented by the M -port × P-port MTF element, and the 1-junctions
are introduced for the sake of clarity and to allow a “through” sign convention
for the MTF. Notice that the moduli of the MTF depend on the vector qC.
As an illustration of the type of formulation in which we are interested, con-
sider the nonlinear oscillator of Figure 9.8a. The mass is free to slide on the rod
and is constrained by a spring. A second spring constrains the rod as it rotates
in the X –Y plane. Key geometric variables are identiﬁed in part b as r, θ, x, y,
vx, and vy. Constitutive relations for the linear springs and inertias, in the form
of Eqs. (9.49) and (9.50), are given by Eqs. (9.55) and (9.56), respectively:
F = k1 (r −R) ,
(9.55a)
τ = k2θ,
(9.55b)
vx = m−1px,
(9.56a)
vy = m−1py,
(9.56b)

424
MECHANICAL SYSTEMS WITH NONLINEAR GEOMETRY
FIGURE 9.8. A nonlinear mechanical oscillator: (a) schematic diagram; (b) key geo-
metric quantities deﬁned; (c) bond graph model.
where R is the free length of the rod spring, F is the rod spring force, τ is the
torque of the torsional spring on the rod about an axis through the origin normal
to the X –Y plane, and k1 and k2 are spring constants. Both the C-ﬁeld and the
I -ﬁeld are linear and decoupled.
If we identify r and θ as elements of the vector qC, and vx and vy as ele-
ments of the vector vI , the array TCI(qC) may be found by studying the velocity
components as shown in Section 7.5,
˙r = (sin θ)vx + (cos θ)vy,
(9.57a)
˙θ =
cos θ
r

vx +

−sin θ
r

vy,
(9.57b)

KINEMATIC NONLINEARITIES IN MECHANICAL DYNAMICS
425
and
TCI(qC) =
⎡
⎣
sin θ
cos θ
cos θ
r
−sin θ
r
⎤
⎦.
(9.58)
It remains for us to calculate ˙pI in terms of the spring forces. By appropriate
resolution of the force F and torque effect τ in the directions of X and Y (i.e.,
px and py), we obtain
˙px = (−sin θ)F +

−cos θ
r

τ,
(9.59a)
˙py = (−cos θ)F +
sin θ
r

τ + mg.
(9.59b)
Careful inspection of Eqs. (9.59) shows that indeed the transformation array
TCI(qC) is embedded as the negative transpose, namely,
−Tt
CI(qC) =
⎡
⎢⎣
−sin θ
−cos θ
r
−cos θ
sin θ
r
⎤
⎥⎦.
(9.60)
The inﬂuence of gravity is merely added in the appropriate way (i.e., to directly
inﬂuence py) and is shown in Figure 9.8c as an effort source, SE.
At this point, the thoughtful reader might well ask, “If we have obtained
TCI(qC) as in Eq. (9.58) once, is it really necessary to obtain it by separate
development again, as in Eq. (9.60)?” The answer is no, and a systematic pro-
cedure that takes note of this result is the next topic. First we should combine
Eqs. (9.57) and (9.59), eliminating F, τ, vx, and vy by Eqs. (9.55) and (9.56).
The system state equations are
˙r = (sin θ)m−1px + (cos θ)m−1py,
(9.61a)
˙θ =
cos θ
r

m−1px +

−sin θ
r

m−1py,
(9.61b)
˙px = (−sin θ)k1(r −R) +

−cos θ
r

k2θ,
(9.61c)
˙py = (−cos θ)k1(r −R) +
sin θ
r

k2θ + mg.
(9.61d)
A bond graph representation of the complete system is given in Figure 9.8c. The
ﬁelds are shown explicitly, and the junction-structure transformation is implied
by the two-by-two MTF. The minus signs in Eqs. (9.59) and (9.60) arise because
of the sign conventions at the 1-junctions at the right side of Figure 9.8c.

426
MECHANICAL SYSTEMS WITH NONLINEAR GEOMETRY
Deﬁnitions of Key Geometric Quantities. As the ﬁrst step in specifying a pro-
cedure for constructing bond graph models in mechanics, we must identify key
variables. The approach of this chapter is geometric, meaning that we shall use
displacement and velocity quantities to organize the system, with forces and
momenta constrained by MTFs.
Two key vectors have already been described. They are qC, the vector of
displacements that deﬁne the potential energy, and vI , the vector of velocities
that deﬁne the kinetic co-energy. The vector qC is directly associated with the
C-ﬁeld, and the vector vI with the I -ﬁeld.
If it were always possible to relate vI to ˙qC in terms of qC as nicely as
was done in the previous example, then mechanics problems would not be the
bˆete noire they typically are. It is often the case that there are more velocities
and displacements in the problem than the coupling constraints permit to be
independent. To treat this situation, it will be useful to identify another vector,
qk, the kinematic displacement vector or generalized coordinate vector in the
language of Lagrangian mechanics. Basically, the elements of qk are necessary
and sufﬁcient to ﬁx the conﬁguration of the system at any instant. Therefore,
the vector qC can be found in terms of qk, and the necessary velocity relations
for ˙qC can be suitably evaluated, as we show next. Furthermore, if the vector
˙qk represents a necessary and sufﬁcient set of velocities to ﬁx all the motions at
any instant, then the system is holonomic.∗We shall consider only holonomic
systems here, but a slight extension to the development would permit treatment
of nonholonomic systems. If qk describes all motions, then the vector vI must
be expressible in terms of ˙qk, given qk.
Therefore, the modeling process begins with the identiﬁcation of three key
geometric vectors: qk, the vector of kinematic displacements, or generalized
coordinates; qC, the vector of C-ﬁeld displacements; and vI , the vector of I -ﬁeld
velocities.
In Figure 9.8b the kinematic displacement vector could have been chosen to
contain (r, θ) or (x, y), or even other pairs, such as (θ, x). Notice that if
qk =

r
θ

,
then
qk = qC =

r
θ

,
that is, qk would be identical to qC. That would be convenient for many reasons.
On the other hand, if
qk =

x
y

,
∗See, for example, Reference [4].

KINEMATIC NONLINEARITIES IN MECHANICAL DYNAMICS
427
then
˙qk =

˙x
˙y

=

vx
vy

= vI ,
that is, ˙qk would be identical to vI . That would be convenient for many reasons,
too. To a signiﬁcant extent, the wise choice of qk to balance the “needs” of qC
and vI can ease the formulation of equations for a complicated system. In this
regard, experience is the best teacher. It is an important aspect of the method
being presented that a range of choices and some of their implications are made
available in clear fashion.
As an example of a problem involving some signiﬁcant choices, consider the
spring–pendulum system shown in Figure 9.9a. The pivot point of the pendulum
is constrained to slide on the Y -axis. The pendulum swings in the XY -plane.
A number of geometric quantities are shown in Figure 9.9b.
The conﬁguration of the system can be speciﬁed at any instant by the position
of the pivot (yk) and the angle of the pendulum (α). Other choices are possible,
such as ym and α. However, let us use
qk =

yk
α

.
(9.62)
The potential energy of the system resides in the spring, and ys is an obvious
way to specify it. Hence,
qC =

ys

.
(9.63)
Finally, the kinetic co-energy is associated with the particle (the rod being
assumed massless), so
vI =

vx
vy

.
(9.64)
FIGURE 9.9. A mass–spring oscillator example: (a) schematic diagram; (b) key geo-
metric quantities.

428
MECHANICAL SYSTEMS WITH NONLINEAR GEOMETRY
FIGURE 9.10. Explicit bond graph model for the mass–spring oscillator. (a) key geo-
metric variable sets; (b) insertion of the transformations TCk and TIk.
A bond graph identifying the variables and the C- and I -ﬁelds is shown in
Figure 9.10a. It will become standard practice to write a column of 1-junctions
for ˙qC, a column for ˙qk, and a column for vI . The next steps are to develop
transformation relations among the vectors and to represent them in the bond
graph.
Calculating Velocity Transformations. One way to calculate velocity transforma-
tions is ﬁrst to write displacement relations and then to differentiate them [5].
The relations between qk and qC may be written as
qC = φCk(qk),
(9.65)
where φCk is a set of relations deﬁning each element of qC in terms of the
elements of qk. By differentiating each relation in Eq. (9.65) with respect to
time, we get
˙qC = ∂φCk(qk)
∂qk
˙qk = TCk(qk)˙qk.
(9.66)
The ith relation is
˙qCi =
N

j=1
∂φCki
∂qkj
˙qkj,
(9.67)
where there are N displacements in qk.

KINEMATIC NONLINEARITIES IN MECHANICAL DYNAMICS
429
For example, in the pendulum problem of Figure 9.9, qC is related to qk as
follows, where the vectors are given by Eqs. (9.62) and (9.63):
ys = 1yk + 0α;
(9.68)
then
˙ys = 1 ˙yk + 0˙α
(9.69)
and
TCk(qk) = [1
0].
(9.70)
In this case, TCk does not depend on qk explicitly.
As the next step, we express the inertia–velocity vector vI in terms of qk and
˙qk, thereby obtaining TIk(qk). Generally, it is easiest to do this by ﬁrst creating
an inertia–displacement vector qI , chosen so that
˙qI = vI .
(9.71)
Then, we may write
qI = φIk(qk),
(9.72)
from which we can calculate vI as
vI = ˙qI =
∂φIk
∂qk

˙qk = [TIk(qk)]˙qk.
(9.73)
The ith relation is
vIi =
N

j=1
∂φIki
∂qkj

˙qkj,
(9.74)
where there are N elements in qk.
In the pendulum example, we may write
qI =

x
y

and
˙qI = vI =

˙x
˙y

=

vx
vy

,
so qI is related to qk by
x = A sin α,
(9.75a)
y = yk + A cos α.
(9.75b)
From Eqs. (9.75) we obtain TIk by differentiating, namely,
vx = ˙x = (0) ˙yk + (A cos α)˙α,
(9.76a)
vy = ˙y = (1) ˙yk + (−A sin α)˙α,
(9.76b)

430
MECHANICAL SYSTEMS WITH NONLINEAR GEOMETRY
and
TIk(qk) =

0
A cos α
1
−A sin α

.
(9.77)
In this case, the transformation depends on one element of qk, that is, α.
Establishing the Junction Structure. Since the basic pattern of both the trans-
formations TCk and TIk is that the elements of ˙qk are multiplied by constants or
functions of qk and added together, we may represent these transformations by
0-junctions and 2-port MTFs. The MTFs are used to multiply by the appropriate
function, and the 0-junctions are used to add up velocity terms, as was discussed
in Section 7.5.
Referring to the partial bond graph of Figure 9.10a, TCk and TIk of Eqs.
(9.70) and (9.77) are introduced in the graph of Figure 9.10b between the
appropriate sets of 1-junctions. We now have a basic bond graph model of the
spring–pendulum system of Figure 9.9a.
Now consider that we wish to add two more dynamic effects—dissipation in
the pivot joint and a gravity force. The dissipation torque arises directly from
the relative motion ˙α and is shown by the R-element appended to that junction
in Figure 9.11. The gravity force acts on vy and is appended directly to the
vy-junction as a constant source of force of magnitude mg. We observe that
the ﬁelds C and R can be linear or nonlinear. The junction structure is often
nonlinear due to the geometric coupling represented by MTF moduli. In practice,
the difﬁculty of generating state equations depends somewhat upon the nature of
the nonlinearities [6].
The bond graph model of Figure 9.11 has been reproduced in Figure 9.12a
with MTFs having zero moduli eliminated. In part b, additional simpliﬁcations
have been made, and causality has been added. In this case, we have been lucky
and there are no algebraic loops or cases of derivative causality. The one pecu-
liarity is that α is not a state variable in the C-ﬁeld and yet is necessary because
FIGURE 9.11. The mass–spring oscillator of Figure 9.4 with dissipation and gravity
effects added.

KINEMATIC NONLINEARITIES IN MECHANICAL DYNAMICS
431
FIGURE 9.12. Simpliﬁcation of the oscillator bond graph: (a) MTFs with zero modulus
removed; (b) further simpliﬁcation of the graph.
of the MTFs. The causal strokes show that ˙α can be found from px by inverting
Eq. (9.76a). The C-, I -, and R-ﬁeld relations are
f = k (ys −Y)
(spring),
(9.78a)
vx = m−1px
(mass),
(9.78b)
vy = m−1py
(mass),
(9.78c)
τ = R ˙α
(dissipation),
(9.78d)
respectively, where Y is the free length of the spring in Eq. (9.78a), m is the
mass in Eqs. (9.78b,c), and R of Eq. (9.78d) is the viscous dissipation parameter
in the joint.
The connection or junction–structure relations are, in initial form,
˙px = (−tan α)f −
R
A cos α ˙α,
(9.79a)
˙py = −f + mg,
(9.79b)
˙yk = (tan α) vx + vy,
(9.79c)
˙α =
1
A cos a vx.
(9.79d)

432
MECHANICAL SYSTEMS WITH NONLINEAR GEOMETRY
If we use Eqs. (9.78) to eliminate f , τ, vx, and vy from Eqs. (9.79), we get a
momentum–displacement set of state equations:
˙px = (−tan α)k(yk −Y) −
Rm−1
(A cos α)2 px,
(9.80a)
˙py = −k(yk −Y) + mg,
(9.80b)
˙yk = (tan α)m−1px + m−1py,
(9.80c)
˙α =
1
A cos α m−1px.
(9.80d)
One could eliminate px in terms of vx and vy, to get a velocity–displacement
set of equations,
˙vx = (−tan α) k
m(yk −Y) −
R
m(A cos α)2 vx,
(9.81a)
˙vy = −k
m(yk −Y) + g,
(9.81b)
˙yk = (tan α)vx + vy,
(9.81c)
˙α =

1
A cos α

vx.
(9.81d)
Summary of the Procedure. The procedure for obtaining a bond graph model
may be summarized in the following series of steps.
1. Identify the key vectors, qk, qC, and vI (or qI ). Write the 1-junctions cor-
responding to ˙qk, ˙qC, and vI .
2. Obtain the displacement transformation relating qC to qk. Differentiate with
respect to time to obtain a velocity transformation relating ˙qC to ˙qk in terms
of qk. Then
˙qC = TCk(qk)˙qk.
Write the results into the bond graph using MTF and 0-junction elements.
3. Obtain the velocity transformation relating vI to ˙qk. Do this directly, or by
relating qI to qk and differentiating with respect to time (being sure that
˙qI = vI ). Then
vI = TIk(qk)˙qk.
Write the results into the bond graph using MTF and 0-junction elements.
4. Append the C-ﬁeld and I -ﬁeld elements to the ˙qC and vI junctions as
indicated.
5. Append dissipation effects, force sources, and geometric constraints not yet
included, as appropriate. If necessary construct additional velocities, using
the transformational method.

KINEMATIC NONLINEARITIES IN MECHANICAL DYNAMICS
433
6. Simplify the bond graph by removing MTFs with zero modulus, making
MTFs with unit modulus into direct bonds, and combining 2-port junctions,
when power directions permit.
The procedure outlined above is often successful at deriving a bond graph that
will yield state equations fairly easily, but it also can lead to a bond graph with
algebraic loops or derivative causality. For example, a little experimentation with
the general bond graph for the example shown in Figure 9.11 will reveal that
when integral causality is applied using the sequential causal assignment proce-
dure, arbitrary causality must be assigned to some MTF bonds. This indicates
an algebraic loop problem. This did not happen in Figure 9.12 because two
zero-modulus MTFs could be eliminated.
A particularly vexing problem occurs whenever two rigid bodies are con-
strained in a nonﬂexible way. The constraint might be enforced by a pin joint
between the bodies or the bodies might be forced to slide on one another in
some way, for example. In any case, the degrees of freedom of the two bod-
ies are reduced by the constraints, and this always leads to derivative causality
which can be particularly difﬁcult because geometric nonlinearities are typically
involved.
In three dimensions, a rigid body has six degrees of freedom, represented by
the six inertial elements in Figure 9.2. When two bodies are connected rigidly,
the three linear and three angular velocities for the two bodies cannot all be
independent, meaning that not all the I -elements can have integral causality. In
the simpler case of plane motion, rigid bodies have only three degrees of freedom,
but again whenever two bodies are linked, derivative causality will arise. Thus,
it is important to realize that it is not enough to be able to assemble a correct
bond graph for a mechanical system, but it is also important to have a scheme
for drawing useful results from any bond graph model.
The ﬁeld of multibody systems is concerned with exactly the problem of
describing interconnected rigid bodies, and a variety of formulation and analysis
techniques have been developed to treat these systems. Here we will just illustrate
a variety of techniques that are particularly applicable to bond graph models of
systems that contain constrained rigid bodies as subsystems. For more details on
some of these techniques, see References [12–17].
9.2.2
Multibody Systems
The description and analysis of multibody systems have been the subject of
research for a long time. When a number of rigid bodies are constrained by
different types of joints and yet move through large angles in three dimensions,
the kinematic relationships can become very complex. Specialists in multibody
systems have developed a number of techniques for handling this type of mechan-
ical dynamic system, and it would be presumptuous to suggest that bond graphs
would always be a better choice as a descriptive mechanism than the alterna-
tive established techniques. Although bond graphs certainly can be used to study

434
MECHANICAL SYSTEMS WITH NONLINEAR GEOMETRY
1
GY
e
e
F
I
R
I
R
g
F
m
x
l1
y1
l1
x1
R
i
ω
i
1
1
1
1
1
TF
:
Cart
and bar
m1, I1
I : m
I : m1
x1
I : m1
I : J1
x
x
y1
ϕ1
ϕ1
+
+
ω
R
+
–
FIGURE 9.13. Control system experiment, including an upside-down pendulum mounted
on a massive cart.
purely mechanical multibody systems (see Reference [17], for example), it is
probably more logical to use a bond graph approach when the system to be
studied contains other components that are particularly well treated using bond
graphs.
As an elementary example, consider the system of Figure 9.13, which consists
of an electric motor that moves a cart through a pulley and belt arrangement on
that an upside-down pendulum is mounted. The object is to design a control
system which varies the voltage on the motor in such a way that the pendulum
is stabilized in the upright position at any desired cart position x.
As shown in the ﬁgure, the bond graph representation of the drive system
is straightforward, but the rigid constraint between the cart and the bar will
certainly cause derivative causality problems, which are complicated if the angle
φ1 is not restricted to be small. This system, neglecting any details of the drive,
was one example used in Reference [12] to argue that the so-called descriptor
form for multibody equations is particularly good at making the multibody system
structure evident.
We will follow the development of Reference [14] to show that one bond
graph approach to multibody systems is closely related to the multibody system
approach leading to equations in the descriptor form. The ﬁrst step is to consider
bond graph elements representing the rigid-body dynamics without any consid-
eration of the constraints among the bodies. The coordinates x for the cart and

KINEMATIC NONLINEARITIES IN MECHANICAL DYNAMICS
435
x1, y1, and φ1 for the bar are deﬁned with respect to an inertial frame. Thus, the
four I -elements at the right of Figure 9.13 properly represent the laws that state
that the sums of all applied forces equal the rate of change of the linear momenta
and that the velocity components of the centers of mass are the momenta divided
by the masses. Also, the sum of the moments about the center of mass of the
bar is equal to the rate of change of the angular momentum. For this plane
motion case, the angular velocity divided by the centroidal moment of inertia
gives the angular velocity of the bar. (As noted previously, the bond graph rep-
resenting three-dimensional motion of unconstrained rigid bodies is considerably
more complicated.)
To constrain the four I -elements in Figure 9.13 and thus to create a bond
graph for the bar and cart subsystem to be attached to the drive train bond graph,
we ﬁrst deﬁne gaps δ1 and δ2 in Figure 9.14. These horizontal and vertical gaps
between the bar pivot and the cart pivot should vanish. Furthermore, forces across
the gaps λ1 and λ2 will be necessary in order to assure that δ1 and δ2 do indeed
vanish. The use of λ to represent forces associated with constraints is intended to
remind one that in the multibody formalism of Reference [12], these gap forces
are Lagrange multipliers.
The gaps are easily related to the position coordinates of the rigid bodies in
Figure 9.14:
δ1 = x1 −x −ℓ1 sin φ1,
δ2 = y1 −ℓ1 cos φ1.
(9.82)
x1
y1
δ1
δ2
λ2
λ2
λ1
ϕ1
λ1
x
FIGURE 9.14. The bar and cart of Figure 9.13 showing gaps δ1 and δ2, which should
vanish, and the associated forces λ1 and λ2.

436
MECHANICAL SYSTEMS WITH NONLINEAR GEOMETRY
By differentiating the gap expressions, one can relate the gap velocities to the
body velocities:
˙δ1
˙δ2

=
−1
1
0
−ℓ1 cos φ1
0
0
1
ℓ1 sin φ1

⎡
⎢⎢⎣
˙x
˙x1
˙y1
˙φ1
⎤
⎥⎥⎦.
(9.83)
This relationship can be represented in bond graph terms by a multiport
displacement-modulated transformer, as was discussed in Chapter 7. Figure 9.15
shows the transformer attached to the four I -elements representing the two
unconstrained bodies.
The transpose of the matrix in Eq. (9.83) then automatically relates the gap
forces λ1 and λ2 to effective forces at the four I -elements:
⎡
⎢⎢⎣
Fx
Fx1
Fy1
τ1
⎤
⎥⎥⎦=
⎡
⎢⎢⎣
−1
0
1
0
0
1
−ℓ1 cos φ1
ℓ1 sin φ1
⎤
⎥⎥⎦
λ1
λ2

.
(9.84)
In Figure 9.15, the drive system force F and the gravity force m1g have also been
applied. Following the causal marks, some dynamic equations can be written:
˙px = F −Fx = F + λ1,
˙x = px/m;
˙px1 = −Fx1 = −λ1,
˙x1 = px1/m1;
˙py1 = −m1g −Fy1 = −m1g −λ2,
˙y1 = py1/m1;
˙pφ1= −τ1 = (ℓ1 cos φ1)λ1 −(ℓ1 sin φ1)λ2,
˙φ1 = pφ1/J1.
(9.85)
I : m
I : m1
I : m1
I : J1
x
x1
y1
ϕ1
λ1
δ1
λ2
δ2
τ1
1
1
1
F
Fx
Fx1
Fy1
Se
m1g
1
MTF
FIGURE 9.15. Bond graph relating gap velocities to body velocities.

KINEMATIC NONLINEARITIES IN MECHANICAL DYNAMICS
437
The multibody descriptor form for the mechanical subsystem is just Eq. (9.85)
slightly rewritten:
m¨x
= F + λ1,
m1 ¨x1 = −λ1,
m1 ¨y1 = −m1g −λ2,
J1 ¨φ1 = (ℓ1 cos φ1)λ1 −(ℓ1 sin φ1)λ2.
(9.86)
Equations (9.85) or (9.86) are straightforward except that the gap forces λ1 and λ2
are unknown. In the conventional multibody formulation, the extra information
is supplied by requiring δ1 and δ2 to vanish in Eq. (9.82).
Although this formulation is mathematically complete, it represents a
differential-algebraic set of equations, and such systems are not particularly easy
to solve numerically. The bond graph of Figure 9.15 suggests an alternative
approach. See References [16, 17].
Suppose that instead of requiring that δ1 and δ2 vanish exactly, we mod-
eled the pivot interaction between the two bodies as if relatively stiff springs
existed which would generate the λ forces whenever the gaps were not zero.
In one sense, this may seem to be more realistic, since no truly rigid bodies
exist. However, if realistic bearing stiffnesses were to be used, one would in
all probability create a model with very high vibrational natural frequencies,
which would necessitate short time steps in any numerical simulation. It is better
philosophically to consider springs and dampers inserted across gaps as artiﬁ-
cial devices to enforce constraints approximately and to do this with explicit
differential equations instead of differential-algebraic equations. The idea is to
experiment with spring stiffness to ﬁnd the lowest stiffnesses that yield sufﬁ-
ciently small values of δ1 and δ2 in actual system operation. This will yield the
longest possible time steps in simulation and the shortest simulation times.
The complete system bond graph for the system of Figure 9.13 is shown in
Figure 9.16. In essence, the bond graph of the drive system shown in Figure 9.13
has been combined with the multibody bond graph of Figure 9.15 with the addi-
tion of R- and C-elements to generate the constraint forces λ1 and λ2 as a function
of δ1, δ2, ˙δ1, and ˙δ2. Increasing the stiffness of the C-elements will have the effect
of producing larger forces when the gaps are nonzero and thus reducing the gaps.
Since the introduction of springs implies that vibrational motion is possible, it is
useful also to introduce artiﬁcial R-elements to provide damping. Again, some
experimentation with damping parameter values will be necessary to achieve a
reasonable result.
The observant reader may have noticed that where the drive train bond graph
of Figure 9.13 is attached to the multibody bond graph of Figure 9.15, an extra
C-element has been inserted. The reason is that if the two bond graph fragments
are simply joined, the motor rotary inertia and the cart inertia are coupled by a
transformer relating rotary to linear motion variables. This is another instance of
rigid coupling between inertia elements that always induces derivative causality.

438
MECHANICAL SYSTEMS WITH NONLINEAR GEOMETRY
I
I
I
I
x
x1
y1
ϕ1
λ1
λ2
δ1
δ2
1
0
1
1
1
1
F
Se
1
MTF
C
C
R
R
1
GY
e
I
R
I
R
C
i
1
TF
FIGURE 9.16. Bond graph for the system of Figure 9.13.
In this case, it would be simple to eliminate this inconvenience by deﬁning a
single equivalent rotary or linear inertia element or to deﬁne an I -ﬁeld using the
methods of Chapter 7. Instead, this rigid constraint has been replaced with an
approximate one by deﬁning an equivalent C-element. This element could be
considered to represent the belt drive ﬂexibility or simply a device for making
the entire model capable of having integral causality.
Finally, one may note that it would be easy to write down the state equations
for all the I - and C-elements in Figure 9.16. One must remember, however,
that in this multibody technique, the displacement-modulated transformer uses
the displacements of inertia elements to express the constraint or gap equations.
In bond graphs, displacement variables for inertia elements are not normally
necessary as state variables, so some extra state equations will be necessary.
The transformer matrices for the example shown in Eqs. (9.83) and (9.84)
actually need one displacement, φ1, so strictly speaking only the very last equation
in Eq. (9.85) would need to be included. For this type of system, it would probably
be useful to include state equations for all displacements x, x1, y1, and φ1 in any
case, as indicated in Eq. (9.85). These equations do increase the order of the
system, but their inclusion has only a minor effect on the simulation time for
a computer study of the system since three of the four displacements are not
coupled to the remainder of the dynamic system.
To illustrate how this method of enforcing constraints among interconnected
bodies can be extended, we brieﬂy consider a second bar attached to the system

KINEMATIC NONLINEARITIES IN MECHANICAL DYNAMICS
439
λ2
λ1
δ2
λ1
λ2
δ4
δ3
δ1
λ3
λ4
λ4
λ3
F
F
m1g
m2, l2
m1, l1
x2, y2
x1, y1
m, x
m2g
ϕ1
ϕ2
FIGURE 9.17. Double upside-down pendulum system.
already studied, as shown in Figure 9.17. By deﬁning gaps δ3 and δ4 and
corresponding forces λ3 and λ4 pertaining to the second set of constraints relating
the position of the top of bar 1 to the bottom of bar 2, we can derive two more
relations to supplement Eq. (9.82) which still applies:
δ3 = x2 −ℓ2 sin φ2 −x1 −ℓ1 sin φ1,
δ4 = y2 −ℓ2 cos φ2 −y1 −ℓ1 cos φ1.
(9.87)
A time differentiation of Eq. (9.87) results in equations relating ˙δ3 and ˙δ4 to
˙x1, ˙y1, ˙φ1, ˙x2, ˙y2, and ˙φ2, analogous to Eqs. (9.83). The transpose of the matrix
relates six force components to λ3 and λ4, and both sets of relations are embodied
in a 2 × 6 port modulated transformer, as shown in Figure 9.18. In this case, both
bars have three degrees of freedom, so six generalized velocities are involved
when the two bodies are constrained.
Again, there is the possibility of relating λ3 and λ4 to forces acting on the
I -elements and requiring δ3 and δ4 to vanish in Eq. (9.87), which completes the
multibody formulation in descriptor form. Figure 9.18 shows the alternative of
using spring and damping elements to enforce the constraint in an approximate
manner.
The idea of using artiﬁcial C- and R-elements to enforce constraints and thus
to avoid derivative causality or differential-algebraic equations may appear to be
a “brute-force” approach. This may be true, but ﬁrst, a brute-force approach that
is effective should not be discounted and, second, it has been argued that this
approach is in many cases superior to the alternatives [17].

440
MECHANICAL SYSTEMS WITH NONLINEAR GEOMETRY
x2
y2
ϕ2
λ3
λ4
δ3
δ4
I : m
I : m1
I : m1
I : m2
I : m2
I : J2
I : J1
x1
x
y1
ϕ1
1
1
1
1
1
1
1
1
Se
Se
1
MTF
C
C
R
R
λ1
λ2
δ1
δ2
1
1
MTF
C
C
R
F
R
FIGURE 9.18. Bond graph for the double upside-down pendulum system.
9.2.3
Lagrangian or Hamiltonian IC-Field Representations
In Section 9.2.1, a procedure for constructing a bond graph for mechanical
systems that could be described by generalized coordinates was presented. An
example was worked out and illustrated in Figures 9.9–9.11. In this case, using
normal bond graph causality, it was found that explicit differential equations
could be written fairly easily despite geometric nonlinearities in the kinematic
relationships involved. In many cases, however, the resulting bond graph, while
formally correct, is intractable due to algebraic loops and derivative causality.
Lagrange’s equations are particularly useful for such situations, so in this section,
it will be shown how a mechanical subsystem can be represented by a special
type of IC-ﬁeld, the equations of which are Lagrange’s equations in a Hamil-
tonian form. This often is the simplest way to derive equations for a nonlinear
mechanical subsystem.
Consider a holonomic system that can be described by a vector of generalized
coordinates, qk, as described in Section 9.2.1. The kinetic energy T of all the

KINEMATIC NONLINEARITIES IN MECHANICAL DYNAMICS
441
particles and rigid bodies in the system can then be written as a function of
the variables in qk and their rates of change, ˙qk. Then the standard form for
Lagrange’s equation is
d
dt
∂T
∂˙qi
−∂T
∂qi
= Ei,
(9.88)
where qi is the ith generalized coordinate in qk (the subscript k has been dropped
for simplicity since will be dealing only with the “kinematic” generalized coor-
dinate displacements in this section); Ei includes all generalized forces for the
ith coordinate, including those that could be derived from a potential energy
function.
Equation (9.88) leads to coupled second-order equations, but a simple change
leads to twice as many ﬁrst-order equations. This Hamiltonian form not only is
more useful for computation but also is more compatible with the bond graph
formalism.
First, deﬁne generalized momenta pi corresponding to the displacements qi
by the expression
pi ≡∂T
∂˙qi
.
(9.89)
Then each equation in Eq. (9.88) may be rewritten in momentum form:
˙pi = ∂T
∂qi
+ Ei
or
˙pi = e′
i + Ei,
e′
i ≡∂T
∂qi
.
(9.90)
State equations for the qi come by inverting Eq. (9.89) to solve for the ˙qi as
functions of the pi and qi. As shown in Reference [15], Eq. (9.89) always has
a special form. If pk is the vector of generalized momenta, Eq. (9.89) can be
represented thus:
pk = M(qk, t)˙qk + a(qk, t),
(9.91)
where M is a symmetric matrix and the vector a occurs only if the system
includes time-varying velocity sources. Then the state equations for the qi are
formally
˙qk = M−1(qk, t)[pk −a(qk, t)].
(9.92)
In the worst case, the inversion of the “mass” matrix M may have to be done
repeatedly as a simulation proceeds, but in some cases it can be done only
once—if M is a constant—or analytically if M is not completely coupled.
Note that Eqs. (9.90) and (9.92) are just generalizations of the type of equations
we normally obtain for systems including I - and C-elements when bond graphs
are used.

442
MECHANICAL SYSTEMS WITH NONLINEAR GEOMETRY
IC
1
1
1
e′1
p1
e′2
e′n
pn
p2
q1
E1
E2
q2
qn
En
FIGURE 9.19. An IC-ﬁeld representation of the Hamiltonian form of Lagrange’s
equations.
Equations (9.90) and (9.92) are elegantly summed up in the bond graph of
Figure 9.19, which could be used to represent a complex mechanical subsystem
connected to other elements readily described in bond graph terms. Of course,
the e′
i force terms could even include forces derivable from potential energy, V,
if e′
i in Eq. (9.90) were extended thus:
e′
i = ∂T
∂qi
−∂V
∂qi
.
(9.93)
This would leave only nonpotential forces in the Ei. Often it is easy to put
forces from elastic elements or gravity in the bond graph itself, and this may
show system structure better than representing everything in the IC equations.
Although the equations for the IC-ﬁeld may appear complex, one must remem-
ber that when many inertial elements are highly constrained, only a few degrees
of freedom may be necessary to describe a subsystem that would otherwise have
many cases of derivative causality. Furthermore, many cases of derivative causal-
ity are only local in nature so that a few IC-ﬁelds in combination with a number
of elements in the bond graph with no causal problems may result in a useful
model of a large and complex system.
An Example System. The system sketched in Figure 9.20 is elementary but yet
shows a number of the difﬁculties associated with inertial elements in mechanics.
It is not hard to create a bond graph for this system by considering the x, y, and
z coordinates of the particle and the corresponding inertial space velocities ˙x, ˙y,
and ˙z as the ﬂows on three simple I -elements. The torsion spring and a rotary
inertia both have ˙α as their ﬂow variable, and friction at the pendulum pivot
has ˙θ as its ﬂow variable.

KINEMATIC NONLINEARITIES IN MECHANICAL DYNAMICS
443
y
z
lθ
m
y
y
x
x
S
S
(S+l sin θ)α
α
l sin θ
θ
x
z
M(t)
α
Torsion spring
l
(b)
(a)
FIGURE 9.20. Example system: (a) three-dimensional view; (b) view from above.
An obvious way to enforce the geometric constraints in the problem is to
consider α and θ as generalized coordinates which then determine x, y, and z:
x = (S + ℓsin θ) cos α,
y = (S + ℓsin θ) sin α,
z = −ℓcos θ.
(9.94)
Notice that time is not explicitly involved so that the a in Eqs. (9.91) and (9.92)
will be missing.
The velocities ˙x, ˙y, and ˙z are found by differentiating Eq. (9.94):
⎡
⎣
˙x
˙y
˙z
⎤
⎦=
⎡
⎣
−(S + ℓsin θ) sin α
ℓcos θ cos α
(S + ℓsin θ) cos α
ℓcos θ sin α
0
ℓsin θ
⎤
⎦
˙α
˙θ

.
(9.95)
Using these relationships, a bond graph can be assembled as shown in Figure 9.21.
Either 2-port MTFs with 0- and 1-junctions can be used or a multiport MTF as
shown with the 3 × 2 matrix in Eq. (9.95) as its transformation matrix. This bond
graph is not easy to use, however, because if two I -elements are put into integral
causality, the remaining I -elements will be forced into derivative causality. In
the causality shown in Figure 9.21, ˙α and ˙x are determined by I -elements in
integral causality. By a manipulation of Eq. (9.95), ˙y, ˙θ, and ˙z could be related
to ˙α and ˙x.

444
MECHANICAL SYSTEMS WITH NONLINEAR GEOMETRY
I:m
I:m
I:m
mg
C
R
MTF
1
α
1
x
1
y
1
z
1
θ
I:J
Se
Se
M(t)
FIGURE 9.21. Bond graph for the system of Figure 9.20.
To develop an IC-ﬁeld representation using α and θ as generalized coordinates,
we ﬁrst write the kinetic energy either with the help of Eq. (9.95) or, more simply,
directly from the sketch of Figure 9.20:
T = 1
2m

[(S + ℓsin θ)˙α]2 + (ℓ˙θ)2
+ 1
2J ˙α2,
(9.96)
where J is the moment of inertia about the z-axis.
The generalized momenta are
pα = ∂T
∂˙α = m(S + ℓsin θ)2 ˙α + J ˙α,
(9.97)
pθ = ∂t
∂˙θ = mℓ2 ˙θ.
(9.98)
In this case, the inverted forms corresponding to Eq. (9.92) are simply
˙α =
pα
m(S + ℓsin θ)2 + J ,
(9.99)
˙θ = pθ
mℓ2 .
(9.100)
The remaining equations of motion are
˙pα = ∂T
∂α + Eα = Eα,
(9.101)
˙pθ = ∂T
∂θ + Eθ = m˙α2(S + ℓsin θ)ℓcos θ + Eθ.
(9.102)

APPLICATION TO VEHICLE DYNAMICS
445
pα
pθ
e′θ
θ
1
1
MTF
R
C
Se
Se
mg
α
θ
IC
M(t)
:
l sin θ
FIGURE 9.22. An IC-ﬁeld representation for the example system of Figure 9.20.
Note that Eqs. (9.99)–(9.102) are essentially explicit ﬁrst-order equations suitable
for machine solution. One could use Eq. (9.99) to eliminate ˙α in Eq. (9.102) in
favor of the state variables pα and θ, but if the equations are integrated in the
order given, this step is not really necessary in a computational sense since the
numerical value of ˙α will be known before it is needed in Eq. (9.102).
Figure 9.22 shows a bond graph for the system in which an IC-ﬁeld represents
the mechanical subsystem and the Se-, C-, and R-elements supply the generalized
forces (torques) Eα and Eθ. Note that the gravity force acts through an MTF,
which in Figure 9.21 is hidden in the multiport MTF. It is associated with the
last line of Eq. (9.95). Also, since
e′
α ≡∂T
∂α ≡0,
(9.103)
the bond conjugate to the ˙pα bond is not needed, and, except for the torsion
spring, α is not needed as a state variable.
Conclusions. Many problems with derivative causality can be solved by deﬁning
I - or C-ﬁelds for subsystems, as shown in Chapter 7, but mechanical inertia
elements pose a particularly difﬁcult set of problems when nonlinear geometric
constraints are involved. The extension of the I -ﬁeld idea to an IC-ﬁeld, in the
spirit of Lagrange’s or Hamilton’s equations, eliminates the derivative causality
at the possible expense of an inertia matrix inversion which at worst may have
to be made numerically and repeatedly during a computer simulation.
9.3
APPLICATION TO VEHICLE DYNAMICS
The bond graph fragment of Figure 9.6 is the fundamental building block for all
rigid-body mechanics. Different transformations may be substituted, depending

446
MECHANICAL SYSTEMS WITH NONLINEAR GEOMETRY
FIGURE 9.23. Ground vehicle with body-ﬁxed frame.
on the rigid-body system being modeled, but the fundamental structure remains
unchanged. In this section, the use of this building block for constructing sophis-
ticated low-order models of ground vehicles is discussed.
Figure 9.23 shows a vehicle with a body-ﬁxed frame attached at its center
of mass and aligned with the principal directions. The vehicle body is consid-
ered rigid, with mass mb and principal moments of inertia Jx, Jy, and Jz. It is
a four-wheeled vehicle with pneumatic tires, front-wheel steering, front-wheel
drive, and four-wheel independent suspension. It is a more or less conventional
automobile. Through use of bond graphs, we can break the modeling effort into
modeling of component pieces. We can then assemble the pieces, having been
tested individually, into a system model.
Tire and Suspension. Pneumatic tires are extremely complicated in the way
forces are generated at the contact patch. We will not attempt to develop this
material thoroughly here and will keep the complexity within the context of
demonstrating the procedure for building system models using 3-D rigid-body
mechanics. The interested reader should see Reference [8] for a complete treat-
ment of pneumatic tires.
Figure 9.24 shows a tire acted upon by forces at the ground contact patch and
with an attached suspension unit. The tire is of mass mt, which is representative of
the unsprung mass associated with the wheel assembly, and the tire is compliant,
indicated by the stiffness, kt. It should be noted that the vertical compliance of

APPLICATION TO VEHICLE DYNAMICS
447
FIGURE 9.24. Schematic of tire and suspension.
a tire is nonlinear; however, for discussions here it is convenient to refer to a
stiffness parameter. The realistic behavior can, of course, be included in the ﬁnal
computational model.
At the instant shown, the forward velocity of the tire is ut, its transverse or
sideways velocity is vt, and its angular velocity is ωt. It is acted upon by a
longitudinal force FL, a cornering force Fc, and a normal force N through the
contact patch. The wheel torque τw is also shown in the ﬁgure, and it represents
the torque from the drive train or torque due to braking.
The longitudinal force FL is dependent upon the longitudinal slip of the tire.
The slip s is expressed as a percentage and is calculated from
s = |Rωt −ut|
Rωt
× 100
(9.104)
during acceleration and
s = |ut −Rωt|
ut
× 100
(9.105)

448
MECHANICAL SYSTEMS WITH NONLINEAR GEOMETRY
FIGURE 9.25. Qualitative force generation in pneumatic tires: (a) longitudinal force:
(b) cornering force: (c) cross plot of longitudinal and cornering forces.
during braking. The slip determines the friction coefﬁcient μ, through a functional
dependence shown qualitatively in Figure 9.25a, and the force is given by
FL = μN.
(9.106)
It is interesting that the tires generate a maximum force at some ﬁnite slip, and
then the force decreases as the slip increases. When slip equals 100%, the wheel
is spinning with no forward velocity (as on ice), or else the wheel is locked, but
the vehicle is skidding with some forward velocity. The curve of Figure 9.25a is
strongly dependent on road surface conditions and also the cornering force Fc.
When a tire is steered and the vehicle turns, the absolute velocity of the wheel
center is not directed along the plane of the wheel. The tire deforms, and a side
force Fc is developed. The slip angle α of the tire is deﬁned to be the angle
between the absolute velocity of the wheel and the plane of the wheel. This
angle is shown in Figure 9.24 and can be calculated from
α = tan−1 vt
ut
.
(9.107)

APPLICATION TO VEHICLE DYNAMICS
449
The cornering force is functionally related to α, as shown in Figure 9.25b. The
linear part of the curve is characterized by the cornering stiffness Cα of the tire.
The curve of Figure 9.25b is dependent on road surface conditions and on the
longitudinal force. The trade-off between FL and Fc is shown qualitatively in
Figure 9.25c. For our discussion it is only important to realize that if α and s
are both known, then FL and Fc can be computed, regardless of the complexity
of their interrelationship.
Figure 9.26 shows a bond graph of the wheel–tire system. The longitudinal
dynamics are shown in part a, the cornering dynamics in part b, and the vertical
dynamics in part c. The wheel is, in part, another rigid body that could be rep-
resented in a manner similar to the vehicle body. Figure 9.26 shows the wheel
dynamics decoupled. For the wheel it is reasonable to neglect cross-coupling,
since the angular velocity components about the vertical and horizontal longitu-
dinal axes are very small. We are also neglecting gyroscopic effects due to the
high angular velocity ωt of the tire.
In Figure 9.26a the torque from the drive train or brakes is an input to the
bond graph fragment, and a force on the body is an output. The modulated R-
element represents the tire slip behavior and can be as complicated as necessary
for the intended use of the model. In Figure 9.26b the cornering dynamics are
represented. They too possess a modulated R-element for the cornering force
generation. This fragment also outputs a force to the body. The vertical dynamics
of Figure 9.26c allow for roadway unevenness under the tire contact patch, and
this fragment also contains the suspension elements. A force on the body is an
output from this fragment.
Notice in Figure 9.26 that integral causality exists for all models. Thus, state
equations are straightforwardly derived. These equations will accept drive train
torque τ as an input, and they will have forces as outputs. These forces then
become inputs into the body model. Notice also that each wheel will have an
identical but individual representation.
Drive Train Model. The ﬁnal subsystem that requires discussion is the drive
train, consisting of the engine, transmission, and differential (front only for this
discussion). The drive train is not an essential element for simulating all vehicle
systems. If we choose, we can simply specify the torque τ in the bond graph of
Figure 9.26a. For completeness, we present the drive train model here.
Figure 9.27 shows, schematically, the drive train of a front-wheel drive vehi-
cle. The engine power passes through a transmission and then is split by the
differential and transmitted to the right and left front wheels. The differential
applies equal torque, left and right, but permits the right and left wheels to
have different angular velocities. A bond graph fragment for the drive train is
also shown in Figure 9.27. In part b, no drive line compliance is included. The
engine is modeled as a modulated torque source, and torques τL and τR are out-
puts from the model. In Figure 9.27c, drive line compliance is included. Torques
are still outputs from the model. But this time the engine must be modeled as
a modulated source of angular velocity. The output torques are, of course, the
inputs to the wheel–tire dynamics of Figure 9.26.

450
MECHANICAL SYSTEMS WITH NONLINEAR GEOMETRY
FIGURE 9.26. Bond graph of wheel–tire system: (a) longitudinal dynamics; (b) trans-
verse dynamics; (c) vertical dynamics.

APPLICATION TO VEHICLE DYNAMICS
451
FIGURE 9.27. Drive train schematic and bond graph: (a) schematic; (b) bond graph
without drive shaft compliance; (c) bond graph with drive shaft compliance.

452
MECHANICAL SYSTEMS WITH NONLINEAR GEOMETRY
9.4
SUMMARY
Three-dimensional rigid-body mechanics have been developed using bond graphs.
A very elegant representation of Euler’s equations resulted, but a prescribed
causality must be used in order to allow the 3-D bond graph fragment to interact
easily with a necessary coordinate transformation. Likewise, a complex coordi-
nate transformation was presented which must be used with a prescribed causality
for ease of coupling with other parts of an overall system model. The coordinate
transformation shown here was the one particularly useful for vehicle dynamics.
The 3-D rigid-body development was demonstrated for vehicle dynamics
applications. It was shown how wheel–tire models and drive train models could
be developed separately from the 3-D mechanics and then made to interact in a
computational model as long as prescribed causality was maintained. The com-
plete model was not assembled here. However, it is hoped that sufﬁcient detail
was given to whet the reader’s appetite so that uncontrollable hunger to read
References [9–11] results. These references use this approach for constructing
very complicated vehicle system models for use in design and control synthesis.
REFERENCES
[1] Sir William Thomson and P. G. Tait, Principles of Mechanics and Dynamics,
New York: Dover, 1962.
[2] C. Lanczos, The Variational Principles of Mechanics, Toronto: Univ. of
Toronto Press, 1957.
[3] R. C. Rosenberg, “Multiport models in mechanics,” Trans. ASME, J. Dyn.
Syst. Meas. Control, 94, Ser. G, No. 3, 206–212 (Sept. 1972).
[4] S. Crandall, D. Karnopp, E. Kurtz, and D. Pridmore-Brown, Dynamics
of Mechanical and Electromechanical Systems, New York: McGraw-Hill,
1968.
[5] D. Karnopp, “Power-conserving transformations: physical interpretations
and applications using bond graphs,” J. Franklin Inst., 288, No. 3, 175–201
(Sept. 1969).
[6] R. C. Rosenberg, “State-space formulation for bond graph models of multi-
port systems,” Trans. ASME, J. Dyn. Syst. Meas. Control, 93, Ser. G, No. 1,
35–40 (Mar. 1971).
[7] G. Martin, Kinematics and Dynamics of Machines, New York: McGraw-Hill,
1969, p. 7.
[8] H. B. Pacejka, “Introduction into the lateral dynamics of road vehicles,”
Third Seminar on Advanced Vehicle Dynamics, Amalﬁ, May 1986.
[9] D. C. Karnopp, “Bond graphs for vehicle dynamics,” Vehicle Syst. Dynam.,
5 (1976).
[10] D. L. Margolis and J. Asgari, “Sophisticated yet insightful models of vehicle
dynamics using bond graphs,” ASME Symposium on Advanced Automotive
Technologies, 89 ASME WAM, San Francisco, 1989.

PROBLEMS
453
[11] D. L. Margolis, “Bond graphs for vehicle stability analysis,” Int. J. Vehicle
Design, 5, No. 4 (1984).
[12] B. Baras¨ozen, P. Rentrop, and Y. Wagner, “Inverted n-bar model in descrip-
tion and in state space form,” Math. Model. Syst., 1, 272–285 (1995).
[13] D. Karnopp, “Lagrange’s equations for complex bond graph systems,”
Trans. ASME J. Dynam. Syst. Meas. Control, 99, Ser. G, 300–306 (1977).
[14] D. Karnopp, “Understanding multibody dynamics using bond graphs,”
J. Franklin Inst., 334B, No. 4, 631–642 (1997).
[15] D. Karnopp, “An approach to derivative causality in bond graph models of
mechanical systems,” J. Franklin. Inst., 329, No. 1, 65–75 (1992).
[16] D. Margolis and D. Karnopp, “Bond graphs for ﬂexible multibody systems,”
Trans. ASME, J. Dynam. Syst. Meas. Control, 101, 50–57 (1979).
[17] A. Zeid and C.-H. Chung, “Bond graph modeling of multibody systems: a
library of three dimensional joints,” J. Franklin Inst., 329, 605–636 (1992).
PROBLEMS
9-1. A particle can slide on a frictionless horizontal plane constrained by a
linear spring pivoted at the origin of x, y and with spring constant k and
free length l0. Make a bond graph for this system by using r, θ for the
vectors qC and qk and ˙x, ˙y for the vector vI . Can the system accept all
integral causality? Make another bond graph by using x, y for qk, ˙x, ˙y
for vI , and r for qC.
9-2. Three mass particles are attached to a spring-supported rigid massless bar
that executes small vibratory motion. The vector qC is x1, x2, the vector vI
is V1, V2, V3, and several choices for qk are possible. Show a bond graph
for the system with the following choices for qk:
(a)
qk = x1, x2 = qC;
(b)
qk = x3, θ, where x3 is the displacement of m3 and θ is the angle of
inclination of the bar; and

454
MECHANICAL SYSTEMS WITH NONLINEAR GEOMETRY
(c)
qk = x1, x3.
Pick one bond graph, and write the equations of motion for the system
using the graph.
9-3. Set up bond graph representations of the system shown below using the
three alternative MTF forms shown. Write complete state equations in each
case, using integration-causality methods or Lagrange equations. Comment
on any advantages or disadvantages you see in the alternative formulations.
9-4. Consider the model of an off-road vehicle shown below. Note that the
surface interaction may be represented by the equations and bond graph
element shown. Develop a bond graph and state-space equations for this
model.

PROBLEMS
455
9-5. Construct a bond graph for this two-degree-of-freedom vehicle model.
Use two forms for the I -ﬁeld representing the rigid body: one matrix
representation using the ˙y1, ˙y2 port variables directly, the other using the
auxiliary variables yc and θ and a multiport TF.
9-6. (In which the inherent nastiness of geometric nonlinearity is exhibited.)
Consider the simple pendulum of length l, mass m, swinging through large
angles under the inﬂuence of gravity and bearing friction.

456
MECHANICAL SYSTEMS WITH NONLINEAR GEOMETRY
(a)
Set up a modulated transformer representation of the relations
between ˙x, ˙y, and ˙θ and the corresponding forces Fx, Fy and
torque τ that are enforced by the rigid bar. Demonstrate that the
multiport displacement-modulated transformer relations are power
conservative.
(b)
Show a bond graph for the system using your MTF. Set up sign
conventions and a causal pattern in which integration causality is
applied to the x-motion —I .
(c)
Write the equations corresponding to your graph. Be sure that your
state space is complete and in the standard form.
(d)
Show that your state space is consistent with ml2 ¨θ = −b ˙θ −mgl
sin θ, which would be the result of many standard analyses.
9-7. Consider the double pendulum shown (see Problem 9-6).

PROBLEMS
457
(a)
Set up the multiport displacement-modulated transformer that relates
˙x1, ˙y1, ˙x2, ˙y2 to ˙θ1, θ1, ˙θ2, θ2, and exhibit both the velocity and force
relations in matrix form.
(b)
Using the MTF, show a system bond graph, and predict one possible
set of state variables using the integration-causality method.
(c)
Use the junction structure of (b) to compute T (θ1, ˙θ1, θ2, ˙θ2)—kinetic
energy—and generalized torques so that Lagrange equations can be
utilized as an alternative procedure to ﬁnd state equations. What are
the state variables if Lagrange equations are used?
9-8. The uniform thin bar shown below is pivoted at A. The pin slides freely in
the vertical guideway. Represent the bar by three 1-port —I ’s represent-
ing the horizontal and vertical motion of the center of mass and rotation
about the center of mass.
(a)
(a)
Show that the junction structure of the multiport MTF involved may
be rearranged to yield a bond graph for the system of the following
form:
(b)
(b)
Apply causality to the system, and write the equations of motion.

458
MECHANICAL SYSTEMS WITH NONLINEAR GEOMETRY
9-9. Let the pendulum have mass m and moment of inertia J . Assume θ ≪π.
(a)
(a)
Noting that the equilibrium point for the upside-down pendulum is
θ = 0, write expressions for kinetic energy and potential energy valid
up to second order in θ and ˙θ. Use the expressions to validate the
linear bond graph shown below:
(b)
Find the negative spring constant for the —C that models the gravity
effect.
(b)
Assuming F is an input, and that the —I ’s with parameters m0
and J have integral causality, write state equations and indicate the
matrix that must be inverted because of the differentiation causality.

PROBLEMS
459
(c)
Show that the system can be represented by
F= ˙Px
⇁
˙x
I
˙Pθ
↽
˙θ
C: + k,
and ﬁnd the matrix representation of the I -ﬁeld.
9-10. Following the pattern of analysis of Problem 9-9, ﬁnd a bond graph for
the double-inverted pendulum shown in the ﬁgure. Write state equations
for the system.

460
MECHANICAL SYSTEMS WITH NONLINEAR GEOMETRY
9-11. The German-language automobile model shown below uses the subscripts,
v, h, and R, for vorn (forward), hinten (rear), and Rad (wheel), respec-
tively. Otherwise, it seems to be sufﬁciently international to be bond
graphed.
Consider small pitch angles for the vehicle. Recall that the sum of the
vertical forces is equal to the mass times the acceleration of the center
of mass and that the sum of the torques about the center of mass is the
centroidal moment of inertia times the angular acceleration.
(a)
Construct a bond graph for the model in which the vehicle mass
m and the centroidal moment of inertia appear as 1-port element
parameters.
(b)
Show that consistent causality may be assigned for your bond graph,
and list the state variables. Discuss very brieﬂy any difﬁculties you
may ﬁnd in assigning causality.
(c)
Show that if the vehicle body is considered to be an I -ﬁeld, the
assignment of causality is simpliﬁed and the writing of state equations
is easier.
(d)
Either ﬁnd the properties of the 2-port I -ﬁeld describing the rigid
body or outline a procedure to ﬁnd them.
(e)
Can you think of a way to represent the nonlinear behavior of the
wheels when they leave the ground?

PROBLEMS
461
9-12. The mass m is supported on a thin inextensible wire stretched across the
frame with tension T.
(a)
Show that if T = const and if y/L ≪1, then the force on the mass
is given approximately by F = −(2y/L)T, and a bond graph for the
system (neglecting the inertia of the frame) is
keq = 2T
L : C ↼1
Fy
⇀
˙y
I
Fz↿˙z
0
Fx
↼
˙x
(b)
When T is allowed to vary by connecting a force source to the wire,
the equivalent spring seems to simply have a “variable constant.”
This concept is not very profound, however, since a —C element
must be conservative, and with variable T the relation between Fy
and y is not.
Show that if y/L ≪1, the distance the end of the wire moves
against the force source, δ, is δ = y2/L. Use this relation to show
a bond graph that represents the effect of the wire by means of a
force source and a displacement-modulated transformer. Note that
this model shows a causal restriction that was not evident in the
previous bond graph.
9-13. Consider the spherical pendulum shown in part a of the ﬁgure below.
Verify the bond graph shown in part b by ﬁnding the constitutive laws
for the MTF relating ˙θ1, ˙θ2 to ˙x, ˙y, ˙z. Write out the multiport MTF as a
junction structure using 0- and 1-junctions and 2-port MTFs.

462
MECHANICAL SYSTEMS WITH NONLINEAR GEOMETRY
Now show that all three I ’s cannot accept integral causality, because the
MTF cannot accept ﬂow input causality on all three of the ˙x, ˙y, ˙z bonds.
Show that consistent complete causality can be achieved if only two of
the I ’s have integral causality.
9-14. A brief outline of the relation between applied torque and angular momen-
tum for general motion of a rigid body using components in a coordinate
frame moving with the body and aligned with the principle axes is as fol-
lows: Following the notation of Reference [4], Section 4.4, a rigid body
may be deﬁned by a relation between angular velocity ω, angular momen-
tum H, and an inertia matrix I, as follows:
Iω = H.
(i)
In principal axis coordinates, this becomes
⎡
⎣
I1
0
0
0
I2
0
0
0
I3
⎤
⎦
⎡
⎣
ω1
ω2
ω3
⎤
⎦=
⎡
⎣
H1
H2
H3
⎤
⎦.
(ii)

PROBLEMS
463
As long as torques are computed about a ﬁxed point or the center of mass
of the body, the following is true:
dH
dt = τ,
(iii)
where H is the angular momentum vector, and τ is the torque vector.
When the components of H and τ are chosen in the moving coordinate
frame, then Eq. (iii) becomes
∂H
∂trel
+ ω × H = τ
(iv)
or
⎡
⎣
˙H1
˙H2
˙H3
⎤
⎦+
⎡
⎣
ω2H3 −ω3H2
ω3H1 −ω1H3
ω1H2 −ω2H1
⎤
⎦=
⎡
⎣
τ1
τ2
τ3
⎤
⎦,
(v)
in which the ω × H term corrects the terms representing change relative
to the moving frame to correctly portray the total change in H relative to
the inertial frame.
Verify that the modulated gyrator–ring structure correctly represents
Euler’s equations (v):
Select one of the MGY s, and write the equations that it represents. Verify
power conservation in the form
˙H1ω1 + ˙H2ω2 + ˙H3ω3 = τ1ω1 + τ2ω2 + τ3ω3.
9-15. The mechanical system shown in part a of the ﬁgure below contains one
rigid body that rotates about a ﬁxed axis and one that moves in more gen-
eral motion about a single ﬁxed point. Using the results of Problem 9-14,
verify the bond graph representation shown in part b. By computing

464
MECHANICAL SYSTEMS WITH NONLINEAR GEOMETRY
ω1, ω2, ω3 in terms of θ, ψ, ﬁnd the constitutive laws for the multiport
MTF.
If θ and ψ were used as generalized coordinates, a nonlinear, fourth-
order set of state equations could readily be found by applying Lagrange’s
equation to T—V . If all dynamic elements could accept integral causality,
a ﬁfth-order state space would result. This suggests that derivative causality
may be necessary for some of this system. See if this is true by expanding
the multiport MTF into a junction structure of 0- and 1-junctions and
2-port MTFs and applying causality.
9-16. The coordinate transformation of Figure 9.6 takes the body-ﬁxed center-
of-mass velocity and angular velocity components and outputs the inertial

PROBLEMS
465
angular velocity of the body and the inertial velocity components of the
center of mass. We frequently need the velocity components at attachment
points on the rigid body. Using the ﬁgure shown, derive the coordinate
transformation between center-of-mass body-ﬁxed components and the
body-ﬁxed components at the attachment points shown.
9-17. The ﬁgure shows two rigid bodies connected by a frictionless spherical
joint. Two body-ﬁxed coordinate frames are shown. The spherical joint
is at attachment point a on body 1 and attachment point b on body 2.
Using a shorthand notation similar to that of Figure 9.6, construct a bond
graph model for this interaction, assign causality, and discuss the problems
associated with deriving a computational model.

466
MECHANICAL SYSTEMS WITH NONLINEAR GEOMETRY
9-18. The ﬁgure shows a rigid body with a spring–damper suspension at each
corner. A body-ﬁxed coordinate frame is attached. A constraint system,
not shown, ensures that ωz (the angular velocity about the moving z-axis)
remains zero. Using Figure 9.2, show the simpliﬁed bond graph fragments
that will represent the rigid-body part of this system.
9-19. For small displacements it is reasonable to assume that the suspension units
in Problem 9-18 generate only vertical forces and that the body-ﬁxed z-
axis remains virtually vertical. This assumption eliminates the need for the
coordinate transformation from body-ﬁxed components at the attachment
points to inertial components. Construct a bond graph model of the system

PROBLEMS
467
under these assumptions. It is still convenient to use matrix transformations
between center-of-mass motion and individual attachment points.
9-20. Planar motion of a mass particle is shown in the ﬁgure with respect to
both a body-ﬁxed frame and an inertial frame. The polar coordinates r, θ
are used for the inertial description. A reduced bond graph fragment for
planar motion is also shown in the ﬁgure. From classical dynamics, the
absolute acceleration in r and θ directions are
ar = ¨r −r ˙θ2,
aθ = r ¨θ + 2˙r ˙θ.
Using the bond graph for planar motion, show that the absolute accelera-
tion is the same as for polar coordinates.
9-21. A classical simpliﬁed vehicle model, known as the bicycle model, is shown
in a top view in the ﬁgure. The vehicle travels in the xy-plane and has no
width. There is also no suspension, and only cornering forces are consid-
ered. The front wheel can be steered through the angle δ. The only angular
velocity considered is that about the body-ﬁxed z (vertical) axis, ωz. There
is no wheel mass, nor any bushings to consider. Using Figures 9.2, 9.25,
and 9.26, construct a complete bond graph model of this vehicle and assign
causality.

468
MECHANICAL SYSTEMS WITH NONLINEAR GEOMETRY
9-22. One of the uses of the bicycle model of a ground vehicle is for stability
considerations. For this purpose it is assumed that vx is large compared
to vy, and vx is virtually constant. Also, the steering angle δ is small, and
the slip angles front and rear are small enough that the cornering forces
are related to their respective slip angles by the linear relationships
Ff = Cf αf ,
Fr = Crαr,
where
αf = transverse velocity at front
vx
,
αr = transverse velocity at rear
vx
.
Modify the bond graph from Problem 9-21 to reﬂect these additional sim-
pliﬁcations. Assign causality and identify state variables.
9-23. Derive the state equations for the system of Problem 9-22. Put them into
standard matrix form for linear equations, remembering that vx is constant
for this model.

PROBLEMS
469
9-24. The equations from Problem 9-23 are
d
dt

py
pJ

=
⎡
⎢⎢⎢⎣
−

Cr + Cf

mvx
bCr −aCf
Jvx
−mvx
J
bCr −aCf
mvx
−

a2Cf + b2Cr

Jvx
⎤
⎥⎥⎥⎦

py
pJ

+
 Cf
aCf

δ.
Perform an eigenvalue analysis and determine the conditions for stability
of the vehicle.
9-25. It is well known that pneumatic tires have sidewall compliance that can
affect stability. The ﬁgure shows the bicycle model with springs, kf and
kr, between the wheel and the contact patch. It is assumed that the springs
are always in line with their respective axles as the vehicle moves.
Construct a bond graph of the new model.

10
DISTRIBUTED-PARAMETER SYSTEMS
Distributed-parameter systems are, analytically, those represented by partial
rather than total differential equations. Physically, distributed systems are engi-
neering components and devices that cannot be accurately approximated by the
lumped-parameter models used thus far in the text. Remember that all engineer-
ing models are approximations and are made up by the modeler to answer speciﬁc
questions concerning system understanding, design, and control. As modelers we
are always trying to use the simplest model that will lead to understanding of
the actual system. As Einstein once said, “Everything should be made as simple
as possible, but not simpler.”
So far in the text we have assumed that engineering systems are built from
components exhibiting inertia-like, compliance-like, or resistance-like effects. A
mass has been assumed rigid with no ﬁnite stiffness, and springs have been
compliant with no mass, for example. Of course, all materials exhibit inertial
and compliance effects, and it is our modeling assumptions that justify separating
these effects into speciﬁc lumps.
There are real engineering systems in which this lumping process is far from
obvious. An automobile for which we are interested in suspension design can
be represented as a rigid body and characterized by its mass and moments of
inertia. A tractor–trailer rig for which we are interested in suspension design
cannot be represented as rigid bodies if we are to accurately model the actual
system dynamics. This is because the frames of the tractor–trailer are ﬂexible,
and their bending motion is essential to understanding the system. Automobile
frames bend also, but their bending frequencies are signiﬁcantly higher than those
of the truck and are typically out of the range of interest. Thus, we may be able
to create a lumped-parameter model of the car, but not of the truck.
Multistory buildings, elevated roadways, ﬂexible structures for outer space,
and long hydraulic ﬂuid lines are all examples of engineering systems that can-
not be modeled without some consideration of distributed dynamic effects. This
470
System Dynamics: Modeling, Simulation, and Control of Mechatronic Systems, Fifth Edition
Dean C. Karnopp, Donald L. Margolis and Ronald C. Rosenberg
Copyright © 2012 John Wiley & Sons, Inc.

SIMPLE LUMPING TECHNIQUES FOR DISTRIBUTED SYSTEMS
471
chapter introduces the idea of distributed system modeling within the framework
of bond graphs. Simple lumping techniques are discussed ﬁrst, along with their
limitations. Finite-mode modeling is then shown to produce more accurate low-
order representations for distributed systems. How to combine lumped and dis-
tributed subsystems becomes obvious using this approach, and the use of causality
still aids in formulating the system equations for subsequent computation.
10.1
SIMPLE LUMPING TECHNIQUES FOR DISTRIBUTED SYSTEMS
In the course of deriving a partial derivative equation model of a dynamic com-
ponent or subsystem, it is typical to start with spatially distributed ﬁnite lumps
and then to take the limit as the lumps become inﬁnitesimal in size. One approach
to creating lumped-parameter models for distributed systems is motivated by this
means of deriving equations. We simply stop with the ﬁnite lumps and perform
no limiting process. This approach is physically understandable; however, even
though the continuous equations are approached as the number of ﬁnite lumps
becomes inﬁnite, it is difﬁcult to predict the rate of convergence. Thus, a large
number of lumps may be required to obtain accuracy response predictions even
for low-frequency excitations. In addition, each new lump, while improving low-
frequency prediction, introduces new, very inaccurate results at high frequencies.
This approach to distributed system representation must be used cautiously, and
with awareness on the part of the modeler. Reference [1] surveys the different
approaches to distributed system modeling, of which this simple ﬁnite-lumping
technique is one.
10.1.1
Longitudinal Motions of a Bar
Figure 10.1a shows a continuous representation of a uniform bar of length L,
cross-sectional area A, and mass density ρ. It is ﬁxed at the left end and acted
upon by an external force F(t) at the right. The continuous variable x locates
any section of the bar, and the variable ξ(x, t) represents the displacement of
any cross section from an initially undisplaced state. Figure 10.1b shows a ﬁnite
element of mass, ρAx, with an imbalance in the normal stress σ across it.
Newton’s law yields
Aσ(x + x) −Aσ(x) = ρA x ∂2ξ
∂t2 .
(10.1)
Figure10.1c shows the same section subject to simple strain, yielding the rela-
tionship
σ(x) = E[ξ(x) −ξ(x −x)]
x
,
(10.2)
where E is Young’s modulus. Notice that Eqs. (10.1) and (10.2) are written as
though the lumps occupied different points in space, when, in fact, as x becomes
inﬁnitesimal, the mass lump and stiffness lump relate to the same spatial location.

472
DISTRIBUTED-PARAMETER SYSTEMS
FIGURE 10.1. Vibrating bar.
We will soon let x →0, but ﬁrst we interpret (10.1) and (10.2) as ﬁnite
lumps, and construct a lumped approximation to the system. Let Aσ = F, and
write (10.1) as
Fi+1 −Fi = d
dt pi
(10.3)
and (10.2) as
Fi = EA
x qi,
(10.4)
where
pi = ρA x ˙ξi
(10.5)

SIMPLE LUMPING TECHNIQUES FOR DISTRIBUTED SYSTEMS
473
is the momentum of the ith lump and
qi = ξi −ξi−1
(10.6)
is the relative displacement between the ith and the (i −1)st lump. This yields
the equations
d
dt pi = EA
x (qi+1 −qi),
(10.7)
d
dt qi = pi −pi−1
ρA x .
(10.8)
These equations are those generated by the internal elements in the bond graph
model of Figure 10.2. The ﬁrst element and the nth element must be treated
separately, since they are boundary elements.
From the bond graph of Figure 10.2, the ﬁrst element yields
dq1
dt =
p1
ρA x ,
(10.9)
and the nth element yields
dpn
dt = F(t) −EA
x qn.
(10.10)
To use this approach for an actual system, we would select the number of lumps
we wish to include and let x equal the bar length divided by the number of
lumps. This choice will then set the I and C parameters. We would like to choose
the number of included lumps based on some accuracy criteria; however, as
mentioned previously, it is not possible to determine, a priori, the convergence to
the continuous model for general uses of this lumped model as part of an overall
system. In fact, this approach to representing inherently distributed systems is
FIGURE 10.2. Bond graph ﬁnite-lump model of vibrating bar.

474
DISTRIBUTED-PARAMETER SYSTEMS
FIGURE 10.3. Typical conﬁgurations for ﬁnite-lump model of a bar.
usually used in conﬁgurations as shown in Figure 10.3, the choice being dictated
by causal considerations of the entire system.
Returning to Eqs. (10.1) and (10.2), the continuous model can be derived by
letting x →0 while letting small changes in variables become differentials.
Thus, (10.1) becomes
A∂σ
∂x = ρA∂2ξ
∂t2 ,
(10.11)
for the internal domain of the bar, and (10.2) becomes
σ = E ∂ξ
∂x .
(10.12)

SIMPLE LUMPING TECHNIQUES FOR DISTRIBUTED SYSTEMS
475
Combining (10.11) and (10.12) yields the continuous representation for longitu-
dinal vibration of a bar with no external forcing:
E ∂2ξ
∂x2 = ρ ∂2ξ
dt2 ,
(10.13)
which should be recognized as the simple wave equation.
When dealing with continuum elements, external forcing, such as F(t) in
Figure 10.1, is considered to be distributed over the spatial domain of the element
so that the force acting on any incremental element, F(x, t), would be
F(x, t) = f (x, t)x,
(10.14)
where f (x, t) is the force per unit length and could be distributed over the spatial
dimension x of the rod in this example.
For a point force, such as F(t) acting at x = L in Figure 10.1, the distributed
force per unit length is mathematically expressed through use of the delta func-
tion as
f (x, t) = F(t)δ(x −L).
(10.15)
(The delta function δ(x −L) is a function that is zero everywhere except in
the immediate vicinity of x = L, but when integrated in xover any range that
includes x = L yields unity.)
The total external force acting on the rod is obtained through integration of
f (x) from Eq. (10.15) with respect to x over the total length, and turns out to
be F(t) as expected, since the area under the delta function is unity. The delta
function correctly locates the force, since the delta function is zero except where
its argument is zero. We shall make extensive use of the point force representation
in some of the following development. For our rod example, Eq. (10.13) becomes
F(t)
A δ(x −L) + E ∂2ξ
∂x2 = ρ ∂2ξ
∂t2 ,
(10.16)
when the external forcing at the rod end is included.
We now have two types of representations for the bar. The ﬁrst is a ﬁnite-lump
representation, which will generate a high-order state space when many lumps
are used. This lumped representation is viscerally satisfying because it is exactly
the type of modeling we have been doing all along. We can imagine springs being
compressed and stretched, causing the inertial elements in between to move. It is
easy to “see” the physics of the system. Unfortunately, this ﬁnite-lump approach
may not be particularly good as the number of included lumps increases. The
state space grows very quickly while the accuracy does not.
The second representation for the bar is the linear partial differential equation
(10.16). This recognizes that the bar model is actually of inﬁnite order, and as
long as the simple wave equation is assumed to be valid, quite a lot can be said
analytically about the continuous behavior of the bar. However, if dissipation or

476
DISTRIBUTED-PARAMETER SYSTEMS
nonlinear effects are included (which is more often the case than not), then we
are generally forced to solve the continuum equations numerically. This always
means backing up into a ﬁnite representation of one form or another.
We shall see that the continuous representation can be manipulated using
normal mode techniques to yield a much more accurate and computationally
efﬁcient ﬁnite-order model than does the lumping process described above, even
especially as the continuum is approached by including more and more lumps.
Before proceeding to the use of the continuous model, transverse motion of a
beam is discussed.
10.1.2
Transverse Beam Motion
We assume here that the beam is long and slender and that it is of uniform
cross-sectional area A, mass density ρ, Young’s modulus E, shear modulus G,
area moment of inertia I, and length L. Figure 10.4 shows the beam displaced
FIGURE 10.4. Uniform beam in transverse motion.

SIMPLE LUMPING TECHNIQUES FOR DISTRIBUTED SYSTEMS
477
at some instant of time. The spatial variable x deﬁnes a position along the beam,
and w(x, t) is the transverse displacement of the position x at the time t.
Also shown in Figure 10.4 is a ﬁnite element of the beam with the various
forces and moments acting on it. The angle θ is the rotation of the neutral axis
with respect to a horizontal reference, and the angle φ is the rotation of a plane
cross section with respect to a vertical reference. If φ = θ, then we say there is
no shear deformation. In general φ ̸= θ, and we deﬁne the shear angle γ as
γ = θ −φ.
(10.17)
We shall derive the equations of motion for a Timoshenko model of the beam.
Reference [2] discusses this model thoroughly.
The Timoshenko model includes shear deformation and the rotary inertia of
each cross section. We shall later neglect these effects to reduce our model to
the perhaps more familiar Bernoulli–Euler model of the beam.
From Figures 10.4b and 10.5 we can use Newton’s laws for the element as
V (x + x) −V (x) = ρAx ∂2w
∂t2 ,
(10.18)
and
M(x + x) −M(x) + V (x + x)x = ρIx ∂2φ
∂t2 ,
(10.19)
where it should be noted from Figure 10.5 that the inertia properties and compliant
properties of the beam are assumed to be spatially separate.
From Figure 10.5b, we assume that the bending moment can be calculated as
though pure bending took place. Thus,
M(x) = EI
x [φ(x + x) −φ(x)].
(10.20)
From Figure 10.5c, we assume that the shear V (x) can be related to the shear
angle by
V (x) = kGA(θ −φ),
(10.21)
where
θ(x) = w(x + x) −w(x)
x
,
(10.22)
the slope of the neutral axis. In Eq. (10.21), k is a parameter that accounts for
the actual nonuniform shear distribution across a cross section.
Equations (10.18)–(10.22) suggest the lumped representation shown in
Figure 10.6 and as a bond graph in Figure 10.7. Each element has mass ρAx
and rotary inertia ρIx. The spring elements kb provide the bending moment

478
DISTRIBUTED-PARAMETER SYSTEMS
FIGURE 10.5. Beam elements for use in Timoshenko model.

SIMPLE LUMPING TECHNIQUES FOR DISTRIBUTED SYSTEMS
479
FIGURE 10.6. Lumped representation of Timoshenko beam.
FIGURE 10.7. Bond graph ﬁnite-lump model of Timoshenko beam.
and react to the difference in φ between successive elements, as indicated in
Eq. (10.20). The spring elements ks are the shear springs, and they react to the
difference between θi and φi, at any location i, as indicated in Eq. (10.21), where
θi ∼= wi+1 −wi
x
,
(10.23)
as indicated by Eq. (10.22).

480
DISTRIBUTED-PARAMETER SYSTEMS
The bond graph of Figure 10.7 shows the lumped model of the Timoshenko
beam. The parameters would be chosen in a similar manner as for the bar dis-
cussed previously. We would hope to base the number of included lumps on
some use criteria for the model, then to simply select x to be the beam length
divided by the number of included lumps.
As used in Figure 10.7, the bond graph possesses all integral causality. Thus,
state equations can be straightforwardly derived using the procedures described in
an earlier chapter. Care must be exercised when using this representation as part
of an overall model, to terminate the lumping process in a manner that preserves
integral causality. This will greatly facilitate computation.
We are now in a position to derive the continuous representation of the
beam. Before doing this, it is interesting to reduce our lumped model to a
Bernoulli–Euler beam model. This model neglects rotary inertia and shear defor-
mation. In Figure 10.7, we simply remove the lower inertial elements and the
upper shear compliances. This results in the lumped model of Figure 10.8. Notice
that integral causality still exists, although the shear forces associated with the
upper 0-junctions are no longer set by the shear stiffness elements, but now are
algebraically set by the bending stiffness.
The Timoshenko model can be reduced to a continuum representation by
letting x →0 and letting small differences divided by x become derivatives.
Thus, from Eq. (10.18),
lim
x→0
V (x + x) −V (x)
x
= ∂V
∂x
(10.24)
and
∂V
∂x = ρA∂2w
∂t2 .
(10.25)
FIGURE 10.8. Bond graph ﬁnite-lump model for Bernoulli–Euler beam.

SIMPLE LUMPING TECHNIQUES FOR DISTRIBUTED SYSTEMS
481
Similarly, from Eq. (10.19),
∂M
∂x + V = ρI ∂2φ
∂t2 ,
(10.26)
and from (10.20),
M = EI ∂φ
∂x .
(10.27)
From Eqs. (10.21) and (10.22)
θ = ∂w
∂x ,
(10.28)
and
V = kGA
∂w
∂x −φ

.
(10.29)
We can now combine Eqs. (10.25) and (10.29) to obtain
kGA ∂
∂x
∂w
∂x −φ

= ρA∂2w
∂t2 ,
(10.30)
and we can combine Eqs. (10.26), (10.27), and (10.29) to obtain
EI ∂2φ
∂x2 + kGA
∂w
∂x −φ

= ρI ∂2φ
∂t2 .
(10.31)
Equations (10.30) and (10.31) are the two partial differential equations in the two
unknowns, w(x, t) and φ(x, t), for the continuous uniform Timoshenko beam.
These can be reduced to the Bernoulli–Euler model by neglecting rotary inertia
in (10.31) and letting the shear stiffness become inﬁnite, so that
θ = φ = ∂w
∂x .
(10.32)
Then, substituting into Eq. (10.30) yields
−∂
∂x EI ∂2φ
∂x2 = −EI ∂4w
∂x4 = ρA∂2w
∂t2 ,
(10.33)
or
EI ∂4w
∂x4 + ρA∂2w
∂t2 = 0.
(10.34)
If point forces F1(t) and F2(t) were acting on the Bernoulli–Euler beam at
locations x1 and x2, respectively, along the beam, Eq. (10.34) would become
F1δ(x −x1) + F2δ(x −x2) −EI ∂4w
∂x4 = ρA∂2w
∂t2 .
(10.35)

482
DISTRIBUTED-PARAMETER SYSTEMS
While the Timoshenko model is a more realistic representation in that the high-
frequency behavior is more accurately predicted, the solution is too cumbersome
to pursue here. The interested reader should see Reference [2]. We will henceforth
deal exclusively with the Bernoulli–Euler model.
Before continuing into the main emphasis of this chapter, it is perhaps useful
to summarize the salient points that have been demonstrated here by example.
1. A lumped-parameter model can usually be found for a distributed system by
following the derivation for the continuous equations up to the point where
a typical element of the continuum is allowed to become inﬁnitesimal
and then simply retaining a ﬁnite size for the element. Such a lumped
model may not be very accurate without retaining a large number of small
elements.
2. The lumped-parameter representations have the advantage that they can be
straightforwardly combined into an overall system model. Also, nonlin-
ear effects pose no particular problems. The disadvantage to the lumped-
parameter approach described so far is that the model will generate a large
state space and can cause severe computational problems due to large dis-
parities in the time scales of the distributed portion of the model and the
remainder of the system.
3. True continuum models can yield insight into system behavior when ana-
lytical solutions are available, which typically restricts us to the linear
case. However, it is usually difﬁcult to incorporate a continuum model
into an overall system model with interactions with complex lumped sys-
tems (or other continuous systems) external to the continuum. When this is
attempted, it becomes a problem of solving the partial differential equations
for the continuum part, subject to complicated boundary conditions for the
attached parts. This is really not a practical approach for obtaining an
insightful representation of an overall system. It is much better to ﬁnd an
accurate, low-order, lumped-parameter representation for the continuous
part of the system which can interact easily with external dynamics. We
do this next.
10.2
LUMPED MODELS OF CONTINUA THROUGH SEPARATION
OF VARIABLES
Many physical elements from which engineering systems are constructed possess
a continuous distribution of inertia and compliance properties. The rod and beam
presented previously are examples of such elements, as are stretched cables,
membranes, plates, and shells. An aircraft fuselage is an example of a complex
system composed of distributed elements. When it is justiﬁed, and when we as
modelers choose to do so, these distributed elements can be represented by linear
partial differential equations in space and time.

LUMPED MODELS OF CONTINUA THROUGH SEPARATION OF VARIABLES
483
The actual physical dynamics of these distributed elements and systems are
composed of propagating waves that reﬂect from boundaries and add together
to produce what is actually observed at any point and time. There is mathemat-
ical development that we could pursue to demonstrate that continuous systems
with distributed inertia and compliance properties possess wavelike behavior.
However, this will not be carried out here, and the interested reader should see
Reference [3].
Instead, we will pursue separation of variables, an alternative approach to
representing the motion time history of linear, distributed wavelike systems.
As will be seen, this approach yields an elegant lumped-parameter bond graph
representation of distributed elements which can easily be coupled with bond
graph models of attached dynamic systems to yield an extremely accurate over-
all system model possessing all the formulational and computational virtues
associated with bond graphs. It is possible to pursue separation of variables
in a very general way and demonstrate some very useful characteristics of
the approach that apply to any appropriate continuum. Again, Reference [3]
is recommended for that development. Here, we will demonstrate the approach
through example.
10.2.1
The Bar Revisited
The equation for forced longitudinal vibration of a bar is Eq. (10.16), repeated
here as
ρ ∂2ξ
∂t2 −E ∂2ξ
∂x2 = F(t)
A δ(x −L).
(10.36)
Separation of variables begins by temporarily setting the force F(t) to zero
and assuming that the displacement at any point and time, ξ(x, t), can be sep-
arated into a product of a function of x only, Y(x), and a function of time
only, f (t):
ξ(x, t) = Y(x)f (t).
(10.37)
Note that this general function of time f (t) is not the force density of Eqs.
(10.14) and (10.15).
Substitution into the homogeneous form of (10.36) yields
ρY d2f
dt2 −Ef d2Y
dx2 = 0.
(10.38)
Dividing by ρYf yields
1
f
d2f
dt2 = E
ρ
1
Y
d2Y
dx2 .
(10.39)
The collection of terms on the left of (10.39) is, by assumption, dependent on
time only, while the collection of terms on the right is dependent on x only. For

484
DISTRIBUTED-PARAMETER SYSTEMS
this to be true for all values of the independent variables x and t, each collection
of terms must be equal to the same constant. By convention we let
1
f
d2f
dt2 = −ω2,
(10.40)
with the result
d2f
dt2 + ω2f = 0,
(10.41)
d2Y
dx2 + ρ
E ω2Y = 0.
(10.42)
For a separated solution to exist, the two ordinary differential equations (10.41)
and (10.42) must be satisﬁed.
First consider Eq. (10.42), for the spatial function Y(x). For this simple
example, the spatial differential equation is easily solved:
Y(x) = A cos kx + B sin kx,
(10.43)
where
k2 = ρ
E ω2.
(10.44)
To complete the solution for Y(x), we must now specify the boundary conditions.
For the bar of Figure 10.1, the displacement at the left end, ξ(0, t), is zero.
At the right end, we have a choice of ways to express the boundary condition.
We can include the force F(t) in the boundary condition by balancing it with
the normal stress at x = L. Thus,
σ(L, t)A = F(t),
(10.45)
or
EA∂ξ
∂x (L, t) = F(t).
(10.46)
We can also think of the force as being applied a very small distance upstream
of the right end, so that the right end itself is stress-free. Thus,
σ(L, t) = E ∂ξ
∂x (L, t) = 0.
(10.47)
This replacement of the boundary forcing with a limiting form of forcing in the
bar interior is analytically convenient, and it causes no problems, since we are
only interested in solutions to within a ﬁnite scale of ﬁneness. The boundary
conditions for our example become
ξ(0, t) = Y(0)f (t) = 0,

LUMPED MODELS OF CONTINUA THROUGH SEPARATION OF VARIABLES
485
or
Y(0) = 0,
(10.48)
and
∂ξ
∂x (L, t) = dY
dx (L) · f (t) = 0,
or
dY
dx (L) = 0.
(10.49)
Application of (10.48) and (10.49) to (10.43) yields
A = 0,
(10.50)
and
Bk cos kL = 0.
(10.51)
Equation (10.51) is called the frequency equation, and it is analogous to the
characteristic equation for the eigenvalues of a lumped system.
The solution continues by recognizing that if B or k is zero, then Y(x) = 0
and ξ(x, t) = 0, a possible but uninteresting solution. Instead, we let
cos kL = 0,
(10.52)
with the result
knL = (2n −1)π
2 , n = 1, 2, 3, . . . ,
(10.53)
and, from Eq. (10.44),
ω2
n = E
ρ k2
n = E
ρ
(knL)2
L2
,
or
ωn =

E
ρ
(2n −1)
L
π
2 , n = 1, 2, 3, . . .
(10.54)
Accompanying each ωn is a special shape function, Yn(x), from Eq. (10.43):
Yn(x) = Bn sin

knL x
L

= Bn sin

(2n −1)π
2
x
L

, n = 1, 2, 3, . . .
(10.55)
The constants Bn are arbitrary, and it is convenient here to set them equal to
unity.
The shape functions Yn(x) are frequently called eigenfunctions, mode shapes,
or normal modes. Corresponding to each mode shape is a natural frequency
ωn. Figure 10.9 shows a few mode shapes for a bar ﬁxed at the left end and

486
DISTRIBUTED-PARAMETER SYSTEMS
FIGURE 10.9. Mode shapes for the bar.
free at the right. One interpretation of a mode shape and its frequency is that,
if the rod is initially displaced in the shape of a mode and released, it will
oscillate harmonically in that modal conﬁguration at the corresponding modal
frequency. Another fact about these modes and frequencies is that any motion
time history that the bar executes, from any initial conditions, is a linear combi-
nation of the mode shapes oscillating at their respective natural frequencies. And
another most useful fact about these mode shapes is that they are orthogonal,
in that
 L
0
Yn(x)Ym(x) dx = 0, n ̸= m,
(10.56)

LUMPED MODELS OF CONTINUA THROUGH SEPARATION OF VARIABLES
487
or
 L
0
sin

(2n −1)π
2
x
L

sin

(2m −1)π
2
x
L

dx =

0,
n ̸= m,
L/2,
n = m,
(10.57)
for the bar example. We shall make use of this fact soon.
We are interested in the forced response of the bar, but so far we have dealt
only with the unforced response. We now make use of the fact [3] that the
response of the bar, forced or unforced, can always be expressed as a linear
combination of the mode shapes. We write
ξ(x, t) =
∞
	
n=1
Yn(x)ηn(t)
(10.58)
and use this assumption in the forced equation (10.36). Thus,
	
n
ρAYn ¨ηn −
	
n
AE d2Yn
dx2 ηn = F(t)δ(x −L).
(10.59)
Now, multiply each term by the mth mode shape Ym(x), and integrate term by
term over the bar length:
	
n
 L
0
ρAYnYmdx

¨ηn +
	
n
 L
0
ρAYnYmdx

ω2
nηn
=
 L
0
F(t)δ(x −L)Ymdx,
(10.60)
where Eq. (10.42) has been used in the second term by substituting
d2Yn
dx2 = −ρ
E ω2
nYn.
(10.61)
As the summation is carried out for n = 1, 2, . . . , each integral on the left-hand
side of (10.60) is zero except for n = m, leaving only one equation,

 L
0
ρAY 2
m dx

¨ηm +

 L
0
ρAY 2
m dx

ω2
mηm =
 L
0
F(t)δ(x −L)Ym dx.
(10.62)
The integral on the left side is called the modal mass mm:
mm =
 L
0
ρAY 2
m dx, m = 1, 2, . . . .
(10.63)

488
DISTRIBUTED-PARAMETER SYSTEMS
For the bar, it is simply
mm = ρAL
2
,
(10.64)
independent of the mode number.
The integral on the right side of (10.62) is called the modal forcing function
and is particularly simple to evaluate for point forcing. The delta function assures
that no contribution to the integral occurs until x = L, at which point Ym(x) is
virtually constant as we sweep across the delta function and equals Ym(L). Thus
the integral becomes
 L
0
F(t)δ(x −L)Ym(x) dx = F(t)Ym(L)
 L
0
δ(x −L) dx = F(t)Ym(L).
(10.65)
Thus, Eq. (10.62) becomes
mm ¨ηm + kmηm = F(t)Ym(L),
(10.66)
where mm is the modal mass
mm =
 L
0
ρAY 2
m(x) dx = ρAL
2
,
(10.67)
km is the modal stiffness
km = mmω2
m,
(10.68)
and Ym(x) and ωm are known from the unforced analysis for the mode shapes.
The beauty of this approach to distributed systems is that, due to mode orthogo-
nality, all the equations in Eq. (10.66) are decoupled from one another, and each
ηm(t) can be solved for separately and then combined with the mode shapes
Ym(x) in Eq. (10.58) to produce the actual response,
ξ(x, t) =
∞
	
m=1
Ym(x)ηm(t).
(10.69)
Obviously, only a ﬁnite number of modes can be retained in the solution.
This development is becoming long, so we move quickly to a very interesting
result. Deﬁne the modal momentum pm as
pm = mm ˙ηm
(10.70)
and the modal displacement qm as
qm = ηm.
(10.71)

LUMPED MODELS OF CONTINUA THROUGH SEPARATION OF VARIABLES
489
Then Eq. (10.66) can be written as
d
dtpm = −kmqm + F(t)Ym(L),
(10.72)
and
dqm
dt
= pm
mm
.
(10.73)
We have reduced the mth modal equation to two ﬁrst-order state equations in
terms of bond graph energy variables, pm and qm. Figure 10.10 shows a bond
graph that would duplicate these modal equations for m = 1, 2, 3, . . . Notice that
integral causality exists for all m included modes and that the external force F
properly excites each mode according to Eqs. (10.72) and (10.73). The transform-
ers are simply the mode shapes from Eq. (10.55) evaluated at the location of the
force. The bond graph also enforces that the ﬂow on the external force bond,
which must be ∂ξ(L, t)/∂t, is the summation of the modal ﬂows multiplied by
appropriate transformer moduli:
∂ξ
∂t (L, t) = Y1(L) p1
m1
+ Y2(L) p2
m2
+ · · · + Ym(L) pm
mm
,
(10.74)
which is exactly Eq. (10.69) evaluated for the velocity at x = L. In fact, from
Eq. (10.69),
F(t)∂ξ
∂t (L, t) =
∞
	
m=1
F(t)Ym(L)˙ηm(t),
(10.75)
FIGURE 10.10. Bond graph for modal vibration of a bar forced at x = L.

490
DISTRIBUTED-PARAMETER SYSTEMS
but F(t)Ym(L) is the mth modal force, and ˙ηm(t) is the mth modal ﬂow. Thus
the external force times the velocity at the input port equals the summation of the
modal forces times corresponding modal ﬂows. This is a statement of a power-
conserving transformation, and the transformer fan of Figure 10.10 represents
this transformation from physical variables to modal variables and back.
A good question at this point is: Why construct a bond graph when we have
already tediously derived the equations (10.66) subject to (10.58)? The answer
becomes obvious when we realize that the external force F(t) is probably not a
speciﬁed input, but rather resulted from interaction with some external system.
For instance, if the end of the rod had an attached transducer which we decided
to represent by a simple mass–spring–damper system, the bond graph of the
interaction would be as shown in Figure 10.11. The modal dynamics are iden-
tical to Figure 10.10, and the external dynamic system simply attaches to the
external port, where the end forcing F(t) is now an internal force, as shown in
Figure 10.11. Since integral causality still exists, equations for the entire inter-
acting system can be straightforwardly derived. Of course, only a ﬁnite number
of modes can be retained for the distributed part of the system.
If the rod end were terminated with a compliant member and then attached
to another distributed rod, the model would be as shown in Figure 10.12, where
n modes have been retained for each rod. Again, integral causality exists, and
equation derivation is straightforward.
FIGURE 10.11. Finite-mode model of a rod with a lumped system attached at x = L.

LUMPED MODELS OF CONTINUA THROUGH SEPARATION OF VARIABLES
491
FIGURE 10.12. Two distributed rods interacting through a compliant and dissipative
element.
The reader who is gaining some familiarity with bond graph procedures should
be starting to appreciate the utility and elegance of constructing models using this
ﬁnite-mode approach. We will allow this good feeling to persist a little longer
before discussing some of the pitfalls of this approach.
Before leaving the rod example, it should be noted that any location on the
rod can be used as an output. We simply consider any desired output point as
a location for a force input equal to zero. The bond graph for two such output
points, x1 and x2, is shown in Figure 10.13. As can be seen, drawing every bond
in the bond graph can become very messy. In practice we do not include output
points on the bond graph. Instead we use Eq. (10.69) and recognize that
∂ξ
∂t (xi, t) = Y1(xi) p1
m1
+ Y2(xi) p2
m2
+ · · · + Yn(xi) pn
mn
.
(10.76)
Some excellent questions that may have arisen by now are
1. Is this approach only good for longitudinal vibration of rods ﬁxed at one
end and free at the other?
2. How many retained modes are enough?
3. What happens when causal ﬂow inputs to the modes exist?
We will answer these questions in the following sections.
10.2.2
Bernoulli–Euler Beam Revisited
One criticism of the ﬁnite-mode approach for representing distributed system
dynamics is that the problem must be reformulated any time the boundary condi-
tions change. Also, the boundary conditions in physical systems are ill-deﬁned.

492
DISTRIBUTED-PARAMETER SYSTEMS
FIGURE 10.13. Bond graph showing how to obtain output at any point along the rod.
For instance, if we decide to represent a truck frame as a beam, there are no
deﬁnite boundary conditions. There are only additional physical elements, such
as suspension components, engine mounts, and cab mounts, attached at various
points. The frame is not pinned or built in, so what modes should we use?
It turns out that the most general modes to use for ﬁnite-mode modeling of
distributed systems are those modes associated with force-free boundaries. A
heuristic argument is that modes associated with ﬁxed boundaries, such as the
modes for our bar example evaluated at the ﬁxed end, can never produce a
response at the ﬁxed end other than zero, regardless of how hard we might push
on that location. The modes are all zero at the ﬁxed end, and from Eq. (10.58),
the motion will always be zero there. Thus, if we decide that some previously
assumed ﬁxed boundary was not really ﬁxed, but actually has a mass attached,
then we must reformulate the problem and use different mode shapes.
On the other hand, if we had started with force-free modes and later decided
that a boundary was attached to ground through a stiff spring, the force-free
modes are perfectly capable of adding up, according to Eq. (10.58), to a very
small motion. The motion can even be zero if we decide to ﬁx a previously

LUMPED MODELS OF CONTINUA THROUGH SEPARATION OF VARIABLES
493
force-free boundary. Thus, when using the ﬁnite-mode approach, it is best to use
force-free modes unless the boundary conditions are well known and not subject
to change.
The use of force-free modes adds a variation to the bond graph structure of
Figure 10.13. This will be presented through the example of the Bernoulli–Euler
beam described in Section 10.1. Unfortunately, the force-free modes are more
difﬁcult to derive than are modes for some other boundary conditions. However,
once obtained (analytically, approximately, or even experimentally), they become
part of our modeling arsenal, to be stored in our computer ﬁles, for use over and
over again.
Figure 10.14 shows the Bernoulli–Euler beam acted upon by two exter-
nal forces, F1(t), and F2(t). The equation of motion is repeated here from
Eq. (10.35):
EI ∂4w
∂x4 + ρAd2w
∂t2 = F1δ(x −x1) + F2δ(x −x2).
(10.77)
The force-free boundary conditions are that no shear force and no moment exist
at x = 0 and x = L. From Eqs. (10.26), (10.27), and (10.28), these conditions
can be written in terms of w(x, t) as
∂2w
∂x2 (0, t) = ∂2w
∂x2 (L, t) = 0
(10.78)
for the zero-moment constraint and
∂3w
∂x3 (0, t) = ∂3w
∂x3 (L, t) = 0
(10.79)
for the zero-shear constraint.
FIGURE 10.14. Uniform Bernoulli–Euler beam with point forcing.

494
DISTRIBUTED-PARAMETER SYSTEMS
Proceeding as we did in the bar example, we try a separated solution for the
homogenous form of (10.77) and assume
w(x, t) = Y(x)f (t).
(10.80)
Substituting into (10.77) yields
EI d4Y
dx4 f + ρAY d2f
dt2 = 0.
(10.81)
Dividing each term by ρAYf yields
EI
ρA
1
Y
d4Y
dx4 + 1
f
d2f
dt2 = 0.
(10.82)
This equation can be satisﬁed at all x and all t only if both terms equal the same
constant. By convention we let the second term equal −ω2, yielding
d2f
dt2 + ω2f = 0
(10.83)
and
d4Y
dx4 −ρA
EI ω2Y = 0,
(10.84)
or
d4Y
dx4 −k4Y = 0,
(10.85)
where
k4 = ρA
EI ω2.
(10.86)
Equation (10.85) is a total differential equation, which, when solved subject
to the boundary conditions (10.78) and (10.79), will yield the mode shapes and
associated mode frequencies. Using Eq. (10.80) in the boundary conditions yields
d2Y
dx2 (0) = d2Y
dx2 (L) = d3Y
dx3 (0) = d3Y
dx3 (L) = 0.
(10.87)
The spatial equation (10.85) has the general solution [3]
Y(x) = A cosh kx + B sinh kx + C cos kx + D sin kx.
(10.88)
We will not cover all the algebra here. However, using Eq. (10.87) in Eq. (10.88)
yields the frequency equation
cosh knL cos knL = 1,
(10.89)

LUMPED MODELS OF CONTINUA THROUGH SEPARATION OF VARIABLES
495
and the mode shape functions
Yn(x) = (cos knL −cosh knL)(sin knx + sinh knx)
−(sin knL −sinh knL)(cos knx + cosh knx).
(10.90)
We now solve (10.89) for the special values of knL, and use these in (10.86)
to obtain the mode frequencies as
ω2
n = EI
ρA
(knL)4
L4
.
(10.91)
At this point we must recognize that the force-free boundary conditions permit
ωn = kn = 0 to be a mode frequency. Using this information yields
d4Y
dx4 = 0,
(10.92)
or
Y = c1x3 + c2x2 + c3x + c4.
(10.93)
There are two possible solutions to (10.93) that satisfy the boundary conditions:
They are Y = const and Y = ax + b. These are called rigid-body modes, and
it is convenient to think of them as rigid-body vertical translation of the entire
beam and rigid-body rotation of the beam about the centrally located center of
mass. Thus,
Y00 = 1,
(10.94a)
and
Y0 = x −L
2 .
(10.94b)
The bending modes are given by (10.90) and are rather complicated functions.
We will ﬁnd that the rigid-body modes are orthogonal in the same sense as
previously presented,
 L
0
ρAYn(x)Ym(x)dx = 0,n ̸= m,
(10.95)
for n, m = 00, 0, 1, 2, 3, . . .
The calculation of the forced response proceeds in a similar fashion to the bar
example. We assume that the forced solution has the form
w(x, t) =
∞
	
n=0
Yn(x)ηn(t)
(10.96)

496
DISTRIBUTED-PARAMETER SYSTEMS
and use this in the forced equation (10.77). We then multiply each term by
Ym(x) and integrate with respect to x from x = 0 to x = L. Then we use the
orthogonality property of the modes and obtain
 L
0
ρAY 2
n dx

¨ηn +
 L
0
ρAY 2
n dx

ω2
nηn = F1Yn(x1) + F2Yn(x2),
(10.97)
which has exactly the same form as Eq. (10.66) for the bar example. The ﬁrst
zero-frequency mode yields

 L
0
ρA(1)2dx

¨η00 = F1 + F2,
(10.98)
or
m¨η00 = F1 + F2,
(10.99)
which simply states that the external forces accelerate the center of mass of the
beam. The other zero-frequency mode yields
 L
0
ρA

x −L
2
2
dx

¨η0 = F1

x1 −L
2

+ F2

x2 −L
2

,
(10.100)
or
Jg ¨η0 = F1

x1 −L
2

+ F2

x2 −L
2

,
(10.101)
which simply states that the moment of the external forces about the center of
mass produces angular acceleration ¨η0, where Jg is the centroidal moment of
inertia of the beam.
The bond graph for a beam with force-free boundary conditions is shown in
Figure 10.15. The rigid-body modes, which will be present whenever force-free
boundaries are assumed, appear simply as inertia elements with no associated
modal stiffness. The ﬁrst inertia parameter is beam mass m, and the second is
the beam moment of inertia Jg. The —TF— elements connected to the rigid-body
modes correctly apply the forces and moments to these elements. The rest of the
structure is identical to the bar example. The modal masses are still, symbolically,
mn =
 L
0
ρAY 2
n dx, n = 1, 2, . . . ,
(10.102)
and the modal stiffnesses are still
kn = mnω2
n.
Only this time the modes Yn are given by Eq. (10.90), and the frequencies
ωn come from solving Eq. (10.89). Nobody said life would be easy, but the

LUMPED MODELS OF CONTINUA THROUGH SEPARATION OF VARIABLES
497
integration required in (10.102) need only be carried out once in your life in the
nondimensional form
mn
m =
 1
0
Y 2
n
 x
L

d x
L
(10.103)
and then stored away for use whenever needed. The integration would probably
be carried out numerically anyway.
The true virtue and elegance of this modeling procedure comes when we
recognize that the external forces, F1 and F2 in this example, probably result
from some attached dynamic system and can be appended to Figure 10.15 in
straightforward bond graph fashion. For instance, the beam in Figure 10.16 has
suspension components at the two ends and a one-degree-of-freedom system
attached at x = xF . Perhaps this is an optical bench with a laser turning mirror
at x = xF , and we are trying to design the suspension to isolate the mirror
from ground motion. The ﬁnite-mode bond graph is also shown in Figure 10.16.
We simply treat all attached components as external forcing and show these
with 0-junctions for each force location. Each 0-junction is attached to each
1-junction with the modal components, through —TF— elements with moduli
equal to appropriate mode functions evaluated at the location of the force. The
attached systems are then appropriately appended to the external 0-junction bonds
to form a complete, low-order, very accurate system model for all frequencies of
excitation up to the highest natural frequency included o the model.
While we have not been as general in our development as is possible, it
should be realized now that the structure of Figure 10.15 is entirely general
and represents all distributed structures that exhibit normal-mode behavior. The
mode shapes change and the modal masses and stiffnesses change from system
to system. But the bond graph structure is invariant. The modes can be obtained
analytically, as was done here for the bar and the beam, or they can be obtained
approximately, as described in Reference [4] for vibrating plates. They can be
FIGURE 10.15. Bond graph for Bernoulli–Euler beam with force-free boundaries.

498
DISTRIBUTED-PARAMETER SYSTEMS
FIGURE 10.16. An example of a distributed system interacting with attached lumped
systems.
obtained by ﬁnite-element methods and then used in the bond graph structure to
construct low-order, understandable models. And the modes can even be obtained
experimentally using structural dynamic testing devices and programs. No matter
how the modes are obtained, their ﬁnite-mode representation is as shown in
Figure 10.15, and they are ready to interact with any external dynamic elements,
even nonlinear ones.
Also, while not derived here, external moments can also be applied to
the structure of Figure 10.15. If a moment is applied instead of a force, the

GENERAL CONSIDERATIONS OF FINITE-MODE BOND GRAPHS
499
associated —TF— elements, coming from the moment 0-junction, have the
mode shape slopes, (dYn/dx), evaluated at the location of the moment as their
moduli instead of the mode shapes themselves.
10.3
GENERAL CONSIDERATIONS OF FINITE-MODE BOND GRAPHS
The reader who has begun to appreciate the virtues of bond graph modeling with
regard to ease in putting all types of systems together, ease in identifying physical
state variables, ease in deriving state equations, and ease in obtaining computer
solutions through use of some very automated software has certainly begun to
appreciate the ease with which distributed systems can be made to interact with
dynamic subsystems. Some questions still remain in the practical application
of the ﬁnite-mode concept, and some of the most prominent are answered in
this section.
10.3.1
How Many Modes Should Be Retained?
When a distributed component is part of an overall physical dynamic system
model, we often have some idea of the frequency band of interest. This comes
from our engineering judgment, and, unfortunately, there is no substitute for
exercising this judgment when we construct any system model, regardless of
the modeling approach. If we were constructing a model of a long-haul truck
interacting with the roadway unevenness, and decided to model the frame as a
beam with the wheels attached through their suspension elements, we would make
use of our knowledge that input frequencies from the road rarely exceed 20 Hz
at normal driving speeds, wheel hop in trucks is around 15 Hz, and suspension
frequencies are usually less than 2 Hz. It would then be obvious that very high-
frequency beam modes would contribute very little to the response in the 20-Hz
frequency range of interest.
We can quantify this thought somewhat by considering how a lightly damped
mode responds to a harmonic input. Figure 10.17 shows a general ﬁnite-mode
representation with one input location. The equation governing the contribution
of the ith mode is
mi ¨ηi + kiηi = FYi.
(10.104)
If there is some damping associated with the mode, then (10.104) can be written as
¨ηi + 2ξiωi ˙ηi + ω2
i ηi = F
mi
Yi,
(10.105)
where ξi is the mode damping ratio.
For F harmonic, the mode frequency response for ˙ηi has the magnitude

˙ηi
F
mi Yi
 =
ω
ωi
1
ωi

1 −ω2
ω2
i

+

2ξi
ω
ωi
21/2 .
(10.106)

500
DISTRIBUTED-PARAMETER SYSTEMS
FIGURE 10.17. General ﬁnite-mode bond graph.
This response is sketched in Figure 10.18. At low excitation frequency, (10.106)
becomes
˙ηi|ω/ωi≪1 ∼YiF
1
miω2
i
ω = Yi
F
ki
ω,
(10.107)
and the response is governed by the modal stiffness, k. We call this low-frequency
range the stiffness-controlled region in Figure 10.18. At frequencies near ωi, the
response is
˙ηi|ω/ωi∼=1 ∼= F
mi
Yi
1
2ξiωi
FYi
1
bi
,
(10.108)
where bi is the mode damping constant, bi = 2ξiωimi. We call the frequency
range near ω/ωi = 1 the resistance-controlled region. Finally, at frequencies
high compared to ωi, we get
˙ηi|ω/ωi≫1 ∼F
mi
Yi
1
ω,
(10.109)
and we see that the response is governed by the modal mass only. This high-
frequency range is called the mass-controlled region.
If we have reasonable knowledge of input frequency content, then we know
which modes will be excited signiﬁcantly below their mode frequencies and will
therefore be in the stiffness-controlled region. For those inﬁnity of modes in the
stiffness-controlled region, their inertia and resistance are of no consequence and
can be ignored. At this point we can either prune these high-frequency modes

GENERAL CONSIDERATIONS OF FINITE-MODE BOND GRAPHS
501
FIGURE 10.18. Frequency response of a single mode.
altogether or choose to retain their modal stiffness to improve the static stiffness
representation of the distributed system.
In fact, for distributed systems with only one input location, the residual
compliance due to the inﬁnity of stiffness-controlled modes can be calculated
straightforwardly. Consider Figure 10.19, where n dynamic modes have been
retained, and n has been selected to extend well beyond the frequency range of
interest. The remaining modes are represented by their modal compliance only.
Notice that all the stiffness-controlled modes are in derivative causality.
The contribution of the modal ﬂows (˙qn+1, qn+2, . . .) of the stiffness-controlled
modes to the output velocity v we will call the residual velocity, vR. From the
bond graph,
vR = Yn+1 ˙ηn+1 + Yn+2 ˙ηn+2 + · · · ,
(10.110)
but
˙ηn+1 =
1
kn+1
˙Fn+1, ˙ηn+2 =
1
kn+2
˙Fn+2, etc.
(10.111)
and
Fn+1 = Yn+1F, Fn+2 = Yn+2F, etc.
(10.112)

502
DISTRIBUTED-PARAMETER SYSTEMS
FIGURE 10.19. Finite-mode bond graph including residual compliance.
Thus,
vR = Y 2
n+1
kn+1
˙F + Y 2
n+2
kn+2
˙F + · · · ,
(10.113)
or
vR =
⎛
⎝
∞
	
j=1
Y 2
n+j
kn+j
⎞
⎠d
dtF.
(10.114)
This same contribution to the output velocity would occur on introducing the
single residual stiffness element kr, where
1
kr =
∞
	
j=1
Y 2
n+j
kn+j
,
(10.115)
as shown also in Figure 10.19. The summation of Eq. (10.105) converges very
quickly and is easily performed numerically.

GENERAL CONSIDERATIONS OF FINITE-MODE BOND GRAPHS
503
It should be pointed out that, when more than one input is acting on the dis-
tributed system, the residual compliance is not calculated from the simple formula
(10.115). Instead, a C-ﬁeld representation is needed for the stiffness-controlled
modes. The ﬁeld constitutive properties can be determined, but frequently it is
easier to simply eliminate the pruned modes altogether.
As a rule of thumb, it is recommended that modes be retained up to a frequency
at least a factor of 2, but no more than a factor of 5, higher than the highest
frequency of interest.
10.3.2
How to Include Damping
The normal-mode representation for distributed system dynamics has been for-
mulated without damping. And, strictly speaking, separation of variables and the
general bond graph structure of Figures 10.15 and 10.17 are correct only in the
absence of damping altogether or the presence of damping in a very special form.
In general, distributed elements that we want to include in overall system mod-
els are typically lightly damped. Lightly damped modes are the ones that cause
undesirable system response or difﬁculties for control systems.
We cannot identity exactly from where on the structure the damping arises.
We only know for certain that, once excited, the energy will be dissipated. The
mechanisms are complex; some dissipation is due to minute plastic deformations
of the material, and some to the radiation of energy from material surfaces. One
thing that is certain is that there are no little dampers attached to the structure
that one can point to and therefore include in a model in order to represent the
damping of the distributed elements.
It is customary to not attempt to perform detailed modeling of the damp-
ing mechanisms, but instead to include damping functionally by incorporat-
ing it into the individual modes. This is accomplished by simply appending
R-elements to the mode oscillators of the modal bond graph. The general struc-
ture of Figure 10.17 will then become as shown in Figure 10.20. Treating each
mode oscillator as an individual single-degree-of-freedom system, the resistance
parameter Ri is set by
Ri = 2ξiωimi,
(10.116)
where ξi is the modal damping ratio. Typically structures are lightly damped, with
ξi in the range of 0.01–0.1, where the high value would perhaps be representative
of some composite structures. If experimental data were available, we could
improve upon this seemingly crude inclusion of damping. However, usually the
inclusion of modal damping as described above produces very accurate and useful
models.
10.3.3
Causality Consideration for Modal Bond Graphs
From Chapter 2, the reader should be familiar with the concept of causality and
with the useful information it supplies with regard to equation formulation and
the computability of one’s model. We know that integral causality throughout a

504
DISTRIBUTED-PARAMETER SYSTEMS
FIGURE 10.20. General ﬁnite-mode bond graph with modal damping.
model indicates that formulation will be straightforward. If any derivative causal-
ity exists or some arbitrary assignment of causality is required, then we know
that algebraic problems exist in the model, and formulation of equations can be
difﬁcult, if not impossible, when nonlinear elements are involved.
Another implication of causality relates to the general uniﬁcation of some
part of a system model with the models of other parts of the system. For
instance, the bond graph modal representation of Figure 10.20 is not a complete
model, because we intend to connect the external bond, carrying F and v, with
some other dynamical elements. In Figure 10.20, the force F is a causal input to
the modes, and the velocity v is a causal output. The bond graph possesses all
integral causality. We thus could straightforwardly formulate the state equations
for this bond graph fragment, and, as long as we agreed to use this fragment only
in its present causality, these equations would never change. We would simply
need to know the input F and the equations would deliver the output v. Of
course, any attached dynamical model will have some causal restrictions, since
it must have F as an output and accept v as an input. Such is the construction of
computable models.
As we have seen in every ﬁnite-mode model presented so far, integral causality
exists for all I- and C-elements, and the effort variable has been the causal
input on all external bonds. Consider Figure 10.21, where a general n-mode
representation is shown along with two external input locations. The causal effort
F1 is an input at one input location, but the causal ﬂow v2 is an input at the other
location. The reader should assign causality to show that, with a causal ﬂow input,
one I-element in the modes must be in derivative causality. For this example,
the nth modal inertia has been selected to be put into derivative causality. In

GENERAL CONSIDERATIONS OF FINITE-MODE BOND GRAPHS
505
FIGURE 10.21. Finite-mode bond graph with causal ﬂow input at one input location.
general, it can be shown that for each additional causal ﬂow input to the modes,
one additional modal inertia will be forced into derivative causality.
One result of the derivative causality is that a state variable is lost, since pn is
no longer an indepent state variable, and the accuracy of the n-mode description
is somewhat reduced. This really presents no problem, since we can always
include additional modes and, in fact, have probably already included more than
enough modes if recommended procedures have been followed in formulating
the original model.
The real disadvantage of allowing derivative causality is in the formulation
of system equations for analysis or simulation. If we attempt to use procedures
described in Chapter 5 to deal directly with the derivative causality, we write
pn = mn ˙ηn
(10.117)
and follow the causality for ˙ηn, obtaining
pn = mn
1
Yn,2

v2 −Yn−1,2
Pn−1
mn−1
−· · · −Y2,2
p2
m2
−Y1,2
p1
m1

.
(10.118)
We see that pn depends on all n −1 other modal momenta in the mode descrip-
tion, and it also depends on the external input, v2. If we attempt to write the state
equations for I-elements in integral causality, we ﬁnd that ˙p1, ˙p2, . . . , ˙pn−1 will
all require ˙pn in their equations, and ˙pn, from (10.118), is
˙pn = mn
1
Yn,2

˙v2 −Yn−1,2
˙pn−1
mn−1
−· · · −Y2,2
˙p2
m2
−Y1,2
˙p1
m1

.
(10.119)
Thus, all the modal momenta are coupled, and obtaining explicit state equations
becomes very difﬁcult. To make matters worse, the derivative of the input veloc-
ity, ˙v2, is also required. The velocity v2 probably is causally determined by some

506
DISTRIBUTED-PARAMETER SYSTEMS
inertial elements external to the modes; thus, additional momentum variables
will couple with the modal momenta, making the algebraic problem worse. In
fact, this coupling of dynamic elements external to the mode structure practically
precludes the derivation of equations for the modes as separate entities to be
used over and over with different external dynamic systems.
A matter of computational importance is that when derivative causality is
permitted, we invariably end up with a mode shape factor (transformer modulus)
in the denominator of the algebraic expression (10.119). In Eq. (10.119), Yn,2
(mode shape n evaluated at position 2) is in the denominator of the right-hand
side. If it should happen that Yn,2 is zero or very small (position 2 is at or very
near a node of mode n), then computational problems will result. Reference [5]
discusses this problem further. The bottom line of this discussion is that it would
be very nice to avoid derivative causality when using ﬁnite-mode models for
distributed systems.
It turns out that the derivative causality can be avoided while still permitting
causal ﬂow inputs to the mode. We simply include an additional modal compli-
ance in the model without the associated modal inertia. And we include as many
additional modal compliances as there are external inputs with ﬂow-in causal-
ity. This addition of modal C-elements without their associated I-elements will
pose no accuracy problems, since the original choice of n modes was based on
ensuring that the higher frequency modes were already stiffness controlled. Thus,
additional modes are certainly stiffness controlled, and their modal inertia is of
no consequence to the system response.
Figure 10.22 shows the general n-mode structure of Figure 10.21 repeated with
the addition of the (n + 1)st modal compliance. Notice that v2 is still a causal
FIGURE 10.22. Finite-mode bond graph with causal ﬂow input plus an additional modal
compliance.

GENERAL CONSIDERATIONS OF FINITE-MODE BOND GRAPHS
507
ﬂow input to the modes, but no derivative causality exists. Thus, no algebraic
problems exist, and equation formulation is straightforward.
Before leaving this section it must be admitted that the act of appending addi-
tional modal compliances to avoid causality problems does present an algebraic
problem when more than one causal ﬂow input is present. Figure 10.23 exposes
this problem. In part a, a three-mode model is shown with two causal ﬂow
inputs. Readers should convince themselves that the only permissible causality
forces modal inertias 2 and 3 into derivative causality. Figure 10.23b shows the
FIGURE 10.23. Finite-mode bond graph with two causal ﬂow inputs.

508
DISTRIBUTED-PARAMETER SYSTEMS
same model after using the trick of appending two additional modal compliances
without their associated inertias. Readers should assign causality to this model
and show that, after assigning integral causality to all I - and C-elements, there
are still some unassigned bonds. This occurrence always indicates the presence
of an algebraic loop. The effort ea has been chosen arbitrarily to set the effort
on the 0-junction indicated, and, as a result, the causal picture is complete. The
effort eb has also been labeled in Figure 10.23b.
Unlike the algebraic problem when derivative causality is permitted, the
present algebraic loop can be solved, once and for all, internally to the bond
graph structure. It is straightforward to derive
ea =
1
Y4,1
(k4η4 −Y4,2eb)
(10.120)
and
eb =
1
Y5,2
(k5η5 −Y5,1ea).
(10.121)
This can obviously be solved explicitly for ea and eb and then used in the state-
space equation formulation. The algebraic problem created by appending extra
modal compliances in order to avoid derivative causality is very manageable,
while dealing with the derivative causality is generally not.
10.4
ASSEMBLING OVERALL SYSTEM MODELS
In the previous sections a procedure was developed for representing all types
of distributed continua as ﬁnite-mode bond graph models. Only beams and bars
were introduced through example; nevertheless, multidimensional elements can
be represented with the same bond graph structure as was developed for beams
and bars. Only the mode shapes, modal masses, and modal frequencies dif-
fer from continuum to continuum. This statement is made somewhat tongue in
cheek, since obtaining modal information for multidimensional structures can be
virtually impossible.
If an overall structure is composed of many (more or less conventional) ele-
ments, then an overall structural model can be constructed by appropriately con-
necting ﬁnite-mode models of the elements. Figure 10.24 shows an A-frame for a
ground vehicle composed of three uniform beams. In Figure 10.24b the frame is
shown with internal forces and moments exposed. The forces F1, F2, and F3 are
external forces which ultimately will represent suspension forces coming through
the force locations. We are assuming that beams 1 and 2 do not twist due to the
motion of beam 3.
In Figure 10.25 a ﬁrst cut at an assembled model is shown. The words “modes
of beam 1” and so forth are used to represent the 1-junctions with attached modal

ASSEMBLING OVERALL SYSTEM MODELS
509
FIGURE 10.24. An A-frame composed of three uniform beams.
oscillators and the two rigid-body inertias. The forces and moments are shown
with 0-junctions, and the fan of bonds emanating from the 0-junctions must
connect to each 1-junction in the appropriate mode set through transformers
whose moduli are force-free beam mode shapes evaluated at the location of the

510
DISTRIBUTED-PARAMETER SYSTEMS
FIGURE 10.25. Schematic diagram of the ﬁnite-mode bond graph for the A-frame.
forces. Thus, V1 acts on beams 2 and 1, M1 acts on beams 2 and 1, V2 acts
on beams 2 and 3, and V3 acts on beams 3 and 1. Causality considerations tell
us that derivative causality will exist because beam contact interfaces will share
common velocities and angular velocities. Thus, our second and ﬁnal model
will have additional modal compliances to rid us of the derivative causality.
Reference [6] shows this example fully developed.
As a ﬁnal example (Figure 10.26), consider a longitudinal bar attached at
z = z1 to a uniform beam. A spring k is attached to the beam at one end, and
a velocity excitation vi(t) exists at the left end of the bar. Frequency consid-
erations have led us to a two-mode (plus the rigid-body mode) representation
for the bar and a one-mode (plus two rigid-body modes) representation for the
beam. Force-free modes are used for both distributed elements in order to have
the most general representation possible. The ﬁnal bond graph is also shown
in Figure 10.26. Notice that the bar has one causal ﬂow input; thus one addi-
tional modal compliance is included for the bar. The beam also has one causal
ﬂow input; thus, the beam modes also require an additional modal compliance.
The overall model has all integral causality and is ready for straightforward
formulation.

ASSEMBLING OVERALL SYSTEM MODELS
511
FIGURE 10.26. A bar interacting with a beam.

512
DISTRIBUTED-PARAMETER SYSTEMS
10.5
SUMMARY
This chapter has dealt with the modeling of inherently distributed systems so
that the distributed elements could be included in an overall system model in a
reasonable manner. The ﬁrst modeling approach described dealt with the use of
ﬁnite lumps, contiguously aligned, and retained in sufﬁcient numbers that low-
frequency accuracy would result. This approach is all right for very crude approxi-
mations, using one or two lumps, but not practical when many lumps are required.
The main emphasis of this chapter is the ﬁnite-mode approach for obtaining
very accurate, low-order, overall system models incorporating all types of dis-
tributed and lumped dynamic elements. It is hoped that the reader appreciates
the elegance and utility of this approach. If not, it is suggested that Refer-
ences [6–8] be read. These show applications of ﬁnite-mode modeling to very
realistic systems, such as the assembled frame of a ground vehicle, the dynam-
ics of the structure holding the world’s largest laser, and the dynamics of the
human lung.
REFERENCES
[1] D. L. Margolis, “A survey of bond graph modeling for interacting lumped
and distributed systems,” J. Franklin Inst., 19, No. 1/2 (Jan. 1985).
[2] H. Crandall et al., Dynamics of Mechanical and Electromechanical Systems,
New York: McGraw-Hill, 1968.
[3] L. Meirovitch, Analytical Methods in Vibrations, New York: Macmillan,
1967.
[4] A. W. Leissa, “Vibration of plates,” NASA Report SP-160, 1969.
[5] D. L. Margolis, “Bond graphs for distributed system models admitting mixed
causal inputs,” ASME J. Dyn. Syst. Meas. Control, 102, No. 2, 94–100 (June
1980).
[6] D. L. Margolis, “Bond graphs, normal modes, and vehicular structures,”
Vehicle Syst. Dyn., 7, No. 1, 49–63 (1978).
[7] D. L. Margolis, “Dynamical models for multidimensional structures using
bond graphs,” ASME J. Dyn. Syst. Meas. Control, 102, No. 3, 180–187 (Sept.
1980).
[8] D. L. Margolis and M. Tabrizi, “Acoustic modeling of lung dynamics using
bond graphs,” J. Biomech. Eng., 105, No. 1, 84–91 (Feb. 1983).
PROBLEMS
10-1. Using the simple lumping technique of Section 10.1, construct as low-
order a model as possible for the bars shown in the ﬁgure such that
integral causality exists for all elements.

PROBLEMS
513
10-2. For the systems of Problem 10-1, assign causality and derive state
equations. Write down, using symbols from Problem 10-1, reasonable
parameters for each system.
10-3. A uniform Bernoulli–Euler beam is suspended at its two ends and has a
dynamic system attached at its center. Construct a low-order, ﬁnite-lump
model using lumps similar to those in Figure 10.8.
10-4. For the system of Problem 10-3, derive a state representation.
10-5. The transverse motion of a tightly stretched string is governed by the
simple wave equation, identically to the bar in longitudinal motion,
T ∂2ω
∂x2 + Fδ(x −x1) = ρ ∂2w
∂t2 .

514
DISTRIBUTED-PARAMETER SYSTEMS
In the ﬁgure the boundaries are force free because the attachment points
are massless. The boundary conditions are
∂ω
∂x (0, t) = ∂w
∂x (L, t) = 0.
Assume a separated solution
ω(x, t) = Y(x)f (t),
and derive the frequency equation and mode shapes, including the rigid-
body mode.
10-6. For Problem 10-5, assume the forced response is given by
w(x, t) =
∞
	
n=0
Yn(x)ηn(t),
and derive expressions for the modal masses and stiffnesses. Convince
yourself that a bond graph structure similar to Figure 10.17 (only includ-
ing the rigid-body mode) is appropriate for this system.
10-7. Two tightly stretched strings are connected as shown in the ﬁgure. Con-
struct a ﬁnite-mode model for this system including two modes for each
string. Since the string ends are ﬁxed, use the mode shapes for ﬁxed ends,
and use the symbol Yn(x) to represent these modes.

PROBLEMS
515
10-8. A tightly stretched string has dynamic elements on its boundaries as
shown in the ﬁgure. Construct a bond graph for this system including
two dynamic modes for the string (plus the rigid-body mode, of course).
Assign causality, and convince yourself that the derivative causality
exists. Use symbols Yn(x) for the mode shapes and modal parameters.
10-9. For the system of Problem 10-8, add an additional modal compliance,
and show that no derivative causality exists. Derive the state equations.
10-10. The ﬁgure shows a bar, ﬁxed at its left end, with three different right-end
boundary conditions. In part a of the ﬁgure, the right end is ﬁxed, in (b) it
is attached to a spring, and in (c) it is attached to a velocity source. For
reference, the mode shapes and frequencies for the ﬁxed–ﬁxed bar are
ω2
n = E
ρ
nπ
L
2
,
Yn(x) = sin nπ x
L,
n = 1, 2, . . . ,
and the mode shapes and frequencies for a bar ﬁxed at x = 0 and free at
x = L are
ω2
n = E
ρ

(2n −1) π
2L
2
,
Yn(x) = sin(2n −1)π
2
x
L,
n = 1, 2, . . . .

516
DISTRIBUTED-PARAMETER SYSTEMS
(a)
Construct a two-mode bond graph model for the bar in part b using
the ﬁxed–free mode shapes and properly attaching the spring k.
Assign causality, derive equations, and derive the characteristic
equation. Let k →∞, effectively ﬁxing the right end, and deter-
mine the natural frequencies of the constrained system. Compare
with the frequencies for a ﬁxed–ﬁxed bar.
(b)
Construct a two-mode model for the bar in part c, again using
the ﬁxed–free modes. Assign causality, and notice the derivative
causality caused by the velocity input v(t). Let v(t) = 0, effectively
ﬁxing the right end; deal with the derivative causality algebraically;
and derive the characteristic equation for this system. Compare the
calculated frequency with the frequency for the ﬁxed–ﬁxed bar.
(c)
Finally, rid yourself of derivative causality by appending an addi-
tional modal compliance. Again derive the characteristic equation,
and compare the calculated frequencies with those for a ﬁxed–
ﬁxed bar.
The reader should be impressed at how well the force-free modes con-
verge to ﬁxed-boundary modes even when only two modes are used.
10-11. A truck frame is modeled as a uniform beam in the ﬁgure. We would like
to design a control system, using actuators at the suspension locations,
that can provide damping for the bending motion of the frame. Construct a
one-mode model (two rigid-body modes plus one dynamic mode) for the
frame, and properly attach the suspension elements. Derive a set of state
equations from which we can launch our control studies. If derivative
causality exists, modify your model to ﬁx it, and then derive equations.
10-12. The ﬁgure shows a simple structure composed of two vertical beams and
a horizontal bar. Construct a ﬁnite-mode model of this system, assuming

PROBLEMS
517
the beams execute only transverse motion and the bar only longitudinal
motion. Use symbols for modes and modal parameters, but state what
modes you are using. Predict any formulation problems, and tell how
you would modify the model to avoid these problems.
10-13. A tightly stretched string is ﬁxed at both ends, as in Problem 10-7. Per-
form a modal analysis of a tightly stretched string and convince yourself
that the mode shapes and frequencies are
ω2
n =

T
ρ
nπ
L ,
n = 1, 2, . . . ,
Yn(x) = sin nπ x
L,
where T is the string tension and ρ is the mass per unit length. Derive
expressions for the modal masses, mn, and modal stiffnesses, kn.
10-14. The tightly stretched string from Problem 10-13 now has a mass, m,
attached at x = 1
4L :
Treat the string lengths 1
4L to the left and 3
4L to the right of the mass
as nonmodal tension springs and derive an expression for the natural
frequency of the system.
w(x, t) m
x
T, ρ, L

518
DISTRIBUTED-PARAMETER SYSTEMS
10-15. Model the system in Problem 10-14 using the ﬁnite-mode bond graph.
Include the ﬁrst two modes for the string and, of course, attach the mass.
Assign causality, and you will discover that derivative causality exists.
Use formulation methods from Chapter 5 and derive the state equations.
Perform a linear analysis and derive an expression for the system natural
frequencies. Compare this result to that from Problem 10-14.
10-16. Add an additional modal compliance to the model in Problem 10-15 and
show that no derivative causality exists. Derive state equations.
10-17. The tightly stretched string in Problem 10-13 now has two masses,
m1 and m2, attached at positions x = 1
4L and x = 3
4L. Formulate a two-
mode bond graph model. Assign causality starting with the modal masses
and show that both attached masses are in derivative causality. Append
one additional modal compliance and show that one attached mass is in
derivative causality. Append an additional modal compliance and show
that all integral causality exists but there are unassigned bonds indicating
an algebraic loop. Perform the algebra using procedures from Chapter 5
and derive state equations.
w(x, t)
m1
m2
x
T, ρ, L

11
MAGNETIC CIRCUITS AND DEVICES
Many useful electrical and electromechanical devices contain magnetic circuits.
Multiport models for some of these devices have already been studied in previous
chapters, but here the magnetic ﬂux paths will be modeled in detail. A detailed
model is required, of course, if one is to design a motor, solenoid, transformer,
or the like, although a system analyst may be content with an overall multiport
model that adequately predicts only the external port behavior.
11.1
MAGNETIC EFFORT AND FLOW VARIABLES
The toroidal coil shown in Figure 11.1 can serve as an ideal conﬁguration for
deﬁning magnetic variables and establishing bond graph representations for mag-
netic circuits. If the toroid is made of soft iron, we expect the device to behave at
the single electrical port as an inductance with a linear relation between current
i and ﬂux linkage λ, at least for moderate values of i. This model shows no
physical effects inside the coil, however.
Inside the iron core, magnetic ﬂux is induced whenever current ﬂows through
the coil. Let the total ﬂux be called ϕ; it is measured in the SI system in webers,
Wb. (In this unit system one weber is equivalent to one volt-second. There are
several units for magnetic variables in use, but for simplicity, only the units
appropriate to the SI system will be presented here.) The magnetic ﬁeld may be
described by the magnetic ﬂux density vector B with the units of teslas, T, or
webers per square meter, Wb/m2. The length of B corresponds to the amount
of ﬂux passing through an area element perpendicular to the ﬂux lines, and the
direction of B is along the ﬂux lines. The B-vector points in the direction the
north pole of a compass needle would point if it were free to line itself up with
the magnetic ﬁeld. The B-vector is also often called the magnetic induction.
519
System Dynamics: Modeling, Simulation, and Control of Mechatronic Systems, Fifth Edition
Dean C. Karnopp, Donald L. Margolis and Ronald C. Rosenberg
Copyright © 2012 John Wiley & Sons, Inc.

520
MAGNETIC CIRCUITS AND DEVICES
FIGURE 11.1. Toroidal coil.
In Figure 11.1, if we can assume that each of the N turns of conductor around
the toroidal core links all the ﬂux ϕ in the toroid, then the ﬂux linkage λ is
related to ϕ by
λ = Nϕ.
(11.1)
In practice, when many layers of wire are wound around on a core, some turns
of wire do not link all of the ﬂux lines. In this case, sometimes described by
saying that some ﬂux “leaks” out of the coil, Eq. (11.1) can be still valid except
that N is a nondimensional number representing an effective number of turns,
rather than an actual number of turns. In what follows, we shall refer to N as a
number of turns without necessarily including the adjective effective.
By differentiating Eq. (11.1) with respect to time, the relation between the
port voltage e and the magnetic variable ˙ϕ is found:
e = ˙λ = N ˙ϕ,
(11.2)
which is just Faraday’s law applied to the coil.
The driving force that tends to set up ϕ in the core is the magnetomotive force,
M , which is proportional both to the number of turns of conductor and to the
current ﬂowing in the coil:
M = Ni.
(11.3)
The magnetomotive force, which is analogous to the electromotive force, has
the units of current, amperes (although it is conventionally given in ampere-
turns, despite the fact that the number of turns is really dimensionless). The
magnetomotive force is often abbreviated as MMF. In the ideal, dissipationless
case, M and ϕ for the coil are related by a nonlinear or linear relation. This
relation is sketched in Figure 11.2.
In Figure 11.2a, a typical relation for a ferromagnetic material core is sketched.
A soft ferromagnetic material is one that is easily magnetized and demagnetized
by means of a current-carrying coil, that is, a material for which M and ϕ are
related by a single valued curve so that ϕ = 0 when M = 0. Hard ferromagnetic
materials, used for permanent magnets, show a hysteresis loop when M is cycled,

MAGNETIC EFFORT AND FLOW VARIABLES
521
FIGURE 11.2. Core properties: (a) magnetomotive force versus ﬂux; (b) ﬁeld strength
versus ﬂux density; (c) current versus ﬂux linkage.
and ϕ can remain high even when M is zero. For now, we shall concentrate on
soft ferromagnetic materials. Such materials exhibit a saturation effect as shown.
The increase in ϕ as M is increased slows down, and, practically, there is a
limiting value of ﬂux that the core can attain when M is very large. (Most steels
saturate at B-values of less than 2 T.)
In order to characterize a core material, it is convenient to exhibit a curve
independent of any particular core conﬁguration. For this purpose the so-called
B –H curve is frequently used. In Figure 11.2b the magnitude of the B-vector, B,
is shown as ϕ divided by the core cross-sectional area A. This way of computing
B would be exact if the ﬂux were uniformly distributed throughout the core. The
magnetizing force, or ﬁeld strength H , is the magnetomotive force per unit length,
with units of ampere-turns per meter. For the toroidal coil, H is approximately M
divided by the centerline length of the coil, l. When only a single B –H curve is
given, it is implied that the material is isotropic, that is, that the relation between
B and H is the same no matter how the ﬁeld is oriented in the material. For
certain crystal structures, this is not the case, and several different B –H curves
for different orientations of B can be found.
In Figure 11.2c, the port characteristics of the inductor are sketched by mod-
ifying the M−ϕ or B –H curve using N . We see that the saturation effect
corresponds to a nonlinear region of the —I element representing the induc-
tance. Since most B –H curves exhibit saturation, electrical chokes are really
nonlinear, though in normal operation of these devices a linear inductance model
is often sufﬁciently accurate.
It is of interest to compute the inductance for the coil. Assuming that the
curves of Figure 11.2 can be approximately represented by a straight line near
the origin, L may be found as follows:
L = λ
i =
Nϕ
M/N = N2AB
lH
.
(11.4)

522
MAGNETIC CIRCUITS AND DEVICES
The initial slope of the B –H curve is given the symbol μ and called the perme-
ability; it has units of tesla-meters per ampere
μ = B
H ,
(11.5)
so that L = N2Aμ/l. (Free space itself has a permeability, μ0, and sometimes
μ is expressed as a relative permeability, that is, the value of B/H is given by
μμ0 rather than just μ.)
For the entire coil, one may express the slope of the M −ϕ curve in the linear
region in two ways. The permeance, P, is given by the following formula:
P = ϕ
M = μA
l .
(11.6)
The reluctance, R, is given by
R = 1
P = M
ϕ =
l
μA.
(11.7)
As a mnemonic device, one may say that a long, small-area ﬂux path in a material
of small permeability is reluctant to permit the establishment of much ﬂux. The
parameters L, R, and μ are shown as slopes in the sketches in Figure 11.2.
Table 11.1 summarizes the magnetic variables and parameters discussed, together
with their SI units and some remarks concerning typical values.
In order to proceed further with the analysis of magnetic circuits and devices,
it is useful to begin classifying variables such as M and ϕ and parameters such as
P and R. Historically, the reluctance R was sometimes thought of as analogous
to electrical resistance, so that ﬂux was thought of as analogous to current and
the magnetomotive force as analogous to the electromotive force. Although this
analogy can be used, it is not satisfying as a basis for a bond graph, since
an electrical resistor dissipates power while a coil exhibiting reluctance stores
energy. In fact, the reluctance and the permeance are linear parameters of a —C
or —I element. From a bond graph point of view it seems reasonable that M , the
magnetomotive force, should be an effort quantity, but the ﬂow should not be ﬂux,
as in the more traditional analogy, but rather the time rate of change of ﬂux, ˙ϕ.
The deﬁciencies of the reluctance–resistance analogy are apparent when one
attempts to study a dynamic system containing electrical and mechanical elements
as well as a magnetic current (see Reference [1]). It was only after the gyrator
had been accepted as a useful network element, however, that the analogy most
natural for bond graphs could be proposed [2].
Suppose we return to the basic equations, (11.2) and (11.3), and identify ˙ϕ as a
ﬂow variable and M as an effort variable. Then N is clearly a gyrator parameter.
In addition, since ϕ is a displacement variable, then Eq. (11.6) shows that P
is a capacitance parameter and R, the reluctance, is the inverse capacitance or
stiffness parameter. All the relations are elegantly summed up in the bond graph
of Figure 11.3. Of course, the combination ⇀GY ⇀C does behave like ⇀I at

MAGNETIC EFFORT AND FLOW VARIABLES
523
TABLE 11.1. Summary of Magnetic Variables and Parameters
Symbol
Name
SI Unit
Equivalent Units, Remarks
ϕ
Total magnetic ﬂux
Weber (Wb)
Volt-second (V-s)
˙ϕ
Flux rate
Wb/s
V
B
Magnetic ﬂux
density, magnetic
induction
Tesla (T)
Weber per square meter,
(Wb/m2); magnitude of a
vector quantity
M
Magnetomotive
force, MMF
Ampere (-turn)
(A)
Number of turns of a
conductor is dimensionless,
but is included if M = Ni is
used, where N = turns of wire
carrying current i
H
Magnetic ﬁeld
strength
Ampere (-turn)
per meter (A/m)
Magnitude of a vector quantity
μ0
Permeability of
free space,
4π × 10−7 ∼=
1/800,000
Henry per meter
(H/m)
Tesla-meter per ampere
(T-m/A);
relates B to H in air:
B = μ0H or H ∼= 800,000B
μ
Permeability of
material
H/m
T-m/A;
relates B to H in isotropic
material: B = μH
μr
Relative permeability
of material
Dimensionless
μ = μrμ0; for ferromagnetic
materials, μr varies from
about 400 to 400,000 for
such materials,
2B < H < 2000B
P
Permeance of
circuit element
Henry (H)
Weber per ampere (Wb/A),
used in formula ϕ = PM
R
Reluctance of
circuit element
H−1
A/Wb;
R = 1/P used in formula
M = Rϕ
E
Energy
Joule (J)
E = ∫Mdϕ(A-Wb = A-V-s)
FIGURE 11.3. Bond graph for coil of Figure 11.1.
the external port, as it must. The gyrator is necessary if we wish to consider both
electromotive force and magnetomotive force as effort variables. (This seems to
be the way classical physicists thought of these variables.)
The classiﬁcation of variables that will be used subsequently is listed in
Table 11.2 for convenience. Note that the capacitance parameter only is to be

524
MAGNETIC CIRCUITS AND DEVICES
TABLE 11.2. Mechanical, Electrical, and Magnetic Bond Graph Variable and
Parameters
General
Mechanical
Electrical
Magnetic
Effort
Force, F
Electromotive force, e Magnetomotive force, M
Flow
Velocity, V
Current, i
Flux rate, ˙ϕ
Displacement
Distance, X
Charge, q
Flux, ϕ
Capacitance parameter Compliance, C Capacitance, C
Permeance, P
Stiffness parameter
Stiffness, k
1/C
Reluctance, R = 1/P
applied in the linear case. The magnetic circuit generally involves nonlinear
C-elements with characteristics as sketched in Figure 11.2.
11.2
MAGNETIC ENERGY STORAGE AND LOSS
Figure 11.2 showed several ways to exhibit the properties of a nonlinear but loss-
less magnetic core. In this section the energy storage and loss will be investigated
in more detail.
Figure 11.4 shows two small pieces of material of physical volume Al. On
the left, a uniform stress σ is associated with a force F and causes an extension
δ and strain ε in the isotropic material. The total energy stored would be
E = ∫Fdδ = ∫σAl dε = Al ∫σdε.
(11.8)
Thus, the energy per unit volume is the area shown shaded in the σ−ε diagram
when the material is deformed from a state of zero stress and strain. When the
material is in the linear elastic range, σ = Eε and the energy is Eε2/2, but if σ
versus ε is any single-valued curve, the material is obviously energy conservative.
On the other hand, if the material yields, the stress and strain follow a hys-
teresis loop such as the one shown dashed in the sketch, and the area enclosed
by the loop represents the energy loss per cycle per unit volume. Mechanical
elements that remain elastic are represented by C-elements, but when yielding
occurs, some kind of R-element must be added to model the energy loss.
The material on the right of Figure 11.4 behaves under the action of a mag-
netic ﬁeld in a manner similar to the material on the left under the action of a
mechanical stress ﬁeld. Assuming that the ﬂux ϕ has a uniform density B and that
the material is isotropic, the total stored energy would be computed according to
the classiﬁcations of variables in Tables 11.1 and 11.2 as follows:
E =

Mdϕ =

lHAdB = Al

HdB.
(11.9)
Thus, the magnetic energy per unit volume is represented by the hatched area
in the B –H plot on the right in Figure 11.4. In the linear range, H = B/μ and

MAGNETIC ENERGY STORAGE AND LOSS
525
FIGURE 11.4. Mechanical and magnetic energy densities.
the energy is B2/2μ, but if B and H lie on any single-valued curve, energy is
conserved.
When B and H are cycled, a hysteresis loop indicated by the dashed loop
forms, and the area inside the loop represents the energy loss per cycle per unit
volume. For soft magnetic materials, the loops are quite narrow and a C-element
with a curved constitutive law can be used to model the saturation effect without
loss. The hysteresis effect requires the addition of R-elements, since energy loss
is involved.
The detailed modeling of hysteresis is generally quite complicated, since it
involves a sort of memory effect. One way to handle this is to replace the single
C-element, which has a single displacement state variable, with a combination
of C- and R-elements, which then serves to remember aspects of the loading of
the hysteretic system through the values of a number of hidden state variables.
The procedure is discussed in Reference [3].
Permanent magnets are made of hard magnetic materials with very large
hysteresis loops. These materials resemble elastic–plastic mechanical materials

526
MAGNETIC CIRCUITS AND DEVICES
FIGURE 11.5. Hysteresis loops for an elastic–plastic material and a permanent-magnet
material.
which can retain a large strain after having been yielded. A permanent mag-
net retains a large B-ﬁeld after magnetization even in the presence of an H or
magnetomotive force in a direction that would tend to demagnetize the material.
Figure 11.5 shows the stress–strain plot of an elastic–plastic material and
the B –H plot for a typical permanent magnet. In most plots the B and H axes
are interchanged from the way they are presented here. When this is done, the
hysteresis loops are traversed in the opposite direction and the areas representing
stored energy change places. The unconventional H–B plot is required to keep
the displacement variable ϕ or B on the horizontal axis and the effort variable
M or H on the vertical axis, as has been done consistently for all other energy
domains in this book.
On the left of Figure 11.5 is a mechanical system which will help explain how
permanent magnets can be used to produce ﬂux in air gaps for use in motors,
electrodynamic loudspeakers, and other electromechanical transducers instead of
through the use of current-carrying coils. In the stress–strain diagram, if the
material is strained beyond its yield point to point a, when the stress is relaxed,
the material returns to point b with a permanent strain. A similar phenomenon

MAGNETIC ENERGY STORAGE AND LOSS
527
occurs for the magnetic material represented on the right. After being magnetized
to point a on the H–B hysteresis loop, the material would retain a B-value of
Br, the remanence or remanent ﬁeld, if H were returned to zero. To achieve
B = 0, one would have to apply a negative ﬁeld strength of magnitude Hc, the
coercivity. The parameters Br and Hc are often used to describe the properties
of permanent magnets.
Now suppose that some elastic–plastic material is connected in mechani-
cal series to some elastic material as shown schematically in the lower left of
Figure 11.5. If the force F is used to stretch the elastic–plastic material beyond
its yield point and then removed, the system will not return to point b on the
stress–strain diagram, because the elastic element will tend to recompress the
yielded element. The stress will be negative, and the strain will be less than the
strain at point b. Several possible operating points are shown, depending on how
stiff the elastic element happens to be.
An analogous situation arises when a permanent magnet is used in a magnetic
circuit with an air gap as shown in the lower right of Figure 11.5. If we assume
for simplicity that the pole pieces have negligible reluctance and we neglect any
leakage ﬂux, then all the ﬂux from the magnet will also traverse the gap, and the
total MMF from the magnet will appear across the gap. The magnet will have to
work against a negative H caused by the MMF at the gap necessary to force the
ﬂux through the gap. We now investigate a means for choosing optimum magnet
and gap dimensions.
A common principle is that a given magnet should be used so that the total
energy in the air gap is maximum. The MMF–ﬂux relation in the air gap is
linear,
Mg = Rgϕg,
(11.10)
so the total energy is
E = Rgϕ2
g/2 = Mgϕg/2,
(11.11)
and we wish to maximize Mgφg. The assumptions mean that the magnet ﬂux is
equal to the gap ﬂux and the magnet MMF is just the negative of the gap MMF:
ϕm = ϕg,
Mm = −Mg.
(11.12)
Then, assuming a uniform ﬂux density and ﬁeld strength and using the magnet
length lm and area Am, we can relate Mgϕ to the B and H values in the magnet:
|Mgϕg| = |Mmϕm| = (AmB)(lmH) = (Amlm)(BH),
(11.13)
where only the magnitude of H is considered, although H is actually negative.
The point is that the gap energy is maximized by operating the magnet at that
point in the B –H plane where the product BH is maximum. Let us now deﬁne the
point Bm, Hm on the hysteresis curve to be the point at which BH is maximum,

528
MAGNETIC CIRCUITS AND DEVICES
(BH)max. We then dimension the gap in such a way that the magnet operates
at Bm, Hm.
Three simple equations apply: (1) the magnet and gap ﬂuxes are equal,
BmAm = BgAg;
(11.14)
(2) the magnitudes of the magnet and gap MMFs are equal,
Hmlm = Hglg;
(11.15)
and (3) in the air gap
Bg = μ0Hg.
(11.16)
Elimination of Bg and Hg yields the ﬁnal result:
Aglm
Amlg
=
Bm
μ0Hm
.
(11.17)
The term on the right in Eq. (11.17) can be thought of as a normalized slope
of the line passing through the (BH)max point. Its value is often tabulated for
magnet materials. The value of (BH)max is a measure of the strength of the
magnet material.
Note that by adjusting the magnet and gap areas, the B-value in the gap can
be greater than in the magnet. If Ag = Am, then the ratio of lm to lg is just
Bm/μ0Hm. For older metallic magnets this ratio was usually greater than unity,
leading to designs with magnets much longer than the air gap length, but recent
high-strength rare earth magnets have a ratio of about unity, which means that
the magnet length is about the length of the air gap unless B > Bm is required.
For more details on the design of magnetic circuits to produce constant ﬁelds
either with permanent magnets or with current-carrying coils see References [4]
and [5]. We now proceed to model circuits in which ﬁelds may vary dynamically.
11.3
MAGNETIC CIRCUIT ELEMENTS
Using the effort–ﬂow identiﬁcations of Table 11.2, it is possible to begin a
study of lumped-parameter elements for magnetic circuits. In Figure 11.6a, a coil
around a length of core is shown contributing an increase in MMF. In this model,
the length of core has no reluctance. In Figure 11.6b, an MMF drop is shown
related to the ﬂux ϕ. When two ﬂux paths are joined as shown in Figure 11.6c, the
result can be modeled with a 0-junction, since the three ﬂux rates sum to zero and
there is a single MMF. Finally, in Figure 11.6d, an air gap is modeled essentially
in the same way as a length of core material. The air gap has high reluctance
for its length or low permeability (essentially the permeability of free space,
μ0) and does not exhibit saturation as iron cores do. In computing reluctance or

MAGNETIC CIRCUIT ELEMENTS
529
FIGURE 11.6. Bond graphs for magnetic circuit elements: (a) driver coil; (b) piece of
ferromagnetic core; (c) core junction; (d) air gap.
permeance parameters for —C elements of ﬂux paths, we use Eqs. (11.6) and
(11.7), in which areas and lengths for the ﬂux path elements must be estimated
judiciously, with consideration given to the actual paths of the ﬂux lines.
Using the elements of Figure 11.6, a bond graph for a simple magnetic circuit
such as the one shown in Figure 11.7 may be constructed. The MMF can be
treated just like voltage in an electric circuit. In Figure 11.7b the MMF variables
have been each assigned to a 0-junction, and drops in MMF across —C elements
and a rise due to the coil have been indicated using 1-junctions. Since only
differences in MMF are signiﬁcant ultimately, Md is chosen as a zero MMF
point, and the bond graph can be simpliﬁed. It may be helpful to consider the
previously studied case of the analogous electric circuit shown in Figure 11.7c.
After the ground node has been eliminated and the 2-port 0-junctions removed,
it is found that three —C elements are joined to a single 1-junction. This means
that all C’s have the same ﬂow variable and the effort drops add. In magnetic
terms, this means that for the linear case, a single C-element with a reluctance
equal to the sum of the three reluctances of the original C’s can be substituted
as shown in Figure 11.7d. In the nonlinear case, an equivalent —C relation can
be found by simply adding MMF drops for the three original C’s as the common
ﬂux is varied over the range of interest.

530
MAGNETIC CIRCUITS AND DEVICES
FIGURE 11.7. Bond graph model of magnetic circuit with air gap: (a) sketch of device;
(b) bond graph; (c) analogous electric circuit; (d) simpliﬁed bond graph.
A more complicated magnetic circuit appears in Figure 11.8. The ﬂux path
associated with ϕ3 could be physically present, or it could be a lumped repre-
sentation of the path taken by leakage ﬂux that bypasses the air gap. In fact,
there always is some ﬂux that escapes from the main path and spreads into the
surrounding space. Although the real leakage paths are distributed in space, it is
often sufﬁcient to include a single equivalent leakage path and leakage ﬂux. Since
the leakage path reluctance is usually dominated by the high reluctance of the air
portion, it is common to assume that the leakage path can be represented by a
linear, high-reluctance —C. The basic bond graph of Figure 11.8b is simpliﬁed
by the choice of a zero MMF point, and the bond graph of Figure 11.8c results.
The loop may be eliminated using the bond graph identity discussed in Chapter 4
for the 0–1–0–1 ring, since the signs are proper for the reduction. The bond
graphs of Figure 11.8d and e result. In the last form, it is clear that C2, C4,
and C6 could be combined, as could C1 and C5. If these C’s were linear, their

MAGNETIC CIRCUIT ELEMENTS
531
FIGURE 11.8. Circuit with extra ﬂux path to model leakage ﬂux: (a) sketch; (b) basic
bond graph; (c–e) simpliﬁed bond graphs.
reluctances would be summed. Ultimately, a single equivalent C could be found
for the entire collection of C’s, 0’s, and 1’s, but then, of course, none of the
internal MMFs or ﬂuxes could be found.
When no loss mechanisms are included in magnetic circuits, then they appear
internally as networks of Cs, and it is often convenient to reduce the system
by ﬁnding equivalences among the subﬁelds. At a more detailed level, however,
there are energy losses associated with eddy currents in the core and other effects.
Laminations in the core of a magnetic circuit help in reducing the loss associated
with eddy currents, but accurate models require the insertion of loss elements.
Analysis of a laminated core can show that the R–C transmission line model for
the core may be used for the linear case [2]. A study of such detailed models
would take too long for present purposes, and in practice a simpler approach

532
MAGNETIC CIRCUITS AND DEVICES
often sufﬁces. It is often sufﬁcient to append a magnetic resistance to the 1-
junction of Figure 11.6b. This implies an extra MMF drop associated with a
length of core that is a function of ˙ϕ, in addition to the drop in MMF that is
associated with ϕ. As might be expected, it is not easy to predict the magnitude
of the resistance in the absence of experimental evidence. On the other hand,
particularly for a limited frequency range of excitation, it is often possible to
adjust a linear resistance relation to provide a quite accurate representation of
losses in the core.
11.4
MAGNETOMECHANICAL ELEMENTS
Before exhibiting magnetic circuits containing loss elements, it is important to
show a method of handling magnetomechanical transducers. (The solenoid stud-
ied in Chapter 8 was treated in multiport fashion without analyzing the magnetic
circuit in detail.) The basic idea behind many transducers is that mechanical
motion can alter the relation between ﬂux and MMF in a ﬂux path. This type of
transducer is often called a “variable-reluctance” transducer.
Consider the device of Figure 11.9, in which a force F is associated with
a movable pole piece that communicates with a ﬁxed pole through an air gap
of variable length X. A ﬂux ϕ passes through the gap and is associated with
an MMF drop 
M. The device can be represented by a C-ﬁeld, as shown in
Figure 11.9b, and is analogous to the movable-plate capacitor of Chapter 8.
FIGURE 11.9. Magnetomechanical transduction: (a) sketch; (b) bond graph repre-
sentation.

MAGNETOMECHANICAL ELEMENTS
533
Since this particular device uses an air gap, it is reasonable to assume that the
device is linear, but that the reluctance R is a function of X; that is,
R(X)ϕ = 
M.
(11.18)
Using arguments similar to those in Chapters 7 and 8, we may write the energy
E as
E(X, ϕ) = 1
2R(X)ϕ2.
(11.19)
Then

M = ∂E
∂ϕ = R(X)ϕ
(11.20a)
and
F = ∂E
∂X = 1
2
dR
dXϕ2.
(11.20b)
From Eq. (11.7), we might expect
R(X) ∼=
X
μ0A.
(11.21)
So
F ∼=
ϕ2
2μ0A,
(11.22)
indicating the F would be roughly constant for small changes in the value of
X if ϕ were held constant. In most cases, however, ϕ is more nearly inversely
proportional to R (when an MMF is held constant somewhere in the circuit),
so F tends to vary as X−2 for small X. For very large values of X, the circuit
model itself breaks down, and the ﬂux does not follow the paths assumed. Any
movement of core pieces will be associated with changes in stored energy and
hence with forces or torques. The bond graph of Figure 11.9b may be used even
when the magnetic relations are nonlinear due to saturation, but the computation
of the energy is more complicated.
Figure 11.10 shows a ferromagnetic rotor that is subjected to an aligning
torque τ when a ﬁeld is induced in the stator. There are several ways to compute
the torque, but perhaps the easiest involves energy considerations. We can again
use Eq. (11.19) but with R a function of θ instead of X. Assuming that the ﬂux is
concentrated in the narrow gap of length lg, Eq. (11.7) can be used with the area
of the gap as a function of θ rather than the length. Letting the axial length of the
rotor be l, the effective area of the two air gaps is l(l0 −rθ), so the reluctance is
R =
2lg
μ0l(l0 −rθ).
(11.23)

534
MAGNETIC CIRCUITS AND DEVICES
FIGURE 11.10. Rotary, variable-reluctance transducer.
Then
E(θ, ϕ) =
lgϕ2
μ0l(l0 −rθ)
(11.24)
and
τ = ∂E
∂θ =
lgrϕ2
μ0l(l0 −rθ)2 ,
(11.25)

M = ∂E
∂ϕ =
2lgϕ
μ0l(l0 −rθ).
(11.26)
The last two relations describe the 2-port C-ﬁeld in integral causality.
Other equivalent expressions may not be so useful for bond graph dynamic
models. For example, deﬁning
B =
ϕ
l(l0 −rθ),
(11.27)
Eq. (11.25) can be written
τ = lrlgB2
μ0
.
(11.28)
While correct, Eq. (11.28) may obscure the fact that B varies with θ and ϕ as
the rotor turns and the excitation changes.
11.5
DEVICE MODELS
As an example of the utility of the bond graph models for magnetic circuits
developed above, consider the relay of Figure 11.11. Bond graphs are an aid

DEVICE MODELS
535
FIGURE 11.11. Relay: (a) schematic diagram; (b) basic bond graph; (c) simpliﬁed bond
graph.
in the study of such systems, since three energy domains are involved. From
the schematic diagram of the device, Figure 11.11a, one may begin assembling
a bond graph model by indicating MMF values and then representing MMF
drops with 1-junctions and C- and R-elements. At this point, some judgment is
required, since it is not clear how many ﬂux paths should be represented, nor is it
clear where the eddy current losses will be most severe. When the bond graph is

536
MAGNETIC CIRCUITS AND DEVICES
simpliﬁed after choosing M0 as the zero MMF, as in Figure 11.11c, it becomes
clear that several C- and R-elements can be combined.
Discounting the loss elements, the transduction from electrical energy to
mechanical energy is accomplished by a C-ﬁeld addressed at one port through a
gyrator or, in other words, by an IC-ﬁeld transducer. This would have been pre-
dicted by the methods used in Chapter 8. However, the present approach using
the detailed model of the magnetic circuit allows a designer to study the ﬂux
paths in detail and to model internal losses. From a designer’s point of view, a
single relay is a rather complex dynamic system. Conventional descriptions of
models of such systems using equations are not particularly easy to follow. For
an example of a real device modeled at about the level of complexity shown in
Figure 11.11, see Reference [6]. The reader who takes the trouble to read this
paper carefully may become convinced that the bond graph representation yields
a compact and insightful means of displaying the physical assumptions used in
creating a multiple-energy-domain model.
It is possible to create a very general bond graph model that describes a
wide variety of electromagnetic–mechanical devices, including all the power-
conserving and energy-storing devices discussed previously. The model is devel-
oped in Reference [7], and the devices are described in more detail in References
[8–10].
We consider four devices and three forms of force or torque law, which will
be incorporated into one general bond graph model. The derivation of the funda-
mental form of the force law appears in Reference [8] as applied to synchronous
motors such as the salient pole version shown in Figure 11.12.
FIGURE 11.12. Synchronous motor with salient poles and permanent-magnet rotor dis-
cussed in Reference.

DEVICE MODELS
537
The ﬂux linked by the stator windings is called ϕs in Reference [8] and is
imagined split into a component due to the coil current is and a part due to the
permanent magnet rotor position θ:
ϕs = Ls(θ)is + ϕsr(θ),
(11.29)
in which Ls(θ) is a position-dependent inductance. The model is therefore elec-
trically linear, which means that saturation in the magnetic circuit is assumed
not to occur. The magnetic energy Wm is also split into a part having to do with
current in the stator windings and a part having to do with the permanent magnet
position, Wmr:
Wm = 1
2Ls(θ)i2
s + Wmr(θ).
(11.30)
An energy argument leads to the following expression for the electromagnetic
torque Te:
Te = is
dϕsr
dθ
−dWmr(θ)
dθ
+ 1
2i2
s
dLs(θ)
dθ
.
(11.31)
This expression, although derived for a fairly speciﬁc type of rotary device,
actually can be interpreted as showing the correct form for the three basic types
of forces present in electromagnetic actuators.
In Figure 11.13, two fundamental types of linear actuators discussed in Refer-
ence [9] are sketched. In previous bond graph literature, case a would be modeled
either by an energy-conservative IC-ﬁeld or by a C-ﬁeld if the magnetic circuit
variables were explicitly included, and case b would be modeled by a gyrator.
FIGURE 11.13. Linear motion actuators discussed in Reference [9]: (a) variable-
reluctance device; (b) voice coil device.

538
MAGNETIC CIRCUITS AND DEVICES
In Reference [9], however, a general force law is stated that applies to both
devices:
Fe = i dϕ0
dx −dW0(x)
dx
+ ∂
∂x
 i
0
ϕi(x, i′)di′.
(11.32)
The terms in Eq. (11.32) are strictly analogous to those in Eq. (11.31). The rotor
angular position θ is replaced by the linear position x of the moving element.
The symbol ϕ0 corresponds to ϕsr, and W0 to Wmr. The integral term has to
do with self-inductance and could also be represented as in Eq. (11.30) using a
variable-inductance coefﬁcient.
Finally, in Figure 11.14, a very different type of linear actuator is analyzed in
which permanent magnets (PMs) form the moving element. The three iron cores
are stationary with a simple winding distributed along the middle one. The force
law used in Reference [10] is
F = I dϕcm
dp
−dWm
dp
+ 1
2I 2 dLc
dp .
(11.33)
The similarities to Eqs. (11.31) and (11.32) are evident if one notes that here p
represents the magnet position.
We now create a bond graph capable of representing Eqs. (11.31)–(11.33)
and thus capable of modeling any of the four devices in Figures 11.12–11.14,
as well as many others. The bond graph will also predict the induced voltage
FIGURE 11.14. Linear motor with moving permanents as discussed in Reference [10].

DEVICE MODELS
539
effects consistent with the forces and will allow the simple addition of inertia,
friction, and resistance effects. For simulation purposes, the forces will actually be
expressed in terms of ﬂux or ﬂux linkage state variables rather than as functions
of current.
The bond graph to be developed for the actuators is shown in Figure 11.15. The
mechanical variables F and ˙x stand for force and linear velocity, but for rotary
actuators they could be interpreted as torque and angular velocity, respectively.
The force law corresponding to Eqs. (11.31)–(11.33) is
F = i dλ4
dx −dW2
dx + 1
2i2 dL
dx ,
(11.34a)
F = F1 −F2 −F3,
(11.34b)
where i is the coil current, λ4 is the ﬂux linkage due to the permanent magnet,
W2 is the magnetic energy in the magnetic circuit due to the permanent magnet,
and the C-ﬁeld or the IC-ﬁeld represents the energy stored due to the coil self-
inductance effect. Using a gyrator for the coil of N turns, we can conveniently
relate the voltage component e5 and current i to the rate of change of ﬂux,
˙ϕ, in the coil and to the magnetomotive force M . Then a 2-port C-ﬁeld can
represent the magnetomechanical energy storage. For the electrically linear case,
the position-dependent reluctance R(x) is useful to express the stored energy
in terms of x and ϕ. An alternative description uses as electric variables the
current i and the voltage component e5 = λ5 and uses an IC-ﬁeld. In this case,
the position-dependent inductance L(x) can be used to express the stored energy
as a function of x and the self-ﬂux linkage of the coil, λ5. See Chapter 8.
The three force components in Eqs. (11.34a,b) should be compared directly
with the corresponding terms in Eqs. (11.31)–(11.33). The components F1, F2,
and F3 will be discussed separately.
The force component F1 can sometimes be computed directly from the Lorentz
force. This would be the case for the voice coil of Figure 11.13b. A more general
approach is to start from a ﬂux linkage expression. Suppose λ4(x) is the coil ﬂux
linkage due to the permanent-magnet ﬁeld (if one is present). In Figure 11.13b,
the ﬂux linkage varies with the position of the coil with respect to the magnetic
circuit. In Figures 11.12 and 11.14 the conﬁguration of the magnetic circuit
changes as the magnet moves, and hence the ﬂux linkage changes in the coils.
The voltage component e4 is found from the rate of change of the ﬂux link-
age λ4:
e4 = ˙λ4 = dλ4
dx
dx
dt .
(11.35)
By power conservation, we ﬁnd
F1 = dλ4
dx i,
(11.36)

540
MAGNETIC CIRCUITS AND DEVICES
FIGURE 11.15. General bond graph for actuators in C-ﬁeld form using magnetic circuit
variables M and ˙ϕ and in IC-ﬁeld form using current and voltage variables.
which is represented by the modulated gyrator in Figure 11.15. For some devices,
such as voice coils with modest excursions and, roughly, dc motors, dλ4/dx
is nearly constant and the modulated gyrator can be replaced by a constant-
parameter gyrator. On the other hand, if the ﬁeld is produced not by a permanent
magnet but rather by an externally excited ﬁeld, the modulated gyrator parameter
might vary with time or ﬁeld current as well as with position.
The force component F2 arises when a permanent magnet moves in a magnetic
circuit. The magnet will have generally preferred positions corresponding to posi-
tions of minimum reluctance. Even without coil current there can be magnetic
forces depending on position. Such forces are of the same nature as mechanical
spring forces. If the energy in the magnetic circuit due to the permanent magnet,
W2(x), is given as a function of position, then energy conservation requires
F2 = dW2(x)
dx
.
(11.37)

DEVICE MODELS
541
Cases in which there is no permanent magnet (Figure 11.13a) or in which x
does not inﬂuence W2 (Figures 11.13b and 11.14) have no force component F2,
so the C-element representing F2 can be eliminated.
The ﬁnal force component F3 is due to the self-inductance effects of the coil
current. For the electrically linear case, the energy W3 may be expressed as
a function of the ﬂux ϕ in the coil and the position variable x by using the
reluctance R(x) in the form
W3(x, ϕ) = R(x)ϕ2
2
.
(11.38)
Differentiation of this expression yields the 2-port C-ﬁeld laws for magnetomo-
tive force M and force component F2 in conservative form implied in the upper
bond graph of Figure 11.15; that is,
M(x, ϕ) = ∂W3
∂ϕ
= R(x)ϕ,
(11.39)
F3(x, ϕ) = ∂W3
∂x
= ϕ2
2
dR(x)
dx
.
(11.40)
The gyrator with parameter N relates the voltage component e5 to the rate of
change of ﬂux ˙ϕ and the current i to the magnetomotive force M , yielding
e5 = N ˙ϕ,
(11.41)
Ni = M.
(11.42)
Alternatively, the IC-ﬁeld bond graph in the lower part of Figure 11.15 can be
described by the ﬂux linkage associated with the coil current λ5 as the position-
dependent self-inductance L(x). The energy W3 is then
W3(x, λ5) =
λ2
5
2L(x),
(11.43)
which yields the IC-ﬁeld laws for current force by differentiation:
i = ∂W3
∂λ5
=
λ5
L(x),
(11.44)
F3(x, λ5) = ∂W3
∂x
= −λ2
5
2
1
L2(x)
dL(x)
dx
,
(11.45)
where
dλ5
dt = e5.
(11.46)

542
MAGNETIC CIRCUITS AND DEVICES
The reluctance and the inductance are related by the expression
L(x) = N2
R(x).
(11.47)
The basic bond graph expressions for F3 involve the state-variable ﬂux ϕ
or ﬂux linkage λ5, while the corresponding expressions in Eqs. (11.34) and the
analogous expressions in Eqs. (11.31)–(11.33) use the current. To see that these
expressions are exactly equivalent, we merely use Eq. (11.44) to eliminate λ5 in
terms of i in Eq. (11.45), obtaining
F3(x, i) = −i2
2
dL(x)
dx
.
(11.48)
The C-ﬁeld laws (11.39), (11.40) and the IC-ﬁeld laws (11.44), (11.45) are useful
in simulation because they are in integral causality form.
The bond graph incorporates the force laws but has the additional advantage
that it also automatically incorporates the voltage law for the electromagnetically
induced voltage e in the form
e = e4 + e5,
(11.49)
with e4 from Eq. (11.35) and e5 from Eqs. (11.39)–(11.41) or from Eqs. (11.44)
and (11.45). Thus, the complete actuator description is included in the bond graph
in a power- and energy-consistent form.
Figure 11.16 shows the lower bond graph of Figure 11.15 supplemented by
electrical resistance, mechanical inertia, and mechanical friction elements. Com-
plete integral causality is shown: the input signals to the device are an external
voltage eext and an external force Fext, and the model responds with the current
FIGURE 11.16. General bond graph with coil resistance and mechanical mass effects
added. Integral causality shown.

REFERENCES
543
i and velocity ˙x. Certain interconnections to other system components could, of
course, induce derivative causality.
This bond graph can be simpliﬁed to reduce to known models of speciﬁc
devices such as those studied in Chapter 8. A permanent-magnet dc motor, for
example, does not need the IC-ﬁeld, because the inductance is not a strong func-
tion of x or θ. Thus, a simple constant inductance I attached to bond 5 sufﬁces.
Also, the MGY can usually be simpliﬁed to a constant-parameter GY , and the
C-element on bond 2 can be eliminated if the “cogging” torque is neglected.
Analogous simpliﬁcations can be made for the devices of Figures 11.13b and
11.14. The device of Figure 11.13a has no permanent magnet, and if residual
magnetic effects are neglected, both the MGY and the C on bond 2 may be
removed. Then, only the energy-storing C- or IC-ﬁeld remains, as in the models
for relays or movable-core solenoids. Finally, there are cases in which the electri-
cal time constants are short compared to the system time scales or the mechanical
inertia and friction can be neglected. In such cases, the model may be drastically
simpliﬁed and only very limited causal patterns may be possible.
Although this brief introduction to magnetic system bond graphs by no means
exhausts the subject, the basic ideas have been set forth, and it is hoped that
the interested reader can extend bond graph techniques to more complicated
situations in magnetic systems.
REFERENCES
[1] E. Colin Cherry, “The duality between interlinked electric and magnetic
circuits and the formation of transformer equivalent circuits,” Phys. Soc.
London Proc., 62, 101–111 (1949).
[2] R. W. Buntenbach, “Improved circuit models for inductors wound on dissi-
pative magnet cores,” 1968 Conference Record of Second Asilomar Con-
ference on Circuits and Systems, 68C64-ASIL, New York: IEEE, 1969,
pp. 229–236.
[3] D. Karnopp, “Computer models of hysteresis in mechanical and magnetic
components,” J . Franklin Inst., 316, No. 5, 405–415 (1983).
[4] J. K. Watson, Applications of Magnetism, New York: Wiley, 1980.
[5] M. G. Say and E. O. Taylor, Direct Current Machines, 2nd ed., London:
Pitman, 1986.
[6] P. G. Stohler and H. R. Christy, “Simulation and optimization of an elec-
tromechanical transducer,” Simulation, 13, No. 4, 202–210 (1969).
[7] D. Karnopp, “Bond graph models for electromagnetic actuators,” J. Franklin
Inst., 319, No. 1/2, 173–181 (1985).
[8] E. M. H. Kamerbeek, “Electric motors,” Philips Tech. Rev., 33, No. 8/9,
215–234 (1973).

544
MAGNETIC CIRCUITS AND DEVICES
[9] J. Timmerman, “Two electromagnetic vibrators,” Philips Tech. Rev., 33, No.
8/9, 249–259 (1973).
[10] L. Honds and K. H. Meyer, “A Linear C.D. motor with permanent magnets,”
Philips Tech. Rev., 40, No. 11/12, 329–337 (1982).
PROBLEMS
11-1. Consider the device of Figure 11.7. Suppose you are given the perme-
ability of the core material and of air, the pertinent physical dimensions
of the core, and the number of turns, N . Estimate the inductance of the
device if the core material remains in the linear range of the B –H curve.
11-2. In Figure 11.8, ﬁnd an expression for the capacitance parameters for the
sections of core material in terms of permeability and physical dimensions
in the linear case. Combine the capacitance parameters into a single
equivalent capacitance, and show how to estimate the inductance using
this equivalent capacitance.
11-3. In the transducer sketched below, a slug of magnetic material slides partly
in and out of the ﬂux path.
Make a simple bond graph model of the device, neglecting all loss effects
and all leakage paths. By imagining how the reluctance at the slug would
vary with displacement x, discuss qualitatively the difference you might
expect between the f -versus-x relation at constant current for this device
and for the device of Figure 11.11.
11-4. The ﬁgure shows typical demagnetization curves for several permanent-
magnet materials. (This is a conventional replotting of the lower
right-hand quadrant of the hysteresis curve in Figure 11.5.) The heavy
curve represents a typical high-energy-product rare earth material. The
(BH)max point for this material has Bm/μ0Hm ∼= 1, and one can see
that the Alnico materials have corresponding Bm/μ0Hm values greater
than 1.

PROBLEMS
545
Consider the design of a loudspeaker voice coil as shown schematically
in Figure 11.13b. The cylindrical coil is to have a diameter of 30 mm.
The air gap is 2 mm with an axial length of 10 mm. The magnet is also
cylindrical, with a diameter of 30 mm and unknown length. Assuming
that the rare earth magnet material is represented by the heavy curve on
the B –H plot, ﬁnd the optimum length of the magnet, In, as well as the
ﬂux density in the gap, Bg. Neglect any reluctance in the pole pieces that
lead the ﬂux to the radial gap.
11-5. The bond graph below represents a simpliﬁed version of the relay model
of Figure 11.11:

546
MAGNETIC CIRCUITS AND DEVICES
The core loss elements have been eliminated, and the total core reluctance
R0 has been incorporated in the 2-port C-ﬁeld constitutive law. The air
gap effective length x is related to the angle θ by the length l. The
mechanical spring force is k(x −x0), which applies as long as the relay
has not encountered a stop. The moment of inertia about the pivot is J0,
and the C-ﬁeld reluctance is R0 + x/μ0A. (See Eqs. (11.18)–(11.22).)
Apply causality and write the state equations for ϕ, x, and pθ.
11-6. Consider the force associated with a ﬂux ϕ across an air gap as illustrated
in Figure 11.9. Consider only the gap reluctance approximated by Eq.
(11.21) and that the MMF 
M is generated by a coil of N turns carrying
a constant current I . Express the force F as a function of x and I .
11-7. The bond graphs of Figure 11.15 apply to the devices of Figures 11.10,
11.12, 11.13, and 11.14. However, in several cases parts of the general
bond graph are not needed, because they represent effects that are either
totally absent or negligible in normal operation. Show simpliﬁed bond
graphs for the ﬁve devices sketched, and note why some elements can
be eliminated.
11-8. Suppose a permanent-magnet lifting system were capable of inducing a
B-value of 0.5 T across a very narrow air gap between the magnet surface
and a piece of steel. Develop an expression for the force per unit area in
terms of B and μ0, and ﬁnd the force developed for an area 1 cm × 1 cm.
How many kilograms could be lifted by this magnet?
11-9. Consider the design of a voice coil actuator of the type shown in
Figure 11.13b. The design parameters are to be
B = 0.5T,
R = 8 ,
Vmax = 10V,
Allowable current density = 20 × 106A/m2 = J,
Resistivity of copper wire = 1.72 × 10−8  · m = ρCu.
(The resistance of the coil is R = ρCul/Aw, where l is the wire length and
Aw is the wire area.) What would the maximum force of this device be?
11-10. Consider a device similar to that shown in Figure 11.10 but with a per-
manent magnet replacing the coil. Suppose that the total reluctance of
the magnetic circuit is R(θ). (Equation (11.23) indicates how R(θ) for
the gap might vary for small angles, but R(θ) would be valid for all
θ and would include core reluctance.) The bond graph below shows a
2-port C based on R(θ) as well as a 1-port C representing the demag-
netization curve for the permanent magnet. The relevant parts of the
constitutive laws are also sketched. (The M1 −ϕ sketch can be related
to the lower right-hand quadrant of the B –H hysteresis loop shown in
Figure 11.5.)

PROBLEMS
547
Noting that M2 = −M1, the ﬂux ϕ can be eliminated from the constitutive
laws so that the “cogging torque” τ can be expressed in terms of the
parameters M0, ϕ0 and the reluctance R(θ). Find the law that relates
τ to θ.

12
THERMOFLUID SYSTEMS
This chapter discusses sophisticated modeling concepts for thermoﬂuid systems.
These systems involve more sophisticated versions of the ﬂuid systems discussed
in Chapters 3 and 4 as well as heat ﬂow and temperature effects that have not
been treated thus far in our system models.
12.1
PSEUDO-BOND GRAPHS FOR HEAT TRANSFER
We start by deﬁning a so-called pseudo-bond graph for conduction heat transfer
which uses effort and ﬂow variables that do not quite ﬁt the pattern we have used
in modeling other physical systems. Traditionally, thermal systems have often
been presented as analogous to electric circuits, usually with temperature as the
effort variable analogous to voltage and heat ﬂow as the ﬂow variable analogous
to current. With this analogy there are then thermal resistors, capacitors, and
parallel and series connections (our 0- and 1-junctions) as well as effort and ﬂow
sources analogous to voltage and current sources. There are no thermal inertias,
however.
Since this analogy in which temperature is an effort variable and heat energy
ﬂow is a ﬂow variable has proven to be intuitively satisfying and useful in
practical engineering, we present it here. There is one major hitch, however. The
product of temperature (the effort) and heat ﬂow (the ﬂow) is not a power as
effort times ﬂow has been in what we now call a true bond graph. (Heat ﬂow
itself has the dimensions of power.) We choose to call any bond graph in which
e and f are not power variables a pseudo-bond graph. In contrast, in a true bond
graph the product of an effort and a ﬂow on a bond represents the power ﬂowing
on the bond.
A pseudo-bond graph cannot be coupled to a true bond graph using power
variables except by means of some ad hoc elements that do not obey all the rules
548
System Dynamics: Modeling, Simulation, and Control of Mechatronic Systems, Fifth Edition
Dean C. Karnopp, Donald L. Margolis and Ronald C. Rosenberg
Copyright © 2012 John Wiley & Sons, Inc.

PSEUDO-BOND GRAPHS FOR HEAT TRANSFER
549
FIGURE 12.1. Basic elements for models of conduction heat transfer systems: (a) ther-
mal resistor and 1-junction; (b) thermal capacitor and 0-junction.
of normal bond graph elements. However, bond graph techniques may be usefully
applied to any pseudo-bond graph as long as the basic elements in the pseudo-
bond graph correctly relate the new versions of the e, f , p, and q variables. Later,
it will be shown that a true bond graph for heat transfer results if temperature
and entropy ﬂow are used for effort and ﬂow variables, but the thermodynamic
arguments are more complicated than those necessary to establish the usefulness
of the heat transfer pseudo-bond graph. Later in the chapter, we will illustrate how
true bond graph models of thermoﬂuid systems can be constructed and ﬁnally
how pseudo-bond graphs can be extended to model compressible gas dynamics
in a simpler way than is possible using true bond graphs.
In Figure 12.1, two common situations that arise in the study of heat transfer
systems are depicted. In both cases, we assume the temperature gradients and
heat ﬂow are present only in the x direction. The case of Figure 12.1a represents
a pure pseudo-bond graph resistance. If T1 and T3 are the temperatures (on any
convenient scale) on the two sides of a slab of material of area A, we assume
that the ﬂow of heat through the slab, ˙Q2, is a function of T2 = T1 −T3. Note
that Q2 is heat energy and ˙Q2 has the dimensions of energy ﬂow or power. In
the linear case, we say,
R ˙Q2 = T1 −T3 = T2,
(12.1)
where ˙Q2 may be measured in watts, Btu/s, cal/s, or any other power measure.
(Because this is a pseudo-bond graph, and we will not be considering power
and energy conservation in various energy domains, the choice of units is not
critical as long as all element parameters are deﬁned in a consistent manner.) For
a material with thermal conductivity k, thickness l, and area A,
R = l
kA.
Note that in Figure 12.1a, the thermal resistor implies a relation between T2
and ˙Q2, and the 1-junction implies ˙Q1 = ˙Q2 = ˙Q3 and T2 = T1 −T3 = 0. We

550
THERMOFLUID SYSTEMS
have simply shown how the 1-port R and the 1-junction can be used together to
constrain the common ﬂow ˙Q2 to be a function of the difference between two
efforts, T1 −T3.
Figure 12.1b represents a lump of material that changes temperature as a
function of the net heat energy stored in it. That is, T5 is a function of
Q5 =
 t
˙Q5 dt =
 t  ˙Q4 −˙Q6

dt
Since T5 is an effort and Q5, the integral of a ﬂow, is a displacement, the
element is a pseudo-bond graph capacitor. (The common use of the term thermal
capacitance refers to the relation between temperature and heat energy, which is
another good reason for the introduction of these pseudo-bond graph variables.)
The bond graph of Figure 12.1b combines a C— with a 0-junction to indicate
that T4 = T5 = T6 and ˙Q5 = ˙Q4 −˙Q6. In the linear case a thermal capacitance
C can be deﬁned such that
T5 = T50 + 1
C
 t
t0
˙Q5 dt,
(12.2)
where T50 is the temperature at t = t0. The capacitance C can be found by
assuming that the element does negligible work by expanding or contracting,
so that changes in its internal energy are only the result of ˙Q5. Then, if c is a
speciﬁc heat,
c = ∂u
∂T ,
(12.3)
where u is the internal energy per unit mass, and
C = mc,
where m is the mass of the material being considered. Strictly speaking, c is the
speciﬁc heat at constant volume, but for most solids and liquids the work done
by expansion is small, as compared with the internal energy Q5, so that c can
be used even if the material is allowed to expand. (The case in which gases do
signiﬁcant work as they are heated will be treated in Sections 12.4 and 12.5.)
Figure 12.2 shows a typical use of the elements shown in Figure 12.1 and
introduces a thermal effort or temperature source. A unit area of the wall of a
pipe carrying hot ﬂuid is modeled. A lumped-parameter model consisting of three
resistors and two capacitors is used, and the inside and outside temperatures are
assumed to be determined by effort (temperature) sources.
If T1 changes because the temperature of the ﬂuid ﬂowing through the pipe
changes, the bond graph model can give a prediction of the dynamic changes in
temperature in the pipe wall. If the pipe is really made of a uniform material,

BASIC THERMODYNAMICS IN TRUE BOND GRAPH FORM
551
FIGURE 12.2. Heat transfer in pipe wall.
then the stepwise distribution of temperature with distance, x, that the model pro-
vides will be a fairly crude approximation of the actual temperature distribution
(a continuous function of both time and distance, x). A better approximation could
be obtained by splitting the pipe into a large number of resistor and capacitor
layers, but the model would be more complicated to use.
As one can see from this simple discussion, the use of pseudo-bond graphs
for conduction heat transfer problems leads to systems analogous to electrical
RC circuits. However, general thermoﬂuid systems can be considerably more
complex than this heat transfer example so we will present a succession of true
bond graph and pseudo-bond graph techniques to handle the various types of
thermoﬂuid systems of engineering signiﬁcance.
12.2
BASIC THERMODYNAMICS IN TRUE BOND GRAPH FORM
Thermodynamics is essentially the universal science of physical processes. All
of the models of physical systems that have been made so far may be studied
from the point of view of thermodynamics, and indeed, when C- and I -ﬁelds
were constrained to conserve energy or R-ﬁelds were arranged to dissipate power,
essentially thermodynamic arguments were used. On the other hand, since heat
ﬂow and temperature dependence have not yet been discussed, most of our
dynamic models can be characterized as isothermal models; that is, we treated
our multiports as if they were immersed in an inﬁnite reservoir that maintains

552
THERMOFLUID SYSTEMS
constant temperature even when energy is lost or supplied. In fact, we know that
all elements change their constitutive laws with temperature to greater or lesser
extent, and the transfer of heat and change in temperature are the special province
of thermodynamics.
Much of engineering thermodynamics is not very dynamic at all. It deals with
changes between equilibrium states but often is not concerned with the process of
change itself. In many cases, useful information may be extracted from knowledge
of the constraints that end-point equilibrium states of a system must satisfy. But
if we are really interested in the path a system will follow in state space, then
we must study what has come to be called irreversible thermodynamics, which
involves non-equilibrium systems.
In recent years, there has been an upsurge of interest in making dynamic
models for thermodynamic systems in which a variety of electrical, chemical,
mechanical, ﬂuid dynamic, and heat transfer effects are important. Here we can
only give an introductory account in which the model systems discussed previ-
ously are shown to have thermodynamic implications. We do this by the device
of considering systems of such physical extents and time scales that local pseudo-
equilibrium conditions exist. In this way, we may modify some familiar relations
from thermostatics into a slowly varying form of irreversible thermodynamics.
Another restriction for the present is to consider only closed systems, that is,
systems in which no mass passes through the system boundaries. This restriction
to a Lagrangian point of view will be lifted in the sections on ﬂuid mechanics
and compressible gas dynamics. The alternative to the Lagrangian point of view,
the control volume or Eulerian point of view, which is often used for certain
types of systems, introduces a set of modeling difﬁculties that are best left to be
discussed in later sections.
Consider ﬁrst, then, a ﬁxed amount of a pure substance that is in at least
pseudo-equilibrium, so that all parts of the substance are at essentially identical
conditions of pressure, temperature, density, and so forth.
We consider a unit mass of the substance. Extensive quantities such as volume,
internal energy, and entropy for a unit mass will be designated by the lowercase
letters v, u, s. When a mass of the substance, m, is involved, the corresponding
variables will be designated by uppercase letters: V = mv, U = mu, and S = ms.
The substance is supposed to be of such small extent and the disturbances on
such a slow time scale that wave motion, turbulence, and so forth are negligible.
Then in the absence of motion and electromagnetic or surface-tension forces, we
may assume that such a pure substance has only two independent properties. All
other properties are related to any two independent properties by equations of
state for the substance.
A useful, and logical, way to describe the constitutive relations for a pure
substance begins with the statement that the internal energy per unit mass, u, of
the substance is a function of the volume v and entropy s per unit mass:
u = u(s, v).
(12.4)

BASIC THERMODYNAMICS IN TRUE BOND GRAPH FORM
553
The well-known Gibbs equation relates changes in u to changes in v and s:
du = T ds −p dv,
(12.5)
where T is the thermodynamic temperature and p is the pressure. (In all that fol-
lows, T will indicate thermodynamic or absolute temperature, a positive quantity.)
The relation (12.5) involves energy or work. If the substance changes state
slowly enough, we may treat it as if it were a lumped-parameter multiport with
the relation
du
dt = T ds
dt −pdv
dt .
(12.6)
All three terms in Eq. (12.6) have the dimensions of power. The term T ds/dt is
associated with a ﬂow of heat or, sometimes, with dissipative work such as might
be done by a paddle wheel slowly stirring a ﬂuid. The term p dv/dt represents the
sort of reversible power with which we have been dealing frequently in dynamic
models. (Note that dv/dt is a volume ﬂow rate for the unit mass; this is the type
of variable used in Chapter 4 as a bond graph ﬂow variable in hydraulic systems.)
Since
du = ∂u
∂s ds + ∂u
∂v dv,
it is clear that
T = ∂u
∂s
and
−p = ∂u
∂v .
(12.7)
Also
∂T
∂v

s
= ∂2u
∂v∂s = ∂(−p)
∂s

v
,
(12.8)
which we may recognize as a reciprocal relation similar to those found for other
energy-storing ﬁelds as studied in Chapter 7. In thermodynamics, Eq. (12.8) is
called a Maxwell reciprocal relation.
The constitutive laws of the pure substance may be represented by a true bond
graph C-ﬁeld; thus,
T⇀
˙s C
P⇀
˙v
if we are willing to call T and p efforts, ˙s and ˙v ﬂows, and s and v displacements.
This identiﬁcation of T as an effort and ˙s as a ﬂow distinguishes a true bond
graph (with T ˙S being power) from the pseudo-bond graph of the previous section
that used T as an effort and ˙Q as a ﬂow (for which the product T ˙Q is temperature
multiplied by power).
Integral causality,
|
T⇀
˙s C
P⇀
˙v |

554
THERMOFLUID SYSTEMS
implies
T = T (s, v),
p = p(s, v),
(12.9)
which are also implied by Eqs. (12.4) and (12.5). The only unusual feature of the
pure-substance C-ﬁeld is the sign convention on the p˙v port, which is positive
outward corresponding to the traditional form of the Gibbs equation, Eq. (12.5).
The internal energy state function is associated with all integral causality and
with constitutive laws in the form of (12.9). For mixed- and all-derivative causal-
ity, the constitutive laws are switched around. In thermodynamics this switching
around of independent and dependent variables is often accomplished using the
Legendre transformations of the internal energy u. The enthalpy h, Helmholtz
free energy f , and Gibbs free energy φ are all Legendre transformations of the
internal energy u and correspond to different causal patterns. The enthalpy is
h(s, p) ≡u + pv,
(12.10)
and its derivatives are
∂h
∂s = T (s, p),
(12.11)
∂h
∂p = v(s, p).
(12.12)
Using h(s, p), another Maxwell relation can be found:
∂T
∂p

s
= ∂2h
∂s∂p = ∂v
∂s

p
.
(12.13)
The causal pattern for the C-ﬁeld corresponding to h is shown below:
h = h(s, p) ⇔|
T
⇀
˙s C|
P
⇀
˙v .
The Helmholtz free energy is deﬁned by the transformation
f (T, v) ≡u −Ts.
(12.14)
Its derivatives are
∂f
∂T = −s(T, v),
(12.15)
∂f
∂v = −p(T, v).
(12.16)
And yet another Maxwell relation is
∂(−s)
∂v

T
= ∂2f
∂T ∂v = ∂(−p)
∂T

v
.
(12.17)

BASIC THERMODYNAMICS IN TRUE BOND GRAPH FORM
555
The causal pattern corresponding to f is
f = f (T, v) ⇔
T⇀
˙s |C
P⇀
˙v |.
Finally, the Gibbs free energy is deﬁned by a double Legendre transformation
on u:
φ(T, p) = u + pv −Ts.
(12.18)
The derivatives of φ are
∂φ
∂T = −s(T, p),
(12.19)
∂φ
∂p = +v(T, p),
(12.20)
and the Maxwell relation is
∂(−s)
∂p

T
= ∂2φ
∂T ∂p = ∂v
∂T

v
.
(12.21)
The Gibbs free energy corresponds to all-derivative causality for the C-ﬁeld:
φ = φ(T, p) ⇔
T⇀
˙s |C|
P
⇀
˙v .
The energy function u and the co-energy functions h, f , and φ, which are
Legendre transformations of u, have been expressed in terms of their own natural
variables. When this is done, the constitutive functions for the substance may be
found by differentiation, and such constitutive laws automatically ensure that the
C-ﬁeld will be conservative. On the other hand, one could write out constitutive
laws in any form without the use of state functions such as u, h, f , or φ. The
only difﬁculty is that arbitrary constitutive laws would not, in general, allow the
existence of an internal energy function. In a cycle, a substance with arbitrary
constitutive laws might allow net energy production and thus the construction
of a perpetual motion machine of the ﬁrst kind. In a sense, deriving constitutive
laws from u, h, f , or φ is safer than not using state functions, since conservation
of energy will be built into the relations.
Although there is elegance to the connection between thermodynamic C-ﬁelds
and states and the C-ﬁelds discussed in Chapter 7 for other physical systems,
the use of true bond graphs for thermoﬂuid systems is not without its practical
difﬁculties.
A classical example of a constitutive law not stated in terms of state function
derivatives is the perfect gas law. This very useful law can be written
pv = RT,
(12.22)

556
THERMOFLUID SYSTEMS
for unit mass, in which R is a constant. It is often stated, in addition, that u is
a function of temperature only. This means that if the constitutive laws for the
gas were used to express u(s, v) in terms of, say, T and v, then u would be
a function only of T and not of v. As an exercise, we ﬁrst we derive this fact
using some of the relations shown above.
If Eq. (12.22) is solved for p in terms of T and v, the constitutive law in the
form of Eq. (12.16) is obtained:
∂f
∂v

T
= −p(T, v) = −RT
v
.
(12.23)
Using this result, the Helmholtz free energy can be found by integration:
f (T, v) = −RT ln v + ψ(T ),
(12.24)
where ψ(T) is some function of temperature alone. Then, using Eq. (12.15),
−s(T, v) = ∂f
∂T = −R ln v + dψ(T )
dT
.
(12.25)
Finally, substituting Eq. (12.25) into Eq. (12.14) and solving for u,
u(T, v) = f (T, v) + Ts = −RT ln v + ψ(T ) + RT ln v −T dψ(T )
dT
= ψ(T ) −T dψ(T )
dT
,
(12.26)
which demonstrates that u is only a function of T.
Although we have now shown that u can be represented as a function of T,
we really need u in terms of s and v in order to evaluate the complete equations
of state. There are two complete equations of state because the gas is a 2-port
C-ﬁeld. We need more information than just Eq. (12.22). (We could solve for the
function ψ in Eq. (12.24) for example.) It is more common to assume that the
two so-called speciﬁc heats are constant. The speciﬁc heat at a constant pressure,
cp, is deﬁned as
cp = ∂h
∂T

p
,
(12.27)
and the speciﬁc heat at constant volume, cv, is
cv = ∂u
∂T

v
.
(12.28)
By substituting Eq. (12.22) into Eq. (12.10) and differentiating as in
Eq. (12.27), we ﬁnd that
cp = cv + R.
(12.29)

BASIC THERMODYNAMICS IN TRUE BOND GRAPH FORM
557
If we now assume that cv is constant, then Eq. (12.28) may be integrated to
yield
u = cv(T −T0),
(12.30)
and, noting that Eqs. (12.10) and (12.22) imply that h is also a function only of
T, Eq. (12.27) may be integrated similarly to yield
h = cp(T −T0),
(12.31)
in which the subscript 0 stands for a state in which it is assumed that u = h =
s = 0.
Rearranging the basic equation (12.5) and using Eq. (12.30), we can ﬁnd s:
ds = du
T + pdv
T = cv
dT
T + R dv
v ,
or
s = cv ln T
T0
+ R ln v
v0
,
which may be solved for T (s, v):
T = T0es/cv
 v
v0
−R/cv
.
(12.32)
Further manipulations of Eq. (12.5) yield
ds = cp
dv
v + cv
dp
p ,
s = cp ln v
v0
+ cv ln p
p0
,
which yield p(s, v),
p = p0es/cv
 v
v0
−cp/cv
.
(12.33)
Equations (12.32) and (12.33) are the complete relations for the C-ﬁeld in
the form (12.4). It is desirable, however, to show that these equations do indeed
derive from u(s, v). Using Eq. (12.30) and (12.32), we have
u(s, v) = cvT0

es/cv
 v
v0
−R/cv
−1
	
,
(12.34)
from which we ﬁnd
T = ∂u
∂s = T0es/cv
 v
v0
−R/cv
,

558
THERMOFLUID SYSTEMS
which agrees with Eq. (12.32), and
−p = ∂u
∂v = cv
T0
v0
es/cv
−R
cv
  v
v0
(−R/cv)−1
= −RT0
v0
es/cv
 v
v0
−(R+cv)/cv
,
(12.35)
which agrees with Eq. (12.33) upon using Eqs. (12.22) and (12.29).
The reader probably feels that all of the above manipulations of the perfect
gas law have only produced some complicated laws in Eqs. (12.32) and (12.33)
in place of the simple law pv = RT. You are entirely correct in this view, but it
is important to remember that (1) pv = RT is not a complete characterization of
the C-ﬁeld of the gas and (2) pv = RT is in a form that only allows differential
causality on the T ˙S port. Equations (12.32) and (12.33) are complete and in
integral causality form at both C-ﬁeld ports and hence are useful in making a
dynamic model of a quantity of gas as a thermomechanical transducer using true
bond graphs.
Later in this chapter we show that practical models of thermodynamic systems
are often more easily made by deﬁning pseudo-bond graphs rather than continuing
to use true bond graphs.
12.3
TRUE BOND GRAPHS FOR HEAT TRANSFER
The T ˙S port for the pure-substance C-ﬁeld may be used to model all types
of power ﬂow that are associated with entropy increase, or, in other words,
irreversible effects. Changes in entropy of a pure substance can be accomplished
by a variety of dissipative effects, such as stirring with a paddle wheel or heating
with an electrical resistor immersed in a ﬂuid. In each case, one may identify the
power dissipated with T ˙S in order to ﬁnd the change in state of the substance. An
important use of T ˙S ports is in modeling the effects of heat ﬂow. Using ˙Q to stand
for the rate of transfer of heat in power units, we may often identify ˙Q with T ˙S.
Consider ﬁrst the simple case of conduction heat transfer shown in
Figure 12.3a. This is the same type of system studied using pseudo-bond graphs
in Section 12.1 but now we will use entropy ﬂow rather than heat ﬂow as the
ﬂow variable in our true bond graph.
The idea is that two reservoirs of thermal energy at absolute temperatures
T1 and T2 are allowed to communicate through a thermal resistance but in no
other way. Generally, a heat ﬂow ˙Q will be set up between the two reservoirs.
It is common experience that heat ﬂows from higher toward lower temperature,
and, indeed, this observation is behind the second law of thermodynamics. In
Figure 12.3b, possible relations between ˙Q and T1 −T2 are sketched for the ther-
mal resistance. All we need to assume is that ˙Q is related to T1 −T2 in such a way
that any values of ˙Q and T1 −T2 would plot in the ﬁrst and third quadrants of the
˙Q versus T1 −T2 plane. (Although it is common to assume that ˙Q is a monotonic
function of T1 −T2 as sketched, the argument is true if ˙Q is positive when T1 −T2
is positive, negative when T1 −T2 is negative, and zero when T1 −T2 is zero.)

TRUE BOND GRAPHS FOR HEAT TRANSFER
559
FIGURE 12.3. Conduction heat transfer: (a) thermal resistance; (b) allowed relations
between Q and T1 −T2; (c) forbidden regions for 1/1T2 −1/1T1.
If we now write
T1 ˙S1 = ˙Q = T2 ˙S2,
(12.36)
which implies that the heat ﬂow out of one body is instantaneously equal to the
heat ﬂow into the other body, then the net entropy ﬂow rate, ˙S2 −˙S1, may be
found:
˙S2 −˙S1 =
˙Q
T2
−
˙Q
T1
= ˙Q
 1
T2
−1
T1

= ˙QT1 −T2
T1T2
.
(12.37)
In Figure 12.3c, it is shown that 1/T2 −1/T1 is positive, negative, or zero as
T1 −T2 is positive, negative, or zero. This is true because the absolute temper-
atures are inherently positive quantities. Thus, the net entropy production rate,
which is the product of ˙Q and 1/T2 −1/T1, is positive for any ﬁnite value
of T1 −T2 and vanishes only when ˙Q vanishes. The thermal resistor may be
represented by the 2-port ﬁeld shown below:
T1
⇀
˙S1
R
T2
⇀
˙S2
.
It may come as a surprise that the true bond graph requires a 2-port R to
represent the same system that the pseudo-bond graph represented as a 1-port R

560
THERMOFLUID SYSTEMS
attached to a 1-junction. This is an indication that the analogy between electrical
RC systems and heat transfer systems is not as complete as is often assumed.
Although the 2-port resistive ﬁeld is power conservative (Eq. (12.36)), it is
neither a transformer nor a gyrator. It has the peculiar property that, with the
sign convention shown above,
˙S2 −˙S1 ≥0,
which implies that the entropy ﬂow leaving the ﬁeld is greater than the entropy
ﬂow entering the ﬁeld no matter which way the heat is ﬂowing. When the thermal
resistor is part of a system, it will tend to increase the entropy of the system
whenever any heat ﬂows through the resistor.
A possible constitutive law for the resistor is
˙Q = H(T1 −T2),
or
˙S1 = H(T1 −T2)
T1
,
˙S2 = H(T1 −T2)
T2
,
(12.38)
where the heat transfer coefﬁcient H is assumed to be constant or perhaps a
function of the average temperature, (T1 + T2)/2. As a check, the net entropy
production rate is
˙S2 −˙S1 = H(T1 −T2)
T2
−H(T1 −T2)
T1
= H(T1 −T2)2
T1T2
> 0,
(12.39)
which is always positive as it should be.
Note that Eq. (12.38) is written in the causal form,
T1
⇀|
˙S1
R
T2
|⇀
˙S2
.
Given any two temperatures T1 > 0, T2 > 0, it is possible to solve for ˙Q, ˙S1,
and ˙S2. The remaining causal forms are not so useful. For example,
T1
|⇀
˙S1
R
T2
⇀|
˙S2
.
implies that given any ˙S1 and ˙S2, the resistance should provide T1 and T2. But we
cannot actually impose arbitrary variables ˙S1 and ˙S2, since Eq. (12.37) or (12.39)
must be obeyed and the temperatures can never be negative. This causality is
therefore not useful for dynamic systems. Even mixed causalities are fraught with
similar difﬁculties, so in what follows, the thermal resistor will be assumed to
accept only the causality −|R|−.

TRUE BOND GRAPHS FOR HEAT TRANSFER
561
12.3.1
A Simple Example of a True Bond Graph Model
Figure 12.4 shows a system incorporating two chambers containing compressible
ﬂuids. One chamber is of constant volume, so that the internal energy of the ﬂuid
contained in the chamber varies only because of heat ﬂow through the partition,
which is modeled as a thermal resistance. The volume of the other chamber is
changed as a piston moves back and forth.
The bond graph for the system shown in Figure 12.4b incorporates two
capacitance elements for the ﬂuids and an R-ﬁeld for the thermal resistance.
The 0-junction is used simply to achieve inward sign conventions for both the
T1 ˙S1 port of the left-hand C and the resistive ﬁeld, so that the sign conven-
tions assumed previously are reﬂected in the model. The 0-junction assures that
T1 = T2 but ˙S1 = −˙S2.
In Figure 12.4c integral causality is shown for the system. The preferred R-
ﬁeld causality is compatible with integral causality on both C-elements. The
state variables are S1 (the entropy of the ﬁxed-volume ﬂuid), S3 (the entropy of
the variable-volume ﬂuid), and V4 (the volume of the variable chamber). The
velocity ˙X5(t) plays the role of an input variable.
The constitutive laws for the ﬂuids could be found by starting with the internal
energy per unit mass, u(s, v), a function of entropy per unit mass and speciﬁc
volume, and then converting to the total energy U as a function of total entropy
S and volume V . The perfect gas internal energy function of Eq. (12.34) could
be used, for example. The evaluation of U requires a knowledge of the total mass
as well as the initial state of the ﬂuids. The pressure and temperature constitutive
relations could then be found by differentiating U with respect to S and V . (In
the left-hand chamber, the volume does not actually change during a simulation
FIGURE 12.4. Example system: (a) schematic diagram; (b) bond graph; (c) bond graph
with integral causality.

562
THERMOFLUID SYSTEMS
but the entropy does.) The constitutive relations for the thermal resistance have
been discussed in the previous section.
Clearly, the model for the system represented by the bond graph can only
be appropriate for slow changes. We assume, for example, that the ﬂuids are in
pseudo-equilibrium, so that the temperature and pressure are essentially uniform
throughout the volumes at every instant. This would not be the case if one needed
to worry about acoustic waves or the details of heat transmission in the ﬂuids
themselves. Also, although the entire system is power conservative, the entropy
of the two C-elements will increase if any heat ﬂows. From the point of view
of the external port, this irreversibility makes it appear that energy is lost. For
example, if X5 is taken through a cycle starting from an equilibrium state at which
T2 = T3, the ﬂuid temperature in the variable volume will change, heat will ﬂow,
and, during the cycle, a net energy loss will be observed at the external port.
What the bond graph shows is that energy is not lost, but rather converted back
into thermal energy that cannot be completely converted back into mechanical
energy except in the limiting case in which X5 moves so slowly that T2 and T3
are virtually identical and the net entropy production almost vanishes.
In the model of Figure 12.4 no irreversible phenomena other than heat transfer
have been included. It would not be hard to include other dissipative effects. For
example, if the piston had Coulomb friction and if all the mechanical energy lost
in friction were converted into thermal energy, a simple model would involve
the creation of another equivalent entropy ﬂow to the ﬂuid C-ﬁeld equal to the
dissipated power divided by the ﬂuid temperature. A bond graph for this case is
shown in Figure 12.5.
The Coulomb friction resistor may be described by a relation such as
F6 = A sgn ˙X5,
so that the power dissipated is
F6 ˙X5 = A ˙X5 sgn ˙X5 ≥0.
The entropy ﬂow ˙S4 is then just
˙S4 = 1
T3
A ˙X5 sgn ˙X5 ≥0.
The 2-port R-ﬁeld version of a mechanical resistor can accept either causality
at the mechanical port but only the causality shown in Figure 12.5 at the thermal
FIGURE 12.5. System of Figure 12.4 with piston friction.

TRUE BOND GRAPHS FOR HEAT TRANSFER
563
port. Actually, the frictional energy may not reach the ﬂuid instantaneously, as
assumed in the model: It may heat the piston and wall material ﬁrst and then
warm the ﬂuid. A more complex model with other thermal capacitances could
show such effects.
12.3.2
An Electrothermal Resistor
Power dissipation always results in thermal effects, although these effects can
sometimes be neglected or treated separately from a main dynamic model. For
example, electrical resistors heat up as electrical power is dissipated, but in many
cases the heating does not change the characteristics of the device very much if
a means of cooling the resistor is provided. For example, typical circuit models
often assume that the circuit components remain essentially at a constant temper-
ature. Here, we construct a true bond graph model that contains both electrical
and thermal effects.
The resistor is sketched in Figure 12.6a. The body of the resistor is assumed
to have a fairly uniform temperature T and to be immersed in an atmosphere at
temperature T0. The resistor is assumed to dissipate electrical power:
ei ≥0.
(12.40)
FIGURE 12.6. The electrothermal resistor: (a) schematic diagram; (b) deﬁnition of ther-
mal capacity; (c) capacity relationship in terms of entropy.

564
THERMOFLUID SYSTEMS
As long as Eq. (12.40) is obeyed, we may assume that the relation between e
and i for the resistor has some temperature dependence.
The power lost electrically is often spoken of as being converted to heat, so
we will assume that
ei = ˙Q = T ˙S,
(12.41)
in which it is a moot point whether ˙Q should be regarded as a heat ﬂow in the
usual sense. Two causal forms for an R-ﬁeld representation are useful:
e
|⇀
i
R
T
|⇀
˙S
.
e = e(i, T ),
˙S = ie(iT )
T
,
(12.42)
and
e
↼|
i
R
T
|⇀
˙S
,
i = i(e, T ),
˙S = ei(e T)
T
.
(12.43)
As in previous examples, there is a preferred causality at the thermal port.
The temperature of the resistor body depends on how much thermal energy
has been stored up in the resistor body. In what follows, we neglect any work
done against the pressure of the atmosphere by expansion of the resistor, that is,
the assumption is that no signiﬁcant power ﬂows at aP ˙V port. The temperature,
then, will depend on the amount of energy in the form T ˙S that has been absorbed
and a 1-port C element will sufﬁce as it did for the constant volume chamber in
Figure 12.4.
It is common to assume that T is a function of the stored energy, Q, but now
we must express T as a function of the entropy, S. These two points of view
are readily reconciled, since ˙Q and ˙S are related by Eq. (12.41). Suppose, for
example, that a thermal capacity C (approximately constant) has been deﬁned as
in Figure 12.6b and in the equation
T = T0 + Q
C ,
(12.44)
in which we have integrated ˙Q to ﬁnd Q at a time when T = T0. Using
Eqs. (12.41) and (12.44), S may be found:
S =
 S
0
dS =
 Q
0
dQ
T0 + Q/C = C ln(T0 + Q/C)
T0
,
(12.45)
where S and Q are both assumed to vanish at the initial time. Solving Eq. (12.45)
for Q in terms of S and then substituting the result into Eq. (12.44), we ﬁnd
T = T0eS/C,
(12.46)

FLUID DYNAMIC SYSTEMS REVISITED
565
FIGURE 12.7. Bond graph for electrothermal resistor.
which is the relationship for the thermal capacitance when S is used instead of Q.
(In reality, since T is an absolute temperature, Q ∼= T0S and T ∼= T0(1 + S/C)
for modest excursions of T from T0.)
The bond graph of Figure 12.7 shows the complete model for the resistor. The
entire system is conservative, but power is lost from the electrical port, since the
power on some heat ﬂow bonds cannot reverse. Both the electrothermal and heat
transfer R-ﬁelds represent irreversible effects and generate entropy. As long as
the temperature dependence of the electrical resistance is not strong, one may
avoid the complicated model of Figure 12.7 in favor of a simple 1-port electrical
resistance. However, in principle, the electrical and thermal systems are always
coupled bilaterally, so that models of this type may sometimes be required.
The reader will have noticed in this brief introduction to true bond graph
models for heat transfer systems that only closed systems were modeled; that is;
no mass crossed the boundary of the system. It is also probably clear that the
introduction of entropy ﬂow as a bond graph ﬂow variable in order to generate a
true bond graph complicates the bond graph modeling process compared to the
pseudo-bond graph introduced at in Section 12.1.
Much of the science of thermodynamics is concerned with ﬂow processes in
which not only power, but also mass, ﬂows into and out of control volumes in
the system being modeled. While such systems can often be modeled with true
bond graphs, the convection of energy as mass moves through the boundary of
a control volume complicates the modeling process. Some ﬂow-process models,
in which the distinction between Lagrangian and Eulerian descriptions of ﬂuid
motion parallels that between closed and open thermodynamic systems, will be
discussed in the following sections before we deﬁne a class of pseudo-bond
graphs particularly useful for open thermoﬂuid systems.
12.4
FLUID DYNAMIC SYSTEMS REVISITED
In Chapter 4, we established effort, ﬂow, displacement, and momentum variables
for ﬂuid systems of the closed-circuit hydraulic type, in which the static pressure
times the volume ﬂow rate represented most of the transmitted power. (In this
section, as in Chapters 3 and 4, Q represents a volume ﬂow rate—a bond graph
ﬂow variable—not heat energy as in the previous section.) We now take a deeper
look at ﬂuid systems in general and point out some of the limitations of the
modeling done in Chapter 4.

566
THERMOFLUID SYSTEMS
Much of ﬂuid mechanics work is concerned with ﬁeld problems in which a
ﬂow ﬁeld in two or three dimensions is to be determined. Such problems are
usually described by partial differential equations. Unless an analytic solution
to such a problem happens to be known, one must resort to ﬁnite-difference or
ﬁnite-element techniques. Such techniques represent the continuum with a large
number of similar lumps. Although bond graphs can be made for the “micro-
lumps” involved in partial differential equations (or their ﬁnite approximations),
there often is little to be gained by such a representation. The micro-lumps are
all very similar, and they interact with their fellows only in standardized ways
which don’t beneﬁt very much from bond graph techniques.
In this section, the main concern will be with the gross type of lumping
commonly done when a ﬂuid system is a small part of a larger system and
therefore cannot practically be represented in great detail. Typical examples of
such cases occur when hydraulic or pneumatic elements form part of a control
system. In what follows, the main concern will be with interior ﬂows and with
ﬂuid dynamic interaction with solid mechanical elements.
As a simple example of the sort of approximations often made in the analysis of
ﬂuid systems, consider the line element shown in Figure 12.8. The model, which
is analogous to electrical-transmission-line models, attempts to treat a variety of
FIGURE 12.8. Lumped representation of ﬂuid-ﬁlled lines: (a) sketch of line with some
parameters; (b) schematic diagram; (c) bond graph.

FLUID DYNAMIC SYSTEMS REVISITED
567
effects clearly present in real lines. The model is plausible for short segments
of line and especially for linear elements—yet it is often used for long lengths l
and for nonlinear elements. As will be seen, there are some philosophical snags
with this model if it is used without careful thought.
First of all, it is clear that the model is one dimensional. The volume ﬂow
rate past a unit cross-sectional area, Q, and the pressure, p, clearly must be
thought of as quantities averaged over a ﬁeld of velocities and pressures that
vary over the line cross-sectional area. Since the velocity proﬁle of the ﬂow may
vary widely during transient conditions, it is clear that the variables p and Q
and the parameters of the —R, —C, and —I elements in Figure 12.8 cannot be
evaluated exactly unless the nature of the ﬂow over the cross-sectional area is
known in advance. Nevertheless, in system design studies, one rarely is sure in
advance how the ﬂow ﬁelds in various parts of the system will behave, so that
one must make at least a preliminary estimate of the system parameters before
the dynamics of the ﬂow can even be estimated.
Consider ﬁrst the problem of estimating the inertia of the ﬂuid in the line.
An elementary derivation of the inertia coefﬁcient as outlined in Section 4.3.3
proceeds as follows from Figure 12.8: The mass of the ﬂuid in the line is ρAl,
the force tending to accelerate the ﬂuid is A(p1 −p3), and the velocity of the
ﬂuid is Q2/A. Thus,
ρAl d
dt
Q2
A

= A(p1 −p3) = Ap2,
or
Q2 =
1
ρl/App2,
(12.47)
where pp2 is the pressure momentum of bond 2 (or the time integral of p2).
This result shows that the mass-like inertia coefﬁcient is I = ρl/A when p, Q
variables are used. That the inertia of small-area lines is larger than the inertia
of larger area lines of the same length was something of a surprise.
There are several problems with the simple derivation given above. First,
in keeping with the assumption of one-dimensionality, the ﬂuid in the pipe was
treated as if it moved as a rigid body. It is difﬁcult to improve on this assumption
until it is known how the velocity proﬁle of the ﬂuid changes in space and time.
The types of ﬂows being considered here are often called quasi-one-dimensional
ﬂows, and in the steady state, when a well-developed velocity proﬁle is known
at each cross section, one may identify Q/A as an average velocity. In later
calculations, the average of the square of the velocity over the cross section will
be needed, and this quantity may be taken as βQ2/A2, where the correction factor
β ≥1 can be calculated if the velocity proﬁle is known (see Reference [2]). The
factor β is unity only for a uniform velocity distribution that would occur only
for frictionless, irrotational ﬂow. For transient conditions the velocity distribution
is often very hard to estimate, so in the remainder of this section we will assume
a uniform distribution even in cases in which this cannot strictly be true. The
accuracy of some results may be slightly improved by the introduction of factors

568
THERMOFLUID SYSTEMS
such as β, although the estimation of the factors in the absence of experimental
data may be difﬁcult.
Second, unless one is willing to assume that the ﬂuid is incompressible, the
proper value of the density ρ is open to question. If l = dx →0, then ρ(x, t)
might represent an instantaneous value of ρ at position x, but if l is ﬁnite, then
existence of capacitance in Figure 12.8 is not compatible with using ρ as a
constant. If ρ varies, then, of course, the two ends of the slug of ﬂuid do not
necessarily move with the same velocity. Later on, a more sophisticated look
at the problem will be taken. For now, let it simply be noted that for hydraulic
systems in which the density changes are small, an average density for ρ is often
sufﬁcient, despite the contradiction implied by the use of a compliance together
with a constant inertia.
One defect of this elementary derivation is that the slug of ﬂuid is treated as
a rigid body, even though it is clear that a control volume comprising a length
of line through which mass and momentum ﬂow is being considered. As will be
demonstrated, momentum ﬂows at the line ends cancel out only when the two
ends of the pipe have identical cross-sectional areas. Further, the elementary
derivation does not generalize readily when pipes of varying area are encoun-
tered. It is surprising that few authors of elementary system dynamics texts even
mention the control volume basis for their ﬂuid mechanical system dynamics.
The element R4 in Figure 12.8 represents a loss in pressure beyond that
required to accelerate the ﬂuid. The relation between p4 and Q4 would be easy
to specify as a generally nonlinear relationship if one could use the data for
ﬂow in pipes that has been determined experimentally. But almost all the data
on friction factors is for fully developed steady ﬂow and would not apply to
any but the slowest transient conditions. For this reason, the analyst must be
prepared to experiment with the friction loss law until the model response matches
experimental data sufﬁciently well.
The next element in Figure 12.8 is intended to model the compliance of the
ﬂuid and pipe walls. The ﬂow Q6, which is the difference between Q5 and Q7,
represents a loss in ﬂow between the ends of the pipe. The pressure p6 (which
equals p5 and p7) can be determined from the integral of Q6 when one can
deﬁne a bulk modulus B:
p6(t) = p6(0) + B
V0
 t
0
Q6 dt = p6(0) + B
V0
V6(t),
(12.48)
where V0 is the volume of the ﬂuid in the pipe at t = 0 when the pressure is
p6(0). One might think that, simply by replacing the linear relation (12.48) with
some nonlinear relation between p6 and V6 to model compressibility effects of
a gas, the same model would serve in the case in which large density changes
occur, but the situation is not quite so simple. As is demonstrated in Section 12.5,
when density variations are signiﬁcant, the thermodynamics of the situation must
be studied.
Finally, R8 represents a loss of ﬂow in the pipe section due to leakage. As
the bond graph stands, the pressure on bond 8 represents gage pressure, i.e., the

FLUID DYNAMIC SYSTEMS REVISITED
569
ﬂuid pressure with respect to atmospheric pressure. Clearly, if the p’s are meant
to represent absolute pressure rather than gage pressure, R8 should react to the
difference between p8 and the pressure external to the pipe, rather than just to p8
itself. This would require that R8 be attached to a 1-junction that computes the
difference between the internal and external pressure and imposes the condition
that ﬂow out of the pipe is the same as ﬂow into the external atmosphere.
From the brief introduction to the lumped line elements given above, it is clear
that there are some fundamental difﬁculties in justifying the lumping process.
Many difﬁculties disappear when only a linearized lumped model is desired,
since it then is plausible to neglect small changes in quantities that have ﬁnite
mean values. To see more clearly the nature of some of the more commonly used
ﬂuid dynamic models, one needs to consider the partial differential equations of
ﬂuid mechanics and nonlinear effects.
12.4.1
One-Dimensional Incompressible Flow
To illuminate the connection between standard techniques in ﬂuid mechanics and
a lumped representation using bond graph elements, a derivation of Bernoulli’s
equation is given ﬁrst. This is a straightforward extension of the true bond graph
models considered in Chapter 4 and does not involve complicated thermodynamic
effects.
Consider the problem of Figure 12.9a. Let s represent distance along the
centerline of a curved rigid pipe of length l. Then A(s) is the pipe cross-sectional
area, and x(s) and z(s) describe the horizontal and vertical positions of the pipe
centerline, respectively. Using the Eulerian method to describe the ﬂuid motion,
v(s, t) represents the (average) ﬂuid velocity at position s and time t, and p(s, t)
represents the pressure. After expressing the acceleration as a function of space
and time, see Reference [2], Newton’s law yields
ρ Dv
Dt = ρ ∂v
∂t + ρv∂v
∂s = −∂p
∂s −ρg dz
ds.
(12.49)
Noting that, because of incompressibility, the volume ﬂow rate Q(t) is inde-
pendent of s, we see that v is given by
v(s, t) = Q(t)
A(s).
(12.50)
Substituting Eq. (12.50) into Eq. (12.49), we have
ρ
 ˙Q(t)
A(s) + Q2(t)
A(s)
∂1/A(s)
∂s

= −∂p
∂s −ρg dz
ds,
(12.51)
which may be integrated in s from s = 0 to s = l:
I ˙Q + ρQ2
2

1
A2
l
−1
A2
0

= p0(t) −pl(t) −ρg(zl −z0),
(12.52)

570
THERMOFLUID SYSTEMS
FIGURE 12.9. Constrained motion of an incompressible ﬂuid: (a) sketch of system;
(b) bond graph.
where
I = ρ
 l
o
ds
A(s),
(12.53)
and one could substitute βQ2/A2 for the Q2/A2 terms as discussed previously.
It is interesting to note that Bernoulli’s equation (essentially Eq. (12.52)) can
be represented exactly by the lumped elements shown in Figure 12.9b.
The linear inertia coefﬁcient deﬁned in Eq. (12.53) reduces to that found by
the nonrigorous method of Eq. (12.47) if A(s) is constant, but several other terms
appear in Eq. (12.52) that did not appear in Eq. (12.47). The pressure due to
gravity that is represented by a constant-pressure source in Figure 12.9b is easily
understood, but the term, involving Q2 requires explanation.

FLUID DYNAMIC SYSTEMS REVISITED
571
First of all, if A(s) is constant, then A1 = A0 and the Q2 term vanishes,
thus showing that Eq. (12.47) is essentially correct for the constant-area case.
However, in deriving Eq. (12.47), the momentum ﬂow of ﬂuid through the ends
of the pipe section was not properly considered. To use Newton’s law in its
simplest form, one must follow the ﬂow of the ﬂuid; that is, one must use a
Lagrangian description. However, if one really wants to treat the pipe as a control
volume through which ﬂuid passes, then an Eulerian description is required. The
Q2 term in Eq. (12.52) may be thought of as a dynamic pressure-correction term,
which was fortuitously absent from the constant area case of Eq. (12.47).
Another way to interpret the result of Eq. (12.52) is to note that the power
ﬂow p(t)Q(t) does not represent the total ﬂow of energy past a stationary point
of the pipe. Terms of the form ρQ2/2A2 represent dynamic pressure associated
with the kinetic energy of the ﬂuid. In the system under study, p and Q contain
all the information required to ﬁnd the dynamic pressure, since the velocity is
Q/A because of the incompressibility assumtion.
The Q2 term in Eq. (12.52) may be represented as a sort of Bernoulli
resistance, RB, in Figure 12.9b, since it is a relation between Q and a pressure
(the dynamic pressure). When the resistance characteristic is plotted as in
Figure 12.10, it is clear that if one keeps track only of the pQ power, then the
dynamic pressure may be converted back and forth into static pressures as in
nozzles and diffusers.
The resistance used to represent the Q2 terms in Bernoulli’s equation is
unusual in two ways. First, no matter whether A0 > A1 or A0 < A1, there are
regimes of operation in which the resistance appears to supply power rather than
dissipate power. Physically, this means that dynamic pressure is being converted
FIGURE 12.10. Constitutive law for the dynamic pressure resistor.

572
THERMOFLUID SYSTEMS
to equivalent static pressure and hence to an apparent power ﬂow in the form
pQ. Second, although the pressure in the resistance is uniquely determined for
any given ﬂow, given the pressure, then there is either no corresponding ﬂow
or two of them. Thus, there is a very strong preference for the causality of the
resistance shown in Figure 12.9b.
One should also remember that the basis for our derivation was the assumption
that the ﬂuid ﬁlled the pipe, and hence v = Q/A. For some conditions this may
not be true—a jet may form in the pipe. Also, the equations derived may be valid
only for one direction of ﬂow. In studying the ﬂow of water through a nozzle
into the atmosphere, for example, it may make no sense to consider reverse
ﬂow, because the nozzle would ﬁll with air and the equations would no longer
be meaningful. Sufﬁce it to say that in any application of Bernoulli’s equation
including the bond graph representation shown in Figure 12.9, one must use care
to avoid nonsensical results. Such difﬁculties with resistance relations are rare in
other types of physical systems.
As an illustration of the utility of the bond graph representation, consider
the classical elementary problem of estimating the time required for a tank to
empty through a pipe. The system is shown in Figure 12.11. For simplicity, no
friction losses will be considered, but the Bernoulli resistor may be thought of
as indicating the loss in kinetic energy of the ﬂuid that leaves the system. The
tank has a capacitance of AT /ρg, where AT , the tank area, is large compared to
the pipe area. As in the classical analysis, we imagine the ﬂuid entering the end
FIGURE 12.11. Tank-emptying problem: (a) sketch of system; (b) bond graph.

FLUID DYNAMIC SYSTEMS REVISITED
573
of the pipe from a large area, A1, at pressure p1 and essentially zero velocity.
The Bernoulli resistor then gives a pressure ρQ/2A2
2, where Q is related to
the pressure momentum by a relation of the form of Eq. (12.47). Using the
notation shown in Figure 12.11 and noting from the bond graph that two state
variables—V (t), the volume, and pp(t), the pressure momentum—are required,
we ﬁnd
˙V = −A2
ρLpp,
(12.54)
˙pp = −ρ
2A2
2
 A2
ρLpp
2
+ ρgV
AT
,
(12.55)
or, combining Eqs. (12.54) and (12.55),
−ρL
A2
¨V = −ρ( ˙V )2
2A2
2
+ ρg
AT
V
(12.56)
as long as V ≥0. Note that, although no static pressure power ﬂows into the
zero-pressure source representing the atmosphere, there is a ﬂow, and with a
diffuser one could recover power from this ﬂow.
Control volume problems can become quite complex if the control volume
itself is not ﬁxed in inertial space. Bond graph methods can clarify the modeling
of such systems, but space limitations prohibit a full discussion here. An example
of such a system appears in Reference [6]. We now go on to discuss the impli-
cations of dropping the incompressibility assumption, and we ﬁnd that further
difﬁculties await us and that more approximations are involved in the hydraulic
system bond graphs used previously than at ﬁrst might have been imagined.
12.4.2
Representation of Compressibility Effects in True Bond Graphs
For small changes in density, it is easy to see that compressibility effects are
readily modeled by means of linear capacitors, as discussed previously. For large
changes in density, however, it is best to begin with a study of the thermody-
namics of a pure substance. In this section, we see how the attempt to maintain
a true bond graph representation in the case of compressible ﬂuids leads to fur-
ther complications. This is one motivation for consideration of another form of
pseudo-bond graph in Section 12.5. As we have seen in Section 12.2, the inter-
nal energy per unit mass of ﬂuid, u, depends on two independent properties: the
density ρ (or its reciprocal, speciﬁc volume, v) and the entropy s. Here we use
1/ρ instead of v to highlight the role of variable density and to avoid confusion
with the use of v for velocity in the previous section. Changes in these quantities
are related by the Gibbs equation:
du = T ds −pd
 1
ρ

,
(12.5) Repeated

574
THERMOFLUID SYSTEMS
where T is the thermodynamic temperature, p is the pressure, 1/ρ is the speciﬁc
volume, and
u = u

s, 1
ρ

.
(12.4) Repeated
The characteristics of the ﬂuid are conveniently summed up by Eq. (12.4). The
Gibbs equation for a unit mass or a ﬁxed amount of matter can be represented
by a C-ﬁeld, as we have seen previously.
Using the C-ﬁeld representation, it is straightforward to model systems in
which ﬁxed amounts of a ﬂuid are compressed and expanded and heated. When
the ﬂuid passes into and out of a control volume, however, the situation is
somewhat more complex. In Figure 12.12, for example, ﬂuid is compressed in
a ﬁxed volume by allowing ﬂuid to pass slowly in and out of a port. In this
case, the total energy contained in the volume V0, denoted by U , depends on
the mass m contained in the volume and the internal energy per unit mass, u.
Changes in U occur not only because of the ﬂow work pQ but also because of
the convection of energy. If one uses the mass ﬂow rate ˙m = ρQ instead of Q
FIGURE 12.12. Isentropic compression of a ﬂuid: (a) ﬂuid ﬂow into a rigid volume;
(b) bond graph; (c) block diagram.

FLUID DYNAMIC SYSTEMS REVISITED
575
as a ﬂow variable, then
dU = u dm + p
ρ dm
(12.57)
in the isentropic case. Deﬁning the enthalpy h by the relation
h = u + p
ρ ,
(12.58)
it now appears that the power ﬂow past the port is given by
h ˙m = u ˙m + p
ρ ˙m = uρQ + p
ρ ρQ = (ρu + p)Q,
(12.59)
which shows that pQ is only the hydrostatic power. In this true bond graph
model, if the volume ﬂow rate Q is the ﬂow variable, then the corresponding
effort is not just the pressure but ρu + p = ρh, the density times the enthalpy. As
in the previous section, in which it was found necessary to supplement the static
pressure with a dynamic pressure term to account properly for real power ﬂow,
so here it is necessary to supplement p with an extra term, ρu, to account for con-
vected internal energy. Figure 12.12b shows a bond graph based on Eqs. (12.58)
and (12.59), and a block diagram corresponding to integral causality is given in
Figure 12.12c. Note that the dynamic pressure term has not been incorporated, so
this model is valid only for low ﬂow rates (as indeed is the C-ﬁeld representation
for the Gibbs equation).
Also, note that the pressure and internal energy depend on density alone in the
isentropic case, so the enthalpy also is determined by conditions inside the vessel.
In more complicated cases, the enthalpy at the port is determined by conditions
inside the vessel for outﬂow, ˙m < 0, but is determined by external conditions for
inﬂow, ˙m > 0. This kind of causal switching with changes in direction of ﬂow
is not readily apparent in the true bond graph we have just created but will be
explicitly considered in the pseudo-bond graphs developed in Section 12.5.
Figure 12.13 shows how the bond graph is modiﬁed when isentropic com-
pression occurs partly due to variable volume and partly due to inﬂow and
outﬂow, as in the power cylinder of a pneumatic servomechanism. The C-ﬁeld
in Figure 12.11b has one h ˙m port and one p ˙V port. The implication is that the
total energy U depends on m and V with
h = ∂U
∂m,
−p = ∂U
∂V .
(12.60)
The bond graph of Figure 12.13 and the equations it represents are a sophis-
ticated version of models of compressibility effects in ﬂuid servomechanisms in
which the volume of ﬂuid concerned is variable. In practice, linearized com-
pressibility parameters are commonly incorporated into the system equations to
account for compressibility effects. But, as is often the case, it is virtually impos-
sible to proceed from a linearized model of an effect to a more accurate nonlinear
model without starting again from the basic physics of the situation.

576
THERMOFLUID SYSTEMS
FIGURE 12.13. Compression in a ram: (a) sketch of system; (b) bond graph; (c) block
diagram.
12.4.3
Inertial and Compressibility Effects in One-Dimensional Flow
The simple model of Figure 12.8, neglecting for the moment the loss elements,
is a lumped approximation of the inertial effects and compressibility effects in a
length of line. When a large number of such models with parameters appropri-
ate to a length 	l are cascaded and when 	l →0, the state equations for the
model form an approximation to the partial differential equation called the one-
dimensional wave equation. In the sections above, models for the inertia effect
in incompressible ﬂow and the compliance effect when no inertia is considered
were developed. The question now arises whether one can simply cascade a
series of lumps that alternately account for inertia and compressibility effects in
the manner of Figure 12.8 and thereby construct a model of a distributed line.
The answer is in the afﬁrmative in several important cases, namely:
1. The acoustic approximation. In this case, small deviations in pressure and
density are modeled with linear equations. The inertial and compliance
coefﬁcients are calculated at the mean pressure and density. See Refer-
ence [5]. Such a model is useful in studying compressibility effects in oil
hydraulics and water-hammer problems, as well as in acoustics.

FLUID DYNAMIC SYSTEMS REVISITED
577
2. Lagrangian descriptions. When one is willing to follow the motion of a
group of particles, then the inertia of the group is constant. As long as
Newtonian mechanics is used, the system of equations can be nonlinear
only due to nonlinear elastic or dissipative effects. For the vibration of
bars and strings, for example, a Lagrangian description is natural, since
the particles never move very far anyway. This was the type of system
discussed in Chapter 10. For beams and plates, the differential equations
are more complex than the wave equation, but the Lagrangian description
still allows one to use ﬁnite models with I ’s and C’s representing inertia
and compliance effects. The junction structure is more complex than the
simple 0–1–0–1 string of Figure 12.8, however. For ﬂuid systems in which
the particles move through ﬁxed boundaries, the Lagrangian descriptions
are used rather rarely.
For the cases above one may easily construct ﬁnite-element models from nor-
mal bond graph components that, when reduced to differential volumes, mirror
the usual derivations of the partial differential equations of motion for the con-
tinuum model. Essentially, the inertial, compliance, and resistance aspects of the
system may be treated separately in the ﬁnite elements, even though these aspects
refer to a single point when the volume of the element is made to approach
zero in the continuum description. The Eulerian description common to ﬂuid
mechanics entangles the inertial and compliance aspects so thoroughly that it
is difﬁcult to construct a series of ﬁnite elements converging to the continuum
description without using a large number of active bonds, except in the acoustic
approximation.
Consider the isentropic, one-dimensional ﬂow of ﬂuid through a tube of unit
cross-sectional area. Using s for the space coordinate, v(s, t) for velocity, ρ(s, t)
for density, and p(s, t) for pressure, the equations describing the system are
ρ ∂v
∂t + ρv∂v
∂s = −∂p
∂s ,
(12.61)
∂ρ
∂t + ∂ρv
∂s = 0,
(12.62)
p = p(ρ).
(12.63)
Equation (12.61) is just Newton’s law for a length of ﬂuid with the acceleration
expressed in Eulerian form. Equation (12.62) is a statement of conservation of
mass that, with the constitutive law (12.63) for the gas, can be used to deﬁne
the compressibility effect. The density, ρ(s, t), enters both the inertia law and
the compressibility laws. In contrast, a Lagrangian description would express the
inertia in terms of a constant mass of ﬂuid in a reference state.
It is probably not sensible to attempt to construct a bond graph for Eqs.
(12.61)–(12.63) unless ρ in Eq. (12.61) is nearly constant (in Eqs. (12.62) and
(12.63) ρ must be allowed to vary) and v ∂v/∂s is a second-order small quan-
tity. Basically, Eq. (12.61) is Newton’s law following the ﬂow inﬁnitesimally.

578
THERMOFLUID SYSTEMS
At each succeeding instant of time, the law refers to different inﬁnitesimal slices
of ﬂuid. Thus, the time-varying inertial effect will not conserve energy as normal
bond graph inertial elements do. Also, the ∂v/∂s term implies that the velocity
is different at the two ends of the differential control volume. Thus, the inertial
effect and the compressional effect both appear in Eq. (12.61). Finally, the factors
appearing in these equations (pressure and velocity for volume ﬂow, since we
are considering unit area) do not multiply to give the true power ﬂow at position
s and time t. As we have seen, the convected internal energy has been left out of
the equations. One should not, therefore, expect that these (correct) equations can
be represented by a bond graph in which power conservation and energy conser-
vation are built in. It seems that the alternatives, if one wishes to represent ﬂuid
dynamic lines in terms of bond graphs, are to (1) use a Lagrangian description;
(2) use an Eulerian description, but with a restriction essentially to the acoustic
approximation; and (3) consider only the incompressible or noninertial cases, as
was done in Sections 12.4.1 and 12.4.2. Thus, the intuitively appealing scheme
of Figure 12.8 appears to be more restrictive than one might think, even with-
out consideration of shear stresses, boundary layers, and so forth, which also
complicate the modeling of ﬂuid transmission lines.
In the next section a more practical approach to a number of thermoﬂuid
situations of engineering importance is developed using a pseudo-bond graph
approach that uses efforts and ﬂow variables commonly used in thermodynam-
ics and ﬂuid dynamics but without requiring the effort ﬂow product to always
represent power on a bond.
12.5
PSEUDO-BOND GRAPHS FOR COMPRESSIBLE GAS DYNAMICS
It has previously been seen that constructing bond graph models for ﬂuid dynamic
systems is straightforward when the Lagrangian approach of tracking a ﬁxed
packet of particles is used. However, the Lagrangian description is often not par-
ticularly convenient for computational purposes, and it is common to describe
ﬂuid systems with respect to an Eulerian control volume, in which observations
are made at a ﬁxed point in space as different ﬂuid particles pass by. Unfortu-
nately, some convective terms appear in the energy and momentum equations
due to the ﬁxed reference in the Eulerian approach, and the convective terms do
not conveniently lend themselves to a true bond graph representation in terms of
power variables.
A major emphasis of this book is the construction of low-order, accurate,
understandable models of all types of interacting physical engineering systems.
Thermodynamic and nonlinear gas dynamic system parts are another type of
interaction we would like to include in our uniﬁed approach. After all, the gas
dynamics is only part of the physics of an internal combustion engine, a Wankel
compressor, a helical rotor expander, or an air cushion vehicle. There are many
other dynamic elements that must interact with the gas dynamics to produce an
overall system model.

PSEUDO-BOND GRAPHS FOR COMPRESSIBLE GAS DYNAMICS
579
This section develops a pseudo-bond graph representation for gas dynamics.
The pseudo-bond graph elements rely on causality in the usual way and connect
to other pseudo-bond graph fragments just as true bond graph elements do. Most
of the virtues of bond graph modeling are preserved, including the a priori iden-
tiﬁcation of state variables, the ease of deriving state equations, and setting up of
a computational model. Pseudo-bond graph elements do not, however, conserve
power and energy in the same way as some of the elements of true bond graphs
do. Because of this, care must be used when connecting a pseudo-bond graph
to a true bond graph to arrive at a complete system model. This turns out to
be a small price to pay in exchange for the enormous modeling ﬂexibility the
pseudo-bond graph technique affords.
12.5.1
The Thermodynamic Accumulator—A Pseudo-Bond
Graph Element
In this section, we deﬁne a pseudo-bond graph accumulator, which is similar
to a true bond graph multiport capacitor or C-ﬁeld. It is called an accumulator
to emphasize the fact that its constitutive laws do not have all the properties
connected with energy conservation that C-ﬁelds studied in Chapter 7 were found
to have. It turns out that the variables chosen for efforts and ﬂows for this
pseudo-bond graph multiport are familiar variables commonly used in describing
thermoﬂuid systems. These variables allow a simpler description of compressible
ﬂuids using a pseudo-bond graph than the true bond graph equivalent.
Consider the control volume in Figure 12.14 with the internal gas at instan-
taneous pressure p, absolute temperature T, density ρ, and volume V , and
containing mass m and energy E. (Note that in the theoretical parts of this
section, we will use lower case p to represent pressure to be consistent with
previous sections but in several ﬁgures, pressure is designated with uppercase
P’s. The bond graphs used for simulation would avoid this notation difﬁculty by
representing all pressures as efforts, e’s with bond numbers.)
The control volume can transport mass through the in port and the out port, but
the inﬂow and outﬂow as functions of time can actually be positive or negative at
either port. Finally, we can express work done by the gas in the control volume
by the volume expansion indicated in the ﬁgure. Notice that we assume that a
single pressure and temperature characterize the entire control volume. The mass,
energy, and (variable) volume can be used to ﬁnd variables such as density or
speciﬁc volume and internal energy.
The one-dimensional energy, mass, and momentum equations can be written
in the following forms (the subscripts i and o refer to the in and out ports,
respectively):
d
dtE =

hi + v2
i
2

˙mi −

h0 + v2
o
2

˙mo −pdV
dt
(energy),
(12.64)

580
THERMOFLUID SYSTEMS
FIGURE 12.14. Control volume for gas dynamics.
d
dtm = ˙mi −˙mo
(mass),
(12.65)
d
dt(mv) = vi ˙mi −vo ˙mo + piAi −poAo
+ 1
2(pi + po)(Ao −Ai) + R
(momentum),
(12.66)
where R is the resultant external force acting on the control volume.
The internal energy contained in the control volume E is
E = mcvT,
(12.67)
and the enthalpy, h, is given by
hi = cpTi,
ho = cpTo.
(12.68)
See Eqs. (12.27) and (12.28) for deﬁnitions of the speciﬁc heats.
We assume that the gas obeys the gas law for mass m, see Eq. (12.22),
pV = mRT.
(12.69)

PSEUDO-BOND GRAPHS FOR COMPRESSIBLE GAS DYNAMICS
581
For example, for air, the gas parameters are
R ≡gas constant
= 287 N-m/kg-K,
cp ≡speciﬁc heat at constant pressure
= 1005 N-m/kg-K,
cv ≡speciﬁc heat at constant volume
= 718 N-m/kg-K.
(12.70)
Also (from Eq. (12.29),
R = cp −cv,
(12.71)
and the speciﬁc heat ratio γ is
γ = cp
cv
= 1.4.
(12.72)
For now, we will not consider momentum variation within the control volume,
and we will neglect the convected kinetic energy in the energy equation. This
kinetic energy is typically small compared to the convected enthalpy, as becomes
apparent if we consider that at room temperature of 20◦C, or 293 K, the enthalpy
is h = cp (293 K) = 2.94 × 105 N-m/kg, while for a gas velocity of 100 m/sec,
the unit mass kinetic energy contribution is only v2/2 = 5 × 103 N-m/kg.
We will work with the equations
d
dtE = hi ˙mi −ho ˙mo −pdV
dt ,
(12.73)
d
dtm = ˙mi −˙mo,
(12.74)
d
dtV = ˙V ,
(12.75)
E = mcvT,
(12.76)
pV = mRT.
(12.77)
Equations (12.73), (12.74), and (12.75) look like ﬁrst-order state equations,
and they motivate the construction of the bond graph of Figure 12.15. The 3-port
C-ﬁeld in this ﬁgure has one true bond and two pseudo-bonds. The true bond
has pressure p as its effort variable and volume rate ˙V as its ﬂow variable. The
effort–ﬂow product, p ˙V , represents power on this true bond. These variables
have been used previously for lumped modeling of incompressible ﬂuid systems
and appeared on the true bond graph C-ﬁeld of Section 12.2.

582
THERMOFLUID SYSTEMS
FIGURE 12.15. Bond graph of the thermodynamic accumulator.
One of the pseudo-bonds has energy ﬂow ˙E as the ﬂow variable and tem-
perature T as the effort. This effort ﬂow variable pair is similar to that used
in heat transfer pseudo-bond graphs in Section 12.1. You will note that the T ˙E
pseudo-bond has been shown as a dashed line. This has no particular signiﬁ-
cance except to distinguish it from the p ˙m pseudo-bond to make understanding
the graph somewhat easier.
The other pseudo-bond again uses pressure p as the effort just as the true
bond does, but mass ﬂow ˙m as the ﬂow in place of volume ﬂow rate as in true
bond graphs. (Note that ˙m appeared in some of the true bond graphs in Section
12.3.2 but it was paired with enthalpy as an effort rather than pressure.) For both
pseudo-bonds, the product of their effort and ﬂow variables is not power. In fact,
˙E is already power on the dashed upper pseudo-bond.
Even though the accumulator is not a true bond graph C-element, nevertheless,
the operations associated with the effort and ﬂow variables are the same as for
a true C-ﬁeld. As the causality indicates in Figure 12.15, the accumulator is in
all integral causality and accepts ﬂow inputs on all three bonds ( ˙E, ˙m, and ˙V ).
It then integrates these ﬂows to produce the state variables E, m, and V . And,
ﬁnally, the accumulator operates on these state variables through appropriate
constitutive laws to produce the outputs p and T. The constitutive relations come
from Eqs. (12.76) and (12.77) and are
T = 1
cv
E
m
(12.78)
and
p = mRT
V
= mR
V
1
cv
E
m = R
cv
E
V

.
(12.79)
Thus, if ˙E, ˙m, and ˙V are inputs to the accumulator, then it will output T and
p using the constitutive laws (12.78) and (12.79). Thus, the accumulator pseudo-
bond graph element makes compressible gas dynamics (subject to the operational

PSEUDO-BOND GRAPHS FOR COMPRESSIBLE GAS DYNAMICS
583
assumptions that got us to this point) ﬁt into our general uniﬁed approach for
modeling systems.
An unusual feature is the ﬂow source, SF, associated with the T ˙E bond. It
is necessary to properly account for the work done by the ﬂuid in our control
volume as the volume changes. The work removes some energy from the ﬂuid in
the control volume according to Eq. 12.73. The power removed from the ﬂuid is
˙E = p ˙V , which accounts for the half-arrow sign convention shown. When the
volume increases, energy is removed from the gas.
The remaining external bonds associated with the T, ˙E bond tell the accu-
mulator the power ﬂows that are associated with the product of enthalpy and
mass ﬂow rate ˙Ehi = hi ˙mi, from whatever systems are attached to the accumu-
lator. The 0-junction shows that all the attached systems are subjected to the
temperature of the control volume as determined by the accumulator.
Similarly, the p ˙m pseudo-bond has external bonds that causally prescribe
the mass ﬂows from the attached systems. Another 0-junction indicates that the
control volume pressure is an input to each of the attached systems.
As a next step, we need to describe the origin of the transported energy ﬂows
(enthalpy ﬂows)
˙Eh =

i
˙Ehi =

i
hi ˙mi =

i
cpTi ˙mi
(12.80)
and the mass ﬂows ˙mi, where
˙m =

i
˙mi,
(12.81)
but ﬁrst we demonstrate the use of the thermodynamic accumulator for a simple
case in which the mass ﬂows are zero so that Eqs. (12.80 and 12.81) are not
necesary.
Figure 12.16 shows a cylinder with a trapped mass of air under a moving
piston with prescribed motion, vi(t). Without making any assumptions about the
thermodynamic process, we now show that a model using the thermodynamic
accumulator predicts a reversible adiabatic or isentropic process. The bond graph
for this simple closed system is also shown in Figure 12.16.
The state equations are
˙E = −p ˙V ,
˙V = Apvi
(prescribed),
˙m = 0
(closed system).
(12.82)
From the constitutive law of Eq. (12.76) we can write
˙E = −R
cv
E
˙V
V .
(12.83)

584
THERMOFLUID SYSTEMS
FIGURE 12.16. Nonlinear air spring and its bond graph model.
If we were pursuing a numerical solution, we would numerically integrate this
equation along with the equation for ˙V and then output pressure and temperature
from (12.78) and (12.79). Instead, we recognize that (12.83) has an analytical
solution,
EVR/cv = const.
(12.84)
If we reintroduce the pressure from Eq. (12.79), then
cv
R pV(R/cv+1) = const,
(12.85)
or
pVγ = const,
(12.86)
using Eqs. (12.71 and 12.72)
γ = cp
cv
= R
cv
+ 1.
(12.87)
The reader should recognize that (12.86) is the p, V relationship for an isen-
tropic process.
12.5.2
The Thermodynamic Restrictor—A Pseudo-Bond Graph Element
The next pseudo-bond graph element necessary to model compressible gas
dynamics is the restrictor, which resembles the multiport resistors or R-ﬁelds
studied in Chapter 7. Again, the special name restrictor for this element is
chosen to indicate that the effort and ﬂow variables chosen for the pseudo-bond
graph do not allow all the power dissipation interpretations that were possible
for true bond graph elements. To show the type of constitutive laws deﬁning a
restrictor and to illustrate the utility of considering the use of effort and ﬂow

PSEUDO-BOND GRAPHS FOR COMPRESSIBLE GAS DYNAMICS
585
FIGURE 12.17. Isentropic nozzle.
variables that are not true bond graph variables, we discuss a very useful model
pertaining to ﬂows in gas dynamics—the isentropic nozzle.
Consider the energy ﬂows ˙Ehi and mass ﬂows ˙mi required as inputs to the
thermodynamic accumulator. Figure 12.17 shows a nozzle with upstream pressure
and temperaturepu, Tu; downstream pressure and temperaturepd, Td; exit area A;
and mass ﬂow ˙m. If we assume that isentropic ﬂow exists, then it turns out that
˙m depends on the pressure ratio
pr ≡pd
pu
(12.88)
rather than just the pressure drop pu −pd across the nozzle. A standard derivation
(see Reference [7] for example) shows that ˙m is given by the expression
˙m = A pu
√Tu

2γ
R(γ −1)

p2/γ
r
−p(γ +1)/γ
r
,
(12.89)
as long as the pressure ratio pr is larger than the critical pressure ratio as
deﬁned by
pr crit ≡

2
γ + 1
γ/(γ −1)
.
(12.90)
When the pressure ratio is less than the critical ratio, the ﬂow is “choked,”
and ˙m remains constant, even if the downstream pressure, pd, is reduced.
The transported energy ˙Eh associated with this mass ﬂow ˙m is
˙Eh = cpTu ˙m.
(12.91)
We will consider the mass ﬂows and energy transport ﬂows into and out of
the control volumes represented by the thermodynamic accumulator as isentropic
nozzle ﬂows given by Eqs. (12.89) and (12.91). Which end of the nozzle is
considered the upstream side of the nozzle as well as the sign of ˙m are dictated
by the sign of the pressure drop 	p across the nozzle. If 	p changes sign at

586
THERMOFLUID SYSTEMS
FIGURE 12.18. Bond graph for the isentropic nozzle.
some time, then the sign of ˙m will change, as will our identiﬁcation of the nozzle
ends considered upsteam and downstream in the formulas.
Consider the 4-port R-element now called a pseudo-bond graph restrictor of
Figure 12.18. As before the T ˙E bonds are shown dashed to distinguish them
from the p ˙m bonds. Note that all bonds have effort in causality. This causality
is the one most useful for the restrictor. A parallel causal restriction was found
for the true bond graph of heat transfer studied in Section 12.3 and represented
in Eq. (12.38).
Although these are all pseudo-bonds, the 4-port restrictor is functionally equiv-
alent to an R-ﬁeld in true bond graphs. This R-element operates on the input
efforts pa, pb, Ta, Tb and delivers the output ﬂows ˙ma, ˙mb, ˙Eha, ˙Ehb. This can
be expressed functionally as
˙ma = ˙ma(pa, pb, Ta, Tb),
˙mb = ˙mb(pa, pb, Ta, Tb),
˙Eha = ˙Eha(pa, pb, Ta, Tb),
˙Ehb = ˙Ehb(pa, pb, Ta, Tb).
(12.92)
We now deﬁne the computational procedures that allow the restrictor of
Figure 12.18 to represent the isentropic nozzle. First, the designation of upstream
and downstream depends on the pressures at the two ends of the restrictor.
if
pa > pb,
then
pu = pa,
Tu = Ta,
pd = pb;
if
pa < pb,
then
pu = pb,
Tu = Tb,
pd = pa;
(12.93)
and
pr = pd/pu.
(12.94)
Furthermore,
if
pr > pr crit,
then
pr = pd/pu;
if
pr ≤pr crit,
then
pr = pr crit.
(12.95)

PSEUDO-BOND GRAPHS FOR COMPRESSIBLE GAS DYNAMICS
587
Now calculate
˙m = A pu
√Tu

2γ
R(γ −1)

p2/γ
r
−p(γ +1)/γ
r
,
(12.96)
and obtain outputs
if
pa > pb,
then
˙ma = ˙mb = ˙m,
if
pa < pb,
then
˙ma = ˙mb = −˙m,
(12.97)
in either case,
˙Eha = ˙Ehb = cpTu ˙ma.
(12.98)
The relationships (12.93)–(12.98) fully represent the input–output behavior
of the isentropic nozzle. And as long as we maintain the causality for which
these relationships were derived, we can construct this computational procedure
once and for all, to be used over and over when needed in a system model.
12.5.3
Constructing Models with Accumulators
and Restrictors
In this section we show how pseudo-bond graph accumulators and restrictors can
be connected together and to true to true bond graph models to create models for
complex systems in which thermoﬂuid elements play a role in the overall system
dynamics.
Figure 12.19 shows a cylinder with gas trapped above and below the piston.
If no leakage exists between top and bottom chambers, then the model is simply
two independent accumulators identical to the one in Figure 12.16. When leakage
past the piston is included, the model is shown in Figure 12.19. Notice how
the 4-port restrictor interacts with the pseudo-bonds of the accumulators. The
accumulator outputs, P1, T1, P2, T2 are the inputs to the restrictor, which, through
the computational procedure (12.93)–(12.98), outputs the mass and transported
energy ﬂows for use as inputs to the accumulators. On the true bond side of
the accumulators, all is normal, in that the pressure outputs are converted by
transformers into forces on the piston, and the piston inertia, in turn, outputs
the velocity ˙x, which then is converted by the same transformers into volume
velocities for the two chambers.
Figure 12.19 demonstrates a very elegant coupling of mechanical and thermo-
dynamic energy domains. Since the accumulators are in integral causality, setting
up state equations for computational solution is straightforward.
Pseudo-bond graphs have been used to model many types of systems, such as
internal combustion engines. A model of a multicylinder engine can be mechani-
cally complex and can have a number of control volumes, some with ﬁxed volumes

588
THERMOFLUID SYSTEMS
FIGURE 12.19. Two-sided air cylinder with leakage.
and some with variable volumes. The result is often a model with hundreds of state
equations. On the other hand, a bond graph model can be constructed of standard
true and pseudo-bond graph elements that are repeated many times. Using the bond
graph, one can easily keep track of which variables are which in a simulation, and
a bond graph processor can help set up the element equations in the correct causal
form. Instead of using just equations, this process can be characterized as graph-
and computer-aided modeling.
As a relatively simple example, Figure 12.20 shows a two-stroke, piston-ported
internal combustion engine and its bond graph model. This model has been used
to aid in the understanding of the interacting dynamics of two-stroke engines,
and it is shown here as example of using the 3-port accumulators and 4-port
restrictors to construct rather complex thermodynamic models. Readers should
see Reference [8] for more details of this model.
The two-stroke engine relies heavily on ﬂuid dynamics for its operation. As
the piston is driven downward from the pressure due to combustion of an air–fuel
charge, it ﬁrst opens the exhaust port as the piston moves past the exhaust open-
ing. As exhaust gases escape into the exhaust system (not shown), the piston
uncovers the transfer port, and the compressed air–fuel in the crankcase moves
through the transfer passage to supply the head with the next charge for combus-
tion. As the piston moves upward after passing through bottom dead center, the
intake port is opened, and fresh air–fuel enters the expanding crankcase, ready
for the next crankcase compression. The air–fuel in the head is compressed and
ignited, initiating another cycle.

PSEUDO-BOND GRAPHS FOR COMPRESSIBLE GAS DYNAMICS
589
FIGURE 12.20. Bond graph for a two-stroke, piston-ported engine.
The inertia of the ﬂuid in the intake and transfer passages, as well as the
dynamics of the exhaust system, is essential to the high-performance operation
of the engine. Once ﬂuid is moving in the intake and transfer passages, its
momentum continues to charge the crankcase and cylinder head against adverse
pressure gradients even as the piston is closing the ports. It is this dynamic

590
THERMOFLUID SYSTEMS
behavior that makes the engine so interesting and dynamic modeling so essential
for design purposes.
The inertia effects of the transfer and intake are handled in a functional manner,
and the transported momentum from Eq. (12.66) is neglected. One can, in fact,
construct a pseudo-bond graph for the momentum equation, but this is beyond
the scope of the present discussion. For the model shown here, it is assumed
that the ﬂuid inertia of the intake and transfer passages behaves like a trapped
mass of ﬂuid in the passages. The density of the ﬂuid is set by the accumulators
at the ends of the passage, depending on the instantaneous ﬂow direction. This
has been shown experimentally to work well. The complete momentum equation
must be used for the exhaust system.
Notice that integral causality exists throughout Figure 12.20; thus state-
variable selection, equation formulation, and computer coding will be straight-
forward.
As a ﬁnal example, consider Figure 12.21, which shows a Wankel compressor
and its bond graph. For someone who has not studied the ideas of the accumu-
lator and the restrictor, this may be a frighteningly complex ﬁgure. However,
each element of the ﬁgure is itself relatively simple and it is just a matter of
identifying control volume and ﬂow path to understand the model in detail. The
reader is urged to study this model and appreciate the elegance and utility of the
representation.
12.5.4
Summary
In order to include compressible gas dynamic elements in an overall system
model in a computationally convenient form, it was necessary to introduce the
thermodynamic accumulator and associated pseudo-bonds. The 3-port accumula-
tor possesses almost all of the characteristics of a true representation, and through
causal considerations, the accumulator is a great aid in putting models together.
It is true that the true bond on the mechanical port requires an active bond
and source to complete the energy balance in Eq. (12.73) as shown in Fig. 12.15.
This seems a small price to pay for the ability to use of variables commonly used
in thermoﬂuid system analysis even though they are not classical power effort
and ﬂow variables of true bond graphs. The mechanical port on the accumulator
provides the connection between the pseudo-bond graph and true bond graphs of
any other mechatronic systems that form a model of a complete system.
The isentropic nozzle and its 4-port restrictor representation are required to
interact with the accumulator to account for transported energy. As long as the
causality presented in this section is not violated, then including even complex,
nonlinear thermodynamics and gas dynamics in overall system models follows
the same process as constructing any bond graph model for interactive com-
ponents crossing many energy domains. In essence, the pseudo-bond graphs
for thermoﬂuid systems sacriﬁce some of the elegance of true bond graphs for
practicality.

PSEUDO-BOND GRAPHS FOR COMPRESSIBLE GAS DYNAMICS
591
FIGURE 12.21. Wankel compressor and its bond graph.

592
THERMOFLUID SYSTEMS
REFERENCES
[1] R. H. Cannon, Dynamics of Physical Systems, New York: McGraw-Hill,
1967.
[2] W. M. Swanson, Fluid Mechanics, New York: Holt, Rinehart & Winston,
1970.
[3] C. J. Radcliffe and D. Karnopp, “Simulation of nonlinear air cushion vehicle
dynamics using bond graph techniques,” Proceedings 1971 Summar Com-
puter Simulation Conference, Boston, MA, July 19–21, 1971.
[4] L. Tisza, Generalized Thermodynamics, Cambridge, MA: MIT Press, 1966.
[5] P. M. Morse and K. U. Ingard, Theoretical Acoustics, New York: McGraw-
Hill, 1968.
[6] D. C.
Karnopp, “Bond graph models for ﬂuid dynamics systems,” Trans.
ASME J . Dyn. Syst. Meas. Control, 94, Ser. G, No. 3, 222–229 (Sept. 1973).
[7] R. H. Sabersky, A. J. Acosta, and E. Hauptmann, Fluid Flow, New York:
Macmillan, 1971.
[8] D. L. Margolis, “Modeling of two-stroke ICE dynamics using the bond graph
technique,” SAE Trans., pp. 2263–2275 (Sept. 1975).
[9] D. L. Margolis, “Bond graph ﬂuid line models for inclusion with dynamic
systems simulation,” J . Franklin Inst., 308, No. 3, 255–268 (Sept. 1979).
PROBLEMS
12-1. A block of material with total heat capacitance C is covered with insu-
lating material with total thermal resistance R and surrounded by an
atmosphere of temperature T0. The bond graph is supposed to aid in esti-
mating how fast the block will heat up if it starts at some temperature
Ti(t0) < T0. Draw a block diagram from the bond graph.
12-2. Consider a given mass of water as a thermal capacitor. Sketch the
constitutive law for this element for a range of temperatures including
the freezing point. Indicate the effect of the latent heat of freezing
or melting.
12-3. A heat transfer coefﬁcient α for a surface is given in W/m2-◦C. If an area
A of this surface is involved in a problem, show how the effect of the

PROBLEMS
593
surface would be represented in a bond graph, and write the constitutive
law for the element in terms of A and α.
12-4. Two bodies that do not expand or contract are in thermal contact through
a thermal resistance. Make two bond graphs for the system using both
T ˙Q and T ˙S variables. Explain the different relations for the —R— and
—C elements when the two different variable sets are used. Using the T ˙S
bond graph and Figure 12.1, show that if T2 ̸= T1 initially, the entropy
of the system can only increase.
12-5. Consider the compression of a gas by means of a crank–piston arrange-
ment. Let the cylinder have a single average temperature, and deﬁne
thermal resistances between the gas temperature T and the cylinder
temperature and between the cylinder temperature and the atmospheric
temperature T0. Make a bond graph that would allow you to predict the
crank torque τ for low speeds of rotation, ω. (Note that you do not have
enough information to evaluate all the system parameters.)
12-6. The dashpot in the suspension system has a force–velocity constitutive
law that varies with the average temperature T of the dashpot, since
it contains oil that changes viscosity with temperature. Make a simple
model of the system that would predict how the dashpot heats up when
the input base velocity V (t) is given. Discuss your assumptions and how

594
THERMOFLUID SYSTEMS
you might estimate the system parameters you need for the thermal part
of your model.
12-7. Suppose a shaft is connected to a paint stirrer such that, for low enough
angular rates ω, all the power τω goes to heating up the paint. Make
a bond graph relating the mechanical power to an entropy ﬂow ˙S and
including possible heat transfer to the atmosphere. Discuss the simplify-
ing assumptions you have used.
12-8. In the acoustic approximation, the bulk modulus B is given by
B = ρ0c2,
where ρ0 is the mean mass density of the ﬂuid and c is the speed of sound.
If 	p represents a small increase in pressure over the mean pressure p0,
then
	p = ρ0c2 	ρ
ρ0
,
where 	ρ represents the change in density.
(a)
Considering a ﬁxed mass of ﬂuid that occupies volume V when the
pressure is p0, show that
	ρ
ρ
= 	V
V ,
	p = −B 	V
V ,
where –	V represents a decrease in volume.
(b)
Evaluate the inertia and capacitance parameters for the length of
pipe shown in Figure 12.8.
(c)
Using λ = c/f , where λ is wavelength, f is frequency, and c is
sound speed, relate the length l for the pipe segment to the highest
circular frequency ω of interest, so that even the shortest wavelength
will span several “lumps” if one uses Figure 12.8 to make a model
of a long pipe by cascading many segments.

PROBLEMS
595
12-9. A high-speed hydraulic ram is forced by a pressure source, and we desire
to predict how fast it can be stroked. Let the inlet pipe have length l and
area A, and consider only inﬂow Q. The ram has mass m and area A2 and
a force F(t) applied to it. To be conservative, assume that only the static
pressure in the ram acts on the piston, that is, all the dynamic pressure is
assumed to be lost. Make a bond graph for this system using a Bernoulli
resistor to model the dynamic pressure loss. Apply causality and write
equations of motion for the system.
12-10. A schematic diagram of a mufﬂer system employing two Helmholtz res-
onators and a resistive element is shown.
Assume all dimensions are less than one wavelength of the highest fre-
quency of interest. Make a bond graph for the system in which the inertias
of the necks of the resonators of effective lengths l1, l2, and areas A1, A2,
the capacitances of the volumes V1, V2, and the resistance R are all repre-
sented. Using the results of Problem 12-5, list the capacitance and inertia
parameters in terms of the density ρ0 and the sound speed c.
12-11. Part of an automatic ﬂow-metering system is shown. The main ﬂow goes
through a smooth venturi that reduces the area from Am to Av and in
which we may assume that all dynamic pressure is fully recovered. The
spring-mounted pistons deﬂect due to the pressure in the main pipe and
at the throat. Oriﬁces in the pipes connecting the piston chambers to the
main pipe restrict the ﬂows to the pistons to low values.
Construct a bond graph for this subsystem, and indicate inertia elements
and Bernoulli resistors for the two area change sections of length l. Why

596
THERMOFLUID SYSTEMS
should we expect the two pistons to deﬂect differing amounts? Would the
difference between the two deﬂections serve to measure the main ﬂow?
12-12. The ﬁgure shows an air cylinder that could be used as an actuator in a
control system. The inlet ports at the top and bottom can be exposed to
a supply at pressure Ps and temperature Ts or to exhaust at Pa and Ta.
This switching would be accomplished through some valving, which is
not shown.
Construct a bond graph model of this component that is ready for instal-
lation into a system. Assign causality so we know what causality is
acceptable from any attached system.

PROBLEMS
597
12-13. Install the actuator of problem 12.12 in the quarter-car model shown.
Using words and equations, set up the state equations so that you under-
stand how a computational model will result.
12-14. The ﬁgure shows the skirt of an air cushion vehicle. A supply at pressure
Ps and temperature Ts ﬁlls the skirt volume, so that the vehicle “ﬂoats”
on a cushion of air, while air escapes under the skirt to atmosphere. The
height of the skirt above ground is called h and is time varying as the
vehicle negotiates an uneven terrain. The ground input is the velocity
vi(t)
Construct a model of this system that, if solved, would predict the vertical
motion time history of the vehicle. Since h(t) is very small, it is all right to
consider the relative motion between base and skirt as creating a volume
change in the skirt.

598
THERMOFLUID SYSTEMS
12-15. The ﬁgure shows a schematic of a proposed variable-rate air spring capa-
ble of continuous variation. It is installed as a suspension element in the
ﬁgure. It consists of a primary air cylinder coupled to a secondary cylin-
der with a motion-driven piston. If the piston is moved forward and mass
is transferred from the front chamber to the rear chamber, then the vehi-
cle mass will be suspended on a stiffer air spring, and the ride height
will not have changed.
Construct a bond graph model of this system, including all the dynamics
suggested in the ﬁgure. Assign causality to show that formulation will be
straightforward. This model could be used to test control strategies for
an adaptive suspension.
12-16. Consider the system from Problem 12-5. Neglect thermal capacitance of
the piston walls but include leakage past the piston to the atmosphere.
Using one thermodynamic accumulator and one 4-port isentropic nozzle,
construct a bond graph model of the system. The crank radius is R, crank
length is L, piston area is Ap, leakage area is AL, and piston mass is m.
12-17. Modify the model from problem 12-16 to include the thermal capacitance
of the cylinder as well as convection from the cylinder surface to the
atmosphere. The heat transfer coefﬁcient for the cylinder inside wall is
h1, and for the outside wall it is h2. The thermal capacitance of the wall
is CW.
12-18. The system from Figure 12.19 is an interesting one. Since work is done
from the external port to drive gas through leakage area AL, the gas must
continuously get hotter to account for this input energy. If there were no
leakage, then all work would be reversible and the gas would heat and

PROBLEMS
599
cool as the piston cycled. Derive the equations for this system from the
bond graph in Figure 12.19.
12-19. In Problem 12-18, assume the cylinder walls have thermal capacitance
CW and respective heat transfer coefﬁcients h1 and h2 for the inside and
outside cylinder wall. Account for convection to the cylinder wall on
the inside and from the cylinder to the atmosphere, T0, on the outside.
Modify the bond graph and derive state equations for the system.

13
NONLINEAR SYSTEM SIMULATION
In Chapter 5, the bond graph sequential causality assignment procedure was
shown to indicate, prior to any equation formulation, the state variables for the
model, the number of needed state equations, as well as any possible equation for-
mulation problems. If the procedure resulted in causal assignments on all bonds
and all energy storage elements possessed integral causality, then equation for-
mulation would be straightforward. If causality on some bonds was not assigned
or some energy storage elements were forced into derivative causality, then alge-
braic problems exist in the formulation of explicit state equations. This was
illustrated in Chapters 4 and 5, and some simulations of simple systems were
demonstrated. Most of these systems were linear, and no intractable formulation
problems existed.
For strictly linear systems, it is not absolutely necessary to use numerical inte-
gration, stepping along in time, to predict system response. Analytical solutions
are known for sets of ﬁrst-order, linear state equations, and there are excellent
commercial, linear analysis programs that can present solutions for linear systems
in a variety of forms without resorting to numerical integration.
In this chapter we look at the problems of generating solutions to complex,
nonlinear systems where linear analysis tools fail. For almost all nonlinear mod-
els, system response can be obtained only through numerical simulation. There
are several excellent commercial equation solvers that will march out a step-by-
step response for nonlinear systems. All these programs require equations to be
in some particular form in order to use them. This chapter discusses the various
forms that equations can take as a result of modeling decisions as well as ways
to solve algebraic problems that may arise.
600
System Dynamics: Modeling, Simulation, and Control of Mechatronic Systems, Fifth Edition
Dean C. Karnopp, Donald L. Margolis and Ronald C. Rosenberg
Copyright © 2012 John Wiley & Sons, Inc.

EXPLICIT FIRST-ORDER DIFFERENTIAL EQUATIONS
601
13.1
EXPLICIT FIRST-ORDER DIFFERENTIAL EQUATIONS
A bond graph model with all integral causality and no unassigned bonds after
completion of the sequential assignment procedure (Section 5.2) yields explicit
ﬁrst-order differential equations of the general form
˙x = f(x, u, t),
(13.1)
where x is a vector of state variables, u is a vector of system inputs, and f(·) is
a vector of functions. Individual equations, as would be derived using methods
from Chapter 5, would appear as
˙x1 = f1(x1, x2, . . . , xn, u1, u2, . . . , ur, t),
˙x2 = f2(x1, x2, . . . , xn, u1, u2, . . . , ur, t),
...
˙xn = fn(x1, x2, . . . , xn, u1, u2, . . . , ur, t).
(13.2)
Equations of this form are the most straightforward to solve computationally.
The individual equations are written as difference equations, a reasonable time
step, t, is selected, and the solution is marched out one time step at a time.
There are countless algorithms available to solve explicit equations, but they all
do basically the same thing [1].
The problem for the modeler is not so much involved with solving equations
like (13.2), but much more involved with delivering the right-hand side of
Eq. (13.2) to the computer equation solver. A nonlinear system may have non-
linearities that cannot be explicitly written as analytical functions. A 1-port
resistance characterized by an effort–ﬂow relationship might be derived from ﬁrst
principles as
e = gf 3,
(13.3)
where g is some constant. Such a relationship is easily incorporated into the right-
hand side of Eqs. (13.2). However, the effects being modeled may not easily be
represented as analytical functions. For example, if one has only a table of e and
f values, perhaps generated experimentally, then one must incorporate the data
in the simulation program in a form equivalent to the functions in Eqs. (13.2).
Many physical effects cannot be realistically represented in equation form; rather,
they must be described with logic statements or subroutines. Thus, even though
Eqs. (13.2) are in principle the most convenient form for computation of time
domain solutions, there is still a lot of work to be done to properly incorporate
nonanalytical system constitutive laws in a simulation program.
Fortunately for us, there are many excellent commercial packages available
to march out solutions to explicit equations like (13.2). These software packages

602
NONLINEAR SYSTEM SIMULATION
Spring
Damper
Y
x
m
y
g
X
θ,ω =θ
r,r
νr =r
νθ = rω
FIGURE 13.1. Nonlinear system exhibiting simultaneous pendulous and spring–mass
oscillatory motions.
have built-in functions that handle many commonly encountered nonlinear rela-
tionships. They also allow tables of data to be incorporated with automatic
interpolation between data points. These packages have excellent built-in plotting
capabilities, which make the job of the user almost pleasant.
As an example of reasonably straightforward, nonlinear simulation, consider
the system in Figure 13.1. It consists of mass, m, in a gravity ﬁeld, g, attached to
an inertial frame with a spring and damper. The spring and damper both could be
nonlinear so no spring constant or damping constant is shown in the ﬁgure. The
pendulous motion is not restricted to small values of the angle, θ. Body-ﬁxed
coordinates x, y are used, and the radial and tangential velocities are indicated.
The astute reader will recognize this example as a slightly modiﬁed version of
Figure 9.8 in Chapter 9.
The bond graph for this system is shown in Figure 13.2. The modulated
gyrator (—MGY —) with the modulus mω is explained in Chapter 9 and is of
the type required when using body-ﬁxed coordinates. Causality has been assigned
to the bond graph, and the causality completed with three elements in integral
causality. The state variables are the r-direction momentum, pr, the θ-direction
momentum, pθ, and the spring displacement, q. Thus, three state equations are
needed to characterize the motion of this system. Note that the spring force, Fs,
and damper force, Fd, have been indicated in the bond graph.
Automated equation derivation was demonstrated in Chapter 4 for some simple
linear systems. This topic will be addressed again in this chapter. But, for now,
the state equations are derived, using the procedure from Chapter 5, as
˙pr = −Fs −Fd + mωpθ
m + mg cos θ,
(13.4)

EXPLICIT FIRST-ORDER DIFFERENTIAL EQUATIONS
603
mg
I:m
I:m
Fd
Fs
pr
νr
νθ
q
SE:
0
MGY
1
1
1/cos θ
sin θ
pθ
MTF
R
C
MTF
FIGURE 13.2. Bond graphs for the system from Figure 13.1.
˙pθ = −mg sin θ −mωpr
m ,
(13.5)
˙q = pr
m ,
(13.6)
where
Fs = Fs(q),
(13.7)
with
Fd = Fd
pr
m

,
(13.8)
and the kinematic relationship
ω = vθ/r = (pθ/m)/r = pθ
mr .
(13.9)
Equations (13.4)–(13.9) are almost explicit equations like Eq. (13.2). These
equations are ready to be solved once the constitutive behaviors of the spring
and damper are speciﬁed. The nonlinear constitutive relationships for the spring
and damper might be prescribed analytical functions or they may come from
experimental data. These would be included straightforwardly in a simulation
package.
Notice, however, that the angular displacement θ appears in the differential
equations, but since no energy storage depends on θ, it is not automatically a
state variable with its own differential equation. Thus, the state space must be
expanded by the user such that θ is a state variable and there is an equation for
˙θ. This is done by writing the free integrator equation
dθ
dt = ω = pθ
mr ,
(13.10)

604
NONLINEAR SYSTEM SIMULATION
using Eq. (13.9). Since the radius r is needed in Eq. (13.10) but is also not a
state variable in Eqs. (13.4)–(13.6), we write another extra state equation:
dr
dt = vr = pr
m .
(13.11)
There must be, in fact, a relationship between the displacement q of the spring
(already a state variable) and the radius r, but adding this last extra state vari-
able allows us the convenience of setting the free length of the spring and the
initial length of the pendulum separately. Adding extra state variables and state
equations is often convenient and causes no signiﬁcant problems in simulation.
A missing equation for a necessary state variable, however, will always cause a
fatal error in any simulation program.
These free-integrator equations can now be solved numerically along with the
original state equations, Eqs. (13.4)–(13.6), including the relations Eqs. (13.8)–
(13.9). This expanding of the state space to make available modulating vari-
ables such as θ in this example is often necessary when dealing with mechanical
systems that can move through large angular displacements. The displacement
modulated transformers that arrise commonly is mechanical systems were dis-
cussed in Section 7.3. Fortunately, rates of change of these modulating variables
are always available directly from the bond graph, so writing an extra state
equation is no problem.
13.2
DIFFERENTIAL ALGEBRAIC EQUATIONS CAUSED
BY ALGEBRAIC LOOPS
When causality does not complete on a bond graph after assigning causality by
the rules of Chapter 5, an algebraic loop exists among some of the effort and
ﬂow variables of the model. This occurrence does not suggest anything about the
quality of one’s modeling decisions, but those decisions did lead to an algebraic
problem. And this algebra must be dealt with prior to simulating the system.
When an algebraic loop exists, derivation of equations yields state equations
like
˙x = f(x, u, z, t),
(13.12)
where
z = g(x, u, z, t),
(13.13)
and x is the vector of state variables chosen from the energy storage elements
in integral causality, and u is the vector of inputs. The vector g contains e and
f variables that are part of the algebraic loop, and, unfortunately, these variables
depend on themselves, as shown by the right-hand side of Eq. (13.13).
If it is possible to solve Eq. (13.13) for z as it depends on x, u, and t, then
substitution into (13.12) yields explicit equations as described previously. This

DIFFERENTIAL ALGEBRAIC EQUATIONS CAUSED BY ALGEBRAIC LOOPS
605
procedure was demonstrated in Section 5.4 for the case when the model is linear.
When the model is nonlinear, it may not be possible to do the required algebra,
especially if z contains several e and f variables.
Considering Eqs. (13.12) and (13.13), one can imagine an iterative computa-
tional procedure that, starting with the initial values of x and u, would manipulate
the components of z until the right-hand side of Eq. (13.13) reproduces the values
of the z variables on the left side to within some prescribed error bounds. Then
this value of z substituted into Eq. (13.12) would allow one time step to be taken.
This procedure could be repeated every time step. Clearly, this iteration at every
time step slows down the simulation. There are computer algorithms that do this
procedure more or less automatically, and they will be discussed further in the
section on automated simulation.
Another, and perhaps more satisfying, approach to dealing with the algebra is
to revisit the modeling assumptions that led to the algebraic problem in the ﬁrst
place. By modifying one’s assumptions to include some inertia or compliance
at locations where it was previously ignored, the algebraic loops can be made
to disappear, and explicit equations like (13.2) will result. This procedure was
coined the Karnopp–Margolis method in Reference [2], was demonstrated for a
complex system in [3], and is shown for a simple system here.
Figure 13.3 shows a mechanical schematic for a system consisting of one
mass, one spring, and two damping elements. The spring and dampers are all
nonlinear. Assigning causality by the rules of Chapter 5 yields the incomplete
bond graph of Figure 13.4a. Arbitrarily assigning F1 into the 0-junction results
m
Fd
Damper 2
Spring
Damper 1
Massless
connection
FIGURE 13.3. A simple system with an algebraic loop.
Fd
Fs qs
I:m
SE:
1
1
0
R
R
C
pm
ν1
F1
ν2
F2
Fd
Fs
I:m
SE:
1
1
0
R
R
C
(a)
(b)
F1
F2
ν1
ν2
pm
qs
FIGURE 13.4. Bond graph for the system of Figure 13.3.

606
NONLINEAR SYSTEM SIMULATION
in the causally complete bond graph of Figure 13.4b. Since one arbitrary causal
assignment was necessary, we know that one algebraic loop is present.
Assume the R- and C-elements are characterized functionally as
F1 = R1(v1),
(13.14)
v2 = −1
R1 (F2),
(13.15)
Fs = c(qs).
(13.16)
Choosing F1 as the auxiliary variable in the algebraic loop and using the proce-
dure developed in Chapter 5, we can derive
F1 = R1
pm
m −v2

,
(13.17)
v2 = −1
R2 (F1 −Fs).
(13.18)
Combining (13.16), (13.17), and (13.18) yields
F1 = R1
pm
m −−1
R2 [F1 −c(qs)]

.
(13.19)
This relationship is the example equivalent to Eq. (13.13) for the general case
with F1 playing the role of z. Here we have F1 related to state variables pm and
qs and to itself.
The state equations are straightforwardly derived as
˙p = Fd −F1,
(13.20)
˙qs = −1
R2 [F1 −c(qs)].
(13.21)
These equations are an example of the general Eqs. (13.12). Here the state deriva-
tives depend on themselves and the auxiliary variable, F1.
If the functions R1(·), −1
R2 (·), and c(·) are such that Eq. (13.19) could
be solved for F1, then that result can be used in Eqs. (13.20) and (13.21) to
yield explicit equations, and the solution is straightforward. However, it should
be appreciated that, even when only one variable is involved with the algebraic
loop, the nonlinear functions may not allow solution of Eq. (13.19) for F1, explic-
itly. If some of the functions are not analytical expressions, but rather tables of
data, explicit solution of Eq. (13.19) would be impossible. Generally, if multiple
auxiliary variables are involved in the algebra, explicit formulation is out of the
question.
Returning to the original model of Figure 13.3, it was assumed that the connec-
tion in the middle is massless. This is a modeling decision based on reasonable
assessment of the requirements of the model. We know that the connection is not
massless, just like we know the proposed constitutive behavior of the elements is

DIFFERENTIAL ALGEBRAIC EQUATIONS CAUSED BY ALGEBRAIC LOOPS
607
m
Fd
Fd
Damper 2
Spring
Damper 1
m'
pm'
Fs qs
pm
I:m'
I:m
SE:
1
1
0
R
R
C
ν1
F1
ν2
F2
FIGURE 13.5. System from Figure 13.3 with mass at connection.
not exact. In Figure 13.5, the massless connection is changed to a connection has
some mass. Also shown in Figure 13.5 is the bond graph with causality assigned.
This time the causality completes, and there is no algebraic loop. Derivation of
state equations is guaranteed to be in explicit form.
Directly from the bond graph, these equations are
˙pm = Fd −F1,
(13.22)
˙pm = F1 −Fs −F2,
(13.23)
˙qs = pm′
m′ ,
(13.24)
where
F1 = R1
pm
m −pm′
m′

,
(13.25)
F2 = R2
pm′
m′

,
(13.26)
Fs = c(qs).
(13.27)
These equations are in explicit form, and, after the constitutive behavior of the
nonlinear elements is speciﬁed, they are ready for computer simulation.
Upon rethinking our original modeling assumptions in order to generate a
causally complete bond graph and, thus, explicit state equations, two things
of interest occurred. First, introduction of the originally unintended inertial

608
NONLINEAR SYSTEM SIMULATION
element, m′, has increased the order of the system from two state equations
to three state equations. This is not signiﬁcant in this simple example, but if
the model is large and many algebraic loops exist, such that many additional
state variables are required, the modeler may decide to deal with the algebra
iteratively as mentioned previously.
The second result of introducing m′ into the model is that if m′ is made very
small, to simulate the originally intended system, a high-frequency component
is introduced into the model. The inertial element, m′, will interact with the
spring and dampers to produce short-period and/or short-time-constant response
components, and the computational time step must be appropriately shortened
to capture these short time transients in the solution. In general, if the parasitic
elements introduced to modify the causality of the original model are chosen so
as to introduce dynamics about a factor of 10 faster than the original system,
the simulation results will be imperceptibly different from the original system
response. The increased time required for the simulation due to the shorter step
size is about the same as the time needed to perform the algebraic iterations if the
model is left in differential algebraic form.
Before leaving this section, the reader should realize that nonlinear systems
do not ofﬁcially have eigenvalues, time constants, or oscillation frequencies as
deﬁned in Chapter 6 for linear systems. So using these terms above while describ-
ing the effect of introducing parasitic elements to modify causality in nonlinear
systems is not, strictly speaking, rigorous. However, I -elements interacting with
C-elements will oscillate, I -elements interacting with R-elements will experi-
ence decaying motion over some period of time, and R-elements interacting with
C-elements will dissipate energy over some time period. The engineer model-
ing a physical system will have no difﬁculty in interpreting the dynamics from
introduced parasitic elements.
13.3
IMPLICIT EQUATIONS CAUSED BY DERIVATIVE CAUSALITY
In Chapter 5 we saw that after causality is assigned to a bond graph, some I -
or C-elements may end up in derivative causality. As with incomplete causality
from the previous section, the presence of derivative causality does not suggest
anything about the quality of the model or one’s modeling decisions. But it
does indicate that an algebraic problem exists that must be dealt with prior to
simulation of the system.
For linear systems, Chapter 5 demonstrated a procedure to handle the algebraic
implications prior to deriving the state equations. For nonlinear systems, the
procedure can still be used, but the algebraic manipulations may not be possible
to perform.
In general, if derivative causality exists in a bond graph model, the state
equations will have the general form
˙x = f(x, u, t, ˙x),
(13.28)

IMPLICIT EQUATIONS CAUSED BY DERIVATIVE CAUSALITY
609
where x is the vector of state variables and u is vector of inputs. The right-
hand side of Eq. (13.28) represents the nonlinear functions of the states, inputs,
and state derivatives. These equations are in implicit form and cannot be solved
easily numerically because a knowledge of input and state variables does not
immediately produce values of the derivatives of the state variables.
One can imagine a computer algorithm that, starting from the initial values
of the state variables, guesses initial values of the state derivatives, ˙x, and then
uses some iterative procedure until the right-hand side of Eq. (13.28) reproduces
the left-hand side to within some deﬁned accuracy. Once the ˙x are known, an
integration step can be taken, and the process begins again. This solution of
implicit equations is quite computer intensive. More will be said about this in
the section on automated simulation.
Another approach to dealing with derivative causality is the same as dealing
with algebraic loops. We look at the modeling decisions that led to derivative
causality and make new modeling decisions that do not introduce the problem.
We again include physically motivated parasitic elements that permit explicit
equations while retaining the intended performance of the model.
Consider the example system of Figure 13.6. It consists of three nonlinear
springs and a nonlinear damper. The springs’ constitutive laws are
F1 = c1(q1),
(13.29)
F2 = c2(q2),
(13.30)
F3 = c3(q3).
(13.31)
The damper is characterized by
vd = −1
R (Fd).
(13.32)
The bond graph for this system is shown in Figure 13.7, and causality assignment
indicates that spring 3 is in derivative causality. Notice the causality on the
damper dictates that the ﬂow, vd, is the output, and the effort, Fd, is the input.
m2
m3
Spring 2
Spring 3
νi
ν2
ν3
Spring 1
Massless
connection
Damper
FIGURE 13.6. Nonlinear system exhibiting derivative causality.

610
NONLINEAR SYSTEM SIMULATION
I:m2
I:m3
p2
p3
F1
q1
q3
F2
F3
Fd
q2
νi
νd
SF:
0
0
0
1
C
C
R
C
Spring 3 in
derivative causality
FIGURE 13.7. Bond graph for the system in Figure 13.6.
Procedures from Chapter 5, Section 5.5, show that state equation formulation
will require the ﬂow on that spring, ˙q3, to be part of the equation derivation.
From Eq. (13.31) we can write
q3 = −1
c3 (F3),
(13.33)
which says we must be able to invert the constitutive relationships associated
with derivative causal energy storage elements. This may not be possible, but
assuming it is, we continue. Causality tells us that
F3 = F1 −F2,
(13.34)
where F1, F2 are from Eqs. (13.29) and (13.30). Then,
˙q3 =
d−1
c3 (F3)
dF3
˙F3,
(13.35)
where
˙F3 = dc1
dq1
˙q1 −dc2
dq3
˙q3.
(13.36)
The state equations, directly from the bond graph, are
˙q1 = v1 −vd −p3
m3
−˙q3,
(13.37)
˙q2 = −p2
m2
+ vd + p3
m3
+ ˙q3,
(13.38)
˙p2 = F2,
(13.39)
˙p3 = F1 −F2,
(13.40)

IMPLICIT EQUATIONS CAUSED BY DERIVATIVE CAUSALITY
611
where F1, F2 come from Eqs. (13.29) and (13.30), and vd comes from Eq. (13.32),
with
Fd = F1 −F2.
(13.41)
Notice that q3 is not an independent state variable even though spring 3 stores
energy. Because of the derivative causality, q3 is algebraically related to the
state variables q1 and q2. Using Eq. (13.36) in Eq. (13.35) and substituting
into Eqs. (13.37) and (13.38), we end up with equations of the general form of
Eq. (13.28), where state derivatives appear on the right-hand side of the state
equations.
Presuming that the operations indicated in Eqs. (13.35) and (13.36) can be
carried out, the iterative solution of these implicit equations could be done. It may
also be possible to perform the algebra to get all state derivatives to the left-hand
side of Eqs. (13.37) and (13.38) and manipulate until explicit equations result. In
general, this will not be possible for nonlinear systems because the constitutive
behavior of the elements will not necessarily be differentiable analytical functions
but may be bounded functions with discontinuities and/or tables of data from
testing real devices.
An alternative approach is to look back at our modeling assumptions and
revise them a bit so we do not end up with derivative causality. Figure 13.8
m2
m3
νi
νd
Fd
R
Spring 2
Spring 3
p2
I:m2
I:m3
I:m'
SF:
0
0
1
0
C
p3
pm'
ν1
F2
F3
C
q1
q2
q3
F1
C
ν2
ν3
Spring 1
m'
Damper
FIGURE 13.8. Revised system of Figure 13.6 without derivative causality.

612
NONLINEAR SYSTEM SIMULATION
shows the example system from Figure 13.6 without the assumption of a massless
connection. This time a mass, m′, has been included at the connection. The bond
graph with m′ included shows no derivative causality; thus, explicit equations
will result from the bond graph.
This time the state equations are
˙q1 = vi −pm′
m′ ,
(13.42)
˙q2 = −p2
m2
+ pm′
m′ ,
(13.43)
˙q3 = pm′
m′ −p3
m3
−vd,
(13.44)
˙p2 = F2,
(13.45)
˙p3 = F3,
(13.46)
˙pm′ = F1 −F2 −F3,
(13.47)
where F1, F2, and F3 come from the constitutive relationships of Eqs. (13.29),
(13.30), and (13.31) and vd comes from Eq. (13.32), with Fd = F3. Thus, we
have explicit, ﬁrst-order, nonlinear state equations ready for computer solution.
For the case of derivative causality, when we revisited our modeling assump-
tions and introduced a parasitic element, m′, we ended up with two additional
state equations. One is due to the introduced I -element, with mass m′, and the
other is due to switching the causality on spring 3 making q3 an independent
state variable. For low-order models requiring few parasitic element additions,
the additional state equations will pose no computational problems. But for very
large models, with many derivative causal elements, we may elect to deal with
the problem by solving the implicit equations directly. The section on automated
simulation will deal with this later.
Finally, when introducing parasitic elements to yield explicit equations, fast
dynamic transients are introduced if the parasitic elements are sized to approxi-
mate the originally intended model. This was discussed in the previous section
concerning algebraic loops. That discussion applies here as well.
13.4
AUTOMATED SIMULATION OF DYNAMIC SYSTEMS
Automated simulation here refers to the many commercial equation solvers that
take equations of motion delivered in some prescribed format, march out solutions
in time, and present results with very little computer programming required from
the user. All of these packages accept equation formats as inputs, and some of
them have graphical interfaces such that various graphical icons are interpreted
as equations and delivered properly to the equation solver. The current software
packages available throughout the world will not be speciﬁcally discussed in the
text. Here we discuss some generalities of automated simulation.

AUTOMATED SIMULATION OF DYNAMIC SYSTEMS
613
There are several software packages available for very speciﬁc systems, such
as automobile dynamics, train dynamics, magnetic circuits, acoustics, plus oth-
ers. These have speciﬁc models already internally built, and the user must only
provide data to describe the particular system. These are very useful programs
for the intended use but do not represent the system dynamic modeling empha-
sized in this text. Here we speak of system models that have been constructed by
the modeler to develop insight into system behavior or control philosophies for
prototyping. Here we discuss software packages that allow simulation of these
models in the most straightforward way.
13.4.1
Sorting of Equations
For an equation solver to simulate one time step into the future, it requires the
current values of the state-variable derivatives. These derivatives are calculated
one at a time from the equations or subroutines the user provides by automati-
cally sorting the equations such that the updated information required to evaluate
each derivative has already been computed. As a simple example, consider the
equation
dx
dt = ax + b,
(13.48)
where
a = 6,
(13.49)
b = 8,
(13.50)
x = 2.
(13.51)
Without automatic sorting, dx/dt could not be evaluated unless Eqs. (13.49)–
(13.51) have been previously evaluated so that a, b, and x have speciﬁc numerical
values. With automatic sorting, the computer algorithm knows to evaluate a,
b, and x prior to calculating dx/dt. This sorting feature may appear trivial or
obvious, but it frees the user from providing equations in proper sequence and
greatly facilitates putting several submodels together without paying attention to
order.
An equally important feature of sorting comes from the following simple
example. Consider
dx
dt = ax + b,
(13.52)
where
b = c −b + x,
(13.53)
c = 6,
(13.54)
a = 8,
(13.55)
x = 2.
(13.56)

614
NONLINEAR SYSTEM SIMULATION
Here we have a problem sorting the equations. In Eq. (13.53), b depends on itself,
and there is no way an automatic sorting routine can ﬁnd a sequential evaluation
of Eqs. (13.53)–(13.56) that will allow an evaluation of dx/dt in Eq. (13.52). An
automatic sorting algorithm cannot sort these equations. In principle, one could
simply solve Eq. (13.53) for b = 1
2c + 1
2x and be done with it. A computer
algorithm capable of handling differential-algebraic equations∗would take the
values of c and x, then iterate on b until the right-hand side of Eq. (13.53)
equaled the left-hand side. An explicit equation solver, given these equations,
would respond with can’t sort and quit. Thus, modern commercial software
packages requiring explicit equations automatically inform the user when the
model is not computable, but cannot simulate further.
As seen previously, bond graph techniques detect algebraic formulation prob-
lems prior to deriving a single equation. This allows modelers to address their
modeling assumptions before attempting to simulate the model. This is a most
useful virtue of bond graph modeling.
13.4.2
Implicit and Differential Algebraic Equation Solvers
When modeling assumptions lead to algebraic loops or derivative causality,
explicit equation solvers cannot sort equations for simulation. If the algebra is not
dealt with, then a solution can be marched out only by the iterative procedures
described previously. The equations involved are differential algebraic equations
(DAEs) or implicit differential equations.
As mentioned, there are commercial packages devoted to simulating very
speciﬁc dynamic systems, such as automobiles and trains. These models are in the
area of dynamics called “multibody system dynamics,” where the inertial bodies
are all assumed to be rigid and no relative motion is permitted at attachment
points among the bodies. Bond graph models of such systems would be full
of derivative causality. For these systems, special algorithms may be used to
solve system equations. Because the equations have a particular form due to
the particular algebraic problem, the software can march out solutions with no
programming from the user.
The modeling procedure developed in this text often results in algebraic prob-
lems that must be addressed by the modeler prior to computer solution. Something
as common as Coulomb friction, if involved in an algebraic loop, cannot be han-
dled by a DAE solver without signiﬁcant user attention. While DAE solvers are
powerful tools for automated simulation, in this text we emphasize models that
yield explicit equations.
13.4.3
Icon-Based Automated Simulation
There are commercial software packages that allow graphical system descriptions
that are automatically translated into equations of required format and given
∗There are software packages that will attempt to solve differential algebraic equations. These
are not nearly as prevalent as explicit equation solvers.

AUTOMATED SIMULATION OF DYNAMIC SYSTEMS
615
to the equation solver. These icon-based packages are predominantly associ-
ated with special applications like electric circuits, hydraulic circuits, mechanical
spring–mass–damper systems, magnetic circuits, and acoustic circuits. Some of
these programs allow “functional block” inputs, like block diagrams, and are less
speciﬁc to certain types of system than the aforementioned software.
There are several packages that translate bond graph descriptions into appro-
priate input ﬁles for equation solvers. Since bond graphs allow modeling of all
types of energetic systems, linear or nonlinear, the graphical bond graph pro-
grams are the most appropriate for overall system dynamics coupling complex
mechanical systems with actuators, sensors, and control systems in a variety of
energy domains.
If linear modeling assumptions are used in the construction of a model,
then only one parameter is needed to describe each basic —R, —I, —C,
—TF—, or —GY — element. For multiport elements, the number of parameters
increases but remains constrained. For nonlinear systems, there is an inﬁnite
variety of possible constitutive laws. For instance, if a bond graph had a
C-element, a computer could interpret this symbol as having the linear constitu-
tive law:
e = q
C ,
(13.57)
and the user would only have to supply the value of the compliance parameter,
C. If that same C-element were nonlinear, such that
e = c(q),
(13.58)
the user would have to provide the computer the functional dependence through
some user-provided function or tabular data. Some icon-based graphical bond
graph processors interpret the bond graph ﬁrst as though it were linear. They
then allow the user to modify the input ﬁle to reﬂect the intended nonlinearities
or simply assign values to appropriate parameters if the element were actually
considered to be linear.
The title of the section is Automated Simulation of Dynamic Systems, but
after reading all this description, the reader may feel there is nothing at all
automated about simulation. It is true that low-order, linear systems can be
simulated with virtually no effort from the user. But complex nonlinear sys-
tems do require signiﬁcant user input. What is involved might be best called
computer-aided modeling and simulation since a computer program can do much
of the routine work of setting up a mathematical model for numerical simulation.
When the program recognizes a problem, creative human intervention is often
required.
Bond graphs allow organization of complex models into manageable parts,
and they inform the user of computational problems through the assignment of
causality. In the next section, a complex system simulation is demonstrated.

616
NONLINEAR SYSTEM SIMULATION
13.5
EXAMPLE NONLINEAR SIMULATION
In Chapter 12, thermodynamic modeling was developed, and a bond graph of a
piston-ported, two-stroke engine was shown in Figure 12.20. The example model
done here is a simpliﬁed version of a two-stroke engine called the “air motor.”
The air motor is shown schematically in Figure 13.9. It consists of a
slider–crank kinematic mechanism, which drives a piston in a cylinder. Just
after top dead center (TDC), the inlet value is opened, exposing the piston
to the supply pressure, Ps. The pressure, P, in the cylinder pushes the piston
downward. As the piston passes the exhaust port, the piston modulates the ﬂow
area and effects the ﬂow of air out of (or into) the cylinder. The idea of the
simulation might be to determine the best location, xe, of the exhaust port so
as to extract the most useful work from the supply air. Our purpose here is
just to demonstrate a nonlinear simulation. This particular example was chosen
because all the components have been modeled previously in the text, but
more importantly, there is no way that a linearized analysis will be sufﬁcient
here. The only practical way to gain insight into the behavior of this system is
through simulation.
Ps
he
xe
xp
Te
Pe
Inlet valve area, Ai
Top of piston
when θ = 0 (BDC)
θ
τ
ω
Flywheel with radius,
R, rotary inertia, Jw,
and rotary damping, bτ
R
Exhaust port,
width, we, and
height, he
P,T,m,E,V
Piston area, Ap
FIGURE 13.9. Schematic diagram of an air motor.

EXAMPLE NONLINEAR SIMULATION
617
It is assumed that a single pressure, P, temperature, T, mass, m, energy, E,
and volume, V, characterize the instantaneous properties of the cylinder head. It
is further assumed that the piston is massless and there is no leakage past the
piston. Finally, it is assumed that the inlet area, Ai, is exposed instantly upon
command, the cylinder head can be modeled as a single thermodynamic accu-
mulator (Section 12.5.1), and the inlet and exhaust ports are each characterized
as isentropic nozzles (Section 12.5.2).
The bond graph for the air motor is shown in Figure 13.10. Causality has
been assigned and indicates all integral causality with no algebraic loops. Thus,
although complex, formulation will yield explicit equations ready for simulation.
The thermodynamic accumulator will contribute three state variables, and the
ﬂywheel inertia will contribute one state variable. Only four state equations are
needed for this simulation.
The 4-port R-element for the inlet requires speciﬁcation of the supply pressure,
Ps, and supply temperature, Ts. It also needs to know the ﬂow area, Ai, which
will be speciﬁed through some logic statements provided by the user. It will be
open when θ exceeds 180◦and closed when the piston position, xp, is less than
the exhaust port location, xe.
0
1
0
0
MTF
TF: Ap
R
F
V
P
xp
xp
pJ
C
logic
∫
SE:PAT
SF:PV
Ehi
E
T
R
Ehe
SE
SE
TS
PS
me
mi
Ai
Ae
m
P
I:Jω
ω1
τ
τ0
R:bτ
m(θ)
Slider
crank
mechanism
:
:
TE
PE
SE
SE
:
:
Exhaust
port
Inlet
port
FIGURE 13.10. Bond graph of the air motor.

618
NONLINEAR SYSTEM SIMULATION
The 4-port R-element representing the exhaust port requires speciﬁcation of
the pressure, Pe, and temperature, Te, just outside the port. The upstream con-
ditions come from the causal outputs, P and T, from the 3-port C-element. The
exhaust port area, Ae, is modulated by the piston position, xp, through some
user-supplied logic. This is indicated by the ideal measurement of ˙xp followed
by signal processing blocks.
The slider–crank is represented as a modulated transformer with modulus,
m(θ). Section 8.1 showed how to derive this modulus:
m(θ) =

R sin θ −
R2 sin θ cos θ
(L2 −R2 sin2 θ)1/2

.
(13.59)
This leads to the equation
˙xp = m(θ)ω.
(13.60)
(Note that in Eq. (13.59) the reference for θ = 0 is bottom dead center while θ
was measured from top dead center in Section 8.1, Figure 8.5.)
The state variables are E, m, and V, respectively the energy, mass, and volume
of the accumulator, and pJ , the angular momentum of the ﬂywheel.
Following the causal information, the equations can be derived as
˙E = −P ˙V + ˙Ehi −˙Ehe,
(13.61)
˙m = ˙m′ −˙me,
(13.62)
˙V = −Ap ˙xp
(13.63)
˙pJ = −bτ
pJ
Jw
−τ.
(13.64)
The enthalpy ﬂow, ˙Ehi, and mass ﬂow, ˙mi, for the inlet port are outputs from
the 4-port R-element described in Section 12.5.2. In that section a computational
procedure is described by Eqs. (12.93)–(12.98). This will not be repeated here.
We will just state here the causal implication of the 4-port; thus,
˙Ehi = fi(Ts, Ps, T, Ai),
(13.65)
˙mi = gi(Ts, Ps, T, Ai).
(13.66)
Similarly, the energy and mass ﬂows through the exhaust port can be expressed
as
˙Ehe = fe(T, P, Te, Pe, Ae),
(13.67)
˙me = ge(T, P, Te, Pe, Ae).
(13.68)
In these expressions, the outputs from the accumulator are related to the state
variables by the compliance relationships,
T = 1
cv
E
m
(13.69)

EXAMPLE NONLINEAR SIMULATION
619
and
P = R
cv
E
V .
(13.70)
These constitutive laws are repeated from Section 12.5.1.
To complete the formulation, we need ˙xp from Eq. (13.63) and the torque, τ,
from Eq. (13.64). From the bond graph,
˙xp = m(θ)PJ
Jw
(13.71)
τ = m(θ)Ap(P −Patm)
(13.72)
Atmospheric pressure, Patm, is included in the bond graph to convert from abso-
lute pressure, needed on the thermodynamic side of the accumulator, to gauge
pressure on the mechanical side.
We must recognize the need for θ and xp as modulating variables. Here we
expand the state space by writing
˙θ = PJ
Jw
,
(13.73)
and θ will be solved along with the other state equations. The displacement, xp,
is already established as a state variable by Eq. (13.71).
Finally, the area modulation of Ai for the inlet and that of Ae for the exhaust
are needed to complete the formulation. These would both be speciﬁed by logic
supplied by the user. For example, for Ai,
if θ =≥180◦
and
xp > xe,
Ai = Ai max
otherwise,
Ai = 0.
(13.74)
This will keep the inlet open until the exhaust port begins to open. The user
must be a little careful here to make sure that θ gets reset to zero after each full
rotation since θ will increase continuously from integration of Eq. (13.73), and
Eq. (13.74) would not work after one rotation.
The exhaust area logic would be
Ae = 0;
if xp ≤(xe + he),
Ae = We[xe + he + xp];
(13.75)
if xp ≤xe,
Ae = wehe.
These statements will modulate the area as the piston uncovers the port, then
keeps the area at its maximum value when the port is uncovered, and sets the
area to 0 when the port is covered. There may be other strategies that the user
will want to try. These are just examples.

620
NONLINEAR SYSTEM SIMULATION
Equations (13.61)–(13.75) can be delivered to an explicit equation solver in
any order desired, if it has an automatic sorting routine that will evaluate each
equation in its proper order to compute the state derivatives. An integrating
algorithm will march the solution from one time step to the next. There is no
need to eliminate non-state variables such as τ in Eq. (13.64) using Eq. (13.72)
to put these relationships in the reduced functional explicit form,
˙x = f(x, u, t),
(13.76)
since we know that this combination of relationships, Eqs. (13.61)–(13.75), rep-
resents a causal, computable, model equivalent to Eq. (13.76) and the sorting
of equations can be successfully carried out. In fact, some bond graph proces-
sors purposefully do not eliminate all the internal efforts and ﬂows in a system
to arrive at the form of Eq. (13.76) involving only state and input variables.
Instead, they write all the element relationships in the proper causal form such
that the result is equivalent to Eq. (13.76). Causal analysis will show that the set
of equations can be successfully sorted. Then, after a simulation run, every effort
and ﬂow as well as all the state variables are available for plotting.
13.5.1
Some Simulation Results
The air engine parameters are
Dp = 80 mm, piston diameter;
R = 40 mm, crank radius;
L = 40 mm, connecting rod length;
Vsq = 40 cm3, volume in head at TDC;
Jw = 1.64 × 10−3 k/g2, ﬂywheel rotary inertia;
bτ = load resistance, to be varied to determine torque, speed, and power.
For the intake port,
Ai max = 2.9 cm2, maximum inlet area;
Ps = 200 psig = 14.3 atm = 14.3 × 105 N/m2 supply pressure;
Ts = 20◦C = 293 K, supply temperature.
For the exhaust port,
he = 17 mm, height of port;
we = 17 mm, width of port;
xe is variable, placement of port relative to crank center.
User might try 0, 20, 40 mm, . . . .

EXAMPLE NONLINEAR SIMULATION
621
For speciﬁc results, the initial conditions must be speciﬁed. The simulation is
started at just past TDC with θ = 182◦. The pressure in the cylinder, P, is Patm,
and the temperature, T, is 20◦C. The cylinder volume, V , is Vsq = 40 cm3. From
Eq. (13.70), we can calculate the initial energy, E, and from Eq. (13.69), we can
calculate the initial mass, m. The initial angular momentum, pJ , is zero.
The simulation is initiated with these initial conditions, and simulation pro-
ceeds with the piston moving cyclically as energy and mass enter and exit the
motor. The state equations were solved using a commercial software package
and some representative responses are shown here.
Figure 13.11 shows the cylinder pressure, P, and exhaust and inlet areas as
they depend on time. Figure 13.12 shows the cylinder temperature. The pressure
and temperature both take several cycles to come to a more or less steady state.
When the inlet area opens, the pressure spikes a bit due to the pressure difference
between supply pressure and cylinder pressure and the fact that the piston is
moving very slowly near TDC. The temperature shows the same behavior.
Figure 13.13 shows the mass ﬂow rate through the inlet port and exhaust
port. Interestingly, the inlet port shows a very brief negative spike. This is
due to the pressure in the cylinder being higher than the supply pressure
when the inlet opens. There is a rapid readjustment followed by ﬂow into
the cylinder as the piston is driven downward. The exhaust ﬂow increases
rapidly as the exhaust port opens and then decreases as the cylinder pressure
drops. The increase in mass ﬂow just before the exhaust port closes is due
0.00035
0.0003
0.00025
0.0002
0.00015
0.0001
0.00005
0
Inlet and exhaust areas (m2)
1.4
1.2
1
0.8
0.6
0.4
0.2
0
Pressure ratio, P/Ps
0
0.01
0.02
0.03
0.04
Time (s)
0.05
0.06
0.07
0.08
P/Ps
Ae
Ai
FIGURE 13.11. Pressure in the air engine cylinder.

622
NONLINEAR SYSTEM SIMULATION
0.00035
0.0003
0.00025
0.0002
0.00015
0.0001
0.00005
0
Inlet and exhaust areas (m2)
420
360
300
240
180
120
60
0
Temperature (K)
0
0.01
0.02
0.03
0.04
Time (s)
0.05
0.06
0.07
0.08
Temp
Ae
Ai
FIGURE 13.12. Temperature in the air engine cylinder.
1
0.8
0.6
0.4
0.2
0
–0.2
–0.4
–0.6
0.01
0.02
0.03
0.04
Time (s)
0.05
0.06
0.07
0.08
0
Mass flow rate (kg/s)
mi 
me 
FIGURE 13.13. Mass ﬂow rate through the inlet and exhaust ports.
to the piston having reached bottom dead center and moving upward. As the
piston closes the exhaust area, it drives air out through the port.
Figure 13.14 shows the output torque of the engine. This is the torque measured
on the torsional resistance, bτ, from Figure 13.10. It is consistent with the pressure
behavior. It is interesting that the torque peak does not coincide with the peak

SUMMARY
623
0.00035
0.0003
0.00025
0.0002
0.00015
0.0001
0.00005
0
Inlet and exhaust areas (m2)
35
30
25
20
15
10
5
0
Output torque, τ0 (Nm)
0
0.01
0.02
0.03
0.04
Time (s)
0.05
0.06
0.07
0.08
Torque
Ae
Ai
FIGURE 13.14. Output torque, τ, from the air engine.
pressure. This is due to the inherent behavior of a slider–crank mechanism. Near
TDC, where the pressure is highest, there is no moment arm to transmit torque
to the ﬂywheel. As rotation proceeds, the moment arm grows as the pressure
decreases.
13.6
SUMMARY
This chapter has attempted to expose the complexities of nonlinear simulation and
the organization provided by using bond graphs to put complex systems together.
Causality is a powerful tool in that formulation problems are exposed before
equation formulation, providing the user with choices in how to proceed toward
a computable model. Causality also dictates the input and output variables for the
nonlinear constitutive laws for the elements. This allows a priori determination of
whether a particular relationship must be inverted if required by the formulation
demands.
It was shown here and in Chapter 9 that nonlinear geometry of mechanics
requires modulation variables (displacements) that are not algebraically available
from the state variables associated with stored energy. In this case, the state space
must be expanded to include free integrators, which are solved along with the
energy state variables to provide the needed displacements. Finally, an example
was developed to demonstrate a complex simulation. It is hoped that the reader
appreciates the usefulness of the bond graph in developing the simulation model.

624
NONLINEAR SYSTEM SIMULATION
REFERENCES
[1] B. Carnahan, H. A. Luther, and J. O. Wilkes, Applied Numerical Methods,
New York: Wiley, 1969.
[2] A. Zeid and C.-H. Chung, “Bond graph modeling of multibody systems: a
library of three-dimensional joints,” J. Franklin Inst., 329, 605–636 (1992).
[3] D. Margolis and D. Karnopp “Analysis and simulation of planar mechanisms
using bond graphs,” ASME J. Mech. Des., 101, No. 2, 187–191 (1979).
PROBLEMS
13-1. The system shown has a nonlinear spring characterized by
Fs = gsδ3
s
and a nonlinear damper characterized by
Fd = gdv3
d.
Construct a bond graph model, derive equations, and put them into a
form for computer simulation.
m
vd
Fi(t)
δs
13-2. For the system of Problem 13-1, what changes must be made in the
computer model if the spring and damper are characterized by square
laws rather than cubic laws?
13-3. For the system of Problem 13-1, include friction between the mass and
ground and reformulate the bond graph. Derive equations and put them
into a form ready for computer simulation. Describe the program state-
ments that would be necessary in order to include friction.
13-4. The device shown is an air spring that is assumed to behave isentropically.
The constitutive relationship for this device has been determined to be
F = P0AP
⎡
⎢⎣
1 −

AP δ
V0
γ

AP δ
V0
γ
⎤
⎥⎦,

PROBLEMS
625
where P0 is atmospheric pressure and V0 is the chamber volume when
AP δ/V0 = 1. A bond graph for the device is shown with attachment
points exposed.
Include this air spring in the quarter-car model, construct a bond graph
model, and derive a complete set of state equations. Organize these
equations into a form suitable for computer simulation. Explain any pro-
gram statements needed to handle the special case when AP δ/V0 →0.
F
F
AP
AP
v1
v2
v2
v1
δ, δ
δ
TF
C
0
b
v1
v2
vi
k2
m2
m1
Air
spring
13-5. The system shown has two nonlinear dissipation elements with constitu-
tive behavior,
F1 = g1v3
1,
v1 = vm −v2,
F2 = g2 |v2| v2.

626
NONLINEAR SYSTEM SIMULATION
Construct a bond graph model and determine that an algebraic loop exists.
Attempt to derive state equations using the procedure from Chapter 5,
Section 5.4. Now add a parasitic element to eliminate the algebraic loop.
Derive state equations and organize them into a form suitable for com-
puter simulation.
m
vm
F
k
v2
Dissipator
1
Dissipator
2
13-6. The system shown is a dc motor with a ﬂexible shaft and attached inertial
load. The shaft is nonlinear and behaves according to
τ = g(θ2 −θ1)3.
Construct a bond graph model, assign causality, and convince yourself
that derivative causality exists. Attempt to derive a computable model
using the methods from Chapter 5, Section 5.5. Append a parasitic
element to your model that eliminates derivative causality and assign
a physical interpretation to this element. Derive the resulting explicit
equations and put them into a form ready for computer simulation.
θ1
θ2
τ
τ = g(θ2 – θ1)3
τ
ei
JL
R
L
ω2 = θ2
ω1 = θ1
Nonlinear compliance

PROBLEMS
627
13-7. Figure 12.19 shows a thermodynamic system and its causal bond graph.
Derive the state equations for this system and show they are appropriate
for computer simulation.
13-8. The system shown couples the air spring from Problem 13-4 and the
slider–crank device from Eq. (13.59). Construct a bond graph model of
the system and derive state equations. Expand the state space as necessary
and set up your equations for computer simulation.
L
R
Ap
JFW
θ
τi
Air
compliance
13-9. The mass, m, bounces off the rigid wall with no loss of energy.
One way of simulating this phenomenon is to specify a boundary impul-
sive force, F, that acts over a speciﬁed but very short amount of time
(perhaps one simulation time step) and accelerates the mass such that
it comes off the wall with the same speed as the approach, but in the
opposite direction.
m
v
k
vi(t)
vi(t)
d
x
SE
SF
1
0
I:m
C:1/k
F
For an impact duration of t seconds, calculate the value of this force,
assuming knowledge of the approach velocity; set up the state equations
for simulation, including the logic statements needed to handle the bound-
ary impulse.

628
NONLINEAR SYSTEM SIMULATION
13-10. For Problem 13-9, another way to handle the impact problem is to assume
there is a spring between the mass and wall with the constitutive behavior
shown.
d
x
k
F
The spring constant, k, must be “very stiff” to simulate the originally
intended system, and this may require shortening the simulation time
step during contact with the wall. On the bond graph for Problem 13-9,
put a C-element in place of the effort source and derive equations
ready for simulation. Include the logic necessary to handle the “stiff”
compliance.
13-11. Two unequal-length pendulums are attached by a spring as shown. Con-
struct a bond graph model that would account for large angular deﬂec-
tions. Derive a complete state representation and set up for computer
simulation. The spring is relaxed when both pendulums are vertical.
k
g
θ1
L1
L2
m2
m1
θ2
d
13-12. In the slider–crank mechanism, assume the only important inertial ele-
ment is the connecting rod of mass m, centroidal moment of inertia J,
and length L. A modiﬁed device is shown here where the horizontal slid-
ing constraint has been replaced by two springs, kH and kV . If kV was

PROBLEMS
629
very stiff, then the horizontal sliding constraint would be approached.
Construct a bond graph model of this system and note the use of MTFs
involving angles θ and α. Derive a complete state representation and
organize them for simulation. (Hint: Transfer the center of mass motion
to the end points of the rod; then enforce the velocity constraint at the
crank, and derive the spring velocities at the other end.)
kV
kH
vx
ωb
vy
R
τ
α, α = ωb
θ, θ = ω

APPENDIX: TYPICAL MATERIAL
PROPERTY VALUES USEFUL IN
MODELING MECHANICAL, ACOUSTIC,
AND HYDRAULIC ELEMENTS
Mass Density, ρ, [kg/m3]
Solids
Aluminum:
2,700 kg/m3
Copper:
8,900 kg/m3
Rubber, hard:
1,100 kg/m3
Rubber, soft:
950 kg/m3
Steel:
7,700 kg/m3
Titanium:
4,500 kg/m3
Liquids
Hydraulic oil, well de-aerated:
900 kg/m3
Water, fresh, at 20◦C:
998 kg/m3
Water, sea, at 134◦C:
1,026 kg/m3
Gases
Air at 1 atm. and 20◦C:
1.21 kg/m3
Air at 1 atm. and 0◦C:
1.29 kg/m3
Hydrogen at 1 atm. and 0◦C:
0.09 kg/m3
Modulus of Elasticity, E, [Pa = N/m2]
Aluminum:
71,000 N/mm2 = 71 × 109 Pa
Copper:
122,000 N/mm2 = 122 × 109 Pa
Hard rubber:
2,300 N/mm2 = 2.3 × 109 Pa
Soft rubber:
5 N/mm2 = 0.005 × 109 Pa
Steel:
206,000 N/mm2 = 206 × 109 Pa
Titanium:
110,000 N/mm2 = 110 × 109 Pa
Bulk Modulus, B, [Pa = N/m2]
Water at 20◦C:
2.18 × 109 Pa
Hydraulic oil (well de-aerated):
1.52 × 109 Pa
630
System Dynamics: Modeling, Simulation, and Control of Mechatronic Systems, Fifth Edition
Dean C. Karnopp, Donald L. Margolis and Ronald C. Rosenberg
Copyright © 2012 John Wiley & Sons, Inc.

APPENDIX
631
Speed of Sound, c, [m/s]
Air at 1 atm. and 20◦C:
343 m/s
Air at 1 atm. and 0◦C:
332 m/s
Hydrogen at 1 atm. and 0◦C:
1,269.5 m/s
Water, fresh, at 20◦C:
1481 m/s
Water, sea, at 0◦C:
1500 m/s
Coefﬁcient of Shear Viscoscity, μ, [Pa · s = Ns/m2]
Air at 1 atm. and 20◦C:
1.8 × 10−5 Pa · s
Castor oil:
0.96 Pa · s
Water, fresh, at 20◦C:
1.0 × 10−3 Pa · s
Ratio of Speciﬁc Heats, γ = cp/cv
Air
1.40
Carbon dioxide
(low frequency)
1.30
(high frequency)
1.40
Nitrogen
1.40

INDEX
0-junction, 58, 59
causality, 63
1-junction, 60, 63
causality, 63
1-port, 19
compliance, 41
inertia, 43
resistor, 38
2-port, 18
gyrator, 53
transformer, 51
Accumulator, thermodynamic,
579
Acoustic approximation, 122, 576
Active bond, 29, 33, 385, 387
Actuators, 392
Air motor, bond graph, 617
Air motor simulation, 620
Air spring, 598
Algebraic loop, 183, 604
nonlinear, 605
A-matrix, 167
Ampliﬁers, 385, 388, 392
Angular momentum, 413
Augmenting the bond graph, 168
Automated simulation, 12, 198,
614
Automatic control, 258
proportional, 260
proportional plus derivative,
265
proportional plus derivative
plus integral, 269
lead-lag, 284
motion, 289
state variable feedback, 296
vibration control, 301
Automotive cornering forces,
349, 468
Automotive cornering stiffness,
468
Automotive shock absorber, 156
Bar, vibrating, 471, 482, 513, 515
Beam:
Bernoulli-Euler, 480
Timoshenko, 476
transverse motion, 476
Bernoulli resistor, 571, 595
Bernoulli’s equation, 569
Bernoulli-Euler beam, 480
Bicycle car model, 468, 469
Block diagrams, 30, 67, 240,
255, 392, 395
B-matrix, 168
Bode plot, 247, 316
Body ﬁxed coordinates, 116, 412,
416
modulated gyrator, 118, 414,
463
Bond, 27
active, 29
Bond graph, 5, 12.
air motor, 616
algebraic loop, 183
augmentation, 169
co-energy variables, 176
derivative causality, 65, 170,
172
equation formulation problems,
183
output variables, 10, 30, 220
reducible loop, 97
state variable, 9
Bulk modulus, 129, 159, 373, 568
Capacitance:
elastic pipe, 126, 120
rigid pipe, 126, 120
water storage tank, 126
Capacitor, 40
moveable plate, 380
Cardan angles, 416
Casimir form, 352, 358, 364
Causality, 31, 63
Causality assignment procedure,
171
Causal stroke, 3-
C-element, 42
Center of mass, 106
C-ﬁeld, 326
Characteristic equation, 224, 228,
485
Characteristic value, 228
Closed loop system, 259
Closed loop transfer function,
287
Co-energy variables, 176
Common effort junction, 58
Common ﬂow junction, 60
Complex frequency response, 247
Complex plane, 234
Compliance, 40
Compliance matrix, 330
633
System Dynamics: Modeling, Simulation, and Control of Mechatronic Systems, Fifth Edition
Dean C. Karnopp, Donald L. Margolis and Ronald C. Rosenberg
Copyright © 2012 John Wiley & Sons, Inc.

634
INDEX
Compressible gas dynamics, 549,
578
Compression, isentropic, 42, 574,
583
Conductance causality, 39, 350
Conduction heat transfer, 548
Constant coefﬁcient linear
systems, 219
Constitutive relationship, 38, 40,
43
Control, see Automatic control
Control actions, 259
proportional, 260
proportional plus derivative,
265
proportional plus derivative
plus integral, 269
Control volume, 552, 565, 571,
578
Coordinate transformations, 362,
416
Coordinates, body-ﬁxed, 116,
412, 412
Cramer’s rule, 240, 241
Critical damping, 232
Damped natural frequency, 232
Damped oscillator, 232
Damper, semi-active, 392
Damping ratio, 232
D-C motor, 18, 24, 140, 374
Delta function, 475
Derivative causality, 65
implicit equations, 191, 608
Descriptor form of equations,
434, 437
Differential algebraic equations,
437, 604
Differential equations, partial,
475, 481, 566
Displacement variable, 20
Distributed parameter systems,
470
Drive train model, 29, 69, 435
Effort junction, 60
Effort source, 48
Eigenvalue, 11, 222, 224
Elastic modulus, 128, 328
Electrical alternators, 377, 400
Electrical circuits, 78
Electrical circuit construction
procedure, 79
Electrical circuit power
convention, 79
Electrical circuit reference
voltage, 79
Electrical networks, 84
Electrical systems, 78
D-C motor, 18, 24, 140, 374
Pi network, 89
Tee network, 90
voice coil, 139
Electrical transformer, 52, 84
Electrically linear, 382
Electrohydraulic valve, 7
Electromechanical transducers,
139
Energy, 17
Gibbs, 554
Helmholtz, 554
internal, 550, 554
Energy variables, 20
Enthalpy, 554, 575
Entropy, 549, 552, 558
Start here
Equation derivation, 175
algebraic loop, 183, 604
derivative causality, 65, 188,
191, 608
Equations, sorting, 203, 613
Euler angles, 416
Euler’s equations, 414
Euler’s formula, 222
Eulerian description, 565, 571,
577
Explicit equations, 201, 601
Faraday’ law, 139, 356, 520
Ferromagnetic material, 520
Fields, 326
explicit, 329
IC, 445
implicit, 2329
Field strength, 521, 523
Finite lump, 470
First order system, 223, 226
Flow junction, 58
Flow source, 48
Flow variable, 19
Fluid capacitance, 125
Fluid circuit construction
procedure, 132
Fluid dynamic systems, 565, 578
Fluid inertia, 44, 130
Fluid line, 134
Fluid resistance, 39
Fluid system, acoustic mufﬂer,
122, 135
Flux, 47, 351, 377
Flux linkage variable, 23, 178,
196, 377, 383, 519
Forced response, 222, 229, 487
Force-free boundaries, 492
Force-free modes, 492
Forcing frequency, 245
Forward loop transfer function,
287
Free response, 218, 222
Frequency, damped natural, 232,
234
undamped natural, 230, 264
Frequency equation, 485
Frequency response, 11, 244
complex, 247
normalization, 252
examples, 249
Friction, dry, 171, 372, 562
Gear set, 51, 105
Generator, a-c, 377, 379, 385
Generator, d-c, 141, 375
Gibbs equation, 553
Gibbs free energy, 554
Gyrator, 53
causality, 63
modulated, 55, 118, 354, 376
Gyrator transducers, 139
Gyroscope, 53
Half car model, 108
Hamiltonian form, 440
Hamiltonian IC ﬁeld, 440
Heat conduction, 548
Heat transfer, 548
Heave-pitch vehicle model, 108
Helmholtz free energy, 554
Hydraulic and acoustic circuits,
121
Hydraulic models, acoustic
approximation, 121
Hydraulic motor, 133
Hydraulic pump, 133
Hydraulic ram, 52, 137, 372
Hydraulic shock absorber, 156,
393
Hydraulic valve, 7, 391
Hydrostatic system, 121, 122,
126, 575
I-element, 45
linear, 40
nonlinear, 43
I-ﬁeld causality, 285, 287
Imaginary part of, 226
Implicit equations, 534
derivative causality, 534
nonlinear example, 535
Inductance matrix, 286, 307
Inertia, 45
causality, 65

INDEX
635
Inertia matrix, 445
Initial condition problem, 78,
222, 226
Initial conditions, 78, 222, 226
Input/output concept, 240, 248
Instruments, 33, 371
Internal energy, 550, 554
Irreversible thermodynamics, 351
Isentropic nozzle, 585
Isentropic process, 129, 574
Isothermal models, 551
Junctions, 58
0-junction, 58
1-junction, 60
Junction structure, 89, 170, 326
Karnopp–Margolis method, 605
Kinematic constraints, 111, 116
Kinematic linkages, 56
Kinetic energy of rigid body, 106
Kirchhoff’s laws, 164, 171
Ladder network, 89
Lagrange multipliers, 435
Lagrange’s equations, 440
Lagrangian description, 571, 577
Lagrangian IC ﬁeld, 445
Laplace transforms, 219
Lead-lag control, 284
Legendre transformation, 554,
555
Lever, 51
Linear system, 11
Lorentz force law, 140, 356
Loudspeaker, 18, 34, 139
Lumped models, 470
Lumped parameter systems, 470
Magnetic bond graph variables,
519
Magnetic circuits, 519
Magnetic energy, 524
Magnetic ﬂux, 519
density, 519
Magnetic induction, 519
Magnetic saturation, 521
Magnetizing force, 521
Magnetomechanical elements,
532
Magnetomotive force, 523, 539
Mass controlled region, 500
Mathematical model, 1, 4
Maxwell reciprocity, 352, 382
Mechanical systems, 61, 91
in rotation, 100
rotation construction
procedure, 100
in translation, 91
translation construction
procedure, 93
Mechatronic system, 1
MGY, 55, 118, 354, 376
Microphone, 380
Modal analysis, 482
Modal bond graph systems, 443
Modal damping, 503
Modal inertia, 504
Modal mass, 504
Modal stiffness, 488, 500
Model, 4
Mode shapes, 485
Modulated gyrator, 55, 118, 354,
376
Modulated transformer, 35, 55,
108, 121, 354, 357
Modulus of elasticity, 128, 328
Momentum variable, 20
Motion control, 289
Motor, a-c, 377, 385, 536
Motor, d-c, 18, 24, 140, 374
Motors, synchronous, 536
Moveable plate capacitor, 380
MTF, 35, 55, 108, 121, 354, 357
Multibody systems, 416, 433
Multi-energy-domain models, 136
Multiport, 17
Nonlinear simulation, example,
198, 602
Normal modes, 482
Nozzle, 571
isentropic, 585
Open loop system, 258
Oscillator
Damped, 232
Undamped, 230
One-junction, 60
Onsager reciprocity, 351, 352
Open loop transfer function, 287
Orthogonality, 488, 496
Output variables, 10, 30, 220,
226, 259
Output/input, concept, 30
Overdamped, 232
p, momentum variable, 20
Parasitic elements, 372, 608
Perfect gas, 556, 561
Permanent magnet, 56, 141, 372,
520, 525
Permeability, 522, 528
Permeance, 522, 524, 529
Phase angle,
Pi network, 90
Plane motion, 106
Pneumatic actuator, 588, 596
Pneumatic systems, 122, 566, 575
Pneumatic tires, 446
Poles and zeros, 268
open loop
closed loop
Power, 19
Power convention, 25
Power variables, 19
Pressure:
dynamic, 122, 571
static, 122, 571
Pressure momentum, 22
Proportional control, 260
Proportional plus derivative
control, 265
Proportional plus derivative plus
integral control, 269
P, PD, PID control, 260–269
Pseudo-bond graphs, 326, 548,
578
Pump, 133, 138, 379
q, displacement variable, 20
Quarter car model, 94, 96, 108
Quarter car, simulation, 198
Real part of, 231, 233, 237
R-element 38
Reluctance, 522
Residual compliance, 501
Resistance:
controlled, 387
eletrothermal, 563
modulated, 386
Resistance causality, 350
Resistor, 38
Bernoulli, 571,595
R-ﬁeld, 326
Rigid-body motion, 412
Root locus, 273
examples, 281
Rotating frame, 118
Second-order system, 225
Semi-active damper, 392
Sensor, 259
Separation of variables, 482
Sequential causality assignment,
171
Servo-valve, hydraulic, 8, 389
Shock absorber, 156
SI units, 22

636
INDEX
Side branch accumulator, 252
Signals, input, 67
Signals, output, 67, 394
Simulation of state equations, 162
Simulation, 12
Simulation, air motor, 616
Simulation, automated, 12, 162,
612
Simulation, nonlinear, 198
Sinusoidal forcing, 244
Slider-crank mechanism, 34, 616
Slip angle 448, 468
Solenoid, 349, 383
Sorting of equations, 203
Source element, effort, 48
Source element, ﬂow, 48
Source, controlled, 88, 386
Speciﬁc heats, 42, 550, 556, 581
Speed of sound, 127
Stable systems, 235
State determined systems, 9
State equation derivation, 175
State equations, 175, 202, 219
State equations, algebraic loop,
183
State equations, explicit, 201, 601
State equations, implicit, 188,
608
State equations, linear, 167
State equations, linear, matrix
form, 167
State equations, sorting, 203
State equations, standard form,
220
State variables, 9, 170, 202
State variables, choosing, 170
State variable feedback, 296
State variables, vector, 160
Steady state response, 245
Stiffness controlled region, 500
Stiffness matrix, 330
String, vibrating, 514
Superposition, 222
Suspension, automotive, 94, 108,
198, 283
Suspension, controlled, 393
Symmetry of matrix, 331
Synchronous motors, 536
Tee network, 90
Tetrahedron of state, 21, 47
Thermal compliance, 549, 592
Thermal energy, 558
Thermal resistance, 558, 561
Thermal systems, 548, 565
Thermodynamic accumulator,
579–584
Time constant, 224
Timoshenko beam, 479, 480,
481
Transducers, 133, 136
Transducers, energy-storing,
380–385
Transducers, gyrator type, 54,
139
Transducers, magnetic, 377, 378,
532–543
Transducers, power, 372, 375,
377
Transducers, transformer, 137
Transfer functions, 239–244
closed loop, 287
examples, 249
open loop, 287
forward loop, 287
Transformation matrix, 360, 443
Transformation, Legendre, 554,
555
Transformation,
power-conserving, 418
Transformations, coordinate, 362,
416, 419
Transformations, velocity, 428
Transformer transducers, 137
Transformer, 51
Transformer, causality, 66
Transformer, modulated, 55, 56,
108, 121, 354, 356, 363,
418, 456
Transformer, multiport, 359
Trivial solution, 223, 226, 236
Undamped natural frequency,
230
Undamped oscillator, 230
Underdamped system, 232, 234
Unstable systems, 235
Valve, four-way, 389
Valve, hydraulic, 389–391, 406
Variable, displacement, 20
Variable, effort, 19
Variable, energy, 20
Variable, ﬂow, 19
Variable, momentum, 20
Variables, acoustic systems, 19
Variables, electrical systems, 24
Variables, hydraulic systems, 23
Variables, mechanical rotation, 23
Variables, mechanical translation,
20
Vector matrix form, 220
Vehicle dynamics, 411, 445
Vibration control, 301
Vibration of a bar, 472–475,
483–491
Vibration of a beam, 471–482
Viscosity, 123
Voice coil actuator, 53, 56, 139,
306, 539
Voice coil, 54
Wankel compressor or engine,
590–591
Wave equation, 475, 576
Wheatstone bridge, 83
Word bond graph, 27, 29, 35
Zero-junction, 53, 55
Zeros and poles, 268

