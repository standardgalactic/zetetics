
NUMBER THEORY 
Sailing on the Sea of Number Theory 

Vol. 1 Arithmetic Geometry and Number Theory
edited by Lin Weng & Iku Nakamura
Vol. 2 Number Theory: Sailing on the Sea of Number Theory
edited by S. Kanemitsu & J.-Y. Liu
Series on Number Theory and Its Applications
ISSN  1793-3161
Series Editor:  Shigeru Kanemitsu (Kinki University, Japan)
Editorial Board Members:
V. N. Chubarikov (Moscow State University, Russian Federation)
Christopher Deninger (Universität Münster, Germany)
Chaohua Jia (Chinese Academy of Sciences, PR China)
H. Niederreiter (National University of Singapore, Singapore)
M. Waldschmidt (Université Pierre et Marie Curie, France)
Advisory Board:
K. Ramachandra (Tata Institute of Fundamental Research, India (retired))
A. Schinzel (Polish Academy of Sciences, Poland)

Series on Number Theory and Its Applications Vol.2
NUMBER THEORY
Sailing on the Sea of Number Theory
Proceedings of the 4th China-Japan Seminar
Weihai, China 
30 August - 3 September 2006
Editors
S. KcUiemitSU (KMaUniversity, Japan)
J.-Y. 
LlU. (ShandongUniversity, China)
World Scientific
NEW JERSEY • LONDON • S I N G A P O R E • BEIJING • SHANGHAI • HONG KONG • TAIPEI • CHENNAI

British Library Cataloguing-in-Publication Data
A catalogue record for this book is available from the British Library.
For photocopying of material in this volume, please pay a copying fee through the Copyright
Clearance Center, Inc., 222 Rosewood Drive, Danvers, MA 01923, USA. In this case permission to
photocopy is not required from the publisher.
ISBN-13 978-981-270-810-6
ISBN-10 981-270-810-3
All rights reserved. This book, or parts thereof, may not be reproduced in any form or by any means,
electronic or mechanical, including photocopying, recording or any information storage and retrieval
system now known or to be invented, without written permission from the Publisher.
Copyright © 2007 by World Scientific Publishing Co. Pte. Ltd.
Published by
World Scientific Publishing Co. Pte. Ltd.
5 Toh Tuck Link, Singapore 596224
USA office:  27 Warren Street, Suite 401-402, Hackensack, NJ 07601
UK office:  57 Shelton Street, Covent Garden, London WC2H 9HE
Printed in Singapore.
Series on Number Theory and Its Applications — Vol. 2
NUMBER THEORY
Sailing on the Sea of Number Theory

v
PREFACE
The present volume is a collection of survey papers of the talks presented
at the very successful fourth China-Japan Seminar on number theory. The
seminar was held in Shandong University Academic Center, in Weihai,
Shandong, People’s Republic of China, during August 30 – September 3,
2006, under the support of Shandong University, the Japan Society for the
Promotion of Science (JSPS) and the National Natural Science Foundation
of China (NSFC). The organizers Shigeru Kanemitsu and Jianya Liu would
like to express their hearty thanks to Shandong University for their gen-
erosity and support. The title of the seminar reads “Sailing on the sea of
number theory” which suggests that we are supposed to sail freely both on
the sea of number theory and the sea of Weihai. The talks were given in a
wide conference hall looking over the sea all round and the atmosphere was
superb, and all the participants really got the feeling of sailing on the sea
of number theory and the sea of Weihai.
Weihai Sea
It should be mentioned that Ms. Nan Luo, together with other staﬀ
members of Shandong University, helped out the organizers throughout
in preparing and conducting the seminar very successfully. The organizers
also would like to thank two of their Chinese colleagues, Professors T. -
X. Cai and Z. -W. Sun for their attractions. The former read his own poem

vi
PREFACE
which has a passage referring to Pythagoras and the latter made a spot
announcement of some recent results in a live fashion.
Shandong University Academic Center (Weihai)
Traditionally, we have been publishing the collection of papers presented
at the seminars, but from this volume onwards, we are going to publish
survey papers which give good perspectives of recent progress of research
in number theory and related ﬁelds. We would like to thank the authors
of these papers for their kind cooperation regarding the preparation of
excellent manuscript and the subsequent uniﬁcation process of style, which
is to make the volume of a readable book quality.
In this volume we assemble the following papers:
1. S. Egami and K. Matsumoto, “Convolutions of the von Mangoldt
Function and Related Dirichlet Series” has the theme of analytic contin-
uation of multiple Dirichlet series of various types and their possible nat-
ural boundaries. Analytic continuation is furnished largely by means of
the Mellin-Barnes integrals which is a form of the deﬁnition of the beta-
function. The authors consider Φ2 with the coeﬃcients of the form of the
Abel convolution G2 of the von Mangoldt function as an example of a multi-
ple Dirichlet series which may have a natural boundary. They also consider
the Riesz sum of G2 and obtain an asymptotic formula.
2. K.-Q. Feng and Y. Xue, “Constructing New Non-congruent Numbers
by Graph Theory” is regarding the application of graph theory (combined
with the results on elliptic curves) to ﬁnding non-congruent numbers with
arbitrarily many prime factors. The main tools they use from elliptic curve
theory is that if the rank of the rational points of a certain elliptic curve
(with n in the coeﬃcients) is 0, then n is a non-congruent number and
this condition in turn is realized if the corresponding Selmer groups have

PREFACE
vii
the minimal sizes. This last condition is then checked on the basis of the
oddness of the suitable graphs. The reader can learn these kinds of various
facts about elliptic curves and graph theory.
3. Y. Kitaoka, “Distribution of Units of an Algebraic Number Field
Modulo an Ideal” is a massive work expounding the author’s new investi-
gation on the distribution of units modulo an ideal. Here the author com-
bines algebraic structures with an analytic output, i.e. the density etc. and
should give rise to a new fertile uncultivated land for the coming younger
generation. Uncultivated because, compared with extensive study on other
ingredients of an algebraic number ﬁeld like class numbers, the units have
not been paid much attention. Not only the ﬁeld is promising but the prob-
lem setting will be very beneﬁcial to younger scientists: Setting a problem
in algebraic aspects and incorporate analytic tools to arrive at some statis-
tical data. In the paper the reader can learn really all notions and tools in
algebraic number theory, the Frobenius automorphism, Hilbert’s ramiﬁca-
tion theory, Galois action, the ˇCebotar¨ev density theorem, and the Artin
conjecture.
4. W. Kohnen, “Sign Changes of Fourier Coeﬃcients and Eigenvalues
of Cusp Forms”. In the paper the recent results are summarized on the
sign change problem of the Fourier coeﬃcients a(n) of cusp forms f (Siegel
modular forms). The Theorem in §1 about inﬁnitely many sign changes is
proved using the Hecke L-series for f and the Rankin-Selberg zeta-function,
which motivates the study of the ﬁrst occurrence of the sign change. For a
normalized Hecke eigenform that is a new form of even integral weight k
and level N, sharp bounds for the occurrence of the ﬁrst sign change is
obtained, with or without the symmetric square L-function and the Hecke
relations, (sub-)convexity bounds, prime number theorem, etc. The same
ideas give results including sign changes in short intervals. Sign changes
for Siegel modular forms of genus 2 are also summarized. Inﬁnitely many
sign changes may not occur in general, yet there are theorems which have
similar ﬂavor as those for the elliptic modular case. The proof uses the
spinor zeta-function in place of Hecke L-series.
5. Y. -K. Lau, J. -Y. Liu and Y. -B. Ye, “Shifted Convolution Sums of
Fourier Coeﬃcients of Cusp Forms”. Let α denote the inﬁmum of the expo-
nent of t in the estimation of the Riemann zeta-function on the critical line
σ = 1/2. The GLH (Generalized Lindel¨of Hypothesis) which follows from
the GRH (Generalized Riemann Hypothesis) implies α = 0. The convexity
bound which is obtained with the aid of the Phragm´en-Lindel¨of convexity
principle is α = 1/4 and the authors call any improvement on the convex-

viii
PREFACE
ity bound a subconvexity bound, while the bound α = 1/6 which is 2/3-rd
power of convexity and is due to Weyl, is called a Weyl-like bound. The pa-
per is concerned with summarizing the research made hitherto toward these
subconvexity and Weyl-like bounds for automorphic L-functions. The au-
thors refer to the L-functions of degree n according to the degree of the
generic polynomial factor in p−s in their Euler product and after mention-
ing the degree 2 case, they present their newest Weyl-like bound for the
Rankin-Selberg L-function L(1/2+it, f ×g) formed from f, a holomorphic
Hecke eigenform for Γ0(N) of weight k (or a Maass Hecke eigenform for
Γ0(N) with Laplace eigenvalue 1/4 + k2 ) and g a ﬁxed holomorphic or
Maass cusp form for Γ0(N), or for Γ0(N ′) with (N, N ′) = 1. The Weyl-
like bound obtained is 2/3 in the weight aspect, which is expounded in
the authors’ most recent article of 78 pages. The method hinges on the
meromorphic continuation of the shifted convolution sum formed from the
Fourier coeﬃcients. In the paper, the intermediate developments toward
the above bound are explained in some detail and the reader can learn a
quite rich mixture of many new methods which have their origin in analytic
number theory and spectral theory.
6. K. Miyake, “Two Expositions on Arithmetic of Cubics”. The paper
consists of two parts. Part I is devoted to the study of cubic generic poly-
nomials R = R(t; x) and Q = Q(s; x) with parameters t and s for the
symmetric group of degree 3 and the cyclic group of order 3, respectively.
As an application, the divisibility of the class numbers of quadratic ﬁelds
by 3 is obtained. For the algebraic tools used, the reader is referred to
the recent books by G. Gras or J. Neukirch. Thus Part I motivates the
study of cubic and more generally, non-abelian ﬁelds. In Part II, two types
of families of elliptic curves are considered whose sets of rational points
over Q are described by certain subsets of cubic ﬁelds. One type is given
by u3 = u3 + au2 + bu + c whose short forms are Mordell curves, while the
other family consists of the twists of Hessian family of elliptic curves over
the splitting ﬁeld of the cubic polynomial R and also over the quadratic
ﬁeld contained in the splitting ﬁeld. Part II therefore introduces the reader
to the world of arithmetic on elliptic curves. Basic knowledge is to be found
in the textbooks of J. Silverman and of Silverman and Tate.
7. I. Shparlinski, “Distribution of Points on Modular Hyperbolas”. For a
positive integer m and an arbitrary integer a with gcd(a, m) = 1, the author
deﬁnes the modular hyperbola as xy ≡a(mod m) and designates all the
points (x, y) on it by Ha,m. The author considers the distribution and geo-
metric properties of points of Ha,m, denoted Ha,m(X, Y) whose coordinates

PREFACE
ix
x and y lie in prescribed sets of integers X and Y, respectively. Acquiring
precise asymptotic formulas and establishing positivity of #Ha,m(X, Y) for
various interesting sets have been the central theme in this area. However,
as the author writes, “there is a large number of papers which rather rou-
tinely study various problems related to Ha,m on the case by case basis.
Here, we explain some standard principles which can be used to derive these
and many other results of similar spirit about the points on Ha,m as simple
corollaries of just one general result about the uniformity of distribution
of point on Ha,m in certain domains. In §3.1, this result, Theorem 10, is
derived in a very straightforward fashion from (1.1)—the known bound of
Kloosterman sums—using some standard arguments”, and we learn one
important lesson that if one keeps doing routine work, eventually all the
result obtained will be relinquished into history’s dustbox and will not be
referred to as illustrating examples in the subsequent publications. §§2.1–
2.3 give a nice survey on a diversity of methods used to study the point on
Ha,m, and especially, it is remarked that multiplicative character sums can
sometimes give better results than Kloosterman sums.
Various applications are described as well. In particular in §5, one can
ﬁnd some interesting results, especially an unexpected result on torsion of
elliptic curves in §5.4.
8. Z. -W. Sun, “A Survey of Problems and Results on Restricted Sum-
sets”. The paper gives a useful survey on recent results in additive number
theory, now being exciting, related to combinatorics. A restricted sumset
has the form {a1 + · · · + an : a1 ∈A1, . . . , an ∈An, P(a1, ..., an) ̸= 0},
where A1, . . . , An are ﬁnite subsets of Z, or a ﬁeld or an abelian group, and
P is a suitable polynomial. The book “Additive Combinatorics” (2006) by
T. Tao and V. Vu, mainly summarizes important results on sumsets without
restrictions, obtained by various diﬀerent tools.
The author is concerned with the lower bounds for cardinalities of var-
ious sumsets obtained by algebraic methods. §1 gives rather enlightening
discussion on the powerful “polynomial method” via Alon’s “Combinato-
rial Nullstellensatz” the proof of which is given and which implies the Alon-
Nathanson-Ruzsa theorem, generalizing Dias da Silva and Hamidoune’s ex-
tension of the Erd˝os-Heilbronn conjecture. In the remaining sections one
can ﬁnd recent developments by the author and his school. The survey also
contains some open conjectures.
9. H. Tsukada, “A General Modular Relation in Analytic Number The-
ory” presents equivalent forms of the functional equation with multiple
gamma factors satisﬁed by two sets of Dirichlet series, in the form of mod-

x
PREFACE
ular relation between the corresponding two sets of H-function series, where
H-function means the Fox H-function. As far as we have checked, there is
no formula which does not come under this big umbral theorem. In the
paper, there are some illustrating examples with multiple gamma factors.
Hopefully, the theorem covers also those zeta-functions studied in the pa-
pers of Kohnen and Lau-Liu-Ye.
10. D. -Q. Wan, “L-functions of Function Fields”. Let Fq denote a ﬁnite
ﬁeld of q elements with characteristic p > 0. As a generalization of the case
of C= the projective plane, U= projective plane with the origin and inﬁnity
removed and K = Fq(t), the function ﬁeld, the following general situation
is considered: Let C denote a smooth projective geometrically connected
curve deﬁned over Fq with function ﬁeld K, with its absolute Galois group
denoted by GK and let j : U →C be a Zariski open dense subset of C.
Let Fℓbe a ﬁnite extension of Qℓ, ℓbeing a prime number. With V
a ﬁnite dimensional vector space over Fℓ, let ρ : GK →GL(V ) be a con-
tinuous representation of GK unramiﬁed on U. There are two L-functions
introduced, the L-function L(U, ρ) and the complete L-function of ρ on C,
L(C, ρ) which diﬀer by a ﬁnite number of Euler factors. The paper gives
a concise survey of recent results on analyticity of these L-functions, espe-
cially, for those representations arising from geometry. It is stated that in
the ℓ-adic case, with ℓ̸= p, all ℓ-adic representations are essentially geomet-
ric from L-function point of view including ℓ-adic function ﬁeld analogue
of Artin’s entireness conjecture. In the more complicated ℓ= p case, the
location of zeros and poles on the compact unit disc is determined and the
author’s result says that if the p-adic representation is geometric, the L-
function L(U, ρ) is p-adic meromorphic everywhere. The interested reader
can go on by reading the references given.
All in all, the interested reader can really get beneﬁted by going through
this volume and we hope we will keep doing this work of putting together
the recent developments in handy volumes.
The editors would like to express their hearty thanks to Professor Haruo
Tsukada, Dr. Jing Ma and Ms. Nan Luo for their devoted help toward
the completion of this volume. Dr. Jing Ma, especially, spent an immense
amount of time to edit the ﬁnal versions of all the papers; without her help,
the volume could not have been completed so well and in time. Professor
Haruo Tsukada kindly checked the ﬁnal version of the manuscript and made
essential improvement therein to whom the editors would like to express
their hearty gratitude. Last but not least, thanks are due to the editor of

PREFACE
xi
the World Scientiﬁc, Mrs. Ji Zhang, for her kind and timely help throughout
the preparation of the proceedings.
As usual, we end up with recording a poem describing our feeling, and
this time it is the following.
The ﬁfth China-Japan Seminar will be held in Osaka, at Kinki Univer-
sity and we do hope we’ll meet there again. Wo men xi wang zai jian dao
ni men.
Jin Gunagzi and Liu Jianya—the editors-organizers

This page intentionally left blank
This page intentionally left blank

xiii
PROGRAM
Wednesday, August 30, 2006
9:00–9:40 The Organizers,
Opening Address
Morning Session (Chair: Jianya Liu)
10:00–10:40 Andrzej Schinzel,
The Number of Solutions in a Box of a Linear Homogeneous Congruence
11:00–11:40 Shou-Wu Zhang,
Periods Integrals and Special Values of L-series
Afternoon Session (Chair: Krishnaswami Alladi)
14:30–15:00 Zhi-Wei Sun,
Curious Identities and Congruences Involving Bernoulli Polynomials
15:20–15:40 Shigeki Akiyama,
Rational Based Number System and Mahler’s Problem
15:50–16:00 Masayuki Toda,
On Gauss’ Formula for ψ and Finite Expressions for the L-series at 1
16:20–16:40 Xiumin Ren,
Estimates of Exponential Sums over Primes and Applications in Number Theory
16:50–17:05 Haruo Tsukada,
A General Modular Relation Associated with the Riemann Zeta-function
17:10–17:20 Takako Kuzumaki Kobayashi,
A Transformation Formula for Certain Lambert Series

xiv
PROGRAM
Thursday, August 31, 2006
Morning Session (Chair: Vladimir N. Chubarikov)
9:00–9:40 Krishnaswami Alladi,
New Approaches to Jacobi’s Triple Product Identity and a Quadruple Product
Extension
10:00–10:40 Trevor D. Wooley,
Waring’s Problem in Function Fields
11:00–11:40 Yangbo Ye,
A New Bound for Rankin-Selberg L-functions
Afternoon Session (Chair: Yoshio Tanigawa)
14:30–15:00 Wenpeng Zhang
The Mean Value of Dedekind Sum and Cochrane Sum in Short Intervals
15:20–15:50 Isao Wakabayashi,
Some Thue Equations and Continued Fractions
16:10–16:30 Yuk-Kam Lau,
The Error Terms in Dirichlet’s Divisor Problem, the Circle Problem and the Mean
Square Formula of the Riemann Zeta-function
16:40–17:00 Wenguang Zhai,
On the Fourth Power Moments of ∆(x) and E(t)
17:10–17:20 Tianxin Cai,
A Generalization of a Curious Congruence of Harmonic Numbers
17:40–17:50 Kentaro Ihara,
On the Structure of Algebra of Multiple Zeta Values
Saturday, September 2, 2006
Morning Session (Chair: Kohji Matsumoto)
9:00–9:40 Vladimir N. Chubarikov,
Trigonometric Sums in Number Theory, Analysis and Probability Theory
10:00–10:40 Winfried Kohnen,
Sign Changes of Fourier Coeﬃcients and Hecke Eigenvalues of Cusp Forms
11:00–11:40 Igor Shparlinski,
Exponential and Character Sums with Combinatorial Sequences
Afternoon Session (Chair: Wenpeng Zhang)
14:30–15:00 Chaohua Jia,
On a Conjecture of Yiming Long
15:10–15:40 Koichi Kawada,
On the Sum of Five Cubes of Primes
15:50–16:10 Honggang Xia,
On Zeros of Cubic L-functions
16:20–16:40 Zhiguo Liu,
A Theta Function Identity to the Quintic Base
16:50–17:05 Masaki Sudo,
On the Exponential Equations ax −by = c (1 ≤c ≤300)
17:25–17:40 Yoshinobu Nakai,
On a Function in the Biquadratic Theta-Weyl Sums
17:45–17:55 Deyu Zhang,
Zero Density Estimates for Automorphic L-functions

PROGRAM
xv
Sunday, September 3, 2006
Morning Session (Chair: Winfried Kohnen)
9:00–9:40 Daqing Wan,
L-functions of Inﬁnite Symmetric Powers
10:00–10:30 Yoshiyuki Kitaoka,
Distribution of Units of an Algebraic Number Field
10:50–11:20 Kohji Matsumoto,
The Riesz Mean of the Convolution Product of Von Mangoldt Functions and the
Related Zeta-function
11:30–12:00 Katsuya Miyake,
Twists of Hessian Elliptic Curves and Cubic Fields
Afternoon Session (Chair: Shigeru Kanemitsu)
14:30–15:00 Leo Murata,
On a Property of the Multiplicative Order of a (mod p)
15:20–15:50 Yonggao Chen,
On the Prime Power Factorization of n!
16:00–16:20 Yoshio Tanigawa,
Kronecker’s Limit Formula and the Hypergeometric Function
16:25–16:35 Guangshi L¨u,
Some Results in Classical Analytic Number Theory
16:40–16:50 Huaning Liu,
Mean Value of Dirichlet L-functions and Applications to Pseudorandom Binary
Sequences in Cryptography
16:55–17:05 Hailong Li,
The Structural Elucidation of Eisenstein’s Formula

This page intentionally left blank
This page intentionally left blank

xvii
Advisory Committee:
Professor Tao Zhan, Shandong University, China
Organizing Committee:
Professor Shigeru Kanemitsu, Kinki University, Japan
Professor Jianya Liu, Shandong University, China
Guest Speakers:
Professor Krishnaswami Alladi, University of Florida, USA
Professor Vladimir N. Chubarikov, Moscow State University, Russia
Professor Winfried Kohnen, Universitaet Heidelberg, Germany
Professor Andrzej Schinzel, Polish Academy of Sciences, Poland
Professor Igor Shparlinski, Macquarie University, Australia
Professor Daqing Wan, University of California, USA
Professor Trevor D. Wooley, University of Michigan, USA
Professor Yangbo Ye, University of Iowa, USA
Professor Shou-Wu Zhang, Columbia University, USA
Peripatetic Mathemagicians

xviii
Speakers:
Professor Shigeki Akiyama, Niigata University, Japan
Professor Tianxin Cai, Zhejiang University, China
Professor Yonggao Chen, Nanjing Normal University, China
Professor Chaohua Jia, The Chinese Academy of Sciences, China
Professor Koichi Kawada, Iwate University, Japan
Professor Yoshiyuki Kitaoka, Meijo University, Japan
Professor Yuk-Kam Lau, The University of Hong Kong, Hong Kong
Professor Zhiguo Liu, East China Normal University, China
Professor Kohji Matsumoto, Nagoya University, Japan
Professor Katsuya Miyake, Waseda University, Japan
Professor Leo Murata, Meiji-Gakuin University, Japan
Professor Yoshinobu Nakai, Yamanashi University, Japan
Professor Xiumin Ren, Shandong University, China
Professor Masaki Sudo, Seikei University, Japan
Professor Zhi-Wei Sun, Nanjing University, China
Professor Yoshio Tanigawa, Nagoya University, Japan
Professor Haruo Tsukada, Kinki University, Japan
Professor Isao Wakabayashi, Seikei University, Japan
Professor Honggang Xia, Shandong University, China
Professor Wenguang Zhai, Shandong Normal University, China
Professor Wenpeng Zhang, Northwest University, China
A Dead Heat Match
Short Communications:
Dr. Kentaro Ihara, Kinki University, Japan
Professor Takako Kuzumaki Kobayashi, Gifu University, Japan
Professor Hailong Li, Weinan Teacher’s College, China
Dr. Huaning Liu, Northwest University, China
Professor Guangshi L¨u, Shandong University, China
Mr. Masayuki Toda, Kinki University, Japan
Dr. Deyu Zhang, Shandong University, China

xix

This page intentionally left blank
This page intentionally left blank

xxi
CONTENTS
Preface
v
Program
xiii
Convolutions of the von Mangoldt Function and Related
Dirichlet Series
1
Shigeki Egami and Kohji Matsumoto
Constructing New Non-congruent Numbers by Graph Theory
24
Keqin Feng and Yan Xue
Distribution of Units of an Algebraic Number Field Modulo
an Ideal
39
Yoshiyuki Kitaoka
Sign Changes of Fourier Coeﬃcients and Eigenvalues of Cusp Forms
97
Winfried Kohnen
Shifted Convolution Sums of Fourier Coeﬃcients of Cusp Forms
108
Yuk-Kam Lau, Jianya Liu and Yangbo Ye
Two Expositions on Arithmetic of Cubics
136
Katsuya Miyake
Distribution of Points on Modular Hyperbolas
155
Igor E. Shparlinski
A Survey of Problems and Results on Restricted Sumsets
190
Zhi-Wei Sun

xxii
CONTENTS
A General Modular Relation in Analytic Number Theory
214
Haruo Tsukada
L-Functions of Function Fields
237
Daqing Wan
Index
243

1
CONVOLUTIONS OF THE VON MANGOLDT FUNCTION
AND RELATED DIRICHLET SERIES
SHIGEKI EGAMI
Faculty of Engineering, Toyama University,
Gofuku, Toyama 930-8555, Japan
E-mail: megami@eng.u-toyama.ac.jp
KOHJI MATSUMOTO
Graduate School of Mathematics, Nagoya University,
Chikusa-ku, Nagoya 464-8602, Japan
E-mail: kohjimat@math.nagoya-u.ac.jp
In this paper, we ﬁrst give a brief survey on the theory of meromorphic contin-
uation and natural boundaries of multiple Dirichlet series. Then we consider
the double Dirichlet series Φ2(s) deﬁned by the convolution of logarithmic
derivatives of the Riemann zeta-function. Especially we propose the conjecture
that Φ2(s) would have the natural boundary on ℜs = 1, and give a supportive
evidence. We further present an application of Φ2(s) to the Riesz mean, and
discuss its multiple analogues.
1. The analytic continuation of multiple Dirichlet series
Let s = σ + it be a complex variable, and P(X1, . . . , Xr) a polynomial of
complex coeﬃcients. The multiple zeta-function
ζr(s; P) =
∞
X
m1=1
· · ·
∞
X
mr=1
P(m1, . . . , mr)−s
(1.1)
was ﬁrst studied by Mellin [29,30], and independently by Barnes [5,6] for
P a linear form, at the beginning of the 20th century. Mellin proved the
meromorphic continuation of (1.1) to the whole complex plane C if all
the coeﬃcients of P have positive real parts. Several mathematicians after
Mellin proved the meromorphic continuation of (1.1) under weaker assump-
tions. At present, the assumption (H0S) introduced by Essouabri [12] is the
weakest. Essouabri [11] also pointed out that the multi-variable generaliza-

2
SHIGEKI EGAMI AND KOHJI MATSUMOTO
tion
ζr(s1, . . . , sn; P1, . . . , Pn) =
∞
X
m1=1
· · ·
∞
X
mr=1
P1(m1, . . . , mr)−s1
× · · · × Pn(m1, . . . , mr)−sn
(1.2)
of (1.1), where s1, . . . , sn ∈C and P1, . . . , Pn ∈C[X1, . . . , Xr], can be
continued meromorphically to the whole space Cn under the same type of
assumption.
A special type of multi-variable multiple series
ζEZ,r(s1, . . . , sr) =
∞
X
m1=1
· · ·
∞
X
mr=1
m−s1
1
(m1 + m2)−s2
× · · · × (m1 + · · · + mr)−sr,
(1.3)
which is called the Euler-Zagier r-fold sum, has been studied extensively in
recent years. The meromorphic continuation of (1.3) to Cr is included in the
above theorem of Essouabri [11], but [11] is unpublished. Various diﬀerent
proofs of the continuation were published by Arakawa and Kaneko [3], Zhao
[37], Akiyama, Egami and Tanigawa [1], and the second-named author [27].
The method in [27] is based on the Mellin-Barnes integral formula
(1 + λ)−s =
1
2πi
Z
(c)
Γ(s −z)Γ(z)
Γ(s)
λ−zdz
(1.4)
(where s, λ ∈C, λ ̸= 0, | arg λ| < π, ℜs > 0, 0 < c < ℜs, and the path of
integration is the vertical line from c −i∞to c + i∞), which was already
used in Mellin’s papers [29,30].
For arithmetical applications, it is important to consider various mul-
tiple Dirichlet series with arithmetical coeﬃcients. Peter [32] discussed the
analytic continuation of the series
∞
X
m1=1
· · ·
∞
X
mr=1
a1(m1) · · · ar(mr)
P(m1, . . . , mr)s ,
(1.5)
where ak(mk) (1 ≤k ≤r) are complex numbers. Actually he treated the
more general situation that P(m1, . . . , mr) in the denominator is replaced
by P(λ1(m1), . . . , λr(mr)), where λk(m) are complex numbers in a certain
ﬁxed cone on C satisfying limm→∞|λk(m)| = ∞(1 ≤k ≤r). The multi-
variable series
∞
X
m1=1
· · ·
∞
X
mr=1
f(m1, . . . , mr)
ms1
1 · · · msr
r
,
(1.6)

CONVOLUTIONS OF THE VON MANGOLDT FUNCTION
3
where f(m1, . . . , mr) is a non-negative arithmetical function, was studied
by de la Bret`eche [8].
In connection with sums of the Euler-Zagier type, multiple L-series de-
ﬁned by twisting (1.3) by Dirichlet characters have been investigated by
Goncharov [19], Arakawa and Kaneko [3,4], Akiyama and Ishikawa [2], and
Ishikawa [21,22].
More generally, we may claim that if Dirichlet series
ϕk(s) =
∞
X
m=1
ak(m)
ms
,
1 ≤k ≤r
(1.7)
behave nicely, then we can show that the multiple Dirichlet series of the
form
Φr(s1, . . . , sr; ϕ1, . . . , ϕr) =
∞
X
m1=1
· · ·
∞
X
mr=1
a1(m1)
ms1
1
a2(m2)
(m1 + m2)s2
× · · · ×
ar(mr)
(m1 + · · · + mr)sr
(1.8)
also behaves nicely. In fact, the following theorem was proved in Matsumoto
and Tanigawa [28].
Theorem 1.1 ([28]).
Assume that ϕk(s) (1 ≤k ≤r) are absolutely con-
vergent for σ > αk(> 0), can be continued meromorphically to the whole
plane C, holomorphic except for a possible pole (of order at most 1) at
s = αk, and of polynomial order in any ﬁxed strip σ1 ≤σ ≤σ2. Then
Φr(s1, . . . , sr; ϕ1, . . . , ϕr) can be continued meromorphically to the whole
space Cr, and the location of its possible singularities can be described ex-
plicitly. In particular, if all ϕk(s) are entire, then Φr(s1, . . . , sr; ϕ1, . . . , ϕr)
is also entire.
The proof of the above theorem is an analogue of the second-named
author’s proof of the meromorphic continuation of (1.3) given in [27], whose
basic tool is the Mellin-Barnes formula (1.4). The idea of applying formula
(1.4) in such a situation had been already mentioned by the ﬁrst-named
author [10] in the one-variable case.
The authors express their sincere gratitude to Professor Gautami
Bhowmik for pointing out an error in the original manuscript, and use-
ful suggestions. In particular, the form of Conjecture (B) below was ﬁrst
suggested by her.

4
SHIGEKI EGAMI AND KOHJI MATSUMOTO
2. An example of double Dirichlet series with a natural
boundary
In Theorem 1.1, there is the condition that each ϕk(s) is holomorphic except
for only one possible pole. Actually it is possible to prove a result of similar
type under the weaker condition that each ϕk(s) has ﬁnitely many poles.
However, if some of ϕk(s) has inﬁnitely many poles, the behaviour of
the multiple series Φr(s1, . . . , sr; ϕ1, . . . , ϕr) may be quite diﬀerent. The
following simple example illustrates this phenomenon. Let Λ(n) be the von
Mangoldt function, and
M(s) = −ζ′
ζ (s) =
∞
X
n=1
Λ(n)
ns ,
(2.1)
where ζ(s) is the Riemann zeta-function. Then M(s) is meromorphic in the
whole plane, and has inﬁnitely many poles because all zeros of ζ(s) are the
poles of M(s). In fact it is known that
N(T) ∼1
2π T log T,
T ≥2
(2.2)
(Theorem 9.4 of Titchmarsh [36]), where N(T) is the number of zeros
(counted with multiplicity) of ζ(s) in the region 0 < σ < 1, 0 < t ≤T,
which is expected to be equal to the number of poles of M(s) in the same
region because all zeros of ζ(s) are conjectured to be simple.
Let
Φ2(s) = Φ2(0, s; M, M) =
∞
X
k=1
∞
X
m=1
Λ(k)Λ(m)
(k + m)s .
(2.3)
This can be rewritten as
Φ2(s) =
∞
X
n=1
G2(n)
ns
,
(2.4)
where
G2(n) =
X
k+m=n
Λ(k)Λ(m).
(2.5)
The series on the right-hand side of (2.3), (2.4) is absolutely convergent for
ℜs > 2, because
G2(n) ≤
n−1
X
k=1
log k · log(n −k) ≤n(log n)2.
(2.6)
In the present paper we will show, under the assumption of certain con-
jectures, that Φ2(s) has the natural boundary on the line ℜs = 1 (Theorem

CONVOLUTIONS OF THE VON MANGOLDT FUNCTION
5
2.2 below). Therefore it seems that the behaviour of Φ2(s) is completely
diﬀerent from that of multiple series studied in [28].
The history of the investigation of natural boundaries of Dirichlet series
also goes back to the beginning of the 20th century. The analytic continua-
tion and the natural boundary of the function P
p p−s (p runs over primes)
were studied by Kluyver [23], Landau [25], and Landau and Walﬁsz [26].
In 1928, Estermann published two papers [13], [14] on natural boundaries
of Dirichlet series. In the former paper [13], he considered a certain class
of Dirichlet series which have Euler products, and gave a criterion when
the series can be continued to the whole plane and when it has the natu-
ral boundary. The continuation and natural boundaries of Euler products
were further studied in more general situations by several mathematicians
such as Dahlquist [9], Kurokawa [24]. A multi-variable generalization was
recently discussed by Bhowmik, Essouabri and Lichtin [7].
The results in the present paper give a diﬀerent direction of research
on natural boundaries of Dirichlet series. A part of the present work was
already announced on the occasion of a conference on number theory (in
honour of Professor Akio Fujii) held at Rikkyo University, Tokyo, in January
2005. On the other hand, independently of the present work, Tanigawa and
Zhai [35] have considered Dirichlet series which are more general than ours,
and have discussed the same type of problems (except for the Riesz mean).
Their proof of the claim on natural boundaries (Theorem 1.3 of [35]) seems
incomplete; some condition similar to our (B) below seems to be necessary
to verify their argument.
We mention here the number-theoretic motivation of the study of Φ2(s).
The function G2(n) deﬁned by (2.5) is a classical subject matter of number
theory, because it is connected with the famous conjecture of C. Goldbach
(that is, any even integer (≥4) can be expressed as a sum of two primes);
in fact, the conjecture implies that G2(n) > 0 for all even n ≥4. Fujii [15]
studied the mean value of G2(n) and proved that, if we assume the Riemann
hypothesis (RH) for ζ(s), then
X
n≤X
G2(n) = 1
2X2 + O(X3/2)
(2.7)
for any large positive X. In [16], Fujii improved his result to obtain
X
n≤X
G2(n) = 1
2X2 −H(X) + O((X log X)4/3)
(2.8)

6
SHIGEKI EGAMI AND KOHJI MATSUMOTO
under RH. Here
H(X) = 2
X
ρ
X1+ρ
ρ(1 + ρ),
where ρ runs over the non-trivial zeros of ζ(s), counted with multiplicity.
From the work [20] of Hardy and Littlewood it is expected that G2(n)
for even n is approximated by nS2(n), where
S2(n) =
Y
p|n
µ
1 +
1
p −1
¶
Y
(p,n)=1
µ
1 −
1
(p −1)2
¶
.
(2.9)
Moreover it follows from Lemma 1 of Montgomery and Vaughan [31] that
X
n≤X
nS2(n) = 1
2X2 + O(X log X).
(2.10)
From this viewpoint, Fujii [16] reformulated his formula (2.8) into
X
n≤X
(G2(n) −nS2(n)) = −H(X) + O((X log X)4/3).
(2.11)
Hence the term H(X) represents the main oscillation in the above formu-
lation of Goldbach’s problem. Some properties of H(X) have been studied
in Fujii [17].
By (2.4) and Perron’s formula we have
X
n≤X
G2(n) =
1
2πi
Z c+iT
c−iT
Φ2(s)Xs
s ds + O(T −1X2+ε)
(2.12)
with c > 2. Therefore the study of Φ2(s) will be useful to understand the
behaviour of G2(n). In the next section we will prove the following:
Theorem 2.1 (under RH). The function Φ2(s) can be continued mero-
morphically to the half-plane ℜs > 1, and holomorphic except for the simple
poles at s = 2 (with residue 1) and s = 1 + ρ (with residue −2n(ρ)/ρ) for
any non-trivial zero ρ of ζ(s), where n(ρ) is the multiplicity of ρ.
By this theorem, we can shift (under RH) the path of integration on the
right-hand side of (2.12) to ℜs = 1 + ε. We encounter the poles s = 2 and
s = 1+ρ, and the sum of their residues is (1/2)X2 −H(X), which coincides
with the explicit terms on the right-hand side of (2.8). In particular, we ﬁnd
that the properties of H(X) are closely connected with the behaviour of
Φ2(s) on the line ℜs = 3/2.

CONVOLUTIONS OF THE VON MANGOLDT FUNCTION
7
Next we consider the behaviour of Φ2(s) on the line ℜs = 1. We propose
the following:
Conjecture 2.1. The line ℜs = 1 is the natural boundary of Φ2(s).
In the present paper we will show an evidence which supports the above
conjecture. Let I be the set of all imaginary parts of non-trivial zeros of
ζ(s). A well-known conjecture speculates that the positive elements of I
would be linearly independent over the rationals. The following statement
is a special case of this conjecture:
(A) If γj ∈I (1 ≤j ≤4) and γ1 + γ2 = γ3 + γ4(̸= 0), then (γ3, γ4)
equals (γ1, γ2) or (γ2, γ1).
These conjectures were mentioned on p.50 of Fujii [18]. In that paper
Fujii made an extensive study on additive properties of the zeros of ζ(s).
For instance he proved that the set
{γ1 + γ2 | γ1, γ2 ∈I, γ1 > 0, γ2 > 0}
is uniformly distributed mod 1 (Corollary 3 of [18]).
Here we introduce the following quantitative version of (A):
(B) There exists a constant α, with 0 < α < π/2, such that if γj ∈I
(1 ≤j ≤4), γ1 + γ2 ̸= 0, and (γ3, γ4) is neither equal to (γ1, γ2) nor to
(γ2, γ1), then
|(γ1 + γ2) −(γ3 + γ4)| ≥exp (−α(|γ1| + |γ2| + |γ3| + |γ4|)) .
(2.13)
Clearly (B) implies (A).
In §4 of the present paper we will prove that, under RH, the set
K = {κ | κ = γ1 + γ2 for some γ1, γ2 ∈I} \ {0}
(2.14)
is dense in the whole set of real numbers R. This result will yield the
following theorem.
Theorem 2.2 (under RH). If we assume that (B) is true, then Conjec-
ture 1 is true.
Hence the continuation achieved by Theorem 1.1 seems to be best-
possible. It is therefore not rash to propose the following
Conjecture 2.2. The error term on the right-hand side of (2.8) is to be
O(X1+ε) and Ω(X), where Ω(X) means that it is not o(X).

8
SHIGEKI EGAMI AND KOHJI MATSUMOTO
3. Proof of Theorem 2.1
In this section we prove Theorem 2.1. First we assume ℜs > 2 + 2ε. Then
we have
Φ2(s) =
∞
X
k=1
∞
X
m=1
Λ(k)Λ(m)
(k + m)s
=
∞
X
k=1
∞
X
m=1
Λ(k)Λ(m)
ks
³
1 + m
k
´−s
.
(3.1)
We apply the Mellin-Barnes formula (1.4) with λ = m/k to (3.1) to obtain
Φ2(s) =
∞
X
k=1
∞
X
m=1
Λ(k)Λ(m)
ks
1
2πi
Z
(c)
Γ(s −z)Γ(z)
Γ(s)
³m
k
´−z
dz
=
1
2πi
Z
(c)
Γ(s −z)Γ(z)
Γ(s)
∞
X
k=1
Λ(k)k−s+z
∞
X
m=1
Λ(m)m−zdz.
(3.2)
Two inﬁnite series in the integrand are convergent when σ−c > 1 and c > 1.
These conditions, and also the condition 0 < c < σ (which is necessary to
apply (1.4)), are satisﬁed by the choice c = 1 + ε. Under this choice of c,
we have
Φ2(s) =
1
2πi
Z
(c)
Γ(s −z)Γ(z)
Γ(s)
M(s −z)M(z)dz.
(3.3)
The next step is to shift the path of integration from ℜz = c = 1 + ε to
ℜz = −ε. First we have to show that this shifting is possible. It is known
that
N(T + 1) −N(T) ≪log T
(3.4)
for any T ≥2, where f ≪g means f = O(g) (Theorem 9.2 of Titchmarsh
[36]). Hence we can ﬁnd an arbitrarily large T such that
|T −γ| ≫(log T)−1
(3.5)
for any γ ∈I. Combining (3.5) with the formula
M(z) = −
X
|y−γ|<1
1
z −ρ + O(log(|y| + 2)),
y = ℑz, γ = ℑρ,
(3.6)
which is known to hold uniformly for −1 ≤x = ℜz ≤2 (Theorem 9.6(A)
of [36]), we see that, if T satisﬁes (3.5), then
M(z) ≪(log T)2
(3.7)

CONVOLUTIONS OF THE VON MANGOLDT FUNCTION
9
for z = x + iT, −1 ≤x ≤2. Also, M(s −z) = O(1) for −ε ≤x ≤1 + ε.
Hence, using Stirling’s formula, we have
Z 1+ε+iT
−ε+iT
Γ(s −z)Γ(z)
Γ(s)
M(s −z)M(z)dz ≪e−(π/2)(T +|t−T |−|t|)
×(|t −T| + 1)σ−1/2(log T)2
(|t| + 1)σ−1/2T 1/2
Z 1+ε
−ε
(|t −T| + 1)−xT xdx
(3.8)
for any T satisfying (3.5), and (3.8) tends to 0 as T tends to inﬁnity. This
implies that the above shifting is possible.
In the course of this shifting, we encounter the poles z = 1, z = ρ for
any non-trivial zero, and z = 0. The residues of the integrand at those poles
are
M(s −1)
s −1
,
−n(ρ)Γ(s −ρ)Γ(ρ)
Γ(s)
M(s −ρ)
and
M(s)M(0) = −M(s) log 2π,
respectively. Hence we obtain
Φ2(s) = M(s −1)
s −1
−
X
ρ
Γ(s −ρ)Γ(ρ)
Γ(s)
M(s −ρ) −M(s) log 2π
+ 1
2πi
Z
(−ε)
Γ(s −z)Γ(z)
Γ(s)
M(s −z)M(z)dz.
(3.9)
Now we continue Φ2(s) meromorphically by using (3.9). The ﬁrst and
the third terms on the right-hand side of (3.9) are clearly meromorphic on
the whole plane. The poles of the third term coincide with the poles of
M(s), which are s = 1 and s = ρ (non-trivial zeros). The poles of the ﬁrst
term are s = 2, s = ρ+1, and s = 1. The residues of the ﬁrst term at s = 2
and s = ρ + 1 are 1 and −n(ρ)/ρ, respectively.
The integral on the right-hand side of (3.9) is convergent uniformly in
any compact subset of the half-plane ℜs > 1−ε, and hence holomorphic in
that half-plane. Actually it is possible to continue this integral meromor-
phically to the whole plane, by shifting the path further to the left.
The most diﬃcult part is the second term
B2(s) = −
X
ρ
Γ(s −ρ)Γ(ρ)
Γ(s)
M(s −ρ).
(3.10)
The factor Γ(s −ρ) has poles at s = ρ −ℓ(ℓ= 0, 1, 2, . . .), while the factor
M(s −ρ) has poles at s = ρ + 1 and at s = ρ + ρ′, where ρ′ denotes the

10
SHIGEKI EGAMI AND KOHJI MATSUMOTO
non-trivial zeros of ζ(s). In order to control this situation, we now assume
RH (to the end of this section). Then the only poles of B2(s) in the region
ℜs > 1 are s = ρ + 1 for non-trivial zeros ρ, and the residue there is
−n(ρ)Γ(1)Γ(ρ)
Γ(ρ + 1) = −n(ρ)
ρ
.
These poles are isolated singularities, and hence B2(s) can be continued to
ℜs > 1. This implies the meromorphic continuation of Φ2(s) to ℜs > 1.
The residue of Φ2(s) at s = 2 is 1, and at s = 1 + ρ is
−n(ρ)
ρ
−n(ρ)
ρ
= −2n(ρ)
ρ
.
Now the proof of Theorem 2.1 is complete.
4. Proof of Theorem 2.2
To prove Theorem 2.2, we use the classical explicit formula
M(s) = b +
1
s −1 + 1
2
Γ′
Γ
³s
2 + 1
´
−
X
ρ
µ
1
s −ρ + 1
ρ
¶
,
(4.1)
where b = 1 + (C0/2) −log 2π and C0 is Euler’s constant (formula (2.12.7)
of [36]). Substituting this into (3.10), for ℜs > 1 we obtain
B2(s) = −
X
ρ
Γ(s −ρ)Γ(ρ)
Γ(s)
½
b +
1
s −ρ −1 + 1
2
Γ′
Γ
µs −ρ
2
+ 1
¶¾
+
X
ρ
X
ρ′
Γ(s −ρ)Γ(ρ)
Γ(s)
µ
1
s −ρ −ρ′ + 1
ρ′
¶
= B21(s) + B22(s),
(4.2)
say. Clearly B21(s) is meromorphic on the whole plane, and has no pole on
the line ℜs = 1. To investigate B22(s), we assume RH (to the end of this
section), and rewrite ρ = ρ1 = 1/2 + iγ1 and ρ′ = ρ2 = 1/2 + iγ2 to obtain
B22(s) =
1
Γ(s)
X
ρ1
X
ρ2
Γ(s + 1 −ρ1)Γ(ρ1)
(s −ρ1 −ρ2)ρ2
,
ℜs > 1.
(4.3)
Therefore B22(s) may behave singularly as s tends to ρ1 + ρ2, that is, any
point of the form 1 + iκ with κ ∈K (where K is the set deﬁned by (2.14)).
Before studying this phenomenon closely, we ﬁrst prove
Lemma 4.1 (under RH). The set K is dense in R.

CONVOLUTIONS OF THE VON MANGOLDT FUNCTION
11
Proof.
It is classically known that
N(T) = 1
2π T log T −C1T + O(log T),
C1 = 1 + log 2π
2π
(Theorem 9.4 of [36]), and, under RH, the error term in the above formula
can be replaced by O(log T/ log log T) (Theorem 14.13 of [36]). Therefore,
for any ﬁxed h ∈R, the number of zeros on the interval (1/2 + iT, 1/2 +
i(T + h)] is
1
2π (T + h) log(T + h) −C1(T + h)
(4.4)
−1
2π T log T + C1T + O
µ
log T
log log T
¶
= 1
2π T
½
log T + log
µ
1 + h
T
¶¾
+ 1
2π h
½
log T + log
µ
1 + h
T
¶¾
−C1h −1
2π T log T + O
µ
log T
log log T
¶
= h
2π log T + O
µ
log T
log log T
¶
.
There exists a suﬃciently large T0 = T0(h), such that the right-hand side of
(4.4) is positive for any T ≥T0. Let α be any non-zero real number, and ε
be arbitrarily small. Then, by using this positivity, we can ﬁnd a suﬃciently
large T = T(α, ε) and γ1, γ2 ∈I, satisfying
γ1 ∈(T + α −ε/2, T + α + ε/2],
γ2 ∈(−T −ε/2, −T + ε/2].
Hence |α−(γ1+γ2)| < ε. Moreover, if ε < |α|, then γ2 ̸= −γ1, so γ1+γ2 ∈K.
Thus we conclude the assertion of the lemma.
In view of the above lemma we now know that the points of the form
1+iκ (κ ∈K) are dense on the line ℜs = 1. Now we assume (B), and prove
the following
Lemma 4.2 (under RH and (B)). For any κ ∈K, the function B22(s)
tends to inﬁnity as s tends to 1 + iκ from the right.
Proof.
By (A) we see that there is only one pair (γ0
1, γ0
2) (and its reverse-
ordered pair (γ0
2, γ0
1) ) satisfying γ0
1 + γ0
2 = κ. Put ρ0
1 = (1/2) + iγ0
1, ρ0
2 =

12
SHIGEKI EGAMI AND KOHJI MATSUMOTO
(1/2) + iγ0
2. Then
B22(s) = n(ρ0
1)n(ρ0
2)
Γ(s)
½Γ(s + (1/2) −iγ0
1)Γ((1/2) + iγ0
1)
(s −1 −iγ0
1 −iγ0
2)((1/2) + iγ0
2)
+Γ(s + (1/2) −iγ0
2)Γ((1/2) + iγ0
2)
(s −1 −iγ0
1 −iγ0
2)((1/2) + iγ0
1)
¾
+
1
Γ(s)
X
γ1
X
γ2
∗Γ(s + 1 −ρ1)Γ(ρ1)
(s −ρ1 −ρ2)ρ2
= B∗
22(s) + B∗∗
22(s),
say, where the symbol P P∗means the sum over all (γ1, γ2) satisfying
(γ1, γ2) ̸= (γ0
1, γ0
2), (γ0
2, γ0
1). Then B∗
22(s) is meromorphic on the whole
plane, and its residue at s = 1 + iκ = 1 + i(γ0
1 + γ0
2) is
n(ρ0
1)n(ρ0
2)
Γ(1 + iκ)
½Γ((3/2) + i(κ −γ0
1))Γ((1/2) + iγ0
1)
(1/2) + iγ0
2
(4.5)
+Γ((3/2) + i(κ −γ0
2))Γ((1/2) + iγ0
2)
(1/2) + iγ0
1
¾
= 2n(ρ0
1)n(ρ0
2)
Γ(1 + iκ) Γ(ρ0
1)Γ(ρ0
2),
which does not vanish. That is, B∗
22(s) →∞as s →1 + iκ. Therefore the
remaining task is to show that B∗∗
22(s) remains ﬁnite as s →1+iκ. Putting
s = 1 + η + iκ (η ≥0, small), we have
B∗∗
22(1 + η + iκ) =
1
Γ(1 + η + iκ)
(4.6)
×
X
γ1
X
γ2
∗Γ((3/2) + η + i(κ −γ1))Γ((1/2) + iγ1)
(η + i(κ −γ1 −γ2))((1/2) + iγ2)
.
To prove the lemma, it is enough to show that the right-hand side of
(4.6) is absolutely convergent, uniformly in η. By using Stirling’s formula
we have
B∗∗
22(1 + η + iκ) ≪
1
Γ(1 + η + iκ)
X
γ1
(|κ −γ1| + 1)1+η
×e−(π/2)(|κ−γ1|+|γ1|)X
γ2
∗
1
|κ −γ1 −γ2|(1 + |γ2|).
(4.7)
The inner sum on the right-hand side of (4.7) can be divided into
X
0<|γ2−λ|≤1
+
X
|γ2−λ|>1
= Σ1 + Σ2,

CONVOLUTIONS OF THE VON MANGOLDT FUNCTION
13
say, where λ = κ −γ1. If λ = 0, then obviously Σ2 = O(1). If λ > 0, we
divide Σ2 as
Σ2 =
X
γ2>λ+1
+
X
o<γ2<λ−1
+
X
γ2<0
= Σ21 + Σ22 + Σ23,
say. The sum Σ23 is clearly O(1), while by using partial summation and
(2.2) we can easily show that Σ21, Σ22 are O(log(λ + 1)). The case λ < 0
can be treated similarly. The conclusion is that
Σ2 = O(log(|κ −γ1| + 1)).
(4.8)
Next consider Σ1. Since 0 < |γ2 −λ| ≤1, we have 1 + |γ2| ≫1 + |λ|.
Hence
Σ1 ≪
1
1 + |λ|
X
0<|γ2−λ|≤1
1
|κ −γ1 −γ2|.
Then, since κ = γ0
1 + γ0
2, applying assumption (B) we have
Σ1 ≪
1
1 + |λ|
X
0<|γ2−λ|≤1
exp
¡
α(|γ1| + |γ2| + |γ0
1| + |γ0
2|)
¢
≪
1
1 + |λ| exp
¡
α(|γ1| + |λ| + |γ0
1| + |γ0
2|)
¢
X
0<|γ2−λ|≤1
1,
where we have used |γ2| ≤|λ| + 1. Applying (3.4) we obtain
Σ1 ≪log(1 + |λ|)
1 + |λ|
exp
¡
α(|γ1| + |λ| + |γ0
1| + |γ0
2|)
¢
.
(4.9)
Substituting (4.8) and (4.9) into (4.7), we ﬁnd that
B∗∗
22(1 + η + iκ) ≪exp
¡
α(|γ0
1| + |γ0
2|)
¢
Γ(1 + η + iκ)
X
γ1
(|κ −γ1| + 1)1+η
× log(|κ −γ1| + 1) exp
³³
α −π
2
´
(|γ1| + |κ −γ1|)
´
,
(4.10)
which is absolutely convergent because α < π/2. Hence the assertion of
Lemma 4.2 follows.
From Lemma 4.1 and Lemma 4.2 we can conclude that singular points
of Φ2(s) are distributed densely on the line ℜs = 1. In fact, (4.5) implies
Φ2(s) ∼
2
Γ(1 + iκ)n(ρ0
1)n(ρ0
2)Γ(ρ0
1)Γ(ρ0
2)
1
s −(1 + iκ)
(4.11)
as s →1 + iκ. This completes the proof of Theorem 2.2.

14
SHIGEKI EGAMI AND KOHJI MATSUMOTO
5. An application to the Riesz mean
At present the authors have no idea how to prove the desired estimate
O(X1+ε) of Conjecture 2.2. Instead, in this section we consider the Riesz
mean of G2(n), that is,
D2,a(X) =
1
Γ(a + 1)
X
n≤X
(X −n)aG2(n),
(5.1)
where a > 0. The treatment of D2,a(X) becomes easier when a becomes
larger. The aim of this section is to prove the following theorem.
Theorem 5.1 (under RH). For any a > 1/2, the asymptotic formula
D2,a(X) =
1
Γ(3 + a)X2+a −
X
ρ
2Γ(1 + ρ)
ρΓ(2 + ρ + a)X1+ρ+a
+ O(X1+a+ε)
(5.2)
holds.
If (5.2) would hold for a = 0, then it would give (2.8) with the desired
error estimate O(X1+ε).
The basic tool for the proof of Theorem 5.1 is the Mellin transformation
formula
D2,a(X) =
1
2πi
Z
(2+ε)
Γ(s)
Γ(s + a + 1)Φ2(s)Xs+ads.
(5.3)
In order to obtain (5.2), we shift the path of integration on the right-
hand side of (5.3) to the left. By Theorem 2.1 we know that Φ2(s) can be
continued to ℜs > 1. Therefore we shift the path to ℜs = 1 + ε. To check
that this shifting procedure is possible, we need the following lemma.
Lemma 5.1 (under RH). There exists an arbitrarily large T for which
the estimate
Φ2(s) ≪T 1/2(log T)2
(5.4)
holds for s = σ + iT, 1 + ε ≤σ ≤2 + ε.
Proof.
We estimate each term on the right-hand side of (3.9) for 1 + ε ≤
σ ≤2 + ε.
First we do not assume RH, and let T = ℑs be any suﬃciently large
positive number. Since M(s) is absolutely convergent for σ ≥1+ε, we have
M(s) log 2π = O(1),
1 + ε ≤σ ≤2 + ε.
(5.5)

CONVOLUTIONS OF THE VON MANGOLDT FUNCTION
15
Next, denote the integral term on the right-hand side of (3.9) by I2(s).
From (3.6) we have
M(−ε + iy) ≪
X
|y−γ|<1
1 + O(log(|y| + 2)) ≪log(|y| + 2),
(5.6)
where in the second inequality we have used (3.4). It is clear that M(s −
(−ε+iy)) = O(1) for 1+ε ≤σ ≤2+ε. Using these estimates and Stirling’s
formula, we ﬁnd that
I2(s) ≪e(π/2)T T 1/2−σ
Z ∞
−∞
e−(π/2)(|y|+|T −y|)
(5.7)
× (|T −y| + 1)σ+ε−1/2(|y| + 1)−ε−1/2 log(|y| + 1)dy
= e(π/2)T T 1/2−σ
ÃZ 0
−∞
+
Z T
0
+
Z ∞
T
!
= e(π/2)T T 1/2−σ(J1 + J2 + J3),
say. By changing y by −y, we see that
J1 = e−(π/2)T
Z ∞
0
e−πy(T + y + 1)σ+ε−1/2(y + 1)−ε−1/2 log(y + 1)dy.
Divide the last integral into two parts at y = T. In the interval [0, T]
we use T + y + 1 ≍T to conclude that the integral from 0 to T is
O(T σ+ε−1/2). The integral from T to ∞is of exponential decay. Hence
J1 ≪e−(π/2)T T σ+ε−1/2. As for J3, changing y −T by y we obtain
J3 = e−(π/2)T
Z ∞
0
e−πy(y + 1)σ+ε−1/2(T + y + 1)−ε−1/2 log(T + y + 1)dy.
Dividing the integral at y = T and proceeding similarly to the case of J1,
we ﬁnd that J3 ≪e−(π/2)T T −ε−1/2 log T. Lastly, dividing at y = T/2 we
ﬁnd that
J2 ≪e−(π/2)T
(Z T/2
0
T σ+ε−1/2(y + 1)−ε−1/2 log(y + 1)dy
+
Z T
T/2
(T −y + 1)σ+ε−1/2T −ε−1/2 log Tdy
)
≪e−(π/2)T T σ log T.
Substituting these estimates into (5.7), we obtain
I2(s) = O(T 1/2 log T).
(5.8)

16
SHIGEKI EGAMI AND KOHJI MATSUMOTO
In order to treat the second term B2(s) on the right-hand side of (3.9),
we now assume RH (to the end of this section). Then from (3.6) we have
M(s −ρ) = M
µ
σ −1
2 + I(T −γ)
¶
(5.9)
= −
X
γ′
|T −γ−γ′|<1
1
σ −1 + i(T −γ −γ′) + O(log(|T −γ| + 1))
≪
X
γ′
|T −γ−γ′|<1
1 + O(log(|T −γ| + 1))
≪log(|T −γ| + 1)
(using (3.4) for the last inequality) for 1+ε ≤σ ≤2+ε, where γ′ runs over
all imaginary parts of non-trivial zeros of ζ(s) satisfying |T −γ −γ′| < 1.
By using Stirling’s formula and (5.9), we have
B2(s) ≪e(π/2)T T 1/2−σ
(5.10)
×
X
ρ
e−(π/2)(|γ|+|T −γ|)(|T −γ| + 1)σ−1 log(|T −γ| + 1)
= e(π/2)T T 1/2−σ

X
γ<0
+
X
0<γ≤T
+
X
γ>T


= e(π/2)T T 1/2−σ(C1 + C2 + C3),
say. We can estimate Cj analogously to the case of Jj (j = 1, 2, 3). As for
C1, changing γ by −γ, we obtain
C1 = e−(π/2)T X
γ>0
e−πγ(T + γ + 1)σ−1 log(T + γ + 1).
Divide the last sum into two parts corresponding to 0 < γ ≤T and γ > T,
respectively. Using partial summation and (2.2), we ﬁnd that the ﬁrst sum
is O(T σ−1 log T) and the second sum is of exponential decay. Hence C1 ≪
e−(π/2)T T σ−1 log T. The treatment of C3 is even simpler than that of J3;
by partial summation and (2.2) we have
C3 = e(π/2)T X
γ>T
e−πγ(γ −T + 1)σ−1 log(T −γ + 1)
≪e(π/2)T
Z ∞
T
ξ log ξ · e−πξ(ξ −T + 1)σ−1 log(ξ −T + 1)dξ
≪e−(π/2)T T σ(log T)2.

CONVOLUTIONS OF THE VON MANGOLDT FUNCTION
17
Lastly, dividing C2 into two parts corresponding to 0 < γ ≤T/2 and
T/2 < γ ≤T, and applying partial summation and (2.2), we obtain C2 ≪
e−(π/2)T T σ(log T)2. Therefore
B2(s) = O(T 1/2(log T)2).
(5.11)
Now the only remaining term on the right-hand side of (3.9) is the ﬁrst
term M(s −1)/(s −1). For the purpose of estimating this term suitably,
we now specify T; we choose the same T as in (3.5), and put s = σ + iT.
Then from (3.6) we obtain
M(s −1) = M(σ −1 + iT) = O((log T)2).
(5.12)
From (5.5), (5.8), (5.11) and (5.12), the assertion of Lemma 5.1 follows.
In the above proof, the special choice of T is necessary only for obtaining
(3.5). But (3.5) is required only when σ −1 is near 1/2. In fact, if σ /∈
(3/2 −ε, 3/2 + ε), then just using (3.6) we obtain M(s−1) ≪log T for any
T (under RH). Therefore we obtain
Lemma 5.2 (under RH). The estimate (5.4) of Lemma 5.1 is valid for
any T if 1 + ε ≤σ ≤3/2 −ε or 3/2 + ε ≤σ ≤2 + ε.
Remark 5.1. The estimate of Lemma 5.1 can be improved for 3/2 + ε ≤
σ ≤2 + ε. In fact, from Lemma 5.2 we have
Φ2((3/2) + ε + iT) ≪T 1/2(log T)2
for any T. It is clear that Φ2(2 + ε + iT) = O(1). Moreover from Theorem
2.1 we know that Φ2(s) is holomorphic (except for s = 2) in the region
3/2+ε ≤σ ≤2+ε. Therefore by the Phragm´en-Lindel¨of convexity principle
we obtain
Φ2(σ + iT) ≪
³
T 1/2(log T)2´2(2+ε−σ)
≪T 2−σ+ε
(5.13)
for any T when 3/2 + ε ≤σ ≤2 + ε (under RH).
Now we complete the proof of Theorem 5.1. Choose T as in Lemma 5.1,
and write (5.3) as
D2,a(X) = lim
T →∞
1
2πi
Z 2+ε+iT
2+ε−iT
Γ(s)
Γ(s + a + 1)Φ2(s)Xs+ads.
(5.14)
Deform the path into the oriented polygonal path joining 2+ε−iT, 1+ε−iT,
1+ε+iT, and 2+ε+iT. By using Lemma 5.1 and Stirling’s formula we see

18
SHIGEKI EGAMI AND KOHJI MATSUMOTO
that the integrand is O(T −a−1/2(log T)2Xσ+a) on the horizontal segments,
and hence the integrals on these segments vanish as T →∞. On the line
ℜs = 1 + ε, estimate (5.4) is valid for any T by Lemma 5.2. Hence, as
T →∞, the integral on the line ℜs = 1 + ε is
≪
Z ∞
−∞
T −a−1/2(log T)2X1+ε+adT ≪X1+ε+a
if a > 1/2. Therefore we can shift the path of integration on the right-hand
side of (5.3) to ℜs = 1 + ε if a > 1/2. The relevant poles are at s = 2 and
s = 1 + ρ, the residues at which are
1
Γ(3 + a)X2+a,
−
Γ(1 + ρ)
Γ(2 + ρ + a) · 2n(ρ)
ρ
· X1+ρ+a,
respectively. The assertion of Theorem 5.1 now follows.
Remark 5.2. From the case a = 1 of Theorem 5.1, with the aid of (2.6),
we can deduce
X
n≤X
G2(n) = 1
2X2 −H(X) + O(X3/2+ε)
(5.15)
(under RH) by the standard diﬀerence-operator argument. However this is
weaker than Fujii’s result (2.8).
6. The multiple case
So far we have mainly discussed the double Dirichlet series Φ2(s), but it is
possible to consider the multiple case in an analogous manner. Let
Gr(n) =
X
k1+···+kr=n
Λ(k1) · · · Λ(kr),
r ≥2
(6.1)
and
Φr(s) =
∞
X
n=1
Gr(n)
ns
=
∞
X
k1=1
· · ·
∞
X
kr=1
Λ(k1) · · · Λ(kr)
(k1 + · · · + kr)s .
(6.2)
Similarly to (2.6) we have Gr(n) ≤nr−1(log n)r, and hence the series (6.2)
is absolutely convergent for ℜs > r. In this section we prove some analytic
properties of Φr(s).
It is to be noted that in the paper [32] quoted in §1, Peter considered
the more general series
Sr(s) =
∞
X
k1=1
· · ·
∞
X
kr=1
Λ(k1) · · · Λ(kr)
P(k1, . . . , kr)s

CONVOLUTIONS OF THE VON MANGOLDT FUNCTION
19
for the purpose of evaluating
X
P (k1,...,kr)≤X
Λ(k1) · · · Λ(kr).
(6.3)
The reason why Peter’s method can treat Sr(s) is that his method is based
on the idea of Sargos [33,34], which can be applied to the case when the
associated single series has inﬁnitely many poles. By using the Tauberian
theorem of Ikehara, Peter proved a certain asymptotic formula for (6.3).
The ﬁrst purpose of this section is to show the following:
Theorem 6.1 (under RH). The function Φr(s) (r ≥2) can be continued
meromorphically to ℜs > r−1, and holomorphic there except for the simple
poles at s = r and s = r −1 + ρ for all non-trivial zeros ρ of ζ(s). The
residues at s = r and s = r −1 + ρ are
1
(r −1)!,
−
r · n(ρ)
ρ(1 + ρ) · · · (r −2 + ρ),
respectively.
Proof. We prove this theorem by induction on r. When r = 2, this theorem
is exactly Theorem 2.1. Assume that the theorem is true for r−1. Applying
(1.4) to (6.2), we obtain
Φr(s) =
1
2πi
Z
(c)
Γ(s −z)Γ(z)
Γ(s)
Φr−1(s −z)M(z)dz
(6.4)
for ℜs > r, where 1 < c < ℜs −(r −1). Shift the path of integration to
ℜz = −ε. By using the same T as in (3.5), we can show that this shifting
is possible. (Note that in the strip −ε ≤ℜz ≤c the factor Φr−1(s −z) is in
the domain of its absolute convergence, hence is O(1).) The result is that
Φr(s) = Φr−1(s −1)
s −1
−
X
ρ
Γ(s −ρ)Γ(ρ)
Γ(s)
Φr−1(s −ρ)
(6.5)
−Φr−1(s) log 2π +
1
2πi
Z
(−ε)
Γ(s −z)Γ(z)
Γ(s)
Φr−1(s −z)M(z)dz.
Under the induction assumption, this expression gives the continuation of
Φr(s) to ℜs > r −1. Moreover, the residues of Φr−1(s−1)/(s−1) at s = r,
s = r −1 + ρ are
1
(r −1)!,
−
(r −1)n(ρ)
ρ(1 + ρ) · · · (r −2 + ρ),

20
SHIGEKI EGAMI AND KOHJI MATSUMOTO
respectively, while the residue of
Br(s) = −
X
ρ
Γ(s −ρ)Γ(ρ)
Γ(s)
Φr−1(s −ρ)
at s = r −1 + ρ is
−n(ρ) · Γ(r −1)Γ(ρ)
Γ(r −1 + ρ) ·
1
(r −2)! = −
n(ρ)
ρ(1 + ρ) · · · (r −2 + ρ).
Hence the assertion of Theorem 6.1 follows.
The function Φr−1(s −ρ) is singular at s = r −2 + ρ + ρ′ for any
non-trivial zero ρ′. Hence, in view of Lemma 4.1, it is natural to raise the
following:
Conjecture 6.1. The line ℜs = r −1 is the natural boundary of Φr(s).
In fact, under a certain assumption, we can show that
Φr(s) ∼
r(r −1)
Γ(r −1 + iκ)n(ρ0
1)n(ρ0
2)Γ(ρ0
1)Γ(ρ0
2)
1
s −(r −1 + iκ)
(6.6)
as s →r −1 + iκ for any κ = γ0
1 + γ0
2 ∈K. This implies, as in the proof of
Theorem 2.2, that Conjecture 6.1 is true.
When r = 2, (6.6) is nothing but (4.11), which has been shown under
RH and (B).
We prove (6.6) for general r by induction. When s →r−1+iκ, we have
Φr−1(s −1)
s −1
∼(r −1)(r −2)
Γ(r −2 + iκ) n(ρ0
1)n(ρ0
2)Γ(ρ0
1)Γ(ρ0
2)
(6.7)
×
1
r −2 + iκ
1
(s −1) −(r −2 + iκ)
= (r −1)(r −2)
Γ(r −1 + iκ) n(ρ0
1)n(ρ0
2)Γ(ρ0
1)Γ(ρ0
2)
1
s −(r −1 + iκ)
by induction assumption. Next, we divide Br(s) as
Br(s) = −n(ρ0
1)Γ(s −ρ0
1)Γ(ρ0
1)
Γ(s)
Φr−1(s −ρ0
1)
(6.8)
−n(ρ0
2)Γ(s −ρ0
2)Γ(ρ0
2)
Γ(s)
Φr−1(s −ρ0
2)
−
X
ρ̸=ρ0
1,ρ0
2
Γ(s −ρ)Γ(ρ)
Γ(s)
Φr−1(s −ρ)
= Br1(s) + Br2(s) + Br3(s),

CONVOLUTIONS OF THE VON MANGOLDT FUNCTION
21
say. The factor Φr−1(s −ρ0
1) has a pole at s = r −1 + iκ = r −2 + ρ0
1 + ρ0
2,
whose residue is given by Theorem 6.1. Therefore
Br1(s) ∼−n(ρ0
1)Γ(r −2 + ρ0
2)Γ(ρ0
1)
Γ(r −1 + iκ)
×
µ
−
(r −1)n(ρ0
2)
ρ0
2(1 + ρ0
2) · · · (r −3 + ρ0
2)
¶
1
s −(r −1 + iκ)
=
r −1
Γ(r −1 + iκ)n(ρ0
1)n(ρ0
2)Γ(ρ0
1)Γ(ρ0
2)
1
s −(r −1 + iκ)
as s →r −1 + iκ. The asymptotic behaviour of Br2(s) when s →r −1 + iκ
is exactly the same. Therefore, if we assume
(C)r The sum Br3(s) remains ﬁnite when s →r −1 + iκ,
then we have
Br(s) ∼
2(r −1)
Γ(r −1 + iκ)n(ρ0
1)n(ρ0
2)Γ(ρ0
1)Γ(ρ0
2)
1
s −(r −1 + iκ)
(6.9)
as s →r−1+iκ. From (6.5), (6.7) and (6.9), we obtain (6.6), which implies
the following:
Theorem 6.2 (under RH). If we assume that (B) and (C)k (k ≤r) are
true, then Conjecture 6.1 is true.
References
1. S. Akiyama, S. Egami and Y. Tanigawa, Analytic continuation of multi-
ple zeta functions and their values at non-positive integers, Acta Arith., 98
(2001), 107–116.
2. S. Akiyama and H. Ishikawa, On analytic continuation of multiple L-functions
and related zeta-functions, in Analytic Number Theory, C. Jia and K. Mat-
sumoto (eds.), Dev. Math., Vol.6, Kluwer, 2002, pp.1–16.
3. T. Arakawa and M. Kaneko, Multiple zeta values, poly-Bernoulli numbers,
and related zeta functions, Nagoya Math. J., 153 (1999), 189–209.
4. T. Arakawa and M. Kaneko, On multiple L-values, J. Math. Soc. Japan, 56
(2004), 967–991.
5. E. W. Barnes, The theory of the double gamma function, Philos. Trans. Roy.
Soc. (A), 196 (1901), 265–387.
6. E. W. Barnes, On the theory of the multiple gamma function, Trans. Cam-
bridge Philos. Soc., 19 (1904), 374–425.
7. G. Bhowmik, D. Essouabri and B. Lichtin, Meromorphic continuation of
multivariable Euler products, Forum Math., to appear.
8. R.
de
la
Bret`eche,
Estimation
de
sommes
multiples
de
fonctions
arithm´etiques, Compositio Math., 128 (2001), 261–298.

22
SHIGEKI EGAMI AND KOHJI MATSUMOTO
9. G. Dahlquist, On the analytic continuation of Eulerian products, Ark. Mat.,
1 (1952), 533–555.
10. S. Egami, Some curious Dirichlet series, S¯urikaisekikenky¯usho K¯oky¯uroku,
1091, RIMS Kyoto Univ. (1999), 172–174.
11. D. Essouabri, Singularit´es des s´eries de Dirichlet associ´ees `a des polynˆomes
de plusieurs variables et applications `a la th´eorie analytique des nombres,
Th´ese, Univ. Henri Poincar´e - Nancy I, 1995.
12. D. Essouabri, Singularit´es des s´eries de Dirichlet associ´ees `a des polynˆomes
de plusieurs variables et applications en th´eorie analytique des nombres, Ann.
Inst. Fourier, 47 (1997), 429–483.
13. T. Estermann, On certain functions represented by Dirichlet series, Proc.
London Math. Soc., (2)27 (1928), 435–448.
14. T. Estermann, On a problem of analytic continuation, ibid., 471–482.
15. A. Fujii, An additive problem of prime numbers, Acta Arith., 58 (1991),
173–179.
16. A. Fujii, An additive problem of prime numbers II, Proc. Japan Acad., 67A
(1991), 248–252.
17. A. Fujii, An additive problem of prime numbers III, ibid., 278–283.
18. A. Fujii, An additive theory of the zeros of the Riemann zeta function, Com-
ment. Math. Univ. St. Pauli, 45 (1996), 49–116.
19. A. B. Goncharov, Multiple polylogarithms, cyclotomy and modular com-
plexes, Math. Res. Letters, 5 (1998), 497–516.
20. G. H. Hardy and J. E. Littlewood, Some problems of “partitio numerorum”
(V): A further contribution to the study of Goldbach’s problem, Proc. London
Math. Soc., (2)22 (1924), 46–56.
21. H. Ishikawa, On analytic properties of a multiple L-function, in Analytic
Extension Formulas and their Applications, S. Saitoh et al. (eds.), Soc. Anal.
Appl. Comput., Vol.9, Kluwer, 2001, pp.105–122.
22. H. Ishikawa, A multiple character sum and a multiple L-function, Arch.
Math., 79 (2002), 439–448.
23. J. C. Kluyver, Benaderingsformules betreﬀende de priemgetallen beneden
eene gegeven grens, Koninglijke Akad. Wet. Amsterdam, Versl. Gew. Verg.
Wis- en Natuur. Afd., 8 (1900), 672–682.
24. N. Kurokawa, On the meromorphy of Euler products (I), Proc. London Math.
Soc., (3)53 (1986), 1–47; (II), ibid., 209–236.
25. E. Landau, ¨Uder die Multiplikation Dirichlet’scher Reihen, Rend. Circ. Mat.
Palermo, 24 (1907), 81–160.
26. E. Landau and A. Walﬁsz, ¨Uder die Nichtfortsetzbarkeit einiger durch Dirich-
letsche Reihen deﬁnierter Funktionen, ibid. 44 (1920), 82–86.
27. K. Matsumoto, Asymptotic expansions of double zeta-functions of Barnes,
of Shintani, and Eisenstein series, Nagoya Math. J., 172 (2003), 59–102.
28. K. Matsumoto and Y. Tanigawa, The analytic continuation and the order
estimate of multiple Dirichlet series, J. Th´eorie des Nombres de Bordeaux,
15 (2003), 267–274.
29. H. Mellin, Eine Formel f¨ur den Logarithmus transcendenter Funktionen von
endlichem Geschlecht, Acta. Soc. Sci. Fenn., 29 (1900), no.4.

CONVOLUTIONS OF THE VON MANGOLDT FUNCTION
23
30. H. Mellin, Die Dirichlet’schen Reihen, die zahlentheoretischen Funktionen
und die unendlichen Produkte von endlichem Geschlecht, Acta Math., 28
(1904), 37–64.
31. H. L. Montgomery and R. C. Vaughan, Error terms in additive prime number
theory, Quart. J. Math. Oxford, (2)24 (1973), 207–216.
32. M. Peter, Dirichlet series associated with polynomials, Acta Arith., 84 (1998),
245–278.
33. P. Sargos, Prolongement m´eromorphe des s´eries de Dirichlet associ´ees `a des
fractions rationnelles de plusieurs variables, Ann. Inst. Fourier, 34(3) (1984),
83–123.
34. P. Sargos, Croissance de certaines s´eries de Dirichlet et applications, J. Reine
Angew. Math., 367 (1986), 139–154.
35. Y. Tanigawa and W. Zhai, Dirichlet series associated with polynomials and
applications, J. Number Theory, to appear.
36. E. C. Titchmarsh, The Theory of the Riemann Zeta-function, Oxford, 1951.
37. J. Zhao, Analytic continuation of multiple zeta-functions, Proc. Amer. Math.
Soc., 128 (2000), 1275–1283.

24
CONSTRUCTING NEW NON-CONGRUENT NUMBERS
BY GRAPH THEORY
KEQIN FENG∗
Department of Mathematical Science, Tsinghua University,
Beijing 100084, China
E-mail: kfeng@math.tsinghua.edu.cn
YAN XUE
Department of Mathematical Science, Tsinghua University,
Beijing 100084, China
E-mail: xueyan97@mails.tsinghua.edu.cn
This paper is a survey on recent results of new series of non-congruent numbers
which can be acquired by traditional arithmetic theory of elliptic curves plus a
result from algebraic graph theory. More precisely, we start from the following
two facts: (1) A square-free positive integer n is a non-congruent number if
and only if the rank of the group En(Q) of rational points of the elliptic curve
En : y2 = x3 −n2x is zero. (2) If the 2-Selmer groups Sn and ˆ
Sn of the elliptic
curve En and its dual curve ˆ
En : y2 = x3 + 4n2x have minimal sizes |Sn| = 1
and | ˆ
Sn| = 4, then rank(En(Q)) = 0. Selmer groups can be determined by the
data of locally solvability conditions of the homogenous spaces of elliptic curves
En and
ˆ
En. The next step is to organize the data into carefully constructed
graphs so that the Selmer groups have minimum if and only if the graphs have
speciﬁc “odd” property. By a result in algebraic graph theory, an odd graph
can be described by the rank of the Laplace matrix of the graph over F2. Thus,
by computing the rank of a certain matrix over F2, we can determine all n such
that Sn and ˆ
Sn have minimum, in which case n is a non-congruent number.
After explaining this method and related concepts, we describe the results on
new series of non-congruent numbers obtained in this way and illustrate them
by examples.
1. Introduction
A square-free positive integer n is called a congruent number if n is the
area of a certain rational right triangle where “rational” means that the
∗Supported by a National Scientiﬁc Research Project 973 of China No. 2004 CB 3180004
and a NSFC grant No. 60433050.

CONSTRUCTING NEW NON-CONGRUENT NUMBERS BY GRAPH THEORY
25
lengths of three sides of this triangle are rational numbers. Otherwise n is
called a non-congruent number. To determine all congruent numbers is one
of long-standing problems in number theory. Using the theory of modular
forms, Tunnell [17] (also see [10]) presented an elementary criterion on
congruent numbers under the Birch and Swinnerton-Dyer conjecture, but
this problem has not been solved completely. Many congruent numbers
and non-congruent numbers have been determined [6,7,11–15], but most of
them have at most 4 prime divisors. In this paper we are concerned only
with non-congruent numbers, and we list up several known results in the
following (p, q, r, s are odd prime numbers, and ( p
q ) is the Legendre symbol.)
Lemma 1.1. In the following cases, n is a non-congruent number.
(1) (Genocchi [6])
n = p ≡3 (mod 8),
n = pq,
p ≡q ≡3 (mod 8),
n = 2p,
p ≡5 (mod 8),
n = 2pq,
p ≡q ≡5 (mod 8).
(2) (Lagrange [12])
n = pq,
(p, q) ≡(1, 3) (mod 8),
( p
q ) = −1,
n = 2pq,
(p, q) ≡(1, 5) (mod 8),
( p
q ) = −1,
n = pqr,
(p, q, r) ≡(1, 1, 3) (mod 8),
with the condition (∗),
n = 2pqr,
(p, q, r) ≡(1, 1, 5) (mod 8),
with the condition (∗).
Condition (∗): n can be written as n = p1p2p3 or 2p1p2p3 such that
³p1
p2
´
=
³p1
p3
´
= −1.
(3) (Serf [15])
n = pq,
(p, q) ≡(5, 7) (mod 8),
( p
q ) = −1,
n = pqr,
(p, q, r) ≡(1, 3, 3) (mod 8),
( p
q ) = −( p
r ),
n = pqr,
(p, q, r) ≡(3, 5, 7) (mod 8),
( q
r) = −1,
n = 2pqr,
(p, q, r) ≡(1, 5, 5) (mod 8),
( p
q ) = −( p
r ),
n = pqrs,
(p, q, r, s) ≡(5, 5, 7, 7) (mod 8), and
1 =
³p
r
´
= −
³p
s
´
= −
³q
r
´
;
or
1 = −
³p
r
´
=
³p
s
´
= −
³q
s
´
;
or
1 = −
³p
r
´
= −
³p
s
´
,
³q
r
´
= −
³q
s
´
.

26
KEQIN FENG AND YAN XUE
Serf also claimed in [15] that he found more cases of non-congruent numbers
n with 5 or 6 odd prime divisors, but “it is almost impossible to exhibit
them in a reasonable way.”
In this survey paper we introduce several works [2–4,18,19] trying to ﬁnd
a reasonable way to describe a remarkable portion of new non-congruent
numbers, including many series of such n with arbitrarily large number
of prime factors. The method starts from the following basic fact (see
N. Koblitz’ book [10], for example).
Lemma 1.2. A square-free positive integer n is a non-congruent number
if and only if the group En(Q) of rational points of the elliptic curve En :
y2 = x3 −n2x has rank zero.
Traditional way to deal with rank(En(Q)) is the 2-descent method which
we explain in §2. With this method, the rank problem of En(Q) is reduced
to determining the Selmer groups Sn and ˆ
Sn of the elliptic curve En and
its dual curve ˆ
En : y2 = x3 +4n2x. In particular, if the Selmer groups have
minimal sizes |Sn| = 1 and | ˆ
Sn| = 4, then rank(En(Q)) = 0 so that n is
a non-congruent number by Lemma 1.2. The Selmer groups are deﬁned by
locally solvability of certain equations so that can be determined in principle
by Hensel lemma. But the data of such conditions of locally solvability are
rather complicated when the number of prime factors of n is larger. Next
step is that the data can be organized into carefully constructed graphs so
that the Selmer groups have minimum if and only if the graphs have speciﬁc
“odd” property. By a result in algebraic graph theory, odd graphs can be
described by the rank of the Laplace matrix of the graph over F2. Thus,
all n such that Sn and ˆ
Sn have minimum, so that rank(En(Q)) = 0 and,
a fortiori, n is a non-congruent number, can be determined by computing
the rank of a certain matrix over F2. We explain our graph-theory tools
in §3 and introduce the results on new series of non-congruent numbers
obtained in this way in §4. Finally we mention the Birch and Swinnerton-
Dyer conjecture for elliptic curve En brieﬂy in §5.
2. Selmer groups
In this section we describe the 2-descent method for elliptic curve En. For
details we refer to the last chapter of Silverman’s book [16].
Let n = p1 · · · pt or n = 2p1 · · · pt where t ⩾1 and p1, · · · , pt are distinct
odd prime numbers. We deﬁne a set of prime divisors of the rational number

CONSTRUCTING NEW NON-CONGRUENT NUMBERS BY GRAPH THEORY
27
ﬁeld Q by
S = {∞, 2, p1, · · · , pt},
and a subgroup M of the multiplicative group Q∗/(Q∗)2 generated by
−1, 2, p1, · · · , pt
M = ⟨−1, 2, p1, · · · , pt⟩⊆Q∗/(Q∗)2.
For each d ∈M we have the homogenous spaces Cd and ˆ
Cd of En and its
2-dual curve ˆ
En : y2 = x3 + 4n2x deﬁned by
Cd : dw2 = d2t4 + 4n2z4,
ˆ
Cd : dw2 = d2t4 −n2z4.
For each prime divisor v ∈S, we denote Cd(Qv) and ˆ
Cd(Qv) the set of
non-trivial solutions (w, t, z) ̸= (0, 0, 0) of Cd and ˆ
Cd in the local ﬁeld Qv
respectively. The Selmer groups Sn and ˆ
Sn of En and ˆ
En are deﬁned by
locally solvability of Cd and ˆ
Cd:
Sn = {d ∈M : Cd(Qv) ̸= ∅for all v ∈S},
ˆ
Sn = {d ∈M :
ˆ
Cd(Qv) ̸= ∅for all v ∈S}.
It is proved that Sn and ˆ
Sn are subgroups of M, and
1 ∈Sn,
{±1, ±n} ⊆ˆ
Sn,
since C1 and ˆ
Cd for d = ±1, ±n have global non-trivial solutions in Q. The
following result is a special consequence of 2-descent method.
Lemma 2.1. If Sn and
ˆ
Sn have minimal sizes: Sn = {1} and
ˆ
Sn =
{±1, ±n}, then rank(En(Q)) = 0, so that n is a non-congruent number.
Now the problem is reduced to ﬁnding an explicit criterion to describe
Sn = {1} and ˆ
Sn = {±1, ±n}. By the deﬁnition of Selmer groups, Sn = {1}
if and only if for all d ∈M and d ̸= 1, there exists v ∈S such that
Cd(Qv) = ∅. Similarly, ˆ
Sn = {±1, ±n} can also be described by such kind
of local solvabilities of ˆ
Cd. It is not diﬃcult to give the following result by
Hensel lemma and careful computation.
Lemma 2.2 ([3, Lemma 3.1, 3.2, 5.1, 5.2]). Let p1, · · · , pt (t ⩾1) be
distinct odd prime numbers, d ∈M = ⟨−1, 2, p1, · · · , pt⟩⊂Q∗/(Q∗)2, and
p denotes an odd prime number.
(A) If n = p1 · · · pt, then
(A1) Cd(Q∞) = ∅⇔d < 0.

28
KEQIN FENG AND YAN XUE
(A2) For p|d, Cd(Qp) = ∅
⇔( −1
p ) = −1 or “( −1
p ) = 1 and ( n/d
p ) =
−1”.
(A3) For p| 2n
d , Cd(Qp) = ∅⇔( d
p) = −1.
(A4) If n ≡±3 (mod 8) and 2|d, then Cd(Q2) = ∅.
(A5) d ≡1 (mod 4) ⇒Cd(Q2) ̸= ∅.
(A6) If n ≡±1 (mod 8), d = 2d′ where d′|n and d′ ≡1 (mod 4), then
Cd(Q2) ̸= ∅.
(A1′) 2|d ⇒
ˆ
Cd(Q2) = ∅.
(A2′) If 2 ∤d, then
ˆ
Cd(Q2) = ∅
⇔
d ≡±3 (mod 8) and
n
d ≡
±3 (mod 8).
(A3′) If p|d, then ˆ
Cd(Qp) = ∅⇔( −1
p ) = 1 and ( n/d
p ) = −1.
(A4′) If p| 2n
d , then ˆ
Cd(Qp) = ∅⇔( −1
p ) = 1 and ( d
p) = −1.
(B) If n = 2p1 · · · pt, then
(B1) Cd(Q∞) = ∅⇔d < 0.
(B2) 2|d ⇒Cd(Q2) = ∅.
(B3) For p|d, if ( −1
p ) = −1 or “( −1
p ) = 1 and ( −1
p )4( 2n/d
p ) = −1”, then
Cd(Qp) = ∅.
(B4) For p| n
d , then ( d
p) = −1 ⇒Cd(Qp) = ∅.
(B1′) For p|d, ˆ
Cd(Qp) = ∅⇔( −1
p ) = 1 and ( n/d
p ) = −1.
(B2′) For p| n
d , ˆ
Cd(Qp) = ∅⇔( −1
p ) = 1 and ( d
p) = −1.
(B3′) 2 ∤d ⇒
ˆ
Cd(Q2) ̸= ∅.
For the Genocchi cases in Lemma 1.1 (1), it can be seen by Lemma 2.2
that Sn = {1} and ˆ
Sn = {±1, ±n} so that n is a non-congruent number.
For the ﬁrst two cases of Lemma 1.1 (2), it can be seen that Sn = {1} and
ˆ
Sn = {±1, ±n} if and only if ( p
q ) = −1. But in general cases, it seems no
simple way to write down a necessary and suﬃcient condition for Sn = {1}
and ˆ
Sn = {±1, ±n} if n has large number of prime divisors. What we did in
next step is to ﬁnd proper graphs such that the condition can be described
by a speciﬁc property of graphs which we introduce in next section.
3. Oddness of graphs
We use standard terminology in graph theory (see [8] for example). Let
G = (V, A) be a (simple) directed graph where V = V (G) = {v1, · · · , vm}
is the set of vertices of G, and A = A(G) is the set of arcs in G. We denote
an arc (vi, vj) ∈A by −−→
vivj. If both of −−→
vivj and −−→
vjvi belong to A, we have

CONSTRUCTING NEW NON-CONGRUENT NUMBERS BY GRAPH THEORY
29
a two-direction arc vivj in G and call it an edge. If all arcs in A(G) are
two-directed, the graph G is called non-directed.
The adjacency matrix of G is deﬁned by
M(G) = (aij)1⩽i,j⩽m
where
aij =
½1
if −−→
vivj ∈A(G),
1 ⩽i ̸= j ⩽m,
0
otherwise.
Let
di =
m
X
j=1
aij (the outdegree of vertex vi),
1 ⩽i ⩽m.
The Laplace matrix of G is deﬁned by
L(G) = diag(d1, · · · , dm) −M(G).
Since the sum of each row of L(G) is zero, we know that rankQ(L(G)) ⩽
m −1 and
Lij = (−1)j+kLik
where Lij is the co-factor of L(G) at the position (i, j). For non-directed
graph G, the matrices M(G) and L(G) are symmetric and
L11 = (−1)i+kLik,
1 ⩽i, k ⩽m.
In this case, it is well known that the absolute value of |L11| is the number
of spanning trees of the non-directed graph G (see [2] Section 1.2.4).
Deﬁnition 3.1. Let G = (V, A) be a directed graph. A partition {V1, V2} of
V is called odd if either there exists a vertex v1 ∈V1 such that #{v1 →V2}
(the total number of arcs from v1 to vertices in V2) is odd, or there exists
v2 ∈V2 such that #{v2 →V1} is odd. Otherwise the partition {V1, V2} is
called even. The graph G is called odd if all non-trivial partitions {V1, V2} ̸=
{V, ∅} of V are odd.
The following result presents a simple criterion for oddness of a graph
G in terms of the rank of the Laplace matrix L(G) over ﬁnite ﬁeld F2.
Remark that rankF2(L(G)) ⩽rankQ(L(G)) ⩽m −1 and the total number
of partitions of V is 2m−1 (m = |V |) since we view {V1, V2}={V2, V1}.

30
KEQIN FENG AND YAN XUE
Lemma 3.1 ([2, Lemma 2.2]). Let G = (V, A) be a directed graph,
m = |V | and r = rankF2(L(G)) (⩽m −1). Then the total number of
even partitions of V is 2m−r−1. In particular, the graph G is odd if and
only if r = m −1. For non-directed graph G, G is odd if and only if the
number t(G) = |L11(G)| of spanning trees of G is odd.
An odd graph should be connected. There exists plenty of odd graphs
as shown in following examples:
(1) All directed cycles C′
m with V
=
{v1, · · · , vm} and A
=
{−−→
v1v2, · · · , −−−−−→
vm−1vm, −−−→
vmv1}.
For non-directed graphs:
(2) All trees T, since t(T) = 1.
(3) All complete graphs Km with odd integer m ⩾3 deﬁned by V =
{v1, · · · , vm} and A = {vivj :
1 ⩽i ̸= j ⩽m} since we have Cayley
formula t(Km) = mm−2.
(4) All cycles Cm with odd integer m ⩾3 deﬁned by V = {v1, · · · , vm}
and A = {v1v2, · · · , vm−1vm, vmv1}.
The concept of odd graph has been used in number theory to determine
the 4-rank of the class group of imaginary quadratic number ﬁelds in 1930’s
by L. R´edei and H. Reichardt and to present a suﬃcient condition for the
Pell’s equation x2 −ny2 = −1 having no integral solution in 1970’s. In the
next section we show its new application in number theory to present series
of new non-congruent numbers.
4. New non-congruent numbers
Let n = p1 · · · pt (t ⩾1) be a product of distinct odd primes. We deﬁne a
graph G(n) = (V, A) by
V = {p1, · · · , pt},
A =
½
−−→
pipj :
µpj
pi
¶
= −1,
1 ⩽i ̸= j ⩽t
¾
.
In 1996, the ﬁrst author found that for speciﬁc n, the oddness of the graph
G(n) is a suﬃcient condition for Sn = {1} and ˆ
Sn = {±1, ±n} as described
in Lemma 4.1.
Lemma 4.1 ([2, Theorem 3.1]). (1) Suppose that n = p1 · · · pt (t ⩾1),
p1 ≡3 (mod 8) and pi ≡1 (mod 8) when i ⩾2. If G(n) is an odd graph,
then Sn = {1} and ˆ
Sn = {±1, ±n}.
(2) Suppose that n = 2p1 · · · pt (t ⩾1), p1 ≡5 (mod 8) and pi ≡1 (mod 8)
when i ⩾2. If G( n
2 ) is an odd graph, then Sn = {1} and ˆ
Sn = {±1, ±n}.

CONSTRUCTING NEW NON-CONGRUENT NUMBERS BY GRAPH THEORY
31
This result presents series of non-congruent number n such that n can have
arbitrarily lager number of prime divisors since it is easy to show by the
Dirichlet theorem on primes in arithmetic progressions that for each non-
directed graph G there exist inﬁnitely many of n in form (1) of Lemma
4.1 and 2n in form (2) of Lemma 4.1 such that G(n) = G and G( n
2 ) = G
respectively. Later, we ﬁnd suitable graphs to do this for all cases of n with
more careful consideration. Now we describe our results and omit technique
in proofs.
Case 2|n. Let n = 2n′, where
n′ = p1 · · · ptq1 · · · qs,
pi ≡1 (mod 4),
qj ≡3 (mod 4),
1 ⩽i ⩽t,
1 ⩽j ⩽s,
is a product of distinct prime numbers (t + s ⩾1). Let P = {p1, · · · , pt},
Q = {q1, · · · , qs}. We deﬁne a graph ˆG(n) = (V, A) by
V = {2, p1, · · · , pt, q1, · · · , qs},
A =
½
pipj :
µpj
pi
¶
= −1, pi, pj ∈P
¾
∪
½
−→
pq :
µq
p
¶
= −1, p ∈P, q ∈Q
¾
∪
½−→
p2 :
µ2
p
¶
= −1 (⇔p ≡5 (mod 8)), p ∈P
¾
.
From Lemma 2.2 (B) we obtain the following result.
Theorem 4.1 ([3, Lemma 5.3, 5.4]). For n = 2n′, we have
ˆ
Sn = {±1, ±n} ⇔
ˆG(n)is an odd graph ⇒Sn = {1}.
Then by the matrix characterization of odd graphs in Lemma 3.2, we
get the following result.
Theorem 4.2 ([3, Theorem 2.6]). Let n = 2n′ and n′ has decomposi-
tion (4.1). Then Sn = {1} and ˆ
Sn = {±1, ±n} (so that rank(En(Q)) = 0
and n is a non-congruent number) if and only if the following two conditions
are satisﬁed.
(1) s = 0 so that n′ = p1 · · · pt (t ⩾1) and pi ≡1 (mod 4).

32
KEQIN FENG AND YAN XUE
(2) Deﬁne the following numbers
aij =
(
1
if ( pj
pi ) = −1,
0
if ( pj
pi ) = 1,
1 ⩽i ̸= j ⩽t,
ci =
½ 1
if pi ≡5 (mod 8),
0
otherwise,
1 ⩽i ⩽t,
a∗
ii =
t
X
j=1,j̸=i
aij + ci,
1 ⩽i ⩽t.
Then
¯¯¯¯¯¯¯¯¯
a∗
11 a12 · · · a1t
a21 a∗
22 · · · a2t
...
...
...
at1 at2 · · · a∗
tt
¯¯¯¯¯¯¯¯¯
= 1 ∈F2.
In particular, there exists at least one i (1 ⩽i ⩽t) such that pi ≡5 (mod 8).
As an example of new consequences, the following result can be derived
from Theorem 4.3.
Corollary 4.1. If n = 2p1 · · · pt (t ⩾1), pi ≡5 (mod 8) (1 ⩽i ⩽t) and
( pj
pi ) = 1 for all 1 ⩽i ̸= j ⩽t, then Sn = {1} and ˆ
Sn = {±1, ±n} so that
rank(En(Q)) = 0 and n is a non-congruent number.
Case 2 ∤n. For n = p1 · · · pt ≡±3 (mod 8) we have the following result
where G(n) is the (non-directed) graph G(n) = (V, E) deﬁned by
V = {p1, · · · , pt},
E =
½
pipj :
µpj
pi
¶
= −1, 1 ⩽i ̸= j ⩽t
¾
.
Theorem 4.3 ([3, Theorem 2.4]). For n ≡±3 (mod 8), Sn = {1} and
ˆ
Sn = {±1, ±n} (so that rank(En(Q)) = 0 and n is a non-congruent num-
ber) if and only if the following three conditions are satisﬁed.
(1) n ≡3 (mod 8).
(2) n = p1 · · · pt, p1 ≡3 (mod 4) and pi ≡1 (mod 4) for 2 ⩽i ⩽t.
(3) G(n) is an odd graph.
For the case n ≡±1 (mod 8), we need to generalize the concept of odd graph
a little more. Here we state the ﬁnal result. Let n = p1 · · · ptq1 · · · qs be a
product of distinct prime numbers, where pi ≡1 (mod 4), qj ≡3 (mod 4),

CONSTRUCTING NEW NON-CONGRUENT NUMBERS BY GRAPH THEORY
33
(1 ⩽i ⩽t, 1 ⩽j ⩽s), (t+s ⩾1). Let P = {p1, · · · , pt}, Q = {q1, · · · , qs}.
We deﬁne a graph G∗(n) = (V, A) by
V = {2, p1, · · · , pt, q1, · · · , qs},
A =
½
pipj :
µpj
pi
¶
= −1, pi, pj ∈P
¾
∪
½
−→
pq :
µq
p
¶
= −1, p ∈P, q ∈Q
¾
∪
n−→
2r : r ≡±3 (mod 8), r ∈P ∪Q
o
.
Theorem 4.4 ([3, Theorem 2.5]). For n ≡±1 (mod 8), Sn = {1} and
ˆ
Sn = {±1, ±n} if and only if the following three conditions are satisﬁed.
(1) n ≡1 (mod 8).
(2) The decomposition of n has one of the following forms:
(2.1) n = p1 · · · prP1 · · · PsQ1Q2;
(2.2) n = p1 · · · prP1 · · · Ptq1q2;
(2.3) n = p1 · · · prP1 · · · PlQ1q1
where pi ≡1, Pj ≡5, Qλ ≡3, qµ ≡7 (mod 8) and
r ⩾0,
2|s ⩾0,
2|t ⩾2,
2 ∤l ⩾1.
(3) There exists only one non-trivial even partition V1 = {2} and V2 = V \V1
for the graph G∗(n). Namely, the rank of L(G∗(n)) over F2 is |V |−2 where
L(G∗(n)) is the Laplace matrix of G∗(n) deﬁned in §3.
Many knowing results on non-congruent numbers in Lemma 1.1 are
special cases of Theorem 4.2-6.
Now under the change of variable, the elliptic curve En : y2 = x3 −n2x
transforms into the elliptic curve
E′
n : y2 = x3 −3nx2 + 2n2x.
It is obvious that rank(En(Q)) = rank(E′
n(Q)). The homogenous spaces of
E′
n and its dual curve ˆ
E′n : y2 = x3 + 6nx2 + n2x are
C′
d : dw2 = d2t4 + 6ndt2z2 + n2z4,
ˆ
C′
d : dw2 = d2t4 −3ndt2z2 + 2n2z4 = (dt2 −2nz2)(dt2 −nz2).
Let S′
n and ˆ
S′n be the Selmer groups of E′
n and ˆ
E′n respectively. Then 1 ∈S′
n
and {1, 2, n, 2n} ⊂ˆ
S′n. As a consequence of 2-descent method, we also have
the following fact.
Lemma 2.1′. If S′
n = {1} and ˆ
S′n = {1, 2, n, 2n}, then rank(E′
n(Q)) =
rank(En(Q)) = 0, so that n is a non-congruent number.

34
KEQIN FENG AND YAN XUE
In 2002, Goto [6] obtained new non-congruent numbers n for n having at
most 4 prime divisors by using Lemma 2.1′. With helping of odd graphs, we
obtain following general results which present more non-congruent numbers.
Case 2 ∤n.
Let
n = p1 · · · ptq1 · · · qs,
t + s ⩾1,
pi ≡±1 (mod 8), qj ≡±3 (mod 8),
1 ⩽i ⩽t, 1 ⩽j ⩽s.
(4.1)
Theorem 4.5 ([4, Theorem 3.1]). Assume that n ≡3 (mod 4) with de-
composition (4.2). Then S′
n = {1} and ˆ
S′n = {1, 2, n, 2n} if and only if the
following two conditions are satisﬁed.
(1) n ≡3 (mod 8) and s = 1, so that n = p1 · · · ptq (t ⩾0) where
pi ≡±1 (mod 8) (1 ⩽i ⩽t), q ≡±3 (mod 8).
(2) The graph ˜G(n) = ( ˜V , ˜A) deﬁned by
˜V = {p1, · · · , pt, q},
˜A =
½
−−→
pipj
¯¯¯¯
µpj
pi
¶
= −1, 1 ⩽i ̸= j ⩽t
¾
∪
½
−→
piq
¯¯¯¯
µ q
pi
¶
= −1, 1 ⩽i ⩽t
¾
is odd.
Theorem 4.6 ([4, Theorem 3.2]). Assume that n ≡1 (mod 4) with de-
composition (4.2). Then S′
n = {1} and ˆ
S′n = {1, 2, n, 2n} if and only if the
following two conditions are satisﬁed.
(1) s = 2 and n ≡1 (mod 8) so that n = p1 · · · ptq1q2.
(2)
¯¯¯¯¯¯¯¯¯
m∗
11 m12 · · · m1t b11
...
...
...
...
mt1 mt2 · · · m∗
tt bt1
l1
l2
· · · lt
k1
¯¯¯¯¯¯¯¯¯
= 1 ∈F2,
where
mij =
(
1
if ( pj
pi ) = −1,
0
otherwise,
1 ⩽i ̸= j ⩽t,
biλ =
(
1
if ( qλ
pi ) = −1,
0
otherwise,
1 ⩽i ⩽t, 1 ⩽λ ⩽2,
li =
½ 1
if pi ≡7
(mod 8),
0
if pi ≡1
(mod 8),
1 ⩽i ⩽t,
k1 =
½1
if q1 ≡3
(mod 8),
0
if q1 ≡5
(mod 8),

CONSTRUCTING NEW NON-CONGRUENT NUMBERS BY GRAPH THEORY
35
and
m∗
ii =
t
X
j=1,j̸=i
mij + bi1 + bi2,
1 ⩽i ⩽t.
Theorem 4.7 and 4.8 present series of explicit non-congruent numbers
as following.
Corollary 4.2 ([4, Corollary 3.3]). Suppose that n = p1 · · · ptq (t ⩾1)
and
pi ≡1 (mod 8), 1 ⩽i ⩽t −1,
pt ≡7 (mod 8),
q ≡5 (mod 8),
µ q
pi
¶
= −1,
1 ⩽i ⩽t.
Then n is a non-congruent number provided one of the following conditions
is satisﬁed.
(1)
³
pi
pj
´
= 1 for all 1 ⩽i ̸= j ⩽t.
(2)
³
pi
pj
´
= −1 for all 1 ⩽i ̸= j ⩽t and t is even.
Corollary 4.3 ([4, Corollary 3.4]). Suppose that n = p1 · · · ptq (t ⩾1)
and
pi ≡1 (mod 8), 1 ⩽i ⩽t −1, pt ≡7 (mod 8),
q ≡5 (mod 8).
Then n is a non-congruent number if the following two conditions are sat-
isﬁed.
(1) There is exactly one i (1 ⩽i ⩽t) such that ( q
pi ) = −1.
(2) The (non-directed) graph G = (V, A) deﬁned by
V = {p1, · · · pt},
A =
½
pipj
¯¯¯¯
µpj
pi
¶
= −1, 1 ⩽i ̸= j ⩽t
¾
is odd.
Corollary 4.4 ([4, Corollary 3.5]). Suppose that n = p1 · · · ptq1q2 (t ⩾
0) and
(1) pi ≡1 (mod 8), q1 ≡q2 ≡3 (mod 8), ( q1
pi )( q2
pi ) = −1, (1 ⩽i ⩽t).
(2) ( pi
pj ) = 1 (1 ⩽i ̸= j ⩽t) or “ ( pi
pj ) = −1 (1 ⩽i ̸= j ⩽t) and t is even”.
Then n is a non-congruent number.
Corollary 4.5 ([4, Corollary 3.6]). Suppose that n = p1 · · · ptq1q2 (t ⩾
1) and
(1) pi ≡1 (mod 8) (1 ⩽i ⩽t −1), (pt, q1, q2) ≡(7, 5, 3) (mod 8);

36
KEQIN FENG AND YAN XUE
(2) All ( qλ
pi ) = 1, (1 ⩽i ⩽t, 1 ⩽λ ⩽2) except ( q1
pt ) = −1;
(3) The non-directed graph G = (V, A) deﬁned in Corollary 4.10 is odd.
Then n is a non-congruent number.
Case 2|n = 2n′. We proved (see [5]) that there is no n′ ≡7 (mod 8)
such that S′
n = {1} and ˆ
S′n = {1, 2, n′, n}. We have not completed the case
n′ ≡1 or 3 (mod 8), but for n′ ≡5 (mod 8) we get the following result.
Theorem 4.7 ([5, Theorem 3.1]). Suppose that n = 2n′ and n′ =
p1 · · · ptq1 · · · qs ≡5 (mod 8) where t, s ⩾0, t + s ⩾1, pi ≡±1 (mod 8)
and qj ≡±3 (mod 8), (1 ⩽i ⩽t, 1 ⩽j ⩽s). Then the following two
conditions are equivalent.
(1) S′
n = {1} and ˆ
S′n = {1, 2, n′, n} so that rank(E′
n(Q)) = 0 and n is a
non-congruent number;
(2) s = 1 so that n′ = p1 · · · ptq, q ≡±3 (mod 8); and
D =
¯¯¯¯¯¯¯
m∗
11 m12 · · · m1t
...
...
...
mt1 mt2 · · · m∗
tt
¯¯¯¯¯¯¯
= 1 ∈F2,
where
mij =
(
1
if ( pj
pi ) = −1,
0
otherwise,
1 ⩽i ̸= j ⩽t,
bi =
(
1
if ( q
pi ) = −1,
0
otherwise,
1 ⩽i ⩽t,
and
m∗
ii =
t
X
j=1,j̸=i
mij + bi,
1 ⩽i ⩽t.
(We assume D = 1 for t = 0.)
From simple computations, we can derive the following consequences of
Theorem 4.13.
Corollary 4.6 ([5, Corollary 3.2]). Suppose that n = 2n′ and n′ satis-
ﬁes one of following conditions where p, q, p1, p2 are prime numbers and
p1 ̸= p2.
(1) n′ = q ≡5 (mod 8);
(2) n′ = pq, ( q
p) = −1 and (p, q) ≡(1, 5) or (7, 3) (mod 8);

CONSTRUCTING NEW NON-CONGRUENT NUMBERS BY GRAPH THEORY
37
(3) n′ = p1p2q, (p1, p2, q) ≡(1, 1, 5) or (1, 7, 3) (mod 8) and there exists one
of p1, p2, q which is quadratic non-residue of the other two prime numbers;
(4) n′ = p1p2q, (p1, p2, q) ≡(7, 7, 5) (mod 8) and ( p2
p1 ) = ( q
p2 ) = −( q
p1 ).
Then S′
n = {1} and ˆ
S′n = {1, 2, n′, n} so that rank(E′
n(Q)) = 0 and n is a
non-congruent number.
Corollary 4.7 ([5, Corollary 3.3]). Let n = 2n′, n′ = p1 · · · ptq ≡
5
(mod
8)
where
p1, · · · , pt
are
distinct
prime
numbers,
pi
≡
±1 (mod 8) (1 ⩽i ⩽t) and q ≡±3 (mod 8). Let r1, · · · , rl be distinct
prime numbers, rλ ≡±1 (mod 8) (1 ⩽λ ⩽l), ( ri
rj ) = 1
(1 ⩽i, j ⩽l),
r1 · · · rl ≡1 (mod 8) and
µ pi
rλ
¶
=
µrλ
pi
¶
= 1,
1 ⩽i ⩽s, 1 ⩽λ ⩽l,
µ q
rλ
¶
= −1,
1 ⩽λ ⩽l.
If D = 1 ∈F2 where D is given by Theorem 4.13 (2) (so that n is a
non-congruent number), then N = r1 · · · rln is a non-congruent number.
5. Birch and Swinnerton-dyer conjecture for En
The Birch and Swinnerton-Dyer conjecture says that for each elliptic curve
E over Q,
(BSD1) The order of zero of L-function L(E, s) at s = 1 is equal to
rank(E(Q)).
(BSD2) If rank(E(Q)) = 0 (so that L(E, 1) ̸= 0 by (BSD1)), then
L(E, 1) is equal to a certain conjectured value.
For several cases of En such that rank(En(Q)) = 0, Chunlai Zhao [18,19]
calculated L(En, 1) by using Eisenstein series and odd-graph language and
then veriﬁed conjecture (BSD1) and (BSD2). For the case that n has at
most 2 odd prime divisors, this can be done by using Tunnell’s elementary
criterion, see [2].
References
1. N. Aoki, On the 2-Selmer groups of elliptic curves arising from the congruent
number problems, Comment. Math. Univ. St. Paul., 48 (1999), 77–101.
2. K. Feng, Non-congruent numbers, odd graphs and the Birch-Swinnerton-Dyer
conjecture, Acta Arith., 80 (1996), 71–83.
3. K. Feng and M. Xiong, On elliptic curves y2 = x3 −n2x with rank zero,
Jour. of Number Theory, 109 (2004), 1–26.

38
KEQIN FENG AND YAN XUE
4. K. Feng and Y. Xue, New series of odd non-congruent numbers, to appear
in Science in China (A), 2006.
5. K. Feng and Y. Xue, New series of non-congruent numbers n ≡10 (mod 16),
preprint, 2006.
6. A. Genocchi, Sur l’impossibilit´e de quelques ´egalit´es doubles, C.R. Acad. Sci.
Paris, 78 (1874), 423–436.
7. T. Goto, A study on the Selmer groups of elliptic curves with a rational
2-torsion, Kyushu University, Doctoral thesis, 2002.
8. J. M. Harris, J. L. Hirst, M. J. Mossignhoﬀ, Combinatorics and Graph The-
ory, Springer-Verlag, Berlin, 2000.
9. B. Iskra, Non-congruent numbers with arbitrarily many prime factors con-
gruent to 3 modulo 8, Proc. Japan Acad., 72 (1996), 168–169.
10. N. Koblitz, Introduction to Elliptic Curves and Modular Forms, GTM 97,
2nd ed. Springer-Verlag, 1993.
11. J. Lagrange, Construction d’une table de nombres congruents, Bull. Soc.
Math. France, Suppl. Mem., 49–50 (1977), 125–130.
12. J. Lagrange, Nombres congruents et courbes elliptiques, S´emin. Delange-
Pisot-Poitou, 1974/75, Fasc. 1, Expos´e 16,17pp.
13. F. Lemmermeyer, Some families of non-congruent numbers, Acta Arith., 110
(2003), 15–36.
14. F. R. Nemenzo, All congruent number less than 40000, Proc. Japan Acad.,
74 (1998) 29–31.
15. P. Serf, Congruent numbers and elliptic curves, in Computational Number
Theory (Debrecen, 1989), de Gruyter, 1991, 227–238.
16. J. Silverman, The Arithmetic of Elliptic Curves, GTM 106, Springer-Verlag,
1986.
17. J. B. Tunnell, A classical Diophantine problem and modular forms of weight
3/2, Invent. Math., 72 (1983), 323–334.
18. C. Zhao, A criterion for elliptic curves with lowest 2-power in L(1), Math.
Proc. Cambridge Philos. Soc., 121 (1997), 385–400.
19. C. Zhao, A criterion for elliptic curves with lowest 2-power in L(1) II, Acta
Math. Sinica (English ser.), 21 (2005), 961–976.

39
DISTRIBUTION OF UNITS
OF AN ALGEBRAIC NUMBER FIELD
MODULO AN IDEAL
YOSHIYUKI KITAOKA
Department of Mathematics, Meijo University,
Tenpaku, Nagoya, 468-8502, Japan
E-mail: kitaoka@ccmfs.meijo-u.ac.jp
Let F be an algebraic number ﬁeld and oF the maximal order of F. We are
interested in how units of F distribute in (oF /n)×, where n is an integral ideal.
When n is a prime ideal, we give the upper bound of the order of the subgroup
represented by units in (oF /n)×, using new invariants. Prime ideals are ruled
by an automorphism of an overﬁeld of F, which is a Galois extension of the
rationals. We give the expected density of the set of prime ideals which attain
the upper bound, taking account of Chebotarev’s density theorem. In the third
section, we try to generalize the above to principal ideals generated by rational
primes. On the contrary to the prime ideal case, there remain much to do even
in order to complete the algebraic framework.
1. Introduction
Let F be an algebraic number ﬁeld and oF the ring of algebraic integers
in F. The structure of the group o×
F of units in F is well described by
Dirichlet’s Theorem, which says that there exist a primitive w-th root ζw
of unity and units ϵ1, · · · , ϵr so that they generate o×
F and the equality
ζa0
w
Q
i ϵai
i = 1 implies a0 ≡0 mod w, a1 = · · · = ar = 0.
In this paper, we are interested in the distribution of units modulo an
integral ideal. For an integral ideal n, we put
E(n) =
©
ϵ mod n
¯¯ ϵ ∈o×
F
ª ¡
⊂(oF /n)× ¢
.
This is a ﬁnite group and therefore inﬁnitely many multiplicative relations
modulo n arise among units. We would like to know these relations, the
structures of E(n) and (oF /n)×/E(n). However, these are heavily dependent
on the modulus ideal n, and we are to extract a property common to some
appropriate set of ideals.

40
YOSHIYUKI KITAOKA
In §2, we take up the case that n is a prime ideal. In this case, (oF /n)×
is cyclic and the structure being determined by the order, this case is easier,
as already studied in [7]. Let us brieﬂy explain its outline (see the text for
details). Let K be a subsidiary extension ﬁeld of F, and assume that K
is a Galois extension of the rational number ﬁeld Q. We take an element
η ∈Gal(K/Q) to control prime ideals of F. g(x) ∈Z[x] is the monic
polynomial of minimal degree such that
W1(g(x)) :=
n
ϵg(η)¯¯¯ ϵ ∈o×
F
o
is a ﬁnite group, whose order we denote by δ1 (cf. (2.1)) and put (cf. (2.3))
δ0 = max
n
m
¯¯¯
m√ϵ
δ1g(ρ) = 1 for ∀ϵ ∈o×
F , ∀ρ|K = η
o
,
and we say that a prime ideal p of F corresponds to η if there is a prime
ideal of K lying above p whose Frobenius automorphism is η. Then, for
every prime ideal p of F corresponding to η, we see that #E(p) divides
δ1g(p)/δ0, where p denotes a rational prime number lying below p, and we
conjectured in [7]
#
n
p
¯¯¯ p < x, p ∤2DK, #E(p) = δ1g(p)/δ0 and p corresponds to η
o
∼den(η)Li(x),
where
den(η) =
£©
σ ∈Gal(K/F)
¯¯ ση = ησ
ª
: Gal(K/F) ∩⟨η⟩
¤−1
×
∞
X
m=1
µ(m)#Hδ0m(η)
[Kδ0m : Kη]
.
Here, µ(m) denotes the M¨obius function, Km = K
³
mq
o×
K
´
, Kη is the ﬁxed
subﬁeld of K by η and
Hm(η) =
n
ρ ∈Gal(Km/Q)
¯¯¯ ρ|K = η and
m√ϵ
δ1g(ρ) = 1 for ∀ϵ ∈o×
F
o
.
We showed that the expected density den(η) is indeed ﬁnite and positive.
The conjecture is true under Generalized Riemann Hypothesis in a few
cases [2,6,12–14]. We know the arithmetic frame-work, but as Artin’s con-
jecture on primitive roots, the remaining problem is the estimation of the
accumulation of error terms when we apply Chebotarev’s density theorem
to inﬁnitely many algebraic number ﬁelds.
In §3, we go on to study the case where n is a principal ideal generated
by a rational prime number. We have already studied a few cases ([8,9]). In

DISTRIBUTION OF UNITS
41
this paper, we deal with slightly wider classes; let F be a Galois extension
of Q and η an element of the center of Gal(F/Q). These two assumptions
play the essential role at present, although they should be loosened. The
automorphism η controls rational primes through the Frobenius automor-
phism. Denote the group of roots of unity in F by WF . Then, we see, as
η-modules
Q ⊗Z
¡
o×
F /WF
¢ ∼=
M
i
Q[di],
where Q[di] denotes the cyclotomic ﬁeld Q(ζdi) with η action given by
αη = ζdiα for α ∈Q(ζdi), and di is a divisor of the order d of η. Then,
writing E(p) for E((p)), we will see in Corollary 3.3 that
#E(p) = #WF
Y
i
|Φdi(p)|
.£
ker ιp : WF o×
F
η−p¤
for a rational prime p ( ∤2DF ) whose Frobenius automorphism is η. Here,
Φm(x) is the cyclotomic polynomial of index m, and a canonical mapping
ιp : o×
F →E(p)/WF is deﬁned by
ϵ 7→ϵ mod p.
Putting
Relη = gcd
p
£
ker ιp : WF o×
F
η−p¤
,
where p corresponds to η as above and is suﬃciently large (cf. (3.7)), we
have
#E(p)
¯¯¯ #WF
Y
i
|Φdi(p)|
.
Relη
and hence
Relη
¯¯¯ #WF
Y
i
|Φdi(p)|
.
#E(p).
Experimentally, we expect that there are inﬁnitely many prime numbers p
which correspond to η and satisfy Relη = #WF
Q
i |Φdi(p)|/#E(p), re-
placing “|”by “=”. We do not know how to evaluate Relη. But there is a
plausible description for it with supporting experimental data, which we
will explain below.
Putting together subgroups corresponding to the same di, we put, for a
divisor m of d
U(m) =
n
u ∈o×
F
¯¯¯ uΦm(η) ∈WF
o
.

42
YOSHIYUKI KITAOKA
Let g(x) be the polynomial deﬁned in the case K = F above, and deﬁne
natural numbers ˜∆and τm(˜η) for any extension ˜η of η as follows:
˜∆= max
n
t
¯¯¯ ζg(ρ)
t
= 1 for ∀ρ ∈Gal(F(ζt)/Q) satisfying ρ|F = η
o
,
τm = τm(˜η) := max
n
t
¯¯¯ ζΦm(˜η)
t
= 1, t| ˜∆
o
.
And for a prime number p whose Frobenius class in Gal
³
F
³
˜
∆q
o×
F
´.
Q
´
contains ˜η, we put
R(˜η) =



Y
m|d
vm
¯¯¯¯¯¯
(i) vm ∈U(m),
(ii) Q
m|d vΦm(p)/τm
m
≡ζ mod p for ∃ζ ∈WF


.
Here Φm(p)/τm is an integer, and the group R(˜η) depends only on ˜η in
spite of its deﬁnition. Obviously, it induces a subgroup of ker ιp
R(˜η, p) =
( Y
m|d
vΦm(p)/τm
m
¯¯¯¯¯
Y
m|d
vm ∈R(˜η)
)
WF o×
F
η−p,
and hence [ker ιp : WF o×
F
η−p] is divisible by the index [R(˜η, p) : WF o×
F
η−p],
which depends only on ˜η. Now we have
κ(η) := gcd
˜η
£
R(˜η, p) : WF o×
F
η−p¤ ¯¯¯ Relη.
After such preparations, we give κ(η) explicitly for several types of al-
gebraic number ﬁelds of low degree in §4, and making use of it, we conﬁrm
the existence of a prime number p satisfying κ(η) = [ker ιp : WF o×
F
η−p] by
computer experiment, which yields the expectation Relη = κ(η).
As referred to above, we have already studied several cases [8] where the
rank of o×
F is one. There, we have given the value κ(η) by experiments and
showed that the expected density of the set of primes p satisfying κ(η) =
#WF
Q |Φdi(p)|/#E(p) is indeed positive. Our argument here elucidates
the theoretical background of their values.
In the appendix, we give the structure of the Galois group of the ﬁeld
extended by roots of units, which is necessary to consider all extensions ˜η
of η explicitly.
Notations : For an algebraic number ﬁeld L, we denote by oL, o×
L, WL,
DL, Lm the ring of algebraic integers in L, the group of units in L, the
group of roots of unity in L, the discriminant of L, and the ﬁeld L
³
mq
o×
L
´
extended by all m-th roots of units in L, respectively. Assume that L is a

DISTRIBUTION OF UNITS
43
Galois extension over Q. σL/Q(p) denotes the Frobenius automorphism of
a prime ideal of p of L, and for a prime number p lying below p, σL/Q(p)
denotes a conjugacy class {ρσL/Q(p)ρ−1 | ρ ∈Gal(L/Q)}. For integers a, b
we denote their greatest common divisor by (a, b) or by gcd(a, b). For a
polynomial f(x) = a0 +a1x+· · ·+anxn ∈Z[x], ρ ∈Gal(L/Q) and u ∈L×,
we write
uf(ρ) =
n
Y
t=0
uatρt.
We denote by F an algebraic number ﬁeld, with which we are mainly con-
cerned in this article, and for an integral ideal n of F, we put
E(n) =
©
ϵ mod n
¯¯ ϵ ∈o×
F
ª ¡
⊂(oF /n)×¢
.
We denote #WF by w. For a natural number n, ζn is a primitive n-th root
of unity and the polynomial
Φn(x) =
Y
(a,n)=1
(x −ζa
n)
is the cyclotomic polynomial of index n. For a polynomial h(x), we put
h(x, y) = h(x) −h(y)
x −y
.
2. Case of prime ideals
Throughout this section, ﬁelds K ⊃F are ﬁxed algebraic number ﬁelds and
we assume that #o×
F = ∞and that K is a Galois extension of the rational
number ﬁeld Q. We choose and ﬁx an element η ∈Gal(K/Q) to control
prime ideals of F through the Frobenius automorphism.
2.1. Polynomial g(x)
First, we introduce a key polynomial g(x), which plays a central role.
Lemma 2.1. Let g(x) be a non-zero polynomial in Z[x] such that
W1(g(x)) :=
n
ϵg(η) ¯¯¯ ϵ ∈o×
F
o
is a ﬁnite group. We ﬁx a primitive polynomial g(x) of minimal degree
among them. Then it divides xd −1 in Z[x] for
d :=
£
⟨η⟩: ⟨η⟩∩Gal(K/F)
¤
.

44
YOSHIYUKI KITAOKA
Proof. By virtue of ηd ∈Gal(K/F), W1(xd −1) = {1} is clear and we may
take a primitive polynomial g(x) of minimal degree satisfying #W1(g(x)) <
∞. Then there exist an integer a and polynomials q(x), r(x) ∈Z[x] so that
a(xd−1) = q(x)g(x)+r(x) and deg r(x) < deg g(x). The assumption #o×
F =
∞implies deg g(x) ≥1. For ϵ ∈o×
F , we have ϵr(η) = ϵa(ηd−1)−q(η)g(η) =
(ϵg(η))−q(η) and hence W1(r(x)) is a ﬁnite group. Hence the minimality of
deg g(x) implies r(x) = 0 and then the primitiveness of both xd −1 and
g(x) entails that g(x) divides xd −1.
Since the polynomial g(x) divides xd −1, we may assume that g(x)
is monic. Hereafter the monic polynomial g(x) means the one deﬁned in
Lemma 2.1 and put
δ1 := #W1(g(x)).
(2.1)
Example 2.1. If η ∈Gal(K/F) holds, then obviously ϵη = ϵ for any
ϵ ∈o×
F , and so we have g(x) = x−1 and δ1 = 1. Although the determination
of g(x) in general is complicated, we know the following [7]:
Suppose that K = F is a Galois extension of Q; then the polyno-
mial g(x) is given as follows:
(R) The case where F is real.
(R1) g(x) = xd−1 + xd−2 + · · · + 1 if Gal(F/Q) = ⟨η⟩.
(R2) g(x) = xd −1 otherwise.
(I) The case where F is imaginary.
We denote the complex conjugation by J.
(I1) g(x) = xd−1 + xd−2 + · · · + 1 if [Gal(F/Q) : ⟨η⟩] = 2 and
J ̸∈⟨η⟩.
(I2) g(x) = xd −1 if [Gal(F/Q) : ⟨η⟩] > 2 and J ̸∈⟨η⟩.
(I3) g(x) = xd/2−1 + xd/2−2 + · · · + 1 if Gal(F/Q) = ⟨η⟩.
(I4) The case of J ∈⟨η⟩̸= Gal(F/Q).
(i) If there is an element u ∈Gal(F/Q) such that
JuJ−1u−1 ̸∈⟨η⟩, then g(x) = xd −1.
(ii) If JuJ−1u−1 ∈⟨η⟩holds for every element u ∈
Gal(F/Q), then g(x) = xd/2 −1.
Remark. In the case of (ii) in (I4), g(x) is (xd/2 −1)(P
i xai −
P
i xbi) in [7], but it turns out that it must be xd/2 −1 in virtue of
J = ηd/2 ∈Z(Gal(F/Q)).

DISTRIBUTION OF UNITS
45
In the general case, suppose that there is a real inﬁnite place of F;
then we can show
g(x) =
(
xd−1 + xd−2 + · · · + 1
if [F : Q] = d,
xd −1
otherwise.
But in the case of F being totally imaginary, the evaluation of g(x)
is not easy.
2.2. Upper bound for #E(p)
Let P (∤2DK) be an unramiﬁed prime ideal of K whose Frobenius auto-
morphism σK/Q(P) is η; then we say a prime number p and a prime ideal
p of F lying below P correspond to η. Note that the assumption yields
that the condition ζ ≡1 mod P for a root of unity ζ in K implies ζ = 1.
By ramiﬁcation theory, in particular, applying the assertion (3) for i = 1
in the following theorem to L = K, M = F, N = Q and Q = P with
H = Gal(K/F) and Z = ⟨η⟩, we derive that
d :=
£
⟨η⟩: ⟨η⟩∩Gal(K/F)
¤
= deg(P ∩F),
(2.2)
where pdeg p signiﬁes the number of elements of the residue class ﬁeld mod-
ulo a prime ideal p.
Hilbert’s ramiﬁcation theory for intermediate ﬁelds :
Let L ⊃M ⊃N be algebraic number ﬁelds, and suppose that L/N
is a Galois extension with Galois group G, and that H is the sub-
group corresponding to M. For a prime ideal Q of L, the decom-
position group and the inertia group of Q with respect to L/N are
denoted by Z, T respectively. Then we have
(1) For σ, τ ∈G, Qσ ∩M = Qτ ∩M if and only if ZσH = ZτH.
(2) Let
G = Zσ1H + · · · + ZσsH
(σ1 = id)
be
the
double
coset
decomposition.
Then
the
ideals
Qσ1 ∩
M, · · · , Qσs ∩M are all distinct prime ideals of M lying above
Q ∩N.
(3) Let ei, fi be the ramiﬁcation index and the relative degree of
Qσi ∩M with respect to M/N respectively. Then we have
eifi =
£
σ−1
i
Zσi : σ−1
i
Zσi ∩H
¤
,
ei =
£
σ−1
i
Tσi : σ−1
i
Tσi ∩H
¤
.

46
YOSHIYUKI KITAOKA
Lemma 2.2. We put
h(x) := (xd −1)/g(x) (∈Z[x]).
If a prime number p ( ∤2DK) corresponds to η, then δ1 divides h(p).
Proof. Take a unit ϵ ∈o×
F such that ϵg(η) is a primitive δ1-th root of
unity, and let P be an unramiﬁed prime ideal of K lying above p such that
σK/Q(P) = η, and put p = P ∩F. For a generator α ∈oF of (oF /p)×, we
put ϵ ≡αa mod p (a ∈Z). Then we have
1 = ϵδ1g(η) ≡ϵδ1g(p)
mod P
≡αaδ1g(p) mod P,
which implies 1 ≡αaδ1g(p) mod p. Since by (2.2) d = deg p, there is an
integer b such that ag(p)δ1 = (pd −1)b, or aδ1 = h(p)b. We have only to
show that (δ1, b) = 1. Suppose that q is a prime number dividing (δ1, b);
then we have
ϵg(p)δ1/q ≡αag(p)δ1/q ≡α(pd−1)b/q ≡1 mod p,
which implies ϵg(η)δ1/q ≡1 mod P. Since ϵg(η)δ1/q is a root of unity in K
and P ∤2DK, we have ϵg(η)δ1/q = 1. This contradicts the fact that ϵg(η) is
a primitive δ1-th root of unity.
Lemma 2.3. Let m be a natural number and p (∤m) a prime ideal of F
corresponding to η. Let Pm(| p) be a prime ideal of Km whose Frobenius
automorphism ρ is an extension of η. Then we have
m#E(p) | δ1g(p) ⇐⇒
m√ϵ
δ1g(ρ) = 1 for ∀ϵ ∈o×
F ,
where p is a prime number lying below p and
m√ϵ means all m-th roots of ϵ.
Proof. The left-hand side assertion is equivalent to m | δ1g(p) and
ϵδ1g(p)/m ≡1 mod p for ∀ϵ ∈o×
F as (oF /p)× is cyclic. Since
m√ϵδ1g(ρ) is an
m-th root of unity in Km for ϵ ∈o×
F , the congruence ϵδ1g(p)/m ≡1 mod Pm
is equivalent to
m√ϵδ1g(ρ) = 1 by p ∤2mDK. Therefore the left-hand side
assertion is equivalent to m | δ1g(p) and
m√ϵδ1g(ρ) = 1 for ∀ϵ ∈o×
F . Noting
that the condition m | δ1g(p) is contained in the second condition, taking
1 as ϵ, we complete the proof.
In the lemma, the right-hand side assertion holds for m = 1 and there-
fore
#E(p) | δ1g(p).

DISTRIBUTION OF UNITS
47
We note that
m#E(p) | δ1g(p) ⇐⇒m · h(p)/δ1 | [(oF /p)× : E(p)],
where h(p)/δ1 is an integer by Lemma 2.2.
We put for a natural number m
Hm(η) :=
n
ρ ∈Gal(Km/Q)
¯¯¯ ρ|K = η and
m√ϵ
δ1g(ρ) = 1 for ∀ϵ ∈o×
F
o
.
Here
m√ϵ means all m-th roots of ϵ and so ζδ1g(ρ)
m
= 1 for ρ ∈Hm(η). Now
we introduce another constant
δ0 = max
n
m
¯¯¯
m√ϵ
δ1g(ρ) = 1 for ∀ϵ ∈o×
F , ∀ρ ∈Gal(Km/Q) with ρ|K = η
o
.
(2.3)
The maximum is assured to exist, by applying Proposition 5.1 in the ap-
pendix to L = K, f(x) = δ1g(x) with ϵ = 1. Then, taking m = δ0 in Lemma
2.3, we have
#E(p)
¯¯ δ1g(p)/δ0
for all prime ideals p corresponding to η. The evaluation of δ0 is not easy
in general.
Proposition 2.1. We have (δ0, δ1) = 1 and δ0 | g(p) for a prime number p
corresponding to η.
Proof. Let m be a divisor of (δ0, δ1). Take ϵ = ϵ0 ∈o×
F so that the order of
ϵg(η)
0
is δ1; then δ0√ϵ0
δ1g(ρ) = 1 for any extension ρ of η implies ϵ(δ1/m)g(η)
0
= 1,
which yields m = 1, i.e., (δ0, δ1) = 1. Then, Lemma 2.3 implies δ0 | g(p).
Proposition 2.2. Let p be a prime ideal corresponding to η. For a natural
number m, which is not divisible by p, the condition m | δ1g(p)/#E(p)
holds if and only if ρ := σKm/Q(Pm) ∈Hm(η), where Pm is a prime ideal
of Km lying above p and satisﬁes σK/Q(Pm ∩K) = η.
Proof. This is an immediate consequence of Lemma 2.3.
2.3. Conjecture
The previous proposition means that for any given natural number m, the
condition on p that δ1g(p)/#E(p) is a multiple of m is characterized in
terms of Frobenius automorphisms. Therefore, after some transformations,
we can apply Chebotarev’s density theorem (see [7] for details).

48
YOSHIYUKI KITAOKA
Theorem 2.1. Let m be a natural number. If p is a prime ideal of F and
p is a prime number lying below it, then the density of the set
n
p
¯¯¯ p̸ | 2mδ0DK, m#E(p) | g(p)δ1/δ0, and p corresponds to η
o
is equal to
£©
σ ∈Gal(K/F)
¯¯ ση = ησ
ª
: Gal(K/F) ∩⟨η⟩
¤−1 #Hmδ0(η)
[Kmδ0 : Kη].
Here Kη is a subﬁeld of K ﬁxed by ⟨η⟩.
Then the usual procedure
X
p :#E(p)=g(p)δ1/δ0
1 =
X
m
µ(m)
X
p :m#E(p)|g(p)δ1/δ0
1
suggests
Conjecture 2.1. Denoting by den(η)
£©
σ ∈Gal(K/F)
¯¯ ση = ησ
ª
: Gal(K/F) ∩⟨η⟩
¤−1
∞
X
m=1
µ(m)#Hδ0m(η)
[Kδ0m : Kη]
,
and denoting a prime number and a prime ideal of F by p, p (p | p), we
have
#
n
p
¯¯¯ p < x, p̸ | 2DK, #E(p) = g(p)δ1/δ0 and p corresponds to η
o
∼den(η)Li(x).
That the inﬁnite sum den(η) is convergent to a positive number is shown
in [7]. We note that the condition p < x is used instead of NF/Q(p) < x,
and so this is a modiﬁcation of the usual natural density. This conjecture is
a generalization of [2,6,12–14] and hence the conjecture for a real quadratic
ﬁeld K = F is true under the Generalized Riemann Hypothesis. When η ∈
Gal(K/F), we know that d = 1 and g(x) = x −1 in Lemma 2.1 and hence
both σK/Q(P) = σK/F (P) and h(x) = 1 hold. Therefore the conjecture is
true under G.R.H. by a result of [12]. The situation of [12] is as follows:
Let K/F be a ﬁnite Galois extension and let C be a union of conjugacy
classes of Gal(K/F), and W is a ﬁnitely generated subgroup of F × of
ﬁnite rank (≥1) modulo its torsion subgroup, and k is an integer (> 0). In
[12], under G.R.H. it is shown that the density of the set M(F, K, C, W, k)
of prime ideals p of F exists. Here p is in M(F, K, C, W, k) if and only
if for a prime ideal P of K lying above p, the Frobenius automorphism
σK/F (P) is in C, ordp(w) = 0 for all w ∈W and the index [(oF /p)× : {w

DISTRIBUTION OF UNITS
49
mod p | w ∈W}] divides k. Hence the index is bounded. In contrast to
this, our case allows that [(oF /p)× : E(p)] tends to inﬁnity.
3. Case of rational primes
Hereafter, we study the distribution of units modulo (p), writing E(p) for
E((p)), where p is a rational prime, and we restrict ourselves to the case
where K = F is a Galois extension of Q, and we let η ∈Gal(F/Q). From
Corollary 3.3 to the end of this section, we will assume η ∈Z(Gal(F/Q)).
Because, this yields that for ϵ ∈o×
F , we have
ϵη ≡ϵp mod p
if a prime number p corresponds to η.
3.1. Structure of o×
F as an η-module
Lemma 3.1. Let d be a natural number. For a divisor m of d, we put
Θm(x) =
d−1
X
k=0
µ
X
a mod m
(a,m)=1
ζak
m
¶
xk ∈Z[x].
Then we have
X
m|d
Θm(x) = d,
xd −1
¯¯¯ Θm(x)Φm(x).
Proof. Let ζ be a d-th root of unity; then there exist a divisor m of d
and an integer a so that ζ = ζa
m, where m and a mod m ((a, m) = 1) are
uniquely determined, and hence we have
X
m|d
µ
X
a mod m
(a,m)=1
ζak
m
¶
=
X
j mod d
ζjk
d =
½ 0
if k ̸≡0 mod d,
d
if k ≡0 mod d,
which yields
X
m|d
Θm(x) = d.
Next, let us show that (xd −1)/Φm(x) | Θm(x). Since a root of (xd −
1)/Φm(x) = 0 is not a primitive m-th root of unity, we have only to show
that Θm(ζb
d) = 0 for every integer b so that ζb
d, being a d-th root of unity, is

50
YOSHIYUKI KITAOKA
not a primitive m-th root of unity. Let b be an integer; then for an integer
a satisfying (a, m) = 1, we have
ζda/m+b
d
= 1 ⇒ad/m + b ≡0 mod d
⇒am1 + b ≡0 mod mm1
( putting d = mm1)
⇒b = m1m2, m2 ≡−a mod m
( for ∃m2 ∈Z)
⇒ζb
d = ζm2
m
is a primitive m-th root of unity.
This shows for (a, m) = 1 that if ζb
d is not a primitive m-th root of unity,
then ζad/m+b
d
̸= 1 and so we have
Θm(ζb
d) =
X
a mod m
(a,m)=1
d−1
X
k=0
(ζad/m+b
d
)k = 0.
This completes the proof of (xd −1)/Φm(x) | Θm(x).
Lemma 3.2. For a divisor m of d, decompose xd −1 as
Φm(x)Ψm(x) = xd −1.
Then there exist polynomials um(x), vm(x) in Z[x] satisfying
um(x)Φm(x) + vm(x)Ψm(x) = d.
(3.1)
Proof. We put directly as follows :
um(x) = xΨ′
m(x) −deg Ψm(x) · Ψm(x) ∈Z[x],
vm(x) = xΦ′
m(x) −deg Φm(x) · Φm(x) ∈Z[x].
Then we have
um(x)Φm(x) + vm(x)Ψm(x)
=
¡
xΨ′
m(x) −deg Ψm(x) · Ψm(x)
¢
Φm(x)
+
¡
xΦ′
m(x) −deg Φm(x) · Φm(x)
¢
Ψm(x)
= x
¡
Ψ′
m(x)Φm(x) + Φ′
m(x)Ψm(x)
¢
−
¡
deg Ψm(x) + deg Φm(x)
¢
Φm(x)Ψm(x)
= x(xd −1)′ −d(xd −1)
= d.
We ﬁx η ∈Gal(F/Q) and denote the order of η by d :
#⟨η⟩= d.
(3.2)

DISTRIBUTION OF UNITS
51
Proposition 3.1. Let m be a positive divisor of d. Then
U(m) =
n
u ∈o×
F
¯¯¯ uΦm(η) ∈WF
o
(3.3)
is an η-stable subgroup of o×
F , and we have
o×
F
Θm(η), o×
F
Ψm(η) ⊂U(m),
o×
F
d ⊂
Y
m|d
U(m) ⊂o×
F .
If η is in the center of Gal(F/Q), then U(m) is Gal(F/Q)-stable.
Proof. It is easy to see that U(m) is η-stable, and if we assume that η is
in the center of Gal(F/Q), uρΦm(η) = uΦm(η)ρ holds for ρ ∈Gal(F/Q) and
u ∈o×
F , and so U(m) is a Gal(F/Q)-stable subgroup. By previous lemmas,
we know that
Θm(x)Φm(x) ≡Ψm(x)Φm(x) ≡0 mod xd −1,
whence Θm(η)Φm(η) = Ψm(η)Φm(η) = 0, which implies the left-hand side
inclusion. Then Lemma 3.1 yields
ud = u
P
m|d Θm(η) =
Y
m|d
uΘm(η),
which implies the right-hand side inclusion.
Proposition 3.2.
(i) Let um, vm be elements in U(m) and ζ ∈WF . Then
Y
m|d
um = ζ
Y
m|d
vm
implies
um/vm ∈WF ,
∀m | d.
(ii) Let q be a natural number and um ∈U(m), ζ ∈WF . If
Y
m|d
um ≡ζ mod q,
then there are roots κm’s of unity in WF such that
ud
m ≡κm mod q,
∀m | d.

52
YOSHIYUKI KITAOKA
Proof. To prove the assertions, we may assume ζ = vm = 1, taking the
quotient of both sides and absorbing ζ−1 into u1. Let um(x), vm(x), Ψm(x)
be those in Lemma 3.2. The assertion (i) is proved as follows. Noting that
um = Q
n|d
n̸=m u−1
n , we have by (3.1)
ud
m =
Y
n|d
n̸=m
u−um(η)Φm(η)−vm(η)Ψm(η)
n
=
µ Y
n|d
n̸=m
un
¶−vm(η)Ψm(η)
· uum(η)Φm(η)
m
,
which we rewrite as
ud
m =
µ Y
n|d
n̸=m
(uΦn(η)
n
)−vm(η)(Ψm/Φn)(η)
¶
· uΦm(η)um(η)
m
,
where we note that Φn(x) divides Ψm(x) if n ̸= m. Hence, recalling (3.3),
uΦn(η)
n
∈WF implies ud
m ∈WF and so um ∈WF .
Next, we assume Q um ≡1 mod q; then similarly as above we have
ud
m ≡
Y
n|d
n̸=m
(uΦn(η)
n
)−vm(η)(Ψm/Φn)(η) · uΦm(η)um(η)
m
mod q,
and the right-hand side is in WF and denoted by κm.
Remark 3.1. In (ii), a stronger conclusion um ≡κm mod q does not hold
in general.
Considering U(m)/WF as a Z-lattice, we put
V (m) = U(m)/WF ⊗Z Q.
f(x) ∈Z[x] acts on U(m) by u 7→uf(η), and so U(m)/WF is a Z[x]-module
annihilated by Φm(x). Hence Q[x]/(Φm(x)) acts on V (m). Thus V (m) is
a vector space over Q(ζm), and thus the following Lemma 3.3 (Exercise 2
on p.282 in [3]) is clear. Note that f(x) ∈Q[x]/(Φm(x)) acts on Q(ζm) by
α 7→f(ζm)α (α ∈Q(ζm)).
Lemma 3.3. As η-modules, we have
Q ⊗Z
¡
o×
F /WF
¢ ∼=
M
i
Q[di],
where Q[di] is Q(ζdi) viewed as a representation space of η, on which η acts
by αη = ζdiα for α ∈Q(ζdi), and di is a divisor of the order d of η.

DISTRIBUTION OF UNITS
53
Now let 1, ζdi, · · · , ζϕ(di)−1
di
be a basis of Z[ζdi] ( ⊂Q[di] ) and put
Φdi(x) = a0 + a1x + · · · + aϕ(di)−1xϕ(di)−1 + xϕ(di).
Then we have
1η = ζdi,
ζη
di = ζ2
di, · · · ,
n
ζϕ(di)−1
di
oη
= ζϕ(di)
di
= −
³
a0 + a1ζdi + · · · + aϕ(di)−1ζϕ(di)−1
di
´
.
Hence denoting by Ui the subgroup of o×
F corresponding to nZ[ζdi] for an
appropriate natural number n in Lemma 3.3 where n is suﬃciently large
to kill the ambiguity of WF , Q Ui is a subgroup of ﬁnite index of o×
F , and
each U = Ui has a basis U = ⟨ϵ0, ϵ1, · · · , ϵϕ(di)−1⟩(ϵj ↔ζj
di) such that
ϵη
i = ϵi+1 (i = 0, 1, · · · , ϕ(di) −2),
ϵa0
0 ϵa1
1 · · · ϵ
aϕ(di)−1
ϕ(di)−1 ϵη
ϕ(di)−1 = 1.
Lemma 3.4. For the subgroup U = Ui above, and h(x) ∈Z[x], we have
U h(η) ⊂WF ⇔Φdi(x)
¯¯ h(x)
Proof. The assertion follows from
U h(η) ⊂WF ⇔h(ζdi)Z[ζdi] = 0 ⇔h(ζdi) = 0 ⇔Φdi(x)
¯¯ h(x).
Corollary 3.1. Let g(x) be the polynomial deﬁned in the previous section
for K = F and η, i.e. the monic polynomial in Z[x] of minimal degree such
that
n
ϵg(η) ¯¯¯ ϵ ∈o×
F
o
is a ﬁnite group. Then g(x) is equal to
lcmi Φdi(x) =
Y
m|d,U(m)̸=WF
Φm(x).
Proof. By Lemma 3.4, the following equivalence holds for h(x) ∈Z[x]
n
ϵh(η) ¯¯¯ ϵ ∈o×
F
o
⊂WF ⇔U h(η)
i
⊂WF for ∀i ⇔Φdi | h for ∀i.
Thus we have g(x) = lcmi Φdi(x). Similarly for U(m) in (3.3), it is easy to
seen
ϵh(η) ¯¯¯ ϵ ∈o×
F
o
⊂WF ⇔U(m)h(η) ⊂WF for ∀m ⇔Φm | h for ∀m,
where m should satisfy the condition U(m) ̸= WF . Because, the ﬁrst equiv-
alence is obvious, and the right-hand side divisibility implies the middle

54
YOSHIYUKI KITAOKA
inclusion. Assume the middle inclusion. If Φm(x) ∤h(x), then there are
polynomials f1(x), f2(x) ∈Z[x] such that f1(x)Φm(x) + f2(x)h(x) = e ∈
Z (e ̸= 0), and hence U(m)e ⊂WF , which yields U(m) ⊂WF . This con-
tradicts U(m) ̸= WF and hence we obtain the right-hand side divisibility.
Thus we have g(x) = Q
m|d,U(m)̸=WF Φm(x).
Theorem 3.1. For an integer p (̸= ±1), we have
£
o×
F : WF o×
F
η−p¤
=
Y
i
|Φdi(p)|,
where di’s are those in Lemma 3.3.
To prove the theorem, we need some lemmas.
Lemma 3.5. For ϵ ∈o×
F and for an integer p (̸= ±1), the inclusion ϵη−p ∈
WF implies ϵ ∈WF . Moreover, let o×
F ⊃U ⊃V ⊃WF be η-groups; then
the mapping φ : ϵ 7→ϵη−p from U to WF U η−p induces an isomorphism
U/V ∼= WF U η−p/WF V η−p.
Proof. Suppose ϵη−p ∈WF for ϵ ∈o×
F . Inductively, it is easy to see that
there is an element κn ∈WF such that
ϵηn = κnϵpn.
The assumption ηd = id yields ϵ = κdϵpd. Hence we have ϵ1−pd = κd ∈WF ,
which implies ϵ ∈WF by 1 −pd ̸= 0.
Next, suppose φ(ϵ) ∈WF V η−p for ϵ ∈U; then ϵη−p = ζvη−p (ζ ∈
WF , v ∈V ) holds. Thus (ϵ/v)η−p = ζ implies ϵ/v ∈WF and ϵ ∈V , which
completes the proof.
Lemma 3.6. Let U1, U2, U be η-subgroups of o×
F and suppose
U1U2 ⊂U,
U1 ∩U2 = WF ,
[U : U1U2] < ∞.
Then we have
[U : WF U η−p] = [U1 : WF U η−p
1
][U2 : WF U η−p
2
].
Proof. A canonical mapping (u1, u2) 7→u1u2 from U1×U2 to U1U2 induces
a surjective homomorphism
f : U1 × U2 →U1U2/WF (U1U2)η−p,

DISTRIBUTION OF UNITS
55
and it is easy to see ker f ⊃WF U η−p
1
× WF U η−p
2
and
(u1, u2) ∈ker f ⇒u1u2 ∈WF (U1U2)η−p
⇒u1u2 = ζ(v1v2)η−p
(ζ ∈WF , vi ∈Ui)
⇒ζ′ :=
u1
vη−p
1
= ζ vη−p
2
u2
∈U1 ∩U2 = WF
⇒u1 = ζ′vη−p
1
, u2 = (ζ/ζ′)vη−p
2
Hence we have ker f ⊂WF U η−p
1
× WF U η−p
2
and so ker f = WF U η−p
1
×
WF U η−p
2
, which implies
[U1U2 : WF (U1U2)η−p] = [U1 : WF U η−p
1
][U2 : WF U η−p
2
].
(3.4)
Lemma 3.5 yields
[U : U1U2] = [WF U η−p : WF (U1U2)η−p].
(3.5)
From (3.4) and (3.5) we have
[U : WF U η−p] = [U : U1U2][U1U2 : WF (U1U2)η−p]
[WF U η−p : WF (U1U2)η−p]
= [U1 : WF U η−p
1
][U2 : WF U η−p
2
].
Lemma 3.7. Suppose for an η-subgroup U we have
U = WF
n
ϵf(η) ¯¯¯ f(x) ∈Z[x]
o
for some ϵ ∈o×
F . Let h(x) ∈Z[x] be a primitive polynomial of minimal
degree such that U h(η) ⊂WF . Then U/WF U η−p is a cyclic group generated
by a coset ϵWF U η−p and the following holds:
£
U : WF U η−p¤
= |h(p)|,
WF U η−p = WF
½
ϵA(η)
¯¯¯¯
A(x) ∈Z[x] with deg A(x) < deg h(x) and
A(p) ≡0 mod h(p)
¾
.
Proof. By the assumption ηd = id, we have U ηd−1 = {1} ⊂WF and so
the polynomial h(x) referred to in the lemma exists. Dividing xd −1 by
h(x), we write
xd −1 = q(x)h(x) + r(x)
(q(x), r(x) ∈Q[x], deg r(x) < deg h(x)),
and choose a non-zero integer a such that aq(x), ar(x) ∈Z[x]. Then by
virtue of
ϵar(η) = ϵa(ηd−1)−aq(η)h(η) = (ϵh(η))−aq(η) ∈WF ,

56
YOSHIYUKI KITAOKA
we have r(x) = 0 by the choice of h(x). Hence xd −1 = q(x)h(x), and we
may assume that h(x) is monic. We let its degree be n.
Because of ϵ ∈U, ϵη−p ∈U η−p is clear and hence we have ϵηWF U η−p =
ϵpWF U η−p, and so U/WF U η−p is a cyclic subgroup generated by ϵWF U η−p.
Since h(x) is a monic polynomial of degree n, we have
U = WF
­
ϵ, ϵη, · · · , ϵηn−1®
.
We note that ϵA(η) ∈WF for a polynomial A(x) ∈Z[x] with deg A(x) <
deg h(x) implies A(x) = 0. Because, ϵA(η) ∈WF yields U A(η) ⊂WF and
therefore the deﬁnition of h(x) implies A(x) = 0.
Now, let us show the second assertion; put
v = ϵA(η) ∈U,
A(x) = a0 + a1x + · · · + an−1xn−1 ∈Z[x].
We shall show that v ∈WF U η−p is equivalent to A(p) ≡0 mod h(p). To
this end, write
h(x) =
n
X
i=0
hixi,
hn = 1.
First, assume v = κuη−p ∈WF U η−p and put u = ϵb0+b1η+···+bn−1ηn−1; then
we have
v = κϵ(b0+b1η+···+bn−1ηn−1)(η−p)
= κϵb0η+b1η2+···+bn−1ηn−p(b0+b1η+···+bn−1ηn−1)
= κϵbn−1h(η)
×ϵb0η+b1η2+···+bn−2ηn−1−bn−1(h0+···+hn−1ηn−1)−p(b0+b1η+···+bn−1ηn−1).
By the choice of h(x), ϵbn−1h(η) ∈WF , whence comparing the exponent
of ϵ, we obtain
a0 = −bn−1h0 −pb0,
ak = bk−1 −bn−1hk −pbk,
1 ≤k ≤n −1.
Hence, putting B(x) = Pn
k=1 bk−1xk−1, we get
B(x) =
n−1
X
k=1
(bn−1hk + pbk + ak)xk−1 + bn−1xn−1,
which we may rewrite as
bn−1(h(x) −h0)/x + p(B(x) −b0)/x +
n−1
X
k=1
akxk−1,

DISTRIBUTION OF UNITS
57
whence
(x −p)B(x) = bn−1h(x) −bn−1h0 −pb0 +
n−1
X
k=1
akxk = bn−1h(x) + A(x).
Substituting x = p, we have A(p) = −bn−1h(p), i.e., h(p) | A(p).
If, conversely h(p) | A(p) holds, then we deﬁne bn−1 ∈Z by A(p) =
−bn−1h(p). Then x −p divides bn−1h(x) + A(x) and we may put
bn−1h(x) + A(x) = (x −p)B(x),
B(x) ∈Z[x].
The leading coeﬃcient of B(x) is bn−1 and so we may put B(x) =
Pn−1
k=0 bkxk for some integers b0, · · · , bn−2. Then we have v = ϵA(η) =
(ϵh(η))−bn−1(ϵB(η))η−p. Since by the choice of h(x), ϵh(η) ∈WF , we obtain
v ∈WF U η−p. Thus we have shown the equivalence and the last assertion
in the lemma.
Since U/WF U η−p is generated by ϵWF U η−p, the index [U : WF U η−p]
is equal to the order of ϵWF U η−p. Applying the last assertion to A(x) =
m ∈Z, we conclude that the condition ϵm ∈WF U η−p is equivalent to m ≡
0 mod h(p). Hence the second assertion [U : WF U η−p] = |h(p)| follows.
Proof of Theorem 3.1. By Lemma 3.3, there are η-subgroups Ui of o×
F
such that Ui/WF ∼= Z[ζdi] and Ui/WF ’s form a direct product in o×
F /WF .
[Ui : WF U η−p
i
] = |Φdi(p)| follows from Lemma 3.7, and then Lemma 3.6
completes the proof of the theorem.
Corollary 3.2. Suppose that p(̸= ±1) is an integer; then we have for U(m)
deﬁned in (3.3)
£
U(m) : WF U(m)η−p¤
= |Φm(p)|r,
U(m)Φm(p) ⊂WF U(m)η−p,
where r is deﬁned by rϕ(m) = rankZU(m).
Proof. Recalling that Q ⊗Z (U(m)/WF ) is a vector space over Q(ζm), we
denote its dimension by r. Therefore U(m) contains a subgroup which is
isomorphic to a direct product of r copies of Z[ζm] as η-modules. Then the
ﬁrst equation follows from Lemmas 3.6 and 3.7.
Let u ∈U(m); then uΦm(η)−Φm(p) = uΦm(η,p)(η−p) ∈U(m)η−p (cf.
Notation) and U(m)Φm(η) ⊂WF (cf. (3.3)) together imply uΦm(p) ∈
WF U(m)η−p.
From now on, we assume η ∈Z(Gal(F/Q)).

58
YOSHIYUKI KITAOKA
Corollary 3.3. Suppose that η be in the center of Gal(F/Q), and a prime
number p ( ∤2DF ) satisﬁes η = σF/Q(p) (cf. Notation). Then for a canonical
surjective mapping
ιp : o×
F →E(p)/WF
deﬁned by
ϵ 7→ϵ mod p
we have
#E(p) = w [o×
F : WF o×
F
η−p]
[ker ιp : WF o×
F
η−p]
=
w Q
i |Φdi(p)|
[ker ιp : WF o×
F
η−p]
,
(3.6)
where w = #WF .
Proof. Since η is in the center of Gal(F/Q), it follows from η = σF/Q(p)
that ϵη−p ≡1 mod p holds for ϵ ∈o×
F , and so we have WF (o×
F )η−p ⊂ker ιp,
whence by the homomorphism theorem
#(E(p)/WF ) = #E(p)/w =
[o×
F : WF o×
F
η−p]
[ker ιp : WF o×
F
η−p]
=
Q
i |Φdi(p)|
[ker ιp : WF o×
F
η−p]
by Theorem 3.1.
In regard to this, under the assumption η ∈Z(Gal(F/Q)), we put
Relη = gcd
p
£
ker ιp : WF o×
F
η−p¤
,
(3.7)
where prime numbers p satisfy σF/Q(p) = η and p ∤2DF ˜
∆for a constant ˜∆
deﬁned in the next subsection. Then we have
#E(p)
¯¯¯¯
w Q
i |Φdi(p)|
Relη
.
This upper bound seems to be the best one. Although we do not know
how to evaluate Relη, there is a candidate κ(η) for it, which is a divisor of
Relη by deﬁnition. We will explain it in the next subsection, and in §4, we
describe κ(η) explicitly for several types of algebraic number ﬁelds.

DISTRIBUTION OF UNITS
59
3.2. Relη and κ(η)
In this subsection, we deﬁne a candidate κ(η) for Relη and in §3.3, we
rewrite it to evaluate easily it, and in §4, we write it down explicitly for
several types of algebraic number ﬁelds. Computer experiments convince
us of the truth of the conjecture. As before, let η ∈Z(Gal(F/Q)) and let
the polynomial g(x) be as in Corollary 3.1. We put
˜∆= max
n
t ∈N
¯¯¯ ζg(ρ)
t
= 1 for ∀ρ ∈Gal(F(ζt)/Q) with ρ|F = η
o
(3.8)
and for a divisor m of d (cf. (3.2)) and an extension ˜η ∈Gal(F ˜∆/Q) of η,
put
τm = τm(˜η) = max
n
t
¯¯¯ ζΦm(˜η)
t
= 1, t| ˜∆
o
,
where F ˜∆= F
³
˜
∆q
o×
F
´
. The existence of ˜∆is guaranteed by Proposition
5.1. By deﬁning an integer a by
ζ ˜η
˜∆= ζa
˜∆,
it is easy to see that
τm = (Φm(a), ˜∆),
(3.9)
and if o×
F = U(m), then we have g(x) = Φm(x) and τm = ˜∆by Corol-
lary 3.1. Note that for a prime number p ( ∤2DF ˜
∆) with ˜η ∈σF ˜
∆/Q(p), τm
divides Φm(p) because of ζΦm(p)
τm
≡ζΦm(˜η)
τm
= 1 mod p for a prime ideal p
lying above p, and we may put
R(˜η) =



Y
m|d
vm
¯¯¯¯¯¯
(i) vm ∈U(m),
(ii) Q
m|d vΦm(p)/τm
m
≡ζ mod p for ∃ζ ∈WF


. (3.10)
This is well-deﬁned by Proposition 3.2 and forms a group. Moreover it is
independent of the choice of a prime p, which follows from the following
proposition.
Proposition 3.3. Let ˜η ∈Gal(F ˜∆/Q) be an extension of η. Suppose that a
prime number p ( ∤2DF ˜
∆) satisﬁes σF ˜
∆/Q(p) ∋˜η, and vm ∈U(m), ζ ∈WF ;
then we have
Y
m|d
vΦm(p)/τm
m
≡ζ mod p
⇔
Y
m|d
τm√vm
Φm(ρ˜ηρ−1) = ζ for ∀ρ ∈Gal(F ˜∆/Q).

60
YOSHIYUKI KITAOKA
Proof. Suppose a prime ideal p of F ˜∆lying above p satisfy ˜η = σF ˜
∆/Q(p);
then we have, for ρ ∈Gal(F ˜∆/Q)
Y
m|d
vΦm(p)/τm
m
≡ζ mod p
⇒ζ ≡
Y
m|d
τm√vm
Φm(p) ≡
Y
m|d
τm√vm
Φm(ρ˜ηρ−1) mod pρ−1
⇒ζ =
Y
m|d
τm√vm
Φm(ρ˜ηρ−1),
on noting that the right-hand side is a root of unity in F ˜∆by η ∈
Z(Gal(F/Q)) and vΦm(η)
m
∈WF .
We may trace the above argument in the reverse way to prove the con-
verse.
For a prime number p ( ∤2DF ˜
∆) satisfying σF ˜
∆/Q(p) ∋˜η, we deﬁne a
mapping
φp :
Y
m|d
U(m) →o×
F /WF
by
φp
µ Y
m|d
vm
¶
=
Y
m|d
vΦm(p)/τm
m
.
(3.11)
It is well-deﬁned in view of Φm(p)/τm ∈Z and Proposition 3.2 and we see
that
ιp ◦φp(R(˜η)) = {1},
(3.12)
by the deﬁnition of R(˜η) and ιp in Corollary 3.3.
Proposition 3.4. For vm ∈U(m) and an integer p (̸= ±1), we have
φp
³ Y
vm
´
∈WF o×
F
η−p ⇔
Y
vΦm(η,p) ˜∆/τm
m
∈WF o×
F
˜∆,
where Φm(x, y) = (Φm(x) −Φm(y))/(x −y) as in the notation.
Proof. It is easy to see by (3.11)
φp
³ Y
vm
´
∈WF o×
F
η−p ⇔
Y
vΦm(p)/τm
m
· ϵ−(η−p) ∈WF ,
∃ϵ ∈o×
F ,
which is equivalent to
Y
vΦm(p) ˜∆/τm
m
· ϵ−(η−p) ˜∆∈WF ,
(3.13)

DISTRIBUTION OF UNITS
61
noting that for u ∈o×
F , u ∈WF if and only if u ˜∆∈WF . Since vΦm(η) ˜∆/τm
m
∈
WF holds by (3.9) and (3.3), (3.13) is equivalent to
Y
v(Φm(η)−Φm(p)) ˜∆/τm
m
· ϵ(η−p) ˜∆∈WF
⇔
³Y
vΦm(η,p) ˜∆/τm
m
· ϵ
˜∆´η−p
∈WF
⇔
Y
vΦm(η,p) ˜∆/τm
m
· ϵ
˜∆∈WF ,
(by Lemma 3.5)
which completes the proof.
Proposition 3.5. For an extension ˜η ∈Gal(F ˜∆/Q) of η and a prime
number p ( ∤2DF ˜
∆) satisfying ˜η ∈σF ˜
∆/Q(p), we put
R(˜η, p) = φp(R(˜η))WF o×
F
η−p(⊂o×
F ),
where the image of φp is viewed in o×
F and deﬁne an integer a by ζ ˜η
˜∆= ζa
˜∆.
Then, we have
£
R(˜η, p) : WF o×
F
η−p¤
=
·
R(˜η) :
½ Y
m|d
vm
¯¯¯¯ vm ∈U(m),
Y
m|d
vΦm(η,a) ˜∆/τm
m
∈WF o×
F
˜∆¾¸
,
which is independent of the choice of p.
Proof. Let us see ﬁrst φ−1
p (WF o×
F
η−p) ⊂R(˜η). Let vm ∈U(m) and sup-
pose φp(Q vm) ∈WF o×
F
η−p; we must show that Q vm ∈R(˜η). The suppo-
sition yields
φp
³ Y
vm
´
∈WF o×
F
η−p
⇒
Y
vΦm(η,p) ˜∆/τm
m
∈WF o×
F
˜∆
( by Proposition 3.4)
⇒
Y
v(Φm(η)−Φm(p)) ˜∆/τm
m
∈WF o×
F
˜∆(η−p)
⇒
Y
vΦm(p) ˜∆/τm
m
= ζϵ
˜∆(η−p)
(ζ ∈WF , ϵ ∈o×
F )
⇒
Y
vΦm(p)/τm
m
= ζ′ϵη−p.
Here ζ′ is a root of unity and lies in WF , because Q vΦm(p)/τm
m
, ϵη−p ∈F.
Therefore, we have
Y
vΦm(p)/τm
m
= ζ′ϵη−p ≡ζ′ mod p
and so Q vm ∈R(˜η). Now we have by the second homomorphism theorem
£
R(˜η, p) : WF o×
F
η−p¤
=
£
φp(R(˜η)) : φp(R(˜η)) ∩WF o×
F
η−p¤
,

62
YOSHIYUKI KITAOKA
and it is equal to
£
R(˜η) : φ−1
p (WF o×
F
η−p)
¤
( by φ−1
p (WF o×
F
η−p) ⊂R(˜η))
=
·
R(˜η) :
½Y
vm
¯¯¯¯ vm ∈U(m),
Y
vΦm(η,p) ˜∆/τm
m
∈WF o×
F
˜∆¾¸
,
by Proposition 3.4. The deﬁnition of a implies a ≡p mod ˜∆and therefore
vΦm(η,p)−Φm(η,a)
m
∈o×
F
˜∆, which completes the proof.
Since by (3.12), R(˜η, p) ⊂ker ιp holds, we have
£
R(˜η, p) : WF o×
F
η−p¤ ¯¯¯
£
ker ιp : WF o×
F
η−p¤
,
and
£
R(˜η, p) : WF o×
F
η−p¤ ¯¯¯¯
gcd
σF ˜
∆/Q(p) ∋˜η,
p∤2DF ˜
∆
£
ker ιp : WF o×
F
η−p¤
,
since the left index is independent of the choice of p( ∤2DF ˜
∆) by Proposition
3.5. Therefore, putting
κ(η) = gcd
˜η|F =η
£
R(˜η, p) : WF o×
F
η−p¤
(3.14)
we have
κ(η)
¯¯¯¯
gcd
σF/Q(p) = η,
p∤2DF ˜
∆
£
ker ιp : WF o×
F
η−p¤
,
where the right-hand side is Relη by deﬁnition (cf.(3.7)). Hence we have
κ(η)
¯¯¯ Relη
¯¯¯
£
ker ιp : WF o×
F
η−p¤
for prime numbers p which satisﬁes η ∈σF/Q(p) and p ∤2DF ˜
∆.
Thus, we have shown with (3.6),
Theorem 3.2.
#E(p)
¯¯¯¯
w Q
i |Φdi(p)|
κ(η)
.
(3.15)
We expect κ(η) = Relη, and we conjecture that for inﬁnitely many
primes p, “|” is replaced by “=” in (3.15).
Note that if there is at least one prime p such that
κ(η) = w
Y
|Φdi(p)|
.
#E(p) (=
£
ker ιp : WF o×
F
η−p¤
),

DISTRIBUTION OF UNITS
63
then κ(η) = Relη holds. The computer experiment supports this in all the
examples in §4.
To proceed to the next step, we need to know in terms of Frobenius
automorphisms the condition on p for which [ker ιp : WF o×
F
η−p]/κ(η) is a
multiple of a natural number m (cf. Proposition 2.2). Successful cases are
some number ﬁelds with rank o×
F = 1 [8], and cubic abelian ﬁelds [9].
Remark 3.2. It is desirable to generalize the prime number case to more
general situation in case of “modulo prime ideal” in the previous section.
3.3. Evaluation of κ(η)
In this subsection, we give another description of the index [R(˜η, p) :
WF o×
F
η−p] and κ(η) convenient for evaluation.
3.3.1. Action of automorphisms
First, we study the explicit action of ˜η on
∆√ϵ as a preparation. Let ∆be
a natural number and U a Gal(F/Q)-stable subgroup of o×
F such that
U =
­
ζw, u1, · · · , us
®
,
(3.16)
where ζw is a primitive w-th root of unity and ui’s are multiplicatively
independent. Therefore {u1, · · · , us} is a basis of U/WF as a Z-module.
For a polynomial with integral coeﬃcients
h(x) = hnxn + hn−1xn−1 + · · · + h0,
we assume
U h(η) ⊂WF
(3.17)
and write, as in the introduction
h(x, y) = (h(x) −h(y))/(x −y) =
n
X
t=1
ht
t−1
X
k=0
xt−k−1yk.
We suppose η ∈Z(Gal(F/Q)) as before, and let ˜η be an extension of η to
Gal(F∆/Q), and ﬁx a ∆-th root
∆√uj ∈F∆once and for all. Write
ζ ˜η
∆w = ζa
∆w,
∆√ui
˜η = ζai
∆w
Y
j
∆√uj
aij,
(3.18)
and similarly for ρ ∈Gal(F∆/Q)
ζρ
∆w = ζb
∆w,
∆√ui
ρ = ζbi
∆w
Y
j
∆√uj
bij,
(3.19)

64
YOSHIYUKI KITAOKA
and
a =



a1
...
as


,
b =



b1
...
bs


,
A = (aij), B = (bij).
Lemma 3.8. We have
ρη = ηρ on U ⇔ba + Ab ≡ab + Ba mod w, and AB = BA.
Proof. The assertion follows, comparing
uηρ
i
=
³
ζai
w
Y
uaij
j
´ρ
= ζbai
w
Y
j
n
ζbj
w
Y
k
ubjk
k
oaij
= ζ
bai+P
j aijbj
w
Y
k
u
P
j aijbjk
k
and
uρη
i
=
³
ζbi
w
Y
ubij
j
´η
= ζabi
w
Y
j
n
ζaj
w
Y
k
uajk
k
obij
= ζ
abi+P
j bijaj
w
Y
k
u
P
j bijajk
k
.
Lemma 3.9. Putting Ak = (aij(k)) for each non-negative integer k, we
have
∆√ui
˜ηk
= ζαi(k)
∆w
Y
j
∆√uj
aij(k),
(3.20)
where αi(k) is deﬁned by
t(α1(k), · · · , αs(k)) =





0
if k = 0,
t(a1, a2, · · · , as)
if k = 1,
(ak−1 + ak−2A + · · · + Ak−1)a if k > 1.
(3.21)
Proof. The case of k = 0, 1 is clear. Inductively, we see the assertion, using
∆√ui
˜ηk+1
= ζαi(k)a
∆w
Y
j
n
ζaj
∆w
Y
k
∆√uk
ajkoaij(k)
= ζ
αi(k)a+P
j aij(k)aj
∆w
Y
k
∆√uk
P
j aij(k)ajk.
Lemma 3.10. We have
uh(η,a)
i
∈WF
Y
j
u
h(a,A)(i,j)
j
,
where h(a, A)(i,j) is the (i, j)-entry of h(a, A).

DISTRIBUTION OF UNITS
65
Proof. The assertion follows from
uh(η,a)
i
= u
Pn
t=1
Pt−1
k=0 htat−k−1ηk
i
∈WF
s
Y
j=1
u
Pn
t=1
Pt−1
k=0 htat−k−1aij(k)
j
(by Lemma 3.9)
= WF
Y
j
u
h(a,A)(i,j)
j
.
Lemma 3.11. For an integral vector x = (x1, . . . , xs), we put
∆√ϵ =
Y
∆√ui
xi.
Then we have
∆√ϵ
h(˜η) =
Y
i
∆√ui
h(˜η)xi = ζxh(a,A)a
∆w
and
h(A) = 0.
Proof. We have by (3.20)
∆√ui
h(˜η) =
n
Y
k=0
∆√ui
hk ˜ηk
= ζ
P
k hkαi(k)
∆w
Y
j
∆√uj
P
k aij(k)hk.
The assumption uh(η)
i
∈WF (cf. (3.17)) yields P
k aij(k)hk = 0, i.e., h(A) =
0, and P
k hkαi(k) is the i-th component of h(a, A)a by (3.21), from which
the ﬁrst assertion follows.
Lemma 3.12. For ρ−1, we put
ζρ−1
∆w = ζb′
∆w,
∆√ui
ρ−1
= ζb′
i
∆w
Y
j
∆√uj
b′
ij,
b′ = t(b′
1, · · · , b′
s).
(3.22)
Then we have
bb′ ≡1 mod ∆w,
b′b ≡−Bb′ mod ∆w,
(b′
ij) = B−1.
(3.23)
Proof. By (3.19), we have
ζ∆w = ζρρ−1
∆w
= ζbb′
∆w,
and the equation
∆√ui =
∆√ui
ρρ−1
= ζ
bib′+P
j bijb′
j
∆w
Y
k
∆√uk
P
j bijb′
jk.

66
YOSHIYUKI KITAOKA
The ﬁrst equation implies the ﬁrst congruence in (3.23) and together with
multiplicative independence of ui’s the second equation implies both (b′
ij) =
B−1 and the second congruence b′b + Bb′ ≡0 mod ∆w.
Lemma 3.13. Putting
∆√ui
ρ˜ηρ−1
= ζqi
∆w
Y
∆√uj
qij,
q = t(q1, · · · , qs),
(3.24)
we have
qij = aij,
q ≡b′{(a −A)b + Ba} mod ∆w.
Proof. By uρηρ−1
i
= uη
i , we have qij = aij. Since we have
∆√ui
ρ˜ηρ−1
=
n
ζbi
∆w
Y
j
∆√uj
bijo˜ηρ−1
( by (3.19) )
=
n
ζ
bia+P
j bijaj
∆w
Y
j
n Y
k
∆√uk
ajkobijoρ−1
( by (3.18) )
= ζ
b′(bia+P
j bijaj)
∆w
Y
j,k
n
ζb′
k
∆w
Y
ℓ
∆√uℓ
b′
klobijajk
( by (3.22) )
= ζ
b′(bia+P
j bijaj)+P
j,k b′
kbijajk
∆w
Y
ℓ
∆√uℓ
aiℓ,
( by Lemma 3.8 )
it is easy to see by comparing this with (3.24)
q ≡b′(ab + Ba) + BAb′
≡b′(ab + Ba) + ABb′
( by Lemma 3.8)
≡b′(ab + Ba) −Ab′b
( by Lemma 3.12)
≡b′{(a −A)b + Ba} mod ∆w.
Corollary 3.4. For
∆√ϵ =
Y
∆√ui
xi,
we have
³
∆√ϵ
h(ρ˜ηρ−1)´b
= ζx{h(a)b+h(a,A)Ba}
∆w
.
Proof. Using Lemmas 3.11 and 3.13, we have
∆√ϵ
h(ρ˜ηρ−1) =
Y
i
∆√ui
h(ρ˜ηρ−1)xi = ζxh(a,A)q
∆w
= ζxh(a,A)b′{(a−A)b+Ba}
∆w
.

DISTRIBUTION OF UNITS
67
Noting that h(a, A)(a −A) = h(a) −h(A) = h(a), we have
h(a, A){(a −A)b + Ba} ≡h(a)b + h(a, A)Ba mod ∆w,
which completes the proof.
3.3.2. Evaluation of κ(η)
With the preparation in the previous subsubsection, we may now give a
formula for the index [R(˜η, p) : WF o×
F
η−p], which is easier to evaluate. For
˜η ∈Gal(F ˜∆/Q) with ˜η|F = η, we recall (3.10) on the form
R(˜η) =



Y
m|d
vm
¯¯¯¯¯¯
(i) vm ∈U(m),
(ii) Q
m|d
τm√vm
Φm(ρ˜ηρ−1) = Q
m|d
τm√vm
Φm(˜η) ∈WF for ∀ρ


,
by Proposition 3.3.
Lemma 3.14. Recalling (3.16),(3.18),(3.19), we put
U(m) =
­
ζw, um,1, · · · , um,sm
®
,
˜
∆√um,j
˜η = ζam,j
˜∆w
Y
k
˜
∆√um,k
a(m)
jk ,
ζ ˜η
˜∆w = ζa
˜∆w,
˜
∆√um,i
ρ = ζbm,i
˜∆w
Y
j
˜
∆√um,j
b(m)
ij ,
ζρ
˜∆w = ζb
˜∆w,
tam = (am,1, · · · , am,sm),
A(m) = (a(m)
ij ),
tbm = (bm,1, · · · , bm,sm),
B(m) = (b(m)
ij ).
Then for
vm =
Y
j
uym,j
m,j ,
ym = (ym,1, · · · , ym,sm),
(3.25)
the condition Q
m vm ∈R(˜η) is equivalent to
(#)
(P
m( ˜∆/τm)ymΦm(a, A(m))am ≡0 mod ˜∆,
P
m( ˜∆/τm)ym{Φm(a)bm + Φm(a, A(m))(B(m) −b)am} ≡0 mod ˜∆w
for every ρ ∈Gal(F ˜∆/Q).
Proof. By putting
xm,j = ym,j ˜∆/τm,
xm = (xm,1, · · · , xm,sm),

68
YOSHIYUKI KITAOKA
the condition Q
m vm ∈R(˜η) amounts to clearly
Y
m
³ Y
j
˜
∆√um,j
xm,j´Φm(ρ˜ηρ−1)
=
Y
m
³ Y
j
˜
∆√um,j
xm,j´Φm(˜η)
∈WF .
By Lemma 3.11, we have
³ Y
j
˜
∆√um,j
xm,j´Φm(˜η)
= ζxmΦm(a,A(m))am
˜∆w
,
while by Corollary 3.4
³ Y
j
˜
∆√um,j
xm,j´Φm(ρ˜ηρ−1)
= ζb′xm{Φm(a)bm+Φm(a,A(m))B(m)am}
˜∆w
,
on putting ζρ−1
˜∆w = ζb′
˜∆w. Hence the condition Q
m vm ∈R(˜η) is equivalent
to
Y
m
ζb′xm{Φm(a)bm+Φm(a,A(m))B(m)am}
˜∆w
=
Y
m
ζxmΦm(a,A(m))am
˜∆w
∈WF . (3.26)
It is easy to see that
Q
m ζxmΦm(a,A(m))am
˜∆w
∈WF
⇔Q
m ζxmΦm(a,A(m))am
˜∆
= 1
⇔P
m xmΦm(a, A(m))am ≡0 mod ˜∆
⇔P
m ( ˜∆/τm)ymΦm(a, A(m))am ≡0 mod ˜∆,
and the equality in (3.26) is equivalent to
X
m
b′xm{Φm(a)bm + Φm(a, A(m))B(m)am}
≡
X
m
xmΦm(a, A(m))am mod ˜∆w,
which completes the proof.
Remark 3.3. The condition (#) depends only on
(i) ym mod τm,
(ii) b, bm mod w, i.e., on ρ|F ,
(iii) am mod wτm.
Further,
(iv) am mod w is uniquely determined by η.

DISTRIBUTION OF UNITS
69
With respect to the assertion (i), we have only to note that
Φm(a)bm + Φm(a, A(m))(B(m) −b)am
= Φm(a, A(m)){(a −A(m))bm + (B(m) −b)am}
≡0 mod w
by Lemma 3.8.
(3.9) implies Φm(a) ≡0 mod τm, which implies the assertion on bm. The
assertion on b follows from the ﬁrst equation of (#). The statements (iii),(iv)
are obvious.
Lemma 3.15. Let vm ∈U(m) and ym be as in the previous lemma; then
the condition
Y
m|d
vΦm(η,a) ˜∆/τm
m
∈WF o×
F
˜∆
is equivalent to
( ♮)
Y
m|d
Y
j
u
P
i ym,iΦm(a,A(m))(i,j) ˜∆/τm
m,j
∈WF o×
F
˜∆.
If a stronger condition o×
F = Q U(m) holds, then it is equivalent to
ymΦm(a, A(m)) ≡0 mod τm.
Proof. By Lemma 3.10, we know that uΦm(η,a)
m,i
∈WF
Q
j u
Φm(a,A(m))(i,j)
m,j
,
which yields
Q
m|d vΦm(η,a) ˜∆/τm
m
= Q
m|d
Q
i uym,i
m,i
Φm(η,a) ˜∆/τm
( by (3.25) )
∈WF
Q
m|d
Q
i
Q
j u
ym,iΦm(a,A(m))(i,j) ˜∆/τm
m,j
= WF
Q
m|d
Q
j u
P
i ym,iΦm(a,A(m))(i,j) ˜∆/τm
m,j
,
whence follows the ﬁrst assertion. If o×
F = Q U(m) holds, then {um,j} is a
basis of o×
F /WF , and so the ﬁrst equivalence implies the second one.
Proposition 3.6. Let um,i, ym,i, ym be as in Lemma 3.14, and let ˜η be
an extension of η, and let p ( ∤2DF ˜
∆) be a prime number satisfying ˜η ∈
σF ˜
∆/Q(p); then we have
£
R(˜η, p) : WF o×
F
η−p¤
=
£
V1(˜η) : V2(˜η)
¤
,

70
YOSHIYUKI KITAOKA
where
V1(˜η) = WF
( Y
m
Y
j
uym,j
m,j
¯¯¯¯¯ ym satisﬁes (#) in Lemma 3.14
)
,
V2(˜η) = WF
( Y
m
Y
j
uym,j
m,j
¯¯¯¯¯ ym satisﬁes ( ♮) in Lemma 3.15
)
.
If o×
F = Q U(m) holds, then we have
V2(˜η) = WF
( Y
m
Y
j
uym,j
m,j
¯¯¯¯¯ ymΦm(a, A(m)) ≡0 mod τm for ∀m|d
)
.
Proof. The assertion follows easily from Proposition 3.5 and the previous
two lemmas.
Suppose o×
F = Q U(m); then {um,i} is a basis of o×
F /WF , whence com-
paring exponents, we may assume
V1(˜η) =
n
{ym mod τm}
¯¯¯ ym’s satisfy (#) in Lemma 3.14
o
,
(3.27)
V2(˜η) =
n
{ym mod τm}
¯¯¯ ymΦm(a, A(m)) ≡0 mod τm for ∀m|d
o
. (3.28)
The inclusion V2(˜η) ⊂V1(˜η) follows from their original deﬁnitions, but
we can check it directly when o×
F = Q U(m) holds, as follows: Suppose
{ym} ∈V2(˜η); then the ﬁrst equality of (#) is obvious. Noting that
Φm(a) = Φm(a) −Φm(A(m)) = Φm(a, A(m))(a −A(m)),
we have
Φm(a)bm + Φm(a, A(m))(B(m) −b)am
= Φm(a, A(m))(abm −A(m)bm + B(m)am −bam)
and then Lemma 3.8 yields the second equality of (#).
4. Examples
4.1. Case of η = id
We assume η = id throughout this subsection. Then obviously, we have
d (= the order of η) = 1, o×
F = U(1), and the polynomial g(x) deﬁned in
Corollary 3.1 is equal to
g(x) = x −1.

DISTRIBUTION OF UNITS
71
Corollary 5.1 in the appendix yields
˜∆= τ1 = w.
Let ˜η be an extension of η. Since g(x, y) = 1 yields V2(˜η) = 0, we have for
r = rankZo×
F , (3.27), (3.28) read
V1(˜η)/V2(˜η) =
½
y ∈(Z/wZ)r
¯¯¯¯
½ ya ≡0 mod w,
y{(a −1)b + (B −b)a)} ≡0 mod w2
¾
where we put, as in §3.3.1 with (ii) in Remark 3.3
o×
F =
­
ζw, u1, · · · , ur
®
,
ζ ˜η
w2 = ζa
w2,
w√ui
˜η = ζai
w2
w√ui,
ta = (a1, · · · , ar),
A = 1r,
ζρ
w = ζb
w, uρ
i = ζbi
w
Y
j
ubij
j ,
tb = (b1, · · · , br),
B = (bij).
Now, we note that the assumption η = id yields in the above
a ≡1 mod w,
a ≡0 mod w
and so
a = 1 + wa,
a = wa,
say. Then we have
V1(˜η)/V2(˜η) =
©
y mod w
¯¯ y(ab + (B −b)a) ≡0 mod w
ª
.
Then, putting
R(ρ) = (B −b1r, b),
(4.1)
and replacing a, a by a, a we have
V (˜η) := V1(˜η)/V2(˜η)
=
½
y mod w
¯¯¯¯ yR(ρ)
µ a
a
¶
≡0 mod w for ∀ρ ∈Gal(F/Q)
¾
,
where redeﬁning a, a as above
ζ ˜η
w2 = ζw2 · ζa
w,
w√ui
˜η = ζai
w
w√ui,
ta = (a1, · · · , ar)
(4.2)
ζρ
w = ζb
w, ui
ρ = ζbi
w
Y
j
uj
bij,
tb = (b1, · · · , br), B = (bij).
(4.3)

72
YOSHIYUKI KITAOKA
We note that if ρ|F = id, then (4.3) implies b ≡1 mod w, b ≡0 mod w and
B is the identity matrix, and hence R(ρ) ≡0 mod w. By denoting B, b
corresponding to ρ by B(ρ), b(ρ), respectively, it is easy to see that
R(ρ1ρ2) = B(ρ1)R(ρ2) + b(ρ2)R(ρ1).
(4.4)
In the following, we evaluate κ(η) = gcd #V (˜η) (cf. (3.14)) for several
types of algebraic number ﬁelds, and furthermore we show that for ˜η ∈
Gal(Fw/F), there is ˜η0 such that R(˜η) ⊃R(˜η0) and κ(η) = #V (˜η0). This
is not necessarily true if η ̸= id. Once we ﬁnd a prime number p such that
σF/Q(p) = η and w(p −1)r/#E(p) = κ(η), we have κ(η) = Relη.
4.1.1. Case of real quadratic ﬁelds
Let F be a real quadratic ﬁeld and let ϵ (> 1) be the fundamental unit
with N(ϵ) = (−1)s; then clearly ˜∆= w = 2. We take ϵ as u1; then for
ρ(̸= id) ∈Gal(F/Q),
(−1)ρ = −1,
ϵρ = (−1)sϵ−1
imply B = (−1), b = 1, b = (s) and so
R(ρ) = (−2, s) ≡(0, s) mod 2.
Therefore
V (˜η) =
½
x mod 2
¯¯¯¯ x(0, s)
µ a
a
¶
= sax ≡0 mod 2
¾
.
Here a is deﬁned by ζ ˜η
4 = (−1)aζ4 as in (4.2). Let us see that
κ(η) = gcd #V (˜η) =
(
2
if N(ϵ) = 1,
1
if N(ϵ) = −1.
The ﬁrst is obvious because of s = 0, and for the second, we have only to
take ˜η0 so that a = 1. This is compatible with [8], where we have shown
that the expected density of the set (cf. (3.15))
©
p
¯¯ #E(p) = 2(p −1)/κ(η), σF/Q(p) = id
ª
is positive.

DISTRIBUTION OF UNITS
73
4.1.2. Case of real cubic abelian ﬁelds
Let F be a real cubic abelian ﬁeld and σ a generator of Gal(F/Q); then we
have ˜∆= w = 2 and as a set of fundamental units, we can take u1, u2 so
that
(−1)σ = (−1)1,
uσ
1 = u2,
uσ
2 = (u1u2)−1
and NF/Q(u1) = NF/Q(u2) = 1 [9]. Thus we have (cf. (4.1))
R(σ) =
µµ 0
1
−1 −1
¶
−12,
µ 0
0
¶¶
≡
µ1 1 0
1 0 0
¶
mod 2,
R(σ2) ≡
µ 0 1 0
1 1 0
¶
mod 2,
which yield
V (˜η)
=
n
(x1, x2) mod 2
¯¯¯ x1(a1 + a2) + x2a1 ≡x1a2 + x2(a1 + a2) ≡0 mod 2
o
.
Here a1, a2 are deﬁned by √ui
˜η = (−1)ai√ui in (4.2). We can choose ˜η0
which corresponds to a1 = a2 = 1 and then #V (˜η0) = 1, i.e. κ(η) =
gcd V (˜η) = 1. This is compatible with [9], where the expected density of
the set
©
p
¯¯ #E(p) = 2(p −1)2,
σF/Q(p) = id
ª
is explicitly given.
4.1.3. Case of non-cyclic abelian ﬁelds of degree 4
Let F = Q(√d1, √d2), where d1, d2 (> 1) are natural numbers and let
F1, F2, F3 be three real quadratic subﬁelds of F. Let ϵi (> 1) be the funda-
mental unit of Fi, NFi/Qϵi = (−1)si, si = 0, 1. Put
Q =
£
o×
F : ⟨−1, ϵ1, ϵ2, ϵ3⟩
¤
;

74
YOSHIYUKI KITAOKA
then the type of a set {u1, u2, u3} of fundamental units of F is given as
follows [10]:
(i) u1 = ϵ1,
u2 = ϵ2,
u3 = ϵ3
(Q = 1)
(ii) u1 = √ϵ1,
u2 = ϵ2,
u3 = ϵ3
(Q = 2)
(iii) u1 = √ϵ1,
u2 = √ϵ2,
u3 = ϵ3
(Q = 4)
(iv) u1 = √ϵ1ϵ2,
u2 = ϵ2,
u3 = ϵ3
(Q = 2)
(v) u1 = √ϵ1ϵ2,
u2 = √ϵ3,
u3 = ϵ2
(Q = 4)
(vi) u1 = √ϵ1ϵ2,
u2 = √ϵ2ϵ3, u3 = √ϵ3ϵ1 (Q = 4)
(vii) u1 = √ϵ1ϵ2ϵ3, u2 = ϵ2,
u3 = ϵ3
(Q = 2).
In the case (ii) – (vi), si = 0 is supposed if ϵi appears in the symbol √
,
and s1 = s2 = s3 is supposed for the case (vii). We denote by σi the non-
trivial automorphism ﬁxing ϵi and so Gal(F/Q) = {σ1, σ2, σ3 = σ1σ2, id}.
b = b(ρ) = 1 in (4.3) is equal to 1 because of w = 2 and hence we have by
(4.4)
R(σ3) = R(σ1σ2) = B(σ1)R(σ2) + R(σ1).
Proposition 4.1. Let η be the identity; then the value of κ(η) = gcd #V (˜η)
is given as follows:
Case (i)
κ(η) =



8
if s1 + s2 + s3 = 0,
4
if s1 + s2 + s3 = 1,
2
otherwise,
Case (ii)
κ(η) =







4
if



s2 = s3 = 0 or
s2 = 0,
s3 = 1,
u1uσ2
1 = −1 or
s2 = 1,
s3 = 0,
u1uσ3
1 = −1,
2
otherwise,
Case (iii)
κ(η) =
½ 4
if u1uσ2
1 = u2uσ1
2 = −1,
2
otherwise,
Case (iv)
κ(η) =
½2
if uσ1
1 uσ2
1 = −1 and s3 = 1,
4
otherwise,
Case (v), (vi)
κ(η) = 2,

DISTRIBUTION OF UNITS
75
Case (vii)
κ(η) =
½4
if s1 = 0,
1
if s1 = 1.
Proof. We prove the case (vii). Proofs of the other cases are similar.
For u1 = √ϵ1ϵ2ϵ3, u2 = ϵ2, u3 = ϵ3, we have
(−1)σ1 = (−1)σ2 = −1,
and
uσ1
1
= (−1)κ1u1u−1
2 u−1
3 ,
uσ1
2
= (−1)s2u−1
2 ,
uσ1
3
= (−1)s3u−1
3 ,
uσ2
1
= (−1)κ2u−1
1 u2,
uσ2
2
= u2,
uσ2
3
= (−1)s3u−1
3 ,
for some κ1, κ2 = 0, 1, and put s1 = s2 = s3 = s. Then it is easy to see that
R(σ1) ≡


0 1 1 κ1
0 0 0 s
0 0 0 s

mod 2,
R(σ2) ≡


0 1 0 κ2
0 0 0 0
0 0 0 s

mod 2,
R(σ1σ2) ≡


0 0 1 κ1 + κ2 + s
0 0 0
s
0 0 0
0

mod 2,
and hence, putting ta = (a1, a2, a3, a), we have in due order
(x1, x2, x3) ∈V (˜η)
⇔



(0, x1, x1, x1κ1 + x2s + x3s)a ≡0 mod 2
(0, x1, 0, x1κ2 + x3s)a ≡0 mod 2
(0, 0, x1, x1(κ1 + κ2 + s) + x2s)a ≡0 mod 2
⇔



x1(a2 + a3 + κ1a) + x2sa + x3sa ≡0 mod 2
x1(a2 + κ2a) + x3sa ≡0 mod 2
x1(a3 + κ1a + κ2a + sa) + x2sa ≡0 mod 2.
We divide the proof into two cases. For s = 0 we get
(x1, x2, x3) ∈V (˜η)
⇔



x1(a2 + a3 + κ1a) ≡0 mod 2
x1(a2 + κ2a) ≡0 mod 2
x1(a3 + κ1a + κ2a) ≡0 mod 2
⇒{(0, x2, x3) | x2, x3 mod 2} ⊂V (˜η),

76
YOSHIYUKI KITAOKA
where the inclusion becomes the equality for a = 0, a2 = 1. Therefore
κ(η) = 4 holds.
For s = 1, we have
(x1, x2, x3) ∈V (˜η) ⇔



x1(a2 + a3 + κ1a) + x2a + x3a ≡0 mod 2,
x1(a2 + κ2a) + x3a ≡0 mod 2,
x1(a3 + κ1a + κ2a + a) + x2a ≡0 mod 2
and since the coeﬃcient matrix is regular for a = 1, we have
V (˜η) = {(0, 0, 0)}
and so κ(η) = 1.
Remark 4.1. Suppose F = Q(√d1, √d2) (2 ≤d1, d2 ≤500); then κ(η) =
Relη is conﬁrmed by ﬁnding a prime number p satisfying #E(p) = 2(p −
1)3/κ(η) by computer.
4.1.4. Case of imaginary abelian ﬁelds of degree 4
Let F be an imaginary abelian ﬁeld of degree 4 and let F0 be the real
quadratic subﬁeld in F, and ϵ0 (> 1) the fundamental unit of F0. Put
Q =
£
o×
F : WF o×
F0
¤
.
We deﬁne a fundamental unit ϵ of F as follows: In case of Q = 1, we put
ϵ = ϵ0.
Next, we assume Q = 2; let us see then that we can choose a fundamental
unit ϵ of F so that
ϵ0 = ζwϵ2,
ϵJ = ζwϵ,
where J means the complex conjugation. We agree as follows. We may
suppose ϵ0 = ζa
wϵ2 with a = 0, 1 without loss of generality. Assume a = 1;
ϵϵJ ∈F0 implies ϵϵJ = ϵn
0, and so ϵϵJ = (ζwϵ2)n. Thus we have ϵJ = ζn
wϵ2n−1
and comparing the absolute values, n = 1, which yields ϵJ = ζwϵ, and
ϵ0 = ϵϵJ = ζwϵ2. If a = 0, then ϵ0 = ϵ2 follows, which implies ϵJ = ϵ2n−1
by ϵϵJ = ϵn
0 for an integer n, whence yields n = 1 and ϵJ = ϵ, contradicting
Q = 2.
Proposition 4.2. We have
κ(η) =





2
if
either Q = 1 and NF0/Q(ϵ0) = 1
or
Q = 1 and √−1 ∈F,
1
otherwise.

DISTRIBUTION OF UNITS
77
Proof. Putting
ζ ˜η
w2 = ζw2ζa
w,
w√ϵ
˜η = ζa1
w
w√ϵ,
ζρ
w = ζb
w,
ϵρ = ζb1
w ϵb11,
we have
V (˜η) = {x mod w | x((b11 −b)a1 + b1a) ≡0 mod w for ∀ρ ∈Gal(F/Q)}.
• Case of Q = 1, NF0/Q(ϵ0) = 1:
In this case, we show that
V (˜η) ⊃V (˜η0) = {x mod w | x ≡0 mod w/2}
(˜η0 ↔a1 = 1),
from which we have κ(η) = 2. We note that ϵρ = ϵ or ϵ−1 by virtue of
ϵ = ϵ0, and so b1 = 0 for every ρ and so
V (˜η) = {x mod w | x(b11 −b)a1 ≡0 mod w for ∀ρ ∈Gal(F/Q)}.
If w = 2, 4, 6, then the possibilities for b, b11 are
w = 2 ⇒b = 1,
b11 = ±1
w = 4, 6 ⇒b = ±1, b11 = ±1
and hence the assertion above is true.
If w = 8, then we have F = Q(ζ8) and ϵ0 =
√
2 + 1, NF0/Q(ϵ0) = −1, which
contradicts the assumption.
If w = 12, then F = Q(√−1,
√
3) holds, and the possibilities are
either b = ±1, b11 = 1, or b = ±5, b11 = −1.
The automorphism ρ corresponding to b = −1, b11 = 1 implies 2x ≡0 mod
12, i.e. x ≡0 mod 6 and so V (˜η0) = {x mod 12 | x ≡0 mod 6}. Therefore
#V (˜η0) = 2 holds.
• Case of Q = 1, NF0/Q(ϵ0) = −1, √−1 ∈F and ζ8 ∈F :
In this case, we have F = Q(ζ8) and ϵ0 =
√
2 −1, and the possibilities are
b
1
3
5
7
b11
1
−1
−1
1
b1
0
4
4
0
(b11 −b)a1 + b1a 0 −4a1 + 4a −6a1 + 4a −6a1
which also implies V (˜η) ⊃V (˜η0) = {x mod w | x ≡0 mod w/2} (˜η0 ↔a =
a1 = 1). This means κ(η) = 2.

78
YOSHIYUKI KITAOKA
• Case of Q = 1, NF0/Q(ϵ0) = −1, √−1 ∈F and ζ8 ̸∈F :
We note that w = 4 and F is the composite of Q(√−1) and F0. Then we
have the table:
½ρ
b
½ρ|FF0 = id
1
½ ρ|FF0 = id
3
½ρ|FF0 ̸= id
1
½ ρ|FF0 ̸= id
3
b11
1
1
−1
−1
b1
0
0
2
2
(b11 −b)a1 + b1a
0
−2a1
−2a1 + 2a
−4a1 + 2a
Therefore we have V (˜η) ⊃V (˜η0) = {x mod w | x ≡0 mod w/2} (˜η0 ↔
a1 = 1, a = 0) and κ(η) = 2.
• Case of Q = 1, NF0/Q(ϵ0) = −1, √−1 ̸∈F :
In case of w = 2, we take ˜η0 corresponding to a1 = 0, a = 1, so that b1 = 1
for ρ|F0 ̸= id implies V (˜η) ⊃V (˜η0) = {0}, i.e. κ(η) = 1. In case of w = 6,
F = F0(ζ3) holds, and we take ˜η0 corresponding to a = a1 = 1. Then we
have V (˜η) ⊃V (˜η0) = {0} and so κ(η) = 1, considering ρ corresponding to
ζρ
w = ζw, ϵρ
0 = −ϵ−1
0 , for which we get b = 1, b1 = 3, b11 = −1.
• Case of Q = 2 :
Let ρ be the complex conjugation; then b = −1, b1 = 1, b11 = 1 hold.
Therefore ˜η0 corresponding to a1 = 0, a = 1 gives V (˜η) ⊃V (˜η0) = {0} and
κ(η) = 1.
The proposition explains the theoretical background of the constant ∆
in [8], which is our κ(η) where the positivity of the expected density of
{p | #E(p) = w(p −1)/κ(η), σF/Q(p) = id} is shown.
4.1.5. Case where F is the Galois closure of a real cubic ﬁeld F0
with negative discriminant
We note that F is an S3-extension of Q, and so w = 2, 4, 6. Let ϵ ( > 1) be
the fundamental unit of F0, and σ an automorphism of order 3 in Gal(F/Q);
then ζσ
w = ζw holds, and putting ϵ′ = ϵσ, we see
ϵ′J = ϵσ2 = ϵ′σ = ϵ−1−σ,
where J denotes the complex conjugation. That [o×
F : ⟨ζw, ϵ, ϵ′⟩] = 1 or 3 is
known [4]. We still suppose η ∈Gal(F/Q) is the identity. Then we have
Proposition 4.3.
κ(η) =
(
3
if F0 is pure cubic and [o×
F : ⟨ζw, ϵ, ϵ′⟩] = 1,
1
otherwise.

DISTRIBUTION OF UNITS
79
Proof. For an extension ˜η of η, we write as (4.2), (4.3),
ζ ˜η
w2 = ζaw+1
w2
,
w√ui
˜η = ζai
w
w√ui,
ζρ
w = ζb
w,
u1ρ = ζb1
w u1b11u2b12,
u2ρ = ζb2
w u1b21u2b22,
where o×
F = ⟨ζw, u1, u2⟩.
Suppose [o×
F : ⟨ζw, ϵ, ϵ′⟩] = 1; then we have, on putting u1 = ϵ, u2 = ϵ′,
ζσ
w = ζw,
uσ
1 = u2,
uσ
2 = u−1
1 u−1
2 ,
ζσ2
w = ζw,
uσ2
1
= u−1
1 u−1
2 ,
uσ2
2
= u1,
ζJ
w = ζ−1
w ,
uJ
1 = u1,
uJ
2 = u−1
1 u−1
2 ,
ζσJ
w
= ζ−1
w ,
uσJ
1
= u−1
1 u−1
2 ,
uσJ
2
= u2,
ζσ2J
w
= ζ−1
w ,
uσ2J
1
= u2,
uσ2J
2
= u−1
1 u−1
2 .
Therefore we have b1 = b2 = 0 for ∀ρ ∈Gal(F/Q), and
(x1, x2) mod w ∈V (˜η)
⇔
(x1, x2)
µ b11 −b
b12
b21
b22 −b
¶ µ a1
a2
¶
≡0 mod w for ∀ρ
⇔










x1(−a1 + a2) + x2(−a1 −2a2) ≡0 mod w
(ρ = σ)
x1(−2a1 −a2) + x2(a1 −a2) ≡0 mod w
(ρ = σ2)
2x1a1 −x2a1 ≡0 mod w
(ρ = J)
−x1a2 + 2x2a2 ≡0 mod w
(ρ = σJ)
x1(a1 + a2) + x2(a1 + a2) ≡0 mod w
(ρ = σ2J).
(4.5)
If F0 is pure cubic, then we have w = 6, and taking ˜η0 corresponding to
a1 = a2 = 1, we get by (4.5)
(x1, x2) mod 6 ∈V (˜η0) ⇔











−3x2 ≡0 mod 6
−3x1 ≡0 mod 6
2x1 −x2 ≡0 mod 6
−x1 + 2x2 ≡0 mod 6
2x1 + 2x2 ≡0 mod 6
⇔
½xj ≡0 mod 2,
x1 + x2 ≡0 mod 3.
It is easy to see V (˜η) ⊃V (˜η0) for any extension ˜η, and therefore κ(η) = 3.
Next, we suppose that F0 is not pure cubic, which implies Q(
p
DF0) ̸=
Q(√−3) and w = 2 or 4. For ˜η0 corresponding to a1 = a2 = 1, we have
(cf. (4.5))
(x1, x2) mod w ∈V (˜η0) ⇔x1 ≡x2 ≡0 mod w.

80
YOSHIYUKI KITAOKA
Therefore we have κ(η) = 1.
Now suppose [o×
F : ⟨ζw, ϵ, ϵ′⟩] = 3. First we show that there exist ϵ0 ∈
o×
F , e ∈Z so that
o×
F = ⟨ζw, ϵ0, ϵσ
0⟩,
ϵ3
0 = ζe
wϵ/ϵ′,
ϵσ2
0
= ζe
wϵ−1−σ
0
,
ϵJ
0 = ζ−e
w ϵ1+σ
0
,
ϵσJ
0
= ϵ−σ
0 .
(4.6)
Take a unit ϵ0 ∈o×
F \ ⟨ζw, ϵ, ϵ′⟩and let ϵ3
0 = ζe
wϵbϵ′c for e, b, c ∈Z. If
b ≡c ≡0 mod 3, then we may assume b = c = 0, i.e. that ϵ0 is a root of
unity. This contradicts ϵ0 ̸∈⟨ζw, ϵ, ϵ′⟩.
If b ≡0 mod 3, then c ̸≡0 mod 3 and (ϵσ
0)3 = ζe
wϵ′b(ϵϵ′)−c = ζe
wϵ−cϵ′b−c
allows us to assume b ̸≡0 mod 3, taking ϵσ
0 instead of ϵ0. Thus we may
assume ϵ3
0 = ζe
wϵϵ′c, taking ϵ−1
0
instead, if necessary. If c ≡0 mod 3 holds,
then ϵ = (ζ−e
3w ϵ0ϵ′−c/3)3 ∈F(ζ9)3, which contradicts Lemma 1.2 in [6].
If c = 1 holds, then ϵ3
0 = ζe
wϵ−σ2 and ϵ03σ = ζe
wϵ−1, which yields the
contradiction ϵ = (ζe
3wϵ−σ
0 )3 ∈F(ζ9)3 as above. Therefore we may assume
ϵ3
0 = ζe
wϵ/ϵ′.
Then we have ϵ3σ
0
= ζe
wϵ′(ϵϵ′) = ζe
wϵϵ′2 = (ϵ0ϵ′)3. Hence there is a third
root ω of unity so that
ϵσ
0 = ωϵ0ϵ′,
(4.7)
which implies
ϵ′ = ω−1ϵσ
0/ϵ0,
ϵ = ζ−e
w ϵ3
0ϵ′ = ζ−e
w ω−1ϵ2
0ϵσ
0.
This yields
o×
F = ⟨ζw, ϵ0, ϵσ
0⟩
and ϵσ2
0
= ζe
wϵ−1−σ
0
in (4.6) follows from ϵσ2
0
= (ωϵ0ϵ′)σ = ω(ωϵ0ϵ′)(ϵ−1ϵ′−1)
= ω3ζe
wϵ−1−σ
0
= ζe
wϵ−1−σ
0
. ϵσ+σJ
0
= 1 in (4.6) follows from ϵσ+σJ
0
=
(ϵσ
0)1+J > 0 and the fact that ϵσ+σJ
0
is a root of unity, since (ϵσ+σJ
0
)3 =
(ζe
wϵ/ϵ′)σ+σJ = ϵσ+σJ−σ2−σ2J = 1 by ϵσ2 = ϵσJ, ϵσ2J = {ϵ′J}J = ϵσ. By
(4.7), we have
ϵJ
0 = (ω−1ϵ′−1ϵσ
0)J = ωϵ1+σϵ−σ
0
= ω(ζ−e
w ω−1ϵ2
0ϵσ
0)(ζ−e
w ω−1ϵ2σ
0 ϵσ2
0 )ϵ−σ
0
= ω−1ζ−2e
w
ϵ2+2σ+σ2
0
= ω−1ζ−e
w ϵ1+σ
0
by ϵ1+σ+σ2
0
= ζe
w. We have only to show ω = 1 to complete the proof of
(4.6). It follows from
ϵσ
0 = ϵJσ2J
0
= (ω−1ζ−e
w ϵ1+σ
0
)σ2J = ωζe
wϵσ2J+J
0
= ωζe
w(ζe
wϵ−1−σ
0
)JϵJ
0 = ωϵσ
0.

DISTRIBUTION OF UNITS
81
Now, putting u1 = ϵ0, u2 = ϵσ
0, we have by (4.6)
ζσ
w = ζw,
uσ
1 = u2,
uσ
2 = ζe
wu−1
1 u−1
2 ,
ζσ2
w = ζw,
uσ2
1
= ζe
wu−1
1 u−1
2 ,
uσ2
2
= u1,
ζJ
w = ζ−1
w ,
uJ
1 = ζ−e
w u1u2,
uJ
2 = u−1
2 ,
ζσJ
w
= ζ−1
w ,
uσJ
1
= u−1
2 ,
uσJ
2
= u−1
1 ,
ζσ2J
w
= ζ−1
w ,
uσ2J
1
= u−1
1 ,
uσ2J
2
= ζ−e
w u1u2,
which yield
(x1, x2) mod w ∈V (˜η)
⇔
x1((b11 −b)a1 + b12a2 + b1a) + x2(b21a1 + (b22 −b)a2 + b2a) ≡0 mod w,
⇔










x1(−a1 + a2) + x2(−a1 −2a2 + ea) ≡0 mod w
(ρ = σ)
x1(−2a1 −a2 + ea) + x2(a1 −a2) ≡0 mod w
(ρ = σ2)
x1(2a1 + a2 −ea) ≡0 mod w
(ρ = J)
x1(a1 −a2) + x2(−a1 + a2) ≡0 mod w
(ρ = σJ)
x2(a1 + 2a2 −ea) ≡0 mod w
(ρ = σ2J)
⇒
½ x1(a1 −a2) ≡0 mod w,
x2(a1 −a2) ≡0 mod w,
⇒x1 ≡x2 ≡0 mod w for ˜η0 (↔a1 −a2 = 1).
Hence we have κ(η) = 1 under the assumption [o×
F : ⟨ζw, ϵ, ϵ′⟩] = 3. This
completes the proof.
When F0 is deﬁned by x3 + a1x + a0 = 0 with 0 ≤a1, |a0| ≤100, we
have checked κ(η) = Relη, by ﬁnding a prime number p satisfying #E(p) =
w(p −1)2/κ(η) by computer.
4.2. Case of complex conjugation
In this subsection, let F be an imaginary abelian extension of the rational
number ﬁeld Q with [F : Q] = 2n(≥4), and we assume that η is the
complex conjugation J. Denote the maximal real subﬁeld by F0; then d = 2
and g(x) = x −1 are obvious, and it is known that
Q =
£
o×
F : o×
F0
¤
is 1 or 2.
Therefore, we have o×
F = U(1) and so ˜∆= τ1 = 2 by Corollary 5.1. Now
Proposition 3.6 reads as follows:

82
YOSHIYUKI KITAOKA
For an extension ˜η ∈Gal(F2/Q) of η, put
o×
F =
­
ζw, u1, · · · , ur
®
,
ζ ˜η
2w = ζaw−1
2w
,
√ui
˜η = ζai
2w
Y
j
√uj
aij,
ta = (a1, · · · , ar),
A = (aij),
ζρ
w = ζb
w, ui
ρ = ζbi
w
Y
j
uj
bij,
tb = (b1, · · · , br),
B = (bij).
Then we have (cf. (3.27),(3.28))
V1(˜η) =
½
x ∈Zr/2Zr
¯¯¯¯
xa ≡0 mod 2, and for ∀ρ ∈Gal(F/Q)
x((aw −2)b + (B −b)a) ≡0 mod 2w
¾
,
(4.8)
V2(˜η) = {0},
and we note that uJ
i = ζai
w
Q
j uaij
j
determines ai mod w uniquely.
4.2.1. Case of [F : Q] = 4
Let ϵ0 (> 1) be the fundamental unit of F0.
Proposition 4.4. We have the following:
κ(η) =
(
2
if NF0/Q(ϵ0) = 1 and Q = 1,
1
otherwise.
Proof. Since r = rank o×
F = 1, (4.8) amounts to
V1(˜η) =
½
x1 ∈Z/2Z
¯¯¯¯
x1a1 ≡0 mod 2, for ∀ρ ∈Gal(F/Q)
x1{(aw −2)b1 + (b11 −b)a1} ≡0 mod 2w
¾
. (4.9)
First, we assume Q = 1; then ϵ0 being a fundamental unit of F, we can
take ϵ0 as the fundamental unit u1 of F and a1 ≡0 mod w is clear and so
the ﬁrst congruence x1a1 ≡0 mod 2 is satisﬁed for any x1 ∈Z. If ρ = id
on F0, then we have ρ = id or J, and hence b = ±1, b1 ≡0 mod w, and
b11 = 1. Therefore, the above equation for this ρ is satisﬁed for all x1 in
this case. Suppose ρ ̸= id on F0 and put NF0/Q(ϵ0) = (−1)s; then noting
b1 ≡sw/2 mod w, b11 = −1, b ≡1 mod 2, the second equation in (4.9)
becomes
x1(aw −2)b1 ≡x1(aw −2)sw/2 ≡0 mod 2w.

DISTRIBUTION OF UNITS
83
Hence, if s = 0, this is satisﬁed for all x1, and so κ(η) = 2. If s = 1,
then it is equivalent to x1(aw −2)w/2 ≡0 mod 2w. Taking a = 0, we have
x1 ≡0 mod 2, and so κ(η) = 1.
Next, we assume Q = 2; then we can choose a fundamental unit ϵ of F
as in §4.1.4 so that
ϵ0 = ζwϵ2,
ϵJ = ζwϵ.
Let u1 = ϵ; then a1 is odd, and then the ﬁrst congruence implies x1 ≡
0 mod 2 and so κ(η) = 1.
We remark that this is also compatible with [8] and explains the theo-
retical background of the constant ∆there, which is κ(η) here.
4.2.2. Case of [F : Q] = 6
Proposition 4.5. In this case, we have κ(η) = 1.
Proof. Let σ be an element in Gal(F/Q) of order 3. Let us show that there
is a system {u1, u2} of fundamental units so that
uσ
1 = u2,
uσ
2 = (u1u2)−1,
uJ
i = ui.
(4.10)
Because of ranko×
F = 2, there is a system u1, u2 of fundamental units
uσ
1 = u2,
uσ
2 = ζc
w(u1u2)−1,
using the theory of integral representation of the cyclic group of prime order
(the theorem on p. 508 [3]). Put uJ
i = ζdi
w ui; then deﬁning an integer e by
ζσ
w = ζe
w, we have
uσJ
1
= uJ
2 = ζd2
w u2,
uJσ
1
= (ζd1
w u1)σ = ζed1
w u2,
and so Gal(F/Q) being abelian, we may assume d2 = ed1. The equality
u1+σ+σ2
1
= ζc
w yields u(1+σ+σ2)J
1
= ζ−c
w
and uJ(1+σ+σ2)
1
= (ζd1
w u1)1+σ+σ2 =
ζ(1+e+e2)d1+c
w
, and hence ζ(1+e+e2)d1+2c
w
= 1. Therefore we have (1 + e +
e2)d1 +2c ≡0 mod w, which implies d1 is even. Thus we have (ζd1/2
w
u1)J =
ζd1/2
w
u1, and so we may assume d1 = 0. This necessitates c ≡0 mod w/2,
i.e. ζc
w = ±1. If ζc
w = −1, taking −ui as ui, we can assume ζc
w = 1, which
completes the proof of the above assertion (4.10).
Hence we have
ζJσ
w
= ζ−e
w ,
uJσ
1
= u2,
uJσ
2
= u−1
1 u−1
2 ,
ζJσ2
w
= ζ−e2
w
,
uJσ2
1
= u−1
1 u−1
2 ,
uJσ2
2
= u1,

84
YOSHIYUKI KITAOKA
whence
ρ = Jσ ⇒b ≡1 mod 2,
B =
µ 0
1
−1 −1
¶
,
b ≡0 mod w,
ρ = Jσ2 ⇒b ≡1 mod 2,
B =
µ −1 −1
1
0
¶
,
b ≡0 mod w
and this implies, for an extension ˜η0 corresponding to a1 = a2 = 1
(x1, x2) ∈V1(˜η0)
⇔
½xa ≡0 mod 2,
x((aw −2)b + (B −b)a) ≡0 mod 2w
⇒(x1, x2)(B + 12)
µ 1
1
¶
≡0 mod 2
(ρ = Jσ, Jσ2)
⇒







(x1, x2)
µµ 0
1
−1 −1
¶
+ 12
¶ µ 1
1
¶
≡0 mod 2,
(ρ = Jσ)
(x1, x2)
µµ −1 −1
1
0
¶
+ 12
¶ µ 1
1
¶
≡0 mod 2
(ρ = Jσ2)
⇒x1 ≡x2 ≡0 mod 2.
This yields V1(˜η0) = V2(˜η0) = 2Z, and so κ(η) = 1.
Remark 4.2. When equations y3 −ay + b = 0 and x2 + c = 0 (0 < a, b <
1000, 0 < c < 100, a, b, c ∈Z), deﬁne a real cubic abelian subﬁeld and an
imaginary quadratic subﬁeld of F, respectively, the equality κ(η) = Relη is
conﬁrmed by ﬁnding a prime number p so that #E(p) = w(p −1)2 with
the aid of computer.
4.3. Case where F is an imaginary abelian ﬁeld with
[F : Q] = 6 and the order of η ∈Gal(F/Q) is 3
Proposition 4.6. In this case, we have κ(η) = 1.
Proof. As in §4.2.2 (cf. (4.10)), we may assume
o×
F = ⟨ζw, u1, u2⟩,
uη
1 = u2,
uη
2 = (u1u2)−1 (u1, u2 ∈F0),
(4.11)
where F0 is the maximal real subﬁeld of F. It is easy to see that o×
F = U(3),
i.e. o×
F = {ϵ ∈o×
F | ϵg(η) ∈WF }, on putting g(x) = Φ3(x) = x2 + x + 1.
Hence we have ˜∆= τ3 for every extension ˜η of η (cf. the remark just after
(3.9)).

DISTRIBUTION OF UNITS
85
Lemma 4.1. We have
˜∆=



7
if F = Q(ζ7),
3
if ζ3 ∈F,
1
otherwise.
Proof. Let p be a prime divisor of ˜∆and let pn || ˜∆. Then ζg(ρ)
pn
= 1 for
every extension ρ ∈Gal(F(ζpn)/Q) of η by deﬁnition (cf. (3.8)). Suppose
that σa ∈Gal(Q(ζpn)/Q) with ζσa
pn = ζa
pn coincides with η on F ∩Q(ζpn);
then it is extended to an element ˜σa ∈Gal(F(ζpn)/Q) with ˜σa|F = η and
so we have a2 + a + 1 ≡0 mod pn by ζg(˜σa)
pn
= 1. In particular, p is an odd
prime (̸= 5), and
£
Q(ζpn) : F ∩Q(ζpn)
¤
≤#
©
a mod pn ¯¯ a2 + a + 1 ≡0 mod pnª
.
Let us check that the right-hand side is ≤2. In case of p = 3, this is obvious,
since there is no solution of x2 + x + 1 ≡0 mod 9. Suppose p ̸= 3; then
Lemma 5.2 with f(x) = x2 + x + 1, A(x) = 4, B(x) = −(2x + 1), n = 3
yields #{a mod pn | a2 + a + 1 ≡0 mod pn} ≤2. Now the inequality
[Q(ζpn) : F ∩Q(ζpn)] ≤2 yields
pn−1(p −1) = [Q(ζpn) : F ∩Q(ζpn)][F ∩Q(ζpn) : Q] | 12.
(4.12)
Therefore the possibilities of p, n are p = 13, n = 1; p = 7, n = 1; p = 3,
n ≤2.
• Case of p = 13, n = 1
(4.12) implies [F ∩Q(ζ13) : Q] = 6, and so F ⊂Q(ζ13). Since the subgroup
corresponding to F in Gal(Q(ζ13)/Q) is of order 2, it is generated by the
complex conjugation. Hence F is a real subﬁeld, which is a contradiction.
• Case of p = 7, n = 1
(4.12) implies 6 ≤2[F ∩Q(ζ7) : Q], and then [F ∩Q(ζ7) : Q] = 3, 6.
Suppose [F ∩Q(ζ7) : Q] = 6; then F = Q(ζ7). Therefore we have η = σ2
or = σ4 and they satisfy ζg(η)
7
= 1. Thus we conclude that 7 | ˜∆in case of
F = Q(ζ7).
Suppose [F ∩Q(ζ7) : Q] = 3; then F0 and F ∩Q(ζ7) coincides with the
maximal real subﬁeld of Q(ζ7). σa (a = 3, 5) induces an automorphism of
order 3 in Gal(F ∩Q(ζ7)/Q), and one of them coincides with η on F ∩
Q(ζ7) = F0 but neither of them satisﬁes a2 + a + 1 ≡0 mod 7. Thus this
case does not occur.
• Case of p = 3, n = 2
In this case, pn = 9, and there is no integer a which satisﬁes a2 + a + 1 ≡
0 mod 9. Hence this case does not happen.

86
YOSHIYUKI KITAOKA
• Case of p = 3, n = 1
In case of F ∋ζ3, an automorphism ρ ∈Gal(F(ζ3)/Q) = Gal(F/Q), which
is an extension of η ﬁxes ζ3 (∈F ∩Q(ζ3)) because the order of η is three,
and so ζg(ρ)
3
= 1, i.e. 3 | ˜∆. In case of ζ3 ̸∈F, F ∩Q(ζ3) = Q holds, and so
extending η to ρ by ζρ
3 = ζ−1
3 , we have ζg(ρ)
3
̸= 1, i.e. 3 ∤˜∆.
Now we distinguish three cases. Suppose ˜∆= 1; then τ3 = 1 and Propo-
sition 3.5 implies [R(˜η, p) : WF o×
F
η−p] = 1. Hence we get κ(η) = 1.
Suppose ˜∆= 3; then ζ3 ∈F implies 3 | w. As in Lemma 3.14, we put
ζ ˜η
3w = ζa
3w,
3√ui
˜η = ζai
3w
Q
j
3√uj
aij
ζρ
w = ζb
w,
uiρ = ζbi
w
Q
j ujbij,
which yields a ≡b ≡0 mod w by (4.11), and since the quadratic subﬁeld
of F is Q(ζ3), we have a ≡1 mod 3 and so Φ3(a) ≡0 mod 3. Hence by
(3.9), we have τ3 = 3 = ˜∆and then (3.27) means V1(˜η) = {y mod 3 |
yΦ3(a, A)(B −b)a ≡0 mod 3w for ∀ρ}. It is easy to see that
B −b =







µ 2 0
0 2
¶
if ρ = J,
µ −a
1
−1 −a −1
¶
if ρ = η,
whence choosing ˜η with a =
µ w
2w
¶
, we have, by a ≡1 mod 3
(B −b)a ≡
µ2w
w
¶
,
µ w
w
¶
mod 3w.
Since 2x + y ≡x + y ≡0 mod 3 has only a trivial solution, y ∈V1(˜η)
satisﬁes yΦ3(a, A) ≡0 mod 3. Thus V1(˜η) ⊂V2(˜η) (cf. (3.27),(3.28)) holds,
which means κ(η) = 1.
Suppose ˜∆= 7, i.e. F = Q(ζ7) as above. As in Lemma 3.14, we put
ζ ˜η
7w = ζa
7w,
7√ui
˜η = ζai
7w
Q
j
7√uj
aij
ζρ
w = ζb
w,
uiρ = ζbi
w
Q
j ujbij.
Since the order of η is 3, we have a ≡2, 4 mod 7, and a ≡b ≡0 mod w
(cf. (4.11)). Therefore we have Φ3(a) ≡0 mod 7, from which τ3 = 7 = ˜∆
follows by (3.9) and hence y ∈V1(˜η) (cf. (3.27)) yields
yΦ3(a, A)(B −b)a ≡0 mod ˜∆w.

DISTRIBUTION OF UNITS
87
Here, since we have
B −b =







µ 2 0
0 2
¶
if ρ = J,
µ −a
1
−1 −a −1
¶
if ρ = η,
taking a =
µ w
w
¶
, we obtain
(B −b)a =
µ2w
2w
¶
,
µ(−a + 1)w
(−a −2)w
¶
.
The determinant of
µ 2 −a + 1
2 −a −2
¶
is not 0 mod 7, and so y ∈V1(˜η) yields
yΦ3(a, A) ≡0 mod 7 and so y ∈V2(˜η). Therefore we conclude that κ(η) = 1
as above.
Remark 4.3. In all the examples given here, we have o×
F = U(m) for a
single m. If F is a real cyclic extension of degree 4, then we see that there
is a system of fundamental units {u1, u2, u3} such that
uσ
1 = ζu−1
1 ,
uσ
2 = u−1
3 ,
uσ
3 = ζ′u2
(ζ, ζ′ = ±1),
(4.13)
uσ
1 = ζu−1
1 ,
uσ
2 = u−1
3 ,
uσ
3 = u−1
1 u2
(ζ = ±1),
(4.14)
where σ is a generator of Gal(F/Q). Let η = σ2; then we have
U(1) = ⟨−1, u1⟩,
U(2) = ⟨−1, u2, u3⟩
for (4.13),
U(1) = ⟨−1, u1⟩,
U(2) = ⟨−1, u1u−2
2 , u−1
1 u2u3⟩
for (4.14),
and so o×
F ̸= U(1)U(2) in case of (4.14). We can see that
κ(η) =
½2
if ζ′ = −1
4
if ζ′ = 1
for (4.13), =
½ 1
if ζ = −1
2
if ζ = 1
for (4.14),
and as far as we have checked, κ(η) = Relη is true.
5. Appendix
5.1. Divisors of f(p)
Proposition 5.1. Let L be a Galois extension of Q and η ∈Gal(L/Q),
and let f(x) ∈Z[x] be a polynomial in Q[x] with (f(x), f ′(x)) = 1. Then
there exists the maximum δ of natural numbers m such that
if ˜η ∈Gal(L(ζm)/Q) and ˜η|L = η, then ζf(˜η)
m
= 1 holds.
(5.1)

88
YOSHIYUKI KITAOKA
We have the following expression for δ:
δ =
gcd
η∈σL/Q(p),p∤2DLδ
f(p) = lim
x→∞
gcd
η∈σL/Q(p),p>x
f(p).
We need a few lemmas to prove Proposition 5.1.
Lemma 5.1 (Newton Approximation). Let q be a prime number and
f(x) ∈Zq[x]. If a ∈Zq satisﬁes |f(a)|q < |f ′(a)|2
q, then there is a solution
α ∈Zq of f(x) = 0 such that |α −a|q ≤|f(a)/f ′(a)|q.
Proof. See p.83 in [1].
Lemma 5.2. Let q be a prime number and let f(x) ∈Z[x] be the polynomial
in the proposition. Taking integral polynomials A(x), B(x) ∈Z[x] and a
natural number n such that
A(x)f(x) + B(x)f ′(x) = n,
we deﬁne the integer s by qs||n.
Then for any natural number t ≥2s + 1
#{a mod qt | f(a) ≡0 mod qt} ≤deg f(x) · qs
holds.
Proof. If t ≥2s + 1 and f(a) ≡0 mod qt, then we have qs+1 ∤f ′(a)
and hence |f(a)|q < |f ′(a)|2
q. Hence, by Lemma 5.1, there is an element
α ∈Zq such that f(α) = 0 and |α −a|q ≤|f(a)/f ′(a)|q. qt−s | f(a)/f ′(a)
implies a ≡α mod qt−s. Since the number of roots α is less than or equal
to deg f(x), we obtain the assertion.
Lemma 5.3. The maximal integer δ in Proposition 5.1 exists.
Proof. For relatively prime natural numbers m1 and m2, the condition
(5.1) holds for m = m1m2 if and only if it holds for m = m1, m2. Hence,
assuming that m is a power qt of a prime q, we have only to show that it
holds for a ﬁnitely many such integers m. Suppose that η′ ∈Gal(Q(ζqt)/Q)
coincides η on L ∩Q(ζqt); the number of such η′’s is equal to [Q(ζqt) :
L ∩Q(ζqt)]. Since η′ is extended to an element of Gal(L(ζqt)/Q) whose
restriction on L is η, the condition (5.1) yields ζf(a)
qt
= 1, where a is deﬁned
by ζη′
qt = ζa
qt. Hence a mod qt corresponding to η′ satisﬁes f(a) ≡0 mod qt.
Let n, s be those in Lemma 5.2. If, then t ≥2s + 1 holds, then Lemma 5.2

DISTRIBUTION OF UNITS
89
implies [Q(ζqt) : L ∩Q(ζqt)] ≤deg f(x) · qs and so ϕ(qt) ≤deg f(x) · qs[L ∩
Q(ζqt) : Q] ≤deg f(x) · n[L : Q]. Hence qt is bounded.
Proof of Proposition 5.1. Put
G =
gcd
η∈σL/Q(p),p>x
f(p)
for a large number x (> 2DLδ). Take any extension ˜η of η in Gal(L(ζG)/Q);
then we have ζf(˜η)
G
≡ζf(q)
G
≡1 mod q if q (> xG) is a prime number such
that σL(ζG)/Q(q) ∋˜η. If ζf(˜η)
G
̸= 1, then for a prime divisor ℓof the order of
ζf(˜η)
G
, we have ℓ| G and ζℓ−1 ∈q. Hence we get ℓ= q and so q | G. This
contradicts q > G. Thus we obtain ζf(˜η)
G
= 1 and so G | δ.
Conversely, take a prime p so that η ∈σL/Q(p) and p ∤2DLδ. For ˜η ∈
σLδ/Q(p), ζf(˜η)
δ
= 1 holds, whence ζf(p)
δ
≡1 mod p follows. Then ζf(p)
δ
= 1
should occur and δ divides f(p). Thus we have δ | G.
In general, δ = gcdη∈σL/Q(p),p∤2DL f(p) does not hold.
Corollary 5.1. Suppose f(x) = x−1 in the proposition. If η is the identity
(resp. the complex conjugation), then we have δ = w (resp. δ = 2).
Proof. Suppose δ satisﬁes the condition (5.1). By the Galois theory, there
are [Q(ζδ) : L ∩Q(ζδ)] extensions ˜η of η to Gal(L(ζδ)/Q), and then the
supposition f(x) = x −1 implies ζ ˜η−1
δ
= 1, i.e. ζ ˜η
δ = ζδ. Thus the extension
to Gal(L(ζδ)/Q) is uniquely determined as the identity. This means [Q(ζδ) :
L ∩Q(ζδ)] = 1, that is Q(ζδ) ⊂L and hence δ|w. Hence, in case that η
is the identity, w divides δ clearly and so δ = w, and if η is the complex
conjugation, then ζ−1
δ
= ζ ˜η
δ = ζδ yields δ = 2.
5.2. Structure of Galois group extended by roots of units
The aim of this subsection is to study the structure of
Gal
µ
L
³
pnq
o×
L
´.
L
³
pnp
WL
´¶
for an algebraic number ﬁeld L. Let us recall [11]
Theorem 5.1. Let L be a ﬁeld of characteristic 0 and let p be a
prime and a ∈L \ Lp. Then we have
(i) If p ̸= 2, then xpn −a is irreducible over L for every natural
number n,

90
YOSHIYUKI KITAOKA
(ii) If p = 2, then x2−a is irreducible over L, and a ̸∈−4L4 if and
only if x2n −a is irreducible over L for any integer n (≥2).
Proposition 5.2. Let L be an algebraic number ﬁeld. Then the following
hold for any natural number n:
(i) For ϵ ∈o×
L with ϵ /∈WLL2, we have −4ϵ /∈L(ζ2n)4.
(ii) For ϵ ∈o×
L with ϵ /∈WLL2, x2n −ϵ is reducible over L(ζ2n) if and only
if √ϵ ∈L(ζ2n).
(iii) If, for ϵi ∈o×
L (i = 1, 2) √ϵi ∈L(ζ2n) and ϵi /∈WLL2 hold for i = 1
and 2, then ϵ1ϵ2 ∈WLL2.
Proof. Proof of (i): Suppose −4ϵ ∈L(ζ2n)4; then there is an element
α ∈L(ζ2n) such that α4 = −4ϵ. Putting M = L(α), we see that L ⊂M ⊂
L(ζ2n). Since L(ζ2n) is abelian over L, M is a Galois extension of L. The
assumption on ϵ and (ii) in Theorem 5.1 imply that x4 + 4ϵ is irreducible
over L and so [M : L] = 4 is valid. Since M is a Galois extension of L, M
contains a conjugate √−1α of α and so √−1.
In case of √−1
/∈
L(√−ϵ), we have L(√−ϵ)(√−1)
=
M
=
L(√−ϵ)(
√
α2) (α2 = ±2√−ϵ ∈L(√−ϵ)), which yields
α2/(−1) ∈L(
√
−ϵ)2.
Then −α2 = ∓2√−ϵ = (c + d√−ϵ)2 holds for ∃c, ∃d ∈L, and this implies
∓2√−ϵ = c2 −ϵd2 +2cd√−ϵ, which yields a contradiction ϵ = (c/d)2. Thus
√−1 ∈L(√−ϵ) holds.
If √−1 /∈L, then L(√−1) = L(√−ϵ) and so √−1/√−ϵ ∈L follows,
which implies the contradiction ϵ ∈L2.
Suppose √−1 ∈L. We note that Q(ζ2n) = Q(√−1)Q(ζ2n + ζ−1
2n ) and
Q(ζ2n + ζ−1
2n )/Q is cyclic, and so a subﬁeld containing √−1 of Q(ζ2n) coin-
cides with Q(ζ2m) for some integer m. Hence by √−1 ∈L ⊂M ⊂L(ζ2n)
there is an integer such that L∩Q(ζ2n) = Q(ζ2m), M ∩Q(ζ2n) = Q(ζ2m+2).
Hence x4 −ζ2m is irreducible over L by (ii) in Theorem 5.1. Thus M =
L(
4√−4ϵ) = L( 4√ζ2m) holds. By Kummer’s theory, we have
4√−4ϵ/ 4√ζ2ma ∈
L for ∃a ∈Z, which implies a contradiction ϵ ∈−4ζa
2mL4 ⊂WL(o×
L)2. Thus
we have completed the proof of (i).
Proof of (ii): We know
x2n −ϵ is irreducible over L(ζ2n)
⇔x2 −ϵ is irreducible over L(ζ2n) and −4ϵ /∈L(ζ2n)4 if n ≥2
⇔x2 −ϵ is irreducible over L(ζ2n).

DISTRIBUTION OF UNITS
91
The ﬁrst equivalence follows from Theorem 5.1. The second follows from
(i). This completes the proof of the case (ii).
Proof of (iii): If L(√ϵ1) = L(√ϵ2), then ϵ1/ϵ2 ∈L2 holds and the assertion
(iii) is clear. We assume L(√ϵ1) ̸= L(√ϵ2) hereafter.
We need the following:
For a natural number n, the subﬁelds of Q(ζ2n) are
Na =
Q(ζ2a),
[Na : Q] = 2a−1 (a = 1, 2, · · · , n),
Na,+ = Q(ζ2a + ζ−1
2a ),
[Na,+ : Q] = 2a−2 (a = 3, 4, · · · , n),
Na,−= Q(ζ2a −ζ−1
2a ),
[Na,−: Q] = 2a−2 (a = 3, 4, · · · , n).
To show this, we have only to verify that subﬁelds of Nn = Q(ζ2n) not
contained in Nn−1 are Nn,+ and Nn,−for n ≥3. Since Gal(Nn/Q) ∼=
Z/2Z ⊕Z/2n−2Z and the subgroup corresponding to Nn−1 is of or-
der 2 and generated by g := (0 mod 2) ⊕(2n−3 mod 2n−2) ∈Z/2Z ⊕
Z/2n−2Z, the assertion above follows from the fact that subgroups of
Gal(Nn/Q) which do not contain g is (0 mod 2) ⊕(0 mod 2n−2), ⟨(1
mod 2) ⊕(0 mod 2n−2)⟩, ⟨(1 mod 2) ⊕(2n−3 mod 2n−2)⟩. They corre-
spond to Nn, Nn,+, Nn,−respectively, since (1 mod 2) ⊕(0 mod 2n−2)
corresponds to the complex conjugation and (0 mod 2) ⊕(1 mod 2n−2)
corresponds to ζ2n →ζ5
2n, and 52n−3 ≡1 + 2n−1 mod 2n.
By virtue of Gal(L(ζ2n)/L) ∼= Gal(Q(ζ2n)/L ∩Q(ζ2n)), we have
[L(√ϵi) ∩Q(ζ2n) : L ∩Q(ζ2n)]
= [Q(ζ2n) : L ∩Q(ζ2n)]/[Q(ζ2n) : L(√ϵi) ∩Q(ζ2n)]
= [L(ζ2n) : L]/[L(√ϵi, ζ2n) : L(√ϵi)]
= [L(ζ2n) : L]/[L(ζ2n) : L(√ϵi)] = [L(√ϵi) : L] = 2.
Since L ⊂L(√ϵi) ⊂L(ζ2n) and L(√ϵ1) ̸= L(√ϵ2), ﬁelds L(√ϵ1) ∩Q(ζ2n)
and L(√ϵ2)∩Q(ζ2n) are diﬀerent quadratic extensions of L∩Q(ζ2n). Using
the classiﬁcation above, we get
L ∩Q(ζ2n) = Q or Na,+ (a = 3, 4, · · · , n −1),
on noting that
the quadratic extensions of Na (2 ≤a ≤n −1) in Nn are only Na+1,
the quadratic extensions of Na,+ (3 ≤a ≤n−1) in Nn are Na, Na+1,+,
Na+1,−,
the quadratic extensions of Na,−(3 ≤a ≤n) in Nn are only Na.

92
YOSHIYUKI KITAOKA
(iii.1) Suppose L ∩Q(ζ2n) = Q.
We note that L(√ϵ1), L(√ϵ2), L(√ϵ1ϵ2) are quadratic extensions of L
contained in L(ζ2n) and they are equal to L(√−1), L(
√
2), L(√−2). If
L(√ϵj) = L(√−1) (j = 1 or 2), then √ϵj/√−1 ∈L and −ϵj ∈L2 fol-
lows, which is a contradiction. Hence we have L(√ϵ1ϵ2) = L(√−1), whence
−ϵ1ϵ2 ∈L2 follows.
For the remaining cases, we may assume L(
√
2) = L(√ϵ1), L(√−2) =
L(√ϵ2); then ϵ1 ∈2L2, ϵ2 ∈−2L2 yield ϵ1ϵ2 ∈−L2.
(iii.2) Suppose L ∩Q(ζ2n) = Na,+ for a = 3, 4, · · · , n −1.
Put κ = ζ2a + ζ−1
2a ; then Na,+ = Q(κ), Na+1,+ = Q(√κ + 2) and
Na+1,−= Q(√κ −2) hold, and Q(√κ + 2), Q(√κ −2) and Q(ζ2a) are
quadratic extensions of Na,+ in Q(ζ2n). Also L(√ϵ1), L(√ϵ2), L(√ϵ1ϵ2)
are quadratic extensions of L in L(ζ2n) and should be equal to L(√κ + 2),
L(√κ −2), L(ζn
2 ). Since √−1(ζ2a −ζ−1
2a ) is real, it is in Na,+ and it follows
that (κ + 2)(κ −2) = κ2 −4 = (ζ2a −ζ−1
2a )2 = −(√−1(ζ2a −ζ−1
2a ))2 ∈
−N 2
a,+ ⊂−L2. Hence we have ϵ1ϵ2, ϵ1(ϵ1ϵ2) or ϵ2(ϵ1ϵ2) ∈−L2. The as-
sumption ϵi /∈WLL2 now implies −ϵ1ϵ2 ∈L2.
Corollary 5.2. Let L be an algebraic number ﬁeld and suppose ϵ ∈o×
L
satisﬁes ϵ /∈WLL2. If √ϵ ∈L(ζ2m), then x2m −√ϵ is irreducible over
L(ζ2m).
Proof. The assumption √ϵ ∈L(ζ2m) implies m ≥2. By Theorem 5.1,
x2m −√ϵ is irreducible over L(ζ2m) if and only if
4√ϵ /∈L(ζ2m) and −4√ϵ /∈
L(ζ2m)4. Suppose that x2m −√ϵ is reducible over L(ζ2m); ﬁrst, assume
m ≥3. If f :=
4√ϵ ∈L(ζ2m), then −4ϵ = (ζ8
√
2f)4 ∈L(ζ2m)4, which
contradicts the assertion (i) of Proposition 5.2. If −4√ϵ ∈L(ζ2m)4, then
putting −4√ϵ = f 4
1 (f1 ∈L(ζ2m)), we have −4ϵ = (f 2
1 /(ζ8
√
2))4 ∈L(ζ2m)4,
which is also a contradiction. Therefore x2m −√ϵ is irreducible over L(ζ2m)
in case of m ≥3.
Now, applying the above to m = 3, x8 −√ϵ = (x2)4 −√ϵ is irreducible
over L(ζ8). Hence x4 −√ϵ is irreducible over L(ζ4), which completes the
proof of the case m = 2.
Corollary 5.3. Let L be an algebraic number ﬁeld and let ϵ1, ϵ2 ∈o×
L
satisfy ϵ1 /∈WLL2. If √ϵ1 ∈L(ζ2m) for a natural number m, then √ϵ1ϵ2 /∈
L(ζ2m)2.
Proof. By applying Corollary 5.2 to ϵ = ϵ1ϵ2
2, x2m −√ϵ1ϵ2 is irreducible
over L(ζ2m) and so is x2 −√ϵ1ϵ2. Therefore √ϵ1ϵ2 /∈L(ζ2m)2.

DISTRIBUTION OF UNITS
93
The following is the main result of this subsection.
Theorem 5.2. Let L be an algebraic number ﬁeld. Denote by r the rank
of o×
L. Let p be a prime number and n a natural number. Then we have the
following:
(i) Suppose either p ̸= 2 or that p = 2 and o×
L ∩L( 2n√WL)2 ⊂WL · (o×
L)2.
Then we have
Gal
µ
L
³
pnq
o×
L
´.
L
³
pnp
WL
´¶
∼= (Z/pnZ)r .
(ii) Suppose that p = 2 and o×
L ∩L( 2n√WL)2 ̸⊂WL · (o×
L)2. Then we have
n ≥2 and
Gal
µ
L
³
pnq
o×
L
´.
L
³
pnp
WL
´¶
∼= Z/2n−1Z × (Z/2nZ)r−1.
We need more lemmas.
Lemma 5.4. Suppose that p is an odd prime number and ϵ ∈o×
L is not in
WL(o×
L)p. Then ϵ /∈L(ζpn)p for ∀n ≥1.
Proof. Suppose ϵ ∈L(ζpn)p; then L ⊂L( p√ϵ) ⊂L(ζpn) clearly and
Gal
¡
L(ζpn)
±
L
¢ ∼= Gal
¡
Q(ζpn)
±
L ∩Q(ζpn)
¢
.
Since L(ζpn)/L is an abelian extension, L( p√ϵ)/L is a Galois extension.
Hence in view of
p√ϵ /∈L and p ̸= 2, xp −ϵ is irreducible over L. Thus we
have [L( p√ϵ) : L] = p and so the conjugate ζp
p√ϵ is in L( p√ϵ). Therefore
ζp ∈L( p√ϵ) and L ⊂L(ζp) ⊂L( p√ϵ) follows. [L( p√ϵ) : L] = p and [L(ζp) :
L] | p −1 imply L(ζp) = L. Therefore we have L ∩Q(ζpn) ⊃Q(ζp) and
hence L ∩Q(ζpn) = Q(ζpm) and L( p√ϵ) ∩Q(ζpn) = Q(ζpm+1) hold for
1 ≤∃m < n by p ̸= 2. Since L( p√ϵ) (⊂L(ζpn)) is the composite of L
and L( p√ϵ) ∩Q(ζpn) = Q(ζpm+1), we have L( p√ϵ) = L(ζpm+1) and hence
f :=
p√ϵ/ pp
ζpm
a ∈L for ∃a ∈Z by virtue of ζpm ∈L. Therefore ϵ =
ζa
pmf p ∈WL(o×
L)p and this contradicts the assumption on ϵ.
Lemma 5.5. Suppose ϵ1 ∈o×
L is not in WL(o×
L)p and let n (≥2) be a
natural number. Under the further assumption of ϵ1 /∈L( 2n√WL)2 in case
of p = 2, we have
Gal
³
L
¡ pnp
WL,
pn√ϵ1
¢.
L
¡ pnp
WL
¢´
∼= Z/pnZ.

94
YOSHIYUKI KITAOKA
Proof. We note that L( pn√WL) = L(ζpm) for some integer m (≥n) and
by Kummer’s theory, it suﬃces to prove that xpn −ϵ1 is irreducible over
L( pn√WL).
In the case of p ̸= 2, xpn −ϵ1 is irreducible over L( pn√WL) if and only
if xp −ϵ1 is so over L( pn√WL), which is true by virtue of Lemma 5.4.
Suppose that p = 2 and x2n −ϵ1 is reducible over L( 2n√WL); then either
√ϵ1 ∈L( 2n√WL) or −4ϵ1 ∈L( 2n√WL)4 occurs. However, neither of them
can not occur by the assumption or (i) in Proposition 5.2. Thus x2n −ϵ1 is
irreducible over L( 2n√WL).
Lemma 5.6. Under the assumption in (ii) in Theorem 5.2, n ≥2 holds
and there is an element ϵ1 ∈o×
L such that ϵ1 /∈WL(o×
L)ℓfor ∀ℓ≥2,
ϵ1 ∈L( 2n√WL)2 and
Gal
³
L
¡ 2np
WL,
2n√ϵ1
¢.
L
¡ 2np
WL
¢´
∼= Z/2n−1Z.
Proof. Suppose ϵ ∈o×
L ∩L(ζ2m)2 for m := #WL; then we have ϵ =
(a + bζ2m)2 for ∃a, ∃b ∈L, which implies ϵ = a2 + b2ζm, ab = 0 and hence
ϵ ∈WL(o×
L)2. Thus we have o×
L ∩L(√WL)2 ⊂WL(o×
L)2, and hence n ≥2.
By the assumption in (ii), there is an element ϵ ∈o×
L such that ϵ = α2
(α ∈L( 2n√WL)) and ϵ /∈WL(o×
L)2. Write ϵ = ζϵk
1 where ζ ∈WL and
ϵ1 ∈o×
L with ϵ1 /∈WL(o×
L)ℓfor ∀ℓ≥2. The condition ϵ /∈WL(o×
L)2 implies
2 ∤k. Then we have α = √ϵ = √ζ√ϵ1ϵ (k−1)/2
1
∈L( 2n√WL). Therefore
√ϵ1 ∈L( 2n√WL) holds. Deﬁning the integer a by #WL = 2ab (2 ∤b),
Corollary 5.2 implies that x2n+a −√ϵ1 = (x2a+1)2n−1 −√ϵ1 is irreducible
over L(ζ2n+a) = L( 2n√WL). Therefore x2n−1 −√ϵ1 is also irreducible over
L( 2n√WL).
Lemma 5.7. Let ϵ1, · · · , ϵr be a system of fundamental units of L. Suppose
the assumptions of (i), (ii) in Theorem 5.2 in each case, with one extra-
condition √ϵ1 ∈L( 2n√WL) in case of (ii). Then we have
pa+1√ϵs+1 /∈L
³
pnp
WL,
pn√ϵ1, · · · ,
pn√ϵs,
pa√ϵs+1
´
for 0 ≤∀a < n and 1 ≤∀s < r.
Proof. Suppose
pa+1√ϵs+1 ∈L( pn√WL,
pn√ϵ1, · · · ,
pn√ϵs,
pa√ϵs+1); then we
have, for some integers a1, a2, · · · , as+1
f :=
pn√ϵ1
a1 · · ·
pn√ϵs
as pa√ϵs+1
as+1/ pa+1√ϵs+1 ∈L(
pnp
WL),
since L( pn√WL,
pn√ϵ1 · · · ,
pa√ϵs+1) is a Kummer extension of L( pn√WL).

DISTRIBUTION OF UNITS
95
In case of (i):
Deﬁne the integer b by
pb∥(a1, · · · , as, (as+1p −1)pn−a−1),
0 ≤b ≤n −a −1.
Then we have
ϵ := ϵa1/pb
1
· · · ϵas/pb
s
ϵ(as+1p−1)pn−a−1−b
s+1
= f pn−b = (f pn−b−1)p ∈L(
pnp
WL)p.
By noting that ϵ is not in WL(o×
L)p, the equation above contradicts Lemma
5.4 if p ̸= 2. Suppose p = 2; the assumption of (i) implies ϵ ∈WL(o×
L)2,
which contradicts the choice of the integer b.
In case of (ii):
Deﬁne the integer b by
2b∥(2a1, a2, · · · , as, (2as+1 −1)2n−a−1),
0 ≤b ≤n −a −1.
Then we have
ϵ := ϵ2a1/2b
1
ϵa2/2b
2
· · · ϵas/2b
s
ϵ(2as+1−1)2n−a−1−b
s+1
= (√ϵ1
2a1/2b
f 2n−b−1)2
∈L(
2np
WL)2.
Suppose 2b∥2a1; then put
η1 = ϵ1 and η2 = ϵ(2a1/2b−1)/2
1
ϵa2/2b
2
· · · ϵas/2b
s
ϵ(2as+1−1)2n−a−1−b
s+1
.
We have η1, η2 ∈o×
L, √η1 ∈L( 2n√WL) and √η1 η2 = ϵ ∈L( 2n√WL)2. This
contradicts Corollary 5.3, since L( 2n√WL) = L(ζ2m) for some m.
Suppose 2b | a1; then ϵ ∈L( 2n√WL)2 as above and one of A2 := a2/2b, · · · ,
As
:= as/2b, As+1
:= (2as+1 −1)2n−a−1−b is odd, and ϵ12a1/2b
=
(ϵ1a1/2b)2 ∈L( 2n√WL)2. Hence we have
ϵϵ−2a1/2b
1
= ϵA2
2
· · · ϵAs+1
s+1 ∈L
³
2np
WL
´2
.
Applying (iii) of Proposition 5.2 to ϵ1 and ϵA2
2
· · · ϵAs+1
s+1 , we have the inclu-
sion ϵ1ϵA2
2
· · · ϵAs+1
s+1 ∈WLL2, which is a contradiction.
Proof of Theorem 5.2. Let ϵ1, · · · , ϵr be a system of fundamental units
of L, and we may suppose that ϵ1 is a unit given in Lemma 5.6 in the case
(ii). Then Lemmas 5.5, 5.6, 5.7 imply
·
L
³
pnq
o×
L
´
: L
³
pnp
WL
´¸
=
(
prn
in the case (i),
2n−1+(r−1)n
in the case (ii).
Since L
³
pnq
o×
L
´.
L
¡
pn√WL
¢
is a Kummer extension, this completes the
proof.

96
YOSHIYUKI KITAOKA
Acknowledgments
I thank Professor S. Kanemitsu for many helpful suggestions, and this work
was partially supported by Grant-in-Aid for Scientiﬁc Research (C), The
Ministry of Education, Culture, Sports, Science and Technology of Japan.
References
1. J.W.S. Cassels and A. Fr¨ohlich, Algebraic Number Theory, Academic Press,
1967.
2. Y-M. J. Chen, Y. Kitaoka and J. Yu, Distribution of units of real quadratic
number ﬁelds, Nagoya Math. J., 158 (2000), 167–184.
3. C.W. Curtis and I. Reiner, Representation theory of ﬁnite groups and asso-
ciative algebras, Interscience, 1962.
4. T. Honda,
Pure cubic ﬁelds whose class numbers are multiple of three, J.
Number Theory, 3 (1971), 7–12.
5. M. Ishikawa and Y. Kitaoka,
On the distribution of units modulo prime
ideals in real quadratic ﬁelds, J. reine angew. Math., 494 (1998), 65–72.
6. Y. Kitaoka, Distribution of units of a cubic ﬁeld with negative discriminant,
J. Number Theory, 91 (2001), 318–355.
7. Y. Kitaoka, Distribution of units of an algebraic number ﬁeld, in Galois
Theory and Modular Forms, (2003), 287–303. Developments in Mathematics,
Kluwer Academic Publishers.
8. Y. Kitaoka, Distribution of units of an algebraic number ﬁelds with only one
fundamental unit, Proc. Japan Acad., 80A (2004), 86–89.
9. Y. Kitaoka, Distribution of units of a cubic abelian ﬁeld modulo prime num-
bers, J. Math. Soc. Japan, (2)58 (2006), 563–584.
10. T. Kubota, ¨Uber den bizyklischen biquadratischen Zahlk¨orper, Nagoya Math.
J., 10 (1955), 65–85.
11. S. Lang, Algebra, Springer-Verlag, 2002.
12. H.W. Lenstra, Jr., On Artin’s conjecture and Euclid’ algorithm in global
ﬁelds, Inventiones math., 42 (1977), 201–224.
13. K. Masima, On the distribution of units in the residue class ﬁeld of real
quadratic ﬁelds and Artin’s conjecture (in Japanese), RIMS Kokyuroku, 1026
(1998), 156–166.
14. H. Roskam, A quadratic analogue of Artin’s conjecture on primitive roots,
J. Number Theory, 81 (2000), 93–109.

97
SIGN CHANGES OF FOURIER COEFFICIENTS
AND EIGENVALUES OF CUSP FORMS
WINFRIED KOHNEN
Universit¨at Heidelberg, Mathematisches Institut,
INF 288, D-69120 Heidelberg, Germany
E-mail: winfried@mathi.uni-heidelberg.de
We give a survey about recent results on sign changes of Fourier coeﬃcients
and eigenvalues of cusp forms, both in the elliptic case and in the case of Siegel
modular forms.
1. Introduction
Fourier coeﬃcients of elliptic cusp forms are mysterious objects and in
general no simple arithmetical formulas are known for them. If one checks
tables, one ﬁnds e.g. that quite often sign changes of those coeﬃcients occur
and it seems a natural assignment to try to understand them. For example,
one may ask if there are inﬁnitely many sign changes or when the ﬁrst sign
change occurs, or one may study sign changes in short intervals.
This might be particularly interesting when the cusp form is a normal-
ized Hecke eigenform and so the Fourier coeﬃcients are equal to the Hecke
eigenvalues.
In this article we would like to give a survey on recent results obtained
in this direction. In the last section we will also address the case of Siegel
modular forms of genus two, where the situation gets more involved.
2. The starting point
The result in the following Theorem seems to be well-known. However,
we are not able to give a precise reference where it appeared ﬁrst. As a
substitute, we refer to the joint paper with M. Knopp and W. Pribitkin [10]
for an extension to quite general subgroups of SL2(R) and a discussion of
related topics.

98
WINFRIED KOHNEN
As usual, we deﬁne
Γ0(N) :=
½µ a b
c d
¶
∈Γ1
¯¯¯¯ c ≡0
(mod N)
¾
,
where of course Γ1 := SL2(Z) denotes the full modular group.
Theorem 2.1. Let f be a non-zero cusp form of even integral weight k on
Γ0(N) and suppose that its Fourier coeﬃcients a(n) are real for all n ≥1.
Then the sequence (a(n))n∈N has inﬁnitely many sign changes, i.e. there
are inﬁnitely many n such that a(n) > 0 and there are inﬁnitely many n
such that a(n) < 0.
Proof. It is suﬃcient to assume that a(n) ≥0 for all but ﬁnitely many n
and to derive a contradiction. Let
Lf(s) =
X
n≥1
a(n)n−s,
ℜ(s) ≫1
be the Hecke L-series of f. Our assumption and a very classical result of
Landau (published in 1909) then imply that either Lf(s) converges every-
where or Lf(s) has a singularity at the real point of its line of convergence.
However, according to a classical result of Hecke, Lf(s) extends to an
entire function, and the former case occurs. Hence we conclude in particular
that a(n) ≪nc and hence also a(n)2 ≪nc for all real c. As a consequence,
the Rankin-Selberg zeta function
Rf,f(s) =
X
n≥1
a(n)2n−s,
ℜ(s) ≫1
must converge everywhere, hence is entire. This contradicts a classical result
of Rankin-Selberg according to which the latter has a pole at s = k of
residue proportional (up to a non-zero constant depending only on k and N)
to the square of the Petersson norm of f which is non-zero, since f is non-
zero. This completes the proof.
According to the above Theorem, a reasonable question to ask is if it
is possible to obtain a bound on the ﬁrst sign change, say in terms of k
and N. Of course, in general this seems to be a diﬃcult question.
If f ̸= 0, then recall that by the valence formula for modular forms
the orders of zeros of f on the compactiﬁed Riemann surface X0(N) =
Γ0(N)\H ∪P1(Q) (where H is the complex upper half-plane) sum up to
k
12[Γ1 : Γ0(N)]. Hence there must exist a number n in the range
1 ≤n ≤k
12[Γ1 : Γ0(N)]

SIGN CHANGES OF FOURIER COEFFICIENTS AND EIGENVALUES OF CUSP FORMS
99
such that a(n) ̸= 0. Therefore being optimistic, one might hope for a sign
change in the range
1 ≤n ≤k
12[Γ1 : Γ0(N)] + 1.
In a very special case, this indeed follows from work of Siegel [18]. To
formulate the result, suppose that k ≥4 is even and denote by dk the
dimension of the space Mk(Γ1) of modular forms of weight k on Γ1. Recall
that dk is given by the formula
dk =



[ k
12]
if k ≡2
(mod 12),
[ k
12] + 1
otherwise.
Then Siegel showed that there are explicitly computable rational num-
bers cn (n = 0, 1, . . . , dk), depending on k, such that
dk
X
n=0
cnaf(n) = 0,
∀f ∈Mk(Γ1).
Of course, this more or less seems to follow from elementary linear algebra.
However, Siegel’s explicit formulas imply that if k ≡2 (mod 4), then all
the cn are strictly positive.
Since a cusp form of weight k on Γ1 is determined by its n-th Fourier
coeﬃcients where n runs from 1 to dk −1, we conclude immediately that if
k ≡2 (mod 4), then there must be a sign change of the a(n) in the range
1 ≤n ≤dk. Thus using the formula for dk given above, we see that the
above optimistic expectation in this special case was justiﬁed.
Unfortunately, if k ≡0 (mod 4) or if N > 1, then Siegel’s arguments
do not work any longer, and so one has to look for other devices.
3. Elliptic modular forms
In the following, we ﬁrst look at a normalized Hecke eigenform f that is
a newform of level N. Recall that “normalized” means that a(1) = 1 and
“newform” essentially means that the exact level of f is N. In this case,
the Fourier coeﬃcients are equal to the Hecke eigenvalues.
It seems that sign changes of the a(p) (where p runs through primes
only), in case f is of level 1 have been studied ﬁrst by Ram Murty [17].
The following result was obtained in joint work with J. Sengupta.

100
WINFRIED KOHNEN
Theorem 3.1 ([12]). Suppose that f is a normalized Hecke eigenform of
even integral weight k and squarefree level N that is a newform. Then one
has a(n) < 0 for some n with
n ≪kN exp
³
c
p
log N/ log log 3N
´
(log k)27,
(n, N) = 1.
Here c > 2 and the constant implied in ≪is absolute.
Note that it is reasonable to assume that (n, N) = 1, since the eigen-
values a(p) with p|N are explicitly known by Atkin-Lehner theory.
The proof of the above result uses techniques from analytic number the-
ory (e.g. Perron’s formula and a strong convexity principle) and properties
of the symmetric square L-function of f, notably the fact that the value
of the latter at s = 1 is universally bounded from below by ≫
1
log(kN), an
important result by D. Goldfeld, J. Hoﬀstein and D. Lieman [8].
Recently, the above result was improved in a joint paper with H. Iwaniec
and J. Sengupta, as follows.
Theorem 3.2 ([9]). Suppose that f is a normalized Hecke eigenform of
even integral weight k and level N (not necessarily squarefree) that is a
newform. Then one has a(n) < 0 for some n with
n ≪k
√
N · log8+ϵ(kN),
(n, N) = 1,
ϵ > 0.
Indeed, this immediately follows from Theorem 1 in [9]. The proof is
“elementary” in the sense that it completely avoids the use of the sym-
metric square L-function. Instead, the Hecke relations for the eigenvalues
are exploited. Let us be a bit more precise. One proves the following two
Propositions.
Proposition 3.1. One has
X
n≤x,(n,N)=1
λ(n) log2 ³x
n
´
≪ϵ (k2N)1/4 log2+ϵ(kN) √x,
x ≥1; ϵ > 0.
The proof follows in a standard way from the convexity principle in
combination with Perron’s formula.
Proposition 3.2. Suppose that λ(n) ≥0 for 1 ≤n ≤x, (n, N) = 1. Then
X
n≤x,(n,N)=1
λ(n) log2 ³x
n
´
≫
x
log2 x,
x ≫
√
N.

SIGN CHANGES OF FOURIER COEFFICIENTS AND EIGENVALUES OF CUSP FORMS
101
We indicate the proof in the case N = 1 (the general case, of course, is
similar). We clearly have
X
n≤x
λ(n) log2 ³x
n
´
≫
X
n≤x/2
λ(n).
We now restrict the summation to n = pℓ, where p and ℓare primes
≤
p
x/2. We then ﬁnd
X
n≤x
λ(n) log2 ³x
n
´
≫
³
X
p≤√
x/2
λ(p)
´2
−
³
X
p≤√
x/2
1
´
(since λ(pℓ) = λ(p)λ(ℓ) if p and ℓare diﬀerent and λ(p)2 = λ(p2) + 1))
≫
³
X
p≤√
x/2
1
´2
−
³
X
p≤√
x/2
1
´
(since λ(p) ≥0 in the given range)
≫
x
log2 x
(by the Prime Number Theorem).
It is easy to see that Propositions 3.1 and 3.2 imply Theorem 3.2.
Using the same ideas, but working a bit harder one can obtain in a
similar way
Theorem 3.3 ([9]). Suppose that f is a normalized Hecke eigenform of
level N (not necessarily squarefree) and even integral weight k. Then a(n) <
0 for some n with
n ≪(k2N)
29
60 ,
(n, N) = 1.
Note that the bound in Theorem 3.3 in weight aspect is better than
the one obtained by convexity, although no sub-convexity bounds for L-
functions have been used. We remark that using the recent sub-convexity
bound in the case of the full modular group
¯¯¯¯Lf
µ1
2 + it
¶¯¯¯¯ ≪ϵ (|t| + k)1/3+ϵ,
ϵ > 0,
due to Jutila and Motohashi (2006, to appear) —the proof is much more
diﬃcult and involved—, one can improve the bound in Theorem 3.3 in
weight aspect to k2/3+ϵ if N = 1.

102
WINFRIED KOHNEN
The method used in [12] can be extended in various directions. First,
one can study sign changes in short intervals.
More precisely, denote by S+
f (x) and S−
f (x) the number of positive in-
tegers n ≤x with (n, N) = 1 for which a(n) > 0 and a(n) < 0, respectively.
The following result was proved in joint work with I. Shparlinski.
Theorem 3.4 ([13]). Suppose that f is a normalized Hecke eigenform of
even integral weight k and squarefree level N that is a newform. Then there
are absolute constants η < 1 and A > 0 such that for y = xη one has
S±1
f (x + y) −S±1
f (x) > 0
whenever x ≥(kN)A.
In another way, one can generalize Theorem 3.1 and its method of proof
to arbitrary non-zero cusp forms with real Fourier coeﬃcients. The following
result was obtained in joint work with Y.J. Choie.
Theorem 3.5 ([4]). Let f be a non-zero cusp form of even integral weight
k and squarefree level N with real Fourier coeﬃcients a(n). Then there exist
n1, n2 ∈N with
n1, n2 ≪k3N 4 log10(kN) · exp
µ
c
log(N + 1)
log log(N + 2)
¶
· max{ψk(N), k2N 1/2 log16(kN)}
such that a(n1) > 0, a(n2) < 0. Here c > 0 is an absolute constant and
ψk(N) :=
Y
p|N
log(kN)
log p
.
The proof of Theorem 3.5, being a bit more technically involved, pro-
ceeds as follows. One writes f as a linear combination of a special orthogonal
basis {Fν} of Hecke eigenforms of weight k and level N and carries over
to the Rankin-Selberg zeta functions RFν,Fµ(s) estimates partially already
proved in [12] in the context of L(sym2Fν, s). To obtain ﬁnal corresponding
statements for f itself one applies Chebyshev’s inequality in conjunction
with uniform lower bounds for the Petersson scalar products ⟨Fν, Fν⟩.
The bounds obtained in this way are somewhat weaker than those
in [12], being partially due to the fact that one averages over a basis of
Hecke eigenforms and in this way some extra factors depending on k and N
are introduced. Somewhat better bounds (using similar methods) can be
obtained if one restricts to forms f, e.g. in the subspace of newforms.

SIGN CHANGES OF FOURIER COEFFICIENTS AND EIGENVALUES OF CUSP FORMS
103
We also note that in Theorem 3.1 the additional assumption (n, N) = 1
was made, since for Hecke eigenforms the eigenvalues a(p) (p a prime, p|N)
are explicitly known as already stated above. For arbitrary cusp forms,
however, it seems unnatural to enforce this condition.
4. Siegel modular forms of genus two
Let
Hg := {Z ∈Cg,g | Z = Z′, ℑ(Z) > 0}
be the Siegel upper half-space of genus g and recall that the real symplectic
group Spg(R) ⊂GL2g(R) operates on Hg by
µ A B
C D
¶
◦Z = (AZ + B)(CZ + D)−1.
Let Γg := Spg(Z) be the group of integral symplectic matrices of size
2g, also called the Siegel modular group of genus g.
Let F be a Siegel cusp form of integral weight k and genus g, i.e. F is a
complex-valued holomorphic function on Hg satisfying the transformation
law
F(M ◦Z) = det(CZ + D)kF(Z),
∀M =
µ A B
C D
¶
∈Γg
and having a Fourier expansion of the form
F(Z) =
X
T >0
a(T)e2πitr(T Z),
Z ∈Hg,
where T runs over all positive deﬁnite, symmetric half-integral matrices of
size g. For basic facts on Siegel modular forms we refer e.g. to [7].
Note that
a(T[U]) = (−1)ka(T),
∀U ∈GLg(Z)
(where GLg(Z) operates on T > 0 as above by T[U] = U ′TU). This easily
follows from the transformation formula for F applied with
M =
µU ′
0
0 U −1
¶
.
Here as usual, for a matrix U we denote by U ′ its transpose.
Using the analytic properties of the Koecher-Maass Dirichlet series at-
tached to F (cf. e.g. [11] and the literature given there) and of the Rankin-
Selberg Dirichlet zeta function attached to F (for g = 1 cf. p. 2, l. 6; cf.

104
WINFRIED KOHNEN
e.g. [2] in the general case), it should not be diﬃcult to generalize the The-
orem 2.1 to the situation here, i.e. if F has real Fourier coeﬃcients and is
not identically zero, then there should exist inﬁnitely many T > 0 (modulo
GLg(Z)) such that a(T) > 0 and there should be inﬁnitely many T > 0
(modulo GLg(Z)) such that a(T) < 0. However, we have not checked this
in detail.
Now suppose that F is an eigenfunction of all Hecke operators. Note that
eigenvalues and Fourier coeﬃcients for g > 1 are no longer “proportional”,
in any reasonable sense, and properties of the former ones in general cannot
be deduced from the other ones and conversely, in an easy way. Although the
Fourier coeﬃcients remain rather mysterious and not much is known about
them, the situation is a bit better for the eigenvalues, since the latter can
be studied with the help of representation theory and algebraic geometry.
The situation is particularly good if g = 2, the easiest case after the
elliptic case, and for the rest of this section we will stick to this case.
Thus in the following F will denote a cuspidal Hecke eigenform of
weight k and genus 2. We will denote the linear space of all cusp forms
of weight k on Γ2 by Sk(Γ2).
Recall that the spinor zeta function attached to F is given by
ZF (s) =
Y
p
ZF,p(p−s)−1,
ℜ(s) ≫1,
where
ZF,p(X) := (1 −α0,pX)(1 −α0,pα1,pX)(1 −α0,pα2,pX)(1 −α0,pα1,pα2,pX)
and where α0,p, α1,p, α2,p are “the” Satake p-parameters attached to F.
One has
X
n≥1
λnn−s = ζ(2s −2k + 4)−1ZF (s),
ℜ(s) ≫1.
Here λ(n) denotes the eigenvalue of F under the usual Hecke operator T(n)
in genus 2. The numbers λ(n) are always real.
The completed function
Z∗
F (s) = (2π)−2sΓ(s)Γ(s −k + 2)ZF (s)
has meromorphic continuation to C and is (−1)k-invariant under s 7→2k −
2 −s [1]. Moreover, Z∗
F (s) is entire if either k is odd or if k is even and F
is contained in the orthogonal complement of the Maass subspace SM
k (Γ2)
[6,16].
The Maass subspace is invariant under all Hecke operators and is Hecke
isomorphic to the space of elliptic cusp forms of weight 2k −2 on Γ1. More

SIGN CHANGES OF FOURIER COEFFICIENTS AND EIGENVALUES OF CUSP FORMS
105
precisely, for a Hecke eigenform F in SM
k (Γ2) there is a uniquely determined
normalized cuspidal Hecke eigenform of weight 2k −2 on Γ1 such that the
relation
ZF (s) = ζ(s −k + 1)ζ(s −k + 2)Lf(s)
holds [5].
As a ﬁrst surprise, it is not generally true that the eigenvalues of a
Hecke eigenform in Sk(Γ2) change signs inﬁnitely often. More precisely, S.
Breulmann proved the following
Theorem 4.1 ([3]). Suppose that k is even and let F be a Hecke eigenform
in SM
k (Γ2), with eigenvalues λ(n) (n ∈N). Then λ(n) > 0 for all n.
The proof exploits the relation between the λ(n) and the eigenvalues of
the form f corresponding to F, as stated above in terms of a relation of
zeta functions, together with the fact that the latter satisfy Deligne’s the-
orem, previously known as the Ramanujan-Petersson conjecture (actually,
a simpler estimate is suﬃcient).
On the contrary to the above, one has the following
Theorem 4.2 ([15]). Let F be a Hecke eigenform in Sk(Γ2) with Hecke
eigenvalues λn (n ∈N). Suppose that F lies in the orthogonal complement
of SM
k (Γ2) if k is even. Then the sequence (λn)n∈N has inﬁnitely many sign
changes.
The proof is based on Landau’s theorem coupled with the analytic prop-
erties of the spinor zeta function of F and a theorem of Weissauer [19] ac-
cording to which the generalized Ramanujan-Petersson conjecture (saying
that |α1,p| = |α2,p| = 1 for all p) is true for forms as in Theorem 4.2.
Of course, after Theorem 4.2 the question arises when the ﬁrst sign
change occurs. In this respect, very recent joint work with J. Sengupta says
the following.
Theorem 4.3 ([14]). Let F be a Siegel-Hecke eigenform in Sk(Γ2) and
suppose either that k is odd or that k is even and F is in the orthogonal
complement of SM
k (Γ2). Denote by λ(n) (n ∈N) the eigenvalues of F. Then
there exists n ∈N with
n ≪k2 log20 k
such that λ(n) < 0. Here the constant implied in ≪is absolute.

106
WINFRIED KOHNEN
The proof follows a similar pattern as that of Theorem 3.2, with the
Hecke L-function Lf(s) replaced by the spinor zeta function. However, since
the Hecke relations for λ(n) are more involved in genus 2 than in the elliptic
case, exploiting them naturally turns out to be more diﬃcult. One also
makes use of the result of [19].
References
1. A.N. Andrianov, Euler products corresponding to Siegel modular forms of
genus 2, Russ. Math. Surv., 29 (1974), 45–116.
2. S. B¨ocherer and S. Raghavan, On Fourier coeﬃcients of Siegel modular forms,
J. Reine Angew. Math., 384 (1988), 80–101.
3. S. Breulmann, On Hecke eigenforms in the Maass space, Math. Z., 232(3)
(1999), 527–530.
4. Y.J. Choie and W. Kohnen, The ﬁrst sign change of Fourier coeﬃcients of
cusp forms. Preprint 2006.
5. M. Eichler and D. Zagier, The theory of Jacobi forms, Progress in Math., 55
(1985), Birh¨auser: Boston.
6. S.A. Evdokimov, A characterization of the Maass space of Siegel cusp forms
of genus 2 (in Russian), Mat. Sbornik, (154)112 (1980), 133–142.
7. E. Freitag, Siegelsche Modulformen, Grundl. d. Math. Wiss., 254 (1983).
Springer: Berlin Heidelberg New York.
8. J. Hoﬀstein and P. Lockart, Coeﬃcients of Maass forms and the Siegel zero
(with an appendix by D. Goldfeld, J. Hoﬀstein and D. Lieman), Ann. of
Math., 140 (1994), 161–180.
9. H. Iwaniec, W. Kohnen and J. Sengupta, The ﬁrst negative Hecke eigenvalue.
To appear in Intern. J. Number Theory.
10. M. Knopp, W. Kohnen and W. Pribitkin, On the signs of Fourier coeﬃcients
of cusp forms, The Ramanujan Journal., 7 (2003), 269–277.
11. W. Kohnen and J. Sengupta, On Koecher-Maass series of Siegel modular
forms, Math. Z., 242 (2002), 149–157.
12. W. Kohnen and J. Sengupta, On the ﬁrst sign change of Hecke eigenvalues
of newforms, Math. Z., 254 (2006), 173–184.
13. W. Kohnen and I. Shparlinski, On the number of sign changes of Hecke
eigenvalues of newforms. To appear in J. Austral. Math. Soc..
14. W. Kohnen and J. Sengupta, The ﬁrst negative Hecke eigenvalue of a Siegel
cusp form of genus two. To appear in Acta Arithm..
15. W. Kohnen, Sign changes of Hecke eigenvalues of Siegel cusp forms of genus
two, To appear in Proc. AMS.
16. T. Oda, On the poles of Andrianov L-functions, Math. Ann., 256 (1981),
323–340.
17. Ram Murty, Oscillations of Fourier coeﬃcients of modular forms, Math. Ann.,
(4)262 (1983), 431–446.
18. C.L. Siegel, Berechnung von Zetafunktionen an ganzzahligen Stellen, Nachr.
Akad. Wiss. G¨ottingen Math.-Phys. Kl. II, (1969), 87–102.

SIGN CHANGES OF FOURIER COEFFICIENTS AND EIGENVALUES OF CUSP FORMS
107
19. R. Weissauer, The Ramanujan conjecture for genus 2 Siegel modular forms
(an application of the trace formula). Preprint, Mannheim 1993.

108
SHIFTED CONVOLUTION SUMS OF
FOURIER COEFFICIENTS OF CUSP FORMS
YUK-KAM LAU
Department of Mathematics, The University of Hong Kong,
Pokfulam Road, Hong Kong
E-mail: yklau@maths.hku.hk
JIANYA LIU∗
School of Mathematics and System Sciences, Shandong University,
Jinan, Shandong 250100, China
E-mail: jyliu@sdu.edu.cn
YANGBO YE†
Department of Mathematics, The University of Iowa,
Iowa City, IA 52242-1419, U.S.A.
E-mail: yey@math.uiowa.edu
Let g be a holomorphic Hecke eigenform for Γ0(N) of weight l, or a Maass
eigenform for Γ0(N) with Laplace eigenvalue 1/4 + l2. Let λg(n) be the nth
Fourier coeﬃcient of g. A shifted convolution sum of λg(n) is a sum of the form
P
n λg(n)λg(n + h)w(n), where h is a nonzero integer, and w a nice weight
function. These shifted convolution sums play a crucial role in analytic number
theory, and in particular, in subconvexity bound problems of automorphic L-
functions. This article will survey historical developments and recent progress
on estimation and analytic continuation of a type of shifted convolution sums.
The techniques to be used include spectral decomposition using Poincar´e series,
a special choice of an orthonormal basis of Hecke eigenforms, a classical result
of Good and its generalization by Kr¨otz and Stanton, and a spectral large sieve.
The shifted convolution sum will be meromorphically continued to ℜs > −1/2,
passing through all poles from Laplace eigenvalues.
∗Supported in part by the 973 Program, by NSFC Grant # 10531060, and by a Ministry
of Education Major Grant Program in Sciences and Technology # 305009.
†Supported in part by the USA National Security Agency under Grant Number H98230-
06-1-0075. The United States Government is authorized to reproduce and distribute
reprints notwithstanding any copyright notation herein.

SHIFTED CONVOLUTION SUMS OF FOURIER COEFFICIENTS OF CUSP FORMS
109
1. Automorphic L-functions and subconvexity problems
1.1. The classical case: the Riemann zeta-function and
Dirichlet L-functions
In his 1859 memoir, Riemann introduced the approach of using an analytic
object — Riemann zeta-function — to study the arithmetic problem of dis-
tribution of primes. Nowadays this approach has been exploited in various
scopes with fruitful results. The associated artiﬁcial analytic objects are
known as L-functions. They are functions deﬁned on the complex plane
under analytic/meromorphic continuation, sharing common features and
conjectures with the Riemann zeta-function.
There are two important open conjectures for L-functions: Generalized
Riemann Hypothesis (GRH) and Generalized Lindel¨of Hypothesis (GLH).
The former concerns the location of nontrivial zeros and the latter is about
the size of an L-function on the critical line ℜs = 1/2. By standard complex
analysis, it is seen that GLH follows from GRH. Though being weaker,
progress towards GLH is rather slow, even for the Riemann zeta-function
ζ(s). In the case of ζ(s), GLH is the assertion α = 0 in the order estimate
ζ(1/2 + it) ≪ε |t|α+ε
for |t| ≥1.
(1.1)
The upper estimate (1.1) holds true for α = 1/4 by the Phragm´en–
Lindel¨of convexity principle, a robust method in complex analysis. The
record to date is α = 32/205 due to Huxley [14], but it is still far from the
anticipation in GLH. Amazingly, Weyl was able to show α = 1/6 about
eighty years ago. Note that 32/205 = 1/6 −13/1230. The progress mean-
while is small, and it seems that a kind of obstruction at Weyl’s bound is
present. Below, we shall ﬁnd such an obstruction occurred in other cases.
The method of convexity principle applies well to other L-functions.
Naturally, the bound resulted from this principle is called a convexity
bound, and we refer any improvement (usually on the exponent of the con-
vexity bound) as a subconvexity bound. Besides, we call a bound Weyl-like
if it is the 2/3-th power of the convexity bound up to an arbitrarily small
ε > 0. For instance, the convexity bound of ζ(s) is |t|1/4+ε and its Weyl-like
bound is |t|1/6+ε.
The Dirichlet L-function L(s, χ) was introduced to study the primes in
an arithmetic progression. In addition to the t-aspect on the critical line
s = 1/2+it, we are interested in the aspect of conductor, that is the modulus
of the character χ. For either aspect, the exponent of the convexity bound
is 1/4. The best known exponent for t-aspect is 1/6 which is Weyl-like.
Unlike the Riemann zeta-function, nobody can break the Weyl bound so

110
YUK-KAM LAU, JIANYA LIU AND YANGBO YE
far, though it was proven quite long time ago. On the conductor aspect, the
Weyl-like bound is just achieved recently by Conrey and Iwaniec [6] for real
characters. Before this, we only have 3/16 due to Burgess [4], which also
remains the best for all characters. Both ζ(s) and L(s, χ) are L-functions of
degree one, referring to the degree of a generic polynomial factor in p−s of
their Euler product factorizations. Next, we turn to higher degree examples.
1.2. L-functions of degree two
The L-function associated to a holomorphic Hecke eigenform or Hecke
Maass eigenform is a typical example of degree two. Let Γ0(N) be the
congruence subgroup that contains matrices in SL2(Z) whose lower left en-
try is a multiple of N. The upper half plane H is identiﬁed with G/K
where G = GL(2, R) and K = O(2, R) and hence the quotient space
Γ0(N) \ H ∼= Γ0(N) \ G/K. But instead, we consider the space Γ0(N) \ G
which is regarded as the unit tangent bundle of Γ0(N) \ H. The Haar mea-
sure on Γ0(N) \ G is descended from
dg = dxdy
y2
dϕ
2π ,
where an element g ∈G is expressed via Iwasawa decomposition as
g =
µ1 x
1
¶ µy1/2
y−1/2
¶ µ cos ϕ sin ϕ
−sin ϕ cos ϕ
¶
,
mapped under the natural projection to z = x + iy ∈H. Consider the
Laplace operator
e∆= −y2
µ ∂2
∂x2 + ∂2
∂y2
¶
+ y
∂2
∂x∂ϕ
on the Hilbert space L2(Γ0(N) \ G). A Maass eigenform with eigenvalue
1/4 + k2 is a square-integrable K-invariant eigenfunction of e∆with eigen-
value 1/4 + k2. A holomorphic cusp form of weight k is a holomorphic
function f on H such that the function in L2(Γ0(N) \ G) corresponding
to yk/2f(z)eikϕ is an eigenfunction of e∆with eigenvalue (k/2)(k/2 −1).
When these forms are invariant under the Hecke operators Tn with n ≥1,
we call them Hecke Maass eigenforms and holomorphic Hecke eigenforms,
respectively. Their associated L-functions will involve three parameters t, k
and N, and the convexity bound is
(|t| + k)1/2N 1/4(|t|kN)ε.

SHIFTED CONVOLUTION SUMS OF FOURIER COEFFICIENTS OF CUSP FORMS
111
The current best subconvexity bounds are accordingly |t|1/3+ε by Good [11]
and Meurman [28], k1/3+ε by Peng [31] and Ivi´c [15], and N 1/6+ε for certain
forms by Conrey and Iwaniec [6]. Amazingly, all of them are only Weyl-like,
that is, no further advance is achieved for L-functions of degree two. Perhaps
there is a barrier behind which we can break through merely in the very
special case of ζ(s).
1.3. Rankin-Selberg L-functions
The subconvexity problem of L-functions of degree ≥3 is mostly unsolved.
One accessible case is the Rankin-Selberg L-function which is of degree 4.
Let f be a holomorphic Hecke eigenform for Γ0(N) of weight k or Hecke
Maass eigenform with eigenvalue 1/4 + k2. Suppose g a ﬁxed holomorphic
or Maass cusp form of weight l or eigenvalue 1/4 + l2 and level D. The
Rankin-Selberg L-function L(s, f × g) satisﬁes the convexity bound
L(1/2 + it, f × g) ≪
¡
ND(|t| + k + l)(|t| + |k −l|)
¢1/2+ε.
(1.2)
We ﬁx the level N, the form g, and t, and study the subconvexity estimate
of L(1/2 + it, f × g) in the k-aspect. Thus, we are seeking bounds like
L(1/2 + it, f × g) ≪N,g,t,ε kβ+ε
(1.3)
for some 0 ≤β < 1.
This was ﬁrstly achieved by Sarnak [34] for holomorphic f, and by Liu
and Ye [25,26] for f being Maass. Progress in this direction is summarized
in the following table. Throughout the paper, θ denotes a bound towards
the Generalized Ramanujan Conjecture (GRC) for GL2, for which θ = 1/2
is trivial, and the best bound known to date is θ = 7/64 due to Kim and
Sarnak [20]. GRC actually predicts that θ = 0.
β
author(s)
the shifted convolution sum
is treated by
18
19−2θ
Sarnak [34]
spectral method
15+2θ
16
Liu and Ye [25,26]
spectral method
6−2θ
7−4θ
Blomer [2]
circle method
1 −
1
8+4θ
Lau, Liu, and Ye [23]
spectral method
2
3
Lau, Liu, and Ye [24]
spectral method
2
3
Jutila and Motohashi [19]
spectral method

112
YUK-KAM LAU, JIANYA LIU AND YANGBO YE
The Weyl-like bound achieved in [24] is as follows.
Theorem 1.1. Let f be a holomorphic Hecke eigenform for Γ0(N) of
weight k, or a Maass Hecke eigenform for Γ0(N) with Laplace eigenvalue
1/4 + k2, and correspondingly let g be a ﬁxed holomorphic or Maass cusp
form for Γ0(N), or for Γ0(N ′) with (N, N ′) = 1. Then, for any small ε > 0,
L(1/2 + it, f × g) ≪N,t,g,ε k2/3+ε,
(1.4)
where the implied constant grows at most polynomially in t and N, with the
degree of the polynomial growth depending on ε.
The same bound is obtained by Jutila and Motohashi [19] but for the
full modular group SL2(Z). The result in [19] also provides a subconvexity
bound in the t-aspect, when |t| is suitably smaller than k. For the Rankin-
Selberg L-function in question, the Weyl-like bound is only attained in the
weight/spectral amongst the various aspects. The subconvexity bound is
available on the level aspect N, see [29] and [13], but remains unsettled on
t-aspect.
1.4. Plan of the article
In this article, we try to give some historical developments and recent
progress on estimation and analytic continuation of a type of shifted convo-
lution sums, and indicate some of their applications to subconvexity bounds
for automorphic L-functions. In view of the huge amount of materials in
these areas at hand, we will mainly mention applications to the Rankin-
Selberg L-function L(s, f × g) in the weight/spectral aspect.
§2 presents some fundamentals of the shifted convolution sums. Basi-
cally, there are two methods to treat the shifted convolution sums, the circle
method, and the spectral method. In §3, we describe two variants of the
circle method, and their consequences in subconvexity bounds L(s, f × g).
§§4–6 are devoted to the spectral method and its recent developments.
The materials are organized not always in historical order, but in logical
order. For example, some results in §§4–6 are actually obtained earlier then
those in §3.
1.5. Notations
As usual, τ(n), ϕ(n) denote, respectively, the divisor function and the Euler
quotient function. For z ∈C, ℜz and ℑz denote, respectively, the real and
imaginary part of z. Following Riemann, for the speciﬁc complex variable s,

SHIFTED CONVOLUTION SUMS OF FOURIER COEFFICIENTS OF CUSP FORMS
113
we write ℜs = σ and ℑs = t; thus s = σ +it. The symbol A ≍B represents
both A ≪B and B ≪A, and e(x) = e2πix.
2. Shifted convolution sums
2.1. Spectral theory of automorphic forms
In 1949, Maass [27] introduced the Γ-invariant eigenfunctions of the non-
Euclidean Laplacian on H, which are now understood to be the basic ele-
ments in the harmonic analysis of Γ \ H with Γ being a discrete subgroup
of SL2(R). To see the importance, one should recall that the Fourier series
expansion is a kind of spectral decomposition in harmonic analysis of the
Euclidean plane R2. More speciﬁcally, consider the group G = R2 acting
on the plane R2 as translations, then the G-invariant eigenfunctions of the
Euclidean Laplacian are exponential functions e(mx + ny) with eigenval-
ues 4π2(m2 + n2), where m, n ∈Z. In 1950s, Selberg wrote a couple of
inﬂuential papers on harmonic analysis and discontinuous groups. In par-
ticular, he founded harmonic analysis for weakly symmetric Riemannian
spaces and the Selberg trace formula generalizing the Poisson summation
formula. Around the same time, there appeared important intimate works
devoted by other writers.
The upper half plane H equipped with the hyperbolic metric is a Rie-
mannian manifold. As the metric is invariant under SL2(Z) and hence un-
der Γ, one may look for a spectral decomposition with Γ-invariant eigen-
functions of the Laplacian associated to the hyperbolic manifold. Such de-
composition is possible by virtue of the theory of unbounded self-adjoint
operators in Hilbert spaces. However, as Γ may not be cocompact (for ex-
ample, the congruence subgroups), the Γ-invariant eigenfunctions for the
discrete spectrum/eigenvalues, called Maass cusp forms, are not suﬃcient
for complete spectral decomposition. One needs to include Eisenstein series,
for the continuous spectrum, in the spectral decomposition. The spectral
theory is interesting on its own. For instance, the trace formula developed by
Selberg yields the Weyl’s law on the discrete spectrum for congruence sub-
groups. Consequently it guarantees the existence of inﬁnitely many Maass
cusp forms. It is worthy of remarking that the existence problem of Maass
cusp forms for general discrete subgroups remains open; the answer is likely
to be negative due to the work of Phillips and Sarnak [32].

114
YUK-KAM LAU, JIANYA LIU AND YANGBO YE
2.2. The Rankin-Selberg method and shifted convolution
sums
One major topic in modular forms is the study of their Fourier coeﬃcients.
Rankin and Selberg independently established a method, nowadays called
the Rankin-Selberg method, based on the integral
Z
Γ\H
ylg(z)g(z)E(z, s) dµ(z),
where Γ \ H is the fundamental domain of Γ, g is a modular form of even
integral weight l for Γ and
E(z, s) =
X
γ∈Γ∞\Γ
ℑ(γz)s
is an Eisenstein series, and σ > 1. It is well known that g(z) admits a
Fourier expansion,
g(z) =
X
n≥1
ag(n)e(nz).
(2.1)
By the invariance under Γ, the integral is unfolded to give
Z
Γ\H
ylg(z)g(z)E(z, s) dµ(z) =
Z
Γ∞\H
yl+s|g(z)|2 dµ(z)
(2.2)
= G(s)Dg(s),
where G(s) is a product of some Gamma factors, and
Dg(s) =
X
n≥1
|ag(n)|2
ns
.
A classical method with Perron’s formula will yield an asymptotic formula
for the summatory function
X
n≤x
|ag(n)|2
from Dg(s), provided that Dg(s) can be analytically continued to the left
beyond σ = 1. With the available information on E(z, s), Dg(s) is meromor-
phically continued to the whole complex plane, and is regular on σ ≥1/2
except for a ﬁnite number of poles lying on the segment 1/2 < s ≤1. This
is the basic principle of the Rankin-Selberg method.
Prior to the works of Rankin and Selberg, Petersson developed an ex-
plicit formula, namely the Petersson trace formula, for the Fourier coef-
ﬁcients of a modular form. This formula involves the Kloosterman sum

SHIFTED CONVOLUTION SUMS OF FOURIER COEFFICIENTS OF CUSP FORMS
115
S(m, n, c) and Bessel functions, and is derived from the Poincar´e series
Pm(z, s) =
X
γ∈Γ∞\Γ
ℑ(γz)se(mγz).
Apparently a good understanding of the Kloosterman sum will result in
better knowledge on the Fourier coeﬃcients. To this end, Selberg [35] in-
vestigated the series
Z(s, m, n) =
X
c≥1
S(m, n, c)
c2s
,
which is a crucial component in the Fourier coeﬃcient of Pm(z, s). His
method is to give Pm(z, s) a spectral decomposition, regarding Pm(·, s) as
a function in L2(Γ \ H). By the aforementioned spectral theory, Pm(·, s) is
a linear combination a series of Maass cusp forms and spectral integrals of
Eisenstein series. The coeﬃcients of the discrete part, i.e. the series of Maass
cusp forms, are products of gamma functions, which amount to the analytic
properties of the function Pm(z, s) in s. The continuous part is similar but,
for simplicity, will not be further discussed here. As a result, Pm(z, s) is
regular for σ > 1/2 except possibly for a ﬁnite number of simple poles on
(1/2, 1]. Replacing the Eisenstein series E(z, s) in (2.2) by a Poincare series
Pm(z, s), the two methods can be combined to study the shifted convolution
sum
X
n≥1
ag(n)ag(n + h)
(n + h/2)s
.
This idea was pointed out by Selberg in the last section of [35], but at that
time, he did not ﬁnd an application for this shifted convolution sum.
During the past decades, the uses of the shifted convolution sum came
up in the study of L-functions. Indeed for the classical example of degree
one - the Riemann zeta-function ζ(s), the investigation of its fourth moment
already leads naturally to the shifted convolution sum for the divisor func-
tion d(n), which was considered by Heath-Brown [7]. One needs to handle
this or similar type of sums for higher degree automorphic L-functions.
3. Variants of the circle method
Let g be a holomorphic Hecke eigenform for Γ0(N) of even weight l or Hecke
Maass eigenform with eigenvalue 1/4 + l2. Then g admits the following
Fourier expansions:
g(z) =
X
n≥1
λg(n)n(l−1)/2e(nz)
(3.1)

116
YUK-KAM LAU, JIANYA LIU AND YANGBO YE
when g is holomorphic, and
g(z) = y1/2 X
n̸=0
λg(n)Kil(2π|n|y)e(nx)
(3.2)
when g is Maass, where Kil is the modiﬁed Bessel function of the third kind,
and z = x + iy. We normalize λg(1) = 1 in (3.1) and (3.2). In this section,
we describe variants of the circle method to treat the shifted convolution
sums like
Dg(ν1, ν2, h) =
X
ν1m−ν2n=h
λg(m)λg(n)W(m, n)
(3.3)
uniformly in positive integers ν1, ν2, h, where W : R × R →R is a nice test
function. For example, one may suppose that W is smooth, supported on
[M1, 2M1] × [M2, 2M2], and satisﬁes
∥W (ij)∥∞≪i,j M −i
1 M −j
2
for all i ≥0, j ≥0,
(3.4)
where M1, M2 are real numbers greater than 1.
3.1. The δ-symbol method
To attack Dg(ν1, ν2, h) in (3.3), Duke, Friedlander, and Iwaniec [9,10] de-
veloped the δ-symbol method, which can be viewed as a variant of the circle
method. This δ-symbol method has also been used in many occasions; see
for example the DFI paper series, Kowalski, Michel, and Vanderkam [21],
and Michel [29]. The following description is based on [9] and Michel [30].
Let
δ(n) =
½1
if n = 0,
0
if n ̸= 0,
(3.5)
be the Dirac symbol at 0 restricted to integers n; the basic idea of the
δ-symbol method is to express δ(n) in terms of additive characters. One
starts with a smooth, compactly supported, even function ω(x) with
ω(0) = 0,
X
r≥1
ω(r) = 1.
Put
δd(n) = ω(d) −ω
³n
d
´
;
then we have
δ(n) =
X
d|n
δd(n).

SHIFTED CONVOLUTION SUMS OF FOURIER COEFFICIENTS OF CUSP FORMS
117
Now the condition d|n can be detected by additive characters. Thus,
δ(n) =
X
d≥1
1
d
X
h mod d
e
µhn
d
¶
δd(n)
=
X
c≥1
1
c
X
a mod c
∗
e
³an
c
´
∆c(n),
(3.6)
where r = (h, d), a = h/r, c = d/r, and
∆c(n) =
X
r≥1
1
r δcr(n).
In practice, one applies the above identity to integers |n| < U/2, say,
with the text function ω(x) supported on [K/2, K] and whose derivative
satisfy
∥ω(j)∥∞≪K−j−1
for all j ≥0.
Then δd(n) vanishes save for 1 ≤d < max(K, U/K) = K by choosing
K = U 1/2. Hence ∆c(n) vanishes save for 1 ≤c < K and ∆c(n) ≪K−1.
Now applying (3.6) to the Dirac symbol δ(ν1m −ν2n −h) in (3.3), one
therefore gets rid of the condition ν1m−ν2n−h = 0. For technical reasons,
one introduces a localization factor φ(ν1x−ν2y −h) in Dg(ν1, ν2, h), where
φ is a smooth function compactly supported on [−U/2, U/2], satisfying
φ(0) = 1 and
∥φ(j)∥∞≪U −j
for all j ≥0.
Hence
Dg(ν1, ν2, h) =
X
1≤c≤K
X
a mod c
∗
e
µ
−ah
c
¶ X
m,n
λg(m)λg(n)
(3.7)
× e
µν1ma −ν2na
c
¶
Ec(m, n, h),
where
Ec(x, y, h) = W(x, y)φ(ν1x −ν2y −h)1
c ∆c(ν1x −ν2y −h).
It turns out that the derivatives of Ec(x, y, h) are well controlled; in fact
∥E(ij)
c
∥∞≪i,j
1
(cK + |ν1x −ν2y −h|)
νi
1νj
2
min(M1, M2)i+j
µK
c
¶i+j
.
(3.8)

118
YUK-KAM LAU, JIANYA LIU AND YANGBO YE
Next one applies the Voronoi summation formula to both variables m and n,
and the shifted convolution sum in question is transformed to
Dg(ν1, ν2, h) =
X
c≤K
(ν1ν2, c)
c2
X
m,n
λg(m)λg(n)S(−ν′
1m + ν′
2n, −h, c)
× Ic(m, n, h),
(3.9)
where S(a, b, c) is the classical Kloosterman sum, and
Ic(m, n, h) =(2πik)2
Z ∞
0
Z ∞
0
Ec(x, y, h)Jk−1
µ 4π√mx
c/(ν1, c)
¶
× Jk−1
µ 4π√ny
c/(ν2, c)
¶
dxdy
(3.10)
with ν′
j = νj/(νj, c). Integrating the Bessel functions in (3.10) by parts
many times, one shows that Ic(m, n, h) is very small unless m and n lie in
certain short ranges, and one can therefore restrict the summations of m
and n in (3.9) to these short ranges. Applying Weil’s bound for Kloosterman
sums
|S(a, b, r)| ≤τ(r)
p
(a, b, r)r,
one gets the following result.
Theorem 3.1. Let g be a holomorphic cusp form for Γ0(N) of even
weight l, or a Maass cusp form for Γ0(N) with eigenvalue 1/4 + l2. Then
Dg(ν1, ν2, h) ≪N,l,ε (ν1M1 + ν2M2)3/4+ε.
(3.11)
This is proved by Duke, Friedlander, and Iwaniec [9] for the full modu-
lar group, and by Kowalski, Michel, and Vanderkam [21] for Γ0(N). From
Theorem 3.1, one can get a subconvexity bound for L(1/2 + it, f × g).
Theorem 3.2. Let f be a holomorphic Hecke eigenform for Γ0(N) of
weight k, or a Maass Hecke eigenform for Γ0(N) with Laplace eigenvalue
1/4 + k2, and let g be a ﬁxed holomorphic or Maass cusp form for Γ0(N),
or for Γ0(N ′) with (N, N ′) = 1. Then
L(1/2 + it, f × g) ≪N,t,g,ε k11/12+ε.
(3.12)
Theorem 3.2 does not appear in literatures. However it can be compared
with Iwaniec’s bound k5/12+ε for single automorphic L-functions [16].

SHIFTED CONVOLUTION SUMS OF FOURIER COEFFICIENTS OF CUSP FORMS
119
3.2. Jutila’s variant
Let a′/q′ < a/q < a′′/q′′ be three consecutive Farey fractions with denom-
inators ≤Q, and
M
µa
q
¶
=
µa + a′
q + q′ , a + a′′
q + q′′
¸
.
Then (0, 1] is a disjoint union of these M(a/q),
(0, 1] =
G
q≤Q
G
a mod q
∗
M
µa
q
¶
.
Let δ(n) function deﬁned as in (3.5). Then the circle method of Hardy and
Littlewood actually starts with the following decomposition of the δ(n):
δ(n) =
X
q≤Q
X
a mod q
∗Z
M(a/q)
e(nα)dα.
(3.13)
Note that the length of the M(a/q) depends on a and q, and therefore in
general one cannot invert the order of the summation and the integration
above. This is known as the leveling problem.
Jutila introduced another variant of the circle method in [17] and [18]
to attack this leveling problem. This variant has also been used in many
occasions like Harcos [12], Harcos and Michel [13], Blomer [1,2], and Blomer,
Harcos, and Michel [3].
Theorem 3.3. Let Q ≥1 and Q−2 ≤δ ≤Q−1 be two parameters. Let ω
be a non-negative function supported in [Q, 2Q] satisfying
∥ω∥∞≤1,
X
ω(q) > 0.
For r ∈Q, let Ir(α) be the characteristic function of the interval [r−δ, r+δ],
and deﬁne
Λ =
X
q
ω(q)ϕ(q),
˜I(α) =
1
2δΛ
X
q
ω(q)
X
d mod q
∗
Id/q(α).
Then ˜I(α) is a good approximation to the characteristic function of [0, 1]
in the sense that
Z 1
0
|1 −˜I(α)|2dα ≪ε
Q2+ε
δΛ2 .
(3.14)

120
YUK-KAM LAU, JIANYA LIU AND YANGBO YE
To transform the sum in question by Jutila’s variant of the circle
method, we let Q > Nν1ν2, and δ = Q−1. Let ˜ω be a function supported
in [Q, 2Q] satisfying
∥˜ω∥∞≍Q−j
for all j ≥0,
and let
ω(q) = ˜ω(q)χ[Nν1ν2|q](q),
where χ[Nν1ν2|q](q) is the characteristic function of Nν1ν2|q. Then
Λ ≍
Q2
Nν1ν2
.
For simplicity, put
T(α) =
X
m,n
λg(m)λg(n)e(ν1mα)e(−ν2nα)W(m, n).
Then the shifted convolution sum in (3.3) can be written as
Dg(ν1, ν2, h) =
Z 1
0
T(α)e(−αh)dα
=
Z 1
0
˜I(α)T(α)e(−αh)dα +
Z 1
0
(1 −˜I(α))T(α)e(−αh)dα
=: Dmt + Det,
(3.15)
say. The error term Det is, by Cauchy’s inequality and Theorem 3.3,
Det ≪∥1 −˜I∥2 · ∥T∥2
≪Q1+ε
δ1/2Λ max
α1,α2
¯¯¯¯¯
X
m,n
λg(m)λg(n)e(α1m)e(−α2n)W(m, n)
¯¯¯¯¯ .
(3.16)
And this last quantity is acceptable by applying the estimate
X
n≤x
λg(n)e(mα) ≪ε Nk5/4x1/2(Nkx)ε
uniformly in α. This is due to Wilton, but the explicit dependence on N
and k is shown in [13].
The main term Dmt in (3.15) can be computed as
Dmt =
1
2δΛ
X
Nν1ν2|q
˜ω(q)
×
X
d mod q
∗Z δ
−δ
T
µd
q + η
¶
e
µ
−h
µd
q + η
¶¶
dη.
(3.17)

SHIFTED CONVOLUTION SUMS OF FOURIER COEFFICIENTS OF CUSP FORMS
121
Applying Voronoi’s summation formula, we ﬁnd that the double sums over
m, n in (3.17) is for Nν1ν2|q,
T
µd
q + η
¶
=
X
m,n
λg(m)λg(n)e
µ ¯d(ν2n −ν1m)
q
¶
ω∗
q,ν1,ν2,η(m, n), (3.18)
where
ω∗
q,ν1,ν2,η(x1, x2) = 4π2ν1ν2
q2
Z ∞
0
Z ∞
0
W(t1, t2)e(ν1t1η −ν2t2η)
×Jk−1
µ4πν1
√x1t1
q
¶
Jk−1
µ4πν2
√x2t2
q
¶
dt1dt2.
Inserting (3.18) into (3.17), we get
X
Nν1ν2|q
X
d mod q
∗Z δ
−δ
T
µd
q + η
¶
e
µ
−h
µd
q + η
¶¶
dη
=
Z δ
−δ
e(−ηh)
X
Nν1ν2|q
˜ω(q)
×
X
m,n
S(−h, ν2n −ν1m, q)λg(m)λg(n)ω∗
q,ν1,ν2,η(m, n)dη
= :
Z δ
−δ
e(−ηh)
X
Nν1ν2|q
˜ω(q)Y (m, n)dη,
(3.19)
say. This is where interchange of orders is needed, and this is guaranteed
by the fact that the length of the intervals [−δ, δ] is independent of the
variables. The quantity Y (m, n) above can be transformed as
Y (m, n) =
X
r∈Z
S(−h, r, q)
X
ν2n−ν1m=r
λg(m)λg(n)ω∗
q,ν1,ν2,η(m, n),
which is similar to the inner sums in (3.9). Arguing similarly, and invoking
the spectral large sieve inequality, one gets
Theorem 3.4. Let g be a holomorphic cusp form for Γ0(N) of even
weight l, or a Maass cusp form for Γ0(N) with eigenvalue 1/4 + l2. Then
Dg(ν1, ν2, h) ≪N,l,ε (ν1M1 + ν2M2)1/2+θ+ε.
(3.20)
The estimate above leads to a subconvexity bound for Rankin-Selberg
L-functions.
Theorem 3.5. Let f be a holomorphic Hecke eigenform for Γ0(N) of
weight k, or a Maass Hecke eigenform for Γ0(N) with Laplace eigenvalue

122
YUK-KAM LAU, JIANYA LIU AND YANGBO YE
1/4 + k2, and correspondingly let g be a ﬁxed holomorphic or Maass cusp
form for Γ0(N), or for Γ0(N ′) with (N, N ′) = 1. Then for any small ε > 0,
we have
L(1/2 + it, f × g) ≪N,t,g,ε k(6−2θ)/(7−4θ)+ε.
(3.21)
Theorems 3.4 and 3.5 are proved by Blomer [1,2].
4. The spectral method
In 2001, Sarnak [34] considered the subconvexity problem for Rankin-
Selberg L-functions associated to two cusp forms with one varying weight
and one ﬁxed weight, in which the shifted convolution sum for the cusp
form of ﬁxed weight came into play. Sarnak applied Selberg’s approach but
made a modiﬁcation of replacing Pm(z, s) by
Uh(z, s) =
X
γ∈Γ∞\Γ
ℑ(γz)se(−hℜ(γz)),
where h is a positive integer. This helps simplify calculations. Together
with his ingenious estimates on inner products of eigenfunctions [34], he
obtained a subconvexity estimate for the Rankin-Selberg with an applica-
tion to quantum unique ergodicity.
To explain the ideas of Sarnak [34], let ν1, ν2 be positive integers, and
h an integer. For σ > 1, we deﬁne
Dg(s, ν1, ν2, h) =
X
m,n>0
ν1m−ν2n=h
λg(n)λg(m)
µ √ν1ν2mn
ν1m + ν2n
¶l−1
× (ν1m + ν2n)−s
(4.1)
when g is a holomorphic cusp form, and
Dg(s, ν1, ν2, h) =
X
m,n̸=0
ν1m−ν2n=h
λg(n)λg(m)
Ã p
ν1ν2|mn|
ν1|m| + ν2|n|
!2il
× (ν1|m| + ν2|n|)−s
(4.2)
when g is a Maass form. To illustrate the ideas, let us consider the case of g
being a holomorphic cusp form on Γ0(N) of weight l. Write Γ = Γ0(Nν1ν2)
and
V (z) = ylg(ν1z)g(ν2z).

SHIFTED CONVOLUTION SUMS OF FOURIER COEFFICIENTS OF CUSP FORMS
123
Then V is a Γ-invariant function rapidly decreasing at the cusps of Γ, and
V ∈L2(Γ \ H). By the standard unfolding method, Dg(s, ν1, ν2, h) can be
expressed in terms of the inner product (see [34, p.444], (A7)-(A9))
Dg(s, ν1, ν2, h) = (2π)s+l−1(ν1ν2)(l−1)/2 ⟨Uh(·, s), V ⟩
Γ(s + l −1) .
(4.3)
Note that V is square-integrable on Γ\H, because it is built from a cusp
form. On the other hand, as a Poincar´e series, Uh is not square integrable
on Γ\H. However, since Γ\H is of ﬁnite volume, Parseval’s identity applies.
Therefore
⟨Uh(·, s), V ⟩=
X
j≥1
⟨Uh(·, s), φj⟩⟨V, φj⟩
+ 1
4π
X
a
Z ∞
−∞
⟨Uh(·, s), Ea(·, 1/2 + iτ)⟩
×⟨V, Ea(·, 1/2 + iτ)⟩dτ,
(4.4)
where a runs over all the cusps. Note that ⟨Uh, φ0⟩= 0. In view of (4.3), one
may investigate the right-side of (4.4) for the properties of Dg(s, ν1, ν2, h).
These inner products can be computed as follows.
Theorem 4.1. We have
⟨Uh(·, s), φj⟩= π1/2−sρj(−h)
4|h|s−1/2
Γ
µs −1/2 + itj
2
¶
Γ
µs −1/2 −itj
2
¶
,
and
⟨Uh(·, s), Ea(·, 1/2 + iτ)⟩=
π1−s−iτ
Γ(1/2 −iτ)
ρa(1/2 + iτ, −h)
2|h|s−1/2+iτ
×Γ
µs −1/2 + iτ
2
¶
Γ
µs −1/2 −iτ
2
¶
.
Recall that by the Maass-Selberg theory (see Deshouillers and Iwaniec
[8, p.227]), L2(Γ\H) admits a spectral decomposition with respect to ∆.
The spectrum of ∆consists of two components: the discrete spectrum 0 =
λ0 < λ1 ≤λ2 ≤· · · , and the continuous spectrum covering the segment
[1/4, ∞). Each eigenvalue in the discrete spectrum has ﬁnite order, and
λj →∞as j →∞. Moreover, there are two types of eigenvalues: 0 <
λj < 1/4 which are called exceptional, and λj ≥1/4. The famous Selberg
conjecture asserts that there is no exceptional eigenvalue for congruence
groups, but the currently best known result is λ1 ≥1/4 −θ2, where θ =
7/64 is the exponent of the best known bound toward the Generalized

124
YUK-KAM LAU, JIANYA LIU AND YANGBO YE
Ramanujan Conjecture for Maass forms, due to Kim and Sarnak [20]. Write
λj = sj(1 −sj) and sj = 1/2 + itj where
0 < itj ≤θ if λj is exceptional, and tj ∈[0, ∞) otherwise.
(4.5)
Theorem 4.1 with (4.5) implies immediately that each summand on the
right-side of (4.4) is holomorphic in σ > 1/2 + θ. Using the estimate of
individual ⟨V, φj⟩developed in [33], Sarnak [34, Theorem A.1] concluded
that Dg(s, ν1, ν2, h) extends to a holomorphic function on σ > 1/2 + θ and
has the following upper bound estimate.
Theorem 4.2. Let g be a holomorphic cusp form for Γ0(N) of even
weight l, or a Maass cusp form for Γ0(N) of Laplace eigenvalue 1/4 + l2.
Then Dg(s, ν1, ν2, h) extends to a holomorphic function for
σ ≥1/2 + θ + ε,
for any ε > 0. Moreover, in this region it satisﬁes
Dg(s, ν1, ν2, h) ≪N,g,ε (ν1ν2)1/2+ε|h|1/2+θ+ε−σ(1 + |t|)3 + χ(g)|h|1−σ,
where χ(g) = 0 or 1 according as g is holomorphic or Maass form.
From this, Sarnak [33] deduced the following subconvexity bound for
holomorphic Hecke eigenform f. Note that it is the ﬁrst subconvexity bound
in the k-aspect for L(1/2 + it, f × g).
Theorem 4.3. Let f be a holomorphic Hecke eigenform for Γ0(N) of
weight k, and let g be a ﬁxed holomorphic or Maass cusp form for Γ0(N),
or for Γ0(N ′) with (N, N ′) = 1. Then for any small ε > 0,
L(1/2 + it, f × g) ≪N,t,g,ε k18/(19−2θ)+ε.
(4.6)
Theorem 4.2 also enables Liu and Ye [25,26] to derive a subconvexity
bound for L(s, f × g) with Maass eigenforms f.
Theorem 4.4. Let f be a Maass Hecke eigenform for Γ0(N) with Laplace
eigenvalue 1/4 + k2, and let g be a ﬁxed holomorphic or Maass cusp form
for Γ0(N), or for Γ0(N ′) with (N, N ′) = 1. Then for any small ε > 0,
L(1/2 + it, f × g) ≪N,t,g,ε k(15+2θ)/16+ε.
(4.7)

SHIFTED CONVOLUTION SUMS OF FOURIER COEFFICIENTS OF CUSP FORMS
125
5. The spectral method: meromorphic continuation to
σ > 1/2
If we allow the occurrence of poles, Dg(s, ν1, ν2, h) can indeed be mero-
morphically continued to a wider region. According to (4.5), if we continue
Dg(s, ν1, ν2, h) to σ > 1/2, the possible poles are those at sj = 1/2 + itj,
where 0 < itj ≤θ with λj = sj(1 −sj) being exceptional Laplace eigen-
values. As predicted by the GRC, these poles should not exist. Since we
do not assume GRC, we will have to control the residues of these possible
poles.
Furthermore, we may reﬁne Sarnak’s Theorem 4.2 in the t-aspect via
the mean square estimate in Good [11] rather than the term-wise bound.
Good’s result was proved originally for holomorphic cusp forms of weight
l ≥4. In other cases, it was generalized recently by Kr¨otz and Stanton [22].
As we will see, switching from individual bound for ⟨V, φj⟩to a mean square
estimate provides a signiﬁcant saving.
In view of (4.3), (4.4), and Theorem 4.1, we introduce the following
functions
Bj(h, s) = (2π)s+l−1(ν1ν2)(l−1)/2 ⟨Uh(·, s), φj⟩
Γ(s + l −1)
= (ν1ν2)(l−1)/2 ρj(−h)
|h|s−1/2
2s+l−3πl−1/2
Γ(s + l −1)
×Γ
µs −1/2 + itj
2
¶
Γ
µs −1/2 −itj
2
¶
,
(5.1)
Ca(h, s, τ) = (2π)s+l−1(ν1ν2)(l−1)/2 ⟨Uh(·, s), Ea(·, 1/2 + iτ)⟩
Γ(s + l −1)
= (ν1ν2)(l−1)/2
ρa(1/2 + iτ, −h)
Γ(1/2 −iτ)|h|s−1/2+iτ
2s+l−2πl−iτ
Γ(s + l −1)
×Γ
µs −1/2 + iτ
2
¶
Γ
µs −1/2 −iτ
2
¶
,
(5.2)
and denote by Rh(s) the following sum over the exceptional eigenvalues,
Rh(s) = (ν1ν2)(l−1)/22s+l−3πl−1/2
Γ(s + l −1)
X
1/2≤sj≤1/2+θ
ρj(−h)
|h|s−1/2
× Γ
µs −sj
2
¶
Γ
µs −(1 −sj)
2
¶
⟨V, φj⟩.
(5.3)
Note here that we include the possible nonexceptional eigenvalue λj = 1/4
with sj = 1/2 and ti = 0 in Rh(s) just for technical simplicity. Then, for

126
YUK-KAM LAU, JIANYA LIU AND YANGBO YE
σ > 1,
Dg(s, ν1, ν2, h)−Rh(s) =
X
j: tj>0
Bj(h, s)⟨V, φj⟩
+ 1
4π
X
a
Z ∞
−∞
Ca(h, s, τ)⟨V, Ea(·, 1/2 + iτ)⟩dτ.
(5.4)
Since Rh(s) is a ﬁnite sum and
⟨V, φj⟩≪∥V ∥∥φj∥≪ν1,ν2,g 1,
it follows that Rh(s) is analytic in the half-plane σ > 0 except for poles
at sj and 1 −sj. By Sarnak [34, (A.16)], we can choose {φj} to be Hecke
eigenforms such that
ρj(m) ≪ε
(mNtj)ε
√
N
cosh
µπtj
2
¶
mθ.
(5.5)
Inserting (5.5) into (5.3), and then applying Stirling’s formula, we deduce,
for 1/2 ≤σ ≤2 and |t| ≥1,
Rh(s) ≪ν1,ν2,g |h|1/2+θ−σ+ε.
(5.6)
However, the above estimate is not true in the region 1/2 ≤σ ≤2 and
|t| ≤1, since the factor Γ((s−sj)/2) in (5.3) has a pole at s = sj = 1/2+itj
with 0 < itj ≤θ as in (4.5). Obviously, these poles lie in the interval
[1/2, 1/2 + θ] ⊂[1/2, 1]. This is why we require |t| ≥1 in Theorem 5.1
below.
By Theorem 4.1, Bj(h, s) (when tj ≥0) and Ca(h, s, τ) are holomorphic
in σ > 1/2. The right-side of (5.4) is analytically continued to a holomorphic
function on σ > 1/2, provided that uniform convergence on compact sets
is justiﬁed.
From (5.5), we infer that for 1/2 + ε ≤σ ≤3/2,
e−πtj/2Bj(h, s) ≪l,N |h|1/2−σ+θ+εtε
j
(1 + ||t| −tj|)σ/2−3/4
(1 + |t|)σ/2+l−3/4
× e−π(|t−tj|+|t+tj|−2|t|)/4,
(5.7)
and, with the spectral large sieve in place of (5.5),
e−π|τ|/2Ca(h, s, τ) ≪l,N |h|1/2−σ+ε(1 + |τ|)ε (1 + ||t| −τ|)σ/2−3/4
(1 + |t|)σ/2+l−3/4
× e−π(|t−τ|+|t+τ|−2|t|)/4.
(5.8)
To verify the uniform convergence of (5.4) on compact sets, we assume
for instance l ≥4 and invoke Good [11, Theorem 1]. The function V is of

SHIFTED CONVOLUTION SUMS OF FOURIER COEFFICIENTS OF CUSP FORMS
127
diﬀerent form from that of f there; nonetheless, Good’s result still covers
our case. This is because his proof applies to
fl(z) = ykF(z)Pl(z)
where F and Pl are a cusp form and a Poincar´e series for Γ, respectively;
see [11, (3.2)] and [11, §4]. Note that g(ν1z) and g(ν2z) are cusp forms for Γ,
and therefore g(ν2z) can be written as a linear combination of the Poincar´e
series. Hence,
X
tj≤T
|⟨V, φj⟩|2eπtj + 1
4π
X
a
Z T
−T
|⟨V, Ea(·, 1/2 + iτ)⟩|2eπ|τ| dτ ≪T 2l. (5.9)
The estimate (5.9) is also valid for other cases, by Kr¨otz and Stanton [22].
Plainly |t −τ| + |t + τ| −2|t| ≥|τ| if |τ| ≥2|t|.
Thus, by (5.7) and Weyl’s law
#{j : tj ≤T} = cT 2 + O(T log T)
(5.10)
for T ≥2|t|, we have
X
tj≥T
e−πtj|Bj(h, s)|2 ≪|h|1+2θ−2σ+ε(1 + |t|)3/2−σ−2l X
tj≥T
e−πtj/4
≪|h|1+2θ−2σ+εe−3T/4.
(5.11)
Also, by (5.8), we have, for T ≥2|t|,
Z
|τ|≥T
e−π|τ||Ca(h, s, τ)|2 dτ ≪|h|1−2σ+εe−3T/4
≪|h|1+2θ−2σ+εe−3T/4.
(5.12)
Now assume T0 ≥2|t|. Dividing dyadically and applying the Cauchy-
Schwarz inequality, we obtain
X
j: T0<tj≤T
|Bj(h, s)⟨V, φj⟩|
≤
X
0≤r≤log T
X
j: Yr<tj≤2Yr
|Bj(h, s)⟨V, φj⟩|
≤
X
0≤r≤log T
Ã
X
j: Yr<tj≤2Yr
e−πtj|Bj(h, s)|2
!1/2
×
Ã
X
j: Yr<tj≤2Yr
eπtj|⟨V, φj⟩|2
!1/2
.
(5.13)

128
YUK-KAM LAU, JIANYA LIU AND YANGBO YE
Here Yr denotes 2rT0. The sums in the brackets of the last line of (5.13) are
≪|h|1−2σ+2θ+εe−3Yr/4 and ≪Y 2l
r , respectively, by (5.11) and (5.9). There-
fore (5.13) becomes
X
j: T0<tj≤T
|Bj(h, s)⟨V, φj⟩| ≪|h|1/2+θ−σ+ε
X
0≤r≤log T
e−3Yr/8Y l
r
≪|h|1/2+θ−σ+εe−T0/4
(5.14)
for any T ≥T0.
Similarly it follows from Cauchy-Schwarz’s inequality that
Z
T0≤|τ|≤T
¯¯Ca(h, s, τ)⟨V, Ea(·, 1/2 + iτ)⟩
¯¯ dτ
≪
X
0≤r≤log T
Ã Z
Yr≤|τ|≤2Yr
e−π|τ||Ca(h, s, τ)|2 dτ
!1/2
×
Ã Z
Yr≤|τ|≤2Yr
eπ|τ||⟨V, Ea(·, 1/2 + iτ)⟩|2 dτ
!1/2
≪|h|1/2+θ−σ+εe−T0/4.
(5.15)
Consequently, for any ﬁxed compact subset K in the half plane σ > 1/2,
(5.14) and (5.15) hold uniformly for s ∈K when T0 ≥2 maxs∈K |t|. By the
Cauchy criterion, uniform convergence of (4.4) on compact sets is veriﬁed.
It remains to bound Dg(s, ν1, ν2, h) in (5.4). Let us consider σ ≥1/2+ε
and |t| ≥1. By (5.14) and (5.15) with T0 = 2|t|, we see that the tail part
in (5.4) yields
X
j: tj≥2|t|
Bj(h, s)⟨V, φj⟩+ 1
4π
X
a
Z
|τ|≥2|t|
Ca(h, s, τ)⟨V, Ea(·, 1/2 + iτ)⟩dτ
≪|h|1/2+θ−σ+εe−|t|/2.
(5.16)
Since |t −tj| + |t + tj| −2|t| is always nonnegative, we may apply (5.7) to

SHIFTED CONVOLUTION SUMS OF FOURIER COEFFICIENTS OF CUSP FORMS
129
Bj(h, s), to get
X
j: tj≤2|t|
¯¯Bj(h, s)⟨V, φj⟩
¯¯
≪|h|1/2+θ−σ+ε|t|3/4−σ/2−l+ε X
tj≤2|t|
|⟨V, φj⟩|eπtj/2(1 + |t −tj|)σ/2−3/4
≪|h|1/2+θ−σ+ε|t|3/4−σ/2−l+ε
Ã X
tj≤2|t|
|⟨V, φj⟩|2eπtj
!1/2
×
Ã X
tj≤2|t|
(1 + |t −tj|)σ−3/2
!1/2
≪|h|1/2+θ−σ+ε|t|1+ε
by (5.9) and Weyl’s law (5.10). We remark that the precise form of (5.10)
is needed to evaluate the last bracket.
Similarly, by (5.9),
X
a
Z 2|t|
−2|t|
|Ca(h, s, τ)⟨V, Ea(1/2 + iτ)⟩| dτ
≪|h|1/2−σ+ε|t|3/4−σ/2−l+ε X
a
Z 2|t|
−2|t|
|⟨V, Ea(1/2 + iτ)⟩|eπ|τ|/2
× (1 + |t −|τ||)σ/2−3/4 dτ
≪|h|1/2−σ+ε|t|3/4−σ/2−l+ε X
a
Ã Z 2|t|
−2|t|
|⟨V, Ea(1/2 + iτ)⟩|2eπ|τ| dτ
!1/2
×
Ã Z 2|t|
−2|t|
(1 + |t −|τ||)σ−3/2 dτ
!1/2
≪|h|1/2−σ+ε|t|1/2+ε.
Hence,
X
j: tj≤2|t|
Bj(h, s)⟨V, φj⟩+ 1
4π
X
a
Z
|τ|≤2|t|
Ca(h, s, τ)⟨V, Ea(·, 1/2 + iτ)⟩dτ
≪|h|1/2+θ−σ+ε|t|1+ε.
Inserting this, (5.16), and (5.6) into (5.4), we [23] prove the following result.
Theorem
5.1. With
notation
as
in
Theorem
4.2,
the
function
Dg(s, ν1, ν2, h) admits an analytic continuation to a meromorphic func-
tion on σ > 1/2, with at most a ﬁnite number of poles sj ∈(1/2, 1/2 + θ]

130
YUK-KAM LAU, JIANYA LIU AND YANGBO YE
due to possible exceptional eigenvalues λj = sj(1 −sj) of the Laplacian ∆.
Moreover, for σ ≥1/2 + ε and |t| ≥1, we have
Dg(s, ν1, ν2, h) ≪N,ν1,ν2,g,ε |h|1/2+θ−σ+ε|t|1+ε + χ(g)|h|1−σ.
(5.17)
We note that in (5.17), the implied constants depend possibly on ν1 and
ν2, while in Theorem 4.2, the dependence of the bounds for Dg(s, ν1, ν2, h)
in the ν1, ν2 aspect can be controlled explicitly. The main reason that the
estimates in Theorem 5.1 lack this ν1, ν2 aspect is that this dependence is
unavailable in (5.9) by [11] and [22]. The dependence on ν1 and ν2 plays a
crucial role in subconvexity problems in the level aspect (cf. Cogdell [5]),
and therefore it is an interesting question to estimate ⟨V, φj⟩not individu-
ally but on average while keeping track of its dependence on ν1, ν2.
The meromorphic continuation of Dg(s, ν1, ν2, h) to σ > 1/2 in Theo-
rem 5.1 enabled the authors [23] to prove
Theorem 5.2. Let f be a holomorphic Hecke eigenform for Γ0(N) of
weight k, or a Maass Hecke eigenform for Γ0(N) with Laplace eigenvalue
1/4 + k2, and let g be a ﬁxed holomorphic or Maass cusp form for Γ0(N),
or for Γ0(N ′) with (N, N ′) = 1. Then for any small ε > 0,
L(1/2 + it, f × g) ≪N,t,g,ε k1−1/(8+4θ)+ε.
(5.18)
Even if we take the trivial θ = 1/2, (5.18) still yields a subconvexity bound
k9/10+ε for L(1/2 + it, f × g).
6. Spectral method: meromorphic continuation to
σ > −1/2
To reach the Weyl bound as in (1.4), we need to meromorphically continue
Dg(s, ν1, ν2, h) further to the left.
6.1. Further meromorphic continuation to σ > −1/2
First, let us look at Rh(s) in (5.3). As Rh(s) is a ﬁnite sum and
⟨V, φj⟩≪∥V ∥∥φj∥≪ν1,ν2,g 1,
Rh(s) is analytic in the complex plane except for poles lying on the real
axis, which arise from the two gamma functions. In particular, on the half-
plane σ > 0, there are only ﬁnitely many poles at sj and 1 −sj lying in the
interval [1/2 −θ, 1/2 + θ] ⊂[0, 1]. Using Stirling’s formula, we deduce from

SHIFTED CONVOLUTION SUMS OF FOURIER COEFFICIENTS OF CUSP FORMS
131
(5.5) in the same way as we deduce (5.6) that, for |σ| ≤A0 and |t| ≥1,
Rh(σ + it) ≪A0
|ρj(−h)|
|h|σ−1/2|Γ(σ + l −1 + it)|
×
¯¯¯¯Γ
µs −sj
2
¶
Γ
µs −(1 −sj)
2
¶¯¯¯¯
¯¯⟨V, φj⟩
¯¯
≪
|h|1/2−σ+θ+ε|t|−l ≪|h|1/2−σ+θ+ε.
(6.1)
Now let us turn to the ﬁrst sum on the right side of (5.4). Recall (5.1)
and (5.2) and write
Bj(s) = (ν1ν2)(l−1)/2 2s+l−3πl−1/2
Γ(s + l −1) Γ
µs −1/2 + itj
2
¶
× Γ
µs −1/2 −itj
2
¶
,
(6.2)
Ca(s, τ) = (ν1ν2)(l−1)/2 2s+l−2πl−iτ
Γ(s + l −1)Γ
µs −1/2 + iτ
2
¶
× Γ
µs −1/2 −iτ
2
¶
.
(6.3)
Then from (5.4), (5.1), (5.2), (6.2), and (6.3) we have
Dg(s, ν1, ν2, h) −Rh(s)
=
X
j:tj>0
ρj(−h)
|h|s−1/2 Bj(s)⟨V, φj⟩
+ 1
4π
X
a
Z ∞
−∞
ρa(1/2 + iτ, −h)
|h|s−1/2+iτ
Ca(s, τ)
Γ(1/2 −iτ)⟨V, Ea(·, 1/2 + iτ)⟩dτ. (6.4)
We deduce from (6.2) that
Bj(s) ≪l,ν1,ν2,ε T
(6.5)
for 0 ≤tj ≤2T and −1/2 ≤σ ≤3/2. Similarly, from (6.3) we derive that
Ca(s, τ) ≪l,ν1,ν2,ε T
for |τ| ≤2T and |s −(1/2 ± itj)| ≥ε or |s −(1/2 ± iτ)| ≥ε. Besides, we
may deduce that
Z
|t|≍T
¯¯¯¯Bj
µ1
2 + ε + it
¶¯¯¯¯
2
dt and
Z
|t|≍T
¯¯¯¯Ca
µ1
2 + ε + it, τ
¶¯¯¯¯
2
dt
≪l,ν1,ν2,ε T 1−2l
(6.6)

132
YUK-KAM LAU, JIANYA LIU AND YANGBO YE
and
Z
|t|≍T
¯¯¯¯Bj
µ
−1
2 + it
¶¯¯¯¯
2
dt,
Z
|t|≍T
¯¯¯¯Ca(−1
2 + it,τ
¶¯¯¯¯
2
dt
≪l,ν1,ν2 T 2−2l.
(6.7)
6.2. Illustration for the proof of Theorem 1.1
The proof of Theorem 1.1 follows the line of arguments in [34], and our
salient point is a delicate study on the Mellin transform of the shifted con-
volution sum against an oscillatory function. We need to give it a good
upper estimate. To do so, we decompose spectrally the shifted convolution
sum. The oscillatory function is given by an exponential integral, to which
we apply the stationary phase method to extract the main part. Our de-
sired estimate then follows from the spectral large sieve inequality and an
estimate of Good on inner products of eigenfunctions. The spectral decom-
position of shifted convolution sum is powerful and interesting on its own.
It plays a key role in [34] as well, but there, Sarnak considered only for
his purpose the analytic continuation to the plane σ > 1/2 + θ. We need a
more precise form so that the meromorphic continuation is carried out to
the wider region σ > −1/2.
To illustrate the crucial roles played by the meromorphic continuation
to σ > −1/2 and bounds in (6.7), let us look at [24, (9.25)]:
Σ′′
d(C, T)ℓ
0 =
1
2πi
Z
ℓ′′
X
j: 0<tj≤2T
⟨V, φj⟩Bj(s)
X
|h|∼CT
ρj(−h)
|h|1/2 Sh,0(s) ds, (6.8)
where ℓ′′ = ℓ′′
−∪ℓ′′
+ is the union of the two vertical line segments joining
−1/2−ic′
0T to −1/2−ic0T, and −1/2+ic0T to −1/2+ic′
0T, and Sh,0(s) is a
nice function deﬁned in [24, (9.7)]. We apply the Cauchy-Schwarz inequality
to the integral in (6.8) to get rid of Bj(s). In this case σ = −1/2, and we
have by (6.7),
Z
ℓ′′ |Bj(s)|2 |ds| ≪T 2−2l.
(6.9)
Deﬁne
I0(σ, ρ) =
Z
ℓ′′
¯¯¯¯
X
|h|∼CT
ρ(−h)
|h|1/2 Sh,0(s)
¯¯¯¯
2
|ds|.
(6.10)

SHIFTED CONVOLUTION SUMS OF FOURIER COEFFICIENTS OF CUSP FORMS
133
Then
Σ′′
d(C, T)ℓ
0
≪T 1−l
X
j: 0<tj≤2T
|⟨V, φj⟩| I0
µ
−1
2, ρj
¶1/2
≪T 1−l
µ
X
0≤tj≤2T
|⟨V, φj⟩|2eπtj
¶1/2µ
X
0≤tj≤2T
e−πtjI0
µ
−1
2, ρj
¶ ¶1/2
by the Cauchy-Schwarz inequality for the sum. Then, we apply Good’s
estimate (5.9) to the ﬁrst factor, and apply the spectral large sieve esti-
mate to the second factor (see [24, pp.51-54] for details). Finally, we get a
bound for Σ′′
d(C, T)ℓ
0, which eventually leads to our Weyl-like bound (1.4)
in Theorem 1.1.
References
1. V. Blomer, Shifted convolution sums and subconvex bounds for automorphic
L-functions, Internat. Math. Res. Notices, 73 (2004), 3905–3926.
2. V. Blomer, Rankin-Selberg L-functions on the critical line, Manuscripta
Math., 117 (2005), 111–133.
3. V. Blomer, G. Harcos, and P. Michel, A Burgess-like subconvex bound for
twisted L-functions, Forum Math., 19 (2007), 61–105.
4. D.A. Burgess, On character sums and L-series, I, Proc. London Math. Soc.,
12 (1962), 193–206.
5. J.W. Cogdell, On sums of three squares, J. Th´eorie Nombres Bordeaux, 15
(2003), 33–44.
6. J.B. Conrey and H. Iwaniec, The cubic moment of central values of automor-
phic L-functions, Ann. Math., 151 (2000), 1175–1216.
7. D.R. Heath-Brown, The fourth power moment of the Riemann zeta function,
Proc. London Math. Soc., 38 (1979), 385–422.
8. J.-M. Deshouillers and H. Iwaniec, Kloosterman Sums and Fourier Coeﬃ-
cients of Cusp Forms, Invent. Math., 70 (1982), 219–288.
9. W. Duke, J. Friedlander, and H. Iwaniec, Bounds for automorphic L-
functions, Invent. Math., 112 (1993), 1–8.
10. W. Duke, J. Friedlander, and H. Iwaniec, Bounds for automorphic L-
functions, II, Invent. Math., 115 (1994), 219–239.
11. A. Good, The square mean of Dirichlet series associated with cusp forms,
Mathematika, 29 (1982), 278–295.
12. H. Harcos, An additive problem in the Fourier coeﬃcients of Maass forms,
Math. Ann., 326 (2003), 347–365.
13. G. Harcos and P. Michel, The subconvexity problem for Rankin-Selberg
L-functions and equidistribution of Heegner points. II, Invent. Math., 163
(2006), 581–655.

134
YUK-KAM LAU, JIANYA LIU AND YANGBO YE
14. M. N. Huxley, Exponential sums and the Riemann zeta function. V. Proc.
London Math. Soc., 90 (2005), 1–41.
15. A. Ivi´c, On sums of Hecke series in short intervals, J. Th´eor. Nombres Bor-
deaux, 13 (2001), 453–468.
16. H. Iwaniec, The spectral growth of automorphic L-functions, J. Reine Angew.
Math., 428 (1992), 139–159.
17. M. Jutila, Transformation of exponential sums, Proceedings of the Amalﬁ
Conference on Analytic Number Theory, Univ. Salerno, Salerno, 1992, 263–
270.
18. M. Jutila, A variant of the circle method, in: Sieve methods, exponential sums
and their applications in number theory, Cambridge Press, 1996, 245–254.
19. M. Jutila and Y. Motohashi, Uniform bounds for Rankin-Selberg L-
Functions, in: Multiple Dirichlet Series, Automorphic Forms, and Analytic
Number Theory, edited by Friedberg, Bump, Goldfeld, and Hoﬀstein, Proc.
Symp. Pure Math., 75 (2006), 243–256.
20. H. Kim, P. Sarnak, Appendix 2: Reﬁned estimates towards the Ramanujan
and Selberg conjectures, J. Amer. Math. Soc., 16 (2003), 175–181.
21. E. Kowalski, P. Michel, and J. VanderKam, Rankin-Selberg L-functions in
the level aspect, Duke Math. J., 114 (2002), 123–191.
22. B. Kr¨otz and R. J. Stanton, Holomorphic extensions of representations (I):
automorphic functions, Ann. Math., 159 (2004), 641–724.
23. Y.-K. Lau, J. Liu, and Y. Ye, Subconvexity bounds for Rankin-Selberg L-
functions for congruence subgroups, J. Number Theory, 121 (2006), 204–223.
24. Y.-K. Lau, J. Liu, and Y. Ye, A new bound k2/3+ε for Rankin-Selberg
L-functions for Hecke congruence subgroups, Intern. Math. Res. Papers,
7(2006), Article ID 35090, 1–78.
25. J. Liu and Y. Ye, Subconvexity for Rankin-Selberg L-functions of Maass
forms, Geom. Funct. Anal., 12 (2002), 1296–1323.
26. J. Liu and Y. Ye, Petersson and Kuznetsov trace formulas, in: Lie Groups
and Automorphic Forms, Amer. Math. Soc. and International Press, 2005,
147–168.
27. H. Maass, ¨Uber eine neue Art von nichtanalytischen automorphen Funktio-
nen und die Bestimmung Dirichletscher Reihen durch Funktionalgleichungen,
Math. Ann., 121 (1949), 141–183.
28. T. Meurman, On the order of the Maass L-function on the critical line,
in: K. Gy¨ory, G. Hal´asz (Eds.), Number Theory, Vol. I (Budapest, 1987),
Colloquium of Mathematical Society Janos Bolyai, Vol. 51, North-Holland,
Amsterdam, 1990, 325–354.
29. P. Michel, The subconvexity problem for Rankin-Selberg L-functions and
equidistribution of Heegner points, Ann. Math., 160 (2004), 185–236.
30. P. Michel, Analytic number theory and families of automorphic L-functions,
IAS/Park City Mathematics Series, manuscript.
31. Z. Peng, Zeros and central values of automorphic L-functions, Ph.D thesis,
Princeton University, Princeton, 2001.
32. R.S. Phillips, P. Sarnak, On cusp forms for co-ﬁnite subgroups of PSL(2, R),
Invent. Math., 80 (1985), 339–364.

SHIFTED CONVOLUTION SUMS OF FOURIER COEFFICIENTS OF CUSP FORMS
135
33. P. Sarnak, Integrals of products of eigenfunctions, Internat. Math. Res. No-
tices, 6 (1994), 251–260.
34. P. Sarnak, Estimates for Rankin-Selberg L-functions and Quantum Unique
Ergodicity, J. Funct. Anal., 184 (2001), 419–453.
35. A. Selberg, On the estimation of Fourier coeﬃcients of modular forms, in:
Proc. Sympos. Pure Math., Vol. VIII, Amer. Math. Soc., Providence, R.I,
1965, 1–15.

136
TWO EXPOSITIONS ON ARITHMETIC OF CUBICS
KATSUYA MIYAKE
Department of Mathematical Science,
School of Science and Engineering,
Waseda University,
3-4-1 Okubo, Shinjuku-ku, Tokyo 169-8555, Japan
E-mail: miyakek@aoni.waseda.jp
In the former half of the article we introduce cubic generic polynomials R(t; X)
and Q(s; X) for the symmetric group of degree 3 and for the cyclic group of
order 3, respectively, in a down-to-earth way. As an application we review the
main result of Kishi and the author [8] on the divisibility of the class numbers
of quadratic ﬁelds by three. In the latter half we introduce two kinds of families
of those elliptic curves over the rational number ﬁeld Q whose sets of rational
points over Q are described by certain subsets of the related cubic ﬁelds. The
analysis of the cubic polynomials R(t; X) and Q(s; X) in the former half is
fully utilized.
1. Introduction
This article consists of two parts. Part I is devoted to the study of cubic
generic polynomials
R(t; X) = X3 + tX + t
(1.1)
and
Q(s; X) = X3 −(s −3)X2 −sX −1
(1.2)
for the symmetric group S3 of degree 3 and the cyclic group C3 of order 3,
respectively, over a ﬁeld of characteristic other than 3 and 2. The contents
are restricted to the cubic cases and appear rather elementary. They do not
seem, however, to be found in usual text books in spite of the fact that the
cubic case is certainly the simplest gateway to step out into non-Abelian
lands. It may be better to note that some results were obtained or checked
by using computers. As an application of the ‘genericness’ of the polynomial
R(t; X), we review an elegant result on the divisibility of class numbers
of quadratic ﬁelds by 3 obtained by Yasuhiro Kishi and the author [8]

TWO EXPOSITIONS ON ARITHMETIC OF CUBICS
137
in §2.5; indeed, all unramiﬁed cyclic cubic extensions of quadratic ﬁelds
are covered by a cubic polynomial with two integral parameters satisfying
simple conditions as the splitting ﬁelds over Q.
In Part II, we study two types of families of elliptic curves whose sets
of rational points over Q are described by certain subsets of suitable cubic
ﬁelds. One of the two families of elliptic curves is given by
w3 = u3 + au2 + bu + c
with a, b, c ∈Q and may look rather special because they admit complex
multiplication by the third roots of unity. Their short forms are Mordell
curves of the form
y2 = x3 + k.
The other family ˜H(µ, t) of our concern consists of twists of the Hessian
family of elliptic curves
Hµ : U 3 + V 3 + W 3 = 3µ UV W,
µ ∈Q −{1}
over the splitting ﬁelds ˜Kt of those cubic polynomials R(t; X) with t ∈Q
which are irreducible over Q. We also treat twists of the arising curves over
the ﬁeld Kt generated by a root of R(t; X), and ﬁnd that they are the
quadratic twists of the original Hessian elliptic curves. It should be noted
that the twists ˜H(µ, t) of Hµ over ˜Kt are not ones as elliptic curves but
as algebraic curves. This is because they may not have any rational points
over Q even though the curves themselves are deﬁned over Q. The two-
parameter family, however, contains inﬁnitely many types of one-parameter
subfamilies each of which has ‘parametrized’ rational points over Q and
hence consists of elliptic curves deﬁned over Q. In the special case of µ = 0,
we will show a necessary and suﬃcient condition on t for ˜H(0, t) to have a
rational point over Q; (Proposition 3.12 in the last Subsection 3.5).
We will not give any detailed proofs to our results in this article. In-
terested readers may ﬁnd them in the author’s papers (partly with co-
authors) [4,8,11–14].
2. Part I: Generic polynomials of degree 3
First of all, the author recommends the readers the basic textbook [6] by C.
U. Jensen, A. Ledet and N. Yui on generic polynomials. Here in this article
we do not show any general results on them other than the simplest cubic
cases.

138
KATSUYA MIYAKE
2.1. Generic polynomials of degree 3
Let us start with an irreducible cubic polynomial in X
P(X) = X3 + aX2 + bX + c
over a ﬁeld k. We suppose that the base ﬁeld is of characteristic other
than 3 and contains inﬁnitely many elements. Our basic interest is the case
of k = Q. For the moment, however, we handle a general ﬁeld k with the
afore-mentioned conditions. Let ξ be a root of P(X) in the ﬁxed algebraic
closure of k, and K := k(ξ) be the cubic extension of k generated by ξ.
Proposition 2.1. By an aﬃne transformation of X over k, the polynomial
P(X) is reduced to either X3+s, s ∈k, or X3+tX+t, t ∈k up to a multiple
by a cube of an element of k.
Indeed, by putting Y = X + a/3, we have P(X) = Y 3 + b′Y + c′ with
b′ = −a2/3 + b,
c′ = 2a3/27 −ab/3 + c.
Since P(X) is irreducible over k, c′ is not equal to 0. If b′ = 0, then we have
P(X) = Y 3 + c′, while if b′ ̸= 0, putting Y = b′
c′ · X, we see
µb′
c′
¶3
· P(X) = Y 3 + b′3
c′2 · Y + b′3
c′2 .
Proposition 2.2. Every cubic extension K of k is obtained as K = k(ξ)
by a root ξ of the cubic polynomial R(t; X) of (1.1) with a suitable t ∈k.
Indeed, if K = k( 3√s), we take η :=
3√s +
3√s−1 ∈K. Then it is a root
of X3 −3X −(s + s−1) = 0; and we also have K = k(η).
Now let t be an independent variable over k. Then R(t; X) is a polyno-
mial over the rational function ﬁeld k(t). As we see below, the Galois group
of the splitting ﬁeld of R(t; X) over k(t) is isomorphic to the symmetric
group S3 of degree 3. Then it follows from Proposition 2.2 that each of
those Galois extensions ˜K over k whose group Gal( ˜K/k) are isomorphic to
S3 is obtained by some specialization of t := a, a ∈k as the splitting ﬁeld
of R(a; X) over k. Hence we say that
the cubic polynomial R(t; X) is parametric for S3 over k.

TWO EXPOSITIONS ON ARITHMETIC OF CUBICS
139
Furthermore, R(t; X) is parametric for S3 not only over k but also over
each of those ﬁelds F which contain k; namely, R(t; X) belongs to the
polynomial ring F[t] and is parametric over F as long as t is an independent
variable over F. This property is known as
the cubic polynomial R(t; X) is generic for S3 over k.
Actually, it is generic for S3 over the prime ﬁeld k0 contained in k. It
should be noted, however, that, when a Galois extension L/k has a non-
Abelian Galois group like S3, the base ﬁeld k cannot be a ﬁnite ﬁeld.
Next let C3 be the cyclic group of order 3. Then the following proposi-
tion is also well known:
Proposition 2.3. The cubic polynomial Q(s; X) of (1.2) over the rational
function ﬁeld k(s) of one variable s is generic for C3 over k.
The polynomial Q(s; X) is characterized by the following lemma:
Lemma 2.1. Under the linear fractional transformation −X/(X + 1), we
have
Q
µ
s; −X
X + 1
¶
=
−1
(X + 1)3 Q(s; X).
Since the linear fractional transformation −X/(X + 1) is of order 3, the
Galois group of the splitting ﬁeld of Q(s; X) over k(s) is isomorphic to C3.
The genericness of the cyclic polynomial is assured by
Proposition 2.4. Suppose that K/k is a cyclic extension of degree 3, and
let σ be a generator of the Galois group Gal(K/k). Then there exists an
element ξ ∈K which satisﬁes the condition ξσ = −ξ/(ξ + 1). For such an
element ξ ∈K, we have K = k(ξ) and Q(s; ξ) = 0 for some s ∈k.
This result for the case of k = Q is generalized for a cyclic group of odd
order n over the maximal real subﬁeld of the n-th cyclotomic ﬁeld in the
author’s paper [10]. D. Shanks [19] may be the ﬁrst who published on the
polynomial Q(s; X). He investigated arithmetic of the cyclic cubic ﬁelds
given by the polynomial with integral coeﬃcients.

140
KATSUYA MIYAKE
Recently Yuuichi Rikuna found a simple way to prove Proposition 2.3
in the case where the characteristic of the base ﬁeld k is other than 2 and 3,
and −3 is not a square in k.
Let P(X) := X3 + aX2 + bX + c be an irreducible cyclic polynomial
in k[X]. Then the discriminant D := a2b2 −4b3 −4a3c + 18abc −27c2
of P(X) is a square in k (cf. Proposition 2.6 below): D = d2, d ∈k.
Note that a2 −3b ̸= 0 because a2 −3b = 0 implies, by assumption, that
D = −(a3 −27c)2/27 is not a square in k.
Proposition 2.5 (Y. Rikuna). The notation and the assumptions being
as above, let ξ be a root of P(X) = 0, and put
η := a2 −3b
d
ξ + ab −9c −d
2d
.
Then the minimal polynomial of η over k is Q(s; X) = X3 −(s −3)X2 −
sX −1 with
s = −2a3 −9ab + 27c −3d
2d
.
Moreover, if we take −d in place of d, then we have a root γ of Q(u; X) = 0
with u = 3 −s.
Remark 2.1. In case of a2 −3b = 0, we have
27P(X) = (3X + a)3 −(a3 −27c).
Hence if we assume further that D is a square in k, then k contains √−3 and
the third root of unity. Even in this case we may easily ﬁnd by the method
given just after Proposition 2.2 an element η ∈k(
3√
a3 −27c) which is a
root of Q(s; X) = 0 with a suitable s ∈k.
2.2.
The Splitting Field of R(t; X)
In this section, we suppose that the characteristic of the base ﬁeld k is
not equal to 3 nor to 2. We consider a quantity t which generates a ﬁeld
k(t) with inﬁnitely many elements, and ﬁx an algebraic closure k(t). We
also suppose that the cubic polynomial R(t; X) is irreducible over k(t), and
denote the splitting ﬁeld of R(t; X) over k(t) by ˜Kt.
Let ξ ∈k(t) be a root of R(t; X), and
Kt := k(t, ξ)
(2.1)

TWO EXPOSITIONS ON ARITHMETIC OF CUBICS
141
be the ﬁeld generated by ξ over k(t).
Lemma 2.2. The discriminant of R(t; X) is −t2(4t + 27).
We put
dt := −(4t + 27).
(2.2)
Proposition 2.6. The splitting ﬁeld ˜Kt of the cubic polynomial R(t; X)
over k(t) contains √dt,
dt = −(4t + 27) ∈k(t), and ˜Kt = Kt(√dt).
Furthermore, the following two statements hold:
(1) [ ˜Kt : k(t)] = 3 if and only if dt is a square in k(t); if this is the case,
we have ˜Kt = Kt; the Galois group Gal( ˜Kt/k(t)) is isomorphic to C3.
(2) [ ˜Kt : k(t)] = 6 if and only if dt is not a square in k(t); if this is the case,
˜Kt contains the quadratic extension k(t, √dt) of k(t), and ˜Kt = Kt(√dt);
the Galois group Gal( ˜Kt/k(t)) is isomorphic to S3.
The proposition immediately follows from the following lemma. Note,
hereby, that the Galois group is not abelian in the case (2) of the proposi-
tion. Indeed, if it were abelian, then the subﬁeld Kt of ˜Kt should be normal
over k(t) and hence coincide with ˜Kt.
Lemma 2.3. The notation and the assumptions being as above, we have
˜Kt = k(t, ξ, α, β) where α and β are the roots of the quadratic polynomial
X2 + ξ X + ξ2 + t. We also have
R(t; X) = (X −ξ) (X2 + ξ X + ξ2 + t),
t = −ξ3
ξ + 1.
The discriminant d of the quadratic factor is given with dt of (2.4) by
d = −(3ξ2 + 4t) = dt
µ
ξ
2ξ + 3
¶2
.
2.3.
A Criterion for Kt ≃Kt′
In this section whose details can be found in the paper [4] by Akinari Hoshi
and the author, we still suppose that the characteristic of the base ﬁeld k
is not equal to 3 nor to 2. We suppose, furthermore, that the quantities t
and t′ generate the same ﬁeld k(t) = k(t′), and that the cubic polynomials
R(t; X) and R(t′; X) are irreducible over k(t).

142
KATSUYA MIYAKE
Let ξ and ξ′ be roots of R(t; X) and R(t′; X), respectively, in the al-
gebraically close ﬁeld k(t). If Kt = k(t, ξ) is isomorphic to Kt′ = k(t′, ξ′)
over k(t) = k(t′), then one of the conjugates of ξ′ over k(t) has to belong
to Kt. Hence we replace ξ′ with the conjugate of it in Kt and may assume
ξ′ ∈Kt. Since [Kt : k(t)] = 3, Kt has no non-trivial subﬁelds. Therefore we
have Kt = Kt′ in this case.
Proposition 2.7. The notation and the assumptions being as above, Kt =
Kt′ if and only if there exists an element u ∈k(t) such that
t′ = t(u2 + 9u −3t)3/(u3 −2tu2 −9tu −2t2 −27t)2.
Since the condition Kt = Kt′ is reciprocal in t and t′, so should the latter
condition of the proposition be. Indeed, let T and U be two independent
variables, and put
T ′ := T(U 2 + 9U −3T)3/(U 3 −2TU 2 −9TU −2T 2 −27T)2,
U ′ := −(U 2 + 3T)(U 2 + 9U −3T)/(U 3 −2TU 2 −9TU −2T 2 −27T).
Then we have a rational endomorphism of the rational function ﬁeld k(T, U)
of two variables, Φ : k(T, U) →k(T, U), by assigning (T ′, U ′) to (T, U).
Proposition 2.8. The endomorphism Φ is involutive; that is, Φ ◦Φ is
equal to the identity map. Hence Φ is an automorphism of k(T, U) and an
involutive Cremona transformation of dimension 2.
2.4. Notes on the Reducible Cases
It is tautologically true that R(t; X) is reducible over k(t) if and only if t
is of the form t = −r3/(r + 1) with some r ∈k(t) −{−1}. In this case it
is convenient to put ξ := r and Kt := k(t) for later use in Part II. The
splitting ﬁeld ˜Kt is either a quadratic extension of k(t) or k(t) itself. We
now have
R(t; X) = (X −r)
µ
X2 + rX +
r2
r + 1
¶
.
The discriminant D of the quadratic factor is given as
D = r2(r −3)
r + 1
.

TWO EXPOSITIONS ON ARITHMETIC OF CUBICS
143
Proposition 2.9. The cubic polynomial R(t; X) is reducible over k(t) if
and only if t is of the form t = −r3/(r + 1) with some r ∈k(t) −{−1}.
Furthermore in this case, ˜
Kt = k(t,
p
(r −3)/(r + 1)), so that, ˜Kt = k(t)
if and only if (r −3)/(r + 1) is a square in k(t).
Remark 2.2. It is clear that d = (r −3)/(r + 1) if and only if r = −(d +
3)/(d −1). For a ﬁxed ﬁeld k0(= k(t)) and its quadratic extension k0(
√
d),
therefore, there always exist r and t = −r3/(r + 1) in k0 which give rise
to ˜Kt = k0(
√
d). If k0 is an inﬁnite ﬁeld, then we have inﬁnitely many
such pairs of r and t because m2d with m ∈k0 gives the same quadratic
extension k0(
√
d).
Remark 2.3. Non-trivial subgroups of the symmetric group S3 are the
cyclic group C3 of order 3 and the cyclic group C2 of order 2. Hence Propo-
sition 2.6, (2), and Proposition 2.9 with Remark 2.2 conﬁrm that the cubic
polynomial R(t; X) is descent-generic over k; cf. G. Kemper [7].
2.5. An Application: Parametrization of Unramiﬁed Cyclic
Cubic Extensions of Quadratic Fields
In this subsection, we review the main theorem of Yasuhiro Kishi and the
author [8]. The base ﬁeld is the rational number ﬁeld: k = Q. We start with
a basic fact on an unramiﬁed Abelian extension of a quadratic ﬁeld.
Proposition 2.10. An unramiﬁed Abelian extension of a quadratic ﬁeld is
a normal extension over Q.
This fact is an outcome of the two special conditions; one is that the base
ﬁeld is a quadratic ﬁeld, and the other is that the ideal class group of Q is
trivial. Let d be an integer which is not a square in Q, and put K := Q(
√
d).
Let L/K be an unramiﬁed Abelian extension of K. We denote the Hilbert
class ﬁeld of K by ˜L; this is the maximal unramiﬁed Abelian extension
of K, and is normal over Q. Put G := Gal(˜L/Q), H := Gal(˜L/K) and
N := Gal(˜L/L). It is clear that H is a normal subgroup of G. We denote
the absolute class group of K by ClK. By class ﬁeld theory, there is a
canonical isomorphism ϕ : H →ClK which is the inverse isomorphism of

144
KATSUYA MIYAKE
the Artin map. Take an element σ ∈G which is not trivial on K. Then
the inner automorphism of G deﬁned by σ induces an automorphism of H.
It is independent of the choice of such σ because the subgroup H of G is
Abelian. Furthermore, we have ϕ(σ−1τσ) = ϕ(τ)σ for τ ∈H by class ﬁeld
theory; here the right-hand side comes from the natural action of σ on ideals
of K. Take a prime ideal p of K from the class ϕ(τ) which is unramiﬁed
in K/Q and of degree 1. Since the class group of Q is trivial, we see that
pσ·p is a principal ideal. Hence we have ϕ(τ)σ = ϕ(τ)−1 and σ−1τσ = τ −1.
Therefore, every subgroup of H is normal in G. Hence in particular, so is
the group N = Gal(˜L/L).
As for class ﬁeld theory and related fundamental elements of alge-
braic number theory, the readers are recommended to consult recent books
J. Neukirch [17] and G. Gras [3].
Corollary 2.1. An unramiﬁed cyclic cubic extension of a quadratic ﬁeld
is normal over Q. Its Galois group over Q is isomorphic to the symmetric
group S3.
The ﬁrst part of the corollary is assured by Proposition 2.10. Regarding
the second part, we note that the Galois group is of order 6. Hence if it
were isomorphic to C6, it should be Abelian, and the cyclic cubic extension
of the quadratic ﬁeld contains a cyclic cubic extension of Q. Then we see
by Minkowski’s theorem and the Hilbert theory that a prime number must
fully ramify here. Since the ramiﬁcation index should be 3 in this case, a
prime ideal of the quadratic ﬁeld over the prime number must also ramify
in the original cyclic extension of the quadratic ﬁeld; this contradicts to the
presupposition.
It follows from the corollary that every unramiﬁed cyclic cubic extension
of a quadratic ﬁeld is the Galois closure of a non-Galoisian cubic extension
of Q. That is to say, it is the splitting ﬁeld of an irreducible cubic polynomial
R(t; X) over Q with a suitable t ∈Q. We can now use the results of the
paper [9] of P. Llorente and E. Nart. To utilize them, we have to form
a cubic polynomial with integral coeﬃcients. First put t = −v/u, u, v ∈
Z, (u, v) = 1 and Y := uX. Then we have
f(Y ) = Y 3 −uvY −u2v = 0
from the equation R(t; X) = 0. Then we have v = w3, w ∈Z from [9]
if we assume that the splitting ﬁeld ˜Kt of R(t; X) is unramiﬁed over the

TWO EXPOSITIONS ON ARITHMETIC OF CUBICS
145
quadratic subﬁeld. Hence, putting Y = wZ, we have a cubic equation
g(Z) := Z3 −uwZ −u2 = 0,
u, w ∈Z, (u, w) = 1
(2.3)
which is equivalent to the original R(t; X) = 0. The discriminant of g(Z)
is given by
D := u2d,
d := 4uw3 −27u2.
Hence the quadratic ﬁeld in ˜Kt is Q(
√
d).
Theorem 2.1 (Kishi and Miyake [8]). The notation being as above,
suppose that g(Z) is irreducible over Q and that one of the following three
conditions is satisﬁed:
(i)
3 ∤w;
(ii)
3 | w,
uw ̸≡3 (mod 9),
u ≡w ± 1 (mod 9);
(2.4)
(iii)
3 | w,
uw ≡3 (mod 9),
u ≡w ± 1 (mod 27).
Then the splitting ﬁeld of g(Z) over Q is an unramiﬁed cyclic cubic exten-
sion of the quadratic ﬁeld Q(
√
d). Conversely, every unramiﬁed cyclic cubic
extension of a quadratic ﬁeld Q(
√
d) (if exists) is given in this way as the
splitting ﬁeld of g(Z) over Q by a suitable pair of integers u and w which
satisﬁes d = 4uw3 −27u2 and one of the three conditions (2.4).
3. Part II: Some Families of Elliptic Curves related with
Cubic Fields
In Part II, the base ﬁeld is ﬁxed to be the rational number ﬁeld: k = Q. The
contents of this part mainly come from the papers [13,14] of the author, the
ﬁrst half from the former and the second half from the latter. The two other
papers [11,12] also deal with related topics. Basic references on arithmetic
aspects of elliptic curves are J. Silverman [20] and [21], and J. Silverman
and J. Tate [22].
3.1.
Elliptic Curves of the Form w3 = u3 + au2 + bu + c
For an irreducible cubic polynomial over Q
P(u) = u3 + au2 + bu + c,
a, b, c ∈Q,
(3.1)
deﬁne an elliptic curve by
E = E(P) : w3 = P(u) = u3 + au2 + bu + c.
(3.2)

146
KATSUYA MIYAKE
Indeed, P(u) being irreducible over Q, E is of genus 1; since the leading
coeﬃcient of P(u) is 1, just one of its three points at inﬁnity is rational
over Q. Therefore E is an elliptic curve deﬁned over Q. We denote the set
of rational points of E over Q including the point at inﬁnity by E[Q].
Take a root ξ of P(u) in the complex number ﬁeld C, and let K = Q(ξ)
be the cubic ﬁeld generated by ξ. Put
W(ξ) = {α = qξ + r | NK/Q(α) = 1, q, r ∈Q}.
(3.3)
Then there is a bijective map from W(ξ) onto E[Q] which maps 1 ∈W(ξ)
to the point at inﬁnity in E[Q]. Note that the subset of K× depends on ξ
or, we may say, on the polynomial P(u); indeed, the isomorphism between
the cubic ﬁelds K and Q(η) bijectively maps W(ξ) to W(η) if we take an-
other root η of P(u). In this way we can completely describe the set of all
rational points of E over Q by the subset W(ξ) of the cubic ﬁeld K. We
state the fact as
Proposition 3.1 ([13, Proposition 2]). Let the notation be as above.
Then there exists a bijective map from W(ξ) onto E[Q] which maps 1 ∈
W(ξ) to the point at inﬁnity in E[Q].
It is clear that W(ξ) = W(qξ + r) for q, r ∈Q, q ̸= 0. Then by Proposi-
tion 2.1 in §2.1, we reduce the curve E(P) to one of the two typical elliptic
curves F0(s) and E0(t) which are deﬁned by
F0(s) : w3 = u3 + s,
E0(t) : w3 = R(t; u) := u3 + tu + t,
and parametrized by s and t in Q×, respectively. The ﬁrst F0(s) is isomor-
phic to the well known pure cubic twist X3 + Y 3 + sZ3 = 0 of the cubic
Fermat curve. It was extensively studied, for examples, by J. W. S. Cas-
sels [1] and E. Selmer [18]. Its short form is a Mordell curve M5(s) deﬁned
by
M5(s) : y2 = x3 −2433s2
(cf. e.g. Cassel [1]). L. J. Mordell investigated this type of curves in [15]. Be-
cause of this, J. Gebel, A. Peth˝o and H. G. Zimmer used the term ‘Mordell’s
equations’ in their title of [2].
We can show by a standard manner that a short form of E0(t) is given
by
M7(T) : y2 = x3 −T 2(T + 3),
T = 4t
9 .

TWO EXPOSITIONS ON ARITHMETIC OF CUBICS
147
(Cf. [13, §6]. Note that we use the indices of curves here in such a way as
they are to be consistent with the ones in the papers [11] and [12].)
Next let us consider the cubic polynomial P(c; u) := u3 + u2 + c with
c ∈Q. A short form of the elliptic curve
E1(c) := E(P(c; u)) : w3 = u3 + u2 + c
is obtained in [11] as
M1(c) : y2 = x3 −24c(27c + 4).
The cubic ﬁeld generated by a root of P(c; u) is isomorphic to the one ob-
tained by R(t; u) with t = c−1. Indeed, if ξ is a root of P(c; u) = 0, then
ξ−1 is a root of R(c−1; u) = 0. This relation between P(c; u) and R(c−1; u)
may give us a morphism between the two algebraic curves E1(c) and E0(t)
for t = c−1. If we try to pick up such a morphism, however, it may not be
deﬁned over Q as we don’t see a natural correspondence between W(ξ) and
W(ξ−1). Hence to see a relation deﬁned over Q between these two families
of elliptic curves, we should carry out the reduction process we did in §2.1
and reduce a general cubic polynomial to our R(t; X). Then we obtain the
following proposition.
Proposition 3.2. Suppose 27c+2 ̸= 0. Then E1(c) is isomorphic to E0(t)
for t = −27/(27c + 2)2 over Q. In this case, indeed, the deﬁning equation
w3 = u3 + u2 + c
of E1(c) is equivalent to
µ −9w
27c + 2
¶3
=
µ−3(3u + 1)
27c + 2
¶3
+ t
µ−3(3u + 1)
27c + 2
¶
+ t.
It should be noted that c ∈Q may not always be obtained from t in Q
through the relation t = −27/(27c+2)2. Hence the family of elliptic curves
E1(c), c ∈Q covers a strict subfamily of E0(t), t ∈Q.
If we pick up the generic polynomial Q(s; u) = u3 −(s−3)u2 −su−1 for
C3 of Proposition 2.3 in §2.1, then it corresponds to the cyclic cubic ﬁeld
deﬁned by the roots of Q(s; u). Let us denote the elliptic curve E(Q(s; u))
as E4(s):
E4(s) : w3 = u3 −(s −3)u2 −su −1.
Then we see

148
KATSUYA MIYAKE
Proposition 3.3. The short form of E4(s) is
M8(s) : y2 = x3 + 24(s2 −3s + 9)2.
Let θ be a root of Q(s; u) and K = Q(θ). Then −θ −1 belongs to
W(θ) = {α = qθ + r | NK/Q(α) = 1, q, r ∈Q}.
The rational point (w, u) = (1, −1) of E4(s) corresponding to −θ −1 is
mapped to the rational point
(x, y) = (0, 4(s2 −3s + 9))
of M8(s). This is a torsion point of order 3.
3.2. Some facts on the Hessian curves
In this latter half of Part II, we explain some results in [14].
In 1840’s, L. O. Hesse (1811–74) investigated plane curves in a series of
papers, and found an interesting family of elliptic curves of the form
Hµ : U 3 + V 3 + W 3 = 3µ UV W
(3.4)
on the projective plane P2(U : V : W). If µ ̸= 1, Hµ is non-singular, and is
an elliptic curve with points of order 3 deﬁned over Q(µ).
In this section we quote some facts on the Hessian curves from the text-
books of D. Husem¨oller [5, Ch.4], and L. J. Mordell [16, Ch.3].
Proposition 3.4.
(1) If µ ̸= 1, Hµ is an elliptic curve deﬁned over Q(µ). If we take, in this
case, the point P∞= (1 : −1 : 0) as the origin of the addition on the elliptic
curve, then all of its points of order 3 are given by the list (excluding P∞),
(0 : −1 : 1),
(1 : 0 : −1),
(1 : −1 : 0) = P∞,
(0 : −ω : 1),
(ω : 0 : −ω2),
(−1 : ω2 : 0),
(0 : −ω2 : 1),
(ω2 : 0 : −ω),
(−1 : ω : 0),
where ω is the third root of unity.
(2) If µ = 1, then Hµ is singular and consists of a line and a quadratic
curve:
U 3+V 3+W 3−3UV W = −1
2 (U+V +W){(U+V +W)2−3(U 2+V 2+W 2)}.

TWO EXPOSITIONS ON ARITHMETIC OF CUBICS
149
Proposition 3.5. The aﬃne elliptic curve
Aµ : y2 + 3µxy + y = x3
is a 3-isogeny of an aﬃne model
u3 + v3 = 1 −3µuv
of Hµ, (u = −U/W, v = −V/W). The isogeny is given by x = −uv, y =
−v3.
Theorem 3.1. Suppose that 3µ is a rational integer.
(1) Case of 3µ ̸= −1, 3, 5:
(1-1) Hµ has only three Q-rational points, or
(1-2) Hµ has inﬁnitely many Q-rational points.
(2) Case of 3µ = −1:
Hµ has six Q-rational points
(0 : −1 : 1), (1 : 0 : −1), (1 : −1 : 0), (1 : 1 : −1), (1 : −1 : 1), (−1 : 1 : 1).
(3) Case of 3µ = 5:
Hµ has six Q-rational points
(0 : −1 : 1), (1 : 0 : −1), (1 : −1 : 0), (1 : 1 : 2), (1 : 2 : 1), (2 : 1 : 1).
(4) Case of 3µ = 3: Hµ is singular, and has inﬁnitely many Q-rational
points.
Remark 3.1. Mordell uses the tangential method to show the contents of
this theorem. Here it is essential to assume that 3µ is an integer.
3.3. Twists of Hessian Elliptic Curves (1)
Our main concern in this subsection is to review some results in [14] on
twists of the curves Hµ with µ in Q −{1} over quadratic ﬁelds and the
Galois closures of cubic ﬁelds, and, in the latter case, to describe the set of
the rational points of the curve over Q by a certain subset of the related
cubic ﬁeld. Here we mean by twists of the elliptic curves twists as algebraic
curves because the twists we construct may not have any rational points
over Q even though the curves themselves are deﬁned over the ﬁeld.
We utilize the cubic polynomial R(t; X) = X3 + tX + t with t ∈Q
to construct the twists. Note that it parametrizes not only all cubic ﬁelds
but also all quadratic ﬁelds as we stated in §2.4; we exclude the values 0
and −27/4 of the parameter t to save R(t; X) from having multiple roots;

150
KATSUYA MIYAKE
indeed, the discriminant of the polynomial in X is −t2(4t + 27). As before
let ξ be a root of R(t; X) = 0 in the complex number ﬁeld C and put
Kt := Q(ξ); if R(t; X) = 0 has a root r in Q, then we pick it up as ξ = r
and have Kt = Q; in this case, obviously, we have t = −r3/(r + 1). Let
˜Kt be the splitting ﬁeld of the cubic polynomial R(t; X) over Q. If t runs
over all those rational values for which we have Kt = Q, then ˜Kt covers all
quadratic ﬁelds as Q(
p
−(4t + 27)) beside Q.
We deﬁne the twists ˜H(µ, t) of Hµ by making use of 3×3 matrices. Put
Ξ =


0
1
0
0
0
1
−t −t 0

.
The characteristic polynomial of the matrix Ξ is equal to the cubic poly-
nomial R(t; X).
To deﬁne our twist of the Hessian curve Hµ, take independent variables
x, y, z and put
M(x, y, z) := x13 + yΞ + zΞ2
where 13 is the unit matrix of size 3. The curve ˜H(µ, t) is deﬁned on the
projective plane P2(x : y : z) by
˜H(µ, t) : Tr
¡
M(x, y, z)3¢
= 3µ Det(M(x, y, z))
where Tr and Det denote the trace and the determinant of matrices, re-
spectively.
It should be noted again that, in general, the curve ˜H(µ, t) may not
have any rational points over Q even though it is deﬁned over Q.
Proposition 3.6. For µ, t ∈Q, µ ̸= 1, t ̸= 0, −27/4, the curve ˜H(µ, t) is
isomorphic to Hµ over ˜Kt.
In the case where R(t; X) is irreducible over Q, the set of rational points
of ˜H(µ, t) over Q is described by a certain subset of the cubic ﬁeld Kt.
Let ˜H(µ, t)[Q] denote the set of all Q-rational points on the curve
˜H(µ, t).
Deﬁne a subset Sµ,t of the cubic ﬁeld Kt by
Sµ,t = {η ∈K×
t
¯¯ TrKt/Q
¡
η3¢
= 3µ NKt/Q (η)}.
Here TrKt/Q and NKt/Q are the trace map and the norm map of Kt over Q,
respectively. It is clear that the multiplicative group Q× naturally acts on

TWO EXPOSITIONS ON ARITHMETIC OF CUBICS
151
the set Sµ,t. We denote the set of orbits by Sµ,t/∼Q×.
Proposition 3.7. Let the notation and the assumptions be as above.
Then there exists a canonical one-to-one and onto correspondence between
Sµ,t/∼Q× and ˜H(µ, t)[Q].
We may now transfer the well-known tangential method on elliptic
curves into our Sµ,t. For an element η in the cubic ﬁeld Kt, we denote
its conjugates over Q by η, η′, η′′. Note that η′ and η′′ may not belong
to Kt in general.
Proposition 3.8. If η ∈Kt belongs to Sµ,t, then
p
−(4t + 27) η
³
η′3 −η′′3´
also belongs to Sµ,t.
3.4. Twists of Hessian Elliptic Curves (2)
We now give a twist Hµ,t of ˜H(µ, t) over Kt which is a quadratic twist of
our original Hessian curve Hµ.
Let Hµ,t be the curve on the projective plane P2(u : v : w) deﬁned by
Hµ,t : 2u3 + 6d0uv2 + w3 = 3µ (u2 −d0v2 )w,
d0 = −(4t + 27).
Proposition 3.9. Suppose that µ, t ∈Q, µ ̸= 1, t ̸= 0, −27/4.
(1) The curve ˜H(µ, t) is isomorphic to Hµ,t over Kt.
(2) The curve Hµ,t is a twist of the Hessian curve Hµ over Q(√d0) =
Q(
p
−(4t + 27)), and is an elliptic curve deﬁned over Q with a Q-rational
point (u : v : w) = (0 : 1 : 0). The isomorphism is given by







U = u + √d0 v,
V = u −√d0 v,
W = w,







u = (U + V )/2,
v = (U −V )/(2√d0),
w = W.
In Proposition 3.5 in §3.2, we saw a simple aﬃne model Aµ of the 3-
isogeny of the Hessian elliptic curve Hµ for µ ̸= 1; namely,
Aµ : y2 + 3µxy + y = x3.

152
KATSUYA MIYAKE
We now give an aﬃne model Aµ,t of a 3-isogeny of the elliptic curve Hµ,t for
µ ̸= 0, 1. This aﬃne curve is a quadratic twist of Aµ over Q(√d0). Deﬁne
Aµ,t by
Aµ,t : d0Y 2 =
µ2X −1
3µ
¶3
+ X2,
d0 = −(4t + 27).
It has a Q-rational point (X : Y : Z) = (0 : 1 : 0) at inﬁnity.
Proposition 3.10. Suppose that µ, t ∈Q, µ ̸= 0, 1, t ̸= 0, −27/4.
(1) The elliptic curve Aµ,t is an aﬃne model of a 3-isogeny of the elliptic
curve Hµ,t; the isogeny is deﬁned by













X =
µ u
−w
¶3
+ 3d0
µ u
−w
¶ µ v
−w
¶2
,
Y = 3
µ u
−w
¶2 µ v
−w
¶
+ d0
µ v
−w
¶3
.
(2) If d0 is not a square in Q, Aµ,t is the quadratic twist of Aµ over the
quadratic ﬁeld Q(√d0).
3.5. Some cases of non-empty ˜
H(µ, t)[Q]
We now present two propositions to demonstrate some cases of non-empty
˜H(µ, t)[Q] before we close the article.
Proposition 3.11. Suppose that the cubic polynomial R(t; X) is irre-
ducible over Q for t ∈Q −{0, −27/4}. Then ˜H(µ, t) has a rational point
over Q in each of the following three cases: (1) in case of µ = t/3 + 1 ̸= 1,
the point (t : 0 : 1) belongs to ˜H(µ, t)[Q], (2) in case of µ = 1 −3t ̸= 1, the
point (1 : 1 : 0) belongs to ˜H(µ, t)[Q], and (3) in case of µ = 1 −2t/3 ̸= 1,
the point (0 : 0 : 1) belongs to ˜H(µ, t)[Q].
In the special case of µ = 0 we give a necessary and suﬃcient condition
on t for ˜H(0, t) to have a rational point over Q.
Proposition 3.12. In case of µ = 0, the curve ˜H(0, t) has a rational
point over Q for t ∈Q −{0, −27/4} if and only if either t = −r3/(r + 1)

TWO EXPOSITIONS ON ARITHMETIC OF CUBICS
153
with r ∈Q −{0, −1}, or ˜H(0, t) is isomorphic over Q to ˜H(0, t′) with
t′ = h3/(2h −1)2, h ∈Q −{0, 1/2}.
References
1. J. W. S. Cassels, The Rational Solutions of the Diophantine Equation, y2 =
x3 −D. Acta Math., 82 (1950), 243–273.
2. J. Gebel, A. Peth˝o and H. G. Zimmer, On Mordell’s Equation. Comp. Math.,
110 (1998), 335–367.
3. G. Gras, Class Field Theory, from Theory to Practice. Springer Monographs
in Mathematics, Springer-Verlag, New York/Berlin/Heidelberg/London/
Paris/Tokyo, 1st ed., 2003. Corr. 2nd printing, 2005.
4. A. Hoshi and K. Miyake, Tschirnhausen Transformation of a Cubic Generic
Polynomial and a 2-dimensional Involutive Cremona Transformation. Proc.
Japan Acad., 83 Ser. A, (2007), 21–26.
5. D. Husem¨oller, Elliptic Curves with an Appendix by Ruth Lawrence,
Springer-Verlag, New York/Berlin/Heidelberg/London/Paris/Tokyo, 1987.
6. C. U. Jensen, A. Ledet and N. Yui, Generic Polynomials, Constructive As-
pects of the Inverse Galois Problem, Cambridge U.P., Cambridge, 2002.
7. G. Kemper, Generic polynomials are descent-generic. Manuscripta math.,
105 (2001), 139–141.
8. Y. Kishi and K. Miyake, Parametrization of the Quadratic Fields whose Class
Numbers are divisible by Three. Jour. Number Theory, 80 (2000), 209–217.
9. P. Llorente and E. Nart, Eﬀective determination of the decomposition of
the rational prime in a cubic ﬁeld. Proc. American Math. Soc., 87 (1983),
579–585.
10. K. Miyake, Linear Fractional Transformations and Cyclic Polynomials. Ad-
vanced Studies in Contemporary Mathematics 1, ed. by Han-Soo Kim and
Toru Nakahara, Memoirs of the Jangjun Math. Soc., 1999, Gu-Duk Pub-
lisher, Pusan, pp.137–142.
11. K. Miyake, Some Families of Mordell Curves associated to Cubic Fields. Jour.
Comp. and Applied Math. Sciences, 160 (2003), 217–231.
12. K. Miyake, An Introduction to Elliptic Curves and their Diophantine Geom-
etry — Mordell Curves —. Compte Rendus de la conf´erence internationale
Maroc-Qu´ebec (Mai 2003) “Th´eorie des nombres et applications” 2004, pp.
173–185, Annales des Sciences Math´ematiques du Qu´ebec, 2004.
13. K. Miyake, Cubic Fields and Mordell Curves. Number Theory: Tradition and
Modernization, ed. by W. Zhang and Y. Tanigawa, pp. 175–183, Springer
Science + Buisiness Media, Inc., 2006.
14. K. Miyake, Twists of Hessian Elliptic Curves and Cubic Fields, submitted to
The Proceedings of Congr´es International, Alg`ebre, Th´eorie des nombres et
leurs Applications, Universit´e Mohammed I, Oujda-Saidia, Maroc, du 11 au
14 mai, 2006.
15. L. J. Mordell, The Diophantine Equation y2 −k = x3. Proc. London Math.
Soc., 13 (1914), 60–80.

154
KATSUYA MIYAKE
16. L. J. Mordell, Diophantine Equations. Acad. Press, London and New York,
1969.
17. J. Neukirch, Algebraic Number Theory. Grundlehren der mathematischen
Wissenschaften, Vol.322, Springer-Verlag, New York/Berlin/Heidelberg/
London/Paris/Tokyo, 1999.
18. E. S. Selmer, The Diophantine Equation ax3 + by3 + cz3 = 0. Acta Math.,
85 (1951), 203–362; Completion of the Table. Ibid., 92 (1954), 191–197.
19. D. Shanks, The Simplest Cubic Fields, Math. Comp., 28 (1974), 1137–1152.
20. J. H. Silverman, The Arithmetic of Elliptic Curves. GTM 106, Springer-
Verlag, New York, 1986.
21. J. H. Silverman, Advanced Topics in the Arithmetic of Elliptic Curves. GTM
151, Springer-Verlag, New York, 1994.
22. J. H. Silverman and J. Tate, Rational Points on Elliptic Curves. UTM,
Springer-Verlag, New York, 1992.

155
DISTRIBUTION OF POINTS ON MODULAR HYPERBOLAS
IGOR E. SHPARLINSKI
Department of Computing, Macquarie University
Sydney, NSW 2109, Australia
E-mail: igor@ics.mq.edu.au
We give a survey of several recent results and pose several open problems about
the distribution and some geometric properties of points (x, y) on modular hy-
perbolas xy ≡a (mod m). We also outline a very diverse range of applications
of such results and discuss multivariate generalisations.
1. Introduction
1.1. Modular Hyperbolas and Kloosterman Sums
For a positive integer m and an arbitrary integer a with gcd(a, m) = 1, we
consider the set of points (x, y) on the modular hyperbola
Ha,m = {(x, y) : xy ≡a
(mod m)}.
We give a survey of various results about the distribution and some geomet-
ric properties of points on Ha,m. We also point out several very surprising
links of these results with a wide variety of other number theoretic ques-
tions. Finally, we brieﬂy consider some multidimensional generalisations,
which often require very diﬀerent techniques. Several open problems are
formulated as well.
Given two sets of integers X and Y, we write
Ha,m(X, Y) = {(x, y) ∈Ha,m : x ∈X, y ∈Y}.
Since the case of a = 1 is of special interest we also write
Hm = H1,m,
and
Hm(X, Y) = H1,m(X, Y).
Obtaining precise asymptotic formulas for and establishing the posi-
tivity of #Ha,m(X, Y) for various “interesting” sets X and Y have been
the central themes of many works in this direction. Certainly the problem

156
IGOR E. SHPARLINSKI
becomes harder and far more interesting when the sets X and Y become
“thinner”.
Let
em(z) = exp(2πiz/m).
One immediately observes that the well known bound of Kloosterman
sums
Km(r, s) =
X
(x,y)∈Hm
1⩽x,y⩽m
em (rx + sy) ⩽(m gcd(r, s, m))1/2+o(1) ,
(1.1)
see [39, Corollary 11.12], can be used to study the points on Ha,m. One
only needs to recall some standard tools which link exponential sums with
uniformity of distribution which we present in §2.2.
In this survey, we do not present complete proofs but sometimes explain
their underlying ideas and speciﬁc ingredients. Typically the error terms in
the asymptotic formulas we give contain a factor mo(1). In most cases it
can be replaced by a more explicit function. Furthermore, when m = p it
can usually (but not always) be replaced by just some low power of log m.
There is a large number of papers in this area which rather routinely
study seemingly distinct, but in fact closely related, problems about Ha,m
on the case by case basis. Here, we explain some standard principles which
can be used to derive these and many other results of similar spirit about
the points on Ha,m as simple corollaries of just one general result about the
uniformity of distribution of points on Ha,m in certain domains. In §3.1,
such a result is presented in Theorem 3.1 and derived in a very straightfor-
ward fashion from (1.1), using some standard arguments.
We remark that most of the results which rely only on (1.1) do not
appeal to anything speciﬁc about the congruence xy ≡a (mod m), and
at least when m = p prime they can be extended to the distribution of
solutions to more general congruences f(x, y) ≡0 (mod p), with a polyno-
mial f with integer coeﬃcients. In the case of prime m = p, the Bombieri
bound [9] of exponential sums along a curve replaces the bound (1.1). Al-
though, as we have mentioned, we present such a generic result in §3.1, our
main purpose is to outline some more intricate arguments, which use special
properties of the congruence xy ≡a (mod m) and cannot be generalised to
other congruences. In particular, in §3.2 we discuss the behaviour of points
on Ha,m on average over a. We also describe some geometric properties of
the set Ha,m in §§4.1–4.3.

DISTRIBUTION OF POINTS ON MODULAR HYPERBOLAS
157
Before presenting results about the properties of Ha,m, we give a short
overview of the surprisingly diverse variety of number theoretic tools which
have been used in the study of Ha,m and their multivariate generalisations,
see §§2.1–2.3.
Finally, we outline various applications of the results on the distribution
of points on Ha,m. Some of them are quite natural with very transparent
connections to Ha,m, see §5.1. However, there are also several less obvious
and thus less expected applications, see §§5.2–5.8. An especially striking
example of such unexpected applications is given by a result of [54] on
torsion of elliptic curves, see §5.5.
1.2. Notation
Throughout the paper, any implied constants in symbols O, ≪and ≫may
occasionally depend, where obvious, on the real positive parameter ε and
are absolute otherwise. We recall that the notations U = O(V ), U ≪V
and V ≫U are all equivalent to the statement that |U| ⩽cV holds with
some constant c > 0.
We use p, with or without a subscript, to denote a prime number and
use m to denote a positive integer.
We denote by Z/mZ the residue ring modulo m. Typically we assume
that the set {0, . . . , m −1} is used to represent the elements of Z/mZ.
Accordingly, we often consider the following subset of Ha,m
Ha,m = Ha,m ∩[0, m −1]2.
We also put
Hm = Hm ∩[0, m −1]2.
As usual, ω(k), τ(k) and ϕ(k) denote the number of distinct prime
divisors, the number of positive integer divisors and the Euler function of
k ⩾1, respectively.
Finally, µ(k) denotes the M¨obius function. We recall that µ(1) = 1,
µ(k) = 0 if k ⩾2 is not squarefree and µ(k) = (−1)ω(k) otherwise.
1.3. Acknowledgements
The author is very grateful to the organisers of the 4th China-Japan Sem-
inar on number theory Jianya Liu and Shigeru Kanemitsu for their kind
invitation to this meeting and help with preparation of this manuscript.

158
IGOR E. SHPARLINSKI
The author would like to thank Arne Winterhof for careful reading of
the manuscript and making many valuable suggestions; in particular, the
equation (4.6) is due to him.
This work was supported in part by ARC grant DP0556431.
2. Number Theory Background
2.1. Exponential and Character Sums
We have already mentioned the prominent role of Kloosterman sums and
the bound (1.1) in particular.
Most of the works also use the identity
1
m
X
r∈Z/mZ
em(rv) =
½1
if v ≡0
(mod m),
0
if v ̸≡0
(mod m)
(2.1)
to express various characteristic functions and thus relating various count-
ing questions to exponential sums.
It is very often complemented by the bound
W +Z
X
z=W +1
em(rz) ≪min{Z, m/|r|}
(2.2)
which holds for any integers r, W and Z ⩾1 with 0 < |r| ⩽m/2, see [39,
Bound (8.6)].
We need the estimate from [63] of exponential sums with rational func-
tions of special type, which generalises the bound (1.1) of Kloosterman
sums.
Lemma 2.1. Let n1, . . . , ns be nonzero pairwise distinct integers. Then the
bound
max
gcd(a1,...,as,m)=d
m
X
z=1
gcd(z,m)=1
em(a1zn1 + . . . + aszns) ≪d1/sm1−1/s+o(1)
holds, where the implied constant depends only on n1, . . . , ns.
However, in many cases using bounds of multiplicative character sums
yields stronger results.
Let Φm be the set of all ϕ(m) multiplicative characters modulo m. We
have the following analogue of (2.1). For any integer r,
1
ϕ(m)
X
χ∈Φm
χ (r) =
½ 1
if r ≡1
(mod m),
0
otherwise.
(2.3)

DISTRIBUTION OF POINTS ON MODULAR HYPERBOLAS
159
We also use χ0 to denote the principal character.
The following result is a combination of the Polya-Vinogradov bound
(for ν = 1) and Burgess (for ν ⩾2) bounds, see [39, Theorems 12.5 and
12.6].
Lemma 2.2. For any integers W and Z with 1 ⩽Z ⩽m, the bound
max
χ∈Φm
χ̸=χ0
¯¯¯¯¯
W +Z
X
z=W +1
χ(z)
¯¯¯¯¯ ⩽Z1−1/νm(ν+1)/4ν2+o(1)
holds with ν = 1, 2, 3 for any m and with arbitrary positive integer ν if
m = p is a prime.
The identity (2.3) immediately implies that for 1 ⩽Z ⩽m
X
χ∈Φm
¯¯¯¯¯
W +Z
X
z=W +1
χ(z)
¯¯¯¯¯
2
= ϕ(m)
W +Z
X
z=W +1
gcd(z,m)=1
1 ⩽ϕ(m)Z
(2.4)
which has been used in many works on Ha,m.
Furthermore, it turns out, that sometimes one gets better results using
the following 4th moment estimate from [3] (for prime m = p) and [28] (for
arbitrary m), see also [32].
Lemma 2.3. For an arbitrary integer W, if m = p is a prime, and for
W = 0 for arbitrary m, and an arbitrary positive integer Z ⩽m, the bound
X
χ∈Φm
¯¯¯¯¯
W +Z
X
z=W +1
χ(z)
¯¯¯¯¯
4
⩽m1+o(1)Z2
holds.
2.2. Theory of Uniform Distribution
For a ﬁnite set F ⊆[0, 1]s of the s-dimensional unit cube, we deﬁne its
discrepancy with respect to a domain Ξ ⊆[0, 1]s as
∆(F, Ξ) =
¯¯¯¯
#{f ∈F : f ∈Ξ}
#F
−λ(Ξ)
¯¯¯¯ ,
where λ is the Lebesgue measure on [0, 1]s.
We now deﬁne the discrepancy of F as
D(F) =
sup
Π⊆[0,1]s ∆(F, Π),

160
IGOR E. SHPARLINSKI
where the supremum is taken over all boxes Π = [α1, β1) × . . . × [αs, βs) ⊆
[0, 1]s.
A link between the discrepancy and exponential sums is provided by
the celebrated Koksma–Sz¨usz inequality, see [22, Theorem 1.21]. However,
for points of Ha,m, due to the discrete structure of the problem, one can
immediately establish such a link directly by the identity (2.1).
For example, one can consider the points
³ x
m, y
m
´
∈[0, 1]2,
(x, y) ∈Ha,m,
and apply the bound (1.1) to estimate their discrepancy, which in turn is
equivalent to studying points of Ha,m(X, Y) where X and Y are sets of
consecutive integers.
Moreover, the Koksma–Hlawka inequality, see [22, Theorem 1.14], allows
to estimate average values of various functions on the points (x, y) ∈Ha,m.
Lemma 2.4. For any continuous function ψ(z) on the unit cube z ∈[0, 1]s
and a ﬁnite set F ⊆[0, 1]s of discrepancy D(F), the following bound holds:
1
#F
X
f∈F
ψ(f) =
Z
[0,1]s ψ(z)dz + O (D(F))
where the implied constant depends only on s and the function ψ.
To study Ha,m ∩W for more general sets W some additional tools are
required from the theory of uniform distribution.
As usual, we deﬁne the distance between a vector u ∈[0, 1]s and a set
Ξ ⊆[0, 1]s by
dist(u, Ξ) = inf
w∈Ξ ∥u −w∥,
where ∥v∥denotes the Euclidean norm of v. Given ε > 0 and a domain
Ξ ⊆[0, 1]s we deﬁne the sets
Ξ+
ε = {u ∈[0, 1]s\Ξ : dist(u, Ξ) < ε}
and
Ξ−
ε = {u ∈Ξ : dist(u, [0, 1]s\Ξ) < ε} .
Let h(ε) be an arbitrary increasing function deﬁned for ε > 0 and such
that
lim
ε→0 h(ε) = 0.

DISTRIBUTION OF POINTS ON MODULAR HYPERBOLAS
161
As in [47,56], we deﬁne the class Sh of domains Ξ ⊆[0, 1]s for which
λ
¡
Ξ+
ε
¢
⩽h(ε)
and
λ
¡
Ξ−
ε
¢
⩽h(ε).
A relation between D(F) and ∆(F, Ξ) for Ξ ∈Sh is given by the
following inequality of [47] (see also [56]).
Lemma 2.5. For any domain Ξ ∈Sh, we have
∆(F, Ξ) ≪h
³
s1/2D(F)1/s´
.
Finally, the following bound, which is a special case of a more general
result of H. Weyl [74] shows that if Ξ has a piecewise smooth boundary
such that Ξ ∈Sh for some linear function h(ε) = Cε.
Lemma 2.6. For any domain Ξ ∈Sh with piecewise smooth boundary, we
have
λ
¡
Ξ±
ε
¢
= O(ε).
To use the above results for the study of points on Ha,m, one usually
considers points
³ x
m, y
m
´
∈[0, 1]2,
(x, y) ∈Ha,m, 1 ⩽x, y ⩽m.
(2.5)
2.3. Arithmetic Functions, Divisors, Prime Numbers
Certainly some elementary bounds such as
ϕ(k) ≫
k
log log(k + 2)
and
2ω(k) ⩽τ(k) ≪exp
µ
(log 2 + o(1))
log k
log log k
¶
,
(2.6)
see [71, Section I.5.2 and I.5.4] appear at various stages of the proofs of
relevant results.
The following well known consequence of the sieve of Eratosthenes (es-
sentially of the inclusion-exclusion principle expressed via the M¨obius func-
tion) is very often needed to estimate the main terms of various asymptotic
formulas (see, for example, [67,68]).
Lemma 2.7. For any integers m, Z ⩾1 and W ⩾0,
W +Z
X
z=W +1
gcd(z,m)=1
1 = ϕ(m)
m
Z + O(2ω(m)).

162
IGOR E. SHPARLINSKI
For an inﬁnite monotonically increasing sequence of positive integers
A = (an)∞
n=1, we deﬁne
H(x, y, z; A) = #{n ⩽x : ∃d|an with y < d ⩽z}.
For A = N, the set of natural numbers, the order of magnitude of
H(x, y, z; N) for all x, y, z has been determined in [25], see also [38]. Also
in [25], one can ﬁnd upper bounds for H(x, y, z; Pb) of the expected order
of magnitude, where Pb = {p + b : p prime} is a set of so-called shifted
primes. However, for the problem of studying Ha,m, we need analogous re-
sults where n is restricted to an arithmetic progression. More precisely, let
us deﬁne the sequences
Tk = {mk −1 : m ∈N}
and
Uk = {pk −1 : p prime}.
It has been shown in [26] that the arguments of [25] imply the following
estimates.
It is usual that in questions of this kind, the constant
κ = 1 −1 + log log 2
log 2
= 0.086071 . . . .
(2.7)
plays an important role, see also [38].
Lemma 2.8. Uniformly for 100 ⩽y ⩽x0.51, 1.1y ⩽z ⩽y1.1, 1 ⩽k ⩽
log x, we have
H(x, y, z; Tk) ≪x
k
ϕ(k)uκ(log(1/u))−3/2,
H(x, y, z; Uk) ≪x
k
ϕ(k)uκ(log(1/u))−3/2,
where z = y1+u.
A certain result of [26] relies on the existence of inﬁnitely many primes
p with a prescribed structure of divisors of p−1, which is done using a very
deep results of [10] concerning the Bombieri-Vinogradov theorem.
For an integer k ⩾1 we write
T(k) =
max
i=1,...,τ(m)−1
di+1
di
where 1 = d1 < . . . < dτ(m) = m are the positive divisors of m.
By [60, Theorem 1], we have:
Lemma 2.9. Uniformly in z ⩾t ⩾2,
z log t
log z ≫# {k ⩽z : T(k) ⩽t} ≫z log t
log z .

DISTRIBUTION OF POINTS ON MODULAR HYPERBOLAS
163
Finally, we remark, that several interesting results about the distribu-
tion of points on Ha,m(X, Y) on average over a, for some special sets X and
Y, such as intervals
X = Y = {z : 1 ⩽z ⩽m/2},
are based on various asymptotic formulas for average values of Dirichlet
L-functions, see, for example, [48,75,86].
3. Distribution of Points on Ha,m
3.1. Points on Ha,m in Intervals for All a
A classical conjecture asserts that for any ﬁxed ε > 0 and a suﬃciently
large p, for every integer a there are integers x and y with |x|, |y| ⩽p1/2+ε
and such that xy ≡a (mod p), see [30,33–35] and references therein. The
question has probably been motivated by the following observation. Using
the Dirichlet pigeon-hole principle, one can easily show that for every integer
a there are integers x and y with |x|, |y| ⩽2p1/2 with y/x ≡a (mod p).
Unfortunately, this is known only with |x|, |y| ⩾Cp3/4 for some absolute
constant C > 0, which is shown in [31]. Several modiﬁcations of this bound,
for example for composite m, are also known, see [44]. These results are
based on the bound (1.1) of Kloosterman sums (and its more precise form
in the case when m = p is a prime) combined with some other standard
arguments. The same arguments also produce the following estimate which
is a slight generalisation of several previously known results, see [5,29] and
references therein.
Theorem 3.1. Let X = {U + 1, . . . , U + X}, where X ⩾1 and U ⩾0
are arbitrary integers. Suppose that for every x ∈X we are given a set
Yx = {Vx + 1, . . . , Vx + Y } where Y ⩾1 and Vx ⩾0 are arbitrary integers.
Then for any integer m ⩾1 and a with gcd(a, m) = 1, we have
X
(x,y)∈Ha,m
x∈X,y∈Yx
1 = XY ϕ(m)
m2
+ O(m1/2+o(1)).
Proof. Using (2.1) we write
X
(x,y)∈Ha,m
x∈X,y∈Yx
1 =
1
m2
X
(x,y)∈Ha,m
1⩽x,y⩽m
X
w∈X
X
z∈Yw
X
r,s∈Z/mZ
em (r(x −w) + s(y −z))
=
1
m2
X
r,s∈Z/mZ
Km(r, as)
X
w∈X
em (−rw)
X
z∈Yw
em (−sz) .

164
IGOR E. SHPARLINSKI
We now separate the main term which corresponds to r = s = 0 and is
equal to
XY
m2
X
(x,y)∈Ha,m
1⩽x,y⩽m
1 = XY ϕ(m)
m2 .
For the error term E, for each divisor d|m, we collect together pairs (r, s)
with the same value gcd(r, s, m) = d.
Applying the bounds (1.1) and (2.2) we obtain
E ≪m1/2+o(1) X
d|m
d<m
d1/2
X
−(m−1)/2⩽r,s⩽m/2
gcd(r,s,m)=d
1
(|r| + 1)(|s| + 1)
≪m1/2+o(1) X
d|m
d<m
d1/2


X
−(m−1)/2d⩽t⩽m/2d
1
d|t| + 1


2
≪m1/2+o(1) X
d|m
d<m
d−3/2 ≪m1/2+o(1)τ(m).
Now the bound (2.6) leads to the desired statement.
For example if Vx = V for all x ∈X = {U + 1, . . . , U + X} and Y =
{V + 1, . . . , V + Y } then Theorem 3.1 yields
#Ha,m(X, Y) = XY ϕ(m)
m2
+ O(m1/2+o(1)).
(3.1)
It seems that improving Theorem 3.1 or even just the asymptotic for-
mula (3.1) and making them nontrivial for XY < mα with some ﬁxed
α < 3/2 is out of reach at the present time. However there are some easier
questions which could be more feasible to answer.
Question 3.1. Improve the asymptotic formula (3.1) for some special mod-
uli m, such as primes or prime powers.
Question 3.2. Improve the asymptotic formula (3.1) on average over the
moduli m ⩽M.
Clearly, Theorem 3.1 can be viewed as the bound O(m−1/2+o(1)) on
the discrepancy of the points (2.5). Thus one can now apply Lemmas 2.5
and (2.6) to study the distribution of points on Ha,m in more complicated

DISTRIBUTION OF POINTS ON MODULAR HYPERBOLAS
165
domains than boxes [U +1, U +X]×[V +1, V +Y ] covered by Theorem 3.1.
For example, we immediately deduce that
#{(x, y) ∈Ha,m : x2 + y2 ⩽r2} = πr2ϕ(m)
4m2
+ O(m3/4+o(1)).
Furthermore, the asymptotic formula (3.1), combined with Lemma 2.4,
provides the most direct way to the following asymptotic formula
X
(x,y)∈Ha,m
(x −y)2ν =
1
(2ν + 1)(ν + 1)m2νϕ(m) + O
³
m2ν+1/2+o(1)´
(3.2)
which has been given in [82] (in a slightly more precise form, which can
also be obtained within our elementary arguments).
Similarly Theorem 3.1 and Lemma 2.4, imply that for any real positive
∆< m/2
X
(x,y)∈Ha,m
|x−y|⩽∆
1 = ∆(2m −∆)ϕ(m)
m2
+ O
³
m1/2+o(1)´
(3.3)
which is a version of a result of [83].
As we have mentioned, Theorem 3.1 uses very little speciﬁc information
about the congruence xy ≡a (mod m) and can be extended to many other
congruences. For prime m = p one can use the Bombieri bound [9] instead
of (1.1) and obtain exactly the same results in much more general settings.
For example, this has been done for solutions of polynomial congruences
modulo p and also for joint distribution of inverses modulo p of s linear
forms ajx + bj, j = 1, . . . , s, with integer coeﬃcients, see [14,16,18–21,36,
72,77,85,88] and references therein.
3.2. Points on Ha,m in Intervals on Average Over a
It is natural to expect that one can get stronger results than Theorem 3.1
on average over a.
This indeed is true, and it has been shown in the series of works [30,
33–35] that the congruence a ≡xy (mod p) is solvable for all but o(m)
values of a = 1, . . . , m −1, with x and y signiﬁcantly smaller than m3/4.
In particular, in [34], this is proved for x and y in the range 1 ⩽x, y ⩽
m1/2(log m)1+ε. Certainly this result is very sharp. Indeed, it has been
noticed in [30] that well known estimates for integers with a divisor in a
given interval (see [25,38]) immediately imply that for any ε > 0 almost all
residue classes modulo m are not of the form xy (mod m) with 1 ⩽x, y ⩽
m1/2(log m)κ−ε where κ is given by (2.7).

166
IGOR E. SHPARLINSKI
One can also derive from [26] (which in turn makes use of Lemma 2.8)
that for any ε > 0 the inequality
max{|x|, |y| : xy ≡1
(mod m)} ⩾m1/2(log m)κ/2(log log m)3/4−ε
holds:
• for all positive integers m ⩽M, except for possibly o(M) of them,
• for all prime m = p ⩽M except for possibly o(M/ log M) of them.
Similar questions about the ratios x/y, have also been studied, see [30,
34,61].
The result of [34] shows that almost all reduced classes modulo m can
be represented as xy with 1 ⩽x, y ⩽m1/2+ε. However, it does not imply
that these products are uniformly distributed in reduced residue classes,
which is some times required in applications.
In this respect, the following bound is a minor modiﬁcation of a result
of [68] and gives the desired uniformity of distribution for 1 ⩽x ⩽X,
V + 1 ⩽y ⩽V + Y provided that X, Y ⩾m1/2+ε for a ﬁxed ε > 0 and
suﬃcient large integer m. In turn, it is based on some ideas from [4].
Theorem 3.2. Let X = {1, . . . , X} and Y = {V + 1, . . . , V + Y } where
X, Y ⩾1 and V ⩾0 are arbitrary integers. Then for any integer m ⩾1,
m
X
a=1
gcd(a,m)=1
¯¯¯¯#Ha,m(X, Y) −XY ϕ(m)
m2
¯¯¯¯
2
≪X(X + Y )mo(1).
Proof. We rewrite the congruence xy ≡a (mod m) as y ≡ax−1 (mod m)
(where the inversion is taken modulo m). Using the identity (2.1), we write
#Ha,m(X, Y) = 1
m
X
X
x=1
gcd(x,m)=1
V +Y
X
y=V +1
X
−(m−1)/2⩽r⩽m/2
em
¡
r(ax−1 −y)
¢
= 1
m
X
−(m−1)/2⩽r⩽m/2
em(−rV )
X
X
x=1
gcd(x,m)=1
em
¡
arx−1¢
Y
X
y=1
em(−ry).
By Lemma 2.7, the main term corresponding to r = 0 is
1
m
X
X
x=1
gcd(x,m)=1
Y
X
y=1
1 = XY ϕ(m)
m2
+ O
³
Y m−1+o(1)´
.

DISTRIBUTION OF POINTS ON MODULAR HYPERBOLAS
167
Hence
#Ha,m(X, Y) −XY ϕ(m)
m2
≪1
mEa,m(X, Y ) + Y m−1+o(1),
where
Ea,m(X, Y ) =
X
1⩽|r|⩽m/2
¯¯¯¯¯¯¯
X
X
x=1
gcd(x,m)=1
em
¡
arx−1¢
¯¯¯¯¯¯¯
¯¯¯¯¯
Y
X
y=1
em(−ry)
¯¯¯¯¯ .
Using the Cauchy inequality we have
m
X
a=1
¯¯¯¯#Ha,m(X, Y) −XY ϕ(m)
m2
¯¯¯¯
2
⩽
1
m2
m
X
a=1
Ea,m(X, Y )2 + Y 2m−1+o(1).
(3.4)
We now put J = ⌊log(Y/2)⌋and deﬁne the sets
R0 =
n
r : 1 ⩽|r| ⩽m
Y
o
,
Rj =
n
r : ej−1 m
Y < |r| ⩽ej m
Y
o
,
j = 1, . . . , J,
RJ+1 =
n
r : eJ m
Y < |r| ⩽m/2
o
(we can certainly assume that J ⩾1 since otherwise the bound is trivial).
Applying the Cauchy inequality again, we deduce
Ea,m(X, Y )2 ⩽(J + 2)
J+1
X
j=0
Ea,m,j(X, Y )2,
(3.5)
where
Ea,m,j(X, Y ) =
X
r∈Rj
¯¯¯¯¯¯¯
X
X
x=1
gcd(x,m)=1
em
¡
arx−1¢
¯¯¯¯¯¯¯
¯¯¯¯¯
Y
X
y=1
em(−ry)
¯¯¯¯¯ .
Using (2.2), we conclude that that
Y
X
y=1
em(−ry) ≪e−jY.
for r ∈Rj, j = 0, . . . , J + 1. Thus
Ea,m,j(X, Y ) ≪e−jY
¯¯¯¯¯¯¯
X
r∈Rj
ϑr
X
X
x=1
gcd(x,m)=1
em
¡
arx−1¢
¯¯¯¯¯¯¯
,
j = 0, . . . , J+1,

168
IGOR E. SHPARLINSKI
for some complex numbers ϑr with |ϑr| ⩽1 for |r| ⩽m/2. Therefore,
m
X
a=1
Ea,m,j(X, Y )2 ≪e−2jY 2
m
X
a=1
¯¯¯¯¯¯¯
X
r∈Rj
ϑr
X
X
x=1
gcd(x,m)=1
em
¡
arx−1¢
¯¯¯¯¯¯¯
2
= e−2jY 2
X
r1,r2∈Rj
ϑr1ϑr2
X
X
|x1|,|x2|⩽X
gcd(x1x2,m)=1
m
X
a=1
em
¡
a
¡
r1x−1
1
−r2x−1
2
¢¢
.
Clearly the inner sum vanishes if r1x−1
1
̸≡r2x−1
2
(mod m) and is equal to
m otherwise. Therefore
m
X
a=1
Ea,m,j(X, Y )2 ≪e−2jY 2mTj,
(3.6)
where Tj is the number of solutions to the congruence
r1x2 ≡r2x1
(mod m),
r1, r2 ∈Rj, |x1|, |x2| ⩽X, gcd(x1x2, m) = 1.
We now see that if r1 and x2 are ﬁxed, then r2 and x1 are such that their
product s = r2x1 ≪ejmX/Y belongs to a prescribed residue class modulo
m. Thus there are at most O
¡
ejX/Y + 1
¢
possible values of s and for
each ﬁxed s ≪ejmX/Y there are τ(s) = mo(1) values of r1 and x2 with
s = r2x1, see (2.6). Therefore
Tj ⩽X#Rj
¡
ejX/Y + 1
¢
mo(1) = e2jX2m1+o(1)
Y 2
+ ejXm1+o(1)
Y
and after substitution into (3.6) we get
m
X
a=1
Ea,m,j(X, Y )2 ≪e−2jY 2mTj = X2m2+o(1) + e−jXY m2+o(1).
Substituting this bound in (3.5) and recalling (3.4), we conclude the
proof.
We note that the proof of Theorem 3.2 can easily be extended to ar-
bitrary sets X ⊆{1, . . . , X}, see [68]. However, it breaks down if x runs
through a short interval away from the origin. An alternative approach
has been suggested in [32] and is based on bounds of the 4th moment of
multiplicative character sums, see Lemma 2.3. If m = p is prime, it can
handle such shifted intervals X = {U + 1, . . . , U + X} (but not arbitrary
sets X ⊆{1, . . . , X} as that of [68]). Furthermore, the technique of [32]
leads to more explicit expressions instead of mo(1) in the error term. Thus,

DISTRIBUTION OF POINTS ON MODULAR HYPERBOLAS
169
although the approaches of [32] and [68] complement each other they still
leave some natural open questions.
Question 3.3. Extend Theorem 3.2 to sets X = {U + 1, . . . , U + X} with
arbitrary U.
As we have mentioned, if m = p, Question 3.3 is addressed in [32],
however the some of the necessary ingredients are not known for composite
m.
We also note that several results “on average” related to various modi-
ﬁcations of the Lehmer problem are given in [48,73,75,86,87].
Finally, we remark that #Ha,m(X, Y) has been studied in [17] for the
same sets as in Theorem 3.1, that is, for X = {1, . . . , X} and Y = {V +
1, . . . , V + Y }, but on average over V . It is shown in [17] that in this case
one can also obtain stronger bounds than that of Theorem 3.1.
3.3. Points on Ha,m in Sets with Arithmetic Conditions
Theorems 3.1 and 3.2 consider the case when x and y belong to sets of
consecutive integers. However, studying points on Ha,m in other sets is of
ultimate interest as well.
We start with a very simple observation that no general result of the
type of Theorems 3.1 and 3.2 applying to arbitrary sets X and Y is possible
(even for very massive sets X and Y). For example, if m = p is a prime
and X = Y consist of all (p −1)/2 quadratic residues modulo p, then
Ha,p(X, Y) = ∅for every quadratic nonresidue a.
The problem of distribution of pairs of primes (p, q) ∈Ha,m has been
considered in [24]. Unfortunately, it seems that even the Extended Riemann
Hypothesis is not powerful enough to get a satisfactory answer to this ques-
tion, see [24] for details. However it seems that the method of [64] can be
used to study points (x, y) ∈Ha,m with squarefree x and y.
Question 3.4. Obtain an asymptotic formula for
#{(x, y) ∈Ha,m(X, Y) : x and y are squarefree}
where X = {1, . . . , X} and Y = {1, . . . , Y } and 1 ⩽X, Y ⩽m are arbitrary
integers.
One can also study the distribution of points (x, y) ∈Hm(X, Y) with
some prescribed structure of prime factors. For example, let P+(k) and
P−(k) denote the largest and the smallest prime divisors of an integer k ⩾1.

170
IGOR E. SHPARLINSKI
Question 3.5. Obtain an asymptotic formula for
#{(x, y) ∈Ha,m(X, Y) : P+(xy) ⩽R}
and
#{(x, y) ∈Ha,m(X, Y) : P−(xy) ⩾r}
where X = {1, . . . , X} and Y = {1, . . . , Y } and 1 ⩽X, Y ⩽m are arbitrary
integers with R and r in reasonably large ranges.
We remark that using elementary sieving arguments one can extend the
result of Theorem 3.1 to counting (x, y) ∈Ha,m such that x is of the largest
possible multiplicative order modulo m (and thus so is y) which is given
by the Carmichael function λ(n). In particular, when m = p is a prime,
this addresses the problem of counting (x, y) ∈Ha,m where x is a primitive
root modulo p, for example, see [5,44]. Proofs of these results usually follow
the same standard lines as the proof of Theorem 3.1, except that instead
of (1.1) one uses the bound of the same strength on Kloosterman sums
twisted with multiplicative characters
X
(x,y)∈Hm
1⩽x,y⩽m
χ(x)em (rx + sy) ≪(m gcd(r, s, m))1/2+o(1) .
There are still some delicate issues of getting the mo(1) term as small as
possible.
Finally, we note that several very interesting results have recently been
obtained in [55] about points (x, y) ∈Ha,m such that x and y have restricted
g-ary expansions to some ﬁxed base g ⩾2.
4. Geometric Properties of Ha,m
4.1. Distances
We observe that the asymptotic formulas (3.2) and (3.3) have a natural in-
terpretation as the bounds on the power moments and the distribution func-
tion of the distances between an element x ∈{1, . . . , m} with gcd(x, m) = 1
and its modular inverse. Several results about the average (over a) value of
power moments can be found in [48–51], see also references therein.
We now deﬁne the width wa,m of the set Ha,m:
wa,m = max
©
|x −y| : (x, y) ∈Ha,m
ª
.
We also put
wm = w1,m

DISTRIBUTION OF POINTS ON MODULAR HYPERBOLAS
171
for the width of Hm, which has been the main object of study of [26,43,44].
Using Theorem 3.1 one easily derives that
wa,m = m + O(m3/4+o(1)).
(4.1)
Using the same arguments as in [44], one can obtain a more precise expres-
sion for the factor mo(1).
On the other hand, it has been noticed in [43] that
m −wm ≥
§
2
√
m −1
¨
with equality for all m of the form
m = k2 + ℓk + 1
(4.2)
with integers k and ℓsuch that k > 0, 0 ≤ℓ< 2
√
k + 1 and hence
lim inf
m→∞
m −wm
√m
= 2.
(4.3)
Question 4.1. Show that there are inﬁnitely many primes m = p of the
form (4.2) with 0 ≤ℓ< 2
√
k + 1.
As a curiosity, we recall the following, it has been noted in [26], that
m −wm ⩽
√
8m for all positive integers m = 2s with s ∈Z. Indeed, if s is
even, then m = (2s/2 −1)2 + 2(2s/2 −1) + 1 is of the form (4.2), if s is odd,
then this follows from
(2(s+1)/2 −1)(2s −2(s+1)/2 −1) ≡1
(mod 2s).
In the opposite direction it is shown in [26] that
lim sup
m→∞
m −wm
√m
= ∞.
(4.4)
Furthermore, analogues of (4.3) and (4.4) also hold for prime values m = p:
lim inf
p→∞
p −wp
√p
= 2
and
lim sup
p→∞
p −wp
√p
= ∞,
which follow from the following two results given in [26].
Theorem 4.1. For inﬁnitely many primes p, we have
p −wp ⩽2√p +
√p
log p.

172
IGOR E. SHPARLINSKI
Proof. Let ε = 1/(4 log Q). Using [10] one can show that for suﬃciently
large Q, there is a prime in the interval ((1 −ε)Q, Q] such that p −1 has
a divisor d in the interval ((1 −2ε)√Q, (1 −ε)√Q]. If we write p −1 = df,
then wp ⩾p −f −d. But, if Q is so large that ε ⩽0.01, then
f + d = p −1
d
+ d ⩽
x
(1 −2ε)√x + (1 −ε)√x ⩽(2 + 3ε)√p,
which implies the desired result.
Theorem 4.2. Let f(M) be any positive function tending monotonically
to zero as M →∞. Then the inequality
m −wm ⩾m1/2(log m)κ/2(log log m)3/4f(m)
holds:
• for all positive integers m ⩽M, except for possibly o(M) of them,
• for all prime m = p ⩽M except for possibly o(M/ log M) of them.
Proof. Let x be large and set
z = (log M)κ/2(log log M)3/4f(M/2).
It suﬃces to show m −wm ⩽zm1/2 for o(M) of integers m between M/2
and M. Without loss of generality, suppose f(M) ⩾1/ log log M for all
M > 10. We deﬁne Jk to be the set of positive integers m ∈(M/2, M]
for which m −wm ⩽ym1/2 and such that there are (x, y) ∈Hm with
dm = y −x and x(m −y) = km −1.
By the arithmetic-geometric mean inequality, for every m ∈Jk, we have
m −wm
2
= m −y + x
2
≥
p
x(m −y) =
√
km −1.
(4.5)
Thus Jk = ∅for k ⩾z2 + 1. Suppose 1 ⩽k < z2 + 1, m ∈Jk, (x, y) ∈Hm
and x(m −y) = km −1. Then
p
kM/2 −1 ⩽max(x, m −y) ⩽z
√
M.
By Lemma 2.8,
#Jk ⩽H(M,
p
kM/2 −1, z
√
M; Tk) ≪
kM(log(3z2/k))κ
ϕ(k)(log M)κ(log log M)3/2
which after simple calculations leads to the estimate
X
1⩽k<z2+1
#Jk = o(M)

DISTRIBUTION OF POINTS ON MODULAR HYPERBOLAS
173
and proves the ﬁrst part of the theorem.
The proof of the second part is completely analogous.
The following questions have been formulated as conjectures in [26]
where one can also ﬁnd some heuristic arguments in their support.
Question 4.2. Let g(M) be any positive function tending monotonically
to ∞as M →∞. Show that then the inequality
m −wm ⩽m1/2(log m)κ/2(log log m)3/4g(m)
holds:
• for all positive integers m ⩽M, except for possibly o(M) of them,
• for all prime m = p ⩽M except for possibly o(M/ log M) of them.
Question 4.3. Prove that m−wm ⩽m1/2(log m)κ/2+1/2+o(1) for m →∞.
Even a weaker form of Question 4.3 with just m1/2+o(1) is already of
great interest and would have some interesting applications, see [45].
Besides the extreme and average values of the distances between an
element and its modular inverse it is also interesting to study the number
of distinct diﬀerences between x and y for (x, y) ∈Ha,m.
Question 4.4. Estimate the cardinality of the set
Da,m = {|x −y| : (x, y) ∈Ha,m}.
Clearly Question 4.4 is equivalent to counting u = 0, . . . , m−1 for which
the quadratic congruence
x(x + u) ≡a
(mod m)
has a solution x with 1 ⩽x < m −u.
For prime m = p this question has been studied in [69] where an explicit
formula
#Da,p = 1
4
µ
p + 1 +
µa
p
¶ ³
1 + (−1)(p−1)/2´¶
.
is given, where (a/p) denotes the Legendre symbol of a modulo p. In [69]
the same question is also studied when x and y ranges over intervals, how-
ever the method of that work does not immediately apply to the case of
composite moduli m.
A similar question can also be asked about Euclidean distances between
distinct points of Ha,m and also between the origin and points of Ha,m.

174
IGOR E. SHPARLINSKI
Question 4.5. Estimate the cardinality of the sets
Ea,m = {
p
(x1 −x2)2 + (y1 −y2)2 : (x1, y1), (x2, y2) ∈Ha,m}
and
Fa,m = {
p
x2 + y2 : (x, y) ∈Ha,m}.
The author is grateful to Arne Winterhof for the observation that if
m = p is a prime then #Fa,p = (p−1)/2. Indeed if u ≡x2 +y2 (mod p) for
(x, y) ∈Ha,p then the congruence Z4 −uZ2 + a2 ≡0 (mod p) has exactly
four roots x, p−x, y, p−y (in particular, we have two double roots if x = y).
Since (p −x)2 + (p −y)2 ̸= x2 + y2 we have
#Fa,p = 1
2#Ha,p = p −1
2
.
(4.6)
Clearly, Theorem 3.1 can be used to obtain some lower bounds on #Da,m
and #Ea,m. For example, an easy modiﬁcation of an argument which leads
to the bound (4.1) yields
#Da,m ⩾m1/4+o(1).
However we are mostly interested in more precise results which should
certainly be based on some additional ideas.
Finally, we ask a question of a diﬀerent ﬂavour, which is about the
number of possible directions on the Euclidean plane deﬁned by the pairs
of distinct points (x1, y1), (x2, y2) ∈Ha,m.
Question 4.6. Estimate the cardinality of the set
La,m =
½x1 −x2
y1 −y2
: (x1, y1), (x2, y2) ∈Ha,m, (x1, y1) ̸= (x2, y2)
¾
.
Obviously Questions 4.5 and 4.6 are inﬂuenced by the Erd˝os and Kakeya
problems, respectively, see [13, Sections 5.3 and 7.1] and also surveys [12,42].
They can also be asked for points of Ha,m(X, Y) for various sets X and Y.
Finally, motivated by [6,7] and some other works one can also ask various
questions about the distribution of the angles of elevation arctan(y/x) of
points (x, y) ∈Ha,m(X, Y) over the horisontal line.
4.2. Convex Hull
We consider the convex closure Cm of the point set Hm. It is not hard to see
that Cm is always a convex polygon with nonempty interior, except when
m = 2, 3, 4, 6, 8, 12, 24, see [45].

DISTRIBUTION OF POINTS ON MODULAR HYPERBOLAS
175
Following [45], we denote by v(m) the number of vertices of Cm and by
V (M) its average value,
V (M) =
1
M −1
M
X
m=2
v(m).
Using Theorem 3.1, one can easily derive
v(m) ⩽m3/4+o(1).
(4.7)
Naturally, exactly as Theorem 3.1, the bound (4.7) can be extended to sets
of solutions of many other congruences.
More interestingly, one can obtain another bound, which is much better
in some cases and relies on more speciﬁc properties of Hm
v(m) ⩽T(m −1)mo(1),
(4.8)
see [45], where T(k) is deﬁned in §2.3.
The lower bound
v(m) ⩾2(τ(m −1) −1)
(4.9)
is also given in [45]. Furthermore, it is shown in [45] that in fact v(m) =
2(τ(m −1) −1) whenever T(m −1) ⩽5. Thus, this and the bound (4.8)
explain why Lemma 2.9 comes into play.
One can also ﬁnd in [45] several eﬃcient algorithms for computing v(m),
together with their complexity analysis.
Numerical calculations show that while the behaviour of v(m) is not
adequately described by any of the above bounds, the lower bound (4.9)
seems to be more precise than (4.7) and (4.8).
It is quite natural to view the points of Hm as being randomly dis-
tributed in the square [0, m] × [0, m] (which is supported by the theoretic
results which we have presented in §3.1 and 3.2) and then appeal to the fol-
lowing result of R´enyi and Sulanke [57, Satz 1]. Let R be a convex polygon
in the plane with r vertices and let Pi, i = 1, . . . , n, be n points chosen at
random in R with uniform distribution. Let Xn be the number of vertices
of the convex closure of the points Pi, and let E(Xn) be the expectation of
Xn. Then
E(Xn) = 2
3r(log n + γ) + cR + o(1),
(4.10)
where γ = 0.577215 . . . is the Euler constant, and cR depends on R and
is maximal when R is a regular r-gon or is aﬃne equivalent to a regular

176
IGOR E. SHPARLINSKI
r-gon. In particular, for the unit square R = [0, 1]2 we have
cR = −8
3 log 2.
Using (4.10) with r = 4, it seems plausible to conjecture that for most m
v(m) ≈h(m),
where
h(m) = 8
3(log ϕ(m) + γ −log 2).
However, surprisingly enough, the numerical results of [45] show that V (M)
deviates from
H(M) =
1
M −1
M
X
m=2
8
3(log ϕ(m)+γ −log 2) = 8
3(log M +γ +η −1−log 2),
where
η =
X
p prime
log(1 −1/p)
p
= −0.580058 . . . ,
quite signiﬁcantly, and is apparently larger than H(M) by a ﬁxed factor.
Some partial explanation to this phenomenon has been given in [45] and
suggests that for each m, the convex hull Cm, besides some “random” points,
also contains a “regular” component with 2(τ(m−1)−1) points associated
with divisors of m −1 whose average contribution
1
M −1
M
X
m=2
2(τ(m −1) −1) ∼2 log M
is of the same order of magnitude as the size of H(M).
It is also shown [45] that this aﬀect is speciﬁc to the points of Hm and
disappears for the convex hull of points on a “generic” curve which behaves
in much better agreement with (4.10) than v(m).
Clearly since (1, 1), (m −1, m −1) ∈Hm the diameter of Hm takes the
largest possible value
√
2(m −2). However for the other values of a the
question about the diameter of Ha,m is more interesting.
Question 4.7. Estimate the diameter
∆a,m = max{
p
(x1 −x2)2 + (y1 −y2)2 : (x1, y1), (x2, y2) ∈Ha,m}.

DISTRIBUTION OF POINTS ON MODULAR HYPERBOLAS
177
4.3. Visible Points
For two sets of integers X and Y we denote
Ga,m(X, Y) = #{(x, y) ∈Ha,m(X, Y) : gcd(x, y) = 1}
and also, following our usual agreement, we put Gm(X, Y) = G1,m(X, Y).
Clearly Ga,m(X, Y) is the set of points (x, y) ∈Ha,m(X, Y) which are
“visible” from the origin (that is, which are not “blocked” by other points
with integer coordinates).
The following estimate is obtained in [64] for Gm(X, Y) but its extension
to the general case is immediate and we present it here (in fact we also
simplify the argument).
Theorem 4.3. Let X = {1, . . . , X} and Y = {1, . . . , Y } where 1 ⩽X, Y ⩽
m are arbitrary integers. For all integers m, we have
#Ga,m(X, Y) = 6
π2 · XY
m
Y
p|m
µ
1 + 1
p
¶−1
+ O
³
X1/2Y 1/2m−1/4+o(1)´
,
where the product is taken over all prime numbers p | m.
Proof. For an integer z we let
Ha,m(z; X, Y) = {(x, y) ∈Ha,m(X, Y) : z | gcd(x, y)}.
By the inclusion-exclusion principle, we write
#Ga,m(X, Y) =
∞
X
z=1
µ(z)#Ha,m(z; X, Y).
Clearly
Ha,m(z; X, Y) = ∅
if gcd(z, m) > 1 or z > m. For gcd(z, m) = 1, writing
x = zs
and
y = zt,
(4.11)
we have
Ha,m(z; X, Y) = {(zs, zt) : st ≡az−2
(mod m),
1 ⩽s ⩽X/z, 1 ⩽t ⩽Y/z}.
Now, we deﬁne
R =
l
X1/2Y 1/2m−3/4m
and
Q =
l
X1/2Y 1/2m−1/2m
,

178
IGOR E. SHPARLINSKI
and note that
XY/Q2 ⩽m.
A variant of Theorem 3.1 gives
#Ha,m(z; X, Y) = XY ϕ(m)
z2m2
+ O
³
m1/2+o(1)´
,
which we apply for “small” z ⩽R.
We also note that for each z, the product r = st ⩽XY/z2, where
s and t are given by (4.11), belongs to a ﬁxed residue class modulo m
and thus can take at most XY/z2m + 1 possible values. For each ﬁxed
r ⩽XY/z2 ⩽XY ⩽m2, there are τ(r) = ro(1) = mo(1) pairs (s, t) of
integers s and t with r = st, see (2.6). Therefore,
#Ha,m(z; X, Y) ⩽
µ XY
z2m + 1
¶
mo(1),
which we apply for “medium” z with Q ⩾z > R.
Finally, we note that Lemma 2.1 with gives the bound
m
X
z=1
gcd(z,m)=1
em(Az−2 + Bz) ≪gcd(A, B, m)1/2m1/2+o(1).
Using the same arguments as in the proof of Theorem 3.1, we deduce that
for the number of positive integers z ⩽Z with az−2 ≡w (mod m) with
some w ⩽W is ZW + O(m1/2+o(1)).
We now note that az−2 ≡r (mod m) where, as before,
r = st ⩽XY/z2 ⩽XY/Q2 ⩽m.
Furthermore, for every z the value of r is uniquely deﬁned and leads to at
most τ(r) = mo(1) possible pairs (s, t). Hence, the total contribution from
“large” z ⩾Q can be estimated as
X
m⩾z⩾Q
#Ha,m(z; X, Y) ⩽
⌈2 log m⌉
X
ν=0
X
2ν+1Q>z⩾2νQ
#Ha,m(z; X, Y)
⩽
⌈2 log m⌉
X
ν=0
µ
2ν+1Q ·
XY
(2νQ)2 + m1/2+o(1)
¶
mo(1)
⩽
⌈2 log m⌉
X
ν=0
µ XY
2νQ + m1/2+o(1)
¶
mo(1) = XY
Q mo(1).

DISTRIBUTION OF POINTS ON MODULAR HYPERBOLAS
179
Combining the above bounds and recalling our choice of R and Q (which
optimises the error term), we derive the desired result.
In particular, under the conditions of Theorem 4.3
#Ga,m(X, Y) ∼6
π2 · XY
m
Y
p|m
µ
1 + 1
p
¶−1
provided that XY ⩾m3/2+ε for some ﬁxed ε > 0.
There is little doubt that our approach can also be used to obtain asymp-
totic formulas for (x, y) ∈Ha,m(X, Y) with arbitrary integer a, and also
the sums
X
(x,y)∈Hm(X,Y)
|µ(xy)|
and
X
(x,y)∈Hm(X,Y)
|µ(x)µ(y)|
(4.12)
under the same conditions on the sets X and Y as in Theorem 4.3, see also
Question 3.4. However, we do not have any approaches to the following
problem.
Question 4.8. Extend Theorem 4.3 to intervals of the form
X = {U + 1, . . . , U + X}
and
Y = {V + 1, . . . , V + Y }
with arbitrary U and V .
It is also interesting to study sums of other arithmetic functions on
(x, y) ∈Hm(X, Y).
Question 4.9. For intervals
X = {U + 1, . . . , U + X}
and
Y = {V + 1, . . . , V + Y }
of length X, Y ⩽m,
• obtain nontrivial bounds for the sums
X
(x,y)∈Hm(X,Y)
µ(xy)
and
X
(x,y)∈Hm(X,Y)
µx
y
¶
,
where (x/y) is the Jacobi symbol of x modulo y, which we also extend
to even values of y by simply putting (x/y) = 0 in this case;
• obtain asymptotic formulas for the sums
X
(x,y)∈Hm(X,Y)
ϕ(|x −y|)
and
X
(x,y)∈Hm(X,Y)
ω(|x −y|).

180
IGOR E. SHPARLINSKI
5. Applications
5.1. Lehmer Problem
One of the most natural and immediate applications of the uniformity of
distribution results outlined in §3.1 is a positive solution to the Lehmer
problem, see [37, Problem F12], about the joint distribution of the parity
of x and y for (x, y) ∈Ha,m(X, Y) with some intervals
X = {U + 1, . . . , U + X}
and
Y = {V + 1, . . . , V + Y }.
This distribution is naturally expected to be close to uniform (that is, each
parity combination is taken about in 25% of the cases) for any odd m and
suﬃciently large X and Y . The Lehmer problem can easily be reformulated
as a question about the cardinality of #Ha,m( e
X, eY) for some a and some
other sets e
X and eY of about X/2 and Y/2 consecutive integers, respectively.
Indeed, we are interested in solutions to the congruence
(2ex + ϑ1)(2ey + ϑ2) ≡1
(mod m)
with some ﬁxed ϑ1, ϑ2 ∈{0, 1} and
U + 1 −ϑ1
2
⩽ex ⩽U + X −ϑ1
2
,
V + 1 −ϑ2
2
⩽ey ⩽V + Y −ϑ2
2
.
It remains to notice that the above congruence is equivalent to
(ex + 2−1ϑ1)(ey + 2−1ϑ2) ≡4−1
(mod m)
(where the inversion is taken modulo m), which after a shift of variables
takes the desired shape.
Close links between the Lehmer problem and bounds of Kloosterman
sums has been ﬁrst observed in [79,80]. The question and the above ap-
proach have been extended in several directions. Accordingly, instead of
the bound (1.1) more general bounds of incomplete or multiple Kloost-
erman sums are used, see [2,19,20,48,49,51,52,75,81–84,86] and references
therein. However, it has turned out that for multivariate analogues of the
Lehmer problem, and a number of similar questions, bounds of character
sums provide a more eﬃcient tool than Kloosterman sums, see [67], where
Lemmas 2.2 and 2.3 and the bound (2.4) have been used to improve several
previous results.
5.2. Distribution of Angles in Some Point Sets
A version of Theorem 3.1 has been used in [7] to study the distribution
of angles between visible points (viewed from the origin) in a dilation of

DISTRIBUTION OF POINTS ON MODULAR HYPERBOLAS
181
a certain plain region Ω∈[0, 1]2. More precisely, for Ω∈[0, 1]2 and a
suﬃciently large Q, we deﬁne
ΩQ = {(Qα, Qβ) : (α, β) ∈Ω)}.
We now consider #FΩ(Q) angles between the horisontal line and the points
of the set
FΩ(Q) = {(x, y) ∈ΩQ ∩Z2 : gcd(x, y) = 1}.
The distribution of this angles is studied in [7] and shown to exhibit some-
what unexpected behaviour.
A slight generalisation of Theorem 3.1 has also played an important role
in a study of angles deﬁned by some other point set [6], see also [8].
5.3. Sums of Divisor Functions over Arithmetic
Progressions
For example, the strength of estimates on the error terms in asymptotic
formulas for sums of some divisor functions over an arithmetic progression
is closely related to the precision of our knowledge of #Ha,m(X, Y), where
X and Y are sets of consecutive integers, see [4,27,28]. This link becomes
transparent if one recalls that a standard approach to evaluating divisor
sums is approximating the hyperbolic region {(x, y) : x, y ⩾0, xy ⩽N}
by a union of “small” rectangles. In fact, as we have mentioned, the proof
of Theorem 3.2 is based on some ideas of [4].
5.4. Sato-Tate Conjecture in the “Vertical” Aspect
We also recall that Theorem 3.2 about the distribution of points on Ha,m
on average over a have been used in studying the so-called “vertical” aspect
of the Sato-Tate conjecture for Kloosterman sums, see [68]. The relation is
provided by the identity Km(r, s) = Km(1, rs) which holds if gcd(r, m) = 1.
Clearly for the complex conjugated sum we have
Km(r, s) = Km(−r, −s) = Km(r, s),
hence we see that Km(r, s) is real. Since by the Weil bound, see [39], for
any prime p, we have
|Kp(r, s)| ⩽2√p,
gcd(r, s, p) = 1,
we can now deﬁne the angles ψp(r, s) by the relations
Kp(r, s) = 2√p cos ψp(r, s)
and
0 ⩽ψp(r, s) ⩽π.

182
IGOR E. SHPARLINSKI
The famous Sato–Tate conjecture asserts that, in the “horizontal” as-
pect, that is, for any ﬁxed non-zero integers r and s, the angles ψp(r, s) are
distributed according to the Sato–Tate density
µST (α, β) = 2
π
Z β
α
sin2 γ dγ,
see [39, Section 21.2]. More precisely, if πr,s(α, β; T) denotes the number of
primes p ⩽T with α ⩽ψp(r, s) ⩽β, where, as usual π(T) denotes the total
number of primes p ⩽T, the Sato–Tate conjecture predicts that
πr,s(α, β; T) ∼µST (α, β)π(T),
T →∞,
(5.1)
for all ﬁxed real 0 ⩽α < β ⩽π, see [39, Section 21.2]. We remark that for
elliptic curves, the Sato-Tate conjecture in its original (and the most diﬃ-
cult) “horizontal” aspect has recently been settled [70], but it still remains
open for Kloosterman sums. It is shown in [68] that Theorem 3.2 implies
that
1
4RS
X
0<|r|⩽R
X
0<|s|⩽S
πr,s(α, β; T) ∼µST (α, β)π(T)
provided RS ⩾T 1+ε for some ﬁxed ε > 0.
5.5. Torsion of Elliptic Curves
A variant of Theorem 3.1 has been obtained in [54] and applied to estimat-
ing torsion of elliptic curves. More precisely, let E be an elliptic curve over
an algebraic number ﬁeld K of degree d over Q. It is shown in [54] that if
E contains a point of prime order p then
p ⩽d3d2.
5.6. Approximations by Sums of Two Rationals
Following [15], we consider the problem of obtaining an upper bound on
the approximation of a real α by s rational fractions with denominators at
most Q, that is for
δα,s(Q) =
min
1⩽q1,...,qs⩽Q
¯¯¯¯α −r1
q1
−. . . −rs
qs
¯¯¯¯
with positive integers q1, . . . , qs ⩽Q. The question is motivated by the
Dirichlet theorem on rational approximations which corresponds to the case
s = 1.

DISTRIBUTION OF POINTS ON MODULAR HYPERBOLAS
183
It is shown in [15] that for s = 2 the results on the distribution of points
on Hm,a are directly related to this question and imply nontrivial bounds
on δα,2(Q).
It is natural to expect that there are also links between δα,s(Q) and
multivariate analogues of the sets Hm,a.
5.7. SL2(Fp) Matrices of Bounded Height
For a ﬁnite ﬁeld Fp of p elements and a positive integer T ⩽(p −1)/2, we
use Np(T) to denote the number of matrices
µu v
x y
¶
∈SL2(Fp)
with |u|, |v|, |x|, |y| ⩽T (we assume that Fp is represented by the elements
of the set {0, ±1, . . . , ±(p −1)/2}).
Clearly
Np(T) =
X
a∈Fp
#Ha+1,p(T , T )#Ha,p(T , T )
where T = {0, ±1, . . . , ±T} and also #H0,p(T , T ) = 4T + 1.
It has been shown in [1] that using the identity
X
a∈Fp
#Ha,p(T , T ) = (2T + 1)2
and Theorem 3.2, one can derive that
Np(T) = (2T + 1)4
p
+ O
³
T 2po(1)´
which is nontrivial if T ⩾p1/2+ε for any ﬁxed ε > 0 and suﬃciently large
p. We remark that this is an Fp analogue of the results of similar spirit
for matrices over Z and algebraic number ﬁelds, see [23,58] and references
therein.
5.8. Computing Discrete Logarithms and Factoring
It has been discovered in [62] that the distribution of points on hyperbolas
Ha,m has direct links with analysis of some discrete logarithm algorithms.
Namely, analysis of the algorithm from [62] rests on a weaker version of
Theorem 3.2 obtained in [61].
Question 5.1. Study whether Theorem 3.2 can be used to improve some
of the results of [62].

184
IGOR E. SHPARLINSKI
A new deterministic integer factorisation algorithm has recently been
suggested in [59]. Its analysis depends on a variant of Theorem 3.1.
6. Concluding Remarks
6.1. Generalisations
Multidimensional variants of the above problems have also been considered
and in principle one can use bounds of multidimensional Kloosterman sums
to study the distribution of solutions to the congruence
x1 . . . xs ≡a
(mod m)
(6.1)
in the same fashion as in the case of two variables. However, it has turned
out that in many cases bounds of multiplicative character sums lead to much
stronger results. For examples, in [67], using the bounds of Lemmas 2.2
and 2.3 and the bound (2.4), an improvement is given of some results of [2]
on generalised Lehmer problem. Similar ideas have also led in [65] to some
other results on distribution of solutions to (6.1). For instance, let ∆s,a,m
denote the discrepancy of the s-dimensional points
³x1
m , . . . , xs
m
´
∈[0, 1]s,
x1 . . . xs ≡a
(mod m), 1 ⩽x1, . . . , xs ⩽m.
It is shown in [65] that
∆s,a,m ⩽
½ m−1/2+o(1)
if s = 3,
m−1+o(1)
if s ⩾4.
It is worth noticing that one has to be careful with posing multidimen-
sional generalisations, which sometimes lead to rather simple questions for
s ⩾3 (despite that for s = 2 they are nontrivial at all). For example, it has
been noticed in [65] that often such generalisations do not need any ana-
lytic technique used in [78] but follows immediately from a very elementary
argument.
Another unexplored line of research is in the direction of function ﬁeld
generalisations, which conceivably should admit results of the same strength
or maybe even stronger. For example, a polynomial analogue of the conjec-
ture of [24] could be more accessible.
Question 6.1. Let Fq be a ﬁnite ﬁeld of q elements. Given an irreducible
polynomial F(X) ∈Fq[X] of suﬃciently large degree d, show that for any
polynomial A(X) ∈Fq[X], relatively prime to F(X), there are two irre-
ducible polynomials G(X), H(X) ∈Fq[X] of degree at most d such that
G(X)H(X) ≡A(X)
(mod F(X)).

DISTRIBUTION OF POINTS ON MODULAR HYPERBOLAS
185
Finally, we believe that it is interesting to explore how much of the the-
ory developed for modular hyperbolas can be extended to modular circles
Ca,m = {(x, y) : x2 + y2 ≡a
(mod m)}.
Well known parallels between the properties of integer points on hyperbolas
and circles on the Euclidean plane, suggest that many of the results obtained
for Ha,m can be extended to Ca,m.
6.2. Further Improvements
We have seen that bounds of Kloosterman sums play a prominent role in
this ﬁeld. It would be interesting to ﬁnd some applications of bounds of
very short incomplete Kloosterman sums from [11,40,41,46,53,66].
In [76,85] some questions are studied about the distribution of residues
modulo m of powers (xk, yk) taken over all (x, y) ∈Ha,m. These results can
be substantially extended and improved if one uses Lemma 2.1. In particu-
lar, Lemma 2.1 immediately implies that the error term in the asymptotic
formula of [85] for the quantity N(k, q) can be lowered from q3/4+o(1) to
q1/2+o(1). It may also be extended and generalised in various directions.
All these results can be obtained by combining Lemma 2.1 with standard
arguments like those used in the proof of Theorem 3.1.
References
1. O. Ahmadi and I. E. Shparlinski, Distribution of matrices with restricted
entries over ﬁnite ﬁelds, Preprint, 2006.
2. E. Alkan, F. Stan and A. Zaharescu, Lehmer k-tuples, Proc. Amer. Math.
Soc., 134 (2006), 2807–2815.
3. A. Ayyad, T. Cochrane and Z. Zheng, The congruence x1x2 ≡x3x4 (mod p),
the equation x1x2 = x3x4 and the mean value of character sums, J. Number
Theory, 59 (1996), 398–413.
4. W. D. Banks, R. Heath-Brown and I. E. Shparlinski, On the average value
of divisor sums in arithmetic progressions, Intern. Math. Research Notices,
2005 (2005), 1–25.
5. J. Beck and M. R. Khan, On the uniform distribution of inverses modulo n,
Period. Math. Hung., 44 (2002), 147–155.
6. F. P. Boca, On the distribution of angles between geodesic rays associated
with hyperbolic lattice points, Preprint, 2006.
7. F. P. Boca, C. Cobeli and A. Zaharescu, Distribution of lattice points visible
from the origin, Commun. Math. Phys., 213 (2000), 433–470.
8. F. P. Boca and A. Zaharescu, Farey fractions and two-dimensional tori, Non-
commutative Geometry and Number Theory, Aspects of Mathematics E37,
Vieweg Verlag, Wiesbaden, 2006, 57–77.

186
IGOR E. SHPARLINSKI
9. E. Bombieri, On exponential sums in ﬁnite ﬁelds, Amer. J. Math., 88 (1966),
71–105.
10. E. Bombieri, J. Friedlander and H. Iwaniec, Primes in arithmetic progressions
to large moduli, III, J. Amer. Math. Soc., 2 (1989), 215–224.
11. J. Bourgain, More on the sum-product phenomenon in prime ﬁelds and its
applications, Intern. J. Number Theory, 1 (2005), 1–32.
12. J. Bourgain, New encounters in combinatorial number theory: From the
Kakeya problem to cryptography, Perspectives in Analysis, Mathematical
Physics Studies, vol. 27, Springer-Verlag, Berlin, 2005, 17–26.
13. P. Brass, W. Moser and J. Pach, Research problems in discrete geometry,
Springer, New York, 2005.
14. T. H. Chan, Distribution of diﬀerence between inverses of consecutive integers
modulo p, Integers, 4 (2004), Paper A03, 1–11.
15. T. H. Chan, Approximating reals by sums of two rationals, Preprint, 2006.
16. C. Cobeli, S. Gonek and A. Zaharescu, The distribution of patterns of inverses
modulo a prime, J. Number Theory, 101 (2003), 209–222.
17. C. Cobeli, M. Vˆajˆaitu and A. Zaharescu, Average estimates for the number
of tuples of inverses modp in short intervals, Bull. Math. Soc. Sci. Math.
Roumanie., 43 (2000), 155–164.
18. C. Cobeli, M. Vˆajˆaitu and A. Zaharescu, Distribution of gaps between the
inverses
mod q, Proc. Edinb. Math. Soc., 46 (2003), 185–203.
19. C. Cobeli and A. Zaharescu, The order of inverses
mod q, Mathematika, 47
(2000), 87–108.
20. C. Cobeli and A. Zaharescu, Generalization of a problem of Lehmer,
Manuscr. Math., 104 (2001), 301–307.
21. C. Cobeli and A. Zaharescu, On the distribution of the Fp-points on an aﬃne
curve in r dimensions, Acta Arithmetica, 99 (2001), 321–329.
22. M. Drmota and R. Tichy, Sequences, discrepancies and applications,
Springer-Verlag, Berlin, 1997.
23. W. Duke, Z. Rudnick and P. Sarnak, Density of integer points on aﬃne
homogeneous varieties, Duke Math. J., 71 (1993), 143–179.
24. P. Erd˝os, A. M. Odlyzko and A. S´ark˝ozy, On the residues of products of
prime numbers, Period. Math. Hung., 18 (1987), 229–239.
25. K. Ford, The distribution of integers with a divisor in a given interval, Ann.
Math., (to appear).
26. K. Ford, M. R. Khan, I. E. Shparlinski and C. L. Yankov, On the maximal
diﬀerence between an element and its inverse in residue rings, Proc. Amer.
Math. Soc., 133 (2005), 3463–3468.
27. J. B. Friedlander and H. Iwaniec, Incomplete Kloosterman sums and a divisor
problem, Ann. of Math., 121 (1985), 319–350.
28. J. B. Friedlander and H. Iwaniec, The divisor problem for arithmetic pro-
gressions, Acta Arith., 45 (1985), 273–277.
29. A. Fujii and Y. Kitaoka, On plain lattice points whose coordinates are recip-
rocals modulo a prime, Nagoya Math. J., 147 (1997), 137–146.
30. M. Z. Garaev, Character sums in short intervals and the multiplication table
modulo a prime, Monatsh. Math., 148 (2006), 127–138.

DISTRIBUTION OF POINTS ON MODULAR HYPERBOLAS
187
31. M. Z. Garaev, On the logarithmic factor in error term estimates in certain
additive congruence problems, Acta Arith., 124 (2006), 27–39.
32. M. Z. Garaev and V. Garcia, The equation x1x2 = x3x4 +λ in ﬁelds of prime
order and applications, Preprint, 2007.
33. M. Z. Garaev and A. A. Karatsuba, On character sums and the exceptional
set of a congruence problem, J. Number Theory, 114 (2005), 182–192.
34. M. Z. Garaev and A. A. Karatsuba, The representation of residue classes by
products of small integers, Proc. Edin. Math. Soc., (to appear).
35. M. Z. Garaev and K.-L. Kueh, Distribution of special sequences modulo a
large prime, Int. J. Math. Math. Sci., 50 (2003), 3189–3194.
36. A. Granville, I. E. Shparlinski and A. Zaharescu, On the distribution of
rational functions along a curve over Fp and residue races, J. Number Theory,
112 (2005), 216–237.
37. R. K. Guy, Unsolved problems in number theory, Springer-Verlag, Berlin,
1994.
38. R. Hall and G. Tenenbaum , Divisors, Cambridge Tracts in Math. 90, Cam-
bridge Univ. Press, 1988.
39. H. Iwaniec and E. Kowalski, Analytic number theory, Amer. Math. Soc.,
Providence, RI, 2004.
40. A. A. Karatsuba, Fractional parts of functions of a special form, Izv. Ross.
Akad. Nauk Ser. Mat. (Transl. as Russian Acad. Sci. Izv. Math.), (4)55
(1995), 61–80 (in Russian).
41. A. A. Karatsuba, Analogues of Kloosterman sums, Izv. Ross. Akad. Nauk
Ser. Mat. (Transl. as Russian Acad. Sci. Izv. Math.), (5)55 (1995), 93–102
(in Russian).
42. N. Katz and T. Tao, Recent progress on the Kakeya conjecture, Proceed-
ings of the 6th International Conference on Harmonic Analysis and Partial
Diﬀerential Equations Publ Matem., U. Barcelona, 2002, 161–180.
43. M. R. Khan, Problem 10736: An optimization with a modular constraint,
Amer. Math. Monthly, 108 (2001), 374–375.
44. M. R. Khan and I. E. Shparlinski, On the maximal diﬀerence between an
element and its inverse modulo n, Period. Math. Hung., 47 (2003), 111–117.
45. M. R. Khan, I. E. Shparlinski and C. L. Yankov, On the convex closure of
the graph of modular inversions, Preprint, 2006.
46. M. A. Korolev, Incomplete Kloosterman sums and their applications, Izv.
Ross. Akad. Nauk Ser. Mat. (Transl. as Russian Acad. Sci. Izv. Math.), (6)64
(2000), 41–64.
47. M. Laczkovich, Discrepancy estimates for sets with small boundary, Studia
Sci. Math. Hungar., 30 (1995), 105–109.
48. H. N. Liu and W. Zhang, On a problem of D. H. Lehmer, Acta Math. Sinica,
22 (2006), 61–68.
49. H. N. Liu and W. Zhang, Hybrid mean value on the diﬀerence between a
quadratic residue and its inverse modulo p, Publ. Math. Debrecen, 69 (2006),
227–243.
50. H. N. Liu and W. Zhang, General Kloosterman sums and the diﬀerence
between an integer and its inverse modulo q, Acta Math. Sinica, 23 (2007),

188
IGOR E. SHPARLINSKI
77–82.
51. H. N. Liu and W. Zhang, Mean value on the diﬀerence between a quadratic
residue and its inverse modulo p, Acta Math. Sinica, 23 (2007), 915–924.
52. S. R. Louboutin, J. Rivat and A. S´ark¨ozy, On a problem of D. H. Lehmer,
Proc. Amer. Math. Soc., 135 (2007), 969–975.
53. W. Luo, Bounds for incomplete hyper-Kloosterman sums, J. Number Theory,
75 (1999), 41–46.
54. L. Merel, Bornes pour la torsion des courbes elliptiques sur les corps de
nombres, Invent. Math., 124 (1996), 437–449.
55. N. G. Moshchevitin, On numbers with missing digits: Solvability of the con-
gruences x1x2 ≡λ (mod p), Doklady Akad. Nauk, 410 (2006), 730–733 (in
Russian).
56. H. Niederreiter and J. M. Wills, Diskrepanz und Distanz von Massen
bezuglich konvexer und Jordanscher Mengen, Math. Z., 144 (1975), 125–134.
57. A. R´enyi and R. Sulanke, ¨Uber die Konvexe H¨ulle von n Zuf¨allig Gewa¨ahlten
Punkten, Z. Wahrscheinlichkeitstheorie, 2 (1963), 75–84.
58. C. Roettger, Counting invertible matrices and uniform distribution, J.
Th´eorie Nombres Bordeaux, 17 (2005), 301–322.
59. M. Rubinstein, Hide and seek – A naive factoring algorithm, Preprint, 2006.
60. ´E. Saias, Entiers ´a Diviseurs Denses 1, J. Number Theory, 62 (1997), 163–
191.
61. I. A. Semaev, On the number of small solutions of a linear homogeneous
congruence, Mat. Zametki, 50 (1991), no.4, 102–107, (in Russian).
62. I. A. Semaev, An algorithm for evaluation of discrete logarithms in some
nonprime ﬁnite ﬁelds, Math. Comp., 67 (1998), 1679–1689.
63. I. E. Shparlinski, On exponential sums with sparse polynomials and rational
functions, J. Number Theory, 60 (1996), 233–244.
64. I. E. Shparlinski, Primitive points on a modular hyperbola, Bull. Polish Acad.
Sci. Math., 54 (2006), 193–200.
65. I. E. Shparlinski, On the distribution of points on multidimensional modular
hyperbolas, Proc. Japan Acad. Sci., Ser.A, 83 (2007), 5–9.
66. I. E. Shparlinski, Bounds of incomplete multiple Kloosterman sums, J. Num-
ber Theory, (to appear).
67. I. E. Shparlinski, On a generalisation of a Lehmer problem, Preprint, 2006.
68. I. E. Shparlinski, Distribution of inverses and multiples of small integers and
the Sato–Tate conjecture on average, Preprint, 2006.
69. I. E. Shparlinski and A. Winterhof, Distances between the points on modular
hyperbolas, J. Number Theory, (to appear).
70. R. Taylor, Automorphy for some l-adic lifts of automorphic mod l represen-
tations, II, Preprint, 2006.
71. G. Tenenbaum, Introduction to analytic and probabilistic number theory,
Cambridge Univ. Press, 1995.
72. M. Vajaitu and A. Zaharescu, Distribution of values of rational maps on the
Fp-points on an aﬃne curve, Monatsh. Math., 136 (2002), 81–86.
73. Y. Weili, On the generalization of the D. H. Lehmer problem and its mean
value, J. Algebra Number Theory and Appl., 6 (2006), 479–491.

DISTRIBUTION OF POINTS ON MODULAR HYPERBOLAS
189
74. H. Weyl, On the volume of tubes, Amer. J. Math., 61 (1939), 461–472.
75. Z. Xu and W. Zhang, On a problem of D. H. Lehmer over short intervals, J.
Math. Anal. Appl., 320 (2006), 756–770.
76. Y. Yi and W. Zhang, On the generalization of a problem of D. H. Lehmer,
Kyushu J. Math., 56 (2002), 235–241.
77. A. Zaharescu, The distribution of the values of a rational function modulo a
big prime, J. Theor. Nombres Bordeaux, bf 15 (2003), 863–872.
78. T. Zhang and W. Zhang, A generalization on the diﬀerence between an in-
teger and its inverse modulo q, II, Proc. Japan Acad. Sci., Ser.A, 81 (2005),
7–11.
79. W. Zhang, On a problem of D. H. Lehmer and its generalization, Compos.
Math., 86 (1993), 307–316.
80. W. Zhang, On a problem of D. H. Lehmer and its generalization, II, Compos.
Math., 91 (1994), 47–56.
81. W. Zhang, On the diﬀerence between a D. H. Lehmer number and its inverse
modulo q, Acta Arith., 68 (1994), 255–263.
82. W. Zhang, On the diﬀerence between an integer and its inverse modulo n, J.
Number Theory, 52 (1995), 1–6.
83. W. Zhang, On the distribution of inverses modulo n, J. Number Theory, 61
(1996), 301–310.
84. W. Zhang, On a problem of P. Gallagher, Acta Math. Hung., 78 (1998),
345–357.
85. W. Zhang, On the distribution of inverses modulo p, Acta Arith., 100 (2001),
189–194.
86. W. Zhang, On a problem of D. H. Lehmer and Kloosterman sums, Monatsh.
Math., 139 (2003), 247–257.
87. W. Zhang, Z. Xu and Y. Yi, A problem of D. H. Lehmer and its mean square
value formula, J. Number Theory, 103 (2003), 197–213.
88. Z. Zheng, The distribution of zeros of an irreducible curve over a ﬁnite ﬁeld,
J. Number Theory, 59 (1996), 106–118.

190
A SURVEY OF PROBLEMS AND RESULTS
ON RESTRICTED SUMSETS
ZHI-WEI SUN
Department of Mathematics, Nanjing University,
Nanjing 210093, China
E-mail: zwsun@nju.edu.cn
Additive number theory is currently an active ﬁeld related to combinatorics. In
this paper we give a survey of problems and results concerning lower bounds
for cardinalities of various restricted sumsets with elements in a ﬁeld or an
abelian group.
1. Erd˝os-Heilbronn conjecture and the polynomial method
Let A = {a1, . . . , ak} and B = {b1, . . . , bl} be two ﬁnite subsets of Z with
a1 < · · · < ak and b1 < · · · < bl. Observe that
a1 + b1 < a2 + b1 < · · · < ak + b1 < ak + b2 < · · · < ak + bl,
whence we see that the sumset
A + B = {a + b: a ∈A and b ∈B}
contains at least k + l −1 elements. In particular, |2A| ≥2|A| −1, where
|A| denotes the cardinality of A, and 2A stands for A + A.
The following fundamental theorem was ﬁrst proved by A. Cauchy [9]
in 1813 and then rediscovered by H. Davenport [11] in 1935.
Cauchy-Davenport Theorem. Let A and B be non-empty subsets of the
ﬁeld Z/pZ where p is a prime. Then
|A + B| ≥min{p, |A| + |B| −1}.
(1.1)
For lots of important results on sumsets over Z, the reader is referred to
the recent book [38] by T. Tao and V. H. Vu. In this paper we mainly focus
our attention on restricted sumsets with elements in a ﬁeld or an abelian
group.

A SURVEY OF PROBLEMS AND RESULTS ON RESTRICTED SUMSETS
191
In combinatorics, for a ﬁnite sequence {Ai}n
i=1 of sets, a sequence
{ai}n
i=1 is called a system of distinct representatives of {Ai}n
i=1 if a1 ∈
A1, . . . , an ∈An and a1, . . . , an are distinct. A fundamental theorem of P.
Hall [17] states that {Ai}n
i=1 has a system of distinct representatives if and
only if | S
i∈I Ai| ≥|I| for all I ⊆{1, . . . , n}. The reader may consult [31]
for a simple proof of Hall’s theorem.
In 1964 P. Erd˝os and H. Heilbronn [13] made the following challenging
conjecture.
Erd˝os-Heilbronn Conjecture. Let p be a prime, and let A be a non-
empty subset of the ﬁeld Z/pZ. Then |2∧A| ≥min{p, 2|A| −3}, where
2∧A = {a + b : a, b ∈A and a ̸= b}.
This conjecture remained open until it was conﬁrmed by Dias da Silva
and Y. Hamidoune [12] thirty years later, with the help of the representation
theory of groups.
For a general ﬁeld F, the additive order of the (multiplicative) identity of
F is either inﬁnite or a prime, which we denote by p(F). The characteristic
of the ﬁeld F is deﬁned as follows:
ch(F) =
½ p
if p(F) is a prime p,
0
if p(F) = ∞.
(1.2)
Now we state Dias da Silva and Y. Hamidoune’s extension of the Erd˝os-
Heilbronn conjecture.
Dias da Silva–Hamidoune Theorem ([12]). Let F be a ﬁeld, and let
n ∈Z+ = {1, 2, 3, . . .}. Then, for any ﬁnite subset A of F, we have
|n∧A| ≥min{p(F), n|A| −n2 + 1},
(1.3)
where n∧A denotes the set of all sums of n distinct elements of A.
If p is a prime, A ⊆Z/pZ and |A| > √4p −7, then by the Dias da
Silva–Hamidoune theorem, any element of Z/pZ can be written as a sum of
⌊|A|/2⌋distinct elements of A (see [12]), where ⌊·⌋is the well-known ﬂoor
function.
In 1995–1996 N. Alon, M. B. Nathanson and I. Z. Ruzsa [4,5] developed
a polynomial method rooted in [6] to prove the Erd˝os-Heilbronn conjecture
and some similar results. The method turns out to be very powerful and
has many applications in number theory and combinatorics.
Now we introduce the above-mentioned polynomial method. We begin
with a lemma.

192
ZHI-WEI SUN
Lemma 1.1 (Alon, Nathanson and Ruzsa [4,5]). Let F be a ﬁeld and
let A1, . . . , An be ﬁnite non-empty subsets of F. Let f(x1, . . . , xn) ∈
F[x1, . . . , xn] have degree smaller than ki = |Ai| in xi for each i = 1, . . . , n.
If f(a1, . . . , an) = 0 for all a1 ∈A1, . . . , an ∈An, then f(x1, . . . , xn) is
identically zero.
This lemma can be proved by using induction on n and noting that a
non-zero polynomial P(x) ∈F[x] of degree smaller than a positive integer
k cannot have k distinct zeros in F.
The central part of the polynomial method is the following important
principle formulated by Alon in 1999.
Combinatorial Nullstellensatz (Alon [1]). Let A1, . . . , An be ﬁnite sub-
sets of a ﬁeld F, and let f(x1, . . . , xn) ∈F[x1, . . . , xn].
(i) Set gi(x) = Q
a∈Ai(x −a) for i = 1, . . . , n. Then
f(a1, . . . , an) = 0 for all a1 ∈A1, . . . , an ∈An
(1.4)
if and only if there are h1(x1, . . . , xn), . . . , hn(x1, . . . , xn) ∈F[x1, . . . , xn]
with deg hi ≤deg f −deg gi for i = 1, . . . , n, such that
f(x1, . . . , xn) =
n
X
i=1
gi(xi)hi(x1, . . . , xn).
(1.5)
(ii) Suppose that deg f = k1 + · · · + kn where 0 ≤ki < |Ai| for i =
1, . . . , n. If (1.4) holds then
[xk1
1 · · · xkn
n ]f(x1, . . . , xn) = 0,
where [xk1
1 · · · xkn
n ]f(x1, . . . , xn) denotes the coeﬃcient of xk1
1 · · · xkn
n
in
f(x1, . . . , xn).
Proof. (i) If there are h1(x1, . . . , xn), . . . , hn(x1, . . . , xn) ∈F[x1, . . . , xn]
such that (1.5) holds, then for any a1 ∈A1, . . . , an ∈An we have
f(a1, . . . , an) =
n
X
i=1
gi(ai)hi(a1, . . . , an) = 0.
Now we consider the converse. Write
f(x1, . . . , xn) =
X
j1,...,jn≥0
fj1,...,jnxj1
1 . . . xjn
n
and
xj = gi(x)qij(x) + r(j)
i (x),

A SURVEY OF PROBLEMS AND RESULTS ON RESTRICTED SUMSETS
193
where qij(x), r(j)
i (x) ∈F[x] and deg r(j)
i (x) < deg gi(x) = |Ai|. Note that
both r(j)
i (x) and gi(x)qij(x) = xj −r(j)
i (x) have degree not exceeding j.
Clearly
f(x1, . . . , xn) =
X
j1,...,jn⩾0
j1+···+jn⩽deg f
fj1,...,jn
n
Y
i=1
³
gi(xi)qiji(xi) + r(ji)
i
(xi)
´
= ¯f(x1, . . . , xn) +
n
X
i=1
gi(xi)hi(x1, . . . , xn),
where
¯f(x1, . . . , xn) =
X
j1,...,jn≥0
fj1,...,jn
n
Y
i=1
r(ji)
i
(xi)
and each hi(x1, . . . , xn) is a suitable polynomial over F with deg gi +
deg hi ≤deg f. If a1 ∈A1, . . . , an ∈An, then
¯f(a1, . . . , an) =
X
j1,...,jn≥0
fj1,...,jn
n
Y
i=1
aji
i = f(a1, . . . , an) = 0.
Since the degree of ¯f(x1, . . . , xn) in xi is smaller than |Ai|, by Lemma 1.1
the polynomial ¯f(x1, . . . , xn) is identically zero. Therefore (1.5) holds.
(ii) By part (i) we can write
f(x1, . . . , xn) =
n
X
i=1
gi(xi)hi(x1, . . . , xn)
with hi(x1, . . . , xn) ∈F[x1, . . . , xn] and deg hi ≤deg f −deg gi. Since k1 +
· · · + kn = deg f and ki < |Ai| for i = 1, . . . , n, we have
[xk1
1 · · · xkn
n ]f(x1, . . . , xn) =
n
X
i=1
[xk1
1 · · · xkn
n ]x|Ai|
i
hi(x1, . . . , xn) = 0.
This concludes the proof.
Here is a useful lemma implied by the Combinatorial Nullstellensatz.
ANR Lemma ([5]). Let A1, . . . , An be ﬁnite subsets of a ﬁeld F with
ki = |Ai| > 0 for i = 1, . . . , n. Let f(x1, . . . , xn) ∈F[x1, . . . , xn] \ {0} and
deg f ≤Pn
i=1(ki −1). If
[xk1−1
1
· · · xkn−1
n
]f(x1, . . . , xn)(x1 + · · · + xn)
Pn
i=1(ki−1)−deg f ̸= 0,
(1.6)

194
ZHI-WEI SUN
then
|{a1+· · ·+an: ai ∈Ai, f(a1, . . . , an) ̸= 0}| ≥
n
X
i=1
(ki−1)−deg f +1. (1.7)
Proof. Assume that C = {a1 + · · · + an: ai ∈Ai, f(a1, . . . , an) ̸= 0} has
cardinality not exceeding K = Pn
i=1(ki −1) −deg f. Then the polynomial
P(x1, . . . , xn) := f(x1, . . . , xn)(x1 + · · · + xn)K−|C| Y
c∈C
(x1 + · · · + xn −c)
is of degree Pn
i=1(ki −1) with the coeﬃcient of xk1−1
1
· · · xkn−1
n
non-zero.
Applying the second part of the Combinatorial Nullstellensatz, we ﬁnd that
P(a1, . . . , an) ̸= 0 for some a1 ∈A1, . . . , an ∈An. This is impossible since
a1 + · · · + an ∈C if f(a1, . . . , an) ̸= 0.
We remark that a variant of this lemma appeared in Q. H. Hou and Z.
W. Sun [18].
Alon-Nathanson-Ruzsa Theorem ([5]). Let A1, . . . , An be ﬁnite non-
empty subsets of a ﬁeld F with |A1| < · · · < |An|. Then, for the set
A1 ∔· · · ∔An =
½
n
X
i=1
ai: ai ∈Ai, and ai ̸= aj if i ̸= j
¾
,
(1.8)
we have
|A1 ∔· · · ∔An| ≥min
½
p(F),
n
X
i=1
|Ai| −n(n + 1)
2
+ 1
¾
.
(1.9)
This follows from the ANR lemma and the following fact: If k1, . . . , kn ∈
Z+, then
[xk1−1
1
· · · xkn−1
n
]
Y
1≤i<j≤n
(xj −xi) × (x1 + · · · + xn)
Pn
i=1 ki−n(n+1)/2
= (k1 + · · · + kn −n(n + 1)/2)!
(k1 −1)! · · · (kn −1)!
Y
1≤i<j≤n
(kj −ki).
(1.10)
The Dias da Silva–Hamidoune theorem can be deduced from the ANR
theorem in the following way: Suppose that |A| = k ≥n. Let A1, . . . , An
be subsets of A with cardinalities k −n + 1, k −n + 2, . . . , k respectively.
By the ANR theorem,
|A1 ∔· · · ∔An| ≥min
½
p(F),
n
X
i=1
(|Ai| −i) + 1
¾
= min{p(F), (k −n)n + 1}.

A SURVEY OF PROBLEMS AND RESULTS ON RESTRICTED SUMSETS
195
As n∧A ⊇A1 ∔· · · ∔An, the desired inequality (1.3) follows.
In addition, the reader may also consult [24], [3] and [38] for the polyno-
mial method, and [34] for its connections with covers of Z by residue classes
and zero-sum problems on abelian p-groups.
2. Various sumsets with polynomial restrictions
By a sophisticated induction argument (cf. [7] and [30]), it can be shown
that if A1, . . . , An are ﬁnite subsets of Z with |A1| ≤· · · ≤|An| and |Ai| ≥i
for all i = 1, . . . , n, then
|A1 ∔· · · ∔An| ≥1 +
n
X
i=1
min
i≤j≤n(|Aj| −j).
Now we state a result on sumsets with linear restrictions over Z.
Theorem 2.1 (Z. W. Sun [30]). Let A1, . . . , An be ﬁnite subsets of Z,
and let V be a ﬁnite set of quin-tuples (s, t, µ, ν, w) with 1 ≤s, t ≤n, s ̸= t,
µ, ν ∈Z \ {0} and w ∈Z. If each Vi = {(s, t, µ, ν, w) ∈V : i ∈{s, t}} has
cardinality smaller than |Ai|, then
|{a1 + . . . + an : ai ∈Ai, and µai + νaj ̸= w if (i, j, µ, ν, w) ∈V }|
≥
n
X
i=1
|Ai| −2|V | −n + 1 = 1 +
n
X
i=1
(|Ai| −|Vi| −1) > 0.
(2.1)
Clearly Theorem 2.1 has the following consequence.
Corollary 2.1 (Z. W. Sun [30]). Let A1, . . . , An be ﬁnite subsets of Z
with |Ai| ≥2n −1 for all i = 1, . . . , n. Then
¯¯¯¯
½
n
X
i=1
ai : ai ∈Ai, ai ̸= ±aj if i ̸= j
¾¯¯¯¯ ≥
n
X
i=1
|Ai| −2n2 + n + 1.
(2.2)
All the remaining theorems in this section have been obtained via the
polynomial method. Preceding a theorem we usually state a lemma which
makes the method applicable.
Lemma 2.1. Let k, m, n be integers with m ≥0, n > 1 and k > m(n −1).
(i) (Q. H. Hou and Z. W. Sun [18]) We have
[xk−1
1
· · · xk−1
n
]
Y
1⩽i<j⩽n
(xi −xj)2m · (x1 + · · · + xn)(k−1−m(n−1))n
= (−1)mn(n−1)/2 ((k −1 −m(n −1))n)!
(m!)n
n
Y
j=1
(jm)!
(k −1 −(j −1)m)!.
(2.3)

196
ZHI-WEI SUN
(ii) (Z. W. Sun and Y. N. Yeh [37]) If m > 0 then
[xk−n
1
· · · xk−1
n
]
Y
1≤i<j≤n
(xi −xj)2m−1 · (x1 + · · · + xn)(k−1−m(n−1))n
= (−1)(m−1)n(n−1)/2 ((k −1 −m(n −1))n)!
(m!)nn!
n
Y
j=1
(jm)!
(k −1 −(j −1)m)!.
(2.4)
Theorem 2.2. Let k, m ∈N = {0, 1, 2, . . .} and n ∈Z+. Let F be a ﬁeld
with p(F) > max{mn, (k −1 −m(n −1))n}, and let A1, . . . , An be ﬁnite
subsets of F with max1≤i≤n |Ai| = k. Set
C = {a1 + · · · + an: a1 ∈A1, . . . , an ∈An, ai −aj ̸∈Sij if i < j},
where Sij (1 ≤i < j ≤n) are subsets of F.
(i) (Q. H. Hou and Z. W. Sun [18]) If |A1| = · · · = |An| = k, and
|Sij| ≤2m for all 1 ≤i < j ≤n, then we have |C| ≥(k−1−m(n−1))n+1.
(ii) (Z. W. Sun and Y. N. Yeh [37]) If |Ai| = k −n + i for i = 1, . . . , n,
and |Sij| < 2m for all 1 ≤i < j ≤n, then |C| ≥(k −1 −m(n −1))n + 1.
The following conjecture posed by Z. W. Sun in [18] is open even for
the rational ﬁeld.
Conjecture 2.1 (Z. W. Sun, 2002). Let A1, . . . , An be ﬁnite non-empty
subsets of a ﬁeld F. For 1 ≤i < j ≤n, let Sij and Sji be ﬁnite subsets of
F with |Sij| ≡|Sji| (mod 2). Then
|{a1 + · · · + an: a1 ∈A1, . . . , an ∈An, ai −aj ̸∈Sij if i ̸= j}|
≥min
½
p(F),
n
X
i=1
|Ai| −
X
1≤i<j≤n
(|Sij| + |Sji|) −n + 1
¾
.
(2.5)
Lemma 2.2 (J. X. Liu and Z. W. Sun [23]). Let k, m, n ∈Z+ with
k −1 ≥m(n −1). Then
[xk−n
1
· · · xk−1
n
]
Y
1≤i<j≤n
(xm
j −xm
i ) · (x1 + · · · + xn)(k−1)n−(m+1)(
n
2)
= (−m)(
n
2)
((k −1)n −(m + 1)
¡n
2
¢
)!1!2! · · · (n −1)!
(k −1)!(k −1 −m)! · · · (k −1 −(n −1)m)!.
(2.6)
Theorem 2.3 (J. X. Liu and Z. W. Sun [23]). Let k, m, n ∈Z+ with
k > m(n −1), and let A1, . . . , An be subsets of a ﬁeld F such that
|An| = k and |Ai+1| −|Ai| ∈{0, 1} for i = 1, . . . , n −1.

A SURVEY OF PROBLEMS AND RESULTS ON RESTRICTED SUMSETS
197
Let P1(x), . . . , Pn(x) ∈F[x] be monic and of degree m. If p(F) > (k−1)n−
(m + 1)
¡n
2
¢
, then
|{a1 + · · · + an: ai ∈Ai, and Pi(ai) ̸= Pj(aj) if i ̸= j}|
≥(k −1)n −(m + 1)
µn
2
¶
+ 1.
(2.7)
Here we pose the following conjecture.
Conjecture 2.2. Under the conditions of Theorem 2.3, we have
|{a1 + · · · + an: ai ∈Ai, and Pi(ai) ̸= Pj(aj) if i ̸= j}| ≥p(F)
if p(F) ≤(k −1)n −(m + 1)
¡n
2
¢
.
Lemma 2.3 (Z. W. Sun [33]). Let R be a commutative ring with iden-
tity. Let A = (aij)1≤i,j≤n be a matrix over R, and let det(A) = |aij|1≤i,j≤n
be the determinant of A. Let k, m1, . . . , mn ∈N.
(i) If m1 ≤· · · ≤mn ≤k, then we have
[xk
1 · · · xk
n]|aijxmi
j |1≤i,j≤n(x1 + · · · + xn)kn−Pn
i=1 mi
= (kn −Pn
i=1 mi)!
Qn
i=1(k −mi)! det(A).
(2.8)
(ii) If m1 < · · · < mn ≤k then
[xk
1 · · · xk
n]|aijxmi
j |1⩽i,j⩽n
Y
1⩽i<j⩽n
(xj −xi) ·
µ
n
X
s=1
xs
¶kn−(
n
2)−Pn
i=1 mi
(2.9)
= (−1)(
n
2)
(kn −
¡n
2
¢
−Pn
i=1 mi)!
Qn
i=1
Q
mi<j⩽k
j̸=mi+1,...,mn
(j −mi)per(A),
where per(A) is the permanent ∥aij∥1≤i,j≤n = P
σ∈Sn a1,σ(1) · · · an,σ(n) and
Sn is the symmetric group of all the permutations on {1, . . . , n}.
(iii) Suppose that K = kn −Pn
i=1(li + mi) ≥0 where l1, . . . , ln ∈N.
Then
[xk
1 · · · xk
n]|aijxli
j |1≤i,j≤n|xmi
j |1≤i,j≤n(x1 + · · · + xn)K
=[xk
1 · · · xk
n]|aijxmi
j |1≤i,j≤n|xli
j |1≤i,j≤n(x1 + · · · + xn)K.
(2.10)
Theorem 2.4 (Z. W. Sun [33]). Let k, m, n ∈Z+ with k greater than
m(n −1), and let A1, . . . , An be subsets of a ﬁeld F with cardinality k. Let

198
ZHI-WEI SUN
P1(x), . . . , Pn(x) ∈F[x] have degree m with leading coeﬃcients b1, . . . , bn
respectively.
(i) Suppose that b1, . . . , bn are distinct. If p(F) > (k −1)n −m
¡n
2
¢
, then
¯¯¯¯
½
n
X
i=1
ai: a1 ∈A1, . . . , an ∈An, and Pi(ai) ̸= Pj(aj) if i ̸= j
¾¯¯¯¯
≥(k −1)n −m
µn
2
¶
+ 1.
(2.11)
(ii) Assume that the permanent ∥bi−1
j
∥1≤i,j≤n does not vanish. If p(F)
is greater than (k −1)n −(m + 1)
¡n
2
¢
, then
¯¯¯¯
½
n
X
i=1
ai: ai ∈Ai, ai ̸= aj and Pi(ai) ̸= Pj(aj) if i ̸= j
¾¯¯¯¯
≥(k −1)n −(m + 1)
µn
2
¶
+ 1.
(2.12)
(iii) We have ∥bi−1
j
∥1≤i,j≤n ̸= 0, if F is the complex ﬁeld C, b1, . . . , bn
are qth roots of unity, and n! does not belong to the set
D(q) =
½ X
p|q
pxp: xp ∈{0, 1, 2, . . .} for any prime divisor p of q
¾
.
Now we raise the following conjecture.
Conjecture 2.3. When F is a ﬁeld with p(F) ≤(k−1)n−m
¡n
2
¢
, the right-
hand side of the inequality (2.11) in Theorem 2.4(i) should be replaced by
p(F). Similarly, when F is a ﬁeld with p(F) ≤(k −1)n −(m + 1)
¡n
2
¢
,
the right-hand side of the inequality (2.12) in Theorem 2.4(ii) should be
replaced by p(F).
The following lemma has the same ﬂavor as Lemma 2.3, but it was only
recently noted and applied by the author.
Lemma 2.4 (Z. W. Sun [35]). Let R be a commutative ring with iden-
tity. Let A = (aij)1≤i,j≤n be a matrix over R, and let per(A) = ∥aij∥1≤i,j≤n
be the permanent of A. Let k, m1, . . . , mn ∈N.
(i) If m1 ≤· · · ≤mn ≤k, then we have
[xk
1 · · · xk
n]∥aijxmi
j ∥1≤i,j≤n(x1 + · · · + xn)kn−Pn
i=1 mi
= (kn −Pn
i=1 mi)!
Qn
i=1(k −mi)! per(A).
(2.13)
(ii) If m1 < · · · < mn ≤k then

A SURVEY OF PROBLEMS AND RESULTS ON RESTRICTED SUMSETS
199
[xk
1 · · · xk
n]∥aijxmi
j ∥1⩽i,j⩽n
Y
1⩽i<j⩽n
(xj −xi) ·
µ
n
X
s=1
xs
¶kn−(
n
2)−Pn
i=1 mi
= (−1)(
n
2)
(kn −
¡n
2
¢
−Pn
i=1 mi)!
Qn
i=1
Q
mi<j⩽k
j̸=mi+1,...,mn
(j −mi) det(A).
(2.14)
(iii) Suppose that K = kn −Pn
i=1(li + mi) ≥0 where l1, . . . , ln ∈N.
Then
[xk
1 · · · xk
n]∥aijxli
j ∥1≤i,j≤n|xmi
j |1≤i,j≤n(x1 + · · · + xn)K
=[xk
1 · · · xk
n]∥aijxmi
j ∥1≤i,j≤n|xli
j |1≤i,j≤n(x1 + · · · + xn)K
(2.15)
and also
[xk
1 · · · xk
n]∥aijxli
j ∥1≤i,j≤n∥xmi
j ∥1≤i,j≤n(x1 + · · · + xn)K
=[xk
1 · · · xk
n]∥aijxmi
j ∥1≤i,j≤n∥xli
j ∥1≤i,j≤n(x1 + · · · + xn)K.
(2.16)
Theorem 2.5 (Z. W. Sun [35]). Let A1, . . . , An be ﬁnite subsets of a
ﬁeld F
with |A1|
=
· · ·
=
|An|
=
k
>
m(n −1) where m
∈
Z+, and let P1(x), . . . , Pn(x)
∈
F[x] have degree at most m with
[xm]P1(x), . . . , [xm]Pn(x) distinct. If p(F) > (k −1)n −(m + 1)
¡n
2
¢
, then
the restricted sumset
½
n
X
i=1
ai : ai ∈Ai, ai ̸= aj for i ̸= j, and ∥Pj(aj)i−1∥1≤i,j≤n ̸= 0
¾
(2.17)
has cardinality at least (k −1)n −(m + 1)
¡n
2
¢
+ 1 > (m −1)
¡n
2
¢
.
Conjecture 2.4. Under the conditions of Theorem 2.5, if p(F) ≤(k −
1)n −(m + 1)
¡n
2
¢
then the restricted sumset in (2.17) has cardinality at
least p(F).
Corollary 2.2 (Z. W. Sun [35]). Let A1, . . . , An and B = {b1, . . . , bn}
be subsets of a ﬁeld with cardinality n. Then there are distinct a1 ∈
A1, . . . , an ∈An such that the permanent ∥(ajbj)i−1∥1≤i,j≤n is non-zero.
Theorem 2.6 (Z. W. Sun [35]). Let h, k, l, m, n be positive integers sat-
isfying
k −1 ≥m(n −1) and l −1 ≥h(n −1).
Let F be a ﬁeld with p(F) > max{K, L}, where
K = (k −1)n −(m + 1)
µn
2
¶
and L = (l −1)n −(h + 1)
µn
2
¶
.

200
ZHI-WEI SUN
Assume that c1, . . . , cn ∈F are distinct and A1, . . . , An, B1, . . . , Bn are
subsets of F with
|A1| = · · · = |An| = k and |B1| = · · · = |Bn| = l.
Let P1(x), . . . , Pn(x), Q1(x), . . . , Qn(x) ∈F[x] be monic polynomials with
deg Pi(x) = m and deg Qi(x) = h for i = 1, . . . , n. Then, for any S, T ⊆
F with |S| ≤K and |T| ≤L, there exist a1 ∈A1, . . . , an ∈An, b1 ∈
B1, . . . , bn ∈Bn such that a1 + · · · + an ̸∈S, b1 + · · · + bn ̸∈T, and also
aibici ̸= ajbjcj, Pi(ai) ̸= Pj(aj), Qi(bi) ̸= Qj(bj) if 1 ≤i < j ≤n. (2.18)
Lemma 2.5 (Z. W. Sun [35]). Let k, m, n ∈Z+ with k −1 ⩾m(n −1).
Then
[xk−1
1
· · ·xk−1
n
]
Y
1⩽i<j⩽n
(xj −xi)2m−1(xjyj −xiyi) · (x1 + · · · + xn)N
= (−1)m(
n
2) (mn)!N!
(m!)nn!
n−1
Y
r=0
(rm)!
(k −1 −rm)! · ∥yi−1
j
∥1⩽i,j⩽n, (2.19)
where N = (k −1 −m(n −1))n.
Theorem 2.7 (Z. W. Sun [35]). Let k, m, n be positive integers with k−
1 ≥m(n−1), and let F be a ﬁeld with p(F) > max{mn, (k−1−m(n−1))n}.
Assume that c1, . . . , cn ∈F are distinct, and A1, . . . , An, B1, . . . , Bn are
subsets of F with |A1| = · · · = |An| = k and |B1| = · · · = |Bn| = n. Let
Sij ⊆F with |Sij| < 2m for all 1 ≤i < j ≤n. Then there are distinct
b1 ∈B1, . . . , bn ∈Bn such that the restricted sumset
S = {a1 + · · · + an : ai ∈Ai, ai −aj ̸∈Sij and aibici ̸= ajbjcj if i < j}
(2.20)
has at least (k −1 −m(n −1))n + 1 elements.
3. Snevily’s conjecture and additive theorems
Suppose that {a1, . . . , an}, {b1, . . . , bn} and {a1 + b1, . . . , an + bn} are com-
plete systems of residues modulo n. Let σ = 0+1+· · ·+(n−1) = n(n−1)/2.
Since Pn
i=1(ai + bi) = Pn
i=1 ai + Pn
i=1 bi, we have σ ≡σ + σ (mod n) and
hence 2 ∤n.
In 1999 H. S. Snevily [28] made the following interesting conjecture.
Snevily’s Conjecture. Let G be an additive abelian group with |G| odd.
Let A and B be subsets of G with cardinality n > 0. Then there is a number-
ing {ai}n
i=1 of the elements of A and a numbering {bi}n
i=1 of the elements
of B such that a1 + b1, . . . , an + bn are distinct.

A SURVEY OF PROBLEMS AND RESULTS ON RESTRICTED SUMSETS
201
Theorem 3.1. (i) (N. Alon [2]) Let p be an odd prime and A be a non-
empty subset of Z/pZ with cardinality n < p. For any given b1, . . . , bn ∈
Z/pZ, we can ﬁnd a numbering {ai}n
i=1 of the elements of A such that the
sums a1 + b1, · · · , an + bn are distinct.
(ii) (Q. H. Hou and Z. W. Sun [18]) Let k ≥n ≥1 be integers, and let
F be a ﬁeld with p(F) > max{n, (k −n)n}. Let A1, . . . , An be subsets of F
with cardinality k, and let b1, . . . , bn be elements of F. Then the restricted
sumset
{a1 + · · · + an: ai ∈Ai, ai ̸= aj and ai + bi ̸= aj + bj if i ̸= j}
has more than (k −n)n elements.
Note that part (ii) in the case k = n and A1 = · · · = An yields part (i).
In order to get part (i) by the polynomial method, Alon noted that
[xn−1
1
· · · xn−1
n
]
Y
1≤i<j≤n
(xj −xi)(xj + bj −(xi + bi)) = (−1)n(n−1)/2n!.
Part (ii) is a consequence of Theorem 2.2(i) (due to Hou and Sun) with
m = 1.
Theorem 3.2 (Dasgupta, K´arolyi, Serra and Szegedy [10]).
Snevily’s conjecture holds for any cyclic group of odd order.
Proof. (Dasgupta, K´arolyi, Serra and Szegedy). Let m > 0 be any odd
integer. As 2ϕ(m) ≡1 (mod m) by Euler’s theorem, the multiplicative
group of the ﬁnite ﬁeld with order 2ϕ(m) has a cyclic subgroup of order m.
Thus, in view of the Combinatorial Nullstellensatz, Snevily’s conjecture for
the cyclic group of order m follows from the following statement: If F is a
ﬁeld of characteristic 2 and b1, . . . , bn are distinct elements of F ∗= F \{0},
then
c := [xn−1
1
· · · xn−1
n
]
Y
1≤i<j≤n
(xj −xi)(bjxj −bixi) ̸= 0.
In fact,
Y
1⩽i<j⩽n
(xj −xi)(bjxj −bixi)
= (−1)(
n
2)|xn−i
j
|1⩽i,j⩽n|bi−1
j
xi−1
j
|1⩽i,j⩽n (Vandermonde)
= (−1)(
n
2) X
σ∈Sn
sign(σ)
n
Y
i=1
xn−i
σ(i) ·
X
τ∈Sn
sign(τ)
n
Y
i=1
bi−1
τ(i)xi−1
τ(i),

202
ZHI-WEI SUN
where sign(σ) (the sign of σ) is 1 or −1 according as σ ∈Sn is even or odd.
Therefore
(−1)(
n
2)c =
X
τ∈Sn
n
Y
i=1
bi−1
τ(i)
=
X
τ∈Sn
sign(τ)
n
Y
i=1
bi−1
τ(i) (because ch(F) = 2)
=|bi−1
j
|1⩽i,j⩽n =
Y
1⩽i<j⩽n
(bj −bi) ̸= 0.
It is well known that all ﬁnite subgroups of the multiplicative group
of a ﬁeld are cyclic. On the other hand, Z. W. Sun [33] observed that
any ﬁnitely generated abelian group whose ﬁnite subgroups are all cyclic,
can be embedded in the unit group of the ring of algebraic integers in
a suitable cyclotomic ﬁeld, which allows us to view it as a subgroup of
the multiplicative group C∗of non-zero complex numbers. So we have the
following lemma.
Lemma 3.1. Let G be a ﬁnitely generated abelian group. Then the torsion
group
Tor(G) = {a ∈G : a has a ﬁnite order}
(3.1)
is cyclic if and only if there is a ﬁeld F such that the multiplicative group
F ∗= F \ {0} contains a subgroup isomorphic to G.
This lemma, together with Theorem 2.4, enabled the author to establish
the following theorem which extends both Theorem 3.1 and Theorem 3.2.
Theorem 3.3 (Z. W. Sun [33]). Let G be an additive abelian group
whose ﬁnite subgroups are all cyclic. Let m, n be positive integers and let
b1, . . . , bn be elements of G. Assume that A1, . . . , An are ﬁnite subsets of G
with cardinality k > m(n −1).
(i) If b1, . . . , bn are distinct, then there are at least (k −1)n −m
¡n
2
¢
+ 1
multi-sets {a1, . . . , an} such that ai ∈Ai for i = 1, . . . , n and all the mai+bi
are distinct.
(ii) The sets
{{a1, . . . , an}: ai ∈Ai, ai ̸= aj and mai + bi ̸= maj + bj if i ̸= j}
(3.2)
and
{{a1, . . . , an}: ai ∈Ai, mai ̸= maj and ai + bi ̸= aj + bj if i ̸= j}
(3.3)

A SURVEY OF PROBLEMS AND RESULTS ON RESTRICTED SUMSETS
203
have more than (k −1)n −(m +1)
¡n
2
¢
≥(m −1)
¡n
2
¢
elements, provided that
b1, . . . , bn are distinct and of odd order, or they have ﬁnite order and n!
cannot be written in the form P
p∈P pxp where all the xp are non-negative
integers and P is the set of primes dividing one of the orders of b1, . . . , bn.
In Snevily’s conjecture the abelian group is required to have odd order.
For a general abelian group G with cyclic torsion subgroup, what additive
properties can we impose on several subsets of G with cardinality n?
Lemma 3.1 and Theorem 2.6 together yield the following result.
Theorem 3.4 (Z. W. Sun [35]). Let G be an additive abelian group
with cyclic torsion subgroup. Let h, k, l, m, n ∈Z+ with k > m(n −
1) and l > h(n −1). Assume that c1, . . . , cn ∈G are distinct, and
A1, . . . , An, B1, . . . , Bn are subsets of G with |A1| = · · · = |An| = k
and |B1| = · · · = |Bn| = l. Then, for any sets S and T with |S| ≤
(k −1)n −(m + 1)
¡n
2
¢
and |T| ≤(l −1)n −(h + 1)
¡n
2
¢
, there are
a1 ∈A1, . . . , an ∈An, b1 ∈B1, . . . , bn ∈Bn such that {a1, . . . , an} ̸∈S,
{b1, . . . , bn} ̸∈T, and also
ai + bi + ci ̸= aj + bj + cj, mai ̸= maj, hbi ̸= hbj if 1 ≤i < j ≤n. (3.4)
Corollary 3.1 (Z. W. Sun [35]). Let G be an additive abelian group
with cyclic torsion subgroup, and let A1, . . . , An, B1, . . . , Bn and C =
{c1, . . . , cn} be ﬁnite subsets of G with the same cardinality n > 0. Then
there are distinct a1 ∈A1, . . . , an ∈An and distinct b1 ∈B1, . . . , bn ∈Bn
such that all the sums a1 + b1 + c1, . . . , an + bn + cn are distinct.
Proof. Just apply Theorem 3.4 with k = l = n and m = h = 1.
In contrast with Snevily’s conjecture, Corollary 3.1 in the case A1 =
· · · = An = A and B1 = · · · = Bn = B is of particular interest. Here we
state a general additive theorem.
Theorem 3.5 (Z. W. Sun [35]). Let G be any additive abelian group
with cyclic torsion subgroup, and let A1, . . . , Am be subsets of G with the
same cardinality n ∈Z+. If m is odd or all the elements of Am are of odd
order, then the elements of Ai (1 ≤i ≤m) can be listed in a suitable order
ai1, . . . , ain, so that all the sums Pm
i=1 aij (1 ≤j ≤n) are distinct.
Sun [35] also noted that Theorem 3.5 with m odd cannot be extended
to general abelian groups since there are counter-examples for the Klein
quaternion group Z/2Z ⊕Z/2Z.

204
ZHI-WEI SUN
A line of a square, an n × n matrix, is a row or column of the matrix.
We deﬁne a line of an n × n × n cube in a similar way. A Latin cube over
a set S of cardinality n is an n × n × n cube whose entries come from the
set S and no line of which contains a repeated element. A transversal of
an n × n × n cube is a collection of n cells no two of which lie in the same
line. A Latin transversal is a transversal whose cells contain no repeated
element.
Corollary 3.2 (Z. W. Sun [35])). ( Let N be any positive integer. For
the N × N × N Latin cube over Z/NZ formed by the Cayley addition table,
each n × n × n sub-cube with n ≤N contains a Latin transversal.
Proof. Just apply Theorem 3.5 with m = 3 (or Corollary 3.1) to the cyclic
group Z/NZ.
In contrast, Theorem 3.2 has the following equivalent version observed
by Snevily [28]: Let N be a positive odd integer. For the N ×N Latin square
over Z/NZ formed by the Cayley addition table, each of its sub-squares
contains a Latin transversal.
Conjecture 3.1 (Z. W. Sun [35]).
Every n×n×n Latin cube contains
a Latin transversal.
4. On a conjecture of Lev and related results
Let A and B be ﬁnite non-empty subsets of an additive abelian group G.
In contrast with the Cauchy-Davenport theorem, J.H.B. Kemperman [21]
and P. Scherk [27] proved that
|A + B| ≥|A| + |B| −min
c∈A+B νA,B(c),
(4.1)
where
νA,B(c) = |{(a, b) ∈A × B: a + b = c}|;
(4.2)
in particular, we have |A + B| ≥|A| + |B| −1 if some c ∈A + B can be
uniquely written as a + b with a ∈A and b ∈B.
Motivated by the Kemperman-Scherk theorem and the Erd˝os-Heilbronn
conjecture, V. F. Lev [22] proposed the following interesting conjecture.
Lev’s Conjecture. Let G be an abelian group, and let A and B be ﬁnite
non-empty subsets of G. Then we have
|A ∔B| ≥|A| + |B| −2 −min
c∈A+B νA,B(c).
(4.3)

A SURVEY OF PROBLEMS AND RESULTS ON RESTRICTED SUMSETS
205
By a sophisticated application of the ﬁrst part of the Combinatorial
Nullstellensatz, H. Pan and Z. W. Sun [26] made the following progress on
Lev’s conjecture.
Theorem 4.1 (H. Pan and Z. W. Sun [26]). Let A and B be ﬁnite
non-empty subsets of a ﬁeld F. Let P(x, y) ∈F[x, y] and
C = {a + b: a ∈A, b ∈B, and P(a, b) ̸= 0}.
(4.4)
If C is non-empty, then
|C| ≥|A| + |B| −deg P −min
c∈C νA,B(c).
(4.5)
Theorem 4.2 (H. Pan and Z. W. Sun [26]). Let A and B be ﬁnite
non-empty subsets of an abelian group G with cyclic torsion subgroup. For
i = 1, . . . , l let mi and ni be non-negative integers and let di ∈G. Suppose
that
C = {a + b: a ∈A, b ∈B, and mia −nib ̸= di for all i = 1, . . . , l} (4.6)
is non-empty. Then
|C| ≥|A| + |B| −
l
X
i=1
(mi + ni) −min
c∈C νA,B(c).
(4.7)
The following result on diﬀerence-restricted sumsets follows from The-
orems 4.1 and 4.2.
Theorem 4.3 (H. Pan and Z. W. Sun [26]). Let
G
be
an
abelian
group, and let A, B, S be ﬁnite non-empty subsets of G with
C = {a + b: a ∈A, b ∈B, and a −b ̸∈S} ̸= ∅.
(4.8)
(i) If G is torsion-free or elementary abelian, then
|C| ≥|A| + |B| −|S| −min
c∈C νA,B(c).
(4.9)
(ii) If Tor(G) is cyclic, then
|C| ≥|A| + |B| −2|S| −min
c∈C νA,B(c).
(4.10)
Proof. Without loss of generality we can assume that G is generated by
the ﬁnite set A ∪B.
If G ∼= Zn, then we can simply view G as the ring of algebraic integers
in an algebraic number ﬁeld K with [K : Q] = n. If G ∼= (Z/pZ)n where

206
ZHI-WEI SUN
p is a prime, then G is isomorphic to the additive group of the ﬁnite ﬁeld
with pn elements. Thus part (i) follows from Theorem 4.1 with P(x, y) =
Q
s∈S(x −y −s).
Let d1, . . . , dl be a list of all the elements of S. Applying Theorem 4.2
with mi = ni = 1 for all i = 1, . . . , l, we immediately get part (ii), complet-
ing the proof.
Given two ﬁnite subsets A and B of a ﬁeld F and a general P(x, y) ∈
F[x, y], what can we say about the cardinality of the restricted sumset
{a+b: a ∈A, b ∈B, and P(a, b) ̸= 0}? In 2002 H. Pan and Z. W. Sun [25]
made progress in this direction by relaxing (to some extent) the limitations
of the polynomial method, their approach allows one to draw conclusions
even if no coeﬃcients in question are explicitly known.
Lemma 4.1 (H. Pan and Z. W. Sun [25]). Let P(x) be a polynomial
over a ﬁeld F. Let ¯F be the algebraic closure of the ﬁeld F and mP (α)
be the multiplicity of α ∈¯F as a root of P(x) = 0 over ¯F. Suppose that
there exist non-negative integers k < l such that [xi]P(x) = 0 for all i with
k < i < l. Then either xl | P(x), or deg P(x) ≤k, or Nq(P) ≥l −k for
some q ∈P(p) = {1, p, p2, . . .}, where p = ch(F),
Nq(P) = q|{α ∈¯F \ {0}: mP (α) ≥q}| −
X
α∈¯
F \{0}
{mP (α)}q
(4.11)
and {m}q denotes the least non-negative residue of m ∈Z modulo q.
We remark that N1(P) is the number of distinct roots in ¯F \ {0} of the
equation P(x) = 0 over ¯F.
Theorem 4.4 (H. Pan and Z. W. Sun [25]). Let A and B be two ﬁ-
nite non-empty subsets of a ﬁeld F. Furthermore, let P(x, y) be a polynomial
over F of degree d = deg P(x, y) such that for some i < |A| and j < |B| we
have [xiyd−i]P(x, y) ̸= 0 and [xd−jyj]P(x, y) ̸= 0. Deﬁne P0(x, y) to be the
homogeneous polynomial of degree d such that P(x, y) = P0(x, y) + R(x, y)
for some R(x, y) ∈F[x, y] with deg R(x, y) < d, and put P ∗(x) = P0(x, 1).
For any α in the algebraic closure ¯F of F, let mP ∗(α) denote the multiplic-
ity of α as a zero of P ∗(x) ∈¯F[x]. Then
|{a + b: a ∈A, b ∈B, and P(a, b) ̸= 0}|
≥min{p(F) −mP ∗(−1), |A| + |B| −1 −d −N(P ∗)},
(4.12)
where
N(P ∗) =
max
q∈P(ch(F )) q|{α ∈¯F \ {0, −1} : mP ∗(α) ≥q}|.
(4.13)

A SURVEY OF PROBLEMS AND RESULTS ON RESTRICTED SUMSETS
207
For the sake of clarity, here we state a consequence of Theorem 4.4.
Corollary 4.1 (H. Pan and Z. W. Sun [25]). Let F be a ﬁeld with p =
ch(F) ̸= 2, and let A, B and S be ﬁnite non-empty subsets of F. Then
|{a+b: a ∈A, b ∈B, and a−b ̸∈S}| ≥min{p(F), |A|+|B|−|S|−q −1},
(4.14)
where q is the largest element of P(p) not exceeding |S|.
5. Working with general abelian groups
Theorem 5.1 (Kneser’s Theorem). Let G be an additive abelian group.
Let A and B be ﬁnite non-empty subsets of G, and let H = H(A + B) be
the stabilizer {g ∈G : g +A+B = A+B}. If |A+B| ≤|A|+|B|−1, then
|A + B| = |A + H| + |B + H| −|H|.
(5.1)
The following consequence is an extension of the Cauchy-Davenport
theorem.
Corollary 5.1. Let G be an additive abelian group. Let p(G) = +∞if G is
torsion-free, otherwise we let p(G) be the least order of a non-zero element
of G. Then, for any ﬁnite non-empty subsets A and B of G, we have
|A + B| ≥min{p(G), |A| + |B| −1}.
(5.2)
Proof. Suppose that |A + B| < |A| + |B| −1. Then H = H(A + B) ̸= {0}
by Kneser’s theorem. Therefore |H| ≥p(G) and hence
|A + B| = |A + H| + |B + H| −|H| ≥|A + H| ≥|H| ≥p(G).
We are done.
G. K´arolyi [19,20] extended the Erd˝os-Heilbronn conjecture to general
abelian groups.
Theorem 5.2. Let G be an additive abelian group and let A be a ﬁnite
non-empty subset of G.
(i) (G. K´arolyi [19]) We have
|2∧A| ≥min{p(G), 2|A| −3}.
(5.3)
(ii) (G. K´arolyi [20]) When |A| ≥5 and p(G) > 2|A| −3, the equality
|2∧A| = 2|A| −3 holds if and only if A is an arithmetic progression.

208
ZHI-WEI SUN
Using the fact that any ﬁnitely generated abelian group can be written
as the direct sum of some cyclic groups of inﬁnite or prime power order,
K´arolyi proved Theorem 5.2 in two steps. First, he showed that Theorem
5.2 is true for any cyclic group G of inﬁnite or prime power order; then,
he proved that those abelian groups possessing the required property are
closed under direct sum. In the ﬁrst step for Theorem 5.2(i), he actually
obtained the following more general result.
Theorem 5.3 (G. K´arolyi [19]). Let ∅̸= A, B ⊆Z/pαZ, where p is a
prime and α ∈Z+. Then
|A ∔B| ≥min{p, |A| + |B| −3}.
(5.4)
For non-empty subsets A and B of Z/pZ with p a prime, if |A| ̸= |B|
then we have
|A ∔B| ≥min
½
p, |A| + |B| −2(2 + 1)
2
+ 1
¾
= min{p, |A| + |B| −2}
by the ANR theorem; if |A| = |B| then
|A ∔B| ≥|(A \ {a0}) ∔B)| ≥min{p, (|A| −1) + |B| −2},
where a0 is any ﬁxed element of A.
When q = pα is not a prime, Z/qZ is not a subgroup of the additive
group of a ﬁeld but K´arolyi considered it as the group of qth roots of unity
(up to isomorphism) which can be viewed as a subgroup of the multiplica-
tive group C∗of non-zero complex numbers.
Lemma 5.1 (Z. W. Sun [29,32]). Let λ1, . . . , λk be qth roots of unity,
and let c1, . . . , ck be non-negative integers with c1λ1 + · · · + ckλk = 0. Then
c1 + · · · + ck ∈D(q), where D(q) is as in Theorem 2.4(iii).
Proof of Theorem 5.3.
Since Z/qZ is isomorphic to the multiplicative
group Cq of qth roots of unity, we may view A and B as subsets of Cq. If
|A| + |B| −3 > p, then we can choose ∅̸= A′ ⊆A and ∅̸= B′ ⊆B so that
|A′| + |B′| −3 = p. Thus, without loss of generality, we may assume that
k + l −3 ≤p where k = |A| and l = |B|.
Suppose that |C| ̸≥min{p, k + l −3} = k + l −3, where
C = {ab : a ∈A, b ∈B and a ̸= b}.
If
c0 := [xk−1yl−1](xy −1)
Y
c∈C
(x −cy) × (x −y)k+l−4−|C| ̸= 0,

A SURVEY OF PROBLEMS AND RESULTS ON RESTRICTED SUMSETS
209
then by the polynomial method, there exist a ∈A and b−1 ∈B−1 such
that ab−1 ̸= 1 and a ̸= cb−1 for all c ∈C, which leads to a contradiction
since a ̸= b and ab ∈C. Thus, it suﬃces to show c0 ̸= 0.
Observe that
c0 = [xk−2yl−2]
k+l−4
Y
s=1
(x −ρsy) = (−1)l−2
X
1≤i1<···<il−2≤k+l−4
ρi1 · · · ρil−2,
where ρ1, . . . , ρk+l−4 are suitable qth roots of unity. Since
¡k+l−4
l−2
¢
̸∈D(q) =
{pn : n ∈N}, we have c0 ̸= 0 by Lemma 5.1.
Now we mention a celebrated theorem of M. Hall which was conjectured
by G. Cramer for cyclic groups.
Theorem 5.4 (M. Hall [16]). Let G
=
{b1, . . . , bn} be an additive
abelian group of order n, and let a1, . . . , an be (not necessarily distinct)
elements of G. Then a1 + · · · + an = 0 if and only if {ai + bσ(i) : i =
1, . . . , n} = G for some σ ∈Sn.
Z. W. Sun and Y. N. Yeh [37] observed that Hall’s theorem implies
the following conjecture of Parker (cf. [14]): For integers a1, . . . , an with
a1 +· · ·+an ≡0 (mod n)+1, there are σ, τ ∈Sn such that ai ≡σ(i)+τ(i)
(mod n) + 1 for all i = 1, . . . , n.
In contrast with Snevily’s conjecture, we have the following consequence
of Theorem 5.4.
Corollary 5.2. Let G be a ﬁnite abelian group, and let a1, . . . , an ∈G
with n < |G|. Then there are distinct b1, . . . , bn ∈G such that the sums
a1 + b1, . . . , an + bn are distinct.
Proof. Write G = {c1, . . . , cm} with m = |G|. Set an+1 = −(a1 + · · · + an)
and ak = 0 for n + 1 < k ≤m. As a1 + · · · + am = 0, by Theorem 5.4, for
some σ ∈Sm we have {ai + cσ(i) : i = 1, . . . , m} = G. Let bi = cσ(i) for i =
1, . . . , n. Then b1, . . . , bn are distinct, and so are the sums a1+b1, . . . , an+bn.
We are done.
Let us conclude this paper with a new open problem.
Problem 5.1. Let G be a ﬁnite abelian group, and let n be a positive
integer smaller than |G|. Determine the smallest positive integer m ≤|G|
such that whenever a1, . . . , an ∈G are distinct and B ⊆G with |B| ≥m
there are distinct b1, . . . , bn ∈B such that all the sums a1 + b1, . . . , an + bn
are distinct.

210
ZHI-WEI SUN
6. On value sets of polynomials
Let p be a prime, and let c1, . . . , cn be non-zero elements of the ﬁeld Fp =
Z/pZ. In 1959 Chowla, Mann and Straus (cf. Theorem 2.8 of [24]) used
Vosper’s theorem (cf. pp. 52-57 of [24]) to deduce that if p > 3, 1 < k <
(p −1)/2 and k | p −1, then
|{c1xk
1 + · · · + cnxk
n : x1, . . . , xn ∈Fp}| ≥min
½
p, (2n −1)p −1
k
+ 1
¾
.
In 1956 Carlitz [8] proved that whenever n ≥k ≥1, k | p −1 and
g(x1, . . . , xn) ∈Fp[x1, . . . , xn] with deg g < k, the equation
c1xk
1 + · · · + cnxk
n + g(x1, . . . , xn) = 0
has a solution with x1, . . . , xn ∈Fp. In 2006 Felszeghy [15] extended this
result by showing that
{c1xk
1 + · · · + cnxk
n + g(x1, . . . , xn) : x1, . . . , xn ∈Fp} = Fp
if k ∈{1, . . . , p −1} and n ≥(p −1)/⌊(p −1)/k⌋.
With the help of the Combinatorial Nullstellensatz, recently Z. W. Sun
established the following result on value sets of polynomials.
Theorem 6.1 (Z. W. Sun [36]). Let F be a ﬁeld, and let
f(x1, . . . , xn) = c1xk
1 + · · · + cnxk
n + g(x1, . . . , xn) ∈F(x1, . . . , xn), (6.1)
where
c1, . . . , cn ∈F ∗= F \ {0} and
deg g < k ∈Z+.
(6.2)
Then, for any ﬁnite non-empty subsets A1, . . . , An of F, we have
|{f(a1, . . . , an) : a1 ∈A1, . . . , an ∈An}|
≥min
(
p(F),
n
X
i=1
¹|Ai| −1
k
º
+ 1
)
.
(6.3)
Note that Theorem 6.1 in the case f(x1, . . . , xn) = x1 + · · · + xn yields
the Cauchy-Davenport theorem. Felszeghy’s result is also a special case of
Theorem 6.1.
Here is another result of [36] obtained by the Combinatorial Nullstel-
lensatz.
Theorem 6.2 (Z. W. Sun [36]). Let f(x1, . . . , xn) be a polynomial over
a ﬁeld F given by (6.1) and (6.2) with n ≤k = deg f. And let A1, . . . , An

A SURVEY OF PROBLEMS AND RESULTS ON RESTRICTED SUMSETS
211
be ﬁnite subsets of F with |Ai| ≥i for i = 1, . . . , n. Then, for the restricted
value set
V = {f(a1, . . . , an) : a1 ∈A1, . . . , an ∈An, and ai ̸= aj if i ̸= j},
(6.4)
we have
|V | ≥min
(
p(F),
n
X
i=1
¹|Ai| −i
k
º
+ 1
)
.
(6.5)
Theorem 6.2 has the following consequence for the case n ≥k.
Corollary 6.1 (Z. W. Sun [36]). Let A be a ﬁnite subset of a ﬁeld F,
and let f(x1, . . . , xn) be a polynomial given by (6.1) and (6.2). If n ≥k,
then we have
|{f(a1, . . . , an) : a1, . . . , an ∈A, and ai ̸= aj if i ̸= j}|
≥min{p(F), |A| −n + 1}.
(6.6)
Let us conclude this paper with a conjecture raised in [36].
Conjecture 6.1 (Z. W. Sun [36]).
Let f(x1, . . . , xn) be a polynomial
over a ﬁeld F given by (6.1) and (6.2), and let A be any ﬁnite subset of F.
Provided n > k, we have
|{f(a1, . . . , an) : a1, . . . , an ∈A, and ai ̸= aj if i ̸= j}|
≥min
½
p(F) −δ, n(|A| −n)
k
−k
nn
k
o ½|A| −n
k
¾
+ 1
¾
,
(6.7)
where {α} denotes the fractional part α −⌊α⌋of a real number α, and
δ =
½ 1
if n = 2 and c1 = −c2,
0
otherwise.
(6.8)
By Corollary 3 of [25], this conjecture holds when n = 2. Note also that
the Dias da Silva–Hamidoune theorem is a special case of Conjecture 6.1
with k = 1.
References
1. N. Alon, Combinatorial Nullstellensatz, Combin. Prob. Comput., 8 (1999),
7–29.
2. N. Alon, Additive Latin transversals, Israel J. Math., 117 (2000), 125–130.
3. N. Alon, Discrete mathematics: methods and challenges, Proceedings of the
International Congress of Mathematicians, Vol. I, (Beijing, 2002), Higher Ed.
Press, Beijing, 2002, 119–135.

212
ZHI-WEI SUN
4. N. Alon, M. B. Nathanson and I. Z. Ruzsa, Adding distinct congruence classes
modulo a prime, Amer. Math. Monthly, 102 (1995), 250–255.
5. N. Alon, M. B. Nathanson and I. Z. Ruzsa, The polynomial method and
restricted sums of congruence classes, J. Number Theory, 56 (1996), 404–
417.
6. N. Alon and M. Tarsi, A nowhere-zero point in linear mappings, Combina-
torica, 9 (1989), 393–395.
7. H. Q. Cao and Z. W. Sun, On sums of distinct representatives, Acta Arith.,
87 (1998), 159–169.
8. L. Carlitz, Solvablity of certain equations in a ﬁnite ﬁeld, Quart. J. Math., 7
(1956), 3–4.
9. A. Cauchy, Recherches sur les nombres, Jour. Ecole Polytechn., 9 (1813),
99–116.
10. S. Dasgupta, G. K´arolyi, O. Serra and B. Szegedy, Transversals of additive
Latin squares, Israel J. Math., 126 (2001), 17–28.
11. H. Davenport, On the addition of residue classes, J. London Math. Soc., 10
(1935), 30–32.
12. J. A. Dias da Silva and Y. O. Hamidoune, Cyclic spaces for Grassmann
derivatives and additive theory, Bull. London Math. Soc., 26 (1994), 140–
146.
13. P. Erd˝os and H. Heilbronn, On the addition of residue classes modulo p, Acta
Arith., 9 (1964), 149–159.
14. R. K. Guy, Parker’s permutation problem involves the Catalan numbers,
Amer. Math. Monthly, 100 (1993), 287–289.
15. B. Felzeghy, On the solvability of some special equations over ﬁnite ﬁelds,
Publ. Math. Debrecen, 68 (2006), 15–23.
16. M. Hall, A combinatorial problem on abelian groups, Proc. Amer. Math.
Soc., 3 (1952), 584–587.
17. P. Hall, On representatives of subsets, J. London Math. Soc., 10 (1935),
26–30.
18. Q. H. Hou and Z. W. Sun, Restricted sums in a ﬁeld, Acta Arith., 102 (2002),
239–249.
19. G. K´arolyi, The Erd˝os-Heilbronn problem in abelian groups, Israel J. Math.,
139 (2004), 349–359.
20. G. K´arolyi, An inverse theorem for the restricted set addition in abelian
groups, J. Algebra, 290 (2005), 557–593.
21. J. H. B. Kemperman, On small sumsets in an abelian group, Acta Math.,
103 (1960), 63–88.
22. V. F. Lev, Restricted set addition in Abelian groups: results and conjectures,
J. Th´eor. Nombres Bordeaux, 17 (2005), 181–193.
23. J. X. Liu and Z. W. Sun, Sums of subsets with polynomial restrictions, J.
Number Theory, 97 (2002), 301–304.
24. M. B. Nathanson, Additive Number Theory: Inverse Problems and the Geom-
etry of Sumsets (Graduated texts in mathematics; 165), Springer, New York,
1996.
25. H. Pan and Z. W. Sun, A lower bound for |{a+b: a ∈A, b ∈B, P(a, b) ̸= 0}|,

A SURVEY OF PROBLEMS AND RESULTS ON RESTRICTED SUMSETS
213
J. Combin. Theory Ser. A, 100 (2002), 387–393.
26. H. Pan and Z. W. Sun, Restricted sumsets and a conjecture of Lev, Israel J.
Math., 154 (2006), 21–28.
27. P. Scherk, Distinct elements in a set of sums, Amer. Math. Monthly, 62
(1955), 46–47.
28. H. S. Snevily, The Cayley addition table of Zn, Amer. Math. Monthly, 106
(1999), 584–585.
29. Z. W. Sun, Covering the integers by arithmetic sequences II, Trans. Amer.
Math. Soc., 348 (1996), 4279–4320.
30. Z. W. Sun, Restricted sums of subsets of Z, Acta Arith., 99 (2001), 41–60.
31. Z. W. Sun, Hall’s theorem revisited, Proc. Amer. Math. Soc., 129 (2001),
3129–3131.
32. Z. W. Sun, On the function w(x) = |{1 ≤s ≤k : x ≡as (mod n)s}|,
Combinatorica, 23 (2003), 681–691.
33. Z. W. Sun, On Snevily’s conjecture and restricted sumsets, J. Combin. The-
ory Ser. A, 103 (2003), 291–304.
34. Z. W. Sun, Uniﬁcation of zero-sum problems, subset sums and covers of Z,
Electron. Res. Announc. Amer. Math. Soc., 9 (2003), 51–60.
35. Z. W. Sun, An additive theorem and restricted sumsets, preprint, 2006. On-
line version: http://arxiv.org/abs/math.CO/0610981.
36. Z. W. Sun, On value sets of polynomials over a ﬁeld, preprint, 2007. On-line
version: http://arxiv.org/abs/math.NT/0703180.
37. Z. W. Sun and Y. N. Yeh, On various restricted sumsets, J. Number Theory,
114 (2005), 209–220.
38. T. Tao and V. H. Vu, Additive Combinatorics, Cambridge Univ. Press, Cam-
bridge, 2006.

214
A GENERAL MODULAR RELATION
IN ANALYTIC NUMBER THEORY
HARUO TSUKADA
Department of Information and Computer Sciences,
School of Humanity-Oriented Science and Engineering,
University of Kinki, Iizuka, Fukuoka 820-8555, Japan
E-mail: tsukada@fuk.kindai.ac.jp
In this paper, we consider Dirichlet series
∞
P
k=1
αk
λs
k and associated series of type
∞
X
k=1
αkHm+M,n+N
p+P,q+Q
 
zλk
˛˛˛˛˛
{(aj −Ajs, Aj)}n
j=1,
{(bj −Bjs, Bj)}m
j=1,
{(cj, Cj)}N
j=1,
{(dj, Dj)}M
j=1,
{(aj −Ajs, Aj)}p
j=n+1,
{(bj −Bjs, Bj)}q
j=m+1,
{(cj, Cj)}P
j=N+1
{(dj, Dj)}Q
j=M+1
1
A,
where H denotes the Fox H-function. Assuming a functional equation with
gamma factors between the Dirichlet series, we prove a modular relation of
a general form for the corresponding H-function series. This formula enables
us to treat wide varieties of similar formulas in analytic number theory in a
systematic way. For example, if the Dirichlet series satisfy a functional equation
of Hecke type, the modular relation includes Bochner’s formula, the Riesz sum,
a K-Bessel expansion, the incomplete gamma expansion, etc. as special cases,
and we present examples associated to the Riemann zeta-function. This paper
is an expanded version of the preprint [28].
1. Preliminaries
In this section, we ﬁx some notation related to Fox H-functions. Let C be
the set of complex numbers, and let R+ be the set of positive real numbers.
For any set A, the set of ﬁnite sequences of elements of A is denoted by A(∞).
We set Ω=
³
(C × R+)(∞)´4
and for an element
∆=
µ{(aj, Aj)}n
j=1;{(aj, Aj)}p
j=n+1
{(bj, Bj)}m
j=1;{(bj, Bj)}q
j=m+1
¶
(1.1)

A GENERAL MODULAR RELATION IN ANALYTIC NUMBER THEORY
215
of Ω, we deﬁne
∆+ =
µ{(aj, Aj)}n
j=1;{(aj, Aj)}p
j=n+1
−
;{(bj, Bj)}q
j=m+1
¶
∈Ω
(1.2)
and
∆−=
µ
−
;{(aj, Aj)}p
j=n+1
{(bj, Bj)}m
j=1;{(bj, Bj)}q
j=m+1
¶
∈Ω,
(1.3)
where “−” means the empty sequence. We deﬁne the Gamma factor asso-
ciated to ∆by
∆(s) =
m
Y
j=1
Γ
¡
bj + Bjs
¢
n
Y
j=1
Γ
¡
1 −aj −Ajs
¢
p
Y
j=n+1
Γ
¡
aj + Ajs
¢
q
Y
j=m+1
Γ
¡
1 −bj −Bjs
¢.
(1.4)
Finally, we deﬁne the Fox H-function [12,20,24,25] associated to ∆by
H
¡
z
¯¯ ∆
¢
= Hm,n
p,q
µ
z
¯¯¯¯
{(aj, Aj)}n
j=1, {(aj, Aj)}p
j=n+1
{(bj, Bj)}m
j=1, {(bj, Bj)}q
j=m+1
¶
=
1
2πi
Z
L
∆(s) z−s ds,
(1.5)
  
  
  
  
  
  
Fig. 1.
the path L

216
HARUO TSUKADA
provided that the integral converges absolutely, where the path L : γ−i∞→
γ + i∞(γ : real) is taken so that the poles of ∆+(s) lie to the right of L,
and those of ∆−(s) lie to the left of L (cf. Fig. 1).
We note that the Meijer G-functions [21,22] are special cases of H-
functions.
Gm,n
p,q
µ
z
¯¯¯¯
{aj}n
j=1, {aj}p
j=n+1
{bj}m
j=1, {bj}q
j=m+1
¶
= Hm,n
p,q
µ
z
¯¯¯¯
{(aj, 1)}n
j=1, {(aj, 1)}p
j=n+1
{(bj, 1)}m
j=1, {(bj, 1)}q
j=m+1
¶
(1.6)
For c ∈C, we deﬁne
∆+ c =
µ{(aj + Ajc, Aj)}n
j=1;{(aj + Ajc, Aj)}p
j=n+1
{(bj + Bjc, Bj)}m
j=1;{(bj + Bjc, Bj)}q
j=m+1
¶
∈Ω,
(1.7)
and for C ∈R+, we deﬁne
C·∆=
µ{(aj, CAj)}n
j=1;{(aj, CAj)}p
j=n+1
{(bj, CBj)}m
j=1;{(bj, CBj)}q
j=m+1
¶
∈Ω.
(1.8)
We also set
∆∗=
µ{(1 −bj, Bj)}m
j=1;{(1 −bj, Bj)}q
j=m+1
{(1 −aj, Aj)}n
j=1;{(1 −aj, Aj)}p
j=n+1
¶
∈Ω,
(1.9)
and for another element ∆′ =
Ã
{(a′
j, A′
j)}n′
j=1;{(a′
j, A′
j)}p′
j=n′+1
{(b′
j, B′
j)}m′
j=1;{(b′
j, B′
j)}q′
j=m′+1
!
of Ω, we
deﬁne
∆⊕∆′
=
Ã
{(aj, Aj)}n
j=1,{(a′
j, A′
j)}n′
j=1;{(aj, Aj)}p
j=n+1,{(a′
j, A′
j)}p′
j=n′+1
{(bj, Bj)}m
j=1,{(b′
j, B′
j)}m′
j=1;{(bj, Bj)}q
j=m+1,{(b′
j, B′
j)}q′
j=m′+1
!
∈Ω.
(1.10)
Then we have the following relations between the Gamma factors:
¡
∆+ c
¢
(s) = ∆(s + c)
(c ∈C),
¡
C·∆
¢
(s) = ∆(C s)
(C ∈R+),
∆∗(s) = ∆(−s),
¡
∆⊕∆′ ¢
(s) = ∆(s) ∆′(s).

A GENERAL MODULAR RELATION IN ANALYTIC NUMBER THEORY
217
Furthermore, we have the following relations between the H-functions:
H
¡
z
¯¯ ∆+ c
¢
= zc H
¡
z
¯¯ ∆
¢
(c ∈C),
(1.11)
H
µ
z
¯¯¯¯
1
C ·∆
¶
= C H
¡
zC¯¯ ∆
¢
(C ∈R+),
(1.12)
H
¡
z
¯¯ ∆∗¢
= H
µ 1
z
¯¯¯¯ ∆
¶
,
(1.13)
Z ∞
0
H
¡
t z
¯¯ ∆
¢
H
µ 1
t z′
¯¯¯¯ ∆′
¶dt
t = H
µ z
z′
¯¯¯¯ ∆⊕∆′
¶
.
(1.14)
2. Assumptions
In this section, we state the assumptions in our theorem. Let H and I be
two natural numbers. Let
©
λ(h)
k
ª∞
k=1 (1 ≦h ≦H),
©
µ(i)
k
ª∞
k=1 (1 ≦i ≦I)
be increasing sequences of positive real numbers tending to ∞, and let
©
α(h)
k
ª∞
k=1 (1 ≦h ≦H),
©
β(i)
k
ª∞
k=1 (1 ≦i ≦I) be complex sequences. We
assume that the Dirichlet series
ϕh(s) =
∞
X
k=1
α(h)
k
λ(h)s
k
(1 ≦h ≦H)
(2.1)
and
ψi(s) =
∞
X
k=1
β(i)
k
µ(i)s
k
(1 ≦i ≦I)
(2.2)
have ﬁnite abscissas of absolute convergence σϕh(1 ≦h ≦H) and σψi(1 ≦
i ≦I), respectively. We also assume the existence of a meromorphic func-
tion χ satisfying the functional equation
χ(s) =













H
X
h=1
∆(h)
1 (s) ϕh(s)
Re(s) > max
1≦h≦H
¡
σϕh
¢
,
I
X
i=1
∆(i)∗
2
(r −s) ψi(r −s)
Re(s) < min
1≦i≦I
¡
r −σψi
¢
,
(2.3)
where ∆(h)
1 (1 ≦h ≦H), ∆(i)
2 (1 ≦i ≦I) are elements of Ω, and r is a
real number. We further assume that among the poles of χ(s), only ﬁnitely
many distinct sk (1 ≦k ≦L) are neither a pole of ∆(h)+
1
(s) nor a pole
of
¡
∆(i)
2 −r
¢−(s). We denote the set of such poles by S = {sk | 1 ≦k ≦L}.
Now, we introduce a gamma factor associated to ∆∈Ωand suppose
that for any pair of real numbers u1, u2 (u1 < u2), we have a convergence

218
HARUO TSUKADA
lim
|v|→∞
¡
∆−s
¢
(u + iv) χ(u + iv) = 0 uniformly in u1 ≦u ≦u2. Let
L1 = L1(s) : γ1 −i∞→γ1 + i∞,
L2 = L2(s) : γ2 −i∞→γ2 + i∞,
(γ1, γ2 : real, γ2 < γ1) be two non-intersecting paths in the w-plane depend-
ing on s. We assume that there exists a real number Y such that L1 and
L2 coincide with the two lines Re(w) = γ1 and Re(w) = γ2, respectively,
for |Im(w)| > Y , and that all the poles of
¡
(∆−s) ⊕∆(h)
1
¢+(w) lie to the
right of L1, and those of
¡
(∆−s) ⊕∆(h)
1
¢−(w) and S lie to the left of L1,
and all the poles of
¡
(∆−s) ⊕
¡
∆(i)
2 −r
¢¢+(w) and S lie to the right of L2,
and those of
¡
(∆−s) ⊕
¡
∆(i)
2 −r
¢¢−(w) lie to the left of L2 (cf. Fig. 2).
  
  
  
  
  
  
Fig. 2.
the paths L1 and L2
Under these assumptions, we deﬁne a function X(z, s, ∆) by
X(z, s, ∆) =
1
2πi
Z
L1
∆(w −s) χ(w) z−w dw.
(2.4)

A GENERAL MODULAR RELATION IN ANALYTIC NUMBER THEORY
219
Then, by the Cauchy residue theorem, we have
X(z, s, ∆) =
1
2πi
Z
L2
∆(w −s) χ(w) z−w dw
+
L
X
k=1
Res
¡
∆(w −s) χ(w) z−w, w = sk
¢
.
(2.5)
3. Theorem
In this section we state and prove our theorem.
Theorem 3.1. For the H-function series
Φh(z, s, ∆) =
∞
X
k=1
α(h)
k H
³
zλ(h)
k
¯¯¯(∆−s) ⊕∆(h)
1
´
(3.1)
and
Ψi(z, s, ∆) =
∞
X
k=1
β(i)
k H
³
zµ(i)
k
¯¯¯(∆−s) ⊕∆(i)∗
2
´
,
(3.2)
the following modular relation holds:
X(z, s, ∆)
=





















H
X
h=1
Φh(z, s, ∆)
if L1 can be taken to the right of
max
1≦h≦H
¡
σϕh
¢
,
z−r
I
X
i=1
Ψi
µ1
z , r−s, ∆∗
¶
+
L
X
k=1
Res
¡
∆(w−s) χ(w) z−w, w = sk
¢
if L2 can be taken to the left of min
1≦i≦I
¡
r −σψi
¢
,
(3.3)
for ∆and z such that the H-functions on the right-hand side converge
absolutely.
Proof. If L1 can be taken to the right of max
1≦h≦H
¡
σϕh
¢
(cf. Fig. 3), by using
(2.4), (2.3) and (2.1) successively, we have
X(z, s, ∆) =
1
2πi
Z
L1
∆(w −s) χ(w) z−w dw
=
1
2πi
Z
L1
∆(w −s)
H
X
h=1
∆(h)
1 (w) ϕh(w) z−w dw

220
HARUO TSUKADA
  
  
  
  
  
  
Fig. 3.
the paths L1 and L2
=
H
X
h=1
1
2πi
Z
L1
∆(w −s) ∆(h)
1 (w)
∞
X
k=1
α(h)
k
³
zλ(h)
k
´w dw
=
H
X
h=1
∞
X
k=1
α(h)
k
1
2πi
Z
L1
(∆−s)(w) ∆(h)
1 (w)
³
zλ(h)
k
´−w
dw,
where the exchange of the integration and the summation is permitted by
absolute convergence. Now the resulting integral is an H-function, and by
(3.1), we have
X(z, s, ∆) =
H
X
h=1
∞
X
k=1
α(h)
k H
³
zλ(h)
k
¯¯¯(∆−s) ⊕∆(h)
1
´
=
H
X
h=1
Φh(z, s, ∆) .

A GENERAL MODULAR RELATION IN ANALYTIC NUMBER THEORY
221
On the other hand, if L2 can be taken to the left of min
1≦i≦I
¡
r −σψi
¢
(cf. Fig. 4), by using (2.5), (2.3) and (2.2) successively, we have
X(z, s, ∆) −
L
X
k=1
Res
¡
∆(w −s) χ(w) z−w, w = sk
¢
=
1
2πi
Z
L2
∆(w −s) χ(w) z−w dw
=
1
2πi
Z
L2
∆(w −s)
I
X
i=1
∆(i)∗
2
(r −w) ψi(r −w) z−w dw
=
I
X
i=1
1
2πi
Z
L2
∆(w −s) ∆(i)
2 (w −r)
∞
X
k=1
β(i)
k
µµ(i)
k
z
¶−w dw
Ã
1
µ(i)
k
!r
=
I
X
i=1
∞
X
k=1
β(i)
k
1
2πi
Z
L2
(∆−s)(w)
¡
∆(i)
2 −r
¢
(w)
Ã
z
µ(i)
k
!−w
dw
Ã
1
µ(i)
k
!r
,
  
  
  
  
  
  
Fig. 4.
the paths L1 and L2

222
HARUO TSUKADA
where we changed the order of the integration and the summation. Now
the resulting integral is an H-function which can be transformed as follows
by the properties (1.11) and (1.13):
1
2πi
Z
L2
(∆−s)(w)
¡
∆(i)
2 −r
¢
(w)
Ã
z
µ(i)
k
!−w
dw
Ã
1
µ(i)
k
!r
= z−r H
Ã
z
µ(i)
k
¯¯¯¯¯ (∆−s) ⊕
¡
∆(i)
2 −r
¢
! Ã
z
µ(i)
k
!r
= z−r H
Ã
z
µ(i)
k
¯¯¯¯¯
¡
∆+ (r −s)
¢
⊕∆(i)
2
!
= z−r H
Ã
µ(i)
k
z
¯¯¯¯¯
¡
∆∗−(r −s)
¢
⊕∆(i)∗
2
!
.
Therefore, we have, by (3.2),
X(z, s, ∆) −
L
X
k=1
Res
¡
∆(w −s) χ(w) z−w, w = sk
¢
= z−r
I
X
i=1
∞
X
k=1
β(i)
k H
Ã
µ(i)
k
z
¯¯¯¯¯
¡
∆∗−(r −s)
¢
⊕∆(i)∗
2
!
= z−r
I
X
i=1
Ψi
µ 1
z , r −s, ∆∗
¶
.
This completes the proof of (3.3).
Remark 3.1. Let p : Ω→Ξ =
¡
R+(∞)¢4 be a map deﬁned by
µ{(aj, Aj)}n
j=1;{(aj, Aj)}p
j=n+1
{(bj, Bj)}m
j=1;{(bj, Bj)}q
j=m+1
¶
7→
µ{Aj}n
j=1;{Aj}p
j=n+1
{Bj}m
j=1;{Bj}q
j=m+1
¶
,
then for each element Λ ∈Ξ, the inverse image p−1(Λ) is a ﬁnite-
dimensional complex vector space, and we can regard the space Ω=
`
Λ∈Ξ
p−1(Λ) as a disjoint union. In this sense, we may regard ∆∈Ωas
a “complex variable”, and then the use of variable s in Theorem 3.1 is
useful but unnecessary, since we have Φh(z, s, ∆) = Φh(z, 0, ∆−s) and
Ψi(z, s, ∆) = Ψi(z, 0, ∆−s).

A GENERAL MODULAR RELATION IN ANALYTIC NUMBER THEORY
223
4. A General Modular Relation associated to the Riemann
Zeta-function
Even in the simplest case of Hecke type
χ(s) =



Γ(s) ϕ(s)
Re(s) > σϕ,
Γ(r −s) ψ(r −s)
Re(s) < r −σψ,
(4.1)
(i. e. H = I = 1, ∆1 = ∆∗
2 =
³
−
(0,1)
;
;
−
−
´
), the above modular relation (3.3)
includes Bochner’s formula [6], the Riesz sum [8], a K-Bessel expansion [5],
the incomplete Gamma expansion [9,11,17,27], and another Bochner’s for-
mula [7], to name a few. Examples of non-Hecke type were studied in [1–4],
and also in [14,15] using our formalism. Numerous concrete examples will
appear in the forthcoming book [16].
In this section, we consider the general modular relation associated to
the Riemann zeta-function deﬁned by the Dirichlet series
ζ(s) =
∞
X
k=1
1
ks ,
Re(s) > 1.
(4.2)
If we set
Z(s) = ζ(2s)
πs
=
∞
X
k=1
1
¡
πk2¢s ,
(4.3)
then it satisﬁes the functional equation of Hecke type:
Γ(s) Z(s) = Γ
¡ 1
2 −s
¢
Z
¡ 1
2 −s
¢
,
(4.4)
after analytic continuation.
By Theorem 3.1, we have the following modular relation:
∞
X
k=1
Hm+1,n
p,q+1
µ
zπk2
¯¯¯¯
{(1 −aj −Ajs, Aj)}n
j=1, {(aj −Ajs, Aj)}p
j=n+1
(0, 1), {(bj −Bjs, Bj)}m
j=1, {(1 −bj −Bjs, Bj)}q
j=m+1
¶
−Res
¡
Γ(w)Z(w)∆(w −s) z−w, w = 0
¢
= z−1
2
∞
X
k=1
Hn+1,m
q,p+1
µπk2
z
¯¯¯¯
{(1 −bj −Bj( 1
2 −s), Bj)}m
j=1,
(0, 1), {(aj−Aj( 1
2 −s), Aj)}n
j=1,
{(bj −Bj( 1
2 −s), Bj)}q
j=m+1
{(1−aj−Aj( 1
2 −s), Aj)}p
j=n+1
¶
+ Res
¡
Γ(w)Z(w)∆(w −s) z−w, w = 1
2
¢
,
(4.5)

224
HARUO TSUKADA
which can be rewritten as
1
πs
∞
X
k=1
1
k2s Hm+1,n
p,q+1
µ
zπk2
¯¯¯¯
{(1 −aj, Aj)}n
j=1, {(aj, Aj)}p
j=n+1
(s, 1), {(bj, Bj)}m
j=1, {(1 −bj, Bj)}q
j=m+1
¶
+ Res
³
Γ(w)Z(w)∆
¡
−w −s + 1
2
¢
zs−1
2 +w, w = 1
2
´
=
1
π
1
2 −s
∞
X
k=1
1
k1−2s
× Hn+1,m
q,p+1
µπk2
z
¯¯¯¯
{(1 −bj, Bj)}m
j=1, {(bj, Bj)}q
j=m+1
¡ 1
2 −s, 1
¢
, {(aj, Aj)}n
j=1, {(1 −aj, Aj)}p
j=n+1
¶
+ Res
¡
Γ(w)Z(w)∆(w −s) zs−w, w = 1
2
¢
,
(4.6)
and in this form, the modular relation is given by the following simultaneous
exchange of the parameters:
s ↔1
2 −s
z ↔
1
z
©
(aj, Aj)
ªn
j=1 ↔
©
(bj, Bj)
ªm
j=1
©
(aj, Aj)
ªp
j=n+1 ↔
©
(bj, Bj)
ªq
j=m+1
¡
∆↔∆∗¢
(4.7)
Example 4.1. (Bochner’s formula [6]). As the simplest example
of (4.5), we have
∞
X
k=1
H1,0
0,1
µ
zπk2
¯¯¯¯
−
(0, 1)
¶
+ 1
2
= z−1
2
∞
X
k=1
H1,0
0,1
µπk2
z
¯¯¯¯
−
(0, 1)
¶
+ 1
2 z−1
2 .
Since
H1,0
0,1
µ
z
¯¯¯¯
−
(0, 1)
¶
= e−z,
(4.8)
we get Bochner’s formula:
∞
X
k=1
e−zπk2 + 1
2 = z−1
2
Ã ∞
X
k=1
e−πk2
z
+ 1
2
!
,

A GENERAL MODULAR RELATION IN ANALYTIC NUMBER THEORY
225
which can be rewritten as the modular relation of the theta function:
θ(z) =
1
√z θ
µ 1
z
¶
,
θ(z) =
X
k∈Z
e−zπk2,
(4.9)
where Re(z) > 0.
Example 4.2. (Riesz sum [8]). As an example of (4.6), we have
1
πs
∞
X
k=1
1
k2s H1,0
1,1
µ
zπk2
¯¯¯¯
(a, 1)
(s, 1)
¶
+ Res
Ã
Γ(w)Z(w)
Γ
¡
a −w −s + 1
2
¢ zs−1
2 +w, w = 1
2
!
=
1
π
1
2 −s
∞
X
k=1
1
k1−2s H1,0
0,2
µπk2
z
¯¯¯¯
−
¡ 1
2 −s, 1
¢
, (1 −a, 1)
¶
+ Res
µ Γ(w)Z(w)
Γ(a + w −s) zs−w, w = 1
2
¶
.
Setting a = 1, and using
H1,0
1,1
µ
z
¯¯¯¯
(1, 1)
(s, 1)
¶
=





1
Γ(1 −s)
µ
z
1 −z
¶s
|z| < 1,
0
|z| > 1,
(4.10)
and
H1,0
0,2
µ
z
¯¯¯¯
−
(s, 1), (0, 1)
¶
= z
s
2 Js
¡
2√z
¢
,
(4.11)
where Js denotes the Bessel function of the ﬁrst kind, we get the Riesz sum
formula:
1
Γ(1 −s)
X
−w<k<w
k∈Z
1
¡
w2 −k2¢s
= 2 πsw
1
2 −s
∞
X
k=1
1
k
1
2 −s J 1
2 −s(2wπk) +
1
Γ
¡ 3
2 −s
¢ π
1
2 w1−2s,
(4.12)
where w =
1
√zπ > 0, w ̸∈Z, s < 1.

226
HARUO TSUKADA
Example 4.3. (K-Bessel expansion [5,30]). As the second example
of (4.6), we have
1
πs
∞
X
k=1
1
k2s H2,0
0,2
µ
zπk2
¯¯¯¯
−
(s, 1), (a, 1)
¶
+ Res
³
Γ(w)Z(w)Γ
¡
a −w −s + 1
2
¢
zs−1
2 +w, w = 1
2
´
=
1
π
1
2 −s
∞
X
k=1
1
k1−2s H1,1
1,1
µπk2
z
¯¯¯¯
(1 −a, 1)
¡ 1
2 −s, 1
¢
¶
+ Res
¡
Γ(w)Z(w)Γ(a + w −s) zs−w, w = 1
2
¢
.
Setting a = 0, and using
H2,0
0,2
µ
z
¯¯¯¯
−
(s, 1), (0, 1)
¶
= 2 z
s
2 Ks
¡
2√z
¢
(4.13)
where Ks denotes the modiﬁed Bessel function of the second kind, and
H1,1
1,1
µ
z
¯¯¯¯
(1, 1)
(s, 1)
¶
= Γ(s)
µ
z
z + 1
¶s
,
(4.14)
we get a K-Bessel expansion:
2 z
s
2
π
s
2
∞
X
k=1
1
ks Ks
¡
2√zπ k
¢
+ 1
2 Γ(−s) zs
= 1
2 Γ
¡ 1
2 −s
¢ X
k∈Z
1
¡
πk2 + z
¢1
2 −s .
(4.15)
We note that Formula (4.15) leads to the Chowla-Selberg formula [10,26].
In the special case of s = −1
2, we have
H2,0
0,2
µ
z
¯¯¯¯
−
¡
−1
2, 1
¢
, (0, 1)
¶
=
√π
√z e−2√z,
(4.16)
and therefore
√π
√z
X
k∈Z
e−2√zπ |k| =
X
k∈Z
1
πk2 + z ,
which is the partial fraction expansion of the hyperbolic cotangent:
coth(πw)
w
= 1
π
X
k∈Z
1
k2 + w2 ,
(4.17)
where w =
√z
√π.

A GENERAL MODULAR RELATION IN ANALYTIC NUMBER THEORY
227
Example 4.4. (Incomplete Gamma expansion [9,11,27], Bochner’s
formula [7]). As the third example of (4.6), we have
1
πs
∞
X
k=1
1
k2s H2,0
1,2
µ
zπk2
¯¯¯¯
(a, A)
(s, 1), (b, B)
¶
+ Res
Ã
Γ(w)Z(w) Γ
¡
b −Bw −Bs + B
2
¢
Γ
¡
a −Aw −As + A
2
¢ zs−1
2 +w, w = 1
2
!
=
1
π
1
2 −s
∞
X
k=1
1
k1−2s H1,1
1,2
µπk2
z
¯¯¯¯
(1 −b, B)
¡ 1
2 −s, 1
¢
, (1 −a, A)
¶
+ Res
µ
Γ(w)Z(w) Γ(b + Bw −Bs)
Γ(a + Aw −As) zs−w, w = 1
2
¶
.
Setting a = 1, A = 1, b = 0, B = 1, and using
H2,0
1,2
µ
z
¯¯¯¯
(1, 1)
(s, 1), (0, 1)
¶
= Γ(s, z)
(4.18)
and
H1,1
1,2
µ
z
¯¯¯¯
(1, 1)
(s, 1), (0, 1)
¶
= Γ(s) −Γ(s, z),
(4.19)
we get an incomplete Gamma expansion:
1
πs
∞
X
k=1
1
k2s Γ
¡
s, zπk2¢
−1
2
1
s zs
=
1
π
1
2 −s
∞
X
k=1
1
k1−2s
µ
Γ
¡ 1
2 −s
¢
−Γ
µ
1
2 −s, πk2
z
¶¶
−1
2
1
s −1
2
zs−1
2 .
(4.20)
We note that Formula (4.20) is often referred to as the Ewald expansion
[11,27] in the disciplines.
On the other hand, setting a = s, A = 1, b = 0, and using
H2,0
1,2
µ
z
¯¯¯¯
(s, 1)
(s, 1), (0, B)
¶
= H1,0
0,1
µ
z
¯¯¯¯
−
(0, B)
¶
= 1
B e−B√z
(4.21)
and
H1,1
1,2
µ
z
¯¯¯¯
(1, B)
(s, 1),
¡
s + 1
2, 1
¢
¶
= zs
1Ψ1
µ(Bs, B)
¡ 1
2, 1
¢ ; −z
¶
= zs
∞
X
k=0
Γ(Bs + Bk)
Γ
¡ 1
2 + k
¢
(−z)k
k!
,
(4.22)

228
HARUO TSUKADA
where 1Ψ1 denotes the Ψ-function, we get another formula of Bochner:
1
B
1
πs
∞
X
k=1
1
k2s e−B√
zπk2 = 1
2 zs−1
2 X
k∈Z
1Ψ1
µ¡ B
2 −Bs, B
¢
¡ 1
2, 1
¢
; −πk2
z
¶
.
(4.23)
In particular, for B = 1, we have
H1,1
1,2
µ
z
¯¯¯¯
(1, 1)
(s, 1),
¡
s + 1
2, 1
¢
¶
= Γ(s)
√π zs
1F1
µs
1
2
; −z
¶
,
(4.24)
where 1F1 denotes the hypergeometric function, and
1
πs
∞
X
k=1
1
k2s e−zπk2 = 1
2
Γ
¡ 1
2 −s
¢
√π
zs−1
2 X
k∈Z
1F1
µ 1
2 −s
1
2
; −πk2
z
¶
.
(4.25)
Example 4.5. (Hurwitz’s formula [19,29]). As the last example
of (4.6), we have
1
πs
∞
X
k=1
1
k2s H2,2
2,2
µ
zπk2
¯¯¯¯
(1 −a, 1), (1 −b, 1)
(s, 1), (c, 1)
¶
+ Res
³
Γ(w)Z(w)Γ
¡
a + w + s −1
2
¢
Γ
¡
b + w + s −1
2
¢
Γ
¡
c −w −s + 1
2
¢
zs−1
2 +w, w = 1
2
´
=
1
π
1
2 −s
∞
X
k=1
1
k1−2s H3,1
1,3
µπk2
z
¯¯¯¯
(1 −c, 1)
¡ 1
2 −s, 1
¢
, (a, 1), (b, 1)
¶
+ Res
¡
Γ(w)Z(w)Γ(a −w + s)Γ(b −w + s)Γ(c + w −s) zs−w, w = 1
2
¢
.
Setting a = 1
2, b = 0, c = s + 1
2, and using
H2,2
2,2
µ
z
¯¯¯¯
¡ 1
2, 1
¢
, (1, 1)
(s, 1),
¡
s + 1
2, 1
¢
¶
= 21−2sπ Γ(2s)
zs
¡
1 + √z
¢2s
(4.26)
and
H3,1
1,3
µ
z
¯¯¯¯
(s, 1)
(s, 1),
¡ 1
2, 1
¢
, (0, 1)
¶
= √z Γ
¡
1 −2s
¢³
e−sπi+2√z i Γ
¡
2s, 2√z i
¢
+ esπi−2√z i Γ
¡
2s, −2√z i
¢´
,
(4.27)

A GENERAL MODULAR RELATION IN ANALYTIC NUMBER THEORY
229
we get a formula (cf. Ueno and Nishizawa [29])
ζ(2s, w) =
1
w2s−1
∞
X
k=1



e−2πkwi
³
2πkw e−π i
2
´1−2s Γ
¡
1 −2s, −2πkw i
¢
+
e2πkwi
³
2πkw e
π i
2
´1−2s Γ
¡
1 −2s, 2πkw i
¢



+
1
2 w2s +
1
w2s−1
1
2s −1,
(4.28)
where 0 < w =
1
√πz < 1, and
ζ(s, w) =
∞
X
k=0
1
¡
k + w
¢s ,
Re(s) > 1,
(4.29)
is the Hurwitz zeta-function. We note that Formula (4.28) leads to Hur-
witz’s formula:
ζ(2s, w) = Γ(1 −2s)
(2π)1−2s
³
e
1−2s
2
πi l1−2s(−w) + e−1−2s
2
πi l1−2s(w)
´
,
(4.30)
where
ls(w) =
∞
X
k=1
e2πikw
ks
,
Re(s) > 1,
(4.31)
is the Lerch zeta-function or the polylogarithm function.
5. A General Modular Relation associated to a product of
the Riemann Zeta-function
In this section, we consider a product of the Riemann zeta-function
Z
¡
s + ν
2
¢
Z
¡
s −ν
2
¢
= ζ(2s + ν) ζ(2s −ν)
π2s
=
∞
X
l=1
∞
X
k=1
lν k−ν
¡
π2 l2 k2¢s =
∞
X
k=1
σ2ν(k)
kν¡
π2 k2¢s ,
(5.1)
where σt(k) = P
j|k
jt.
By the functional equation (4.4), we have
Γ
¡
s + ν
2
¢
Γ
¡
s −ν
2
¢
Z
¡
s + ν
2
¢
Z
¡
s −ν
2
¢
= Γ
¡ 1
2 −s + ν
2
¢
Γ
¡ 1
2 −s −ν
2
¢
Z
¡ 1
2 −s + ν
2
¢
Z
¡ 1
2 −s −ν
2
¢
.
(5.2)

230
HARUO TSUKADA
Therefore, by Theorem 3.1, we have the following modular relation:
∞
X
k=1
σ2ν(k)
kν
Hm+2,n
p,q+2
µ
zπ2k2
¯¯¯¯
{(1 −aj −Ajs, Aj)}n
j=1,
¡ ν
2, 1
¢
,
¡
−ν
2, 1
¢
, {(bj −Bjs, Bj)}m
j=1,
{(aj −Ajs, Aj)}p
j=n+1
{(1 −bj −Bjs, Bj)}q
j=m+1
¶
= z−1
2
∞
X
k=1
σ2ν(k)
kν
Hn+2,m
q,p+2
µπ2k2
z
¯¯¯¯
{(1 −bj −Bj( 1
2 −s), Bj)}m
j=1,
¡ ν
2,1
¢
,
¡
−ν
2,1
¢
,{(aj−Aj( 1
2 −s),Aj)}n
j=1,
{(bj −Bj( 1
2 −s), Bj)}q
j=m+1
{(1−aj−Aj( 1
2 −s),Aj)}p
j=n+1
¶
+
X
v∈Sν
Res
³
Γ
¡
w + ν
2
¢
Γ
¡
w −ν
2
¢
Z
¡
w + ν
2
¢
Z
¡
w −ν
2
¢
∆(w −s) z−w, w = v
´
,
(5.3)
which can be rewritten as
1
π2s
∞
X
k=1
σ2ν(k)
k2s+ν Hm+2,n
p,q+2
µ
zπ2k2
¯¯¯¯
{(1 −aj, Aj)}n
j=1,
¡
s + ν
2, 1
¢
,
¡
s −ν
2, 1
¢
, {(bj, Bj)}m
j=1,
{(aj, Aj)}p
j=n+1
{(1−bj, Bj)}q
j=m+1
¶
=
1
π1−2s
∞
X
k=1
σ2ν(k)
k1−2s+ν
× Hn+2,m
q,p+2
µπ2k2
z
¯¯¯¯
{(1 −bj, Bj)}m
j=1,
¡ 1
2 −s + ν
2, 1
¢
,
¡ 1
2 −s −ν
2, 1
¢
, {(aj, Aj)}n
j=1,
{(bj, Bj)}q
j=m+1
{(1 −aj, Aj)}p
j=n+1
¶
+
X
v∈Sν
Res
³
Γ
¡
w + ν
2
¢
Γ
¡
w −ν
2
¢
Z
¡
w + ν
2
¢
Z
¡
w −ν
2
¢
∆(w −s) zs−w, w = v
´
,
(5.4)
where
Sν =







©
0. 1
2
ª
ν = 0,
©
−1
4, 1
4, 3
4
ª
ν = ± 1
2,
©
± ν
2, ± ν
2 + 1
2
ª
ν ̸= 0, ± 1
2,
(5.5)
is the set of poles.

A GENERAL MODULAR RELATION IN ANALYTIC NUMBER THEORY
231
Example 5.1. As the simplest example of (5.3), we have
∞
X
k=1
σ2ν(k)
kν
H2,0
0,2
µ
zπ2k2
¯¯¯¯
−
¡ ν
2, 1
¢
,
¡
−ν
2, 1
¢
¶
= z−1
2
∞
X
k=1
σ2ν(k)
kν
H2,0
0,2
µπ2k2
z
¯¯¯¯
−
¡ ν
2, 1
¢
,
¡
−ν
2, 1
¢
¶
+
X
v∈Sν
Res
¡
Γ
¡
w + ν
2
¢
Γ
¡
w −ν
2
¢
Z
¡
w + ν
2
¢
Z
¡
w −ν
2
¢
z−w, w = v
¢
.
Since
H2,0
0,2
µ
z
¯¯¯¯
−
¡ ν
2, 1
¢
,
¡
−ν
2, 1
¢
¶
= 2 Kν
¡
2√z
¢
,
(5.6)
we get
2
∞
X
k=1
σ2ν(k)
kν
Kν
¡
2 √z πk
¢
= 2 z−1
2
∞
X
k=1
σ2ν(k)
kν
Kν
µ2 πk
√z
¶
+
X
v∈Sν
Res
¡
Γ
¡
w + ν
2
¢
Γ
¡
w −ν
2
¢
Z
¡
w + ν
2
¢
Z
¡
w −ν
2
¢
z−w, w = v
¢
.
(5.7)
In particular, for ν = 1
2, we have
H2,0
0,2
µ
z
¯¯¯¯
−
¡ 1
4, 1
¢
,
¡
−1
4, 1
¢
¶
=
√π
4√z e−2√z,
(5.8)
and by using the relation
∞
X
k=1
σ1(k)
k
e−kz =
∞
X
n=1
∞
X
m=1
1
m e−nmz
= −
∞
X
n=1
log
³
1 −e−nz´
= −log
µ
η
µ iz
2π
¶¶
−z
24 ,
(5.9)
where
η(τ) = e
πi
12 τ
∞
Y
n=1
³
1 −e2πinτ´
(5.10)
is the eta function, we get its transformation formula
log
¡
η(τ)
¢
= log
µ
η
µ
−1
τ
¶¶
−1
2 log
¡
−iτ
¢

232
HARUO TSUKADA
or
η
µ
−1
τ
¶
=
√
−iτ η(τ).
(5.11)
Example 5.2. (Oppenheim’s formula [23]). As the second example
of (5.3), we have
∞
X
k=1
σ2ν(k)
kν
H2,0
2,2
µ
zπ2k2
¯¯¯¯
(a −s, 1), (b −s, 1)
¡ ν
2, 1
¢
,
¡
−ν
2, 1
¢
¶
= z−1
2
∞
X
k=1
σ2ν(k)
kν
× H2,0
0,4
µπ2k2
z
¯¯¯¯
−
¡ ν
2, 1
¢
,
¡
−ν
2, 1
¢
,
¡ 1
2 −a + s, 1
¢
,
¡ 1
2 −b + s, 1
¢
¶
+
X
v∈Sν
Res
Ã
Γ
¡
w + ν
2
¢
Γ
¡
w −ν
2
¢
Z
¡
w + ν
2
¢
Z
¡
w −ν
2
¢
Γ(a + w −s) Γ(b + w −s)
z−w, w = v
!
.
Setting a = s + ν
2 + 1, b = s −ν
2, and using
H2,0
2,2
µ
z
¯¯¯¯
¡ ν
2 + 1, 1
¢
,
¡
−ν
2, 1
¢
¡ ν
2, 1
¢
,
¡
−ν
2, 1
¢
¶
= H1,0
1,1
µ
z
¯¯¯¯
¡ ν
2 + 1, 1
¢
¡ ν
2, 1
¢
¶
=
(
z
ν
2
|z| < 1,
0
|z| > 1,
(5.12)
and
H2,0
0,4
µ
z
¯¯¯¯
−
¡ ν
2, 1
¢
,
¡
−ν
2, 1
¢
,
¡
−1
2 −ν
2, 1
¢
,
¡ 1
2 + ν
2, 1
¢
¶
= z−1
4 F2ν+1
¡
4
4√z
¢
,
(5.13)
where
Fν(z) = −2
π sin
³ ν
2 π
´
Kν(z)−sin
³ ν
2 π
´
Yν(z)+cos
³ ν
2 π
´
Jν(z), (5.14)
and Yν denotes the Bessel function of the second kind, we get
z−ν X
k<z
σ2ν(k) = z
1
2
∞
X
k=1
σ2ν(k)
kν+ 1
2 F2ν+1
³
4π
√
zk
´
+
X
v∈Sν
Res
µζ(2w + ν) ζ(2w −ν)
w + ν
2
z2w, w = v
¶
,
(5.15)
where we have replaced z by
1
π2z2 .

A GENERAL MODULAR RELATION IN ANALYTIC NUMBER THEORY
233
Example 5.3. (Wilton’s formula [31]). As another example of (5.3),
we have
∞
X
k=1
σ2ν(k)
kν
H2,2
4,4
µ
zπ2k2
¯¯¯¯
(1 −a −s, 1), (1 −b −s, 1), (c −s, 1), (d −s, 1)
¡ ν
2, 1
¢
,
¡
−ν
2, 1
¢
, (1 −e −s, 1), (1 −f −s, 1)
¶
= z−1
2
∞
X
k=1
σ2ν(k)
kν
H4,0
2,6
µπ2k2
z
¯¯¯¯
−
¡ ν
2, 1
¢
,
¡
−ν
2, 1
¢
, (a−1
2 +s, 1), (b−1
2 +s, 1),
(e −1
2 + s, 1), (f −1
2 + s, 1)
( 1
2 −c+s, 1), ( 1
2 −d+s, 1)
¶
+
X
v∈Sν
Res
Ã
Γ
¡
w+ ν
2
¢
Γ
¡
w−ν
2
¢
Z
¡
w+ ν
2
¢
Z
¡
w−ν
2
¢
Γ(a+s−w)Γ(b+s−w)
Γ(c −s + w) Γ(d −s + w) Γ(e + s −w) Γ(f + s −w)
z−w, w = v
!
.
Let λ = 0, 1, 2, . . .. Setting a = −s −ν
2 −λ
2 + 1
2, b = −s −ν
2 −λ
2 , c = s −ν
2,
d = s + ν
2 + λ + 1, e = −s −ν
2 + 1
2, f = −s −ν
2 −λ, and using
H2,2
4,4
µ
z
¯¯¯¯
¡ ν
2 + λ
2 + 1
2, 1
¢
,
¡ ν
2 + λ
2 + 1, 1
¢
,
¡
−ν
2, 1
¢
,
¡ ν
2 + λ + 1, 1
¢
¡ ν
2, 1
¢
,
¡
−ν
2, 1
¢
,
¡ ν
2 + 1
2, 1
¢
,
¡ ν
2 + λ + 1, 1
¢
¶
= H1,2
3,3
µ
z
¯¯¯¯
¡ ν
2 + λ
2 + 1
2, 1
¢
,
¡ ν
2 + λ
2 + 1, 1
¢
,
¡ ν
2 + λ + 1, 1
¢
¡ ν
2, 1
¢
,
¡ ν
2 + 1
2, 1
¢
,
¡ ν
2 + λ + 1, 1
¢
¶
= H2,2
4,4
µ
z
¯¯¯¯
¡ ν
2 + λ
2 + 1
2, 1
¢
,
¡ ν
2 + λ
2 + 1, 1
¢
,
¡ ν
2 + 1
2, 1
¢
,
¡ ν
2 + λ + 1, 1
¢
¡ ν
2, 1
¢
,
¡ ν
2 + 1
2, 1
¢
,
¡ ν
2 + 1
2, 1
¢
,
¡ ν
2 + λ + 1, 1
¢
¶
= 2λ H1,0
1,1
µ√z
¯¯¯¯
(ν + λ + 1, 1)
(ν, 1)
¶
=





2λ
Γ(λ + 1) z
ν
2 ¡
1 −√z
¢λ
|z| < 1,
0
|z| > 1,
(5.16)
and
H4,0
2,6
µ
z
¯¯¯¯
−
¡ ν
2, 1
¢
,
¡
−ν
2, 1
¢
,
¡
−ν
2 −λ
2 , 1
¢
,
¡
−ν
2 −λ
2 −1
2, 1
¢
,
¡
−ν
2, 1
¢
,
¡
−ν
2 −λ −1
2, 1
¢
¡ ν
2 + 1
2, 1
¢
,
¡
−ν
2 −λ −1
2, 1
¢
¶
= H3,0
1,5
µ
z
¯¯¯¯
−
¡ ν
2, 1
¢
,
¡
−ν
2 −λ
2 , 1
¢
,
¡
−ν
2 −λ
2 −1
2, 1
¢
,
¡
−ν
2 −λ −1
2, 1
¢
¡ ν
2 + 1
2, 1
¢
,
¡
−ν
2 −λ −1
2, 1
¢
¶

234
HARUO TSUKADA
= H4,0
2,6
µ
z
¯¯¯¯
−
¡ ν
2, 1
¢
,
¡ ν
2 + 1
2, 1
¢
,
¡
−ν
2 −λ
2 , 1
¢
,
¡
−ν
2 −λ
2 −1
2, 1
¢
,
¡ ν
2 + 1
2, 1
¢
,
¡
−ν
2 −λ −1
2, 1
¢
¡ ν
2 + 1
2, 1
¢
,
¡
−ν
2 −λ −1
2, 1
¢
¶
= z−λ
4 −1
4 Gλ
2ν+λ+1
¡
4
4√z
¢
,
(5.17)
where
Gλ
ν(z) = −(−1)λ 2
π sin
µν −λ
2
π
¶
Kν(z)
−sin
µν −λ
2
π
¶
Yν(z) + cos
µν −λ
2
π
¶
Jν(z),
(5.18)
we get
2λ
Γ(λ + 1)
X
k<z
σ2ν(k)
¡
z −k
¢λ
= π−λ zν+ λ
2 + 1
2
∞
X
k=1
σ2ν(k)
kν+ λ
2 + 1
2 Gλ
2ν+λ+1
³
4π
√
kz
´
+
X
v∈Sν
Res
Ã
Γ
¡
w+ ν
2
¢
ζ(2w+ν)ζ(2w−ν) Γ
¡
−ν
2 −λ
2 + 1
2 −w
¢
Γ
¡
−ν
2 −λ
2 −w
¢
Γ
¡
w + ν
2 + λ + 1
¢
Γ
¡
−ν
2 + 1
2 −w
¢
Γ
¡
−ν
2 −λ −w
¢
zν+λ+2w, w = v
!
,
(5.19)
where we have replaced z by
1
π2z2 . This is the Wilton’s formula.
Acknowledgements
The author would like to thank Professor S. Kanemitsu for introducing him
to the world of analytic number theory and special functions [13,18]. This
work was not possible without his continuous encouragement and ongoing
friendship as well as his extensive and meticulous knowledge on the sub-
jects. The author would also like to thank the organizers of the conference,
especially Professor J. Liu for unforgettable excellent experience he had in
the beautiful city of Weihai.
References
1. B. C. Berndt, Identities involving the coeﬃcients of a class of Dirichlet series I,
Trans. Amer. Math. Soc., 137 (1969), 345–359.

A GENERAL MODULAR RELATION IN ANALYTIC NUMBER THEORY
235
2. B. C. Berndt, Identities involving the coeﬃcients of a class of Dirichlet se-
ries II, Trans. Amer. Math. Soc., 137 (1969), 361–374.
3. B. C. Berndt, Identities involving the coeﬃcients of a class of Dirichlet se-
ries III, Trans. Amer. Math. Soc., 146 (1969), 323–348.
4. B. C. Berndt, Identities involving the coeﬃcients of a class of Dirichlet se-
ries IV, Trans. Amer. Math. Soc., 149 (1970), 179–185.
5. B. C. Berndt, Identities involving the coeﬃcients of a class of Dirichlet se-
ries VI, Trans. Amer. Math. Soc., 160 (1971), 157–167.
6. S. Bochner, Some properties of modular relations, Ann. Math., 53 (1951),
332–363.
7. S. Bochner, On Riemann’s functional equation with multiple gamma factors,
Ann. Math., 67 (1958), 29–41.
8. K. Chandrasekharan and R. Narasimhan, Hecke’s functional equation and
arithmetical identities, Ann. Math., 74 (1961), 1–23.
9. M. A. Chaudhry and S. M. Zubair, On a Class of Incomplete Gamma Func-
tions with Applications, Chapman & Hall/CRC, 2001.
10. S. Chowla and A. Selberg, On Epstein’s zeta-function (I), Proc. Nat. Acad.
Sci. U.S.A., 35 (1949), 371–374.
11. P. P. Ewald, Die Berechnung optischer und elektrostatischer Gitterpotentiale,
Ann. d. Phys., 64 (1921), 253–287.
12. C. Fox, The G and H functions as symmetrical Fourier Kernels, Trans. Amer.
Math. Soc., 98 (1961), 395–429.
13. S. Kanemitsu, Hypergeometric functions as the special functions of the 21st
century, private communication, 2003.
14. S. Kanemitsu, Y. Tanigawa and H. Tsukada, A generalization of Bochner’s
formula, Hardy-Ramanujan J., 27 (2004), 28–46.
15. S. Kanemitsu, Y. Tanigawa and H. Tsukada, Some number theoretic applica-
tions of a general modular relation, International J. of Number Theory, (4)2
(2006), 599–615.
16. S. Kanemitsu, Y. Tanigawa and H. Tsukada, Contributions to the theory of
zeta-functions: the modular relation supremacy, in preparation.
17. S. Kanemitsu, Y. Tanigawa, H. Tsukada and M. Yoshimoto, Crystal sym-
metry viewed as zeta symmetry, Proceedings of Kinki University Symposium
“Zeta Functions, Topology and Quantum Physics 2003” (Developments in
Mathematics, Vol.14) 91–129, Springer, 2005.
18. S. Kanemitsu, Y. Tanigawa and M. Yoshimoto, On rapidly convergent series
for the Riemann-zeta values via the modular relation, Abh. Math. Sem. Univ.
Hamburg, 72 (2002), 187–206.
19. A. F. Lavrik, An approximate functional equation for the Dirichlet L-
function, Trady Moskov. Math. Obv sv c., 18 (1968), 91–104 = Trans.
Moskow Math. Soc. 18 (1968), 101–115.
20. A. M. Mathai and R. K. Saxena, The H-function with applications in statis-
tics and other disciplines, Wiley, New Delhi, 1978.
21. C. S. Meijer, ¨Uber Whittakersche bezw. Besselsche Funktionen und deren
Produkte, Nieuw Archief voor. Wiskunde, (2)18 (4tes Heft) (1936), 10–39.
22. C. S. Meijer, On the G-function I-VIII, Proc. Nederl. Akad. Wetensch., 49

236
HARUO TSUKADA
(1946), 227–237, 344–356, 457–469, 632–641, 765–772, 936-943, 1063–1072,
1165–1175.
23. A. Oppenheim, Some identities in the theory of numbers, Proc. London Math.
Soc., (2)26 (1927), 295–350.
24. R. B. Paris and D. Kaminski, Asymptotics and Mellin-Barnes Integrals, Cam-
bridge University Press, 2001.
25. A. P. Prudnikov, Yu. A. Bychkov and O. I. Marichev, Integrals and series,
supplementary chapters, Izd. Nauka, Moscow, 1986.
26. A. Selberg and S. Chowla, On Epstein’s zeta-function, J. Reine Angew.
Math., 227 (1967), 86–110.
27. A. Terras, Harmonic analysis on symmetric spaces and applications I, II,
Springer, New York, 1985.
28. H. Tsukada, A general functional equation in analytic number theory, pri-
vately circulated preprint, 2003.
29. K. Ueno and M. Nishizawa, Quantum groups and zeta-functions, in Quantum
Groups: Formalism and Applications, Proc. of the Thirtieth Karpacz Winter
School (Karpacz, 1994) (J. Lukierski et al., Editors), 115–126, Polish Sci.
Publ. PWN, Warsaw, 1995.
30. G. N. Watson, Some self-reciprocal functions, Quart. J. Math. Oxford Ser.,
2 (1931), 298–309.
31. J. R. Wilton, An extended form of Dirichlet’s divisor problem, Proc. London
Math. Soc., (2)36 (1933), 391–426.

237
L-FUNCTIONS OF FUNCTION FIELDS
DAQING WAN
Department of Mathematics, University of California,
Irvine, CA 92697-3875, U.S.A.
E-mail: dwan@math.uci.edu
This is a short expository paper on L-functions of function ﬁelds, based on the
author’s lecture given at the Weihai China-Japan Seminar on number theory.
1. Introduction
Let Fq be a ﬁnite ﬁeld of q elements with characteristic p. Let C be a
smooth projective geometrically connected curve deﬁned over Fq with func-
tion ﬁeld K. Let j : U ,→C be a Zariski open dense subset of C. Let
GK = Gal(Ksep/K) denote the absolute Galois group of K. For example,
we can take C = P1, U = P1 −{0, ∞} = Gm and K = Fq(t).
Let πarith
1
(U) denote the arithmetic fundamental group of U. That is,
πarith
1
(U) = GK/⟨Ix⟩x∈|U|,
where the denominator denotes the closed normal subgroup generated by
the inertial subgroups Ix as x runs over the closed points |U| of U. Let Dx
denote the decomposition group of GK at x. One has the following exact
sequence
1 →Ix →Dx →Gal(¯kx/kx) →1,
where kx denotes the residue ﬁeld of K at x. The Galois group Gal(¯kx/kx)
is topologically generated by the geometric Frobenius element Frobx:
Frob−1
x
: α →α#kx.
Let Px denote the p-Sylow subgroup of Ix. Then we have the following exact
sequence
1 →Px →Ix →Itame
x
=
Y
ℓ̸=p
Zℓ(1) →1.

238
DAQING WAN
Let Fℓbe a ﬁnite extension of Qℓ, where ℓis a prime number. Let Rℓ
be the ring of integers in Fℓ. Let V be a ﬁnite dimensional vector space
over Fℓ. Let
ρ : GK −→GL(V )
be a continuous representation of GK unramiﬁed on U. Equivalently,
ρ : πarith
1
(U) −→GL(V )
is a continuous representation of πarith
1
(U). The L-function of ρ on U is
deﬁned by
L(U, ρ) =
Y
x∈|U|
1
det(I −ρ(Frobx)T deg(x)|V ) ∈1 + TRℓ[[T]].
Similarly, the complete L-function of ρ on C is deﬁned by
L(C, ρ) =
Y
x∈|C|
1
det(I −ρ(Frobx)T deg(x)|V Ix) ∈1 + TRℓ[[T]],
where V Ix is the subspace of V which Ix acts trivially. These two L-
functions just diﬀer by a ﬁnite number of Euler factors. We are interested in
analytic properties of these L-functions, especially for those representations
which come from geometry, that is, arising as the relative `etale cohomology
with compact support of a family of varieties f : X →U.
2. ℓ-adic cae: ℓ̸= p
Since ℓ̸= p, the restriction of the ℓ-adic representation ρ to Px is of ﬁnite
order and thus the representation ρ is almost tame. In fact, by class ﬁeld
theory, ρ itself has ﬁnite order up to a twist if ρ has rank one. Thus, there are
not too many such ℓ-adic representations. The L-function L(U, ρ) is always
a rational function. This follows from Grothendieck’s trace formula [7]:
Theorem 2.1. Let Fρ denote the lisse ℓ-adic sheaf on U associated with ρ.
Then, there are ﬁnite dimensional vector spaces Hi
c(U ⊗¯Fq, Fρ) (i = 0, 1, 2)
over Fℓsuch that
L(U, ρ) =
2
Y
i=0
det(I −FrobqT|Hi
c(U ⊗¯Fq, Fρ))(−1)i−1 ∈Fℓ(T).
If U is aﬃne, then H0
c = 0. If ρ does not contain geometrically triv-
ial component, then H2
c = 0. Thus, in most cases, it is H1
c that is most
interesting.

L-FUNCTIONS OF FUNCTION FIELDS
239
Corollary 2.1. Let U be aﬃne. Assume that ρ does not contain geomet-
rically trivial component. Then, the L-function
L(U, ρ) = det(I −FrobqT|H1
c (U ⊗¯Fq, Fρ))
is a polynomial.
This is the ℓ-adic function ﬁeld analogue of Artin’s entireness conjecture.
Fix an embedding ι : ¯Qℓ,→C. A representation ρ is called ι-pure of
weight w ∈R if each eigenvalue of Frobx acting on V has absolute value
qdeg(x)w/2 for all x ∈|U|. A representation ρ is called ι-mixed of weights at
most w if each irreducible component of ρ is ι-pure of weights at most w.
If ρ is ι-pure of weight w for every embedding ι, then ρ is called pure of
weight w. Similarly, if ρ is ι-mixed of weights at most w for every ι, then ρ is
called mixed of weights at most w. The fundamental theorem of Deligne [2]
on the Weil conjectures implies
Theorem 2.2. If ρ is geometric, then ρ is mixed with integral weights.
Furthermore, if ρ is mixed of weights at most w, then Hi
c(U ⊗¯Fq, Fρ) is
mixed of weights at most w + i.
The ℓ-adic function ﬁeld Langlands as established by Laﬀorgue [9] im-
plies
Theorem 2.3. If ρ is irreducible, then ρ is geometric up to a twist and
hence pure of some weight.
Thus, in the ℓ-adic case with ℓ̸= p, essentially all ℓ-adic representations
are geometric from L-function point of view.
3. p-adic case
In the case ℓ= p, the restriction of the p-adic representation ρ to Px can be
inﬁnite and thus ρ can be very wildly ramiﬁed. The L-function L(U, ρ) is
naturally more complicated and cannot be rational in general. One can ask
for its p-adic meromorphic continuation. The function L(U, ρ) is trivially
p-adic analytic in the open unit disc |T|p < 1 as the coeﬃcients are in the
ring Rp. It was shown in [11] that L(U, ρ) is not p-adic meromorphic in
general, disproving a conjecture of Katz [8]. However, one can show that
L(U, ρ) is p-adic meromorphic on the closed unit disc |T|p ≤1. Its zeros and
poles on the closed unit disc are explained by p-adic `etale cohomology of ρ.
This was proved by Emerton-Kisin [4], conﬁrming a conjecture of Katz [8].
That is,

240
DAQING WAN
Theorem 3.1. For any p-adic representation ρ of πarith
1
(U), the quotient
L(U, ρ)
Q2
i=0 det(I −FrobqT|Hic(U ⊗¯Fq, Fρ))(−1)i−1
has no zeros and poles on the closed unit disc |T|p ≤1.
In the case that ρ has rank one, this was ﬁrst proved by Crew [1].
For geometric p-adic representation, the following meromorphic contin-
uation was conjectured by Dwork [3] and proved by Wan [12,13].
Theorem 3.2. If the p-adic representation ρ is geometric, then the L-
function L(U, ρ) is p-adic meromorphic everywhere.
Unlike the ℓ-adic case, most p-adic representations are not geometric. It
seems very diﬃcult to classify geometric p-adic representations, even in the
rank one case. This can be viewed as the p-adic function ﬁeld Langlands
program, which is still wide open even for rank one case.
We remark that the Artin entireness conjecture fails for L-function
L(U, ρ) of geometric p-adic representation, even for non-trivial rank one ρ.
From the proof in [12], one can understand why this is the case. The ge-
ometric p-adic representation ρ is an eﬀective object in the category of
geometric p-adic representations, but it is really not eﬀective in the larger
category of L-functions of inﬁnite rank nuclear overconvergent σ-modules,
where the L-function is known to be p-adic meromorphic. It is an virtual
object!
For example, if the p-adic representation ρ is of rank one and ρ is the
slope zero piece of a rank n geometric ℓ-adic representation ψℓof πarith
1
(U),
then
L(U, ρ) =
n
Y
j=0
lim
k→∞L(U, Sym1+(p−1)pk−iψℓ⊗∧iψℓ)(−1)i−1i.
Each of the above limit exists as a formal p-adic power series and they
can be viewed as the L-function of some inﬁnite rank ℓ-adic representation
with p-adic values. These L-functions of inﬁnite symmetric powers are p-
adic entire (Artin conjecture holds), not just p-adic meromorphic. For two
important examples with much greater details, see the recent papers by
Fu-Wan [5,6] for the n-dimensional Kloosterman case, and by Roja-Leon
and Wan [10] for the n-dimensional Calabi-Yau hypersurface case.

L-FUNCTIONS OF FUNCTION FIELDS
241
References
1. R. Crew, L-functions of p-adic characters and geometric Iwasawa theory,
Invent. Math., 88 (1987), 395–403.
2. P. Deligne, La Conjecture de Weil II, Inst. Hautes ´Etudes Sci. Publ. Math.,
52 (1980) 137–252.
3. B. Dwork, Normalized period matrices II, Ann. Math., 98 (1973), 1–57.
4. M. Emerton and M. Kisin, Unit L-functions and a conjecture of Katz, Ann.
Math., (2)153 (2001), 329–354.
5. L. Fu and D. Wan, L-functions for symmetric products of Kloosterman sums,
J. Reine Angew. Math., 589 (2005), 79–103.
6. L. Fu and D. Wan, Trivial factors for L-functions of symmetric products of
Kloosterman sheaves, Compositio Math., to appear.
7. A. Grothendieck, Formule de Lefschetz et rationalit´e des fonctions L
S´eminaire Bourbaki, expos´e 279(1964/65).
8. N. Katz, Travaux de Dwork, S´eminaire Bourbaki, expos´e 409(1971/72), Lec-
ture Notes in Math., 317 (1973), 167–200.
9. L. Laﬀorgue, Chtoucas de Drinfeld et Correspondance de Langlands, Invent.
Math., (1)147 (2002), 1–241.
10. A. Rojas-Leon and D. Wan, Moment zeta functions for toric Calabi-Yau
hypersurfaces over ﬁnite ﬁelds, arXiv:math.AG/0702679.
11. D. Wan, Meromorphic continuation of L-functions of p-adic representations,
Ann. Math., 143 (1996), 469–498.
12. D. Wan, Rank one case of Dwork’s conjecture, J. Amer. Math. Soc., 13
(2000), 853–908.
13. D. Wan, Higher rank case of Dwork’s conjecture, J. Amer. Math. Soc., 13
(2000), 807–852.

This page intentionally left blank
This page intentionally left blank

243
INDEX
abelian group, 190, 200, 202–205,
207–209
algebraic number ﬁeld, 39, 42, 43,
45, 58, 72, 89, 90, 92, 93
Alon-Nathanson-Ruzsa
theorem,
194
analytic continuation, 108, 112, 129,
132
automorphic L-function, 108, 109,
112, 115, 118
Bessel function, 115, 116, 118
Bochner’s formula, 224, 227
Cauchy-Davenport
theorem,
190,
204
character sums, 158, 168, 180, 184
Chebotarev’s density theorem, 39,
40
circle method, 112, 115, 116, 119
coeﬃcient, 192, 194, 198, 206
Combinatorial Nullstellensatz, 192–
194, 201, 205, 210
convexity bound, 109, 110
convexity principle, 100, 109
Cremona transformation, 142
Deligne’s theorem, 105
δ-symbol method, 116
descent-generic, 143
determinant, 197
diﬀerence-operator argument, 18
Dirichlet L-function, 109
Dirichlet series, 217
discrepancy, 159, 160, 164, 184
discriminant of a cubic polynomial,
140, 141, 145
Dwork conjecture, 240
Eisenstein series, 114, 115
elliptic curve, 24, 26, 33, 157, 182
Erd˝os-Heilbronn
conjecture,
191,
204
eta function, 231
Euler-Zagier (r-fold) sum, 2
ﬁeld, 190
Fox H-function, 215
Frobenius automorphism, 41, 43,
45–48
function ﬁeld, 237, 239, 240
functional equation, 217
functional equation of Hecke type,
223
Gamma factor, 215
Generalized
Lindel¨of
Hypothesis,
109
Generalized Ramanujan Conjecture,
124
Generalized
Riemann
Hypothesis,
109
generic, 139
generic polynomial, 136, 137
Goldbach’s problem, 6
H-function series, 219
Hecke eigenvalue, 105
Hecke operator, 104, 110
Hessian elliptic curve, 137, 148
Hilbert’s ramiﬁcation Theory, 45
holomorphic Hecke eigenform, 108,
110, 112, 115, 118, 121, 124, 130
Hurwitz zeta-function, 229

244
INDEX
Hurwitz’s formula, 228
incomplete Gamma expansion, 227
Iwasawa decomposition, 110
K-Bessel expansion, 226
Kloosterman sum, 114, 115, 118,
156, 158, 163, 170, 180–182, 184,
185
Koecher-Maass Dirichlet series, 103
Kuznetsov trace formula, 134
L-function, 238–240
Latin transversal of a cube, 204
Lerch zeta-function, 229
Lev’s conjecture, 204, 205
level, 111, 112, 130
Maass eigenform, 108, 110, 111, 115
Meijer G-function, 216
Mellin transformation formula, 14
Mellin-Barnes integral formula, 2
meromorphic continuation, 1–3, 10
modular relation, 219
Mordell curve, 137
Mordell’s equation, 146
multiple Dirichlet series, 1, 2
multiple L-series, 3
multiple zeta-function, 1
natural boundary, 1, 4, 5, 7, 20
newform, 99, 100, 102
non-congruent number, 24–28, 30,
31, 33–37
non-Euclidean Laplacian, 113
normalized Hecke eigenform, 97, 99–
102
odd graph, 24, 26, 30–32
Oppenheim’s formula, 232
p-adic representation, 239, 240
parametric, 138
permanent, 197–199
Perron’s formula, 6, 114
Petersson norm, 98
Petersson trace formula, 114
Phragm´en-Lindel¨of convexity prin-
ciple, 17, 109
Poincar´e series, 108, 115, 123
polylogarithm function, 229
polynomial method, 191, 192, 195,
201, 206, 209
quadratic twist, 152
quadratic twist of a Hessian curve,
151
quadratic twist of a Hessian elliptic
curve, 137
Ramanujan-Petersson
conjecture,
105
Rankin-Selberg
L-function,
111,
112, 122
Rankin-Selberg zeta function, 102
restricted sumset, 190, 199–201, 205,
206
Riemann hypothesis, 5
Riemann zeta-function, 1, 4, 109,
115, 223
Riesz mean, 1, 5, 14
Riesz sum, 225
Satake p-parameters, 104
Selberg trace formula, 113
Selmer group, 24, 26, 27, 33
shifted convolution sum, 108, 112–
115, 118, 120, 132
Siegel modular group of genus g, 103
Snevily’s conjecture, 200, 201, 203,
209
spectral decomposition, 113, 123,
132
spectral large sieve, 108, 126, 132
spinor zeta function, 104, 105
sub-convexity bound, 101
subconvexity, 108, 109, 111, 112,
118, 121, 122, 124, 130
symmetric square L-function, 100
symplectic group, 103
tangential method, 149, 151

INDEX
245
the set of rational points of E over
Q, 146
twist of a Hessian curve, 150
twist of a Hessian elliptic curve, 137
twist of an algebraic curve, 149
twist of an elliptic curve, 149
2-descent method, 26, 27, 33
unit, 39, 42, 46, 49, 72–74, 76, 78,
80, 82, 83, 87, 89, 94, 95
value set, 210
von Mangoldt function, 4
Voronoi’s summation formula, 121
weakly
symmetric
Riemannian
space, 113
weight, 108, 110–112, 114, 115, 118,
121, 122, 124, 125, 130
Weil conjectures, 239
Weyl-like bound, 109, 110, 112, 133
Wilton’s formula, 233

