1
Vol.:(0123456789)
Scientific Reports |        (2021) 11:15342  
| https://doi.org/10.1038/s41598-021-94331-0
www.nature.com/scientificreports
A new spectral invariant 
for quantum graphs
Michał Ławniczak1*, Pavel Kurasov2*, Szymon Bauch1, Małgorzata Białous1, 
Afshin Akhshani1 & Leszek Sirko1*
The Euler characteristic i.e., the difference between the number of vertices |V| and edges |E| is the 
most important topological characteristic of a graph. However, to describe spectral properties of 
differential equations with mixed Dirichlet and Neumann vertex conditions it is necessary to introduce 
a new spectral invariant, the generalized Euler characteristic χG := |V| −|VD| −|E| , with |VD| 
denoting the number of Dirichlet vertices. We demonstrate theoretically and experimentally that the 
generalized Euler characteristic χG of quantum graphs and microwave networks can be determined 
from small sets of lowest eigenfrequencies. If the topology of the graph is known, the generalized 
Euler characteristic χG can be used to determine the number of Dirichlet vertices. That makes the 
generalized Euler characteristic χG a new powerful tool for studying of physical systems modeled 
by differential equations on metric graphs including isoscattering and neural networks where both 
Neumann and Dirichlet boundary conditions occur.
The problem of seven bridges of Königsberg considered by Leonhard Euler in ­17361 laid the foundation of clas-
sical, combinatorial graph theory and topology. Two hundred years later Linus ­Pauling2 applied the concept of 
graphs to describe the motion of a quantum particle in a physical network. This approach, now known as the 
quantum graph model, is widely used in the study of physical systems, e.g., quantum ­wires3, mesoscopic quantum 
­system4,5, spectra of graphene and carbon ­nanotubes6, Bose–Einstein ­condensates7,8, Anderson ­localization9 
and optical wave ­guides10. In 1948, ­Feynman11 introduced diagrams (graphs) as pictorial representation of the 
mathematical expressions describing the behavior and interaction of subatomic particles.
The theory of quantum graphs has been a subject of intense ­research12–17. The metric graph Ŵ = (V, E) consists 
of edges e ∈E being intervals of the length le on the real line R connected at the vertices v ∈V , which are defined 
as the unions of edges endpoints. Such a graph uniquely determines the Laplace operator L(Ŵ) = −d2
dx2 acting in 
the Hilbert space of square integrable functions. L(Ŵ) is self-adjoint, its spectrum is discrete and ­nonnegative15. 
When a graph has only vertices VN with Neumann (called also standard, natural) vertex boundary conditions: 
functions are continuous at vertices and the sums of their oriented derivatives at vertices are equal zero, then 
the Laplacian has a simple zero eigenvalue with the eigenfunction being a constant. Introducing even one vertex 
VD with the Dirichlet boundary condition (a functions is zero at the vertex) into the graph causes that spectral 
multiplicity of the eigenvalue 0 to become zero instead of one.
In this article we generalize the notion of the Euler ­characteristic18 to graphs possessing vertices with both 
Neumann and Dirichlet boundary conditions. We show that for such graphs it is possible to determine the gen-
eralized Euler characteristic χG from small sets of their lowest eigenvalues 1, . . . , N.
The experimental verification of our theoretical findings is carried out using the spectra of microwave net-
works which simulate quantum ­graphs19–24. This is attainable because the one-dimensional Schrödinger equation 
describing quantum graphs is formally equivalent to the telegrapher’s equation for microwave ­networks19,22. The 
microwave networks are extremely useful in studying quantum and wave chaos. Uniquely they allow for the 
experimental realization of systems described by the main three symmetry classes in random-matrix theory 
(RMT): systems with preserved time reversal symmetry (TRS) represented by Gaussian orthogonal ensem-
ble (GOE)18–21,23,25,26; systems with preserved TRS and half-spin represented by Gaussian symplectic ensemble 
(GSE)27,28; systems without TRS represented by Gaussian unitary ensemble (GUE)19,24,29–33. The chiral orthogonal, 
unitary, and symplectic ­ensembles34 have been recently realized using microwave networks. Microwave networks 
have been also used to study a topological edge ­invariant35,36 and the photon number statistics of coherent 
­light37. Therefore, microwave networks as well as flat microwave ­cavities38–47 and Rydberg atoms strongly driven 
by microwave ­fields48–51 have become one of the most important model systems, that are successfully used in 
experimental modeling of complex quantum systems.
OPEN
1Institute of Physics, Polish Academy of Sciences, Aleja Lotników 32/46, 02‑668 Warszawa, Poland. 2Department 
of Mathematics, Stockholm University, 106 91  Stockholm, Sweden. *email: lawni@ifpan.edu.pl; kurasov@
math.su.se; sirko@ifpan.edu.pl

2
Vol:.(1234567890)
Scientific Reports |        (2021) 11:15342  | 
https://doi.org/10.1038/s41598-021-94331-0
www.nature.com/scientificreports/
The generalized Euler characteristic for quantum graphs with Dirichlet boundary 
conditions
One of the most important characteristic of a metric graph is the Euler characteristic
where |V| and |E| denote the number of vertices and edges, respectively.
The Euler characteristic χ determines another important quantity characterizing the graph, the number of 
independent cycles β in it
This number, known also as the first Betti number, tells us how many edges have to be removed from the 
connected graph in order to turn it into a tree graph.
In this article we will demonstrate that vertices with Dirichlet boundary conditions (Dirichlet vertices) play 
an important role in graph spectral characteristics, leading to a new spectral invariant, called generalized Euler 
characteristic
where |VD| is the number of Dirichlet vertices.
Our goal is to relate the generalized Euler characteristic χG to the spectrum of the Laplace operator L = −d2
dx2 
on the metric graph Ŵ . One usually assumes standard vertex conditions: continuity of functions and Neumann 
conditions on the sum of the first derivatives. This case was comprehensively treated in Ref.18. Here, we will 
generalize the results obtained in Ref.18 to the case of mixed standard (Neumann) and Dirichlet vertex condi-
tions. We assume that Dirichlet conditions are imposed only at degree one vertices of pendent edges since higher 
degree Dirichlet vertices should be treated as separate degree one Dirichlet vertices. Standard vertex conditions 
at degree one vertices are equivalent to Neumann conditions since the continuity condition is redundant. In what 
follows, the degree one vertices in Ŵ are divided into two classes: Neumann and Dirichlet vertices, respectively. 
We shall always assume standard conditions at the vertices with the degree larger than 1.
The Laplace operator is self-adjoint and is uniquely determined by Ŵ and the set VD of Dirichlet vertices. The 
spectrum is discrete bounded from below 0 < 1 < 2 ≤3 < . . . and satisfies Weyl’s law
where L is the total length of the graph and O(n) is a function which divided by n in the limit n →∞ is bounded 
by a constant. Note that 1  = 0 provided Ŵ is connected and |VD| > 0 holds.
For graphs with standard vertex conditions at all vertices the following formula for the Euler characteristic 
was ­proven18:
where (Lst(Ŵ)) denotes the spectrum of the Laplacian Lst(Ŵ) with standard vertex conditions, taken in the 
square root scale, i.e., the numbers kn are the square roots of the eigenenergies n and t0 =
1
2lmin , where lmin is 
the length of the shortest edge of the graph. If the summation sequence in Eq. (5) contains an infinite number of 
terms, t ≥t0 is an arbitrary free parameter. However, we will show that in the case of limited number of eigen-
values kn the value of t should be limited from above by some tmax.
Formula (5) was obtained using the trace formula connecting the spectrum of the Laplacian to the set of 
periodic orbits on the metric ­graph52–55 applying it to a carefully chosen test ­function18,56–58. Our objective is to 
generalize this formula by including Dirichlet vertices. This is important because for example both Dirichlet 
and Neumann conditions appear in the isoscattering and neural networks, where for the latter ones they appear 
naturally as a result of learning ­procedures59.
Let Ŵ be a finite connected metric graph with |VD| Dirichlet vertices v1, v2, . . . , v|VD| . We assume standard 
vertex conditions at all other vertices. The corresponding Laplace operator will be denoted by Lst,D(Ŵ) . Let us 
double the graph by adding to Ŵ another copy of the same graph and gluing them by joining pairwise the ver-
tices vj, j = 1, 2, . . . , |VD|. Let us denote the metric graph obtained in this way by Ŵ2. This graph is symmetric 
with respect to the exchange of the respective points on the two copies of Ŵ . Hence all eigenfunctions and the 
spectrum can be divided into two classes:
•	 symmetric eigenfunctions satisfying Neumann conditions at vj, j = 1, 2, . . . , |VD| , the spectrum coincides 
with the spectrum of the standard Laplacian Lst(Ŵ);
•	 antisymmetric eigenfunctions satisfying Dirichlet conditions at vj, j = 1, 2, . . . , |VD| , the spectrum coincides 
with the spectrum of Lst,D(Ŵ) for which kn  = 0.
Let χ be the Euler characteristic of Ŵ , then Ŵ2 has −2χ + |VD| −1 independent cycles and its Euler characteristic 
is 2χ −|VD| .
Applying the formula (5) to standard Laplacians on Ŵ and Ŵ2 we get
(1)
χ = |V| −|E|,
(2)
β = |E| −|V| + 1 ≡1 −χ.
(3)
χG = χ −|VD|,
(4)
n =
π
L
2
n2 + O(n) ,
(5)
χ = 2 + 8π2

kn ∈(Lst(Ŵ))
kn = 0
sin(kn/t)
(kn/t)

(2π)2 −(kn/t)2|t≥t0,

3
Vol.:(0123456789)
Scientific Reports |        (2021) 11:15342  | 
https://doi.org/10.1038/s41598-021-94331-0
www.nature.com/scientificreports/
where (·) denote the spectra of different Laplacians on Ŵ2 and Ŵ , again considered in the square root scale. 
Then the formula (5) implies that
Hence the Euler characteristic χ alone is not a proper spectral invariant in the case of Laplacians with Dirichlet 
vertices, we have to replace it by the invariant χG introduced above. It generalizes naturally the Euler character-
istic and has the following important property: any two isospectral graphs with mixed standard and Dirichlet 
conditions necessarily have the same χG . This property of χG will be checked experimentally in this article using 
two isoscattering and therefore isospectral microwave ­networks21,60.
It is important to point out that the generalized Euler characteristic χG is an integer. Therefore, to determine 
its value precisely it is enough to calculate it with an accuracy better than 1/2. It means that infinite series on the 
right-hand of the Eq. (7) can be substituted with a finite sum. This is essential because in the real world of physical 
measurements it is not possible to determine the entire spectrum of the tested system. In microwave experiments 
internal absorption and openness of systems limit from the top the frequency range in which eigenfrequencies 
(resonances) can be determined.
To determine how many terms (resonances) in the formula (7) are required to get the value of χG with the 
accuracy ǫ better than 1/2 the following relations will be considered assuming t ≥t0:
It is necessary to choose K sufficiently large to guarantee ǫ < 1/2 . Such an estimate for t = t0 =
1
2lmin has 
been carried out in Appendix of Ref.18 in the case of standard boundary conditions. The existence of Dirichlet 
vertices does not change the estimate for the minimum number of resonances:
where |V| is the total number of graph vertices. The smallest number of resonances K = Kmin is obtained by sub-
stituting the smallest allowed value of t, that is t = t0 . In the calculation of Kmin we will also assume that ǫ = 1/4.
Equation (9) demonstrates that in the evaluation of XG
K (t = t0) (Eq. (8)) it is enough to use only a limited 
number of terms K = Kmin . In such a case, as mentioned above, in the behavior of XG
Kmin(t) for t > t0 one expects 
to observe a plateau which will be destroyed for t ≃tmax . We are interested in getting a rough estimate for the 
maximum allowed value of t. For this purpose for Lt ≫1 we will approximate (9) with a formula
Assuming that ǫ = 1/4 and t = t0 , for which K = Kmin , Eq.(10) can be used to define the maximum allowed 
value of tmax for which K = Kmin is preserved but ǫ was increased to ǫmax = 1 . This yields a simple relationship 
between an approximated tmax and t0
How to hear the boundary conditions of quantum graphs?
From the theoretical point of view looking at the eigenvalue  = 0 one can easily identify whether some of the 
vertex conditions on a connected metric graph are Dirichlet or not:  = 0 is an eigenvalue of the Laplacian if 
and only if all vertex conditions are Neumann.
To determine the number of Dirichlet vertices one may use
•	 the generalized Euler characteristic χG = χ −|VD| determined by the Laplacian spectrum via explicit formula 
(7);
(6)
2χ −|VD| = 2 + 8π2

kn ∈(Lst(Ŵ2))
kn = 0
sin(kn/t)
(kn/t)

(2π)2 −(kn/t)2
= 2 + 8π2

kn ∈(Lst(Ŵ))
kn = 0
sin(kn/t)
(kn/t)

(2π)2 −(kn/t)2



= χ
+8π2

kn∈(Lst,D(Ŵ))
sin(kn/t)
(kn/t)

(2π)2 −(kn/t)2,
(7)
χG := χ −|VD| = 8π2

kn∈(Lst,D(Ŵ))
sin(kn/t)
(kn/t)((2π)2 −(kn/t)2).
(8)
XG
K (t) := 8π2
K

n=1
sin(kn/t)
(kn/t)((2π)2 −(kn/t)2)
ǫ
:=
 XG(t)
  
= χG
−XG
K (t)
 =
8π2
∞

n=K+1
sin(kn/t)
(kn/t)((2π)2 −(kn/t)2)
.
(9)
K ≥

|V| + 2Lt

1 −exp
−ǫπ
Lt
−1/2
,
(10)
K ≥

|V| +
2
√ǫπ (Lt)3/2

.
(11)
tmax ≃41/3t0 ≃1.59t0.

4
Vol:.(1234567890)
Scientific Reports |        (2021) 11:15342  | 
https://doi.org/10.1038/s41598-021-94331-0
www.nature.com/scientificreports/
•	 the conventional Euler characteristic χ = |V| −|E| , which can be obtained, e.g., by visually examining the 
number β = 1 −χ of independent cycles in the graph.
Having determined these numbers, the number of Dirichlet vertices is given by
This formula reminds that the generalized Euler characteristic is an integer that cannot exceed the topologi-
cal Euler characteristic χ.
From the experimental point of view the situation is more complicated because identification whether  = 0 
is an eigenvalue of an investigated system maybe impossible. In such a case, the number of Dirichlet vertices 
can be evaluated in the following way.
Taking into account the properties of the formula (5) one can find out that if the generalized Euler character-
istic χG evaluated from the spectral formula (7) (right-hand side of Eq. (7)) fulfills the condition
one deals with a graph which possesses Dirichlet vertices and their number is given by the formula (12).
In the case when
one deals with a graph which possesses either 0 or 2 Dirichlet vertices and an additional information is required 
to find their actual number.
The latter case can be illustrated using a single interval graph ( |V| = 2 , |E| = 1 , χ = 1 ) of length π . The spec-
trum of the standard Laplacian is 0, 1, 2, . . . , while the spectrum of the Dirichlet Laplacian, with two Dirichlet 
vertices, |VD| = 2 , is 1, 2, 3 . . . . Summing the series (5) and (7) over non-zero spectra of the respective Laplacians 
one obtains χ −2 = −1 and χG = −1 . The same outcome of the calculations shows that we cannot determine 
whether we deal with the standard Laplacian, where we lost  = 0 eigenvalue, or with the Dirichlet Laplacian, 
where such an eigenvalue does not exist.
However, if the experiment yields that  = 0 is not an eigenvalue of the system, the number of Dirichlet 
vertices is directly given by the formula (12).
Experimental setup and methodology of measurements
To test the formula (7) for the generalized Euler characteristic χG we identified experimentally the required by 
Eq. (9) numbers of resonances of microwave networks simulating quantum graphs without loops with Dirichlet 
boundary conditions.
The experimental setup (see Fig. 1a), standard for such measurements, consists of the Agilent E8364B vec-
tor network analyzer (VNA) and the HP 85133-616 high class flexible microwave cable that connects the VNA 
with the measured network. Such a cable is equivalent to attaching an infinite lead to a quantum ­graph18,25. To 
eliminate the influence of the external to the network elements on measurement results the VNA was calibrated 
with an Agilent 4691-60004 electronic calibration module.
Quantum graphs are simulated by microwave networks containing coaxial cables and junctions that corre-
spond to the edges and vertices of the graphs. The cables are composed of an inner conductor of a radius r1 = 0.05 
cm surrounded by the dielectric material (Teflon) and an outer concentric conductor with an inner radius 
r2 = 0.15 cm. The dielectric constant of Teflon measured by us equals ε = 2.06 . So the cut-off frequency of the 
TE11 below which only the fundamental TEM can propagate in the ­cable61,62 is υcut =
c
π(r1+r2)√ε = 33 GHz. The 
physical lengths lph of the cables determine the optical lengths of the graph edges through relationship 
lopt = √εlph.
In order to identify the resonances of the networks in a required frequency range, starting from the lowest 
one ν1 , we carried out the measurements of their one-port scattering matrix S11(ν) . To verify the completeness of 
the sets of resonances the fluctuating part of the integrated spectral counting function Nﬂ(νi) = N(νi) −Nav(νi) , 
that is the difference of the number of eigenfrequencies N(νi) = i for ordered frequencies ν1 ≤ν2 ≤· · · and 
the average number of eigenfrequencies Nav(νi) calculated for the tested frequency range, was analyzed. The 
resonance frequencies give directly the real part of the wave vectors Re kn = 2π
c νn . In the case of isoscattering 
networks the two-port scattering matrix ˆS(ν) was measured and the resonances were identified from the ampli-
tude of the determinant of the scattering matrix ˆS(ν) . The details of this experimental procedure are given in 
details in Refs.21,60.
Experimental results
To simplify the description of the networks we introduce the following notation of graphs and networks 
Ŵ(|V|, |E|, |VD|) , where |V| = |VN| + |VD| . A network Ŵ(|V|, |E|, |VD|) contains |V| vertices, including |VN| 
and |VD| vertices with Neumann and Dirichlet boundary conditions and |E| edges.
In order to test the formula (7) we considered the microwave networks simulating the following quan-
tum graphs: 6-vertex graphs with two tail-like edges Ŵ(6, 8, |VD| = 0, 1, 2) , two isoscattering graphs Ŵ(4, 4, 1) 
(O-graph) and Ŵ(6, 5, 2) (H-graph), and the star graphs Ŵ(4, 3, |VD| = 0, 1, 2, 3).
(12)
|VD| = χ −χG.
(13)
χ −χG = 2
(14)
χ −8π2

kn ∈
kn = 0
sin(kn/t)
(kn/t)

(2π)2 −(kn/t)2 = 2

5
Vol.:(0123456789)
Scientific Reports |        (2021) 11:15342  | 
https://doi.org/10.1038/s41598-021-94331-0
www.nature.com/scientificreports/
Microwave 
networks 
Ŵ(6, 8, |VD| = 0, 1, 2). 
The 
network 
simulating 
quantum 
graphs 
Ŵ(6, 8, |VD| = 0, 1, 2) (see Fig. 1a) of the total optical length L = 2.377 m consists of six vertices and eight edges 
of the lengths l1,2 = 0.237 m, l1,3 = 0.289 m, l1,4 = 0.382 m, l2,3 = 0.261 m, l2,4 = lmin = 0.221 m, l3,4 = 0.249 
m, l2,5 = 0.313 m, l4,6 = 0.425 m. The lower indices are the numbers of the vertices connected by the edges. The 
minimum number of the resonances necessary to get the Euler characteristic with accuracy ǫ = 1/4 , Kmin = 35 , 
which corresponds to the frequency ν ≃2.25 GHz. The values of the parameters t0 = 2.26 and tmax ≃3.6 . The 
resonances of the network were measured for various boundary conditions of the tail-like edges l2,5 and l4,6 
denoted in Fig. 1a with N and D for Neumann and Dirichlet boundary conditions, respectively. Four combina-
tions of the boundary conditions and the expected Euler characteristic χ18 or generalized Euler characteristic χG 
are presented in Table 1.
The results obtained from the spectral formula (5) for the approximation function of the Euler characteristic 
XK(t) in Ref.18 and from Eq. (8) for the approximation function of the generalized Euler characteristic XG
K (t) 
as a function of t are shown in Fig. 2a. The approximation function XK(t) (blue full line) was calculated for the 
6-vertex network Ŵ(6, 8, 0) with two tail-like edges with Neumann boundary conditions. The approximation func-
tions XG
K (t) were evaluated for the networks Ŵ(6, 8, 1) (red full line—Dirichlet vertex (DV) on edge l2,5 , red dotted 
line—DV on edge l4,6 ) and Ŵ(6, 8, 2) (black full line), respectively. The Euler characteristic χ and the generalized 
Euler characteristic χG were obtained as the values of the plateaux observed in the approximation functions 
XK(t) and XG
K (t) , respectively, for t ≥t0 , and K = Kmin . The experimental values of the Euler characteristic χ 
and the generalized Euler characteristic χG are in agreement with the predicted theoretical ones shown in Table 1.
Figure 1.   (a) The experimental setup consists of the Agilent E8364B vector network analyzer (VNA) and 
the HP 85133-616 flexible microwave cable that connects the VNA with the measured network simulating 
quantum graphs Ŵ(6, 8, |VD| = 0, 1, 2) possessing two tail-like edges l2,5 and l4,6 . The resonances of the network 
were measured for various boundary conditions of the tail-like edges l2,5 and l4,6 marked with N and D capital 
letters for Neumann and Dirichlet boundary conditions, respectively. The same convention will be also used 
throughout the other panels. The inset shows an example of the modulus of a single port scattering matrix 
|S11(ν)| of the network Ŵ(6, 8, |VD| = 2) measured in a frequency range 0.001–1 GHz. (b) The isoscattering 
networks simulating quantum graphs Ŵ(4, 4, 1) (O-graph) and Ŵ(6, 5, 2) (H-graph). In this case the two-
port scattering matrices ˆSO(ν) and ˆSH(ν) were measured in a function of microwave frequency ν21,60. (c) The 
microwave network which was used to simulate the star graphs Ŵ(4, 3, 0) , Ŵ(4, 3, 1) , Ŵ(4, 3, 2) and Ŵ(4, 3, 3) . The 
network consists one vertex of valency four and three edges terminated with the vertices of valency one.

6
Vol:.(1234567890)
Scientific Reports |        (2021) 11:15342  | 
https://doi.org/10.1038/s41598-021-94331-0
www.nature.com/scientificreports/
(a)
(b)
(c)
Figure 2.   The approximation functions for the Euler characteristic XK(t) and the generalized Euler 
characteristic XG
K (t) evaluated for different networks in a function of the parameter t. (a) The approximation 
function XK(t) (blue full line) calculated for the 6-vertex network Ŵ(6, 8, 0) with two tail-like edges with 
Neumann boundary conditions. The approximation functions XG
K (t) evaluated for the networks Ŵ(6, 8, 1) (red 
full line—Dirichlet vertex on the edge l2,5 ; red dotted line—Dirichlet vertex on the edge l4,6 ) and Ŵ(6, 8, 2) (black 
full line), respectively. (b) The approximation functions XG
K (t) for the isoscattering networks Ŵ(4, 4, 1) (O-graph; 
red full line) and Ŵ(6, 5, 2) (H-graph; black full line). (c) The approximation functions XK(t) evaluated for the 
star network Ŵ(4, 3, 0) (full blue line) and XG
K (t) for the star networks Ŵ(4, 3, 1) (red full line), Ŵ(4, 3, 2) (black 
full line) and Ŵ(4, 3, 3) (green full line), respectively. The vertical lines show the values of t0 for the analyzed 
networks. The crosses denote approximated values of tmax limiting from above the plateaux in XK(t) and XG
K (t) . 
The black broken lines show the limits of the expected errors χ ± 1/4 or χG ± 1/4.

7
Vol.:(0123456789)
Scientific Reports |        (2021) 11:15342  | 
https://doi.org/10.1038/s41598-021-94331-0
www.nature.com/scientificreports/
Isoscattering microwave networks. 
The isoscattering microwave ­networks21,26,60 were investigated in 
order to extend a famous question of Mark Kac “Can one hear the shape of a drum?”, originally posed in the 
case of isospectral dissipationless systems, to the case of open graphs and networks. The isoscattering networks 
simulating quantum graphs Ŵ(4, 4, 1) (O-graph), Ŵ(6, 5, 2) (H-graph)21,60 (see Fig. 1b) were investigated in the 
frequency range 0.001–4.62 GHz. In this work we significantly extended our previous measurements of the two-
port scattering matrices ˆSO(ν) and ˆSH(ν) of O- and H-networks, respectively, which in Ref.60 were reported only 
in the frequency range 0.001–3 GHz. The total optical length of the both networks is the same and amounts to 
L = 1.0504 m. The network simulating the O-graph consists of four edges of the lengths a = lmin = 0.0985 m, 
2b = 0.3694 m, a = lmin = 0.0985 m, 2c = 0.4840 m, and four vertices, one with the Dirichlet boundary condi-
tion terminating one of the edges a. The network simulating the H-graph consists of six edges b = lmin = 0.1847 
m, c = 0.2420 m, 2a = 0.1970 m, b = lmin = 0.1847 m, c = 0.2420 m, and six vertices. Two of these vertices, 
terminating one edge of each pairs of b and c, have Dirichlet boundary conditions.
Since the isoscattering networks are also isospectral if it concerns their spectra identified from the amplitudes 
of the determinants of the scattering matrices ˆSO(ν) and ˆSH(ν) , it is obvious from Eq. (7) that both networks 
should have the same generalized Euler characteristic χG . The approximation function for the generalized Euler 
characteristic XG
K (t) in a function of t is presented in Fig. 2b for the O-network ( Kmin = 32 , t0 = 5.08 , and 
tmax ≃8.1 ) and the H-network ( Kmin = 17 , t0 = 2.71 , and tmax ≃4.3 ) by red full and dotted lines, respectively. 
In both cases the approximation function XG
K (t) gives the same value χG = −1 what should be expected in the 
case of the isoscattering networks.
Moreover, from the formal definition of the generalized Euler characteristic χG (see Eq. 3) we have
in full agreement with the experimental results.
Star microwave networks. 
A star graph is a special type of a tree graph which contains at most one vertex 
of degree greater than one. Any quantum graph looks locally near vertices like a star graph therefore these sim-
plest non-trivial graphs play a very important role in the graph ­theory15.
We examined the star graphs Ŵ(4, 3, 0) , Ŵ(4, 3, 1) , Ŵ(4, 3, 2) and Ŵ(4, 3, 3) , with three edges, often called claws. 
The graphs were simulated by a network (see Fig. 1c) consisting of one vertex of valency four and three edges 
terminated with the vertices of valency one. The optical lengths of the edge are l1 = lmin = 0.949 m, l2 = 1.115 
m and l3 = 0.981 m giving the total network length L = 3.045 m. For ǫ = 1/4 , Kmin = 9 , and ν9 ≃0.47 GHz. 
The values of the parameters: t0 = 0.53 and tmax ≃0.8.
The Euler characteristic χ18 of the graph Ŵ(4, 3, 0) is χ = 4 −3 = 1 , since we deal with the graph without 
Dirichlet boundary conditions. In Fig. 2c, the approximation function for the Euler characteristic XK(t) (full 
blue line), which is close to 1, is shown as a function of t for the network Ŵ(4, 3, 0) . It is important to mention that 
the Euler characteristic for tree graphs possessing only Neumann vertices is always χtree = 1 and is independent 
on the size of a tree graph.
If in a tree graph at least one vertex with the Dirichlet boundary condition is present one should use Eq. (7) 
to evaluate the generalized Euler characteristic χG . For the star networks Ŵ(4, 3, 1) , Ŵ(4, 3, 2) and Ŵ(4, 3, 3) the 
generalized Euler characteristic χG is equal to 0, − 1, and − 2, respectively, which is clearly seen in the depend-
ence of the approximation function for the generalized Euler characteristic XG
K (t) on the parameter t in Fig. 2c.
Using the star networks one can test in practice the procedure of identifying the number of Dirichlet bound-
ary conditions in a quantum graph or microwave network. Microwave networks are so useful in simulation of 
quantum graphs because, additionally to the discussed earlier properties, their eigenvalue  = 0 can be also easily 
found by measuring the electric conductance G . For microwave networks with standard boundary conditions, 
G = 0 , while for the networks with at least one Dirichlet boundary condition, G = +∞.
The direct measurements of the electric conductance yielded that the star networks Ŵ(4, 3, 1) , Ŵ(4, 3, 2) , and 
Ŵ(4, 3, 3) possess at least one Dirichlet vertex. Therefore, using Eq. (12) one can easily found that the number of 
Dirichlet vertices in the above networks is, 1, 2, and 3, respectively, in agreement with the experimental realiza-
tions of the star graphs.
(15)
χG =

4 −4 −1 = −1, for O-graph ,
6 −5 −2 = −1, for H-graph ,
Table 1.   The Euler characteristic χ and the generalized Euler characteristic χG predicted for the microwave 
networks Ŵ(6, 8, |VD| = 0, 1, 2) for four combinations of Neumann (N) and Dirichlet (D) boundary conditions 
(BC) on the two tail-like edges l2,5 and l4,6.
BC: l2,5
BC: l4,6
χ
χG
N
N
−2
−
N
D
−
−3
D
N
−
−3
D
D
−
−4

8
Vol:.(1234567890)
Scientific Reports |        (2021) 11:15342  | 
https://doi.org/10.1038/s41598-021-94331-0
www.nature.com/scientificreports/
Conclusions
We introduced a new spectral invariant: the generalized Euler characteristic χG = |V| −|E| −|VD| of quantum 
graphs possessing standard (Neumann) and Dirichlet boundary conditions. We show theoretically and experi-
mentally that the generalized Euler characteristic χG can be determined from small sets of the lowest eigenval-
ues 1, . . . , N of graphs and microwave networks. We demonstrate that the generalized Euler characteristic 
χG together with the commonly known Euler characteristic χ = |V| −|E| can be applied to reveal (hear) the 
number of Dirichlet vertices in the investigated graphs and networks. The theoretical findings are illustrated 
and confirmed experimentally using microwave networks that showed that the generalized Euler characteristic 
χG is a new powerful tool for studying of quantum graphs and microwave networks, and as a consequence, all 
systems modeled by the equivalent differential equations.
Data availability
The data that support results presented in this paper and other findings of this study are available from the cor-
responding authors upon reasonable request.
Received: 14 April 2021; Accepted: 8 July 2021
References
	 1.	 Euler, L. Solutio problematis ad geometriam situs pertinentis. Comment. Acad. Sci. Imp. Petropol. 8, 128–140 (1736).
	 2.	 Pauling, L. The diamagnetic anisotropy of aromatic molecules. J. Chem. Phys. 4, 673–677 (1936).
	 3.	 Sánchez-Gil, J. A., Freilikher, V., Yurkevich, I. & Maradudin, A. A. Coexistence of ballistic transport, diffusion, and localization 
in surface disordered waveguides. Phys. Rev. Lett. 80, 948–953 (1998).
	 4.	 Kowal, D., Sivan, U., Entin-Wohlman, O. & Imry, Y. Transmission through multiply-connected wire systems. Phys. Rev. B 42, 
9009–9018 (1990).
	 5.	 Imry, Y. Introduction to Mesoscopic Physics (Oxford University Press, 1996).
	 6.	 Kuchment, P. & Post, O. On the spectra of carbon nano-structures. Commun. Math. Phys. 275, 805–826 (2007).
	 7.	 Bianconi, G. & Barabási, A. L. Bose–Einstein condensation in complex networks. Phys. Rev. Lett. 86, 5632–5635 (2001).
	 8.	 Fidaleo, F., Guido, D. & Isola, T. Bose–Einstein condensation on inhomogeneous amenable graphs. Infin. Dimens. Anal. Quantum 
Probab. Relat. Top. 14, 149–197 (2011).
	 9.	 Pankrashkin, K. Localization effects in a periodic quantum graph with magnetic field and spin-orbit interaction. J. Math. Phys. 
47, 112105–112105 (2006).
	10.	 Mittra, R. & Lee, S. W. Analytical Techniques in the Theory of Guided Waves. Macmillan Series in Electrical Science (Macmillan, 
1971).
	11.	 Feynman, R. P. The theory of positrons. Phys. Rev. 76, 749–759 (1949).
	12.	 Exner, P., Seba, P. & Stovicek, P. Quantum interference on graphs controlled by an external electric field. J. Phys. A 21, 4009–4019 
(1988).
	13.	 Kottos, T. & Smilansky, U. Quantum chaos on graphs. Phys. Rev. Lett. 79, 4794–4797 (1997).
	14.	 Blümel, R., Dabaghian, Y. & Jensen, R. V. Explicitly solvable cases of one-dimensional quantum chaos. Phys. Rev. Lett. 88, 4 (2002).
	15.	 Berkolaiko, G. & Kuchment, P. Introduction to Quantum Graphs (Mathematical Surveys and Monographs, 2013).
	16.	 Pluhar, Z. & Weidenmueller, H. A. Universal quantum graphs. Phys. Rev. Lett. 112, 144102 (2014).
	17.	 Pinheiro, L. K., Souza, B. S. & Trevisan, V. Determining graphs by the complementary spectrum. Discuss. Math. Graph Theory 40, 
607–620 (2020).
	18.	 Ławniczak, M. et al. Hearing Euler characteristic of graphs. Phys. Rev. E 101, 052320 (2020).
	19.	 Hul, O. et al. Experimental simulation of quantum graphs by microwave networks. Phys. Rev. E 69, 7 (2004).
	20.	 Ławniczak, M., Hul, O., Bauch, S., Seba, P. & Sirko, L. Experimental and numerical investigation of the reflection coefficient and 
the distributions of Wigner’s reaction matrix for irregular graphs with absorption. Phys. Rev. E 77, 056210(2008).
	21.	 Hul, O. et al. Are scattering properties of graphs uniquely connected to their shapes?. Phys. Rev. Lett. 109, 040402 (2012).
	22.	 Michał, Ł, Szymon, B. & Leszek, S. Application of microwave networks to simulation of quantum graphs. In Handbook of Applica-
tions of Chaos Theory 559–584 (Chapman and Hall, 2016).
	23.	 Dietz, B. et al. Nonuniversality in the spectral properties of time-reversal-invariant microwave networks and quantum graphs. 
Phys. Rev. E 95, 052202 (2017).
	24.	 Ławniczak, M. & Sirko, L. Investigation of the diagonal elements of the Wigner’s reaction matrix for networks with violated time 
reversal invariance. Sci. Rep. 9, 1 (2019).
	25.	 Ławniczak, M., Lipovský, J. & Sirko, L. Non-Weyl microwave graphs. Phys. Rev. Lett. 122, 140503 (2019).
	26.	 Ławniczak, M., Sawicki, A., Białous, M. & Sirko, L. Isoscattering strings of concatenating graphs and networks. Sci. Rep. 11, 1 
(2021).
	27.	 Rehemanjiang, A. et al. Microwave realization of the Gaussian symplectic ensemble. Phys. Rev. Lett. 117, 064101 (2016).
	28.	 Lu, J., Che, J., Zhang, X. & Dietz, B. Experimental and numerical investigation of parametric spectral properties of quantum graphs 
with unitary or symplectic symmetry. Phys. Rev. E 102, 022309 (2020).
	29.	 Lawniczak, M., Bauch, S., Hul, O. & Sirko, L. Experimental investigation of the enhancement factor for microwave irregular 
networks with preserved and broken time reversal symmetry in the presence of absorption. Phys. Rev. E 81, 046204 (2010).
	30.	 Allgaier, M., Gehler, S., Barkhofen, S., Stöckmann, H. J. & Kuhl, U. Spectral properties of microwave graphs with local absorption. 
Phys. Rev. E 89, 022925 (2014).
	31.	 Białous, M. et al. Power spectrum analysis and missing level statistics of microwave graphs with violated time reversal invariance. 
Phys. Rev. Lett. 117, 144101 (2016).
	32.	 Ławniczak, M. et al. Analysis of missing level statistics for microwave networks simulating quantum chaotic graphs without time 
reversal symmetry - The case of randomly lost resonances. Acta Phys. Pol. A 132, 1672–1676 (2017).
	33.	 Ławniczak, M., Van Tiggelen, B. & Sirko, L. Experimental investigation of distributions of the off-diagonal elements of the scat-
tering matrix and Wigner’s K matrix for networks with broken time reversal invariance. Phys. Rev. E 102, 052214 (2020).
	34.	 Rehemanjiang, A., Richter, M., Kuhl, U. & Stöckmann, H. J. Microwave realization of the chiral orthogonal, unitary, and symplectic 
ensembles. Phys. Rev. Lett. 124, 116801 (2020).
	35.	 Yunko, V., Białous, M. & Sirko, L. Edge switch transformation in microwave networks. Phys. Rev. E 102, 012210 (2020).
	36.	 Hu, W. et al. Measurement of a topological edge invariant in a microwave network. Phys. Rev. X 5, 011012 (2015).
	37.	 Szameit, A. Photonics: Chaos from symmetry. Nat. Phys. 11, 895–896 (2015).
	38.	 Stöckmann, H. J. & Stein, J. “Quantum’’ chaos in billiards studied by microwave absorption. Phys. Rev. Lett. 64, 2215–2218 (1990).
	39.	 Sridhar, S. & Kudrolli, A. Experiments on not “hearing the shape’’ of drums. Phys. Rev. Lett. 72, 2175–2178 (1994).

9
Vol.:(0123456789)
Scientific Reports |        (2021) 11:15342  | 
https://doi.org/10.1038/s41598-021-94331-0
www.nature.com/scientificreports/
	40.	 Sirko, L., Koch, P. M. & Blümel, R. Experimental identification of non-Newtonian orbits produced by ray splitting in a dielectric-
loaded microwave cavity. Phys. Rev. Lett. 78, 2940–2943 (1997).
	41.	 Hlushchuk, Y., Błedowski, A., Savytskyy, N. & Sirko, L. Numerical investigation of regimes of Wigner and Shnirelman ergodicity 
in rough billiards. Phys. Scr. 64, 192–196 (2001).
	42.	 Blümel, R., Koch, P. M. & Sirko, L. Ray-splitting billiards. Found. Phys. 31, 269–281 (2001).
	43.	 Hemmady, S., Zheng, X., Ott, E., Antonsen, T. M. & Anlage, S. M. Universal impedance fluctuations in wave chaotic systems. Phys. 
Rev. Lett. 94, 014102 (2005).
	44.	 Hul, O., Savytskyy, N., Tymoshchuk, O., Bauch, S. & Sirko, L. Investigation of nodal domains in the chaotic microwave ray-splitting 
rough billiard. Phys. Rev. E 72, 066212 (2005).
	45.	 Dietz, B. & Richter, A. Quantum and wave dynamical chaos in superconducting microwave billiards. Chaos 25, 97601 (2015).
	46.	 Dietz, B., Klaus, T., Miski-Oglu, M., Richter, A. & Wunderle, M. Partial time-reversal invariance violation in a flat, superconducting 
microwave cavity with the shape of a chaotic Africa billiard. Phys. Rev. Lett. 123, 174101 (2019).
	47.	 Białous, M., Dietz, B. & Sirko, L. Experimental investigation of the elastic enhancement factor in a microwave cavity emulating a 
chaotic scattering system with varying openness. Phys. Rev. E 100, 20 (2019).
	48.	 Blümel, R. et al. Dynamical localization in the microwave interaction of Rydberg atoms: The influence of noise. Phys. Rev. A 44, 
4521–4540 (1991).
	49.	 Jensen, R. V., Susskind, S. M. & Sanders, M. M. Chaotic ionization of highly excited hydrogen atoms: Comparison of classical and 
quantum theory with experiment. Phys. Rep. 201, 1–56 (1991).
	50.	 Sirko, L. & Koch, P. The pendulum approximation for the main quantal resonance zone in periodically driven hydrogen atoms. 
App. Phys. B 60, S195 (1995).
	51.	 Arakelyan, A., Nunkaew, J. & Gallagher, T. F. Ionization of Na Rydberg atoms by a 79-GHz microwave field. Phys. Rev. A 94, 053416 
(2016).
	52.	 Kottos, T. & Smilansky, U. Periodic orbit theory and spectral statistics for quantum graphs. Ann. Phys. 274, 76–124 (1999).
	53.	 Gutkin, B. & Smilansky, U. Can one hear the shape of a graph?. J. Phys. A 34, 6061–6068 (2001).
	54.	 Roth, J. .-P. . Le. spectre du Laplacien sur un graphe. In Théorie du Potentiel (eds Mokobodzki, G. & Pinchon, D.) 521–539 (Springer, 
1984).
	55.	 Kurasov, P. & Nowaczyk, M. Inverse spectral problem for quantum graphs. J. Phys. A 38, 4901–4915 (2005).
	56.	 Kurasov, P. Graph Laplacians and topology. Ark. Mat. 46, 95–111 (2008).
	57.	 Kurasov, P. Schrödinger operators on graphs and geometry I: Essentially bounded potentials. J. Funct. Anal. 254, 934–953 (2008).
	58.	 Léna, C. & Serio, A. Concrete method for recovering the Euler characteristic of quantum graphs. J. Phys. A 53, 275201 (2020).
	59.	 Palade, V., Petro, M. S. & Todorov, T. D. Neural network approach for solving nonlocal boundary value problems. Neural Comput. 
Appl. 32, 14153–14171 (2020).
	60.	 Ławniczak, M., Sawicki, A., Bauch, S., Kuś, M. & Sirko, L. Resonances and poles in isoscattering microwave networks and graphs. 
Phys. Rev. E 89, 032911 (2014).
	61.	 Jones, D. S. The Theory of Electromagnetism (Pergamon Press, 1964).
	62.	 Savytskyy, N., Kohler, A., Bauch, S., Blümel, R. & Sirko, L. Parametric correlations of the energy levels of ray-splitting billiards. 
Phys. Rev. E 64, 5 (2001).
Acknowledgements
This work was supported in part by the National Science Centre, Poland, Grant no. UMO-2018/30/Q/ST2/00324, 
the Swedish Research Council (Grant 2020-03780) and the Center for Interdisciplinary Research (ZiF) in Biele-
feld in the framework of the cooperation group on Discrete and continuous models in the theory of networks.
Author contributions
M.Ł., S.B., M.B. and A.A. performed the experiment. M.Ł. performed the data analysis. P.K. and L.S. provided the 
theoretical interpretation. M.Ł., P.K., S.B. and L.S. wrote the manuscript. All authors reviewed the manuscript.
Competing interests 
The authors declare no competing interests.
Additional information
Correspondence and requests for materials should be addressed to M.Ł., P.K. or L.S.
Reprints and permissions information is available at www.nature.com/reprints.
Publisher’s note  Springer Nature remains neutral with regard to jurisdictional claims in published maps and 
institutional affiliations.
Open Access  This article is licensed under a Creative Commons Attribution 4.0 International 
License, which permits use, sharing, adaptation, distribution and reproduction in any medium or 
format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the 
Creative Commons licence, and indicate if changes were made. The images or other third party material in this 
article are included in the article’s Creative Commons licence, unless indicated otherwise in a credit line to the 
material. If material is not included in the article’s Creative Commons licence and your intended use is not 
permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from 
the copyright holder. To view a copy of this licence, visit http://​creat​iveco​mmons.​org/​licen​ses/​by/4.​0/.
© The Author(s) 2021

