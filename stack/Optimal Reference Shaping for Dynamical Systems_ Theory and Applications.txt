
Optimal Reference Shaping  
for Dynamical Systems
Theory and Applications
¬© 2010 by Taylor and Francis Group, LLC

Optimal Reference Shaping  
for Dynamical Systems
Theory and Applications
Tarunraj Singh
State Univesity of New York at Buffalo
Buffalo, New York, U.S.A.
¬© 2010 by Taylor and Francis Group, LLC

MATLAB¬Æ is a trademark of The MathWorks, Inc. and is used with permission. The MathWorks does not 
warrant the accuracy of the text or exercises in this book. This book‚Äôs use or discussion of MATLAB¬Æ soft-
ware or related products does not constitute endorsement or sponsorship by The MathWorks of a particular 
pedagogical approach or particular use of the MATLAB¬Æ software.
CRC Press
Taylor & Francis Group
6000 Broken Sound Parkway NW, Suite 300
Boca Raton, FL 33487-2742
¬© 2010 by Taylor and Francis Group, LLC
CRC Press is an imprint of Taylor & Francis Group, an Informa business
No claim to original U.S. Government works
Printed in the United States of America on acid-free paper
10 9 8 7 6 5 4 3 2 1
International Standard Book Number: 978-1-4398-0562-6 (Hardback)
This book contains information obtained from authentic and highly regarded sources. Reasonable efforts 
have been made to publish reliable data and information, but the author and publisher cannot assume 
responsibility for the validity of all materials or the consequences of their use. The authors and publishers 
have attempted to trace the copyright holders of all material reproduced in this publication and apologize to 
copyright holders if permission to publish in this form has not been obtained. If any copyright material has 
not been acknowledged please write and let us know so we may rectify in any future reprint.
Except as permitted under U.S. Copyright Law, no part of this book may be reprinted, reproduced, transmit-
ted, or utilized in any form by any electronic, mechanical, or other means, now known or hereafter invented, 
including photocopying, microfilming, and recording, or in any information storage or retrieval system, 
without written permission from the publishers.
For permission to photocopy or use material electronically from this work, please access www.copyright.
com (http://www.copyright.com/) or contact the Copyright Clearance Center, Inc. (CCC), 222 Rosewood 
Drive, Danvers, MA 01923, 978-750-8400. CCC is a not-for-profit organization that provides licenses and 
registration for a variety of users. For organizations that have been granted a photocopy license by the CCC, 
a separate system of payment has been arranged.
Trademark Notice: Product or corporate names may be trademarks or registered trademarks, and are used 
only for identification and explanation without intent to infringe.
Library of Congress Cataloging‚Äëin‚ÄëPublication Data
Singh, Tarunraj.
Optimal reference shaping for dynamical systems : theory and applications / author, 
Tarunraj Singh.
p. cm.
‚ÄúA CRC title.‚Äù
Includes bibliographical references and index.
ISBN 978-1-4398-0562-6 (hardcover : alk. paper)
1.  Feedback control systems. 2.  Dynamics. 3.  System theory.  I. Title.
TJ216.S465 2010
629.8‚Äô3--dc22 
2009031424
Visit the Taylor & Francis Web site at
http://www.taylorandfrancis.com
and the CRC Press Web site at
http://www.crcpress.com 
¬© 2010 by Taylor and Francis Group, LLC

To my siblings Prabhjyot and Gururaj who have inspired me more
than they can imagine
¬© 2010 by Taylor and Francis Group, LLC

Contents
Preface
xi
Acknowledgments
xv
1
Introduction
1
1.1
Hard Disk Drives . . . . . . . . . . . . . . . . . . . . . . . . . . .
1
1.2
High-Speed Tape Drives
. . . . . . . . . . . . . . . . . . . . . . .
4
1.3
High-Speed Elevator
. . . . . . . . . . . . . . . . . . . . . . . . .
6
1.4
Cranes
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
8
1.5
Slosh Modeling . . . . . . . . . . . . . . . . . . . . . . . . . . . .
10
1.6
Vehicle Platooning
. . . . . . . . . . . . . . . . . . . . . . . . . .
14
1.7
Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
16
2
Time-Delay Filter/Input Shaping
19
2.1
Time-Delay Filters
. . . . . . . . . . . . . . . . . . . . . . . . . .
24
2.1.1
Proportional Plus Delay (PPD) Control
. . . . . . . . . . .
24
2.1.2
Proportional Plus Multiple Delay (PPMD) Control . . . . .
27
2.2
Proportional Plus User Selected Multiple Delay Control
. . . . . .
32
2.2.1
Signs of the Time-Delay Gains . . . . . . . . . . . . . . . .
34
2.2.2
Periodicity
. . . . . . . . . . . . . . . . . . . . . . . . . .
35
2.3
Time-Delay Control of Multi-Mode Systems
. . . . . . . . . . . .
37
2.3.1
Concurrent Time-Delay Filter Design for Multi-Mode Sys-
tems . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
38
2.3.2
User Selected Time-Delay . . . . . . . . . . . . . . . . . .
39
2.3.3
Minimum Time-Delay . . . . . . . . . . . . . . . . . . . .
41
2.4
Jerk Limited Input Shapers . . . . . . . . . . . . . . . . . . . . . .
42
2.4.1
Undamped Systems . . . . . . . . . . . . . . . . . . . . . .
43
2.4.2
Damped Systems . . . . . . . . . . . . . . . . . . . . . . .
45
2.5
Robust Jerk Limited Time-Delay Filter
. . . . . . . . . . . . . . .
46
2.6
Jerk Limited Time-Delay Filters for Multi-Mode Systems
. . . . .
47
2.7
Filtered Input Shapers
. . . . . . . . . . . . . . . . . . . . . . . .
50
2.7.1
First-Order Filtered Input Shaper . . . . . . . . . . . . . . .
50
2.7.2
Sinusoid Filtered Input Shaper . . . . . . . . . . . . . . . .
50
2.7.3
Jerk Limits . . . . . . . . . . . . . . . . . . . . . . . . . .
51
2.8
Discrete-Time Time-Delay Filters
. . . . . . . . . . . . . . . . . .
54
2.9
Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
59
vii
¬© 2010 by Taylor and Francis Group, LLC

viii
3
Optimal Control
67
3.1
Calculus of Variations
. . . . . . . . . . . . . . . . . . . . . . . .
68
3.1.1
Beltrami Identity . . . . . . . . . . . . . . . . . . . . . . .
70
3.1.2
Differential Equation Constraints
. . . . . . . . . . . . . .
73
3.2
Hamiltonian Formulation . . . . . . . . . . . . . . . . . . . . . . .
77
3.2.1
Linear Quadratic Regulator (LQR) . . . . . . . . . . . . . .
83
3.2.2
LQR without State Penalty . . . . . . . . . . . . . . . . . .
94
3.2.3
Desensitized LQR Control . . . . . . . . . . . . . . . . . .
96
3.3
Minimum Power Control . . . . . . . . . . . . . . . . . . . . . . .
100
3.3.1
Minimum Power Control of Maneuvering Structures . . . .
100
3.3.2
Robust Minimum Power Control of Maneuvering Structures
105
3.3.3
Minimum Time/Power Control . . . . . . . . . . . . . . . .
109
3.4
Frequency-Shaped LQR Controller
. . . . . . . . . . . . . . . . .
114
3.5
LQR Control with Noisy Input . . . . . . . . . . . . . . . . . . . .
121
3.6
Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
126
4
Saturating Control
133
4.1
Benchmark Problem
. . . . . . . . . . . . . . . . . . . . . . . . .
134
4.2
Minimum-Time Control
. . . . . . . . . . . . . . . . . . . . . . .
135
4.2.1
Singular Time-Optimal Control
. . . . . . . . . . . . . . .
136
4.2.2
Rigid Body . . . . . . . . . . . . . . . . . . . . . . . . . .
137
4.2.3
Time-Optimal Rest-to-Rest Maneuvers
. . . . . . . . . . .
139
4.2.4
Implications of Pole-Zero Cancelation . . . . . . . . . . . .
142
4.2.5
SufÔ¨Åciency Condition
. . . . . . . . . . . . . . . . . . . .
144
4.2.6
Benchmark Problem . . . . . . . . . . . . . . . . . . . . .
145
4.2.7
Effect of Damping . . . . . . . . . . . . . . . . . . . . . .
147
4.2.8
Example
. . . . . . . . . . . . . . . . . . . . . . . . . . .
147
4.3
Fuel/Time Optimal Control
. . . . . . . . . . . . . . . . . . . . .
150
4.3.1
Singular Fuel/Time Optimal Control . . . . . . . . . . . . .
152
4.3.2
Rigid Body . . . . . . . . . . . . . . . . . . . . . . . . . .
155
4.3.3
Fuel/Time Optimal Rest-to-Rest Maneuver . . . . . . . . .
157
4.3.4
SufÔ¨Åciency Conditions . . . . . . . . . . . . . . . . . . . .
159
4.3.5
Benchmark Problem . . . . . . . . . . . . . . . . . . . . .
159
4.3.6
Determination of Œ±cr . . . . . . . . . . . . . . . . . . . . .
165
4.3.7
Effect of Damping . . . . . . . . . . . . . . . . . . . . . .
168
4.4
Fuel Limited Minimum/Time Control
. . . . . . . . . . . . . . . .
170
4.4.1
Singular Fuel Constrained Time-Optimal Control . . . . . .
172
4.4.2
Rigid Body . . . . . . . . . . . . . . . . . . . . . . . . . .
172
4.4.3
Fuel Constrained Time-Optimal Rest-to-Rest Maneuver
. .
174
4.4.4
SufÔ¨Åciency Conditions . . . . . . . . . . . . . . . . . . . .
175
4.4.5
Benchmark Problem . . . . . . . . . . . . . . . . . . . . .
176
4.4.6
Effect of Damping . . . . . . . . . . . . . . . . . . . . . .
179
4.5
Jerk Limited Time-Optimal Control
. . . . . . . . . . . . . . . . .
182
4.5.1
Rigid Body . . . . . . . . . . . . . . . . . . . . . . . . . .
184
4.5.2
Jerk Limited Time-Optimal Rest-to-Rest Maneuver . . . . .
192
¬© 2010 by Taylor and Francis Group, LLC

ix
4.5.3
SufÔ¨Åciency Conditions . . . . . . . . . . . . . . . . . . . .
194
4.5.4
Benchmark Problem . . . . . . . . . . . . . . . . . . . . .
196
4.5.5
Summary . . . . . . . . . . . . . . . . . . . . . . . . . . .
208
5
Minimax Control
219
5.1
Minimax Time-Delay Filters . . . . . . . . . . . . . . . . . . . . .
220
5.1.1
Cost Function . . . . . . . . . . . . . . . . . . . . . . . . .
221
5.1.2
Van Loan Identity . . . . . . . . . . . . . . . . . . . . . . .
222
5.1.3
Pre-Filter Design . . . . . . . . . . . . . . . . . . . . . . .
224
5.1.4
Minimax Filter Design for Multi-Input Systems . . . . . . .
228
5.2
Minimax Feedback Controllers
. . . . . . . . . . . . . . . . . . .
233
5.2.1
Exponentially Weighted LQR Cost
. . . . . . . . . . . . .
240
5.2.2
Minimax Output Feedback Controller . . . . . . . . . . . .
244
5.3
Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
249
6
Friction Control
255
6.1
Time-Optimal Rest-to-Rest Maneuvers
. . . . . . . . . . . . . . .
255
6.1.1
Rigid Body . . . . . . . . . . . . . . . . . . . . . . . . . .
256
6.1.2
Flexible Structure . . . . . . . . . . . . . . . . . . . . . . .
264
6.2
Pulse-Width Pulse-Amplitude Control . . . . . . . . . . . . . . . .
282
6.2.1
Rigid Body . . . . . . . . . . . . . . . . . . . . . . . . . .
283
6.2.2
Benchmark Problem . . . . . . . . . . . . . . . . . . . . .
294
6.3
Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
305
7
Numerical Approach
311
7.1
Parameter Optimization
. . . . . . . . . . . . . . . . . . . . . . .
311
7.1.1
Minimax Control . . . . . . . . . . . . . . . . . . . . . . .
318
7.1.2
Analytic Gradients . . . . . . . . . . . . . . . . . . . . . .
321
7.2
Linear Programming
. . . . . . . . . . . . . . . . . . . . . . . . .
324
7.2.1
Minimum Time Control
. . . . . . . . . . . . . . . . . . .
325
7.2.2
Minimum Fuel Control . . . . . . . . . . . . . . . . . . . .
332
7.2.3
Fuel/Time Optimal Control . . . . . . . . . . . . . . . . . .
335
7.2.4
Minimax Control . . . . . . . . . . . . . . . . . . . . . . .
337
7.3
Linear Matrix Inequality . . . . . . . . . . . . . . . . . . . . . . .
367
7.3.1
Time-Delay Filter . . . . . . . . . . . . . . . . . . . . . . .
369
7.3.2
Minimax Time-Delay Filters . . . . . . . . . . . . . . . . .
374
7.3.3
Modal Weighted Minimax Time-Delay Filters . . . . . . . .
378
7.4
Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
385
A Van Loan Exponential
393
B
Differential Lyapunov Equation
395
C Parseval‚Äôs Theorem
397
¬© 2010 by Taylor and Francis Group, LLC

Preface
The area of feedback control is rich with analysis and synthesis tools that cater to
continuous and discrete time systems, linear and nonlinear systems, and stochastic
and deterministic systems. Feedback control has created technology that has landed
men on the moon; created commodity products, such as CD players, where the op-
tical pickup needs to be centered on the data track with an accuracy of a few Œº
meters; cruise control for cars, and so forth; and in exotic applications such as tele-
manipulation in medical surgery. It is hard to identify an engineering discipline that
has not been impacted by feedback control. Research into feedback control continues
with engineers, economists, biologists, and others studying parochial problems.
Feedforward control refers to techniques that modify or shape the reference input
to the system in anticipation of the expected response of the system. If the system
being controlled is well understood, the expected output will be close to the actual
output. In such scenarios, feedforward control can be selected to meet a desired
objective such as rest-to-rest maneuvering or reject periodic disturbances that can
be measured. In this book, the terms feedforward control, input shaping, and pre-
Ô¨Åltering will be used to refer to the mechanism of selecting an open-loop control
proÔ¨Åle to satisfy a desired objective. The systems being studied will be limited to
those that are stable or marginally stable. Three examples in the following para-
graphs are used to illustrate that the beneÔ¨Åt of using feedforward control includes the
ability of achieving performance that is unable to be matched by feedback control.
Biomimetics is a term used to label research that endeavors to emulate nature. For
example, artiÔ¨Åcial neural networks are an attempt to emulate how the networks of
biological neurons learn, process, and control. Other examples include understand-
ing how bats navigate to permit design of autonomous robots for rescue operations
in post-earthquake disasters. A recent study to understand the cause of stuttering
has led to a conjecture that the process of communicating using sounds includes two
modalities, a feedforward command based on a learned model and a feedback mode
where the auditory output is compared to the commanded signal and the error is used
for correcting speech.
  Numerical simulation has revealed that the weakening of the
feedforward component of the process mandates an increased reliance on the feed-
back component, which results in stuttering due to the delays in the feedback loop.
The low incidence of stuttering among the deaf is a supporting empirical piece of
evidence.
 Simulations of Feedback and Feedforward Control in Stuttering, O. Civier and F. H. Guenther, Proceed-
ings of the 7th Oxford DysÔ¨Çuency Conference, St. Catherine‚Äôs College, Oxford University, June 29‚ÄìJuly
2, 2005.
xi
¬© 2010 by Taylor and Francis Group, LLC

xii
How does the human brain synthesize a motor control proÔ¨Åle to move a baseball
bat to make contact with a ball moving at 100 miles/hour? Tracking the motion of
the ball requires oculomotor control, which includes efferent delays in command-
ing the motion of the eyes resulting in about 130 milliseconds (ms) of delay in the
feedback loop. The visuo-motor loop for moving the baseball bat includes delays to
the order of 200 to 250 ms.‚Ä† A baseball traveling at 100 miles/hour takes 412 ms
to reach home plate from the pitching rubber, a distance of 60.5 feet. By the time
the ball is released by the pitcher and the batter moves the bat, the ball has passed
the halfway point, not giving the batter an opportunity to correct for the curve ball.
Solely employing a feedback controller will not achieve the desired performance of
striking the baseball. Scientists have hypothesized that this complex motion control
is possible because of the coexistence of a feedback and feedforward mode in a mo-
tor control system. The feedforward component of the control relies on a learned
inverse model, while the feedback mode uses a forward model as an estimator to
generate estimated states that are compared to reference states and the error is used
in the feedback control mode. Abnormal behavior of either of these components can
result in inefÔ¨Åcient movement execution. Morasso and Sanguineti‚Ä° conclude that er-
rors in the feedforward component of the control are responsible for inaccuracies in
movement execution.
Cells, when exposed to stress can lead to denaturation of proteins. Denaturation
refers to the process where proteins lose their three-dimensional (3D) structure which
can cause disruptions in the functioning of the cell and in the worst case can cause
the death of the cell.¬ß The cell can produce defense proteins which restore the de-
natured protein. These defense proteins are produced in a feedforward manner to
rapidly respond to the applied stress. However, uncertainties in the estimate of the
stress can lead to an over- or underproduction of the defense protein. Feedback is
the mechanism used by the cell to produce the defense proteins in response to the
measured damage. Its drawback is the delay in responding to the imposed stress.
Clearly, in addition to feedback mechanisms, nature exploits feedforward control,
which is based on knowledge of the system model.
A Google search of the phrase ‚Äúfeedback control‚Äù results in nearly 118 million
hits. A search on the phrase ‚Äúfeedforward control‚Äù results in about 300,000 hits.
This na¬®ƒ±ve evidence is quite revealing of the disparity in the investment for develop-
ing feedforward control compared to feedback control. There are some engineering
applications where feedforward control has been used to successfully deal with chal-
lenging problems. For instance, in CD and DVD players the center of the spindle
motor is seldom coincident with the center of the data spiral on the storage medium.
This causes a radial tracking error which is periodic with a frequency which is coin-
‚Ä†Internal models for motor control and trajectory planning, M. M. Kawato, Current Opinion in Neurobi-
ology, Volume 9, Number 6, December 1, 1999, pp. 718‚Äì727.
‚Ä°Feedforward
versus
feedback
control:
the
case
study
of
cerebellar
ataxia,
http //www.laboratorium.dist.unige.it/ piero/Papers/ISHF01.PDF.
¬ßOptimal choice between feedforward and feedback control in gene expression to cope with unpredictable
danger, E. Shudoa, P. Haccoub, Y. Iwasaa, Journal of Theoretical Biology, Volume 223, 2003, pp. 149‚Äì
160.
¬© 2010 by Taylor and Francis Group, LLC

xiii
cident with the spindle speed. The optical pickup must track the center of the spiral
within a few Œº meters precision to reliably read the data. Feedforward controllers
are used to compensate for the periodic disturbance by identifying the amplitude and
phase of the periodic radial disturbance, and have been successfully demonstrated on
optical storage devices.
This book is a modest attempt to Ô¨Åll the gap in the area of shaping the reference
input to dynamical systems whose responses are characterized by lightly damped
modes. This is essentially an open-loop control strategy and requires the system be-
ing controlled to be stable or marginally stable. However, one should note that the
plant being controlled can include a feedback component and the design would con-
sider the closed-loop dynamics of the plant as the system of interest. This book does
not exclusively consider open-loop control. It presents robust feedback controller
design as an extension of an approach that can be exploited for robust open-loop
controller design. The goal of this book is to provide in a tutorial manner various al-
gorithms for attenuating the residual oscillations that are excited by reference inputs
to dynamical systems. Some sections of this book are suitable as complementary
material to undergraduate courses focusing on feedback control. This book would
be suitable for an introductory graduate course in mechanical, aerospace, electrical,
civil, and chemical engineering, despite the use of examples which look suitable for
the mechanical and aerospace communities only. This is because oscillatory behav-
ior exists, among others, in electrical, chemical, or civil engineering applications.
Outline of the Book
This book is organized as follows: Chapter 1 develops models for applications
whose dynamics are dominated by lightly damped poles. Since most of the illus-
trative examples in the rest of the book are benchmark problems, the objective of
the development of dynamic models in Chapter 1 is to provide the reader with a
suite of real-world problems which can be used as exercises. Chapter 2 is devoted
to the development of time-delay Ô¨Ålters (Input Shapers
TM), which are used to shape
the reference input to dynamical systems undergoing rest-to-rest maneuvers, so as
to eliminate or minimize the residual energy which would correspond to accurate
positioning of the Ô¨Ånal states. The time-delay Ô¨Ålter design technique is illustrated
on single- and multi-mode systems and for continuous and discrete-time systems.
Chapter 3 reviews basic concepts in calculus of variations and can be skipped by the
reader who is familiar with this material. Chapter 4 focuses exclusively on four con-
trol problems, all of which include saturation constraints for the control input. The
four problems are: (1) Time-optimal control, (2) Fuel/time-optimal control, (3) Fuel
limited time-optimal control, and (4) Jerk limited time-optimal control. A system-
atic increase in the level of difÔ¨Åculty starting from a rigid body system and leading
to a damped Ô¨Çoating oscillator benchmark problem is used to illustrate the change in
¬© 2010 by Taylor and Francis Group, LLC

xiv
the structure of the optimal control proÔ¨Åle. Chapters 2 and 4 present a technique for
desensitizing the open-loop proÔ¨Åle or shaped proÔ¨Åle to uncertainties in model param-
eters. The robustness is achieved by forcing the state sensitivities evaluated about the
nominal model parameters to zero. Chapter 5 poses the problem of design of a ro-
bust time-delay Ô¨Ålter as a minimax optimization problem. This technique can exploit
knowledge of the distribution of the uncertain parameters. Friction is a constant pres-
ence in many mechanical and aerospace applications and is detrimental for precision
position control. Chapter 6 focuses on the development of input constrained design
of open-loop control proÔ¨Åles which accounts for friction in the design of point-to-
point control proÔ¨Åles. Rigid body and systems with lightly damped modes are used
to illustrate the control techniques. The Ô¨Ånal chapter of this book deals with numer-
ical techniques for solving the problem of design of shaped inputs. Gradient-based
and convex programming-based approaches are presented and illustrated on simple
examples. MATLAB R
  code is occasionally provided for pedagogical purposes.
MATLAB R
  is a registered trademark of The MathWorks, Inc. For product infor-
mation, please contact:
The MathWorks, Inc.
3 Apple Hill Drive
Natick, MA 01760-2098 USA
Tel: 508 647 7000
Fax: 508-647-7001
E-mail: info@mathworks.com
Web: www mathworks.com
Tarunraj Singh
¬© 2010 by Taylor and Francis Group, LLC

xv
Acknowledgments
Two people who have been inspirational and to whom I am particulary grateful are
John Junkins and Rao Vadali. They have been wonderful mentors and colleagues,
and I treasure their friendship. Their tremendous intellect and achievements, cou-
pled with their modesty, make them paragons for anyone who wishes to succeed
in academia. Raj Dubey and Farid Golnaraghi introduced me to the occasionally
frustrating, mostly rewarding, world of academic research and I am grateful for that
opportunity.
The writing of this book has coincided with my teaching of a course on vibra-
tion control. I am thankful to my current and former students who were the prime
movers of various research projects, the results of which when amalgamated formed
the outline of this book. They include Rolf Hartmann, Dominik Fuessel, Robert
Call, Joachim Noll, Dirk Tenne, Yong-Lin Kuo, Timothy Hindle, Jae-Jun Kim,
Marco Muenchhof, Ulrich Staehlin, Rajaey Kased, Thomas Conord, Umamaheswara
Konda, Jayaram Gopalakrishnan, Matt Vossler, Nidal al-Masoud, Shin-Whar Liu,
Hasan Alli, Ravi Kumar, Jennifer Haggerty, Christoph Verlohren, and Jeroen van de
Wijdeven. I have beneÔ¨Åted tremendously from conversing with numerous colleagues
who have helped conceive of solutions to challenging problems. In particular, I
would like to mention Bill Singhose, Warren Seering, Glenn Heppler, Maarten Stein-
buch, Puneet Singla, Peter Scott, John Crassidis, Timothy Chang, William O‚ÄôConnor,
Peter Meckl, Martin Berg, Santosh Devasia, and Arun Banerjee. Any constructive
criticism, comments, and corrections are welcome via e-mail at: tsingh@buffalo.edu.
Thanks to my academic homes at the University at Buffalo, University of Wa-
terloo, and Texas A & M University, who have provided me with a rich academic
environment to pursue my endeavors.
Finally, heartfelt thanks to Bob Stern, executive editor at Taylor & Francis/CRC
Press who helped to bring this project to fruition. Special thanks also go to the project
editor Linda Leggio for her assistance.
¬© 2010 by Taylor and Francis Group, LLC

1
Introduction
Imagination is more important than knowledge.
Albert Einstein,1921 Nobel Laureate in Physics
T
HE primary goal of this book is to present techniques to control self-induced
vibrations (oscillations) in linear or quasi-linear dynamical systems. This im-
plies that oscillatory behavior, which is a manifestation of underdamped modes of
the system, are excited by the reference input to the system. For example, the os-
cillatory motion of a portainer (container crane) payload, when the hoist carrying
trolley is used to maneuver containers, is an illustration of the self-excited vibra-
tions. This is in contrast to vibrations of systems excited by exogenous inputs, for
example, wind excited vibrations that led to the destruction of the Tacoma Narrows
Bridge. Precise positioning of the containers in an expeditious manner is mandatory
for efÔ¨Åcient operation of ports. Since the mass of the containers which have to be
loaded and discharged are not uniform, control techniques which are insensitive to
variations in container mass are desirous. Techniques which endeavor to desensitize
the controller to variations (uncertainties) in system model will be presented and the
robustness versus performance trade-off will be discussed. In this book, the term
vibration will be loosely used to represent any kind of oscillatory motion.
A large number of applications are characterized by self-excited vibrations. These
include hard disk drives, high-speed tape drives, high-speed elevators for skyscrap-
ers, containers crane, slosh dynamics of Ô¨Çuids in containers, vehicle platoons in in-
telligent transportation, wafer scanners for manufacturing integrated circuits using
photolithography etc. A growing number of applications have exploited techniques
presented in this book or variations of ones presented, with beneÔ¨Åcial results. In this
chapter, some of the aforementioned applications will be presented in some detail to
provide examples which the reader can use to test techniques which will be presented
in this book.
1.1
Hard Disk Drives
IBM has consistently pioneered breakthrough technology in magnetic storage de-
vices. Following experimenting with rotating cylindrical drums, the Ô¨Årst disk drives
1
¬© 2010 by Taylor and Francis Group, LLC

2
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
whose operating concepts are similar to the ones in use today were conceived of in
the 1950s. The Ô¨Årst production hard disk drive (IBM 305 RAMAC) was introduced
in September 1956, by IBM which stored 5 megabytes on 50 disks of 24 inch diame-
ters. This corresponded to an areal density of 2000 bits/square inch. Areal density is
deÔ¨Åned as the product of TPI (tracks per inch) and BPI (bits per inch), i.e., the num-
ber of bits per inch of a track. Prior to the IBM 305 RAMAC, the read/write head of
the hard disk drives were in contact with the surface of this disk to compensate for
the low sensitivity of the electronics of that vintage. This resulted in the read/write
head and the magnetic coating of the disks, wearing out. The IBM 305 RAMAC
was the Ô¨Årst disk drive which created an air cushion on which the read/write head
Ô¨Çoated. This was achieved by supplying pressurized air to create an air bearing be-
tween the head and the magnetic media [1]. From that breakthrough technology, the
design of heads has progressed to a point where a self-generated air bearing is used
to separate the head from the storage medium with a gap distance which is equal to
mean free path, which is the average distance between collisions of air molecules,
with the relative velocity between the head and the magnetic media greater than 40
meters/sec. The air bearing generated by the relative motion of the disk and the head,
in conjunction with the suspension permits the head to adapt to imperfections on the
disk surface by maintaining a fairly constant Ô¨Çying height.
Over the same period, the read head technology has changed from the inductive
read/write heads which were Ô¨Årst used to sense the magnetization changes to the
current thin Ô¨Ålm inductive write GMR (giant magneto resistive) read heads. IBM
introduced the 0663-E12 drive in 1991, which had a form factor of 3.5 inches that
illustrated the use of MR (magneto resistive) read heads to greatly increase the areal
density. The MR head consists of magnetic material whose resistance changes as
a function of the incident magnetic Ô¨Åeld. This was followed by the introduction of
the GMR read head technology, by IBM in December 1997. The industry‚Äôs Ô¨Årst
GMR (Peter Gr¬®unberg and Albert Fert who discovered GMR won the Nobel Prize in
Physics in 2007) based storage device [2] had an areal density of 2.69 Gbits/in2.
The exponential growth of areal density has permitted the development of drives
with smaller form factors, which has also permitted increasing the spindle speed. The
increased spindle speeds (15,000 rpm, Savvio 15K Seagate Drive [3]) have resulted
in reduced latency and the increased areal density has resulted in the requirement of
high performance seeking and following controllers. Latency is deÔ¨Åned as the time
required to position the proper sector under the read/write head and is therefore,
wasted time.
As areal density increases, the precision requirement of the seek and follow con-
trollers increases. Reduction of seek times is another driving factor in the devel-
opment of next generations of hard disk drives. This has to occur in conjunction
with the reduction in size of the hard disk drive. Reduction in seek time for a given
voice coil motor corresponds to reducing the inertia of the actuator. However, this
is associated with a reduction in the natural frequencies of vibrations resulting in
the vibratory modes contributing to an increase in the seek time because of residual
vibration of the head. Thus, there exists a motivation to develop control algorithms
to minimize the seek time with a constraint of eliminating residual vibrations.
¬© 2010 by Taylor and Francis Group, LLC

Introduction
3

	

		




Figure 1.1: Head Disk Assembly (Reprinted with permission [4].)
Figure 1.1 illustrates a head disk assembly (HDA) which consists of the voice coil
actuator, arm, and the slider. The arm carrying the read/write head is excited by
rapid maneuvering by the voice coil motor. Traditionally, transfer function for the
arm includes a rigid body mode and multiple underdamped Ô¨Çexible modes, which
are used to design controllers. The rigid body model can be represented as [5]:
Gr
 s
 K
Js2
(1.1)
or
Gr
 s

K
Js s
a 

1e6
s s
1  255e5  (1.2)
which captures the effect of windage on the rigid body motion.
For high precision motion, the vibration of the Ô¨Çexible arm is represented as a
series of underdamped second order transfer functions [5]:
Gf
 s

n
‚àè
i 1
aiœâis
 biœâ2
i
s2
 2Œ∂iœâis
 œâ2
i
(1.3)
The combined transfer function is:
G s
 Gr
 sGf
 s
(1.4)
Table 1.1 lists the model parameters which characterize the system dynamics as
nonminimum phase with lightly damped modes.
¬© 2010 by Taylor and Francis Group, LLC

4
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
Mode #
ai
bi
œâi
Œ∂i
1
0.0000115
-0.00575
2œÄ70
0.05
2
0
0.023
2œÄ2200
0.005
3
0
0.8185
2œÄ4000
0.05
4
0.0273
0.1642
2œÄ9000
0.005
Table 1.1: Disk Drive Parameters [5]
1.2
High-Speed Tape Drives
Since its introduction in 1972 by IBM and 3M, magnetic tape storage has been a
cost effective means of storing and retrieving data. It continues to be used due to its
10 to 1 cost advantage over disk drives [6]. The current roadmap for tape storage
targets a capacity of 16 Terabytes in a cartridge by 2015 [7]. This has prompted
research into utilization of thinner media, increasing the read/write velocity from
the current 4 m/s to 12‚Äì15 m/s and increasing the track density [3]. The paramount
problem which needs to be addressed is precise high velocity and low tension control
of the tape media.
Panda and Lu [8] present a tutorial on controller for tape drives. They present a
simple multi-input multi-output model to represent the dynamics of the tape tension
and velocity as a function of the torques used to drive the supply and take-up reels.
Mathur and Messner [9] describe the effect of air entrainment between layers of tape
on the system dynamics for high-speed low-tension tape drives. The model they
proposed is presented here.
Figure 1.2 illustrates schematically a high-speed tape drive.
Force balance of the two spools result in the equations:
ÀôJ1œâ1
 J1 Àôœâ1
 c1œâ1
  K1œÑ1
 Tr1
(1.5)
ÀôJ2œâ2
 J2 Àôœâ2
 c2œâ2
  K2œÑ2
 Tr2
(1.6)
where Ji is the inertia, œâi is the angular velocity, and ri the radius of the ith reel. T is
U
U
-
-
Z
Z
W
W
Figure 1.2: Schematic of a Tape Drive
¬© 2010 by Taylor and Francis Group, LLC

Introduction
5
the tension in the tape and ci and Ki are the damping constant and torque constants
respectively. The tape inertia can be represented as:
J
 r

 J0
   r
ri
œÅtw
 2œÄR  R2 dR
  J0
  œÅtwœÄ
2
 r4
 r4
i
 (1.7)
and the rate of change of inertia is:
ÀôJ
 r
  2œÅtwœÄr3Àôr
(1.8)
where œÅ and tw are the tape density and width respectively. The rate of change of the
reel radius is given by the equations:
Àôr1
  Œµœâ1
2œÄ
(1.9)
Àôr2
  Œµœâ2
2œÄ
(1.10)
where Œµ is the tape thickness. Substituting for ÀôJi into Equation (1.6), we have:
J1 Àôœâ1
  ŒµœÅtwr3
1œâ2
1
 cœâ1
 K1œÑ1
 Tr1
(1.11)
J2 Àôœâ2
  ŒµœÅtwr3
2œâ2
2
 cœâ2
 K2œÑ2
 Tr2
(1.12)
Figure 1.3: Schematic of a Tape Model
To determine the tension T, the equation for the stretching of the tape is calculated
as:
S
 t
  S0
   t
t0
r2
 œÑ
 œâ2
œÑ
 dœÑ
   t
t0
r1
 œÑ
 œâ1
œÑ
 dœÑ
 (1.13)
The tape tension is deÔ¨Åned as (Figure 1.3):
T
 t
  KS
D ÀôS
(1.14)
The tension dynamics can now be represented as:
¬© 2010 by Taylor and Francis Group, LLC

6
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
ÀôT
  K
 œâ2r2
 œâ1r1
  D  Àôœâ2r2
  Àôœâ1r1
 œâ2Àôr2
 œâ1Àôr1
 (1.15)
Since, the radius of reels changes slowly implying that the inertia changes slowly,
one can derive the linearized system dynamics by ignoring the nonlinearities, result-
ing in the state space model:
 
Àôœâ1
Àôœâ2
ÀôT
 
 


  c
J1
0
r1
J1
0
  c
J2
  r2
J2
 r1K
  Dcr1
J1
r2K
  Dcr2
J2
 D  r2
1
J1
  r2
2
J2
  



œâ1
œâ2
T
 
 


K1
J1
0
0
K2
J2
  r1K1D
J1
r2K2D
J2
 

œÑ1
œÑ2

(1.16)
Motor inertia J0
2.2e-5 kgm2
Full tape inertia Jf
2.74e-5 kgm2
Radius of empty reel ri
0.01112 m
Radius of full reel ri
0.0304 m
Tape density œÅ
1.7e3 kg/m3
Tape thickness Œµ
8.9e-6 m
Tape width tw
12.54e-3 m
Motor torque constant K1
  K2
1.62e-2 Nm/A
Motor damping constant c
9.56e-5 kg m2
Tape damping coefÔ¨Åcient D
0.9 Ns/m
Tape stiffness K
615 N/m
Table 1.2: Tape Drive Parameters [10]
The model parameters for a tape drive are listed in Table 1.2.
1.3
High-Speed Elevator
With the rapid growth of increasingly taller skyscrapers, there has been a progres-
sive increase in the speed of the elevator. The 1930 Empire State Building elevators
are rated at a speed of 300 meters/min (mpm). Since then, rated speed of elevators
have grown nearly linearly with time culminating with the 1010 mpm speed of the
high-speed elevators in the Taipei 101 in 2004 [11]. With the increasing speed of the
elevators have come numerous other issues which require active control. These in-
clude atmospheric pressure control to regulate the rate of change of cabin pressure to
be the same which has been shown to be physiologically comfortable. Aerodynamic
¬© 2010 by Taylor and Francis Group, LLC

Introduction
7
shaping of the cabin and counterweight to minimize noise and Ô¨Ånally since the long
cable act as springs, vibration control of the cabin. Fortune [12] lists design limits to
ensure minimizing discomfort of passengers:
1. vertical acceleration/deceleration
  1.0‚Äì1.5 m/s2
2. jerk rates
  2.5 m/s3
3. sound
  50 dBa
4. horizontal sway 15‚Äì20 mg
5. ear-pressure change
  2000 Pa
The Ô¨Årst two requirements have to be taken into account in designing controllers for
the motion of the cabin.
Figure 1.4 illustrates schematically a simpliÔ¨Åed lumped parameter model of a
high-speed high-rise elevator. The kinetic energy T and the potential energy V are:
T
  1
2
 J ÀôŒ∏ 2
 M1 Àôx2
1
 M2 Àôx2
2
 (1.17)
V
  1
2
 K1
 x1
 rŒ∏
 2
 K2
 x2
 rŒ∏
 2
 (1.18)
which results in the Euler-Lagrange equations of motion:
M1 ¬®x1
 K1
 x1
 rŒ∏
  c1 Àôx1
  0
(1.19)
M2 ¬®x2
 K2
 x2
 rŒ∏
  c2 Àôx2
  0
(1.20)
J ¬®Œ∏
 K1r
 x1
 rŒ∏
  K2r
 x2
 rŒ∏
 c ÀôŒ∏
  œÑ
(1.21)
.
.
0
0
-
[
T
W
[
Figure 1.4: Schematic of an Elevator
¬© 2010 by Taylor and Francis Group, LLC

8
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
where M1, M2 and J represent the masses of the counterweight, cabin, and inertia of
the drive sheave. K1, K2 represent the stiffness of the cables suspending the coun-
terweight and the cabin respectively. c1, c2 and c represent the damping coefÔ¨Åcients
to capture the loss of energy due to the velocity of the counterweight, cabin, and
sheave. The parameters used for numerical simulation of the elevator model [13] are
listed in Table 1.3.
M1
M2
J
K1
r
5300 kg
3400 kg
1622 kgm2
1.74e7 N/m
1 m
K2
c1
c2
c
1.74e7 N/m
7.2e4 Ns/m
7.2e4 Ns/m
100 kg m/s
Table 1.3: Elevator Model Parameters
1.4
Cranes
Coulton [14] dates the use of cranes to the 6th century BC by the Greeks. From the
6th century BC to the present day cranes which include gantry cranes, tower cranes,
lufÔ¨Ång tower cranes, and boom cranes, have used mechanical advantage generated
by pulleys, hydraulic drives, and so forth, to hoist large loads. The lightly damped
nature of the cable/payload system results in signiÔ¨Åcant pendulation of the payload.
This lightly damped oscillatory motion of the payload can be excited by the control
system in the process of reorienting the payload. This motion could also be excited
by exogenous sources such as wind, and wave motion for offshore cranes. The non-
collocated nature of the actuation and the point to be controlled (payload) results
in complex dynamics. Productivity of cranes in ports, construction zones, etc., is
contingent on efÔ¨Åcient and robust elimination of residual vibration of the payload.
Controlling swing motion during the maneuver is also important to ensure collisions
are avoided with surrounding objects. Hubbell et al. [15] describes various control
problem in cranes which include: sway control, trim/list/skew control, and snag con-
trol. Sway control can be accomplished by recording expert crane operators motion
and reusing the recorded signal or by using real-time measurement of the system
states for feedback control. The trim/list/skew control is achieved by differential
motion of the ropes supporting the payload.
The cable in any crane can either be modeled as a distributed parameter system
which results in the wave equations describing the dynamic behavior of the cable
[16, 17]. This model is rarely used in control design. Lumped parameter models
¬© 2010 by Taylor and Francis Group, LLC

Introduction
9
which assume that the cable can be represented as a massless rigid link is often used
to model the dynamics of payload/crane system [16, 18]. Figure 1.5 is a schematic
of a gantry crane.
X
I
P
P
T
/
Figure 1.5: Gantry Crane
The Euler-Lagrange equation of motion can be derived using the kinetic and po-
tential energies of the system. The kinetic energy is:
T
  1
2m1 ÀôŒ∏ 2
  1
2m2
  ÀôŒ∏
 L ÀôœÜ
 2
(1.22)
and the potential energy is:
V
  m2gL 1
 cos
 œÜ
   (1.23)
where g is the acceleration due to gravity. Assuming small angular displacement œÜ
of the cable, and no damping, the linearized model of the gantry crane is:
 m1
 m2
  ¬®Œ∏
 m2L ¬®œÜ
  u
(1.24)
m2 ¬®Œ∏
 m2L ¬®œÜ
 m2gœÜ
  0
(1.25)
This simple model has been used by various researchers to design and illustrate
controllers. Table 1.4 lists typical crane parameters.
¬© 2010 by Taylor and Francis Group, LLC

10
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
m1
m2
L
g
1000 kg
8000 kg
1‚Äì25 m
9.81 m/s2
Table 1.4: Gantry Crane Parameters
1.5
Slosh Modeling
Slosh is blamed for the failure of NASA‚Äôs ATS-V satellite in 1969 [19]. Hubert
[20] describes how a small amount of liquid adversely affected the stability of the
spin-stabilized satellite, resulting in the loss of the mission. Similarly, rollover of
trucks carrying liquid cargo has been attributed to sloshing effect in partially Ô¨Ålled
tanks [21]. The resulting spill of toxic material can at best cause inconvenience by
requiring evacuation and shutting down of transportation lines and at worst result
in death and damage to property. Bulk Transporter [22] cites 31 rollover incidents
related to transportation of petroleum by one petroleum reÔ¨Åner, in 2001. There is
clearly a need to model slosh and develop techniques to alleviate the effect of slosh
on the stability of the dynamic system.
Slosh is of concern in packaging industry as well where open containers carrying
Ô¨Çuids have to be rapidly moved from Ô¨Ålling stations to sealing stations to maximize
throughput [23]. Casting industries also need to move large quantities of molten
metal which mandates development of motion proÔ¨Åles which minimize slosh [24].
Lamb [25] describes the representation of velocity components of irrotational in-
compressible Ô¨Çuid in terms of a potential œÜ
 x y
 t
 , i.e.,
u
  ‚àÇœÜ
‚àÇx
  v
  ‚àÇœÜ
‚àÇy
 (1.26)
The velocity potential has to satisfy the equation:
‚àÇ2œÜ
‚àÇx2
  ‚àÇ2œÜ
‚àÇy2
  0
(1.27)
where the motion of the Ô¨Çuid can be restricted to two dimensions [25‚Äì27], with
‚àÇœÜ
‚àÇp
  0
(1.28)
representing the boundary conditions at the Ô¨Åxed boundary in the pth coordinate.
Figure 1.6 illustrates schematically a simpliÔ¨Åed pendulum equivalent model for
slosh dynamics of a Ô¨Çuid in a rectangular tank.
Assuming a separation of variable representation of œÜ as:
œÜ
 x y
 t
   œà
xŒ∑
yq t
 (1.29)
Equation (1.27) can be rewritten as:
¬© 2010 by Taylor and Francis Group, LLC

Introduction
11
Figure 1.6: Slosh in a Rectangular Tank
d2œà
 x dx2
Œ∑
 y q t
  d2Œ∑
 y dy2
œà
 x q t
  0
(1.30)
  1
œà
d2œà
 x dx2
   1
Œ∑
d2Œ∑
 y dy2
  Œª 2
 (1.31)
Solving Equation (1.31), we have
œà
 x   Acos
 Œªx Bsin Œªx (1.32)
Œ∑
 y  Ccosh Œªy Dsinh
 Œªy  (1.33)
For the rectangular tank shown in Figure 1.6, we have:
‚àÇœÜ
‚àÇx
    x 0  W
  0    dœà
dx
    x 0  W
  0
(1.34)
‚àÇœÜ
‚àÇy
    y 0
  0    dŒ∑
dy
    y 0
  0  (1.35)
assuming that the reference frame is attached to the lower left-hand corner of the
tank. The boundary conditions lead to:
B
  0  ŒªW
  nœÄ
 D
  0
(1.36)
Normalizing œà such that its 2 norm over x is 1, we have
¬© 2010 by Taylor and Francis Group, LLC

12
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
œà
 x 
 2
W cos
 nœÄ
W x  (1.37)
Œ∑
 y  cosh nœÄ
W y  (1.38)
œÜ
 x y
 t
 
‚àû
‚àë
n  1
 2
W cos nœÄ
W x  cosh nœÄ
W y  qn
t
  (1.39)
For a tank without external excitation, and ignoring the square of the velocity in
the expression for pressure P  x y
 t
  [25], we have
P  x y
 t
 œÅ
 ‚àÇœÜ
‚àÇt
 gy
 (1.40)
Representing the displacement of the Ô¨Çuid above the steady state free surface by Œ¥,
we have
P  x y
 t
 œÅ
 ‚àÇœÜ
‚àÇt
 g Œ¥
H
  (1.41)
whose time derivative is:
ÀôŒ¥
   1
gœÅ
‚àÇP
‚àÇt
  1
g
‚àÇ2œÜ
‚àÇt2
 1
g
‚àÇ2œÜ
‚àÇt‚àÇŒ¥
ÀôŒ¥
 

nonlinear term
(1.42)
Ignoring the nonlinear term and since
ÀôŒ¥
  ‚àÇœÜ
‚àÇy
 (1.43)
we have
1
g
‚àÇ2œÜ
‚àÇt2
  ‚àÇœÜ
‚àÇy
  1
gœÅ
‚àÇP
‚àÇt
(1.44)
Approximating the surface of the Ô¨Çuid to lie at y
  H, and substituting for œÜ
 x y
 t
 into Equation (1.44), we have
1
g
‚àû
‚àë
n  1
 2
W cos
 nœÄ
W x  cosh  nœÄ
W H
  ¬®qn
 t
 
‚àû
‚àë
n  1
nœÄ
W
 2
W cos nœÄ
W x  sinh  nœÄ
W H
 qn
t
  0
(1.45)
since the pressure at the Ô¨Çuid surface is not a function of time. The inner product
in Hilbert space given by integrating the product of Equation (1.45) with the mode
shape œà
 x 
 2
W cos
  kœÄ
W x  leads to
¬© 2010 by Taylor and Francis Group, LLC

Introduction
13
1
g cosh kœÄ
W H
  ¬®qk
 t
  kœÄ
W sinh  kœÄ
W H
 qk
t
  0
(1.46)
¬®qk
 t
  kgœÄ
W tanh kœÄ
W H
  

œâ2
k
qk
 t
  0  (1.47)
Equation (1.47) illustrates that the free surface dynamics can be represented by a
series of second order underdamped systems. Assuming that the Ô¨Årst mode captures
the dominant part of the slosh dynamics, the equivalent pendulum can be represented
as shown in Figure 1.6. The length of the pendulum is given by the equation:
L
  W
œÄ coth  œÄ
W H
  (1.48)
The kinetic energy T, potential energy V, and Rayleigh dissipation energy F are
given as:
T
  1
2m
 Àôx
 Lcos Œ∏
  ÀôŒ∏
 2
 1
2M Àôx2
(1.49)
V
  mgL
 1
 cos
 Œ∏
  (1.50)
F
  1
2c
 Lcos Œ∏
  ÀôŒ∏
 2
 1
2cx
 Àôx  2
(1.51)
where m and M represent the masses of the Ô¨Çuid and the container, and cx and c are
damping constants associated with the motion of the container and the Ô¨Çuid respec-
tively. The Euler-Lagrange equations
d
dt
‚àÇT
‚àÇÀôq
  ‚àÇ
 T
 V
 ‚àÇq
 ‚àÇF
‚àÇÀôq
  Q
(1.52)
where q and Q are the generalized displacement and generalized force respectively,
lead to the equations of motion for the slosh problem:
 m
 M
¬®x
 mL ¬®Œ∏
 cx Àôx
  u
(1.53)
m
 ¬®x
 L ¬®Œ∏
 L
 cL2 ÀôŒ∏
 mgLŒ∏
  0
(1.54)
by ignoring the nonlinear terms and assuming small angular motion for the pendu-
lum.
Table 1.5 lists model parameters which can be used to test various control algo-
rithms that will be presented in the following chapters.
¬© 2010 by Taylor and Francis Group, LLC

14
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
m
M
W
H
L
c
cx
100 kg
20 kg
1 m
0.5 m
0.3471 m
5 Ns/m2
10 Ns/m
Table 1.5: Slosh Dynamics Parameters
1.6
Vehicle Platooning
Intelligent vehicle highway systems (IVHS) is a catch-all concept to address vari-
ous issues related to relieving congestions in metropolitan highways [28]. Motivation
of increasing throughput, reducing fuel consumed, reducing lost productivity time
for drivers, are compelling auto manufacturers to develop technology to alleviate the
aforementioned issues. IVHS has the potential of improving safety of the highway
systems as well. The cost of augmenting the highway system to cater to increasing
trafÔ¨Åc is prohibitive in view of the Ô¨Ånancial and environmental impact. With the in-
creased integration of sensors in vehicles and with reduced cost of microprocessors,
development of self-aware vehicles is viable.
Bae and Gerdes [29] present a simple model to represent the dynamics of a platoon
of tractor trailers. The goal of their research was to prevent actuator saturation of the
vehicles and ensure stability of the coupled tractor platoon. This includes string sta-
bility which implies that disturbances in the upstream inter-vehicle distance should
be attenuated as it travels downstream. The series of tractors can be represented by
lumped masses coupled by virtual springs and dashpots, resulting in a system with
underdamped response. Modifying the reference command to the lead vehicle was
shown to minimize the oscillatory behavior of the inter-tractor distance.
Figure 1.7 illustrates a series of tractor trailers moving in tandem. The protocol
for the platoons includes providing a reference command to the lead vehicle and
the follower vehicles only use knowledge of position and velocity of the preceding
vehicle to make decisions about motion control.
Each vehicle is modeled as a Ô¨Årst order system to represent the actuator delay.
Thus the transfer function relating the vehicle acceleration to the control input U
 s is:
Figure 1.7: Tandem Motion of Tractors (Reprinted with Permission [29].)
¬© 2010 by Taylor and Francis Group, LLC

Introduction
15
s2Xi
 s Ui
s 
bi
s
ai
(1.55)
where Xi is the displacement of the ith vehicle. The lead vehicle uses the control law:
U1
  Ar
 K1
 Vr
  ÀôX1
 (1.56)
where Ar and Vr are the reference acceleration and velocity. Figure 1.8 is the block
diagram representation of the closed-loop system for the lead truck. The resulting
Figure 1.8: Lead Truck Dynamics
transfer function is:
U1
 s Ar
 s

 s
K1
  s
a1
 s s
a1
  K1b1
(1.57)
Similarly, the dynamics of the ith truck can be derived. Figure 1.9 is the block
diagram representation of the closed-loop dynamics of the ith follower truck. The
Figure 1.9: Ith Truck Dynamics
reference input to the ith truck is the velocity of the preceding truck. The controllers
for the follower trucks are:
Ui
  Ki
   ÀôXi 1
  ÀôXi
  wi
Xi 1
 Xi
  (1.58)
The closed-loop dynamics can be shown to be:
Ui
 s ÀôXi 1
 s 
ss
wi
 s
ai
 Ki
sss
ai
 Kibi
 wiKibi
(1.59)
¬© 2010 by Taylor and Francis Group, LLC

16
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
Bae and Gerdes [29] modeled a three tractor trailer platoon using parameters pre-
sented in Table 1.6.
Vehicle #
a
b
k
Ki
wi
1
31.4
11
NA
5
1.2
2
31.4
7
4
5
1.2
3
31.4
10
4
5
1.2
Table 1.6: Platoon Dynamics Parameters [29]
1.7
Summary
This chapter details numerous examples which are characterized by underdamped
oscillatory motion when the dynamic system is tracking a reference input. A large
spectrum of applications are presented to illustrate that the techniques presented in
subsequent chapters are not limited to control of vibrations of structures. Rather,
they can be used to attenuate oscillatory motion excited by the reference input, which
changes the setpoint to the control system. Dynamic models with numerical values
are presented to permit the reader to design and evaluate controllers presented in this
book on examples of their interest.
References
[1] E. D. Daniel, C. D. Mee, and M. K. Clark. Magnetic Recording: The First 100
Years. IEEE Press, New York, 1999.
[2] E. Grochowski and R. F. Hoyt. Future trends in hard disk drives. IEEE Trans-
actions on Magnetics, 32(3):1850‚Äì1854, May 1999.
[3] http://www.seagate.com/www/en-us/products/servers/cheetah/.
[4] T. Semba and M. T. White. An identiÔ¨Åcation method of seek-induced vibra-
tion modes in hard disk drives. In 16th IFAC World Congress, Prague, Czech
Republic, 2005.
[5] G. F. Franklin, J. D. Powell, and M. Workman. Digital Control of Dynamic
Systems. Addison Wesley, 1997.
¬© 2010 by Taylor and Francis Group, LLC

Introduction
17
[6] http://www-03.ibm.com/systems/storage/tape/why/index html.
[7] http://www.insic.org/tape.htm.
[8] S. P. Panda and Y. Lu. Tutorial on control systems design in tape drives. In
ACC, Denver, CO, 2003.
[9] P. D. Mathur and W. C. Messner.
Controller development for a prototype
high-speed low-tension tape transport. IEEE Trans. on Cont. Systems Tech.,
6(4):534‚Äì542, July 1998.
[10] Y. Lu. Advanced control for tape transport. Dissertation, CMU, 2002.
[11] H. Mizuguchi, T. Nakagawa, and Y. Fujita. Breaking the 1000 mpm barrier.
Elevator World, pages 71‚Äì76, September 2005.
[12] J. W. Fortune. Mega high-rise elevators. Elevator World, 43(7):63, December
1995.
[13] R. Roberts. Control of high-rise/high-speed elevators. In ACC, Philadelphia,
PA, June 1998.
[14] J. J. Coulton. Lifting in early Greek architecture. The Journal of Hellenic
Studies, 95:1‚Äì19, 1974.
[15] J. T. Hubbell, B. Koch, and D. McCormick. Modern crane control enhance-
ments. Ports ‚Äô92, pages 757‚Äì767, 1992.
[16] H. Alli and T. Singh. Passive control of overhead cranes. Journal of Vibration
and Control, 5:443‚Äì459, 1999.
[17] C. D. Rahn, F. Zhang, S. Joshi, and D. M. Dawson. Asymptotically stabilizing
angle feedback for a Ô¨Çexible cable gantry crane. ASME J. of Dyn. Systems,
Measurements, and Cont., 121(3):563‚Äì566, 1999.
[18] E. M. Abdel-Rahman, A. H. Nayfeh, and Z. N. Masoud. Dyanmics and control
cranes: A review. Journal of Vibration and Control, 9:863‚Äì908, 2003.
[19] J. P. B. Vreeburg. Spacecraft maneuvers and slosh control. Control Systems
Magazine, IEEE, 25(3):12‚Äì16, June 2005.
[20] C. Hubert. Behavior of spinning space vehicles with onboard liquids. In 2003
Flight Mechanics Symp., pages 1‚Äì14, NASA Goddard, MD, June 2003.
[21] T. Acarman and U. Ozguner. Rollover prevention for heavy trucks using fre-
quency shaped sliging model control. In 2003 IEEE Conference on Control
Applications, pages 7‚Äì12, Istanbul, Turkey, June 2003.
[22] http :
  bulktransporter
com mag  transportation cargo tank rollovers .
[23] M. Grundelius and B. Bernhardsson. Control of liquid slosh in an industrial
packaging machine. In IEEE International Conference on Control Applica-
tions, pages 1654‚Äì1659, Hawaii, HI, August 1999.
¬© 2010 by Taylor and Francis Group, LLC

18
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
[24] Y. Noda, K. Yano, and K. Terashima. Tracking to moving object and sloshing
suppression control using time varying Ô¨Ålter gain in liquid container transfer. In
SICE Annual Conference, pages 2283‚Äì2288, Fukui University, Japan, August
2003.
[25] H. Lamb. Hydrodynamics. Cambridge Mathematical Library, Cambridge, UK,
1993.
[26] R. Venugopal and D. S. Bernstein. State space modeling and active control
of slosh. In IEEE International Conference on Control Applications, pages
1072‚Äì1077, Dearborn, MI, 1996.
[27] R. A. Ibrahim. Liquid Sloshing Dynamics: Theory and Applications. Cam-
bridge University Press, New York, 2005.
[28] A. Martin, H. Marini, and S. Tosunoglu. Intelligent vehicle/highway system:
A survey part 1.
In Florida Conference on Recent Advances in Robotics,
Gainesville, FL, April 29‚Äì30 1999.
[29] H. S. Bae and J. C. Gerdes. Command modiÔ¨Åcation using input shaping for
automated highway systems with heavy trucks. California PATH Research
Report UCB-ITS-PRR-2004-48, Stanford University, 2004.
¬© 2010 by Taylor and Francis Group, LLC

2
Time-Delay Filter/Input Shaping
I Ô¨Ånd that the harder I work, the more luck I seem to have.
Thomas Jefferson, 3rd U.S. President; 1801‚Äì1809; diplomat, politician,
and scholar
P
RECISE position control and rapid rest-to-rest motion is the desired objective
in a variety of applications. The desire for reducing the maneuver time requires
reducing the inertia of the structure which usually reduces the stiffness. This re-
sults in the system response being dominated by the low resonance frequencies. The
maneuver time can also be reduced by increasing the available control force which
mandates larger actuators resulting in increased size and cost. If judiciously selected
feedback and/or feedforward controllers can be used to address the issues raised by
the lightly damped modes, one can achieve the beneÔ¨Åt of rapid maneuvering with
lightweight structures.
For illustrative purposes, consider a hard disk drive: time dedicated to transition-
ing from one cylinder to another has to be reduced to decrease access time. This
mandates driving the voice coil motor to its limits, which consequently results in
exciting the vibratory modes. Since, the position error of the read/write head has
to be less than 10% of the inter-track distance which translates to 25 nm for a drive
with 100,000 tracks per inch, damping of any vibration is necessary. Clearly, there
is a need to develop strategies, that minimize the residual vibration for such point-
to-point maneuvers.
The requirement of precise position control implies that the vibration of the struc-
ture should be zero or near zero at the end of the maneuver. Some applications that
are characterized by the low-frequency, low-damping dynamics include wafer scan-
ners [1], read/write arms of hard disk drives [2], gantry cranes [3], spacecraft with
Ô¨Çexible appendages [4], and so forth. The natural impulse of control engineers is
to design feedback control which has a rich history of successful application and
proven ability in common place devices such as refrigerators, to esoteric applica-
tions such as control of hydrocephalus by pressure relief valves using sensors which
monitor intracranial pressure. Feedback controllers can broadly be classiÔ¨Åed as reg-
ulators where the objective is to maintain a set point, or tracking control where the
set point is a function of time. For tracking control, one has the option of manipulat-
ing the reference proÔ¨Åle so as to satisfy tracking objectives, desensitizing the system
response to modeling uncertainties, or satisfying desired transient state constraints.
19
¬© 2010 by Taylor and Francis Group, LLC

20
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
The shaping of the reference proÔ¨Åle requires no additional hardware, which makes
its inclusion into legacy systems quite easy.
The problem of rapid maneuvering of a Ô¨Çexible structure between two quiescent
attitudes with the objective of minimizing structural vibration has been addressed
by many researchers. Swigert [5] parameterized the control proÔ¨Åle using a sum-
mation of ramp and harmonic (basis) functions and solved for coefÔ¨Åcients of the
basis function to satisfy boundary conditions and minimize the energy consumed.
Scientists interested in designing minimum time control proÔ¨Åles have exploited the
knowledge that the optimal solution for most systems requires the control to be at
its limits (maximum or minimum) and switch between the limits a Ô¨Ånite number of
times. The switching between the limits which is referred to as bang-bang control
has been represented by hyperbolic tangent functions or splines which permits the
use of gradient based optimization algorithms to solve for the switch times. The mo-
tivation for using the hyperbolic tangent or the spline functions to approximate the
discontinuous switch is to minimize ‚Äúringing‚Äù of the higher modes of the structure
which can degrade the performance determined by the terminal state errors. A fairly
comprehensive treatment of this family of problems has been presented by Junkins
and Turner [6], Singh and Singhose [7], and Scrivener and Thompson [8].
Thus, there are two main issues which inÔ¨Çuence the performance of any control
technique for the point-to-point maneuvering of structures whose transients are dom-
inated by oscillations. These are:
  the natural frequency and damping ratio and the associated uncertainties of the
underdamped modes and
  the higher frequency modes which are generally unmodeled
Model based controllers exploit the knowledge of the system model to design feed-
back or open-loop control strategies. The effect of the errors in model parameters
on the stability and performance of the control system has to be analyzed prior to its
deployment. Similarly, the effect of the unmodeled dynamics which can result in in-
stability of some feedback control systems, has to be carefully studied. To illustrate
this, consider a system whose transfer function is:
Y
 s U
s 
100
 s2
 1  s2
 100  (2.1)
which is characterized by two undamped modes of frequencies œâ = 1, and 10 rad/sec.
Assume that the higher frequency corresponds to an unmodeled mode. The step re-
sponses of the system considering only the low frequency mode and both the modes
are shown by the dashed and solid line respectively, in the Ô¨Årst subplot of Figure 2.3.
It is clear that the high frequency mode‚Äôs contribution to the system response is sig-
niÔ¨Åcantly smaller than that of the low frequency mode. Further, the system response
is marginally stable since there is no mechanism to dissipate the energy in the sys-
tem. A proportional-derivative (PD) controller can be used to stabilize the system
represented by the low frequency dynamics as shown in Figure 2.1. The effect of
¬© 2010 by Taylor and Francis Group, LLC

Time-Delay Filter/Input Shaping
21
  
  s
 1
 1
s2
 1
 U
  s U
s Y
s Step
Plant
Figure 2.1: PD Control of Reduced Model
the stabilizing PD controller on the behavior of the system represented by both the
modes is shown in the second subplot of Figure 2.3.
The response to an unit step input is shown by the dashed line in Figure 2.3 which
asymptotically approaches the Ô¨Ånal value of 0.5. Simulating the same PD controller
with the unmodeled mode, as shown in Figure 2.2 results in an unstable response,
illustrated by the solid line in Figure 2.3.
     s
 1
 100
 s2
 1  s2
 100   U
  s U
s Y
s Step
Plant
Figure 2.2: PD Control of Complete Model
This simple example illustrates the fact that the effect of unmodeled dynamics on
the open-loop control system is small. However, the desired objective of forcing the
output to a Ô¨Ånal value is unachievable. On the other hand, the effect of the unmodeled
dynamics on the closed-loop system is manifested in the form of instability. Since
the control designer can anticipate the response of the open-loop system to a given
input, the question of shaping the input to satisfy the Ô¨Ånal value constraints is an
obvious problem to be studied.
Posicast Control
A very interesting technique was proposed by Tallman and Smith [9] which in-
volved splitting the input excitation into several segments such that the sum of all
¬© 2010 by Taylor and Francis Group, LLC

22
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
0
2
4
6
8
10
12
‚àí1
0
1
2
3
0
1
2
3
4
5
6
‚àí2
‚àí1
0
1
2
3
Time
Time
Displacement
Displacement
Figure 2.3: Effect of Unmodeled Dynamics
transient terms equals zero after the last excitation. This technique was referred to as
the Posicast technique. Figure 2.4 illustrates schematically the response of a Posicast
controller.
The transfer function of the system illustrated in Figure 2.4 is one with undamped
poles. As shown in the upper part of the Ô¨Ågure, the response of the system to a step
input of magnitude 0.5 is harmonic, with a peak magnitude of unity. Consider the
same step input applied to the system delayed by a time T as shown in the bottom half
of Figure 2.4. As anticipated, the response is harmonic and its initiation is delayed
by T. If the delay T is selected to be one-half of the period of oscillation of the
system output ( œÄ
œâ ), summing the output of the systems to the two step inputs results
in a nonoscillatory response as shown by the middle graph. Thus, replacing the unit
step input with a staircase input which is generated by summing the two steps of
magnitude 0.5, with one delayed by T seconds, results in a Ô¨Ånite time point-to-point
transition. This staircase input can be represented as:
u  t
  0  5H
 t
  0  5H
 t
  œÄ
œâ
 (2.2)
where H
    is the Heaviside unit step function.
The successful application of the Posicast controller is contingent on the precise
knowledge of the system‚Äôs natural frequency. Any errors in the estimated natural fre-
quency which corresponds to an incorrect selection of T results in poor performance
of the controller. This fact prevented the use of the Posicast controller for numerous
applications which are characterized by underdamped system response.
¬© 2010 by Taylor and Francis Group, LLC

Time-Delay Filter/Input Shaping
23



























7LPH
7LPH
7LPH
'HOD\ 7LPH 7










7LPH
Figure 2.4: Posicast Control
In this chapter, we Ô¨Årst design a time-delay controller for a single mode system
and illustrate that the resulting solution is the same as the Posicast controller. To min-
imize the loss of performance due to errors in estimated model parameters, it will be
shown that multiple instances of this controller in cascade lead to controllers that
are less sensitive to parameter errors. We then design a time-delay controller, where
the time-delay is user selected, this is a generalization of the time-delay controller
proposed by Singh and Vadali [10]. This is followed by studying some properties
of the controller regarding the sign of the gains of the time-delay elements and pe-
riodicity of the controller. We refer to the magnitude of the delayed step input, as
the time-delay gain. A general procedure for the design of user selected time-delay
controllers for multi-mode systems is presented. The controller presented in Sec-
tion 2.3.2 is based on minimizing the time-delay with the gains of the time-delay
elements constrained to lie between 0 and 1. An indexing mechanism with a PD
controller is used to illustrate the time-delay controller.
Effects of high frequency unmodeled modes have been identiÔ¨Åed as a cause of
degradation of performance of controlled systems. Rolling off the frequency re-
sponse function as a function of frequency leads to simple techniques to alleviate
the problem caused by the high frequency unmodeled modes. These techniques are
expounded and tested on an illustrative example in Section 2.4. Finally, the design of
time-delay Ô¨Ålters for discrete-time systems is presented and illustrated on the bench-
mark Ô¨Çexible transmission problem.
An important point to note is that the techniques presented in this chapter deal with
shaping the reference input to the plant. The plant could represent an open-loop or
¬© 2010 by Taylor and Francis Group, LLC

24
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
a closed-loop system. The only assumption is that the plant is stable or marginally
stable and its response is dominated by underdamped or undamped oscillations.
2.1
Time-Delay Filters
2.1.1
Proportional Plus Delay (PPD) Control
As illustrated earlier, shaping the step input to a stair case proÔ¨Åle results in a rest-
to-rest maneuver of an undamped system in Ô¨Ånite time. To analyze the Ô¨Ånite time
rest-to-rest response of the system, consider the Laplace transform of the control
u  t
 :
U
 s  0  5
s
  0  5
s exp
  s œÄ
œâ
   1
s
 0  5
 0  5exp
  s œÄ
œâ
  (2.3)
which can be represented as the output of a time-delay Ô¨Ålter with a transfer function:
U
 s R s  Gs  0  5
 0  5exp
  s œÄ
œâ
 (2.4)
subject to a unit step input (R  s  . The zeros of the transfer function G s  are located
at:
z
   2k
 1  œâ j
  k
  0  1  2      (2.5)
where j
  1. It can be seen that one pair of zeros lie at
œâ j which cancel the
poles of the open-loop system which lie at
 œâ j. This structure of a time-delay Ô¨Ålter
will be used to generalize the Posicast controller.
 A0
  e
 sT
 œâ2
s2
 2Œ∂œâs œâ2
 U
  s U
s Y
s Step
Time-Delay Filter
Plant
Figure 2.5: Time-Delay Filter Structure
Figure 2.5 represents a time-delay Ô¨Ålter which shapes a step input to a second-
order underdamped system. We need to determine A0 and T so that the poles of the
system are canceled by the zeros of the time-delay Ô¨Ålter. The zeros of the Ô¨Ålter are
given by the following equation
¬© 2010 by Taylor and Francis Group, LLC

Time-Delay Filter/Input Shaping
25
A0
 exp
  sT
   0
(2.6)
where we have normalized the relative amplitudes of the proportional and time-
delayed signal. A0 is the amplitude of the proportional signal and T is the delay
time of the time-delayed signal. Representing the Laplace variable s as
s
  œÉ
  jœâ
(2.7)
and substituting Equation (2.7) into Equation (2.6) and equating the real and imagi-
nary parts to zero, we have
A0
 exp
  œÉT
 cos œâT
   0
(2.8)
and
exp œÉT
 sin
 œâT
   0
(2.9)
Solving Equation (2.9) we have
œâ
 2n
 1  œÄ
T
 2n œÄ
T
(2.10)
which when substituted into Equation (2.8), illustrates that only œâ
  2n
 1   œÄ
T pro-
duces a positive value of A0, which leads to
œÉ
   1
T ln  A0
 (2.11)
The zeros of the time-delay Ô¨Ålter are
s
   ln A0
 2n  1  œÄ j
T
if A0
  0
 ln  A0
 2nœÄ j
T
if A0
  0 n
  ‚àû    ‚àû
(2.12)
In this development, we assume A0 is positive and use the zeros corresponding to
that assumption.
To cancel the system poles at s
  Œ∂iœâi
  jœâi
 1
 Œ∂ 2
i , we have from (2.10) (set-
ting n = 0)
œâ
  œâi
 1
 Œ∂ 2
i
  œÄ
T
(2.13)
  T
 œÄ
œâi
 1
 Œ∂ 2
i
(2.14)
and
œÉ
  Œ∂iœâi
(2.15)
Substituting Equation (2.14) into Equation (2.11), we have
 ln  A0
   Œ∂iœâi
œÄ
œâi
 1
 Œ∂ 2
i
(2.16)
¬© 2010 by Taylor and Francis Group, LLC

26
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
which leads to
A0
  exp
 Œ∂iœÄ
 1
 Œ∂ 2
i
 (2.17)
This corresponds exactly to the solution of the Posicast controller. The control proÔ¨Åle
can also be written as
u  s s2
 2Œ∂iœâis
 œâ2
i
  s2
 2Œ∂iœâis
 9œâ2
i
 8Œ∂ 2
i œâ2
i
     s2
 2Œ∂iœâis
 n2œâ2
i
  n2
 1  Œ∂ 2
i œâ2
i
  n
  1  3  4     (2.18)
The pole-zero locations of the controlled system are shown in Figure 2.6. Thus,
the single time-delay Ô¨Ålter can also be used to cancel poles of the system that are odd
multiples of the two primary poles.
‚àí0.6
‚àí0.4
‚àí0.2
0
0.2
0.4
0.6
‚àí10
‚àí8
‚àí6
‚àí4
‚àí2
0
2
4
6
8
10
Real
Imaginary
Figure 2.6: Pole-Zero Locations of the Controlled System in the S-plane
The Ô¨Ånal value of the single time-delay Ô¨Åltered system driven by a unit step input
is given by
lim
s 0
1
s s
  A0
 exp
  sT
  œâ2
i
s2
 2Œ∂iœâis
 œâ2
i
   A0
 1
(2.19)
To force the Ô¨Ånal value of the input after passing through the time-delay Ô¨Ålter to
be the same as that entering the Ô¨Ålter, we normalize the amplitudes of the direct
and time delayed signal, so that the time-delay Ô¨Ålter‚Äôs transfer function is
 A0
 exp  sT
    A0
 1  .
¬© 2010 by Taylor and Francis Group, LLC

Time-Delay Filter/Input Shaping
27
2.1.2
Proportional Plus Multiple Delay (PPMD) Control
The single time-delay Ô¨Ålter, by virtue of canceling the poles corresponding to the
oscillatory behavior of the system, provides us with a technique to produce non-
oscillatory response. The cancelation of the poles of the system is contingent on
the availability of accurate data regarding them. To improve the robustness of the
time-delay Ô¨Ålter to errors in estimated poles, a two-time-delay Ô¨Ålter is proposed as
illustrated in Figure 2.7. The zeros of the Ô¨Ålter are given by the equation:
A0
 A1exp  sT
  exp
 2sT
   0
(2.20)
 A0
  A1e
 sT
  e
 2sT
 œâ2
s2
 2Œ∂œâs œâ2
 U
  s U
s Y
s Step
Time-Delay Filter
Plant
Figure 2.7: Two-Time-Delay Controlled System
The tacit assumption made is that the second delay is twice the Ô¨Årst delay. Letting
s
  œÉ
  jœâ and equating the real and imaginary parts to zero, we have
A0
 A1exp  œÉT
 cos œâT
  exp
 2œÉT
 cos  2œâT
   0
(2.21)
A1 exp
  œÉT
 sin  œâT
  exp
 2œÉT
 sin
 2œâT
   0
(2.22)
respectively. Equation (2.22) can be rewritten as
sin œâT
  A1 exp  œÉT
  2exp
 2œÉT
 cos œâT
    0
(2.23)
the solution of which is
œâ
 2n
 1  œÄ
T
 2n œÄ
T
(2.24)
or
œâ
  1
T cos
 1
  A1
2 exp œÉT
  (2.25)
Substituting œâ
 2n
 1  œÄ
 T into Equation (2.21), we have
A0
 A1exp
  œÉT
  exp
 2œÉT
   0
(2.26)
¬© 2010 by Taylor and Francis Group, LLC

28
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
To design a time-delay Ô¨Ålter that is robust to errors in estimated frequencies, we
equate the derivative of Equation (2.26) with respect to œÉ to zero.
A1 exp
  œÉT
  2exp
  2œÉT
   0
(2.27)
We arrive at the same equation if we differentiate Equation (2.23) with respect to
œâ and equate it to zero. Solving Equation (2.27), we have
A1
  2exp
  œÉT
 (2.28)
Substituting Equation (2.28) into Equation (2.26), we have
A0
  exp  2œÉT
 (2.29)
To cancel the system poles, we equate
œÉ
  Œ∂iœâi
(2.30)
and
œâ
  œâi
 1
 Œ∂ 2
i
  œÄ
T
(2.31)
Thus we have
A0
  exp
 
2œÄŒ∂i
 1
 Œ∂ 2
i
 
(2.32)
A1
  2exp
 
œÄŒ∂i
 1
 Œ∂ 2
i
 
(2.33)
which are also the impulse amplitudes obtained by the solution of the three-impulse
shaped-input technique [11].
Substituting Equation (2.25) into Equation (2.21), we have
A0
 A1exp  œÉT
   A1
2 exp œÉT
   exp
 2œÉT
  2   A1
2 exp
 œÉT
  2
 1
   0
(2.34)
which simpliÔ¨Åes to
A0
 exp
  2œÉT
   0
(2.35)
or
œÉ
   1
2T ln A0
 (2.36)
Substituting T and A0 from Equations (2.31) and (2.32), respectively, we have
œÉ
  Œ∂iœâi
(2.37)
¬© 2010 by Taylor and Francis Group, LLC

Time-Delay Filter/Input Shaping
29
and from Equation (2.25), we have
œâ
  œâi
 1
 Œ∂ 2
i
(2.38)
which indicates that the use of either Equation (2.24) or Equation (2.25) leads to the
same solution. Thus, the effect of the second delay is to provide a second set of
zeros, with all the zeros being coincident with the Ô¨Årst inÔ¨Ånite set, as indicated in
Figure 2.6. The controller should be normalized in the same fashion as the single
time-delayed controller. This controller can also be represented as
u  s s2
 2Œ∂iœâis
 œâ2
i
 2
 s2
 2Œ∂iœâis
 9œâ2
i
 8Œ∂ 2
i œâ2
i
 2
    s2
 2Œ∂iœâis
 n2œâ2
i
  n2
 1  Œ∂ 2
i œâ2
i
 2 n
  1  3  4     (2.39)
Since the zeros are repeated, the controller transfer function should also be equal
to
U
 s R s 
 exp
 
Œ∂iœÄ

1
 Œ∂ 2
i
 
 exp
  sT
  
2
(2.40)
or
U
 s R s 
 exp
 2
Œ∂iœÄ
 1
 Œ∂ 2
i
 
 2exp


Œ∂iœÄ
 1
 Œ∂ 2
i
 exp
  sT
  exp
 2sT
  
(2.41)
which is the same solution represented by Equations (2.20), (2.32), and (2.33).
The robustness of the time-delay Ô¨Ålter to uncertainties in estimated damping and
natural frequency can be analyzed by studying the Taylor series expansion of the
transfer function of the time-delay Ô¨Ålter. The Taylor series around the point snom is
G s 
‚àû
‚àë
k  0
1
k!
‚àÇkG s ‚àÇsk
    s snom
s
 snom
 k
(2.42)
  G s s snom
 ‚àÇG s
‚àÇs
    s snom
 s
snom

(2.43)
1
2
‚àÇ2G s ‚àÇs2
    s snom
 s
 snom
 2
 H OT
 s
(2.44)
where H OT denotes the higher order terms. Thus, it can be seen that by locating n
pairs of zeros of the time-delay Ô¨Ålter at the nominal value of the poles of the system
(snom), the Ô¨Årst n terms of the Taylor series are forced to zero which implies that the
magnitude of G s  in the vicinity of snom is reduced.
Example 2.1:
To illustrate the PPD and PPMD controllers, consider the position
¬© 2010 by Taylor and Francis Group, LLC

30
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
Figure 2.8: Indexing Mechanism
control of a double integrator which can represent the model of a motor (Figure 2.8).
The system model is
J ¬®Œ∏
  u  (2.45)
where J corresponds to the inertia of the motor. A proportional plus derivative con-
troller
u
  K1
 Œ∏
 r
  K2 ÀôŒ∏
(2.46)
where r is the reference input, is guaranteed to be stable provided the gains K1 and
K2 are greater than zero. The closed-loop transfer function is
Œò  s R  s

K1
Js2
 K2s
 K1
(2.47)
and the closed-loop poles are located at
s
  K2
  K2
2
 4JK1
2J
 (2.48)
If 4JK1
  K2
2, the resulting closed-loop poles result in an underdamped system re-
sponse. The natural frequency and damping ratios of the closed-loop response are
œân
  K1
J
  Œ∂
 K2
2
 JK1
(2.49)
which are used to determine the transfer function of the time-delay Ô¨Ålters.
¬© 2010 by Taylor and Francis Group, LLC

Time-Delay Filter/Input Shaping
31
0
2
4
6
8
10
12
14
16
18
0
0.2
0.4
0.6
0.8
1
1.2
1.4
PPD Filter
PPMD Filter
0
2
4
6
8
10
12
14
16
18
‚àí0.05
0
0.05
0.1
0.15
0.2
0.25
0.3
PPD Filter
PPMD Filter
Time
Time
Displacement
Velocity
Figure 2.9: System Response to the PPD and PPMD Time-Delay Filters
Figure 2.9 illustrates the evolution of the angular displacement and the angular
velocities of the system where it is assumed that the inertia of the system is exactly
known. The solid line and the dashed line correspond to the PPD and the PPMD
time-delay Ô¨Ålters respectively. It is clear that both the Ô¨Ålters generate zero residual
energy at the end of the maneuver. However, the PPMD Ô¨Ålter takes twice as long to
complete the maneuver as the PPD Ô¨Ålter.
7
8
9
10
11
12
13
0
0.01
0.02
0.03
0.04
0.05
0.06
0.07
Uncertain Inertia
Square Root of Residual Energy
Figure 2.10: Time-Delay Filter Sensitivity
¬© 2010 by Taylor and Francis Group, LLC

32
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
To study the variation in the performance of the PPD and PPMD time-delay Ô¨Ålters
in the presence of errors in estimated inertia of the system, the square root of the
residual energy of the systems driven by Ô¨Ålters designed for the nominal systems are
determined and plotted in Figure 2.10. The solid line which corresponds to the PPD
Ô¨Ålter illustrates that the performance of the PPD Ô¨Ålter deteriorates rapidly as the error
in the estimated inertia increases. The results of the PPMD Ô¨Ålter illustrated by the
dashed line conÔ¨Årm the insensitivity of the PPMD Ô¨Ålter in the vicinity of the nominal
model of the system.
2.2
Proportional Plus User Selected Multiple Delay Control
In the time-delay Ô¨Ålter designed in Section 2.1, the time-delays appears non-
linearly in the equations, which increases the difÔ¨Åculty of arriving at closed-form
solutions for anything except a one or two mode system. The time-delay of the mul-
tiple time-delay controller is a function of the natural frequencies of the system. To
eliminate this constraint, we propose, in this section, a class of time-delay Ô¨Ålters
where the time-delay is selected by the user, thus giving greater latitude to the de-
signer. The unknown gains of the time-delayed signals, which appear linearly, can
be easily solved for. Consider an underdamped second-order plant and a two-time-
delay Ô¨Ålter (Figure 2.12) where T is selected by the user. We choose the second
time-delay to be twice that of the Ô¨Årst although this is not necessary. We need to
determine A0, A1, and A2 to cancel the poles of the system. We require that the zeros
of the time-delay Ô¨Ålter be coincident with the system poles. The equations
A0
 A1exp  œÉT
 cos  œâT
  A2exp  2œÉT
 cos 2œâT
   0
(2.50)
A1 exp  œÉT
 sin  œâT
  A2exp
  2œÉT
 sin
 2œâT
   0
(2.51)
where œÉ
  Œ∂iœâi and œâ
  œâi
 1
 Œ∂ 2
i are used to solve for A0, A1, and A2. The
requirement that the Ô¨Ånal value of the preÔ¨Åltered signal be the same at the reference
signal leads to the constraint:
A0
 A1
 A2
  1  (2.52)
Solving Equations (2.50), (2.51), and (2.52), we have
A0
 exp  2œÉT
 exp  2œÉT
  2exp
  œÉT
 cos œâT
 1
(2.53)
A1
  2exp
  œÉT
 cos œâT
 exp  2œÉT
  2exp
  œÉT
 cos œâT
 1
(2.54)
A2
 1
exp  2œÉT
  2exp
  œÉT
 cos œâT
  1
(2.55)
¬© 2010 by Taylor and Francis Group, LLC

Time-Delay Filter/Input Shaping
33
Figure 2.11 illustrates the variation of the log of the absolute value of the transfer
‚àí0.25
‚àí0.2
‚àí0.15
‚àí0.1
‚àí0.05
0
‚àí2
‚àí1
0
1
2
‚àí4
‚àí3
‚àí2
‚àí1
0
1
Real Axis
Imaginary Axis
Figure 2.11: Log Magnitude of Time-Delay Filter Transfer Function
function of the time-delay Ô¨Ålter over the s-domain. It is clear that the function goes
to zero at the estimated location of the poles of the system. However, there is a rapid
increase in the magnitude as one moves away from the poles of the system. Thus,
any error in estimated frequency or damping, will lead to an oscillatory response to a
step input. To build robustness into the time-delay Ô¨Ålter, we require that, in addition
to the cancelation of the poles of the system, the variation of Equations (2.50) and
(2.51) with respect to frequency be zero. This leads to a total of Ô¨Åve equations with
three unknowns. We therefore introduce two more delays in the controller whose
transfer function is now
A0
 A1exp
  sT
  A2exp
  2sT
  A3exp  3sT
  A4exp
  4sT
 (2.56)
The gains of the time-delay Ô¨Ålter can be determined such that the following Ô¨Åve
equations are satisÔ¨Åed:
A0
 A1exp  œÉT
 cos œâT
  A2exp
  2œÉT
 cos 2œâT
  A3 exp
  3œÉT
 cos 3œâT
  A4exp  4œÉT
 cos 4œâT
   0
(2.57)
A0
 A1exp
  œÉT
 sin  œâT
  A2exp  2œÉT
 sin  2œâT
  ¬© 2010 by Taylor and Francis Group, LLC

34
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
 A0
  A1e
 sT
  A2e
 2sT
 œâ2
s2
 2Œ∂œâs œâ2
 U
  s U
s Y
s Step
Time-Delay Filter
Plant
Figure 2.12: User Selected Time-Delay Controlled System
A3 exp  3œÉT
 sin  3œâT
  A4exp  4œÉT
 sin  4œâT
   0
(2.58)
d
dœâ
 A0
 A1exp  œÉT
 cos œâT
  A2exp
  2œÉT
 cos 2œâT
  A3exp  3œÉT
 cos 3œâT
  A4exp  4œÉT
 cos 4œâT
    0
(2.59)
d
dœâ
 A0
 A1exp
  œÉT
 sin  œâT
  A2exp  2œÉT
 sin  2œâT
  A3 exp  3œÉT
 sin  3œâT
  A4exp
  4œÉT
 sin
 4œâT
    0
(2.60)
A0
 A1
 A2
 A3
 A4
  1  (2.61)
It can be shown that two, two-time-delay Ô¨Ålters in series are equivalent to the result-
ing Ô¨Ålter. The transfer function of the resulting time-delay Ô¨Ålter is
U
 s R s 
 exp
  2œÉT
  2exp
  œÉT
 cos œâT
 exp  sT
  exp
 2sT
 exp  2œÉT
  2exp
  œÉT
 cos œâT
 1
 2
(2.62)
It is to be noted that we will arrive at the same solution if we force the variations
of Equation (2.56) with respect to œÉ, to zero. Thus, the robustness is concurrently
increased with respect to errors in estimated frequency and damping.
2.2.1
Signs of the Time-Delay Gains
It might sometimes be required to limit the magnitude of the time-delay gains to
be positive, while satisfying Equation (2.52). This is desirable from a practical stand-
point as we would not require the actuator to track large steps, which could occur if
the time-delay gains were unconstrained. Hence, we require from Equation (2.54),
that the time-delay T satisfy
œÄ
2
  œâT
  3œÄ
2
(2.63)
which is equivalent to
Ts
4
  T
  3Ts
4
(2.64)
where Ts, is the system period. To illustrate that Equations (2.53), (2.54) and (2.55)
represent a generalization of the time-delay control [10], we study the case when
T
  Ts
 4. This leads to
¬© 2010 by Taylor and Francis Group, LLC

Time-Delay Filter/Input Shaping
35
A0
 exp
 Œ∂œÄ
 1  Œ∂ 2
 exp
 Œ∂œÄ
 1  Œ∂ 2
  1
(2.65)
A1
  0
(2.66)
A2
 1
exp
 Œ∂œÄ
 1  Œ∂ 2
  1
(2.67)
and the Ô¨Ålter degenerates to the two-impulse shaped-input controller. Further, when
T
  Ts
 2, we have
A0
 exp
 2Œ∂œÄ
 1  Œ∂ 2
 exp
 2
Œ∂œÄ
 1  Œ∂ 2
  2exp
 Œ∂œÄ
 1  Œ∂ 2
  1
(2.68)
A1
 2exp
 Œ∂œÄ
 1  Œ∂ 2
 exp
 2
Œ∂œÄ
 1  Œ∂ 2
  2exp
 Œ∂œÄ
 1  Œ∂ 2
  1
(2.69)
A2
 1
exp
 2
Œ∂œÄ
 1  Œ∂ 2
  2exp
 Œ∂œÄ
 1  Œ∂ 2
  1
(2.70)
which is equivalent to the three impulse shaped-input controller. It can also be shown
that when T
  3Ts
 4 the resulting Ô¨Ålter is the same as when T
  Ts
 4 except that the
system response delay is increased by one period.
Figure 2.13 illustrates the variations of the gains of the time-delay Ô¨Ålter as a func-
tion of the user selected time-delay. It can be seen from the Ô¨Ågure that there exist
periodic intervals over which all the gains are positive. The Ô¨Ågure is generated for a
system mode with a frequency of 1 and a damping ratio Œ∂ of 0.1.
2.2.2
Periodicity
The time-delay Ô¨Ålter leads to an inÔ¨Ånite number of zeros, one pair of which cancels
a pair of poles of the system. To determine the zeros of the time-delay Ô¨Ålter as a
function of the user selected time T, we write Equations (2.50) and (2.51) with the
appropriate values of A0, A1, and A2 to arrive at
exp
  2œÉsT
  2exp
  œÉsT
 cos œâs
 1
 Œ∂ 2
i T
 exp  œÉT
 cos œâT
 exp
  2œÉT
 cos  2œâT
   0
(2.71)
¬© 2010 by Taylor and Francis Group, LLC

36
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
0
2
4
6
8
10
12
14
16
18
20
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
A1
A2
A3
Sample Time (sec)
Filter Gains
Figure 2.13: Time-Delay Filter Gains
and
 2exp
  œÉsT
 cos œâs
 1
 Œ∂ 2
i T
 exp  œÉT
 sin  œâT
 exp
  2œÉT
 sin  2œâT
   0
(2.72)
From Equation (2.71), which is quadratic in exp œÉT
  we have
exp  œÉT
   exp
 œÉsT
 cos œâs
 1
 Œ∂ 2
i T
 cos œâT
  Œ¶
cos 2œâT
 (2.73)
and from Equation (2.72), we have
 2cos
 œâs
 1
 Œ∂ 2s T
  cos
 œâs
 1
 Œ∂ 2
i T
 cos œâT
  Œ¶
cos
 2œâT
 sin  2œâT
   0
(2.74)
where
Œ¶
  cos2
œâs
 1
 Œ∂ 2
i T
 cos2
 œâT
  cos
 2œâT
  0  5
Solving Equations (2.73) and (2.74), we have
œÉ
  œÉs
(2.75)
¬© 2010 by Taylor and Francis Group, LLC

Time-Delay Filter/Input Shaping
37
and
œâ
  œâs
 1
 Œ∂ 2s
  2nœÄ
T
(2.76)
Thus, the smaller the value of T, the larger are the intervals between zeros of the
time-delay controller. In the special case when T
  œÄ
 œâs
 1
 Œ∂ 2s the imaginary
parts of the zeros of the Ô¨Ålter are odd multiples of the imaginary parts of the system
poles.
The time-delay Ô¨Ålter can be mapped into the z-domain, where one can show that
the same objective is met, i.e., cancelation of the poles of the system by the time-
delay Ô¨Ålter zeros. However, in the z-domain, we would solve a polynomial equation
to arrive at the zeros of the Ô¨Ålter, which are Ô¨Ånite in number, unlike in the s-domain
where we solve a transcendental equation to results in an inÔ¨Ånite set of zeros of the
Ô¨Ålter.
2.3
Time-Delay Control of Multi-Mode Systems
The technique for the design of time-delay Ô¨Ålters for single-mode systems can
be extended to multiple-mode systems by cascading the time-delay Ô¨Ålters designed
for each mode. This will not lead to the smallest number of delay times to cancel
the dynamics of the two underdamped modes. Figure 2.14 illustrates the cascaded
time-delay Ô¨Ålter for a multi-mode system.
 ‚àèm
i 1
 Ai
0
  Ai
1e
 sT i
  ‚àèm
i 1
œâ2
i
s2
 2Œ∂iœâis œâ2
i
 U
  s U
s Y
s Step
Time-Delay Filter
Plant
Figure 2.14: Multi Mode Time-Delay Controlled System
where
Ai
0
 exp
 Œ∂iœÄ
 1  Œ∂ 2
i
 exp
 Œ∂iœÄ
 1  Œ∂ 2
i
  1
(2.77)
¬© 2010 by Taylor and Francis Group, LLC

38
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
Ai
1
 1
exp
 Œ∂iœÄ
 1  Œ∂ 2
i
  1
(2.78)
T i
 œÄ
œâi
 1
 Œ∂ 2
i
 (2.79)
2.3.1
Concurrent Time-Delay Filter Design for Multi-Mode Systems
Time-delay Ô¨Ålters for multi-mode system can be designed by selecting the param-
eters of the Ô¨Ålter to concurrently satisfy the pole cancelation constraints. Analytical
solutions to multi-mode systems can rarely be derived. This prompts posing an op-
timization problem to numerically design the time-delay Ô¨Ålter. Consider a system
with m underdamped modes (poles). The time-delay Ô¨Ålter can be parameterized as:
N
‚àë
i 0
Aie
 sTi
(2.80)
where T0 = 0. The number of delays N is a function of the system to be controlled.
The optimization problem can be stated as:
min
Ai
 Ti J
  TN
subject to
N
‚àë
i 0
Ai exp
 Œ∂jœâjTi
 cos œâj
 1
 Œ∂ 2
j Ti
   0
 j
  1  2     m
N
‚àë
i 0
Ai exp
 Œ∂jœâjTi
 sin  œâj
 1
 Œ∂ 2
j Ti
   0
 j
  1  2     m
N
‚àë
i 0
Ai
  1
Ti
  Ti 1
  0
 i
  1  2     N
0
  Ai
  1
 i
  1  2     N
This formulation results in an impractical solution if Ai‚Äôs are not constrained. It can
lead to large values for Ai which can result in a reference proÔ¨Åle which demands
large inputs if the constraints are
 Ai
   C, for C
  1. By enforcing the constraint
0
  Ai
  1, the resulting staircase reference proÔ¨Åle demands a smaller peak control
input as compared to the unÔ¨Åltered reference input.
¬© 2010 by Taylor and Francis Group, LLC

Time-Delay Filter/Input Shaping
39
Example 2.2:
The closed-loop dynamics of a gantry crane characterized by the
model:
9150 ¬®Œ∏
 80000 ¬®œÜ
  u
(2.82)
80000 ¬®Œ∏
 800000 ¬®œÜ
 784800œÜ
  0
(2.83)
subject to the collocated PD controller:
u
  600  Œ∏
 1 
 100 ÀôŒ∏
(2.84)
is characterized by closed-loop poles located at:
s
  0  0049
 0  2488i and
 0  0386
 2  8745i Time-delay Ô¨Ålters to cancel the two modes separately are:
G1
 s   0  5105
0  4895exp
 1  0929s (2.85)
G2
 s   0  5154
0  4846exp
 12  6263s (2.86)
which when convolved lead to the time-delay Ô¨Ålter
G s  G1
 s G2
 s  0  2631
 0  2523exp
  1  0929s  0  2474exp
 12  63s  0  2372exp
 13  72s  (2.87)
The solid line in Figure 2.15 illustrates the staircase reference proÔ¨Åle which induces
the nonoscillatory motion of the pendulum illustrated in Figure 2.16 by the solid line.
Designing a time-delay Ô¨Ålter parameterized using two time-delays and solving for
the parameters of the Ô¨Ålter to concurrently cancel the two pairs of underdamped poles
of the closed-loop system results in the Ô¨Ålter:
G s  0  5111
 0  3240exp
  12  0961s  0  1649exp
 13  6687s (2.88)
Dashed lines in Figures 2.15 and 2.16 illustrate the shaped reference proÔ¨Åle and the
corresponding pendular displacement. The reduction in maneuver time for this ex-
ample is minimal. The concurrent design however, uses fewer time-delays in shaping
the reference proÔ¨Åle.
2.3.2
User Selected Time-Delay
The design of the time-delay Ô¨Ålters in Section 2.2 was simpliÔ¨Åed as the unknowns
appeared linearly in the constraint equations. This concept can easily be extended to
the design of time-delay Ô¨Ålters for systems with more than one mode of vibration.
The easiest design would be to connect the time-delay Ô¨Ålters for each of the modes
in series. This, however, will not lead to the minimum number of delays in the
¬© 2010 by Taylor and Francis Group, LLC

40
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
0
5
10
15
20
25
0
0.2
0.4
0.6
0.8
1
Time
Shaped Reference
Figure 2.15: Shaped-Reference ProÔ¨Åle
0
5
10
15
20
25
0
0.2
0.4
0.6
0.8
1
1.2
1.4
Time
Pendulum Displacement
Figure 2.16: Motion and Control ProÔ¨Åle
controller. In addition, the system response will not be the shortest possible. We
can reformulate the constraints so that the selection of the gains of the time-delay
Ô¨Ålter satisfy the constraints simultaneously. To control one mode, we required a two-
time-delay Ô¨Ålter, and we need to add two more time-delays for the control of each
additional mode. The transfer function of the time-delay Ô¨Ålter for a m-mode system
is
¬© 2010 by Taylor and Francis Group, LLC

Time-Delay Filter/Input Shaping
41
2m
‚àë
i 0
Ai exp  isT
 (2.89)
The constraints Ai have to satisfy the constraints
2m
‚àë
i 0
Ai exp  iœÉjT
 cos  iœâjT
  0
(2.90)
2m
‚àë
i 0
Ai exp  iœÉjT
 sin
 iœâjT
  0
(2.91)
for j = 1 to m, where œÉj is the damping constant and œâj is the damped natural
frequency of the jth mode. We also require
2m
‚àë
i 0
Ai
  1
(2.92)
to ensure that the zero frequency of the time-delay Ô¨Ålter is unity. We now have 2m +
1 equations in 2m + 1 unknowns, which can be solved easily as the unknowns appear
linearly in the equations. The matrix equation to be solved is
 






1 e
 œÉ1T cos œâ1T
  e
 2œÉ1T cos 2œâ1T
     e
 2mœÉ1T cos 2mœâ1T
 0
e
 œÉ1T sin  œâ1T
  e
 2œÉ1T sin  2œâ1T
     e
 2mœÉ1T sin  2mœâ1T
                1 e
 œÉmT cos œâmT
  e
 2œÉmT cos 2œâmT
     e
 2mœÉmT cos 2mœâmT
 0 e
 œÉmT sin  œâmT
  e
 2œÉmT sin  2œâmT
     e
 2mœÉmT sin  2mœâmT
 1
1
1
   1
 























A0
A1
...
A2m 2
A2m 1
A2m
 















 
















0
0
...
0
0
1
 















 (2.93)
For certain values of T, the above matrix might become singular. In such cases, the
solution can be obtained by using the pseudo-inverse technique. The pseudo-inverse
solution will be exact for a row deÔ¨Åciency, but for a column rank deÔ¨Åciency, a least
square approximation solution results, which does not satisfy the constraints. In this
case, we need to select a different T so that column rank deÔ¨Åciency is avoided.
2.3.3
Minimum Time-Delay
In Section 2.3.2, a set of linear equations had to be solved to arrive at the time-
delay Ô¨Ålter. We choose to modify the proposed technique such that all the time-delay
¬© 2010 by Taylor and Francis Group, LLC

42
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
gains are positive. When the gains are unconstrained, the resulting control input
could ring the unmodeled dynamics of the system. This is undesirable for Ô¨Çexible
structures. With all the time-delay gains being positive, we are assured that they
will lie in the range 0‚Äì1. We reformulate the design process so as to minimize the
time-delay T, i.e.,
min
Ai
 T J
  T 2
(2.94a)
subject to
(2.94b)
2m
‚àë
i 0
Ai exp
  iœÉjT
 cos iœâjT
  0   j
  1  2    m
(2.94c)
2m
‚àë
i 0
Ai exp
  iœÉjT
 sin  iœâjT
  0   j
  1  2    m
(2.94d)
2m
‚àë
i 0
Ai
  1
(2.94e)
Ai
  0
 i
(2.94f)
Solution of the optimization problem leads to the desired time-delay Ô¨Ålter. The
use of multiple time-delay Ô¨Ålters in cascade adds robustness to errors in system pa-
rameters.
2.4
Jerk Limited Input Shapers
Jerk is the time rate of change of acceleration, i.e., the derivative of the control
input and is a measure of the impact level. Impact in mechanical systems is man-
ifested in the form of noise and reduces life due to fatigue. For various Ô¨Çexible
structures, higher level of jerk correlates to exciting the higher modes of the system
which is commonly referred to as ringing. The input shaping/time-delay Ô¨Ålter design
requires information of the natural frequency and damping ratio of speciÔ¨Åc modes to
be controlled. If it is necessary to roll off the energy over the high frequency spec-
trum, which includes unmodeled modes, additional constraints need to be included
in the Ô¨Ålter design. It is interesting to note that human ballistic motion which refer
to movement initiated by robust muscular contractions followed by relaxed muscles
while the momentum carries the limbs to their Ô¨Ånal destination, has been shown to
be jerk limited.
This section will address the problem of jerk limited input shapers for preÔ¨Åltering
command inputs to vibratory systems without rigid body modes. The papers by
Muenchhof and Singh [12, 13] addressed the problem of design of control proÔ¨Åles
for systems with rigid body modes. This section will start by addressing the design
of time-delay Ô¨Ålters where the delay time and the gains of the delayed signals are
¬© 2010 by Taylor and Francis Group, LLC

Time-Delay Filter/Input Shaping
43
parameters to be solved for. This will be followed by the presentation of a general
concept to design input shapers by including additional dynamics to the time-delay
Ô¨Ålter such as harmonic oscillators and Ô¨Årst order dynamics to permit smooth ramping
up and ramping down of control proÔ¨Åles.
2.4.1
Undamped Systems
This section deals with the design of jerk limited time-delay Ô¨Ålter (Input Shaper)
which is schematically represented in Figure 2.17. The developmentwhich follows is
for a single mode system, but can be easily extended for multiple mode systems [14].
 1
 e
 sT1
 e
 s 2T2
 T1
  e
 2sT2
 J
s
 R  s Y
s Step
Time-Delay Filter
Integrator
Figure 2.17: Jerk Limited Time-Delay Controlled System
The transfer function of the Ô¨Ålter shown in Figure 2.17 without the integrator ele-
ment is
G s 
1
 exp
  sT1
  exp
 s 2T2
 T1
   exp
  2sT2
   (2.95)
The output of the transfer function G(s) subject to a unit step input is shown in Figure
2.18 and its time integral is represented as
  t
Jerk
J
T1
2T2
 T1
2T2
Figure 2.18: Parameterized Control ProÔ¨Åle
¬© 2010 by Taylor and Francis Group, LLC

44
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
y t
  J
t
 t
 T1
 H
 t
 T1
  t
 2T2
 T1
  H
 t
  2T2
 T1
    t
 2T2
  H
 t
 2T2
    (2.96)
where J is the permissible jerk and H
   is the Heaviside step function. y t
  should
equal 1 at steady state for a DC (zero frequency) gain of unity which results in the
constraint equation
y  2T2
   J
2T2
  2T2
 T1
  2T2
  2T2
 T1
     1  (2.97)
or
T1
  1
2J
 (2.98)
which implies that the Ô¨Årst switch T1 is only a function of the permitted jerk. To
cancel the undamped poles of the system, we require a pair of zeros of the time-
delay Ô¨Ålter to cancel the poles of the system. This results in the constraint equations
1
 cos
 œâT1
  cos
œâ
2T2
 T1
   cos
 2œâT2
   0
(2.99)
and
 sin œâT1
  sin
œâ
2T2
 T1
   sin 2œâT2
   0
(2.100)
These two constraint equations are satisÔ¨Åed if
sin œâT2
   sin œâ
T2
 T1
   (2.101)
Substituting Equation (2.98) into Equation (2.101), and simplifying we have
tan œâT2
   cot
  œâ
4J
 (2.102)
which results in the closed-form solutions
T2
  2n
 1  œÄ
2œâ
  1
4J
 (2.103)
For speciÔ¨Åc values of œâ and J, T1 can equal T2, which corresponds to the Ô¨Årst and
the second switch collapsing. From Equations (2.98) and (2.101), this corresponds
to
sin  œâT2
   0    cos
  œâ
4J
   0
(2.104)
or
œâ
4J
  2m
 1  œÄ
2
  m=1,2,3...
(2.105)
So, for a given J or œâ, we can solve for œâ or J respectively for which T1 and T2 are
equal, which corresponds to a simple ramp input to the system.
Figures 2.19 and 2.20 illustrate the variation of the switch times and the Ô¨Ånal time
of the time-delay Ô¨Ålter as a function of varying jerk and frequency, respectively. It
is clear from Figure 2.20, that the Ô¨Årst and second switches coincide, which corre-
sponds to the solid line intersecting the dashed line. Figure 2.20 is generated for J
= 3, for which we have from Equation (2.105), œâ = 6œÄ, 18œÄ, 30œÄ, for which the
switches collapse, which corroborates the results in Figure 2.20.
¬© 2010 by Taylor and Francis Group, LLC

Time-Delay Filter/Input Shaping
45
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
0
2
4
6
8
10
12
First Switch 
Second Switch
Final Time
Permitted Jerk
Switch Times
Figure 2.19: Switch Time Variation vs. Jerk for œâ = 15
0
10
20
30
40
50
60
70
80
90
100
0
0.1
0.2
0.3
0.4
0.5
0.6
First Switch 
Second Switch
Final Time
Switch Times
Frequency
Figure 2.20: Switch Time Variation vs. Frequency
2.4.2
Damped Systems
Unlike the jerk limited time-delay Ô¨Ålters for undamped systems, the jerk limited
time-delay Ô¨Ålter for damped systems cannot be solved in closed form. The problem
can be solved numerically by posing the design as an optimization problem.
The jerk limited time-delay Ô¨Ålter is parameterized as
G s  J
s
1
 exp
  sT1
  exp
 sT2
  exp
  sT3
   (2.106)
¬© 2010 by Taylor and Francis Group, LLC

46
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
To satisfy the requirement that the Ô¨Ånal value of the jerk limited time-delay Ô¨Ålter be
unity when it is driven by an unit step input results in the constraint equation
y  T3
   J
T3
 T1
 T2
   1  (2.107)
To cancel the damped poles of the system at s = œÉ
  jœâ, we require a pair of zeros
of the time-delay Ô¨Ålter to be collocated with the plant‚Äôs damped poles. This results
in the constraint equations
1
 e
 œÉT1 cos
 œâT1
  e
 œÉT2 cos œâT2
  e
 œÉT3 cos œâT3
   0
(2.108)
and
 e
 œÉT1 sin  œâT1
  e
 œÉT2 sin  œâT2
  e
 œÉT3 sin  œâT3
   0  (2.109)
The optimization problem can be stated as minimization of T3 subject to the three
equality constraints given by Equations (2.107), (2.108), and (2.109).
2.5
Robust Jerk Limited Time-Delay Filter
Most systems have errors in estimated damping and natural frequencies which
can result in signiÔ¨Åcant residual errors when a rest-to-rest maneuver is performed.
It is therefore imperative to design Ô¨Ålters which can handle uncertainties in esti-
mated model parameters. There are multiple approaches to achieve robustness. The
simplest includes reducing the sensitivity of the residual energy of the modes to un-
certain parameters, based on the nominal values of uncertain parameters. If bounds
and distributions of the uncertain parameters are available to the designer, the mini-
max approach proposed by Singh [15] can be used to arrive at Ô¨Ålters which minimize
the maximum magnitude of the residual energy in the domain of interest. This will
be presented in detail in Chapter 5. In this development, robustness is achieved by
placing multiple zeros of the time-delay Ô¨Ålter at the location of the uncertain poles
of the plant.
The added requirement of robustness results in a Ô¨Ålter with increased number of
parameters to be determined. The approach for the design of robust jerk limited time-
delay Ô¨Ålters is developed for damped systems with the knowledge that the undamped
systems are a subset of the damped system. The robust jerk limited time-delay Ô¨Ålter
is parameterized as
G s  J
s
1
 exp
  sT1
  exp
 sT2
  exp
  sT3
  exp
 sT4
  exp
  sT5
   (2.110)
To satisfy the requirement that the Ô¨Ånal value of the jerk limited time-delay Ô¨Ålter be
unity when it is driven by an unit step input results in the constraint equation
y  T5
   J
T5
 T4
 T3
 T2
 T1
   1  (2.111)
¬© 2010 by Taylor and Francis Group, LLC

Time-Delay Filter/Input Shaping
47
To cancel the damped poles of the system at s = œÉ
  jœâ, we require a pair of zeros
of the time-delay Ô¨Ålter to cancel the damped poles of the system. This results in the
constraint equations
1
 e
 œÉT1cos œâT1
  e
 œÉT2cos œâT2
  e
 œÉT3cos œâT3
  e
 œÉT4cos œâT4
  e
 œÉT5cos œâT5
   0
(2.112)
and
 e
 œÉT1 sin  œâT1
  e
 œÉT2 sin  œâT2
  e
 œÉT3 sin  œâT3
  e
 œÉT4 sin  œâT4
  e
 œÉT5 sin  œâT5
   0  (2.113)
Robustness to uncertainties in natural frequencies or damping ratios is achieved by
placing a second pair of zeros of the time-delay Ô¨Ålter at the estimated location of the
oscillatory poles of the system, which results in the equations
 T1e
 œÉT1 sin  œâT1
  T2e
 œÉT2 sin œâT2
  T3e
 œÉT3 sin  œâT3
  T4e
 œÉT4 sin  œâT4
  T5e
 œÉT5 sin  œâT5
   0
(2.114)
and
 T1e
 œÉT1cos œâT1
  T2e
 œÉT2cos œâT2
  T3e
 œÉT3cos œâT3
  T4e
 œÉT4cos œâT4
  T5e
 œÉT5cos œâT5
   0  (2.115)
The optimization problem can now be stated as the minimization of T5 subject to the
constraint given by Equations (2.111) through (2.115).
To illustrate the reduced sensitivity of the residual energy to variations in the fre-
quency, the response of the system was studied for various values of model frequen-
cies with a Ô¨Ålter designed for a frequency of 15 rad/sec and a permitted jerk of 4.
Figure 2.21 illustrates the improved performance of the robust jerk limited time-
delay Ô¨Ålter.
2.6
Jerk Limited Time-Delay Filters for Multi-Mode Systems
The proposed approach can be used for the control of systems with multiple un-
derdamped modes. A generic formulation is developed below. The number of pa-
rameters to be optimized for can be reduced for undamped systems by exploiting
the symmetric characteristics of the time-delay Ô¨Ålter. The transfer function of the
time-delay Ô¨Ålter is
G s  J
s
N
‚àë
i 0
  1  i exp
  sTi
 (2.116)
¬© 2010 by Taylor and Francis Group, LLC

48
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
10
11
12
13
14
15
16
17
18
19
20
0
0.005
0.01
0.015
0.02
0.025
0.03
0.035
0.04
0.045
Jerk Limited Time‚àíDelay Filter
Robust Jerk Limited Time‚àíDelay Filter
Frequency
Residual Energy
Figure 2.21: Sensitivity Curve
where T0 = 0 and N is an odd number. The unknowns (Ti) have to satisfy the con-
straint equation
N
‚àë
i 1
  1  i 1Ti
  1
J
(2.117)
which satisÔ¨Åes the requirement that the Ô¨Ånal value of the output of the Ô¨Ålter when
it is subject to an unit step input is unity. To cancel the undamped or underdamped
poles at
sk
  œÉk
  jœâk for k = 1, 2, 3, ...
(2.118)
the following constraints have to be satisÔ¨Åed
N
‚àë
i 1
  1  i exp
  œÉkTi
 cos œâkTi

 0 for k = 1, 2, 3, ...
(2.119)
and
N
‚àë
i 1
  1  i exp
  œÉkTi
 sin  œâkTi
  0 for k = 1, 2, 3, ...
(2.120)
The optimal solution is one which satisÔ¨Åes all the constraints and minimizes TN.
To desensitize the Ô¨Ålter to errors in estimated damping or frequency, the following
constraint equations:
N
‚àë
i 1
  1  iTi exp  œÉkTi
 sin
 œâkTi
  0 for k = 1, 2, 3, ...
(2.121)
¬© 2010 by Taylor and Francis Group, LLC

Time-Delay Filter/Input Shaping
49
and
N
‚àë
i 1
  1  iTi exp  œÉkTi
 cosœâkTi
  0 for k = 1, 2, 3, ...
(2.122)
which are the derivatives of Equations (2.119) and (2.120) with respect to œÉk or œâk,
are added to the optimization problem. It can be seen that desensitizing the Ô¨Ålter with
respect to damping simultaneously desensitizes the Ô¨Ålter to the frequency as well.
The design of jerk limited time-delay Ô¨Ålters for user speciÔ¨Åed time-delays follows
the process proposed described in Section 2.3.2. It is clear that additional number of
delays are required since the delay times are no longer variables in the optimization
process.
To illustrate the design of multi-mode jerk limited input shapers, consider the
system
y  s u s 
225
s4
 34s2
 225
(2.123)
which is characterized by two modes with frequencies 3 and 5. For a jerk constraint
of 3, the jerk limited input shaper is designed. The dashed line and the solid line in
Figure 2.22 illustrates the response of the system to a step input and the shaped input
respectively. It is clear that the residual vibration of the two modes is eliminated after
shaping the input.
0
0.5
1
1.5
2
2.5
3
3.5
4
4.5
5
‚àí1
0
1
2
3
0
0.5
1
1.5
2
2.5
3
3.5
4
4.5
5
0
0.2
0.4
0.6
0.8
1
1.2
1.4
Time (sec)
Time (sec)
Output
Shaped Input
Figure 2.22: Shaped Input and Comparison of System Response
¬© 2010 by Taylor and Francis Group, LLC

50
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
2.7
Filtered Input Shapers
The technique presented in this section, where an integrator is concatenated to a
time-delay Ô¨Ålter to satisfy the constraint of jerk limited Ô¨Ålter design can be extended
by cascading other transfer functions such as that of Ô¨Årst-order systems, harmonic
systems, and so forth.
2.7.1
First-Order Filtered Input Shaper
Instead of using an integrator in conjunction with a time-delay Ô¨Ålter to account for
the limit on the permitted jerk, one can concatenate a Ô¨Årst-order Ô¨Ålter to a time-delay
Ô¨Ålter to generate a smooth input which can then be used to drive a time-delay Ô¨Ålter
designed to cancel the underdamped poles of the system of interest. Figure 2.23
illustrates the proposed Ô¨Ålter structure where T is a user selected time-delay which
in the case of a discrete time implementation, can be an integral multiple of the
sampling interval.
r
 s
 
  eaT
1 eaT
 1
1 eaT e
 sT
 
a
s a
  A0
 A1e
 sT1
 u s
Figure 2.23: First-Order Filtered Time-Delay Filter
2.7.2
Sinusoid Filtered Input Shaper
Filtering with a transfer function of a scaled sinusoid results in an input which
emulates a step input but with zero initial and Ô¨Ånal slopes. The scaling of the sinusoid
transfer function is to satisfy the requirement that the DC gain of the transfer function
is unity. The sinusoid Ô¨Åltered time-delay Ô¨Ålter is illustrated in Figure 2.24, which can
be rewritten as shown in Figure 2.25.
r
 s
  A0
 A1e
 sT1
 A2e
 sT2
 A3e
 sT3
 
œâ2
s2
 œâ2
 u s
Figure 2.24: Sinusoid Filtered Time-Delay Filter
Here the Ô¨Årst time-delay Ô¨Ålter cancels the oscillatory response of the scaled har-
monic oscillator. This truncated harmonic response is then input to the second time-
delay Ô¨Ålter which is designed to cancel the oscillatory mode of the system. Fig-
ure 2.26 illustrates the control proÔ¨Åle. The beneÔ¨Åt of this approach can be gauged
¬© 2010 by Taylor and Francis Group, LLC

Time-Delay Filter/Input Shaping
51
r
 s
  0  5
 0  5e
 sœÄ
 œâ
 
œâ2
s2
 œâ2
  A0
 A1e
 sT1
 u s
Figure 2.25: Sinusoid Filtered Time-Delay Filter
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0
0.2
0.4
0.6
0.8
1
1.2
1.4
0.31
0.32
0.33
0.34
0.35
0.4
0 5
0.6
0.7
0.8
0.9
1
1.1
Time (sec)
Control Input
Figure 2.26: Sinusoid Filtered, Input Shaped Control Input
from the frequency response plots of the sinusoid Ô¨Åltered time-delay Ô¨Ålter. Fig-
ure 2.27 illustrates the frequency response plots of the time-delay Ô¨Ålter, jerk limited
time-delay Ô¨Ålter and a sinusoid Ô¨Åltered time-delay Ô¨Ålter. The sinusoid Ô¨Åltered time-
delay Ô¨Ålter has been designed such that the maximum jerk of the control proÔ¨Åle is
equal to the maximum permitted jerk. It can easily be seen that the magnitude plots
of the sinusoid Ô¨Åltered time-delay Ô¨Ålters rolls off much more rapidly compared to
the time-delay Ô¨Ålter and the jerk limited time-delay Ô¨Ålter. Thus, this input will not
signiÔ¨Åcantly excite the unmodeled dynamics.
2.7.3
Jerk Limits
Consider a part of the sinusoid Ô¨Åltered time-delay Ô¨Ålter illustrated in Figure 2.28.
The output p of the time-delay Ô¨Ålter subject to a unit step input is
p  t
  sin2
 œâ
 2t
  sin2
œâ
 2 t
 œÄ
 œâ
  H
 t
  œÄ
œâ
 (2.124)
and the rate of change of p which is the jerk is
Àôp  t
  œâ
2 sin  œât
  œâ
2 sin  œâ
 t
 œÄ
 œâ
  H
 t
  œÄ
œâ
 (2.125)
which implies that the maximum magnitude of the jerk is œâ
2 and occurs at time
t
 œÄ
2œâ . This is the upper bound for the jerk. It can be seen that the jerk is zero
at the start and the end of the maneuver which results in a very practical control
proÔ¨Åle. When the signal p is passed through the second time-delay Ô¨Ålter, based on
the damping present in the oscillatory pole to be canceled, the jerk can lie in the limit
¬© 2010 by Taylor and Francis Group, LLC

52
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
10
1
10
2
10
3
10
‚àí7
10
‚àí6
10
‚àí5
10
‚àí
10
‚àí3
10
‚àí2
10
‚àí1
10
0
Time Delay Filter
Jerk Limited Time Delay Filter
Sine Filtered Time Delay Filter
Frequency
Magnitude
Figure 2.27: Frequency Response
 0  5
 0  5e
 sœÄ
 œâ
 œâ2
s2
 œâ2
 R  s P s Figure 2.28: Time-Delay Filter
œâ
4
  Maximum Jerk
  œâ
2
 (2.126)
If the pole to be canceled is undamped the maximum jerk is œâ
4 since A0 and A1 are
equal to 0.5. When the poles to be canceled contain damping, A0 is greater than 0.5
and A1 is less than 0.5, resulting in the maximum jerk lying in the range speciÔ¨Åed by
Equation (2.126).
This constraint is valid when the time-delay Ô¨Ålter is designed to cancel the un-
wanted underdamped pole. However, if the underdamped pole has to be controlled
using a robust time-delay Ô¨Ålter, the limits on the jerk changes, since the robust time-
delay Ô¨Ålter uses smaller gains.
Example 2.3:
To illustrate the beneÔ¨Åt of using the Ô¨Åltered input shaper, consider a two-mass
system shown in Figure 2.29, which includes the dominant mass m which is driven by
a force transmitted through the spring of stiffness k. A secondary mass ms connected
¬© 2010 by Taylor and Francis Group, LLC

Time-Delay Filter/Input Shaping
53
by a stiff spring is driven by the motion of mass m. The Euler-Lagrange equations of
motion are:
Figure 2.29: Parasitic Vibratory System
 m
 ms
¬®x
 ms
 ¬®x
  Àôy
  kx
 kr
(2.127)
ms
 ¬®x
  Àôy
  ksy
 0
(2.128)
where x is the displacement of the mass m in an inertial frame, y is the differential
displacement of mass ms with respect to mass m and r is the reference displace-
ment imposed on the system. Figure 2.30 illustrates the displacement of the two
masses. The parasitic response of mass ms is of high frequency and can be out-
side the bandwidth of the actuator. It is desirable to minimize the excitation of the
parasitic oscillations by shaping the reference input to the system.
Assuming m = 1, ms = 0.1, k = 1, ks = 50, the natural frequencies of the system
are œâi = 0.95 and 23.45 rad/sec. Designing a Ô¨Ånite jerk Input Shaper, a Ô¨Årst-order
Ô¨Åltered Input Shaper and a sinusoid Ô¨Åltered Input Shaper with a jerk limit of 4, we
can compare the performance of these jerk limited input shapers to the standard PPD
time-delay Ô¨Ålter (ZV Input Shaper). Figure 2.31 illustrates the shaped reference
proÔ¨Åles derived based on the four Ô¨Åltering approaches listed above. Figure 2.32
presents the corresponding displacement of the main mass m and the parasitic mass
ms. The solid line, the dotted line, the dashed lines, and the dash-dot lines correspond
to the input shaper, jerk limited input shaper, the Ô¨Årst-order Ô¨Åltered input shaper, and
the sinusoid Ô¨Åltered input shaper, respectively. It is clear that the parasitic oscillations
of the sinusoid Ô¨Åltered input shaper are signiÔ¨Åcantly smaller than the rest of the
shapers. The cost trade-off with reference to maneuver time is small as can be seen
in the evolution of the position of mass m.
¬© 2010 by Taylor and Francis Group, LLC

54
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
0
2
4
6
8
10
0
0.5
1
1.5
2
0
2
4
6
8
10
‚àí4
‚àí2
0
2
4
x 10
‚àí3
Displacement (Unmodeled Mode)
Time
Time
Displacement
Figure 2.30: Step Response
2.8
Discrete-Time Time-Delay Filters
The pole-zero cancelation concept for the design of pre-Ô¨Ålters can be extended to
discrete-time systems where the pre-Ô¨Ålter is parameterized as a FIR (Ô¨Ånite impulse
response) Ô¨Ålter. Consider a general FIR Ô¨Ålter of the form
H
 z 
k
‚àë
i 0
ciz
 i
(2.129)
which has k poles at the origin of the z-plane which implies stability. This Ô¨Ålter is
also referred to as a moving average Ô¨Ålter. The transfer function H
 z  has k zeros
whose locations are a function of ci. Selecting the cis so as to cancel the poles of
the system to be controlled results in the counterpart of the time-delay Ô¨Ålter in the
discrete-time domain.
Figure 2.33 illustrates the implementation of a time-delay Ô¨Ålter in the discrete-
time domain for a nth order system. The n poles of the system which are the roots
of the polynomial ‚àën
i 0 aiz
 i are represented as zj
  œÉj
 œâj
 1. Note, some poles
of the system might be real. The optimization problem for the determination of the
parameters (ci) of the FIR Ô¨Ålter can be posed as:
¬© 2010 by Taylor and Francis Group, LLC

Time-Delay Filter/Input Shaping
55
0
1
2
3
4
5
6
7
8
0
0.2
0.4
0.6
0.8
1
1.2
1.4
Control
Input Shaper
Jerk Limited Input Shaper
Sinusoid Filtered Input Shaper
First‚àíOrder Filtered Input Shaper
Time
Figure 2.31: Shaped Reference ProÔ¨Åles
min
ci
J
 k
‚àë
i 0
 i
 1  Œõ
 ci
 subject to
R
 k
‚àë
i 0
ci
 œÉj
 œâj
  1  i
   0
 j
  1  2     n
I
 k
‚àë
i 0
ci
 œÉj
 œâj
  1  i
   0
 j
  1  2     n
k
‚àë
i 0
ci
  1
0
  ci
  1
 i
  1  2     k
where R and I correspond to the real and imaginary parts of the argument respec-
tively. The cost function is the weighted
 1 norm of the coefÔ¨Åcients. Minimizing the
¬© 2010 by Taylor and Francis Group, LLC

56
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
0
1
2
3
4
5
6
7
8
0
0.5
1
1.5
0
1
2
3
4
5
6
7
8
‚àí2
‚àí1
0
1
2
x 10
‚àí3
Displacement (Unmodelled Mode))
Input Shaper
Jerk Limited Input Shaper
Sinusoid Filtered Input Shaper
First‚àíOrder Filtered Input Shaper
Time
Time
Displacement
Figure 2.32: System Response
 k
‚àë
i 0
ciz
 i
 m
‚àë
i 0
biz
 i
n
‚àë
i 0
aiz
 i
 U
  z U
z Y
z Step
Time-Delay Filter
Plant
Figure 2.33: Discrete-Time Multi Mode System
 0 norm results in a sparse solution, i.e., the number of non-zero elements is mini-
mized. Since minimizing the
 0 norm is difÔ¨Åcult, we pose the problem as minimiz-
ing the weighted
 1 norm which can be posed as a linear programming problem and
tends to a sparse solution. The weighting function
   Œõ where Œõ
 1, is to increase
the penalty nonlinearly with time so as to require the maneuver to be completed in
minimal time.
¬© 2010 by Taylor and Francis Group, LLC

Time-Delay Filter/Input Shaping
57
Œò
Œ¶
Figure 2.34: Flexible Transmission
Example 2.4:
Landau et al. [16] proposed a Ô¨Çexible transmission system as a benchmark prob-
lem for the design and evaluation of digital controllers. The benchmark problem
consists of three pulleys connected by Ô¨Çexible belts and is modeled as a system with
two very lightly damped modes. The input to the system is the position of the Ô¨Årst
pulley and the output is the rotation of the third pulley shown in Figure 2.34. The
discrete time model for the nominal model is:
Œ¶ z Œò z  Gz 
z
 2
 0  10276z
 1
 0  18123z
 2
 1
 1  99185z
 1
 2  20265z
 2
 1  84083z
 3
 0  89413z
 4
(2.131)
with a sampling frequency of 20 Hz. In Figure 2.36, the dashed line illustrates the
undamped step response of the system. Solving the
 1 norm minimization prob-
lem subject to the constraint that the FIR Ô¨Ålter cancel the underdamped poles of the
system located at:
z
  0  0853
 0  9552i and 0  9106
 0  3782i
(2.132)
with a Œõ
  3, results in the FIR Ô¨Ålter
H
 z  0  4715
 0  0052z
 2
 0  0680z
 6
 0  2571z
 7
 0  1982z
 10
 (2.133)
Figure 2.35 illustrates the shaped reference input and the solid line in Figure 2.36 is
the corresponding evolution of the output, which illustrates the nonoscillatory char-
acteristic of the system response.
As in the design of time-delay Ô¨Ålters for continuous-time systems, robustness to
errors in estimated location of the poles of the system can be achieved by locating
multiple zeros of the time-delay Ô¨Ålter at the estimated location of the poles of the
¬© 2010 by Taylor and Francis Group, LLC

58
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
0
0.5
1
1.5
2
2.5
3
3.5
0
0.2
0.4
0.6
0.8
1
Time
Shaped Command
Figure 2.35: Shaped Reference ProÔ¨Åles
0
0.5
1
1.5
2
2.5
3
3.5
0
0.5
1
1.5
2
2.5
Time
Output
Figure 2.36: System Response
system. This constraint can be stated as:
dH
 z dz

k
‚àë
i 0
  i ciz
  i 1    0
(2.134)
for all zs corresponding to the uncertain poles.
Example 2.5: Landau et al. [16] present models of the Ô¨Çexible transmission system
under no-load and full-load conditions, which are represented as:
Œ¶ z Œò  z NL
 G z

z
 2
 0  2826z
 1
 0  5066z
 2
 1
 1  4183z
 1
 1  5893z
 2
 1  3160z
 3
 0  8864z
 4
(2.135)
¬© 2010 by Taylor and Francis Group, LLC

Time-Delay Filter/Input Shaping
59
and
Œ¶ z Œò z  FL
 Gz 
z
 2
 0  0640z
 1
 0  1040z
 2
 1
 2  0967z
 1
 2  3196z
 2
 1  9335z
 3
 0  8712z
 4
(2.136)
The robust time-delay Ô¨Ålter is determined by solving the problem:
min
ci
J
 20
‚àë
i 0
 i
 1  3
 ci
 subject to
20
‚àë
i 0
ci
 0  0853
 0  9552
 1  i
  0
20
‚àë
i 0
ci
 0  9106
 0  3782
 1  i
  0
20
‚àë
i 0
 ici
 0  0853
 0  9552
 1  i 1
  0
20
‚àë
i 0
 ici
 0  9106
 0  3782
 1  i 1
  0
20
‚àë
i 0
ci
  1
0
  ci
  1
 i
  1  2     k
which includes 9 equality constraints and 21 unknown parameters to be solved for.
The robust time-delay Ô¨Ålter is designed for the nominal model of the system and
the performance of the nonrobust and robust controllers are tested on the no-load and
full-load cases. Figures 2.37 and 2.38 illustrate the response of the no-load and full-
load cases, respectively. The solid and dashed lines corresponds to the nonrobust and
robust cases, respectively. Clearly, the robust-Ô¨Ålter outperforms the nonrobust Ô¨Ålter.
The solid line in Figure 2.39 is the robust shaped reference proÔ¨Åle and illustrates that
the maneuver time increases compared to the nonrobust control proÔ¨Åle shown by the
dashed line.
2.9
Summary
A simple technique that is used to design pre-Ô¨Ålters to attenuate residual vibra-
tion of underdamped systems by canceling the corresponding poles of the system
has been presented. The single time-delay pre-Ô¨Ålter is identical to the zero vibration
Input Shaper and the Posicast controller. Cascading two single time-delay Ô¨Ålters in
¬© 2010 by Taylor and Francis Group, LLC

60
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
0
0.5
1
1.5
2
2.5
3
3.5
0
0.2
0.4
0.6
0.8
1
1.2
1.4
1.6
1.8
Time
Output
Figure 2.37: System Response (No Load)
0
0.5
1
1.5
2
2.5
3
3.5
0
0.2
0.4
0.6
0.8
1
1.2
1.4
Time
Output
Figure 2.38: System Response (Full Load)
series results in the zero vibration derivative Input Shaper which provide robustness
to uncertainties in damping ratio and natural frequency simultaneously. The tech-
nique to design time-delay Ô¨Ålters is extended to pre-Ô¨Ålters where the delay times are
speciÔ¨Åed by the user. This is compatible with implementing it using a discrete time
control system. The time-delay Ô¨Åltering techniques can also be used to minimize
residual vibration of multi-mode systems.
There are numerous applications where the goal of the control system is to perform
point-to-point maneuvers. The reference input to such systems is a step input. Filter-
ing the step input through a time-delay Ô¨Ålter results in a staircase form of a reference
input which minimizes the magnitude of residual energy compared to the applica-
tion of the step input to the nominal system. The staircase input still might excite
higher modes and unmodeled dynamics and furthermore, actuators cannot track step
¬© 2010 by Taylor and Francis Group, LLC

Time-Delay Filter/Input Shaping
61
0
0.5
1
1.5
2
2.5
3
3.5
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
1.1
1.2
Time
Shaped Command
Figure 2.39: Shaped Reference ProÔ¨Åles
inputs. The section on jerk limited time-delay Ô¨Ålters provides a technique to account
for the jerk limits on the actuator and also provide a mechanism to generate a refer-
ence proÔ¨Åle which reduces the excitation of the higher frequency unmodeled modes
as shown by the frequency response plots of the jerk limited time-delay Ô¨Åltered sig-
nals. The jerk limited time-delay Ô¨Ålter is generated by including an integrator into
the pre-Ô¨Ålter. This motivated the design of Ô¨Åltered Input Shapers where Ô¨Årst- and
higher-order Ô¨Ålters are integrated with the standard time-delay Ô¨Ålter and the result-
ing reference proÔ¨Åles are smooth, which further reduces the excitation of unmodeled
dynamics.
Although the development and illustration of the time-delay Ô¨Åltering technique
has been illustrated for point-to-point control, the pre-Ô¨Åltering of any reference in-
put results in nonoscillatory tracking of the reference input. For instance, requiring
the glass plate of a Ô¨Çat-bed scanner to follow a trapezoidal velocity proÔ¨Åle can be
achieved by Ô¨Åltering the reference velocity proÔ¨Åle through a time-delay Ô¨Ålter. Simi-
larly, inserting a time-delay Ô¨Ålter between a drive pendant of a gantry crane and the
actuators can reduce the pendulation of the crane to arbitrary inputs.
Exercises
2.1
Design a time-delay Ô¨Ålter for a system with a transfer function
Y
 s
R  s

5
s
 5
such that the system output y t
 reaches the Ô¨Ånal value in Ô¨Ånite time when
the reference input is a unit step function.
¬© 2010 by Taylor and Francis Group, LLC

62
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
2.2
Derive a closed form expression for the parameters of a time-delay Ô¨Ålter for
a system with a transfer function.
Y
 s
R  s

aœâ2
 s
a s2
 2Œ∂œâs
 œâ2
 The form of the time-delay Ô¨Ålter is:
G s
 A0
 A1e
 sT1
 e
 2sT1
(2.138)
2.3
Derive a closed-form expression for the parameters of a time-delay Ô¨Ålter to
cancel two undamped pair of poles. The form of the time-delay Ô¨Ålter is:
G s
 A0
 A1e
 sT1
 e
 sT2
and the system model is:
Y
 s
R  s

36
 s2
 4 s2
 9 2.4
Figure 2.40 schematically illustrates the Furuta pendulum which can be used
to represent a tower crane. Assume a PD control for the actuator which
drives the horizontal beam and design an input shaper to bring the pendulum
to rest at the end of the maneuver.
\
I
5
/
0
Figure 2.40: Furuta Pendulum
¬© 2010 by Taylor and Francis Group, LLC

Time-Delay Filter/Input Shaping
63
The kinetic energy T and potential energy V for the pendulum is:
T
  1
2JL Àôœà2
  1
2JL
  ÀôœÜ sin œà
  2
 1
2JR ÀôœÜ2
  1
2M Àôrp2
V
  mgL  1
 cos
 œà
  where rp is:
rp
  Rcos
 œÜ
 Lsin œà
 sin œÜ
   ÀÜi
  Rsin  œÜ
  Lsin œà
 cosœÜ
   ÀÜj
 Lcos œà
 ÀÜk
where ÀÜi, ÀÜj, and ÀÜk are unit vectors in the x, y, and z directions, respectively.
Assume M = 0.01 kg, R = 0.2 m, L = 0.5 m, JL = 0.05 kg m2, and JR = 0.001
kg m2.
2.5
Design a time-delay Ô¨Ålter for eliminating residual vibrations of the system
shown in Figure 2.41 for a rest-to-rest maneuver. The initial displacement of
the mass and inertia are zero and the Ô¨Ånal rotation of the inertia is required
to be 1 radian.
M
J
K
K
u(t)
Figure 2.41: Two-Degree of Freedom System
The equations of motion of the system are:
M ¬®x
 Kx
 K
 x
 RŒ∏

 0
J ¬®Œ∏
 KR  x
 RŒ∏
  u
where M is the mass of the block, J is the inertia of the pulley whose radius
is R. u t
  is the torque input to the pulley. Assume M
  1, J
  1, R
  1, and
K
  1.
2.6
The optical pick-up of a compact disc (CD) player consists of a sledge for
large displacements and a radial servo which is limited to move over a few
hundred tracks. The optical pickup is a two-degree of freedom system with
one degree catering to the motion of an objective lens for focusing and a
second degree for Ô¨Åne radial positioning. Vidal et al. [17] model the pick-
up as a two mass-spring system. Figure 2.42 illustrates a schematic of the
pickup system where mass m1 corresponds to the objective and m2 is the
mass of the objective suspension links. The model relating the displacement
¬© 2010 by Taylor and Francis Group, LLC

64
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
of the objective to voltage input to the pickup actuator is:
X
 s U
s 
7 054e
 006s2
 0 003088s
 68 5
3 148e
 007s4
 0 0001402s3
 3 217s2
 16 83s
 1 145e005
Assume 16,000 tracks per inch (TPI) of track density, the intertrack distance
is 1.5875e-7 meters. To move the objective by 100 tracks requires a step
input reference signal of magnitude 0.0265 volts. Design a time-delay Ô¨Ålter
to complete the seek motion of 100 tracks with no residual vibrations.
Figure 2.42: CD Pickup (Reprinted with permission [18].)
2.7
To illustrate the design of time-delay Ô¨Ålters for a multi-mode system, consider
the control of a Ô¨Çexible belt-drive system (Figure 2.43). The system model is
J1 ¬®Œ∏
 c ÀôŒ∏
 2kR2
 Œ∏
 œÜ
  œÑ
J2 ¬®œÜ
 c ÀôœÜ
 2kR2
 Œ∏
 œÜ
  0
where J1 and J2 corresponds to the inertia of the motor and load, respec-
tively. The belt stiffness is k and the radius of the pulleys are R. A propor-
tional plus derivative controller
œÑ
  K1
 Œ∏
 r
  K2 ÀôŒ∏
where r is the reference input, is guaranteed to be stable for all gains K1 and
K2 greater than zero. Assuming the model and controller parameters to be:
J1
  1  J2
  2  c
  0 1  R
  1  K
  2  K1
  2  K2
  1 the closed-loop transfer function is:
Œ¶ s R s 
4
s4
 1 15s3
 8 055s2
 2 5s
 4
¬© 2010 by Taylor and Francis Group, LLC

Time-Delay Filter/Input Shaping
65
and the closed-loop poles are located at:
s
  0 1391
 0 7290i   and
 0 4359
 2 6593i  Œ∏
œÑ
œÜ
k
J
J1
2
R
Figure 2.43: Flexible Transmission
Design a time-delay Ô¨Ålter to move the inertia from an initial position of rest
and bring it to rest with a Ô¨Ånal position of one radian. Illustrate the improve-
ment in the robustness to uncertainties in belt stiffness k, by using a robust
time-delay Ô¨Ålter.
References
[1] D. de Roover, F. B. Sperling, and O. H. Bosgra. Point-to-point control of a
mimo servomechanism. In ACC, Philadelphia, PA, 1998.
[2] Y. Mizoshita, S. Hasegawa, and K. Takaishi. Vibration minimized access con-
trol for disk drives. IEEE Transactions on Magnetics., 32(3):1793‚Äì1798,1996.
[3] D. B. Rathbun, M. C. Berg, and K. W. BufÔ¨Ånton. Pulse width control for
precise positioning of structurally Ô¨Çexible systems subject to stiction and
Coulomb friction.
ASME J. of Dyn. Systems, Measurements, and Cont.,
126(1):131‚Äì138, 2004.
[4] M. J. Doherty and R. H. Tolson. Input shaping to reduce solar array stuc-
tural vibrations.
Joint Institute for Advancement of Flight Sciences report
NASA/CR-1998-208698, NASA Langley Research Center, 1998.
[5] C. J. Swigert. Shaped torque techniques. J. of Guid., Cont. and Dyn., 3(5):460‚Äì
467, 1979.
[6] J. L. Junkins and J. D. Turner. Optimal Spacecraft Rotational Maneuvers.
Amsterdam: Elsevier, 1986.
[7] T. Singh and W. Singhose. Tutorial on input shaping/time delay control of
maneuvering Ô¨Çexible structures. In ACC, Anchorage, Alaska, May 2002.
¬© 2010 by Taylor and Francis Group, LLC

66
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
[8] S. L. Scrivener and R. C. Thompson. Shaped input for multimode system. J.
of Guid., Cont. and Dyn., 17(2):225‚Äì233, 1994.
[9] G. H. Tallman and O.J.M. Smith. Analog study of dead-beat posicast control.
45:14‚Äì21, September 1958.
[10] T. Singh and S. R. Vadali. Robust time delay control. ASME J. of Dyn. Systems,
Measurements, and Cont., 115(2):303‚Äì306, 1993.
[11] N. Singer and W. P. Seering. Pre-shaping command inputs to reduce system
vibration. ASME J. of Dyn. Systems, Measurements, and Cont., 112(1):76‚Äì82,
1990.
[12] M. Muenchhof and T. Singh. Jerk limited time optimal control of Ô¨Çexible
structures. ASME J. of Dyn. Systems, Measurements, and Cont., 125(1):139‚Äì
142, 2003.
[13] M. Muenchhof and T. Singh. Desensitized jerk limited-time optimal control of
multi-input systems. J. of Guid., Cont. and Dyn., 25(3):474‚Äì481, 2002.
[14] T. Singh. Jerk limited input shapers. ASME Journal of Dynamic Systems,
Measurement and Control, 126(1):215‚Äì219, March 2004.
[15] T. Singh. Minimax design of robust controllers for Ô¨Çexible systems. J. of
Guid., Cont. and Dyn., 25(5):868‚Äì875, 2002.
[16] I. D. Landau, D. Rey, A. Karimi, A. Voda, and A. Franco. A Ô¨Çexible trans-
mission system as a benchmark for robust digital control. European Journal
of Control, 1:77‚Äì96, 1995.
[17] W. Vidal, J. Stoustrup, P. Andersen, T. S. Pedersen, and H. F. Mikkelsen. Para-
metric uncertainty with perturbations restricted to be real on 12 CD mecha-
nisms. In American Control Conference, Denver, CO, 2003.
[18] E. V. Sanchez. Robust and Fault Tolerant Control of CD-Players. PhD thesis,
Aalborg University, Aalborg, Denmark, 2003.
¬© 2010 by Taylor and Francis Group, LLC

3
Optimal Control
Success is going from failure to failure without a loss of enthusiasm.
Winston Churchill (1874‚Äì1965); Nobel Laureate, writer, painter,
soldier, journalist, and politician
C
LASSICAL control refers to techniques that include Bode diagrams, Nyquist
plots, Nichols charts, and so forth, used to design controllers based on measures
such as gain and phase margins and bandwidth. Following the development of the
root-locus technique by Evans after World War II, time-domain approaches which
use measures such as percent overshoot, rise, settling, and peak time were used to
design controllers. The post‚ÄìWorld War II period led to numerous breakthroughs
in controller design, which have been labeled modern control. Contributions by
Bellman, LaSalle, Pontryagin, Kalman, Bryson, and others laid the foundation for
what is currently referred to as optimal control. Optimal control has been extensively
used in aerospace, electrical, automotive and other applications. Recently, problems
of precision control of systems characterized by low frequency lightly damped modes
have been formulated as optimal control problems.
Chapter 2 presented a simple technique to shape the reference input to a stable or
marginally stable system, which minimizes the excitation of the underdamped modes
about the desired reference trajectory. The technique was illustrated on rest-to-rest
maneuvers only. The time-delay Ô¨Ålter was designed so as to cancel the underdamped
poles of the system which resulted in rest-to-rest motion with no residual vibrations.
To address the problem of uncertainties in estimated model parameters, the time-
delay Ô¨Ålter was required to place multiple sets of zeros at the nominal location of
the uncertain underdamped poles, which resulted in improved performance in the
proximity of the nominal model. The time-delay Ô¨Ålter design was not posed as an
optimal control problem, but can be designed by posing an appropriate optimal con-
trol problem. This chapter will introduce the basic theory of optimal control and well
known controllers such as linear quadratic regulator (LQR), and frequency-shaped
LQR will be used to design optimal controllers for benchmark spring-mass systems.
67
¬© 2010 by Taylor and Francis Group, LLC

68
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
3.1
Calculus of Variations
Optimal control theory is founded on the fundamentals of calculus of variations
whose roots can be traced to the Brachistochrone problem posed by Bernouilli in
1696 CE. The pioneering work of Euler (1741) which provides a geometrical ap-
proach to interpret the variational problem provided the seed for the development
of what is now referred to as calculus of variations. In 1755, 19-year-old Lagrange
wrote Euler a letter where he regenerated Euler‚Äôs results using an elegant method of
variations, which Euler embraced and called calculus of variations.
Calculus of variations was designed to extend results from the differential calculus,
notably necessary and sufÔ¨Åcient conditions for extreme values of ordinary functions
over Ô¨Ånite-dimensional vector spaces, to extreme values of functions of functions,
or functionals, over inÔ¨Ånite-dimensional function spaces. We begin by deriving the
Euler-Lagrange equations for a Ô¨Åxed time, Ô¨Åxed boundary conditions problem. This
is followed by the development of the constraints for the optimization of a functional
subject to differential equation constraints. Finally, the Hamiltonian formulation,
which results in the canonical representation of the necessary conditions of optimal-
ity is derived.
Consider the problem where it is desired to solve for x  t
  which minimizes the
cost function
J
 x t
  t
 
  tf
t0
œÜ
 x t
   Àôx
 t
  t
 dt
 (3.1)
J
 x t
  t
  is a functional, that is a mapping from a function space into a scalar.
The function space (in this case of continuously differentiable functions) is inÔ¨Ånite-
dimensional and the functional J
 x t
  t
  maps it to a real scalar space. It is assumed
that œÜ and x  t
  are continuously differentiable with respect to their arguments up to
order 2, i.e., they are C2. t0 and tf represent the initial and Ô¨Ånal times, respectively,
and x  t0
  and x  tf
  are assumed to be Ô¨Åxed. x  t
  represents the optimal and unknown
path which needs to be determined.
The increment of the functional J is deÔ¨Åned as
ŒîJ
  J
 x t
 Œ¥xt
  t
  J
xt
  t
 (3.2)
where Œ¥x t
  is called the variation of the function x t
  as shown in Figure 3.1. Since
x  t0
  and x  tf
  are prescribed, Œ¥x t0
  and Œ¥x tf
  are zero. The variation is assumed
to be smooth and of class C2. The increment can therefore be represented as
ŒîJ
   tf
t0
œÜ
 x t
 Œ¥xt
   Àôx
 t
 Œ¥ Àôx
 t
  t
 dt
   tf
t0
œÜ
 x t
   Àôx
 t
  t
 dt
 (3.3)
Just as in ordinary calculus, where the Ô¨Årst differential is deÔ¨Åned as the linear linear
part of the increment in a function due to inÔ¨Ånitesimal changes in its argument, the
¬© 2010 by Taylor and Francis Group, LLC

Optimal Control
69
x(t)+
x(t)
ft
0
x
x(t)
t
x(t)
Œ¥
0t
fx
Figure 3.1: Optimal and Varied Path
Ô¨Årst variation likewise is deÔ¨Åned as the linear part of the increment ŒîJ and is repre-
sented as Œ¥J. Expanding Equation (3.3) using the Taylor series in Œ¥x t
 , Œ¥ Àôx  t
 , we
have
Œ¥J
   tf
t0
 ‚àÇœÜ
‚àÇx
T
Œ¥x t
  ‚àÇœÜ
‚àÇÀôx
T
Œ¥ Àôx  t
  dt
(3.4)
where
Œ¥ Àôx
 t
  d
dt Œ¥xt
  (3.5)
and ‚àÇœÜ
‚àÇx and ‚àÇœÜ
‚àÇx represent the gradient of œÜ with respect to x t
  and Àôx  t
 . Since Œ¥ Àôx
 t
 is dependent on Œ¥x t
 , we integrate the expression which is a function of Œ¥ Àôx
 t
  by
parts, to represent the Ô¨Årst variation in terms of the arbitrary variation Œ¥x t
 . The
Ô¨Årst variation can be written as
Œ¥J
  ‚àÇœÜ
‚àÇÀôx
T
Œ¥x t
      tf
t0
   tf
t0
 ‚àÇœÜ
‚àÇx
T
Œ¥x t
   d
dt
 ‚àÇœÜ
‚àÇÀôx
T
 Œ¥x t
  dt
(3.6)
Since x t0
  and x  tf
  are speciÔ¨Åed, their variations Œ¥x t0
  and Œ¥x tf
  are zero.
The Fundamental theorem of the calculus of variations which is a necessary con-
dition for optimality requires that the Ô¨Årst variation of J vanish for an optimum, for
all permissible arbitrary variations Œ¥x t
 . Thus, Equation (3.6) leads to the Euler-
Lagrange equation
¬© 2010 by Taylor and Francis Group, LLC

70
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
‚àÇœÜ
‚àÇx
  d
dt
 ‚àÇœÜ
‚àÇÀôx
   0
(3.7)
subject to the boundary conditions
x  t0
   x0 and x  tf
  xf
(3.8)
3.1.1
Beltrami Identity
Consider the total derivative of œÜ
 x t
   Àôx
 t
  t
  with respect to time
dœÜ
dt
  ‚àÇœÜ
‚àÇt
  ‚àÇœÜ
‚àÇx
T dx
dt
  ‚àÇœÜ
‚àÇÀôx
T d Àôx
dt
(3.9)
which can be rewritten as
‚àÇœÜ
‚àÇx
T dx
dt
  dœÜ
dt
  ‚àÇœÜ
‚àÇt
  ‚àÇœÜ
‚àÇÀôx
T d Àôx
dt
(3.10)
Multiply the Euler-Lagrange equation (3.7) with dx
dt to arrive at the equation
dx
dt
T ‚àÇœÜ
‚àÇx
  dx
dt
T d
dt
 ‚àÇœÜ
‚àÇÀôx
   0
(3.11)
Substituting Equation (3.10) into Equation (3.11), we have
dœÜ
dt
  ‚àÇœÜ
‚àÇt
  ‚àÇœÜ
‚àÇÀôx
T d Àôx
dt
  dx
dt
T d
dt
 ‚àÇœÜ
‚àÇÀôx
   0
(3.12)
which can be rewritten as
 ‚àÇœÜ
‚àÇt
  d
dt
 œÜ
  dx
dt
T ‚àÇœÜ
‚àÇÀôx
   0
(3.13)
If œÜ is not explicitly a function of time, i.e., ‚àÇœÜ
‚àÇt
  0, Equation (3.13) reduces to
œÜ
  dx
dt
T ‚àÇœÜ
‚àÇÀôx
  K
 (3.14)
where K is a constant of integration and is referred to as the Beltrami identity, which
can be exploited to solve a class of problems where the integrand of the cost function
is not explicitly a function of the independent variable such as the brachistochrone
problem.
Example 3.1:
The optimization problem which endeavors to Ô¨Ånd a curve which connects two
points in a gravity potential so as to minimize the time taken to move from one
point to the other under the inÔ¨Çuence of gravity is referred to as the brachistochrone
problem [1]. Figure 3.2 illustrates a generic shape connecting the origin to P.
¬© 2010 by Taylor and Francis Group, LLC

Optimal Control
71
mgy
v
P
ds
dy
dx
y(t)
x(t)
Figure 3.2: Particle Motion under Gravity
For a frictionless bead of mass m sliding on the curve under the inÔ¨Çuence of grav-
ity, conservation of energy can be exploited to relate the velocity of the bead to the
distance traveled in the direction of gravity y. Equating the kinetic energy to the
potential energy leads to the equation:
1
2mv2
  mgy
(3.15)
  v
  2gy
(3.16)
The time taken to move from the origin to the point P is given by the equation
T
   P
0
ds
v
(3.17)
Substituting the relationship
ds2
  dx2
 dy2
(3.18)
into Equation (3.17), we have
T
   P
0
 dx2
 dy2
 2gy
   P
0
 1
  Àôy2
 2gy
dx
(3.19)
¬© 2010 by Taylor and Francis Group, LLC

72
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
where Àôy
  dy
dx. Since the integrant is not an explicit function of x, the Beltrami identity
results in the equation
 1
  Àôy2
 2gy
  Àôy ‚àÇ
‚àÇÀôy
  1
  Àôy2
 2gy
   1
K
(3.20)
 1
 2gy
 1
  Àôy2
  1
K
(3.21)
  2gy 1
  Àôy2
   K2
 (3.22)
Using a parametric solution of the form
Àôy
  dy
dx
  cot
 œÉ
 (3.23)
and substituting into Equation (3.22), we have
y
 Œ∫2
1
  Àôy2
 Œ∫2
1
 cot
 œÉ
 2
  Œ∫2sin  œÉ
2
 1
2Œ∫2
 1
 cos
 2œÉ
   (3.24)
where Œ∫2 = K2
2g . Next, from the relationship
dx
  dy
Àôy
  2Œ∫2sin  œÉ
 cos œÉ
 cot
 œÉ
 dœÉ
 2Œ∫2 sin œÉ
 2 dœÉ
  Œ∫2
 1
 cos
 2œÉ
dœÉ (3.25)
we have
x
  Œ∫2
 œÉ
  1
2 sin  2œÉ
  C
(3.26)
Since y 0   = 0, we have from Equation (3.24), œÉ = 0, which when substituted into
Equation (3.26) results in the integration constant C = 0.
The range of the parametric variable œÉ and the constant K are determined as a
function of the desired end point of the bead. The optimal solution for three end
points are given in Table 3.1 and the optimal shapes of the curves are presented in
Figure 3.3.
End Point Coordinates
Œ∫
œÉ range
X = 1, Y = ‚Äì1
1.0704
0‚Äì1.2060
X = 2, Y = ‚Äì1
1.0171
0‚Äì1.7542
X = 3, Y = ‚Äì1
1.1133
0‚Äì2.0258
Table 3.1: Brachistochrone Solutions
¬© 2010 by Taylor and Francis Group, LLC

Optimal Control
73
0
0.5
1
1.5
2
2.5
3
‚àí1.4
‚àí1.2
‚àí1
‚àí0.8
‚àí0.6
‚àí0.4
‚àí0.2
0
X
Y
X = 1, Y = ‚àí1
X = 2, Y = ‚àí1
X = 3, Y = ‚àí1
Figure 3.3: Brachistochrone Solutions
Figure 3.3 illustrates the optimal shapes for three different end points. It can be
seen that for some end points, the mass has to move up toward the end of the maneu-
ver to complete it in minimum time.
The optimal shape which is a cycloid has another interesting property. Starting
from rest at any point on the curve, the time required to reach the lowest point is
the same. Hence, this curve is also called a tautochrone and was Ô¨Årst presented by
Huygens in 1657 CE [2].
3.1.2
Differential Equation Constraints
In this section, we develop the variational formulation for the optimization of a
functional with differential equation constraint. Consider the state-space model of a
nonlinear system
Àôx  t
  f
xt
  u t
  t
 (3.27)
where x t
  corresponds to the states (x t
   Rn) of the system and u  t
  the control
input (u  t
   Rm). It is the goal of the optimization algorithm to determine u  t
 ,
which minimizes the cost function
J
 Œ∏
 xf
 tf

 

Mayer problem
   tf
t0
œÜ
 x t
  u t
  t
 dt
 

Lagrange problem
(3.28)
given the boundary conditions
¬© 2010 by Taylor and Francis Group, LLC

74
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
x 0   x0
  and t0 speciÔ¨Åed (3.29)
Additional constraints at the terminal time of the form
Œ±
 xf
 tf
   0
(3.30)
which correspond to a q dimensional vector of algebraic constraints, need to be in-
cluded into the optimal control problem formulation. Cost function which include
a terminal cost and an integral cost are called the Bolza problems [3]. As shown in
Equation (3.28), cost functions which are functions of the terminal time and states
are referred to as Mayer problems [3] and those which penalize an integral of the
evolving states, control and time are referred to as Lagrange problems [3].
Introducing two Lagrange vectors Œª
 t
  and ŒΩ (not a function of time) of dimen-
sions n and q respectively, the augmented cost function can be represented as
Ja
 Œ∏
 xf
 tf

ŒΩTŒ±
 xf
 tf


  tf
t0
 œÜ
 x t
  u t
  t
 Œª T
t
  f
xt
  u t
  t
   Àôx
 t
 
 dt
(3.31)
The Ô¨Årst variation of the augmented cost Ja is
Œ¥Ja
  ‚àÇŒ∏
‚àÇxf
Œ¥xf
  ‚àÇŒ∏
‚àÇtf
Œ¥tf
 ŒΩT ‚àÇŒ±
‚àÇxf
Œ¥xf
 ŒΩT ‚àÇŒ±
‚àÇtf
Œ¥tf
   tf
 Œ¥tf
tf
 œÜ
 Œª T
t

f
  Àôx
 t
 
 dt

  tf
t0
  ‚àÇœÜ
‚àÇx
 Œª T ‚àÇf
‚àÇx

Œ¥x  ‚àÇœÜ
‚àÇu
 Œª T
 t
‚àÇf
‚àÇu

Œ¥u
 Œª T
 t
Œ¥ Àôx
 t
 
f
  Àôx
 TŒ¥Œª
 dt
(3.32)
If both tf and x tf
  are free, a relationship between them still exists as illustrated
in Figure 3.4 for a scalar case. Œ¥xf corresponds to the difference between the ordi-
nates at the end of the optimal and varied curves. A Ô¨Årst-order approximation of the
relationship can be represented as
Œ¥x tf
  Œ¥xf
  Àôx
 tf
 Œ¥tf
(3.33)
Further, the integral corresponding to the variation in the Ô¨Ånal time, can be ap-
proximated as
  tf
 Œ¥tf
tf
 œÜ
 Œª T
 t

 f
  Àôx
 t
 
 dt
  œÜ
Œª T
t
 f
 Àôx
 t
 
   t
 tf Œ¥tf
(3.34)
Substituting Equations (3.33) and (3.34) into Equation (3.32), and after integrating
the term Œª T
 t
 Œ¥ Àôx
 t
  by parts, Equation (3.32) can be rewritten as
¬© 2010 by Taylor and Francis Group, LLC

Optimal Control
75
t
x(t)
x0
x(t)
Œ¥
xf
t0
tf
tf
t +
f
Œ¥xf
Œ¥x(t )f
x(t)+Œ¥x(t)
Figure 3.4: Optimal and Varied Path
Œ¥Ja
  ‚àÇŒ∏
‚àÇxf
Œ¥xf
  ‚àÇŒ∏
‚àÇtf
Œ¥tf
 ŒΩT ‚àÇŒ±
‚àÇxf
Œ¥xf
 ŒΩT ‚àÇŒ±
‚àÇtf
Œ¥tf
  œÜ
 Œª T
t

 f
  Àôx
 t
 
   t
 tf Œ¥tf
 Œª T
t
 Œ¥xtf
 


Œ¥x tf
Œ¥xf
 x tf
 Œ¥tf
   tf
t0
  ‚àÇœÜ
‚àÇx
 Œª T ‚àÇf
‚àÇx
  ÀôŒª T
 Œ¥x
 ‚àÇœÜ
‚àÇu
 Œª T
 t
‚àÇf
‚àÇu
 Œ¥u

 f
  Àôx
 TŒ¥Œª
 dt
(3.35)
Collecting terms, Equation (3.35) can be written as
Œ¥Ja
   ‚àÇŒ∏
‚àÇxf
 ŒΩT ‚àÇŒ±
‚àÇxf
 Œª T

Œ¥xf
   ‚àÇŒ∏
‚àÇtf
 ŒΩT ‚àÇŒ±
‚àÇtf
 œÜ
tf

 Œª T
tf
f

Œ¥tf
  Œª T Àôx t
 Œ¥tf
  Œª T Àôx  t
 Œ¥tf

  tf
t0
  ‚àÇœÜ
‚àÇx
 Œª T ‚àÇf
‚àÇx
  ÀôŒª T
 Œ¥x
 ‚àÇœÜ
‚àÇu
 Œª T
 t
‚àÇf
‚àÇu
 Œ¥u

 f
  Àôx
 TŒ¥Œª
 dt
(3.36)
From the Fundamental theorem of the calculus of variations, we arrive at the neces-
sary conditions for optimality
¬© 2010 by Taylor and Francis Group, LLC

76
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
 ÀôŒª T
 ‚àÇœÜ
‚àÇx
 Œª T ‚àÇf
‚àÇx
(3.37)
Àôx
 t
 f
xt
  u t
  t
 (3.38)
0
 ‚àÇœÜ
‚àÇu
 Œª T
t
‚àÇf
‚àÇu
(3.39)
0
   ‚àÇŒ∏
‚àÇxf
 ŒΩT ‚àÇŒ±
‚àÇxf
 Œª T





tf
Œ¥xf
(3.40)
0
   ‚àÇŒ∏
‚àÇtf
 ŒΩT ‚àÇŒ±
‚àÇtf
 œÜ
 Œª T
t
f





tf
Œ¥tf
(3.41)
where Equations (3.37), (3.38), and (3.39) are the Euler-Lagrange equations and
Equations (3.40) and (3.41) are known as the transversality conditions.
Example 3.2:
Determine the solution of the problem:
min
u  t
  J
   œÄ
0
 u2
  

œÜ
dt
(3.42)
subject to the differential equation constraint:
 Àôx1
Àôx2
   0
1
 œâ2 0
  x1
x2
  0
1
 u
 

f
 (3.43)
and the boundary conditions:
 x1
x2
  0  

0
0
 and

x1
x2
  œÄ
 

1
0
  (3.44)
Since the Ô¨Ånal time and Ô¨Ånal states are prescribed, the transversality conditions
(Equations 3.40 and 3.41) are satisÔ¨Åed. The necessary conditions for optimality,
Equations (3.37) through (3.39), lead to:
  ÀôŒª1
ÀôŒª2
   0
 œâ2
1
0
 

 AT

Œª1
Œª2
 (3.45)

Àôx1
Àôx2
   0
1
 œâ2 0
  

A
 x1
x2
  
0
1

u
(3.46)
0
  2u
  0 1

Œª1
Œª2

(3.47)
¬© 2010 by Taylor and Francis Group, LLC

Optimal Control
77
The solution to Equation (3.45) is:
 Œª1
Œª2
  t
   e
 ATt
 Œª1
Œª2
  0  
cosœât
  œâ sin  œât
   sin œât
 œâ
cos œât
   Œª1
Œª2
  0  (3.48)
Substituting Equations (3.47) and (3.48) into Equation (3.46) leads to:

cosœâœÄ
   sin œâœÄ
 œâ
œâ sin  œâœÄ
  cosœâœÄ
   x1
x2
  œÑ
 



cos œâ œÑ
 sin  œâ œÑ
 œâ œÑ
4œâ3
  cos œâ œÑ
  2
4œâ2
  cos œâ œÑ
  2
4œâ2
  cos œâ œÑ
 sin œâ œÑ
 œâ œÑ
4œâ
 

Œª1
Œª2

 0  (3.49)
Substituting the boundary conditions (Equation (3.44)), we can solve for Œª1(0) and
Œª2(0)

Œª1
Œª2

0  



4œâ3
 sin œÄœâ
 œÄœâ cosœÄœâ
  sinœÄœâ
 2
 œÄ2œâ2
4œâ3œÄ sin  œÄœâ
 sinœÄœâ
 2
 œÄ2œâ2
 

(3.50)
which results in the optimal control
u  t
 
 Œª2
2
  sin  œât
 2œâ
4œâ3
 sin  œÄœâ

œÄœâ cos
 œÄœâ

sin  œÄœâ
2
 œÄ2œâ2
  cos
 œât
 2
4œâ3œÄ sin  œÄœâ

sin  œÄœâ
 2
 œÄ2œâ2
 (3.51)
3.2
Hamiltonian Formulation
Optimal control design is the process of determination of the control which opti-
mizes the cost function while satisfying the dynamical equations of motion and all
state and control constraints. The optimal control problem is stated as the minimiza-
tion of the cost
J
  Œ∏
 x tf
 tf


  tf
0 œÜ
 x u  t
  dt
(3.52)
subject to the constraints
Àôx
  f
 x u  t

(3.53)
and the initial and Ô¨Ånal state constraints. Without loss of generality, we have assumed
that the initial time is zero and the Ô¨Ånal time is tf . Augmenting the cost function with
the state equation, we have
¬© 2010 by Taylor and Francis Group, LLC

78
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
Ja
  Œ∏
 x tf
 tf


  tf
0 œÜ
 x u  t
 Œª T
f
  Àôx
  dt
 (3.54)
DeÔ¨Åne the Hamiltonian as
H
  œÜ
 Œª T f
 (3.55)
and using calculus of variations, the Euler-Lagrange equations are derived as:
 ÀôŒª
  ‚àÇH
‚àÇx
(3.56)
Àôx
  ‚àÇH
‚àÇŒª
(3.57)
‚àÇH
‚àÇu
  0
(3.58)
with the associated Transversality conditions
Œª T
 0  Œ¥x 0    ‚àÇŒ∏
‚àÇx
 Œª
 T





tf
Œ¥xtf

 
H
  ‚àÇŒ∏
‚àÇtf
 T





tf
Œ¥tf
 0
(3.59)
If Œ∏ is not an explicit function of the Ô¨Ånal time, and the problem corresponds to
one where the Ô¨Ånal time is free, the Transversality condition requires H = 0 at the
Ô¨Ånal time, i.e.,
H
 tf
   0  (3.60)
Consider the total time derivative of the Hamiltonian for a system whose state equa-
tions do not explicitly depend on time
dH
dt
  0
‚àÇH
‚àÇt
  ‚àÇH
‚àÇx
T dx
dt
  ‚àÇH
‚àÇu
T du
dt
  ‚àÇH
‚àÇŒª
T dŒª
dt
(3.61)
which can be rewritten as using Equations (3.56) and (3.57) as
dH
dt
  ‚àÇH
‚àÇx
T ‚àÇH
‚àÇŒª
  ‚àÇH
‚àÇu
T du
dt
  ‚àÇH
‚àÇŒª
T ‚àÇH
‚àÇx
(3.62)
Since the optimality conditions requires ‚àÇH
‚àÇu = 0, Equation (3.62) can be reduced to
dH
dt
  0
‚àÇH
‚àÇu
T du
dt
  0
  H
 t
  Constant
(3.63)
The constraint that H
 tf
  = 0, requires the Hamiltonian be zero for all time which
is a useful condition for numerical simulation.
¬© 2010 by Taylor and Francis Group, LLC

Optimal Control
79
The control law which satisÔ¨Åes Equations (3.56) through (3.59) is called the op-
timal controller. Equation (3.58) is referred to as the optimality condition which
assumes that the control input is unbounded. If the control input is restricted to an
admissible set, the Pontryagin‚Äôs minimum principle (PMP) is sufÔ¨Åcient to determine
the optimal control law. The PMP states that the optimal control at any instant of
time satisÔ¨Åes the constraint
H
 x
  u
  Œõ
  t
    H
x
  u  Œõ
  t
    admissible u
(3.64)
where
     represent the optimal quantities. Occasionally, the principle is presented
as Pontryagin‚Äôs maximum principle since the original development by Pontryagin
focused on maximizing a cost function.
Example 3.3:
Design a rest-to-rest optimal controller to minimize the cost function
J
   œÄ
0
 Àôu  t
 2
 dt
(3.65)
for the spring-mass system whose equation of motion is
¬®y
 œâ2y
  u  (3.66)
which in state space form is
Àôx
   0
1
 œâ2 0
 x
  0
1
 u
(3.67)
where x is the state vector
 y Àôy
 T. The boundary conditions of the rest-to-rest ma-
neuver are
x 0    Àôx  0   0   and x  œÄ
  1   Àôx  œÄ
  0  (3.68)
DeÔ¨Åne a new state u, which satisÔ¨Åes the equation:
Àôu
  v
(3.69)
where v is new control variable to be determined. The cost and state-space model are
now given as:
œÜ
  v2
(3.70)
f
 x t
  u t
  vt
  
 
0
1 0
 œâ2 0 1
0
0 0
 

x
u
  

0
0
1

v
 (3.71)
The Hamiltonian of the system is
¬© 2010 by Taylor and Francis Group, LLC

80
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
H
  v2
 Œª T
 


0
1 0
 œâ2 0 1
0
0 0
 
x
u
  

0
0
1

v
 
 (3.72)
Since the Ô¨Ånal time tf , and Ô¨Ånal states x  tf
  are Ô¨Åxed, Œ¥tf and Œ¥xf are zero. However,
the new state u is not speciÔ¨Åed at the initial and Ô¨Ånal times. The necessary conditions
for optimality are
  Àôx
Àôu
   ‚àÇH
‚àÇŒª
 

0
1 0
 œâ2 0 1
0
0 0
 
x
u
  

0
0
1

v
(3.73)
 ÀôŒª
  ‚àÇH
‚àÇy
  
0
 œâ2 0
1
0
0
0
1
0
 Œª
(3.74)
0
  ‚àÇH
‚àÇv
  2v
  0 0 1
 Œª
(3.75)
with the boundary conditions
Œª3
 0   Œª3
œÄ
  0  (3.76)
where y =
 x u
 .
The costates can be represented from Equation (3.74) as
Œª
 t
   

cos
œât
 œâ sin  œât
  0
  sin œât
 œâ
cos œât
  0
 cos
 œât
  1
œâ2
  sin œât
 œâ
1
 
Œª
 0  (3.77)
and the optimal control from Equation (3.75) is
v
  1
2
 0 0 1
 Œª
 t
   1
2
  cos
 œât
  1
œâ2
  sin  œât
 œâ
1
 Œª
 0   (3.78)
The system states at any the Ô¨Ånal time are given as:
 

x1
x2
u
 

 œÄ
 



cosœâœÄ
 sin  œâœÄ
 œâ
 cos œâœÄ
  1
œâ2
 œâ sin  œâœÄ
  cosœâœÄ
 sin  œâœÄ
 œâ
0
0
1
 




0
0
u  0   






  cos
 œÄœâ
 œâœÄ
 3sin œâœÄ
2œÄœâ
4œâ5
  2œâ cos œÄœâ
 sinœâœÄ
 œâ2œÄ
 2œâ
4œâ5
0
  2cos
 œÄœâ
  sinœâœÄ
 œâœÄ
2
4œâ4
  œâ sin  œÄœâ
  cos
œâœÄ
œâ2œÄ
4œâ4
0
  sin œÄœâ
 œâœÄ
2œâ3
  œâ cos œÄœâ
  œâ
2œâ3
0
 





Œª1
 0  Œª2
 0 
0
 

(3.79)
¬© 2010 by Taylor and Francis Group, LLC

Optimal Control
81
The costates at the Ô¨Ånal time are given by the equation:
 

Œª1
Œª2
Œª3



 œÄ
 


	
cos
œâœÄ
  œâ sin œâœÄ
  0
  sin œâœÄ
 œâ
cos œâœÄ
  0
 cos
 œâœÄ
  1
œâ2
  sin œâœÄ
 œâ
1
 




Œª1
 0  Œª2
0  0


	
(3.80)
Since Œª3
œÄ
  should equal 0, we arrive at a constraint equation:

 cos
 œâœÄ
 1
œâ2
  sin œâœÄ
 œâ
  Œª1
 0  Œª2
0    0
(3.81)
Equations (3.79) and (3.81) can be solved for Œª1
0  , Œª2
0   and u  0  , resulting in:
 

Œª1
0  Œª2
0  u  0   





0
0
0  5
 

(3.82)
which implies that v t
  = 0 for all time t, and the control u  t
  = 0.5 for all time.
Figure 3.5 illustrates the evolution of the system states x1 (solid line) and x2 (dashed
line), and the control input for œâ
  1.
0
0.5
1
1 5
2
2.5
3
3.5
‚àí0.5
0
0.5
1
1.5
Time
States
0
0.5
1
1 5
2
2.5
3
3.5
‚àí0.5
0
0.5
1
1.5
Time
Control
Figure 3.5: System Response and Optimal Control
¬© 2010 by Taylor and Francis Group, LLC

82
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
Example 3.4:
Design a rest-to-rest optimal controller to minimize the cost function
J
   œÄ
0
 u  t
 2
 dt
(3.83)
for the spring-mass system whose equation of motion is
¬®y
 œâ2y
  u  (3.84)
which in state-space form is
Àôx
   0
1
 œâ2 0
 x
  0
1
 u
(3.85)
where x is the state vector. The boundary conditions of the rest-to-rest maneuver are
x 0   Àôx  0   0   and x  œÄ
  1   Àôx  œÄ
  0  (3.86)
Since,
œÜ
 u2
(3.87)
f
 x t
  u t
  
  0
1
 œâ2 0
 x
  0
1
 u  (3.88)
The Hamiltonian of the system is
H
  u2
 Œª T
   0
1
 œâ2 0

x
  0
1
 u
  (3.89)
Since the Ô¨Ånal time and Ô¨Ånal states are Ô¨Åxed, Œ¥tf and Œ¥xf are zero. The necessary
conditions for optimality are
Àôx
  ‚àÇH
‚àÇŒª
   0
1
 œâ2 0
 x
  0
1
 u
(3.90)
 ÀôŒª
  ‚àÇH
‚àÇx
  0
 œâ2
1
0
 Œª
(3.91)
0
  ‚àÇH
‚àÇu
  2u
  0 1
 Œª
(3.92)
The costates can be represented from Equation (3.91) as
Œª
 t
   cosœât
  œâ sin  œât
   sin  œât
 œâ
cos
 œât
  Œª
0  (3.93)
and the optimal control from Equation (3.92) is
¬© 2010 by Taylor and Francis Group, LLC

Optimal Control
83
u
  1
2
 0 1
 Œª
  1
2
 sin  œât
 œâ
 cos
 œât
  Œª
 0  (3.94)
Substituting Equation (3.94) into Equation (3.90), we have
x t
  Œª1
 0  4
 sin œât
 œâ3
  t cos
 œât
 œâ2
   Œª2
 0  4
t sin  œât
 œâ
(3.95)
where
Œª
 0 

 

4œâ3
 sin œÄœâ
 œÄœâ cosœÄœâ
  sin œÄœâ
 2
 œÄ2œâ2
4œâ3œÄ sin  œÄœâ
 sin œÄœâ
 2
 œÄ2œâ2
 

(3.96)
are solved from the boundary conditions. For œâ = 1, the system response and the
control input is illustrated in Figure 3.6.
0
0.5
1
1.5
2
2.5
3
3.5
‚àí0.2
0
0.2
0.4
0.6
0.8
1
0
0.5
1
1.5
2
2.5
3
3.5
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
Time (sec)
Time (sec)
System States
Control Input
Figure 3.6: System Response and Optimal Control
3.2.1
Linear Quadratic Regulator (LQR)
Chapter 2 dealt with technique to modify the reference input to stable or marginally
stable linear systems with the goal of reaching the desired states in Ô¨Ånite time. In the
¬© 2010 by Taylor and Francis Group, LLC

84
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
presence of model uncertainties, the objective was to minimize the residual vibra-
tion of the system response. The shaping or Ô¨Åltering of the reference input is an
open-loop solution.
Wiener [4] developed a Ô¨Ålter to minimize the effect of noise on a signal. He posed
an optimization problem where the goal was to minimize the expected value of the
square of the difference of the stationary noisy signal and the truth. Subsequently,
Kalman and Koepcke [5] used the same quadratic cost function to develop state
feedback controllers for linear systems. The resulting solution (LQR) is one of the
most popular and widely studied technique for feedback controller design. This
section will illustrate the formulation of the LQR problem.
Consider the cost function
J
  1
2x  tf
 TSxtf
  1
2
  tf
0
 xTQx
 uTRu
 dt
(3.97)
where the matrices S and Q are constant positive deÔ¨Ånite or positive semi-deÔ¨Ånite
while the matrix R is positive deÔ¨Ånite, subject to the constraints
Àôx
  Ax
 Bu
(3.98)
x 0    x0
 (3.99)
The Hamiltonian of the system is
H
  1
2
 xTQx
 uTRu 
 Œª T
Ax
 Bu  (3.100)
The Euler-Lagrange equations are
Àôx
  ‚àÇH
‚àÇŒª
  Ax
 Bu
(3.101)
ÀôŒª
  ‚àÇH
‚àÇx
  ATŒª
 Qx
(3.102)
‚àÇH
‚àÇu
  Ru
 BTŒª
 0
(3.103)
where Œª is referred to as the costate.
The control can be solved from Equation (3.103) resulting in the equation
u
  R
 1BTŒª
 (3.104)
Substituting Equation (3.104) into the state and costate equations (Equations 3.101
and 3.102), the resulting coupled equations are
Àôx
  Ax
 BR
 1BTŒª
(3.105)
ÀôŒª
  ATŒª
 Qx  (3.106)
¬© 2010 by Taylor and Francis Group, LLC

Optimal Control
85
The transversality conditions result in the constraint
Sx  tf
  Œª
tf
  (3.107)
Assuming the structure of Equation (3.107) to relate the states and costates for all
time, we have
Œª
 t
  Pxt
  (3.108)
Differentiating Equation (3.108) with respect to time gives
ÀôŒª
  ÀôPx
 PÀôx
 (3.109)
Substituting the state and costate equations into Equation (3.109), we have
 ATPx
 Qx
  ÀôPx
 P  Ax
 BR
 1BTPx (3.110)
which can be rewritten as
  ÀôP
  ATP
 PA
 Q
 PBR
 1BTP
(3.111)
which is referred to as the matrix differential Riccati equation which is a nonlinear
differential equation in P subject to the boundary conditions given by
P  tf
  S
 (3.112)
Integrating Equation (3.111) backward in time with initial conditions S results in an
optimal controller
u
  R
 1BTPx
  Kx
(3.113)
where the feedback gain K
  R
 1BTP is a time varying feedback gain which requires
the time variation of P to be stored prior to its implementation.
For the inÔ¨Ånite time horizon problem, assuming that the closed-loop system is
stable, the terminal cost does not contribute to J and the matrix differential Riccati
equation can be reduced to the algebraic Riccati equation (ARE) since asymptotically
ÀôP is zero. The time invariant feedback gain of the inÔ¨Ånite time horizon LQR problem
is determined from the solution of the ARE,
ATPss
 PssA
 PssBR
 1BTPss
 Q
  0  (3.114)
DeÔ¨Åne
P
  Pss
 V
(3.115)
and substituting Equation (3.115) into Equation (3.111) results in
  ÀôV
  AT
 V
Pss


 V
Pss
A
Q
  V
Pss
BR
 1BT
 V
 Pss

(3.116)
which can be rewritten as
¬© 2010 by Taylor and Francis Group, LLC

86
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
  ÀôV
 ATV
 VA
 VBR
 1BTV
 VBR
 1BTPss
 PssBR
 1BTV
 ATPss
 PssA
 Q
 PssBR
 1BTPss
 

 0
(3.117)
which results in the equation
  ÀôV
  A
 BR
 1BTPss
 TV
 V
A
 BR
 1BTPss
  VBR
 1BTV
(3.118)
subject to the boundary conditions
V
 tf
  S
 Pss
 (3.119)
Assuming that V
 1 exists, consider the identity
V
 1V
  I
 (3.120)
The time derivative of Equation (3.120) results in
ÀôV
 1V
 V
 1 ÀôV
  0    ÀôV
 1
  V
 1 ÀôVV
 1
 (3.121)
DeÔ¨Åning
Œ¶
  V
 1
(3.122)
and substituting Equations (3.121) and (3.122) into Equation (3.118) results in the
equation
ÀôŒ¶
  Œ¶ A
 BR
 1BTPss
 T
 A
 BR
 1BTPss
 Œ¶
 BR
 1BT
(3.123)
subject to the boundary conditions
Œ¶ tf
 
S
 Pss
  1
 (3.124)
Equation (3.123) is the differential Lyapunov equation which can be solved in
closed form which can subsequently be used to solve for P  t
  and the feedback gain
in closed form. Appendix B presents a technique for solving the differential Lya-
punov equation using a matrix exponential function.
Example 3.5: Design a Ô¨Ånite-time LQR controller for the double integrator, where
the cost function is
J
  1
2
  T
0
 x
Àôx
 T
 1 0
0 1
  x
Àôx
  uT
 1  u dt
(3.125)
and the state space equation of motion is
¬© 2010 by Taylor and Francis Group, LLC

Optimal Control
87
 Àôx
¬®x
   0 1
0 0


x
Àôx
   0
1

u  (3.126)
The differential Riccati equation is
   Àôp11
Àôp12
Àôp12
Àôp22
   0 0
1 0

 p11 p12
p12 p22
   p11 p12
p12 p22
  0 1
0 0

  1 0
0 1

   p2
12
p12p22
p12p22
p2
22
 (3.127)
which is a nonlinear equation, subject to the boundary conditions
 p11 p12
p12 p22
  T
   0 0
0 0
 (3.128)
since there is no terminal penalty on the states. The solution of the algebraic Riccati
equation is:
Pss
   3 1
1
 3
 (3.129)
DeÔ¨Åning the solution of differential Riccati equation (3.127) as
P
  p11 p12
p12 p22
   Pss
 V  (3.130)
Equation (3.127) can be rewritten as
  ÀôV
  ATV
 VA
 VBR
 1BTV
 PssBR
 1BTV
 VBR
 1BTPss
 (3.131)
or
  ÀôV
  A
 BR
 1BTPss
 TV
 V
A
 BR
 1BTPss
  VBR
 1BTV  (3.132)
subject to the boundary condition
V
 T
 
 Pss
 (3.133)
DeÔ¨Åning Œ¶ = V
 1, Equation (3.132) can be rewritten as
ÀôŒ¶
  Œ¶ A
 BR
 1BTPss
 T
 A
 BR
 1BTPss
 Œ¶
 BR
 1BT
 (3.134)
which is a differential Lyapunov equation subject to the boundary conditions
Œ¶ T
 
 P
 1
ss
 (3.135)
Equation (3.134) is
¬© 2010 by Taylor and Francis Group, LLC

88
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
ÀôŒ¶
  Œ¶
 0
 1
1
  3
    0
1
 1
  3
 Œ¶
  0 0
0 1
 (3.136)
which can be written in vector differential form as



ÀôœÜ11
ÀôœÜ12
ÀôœÜ22



  
0
2
0
 1
  3
1
0
2
2
 3



 

A



œÜ11
œÜ12
œÜ22
 

 


0
0
 1
 




B
(3.137)
subject to boundary conditions
 

œÜ11
œÜ12
œÜ22



 T
   



  3
2
1
2
  3
2
 



(3.138)
Closed form solution of Equation (3.137) is



œÜ11
œÜ12
œÜ22
 

 t
   eA t
 

œÜ11
œÜ12
œÜ22
 

 0  A
 1
 eA t
 I
 B
 (3.139)
where I is the identity matrix. The initial conditions can be solved for from the
terminal constraint (Equation 3.136) which results in the equation
 

œÜ11
œÜ12
œÜ22



 0    





  3
6
 e
 T
 3
 2
 eT
 3
1  2eT
 3
  3
6
 e
 T
 3
 2
 eT
 3
 





(3.140)
which can be used to arrive at a closed-form expression for the V matrix which is
subsequently used to solve for the P matrix in closed-form:
P  t
 
 

 3sinh
  3  t
 T
  2  cosh
  3  t
 T

  1  cosh
  3   t
 T

 2  cosh
  3   t
 T

  1  cosh
  3   t
 T

 2  cosh
  3  t
 T

  3sinh
  3   t
 T
  2  cosh
  3   t
 T

  

(3.141)
and the feedback control gain is given as
K
  R
 1BTP  t
 
  1  cosh
  3   t
 T

 2  cosh
  3   t
 T

  3sinh
   3  t
 T
  2  cosh
  3   t
 T

  (3.142)
Example 3.6:
Consider the Ô¨Çoating oscillator benchmark problem where the masses and the
spring stiffness are unity. The state-space equation of motion is
¬© 2010 by Taylor and Francis Group, LLC

Optimal Control
89
 





Àôx1
Àôx2
¬®x1
¬®x2
 





 



0
0 1 0
0
0 0 1
 1 1 0 0
1
 1 0 0

	
	



 A







x1
x2
Àôx1
Àôx2
 





 






0
0
1
0
 






	

B
u  (3.143)
Design a LQR controller for the cost function
J
  1
2
 





x1
x2
Àôx1
Àôx2
 





T
 


1 0 0 0
0 1 0 0
0 0 1 0
0 0 0 1







	



x1
x2
Àôx1
Àôx2
 





  1
2
  tf
0
 





x1
x2
Àôx1
Àôx2
 





T
 


1 0 0 0
0 1 0 0
0 0 1 0
0 0 0 1







	



x1
x2
Àôx1
Àôx2
 





 uT
 1  u dt
(3.144)
For a Ô¨Ånal time of tf of 15 seconds, the differential Riccati equation
  ÀôP
  ATP
 PA
 Q
 PBR
 1BTP
(3.145)
with the boundary condition
P  15    


1 0 0 0
0 1 0 0
0 0 1 0
0 0 0 1




 (3.146)
0
5
10
15
‚àí2
‚àí1
0
1
2
3
4
5
Time (sec)
Elements of P
Figure 3.7: Evolution of the Terms of the Riccati Matrix
¬© 2010 by Taylor and Francis Group, LLC

90
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
Figure 3.7 illustrates the variation of the terms of the Riccati matrix. It can be
seen that the transients in the time response of the terms of the Riccati matrix exist
towards the end of the maneuver.
The optimal control is given by the equation
u
  R
 1BTP  t
 xt
 (3.147)
and is shown in Figure 3.8
0
5
10
15
‚àí1.6
‚àí1.4
‚àí1.2
‚àí1
‚àí0.8
‚àí0.6
‚àí0.4
‚àí0.2
0
0.2
0.4
Time (sec)
Control
Figure 3.8: Control Input
Figure 3.9 illustrates the variation of the states of the system and it is clear that ten
seconds into the controlled motion, the states are nearly zero. Figure 3.7 illustrates
that the terms of the Riccati matrix are nearly constant for the Ô¨Årst ten seconds of the
maneuver. This prompts the use of the algebraic Riccati equation to determine the
time invariant feedback gain vector which is:
K
  1  7212
 0  3070 2  1077 1  1365
  (3.148)
¬© 2010 by Taylor and Francis Group, LLC

Optimal Control
91
0
5
10
15
‚àí0.5
0
0.5
1
Time (sec)
States
Figure 3.9: Evolution of System States
Example 3.7: Design a optimal control to minimize the cost function
J
  xT
 T

 ‚àû0
0 ‚àû
 x T
 
  T
0 uTRu dt
(3.149)
for the single spring-mass system
 Àôx
¬®x
   0 1
 1 0


x
Àôx
   0
1

u  (3.150)
while moving the system from any initial condition to the equilibrium point at the
origin of the state space. This problem is the minimum power control problem when
R is selected to be one. The inÔ¨Ånite magnitude of the terminal penalty on the states
is equivalent to requiring the terminal states to be zero for the LQR problem.
The differential Riccati equation for the system is
  Àôp11
Àôp12
Àôp12
Àôp22
   0
 1
1 0

 p11 p12
p12 p22
   p11 p12
p12 p22
  0 1
 1 0

  p2
12
p12p22
p12p22
p2
22
 (3.151)
which is a nonlinear differential equation, subject to the boundary conditions
¬© 2010 by Taylor and Francis Group, LLC

92
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
P  T
 
 p11 p12
p12 p22
  T
 
 ‚àû0
0 ‚àû
 (3.152)
DeÔ¨Åning Œ¶ = P
 1, Equation (3.151) can be rewritten as
ÀôŒ¶
  Œ¶AT
 AŒ¶
 BR
 1BT
 (3.153)
which is a differential Lyapunov equation subject to the boundary conditions
Œ¶ T
 
 P
 1
 T
 
 0 0
0 0
  (3.154)
Equation (3.153) is
ÀôŒ¶
  Œ¶
 0
 1
1 0
    0 1
 1 0
 Œ¶
 0 0
0 1
 (3.155)
which can be written in vector differential form as



ÀôœÜ11
ÀôœÜ12
ÀôœÜ22



  
0
2 0
 1 0 1
0
 2 0





A
 

œÜ11
œÜ12
œÜ22



  

0
0
 1




	

B
(3.156)
assuming that the Œ¶ matrix is symmetric, subject to boundary conditions
 

œÜ11
œÜ12
œÜ22



 T
   

0
0
0
 

 (3.157)
Closed form solution of Equation (3.156) is



œÜ11
œÜ12
œÜ22
 

 t
   
1
2
 1
 cos
2t
   sin  2t
 1
2
 1
 cos
 2t
    1
2 sin  2t
 cos 2t
 1
2 sin  2t
 1
2
 1
 cos
 2t
   sin  2t
  1
2
 1
cos
 2t
   



œÜ11
œÜ12
œÜ22



 0 




1
4 sin  2t
   1
2t
1
4 cos 2t
   1
4
  1
4 sin  2t
   1
2t
 

 (3.158)
The initial conditions can be solved for from the terminal constraint (Equation (3.157))
which results in the equation



œÜ11
œÜ12
œÜ22
 

 0    



  sin  2T
 4
  T
2
cos 2T
 4
  1
4
sin 2T
 4
  T
2
 



(3.159)
¬© 2010 by Taylor and Francis Group, LLC

Optimal Control
93
which can used to arrive at a closed-form expression for the Œ¶ matrix
Œ¶ t
    1
2
T
 t
   1
4 sin  2  T
 t
  1
4 cos 2  T
 t
    1
4
1
4 cos 2  T
 t
    1
4
1
2
 T
 t
   1
4 sin  2  T
 t
   (3.160)
which is used to arrive at a closed-form expression for the matrix P,
P  t
 
 2
sin  2  T
 t
   2  T
 t
 2  t
 T
 2
 cos 2  T
 t
   1
 2
cos 2  T
 t
   1
2  t
 T
 2
 cos
 2  T
 t
   1
 2
cos 2  T
 t
   1
2  t
 T
 2
 cos
 2  T
 t
   1 2
2  T
 t
  sin  2  T
 t
  2  t
 T
 2
 cos
 2  T
 t
   1
 (3.161)
and the feedback control gain is given as
K
  R
 1BTP  t
 
  2
cos
 2  T
 t
   1
2  t
 T
 2
 cos 2  T
 t
   1
  2
 sin 2  T
 t
   2  T
 t
 2  t
 T
 2
 cos 2  T
 t
   1
 (3.162)
For a maneuver time of T = 10, the variation of the gain vector K as a function
of time is plotted on a semilog plot in Figure 3.10 where it can be seen that the
gain increases towards the end of the maneuver since the magnitude of the states are
tending to zero.
0
2
4
6
8
10
10
‚àí10
10
‚àí5
10
0
10
5
Gain K1
0
2
4
6
8
10
10
‚àí1
10
0
10
1
10
2
Gain K2
Time (sec)
Time (sec)
Figure 3.10: Variation of Feedback Gains
Figure 3.11 illustrates the variation of the states and the control as a function of
time. The simulation is carried out using the time-varying state feedback gain matrix
(Equation 3.162) for initial conditions which correspond to unit displacement and
zero initial velocity.
¬© 2010 by Taylor and Francis Group, LLC

94
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
0
2
4
6
8
10
‚àí1
‚àí0 5
0
0 5
1
0
2
4
6
8
10
‚àí0.4
‚àí0 2
0
0 2
0.4
Time (sec)
Time (sec)
System States
Control
Figure 3.11: Evolution of States and Control
3.2.2
LQR without State Penalty
For the speciÔ¨Åc case of quadratic cost functions which are not a function of system
states, a closed-form expression for the open-loop control proÔ¨Åle can be derived to
move the system from speciÔ¨Åed initial to Ô¨Ånal states in a speciÔ¨Åed time tf . This
section describes in detail the approach for designing the optimal control proÔ¨Åle.
Consider the cost function
J
  1
2
  tf
0 uTRu dt
(3.163)
where the matrix R is positive deÔ¨Ånite, subject to the constraint
Àôx
  Ax
 Bu
(3.164)
x 0    x0
(3.165)
x tf
  xf
 (3.166)
which for convenience can be represented in its Jordan canonical form [6] using the
similarity transformation Vz
  x
Àôz
 ¬ØA
 
V
 1AV
z
 ¬ØB
 
V
 1B
u
(3.167)
z 0    z0
  V
 1x0
(3.168)
z tf
  zf
 V
 1xf
 (3.169)
¬© 2010 by Taylor and Francis Group, LLC

Optimal Control
95
which can be used to solve for the states in closed form
z t
  e ¬ØAtz 0     t
0 e ¬ØA t
 œÑ
  ¬ØBu  œÑ
 dœÑ
(3.170)
or at the Ô¨Ånal time,
e
  ¬ØAtf zf
 z0
   tf
0 e
  ¬ØAœÑ ¬ØBu  œÑ
 dœÑ
 (3.171)
To solve for the optimal u  t
 , calculus of variations is exploited. The cost function
(Equation 3.163) is augmented with the terminal state constraint (Equation 3.171)
resulting in the augmented cost
Ja
  1
2
  tf
0 uTRu dt
 Œª T
 e
  ¬ØAtf zf
 z0
   tf
0 e
  ¬ØAœÑ ¬ØBu  œÑ
 dœÑ
 (3.172)
where Œª is the Lagrange multiplier which is not a function of time. The Ô¨Årst variation
of the augmented cost Ja is
Œ¥Ja
   tf
0
 Ru
 Œª Te
  ¬ØAt ¬ØB
 Œ¥u dt
(3.173)
which has to equal zero for the optimal control proÔ¨Åle. This results in the equation
u  t
  R
 1Œª Te
  ¬ØAt ¬ØB
(3.174)
Substituting Equation (3.174) into Equation (3.171) results in n constraints for a nth
order state space system in terms of the unknown variable Œª which can be solved to
result in a closed form expression for the optimal control proÔ¨Åle.
Example 3.8: Consider the single spring-mass system and design an optimal control
proÔ¨Åle to minimize the cost function
J
   10
0
u2 dt
(3.175)
subject to the constraints
 Àôx1
¬®x1
   0 1
 1 0


x1
Àôx1
   0
1

u
(3.176)
 x1
Àôx1
  0  
 1
0

(3.177)
 x1
Àôx1
  10  
 0
0

(3.178)
The optimal control proÔ¨Åle is given by the Equation (3.174):
¬© 2010 by Taylor and Francis Group, LLC

96
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
u  t
 Œª Te
 AtB

 Œª1 Œª2
  cos t
  sin t
 sin  t
  cos
 t
   0
1

(3.179)
u  t
 
 Œª1sin t
  Œª2cos
t
 (3.180)
since R = 1. Substituting Equation (3.180) into the constraint (Equation 3.171), we
have
 cos
 10   sin10  sin 10   cos
10   0
0

 1
0


  10
0
 cos
 t
  sin  t
 sin  t
  cos t
   0
1

  Œª1sin  t
  Œª2cost
   dt
(3.181)
or
  1
0
    10
0
 Œª1 sin2
 t
  Œª2sin  t
 cos t
  Œª1sin  t
 cos t
  Œª2cos2
t
  dt
  1
4
 2t
 sin 2t
    1
4 cos 2t
   1
4 cos 2t
 1
4
 2t
 sin 2t
       10
0

Œª1
Œª2

(3.182)
which results in the closed-form solution

Œª1
Œª2

   1
4
 20
 sin
 20   1
4 cos
20    1
4
1
4 cos20    1
4
1
4
 20
 sin
20 
  1
 1
0


  0  2098
 0  0059
 (3.183)
Figure 3.12 illustrates the variation of the system states and control for the open-
loop optimal control proÔ¨Åle. Comparing Figure 3.12 to Figure 3.11 it is clear that the
optimal solutions are identical.
3.2.3
Desensitized LQR Control
It is desirous to design controllers which are robust to errors in model parameters,
i.e., they are insensitive to errors in estimated values of the parameters of the system
model. The motivation comes from the fact that in real physical systems, the values
which are assumed to be constant (e.g., natural frequency, damping ratio) are not
known exactly. When this is the case, the control proÔ¨Åle determined using estimated
model parameters will not move the system from its initial states to the desired Ô¨Ånal
states. To desensitize the control proÔ¨Åle to errors in estimated model parameters, the
sensitivity of the system states to the uncertain parameters are forced to zero at the
end of the maneuver [7]. Consider the state-space model
Àôx
  A  p x
B  p u
(3.184)
¬© 2010 by Taylor and Francis Group, LLC

Optimal Control
97
0
2
4
6
8
10
‚àí1
‚àí0 5
0
0 5
1
0
2
4
6
8
10
‚àí0.4
‚àí0 2
0
0 2
0.4
Time (sec)
Time (sec)
System States
Control
Figure 3.12: Evolution of States and Control
where p is the vector of uncertain parameters. The sensitivity of the states to the ith
uncertain parameter pi is given by the equation
d Àôx
dpi
  A  p  dx
dpi
 ‚àÇA  p 
‚àÇpi
x
 ‚àÇB
‚àÇpi
u  (3.185)
The robustness constraint is imposed by requiring the sensitivity states to be forced
to zero at the end of the maneuver, i.e., the initial and Ô¨Ånal sensitivity state constraints
are
dx
dpi
 0    0
(3.186)
dx
dpi
 tf
  0  (3.187)
The augmented state-space model is given by the equation
  Àôx
dx
dpi
   A  p 
0
‚àÇA  p  ‚àÇpi
A  p     x
dx
dpi


  B
‚àÇB
‚àÇpi

u
(3.188)
subject to the constraints
x  0    x0
  dx
dpi
 0    0
(3.189)
x tf
  xf
  dx
dpi
tf
  0  (3.190)
¬© 2010 by Taylor and Francis Group, LLC

98
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
Example 3.9: Consider the single spring-mass system and design an optimal control
proÔ¨Åle to minimize the cost function
J
   10
0
u2 dt
(3.191)
subject to the constraints
 Àôx
¬®x
    0 1
 k 0
  x
Àôx
   0
1

u
(3.192)
 x
Àôx
  0  
 1
0

(3.193)
where the spring stiffness k is uncertain. The sensitivity of the states to k is given by
the equation
  dx
dk
d ¬®x
dk
  
0 1
 k 0
   dx
dk
dx
dk
  
0 0
 1 0
  x
Àôx
 (3.194)
and the augmented state-space model is
 





Àôx
¬®x
dx
dk
d ¬®x
dk
 





 



0 1 0 0
 k 0 0 0
0 0 0 1
 1 0
 k 0
 





Aa
 





x
Àôx
dx
dk
dx
dk
 





 






0
1
0
0
 








Ba
u
(3.195)
subject to the initial and Ô¨Ånal state constraints
x 0    x0
dx
dk
 0    0
(3.196)
x  tf
  xf
  dx
dk
tf
  0  (3.197)
Assuming that the nominal estimate of the spring stiffness k = 1, the optimal control
is given by the equation
u  t
 
Œª Te
 AatBa
u t
 
 





Œª1
Œª2
Œª3
Œª4
 





T
 


cos
 t
  sin t
 0
0
sin  t
 cos
 t
 0
0
  1
2t sin  t
   1
2t cos t
   1
2 sint
  cos t
  sin  t
 1
2t cos t
   1
2 sint
   1
2t sin  t
 sin  t
  cos t
  









0
1
0
0



	



u  t
 
 Œª1sin  t
  Œª2cost
  Œª3
 1
2t cos t
  1
2 sin  t
   Œª4
1
2t sin  t
 (3.198)
¬© 2010 by Taylor and Francis Group, LLC

Optimal Control
99
Substituting Equation (3.198) into Equation (3.171) results in the Lagrange multipli-
ers
 





Œª1
Œª2
Œª3
Œª4







  





 0  97838108758535
 0  27419663930798
 0  08530392469518
0  29711406335070
 





(3.199)
0
2
4
6
8
10
‚àí1
‚àí0 5
0
0 5
1
0
2
4
6
8
10
‚àí0 5
0
0 5
1
Time (sec)
Time (sec)
System States
Control
Figure 3.13: Evolution of States and Control
Figure 3.13 illustrates the variation of the system states and control proÔ¨Åle for the
robust minimum power control proÔ¨Åle. The residual energies of the minimum power
and the robust minimum power control proÔ¨Åles for variations in estimated spring
stiffness is shown in Figure 3.14 where it is clear that around the nominal value of
the spring stiffness, the robust control proÔ¨Åle has increased the insensitivity of the
controllers to errors in estimated model parameter.
One can conjecture that the increased robustness of the control trade-offs an in-
crease in the performance index. The cost function corresponding to the optimal
control in Example 3.8 is 0.2098 and the cost function of the insensitive control in
Example 3.9 is 0.9784, a 366% increase which is a signiÔ¨Åcant penalty for the result-
ing robustness.
¬© 2010 by Taylor and Francis Group, LLC

100
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
0.7
0.8
0 9
1
1.1
1.2
1.3
1.4
0
0.1
0 2
0 3
0.4
0 5
0 6
0.7
Variation in Spring Stiffness
Minimum Power Control
Robust Minimum Power Control
Square Root of Residual Energy
Figure 3.14: Controller Sensitivity
3.3
Minimum Power Control
Another important subset of the LQR problem is one where the state errors are
not penalized. Minimizing the integral of the quadratic of the input is referred to
as minimum power control. This section will describe the development of a closed-
form expression for the open-loop minimum power, point-to-point motion control.
The focus here is on the control of structures whose dynamics are represented by
second-order matrix differential equations.
3.3.1
Minimum Power Control of Maneuvering Structures
This section deals with the design of rest-to-rest maneuver controllers which min-
imize the cost function
J
  1
2
  T
0 uTu dt
(3.200)
for multi-mode Ô¨Çexible structures with one rigid body mode and N Ô¨Çexible modes,
modeled as
M ¬®x
 Œæ Àôx
 Kx
  Pu
(3.201)
where M is the mass matrix, Œæ the damping matrix, K the stiffness matrix and the
maneuver time T is speciÔ¨Åed. P is the control inÔ¨Çuence vector, and u and x are the
¬© 2010 by Taylor and Francis Group, LLC

Optimal Control
101
scalar control input and state vector, respectively. It is assumed that the damping
matrix Œæ satisÔ¨Åes the Rayleigh damping model [8]
Œæ
  Œ±M
 Œ≤K
 (3.202)
DeÔ¨Åning x = Œ¶z where Œ¶ is the eigenvector matrix resulting from the generalized
eigenvalue problem of the matrix pair (K,M), the equations of motion can be rewrit-
ten as
¬®z
  



0
0
0
0 2Œ∂1œâ1
0
2Œ∂2œâ2 0
...




 Àôz
  



0 0
0
0 œâ2
1
0 œâ2
2 0
...




z
  







œÜ0
œÜ1
œÜ2
...









u
(3.203)
which in state-space form is
Àôw
  









0 1
0
0 0
0
1
 œâ2
1
 2Œ∂1œâ1
0
1
 œâ2
2
 2Œ∂2œâ2
0
...
 









w
  









0
œÜ0
0
œÜ1
0
œÜ2
...











u  (3.204)
DeÔ¨Åning a similarity transformation
w
  











1 0
0
0
0
0 1
0
0
0 0
  Œ∂1
 j
 1  Œ∂ 2
1
œâ1
  Œ∂1
 j
 1  Œ∂ 2
1
œâ1
0 0
1
1
0
0
0
0
  Œ∂2
 j
 1  Œ∂ 2
2
œâ2
  Œ∂2
 j
 1  Œ∂ 2
2
œâ2
1
1
0
...
 














Œ®
y
 (3.205)
Equation (3.204) can be rewritten in the Jordan canonical form as
Àôy
  









0 1
0
0 0
 p1
  jq1
0
0
 p1
  jq1
 p2
  jq2
0
0
 p2
  jq2
0
...
 












A
y
  









0
œà2
œà3
œà4
œà5
œà6
...
 












B
u  (3.206)
¬© 2010 by Taylor and Francis Group, LLC

102
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
where
pi
  Œ∂iœâi and qi
  œâi
 1
 Œ∂ 2
i
 (3.207)
It can be easily shown that
exp   A t
 
 





1
 t 0
0 1
ep1t
 cos q1t
   jsin q1t
  0
0
ep1t
 cos
 q1t
   jsin q1t
  0
...
 





 (3.208)
Equation (3.206) can be solved in closed form
exp   A T
 yT
  y0     T
0 exp   A t
 Bu t
 dt
(3.209)
Augmenting the cost function given by Equation (3.200) with the constraint Equa-
tion (3.209), we have
Ja
  1
2
  T
0 uTu dt
 Œª T
 exp   A T
y T

 y 0     T
0 exp   A t
 Bu t
 dt
 (3.210)
where Œª is a constant. The variation of Equation (3.210) results in the equation:
Œ¥Ja
   T
0
 u
 Œª Texp   A t
 B
 Œ¥u t
 dt
(3.211)
which leads to the equation:
u  t
  Œª Texp  A t
 B
(3.212)
u  t
  Œª T
 











 tœà2
œà2
ep1t
 cos
 q1t
   jsin q1t
  œà3
ep1t
 cos
 q1t
   jsin q1t
  œà4
...
 











(3.213)
u  t
  Œ∫1
 Œ∫2t
 N
‚àë
i 1
Œ∫2i 1epit cos qit
 Œ∫2i 2epit sin  qit
 (3.214)
The constants Œ∫i which are functions of Œª and œài, are determined by solving the
constraint Equation (3.209). It is clear that the minimum power control proÔ¨Åle con-
sists of a ramp input which corresponds to the rigid body mode and an exponentially
growing harmonic part which corresponds to the underdamped Ô¨Çexible modes. For
undamped systems, the harmonic part of the control proÔ¨Åle does not grow with time.
¬© 2010 by Taylor and Francis Group, LLC

Optimal Control
103
Example 3.10: Design a minimum power control for the undamped Ô¨Çoating oscil-
lator benchmark problem where the maneuver time is 10 seconds and the objective
is to move from an initial point of rest at unity to a Ô¨Ånal position of rest at the origin.
The equation of motion of the system is
 1 0
0 1
 ¬®y1
¬®y2
    1
 1
 1 1

y1
y2
   1
0

u  (3.215)
with the initial and Ô¨Ånal conditions
 





y1
y2
Àôy1
Àôy2
 





 0  







1
1
0
0
 





and







y1
y2
Àôy1
Àôy2
 





 10  







0
0
0
0
 





(3.216)
Using the similarity transformation
y1
y2
     1
 2
  1
 2
  1
 2
1
 2
  x1
x2
  (3.217)
the modal equation of motion can be derived
 1 0
0 1

¬®x1
¬®x2
   0 0
0 2

 x1
x2
     1
 2
1
 2
 u  (3.218)
with the corresponding boundary conditions
 





x1
x2
Àôx1
Àôx2
 





 10  







0
0
0
0
 





and







x1
x2
Àôx1
Àôx2
 





 0  







 1  4142
0
0
0
 





(3.219)
which in state-space form is







Àôx1
¬®x1
Àôx2
¬®x2
 





 



0 1 0 0
0 0 0 0
0 0 0 1
0 0
 2 0

	
	








x1
Àôx1
x2
Àôx2
 





 




0
  1
 2
0
  1
 2
 


u  (3.220)
Based on Equation (3.214), the optimal control has the form
u  t
  Œ∫1
 Œ∫2t
 Œ∫3cos  2t
  Œ∫4sin   2t
 (3.221)
and the constraint equation for the determination of Œ∫i is
¬© 2010 by Taylor and Francis Group, LLC

104
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
 


1
 10
0
0
0
1
0
0
0
0
 0  005
 0  7071
0
0
1  4142
 0  0050







	



x1
x2
Àôx1
Àôx2
 





 10   






x1
x2
Àôx1
Àôx2
 





 0  
  10
0









t
 2
  1
 2
1
2 sin   2t
 1
 2 cos
  2t
  







u  t
dt
(3.222)
which reduces to
  





 1  4142
0
0
0







  


35  3553 235  7023
4  6446
0  3784
 7  0711
 35  3553
 0  5000
 0  5025
0  3553
0  2676
0  1768
2  5009
 0  5000
 4  6446
 3  5343
 0  2500







	



Œ∫1
Œ∫2
Œ∫3
Œ∫4
 





(3.223)
which can be solved for Œ∫i. Figure 3.15 illustrates the system response and the mini-
mum power control proÔ¨Åle.
0
2
4
6
8
10
0
0 5
1
1 5
0
2
4
6
8
10
‚àí0 2
‚àí0.1
0
0.1
0 2
Mass 1
Mass 2
Time (sec)
Time (sec)
Displacement States
Control
Figure 3.15: Evolution of States and Control
¬© 2010 by Taylor and Francis Group, LLC

Optimal Control
105
3.3.2
Robust Minimum Power Control of Maneuvering Structures
Consider the system
¬®z
  



0
0
0
0 2Œ∂1œâ1
0
2Œ∂2œâ2 0
...
 


 Àôz
  



0 0
0
0 œâ2
1
0 œâ2
2 0
...




z
  







œÜ0
œÜ1
œÜ2
...









u
(3.224)
where the damping coefÔ¨Åcient Œ∂i or the natural frequency œâi are uncertain. To add
robustness to uncertainties in the system parameters, the sensitivity states can be
determined and used to augment the equations of motion of the system. Enforcing
the constraints that the sensitivity states be zero at the end of the maneuver will result
in desensitized controllers as shown earlier. For illustrative purposes, assume that œâ1
is uncertain. From the equation
¬®z1
  2Œ∂1œâ1Àôz1
 œâ2
1z1
 œÜ1u  (3.225)
the sensitivity of z1 with respect to œâ1 is
d¬®z1
dœâ1
  2Œ∂1Àôz1
 2œâ1z1
 2Œ∂1œâ1
dÀôz1
dœâ1
 œâ2
1
dz1
dœâ1
 (3.226)
The Ô¨Ånal augmented system model is
¬®z
  





0
0
0
0 2Œ∂1œâ1
0
0
2Œ∂1
2Œ∂1œâ1
0
0
2Œ∂2œâ2 0
...







Àôz
  





0
0
0
0 œâ2
1
0
0 2œâ1 œâ2
1
0
0 œâ2
2 0
...







z
  











œÜ0
œÜ1
0
œÜ2
...













u
(3.227)
where the state vector has been augmented with the sensitivity states [7]. The second-
order model of the system can be rewritten in Jordan canonical form as
Àôy
  













0 1
0
0 0
 p1
  jq1
1
0
 p1
  jq1
0
0
0
 p1
  jq1
1
0
0
0
 p1
  jq1
0
0
 p2
  jq2
0
0
0
0
 p2
  jq2
0
...
 
















A
y
  











0
œà2
œà3
œà4
œà5
œà6
...
 














B
u  (3.228)
¬© 2010 by Taylor and Francis Group, LLC

106
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
where
pi
  Œ∂iœâi and qi
  œâi
 1
 Œ∂ 2
i
 (3.229)
It can be seen from Equation (3.228) that the addition of the sensitivity state equation
to the original system model results in repeated poles of the augmented system at the
nominal location of the uncertain poles. Representing cos    jsin
    as C S
    ,
and cos
    jsin
    as C S
     it can be easily shown that the matrix exponential
is:
exp   A t
 
 





A0
0
0
0
   0 A
 1
0
0
   0
0
A
 1
0
   0
0
0
A
 2
   0
0
0
0
...
 





(3.230)
where
A0
  1
 t
0 1
 (3.231)
A
 i
  epit
 C S
  qit
 tepit
 C S
  qit

0
epit
 C S
  qit
   (3.232)
A
 i
  epit
 C S
  qit
 tepit
 C S
  qit

0
epit
 C S
  qit
   (3.233)
and the optimal control can be shown to have the form
u  t
 Œ∫1
 Œ∫2t
 tep1t
 Œ∫3 cos
 q1t
  Œ∫4 jsin
 q1t
   N
‚àë
i 1
Œ∫2i 3epit cos qit
 Œ∫2i 4 jepit sin  qit
 (3.234)
when robustness is desired with respect to uncertainties in the damping and natural
frequency of the Ô¨Årst mode. If robustness with respect to additional modes is re-
quired, terms of the form tepit
 Œ∫m cos
 qit
 Œ∫m 1 jsin
 qit
   are included into u  t
  to
desensitize the controller to uncertainties in Œ∂i or œâi.
Example 3.11: The decoupled equations of motion of the two-mass Ô¨Çoating oscil-
lator problem are
 1 0
0 1
 ¬®x1
¬®x2
   0 0
0 2

x1
x2
     1
 2
1
 2
 u
(3.235)
with a nominal natural frequency œâ of
 2. To design a controller which is robust
to uncertainties in the natural frequency of the system, the sensitivity state equations
are derived and the augmented dynamical model of the system is
¬© 2010 by Taylor and Francis Group, LLC

Optimal Control
107
 

¬®x1
¬®x2
d ¬®x2
dœâ
 

 

0
0
0
0
2
0
0 2
 2 2
 



x1
x2
dx2
dœâ
 

  


1
 2
1
 2
0
 
u
(3.236)
which can be represented in Jordan canonical form as
 













Àôy1
Àôy2
Àôy3
Àôy4
Àôy5
Àôy6
 













 







0 1
0
0
0
0
0 0
0
0
0
0
0 0
 2 j
1
0
0
0 0
0
 2j
0
0
0 0
0
0
  2j
1
0 0
0
0
0
  2j
 





















y1
y2
y3
y4
y5
y6
 













 








0
  1
 2
  2
4
1
2 j
  2
4
  1
2 j
 







u
(3.237)
with the boundary conditions
0
2
4
6
8
10
1
1 5
2
2 5
0
2
4
6
8
10
‚àí0 2
‚àí0.1
0
0.1
0 2
Mass 1
Mass 2
Time (sec)
Time (sec)
System States
Control
Figure 3.16: System Response and Control Input
 













y1
y2
y3
y4
y5
y6
 













 0  















0
0
0
0
0
0
 













and















y1
y2
y3
y4
y5
y6
 













 10  















 1  4142
0
0
0
0
0
 













(3.238)
¬© 2010 by Taylor and Francis Group, LLC

108
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
The optimal control is given as
u  t
  Œ∫1
 Œ∫2t
 Œ∫3cos  2t
   jŒ∫4sin   2t
  Œ∫5t cos
  2t
   jŒ∫6t sin   2t
 (3.239)
where the optimal Œ∫i are
 













Œ∫1
Œ∫2
Œ∫3
Œ∫4
Œ∫5
Œ∫5















  













0  1666
 0  0333
 0  0506
0  0952i
0  0146
 0  0146i
 













 (3.240)
Figure 3.16 illustrates the displacement response and the robust minimum power
control proÔ¨Åle.
0.7
0.8
0 9
1
1.1
1.2
1.3
1.4
0
0.01
0.02
0.03
0.04
0.05
0.06
0.07
0.08
Minimum Power
Robust Minimum Power
Variation in Spring Stiffness
Square Root of Residual Energy
Figure 3.17: Controller Sensitivity
It is patent from Figure 3.17 which plots the residual energy of the system at
the end of the maneuver, that the robust minimum power control proÔ¨Åle provides
robustness to uncertainties of the spring stiffness around the nominal estimate of
the system model. The cost trade-off corresponds to an increase in the performance
index from 0.0504 (Example 3.10) to 0.0666 (Example 3.11), a modest 32% increase
in the power consumed.
¬© 2010 by Taylor and Francis Group, LLC

Optimal Control
109
3.3.3
Minimum Time/Power Control
The minimum power optimal control formulation requires the maneuver time to
be speciÔ¨Åed. In application such as disk drives for laptops, minimizing the consumed
power is clearly desirable. However, if the tradeoff of power versus maneuver time is
large, the resulting controller is not realistic. Minimization of a weighted combina-
tion of maneuver time and power consumed can lead to appealing control strategies
which permits users to dial up or down, the penalty associated with the maneuver
time and power consumed. This section will present the optimal control formulation
and illustrate it with two examples.
The cost function which minimizes a convex combination of the maneuver time
and the power consumed is:
J
   tf
0
  1
 Œ±
  Œ± 1
2uTRu
 dt
(3.241)
where Œ± is a scalar which lies between zero and one and permits the cost function to
span the spectrum of minimum time control and minimum power control problems.
The positive deÔ¨Ånite matrix R permits relatively weighting inputs in a multi-input
control system. The linear model of the controlled system is:
Àôx
  Ax
 Bu
(3.242)
and the controller is subject to the boundary conditions:
x 0    x0
  x tf
  xf
(3.243)
The Hamiltonian of the system is:
H
  1
 Œ±
  Œ± 1
2uTRu
 Œª T
 Ax
Bu 
 (3.244)
The necessary conditions for optimality are:
Àôx
  ‚àÇH
‚àÇŒª
  Ax
 Bu
(3.245a)
ÀôŒª
  ‚àÇH
‚àÇx
  ATŒª
(3.245b)
‚àÇH
‚àÇu
  0
  Œ±Ru
 BTŒª
(3.245c)
x  0    x0 and x  tf
  xf
(3.245d)
The costate equation can be solved resulting in the equation
Œª
 t
  exp  ATt
 Œª
0  (3.246)
which results in the control
u
   1
Œ± R
 1BTŒª
 t
 
  1
Œ± R
 1BTexp   ATt
 Œª
0  (3.247)
¬© 2010 by Taylor and Francis Group, LLC

110
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
Substituting the expression for the control into the state equation leads to:
x  tf
  exp Atf
 x0     tf
0 exp  A  tf
 œÑ
  Bu œÑ
 dœÑ
(3.248)
which can be rewritten as:
Œ±
 exp   Atf
 xf
 x0
     tf
0 exp   AœÑ
 BR
 1BTexp   ATœÑ
 Œª
0  dœÑ
(3.249)
DeÔ¨Åne the Gramian matrix
P
   tf
0 exp   AœÑ
 BR
 1BTexp   ATœÑ
 dœÑ
(3.250)
which is related to the controllability Gramian Wc
 tf
  by the equation
Wc
 tf
  exp Atf
 Pexp ATtf
  (3.251)
Therefore, for a controllable system, P is a nonsingular matrix. Differentiating Equa-
tion (3.250) with respect to time leads to:
ÀôP
 BR
 1BT
 A
  tf
0 exp   AœÑ
 BR
 1BTexp   ATœÑ
 dœÑ
   tf
0 exp   AœÑ
 BR
 1BTexp   ATœÑ
 dœÑAT
(3.252)
or
ÀôP
  BR
 1BT
 AP
 PAT
  P  0    0
(3.253)
which is the differential Lyapunov equation which can solved using the technique
presented in Appendix B.
Equation (3.249) can now be solved for Œª
0 
Œª
0 
  P
 1Œ±
 exp   Atf
 xf
 x0
 (3.254)
which can be used to rewrite the cost function as:
J
  1
 Œ±
tf
   tf
0 Œ± 1
2uTRu dt
  1
 Œ±
 tf
   tf
0
1
2Œ± Œª
 0  Texp   ATt
 TBR
 1BTexp   ATt
 Œª
0  dt
(3.255)
DeÔ¨Åne:
S
   tf
0 exp   ATt
 TBR
 1BTexp   ATt
 dt
(3.256)
which leads to the differential Lyapunov equation:
ÀôS
  BR
 1BT
 AS
 SAT
(3.257)
¬© 2010 by Taylor and Francis Group, LLC

Optimal Control
111
which is identical to Equation (3.253). Solving Equation (3.257), leads to the cost
function:
J
  1
 Œ±
 tf
  1
2Œ± Œª
 0  TSŒª
 0  (3.258)
where Œª
 0  and S are implicit functions of tf . Since S and P are identical, the cost
function can be rewritten as:
J
  1
 Œ±
 tf
  Œ±
2
 exp   Atf
 xf
 x0
 T
 P
 1
 TSP
 1
 exp   Atf
 xf
 x0
 (3.259)
which reduces to:
J
  1
 Œ±
tf
  Œ±
2
 exp   Atf
 xf
 x0
 T
 P
 1
 T
 exp   Atf
xf
 x0
 (3.260)
A single-dimension parameter optimization problem can now be solved to determine
tf .
Example 3.12:
Consider the problem:
J
   tf
0
 1
  1
2u2
 dt
(3.261)
for the system:
 Àôx1
Àôx2
   0 1
0 0


x1
x2
   0
1

u
(3.262)
subject to the boundary conditions:
x1
 0   x2
 0   0   x1
 tf
   1  x2
 tf
  0  (3.263)
The optimal control is given by the equation:
u
  t
 1
 Œª
 0  (3.264)
where Œª
0   is given by the equation:
Œª
0  
 P
 1
 exp   Atf
 xf
 x0
 (3.265)
where P is the solution of the equation:
  Àôp1 Àôp2
Àôp2 Àôp3
   0 0
0 1

  0 1
0 0

 p1 p2
p2 p3
   p1 p2
p2 p3
  0 0
1 0

(3.266)
which can be solved resulting in the equation:
P
  p1 p2
p2 p3
   
t3
f
3
 t2
f
2
 t2
f
2
tf
 
(3.267)
¬© 2010 by Taylor and Francis Group, LLC

112
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
Thus, Œª
 0   can be solved as:
Œª
0  
   12tf
 3 6tf
 2
6tf
 2 4tf
 1
  1
0

   12tf
 3
 6tf
 2
 (3.268)
The Ô¨Ånal cost function can now be written as:
J
  tf
  6
t3
f
(3.269)
Forcing the derivative of J with respect to tf to zero, leads to the optimal solution:
tf
 4
 18
(3.270)
Example 3.13:
Consider the problem of minimizing:
J
   tf
0
  1
 Œ±
   1
2Œ±u2
 dt
(3.271)
for the undamped benchmark Ô¨Çoating oscillator:
 





Àôx1
Àôx2
Àôx3
Àôx4
 





 



0
0 1 0
0
0 0 1
 1 1 0 0
1
 1 0 0

	
	








x1
x2
x3
x4
 





 



0
0
1
0

	
	

u
(3.272)
subject to the boundary conditions:
x1
 0   x2
 0   0  x3
 0   x4
 0   0   x1
 tf
   1  x2
 tf
  1  x3
 tf
  0  x4
 tf
  0  (3.273)
Œ± is constrained to:
0
  Œ±
  1  (3.274)
To simplify the solution process, the system model is represented in the Jordan
canonical form as:
 





Àôy1
Àôy2
Àôy3
Àôy4
 





 



0 1
0
0
0 0
0
0
0 0
 2i
0
0 0
0
  2i
 









y1
y2
y3
y4
 





 



0
1
1
1

	
	

u
(3.275)
subject to the boundary conditions:
y1
 0   y2
 0   0  y3
 0   y4
 0   0   y1
 tf
   2  y2
 tf
  0  y3
 tf
  0  y4
 tf
  0  (3.276)
¬© 2010 by Taylor and Francis Group, LLC

Optimal Control
113
The optimal control is given by the equation:
u
   1
Œ±
  t
  1   cos
  2t
  isin  2t
   cos
  2t
  isin  2t
  Œª
 0 
(3.277)
where Œª
 0  is given by the equation:
Œª
 0 

 Œ±P
 1
 exp   Atf
 xf
 x0
 (3.278)
where P is the solution of the equation:
 


Àôp1 Àôp2 Àôp3 Àôp4
Àôp2 Àôp5 Àôp6 Àôp7
Àôp3 Àôp6 Àôp8 Àôp9
Àôp4 Àôp7 Àôp9 Àôp10
 


 



0 0 0 0
0 1 1 1
0 1 1 1
0 1 1 1
 


 



0 1
0
0
0 0
0
0
0 0
 2i
0
0 0
0
  2i
 






p1 p2 p3 p4
p2 p5 p6 p7
p3 p6 p8 p9
p4 p7 p9 p10
 


(3.279)
 



p1 p2 p3 p4
p2 p5 p6 p7
p3 p6 p8 p9
p4 p7 p9 p10
 






0 0
0
0
1 0
0
0
0 0
 2i
0
0 0
0
  2i
 


(3.280)
which results in:




p1 p2 p3 p4
p2 p5 p6 p7
p3 p6 p8 p9
p4 p7 p9 p10
 





P
 t
 
 






t3
3
 t2
2
1
2
 e
 it
 2
 1
2 i
 2t
  1
2
 1
2
 eit
 2
   1
2 i
 2t
  1
2
  t
1
2 i
 2
  1
 e
 it
 2
   1
2 i
 2
  1
 eit
 2
   1
4 i
 2
  1
 e
 2i
 2t
 t
     1
4 i
 2
  1
 e2i
 2t
  






(3.281)
The cost function can now be represented as:
J
  1
 Œ±
 tf
  Œ±
2
 2 0 0 0
 P
 1
 tf
  





2
0
0
0
 





 (3.282)
Figure 3.18 illustrates the variation of the cost J as a function of the maneuver time tf
for Œ± = 0.5. The optimal maneuver time can be determined by a line search algorithm
and results in tf = 4.5315.
Figure 3.19 illustrates the variation of the maneuver time and the consumed power
as a function of the weighting parameter Œ±.
The variation of power consumed
(dashed line) is plotted on a log scale which implies that the power consumed rapidly
reduces as Œ± is increased from 0. It is also clear that the maneuver time (solid line)
varies slowly till Œ± is close to 1.
¬© 2010 by Taylor and Francis Group, LLC

114
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
4
4.2
4.4
4.6
4.8
5
5.1
5.15
5 2
5.25
5 3
5.35
5.4
5.45
5 5
5.55
5.6
Final Time
Cost
Figure 3.18: Variation of Cost Function
0
0 2
0.4
0.6
0.8
1
0
10
20
Œ±
Final Time
Power
Figure 3.19: Variation of Cost Function
3.4
Frequency-Shaped LQR Controller
The LQR design approach assumes that the model describing the system is valid
at all input frequencies. However, most models are inherently erroneous with both
structured and unstructured uncertainties. The structured uncertainties refers to the
errors in model parameters and unstructured uncertainties corresponds to unmodeled
dynamics. If one can include a penalty function which is a function of frequency, one
¬© 2010 by Taylor and Francis Group, LLC

Optimal Control
115
can then compensate for errors in system models in speciÔ¨Åc frequency regions. Gupta
[9] proposed an elegant approach to combine frequency domain penalty functions
into the classical LQR design process. This section describes the frequency shaped
LQR design process and illustrates it on the Ô¨Çoating oscillator benchmark problem.
The standard LQR design process is related to the determination of a controller
which minimizes the cost function
J
  1
2
  ‚àû
0
 xTQx
 uTRu
 dt
(3.283)
for the linear system
Àôx
  Ax
 Bu  (3.284)
where x
  Rn is the state vector, and u
  Rm is the control vector. The optimal
controller for the inÔ¨Ånite-time horizon problem is given by the equation
u
  Kx
  R
 1BTPx
(3.285)
where P is the solution of the algebraic Riccati equation
ATP
 PA
 Q
 PBR
 1BTP
  0  (3.286)
The Q and R matrices are the state and control penalty matrices, respectively, which
are generally constant matrices. The Parseval‚Äôs theorem [10] can be exploited to
rewrite the quadratic cost function (Equation 3.283) in the frequency domain as
J
  1
4œÄ
  ‚àû
 ‚àû
 xT
  jœâ
 Qx jœâ
 uT
 jœâ
 Ru jœâ
  dœâ
 (3.287)
In this formulation, it can be seen that the states and control are equally penalized
at all frequencies. In some systems, the actuators, sensors, or the system might have
poor characteristics at speciÔ¨Åc frequencies. Increasing the penalty of the states and
control at these frequencies permits shaping the frequency response characteristics
of the closed-loop system. The frequency-shaped cost function can be represented
as
J
  1
4œÄ
  ‚àû
 ‚àû
 xT
  jœâ
 Qjœâ
 xjœâ
 uT
 jœâ
 R jœâ
 u jœâ
  dœâ
 (3.288)
where Q and R are Hermitian matrices, i.e., Qij = conj
 Qji
  and Rij = conj
 R ji
 .
Assuming that the penalty matrices Q jœâ
  and R  jœâ
  can be rewritten as
Q jœâ
  Œ¶ jœâ
 Œ¶jœâ
 (3.289)
R  jœâ
  Œ® jœâ
 Œ®jœâ
 (3.290)
where Œ¶ jœâ
  and Œ® jœâ
  are rational matrices. The Ô¨Åltered states
¬© 2010 by Taylor and Francis Group, LLC

116
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
xf
  Œ¶ jœâ
x
(3.291)
u f
  Œ® jœâ
u
(3.292)
can be represented in state-space form as
Àôwx
  Axwx
 Bxx
xf
 Cxwx
 Dxx
(3.293)
Àôwu
  Auwu
 Buu
u f
 Cuwu
 Duu  (3.294)
Augmenting the system model (Equation 3.284) with Equations (3.293) and (3.294),
results in the augmented state-space system
 

Àôx
Àôwx
Àôwu
 




X
  
A 0
0
Bx Ax 0
0 0 Au
 



A


	
x
wx
wu



 

B
0
Bu
 



B
u
(3.295)
and the modiÔ¨Åed cost function
J
  1
2
  ‚àû
0 XT
 
DT
x Dx DT
x Cx
0
CT
x Dx CT
x Cx
0
0
0
CT
u Cu
 



Q
X
 2XT
 
0
0
CT
u Du
 



N
u
 uTDT
u Du



R
u dt
 (3.296)
The Hamiltonian of the system is
H
  1
2
 XTQX
 2XTN u
 uTRu
  Œª T
 A X
Bu 
 (3.297)
The Euler-Lagrange equations are
ÀôX
  ‚àÇH
‚àÇŒª
  A X
 Bu
(3.298)
ÀôŒª
  ‚àÇH
‚àÇX
  N u
 QX
 A TŒª
(3.299)
0
  ‚àÇH
‚àÇu
  Ru
 BTŒª
 N TX
(3.300)
¬© 2010 by Taylor and Francis Group, LLC

Optimal Control
117
The control can be solved from Equation (3.300) resulting in the equation
u
  R
 1
 BT Œª
 N TX
  (3.301)
Substituting Equation (3.301) into the state and costate equations (Equations 3.298
and 3.299), the resulting coupled equations are
ÀôX
 A X
 BR
 1
 BT Œª
 N TX
 (3.302)
ÀôŒª
 N R
 1
 BT Œª
 N TX
  QX
 A TŒª
 (3.303)
Assuming the relationship
Œª
  PX
  ÀôŒª
  ÀôPX
 P ÀôX
(3.304)
and substituting Equations (3.302) and (3.303) into Equation (3.304), we have the
following matrix differential equation
  ÀôP
  P
 A
 BR
 1N T
   A
 BR
 1N T
 T P
  Q
 N R
 1N T
  PBR
 1BTP
(3.305)
which for the inÔ¨Ånite time horizon problem reduces to the algebraic Riccati equation
P
 A
 BR
 1N T
   A
 BR
 1N T
 T P
  Q
 N R
 1N T
  PBR
 1BT P
  0  (3.306)
Equation 3.306 can be interpreted as the algebraic Riccati equation for the design of
a LQR controller for the prefeedback system [11]
ÀôX
  A
 BR
 1N T
 X
 Bu  (3.307)
which can be solved using a variety of commercially available software tools.
Figure 3.20 is a schematic of the frequency-shaped LQR controller where the
blocks within the dashed box correspond to the system being controlled. This struc-
ture presumes that the states are available for feedback control. For output feedback
control, the structure of controller is modiÔ¨Åed by including the output matrices to
permit the output of the system to be Ô¨Åltered instead of the system states.
¬© 2010 by Taylor and Francis Group, LLC

118
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
1
B
A
s
PLANT
+
+
+
K
x
B
s
1
u
B
u
A
s
1
x
A
Figure 3.20: Control Structure
Example 3.14:
Consider the undamped Ô¨Çoating oscillator benchmark problem whose model in
state-space form is
 





Àôx1
Àôx2
¬®x1
¬®x2
 





 



0
0 1 0
0
0 0 1
 1 1 0 0
1
 1 0 0

	
	








x1
x2
Àôx1
Àôx2
 





 






0
0
1
0
 





u  (3.308)
The optimal control which minimizes the cost function
J
  1
2
  ‚àû
0
 





x1
x2
Àôx1
Àôx2
 





T
 


1 0 0 0
0 0 0 0
0 0 0 0
0 0 0 0







	



x1
x2
Àôx1
Àôx2
 





 uT
 1  u dt
(3.309)
is given by the solution of the algebraic Riccati equation and is given as
u
   0  7673 0  2327 1  2388 0  6413
  





x1
x2
Àôx1
Àôx2
 





(3.310)
¬© 2010 by Taylor and Francis Group, LLC

Optimal Control
119
0
5
10
15
‚àí0 5
0
0 5
1
Time (sec)
Displacement
0
5
10
15
‚àí1
‚àí0 5
0
0 5
Time (sec)
Control Input
Mass 1
Mass 2
Figure 3.21: System Response and Control Input
Figure 3.21 illustrates the displacement response of the two masses of the closed-
loop system and the corresponding control input. It is clear that an underdamped
oscillatory response dominates the response of the system. This corresponds to a
closed-loop frequency of œâ = 1.3899, which corresponds to the undamped mode of
frequency œâ = 1.4142 of the open-loop system. It is therefore warranted to penal-
ize the frequency content of the states at frequencies around the undamped natural
frequency of the uncontrolled system. A frequency domain quadratic cost function
which penalizes the velocity of the Ô¨Årst mass is proposed
J
  1
2
  ‚àû
 ‚àû
 





x1
x2
Àôx1
Àôx2
 





T
 


1 0
0
0
0 0
0
0
0 0
1
 œâ2
 2  2 0
0 0
0
0
 









x1
x2
Àôx1
Àôx2
 





 uT
 1  u dœâ
(3.311)
DeÔ¨Åning a Ô¨Åltered state
x f
1
 1
s2
 2 Àôx1
 (3.312)
which in state-space form is
  Àôw1
Àôw2
   0
 2
1 0

w1
w2
   1
0

Àôx1
(3.313)
xf
1
  0 1
 
w1
w2
   0 Àôx1
 (3.314)
The frequency-domain LQR cost can be rewritten in time domain as
¬© 2010 by Taylor and Francis Group, LLC

120
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
0
5
10
15
‚àí0 5
0
0 5
1
Time (sec)
Displacement
0
5
10
15
‚àí1
‚àí0 5
0
0 5
Time (sec)
Control Input
Mass 1
Mass 2
Figure 3.22: System Response and Control Input
J
  1
2
  ‚àû
 ‚àû
 













x1
x2
Àôx1
Àôx2
w1
w2
 













T
 






1 0 0 0 0 0
0 0 0 0 0 0
0 0 0 0 0 0
0 0 0 0 0 0
0 0 0 0 0 0
0 0 0 0 0 1















	







x1
x2
Àôx1
Àôx2
w1
w2
 













 uT
 1  u dt
(3.315)
and the feedback controller is
u
   0  9862   0 0138   1 7910   0 1656   0 6176   0 4869
  













x1
x2
Àôx1
Àôx2
w1
w2
 













(3.316)
or
u
   0  9862 0  0138 1  7910 0  1656
  





x1
x2
Àôx1
Àôx2
 





  0  6176s
 0  4869
s2
 2
Àôx1
(3.317)
Figure 3.22 illustrates the displacement response of the two masses of the fre-
quency shaped closed-loop system and the corresponding control input. It can be
seen that the peak control magnitude does not change compared to the standard LQR
¬© 2010 by Taylor and Francis Group, LLC

Optimal Control
121
control. To illustrate the beneÔ¨Åt of shaping the frequency content of the states, the
potential energy in the spring of the benchmark problem is plotted in Figure 3.23
for both the LQR and frequency-shaped LQR controllers. It is clear that there is
a signiÔ¨Åcant reduction in the peak potential energy of the controlled system which
corresponds to minimizing the excitation of the Ô¨Çexible mode of the system.
0
5
10
15
0
0.02
0.04
0.06
0.08
0.1
0.12
0.14
0.16
0.18
Time (sec)
Frequency-Shaped LQR
LQR
Potential Energy
Figure 3.23: Potential Energy Evolution
The magnitude plot of the bode diagram of the LQR and frequency-shaped LQR
controller is shown in Figure 3.24 where it is clear that the frequency shaping re-
sults in a notch at a frequency of
 2. This also implies that if there are errors in
estimating the natural frequency of the benchmark problem, the frequency shaped
LQR controller can accommodate small errors and it reduces the magnitude plot in
the vicinity of the estimated natural frequency.
3.5
LQR Control with Noisy Input
Real-world applications include situations when the system is subject to random
disturbance inputs. For instance, random wind gusts act as disturbances to the con-
trollers of the Segway scooter, helicopters, airplanes, the effect of waves on a ship-
borne crane, besides others. The effect of the disturbances in the presence of model-
ing uncertainties has been an active area of research over the past decade [12]. This
¬© 2010 by Taylor and Francis Group, LLC

122
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
10
‚àí1
10
0
10
1
10
‚àí8
10
‚àí6
10
‚àí4
10
‚àí2
10
0
10
‚àí1
10
0
10
1
10
‚àí4
10
‚àí2
10
0
10
2
Frequency-Shaped LQR
Frequency-Shaped LQR
LQR
LQR
Magnitude (x1)
Magnitude (x2)
Frequency (rad/sec)
Frequency (rad/sec)
Figure 3.24: Bode Diagram: Magnitude Plot
section will describe controller design for systems subject to Gaussian random input.
Consider the linear system
Àôx
  Ax
 Bu
 Gw
(3.318)
where w t
  is a zero-mean Gaussian noise process with covariance
E
 w t
 wT
œÑ
   W
t
 Œ¥
t
 œÑ
  (3.319)
E is the expectation operator. To design a feedback controller which minimizes the
cost function
J
  E
 lim
T
 ‚àû
1
T
  T
0
 xT Qx
 uTRu
 dt

(3.320)
assume that the controller can be expressed as
u
  Kx (3.321)
The resulting cost function can be represented as
¬© 2010 by Taylor and Francis Group, LLC

Optimal Control
123
J
  E
 lim
T
 ‚àû
1
T
  T
0
 xT
 Q
 KTRK
x
 dt

(3.322)
  E
 lim
T
 ‚àû
1
T
  T
0 tr
 xxT
 Q
 KTRK

 dt
 (3.323)
where tr is the trace operator. The closed-loop dynamics are given as
Àôx
  A
 BK
x
Gw
(3.324)
x t
  Œ¶t
 0  x 0     t
0 Œ¶ t
 œÑ
 GwœÑ
 dœÑ
(3.325)
where Œ¶ t
 œÑ
  is the transition matrix. DeÔ¨Åne the state covariance matrix as
P  t
   E
 xt
 xT
t
  (3.326)
which can be rewritten using Equation (3.325) as
P  t
  Œ¶t
 0  P  0  Œ¶T
 t
 0     t
0 Œ¶ t
 œÑ
 GWGTŒ¶T
t
 œÑ
 dœÑ
(3.327)
The time derivative of Equation (3.327) is
ÀôP t
  ‚àÇŒ¶t
 0  ‚àÇt
P  0  Œ¶T
 t
 0   Œ¶t
 0  P  0  ‚àÇŒ¶T
 t
 0  ‚àÇt
 Œ¶t
 t
GWGTŒ¶T
t
 t

   t
0
‚àÇŒ¶ t
 œÑ
 ‚àÇt
GWGTŒ¶T
t
 œÑ
 dœÑ

  t
0 Œ¶ t
 œÑ
 GWGT ‚àÇŒ¶T
t
 œÑ
 ‚àÇt
dœÑ
(3.328)
which can be simpliÔ¨Åed to
ÀôP  t
 
A
 BK
 Œ¶t
 0  P  0  Œ¶T
 t
 0   Œ¶t
 0  P  0  Œ¶T
 t
 0   A
 BK
T
GWGT
 A
 BK

  t
0 Œ¶ t
 œÑ
 GWGTŒ¶T
t
 œÑ
 dœÑ

  t
0 Œ¶ t
 œÑ
 GWGTŒ¶T
t
 œÑ
 dœÑ
A
 BK
 T
(3.329)
or
ÀôP  t
 
A
 BK
 P
P A
 BK
 T
GWGT
(3.330)
which is a differential Lyapunov equation. At steady state, P can be solved from the
algebraic Lyapunov function
¬© 2010 by Taylor and Francis Group, LLC

124
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
 A
 BK
 P
P A
 BK
 T
GWGT
 0
(3.331)
and the cost J is given by the equation
J
  tr
 P  Q
KTRK

(3.332)
Since the cost function J is a function of the feedback gain, one can formulate
an optimization problem to minimize J with respect to the feedback gain matrix
K. Gradient optimization algorithm determine the gradients numerically by Ô¨Ånite
difference or analytical expressions could be provided for the gradients which reduce
the numerical inaccuracies of a Ô¨Ånite difference gradient. The gradient of J with
respect to ki, the ith term of the feedback gain matrix is
‚àÇJ
‚àÇki
 tr
  ‚àÇP
‚àÇki
 Q
KTRK

P‚àÇ
 Q
KTRK

‚àÇki

tr
  ‚àÇP
‚àÇki
 Q
KTRK

P  ‚àÇK
‚àÇki
T
RK
KTR‚àÇK
‚àÇki

(3.333)
where ‚àÇP
‚àÇki is the solution of the Lyapunov equation
 A
 BK
  ‚àÇP
‚àÇki
 ‚àÇP
‚àÇki
A
 BK
 T
 B‚àÇK
‚àÇki
P
 P‚àÇK
‚àÇki
T
BT
 0
(3.334)
Example 3.15: Design a feedback controller which minimizes the cost function
J
  E
 lim
T
 ‚àû
1
T
  T
0
 xT
 q11 q12
q12 q22
 x
 uTRu
 dt

(3.335)
for the rigid body system
Àôx
  0 1
0 0
 x
  0
1
 u
  0
1
 w
(3.336)
where w is a zero-mean white noise process with a covariance
W
  E
 wwT
  (3.337)
The Lyapunov equation to be solved is
  0
1
 k1
 k2
  p11 p12
p12 p22
   p11 p12
p12 p22
  0
 k1
1
 k2
   0 0
0 W
   0 0
0 0

(3.338)
which results in the solution
¬© 2010 by Taylor and Francis Group, LLC

Optimal Control
125
P
  p11 p12
p12 p22
   W
2k1k2
0
0
W
2k2
  (3.339)
The cost function can be written in terms of the P matrix as
J
  W
 q11
 Rk2
1
 2k1k2
  W
 q22
 Rk2
2
 2k2
 (3.340)
The optimal gains are determined by forcing the gradient of J with respect to k1 and
k2 to zero, resulting in the feedback gain matrix
K
   q11
R
 2
 q11
R
  q22
R
  (3.341)
It is clear that the feedback gain is not a function of the covariance of the noise.
Solving the algebraic Riccati equation
 0 0
1 0
 
p11 p12
p12 p22
   p11 p12
p12 p22
  0 1
0 0

  q11 q12
q12 q22
   p11 p12
p12 p22
  0
1

R
 1
 0 1
 p11 p12
p12 p22
   0 0
0 0

(3.342)
which results in the optimal feedback controller for the inÔ¨Ånite time horizon LQR
problem leads to the feedback gain matrix
K
  R
 1
 0 1
 p11 p12
p12 p22
   
q11
R
 2
 q11
R
  q22
R
 (3.343)
which is identical to the solution given by Equation (3.341).
Burl [13] presents a simple development to prove that the optimal feedback gain
for the LQR problem is identical to the stochastic regulator problem (LQR with
noisy input). The beneÔ¨Åt of using the development presented in this section is that
it provides P, the covariance of the states. One can pose constrained optimization
problems where the variance of a state can be required to be less than a designer
speciÔ¨Åed limit.
Example 3.16: The LQR closed-loop dynamics of the system illustrated in Exam-
ple 3.15 is:
Àôx
  0
1
 10  00
 10  96
 x
  0
1
 w
(3.344)
for the weighting matrices:
Q
  1 0
0 1
 and R
  0  01  (3.345)
¬© 2010 by Taylor and Francis Group, LLC

126
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
The time evolution of the covariance matrix is given by the equation:
  Àôp11 Àôp12
Àôp12 Àôp22
   0
1
 10  0
 10  96
  p11 p12
p12 p22
   p11 p12
p12 p22
  0
 10  0
1
 10  96

  0 0
0 1
 (3.346)
when the variance of the Gaussian white noise input is W=1. Figure 3.25 illustrates
the time evolution of the displacement and velocity states by the solid line. The 1œÉ
variation of the states is illustrated by the dashed lines. The initial conditions of the
states are assumed to be known and are x =
 1 0
 . It is clear that the states lie within
the bounds provided by the differential Lyapunov equation.
0
5
10
15
20
25
30
‚àí1
‚àí0 5
0
0 5
1
Time
Displacement
0
5
10
15
20
25
30
‚àí1
‚àí0 5
0
0 5
1
Time
Velocity
Figure 3.25: System Response
3.6
Summary
This chapter reviewed calculus of variations and derived the necessary conditions
for optimality. The Hamiltonian formulation for the design of optimal controllers
was presented which was subsequently used to derive the optimal state feedback
controllers for the LQR problem. A simple technique to solve the Ô¨Ånite time horizon
¬© 2010 by Taylor and Francis Group, LLC

Optimal Control
127
problem was described and benchmark examples were used to illustrate the tech-
nique. The LQR problem has been extensively studied and some of the extensions to
the classic LQR problems were presented. These include the minimum power con-
trol problem, the desensitized LQR problem, and the frequency-shaped LQR prob-
lem, which provided a means to include frequency weighting in the design of the
state feedback controller.
Exercises
3.1
The shape of a cable under its own weight when supported at its end can
be shown to be a catenary using calculus of variations. The inverted catenary
is a near perfect shape of an arch which supports its own weight and is the
shape of the Gateway Arch in St. Louis, Missouri.
«Ü
«á
,
Z
Figure 3.26: Catenary
The equation for catenary (Figure 3.26) can be developed by minimizing the
potential energy of a cable under it own weight:
J
   L
0 œÅgyds
subject to the integral constraint:
¬© 2010 by Taylor and Francis Group, LLC

128
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
  L
0 ds
  L
where L is the length of the cable. Determine the solution y x  when R = 1,
and L = 3 and the height of the pole from the frame of reference = H = 2.
3.2
A pipeline needs to be constructed connecting a source of oil to a port which
lies across a mountain range illustrated in Figure 3.27. The coordinates of
the source and port are:
Source coordinates
 
x
y
z


  
 1
 1
0 2
 
Port coordinates
 
x
y
z


  
1
1
0 2
 
 ‚àí1
‚àí0.5
0
0.5
1
‚àí1
‚àí0.5
0
0.5
1
0
0.5
1
1.5
x axis
y axis
z axis
Pipeline
Figure 3.27: Pipeline Path
To save on the cost of material, the shortest pipeline has to be constructed.
Determine the coordinates of the pipeline which minimize the cost function:
min L
   1
 1
 1
  dy
dx
 2
   dz
dx
2 dx
which is the length of the pipeline, subject to:
z
  1
 x2
 0 2cos
 2œÄx  the model of the mountain range for any value of y.
¬© 2010 by Taylor and Francis Group, LLC

Optimal Control
129
3.3
For the benchmark problem,
 1 0
0 1

¬®x
  1
 1
 1 1

x
  1
0

u design a controller which minimizes the cost function
J
  1
2
  4œÄ
0
Àôu2 dt
so as to satisfy the boundary conditions:
y1
 0  y2
 0  0  and Àôy1
 0  Àôy2
 0  0y1
 t f
   y2
 t f
  y f
  and Àôy1
 t f
   Àôy2
 t f
  0
3.4
Numerically solve the following optimal control problem:
min
x2
 œÄ
 0 1Àôx2
 œÄ
 
  œÄ
0
x2
  Àôx2
 u2
 dt
subject to
¬®x
 x
  u
and
x 0   Àôx 0  1
Plot the evolution of the states, control and the terms of the Riccati matrix.
3.5
A linearized model of a helicopter in hover is [14]:
Àôx
  


 0 0257 0 013
 0 322 0
1 26
 1 765
0
0
0
1
0
0
1
0
0
0
 


A
 

x
 



0 086
 7 408
0
0
 


B
 

u




0 0257
 1 26
0
0
 


G
 

w
Design a linear quadratic regulator assuming no process noise. Assume a
state weighting matrix Q and control weighting matrix R to be identity. Design
a controller when the process noise has a variance Rw = 1 and plot the
system response to an initial condition of x 0   1  0  0  0

and plot the 1œÉ
variation of the Ô¨Årst two states from the covariance dynamics.
3.6
Design a LQR controller for the Ô¨Çexible transmission system shown in Fig-
ure 3.28. The transfer function of the system is
œÜ
 s œÑ
 s

1 491s3
 98 46s2
 704 8s
 1 746e5
s4
 1 036s3
 1292s2
 422 3s
 1 796e5
and the cost function is:
J
   ‚àû
0
 œÜ
 t
 2
 œÑ
 t
2
 dt
Simulate the closed-loop system response to an initial condition of œÜ
 0  1,
ÀôœÜ
 0  0, ¬®œÜ
 0  0, and
...
œÜ
 0  0.
¬© 2010 by Taylor and Francis Group, LLC

130
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
I
W
T
.
.
.
.
Figure 3.28: Flexible Transmission Problem
3.7
Design a desensitized controller for the system shown in Figure 3.29 for a
rest-to-rest maneuver which minimize the cost function
J
  1
2
  10
0
u2 dt
Assume that the springs stiffness K is uncertain. The initial displacement of
the mass and inertia are zero and the Ô¨Ånal rotation of the inertia is required
to be 1 radian.
M
J
K
K
u(t)
Figure 3.29: Two-Degrees of Freedom System
The equations of motion of the system are:
M ¬®x
 Kx
 K
 x
 RŒ∏

 0
J ¬®Œ∏
 KR  x
 RŒ∏
  u
where M is the mass of the block, J is the inertia of the pulley whose radius
is R. u t
  is the torque input to the pulley. Assume M
  1, J
  1, R
  1 and
the nominal stiffness coefÔ¨Åcient is K
  1.
3.8
Design a controller which minimizes the cost function:
J
   t f
0
 1
 u2
 dt
subject to the state equations:
 Àôx1
Àôx2
   0
1
 œâ2 0
 x1
x2
  0
1

u
¬© 2010 by Taylor and Francis Group, LLC

Optimal Control
131
The initial and Ô¨Ånal conditions for the states are:
x 0  0  Àôx
 0  0  x t f
  1  Àôx t f
  0 References
[1] E. W. Weisstein.
Brachistochrone problem. A Wolfram Web resource.
http://mathworld.wolfram.com/BrachistochroneProblem.html.
[2] G. Hansjorg. Christiaan huygens and contact geometry. Nieuw Arch. Wiskd,
5:117, 2005.
[3] A. P. Sage and C. C. White III. Optimum Systems Control. Prentice Hall, 1977.
[4] N. Wiener. Extrapolation, Interpolation, and Smoothing of Stationary Time
Series. Technology Press, Cambridge, MA, 1949.
[5] R. E. Kalman and R. W. Koepcke. Optimal synthesis of linear sampling control
systems using generalized performance indices. Transactions ASME Series D
(J. of Basic Engineering), 80:1820‚Äì1826, 1958.
[6] S. P. Bhat and D. K. Miu. Minimum power and minimum jerk control and its
application in computer disk drives. IEEE Trans. on Magnetics, 27(6):4471‚Äì
4476, 1991.
[7] T. Hindle and T. Singh. Robust minimum power/jerk control of maneuvering
structures. J. of Guid., Cont. and Dyn., 24(4):816‚Äì826, 2001.
[8] W. T. Thomson and M. D. Dahleh. Theory of Vibration with Applications.
Prentice Hall, 1998.
[9] N. K. Gupta.
Frequency-shaped cost functionals:
Extension of linear-
quadratic-Gaussian design methods. J. of Guid., Cont. and Dyn., 3(6):529‚Äì
535, 1980.
[10] G. C. Goodwin anad S. F. Graebe and M. E. Salgado. Control System Design.
Prentice Hall, 2001.
[11] Y. Kim and J. L. Junkins. Introduction to Dynamics and Control of Flexible
Structures. AIAA Education Series, 1993.
[12] A. E. Bryson and R. A. Mills. Linear-quadratic-Gaussian controllers with spec-
iÔ¨Åed parameter robustness. J. of Guid., Cont. and Dyn., 21(1):11‚Äì18, February
1998.
[13] J.B. Burl. Linear Optimal Control: H2 and H‚àûMethods. Addison-Wesley
Longman, 1999.
¬© 2010 by Taylor and Francis Group, LLC

132
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
[14] L. El Ghaoui, A. Carrier, and A. E. Bryson. Linear quadratic minimax con-
trollers. IEEE Trans. on Cont. Systems Tech., 15(4):953‚Äì961, 1992.
¬© 2010 by Taylor and Francis Group, LLC

4
Saturating Control
We know very little, and yet it is astonishing that we know so much,
and still more astonishing that so little knowledge can give us so much
power.
Bertrand Russell (1872‚Äì1970); English philosopher, mathematician
O
PTIMAL control is a phrase used to describe the Ô¨Åeld of study where one en-
deavors to minimize or maximize a cost function subject to the dynamic model,
state and control constraints and has been extensively studied over the past 50 years.
Contributions by Pontryagin and Bellman laid the foundation on which the Ô¨Åeld had
grown rapidly and matured. Table 4.1 lists a few applications in the Ô¨Årst column
and three parameters which are of interest in the optimal control formulation for the
listed applications. A check mark is used to highlight the parameters of interest.
These applications have been selected to motivate the cost functions which will be
presented in this chapter.
Consider a race car pit crew for a Formula 1 racing team. They would like to
minimize the time for their car to complete the racetrack in minimum time, subject
to the constraint that the available fuel is constrained. On the other hand, a subway
railcar that starts and stops frequently requires a control strategy that moves people
as rapidly as possible subject to constraints on the rate of change of acceleration
(jerk), which inÔ¨Çuences passenger comfort. It is clear that different applications de-
mand different performance metrics. In this chapter we will address the problem of
Time
Budget/Fuel
Jerk/Jolt
Race Car
X
X
Desktop Hard Disk Drive
X
X
Airline Industry
X
X
Hubble Telescope
X
X
High-Speed Elevator
X
X
Burt Rutan Voyager
X
Subway Railcar
X
X
Table 4.1: Applications and Metrics of Interest
133
¬© 2010 by Taylor and Francis Group, LLC

134
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
rest-to-rest maneuvers of systems where the control input is subject to saturation con-
straints. Four cost functions will be considered which include: (1) Minimum-Time,
(2) Minimum Fuel/Time, (3) Fuel Limited Time Optimal, and (4) Jerk Limited Time
Optimal Control problems. All the optimal controllers presented in this chapter are
open-loop. For real-world applications, models which are used for the design of
controllers invariably include modeling errors, process and sensor noise, and ini-
tial condition uncertainties. In such situations, open-loop controllers cannot reliably
satisfy terminal state constraint. A hybrid control scheme where the open-loop con-
trollers are used to move the states to the vicinity of desired states and subsequently
a feedback controller is used to asymptotically reach the Ô¨Ånal states, is a potential
approach for obtaining the beneÔ¨Åts of open-loop and closed-loop controllers. These
open-loop controllers can also be used to generate nominal control and state proÔ¨Åles
which in conjunction with a tracking feedback controller can inÔ¨Çuence the states
such that the tracking error asymptotically tends to zero. All of the aforementioned
problems will be solved for the rest-to-rest maneuver of a double integrator which
represents the motion of a rigid body and the Ô¨Çoating oscillator benchmark problem
which captures the characteristics of a maneuvering Ô¨Çexible structure [1].
4.1
Benchmark Problem
m2
m1
k
 y1
 y2
 u
Figure 4.1: Floating Oscillator
The equations of motion of the benchmark Ô¨Çoating oscillator problem illustrated
in Figure 4.1 are
  m1 0
0 m2
   ¬®y1
¬®y2
    k
 k
 k k
   y1
y2
   1
0

u  (4.1)
The state constraint for all the optimization problems considered in this section are
y1
 0   y2
 0   0   and Àôy1
 0   Àôy2
 0   0
y1
 tf
   y2
 tf
  yf
  and Àôy1
 tf
  Àôy2
 tf
  0
(4.2)
¬© 2010 by Taylor and Francis Group, LLC

Saturating Control
135
and the normalized control is subject to the constraint
 1
  u
  1  (4.3)
The nominal values of the parameters of the system are
m1
  m2
  k
  1
(4.4)
The equations of motion can be decoupled by the similarity transformation
Œ∏
  1
2
 y1
 y2
  and q
  1
2
 y2
 y1
 (4.5)
resulting in the equations of motion
¬®Œ∏
  1
2u
  œÜ0u
(4.6a)
¬®q
 2q
  1
2u
  œÜ1u  (4.6b)
and the corresponding boundary conditions are
Œ∏
 0   q  0   0 and ÀôŒ∏
0   Àôq 0   0
Œ∏
tf
   1  q  tf
  0 and ÀôŒ∏
 t f
  Àôq  tf
  0  (4.7)
The decoupled equations are used to derive the constraint equations for the optimiza-
tion problem since this approach can be generalized for any number of modes.
Every section in this chapter will study three problems. The Ô¨Årst corresponds to
the rigid body model given by Equation (4.6a). The next problem studied is the
undamped benchmark problem and Ô¨Ånally, the results of the effect of damping on
the solution to the benchmark problem will be presented.
4.2
Minimum-Time Control
The minimum-time control problem can be stated as [2‚Äì4]:
min J
   tf
0 dt
(4.8a)
subject to
Àôx
  Ax
 Bu
(4.8b)
x 0    x0 and x  tf
  xf
(4.8c)
 1
  u
  1  t
(4.8d)
¬© 2010 by Taylor and Francis Group, LLC

136
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
DeÔ¨Åning the Hamiltonian as:
H
  1
 Œª T
 Ax
 Bu 
 (4.9)
the necessary conditions for optimality can be derived using calculus of variations,
resulting in the equations
Àôx
  ‚àÇH
‚àÇŒª
  Ax
 Bu
(4.10a)
ÀôŒª
  ‚àÇH
‚àÇx
  ATŒª
(4.10b)
u
  sgn
 BTŒª
 (4.10c)
x 0    x0 and x  tf
  xf
(4.10d)
H
  0 at t
  0  (4.10e)
Equation (4.10c) is derived using Pontryagin‚Äôs minimum principle (PMP). The Pon-
tryagin‚Äôs minimum principle (PMP) states that the Hamiltonian (H) should be min-
imized over all possible control input which lie in the set of permissible control U .
This permits including constraints on the control input.
H
 x
  t
  Œª
 t
  u
 t
  t
   H
x
 t
  Œª
 t
  u t
  t
  u t
  U
(4.11)
for all time t
  0
tf
 .
     refer to optimal quantities. The form of control deÔ¨Åned
by Equation (4.10c) is referred to as a bang-bang control since the control switches
between its limits.
4.2.1
Singular Time-Optimal Control
Suppose that there exists an interval of time where the switching function q  t
  is
exactly zero, i.e.,
q  t
  BTŒª
t
  0
 t
  T1 T2
  (4.12)
the Hamiltonian H is not affected by any selection of the control u  t
 , and conse-
quently the interval t
  T1
T2
  is called a singular interval and the resulting prob-
lem is called a singular time-optimal problem. Figure 4.2 schematically illustrates a
singular time-optimal control proÔ¨Åle.
Since, the switching function is identically zeros in the interval
 T1
T2
 , this
implies
dq
dt
  BTAT exp  ATt
 Œª
0    0
(4.13a)
d2q
dt2
  BT
 AT
2 exp  ATt
 Œª
 0    0
(4.13b)
d3q
dt3
  BT
 AT
3 exp  ATt
 Œª
 0    0
(4.13c)
¬© 2010 by Taylor and Francis Group, LLC

Saturating Control
137
0
1
2
3
4
5
‚àí2
‚àí1 5
‚àí1
‚àí0 5
0
0 5
1
1 5
Control
T1
T2
Time
Singular Interval
Switching Function
Figure 4.2: Switching Function for a Singular Time-Optimal Control
   (4.13d)
dn  1q
dtn  1
  BT
 AT
n  1 exp  ATt
 Œª
 0    0  (4.13e)
since the costate equation can be written as
Œª
t
   exp ATt
 Œª
 0   (4.14)
Equation (4.13) can be concisely written as
 B AB A2B
    An  1B
 T exp
  ATt
 Œª
0    0  (4.15)
Since exp ATt
  is nonsingular and Œª
 0   cannot be zero, since it results in a trivial
solution, a singular solution requires that the controllability matrix be singular which
corresponds to an uncontrollable linear time invariant system. Thus, a controllable
system is normal and the resulting time-optimal control is bang-bang.
4.2.2
Rigid Body
With the knowledge that the time-optimal control is bang-bang, the control proÔ¨Åle
can be represented as the output of a time-delay Ô¨Ålter subject to a step input which is
parameterized to generate a bang-bangcontrol proÔ¨Åle. For example, the time-optimal
control proÔ¨Åle for a rest-to-rest maneuver of double integrator,
¬®Œ∏
  œÜ0u
(4.16)
is:
¬© 2010 by Taylor and Francis Group, LLC

138
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
u  t
 1
 2H
 t
 T
  H
t
 2T
 (4.17a)
u  s 1
s
 1
 2exp
  sT
  exp
 2sT
    1
s Gc
 s (4.17b)
which is a single switch bang-bang control proÔ¨Åle which satisÔ¨Åes the constraint that
the control has to lie in the range
 1
  u  t
   1  (4.18)
H is the Heaviside function.
 1
 2e
 sT
 e
 2sT
 U
  s U
s Step
Bang-Bang
Time-Delay Filter
Figure 4.3: Time-Delay Filter Structure
The transfer function Gc
 s  of the time-delay Ô¨Ålter (Figure 4.3) that generates the
bang-bang control proÔ¨Åle can be rewritten as
Gc
 s 
1
 2exp
  sT
  exp
 2sT
   1
 exp
 sT
  2
(4.19)
which has zeros at
s
  0  0   j2nœÄ
T
  where, n
  1  2  3     (4.20)
It should be noted that the two poles at the origin of the rigid body model, are can-
celed by the two zeros of the time-delay Ô¨Ålter, which are also located at the origin.
The switch time is a function of the rigid body displacement Œ∏f , and can be shown
to be
T
  Œ∏f
œÜ0
 (4.21)
Since the Hamiltonian of the system is
H
  1
 Œª1 ÀôŒ∏
 Œª2œÜ0u  (4.22)
the costates satisfy
¬© 2010 by Taylor and Francis Group, LLC

Saturating Control
139
ÀôŒª1
  ‚àÇH
‚àÇŒ∏
  0
(4.23a)
ÀôŒª2
  ‚àÇH
‚àÇÀôŒ∏
  Œª1
(4.23b)
which can be integrated to give
Œª1
 t
   E
(4.24a)
Œª2
 t
   Et
F
 (4.24b)
Since the Hamiltonian is zero at the initial time, we have
H
 0    1
œÜ0Œª2
0 
  0
  Œª2
0 
   1
œÜ0
 (4.25)
Further, since the switching function œÜ0Œª2 should be zero at the switch time T, we
have
œÜ0Œª2
 T
   œÜ0
  ET
  1
œÜ0
   0
(4.26)
which results in the closed form expression for the control
u
  sgn  œÜ0Œª2
 t
    sgn
 1
 œÜ0Œ∏f
t
  1
œÜ0
  (4.27)
The time-optimal control of any linear controllable time invariant system can be
stated as the design of a time-delay Ô¨Ålter so that a set of zeros of the transfer function
of the time-delay Ô¨Ålter cancel all the poles of the system.
4.2.3
Time-Optimal Rest-to-Rest Maneuvers
Many researchers have noted the antisymmetric characteristic of the minimum-
time control proÔ¨Åles designed for rest-to-rest maneuvers for Ô¨Çexible structures with-
out damping [5‚Äì7]. The term antisymmetry refers to proÔ¨Åles which can be generated
by rotating the Ô¨Årst half of the proÔ¨Åle about the mid-maneuver time, by œÄ radians.
For example, a single period of a sinusoid (sin œât
 ) is antisymmetric since the pro-
Ô¨Åle from t=0 to œÄ
œâ when rotated about the point t= œÄ
œâ , which is half the period of
oscillation, by œÄ radians, generates one cycle of the sinusoid.
We Ô¨Årst show that a control proÔ¨Åle that is antisymmetric about the mid-maneuver
time leads to a transfer function of a time-delay Ô¨Ålter with two zeros at the origin of
the s plane. Figure 4.5 illustrates the minimum-time control proÔ¨Åle for an undamped
system with the time delays selected to ensure antisymmetry. The transfer function
of a time-delay Ô¨Ålter (Figure 4.4) containing 2n+2 time-delays (2n+1 switches) is
¬© 2010 by Taylor and Francis Group, LLC

140
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
 ‚àëN
i 0 Ai e
 sTi
 U
  s U
s Step
Bang-Bang
Time-Delay Filter
Figure 4.4: Time-Delay Filter Structure
Gc
 s 1
 2
n
‚àë
i 1
  1  i exp  sTi
  2   1  n  1exp  sTn  1
  2
n
‚àë
i 1
  1  iexp  s 2Tn  1
 Ti
   exp
  2sTn  1
  (4.28)
  t
u
1
 1
T1
T2
2T2
 T1
2T2
Figure 4.5: Three-Switch Antisymmetric Control ProÔ¨Åle
A zero of the transfer function is located at s = 0, as Equation (4.28) goes to zero
at s = 0. The derivative of Equation (4.28) with respect to s is
dGc
 s ds

 2
n
‚àë
i 1
Ti
  1  i exp
  sTi
  2   1  n  1Tn  1exp  sTn  1
  2
n
‚àë
i 1
 2Tn  1
 Ti
   1  i exp  s 2Tn  1
 Ti
   2Tn  1exp
  2sTn  1
  (4.29)
which is also zero at s = 0. Thus, we conclude that Equation (4.28) has at least
two zeros at the origin that cancel the rigid body poles, thus satisfying the velocity
boundary conditions for a rest-to-rest maneuver.
To arrive at equations to cancel the imaginary poles of the system, we substitute
¬© 2010 by Taylor and Francis Group, LLC

Saturating Control
141
s
  œÉ
  jœâ
(4.30)
into Equation (4.28), and equating the real and imaginary parts, we have,
‚Ñú Gc
 s  1
 2
n
‚àë
i 1
  1  i exp  œÉTi
 cos œâTi
 2   1  n  1exp  œÉTn  1
 cos œâTn  1
  2
n
‚àë
i 1
  1  iexp  œÉ
 2Tn  1
 Ti
  cos œâ
 2Tn  1
 Ti
   exp
  2œÉTn  1
 cos  2œâTn  1
   0  (4.31)
‚ÑëGc
 s  2
n
‚àë
i 1
  1  i exp  œÉTi
 sin  œâTi
 2   1  n  1exp
  œÉTn  1
 sin
 œâTn  1
  2
n
‚àë
i 1
  1  i exp  œÉ
 2Tn  1
 Ti
  sin
 œâ
 2Tn  1
 Ti
   exp
  2œÉTn  1
 sin  2œâTn  1
   0
(4.32)
where ‚Ñú  and ‚Ñë  refer to the real and imaginary parts of the argument. As we
require the undamped poles of the system to be canceled by the zeros of the time-
delay Ô¨Ålter transfer function, we substitute œÉ = 0, in Equations (4.31) and (4.32) and
rewrite them as
cos
œâTn  1
  2
n
‚àë
i 1
  1  i cos œâ
 Tn  1
 Ti
    1  n  1
 cos
 œâTn  1
    0   (4.33)
sin œâTn  1
  2
n
‚àë
i 1
  1  i cos œâ
 Tn  1
 Ti
    1  n  1
 cos
 œâTn  1
    0   (4.34)
To cancel poles at œâ =
 jœâ1,
 jœâ2,....,  jœân, we substitute œâi into the coefÔ¨Åcient
of sin  œâTn  1
  in Equation (4.34), which is the same as the coefÔ¨Åcient of cos
 œâTn  1
 in Equation (4.33), which leads to n equations in n
 1 unknowns T1, T2, ..., Tn  1.
The Ô¨Ånal constraint is derived from the system transfer function
y  s u s  Gs (4.35)
so as to satisfy the rigid body boundary condition. The constraint can be written as:
yf
  lim
s 0G s Gc
s  (4.36)
¬© 2010 by Taylor and Francis Group, LLC

142
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
Since the transfer function of the time-delay Ô¨Ålter Gc
 s  has zeros at the locations
of the rigid body poles of the system, the limit value is indeterminate. Repeatedly
apply L‚ÄôHospital‚Äôs rule until the limit is determinate. That is the Ô¨Ånal constraint for
the parameter optimization problem which can be stated as
min J
  Tn  1
(4.37a)
subject to
2
n
‚àë
i 1
  1  i cos œâj
 Tn  1
 Ti
    1  n  1
 cos
 œâjTn  1
   0    œâj
(4.37b)
yf
  lim
s 0G s Gc
s (4.37c)
0
  T1
  T2
     Tn  1
 (4.37d)
4.2.4
Implications of Pole-Zero Cancelation
To illustrate that the parameter optimization problem given by Equation 4.37 is the
same as one derived by requiring the Ô¨Ånal state conditions to be satisÔ¨Åed, consider a
second-order model of an undamped system
M ¬®x
 Kx
  Du
(4.38)
where the mass matrix M is positive deÔ¨Ånite, and K is the stiffness matrix which
is positive deÔ¨Ånite or positive semideÔ¨Ånite. The stiffness matrix is positive semi-
deÔ¨Ånite when the system includes rigid body modes. The second-order system model
given by Equation (4.38) can be represented in a modal form as:
¬®z
  



0 0
0
0 œâ2
1
0 œâ2
2 0
...
 


z
  







œÜ0
œÜ1
œÜ2
...









u
(4.39)
by deÔ¨Åning a transformation x = Œ¶z where Œ¶ is the eigenvector matrix resulting from
the generalized eigenvalue problem of the matrix pair (K,M). The modal equations
¬®z0
  œÜ0u
(4.40)
¬®zj
 œâ2
j zj
  œÜju for j=1,2,    (4.41)
can be represented in the frequency domain, assuming zero initial conditions, as:
Z0
 s   œÜ0
1
s3 Gc
 s (4.42)
Zj
 s  œÜj
1
s s2
 œâ2
j
 Gc
 s for j=1,2,    (4.43)
¬© 2010 by Taylor and Francis Group, LLC

Saturating Control
143
for the control parameterization given by Equation (4.28). Symbolically integrating
the modal equations of motion result in the equations:
z0
 t
  œÜ0
 t2
2
 2
n
‚àë
i 1
  1  i
 t
 Ti
 2
2
H
 t
 Ti
  2
n
‚àë
i 1
  1  i
 t
  2Tn  1
 Ti
  2
2
H
 t
  2Tn  1
 Ti
  (4.44)
   1 n  1
 t
 Tn  1
 2H
 t
 Tn  1
  t
 2Tn  1
 2
2
H
 t
 2Tn  1
  zj
 t

 œÜi
 1
 cos
 œâjt
 œâ2
j
 2
n
‚àë
i 1
  1  i 1
 cos
 œâj
 t
 Ti
  œâ2
j
H
 t
 Ti
 2
n
‚àë
i 1
  1  i 1
 cos
 œâj
 t
  2Tn  1
 Ti
   œâ2
j
H
 t
  2Tn  1
 Ti
   2   1  n  11
 cos
 œâj
 t
 Tn  1
  œâ2
j
H
 t
 Tn  1
 (4.45)
  1
 cos
œâj
 t
 2Tn  1
  œâ2
j
H
 t
 2Tn  1
  for j=1,2,     Evaluating the modal states at the Ô¨Ånal time, result in the equations:
z0
 2Tn  1
   œÜ0
 2T 2
n  1
 2
n
‚àë
i 1
  1  i
 2Tn  1
 Ti
 2
2
   1 n  1
 Tn  1
 2
 2
n
‚àë
i 1
  1  i T 2
i
2
 (4.46)
zj
 2Tn  1
   œÜi
  cos
 œâj2Tn  1
 œâ2
j
 2
n
‚àë
i 1
  1  i
 cos
 œâj
 2Tn  1
 Ti
  œâ2
j
 2
n
‚àë
i 1
  1  i
 cos
 œâjTi
 œâ2
j
 2   1  n  1
 cos œâjTn  1
 œâ2
j
  1
œâ2
j
 for j=1,2,     (4.47)
Since we require zj
 2Tn  1
  to be zero, we have:
zj
 2Tn  1
   0
  cos
œâj2Tn  1
  2
n
‚àë
i 1
  1  i cos œâj
 2Tn  1
 Ti
  (4.48)
 2
n
‚àë
i 1
  1  i cos œâjTi
  2   1  n  1cos œâjTn  1
  1 for j=1,2,     which is identical to Equation (4.31) when œÉ
  0 and œâ
  œâj.
¬© 2010 by Taylor and Francis Group, LLC

144
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
The time derivative of zi
 t
  evaluated at the Ô¨Ånal time is:
Àôzi
 2Tn  1
   œÜi
œâi
 sin œâi2Tn  1
  2
n
‚àë
i 1
  1  i sin œâi
 Tn  1
 Ti
   (4.49)
2
n
‚àë
i 1
  1  i sin œâiTi
  2   1  n  1sin  Tn  1
  for i=1,2,    which is required to be zero at the Ô¨Ånal time for a rest-to-rest maneuver. Equa-
tion (4.49) is identical to Equation (4.32) when œÉ
  0 and œâ
  œâi. Since Equa-
tions (4.31) and (4.32) which are derived by forcing zeros of the time-delay Ô¨Ålter to
cancel the undamped poles of the system are identical to Equations (4.48) and (4.49),
it can be seen that the pole-zero cancelation constraint is equivalent to forcing the
displacement and velocity of the Ô¨Çexible modes to zero at the Ô¨Ånal time. Finally,
Equation (4.46) can be shown to be the same as Equation (4.36) which illustrates
that the boundary conditions for the states of a rest-to-rest maneuver are satisÔ¨Åed by
designing a time-delay Ô¨Ålter whose zeros cancel the poles of the system and which
is required to satisfy the Ô¨Ånal value constraint given by Equation (4.36).
4.2.5
SufÔ¨Åciency Condition
The parameter optimization problem to be solved includes nonlinear constraints
and may have multiple solutions. To verify the optimality of the switch times arrived
at from the parameter optimization problem, the satisfaction of the costate equations
and the optimality conditions which results in the switching control, need to be ver-
iÔ¨Åed. Since the costate equation for the minimum-time optimal control problem for
the system
Àôx
  Ax
 Bu
(4.50)
is
ÀôŒª
  ATŒª
 (4.51)
The optimal control is given by the switching function
BTŒª
 t
  BT exp  ATt
 Œª
0  (4.52)
which is equal to zero at the
 2n
  1   switch times. Collecting the switching time
constraints into one equation, we have:
 






BT exp
  ATT1
 BT exp
  ATT2
 BT exp
  ATT3
    BT exp  AT
 2Tn  1
 T2
  BT exp  AT
 2Tn  1
 T1
   









P
Œª
 0    






0
0
0
   0
0








 (4.53)
¬© 2010 by Taylor and Francis Group, LLC

Saturating Control
145
Thus Œª
 0   has to lie in the null space of the
2n
  1   2n
  2   matrix P. We can
determine the null space of P and use that vector as Œª
 0  , to determine Œª
t
 . Since,
the parameter optimization permits multiple solutions that satisfy the boundary con-
ditions, the control proÔ¨Åle determined from
u  t
 
 sgn
 BTŒª
t
  (4.54)
must switch at the predetermined switch times, to be optimal.
4.2.6
Benchmark Problem
The transfer function of the benchmark problem where the displacement of the
second mass is the output, is
G s  Y2
 s U
s 
1
s2
 s2
 2  (4.55)
which has poles at
s
  0  0   j
 2 (4.56)
The control proÔ¨Åle for a rest-to-rest maneuver with a Ô¨Ånal displacement of yf of
the benchmark problem masses, is parameterized as
u  t
  1
 2H
 t
 T1
  2H
t
 T2
   2H
 t
  2T2
 T1
   H
t
 2T2
 (4.57a)
u  s  1
s
 1
 2exp
  sT1
  2exp
 sT2
  2exp
  s 2T2
 T1
   exp
 2sT2
  (4.57b)
  1
s Gc
 s  (4.57c)
The parameter optimization problem to be solved for the rest-to-rest maneuver of
the undamped Ô¨Çoating oscillator problem
min J
  T2
(4.58a)
subject to
 2cos
 œâ
 T2
 T1
   1
 cos
œâT2
   0
(4.58b)
 2T 2
1
 2T 2
2
 2  2T2
 T1
 2
 2T2
 2
4
  yf
(4.58c)
T2
  T1
  0
(4.58d)
where œâ, the natural frequency of the system is
 2, and yf represents the Ô¨Ånal
displacement of the two masses.
Figure 4.6 illustrates the variations of the switch times and the maneuver time, as
a function of the rigid body displacement. It can be seen that for speciÔ¨Åc maneuvers,
the three switches collapse into a single switch, which is given by the equation
¬© 2010 by Taylor and Francis Group, LLC

146
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
0
10
20
30
40
50
0
5
10
15
20
25
Final Displacement
Switch Times
Figure 4.6: Controller Parameters vs. Displacement
yf
  T 2
1
2
 (4.59)
This single switch control proÔ¨Åle cancels the poles corresponding to the rigid body
and Ô¨Çexible modes. This can be easily explained by studying Equation (4.20) which
lists the location of zeros of a single-switch bang-bang control proÔ¨Åle. Substituting
the switch time given by Equation (4.59) into Equation (4.20), the time-delay Ô¨Ålter
poles are located at
s
  0  0   j 2nœÄ
 2yf
(4.60)
It can be seen that for a system with a natural frequency of œân, we require
2nœÄ
 2yf
  œân
  yf
  2
 nœÄ
œân
 2
(4.61)
to cancel the poles at
 œân j. For the benchmark problem, the system natural fre-
quency is
 2, and the rigid body displacement has to satisfy the equation
yf
  2
  nœÄ
 2
 2
  nœÄ
 2
 (4.62)
Equation (4.61) states that for a system with a natural frequency of œân, there are
numerous maneuvers for which the single switch proÔ¨Åle is time optimal.
¬© 2010 by Taylor and Francis Group, LLC

Saturating Control
147
4.2.7
Effect of Damping
The time-optimal control proÔ¨Åle for systems with damping are no longer antisym-
metric about the mid-maneuver time [8]. With this in mind, the transfer function of
a time-delay Ô¨Ålter which generates the optimal control proÔ¨Åle can be parameterized
as:
Gc
 s  1
 2
N
‚àë
i 1
  1  i exp
  sTi
  exp
  sTN
 1
  (4.63)
where, N is an odd integer. This transfer function has one zero at s = 0. To force the
transfer function to have an additional zero at s = 0, we require
2
N
‚àë
i 1
Ti
  1  i exp
  sTi
 TN
 1exp
  sTN
 1
   0  (4.64)
which is the derivative of Equation (4.63) with respect to s. To have a second zero at
s = 0, the constraint equation to be be satisÔ¨Åed is
2
N
‚àë
i 1
Ti
  1  i
 TN
 1
  0  (4.65)
To cancel the damped poles
s
  œÉk
  jœâk
  where k
  1  2  3     (4.66)
of the system, we require
1
 2
N
‚àë
i 1
  1  i exp  œÉkTi
 cos œâkTi
 exp  œÉkTN
 1
 cos  œâkTN
 1
   0    k (4.67)
2
N
‚àë
i 1
  1  i exp  œÉkTi
 sin  œâkTi
 exp
  œÉkTN
 1
 sin  œâkTN
 1
   0    k
(4.68)
The Ô¨Ånal constraint is arrived at from the rigid body boundary condition which can
be written as:
yf
  lim
s 0G s Gc
s  (4.69)
4.2.8
Example
The transfer function for the damped Ô¨Çoating oscillator is:
G s 
cs
k
m2s4
 2mcs3
 2mks2
 (4.70)
¬© 2010 by Taylor and Francis Group, LLC

148
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
The parameter optimization problem for the damped Ô¨Çoating oscillator is
min J
  T4
(4.71a)
subject to
 2T1
 2T2
 2T3
 T4
  0
(4.71b)
1
 2exp
  œÉT1
 cos œâT1
  2exp
 œÉT2
 cos  œâT2
  2exp
  œÉT3
 cos œâT3
  exp
 œÉT4
 cos œâT4
   0
(4.71c)
 2exp
 œÉT1
 sin
 œâT1
  2exp
 œÉT2
 sin
 œâT2
  2exp
  œÉT3
 sin
 œâT3
  exp
 œÉT4
 sin
 œâT4
   0
(4.71d)
k
  2T 2
1
 2T 2
2
 2T2
3
 T2
4
 4mk
  yf
(4.71e)
T4
  T3
  T2
  T1
  0
(4.71f)
where
s
  œÉ
  jœâ
   c
m
 j
 2k
m
  c2
m2
 (4.72)
0
0.1
0 2
0 3
0.4
0.5
0 8
1
1 2
1.4
1 6
1 8
2
2 2
Damping Ratio
Switch Times
Œ∂ = 0.1513
Œ∂ = 0 2247
Figure 4.7: Controller Parameters vs. Damping Ratio
To study the effect of the damping ratio on the structure of the time-optimal control
proÔ¨Åle, the parameter optimization problem is solved for the damping ratio varying
¬© 2010 by Taylor and Francis Group, LLC

Saturating Control
149
from zero to one [9, 10]. The spring stiffness is assumed to be k = 50 and the rigid
body displacement yf = 0.5. Figure 4.7 plots the variation of the switch times and the
maneuver time as a function of the damping ratio. It is clear that for small and large
magnitude of the damping ratio, the time-optimal control includes three switches.
However, for a certain region of the damping ratio, the time-optimal control proÔ¨Åle
includes Ô¨Åve switches. Figure 4.8 illustrates the switching function and the corre-
sponding time-optimal control proÔ¨Åle for three values of the damping ratios. It can
be conjectured that as the damping ratio is increased, two switches are introduced
towards the end of the maneuver. As the damping ratio is further increased, two
switches near the middle of the maneuver coalesce resulting in a three-switch con-
trol proÔ¨Åle.
0
0.5
1
1.5
2
2.5
‚àí1
0
1
Time (sec)
Control Input
Switching Function
(i) Œ∂ = 0.1
0
0.5
1
1.5
2
2.5
‚àí1
0
1
Time (sec)
Control Input
Switching Function
(ii) Œ∂ = 0.2
0
0.5
1
1.5
2
2.5
‚àí1
0
1
Time (sec)
Control Input
Switching Function
(iii) Œ∂ = 0.4
Figure 4.8: Typical Solutions
The time-optimal control proÔ¨Åle for the damped benchmark problem is given by
¬© 2010 by Taylor and Francis Group, LLC

150
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
the equation
u
  sgn  BTŒª
 t

(4.73)
which indicates that the control input changes sign when the switching function
BTŒª
 t
  passes through zero. With the variation of certain parameters in the con-
trol problem, switches can be introduced or eliminated from the control structure. If
there exists a control proÔ¨Åle transition created by switches appearing at the initial or
Ô¨Ånal time of the control input, the equation that has to be satisÔ¨Åed is
BTŒª
 ttran
  0
(4.74)
at the initial or Ô¨Ånal time respectively, since only one switch can enter from either
end of the time boundaries. The variation of the costates with respect to the system
parameters is assumed to be smooth. Since the costates are smooth functions of
time, if the switches appear in between the initial and Ô¨Ånal time, then two switches
are introduced simultaneously and the transition occurs when the equations [10]
BTŒª
 t
  0
(4.75a)
d
 BTŒª
 t
  dt
 0
(4.75b)
are satisÔ¨Åed. Equation (4.75a) is the constraint that forces the value of the switching
function to be zero at the transition point, and Equation (4.75b) indicates that the
slope of the switching curve at the transition point should also be zero.
A parameter optimization problem is solved where the parameters to be solved
for are the damping ratio and the time which corresponds to when Equations (4.75a)
and (4.75b) are simultaneously satisÔ¨Åed. Figure 4.9 illustrates the transition of the
time-optimal control proÔ¨Åle from a three-switch to a Ô¨Åve-switch control proÔ¨Åle as the
damping is increased. Figure 4.10 corresponds to the transition from a Ô¨Åve switch to
a three switch control proÔ¨Åle as the damping is increased.
DeÔ¨Åning fuel consumed as
  tf
0
 u   dt, it is clear that the bang-bang control proÔ¨Åle
corresponds to a large consumption of fuel. In applications where the available fuel
is limited such as satellites, laptop computers, hybrid or plug-in cars, and so forth,
control policies which maximize the operation life or range of the application be-
tween recharge would be the optimization objective. A judicious balance between
fuel consumed and maneuver time can be posed as a fuel/time optimal control prob-
lem. The next section addresses this problem.
4.3
Fuel/Time Optimal Control
The minimum fuel/time optimal control problem can be stated as [11‚Äì14]:
¬© 2010 by Taylor and Francis Group, LLC

Saturating Control
151
0
0.5
1
1.5
2
2.5
‚àí1
‚àí0.8
‚àí0.6
‚àí0.4
‚àí0.2
0
0.2
0.4
0.6
0.8
1
Control Input
Switching Function
Time (sec)
Figure 4.9: Transition Control ProÔ¨Åle
0
0.5
1
1.5
2
2.5
‚àí1
‚àí0.8
‚àí0.6
‚àí0.4
‚àí0.2
0
0.2
0.4
0.6
0.8
1
Control Input
Switching Function
Time (sec)
Figure 4.10: Transition Control ProÔ¨Åle
min J
   tf
0
 1
 Œ±
 u   dt
(4.76a)
subject to
Àôx
  Ax
 Bu
(4.76b)
x 0    x0 and x  tf
  xf
(4.76c)
 1
  u
  1
 t
(4.76d)
where Œ± is a weighting parameter which prescribe a penalty which has to be imposed
on the fuel consumed relative to the maneuver time. Œ± = 0, corresponds to the time-
optimal control problem and when Œ±
  ‚àû, the problem corresponds to a fuel optimal
¬© 2010 by Taylor and Francis Group, LLC

152
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
control. DeÔ¨Åning the Hamiltonian as
H
  1
 Œ±
 u   Œª T
 Ax
Bu 
 (4.77)
the necessary conditions for optimality can be derived using calculus of variations,
resulting in the equations
Àôx
  ‚àÇH
‚àÇŒª
  Ax
 Bu
(4.78a)
ÀôŒª
  ‚àÇH
‚àÇx
  ATŒª
(4.78b)
u
  dez
 BTŒª
Œ±
 (4.78c)
x 0    x0 and x  tf
  xf
(4.78d)
H
 0    0  (4.78e)
where dez is the deadzone function (Figure 4.11) deÔ¨Åned as
 
œà
œÜ
1
-1
-1
1
Figure 4.11: Deadzone Function
œÜ
  dez œà

  







œÜ
 0
if
 œà
   1
œÜ
  sgn œà
 if
 œà
   1
0
  œÜ
  1
if œà
  1
 1
  œÜ
  0
if œà
 1
(4.79)
Equation (4.78c) is derived using Pontryagin‚Äôs minimum principle (PMP) and re-
sults in a bang-off-bang control proÔ¨Åle since the control is constrained to its limiting
values and zero.
4.3.1
Singular Fuel/Time Optimal Control
Suppose that there exists an interval of time where the switching function q  t
  is
exactly
 Œ±, i.e.,
¬© 2010 by Taylor and Francis Group, LLC

Saturating Control
153
q  t
  BTŒª
t
 
 Œ±
 t

 T1 T2
  (4.80)
the control input does not change the value of the Hamiltonian in the interval
 T1 T2
 ,
resulting in a singular fuel/time optimal control proÔ¨Åle. Figure 4.12 schematically
illustrates a singular fuel/time optimal control proÔ¨Åle for a weighting parameter of
Œ±
  0  5.
0
0.5
1
1.5
2
2.5
3
3.5
‚àí1
‚àí0 8
‚àí0 6
‚àí0.4
‚àí0 2
0
0 2
0.4
0 6
0 8
1
Control
T2
T1
‚àíŒ±
Time
Singular Interval
Switching Function
Figure 4.12: Switching Function for a Singular Fuel/Time Optimal Control
Since, the switching function is identically equal to
 Œ± in the interval
 T1 T2
 , this
implies
dq
dt
  BTAT exp  ATt
 Œª
0    0
(4.81a)
d2q
dt2
  BT
 AT
2 exp  ATt
 Œª
 0    0
(4.81b)
d3q
dt3
  BT
 AT
3 exp  ATt
 Œª
 0    0
(4.81c)
   (4.81d)
dn  1q
dtn  1
  BT
 AT
n  1exp  ATt
 Œª
 0    0
(4.81e)
since the costate equation can be written as
Œª
t
   exp ATt
 Œª
 0   (4.82)
¬© 2010 by Taylor and Francis Group, LLC

154
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
Equation (4.81) can be concisely written as
 B AB A2B A3B
 T AT exp
  ATt
 Œª
0    0  (4.83)
Since exp ATt
  is nonsingular and Œª
 0   cannot be zero, since it results in a trivial
solution, a singular solution requires that the controllability matrix be singular which
corresponds to an uncontrollable system, or the A matrix be singular. Since the class
of problem being studied here include rigid body modes, the A matrix is singular.
To preclude the existence of a singular interval for a linear system with multiple
damped Ô¨Çexible modes and a rigid body modes, consider the modal form of the
system:
Àôx
  Ax
 Bu
(4.84)
where
A
  









0 1
                 0 0
                   0
1
            œâ2
1
 2Œ∂1œâ1
                  0
1
            œâ2
2
 2Œ∂2œâ2
                    ...
 









 B
  









0
œÜ0
0
œÜ1
0
œÜ2
...
 









(4.85)
and the costate equation is







ÀôŒª1
ÀôŒª2
ÀôŒª3
ÀôŒª4
...
 





   









0 0
             1 0
                0
 œâ2
1
          1
 2Œ∂1œâ1
               0
 œâ2
2
          1
 2Œ∂2œâ2
                ...
 
















Œª1
Œª2
Œª3
Œª4
...
 





(4.86)
From Equation (4.86), we have
Œª1
  C
(4.87a)
Œª2
  Ct
 D
(4.87b)
Œª4
  A1eŒ∂1œâ1t sin  œâ1t
  B1eŒ∂1œâ1t cos œâ1t
 (4.87c)
Œª6
  A2eŒ∂2œâ2t sin  œâ2t
  B2eŒ∂2œâ2t cos œâ2t
 (4.87d)
...
(4.87e)
and the switching function is
¬© 2010 by Taylor and Francis Group, LLC

Saturating Control
155
BTŒª
  œÜ0Œª2
 œÜ1Œª4
 œÜ2Œª6
    (4.88)
which can be rewritten as
BTŒª
  œÜ0
  Ct
 D
 œÜ1
 A1eŒ∂1œâ1t sin  œâ1t
  B1eŒ∂1œâ1t cos
 œâ1t
   œÜ2
A2eŒ∂2œâ2t sin  œâ2t
  B2eŒ∂2œâ2t cos
 œâ2t
      (4.89)
For a singular control to exist, the switching function should be
BTŒª
  Œ±
 t

 T1 T2
 (4.90)
which, assuming œÜi
   0, can only be satisÔ¨Åed by the following set of parameters
C
  A1
  B1
  A2
  B2
      0   and D
  Œ±
œÜ0
(4.91)
which results in a trivial solution. Thus a multi-mode controllable linear system
cannot support a singular fuel/time optimal control. Thus, we have shown that the
necessary conditions for optimality conÔ¨Çicts with the condition for the existence of
singular intervals, thus, precluding singular intervals.
4.3.2
Rigid Body
With the knowledge that the time-optimal control is bang-off-bang, the control
proÔ¨Åle can be represented as the output of a time-delay Ô¨Ålter subject to a step input
which is parameterized to generate a bang-off-bang control proÔ¨Åle. For example, the
fuel/time optimal control proÔ¨Åle for a double integrator, for a rest-to-rest maneuver
is:
u  t
  1
 H
 t
 T1
  H
 t
  2T2
 T1
   H
t
 2T2
 (4.92a)
u  s  1
s
 1
 exp
  sT1
  exp
  s 2T2
 T1
   exp
 2sT2
    1
s Gc
 s (4.92b)
which is a two-switch antisymmetric bang-off-bang control proÔ¨Åle which satisÔ¨Åes
the constraint that the control has to lie in the range
 1
  u  t
   1  (4.93)
The rigid body boundary condition leads to
yf
  œÜ0
2
  2T 2
1
 4T1T2
 (4.94)
and the resulting cost function is
J
  2Œ±T1
  1
2T1
 2yf
œÜ0
 2T 2
1
 (4.95)
¬© 2010 by Taylor and Francis Group, LLC

156
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
The parameter T1, which optimizes the cost function is given by the equation
dJ
dT1
  0
(4.96)
which results in
T 2
1
 yf
œÜ0
 2Œ±
 1 
 (4.97)
Since the Hamiltonian of the system is
H
  1
 Œ±
 u   Œª1 ÀôŒ∏
 Œª2œÜ0u  (4.98)
the costate equations are
ÀôŒª1
  ‚àÇH
‚àÇŒ∏
  0
(4.99a)
ÀôŒª2
  ‚àÇH
‚àÇÀôŒ∏
  Œª1
 (4.99b)
which can be integrated to give
Œª1
 t
   E
(4.100a)
Œª2
 t
   Et
F
 (4.100b)
Since the Hamiltonian is zero at the initial time, we have
H
 0    1
Œ±
œÜ0Œª2
0 
  0
  Œª2
0 
  1
Œ±
œÜ0
  F
 (4.101)
Further, since the switching function œÜ0Œª2 should be
 Œ± at the switch time T1, we
have
œÜ0Œª2
 T1
   œÜ0
  ET1
  1
 Œ±
œÜ0
   Œ±
(4.102)
which can be solved for E,
E
   2Œ±
 1
œÜ0yf
(4.103)
which results in the closed form expression for the control
u
  dez œÜ0Œª2
 t
 Œ±
   dez
 œÜ0
Œ±
 2Œ±
 1
œÜ0yf
t
  1
 Œ±
Œ±
  (4.104)
Figure 4.13 illustrates the tradeoff between fuel consumed and maneuver time
for varying Œ± and the Ô¨Ånal displacement yf . It is clear that as Œ± increases which
¬© 2010 by Taylor and Francis Group, LLC

Saturating Control
157
corresponds to an increase on the penalty on the fuel consumed, the maneuver time
increases. This graph can be used to locate the knee of the curve for the selection
of Œ±. Moving to left of the knee of the curve results in an rapid increase in the fuel
consumed.
0
20
40
60
80
100
120
140
0
1
2
3
4
5
6
7
8
9
yf
Œ±
Maneuver Time
Fuel Consumed
Figure 4.13: Fuel/Time Trade-Off
4.3.3
Fuel/Time Optimal Rest-to-Rest Maneuver
As in the case of time-optimal control proÔ¨Åles for undamped systems, the fuel/time
optimal control proÔ¨Åle for undamped Ô¨Çexible structures with a rigid body mode is
antisymmetric about the mid-maneuver time (Figure 4.14) and this information is
exploited in the parameterization of the transfer function of a time-delay Ô¨Ålter which
generates a bang-off-bang proÔ¨Åle when subject to a unit step input [15]. The transfer
function is
Gc
 s 1
 n
‚àë
i 1
 exp
  sTi
  n
‚àë
i 1
 exp  s 2Tn  1
 Ti
   exp
  2sTn  1
  (4.105)
The transfer function has two zeros at s
  0 since
Gc
 s
  0    dGc
ds
    s 0
  0  (4.106)
¬© 2010 by Taylor and Francis Group, LLC

158
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
  t
u
1
 1
T1
T2
T3
2T4
 T3
2T4
 T2
2T4
 T1
2T4
Figure 4.14: Fuel/Time Optimal Control ProÔ¨Åle
which cancel the rigid body poles of the system. To cancel the modes corresponding
to the Ô¨Çexible modes at
s
  œÉ
  jœâ
(4.107)
we have,
‚Ñú Gc
 s  1
 n
‚àë
i 1
 exp  œÉTi
 cos  œâTi
 
n
‚àë
i 1
 exp
  œÉ
 2Tn  1
 Ti
  cos œâ
 2Tn  1
 Ti
   exp
  2œÉTn  1
 cos 2œâTn  1
   0  (4.108)
‚ÑëGc
 s  

n
‚àë
i 1
 exp
  œÉTi
 sin
 œâTi
 
n
‚àë
i 1
 exp
  œÉ
 2Tn  1
 Ti
  sin  œâ
 2Tn  1
 Ti
   exp
  2œÉTn  1
 sin
 2œâTn  1
   0  (4.109)
For undamped modes, we substitute œÉ
  0 into Equations (4.108), (4.109), and sim-
plify to arrive at the constraints
2cos
œâTn  1
  n
‚àë
i 1
 cos
 œâ
 Tn  1
 Ti
   cos
 œâTn  1
    0
(4.110)
2sinœâTn  1
  n
‚àë
i 1
 cos
 œâ
 Tn  1
 Ti
   cos
 œâTn  1
    0
(4.111)
The Ô¨Ånal constraint to satisfy the rigid body boundary conditions is derived as in
the case of time-optimal control, resulting in the equation
¬© 2010 by Taylor and Francis Group, LLC

Saturating Control
159
yf
  lim
s 0G s Gc
s  (4.112)
where G s  is the system transfer function.
4.3.4
SufÔ¨Åciency Conditions
As in the case of the design of time-optimal control, the parameter optimization
problem for the fuel/time optimal control problem can result in multiple solutions,
since the constraints are nonlinear. To corroborate the optimality of the control pro-
Ô¨Åle, the rest of the necessary conditions for optimality have to be veriÔ¨Åed. This
includes the deadzone function which deÔ¨Ånes the optimal control in terms of the
optimal costates. The costates for the system
Àôx
  Ax
 Bu
(4.113)
are
ÀôŒª
  ATŒª
 (4.114)
The switching function can therefore be represented as
BTŒª
  BT exp  ATt
 Œª
0   (4.115)
which has to equal
 Œ± at each switch time. Thus Œª
 0   can be solved from the
equation
 






BT exp  ATT1
 BT exp  ATT2
 BT exp  ATT3
    BT exp
  AT
 2Tn  1
 T2
  BT exp
  AT
 2Tn  1
 T1
   






Œª
 0 









 Œ±
 Œ±
 Œ±
    Œ±
 Œ±
 






(4.116)
We can determine Œª
 0   from Equation (4.116) and thus Œª
t
 . If the control proÔ¨Åle
determined from
u
  dez
 BTŒª
 t

Œ±
 (4.117)
switches at the times determined from the parameter optimization problem, then the
solution is optimal.
4.3.5
Benchmark Problem
With the knowledge that the fuel/time optimal control proÔ¨Åle is bang-off-bang,
we construct a time-delay Ô¨Ålter whose output is bang-off-bang when it is subject to a
step-input. The amplitudes of the time-delayed signals are constrained by the bounds
¬© 2010 by Taylor and Francis Group, LLC

160
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
on the control, requiring the determination of the time-delays to completely specify
the time-delay Ô¨Ålter.
To deÔ¨Åne the time-delay Ô¨Ålter completely, one can formulate a constrained pa-
rameter optimization problem, where the parameters to be determined are the time-
delays. To eliminate any residual vibration of the system, the complex poles located
at
 jœâ have to be canceled by a complex conjugate pair of zeros of the time-delay
Ô¨Ålter leading to the Ô¨Årst constraint. The next constraint, to satisfy the boundary con-
ditions, is arrived at by integrating the rigid body equation of motion. Singh and
Vadali [16] have illustrated that the transfer function of a time-delay Ô¨Ålter that gen-
erates a control proÔ¨Åle which is antisymmetric about its mid-maneuver time, has a
minimum of two zeros at the origin of the complex plane, which cancel the rigid body
poles of the system. This fact is exploited to reduce the dimension of the parameter
search space.
We consider the problem of reorientation, i.e., a rest-to-rest maneuver with bound-
ary conditions
x1
 0   x2
 0   0  x1
 tf
   x2
 tf
  Œ∏f
2œÜ0
Àôx1
 0   Àôx2
 0   0  Àôx1
 tf
   Àôx2
 tf
  0
(4.118)
  t
u
1
 1
T2
 T1
T2
 T1
T2
2T2
Figure 4.15: Two-Switch Fuel/Time Optimal Control ProÔ¨Åle
The two-switch control proÔ¨Åle for a fuel/time optimal (Figure 4.15) problem is
parameterized in frequency domain as
u
  1
s
 1
 e
 s T2
 T1
  e
 s T2
 T1
  e
 2sT2
 (4.119)
where T2 is the mid-maneuver time and T2
 T1 is the Ô¨Årst switch time. The transfer
function of the time-delay Ô¨Ålter that generates the bang-off-bang control proÔ¨Åle is
G s 
1
 e
 s T2
 T1
  e
 s T2
 T1
  e
 2sT2
  (4.120)
From the Laplace transform of the decoupled rigid-body mode (Equation 4.6a), we
have
¬© 2010 by Taylor and Francis Group, LLC

Saturating Control
161
s2Œ∏
 s  œÜ0
s
 1
 e
 s T2
 T1
  e
 s T2
 T1
  e
 2sT2
 (4.121)
The inverse Laplace transform leads to
Œ∏
 t
   œÜ0
t2
2
 H
 t
  T2
 T1
   t
  T2
 T1
  2
2
(4.122)
 H
 t
  T2
 T1
   t
  T2
 T1
  2
2
 H
 t
 2T2
  t
 2T2
 2
2
 where H
 t
 Ti
  is the Heaviside‚Äôs unit step function. The Ô¨Ånal state of Œ∏ is Œ∏
 2T2
 = Œ∏f , which leads to
Œ∏f
  œÜ0
 T 2
2
 T 2
1
 (4.123)
which can be rewritten as
Œ∏f
œÜ0
  T2
 T1
  T2
 T1
  (4.124)
To cancel the vibration mode, we substitute s = jœâ into Equation (4.120) and
equating the real and imaginary parts to zero, we have
1
 cos
 œâ
 T2
 T1
   cos
 œâ
 T2
 T1
   cos
2œâT2
   0
(4.125)
and
 sinœâ
T2
 T1
   sin œâ
 T2
 T1
   sin2œâT2
   0
(4.126)
respectively. Equations (4.125) and (4.126) can be simpliÔ¨Åed to
2cos
œâT2
   cos œâT1
  cos
œâT2
    0
(4.127)
and
2sinœâT2
   cos œâT1
  cos
œâT2
    0
(4.128)
respectively, leading to the constraint equation
 cos
œâT1
  cos
œâT2
   0  (4.129)
Solving Equation (4.129), we have
œâT2
  œâT1
 2nœÄ
  n
  1   2      
 ‚àû
(4.130)
substitute Equation (4.130) into Equation (4.124), and we have
T1
   œâŒ∏f
4nœÄœÜ0
  nœÄ
œâ
for œâT2
  œâT1
 2nœÄ
nœÄ
œâ
  œâŒ∏f
4nœÄœÜ0 for œâT2
  œâT1
 2nœÄ
(4.131)
¬© 2010 by Taylor and Francis Group, LLC

162
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
The next step includes determining the integer n. The cost function to be mini-
mized is
J
   2T2
0
 1
 Œ±
 u   dt
(4.132)
which can be rewritten as
J
  2T2
 2Œ±
 T2
 T1
 (4.133)
or
J
  œâŒ∏f
2nœÄœÜ0
  2
4Œ±
 nœÄ
œâ
for œâT2
  œâT1
 2nœÄ
 1
 2Œ±
 œâŒ∏f
2nœÄœÜ0
  2nœÄ
œâ
for œâT2
  œâT1
 2nœÄ
(4.134)
Since the cost J is a unimodal function for positive n (negative n are not valid as
they imply a negative cost J), we can solve for nopt that minimizes J, assuming n is
continuous. The integer values that Ô¨Çank nopt are used to determine the optimum n.
Assuming n is continuous, we require
dJ
dn
  0
(4.135)
for optimality, which leads to
n2
    œâ
œÄ
2
Œ∏f
 2  4Œ±
 œÜ0
for œâT2
  œâT1
 2nœÄ
  œâ
œÄ
 2
 1  2Œ±
Œ∏f
2œÜ0
for œâT2
  œâT1
 2nœÄ
(4.136)
Since n is an integer, the value of J corresponding to the integer values of n that Ô¨Çank
the value of n estimated by Equation (4.136) are evaluated to determine the optimum
n. A point to note is that the optimal control proÔ¨Åle leads to displacement of the
rigid body mode at mid-maneuver time which is half of the total maneuver and the
displacement of the vibratory mode which is zero at the mid-maneuver time.
Since, the structure of the control proÔ¨Åle for the rigid body and the benchmark
problem are identical, it is informative to plot the variation of the switch times and
the maneuver time as a function of Œ±. Figure 4.16 illustrates the variation of the Ô¨Årst
switch time for the rigid body (dashed line) and the benchmark problem. It can be
seen that the switch time remains constant for a range of Œ±. Figure 4.17 illustrates
the variation of the maneuver time versus Œ±. It can be seen that for some values of Œ±,
the maneuver time of the benchmark problem is smaller than the rigid body system.
However, as is shown in Figure 4.18, the variation of the cost function of the rigid
body system is either equal to or smaller than the cost of the benchmark problem.
Figure 4.18 also illustrates the variation of the parameter n as a function of Œ±.
It was shown in Section 4.2 that the time-optimal control proÔ¨Åle, which corre-
sponds to Œ±=0, is a three-switch bang-bang proÔ¨Åle, which is antisymmetric about
the mid-maneuver time. Since, the fuel/time optimal control proÔ¨Åle should in the
limit tend toward the time-optimal control proÔ¨Åle (Œ±
  0), it is clear that a transi-
tion control proÔ¨Åle should exist which can generate the two-switch bang-off-bang,
¬© 2010 by Taylor and Francis Group, LLC

Saturating Control
163
0
10
20
30
40
50
60
70
80
90
0
0.5
1
1.5
Benchmark Problem Solution 
Rigid-Body Solution
Œ±
First Switch Time
Figure 4.16: Switch Time Variation
0
10
20
30
40
50
60
70
80
90
0
2
4
6
8
10
12
14
16
18
20
Rigid-Body Solution
Œ±
Maneuver Time
Benchmark Problem Solution
Figure 4.17: Maneuver Time Variation
and the three-switch bang-bang control proÔ¨Åle. Figure 4.14 which illustrates a six-
switch control proÔ¨Åle, which is antisymmetric about the mid-maneuvertime, satisÔ¨Åes
the requirement of the transition control proÔ¨Åle.
For Œ± = 0, T1 = T2, and T3 = 2T4
 T3, resulting in the time-optimal control structure
(Figure 4.5). For Œ± greater than Œ±cr, the switch times T2 = T3, generating the control
proÔ¨Åle of Figure 4.15. Œ±cr is the critical value of Œ± at which the structure of the
¬© 2010 by Taylor and Francis Group, LLC

164
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
0
5
10
15
20
25
30
35
40
45
50
0
5
10
15
20
25
30
n = 1 
n = 2 
n = 3 
n = 4 
Rigid‚àíBody Solution 
Œ±
Cost Function
Figure 4.18: Cost Variation
control proÔ¨Åle changes from that of Figure 4.14 to that represented in Figure 4.15.
The antisymmetric fuel/time optimal control proÔ¨Åle for small Œ± is parameterized
as
u
  1
s
 1
 e
 s T4
 T3
  e
 s T4
 T2
  e
 s T4
 T1
  e
 s T4
 T1
  e
 s T4
 T2
  e
 s T4
 T3
  e
 2sT4
 (4.137)
where T4 is the mid-maneuver time. Integrating the rigid-body mode with the control
given by Equation (4.137), the constraints for the parameter optimization problem
can be shown to be
Œ∏f
  œÜ0
 T 2
4
 T2
3
 T 2
2
 T 2
1
 (4.138)
which is derived from the rigid-body boundary condition, and
 cos
 œâT3
  cos
œâT2
  cos
 œâT1
  cos
œâT4
   0
(4.139)
which forces the transfer function of the time-delay Ô¨Ålter to cancel the frequency
corresponding to the vibratory mode of the system.
A parameter optimization problem is formulated to solve for the time delays. The
cost function to be minimized is
J
   tf
0
 1
 Œ±
 u   dt
  2T4
 2Œ±
  T4
 T3
  T2
 T1
  (4.140)
subject to constraints given by Equations (4.138) and (4.139). Since the constraints
are nonlinear and there are more parameters than constraints, there exist a potential
¬© 2010 by Taylor and Francis Group, LLC

Saturating Control
165
for the existence of multiple solutions. To prove optimality of the control proÔ¨Åle,
the control proÔ¨Åle predicted by the switching function should coincide with that pre-
dicted by the parameter optimization. To determine the switching function, we need
to solve for the initial costates. We know that
Œª
 t
  exp
  ATt
 Œª
0  (4.141)
We also know that the switching function has to satisfy
 


BT exp
  AT
 T4
 T3
  BT exp
  AT
 T4
 T2
  BT exp
  AT
 T4
 T2
  BT exp
  AT
 T4
 T3
   

Œª
 0 








 Œ±
Œ±
 Œ±
Œ±
 





(4.142)
Solving for Œª
 0   from Equation (4.142) and substituting in
u
  dez BT exp  ATt
 Œª
0   Œ±
 (4.143)
we can arrive at the control proÔ¨Åle which should coincide with the one predicted by
the parametrization problem, for optimality.
4.3.6
Determination of Œ±cr
The vector differential equation representing the equations of motion of the two-
mass-spring system is
Àôx
  Ax
 Bu
 u    1  (4.144)
where x
  ‚Ñú4, u is a scalar and the matrices A and B are
A
  


0 1
0
0
0 0
0
0
0 0
0
1
0 0
 œâ2 0
 


(4.145)
and
B
  


0
œÜ0
0
œÜ1




(4.146)
respectively. The optimal control is given by
u  t
 
 dezBTŒª
t
  Œ±
 (4.147)
where Œª
 t
  is the costate vector which is given by the equation
Œª
 t
  exp
  ATt
 Œª
0  (4.148)
¬© 2010 by Taylor and Francis Group, LLC

166
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
We know that the control structure of Figure 4.19 is generated by the switching
function BTŒª
 t
  also shown in Figure 4.19.
0
0 5
1
1.5
2
2.5
3
3 5
4
4.5
‚àí1.5
‚àí1
‚àí0.5
0
0.5
1
1.5
Switching Function
Control Profile
Time
Figure 4.19: Six-Switch Control ProÔ¨Åle
Œ±cr corresponds to the Œ± when the switching function BTŒª
 t
  equals values of Œ±
and ‚ÄìŒ± at times tcr and Tf ‚Äìtcr respectively (Figure 4.20), i.e.,
BTŒª
 tcr
  BT exp  ATtcr
 Œª
0    Œ±cr
(4.149)
BTŒª
 Tf
 tcr
  BT exp  AT
 Tf
 tcr
  Œª
0    Œ±cr
(4.150)
and to ensure that the switching function touches the lines parallel to the abscissa
with ordinate intercepts of
 Œ±cr, tangentially, we require the slope of BTŒª
 t
  at tcr
and Tf
 tcr be equal to zero (Figure 4.20), i.e.,
d
dt
 BTŒª
 t
      t
 tcr

 BTAT exp  ATtcr
 Œª
0    0
(4.151)
and
d
dt
 BTŒª
 t
      t
 Tf
 tcr

 BTAT exp  AT
 Tf
 tcr
  Œª
0    0
(4.152)
Solving Equations (4.149) through (4.152), which are rewritten as
¬© 2010 by Taylor and Francis Group, LLC

Saturating Control
167
0
1
2
3
4
5
‚àí2
‚àí1.5
‚àí1
‚àí0.5
0
0.5
1
1.5
2
tcr
Tf
Œ±cr
‚àíŒ±cr
Control Input 
Switching Function 
tcr
Time (sec)
Figure 4.20: Large Œ± Control ProÔ¨Åle
 


BT exp
  ATtcr
 BT exp  AT
 Tf
 tcr
   BTAT exp  ATtcr
  BTAT exp
  AT
 Tf
 tcr
   

Œª
0    





Œ±cr
 Œ±cr
0
0
 





(4.153)
we arrive at tcr and Œ±cr. To determine Œª
 0   we consider the following equations:
BT exp
  AT
 T2
 T1
  Œª
 0 

 Œ±
(4.154)
and
BT exp
  AT
 T2
 T1
  Œª
 0 
 Œ±
(4.155)
which are satisÔ¨Åed at the switch time
 T2
  T1
  and
 T2
  T1
  respectively. Equa-
tions (4.154) and (4.155) in conjunction with the switching function evaluated at
time T2 which can be shown to be [15],
BT exp  ATT2
 Œª
 0 
 0
(4.156)
and the Hamiltonian evaluated at time = 0:
BTŒª
 0    1
 Œ±
(4.157)
can be used to solve for Œª
0  .
Figures 4.16 and 4.17 indicate that the switch times T1 and T2 remain constant
for small Œ±, i.e., for the range of Œ± greater than Œ±cr and less than Œ± = 9.87 (for a
maneuver of Œ∏f = 1). Equations (4.154) through (4.157) can now be represented as
¬© 2010 by Taylor and Francis Group, LLC

168
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
PŒª
 0  
 





 Œ±
Œ±
0
 1
 Œ±
 





(4.158)
where
P
  


BT exp  AT
 T2
 T1
  BT exp  AT
 T2
 T1
  BT exp
  ATT2
 BT
 


(4.159)
Since T1 and T2 are constant for Œ± greater than Œ±cr, and less than 9.87, P is a constant
matrix. Thus, Œ±cr and tcr are solved from the equation
 


BT exp  ATtcr
 P
 1
BT exp
  AT
 Tf
 tcr
  P
 1
 BTAT exp  ATtcr
 P
 1
 BTAT exp  AT
 Tf
 tcr
  P
 1
 









 Œ±cr
Œ±cr
0
 1
 Œ±cr
 





 






Œ±cr
 Œ±cr
0
0
 





(4.160)
For Œ∏f = 1, Figure 4.21 illustrates the variation of the structure of the control proÔ¨Åle.
As expected, for Œ± = 0, the control proÔ¨Åle is bang-bang. Increasing Œ±, the penalty
on fuel consumed results in the three switches of the bang-bang control splitting into
six switches of a bang-off-bang proÔ¨Åle. Further increase in Œ± leads to a transition oc-
curring at Œ±cr = 0.6824, where the two pulses near the mid-maneuver time collapse,
resulting in a two-switch bang-off-bang control proÔ¨Åle.
4.3.7
Effect of Damping
As in the case of the time-optimal control, the structure of the fuel/time optimal
control proÔ¨Åle is not antisymmetric about the mid-maneuver time. This implies that
as the weighting parameter Œ± of the fuel/time cost function is varied, there will be
a transition when two switches of the bang-off-bang control proÔ¨Åle collapse. How-
ever, unlike the undamped case where four switches collapsed simultaneously, in the
damped case two switches will collapse at a time. To conÔ¨Årm this conjecture, the
damped benchmark problem is studied with a damping ratio of Œ∂ = 0.1.
Two switches of the bang-off-bang control proÔ¨Åle collapse when
f
 x 
 BT exp  ATtcr
 Œ±cr
 BTAT exp  ATtcr
   0
(4.161)
To solve for the vector of parameters x =
 tcr Œ±cr
 T, the Newton-Rhapson method is
given by:
xi 1
  xi
  ‚àáxi f

 1 f
 xi
 (4.162)
¬© 2010 by Taylor and Francis Group, LLC

Saturating Control
169
0
2
4
6
‚àí1
‚àí0.5
0
0.5
1
0
1
2
3
4
‚àí1
‚àí0 5
0
0 5
1
Œ±
0.0
0 6284
0
2
4
6
8
10
‚àí1
‚àí0 5
0
0 5
1
Figure 4.21: Spectrum of Fuel/Time Optimal Control
is used, which converges rapidly to the transition point. Figure 4.22 illustrates the
transition of the structure of the control proÔ¨Åle with the transition occurring at Œ±cr
= 0.5268, and the corresponding tcr is 3.4169 seconds. It can be seen that only the
second positive pulse collapses.
0
1
2
3
4
5
‚àí2
‚àí1.5
‚àí1
‚àí0.5
0
0.5
1
1.5
2
Time (sec)
Œ±cr
‚àíŒ±cr
Control Input 
Switching Curve 
tcr
Figure 4.22: Transition of the Control ProÔ¨Åle
The variation of the switch times of the fuel/time optimal control proÔ¨Åle as a func-
¬© 2010 by Taylor and Francis Group, LLC

170
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
tion of the weighting parameter Œ± is shown in Figure 4.23. It can been seen that at
the dashed line there is a transition from a six-switch control proÔ¨Åle to a four-switch
control proÔ¨Åle.
10
‚àí1
10
0
10
1
0
1
2
3
4
5
6
7
8
Œ±cr = 0.5268
Œ±
Switch Times
Figure 4.23: Switch Time Variation
Consider the problem of planning a control strategy for a race car to complete a
race circuit in minimum time, with a Ô¨Ånite amount of fuel. The fuel/time optimal
control problem where a soft constraint is imposed on the fuel consumed would not
be the appropriate problem formulation. One approach is to search for the value
of Œ± which solves the fuel/time optimal control problem with exactly the permitted
fuel usage. But this requires solving the fuel/time problem many times. Another
approach is to minimize time while setting a hard constraint on the fuel. To impose
hard constraints on the fuel consumed, an integral constraint has to be imposed.
The next section will develop the fuel limited, minimum-time control problem and
illustrates that the optimal solution corresponds to a speciÔ¨Åc penalty imposed on fuel
consumed in the fuel/time optimal control formulation.
4.4
Fuel Limited Minimum/Time Control
The minimum time control problem with constraints on the fuel, can be stated as:
¬© 2010 by Taylor and Francis Group, LLC

Saturating Control
171
min J
   tf
0 dt
(4.163a)
subject to
Àôx
  Ax
 Bu
(4.163b)
  tf
0
 u  dt
  U
(4.163c)
x 0    x0 and x  tf
  xf
(4.163d)
 1
  u
  1  t
(4.163e)
where U represents the maximum available fuel for the maneuver [17]. For maneu-
vers where U is less than or equal to the fuel used for the unconstrained time-optimal
control problem, the fuel consumed for the maneuver will be the maximum permit-
ted. The fuel constraint can be rewritten as a differential equation
Àôœà
  u  (4.164)
with the boundary conditions
œà
 0   0  œà
 tf
  U
 (4.165)
DeÔ¨Åning the Hamiltonian as:
H
  1
 Œª T
 Ax
Bu 
 Œº
 u   (4.166)
the necessary conditions for optimality can be derived using calculus of variations,
resulting in the equations
Àôx
  ‚àÇH
‚àÇŒª
  Ax
 Bu
(4.167a)
Àôœà
  ‚àÇH
‚àÇŒº
  u  (4.167b)
ÀôŒª
  ‚àÇH
‚àÇx
  ATŒª
(4.167c)
ÀôŒº
  ‚àÇH
‚àÇœà
  0
(4.167d)
u
  dez
 BTŒª
Œº
 (4.167e)
x 0    x0 and x  tf
  xf
(4.167f)
œà
 0   0 and œà
tf
   U
(4.167g)
H
 0    0  (4.167h)
Equation (4.167e) is derived using Pontryagin‚Äôs minimum principle (PMP).
¬© 2010 by Taylor and Francis Group, LLC

172
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
4.4.1
Singular Fuel Constrained Time-Optimal Control
The same proof which illustrated that Ô¨Çexible structures with rigid body modes
cannot support singular fuel/time optimal control is valid for the fuel constrained
time-optimal control.
4.4.2
Rigid Body
With the knowledge that the fuel constrained time-optimal control is bang-off-
bang, the control proÔ¨Åle can be represented as the output of a time-delay Ô¨Ålter subject
to a step input which is parameterized to generate a bang-off-bang control proÔ¨Åle.
For example, the fuel constrained time-optimal control proÔ¨Åle for a double integrator,
¬®Œ∏
  œÜ0u  (4.168)
which in state-space form is
 Àôx1
Àôx2
   0 1
0 0


x1
x2
   0
œÜ0

u  (4.169)
has the Hamiltonian:
H
  1
 Œª1x2
 Œª2œÜ0u
  Œº
 u   (4.170)
The resulting costate equations are
ÀôŒª1
  0
(4.171)
ÀôŒª2
  Œª1
(4.172)
ÀôŒº
  0
(4.173)
which can be solved in closed form resulting in the equations
Œª1
 t
   E
(4.174)
Œª2
 t
   Et
F
(4.175)
Œº
 t
  G (4.176)
Since the boundary conditions for the rest-to-rest maneuver of the system are
Œ∏
 0   0   ÀôŒ∏
0   0  Œ∏
tf
   Œ∏f
  ÀôŒ∏
 tf
  0  (4.177)
and since the Hamiltonian is equal to zero for all time, we have
H
 0   1
Œª2
0  œÜ0
 Œº
 0
(4.178)
which results in the solution
Œª2
0  
 1
  Œº
œÜ0
  F
 (4.179)
¬© 2010 by Taylor and Francis Group, LLC

Saturating Control
173
Since the switching curve œÜ0Œª2 is a straight line, the fuel constrained time-optimal
control proÔ¨Åle is a two-switch bang-off-bang proÔ¨Åle and can be parameterized as
shown in Figure 4.24. The initial control pulse accelerates the mass to reach a cruis-
ing velocity which reduce time to the desired terminal location while consuming
half of the available fuel, while the antisymmetric pulse is needed to decelerate the
system to settle into the desired terminal state.
  t
u
1
 1
T1
T2
 T1
T2
Figure 4.24: Fuel Constrained Time-Optimal Control ProÔ¨Åle
u  t
  1
 H
 t
 T1
  H
 t
  T2
 T1
   H
t
 T2
 (4.180a)
u  s  1
s
 1
 exp
  sT1
  exp
  s T2
 T1
   exp
 sT2
    1
s Gc
 s (4.180b)
which is antisymmetric about the mid-maneuver time and satisÔ¨Åes the terminal ve-
locity constraint. Integrating the second order model of the rigid body system for the
parameterized control input, we have
Œ∏
 t
  œÜ0
2
 t2
  t
 T1
 2H
 t
 T1
   t
  T2
 T1
  2H
 t
  T2
 T1
   t
 T2
 2H
 t
 T2
  (4.181)
which when evaluated at the Ô¨Ånal time T2 should satisfy the displacement boundary
condition
Œ∏
 T2
   Œ∏f
  T 2
2
  T2
 T1
 2
 T 2
1
  (4.182)
Since the time-optimal control will consume the maximum permitted fuel, we have
the constraint
2T1
  U
(4.183)
Solving Equations (4.182) and (4.183), we have
T1
  U
2
  T2
  2Œ∏f
œÜ0U
  U
2
 (4.184)
¬© 2010 by Taylor and Francis Group, LLC

174
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
Since, the switching function œÜ0Œª2 at the Ô¨Årst and second switch time should be -Œº
and Œº respectively, we have
Œª2
 T1
   EU
2
  1
  Œº
œÜ0
   Œº
œÜ0
(4.185)
Œª2
 T2
 T1
   E 2Œ∏f
œÜ0U
  1
  Œº
œÜ0
  Œº
œÜ0
(4.186)
which can be solved for E and Œº resulting in the solutions
Œº
  2Œ∏f
œÜ0U2
  1
2
  G
(4.187)
E
   2
œÜ0U
 (4.188)
The closed form expression for the control is
u
  dez
 2œÜ0U2
4Œ∏f
 œÜ0U2
  2
U t
 1
  Œº
  (4.189)
The variation of Œº as a function of maximum permitted fuel is plotted using Equa-
tion (4.187), is shown in Figure 4.25. For a maneuver distance of Œ∏f = 10, we can
see from Equation (4.187), that Œº equals zero when
U
  4Œ∏f
œÜ0
  80
  8  9443
(4.190)
which corresponds to the unconstrained time-optimal solution.
4.4.3
Fuel Constrained Time-Optimal Rest-to-Rest Maneuver
Since the structure of the fuel constrained time-optimal control is similar to the
fuel/time optimal control when the fuel limits are smaller than the fuel consumed
by the unconstrained time-optimal control, the same constraints are valid for this
problem. Parameterizing the control proÔ¨Åle as
u
  1
s Gc
 s  1
s
 1
 n
‚àë
i 1
 exp  sTi
  n
‚àë
i 1
 exp
  s 2Tn  1
 Ti
   exp
  2sTn  1
   (4.191)
The resulting parameter optimization problem for an undamped system is
¬© 2010 by Taylor and Francis Group, LLC

Saturating Control
175
10
‚àí1
10
0
10
1
10
‚àí2
10
‚àí1
10
0
10
1
10
2
10
3
10
4
Maximum Permitted Fuel U
Œº
Œ∏f = 10
Figure 4.25: Variation of Œº vs. U
min J
  Tn  1
(4.192a)
subject to
(4.192b)
N
‚àë
i 1
 cos
 œâj
 Tn  1
 Ti
   cos
 œâjTn  1
   0   œâj
  j
  1  2    m
(4.192c)
2
 T1
 ‚àë
i 2  4  6      Ti 1
 Ti
    U
(4.192d)
yf
  lim
s 0G s Gc
s (4.192e)
Ti
 Ti 1
  0
 i
(4.192f)
where G s  is the input-output transfer function of the system.
4.4.4
SufÔ¨Åciency Conditions
Unlike the fuel/time optimal control, where the weighting parameter Œ± is known,
the corresponding costate Œº for the fuel constrained time-optimal control problem,
is unknown. To verify optimality of the solutions generated by the parameter opti-
mization problem, the rest of the necessary conditions which deal with the costates
need to be satisÔ¨Åed.
For optimality, the switching function
BTŒª
  BT exp
  ATt
 Œª
0  (4.193)
¬© 2010 by Taylor and Francis Group, LLC

176
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
should equal
 Œº at every switch time. We can solve for Œª
 0   and Œº from the equa-
tion:
P
 Œª
 0  Œº
 








BT exp
  ATT1
  1
BT exp
  ATT2
  1
BT exp
  ATT3
  1
   BT exp  AT
 2Tn  1
 T2
   1
BT exp  AT
 2Tn  1
 T1
   1
 






Œª
 0  Œº
 
 






0
0
0
   0
0
 






(4.194)
which requires calculating the null space of the matrix P. If the control proÔ¨Åle deter-
mined from
u
  dez
 BTŒª
 t

Œº
 (4.195)
switches at the times determined from the parameter optimization problem, then the
solution is optimal.
4.4.5
Benchmark Problem
In this section, the fuel constrained time-optimal control of the benchmark prob-
lem is presented. With the knowledge that the fuel constrained time-optimal control
proÔ¨Åle has a bang-off-bangstructure, the control proÔ¨Åle for the undamped system can
be parameterized to reÔ¨Çect the antisymmetry about the mid-maneuver time. Since,
the control proÔ¨Åle is three-switch bang-bang when an unlimited fuel supply is avail-
able, one can conjecture that the three-switch bang-bang control proÔ¨Åle morphs to a
six-switch bang-off-bang proÔ¨Åle (Figure 4.14). Having parameterized the bang-off-
bang control proÔ¨Åle, the following parameter optimization problem can be solved to
determine a candidate optimal solution:
min J
  T4
(4.196a)
subject to
cos œâ
 T4
 T3
   cos
 œâ
 T4
 T2
   cos
 œâ
 T4
 T1
   cos
œâT4
   0
(4.196b)
 2T 2
1
 2T 2
2
 2T2
3
 4T3T4
 4T2T4
 4T1T4
4
  xf
(4.196c)
2T1
 2  T3
 T2
   U
(4.196d)
T4
  T3
  T2
  T1
  0
(4.196e)
where œâ =
 2 is the natural frequency of the system and xf =1, is the Ô¨Ånal displace-
ment of the masses. With the knowledge that the time-optimal control proÔ¨Åle for the
benchmark problem for a unit displacement is
¬© 2010 by Taylor and Francis Group, LLC

Saturating Control
177
u t
  1
 2H
 t
 1 0026  2H
 t
 2 1089  2H
 t
 3 2152  H
t
 4 2178  (4.197)
the fuel consumed is U = 4.2178. Therefore, the effect of variation of the permitted
fuel is studied for U
  4.2178.
0.5
1
1.5
2
2.5
3
3.5
4
4.5
0
1
2
3
4
5
6
7
Fuel Usage
Switch Times
Figure 4.26: Variation of Switch Times vs. U
Figure 4.26 illustrates the variation of the switch times as a function of the fuel
usage. It can be seen that the second and third switches coalesce as do the fourth
and the Ô¨Åfth switches for a permitted fuel of U = 0.9003 at which point the con-
trol proÔ¨Åle is a two-switch bang-off-bang proÔ¨Åle. The two-switch control proÔ¨Åle is
parameterized as shown in Figure 4.27.
  t
u
1
 1
T2
 T1
T2
 T1
2T2
Figure 4.27: Two-Switch Fuel Constrained Time-Optimal Control ProÔ¨Åle
¬© 2010 by Taylor and Francis Group, LLC

178
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
u
  1
s
 1
 e
 s T2
 T1
  e
 s T2
 T1
  e
 2sT2
  (4.198)
To cancel the mode with frequency œâ, we require
 cos œâT1
  cos
œâT2
   0
(4.199)
which results in the equation
œâT2
  œâT1
 2nœÄ
 (4.200)
The next constraint is the satisfaction of the fuel constraint which results in the equa-
tion
2  T2
 T1
   U
 (4.201)
Solving for T1 from Equations (4.200) and (4.201), we have
œâ
 U
2
 T1
   œâT1
 2nœÄ
(4.202)
which results in the equation
T1
  nœÄ
œâ
  U
4
 (4.203)
To satisfy the rigid-body boundary conditions, we require,
Œ∏f
  œÜ0
 T 2
2
 T 2
1
 (4.204)
which leads to
xf
  nœÄU
2œâ
 (4.205)
for the benchmark problem.
For fuel usage smaller than U = 0.9003, one can conjecture that in the Ô¨Årst half of
the maneuver, no negative pulse will exist since these tend to decelerate the motion of
the system. However, a two-switch control proÔ¨Åle cannot be optimal since it cannot
satisfy all the necessary constraints except for displacements which match that given
by Equation (4.205).
¬© 2010 by Taylor and Francis Group, LLC

Saturating Control
179
  t
u
1
 1
T1
T2
T3
2T4
 T3
2T4
 T2
2T4
 T1
2T4
Figure 4.28: Type 2 Fuel Constrained Time-Optimal Control ProÔ¨Åle
Figure 4.28 represents the six-switch parameterization of the bang-off-bang pro-
Ô¨Åle, which results in the parameter optimization problem:
min J
  T4
(4.206a)
subject to
 cos
 œâ
 T4
 T3
   cos
œâ
T4
 T2
   cos
 œâ
 T4
 T1
   cos
œâT4
   0
(4.206b)
 2T 2
1
 2T2
2
 2T2
3
 4T3T4
 4T2T4
 4T1T4
4
  xf
(4.206c)
2T1
 2  T3
 T2
   U
(4.206d)
T4
  T3
  T2
  T1
  0
(4.206e)
Equation (4.205) states that a two-switch bang-off-bang control proÔ¨Åle is optimal for
fuel usage of
U
  2œâxf
nœÄ
 (4.207)
The variation of the switches for U satisfying the constraint 2œâxf
2œÄ
  U
  2œâxf
œÄ
is
illustrated in Figure 4.29.
It can be seen from Figure 4.29 that the second and third switches coalesce and
the fourth and Ô¨Åfth switches coalesce, resulting in a two-switch control proÔ¨Åle, as U
is lowered.
Figure 4.30 illustrates typical control proÔ¨Åle and the corresponding switching
functions for the fuel constrained time-optimal control.
4.4.6
Effect of Damping
As was illustrated in the time-optimal and fuel/time optimal cases, the addition
of damping into the system results in the loss of symmetry about the mid-maneuver
time. To illustrate the variations of the structure of the fuel constrained time-optimal
control proÔ¨Åle, the benchmark problem with a damping coefÔ¨Åcient c = 0.1 is stud-
ied. For a rest-to-rest maneuver with a Ô¨Ånal displacement of unity, the time-optimal
¬© 2010 by Taylor and Francis Group, LLC

180
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
0.5
0 6
0.7
0.8
0.9
1
0
2
4
6
8
10
12
Fuel Usage
Switch Times
Figure 4.29: Variation of Switch Times vs. U
0
1
2
3
4
5
‚àí1
‚àí0.8
‚àí0.6
‚àí0.4
‚àí0.2
0
0.2
0.4
0.6
0.8
1
U  1.6
Time (sec)
Input, Switching Function
(i) Type 1 Control
0
1
2
3
4
5
6
7
8
‚àí1
‚àí0.8
‚àí0.6
‚àí0.4
‚àí0.2
0
0.2
0.4
0.6
0.8
1
U  0.7
Time (sec)
Input, Switching Function
(ii) Type 2 Control
Figure 4.30: Typical Fuel Limited Time-Optimal Control ProÔ¨Åles
controller‚Äôs fuel consumption is:
  tf
0
 u  dt
  4  2211
where the control is constrained to lie in the range
 1
  u
  1. For a fuel constraint
smaller than 4.2211, it is clear that a six-switch bang-off-bang controller
u  s  1
s
 1
 e
 sT1
 e
 sT2
 e
 sT3
 e
 sT4
 e
 sT5
 e
 sT6
 e
 sT7
 (4.208)
is optimal. As the available fuel is reduced the switch time change as illustrated in
Figure 4.31. For a permitted fuel ofU
  1  1458, the fourth- and Ô¨Åfth-switch coalesce
and the resulting optimal control proÔ¨Åle is parameterized as:
¬© 2010 by Taylor and Francis Group, LLC

Saturating Control
181
0.4
0.6
0.8
1
1.2
1.4
1.6
1.8
0
2
4
6
8
10
12
Fuel Usage
Switch Times
Figure 4.31: Variation of Switch Times vs. U
u  s  1
s
 1
 e
 sT1
 e
 sT2
 e
 sT3
 e
 sT6
 e
 sT7
 (4.209)
As the available fuel is reduced to U
  0  85, two new switches are introduced result-
ing in a six-switch bang-off-bang proÔ¨Åle parameterized as:
u  s  1
s
 1
 e
 sT1
 e
 sT2
 e
 sT3
 e
 sT4
 e
 sT5
 e
 sT6
 e
 sT7
 (4.210)
When the permitted fuel is below U
  0  587, the structure of the fuel constrained
time-optimal control proÔ¨Åle for the damped benchmark proÔ¨Åle reduces to a four-
switch bang-off-bang proÔ¨Åle parameterized by Equation (4.209). Figure 4.31 illus-
trates the spectrum of the structure of the optimal control proÔ¨Åle over a permitted
fuel ranging from 0.4 to 1.5.
One can see the change in the structure of the optimal control proÔ¨Åle as a function
of varying the damping constant. Figure 4.32 illustrates the variation of the switch
times of a six- to a four-switch-control proÔ¨Åle at c
  0  156, with increasing damping
constant.
Biomimetics or Bio inspired design has captured the imagination of numerous
researchers in the robotics and control communities. Emulate nature and you cannot
go wrong is an axiom numerous researchers have taken to heart. Recently, Ben-Itzak
and Karniel [18] illustrated that humans reaching motion is one which is jerk limited.
This has prompted the focusing of research interest in the development of control
strategies which satisfy constraints on jerk. Jerk which also goes by the moniker jolt,
¬© 2010 by Taylor and Francis Group, LLC

182
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
0.1
0.15
0.2
0.25
0.3
0.35
0
1
2
3
4
5
6
7
8
Damping Coefficient
Switch Times
Figure 4.32: Variation of Switch Times vs. Damping Constant
surge, or lurch inÔ¨Çuences passenger comfort in people mover systems (the Handbook
of Railway Vehicle Dynamics lists it at 1 5m sec3 [19]), and is a factor in motion of
mechanisms when considering its longevity. This motivates development of jerk
limited controller which will be presented in the next section.
4.5
Jerk Limited Time-Optimal Control
Jerk is the time rate of change of the inertia forces, i.e., the derivative of the con-
trol input and is a measure of the impact level. Impact in mechanical systems is
manifested in the form of noise and reduces life due to fatigue. For various Ô¨Çexible
structures, higher level of jerk correlates to exciting the higher modes of the system
which commonly are commonly referred to as ringing. For systems where the ac-
tuator is not an on-off device, but can be throttled, jerk limited time-optimal control
proÔ¨Åles are desirable since they can reduce noise and the consequences of fatigue.
Furthermore, the actuators are better able to track the optimal control proÔ¨Åle since
bandwidth limitations make it difÔ¨Åcult to track bang-bang proÔ¨Åles.
This section addresses the problem of design of jerk limited time-optimal control
proÔ¨Åles for rest-to-rest motion of systems. To include limits on the rate of change
of the control, a new state is introduced into the model which represents the control
input to the system. The rate of change of the control is now the input to be de-
¬© 2010 by Taylor and Francis Group, LLC

Saturating Control
183
termined to satisfy the boundary conditions of the rest-to-rest maneuver. The state
space system
Àôx
   A
 x
  B
 u
(4.211)
is augmented with the equation
Àôu
  v
(4.212)
resulting in the new state space model
Àôx
  Ax
 Bv
(4.213a)
A
  A
  B
 0 0
   B
  0
1
   x
  x
 u

 (4.213b)
The optimal control problem is now stated as:
min J
   tf
0 dt
(4.214a)
subject to
Àôx
  Ax
 Bv
(4.214b)
x
  0    x
 0
  u  0    0  x
  tf
  x
 f
  and u  tf
  0
(4.214c)
 1
  u
  1  t
(4.214d)
 J
  v
  Àôu
  J
 t
(4.214e)
where J is the maximum permitted jerk [20,21]. DeÔ¨Åning the Hamiltonian as
H
  1
 Œª T
 Ax
Bv
 Œº1
 u
 1    Œº2
 u
 1   (4.215a)
H
  1
 Œª
 T
 A
 x
  B
 u
  œàv
  Œº1
 u
 1    Œº2
 u
 1  (4.215b)
where
 Œº1
  0
if u
 1
  0
Œº1
  0
if u
 1
  0
(4.215c)
and
 Œº2
  0
if
 u
 1
  0
Œº2
  0
if
 u
 1
  0
(4.215d)
where Œª T
  Œª
  œà
 T , the necessary conditions for optimality can be derived using
calculus of variations, resulting in the equations
¬© 2010 by Taylor and Francis Group, LLC

184
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
Àôx
  ‚àÇH
‚àÇŒª
  Ax
 Bv
(4.216a)
ÀôŒª
   ‚àÇH
‚àÇx
   A
 TŒª
 (4.216b)
Àôœà
  ‚àÇH
‚àÇu
  



 B
 TŒª
 if
 u   1
  0
 B
 TŒª
   Œº1
if u
 1
  0
 B
 TŒª
   Œº2
if
 u
 1
  0
(4.216c)
x
  0   x
 0 and x
  tf
  x
 f
(4.216d)
u  0    0 and u  tf
  0
(4.216e)
H
 0    0  (4.216f)
The subarc of v t
  when u  t
  is not
 1, is called an interior arc and the control v t
 is said to lie on a boundary arc, otherwise. The optimal jerk proÔ¨Åle (v) when the
inequality constraint
 1
  u
  1 is satisÔ¨Åed, which corresponds to an interior arc is
v
  J sgn  Œª TB 

 J sgn  œà
 (4.217)
For the situation when u =
 1, i.e., when v t
  lies on a boundary arc, the control is
determined from the equations
d
dt
 u
 1    Àôu
  v
  0  when u
 1
  0
(4.218a)
d
dt
  u
 1     Àôu
  v
  0  when
 u
 1
  0
(4.218b)
(4.218c)
4.5.1
Rigid Body
The augmented state space model of the jerk limited time-optimal control for the
rigid body
¬®Œ∏
  œÜ0u
(4.219)
or
...
Œ∏
  œÜ0v
  since Àôu
  v
 (4.220)
is
 

Àôx1
Àôx2
Àôu
 

 

0 1 0
0 0 œÜ0
0 0 0



	

x1
x2
u
 

 

0
0
1

v
 (4.221)
and the corresponding Hamiltonian is:
H
  1
 Œª1x2
 Œª2œÜ0u
 œàv
  Œº1
 u
 1    Œº2
 u
 1   (4.222)
¬© 2010 by Taylor and Francis Group, LLC

Saturating Control
185
The resulting costate equations are
ÀôŒª1
  0
(4.223a)
ÀôŒª2
  Œª1
(4.223b)
Àôœà
  



 œÜ0Œª2
if
 u   1
  0
 œÜ0Œª2
  Œº1
if u
 1
  0
 œÜ0Œª2
  Œº2
if
 u
 1
  0
(4.223c)
4.5.1.1
Case 1
For the situation where u is not at its constraint boundary, the costate equations
can be solved in closed form resulting in the equations
Œª1
 t
   E
(4.224)
Œª2
 t
   Et
F
(4.225)
œà
 t
  E
2 t2
 Ft
 G (4.226)
since Œº1 and Œº2 are zero. Since the boundary conditions for the rest-to-rest maneuver
of the system are
Œ∏
 0   0   ÀôŒ∏
0   0  Œ∏
tf
   Œ∏f
  ÀôŒ∏
 tf
  0  u  0    0  u  tf
  0  (4.227)
and since the Hamiltonian is equal to zero for all time, we have
H
 0   1
œà
0  J
  0
(4.228)
which results in the solution
œà
 0 
 G
  1
J
(4.229)
Since the switching curve œà is a quadratic curve, the jerk limited time-optimal
control proÔ¨Åle is at a maximum a three switch bang-bang proÔ¨Åle when u is not at its
constraint boundary and can be parameterized as (Figure 4.33(i)):
v t
  J
1
 2H
 t
 T1
  2H
t
  2T2
 T1
   H
 t
 2T2
  (4.230a)
v s  J
s
1
 2exp
  sT1
  2exp
 s 2T2
 T1
   exp
  2sT2
    J
s Gc
 s (4.230b)
which is symmetric about the mid-maneuver time as shown in Figure 4.33(i). Since
Gc
 s  should cancel the three poles at the origin of the augmented system we require
¬© 2010 by Taylor and Francis Group, LLC

186
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
  t
v
J
 J
T1
T2
2T2
 T1
2T2
(i) Parameterization of the Jerk ProÔ¨Åle
  t
u
T1
2T2
 T1
1
 1
(ii) Control ProÔ¨Åle
Figure 4.33: Case 1: Jerk Limited Time-Optimal Control
Gc
 0   1
 2exp
 0T1
  2exp
 0 2T2
 T1
   exp
  0  2T2
     0
(4.231a)
dGc
 s ds
    s 0
  2T1
 2  2T2
 T1
  2T2
  2  T2
 2T1
   0
(4.231b)
d2Gc
 s ds2
    s 0
  2T12
 2  2T2
 T1
 2
 2T22
  4T2
 T2
 2T1
   0
(4.231c)
Thus when T2 = 2T1, all the poles at the origin are canceled and the terminal velocity
constraint is satisÔ¨Åed. Integrating the second-order model of the rigid body system
for the parameterized control input, we have
Œ∏
 t
   JœÜ0
6
 t3
 2  t
 T1
 3H
 t
 T1
  2 t
  2T2
 T1
  3H
 t
  2T2
 T1
    t
 2T2
 3H
 t
 2T2
  (4.232)
which when evaluated at the Ô¨Ånal time 2T2 should satisfy the displacement boundary
condition
Œ∏
 2T2
   Œ∏f
  2JœÜ0T13
(4.233)
since T2 = 2T1.
Since, the switching function œà
 t
  at the Ô¨Årst and second switch times should be
0, we have
¬© 2010 by Taylor and Francis Group, LLC

Saturating Control
187
œà
 T1
   ET 2
1
2
 FT1
  1
J
  0
(4.234)
œà
 2T2
 T1
   E
 2T2
 T1
 2
2
 F
 2T2
 T1
   1
J
  0
(4.235)
which can be solved for E and F resulting in the solutions
 
E
F
 
 


 2
3JT 2
1
 4
3JT1
 

 




 2 3
 2JœÜ0
2
3J 3
 Œ∏f
2
  4 3
 2JœÜ0
3J 3
 Œ∏f
 



(4.236)
4.5.1.2
Case 2
There exists boundary conditions for the rest-to-rest maneuver for which the con-
straint is active. The optimal jerk proÔ¨Åle (v) is a bang-off-bang proÔ¨Åle as shown in
Figure 4.34(i).
Since, the optimal control proÔ¨Åle is a combination of a number of time-delayed
ramp functions, the requirement of time-optimality can be satisÔ¨Åed by ensuring that
u  t
  is in saturation for as much time as possible during the maneuver. This implies
that
T1
  1
J
  2T3
 T2
  T2
  2T1
  2
J
(4.237)
assuming that
 1
  u  t
   1 and the maximum permitted jerk is J. The response of
the system given by Equation (4.221), to a step input of magnitude J is
 

x1
 t
 x2
 t
 u t
  





JœÜ0t3
 6
JœÜ0t2
 2
Jt
 

 


k1t3
k2t2
Jt
 

 (4.238)
Thus, the states of Equation (4.221) at the Ô¨Ånal time, to the jerk proÔ¨Åle parameterized
as
v  t
  J
1
 H
 t
 T1
  H
 t
 T2
  H
t
 2T3
 T2
   H
t
 2T3
 T1
   H
 t
 2T3
  (4.239a)
v s  J
s
1
 exp
  sT1
  exp
  sT2
  exp
 s 2T3
 T2
   exp
 s 2T3
 T1
   exp
  2sT3
  (4.239b)
are
¬© 2010 by Taylor and Francis Group, LLC

188
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
  t
v
T1
T2
T3
2T3
 T2
2T3
 T1
2T3
J
 J
(i) Parameterization of the Jerk ProÔ¨Åle
  t
u
T1
T2
2T3
 T2
2T3
 T1
1
 1
(ii) Control ProÔ¨Åle
Figure 4.34: Case 2: Jerk Limited Time-Optimal Control
 

x1
 2T3
 x2
 2T3
 u  2T3
  

 


k1
 2T3
 3
k2
 2T3
 2
J
 2T3
  

 


k1
 2T3
 T1
 3
k2
 2T3
 T1
 2
J
 2T3
 T1
  

 


k1
 2T3
 T2
 3
k2
 2T3
 T2
 2
J
 2T3
 T2
  

 


k1
 2T3
  2T3
 T2
  3
k2
 2T3
  2T3
 T2
  2
J
 2T3
  2T3
 T2
   

 


k1
 2T3
  2T3
 T1
  3
k2
 2T3
  2T3
 T1
  2
J
 2T3
  2T3
 T1
   

(4.240)
Substituting T1
  1  J and T3
 T2
  1  J, we have
 

x1
 2T3
 x2
 2T3
 u  2T3
  

 


œÜT3
 T3J
 1   J
0
0
 

(4.241)
which satisÔ¨Åes the constraint that the terminal velocity and control be zero. The
maneuver time T3 is
¬© 2010 by Taylor and Francis Group, LLC

Saturating Control
189
T3
 œÜ0
  œÜ2
0
 4J2œÜ0Œ∏f
2JœÜ0
(4.242)
Since, T3 cannot be negative, the mid-maneuver time is given by the equation
T3
 œÜ0
  œÜ2
0
 4J2œÜ0Œ∏f
2JœÜ0
(4.243)
Knowledge of the switch time and the maneuver time can now be used to deter-
mine the costate equations and the switching function. The costate equations can be
written as
Œª1
 t
   E
(4.244)
Œª2
 t
   Et
F
(4.245)
œà
 t
 
 













œÜ0E
2 t2
 œÜ0Ft
 G
for 0
  t
  T1
œÜ0E
2 t2
 œÜ0Ft
 G
 Œ∑1
 t
 for T1
  t
  T2
œÜ0E
2 t2
 œÜ0Ft
 G
 Œ∑1
 T2
 for T2
  t
  2T3
 T2
 œÜ0E
2 t2
 œÜ0Ft
 G
 Œ∑2
 t
 for
 2T3
 T2
   t
  2T3
 T1
 œÜ0E
2 t2
 œÜ0Ft
 G
 Œ∑2
 2T3
 T1
 for
 2T3
 T1
   t
  2T3
(4.246)
where
Œ∑1
 t
   Œº1
t
 dt
  œÜ0
  E
2 t2
 Ft
 G  for T1
  t
  T2
(4.247)
Œ∑2
 t
   Œº2
t
 dt
  œÜ0
  E
2 t2
 Ft
 G  for
 2T3
 T2
   t
  2T3
 T1
 (4.248)
Since the initial states for the rest-to-rest maneuver are zero and the initial control is
1, the initial value of the switching function, œà can be calculated from the equation
which requires the Hamiltonian to be zero at the initial time
H
 0   1
œà
0  J
  0
(4.249)
which results in the solution
œà
 0 
 G
  1
J
(4.250)
Since the switching curve œà is equal to zero at the switch times T1 and
 2T3
 T2  ,
we can solve for E and F in closed form:
¬© 2010 by Taylor and Francis Group, LLC

190
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
 
E
F


  

 2J
œÜ0
 2T3J
 1   2JT3
œÜ0
 2T3J
 1   

  


 2JœÜ0
 œÜ2
0
 4œÜ0J2Œ∏f
  œÜ0
  œÜ2
0
 4œÜ0J2Œ∏f
 œÜ2
0
 4œÜ0J2Œ∏f
 


(4.251)
where T3 is given by Equation (4.242).
To determine the transition from the Case 2 control proÔ¨Åle to the Case 1 control
proÔ¨Åle, the two parameters T2 and T1 should be equal. Since,
T2
  T3
  1
J
  T1
  1
J
 (4.252)
we have
T3
  2
J
 œÜ0
  œÜ2
0
 4J2œÜ0Œ∏f
2JœÜ0
(4.253)
which results in the equation
Œ∏f
  2œÜ0
J2
 (4.254)
0
0.1
0.2
0 3
0.4
0.5
0.6
0.7
0.8
0
0.5
1
1.5
2
2.5
3
3.5
Jerk = 2
Displacement
Switch Times
Figure 4.35: Variation of Switch Times vs. Displacement
Figure 4.35 illustrates the variation of the switch time as a function of displace-
ment. It can be see that the structure of the control proÔ¨Åle changes from a two-switch
bang-bang to a four-switch bang-off-bang proÔ¨Åle.
¬© 2010 by Taylor and Francis Group, LLC

Saturating Control
191
10
‚àí1
10
0
10
1
10
‚àí1
10
0
10
1
Œ∏f = 1
Jerk
Switch Times
Figure 4.36: Variation of Switch Times vs. Jerk
Figure 4.36 illustrates the variation of the switch time as a function of permitted
jerk and it can be seen that as the constraint on the jerk increases for a speciÔ¨Åed
displacement, the bang-bang control proÔ¨Åle transitions to a four-switch bang-off-
bang proÔ¨Åle.
0
0.5
1
1.5
2
2.5
3
3.5
‚àí1
‚àí0.8
‚àí0.6
‚àí0.4
‚àí0.2
0
0.2
0.4
0.6
0.8
1
Œ∏f  0.5
Time (sec)
Jerk ProÔ¨Åle, Switching Function
(i) Case 1 Control
0
1
2
3
4
5
6
7
8
‚àí1
‚àí0.8
‚àí0.6
‚àí0.4
‚àí0.2
0
0.2
0.4
0.6
0.8
1
Œ∏f  5
Time (sec)
Jerk ProÔ¨Åle, Switching Function
(ii) Case 2 Control
Figure 4.37: Jerk Limited Time-Optimal Control ProÔ¨Åles
Figure 4.37 illustrates the jerk limited time-optimal proÔ¨Åles of the rate of change
of the control and the corresponding switching function for Ô¨Ånal displacements of Œ∏f
= 0.5, and 5. It can be seen that the displacement of 5 results in a singular solution.
¬© 2010 by Taylor and Francis Group, LLC

192
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
  t
Àôu
T1
  0
T2
T3
T4
T5
T6
T7
J
 J
(i) Parameterization of the Jerk ProÔ¨Åle
  t
u
T1
  0
T2
T3
T4
T5
T6
T7
1
 1
(ii) Control ProÔ¨Åle
Figure 4.38: Typical Jerk and Control ProÔ¨Åles
4.5.2
Jerk Limited Time-Optimal Rest-to-Rest Maneuver
The optimal jerk-constrained control proÔ¨Åle will be the combination of a num-
ber of time-delayed ramp functions with different slopes. The requirement of time-
optimality can be satisÔ¨Åed by ensuring that u  t
  is in saturation for as much time
as possible during the maneuver. This is justiÔ¨Åed by the bang-bang principle [22],
which states that if an optimal control exists, then there is always a bang-bang con-
trol proÔ¨Åle that is optimal. Hence, if the optimal control is unique, it is bang-bang.
For the controller presented in this section, the jerk is the control variable. Thus, the
jerk proÔ¨Åle will be bang-bang, resulting in a ramping control input. For larger per-
missible amounts of jerk, the control input will eventually reach the saturation level.
Then a bang-off-bang proÔ¨Åle will be used. In the off-phases, the control input u  t
 remains saturated, exerting the maximum possible control authority.
It will be assumed that the actuator has symmetric limits in u  t
 , therefore umax
  umin
  1. The time rate of change is limited by
  Àôu  t
    J and is parameterized as
shown in Figure 4.38(i). The resulting control proÔ¨Åle is shown in Figure 4.38(ii).
Àôu t
  which is v t
 , will be represented as
v t
  J
 n
‚àë
i 1
Ai H
 t
 Ti
   (4.255)
¬© 2010 by Taylor and Francis Group, LLC

Saturating Control
193
 J ‚àën
i 1 Ai e
 sTi
 1
s
  GP
 s  U
 s U
s Y
s Step
Time-Delay Filter Controller
Plant
Figure 4.39: Time-Delay Filter Structure
where H denotes the Heaviside function and Ai is restricted to be
Ai
  2   1   1   2   i (4.256)
For the Ô¨Årst switch, i.e., i
  1, A1
  1 and T1
  0. Similarly, for the last switch, i.e.,
i
  n, An
  1   1   and Tn
  Tfinal.
The time-delay Ô¨Ålter structure drives an integrator, which ensures that the control
input reaches its saturation limit over time. The input u  t
  will consist of a sum of
delayed ramp signals,
u  t
  J
 n
‚àë
i 1
Ai
 t
Ti

  (4.257)
where
 x
 xH
 x . This control proÔ¨Åle can be realized by means of a time-delay
Ô¨Ålter structure as shown in Figure 4.39. The symbol U
  s  denotes the control input
used to drive the time-delay Ô¨Ålter structure, which will be a step input.
Parameterizing the jerk proÔ¨Åle to be point symmetric about the mid-maneuver
time, the transfer function of the time-delay Ô¨Ålter can be represented as
Gc
 s 
n
‚àë
i 1
 Ai e
 sTi
 Ai e
 s 2Tmid
 Ti
  (4.258)
To cancel the three poles at the origin of the s-plane, Equation (4.258) and its Ô¨Årst
two derivatives with respect to s at s
  0 should equal zero, resulting in
Gc
 s  s 0
  n
‚àë
i 1
 Ai e
 sTi
 Ai e
 s 2Tmid
 Ti
   




s 0
  0  (4.259)
dGc
 s ds
    s 0
  d
ds
 n
‚àë
i 1
 Ai e
 sTi
 Ai e
 s 2Tmid
 Ti
   




s 0
  2
  n
‚àë
i 1
Ai Ti
 n
‚àë
i 1
Ai Tmid
   0  (4.260)
¬© 2010 by Taylor and Francis Group, LLC

194
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
and
d2Gc
 s ds2
    s 0
  d2
ds2
 n
‚àë
i 1
 Ai e
 sTi
 Ai e
 s 2Tmid
 Ti
   




s 0
  4Tmid
  n
‚àë
i 1
Ai Ti
 n
‚àë
i 1
Ai Tmid
   0  (4.261)
This shows that either both constraints (Equations 4.260 and 4.261) are satisÔ¨Åed at
the same time or not at all. These constraints are identical to requiring that u  t
  is
zero at the mid-maneuver time and point-symmetric to Tmid. u  t
  is given by
u  t
  J
 n
‚àë
i 1
 Ai
 t
Ti

Ai
 t

 2Tmid
 Ti
     (4.262)
At the mid-maneuver time, it evaluates to
u  t
  t
 Tmid
 J
n
‚àë
i 1
Ai
 Tmid
 Ti
 
 J
n
‚àë
i 1
Ai Ti
 J
n
‚àë
i 1
Ai Tmid
  0  (4.263)
Thus, satisfying Equation (4.263), results in the cancelation of the triple pole at the
origin.
In addition, it can be shown that for any s
  jœâ, the requirements ‚Ñú Gc
 jœâ
 

0 and ‚Ñë Gc
 jœâ
 
 0 result in the same constraint
n
‚àë
i 1
Ai sin  œâ ÀúTi
  n
‚àë
i 1
Ai sin
 œâ
 Tmid
 Ti
   0
(4.264)
where ÀúTi is deÔ¨Åned as
Ti
  Tmid
  ÀúTi
  i
  1
   n
(4.265)
Finally, for the input-output transfer function
Y
 s U
s  Gp
s  (4.266)
the output displacement of yf results in the constraint
yf
  lim
s 0
1
s Gp
 s Gc
s  (4.267)
4.5.3
SufÔ¨Åciency Conditions
Unlike the three previous class of problems: time-optimal, fuel/time optimal, and
fuel constrained time-optimal control, the jerk limited time-optimal control problem
supports singular solutions. To conÔ¨Årm the optimality of the solution determined
by the parameter optimization problem which only satisÔ¨Åes the state constraints, the
¬© 2010 by Taylor and Francis Group, LLC

Saturating Control
195
costate constraints have to be studied. The switching function for the augmented
system Œª TB
  œà should equal zero when control reaches a boundary arc, i.e., when
one of the state constraint becomes active. Figure 4.40 illustrates the evolution of
the switching function (solid line) and the evolution of the switching function with
no state constraints (dashed line). Equation (4.216c) states that the derivative of the
costate equation œà is discontinuous when the state constraint becomes active and the
associated singular control is given by the equations
0
0.5
1
1.5
2
2.5
3
‚àí0.5
‚àí0.4
‚àí0.3
‚àí0.2
‚àí0.1
0
0.1
0.2
0.3
Time
BTexp(‚àíATT3)Œª (0)
Switching Function
BTexp(‚àíATt)Œª(0)
BTexp(‚àíATT4)Œª (0)
T2
T3
T4
T5
Figure 4.40: Switching Function
Àôu
  v
  0 since
 d
dt
 u
 1    0
when u
  1
d
dt
  u
 1    0
when u
  1
(4.268)
Thus
Œº1
  B
 TŒª
 when u
  1
(4.269a)
Œº2
  B
 TŒª
 when u
  1
(4.269b)
which results in Àôœà being zero when the state constraints are active.
Accounting for Œº1 and Œº2, the initial value of the costate can be solved from the
unconstrained switching function by appropriately accounting for the effect of the
discontinuity as shown in Figure 4.40. Since the switching function is equal to zero
every time the state constraints become active, the initial costates can be determined
from the equation
¬© 2010 by Taylor and Francis Group, LLC

196
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
PŒª
 0  
 




BT exp  ATT2
 BT exp  ATT4
  BT exp
  ATT3
 BT exp  ATT6
  BT exp
  ATT5
    BT
 




Œª
 0    




0
0
0
     1
J
 




(4.270)
where the last equations is derived from the requirement that the Hamiltonian be
zero at the initial time. A and B are the system and input matrices of the augmented
system. It is assumed that the jerk proÔ¨Åle is one which results in the control in-
put reaching its maximum and minimum limits. Solving for the costates using the
equations
ÀôŒª
   ‚àÇH
‚àÇx
   A
 TŒª
 (4.271a)
Àôœà
  ‚àÇH
‚àÇu
  



 B
 TŒª
 if
 u   1
  0
 B
 TŒª
   Œº1
if u
 1
  0
 B
 TŒª
   Œº2
if
 u
 1
  0
(4.271b)
with the initial costates determined from Equation (4.270), and if the control deter-
mined from
u
  sgn
 BTŒª
 t

 (4.272)
switches at the times determined from the parameter optimization problem, then the
solution is optimal.
4.5.4
Benchmark Problem
The augmented model for the benchmark problem is
 









Àôy1
Àôy2
¬®y1
¬®y2
Àôu
 









  Àôx
  




0
0 1 0 0
0
0 0 1 0
 1 1 0 0 1
1
 1 0 0 0
0
0 0 0 0






x
  




0
0
0
0
1






v
(4.273)
and the corresponding Hamiltonian is:
H
  1
 Œª1x3
 Œª2x4
 Œª3
  x1
 x2
 u   Œª4
x1
 x2
  œàv
 Œº1
 u
 1   Œº2
 u
 1   (4.274)
¬© 2010 by Taylor and Francis Group, LLC

Saturating Control
197
The resulting costate equations are
ÀôŒª1
  Œª3
 Œª4
(4.275a)
ÀôŒª2
  Œª3
 Œª4
(4.275b)
ÀôŒª3

 Œª1
(4.275c)
ÀôŒª4

 Œª2
(4.275d)
Àôœà

 



 Œª3
if
 u   1
  0
 Œª3
  Œº1
if u
 1
  0
 Œª3
  Œº2
if
 u
 1
  0
(4.275e)
(4.275f)
4.5.4.1
Case 1
With the knowledge that the time-optimal control with no constraints on the per-
mitted jerk is
u t
  1
 2H
 t
 1 0026  2H
 t
 2 1089  2H
 t
 3 2152  H
t
 4 2178  (4.276)
the transition to jerk limited control proÔ¨Åle results in a parameterization of an eight-
switch bang-off-bang jerk proÔ¨Åle. This results from the fact that each corner of
the unconstrained time-optimal control proÔ¨Åle corresponding to a switch of the jerk
proÔ¨Åle.
It can be seen from Figure 4.41 that the jerk proÔ¨Åle can be described by two pa-
rameters, the time of the Ô¨Årst zero crossing T1 of the control input u, and the mid-
maneuver time, Tmid. This is the reÔ¨Çection of the fact that for large jerk, the Ô¨Årst
switch is equal to 1  J, i.e., the time required for the control input to reach its satu-
ration limit of unity and the transition time from the upper and lower bound of the
control takes 2  J. The jerk proÔ¨Åle can therefore be parameterized as
v
  GF
 s
s
 J
s
 1
 e
 s 1
J
 e
 s
 T1
  1
J
  e
 s
T1
  1
J
  e
 s
Tmid
  1
J
  e
 s
 Tmid
  1
J
  e
 s
 2Tmid
 T1
  1
J
  e
 s
2Tmid
 T1
  1
J
  e
 s
2Tmid
  1
J
  e
 s2Tmid
  (4.277)
The transfer function GF
 s  must include zeros which cancel the rigid-body poles
as well as the poles corresponding to the oscillatory poles. The resulting parameter
optimization problem is
min f
  Tmid
(4.278a)
subject to
sin  œâTmid
  sin œâ
 Tmid
  1
J
   sin œâ
 Tmid
 T1
  1
J
  ¬© 2010 by Taylor and Francis Group, LLC

198
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
  t
Àôu
J
 J
1
J
T1
  1
J
T1
  1
J
Tmid
  1
J
Tmid
Tmid
  1
J
2Tmid
 T1
  1
J
2Tmid
 T1
  1
J
2Tmid
  1
J
2Tmid
(i) Uncollapsed Jerk ProÔ¨Åle
  t
u
1
 1
1
J
T1
  1
J
T1
  1
J
Tmid
  1
J
Tmid
Tmid
  1
J
2Tmid
 T1
  1
J
2Tmid
 T1
  1
J
2Tmid
  1
J
2Tmid
(ii) Control ProÔ¨Åle
Figure 4.41: Large Jerk ProÔ¨Åle
 sin œâ
 Tmid
 T1
  1
J
   sinœâ
J
   0
(4.278b)
J
12
  12T2
1
J
  6T 2
mid
J
  6Tmid
J2
  24TmidT1
J
   yf
(4.278c)
Tmid
  2
J
  T1
  2
J
(4.278d)
where yf refers to the Ô¨Ånal displacement of the rigid body mode.
The optimality of the results of the parameter optimization problem are conÔ¨Årmed
by solving for the initial costates from the equation
¬© 2010 by Taylor and Francis Group, LLC

Saturating Control
199
 




BT exp  AT 1
J
 BT exp  AT
 T1
  1
J
   BT exp  AT
 T1
  1
J
  BT exp  AT
 Tmid
  1
J
   BT exp  AT
 Tmid
  1
J
  BT exp  AT
 2Tmid
 T1
  1
J
   BT exp  AT
 2Tmid
 T1
  1
J
  BT
 







P
Œª
 0    




0
0
0
     1
J
 




(4.279)
and determining if the switch time of the control proÔ¨Åle determined from the switch-
ing curve coincide with those determined from the parameter optimization problem.
5
10
50
100
500
0.1
1
10
50
Jerk J
Switching Times Ti
Figure 4.42: Case 1: Variation of Switch Times vs. Jerk
Figure 4.42 illustrates the variation of the switch time as a function of permitted
jerk. It can be see that the structure of the jerk proÔ¨Åle changes from an eight-switch
bang-off-bang to a six-switch proÔ¨Åle. This is due to the fact that the third and fourth
and the Ô¨Åfth and sixth switches collapse into each other. For a displacement of unity,
this occurs for a jerk of J = 1.7539. At this transition, i.e., when the third and fourth
and the Ô¨Åfth and sixth collapse into each other, the jerk proÔ¨Åle shown in Figure 4.43
can be parameterized as
¬© 2010 by Taylor and Francis Group, LLC

200
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
v
  GF
 s
s
 J
s
 1
 e
 s 1
J
 e
 s
 Tmid
  3
J
  2e
 s
 Tmid
  1
J
  2e
 s
 Tmid
  1
J
  e
 s
Tmid
  3
J
  e
 s
2Tmid
  1
J
  e
 s2Tmid
  (4.280)
  t
J
 J
Àôu
1
J
Tmid
  3
J
Tmid
  1
J
Tmid
Tmid
  1
J
Tmid
  3
J
2Tmid
  1
J
2Tmid
Figure 4.43: Partially Collapsed Jerk ProÔ¨Åle
It can be shown from the pole cancelation constraint that
Tmid
 arcsin
sin
  3œâ
J
  2sin
  œâ
J
   1  cos
  œâ
J
  2
  sin
  œâ
J
  2
 arctan
sin
  œâ
J
 1  cos
  œâ
J
 œâ
 (4.281)
The constraint governing the displacement of the center of mass leads to the equation
J1  2
  1
2
Tmid
  33Tmid2
 32yf
Tmid2
 yf
 (4.282)
Using this result, an equation relating the mid-maneuver time to the frequency of
¬© 2010 by Taylor and Francis Group, LLC

Saturating Control
201
the oscillatory mode œâ and the Ô¨Ånal displacement yf can be written as
sin  œâTmid
  

1
 cos
 


œâ
1
2
 Tmid
  33T2
mid
 32yf
 T 2
mid
 yf
 


 


 cos
 œâTmid
 sin
 


œâ
1
2
 Tmid
  33T 2
mid
 32yf
 T 2
mid
 yf
 


 sin
 


3œâ
1
2
 Tmid
  33T2
mid
 32yf
 T 2
mid
 yf
 


 2sin
 


œâ
1
2
 Tmid
  33T 2
mid
 32yf
 T2
mid
 yf
 


 (4.283)
Equation (4.283) is a transcendental function which can be used to solve for Tmid
given a desired Ô¨Ånal displacement of yf .
It is conceivable that instead of the third and fourth and the Ô¨Åfth and sixth switches
coalescing, the Ô¨Årst and second and the seventh and eighth could coalesce for a dif-
ferent set of model parameters. The transition equations for this scenario can be
derived as shown above.
4.5.4.2
Case 2
For jerk values below that corresponding to the transition given by Equation (4.283),
the control magnitude does not saturate in the region where the switches have col-
lapsed. The maximum magnitude of the control input in this region becomes a vari-
able to be optimized for.
Figure 4.44 illustrates the jerk proÔ¨Åle parameterized in terms of the mid-maneuver
time Tmid, and u2 which corresponds to the maximum magnitude of the control in the
region where the switches have collapsed. The jerk proÔ¨Åle can be described by the
equation
v
  GF
 s
s
 J
s
 1
 e
 s 1
J
 e
 s
 Tmid
  1 2u2
J
  2e
 s
 Tmid
  u2
J
  2e
 s
 Tmid
  u2
J
  e
 s
 Tmid
  1 2u2
J
  e
 s
 2Tmid
  1
J
  e
 s2Tmid
  (4.284)
The parameter optimization problem for the Case 2 jerk proÔ¨Åle is
min f
  Tmid
(4.285a)
subject to
sin  œâTmid
  sin œâ
 Tmid
  1
J
   sin œâ 1
 2u2
J
  2sinœâ u2
J
   0
(4.285b)
¬© 2010 by Taylor and Francis Group, LLC

202
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
  t
Àôu
J
 J
1
J
Tmid
  1  2u2
J
Tmid
  u2
J
Tmid
Tmid
  u2
J
Tmid
  1  2u2
J
2Tmid
  1
J
2Tmid
(i) Jerk ProÔ¨Åle
  t
u
1
 1
1
J
Tmid
  1 2u2
J
Tmid
  u2
J
Tmid
Tmid
  u2
J
Tmid
  1 2u2
J
2Tmid
  1
J
2Tmid
(ii) Control ProÔ¨Åle
Figure 4.44: Case 2: Control ProÔ¨Åle
J
12
  12u2
J3
  6Tmid
J2
  24u2
2
J3
  12u3
2
J3
  6T 2
mid
J
   yf
(4.285c)
Tmid
  1
 2u2
J
  1
J
  u2
J
(4.285d)
The initial costates for the optimal solution are determined from the equation
PŒª
 0    




BT exp  AT 1
J
 BT exp
  AT
 Tmid
  u2
J
   BT exp  AT
 Tmid
  1  2u2
J
  BT exp
  AT
 Tmid
  u2
J
   BT exp  AT
 Tmid
  1  2u2
J
  BT exp  AT
 Tmid
  1  2u2
J
   BT exp
  AT
 Tmid
  1  2u2
J
  BT
 




Œª
 0    




0
0
0
0
  1
J
 




(4.286)
which are subsequently used to conÔ¨Årm optimality of the solution of the parameter
optimization problem.
Figure 4.45 illustrates the variation of the switch time as a function of permitted
jerk. It can be see that the structure of the jerk proÔ¨Åle changes from a six-switch
bang-off-bang to a four-switch proÔ¨Åle. This is due to the fact that the Ô¨Årst and second
¬© 2010 by Taylor and Francis Group, LLC

Saturating Control
203
1.45
1.5
1 55
1 6
1.65
1.7
1.75
0.1
1
10
50
Jerk J
Switching Times Ti
Figure 4.45: Case 2: Variation of Switch Times vs. Jerk
and the Ô¨Åfth and sixth collapse into each other. For a displacement of unity, this
occurs for a jerk of J = 1.445065. At this transition, i.e., when the Ô¨Årst and second
and the Ô¨Åfth and sixth collapse into each other, the jerk proÔ¨Åle parameterized by
Equation (4.284) requires the Ô¨Årst switch to coincide with the second resulting in the
equation
1
J
  Tmid
  1
 2u2
J
  u2
  JTmid
2
 1  (4.287)
The Ô¨Ånal displacement constraint can be used to solve for the jerk
J1  2
 1
2T 3
mid
 6T 2
mid
 4yf
 2
 5T 4
mid
 12T2
midyf
 4y2
f
 (4.288)
and the constraint to cancel the undamped Ô¨Çexible model reduces to the equation
2sin  œâ u2
2
  2sin œâ
 Tmid
  1
J
   sin œâTmid
  0
(4.289)
which can be used to solve for u2.
4.5.4.3
Case 3
For jerk values lower than that given by Equation (4.288), the control never sat-
urates and the design problem degenerates into a state unconstrained time-optimal
design. Here the control input u is considered the state and the jerk v, the input. Fig-
ure 4.46 illustrates the parameterization of the jerk proÔ¨Åle in terms of the maximum
¬© 2010 by Taylor and Francis Group, LLC

204
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
magnitude of the control input u at the end of every ramp. The resulting jerk proÔ¨Åle
is
GF
 s J
 1
 2e
 s u1
J
 2e
 s 2u1
 u2
J
 2e
 s 2u1
 3u2
J
 2e
 s 3u1
 4u2
J
 e
 s 4u1
 4u2
J
  (4.290)
The parameter optimization problem for the Case 3 jerk proÔ¨Åle is
min f
  2u1
 2u2
J
(4.291a)
subject to
2sin  œâ u2
J
  2sin
 œâ u1
 2u2
J
  2sinœâ 2u1
 2u2
J
   0
(4.291b)
J
12
 12u3
1
J3
  24u2
1u2
J3
  12u3
2
J3
   yf
(4.291c)
u1
  0   u2
  0
(4.291d)
The corroboration of optimality for this case is identical to that of the time-optimal
control problem since the state constraints are not active.
Figure 4.47 illustrates the variation of the switch time as a function of permitted
jerk. It can be see that the structure of the jerk proÔ¨Åle changes from a four-switch
bang-bang to a two-switch proÔ¨Åle. This is referred to as the triangular control proÔ¨Åle.
This transition proÔ¨Åle can be parameterized as
GF
 s  J
 1
 2e
 s Tmid
2
 2e
 s 3Tmid
2
 e
 s2Tmid
  (4.292)
By applying the pole-cancelation technique, an equation for Tmid can be derived as
sin
 œâTmid
  2sin
 1
2œâTmid
   0
  sin
 œâTmid
2
  cos
 œâTmid
2
  1
   0
  Tmid
  2nœÄ
œâ
 n
  N
 (4.293)
where N denotes the set of natural numbers. Once Tmid is known, the Ô¨Ånal displace-
ment constraint is given as
J
6
 T 3
mid
 2
 Tmid
2
 3
   yf
2
 (4.294)
This equation can be solved for the jerk J as
J
  4yf
T 3
mid
  4yf œâ3
 2nœÄ
 3
 n
  N
 (4.295)
¬© 2010 by Taylor and Francis Group, LLC

Saturating Control
205
  t
u
1
 1
u1
J
2u1
 v2
J
Tmid
2u1
 3u2
J
3u1
 4u2
J
4u1
 4u2
J
(i) Jerk ProÔ¨Åle
  t
Àôu
J
 J
u1
J
2u1
 u2
J
Tmid
2u1
 3u2
J
3u1
 4u2
J
4u1
 4u2
J
(ii) Control ProÔ¨Åle
Figure 4.46: Case 3: Jerk and Control ProÔ¨Åles
For the Ô¨Årst transition, n
  1. Since n can be any natural number, this triangular pro-
Ô¨Åle will also be the optimal solution for some other, smaller values of jerk. The very
small jerk proÔ¨Åle, which is shown in the next section will collapse to the triangular
proÔ¨Åle for some discrete values of jerk, which corresponds to n
  2.
4.5.4.4
Case 4
For permitted jerk values smaller than those which result in the triangular control
proÔ¨Åle, four more switches are introduced into the optimal jerk proÔ¨Åle as shown in
Figure 4.49. This jerk proÔ¨Åle can be parameterized as
GF
 s J
 1
 2e
 sT1
 2e
 sT2
 2e
 sT3
 2e
 s 2Tmid
 T3
  2e
 s 2Tmid
 T2
  2e
 s 2Tmid
 T1
  e
 2sTmid
 (4.296)
The parameter optimization problem for the Case 4 jerk proÔ¨Åle is
min f
  Tmid
(4.297a)
¬© 2010 by Taylor and Francis Group, LLC

206
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
0.1
0.5
1.0
0.1
1
10
50
Jerk J
Switching Times Ti
Figure 4.47: Case 3: Variation of Switch Times vs. Jerk
subject to
2T1
 2T2
 2T3
 Tmid
  0
(4.297b)
 2sin
 œâ
 Tmid
 T3
   2sinœâ
Tmid
 T2
   2sin
 œâ
 Tmid
 T1
   sinœâTmid
   0
(4.297c)
J
12
 4  T 3
1
 T 3
2
 T 3
3
 2T 3
mid
  24T2
mid
 T3
 T2
 T1
  12Tmid
  T 2
3
 T 2
2
 T 2
1
    yf
(4.297d)
Tmid
  T3
  T2
  T1
  0
(4.297e)
Since the state constraints are not active for this case as well, the corroboration of
optimality for this case is identical to that of the time-optimal control problem.
Figure 4.50 illustrates that the switching curves start from a triangular proÔ¨Åle and
as the permitted jerk is decreased, ends up with a triangular control proÔ¨Åle again. It
can be seen that two switches are introduced earlier to the Ô¨Årst switch of the triangular
control proÔ¨Åle and as the jerk is decreases, the second switch drifts towards the third
and coalesces with it reducing the jerk proÔ¨Åle to one which generates a triangular
control input.
To illustrate the entire spectrum of control proÔ¨Åles, the entire suite of proÔ¨Åles and
the variations of switch times as a function of jerk are presented in Figure 4.51. It
can be seen from Figure 4.51 that reducing the jerk from J
  ‚àûto J = 2, the Ô¨Ånal
time increases from 4.2179 to 4.8017, a small increase in maneuver time while the
fuel consumed drops from 4.2179 to 2.8017, a signiÔ¨Åcant percentage. To study the
¬© 2010 by Taylor and Francis Group, LLC

Saturating Control
207
  t
u
1
 1
Tmid
2
Tmid
3Tmid
2
2Tmid
(i) Jerk ProÔ¨Åle
  t
Àôu
J
 J
1
2Tmid
Tmid
3
2Tmid
2Tmid
(ii) Control ProÔ¨Åle
Figure 4.48: Third Transition ProÔ¨Åle
frequency spectrum of the energy, the Fourier transform of the input signal u  t
  is
calculated and its magnitude is plotted in Figure 4.52 which clearly demonstrates
that the energy injected into the higher frequency modes is reduced.
Figure 4.53 illustrates the optimal jerk proÔ¨Åles and the corresponding switching
function for the four distinct cases described in this section. It can be seen that for
Cases 1 and 2, singular intervals exist. For Cases 3 and 4, the control input never
saturates and the switching function does not include any singular intervals.
For the Hubble telescope, the rate of change of jerk (snap) was considered in the
design process. One can easily extend the techniques presented in this chapter to
design controllers that are subject to constraints on snap, or the rate of change of
snap (crackle), or the rate of change of crackle (pop), to successively develop control
proÔ¨Åles whose frequency spectrum has an increased roll off at higher frequencies
resulting in smoother control proÔ¨Åles.
¬© 2010 by Taylor and Francis Group, LLC

208
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
  t
u
1
 1
T1
T2
T3
Tmid
2Tmid
 T3
2Tmid
 T2
2Tmid
 T1
2Tmid
(i) Jerk ProÔ¨Åle
  t
Àôu
J
 J
T1
T2
T3
Tmid
2Tmid
 T3
2Tmid
 T2
2Tmid
 T1
2Tmid
(ii) Control ProÔ¨Åle
Figure 4.49: Case 4: Jerk and Control ProÔ¨Åles
4.5.5
Summary
The objective of this chapter was to present design of controllers with control
constraints. The cost function studied are:
  Time-Optimal Control
  Fuel/Time Optimal Control
  Fuel Limited Time-Optimal Control
  Jerk Limited Time-Optimal Control
All the cost functions selected for design resulted in controllers which can be char-
acterized as bang-bang or bang-off-bang controllers. Such control proÔ¨Åles can be
represented as the sum of time-delayed step inputs of different amplitudes. The am-
plitudes deÔ¨Åne whether the resulting control proÔ¨Åle is bang-bang or bang-off-bang.
The combined time-delayed step inputs can be generated by a time-delay Ô¨Ålter sub-
ject to a unit step input which corresponds to the reference input for a rest-to-rest
¬© 2010 by Taylor and Francis Group, LLC

Saturating Control
209
0 02
0.05
0.09
0.1
1
10
50
Jerk J
Switching Times Ti
Figure 4.50: Case 4: Variation of Switch Times vs. Jerk
0.02
0.05
0.1
0.5
1
5
10
50
100
500
0.1
1
10
50
Jerk J
Switching Times Ti
Figure 4.51: Variation of Switch Times vs. Jerk
maneuver. The design of the controllers where the control switches between discrete
values, can then be posed as the design of the time-delays of a time-delay Ô¨Ålter so as
to cancel all the poles of the system and satisfy the rigid body boundary conditions.
¬© 2010 by Taylor and Francis Group, LLC

210
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
0
10
20
30
40
50
0
0.5
1
1.5
2
2.5
3
Frequency
|U(jœâ)|
J=‚àû
J=2
Figure 4.52: Frequency Spectra of Control ProÔ¨Åle
The Hamiltonian formulation is used to derive the necessary conditions for opti-
mality. Since only part of the necessary conditions for optimality are used to arrive at
the parameter optimization problem, the satisfaction of the remaining necessary con-
ditions need to be corroborated to guarantee optimality. A simple technique is used
to determine the initial costates which can then be used to determine the switching
function. If the control proÔ¨Åle resulting from the switching function is coincident
with that determined from the parameter optimization problem, optimality is guar-
anteed.
For all the cost functions considered in this chapter, closed form solutions for the
optimal control for a rigid body system are derived. This is followed by a study of
the undamped Ô¨Çoating oscillator benchmark problem. Parametric studies related to
variation of the Ô¨Ånal displacement, damping ratio, weighting factor of the cost func-
tion, and so forth, are studied for their effect on the structure of the optimal control
proÔ¨Åles. Except for the jerk limited time-optimal control problem, none of the other
cost functions resulted in singular control proÔ¨Åles for rest-to-rest maneuvers.
Exercises
4.1
Design a time-optimal controller for the system:
¬© 2010 by Taylor and Francis Group, LLC

Saturating Control
211
0
1
2
3
4
5
‚àí2
‚àí1.5
‚àí1
‚àí0.5
0
0.5
1
1.5
2
Time (sec)
Jerk ProÔ¨Åle, Switching Function
(i) Case 1: Control
0
1
2
3
4
5
‚àí3
‚àí2.5
‚àí2
‚àí1.5
‚àí1
‚àí0.5
0
0.5
1
1.5
2
Time (sec)
Jerk ProÔ¨Åle, Switching Function
(ii) Case 2: Control
0
1
2
3
4
5
6
7
8
‚àí5
‚àí4
‚àí3
‚àí2
‚àí1
0
1
Time (sec)
Jerk ProÔ¨Åle, Switching Function
(iii) Case 3: Control
0
2
4
6
8
10
12
‚àí0.08
‚àí0.06
‚àí0.04
‚àí0.02
0
0.02
0.04
0.06
Time (sec)
Jerk ProÔ¨Åle, Switching Function
(iv) Case 4: Control
Figure 4.53: Spectrum of Jerk Limited Time-Optimal Control ProÔ¨Åles
m1 ¬®x1
 c1
 Àôx1
  Àôx2
  k1
 x1
 x2
   u
m2 ¬®x2
 c1
 Àôx1
  Àôx2
  k1
 x1
 x2
  c2
 Àôx2
  Àôx3
  k2
 x2
 x3
   0
m3 ¬®x3
 c2
 Àôx2
  Àôx3
  k2
 x2
 x3
   0
for the boundary conditions
x1
 0  x2
 0  x3
 0  Àôx1
 0  Àôx3
 0  Àôx3
 0  0
x1
 t f
   x2
 t f
  x3
 t f
  1  Àôx1
 t f
   Àôx3
 t f
  Àôx3
 t f
  0
Assume m1 = m2 = m3 = 1, k1 = k2 = 1, c1 = c2 = 0.1
4.2
Design a controller which minimizes the cost function:
J
   tf
0
 1
  u   dt
for the system:
L di
dt
 Ri
  V
¬© 2010 by Taylor and Francis Group, LLC

212
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
J ¬®Œ∏
  Ki
Assume R = 1, L = 1, J = 1, K = 1, with the boundary conditions
Œ∏
 0  ÀôŒ∏
0  i  0  0  and Œ∏
 t f
  1  ÀôŒ∏
 t f
   0 i  t f
  0 V is the control input and satisÔ¨Åes the constraint
 1
  V
  1
4.3
For the two-mass-spring system (Figure 4.54), design a controller which min-
imizes the cost function
J
  1
2
  tf
0
 1
  u  dt
subject to the constraints
 1
  u t
   1 and
 5
  Àôu t
   5
m2
m1
k
c
 y1
 y2
 u
Figure 4.54: Floating Oscillator
for a rest-to-rest motion with the initial and Ô¨Ånal conditions
 





y1
y2
Àôy1
Àôy2
 





 0 







0
0
0
0
 





and
 





y1
y2
Àôy1
Àôy2
 





 œÄ
 







1
1
0
0
 





Assume the nominal value of the parameters are
 





mnom
1
mnom
2
knom
cnom
 





 






1 0
1 0
1 0
0
 





4.4
Design a closed form expression for the time-optimal controller for the sys-
tem with a transfer function:
Y
 s U
s  Gp
s  s
2
s2
subject to the boundary conditions
¬© 2010 by Taylor and Francis Group, LLC

Saturating Control
213
y 0   0 and y t f
  1
and the control constraint:
 1
  u t
   1
This class of problem is referred to as output-transition control as opposed
to state-transition control.
4.5
Design a time-optimal controller for the system with a transfer function:
Y
 s U
s  Gp
s 
s
K
s2
 s
 2 subject to the boundary conditions
y 0  0 and y t f
  1
and the control constraint:
 1
  u t
   1
Assume K = 1.
4.6
Design a fuel limited time-optimal control for the slosh problem [23]. The
dynamics are given as:
Àôx
  


 0 42
 21 0 0
21
0
0 0
0
0
0 0
0
0
1 0
 

x
  


0 0749
0
1
0



u
and are subject to the constraints:
 1
  u t
   1 and
  tf
0
 u dt
  10
The initial and boundary conditions are
 





x1
x2
x3
x4
 





 0 







0
0
0
0
 





and
 





x1
x2
x3
x4
 





 t f
 







0
0
0
1
 





4.7
Harmonic drives which are often used in robots are characterized by high
torque capacity, but suffer from high Ô¨Çexibility. Figure 4.55 illustrate a single
link robot driven by a harmonic drive where the Ô¨Çexibility is represented by a
torsional spring. The equations of motion are:
Jm ¬®œà
 k
 œà
 œÜ

 œÑ
J ¬®œÜ
 k
 œà
 œÜ
  0 ¬© 2010 by Taylor and Francis Group, LLC

214
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
Design a jerk limited fuel/time optimal controller assuming the jerk limit is 5
and the model parameters are: Jm = 1, J = 5, k = 10, and the control input
has to satisfy the constraint:
 2
  œÑ
  2
The initial and Ô¨Ånal conditions are:
œà
 0  Àôœà
0  œÜ
0  ÀôœÜ
0  0
and
œà
 t f
  œÜ
t f
  œÄ
2
 Àôœà
 t f
   ÀôœÜ
 t f
  0
\
I
5
-
W
-P
N
Figure 4.55: Harmonic Drive Robot
4.8
Design a time-optimal controller for the pitch control of an aircraft (Figure 4.56).
The transfer function relating the pitch angle Œ∏ to the elevator deÔ¨Çection Œ¥e is:
(Taken from: http://www.engin.umich.edu/group/ctm/examples/pitch/Mpitch.html.)
Œ∏
 s Œ¥e
 s

1 151s
 0 1774
s3
 0 739s2
 0 921s
The elevator deÔ¨Çection is constrained by:
 œÄ
6
  Œ¥e
  œÄ
6
¬© 2010 by Taylor and Francis Group, LLC

Saturating Control
215
Design a time-optimal control to change the pitch angle from an initial posi-
tion of rest to a Ô¨Ånal pitch angle of 0.2 rad.
>≈ùƒ®∆ö
∆åƒÇ≈ê

∆ç
y
y∆ç
s
D
J
T
GH
Figure 4.56: Airplane Pitch Dynamics Variables
4.9
Rapid human movement is referred to as Ballistic movement since feedback
is not used in the maneuver [18]. It has been shown that that human mo-
tion can be represented as the solution of a jerk limited time-optimal control
problem. Figure 4.57 illustrates a point-to-point motion. A simpliÔ¨Åed model
for the motion of the arm is:
 m1
L1
4
2
 m2L2
1
 m2
L2
4
2
 m2L1L2
 ¬®Œ∏1
 
m2
L2
4
2
 m2
1
2L1L2
 ¬®Œ∏2
  u1
 m2
L2
4
2
 ¬®Œ∏2
  m2
L2
4
2
 m2
1
2L1L2
 ¬®Œ∏1
  u2
Design a jerk limited time-optimal control where the initial and boundary con-
ditions are:
 


Œ∏1
Œ∏2
ÀôŒ∏1
ÀôŒ∏2




 0 
 


40o
42o
0
0
 


 



Œ∏1
Œ∏2
ÀôŒ∏1
ÀôŒ∏2
 


 t f
   


32o
35o
0
0
 


where
L1
  0 3m  L2
  0 4m  m1
  1 89kg
  m2
  1 5kg
and the jerk is limited to the range
 60 m
s3
  ...
œà
  60 m
s3
where
œà
  L1Œ∏1
 L2Œ∏2
is an approximate displacement of the end of the arm. The acceleration of
the end of the links are limited to the range
 5 m
s2
  L1 ¬®Œ∏1
  5 m
s2
 5 m
s2
  L2 ¬®Œ∏2
  5 m
s2
¬© 2010 by Taylor and Francis Group, LLC

216
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
Figure 4.57: Human Ballistic Motion
References
[1] B. Wie and D. S. Bernstein. Benchmark problmes for robust control design. J.
of Guid., Cont. and Dyn., 15(5):1057‚Äì1059, 1992.
[2] M. Athans and P. L. Falb. Optimal Control. McGraw Hill, 1966.
[3] Arthur E. Bryson and Yu-Chi Ho. Applied Optimal Control: Optimization,
Estimation and Control. Hemisphere Publishing, 1975.
[4] S. Scrivner and R. C. Thompson. Survey of time-optimal attitude maneuvers.
J. of Guid., Cont. and Dyn., 17(2):225‚Äì233, 1992.
[5] G. Singh, P. T. Kabamba, and N. H. McClamroch. Planar time-optimal con-
trol, rest-to-rest slewing of Ô¨Çexible spacecraft. J. of Guid., Cont. and Dyn.,
12(1):71‚Äì81, 1989.
[6] J. Ben-Asher, J. A. Burns, and E. M. Cliff. Time-optimal slewing of Ô¨Çexible
spacecraft. J. of Guid., Cont. and Dyn., 15(2):360‚Äì367, 1992.
[7] Q. Liu and B. Wie. Robust time-optimal control of uncertain Ô¨Çexible space-
craft. J. of Guid., Cont. and Dyn., 15(3):597‚Äì604, 1992.
[8] B. H. Hablani. Zero-residual-energy, single-axis slew of Ô¨Çexible spacecraft
¬© 2010 by Taylor and Francis Group, LLC

Saturating Control
217
using thrusters. dynamics approach. J. of Guid., Cont. and Dyn., 15(1):104‚Äì
113, 1992.
[9] L. Y. Pao. Minimum-time control characteristics of Ô¨Çexible structures. J. of
Guid., Cont. and Dyn., 19(1):123‚Äì129, 1996.
[10] T. Singh. Effect of damping on the structure of time-optimal controllers. Jour-
nal of Guidance, Control and Dynamics, 19(5):1182‚Äì1184, September 1996.
[11] W. E. Vander Velde and J. He. Design of space structure control systems using
on-off thrusters. Journal of Guidance, Control and Dynamics, 6(1):53‚Äì60,
January 1983.
[12] M. Lopes de Oliveria e Souza. Exactly solving the weighted time/fuel optimal
control of an undamped harmonic oscillator. Journal of Guidance, Control and
Dynamics, 11(6):488‚Äì494, 1983.
[13] R. Hartmann and T. Singh. Fuel/time optimal control of Ô¨Çexible structures: A
frequency domain approach. Journal of Vibration and Control, 5(5):795‚Äì817,
1999.
[14] B. Wie, R. Sinha, J. Sunkel, and K. Cox. Robust fuel- and time-optimal con-
trol of uncertain Ô¨Çexible space strcutures. In AIAA Guidance, Navigation and
Control Conference, Monterey, CA, 1993.
[15] T. Singh. Fuel/time optimal control of the benchmark problem. J. of Guid.,
Cont. and Dyn., 18(6):1225‚Äì1231, 1995.
[16] T. Singh and S. R. Vadali. Robust time-optimal control: Frequency domain
approach. J. of Guid., Cont. and Dyn., 17(2):346‚Äì353, 1994.
[17] W. Singhose, T. Singh, and W. P. Seering. On-off control with speciÔ¨Åed fuel
usage. ASME J. of Dyn. Systems, Measurements, and Cont., 121(2):206‚Äì212,
1999.
[18] S. Ben-Itzak and A. Karniel. Minimum acceleration criterion with constraints
implies bang-bang control as an underlying principle for optimal trajectories
of arm reaching movements. Neural Computation, 20:779‚Äì812, 2008.
[19] S. Iwnicki. Handbook of Railway Vehicle Dynamics. CRC/Taylor & Francis
Group, 2006.
[20] M. Muenchhof and T. Singh. Jerk limited time optimal control of Ô¨Çexible
structures. ASME J. of Dyn. Systems, Measurements, and Cont., 125(1):139‚Äì
142, 2003.
[21] M. Muenchhof and T. Singh. Desensitized jerk limited-time optimal control of
multi-input systems. J. of Guid., Cont. and Dyn., 25(3):474‚Äì481, 2002.
[22] H. Hermes and J. P. Lasalle. Functional Analysis and Time Optimal Control.
Academic Press, 1969.
¬© 2010 by Taylor and Francis Group, LLC

218
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
[23] M. Grundelius and B. Bernhardsson. Control of liquid slosh in an industrial
packaging machine. In IEEE International Conference on Control Applica-
tions, pages 1654‚Äì1659, Hawaii, HI, August 1999.
¬© 2010 by Taylor and Francis Group, LLC

5
Minimax Control
If people do not believe that mathematics is simple, it is only because
they do not realize how complicated life is.
John von Neumann (1903-1957); Hungarian‚ÄìAmerican mathematician
C
HAPTERS 2, 3, and 4 described various techniques for the control of systems
with vibratory modes. These techniques are model‚Äìbased and are often sen-
sitive to errors in model parameters. In Chapter 2, the sensitivity of the pole-zero
cancelation constraints with respect to the uncertain model parameters was used to
design Ô¨Ålters/controllers. The resulting control proÔ¨Åles are robust around the nominal
model of the system. Thus, for shaping the reference input to a system with model-
ing errors, it was shown that by cascading multiple instances of the time-delay Ô¨Ålter
designed to cancel the poles of the system, resulted in a Ô¨Ålter that was insensitive to
error in modeled natural frequency and damping ratio. The idea of locating multi-
ple zeros of a time-delay Ô¨Ålter at the estimated location of the poles of the system
has been exploited to design robust time-optimal control [1,2], robust fuel/time opti-
mal control [3], fuel constrained time-optimal control [4], and so forth, as shown in
Chapter 4. The concept of using terminal state sensitivities with respect to the uncer-
tain model parameters can be extended to nonlinear systems undergoing rest-to-rest
maneuver, and has been shown to result in robust control by Liu and Singh [5].
If knowledge of the range of uncertainty or the probability distribution function
(pdf) of the uncertain parameter is available, developing control algorithms that can
exploit this knowledge in the design of the pre-Ô¨Ålters or feedback controllers seems
patent. One can consider a worst case design over the domain of uncertainty. This
would entail design of a controller which minimizes the maximum magnitude of the
cost function over the domain of uncertainty. If the knowledge is in the form of a
pdf then minimizing the expected performance index over that pdf is an alternative
to minimizing the maximum over domain which includes regions of extreme un-
likelihood. Particularly in the case where the region of support is unbounded (e.g.,
Gaussian), one must minimax over the entire space, which is computationally chal-
lenging. For a system with one uncertain parameter, Figure 5.1 illustrates the varia-
tion of the cost function over the range of uncertainty. The objective of the control
design is to minimize the maximum magnitude of the cost over the range plb and
pub, the lower and upper bound of the uncertain parameter p. In this chapter, a mini-
max optimization problem is formulated to design controllers which are robust over
219
¬© 2010 by Taylor and Francis Group, LLC

220
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
a speciÔ¨Åed range of uncertainties. This approach can accommodate distribution of
the uncertainties. First, a technique for the design of time-delay pre-Ô¨Ålters which
shape the reference input to the system is presented. The objective of the design is to
arrive at an optimal pre-Ô¨Ålter which minimizes the maximum magnitude of the resid-
ual vibration of a system undergoing rest-to-rest maneuvers. This is followed by the
development of feedback controllers which minimize a performance index which is
an inÔ¨Ånite time horizon, integral of a quadratic function of the system states.
0 5
1
1.5
2
2.5
3
3 5
4
4.5
0
0 2
0.4
0 6
0 8
1
1 2
1.4
1 6
Cost
max
plb
pub
pnom
Figure 5.1: Cost Function Variation over Uncertain Domain
5.1
Minimax Time-Delay Filters
Minimax is a word used in decision theory, game theory and statistics when one
is interested in minmizing the worst outcome. In a control design setting, one can
consider the uncertain model parameter such as the spring stiffness to take a value
which maximizes the residual energy over the domain of uncertainty, for a rest-to-
rest maneuver. The minimax control objective is to determine the parameters of
the controller to minimize the worst (i.e., largest) residual energy. This worst case
¬© 2010 by Taylor and Francis Group, LLC

Minimax Control
221
design obviously trades off performance in the nominal case for robustness. This
section will formulate the optimization problem for the design of time-delay Ô¨Ålters
for uncertain mechanical systems undergoing rest-to-rest maneuvers.
5.1.1
Cost Function
Consider the linear mechanical system
M ¬®x
 C
 p Àôx
 K
 p x
 Du
(5.1)
where x represents the generalized coordinates and M the mass matrix is positive
deÔ¨Ånite, C, and K the damping and stiffness matrices are positive deÔ¨Ånite or positive
semideÔ¨Ånite. The stiffness matrix is positive semideÔ¨Ånite when the system includes
rigid body modes. p is a vector of uncertain parameters which satisÔ¨Åes the con-
straints:
plb
i
  pi
  pub
i
(5.2)
where plb
i and pub
i
represent the lower and upper bound on the pth
i parameter. Since
the objective of a rest-to-rest maneuver is to move the system from its initial state
of rest to the Ô¨Ånal state of rest, it is natural to consider the residual energy of the
system at the end of the maneuver as the cost function. For systems without rigid
body modes, the sum of the kinetic and potential energy at the end of the maneuver
F
 tf
  1
2 ÀôxT M Àôx
  1
2
 x
 xf
 T K
 p  x
 xf

(5.3)
evaluated at time tf captures the total residual energy in the system. xf corresponds
to the Ô¨Ånal position of the displacement states. For systems with rigid body modes, to
force F
 tf
  to be positive deÔ¨Ånite, a pseudo-potential energy term needs to be added
to the kinetic and potential energy [6]. The pseudo-potential energy term is equal to
zero when the rigid body mode has zero energy. The augmented cost function is
F
 tf
  1
2 ÀôxTM Àôx
  1
2xTK
 p  x
 1
2
 xr
 xr f
 2
(5.4)
where xr refers to the rigid body displacement and xr f is the Ô¨Ånal desired position of
the rigid body. In the rest of this chapter, the term residual energy will be used to
refer to both functions given by Equations (5.3) or (5.4).
For the design of robust controllers where the domain of uncertainty of the vector
of uncertain parameter p is speciÔ¨Åed, a minimax optimization problem can be formu-
lated to minimize the maximum magnitude of the residual energy over the domain
of uncertainty. Assuming the distribution of the uncertain parameters is uniform, the
minimax cost is
min
q
max
p
 1
2 ÀôxTM Àôx
  1
2xTKx
  1
2
 xr
 xr f
 2
 (5.5)
where q is the vector of parameters which deÔ¨Ånes the controller.
¬© 2010 by Taylor and Francis Group, LLC

222
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
1
2
3
4
0.4
0 6
0 8
1
plb
pub
1
2
3
4
0.4
0 6
0 8
1
plb
pub
1
2
3
4
0.4
0 6
0 8
1
plb
pub
1
2
3
4
0.4
0 6
0 8
1
plb
pub
Uniform Distribution
Gaussian Distribution
Triangular Distribution
Manhattan Distribution
Figure 5.2: Typical Uncertainty Distributions
Provided knowledge of the distribution of the uncertainties exist, they can be easily
included into the cost function. If the distribution is Gaussian, the cost function is
min
q
max
p
e
  p  pnom
 T Œì
 1
 p  pnom
  1
2 ÀôxTM Àôx
  1
2xTKx
  1
2
 xr
 xr f
 2
 (5.6)
where Œì is the covariance matrix of the Gaussian distribution and pnom is the vector
of nominal value of the uncertain parameters. The Œì matrix is diagonal if all the un-
certain parameters are independent. For distributions whose support is unbounded,
one can limit the support to include 95‚Äì99% of the most likely values. Figure 5.2
illustrate some of the distributions for a single uncertain parameter case, that one
can exploit in the design of the minimax controller. These distributions can be nor-
malized such that the area under the curve is equal to one. However, this is not
necessary since the optimization algorithm uses these distributions to differentially
weight various parameter sets over the uncertain domain.
5.1.2
Van Loan Identity
First, a technique for the design of pre-Ô¨Ålters for the vibratory systems will be
presented where the pre-Ô¨Ålter is parameterized as a time-delay Ô¨Ålter
u
 N
‚àë
i 0
AiH
 t
 Ti
 (5.7)
¬© 2010 by Taylor and Francis Group, LLC

Minimax Control
223
where H
 t
 Ti
  is the Heaviside function, T0 is zero and N is the number of delays
in the Ô¨Ålter. From Equation (5.7), it is clear that the input u can be represented by
a sum of delayed step inputs and since the system we are considering is linear, the
magnitude of the states at any time can be determined by the sum of the states at
any time due to each of the delayed step inputs. The van Loan identity is an efÔ¨Åcient
technique for the calculation of the states of a system subject to a step input, at any
time.
Consider the state-space model of a system
Àôz
  Az
 Bu where z
  x
Àôx
   Rn
 u
  R1
 (5.8)
To determine the response of the system (Equation 5.8) to a unit step input, construct
the matrix
P
  A B
0 0
 (5.9)
which is a Rn  1  n  1 matrix. Using the van Loan identity [7], one can show that
Z
  ePT
  eAT
  T
0 eA  T
 œÑ
 B dœÑ
0
I
 (5.10)
It can be seen that the upper right hand term of the matrix Z is the convolution in-
tegral of the system given by Equation (5.8) subject to a unit step input. Thus, the
value of the states at time T for a unit step input are given by the Ô¨Årst n rows of
the last column of Z. This permits us to calculate the Ô¨Ånal states for a step input
accurately, without numerical integration. This is very attractive for numerical opti-
mization where a signiÔ¨Åcant cost of optimizing dynamical system is contributed by
the numerical simulation of the response of the system. For instance, the response of
the system represented by Equation (5.8) to the input represented by Equation (5.7)
is given by the Ô¨Årst n rows of the last column of the matrix
Œ¶
 n
‚àë
i 0
AieP  Tn
 Ti
  (5.11)
The optimization algorithms which are used to solve minimax problems are gen-
erally gradient based. Thus, the accuracy and the speed of the optimization can be
increased by providing analytical gradients to the optimization algorithm. Fortu-
nately, for the time-delay control, closed form equations representing the gradients
of the cost and constraints can be easily derived as shown below.
For the optimization algorithm, we require the value of the gradient of the cost F
and the constraints, with respect to the controller parameters. For the control given
by Equation (5.7), the gradients of F (Equation 5.3) with respect to Ai and Ti are
given by
dF
dAi
  ÀôxTM d Àôx
dAi
  x
 xf
TK dx
dAi
(5.12)
¬© 2010 by Taylor and Francis Group, LLC

224
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
and
dF
dTi
  ÀôxTM d Àôx
dTi
  x
 xf
T K dx
dTi
(5.13)
evaluated at the Ô¨Ånal time. To determine dx
dAi , dx
dAi and dx
dTi , dx
dTi , we require the deriva-
tive of the state Equation (5.8). The solution of the equation
dÀôz
dAi
  A dz
dAi
 BH
t
 Ti
 i = 0, 1, 2, 3, ...
(5.14)
can be derived using the van Loan identity as described earlier. Similarly the solution
of equation
dÀôz
dTi
  A dz
dTi
 B  AiŒ¥
 t
 Ti
 i = 1, 2, 3, ...
(5.15)
where Œ¥
    is the dirac delta function, can be shown to be
dz
dTi
 Tf
 
 Ai exp A  Tf
 Ti
  B  (5.16)
With the analytical gradients, we can expedite the convergence of the optimization
algorithm.
5.1.3
Pre-Filter Design
This section focuses on the design of time-delay Ô¨Ålters which modify the refer-
ence input to the underdamped system so as to minimize the maximum magnitude
of the residual vibration over the range of uncertainty, for a rest-to-rest maneuver.
The benchmark spring-mass-dashpot system will be used to illustrate the minimax
controller.
m
k
c
 x
 u
Figure 5.3: Spring-Mass-Dashpot System
The equation of motion of the spring-mass-dashpot system illustrated in Figure 5.3
is
¬© 2010 by Taylor and Francis Group, LLC

Minimax Control
225
m¬®x
 cÀôx
 kx
  ku
(5.17)
where it is assumed that the coefÔ¨Åcient of stiffness is uncertain and lies in the range
0  7
  k
  1  3  (5.18)
In Chapter 2, it was shown that a single time-delay Ô¨Ålter that is designed to locate a
pair of zeros of the time-delay Ô¨Ålter at the nominal location of the underdamped poles
of the system results in a Ô¨Ånite-time interval for a rest-to-rest maneuver. This solution
corresponds to the Posicast solution [8]. It has also been shown that by cascading
this single time-delay Ô¨Ålter, i.e., locating multiple pairs of zeros of the time-delay
Ô¨Ålter at the nominal location of the underdamped poles, results in robustness around
the nominal poles of the system [9]. In this design, the only information necessary is
the location of the nominal poles of the system. Often, the range of uncertainty and
the distribution of uncertainty is known in addition to the nominal parameters of the
system. The technique presented in this chapter endeavors to exploit this knowledge
in the design of a robust pre-Ô¨Ålter. Since the basic robust time-delay Ô¨Ålter consists
of two time-delays, we start by studying the minimax problem by considering the
two-time-delay Ô¨Ålter. The transfer function of the time-delay Ô¨Ålter is:
u  s r
s  A0
 A1exp  sT1
  A2exp  sT2
  (5.19)
To ensure that the steady-state value of u  s  is the same as the reference input r
 s ,
we require
A0
 A1
 A2
  1  (5.20)
The optimization problem can be stated as the determination of A0, A1, A2, T1, and
T2 of the time-delay Ô¨Ålter so as to
min
Ti
 Ai max
k
 1
2mÀôy2
  1
2k
 y
 1  2
(5.21)
evaluated at T2.
The optimization toolbox of MATLAB is used to solve the minimax optimization
algorithm. The optimal minimax time-delay Ô¨Ålter for a system with a nominal mass
of m = 1, nominal damping coefÔ¨Åcient of c = 0.2, and with the uncertain stiffness
range being speciÔ¨Åed by Equation (5.18), is given by the transfer function
u  s r
s  0  3452
 0  4730e
 3  1703s
 0  1818e
 6  3405s
 (5.22)
Figure 5.4 (dotted line) illustrates the variation of the residual energy of the sys-
tem as a function of the uncertain parameter k. It can be seen that the maximum
magnitude of the residual energy in the range of the uncertain parameters occurs
at the bounding limits (k = 0.7, k = 1.3) and at a value of k which lies between
the limits. It is also clear that the maximum magnitude of the residual energy is
¬© 2010 by Taylor and Francis Group, LLC

226
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
signiÔ¨Åcantly smaller than that resulting from the robust time-delay Ô¨Ålter deÔ¨Åned by
Equation (2.40) over the entire range of k. However, at the nominal value of k = 1, the
minimax solution has a large magnitude of residual vibration. The minimax solution
is similar to the extra-insensitive input shaper proposed by Singhose et al. [10] where
an optimization problem is formulated by deÔ¨Åning the magnitude of residual vibra-
tion permitted at the nominal value of the uncertain parameter and solving for the
magnitudes of a sequence of impulses. The impulse sequence is required to satisfy
the constraints that the magnitude of the residual vibration is zero at two frequencies
which Ô¨Çank the nominal value and the slope of the residual energy distribution is
zero at the nominal value of the uncertain parameter.
0 6
0.7
0.8
0 9
1
1.1
1.2
1.3
1.4
0
0.01
0.02
0.03
0.04
0.05
0.06
0.07
0.08
0.09
0.1
Spring Stiffness k
Nonrobust 1-Time-Delay Control
Robust 2-Time-Delay Control
Minimax 2-Time-Delay Control
Square Root of Residual Energy
Figure 5.4: Residual Vibration Distribution
The trade-off resulting from the minimax design is evident from Figure 5.4. Min-
imizing the maximum magnitude of the residual vibration over the range of uncer-
tainty has required an increase in the magnitude of residual vibration at and near the
nominal value of the uncertain parameter. To address this disadvantage, an additional
constraint can be included in the optimization problem which requires the magnitude
of the residual vibration at the nominal value of k, be forced to zero. This can only
be achieved by adding a time-delay to the two time-delay Ô¨Ålter, which implies that
the maneuver will take longer. The transfer function of this pre-Ô¨Ålter is
u  s r
s  A0
 A1exp  sT1
  A2exp  sT2
  A3exp  sT3
  (5.23)
The unknown parameters of Equation (5.23) are solved for using the solution of
the parameters of three nonrobust time-delay Ô¨Ålters in cascade, as the initial guess.
¬© 2010 by Taylor and Francis Group, LLC

Minimax Control
227
The transfer function of the minimax time-delay controller with the constraint to
force the residual vibration to be zero at the nominal value of k can be shown to be
u  s r
s  0  2052
 0  4141e
 3  1652s
 0  3015e
 6  3304s
 0  07924e
 9  4956s
 (5.24)
Figure 5.5 illustrates the distribution of the residual energy of the time-delay Ô¨Ålter
designed by cascading three nonrobust time-delay Ô¨Ålters (solid line) and the minimax
time-delay Ô¨Ålter (dashed line). It is clear from Figure 5.5 that the maximum magni-
tude of the residual energy of the minimax controller over the uncertain range (0.7
 k
  1.3), is signiÔ¨Åcantly smaller than the robust three-time-delay controller, which is
a metric to gauge the robustness of the controllers. One should note that the improved
performance at and near the nominal value of the uncertain parameter is acquired at
a cost of an increase in the maneuver time compared to the two-time-delay Ô¨Ålter.
0 6
0.7
0.8
0 9
1
1.1
1.2
1.3
1.4
0
0.005
0.01
0.015
0.02
0.025
Spring Stiffness k
Square Root of Residual Energy
Robust 3-Time-Delay Control
Minimax 3-Time-Delay Control
Figure 5.5: Residual Vibration Distribution
The proposed technique for the design of minimax controller can be extended to
systems with multiple uncertain parameters. For instance, assuming that the coefÔ¨Å-
cient of stiffness and damping for the single mass-spring-dashpot system, lie in the
uncertain region:
0  7
  k
  1  3   and 0 1
  c
  0  2
(5.25)
the resulting two-time-delay minimax pre-Ô¨Ålter has the transfer function
u  s r
s  0  3380
 0  4732e
 3  1541s
 0  1888e
 6  3082s
(5.26)
¬© 2010 by Taylor and Francis Group, LLC

228
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
which is slightly different from the Ô¨Ålter designed assuming that only the coefÔ¨Åcient
of stiffness is uncertain. Figure 5.6 illustrates the variation of the residual energy as
a function of the two uncertain parameters.
0.6
0.8
1
1.2
1.4
0.1
0.15
0.2
0.25
0.3
0 35
0
0.02
0.04
0.06
0.08
0.1
0.12
0.14
0.16
Spring Stiffness
Damping Constant
Residual Energy
Figure 5.6: Residual Vibration Distribution
Including the constraint that the residual energy be zero at the nominal parameters
of the system results in a three-time-delay Ô¨Ålter with a transfer function:
u  s r
s  0  1961
 0  4123e
 3  1574s
 0  3092e
 6  3148s
 0  0823e
 9  4722s
 (5.27)
Figure 5.7 illustrates the variation of the residual energy as a function of the two
uncertain parameters where it is clear that the maximum magnitude of the residual
energy is signiÔ¨Åcantly smaller than that of the two-time-delay pre-Ô¨Ålter case.
5.1.4
Minimax Filter Design for Multi-Input Systems
The technique for the design of minimax preÔ¨Ålters can be extended to multi-input
systems [11]. Figure 5.8 illustrates a two-mass-spring system with two inputs. The
equations of motion of the system are
 m1 0
0 m2
  ¬®y1
¬®y2
   k1
 k2
 k2
 k2
k2
  y1
y2
  ¬© 2010 by Taylor and Francis Group, LLC

Minimax Control
229
0.6
0.8
1
1.2
1.4
0.1
0.15
0.2
0.25
0.3
0 35
0
0.01
0.02
0.03
0.04
0.05
0.06
0.07
Spring Stiffness
Damping Constant
Residual Energy
Figure 5.7: Residual Vibration Distribution
m1
m2
k 2
k 1
u 1
y 1
u 2
y 2
Figure 5.8: Two-Input Oscillator
 1 0
0 1
  u1
u2
  (5.28)
The goal is to design a time-delay Ô¨Ålter with the objective of completing a rest-to-rest
maneuver with the boundary conditions:
y1
 0   y2
 0   Àôy1
 0   Àôy2
 0   0
(5.29)
y1
 tf
   2  y2
 tf
  1   Àôy1
 tf
   Àôy2
 tf
  0  (5.30)
and which it is robust to uncertainties in the spring stiffness k1 and k2. It is assumed
that the uncertain parameters lie in the range:
0  7
  k1
  1  3 and 0  7
  k2
  1  3  (5.31)
¬© 2010 by Taylor and Francis Group, LLC

230
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
To permit design of time-delay Ô¨Ålters whose Ô¨Ånal values when subject to a unit step
input are the same as the desired Ô¨Ånal displacement of the two outputs, the control
input is rewritten as
  u1
u2
   k1
 k2
 k2
 k2
k2
     nominal
 v1
v2
 (5.32)
The Ô¨Ånal values of the new control inputs to satisfy the boundary conditions are now
given as
  v1
v2
    2
1

(5.33)
since the Ô¨Ånal displacements of the two masses are y1
 tf
   2  y2
 tf
  1. Assuming
the nominal values of the spring stiffness are k1 = 1, k2 = 1, the Ô¨Ånal values of
the control inputs can be calculated to be u1 = 3, u2 = ‚Äì1. A minimax problem is
formulated to minimize the maximum magnitude of the residual energy of the system
over the domain of uncertainty deÔ¨Åned by Equation (5.31). The transfer functions of
the time-delay Ô¨Ålters are parameterized as
G1
 s  N
‚àë
i 0
A1i exp
  sT1i
  where T10
  0
(5.34)
G2
 s  N
‚àë
i 0
A2i exp
  sT2i
  where T20
  0
(5.35)
where N is the number of delays in the time-delay Ô¨Ålter. The minimax optimization
problem is used to solve for A1i, T1i, A2i, and T2i. The following constraints are
imposed on the optimization problem. To ensure that the systems states are quiescent
at the Ô¨Ånal time, and since the system modes cannot be decoupled, we require
T1N
  T2N
 (5.36)
Further, we require
 ‚àëN
i 0A1i
‚àëN
i 0A2i
   y1
 tf
 y2
 tf
  (5.37)
where tf is the Ô¨Ånal maneuver time.
To compare the performance of the minimax time-delay Ô¨Ålter to conventional Ô¨Ål-
ters, two classes of Ô¨Ålters are considered. The Ô¨Årst is designed to cancel the un-
damped poles of the system which is given by the time-delay Ô¨Ålters
¬© 2010 by Taylor and Francis Group, LLC

Minimax Control
231
G1
 s  2  1
2
  1
2 exp  s œÄ
œâ1
   1
2
 1
2 exp  s œÄ
œâ2
  (5.38)
G2
 s   1 1
2
 1
2 exp  s œÄ
œâ1
   1
2
 1
2 exp  s œÄ
œâ2
  (5.39)
where œâ1 and œâ2 are the nominal frequencies of the controlled system. Next, a
minimax problem is solved for the same number of delays as in Equations (5.38)
and (5.39). The optimal parameters of the minimax time-delay Ô¨Ålter are given in
Table 5.1.
A1i
0.5200
0.5954
0.5344
0.3503
T1i
0.0
3.3688
6.3719
12.1535
A2i
0.3630
‚Äì0.5139
0.7001
0.4508
T2i
0
1.6853
6.8284
12.1535
Table 5.1: Minimax Time-Delay Filter Parameters
Figures 5.9 and 5.10 illustrate the variation of the residual energy of the nonrobust
and the corresponding minimax preÔ¨Ålters. It is clear that for the nominal model, the
nonrobust Ô¨Ålter results in zero residual energy. However, over the entire uncertain
region, the minimax Ô¨Ålter outperforms the nonrobust Ô¨Ålter.
The second is the robust time-delay Ô¨Ålter designed by locating multiple zeros of
the time-delay Ô¨Ålter at the estimated location of the poles of the system, which is
given by the transfer functions:
G1
 s   2 1
4
 1
2 exp
  s œÄ
œâ1
   1
4 exp 2s œÄ
œâ1
   1
4
  1
2 exp
  s œÄ
œâ2
   1
4 exp 2s œÄ
œâ2
  (5.40)
G2
 s   1 1
4
 1
2 exp
  s œÄ
œâ1
   1
4 exp 2s œÄ
œâ1
   1
4
  1
2 exp
  s œÄ
œâ2
   1
4 exp 2s œÄ
œâ2
  (5.41)
Next, a minimax time-delay Ô¨Ålter is designed to minimize the maximum magnitude
of the residual energy of the uncertain domain and the optimal parameters of the
time-delay Ô¨Ålter are given in Table 5.2.
¬© 2010 by Taylor and Francis Group, LLC

232
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
0.6
0.8
1
1.2
1.4
0.6
0.8
1
1.2
1.4
0
0.05
0.1
0.15
0 2
0.25
0 3
0.35
k1
k2
Square Root of Residual Energy
Figure 5.9: Residual Vibration Distribution (Nonrobust Filter)
From Figures 5.11 and 5.12, it can be seen that the maximum magnitude of the
square root of the residual energy over the uncertain region reduces from 0.0762 to
0.0116, an 85% reduction.
The minimax approach presented in this section for the design of pre-Ô¨Ålters for
systems which are open-loop stable, or which have been stabilized using feedback
controller provide a simple approach for desensitizing the performance variation
of uncertain linear systems, provided the domain and distribution of uncertainty is
A1i
T1i
A2i
T2i
0.1014
0
0.1003
0
0.1568
2.2897
‚Äì0.0867
5.0907
0.3376
4.7851
0.1551
5.0907
0.2147
7.0169
0.0678
6.6232
0.2609
8.0249
0.1571
8.2987
0.2843
10.2515
‚Äì0.1312
11.6788
0.3379
12.2812
0.3658
11.8754
0.2127
14.8886
0.2104
15.1427
0.0938
18.6908
0.1613
18.6908
Table 5.2: Minimax Time-Delay Filter Parameters
¬© 2010 by Taylor and Francis Group, LLC

Minimax Control
233
0.6
0.8
1
1.2
1.4
0.6
0.8
1
1.2
1.4
0.01
0.02
0.03
0.04
0.05
0.06
0.07
0.08
0.09
k1
k2
Square Root of Residual Energy
Figure 5.10: Residual Vibration Distribution (Minimax Filter)
known. The applicability of the minimax optimization algorithm for the design of
full state feedback controller is an obvious question to pose. The next section will
expound techniques that have been proposed by Bryson et al. [12,13] for the design
of controllers which minimize the maximum quadratic function of the systems states
and control.
5.2
Minimax Feedback Controllers
We will Ô¨Årst consider the design of feedback controller for uncertain systems
where knowledge of the range and distribution of uncertainties are known. A mini-
max optimization problem is formulated to arrive at feedback gains to minimize the
worst performance of a plant over the uncertain space. The cost function which will
be minimized is the integral of a quadratic function of the states and control:
J
   ‚àû
0
 xTQx
 uTRu
 dt
(5.42)
where we assume that the initial conditions of the system are modeled as a Gaussian
random vector with zero mean and a covariance of Œ£
¬© 2010 by Taylor and Francis Group, LLC

234
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
0.6
0.8
1
1.2
1.4
0.6
0.8
1
1.2
1.4
0
0.01
0.02
0.03
0.04
0.05
0.06
0.07
0.08
k1
k2
Square Root of Residual Energy
Figure 5.11: Residual Vibration Distribution (Robust Control)
Œ£
  E
 x 0  x 0  T
  (5.43)
Consider the set of control laws speciÔ¨Åed in a full state feedback form,
u
  Kx
(5.44)
the cost function can be represented as
J
   ‚àû
0 xT
 Q
 KTRK
x dt
(5.45)
where the closed-loop dynamics are:
Àôx
  Ax
 Bu

A
 BK
x (5.46)
  x t
  exp  A
 BK
 t
 x0   (5.47)
The resulting cost function is
J
   ‚àû
0 x 0  T exp  A
 BK
 t
 T
 Q
KTRK
exp  A
 BK
 t
 x0   dt
(5.48)
which is a function of the uncertain initial conditions as well as K. DeÔ¨Åne
¬© 2010 by Taylor and Francis Group, LLC

Minimax Control
235
0 6
0 8
1
1.2
1.4
0.6
0.8
1
1 2
1.4
0
0.002
0.004
0.006
0.008
0 01
0.012
k1
k2
Square Root of Residual Energy
Figure 5.12: Residual Vibration Distribution (Minimax Control)
P
   ‚àû
0 exp
  A
 BK
 t
 T
 Q
KTRK
exp
  A
 BK
 t
  dt
 (5.49)
which permits representing the cost function as:
J
  x 0  TPx 0   (5.50)
From the deÔ¨Ånition of derivatives, it can be shown that
d
dt
  t
t0
œÜ
 t
 œÑ
 dœÑ
 œÜ
t
 t
 
  t
t0
‚àÇœÜ
‚àÇt
 t
 œÑ
 dœÑ
 (5.51)
Using this result, the derivative of P with respect to time results in
dP
dt
  exp  A
 BK
 0  T
 Q
KTRK
exp  A
 BK
 0     ‚àû
0
‚àÇ
‚àÇt
 exp  A
 BK
 t
 T
  Q
KTRK
exp
  A
 BK
 t
  dt

  ‚àû
0 exp
  A
 BK
 t
 T
 Q
KTRK
 ‚àÇ
‚àÇt
 exp
  A
 BK
 t
   dt
(5.52)
which can be simpliÔ¨Åed to
¬© 2010 by Taylor and Francis Group, LLC

236
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
dP
dt
  Q
KTRK

 A
 BK
T
  ‚àû
0
 exp  A
 BK
 t
 T
  Q
KTRK
exp  A
 BK
 t
  dt

  ‚àû
0 exp
  A
 BK
 t
 T
 Q
KTRK

 exp  A
 BK
 t
   dt
A
 BK
 (5.53)
or
dP
dt
  Q
KTRK


 A
 BK
TP
P  A
 BK
 (5.54)
Since, for stable systems, P tends to a constant matrix as time tends to ‚àû, P at steady
state can be solved from Equation (5.54) by forcing dP
dt to zero, which satisÔ¨Åes the
Algebraic Lyapunov Equation (ALE)
P  A
 BK
 
A
 BK
 TP

 Q
KTRK
  (5.55)
The cost function can now be rewritten as
J
   ‚àû
0 xT
 Q
 KTRK
x dt

   ‚àû
0 xT
 P  A
 BK
 
A
 BK
 TP  x dt

   ‚àû
0 xT PÀôx
  ÀôxTPx dt
    ‚àû
0
d
dt xTPx dt
(5.56)
which can be simpliÔ¨Åed to
J
   xTPx
  tf
  xT Px
  t0
   x 0  TPx 0  (5.57)
where x 0   corresponds to the random initial conditions. The cost can be rewritten
as
J
  E
 x 0  TPx 0     tr
 E

x0  x 0  T P
    tr
Œ£P 
(5.58)
where tr
   is the trace operator. Thus, solving the ALE Equation (5.55), one can
calculate the integral quadratic cost for any feedback gain matrix. This simple tech-
nique can be exploited to optimize the feedback gain matrix to minimize the integral
cost function. A simple example is used to illustrate the determination of the integral
quadratic cost as a function of an uncertain variable.
Example 5.1: Consider a unity mass, spring-mass-dashpot system
¬®y
 cÀôy
 ky
  0
(5.59)
¬© 2010 by Taylor and Francis Group, LLC

Minimax Control
237
where the damping factor c is a variable. The state space model of the system is
 Àôx1
Àôx2
   0
1
 k
 c
  x1
x2
 (5.60)
where x1 = y. The quadratic cost function
J
   ‚àû
0
 x1
x2
 T
 1 0
0 1
  x1
x2
 dt
 (5.61)
for random initial conditions with a variance of Œ£ is
J
  tr
 Œ£
 c2
 k2
 k
2ck
1
2k
1
2k
k  1
2kc
  (5.62)
Figure 5.13 illustrates the variation of J as a function of c assuming that the covari-
ance matrix Œ£ is the identity matrix. The solid line corresponds to the variable J.
Since the system is stable only for c greater than 0, we are only interested in the
graph which corresponds to c
  0. It can be seen that for k
  1, c
  2 is the opti-
mal solution which corresponds to the critically damped case. However, it can be
seen that the graph has a discontinuity around the origin which corresponds to the
transition from the stable to the unstable region. To prevent this, a scaled version
of the negative of the reciprocal of J is plotted and is shown by the dashed line. It
is clear that the minimum of this function coincides with that of J, but it does not
include the discontinuity around the origin which is a useful property for gradient
based optimization algorithms.
‚àí10
‚àí5
0
5
10
‚àí20
‚àí15
‚àí10
‚àí5
0
5
10
15
20
Quadratic Cost of States
Damping Constant c
Figure 5.13: Quadratic Cost
¬© 2010 by Taylor and Francis Group, LLC

238
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
The previous example provides the motivation for the use of the negative of the
reciprocal of the integral quadratic cost to preclude pathological conditions in the
use of gradient based optimizers.
The cost function which will be used for the design of minimax controllers is
min
K
max
p
J
 K
  p  J
K
  p  
 1  tr
 Œ£P   (5.63)
The design problem is to determine the feedback gain which minimizes the maxi-
mum magnitude of the cost (Equation 5.63) over the entire range of uncertainty. For
one or two uncertain parameters, it is reasonable to discretize the uncertain region
and determine the cost function at each of the grid points. However, for systems
with a large number of uncertainty, this does not result in a feasible approach for the
determination of the minimax solution. Bryson and Mills [12] propose to determine
the cost at the corners of the uncertain hypercube and minimize the maximum mag-
nitude of the cost over all the vertices (Figure 5.14). The small cube at the center
of the uncertain cube represents the location of the nominal plant parameter set and
the vertices of the cube are functions of the lower or upper bounds of the uncertain
parameters.
(pl
1
  pl
2
  pl
3)
(pu
1
  pl
2
  pl
3)
(pl
1
  pu
2
  pl
3)
(pu
1
  pu
2
  pl
3)
(pl
1
  pl
2
  pu
3)
(pu
1
  pl
2
  pu
3)
(pl
1
  pu
2
  pu
3)
(pu
1
  pu
2
  pu
3)
Figure 5.14: Uncertain Cube
Gradient-based optimization algorithms are used for solving the minimax prob-
lem. The cost function at any point in the uncertain hypercube is
J
  1  tr
 Œ£P  (5.64)
where P is the solution of the Lyapunov equation
P  A
 BK
 
A
 BK
 TP

 Q
KTRK
  (5.65)
¬© 2010 by Taylor and Francis Group, LLC

Minimax Control
239
The derivative of Equation (5.65) with respect to the feedback gain ki is
dP
dki
 A
 BK
 
A
 BK
 T dP
dki
 PBdK
dki
 dK
dki
T
BTP
 KTRdK
dki
  dK
dki
T
RK (5.66)
which is also a Lyapunov equation. The gradient of the cost J with respect to ki is
dJ
dki
 1
 tr
 Œ£P   2tr
 Œ£ dP
dki
 (5.67)
which can be exploited in the optimization algorithm. This technique is illustrated
next, on the Ô¨Çoating oscillator benchmark problem.
Example 5.2:
Consider the uncertain Ô¨Çoating oscillator problem shown in Fig-
ure 5.15 where the masses, spring stiffness and damping constant are all uncertain
and the uncertain region is
0  7
 





mnom
1
mnom
2
knom
cnom
 





 






m1
m2
k
c
 





  1  3
 





mnom
1
mnom
2
knom
cnom
 





(5.68)
where
   nom refers to the nominal values of the uncertain parameters. The 4-dimensional
uncertain space results in 16 vertices of the uncertain hypercube.
The equations of motion of the benchmark problem are
 m1 0
0 m2
  ¬®y1
¬®y2
    c
 c
 c c
   Àôy1
Àôy2
    k
 k
 k k
  y1
y2
   1
0

u
(5.69)
and the associated random initial conditions have the property
E
 x 0  x 0  T
   Œ£
  


1 0 0 0
0 1 0 0
0 0 1 0
0 0 0 1
 


 (5.70)
m2
m1
k
c
 y1
 y2
 u
Figure 5.15: Floating Oscillator
¬© 2010 by Taylor and Francis Group, LLC

240
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
First, an optimization problem is solved to determine the feedback gains to mini-
mize the cost function given by Equation (5.63) for the nominal plant. The optimal
gains for a nominal plant with parameters
 





mnom
1
mnom
2
knom
cnom
 





 






1  0
1  0
1  0
0  1
 





(5.71)
are
Knom
  0  2447 0  4597 0  8920 0  2556
 (5.72)
and the cost J = -0.0570.
Next, the minimax problem is solved to minimize the maximum magnitude of the
cost at the vertices of the uncertain hypercube. The resulting feedback gain is
Kminimax
  0  4067 0  2803 0  8498 0  2917
 (5.73)
Figure 5.16 illustrates the variations of tr
 Œ£P   calculated at the vertices for the gains
Knom and Kminimax for the 16 corners. Circles and squares at the top of the stems
correspond to Knom and Kminimax respectively. The Ô¨Ånal stem corresponds to the cost
of the nominal plant. The dashed lines correspond to the gain Knom and it is clear
that the maximum magnitude of the cost for the gain Kminimax had been reduced.
Concurrently the cost of the nominal plant has increased, as a trade-off.
5.2.1
Exponentially Weighted LQR Cost
The Q and the R matrices of the standard LQR cost function deÔ¨Åne the relative
penalty of the states and the control input. The penalty is not a function of time
and all state and control variations from zero are equally penalized for all time. For
applications such as the docking or the intercept problem, it is desirable to design
controllers where the penalty on the state and control excursions from zero are pe-
nalized with an exponentially growing function. The following development presents
controller design for an exponentially weighted quadratic-cost function.
Consider the cost which penalizes the integral-quadratic cost of states and control,
exponentially with time
J
   ‚àû
0 e2Œªt
 xTQx
 uTRu
 dt
(5.74)
where the initial conditions are again assumed to be random with a covariance of Œ£.
Assuming a control of the form
u
  Kx
(5.75)
the cost function can be represented as
¬© 2010 by Taylor and Francis Group, LLC

Minimax Control
241
0
2
4
6
8
10
12
14
16
18
0
2
4
6
8
10
12
14
16
18
20
Knom
Kminimax
Nominal Plant
Cost at Vertices and Nominal Plant
Quadratic Cost
Figure 5.16: Quadratic Cost
J
   ‚àû
0 e2ŒªtxT
 Q
 KTRK
x dt
(5.76)
where the closed-loop dynamics is given by the equation
x t
  exp
  A
 BK
 t
 x0  (5.77)
resulting in the cost function
J
   ‚àû
0 e2Œªtx 0  T exp  A
 BK
 t
 T
Q
KTRK
 exp  A
 BK
 t
  x0   dt
(5.78)
DeÔ¨Åning
P
   ‚àû
0 exp  A
 BK
 ŒªI
 t
 T
Q
KTRK
 exp  A
 BK
 ŒªI
t
 dt
 (5.79)
it can be easily shown that the steady state value of P satisÔ¨Åes the Lyapunov equation
P  A
 BK
 ŒªI

 A
 BK
 ŒªI
TP

 Q
 KTRK
 (5.80)
and the cost function can be written in terms of the initial conditions as
¬© 2010 by Taylor and Francis Group, LLC

242
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
J
  x 0  TPx 0  (5.81)
where x 0   corresponds to the random initial conditions. The cost can be rewritten
as
J
  E
 x 0  TPx 0     tr
 E

x0  x 0  T P
    tr
Œ£P 
(5.82)
Since, J has a discontinuity for parameters corresponding to the transition from the
stable to the unstable region, the cost function used for the minimax optimization
problem is
J
  1  tr
 Œ£P   (5.83)
The gradient of J with respect to the controller parameters requires the derivative of
the Lyapunov Equation (5.80),
dP
dki
 A
 BK
 ŒªI

 A
 BK
 ŒªI
T dP
dki
 PBdK
dki
  dK
dki
T
BTP
 KTRdK
dki
  dK
dki
T
RK
(5.84)
which is also a Lyapunov equation. The gradient of the cost J with respect to ki is
then
dJ
dki
 1
 tr
 Œ£P   2tr
 Œ£ dP
dki
 (5.85)
Example 5.3:
The exponentially weighted minimax control design is illustrated on the Ô¨Çoating
oscillator benchmark problem with the same uncertainty as in Example 5.2. The
coefÔ¨Åcient of exponential penalty Œª is selected to be 0.1. First, the exponentially
weighted cost function is used to solve for the feedback gains which is optimal for
the nominal plant. The resulting feedback gains are
Knom
  0  4816 0  2644 1  2703 0  2959
 (5.86)
and the cost J = ‚Äì0.0168.
Minimizing the maximum cost over the four-dimensional uncertain hypercube re-
sults in the feedback gains
Kminimax
  0  7874
 0  1061 1  7298 0  3586
 (5.87)
and the cost J = ‚Äì0.0128 at the nominal plant. Figure 5.17 illustrates the varia-
tions of tr
 Œ£P   calculated at the vertices for the gains Knom and Kminimax for the 16
corners. Circles and squares at the top of the stems correspond to Knom and Kminimax
respectively. The Ô¨Ånal stem corresponds to the cost of the nominal plant. The dashed
lines correspond to the gain Knom and it is clear that the maximum magnitude of the
¬© 2010 by Taylor and Francis Group, LLC

Minimax Control
243
0
2
4
6
8
10
12
14
16
18
0
20
40
60
80
100
120
140
Nominal Plant
Knom
Kminimax
Cost at Vertices and Nominal Plant
Quadratic Cost
Figure 5.17: Quadratic Cost
cost for the gain Kminimax had been reduced. Concurrently the cost of the nominal
plant has increased, as a trade-off.
Figure 5.18 illustrates the variation of the reciprocal of the integral-quadratic func-
tion of the states and control input as a function of % variation of the model parame-
ters from the nominal parameter set. A œÉ of zero corresponds to the cost function for
the nominal plant and for any œÉ greater than 0, the largest cost evaluated over the set
of plants corresponding to the vertices of the uncertain hypercube is plotted. When
the graph goes to zero, that corresponds to the transition from a stable to an unstable
region. These graphs are generated for the standard LQR problem, the proposed cost
function evaluated for the nominal plant and a minimax problem solved for a œÉ of
0.3. Two other curves are generated where the integral-quadratic cost is penalized
by an exponentially increasing function of time for a Œª equal to 0.1.
The larger the cost for œÉ equal to 0, the better the integral-quadratic cost. The
dashed line corresponds to the LQR problem, and the solid lines corresponds to
the solution of a optimization problem using the cost J
  1  tr
 Œ£P  . Here the
maximum magnitude of J
  1  tr
 Œ£P   is minimized with a œÉ of 0.3. It can be
seen that the solution of the minimax optimization results in increased gain margin
compared to the curve corresponding the solution based on the nominal plant only.
It is also clear that the performance of the nominal plant deteriorates. This is an
expected trade-off. It can also be seen that as the exponential penalty increases,
the gain-margin increases with a corresponding decrease in the performance for the
¬© 2010 by Taylor and Francis Group, LLC

244
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0
0.005
0.01
0.015
0.02
0.025
0.03
œÉ
1/tr(P)
Œª = 0
Œª = 0.2
Minimax with Œª = 0
Minimax with Œª = 0.2
Figure 5.18: % Variation of Model Parameters
nominal plant. Thus, the effect of including an exponential weight has the same
effect as designing a minimax controller with a larger uncertain hypercube.
5.2.2
Minimax Output Feedback Controller
This section considers the problem of design of an output feedback controller to
minimize the integral-quadratic cost
J
   ‚àû
0
 yTQy
 uTRu
 dt
(5.88)
for the linear system
Àôxp
  Apxp
 Bpu
(5.89)
y
  Cpxp
(5.90)
where the subscript p refers to the plant. xp represents a Rn vector, u is a Rm
dimensional input vector and y is a Rl dimensional output vector. Parameterizing
the controller via a controllable canonical state-space model
Àôxc
  Acxc
 Bcy
(5.91)
u
  Ccxc
(5.92)
where the input to the controller is the output of the plant and the output of the
controller is the input to the plant. xc represents a Rq vector and the matrix Ac is
¬© 2010 by Taylor and Francis Group, LLC

Minimax Control
245
parameterized by q variables. The controller can be parameterized by q
  qm
  ml
variables. Equations (5.89) through (5.92) can be combined resulting in the aug-
mented state-space model
 Àôxp
Àôxc
    Ap
BpCc
BcCp
Ac

xp
xc

(5.93)
and the cost function can be rewritten as
J
   ‚àû
0
 xp
xc
 T
CT
p QCp
0
0
CT
c RCc
  xp
xc

dt
(5.94)
It can be easily shown that the cost J can be reduced to the form
J
  x 0  TPx 0  (5.95)
where x 0   corresponds to the initial states of the augmented system, i.e., x  0  T
  xp
 0   xc
 0   and P is the solution of the Lyapunov equation
 Ap
BpCc
BcCp
Ac
 T
P
 P
 Ap
BpCc
BcCp
Ac

   CT
p QCp
0
0
CT
c RCc
  (5.96)
Example 5.4:
Consider the benchmark Ô¨Çoating oscillator problem shown in Fig-
ure 5.19.
m2
m1
k
c
 x1
 x2
 u
Figure 5.19: Floating Oscillator
The state-space model of the system is given as
 





Àôx1
Àôx2
¬®x1
¬®x2
 





 



0
0
1
0
0
0
0
1
  k
m1
k
m1
  c
m1
c
m1
k
m2
  k
m2
c
m2
  c
m2
 









x1
x2
Àôx1
Àôx2
 





 






0
0
1
m1
0
 





u
(5.97)
y
  1 0 0 0
 






x1
x2
Àôx1
Àôx2
 





(5.98)
¬© 2010 by Taylor and Francis Group, LLC

246
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
where the uncertain parameters lie in the range
0  7
 





mnom
1
mnom
2
knom
cnom
 





 






m1
m2
k
c
 





  1  3
 





mnom
1
mnom
2
knom
cnom
 





(5.99)
where
   nom refers to the nominal values of the uncertain parameters.
Parameterizing the controller in state-space form as
 





Àôw1
Àôw2
Àôw3
Àôw4
 





 



0 1 0 0
0 0 1 0
0 0 0 1
a1 a2 a3 a4
 









w1
w2
w3
w4
 





 






0
0
0
1
 





y
(5.100)
u
  c1 c2 c3 c4
  





w1
w2
w3
w4
 





(5.101)
where eight variables of the controller need to be determined so as to minimize the
integral quadratic cost function.
First, an optimization problem is solved to determine the variables of the state-
space controller to minimize the cost function
J
   ‚àû
0
 y2
1
 u2
 dt
(5.102)
for the nominal plant
 





mnom
1
mnom
2
knom
cnom
 





 






1
1
1
0  1
 





 (5.103)
The optimal controller is given by the state-space equations







Àôw1
Àôw2
Àôw3
Àôw4
 





 



0
1
0
0
0
0
1
0
0
0
0
1
 0  1389
 0  6571
 1  5979
 2  7144
 









w1
w2
w3
w4
 





 






0
0
0
1
 





y
(5.104)
u
   0  0275
 0  2504
 0  4906
 1  3703
  





w1
w2
w3
w4
 





(5.105)
and the cost J
  23  7517. The controller written in a transfer function form is
¬© 2010 by Taylor and Francis Group, LLC

Minimax Control
247
u  s ys 
 1  3703s3
 0  4906s2
 0  2504s
 0  0275
s4
 2  7144s3
 1  5979s2
 0  6571s
 0  1389
 (5.106)
A full state feedback controller with the same cost function results in the state
feedback gain
Knom
  0  6391 0  3609 1  0962 0  7143
 (5.107)
and the cost J = 3.9873. Figure 5.20 illustrates the robustness of the state feedback
and output feedback controllers optimized for the same cost function. It is clear that
the gain margin of the state feedback controller is signiÔ¨Åcantly greater than the output
feedback controller. Furthermore, the performance of the state feedback controller
for the nominal plant is better than that of the output feedback controller. This is due
to the fact that the state at time t contains complete information of how the future
will evolve when given the input, while the output does not.
0
0 05
0.1
0.15
0 2
0 25
0.3
0.35
0.4
0.45
0
0.01
0.02
0.03
0.04
0.05
0.06
0.07
0.08
State Feedback Controller
Output Feedback Controller
% Variation of Model Parameters
1/tr(P)
Figure 5.20: % Variation of Model Parameters
Next, the minimax problem which corresponds to the worst plant design, is com-
pleted. The state-space model of the controller is
¬© 2010 by Taylor and Francis Group, LLC

248
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
 





Àôw1
Àôw2
Àôw3
Àôw4
 





 



0
1
0
0
0
0
1
0
0
0
0
1
 0  4678
 1  3583
 2  6722
 4  6049
 









w1
w2
w3
w4
 





 






0
0
0
1
 





y
(5.108)
u
   0  1004
 0  6255
 0  7456
 2  2246
  





w1
w2
w3
w4
 





(5.109)
and the cost for the nominal plant is J
  27  5617 which is slightly greater than that
for the controller designed speciÔ¨Åcally for the nominal plant. The cost for the worst
plant is J
  36  8985.
0
0.05
0.1
0.15
0.2
0 25
0.3
0.35
0.4
0.45
0.5
0
0 005
0.01
0 015
0.02
0 025
0.03
0 035
0.04
0 045
State Space Controller: Nominal Plant
State Space Minimax Controller
% Variation of Model Parameters
1/tr(P)
Figure 5.21: % Variation of Model Parameters
Figure 5.21 illustrates the variation of the worst plant cost as a function of the
% variation of the model uncertainty, for the controller designed for the nominal
plant and the worst plant. As is expected there is a trade-off of performance of
the nominal plant for robustness. Figure 5.22 presents the cost of the vertices of
an uncertain hypercube with a œÉ of 0.3. It is clear that the controller designed for
the nominal plant whose cost is represented by circles results in instability for the
¬© 2010 by Taylor and Francis Group, LLC

Minimax Control
249
plant corresponding to vertex 2, while the minimax controller results in reasonable
performance over the entire domain of uncertainty.
2
4
6
8
10
12
14
16
18
‚àí30
‚àí20
‚àí10
0
10
20
30
40
50
KMinimax
Knom
Cost at Vertices and Nominal Plant
Quadratic Cost
Figure 5.22: % Variation of Model Parameters
5.3
Summary
High-Ô¨Ådelity representation of dynamical models ensures experimental reproduc-
tion of the performance expected based on numerical simulations. However, expe-
rience informs us that model truncation, errors in estimated model parameters and
variation of model parameters as a function of the environment preclude an accurate
representation of the system model. In such scenarios one would like to ensure some
baseline performance of the controlled system over the domain of model errors. This
problem can be posed as a ‚Äúworst case design,‚Äù i.e, the system models which gener-
ates the worst performance are the ones which most inÔ¨Çuence the controller design.
Under perfect nominal conditions, this minimax pre-Ô¨Ålter or feedback controller can-
not reproduce the performance of a controller designed for the nominal model only.
¬© 2010 by Taylor and Francis Group, LLC

250
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
It can guarantee that no other controller will have a better performance over the en-
tire uncertain domain. This chapter dealt with minimax design of time-delay Ô¨Ålters
and full state feedback controllers which minimize a quadratic cost. The trade-off
between performance and robustness is illustrated for both the pre-Ô¨Ålters and feed-
back controllers. The technique presented in this chapter can easily be extended to
discrete-time systems.
Exercises
5.1
For a gantry crane, which is driven by a proportional-derivative controller, de-
sign a time-delay Ô¨Ålter which minimizes the maximum magnitude of residual
vibration for a rest-to-rest maneuver. The model of the crane is:
 m1
 m2
  ¬®Œ∏
 m2L ¬®œÜ
  u
m2 ¬®Œ∏
 m2L ¬®œÜ
 m2gœÜ
  0
m1
m2
L
g
1000 kg
8000 kg
1‚Äì25 m
9.81 m/s2
Table 5.3: Gantry Crane Parameters
The initial and terminal conditions are:
Œ∏
 0  0  ÀôŒ∏
0  0 œÜ
0  0  ÀôœÜ
0  0  Œ∏
t f
   1  ÀôŒ∏
 t f
   0 œÜ
 t f
  0  ÀôœÜ
 t f
   0
where the length of the cable lies in the range:
10
  L
  20
The feedback controller for the system is:
u
  5000 Œ∏
 Œ∏
 t f
   2000 ÀôŒ∏
Assume that the time-delay preÔ¨Ålter is parameterized as:
G s  A0
 A1e
 sT1
 A2e
 sT2
 A2e
 sT3
 A4e
 15s
which requires the maneuver time to be 15 seconds, and
A0
 A1
 A2
 A3
 A4
  1 ¬© 2010 by Taylor and Francis Group, LLC

Minimax Control
251
m
x
u
  m1
m2
Œ∏2
l
 1
l1
l2
Œ∏1
Figure 5.23: Double Pendulum Crane
5.2
Design a minimax jerk-limited time-optimal reference proÔ¨Åle for a rest-to-rest
maneuver of a spring-mass system given by the equation of motion:
¬®x
 œâ2x
  œâ2u
where
0 7
  œâ
  1 3
and
0
  Àôu
  0 2
The initial and Ô¨Ånal states are
x 0   Àôx
 0  0 x t f
  2  Àôx t f
  0 5.3
Design a robust LQR controller for a double pendulum shown in Figure 5.23.
The system model is
m11 ¬®x
 m12 ¬®Œ∏1
 m13 ¬®Œ∏2
 cÀôx
  u
(5.110)
m21 ¬®x
 m22 ¬®Œ∏1
 m23 ¬®Œ∏2
 k12Œ∏1
  0
(5.111)
m31 ¬®x
 m32 ¬®Œ∏1
 m33 ¬®Œ∏2
 k34Œ∏2
  0
(5.112)
¬© 2010 by Taylor and Francis Group, LLC

252
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
where
m11
  m
 m1
 m2
m12
  m1l1
 m2L
 m13
  m2l2
m21
  m1l1
 m2L
 m22
  m1l2
1
 m2L
 L
  I1
m23
  m2l2L
 m31
  m2l2
m32
  m2l2
 l1
 l
 1
 m33
  m2l2
2
 I2
k33
  m2gl2
k22
  m1gl1
 m2gL
 L
   l1
 l
 1
 The nominal parameters are:
m1=0.5
m2=1
m3 = 8
l1 = 1.5
l
 1 = 0.1
l2 = 0.3
I1 = 0.0008
I2 = 0.06
Design a robust minimax controller which minimizes the quadratic cost func-
tion where all the states are equally weighted, i.e., the Q matrix is identity
and the control weight term is 0.1. The uncertain parameter are:
0 5
  m2
  1 5
(5.113)
4
  m3
  12
(5.114)
0 75
  l1
  2 25
(5.115)
0 15
  l2
  0 45
(5.116)
which correspond to a
 50% variation about the nominal value of the param-
eters. Plot the gain margin for the LQR and the minimax controllers.
5.4
Design a minimax time-delay Ô¨Ålter for the Ô¨Çexible transmission system shown
in Figure 5.24 for a rest-to-rest maneuver. The maximum magnitude of the
cost function is minimized over the range of the load J3 [14]. The transfer
function of the system is
œÜ
 s œÑ
 s

 2Kr2
 2
 J3s2
  f s
 2Kr2
  J2s2
  f s
 4Kr2
   2Kr2
 2
where
J2
  8 5e
 3 K1
  K2
  K
  170  f
  7 25e
 3 r
  0 1
and the load parameter lies in the range
0 0424
 0 017
  J3
  0 0424
 0 017
The initial and desired Ô¨Ånal states are:
œÜ
 0  0  ÀôœÜ
0  0 œÜ
t f
   1 rad
  ÀôœÜ
 t f
  0
Note that the input to the system is the position of the Ô¨Årst pulley.
5.5
Design a minimax controller for the pitch control of an aircraft (Figure 5.25).
The transfer function relating the pitch angle Œ∏ to the elevator deÔ¨Çection Œ¥e
is: (Source: www.engin.umich.edu/group/ctm/examples/pitch/Mpitch.html.)
Œ∏
 s Œ¥e
 s

1 151s
 0 1774
s3
 0 739s2
 0 921s
¬© 2010 by Taylor and Francis Group, LLC

Minimax Control
253
I
W
T
.
.
.
.
Figure 5.24: Flexible Transmission Problem
The cost function to be minimized is:
J
   ‚àû
0
 Œ∏
 t
 2
 Œ¥e
 t
2
 dt
where all the coefÔ¨Åcients of the transfer function lie in the range 0 5pn
i
  pn
i
 1 5pn
i , where pn
i are the nominal values of the ith coefÔ¨Åcients.
pn
i
  1 151 0 1774 0 739 0 921
 Design an output feedback controller of the form:
Àôxc
  Acxc
 BcŒ∏
(5.117)
Œ¥e
  Ccxc
 DcŒ∏
(5.118)
to minimize the maximum magnitude of J evaluated at the vertices of the
uncertain hypercube. xc is a third-order vector which represents the control
states.
>≈ùƒ®∆ö
∆åƒÇ≈ê

∆ç
y
y∆ç
s
D
J
T
GH
Figure 5.25: Airplane Pitch Dynamics Variables
¬© 2010 by Taylor and Francis Group, LLC

254
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
References
[1] T. Singh and S. R. Vadali. Robust time-optimal control: Frequency domain
approach. J. of Guid., Cont. and Dyn., 17(2):346‚Äì353, 1994.
[2] Q. Liu and B. Wie. Robust time-optimal control of uncertain Ô¨Çexible space-
craft. J. of Guid., Cont. and Dyn., 15(3):597‚Äì604, 1992.
[3] T. Singh. Effect of damping on the structure of time-optimal controllers. J. of
Guid., Cont. and Dyn., 19(5):1225‚Äì1231, 1995.
[4] W. Singhose, T. Singh, and W. P. Seering. On-off control with speciÔ¨Åed fuel
usage. ASME J. of Dyn. Systems, Measurements, and Cont., 121(2):206‚Äì212,
1999.
[5] S.W. Liu and T. Singh. Robust time-optimal control of nonlinear structures
with parameter uncertainties. ASME Journal of Dynamic Systems, Measure-
ment and Control, 119(4):743‚Äì748, December 1997.
[6] T. Singh. Minimax design of robust controllers for Ô¨Çexible systems. J. of
Guid., Cont. and Dyn., 25(5):868‚Äì875, 2002.
[7] C. F. van Loan. Computing integrals involving the matrix exponential. IEEE
Trans. on Auto. Cont., (3):395‚Äì404, 1978.
[8] O. J. M. Smith. Posicast control of damped oscillatory systems. 45:1249‚Äì1255,
September 1957.
[9] T. Singh and S. R. Vadali. Robust time delay control. ASME J. of Dyn. Systems,
Measurements, and Cont., 115(2):303‚Äì306, 1993.
[10] W. Singhose, S. Derezinski, and N. Singer. Extra-insensitive input shapers for
controlling Ô¨Çexible spacecraft. J. of Guid., Cont. and Dyn., 19(2):385‚Äì391,
1996.
[11] T. Singh and Y-L Kuo. Minimax design of preÔ¨Ålters for maneuvering Ô¨Çexible
structures. In AIAA Guidance, Navigation and Control Conference, Monterey,
California, 2002.
[12] A. E. Bryson and R. A. Mills. Linear-quadratic-Gaussian controllers with spec-
iÔ¨Åed parameter robustness. J. of Guid., Cont. and Dyn., 21(1):11‚Äì18, February
1998.
[13] L. El Ghaoui, A. Carrier, and A. E. Bryson. Linear quadratic minimax con-
trollers. IEEE Trans. on Cont. Systems Tech., 15(4):953‚Äì961, 1992.
[14] R. Ramirifar and N. Sadati. h‚àûcontrol of a Ô¨Çexible transmission system. In
Proceedings of the Thirty-Sixth Southeastern Symposium on System Theory,
pages 536‚Äì540, Atlanta, GA, 2004.
¬© 2010 by Taylor and Francis Group, LLC

6
Friction Control
In science the credit goes to the man who convinces the world, not to the
man to whom the idea Ô¨Årst occurred.
Sir William Osler (1849‚Äì1919); Canadian physician
F
RICTION is a nonlinearity which is ubiquitous. In applications where very high
precision is desired and where the system dynamics are characterized by Ô¨Çexible
modes, the presence of friction poses a challenge to the design of controllers for rest-
to-rest maneuvers. For systems where the coefÔ¨Åcients of friction and the damping
and natural frequencies of the Ô¨Çexible modes are uncertain, there is a need to design
desensitized controllers.
Numerous applications such as hard disk drives, Ô¨Çexible arm robots, high-precision
machine tools, servo-motors, and so forth, are applications where the presence of
friction is a signiÔ¨Åcant factor in the deterioration of the performance of these devices.
Thus, there is a motivation to study controllers which can account for the presence
of friction and track a desired output accurately. This chapter presents techniques
for the design of controllers for systems undergoing rest-to-rest maneuvers in the
presence of friction. First, the time-optimal control problem will be addressed. This
will be followed by a detailed development of pulse-width pulse-amplitude modu-
lated control techniques for rigid body system. The chapter will conclude with the
extension of the pulse-width pulse-amplitude technique to the motion control of the
Ô¨Çexible benchmark problem.
6.1
Time-Optimal Rest-to-Rest Maneuvers
Maneuvering structures from quiescent initial conditions to quiescent Ô¨Ånal condi-
tions in minimum time have applications in hard disk drives [1, 2], digital versatile
discs [3], industrial robots [4, 5], and container cranes [6], which are used to load
and unload ships, and so forth. All these applications have joints that are subject to
friction which signiÔ¨Åcantly inÔ¨Çuences the positioning accuracy of controllers. This
section will consider the simplest model of friction, Coulomb friction, and develop
255
¬© 2010 by Taylor and Francis Group, LLC

256
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
minimum-time control proÔ¨Åles for rest-to-rest maneuvers. As in earlier chapters, a
rigid body is used as the Ô¨Årst example to illustrate the design technique. This is
followed by the development of the optimal controller for Ô¨Çexible structures.
6.1.1
Rigid Body
The rigid-body system subject to Coulomb friction is illustrated in Figure 6.1. The
u
m
x
fcsgn Àôx
 Figure 6.1: Rigid-Body System Subject to Coulomb Friction
time-optimal control problem of the rigid body system can be written as:
min
  Tf
0
dt
subject to
Àôx  t
  Axt
 B
 u t
   fcsgn Àôx  t
    (6.1)
x 0    x1
 0   x2
 0  T
 x Tf
 
 x1
 Tf
  x2
 Tf
  T
  U
  u t
   U
 where A and B are deÔ¨Åned as:
A
  0 1
0 0
  B
  0
1
m
 (6.2)
Formulating a Hamiltonian as:
H  x Œª
 u  t
  1
 ŒªT
 Ax t

B
 u  t

  fcsgn Àôx     (6.3)
the necessary conditions for optimality are given as
Àôx t
 
‚àÇH
‚àÇŒª
 t
 (6.4)
ÀôŒª
 t
 
  ‚àÇH
‚àÇx t
 (6.5)
¬© 2010 by Taylor and Francis Group, LLC

Friction Control
257
From Pontryagin‚Äôs principle, the optimal control input is the one that minimizes the
Hamiltonian, which is
u
  Usgn
 BTŒª
 t
   (6.6)
The resulting control proÔ¨Åle becomes bang-bang, where the input switch is deter-
mined by the switching function, BTŒª.
6.1.1.1
Parameterization of Linearizing Input
In Equation (6.1), the equation of motion is nonlinear because of the signum func-
tion in the Coulomb friction model. To eliminate the nonlinearity attributed to the
signum function, a simple technique is presented in this section which permits pa-
rameterization of the new input to the system which includes the external input and
the friction force. This net input now acts on a linear system, permitting the use of
all the tools available for the design of controllers for linear systems.
Assume that the time-optimal control proÔ¨Åle for the problem in Equation (6.1) is
a one-switch bang-bang proÔ¨Åle. By deÔ¨Åning a linearizing net input such that [7]
unet
  u
  fcsgn Àôx   (6.7)
the system equation of motion becomes linear. However, the new linearizing net
input is not a bang-bang proÔ¨Åle anymore. Figure 6.2 illustrates how the linearizing
net input can be determined. First, the velocity proÔ¨Åle of the optimal control proÔ¨Åle
is assumed as shown in the top plot of Figure 6.2. T1 and T3 correspond to the
time when the velocity of the frictional body becomes zero, and T2 is the time when
the actual control input switches. The friction force can be determined from this
velocity proÔ¨Åle which is shown in the third plot of Figure 6.2. Then the linearizing
net input can be determined as the sum of actual input and friction force as shown
in the last plot of Figure 6.2. Now the linearizing net input can be parameterized
by the unknown velocity and control switches, and Ô¨Ånal time [T1 T2 T3 Tf ]. Without
losing generality, for a rigid body system, we can assume that the Ô¨Ånal position of
the mass is always greater than the initial position of the mass, i.e., x1
 Tf
   x1
 0  .
Then the spectrum of velocity proÔ¨Åles of the general time-optimal problem consist
of four cases shown in Figure 6.3, depending on the initial and Ô¨Ånal states of the
system. Based on these cases, the linearizing net control input for the corresponding
velocity proÔ¨Åle can be written as:
unet
 i   

U
  fc
0
  t
  T1
 U
  fc
T1
  t
  Tf
0
Tf
  t
unet
 ii   





U
  fc
0
  t
  T1
U
  fc
T1
  t
  T2
 U
  fc
T2
  t
  Tf
0
Tf
  t
(6.8)
unet
 iii   





U
  fc
0
  t
  T1
 U
  fc
T1
  t
  T2
 U
  fc
T2
  t
  Tf
0
Tf
  t
unet
 iv   









U
  fc
0
  t
  T1
U
  fc
T1
  t
  T2
 U
  fc
T2
  t
  t3
 U
  fc
T3
  t
  Tf
0
Tf
  t
(6.9)
¬© 2010 by Taylor and Francis Group, LLC

258
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
Actual Input
Friction Force
Linearizing Net Input
Velocity ProÔ¨Åle
Àôx t
 u t
 fcsgn Àôx
 unet
 t

T1
T2
T3
Tf
t
t
t
t
U
 U
fc
 fc
U
  fc
U
  fc
 U
  fc
 U
  fc
Figure 6.2: Linearizing Net Input Parameterization
Since the new control input is parameterized in terms of the unknown switch and
Ô¨Ånal times, the system equation of motion can be integrated forward in time with the
given initial states. With the Ô¨Årst linearized net input unet
 i  (Case (i)), states at the
switch and Ô¨Ånal time become
x T1
   eAT1x0
   T1
0
 U
  fc
 eA  t
 œÑ
 BdœÑ
x Tf

 eA Tf
 T1
 x T1
    Tf
T1
  U
  fc
 eA  t
 œÑ
 BdœÑ
 (6.10)
Solving for the matrix exponential and integration analytically and exploiting the
constraint x
 Tf
 
x1
 Tf
 x2
 Tf
 T, the switch time and Ô¨Ånal time can be solved,
¬© 2010 by Taylor and Francis Group, LLC

Friction Control
259
 i  Àôx  0    0  Àôx  Tf
   0
 ii  Àôx  0    0  Àôx  Tf
   0
 iii  Àôx  0    0  Àôx  Tf
   0
 iv  Àôx  0    0  Àôx  Tf
   0
Tf
Tf
Tf
Tf
t
t
t
t
Àôx
Àôx
Àôx
Àôx
Figure 6.3: Four Different Velocity ProÔ¨Åles of a Rigid Body
resulting in the following closed-form equations:
T1
  U
  fc
 Tf
mx2
 Tf
  x2
 0   2U
Tf
  m U
 fc
x2
 0  m U
  fc
 x2
 Tf
 U2
  f 2c
  2Um2
 U
  fc
x2
 0  2
m U
  fc
 x2
 Tf
 2
 2  U2
  f 2c
  x1
 Tf
  x1
 0   U2
  f 2c
 (6.11)
The actual control input is found by subtracting the friction force from the resulting
linearizing control input. Similarly, the states at the switch and Ô¨Ånal times with the
input unet
 ii  (Case (ii)), become
x T1
   eAT1x0
   T1
0
 U
  fc
 eA  t
 œÑ
 BdœÑ
xT2
   eA  T2
 T1
 x T1
    T2
T1
 U
  fc
eA  t
 œÑ
 BdœÑ
xTf

 eA t3
 T2
 x T2
    t3
T2
  U
  fc
eA  t
 œÑ
 BdœÑ
 (6.12)
In this net control proÔ¨Åle, T1 is the velocity switch and T2 is the actual control input
switch. Resulting states should satisfy the boundary state conditions at the Ô¨Ånal time
¬© 2010 by Taylor and Francis Group, LLC

260
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
as well as the zero velocity constraint at T1 such that
x Tf
 
 x1
 Tf
 x2
 Tf
 T
 x2
 T1
   0  (6.13)
The three unknown switch and Ô¨Ånal times, [T1 T2 Tf ] can now be solved from Equa-
tion (6.13). It is also possible to formulate a problem using time-delay Ô¨Ålters. The
linearizing net input, unet
 ii , can be written in the form:
G s 
U
 fc
  2fce
 sT1
 2Ue
 sT2
  U
 fc
e
 sTf
 (6.14)
Then, zeros of G s  are designed to cancel the poles of the rigid body while satisfy-
ing the displacement constraint. Similar procedures are used to Ô¨Ånd the linearizing
control inputs, unet
 iii  and unet
 iv .
6.1.1.2
Optimality Condition
For a rigid body with Coulomb friction, the control proÔ¨Åle is a one-switch bang-
bang with the switching curve BTŒª. To show that the resulting control proÔ¨Åle is
optimal, the switching curve is computed to show that it passes through zero at the
actual switch time.
Assume that the control input has a switch at
  time instants (Ti
 i
  1  2     
)
and the velocity of the rigid body changes its sign m times at the kth
j time instant Tkj
(j
  1
   m). For example, in Figure 6.2, T2 is the actual control switch and T1 and
T3 are the velocity switches. Therefore,
   2, k1
  1, k2
  3, and m
  2. In the
general case, the optimal control problem in Equation (6.1) can be rewritten with the
linearizing net input such that
min
  Tf
0
dt
subject to
Àôx
  Ax
 B u
  1  j fc
 Tj
 1
  t
  Tj
x2
 Tkj
  0
x 0    x1
 0   x2
 0  T
 x Tf
 
 x1
 Tf
  x2
 Tf
  T
 U
  u
  U
(6.15)
for j
  1
   m
 1. The Lagrangian of the new problem can be written as [8]
L
  œàTN
   Tf
t0
 H
 Œª T Àôx dt
(6.16)
where,
Hamiltonian
H
  1
 Œª T
 Ax
B u

 1  j fc
   Tj
 1
  t
  Tj
Interior point constraint N
  Àôx  Tk1
     Àôx  Tkm
 
 0
(6.17)
for j
  1
   m
 1. The
 m
 1  th index corresponds to the Ô¨Ånal time Tf , which is a
free variable. The Lagrangian multipliers are deÔ¨Åned as
œàj
   0 t
  Tkj
  0 elsewhere
j
  1
   m
(6.18)
¬© 2010 by Taylor and Francis Group, LLC

Friction Control
261
The optimality condition is found from the variation of L such that
Àôx
  ‚àÇH
‚àÇŒª
(6.19)
ÀôŒª
  ‚àÇH
‚àÇx
(6.20)
u
  Usgn
 BTŒª
 (6.21)
and the interior point condition,
Œª
 T
 kj
  Œª
T
 kj
 œà
‚àÇNkj
‚àÇx
Tkj
 and
H  T
 kj
   H  T
 kj
  œà
‚àÇNkj
‚àÇTkj
(6.22)
The Hamiltonian should be continuous at these interior points because the interior
point constraint Nkj in Equation (6.22) is not an explicit function of time. This results
the the following equation:
H  Tk
 j
   H  Tk
 j
  (6.23)
Therefore, the jump discontinuity in the costates has to meet continuous Hamiltonian
requirements. The costates are computed from differential equation of the costates
in Equation (6.22) with the initial costates. Since the initial costate vector is un-
known, the fact that the switching function is zero at the control switch is used.
First, costates are integrated in terms of initial costates Œª
 0   forward in time. Since
costates are discontinuous at the interior point where the velocity of the mass is zero,
the discontinuity in the function is handled by deÔ¨Åning
‚àÇNkj
‚àÇx Tkj
   Œ≥jŒª2
 T
 kj
 (6.24)
where Œ≥ can be found from the continuous Hamiltonian requirement, H  T
 kj
 
H  T
 kj
 . Then the costates can be integrated forward with Œª
 0   using Equation (6.20)
and Equation (6.24). The resulting costates should satisfy the optimality condition
to ensure optimality of the resulting control input.
6.1.1.3
Numerical Example
Consider the following time-optimal control problem.
min
  Tf
0
dt
subject to
Àôx
 t
 
 0 1
0 0
 x t
 
 0
1
  u
  fcsgn Àôx   (6.25)
x 0  
 0
 1 T
 x Tf
 
 1
0
 T
¬© 2010 by Taylor and Francis Group, LLC

262
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
 1
  u
  1
where fc
  0  4. The optimal control proÔ¨Åle is a one-switch bang-bang with the
switch time at t
  T2 and the velocity of the mass crosses zero once at t
  T1 (Fig-
ure 6.3b). The linearizing input is parameterized as:
unet
  





1  4
0
  t
  T1
0  6
T1
  t
  T2
 1  4
T2
  t
  Tf
0
Tf
  t
 (6.26)
The switch and Ô¨Ånal times can be found as:
T1
  0  7143
T2
  2  4938
Tf
  3  2564  (6.27)
From the resulting switch time, the optimality condition can be veriÔ¨Åed. The optimal
control problem in Equation (6.25) can be re-written as:
min
Tf
subject to
Àôx
  Ax
 B u
  fc

0
  t
  T1
Àôx
  Ax
 B u
  fc

T1
  t
  Tf
x2
 T1
   0
x 0  
 0
 1 T
 x Tf
 
 1
0
 T
 1
  u
  1  (6.28)
Formulate a Lagrangian such that
L
  œàx2
 T1
    Tf
t0
 H
 Œª T Àôx dt
(6.29)
where Hamiltonian of the problem is written as
H
  1
 Œª T
 Ax
B u
 fc
  0
  t
  T1
1
 Œª T
 Ax
 B u
  fc
  T1
  t
  Tf
 (6.30)
The optimality condition is found from the variation of L such that
Àôx
  ‚àÇH
‚àÇŒª
(6.31)
ÀôŒª
  ‚àÇH
‚àÇx
(6.32)
u
  sgn
 BTŒª
 (6.33)
and the interior-point constraint yields
Œª
 T
 1
   Œª
T
 1
  œà
‚àÇN
‚àÇx
T1
 and
H  T
 1
   H T
 1
 (6.34)
¬© 2010 by Taylor and Francis Group, LLC

Friction Control
263
where N is a interior point constraint such that N
  x2
 T1
 . The continuous Hamil-
tonian requirement at T1 yields
1
  Œª1
T
 1
  Œª2
 T
 1
   Ax T
 1
  B 1
  fc
   1
  Œª1
T
 1
  Œª2
 T
 1
   Ax T
 1
  B 1
  fc
   (6.35)
Since only Œª2 is discontinuous at t
  T1, assuming Œª2
 T
 1
  = Œª2
 T
 1
   Œ≥Œª2
T
 1
 , Œ≥
is found from Equation (6.35) to be
Œ≥
 2fc
1
  fc
 (6.36)
Now the costates at the switch times are found in terms of Œª
 0   from Equation (6.32)
0
0.5
1
1.5
2
2.5
3
3.5
‚àí2
‚àí1.5
‚àí1
‚àí0.5
0
0.5
1
1.5
x1
x2
BTŒª
H
u  t
 Time (sec)
x, u, H, BTŒª
Figure 6.4: Time-Optimal Evolution of States
such that
Œª
 T
 1
   e
 AT T1Œª
 0  Œª
T
 1
  I
 J
 Œª
T
 1
 Œª
 T2
   e
 AT
 T2
 T1
 Œª
 T
 1
  (6.37)
where J is deÔ¨Åned as:
J
  0 0
0 Œ≥
  (6.38)
The switching curve has to be zero at the control switch t
  T2 such that
BTe
 AT
 T2
 T1
  I
 J
e
 ATT1Œª
 0   0  (6.39)
¬© 2010 by Taylor and Francis Group, LLC

264
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
The initial costates are found to satisfy Equation (6.39). Since Equation (6.39) can
be satisÔ¨Åed with Œª
 0  =0, which corresponds to the trivial solution, Œª
0   has to lie in
the null space of BTe
 AT
 T2
 T1
  I
  J
e
 AT T1 for the non-trivial solution. Since the
Hamiltonian has to satisfy the constraint H  t
  0    0, we have
H  0   1
Œª T
 0  Ax
 0  B  1
  fc
   1
 Œª T
 0    1
 1
 fc
    0
(6.40)
which requires
Œª T
 0    1
 1
 fc
    1  (6.41)
Satisfying Equations (6.39) and (6.41) leads to:
Œª
 0    Null
BTe
 AT
 T2
 T1
  I
 J
e
 ATT1
  Null
BTe
 AT
 T2
 T1
  I
 J
e
 ATT1
 T
  1
1
  fc T
(6.42)
where Null    represents the null space. The resulting control input, switching curve,
Hamiltonian, and the evolution of the states are plotted in Figure 6.4. It is shown that
the switching curve passes through the abscissa when there is a sign change in the
control input.
6.1.2
Flexible Structure
In contrast to rigid-body systems which are only subject to the control and fric-
tion forces, Ô¨Çexible structures include additional spring and damping forces which
complicate the analysis and synthesis of minimum-time control proÔ¨Åles. This sec-
tion presents a detailed development of the design of time-optimal control proÔ¨Åles
for rest-to-rest maneuvers of Ô¨Çexible structures which are represented as a chain of
spring-mass-dampers. The assumption in this development is that the control and
friction forces act on the same mass.
6.1.2.1
Problem Formulation
m1
m2
ms
mp  1
mp
x1
x2
xs
xp  1
xp
k1
 c1
k2
 c2
ks 1
 cs 1
ks
 cs kp  2
 cp  2 kp  1
 cp  1
fcsgn  Àôxs
 u  t

Figure 6.5: p-Mass-Spring-Damper System Subject to Coulomb Friction
Consider the minimum time problem for a general p-mass-spring-damper system
shown in Figure 6.5. A single control input acts on the sth mass, which is also subject
¬© 2010 by Taylor and Francis Group, LLC

Friction Control
265
to the Coulomb friction fc. The time-optimal problem statement for a rest-to-rest
maneuver is given as:
min
  Tf
0
dt
subject to
Àôx  t
  Axt
 B
 u t
   fcsgn  Àôxs
  x 0    x0
 x Tf
  xf
 U
  u t
   U
(6.43)
where A and B are deÔ¨Åned as
A
   0p  p
Ip  p
 M
 1K
 M
 1C
  B
   0p  1
M
 1d
 (6.44)
M, K, and C are the mass matrix, stiffness matrix, and damping matrix, respectively,
and d is a control inÔ¨Çuence vector of zeros with a nonzero value in the sth entry. fc is
the Coulomb friction coefÔ¨Åcient which is assumed to be constant. The Hamiltonian
of the problem is formulated as:
H  x Œª
 u  t
   1
 ŒªT
 Ax t

B
 u  t

  fcsgn  Àôxs
   (6.45)
The necessary conditions for optimality are given as
Àôx t
 
‚àÇH
‚àÇŒª
 t
 (6.46)
ÀôŒª
 t
 
  ‚àÇH
‚àÇx t
  (6.47)
From Pontryagin‚Äôs minimum principle, the controller that minimizes the Hamilto-
nian is:
u
  Usgn
 BTŒª
 t
  (6.48)
where BTŒª
 t
  is the switching function. Therefore, the time-optimal solution for
this system is a bang-bang proÔ¨Åle. However, this may not be always true for the
frictional Ô¨Çexible systems because of the additional state constraints imposed on the
optimal control problem. This is due to the fact that the friction force varies to match
the imposed forces when the velocity of the frictional body is zero. For a time-
optimal control proÔ¨Åle for the rigid body, it is guaranteed that the control input is
always larger than the force needed to initiate the movement when there is a velocity
reversal. For a Ô¨Çexible system, however, external forces acting on the frictional
body include the input and spring forces, and the available friction force becomes a
function of the external forces acting on the frictional mass, when the net force to
the frictional body is not enough to initiate the motion (i.e., when stiction occurs).
Therefore, the bang-bang control proÔ¨Åle in Equation (6.48) is only valid when the
external forces to the frictional body at the velocity reversal are greater than the
resisting friction force. The bang-bang control input is parameterized in the next
section and the transitions of the control input as a function of displacement are
presented in later sections.
¬© 2010 by Taylor and Francis Group, LLC

266
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
6.1.2.2
Linearizing Net Input and Parameterization of Control
It was shown previously that the time-delay Ô¨Ålter can be used to cancel the dynam-
ics of a Ô¨Çexible systems undergoing rest-to-rest maneuvers. The time-delay Ô¨Ålter can
be used for the Ô¨Çexible systems with friction if the linearizing net input formulation
is used. The system equation shown in Equation (6.43) can be rewritten in a linear
form as:
Àôx
 t
  Axt
 Bunet
t
 (6.49)
The linearizing net input, unet
 t
 , is deÔ¨Åned in a manner similar to that for the rigid
body, resulting in the equation
unet
 t
  u t
   fcsgn  Àôxs
 (6.50)
In order to solve the time-optimal problem using the time-delay Ô¨Ålter technique, the
zeros of the time-delay Ô¨Ålter should cancel out the rigid body and Ô¨Çexible poles in
addition to satisfying the displacement boundary conditions of the problem. With
the net control input, the velocity of the frictional body must be zero when the sign
of the frictional force changes. Figure 6.6 shows a schematic of the thought process
in developing this technique for a two-mass-spring system where the control and
frictional force are acting on the Ô¨Årst mass. The Ô¨Årst plot in Figure 6.6 shows the
assumed velocity proÔ¨Åle of the Ô¨Årst mass. The second plot in Figure 6.6 is the actual
input to the system, which is described by Equation (6.48), assuming no singular
interval, to be bang-bang. The linearizing net input is parameterized and is shown
in the Ô¨Ånal plot, which is the sum of actual input and friction force. For the general
system shown in Figure 6.5, assuming that the control has n switch times at the
 th
i time instant (i
  1
   n). The velocity of the sth mass is assumed to change its
sign m times at the kth
j time instant (j
  1
   m). For example,
   1   3   5  (n
  3)
and k
  2   4  (m
  2) for the problem in Figure 6.6. The time-delay Ô¨Ålter which
generates the control proÔ¨Åle when driven by a unit step input, can be parameterized
as
G s 
U
  fc
 2U
n
‚àë
i 1
  1  ie
 sT
 i
 2fc
m
‚àë
j
 1
  1  j
 1e
 sTkj
  U
 fc
e
 sTf (6.51)
G s  must cancel out all of the poles of the system while the control input satisÔ¨Åes
the Ô¨Ånal boundary conditions shown in Equation (6.43). One of the rigid-body poles
is canceled due to Equation (6.51) having a zero at s
  0. To cancel the other rigid
body pole, the derivative of Equation (6.51) with respect to s must also have a zero
at s
  0. This satisÔ¨Åes the velocity boundary condition for a rest-to-rest maneuver,
which yields the following constraint:
dG s ds
    s 0
  2U
n
‚àë
i 1
  1  iT
 i
 2fc
m
‚àë
j
 1
  1  j
 1Tkj
  U
  fc
Tf
 0
(6.52)
The time-delay Ô¨Ålter must also cancel out the Ô¨Çexible-mode poles, which will lead
to the next
 2p
  2   constraints. Substituting sŒº
  œÉŒº
  iœâŒº into Equation (6.51),
¬© 2010 by Taylor and Francis Group, LLC

Friction Control
267
T1
T2
T3
T4 T5
Tf
U
 U
unet
 t
 U
  fc
 U
  fc
 U
 fc
U
 fc
Linearizing Input
fcsgn Àôx1
 Friction Input
 fc
 fc
u  t

Actual Input
Àôx1
 t
 Velocity ProÔ¨Åle
t
t
t
t
Figure 6.6: General Schematic of Linearizing Net Input Parameterization
yields Equation (6.53) and Equation (6.54).
0
  U
  fc
  U
  fc
e
 Tf œÉŒº cos
 Tf œâŒº
  2U
n
‚àë
i 1
  1  ie
 T
 iœÉŒº cos
 T
 iœâŒº
 ¬© 2010 by Taylor and Francis Group, LLC

268
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
 2 fc
m
‚àë
j
 1
  1  j
 1e
 Tkj œÉŒº cos
 TkjœâŒº
 (6.53)
0
  U
 fc
e
 Tf œÉŒº sin
 Tf œâŒº
  2U
n
‚àë
i 1
  1  ie
 T
 iœÉŒº sin
 T
 iœâŒº
  2 fc
m
‚àë
j
 1
  1  j
 1e
 Tkj œÉŒº sin
 TkjœâŒº
 (6.54)
for Œº
  1
    p
  1  , where p is the number of masses. The next constraint comes
from ensuring that the Ô¨Ånal boundary condition on position is satisÔ¨Åed. This can be
found by using the Ô¨Ånal value theorem. The Ô¨Ånal value theorem can be represented
as
xs
 Tf
  lim
s 0G s Gp
s (6.55)
where Gp
 s  is the transfer function of the sth mass position output which can be
derived from Equation (6.49). For rest-to-rest maneuvers, the Ô¨Ånal position of each
mass must be the same. L
 H ÀÜopital
 s rule is used to solve Equation (6.55) since the
numerator and denominator of G s Gp
s  have two zeros and two poles at the origin,
respectively. The next m constraints are the velocity constraints at the time when the
friction sign changes, which are shown in Equation (6.56).
vj
 t
  L
 1
 G s Gp
s  




Tkj
 0  j
  1
   m (6.56)
There are a total of 2p
 m constraints with n
 m
 1 unknowns (i.e., the switch and
Ô¨Ånal times). Nonlinear optimizers are used to solve for the unknown switch and Ô¨Ånal
times while minimizing the Ô¨Ånal time subject to Equations (6.52) through (6.56).
6.1.2.3
Optimality Condition
The new time-optimal control problem with the linearizing net input formulation
is written as:
min
  Tf
0
dt
subject to
Àôx
  Ax
 B u
  1  j fc
  Tj
 1
  t
  Tj
Àôxs
 Tkj
  0
x  0    x0 and x  Tf
  xf
 U
  u
  U
(6.57)
for j
  1
   m and T0 which corresponds to the initial time is equal to zero. It is
assumed in Equation (6.57) that the frictional mass starts to maneuver from rest in
the positive direction with positive velocity. Equation (6.57) has additional interior-
point constraints when the velocity of the frictional body is zero compared to the
¬© 2010 by Taylor and Francis Group, LLC

Friction Control
269
initial problem statement in Equation (6.43). The Lagrangian of this problem can be
written as [8]
L
  ŒΩT N
   Tf
0
 H
 ŒªT Àôx dt
(6.58)
where,
Hamiltonian
H
  1
 ŒªT
 Ax
 B  u

  1  j fc
   Tj
 1
  t
  Tj
Interior-point constraint N
  Àôxs
 Tk1
  Àôxs
 Tk2
     Àôxs
 Tkm
  T
 0
(6.59)
for j
  1
   m and the Lagrangian multipliers are deÔ¨Åned as
ŒΩj
   0 t
  Tkj
  0 elsewhere
j
  1
   m
(6.60)
Since the Hamiltonian is not explicitly a function of time, it is equal to zero for all
time t. As in the system shown in Equation (6.43), the switching function for the new
problem (with linearizing net input) is also given as BTŒª
 t
 . We also know that for
optimality, the switching function must cross zero at the switching times such that
BTŒª
 T
 i
  0  i
  1
   n
(6.61)
The costate equation from the optimality condition becomes
ÀôŒª
  ‚àÇH
‚àÇx
  ATŒª
 for all time except t
  Tkj
j
  1
   m (6.62)
When t
  Tkj, the costates should satisfy the following equations.
 





Œª
 T
 kj
  Œª
T
 kj
 ŒΩj
‚àÇNj
‚àÇxTkj
 H  T
 kj
  H  T
 kj
  ŒΩj
‚àÇNj
‚àÇTkj
 j
 1
   m
(6.63)
Because N is not explicitly a function of time, the Hamiltonian should be continuous
such that H  T
 kj
   H  T
 kj
 . Therefore, jump discontinuity in the costate has to be
chosen to satisfy the continuous Hamiltonian requirements, which can be written in
the form
ŒΩj
‚àÇNj
‚àÇx Tkj
  Œ≥jBTŒª
T
 kj
 (6.64)
Once ŒΩj‚Äôs are determined, we can Ô¨Ånd an expression for Œª
 T
 i
 , in terms of the initial
costates, Œª
 0  , from Equations (6.62) and (6.63). Then we can build Equation (6.61)
in terms of Œª
0  . As an example, assume that the Ô¨Årst time that the velocity goes to
zero is Tk1, then the costates at T
 k1 are given by Equation (6.65).
Œª
 T
 k1
   e
 AT T
 k1 Œª
 0   (6.65)
¬© 2010 by Taylor and Francis Group, LLC

270
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
The costates at t
  T
 k1 are given as
Œª
 T
 k1
  I
J1
 Œª
 T
 k1
  I
J1
 e
 AT T
 k1 Œª
 0  (6.66)
where J1 is a matrix where
 p
  s th row is
 Œ≥jBT. Then the costates can be in-
tegrated until the next switch with this new initial conditions. This procedure is
repeated until the n
 2p matrix M is formed for n switch times such that
 


BTŒª
 T
 1
 BTŒª
 T
 2
    BTŒª
 T
 n

 


 M Œª
 0    0
(6.67)
Œª
0   is found by the null space of M which satisÔ¨Åes the Hamiltonian requirements
such that H  t
  0    0. After calculating Œª
0   from Equation (6.67), the costates
can then be integrated forward and the resulting switching function must cross zero
at the switching time to ensure optimality.
6.1.2.4
Numerical Example
The example problem considered is illustrated in Figure 6.7. The control input and
Coulomb friction force is acting on the Ô¨Årst mass. The time-optimal control problem
can be stated as
min
  Tf
0
dt
subject to
Àôx  t
 
 


0
0
1 0
0
0
0 1
 1
1
0 0
0  5
 0  5 0 0
 

x
 t
 
 


0
0
1
0
 



u
  fcsgn Àôx1
  (6.68)
x 0  
 0 0 0 0
 T
 x Tf
 
 1 1 0 0
 T
 and
 1
  u
  1
m1
  1
m2
  2
fc
  0  4
k
  1
x1
x2
 u    1
Figure 6.7: Two-Mass-Spring System Subject to Friction
¬© 2010 by Taylor and Francis Group, LLC

Friction Control
271
Assuming n
  3, m
  2, k
  2 4  ,
  1 3 5 , and the Ô¨Çexible poles are given by
s
  œâi where œâ
  1  5. The net control input is parameterized as shown in Figure
6.6. Then the optimization problem for numerical computation becomes:
min
Tf
(6.69)
subject to the switch time constraints,
0
  T1
  T2
  T3
  T4
  T5
  Tf
(6.70)
rigid-body pole cancelation constraint (Equation 6.52),
2T1
 2 fcT2
 2T3
 2fcT4
 2T5
  1
  fc
 Tf
  0
(6.71)
Ô¨Çexible-body pole cancelation constraints (Equations 6.53 and 6.54),
 1
  fc
  2U cos
 œâT1
  2fc cos œâT2
  2cos
œâT3
  2 fc cos œâT4
  2cos
 œâT5
  1
  fc
 cos œâTf
  0
(6.72)
 2sin œâT1
  2fcsin  œâT2
  2sin
œâT3
  2 fc sin  œâT4
  2sin œâT5
  1
  fc
 sin  œâTf
  0
(6.73)
Ô¨Ånal displacement constraint (Equation 6.55),
1
4
  2T 2
1
 2 fcT 2
2
 2T2
3
 2fcT 2
4
 2T 2
5
  1
 fc
 T 2
f
   1
(6.74)
and Ô¨Årst-mass velocity constraints (Equation 6.56),
1
m1
 m2
  1
  fc
   m2
m1œâ sin
 œâT2
  T2
  2
  m2
m1œâ sin
 œâ
 T21
   T21
     0
(6.75)
1
m1
 m2
  1
  fc
   m2
m1œâ sin
 œâT4
  T4
  2
  m2
m1œâ sin
 œâ
 T41
   T41
   2 fc
  m2
m1œâ sin
 œâ
 T42
   T42
   2
  m2
m1œâ sin
 œâ
 T43
   T43
     0
(6.76)
where Tab stands for Ta
 Tb in Equation (6.75) and Equation (6.76). The constrained
nonlinear optimizer of MATLAB is used to solve this problem. The time-delay Ô¨Ålter
is found to be
G s  0  6  2e
 1  8164s
 0  8e
 2  1177s
(6.77)
 2e
 3  1498s
 0  8e
 3  5918s
 2e
 4  4047s
 1  4e
 5  2298s
(6.78)
With the resulting control input, the evolution of the states are plotted in Figure 6.8.
The costates and switching curve can be computed with the resulting control proÔ¨Åle
¬© 2010 by Taylor and Francis Group, LLC

272
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
0
1
2
3
4
5
6
‚àí1
‚àí0 5
0
0 5
1
1 5
x1
 t
 x2
 t
 x1
 t
 x2
 t
 Time (sec)
x t
 Figure 6.8: Time-Optimal Responses the Two-Mass-Spring System with
Coulomb Friction
to verify the optimality. The Hamiltonian for the two-mass-spring system is written
as
H
  

1
 Œª T
 Ax
 B  u
  fc

 0
  t
  T2
1
 Œª T
 Ax
 B  u
 fc

 T2
  t
  T4
1
 Œª T
 Ax
 B  u
  fc

 T4
  t
  Tf
(6.79)
The interior-point constraints are
N1
  Àôx1
 T2
   0
and
N2
  Àôx1
 T4
   0
(6.80)
Since the Hamiltonian should be continuous, we have H  T
 2
   H T
 2
  and H  T
 4
  H T
 4
 . The switching function is BTŒª
  Œª3, and there is a discontinuity only in Œª3.
The continuous Hamiltonian requirement yields
1
  Œª1
 T2
  Œª2
 T2
  Œª3
 T
 2
  Œª4
 T2
   Ax T2
  B  1
  fc
    1
  Œª1
 T2
  Œª2
 T2
  Œª3
 T
 2
  Œª4
 T2
   Ax T2
  B  1
  fc
  (6.81)
1
  Œª1
 T4
  Œª2
 T4
  Œª3
 T
 4
  Œª4
 T4
   Ax
 T4
  B 1
  fc
   1
  Œª1
 T4
  Œª2
 T4
  Œª3
 T
 4
  Œª4
 T4
   Ax
 T4
  B 1
  fc
  (6.82)
Assuming Œª3
 T
 2
  = Œª3
 T
 2
  Œ≥1Œª3
T
 2
  and Œª3
 T
 4
  = Œª3
 T
 4
  Œ≥2Œª3
T
 4
 , Œ≥1 and
Œ≥2 are found to be
Œ≥1
  2 fc
 1
  fc
 k
 x1
 T2
  x2
 T2
  and
Œ≥2
 2 fc
1
  fc
 k
 x1
 T4
  x2
 T4
  (6.83)
¬© 2010 by Taylor and Francis Group, LLC

Friction Control
273
0
1
2
3
4
5
6
‚àí1 5
‚àí1
‚àí0 5
0
0 5
1
1 5
Time (sec)
BTŒª
 H  unet
 t
  and
u  t
 H
BTŒª
unet
 t
 u t
 Figure 6.9: Linearizing Control Input, Switching Function, and Hamiltonian
Now the costates at the switch times are found in terms of Œª
 0   such that
Œª
T1
   e
 AT T1Œª
 0  Œª
T
 2
   e
 AT
 T2
 T1
 Œª
 T1
 Œª
 T
 2
  I
J1
 Œª
 T
 2
 Œª
 T3
   e
 AT
 T3
 T2
 Œª
 T
 2
 Œª
 T
 4
   e
 AT
 T4
 T3
 Œª
 T3
 Œª
 T
 4
  I
J2
 Œª
 T
 4
 Œª
 T5
   e
 AT
 T5
 T4
 Œª
 T
 4
 (6.84)
where, J1 and J2 is deÔ¨Åned as
J1
  


0 0 0 0
0 0 0 0
0 0 Œ≥1 0
0 0 0 0




and
J2
  


0 0 0 0
0 0 0 0
0 0 Œ≥2 0
0 0 0 0




(6.85)
M is now given to satisfy M Œª
 0    0 such that
M
  

BTe
 AT T1
BTe
 AT
 T3
 T2
  I
 J1
 e
 AT
 T2
 T1
 e
 AT T1
BTe
 AT
 T5
 T4
  I
 J2
 e
 AT
 T4
 T3
 e
 AT
 T3
 T2
  I
 J1
 e
 AT
 T2
 T1
 e
 AT T1
 

(6.86)
¬© 2010 by Taylor and Francis Group, LLC

274
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
The initial costates that satisfy the constraints M Œª
 0    0 and H  t
  0    0 can be
shown to be
Œª
0    NullM

Null
 M
 T B  1
  fc
 (6.87)
where, Null M
  is the null space of M . The linearizing input, as well as the switch-
ing curve is shown in Figure 6.9 for the example problem. The actual input is found
by subtracting the friction force from the net input.
6.1.2.5
Variation of Control Structure as a Function of Final Position
In the previous example, the velocity of the Ô¨Årst mass is zero at T2 and T4. As
the Ô¨Ånal position increases for the previous example, the time gap between T3 and
T4 becomes smaller until they coincide. The control proÔ¨Åle for this transition shown
0
1
2
3
4
5
6
7
‚àí1
‚àí0.5
0
0.5
1
1.5
2
0
1
2
3
4
5
6
7
‚àí1.5
‚àí1
‚àí0.5
0
0.5
1
1.5
T1
T1
T2
T2
T3
 T4
T3
 T4
T5
T5
Time (sec)
Àôx1
unet
Figure 6.10: Velocity and Control Input ProÔ¨Åles at the Transition
in Figure 6.10 indicates that the velocity crossing coincides with the control switch
that will result in a four-switch control proÔ¨Åle. The transition displacement for this
example is d
  3  4. After the transition displacement, going back to original proÔ¨Åle
does not provide a feasible solution. Also, keeping the four-switch transition proÔ¨Åle
¬© 2010 by Taylor and Francis Group, LLC

Friction Control
275
shown in Figure 6.10 after the transition displacement, creates an overconstrained
problem. Therefore, the velocity of the Ô¨Årst mass should cross zero before the new
control switch activates. This implies that now T3 is the time when the velocity
is zero and T4 is the time when the control switches. At T
 3 , the velocity becomes
positive and therefore the friction force becomes
 fc. However, the linearizing input
with the new friction value drives the Ô¨Årst mass to the negative direction if the net
input is less than zero. Once the Ô¨Årst mass crosses the zero velocity, the net input
changes its sign again because of the change in friction value to
 fc. This chattering
0
1
2
3
4
5
6
7
8
‚àí1
‚àí0.5
0
0.5
1
1.5
2
T1
T2
T3 T4
T5
Time (sec)
Àôx1
Figure 6.11: Velocity and Control Input ProÔ¨Åles after Transition Displacement
effect will continue until the sum of all the forces to the frictional body overcomes
the friction force. Another interpretation of this region is by introducing stiction
instead of chattering. Since the sum of all the applied forces to the Ô¨Årst mass is
not large enough to overcome static friction, the velocity of the Ô¨Årst mass stays zero
until the new control switch is activated to overcome static friction. One way to
formulate an optimal control problem with stiction is adding an additional constraint
to the problem such that the velocity of the Ô¨Årst mass is zero for this time interval.
For the example problem, the predicted velocity proÔ¨Åle of the Ô¨Årst mass is plotted in
Figure 6.11 illustrating that the velocity of the Ô¨Årst mass is zero until the new switch
activates. It is also possible that the spring force itself can overcome the friction force
before the new control switch occurs, which will require an additional constraint
satisfying the constraint that the spring force is equal to the Coulomb friction value
at the exit of the zero velocity domain. With the velocity proÔ¨Åle in Figure 6.11, a
¬© 2010 by Taylor and Francis Group, LLC

276
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
new optimal control problem can be formulated as
min
  Tf
0
dt
subject to
Àôx
  Ax
 B
 u
  fc
  0
  t
  T2
Àôx
  Ax
 B
 u
  fc
  T2
  t
  T3
Àôx
  Ax
 Bu  T3
  t
  T4
Àôx
  Ax
 B
 u
  fc
  T4
  t
  Tf
Àôx1
  0  t
  T2 and T3
  t
  T4
x 0    x0 and x  Tf
  xf
 1
  u
  1
(6.88)
Equation (6.88) has a state equality constraint on the velocity of the Ô¨Årst mass. Be-
cause of this constraint, the friction force during stiction is considered zero. Bryson
and Ho [8] have developed a method to handle the state equality constraints in the
optimal control problem. From [8], Equation (6.88) can be restated as
min
  Tf
0
dt
subject to
Àôx
  Ax
 B
 u
  fc
  0
  t
  T2
Àôx
  Ax
 B
 u
  fc
  T2
  t
  T3
Àôx
  Ax
 Bu  T3
  t
  T4
Àôx
  Ax
 B
 u
  fc
  T4
  t
  Tf
¬®x1
  k
m1
 x2
 x1
  u
 0  T3
  t
  T4
Àôx1
 T2
   Àôx1
 T3
   0
x 0   x0 and x  Tf
  xf
 1
  u
  1
(6.89)
Because the friction force is zero for the zero velocity, the control for T3
  t
  T4
should satisfy the equality constraint in Equation (6.89) such that
u
  k
m1
 x1
 x2
  T3
  t
  T4
(6.90)
It is interesting to see that although the control input needed for the Ô¨Årst mass to be
immobile for T3
  t
  T4 is deÔ¨Åned by Equation (6.90), because of the assumption of
stiction during the interval, it is possible to use a constant control input value of u
  1. Now, the control proÔ¨Åle can be parameterized from the predicted velocity proÔ¨Åle
including the state constraint effect of stiction. The time-delay Ô¨Ålter cannot be used
for this proÔ¨Åle because of the feedback control effect in the chattering interval which
alters the system equation. However, the control proÔ¨Åle can be used to integrate the
system forward in time using the given initial guesses of the switch times to obtain
¬© 2010 by Taylor and Francis Group, LLC

Friction Control
277
the states at the switch and Ô¨Ånal times:
x T1
   eAT1x0
   T1
0
eA  t
 œÑ
 B  1
  fc
 dœÑ
x T2
   eA  T2
 T1
 x T1
    T2
T1
eA  t
 œÑ
 B   1
  fc
 dœÑ
x T3
   eA  T3
 T2
 x T2
    T3
T2
eA  t
 œÑ
 B   1
  fc
 dœÑ
xT4
   eAc
 T4
 T3
 x T3
 x T5
   eA  T5
 T4
 x T4
    T5
T4
eA  t
 œÑ
 B  1
  fc
  œÑ
dœÑ
x Tf

 eA  T6
 T5
 x T5
    T6
T5
eA  t
 œÑ
 B   1
  fc
  œÑ
dœÑ
(6.91)
where, Ac is the closed-loop system equation in the interval at t
  T3
  T4
  using
Equation (6.90).
Ac
  



0
0
1 0
0
0
0 1
0
0
0 0
k
m2
  k
m2
0 0
 



(6.92)
For the computational accuracy and convenience, it is very useful to use the follow-
ing property [9] to compute the states at the switch times:
exp

A B
0 0
 t
    eAt
  t
0 eA  t
 œÑ
 BdœÑ
0
1
 
(6.93)
Now the problem can be solved for switch times numerically by minimizing the Ô¨Ånal
time T6 with the constraints
Àôx1
 T2
   0
Àôx1
 T3
   0
x Tf
 
1
1
0
0  T
(6.94)
The resulting control proÔ¨Åle is used to verify the optimality of the control input
by inspecting the optimality conditions. The Lagrangian for this problem can be
formulated as [8]
L
  œàN1
 œÄN2
   Tf
t0
 H
 Œª T Àôx
 dt
(6.95)
where,
Hamiltonian
H
  1
 ŒªT
 Ax
 B  u
  fc

  0
  t
  T2
H
  1
 ŒªT
 Ax
 B  u
 fc

  T2
  t
  T3
H
  1
 ŒªT
 Ax
Bu 
 ŒºC
 T3
  t
  T4
H
  1
 ŒªT
 Ax
 B  u
  fc

  T4
  t
  Tf
Interior-point constraint N1
  Àôx1
 T2
   0
N2
  Àôx1
 T3
   0
Equality constraint
C
  ¬®x1
 t
   k
x2
 x1
  u
 0
(6.96)
¬© 2010 by Taylor and Francis Group, LLC

278
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
and the Lagrangian multipliers are deÔ¨Åned as:
Œº
   0 t
  T3
  T4
   0 elsewhere
 œà
   0 t
  T2
  0 elsewhere
and
œÄ
   0 t
  T3
  0 elsewhere
(6.97)
The input u is considered to be within the saturation limit for T3
  t
  T4 because
of the stiction assumption with u
  1. Then, Œº can be found from the following
relationship:
‚àÇH
‚àÇu
  0
  BTŒª
  Œº
or
Œº
  BTŒª
 T3
  t
  T4
(6.98)
Therefore, the costate equation is found from Equation (6.98) and the necessary
optimality condition.
ÀôŒª
  ‚àÇH
‚àÇx
  


 AT
  ‚àÇC
‚àÇx BT

Œª T3
  t
  T4
 ATŒª
elsewhere except t
  T2 and t
  T3
(6.99)
At the interior points, t
  T2 and t
  T3, the costates becomes discontinuous by the
following equations.
 



Œª
 T
 2
   Œª
T
 2
  œà ‚àÇN1
‚àÇx T2
 H  T
 2
   H  T
 2
  œà ‚àÇN1
‚àÇT2
and
 



Œª
 T
 3
   Œª
T
 3
  œÄ ‚àÇN2
‚àÇx T3
 H  T
 3
   H  T
 3
  œÄ ‚àÇN2
‚àÇT3
(6.100)
Because the interior point constraints are not explicit functions of time, the Hamil-
tonian is continuous such that H  T
 2
   H T
 2
  and H  T
 3
   H T
 3
 . Therefore, œà
and œÄ in Equation (6.100) are chosen to satisfy the continuous Hamiltonian require-
ment, which yields the following equations:
Œ≥1
  2fc
 1
  fc
 k
 x1
 T2
  x2
 T2
  and
Œª3
 T
 3
   0
(6.101)
where Œ≥1 satisÔ¨Åes Œª3
T
 2
  = Œª3
 T
 2
  Œ≥1Œª3
T
 2
 . Costates can be integrated forward
in time with the initial Œª
 0  using Equations (6.99) and (6.101).
Œª
 T1
   e
 AT T1Œª
 0  Œª
T
 2
   e
 AT
 T2
 T1
 Œª
 T1
 Œª
 T
 2
  I
J1
 Œª
 T
 2
 Œª
 T
 3
   e
 AT
 T3
 T2
 Œª
 T
 2
 Œª
 T
 3
  I
J2
 Œª
 T
 3
 Œª
 T4
   e
  AT
  ‚àÇC
‚àÇx
T4
 T3
 Œª
 T
 3
 Œª
 T5
   e
 AT
 T5
 T4
 Œª
 T4
 (6.102)
¬© 2010 by Taylor and Francis Group, LLC

Friction Control
279
Where, I is an 4
 4 identity matrix and
J1
  


0 0 0 0
0 0 0 0
0 0 Œ≥1 0
0 0 0 0




and
J2
  


0 0 0 0
0 0 0 0
0 0 ‚àû0
0 0 0 0




(6.103)
Because Œª
 T
 3
  should be zero, inÔ¨Ånite value has to be multiplied to Œª
 T
 3
  in J2 to
0
1
2
3
4
5
6
7
8
9
‚àí2
‚àí1 5
‚àí1
‚àí0 5
0
0 5
1
BTŒª
H
u  t
 unet
t
 T1 T2
T3 T4
T5
Time (sec)
BTŒª
 H  unet
Figure 6.12: Linearizing Control Input, Switching Function, and Hamiltonian
have Ô¨Ånite jump discontinuities in the costates. For numerical computations, a large
number is used in J2 instead of ‚àû. Since the switching curve should cross zero at the
actual switch times, T1, T4, and T5, the following should be satisÔ¨Åed:
M Œª
 0    0
(6.104)
where,
M
  

BTe
 AT T1
BTe
  AT
  ‚àÇC
‚àÇx
T4
 T3
  I
 J2
 e
 AT
 T3
 T2
  I
 J1
 e
 AT
 T2
 T1
 e
 AT T1
BTe
 AT
 T5
 T4
 e
  AT
 ‚àÇC
‚àÇx
 T4
 T3
  I
 J2
 e
 AT
 T3
 T2
  I
 J1
 e
 AT
 T2
 T1
 e
 AT T1
 

(6.105)
¬© 2010 by Taylor and Francis Group, LLC

280
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
Therefore, Œª
 0   is selected to satisfy Equation (6.104) and Hamiltonian requirement,
H
 t
  0    0, such that
Œª
0    NullM

Null
 M
 T B  1
  fc
 (6.106)
In Figure 6.12, the linearizing control input along with the switching curve is plot-
ted. The Hamiltonian is also plotted which is zero for all time. The actual control
input is computed by subtracting the frictional force from the linearizing control in-
put. Because the friction force is zero when the velocity of the Ô¨Årst mass is zero,
the linearizing input is equal to the actual input in the stiction region. However, the
actual control input becomes u
  1 for the stiction interval, since the compensa-
tion of the spring force is not necessary to stay stuck. Therefore, the actual control
input becomes a three switch bang-bang. The resulting net control input satisÔ¨Åes the
necessary optimality conditions as shown in Figure 6.12.
0
2
4
6
8
10
12
‚àí1
0
1
2
0
2
4
6
8
10
12
‚àí1.5
‚àí1
‚àí0.5
0
0.5
1
1.5
T1
T1
T2
T2
T3
T3
T4
T4
u  t
 unet
t
 Time (sec)
Àôx1
unet
Figure 6.13: Velocity and Control Input ProÔ¨Åles
As the Ô¨Ånal displacement is increased further, the proÔ¨Åle of the control shows
another transition where the velocity of the Ô¨Årst mass can be illustrated as shown in
the upper plot in Figure 6.13. The control proÔ¨Åle can be solved in a manner similar
to the previous development, when the velocity of the Ô¨Årst mass is forced to zero for
T2
  t
  T3. The corresponding control input is also plotted in Figure 6.13. The net
control input now has four control switches without the negative velocity maneuvers
¬© 2010 by Taylor and Francis Group, LLC

Friction Control
281
of the Ô¨Årst mass. The actual control input stays as a three-switch bang-bang. If the
Ô¨Ånal displacement is increased further, the velocity of the Ô¨Årst mass will stay positive
during the maneuver. Then, the net control input can be parameterized with the
three-switch bang-bang proÔ¨Åle as shown in Figure 6.14, which is a Coulomb friction
biased control. The time-delay Ô¨Ålter approach can be used for this proÔ¨Åle since the
0
2
4
6
8
10
12
‚àí1
0
1
2
0
2
4
6
8
10
12
‚àí1.5
‚àí1
‚àí0.5
0
0.5
1
1.5
T1
T1
T2
T2
T3
T3
u  t
 unet
t
 Time (sec)
Àôx1
unet
Figure 6.14: Velocity and Control Input ProÔ¨Åles
linearizing input does not depend on the states. The resulting velocity response of
the Ô¨Årst mass for this net input is shown in Figure 6.14. The summary of the control
input transition proÔ¨Åle for the example problem is shown in Figure 6.15.
The switch times are plotted as a function of Ô¨Ånal displacement showing that con-
trol switches are smooth curves for Ô¨Ånal displacement changes. The actual control
switches are plotted with solid lines and velocity switches are plotted with dotted
lines in Figure 6.15. The linearizing net input and actual control input proÔ¨Åles are
also shown in Figure 6.15 for different displacements.
This section focused on the design of time-optimal control proÔ¨Åles for systems
subject to Coulomb friction which result in an open-loop control solution. There are
legacy systems that are plagued by the effects of friction and which use feedback con-
trol for tracking reference inputs. These feedback controlled systems can maneuver
the systems states to the proximity of the desired position, but the effect of friction
is manifested in the form of steady state error. The following section deals with the
¬© 2010 by Taylor and Francis Group, LLC

282
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
0
2
4
6
8
10
12
14
0
5
10
15
I
II
III
IV
Region I
Region II
Region III
Region IV
T‚Äôs
Àôx1
 t
 unet
 t

u  t

Figure 6.15: Switch Time vs. Displacement with Velocity and Control Input
ProÔ¨Åles
design of simple open-loop control proÔ¨Åles to compensate for the small steady-state
errors.
6.2
Pulse-Width Pulse-Amplitude Control
For small motions of systems subject to friction, Yang and Tomizuka [10] pro-
posed a technique that uses the pulse-width control (PWC). Here, it is assumed that
a standard feedback control is used to move the system to the vicinity of the desired
Ô¨Ånal position. The presence of inaccurate knowledge of friction precludes the accu-
rate tracking of the desired position. In such a setting, an adaptive PWC technique
can be used to accurately move the system to the desired position. This technique will
be presented as a precursor to the development of the pulse-width pulse-amplitude
control (PWPAC) technique.
¬© 2010 by Taylor and Francis Group, LLC

Friction Control
283
6.2.1
Rigid Body
This section will review the pulse-width control technique proposed by Yang and
Tomizuka [10] for a rigid-body system subject to Coulomb friction. The beneÔ¨Åt of
estimating the coefÔ¨Åcient of friction and using it in conjunction with the pulse-width
control will be illustrated. This will be followed by the development of the pulse-
amplitude pulse-width control technique that will be shown to reduce the terminal
position error compared to pulse-width control.
6.2.1.1
Pulse-Width Control
Consider a rigid-body subject to Coulomb friction as shown in Figure 6.1. The
equation of motion of this system is
m¬®x
  fcsgn  Àôx    u
(6.107)
where m is the system mass, fc is the Coulomb friction coefÔ¨Åcient, x is the position
of the mass and u is the control input. Consider the response of this system to a pulse
of width tp and height up. The response of such a system initially at rest is
x t
 
 





1
2mt2
 up
  fc
 for 0
  t
  tp
 1
2mt2
p
  tp
m
 t
 tp

  up
  fc

  1
2m
 t
 tp
 2 fc
for tp
  t
  tp
  tp
 up
 fc
 fc
(6.108a)
Àôx t
 
 



1
mt
 up
  fc
 for 0
  t
  tp
tp
m
 up
  fc
   1
m
 t
 tp
 fc
for tp
  t
  tp
  tp
 up
 fc
 fc
(6.108b)
Equation (6.108b) states that the velocity of the rigid body at the end of the pulse
(t
  tp) is 1
mtp
 up
  fc
 . After the duration of the pulse, the frictional force forces the
coasting system to rest at t
  tp
  tp
 up
 fc
 fc
. It can be seen from Equation (6.108b)
that the system comes to rest at
t
  tp
 up
  fc
tp
fc
 uptp
fc
(6.109)
with a Ô¨Ånal displacement (xf ) of
xf
  up
 up
  fc

2mfc
t2
p
(6.110)
where it is assumed that up
  fc. The friction model used for the determination of
the displacement is a simple one which does not capture the stiction phenomenon,
Stribeck effect, and so forth. Therefore, the Ô¨Ånal displacement of the real system
will differ from the desired displacement. Subsequent pulses are required to move
the system to within a prespeciÔ¨Åed tolerance of the Ô¨Ånal desired position.
¬© 2010 by Taylor and Francis Group, LLC

284
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
For an estimated coefÔ¨Åcient of friction ÀÜfc, the pulse width, for a desired displace-
ment of xf is given by the equation:
tp
  xf
2m ÀÜfc
up
 up
  ÀÜfc
  (6.111)
while the actual displacement of the system is:
d1
  up
 up
  fc

2mfc
xf
2m ÀÜfc
up
 up
  ÀÜfc
  up
  fc
 ÀÜfc
fc
 up
  ÀÜfc
 xf
  Œûxf
(6.112)
where Œû
  up
 fc
  ÀÜfc
fc
 up
  ÀÜfc
 . The error in the displacement xf
 d1 is used to determine the
pulse width for the subsequent pulse which results in the displacement:
d2
  Œû  xf
 Œûxf
   Œûxf
 Œû2xf
 (6.113)
It can be shown that the displacement of the nth pulse is:
dn
  Œûxf
 Œû2xf
 Œû3xf
      1  n  1Œûnxf
(6.114)
The total displacement of the system is:
x
 n
‚àë
i 1
di
 n
‚àë
i 1
  1  i 1
 nCi
 Œûixf
 1
  1
 Œû  n
 xf
(6.115)
where nCi represents the number of combinations of n variables taken i at a time and
is given by the equation:
nCi
 n!
 n
 i !i!
(6.116)
where n! refers to n factorial. For x to converge to xf , Œû is required to lie in the range:
 1
  1
Œû  
1

up
  fc
  ÀÜfc
fc
 up
  ÀÜfc
    1
(6.117)
which results in the constraints:
ÀÜfc
  2up fc
up
  fc
(6.118)
ÀÜfc
  up and fc
  up
(6.119)
Figure 6.16 illustrates the region within which ÀÜfc should lie for the repeated applica-
tion of the pulse-width control of friction, to converge to the desired displacement.
Figure 6.16 is generated for a true friction coefÔ¨Åcient of 0.3 and for a peak pulse
amplitude of 1.
¬© 2010 by Taylor and Francis Group, LLC

Friction Control
285
0
0.2
0.4
0.6
0.8
1
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
True Friction
 fc
 Estimated Friction ( ÀÜfc)
Figure 6.16: Stability Region
0
1
2
3
4
5
6
‚àí1
‚àí0.8
‚àí0.6
‚àí0.4
‚àí0.2
0
0.2
0.4
0.6
0.8
1
Time (sec)
Control
(i) Control
0
1
2
3
4
5
6
‚àí0.2
0
0.2
0.4
0.6
0.8
1
Time (sec)
System States
Displacement
Velocity
(ii) System Response
Figure 6.17: Underestimated Friction Results
Assuming a true friction coefÔ¨Åcient of 0.3 and an estimated friction of 0.25, sim-
ulation results of the PWC with a pulse amplitude of 1 are illustrated in Figure 6.17.
It is clear from Figure 6.17(ii) that the underestimation of the coefÔ¨Åcient of friction
results in a net displacement that is smaller than anticipated for each pulse. This
results in a series of positive pulses with monotonically decreasing pulse widths as
shown in Figure 6.17(i).
Assuming a true friction coefÔ¨Åcient of 0.3 and an estimated friction of 0.35, sim-
ulation results of the PWC with a pulse amplitude of 1 are illustrated in Figure 6.18.
¬© 2010 by Taylor and Francis Group, LLC

286
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
0
1
2
3
4
5
6
7
‚àí1
‚àí0.8
‚àí0.6
‚àí0.4
‚àí0.2
0
0.2
0.4
0.6
0.8
1
Time (sec)
Control
(i) Control
0
1
2
3
4
5
6
7
‚àí0.4
‚àí0.2
0
0.2
0.4
0.6
0.8
1
1.2
1.4
Time (sec)
System States
Displacement
Velocity
(ii) System Response
Figure 6.18: Overestimated Friction Results
It is clear from Figure 6.18(ii) that the overestimation of the coefÔ¨Åcient of friction
results in a net displacement which is larger than anticipated for each pulse. This
results in a series of pulses whose signs change and whose widths monotonically
decrease as shown in Figure 6.18(i).
Figure 6.19 presents the phase plots of the pulse-width control for the case where
the friction is under- and overestimated. When friction is overestimated, signiÔ¨Åcant
overshoot can result which might be undesirable when displacement constraints are
imposed on the motion of the system.
0
0.2
0.4
0.6
0.8
1
‚àí0.1
0
0.1
0.2
0.3
0.4
0.5
0.6
Estimated Friction 0.25,Friction 0.3
Displacement
Velocity
(i) Underestimated Friction
0
0.2
0.4
0.6
0.8
1
1.2
1.4
‚àí0.4
‚àí0.2
0
0.2
0.4
0.6
0.8
1
Estimated Friction 0.35,Friction 0.3
Displacement
Velocity
(ii) Overestimated Friction
Figure 6.19: Phase Plane Responses
Equation (6.118) results in an upper bound on the estimated friction ÀÜfc of 0.4615
for a true friction of 0.3 and a peak pulse amplitude of 1. Assuming a friction estimate
of 0.5 results in an unstable response as shown in Figure 6.20, conÔ¨Årming the bounds
given in Equation (6.118).
¬© 2010 by Taylor and Francis Group, LLC

Friction Control
287
0
5
10
15
20
25
30
35
‚àí1
‚àí0.8
‚àí0.6
‚àí0.4
‚àí0.2
0
0.2
0.4
0.6
0.8
1
Time (sec)
Control
(i) Control
0
5
10
15
20
25
30
35
‚àí3
‚àí2
‚àí1
0
1
2
3
4
5
6
Time (sec)
System States
Displacement
Velocity
(ii) System Response
Figure 6.20: Unstable Friction Results
6.2.1.2
Adaptive Pulse-Width Control
The friction model used for the determination of the pulse width is a simple one,
which does not capture the stiction, Stribeck effect, and so forth. Therefore, the
Ô¨Ånal displacement will differ from the desired displacement. Subsequent pulses are
required to move the system to within a prespeciÔ¨Åed tolerance of the Ô¨Ånal desired
position. This prompts the use of an algorithm for the real-time estimation of the
friction coefÔ¨Åcient ( ÀÜfc) which can subsequently be used to solve for the pulse width
to drive the system to the Ô¨Ånal position. Assuming that only the pulse width can be
modiÔ¨Åed for each implementation of the pulse, Yang and Tomizuka [10] suggested
representing the system displacement dynamics as:
x k
 1    xk

d
k
1  (6.120)
and the displacement error as:
e  k
  xf
 xk
  (6.121)
The error dynamics can now be represented as:
e  k
 1    ek

 d
k
1  (6.122)
where the incremental displacement is deÔ¨Åned as:
d
 k
 1    up
up
  fc

2mfc
 

b
t2
psgn  e k
   bt2
psgn  e k
   bœâ
k
 (6.123)
where
œâ
 k
  t2
psgn  e k
   (6.124)
If b which is a function of the coefÔ¨Åcient of friction is treated as a known quantity,
the feedback control law
¬© 2010 by Taylor and Francis Group, LLC

288
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
œâ
 k
  1
bKce k
 (6.125)
results in the error dynamics:
e  k
 1   1
 Kc
 e k

(6.126)
which from discrete time stability constraint requires 0
  Kc
  2 which will place
the discrete-time pole inside the unit circle.
Since b is unknown, the following control law is proposed:
œâ
 k
  1
ÀÜb
Kce k
 (6.127)
which implies
tp
 k
 1    œâ
k

  Kc
ÀÜb k
  ek
  (6.128)
where ÀÜb is the estimate of b.
The recursive least-squares algorithm is used to estimate the unknown parameters.
The adaptation algorithm is given by the equations in Reference [11]:
œÄ
 k
  P k
 1  u  k

(6.129)
P  k
  Œª
 1P  k
 1   Œª
 1K
 k
 uH
k
 P k
 1  (6.130)
K
 k
 
œÄ
k
 Œª
uH
k
 œÄ
k
 (6.131)
Œæ
  d
 k

  ÀÜbH
 k
 1  u  k

(6.132)
ÀÜb k
  ÀÜb k
 1   K
k
Œæ H
k

(6.133)
u  k
 
 t2
p
 (6.134)
The superscript H stands for the Hermitian transpose. In this case, all values are
real and thus H can be replaced by T. In [11], K is described as the time-varying
gain vector and P as the inverse correlation matrix. The Œª in the algorithm represents
the forgetting factor. Generally, the forgetting factor is selected to be smaller than
but close to 1 and is set to 1 if all data is to be equally weighted. If the forgetting
factor is not required, Œª should be set to 1.
For the initiation of the adaptation algorithm, initial conditions for P  0   and ÀÜb  0  are required. ÀÜb  0   should be chosen as accurately as possible and the inverse covari-
ance matrix P  0   is set to P  0   Œ¥
 1I. Œ¥ should be large if the sensors are noisy
and small if otherwise.
Assuming a true friction coefÔ¨Åcient of 0.3 and an initial estimate of friction of
0.25, simulation results with a pulse amplitude of 1 are illustrated in Figure 6.21.
¬© 2010 by Taylor and Francis Group, LLC

Friction Control
289
0
1
2
3
4
5
6
‚àí1
‚àí0.8
‚àí0.6
‚àí0.4
‚àí0.2
0
0.2
0.4
0.6
0.8
1
Time (sec)
Control
(i) Control
0
1
2
3
4
5
6
0
0.2
0.4
0.6
0.8
1
Time (sec)
System States
Displacement
Velocity
(ii) System Response
Figure 6.21: Underestimated Friction Results
It is clear from Figure 6.21(ii) that the underestimation of the coefÔ¨Åcient of friction
results in a net displacement which is smaller than anticipated for each pulse. This
results in a series of positive pulses with monotonically decreasing pulse widths as
shown in Figure 6.21(i). The maneuver time is 5.143 seconds, compared to 5.0200
for the nonadaptive pulse-width controller, which is about the same.
Assuming a true friction coefÔ¨Åcient of 0.3 and an estimated friction of 0.35, sim-
ulation results with a pulse amplitude of 1 are illustrated in Figure 6.22.
0
1
2
3
4
5
‚àí1
‚àí0.8
‚àí0.6
‚àí0.4
‚àí0.2
0
0.2
0.4
0.6
0.8
1
Time (sec)
Control
(i) Control
0
1
2
3
4
5
‚àí0.4
‚àí0.2
0
0.2
0.4
0.6
0.8
1
1.2
1.4
Time (sec)
System States
Displacement
Velocity
(ii) System Response
Figure 6.22: Overestimated Friction Results
It is clear from Figure 6.22(ii) that the overestimation of the coefÔ¨Åcient of friction
results in a net displacement which is larger than anticipated for each pulse. This
results in a series of pulses whose signs change and whose widths monotonically
decrease as shown in Figure 6.22(i). The maneuver time is 4.648 seconds, compared
to 6.9440 seconds for the nonadaptive pulse-width controller, which is a signiÔ¨Åcant
¬© 2010 by Taylor and Francis Group, LLC

290
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
1
2
3
4
5
6
0.25
0.255
0.26
0.265
0.27
0.275
0.28
0.285
0.29
Iteration #
Estimated Friction
(i) Estimate of Friction (fc
 0  = 0.25)
1
1.5
2
2.5
3
3.5
4
0.305
0.31
0.315
0.32
0.325
0.33
0.335
0.34
0.345
0.35
Iteration #
Estimated Friction
(ii) Estimate of Friction (fc
 0  = 0.35)
Figure 6.23: Adaptive PWC
0
1
2
3
4
5
6
7
8
9
‚àí1
‚àí0.8
‚àí0.6
‚àí0.4
‚àí0.2
0
0.2
0.4
0.6
0.8
1
Time (sec)
Control
(i) Control
0
2
4
6
8
10
‚àí1
‚àí0.5
0
0.5
1
1.5
2
2.5
Time (sec)
System States
Displacement
Velocity
(ii) System Response
Figure 6.24: Unstable Friction Estimate
improvement.
Figure 6.23 illustrates the evolution of the estimate of the friction coefÔ¨Åcient and
it is clear that they tend toward the true friction coefÔ¨Åcient of 0.3.
The nonadaptive system resulted in an unstable response when a friction estimate
of 0.5 was used for a system with a true friction of 0.3. Figure 6.24 illustrates the
stable response generated by the adaptive friction estimator used in conjunction with
the pulse-width controller. The controller is initiated with a friction estimate of 0.5.
6.2.1.3
Pulse-Amplitude Pulse-Width Control (PAPWC)
The PAPWC permits adaptation of the amplitude of the pulse in addition to pulse
width. This additional degree of freedom is exploited in digital implementation of
the PAPWC since the pulse width of the PWC might not coincide with an integer
multiple of the sampling interval. Since the desired displacement remains the same
for the PWC and the PAPWC, altering the pulse width results in an adjustment of the
pulse amplitude as well.
¬© 2010 by Taylor and Francis Group, LLC

Friction Control
291
The pulse width needs to be rounded to the higher integer multiple of the sampling
time T, i.e., Tx
  nT
  tp, so that the corresponding pulse amplitude is smaller than
or equal to the maximum permitted pulse amplitude up. The desired displacement d
must be the same for both tp and Tx, which results in:
d
 tp
  d
Tx
 (6.135)
bt2
p sgn  e  b
 T 2
x sgn  e (6.136)
up
 up
  fc
 2mfc
t2
p sgn  e  u
 p
u
 p
  fc
 2mfc
T 2
x sgn  e (6.137)
The constant b must change to b
  to satisfy Equation (6.135). This can only be done
by varying the pulse amplitude u
 p, since this is the only free parameter in b
 . Solving
Equation (6.137) results in [12]:
u
 p
  0  5fc
 0  5
 f 2c
 4up
 up
  fc
  t2p
 Tx
 2
(6.138)
Instead of using tp and up, the control pulse is speciÔ¨Åed by Tx and u
 p. Since the
coefÔ¨Åcient of friction fc is an unknown quantity, an adaptation algorithm is necessary
for the implementation of the PAPWC scheme.
Rewriting the variable b as:
ÀÜb
  1
2mfc
1
2m
   u2
p
 up
   A1 A2
   u2
p
 up
 (6.139)
the variables that need to be estimated for are A1 and A2. From the estimates ÀÜA1
and ÀÜA2, an estimate of fc can be derived by dividing ÀÜA2 by ÀÜA1. Using ÀÜfc in Equa-
tion (6.138), the pulse amplitude is calculated.
The PAPWC algorithm requires two parameters to be estimated and the algorithm
is given by the equations:
œÄ
 k
  P k
 1  u  k

(6.140)
P  k
  Œª
 1P  k
 1   Œª
 1K
 k
 uH
k
 P k
 1  (6.141)
K
 k
 
œÄ
k
 Œª
uH
k
 œÄ
k
 (6.142)
Œæ
  d
 k

  ÀÜaH
 k
 1  u  k

(6.143)
ÀÜa k
  ÀÜa k
 1   K
k
Œæ H
k

(6.144)
u  k
 
 f 2
pt2
p
 fpt2
p
 T
(6.145)
¬© 2010 by Taylor and Francis Group, LLC

292
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
Assuming as in the section on adaptive pulse-width control, a true friction coefÔ¨Å-
cient of 0.3 and an initial estimate of the coefÔ¨Åcient of friction of 0.25 and 0.35, nu-
merical simulations are used to illustrate the beneÔ¨Åt of the adaptive pulse-amplitude
pulse-width control. Figures 6.25 and 6.26 illustrate the control proÔ¨Åles and the cor-
responding evolution of the system states. It is clear from Figures 6.25 and 6.26 that
the maneuver time is 4.641 and 4.93 seconds, for the maneuvers which correspond
to an underestimation and overestimation of the coefÔ¨Åcient of friction, respectively.
This compares to 5.020 and 4.648 seconds, for the adaptive pulse-width control.
0
1
2
3
4
5
‚àí1
‚àí0.8
‚àí0.6
‚àí0.4
‚àí0.2
0
0.2
0.4
0.6
0.8
1
Time (sec)
Control
(i) Control
0
1
2
3
4
5
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
Time (sec)
System States
Displacement
Velocity
(ii) System Response
Figure 6.25: Adaptive PAPWC
0
1
2
3
4
5
‚àí1
‚àí0.8
‚àí0.6
‚àí0.4
‚àí0.2
0
0.2
0.4
0.6
0.8
1
Time (sec)
Control
(i) Control
0
1
2
3
4
5
‚àí0.4
‚àí0.2
0
0.2
0.4
0.6
0.8
1
1.2
Time (sec)
System States
Displacement
Velocity
(ii) System Response
Figure 6.26: Adaptive PAPWC
Figure 6.27 illustrates the evolution of the estimate of the friction coefÔ¨Åcient and
it is clear that they tend toward the true friction coefÔ¨Åcient of 0.3.
¬© 2010 by Taylor and Francis Group, LLC

Friction Control
293
1
1.5
2
2.5
3
0.25
0.26
0.27
0.28
0.29
0.3
0.31
0.32
Iteration #
Estimated Friction
(i) Estimate of Friction (fc
 0  = 0.25)
1
1.5
2
2.5
3
3.5
4
0.29
0.3
0.31
0.32
0.33
0.34
0.35
Iteration #
Estimated Friction
(ii) Estimate of Friction (fc
 0  = 0.35)
Figure 6.27: Adaptive PAPWC
A true comparison of the adaptive PWC and PAPWC requires that identical sam-
pling times be selected. In the section on adaptive PWC, it was assumed that the
pulse width could be implemented without any round-off of the maneuver time to an
integer multiple of the sampling time. Figures 6.28 and 6.29 illustrate the time evolu-
tion of the system states and the control proÔ¨Åles when the controller is initiated with
an under- and an overestimate of the coefÔ¨Åcient of friction respectively. The solid
lines correspond to the adaptive PWC and the dashed line to the adaptive PAPWC.
It is clear from Figure 6.28, that the adaptive PWC results in a limit cycle. In both
scenarios, the adaptive PAPWC outperforms the adaptive PWC. A sampling time of
Ts
  0  05 was selected for the simulation.
0
2
4
6
8
10
‚àí1
‚àí0.8
‚àí0.6
‚àí0.4
‚àí0.2
0
0.2
0.4
0.6
0.8
1
Time (sec)
Control
(i) Control ProÔ¨Åle (fc
 0  = 0.25)
0
2
4
6
8
10
‚àí0.2
0
0.2
0.4
0.6
0.8
1
1.2
Time (sec)
System States
Displacement
Velocity
(ii) State Response ( fc
 0  = 0.25)
Figure 6.28: Adaptive PWC, PAPWC
The smallest displacement of the mass when subject to a pulse-width control pro-
Ô¨Åle is:
¬© 2010 by Taylor and Francis Group, LLC

294
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
0
1
2
3
4
5
6
‚àí1
‚àí0.8
‚àí0.6
‚àí0.4
‚àí0.2
0
0.2
0.4
0.6
0.8
1
Time (sec)
Control
(i) Control ProÔ¨Åle (fc
 0  = 0.35)
0
1
2
3
4
5
6
‚àí0.4
‚àí0.2
0
0.2
0.4
0.6
0.8
1
1.2
Time (sec)
System States
Displacement
Velocity
(ii) State Response ( fc
 0  = 0.35)
Figure 6.29: Adaptive PWC, PAPWC
dmin
 Ts
  up
up
  fc
 2mfc
T 2
s
  0  0029  (6.146)
for m
  1, Ts
  0  05, up
  1, and fc
  0  3. The smallest displacement of the PAPWC
is given by the equation:
dmin
 Ts
  fs
fs
  fc
 2mfc
T 2
s
  0  000167  (6.147)
where fs, the static friction is assumed to be 0.4. When the desired resolution is less
than the smallest possible displacement, there exists the potential for limit cycles.
6.2.2
Benchmark Problem
This section will extend the pulse-amplitude pulse-width control technique for
point-to-point control of the benchmark Ô¨Çoating oscillator system subject to friction.
A three pulse control is parameterized which assumes that the velocity of the mass
subject to friction will not change sign over the duration of the maneuver. The pole-
zero cancelation approach developed in Chapter 2 will be exploited in the design of
the control proÔ¨Åle.
6.2.2.1
Problem Formulation
The Ô¨Çoating oscillator under the inÔ¨Çuence of friction is illustrated in Figure 6.30,
where m1, m2 are the Ô¨Årst and second mass, k is the spring constant, u the control
input, f the friction force and x1, x2 are the positions of the Ô¨Årst and second mass.
The equation of motion of the system can be written as
M¬®x
 Kx
  Du
  f

(6.148)
¬© 2010 by Taylor and Francis Group, LLC

Friction Control
295
m1
m2
k
f
u
x1
x2
Figure 6.30: Floating Oscillator under Friction
where M, K, D, and x are
M
  m1 0
0 m2
  K
   k
 k
 k k
  D
 1
0
  x
  x1
x2
 (6.149)
The friction force is modeled as a nonlinear function of the velocity which accounts
for static and Coulomb friction. The friction model can be represented as:
f
 x
 u  
 

fcsgn Àôx1
  if Àôx1
   0
fssgn  us
  if Àôx1
  0 and us
  fs
us
if Àôx1
  0 and us
  fs
(6.150)
where fs is the static friction, fc is the Coulomb friction and us is the sum of the
forces applied to the Ô¨Årst mass, which is
us
  u
 k
x2
 x1
  (6.151)
If the velocity of the Ô¨Årst mass remains larger than zero during the entire maneuver,
the friction force for a rest-to-rest maneuver becomes
f
  fc
 1
 H
 t
 Tf
  (6.152)
where H
    is the Heaviside step function and Tf is the Ô¨Ånal time. With this friction
model, Equation (6.148) becomes
M¬®x
 Kx
  D
 u
  fc
 1
 H
 t
 Tf
    (6.153)
It is more convenient to study the Ô¨Çoating oscillator system if the decoupled equa-
tions of motion are used. DeÔ¨Åne the decoupled states as z
  Œ∏
  q T, where Œ∏ and q
denote the rigid and Ô¨Çexible body states of the system. The transformation matrix V
can be formed from the eigenvectors of the system, which decouples the system with
the relationship x
  Vz. The decoupled system model is
  ¬®Œ∏
¬®q
   0 0
0 œâ2

 Œ∏
q
   

1
m1
 m2
 1
m1
 m2
 


u
  fc
 1
 H
 t
 Tf
   (6.154)
¬© 2010 by Taylor and Francis Group, LLC

296
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
where V and œâ are
V
  1
 m2
m1
1
1
  œâ
  k
 m1
 m2
 m1m2
(6.155)
For a rest-to-rest maneuver problem, the boundary conditions are
x1
 0   x2
 0   0
x1
 Tf
   x2
 Tf
  d
Àôx1
 0   Àôx2
 0   0
Àôx1
 Tf
   Àôx2
 Tf
  0
(6.156)
where, d is the desired position at Tf and the corresponding boundary conditions of
the decoupled states are
Œ∏
 0   ÀôŒ∏
0   0
Œ∏
Tf
   d
  ÀôŒ∏
 Tf
  0
q  0    Àôq  0   0
q  Tf
  Àôq  Tf
  0  (6.157)
6.2.2.2
Pole-Zero Cancelation
In our development, a three pulse proÔ¨Åle is initially assumed as shown in Figure
6.31(a). The control proÔ¨Åle results in an active control period of time T3 at which
point the system is traveling with nonzero velocity [13]. Following the implementa-
tion of the third pulse, the system is allowed to coast to rest. The pulse widths are
t
t
u
T1
T1
T2
T2
T3
T3
A0
A1
A1
A2
A2
A3
A3
u
  fc
 1
 H
 t
 Tf
 
A0
  fc
fc
 fc
Tf
(a) Three Pulse Input
(b) Coulomb Friction Biased Input
Figure 6.31: Input ProÔ¨Åle
selected by the user, and can correspond to the sampling time or an integral multi-
ple of the sampling time for the digital implementation of the controller. The pulse
amplitudes are subsequently determined to satisfy the boundary conditions. Since
the velocity state of the Ô¨Årst mass is assumed to remain positive over the duration
of the maneuver, the new input to the linear system is biased by the magnitude of
Coulomb friction as shown in Figure 6.31(b). The Coulomb friction biased input can
¬© 2010 by Taylor and Francis Group, LLC

Friction Control
297
be parameterized as
u  t
   fc
1
 H
 t
 Tf
 

A0
  fc
  A1H
 t
 T1
 (6.158)
 A2H
 t
 T2
  A3H
 t
 T3
   fcH
t
 Tf
 This biased input u  t
   fc
1
 H
 t
 Tf
  can be generated by a time-delay Ô¨Ålter with
a transfer function
G s 
A0
  fc
  A1e
 sT1
 A2e
 sT2
 A3e
 sT3
  fce
 sTf
(6.159)
when it is subject to a unit step input. Since the control input in Figure 6.31(a) should
be zero for t
  T3, we arrive at the constraint
A0
 A1
 A2
 A3
  0  (6.160)
In order to eliminate the vibration at the end of the maneuver, a pair of zeros of
the transfer function (Equation 6.159), should cancel the Ô¨Çexible mode poles of the
system [14]. To cancel the Ô¨Çexible mode poles, the real and imaginary parts of the
transfer function G s  evaluated at s
  jœâ, should be equated to zero resulting in the
equations:
A0
 A1cosœâT1
 A2cosœâT2
 A3cosœâT3
  fc
 1
 cosœâTf
 (6.161)
 A1sinœâT1
 A2sinœâT2
 A3sinœâT3
  fc sinœâTf
(6.162)
The displacement of the rigid-body at the Ô¨Ånal time is sum of the rigid-body dis-
placement at t
  T3 and the coasting displacement:
Œ∏
 Tf
   Œ∏
T3
   m1
 m2
2fc
  ÀôŒ∏
 T3
  2
  d
 (6.163)
Œ∏
 T3
  and ÀôŒ∏
 T3
  are found by solving the rigid-body differential equation:
Œ∏
 T3
  1
2 m1
 m2
  A0
 T3
 2
 A1
 T3
 T1
 2
 A2
 T3
 T2
 2
  fc
 T3
 2
 (6.164)
ÀôŒ∏
 T3
  1
m1
 m2
 A0T3
 A1
 T3
 T1
  A2
 T3
 T2
   fcT3
  (6.165)
The Ô¨Ånal time can be found by adding the coasting time to T3. Since, satisfying
Equations (6.161) and (6.162) is equivalent to the Ô¨Çexible states being forced to zero
at the Ô¨Ånal time, the coasting time is found by solving the rigid body equation for
t
  T3, by equating the velocity of the rigid body to be zero at t
  Tf . The resulting
Ô¨Ånal time is
Tf
  T3
 ÀôŒ∏
 T3
  m1
 m2
 fc
  1
fc
 A1T1
 A2T2
 A3T3
 (6.166)
The solution of the multi-pulse controller is determined by solving Equations (6.160),
through (6.163) which results in four nonlinear equations in four unknowns A0  1  2  3.
An iterative approach for solving for the Ô¨Ånal time and the pulse amplitudes will be
presented in the next section.
¬© 2010 by Taylor and Francis Group, LLC

298
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
6.2.2.3
Iterative Solution Approach
If the Ô¨Çexible motion states q  Tf
  and Àôq Tf
  are forced to zero at the Ô¨Ånal time,
residual vibration will be eliminated. Since the Ô¨Ånal time in Equation (6.166) is a
function of pulse amplitudes, Equations (6.161) and (6.162) are difÔ¨Åcult to solve.
To address this problem, the states of the Ô¨Çexible mode at t
  T3 that will force the
Ô¨Çexible motion to be zero at the Ô¨Ånal time are derived. Solutions of the Ô¨Çexible mode
equation at t
  T3 are
q  T3
   1
œâ2
 m1
 m2
   fc
 A0cosœâT3
 A1cosœâ
 T3
 T1
 (6.167)
 A2cosœâ
 T3
 T2
  A3
  fc cosœâT3
 Àôq  T3
   1
œâ
m1
 m2
  A0 sinœâT3
 A1sinœâ
 T3
 T1
 (6.168)
 A2 sinœâ
 T3
 T2
   fc sinœâT3
  The equation of motion of the Ô¨Çexible mode for the coasting period with initial con-
ditions q  T3
  and Àôq  T3
  is
¬®qc
 œâ2qc
  fc
 1
 H
 t
 Tc
 
m1
 m2
(6.169)
where qc is the Ô¨Çexible mode state for the coasting period and the coasting time
Tc
  Tf
 T3. The solution to Equation (6.169) is
qc
 t
 
fc
m1
 m2
   1
œâ2
  cosœât
œâ2
    1
œâ2
  cosœâ
 t
 Tc
 œâ2
 H
 t
 Tc
  (6.170)
 q  T3
 cosœât
  Àôq  T3
 sinœât
œâ
Àôqc
 t
 
fc
m1
 m2
 sinœât
œâ
  q  T3
 œâ sinœât
  Àôq T3
 cosœât
 (6.171)
At t
  Tc, the Ô¨Çexible motion should be eliminated. By substituting Tc into Equations
(6.170) and (6.171) and equating them to zero, the Ô¨Çexible states at t
  T3 which will
force the Ô¨Çexible states to zero at the Ô¨Ånal time are
 q  T3
 Àôq  T3
    

  fc
cosœâTc
 1  œâ2
 m1
 m2
   fc sinœâTc
œâ
 m1
 m2
  

 (6.172)
The Ô¨Çexible states at t
  T3 shown in Equation (6.172) will force the Ô¨Çexible motion
to be eliminated at the end of the maneuver if Tc is known. However, the total
¬© 2010 by Taylor and Francis Group, LLC

Friction Control
299
maneuver time is a function of pulse amplitudes and therefore, an iterative approach
is used to Ô¨Ånd the total maneuver time and Tc. Rewriting the constraint Equations
(6.160), (6.167), and (6.168) in terms of A1, A2, and A3, the constraint equations in
matrix form become
 
 1
1
 1
 cosœâ
 T3
 T1
  cosœâ
 T3
 T2
  1
 sinœâ
 T3
 T1
  sinœâ
 T3
 T2
  0
 


A1
A2
A3
 
 

 1
 cosœâT3
 sinœâT3
 A0
  
0
fc cosœâT3
  fc
 œâ2
 m1
 m2
 q  T3
 fc sinœâT3
 œâ
 m1
 m2
  Àôq T3
  
 (6.173)
To Ô¨Ånd initial values for the input pulse amplitudes and Ô¨Ånal time, solve Equation
(6.173) for A1, A2, and A3 in terms of A0 by letting q  T3
   Àôq  T3
   0. By substi-
tuting A1, A2, and A3 into the rigid body constraint in Equation (6.163), A0 can be
determined. Once the pulse amplitudes are found, the Ô¨Ånal time is found by substi-
tuting the pulse amplitudes into Equation (6.166). With this initial Tf , Ô¨Çexible states
at t
  T3 are computed using Equation (6.172). The new pulse amplitudes and total
maneuver time is calculated with these new Ô¨Çexible states at t
  T3. This procedure
is repeated until the Ô¨Çexible states and Ô¨Ånal time converge.
Instead of the iterative approach proposed in this section, an optimization problem
can be posed to minimize Tc subject to the constraints given by Equations (6.163),
(6.166), (6.172), and (6.173), where the variables to be solved for are A0
 A1
 A2
 A3,
and Tc. We have veriÔ¨Åed the solution generated by the iterative algorithm and it is
coincident with that of the optimization algorithm.
6.2.2.4
Bounds on Control Pulse
The multiple pulse input development so far allows the user to select pulse widths
for the prescribed displacement. However, bounds on pulse amplitudes should be
examined because of the positive velocity constraint. The Ô¨Årst pulse amplitude A0
should be greater than the static friction, fs. Also, the pulse amplitude should be less
than the permitted peak input amplitude, up. Therefore, the bounds on A0 become
fs
  A0
  up
(6.174)
The velocity of the Ô¨Årst mass can be written as
Àôx1
 t
 
1
m1
 m2
  A0
  fc
 g  t

 A1g  t
 T1
 H
 t
 T1
  A2g  t
 T2
 H
 t
 T2
   A3g  t
 T3
 H
 t
 T3
  (6.175)
where g  t
  is a function deÔ¨Åned by the following equation:
g  t
  t
 m2 sinœât
m1œâ
(6.176)
¬© 2010 by Taylor and Francis Group, LLC

300
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
For 0
  t
  T1, Equation (6.175) reduces to
Àôx1
 t
   A0
  fc
m1
 m2
g  t
 0
  t
  T1
 (6.177)
Rathbun [15] showed that selection of a speciÔ¨Åc mass ratio guarantees positive ve-
locity of the Ô¨Årst mass for 0
  t
  T1. Since A0 is greater than fc, Equation (6.177)
is always positive if g  t
  is positive. Rewriting the equation for g  t
  yields
g  t
  t
 1
  m2
m1
sinœât
œât
   t
 1
  m2
m1
sinc  œât
    0
(6.178)
Knowing that
 0  2172
  sinc  œât
   1, Equation (6.178) results in bounds on the
ratio of the Ô¨Årst and the second mass which guarantees positive velocity, which is
m1
m2
  0  2172  (6.179)
For systems which violate this mass ratio, multi-pulse control proÔ¨Åles can also be
designed. However, the model of the system will be represented by a series of piece-
wise linear systems which makes solving the problem signiÔ¨Åcantly more difÔ¨Åcult.
The local maximum and minimum of g  t
  coincides with the time when the velocity
of the Ô¨Årst mass reaches its local maximum and minimum. The time derivative of
g  t
  is
Àôg  t
  1
  m2
m1
cosœât
(6.180)
It is patent that Àôg t
  is always positive and hence g  t
  is a nondecreasing function if
m1
m2
  1
(6.181)
If 0  2172
  m1
m2
  1, g  t
  is always positive but not a monotonically increasing func-
tion. Similarly, the velocity of the Ô¨Årst mass for T1
  t
  T2 becomes
Àôx1
 t
   A0
  fc
m1
 m2
g  t
  A1
m1
 m2
g  t
 T1
  T1
  t
  T2
  (6.182)
The Ô¨Årst mass velocity will reach its minimum or maximum values for T1
  t
  T2
when
¬®x1
 t
  1
m1
 m2
 A0
 A1
  fc
  A0
  fc
 m2
m1
cosœât
  A1m2
m1
cosœâ
 t
 T1
    0
(6.183)
Solving Equation (6.183) for t, the velocity of the Ô¨Årst mass will have extreme values
when
tmin  max
  1
œâ
 sin
 1
  C
D
  œÜ
 2nœÄ
 (6.184)
¬© 2010 by Taylor and Francis Group, LLC

Friction Control
301
where, C, D, and œÜ are deÔ¨Åned as
C
 A0
 A1
  fc
D
   m2
 A0
  fc
 A1cosœâT1
 m1
 2
   m2A1 sinœâT1
m1
 2
œÜ
 tan
 1
  A0
  fc
 A1cosœâT1
A1 sinœâT1
 (6.185)
for Equation (6.184). The tmin  max might have none or multiple solutions, for different
integer value of n because tmin  max should lie in the interval
 T1
T2
 . Therefore, the
minimum velocity of the Ô¨Årst mass in this interval becomes
min  Àôx1
    minÀôx1
 T1
   Àôx1
 T2
   Àôx1
 tmin  max
  if 0  2172
  m1
 m2
  1
min Àôx1
 T1
   Àôx1
 T2
  if m1
 m2
  1
(6.186)
Therefore, the constraint on the pulse amplitudes for positive velocity for T1
  t
  T2
can be derived from Equation (6.182), which is
A1
  A0
  fc
 g  tmin

g  tmin
 T1
 (6.187)
where, tmin is the time when the velocity of the Ô¨Årst mass is at its minimum. If
this condition is violated, stiction of the Ô¨Årst mass will occur. The control proÔ¨Åle
should be modiÔ¨Åed because the constant friction assumption is no longer valid. For
T2
  t
  T3, positive A2 will guarantee positive velocity of the Ô¨Årst mass provided
the velocity is positive for t
  T2. The velocity of the Ô¨Årst mass for T3
  t
  Tf is
Àôx1
 t
  ÀôŒ∏
 T3
  fc
m1
 m2
  t
 T3
   m2 sinœâ
 t
 Tf
 m1œâ
 (6.188)
According to Equation (6.188), the velocity of the Ô¨Årst mass never goes to zero if the
mass ratio satisÔ¨Åes the condition shown in Equation (6.179). Equation (6.188) is a
monotonically decreasing function if m1
 m2
  1.
6.2.2.5
Numerical Simulation
Numerical simulations are used to illustrate the performance of the proposed con-
trollers. The parameter values used in the simulation are shown in Table 6.1. The
Ô¨Årst simulation is performed with the initial and Ô¨Ånal states of
x1
 0   x2
 0   0
x1
 Tf
   x2
 Tf
  0  1
Àôx1
 0   Àôx2
 0   0
Àôx1
 Tf
   Àôx2
 Tf
  0  (6.189)
The pulse widths are chosen such that T1
  0  1 seconds, T2
  0  2 seconds, and
T3
  0  3 seconds. If the condition number of the matrix on the left-hand side of
Equation (6.173) is large, or if the resulting solution is one which violates Equa-
tion (6.174), one has to select a different pulse width. The controller for this problem
¬© 2010 by Taylor and Francis Group, LLC

302
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
Table 6.1: Parameters Used in the Simulation
Symbol
Description
Value
m1
Mass 1
80 kg
m2
Mass 2
100 kg
œâ
Natural Frequency
50 rad
 sec
up
Peak Input
1000 N
fs
Static Friction
137 N
fc
Coulomb Friction
111 N
is shown in Figure 6.32 and the corresponding response of the system is plotted in
Figure 6.33. The solid line and the dashed line represent the states of the Ô¨Årst and
second masses, respectively. It is evident that the Ô¨Årst mass velocity is always pos-
0
0.05
0.1
0.15
0.2
0.25
0.3
0.35
0.4
‚àí300
‚àí200
‚àí100
0
100
200
300
400
500
600
Time  sec  u N
 Figure 6.32: Three-Pulse Control Input (d
  0 1)
itive and therefore unidirectional friction force is applied to the system during the
maneuver. The system begins to coast at t
  0  3 seconds and the undesirable vibra-
tion is eliminated at the Ô¨Ånal time. The response plot of the decoupled states are also
shown in Figure 6.34. The Ô¨Çexible states at t
  0  3 are forced such that at the Ô¨Ånal
time the Ô¨Çexible states become zero.
Figure 6.35 illustrates the variation of the pulse input amplitudes as a function of
commanded displacement. The pulse widths are selected to be, T1
  0  04 seconds,
T2
  0  08 seconds, and T3
  0  12 seconds. For this speciÔ¨Åc pulse width, the velocity
of the mass goes to zero during the maneuver for d
  0  0039 m, which corresponds
to the lower displacement bound with the chosen pulse widths. For a displacement of
¬© 2010 by Taylor and Francis Group, LLC

Friction Control
303
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
0
0.05
0.1
0.15
0.2
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
‚àí0.1
0
0.1
0.2
0.3
0.4
Time  sec  x1, x2
 m Àôx1, Àôx2
 m s x1x2
Àôx1Àôx2
Figure 6.33: Response of the System (d
  0 1m)
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
0
0.1
0.2
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
‚àí0.5
0
0.5
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
‚àí5
0
5
x 10
‚àí3
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
‚àí0.1
0
0.1
Time  sec  Œ∏
ÀôŒ∏
q
Àôq
Figure 6.34: Response of the System, Decoupled States (d
  0 1m)
d
  0  278 m, the control input saturates which corresponds to the upper displacement
bound for the prescribed pulse width. The upper and lower bounds can be changed
by selecting pulses of different width.
The relationship of the pulse input amplitudes for different natural frequency val-
ues is illustrated in Figure 6.36. It is clear from Figure 6.36 that there are no feasible
solutions in the frequency range of 76 to 79 rad/sec. This is because the matrix in
Equation (6.173) becomes singular when the switching time is chosen such that:
œâ
 T3
 T2
   2nœÄ
or
œâ
 T3
 T1
   2nœÄ
(6.190)
where, n is a positive integer. Therefore different pulse widths should be selected for
designing a controller if the pulse widths chosen make the condition number of the
¬© 2010 by Taylor and Francis Group, LLC

304
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
0
0.05
0.1
0.15
0.2
0.25
0.3
0
200
400
600
800
1000
1200
Stiction
Input Saturation
Displacement (m)
Pulse Amplitudes (N)
A0
A0
A1
A0
A1
A2
Figure 6.35: Pulse Amplitudes vs. Displacement
matrix in Equation (6.173) very large.
Incorrect estimates of the friction and frequency of the system result in a steady
state error and residual vibration at the Ô¨Ånal time. Figure 6.37 represents the steady
state error of the Ô¨Årst mass with respect to variations in the spring constant and
Coulomb friction. It can be seen that the Ô¨Ånal displacement is more sensitive to
the friction variation compared to variations in the frequency. Robustness to the
frequency variation can be obtained with additional pulses which permits placing
additional zeros of the time-delay Ô¨Ålter at the estimated pole locations which corre-
spond to the vibratory modes. The friction variation can be handled by successive
application of the proposed control proÔ¨Åle until the desired position is reached. Sta-
40
60
80
100
120
140
‚àí500
0
500
1000
Upper bound
Lower bound
Infeasible
Natural Frequency (rad/sec)
Pulse Amplitudes (N)
A0
A0
A1
A0
A1
A2
Figure 6.36: Pulse Amplitudes vs. Natural Frequency
¬© 2010 by Taylor and Francis Group, LLC

Friction Control
305
bility of the iterative operation is guaranteed for bounded friction and spring constant
variations if the steady state error remains less than 100%. The performance of the
controller can be enhanced if the uncertain/varying parameters are adapted during
the iterative application of the input. Figure 6.38 shows the variation of the resid-
‚àí15
‚àí10
‚àí5
0
5
10
15
20
‚àí15
‚àí10
‚àí5
0
5
10
15
5
10
15
20
25
30
35
40
45
fc
Variation (%)
k Variation (%)
Steady State Error (%)
Figure 6.37: Steady-State Error with Friction and Spring Constant Variations
ual energy with respect to the variations in friction and spring constant. The total
residual energy includes the energy from the residual vibration of the second mass in
addition to the norm of the steady-state error of the Ô¨Årst mass. It can be seen that if
the friction coefÔ¨Åcient is overestimated, the residual energy increases at a rate greater
than when the friction coefÔ¨Åcient is underestimated.
6.3
Summary
This chapter focused on the development of open-loop controllers for systems with
friction. As in the previous chapters, the two systems considered to illustrate the con-
trollers are a rigid body system and the Ô¨Çoating oscillator benchmark problem which
includes one rigid body mode and one Ô¨Çexible mode. The Ô¨Årst problem considered
is the design of time-optimal control proÔ¨Åles. A simple technique which eliminates
the frictional nonlinearity by integrating the friction force into a linearizing control
proÔ¨Åle is proposed. The resulting control proÔ¨Åle is not bang-bang, but it drives a lin-
ear system permitting the formulation of a parameter optimization problem for the
rest-to-rest maneuver of a linear system.
¬© 2010 by Taylor and Francis Group, LLC

306
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
‚àí15
‚àí10
‚àí5
0
5
10
15
20
‚àí15
‚àí10
‚àí5
0
5
10
15
0.02
0.04
0.06
0.08
0.1
0.12
0.14
0.16
fc
Variation (%)
k Variation (%)
Total Residual Energy
Figure 6.38: Total Residual Energy with Friction and Spring Constant Varia-
tions
A pulse-width controller which is useful for small motions is also presented in
this chapter. A closed-form expression describing the relationship between the pulse
width and the displacement as a function of the coefÔ¨Åcient of friction is determined.
The effect of uncertainty on the stability of the repeated application of the pulse-
width controller is studied and bounds on the overestimation of the coefÔ¨Åcient of
friction is solved for which is useful for the analysis of the controlled system. To im-
prove the performance of the pulse-width controller, an estimator is included into the
control algorithm which results in reduction in the maneuver time compared to the
nonadaptive pulse-width controller. To account for constraints on the pulse width
which results from the sampling time, a pulse-width pulse-amplitude controller is
developed which in conjunction with the estimator results in improved performance.
The technique to design pulse-width pulse-amplitude controller for rigid-body sys-
tems is extended to control Ô¨Çexible structures subject to friction and is illustrated on
the benchmark Ô¨Çoating oscillator problem.
Exercises
6.1
Design a time-delay Ô¨Ålter for a second order system subject to Coulomb
friction:
¬®x
 0 1Àôx
 x
 0 1sgn
 Àôx   u
to move the system states where the initial and Ô¨Ånal states are:
x 0   0  Àôx 0  0  x t f
  1  Àôx
 t f
  0
¬© 2010 by Taylor and Francis Group, LLC

Friction Control
307
Hint: Since the velocity does not change sign for the posicast control, the
friction force acts as a bias.
6.2
Design a time-optimal control for a rigid body system subject to Coulomb
friction:
¬®x
 0 1Àôx
 0 1sgn
 Àôx   u
to move the system states where the initial and Ô¨Ånal states are:
x 0   0  Àôx 0 
 1  x t f
  1  Àôx
 t f
  0
The control input is constrained to:
 1
  u t
   1 Show that the time-optimal control is a single-switch bang-bang proÔ¨Åle with
a switch time of T = 2.2699 and a Ô¨Ånal time of t f = 3.2853.
6.3
A high-precision gantry robot is used for accurately riveting panels on wings
of an aircraft. The end effector is located on a cantilever resulting in vibratory
motion. The model for a single-axis gantry robot is:
¬®Œ∏
 0 1sgn   ÀôŒ∏
 0 5 ¬®œÜ
 u
0 5 ¬®Œ∏
 0 5 ¬®œÜ
 500œÜ
  0
Design a three-pulse pulse-amplitude control proÔ¨Åle to move the system
states from:
Œ∏
 0  0  ÀôŒ∏
0  0 œÜ
0  0  ÀôœÜ
0  0
to
Œ∏
 t f
  0 01  ÀôŒ∏
 t f
   0 œÜ
 t f
  0  ÀôœÜ
 t f
   0
Illustrate that the three-pulse proÔ¨Åle that maneuvers the system from the ini-
tial position of rest to the Ô¨Ånal position of rest is given by the proÔ¨Åle illustrated
in Figure 6.39.
6.4
For the undamped second-order frictional system given by the equation:
¬®x
 œâ2x
  fcsgn Àôx   u show that the application of a pulse of amplitude A applied for a time interval
of T1 will bring the velocity state to rest at a time
T2
   1
œâ
  œâT1
 arctan
sin œâT1
  A
  fc

Acos
 œâT1
  A
  fc cos
 œâT1
  and the corresponding displacement at time T2 is:
A
  fc
œâ2
 cos
 œâ
 T1
 T2
   1
 cos
 œâT1
   sin  œâ
 T1
 T2
  sin  œâT1
    fc
œâ2
 1
 cos
 œâ
 T1
 T2
   Determine the pulse proÔ¨Åle to move a system with a natural frequency œâ=1,
from the initial to the Ô¨Ånal states given by:
x 0  0  Àôx 0  0  x T2
   1  Àôx
 T2
   0 ¬© 2010 by Taylor and Francis Group, LLC

308
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
0
0.1
0 2
0.3
0.4
0.5
0.6
0.7
0
0.05
0.1
0.15
0.2
0.25
Time
Control
Figure 6.39: Three-Pulse Control ProÔ¨Åle
References
[1] K. Peng, G. Cheng, B.M. Chen, and T.H. Lee.
Improvement on a hard
disk drive servo system using friction and disturbance compensation. In Pro-
ceedings. 2003 IEEE/ASME International Conference on Advanced Intelligent
Mechatronics, 2003. AIM 2003., volume 2, pages 1160‚Äì1165, July 2003.
[2] K. Takaishi, T. Imamura, Y. Mizoshita, S. Hasegawa, T. Ueno, and T. Ya-
mada. Microactuator control for disk drive. IEEE Transactions on Magnetics.,
32(3):1863‚Äì1866, May 1996.
[3] J. R. Ryoo, K. B. Jin, T.-Y. Doh, and M. J. Chung. New Ô¨Åne seek control for
optical disk drives. In American Control Conference, 1999. Proceedings of the
1999, volume 5, pages 3635‚Äì3639, 1999.
[4] V. M. Hung and U. J. Na. Adaptive neural fuzzy control for robot manipulator
friction and disturbance compensator. In Control, Automation and Systems,
2008. ICCAS 2008. International Conference on, pages 2569‚Äì2574, October
2008.
[5] F. Bruni, F. Caccavale, C. Natale, and L. Villani. Experiments of impedance
control on an industrial robot manipulator with joint friction. In Control Ap-
plications, 1996., Proceedings of the 1996 IEEE International Conference on,
pages 205‚Äì210, September 1996.
[6] A. Piazzi and A. Visioli. Optimal dynamic-inversion-based control of an over-
head crane. 149(5):405‚Äì411, September 2002.
¬© 2010 by Taylor and Francis Group, LLC

Friction Control
309
[7] J.-J. Kim, R. Kased, and T. Singh. Time-optimal control of Ô¨Çexible systems
subject to friction. Optimal Control: Applications and Methods, 29(4):257‚Äì
277, 2008.
[8] Arthur E. Bryson and Yu-Chi Ho. Applied Optimal Control: Optimization,
Estimation and Control. Hemisphere Publishing, 1975.
[9] C. F. van Loan. Computing integrals involving the matrix exponential. IEEE
Trans. on Auto. Cont., (3):395‚Äì404, 1978.
[10] S. Yang and M. Tomizuka. Adaptive pulse width control for precise positioning
under the inÔ¨Çuence of stiction and Coulomb friction.
Journal of Dynamic
Systems, Measurements, and Control, 110:221‚Äì227, September 1988.
[11] S. Haykin. Adaptive Filter Theory. Prentice Hall, 2002.
[12] J. J. M. van de Wijdeven and T. Singh. Adaptive pulse amplitude pulse width
control of systems subject to Coulomb and viscous friction. In ACC, Denver,
CO, 2003.
[13] J-J. Kim and T. Singh. Controller design for Ô¨Çexible systems with friction:
Pulse amplitude control. ASME Journal of Dynamic Systems, Measurement
and Control, 127(3):336‚Äì344, September 2005.
[14] T. Singh and S. R. Vadali. Robust time delay control. ASME J. of Dyn. Systems,
Measurements, and Cont., 115(2):303‚Äì306, 1993.
[15] D. B. Rathbun. Pulse Modulation Control for Flexible Systems Under the
InÔ¨Çuence of Nonlinear Friction. PhD thesis, University at Washington, Seattle,
WA, 2001.
¬© 2010 by Taylor and Francis Group, LLC

7
Numerical Approach
The advancement and perfection of mathematics are intimately con-
nected with the prosperity of the State.
Napoleon (1769‚Äì1821); military and political leader of France
T
HIS chapter describes different techniques to solve for the parameters of input
shaper/time-delay Ô¨Ålters (IS/TDF) and saturating controllers. Except for a very
small class of systems, closed form solutions for IS/TDF and saturating controllers
cannot be derived. One has to therefore resort to numerical techniques to determine
the optimal control proÔ¨Åles. This chapter describes three techniques to determine the
IS/TDF and saturating controllers. The Ô¨Årst entails parameterizing the control proÔ¨Åle
and solving for the optimal parameters via a gradient based constrained optimization
algorithm. The second technique exploits the strengths of linear programming in
conjunction with a bisection algorithm to determine the optimal IS/TDF and sat-
urating control proÔ¨Åles. The third exploits semideÔ¨Ånite optimization techniques to
optimize a linear cost subject to linear matrix inequalities (LMI). All three techniques
are illustrated on simple examples. MATLAB program listing which encode the two
algorithms are also provided. This chapter deals with input shaper/time-delay Ô¨Ål-
ters, saturating controllers, minimax controllers that desensitize the control proÔ¨Åle to
modeling errors, and also presents results for benchmark examples.
7.1
Parameter Optimization
Input shapers/time-delay Ô¨Ålters can be parameterized in terms of delay times and
gains. For instance, the IS, or the nonrobust time-delay Ô¨Ålter can be represented as:
A1Œ¥
 t
 T1
  A2Œ¥
 t
 T2
 (Impulse Sequence)
(7.1)
A1e
 sT1
 A2e
 sT2
(Time-Delay Filter)
(7.2)
where A1, A2, T1, and T2 are the parameters to be determined. The constraints on
the parameters are that the impulse sequence force the residual energy of an under-
311
¬© 2010 by Taylor and Francis Group, LLC

312
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
damped harmonic oscillator
¬®x
 2Œ∂œâ Àôx
 œâ2x
  u  (7.3)
subject to the impulse sequence to be zero at time T2. The corresponding constraint
on the time-delay Ô¨Ålter is that a pair of zeros of the time-delay Ô¨Ålter cancel the poles
of the underdamped harmonic oscillator which are:
s
  Œ∂œâ
  jœâ
 1
 Œ∂ 2
 (7.4)
The residual energy of the system resulting from a sequence of impulses is
V
 œâ
 Œ∂
  e
 Œ∂œâTn
 C
œâ
 Œ∂
 2
 S
 œâ
 Œ∂
2
(7.5)
where
C
 œâ
 Œ∂
 
n
‚àë
i 1
AieŒ∂œâTicos œâ
 1
 Œ∂ 2Ti
 (7.6)
S
 œâ
 Œ∂
 
n
‚àë
i 1
AieŒ∂œâTi sin  œâ
 1
 Œ∂ 2Ti
 (7.7)
and n is the number of impulses. Assuming T1 = 0, for a two-impulse input shaper,
the zero residual energy and pole-cancelation constraints can both be reduced to:
A1
 A2eŒ∂œâT2cos œâ
 1
 Œ∂ 2T2
   0
(7.8a)
A2eŒ∂œâT2 sin  œâ
 1
 Œ∂ 2T2
   0
(7.8b)
Finally, the requirement that the steady-state output of the time-delay Ô¨Ålter be equal
to the reference input results in the constraint
A1
 A2
  1  (7.9)
This results in the solution
A1
 exp
 Œ∂œÄ
 1  Œ∂ 2
 1
 exp
 Œ∂œÄ
 1  Œ∂ 2
   A2
 1
1
 exp

Œ∂œÄ
 1  Œ∂ 2
   T2
 œÄ
œâ
 1
 Œ∂ 2
(7.10)
For systems with multiple modes, or with multi-inputs, closed-form solutions for
the IS/TDF cannot be derived. Numerical optimization is necessary in such situa-
tions. The IS/TDF with N delays can be represented as
N
‚àë
i 1
AiŒ¥
 t
 Ti
  (IS)
(7.11a)
N
‚àë
i 1
Aiexp   sTi
  (TDF)
(7.11b)
¬© 2010 by Taylor and Francis Group, LLC

Numerical Approach
313
with the constraints
N
‚àë
i 1
Ai
  1
(7.12)
and
N
‚àë
i 1
Aiexp   Œ∂jœâjTi
 cos  Tiœâj
 1
 Œ∂ 2
j
   0   j
 IS
 (7.13)
N
‚àë
i 1
Aiexp   Œ∂jœâjTi
 sin
 Tiœâj
 1
 Œ∂ 2
j
   0   j
 IS
 (7.14)
‚Ñú
 N
‚àë
i 1
Aiexp   sjTi
   0   sj
 TDF
 (7.15)
‚Ñë
 N
‚àë
i 1
Aiexp   sjTi
   0   sj
 TDF
 (7.16)
where j = 1  2     m, where m is the number of poles to be canceled. The optimization
problem to be solved is:
min J
  TN
(7.17a)
subject to
(7.17b)
‚Ñú
 N
‚àë
i 1
Aiexp   sjTi
   0   sj
  j
  1  2    m
(7.17c)
‚Ñë
 N
‚àë
i 1
Aiexp   sjTi
   0   sj
  j
  1  2    m
(7.17d)
N
‚àë
i 1
Ai
  1
(7.17e)
Ai
  0
(7.17f)
Ti
 Ti 1
  0
 i
  1  2     N
 1  (7.17g)
MATLAB Script 7.1 returns the cost and the gradient of the cost with respect to
the optimization variables. The inclusion of analytical gradients are optional. In
the absence of analytical gradients, MATLAB uses Ô¨Ånite difference to determine the
gradients.
MATLAB Program 7.1:
function
[ f , df ] = cost ( x , poles ) ;
nDelays = floor ( length ( x ) / 2 ) ;
¬© 2010 by Taylor and Francis Group, LLC

314
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
T = x ( 1 : nDelays ) ;
% Time Delays
A = x ( nDelays +1:end ) ;
% Delay Gains
f = T(end ) ;
df = zeros ( length ( x ) ) ;
df ( nDelays ) = 1;
MATLAB Script 7.2 returns the equality and inequality constraints.
MATLAB Program 7.2:
function
[ g , geq ] = co n st r a i n t s ( x , poles ) ;
nDelays = floor ( length ( x ) / 2 ) ;
T = [0 x ( 1 : nDelays ) ] ;
% Time Delays
A = x ( nDelays +1:end ) ;
% Delay Gains
% Check
i f
repeated poles have to be canceled
uniq poles = unique ( poles ) ;
for
indx = 1: length ( uniq poles ) ,
rpoles ( indx ) = length ( find ( poles==uniq poles ( indx ) ) ) ;
end ;
counter = 1;
for
ind = 1: length ( uniq poles ) ,
for
rindx = 1: rpoles ( ind ) ,
geq temp = 0;
for
Del ind = 1: length (T) ,
geq temp = geq temp + A( Del ind )
 exp(
 poles ( ind )
  . . .
T( Del ind ) )
  ( T( Del ind ) ÀÜ ( rindx
 1));
end ;
geq ( counter )= real ( geq temp ) ;
geq ( counter +1)=imag( geq temp ) ;
counter = counter +2;
end ;
end ;
geq ( counter ) = sum(A)
 1;
counter = 1;
for
ind = 1: length (T)
 1,
g ( counter ) = T( ind)
 T( ind +1);
counter= counter +1;
end ;
for
ind = 1: length (A) ,
g ( counter ) =
 A( ind ) ;
counter=counter +1;
end ;
An IS/TDF for a single mode is designed using the program described above. Con-
¬© 2010 by Taylor and Francis Group, LLC

Numerical Approach
315
sider a system with a pair of undamped poles at s =
 j. The following MATLAB
script is executed:
MATLAB Program 7.3:
x0 = [3 1 0 . 7 ] ;
poles = j ;
x = fmincon ( ‚Äô cost ‚Äô , x0 , [ ] , [ ] , [ ] , [ ] , [ ] , [ ] , ‚Äô co n st ra i n t s ‚Äô , [ ] , poles )
where x0 is the initial guess of the parameters to be optimized for. The vector x0
contains three terms corresponding to the parameters T, A1, and A2 of a single time-
delay Ô¨Ålter. The variable poles is the listing of the poles to be canceled. Only one
of the pair of complex conjugate poles need to be listed. The MATLAB function for
constrained minimization is ‚Äúfmincon.‚Äù The output of the optimizer is
x =
3.1416
0.5000
0.5000
which coincides with the solution given by Equations (2.14) and (2.17) which cor-
responds to the solution of the Posicast controller. If it is desired to desensitize the
IS/TDF to errors in estimated natural frequency, it has been shown that one needs to
place multiple zeros of the time-delay Ô¨Ålter at the estimated location of the poles to
be canceled. This will requires additional delays in the Ô¨Ålter transfer function. The
MATLAB script for this problem is:
MATLAB Program 7.4:
x0 = [3 6 0.3 0.7
0 . 4 ] ;
poles = [ j ; j ] ;
x = fmincon ( ‚Äô cost ‚Äô , x0 , [ ] , [ ] , [ ] , [ ] , [ ] , [ ] , ‚Äô co n st ra i n t s ‚Äô , [ ] , poles )
The output of the optimizer is
x =
3.1416
6.2832
0.2500
0.5000
0.2500
which is the same as the solution given by Equation (2.41) determined in Chapter 2.
This also corresponds to the ZVD input shaper by Singer and Seering [1].
Saturating controllers refer to control proÔ¨Åles where the control constraint is ac-
tive for all or part of the maneuver. Such control proÔ¨Åles correspond to time-optimal,
fuel-time optimal, fuel-constrained time-optimal control proÔ¨Åles besides others. Sat-
urating control proÔ¨Åles can be parameterized by switch times of the control pro-
Ô¨Åles. For instance, the time-optimal solution for rest-to-rest maneuver of a double
integrator is a single switch bang-bang control proÔ¨Åle. The control proÔ¨Åle is thus,
parameterized in terms of the switch time and the maneuver time.
¬© 2010 by Taylor and Francis Group, LLC

316
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
A saturating control proÔ¨Åle can be parameterized as
u  s  1
s
N
‚àë
i 1
Aiexp   sTi
 (7.18)
where each Ai belongs to the set
Ai
   2
 1 1 2
  (7.19)
The saturating control proÔ¨Åle can be represented as the output of a time-delay Ô¨Ålter
subject to a step input. The transfer function of the corresponding time-delay Ô¨Ålter
is:
Gc
 s 
N
‚àë
i 1
Aiexp   sTi
  (7.20)
Equation (7.18) in conjunction with Equation (7.19) can generate bang-bang and
bang-off-bang control proÔ¨Åles, if u  t
  is constrained to lie between ‚Äì1 and 1. The
constraints for parameter optimization problem for rest-to-rest maneuver can be de-
rived by requiring that a set of zeros of the time-delay Ô¨Ålter cancel the poles of the
system. This results in the equations:
‚Ñú
 N
‚àë
i 1
Aiexp   sjTi
   0
 sj
(7.21a)
‚Ñë
 N
‚àë
i 1
Aiexp   sjTi
   0
 sj
(7.21b)
If R repeated poles need to be canceled, the corresponding constraint equations are:
‚Ñú
 N
‚àë
i 1
 Ti
 k  1Aiexp   sjTi
   0
 sj
(7.22a)
‚Ñë
 N
‚àë
i 1
 Ti
 k  1Aiexp   sjTi
   0
 sj
(7.22b)
where k varies from 1 to R. The Ô¨Ånal constraint is derived from the system transfer
function
y  s u s  Gs (7.23)
so as to satisfy the rigid-body boundary condition. The constraint can be written as:
yf
  lim
s 0G s Gc
s  lim
s 0
 G s N
‚àë
i 1
Aiexp   sTi
   (7.24)
¬© 2010 by Taylor and Francis Group, LLC

Numerical Approach
317
Since the transfer function of the time-delay Ô¨Ålter Gc
 s  has zeros at location of the
poles of the system, the limit value is indeterminate. Repeatedly apply L
 H ÀÜopital
 s
rule until the limit is determinate. That is the Ô¨Ånal constraint for the parameter opti-
mization problem.
Example 7.1: Design a time-optimal controller for the rest-to-rest maneuver of the
benchmark problem:
¬®x1
 x1
 x2
  u
(7.25a)
¬®x2
 x1
 x2
  0
(7.25b)
where the boundary conditions are
x1
 0   x2
 0   Àôx1
 0   Àôx2
 0   0
(7.26a)
x1
 tf
   x2
 tf
  1   Àôx1
 tf
   Àôx2
 tf
  0
(7.26b)
Parameterizing the optimal control proÔ¨Åle as
u  s  1
s
 1
 2e
 sT1
 2e
 sT2
 2e
 sT3
 e
 sT4
  (7.27)
the transfer function of the system where the output is the displacement of the second
mass is
G s  x2
u
 1
s2
 s2
 2   (7.28)
Using Equation (7.24), we have
x2
  lim
s 0
1
s2
 s2
 2   1
 2e
 sT1
 2e
 sT2
 2e
 sT3
 e
 sT4
   0
0
 (7.29)
Using L
 H ÀÜopital
 s rule twice we have,
x2
  lim
s 0
1
12s2
 4
  2T2
1 e
 sT1
 2T2
2 e
 sT2
 2T2
3 e
 sT3
 T 2
4 e
 sT4
 (7.30)
which results in the constraint
 2T 2
1
 2T2
2
 2T2
3
 T 2
4
  4;
(7.31)
the parameter optimization problem can be stated as
min J
  T4
(7.32a)
subject to
(7.32b)
 1
 2e
 sT1
 2e
 sT2
 2e
 sT3
 e
 sT4
   0 for s
  0
(7.32c)
  2T1e
 sT1
 2T2e
 sT2
 2T3e
 sT3
 T4e
 sT4
   0 for s
  0
(7.32d)
‚Ñú
 1
 2e
 sT1
 2e
 sT2
 2e
 sT3
 e
 sT4
   0 for s
  j
 2
(7.32e)
¬© 2010 by Taylor and Francis Group, LLC

318
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
‚Ñë
 1
 2e
 sT1
 2e
 sT2
 2e
 sT3
 e
 sT4
   0 for s
  j
 2
(7.32f)
 2T2
1
 2T2
2
 2T2
3
 T 2
4
  4
(7.32g)
Ai
  0
(7.32h)
Ti
 Ti 1
  0
 i (7.32i)
The MATLAB code for Example 7.1 is:
MATLAB Program 7.5:
function
[ f ] = cst ( x ) ;
T1 = x ( 1 ) ; T2 = x ( 2 ) ; T3 = x ( 3 ) ; T4 = x ( 4 ) ;
f = x ( 4 ) ;
MATLAB Program 7.6:
function
[ g , geq ] = constr ( x ) ;
T1 = x ( 1 ) ; T2 = x ( 2 ) ; T3 = x ( 3 ) ; T4 = x ( 4 ) ;
s = j
 sqrt ( 2 ) ;
geq (1 ) =
 2 T1+2
 T2 2 T3+T4 ;
geq (2 ) =
real (1
 2
 exp(
 s
 T1)+2
 exp(
 s
 T2)
 2
 exp(
 s
 T3)+exp(
 s
 T4 ) ) ;
geq (3 ) =
imag(1
 2
 exp(
 s
 T1)+2
 exp(
 s
 T2)
 2
 exp(
 s
 T3)+exp(
 s
 T4 ) ) ;
geq (4 ) =
 2 T1ÀÜ2+2
 T2ÀÜ2
 2
 T3ÀÜ2+T4ÀÜ2
 4;
g (1 ) =
 T1 ; g (2 ) =
 (T2
 T1 ) ;
g (3 ) =
 (T3
 T2 ) ;
g (4 ) =
 (T4
 T3 ) ;
MATLAB Scripts 7.5 and 7.6 return the cost and the inequality and equality con-
straints respectively. The MATLAB function ‚Äúfmincon‚Äù is used to solve this con-
strained optimization problem.
7.1.1
Minimax Control
MATLAB provides a function ‚Äúfminimax‚Äù which solves a minimax optimization
problem. To illustrate this, consider the design of a minimax time-delay Ô¨Ålter for a
¬© 2010 by Taylor and Francis Group, LLC

Numerical Approach
319
single spring-mass-dashpot system
¬®y
 0  2Àôy
 ky
  ku
(7.33)
with uncertainty in the coefÔ¨Åcient of stiffness k. Consider the design of a two-time-
delay Ô¨Ålter whose transfer function is:
u  s r
s  A0
 A1exp  sT1
  A2exp  sT2
  (7.34)
To ensure that the steady state value of u  s  is the same as the reference input r
 s ,
we require
A0
 A1
 A2
  1  (7.35)
The minimax optimization problem can be stated as the determination of A0, A1, A2,
T1, and T2, parameters of the time-delay Ô¨Ålter so as to
min
Ti
 Ai max
k
1
2 Àôy2
  1
2k
 y
 1  2
(7.36)
evaluated at T2. The MATLAB script 7.7 lists the functions which returns a vari-
able ‚Äúf‚Äù which is 21 dimensional vector of the residual energies evaluated for the
uncertain stiffness ranging from 0.7 to 1.3.
MATLAB Program 7.7:
function
f = fmin ( x ) ;
T1 = x ( 1 ) ;
T2 = x ( 2 ) ;
A0 = x ( 3 ) ;
A1 = x ( 4 ) ;
A2 = x ( 5 ) ;
Avec = [ A0 A1 A2 ] ;
Tvec = [0 T1 T2 ] ;
kvec = linspace ( 0 . 7 , 1 . 3 , 2 1 ) ;
for
indk = 1: length ( kvec ) ;
k = kvec ( indk ) ;
A = [0 1;
 k
 0.2];
B = [ 0 ; k ] ;
P = [A B; zeros ( 1 , 3 ) ] ;
xftemp = zeros ( 2 , 1 ) ;
for
ind = 1: length ( Avec ) ,
Phi = expm(P
 ( Tvec (end)
 Tvec ( ind ) ) ) ;
xftemp = xftemp + Avec( ind )
  Phi ( 1 : 2 , 3 ) ;
end ;
¬© 2010 by Taylor and Francis Group, LLC

320
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
f ( indk ) = (0 .5
 ( xftemp (1)
 1)ÀÜ2
 k + 0.5
  xftemp ( 2 ) ÀÜ 2 ) ;
end ;
MATLAB Script 7.8 is the main script which calls the script 7.7 and saves the optimal
solution in the variable ‚Äúxopt.‚Äù
MATLAB Program 7.8:
x0 = [ pi 2
 pi 0.25 0.5
0 . 2 5 ] ;
Aeq = [0 0 1 1 1 ] ;
Beq =
[ 1 ] ;
options = optimset ( ‚Äô Display ‚Äô , ‚Äô i t e r ‚Äô ) ;
xopt = fminimax (@fun, x0 , [ ] , [ ] , Aeq , Beq , [ ] , [ ] , [ ] , options )
The output of the optimizer is:
xopt =
3.1688
6.3406
0.3450
0.4730
0.1820
which is illustrated in Figure 7.1 via the dashed line, where the maximum magnitude
of the residual energy corresponding to the minimax solution over the uncertain do-
main is signiÔ¨Åcantly smaller than that of the robust time-delay Ô¨Ålter which locates a
pair of zeros at the nominal location of the poles of the system.
0.7
0.8
0 9
1
1.1
1.2
1.3
1.4
0
0.005
0.01
0.015
0.02
0.025
0.03
Spring Coefficient
Residual Energy
Figure 7.1: Variation of Residual Energy
¬© 2010 by Taylor and Francis Group, LLC

Numerical Approach
321
7.1.2
Analytic Gradients
Gradient-based optimizers require exact values or estimates of the gradient of the
cost with respect to the parameters being optimized for to calculate the updates of
the parameters. Often optimization software determine the gradients using Ô¨Ånite
difference. However, if analytical gradients can be provided to the software, it will
expedite the convergence of the algorithm. In this section, the determination of the
analytic gradients for the control proÔ¨Åles which have been parameterized to generate
staircase proÔ¨Åles or bang-bang and bang-off-bang proÔ¨Åles is described.
Consider the cost function which corresponds to the residual energy of a system
at the end of the maneuver
J
 Tn
  1
2
 ÀôxTM Àôx
 xTKx
 (7.37)
where TN corresponds to the Ô¨Ånal time. Here we consider a linear mechanical system
whose equations of motion are given as
M ¬®x
 CÀôx
 Kx
  Du
(7.38)
where M, C, and K correspond to the mass, damping, and stiffness matrices, respec-
tively. The D matrix is the control-inÔ¨Çuence matrix. The second-order model can be
represented in state-space form as
Àôz
  Az
 Bu   z

 x
Àôx
  (7.39)
where
A
  0
I
 M
 1K
 M
 1C
   and B
  0
M
 1D
 (7.40)
For a staircase control proÔ¨Åle parameterized as
u
 N
‚àë
i 0
AiH
 t
 Ti
   with T0
  0  (7.41)
the parameters to be optimized for include Ai and Ti for i
  1 N
 . The gradients of
the cost with respect to Ai and Ti are
dJ
dAi
  ÀôxTM d Àôx
dAi
 xTK dx
dAi
     TN
(7.42)
dJ
dTi
  ÀôxT M d Àôx
dTi
 xTK dx
dTi
     TN
(7.43)
which require the state sensitivities at the Ô¨Ånal time. The sensitivity state equations
are
¬© 2010 by Taylor and Francis Group, LLC

322
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
dÀôz
dAi
  A dz
dAi
 BH
t
 Ti

(7.44)
dÀôz
dTi
  A dz
dTi
 BŒ¥
 t
 Ti

(7.45)
where Œ¥
    is the Dirac delta function. Equation (7.44) which describes the dynam-
ics of the sensitivity of the states with respect to the parameter Ai is essentially the
response of the system to a unit step input applied at time Ti. The van Loan iden-
tity can be used to determine the terminal time sensitivity state without numerical
integration.
The sensitivity of the states with respect to the parameters Ti can be derived easily
since Equation (7.45) which describes their dynamics is driven by an impulse input.
The solution of Equation (7.45) can be represented as
dz
dTi
    TN
0
eA  TN
 œÑ
 AiBŒ¥
 œÑ
 Ti
 dœÑ
(7.46)
which can be rewritten as
dz
dTi
  eA  TN
 Ti
 AiB
(7.47)
The derivatives dx
dTi and dx
dTi can be extracted from Equation (7.47).
The sensitivity of the states to the Ô¨Ånal time TN is a little more complicated since
it appears in the integrand and in the limit of Equation (7.49). The system response
to the staircase input (Equation (7.41))
Àôz
  Az
 B
N
‚àë
i 0
AiH
 t
 Ti
 (7.48)
for zero initial conditions evaluated at the Ô¨Ånal time (TN) is
z TN
 
  TN
0
eA  TN
 œÑ
 B
N
‚àë
i0
AiH
 œÑ
 Ti
 dœÑ
(7.49)
and the sensitivity with respect to the Ô¨Ånal time is
dz TN
 dTN

  TN
0
eA  TN
 œÑ
 AB
N
‚àë
i0
AiH
 œÑ
 Ti
 dœÑ
   TN
0
eA  TN
 œÑ
 ABANŒ¥
 œÑ
 TN
 dœÑ
 

BAN

N
‚àë
i0
BAiH
 TN
 Ti
 (7.50)
It can be seen that the addend corresponding to i
  N of the last term of Equa-
tion (7.50) cancels the second term on the right-hand side of Equation (7.50). The
¬© 2010 by Taylor and Francis Group, LLC

Numerical Approach
323
Ô¨Årst integral of Equation (7.50) can be calculated since the input is piecewise con-
stant.
  TN
0
eA  TN
 œÑ
 AB
N
‚àë
i0
AiH
 œÑ
 Ti
 dœÑ

N
‚àë
i 0
Ai
 eA  TN
 Ti
  I
 BH
 TN
 Ti
 
N
 1
‚àë
i 0
Ai
 eA  TN
 Ti
  I
 BH
 TN
 Ti
 (7.51)
since the contribution of addend corresponding to i
  N is zero. Equation (7.50) can
now be represented as
dz TN
 dTN

N
 1
‚àë
i 0
Ai
 eA  TN
 Ti
  I
 BH
 TN
 Ti
 
N
 1
‚àë
i 0
BAiH
 TN
 Ti
 
N
 1
‚àë
i 0
AieA  TN
 Ti
 BH
 TN
 Ti
 (7.52)
Since Equation (7.52) is evaluated at TN, the Heaviside function is equal to 1 for all
i. Comparing Equation (7.52) to Equation (7.47), we have the relationship
dz TN
 dTN

 N
 1
‚àë
i 0
dz TN
 dTi
(7.53)
which states that once the state sensitivities with respect to Ti have been determined
for i from 1 to N
 1, the sensitivity to the Ô¨Ånal time is given by the negative of the
sum of the sensitivities to the rest of the parameters Ti.
MATLAB optimization functions ‚Äúfmincon,‚Äù ‚Äúfminimax‚Äù are gradient-based opti-
mization algorithms and as with any gradient-based algorithms, these often converge
to local optima. The initial guess strongly inÔ¨Çuences whether the gradient-based
optimization algorithm converges to the global optima. Computationally expensive
Ô¨Åxes to the problem are available, e.g., Monte Carlo initial guesses, gridding initial
guesses, simulated annealing, and so forth. Posing a problem as a convex optimiza-
tion problem eliminate the problem of converging to a local optima. Linear program-
ming and semideÔ¨Ånite programming are two techniques which ensure convergenceto
a global optima. The next section presents a technique for the determination of opti-
mal control proÔ¨Åle using linear programming. This technique requires converting the
continuous-time problem to a discrete-time problem. As the sampling interval de-
creases, the solution of the discrete-time problem converges to the continuous-time
problem.
¬© 2010 by Taylor and Francis Group, LLC

324
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
7.2
Linear Programming
A linear program is a problem which can be represented in the form:
minimize
cTz
(7.54a)
subject to
Aeqz
  beq
(7.54b)
Az
  b
(7.54c)
where z is the vector of parameters to be solved for. The simplex method for linear
programming that has been called one of the top 10 algorithms of the millennium by
the IEEE Computer Society [2], is a powerful algorithm that has been used exten-
sively to solve a variety of problems. Leonid Vitalyevich Kantorovich (who earned
his doctorate at the age of 18) and George Dantzig are considered the fathers of linear
programming (LP). In 1939, Kantorovich posed an LP problem to solve a problem
dealing with manufacturing schedules. Dantzig proposed the simplex algorithm for
solving a linear programming problem when working on a research project for the
U.S. Air Force, which related to coordinating supplies for troops in World War II.
Kantorovich was jointly awarded the Nobel Prize in Economics in 1975 for his work
on optimal allocation of scarce resources.
Linear programming can be exploited in the design of controllers for linear sys-
tems. Consider the discrete-time state-space representation of a dynamical system
with a sampling time Ts:
x  k
 1    Gx k

Hu k
 where k
  1  2     N
(7.55)
where x is the state vector and u is the control input. The state response for the
control input u  k
  is
x  k
 1    Gkx1   k
‚àë
i 1
Gk  iHu  i (7.56)
where x 1   represents the initial state of the system. To solve control problems with
speciÔ¨Åed initial and Ô¨Ånal states, in addition to the Ô¨Ånal time (Tf ), the Ô¨Ånal state con-
straint can be represented as
x N
 1    GNx1   N
‚àë
i 1
GN
 iHu  i (7.57)
where the maneuver time Tf
  N
1  Ts, i.e., the maneuver time is discretized into
N intervals. Equation 7.57 can be rewritten in the standard equality constraint form:
¬© 2010 by Taylor and Francis Group, LLC

Numerical Approach
325
 GN
 1H
GN
 2H
   GH
H
  






u1
u2
   uN
 






  xN
 1
 GNx1
(7.58)
The limits on the control which are speciÔ¨Åed as
ulb
  u  k
   uub
(7.59)
where ulb and uub are the lower and upper bounds on the control, respectively, and
can be included in the problem formulation. Constraints on the states or combination
of states which have to be satisÔ¨Åed over the duration of the maneuver can be included
in the problem formulation. The state constraints can be represented as:
CGNx 1   N
 1
‚àë
i 1
CGN
 iHu  i   0
 i
  0 N
 (7.60)
where C is the output matrix. Note that while states and inputs can be speciÔ¨Åed, con-
strained or treated as unconstrained variables within the linear program formulation
(Equation 7.54), this is not the case with the maneuver terminal time. TN must be
speciÔ¨Åed. This limits how minimum time control is to be managed, as described in
the next section.
7.2.1
Minimum Time Control
Since the linear programming approach requires the maneuver time to be spec-
iÔ¨Åed, the determination of the time-optimal controller using this approach requires
that an initial estimate of the maneuver time be used to determine whether it supports
a feasible solution. If it does not, the candidate optimal maneuver time is increased,
else it is iteratively decreased till the maneuver time cannot be reduced without vio-
lating the constraints. A MATLAB-based Bisection algorithm (Program 7.9) is used
to Ô¨Ånd the lower bound for the feasible region of the maneuver time. This program
requires the name of a Ô¨Åle which returns the exitÔ¨Çag which indicates whether the
linprog command resulted in a feasible solution. This program requires a lower (XL)
and upper (XU) bound of the maneuver time. One can select 0 for the lower bound
and a large time for the upper bound if one has no idea of the maneuver time. The
bracketing interval is halved every iteration and after N iterations, the optimal is
guaranteed to lie in the interval XU
 XL
2N
. In other words for a desired error tolerance
of Œµ, the algorithm requires
N
  log2
 XU
 XL
Œµ
 (7.61)
iterations irrespective of the function considered. The complexity of each iteration
however, is determined by the function.
¬© 2010 by Taylor and Francis Group, LLC

326
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
The minimum time formulation can be used to solve for the time-optimal control
proÔ¨Åles for systems with rigid-body modes which results in a bang-bang proÔ¨Åle for
Normal systems. It can also be used for the determination of input shaped reference
proÔ¨Åles for systems without rigid-body modes.
First, we will consider the problem of design of pre-Ô¨Åltered reference proÔ¨Åle to
drive the system states to their Ô¨Ånal values in Ô¨Ånite time. Consider the undamped
second-order system
 Àôx
¬®x
    0
1
 œâ2 0
  x
Àôx
    0
œâ2

u
(7.62)
where the initial and Ô¨Ånal states of the system are:
 x
Àôx
  0  
 0
0


x
Àôx
  tf
 
 1
0
  (7.63)
To pose a linear programming problem, the continuous-time model is discretized
which results in the equation:
 Àôx
¬®x
  k
 1    cosœâT
 sin œâT
 œâ
 œâ sin  œâT
  cos œâT
   

G
x
Àôx
  k
 
  cos
 œâT
 1
œâ sin  œâT
   

H
u  k
  (7.64)
From Equation (7.63), the Ô¨Ånal value of the control input u  tf
  can be determined
which results in the constraint:
u  tf
  1  (7.65)
MATLAB Program 7.9: Bisection Algorithm
function
[ XL,XR] = b i se ct i o n ( fun , XL,XR)
% This program determines the lower bound of
the
f e a si b l e
region
% display
l i n e
f p r i n t f ( ‚Äô
 n
 n%s
  t%s
  t%s
 n ‚Äô , ‚Äô I t e r . ‚Äô , ‚Äô X L ‚Äô , ‚ÄôX U ‚Äô ) ;
% evaluate
f e a s i b i l i t y
at
lower ,
upper & mid
 point
of
va ri a b l e
Flag L = feval ( fun , XL ) ;
Flag U = feval ( fun ,XR) ;
Flag M = feval ( fun , ( XL+XR) / 2 ) ;
% r e f i n e
u n t i l
convergence
c r i t e r i a
i s
s a t i s f i e d :
e p s i l o n t = 1e
 3;
counter = 0;
max fun eval = 1e4 ;
while abs (XR
 XL)
  e p s i l o n t
¬© 2010 by Taylor and Francis Group, LLC

Numerical Approach
327
counter = counter + 1;
i f
counter
  max fun eval
disp ( ‚ÄôMaximum Number of
Function
Evaluations exceeded ! ‚Äô )
break
end
f p r i n t f ( [ ‚Äô %0.0 f
  t %0.2 f
  t %0.2 f
 n ‚Äô ] , counter , XL,XR) ;
i f
Flag M
  0
XL = (XL+XR) / 2 ;
Flag L = Flag M ;
Flag M = feval ( fun , ( XL+XR) / 2 ) ;
e l s e i f Flag M
  0
XR = (XL+XR) / 2 ;
Flag R = Flag M ;
Flag M = feval ( fun , ( XL+XR) / 2 ) ;
else
disp ( ‚Äô Linprog Reached Maximum Number of
I t e r a t i o n s ! ‚Äô )
end ;
end
Example 7.2:
Design a minimum time control proÔ¨Åle for the system
¬®x
 x
  u
(7.66)
to satisfy the boundary conditions
x 0    Àôx
  0   and x  tf
  1   Àôx  tf
  0  (7.67)
where u has to satisfy the constraint
0
  u
  1  (7.68)
The discrete time state-space representation of the simple harmonic oscillator
(Equation 7.66) is
 x
 k
 1  Àôx
 k
 1      cos
T
  sin
 T
  sin
 T
  cos
 T
   x k

Àôx  k
  
  cos
 T
 1
sin
 T
  u k
 (7.69)
where T is the sampling interval. The boundary conditions are
x1
   0
0
 and xN
 1
   1
0
  (7.70)
Since, the desired maneuver is a rest-to-rest maneuver, we require
xN
 1  i
  xN
 1
 i
  1  2  3     ‚àû
(7.71)
¬© 2010 by Taylor and Francis Group, LLC

328
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
Substituting Equation (7.71), with i
  1, in Equation (7.69), we have
 1
0
  
cos
 T
  sin
 T
  sin
 T
  cos
 T
   1
0

 
 cos
T
  1
sin
T
  u
(7.72)
or
 1
 cos
 T
  sin
 T
 sin
 T
 1
 cos
 T
   1
0

 
 cos
T
  1
sin
T
     cos
T
  1
sin
T
  u
(7.73)
which implies that the steady-state value of u is 1. This terminal equality constraint
has to be included in the linear programming problem.
MATLAB Program 7.10:
function
[ e x i t f l a g ] = example1 ( Tf ) ;
%
% Program to Solve
f o r
the
Input Shaped Control
P r o f i l e
f o r a
% Harmonic
O s c i l l a t o r
using Linear Programming
%
X0 =
[ 0 ; 0 ] ;
% I n i t a l
States
Xf =
[ 1 ; 0 ] ;
% Final
States
No samp = 101;
T = Tf / ( No samp
 1);
% Sampling Time
G = [ cos (T)
sin (T ) ;
 sin (T) cos (T ) ] ;
% T r a n si t i o n
Matrix
H = [
 cos (T)+1; sin (T ) ] ;
% Control
Influence
Matrix
f = zeros (No samp , 1 ) ;
% Cost
f u n ct i o n
c o e f f i c i e n t
% Equality
Constraint
c a l c u l a t i o n
Aeq1 =
[ ] ;
for
ind = 1 : (No samp )
Aeq1 = [GÀÜ ( ind
 1)
 H Aeq1 ] ;
end ;
beq1 = Xf
  GÀÜNo samp
 X0 ;
% Equality
co n st ra i n t
which requires
f i n a l
input
values be 1
Aeq2 = zeros (1 ,No samp ) ;
Aeq2(1 ,end) = 1;
beq2 = 1;
Aeq = [ Aeq1 ; Aeq2 ] ;
beq = [ beq1 ; beq2 ] ;
vlb = zeros (No samp , 1 ) ;
vub = 1
 ones (No samp , 1 ) ;
u0 = 0.5
  ones ( size ( f ) ) ;
% Minimum Time Input Shaper
¬© 2010 by Taylor and Francis Group, LLC

Numerical Approach
329
[ u , f va l , e x i t f l a g ] = l i n p ro g ( f , [ ] , [ ] , Aeq , beq , vlb , vub , u0 ) ;
i f
e x i t f l a g
  0
t = linspace(0 , Tf , No samp ) ;
C = eye ( 2 ) ; D =
[ 0 ; 0 ] ;
sys = ss (G,H,C,D, T ) ;
figure ( 1 )
[ ys , ts , xs ] = lsim ( sys , u ) ;
subplot(211) ,
stairs ( ts , ys ( : , 1 ) ) ;
xlabel ( ‚Äô Time ‚Äô ) ;
ylabel ( ‚Äô Displacement ‚Äô ) ;
subplot(212) ,
stairs ( ts , ys ( : , 2 ) ) ;
xlabel ( ‚Äô Time ‚Äô ) ;
ylabel ( ‚Äô Ve l o ci t y ‚Äô ) ;
figure ( 2 )
stairs ( t , u ) ;
xlabel ( ‚Äô Time ‚Äô ) ;
ylabel ( ‚Äô Ve l o ci t y ‚Äô ) ;
end ;
0
0.5
1
1.5
2
2.5
0
0.1
0.2
0.3
0.
0.5
0.6
0.7
0.8
0.9
1
Time (sec)
Velocity
(i) Control
0
0.5
1
1.5
2
2.5
0
0.2
0.
0.6
0.8
1
0
0.5
1
1.5
2
2.5
0
0.5
1
Time (sec)
Time (sec)
Velocity
Displacement
(ii) System Response
Figure 7.2: Linear Programming Solution
Figure 7.2 illustrates the input and the corresponding system response for a mini-
mum time cost function.
Solving the problem with the constraint that the rate of change of the control input
be greater than zero results in the classic input-shaper solution, as shown in Fig-
ure 7.3.
To account for uncertainties in the plant model, a linear programming problem is
formulated where additional constraints which are a function of the sensitivity of the
system states to these variables are included. Consider the spring-mass system
¬© 2010 by Taylor and Francis Group, LLC

330
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
0
0.5
1
1.5
2
2 5
3
3.5
0.
0.5
0.6
0.7
0.8
0.9
1
Time (sec)
Control
(i) Control
0
0.5
1
1.5
2
2.5
3
3 5
0
0.2
0.
0.6
0.8
1
0
0.5
1
1.5
2
2.5
3
3 5
‚àí0.1
0
0.1
0.2
0.3
0.
0.5
0.6
Time (sec)
Time (sec)
Velocity
Displacement
(ii) System Response
Figure 7.3: Linear Programming Solution
 Àôx
¬®x
    0
1
 œâ2 0
  x
Àôx
    0
œâ2

u
(7.74)
where the initial and Ô¨Ånal states of the system are:
 x
Àôx
  0  
 0
0


x
Àôx
  tf
 
 1
0
  (7.75)
The sensitivity of the system states to the natural frequency œâ are
  dx
dœâ
d ¬®x
dœâ
    0
1
 œâ2 0
   dx
dœâ
dx
dœâ
    0
2œâ
 x (7.76)
The boundary conditions can be derived from Equation (7.76) by forcing the rate of
change of the sensitivity states to zero, resulting in the boundary conditions:
  dx
dœâ
dx
dœâ
  0    0
0
  dx
dœâ
dx
dœâ
  tf
 
   2
œâ x tf
 0
  (7.77)
The augmented system model is
 





Àôx
¬®x
dx
dœâ
d ¬®x
dœâ
 





 



0
1
0
0
 œâ2 0
0
0
0
0
0
1
 2œâ 0
 œâ2 0
 









x
Àôx
dx
dœâ
dx
dœâ
 





 



0
œâ2
0
0
 

u
(7.78)
with the associated boundary conditions
 





x
Àôx
dx
dœâ
dx
dœâ
 





 0    


0
0
0
0







	



x
Àôx
dx
dœâ
dx
dœâ
 





 tf
 




1
0
  2
œâ
0
 


 (7.79)
¬© 2010 by Taylor and Francis Group, LLC

Numerical Approach
331
The continuous time model is converted to discrete time model and the optimal
input shaping control proÔ¨Åle is determined as above.
0
1
2
3
5
6
7
0.2
0.3
0.
0.5
0.6
0.7
0.8
0.9
1
Time (sec)
Velocity
(i) Control
0
1
2
3
5
6
7
0
0.2
0.
0.6
0.8
1
0
1
2
3
5
6
7
‚àí0.05
0
0.05
0.1
0.15
0.2
0.25
0.3
Time (sec)
Time (sec)
Velocity
Displacement
(ii) System Response
Figure 7.4: Linear Programming Solution
0
0.5
1
1.5
2
2.5
3
3 5
.5
5
0
0.1
0.2
0.3
0.
0.5
0.6
0.7
0.8
0.9
1
Time (sec)
Velocity
(i) Control
0
0.5
1
1.5
2
2.5
3
3.5
.5
5
0
0.2
0.
0.6
0.8
1
0
0.5
1
1.5
2
2.5
3
3.5
.5
5
‚àí0.
‚àí0.2
0
0.2
0.
0.6
Time (sec)
Time (sec)
Velocity
Displacement
(ii) System Response
Figure 7.5: Linear Programming Solution
Figure 7.4 illustrates the desensitized input proÔ¨Åle which can be seen to be iden-
tical to the ZVD input-shaped control or the output of the robust time-delay Ô¨Ålter.
Eliminating the constraint that the shaped control proÔ¨Åle cannot decrease, results in
the robust time-optimal control input as shown in Figure 7.5.
¬© 2010 by Taylor and Francis Group, LLC

332
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
7.2.2
Minimum Fuel Control
The minimum fuel cost function requires minimizing the cost function
J
   tf
0
 u  dt ‚àù
N
‚àë
i 1
 ui
 (7.80)
where the maneuver time tf is speciÔ¨Åed. The cost function is not in the form of the
standard linear programming problem (Equations 7.54a through 7.54c). The mini-
mum fuel optimal control problem can be reformulated by deÔ¨Åning auxiliary vari-
ables u
  and u
  where both these variable are greater than or equal to zero. The
terminal state constraint equation can be rewritten as
 GN
 1H
 GN
 1H
GN
 2H
 GN
 2H
   H
 H
  












u1  u1  u2  u2     uN
 uN
  












  xN
 1
 GNx1
(7.81)
The minimum fuel optimal control problem can now be stated as
min J
 N
‚àë
i 1
ui  ui  1
1
   1
1   












u1  u1  u2  u2     uN
 uN
  












(7.82a)
subject to
(7.82b)
 GN
 1H
 GN
 1H
   H
 H
  












u1  u1  u2  u2     uN
 uN
  












  xN
 1
 GNx1
(7.82c)
¬© 2010 by Taylor and Francis Group, LLC

Numerical Approach
333
0
  ui   1
 i
(7.82d)
0
  ui   1
 i
(7.82e)
MATLAB Program 7.11: Minimum Fuel Optimal Control
function
[ e x i t f l a g ] = example3 ( Tf ) ;
% Minimum Fuel Control
% Program to Solve
f o r
the
rest
 to
 re st
Control
P r o f i l e
f o r a
% 2
 Mass
 system ,
using Linear Programming
%
%
X0 =
[ 0 ; 0 ; 0 ; 0 ; ] ;
% I n i t i a l
States
Xf =
[ 1 ; 1 ; 0 ; 0 ] ;
% Final
States
M = [1
0;0
1 ] ; K = [1
 1;
 1 1 ] ; Ac = [ zeros ( 2 ) eye ( 2 ) ;
 inv (M)
 K
zeros ( 2 ) ] ;
Bc = [ zeros ( 2 , 1 ) ; inv (M)
  [ 1 ; 0 ] ] ; Cc = eye ( 4 ) ; Dc =
zeros ( 4 , 1 ) ;
sysc = ss (Ac , Bc , Cc, Dc ) ;
No samp = 101;
% Sampling Time
T = Tf / ( No samp
 1);
sysd = c2d ( sysc , T ) ;
[G,H,C,D] = ssdata ( sysd ) ;
H2 = [H
 H] ;
f = ones (2
 No samp , 1 ) ;
% Cost
f u n ct i o n
c o e f f i c i e n t
% Equality
Constraint
c a l c u l a t i o n
Aeq =
[ ] ;
for
ind = 1 : (No samp )
Aeq = [GÀÜ ( ind
 1)
 H2 Aeq ] ;
end ;
beq = Xf
  GÀÜNo samp
 X0 ;
vlb = 0
 ones ( size ( f ) ) ;
vub = 1
 ones ( size ( f ) ) ;
u0 = 0.5
  ones ( size ( f ) ) ;
% Minimum Fuel
Co n tro l l e r
[ u , f va l , e x i t f l a g ] = l i n p ro g ( f , [ ] , [ ] , Aeq , beq , vlb , vub , u0 ) ;
i f
e x i t f l a g
  0
u1 = u ( 1 : 2 : end ) ;
u2 = u ( 2 : 2 : end ) ;
usim = [ u1(:)
 u2 ( : ) ] ;
t = linspace(0 , Tf , No samp ) ;
figure ( 1 )
[ yy , t t , xx ] = lsim ( sysd , usim ) ;
subplot(211) ,
plot ( t t , xx ( : , 1 : 2 ) ) ;
xlabel ( ‚Äô Time ‚Äô ) ;
ylabel ( ‚Äô Displacement ‚Äô ) ;
¬© 2010 by Taylor and Francis Group, LLC

334
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
subplot(212) ,
stairs ( t , xx ( : , 3 : 4 ) ) ;
xlabel ( ‚Äô Time ‚Äô ) ;
ylabel ( ‚Äô Ve l o ci t y ‚Äô ) ;
figure ( 2 )
subplot(211) ,
stairs ( t , u1 ) ;
xlabel ( ‚Äô Time ‚Äô ) ;
ylabel ( ‚Äô Control
u + ‚Äô ) ;
subplot(212) ,
stairs ( t , u2 ) ;
xlabel ( ‚Äô Time ‚Äô ) ;
ylabel ( ‚Äô Control u
  ‚Äô ) ;
figure ( 3 )
plot ( t , usim )
xlabel ( ‚Äô Time ‚Äô ) ;
ylabel ( ‚Äô Control ‚Äô ) ;
end ;
The minimum fuel optimal control problem is solved for the undamped Ô¨Çoating
oscillator problem where the maneuver time is assumed to be 6 seconds. The LP
problem results in a six-switch optimal control proÔ¨Åle which is antisymmetric about
the mid-maneuver time.
0
1
2
3
4
5
6
‚àí0 2
0
0 2
0.4
0 6
0 8
1
Time
Control u+
0
1
2
3
4
5
6
‚àí0 2
0
0 2
0.4
0 6
0 8
1
Time
Control u‚àí
Figure 7.6: Resolved Control Input
Figure 7.6 illustrates the variation of the resolved control input u
  and u
 . It is
clear that the resolved control inputs lie between 0 and 1 and their structures corre-
¬© 2010 by Taylor and Francis Group, LLC

Numerical Approach
335
0
1
2
3
5
6
‚àí1
‚àí0.8
‚àí0.6
‚àí0.
‚àí0.2
0
0.2
0.
0.6
0.8
1
Time (sec)
Control
(i) Control
0
1
2
3
5
6
0
0.2
0.
0.6
0.8
1
0
1
2
3
5
6
0
0.1
0.2
0.3
0.
Time (sec)
Time (sec)
Velocity
Displacement
(ii) System Response
Figure 7.7: Linear Programming Solution
spond to the bang-off-bang structures.
Figure 7.7 illustrates the time-response of the system states and the minimum fuel
optimal-control input which is antisymmetric about the mid-maneuver time.
7.2.3
Fuel/Time Optimal Control
The fuel/time optimal control corresponds to a control proÔ¨Åle that minimizes the
cost function
J
   tf
0
 1
 Œ±
 u   dt
(7.83)
where Œ± is a weighting parameter which speciÔ¨Åes the relative importance of the fuel
consumed to the maneuver time. This cost function is not conducive to the formula-
tion of an LP problem unlike the minimum fuel optimal controller. A technique sim-
ilar to the approach used to solve the minimum-time control problem is proposed.
Figure 7.8 illustrates the variation of the cost (Equation 7.83) as a function of the
maneuver time for Œ± = 8 for the undamped Ô¨Çoating oscillator benchmark problem.
It is clear from Figure 7.8 that the variation of the weighted fuel/time cost is a
multi-modal function of the maneuver time. A single-dimension search strategy such
as the golden section algorithm can be used to solve for the maneuver time which
corresponds to the minimum of the weighted fuel/time cost function. It should be
noted that the global minimum should be bracketed to preclude the possibility of the
algorithm converging to a local minima.
MATLAB Program 7.12: Golden Section Algorithm
function
[ Xmin ,
fmin ] = golden1 ( fun , XL, XR,
t o l )
% This program determines the minimum of a f u n ct i o n by
% bracketing
the minimum
¬© 2010 by Taylor and Francis Group, LLC

336
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
4
6
8
10
12
14
16
12
14
16
18
20
22
24
26
28
30
tf
Cost
Figure 7.8: Cost Function Variation vs. Maneuver Time
% display
l i n e
f p r i n t f ( ‚Äô
 n
 n%s
  t%s
  t%s
 n ‚Äô , ‚Äô I t e r . ‚Äô , ‚Äô X L ‚Äô , ‚ÄôX R ‚Äô ) ;
C = (3
 sqrt ( 5 ) ) / 2 ; R = 1
 C;
X1 = XL + C
 (XR
 XL ) ; X2 = XL + R
 (XR
 XL ) ;
f1 = feval ( fun , X1 ) ;
f2 =
feval ( fun , X2 ) ;
counter = 1; while abs (XR
 XL)
  t o l
 (abs (X1)+abs (X2 ) ) ,
f p r i n t f ( [ ‚Äô %0.0 f
  t %0.2 f
  t %0.2 f
 n ‚Äô ] , counter , XL ,XR) ;
i f
f2
  f1 ,
XL = X1 ;
X1 = X2 ;
X2 = XL + C
 (XR
 X1 ) ;
f1 = f2 ;
f2 = feval ( fun , X2 ) ;
else
XU = X2 ;
X2 = X1 ;
X1 = X2 + C
 (XL
 X2 ) ;
f2 = f1 ;
f1 = feval ( fun , X1 ) ;
end
¬© 2010 by Taylor and Francis Group, LLC

Numerical Approach
337
counter = counter +1;
end
i f
f1
  f2 ,
Xmin = X1 ;
fmin = f1 ;
else
Xmin = X2 ;
fmin = f2 ;
end
0
0.5
1
1.5
2
2.5
3
3.5
.5
5
‚àí1
‚àí0.8
‚àí0.6
‚àí0.
‚àí0.2
0
0.2
0.
0.6
0.8
1
Time (sec)
Control
(i) Control
0
0.5
1
1 5
2
2.5
3
3.5
.5
5
0
0.2
0.
0.6
0.8
1
0
0.5
1
1 5
2
2.5
3
3.5
.5
5
0
0.1
0.2
0.3
0.
0.5
Time (sec)
Time (sec)
Velocity
Displacement
(ii) System Response
Figure 7.9: Linear Programming Solution
Figure 7.9 illustrates the two switch optimal control proÔ¨Åle and the corresponding
system response for a weighting parameter value of Œ± = 8. The solution is identical
to that presented by Singh [3] where a parameter optimization problem is solved
to arrive at the fuel/time optimal control proÔ¨Åles for an undamped two-mass spring
system.
7.2.4
Minimax Control
Design of input shaped controllers which are insensitive to modeling uncertainties
has been posed in the framework of a minimax problem by Singh [4]. The residual
energy of the system over the domain of uncertainty is calculated and the maximum
magnitude is minimized. Since the residual energy is a quadratic function, it is not
compatible with the constraints of an LP problem.
In this section, we describe how a minimax problem can be solved using the LP
framework. Consider the problem
¬© 2010 by Taylor and Francis Group, LLC

338
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
minimize
maximum
i 1  2     M cT
i z
 di
(7.84a)
subject to
Aeqz
  beq
(7.84b)
Az
  b
(7.84c)
where z is a vector to be solved for and M is the number of linear constraints. DeÔ¨Ån-
ing a variable f which is equal to the maximum of cT
i z
  di for all i, the minimax
problem can be stated as
minimize
f
(7.85a)
subject to
Aeqz
  beq
(7.85b)
Az
  b
(7.85c)
cT
i z
 di
  f
 i
  1  2     M
(7.85d)
This corresponds to an LP problem where the variables f and z are solved for.
A linear model of a structure with n degrees of freedom, can be represented as
M ¬®x
 CÀôx
 Kx
  Du
(7.86)
where M, C, and K are the mass, damping and stiffness matrices and D is the control
inÔ¨Çuence matrix which is a function of the location of the actuators. The residual
energy of this system is the sum of the kinetic and potential energy at the end of the
maneuver (tf ):
E
 tf
  1
2 ÀôxTM Àôx
  1
2xTKy
  1
2
  M Àôx
 T
  M Àôx    1
2
  Kx T
 Ky
(7.87)
which is a common metric to use in the design of robust controllers [4]. For systems
with rigid-body modes, a pseudo-potential energy terms has to be added to the kinetic
and potential energy terms to guarantee that E
 tf
  is positive deÔ¨Ånite. The resulting
cost function is
E
 tf
  1
2 ÀôxTM Àôx
  1
2xTKy
  1
2k
  yr
 yf
 2
(7.88)
where yr refers to the rigid-body mode and yf the corresponding desired Ô¨Ånal dis-
placement.
The residual energy corresponds to the
 2 norm and does not satisfy the constraints
for an LP problem formulation. In the following development, the
 1 and
 ‚àûmetrics
will be Ô¨Årst exploited to demonstrate the formulation of an LP problem for the design
of desensitized input proÔ¨Åles.
¬© 2010 by Taylor and Francis Group, LLC

Numerical Approach
339
7.2.4.1
 ‚àûOptimal Control
For a system with uncertain damping (C) and stiffness (K) matrices, deÔ¨Åne a met-
ric
f
  max
i
          M Àôxi
 tf
  Kixi
tf
          ‚àû
(7.89)
where Ci and Ki represent the ith embodiment of the uncertain damping and stiffness
matrices respectively. Weighting the displacement and the velocities with the matrix
square root of the stiffness and mass matrices respectively, result in equal contribu-
tion to the residual energy cost, by the individual displacement and velocity states. f
which corresponds to the
 ‚àûnorm can be rewritten as
f
  max
i
  Àôyi
1
   Àôyi
2
     
 Àôyi
n
   yi
1
   yi
2
     
 yi
n
   (7.90)
where
Àôyi
  



Àôyi
1
Àôyi
2...
Àôyi
n
 



  M Àôxi and yi
  



yi
1
yi
2...
yi
n
 



  Kixi
 (7.91)
Figure 7.10 illustrates the region whose boundaries correspond to the
 ‚àûnorm equal
to f, for the variables Xi in two and three dimensions. In two-dimensional space,
this space corresponds to a square and in three-dimensional space it corresponds to
a cube.
X1
X2
f
f
(i) 2-D Space
X1
X2
X3
f
f
f
(ii) 3-D Space
Figure 7.10: Volume Representing
 ‚àû= f
The state space representation of the system in continuous time is
¬© 2010 by Taylor and Francis Group, LLC

340
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
 Àôx
¬®x
   0
I
 M
 1K
 M
 1C
  x
Àôx
   0
M
 1Du
 (7.92)
or
ÀôX
  AX
 Bu
(7.93)
which can be rewritten in discrete time form as
X
 k
 1    GX
k

Hu k

(7.94)
which is the form which will be used in the LP formulation of the minimax optimiza-
tion problem. The terminal states are
X
 N
 
 xN
 Àôx  N
    yN
 
 KxN
 Àôy  N
 
 M Àôx  N
  (7.95)
where N is the index that corresponds to the Ô¨Ånal time in a discrete-time representa-
tion of the system states.
The minimax problem can be stated as
minimize
f
(7.96a)
subject to
(7.96b)
 f
  yi
1
 N
   f
 f
 yi
2
 N
   f
...
 f
  yi
n
 N
   f
f
  Àôyi
1
 N
   f
 f
 Àôyi
2
 N
   f
...
 f
  Àôyi
n
 N
   f
 i
 1  2     Z
(7.96c)
umin
  u  m   umax
 m
 1  2     N
 1
(7.96d)
where Z is the number of uncertain models over which the
 ‚àûnorm is minimized.
umin and umax correspond to the minimum and maximum permitted control.
Example 7.3: To illustrate the proposed approach, consider the system
¬®x
 0  2Àôx
 kx
  ku
(7.97)
where the spring-stiffness k is uncertain and lies in the range
0  7
  k
  1  3
(7.98)
The optimization problem is to design a control proÔ¨Åle that moves the system from
rest to a Ô¨Ånal position of rest while minimizing the maximum magnitude of the resid-
ual states over the range of uncertain ks. The boundary conditions are
¬© 2010 by Taylor and Francis Group, LLC

Numerical Approach
341
 x 0  Àôx  0   
 0
0

and
 x tf
 Àôx  tf
  
 1
0
  (7.99)
The cost function is
min
 f
  max
i
          xi
 tf
  1  Àôxi
 tf
          ‚àû

(7.100)
Constraint to guarantee a unidirectional change in the magnitude of the control pro-
Ô¨Åle is imposed. This constraint results in control proÔ¨Åle which have a staircase form.
The resulting LP problem is:
minimize
f
(7.101a)
subject to
  Àôx
 N
   f
(7.101b)
  Àôx
 N
   f
(7.101c)
  k
jx N

  f
(7.101d)
  k
jx N
   f
(7.101e)
 x
Àôx
  N
  GN
 1
 x
Àôx
  1   N
 1
‚àë
i 1
GN
 iHu  i (7.101f)
0
  u  m   1
 m
  1  2     N
  501
(7.101g)
u  m  u m
1    0
 m
  1  2     500
(7.101h)
The minimax solution generated by optimizing for the parameters of a transfer
function of a two-time-delay Ô¨Ålter using the gradient based approach presented in
the Chapter 5 results in the optimal input shaped control proÔ¨Åle
uminimax
  0  3452
 0  4730H
 t
 3  1703   0  1818H
 t
 6  3405   (7.102)
The maneuver time of 6.3405 seconds is used to solve the LP problem. Discretiz-
ing the uncertain domain of k into 21 models, the
 ‚àûnorm minimization problem
is solved and the resulting control proÔ¨Åle and the system response for the nom-
inal model which corresponds to a stiffness of k = 1, are shown in Figure 7.11.
Figure 7.12(i) illustrates the variation of residual energy of the
 ‚àû(   symbols) and
the minimax ( √Ü symbols) control proÔ¨Åles, respectively. It is clear that the minimax
solution has a smaller maximum magnitude of residual energy over the range of un-
certain k. It should be pointed out that the determination of the
 ‚àûcontrol proÔ¨Åle is
faster than the determination of the minimax control proÔ¨Åle.
Figure 7.12(ii) illustrates the absolute magnitude of the residual displacement and
velocity error for the 21 models spanning the entire uncertain space. The
  represent
the residual state errors for the system driven by the
 ‚àûcontrol proÔ¨Åle and the
√Ü
¬© 2010 by Taylor and Francis Group, LLC

342
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
0
1
2
3
5
6
7
0.3
0.
0.5
0.6
0.7
0.8
0.9
1
Time (sec)
Control
(i) Control
0
1
2
3
5
6
7
0
0.2
0.
0.6
0.8
1
0
1
2
3
5
6
7
0
0.05
0.1
0.15
0.2
.25
0.3
0.35
Time (sec)
Time (sec)
Velocity
Displacement
(ii) System Response
Figure 7.11: Linear Programming Solution
0.6
0.7
0.8
0 9
1
1.1
1 2
1.3
1.
0.002
0.00
0.006
0.008
0.01
0.012
0.01
0.016
0.018
 Residual Energy
Stiffness
(i) Residual Energy Sensitivity
0
0 005
0.01
0.015
0.02
0.025
0
0.002
0.00
0.006
0.008
0.01
0.012
0.01
0.016
0.018
Displacement (   Kx)
Velocity (   M Àôx  )
(ii) Residual State Distribution
Figure 7.12: Energy and Norm Plots
correspond to the residual state errors for the minimax controlled system. The dashed
line corresponds to the value of the
 ‚àûnorm minimized by the LP problem. It can be
seen that all the
  symbols lie within the square bounded by the dashed line.
Since the maneuver time is a user-selected variable, it is of interest to explore the
effect of variation of the maneuver time on the residual energy distribution and the
 ‚àû
norm. Three control proÔ¨Åles are derived for maneuver times of tf = 6.3405, 7.3405,
and 8.3405 seconds. Figure 7.13 illustrates the reduction in the maximum magnitude
of the residual energy over the range of uncertain k as a function of increasing ma-
neuver time. Since the input-shaped control proÔ¨Åle is not parameterized in terms of a
sequence of impulse sequences (input shaper) or the transfer function of a time-delay
Ô¨Ålter, the Ô¨Çexibility of the selection of the maneuver time in the LP formulation is
conducive to real-time implementation of the control proÔ¨Åles.
Figure 7.14 illustrates the reduction of the
 ‚àûnorm as the maneuver time increases.
It can be seen that as the maneuver time varies, the components of the residual energy
of the number of uncertain plants that lie on the
 ‚àûboundary varies between two and
¬© 2010 by Taylor and Francis Group, LLC

Numerical Approach
343
0.7
0.8
0.9
1
1.1
1.2
1.3
1.4
0.002
0.004
0.006
0.008
0 01
0.012
0.014
0.016
0.018
Stiffness
Square Root of Residual Energy
tf = 6.3405
tf = 7.3405
tf = 8.3405
Figure 7.13: Residual Energy
0
0.002
0 004
0 006
0.008
0.01
0.012
0.014
0.016
0.018
0
0.002
0.004
0.006
0.008
0 01
0.012
0.014
0.016
0.018
tf = 6.3405
tf = 7.3405
tf = 8.3405
Displacement (   Kx)
Velocity (   M Àôx
 )
Figure 7.14: Residual State Distribution
three.
Figure 7.15 illustrates the variation of the control proÔ¨Åles as a function of the
maneuver time. It can be seen for the selected maneuver times that all three control
proÔ¨Åles can be parameterized by time delays.
¬© 2010 by Taylor and Francis Group, LLC

344
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
0
1
2
3
4
5
6
7
0.2
0.4
0.6
0.8
1
0
1
2
3
4
5
6
7
8
0.2
0.4
0.6
0.8
1
0
1
2
3
4
5
6
7
8
9
0.2
0.4
0.6
0.8
1
Time (sec)
Control
Control
Control
Figure 7.15: Spectrum of Control ProÔ¨Åles
Since it is clear that the insensitivity of the control proÔ¨Åle to errors in estimated
spring stiffness decreases with maneuver time, the proposed approach provides a
technique to trade-off robustness for reduced maneuver time. Figure 7.16 illustrates
the variation of the
 ‚àûnorm which bounds the absolute magnitude of the residual
tracking error of all the uncertain models, as a function of the maneuver time. It can
be seen that there is a rapid reduction of the
 ‚àûnorm until a maneuver time of about
9.5 seconds. A further increase in maneuver time does not signiÔ¨Åcantly reduce the
 ‚àûnorm. This curve can be used by the control designer to trade-off maneuver time
for robustness.
Example 7.4: To illustrate the
 ‚àûrobust optimization technique on system with a
rigid-body mode, consider the the benchmark Ô¨Çoating oscillator system
 1 0
0 1
 ¬®x1
¬®x2
    k
 k
 k k
  x1
x2
   1
0

u
(7.103)
where the spring stiffness k is uncertain and lies in the range
0  7
  k
  1  3
(7.104)
The state and control matrices of the discrete time model for a sampling time of T
¬© 2010 by Taylor and Francis Group, LLC

Numerical Approach
345
6
7
8
9
10
11
12
13
14
15
0
0.002
0.004
0.006
0.008
0.01
0.012
0.014
0.016
0.018
 ‚àûNorm
Maneuver Time (sec)
Figure 7.16: Norm Variation vs. Maneuver Time
are
G
  






 1  cos

 2kT
  2
 1  cos
  2kT
  2
T
2
  2
4
 k sin   2kT
  T
2
  2
4
 k sin   2kT
  1  cos
  2kT
  2
 1  cos

 2kT
  2
T
2
  2
4
 k sin   2kT
  T
2
  2
4
 k sin   2kT
   k
2 sin   2kT
  k
2 sin   2kT
  1  cos

 2kT
  2
 1  cos
  2kT
  2
 k
2 sin   2kT
   k
2 sin   2kT
  1  cos
  2kT
  2
 1  cos

 2kT
  2
 






(7.105)
H
  






kt2
 cos
  2
 kt
  1
4k
cos
  2
 kt
  1  kt2
4k
2t
 k   2sin
  2
 kt
 4
 k
  2sin
  2
 kt
  2t
 k
4
 k
 






(7.106)
The optimization problem is to design a control proÔ¨Åle that moves the system from
rest to a Ô¨Ånal position of rest while minimizing the maximum magnitude of the resid-
ual states over the range of uncertain ks. The boundary conditions are
 


x1
 0  x2
 0  Àôx1
 0  Àôx2
 0   







0
0
0
0
 

 and




x1
 tf
 x2
 tf
 Àôx1
 tf
 Àôx2
 tf
  







1
1
0
0
 


 (7.107)
The cost function is
¬© 2010 by Taylor and Francis Group, LLC

346
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
min
 

f
  max
i
                 


 xi
1
 tf
  1   xi
2
 tf
  1  Àôxi
1
 tf
 Àôxi
2
 tf
  


















‚àû




(7.108)
Since the stiffness matrix is singular, the system states cannot be weighted by the
square root of the stiffness matrices. To account for this, a pseudo-spring stiffness
of 1 is attached to the Ô¨Årst mass so as to have 0 potential energy at the Ô¨Ånal position.
The resulting LP problem is:
minimize
f
(7.109a)
subject to
  Àôx1
 N
   f
(7.109b)
  Àôx1
 N
   f
(7.109c)
  Àôx2
 N
   f
(7.109d)
  Àôx2
 N
   f
(7.109e)
  1
 2
  ki
 k
 0
 ki
 ki
 k
  ki
  ki
2
ki
 k
   x1
x2
  N
    f
f

(7.109f)
  1
 2
  ki
 k
 0
 ki
 ki
 k
  ki
  ki
2
ki
 k
   x1
x2
  N
    f
f

(7.109g)
 1
  u  m   1
 m
  1  2     501
(7.109h)
 





x1
x2
Àôx1
Àôx2
 





 N
   GN
 1
 





x1
x2
Àôx1
Àôx2
 





 1  
N
 1
‚àë
i 1
GN
 iHu  i (7.109i)
where the Cholesky decomposition of the stiffness matrix is used to weigh the dis-
placement states. k
  corresponds to the stiffness of the pseudo-spring whose potential
energy is zero when the Ô¨Årst mass is at the desired Ô¨Ånal state and is selected to be 1
for the following results.
Figure 7.17 illustrates the control proÔ¨Åle and the corresponding evolution of the
system states. The solid line represents the states of the mass to which the control
is applied and the dashed line represent the states of the noncollocated mass. The
control proÔ¨Åle for the
 ‚àûminimax controller is a Ô¨Åve-switch bang-bang proÔ¨Åle which
has a structure identical to that designed to minimize the
 2 norm. The maneuver
time is selected to be 5.866, which is the maneuver time of the
 2 minimax optimal
controller.
Figure 7.18 illustrates the sensitivity of the residual energy as a function of varying
spring stiffness and the residual error states of the two mass for the entire set of
uncertain plants which are shown to lie in a box whose
 ‚àûnorm is 0.03285.
¬© 2010 by Taylor and Francis Group, LLC

Numerical Approach
347
0
1
2
3
5
6
‚àí1
‚àí0.8
‚àí0.6
‚àí0.
‚àí0.2
0
0.2
0.
0.6
0.8
1
Time (sec)
Control
(i) Control
0
1
2
3
5
6
0
0.2
0.
0.6
0.8
1
1.2
1.
0
1
2
3
5
6
‚àí1
‚àí0.5
0
0.5
1
Time (sec)
Time (sec)
Velocity
Displacement
(ii) System Response
Figure 7.17: Linear Programming Solution
0.6
0.7
0.8
0.9
1
1.1
1.2
1 3
1.
0
0.005
0.01
0.015
0.02
0.025
0.03
0.035
0.0
0.0 5
0.05
 Residual Energy
Stiffness
(i) Residual Energy Sensitivity
0
0.005
0 01
0 015
0.02
0.025
0.03
0.035
0
0.005
0.01
0.015
0.02
0.025
0.03
0.035
Displacement (   Kx)
Velocity (   M Àôx  )
(ii) Residual State Distribution
Figure 7.18: Energy and Norm Plots
7.2.4.2
 1 Optimal Control
Figure 7.19 illustrates the region whose boundaries corresponds to the
 1 norm
equal to f. For the two dimension case, the polygon is a cube rotated 45 degrees.
For the three-dimension case, the octahedron surfaces correspond to the
 1 norm
being a constant.
This section will focus on the design of control proÔ¨Åles which minimize the
 1
norm of the residual states over the span of uncertain models. To illustrate the for-
mulation of the necessary constraints, the two- and three-dimensional examples will
be exploited. Consider a system with two states X1 and X2 as shown in Figure 7.19(i),
the equations which constrain the
 1 norm to be less than f are:
X1
 X2
  f
(7.110)
X1
 X2
  f
(7.111)
¬© 2010 by Taylor and Francis Group, LLC

348
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
X1
X2
f
f
(i) 2-D Space
X1
X2
X3
f
f
f
(ii) 3-D Space
Figure 7.19: Surfaces Representing
 1 = f
 X1
 X2
  f
(7.112)
 X1
 X2
  f
(7.113)
For a system with three states X1, X2, and X3, as shown in Figure 7.19(ii), the corre-
sponding constraints are
X1
 X2
 X3
  f
(7.114)
X1
 X2
 X3
  f
(7.115)
X1
 X2
 X3
  f
(7.116)
X1
 X2
 X3
  f
(7.117)
 X1
 X2
 X3
  f
(7.118)
 X1
 X2
 X3
  f
(7.119)
 X1
 X2
 X3
  f
(7.120)
 X1
 X2
 X3
  f
(7.121)
It can be seen from the Equations (7.110) through (7.113) and (7.114) through (7.121),
that the coefÔ¨Åcients of the linear equations correspond to the vertices of a square and
cube, respectively, of edge length equal to
 2, centered at the origin. For exam-
ples, the vertices of a square centered at the origin with edge length
 2 are
 1  1  ,
 1  1 ,
 1  1 , and
 1  1  which are also the coefÔ¨Åcients of the linear con-
straint equations. Thus, the constraint equations for a system of order n can be de-
rived by determining the vertices of a n dimensional hypercube of edge length
 2,
and centered at the origin.
The minimax problem to design control proÔ¨Åles which minimize the
 1 norm of
the residual states over the domain of uncertain models can be stated in an LP form
as:
¬© 2010 by Taylor and Francis Group, LLC

Numerical Approach
349
minimize
f
(7.122a)
subject to
 n
‚àë
k  1
Ck jyi
k
 N
   f
 i 1  2     Z
j
 1  2     2n
(7.122b)
where Ck j
  1
umin
  u  m   umax
 m
 1  2     N
(7.122c)
where n is the order of the dynamical system, N is the number of samples over which
the control is parameterized and Z is the number of uncertain models over which the
the
 1 norm is minimized. The coefÔ¨Åcients Ck j
  1 correspond to the vertices of
an n-dimensional hypercube centered at the origin and side length of
 2.
Example 7.5:
A spring-mass-dashpot system with an uncertain spring stiffness modeled as
¬®x
 0  2Àôx
 kx
  ku
(7.123)
with the uncertain stiffness given by Equation (7.104) as in Example 7.3. The
 1
optimal-control problem is given as:
minimize
f
(7.124a)
subject to
  Àôx
  k
ix
  f
(7.124b)
  Àôx
  k
ix
  f
(7.124c)
  Àôx
  k
ix
  f
(7.124d)
  Àôx
  k
ix
  f
(7.124e)
0
  u  m   1
 m
  1  2     501
(7.124f)
u  m  u m
1    0
 m
  1  2     500
(7.124g)
where i
  1  2     21 correspond to the 21 discrete values of k over the range of 0.7‚Äì
1.3. The
 1 optimal control proÔ¨Åle and the corresponding evolution of the system
states is shown in Figure 7.20 for a maneuver time of tf = 6.3405.
Figure 7.20(i) illustrates the sensitivity curve for the
 1 (  ) and minimax (√Ü) opti-
mal control proÔ¨Åles. It is clear that the sensitivity curve corresponding to the mini-
max solution has a smaller maximum magnitude of the residual energy compared to
the
 1 solution. Figure 7.20(i) displays the absolute values of the residual error of the
system states for the 21 uncertain models used in the design of the robust controller.
¬© 2010 by Taylor and Francis Group, LLC

350
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
0
1
2
3
5
6
7
0.35
0.
0. 5
0.5
0.55
0.6
0.65
0.7
0.75
0.8
0.85
Time (sec)
Control
(i) Control
0
1
2
3
5
6
7
0
0.2
0.
0.6
0.8
1
0
1
2
3
5
6
7
‚àí0.1
0
0.1
0.2
0.3
0.
Time (sec)
Time (sec)
Velocity
Displacement
(ii) System Response
Figure 7.20: Linear Programming Solution
0 6
0 7
0.8
0.9
1
1.1
1.2
1.3
1.
2
6
8
10
12
1
16
x 10
‚àí3
 Residual Energy
Stiffness
(i) Residual Energy Sensitivity
0
0.005
0.01
0.015
0.02
0.025
0
0.005
0.01
0.015
0.02
0.025
Displacement (   Kx)
Velocity (   M Àôx  )
(ii) Residual State Distribution
Figure 7.21: Energy and Norm Plots
The
  symbols which represent the
 1 solution are bounded by the dashed line which
corresponds to the
 1 norm of 0.0229.
Since the LP approach to solving the minimax
 1 problem requires the maneuver
time to be speciÔ¨Åed, the effect of the maneuver time on the robustness can be stud-
ied. Figure 7.22 illustrates the sensitivity curves for maneuver times of tf = 6.3405,
7.3405, and 8.3405 seconds. As was evident in Example 7.3, an increase in the
maneuver time results in increased robustness of the controllers.
As in Example 7.3, the variation of the
 1 norm as a function of the maneuver
time is plotted in Figure 7.25. The
 ‚àûis plotted as well and it can be seen that the
trends are identical and the knee of both curves occur around a maneuver time of 9.5
seconds.
Example 7.6: To compare the minimax solution of the
 ‚àûand the
 1 cost function
for systems with rigid-body modes, the two-mass spring benchmark problem is stud-
¬© 2010 by Taylor and Francis Group, LLC

Numerical Approach
351
0.6
0.7
0.8
0.9
1
1.1
1.2
1.3
1.4
2
4
6
8
10
12
14
16
x 10
‚àí3
S iffness
Square Root of Residual Energy
Figure 7.22: Residual Energy
ied. The cost function is to minimize the maximum
 1 norm of the residual states for
a set of plants spanning the uncertain space. DeÔ¨Åning a state transformation:
 





y1
y2
Àôy1
Àôy2
 





 N
   1
 2
 



 ki
 k
 0
0 0
 ki
 ki
 k
  ki
  ki
2
ki
 k
  0 0
0
0
1 0
0
0
0 1
 










x1
x2
Àôx1
Àôx2
 





 N
  (7.125)
where k
  is the stiffness of a pseudo-spring to guarantee a positive deÔ¨Ånite potential
energy function about the equilibrium states. An LP problem is formulated:
minimize
f
(7.126a)
subject to
  f
  y1
 N
 y2
 N
  Àôy1
 N
  Àôy2
 N
   f
(7.126b)
  f
  y1
 N
 y2
 N
  Àôy1
 N
  Àôy2
 N
   f
(7.126c)
  f
  y1
 N
  y2
 N
  Àôy1
 N
  Àôy2
 N
   f
(7.126d)
  f
  y1
 N
  y2
 N
   Àôy1
 N
  Àôy2
 N
   f
(7.126e)
  f
  y1
 N
  y2
 N
  Àôy1
 N
  Àôy2
 N
   f
(7.126f)
  f
  y1
 N
  y2
 N
   Àôy1
 N
  Àôy2
 N
   f
(7.126g)
  f
  y1
 N
 y2
 N
   Àôy1
 N
  Àôy2
 N
   f
(7.126h)
¬© 2010 by Taylor and Francis Group, LLC

352
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
0
0.005
0.01
0.015
0 02
0
0.005
0.01
0.015
0.02
tf = 8.3405
tf = 7.3405
tf = 6.3405
Displacement (   Kx)
Velocity (   M Àôx
 )
Figure 7.23: Residual State Distribution
  f
  y1
 N
 y2
 N
  Àôy1
 N
   Àôy2
 N
   f
(7.126i)
 1
  u  m   1
 m
  1  2     1001
(7.126j)
 





x1
x2
Àôx1
Àôx2
 





 N
   GN
 1
 





x1
x2
Àôx1
Àôx2
 





 1  
N
 1
‚àë
i 1
GN
 iHu  i (7.126k)
Discretizing the maneuver time into 1000 intervals, the LP problem is solved. Fig-
ure 7.26 illustrates the
 1 minimax control proÔ¨Åle and the evolution of the nominal
system states.
The solid line represents the states of the mass to which the control is applied and
the dashed line represents the states of the noncollocated mass. The control proÔ¨Åle
for the
 1 minimax controller is a Ô¨Åve-switch bang-bang proÔ¨Åle which has a structure
that is identical to that designed to minimize the
 2 norm. The maneuver time is se-
lected to be 5.9093 which is the maneuver time of the
 2 minimax optimal controller.
Figure 7.27 illustrates the sensitivity plot of the
 1 and the
 2 minimax controllers.
The
 2 minimax controller is derived using a nonlinear programming approach and
its sensitivity is illustrated by the line with the
√Ü marks. It can be seen that the
 2 min-
imax solution has a performance which is marginally better than that of the
 1 con-
¬© 2010 by Taylor and Francis Group, LLC

Numerical Approach
353
0
1
2
3
4
5
6
7
0.2
0.4
0.6
0.8
1
Control
0
1
2
3
4
5
6
7
8
0.2
0.4
0.6
0.8
1
Control
0
1
2
3
4
5
6
7
8
9
0.2
0.4
0.6
0.8
1
Time (sec)
Control
Figure 7.24: Spectrum of Control ProÔ¨Åles
6
7
8
9
10
11
12
13
14
15
0
0.005
0.01
0.015
0.02
0.025
Norm
 1
 ‚àû
Maneuver Time (sec)
Figure 7.25: Norm Variation vs. Maneuver Time
troller. The absolute magnitude of the residual displacement states are plotted against
the residual velocity states for both the
 1 (  ) and
 2 ( √Ü) solutions. The dashed line
corresponds to the optimal constant
 1 norm proÔ¨Åle determined from the optimiza-
tion problem to be 0.0859. It appears intriguing that none of the
 symbols lie on the
dashed line. This is because, we are attempting to represent a four-dimensional (4D)
¬© 2010 by Taylor and Francis Group, LLC

354
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
0
1
2
3
5
6
‚àí1
‚àí0.8
‚àí0.6
‚àí0.
‚àí0.2
0
0.2
0.
0.6
0.8
1
Time (sec)
Control
(i) Control
0
1
2
3
5
6
0
0.2
0.
0.6
0.8
1
1.2
1.
0
1
2
3
5
6
‚àí1
‚àí0.5
0
0.5
1
Time (sec)
Time (sec)
Velocity
Displacement
(ii) System Response
Figure 7.26: Linear Programming Solution
0 6
0.7
0.8
0.9
1
1.1
1.2
1.3
1.
0.005
0.01
0.015
0.02
0.025
0.03
0.035
0.0
0.0 5
0.05
 Residual Energy
Stiffness
(i) Residual Energy Sensitivity
0
0.01
0.02
0.03
0.0
0.05
0.06
0.07
0.08
0.09
0
0.01
0.02
0.03
0.0
0.05
0.06
0.07
0.08
0.09
Displacement (   Kx)
Velocity (   M Àôx  )
(ii) Residual State Distribution
Figure 7.27: Energy and Norm Plots
hyper-octahedron with a quadrant. Figure 7.28 illustrates all possible combinations
of the absolute magnitude of the system states and it can be seen that some
  symbols
lie on the constant
 1 norm lines. This set of graphs does not comprehensively cap-
ture the entire 4D hyper-octahedron, rather it looks at slices of the hyper-octahedron.
It can be seen that all the
√Ü symbols lie within the region bounded by the dashed lines
indicating that the maximum magnitude of residual state errors for the
 1 minimax
solution is greater than that of the
 2 minimax solution.
¬© 2010 by Taylor and Francis Group, LLC

Numerical Approach
355
0
0.02
0.04
0.06
0.08
0.1
0
0 05
0.1
0
0.02
0 04
0.06
0.08
0.1
0
0.05
0.1
0
0.02
0.04
0.06
0.08
0.1
0
0 05
0.1
0
0.02
0 04
0.06
0.08
0.1
0
0.05
0.1
0
0.02
0.04
0.06
0.08
0.1
0
0 05
0.1
0
0.02
0 04
0.06
0.08
0.1
0
0.05
0.1
 x1
  Àôx1
  x2
  Àôx2
  x1
  Àôx2
  x2
  Àôx1
  x1
  x2
  Àôx1
  Àôx2
 Figure 7.28: Residual State Distribution
7.2.4.3
 2 Optimal Control
In this section, an approach to use linear programming to solve the minimax prob-
lem that minimizes the residual energy of the system which is a
 2 norm is presented.
This involves approximating the n-dimensional hypersphere with (n‚Äì1)-dimensional
hyperplanes (simplex). A simplex is the convex hull of n
 1 points in n dimensional
space where the points do not all lie in some n
  1 dimensional subspace. For the
single dimension, the simplex is a line, for two dimension, it is a triangle, for the
third dimension it is a tetrahedeon, in the fourth dimension it is a pentatope, and so
on. Barycentric coordinates [5] which are also referred to homogeneous coordinates
or trilinear coordinates use n
 1 points to locate a point in n space relative to some
n dimensional simplex. Barycentric coordinates sum to unity. By requiring all the
coordinates to be positive constraints the points to lie in the simplex.
Figure 7.29 illustrates the approximation of an unit circle with lines and Fig-
ure 7.30 illustrates a unit sphere with multiple planes. Considering the three se-
quential approximation of the circle and sphere with lines and planes as Level 1, 2,
and 3, it is clear from Level 3, that the approximation of the
 2 norm by planes is
quite good.
An afÔ¨Åne combination of a set of points P1, P2, P3, ..., Pn is the point:
w1P1
 w2P2
 w3P3
    wnPn
(7.127)
¬© 2010 by Taylor and Francis Group, LLC

356
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
0
0.5
1
0
0.2
0.4
0.6
0.8
1
0
0.5
1
0
0.2
0.4
0.6
0.8
1
0
0.5
1
0
0.2
0.4
0.6
0.8
1
Figure 7.29: Approximation of Circle with Lines
Figure 7.30: Approximation of Sphere with Planes
where
w1
 w2
 w3
     wn
  1  (7.128)
The coordinates
 w1 w2 w3
    wn
 , are called the barycentric coordinates of the
point given by Equation (7.127). If all the wi are required to be positive, the barycen-
tric coordinates represent all the points which lie in the Convex Hull of the points
P1, P2, P3, ..., Pn.
P1
P2
Q
R
P1
P3
P2
Q
R
Figure 7.31: Barycentric Examples
¬© 2010 by Taylor and Francis Group, LLC

Numerical Approach
357
Figure 7.31 illustrates the barycentric concept. The points Q and R on the line
connecting the points P1 and P2 are given by the barycentric coordinates
 0  5 0  5
 and
0  25 0  75
 , respectively. Similarly, the barycentric coordinates for the points
Q and R on the triangle formed by the points P1, P2, and P3 are given by the
three-tuples
1  3 1  3 1  3
 and
1  2 1  2 0
 , respectively.
The barycentric coordinates means for parameterizing speciÔ¨Åc points in an n-
simplex provides us a simple mechanism to recursively divide the n-simplex into
smaller segments. For example, if we start with two points specifying a line
P1
  1
1
 and P2
 3
5
  (7.129)
and we are interested in dividing the line into four segments, we Ô¨Årst determine the
point with a barycentric coordinate of
 0  5 0  5
 which corresponds to the point
P3
  0  5P1
 0  5P2
  0  5
 1
1
  0  5
 3
5

  2
3

 (7.130)
The next set of points are determined by recursively calculating the points corre-
sponding to the barycentric coordinate of

0  5 0  5

of the points P1 and P3 and
P2 and P3 which results in the points
P4
  0  5P1
 0  5P3
 0  5
 1
1
  0  5
 2
3

  1  5
2

(7.131)
and
P5
  0  5P3
 0  5P2
 0  5
 2
3
  0  5
 3
5

  2  5
4

 (7.132)
The approach that we will follow to generate hyperplanes to approximate the hy-
persphere begins by determining the hyperplane which corresponds to the polytope
which corresponds to the constant
 1 norm. For example, the constant
 1 = 1, poly-
topes for the two-dimensional space are given by the lines:
x1
 x2
  1
(7.133)
 x1
 x2
  1
(7.134)
 x1
 x2
  1
(7.135)
x1
 x2
  1
(7.136)
¬© 2010 by Taylor and Francis Group, LLC

358
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
which can be parameterized in terms of lines connecting the points
P1
  1
0
  P2
  0
1
   for the line
 x1
 x2
  1  P4
  0
 1
  P3
   1
0
   for the line
 x1
 x2
  1  P3
   1
0
  P2
  0
1
   for the line
 x1
 x2
  1  P1
  1
0
  P4
  0
 1
   for the line
 x1
 x2
  1  Consider the line connecting P1 and P2 (Equation 7.133) which approximates the
arc of an unit radius circle in the Ô¨Årst quadrant. The barycentric coordinates
 0  5 0  5
 of the points P1 and P2 correspond to the point:
P5
  0  5P1
 0  5P2
  0  5
0  5
  (7.137)
Normalizing this point such that its Euclidean norm is unity results in the point:
P5
   1
 2
1
 2
  (7.138)
The line which connects P1 and P5, and P5 and P2 are given by the equations:
0  9239x1
 0  3827x2
  0  9239
(7.139)
0  3827x1
 0  9239x2
  0  9239  (7.140)
Similarly, the lines deÔ¨Åned by Equations (7.134) through (7.136) can be divided to
result in a total of eight lines to approximate the circle.
Similarly, for the three-dimensional space, the planes can be parameterized in
terms of the point:
P1
  
1
0
0
 
 P2
  
0
1
0


 P3
  
0
0
1


  for x1
 x2
 x3
  1
P1
  
1
0
0


 P2
  
0
1
0


 P6
  
0
0
 1
 
  for x1
 x2
 x3
  1
P1
  
1
0
0


 P5
  
0
 1
0
 
 P3
  
0
0
1


  for x1
 x2
 x3
  1
¬© 2010 by Taylor and Francis Group, LLC

Numerical Approach
359
P1
  
1
0
0


 P5
  
0
 1
0
 
 P6
  
0
0
 1


  for x1
 x2
 x3
  1
P4
  
 1
0
0
 
 P2
  
0
1
0


 P3
  
0
0
1


  for
 x1
 x2
 x3
  1
P4
  
 1
0
0
 
 P2
  
0
1
0


 P6
  
0
0
 1


  for
 x1
 x2
 x3
  1
P4
  
 1
0
0
 
 P5
  
0
 1
0


 P3
  
0
0
1


  for
 x1
 x2
 x3
  1
P4
  
 1
0
0
 
 P5
  
0
 1
0


 P6
  
0
0
 1


  for
 x1
 x2
 x3
  1
These points, which deÔ¨Åne patches are used to divide each patch into smaller
patches using the barycentric coordinate approach. These result in point which lie
on the plane deÔ¨Åned by the basic n-simplex. After the division of the n-simplex,
all the points are normalized to lie on an unit radius hypersphere. The patches after
normalization deÔ¨Ånes new planes which are inscribed within the unit radius hyper-
sphere. These planes now deÔ¨Ånes linear constraint equations which permit us to
approximately represent the spherical constraint with a set of linear constraints. To
illustrate this process, consider the plane deÔ¨Åned by the points P1, P2, and P3
in three-dimensional space. All possible combinations 3C2 of the points P1, P2,
and P3 are determined which are
 P1 P2
,
 P2 P3
, and
 P1 P3
. The points
which correspond to the barycentric coordinates
 0  5 0  5
 of the pairs of points are
determined and are shown in Figure 7.32(i). Normalizing the points P4, P5, and
P6 results in points which lie on the sphere as shown in Figure 7.32(ii). The six
points deÔ¨Åne four planes which are deÔ¨Åned by the equations:
0  5774x1
 0  5774x2
 0  5774x3
  0  8165
(7.141)
0  8629x1
 0  3574x2
 0  3574x3
  0  8629
(7.142)
0  3574x1
 0  8629x2
 0  3574x3
  0  8629
(7.143)
0  3574x1
 0  3574x2
 0  8629x3
  0  8629
(7.144)
The number of hyperplanes that approximate the n-dimensional hypersphere is
given by the equation:
1
 n
 nC2
 nC3
     nCn  2
(7.145)
for each of the
 1 plane and 2n number of the
 1 plane create a polytope which
approximate the hypersphere. For example in three-dimension (n
  3), the number
¬© 2010 by Taylor and Francis Group, LLC

360
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
1
0
1
0
1
P2
P6
P4
P3
P5
P1
(i)
1
0
1
0
1
P2
P6
P4
P3
P5
P1
(ii)
Figure 7.32: Division of Two-Simplex
of planes to approximate the
 1 plane is 4 and there are a total of 23 = 8 number
of these
 1 planes as shown in Figure 7.19(ii). The Ô¨Årst level (L = 1) of recursion
generates a total of 24 planes which approximate the sphere and the second level (L
= 2) of recursion results in 2n
 4L
  = 128 planes.
To determine the largest error in using hyperplanes to approximate hypersphere,
we need to calculate the shortest distance of every hyperplane from the origin and
the difference of this distance from unity is the error.
The equation of a hyperplane in n-dimension is given by the equation:
n
‚àë
i 1
aixi
  b
(7.146)
and the normal to the plane is given by the vector
 a
  





a1
a2
...
an  1
an
  





(7.147)
The equation of the normal to the plane passing through the origin is given by the
equation
Œ±
 aT
  0
(7.148)
where Œ± is a scalar. To determine the point of intersection of the normal (Equa-
tion 7.148) with the hyperplane (Equation 7.146), substitute Equation (7.148) into
Equation (7.146) resulting in the equation
¬© 2010 by Taylor and Francis Group, LLC

Numerical Approach
361
n
‚àë
i 1
aixi
  b
(7.149)
Œ±
n
‚àë
i 1
a2
i
  b
  Œ±
 b
‚àën
i 1 a2
i
 (7.150)
Having determined the coefÔ¨Åcients of the hyperplanes to approximate the hyper-
sphere of n-dimension, the maximum error in approximating the hypersphere with a
set of planes is studied as a function of the number of hyperplanes. The maximum
error is given as the difference from unity (the radius of the unit hypersphere) of the
shortest Euclidean distance of the plane from the origin. The point of intersection
of a line that is normal to a plane passing through the origin, and the plane can be
shown to be:
b
‚àën
i 1 a2
i
 





a1
a2
...
an  1
an
 





(7.151)
The shortest distance of the plane from the origin in now given by the equation
b
‚àën
i 1 a2
i
 n
‚àë
i 1
a2
i
 b
 ‚àën
i 1 a2
i
(7.152)
When approximating a circle with lines, Figure 7.33 illustrates the reduction in
the error as a function of number of lines (planes) used to approximate the circle and
sphere, respectively.
10
0
10
10
2
0
0 05
0.1
0.15
0.2
0 25
0.3
0 35
Number of Lines
Approximation Error
(i)
10
0
10
10
2
10
3
10
4
0
0.05
0.1
0.15
0.2
0.25
0.3
0.35
0.
0. 5
Number of Planes
Approximation Error
(ii)
Figure 7.33: Error in Approximating a Hypersphere with Hyperplanes
¬© 2010 by Taylor and Francis Group, LLC

362
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
Example 7.7:
The second-order spring-mass-dashpot system with an uncertain
spring stiffness is considered to illustrate the LP-based approach for the determi-
nation of a control proÔ¨Åle which minimizes the maximum
 2 norm of the residual
states. The cost function is deÔ¨Åned as
min
 f
  max
i
ki
 xi
 tf
  1  2
 Àôxi
 tf
  2
 (7.153)
which corresponds to the residual energy for a system whose boundary conditions
correspond to a Ô¨Ånal displacement of unity and a Ô¨Ånal velocity of zero. The Ô¨Årst
approximate solution corresponds to the minimization of the
 1 norm of the residual
states of the set of uncertain models. The resulting solution has been illustrated in
Example 7.5. The next iteration corresponds to doubling the number of lines used
to approximate the
 2 norm of the residual states. The resulting linear programming
problem is
minimize
f
(7.154a)
subject to
 0  9239 f
  0  9239Àôx
 0  3827
 k
ix
  0  9239 f
(7.154b)
 0  9239 f
  0  3827Àôx
 0  9239
 k
ix
  0  9239 f
(7.154c)
 0  9239 f
  0  9239Àôx
 0  3827
 k
ix
  0  9239 f
(7.154d)
 0  9239 f
  0  3827Àôx
 0  9239
 k
ix
  0  9239 f
(7.154e)
0
  u  m   1
 m
  1  2     501
(7.154f)
u  m  u m
1    0
 m
  1  2     500
(7.154g)
0.6
0.7
0 8
0.9
1
1.1
1.2
1 3
1.
0
0 005
0.01
0 015
 Residual Energy
Stiffness
(i) Residual Energy Sensitivity
0
0.002
0.00
0 006
0.008
0.01
0.012
0.0
0 016
0.018
0.02
0
0.002
0.00
0.006
0.008
0.01
0.012
0.01
0.016
0.018
0.02
Displacement (   Kx)
Velocity (   M Àôx  )
(ii) Residual State Distribution
Figure 7.34: Energy and Norm Plots
¬© 2010 by Taylor and Francis Group, LLC

Numerical Approach
363
Figure 7.34(i) illustrates the variations of the square root of the residual energy
as a function of the spring stiffness. The graph with the
  symbols corresponds to
the solution determined by the linear programming problem where eight lines are
used to approximate the circle which contains the residual states, and the graph with
the
√Ü symbols corresponds to the solution derived form a nonlinear programming
problem (NLP). It can be seen that the difference between the solutions is minimal.
Figure 7.34(ii) illustrates the absolute magnitude of residual displacement plotted
versus the absolute magnitude of the velocity. The
 and the
√Ü symbols corresponds
to the residual states for 51 models which span the range of uncertain stiffness for
the LP and NLP solutions. The dashed lines represent the lines that are used to
approximate the circle. It can be seen that all the
 symbols lie within the polygon
bounded by the dashed lines and the abscissa and the ordinate, and the
√Ü symbols lie
in the region bounded by the arc of a circle and the x and y axes.
0.6
0.7
0 8
0.9
1
1.1
1.2
1 3
1.
0
0 005
0.01
0 015
 Residual Energy
Stiffness
(i) Residual Energy Sensitivity
0
0 002
0.00
0.006
0.008
0.01
0 012
0.01
0.016
0.018
0.02
0
0.002
0.00
0.006
0.008
0.01
0.012
0.01
0.016
0.018
0.02
Displacement (   Kx)
Velocity (   M Àôx  )
(ii) Residual State Distribution
Figure 7.35: Energy and Norm Plots
Figure 7.35 illustrates the results of the sensitivity curves and the norm of the
residual states when two levels of recursion are used to generate 16 lines to approxi-
mate a circle. It can be seen that compared to Figure 7.34 the solutions are closer to
that of the NLP solution, but the incremental improvement might not warrant solving
a larger size LP problem.
Figure 7.36 illustrates the minimax control proÔ¨Åle generated using 8 and 16 lines
to approximate a circle, respectively. It can be noted that the solutions with an in-
creasing number of lines to approximate the circle, tends toward the two-switch min-
imax solution generated by the NLP solver which is given by the equation:
u  t
  0  3452
 0  4730H
 t
 3  1703   0  1818H
 t
 6  3405   (7.155)
¬© 2010 by Taylor and Francis Group, LLC

364
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
0
1
2
3
5
6
7
0.3
0.
0.5
0.6
0.7
0.8
0.9
1
Time (sec)
Control
(i) Control ProÔ¨Åle (Level 1)
0
1
2
3
5
6
7
0.3
0.
0.5
0.6
0.7
0.8
0.9
1
Time (sec)
Control
(ii) Control ProÔ¨Åle (Level 2)
Figure 7.36: Input-Shaped Control ProÔ¨Åle
Example 7.8: The LP-based approach to solving a minimax control problem for a
system with a rigid-body mode is illustrated here. The two-mass spring system with
an uncertain spring stiffness is considered. The system is a described by a fourth-
order model and hence a fourth-dimensional hypersphere needs to be approximated
by hyperplanes. As was described earlier, planes that correspond to the
 1 norm of
unity are determined, which are subsequently divided to generate a series of planes
which are circumscribed by the hypersphere. For illustrative purposes consider the
plane deÔ¨Åned by the four point
P1
  


1
0
0
0
 


 P2
  


0
1
0
0




 P3
  


0
0
1
0




 P4
  


0
0
0
1




 (7.156)
which is deÔ¨Åned by the equation
x1
 x2
 x3
 x4
  1  (7.157)
The four points
 P1 P2 P3 P4
  can be used to represent the barycentric coordi-
nates of a tetrahedron. The point that corresponds to the barycentric coordinate of
  1
3
1
3
1
3
 is determined for all 4C3 combinations of the points
 P1P2P3P4
  which
result in the points:
P5
  1
3P1
  1
3P2
  1
3P3
   1
3
1
3
1
3 0
 T
P6
  1
3P1
  1
3P2
  1
3P4
   1
3
1
3 0 1
3
 T
P7
  1
3P1
  1
3P3
  1
3P4
   1
3 0 1
3
1
3
 T
P8
  1
3P2
  1
3P3
  1
3P4
  0 1
3
1
3
1
3
 T
¬© 2010 by Taylor and Francis Group, LLC

Numerical Approach
365
The tetrahedron, which is deÔ¨Åned by the points
 P1 P2 P3 P4
  can be subdivided
into 11 tetrahedra which are given by the following combinations:
P5 P6 P7 P8
  P1 P5 P6 P7
  P2 P5 P6 P8
  P3 P5 P7 P8
  P4 P6 P7 P8
  P1 P2 P5 P6
  P1 P3 P5 P7
  P1 P4 P6 P7
  P2 P3 P5 P8
  P2 P4 P6 P8
  P3 P4 P7 P8
 A tetrahedon and its division into 11 smaller tetrahedra is shown in Figure 7.37
each of the vertices of the tetrahedra are normalized so as to lie on the unit hyper-
(i) Tetrahedra
(ii) Divisions into Smaller Tetrahedra
Figure 7.37: Recursive Division
sphere. These 11 normalized tetrahedra represent 11 planes which approximate part
of the hypersphere. The equations for these 11 planes are:
0  5000x1
 0  5000x2
 0  5000x3
 0  5000x4
  0  8660
0  6830x1
 0  6830x2
 0  1830x3
 0  1830x4
  0  6830
0  6830x1
 0  1830x2
 0  6830x3
 0  1830x4
  0  6830
0  6830x1
 0  1830x2
 0  1830x3
 0  6830x4
  0  6830
 0  1830x1
 0  6830x2
 0  1830x3
 0  6830x4
  0  6830
 0  1830x1
 0  6830x2
 0  6830x3
 0  1830x4
  0  6830
 0  1830x1
 0  1830x2
 0  6830x3
 0  6830x4
  0  6830
0  8446x1
 0  3091x2
 0  3091x3
 0  3091x4
  0  8446
¬© 2010 by Taylor and Francis Group, LLC

366
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
0  3091x1
 0  8446x2
 0  3091x3
 0  3091x4
  0  8446
0  3091x1
 0  3091x2
 0  8446x3
 0  3091x4
  0  8446
0  3091x1
 0  3091x2
 0  3091x3
 0  8446x4
  0  8446
The 16
 1 = 1 planes are divided into 11 planes resulting in a total of 176 planes
to approximate the four-dimensional hypersphere. Each of these planes can be re-
cursively divided into 11 planes each for better approximation of the hypersphere.
In this example, we will stay with the 176 planes to approximate the hypersphere.
Using 21 points to discretize the uncertain spring stiffness space, results in an LP
problem with a total of 3696 inequality constraints. Dividing the time interval into
301 time instants, results in a total of 302 variables to be solved which correspond
to the magnitude of the control at 301 time instants and the variable which approx-
imates the radius of the hypersphere which bounds the residual energy of the 21
uncertain models.
0.6
0.7
0 8
0.9
1
1.1
1.2
1 3
1.
0 005
0.01
0 015
0.02
0 025
0.03
0 035
0.0
0 0 5
 Residual Energy
Stiffness
(i) Sensitivity to Stiffness Variation
0
0.01
0.02
0.03
0.0
0.05
0.06
0.07
0.08
0
0 01
0 02
0 03
0 0
0 05
0 06
0 07
0 08
Displacement (   Kx)
Velocity (   M Àôx  )
(ii) Distribution of Residual States
Figure 7.38:
 2 Minimax Control
Figure 7.38(i) illustrates the variations of the residual energy of the system as
a function of varying spring stiffness for solutions generated by the LP problem
(  ) and the NLP ( √Ü). It can be seen that the sensitivity plots are nearly identical.
Figure 7.38(ii) plots the absolute magnitude of the displacement error versus the
velocity error of each of the modes. The asterisk and circles correspond to the errors
generated by the control proÔ¨Åle generated by the LP and NLP problems, respectively.
Figure 7.39 illustrates the bang-bang
 2 minimax control proÔ¨Åles generated by the
NLP and the LP problems, respectively.
In Section 7.2.4 the minimax problem formulation was used to design control
proÔ¨Åles which are robust to modeling uncertainties. Posing the problem in a lin-
ear programming framework required approximating the residual energy, which is a
quadratic, with multiple hyperplanes. This permitted exploiting powerful linear pro-
¬© 2010 by Taylor and Francis Group, LLC

Numerical Approach
367
0
1
2
3
5
6
7
‚àí1
‚àí0.8
‚àí0.6
‚àí0.
‚àí0.2
0
0.2
0.
0.6
0.8
1
Time (sec)
Control
(i) Control (NLP)
0
1
2
3
5
6
7
‚àí1
‚àí0.8
‚àí0.6
‚àí0.
‚àí0.2
0
0.2
0.
0.6
0.8
1
Time (sec)
Control
(ii) Control (LP)
Figure 7.39:
 2 Minimax Control
gramming algorithms that can solve large-order systems. Recently, there has been
a tremendous growth in semideÔ¨Ånite programming which permit solving problems
that include linear matrix inequalities (LMI). Constraints that require the feasible
solution to lie within a hypersphere, which is deÔ¨Åned by a quadratic inequality equa-
tion, can be represented as an LMI. This permits posing the minimax problem in a
convex programming framework which guarantees convergence to a global optimal.
7.3
Linear Matrix Inequality
A linear matrix inequality can be described by the equation:
F
 x  F0
 x1F1
     xnFn
  0
(7.158)
where the symbol
  means negative deÔ¨Ånite. Fi are real symmetric matrices and
x
  x1 x2
    xn
 is a vector of real variables. LMIs are convex constraints, i.e., if
F
 x   0 and F
 y   0 then:
F
 Œªx
 1
 Œª
 y   ŒªF
x

1
 Œª
 F
 y
  0   Œª
  0   1   (7.159)
LMIs are important since numerous engineering problems can be posed as LMI
problems. To illustrate this, consider the linear dynamic system:
Àôz
  Az
(7.160)
where z is the state vector and A is the system matrix. The system represented by
Equation (7.160) is asymptotically stable if:
¬© 2010 by Taylor and Francis Group, LLC

368
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
ATP
 PA
  0
(7.161)
P
  0
(7.162)
which implies that the system is stable if a positive deÔ¨Ånite P can be determined
which satisÔ¨Åes Equation (7.161). Equations (7.161) and (7.162) constitute matrix-
valued LMIs which can be represented as a combined LMI:
F
 P  
 ATP
PA 0
0
 P
   0  (7.163)
SemideÔ¨Ånite program (SDP) is an optimization problem with a linear cost function
and constraints that are linear equality and LMIs:
minimize
cTx
(7.164a)
subject to
Aeqx
  beq
(7.164b)
F0
 x1F1
     xnFn
  0
(7.164c)
where Fi are symmetric matrices and x is the vector of parameters to be solved.
One of the most important results that is exploited by control engineers is the
Schur complement for symmetric matrices. The quadratic requirement:
P
 QS
 1QT
  0   where S
  0
(7.165)
can be rewritten as:
 P Q
QT S
   0  (7.166)
To illustrate the use of the Schur complement, consider the discrete-time system:
x k
 1    Gx k

Hu k
 (7.167)
Assume a controller of the form u  k
  =
 Kx k
 , the closed-loop system is given by
the equation
x  k
 1   G
 HK
xk
 (7.168)
Consider the discrete-time Lyapunov candidate function
V
 k
  xk
 T Pxk
   where P
  0  (7.169)
For stability, one requires
V
 k
 1   V
 k


x k
1  TPx k
1   x k
TPx k

  0
(7.170)
 x k
T
  G
 HK
TP  G
 HK

 P
 x k

  0
(7.171)
  P
  G
 HK
 TP G
 HK
  0  (7.172)
¬© 2010 by Taylor and Francis Group, LLC

Numerical Approach
369
The feedback gain K has to be selected so as to satisfy Equation (7.172) which is
a quadratic inequality in the unknowns K and P. Equation (7.172) can be rewritten
using Schur complement as:
 I
 GT
 
P
 G
 HK
 TP
P G
 HK
 P


I
 G

  0  (7.173)
where I is the identity matrix. Pre- and post-multiply Equation (7.173) by P
 1
results in the equation:
 I
 GT
  P
 1
P
 1
 G
 HK
 T
G
 HK
 P
 1
P
 1
  I
 G

  0  (7.174)
DeÔ¨Åning P
 1
  M and KP
 1
  L, we have:
 M
MGT
 LTHT
GM
 HL
M
   0
(7.175)
which is an LMI and the unknowns M and L can be easily solved.
7.3.1
Time-Delay Filter
The LMI formulation can be exploited to design input-shaper proÔ¨Åles by param-
eterizing the reference proÔ¨Åle in discrete time. The control proÔ¨Åle in frequency do-
main is represented as:
u  s  1
s
 A0
 A1e
 sT
 A2e
 2sT
 A3e
 2sT
     ANe
 NsT
 (7.176)
where T is the sampling time. The rest-to-rest maneuver problem is stated as the
selection of Ai which minimizes the cost function:
Min
Ai J
  x  N
1  T
  xf
 T Q x  N
1  T
  xf
 (7.177)
where xf is the desired Ô¨Ånal state, x  TN
  is the actual Ô¨Ånal state for a given Ai and Q
is a positive deÔ¨Ånite weighting matrix. The magnitude of Ai is generally subject to
constraints such as
0
  Ai
  1
(7.178)
‚àë
i
Ai
  1  (7.179)
The system states at time k
  1, in terms of the parameter Ai are given by the
equation:
x k
 1    Gx k

HAk where k
  0  2     N
(7.180)
¬© 2010 by Taylor and Francis Group, LLC

370
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
where x is the state vector and u is the control input. The state response for the
control input Ak is
x  k
 1    Gkx1   k
‚àë
i 0
Gk  iHAi
(7.181)
where x  1   represents the initial state of the system. To solve control problems with
speciÔ¨Åed initial and Ô¨Ånal states, in addition to the Ô¨Ånal time (Tf ), the Ô¨Ånal state con-
straint can be represented as
x N
 1    GNx1   N
‚àë
i 0
GN
 iHAi
(7.182)
where the maneuver time Tf
  N
1  Ts, i.e., the maneuver time is discretized into
N intervals. Equation (7.182) can be rewritten in the standard equality constraint
form:
x N
 1    GNx1    GNH
GN
 1H
   GH
H
  








A0
A1
A2
   AN
 








(7.183)
Since the cost function is quadratic, the optimization problem is restated as:
min J
  Œ≥
(7.184a)
subject to
Œ≥
  x N
 1   xf
 T Q x N
1   xf
   0
x N
 1    GNx1    GNH
GN
 1H
   GH
H
  








A0
A1
A2
   AN
 








N
‚àë
i 0
Ai
  1
0
  Ai
  1
 i
The Schur complement can be used to rewrite the optimization problem as:
¬© 2010 by Taylor and Francis Group, LLC

Numerical Approach
371
min J
  Œ≥
(7.185a)
subject to
 Œ≥
 x N
 1   xf
 T
 x N
1   xf
 Q
 1
   0
x N
 1    GNx1    GNH
GN
 1H
   GH
H
  








A0
A1
A2
   AN
 








N
‚àë
i 0
Ai
  1
0
  Ai
  1
 i
EfÔ¨Åcient algorithms have been developed for SDP which result in globally op-
timal solutions. YALMIP [6] is a MATLAB-based toolbox to solve a variety of
optimization problems including semideÔ¨Ånite programming. This software is used
in conjunction with solvers such as SeDuMi [7] and SDPT3 [8]. YALMIP is used to
solve the illustrative examples in this section.
Example 7.9:
Design a minimum time control proÔ¨Åle for the system
¬®x
  Àôx
 x
  u
(7.186)
to satisfy the boundary conditions
x  0    Àôx
  0   and x  tf
  1   Àôx  tf
  0  (7.187)
where u has to satisfy the constraint
1
  u
  0  (7.188)
The discrete time state space representation of the simple harmonic oscillator
(Equation 7.186) is
 x
 k
 1  Àôx
 k
 1     

e
 0  5T
 C T
  1
 3S T
 2
 3e
 0  5TS T
  2
 3e
 0  5TS T
 e
 0  5T
 1
 3S T
 C T
  

x k
 Àôx k
  
  e
 0  5T
 1
 3S T
 C T
  1
2
 3e
 0  5TS T
 u  k
 (7.189)
¬© 2010 by Taylor and Francis Group, LLC

372
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
where T is the sampling interval and cos
  3
2 T
   C T and sin
  3
2 T
   S T. The
boundary conditions are
x1
   0
0
 and xN
 1
   1
0
  (7.190)
Since, the desired maneuver is a rest-to-rest maneuver, we require
xN
 1  i
  xN
 1
 i
  1  2  3     ‚àû
(7.191)
Substituting Equation (7.71), with i
  1, in Equation (7.69), we have
 1
0
  
cos
 T
  sin
 T
  sin
 T
  cos
 T
   1
0

 
 cos
T
  1
sin
T
  u
(7.192)
or
 1
 cos
 T
  sin
 T
 sin
 T
 1
 cos
 T
   1
0

 
 cos
T
  1
sin
T
     cos
T
  1
sin
T
  u
(7.193)
which implies that the steady state value of u is 1. This terminal equality constraint
has to be included in the linear programming problem.
Since the formulation does not include a hard constraint which requires satisfac-
tion of the boundary conditions, the numerical solution corresponds to one which
minimizes Œ≥. Figure 7.40 illustrates the variation of Œ≥ as a function of the maneuver
time tf .
Thus, one can use the bisection algorithm to determine the maneuver time which
corresponds to the smallest time for which Œ≥ is less than some prespeciÔ¨Åed tolerance.
Figure 7.41 illustrates the solution determined using the LMI formulation and a bi-
section algorithm to determine the minimum time for a rest-to-rest maneuver for a
single spring-mass-dashpot system.
MATLAB Program 7.13:
function
e x i t f l a g = example1 ( t f ) ;
%
% Program to
i l l u s t r a t e
the use of LMI to
solve
the
% input
shaping problem
%
clear
a l l
% Single Spring
 Mass
 Dashpot System
A = [0 1;
 1
 1];
B = [ 0 ; 1 ] ;
C = [1
0 ] ;
D =
[ 0 ] ;
Q = [1
0;0
1 ] ;
¬© 2010 by Taylor and Francis Group, LLC

Numerical Approach
373
2
2.2
2.4
2.6
2.8
3
‚àí0.01
0
0.01
0.02
0.03
0.04
0.05
0.06
Maneuver Time
Œ≥
Figure 7.40: Variation of Œ≥ vs. Maneuver Time
xf =
[ 1 ; 0 ] ;
x0 =
[ 0 ; 0 ] ;
sys = ss (A,B,C,D) ;
N = 101;
Ts =
t f / ( N 1);
sysd = c2d ( sys , Ts ) ;
[ Ad, Bd, Cd,Dd] = ssdata ( sysd ) ;
onevec = ones (N, 1 ) ;
zerovec = zeros (N, 1 ) ;
AAmat = eye (N) ;
Aineq =
[ ] ;
Bineq =
[ ] ;
% Constraint on the
co n t ro l
input 0
  A i
  1
Aineq = [ Aineq ; AAmat ] ;
Bineq = [ Bineq ; onevec ] ;
Aineq = [ Aineq;
 AAmat ] ;
Bineq = [ Bineq ; zerovec ] ;
% Final
state
e rro r
determination
Trmat =
[ ] ;
¬© 2010 by Taylor and Francis Group, LLC

374
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
for
ind = 1:N,
Trmat = [ Ad ÀÜ ( ind
 1)
 Bd Trmat ] ;
end ;
% Declare the
variables
Avec = sdpvar (N, 1 ) ;
gamma = sdpvar ( 1 ) ;
tempmat = [gamma ( Trmat
 Avec
 xf ) ‚Äô ; ( Trmat
 Avec
 xf )
inv (Q) ] ;
F = set ( tempmat
  0) + set ( Aineq
 Avec
  Bineq ) ;
options = sdpsettings ( ‚Äô solver ‚Äô , ‚Äô sedumi ‚Äô ) ;
%options = sdpsettings ( ‚Äô solver ‚Äô , ‚Äô sdpt3 ‚Äô ) ;
diagnostic = solvesdp (F ,gamma, options ) ;
e x i t f l a g = 0;
i f
diagnostic . problem == 0 ,
e x i t f l a g = 1;
% Problem converged
end ;
gammaopt = double (gamma)
Aopt = double ( Avec ) ;
Aopt = [ Aopt ( : ) ; 1 ]
tvec = 0: Ts : (N)
 Ts ;
[YY, TT,XX] = lsim ( sysd , Aopt , tvec , x0 , ‚Äô zoh ‚Äô ) ;
figure ( 1 )
subplot(211) ,
plot (TT,XX) ;
grid
subplot(212) ,
stairs ( tvec , Aopt ) ;
7.3.2
Minimax Time-Delay Filters
The LMI formulation for the design of time-delay Ô¨Ålters to minimize residual
vibrations of a rest-to-rest maneuver can be extended to design robust time-delay
Ô¨Ålters. Given a domain of uncertainty of the model parameters, a set of models (M )
are derived by sampling the uncertain space. The errors in terminal states for each
of these models is determined and the maximum of the norm of the terminal state
errors is minimized. The minimax problem can be stated as:
min J
  Œ≥
(7.194a)
subject to
 Œ≥
 xm
 N
 1   xf
 T
 xm
 N
1   xf
 Q
 1
m
   0 for m = 1,2,
   , M
¬© 2010 by Taylor and Francis Group, LLC

Numerical Approach
375
0
0.5
1
1.5
2
2.5
3
0
0.2
0.4
0.6
0.8
1
Time (sec)
Control
(i) Control
0
0.5
1
1.5
2
2.5
3
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
System Response
Time (sec)
(ii) System Response
Figure 7.41: LMI Solution
xm
 N
 1    GN
mx1    GN
mHm
GN
 1
m
Hm
   GmHm
Hm
  








A0
A1
A2
   AN
 








N
‚àë
i 0
Ai
  1
0
  Ai
  1
 i
Example 7.10:
Design a minimax controller for the rest-to-rest maneuver of the
benchmark problem:
¬®x1
 kx1
 kx2
  u
(7.195a)
¬®x2
 kx1
 kx2
  0
(7.195b)
where the boundary conditions are
x1
 0   x2
 0   Àôx1
 0   Àôx2
 0   0
(7.196a)
x1
 tf
   x2
 tf
  1   Àôx1
 tf
   Àôx2
 tf
  0
(7.196b)
and the control input satisÔ¨Åes the constraint:
 1
  u
  1  (7.197)
The spring stiffness is uncertain and lies in the range
0  7
  k
  1  3  (7.198)
¬© 2010 by Taylor and Francis Group, LLC

376
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
Parameterizing the optimal control proÔ¨Åle as
u  t
 
N
‚àë
i 0
AiH
 t
 iT
 (7.199)
where the variable Ai satisÔ¨Åes the constraint
 1
  Ai
  1   i
  1  2     N
 (7.200)
The optimization problem is to determine Ai so the minimax problem can be
solved:
Min
Ai Max
k
 xm
 N
 1   xf
 T
 


k
 Kp
 k 0 0
 k
k 0 0
0
0 1 0
0
0 0 1
 





Q
 xm
 N
 1   xf
 (7.201)
where Kp is a pseudo-spring constant to ensure that the Q matrix is positive deÔ¨Ånite.
The subscript m refers to the mth plant in the domain of uncertainty. Sampling
on an uniform grid, the uncertain space of k 21 times, and using the 21 models
to minimize the maximum magnitude of the residual energy results in the control
proÔ¨Åle illustrated in Figure 7.42(i) and the corresponding sensitivity (residual energy
variation) curve in Figure 7.42(ii). The maneuver time is selected to be 6 seconds
and the shape of the sensitivity control proÔ¨Åle resembles the ones derived using the
minimax optimization algorithms.
0
1
2
3
4
5
6
7
‚àí1
‚àí0.8
‚àí0.6
‚àí0.4
‚àí0.2
0
0.2
0.4
0.6
0.8
1
Time (sec)
Control
(i) Control
0.7
0.8
0.9
1
1.1
1.2
1.3
1.4
0.005
0.01
0.015
0.02
0.025
0.03
0.035
0.04
0.045
0.05
0.055
Spring Stiffness
 Residual Energy
(ii) Residual Energy Variation
Figure 7.42: LMI Minimax Time-Delay Filter
¬© 2010 by Taylor and Francis Group, LLC

Numerical Approach
377
MATLAB Program 7.14:
%
% Program to
i l l u s t r a t e
the use of LMI to
solve
the minimax
% input
shaping problem . The spring
i s
considered to be
% uncertain and
l i e s
i n
the range 0.7
  k
  1.3
%
%
t f
= 6; % Final
time
% 2 Mass
 spring benchmark problem
N = 101;
Ts =
t f / ( N 1);
onevec = ones (N, 1 ) ;
zerovec = zeros (N, 1 ) ;
% Declare the
variables
Avec = sdpvar (N, 1 ) ;
gamma = sdpvar ( 1 ) ;
AAmat = eye (N) ;
Aineq =
[ ] ;
Bineq =
[ ] ;
% Constraint on the
co n t ro l
input
 1
  A i
  1
Aineq = [ Aineq ; AAmat ] ;
Bineq = [ Bineq ; onevec ] ;
Aineq = [ Aineq;
 AAmat ] ;
Bineq = [ Bineq ; onevec ] ;
F = set ( Aineq
 Avec
  Bineq ) ;
kvec = linspace ( 0 . 7 , 1 . 3 , 2 1 ) ;
% Sample the
uncertain parameter
for k = kvec ,
M = eye ( 2 ) ;
% Mass Matrix
K = [ k
 k;
 k k ] ;
% S t i f f n e s s
Matrix
A = [ zeros ( 2 ) eye ( 2 ) ;
 inv (M)
 K zeros ( 2 ) ] ;
B = [ 0 ; 0 ; inv (M)
  [ 1 ; 0 ] ] ;
C = [0 1 0 0 ] ;
D =
[ 0 ] ;
Kpseudo = K + [1
0;0
0 ] ;
Q = [ Kpseudo zeros ( 2 ) ;
zeros ( 2 ) M] ;
xf = [ 1 ; 1 ; 0 ; 0 ] ;
x0 = [ 0 ; 0 ; 0 ; 0 ] ;
sys = ss (A,B,C,D) ;
sysd = c2d ( sys , Ts ) ;
[ Ad, Bd ,Cd,Dd] = ssdata ( sysd ) ;
¬© 2010 by Taylor and Francis Group, LLC

378
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
% Final
state
e rro r
determination
Trmat =
[ ] ;
for
ind = 1:N,
Trmat = [ Ad ÀÜ ( ind
 1)
 Bd Trmat ] ;
end ;
tempmat = [gamma ( Trmat
 Avec
 xf ) ‚Äô ; ( Trmat
 Avec
 xf )
inv (Q) ] ;
F = F + set ( tempmat
  0 ) ;
end ;
%options = sdpsettings ( ‚Äô solver ‚Äô , ‚Äô sedumi ‚Äô ) ;
options = sdpsettings ( ‚Äô solver ‚Äô , ‚Äô sdpt3 ‚Äô ) ;
diagnostic = solvesdp (F ,gamma, options ) ;
gammaopt = double (gamma)
Aopt = double ( Avec ) ;
Aopt = [ Aopt ( : ) ; 0 ] ;
M = eye ( 2 ) ;
K = [1
 1;
 1 1 ] ;
A = [ zeros ( 2 ) eye ( 2 ) ;
 inv (M)
 K zeros ( 2 ) ] ;
B = [ 0 ; 0 ; inv (M)
  [ 1 ; 0 ] ] ;
C = [0 1 0 0 ] ;
D =
[ 0 ] ;
sys = ss (A,B,C,D) ;
sysd = c2d ( sys , Ts ) ;
[ Ad, Bd, Cd,Dd] = ssdata ( sysd ) ;
tvec = 0: Ts : (N)
 Ts ;
[YY, TT,XX] = lsim ( sysd , Aopt , tvec , x0 , ‚Äô zoh ‚Äô ) ;
figure ( 1 )
plot (TT,XX) ;
xlabel ( ‚Äô Time ( sec ) ‚Äô ) ;
ylabel ( ‚Äô System Response ‚Äô )
figure ( 2 )
stairs ( tvec , Aopt ) ;
xlabel ( ‚Äô Time ( sec ) ‚Äô ) ;
ylabel ( ‚Äô Control ‚Äô )
axis ( [ 0
t f +1
 1.1 1 . 1 ] )
7.3.3
Modal Weighted Minimax Time-Delay Filters
The minimax time-delay Ô¨Ålter design presented in the previous section minimized
the maximum magnitude of the residual energy in the system, over the domain of
uncertain parameters. As compared to traditional robust input shapers where the
sensitivity of the residual energy at the nominal model parameters is minimized, the
minimax approach resulted in a smaller value of the worst performance over the
domain of uncertainty.
¬© 2010 by Taylor and Francis Group, LLC

Numerical Approach
379
Is minimizing the worst residual energy of the system the best metric to be used in
the design of robust time-delay Ô¨Ålter, or can one conceive of a different metric which
generate an input shaped proÔ¨Åle which targets the output of interest? To motivate
this, consider the three mass-spring system shown in Figure 7.43. The three modes
of this system
 

x1
x2
x3
 

 


0  5774
0  5774
0  5774
 

 


 0  7071
0
0  7071
 

 


0 4082
 0 8165
0 4082
 

(7.202)
are shown in the same Ô¨Ågure. The frequencies corresponding to the three modes are:
œâi =
 0 1
 3
 . The second-order model of the system is:
 
1 0 0
0 1 0
0 0 1





¬®x1
¬®x2
¬®x3
 

 

1
 1 0
 1 2
 1
0
 1 1



	

x1
x2
x3
 

 

1
0
0

u  (7.203)
If the output of interest is the displacement of the third mass, the output equation is:
z
  0 0 1
 


x1
x2
x3
 

(7.204)
The system model and output equation can be rewritten in modal form as:


1 0 0
0 1 0
0 0 1



	

¬®y1
¬®y2
¬®y3
 

 

0 0 0
0 1 0
0 0 3



	

y1
y2
y3
 

 

 0  5774
 0  7071
0  4082
 u  (7.205)
and
z
   0  5774 0  7071 0  4082
  

y1
y2
y3
 

(7.206)
which clearly indicates that the second mode‚Äôs contribution is the largest and the third
mode‚Äôs is the smallest. These modal contributions can be used to relatively weigh
the modal energies to formulate a cost function whose maximum can be minimized
over the uncertain domain.
Consider a second-order linear mechanical system of the form
M ¬®x
 CÀôx
 Kx
  Du
(7.207)
where the mass matrix M is positive deÔ¨Ånite, C is a positive semideÔ¨Ånite damping
matrix and K is a positive semideÔ¨Ånite stiffness matrix. For rest-to-rest maneuvers
from some prescribed input state, to a Ô¨Ånal state, the residual energy of the system at
the end of maneuver time can be written as
V
  1
2 ÀôxTM Àôx
  1
2
 x
 xf
 TK
 x
 xf

(7.208)
¬© 2010 by Taylor and Francis Group, LLC

380
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
Figure 7.43: Three Mass-Spring Systems and Mode Shapes
In this approach we will transform the system to the modal form by introducing a
coordinate transformation of the form
x  t
  Œ¶yt
 (7.209)
where Œ¶ is the modal matrix obtained by solving the eigenvalue problem associated
with the mass and the stiffness matrices. The residual energy of the system can then
be expressed as
V
  1
2 ÀôyT ÀúM Àôy
  1
2
 y
 yf
 T ÀúK
 y
 yf
 (7.210)
where ÀúM and ÀúK are the transformed mass and stiffness matrices given by
ÀúM
  Œ¶TMŒ¶
  I
(7.211)
ÀúK
  Œ¶TMŒ¶
  











0 0
0
    0
0 œâ2
1 0
    0
0 0 œâ2
2
    0
...
...
...
...
...
0 0
0
    œâ2
n
 











(7.212)
Moving the system from a initial position of x0 to a Ô¨Ånal position of rest xf results in
modal boundary constraint of:
y0
  Œ¶Tx0
(7.213)
yf
  Œ¶Txf
(7.214)
¬© 2010 by Taylor and Francis Group, LLC

Numerical Approach
381
For controlling the output with high precision, e.g., if the displacement of the Ô¨Ånal
mass of a series of n mass-spring systems is the output, the output equation for nth
mass in modal space:
y
  0 0
    1
 Œ¶
 
 C









y1
y2
...
yn
 







(7.215)
If one is interested in displacement precision, the residual energy of each of the mode
is Ô¨Årst weighted so as to correspond to the same Ô¨Ånal displacement. For instance, if
the displacement of the Ô¨Årst two modes are the same, we have the constraint:
y1
  y2
(7.216)
which can be rewritten in terms of potential energies as:
1
2œâ2
1y2
1
  1
2œâ2
2y2
2
 œâ2
1
œâ2
2
 (7.217)
which states that the potential energy of the second mode has to be scaled by œâ2
1
œâ2
2
to satisfy the displacement precision constraint. Furthermore, since the output is a
linear combination of the modal displacements, each of the modes has to be rescaled
to reÔ¨Çect the modal contribution of every mode. For a system with an output equation
in modal form:
y
 n
‚àë
i 1
ciyi
(7.218)
the cost function for optimization can be written as:
V
 n
‚àë
i 1
1
2
 Àôy2
i
 œâ2
i
 yi
 yf
i
 2
  c2
i œâ2
1
œâ2
i
(7.219)
where yf
i correspond to the desired Ô¨Ånal state of the ith mode. An LMI problem can
be posed to minimize the maximum magnitude of the weighted residual energy given
by Equation (7.219).
Example 7.11:
Design a minimax controller for the point-to-point maneuver of a
double pendulum which represents the dynamics of a crane, in the presence of vari-
ations in the load being carried is presented here. Tanaka and Kouno [9] developed
a linearized model of a test crane which is:
m11 ¬®x
 m12 ¬®Œ∏1
 m13 ¬®Œ∏2
 cÀôx
  u
(7.220)
m21 ¬®x
 m22 ¬®Œ∏1
 m23 ¬®Œ∏2
 k12Œ∏1
  0
(7.221)
m31 ¬®x
 m32 ¬®Œ∏1
 m33 ¬®Œ∏2
 k34Œ∏2
  0
(7.222)
¬© 2010 by Taylor and Francis Group, LLC

382
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
where
m11
  m
 m1
 m2
m12
  m1l1
 m2
 l1
 l
 1
 m13
  m2l2
m21
  m1l1
 m2
 l1
 l
 1
 m22
  m1l2
1
 m2
 l1
 l
 1
 2
 I1
m23
  m2l2
 l1
 l
 1
 m31
  m2l2
m32
  m2l2
 l1
 l
 1
 m33
  m2l2
2
 I2
k33
  m2gl2
k22
  m1gl1
 m2g  l1
 l
 1
 The parameters used by Tanaka and Kouno [9] are: m1
  0  5kg, m2
  6kg, l1
 1  5m, l
 1
  0  1m, l2
  0  3m, I1
  0  0008kgm2, I2
  0  06kgm2, m
  8  0kg, and the
coefÔ¨Åcient of friction is c = 1.0 N/(m/s). To control the position of the trolley (Fig-
ure 7.44), a collocated PD controller with proportional gain of 10 and derivative
gain of 1 was used. Robust pre-Ô¨Ålters for shaping the position reference when there
is uncertainty in the mass of payload, m2 were designed using the aforementioned
methodology. The system needs to be repositioned from the initial state of
 x1
 Œ∏1
 Œ∏2
 =
 0  0  0  to
 x1
 Œ∏1
 Œ∏2
  1  0  0 . In this scenario, we are interested in reducing the
sway of the payload at the end of the trolley-positioning maneuver. So the emphasis
is on the precise control of the payload displacement
l1
 l
 1
 Œ∏1
 l2Œ∏2 so as to limit
the payload oscillations.
After implementing a proportional derivative controller, the system model is
u
  10  x
 xr
   Àôx
(7.223)
where xr is the reference input, is:
 
14  5 10  35 1  8
10  35 16  48 2  88
1  8
2  88 0  546





¬®x
¬®Œ∏1
¬®Œ∏2
 

 

2 0 0
0 0 0
0 0 0



	

Àôx
ÀôŒ∏1
ÀôŒ∏2
 

 

10
0
0
0 101  53
0
0
0
17  66
 



x
Œ∏1
Œ∏2
 

 

10
0
0

xr
(7.224)
Two cost functions are used in the design of the minimax Ô¨Ålter. The Ô¨Årst, is the
residual energy of the system which is represented as:
J1
  1
2
 

Àôx
ÀôŒ∏1
ÀôŒ∏2
 

T
 
14  5 10  35
1  8
10  35 16  486 2  88
1  8
2  88 0  546





Àôx
ÀôŒ∏1
ÀôŒ∏2
 

 


x
 1
Œ∏1
Œ∏2
 

T
 
10
0
0
0 101  53
0
0
0
17  66





x
 1
Œ∏1
Œ∏2
 

 (7.225)
DeÔ¨Åne a transformation
 

x
Œ∏1
Œ∏2
 

 

0  2465
 0  2528 0  0191
0  0186 0  2795
 0  8652
0  0186 0  2890
4  8212
 



q1
q2
q3
 

(7.226)
which decouples the mass and stiffness matrices resulting in the transformed equa-
¬© 2010 by Taylor and Francis Group, LLC

Numerical Approach
383
m
x
u
  m1
m2
Œ∏2
l
 1
l1
l2
Œ∏1
Figure 7.44: Double-Pendulum Crane
tions:
 

¬®q1
¬®q2
¬®q3
 

 

0  1215
 0  1246 0  0094
 0  1246 0  1278
 0  0097
0  0094
 0  0097 0  0007
 



Àôq1
Àôq2
Àôq3
 

 

0  65
0
0
0
10  05
0
0
0
486  44



	

q1
q2
q3
 

 

2  465
 2  528
0  191
 xr
(7.227)
The transformed output matrix when the position of the mass m2 relative to trolley
mass m is of interest is:
y
  0
 l1
 l
 1
  l2
  

x
Œ∏1
Œ∏2
 

 0  0353 0  5340 0  0621
  

q1
q2
q3
 

(7.228)
The modal penalties can now be calculated to be:
c2
i œâ2
1
œâ2
i
  1  25
 10
 3 1  84
 10
 2 5  13
 10
 6
 (7.229)
¬© 2010 by Taylor and Francis Group, LLC

384
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
which is used to deÔ¨Åne the modal weighted cost function:
J2
  1
2
 

Àôx
ÀôŒ∏1
ÀôŒ∏2
 

T
 
0  0192 0  0007 0  0001
0  0007 0  1574 0  0283
0  0001 0  0283 0  0051





Àôx
ÀôŒ∏1
ÀôŒ∏2
 

 


x
 1
Œ∏1
Œ∏2
 

T
 
0  0234
 0  1224
 0  0221
 0  1224 1  4826
0  2664
 0  0221 0  2664
0  0480





x
 1
Œ∏1
Œ∏2
 

 (7.230)
The solution of minimizing J1 and J2 over the domain of uncertainty:
3
  m2
  9
(7.231)
results in control proÔ¨Åles illustrated by the dashed line and the solid line, respectively,
in Figure 7.45.
0
2
4
6
8
10
12
14
0
0.1
0 2
0 3
0.4
0 5
0 6
0.7
0 8
0 9
1
Time (sec)
Shaped Input
Figure 7.45: LMI Minimax Control ProÔ¨Åles
The Ô¨Ånal time for both the solutions is 9.46 seconds. To permit a fair comparison
of both the solutions, the true residual energy of the double pendulum at 9.46 sec-
onds is determined and plotted as a function of the uncertain mass m2. Figure 7.46(i)
illustrates that the maximum magnitude of the residual energy of the system con-
trolled by an input proÔ¨Åle designed by minimizing the cost function J1 (total residual
energy) is smaller than that designed based on the modal weighted residual energy,
which is not a surprising result. However, if one were to plot the Ô¨Ånal mass residual
energy metric deÔ¨Åned as:
M
  1
2
 y2
 tf
   Àôy2
 tf
  (7.232)
¬© 2010 by Taylor and Francis Group, LLC

Numerical Approach
385
as shown in Figure 7.46(ii), the control proÔ¨Åle based on minimizing the cost function
J2 clearly outperforms the one based on minimizing the cost function J1. In all these
graphs, the dashed line corresponds to the solution when minimizing J1 and the solid
line when minimizing J2.
3
4
5
6
7
8
9
0
0.01
0.02
0.03
0.04
0.05
0.06
Mass Uncertainty
 Residual Energy
(i) Residual Energy
3
4
5
6
7
8
9
0
0.002
0.004
0.006
0.008
0.01
0.012
Mass Uncertainty
Output Energy
(ii) Output Energy
Figure 7.46: Comparison Metrics
The improved performance of using the cost function J2 to design a shaped proÔ¨Åle
can be gauged from Figures 7.47 and 7.48, which illustrate the motion of the mass
m2 relative to the trolley after the Ô¨Ånal time tf
  9  46 seconds, for various values of
the uncertain mass m2. The mesh plot in Figure 7.47 has a larger variation about the
zeros position compared to the variation illustrated in Figure 7.48.
One has to note that the modal weighted approach can encounter a pathologic
problem when one or more modes might have no contribution to the output of inter-
est. For instance, in the three-mass-spring system illustrated earlier, if the output of
interest is the second mass, then the second mode does not contribute to the output. In
such situations, the noncontributing modes are not included in the cost function and
the resulting shaped reference proÔ¨Åle does not regulate the noncontributing modes.
One can remedy this situation by including the noncontributing modes with a small
weight in the cost function.
7.4
Summary
This focus of this chapter was on the use of numerical techniques for the de-
termination of optimal controllers. The input shaper/time-delay Ô¨Ålters, saturating
controllers, and so forth, can be posed as optimization problems. If simple parame-
¬© 2010 by Taylor and Francis Group, LLC

386
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
3
4
5
6
7
8
9
9
10
11
12
13
‚àí4
‚àí2
0
2
4
x 10
‚àí3
Time
Uncertain Mass
Displacement of m2
Figure 7.47: System Response after t f vs. Uncertain Mass (Cost J1)
3
4
5
6
7
8
9
9
10
11
12
13
‚àí4
‚àí2
0
2
4
x 10
‚àí3
Time
Uncertain Mass
Displacement of m2
Figure 7.48: System Response after t f vs. Uncertain Mass (Cost J2)
terizations can be used to represent the optimal control proÔ¨Åle such as using switch
times to parameterize bang-bang controllers for minimum-time control, a nonlinear
parameter optimization can be formulated and any gradient based algorithm can be
used to arrive at the optimal solution. A caveat that should always be stated regarding
the convergence of gradient based algorithms to local optima.
Algorithms for solving linear, quadratic, and semideÔ¨Ånite programming problems
¬© 2010 by Taylor and Francis Group, LLC

Numerical Approach
387
ensure convergence to global optima since they apply to convex problems. Optimal
controller design can be posed in discrete-time domain which permits exploitation
of convex programming approaches to arrive at the near-globally-optimal solutions.
The sampling time selected to discretize the control proÔ¨Åle inÔ¨Çuences the quality of
the solution. Smaller the sampling time, closer is the solution to the true optimal so-
lution. If the exact optimal solution is desired, the results of the convex optimization
approach can be used to identify the structures of the optimal control proÔ¨Åle. For ex-
ample, the linear programming approach used to determine the time-optimal solution
provides the structure of the control proÔ¨Åle with the correct number of switches and
accurate estimates for their values. The estimate of the number of switches and their
values permit posing a nonlinear programming problem which will often converge
to the globally optimal solution given that the initial guess is close to the optimal
solution. Linear programming and linear matrix inequalities are used to illustrate
design of various controller which include control and state constraints. Inclusion
of sensitivity states and minimax formulation permit design of robust controllers for
rest-to-rest maneuvers.
Exercises
7.1
Design a jerk-limited time-optimal reference proÔ¨Åle for a rest-to-rest maneu-
ver of a spring-mass system given by the equation of motion:
¬®x
 2Œ∂œâ Àôx
 œâ2x
  œâ2u
where
0
  u
  2
and
 0 2
  Àôu
  0 2
using linear programming. œâ
  2 and Œ∂
  0 1. The initial and Ô¨Ånal states
are
x 0   Àôx 0  0 x t f
  2 Àô
 x  t f

 0
Parameterize the jerk-constrained reference proÔ¨Åle using a time-delay Ô¨Ålter
and solve the same problem. Plot the variation in the Ô¨Ånal time of the param-
eterized solution and the linear programming solution as a function of the
number of samples used to discretize the reference proÔ¨Åle.
7.2
Design a velocity-constrained deÔ¨Çection-constrained minimum time control
proÔ¨Åle for a gantry crane using linear programming. The system model is:
 m1
 m2
  ¬®Œ∏
 m2L ¬®œÜ
  u
m2 ¬®Œ∏
 m2L ¬®œÜ
 m2gœÜ
  0
where the model parameters are listed in Table 7.2. The velocity constraint
¬© 2010 by Taylor and Francis Group, LLC

388
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
m1
m2
L
g
5000 kg
250,000 kg
10 m
9.81 m/s2
Table 7.1: Gantry Crane Parameters
is
 0 5m s
  ÀôŒ∏
  0 5m s
and the deÔ¨Çection constraint is
 1m
  LœÜ
  1m
and the control is constrained to lie within
 1000N
  u
  1000N
7.3
Figure 7.49 illustrates a single-axis Ô¨Çexible-arm robot whose equations of
motion are given by the equation:
 


M11
 J M12 M13
M12
M22
0
M13
0
M33
 





¬®Œ∏
¬®q1
¬®q2
 

 



0
0
0
0 M22œâ2
1
0
0
0
M33œâ2
2
 





Œ∏
q1
q2
 

 


1
0
0
 
u
(7.233)
where the model parameters are listed in Table 7.3.
M11
 J
M12
M13
M22
M33
œâ2
1
œâ2
2
0.1115+1
0.2621
0.0418
0.6347
0.6346
965.5838
3.7922e4
Table 7.2: Flexible Robot-Arm Parameters
Design a robust controller (force the sensitivity of the states with respect to
the natural frequencies) for rest-to-rest maneuver of the Ô¨Çexible-arm robot.
The input is constrained to lie in the range:
 10
  u
  10
The initial and Ô¨Ånal conditions of the Ô¨Çexible-arm states are:
 

Œ∏
q1
q2
 

 0 



0
0
0
 

 


ÀôŒ∏
Àôq1
Àôq2
 

 0 



0
0
0
 

 


Œ∏
q1
q2
 

 t f
 



œÄ
0
0
 

 


ÀôŒ∏
Àôq1
Àôq2
 

 t f
   

0
0
0
 

 and the available fuel is limited to:
  tf
0
 u dt
  5;
¬© 2010 by Taylor and Francis Group, LLC

Numerical Approach
389
Figure 7.49: Flexible-Arm Robot
7.4
Figure 7.50 illustrates an X‚ÄìY table whose equations of motion are given by
the equation:
¬®x
 0 01Àôx
 x
  ux
¬®y
 0 01Àôy
 y
  uy
Figure 7.50: X‚ÄìY Table
Design the control proÔ¨Åle to track a circular trajectory given by the reference
model:
xr
  cos
 2œÄ t
t f
   yr
  sin 2œÄ t
t f
 where the Ô¨Ånal time t f is 10 seconds. Assume that the table at initial time is
at
x 0   1  Àôx 0  0 y 0  0  Àôy
 0  0
and the control is constrained by the equation:
 1
  u
  1
¬© 2010 by Taylor and Francis Group, LLC

390
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
Hint: Pose the problem as one where the maximum deviation from the de-
sired trajectory is minimized.
7.5
The linearized model of a Ô¨Çapper-nozzle electrohydraulic servo valve is given
by the transfer function [10]
Xs
 s I
s 
 2 09e14s
 1 25e18
s5
 9 90e3s4
 6 89e7s3
 3 09e11s2
 6 57e14s
 3 39e17
where Xs
 s  and I
 s  are the Laplace transform of the servo valve spool dis-
placement and input current, respectively. The servo value drives a hydraulic
actuator whose dynamics are:
Xa
 s Xs
s 
7 46e8
s3
 1 19e3s2
 1 57e7s
where Xa
 s  is the Laplace transform of the actuator displacement.
De-
termine a current proÔ¨Åle to track a reference actuator displacement proÔ¨Åle
shown in Figure 7.51. The current is constrained to lie in the range:
 10
  i  t
   10
0
0.02
0 04
0.06
0.08
0.1
0
0.2
0.4
0.6
0.8
1
Time (msec)
Reference Displacement
Figure 7.51: Reference Trajectory
7.6
Design a snap-limited time-optimal reference proÔ¨Åle for a rest-to-rest maneu-
ver of a spring-mass system given by the equation of motion:
¬®x
 2Œ∂œâ Àôx
 œâ2x
  œâ2u
where
0
  u
  2
and
 0 2
  ¬®u
  0 2
¬© 2010 by Taylor and Francis Group, LLC

Numerical Approach
391
using linear programming. œâ
  2 and Œ∂
  0 1. The initial and Ô¨Ånal states
are
x 0   Àôx 0  0 x t f
  2 Àô
 x  t f

 0
Snap is deÔ¨Åned as the rate of change of jerk. Study the structure snap proÔ¨Åle
as a function of permitted snap if the jerk is limited to the constraint
 0 5
  Àôu
  0 5
.
7.7
A coordinate measuring machine is used to accurately map the topography
of a surface. High speed motion of these machine excite the vibratory modes
of the machine preventing a high-Ô¨Ådelity measurement of the surface. Seth
and Rattan [11] derived a simple model to capture the dynamics of the car-
riage driven by a motor (Figure 7.52),
Œòc
 s œÑ
s  10 10 s2
 3610 s2
 983371 s2
 25777218 s2
 s2
 60287 s2
 1283877 s2
 25777289 Design a controller to transition a stationary carriage to a constant velocity
(8 rad/sec) in minimum time with no residual vibrations. Assume that the
control input is limited to lie in the range:
 1
  œÑ
  1
Tƒê
W≈µ
Figure 7.52: Coordinate Measuring Machine Carriage
References
[1] N. Singer and W. P. Seering. Pre-shaping command inputs to reduce system
vibration. ASME J. of Dyn. Systems, Measurements, and Cont., 112(1):76‚Äì82,
1990.
¬© 2010 by Taylor and Francis Group, LLC

392
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
[2] J. C. Nash. The (Dantzig) simplex method for linear programming. Computing
in Science and Engineering, 2(1):29‚Äì31, 2000.
[3] T. Singh. Fuel/time optimal control of the benchmark problem. J. of Guid.,
Cont. and Dyn., 18(6):1225‚Äì1231, 1995.
[4] T. Singh. Minimax design of robust controllers for Ô¨Çexible systems. J. of
Guid., Cont. and Dyn., 25(5):868‚Äì875, 2002.
[5] J. O‚ÄôRourke. Computational Geometry in C. Cambridge University Press,
2000.
[6] J. Lofberg. Yalmip. http://control.ee.ethz.ch/ joloef/yalmip.php, 2006.
[7] Jos F. Strum. Sedumi. http://sedumi mcmaster.ca/, 2006.
[8] K. C. Toh, R. H. T¬®ut¬®unc¬®u, and M. J. Todd. http://www.math.cmu.edu/ reha/s-
dpt3 html.
[9] S. Tanaka and S. Kouno. Automatic measurement and control of the attitude
of crane lifters: Lifter-attitude measurement and control. Control Engineering
Practice, 6:1099‚Äì1107, 1998.
[10] D. H. Kim and T.-C. Tsao. A linearized electrohydraulic servovalve model
for valve dynamics sensitivity analysis and control system design. ASME J. of
Dyn. Systems, Measurements, and Cont., 122:179‚Äì187, 2000.
[11] N. Seth and K. S. Rattan. Vibration reduction in computer controlled machines.
In IEEE International Conference on Systems Engineering, Dayton, OH, 1991.
¬© 2010 by Taylor and Francis Group, LLC

A
Van Loan Exponential
Van Loan
  proposed an approach for the calculation of exponentials of block tri-
angular matrices. Consider the block triangular matrix:
P
  A1 B1
0 A2
 (A.1)
where A1 is a n
  n, B1 is a n
  m and A2 is a m
  m matrix. For t
  0, the matrix
exponential
ePt
  F1 G1
0 F2
 (A.2)
where
Fj
  eAjt
 
Gj

  t
0 eAj
 t
 s B jeAj
 1s ds  j
  1  2
  
If we force A2 to be the null matrix, we have
ePt
  eA1t
  t
0 eA1
 t
 s B1 ds
0
I
 (A.5)
If A1 and B1 correspond to the system matrix and the control inÔ¨Çuence matrix, then
the top left n
 n submatrix of the matrix ePt corresponds to the transition matrix and
the top right n
  m submatrix of the matrix ePt corresponds to the response of the
system with zero initial conditions to unit step inputs.
 Charles F. Van Loan. Computing integrals involving the matrix exponential, IEEE Trans. on Auto. Cont.,
(3):395404, 1978.
393
¬© 2010 by Taylor and Francis Group, LLC

B
Differential Lyapunov Equation
Consider the differential Lyapunov equation
ÀôP
  ATP
 PA
 Q
(B.1)
where P, A, and Q are all Rn  n dimensional matrices. Writing Equation B.1 for a
R3  3 matrix differential Lyapunov equation, in terms of its elements, we have
 
Àôp11
Àôp12
Àôp13
Àôp21
Àôp22
Àôp23
Àôp31
Àôp32
Àôp33
 
 

a11 a21 a31
a12 a22 a32
a13 a23 a33
 


p11 p12 p13
p21 p22 p23
p31 p32 p33
 
 

p11 p12 p13
p21 p22 p23
p31 p32 p33
 


a11 a12 a13
a21 a22 a23
a31 a32 a33
 
 

q11 q12 q13
q21 q22 q23
q31 q32 q33
 
(B.2)
Equation B.1 is a linear equation which can be rewritten in vector differential
equation form as



























Àôp11
Àôp21
Àôp31
Àôp12
Àôp22
Àôp32
Àôp13
Àôp23
Àôp33
 

























 


























q11
q21
q31
q12
q22
q32
q13
q23
q33
 

























 













2a11
a21
a31
a21
0
0
a31
0
0
a12 a22
 a11
a32
0
a21
0
0
a31
0
a13
a23
a33
 a11
0
0
a21
0
0
a31
a12
0
0
a11
 a22 a21
a31
a32
0
0
0
a12
0
a12
2a22
a32
0
a32
0
0
0
a12
a13
a23 a33
 a22
0
0
a32
a13
0
0
a23
0
0
a11
 a33
a21
a31
0
a13
0
0
a23
0
a12
a22
 a33 a32
0
0
a13
0
0
a23
a13
a23
2a33
 







































p11
p21
p31
p12
p22
p32
p13
p23
p33
 

























(B.3)
395
¬© 2010 by Taylor and Francis Group, LLC

396
Optimal Reference Shaping for Dynamical Systems: Theory and Applications
or for any Rn  n matrix differential Lyapunov equation (Equation B.1), the corre-
sponding vector differential equations is
Àô
P
  A P
 Q
(B.4)
where
P

 







P  : 1  P  : 2  ...
P  : n   







and Q
 








Q : 1  Q : 2  ...
Q : n   







and
A
 







AT
 a11In  n
a j1In  n
      an1In  n
a12In  n
AT
 a22In  n
      an2In  n
                        a1iIn  n
   AT
 aiiIn  n
   aniIn  n
                        a1nIn  n
          AT
 annIn  n
 






Z
 : i  corresponds to the ith column of the matrix Z .
Construct the matrix Œ® which includes the matrices A and Q and calculate the
matrix exponential resulting in the equation:
Œ¶
  exp
 Œ®T
   exp
A T
   T
0 exp
 A
 T
 œÑ
  Q dœÑ
01  n
1
 where Œ®
   A
Q
01  n 0
 (B.5)
The value of the P
 T
  matrix for any time T is given by the vector Œ¶ 1 : n  n
 1  ,
i.e., the Ô¨Årst n rows of the
 n
 1  th column of the Œ¶ matrix. This column vector can
be reshaped to construct a n
 n matrix which corresponds to P  T
 . This provides an
efÔ¨Åcient technique to calculate the solution of the differential Lyapunov equation.
¬© 2010 by Taylor and Francis Group, LLC

C
Parseval‚Äôs Theorem
The inverse Fourier transform is:
f
 t
  1
2œÄ
  ‚àû
 ‚àû
ÀÜf
 œâ
 eiœât dœâ
(C.1)
where ÀÜf
 œâ
 , is the Fourier transform of f
 t
 . Consider the inner product:
 f
 t
   f
t
 

  ‚àû
 ‚àûf
t
 f
t
  dt

  ‚àû
 ‚àûf
t
 f
 t
  dt
(C.2)
where
     is the complex conjugate of
  . Equation C.2 can be represented as:
  ‚àû
 ‚àûf
 t
 f
 t
  dt

  ‚àû
‚àû
  1
2œÄ
  ‚àû
 ‚àû
ÀÜf
 œâ
 eiœât dœâ
   1
2œÄ
  ‚àû
 ‚àû
ÀÜf
  œâ
  e
iœâ
 t dœâ
  dt
(C.3)
which can be rewritten as:
  ‚àû
 ‚àûf
 t
 f
 t
  dt

1
4œÄ2
  ‚àû
 ‚àû
  ‚àû
 ‚àû
ÀÜf
 œâ
  ÀÜf
  œâ
     ‚àû
‚àûei œâ
œâ
  t dt
 dœâ dœâ
  (C.4)
Equation C.4 reduces to:
1
4œÄ2
  ‚àû
 ‚àû
  ‚àû
 ‚àû
ÀÜf
 œâ
  ÀÜf
  œâ
   2œÄŒ¥
 œâ
 œâ
   dœâ dœâ
  1
2œÄ
  ‚àû
 ‚àû
ÀÜf
 œâ
  ÀÜf
  œâ
 dœâ (C.5)
which leads to Parseval‚Äôs Theorem:
  ‚àû
 ‚àûf
 t
 f
t
  dt
 1
2œÄ
  ‚àû
 ‚àû
ÀÜf
 œâ
  ÀÜf
  œâ
  dœâ
(C.6)
which can also be represented as:
  ‚àû
 ‚àû
 f
 t
  2 dt
  1
2œÄ
  ‚àû
 ‚àû
  ÀÜf
 œâ
  2 dœâ
(C.7)
or
 f
 t
   f
t
   1
2œÄ
  ÀÜf
 œâ
   ÀÜf
  œâ
  (C.8)
397
¬© 2010 by Taylor and Francis Group, LLC

