Green Energy and Technology
Alfeu J. Sguarezi Filho
Rogério V. Jacomini
Carlos E. Capovilla
Ivan Roberto Santana Casella   Editors
Smart Grids—
Renewable Energy, 
Power Electronics, 
Signal Processing 
and Communication 
Systems Applications

Green Energy and Technology

Climate change, environmental impact and the limited natural resources urge
scientiﬁc research and novel technical solutions. The monograph series Green Energy
and Technology serves as a publishing platform for scientiﬁc and technological
approaches to “green”—i.e. environmentally friendly and sustainable—technolo-
gies. While a focus lies on energy and power supply, it also covers “green” solu-
tions in industrial engineering and engineering design. Green Energy and Tech-
nology addresses researchers, advanced students, technical consultants as well as
decision makers in industries and politics. Hence, the level of presentation spans
from instructional to highly technical.
**Indexed in Scopus**.
**Indexed in Ei Compendex**.

Alfeu J. Sguarezi Filho · Rogério V. Jacomini ·
Carlos E. Capovilla · Ivan Roberto Santana Casella
Editors
Smart Grids—Renewable
Energy, Power Electronics,
Signal Processing
and Communication Systems
Applications

Editors
Alfeu J. Sguarezi Filho
Federal University of ABC—UFABC
Bangú, Santo André, São Paulo, Brazil
Carlos E. Capovilla
Federal University of ABC—UFABC
Santo André, São Paulo, Brazil
Rogério V. Jacomini
Ciência e Tecnologia de São Paulo—IFSP
Câmpus Hortolândia
Instituto Federal de Educação
Hortolândia, Brazil
Ivan Roberto Santana Casella
Federal University of ABC—UFABC
Santo André, São Paulo, Brazil
ISSN 1865-3529
ISSN 1865-3537 (electronic)
Green Energy and Technology
ISBN 978-3-031-37908-6
ISBN 978-3-031-37909-3 (eBook)
https://doi.org/10.1007/978-3-031-37909-3
© The Editor(s) (if applicable) and The Author(s), under exclusive license to Springer Nature
Switzerland AG 2024
This work is subject to copyright. All rights are solely and exclusively licensed by the Publisher, whether
the whole or part of the material is concerned, speciﬁcally the rights of translation, reprinting, reuse
of illustrations, recitation, broadcasting, reproduction on microﬁlms or in any other physical way, and
transmission or information storage and retrieval, electronic adaptation, computer software, or by similar
or dissimilar methodology now known or hereafter developed.
The use of general descriptive names, registered names, trademarks, service marks, etc. in this publication
does not imply, even in the absence of a speciﬁc statement, that such names are exempt from the relevant
protective laws and regulations and therefore free for general use.
The publisher, the authors, and the editors are safe to assume that the advice and information in this book
are believed to be true and accurate at the date of publication. Neither the publisher nor the authors or
the editors give a warranty, expressed or implied, with respect to the material contained herein or for any
errors or omissions that may have been made. The publisher remains neutral with regard to jurisdictional
claims in published maps and institutional afﬁliations.
This Springer imprint is published by the registered company Springer Nature Switzerland AG
The registered company address is: Gewerbestrasse 11, 6330 Cham, Switzerland
Paper in this product is recyclable.

Introduction
Contextualization Overview
In recent years, at last in two decades, the power grid has been experiencing great
transformations in its structure and operation. The Smart Grid (SG) concept is consid-
ered an evolution of the traditional energy system, including advances in communi-
cation technologies which having become possible the rise of intelligent approaches
in the grid. In a complementary way, the SGs also attend the development of the
energy generation sources, incorporating the utilization of renewable energy.
The SGs are in summary composed of a two-way infrastructure for generation and
transmission,distribution,andconsumptionofenergy,workinginparallelwithrobust
communication technologies carrying out the monitoring and control tasks of the grid
to acquire a signiﬁcant increase in efﬁciency and reliability of the power generation,
to manage the interaction between power supply and demand avoiding contingencies.
Normally, the alternative energy sources connected to the grid are from renewable
nature, as tidal, biomass, photovoltaic, and wind systems, and extending along the
grid. These sources do a direct connection to modern societal concerns regarding
high CO2 emission levels and global warming into a climate-friendly environment.
In other way, this raises obstacles for coordination and integration of the different
sources, including concerns at communication procedures.
Thus, it becomes necessary to use a reliable communication system to guarantee
an adequate monitoring and control of all system parameters’ task of interest. For an
optimized operation, SGs exploit a complete framework formed by communication
networks, data management, and real-time monitoring applications. The use of a
moderncommunicationsystemfor controllingandmonitoringthesesystems requires
a complex infrastructure for an efﬁcient operation.
The SGs management’s main purpose is to supervise the relationship between
power energy supply and demand in an efﬁcient manner. This management can
avoid grid incidences obtaining a signiﬁcant enlargement in reliability and stability
of stock and energy used.
v

vi
Introduction
In a complementary way, the ancillary services must use the SG facilities to
support the grid demands. Thus, renewable sources connected to SGs are of interest
for these services, where the SG can be a useful tool to ensure the power system
stability, for instance, managing the injection of reactive power.
Scope of the Book
As aforementioned, SGs use a modern communication infrastructure to implement
the management of generation, transmission, and energy distribution in a much more
efﬁcient manner.
In this context, the scope of this book is to show and disclose different proposal,
element, and implementations about SGs, looking for well-deﬁned point of view
about some aspects which can cover the SGs operation as a whole. For it, renewable
energy, power electronic, signal processing, and communication systems are elected
ones to reach this goal.
Thus,itisproposedasabookcomposedofaninterconnectedcollectionofchapters
which will be very useful for technical students and professionals, whose lines of
interest are in connection with SGs.
For an organized and logical sequence of the proposed technical chapters, the
book is divided into three main parts.
• Part I—Renewable Energy Sources and Systems;
• Part II—Power Electronics Analysis and Control;
• Part III—Signal Processing and Communication Systems.
Part I—Renewable Energy Sources and Systems
The main objective of this part is to present renewable energy and systems employed
inSGenvironment.ThechapterswilldescribetheenergyharvestinginSG,renewable
energy sources such as hydrogen production and storage applications. Regarding
the power systems in SG, a review of islanding detection methods for distributed
generation systems; energy management and virtual plants considering renewable
energy systems are presented.
The Part Renewable Energy Sources and Systems is composed of the following
chapters:
• “Energy Harvesting Towards Power Autonomous Sensors in Smart Grids”: This
chapter will survey the leading energy harvesting techniques for wireless power
sensors in a smart grid scenario. It focuses on mechanical, Radio Frequency, and
solar sources, presenting their basic topologies, working principles, capabilities,
and main characteristics.

Introduction
vii
• “Off-Grid Green Hydrogen Production Systems”: This chapter introduces the role
ofhydrogeninthecurrentenergysystemtransition,fromfossil-basedtorenewable
and low-carbon emission sources. Although solar and wind energies are abundant
renewable sources, the intermittence of electricity generation remains a challenge
for security of supply and causes instabilities in the electricity grid. The chapter
concludes by showing the capabilities of an off-grid water electrolyzer system,
which consists of a battery energy system and solar photovoltaic and wind power
installations.
• “Energy Storage Applications in Renewable Energy Systems”: This chapter’s
purpose of surveying is to identify and map/chart the technologies for energy
storagesystemsavailableandqualitativelyevaluatetheirapplicabilityinthepower
system considering its impact on the quality and reliability of electric power
system.
• “A Review of Islanding Detection Methods for Biogas-Based Distributed Gener-
ation Systems”: In this chapter, a review over the techniques applied for islanding
detection with synchronous machines is done, as well as an analysis of the
requirements of the Brazilian standards.
• “Distributed Energy Resources Management Systems (DERMS)”: This chapter
proposes the description of the Distributed Energy Resources Management
Systems (DERMS), as well as the motivation, main concepts, and drivers for
the comprehension and further studies on DERMS.
• “Virtual Power Plants for Smart Grids Containing Renewable Energy”: This
chapter aims to present the optimal models of Virtual Power Plants and the
challenges and solutions to their implementation.
Part II—Power Electronics Analysis and Control
The main objective of this part is to present power electronics analysis and control that
can be employed in SG environment. The chapters will describe high-performance
control methods for photovoltaic systems and electrical machines such as permanent
magnet synchronous, squirrel cage induction, and doubly-fed induction generators
for wind energy systems. In all cases, the cited systems are connected to the electrical
grid.
This Part Power Electronics Analysis and Control is composed of the following
chapters:
• “Inverter-Based Local Control Methods for Mitigating Overvoltage in Photo-
voltaic Penetrated Low-Voltage Networks”: In this chapter, four local voltage
control methods using PV inverters are presented to mitigate the voltage rise
caused by the growing installation of the PV system in LV networks. Three of
these methods use one smart control functionality of PV inverters, while the other

viii
Introduction
uses two smart control functionalities in a coordinated way. Power ﬂow simu-
lations are performed using data from a Brazilian real-world and extensive LV
network to compare the performance of these control methods.
• “Variable-Speed-Driven Three-Phase Surface-Mounted Permanent Magnet
Synchronous Machine Applied to Wind Generation Systems”: This chapter aims
to develop a theoretical base for applying surface-mounted permanent magnet
synchronous generators in wind power generation systems, and thereafter applies
this theory to a power generation system tested with computational simulation.
By the end of this chapter, the reader should be able to understand the generators’
modeling and the implications of choosing the reference frame and the back-EMF
waveform on the control of the machine and its operation.
• “Variable Speed Drives for Household Wind Energy Systems: Model Predic-
tive Control of the Squirrel Cage Induction Generator with the Nine-Switch
Converter”: This chapter develops the theoretical concepts regarding Nine-Switch
Converter (NSC) application in household wind generation with squirrel cage
induction generator. Four Predictive Current Control techniques are discussed and
compared based on simulation results. The capability to supply reactive power by
the NSC during active power generation is also studied.
• “Electromagnetic Analysis of a DFIG‘s Controlled Operation Using Finite
Elements Method”: This chapter proposes an electromagnetic analysis using
the ﬁnite element method for the Doubly-Fed Induction Generator (DFIG)-
based Wind Energy System during its vector-controlled operation by means of a
proportional-integral (PI) controller. Moreover, a new design method for the PI
controller gains is presented, based on the fact there is no guarantee that the DFIG
will operate in the unsaturated condition.
Part III—Signal Processing and Communication Systems
The main objective of this part is to present some aspects of signal processing and
communication systems at an SG environment. The initial chapters will describe
some aspects of signal processing in SGs, with an active ﬁlter implementation based
on deep neural network. After, two last chapters with experimental wireless commu-
nication system will be present showing different aspects at control and at smart city
implementation.
This Part Signal Processing and Communication Systems is composed of the
following chapters:
• “Signal Processing Technologies Applied in Smart Grids”: This chapter presents
innovative solutions based on different signal processing techniques for fault
detection, classiﬁcation, and location in power systems. The presented methods
are based on Euclidean Distance and Independent Components Analysis, proving
that more accurate and fast solutions can be reached when using the resources
availableinmodernpowergrids,implementingsmartgridconcepts.Thepresented

Introduction
ix
methods were tested against a system with real characteristics and then compared
with conventional methods.
• “Active Power Filters Applied to Smart Grids: Harmonic Content Estimation
Based on Deep Neural Network”: This chapter presents the principles of synthe-
sizing control references for an Active Power Filter (APF), which is placed
in a smart grid comprising distortion loads, aiming at achieving power quality
enhancement and compliance with standardized indexes. In addition, it is argued
that the APF control system requires harmonic content identiﬁcation to generate
the targeted compensating currents. Thus, to achieve the disturbance recognition
expected for synthesizing control references, harmonic analysis methods can be
devised by automation tools and Artiﬁcial Intelligence (AI).
• “Short Message Service System Applied in Predictive Control of Inverters
Connected to the Electric Grid in Smart Grids Environments”: This chapter
proposes a system to remotely control the active and reactive power injected into
the electrical grid based on the Short Message Service (SMS), due to its simplicity
and low-cost characteristics, inherent to the wireless communication systems. In
the proposal, the power references are sent via SMS by the SG operator to the
renewable energy source under control, with the obtained results validated on an
experimental test-bench.
• “Wireless Sensor Network for Environmental Monitoring in Smart Cities”: This
chapter presents a wireless sensor network as a solution for environment moni-
toring in smart cities that combines the usage of two Internet of things solutions,
one for measuring toxic gases, temperature, humidity, UV index, and ﬁre pres-
ence, and the other for monitoring the garbage collection by tracking the trucks
and street sweepers’ cart movements to guarantee its coverage throughout the
city. The two solutions have shown effectiveness on obtaining this information
dealing with Internet connection oscillations, making the data available through
a web application where the data can be exported.

Contents
Renewable Energy Sources and Systems
Energy Harvesting Towards Power Autonomous Sensors in Smart
Grids . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
3
Eduardo V. Valdés Cambero, Vinícius S. Silva, Humberto P. Paz,
Renan Trevisoli, Carlos E. Capovilla, and Ivan R. S. Casella
Off-Grid Green Hydrogen Production Systems . . . . . . . . . . . . . . . . . . . . . . .
37
Alejandro Ibáñez-Rioja, Georgios Sakas, Lauri Järvinen,
and Pietari Puranen
Energy Storage Applications in Renewable Energy Systems . . . . . . . . . . .
73
Fabiano Salvadori, Oswaldo Hideo Ando Junior,
Maurício de Campos, Paulo Sérgio Sausen, Eder Andrade da Silva,
André Quites Ordovás Santos, and Fernando Marcos de Oliveira
A Review of Islanding Detection Methods for Biogas-Based
Distributed Generation Systems . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
119
Alcedir Luis Finkler, Maurício de Campos, Paulo Sérgio Sausen,
Fabiano Salvadori, and Airam Teresa Z. R. Sausen
Distributed Energy Resources Management Systems (DERMS) . . . . . . . .
143
Alvaro R. Albertini, Vítor T. Yabe, and Silvio G. Di Santo
Virtual Power Plants for Smart Grids Containing Renewable
Energy . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
173
Seyed Iman Taheri, Daniela Wolter Ferreira Touma,
and Mauricio Barbosa Camargo de Salles
Power Electronics Analysis and Control
Inverter-Based Local Control Methods for Mitigating Overvoltage
in Photovoltaic Penetrated Low-Voltage Networks . . . . . . . . . . . . . . . . . . . .
197
J. Villavicencio, J. D. Melo, J. B. Leite, and A. Padilha-Feltrin
xi

xii
Contents
Variable-Speed-Driven Three-Phase Surface-Mounted Permanent
Magnet Synchronous Machine Applied to Wind Generation
Systems . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
221
José Roberto Bofﬁno de Almeida Monteiro
and Stefan Thiago Cury Alves dos Santos
Variable Speed Drives for Household Wind Energy Systems:
Model Predictive Control of the Squirrel Cage Induction
Generator with the Nine-Switch Converter . . . . . . . . . . . . . . . . . . . . . . . . . . .
247
Paulo Roberto Ubaldo Guazzelli,
Stefan Thiago Cury Alves dos Santos, and Manoel Luís de Aguiar
Electromagnetic Analysis of a DFIG‘s Controlled Operation Using
Finite Elements Method . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
277
André L. L. F. Murari, J. S. Solís-Chaves, Ademir Pelizari,
Alfeu J. Sguarezi Filho, Bruno H. P. da Silva, and Renato M. Monaro
Signal Processing and Communication Systems
Signal Processing Technologies Applied in Smart Grids . . . . . . . . . . . . . . .
299
Guilherme Torres de Alencar, Ricardo Caneloi dos Santos,
and Aline Neves
Active Power Filters Applied to Smart Grids: Harmonic Content
Estimation Based on Deep Neural Network . . . . . . . . . . . . . . . . . . . . . . . . . .
325
Claudionor Francisco do Nascimento,
Alfeu Joãozinho Sguarezi Filho,
Amilcar Flamarion Querubini Gonçalves,
Augusto Matheus dos Santos Alonso, Luiz Gustavo Reis Bernardino,
Paulo Fernando Silva, and Wesley Angelino de Souza
Short Message Service System Applied in Predictive Control
of Inverters Connected to the Electric Grid in Smart Grids
Environments . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
359
Angelo Lunardi, Alfeu J. Sguarezi Filho, Carlos E. Capovilla,
and Ivan R. S. Casella
Wireless Sensor Network for Environmental Monitoring in Smart
Cities . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
375
Bruno Sousa Dias, Cicero Matheus da Silva Lacerda,
Nailson Martins Dantas Landim, Humberto Xavier Araujo,
and Starley do Nascimento Lobo

About the Editors
Prof. Dr. Alfeu J. Sguarezi Filho was born in Cuiaba-MT-Brazil, in 1981. He
received his Ph.D. degree from Campinas University in SP—Brazil in 2010. He is
an IEEE Senior member, and he published a book, and several papers in conferences
and journals. Since 2012, he has been a full-time Professor at Federal University
of ABC—UFABC, in Santo André—SP—Brazil, teaching in the areas of Electrical
Machines, Power Electronics, and Electrical Drives.
Prof. Dr. Rogério V. Jacomini was born in Santa Barbara D’ Oeste—SP—Brazil in
1979. He received his M.S. and doctorate degrees from State University of Campinas,
Brazil, in 2008 and 2012, respectively. Currently, he is a Professor at Sao Paulo
Federal Institute of Education, Science and Technology—IFSP, Hortolândia, Brazil.
His research interests are machine drives, doubly-fed induction generators, power
control, and electrical power systems.
Prof. Dr. Carlos E. Capovilla was born in Vinhedo, Brazil, on March 06, 1977.
He received the B.S. degree from the University of Sao Paulo (USP São Carlos) in
2001, M.Sc. and Ph.D. degrees from the University of Campinas in 2004 and 2008,
all in Electrical Engineering. He is currently a Professor with the Federal University
of ABC, IEEE Senior Member, and published more than one hundred papers in
technical journals and conferences. His current research interests include microwave
circuits, planar antennas design, energy harvesting applications, and mobile systems
design for smart grids.
Prof. Dr. Ivan Roberto Santana Casella is full Professor at Federal University of
ABC and Founder and Chair of the Information and Communication Laboratories.
He holds a master’s and doctorate in Electrical Engineering from the Polytechnic
School of the University of Sao Paulo, with a doctoral internship at the Wireless
Communication Laboratory of the University of Toronto. He is senior member of
the IEEE, Associate Editor of IET Electronic Letters and author of several articles and
xiii

xiv
About the Editors
book chapters in telecommunications and smart grid areas, which have resulted in
some academic and scientiﬁc awards. Additionally, he is the main Editor of the book
Power Line Communication Systems for Smart Grids. His main areas of interest are
wireless communications, power line communications, smart grids, planar antennas
design, and energy harvesting.

Renewable Energy Sources and Systems

Energy Harvesting Towards Power
Autonomous Sensors in Smart Grids
Eduardo V. Valdés Cambero, Vinícius S. Silva, Humberto P. Paz,
Renan Trevisoli, Carlos E. Capovilla, and Ivan R. S. Casella
Abstract Wireless sensors have gained popularity in smart grids scenario, and their
increasing number, together with efﬁcient data processing and decision-making, can
optimize the entire operation of electricity generation and distribution. In order to
meet the sensor energy demand, low-power energy harvesting systems have become
a promising alternative since their principle is converting energy available in the
surrounding environment into useful electrical energy to supply low-power devices.
The advantage of this technique is the abundance and availability of ambient energy
sources that, despite having low energy density, are sufﬁcient to individually power
each intended sensor continuously, presenting similar versatility to batteries but with-
out constant replacement. In this context, this chapter intends to survey the leading
energy harvesting techniques for wireless power sensors in a smart grid scenario,
focusing on mechanical, Radio Frequency (RF), and solar sources, presenting their
basic topologies, working principles, capabilities, and main characteristics.
E. V. Valdés Cambero
Institute of Embedded Systems (InES) at the Applied Science University of Winterthur,
Technikumstrasse 9, Wintethur, Switzerland
e-mail: vale@zhaw.ch
V. S. Silva (B) · H. P. Paz · R. Trevisoli · C. E. Capovilla · I. R. S. Casella
Federal University of ABC, Ave. Dos Estados, 5001, Santo André, SP 09210-580, Brazil
e-mail: vinicius.santana@ufabc.edu.br
H. P. Paz
e-mail: humberto.paz@ufabc.edu.br
R. Trevisoli
e-mail: renan.trevisoli@ufabc.edu.br
C. E. Capovilla
e-mail: carlos.capovilla@ufabc.edu.br
I. R. S. Casella
e-mail: ivan.casella@ufabc.edu.br
R. Trevisoli
Pontifícia Universidade Católica de São Paulo, São Paulo 01303-050, Brazil
© The Author(s), under exclusive license to Springer Nature Switzerland AG 2024
A. J. Sguarezi Filho et al. (eds.), Smart Grids—Renewable Energy, Power Electronics,
Signal Processing and Communication Systems Applications, Green Energy
and Technology, https://doi.org/10.1007/978-3-031-37909-3_1
3

4
E. V. Valdés Cambero et al.
1
Introduction
The smart cities paradigm can be seen as a strategy to increase the development of
industry, public management and also contribute to increasing energy efﬁciency.
Nowadays, the desire for an intelligent society with Wireless Sensor Networks
(WSN), Internet of Things (IoT), smart grids, and smart skins, among others, is
continually growing. IoT is becoming popular not only due to the emergence of
disruptive technologies; but also due to the evolution of available technologies into
more accessible solutions, enabling mass adoption.
The smart control and monitoring of processes, enabling bi-directional communi-
cation and an early diagnosis of possible failure or maintenance, is already adopted
as the strategy to speed up the evolution of traditional power grids into smart grid
generation. The rapid assimilation of new technologies can generate many devices
connected to the cloud in the power grid environment. Sensors can collect informa-
tion about the power line conditions such as temperatures, defects on the conductor,
voltage, current, humidity, or atmospheric pressure. The information recorded is typ-
ically sent to a control center in the cloud to be processed. However, the trend in the
state-of-the-art (SoA) is to improve data processing at the sensors level to reduce
the energy consumption in data transmission/reception routines. Regardless of these
solutions are showing a continuous trend to lower the required power, still ensuring
the energy required for its operation brings some technical or ﬁnancial challenges
due to its number and locations with difﬁcult or risky access.
Batteries dominate the energy suppliers and storage market in low-power appli-
cations due to their sizes, satisfactory cost-beneﬁts, efﬁciency, and well-established
manufacturing industry. However, they are characterized by the need for replacement
and the high environmental pollution in the waste. Once batteries reach the end of
their lifespan, they need to be replaced, becoming waste with a high environmental
cost due to the nature of their component materials. Therefore, the battery operating
time is a drawback that affects the cost of maintenance (related to replacement) and
the logistics for the waste treatment, having the conditioning that the greater the
number of devices, the higher the logistic and maintenance cost in the solution [1].
An approach to revert these inconveniences is to research and develop technologies
for energy scavenging from surrounding environment sources as an alternative to
reduce or even eliminate battery dependence.
Low-power energy harvesting is a process through which surrounding energy
of different natures is converted into electrical power that can be conditioned
to energize ultra-low-power devices. The energy sources more commonly
exploited are solar, thermal, mechanical (vibration or acoustics), and elec-
tromagnetic (EM) waves. A more comprehensive concept can include some
variation of these primary sources, like a hybrid integration of two or more of
them or the intended generation of a particular source and its transmission to
an optimized receptor, like the case of Wireless Power Transmission (WPT).

Energy Harvesting Towards Power Autonomous Sensors in Smart Grids
5
While analyzing the main energy harvesting sources applied in smart grid envi-
ronments, a particular characteristic is observed. The grid parameter nature to be
controlled or sensed determines the location of the low-power device to be energized.
Consequently, the ﬁnal site has an important role in deciding which energy source can
be employed. For example, speciﬁc power line conditions are measured with sensors
attached directly to high-power conductors, which makes the EM energy radiated
by the conductor suitable as the energy source. Another scenario can be found in
indoor substations where solar energy or another light source might be insufﬁcient.
Here, RF or vibration energy might be considered. In short, positioning sensors or
actuators also sets constraints and requirements for the energy harvesting source.
Objectives of the Chapter
This chapter aims to present different energy collection mechanisms that have been
proposed in the literature to support power to wireless sensors and actuators oper-
ating within power grid ecosystems. For this, in Sect. 2, we start by presenting a
general topology of self-powered devices and the role played by the energy har-
vesting system (the energy source) in smart grid devices. In Sect. 3, the SoA of the
energyscavengingprocessappliedtomodulesforcontrolandmonitoringfunctionsin
smart grid scenarios is analyzed. Several methods for harvesting surrounding energy
in smart grid environments proposed in the literature are presented, detailing their
working principles, capabilities, and main characteristics. Finally, Sect. 4, concludes
this chapter.
2
Self-powered Devices
Energy-autonomoussystemscollecttheoperatingpowerbysurroundingenergyscav-
enging. The possibility of designing long-term and maintenance/replacement-free
devices by leveraging energy-harvesting technologies generates new applications
for embedded systems. Energy-autonomous systems, also known in the literature
as Autarkic systems, are limited in power budget with functionality and lifetime
determined by the utilization and the power available, either in terms of energy
stored or harvested from the environment. Based on the above principle, a com-
plete system approach, considering three fundamental aspects as energy harvesting,
energy management, and energy consumed by the application, becomes necessary
and demonstrates that the system must be designed for energy harvesting.
A low-power wireless device with energy scavenging capabilities can be typically
sketched as shown in Fig. 1. The diagram shows that different energy sources can
be used to energize the device, including the possibility of complementary hybrid
approaches.
The Power Management Unit (PMU) might include a DC-DC converter, checking
routines of the stored energy level, or maximum power tracking algorithms depend-
ing on the energy source driving the system and the management strategy. PMUs can
optimize the level of collected power by managing the load duty cycles, controlling

6
E. V. Valdés Cambero et al.
Fig. 1 Block diagram of a
generic low-power wireless
sensor/actuator device
integrating energy harvesting
capabilities
Hybrid
the charging times, and regulating the microcontroller’s operating modes. Superca-
pacitors and batteries are the typical storage devices employed in low-power energy
harvesting systems. Supercapacitors are electrochemical double-layer capacitors that
appear more commonly in some applications and projects because they have shorter
charging times and higher charge and discharge cycles. However, batteries possess
a settled technology and a higher energy density, allowing more capacity for a given
space occupied by the circuit components.
The Microcontroller Unit (MCU) performs the interface of the sensor or actuator
and the communication block routines. Together with the PMU, it can also be used
to manage the energy within the system. MCU has three modes of operation: Power
up, Sleep, and Active. In Power-up mode, the MCU waits for the voltage levels to
exceed the start-up values and thus starts its operation. In sleep mode, it waits for an
external interrupt to arrive from the sensor to be serviced or from the storage system
in case it is being used as a power manager. Finally, in Active mode, it is listening
for an interruption.
3
Energy Harvesting Techniques for Self-powered Devices
in Smart Grid Environment
Within the group of power sources available in the surrounding environment, solar
energy stands by its superiority in terms of power density, availability, and the suit-
ability of a Solar Cell (SC) as a long-term power source. Different SC technologies
have recently attracted considerable attention as a source for low-power consumption
electronic products due to the rapid growth of the IoT, which requires covering the
power demand of a high number of wireless powered/connected terminals. Besides,
the production levels of SC panels have experienced a high increase in the last 20
years, reaching both outdoor and indoor applications. Its fabrication technology is

Energy Harvesting Towards Power Autonomous Sensors in Smart Grids
7
well-instituted, and the main raw material is silicon, which also enjoys signiﬁcant
development thanks to the microelectronic industry. The previous elements place
solar energy as a potential candidate to complement or substitute the energy from
batteries in low-power applications. In the literature, the main efforts related to SC
for low-power applications are directed to obtain photovoltaic materials with an
improved power conversion efﬁciency and smaller/adaptable form factor, especially
under low irradiance levels and optimized for more common wavelengths of indoor
light sources [2].
However, the SC as an energy source has the disadvantage that its energy pro-
duction varies proportionally with the values of the available power density coming
from the light sources. In the case of sunlight, the power density depends on geo-
graphical location and the sun’s position during daylight. Low power densities can
also be produced by shadowing effects or night periods in outdoor environments
or due to the absence of natural or artiﬁcial light indoors. These problems cause
the power supplied to the device to drop, and its operation can be compromised.
From the system design and integration point of view, the ongoing research of solar
or hybrid-powered sensors (including solar energy) is focused on maximum power
point tracking (MPPT) algorithms and adaptive policies for activation, communica-
tion, and power management [3].
EM energy is another power source to be considered nowadays. The energy trans-
mission process from the source to the receptor can be classiﬁed into two groups
according to the nature of the power sources:
• Wireless Power Transfer (WPT) with dedicated beacons or,
• Undedicated EM Energy Harvesters (EMEH).
Unlike EMEH, WPT classiﬁcation is used for applications in which the energy of
a dedicated beacon is strategically directed to the receptor. At present, the outdoor
and indoor environments have the necessary infrastructure to operate various RF
systems. These systems transmit RF signals in several frequency bands and with
different power intensities. The signals of services such as WiFi (Wireless Fidelity),
Wireless Local Area Networks (WLAN), ZigBee, Bluetooth, GSM (Global System
for Mobile communications), and LTE (Long-Term Evolution) can be easily found
relatively ubiquitously spread out. Speciﬁcally in grid environments for high power
generation and transmission, a considerable among of radiated power can be found
in the vicinity of the conductors. Collecting/receiving EM energy and converting it
into an exploitable DC level can be done by using a combination of an antenna and
a rectiﬁer circuit (rectenna) or by converting the EM waves into mechanical energy
by placing an intermediate power transducer. The resulting mechanical energy can
then be re-converted to the desired DC level.
Mechanical energy harvesting devices for low-power solutions can produce elec-
tricity from induced mechanical movements varying in intensity and periodicity.
The origin of the mechanical perturbation dictates the transducer’s nature to be
used, which can be divided into three well-established transduction mechanisms:
piezoelectric, electromagnetic, and electrostatic generators. More recent efforts have
demonstrated the possibility of extracting energy from the dislocation of parallel

8
E. V. Valdés Cambero et al.
capacitors plates using electret materials as the dielectric between the plates [4] or
harnessing the triboelectric effect as energy source [5].
3.1
SoA of Energy Harvesting Solutions Applied to Smart
Grid
When studying possibilities of energy harvesting to power up sensors or actuators for
controlling or monitoring grid systems, a priming idea comes to the table: collecting
the energy radiated by the grid itself. In addition, the source of power is relatively
constant, only interrupted in case of absence of the power in the line [6]. Several
techniques have been proposed to take advantage of the considerable power present
in the surrounding areas of the grid conductors. These different approaches can be
divided into two major groups: clamped and free-standing harvesters [7]. The most
widely used clamped harvester is the Current Transformer (CT) [3, 8–10], which
is based on a magnetic core in the near vicinity of the line. However, its bulky
structure hinders the integration of more miniaturized wireless sensor systems. The
coil dimensions tend to increase, affecting the whole system form factor due to
the constraint of being correspondent to the range of the current ﬂowing in the
transmission line conductor [11]. Energy harvesting from the radial ﬁeld produced
by the high-power transmission line can be implemented coexisting with RF energy
harvesting [10, 12] in the environment surrounding the conductors or substations.
The harvesters of EM waves radiated by the transmission lines use rectiﬁer circuits
with different constraints than the design consideration of RF rectiﬁers [12].
An alternative to the bulky CT is the cantilever beam with a magnet attached
to the tip [3, 13]. This technique uses magnets as an intermediate transducer that
are displaced by the line EM ﬁeld at the oscillating frequency of the current in
the conductors. Then, the piezoelectric material of the beam is stressed with the
displacements producing electrical energy from which can be harvested between 100
and 850 μW. In [14], the authors proposed a cantilever encapsulated in a vacuum to
reduce the mechanical damping due to the beam’s interaction with the air. On the
other hand, cantilever beams can lose the piezoelectric properties with the time of
use [11].
SCs are commonly leveraged as an energy source in the grid environments [9]
due to their higher instantaneous power densities; however, the power delivered is
signiﬁcantly affected by the hour of the day, the weather conditions (clouds, snow,
temperature) or eventually partial shading effects. The direct consequence of the
mentioned phenomenons is a reduction or total suppression in the irradiance level of
the light impinging the exposed photovoltaic area. From the system design point of
view, these ﬂuctuations in the delivered energy can be sorted by optimizing power
management and storage strategies or integrating SC modules with EM energy har-
vesters as a complementary energy source [9, 15].

Energy Harvesting Towards Power Autonomous Sensors in Smart Grids
9
The following table presents a selection of energy harvesting solutions applied
to SG sensor and monitoring problems. The selected works aim to summarize pro-
posals with recently implemented and experimentally validated energy harvesting
generators in the SG ecosystem. Since data transmission has an important role in
total power consumption, this selection also includes articles that collect data and
send it to a different platform for processing and decision-making. The transmission
can be done wireless or using high-power conductor lines.
References
Energy
source
Application
Communication
technology
Location
Harvested-
consumed
parameters
Sun
et
al.
[16]
Solar
Pressure-
Sensor
RFID
Stand alone
15 mA-for
730
ms
every
30
min
Luo
et
al.
[10]
EM & RF
Fault-
Diagnosis
RFID
Conductor-
Attached
0.54–0.68
V at recti-
ﬁer’s input
Pehlivanoglu
et al. [17]
EM
–
BPSK-
Modulationa
Stand
Alone
40 mJ har-
vested in 15
min
Wang et al.
[8]
Piezo
Current-
Sensor
–
Conductor-
Attached
8.68 mW in
30A-line
Faheen et al.
[12]
EM & RF
Fault-
Detection
TinyOS Mica2
Stand
Alone
Wiﬁ
33
mW.
EM
285 mW at
1K load
Zhuo et al.
[9]
EM & Solar
Wind Speed
Sensor
Connected
to-
PC
Conductor-
Attached
Solar
4.8
mW.
EM
4.6 mW
Parejo et al.
[18]
EM
Fault-
Detection
PLC Modem (S-
FSK)
52 mA
Conductor-
Attached
Yuan et al.
[11]
Electrostatic
Temperature
Sensor
Alarm-System
Conductor-
Attached
0.78
mW
maximum
for 30 M
load
aImplemented as a numerical model
3.2
Mechanical Energy Sources
Mechanical energy is present in nature in a diverse group of physics phenomenons
such as kinetics, in the form of translations or rotations, as mechanical potential in
the movement of a force ﬁeld and elastic deformation, as periodic changes between
potential, and as mechanical impulses. In the grid environment, low-frequency vibra-
tion can be observed in the power lines produced by the interaction with the wind.
Mechanical oscillations can also be generated by magnets periodically dislocated
by the EM ﬁeld radiated by the high-power conductors. Other vibration sources can

10
E. V. Valdés Cambero et al.
Fig. 2 Model diagram of a
mechanical oscillating
system. The seismic mass
can be excited by the
movements of the frame or
the seismic mass itself
Sismic
Mass
bm
bel
Mechanical
Spring
Frame
be found in the substation locations, such as those produced by working engines,
pumps, or refrigeration systems. At the beginning of Sect. 3, the main processes to
convert mechanical perturbations into electrical energy was mentioned. Within this
group, the piezoelectric and electrostatic effects have the particularity that can be
used as intermediate transducers to convert the mechanical energy present in mag-
nets inserted in variable magnetic ﬁelds into electric energy proﬁtable for energizing
low-power devices.
3.2.1
Harmonic Mechanical Oscillator
These schemes can be abstracted to a mechanical resonant model based on the dom-
inant frequency of their oscillations. Figure 2 shows the model diagram, composed
of a mechanical spring with a spring constant denoted by k, a seismic mass attached
to the spring, and the losses, which are represented as clamping coefﬁcients for elec-
trical (bel) and mechanical energy (bm). All components are inserted into a frame
housing the system.
The system generates energy excited by vibrations happening in the frame,
ampliﬁed and transmitted to the seismic mass by the spring, and then converted
to usable electric power. Since the maximal amplitude of the seismic mass
movement occurs at the resonance frequency, the maximal energy extraction
is conditioned by this frequency; hence, the system should be tuned to optimize
the harvesting process.
At the same time, there is a trade-off in the quantity of energy extracted from
the system. The more the harvested power, the more kinetic energy is subtracted
from the moving seismic mass, which can eventually stop the movement, making
it impossible to obtain further energy. Hence, the system should be optimized to
achieve an electrical damping (ζel) equal in value to the mechanical damping (ζm).

Energy Harvesting Towards Power Autonomous Sensors in Smart Grids
11
Quality Factor
The quality factor (Q) in the harmonic mechanical oscillator model indicates the
quantity of energy the seismic mass can store. Q deﬁnes the ratio between the max-
imal amplitude of the seismic mass movement and the excitation amplitude at reso-
nance. The amplitude of the seismic mass movement can be calculated as follows:
|Z| =
ω2|Y|

(ω2o −ω2)2 + [2(ζel + ζm)ωoω]2
(1)
where ω and ωo are the angular and the angular resonance frequencies, respectively.
|Y| is the amplitude of the excitation, and ζel + ζm = ζT represents the total damping
factor as the sum of the electrical and the mechanical damping factors. At resonance,
ω = ωo, then:
Q = |Z|
|Y| =
1
2(ζel + ζm)
(2)
From Eq. 2 can be seen that a higher Q can be achieved by reducing the total
damping factor in the system. Consequently, the average power dissipated by the
dampers is [19]:
Pav =
mζT |Y|2 ω
ωo
3ω3

1 −
 ω
ωo
22
+

2ζT
 ω
ωo
2
(3)
where m is the seismic mass. The limits in the power extraction of the model are
conditioned by the resonance stage where Pav turns:
Pmax = m|Y|2ω3
o
4ζT
(4)
demonstrating that the extracted power is directly proportional to the resonance
frequency.
3.2.2
Piezoelectric Generators
The generation of electrical energy via the piezoelectric effect is explained as the
charge displacement due to the mechanical deformation of the material in an asym-
metric piezoelectric lattice. Straining, stressing, or distorting the material produces
the charges’ vertical or horizontal dislocation. The longer the electrical displace-
ment, the higher the energy available to be harvested. Material parameters such as
the dielectric constant and the piezoelectric strain coefﬁcient are directly related to the
freedom for charge dislocation and are proportional to it. Another critical parameter
is the piezoelectric coupling coefﬁcient, quantifying the system’s ability to produce

12
E. V. Valdés Cambero et al.
Z
Z=0
movement
under
external force
ﬁxed
edge
X
magnet
metal
electrode
piezo
disk
stiffening
layer
load
Fig. 3 Diagram of a cantilever beam with a magnet attached to one edge. The stiffening layer
guarantees the generation of a unidirectional stress in the piezo disk
electrical energy as the squared ratio of the electrical energy stored to the mechanical
energy applied [20].
Piezoelectric energy harvesting systems applied into a grid environment often
use magnets ﬁxed to a cantilever to generate mechanical oscillations out of the
EM radiation coming from the conductor lines. Figure 3 present a diagram of the
hardware. In this case, the piezoelectric generator (cantilever) is used as the spring
of Fig. 2 attached to the seismic mass (magnet). The electrical power is collected
by metal electrodes stacked on the piezo and stiffening materials and transferred to
the load. The position of the beam/magnet structure with respect to the orientation
of the magnetic ﬁeld deﬁnes the direction of the mechanical stress applied to the
piezoelectric beam during the excitation.
Electrical Equivalent Circuit Model
The electromechanical problem represented in Fig. 3 can be modeled in the electrical
domain, and the optimal load can be obtained by impedance matching approach in
an equivalent circuit model [20–23]. A piezoelectric energy harvester operating at
its resonance frequency can be deﬁned as a linear single-degree-of-freedom model
using the following:
fext(t) = m ∂2w
∂t2 (t) + C ∂w
∂t (t) + Kw(t) + θνp(t)
(5)
q(t) = θw(t) + C pνp(t)
(6)
where fext is the externally applied force, w is the beam temporal displacement with
respect to the ﬁxed edge, C is the damping, K is the stiffness, θ is the electromechan-

Energy Harvesting Towards Power Autonomous Sensors in Smart Grids
13
Fig. 4 Electromechanical
problem of a piezoelectric
beam assuming linear
single-degree-of-freedom
being modeled as an
equivalent electrical circuit
model
ical coupling, q is the charge, C p is the effective capacitance between the layers and
νp is the voltage as a function of time. fext in terms of the acceleration of clamped
boundary condition a(t) can be expressed as:
fext = a(t)D
(7)
where D is the effective input mass [20]. Hence, by substituting Eq. 7 in Eq. 5,
dividing all the expression by θ and treating the derivatives, Eq. 5 can be rewritten
as:
νeq(t) = m
θ2 ˙ieq(t) + C
θ2 ieq(t) + θ2
K ieq(t) + νp(t)
(8)
where νeq(t) = a(t)D and ieq = θw(t). Equation 8 can be seen as Kirchhoff’s Law
of the voltage in the mesh I of the circuit of Fig. 4. Here:
Ls = m
θ2 ; Rs = C
θ2 ; C = θ
K
(9)
Finally, Eq. 6 characterizes the equivalent current expressed as follows:
ieq(t) = ˙νp(t)
C p
+ i p(t)
(10)
The electrical circuit model of the piezoelectric beam allows the application of
the impedance matching principle for maximal power transfer from the source to the
load. Previously, the system has been parameterized, and it can be further optimized
by complex-conjugated matching between the source and the load. In that way, since
resistive energy harvesting systems have zero reactance at the resonance frequency,
the optimal resistance can be found as follows:
Ropt =
1
wC p
2k2ζ 2
T
4ζ 2
T + k4
(11)
where the dimensionless variables damping ratio and effective electromechanical
coupling coefﬁcient are deﬁned as follows:

14
E. V. Valdés Cambero et al.
ζT =
C
2
√
Km
; k2 =
θ2
C pK
(12)
3.2.3
Electromagnetic and Electrostatic Harvester
Mechanical harvesters using EM or electrostatic principles are based on employing
mechanical movements to variate the electric or magnetic ﬁeld distribution within
parallel metallic plates or conductors in the form of a coil. Faraday’s law of induction,
presented in Eq. 13, states that the movement of a loop conductor, changing the
magnetic ﬁeld traversing its enclosing area, can produce an electric current on it. The
current can be created either by displacement of the coil or the source of the magnetic
ﬁeld. On the other hand, varying the distance between metallic plates changes the
redistribution of electric charges in a variable capacitor.
Electromagnetic generators
An induced voltage can be generated across two coil terminals by varying the mag-
netic ﬂux within the loops of the conductor. Equation 13 shows the relationship,
where the induced voltage U is directly proportional to the number of turns in the
coil N. As mentioned above, the electrical energy can be harvested with a moving
magnet or coil; however, the former has the advantage of ensuring ﬁxed electrical
connections, which makes it more robust against aging. In addition, the total weight
of the moving mass is smaller.
U = −N dφ
dt
(13)
The efﬁciency of the harvesting process can be improved by integrating the same
system: a permanent coil and a moving magnet attached to a cantilever beam used as
the spring. Thus, mechanical energy will change the magnetic ﬂux through the coil
loops while stressing the piezoelectric material of the cantilever beam. Consequently,
the total harvested power will increase. Applying the harmonic mechanical model
described in Sect. 3.2.1, maximal power can be extracted by making:
ζm = ζel =
k2
2mwo
·
1
Ro + RL
(14)
Here, Ro and RL are the coil and load resistance, respectively. k is the electromagnetic
coupling coefﬁcient deﬁned as the ratio between the induced voltage U and the
velocity of the seismic mass z′. Solving U and substituting
U 2
Ro+RL in Eq. 14, the
maximum delivered power can be found as:
Pmax = 2 · ζel · m · wo · z′(t)2
(15)

Energy Harvesting Towards Power Autonomous Sensors in Smart Grids
15
Electrostatic generators
The energy harvesting process with electrostatic generators can be explained through
a capacitor with variable capacitance Cvar depending on the instantaneous distance
between its plates. The possibility of mechanically changing the capacitance by
moving the plates allows it to act as a transducer supplying electrical energy to a
second capacitor that stores the scavenged power, which will then be worked on
the load. When Cvar is altered, the charge distribution is modiﬁed following two
approaches.
The ﬁrst one is voltage constrained, where the plates are approached a speciﬁc
distance achieving maximum capacitance (Cmax), then the capacitor is charged up to
the maximum voltage (Vmax). The external force is harnessed to separate the plates,
decreasing the capacitance. Since the voltage is constrained to Vmax, the charges will
ﬂow, generating the electricity. Assuming the minimum capacitance (Cmin) happens
at the maximum possible separation, then the electrical energy extracted will follow
the expression:
EV OL = 1
2(Cmax −Cmin)V 2
max
(16)
The second method charges a variable capacitor up to an initial voltage (Vo), sep-
arating the plates to a maximum distance, decreasing the capacitance and increasing
voltage. This harvesting variant is known as the charge-constrained method. At the
maximum plate displacement, the capacitor is open-circuited and should be short-
circuited to transfer the charges to a second capacitor for storage. In this case, the
obtained energy is:
EC H = 1
2(Cmax −Cmin)VoVmax
(17)
It can be intuitively noted that the voltage-constrained approach eventually deliv-
ers more energy due to Vmax being higher than Vo. Nonetheless, initially charging
to a maximum voltage requires using an external voltage source that supplies this
initial voltage.
3.3
Low-Power Solar Cells Fundamentals
The energy emanating from the sun that reaches outside the Earth’s atmosphere is
estimated at approximately 1400 W/m2, characterized by the magnitude Irradiance.
The atmosphere then absorbs part of this energy, and the resultant power density
over the Earth’s surface is assumed as 1000 W/m2. Using this inexhaustible source of
power, generated without environmental pollution, is possible due to the discovery of
the photoelectric effect. This phenomenon, observed by Heinrich Hertz in 1887 [24],
is a primary optical principle in which photons hit a photovoltaic surface (typically on

16
E. V. Valdés Cambero et al.
photosensitive semiconductors) with enough energy to make the electrons jump from
the valence band to the conduction band. The charge movement produces electric
power that can be harvested at any location on Earth but is subjected to constraints
associated with the daytime and the sun’s position, the latitude of the harvesting site,
and weather conditions.
As the mass manufacturing cost of electronic components and SC technologies is
going down, using solar energy as a power source for WSN and IoT devices, among
others, has become an affordable and good cost-beneﬁt solution. The SC technology
represents a suitable choice for capturing renewable and environmentally friendly
energy to supply low-energy devices, which often operate in conditions of low solar
lighting or artiﬁcial lights with variable wavelength spectrum.
The optimal performance of a SC is tested following Standard Test Conditions
(STC), grouping parameters the Air Mass coefﬁcient equal to 1.5, a power density
of 1000 W/m2 and 25◦C surrounding temperature (approximately 298 K). However,
operation under STC can be ensured only in a controlled lab environment or in short
time frames in outdoor measurement sites. A signiﬁcant concern related to the energy
coming from natural or artiﬁcial sources is that the supplied power is not always
constant, so appropriate precautions must be taken to guarantee the correct operation
of the device to be powered. Also, the illumination levels in indoor environments
are inferior to outdoors, with a reduced and narrow band wavelength diversity when
compared with the light from the sun. Most of the light sources currently used in
interior lighting are ﬂuorescent lamps, incandescent lamps, and white Light-Emitter-
Diode (LED) lamps. They emit light with wavelengths in the range of 350 nm to
750 nm, which is broader than the visible spectrum of the human eye. Hence, different
SC materials have different absorption coefﬁcients associated with the wavelengths
for which the SC is sensitive. In addition, available power densities are deﬁned by
the distance from the light source or by the possibility of obstacles blocking the light.
SCs can be built in different shapes and employ different types of semiconduc-
tors. Silicon is the most used and can be found in monocrystalline, polycrystalline,
or amorphous varieties. One parameter that strongly inﬂuences the amount of power
generated by a SC is the type of semiconductor material and which part of the wave-
length spectrum is more photosensitive. As sunlight contains various wavelengths,
a technique to optimize the amount of energy extracted is to stack different photo-
sensitive materials working on more bands of the spectrum at the same time. Most
commercial SCs are based on mono, and polycrystalline silicon wafers fabricated
using the same silicon as raw material. However, the production process for poly-
crystalline cells is cheaper than the monocrystalline process. Consequently, the ﬁnal
product presents higher impurities and lower efﬁciency. A recently developed and
exploited technology with several solutions already established in the market is the
named thin-ﬁlm SC [25]. This technology can be separated into three main groups:
organic, Dye-sensitized, or perovskites, depending on the material’s nature.
Typical SC structures, as seen in Fig. 5, consist of a silicon wafer sandwiched
between two terminals, with an anode as the positive contact and a cathode as the
negative. In most cases, the cathode is a solid sheet of conductive material, and the
anode is a grid made up of ﬁngers with an optimized number, width, and separation,

Energy Harvesting Towards Power Autonomous Sensors in Smart Grids
17
Fig.5 TypicalstructureofaSC.Thehigherthenumberofbusesandﬁngers,thesmallertheparasitic
resistances opposing the circulation of the generated current. However, the negative terminal is
placed over the photosensitive surface, reﬂecting some photons before the semiconductor material
can absorb them
aiming to achieve a good agreement between the area of the photovoltaic surface that
is blocked by the ﬁngers, and the parasitic resistances of the SC.
3.3.1
Solar Cell Characterization
In practice, a SC can be modeled as an ideal current source, connected to a shunt
diode representing the recombination current in the quasi-neutral region of the PN
junction. A more accurate model can include a second diode in parallel, representing
the recombination in the depletion region; however, the One-diode model is preferred
due to its simplicity and satisfactory approximation to the reality [27]. In Fig. 6,
Iph, Id, and Ipv, respectively, represent the SC photo-generated current source, the
diode current and the output current of the cell. Rsh and Rs are the equivalent shunt
and series resistance, being Vo the output voltage of the SC. The derivation of the
equivalent circuit model in a real SC is subjected to the experimental obtaining of
its current and voltage characteristic curves.
Fig. 6 One-diode equivalent circuit model of a SC published in [26]. The current source drives the
circuit, whose value depends mainly on the irradiance level and temperature

18
E. V. Valdés Cambero et al.
Using the One-diode model, Eq. 18 characterizes the current ﬂowing through to
the diode, and Eq. 19 is the general expression for the current produced by a SC.
Note that the SC generates current until Vo is higher than VT . At this point, the diode
is directly biased, and the Id increases, making Ipv drop.
Id = Isat

e
Vo
AVT Ns −1

(18)
Ipv = Iph −Isat

e
Vo+Ipv Rs
AVT
−1


	

Id
−Vo + Ipv Rs
Rsh
(19)
In the last equations, Isat is the dark saturation current, A is the semiconductor ideality
factor, VT is the voltage threshold of the semiconductor, and Ns is the number of SCs
thatcomposethephotovoltaicmodule.Byknowingthesemiconductorcharacteristics
andhavingtheSC’sexperimentalVoltageandCurrentcurves,eachofthecomponents
in the equivalent circuit can be derived mathematically.
Current and Voltage (I-V) Curves
The current-voltage (I-V) characteristic of a generic SC is plotted in Fig. 7, and
it illustrates the principal ﬁgures-of-merits for SC. These parameters are the
Maximum Power Point (MPP), with its associated voltage and current (Vmp
and Imp), the short-circuit current (Isc), and the open-circuit voltage (Voc). The
energy conversion efﬁciency ηSC evaluates the energy sources performance,
and it is deﬁned by the ratio of the maximum converted power to the radiation
power impinging the photovoltaic surface:
ηSC = ImpVmp
Gi Apvs
(20)
where: Gi is the irradiance at operation condition, and Apvs is the area of a SC
exposed to the light.
In laboratory environments, the Gi values can be generated with a calibrated Solar
Simulator to obtain the desired operation points according to the irradiance levels.
A generic block diagram and a picture of a characterization setup can be seen in
Fig. 8. Solar simulators using beam canons have the disadvantage of guaranteeing
homogeneous light with the desired irradiance level at a restricted area which must
cover the entire SC. This type of Solar Simulator (e.g., the Newport 96000) is more
common in researching new materials to design new SC technologies. Once the SC
is illuminated, its I-V curves can be extracted with a Precision Source/Measure Unit.

Energy Harvesting Towards Power Autonomous Sensors in Smart Grids
19
Fig. 7 Current and power
curves against voltage for a
generic SC. The dotted curve
represents the variation of
the current, and the solid one
represents the power
behavior, published on [28]
Laboratory characterization of the SC shall be done under controlled temperature,
typically at 298 K.
Another essential parameter is the ﬁll factor (FF), deﬁned in Eq. 21 as the ratio
of the maximum power produced by a SC and the ideal maximum power found by
multiplying Isc and Voc:
F F = ImpVmp
IscVoc
(21)
Satisfactory FF values are estimated between 60 and 85% [29]. A higher FF results
from a Rs value closer to zero and a Rsh with an elevated resistance, representing a
quantitative tool to assess the SC quality.
3.3.2
Maximum Power Point Tracking
The analysis of SC performance is conditioned by estimating the possible delivered
power according to external inﬂuences. Climate changes such as the presence of
clouds, variation in irradiance and temperature due to the hour of the day, or partial
shading effect are examples of phenomena that provocate variations of the power
generated by the SC. The maximum power point will oscillate for each situation,
changing the power conversion efﬁciency. A way of guaranteeing in every moment
the extraction of the maximal possible energy is the implementation of MPP Tracking
(MPPT) techniques. MPPT methods continuously sense the voltage and current at the
SC output and manipulate its load to ﬁnd the optimum extracted power. In low-power
applications, the most commonly used algorithms are the Fractional Open-Circuit
Voltage (F.OCV) and the also known as Hill Climbing techniques: Perturb-and-
Observe (PO) and Incremental Conductance (IC) [30].
F.OCV is based on knowing the SC Voc and adjusting the load to obtain an output
power at 70 to 80% of the power for Voc. This 0.7–0.8 ratio is ﬁxed and can be
straightforwardly set by hardware or software. However, although this method has
low complexity for its hardware or software implementation, the tracking ability is
reduced due to the heavy dependence on the SC’s Voc. Hill Climbing techniques

20
E. V. Valdés Cambero et al.
Fig. 8 a Block diagram of a generic characterization setup to extract I-V curves of SC. Solar
Simulators can also be found in the form of irradiance chambers where a wider area can be irradiated
at a speciﬁc and homogeneous irradiance level, published on [28]. b Picture of a laboratory setup
for SC evaluation using a beam cannon published on [26]
have a better tracking ability since they ﬁnd the maximum power by comparing to
a previous stage after an increment (PO case) or by ﬁnding where the power curve
derivative, as a function of the voltage at the output, is equal to zero (IC case).
3.3.3
Temperature Inﬂuence on the SC MPP
One external condition affecting the SC output power is the temperature variation in
thevicinityofthephotovoltaicmaterial.AstheSCtemperaturecanchangedepending
on the environment where it is located, it can result in a deviation from the typical
298 K speciﬁed in the STC. SC modules used for energy harvesting are intended to
operate under low-power conditions. A shit of the SC MPP is a direct consequence

Energy Harvesting Towards Power Autonomous Sensors in Smart Grids
21
of the mentioned ﬂuctuations, which might displace the available DC voltage level,
compromising the continuous operation of the application.
Looking at the SC equivalent circuit (Fig. 6), the variation of the output current
as a function of the temperature is expressed in Eq. 19 by Iph and Id. The thermal
voltage is Vt = kT/q, where T is the ambient temperature in Kelvin, k is the constant
of Boltzmann, and q is the electron charge. In the circuit of Fig. 6, Iph is represented
as an ideal current source whose value remains constant if there is no variation of
the irradiance or the temperature. Nevertheless, its behavior is described by:
Iph =

Isc + ki(T −Tref )

Gi
Gref
(22)
where: ki is the short-circuit temperature coefﬁcient. The Tref and Gref are the
reference irradiance, and temperature for the conditions analyzed, typically for STC.
Equation 22 models the ideal current Iph and the temperature can be swept while
recording the values of Imp, Vmp, and Pmp. The temperature reduces the bandgap
energy (Eg) of the material increasing Isc [31]:
Eg(T ) = Eg(0) −
αT 2
T + βt
(23)
where: Eg(0) is the 0 K bandgap energy. α and βt are semiconductor material con-
stants. On the other hand, Voc is decreasing at a higher rate than the current increment.
Hence, the lower the Eg, the higher the intrinsic carrier concentration, increasing Isat
and affecting Voc.
The relation between Voc and the Isat can be found as:
Voc = kT
q ln
 Isc
Isat

(24)
and
Isat = q As
D f n2
i
LcND
(25)
where: As is the area of the semiconductor material, D f is diffusivity of the minority
carriers, Lc is the minority carrier diffusion length, ND is the doping of the semicon-
ductor and ni is the intrinsic carrier concentration. In Eq. 25, D f , L, and ni depend
on temperature variations. However, the biggest effect is caused by the inﬂuence of
ni since it is a power of 2 and directly depends on T . Then, the square of ni can be
calculated as:
n2
i = 4
2πkT
h2
P
3 
m∗
em∗
h
 3
2 e

−Eg(0)
kT

(26)

22
E. V. Valdés Cambero et al.
where: h P is the Plank’s constant, and me and mh are the electrons and holes effective
masses, respectively. By isolating the values essentially independent of temperature
as:
B = 4
2πk
h2
3 
m∗
em∗
h
 3
2
(27)
Equation 26 can be rewritten as:
n2
i = BT 3e

−Eg(0)
kT

(28)
By substituting n2
i from Eq. 28 in Eq. 25 and neglecting the temperature depen-
dence of D f and Lc, the saturation current can be expressed as:
Isat ≈BT 3e

−Eg(0)
kT

(29)
If Eq. 29 is substituted in Eq. 24, the impact of Isat over Voc as a function of temper-
ature variations can be derived as:
Voc = K T
q

lnIsc −lnB −3lnT + qVg(0)
kT

(30)
where: Eg(0) = qVg(0). Thus,
dVoc
dT
= Voc −Vg(0)
T
−3k
q
(31)
In this way, it demonstrated that Voc presents a nonlinear behavior associated with
the variation of the intrinsic carrier concentration and is inversely proportional to the
temperature increment.
3.4
Radio Frequency Energy Harvesting
At the end of the 19th century, in the United States, Nikola Tesla was responsible
for presenting and demonstrating the concept of WPT [32]. In order to make WPT a
commercial technology, Tesla idealized a wireless power transmission station capa-
ble of sending signals across the Atlantic Ocean called the Wardenclyffe Tower.
The project had a transmission power of 300 kW at 150 kHz; however, it was not
completed due to the high cost of building the tower.
The next big breakthrough in the WPT ﬁeld came only in 1964 when William C.
Brown associated antennas and RF rectiﬁers to create a rectifying antenna, the basic
structure of the far-ﬁeld WPT reception system. For this, he combined half-wave
dipole antennas with a series of rectiﬁers to power the electric motor of a prototype

Energy Harvesting Towards Power Autonomous Sensors in Smart Grids
23
Fig. 9 Block diagram of a rectenna. The RF signal captured by the antenna is then transferred
according to the impedance matching network to the rectiﬁer, where it is converted to DC. The DC
ﬁlter eliminates the by-products of this rectiﬁcation process before the power is delivered to the
load
helicopter, performing a ﬂight with a maximum height of 18 m for more than ten
consecutive hours [33].
Since then, advances in the WPT area have been gradual and exploratory, present-
ing variations in techniques, architectures, and strategies. However, without offer-
ing a technological breakthrough that surpasses all other current methods. In other
words, most RF energy harvesting research nowadays aims to optimize an already
well-established structure, the rectenna.
Rectenna
A Rectenna is a transducer composed of an antenna for picking up electromag-
netic energy and a rectiﬁer that converts the energy in the captured waves into
a DC level. The antenna can be optimized to work within near-ﬁeld distances
using the induction coupling principle or to operate in the far-ﬁeld region, as
a power source for low-consumption devices.
The basic architecture of an RF energy harvesting receiver, the rectenna, is rep-
resented in the block diagram shown in Fig. 9. In general, this circuit’s function is to
convert RF power density (SAV ) present in the environment into DC electrical power.
The antenna is the ﬁrst stage of the reception system, and it converts the electro-
magnetic power density present in the environment to electrical power conﬁned to
the device, still in the RF domain. In the next stage, the impedance matching net-
work is added to magnify the power transfer between adjacent nodes. The matching
circuit introduces real and imaginary impedance to achieve the complex conjugate
impedance of the previous stage at its input and the complex conjugate impedance of
the next stage at its output. This impedance can be ideally adjusted through capacitive
and inductive lumped or distributed elements, such as surface mount components and
open or short stubs in the RF transmission lines (do not mistake the transmission line
in an electrical power system context).
The rectiﬁer itself is the third stage, and promotes the RF to DC energy conversion.
The conversion is done by associating one or more diodes, which must perform well

24
E. V. Valdés Cambero et al.
Fig. 10 Schematics of the main RF rectiﬁer topologies for low-power applications
at high frequencies and have a low threshold voltage, like the usually used Schottky
diodes. The rectiﬁer topology (how the diodes are associated) should vary depending
on the application and the power levels involved.
The rectenna’s fourth stage is the DC ﬁlter (or low-pass ﬁlter). Its function is to
eliminate high-frequency oscillations and harmonics after rectiﬁcation and deliver
higher-quality power to the load, the last stage. The DC ﬁlter is usually composed
of a capacitor connected to the ground and a series inductor.
3.4.1
Rectiﬁers Topologies
Among the main RF rectiﬁer topologies, there are four widely used in low-power
applications: series, shunt, doubler, and symmetric. These topologies are shown in
Fig. 10, where the voltage source (VI N) plus the equivalent series impedance (ZS), at
the rectiﬁer input, represents the antenna modeling after its equivalent Thévenin cir-
cuit. For each RF rectiﬁer topology previously mentioned, the following elements are
essential for an optimized point of operation: impedance matching network (Zline);
diode (D); capacitive ﬁlter at the output (Co); and resistive load (Rl). The output
voltage across Rl is deﬁned by Vo.
The series topology (Fig. 10a) works ideally as a half-wave rectiﬁer, with D
conducting all along the positive cycle of VI N. Guaranteeing this performance needs
the inclusion of a DC short to the anode terminal side of the diode. Its main scope is
to suppress charge buildup, which arises from the diode depletion region speciﬁcally
due to RF sources with ZS equivalent to an open circuit for DC. On the contrary, the

Energy Harvesting Towards Power Autonomous Sensors in Smart Grids
25
Fig. 11 Efﬁciency of rectiﬁer topologies, with their respective optimum load. At lower power
levels, the simple (single-diode) topologies perform better. In contrast, the others performed better
at higher power levels [34]
shunt topology, (Fig. 10b), must contain a DC block (capacitor) connected between
the diode and Zline to prevent reverse current ﬂow from the circuit output to the
circuit input.
For the symmetrical topology (Fig. 10c), it can be interpreted as the junction of
two series rectiﬁers, composed by Zline1, D1, and Co1 for the positive cycle of VI N,
and by Zline2, D2, and Co2 during the negative one. Assuming the same understanding
for the case of the doubler topology (Fig. 10d), it can be presented as the coupling
of a series and a shunt rectiﬁer. Furthermore, it is crucial to highlight that a short
circuit to DC is needed at the input side of the circuit exclusively for the doubler
topology. In addition, the capacitor C1 operates as an electrical charge retainer over
the negative cycle of the input signal conducting in series with D2, and pumping
electric charge over the positive cycle in series with D1.
Additionally, to the two diode topologies, D1 and D2 conduct in opposite semi-
cycles of the input signal, thus increasing the rectifying period of the circuit. Another
advantage of these topologies is that the maximum reverse voltage across each diode
is divided at least in half. However, for lower power levels, the simpler topologies
(two ﬁrsts) tend to have better performance since these topologies have fewer diodes.
Figure 11 shows the performance difference of each topology by varying the input
power.

26
E. V. Valdés Cambero et al.
Fig. 12 Equivalent small
signal diode model with
package parasitics
3.4.2
Diode Model in an RF Energy Harvesting Context
Given the critical role played by the diode in the RF rectiﬁer efﬁciency, it is crucial
to promote a mathematical model to predict the performance of this device in an RF
energy harvesting context.
For RF circuits, parasitic effects related to the component encapsulation have
an expressive impact over losses [35, 36] and, in this case, on the reactive part of
the rectiﬁer input impedance (Zin), evidenced by the diode’s parasitic capacitance.
Therefore, due to the component’s nonlinearity and the encapsulation’s parasitic
effects, it becomes crucial to derivate a circuit model that represents the behavior of
the different component impedances. It must be a model that recreates the response
related to Pin and the operating frequency of the input signal, using small signal
analysis [37]. As can be seen in Fig. 12, this can be done by the addition of a parallel
parasitic capacitance (C p) and a series parasitic inductance (L p) to the conventional
equivalent model of the diode, as described in [37–39]. In Fig. 12, Rs is the internal
series resistance, invariant with the signal input frequency and power. The resistance
R j, and the junction capacitance C j, are directly related to the voltage across the
diode (Vd), as shown by (32) and (33).
R j = 8.33 × 10−5nT
Is + Id
(32)
C j =
C j0

1 −Vd
Vj
m
(33)
Id = Is

e
Vd
nVt −1

(34)
Where Vj is the junction voltage, C j0 is the zero voltage junction capacitance, m is
the grading coefﬁcient, Is the saturation current, n the ideality factor, and T is the
temperature coefﬁcient in Kelvin. In these equations, only R j is not directly related
to Vd.

Energy Harvesting Towards Power Autonomous Sensors in Smart Grids
27
Fig. 13 Equivalent circuit for an RF operating diode considering the reverse diode conduction plus
the enclosure [41]
Equation (35) is generated by substituiting (34) in (32) and applying Taylor expan-
sion to the exponential, followed by truncating at the second-order term. This equa-
tion describes the relationship between R j and Vd, highlighting that the equation is
limited to the small signals modeling.
R j = 8.33 × 10−5nT I −1
s

1 −Vd + V 2
d
2

1
nVt
(35)
Therefore, the diode impedance, Zd, as a function of the angular frequency, ω, is
expressed by:
Zd(ω) =

1
(( jωC j +
1
R j )−1 + Rs) + jωC p
−1
+ jωLs
(36)
3.4.3
Inﬂuence of Diode Reverse Conduction on the Rectiﬁer
As mentioned at the beginning of the section, Schottky diodes are commonly applied
in RF energy harvesting rectiﬁers in virtue of their fast switching capability, low
forward voltage drop and GHz operating frequency range [40]. However, these diodes
also present a lower breakdown voltage (BV) in comparison to standard silicon ones,
which signiﬁcantly affects the performance of the rectiﬁers.
To consider the inﬂuence of both, direct and reverse conductions, the diode can
be modeled as shown in Fig. 13, where iDr represents the diode reverse current. To

28
E. V. Valdés Cambero et al.
determine the rectiﬁer Zin, vo and the Power Conversion Efﬁciency (PCE), a circuit
analysis can be performed, resulting in a set of four differential equations [41]:
diG
dt = ix
(37)
dvo
dt = iCo
Co
= 1
Co

iG −vo
Rl

(38)
dvD
dt
=
1
RSC j
[vG −L P ix −vD −RS(iD −iDr) −vo]
(39)
dix
dt =
1
L PCP

iD −iDr −iG + C j
dvD
dt
+ CP
dvG
dt −dvo
dt

(40)
where ix has been introduced to abstain a second order differential term, iD and iDr
are obtained by:
iD = IS

e
vD
ηVt −1

(41)
iDr = IBV

e−(vD−VBV )
ηr Vt

(42)
where η and ηr are the ideality factors for direct and reverse currents, respectively,
IS is the saturation current, VBV is the reverse breakdown voltage, IBV is the current
at breakdown region, Vt = kT/q is the thermal voltage, q is the electron charge, k
is the Boltzmann constant, and T is the absolute temperature.
Considering a sinusoidal voltage source applied to vG, the system can be solved,
where the mean value of vo can be considered as the DC output voltage after the
rectiﬁcation, through which the PCE can be calculated. Following [40], the Fast-
Fourier Transform (FFT) of the generator current (iG) can be obtained numerically,
and the ratio of the source voltage to iG ﬁrst-order harmonic component results in
Zin.
The inﬂuence of the diode reverse conduction can be analyzed by considering
and neglecting iDr in (40). Figure 14 presents the PCE as a function of the input
power for three different commercial Schottky barrier diodes, where the solid and
dashed lines describe the PCE by omitting and considering, respectively, the diode
reverse conduction. The curves represented by the symbols were obtained through the
software Advanced Design System (ADS) from Keysight to assure the effectiveness
of the model.
A signiﬁcant PCE drop can be observed when considering the reverse conduction
for higher Pin, due to the low VBV of such devices. When Pin is increased, but the
input power is not enough for reverse conduction, vo and, consequently, Pout also
increase. However, for even higher Pin, when vDr reaches its VBV , vo is smoothly

Energy Harvesting Towards Power Autonomous Sensors in Smart Grids
29
Fig. 14 PCE related to Pin
for different diodes
demonstrating the inﬂuence
of the breakdown
voltage [41]
set to a constant value, such that Pout also tends to a constant. Consequently, further
Pin increase results in a signiﬁcant PCE drop.
3.4.4
Temperature Inﬂuence on the Rectiﬁcation
Besides to the effect of the reverse conduction, the rectiﬁer can also be severely
affected by the temperature of operation. The main diode parameters affected by the
temperature are IS, Vj, and C j0 [42, 43]. At zero Kelvin, the electronic states in
semiconductors are all occupied from the lowest energy level and continue upward
until all electrons are considered [44], such that there are no electrons in the conduc-
tion band for an intrinsic semiconductor. When T increases, thermal motion leads
to excitation of electrons from the valence band to the conduction band, increasing
the intrinsic carrier density (ni) [45]. For a Schottky diode, one of the main con-
duction mechanisms through the barrier is the thermionic emission, which occurs
when a thermally active electron has enough energy to overcome the barrier [45].
This mechanism is strongly temperature dependent and is considered in the parame-
ter IS, which increases with T. Moreover, the junction voltage, related to the barrier
height, has been shown to reduce with the temperature increase, such that the junction
capacitance increases with T.
To analyze the temperature inﬂuence, the system of differential equations (37)–
(40) has been solved for a commercial Schottky diode, and the results are shown in
Fig. 15. The analysis has considered a load of 5k and a T range between 240 and
360 K. The curves demonstrate the signiﬁcant inﬂuence of T on PCE. The maximum
PCE is obtained at T = 300 K for any Pin in the studied range. However, PCE reduces
from 65% at Pin = −10 dBm to lower than 3% when T increases to 360 K. For T
lower than 300 K, a slight reduction in the PCE is also observed, e.g., 57 % at
240 K.
In Fig. 16, the PCE is shown as a Pin function for the same device of Fig. 15,
considering a load of 1k. The maximum PCE for Pin = −10 dBm is obtained at
T = 280 K and values 54%. When reducing T to 240 K, PCE reduces to 10% whereas
PCE = 37% for 360 K. By comparing both ﬁgures, it can be concluded that the PCE

30
E. V. Valdés Cambero et al.
Fig. 15 PCE related to Pin
for the diode SMS7630 with
package SC-79
demonstrating the
temperature inﬂuence for a
load of 5k [41]
Fig. 16 PCE related to Pin
for the diode SMS7630 with
package SC-79
demonstrating the
temperature inﬂuence for a
load of 1k
is signiﬁcantly dependent on both T and RL, which makes the optimization of such
rectiﬁers a cumbersome task. In addition, the maximum PCE point, which is related
to the reverse conduction, has also been affected by T and RL.
From Figs. 15 and 16, it can be noted that the sudden reduction due to the diode
reverse conduction can occur independently of the load or temperature. As mentioned
before, for higher Pin, when vDr reaches its VBV , vo is smoothly set to a constant
value, such that Pout also goes to a constant value. This effect can be clearly seen in
Fig. 17, where v0 is shown as a function of Pin for the temperatures varying from
280 to 360 K. Once the reverse conduction starts, v0 remains constant for any higher
value of Pin, degrading PCE.
Another important point for the RF energy harvesting circuit modeling is that the
antenna’s impedance should match the rectiﬁer one. Generally, a matching network is
used between the rectiﬁer and the antenna to maximize the power transfer. However,
the rectiﬁer Zin depends not only on the frequency, but also on the power level
and temperature [37, 46, 47]. By applying the Fast-Fourier Transform (FFT) of the
generator current (iG) calculated through the system of differential equations (37)–
(40), Zin is acquired by the ratio of the source voltage to the iG ﬁrst-order harmonic
component.
To analyze T and Pin inﬂuence on Zin, the real (Rin) and imaginary components
(Xin) have been obtained and the results are shown in Figs. 18 and 19. As mentioned,

Energy Harvesting Towards Power Autonomous Sensors in Smart Grids
31
Fig. 17 Output voltage
related to Pin for the diode
SMS7630 with package
SC-79 demonstrating the
temperature inﬂuence for a
load of 5k
Fig. 18 Real component of
Zin according to Pin for the
diode SMS7630 with
package SC-79
demonstrating the
temperature inﬂuence for a
load of 5k [41]
the temperature rise causes an increase in IS, which reduces the junction resistance.
Besidesthat,thejunctioncapacitanceincreaseswithTincreaseduetothereductionof
Vj. These inﬂuences result in a Rin increase with T, as shown in Fig. 18. For lower Pin,
the Rin dependence on Pin is small, such that the small signal AC analysis, described
by (36), can be applied to obtain the impedance. However, such an approximation
could not be used for higher Pin, owing to the diode’s nonlinear behavior. For a Pin
higher than –5 dBm, a sudden increase, similar for all temperatures, is observed as
a result of the diode reverse conduction.
In Fig. 19, the behavior of Xin as a function of Pin for different temperatures is
shown. In this case, the T increase results in a reduction of the absolute value of Xin.
For Pin higher than –5 dBm, a drop of |Xin|, is observed due to the diode reverse
conduction. Therefore, from Figs. 18 and 19, it can be concluded that deﬁning the
matching network required bounded by the antenna and the rectiﬁer, is a challenging
task since the input impedance varies signiﬁcantly with T and Pin.

32
E. V. Valdés Cambero et al.
Fig. 19 Imaginary
component of Zin according
to Pin for the diode
SMS7630 with package
SC-79 demonstrating the
temperature inﬂuence for a
load of 5k
4
Conclusions and Future Works
Powering edge devices for monitoring and control in power grid environments is
a critical topic for developing smart grids. This chapter presented different energy
harvesting sources and techniques that have been proposed to support power to
wireless sensors and actuators operating within power grid ecosystems.
We summarized the main collection mechanisms from different ambient energy
sources, such as mechanical, solar, and RF energy, which are shown to be promising
techniques in an SG context. Nevertheless, for more information, contributions that
are out of the mentioned selection have been referenced in the different surveys cited
within this text.
Energy harvesting in an SG environment is still in an early development stage,
and this chapter aims to analyze one of the possible approaches: sources and energy
harvesting techniques that can be used in SG edge devices. Among other approaches
and challenges that reinforce this adherence between the themes, the following stand
out: the structure and efﬁciency of the PMU, energy-saving strategies, communica-
tion scheduling, and operating strategies based on energy restriction, among others.
Despite this, the unrestricted use of energy harvesting techniques in SG devices
seems to be a matter of time.
Acknowledgements This research was supported by Coordenaáo de Aperfeiçoamento de Pes-
soal de Nível Superior (CAPES) under grant 001, Fundação de Amparo à Pesquisa do Estado de
São Paulo (FAPESP) under grants 2019/25866-7, 2022/10876-0, Conselho Nacional de Desen-
volvimento Cientíﬁco e Tecnológico (CNPq) under grant 404068/2020-0, Fundação de Amparo à
Pesquisa do Estado de Minas Gerais (FAPEMIG) under grant APQ-03609-17 and Instituto Nacional
de Energia Elétrica (INERGE).

Energy Harvesting Towards Power Autonomous Sensors in Smart Grids
33
References
1. Soyata T, Copeland L, Heinzelman W (2016) RF Energy harvesting for embedded systems:
a survey of tradeoffs and methodology. IEEE Circuits Syst Mag 16(1):22–57. (Firstquarter
2016). issn:1531 636X
2. Mathews I et al (2016) Performance of III-V solar cells as indoor light energy harvesters. IEEE
J Photovolt 6(1):230–235. https://doi.org/10.1109/JPHOTOV.2015.2487825
3. Feng Y et al (2017) Hybrid energy harvesting for condition monitoring sensors in power grids.
Energy 118:435–445
4. Suzuki Y (2011) Recent progress in MEMS electret generator for energy harvesting. IEEJ
Trans Electr Electron Eng 6:101–111
5. Tian J, Chen X, Wang ZL (2020) Environmental energy harvesting based on triboelectric
nanogenerators. Nanotechnology 31(24):242001
6. Wang H, Shi G, Han C (2021) A free-standing electromagnetic energy harvester for condition
monitoring in smart grid. In: Wireless Power Transfer 2021
7. Pavana H, Deshpande R (2020) Energy harvesting techniques for monitoring devices in smart
grid application. In: 2020 Third international conference on advances in electronics, computers
and communications (ICAECC), pp 1–6
8. Wang Z et al (2021) A self-sustained current sensor for smart grid application. IEEE Trans Ind
Electron 68(12):12810–12820
9. Zhou W et al (2021) Research on multi-source environmental micro energy harvesting and
utilization. In: 2021 6th Asia conference on power and electrical engineering (ACPEE), pp
1072–1076
10. Luo Q, Wang T, He Y (2017) Battery-free and energy-effective RFID sensor tag for health
monitoring in smart grid. In: 2017 Asia modelling symposium (AMS), pp 179–183
11. Yuan Z et al (2021) Magnetic energy harvesting of transmission lines by the swinging tribo-
electric nanogenerator. Mater Today Energy 22:100848
12. Faheem M et al (2019) Ambient energy harvesting for low powered wireless sensor network
based smart grid applications. In: 2019 7th International Istanbul smart grids and cities congress
and fair (ICSG), pp 26–30
13. Abasian A et al (2018) Design optimization of an energy harvesting platform for self-powered
wireless devices in monitoring of AC power lines. IEEE Trans Power Electron 33(12):10308–
10316
14. Abasian A et al (2018) Vacuum-packaged piezoelectric energy harvester for powering smart
grid monitoring devices. IEEE Trans Ind Electron 66(6):4447–4456
15. Yildiz HU, Gungor VC, Tavli B (2018) A hybrid energy harvesting framework for energy
efﬁciency in wireless sensor networks based smart grid applications. In: 2018 17th annual
Mediterranean Ad Hoc networking workshop (Med-Hoc-Net), pp 1–6
16. Sun W et al (2021) Research on life extension method of transmission line intelligent sensing
system based on environmental energy harvesting. J Sens
17. Pehlivanoglu EB et al (2018) Harvesting-throughput trade-off for wireless powered smart grid
IoT applications: an experimental study. In: 2018 IEEE international conference on communi-
cations (ICC). IEEE, pp 1–6
18. Parejo A et al (2019) Monitoring and fault location sensor network for underground distribution
lines. Sensors 19(3):576
19. Beeby SP et al (2007) A micro electromagnetic generator for vibration energy harvesting. J
Micromech Microeng 17(7):1257. (June 2007). https://doi.org/10.1088/0960-1317/17/7/007
20. Liao Y, Liang J (2018) Maximum power, optimal load, and impedance analysis of piezoelectric
vibration energy harvesters. Smart Mater Struct 27(7):075053
21. Jia J et al (2022) Equivalent circuit modeling and analysis of aerodynamic vortex-induced
piezoelectric energy harvesting. Smart Mater Struct 31(3):035009
22. Tilmans HAC (1996) Equivalent circuit representation of electromechanical transducers: I.
Lumped-parameter systems. J Micromech Microeng 6(1):157

34
E. V. Valdés Cambero et al.
23. Elvin NG, Elvin AA (2009) A general equivalent circuit model for piezoelectric generators. J
Intell Mater Syst Struct 20(1):3–9
24. Hertz H (1887) Ueber einen Einﬂuss des ultravioletten Lichtes auf die electrische Entladung.
Annalen der Physik 3(1):310–317. (Jan 1887). issn: 2156-3381
25. Singh AK, Graham S (2019) Ultrabarrier ﬁlms for packaging ﬂexible electronics: examining
the role of thin-ﬁlm technology. IEEE Nanotechnol Mag 13(1):30–36. https://doi.org/10.1109/
MNANO.2018.2869179
26. Cambero EVV et al (2022) A 2.4 GHz coplanar solar cell patch antenna with a semi-analytical
evaluation of temperature effects. J Microwav Optoelectron Electromagn Appl 21(1):194–206
27. Jaimes AF, de Sousa FR (2017) Simple modelling of photovoltaic solar cells for indoor har-
vesting applications. Solar Energy 157:792–802. issn: 0038-092X
28. Cambero EVV (2020) Analysis of a coplanar patch antenna array integrated with photovoltaic
cells for hybrid energy harvesting. PhD thesis. Universidade Federal do ABC, Energy Graduate
Program, Santo André, São Paulo, 2020
29. Ray B, Alam MA (2013) Organic solar cells by charged interface. IEEE J Photovolt 3(1):310–
317. (Jan 2013). https://doi.org/10.1109/JPHOTOV.2012.2216508
30. Agha HS, Koreshi Z-U, Khan MB (2017) Artiﬁcial neural network based maximum power point
tracking for solar photovoltaics. In: 2017 international conference on information and commu-
nication technologies (ICICT), pp 150–155. https://doi.org/10.1109/ICICT.2017.8320180
31. Ponce-Alcántara S et al (2014) A statistical analysis of the temperature coefﬁcients of indus-
trial silicon solar cells. Energy Procedia 55. issn: 1876-6102. https://doi.org/10.1016/j.egypro.
2014.08.029. https://www.sciencedirect.com/science/article/pii/S1876610214012533. (Pro-
ceedings of the 4th International Conference on Crystalline Silicon Photovoltaics (SiliconPV
2014), pp 578–588)
32. Brown WC (1984) The history of power transmission by radio waves. IEEE Trans Microw
Theory Tech 32(9):1230–1242
33. Brown WC (1980) The history of the development of the rectenna. In: NASA. Johnson space
center solar power satellite microwave transmission and reception (1980)
34. PazHPetal(2019)AsurveyonlowpowerRFrectiﬁersefﬁciencyforlowcostenergyharvesting
applications. AEU-Int J Electron Commun 112:152963
35. ur Rehman M, Ahmad W, Khan WT (2017) Highly efﬁcient dual band 2.45/5.85 GHz rectiﬁer
for RF energy harvesting applications in ISM band. In: 2017 IEEE Asia Paciﬁc microwave
conference (APMC), pp 150–153. (Nov 2017)
36. Nimo A et al (2015) Analysis of passive RF-DC power rectiﬁcation and harvesting wireless rf
energy for micro-watt sensors. AIMS J 3:184–200. (Apr 2015)
37. Shieh S, Kamarei M (2018) Transient input impedance modeling of rectiﬁers for RF energy
harvesting applications. IEEE Trans Circuits Syst II: Express Briefs 65(3):311–315. (Mar 2018)
38. Gu X et al (2018) Integrated cooperative ambient power harvester collecting ubiquitous radio
frequency and kinetic energy. IEEE Trans Microwave Theory Techn 66(9):4178–4190. (Sept
2018)
39. Ali E et al (2018) Enhanced Dickson voltage multiplier rectenna by developing analytical model
for radio frequency harvesting applications. Int J RF Microw Comput Aided Eng 29:e21657.
(Dec 2018)
40. Nikoletseas S, Yang Y, Georgiadis A (2016) Wireless power transfer algorithms, technologies
and applications in Ad Hoc communication networks, 1st. Springer Publishing Company,
Incorporated. isbn: 331946809X
41. Trevisoli R et al (2022) Modeling Schottky Diode rectiﬁers considering the reverse conduction
for RF wireless power transfer. IEEE Trans Circuits Syst II Express Briefs 69(3):1732–1736.
https://doi.org/10.1109/TCSII.2021.3102576
42. Gu X et al (2020) Optimum temperatures for enhanced power conversion efﬁciency (PCE)
of zero-bias diode-based rectiﬁers. IEEE Trans Microwave Theory Tech 68(9):4040–4053.
https://doi.org/10.1109/TMTT.2020.2992024
43. Massabrio G, Antognetti P (1998) Semiconductor device modeling with spice, 1st edn.
McGraw-Hill, Inc., USA. isbn: 0071349553

Energy Harvesting Towards Power Autonomous Sensors in Smart Grids
35
44. Rockett A (2007) The materials science of semiconductors, 1st edn. Springer Publishing Com-
pany, Incorporated. isbn: 0387256539
45. SzeSM,NgKK(2006)Physicsofsemiconductordevices.Wiley.isbn:9780470068304. https://
books.google.com.br/books?id=o4unkmHBHb8C
46. Keyrouz S, Visser HJ, Tijhuis AG (2012) Rectiﬁer analysis for Radio Frequency energy har-
vesting and Power Transport. In: 2012 42nd European microwave conference, pp 428–431.
https://doi.org/10.23919/EuMC.2012.6459081
47. Ou J-H et al (2018) Novel time-domain schottky diode modeling for microwave rectiﬁer
designs. IEEE Trans Circuits Syst I Regul Papers 65(4):1234–1244. https://doi.org/10.1109/
TCSI.2017.2739245

Off-Grid Green Hydrogen Production
Systems
Alejandro Ibáñez-Rioja, Georgios Sakas, Lauri Järvinen, and Pietari Puranen
Abstract This chapter introduces the role of hydrogen in the current energy sys-
tem transition: from fossil-based to renewable and low-carbon emission sources.
Although solar and wind energy are abundant renewable sources, the intermittence
of electricity generation remains a challenge for security of supply and causes insta-
bilities in the electricity grid. The integration of green hydrogen produced by water
electrolysis into a smart energy system –or a smart grid–, is considered a promising
solution to overcome the handicaps of the renewable electricity production and cer-
tain hard-to-decarbonize industrial sectors. The principle of water electrolysis along
with the different electrolyzer technologies is also presented in the ﬁrst section. In
the second section, a numerical model of an industrial alkaline water electrolyzer
plant is described. The different unit operators that comprise the system to produce
puriﬁed hydrogen are individually introduced. The chapter concludes by showing
the capabilities of an off-grid water electrolyzer system, which consists of a battery
energy system and solar PV and wind power installations. Simulation of the plant
demonstrates, as a proof of concept, the feasibility of the system for future integration
into a smart energy system.
A. Ibáñez-Rioja (B) · G. Sakas · L. Järvinen · P. Puranen
Lappeenranta–Lahti University of Technology LUT, P.O. Box 20, FI-53851
Lappeenranta, Finland
e-mail: Alejandro.Ibanez.Rioja@lut.ﬁ
G. Sakas
e-mail: Georgios.Sakas@lut.ﬁ
L. Järvinen
e-mail: Lauri.Jarvinen@lut.ﬁ
P. Puranen
e-mail: Pietari.Puranen@lut.ﬁ
© The Author(s), under exclusive license to Springer Nature Switzerland AG 2024
A. J. Sguarezi Filho et al. (eds.), Smart Grids—Renewable Energy, Power Electronics,
Signal Processing and Communication Systems Applications, Green Energy
and Technology, https://doi.org/10.1007/978-3-031-37909-3_2
37

38
A. Ibáñez-Rioja et al.
Nomenclature
Acronyms
AC
Alternating current
AWE
Alkaline water electrolyzer
BESS
Battery energy storage system
DC
Direct current
FLHs
Full load hours
ODE
Ordinary differential equation
PEM
Proton exchange membrane
PEMWE
PEM water electrolyzer
PID
Proportional integral derivative
SEC
Speciﬁc energy consumption
Variables
α
U–I curve model parameter
β
U–I curve model parameter
ϵ
Emissivity
η
Efﬁciency
ρ
Density
σ
Stefan-Boltzmann constant
A
Cross-sectional area
C
Thermal capacitance
D
Diameter
F
Faraday constant
h
Average heat transfer coefﬁcient
I
Current
i
Current density
k
Thermal conductivity
L
Length
M
Molarity
˙m
Mass ﬂow rate
N
Total number
˙n
Molar ﬂow rate
P
Pressure
˙Q
Power loss
R
Resistance
r
Reaction rate
s
Tafel slope model parameter
T
Temperature

Off-Grid Green Hydrogen Production Systems
39
U
Voltage
V
Volume
z
Number of moles of electrons transferred in the reaction
Mm
Molar mass
Nu
Nusselt number
Subscripts
act
Activation
amb
ambient
an
Anode
c
Cell
cat
Cathode
cd
cold
cn
consumption
cnv
convection
con
Concentration
ele
Electrolyte
F
Faraday
h
hot
imp
impurities
i
Inlet
j
Outlet
liq
liquid
loss
loss
m
make-up feed
ohm
Ohmic
pd
production
rad
radiation
rev
Reversible
rev,0
Standard equilibrium
s
stack
sep
separation vessel
shunt
shunt current
tn
thermoneutral
v
Vapor
w
Water

40
A. Ibáñez-Rioja et al.
1
Green Hydrogen
1.1
Hydrogen. What is it for?
1.1.1
Motivation: Issues with the Current Energy System
The ﬁrst decades of the twenty-ﬁrst century have shown an accelerated growth in
the global economy and increasing industrialization worldwide. So far, the eco-
nomic growth has been tightly coupled with the increasing energy consumption and
exploitation of non-renewable natural resources. As the world’s population is still
increasing, and ever more people have access to the western consumer lifestyle, the
ﬁnal energy and raw material consumption are expected to continue growing in the
near future [1, 2].
Increasing consumption of non-renewable resources, both directly as a raw mate-
rial and through burning for energy generation, causes a variety of environmen-
tal issues. Climate change caused by increasing greenhouse gas emissions in the
Earth’s atmosphere is the best-known of these environmental problems [3]. The
most prominent of the greenhouse gases is fossil carbon dioxide (CO2), whose main
sources relate to the burning of fossil fuels for converting their chemical energy into
electrical energy, heat or mechanical energy for ﬁnal use. Furthermore, depleting
non-renewable resources in easily accessible areas leads to their extraction from
higher-risk areas, which increases both the cost of extraction and the probability of
biodiversity degradation and environmental disasters.
In addition to being the main cause of anthropogenic climate change, extreme
reliance on fossil energy sources makes the global economy highly vulnerable to
disruptionsintheconstantﬂowoffueloritsprice.Politicalconﬂictsandwarsbetween
nations can inﬂuence the availability, and thus the price of fossil fuel products,
potentially driving economies into recession [4]. Local or global energy crises of
this kind have occurred several times in the past decades. Nations without their own
fossil fuel reservoirs are the most vulnerable to such shocks in the global fuel trade.
1.1.2
Energy System Transition from Fossils to Renewables
One promising solution for both cutting the carbon dioxide emissions and ensuring
the security of energy supply is wider electriﬁcation of the whole energy system
and an increase in the exploitation of renewable energy sources, mainly onshore
wind and solar energy [2]. The costs of both these energy generation techniques
have plummeted in the last couple of decades, making them the cheapest sources
of electricity as of 2022 [5, 6]. Because of their low price, the number of new solar
and wind power installations has been growing exponentially, accounting for the
majority of new electricity generation capacity installed between 2015 and 2021 [7].
Although, wind and solar energy are abundantly available nearly everywhere
around the globe, their wider exploitation in the context of the current energy system

Off-Grid Green Hydrogen Production Systems
41
has two major issues. Firstly, the availability of wind and solar energy is highly inter-
mittent both in the short and long term. The ﬂuctuating nature of the energy sources
gives rise to a considerable need for energy storage capacity to completely phase
out fossil energy sources [5]. Secondly, sectors like mobility, industry, and heating,
which have traditionally been reliant on directly burning fossil fuels, have to be as
far electriﬁed as possible to utilize the renewable electricity generation. Some of
them can be at least partially directly electriﬁed, like road trafﬁc and domestic heat-
ing by using battery electric vehicles (BEV) and air-sourced or ground-sourced heat
pumps, respectively. Unfortunately, not all sectors can be directly electriﬁed, includ-
ing aviation, marine transportation, and many high-temperature industrial processes.
These sectors have to be, thus, indirectly electriﬁed with the introduction of electro-
fuels (aka. e-fuels), such as hydrogen (H2), methane (CH4), methanol (CH3OH or
MeOH), or ammonia (NH3) that have to be produced without using fossil-based raw
materials [8].
Hydrogen as an energy carrier has been proposed to be one possible solution
for both of the above-mentioned issues. At the simplest, hydrogen can be produced
by electrochemical water electrolysis requiring only water and electricity as the
precursors. Conversion back to electricity is possible with the reverse electrochemical
reaction in a fuel cell, but also combustion in a gas turbine is an alternative conversion
technique. Oxidizing hydrogen in either a fuel cell or through combustion produces
only water as the reaction product, which makes electrolytically produced hydrogen
a truly clean fuel, as long as the input power used to produce the hydrogen has come
from a clean source.
The usage as an energy storage is not the sole use case for electrochemically
produced hydrogen. Many useful fuels and commodity chemicals that have tradi-
tionally been based on fossil raw materials can also be produced with electrolyti-
cally produced hydrogen. The production of e-chemicals, such as methane through
the Sabatier process, ammonia through the Haber–Bosch process, and liquid e-fuels
containing longer hydrocarbon chains with the Fischer–Tropsch process, all require
hydrogen as one of their precursors. Furthermore, some carbon-intensive chemical
processes, such as industrial steel production, can be modiﬁed to use hydrogen for the
reduction of iron ore [9]. Clean hydrogen production is, thus, a key factor enabling the
electriﬁcation of a number of chemical processes that are currently highly dependent
on fossil raw materials and that are responsible for producing a signiﬁcant proportion
of the global greenhouse gas emissions.
1.2
Methods of Hydrogen Production
Hydrogen has been a useful precursor in many chemical processes even before the
novel uses proposed for the green transition. Its main usage has traditionally been
in oil reﬁning, being a necessary ingredient in hydrotreaters and hydrocrackers, but
also in the Haber–Bosh process for ammonia production. The current go-to method
for producing hydrogen is steam methane reforming (SMR), which is a signiﬁcant

42
A. Ibáñez-Rioja et al.
emitter of fossil carbon dioxide. In SMR, natural gas and water are converted into
hydrogen and carbon dioxide. Another method for hydrogen production using fossil
raw materials is coal gasiﬁcation, which splits water with the help of solid carbon
and oxygen (O2) into hydrogen and carbon monoxide (CO).
Compared with the more traditional hydrogen production techniques, water elec-
trolysis is considered more environmentally friendly as carbon dioxide emissions can
be avoided completely when coupled with renewable electricity sources [10]. Water
electrolysis has the advantage of producing extremely pure hydrogen, but so far,
its applications have mostly been limited to small scale hydrogen production [11].
Currently, only 4% of the world’s hydrogen is produced using water electrolysis, the
rest being generated with SMR, coal gasiﬁcation, or as a side product of oil reﬁning
[12]. In recent years, however, water electrolysis has become a popular option for
hydrogen production, mostly because its ability to produce carbon neutral hydrogen.
To differentiate hydrogen based on the climatic impact of its production method-
ology, a colour classiﬁcation has been developed. With this classiﬁcation, the hydro-
gen produced through SMR and coal gasiﬁcation is referred as gray and black/brown
hydrogen, respectively, when the released carbon dioxide is not captured, and blue
hydrogen when the carbon dioxide is captured and stored out of use. Hydrogen
produced through electrolysis using fully renewable sources is referred to as green
hydrogen. Other colors of hydrogen than the ones presented here have also been
proposed, but by the time of writing, their usage has not become fully established
yet.
In water electrolysis, electric current is directly used for splitting water molecules
to produce hydrogen according to Faraday’s law of electrolysis:
˙nH2 = Nc

ηF
icell Aeff
z F

.
(1)
The law simply states that the rate of an electrochemical reaction is directly propor-
tional to the applied current, depicted here as the product of current density, icell, and
effective cell area, Aeff. The symbol z is a stoichiometric constant denoting the num-
ber of electrons required for the reaction to produce a single molecule of product,
and Faraday’s constant, F, converts that number into the amount of charge needed
in coulombs. In a stack of Nc cells in series, the same current ﬂows through all the
cells producing the same amount of products in each one. The Faraday efﬁciency,
ηF, is deﬁned as the percentage of the supplied electric charge that is successfully
converted into the desired chemical product. Often in water electrolysis, the Faraday
efﬁciency is deﬁned to be one, as there is no signiﬁcant electrochemical side reac-
tions. Other losses of current can, however, also exist in the system, resulting in a
current efﬁciency lower than one. Most notable of these losses are shunt or leakage
currents bypassing some of the cells in a stack, and gas diffusion through the cell
separator [13, 14].
Although the hydrogen production from water electrolysis is directly proportional
to the applied current, the power consumption depends also on the system voltage.
The voltage over an electrolytic cell, Uc, itself is a nonlinear function of the current

Off-Grid Green Hydrogen Production Systems
43
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
0
0.2
0.4
0.6
0.8
1
1.2
1.4
1.6
1.8
Concentration overpotential
Activation overpotential
Ohmic overpotential
Reversible potential
Fig. 1 Separated contributions of each of the potential terms for an arbitrary water electrolyzer
polarization curve. The ﬁgure axes are drawn on a per-unit -basis, where voltage and current units
are represented compared to the reversible potential and the maximum current limited by the con-
centration overpotential, respectively
applied to it. A plot of the voltage characteristics as a function of current is often
called the I–V curve, the U–I curve, or the polarization curve.
The cell voltage can be described as a sum of several distinct terms:
Uc = Urev + Uohm + Uact + Ucon.
(2)
The contributions of each of these terms for an arbitrary water electrolyzer polar-
ization curve are illustrated in Fig. 1. Reversible potential, Urev, is the fundamental
electrochemical potential required for the speciﬁc electrochemical reaction. It is inde-
pendent of current, but depends on temperature, pressure, and reagent and product
concentrations in the system. The rest of the terms in Eq. (2) are overpotentials, which
are responsible for power loss in the electrolysis process. Overpotential caused by
ohmic resistance, Uohm, is linearly dependent on the applied current, according to
Ohm’s law. With careful modelling, the ohmic losses of different parts of the cell,
such as the separator, electrolyte, and contact surfaces, can be separated from each
other. Activation overpotential, Uact, expresses the voltage needed to overcome the
kinetic barrier of the reaction. It is often modeled using the Butler–Volmer equation
or one of its approximations, such as the Tafel equation, which is valid for high
enough current densities. Activation overpotential is a non-linear function of current
density behaving nearly logarithmically. Concentration overpotential, Ucon, repre-
sents the additional voltage caused by insufﬁcient replenishing of reagents, in this

44
A. Ibáñez-Rioja et al.
case water, on the reaction site when a very high current density is applied. Its effect
is mostly unnoticed in water electrolysis, because the current densities used are sel-
dom high enough. Therefore, concentration overpotential is often omitted from the
modelling of water electrolyzers. A more detailed description of the modelling of
these overpotentials for water electrolysis is presented for example in [15].
One of the main performance indicators of a water electrolyzer system is the
speciﬁc energy consumption (SEC) deﬁned as the total energy required to produce
a kilogram of hydrogen:
SEC =
 t1
t0 Ps dt
 t1
t0 ˙mH2 dt
=
 t1
t0 Is Us dt
 t1
t0 ˙mH2 dt
,
(3)
where Ps is the instantaneous power of the system, which is calculated as a product of
instantaneous current, Is, and voltage, Us. Mass ﬂow of hydrogen, ˙mH2, on the other
hand, can be, in theory, calculated based on the molecular production rate, ˙nH2, from
Eq. (1) by multiplying it with the molecular mass of hydrogen. In reality, however,
the mass ﬂow should be measured from the system, as effects like diffusion of gases
to the opposite electrode [14] and shunt currents bypassing certain cells in a stack
[13] can cause the actual hydrogen production to be signiﬁcantly lower than what
would be predicted according to Faraday’s law of electrolysis. Care must also be
taken when integrating over the instantaneous power Ps in Eq. (3) as non-linearity
in the polarization characteristics of the electrolyzer causes a difference between the
mean and root mean square (rms) values of the voltage in the case of a ﬂuctuating
current supply [16].
1.3
Water Electrolysis Technologies
Since Troostwijk and Diemann ﬁrst observed the electrolysis phenomena in 1789
[17], from early industrial alkaline water electrolyzers of 1900, to today’s large-scale
industrial installations, water electrolysis technologies have been continuously devel-
oping and advancing. Currently, a variety of water electrolysis technologies exist in
the market. The most common of these are alkaline water electrolysis (AWE), proton
exchange membrane/polymer electrolyte membrane water electrolysis (PEMWE)
and solid oxide water electrolysis (SOWE). Although the technologies have differ-
ent electrolytes and electrochemical half-reactions, the end product is the same [18].
In terms of development and industrial adoption, alkaline and PEM electrolyzers are
regarded as the most advanced technologies.

Off-Grid Green Hydrogen Production Systems
45
1.3.1
Alkaline Water Electrolyzer
Hydrogen production using AWE has developed into a reliable method for green
hydrogen production. Today, AWEs have reached megawatt scale and by being the
simplest and most mature technology, they now account for most industrial water
electrolyzer installations worldwide [19].
AWE uses a liquid electrolyte made out of potassium hydroxide (KOH) or a
sodium hydroxide (NaOH) water solution. Liquid electrolyte is used to increase
ionic conductivity compared to pure water at operating temperatures of 70-90◦C,
which enables current ﬂow through the liquid. Two electrodes are immersed in the
electrolyte and are separated by a diaphragm, which keeps the product gases apart
from each other, increasing the safety and efﬁciency of the system while still allowing
hydroxide ions (OH−) and water molecules to permeate.
The basic working principle of AWE cell is presented in Fig. 2 while Table 1 lists
the half-cell reactions and the total reaction. Electrodes which are submerged in the
liquid electrolyte are supplied with direct current (DC) which provides the energy
needed for the electrochemical reactions. On the cathode side, water is reduced to
hydrogen and hydroxide ions; these ions pass through the diaphragm to the anode,
where they react to form water and oxygen.
Alkaline water electrolyzer technology is already well established and has been
researched the longest out of the industrial water electrolyzer technologies. Adoption
of AWE technology has been driven by the simple design and low cost compared
Fig. 2 Alkaline water
electrolyzer working
principle [20]
Table 1 Alkaline water
electrolyzer chemical
reactions
Reaction
Anode
2OH−→1
2O2 + H2O + 2e−
Cathode
2H2O + 2e−→2OH−+ H2
Total
H2O →H2 + 1
2O2

46
A. Ibáñez-Rioja et al.
to other available electrolyzer technologies. The costs of production is low because
it is possible to use low-cost, non-noble catalysts made of nickel-based materials in
AWE.
Low partial load range, and low current density still present limitations to the
operation and efﬁciency of AWE. The use of a liquid electrolyte also increases the
volumeoftheelectrolyzerandintroducesinertiaintheoperation,whichmakesAWEs
unable to react to fast input power changes [21]. Currently, issues also arise from the
use of bipolar conﬁguration in AWE, which, compared to unipolar, has lower ohmic
losses, but at the same time is much more susceptible to shunt currents [22, 23].
The downsides are still outshone by the fact that AWEs don’t require noble metal
catalysts, which makes the technology immune to possible supply issues of those
metals in the future. In general, AWEs offer a straight forward technology to scale
green hydrogen production to large industrial scale needed for the future energy
system.
1.3.2
Proton Exchange Membrane Water Electrolyzer
The beginning for PEMWE was in the 60s, when General Electric developed a fuel
cell system based on a solid electrolyte concept for NASAs gemini program [24]. For
the electrolyte, General Electric chose solid sulfonated polystyrene membrane. In the
late 60s, a new membrane called Naﬁon® was adapted for use in the PEM fuel cells,
which would become the most widely used membrane for PEM water electrolyzers
and fuel cells [25]. In addition to Naﬁon® other options such as fumapem® and
Aciplex® also exist, all of these being perﬂuorinated sulfonic acid ionomers like
Naﬁon®. Thin membrane thickness (around 100µm) is in part the reason for many
advantages of the proton exchange membrane [21]. The basic working principle
of PEMWE is shown in Fig. 3 while Table 2 lists the half reactions and the total
reaction. On the anode side, water is reduced to oxygen and hydrogen ions; the ions
pass through the membrane to the cathode, where they combine to form hydrogen
gas.
PEM water electrolyzers have many advantages compared to alkaline systems. In
PEMWE ohmic losses are greatly reduced compared to AWEs as the thin membrane
is capable of providing good proton conductivity (0.1 ± 0.02 S cm−1) [26] making
higher current densities possible. PEMWE produce high purity hydrogen (99.999%)
as the gas crossover rate is low, and this allows PEM electrolyzers to work in a wide
operation range, typically 10–100% of the nominal power. PEMWE can respond
quickly to the power input, not delayed by inertia of the liquid electrolyte, allow-
ing dynamic operation even under extreme power transients on second-to-second
timescale [27]. The solid electrolyte used in PEMWE also means that the electrolyzer
structure can be built smaller. Additionally, with the strong structural properties of
the solid electrolyte, high operational pressures (equal or differential across the mem-
brane) are achievable. Producing hydrogen at high pressures eliminates the need for
an external compressor, thus reducing the complexity of the whole system and the
levelized cost of hydrogen [28].

Off-Grid Green Hydrogen Production Systems
47
Fig. 3 PEM water
electrolyzer working
principle [20]
Table 2 PEM water
electrolyzer chemical
reactions
Reaction
Anode
H2O →2H+ + 1
2O2 + 2e−
Cathode
2H+ + 2e−→H2
Total
H2O →H2 + 1
2O2
On the other hand, most prominent drawbacks of PEMWE systems is the need
for noble metals such as iridium, titanium, and platinum which increase the price of
the electrolyzer. Iridium is seen as a large bottleneck for PEMWE manufacturing; it
is one of the rarest elements in Earth’s crust, with yearly production of only around
3 tonnes. Reduction of noble metal loading in the catalyst is an especially important
area of study for PEMWE, as with the current loadings, scaling up the production of
PEMWE would not be feasible [29].
Currently, PEM water electrolyzers are commercially available but at the same
time, major drawbacks still exist. Limited material selection will limit the scalability
of the technology if those materials cannot be replaced with more common ones or
the loadings are not signiﬁcantly reduced [30]. Research and modelling to investigate
PEMWE’s degradation and dynamic response are still in their early stages and further
work is required [31–33].
1.3.3
Solid Oxide Electrolyzer
Research into solid oxide water electrolyzers has its beginning in 1975 when project
HOT ELLY was started in Germany [34]. A decade later, Dönitz and Erdle introduced
the ﬁrst functional water electrolyzer using solid oxide electrolyte cells (SOECs)
[35]. Running at, 1000 ◦C the system was able to run at constant current density
of 0.3 A cm−2 at a voltage of 1.07 V during a 1000h test run without signiﬁcant
voltage change. Increasing the operating temperature of the electrolyzer increases

48
A. Ibáñez-Rioja et al.
Table 3 Solid oxide
electrolysis chemical
reactions
Reaction
Anode
O2 →1
2O2 + 2e−
Cathode
H2O(g) + 2e−→H2 + O2−
Total
H2O(g) →H2 + 1
2O2
Fig. 4 SOEC working
principle [20]
the total energy demand slightly, while the electrical energy needed decreases sig-
niﬁcantly. Thus, increasing the theoretical maximum for electrolyzer efﬁciency [36].
Although SOECs show a lot of promise, they are still under development and have
only seen very limited adoption in industry. Currently, SOEC research is very active,
and numerous researchers from companies, research centres, and universities around
the world are contributing to it. Thus, SOECs have seen fast advances in technology
and are approaching the one megawatt scale.
In SOEC water in the form of steam is fed to the cathode, where the water is split
into hydrogen and oxide anions according to Table 3. The oxide anions produced in
the cathode pass through the solid electrolyte to the anode, where they recombine,
forming oxygen. The working principle and basic components of SOEC are presented
in Fig. 4.
The cathode is made of a cermet material, usually consisting of nickel and yttria
(Y2O3)-stabilized zirconia (ZrO2), shortened as YSZ. The anode is commonly a
composite of YSZ and perovskites such as ferrites (LaFeO3), lanthanum manganites
(LaMnO3) or cobaltites (LaCoO3) partially substituted with strontium to improve
structural and electronic defects which increase electrocatalytic activity [37, 38].
8mol % YSZ has been extensively used as an electrolyte in solid oxide fuel cells
[39]. It has high oxygen-ion conductivity while also acting as an electronic insulator
when operating at high temperature (∼1000 ◦C) [40]. Zirconia is used because of its
high melting point, good mechanical strength, and excellent corrosion resistance.

Off-Grid Green Hydrogen Production Systems
49
Table 4 Co-electrolysis
chemical reactions
Reaction
Cathode
H2O + 2e−→H2 + O2−
Cathode
CO2 + 2e−→CO + O2−
Anode
2O2−→O2 + 4e−
Total
H2O + CO2 →H2 + CO + O2
Although operating at high temperatures has beneﬁts for cell efﬁciency and
reduced voltages, it causes issues with material durability and sealing of the elec-
trolyzer. Currently, material degradation presents one of the major issues in SOECs
[41, 42]. Additionally, processing of the hydrogen gas is complicated by the fact
that it is mixed with steam when leaving the cathode side outlet. The more compli-
cated separation process increases the capital cost of using SOE water electrolysis
compared to competing water electrolyzer technologies such as AWE and PEMWE.
These issues have to be tackled for wider adoption of the technology to take place.
Due to the high operation temperature of the SOEC it is also possible to produce
syngas (H2 + CO) with electrolysis of both water and carbon dioxide simultaneously
[43].Thisoperationmodeiscommonlycalledco-electrolysisandtheresultingsyngas
can be further reﬁned to produce synthetic fuels using Fischer-Tropsch conversion
[44]. The electrochemical reactions in co-electrolysis are shown in Table 4.
In addition to these reactions water gas shift reaction (WGS) can also occur in
parallel to the reactions listed in Table4:
H2O + CO ⇌H2 + CO2.
(4)
At temperatures above 820 ◦C the reaction balance of the WGS is shifted towards
the production of carbon monoxide and water which is called the reverse water gas
shift reaction (RWGS) [45, 46]. Thus, increasing the production of carbon monoxide
at the expense of reduced hydrogen content.
1.3.4
Anion Exchange Membrane Electrolyzer
Anion Exchange Membrane Water Electrolyzer (AEMWEs) operate in an alkaline
environment, allowing non-noble catalyst materials to be used. In AEMWEs the con-
ventional diaphragm is replaced with an Anion Exchange Membrane (AEM) which
lets hydroxide ions and water to pass through but prevents gasses from grossing.
The general idea is to implement the best parts of AWE and PEMWE in one water
electrolyzer technology, which is made possible using the AEM [47]. Compared to
alkaline electrolyzers, AEMWEs offer higher current densities and a larger operating
range, while still being able to operate under an alkaline environment. Additionally,
it is possible to run AEMWEs with much lower electrolyte concentrations than tra-
ditional AWE, and work is currently being done to use only deionized water [48]. Of

50
A. Ibáñez-Rioja et al.
Fig. 5 Working principle
and the components of anion
exchange membrane
electrolyzer [20]
Table 5 Anion exchange
water electrolyzer chemical
reactions
Reaction
Anode
2OH−→1
2O2 + H2O + 2e−
Cathode
2H2O + 2e−→2OH−+ H2
Total
H2O →H2 + 1
2O2
the three low temperature water electrolyzer technologies, AEMWEs are the least-
mature, and signiﬁcant technical hurdles still exist especially in terms of membrane
development [49].
As water is able to diffuse through the AEM, it is possible to run the AEMWE
with just anode side water supply even though performance can be further improved
by circulating water on both sides [50]. The components of AEMWE are illustrated
in Fig. 5 and the electrochemical reactions happening at anode and cathode are
presented in Table 5. On the cathode, the water is split into hydrogen and hydroxide
ions by addition of two electrons. The hydroxide ions then pass through the AEM to
the anode side, where the ions react to form oxygen and water. In terms of chemical
reactions AEM and traditional alkaline electrolyzers work identically but the usage
of AEM changes the working principle.
Using non-noble metals as the cathode and anode catalysts gives AEMWEs the
same beneﬁts as AWEs. AEMWEs same as AWEs, use nickel-based catalyst mate-
rials for anode and cathode as these materials are very cost-effective and abundant
[51, 52]. While for the AEM the most used membranes are Commercial Fumatech
FAA-series (Fumatech corp., Germany), Sustainion (Dioxide Material Corp., USA),
and Tokuyama A-201 (Tokuyama Corporation, Japan) [48, 53].
The most signiﬁcant issue with AEMWEs is the low maturity of the technology,
as it has not seen the same kind of research interest as PEMWE and AWE. As
such, many issues are still present with the AEMWE systems, with a major one
being the high degradation of the AEM. In general most AEMs are prone to low
chemical stability especially at elevated temperatures, which is mainly caused by

Off-Grid Green Hydrogen Production Systems
51
displacement of the ammonium group by the hydroxide ions [54]. Furthermore, in
the current development stage, performance is still lower when compared to PEMWE
due to the higher internal resistance of the membrane electrode assembly [48].
Although many studies have reported good potential in AEMWE technology, the
technology is still in research and development stage. Development is still needed,
especially in optimization of the materials for increased performance and lifetime.
Further tests with laboratory-scale demonstration units have to be performed to
improve the materials and get AEMWE to industrial scale [12, 55].
1.4
Green Hydrogen and Smart Grid Integration
Hydrogen as an energy carrier can play a signiﬁcant role in smart grid systems. The
term “smart grid” has been used for applications mainly involving the electricity
sector, and therefore, more accurate terminology is now required when hydrogen is
integrated into the system. A new paradigm is emerging in which multiple sectors
and infrastructures are integrated to beneﬁt from one another. The term “smart energy
system” is then used to deﬁne this concept more accurately [56]. Figure 6 presents
a generic scheme of a green hydrogen system integrated into a smart energy system.
Renewable power sources, such as wind and solar photovoltaic (PV), are used to
supply the electricity required to produce hydrogen in the electrolyzer plant. The
hydrogen can be pumped through the gas grid, which can be connected to other
producers and consumers within the smart energy grid. Therefore, the gas grid itself
can be considered an element of the smart energy grid.
The surplus electricity production is supplied to the electricity grid, which, in
turn, is part of the smart energy grid. A battery energy system is included to provide
steadier power supply to the electrolyzer, which also enhances the durability of the
electrolytic cells. The total solar PV peak power installed, the nominal wind power
deployed, and the battery capacity are variables that need to be optimized in addition
to the operation control of the system to ensure the best plant performance and
minimize the hydrogen production costs [57].
Intermittent renewable power generation presents a challenge for the stability
of the electricity grid and the supply–demand balance. Hydrogen could have an
important function to mitigate those effects. The scheme presented in Fig. 6 includes
a hydrogen storage, which operates as a buffer tank and supplies hydrogen to any
consumer throughout the gas grid. Besides that, from the electricity point of view,
a fuel cell plant can supply renewable power to the smart energy grid using the
hydrogen that was previously stored. In the event of surplus renewable electricity
generation, when it cannot be delivered into the electricity grid, the electrolyzer plant
can produce hydrogen and store it for a later use. In the same manner, when there is
a peak of electricity demand from the grid, stored hydrogen can be used in the fuel
cell plant to balance the electricity grid.

52
A. Ibáñez-Rioja et al.
Electrolyzer
Plant
Solar PV 
power
Wind power
Battery Energy 
System
Smart Energy System
End-use
Gas Grid
Fuel cell
Plant
Renewable
Electricity
Green Hydrogen 
Production
Surplus electricity 
production
Hydrogen
Storage
Electricity
Grid
Fig. 6 Integration of a green hydrogen system into a smart energy system. Because hydrogen and
not just electricity are incorporated into the smart energy system, the term smart energy system is
used in place of the term smart grid
In order to ensure renewable electricity production in the fuel cell plant, the
hydrogen to be supplied must have been produced with a renewable power source,
and therefore, the fuel plant is directly connected to the hydrogen storage and not
to the gas grid, in which the “color” of the hydrogen might not be ensured. The
principle of fuel cells is, in essence, the opposite to the electrolyzers. In fuel cells,
the electrochemical cells convert the chemical energy of hydrogen into electrical
energy. The energy conversion process has a higher efﬁciency than other conventional
technologies with signiﬁcantly lower greenhouse gas emissions [58].
Because of the low density of hydrogen gas and tendency to escape containers
due to small size and reactivity with metals and polymers, its storage represents a
challenging task. Various technologies have been developed and are currently being
investigated, with the main goal of increasing the storage density. For compressed
hydrogen gas, pipe storage is the most viable solution for the large-scale use, allowing
high storage pressures of approximately 100bar [59]. Therefore, the gas grid of the
smart energy system presented in Fig. 6 could be used not only for transporting
hydrogen but also as a storage method.

Off-Grid Green Hydrogen Production Systems
53
2
Dynamic Modelling and Analysis of an Industrial
Alkaline Water Electrolyzer Plant
In this section, a dynamic energy and mass balance modelling approach and anal-
ysis of a 3MW capacity and 16bar pressure industrial-scale alkaline water elec-
trolyzer (AWE) plant process is elaborated on. The industrial process is modelled in
a Simulink environment with integrated MATLAB system blocks, where the semi-
empirical mathematical models and balance equations are solved by object-oriented
programming. Each subsection provides information on the chosen technologies,
modelling approaches and balance equations of most unit operations.
2.1
Alkaline Water Electrolyzer Plant Process Overview
Figure 7 shows a typical industrial AWE plant process. The plant consists of the
electrolyzer stack and the peripheral supporting components, namely: (1) a power
supply system; (2) horizontal gas-liquid separation vessels; (3) centrifugal pumps; (4)
shell-and-tube heat exchangers; (5) an optional mixing scheme; (6) an intermediate
storage tank; and (7) a hydrogen puriﬁcation system [60].
Industrial-scale AWE stacks require hundreds of volts of DC voltage and thou-
sands of amperes of DC current [61], with minimum AC ripple, to achieve higher
electrolyzer efﬁciencies [62]. For larger-scale applications, these systems usually
Anode Side 
Electrolyte Circulation
Cathode Side 
Electrolyte Circulation
O2 + Electrolyte
99,999
H2  dry
[%]
H2
Purification
System
Mixer
Lye Cooler
Centrifugal
Pump
Lye Cooler
CWin
CWout
CWin CWout
Agitation  Process
/ Piping
Centrifugal
Pump
H2-Liquid
Separation
CWin
CWout
H2 Demister
H2 Cooler
H2-Liquid
Separation
O2-Liquid
Separation
H2 Buffer 
Tank
H2O 
Drainage
Alkaline water 
electrolysis
stack
H2O
treatment
system
H2O [kg/h]
Deionizer + Water storage + Feedwater
Flow
Hydrogen
Oxygen
Electrolyte
Feedwater
AC Source
O2 Vent
Transformer
6-pulse rectifier
DC
H2 + Electrolyte
Fig. 7 An example of a typical alkaline water electrolyzer plant process diagram

54
A. Ibáñez-Rioja et al.
consist of transformers to step down the voltage level and large current rectiﬁers in
combination with ﬁlters to convert the supplied AC to DC and improve the power
quality. The AWE stack receives the DC current, and converts the water into hydrogen
molecules in the catalyst plane of the cathode compartment, and oxygen molecules
in the catalyst surface of the anode compartment by water splitting reaction as shown
in Table 1.
The two-phase ﬂow of electrolyte solution and produced gas leave the stack and
enter the horizontal gas-liquid separation vessel, where the gas separates from the
electrolyte liquid by gravitational force. Next, a condenser cools the separated hydro-
gen gas until dew-point is reached to remove part of the moisture. A buffer tank then
intermediately stores the hydrogen and releases it at time intervals into the puriﬁ-
cation system to eliminate the remaining moisture and oxygen impurities from the
output hydrogen gas. Thus, the produced hydrogen is of very high purity. On the
anode circulation side, the produced oxygen gas typically undergo the same process
as the hydrogen, but for simpliﬁcation of the study, it is vented out.
At the bottom of the horizontal gas-liquid separation vessels, the separated elec-
trolyte solution recirculates back into the AWE stack with the aid of centrifugal
pumps. Before entering the stack, shell-and-tube heat exchangers cool the electrolyte
solution to balance and control the temperature of the stack at the desirable opera-
tional conditions. In addition, occasional mixing of the electrolyte before the stack
is necessary to maintain the concentration of potassium hydroxide the same between
the cathode and anode. The concentration may vary due to the yield of water on the
anode compartment and consumption at the cathode compartment.
2.2
Alkaline Water Electrolyzer Stack
Figure 8a shows a common bipolar AWE stack. The stack consists of multiple electro-
chemical cells connected in series. The foremost end plates serve as current collectors
and maintain the structure, usually with the help of tie rods. In a bipolar stack struc-
ture, the electrode (Fig. 8b, 4) splits two cells and functions as an anode in one cell
and as a cathode for the next one. In turn, the separator diaphragm (Fig. 8b, 3) acts
as a sealing gasket and prevents the hydrogen produced at the cathode compartment
to mix into the oxygen at the anode compartment, and vice versa [63].
Another conﬁguration option is the unipolar, where the stack comprises electro-
chemical cells in a parallel connection. Nevertheless, the bipolar conﬁguration is
commonly selected for industrial applications because of its compact design and
higher achievable current density [63]. However, in bipolar conﬁgurations the high
conductive electrolyte, which circulates through the connective manifold scheme,
can cause shunt currents and corrosion [64].
Figure8bshowsonecellofacommonbipolarstyleAWEstack.Agenericstructure
of the cell includes the following components:
1. Anode-side space for electrolyte ﬂow
2. Cathode-side space for electrolyte ﬂow

Off-Grid Green Hydrogen Production Systems
55
Fig. 8 Schematic of a common bipolar alkaline water electrolysis stack and b one cell schematic
3. Separator diaphragm/membrane
4. Bipolar plate (electrode)
5. Anode catalyst plane of the neighbor cell
6. Cathode catalyst plane
7. Cathode catalyst plane of the neighbor cell
8. Anode catalyst plane
9. Inlet manifold pipe
10. Outlet manifold pipe.
2.2.1
Electrochemical Model
The electrochemical model consists of several empirical correlations to describe the
cell voltage as a function of current density, temperature, and pressure and is based
on the Ulleberg’s model [65].
The reversible cell voltage, as explained in Sect. 1.2, expresses the minimum
electrical energy required for the water splitting reaction to occur and can be obtained
from the Nernst equation as [66]:

56
A. Ibáñez-Rioja et al.
Urev = Urev,0 + R T
z F ln
(P −Pv,KOH) (P −Pv,KOH)0.5)
aw,ele

,
(5)
where T and P express the temperature and the pressure in which the electrochem-
ical reaction takes place, and R is the universal gas constant. Urev,0 is the standard
equilibrium potential and can be empirically estimated from Eq. (6), based on [67]:
Urev,0 = 1.5184 −1.5421.10−3 · T + 9.526.10−5 · T · lnT + 9.84.10−8 · T 2. (6)
The vapor pressure of the solution, Pv,KOH, is calculated as shown in Eq. (7):
Pv,KOH = 10a · Pb
v,w
(7)
where a (Eq. 8) and b (Eq. 9) are experimental coefﬁcients, originally found from
[68].
a = −0.0151 · M −1.6788.10−3 · M2 + 2.2588.10−5 · M3,
(8)
b = 1 −1.2062.10−3 · M + 5.6024.10−4 · M2 −7.8228.10−6 · M3
(9)
In addition, the saturated water vapor pressure Pv,w can be obtained from the Antoine
equation Eq. (10).
Pv,w = 105.1962−(1730.63)/(−39.724+T ).
(10)
The water activity in potassium hydroxide is based on [68]; it is a function of the
molality and temperature of the solution and can be estimated as shown in Eq. (11).
aw,ele = exp

−0.05192 · M + 0.003302 · M2 + (3.177 · M −2.131 · M2)
T

.
(11)
The ohmic overpotential Uohm indicates the voltage drop between the anode and
cathode electrodes. This voltage drop arises owing to the resistance of the bipolar
plates, electrodes, current collectors, and their interconnections to the electron ﬂux,
as well as the resistance of electrolyte and membrane/diaphragm to the transport of
ion ﬂux [66]. The ohmic overpotential is proportional to the current supply and it
increases linearly with higher current densities. Based on [65], Eq. (12) expresses
the ohmic overpotential as a function of temperature, where α1 and α2 are ﬁtting
model parameters:
Uohm = α ic = (α1 + α2 T ) ic.
(12)

Off-Grid Green Hydrogen Production Systems
57
The activation overpotential Uact emerges from the anode and cathode reaction
kinetics or slowness of the electrochemical reactions [66], and depends on the elec-
trode materials, electrocatalytic properties, current density, temperature, pressure,
surface roughness, pH, adsorption of ions, and agitation. Based on [65], Eq. (13)
expresses the activation overpotential as a function of temperature, where β1, β2, β3
are ﬁtting model parameters and s describes the Tafel slope coefﬁcient:
Uact = s log(β ic + 1) = s log

β1 + β2
T + β3
T 2

ic + 1

.
(13)
All six electrochemical model parameters (α1, α2, β1, β2, β3, s) should be deter-
mined experimentally by ﬁtting calculated polarization curves to the measured polar-
ization curves. At least three curves are required at different temperatures.
2.2.2
Stack Mass Balance
Equation (14) expresses the mass balance of an AWE stack. The rate of change of
mass dm in time dt is equivalent to the total mass ﬂow rate of the electrolyte at the
inlet  ˙mele,i, subtracted by the total mass ﬂow rate of the electrolyte at the outlet
 ˙mele,j, with the addition of the total reaction rate rs. The total reaction rate
describes the overall yield of water in the stack, the production of oxygen gas in the
anode half cells, and the production of hydrogen gas in the cathode half cells.
dm
dt =

˙mele,i −

˙mele,j +

rs

.
(14)
2.2.3
Cell Mass Balance
Equation (15) describes the mass balance for one cell, where ˙mcat,i and ˙man,i represent
the mass ﬂow rates at the cathode and anode inlets of a single cell, and ˙mcat,j and
˙man,j are the mass ﬂow rates at the cathode and anode outlets of a single cell:
dm
dt = ( ˙mcat,i + ˙man,i) −( ˙mcat,j + ˙man,j).
(15)
The respective mass ﬂow rates at the inlet of a single cell are obtained as shown
in Eq. (16):
˙mcat,i = ˙man,i =
 ˙mele,i
2 Nc
.
(16)

58
A. Ibáñez-Rioja et al.
The mass ﬂow rate at the cathode outlet of a single cell is obtained as:
˙mcat,j = ˙mcat,i + ˙mH2 −˙mw,cn,
(17)
where ˙mH2 represents the mass ﬂow rate of the produced hydrogen gas, and ˙mw,cn is
the mass ﬂow rate of the consumed water.
The mass ﬂow rate at the anode outlet of a single cell is estimated as:
˙man,j = ˙man,i + ˙mO2 + ˙mw,pd,
(18)
where ˙mO2 serves as the mass ﬂow rate of the produced oxygen gas, and ˙mw,pd is the
mass ﬂow rate of the yielded water.
2.2.4
Thermal Model
This model uses a lumped-capacitance method, to estimate the temperature behavior
of the stack. The lumped system analysis assumes that the stack is submerged and
quenchedfromtheouteratmosphere,andtheinnertemperaturegradientsarespatially
uniform. This method is justiﬁable because the heat convection from the control
volume body to the environment is slower compared to the heat conduction within
the stack [60].
Equation (19) expresses the ODE to transiently estimate the temperature of the
stack. The left-hand side of the equation describes the rate of temperature change in
time, where Cs is the stack’s thermal capacitance constant. On the right-hand side of
the equation, the temperature of the stack increases due to the overpotential power
loss ˙Qloss and the power loss caused by the shunt currents ˙Qshunt, and decreases as a
result of the power loss to ambient ˙Qamb and because of the ﬂow of liquid electrolyte
which is colder as its cooled in the heat exchanger before entering the stack ˙Qliq.
Cs
dT
dt =
	 ˙Qloss + ˙Qshunt

−˙Qliq −˙Qamb.
(19)
The activation and ohmic overpotentials generate heat. Below the thermoneutral
voltage, the heat accelerates the electrochemical reactions. Above the thermoneutral
voltage, the heat dissipates in the stack and increases the cell/stack temperature. This
overpotential power loss can be obtained from [62]:
˙Qloss = Nc (Uc −Utn) I,
(20)
where Nc is the total number of cells, Utn is the thermoneutral voltage, and I the
current supply to the stack.
The heat exchangers at the anode and cathode circulation cool the recirculated
electrolyte ﬂow. This liquid ﬂow enters the stack and removes heat from it. This
cooling can be estimated as:

Off-Grid Green Hydrogen Production Systems
59
˙Qliq = ˙mele,i Cp,ele (Ts −Tele,i),
(21)
where ˙mele,i is the mass ﬂow rate of the electrolyte at the inlet of the stack, Cp,ele
is the speciﬁc heat of the electrolyte solution, Tele,i expresses the temperature of the
electrolyte at inlet, and Ts is the temperature of the stack.
The heat loss from the stack to the outer environment is estimated as radiative
˙Qrad and free-convection ˙Qcnv transfer heat and is obtained from:
˙Qamb = ˙Qrad + ˙Qcnv = σ As ε
	
T 4
s −T 4
amb

+ h As (Ts −Tamb),
(22)
where As expresses the outer surface area of the stack, σ is the Stefan-Boltzmann
constant, ε describes the emissivity of the outer material, Tamb is the ambient tem-
perature, and h is the average heat transfer coefﬁcient, which can be calculated by
Eq. (23), where k is the thermal conductivity of the outer material, Nu is the Nusselt
number and, D is the diameter of the stack. Similar numbers can also be calculated
from the correlation in Eq. (24) for natural convection of horizontal cylinders:
h = Nu k
D ,
(23)
h = 1.32 ·
Ts −Tamb
D
0.25
.
(24)
The thermal capacitance describes the required heat to increase the temperature of the
system by a unit [69]. Equation (25) shows the overall thermal capacitance constant
of the stack Cs. This constant is a function of density ρi, heat capacity Ci, and volume
Vi of each discrete element composing one cell in the arrangement of the total stack
[62]. As explained in Sect. 2.2, a typical AWE cell contains a bipolar plate, a separator
diaphragm/membrane, and two electrolyte ﬂow channels for the anodic and cathodic
faces:
Cs =

ρi Ci Vi

Nc,
(25)
Cs = (ρbi Cbi Vbi + ρmem Cmem Vmem + 2 ρele Cele Vele) Nc,
(26)
where subscripts bi, mem and ele symbolize the bipolar plate, the membrane and the
electrolyte space respectively.
2.3
Horizontal Gas-Liquid Separation Vessel
Industrial-scale AWE plants employ horizontal gas-liquid separation vessels to iso-
late the end-product gas from the electrolyte (liquid). Figure 9 describes the separa-
tion vessel on the cathode circulation side. The mixture ﬂow (two-phase) enters the

60
A. Ibáñez-Rioja et al.
Electrolyte
Electrolyte
Makeup H2O
Liquid gravity separation section
H2
Electrolyte
H2,imp
H2
Interconnection
Electrolyte flow
O2,imp
O2,imp
O2,imp
Gas gravity separation section
Fig. 9 Horizontal gas-liquid separation vessel at the cathode circulation side
separation vessel through the feed pipe. During the gas-gravity separation section, the
heavier liquid droplets separate from the hydrogen and oxygen (impurity gas) bub-
bles. Even though most of the bubbles successfully separate, or degas, from the liquid
phase and end up in the upper right-side outlet, a small percentage of the hydrogen
and oxygen bubbles dissolve in the liquid and end up in the lower right-side outlet
and eventually circulate in the process scheme as impurities [70].
The gas-gravity section removes most of the liquid droplets (mist) travelling
upwards in the vessel. Demisters installed at the inside or outside the separation
vessel, eliminate the remaining droplets. As shown in Fig. 7, a condenser (cooler)
after the separation vessel and before the demister can enhance the efﬁciency of the
mist extraction process.
A pipeline connects the cathode-side separation vessel to that of the anode-side.
The interconnection pipe balances the liquid height, temperature, pressure, and potas-
sium hydroxide concentration between the separation tanks. However, impurities in
the system increase as a result of the dissolved hydrogen and oxygen crossing to the
electrolyte circulation of the opposite electrode via the pipeline.
Finally, a makeup feed water ﬂow is necessary to maintain the liquid level inside
the separation vessels and compensate for the water consumption during the electro-
chemical reactions in the stack.
2.3.1
Mass Balance
Equation (27) shows the total mass balance of the horizontal gas-liquid separation
vessel at the cathode circulation side. The equation states that the rate of mass change

Off-Grid Green Hydrogen Production Systems
61
over time dt is equivalent to the total mass ﬂow rate at the inlet  ˙mi, minus the
overall mass ﬂow rate at the outlet  ˙mj:
dm
dt =

˙mi −

˙mj.
(27)
Equation (28) describes the total mass ﬂow rate at the inlet:

˙mi = ˙mH2,i + ˙mO2,imp,i + ˙mele,i + ˙mm,i,
(28)
where ˙mH2,i is the mass ﬂow rate of hydrogen bubbles, ˙mO2,imp,i is the mass ﬂow rate
of oxygen bubbles (impurities), ˙mele,i expresses the mass ﬂow rate of the electrolyte
liquid, and ˙mm,i is the makeup feed water mass ﬂow rate. Equation (29) describes
the total mass ﬂow rate  ˙mj at the outlet:

˙mj =
	
˙mH2,i ηs,H2 + ˙mO2,imp, i ηs,O2 + ˙mele,i (1 −ηsl)

+
	
˙mele,i ηsl + ˙mH2,i (1 −ηs,H2) + ˙mO2,imp,i (1 −ηs,O2) + ˙mm,i

,
(29)
where ηs,H2 is the separation efﬁciency of the hydrogen gas and ηs,O2 is the separation
efﬁciency of the oxygen gas. Estimation of these parameters requires either empir-
ical models of the dissolution of hydrogen and oxygen in the potassium hydroxide
solution, such as [71], or ﬁtting with measurements from a real identical process. Fur-
thermore, nsl expresses the separation efﬁciency of the liquid, which, with a proper
mist extractor process, can be very close to one. Equation (30) describes the mass
ﬂow rate of makeup feed-water at the inlet:
˙mm,i = ( ˙mw,cn) + ( ˙mele,j,an,up + ˙mele,j,cat,up),
(30)
where ˙mw,cn is the overall water consumption due to the electrochemical reaction
of water splitting, ˙mele,j,an,up and ˙mele,j,cat,up express the total liquid that is entrained
upwards in the separation vessels of the anode and cathode side circulation respec-
tively.
The inﬂuence of the interconnection pipe is not shown in Eqs. (27), (28) and (29).
The pipe adds electrolyte, hydrogen, and oxygen ﬂow to the vessel with lower liquid
height and removes the ﬂow from the vessel with higher liquid height until height
balance has occurred.
2.3.2
Energy Balance
Equation (31) describes the energy balance of the horizontal gas-liquid separation
vessel at the cathode side circulation:
Csep
dT
dt = ˙Qheat −˙Qamb −˙Qsensible −˙Qcool.
(31)

62
A. Ibáñez-Rioja et al.
where Ct,sep is the overall thermal capacitance of the tank, ˙Qheat expresses the increase
of heat due to the hot electrolyte, hydrogen and oxygen ﬂow coming from the stack,
˙Qamb describes the heat loss from the tank to the ambient, ˙Qsensible is the heat loss
exiting the vessel with electrolyte, hydrogen and oxygen ﬂow, and ˙Qcool is the cooling
of the tank due to the cold makeup feed-water ﬂow.
The horizontal gas-liquid separation vessel at the anode side circulation follows
the same mass and energy balances apart from the makeup feed-water inﬂuence.
2.4
Shell-and-Tube Heat Exchanger
Industrial-scale AWE plants typically use recuperative shell-and-tube heat exchang-
ers to control and maintain the temperature of the stack in optimal thermodynamic
conditions. As explained in Sect. 2.2.4, the stack temperature increases as a result of
the power loss caused by the overpotentials and the shunt currents. An elevated tem-
perature favors the reaction kinetics. However, at the same time higher temperature
accelerates the corrosion of the mechanical structure.
To simplify the calculations, one shell and one tube pass model is assumed, where
the ﬂow between the hot and cold tubes is in parallel. Such models are solved via
the ﬁrst law of thermodynamics [72]. Thus, the energy balance is obtained as:
q = ˙mh Ch (Thi −Thj) = ˙mcd Ccd (Tcdj −Tcdi),
(32)
where ˙mh and ˙mcd describe the mass ﬂow rate of the electrolyte and cooling water,
Ch and Ccd express the heat capacity rate of the electrolyte and cooling water, Thi and
Thj are the temperatures of the electrolyte at the inlet and outlet of the heat exchanger,
and Tcdi and Tcdj are the temperatures of the cooling water at the inlet and outlet.
Proportional-integral (PI) or proportional-integral-derivative (PID) controllers
maintain the temperature of the electrolyte at the outlet of the heat exchanger at
desired set-point. The controller receives the signal temperature of the electrolyte
ﬂow and accordingly changes the inlet mass ﬂow rate of the cooling water by elec-
tronically adjusting the valve position. This action retains the electrolyte temperature
at the inlet of the stack at constant values.
2.5
Centrifugal Pump
Centrifugal pumps with three-phase motors recirculate the electrolyte liquid back to
the electrolyzer stack. The pumps ensure that the mass ﬂow rate of the electrolyte
is adequate to remove the produced hydrogen and oxygen bubbles from the elec-
trochemical stack. At a low liquid mass ﬂow rate, the produced bubbles tend to
accumulate and stick in the electrode plane creating gas layers, which deactivate the

Off-Grid Green Hydrogen Production Systems
63
electrode area, increase the ohmic resistance, and hinder the water splitting reaction,
resulting in a lower hydrogen and oxygen production [73].
In addition, the pumps control the thermal behavior of the stack. At a high recir-
culation liquid mass ﬂow rate, the temperature of the stack decreases because of the
higher values of ˙Qliq, presented in Eq. (21), and vice versa at a low liquid mass ﬂow
rate.
2.6
Puriﬁcation System
The hydrogen puriﬁcation scheme essentially incorporates a deoxidizer vessel, a
horizontal gas-liquid separation vessel, and an adsorption system. The incoming
hydrogen gas with oxygen impurities enters the deoxidizer, where most of the oxygen
impurities react with hydrogen molecules to form water. In continuity, the moist
hydrogen gas is then directed into a small horizontal gas-liquid separation vessel to
reduce the water content. Finally, the hydrogen gas is sent to the drying process to
eliminate all the moisture, resulting in a pure hydrogen ﬂow, ready to be compressed
and stored.
2.6.1
Deoxidizer
The oxygen removal occurs in an aluminum-based palladium deoxidizer. The deox-
idizer chemical reactor contains a u-shaped pipe wherein the hydrogen and oxygen
gas molecules contact the palladium surface, initiating the reaction of water recom-
bination:
2H2(g) + O2(g) →2H2O(g) + 244.9 kJ mol−1.
(33)
In industrial applications, the oxygen in hydrogen concentration at the outlet is lower
than 0.1ppm. Because the reaction is exothermic, the hydrogen feed from the inter-
mediate buffer tank controls the temperature of the chemical reactor, which is usually
around 130–150 ◦C.
2.6.2
Adsorption System
The purpose of the adsorption process is to eliminate the moisture content from the
gas. This scheme usually consists of two ﬁxed beds, one operating in the adsorption
phase and one in the regeneration phase [74], where highly porous solid granules
(such as Zeolite 13X) ﬁll the ﬁxed beds.
Intheadsorptionphase,theproductgaswithmoisturecontinuouslypassesthrough
the bed, and the water vapor is adsorbed in the surface layers of the granules until
the granules are nearly saturated. Then, the ﬂow is switched to the second bed, and
the bed that was saturated is regenerated. In industrial applications, the phases are

64
A. Ibáñez-Rioja et al.
automatically switched at a scheduled time or when the accumulation of moisture in
the exit ﬂuid reaches a certain limit.
In the regeneration phase, hot gasses passing through the bed or electric heaters
installed inside the bed heat up the ﬁxed bed. The higher temperatures provide the
energy for desorption, and the moisture is released from the surface of the granules
into the hot gas ﬂow. Then, the moisture is vented out or removed in a condenser.
2.7
Dynamic Plant Process Modelling Methodology
The plant process is dynamically modelled as shown in Fig. 10. The transient process
model is based on semi-empirical mathematical models and on the solution of the
energy and mass balance of each unit operation. Each of the components has its
own system block. The system blocks are solved by object-oriented programming in
MATLAB and are connected to each other in MATLAB Simulink.
Each MATLAB system block receives certain data signals as the input and pro-
duces a deﬁnite number of data signals as the output, on a time step basis. These
data signals contain the basic thermodynamic properties of the hydrogen, oxygen,
and electrolyte ﬂow, and they are transferred from one unit operation to the next one.
The DC current supplied to the stack, in each time step, is the main transient force
of the entire process [60].
Fig. 10 MATLAB Simulink diagram and process model methodology, adapted from [60]

Off-Grid Green Hydrogen Production Systems
65
The dynamic process model is validated with real industrial data taken from a
3MW alkaline water electrolyzer plant. The validation and results can be found in
publication [60].
3
Off-Grid Alkaline Water Electrolyzer Systems
In Sect. 1, the role of green hydrogen in the energy sector and its integration into
smart energy systems were introduced. Section 2 described the model of an indus-
trial alkaline water electrolyzer plant that was validated with real data. This chapter
concludes by presenting the simulation results of an off-grid industrial alkaline water
electrolyzer. The studied system showed in Fig. 11 is consisting of a solar PV instal-
lation, an on-shore wind farm, an alkaline water electrolyzer and a battery energy
storage system (BESS). The produced hydrogen is assumed to be puriﬁed and ready
to be supplied to an end user. In the framework presented in Fig. 6 of a smart energy
system, the hydrogen can be pumped to the gas grid or stored. For the following anal-
ysis, the surplus electricity production is assumed to be redirected to the electricity
grid.
A ﬁnite-state machine controller deﬁnes the energy distribution in each time step
during the simulation. The component capacities and control of the system are opti-
mized simultaneously to minimize the cost of hydrogen production by following
the simulation methodology presented in [57]. The plant simulation is based on
real solar PV and wind power production data collected during the year 2021 from
Electrolyzer
Plant
Solar PV 
power
Wind power
Battery Energy 
System
Grid
Green Hydrogen 
Production
End-use
Surplus electricity
production
Control
System
Fig. 11 Conﬁguration of an off-grid green hydrogen production plant. Surplus electricity produc-
tion from solar PV and wind is assumed to be redirected to a electricity grid

66
A. Ibáñez-Rioja et al.
Fig. 12 Optimal capacity for the components (a) and (b) average annual FLHs during the 30years
simulation
installations located in southeastern Finland. By replicating the annual data, the total
simulation time is 30years with a 5min time-step resolution. The simulation includes
the degradation of the electrolytic cells, the photovoltaic cells, and the lithium ion
batteries.
The bar chart in Fig. 12a shows the optimal capacity of each component. The
installation prices of each component are obtained from [75] and estimated prices
foryear2040areusedinthesimulation.Componentpricesforearlieryearsyieldsinto
an optimal system conﬁguration with no solar PV nor battery, therefore prices of year
2040 are used to demonstrate the operation of the system when all the components
are installed. In the optimized system, for a ﬁxed 100MW nominal alkaline water
electrolyzer, the optimal solar PV peak power capacity is 125.4MW, the nominal
wind power is 121.7MW, and a BESS of 41.9MWh energy capacity.
Full load hours (FLHs) is a measure of the utilization of certain installation or
equipment and it is deﬁned as the maximum annual energy output, or consumed
energyinthecaseoftheelectrolyzer,dividedbyitsnominalpower.Currentlythereare
signiﬁcant geographical differences in hydrogen production cost, and its economic
potential is dependent on elements that will continue changing, such as price of
the fossil fuels and electricity. Water electrolysis requires 3000 to 6000 FLHs to
become cost-competitive when compared to hydrogen produced with steam methane
reforming (with carbon capture) [76]. Bar chart in Fig. 12b shows that average
FLHs for the alkaline electrolyzer in the simulated case are 4304h per year. In this
case, FLHs of the solar PV installation are signiﬁcantly lower than the wind power
production due essentially to the low solar PV production during the Finnish winter.
Despite the intermittency of the electricity production, hydrogen production in
the electrolyzer plant can be optimized to perform under these conditions. Figure 13
shows 25h operation time of the total 30years simulated. The battery is used to
maximize and stabilize the power supplied to the electrolyzer, and it is charged when
the solar PV and wind power are unable to maintain the electrolyzer running at its
minimum load, which was ﬁxed to 20 % of its nominal load. The electrolyzer is using

Off-Grid Green Hydrogen Production Systems
67
Fig. 13 Excerpt of 25h from the 30years simulation of the plant. Time-step resolution is 5 min
the battery to increase the production by operating with all the energy available in the
system. Approximately between the hours 2935 and 2936, it can be observed that the
electrolyzer is at maximum load while the battery is being charged simultaneously.
Once the battery is fully charged around hour 2937, there is a surplus of electricity
production.
It is clear that the production of hydrogen in an off-grid system is strongly variable
for short time intervals and fully dependent on the climate conditions in where it
has been installed. However, for longer time periods the total hydrogen production
can be estimated more accurately. Figure 14 shows the percentage of the surplus
production and the hydrogen production for each simulated year. The hydrogen
production decreases gradually during the ﬁrst 13 years due to the degradation of the
electrolyzer cells, after that, there is a replacement taking place in year 14. Similar
behaviour can be seen in year 27.
Degradation of the solar PV cells explains the decrease of surplus production
during the 30 years, as the PV cells are not replaced in the simulation. On the other
hand, the gradual increases of the surplus between years 2–11, 13–24 and 25–30
are caused by the capacity and power fade of the battery due to the degradation in
operation [77]. In years 11–13 and 23–25 there are abrupt reductions in the surplus
due to the battery replacements.
Off-grid green hydrogen production via water electrolysis integrated with solar
PV and wind power generator presents certain challenges mainly caused by the
intermittence of the electricity production. The ramp-up of the plant can last up to 1h
until the plant reaches its nominal production capacity, depending on the initial stack
temperature [60]. Hydrogen production can be stabilized if a battery is installed in the
system, however to further improve the supply stability and meet the requirements
of certain consumers from energy and industry sectors, hydrogen storage is needed.

68
A. Ibáñez-Rioja et al.
Fig. 14 Percentage of the annual surplus energy divided by the total electricity generation from
solar PV and wind (left axis). Annual hydrogen production (right axis)
In a smart energy system made up of gas and electricity grids, consumers and
producers can interact to beneﬁt from each other. For instance, the surplus electricity
production in the previous simulation, which represents around 7.2 % of the total
annual electricity production of the plant, could be redirected to the electricity grid
and used by another consumer or external energy storage operator in the smart energy
system. In the same manner, the end-use of the produced hydrogen illustrated in
Fig. 11 could be the gas-grid or any other hydrogen consumer within the smart
energy system.
References
1. IEA (2019) World energy outlook 2019. Technical report Paris: IEA, p 810
2. Bogdanov D et al (2021) Low-cost renewable electricity as the key driver of the global energy
transitiontowardssustainability.Energy227:120467.issn:0360-5442. https://doi.org/10.1016/
j.energy.2021.120467. (July 2021)
3. Eyring V et al (2021) Human inﬂuence on the climate system. In: Masson-Delmontte V et al
(eds) Climate change 2021: the physical science basis. Contribution of working group I to the
sixth assessment report of the intergovernmental panel on climate change. Bridge University
Press, Cambridge, pp 423–552
4. Erker S, Stangl R, Stoeglehner G (2017) Resilience in the light of energy crises - part I: a
framework to conceptualise regional energy resilience. J Clean Prod 164:420–433. issn: 0959-
6526. https://doi.org/10.1016/j.jclepro.2017.06.163. (Oct 2017)
5. IEA (2021) World energy outlook 2021. Technical report Paris: IEA, p 386
6. IRENA (2021) Renewable power generation costs in 2021. Technical report 2021
7. IRENA (2022) Renewable capacity highlights 2022. Technical report IRENA, p 3. (Apr 2022)
8. Vartiainen E et al (2021) True cost of solar hydrogen. In: Solar RRL, vol 6.5, p 2100487. (Sept
2021). issn: 2367-198X, 2367-198X. https://doi.org/10.1002/solr.202100487

Off-Grid Green Hydrogen Production Systems
69
9. Krüger A et al (2020) Integration of water electrolysis for fossil-free steel production. Int J
Hydrog Energy 45(55):29966–29977. (Nov 2020). issn: 0360-3199.https://doi.org/10.1016/j.
ijhydene.2020.08.116
10. Steinfeld A (2002) Solar hydrogen production via a two-step water-splitting thermochemical
cycle based on Zn/ZnO redox reactions. Int J Hydrog Energy 27(6):611–619. (June 2002). issn:
03603199. https://doi.org/10.1016/S0360-3199(01)00177-X
11. Buttler A, Spliethoff H (2018) Current status of water electrolysis for energy storage, grid
balancing and sector coupling via powerto-gas and power-to-liquids: a review. Renew Sustain
Energy Rev 82:2440–2454. (Feb 2018). issn: 13640321. https://doi.org/10.1016/j.rser.2017.
09.003
12. IEA (2015) Technology roadmap-hydrogen and fuel cells. Technical report. IEA, Paris, p 81
13. Jupudi RS, Zappi G, Bourgeois R (2007) Prediction of shunt currents in a bipolar electrolyzer
stack by difference calculus. J Appl Electrochem 37(8):921–931. (June 2007). issn:0021-891X,
1572-8838. https://doi.org/10.1007/s10800-007-9330-4
14. Schalenbach M et al (2013) Pressurized PEM water electrolysis: efﬁciency and gas crossover.
Int J Hydrog Energy 38(35):14921–14933. (Nov 2013). issn: 0360-3199. https://doi.org/10.
1016/j.ijhydene.2013.09.013
15. Olivier P, Bourasseau C, Bouamama PB (2017) Low-temperature electrolysis system mod-
elling: a review. Renew Sustain Energy Rev 78:280–300. (Oct. 2017). issn: 13640321. https://
doi.org/10.1016/j.rser.2017.03.099
16. Ruuskanen V et al (2020) Power quality estimation of water electrolyzers based on current and
voltage measurements. J Power Sources 450:227603. (Feb 2020). issn: 0378-7753. https://doi.
org/10.1016/j.jpowsour.2019.227603
17. Trasatti S (1999) Water electrolysis: who ﬁrst?. J Electroanal Chem 476(1):90–91. (Oct 1999).
issn: 15726657. https://doi.org/10.1016/S0022-0728(99)00364-2
18. Smolinka T et al (2021) Chapter 4: the history of water electrolysis from its beginnings to the
present. In: Electrochemical power sources: fundamentals, systems, and applications: hydrogen
production by water electrolysis. Elsevier, San Diego, The Netherlands, pp 83–163. isbn: 978-
0-12-819425-6
19. Ursua A, Gandia LM, Sanchis P (2012) Hydrogen production from water electrolysis: current
status and future trends. Proc IEEE 100(2):410–426. (Feb 2012). issn: 0018-9219. https://doi.
org/10.1109/JPROC.2011.2156750
20. Jarvinen L (2020) Design of a PEM electrolyzer test station for experimentation on power
quality induced efﬁciency loss and cell degradation. MA thesis. Lappeenranta, Finland:
Lappeenranta-LahtiUniversity of Technology LUT, 2020
21. Carmo M et al (2013) A comprehensive review on PEM water electrolysis. Int J Hydrog Energy
38(12):4901–4934. (Apr 2013). issn: 03603199. https://doi.org/10.1016/j.ijhydene.2013.01.
151
22. Leroy R (1983) Industrial water electrolysis: present and future. Int J Hydrogen Energy
8(6):401–417. issn: 03603199. https://doi.org/10.1016/0360-3199(83)90162-3
23. Lehner M et al (2014) Power-to-gas: technology and business models. SpringerBriefs in
Energy. Springer International Publishing, Cham. isbn: 978-3-319-03994-7 978-3-319-03995-
4. https://doi.org/10.1007/978-3-319-03995-4
24. Russell JH, Nuttall LJ, Fickett AP (1973) Hydrogen generation by solid polymer electrolyte
water electrolysis. Am Chem Soc Div Fuel Chem Prepr 18:24–40
25. Nail JM et al (2003) The evolution of the PEM stationary fuel cell in the U.S. innovation
system, p 68
26. Slade S et al (2002) Ionic Conductivity of an extruded Naﬁon 1100 EW series of membranes.
J Electrochem Soc 149(12):A1556. issn: 00134651. https://doi.org/10.1149/1.1517281
27. Stansberry JM, Brouwer J (2020) Experimental dynamic dispatch of a 60 kW proton exchange
membrane electrolyzer in power-to-gas application. Int J Hydrog Energy 45(16):9305–9316.
(Mar 2020). issn: 03603199. https://doi.org/10.1016/j.ijhydene.2020.01.228
28. Hancke R, Holm T, Ulleberg O (2022) The case for high-pressure PEM water electrolysis.
Energy Convers Manag 261:115642. (June 2022). issn: 01968904. https://doi.org/10.1016/j.
enconman.2022.115642

70
A. Ibáñez-Rioja et al.
29. Bernt M et al (2020) Current challenges in catalyst development for PEM water electrolyz-
ers. Chemie Ingenieur Technik 92(1–2):31–39. issn: 1522-2640. https://doi.org/10.1002/cite.
201900101
30. Minke C et al (2021) Is iridium demand a potential bottleneck in the realization of large-
scale PEM water electrolysis?. Int J Hydrog Energy 46(46):23581–23590. (July 2021). issn:
0360-3199. https://doi.org/10.1016/j.ijhydene.2021.04.174
31. Feng Q et al (2017) A review of proton exchange membrane water electrolysis on degrada-
tion mechanisms and mitigation strategies. J Power Sources 366:33–55. (Oct. 2017). issn:
03787753. https://doi.org/10.1016/j.jpowsour.2017.09.006
32. Falcão DS (2020) A review on PEM electrolyzer modelling: guidelines for beginners. J Clean
Prod 10
33. Hernández-Goómez Á, Ramirez V, Guilbert D (2020) Investigation of PEM electrolyzer mod-
eling: electrical domain, efﬁciency, and speciﬁc energy consumption. Int J Hydrog Energy
45(29):14625–14639. (May 2020). issn: 03603199. https://doi.org/10.1016/j.ijhydene.2020.
03.195
34. Doenitz W, Schmidberger R, Steinheil E (1980) Hydrogen Production by High Temperature
Electrolysis of Water Vapour, p 9
35. Donitz W (1985) High-temperature electrolysis of water vapor? Status of development and
perspectives for application. Int J Hydrog Energy 10(5):291–295. issn: 03603199. https://doi.
org/10.1016/0360-3199(85)90181-8
36. Salzano F (1985) Water vapor electrolysis at high temperature: systems considerations and
beneﬁts. Int J Hydrog Energy 10(12):801–809. issn: 03603199. https://doi.org/10.1016/0360-
3199(85)90168-5
37. Hong HS et al (2005) Microstructure and electrical conductivity of Ni/YSZ and NiO/YSZ
composites for high-temperature electrolysis prepared by mechanical alloying. J Power Sources
149:84–89. (Sept 2005). issn: 03787753. https://doi.org/10.1016/j.jpowsour.2005.01.057
38. Liang M et al (2009) Preparation of LSM-YSZ composite powder for anode of solid oxide
electrolysis cell and its activation mechanism. J Power Sources 190(2):341–345. (May 2009).
issn: 03787753. https://doi.org/10.1016/j.jpowsour.2008.12.132
39. Yanagida H, Koumoto K, Miyayama M (1996) Chemistry of ceramics. Wiley-Blackwell,
Chichester; New York. (Sept 1996). isbn: 978-0-471-96733-0
40. Takeuchi T et al (2002) Improvement of mechanical strength of 8 mol % Yttria-stabilized
zirconia ceramics by spark-plasma sintering. J Electrochem Soc 149(4):A455. ISSN 00134651.
https://doi.org/10.1149/1.1456915
41. Schefold J, Brisse A, Tietz F (2011) Nine thousand hours of operation of a solid oxide cell in
steam electrolysis mode. J Electrochem Soc 159(2):A137–A144. issn: 0013-4651, 1945-7111.
https://doi.org/10.1149/2.076202jes
42. Virkar AV (2010) Mechanism of oxygen electrode delamination in solid oxide electrolyzer
cells. Int J Hydrog Energy 35(18), pp 9527–9543. (Sept 2010). issn: 03603199. https://doi.org/
10.1016/j.ijhydene.2010.06.058
43. Alenazey F et al (2015) Production of synthesis gas (H2 and CO) by high-temperature co-
electrolysis of H2O and CO2. Int J Hydrog Energy 40(2): 10274–10280. (Aug 2015). issn:
03603199. https://doi.org/10.1016/j.ijhydene.2015.06.034
44. Li W et al (2013) Performance and methane production characteristics of H2O-CO2 co-
electrolysis in solid oxide electrolysis cells. Int J Hydrog Energy 38(25):11104–11109. (Aug
2013). issn: 03603199. https://doi.org/10.1016/j.ijhydene.2013.01.008
45. Ebbesen SD et al (2014) High temperature electrolysis in alkaline cells, solid proton conducting
cells, and solid oxide cells. Chem Rev 114(21):10697–10734. (Nov 2014). issn: 0009-2665,
1520-6890. https://doi.org/10.1021/cr5000865
46. Zhu M, Ge Q, Zhu X (2020) Catalytic reduction of CO2 to CO via reverse water gas shift
reaction: recent advances in the design of active and selective supported metal catalysts. Trans
Tianjin Univ 26(3):172–187. (June 2020). issn: 1995-8196. https://doi.org/10.1007/s12209-
020-00246-8

Off-Grid Green Hydrogen Production Systems
71
47. Lim A et al (2019) A Study on electrode fabrication and operation variables affecting the
performance of anion exchange membrane water electrolysis. J Ind Eng Chem 76:410–418.
(Aug 2019). issn: 1226086X. https://doi.org/10.1016/j.jiec.2019.04.007
48. Vincent I, Bessarabov D (2018) Low cost hydrogen production by anion exchange membrane
electrolysis: a review. Renew Sustain Energy Rev 81:1690–1704. (Jan 2018). issn: 13640321.
https://doi.org/10.1016/j.rser.2017.05.258
49. Du N et al (2022) Anion-exchange membrane water electrolyzers. Chem Rev 122(13):11830–
11895.(July2022).issn:0009-2665,1520-6890.https://doi.org/10.1021/acs.chemrev.1c00854
50. Miller HA et al (2020) Green hydrogen from anion exchange membrane water electrolysis: a
review of recent developments in critical materials and operating conditions. Sustain Energy
Fuels 4(5):2114–2133. issn: 2398-4902. https://doi.org/10.1039/C9SE01240K
51. Wang T et al (2015) MOF-derived surface modiﬁed Ni nanoparticles as an efﬁcient catalyst
for the hydrogen evolution reaction. J Mater Chem A 3(32):16435–16439. issn: 2050-7488,
2050-7496. https://doi.org/10.1039/C5TA04001A
52. Dionigi F, Strasser P (2016) NiFe-based (Oxy) hydroxide catalysts for oxygen evolution reac-
tion in non-acidic electrolytes. Adv Energy Mater 6(23):1600621. (Dec 2016). issn: 16146832.
https://doi.org/10.1002/aenm.201600621
53. Ito H et al (2018) Investigations on electrode conﬁgurations for anion exchange membrane
electrolysis. J Appl Electrochem 48(3):305–316. (Mar 2018). issn: 0021-891X, 1572-8838.
https://doi.org/10.1007/s10800-018-1159-5
54. Varcoe JR, Slade RCT (2005) Prospects for alkaline anion-exchange membranes in low tem-
perature fuel cells. Fuel Cells 5(2):187–200. (Apr 2005). issn: 16156846. https://doi.org/10.
1002/fuce.200400045
55. Singh MR, Xiang C, Lewis NS (2017) Evaluation of ﬂow schemes for near-neutral pH elec-
trolytes in solar-fuel generators. Sustain Energy Fuels 1(3):458–466. issn: 2398-4902. https://
doi.org/10.1039/C7SE00062F
56. Lund H et al (2017) Smart energy and smart energy systems. Energy 137:556–565. (Oct 2017).
issn: 03605442. https://doi.org/10.1016/j.energy.2017.05.123
57. Ibáñez-Rioja A et al (2022) Simulation methodology for an off-grid solar-battery-water elec-
trolyzer plant: simultaneous optimization of component capacities and system control. Appl
Energy 307:118157. (Feb 2022). issn: 03062619. https://doi.org/10.1016/j.apenergy.2021.
118157
58. Jiang SP, Li Q (2022) Introduction to fuel cells: electrochemistry and materials. Springer
Singapore, Singapore. isbn: 978-981-10- 7625-1 978-981-10-7626-8. https://doi.org/10.1007/
978-981-10-7626-8
59. Andersson J, Grönkvist S (2019) Large-scale storage of hydrogen. Int J Hydrog Energy
44(23):11901–11919. (May 2019). issn: 03603199. https://doi.org/10.1016/j.ijhydene.2019.
03.063
60. Sakas G et al (2022) Dynamic energy and mass balance model for an industrial alkaline water
electrolyzer plant process. Int J Hydrog Energy 47(7):4328–4345. (Jan 2022). issn: 03603199.
https://doi.org/10.1016/j.ijhydene.2021.11.126
61. Yodwong B et al (2020) AC-DC converters for electrolyzer applications: state of the art and
future challenges. Electronics 9(6):912. (June 2020). issn: 2079-9292. https://doi.org/10.3390/
electronics9060912
62. Diéguez PM et al (2008) Thermal performance of a commercial alkaline water electrolyzer:
experimental study and mathematical modeling. Int J Hydrog Energy 33(24):7338–7354. (Dec
2008). issn: 0360-3199. https://doi.org/10.1016/j.ijhydene.2008.09.051
63. Abe I (2009) Alkaline water electrolysis. In: Energy carriers and conversion systems, vol I.
EOLSS Publishers, pp 146–166. isbn: ISBN-978-1- 905839-29-2
64. Prokopius PR (1976) Model for calculating electrolytic shunt path losses in large electrochem-
ical energy conversion systems. In: NASA TM X-3359, p 14
65. Ulleberg O (2003) Modeling of advanced alkaline electrolyzers: a system simulation approach.
Int J Hydrog Energy 28(1):21–33. (Jan 2003). issn: 03603199. https://doi.org/10.1016/S0360-
3199(02)00033-2

72
A. Ibáñez-Rioja et al.
66. UrsúaA,SanchisP(2012)Static-dynamicmodellingoftheelectricalbehaviourofacommercial
advanced alkaline water electrolyser. Int J Hydrog Energy 37(24):18598–18614. (Dec 2012).
issn: 03603199. https://doi.org/10.1016/j.ijhydene.2012.09.125
67. LeRoy RL, Bowen CT, LeRoy DJ (1980) The thermodynamics of aqueous water electrolysis.
J Electrochem Soc 127(9):1954–1962. (Sept 1980). issn: 0013-4651, 1945-7111. https://doi.
org/10.1149/1.2130044
68. Balej J (1985) Water vapour partial pressures and water activities in potassium and sodium
hydroxide solutions overwide concentration and temperature ranges. Int J Hydrog Energy
10(4):233–243. issn: 03603199. https://doi.org/10.1016/0360-3199(85)90093-X
69. Incropera FP, DeWitt DP (eds) (2007) Fundamentals of heat and mass transfer, 6th edn. Wiley,
Hoboken, NJ. isbn: 978-0-471-45728-2
70. Daniel AB (2018) Gas evolution and gas-liquid separator modeling. PhD thesis. Oklahoma
State University
71. Haug P, Koj M, Turek T (2017) Inﬂuence of process conditions on gas purity in alkaline water
electrolysis. Int J Hydrog Energy 42(15):9406–9418. (Apr 2017). issn: 0360-3199. https://doi.
org/10.1016/j.ijhydene.2016.12.111
72. Vepsäl äinen A, Pitkänen J, Hyppänen T (2012)Fundamentals of heat transfer, p 223. issn:
1798-1336
73. Matsushima H, Iida T, Fukunaka Y (2012) Observation of bubble layer formed on hydrogen and
oxygen gas-evolving electrode in a magnetic ﬁeld. J Solid State Electrochem 16(2):617–623.
(Feb 2012). issn: 1432-8488, 1433-0768. https://doi.org/10.1007/s10008-011-1392-x
74. McCabe WL, Smith JC, Peter H (2005) Unit operations of chemical engineering, Seventh.
McGraw-Hill, New York. isbn: 0-07-124710-6
75. Fasihi M, Breyer C (2020) Baseload electricity and hydrogen supply based on hybrid PV-wind
power plants. J Clean Prod 243:118466. (Jan. 2020). issn: 09596526. https://doi.org/10.1016/
j.jclepro.2019.118466
76. IEA (2019) The future of hydrogen. Technical report. IEA, Paris, June 2019, p 203
77. Mahesh M et al (2021) Lifetime estimation of grid connected LiFePO4 battery energy stor-
age systems. Electric Eng. (Aug 2021). issn: 1432-0487. https://doi.org/10.1007/s00202-021-
01371-w

Energy Storage Applications
in Renewable Energy Systems
Fabiano Salvadori, Oswaldo Hideo Ando Junior, Maurício de Campos,
Paulo Sérgio Sausen, Eder Andrade da Silva, André Quites Ordovás Santos,
and Fernando Marcos de Oliveira
Abstract Electricity remains a key element for world development, and the increase
in the demand for electrical energy in the industrial, commercial and residential sec-
tors, the predicted exhaustion of fossil fuel reserves (e.g. oil, coal), the environmental
risks of nuclear energy, the effects of global warming in addition to other environmen-
tal issues makes it necessary to develop alternative/renewable and non-conventional
sources for the electrical energy generation. Electricity generation, based on renew-
able non-conventional sources, can play an important role in global energy security
and contribute to the reduction of greenhouse gas emissions. The use of these renew-
able energies can help to reduce energy consumption based on fossil fuel, which is the
biggest source of CO2 emissions. Some of these alternative sources, e.g. wind, and
photovoltaic, suffer from seasonality and intermittency, which represents a challenge
to guarantee the adequate quality and dispatchability of the source. This limitation
can be reduced and/or eliminated with the use of an Energy Storage System (ESS),
allowing the energy system to be managed optimally.
F. Salvadori (B)
LREI - Smart Grid Laboratory, Federal University of Paraiba - UFPB, João Pessoa, PB, Brazil
e-mail: salvadori.fabiano@cear.ufpb.br
O. H. Ando Junior
GPEnSE - Energy and Energy Sustainability Research Group, Rural Federal University of
Pernambuco - UFRPE, Cabo de Santo Agostinho, PE, Brazil
e-mail: oswaldo.ando@ufrpe.br
M. de Campos · P. S. Sausen
GAIC - Industrial Automation and Control Group, Regional University of the Northwest of the
Rio Grande do Sul State - UNIJUÍ, Ijuí, Brazil
e-mail: campos@unijui.edu.br
P. S. Sausen
e-mail: sausen@unijui.edu.br
E. Andrade da Silva · A. Q. O. Santos · F. M. de Oliveira
GPEnSE - Energy and Energy Sustainability Research Group, Federal University of Latin
American Integration - UNILA, Foz do Iguaçu, PR, Brazil
© The Author(s), under exclusive license to Springer Nature Switzerland AG 2024
A. J. Sguarezi Filho et al. (eds.), Smart Grids—Renewable Energy, Power Electronics,
Signal Processing and Communication Systems Applications, Green Energy
and Technology, https://doi.org/10.1007/978-3-031-37909-3_3
73

74
F. Salvadori et al.
1
Introduction
The population growth observed worldwide plus the increasing levels of urbanization
lead to a rapid growth in energy consumption and cause environmental concerns due
to CO2 emissions. In addition, this urban population growth causes a mismatch
between energy supply and demand [1, 2]. The solution to these problems requires,
in addition to optimizing the use of electricity (rationalization), the minimization of
toxic emissions caused by the use of fossil fuels (non-renewable) [3, 4].
In order to face the use of fossil fuels through the development of sustainable
energy systems, several types of research have been developed to obtain electric-
ity generation deﬁned as clean [5]. The search for the solution to the environmen-
tal/energetic problem, in recent years, reﬂected in the rapid development of renewable
energies, from non-conventional sources (e.g. wind and photovoltaic) [6]. Expanding
employment opportunities, creating wealth, and improving people’s living conditions
and the health of the planet, are possibilities envisioned with the decarbonization of
the economy.
The introduction of ESS technologies in electrical power systems made it pos-
sible to adapt the intermittence of renewable generation to the demand. There are
several advantages related to the use of ESS in electrical power systems, in addi-
tion to storing and smoothing renewable energy. ESS can increase the power supply,
resilience and efﬁciency of the system by means of many enforcement including:
transmission/distribution congestion relief; load following; supply capacity; voltage
support; energy timeshift; fast regulation; transmission/distribution upgrade deferral;
area regulation; supply spinning reserve; renewable energy timeshift; power qual-
ity; renewable capacity ﬁrming; renewable energy smoothing; service reliability and
black-start [7].
The rapid growth in demand for electrical energy and, consequently, in the elec-
trical power system created new opportunities for the use of ESS. It should be noted,
however, that many resources used in ESS solutions are not commercially or tech-
nologically mature, which greatly hinders their wide use. We can highlight that
the ESS technologies are different in terms of implementation cost and technical
characteristics such as: technical maturity; volumetric and gravimetric energy den-
sity; environmental impact; lifetime (years and cycles); volumetric and gravimetric
power density; energy and power; discharge time; time response; operating tempera-
ture; self-discharge rate; requirement in terms of physical space for implementation;
recharge time; memory effect (batteries); operation and maintenance (O&M) costs;
recyclability; transportability and cumulative energy demand [7, 8].
Anomalies in an electrical power system can be signiﬁcantly reduced through
properselectionandmanagementofenergystoragesystemsandenergyresources[3].
The main anomalies that occurred are: (a) lack of energy—occurrence of a total loss
of energy supplied by the utilities; (b) power outage—short-term low voltage; (c) fre-
quency variation—alteration in the supply frequency (50 or 60Hz) causing instability
in the system; (d) transients in the switching process—instantaneous under-voltage
(nanoseconds); (e) over-voltage—a prolonged period of increased line voltage from

Energy Storage Applications in Renewable Energy Systems
75
a few minutes to a few days; (f) power spike (peak)—a short-term high voltage above
110% of normal voltage; (g) brownout—line voltage reduced for an extended period
of a few minutes to a few days; (h) electrical network noise—a waveform caused by
electromagnetic interference (EMI) or radio frequency interference (RFI); and, (i)
harmonic distortion—generally caused by non-linear [9] loads.
We must understand the Smart Grids, as a concept, or several concepts, than
speciﬁcally a technology. They are electrical networks that intelligently and dynam-
ically integrate the actions of all users/devices connected to them, from those that
generate energy (suppliers), to those that consume it (consumers) and also those
that develop both activities (prosumers) in order to provide electricity efﬁciently,
sustainably, economically and safely. It is an electrical network that makes use of
Information and Communication Technologies (ICTs), instrumentation and automa-
tion of the electrical network, and advanced systems of intelligence and systems
management.
In this way, it contributes to a convergence of technologies and supports the
operations and systems that help companies manage their networks in the new reality
where there is an injection of distributed energy resources, intermittent or not, and
dispatchable or not. It can be highlighted that the differential of Smart Grids is the
fact that they incorporate the digital transformation that changed the paradigm of
uni-directionality, existing in electrical networks in the past, to the new paradigm of
bi-directionality of energy and information.
2
Energy Storage Technologies
Electric power systems operate within a logic based on a balance between supply
(generation) and demand (consumption). Energy storage helps balance ﬂuctuations
in electricity supply and demand. This is done by storing energy during relatively
high production and low demand and then releasing this energy into the electrical
system during periods of high demand and low production. Energy storage can pro-
vide a number of beneﬁts, for example, ancillary services, economic, reliability, and
environmental (ecological) beneﬁts. Depending on the complexity and size of the
system being deployed, energy storage can help the electrical grid operate more efﬁ-
ciently, reducing the likelihood of power outages during peak demand periods and
allowing more renewable resources to be installed [10].
Energy storage provides indirect environmental beneﬁts, for example, energy
storage can be used to integrate more renewable energy sources into the electrical
system. It can also help to generate units operating at optimal levels and reduce the
use of less efﬁcient generating units that would otherwise only run at peak times. In
addition, the additional capacity provided by energy storage can delay or even prevent
the need to build new plants or expand transmission and distribution infrastructure
[11, 12].
However, energy storage has some potentially negative impacts that will funda-
mentally depend on the type and efﬁciency of the storage technology. For example,

76
F. Salvadori et al.
Fig. 1 Ragone chart comparing speciﬁc energy and speciﬁc power of various energy storage tech-
nologies
batteries use raw materials like lithium and lead that can pose serious environmental
hazards if not properly disposed of or recycled. In addition, electrochemical energy
conversion processes have low performance.
There are many ways of storing energy, each with its strengths and weaknesses.
Some of the storage technologies are presented below and the Ragone chart com-
paring speciﬁc energy and speciﬁc power of various energy storage technologies is
presented in Fig.1 [13].
2.1
Pumped Storage Hydroelectric (PSH)
Pumped storage hydroelectric plants (PSH) are those that have a mechanism for
pumping water from a lower reservoir to an upper one according to the hydraulic
ﬂow. Like normal hydropower plants, they are also based on storing the gravitational
energy of water across an elevation difference. The difference is that they have an
accumulation system at a lower level that can be mechanically pumped to an upper
level, through a duct by a reversible pump turbine using extra energy from another
generating source. The water is pumped to a reservoir, using motor/pump sets, when
it is released ﬂowing through a turbine to generate electrical energy [14].
The biggest obstacle to hydraulic generation is the need for a water supply (rivers)
tomaintainthelevelofthereservoirsinconditionstooperatetheplant.Eachgenerator
has a minimum amount of water ﬂow that makes the coupled turbine rotate. When this
does not exist, the technology in a solution: pumping water from the lower reservoir

Energy Storage Applications in Renewable Energy Systems
77
Fig. 2 Basic components of the an reversible hydroelectric
to the upper reservoir. This can occur in a river with a weaker ﬂow or even in an
independent closed circuit of rivers, for a smaller plant. In both cases, the way to
form the reservoirs depends on the topographic conditions, that is, taking advantage
of the geography and the relative altitude of the areas necessary to build the two
reservoirs.
The simplest solution to implement a PSH project is the installation of a gener-
ating unit (turbine + generator) separate from another for pumping (motor + pump),
selecting the most suitable conﬁguration for both. However, the need for different
equipment makes this arrangement more expensive and there are few occasions when
it is adopted. For drops smaller than 600 m, reversible turbines are generally used,
which operate both as turbines and pumps. Installing just one hydraulic machine
means an economic advantage. Figure2 shows a reversible hydroelectric plant and
its basic components.
Due to the way in which the reservoirs are constructed, many of the potential
environmental impacts generated by a PSH are similar to those of a conventional
hydroelectric plant. These are changing the ﬂow, widening the river bed, raising the
water table, changing climatic parameters, impacts on ﬂora and fauna, social and
economic impacts, etc. As most of these impacts are on a local scale, it is possible to
carry out mitigating or compensatory actions to reduce the negative impacts of these
projects, which are usually outweighed by the positive impacts generated.

78
F. Salvadori et al.
2.2
Compressed Air
Energy storage in form of compressed air energy storage (CAES) is appropriate
for both, renewable and non-renewable energy sources. The excess electricity, in
this system, when in low electricity demand, is used to generate compressed air,
and after, the compressed air, through expansion could run a turbine to generate
electricity during periods with high energy demand [15, 16].
Energy can be stored in the form of compressed air, but the processes by which
air can be compressed and expanded are diverse and depend on different parameters,
especially state variables (pressure, volume and temperature—PVT), thus resulting
in different ﬁnal conditions. The various combinations of compressed air energy
storage systems, according to the different phases of the system, are represented in
Fig.3.
CAES systems can be classiﬁed in: (1) Adiabatic; (2) Diabatic; (3) Advanced
adiabatic system and (4) Isothermal system [17].
1. The adiabatic system (A-CAES)—in this process the heat of compression is used,
which is stored at higher temperatures and, consequently, a greater amount of
output power can be obtained. The air is heated during compression and stored
in the tank. However, when the air temperature is minimal, more air mass can
be stored. In this process, a large volume storage tank is needed to accommodate
more air mass at higher temperatures.
2. An energy storage system based on air compression and storage in underground
geological caves is deﬁned as diabatic (D-CAES). The air is heated by combustion
using natural gas or fuel and expanded in a turbine to generate electricity. This
energy is stored and released during peak demand hours. In this system, the heat
of compression is not used and is dissipated as waste.
Fig. 3 Combinations of CAES systems (adapted from [15])

Energy Storage Applications in Renewable Energy Systems
79
Fig. 4 CAES system conﬁgurations
Fig. 5 CAES system conﬁgurations
3. In AA-CAES systems, thermal storage is performed using a solid or ﬂuid to store
the heat from compression for later use during the expansion process. By using
thermal storage, fossil fuel savings occur to reheat the air before expansion in
the gas turbine. Currently, AA-CAES systems have shown potential for greater
efﬁciency and lower greenhouse gas emissions.
4. The isothermal storage conﬁguration (I-CAES) occurs when the temperature
inside the storage tank is kept constant, removing heat during charging and pro-
viding this heat during the discharging process.
In the Figs.4 and 5 are presented schematically with all the processes discussed.
2.3
Flywheel
For large-scale storage systems that represent a low environmental impact com-
pared to other technologies, mechanical systems represent an attractive alternative.
Among the different technologies for mechanical storage, the Flywheel Energy Stor-
age System (FESS) is considered suitable for commercial applications (see Fig.6).

80
F. Salvadori et al.
Fig. 6 A typical ﬂywheel energy storage system
This system consists of a rotating mass, either composite or steel, inserted into a
container with very low ambient pressure. The reduced pressure inside the vessel
reduces the drag on the rotating mass, thus maintaining momentum and generating
electrical energy for a longer period of time. The energy in a rotating mass (ﬂy-
wheel) is stored, and the kinetic energy produced is stored (dependent on the inertia
and speed of the rotating mass) as rotational energy. The ﬂywheel is placed inside
a vacuum containment thus reducing energy losses due to friction, in addition, it is
suspended by bearings so that the operation is stable. This keeps the ﬂywheel turning
without any additional power and with very little power loss [18, 19].
Purely mechanical ﬂywheels were reported several hundred years ago to keep
machines turning smoothly between cycles. Later, in 1950, one of the ﬁrst energy
production systems using a ﬂywheel was produced in Switzerland, with a 1500kg
ﬂywheel which they called “Gyrobus” [20]. However, more modern ﬂywheels began
to be developed in the 1970s, when NASA sponsored programs that proposed energy
storage in ﬂywheels as primary sources for space missions [21].
Current high-speed ﬂywheel energy storage systems are constructed with a huge
rotating cylinder supported on a stator, consisting of the stationary part of an electrical
generator, by magnetically levitated bearings. For maximum efﬁciency, ﬂywheel
systems are operated in a vacuum to reduce friction between parts. The ﬂywheel is
connected to a motor-generator system that is connected to the electrical grid through
power converters.
The energy density of the most advanced FESS is quite signiﬁcant/attractive with
high efﬁciency and low losses. Four main features can be highlighted: (1) the rotat-
ing mass is made of ﬁberglass resins or polymeric materials with high mechanical
strength; (2) this mass operates in a vacuum to minimize aerodynamic drag (friction);
(3) the mass of the FESS operates at high speed; and, (4) To operate at high rotational
speed use magnetic or pneumatic suppression bearing technology. Advanced FESS

Energy Storage Applications in Renewable Energy Systems
81
operates at a rotation frequency of over 100,000 RPM with top speeds in excess
of 1,000m/s. FESS is mainly used for high-power and low-power applications that
require many cycles.
An electrical machine transfers kinetic energy in and out of the ﬂywheel. There
are two modes of operation of this electric machine: motor or generator, which modes
depend on the load angle. When acting as a motor, electrical energy is supplied to the
stator winding, producing a rotating magnetic ﬁeld which, interacting with the rotor
magnetic ﬁeld, produces torque on the rotor shaft. This will cause the rotor to spin
rapidly and gain kinetic energy that will be stored by the ﬂywheel. In its principle
of acting as a generator, when it is then necessary to make use of the stored energy.
The kinetic energy stored in the rotor applies torque, which is then converted into
electrical energy. This causes the wheel to decelerate [18, 22].
A distinction must be made between the applications in which a ﬂywheel is used
to maintain an even angular speed of a machine and those in which it operates as a
real energy accumulator, though the distinction is not always clear-cut. All modern
ﬂywheel accumulators include several elements such as the ﬂywheel, a casing that
is usually provided of a burst-containment structure and is able to maintain the rotor
in a low-pressure environment, bearing and seal systems, power transmission, and
usually vacuum and control systems.
The accumulator must be studied as a whole and its optimization must be per-
formed in the knowledge that the optimization of the components does not necessarily
lead to an optimum whole. For example, an optimized ﬂywheel might require a heavy
or costly containment structure or power transmission, thus reducing the “efﬁciency”
of the whole.
One parameter commonly used to express the quality of an energy storage device
is energy density, i.e. the ratio between the energy stored and the mass. It should be
noted that the mass of the ﬂywheel considered must be that of the complete system
and the stored energy must be evaluated only as the energy that can be effectively
supplied in normal operation.
In ﬂywheel development work, the energy density is often misleadingly presented
by dividing the energy stored at burst speed by the mass of the ﬂywheel alone. This
practice is only justiﬁed by the fact that it is useful during the ﬂywheel development
work as it can be easily calculated from theoretical considerations or measured during
a spin test and characterizes the ﬂywheel itself.
The ﬂywheel design and material characteristics will deﬁne the rotor energy den-
sity, through Eq.1:
 en
ma

u. f.
= Kr
σu
ρ ,
(1)
where: en—energy (base of natural logarithms); ma—mass (mass of the molecules);
Kr—term expressing the dependence of the rolling resistance from the speed (Boltz-
mann constant); σu—ultimate strength of the material and ρ—density of the material.
The so-called “shape factor” K depends only on the geometrical conﬁguration of
the ﬂywheel and on the failure criterion used, at least under certain conditions. The

82
F. Salvadori et al.
ultimate strength of the material σu is easily deﬁned in the case of isotropic materials
and homogeneous ﬂywheels. If the material is not isotropic, σu is a reference value
and the failure criterion must be expressed accordingly. If the rotor is built using
different materials, the values of σu and the density ρ are conventional ones, and the
shape factor must be deﬁned keeping into account also the properties of the materials.
In order to overcome the above-mentioned limitations of the usefulness of the
concept of energy density, an overall operating energy density can be deﬁned as:
 en
ma

o.o.
= λ′λ′′λ′′′
 em
ma

u. f.
= λ′λ′′λ′′′Kr
σu
ρ
(2)
where: the three coefﬁcients λ′ (‘safety factor’—the ratio between the energy stored
at operating speed and the one stored in burst conditions); λ′′ (‘depth of discharge
factor’—the ratio between the usable and the total energy stored, determined by
Eq.3) and λ′′′ (ratio between the mass of the ﬂywheel and the mass of the whole
accumulator), all smaller than unity, can be deﬁned as follows:
e = 1
2 Jω2
(3)
The available (useful) energy of a ﬂywheel can be determined within a range of
speeds, minimum (ωmin) and maximum (ωmax):
e0 = 1
2 J f

ω2
max −ω2
min

= 1
2 Jeω2
max

1 −ω2
min
ω2max

(4)
The value of λ′′ is therefore:
λ′′ =

1 −ω2
min
ω2max

(5)
The value of λ′′ is mainly determined by the type of transmission used. In most
cases it is useless to lower the value of ωmin under a certain point: the advantages of
using very low values of ωmin are small and the technological problems involved are
often quite serious. In many cases ωmin is chosen as one half of ωmin: three-quarters
of the total energy stored can thus be extracted from the ﬂywheel.
A “volume energy density” can also be deﬁned as the ratio between the energy
stored and the volume of the accumulator. If only the volume of the ﬂywheel is taken
into account, the volume energy density at burst speed can be calculated as:
 e
V

u. f. = K σu
ρ
(6)
Again Eq.6 is valid for homogeneous rotors. If different materials are used in
a ﬂywheel, the shape factor K must refer to the average density, and Eq.6 can be

Energy Storage Applications in Renewable Energy Systems
83
used. In order to compare kinetic accumulators with other energy storage devices,
an overall operating volume energy density can be calculated in accord with Eq.7:
 e
V

o.o. = λ′λ′′λ′vK σu
ρ
(7)
The coefﬁcient λ′v is the ratio between the volume of the ﬂywheel and the volume
of the whole accumulator. ‘Volume of the ﬂywheel’ is the actual volume occupied
by the material of the ﬂywheel and not the volume swept during rotation [23].
2.4
Supercapacitor
Electrochemical capacitors (ECs) are known by names such as ultracapacitors, elec-
tric double-layer capacitors, or supercapacitors. This name difference is due to the
fact that manufacturers use different names. Nippon Electric Company (NEC)TM
deﬁned supercapacitors as the ﬁrst commercial device. On the other hand, the Pin-
nacle Research Institute (PRI) named ECs the ultracapacitor [24].
The ECs-based energy storage technology is unique in that it stores the ﬂow of
electric current by generating a magnetic ﬁeld in which energy is stored. ECs store
electrical energy directly in a magnetic ﬁeld with very low losses due to supercon-
ducting coils (typically ≥97%). This technology is extremely efﬁcient, fast, and
ﬂexible, however, having as a negative point the fact that it is expensive [25].
The superconducting material that conducts DC current has no resistive losses. A
magnetic ﬁeld is induced by the circulation of electric current in the coil in which the
energy is stored. Electric current circulates in the coil indeﬁnitely until it needs to
be discharged. The superconducting property of the coil causes it to be supercooled
at low temperatures, some in the range of 50–77K and others like niobium-titanium
alloys around 4.2K [25, 26].
The amount of energy stored by these devices is related to the size of the coil and
its geometry determines the inductance, L. The coil is an inductor and stores energy
based on the square of the current (Eq.8).
E = 1
2 LI 2,
(8)
The amount of current ﬂowing in the coil can be incredibly large. With a magnetic
ﬂux density of ﬁve Teslas, superconductors can carry currents of up to 300,000A/cm2
this makes a cryogenic cooling system using liquid nitrogen or helium necessary,
and this system has a loss of parasitic energy [27].
Capacitors store electrical energy by removing charge carriers (electrons) from
one metal plate and depositing these carriers on another plate. Such charge separation
creates a potential difference between the two plates, which can be harnessed by
connecting a load to an external circuit.

84
F. Salvadori et al.
Considering a simple capacitor, the stored energy is given by Eq.9
E = 1
2εA V 2
d ,
(9)
where: A is an area of parallel plates separated by a distance d; ε is the permittivity of
the material (or medium) between the plates, and V is the applied potential difference.
The capacitance C of the capacitor can be obtained using Eq.10
C = ε A
d ,
(10)
Using Eqs.9 and 10, the energy stored in the capacitor as a function of capacitance
can be obtained by Eq.11:
E = 1
2CV 2,
(11)
To measure the capacitance (C) of the equivalent circuit, we can use another
method that involves determining the change in energy that occurs during charging
or discharging, which is given by Eq.12:
E =
1
2C
 
V 2
1 −V 2
2

,
(12)
By integrating the instantaneous power we determine the energy change and
therefore C can be calculated from Eq.13 [24]:
C =

2
 t2
t1 vidt


V 2
1 −V 2
2
 ,
(13)
Then, analyzing Eqs.11 and 13 it’s observed that the energy stored in a capacitor
is directly proportional to the applied potential difference and its capacitance, conse-
quently, the permittivity of the material between the capacitor plates. Furthermore,
it is observed that the energy is also inversely proportional to the distance between
the plates, therefore, the smaller the thickness of the material between the plates, the
greater the energy stored.
Traditional capacitors are generally not considered for large-scale energy stor-
age due to the little energy they can store, but they serve to explain the concept of
supercapacitors. Supercapacitors use the characteristics deduced earlier to increase
their storage capacity, creating thin layers of charge storage. In supercapacitors, also
known as double-layer capacitors, the electrical charge is stored in an electrochem-
ical double-layer located on the outside of the electrodes, and not on the inside, as
in batteries. Such a mechanism causes the differences between supercapacitors in
relation to batteries, such as the short charging or discharging time and a longer
useful life [24, 28, 29].

Energy Storage Applications in Renewable Energy Systems
85
Fig. 7 Comparative with different storage technologies
The electrolyte can be solid or liquid, and in the case of liquid electrolytes, a porous
separator is positioned between the electrodes, isolating the parts, but allowing the
passage of ions. Despite the possibility of a solid electrolyte, it usually consists of
an organic liquid or an aqueous solvent, which contains dissolved ions that migrate
from one electrode to another during charging or discharging.
The cell voltage is approximately six volts, for higher voltage levels several cells
need to be connected in series. For large systems this can result in a serious design
problem as the typical failure mode of a cell is an open circuit. Therefore, if a single
device fails, the entire system will be shut down, representing a high-reliability risk,
a fact that must be taken into account when sizing the system.
Due to the potential risk of operating at a higher voltage than the rated voltage in a
cell, unlike batteries, supercapacitors cannot handle gases or dry out the electrolyte.
To ensure safe operation and keep voltages within operating limitations, resistors
or Zener diodes can be connected in parallel. Another alternative is that either each
device can be loaded or unloaded individually [26].
Figure7 shows the comparison of different storage technologies comparatively
with supercapacitors.
2.5
Thermal Energy Storage (TES)
Thermal energy storage (TES) is known as a technology that stores thermal energy by
heating or cooling a physical storage medium, enabling the stored energy to later be
used in electrical power generation and heating and cooling applications [4]. Some
heat sources: are natural gas; solar thermal energy; propane (LP); oil; nuclear centers;

86
F. Salvadori et al.
coal; wood; electricity; heat pumps; geothermal energy; fossil fuel plants; industrial
waste heat and biomass.
The advantages of using TES in a power system: (i) largest economy; (ii) reduc-
tionsininvestmentandO&Mcosts;(i)increaseinefﬁciency;(iii)improvedreliability
and (iv) less pollution in the environment (lower CO2 emissions) [30, 31].
Technologies for generating electricity that uses solar thermal systems are indus-
trially developed and use most of the thermal energy of the Sun during the day.
However, it has no (thermal) backup to maintain operation at night or in hours of
low or no solar radiation. These systems are becoming important for energy stor-
age in hybrid systems, in combination with concentrated solar power plants, where
solar heat is stored for electricity production when sunlight is not available. The
development of new materials, characterized and improved in their thermophysical
properties, will enable 24-hour operation in an efﬁcient TES system.
In accord with [30], by the more extensive use of heat and cold storage, it is
estimated that in Europe, around 1.4 million GWh/year and 400 million tons of
avoided CO2 emissions can be saved, in buildings and in industrial sectors.
The use of thermal storage, despite not being able to be used as an effective backup,
helped the system to thermally stabilize, consequently, thermal storage found use in
hybrid thermal/solar systems. As a result, studies focused on the development of
thermal energy storage technologies have increased, as well as the applicability and
their effects on sensible and latent heat storage in numerous applications [32, 33].
Thermal energy generation, according to the convenience from the burning of
fuels, however, if it is not consumed, it is simply dissipated in the environment
resulting in waste. Therefore, if there is an increase in demand, there will be a need
for a greater generation and consequently burning of fuels to meet this demand. This
has the following implications [33]:
• There is an increase in the emission of harmful gases (e.g. CO2) into the atmosphere
due to the burning of fuel causing a greenhouse effect and also the release of unused
heat into the environment (greater global warming).
• The increase in the consumption of fossil fuel, non-renewable, causes an increase
in the cost. In addition, there is the character of waste, as the thermal energy
available for free from a renewable source such as solar radiation is no longer
used.
The classiﬁcation of thermal energy storage technologies is presented in Fig.8
based on the criterion of the state of the energy storage material.
2.5.1
Sensible Heat Storage—SHS
In the sensible heat storage (SHS) method, thermal energy is stored by heating or
cooling a liquid or solid storage medium (e.g. water, sand, molten salt or rocks). This
stored thermal energy can be determined by Eq.14 [33, 34].

Energy Storage Applications in Renewable Energy Systems
87
Fig. 8 Classiﬁcation of thermal energy storage technology
Q =
	 T2
T1
(m)

cp

dT
(14)
where: m is the mass (kg); cp is the speciﬁc heat capacity (kJ/kg (K) and T1 e T2 is
the temperature range.
During the thermal energy absorption process, there are no phase changes in the
material, while the material’s temperature increases. The amount of stored heat is
proportional to the density, the volume, the speciﬁc heat, and the temperature change
[30].
The most common commercial heat-storing medium is water, which has both
residential and industrial applications. Underground storage using liquid and solid
mediums is also used, typically in large-scale applications. Nevertheless, the storage
capacity of such systems is restricted by the medium’s speciﬁc heat.
SHSs systems have a typical capacity between 10 and 50 kWh/t and storage
efﬁciencies between 50–90%, depending on the speciﬁc heat and the thermal insu-
lation technology. The cost of a complete SHS system is usually in the range of e
0.1–10/kWh, depending on the size, application, and thermal insulation technology
employed. Some lower-cost solid-state materials exist, but their lower heat capacities
often require the system to be unrealistically large [30, 35].
The water medium operates in a temperature range from 25–90 ◦C [33]. Its advan-
tages are its high speciﬁc heat, non-toxicity, low cost, and high availability. Water
has also a few disadvantages, like high steam pressure, and corrosivity. The tanks
may be built using steel, aluminum, reinforced concrete, and ﬁberglass. Glass wool,
mineral wool, or polyurethane may be used as insulators. Their sizes can vary from
a few hundred liters to thousands of cubic meters. To preserve the thermal perfor-
mance, the use of large reservoirs is suitable. However, this type of tank requires the
development of technologies to guarantee watertightness, which makes it possible to

88
F. Salvadori et al.
minimize heat losses caused by the diffusion of steam through the walls and optimize
the stratiﬁcation inside the tank, [33].
Mineral oil is primarily used as a Heat Transfer Fluid (HTF) in high-temperature
solar plants. It collects the heat in the receiver and then transports it to the boiler,
where the steam is generated. It can also be used to store thermal energy at night in
highly insulated storage tanks. When HTF is used as an energy storage material, it
is a straightforward system that eliminates the need for a heat exchanger, reducing
cost. Mineral oil has a lower steam pressure than water and can operate at higher
temperatures up to 400 ◦C. Moreover, unlike molten salts, mineral oil does not freeze
overnight. But mineral oil is expensive compared to molten salts, and recently low
melting point molten salt mixtures have been found to replace other alternatives [33].
2.5.2
Latent Heat Storage—LHS
This technology stores latent heat in materials that can release or absorb energy with a
change in the physical state of materials. They are commonly known as Phase Change
Materials (PCMs). PCMs have greater storage capacity due to the greater energy
storage density. The heat is mainly stored in the phase-change process, at a quite
constant temperature, and it is directly related to the latent heat of the substance. They
are classiﬁed into organic and inorganic. Organic PCM is classiﬁed as parafﬁn and
non-parafﬁn. Parafﬁn wax represents a good example. Non-parafﬁnic PCM includes
fatty acids, esters, and glycols. Inorganic PCM includes salt hydrates, salts, metals,
and alloys. Examples are sodium sulfate decahydrate, calcium chloride hexahydrate,
sodium thiosulfate, and the like [30].
PCMs can increase storage capacity with efﬁciencies between 75–90%. In most
cases, storage is based on a solid/liquid phase change with energy densities on
the order of 100kWh/m3. In these systems, the main costs are associated with
the heat (and mass) transfer technology, which must be installed to achieve sufﬁ-
cient charge/discharge power. The costs of latent heat storage systems range from
10 to 50 e/kWh [34, 35].
2.5.3
Chemical Thermal Storage—TCS
Chemical thermal storage (TCS) can provide greater storage capacities. Thermal
reactions (e.g., adsorption or adhesion of a substance to the surface of another solid or
liquid) can be used to accumulate and discharge heat involving a reversible reaction
in which heat is stored during the endothermic reaction step and released during
the exothermic. During charging, a chemical reactant is dissociated into products
in an endothermic reaction using thermal energy. The generated products can be
easily separated and stored until a discharge is required. During the discharge step,
the stored products are mixed at a suitable pressure and temperature, starting an
exothermic reaction, and releasing energy.

Energy Storage Applications in Renewable Energy Systems
89
Despite its attractive application for long-term energy storage, TCS technology is
still in the early stages of laboratory or pilot plant research [36]. Examples of some
materials currently investigated are: metal hydrides (MgH2 and CaH2), carbonates
(PbCO3 and CaCO3), hydroxides (Mg(OH)2) and (Ca(OH)2), oxides (BaO2 and
Co3O4), ammonia system (NH4HSO4 and NH3) and organic systems (CH4/H2O,
CH4/CO2, C6H12) [37].
TCS systems can achieve storage capacities of up to 250kWh/t with operating
temperatures in excess of 300 ◦C and efﬁciencies from 75% to nearly 100%. Its
storage and transport period are theoretically unlimited because there is no thermal
loss during storage, as the products can be stored at room temperature. The associated
costs are estimated to be between 8 and 100 e/kWh [35, 36].
2.6
Battery
Batteries are the result of the junction of several electrochemical cells and can be
classiﬁed as secondary or primary. The secondary ones are conﬁgured as recharge-
able batteries, being this one of the EES that present greater performance in the
industry and in everyday life. In Fig, the simpliﬁed process of the operating principle
of a typical BESS system is shown. A BESS system consists of a number of batteries
connected in series or parallel, which produce electricity at the desired voltage, doing
so from a chemical reaction. In this segment, a cell can bidirectionally convert the
available energy between electrical and chemical energy. During discharge, electro-
chemical reactions occur at the anodes and cathodes simultaneously. For the external
circuit, electrons are supplied from the anodes and are collected at the cathodes. Dur-
ing charging, reverse reactions take place and the battery is recharged by applying
an external voltage to the two electrodes [38]. Electrochemical storage devices are
available in different size ratios, which corresponds to one of the main advantages of
these technologies. Thus, electrochemical storage systems (EcSS) can be composed
of several technologies [3] (Fig.9).
2.6.1
Lead Acid Batteries
Lead-acid batteries are considered one of the oldest technologies in terms of recharge-
able batteries. In this type of battery, the cathode is made of lead dioxide and metallic
lead anode, which are immersed in a dilute sulfuric acid electrolyte. The main advan-
tages of using lead-acid batteries are high energy efﬁciency, low self-discharge rates,
relatively high cycle efﬁciencies, and low initial capital cost. However, it suffers
from some disadvantages which include relatively low cycle times (up to 2000), low
lifetime, low energy density, and low speciﬁc energy ratio. Furthermore, systems
composed of this technology may require a thermal management system, as lead-
acid batteries may perform less than expected when exposed to low temperatures, a
fact that may increase the total cost of an ESS [39, 40].

90
F. Salvadori et al.
Fig. 9 Simpliﬁed schematic of the operation of a BESS
Lead-acid batteries are suitable for systems that require short or medium storage
times and especially in cases where cost-effectiveness, reliability, and tolerance for
misuse are considered critical, but factors such as energy density and service life are
considered important. The biggest markets for this technology are the automotive
industry and telecommunications back-up UPS systems [39–41].
2.6.2
Lithium-Ion (Li-Ion) Batteries
It is presented as an advanced rechargeable battery technology, commercially devel-
oped by SonyTM, during the early 90’s. Lithium-ion batteries are so named because
they do not use metallic lithium as an electrode, instead using lithium ions. lithium,
present in the electrolyte in the form of lithium salts dissolved in non-aqueous sol-
vents. During the discharge process, lithium ions migrate from the anode material
to the cathode material and electrons move along the wire of the external circuit
(electronic conduction).
Li-ion batteries have high efﬁciency, high energy density, a good response time (in
milliseconds), and a low self-discharge rate. However, the disadvantages of the Li-
ion battery are depth of discharge (DoD) cycle, sensitivity to high temperatures, and
high cost. However, the cost of lithium-ion cells tends to decrease with large-scale
production [40, 42].
Due to their operational characteristics, lithium-ion batteries are the main energy
storage devices for portable electronics, such as smartphones, notebooks, TVs, and
tablets. In addition, these characteristics also make these batteries suitable for electric
vehicle traction applications, electric tools, and intermittently available renewable
energy storage [42].
Li-ion batteries typically have four main chemical elements used in cathode
materials: manganese (Mn), cobalt (Co), nickel-cobalt-manganese (Ni–Co–Mn), and
phosphate (PO3−
4 ) using carbon (C) or graphite as the anode. Among these, the one

Energy Storage Applications in Renewable Energy Systems
91
with the highest energy density (Wh/kg) is cobalt oxide (CoO). It so happens that
CoO has as a negative characteristic the fact that it is thermally unstable since its
internal resistance varies considerably with time and depends on energy production,
resulting in a reduced life cycle. On the other hand, manganese oxide (MnO2) has
positive characteristics in its low cost, high energy density, and safety. However, it
has limitations in terms of limited operating temperature and low volume energy
density [43].
2.6.3
Sodium Sulfur (NaS) Batteries
These types of batteries are composed of molten electrodes (sodium and sulfur)
and beta-aluminum electrolyte in a non-aqueous state. Sodium is used as a negative
electrode and sulfur is treated as a positive electrode. In this type of technology, a
temperature of 300 ◦C to 350 ◦C (574 to 624K) is required for reactions to occur, thus
ensuring that the electrodes are in a liquid state. The advantages of this battery are the
high energy density, low rate of daily self-discharge, and high nominal capacity when
compared to other technologies used in batteries. However, they present limitations
due to the high operational cost, due to, among other factors, the need for a heating
system that maintains its operating temperature [3, 38].
NaS batteries ﬁnd application in the operation of the electrical distribution net-
work, integration of intermittent generation (wind and solar), and ancillary services.
NaS technology has the potential for application in ancillary services due to its long
discharge time (up to 6h) and low self-discharge. These batteries are able to provide
quick response, adequate to the needs of the electrical system, such as the mitigation
of power quality events. Furthermore, the NaS battery is considered one of the most
promising for high-power ESS applications [3].
2.6.4
Nickel Cadmium (NiCd) Batteries
Thenickel-cadmium(Ni–Cd)battery,duetoitselectrochemicalcharacteristics,make
it particularly suitable for applications subject to extreme environmental factors,
e.g. ambient temperature, need to be taken into account and where service life,
charge/discharge characteristics, cycling behavior, maintenance requirements, and
life-cycle cost are important parameters [44].
Chronologically, NiCd batteries were the second type of rechargeable battery
developed. It was introduced by Swedish engineer Waldemar Jungner in 1899. NiCd
batteries use nickel hydroxide and metallic cadmium for the two electrodes and
an aqueous alkaline solution as the electrolyte. Normally NiCd batteries have high
robustness and low maintenance costs. However, nickel and cadmium materials are
toxic metals to the environment, a fact that results in environmental risks and bat-
teries that use NiCd technology are also subject to the “memory effect”, that is,
the maximum capacity of the battery can be drastically reduced if it is recharged
repeatedly after being only partially discharged. For these reasons, NiCd batteries

92
F. Salvadori et al.
are increasingly in disuse and there is no quotation for this technology for large-scale
ESS applications in the future [44, 45].
Energy storage systems have already incorporated several battery technologies.
The choice between these different technologies depends on the technical and eco-
nomic characteristics of the particular application to be implemented. The two dom-
inant industrial battery technologies today are lead-acid and nickel-cadmium. In
addition to these, there are other pairs such as vanadium redox, sodium-sulfur, zinc-
bromine, and lithium-based types. As far as commercial (non-research) applications
are concerned, the problem with less conventional technologies will likely be the
cost of deploying cells in large volumes [38, 40, 44].
The long life, low maintenance, and frequent cycling characteristics of nickel-
cadmium batteries make them particularly suitable for applications where ambient
temperatures are extreme.
2.6.5
Nickel–Metal Hydride (NiMH) Batteries
A NiMH battery consists of a positive electrode based on oxyhydroxide oxide, a
negative electrode based on metallic cadmium, and an alkaline electrolyte (usually
potassium hydroxide). It is an evolution of the nickel-cadmium (NiCd) battery, the
NiMH battery has a higher power and energy density, has a lower environmental
impact, as well as is less likely to suffer memory effects [9, 15].
NiMH batteries have a longer lifespan compared to Li-ion batteries. They have
a wide variety of applications, ranging from portable products to electric cars, this
technology also has potential for industrial applications. However, the signiﬁcant
barrier to application of this in EES is the high rate of self-discharge. NiMH batteries
also have deep cycle sensitivity, so performance degrades after a few hundred full
cycles [4].
2.7
Fuel Cells
The beginning of fuel cell (FC) research took place over 100 years ago, but with the
great development in the new materials area in the last 15 years, this technology,
associated with the growing demand for low environmental impact, has become very
promising in the world energy scenario [46].
The working principle of fuel cells is similar to that of batteries, but they do not run
out or need to be recharged. From the supply of fuel, the fuel cells return electricity
and heat as long as it is supplied. The basic structure of a fuel cell consists of a negative
electrode (anode) and a positive electrode (cathode), compressed around an element
(electrolyte). The anode is powered by a fuel, e.g. hydrogen, while air is injected into
the cathode. In the case of a hydrogen-based fuel cell, the hydrogen molecules are
split at the anode into protons and electrons by a catalyst, then following different
paths to the cathode. Electrons circulate through an external circuit, creating a ﬂow

Energy Storage Applications in Renewable Energy Systems
93
of electricity and protons migrate through the electrolyte to the cathode, combining
with oxygen and electrons, thus producing water and heat [46, 47].
One of the main limitations of the development of fuel cell technologies, based
on hydrogen, is the hydrogen storage process, which constitutes a key technology, in
applications of electric mobility, portable energy storage, and stationary generation
of electric energy. An important point to note in this case is that hydrogen has
the highest energy/mass of any other fuel currently in use. It has, however, as a
disadvantage, its low density at room temperature which results in a low energy/unit
volume. Therefore, for fuel cells to represent an economically and technically viable
alternative, it is essential to develop advanced technologies for hydrogen storage that
have the potential for greater energy density.
This conversion takes place by means of two partial chemical reactions at two
electrodes separated by an appropriate electrolyte, that is, the oxidation of a fuel at
the anode and the reduction of an oxidant at the cathode, with the aid of specially
developed catalysts, indicated in the reactions (15), (16) and (17) [46]:
Anode : H2 + 2H2O ⇒2H2O + 2e−
(15)
cathode : 1
2O2 + 2H3O+ + 2e−⇒3H2O
(16)
Overall −reaction : H2 + 1
2O2 ⇒H2O
(17)
Choosing, for example, hydrogen as fuel and oxygen as oxidant, the so-called
acid cell results in the formation of water and heat production, in addition to the
release of free electrons, which can generate electrical work. A simpliﬁed schematic
of an acidic FC is shown in Fig.10.
Unlike combustion engines, which have their maximum theoretical efﬁciency
limited by the Carnot cycle, the efﬁciency theory of FC is given by the quotient
between the energy free reaction Gr and the enthalpy of reaction Hr in accord
with Eq.18
ηec = Gr
Hr
(18)
The electrochemical efﬁciency (ηec) given by Eq.18 has a weak temperature
dependence when compared to the efﬁciency given by the Carnot cycle. Thus, CC
makes it possible to obtain high efﬁciencies, that is, a better use of fuel, even and
especially at low temperatures.
There are several types of FC, classiﬁed according to the type of electrolyte
they use and, consequently, its operating temperature. Table1 lists the types of CC
developed to date with their main features, advantages and disadvantages current and
their most relevant applications.

94
F. Salvadori et al.
Fig. 10 Simpliﬁed drawing of a fuel cell
Table 1 Types of Fuel Cells (where: PEMFC—Proton Exchange Membran Fuel Cell, PAFC—
Phosphoric Acid Fuel Cell, MCFC—Molten Carbonate Fuel Cell and SOFC—Solid Oxid Fuel
Cell)
Type
Electrolyte
◦C
Advantages/disadvantages
PEMF C
Polymer

HO+
3

20–120
High power density
Flexible operation
Mobility
High membrane and catalyst cost
Contamination of the catalyst with
CO
PAFC
(H3PO3)/

H3O+
160–220
Greater technological development
CO tolerance
Electrode porosity control
Corrosion limited efﬁciency
MCFC
Fused carbonates

CO2−
3

550–660
CO/CO2 tolerance
Ni-based electrodes
cathode corrosion
Difﬁcult to control three-phase
interface
SOFC
ZrO2
(Zirconia)
O2−
850–1000
High efﬁciency (favorable kinetics)
Fuel reform can be done in the cell
Material problems
Thermal expansion

Energy Storage Applications in Renewable Energy Systems
95
3
Renewable Energy Sources
Coming from natural sources, which are replenished at a rate greater than their con-
sumption, energy obtained from renewable sources has become attractive in recent
years due to several factors, including environmental and economic factors. Sunlight
and wind, for example, are sources that are constantly being replenished. An inter-
esting feature of renewable energy sources is that they are abundant and all around
us. Fossil fuels—coal, oil, and gas—on the other hand, are non-renewable resources
that take hundreds of millions of years to form. In addition, burning fossil fuels to
produce energy causes harmful emissions of greenhouse gases (CO2). Emissions
from renewable energy generation are much lower than those obtained from burning
fossil fuels. The transition from fossil fuels, which currently account for the majority
of emissions, to renewable energy is one of the key points to tackling the climate
crisis.
The main aspect of a renewable energy source is its sustainability aspect, some-
thing that does not end, or that we can consider as inﬁnite as the sun. The term
alternative energy also refers to renewable energy sources, because these energy
sources are alternatives to the most commonly used non-renewable sources such as
oil, coal, etc. The use of renewable energy sources is, in most countries, cheaper and
generates three times more jobs than fossil fuels.
3.1
Small Hydroelectric Plants—SHPs
The (SHPs) are facilities that result in lower environmental impacts and lend them-
selves to distributed generation. Hydraulic energy comes from solar radiation and
gravitational potential energy, through evaporation, condensation, and precipitation
of water on the earth’s surface. Unlike other renewable sources, they already account
for a signiﬁcant portion of the world’s energy matrix and has duly consolidated
technologies.
A typical SHP normally operates on a run-of-river basis, that is, the reservoir
does not allow the regularization of the water ﬂow. Among the sources of renewable
energy, this is the one that has the least impact on the environment and on the physical
environment, it regulates the river, preventing ﬂooding.
Hydroelectric plants can be classiﬁed according to their size, ranging from large
plants, supplying electricity to many consumers, and small and micro plants, which
are operated by individuals for their own consumption of the electricity generated
or to sell the energy to utilities. Although we have different deﬁnitions, the United
States Department of Energy (US/DOE) deﬁnes: (a) small power plants (generating
between 100 KW and 10 MW) and (b) micro-hydroelectric power plants (up to 100
KW).
Hydroelectric power plants can be classiﬁed under three different categories [48]:

96
F. Salvadori et al.
• Impoundment hydroelectric: Most common type, large generation capacity, needs
a big raised reservoir behind the dam.
• Diversion hydroelectric: Manages the river ﬂow (tide) to propel the turbine, does
not need a reservoir, low generation capacity.
• Pump storage hydroelectric: Similar to impoundment hydroelectric, pumps water
back to the reservoir when demand is low for later use
They can also be classiﬁed by their power generation capacity as [48]:
• Micro: Generates less than 100 [kW].
• Small: From 100kW to 30 [MW].
• Large: Greater than 30 [MW]
Other alternative classiﬁcations are made about ﬂow control, load conditions, and
head altitude.
The possibility and degree of ﬂow control, which is available, varies from instal-
lations that store water in reservoirs (small or large) to run-of-river systems, that is,
that do not retain much water and are thus subject to natural ﬂuctuations. of the river
ﬂow and is subject to the rainfall regime [48].
For isolated communities, small towns, or industries, small hydroelectric plants
(SHPs) represents one of the most important sources of energy, being able to provide
energy reliably and uninterruptedly. We deﬁne a hydroelectric plant as an SHP when
its installed capacity is less than 30 MW and it has a reservoir, considered small (less
than 3 km2 of dedicated water surface area [49]). The possibilities of developing
SHPs as a renewable source of energy are great all over the world.
In addition to the main objective of generating electricity, the SHPs collaborate
by regulating the ﬂow of water, in water supply, preservation of the habitat of native
species, and various recreational uses.
Impoundment hydroelectric generators (Fig.11) use the most basic operation prin-
ciple,astheyarebasedonconvertingthepotentialenergyofraisedaccumulatedwater
into a quick ﬂow to move a generator’s propeller. There are six fundamental compo-
nents in this type of power plant: dam, reservoir, penstock, turbine, generator, and
governor.
3.2
Tidal Energy
Of all the technologies currently available for generating electricity, tidal technology
has the lowest theoretical potential, around 1,200 TWh/year. This is a consequence
of its very location-speciﬁc nature, as only a few countries can really take advantage
of this feature. A subcategory of tidal technology, namely tidal range, dominates
the current cumulative global installed capacity for ocean energy technologies. For
logistical, environmental, and technological reasons this theoretical potential cannot
be fully implemented. Recently, the development of new technologies to take advan-
tage of this potential has been presented and many of them are still being studied
[50–52].

Energy Storage Applications in Renewable Energy Systems
97
Fig. 11 Impoundment hydroelectric power plant representation
From the movement of the tides in the oceans, the generation of electrical energy
occurs. These power generation systems already involve advanced technologies that
allow their use on a commercial scale. The technology used in this case is similar
to that of conventional hydroelectric generation schemes. Two examples, already in
operation, can be cited:
• The Rance Tidal Power Station is a tidal power station located on the estuary of
the River Rance in Brittany, France.
• Sihwa Lake Tidal Power Station, operated by Korea Water Resources Corporation,
is the world’s largest tidal power facility, with a total power production capacity
of 254 MW. When completed, it surpassed the 240 MW of the Rance Tidal Power
Station, which was the largest in the world for 45 years.
The best mechanism for exploiting tidal energy is to employ estuarine barrages
at suitable sites with high tidal ranges. The technology is relatively mature and the
components are commercially available. However, the pace and extent of commercial
exploitation of tidal energy will be signiﬁcantly inﬂuenced by both the treatment of
environmental costs of competing fossil fuels and by the availability of construction
capital at modest real interest rates. The larger projects could require the involvement
of national governments if they are to succeed [53].

98
F. Salvadori et al.
3.3
Geothermal Energy
Geothermal energy is characterized by heat coming from the Earth, it is heat energy
generated less than 64km from the earth’s surface, in a layer of rocks (magma), which
reaches up to 6,000 ◦C. Electric energy can be obtained by drilling the soil in places
where there is a large amount of steam and hot water, these must be drained to the
earth’s surface through speciﬁc pipes. Then the steam is transported to a geothermal
power plant, which will turn the blades of a turbine. Finally, the energy obtained by
moving the blades (mechanical energy) is transformed into electrical energy through
the generator.
The positive aspects of this type of energy are: (i) the emission of polluting gases
(CO2 and SO2) is practically nil, not intensifying the greenhouse effect, unlike fossil
fuels; (ii) the area required for the installation of the plant is small and it can supply
isolated communities.
The negative aspects are considered: (i) it is a very expensive and unproﬁtable
energy, as it requires high structural investments and its efﬁciency is low; (ii) it can
cause the depletion of the geothermal ﬁeld; (iii) the lost heat raises the ambient
temperature and (iv) there is the emission of hydrogen sulﬁde (H2S), extremely
corrosive and harmful to health.
Compared to other renewable sources, geothermal heat is advantageous as it is
available daily and in all seasons. This fact makes geothermal energy an attractive
option for sustainable energy supply. Added to this idea, it corroborates the fact that
geothermal energy is considered a clean and ecological form of energy, as it allows
the generation and sale of electricity with low emission of harmful pollutants into
the atmosphere [54].
The amount of thermal energy extracted from a geothermal system compared with
the natural through-ﬂow of energy is very important with regard to the sustainability
of the resource. For convenience we introduce the term “production ratio” or PR
deﬁned by 19:
PR = P E F
N E F
(19)
where: PEF is the produced energy ﬂow and NEF is natural energy ﬂow.
Ageothermalsystem,wheninitsnaturalstate(pre-production),canberepresented
by the lumped parameters model shown in Fig.12. In this case, the surface heat ﬂux
Qsur f is equal to the deep ﬂux Qdeep, that is:
Qsur f = Qdeep
(20)
Accurately estimating Qsur f is not trivial, as the manifestations occurring at the
surface may be small and it may occur that part of the upward ﬂow of heat, from
greater depths, may be lost to shallow underground aquifers.
The producing wells, during production, have their energy extracted at a rate
Q prod. Some additional convective ﬂow and deep hot recharge, Qrech, may occur

Energy Storage Applications in Renewable Energy Systems
99
Fig. 12 Diagrammatic
sketch of the natural state of
a geothermal system
from the pressure decline caused by the production. Thus, the rate of heat extraction
from the system, Qextr, is given by:
Qextr = Q prod + Q
′
sur f −Qdeep −Qrech
(21)
Note that in Eq.21 the energy ﬂow from the surface, Q, is not the surf same as in
the natural state [55].
3.4
Biomass Energy
The term biomass is used to name the group of energy products and renewable raw
materials, originated from organic matter formed biologically. From an energy point
of view, biomass is any renewable resource derived from organic matter (of animal
or plant origin) that can be used for energy production [39].
The generation of energy through biomass can help to reduce dependence on
fossil fuels and hydroelectric plants, diversifying the energy matrix without losing
its renewable character. Therefore, new research, new investments, and economic
feasibility studies of alternative sources of raw materials for energy generation are
necessary.
The use of biomass for the generation of electric energy is fully part of the concept
of distributed generation since the generating units must be located close to the place
where the biomass is produced, thus avoiding raising the costs of transporting this
raw material and consequently the generation cost.
The use of cultural residues can contribute to the decentralization of generation,
reducing investments in transmission lines and energy losses due to the shortest
distance. On the contrary from other energy sources, such as solar and wind, which
are intermittent sources, biomass energy can be used at any time (dispatchability).
Biomass can be classiﬁed into two large groups [39]: (i) traditional biomass, essen-
tially composed of ﬁrewood and natural waste, and (ii) modern biomass, produced
from advanced and efﬁcient technological processes, such as liquid biofuels, bri-
quettes and pellets, cogeneration (sugarcane bagasse) and dedicated crops of species
such as planted forests and sugarcane.

100
F. Salvadori et al.
The main source for generating energy from biomass is waste, especially those of
plant origin. Through biomass, it is possible to obtain different forms of energy. Its
main uses as an energy input are: the production of solid biofuels for thermal energy
generation(coalandagroforestryresidues),liquidbiofuels(fuelalcoholandbiodiesel
used in combustion engines), and electric energy generation (direct combustion,
gasiﬁcation, of gases, among other technologies). Biomass can be obtained from
woody and non-woody vegetables and/or from organic residues and transformed
into energy through different conversion processes [56, 57].
3.5
Photovoltaic Energy
The global photovoltaic generating capacity has doubled in 3 years, considering from
2018, bringing the world solar generating capacity to a capacity of TW in April 2022.
For the world solar capacity to reach 1 TW in 2022, from its 100 GW in 2012 took
about a decade. It turns out that the global solar market is growing exponentially.
According to Solar Power Europe, in just 3 years, global solar energy will more than
double to 2.3 TW in 2025. Representing more than half of the 302 GW of renewable
capacity installed internationally in 2021, solar energy remains the fastest growing
renewable energy.
With 168 GW of additions, solar installed over 70 GW more than the next largest
installer—wind—and more than all non-solar renewables combined. With an annual
growth rate of 14% and an all-time high of 54.9 GW of new solar power, China
maintained its market lead in 2021, adding twice as much solar capacity as the
second largest market, the United States. The United States, however, saw impressive
growth, with 42% more additional solar energy in 2021 than in 2020. India regained
its third position with 14.2 GW of solar installations.
Solar cell technology has beneﬁted from the high standard of silicon technology
originally developed for transistors and later for integrated circuits and the quality
and availability of high perfection monocrystalline silicon (Si). In the early years,
only single crystals have grown in Czochralski (Cz) were used for solar cells and
although this material still plays an important role, currently there are other single
crystal options [58].
Currently, there are three main PV panel technologies: silicon panels, thin ﬁlm
panels, and hybrid panels. The ﬁrst group is divided into two categories: monocrys-
talline silicon (mono-Si) and polycrystalline silicon (p-Si). The second group con-
tains amorphous silicon (a-Si), cadmium telluride (CdTe), organic photovoltaic cells
(OPV), and copper, indium, and gallium selenide (CIS/CIGS). And the last group is
panels that generate energy and heat water simultaneously.
Figure13 shows the different material technologies used in PV panels.
The silicon module is the ﬁrst generation of photovoltaic technologies. Despite
being the ﬁrst technology, it is constantly improving its capability and efﬁciency.
The main types of modules are monocrystalline, which constitute about 80% of the
current market, and polycrystalline [59]. The main beneﬁts of silicon modules are

Energy Storage Applications in Renewable Energy Systems
101
Fig. 13 PV panel materials technologies
performance, linked to the high efﬁciency of this technology, reliability, related to
the modules’ durability of more than 25 years and little degradation in this period,
and abundance, since silicon is the second most abundant in the earth’s crust [60].
CIGS (copper-indium-gallium-selenium) is one of the main materials currently
used in the manufacture of thin-ﬁlm photovoltaic cells. CIGS has a good sunlight
absorption coefﬁcient, allowing the use of thinner layers than would be required
with other types of semiconductors. CIGS cells have already been manufactured
in laboratories with efﬁciencies greater than 21% and commercially the modules
have efﬁciencies ranging from approximately 15–18%, very close to the efﬁciencies
of crystalline silicon modules. Furthermore, better uniformity is achieved with the
use of selenide, decreasing the number of recombinations in the ﬁlm, beneﬁting the
quantum efﬁciency and therefore the [59] conversion efﬁciency. The main problem
to be solved concerns making the process high yield and low cost. Various deposition
methods are used: sputtering, “ink” printing, and electroplating with different yields
and efﬁciencies [61]. The beneﬁts of CIGS technology are not limited to the low
cost, easy availability, and thermal expansion of soda-lime glass that is commonly
used as a substrate. But also with the increase of the electrical effect which is an
improvement in the conductivity of the module [62].
After choosing the technology for the photovoltaic modules, an important step
is to predict the electrical behavior of the photovoltaic system, based on previous
information speciﬁc to each location, such as the temperature and irradiation of
the place. This step is important to obtain a forecast of how much energy will be
delivered after installing the photovoltaic generator. A solution to this problem is the
mathematical modeling of the system, which is usually based on the ideal model and
the one diode model [63].
3.5.1
Simulation Models
The two electrical models, of photovoltaic panels, most used for simulations are the
ideal model and that of one diode. One aspect of simulation that requires attention is
the estimation of parameter values, which are the model’s components and variables.

102
F. Salvadori et al.
In general, the data provided by the manufacturers (datasheets), gives the open
circuit voltage (VOC), short circuit current (ISC), current at the maximum point power
(IM P P), the voltage at the maximum power point (VM P P) and power at the maximum
power point (PM P P). In some cases, the values of the temperature coefﬁcients for
open circuit voltage (Kv) and short circuit current (Ki) are also speciﬁed.
In addition to this information, the models need other values that are not cataloged,
such as the photovoltaic current (IPV ), reverse saturation current (I0), diode ideality
factor (α) and the resistors in series (Rs) and parallel (Rp).
In addition to the functions normally available (maximum power points, short
circuit current, and open circuit voltage) functions derived from these can also be used
to obtain new equations. The simplest method is constant parameter modeling, where
it is assumed that only IPV and I0 are affected by environmental variations, while
the other parameters (α, Rs and Rp) are considered constant for a given condition.
Although these parameters considered constant are sensitive to the variations of G
and T , it is possible to ﬁnd satisfactory values for the simulations of the models in
this way [64].
• Ideal Model
This is the simplest model, but the least accurate in terms of the characteristic at the
maximum power point of the photovoltaic panel. This model can be understood
from a simple analysis of Kirchhoff’s Laws, without the need to use any additional
tools. From this analysis, we obtain (22) for the output current [65].
I = IPV −ID
(22)
where: ID is the diode current modeled from (23) (Shockley equation), which
represents the diode model.
ID = I0

exp
 qV
αkT

−1

(23)
where: q—electron charge (1.6 x 10-9); V —PV cell voltage; α—diode ideality
factor; k–constant of Boltzmann (1.38064852 × 10−23 J/K), and T —junction pn
temperature.
Obtaining I0 from (24)
I0 = q Ani
2
 Dp
L pNd
+
Dn
LnNa

(24)
where: A—cell area; ni—concentration of intrinsic carriers of the material; Dp,
Dn—diffusion coefﬁcient of holes and electrons in the material; L p, Ln—diffusion
length of holes and electrons, respectively; Nd, Na—concentration of n-type and
p-type dopants.

Energy Storage Applications in Renewable Energy Systems
103
The ideal model is represented by (25)
I = Ipv −Io

exp
 qV
αkT

−1

(25)
• One Diode Model
The one diode model, for most authors, is seen as the most faithful model of the
photovoltaic cell. In it the power loss factors are portrayed as small resistors, Rs
and Rp. The parallel resistance (Rp) represents the leakage current, while the series
resistance (Rs) models the internal losses due to electrical connections and current
ﬂow, in addition to contributing to the model efﬁciency [66].
Using Kirchhoff’s Law it is possible to obtain the output current (26)
I = IPV −ID −IP
(26)
the currents IPV , ID e IP are deﬁned from (27), (28) and (29)
IPV = (IPV,r + KiT ) G
Gr
(27)
ID = I0

exp
V + Rs I
αVT

−1

(28)
IP = V + Rs I
Rp
(29)
where: IPV,r—rated photovoltaic current; T —difference between current and
nominal temperature; G—irradiance; Gr—reference irradiance; Rp—parallel
resistance; Rs—series resistance; IP—current related to the electrical losses of
the resistors (Rs and Rp).
The reverse saturation current, of the diode, is obtained from (30)
I0 =
ISC,r + KiT

exp

VOC,r+KvT
αVT

−1

(30)
where: VT —thermal potential; ISC,r—rated short circuit current; VOC,r—rated
open circuit voltage.
3.6
Wind Energy
The global wind industry had its second-best year in 2021, with almost 94 GW of
capacity added globally, trailing behind 2020s record growth by only 1.8%. Total
global wind power capacity is now up to 837 GW, helping the world avoid over 1.2

104
F. Salvadori et al.
billion tonnes of CO2 annually—equivalent to the annual carbon emissions of South
America. After a year in which net zero commitments gathered global momentum,
coupled with renewed urgency for achieving energy security, the market outlook for
the global wind industry looks even more positive. Approximately 557 GW of new
capacity is expected to be added in the next ﬁve years under current policies. That is
more than 110 GW of new installations each year until 2026.
The energy of wind movement (wind ﬂow), when absorbed by wind turbines,
allows the generation of electricity by converting mechanical energy into electrical
energy. Winds originate from uneven heating in the sun’s atmosphere, surface irreg-
ularities, and the Earth’s rotation. Terrain characteristics (e.g. roughness), environ-
mental conditions (e.g. temperature), and buildings can change wind ﬂow patterns.
The process of converting wind energy (from the wind) into electrical energy, is
deﬁned as either wind energy or wind generation, both describe this task indistinctly.
Wind turbines convert kinetic energy into mechanical energy and generators convert
this mechanical energy into electrical energy [67].
For wind energy to be considered technically usable, its density must be greater
than or equal to 500W/m 2, at a height of 50m, which requires a minimum wind
speed of 7 to 8m/s [68]. According to the World Meteorological Organization, in
only 13% of the earth’s surface, the wind has an average speed equal to or greater
than 7m/s, at a height of 50m. This proportion varies greatly between regions and
continents, reaching 32% in Europe [68].
In order to ensure that the growth paradigm of the wind energy generation sector
is sustainable, fair, and socially responsible, guaranteeing assumptions based on a
clear and viable economic proposal, thus demonstrating the leading role of this way
of generating energy.
The wind turbines produced today, in addition to having several designs, provide a
multitude of resources. In the literature, we ﬁnd several classiﬁcations based on: rotor
shaft alignment; used electric generator; operating rotation speed; power converter
used and ability to develop control actions.
3.6.1
Classiﬁcation of Wind Turbines—Rotor Shaft Alignment
We can classify modern wind turbines into two fundamental groups: the wind tur-
bine with a horizontal-axis wind turbine (HAWT) (Fig.15) and the vertical-axis wind
turbine (VAWT) (Fig.16). The working principle of wind turbines consists of trans-
forming the kinetic energy of the air into the rotating mechanical power of the turbine
rotor blades. Nowadays, the most common wind turbine is a horizontal axis propeller
with 2 or 3 blades. Selecting the number of wind turbine blades is not an easy design
choice. Three-blade systems cost more than two-blade systems, but two-blade wind
generators need to operate at higher rotational speeds than three-blade ones. In this
way, the individual blades of the two-blade wind generator need to be lighter and

Energy Storage Applications in Renewable Energy Systems
105
Fig. 14 Typical block diagram for a wind turbine power generation system
more uncomfortable and therefore more expensive. The basic formulation for the
wind power at location A, perpendicular to the wind direction is given by Eq.31:
P = 1
2ρ AC pv3
(31)
where: P is the power, ρ is the air density, v is the wind speed and Cp is the power
coefﬁcient, which describes the fraction of the wind captured by a wind turbine.
According to Betz rules, the value of the power coefﬁcient features a theoretic limit
connected with 59.7%.
The assembly of wind generators seeks locations where wind energy is abundant
(wind speed is higher at higher altitudes than close to the ground). Also, to avoid
turbulence (change in wind speed when it hits obstacles), the location needs to be
away from tall structures. Horizontal axis wind turbines collect wind energy against
the actual direction associated with the wind [69].
Theuseofwindenergythroughawindenergyconversionsystem(WECS)isbased
on a structure composed of wind turbine blades, a generator, an electronic power
converter, and a control system. Figure14 indicates the block diagram involving
different parts of WECS. There are different WECS options considering: (a) type of
wind turbine (ﬁxed or variable speed); (b) type of generator used (synchronous or
asynchronous machines); (c) rotor positioning (horizontal or vertical) and (d) and
control systems (stall or even pitch regulated). The primary objective of these systems
is identical: to convert the kinetic energy of the wind into electricity and inject this
energy into an electrical grid.

106
F. Salvadori et al.
Fig. 15 Mechanical structure of a HAWT
According to WWEA statistics in the world market, more horizontal wind tur-
bines are used than vertical, with 1 in 5 manufacturers manufacturing vertical-type
turbines. The main reason for the difference is the performance and cost-effectiveness
advantages of horizontal wind turbines.
• Horizontal-Axis Wind Turbines (HAWT)
Depending on their application, high-power horizontal axis wind turbines are gen-
erally built in powers ranging from 2 to 8 MW. Currently, horizontal-axis wind
turbines have the highest efﬁciency, being able to transform 40 to 50% of the
kinetic energy received into electrical energy. Considering that it is the predom-
inant wind turbine model for decades, the technology of horizontal axis wind
turbines is at a high stage of maturity. Due to the height at which the nacelle is
mounted, horizontal-axis wind turbines are able to receive the wind with greater
speed. This means they are more likely to operate at higher wind speeds, which
helps them deliver optimal performance.
The main advantages of HAWT systems to be highlighted are: (a) its structure
reaches greater heights which allows the turbine to be subjected to stronger winds;
(b) its a high-efﬁciency turbine, as its blades receive energy from the wind contin-
uously throughout its rotation, and (c) as the blades speed is practically constant
during one rotation, the rapid ﬂuctuations in electrical variables (voltage and reac-
tive power) are negligible.

Energy Storage Applications in Renewable Energy Systems
107
Fig. 16 Mechanical
structure of a VAWT
HAWTs systems have the following main disadvantages: (a) the weight of the
equipment making up the nacelle requires that a tower be built to support its
weight; (b) the weight of the generator, gearbox, transformer, and other devices
inside the nacelle must be lifted during construction and for maintenance, and to
keep up with the movement of the wind requires an additional yaw control system
to turn the blades.
Concerns about the environmental impacts of HAWT systems, such as noise emis-
sion, shading, and the effect on local ecosystems (e.g. when located on beaches,
affect existing dunes) and wildlife (birds primarily), are still controversial and are
widely discussed.
Regarding installation standards, although governments around the world have
established incentives for the expansion of generation from renewable sources,
regulations for the installation of wind turbines may limit this expansion. The
municipality must carry out a noise assessment, before authorizing the installation
of a wind turbine in a certain area, to ensure that regulatory limits are observed.

108
F. Salvadori et al.
While there is usually a general rule of thumb, policies can still vary based on
different local political, social, and natural environments.
• Vertical-Axis Wind Turbines (VAWT)
Vertical wind turbines are mainly used because they behave better in turbulent
winds and emit low noise levels compared to horizontal axis wind turbines. Not
least, the aesthetics of this type of turbine can be more attractive. For these reasons,
these types of wind turbines are considered more appropriate for urban or semi-
urban regions.
Three types of vertical-axis wind turbines:
– Savonius: The predominant force in this type of generator is the drag force, that
is, the turbines rotate predominantly by the air pressure on the blades. Savonius
turbines are generally cheaper and start to spin at a slower speed compared to
other types of wind turbines, but are the least efﬁcient type of wind turbine
considering the energy harvesting area and annual production of the same.
– Darrieus: These are turbines with an aerodynamic proﬁle designed in a similar
way to the wings of an airplane, creating lift to move and generate energy.
Darrieus wind turbines are more efﬁcient than Savonius turbines.
– Darrieus-Savonius: Hybrid wind turbine with Darrieus and Savonius systems
coupled to the same shaft, which according to the manufacturers use the advan-
tages of each type of turbine.
VAWTs have the following advantages: (a) their structure (transformer, blades,
generator, and gearbox) is mounted at ground level, which facilitates its installation
and maintenance compared to HAWT systems; (b) not needing a yaw mechanism
to direct the blades into the wind is an advantage for locations with varying wind
directions; (c) for urban applications, its aesthetic impact is lower than for HAWT
systems and (c) the starting speed (start of generation) of VAWT is generally lower
than that of HAWT.
The disadvantages of a vertical axis wind turbine are: (a) lower performance com-
pared to a horizontal axis wind turbine; (b) the support towers are low, reducing the
use of higher wind speeds; (c) close to the ground and as a result of the presence of
other objects or obstacles, they can cause turbulence in the wind ﬂow, introducing
mechanical vibrations in the turbine components, shortening their useful life; (d)
it’s enormous inertia can result in the need for an external power source to start the
turbine, and (e) mathematical modeling (aerodynamics) is very complex, making
design difﬁcult.
3.6.2
Classiﬁcation of Wind Turbines—Operating Rotation Speed
With regard to operational rotational speed, wind turbines can be divided into
two classes: ﬁxed-speed wind turbines (FSWT) and variable-speed wind turbines
(VSWT).

Energy Storage Applications in Renewable Energy Systems
109
Fig. 17 Torque-speed
characteristics of a
ﬁxed-speed wind turbine
• Fixed-Speed Wind Turbine—FSWT
Because they are simpler to build and operate than VSWT systems, older systems
were primarily of the FSWT type. According to their principle of operation, they
generate electricity only when the generator shaft rotates above its synchronous
speed, i.e. for high wind speeds. Although they are cheaper and require less main-
tenance than variable speed types, they are limited in their power generation due
to these operational limitations.
The generator operates in an almost linear range from point 1 to point 2, as shown in
Fig.17. Before point 1, the speed of the turbine is below the cut-in speed. When the
speed is higher than that, at point 2, the machine enters into its unstable nonlinear
region. Because of the steep slope of the characteristic, the range of speed is very
narrow, thus it is called a “constant” or “ﬁxed-speed turbine”. The range of the
developed power (shaft power of the generator) in this system is obtained by Eq.32:
Port−f s = Pn2 −Pn1 = Tn2ωn2 −Tn1ωn1
(32)
where: Port−f s—power in the operation region speed for ﬁxed speed; Pn2, Pn1—
power at speed points n1 and n2; Tn2, Tn1—torque at speed points n1 and n2;
ωn2, ωn1—angular speed at speed points n1 and n2.
If we consider ωn2 ≈ωn1, then Eq.32, can be simpliﬁed
Port = (Tn2 −Tn1)ωn1
(33)
Using pitch angle control, and adjusting lift force, we can control output power.

110
F. Salvadori et al.
Fig. 18 Torque-speed characteristics of the variable-speed wind turbine
• Variable-Speed Wind Turbine—VSWT
The use of electronic power converters that allow Variable-Speed Wind Turbine—
VSWT systems to generate electrical energy at a wide range of speeds, even at
speeds below synchronous speed, makes these systems more complex. Its oper-
ating range is much wider than that of FSWT systems. The torque-speed char-
acteristics of the VSWT are shown in Fig.18. To achieve these characteristics, a
voltage is injected into the generator rotor circuit.
If the operating torque is between points 1 and 2 (Fig.18) the speed of the generator
has a wide range as ω2 > ω1. The range of power for this system is obtained by
Eq.34
Port−vs = Pn2 −Pn1 = Tn2ωn2 −Tn1ωn1
(34)
where: Port−vs—power in the operation region speed for variable speed; Pn2, Pn1—
power at speed points n1 and n2; Tn2, Tn1—torque at speed points n1 and n2;
ωn2, ωn1—angular speed at speed points n1 and n2.
As a result of the wide operating speed Port−vs > Port−f s.
With VSWT wind systems we have the possibility of controlling the ﬂows of
active and reactive power and, consequently, reducing any problems caused by
ﬂuctuations in the primary energy sources. These systems have low torque peaks
in the mechanical structure in addition to having cheaper mechanical systems, with
cheaper gears. Since they use power converters to connect to the electrical grid,
mechanical damping systems are unnecessary, since the electrical interface can
provide the necessary damping. They have greater energy efﬁciency, due to the
optimal use of the mechanical characteristics of the turbine and the generation of
electrical energy with quality compatible with conventional generation systems.

Energy Storage Applications in Renewable Energy Systems
111
Fig. 19 Comparative torque-speed characteristics of variable-speed and ﬁxed-speed wind turbine
The problems of synchronization with the electrical grid, common in other wind
generation systems are avoided, resulting in greater operational ﬂexibility in the
starting and braking processes.
The generic power-speed characteristics of constant and variable speed turbines
can be seen in Fig.19. For FSWT systems, the cutting speed (minimum speed
for generating electricity) is greater than the synchronous speed of the generator,
and its cutting speed is determined by the maximum turbine speed at point 2 of
Fig.17. VSWT systems, on the other hand, operate with a cutting speed lower than
the synchronous speed and their cutting speed is higher than that of the FSWT
(see Fig.18). Regarding the rated power, it is lower in FSWT systems compared
to VSWT systems, considering that in these the output power is supplied by the
stator and rotor. The stator can still deliver its rated power and the rotor provides
extra power.
4
Conclusion
The chapter is to identify and map/chart the technologies for energy storage systems
(ESS) available and qualitatively evaluate their applicability in the power system
considering its impact on the quality and reliability of electric power system (EPS)
[70, 71].
Energy Storage Systems are used to provide electrical energy support for appli-
cations in RES. However, BESS is classiﬁed according to the form of energy storage
as: mechanical energy, kinetic or chemical energy, etc. [32, 37, 38, 72].
RecentresearchhighlighttheimportanceoftheintegrationanduseofBESSforthe
consolidation of Smart Grids [37, 70]. Table2 presents a roadmap of applications,

112
F. Salvadori et al.
Table 2 Characteristics of ESS applications
Rated power
(MW)
Duration
Response
Cycle/yr
Bulk energy
Electrical
energy
time-shift
0.1–500
2–6 h
mseg–min
300–400
Power supply
capacity
1–500
2–6 h
min
50–365
Ancillary
service
Load
following
1–100
15min–1 h
∼1s
250–10000
Regulation
10–40
s–h
∼1s
250–10000
Frequency
response
10–40
2min–1 h
ms
1000–10000
Reserve
10–100
min–h
ms
10–1000
Voltage
support
1–10 MVAr
min–1 h
s
N/A
Black star
5–50
s–h
min
10–20
Transmission
infrastructure
Upgrade
deferral
10–100
1–8 h
s
10–50
Distribution
infrastructure
Upgrade
deferral
0.4–10
1–4 h
s
50–365
Customer
energy
management
service
Power quality
0.1–10
ms–15min
ms
100–10000
Power
reliability
0.05–10
1–8 h
ms
<10
Retail
electricity
time-shift
0.001–1
1–6 h
ms
50–250
Demand
charge
management
0.05–10
1–4 h
s
50–500
Renewables
integration
Smoothing
output
0.1–500
15min–6 h
ms–s
250–10000
characteristics, and potential contributions of the insertion of BESS in the main
sectors of the electric power system.
In the bibliographic and technological state of the art, In the context of DG, the
integration of BESS and Smart Grids can optimize and improve the performance of
the electric power system in: smoothing the peak of energy demand; peak shave; P-Q
control; power ﬂuctuation reduction; Volt-Var control; auxiliary services; frequency
regulation; voltage support; isolated generation system (off-grid) or auxiliary (on-
grid); support for DG and electric mobility.

Energy Storage Applications in Renewable Energy Systems
113
Fig. 20 Comparison between selected ESS technologies
In addition, for each application, a study of the BESS technology to be used must
be carried out based on the following parameters: power, energy, discharge time and
response time. In Table2, the parameters and speciﬁcations of the requirements for
each application to be dimensioned are listed.
In Fig.20, presents the types and characteristics of ESS technologies highlighting
the possible applications based on the used parameters and performance. The Fig.21
shows the potential application in EPS of energy storage technologies, and was
developed based on the information presented in [13, 73, 74] and together with the
data contained in Table2.
The MES techniques CAES and PHS, as they allow the storage of energy in large
capacity. Figure21 are suitable for bulk energy application and can also aid in the
frequency regulation [75]. Therefore, the PHS is considered suitable for integration
of RES [70, 71], but where distant PHS installations are between wind or photovoltaic
parks the application may not be feasible due to the distance.
The SC and FES techniques, due they have very short discharge times but high
power can be used only for emergency devices and applications that need very fast
responses [38]. Modular batteries have easy scalability and can be used in many
applications [71].
In Table2, BESS presents data on the use of BESS in auxiliary services and also
as a support for the integration of the smart grid and DG. It is noteworthy that ESS,
depending on the response time and energy capacity, can be used to integrate the
FRE. For example, in VRB batteries their use is limited by the response time while
in lead-acid batteries the discharge time limits their use in applications that demand
high energy capacity [73].

114
F. Salvadori et al.
Fig. 21 Comparison between selected ESS technologies

Energy Storage Applications in Renewable Energy Systems
115
References
1. Faisal M et al (2018) Review of energy storage system technologies in microgrid applications:
issues and challenges. IEEE Access 6:35143–35164
2. Sandoval D,GofﬁnP,Leibundgut H(2017)Howlowexergybuildingsanddistributedelectricity
storage can contribute to ﬂexibility within the demand side. In: Appl Energy 187:116–127.
ISSN: 0306-2619. https://doi.org/10.1016/j.apenergy.2016.11.026
3. Sioshansi R et al (2022) Energy-Storage modeling: state-of-the-art and future research direc-
tions. In: IEEE transactions on power systems, vol 37.2, 860–875. https://doi.org/10.1109/
TPWRS.2021.3104768
4. Yan B et al (2020) Markovian-based stochastic operation optimization of multiple distributed
energy systems with renewables in a local energy community. In: Electric power systems
research, vol 186, p 106364
5. Sun Y et al (2020) Overview of energy storage in renewable energy power ﬂuctuation miti-
gation. CSEE J Power Energy Syst 6.1:160–173. https://doi.org/10.17775/CSEEJPES.2019.
01950
6. Kim S-K et al (2008) Dynamic modeling and control of a grid-connected hybrid generation
system with versatile power transfer. In: IEEE transactions on industrial electronics, vol 55.4,
pp 1677–1688. https://doi.org/10.1109/TIE.2007.907662
7. Hemmati R, Saboori H (2016) Emergence of hybrid energy storage systems in renewable
energy and transport applications—a review. In: Renewable and sustainable energy reviews,
vol 65, pp 11–23. ISSN: 1364-0321. https://doi.org/10.1016/j.rser.2016.06.029
8. Zhang T et al (2020) Evaluation model and method on life-cycle comprehensive low-carbon
beneﬁts of large-scale energy storage system from the distribution network planning perspec-
tive. In: 2020 IEEE 4th conference on energy internet and energy system integration (EI2), pp
2174–2179. https://doi.org/10.1109/EI250167.2020.9347293
9. Nishiya K, Hasegawa J, Koike (1982) Dynamic state estimation including anomaly detection
and identiﬁcation for power systems. In: IEE ProceedingsC (Generation, Transmission and Dis-
tribution), vol 129.5, pp 192–198. 10.1049/ip-c.0032. https://digital-library.theiet.org/content/
journals/10.1049/ip-c.1982.0032
10. Rahman MM et al (2020) Assessment of energy storage technologies: a review. In: Energy
conversion and management, vol 223, p 113295. ISSN: 0196-8904. https://doi.org/10.1016/j.
enconman.2020.113295
11. Serra R et al (2019) From conventional to renewable natural gas: can we expect GHG savings
in the near term? In: Biomass bioenergy, vol 131, p 105396
12. Byrne RH et al (2018) Energy management and optimization methods for grid energy storage
systems. IEEE Access 6:13231–13260. https://doi.org/10.1109/ACCESS.2017.2741578
13. Guney MS, Tepe Y (2017) Classiﬁcation and assessment of energy storage systems. Renew
Sustain Energy Rev 75:1187–1197. https://doi.org/10.1016/j.rser.2016.11.102
14. Asgari F, Jolai F, Movahedisobhani F (2021) An integrated mathematical model of dynamic
production and maintenance planning in pumpedstorage hydroelectricity. Ahead-of-print, J
Model Manag Ahead-of-Print. https://doi.org/10.1108/JM2-10-2020-0264
15. Saputro EA, Farid MM (2018) A novel approach of heat recovery system in compressed air
energy storage (CAES). Energy conversion and management 178:217–225
16. Krupke C et al (2017) Modeling and experimental study of a wind turbine system in hybrid
connection with compressed air energy storage. In: IEEE transactions on energy conversion,
vol 32.1, pp 137–145. https://doi.org/10.1109/TEC.2016.2594285
17. Venkataramani G, Velraj R, Viswanathan K (2018) Harnessing free energy from nature for
efﬁcient operation of compressed air energy storage system and unlocking the potential of
renewable power generation. In: Scientiﬁc reports, vol 8. https://doi.org/10.1038/s41598-018-
28025-5
18. Wicki S, Hansen EG (2017) Clean energy storage technology in the making: An innovation
systems perspective on ﬂywheel energy storage. J Clean Product 162:1118–1134. https://doi.
org/10.1016/j.jclepro.2017.05.132

116
F. Salvadori et al.
19. Olabi AG et al (2021) Critical review of ﬂywheel energy storage system. In: Energies, vol 14.8,
p 2159. https://doi.org/10.3390/en14082159
20. Kiran AR, Anil G, Venkatesh B (2011) Simpliﬁed power converter for integrated traction
energy storage. IEEE Trans Veh Technol 60(4):1374–1383
21. Wagner RC, Boyle DR (2002) Commercialization of ﬂywheel energy storage technology on
the international space station. Syst Eng 20015:146–150
22. Kondoh J et al (2018) Energy characteristics of a ﬁxed-speed ﬂywheel energy storage system
with direct grid-connection. In: Energy, vol 165, pp 701–708. ISSN: 0360-5442. https://doi.
org/10.1016/j.energy.2018.09.197
23. Mahdavi MS, Gharehpetian GB, Moghaddam HA (2021) Enhanced frequency control method
formicrogrid-connectedﬂywheelenergystoragesystem.IEEESystJ15(3):4503–4513.https://
doi.org/10.1109/JSYST.2020.3010029
24. Sharma P, Bhatti TS (2010) A review on electrochemical doublelayer capacitors. In: Energy
conversion and management, vol 51.12, pp 2901–2912. https://doi.org/10.1016/j.enconman.
2010.07.031. https://www.sciencedirect.com/science/article/pii/S0196890410002591
25. Chen H et al (2009) Progress in electrical energy storage system: a critical review. Prog Nat
Sci 19:291–312. https://doi.org/10.1016/j.pnsc.2008.07.014
26. Berrueta A et al (2019) Supercapacitors: electrical characteristics, modeling, applications, and
future trends. IEEE Access 7:50869–50896. https://doi.org/10.1109/ACCESS.2019.2908558
27. Kleinberg M et al (2014) Energy storage valuation under different storage forms and functions
in transmission and distribution applications. In: Proceedings of the IEEE, vol 102.7, pp 1073–
1083. https://doi.org/10.1109/JPROC.2014.2324995
28. Muzaffar A et al (2019) A review on recent advances in hybrid supercapacitors: design, fab-
rication and applications. Renew Sustain Energy Rev 101:123–145. https://doi.org/10.1016/j.
rser.2018.10.026
29. Naseri F et al (2022) Supercapacitor management system: a comprehensive review of model-
ing, estimation, balancing, and protection techniques. In: Renewable and sustainable energy
reviews, Nov 2021, vol 155, p 111913. https://doi.org/10.1016/j.rser.2021.111913
30. Sarbu I, Sebarchievici C (2018) A comprehensive review of thermal energy storage. In: Sus-
tainability, vol 10.1, p 191. https://doi.org/10.3390/su10010191
31. Dincer I, Rosen MA (2011) Thermal energy storage: systems and applications. Wiley, Chich-
ester, UK
32. Zhou D, Zhao C, Tian Y (2012) Review on thermal energy storage with phase change materials
(PCMs) in building applications. Appl Energy 92:593–605
33. Alva G, Lin Y, Fang G (2018) An overview of thermal energy storage systems. In: Energy, vol
144, pp 341–378. ISSN: 0360-5442. https://doi.org/10.1016/j.energy.2017.12.037
34. Socaciu L (2012) Thermal energy storage: an overview. Appl Math Mech 55:785–793
35. Keiner D et al (2019) Cost optimal self-consumption of PV prosumers with stationary batteries,
heat pumps, thermal energy storage and electric vehicles across the world up to 2050. Solar
Energy 185:406–423
36. Zhang H et al (2016) Thermal energy storage: recent developments and practical aspects. Prog
Energy Combust Sci 53:1–40. https://doi.org/10.1016/j.pecs.2015.10.003
37. Aneke M, Wang M (2016) Energy storage technologies and real-life applications–a state of the
art review. Appl Energy 179:350–377. https://doi.org/10.1016/j.apenergy.2016.06.097
38. Luo X et al (2015) Overview of current development in electrical energy storage technologies
and the application potential in power system operation. Appl Energy 137:511–536. https://
doi.org/10.1016/j.apenergy.2014.09.081
39. Marafon AC et al (2016) Use of biomass for power generation. In: Empresa Brasileira de
Pesquisa Agropecuária. ISSN: 1678-1953
40. Mahlia TMI et al (2014) A review of available methods and development on energy stor-
age; technology update. Renew Sustain Energy Rev 33:532–545. https://doi.org/10.1016/j.
rser.2014.01.068
41. Salameh ZM, Casacca MA, Lynch WA (1992) A mathematical model for lead-acid batteries.
In: IEEE transactions on energy conversion, vol 7.1(Mar1992), pp 93–98. https://doi.org/10.
1109/60.124547

Energy Storage Applications in Renewable Energy Systems
117
42. Zubi G et al (2018) The lithium-ion battery: state of the art and future perspectives. Renew
Sustain Energy Rev 89:292–308. https://doi.org/10.1016/j.rser.2018.03.046
43. Khalid MR et al (2021) A comprehensive review on structural topologies, power levels, energy
storage systems, and standards for electric vehicle charging stations and their impacts on grid.
IEEE Access 9:128069–128094. https://doi.org/10.1109/ACCESS.2021.3112189
44. Green A (1999) The characteristics of the nickel-cadmium battery for energy storage. Power
Eng J 13(3):117–121. https://doi.org/10.1049/pe:19990303
45. Boicea VA (2014) Energy storage technologies: the past and the present. In: Proceedings of
the IEEE, vol 102.11, pp 1777–1794. https://doi.org/10.1109/JPROC.2014.2359545
46. Ett G, Janolio G, Ett V et al (2002) Generating electricity from a fuel cell (in portuguese). In:
Proceedings of the 4th energy meeting in rural areas. Campinas (SP)
47. BelmonteNetal(2017)Casestudiesofenergystoragewithfuelcellsandbatteriesforstationary
and mobile applications. In: Challenges, vol 8.1, p 9. https://doi.org/10.3390/challe8010009
48. Couto TBA, Olden JD (2018) Global proliferation of small hydropower plants—science and
policy. In: Frontiers in ecology and the environment, vol 16.2, pp 91–100. https://doi.org/10.
1002/fee.1746
49. Moreno SR, Kaviski E (2015) Daily scheduling of small hydro power plants dispatch with
modiﬁed particles swarm optimization. In: Operational research, vol 35.1, pp 25–37. ISSN:
1678-5142. https://doi.org/10.1590/0101-7438.2015.035.01.0025
50. Neto PBL, Saavedra OR, de Souza Ribeiro LA (2017) Analysis of a tidal power plant in the
Estuary of Bacanga in Brazil taking into account the current conditions and constraints. In:
IEEE transactions on sustainable energy, vol 8.3(July 2017), pp 1187–1194. https://doi.org/
10.1109/TSTE.2017.2666719
51. Kai LY et al (2021) Current status and possible future applications of marine current energy
devices in Malaysia: a review. IEEE Access 9:86869–86888. https://doi.org/10.1109/ACCESS.
2021.3088761
52. Neto PBL et al (2011) Tidal energy exploitation for electricity generation: basic aspects and
main trends (in Portuguese). In: Ingeniare. Revista Chilena de Ingeniería, vol 19.2(Aug 2011),
pp 219–232
53. Hammons TJ (1993) Tidal power. In: Proceedings of the IEEE, vol 81.3(Mar 1993), pp 419–
433. https://doi.org/10.1109/5.241486
54. Cao Y et al (2021) Thermodynamic and economic assessments and multicriteria optimization
of a novel poly-generation plant using geothermal energy and multi heat recovery technique. Int
J Hydrog Energy 46.55:27851–27873. ISSN: 0360-3199. https://doi.org/10.1016/j.ijhydene.
2021.06.063
55. O’Sullivan M, Yeh A, Mannington W (2010) Renewability of geothermal resources. In:
Geothermics, vol 39.4, pp 314–320. ISSN: 0375-6505. https://doi.org/10.1016/j.geothermics.
2010.09.003
56. Issa M, Abbas T, Ilinca A (2019) Biomass cogeneration technologies: a review. J Sustain
Bioenergy Syst 10. https://doi.org/10.4236/jsbs.2020.101001
57. Balat M, Ayar G (2005) Biomass energy in the world, use of biomass and potential trends. In:
Energy Sour 27.10:931–940. https://doi.org/10.1080/00908310490449045
58. Goetzberger A, Hebling C, Schock H-W (2003) Photovoltaic materials, history, status and
outlook. In: Materials science and engineering: R: reports, vol 40.1, pp 1–46
59. Chaar LE, Lamont LA, Zein NE (2011) Review of photovoltaic technologies. In: Renewable
and sustainable energy reviews, vol 15.5, pp 2165–2175
60. Solar Energy Technologies Ofﬁce (2014) Crystalline Silicon Photovoltaics Research. https://
www.energy.gov/eere/solar/crystalline-silicon-photovoltaics-research
61. Powalla M, Bonnet D (2007) Thin-Film solar cells based on the polycrystalline compound
semiconductors CIS and CdTe. In: Advances in OptoElectronics, Sept 2007
62. Kuang Y et al (2013) Elongated nanostructures for radial junction solar cells. In: Reports on
progress in physics, vol 76 Oct 2013), p 106502
63. Shannan NM, Yahaya NZ, Singh B (2014) Two diode model for parameters extraction of PV
module. In: 2014 IEEE conference on energy conversion (CENCON), pp 260–264

118
F. Salvadori et al.
64. Chin VJ, Salam Z, Ishaque K (2015) Cell modelling and model parameters estimation tech-
niques for photovoltaic simulator application: a review. Applied energy 154:500–519
65. Sauthier LF, Mathematical modeling of photovoltaic modules applied to distributed
generation simulation environments. http://bibliodigital.unijui.edu.br:8080/xmlui/handle/
123456789/5798.2019
66. Adamo F et al (2011) Characterization and testing of a tool for photovoltaic panel modeling.
In: IEEE transactions on instrumentation and measurement, vol 60.5, pp 1613–1622
67. Sumathi S, Jayanti S, Surekha P (2015) Solar PV and wind energy conversion systems. In:
Green energy and technology. Springer International Publishing, Switzerland. https://doi.org/
10.1007/978-3-319-14941-7_4
68. Grubb MJ, Meyer NI (1993) Wind energy: Resources, systems, and regional strategies
69. El-Sharkawi MA (2015) Wind energy: an introduction. CRC Press
70. Manandhar U et al (2019) Energy management and control for grid connected hybrid energy
storage system under different operating modes. IEEE Trans Smart Grid 10(2):1626–1636
71. Guan M (2022) Scheduled power control and autonomous energy control of grid-connected
energy storage system (ESS) with virtual synchronous generator and primary frequency regu-
lation capabilities. In: IEEE transactions on power systems, vol 37.2(Mar 2022), pp 942–954.
https://doi.org/10.1109/TPWRS.2021.3105940
72. Abomazid AM, El-Taweel NA, Farag HEZ (2022) Optimal energy management of hydrogen
energy facility using integrated battery energy storage and solar photovoltaic systems. In:
IEEE transactions on sustainable energy, vol 13.3(July 2022), pp 1457–1468. https://doi.org/
10.1109/TSTE.2022.3161891
73. Zhao H et al (2015) Review of energy storage system for wind power integration support. Appl
Energy 137:545–553
74. Silvera V et al (2018) Energy storage technologies towards brazilian electrical system. In:
International conference on renewable energies and power quality (ICREPQ’18), Salamanca,
Spain, Mar 2018
75. Chen H et al (2009) Progress in electrical energy storage system: a critical review. Prog Nat
Sci 19:291–312

A Review of Islanding Detection Methods
for Biogas-Based Distributed Generation
Systems
Alcedir Luis Finkler, Maurício de Campos, Paulo Sérgio Sausen,
Fabiano Salvadori, and Airam Teresa Z. R. Sausen
Abstract Due to the characteristics of combining energy generation with waste
management, the use of distributed generation (DG) systems, based on biogas, has
received special attention among renewable resources. On the other hand, the DG
connection brings up the possibility of an equipment to keep feeding a part of the
distribution grid comprising DG and local load in a condition known as unwanted
islanding. Regarding this, along the years, concerns have been reported related to the
safety of utilities staff, power quality issues, reclosers misoperation and DG damage
risk. To prevent it, in Brazil, the utilities provide standards stating that, in case of
unwanted islanding, the DG must be disconnected from the utility grid. Once the
biogas based generation is usually performed applying synchronous machines as
DG, its ability to keep running in islanding conditions poses special challenges to
this task. In this chapter, a review over the techniques applied for islanding detection
with synchronous machines is done, as well as an analysis of the Brazilian standards
requirements. The working principle and setup procedure of the mandatory methods
are evaluated, pointing up, new challenges over islanding detection with synchronous
machines.
A. L. Finkler
Instituto Federal Farroupinha - IFFar, Santa Rosa, RS, Brazil
e-mail: alcedir.ﬁnkler@iffarroupilha.edu.br
M. de Campos · P. S. Sausen (B) · A. T. Z. R. Sausen
Universidade Regional do Noroeste do Estado do Rio Grande do Sul - UNIJUI, Ijui, Brazil
e-mail: sausen@unijui.edu.br
M. de Campos
e-mail: campos@unijui.edu.br
A. T. Z. R. Sausen
e-mail: airam@unijui.edu.br
F. Salvadori
Universidade Federal da Paraiba - UFPB, João Pessoa, PB, Brazil
e-mail: salvadori.fabiano@cear.ufpb.br
© The Author(s), under exclusive license to Springer Nature Switzerland AG 2024
A. J. Sguarezi Filho et al. (eds.), Smart Grids—Renewable Energy, Power Electronics,
Signal Processing and Communication Systems Applications, Green Energy
and Technology, https://doi.org/10.1007/978-3-031-37909-3_4
119

120
A. L. Finkler et al.
1
Introduction
In the last decades, global warming worries have received a special attention. Since
the Paris Agreement, a worldwide effort has been applied with a goal in emissions
reduction. In the center of this issue, there is the biodegradable waste management as
well as the worries regarding its methane emission. It has lead to efforts to capturing
organic wastes, producing renewable energy through biodigesters [1–5], where, the
methane gas, can be used as a fuel to a combustion engine and so, the mechanical
energy can be converted into electricity [6–8].
Up to 2010, in Brazil, the electrical energy generation capacity produced from
biogas was 68 MW growing to 168 MW up to 2019 [9]. In [10], the potential of
electricity generation taking the biogas from agricultural wastes from animals is
highlighted. Such electrical energy can be used to feed local loads inside the rural
farm areas, or, it can be injected into the utility grid, sharing with the whole electrical
power system (EPS) in the condition know as Distributed Generation (DG).
The DG connection is guided by the EN 50549 [11] standard in Europe, by the
IEEE 1547 standard series [19] in North America, while, in Brazil, it is covered by
the PRODIST standards [12]. All these standards deﬁne that, as soon as the DG loses
the connection to the mains, it should be seccionated. Thus, the DG must be equipped
with a relay or, a function implemented in the protection device that must be able to
identify the islanding condition and disconnecting the DG from the utility grid.
The use of DG has lead to the concept of microgrids where different kinds of
distributed energy resources and storage systems are integrated to improve the energy
efﬁciency and robustness. The microgrid can operate in grid-connected mode or
islanded mode. The islanded mode can be planned for some scheduled condition or
it can happen accidentally as the case where, after the action of overcurrent protection
devices, distribution transformer failure, cables breaks, service maintenance actions,
a fraction of the grid can become isolated from the EPS. Such condition is known as
unwanted islanding or unintentional islanding [13]. In [14], the authors emphasize
the importance of a trustful islanding detection method for the proper operation of
a microgrid, as well as the problems in the operation and management associated
with a generator unintentionally islanded in a microgrid. In [15, 16], the authors
have made a review over the methods applied in the islanding detection in microgrid
emphasizing the worries in order to guarantee personal safety and avoid equipment
damage. In [17], the authors analyze the performance indices applied in the islanding
detection methods for microgrids. Further on, the integration of the microgrids to
the EPS leas to the concept of smart grids with the ability of Self-Heal following
a disturbance, with the focus in rapid restoration, supporting for all generation and
storage options [18]. So, in the heart to he smart grid there are the sensors collecting
the data and allow the decision algorithm to manage the DGs and loads. The ability
to proper identify an islanding event is a crucial point to the management of a smart
grid.
Among the sensors and techniques used in order to avoid the unintentional island-
ing, different methods can be applied according to the DG equipment. The IEEE

A Review of Islanding Detection Methods …
121
1547.6 classiﬁes the DGs as inverter, induction generator and synchronous gener-
ators. It can be highlighted that the inverters use to take the voltage from the grid
as reference and, as soon as the connection is loosed, the inverter automatically
brakes the generation. The induction generators use to drain reactive power from the
grid to be able to supply active power and therefor, once the connection is loosed, it
tends to brake the generation. The major worry falls over the synchronous generators
once these are usually equipped with speed governors and excitation control that can
ensure constant frequency and constant voltage to the DG even in islanding condi-
tion. This way, the synchronous generators can keep running as well as to become
a voltage reference source to DG inverters islanded or even, reactive source to DG
induction generators islanded. Once the synchronous generators are the technology
most applied to biogas-based generation, this study is focused on this equipment.
Along the years, different techniques have been proposed to perform the islanding
detection with synchronous generators. In the Sect.2 of this document, a review of
the IDTs applied in synchronous generators is done, highlighting the advantages and
drawbacks of each. In Sect.3, a review over the Brazilian standards regarding is DG
interconnection is provided. The Sect.4 describes the IDTs required in most of the
Brazilian utilities. In Sect.5 a conclusion is made.
2
Islanding Detection of Synchronous Generators Overview
In the introduction, the DG connection as well as the unwanted islanding risk was
described. The Fig.1 illustrates such a situation where a part of the utility network
comprising DGs and local loads can become islanded due a power shut off. In respect
to it, in [34], the worries regarding line workers safety, DG damage caused by out of
phase instantaneous reclosing as well as the risk of voltage and frequency out of limit
tothelocalloadshavebeenreported.Topreventit,theremusthaveadeviceconnected
to the DG or, a function implemented in the DG interconnection relay able to detect
the islanding condition, usually refereed as loss of mains protection or anti-islanding
protection [11, 12, 19]. Different techniques can be applied to perform such action,
usually classiﬁed into two big groups as remote islanding detection techniques (IDT)
and local IDT. In the following subsections both of them are analyzed.
2.1
Remote IDT
In this group there are the techniques that require a communication link between the
utility and the DG. As an example can be cited the power line carrier communica-
tion (PLCC) described in [35] where a signal is injected into the line at the utility
substation and, it must be identiﬁed by the DG. Another example is given in [36]
where, using a phasor measurement unit (PMU), the phasor angle is measured at the
utility substation and the information is sent to the DG that will measure it again

122
A. L. Finkler et al.
Fig. 1 Example of islanding
scenario
and compare both. Once there is a mismatch the islanding condition is detected.
Remote techniques are described in [20] as highly reliable, but, on the other hand,
as expensive and of difﬁcult implementation once it is required a straight relation
between the utility and the DG.
2.2
Local IDT
In this group, the islanding detection is done based on information obtained at the
point where the DG is connected to the utility grid, known as point of common
coupling (PCC). It can be further divided into subgroups comprising techniques
called passive, active and hybrid, each of them detailed in the following subsections.
2.2.1
Passive IDT
In this group, variables are measured at the PCC and compared to a threshold value to
identify if the DG is parallel to the EPS or not. The used variables can be the root mean
square (RMS) of the voltage and current, as well as its negative sequence components,
power factor, phase angle, frequency or the derivative of these. In [37], advantages
of the passive techniques are described as the easy implementation and low cost.
By the other hand, this kind of techniques poses a challenge to choose the right
threshold. The changes observed by the variables at the PCC are usually a function

A Review of Islanding Detection Methods …
123
Fig. 2 Passive islanding
detection ﬂowchart
of the scenario. If the loads islanded with the DG have a close characteristics (voltage
and current) of the DG’s generation before the islanding event, low ﬂuctuation will
be observed in such parameters. In this way, once the threshold are set in a too high
value, the passive IDT can fail. On the other hand, if the threshold is set in a too low
value, any system ﬂuctuation could trip the device [20]. In Fig.2, a ﬂowchart diagram
illustrates the working principle of the passive islanding detection techniques.
2.2.2
Active IDT
In this set of techniques, a disturbance is inserted in the current, voltage, frequency
or any other parameter from the PCC to be further compared to a threshold. Once the
DG is parallel connected to the EPS, the magnitude of the disturbance is expected
to be low. If the limit value is exceeded, an islanding condition is identiﬁed. In the
Fig.3, a ﬂowchart diagram illustrates the working principle of the active islanding
detection techniques.
The active techniques use to be highly efﬁcient even in case of low mismatch
between the load and generation. By the other hand, the disturbance insertion leads
to energy quality degradation. This problem tends to be increased in a scenario with
multiple DGs where the disturbance can be cumulative [37].
2.2.3
Hybrid IDT
With the goal of overcoming the drawbacks of both active and passive techniques, the
hybrid techniques are implemented in two steps. In the ﬁrst one, a very sensitive pas-
sive technique is applied, that must be triggered to any possible islanding condition.
In a second step, an active technique is applied to conﬁrm the islanding situation.

124
A. L. Finkler et al.
Fig. 3 Active islanding
detection ﬂowchart
Therefore, the drawback of the passive technique of false trip for low threshold will
be overcome by a conﬁrmation done in the second step. The drawback of the active
technique of energy degradation will be overcome once it will be done only in a short
period during the conﬁrmation procedure. In Fig.3, a ﬂowchart diagram illustrates
the working principle of the Hybrid islanding detection techniques. An example of
such technique is done in [38].
2.2.4
IDT Classiﬁcation
Passive, active and hybrid IDT can be implemented using different technologies. The
ﬁrsts ones used conventional devices to perform the voltage, current, power factor,
frequency, active and reactive power measurements and from these, to compare the
measured value to a threshold (Fig.4).
As an improvement, a next generation of active, passive and hybrid IDT started to
be proposed applying signal processing. In [20], some examples are given using
fourier transform, wavelet transform, S-transform, time-time transform, Hilberte
Huang transform, variational mode decomposition, mathematical morphology and
transient monitoring function. On these, the signal processing is applied for coefﬁ-
cients extraction from the PCC parameters. Such coefﬁcients are compared to thresh-
olds to identify the islanding condition. Drawbacks related to these sets of techniques
are the possibility of the IDT to fail in a harmonics free condition or, false tripping
in a noisy condition.
In the last set of IDT, improvements of signal processing techniques are proposed
with the addition of computational intelligence. Examples of these are given in [20]

A Review of Islanding Detection Methods …
125
Fig. 4 Hybrid islanding detection ﬂowchart
using Neural network, Fuzzy logic, Neuro-fuzzy, Probabilistic neural network, Deci-
sion tree, Naive Bayesian classiﬁer, Support vector machine classiﬁer, Extreme learn-
ing machine, Ensemble classiﬁer and deep learning. The working principle is based
on applying some technique as signal processing to perform the feature extraction
and then, as a second step, using any computation intelligent algorithm, to classify
into an islanding event or not. As an advantage, the IDT based in computational intel-
ligence allows a combined set of parameters to be cross analyzed aiming to identify
whether it is or not an islanding event. On these methods, there are still points to be
evaluated as the necessity of retrain in case of utility grid scenario reconﬁguration
[39]. In [40], a technique is proposed describing 100% of efﬁciency in the islanding
detection, but, it also reports 27% of false trips.
Thus, passive, active or hybrid techniques can be implemented using conven-
tional, signal processing and computational intelligence technologies. In Fig.5, the
classiﬁcation of the IDTs are illustrated.
Up today, more than forty different IDT have been proposed [20, 21, 41]. These
are illustrated in Fig.6 by groups (remote, local active, passive or hybrid) splitted in
periods of ﬁve years. It can be observed a higher effort in the development of passive
IDT.

126
A. L. Finkler et al.
Fig. 5 IDT classiﬁcation
Fig. 6 IDT’s research timeline
With so many available techniques, which should be used? In the following
section, a review of the Brazilian standards guiding the DG connection is done.
3
DG’s Connection to the Utility Grid in Brazil
In Brazil, the Brazilian Electricity Regulatory Agency (ANEEL) established the pro-
cedures for electrical energy distribution by the PRODIST standards [12]. Addition-
ally, grid utilities may propose their requirements for DG connection. To evaluate the
standards, in Table1, the Brazilian grid utilities were classiﬁed by the DG’s installed

A Review of Islanding Detection Methods …
127
Table 1 Anti-islanding requirements for protection applied in DG with synchronous machine by
utility
Utility
DG’s installed
capacity (kW)b
VSR (ANSI 78)
ROCOF (ANSI 81)
ENERGISA [22]
1.061.009
Yes
Yes
CEMIG-D [23, 24]
1.052.063
a
a
Grupo CPFL [25]
962.589
a
a
COPEL-DIS [26]
340.099
Yes
Yes
CELG-D [27]
325.245
a
a
EQUATORIAL
ENERGIA [28]
319.221
Yes
Yes
aNot deﬁned;
bData compiled from [29]
capacity. In the standards of these companies, some of them leave to the customer to
deﬁne the anti-islanding protection device to be installed, while, others, use to require
speciﬁc techniques as the vector shift relay (VSR) and rate of change of frequency
(ROCOF). In Table1, the requirements presented in the standards of the biggest grid
utilities companies are illustrated.
By the analysis of Table1, it is possible to observe that, up to today, the utility
grid that speciﬁes the IDT use to require the VSR and ROCOF. Both are also the
main IDT suggested in many DGs interconnection relays as [30, 31, 33, 42–45].
Regarding the IDT with SGs, another important point to be analyzed is how to
perform its commissioning. How to ensure it is properly working? In Brazil, the
ABNT NBR 62116 standard deﬁnes the test procedure for islanding prevention for
grid-tied photovoltaic inverters. Nevertheless, there is no ABNT test procedure for
islanding detection with SG. The IDT effectiveness evaluation procedure is guided
by the IEEE 1547 series in North America as well as by the EN 50549 in Europe.
All these standards give a conformance test procedure for the IDT based in a
test bed composed of an AC power supply to emulate the inﬁnite bus, a resistive-
inductive-capacitive set to emulate the local load being islanded, and the protection
device under test. The diagram shown in Fig.7 illustrates the test bed to simulate the
islanding event.
The standards also provide the scenarios to be evaluated. Both cited standards
requires the DG to be initially set at its rated value and to adjust the load until the
current in CB is 2% of the rated current with unity PF. Next, CB is opened and
the time between the tripping and islanding detection is measured. Each standard
requires an additional set of conditions to be evaluated with different values of power
mismatch between the DG and local load demanded power. The islanding detection
effectiveness is considered approved once the IDT is tripped in less than 2 seconds
for all the scenarios.
In Brazil, the lack of standards to guide the IDT commissioning with SG implies
in insecurity to the DG users and, surely, it is an urgent point to be evaluated.

128
A. L. Finkler et al.
Fig. 7 Islanding detection test arrangement
In this chapter, the Brazilian standards regarding IDT were analyzed, where it
is observed the predominance requirement of the VSR and ROCOF. Considering
the importance of such devices regarding the islanding detection, in the following
section the working principle as well as the adjustment procedure of both devices
are presented.
4
ROCOF and VSR: Working Principle and Adjustment
Procedure
To a better understanding of the IDTs working principle, a review over the control
block diagram of a synchronous generator (SG) illustrated in Fig.8 must be done.
The two input variables of the SG’s control are the voltage applied to the ﬁeld coil
(Ef) and the mechanical power applied to the shaft (Pm). The control target of both
variables changes whether the SG must operate islanded or parallel to the grid.
When the SG is parallel to the grid, the mechanical power applied to the shaft
is directly related to the active power the SG is injecting into the grid. There is an
inner loop done through the controller 3 which takes the Pref as a main objective. It
will adjust the mechanical power applied to the shaft until the active power injected
into the grid reaches the desired value. An outer loop done through the controller
4 will imply a correction with the focus to keep the frequency near to the desired
value. Regarding the voltage ﬁeld control, an inner loop is done through controller
1 with the main objective of to keep the terminal voltage at a desired value, which is
usually 1 p.u. An outer loop is done through the controller 2 implying ia correction
in ﬁeld voltage to control the reactive power. It is usually set to 0 p.u. to ensure the
DG works with unity power factor. The working principle of all the control circuits
is deeply detailed in [46].

A Review of Islanding Detection Methods …
129
Fig. 8 Synchronous generator control block diagram
Thus, the typical setup of the DG to be connected parallel to the grid is known as
PQ, where the active and reactive power are set as the main references. If the SG is
desired to supply the local load in an islanding condition, the control technique must
be changed leaving the frequency as the main objective to the Pm control and the
voltage as the main reference to the Ef control. The comparison of the control mode
to operate parallel to the grid or islanded is detailed in [47–50].
In that case, with the DG’s control set to operate in a PQ mode, in case of an
unintentional islanding the generator will be put in an undesirable condition. As
soon as it happens, the active power that was previously deﬁned by the control setup
becomes a function of the local load. This transition happens in a step shape with the
amplitude deﬁned by the power mismatch and represented as P [51]. The working
principle of both IDTs, ROCOF and VSR, are directly related to the P at the instant
of the islanding event. In the following subsections both are detailed.
4.1
The ROCOF IDT
In the literature review, the ﬁrst reference found to the ROCOF protection device is
in 1977 [51]. Up to today, it is still one of the major IDT requested by utilities in
Brazil. Following the IEEE C37.2-2008 [52], the ROCOF protection is identiﬁed as
ANSI 81d. Its working principle is based on the frequency monitoring at the PCC.

130
A. L. Finkler et al.
Fig. 9 PCC’s voltage with an islanding at 0.25 s: a voltage before the islanding; b expected voltage
without the islanding; c displaced voltage’s frequency after the islanding
Once the SG becomes islanded, the shaft will start to accelerate or decelerate as a
function of the excess or deﬁcit of generation (P). Thus, the SG’s frequency will
be increased or decreased. In Fig.9 is illustrated a condition where at 0.02 seconds
the system becomes islanded. With a deﬁcit of generation the DG’s frequency starts
to decrease.
The frequency raising or falling speed is known as rate of change of frequency
and it is directly related to the P and inversely related to the inertia constant. While
the SG is parallel connected to the grid, the inertia of the system is very large and so,
any frequency deviation is very slow. Once the SG become islanded, the inertial of
this machine will be very small compared to the whole EPS. So, the rate of change of
frequency observed by a given P tends to increase. The main idea of the ROCOF
protection is to deﬁne a threshold to the ROCOF lightly over the maximum value
that could be observed while the DG is parallel to the grid. The rate of change can
be obtained by the Eq.2, where: d f
dt is the rate of change of frequency (Hz/s); f0 is
the frequency of the EPS; H is the inertial constant (s); P is the power mismatch
observed during the islanding event (p.u.).
d f
dt = f0P
2H ,
(1)
Regarding the threshold to be set at the ROCOF protection, in [53], a technical
report about a black out in London has pointed out the necessity of a standards
review. In this document it is highlighted that, up to this time, the typical adjustment
of the threshold of the ROCOF was about 0.125Hz/s. With the increasing of the

A Review of Islanding Detection Methods …
131
penetration levels of inverter-based generation resources, due to the quick dynamics
of such devices, the inertial of the EPS is being decreased allowing highest rates of
change of frequency to be observed. In [54], rates around 6 Hz/s are associated with
an Australian black-out event. In [55], a review over ROCOF’s false tripping, points
a solution of to setting the threshold to 1 Hz/s, applying a tripping delay of 500 ms. In
[56], an study was carried out regarding the effectiveness of the ROCOF protection
concluding that, with the setting of 1.0 Hz/s with 500 ms delay the ROCOF was able
to detect the islanding event in only 10% of the evaluated cases.
In [57], the authors investigate the false trip of the ROCOF protection in a biomass
DG pointing as not an easy task to choose the proper setting for the ROCOF relays
that will ensure the islanding detection also avoiding false trips.
So, in Brazil, worried regarding the power system stability issues, in 2021, the
ONS had suggested to ANEEL, the development of deeper researchers to properly
choose the settings of the ROCOF [55]. The trouble is that the ROCOF is requested
by some utilities without the information of the proper settings, putting over the DG’s
user the responsibility to choose the threshold.
Regarding the ROCOF protection adjustment, some questions could be high-
lighted. Once the EPS inertial is changing due to the DGs with inverter technology,
how often the ROCOF threshold should be reviewed? Does the DGs users have
enough information to properly choose the threshold? The DG’s interconnection
relays with the ROCOF protection could be implemented with an inertia identiﬁer
to self adjust the relays? Once the threshold of the ROCOF is raised or delays are
implemented to overcome instability issues due to false trips, how far the islanding
detection capability will be affected?
With decades of use, being available in most of the DGs interconnection relays
as an IDT, the ROCOF protection is still a focus of research. As another IDT, in the
next section, the VSR is evaluated.
4.2
The VSR IDT
In the literature review, the ﬁrst reference found to the VSR protection device is in
1983 [58]. Up to today, it is still one of the major IDT requested by utilities in Brazil.
Following the IEEE C37.2-2008 [52], the VSR protection is identiﬁed as ANSI 78.
Different names are found in the literature to refer to this technique. It can be named
as phase displacement monitor [59], vector shift relay [36], voltage vector shift [60],
phase jump detection [61] or vector jump relay [62].
Its working principle can be understood by the analysis of Fig.10. While the DG
is parallel connected to the grid, the ¯Is current is a function of the SG’s control setup.
The current ¯IGr will assume positive or negative value as a function of the SG’s and
local load current. Once the ¯Is is greater than the ¯IL, the excess of generation will be
injected into the grid as a negative value of ¯IGr. If the ¯Is is smaller than the ¯IL, the
deﬁcit of generation will be supplied by the grid through ¯IGr. Thus, while the SG is
parallel connected to the grid, the ¯Is has no straight relation to the ¯IL. In the other

132
A. L. Finkler et al.
Fig. 10 Basic diagram of a SG parallel to the EPS
Fig. 11 PCC’s voltage with an islanding at 0.25 s: a voltage before the islanding; b expected
voltage without the islanding; c displaced voltage with the islanding
hand, if the PCC lose its connection to the grid leaving the SG and the local load
islanded, the total amount of ¯IL will be fed by ¯Is, and so, they will match. In such
a situation, the ¯Is will no longer be a SG’s control function becoming a local load
function. This step in the SG’s current leads to a phase displacement at the PCC that
is used to perform the islanding detection.
In the VSR, the main idea is to islanding detect in the right subsequent cycle the
islanding has just happened. In Fig.11 it is illustrated a condition where the system
is islanded at 0.25 seconds. The idea of the VSR is to capture the phase displacement
even if the frequency remains constant in the next’s cycles.

A Review of Islanding Detection Methods …
133
Fig. 12 Vector phase
diagram
From the analysis of Fig.10, the SG’s internal voltage ¯EI will be at a displacement
angle to the PCC’s voltage represented by ¯VT . In the Fig.12, it is illustrated that the
distance between the ¯EI and ¯VT is deﬁned by SG voltage reactance droop
¯
V , which
is proportional to the ¯Is. The angle between ¯EI and ¯VT is known as the load angle,
which is represented by δi. When a loss of connection to the grid occurs, simulated
by the opening of the switch C B, leaving the local load exclusively fed by ¯Is, there
is a change in the load angle. Considering the ¯EI as a reference, the new voltage at
the PCC will be represented by ¯V ′
T . This change in the load angle is represented by
δi called the vector shift.
The change in the load angle of the machine can be easily assessed by measuring
the displacement in the phase of the voltage at PCC. Therefore, this displacement is
proportional to the change in the load angle. Figure13 illustrates the voltage at the
PCC immediately after the opening of the CB switch.
The VSR can be implemented following the ﬂowchart illustrated in Fig.14. Its
working principle is based on taking the voltage zero crossing as a reference to math
the period of each cycle. The information of the past cycle period is stored to be
compared to the current one. Any change in the period will be classiﬁed as a vector
shift. The time variation is converted to angle considering a full cycle as 360 degrees.
Next step is to compare the measured angle deviation to a threshold value. Once it
is exceeded an islanding condition is detected.
Fig. 13 Voltage measured at PCC in the cycle of islanding event

134
A. L. Finkler et al.
Fig. 14 Flowchart diagram
of the VSR
So, with the working principle of the VSR analyzed, the next step is to understand
how to set its threshold limits. Then, how to predict how much would be the phase
displacement obtained by a load step caused by the islanding? One way to access the
load angle of a SG is based in the vector diagram detailed in [46], with the respective
equation for the load angle given as:
δi = tan−1(
Xq Itcosφ −Ra Itsinφ
Et + Ra Itcosφ + Xq Itsinφ )
(2)
Based on this equation it is possible to predict how much would be the step in the
load angle based in a load current step for a given SG.
The Eq.2 relates the terminal voltage ( ¯Et) with the voltage behind the reactance
( ¯Eq) by its load current ( ¯It) and the machine parameters (Xq and Ra). Thus, once the
terminal voltage, terminal current and the machine parameters are known, the load
angle δi can be predicted. As in the general case the DG must be set to work with unity
power factor, these terms can be simpliﬁed from the equation with cosφ = 1 and
sinφ=0. Also considering the quadrature reactance much greater than the armature
resistance, the effects of Ra can be neglected. Assuming the voltage regulator will
keep the Et near to 1 p.u., the Eq.2 can be simpliﬁed as:
δi = tan−1(Xq It).
(3)

A Review of Islanding Detection Methods …
135
Thus, considering a previous value of the DG’s current being injected to the grid
as It1 and, a second value of the DG’s current demanded by the islanded load as
It2, the total load angle deviation that is observed during and islanding event can be
obtained from:
δi (total) = tan−1(It1Xq) −tan−1(It2Xq)
(4)
At the islanding moment, when the ¯Is change as a step as a function of P, the δi
starts to change in a transitory period. From the analysis of Eq.3 it can be observed
that the load angle has a straight relation to the Xq which has a transfer function
deﬁned by the time constants as:
G(s) =
sT ′′
q + 1
sT ′′
q0 + 1
(5)
where, T ′′
q is the short circuit constant and T ′′
q0 is the open circuit constant.
Multiplying Eq.5 by the transfer function of a step signal (U(s)) the step response
of the system, is given as:
Y(s) = G(s)U(s) =
 sT ′′
q + 1
sT ′′
q0 + 1
1
s

.
(6)
The inverse Laplace is obtained splitting the Eq.6 in two parts as:
Y(s) =
sT ′′
q
s2T ′′
q0 + s +
1
s2T ′′
q0 + s .
(7)
Next step is to simplify “s” in the ﬁrst term and divide both terms by T ′′
q0 as:
Y(s) =
T ′′
q /T ′′
q0
s + (1/T ′′
q0) +
1/T ′′
q0
s2 + s(1/T ′′
q0).
(8)
The system response can be written as a time function by applying the Laplace
inverse transform as follows:
Y(t) =
T ′′
q
T ′′
q0
e
−
1
T ′′
q0
t +

1 −e
−
1
T ′′
q0
t
.
(9)
With the total load angle deviation given by Eq.4 and, the transient behavior given
by Eq.9 the load angle deviation observed during the islanding event can be written
as a function of time as:
δi max =

tan−1
Xq It1
1 + Ra It1
−tan−1
Xq It2
1 + Ra It2
 T ′′q
T ′′
q0
e
−1
T ′′
q0
t
+

1 −e
−1
T ′′
q0
t180
π

, (10)

136
A. L. Finkler et al.
Table 2 Comparison of different measurements techniques applied on different manufacturers
VSR
Model
Phase to neutral
Phase to phase
Positive sequence Range [deg]
ABB 615 seriesa
[45]
X
X
X
2◦to 30◦
easYgen
3000XTb [33]
X
3◦to 30◦
7SR158c [31]
X
2◦to 30◦
KCG591Ed [42]
X
0.5◦to 15◦
BE1-11id [43]
X
X
2◦to 90◦
SEL-751d [44]
X
2◦to 30◦
MICOM P341d
[32]
X
2◦to 30◦
aThis relay allows to choose if the relay would be triggered once the vector shift exceed the limit
in all the three phase or in the positive sequence;
bThis relay allows to choose if the relay would be triggered once the vector shift exceeds the limit
in all the three phase or in just a single phase;
cThis relay only trip if the vector shift exceed the limit in all the three phases;
d This relay trips once the limit is exceeded in any phase
where: 180/π is used for converting radians to degrees and t, must be considered the
time period of a full cycle. A set of simulations deeply detailing the Eq.10 is given
in [63].
The Eq.10 gives an easy way to predict the load angle deviation to be observed
during an islanding event. It helps the DGs users to get the correct threshold values
to be set in the VSR as a function of a given load unbalance and the SG parameters.
With the support of this equation, self tuning relays can be proposed applying online
parameter identiﬁcation to obtain the machine reactance and its time coefﬁcients.
Examples of such techniques are given in [64–66].
One problem faced by the DG users of the VSR is to be sure the equipment will
properly measure the displacement angle. The VSRs available in the market can
measure either the phase-to-neutral, phase-to-phase, or positive sequence voltage,
calculate their period, then perform a comparison between the current and previous
values. Depending on the deﬁcit or excess of islanded load, the voltage vector can
jump back or forward. The VSRs may have different thresholds for a back jump or
forward jump, or even a single threshold, to be compared to the measured vector
shift module. Table2 shows the most popular protection devices for DG with VSR
functionality, their voltage reference method, and their adjustable range.
Once the VSR is set to check for the positive sequence or, to just be triggered
if the vector shift is observed in all the three phases, the sensitivity to single phase
faults is compromised. The authors understand that to ensure the proper action of the
VSR, there should be a standardization on the measurement reference procedures as
well as there should be deﬁned a conformance test procedure.

A Review of Islanding Detection Methods …
137
Besides theEq.10, somestudyhas alreadyproposedtohandletheVSRadjustment
by typical settings. The problems become that there is no consensus regarding what
would be the typical settings of the VSR. In [67], the typical values of this protection
device are deﬁned from 2◦to 20◦. In [68], simulations are done considering the
settings of 5◦, 10◦, and 15◦as typical values. While it is concluded in [69] that a
setting of over 7◦would result in this device not being able to properly detect the
islanding, the simulations performed in [70] show that the islanding could be quickly
detected by the VSR with +1◦and –2◦settings. The Schneider Electric MICOMP
P341 product manual deﬁnes that the typical setting is between 6◦to 13◦[32].
In [63], it is demonstrated that, once the VSR is evaluated alone as an IDT expect-
ing it to identify islanding events with a low power mismatch as 5%, its threshold
angle to be set should be often smaller than the lower limit of the VSRs listed in
Table2. A so small threshold also leads to the condition that any frequency deviation
could false trip the VSR. In the other hand, for an islanding event with a power
mismatch larger than 30%, the VSR demonstrates to be a quick protection able to
detect islanding in a few cycles.
In 2019, a lightning strike in Great Britain’s transmission lines has led to an unex-
pected shutdown of DGs leaving 1 million customers without power. The analysis
of this event pointed to a false trip of a VSR as one of the reasons for the cascade
tripping and some improvements in the power system were suggested, among them,
the removal of VSRs [53]. In Brazil, the VSR and ROCOF relays are still required
for SG and, in 2021, its ONS urged the ANEEL the need of new research to decide
on rather keep or remove VSRs. In the case of to former, it is also needed to deﬁne
clear procedures to obtain the correct settings [55].
5
Conclusion
Since the 1980s, with the beginning of the use of DGs, the risk of islanding detection
has worried the engineers. Special attention is given to the islanding detection with
synchronous machines due to its characteristics of to be able to keep running near the
regular condition even in an islanding scenario. The ﬁrsts techniques used to identify
the islanding scenario with SG were the over or under voltage (ANSI 59 and ANSI
27), over or under frequency (ANSI 81O and ANSI 81U), ROCOF (ANSI 81R) and
VSR (ANSI 78). Decades later, even with the advent of techniques applying signal
processing, artiﬁcial intelligence, they are still the main techniques required by the
Brazilian utilities as well as the main technique offered in the most popular DGs
interconnection relays. Along these decades, the ROCOF and VSR proper settings
have been the focus of different studies. In Brazil, a special request for research was
done in 2021 by the national power system operator [55]. With the increase of the DG
penetration, its impact in the power system stability is becoming a new challenge.
The islanding detection capability must be evaluated pondering the associated false
tripping risk. Thus, with the growing increase of inverter DGs, the lowering of the
powersysteminertia,theuseofpassiveIDTsasROCOFandVSRarebeingreviewed.

138
A. L. Finkler et al.
With the current scenario, the engineers are pressed to choose between to set these
devices to ensure the islanding detection capability or, to ensure the power system
stability.
References
1. Faisal M et al (2018) Review of energy storage system technologies in microgrid applications:
issues and challenges. IEEE Access 6:35143–35164
2. Sandoval D,GofﬁnP,Leibundgut H(2017)Howlowexergybuildingsanddistributedelectricity
storage can contribute to ﬂexibility within the demand side. Appl Energy 187:116–127. issn:
0306-2619. https://doi.org/10.1016/j.apenergy.2016.11.026
3. Sioshansi R et al (2022) Energy-storage modeling: state-of-the-art and future research direc-
tions. IEEE Tran Power Syst 37(2):860–875. https://doi.org/10.1109/TPWRS.2021.3104768
4. Yan B et al (2020) Markovian-based stochastic operation optimization of multiple distributed
energy systems with renewables in a local energy community. Electric Power Syst Res
186:106364
5. Sun Y et al (2020) Overview of energy storage in renewable energy power ﬂuctuation miti-
gation. CSEE J Power Energy Syst 6(1):160–173. https://doi.org/10.17775/CSEEJPES.2019.
01950
6. Rahman MM et al (2020) Assessment of energy storage technologies: a review. Energy Convers
Manag 223:113295. issn: 0196-8904. https://doi.org/10.1016/j.enconman.2020.113295
7. Serra R et al (2019) From conventional to renewable natural gas: can we expect GHG savings
in the near term? Biomass Bioenergy 131:105396
8. Marafon AC et al (2016) Use of biomass for power generation. In: Empresa Brasileira de
Pesquisa Agropecuária. issn: 1678-1953
9. EPE (2020) Brazilian energy balance. Technical report. https://www.epe.gov.br/sites-pt/
publicacoes-dados-abertos/publicacoes/PublicacoesArquivos/publicacao-479/topico-528/
BEN2020_sp.pdf
10. Zhang T et al (2020) Evaluation model and method on life-cycle comprehensive low-carbon
beneﬁts of large-scale energy storage system from the distribution network planning perspec-
tive. In: 2020 IEEE 4th Conference on Energy Internet and Energy System Integration (EI2),
pp 2174–2179. https://doi.org/10.1109/EI250167.2020.9347293
11. CSN (2019) Requirements for generating plants to be connected in parallel with distri-
bution networks-Part 2: connection to a MV distribution network-Generating plants up
to and including Type B. Technical report. https://www.en-standard.eu/csn-en-50549-2-
requirementsfor-generating-plants-to-be-connected-in-parallel-with-distribution-networks-
part-2-connection-to-a-mv-distribution-network-generating-plants-up-to-and-including-
type-b/
12. ANEEL (2021) Módulo 3-Conexão Ao Sistema De Distribuição De Energia Elétrica. Technical
report. https://www2.aneel.gov.br/cedoc/aren2021956_2_2.pdf
13. IEEE (2020) 1547.1-2020-IEEE standard conformance test procedures for equipment inter-
connecting distributed energy resources with electric power systems and associated interfaces.
Technical report. https://doi.org/10.1109/IEEESTD.2020.9097534
14. Cintuglu MH, Mohammed OA (2013) Islanding detection in microgrids. Technical. report.
https://doi.org/10.1109/PESMG.2013.6673041
15. Walid YM et al (2021) Islanding detection methods for microgrids: a comprehensive review.
Mathematics. https://doi.org/10.3390/math9243174
16. Cebollero JA et al (2022) A survey of Islanding detection methods for microgrids and assess-
ment of non-detection zones in comparison with grid codes. Energies. https://doi.org/10.3390/
en15020460

A Review of Islanding Detection Methods …
139
17. Li C et al (2014) A review of islanding detection methods for microgrid. Renew Sustain Energy
Rev. https://doi.org/10.1016/j.rser.2014.04.026
18. Sallam
A,
Malik
OP
(2018)
Microgrids
and
smart
grids.
https://doi.org/10.1002/
9781119509332
19. Photovoltaics DG, Storage E (2018) IEEE standard for interconnection and interoperability of
distributed energy resources with associated electric power systems interfaces, pp 1547–2018.
https://doi.org/10.1109/IEEESTD.2018.8332112
20. Chaitanya BK et al (2021) A comprehensive review of islanding detection methods. https://
doi.org/10.1016/B978-0-12-820491-7.00008-6
21. Mishra M, Chandak S, Kumar RP (2019) Taxonomy of Islanding detection techniques for
distributed generation in microgrid. Renew Energy Focus. https://doi.org/10.1016/j.ref.2019.
09.001
22. ENERGISA (2016) NTD-013: Criteria for connecting distributed micro and mini generation
system users to Energisa’s distribution system. Technical report
23. CEMIG-D (2019) ND 5.31: requirements for the connection to the CEMIG distribution system-
medium voltage connection. Technical report
24. CEMIG-D (2019) ND 5.30: requirements for the connection to the CEMIG distribution system-
low voltage connection. Technical report
25. CPFL (2020) GED-15303: connection of micro and mini distributed generation under electric
energy compensation system. Technical report
26. COPEL (2022) NTC 905200: micro and mini generation access to the system of COPEL.
Technical report
27. CELG-D (2016) NTC-71: requirements for connecting micro and mini generators to CELG’s
distribution system. Technical report
28. EQUATORIAL ENERGIA (2019) NT.020.EQTL: connection of distributed microgeneration
sssto the distribution system. Technical report
29. ANEEL (2020) Relatórios sobre as unidades consumidoras com geração distribuída. Technical
report
30. Thitronic (2021) MXR-P instruction manual. Technical report
31. Siemens (2016) 7SR158 Argus voltage and frequency relay. Technical report
32. Schneider Electric (2015) MiCOM P341: interconnection protection relay. Technical report
33. Gmbh Woodward (2022) EasYgen-3000XT series. Technical report
34. Mahat P, Chen Z, Bak-Jensen B (2008) Review of islanding detection methods for distributed
generation. Technical report. https://doi.org/10.1109/DRPT.2008.4523877
35. Ropp ME et al (2002) Using power line carrier communications to prevent islanding [of PV
power systems]. Technical report. https://doi.org/10.1109/PVSC.2000.916224
36. Patel MB, Parekh BR (2017) Islanding detection for distributed generation system. In: ICPE-
ICES. https://doi.org/10.1109/ICPEICES.2016.7853424
37. Pouryekta A et al (2017) Islanding detection and enhancement of microgrid performance. IEEE
Syst J. https://doi.org/10.1109/JSYST.2017.2705738
38. Mahat P, Chen Z, Bak-Jensen B (2009) A hybrid islanding detection technique using average
rate of voltage change and real power shift. In: PESGM. https://doi.org/10.1109/pes.2009.
5275976
39. Arroudi KE et al (2007) Intelligent-based approach to islanding detection in distributed gen-
eration. IEEE Trans Power Deliv. https://doi.org/10.1109/TPWRD.2007.893592
40. Faqhruldin ON, El-Saadany EF, Zeineldin HH (2012) Naive Bayesian Islanding detection
technique for distributed generation in modern distribution system. In: EPEC 2012. https://doi.
org/10.1109/EPEC.2012.6474982
41. Barrozo V et al (2021) Uma revisaão sobre as Técnicas de processamento de sinal e classiﬁ-
cadores inteligentes utilizadospara a detecção de ilhamento na geração distribuída em redes de
distribuição, pp 136–189. https://doi.org/10.22533/at.ed.93921160312
42. MEGACON (2019) KCG591E loss of mains protection KCG591x. Technical report
43. Basler Electric (2019) BE1-11i intertie protection system. Technical report
44. SEL (2017) SEL-751 instruction manual

140
A. L. Finkler et al.
45. ABB Group (2018) 615 series technical manual
46. Kundur P, Balu NJ, Lauby MG (1994) Power system stability and control. McGraw-Hill, New
York
47. Silva AMB et al (2016) Performance analysis of distributed synchronous generators with
controllers equipped with switchable operating modes. IEEE Latin Am Trans. https://doi.org/
10.1109/TLA.2016.7530424
48. Sorrentino E, Villafuerte P (2016) Effect of the control of generators and turbines on the
transient stability of a power system. IEEE Latin Am Trans. https://doi.org/10.1109/TLA.
2016.7459603
49. CosseREetal(2011)Turbine/generatorgovernordroop/isochronousfundamentals-Agraphical
approach. In: PCIC. https://doi.org/10.1109/PCICon.2011.6085887
50. Mahat P, Chen Z, Bak-Jensen B (2009) Gas turbine control for islanding operation of distribu-
tion systems. Energy Soc Gen Meet. https://doi.org/10.1109/PES.2009.5275701
51. Widrevitz BC, Armington RE (1977) A digital rate-of-change under frequency protective relay
for power systems. IEEE Trans Power Appar Syst. https://doi.org/10.1109/T-PAS.1977.32501
52. IEEE (2008) C37.2-2008-IEEE standard electrical power system device function numbers,
acronyms, and contact designations. Technical report. https://doi.org/10.1109/IEEESTD.2008.
4639522
53. National Grid ESO (2019) Technical report on the events of 9 August 2019. Technical report.
https://www.nationalgrideso.com/document/152346/download
54. ENTSOE (2020) Inertia and rate of change of frequency (RoCoF). Technical report
55. ONS (2021) ONS DPL-REL-0317/2020-Evolution of requirements necessary to enhance the
insertion of distributed generation without adverse impacts to the stability of the national
interconnected system. Technical report
56. Tzimas D, Dy´sko A, Campbell B (2016) Performance of loss-of-mains detection in multi-
generator power Islands. In: DPSP. https://doi.org/10.1049/cp.2016.0066
57. Wang Z, Xiong J, Wang X (2019) Investigation of frequency oscillation caused false trips for
biomass distributed generation. IEEE Trans Smart Grid. https://doi.org/10.1109/TSG.2019.
2896480
58. Phadke AG, Thorp JS, Adamiak MG (1983) A new measurement technique for tracking voltage
phasors, local system frequency, and rate of change of frequency. IEEE Trans Power Appar
Syst. https://doi.org/10.1109/TPAS.1983.318043
59. Redfern MA, Usta O, Fielding G (1993) Protection against loss of utility grid supply for a
dispersed storage and generation unit. IEEE Trans Power Deliv. https://doi.org/10.1109/61.
252622
60. Lidula NWA, Rajapakse AD (2012) A pattern-recognition approach for detecting power Islands
using transient signals-Part II: performance evaluation. IEEE Trans Power Deliv. https://doi.
org/10.1109/TPWRD.2012.2187344
61. Khamis A et al (2013) A review of islanding detection techniques for renewable distributed
generation systems. Renew Sustain Energy Rev. https://doi.org/10.1016/j.rser.2013.08.025
62. Andrade MT (2010) 12.5 MVA generator islanding protection. In: T&D-LA. https://doi.org/
10.1109/TDC-LA.2010.5762953
63. Finkler AL et al (2022) Challenges on the Use of Vector Shift Relays in Distributed generation:
a Brazilian case study. Electric Power Syst Res. https://doi.org/10.1016/j.epsr.2021.107688
64. Rocha MCA, Meneses LAE, Giesbrecht M (2020) Synchronous machine parameters identi-
ﬁcation from data acquired during operative range test. In: IEEE international symposium on
industrial electronics (ISIE). https://doi.org/10.1109/ISIE45063.2020.9152393
65. Jian Q et al (2018) Error analysis of on-line identiﬁcation of parameters of synchronous gener-
ators. In: IEEE PES Asia-paciﬁc power and energy engineering conference (APPEEC). https://
doi.org/10.1109/APPEEC.2018.8566325
66. Zaker B et al (2016) Simultaneous parameter identiﬁcation of synchronous generator and
excitation system using online measurements. IEEE Trans Smart Grid. https://doi.org/10.1109/
TSG.2015.2478971

A Review of Islanding Detection Methods …
141
67. Freitas W, Zhenyu H, Xu W (2005) A practical method for assessing the effectiveness of vector
surge relays for distributed generation applications. IEEE Trans Power Deliv. https://doi.org/
10.1109/TPWRD.2004.838637
68. Freitas W, Xu W (2004) False operation of vector surge relays. IEEE Trans Power Deliv. https://
doi.org/10.1109/TPWRD.2003.820412
69. Meiyi H et al (2008) Vector shift method for islanding detection based on simulation test. Trans
Tianjin Univ. https://doi.org/10.1007/s12209-008-0022-x
70. Laaksonen H et al (2018) Advanced islanding detection on grid interactive microgrids. In:
CIRED 2018 Ljubljana Workshop

Distributed Energy Resources
Management Systems (DERMS)
Alvaro R. Albertini, Vítor T. Yabe, and Silvio G. Di Santo
Abstract Distributed energy resources (DERs) have been acknowledged as strate-
gic assets to support the continuous growth of global electricity demands. Besides,
the constant growth of DER installations worldwide will signiﬁcantly alter the way
power systems are planned and operated, primarily due to the bidirectional power
ﬂow characteristics and the intermittent nature of DERs generation. In this con-
text, distributed energy resources management system (DERMS) are a crucial tech-
nology to allow seamless integration, DER situational awareness, support by driving
electrical market operations, and enabling grid services in the distribution network.
Over the recent years, DERMS research and development has been conducted to
establish not only the functional requirements for such technologies to operate but
also deﬁning open standards for data exchange and communication protocols con-
tributing to facilitating the synergy between DERMS applications and the existing
monitoring and control elements such as Energy Management Systems (EMS). As
part of the efforts to establish the technology, utilities worldwide have been conduct-
ing DERMS pilot projects as a way to investigate the available beneﬁts in real-world
scenarios and possible gaps that still need to be addressed.
1
Introduction
The power sector is currently experiencing signiﬁcant transformations worldwide
toward sustainable growth, digitization, and an outstanding adoption of renewable
energy technologies in a decentralized fashion. This transition is especially driven by
A. R. Albertini (B) · V. T. Yabe · S. G. Di Santo
Department of Electrical Energy and Automation Engineering, University of São Paulo Av. Prof.
Luciano Gualberto, 158 - Butantã, São Paulo - SP 05508-900, Brazil
e-mail: alvaro.albertini@usp.br
V. T. Yabe
e-mail: vitor.yabe@usp.br
S. G. Di Santo
e-mail: silviogiuseppe@usp.br
© The Author(s), under exclusive license to Springer Nature Switzerland AG 2024
A. J. Sguarezi Filho et al. (eds.), Smart Grids—Renewable Energy, Power Electronics,
Signal Processing and Communication Systems Applications, Green Energy
and Technology, https://doi.org/10.1007/978-3-031-37909-3_5
143

144
A. R. Albertini et al.
the decreasing costs of renewable generation technology, such as solar photovoltaic
(PV) and wind particularly connect to low-or medium-voltage grids [1]. The adop-
tion of small and medium-scale renewable energy sources is seen, and increasingly
endorsed, as an effective alternative to conventional fossil-fueled generators and as a
central enabler of a low-carbon future in the power sector through a more reliable and
clean energy supply. DER expansion shifts power generation from the traditionally
centralized to a pulverized fashion of several smaller-scale units connected to the
distribution feeders. However, the successful implementation and adoption of such
intelligent systems will strongly rely upon Smart Grid (SG) technologies such as
communication, optimization, data modeling, and forecast tools.
In the SG context, DER comprises a pool of technologies implemented both
at the generation and demand sides in order to transform the load requirements.
In opposition to centralized generation, DERs are scattered assets deployed at the
distribution grid, together with operational methodologies, that allow the energy
demand optimization. DERs are often behind-the-meter (BTM), private-owned enti-
ties, connected at low or medium voltage feeders. This group of resources includes
all kinds of renewable, as well as non-renewable, distributed generation (DG), such
as rooftop PV panels, small wind turbines, combined heat and power (CHP), diesel
generators, and others. Additionally, energy storage systemss (ESSs), electric vehi-
cles (EVs) and their charging stations, demand response (DR), controllable loads
and energy efﬁciency programs are also considered as DER technologies [2].
DERs deployment is an important advantage for the future of power systems by
diversifying the energy mix, increasing system reliability, and offering new business
models, planning, and operation opportunities through the delivery of grid services.
Nevertheless, the adoption of new generation technologies, such as variable renew-
able energy source (RES), introduces many challenges to the planning and opera-
tion of traditional power systems [1]. Beyond the environmental concerns and the
social interest in a more sustainable future, an increased burden is expected on elec-
tric systems of the future due to massive electriﬁcation. Resilience and reliability
enhancements will be required to improve the traditionally interconnected system,
which may be achieved through a shift in power generation from the centralized to
a distributed fashion [3].
1.1
DER Penetration Impacts
Transitioning power generation with massive DER penetration represents a paradigm
change in the planning and operations of distribution systems. This development
means many consumers will stop being ﬁxed loads and will become active entities
at the distribution grids. The “prosumers” will be allowed to inject power into the
distribution grid through their asset’s operation in exchange of power credits or
even directly selling it in the energy markets. Nevertheless, establishing signiﬁcant
active power generation at lower voltage levels, which were not designed for such
assignment, without proper management would naturally raise different challenges

Distributed Energy Resources Management Systems (DERMS)
145
to the system’s operation. The “ﬁt-and-forget” fashion DERs have been deployed
so far, meaning the majority of the implemented resources have no monitoring nor
operation control, has further aggravated this issue.
The popular monotonically decreasing voltage proﬁles of distribution grid, from
the substation to feeder’s end, will no longer be obvious. The lack of management
between the power dispatch of multiple DERs may cause power bottlenecks, lead-
ing to feeder overloads. Intense active power injection by prosumers without proper
handling may cause local overvoltage and breach of operational limits [4]. Unmon-
itored bidirectional power ﬂow in the distribution grid may increase system losses
and endanger system operation. Additionally, as protective elements were designed
to accommodate traditional top-down power ﬂow, changes in the direction of power
ﬂow may cause the malfunction of protection strategies. Further aggravating this
issue, connecting DERs may also increase the system’s short circuit levels and fault
severity [5].
AnotherrisingchallengerelatedtoDERpenetrationistheincreasedunpredictabil-
ity of power generation. As a considerable part of DERs are weather dependent, they
are innately volatile. A similar complication appears when dealing with unmoni-
tored EV due to the stochastic behavior of their connection to the grid, raising levels
of uncertainty and variability in the planning and operation of distribution systems
and of day-ahead forecasts [6].
1.2
Mitigating DER Impacts
These signiﬁcant impacts of uncoordinated DER expansion have been identiﬁed by
utilities in pioneer countries. It is understood that the rise of such challenges relates to
an inadequate planning and management during DER integration, which may likely
grow acuter with the increasing installed capacity [7]. The lack of closer monitoring
and ﬂexibility has shown an increasing need for improved distribution grid opera-
tions and capabilities [8]. Nevertheless, further deployment of DERs is expected and
encouraged, which raises the necessity for enhanced power system ﬂexibility, hosting
capacity, and strategies to safely and effectively facilitate integration of DERs.
Beyond the traditional system expansion plans, different methods have been
investigated to mitigate negative DER effects in distribution grids, usually creat-
ing higher interactions between utilities and prosumers through intelligent devices
and enhanced data exchange between stakeholders. Technological advancements
embedded in DERs and renewable energy projects, such as the use of smart meters
and inverters, internet of things (IoT) and big data exchange enable grid services
of the future. Novel abilities and functionalities of smart inverters will allow small-
scale DERs to act in a similar way to the coordinated large-scale power genera-
tors, facilitating innovative control schemes and desirable functionalities in an easy,
plug-and-play fashion through safe and reliable network connections. Additionally,
modern DER inverters, which usually operate close to the unitary power, are often
able to be broadly explored within their capability limits, allowing the delivery of

146
A. R. Albertini et al.
reactive power complementary to its active power production. Given the increas-
ing RESs installed capacity, intense simultaneous active power injection bound
to weather conditions become often unnecessary and must be curtailed. Thus,
enabling DERs for the delivery of grid services, in addition to the development of ESS
technologies, maybe also a solution to avoid renewable power cutbacks. Moreover, in
accordance with a collective interest in the procurement of ﬂexibility services, DERs
are also enablers of local ﬂexibility markets and optimal use of resources, as they
can be instructed, for instance, to reduce export generating capacity or increasing
consumption [9].
Emerging trends on power systems requirements and concepts indicate capabil-
ities for resource coordination and management as efﬁcient methods not only to
overcome DER penetration challenges but are also seen as enablers of novel busi-
ness models and enhanced grid efﬁciency through the delivery of grid support and
ancillary services at lower voltage levels. Current power system develops toward a
centralized information and decision platform to integrate dispersed resources, opti-
mizing their schedules in accordance to the grid requirements As seen in different
pilot projects, DERMS might be a proper solution to mitigate related impacts while
capturing the full value of DER assets, suggesting optimal operations and facilitating
the adoption of novel capabilities and services.
2
DERMS Theory and Design
Modern power systems are evolving to a higher degree of decentralization and will
requireoperatingstrategiestoaggregateresourceinformationanddecisionsaimingto
deal with this increasing granularity. No longer can DERs be considered as individual
devices interconnected to the grid, they must now be integrated and managed as
part of transmission and distribution systems [10]. Larger DER presence requires
grid improvements in ﬂexibility and dynamic operations at the lower voltage levels
in order to reduce unavailability and avoid potential threats to the power supply,
reducing renewable generation curtailments and utility penalties.
Nevertheless, further deployment of DERs is expected and encouraged, which
raisesthenecessityforimprovedpowersystemﬂexibility,hostingcapacityandstrate-
gies to safely and effectively facilitate DER integration. Emerging trends indicate
capabilities for resource aggregation, coordination and management are key concepts
to overcome DER related challenges, such as limited grid hosting capacity and the
negative impacts of uncoordinated DER penetration. Moreover, these abilities are
also fundamental to enabling enhanced grid efﬁciency and novel business models
by allowing the provision of ﬂexibility and grid support functions at lower voltage
levels.
DERMS help leverage the technological gap of DER penetration by improving
ﬂexibility and robustness of the grid with monitoring, operation, and control of
broad DER ﬂeets. They can help deliver essential modern grid capabilities, such as

Distributed Energy Resources Management Systems (DERMS)
147
real-time optimization, facilitated DER integration, coordinated DER dispatch, grid
support functions, expanded prosumer participation, and improved fault treatment.
The DERMS is a software application designed to collect device information,
monitor resources, and allow coordinated dispatch. Their primary function is to
combine dispersed resources into aggregates for facilitated management and inte-
gration into the power system. They can coordinate a comprehensive DER portfolio,
enabling their dispatch control for multi-objective targets, including but not limited
to grid support objectives, optimized according to stakeholders’ preferences. This
novel concept covers various implementations, functions, andpurposes. Bothbehind-
and front-of-the-meter DERMS applications have been suggested in the literature,
leading to different designs for DERMS, such as Aggregators or DERMS platforms,
and ownership as a utility- and non-utility DERMS. Despite bearing diverse require-
ments and goals, these distinct perspectives most likely must be complementary in
an intricate architecture within the power system to fully exploit its potential.
2.1
DERMS Concepts and Application
DERMS is a platform to support electricity distribution from energy providers to
energy consumers, thus connecting resource owners to the power system authorities.
A DERMS is the software platform from which utility, or third-party aggregators,
will manage a DER aggregation program under a speciﬁed jurisdiction. DERMS
aggregates DERs’ device information, operational constraints and data for their inte-
gration into existing system operations platforms. DERMS must have access to the
ongoing grid conditions, send dispatch and market signals directly to the individual
assets, or to a DER aggregator, which will redirect the commands to the resources
in its portfolio and send their performance data back to the utility.
Thesesoftwaresuseareal-timecommunicationsinfrastructuretocaptureinforma-
tion from multiple DERs, translating it into measurable aggregate data to enable the
control and coordination of local resources and to participate them in grid operation,
management, and energy markets. The DERMS’ ability to manage large numbers of
distributed assets can lead to a more ﬂexible and resilient grid [11].
The core assignment of a DERMS is to create, validate, and adjust the schedule
of operating DERs combined into previously declared resource groups. Addition-
ally, DERMS must validate the adjusted schedules with the distribution network oper-
ators to comply with grid constraints and solve foreseen constraints violations using
the available resources in its portfolio [12].The data transmitted through the DERMS
may also be used to fairly compensate all stakeholders, based on system performance,
involved in the attendance of the requested services.
Other entities designed to allow the aggregation of power resources already exists,
such as virtual power plants (VPPs) and microgrids. However, their ﬂeet management
applications differs. Microgrids are entities with limited electrical boundaries that
are able to aggregate their power resources aiming to maintain a resilient operation

148
A. R. Albertini et al.
of partially or completely islanded grids. They can provide services to the intercon-
nected system, but their main focus is reliably manage a stable load supply. On the
other hand, DER aggregators such as VPPs and DERMSs, differ from microgrids as
they usually have a very large DER portfolio without clearly deﬁned electric bound-
aries. These aggregators mainly provide services to the distribution and transmission
systems and enable DER participation in electricity markets instead of serving indi-
vidual loads [10]. The operation of their assets is usually done in blocks of resources
that can be remotely and automatically dispatched using meters, a software sys-
tem, and a communications network. The focus of VPPsis to participate DERs in
the energy markets and grid balancing [13]. VPPs are also used for global grid sup-
port services, including demand response/capacity, frequency regulation, operational
reserves, energy arbitrage and peak demand management [11].
DERMS purpose is to help solving local bottlenecks and increased dispersed
resources hosting capacity with an optimized DER operation. Thus, DERMS val-
idates power dispatches, derived from upper entities’ calculations, for DERs that
are eligible to participate in prosumer special programs to contribute to local and
global grid objectives. For that, DERMS must aggregate and dispatch multiple DERs,
coordinate their operation in the electric system, and optimize their output. Similar
to VPPs, DERMS also observes and dispatches their resources in form of aggre-
gates through a communications network. However, in addition, they can enable
their aggregates to provide optimized grid support services, with objectives such as
the maintenance of network reliability, power quality, availability, and resilience at
speciﬁc locations [13]. Thus, a DERMS usually requires more complex back-end
system integration with the incumbent management systems than VPPs, due to the
requirement of regional grid and asset state information [11].
To clearly establish its part in the regulated utility services, DERMS must obey
the operational constraints of the power grid it operates with. It is also its function to
coordinate the operation of its DER with grid operations, protective systems, and con-
trols. As stakeholders of DER assets connected to the power system, DERMS should
be sure the ﬂeet follows in force jurisdiction of the system operators to whom they
connect. It is assumed that DERMS owners have established contracts with the distri-
bution system operator (DSO) and, or transmission system operator (TSO) to whom
they communicate and provide their power and grid services. In addition, indepen-
dent DERMS owners are also assumed to have contracts, guaranteeing DERMS
assistance in a reliability-constrained economic dispatch that contributes to main-
taining the load supply, with the market operators and balancing authoritys (BAs)
to whom they offer their power and capacity services. Figure 1 indicates DERMS
as a centralized agent that is able to aggregate different resources spread through
the distribution system, such as generators, storage systems and controllable loads.
It may be in direct contact to the resources, as well as sending them signals via an
aggregator platform.

Distributed Energy Resources Management Systems (DERMS)
149
Fig. 1 DERMS is a platform to aggregate multiple DERs, from different types, to simplify their
management and service delivery to grid operators
2.1.1
Basic DERMS Types
DERMS may be able to aggregate their resources based based on different charac-
teristics, such as technology, installed capacity, response rates, substation or feeder
level, and other intelligent way to manage demand response, decentralized gener-
ation, decentralized energy storage, and enabling virtual power plants. These plat-
forms must be reliable and scalable, able to support the grouping of multiple DER
and maximizing their value through energy and services in energy and capacity mar-
kets [10]. There are different ways of designing and organizing these solutions. At
ﬁrst, the Institute of Electrical and Electronics Engineers (IEEE) standard 2030.11
describes that DERMS can be aggregators or operators, and these two designs may be
implemented as two separate entities, or as part of a single platform. Also, DERMS
may or may not belong to the utility company [13].Some classiﬁcations of DERMS
could be as the following:
• DERMS aggregators: DERMS aggregator is in direct contact with the DERs.
This entity is the service provider, communicating with the individual resources
at one end and with a higher platform at the other, from whom DERMS receives
the requests for power, capacity, or other services. The aggregating DERMS must
know the assets available in its portfolio, their respective contract rules, and the
operational limits of the network to which they connect. By monitoring the oper-
ation of each asset and its contractual limitations, it is able to know their capacity,

150
A. R. Albertini et al.
availability and operation limits in every instant. Thus, it is capable to monitor and
act directly on its assets operation, attending the service requests for the mainte-
nance of the grid operation in an optimized fashion.
• DERMS operator: The DERMS operator may not be in immediate contact with
the DERs. Implemented in a higher level of the grid, this DERMS may have a port-
folio of other aggregators to command. The DERMS operator, as an aggregator,
also receives requests for grid services. However, it must also receive information
about the availability of its portfolio. Thus, it must be able to fulﬁll the requested
services, within the available capacity, through an optimized resource dispatch
of DER aggregates. The operator must also inform the higher entities about the
fulﬁllment of the requirements. As entities that receive requirements, the perfor-
mance of both DERMS operators and aggregators may be evaluated through the
effectiveness of service provision.
• Utility DERMS: As for its ownership, DERMS may integrate distribution systems
platforms, in which case they are deﬁned as utility-DERMS. In addition to ensuring
the operation of their resources within their respective capabilities, DERMS in
this role usually attend to optimization objectives related to grid operation, such as
reducing network losses, improving voltage and frequency stability, and offering
capacity services.
• Non-utility DERMS: DERMS may also be owned by third parties, known as
non-utility DERMS. In this case, they can belong to private parties, industries,
large consumers, energy communities or other entities that need to manage or
optimize their DERs. The optimization objectives of a DERMS in this position, in
general, are related to an economic dispatch of their portfolios, aiming to lower the
electricity costs of the prosumer who owns a DERMS. Naturally, the operational
suggestions given by these platforms must also respect the available capacities and
network operational limits.
2.1.2
DERMS Functional Speciﬁcations
Energy platforms may be considered as DERMS, regardless of their ownership and
complexity, if they are able to perform four basic functionalities of aggregating a
large number of distributed resources and representing them to the utility in a smart
fashion [13]. Through a portfolio of suggested functions, these platforms should be
able to aggregate, simplify, optimize, and translate its resource portfolio. According
to IEEE, a platform which achieves these four functionalities, described in Table 1,
may be considered a DERMS.
DERMS are evolving technology and therefore with no clearly deﬁned minimal
deﬁnitions yet. A suggested functional speciﬁcations for a DERMS may be divided
into basic, optional and grid services functions. Basic functions are responsible for
the operating, monitoring and saving device related information, thus divided in three
subgroups: DER Device Information; Operation; and Monitoring. The ﬁrst category
includes functions for resource registration, grouping, and capability communication
with grid authorities. It allows DERMS to effectively describe their DER assets in

Distributed Energy Resources Management Systems (DERMS)
151
Table 1 Basic functionalities of DERMS according to IEEE standard 2030.11
Aggregate
DERMS should merge the outputs of a pool of individual resources and
present them as aggregated virtual resources, which are more manageable
and fewer in number
Simplify
DERMS should be able to deal with the details of each of its vast
resources settings and present them in simple grid-related functions
Optimize
DERMS should optimize its resource usage considering the existing
infrastructure to ﬁnd desirable operational points at minimal cost,
necessary operational performance and ﬁnest attainable product quality
Translate
DERMS must handle communications and messages disparities to shape
and present the aggregate results in an understandable fashion to the grid
authorities
predeﬁned groups, which could be based on technology, resource location, feeder
level transformer, electrical protection area. Resource groups may be done in differ-
ent ways, which inﬂuences the resource dispatch a DERMS will calculate to fulﬁll the
upstream entity requests. The DER Information function, which holds information
on device nameplate data, communication and installation information, electrical
location, device settings, interconnection rates, service dates, and modeling infor-
mation. It also allows the arrangement of different resource groups, through grouping
functionalities, based on characteristics such as geographical location, resource type,
installed and ramping capacities, or others.
The second category of fundamental DERMS functionalities, Operation, relates
to the dispatch, scheduling, and control of the DERs in a DERMS portfolio. DERMS
should manage energy, capacity, or services delivered on a daily, seasonal or ad-hoc
basis. Finally, the third category of base functions, Monitoring, includes functions to
support DERMS in retrieving and sharing DER operational status, such as availability
and electrical measurements.
Additionally to base functions, optional functions are also foreseen in the func-
tional speciﬁcation suggested in [13]. Optional functions include the use of weather
data, improving load and generation forecasts, and support of real-time system oper-
ations. Real-time applications are a characteristic of DERMS, as these platforms
will be able to evaluate and operate their resource portfolio online, including multi-
objective optimization of DERs, information exchange about ﬁnancial agreements,
attendance of business rules and grid constraints, and online resource visualization.
Lastly, a DERMS may support grid operations through its grid support functions.
These are designed to enable a DERMS to operate its resources, whenever requested
by upstream entities, in order to attend to grid necessities. In this way, a DERMS
enables DERs to deliver grid services, such as voltage support, load shaping and
shifting, constraint management, and others. Figure 2 is an overview of the described
group functions suggested as speciﬁcations by [13].

152
A. R. Albertini et al.
Fig. 2 Suggested functions for DERMS by the IEEE standard 2030.11
2.2
Design Overview
Coordination, integration and aggregation of dispersed resources are needed to incor-
porate DER into the distribution systems’ planning and operation. There are three
fundamental components of DER aggregation: a communications software platform,
together with a communication-capable hardware, and a DER ﬂeet to be aggregated.
Through a communications platform, power system operators contact DER aggre-
gators for sending market signals, services requests, or even curtailment commands.
To allow DER assets to receive messages and respond to the utility, the individual
resources must be equipped with capable communications hardware that must also
observe the output data from the individual DER and submit them to its aggregator
or to the utility [10].
DERMS is an information platform that schedules the dispatch of multiple DERs
to optimize grid usage. From the identiﬁcation of constraint violation conditions,
such as network congestion, or upon receiving dispatch requests from higher enti-
ties, a DERMS calculates an efﬁcient dispatch of its DERs to solve these issues
while avoiding critical situations. This is possible due to a robust communication
between DERMS and its resources, as well as between DERMS and the grid oper-
ator. In order to establish the power dispatches to solve an identiﬁed local prob-
lem, DERMS uses the awareness of the current state of its resources and of the
power system, through communication with advanced distribution management
systems (ADMS). It then takes advantage of its resources’ ﬂexibility to redesign
predetermined dispatch in order to avoid expected network constraints violations
and achieve global and user-deﬁned objectives.

Distributed Energy Resources Management Systems (DERMS)
153
2.2.1
Basic Architecture
A DERMS platform will be responsible for a large number of DERs, which may
be utility or third party owned. In the last case, prosumers may agree, through util-
ity incentive programs and contracts, to allow their energy resources’ dispatch to
be set up by a DERMS program. A registration functionality, which allows for the
facilitated integration of new DERs to the platform, will help DERMS to receive
new resources. The registration of a new resource into the platform must contain,
for instance, nameplate information, installed capacity, operational limits, geograph-
ical location, owner, and so on. In addition to the static characteristics of equipment
included in each resource entry, live operational information and current network
status will also contribute to foreseeing future grid states and consequent predic-
tion of boundary violations. For that, DERMS must be able to communicate with
its resources, so sending and receiving the necessary information for their oper-
ation. Thus, a communication network between DERs and DERMS is needed to
send resource conditions to DERMS, as well as to broadcast dispatch commands
from DERMS to DERs.
There are multiple ways to design a DERMS, with minimum requirements
being: a centralized platform for information and decisions, a reliable and secure
communication network, smart meters, and multiple distributed energy resources
equipped with power inverters capable of transmitting data and executing the received
commands. Figure 3 shows the entities that participate in a DERMS, as well as basic
information, exchanged between them.
Fig. 3 Entities interaction within a DERMS program

154
A. R. Albertini et al.
A DERMS can, for example, check with the higher network entities whether
present schedules of its resources will incur grid constraint violations at future
instants and, if a violation is detected, recalculates the dispatch of its DER portfo-
lio. As assumed earlier, knowledge of the current states of resources is fundamental
for DERMS, and it is a component of a basic functionality known as Capability, in
which DERMS communicate these conditions to the grid operator.
Thus, the DERs communicate to DERMS at predetermined time intervals, possi-
bly through the registration or aggregator platforms, their present productions, and
operational limits. DERMS then validates the communicated limits for violations of
network constraints. The schedules sent by DERs may, or may not, be accepted. In
case of disapproval, DERMS can segregate the decision to restrict only speciﬁc DERs
that would put the network operation at risk.
Once the decision is known, DERMS sends the schedules that must be changed
to the aggregator platform, which in turn communicates to the DERs. Thus, the
schedules constrained by the DERMS are incorporated into the planning of these
resources. The aggregator then sends the new ﬂexibility schedules to the DER groups,
as well as the individual schedules for each of the resources. This result can still be
usedbyDERMSforforthcomingcalculations,helpingtodeterminefuturegridstates.
This process is visually explained visually in Fig. 4.
Fig. 4 High level information ﬂow to solve foreseen grid constraint violations

Distributed Energy Resources Management Systems (DERMS)
155
3
Enabling Protocols for DERMS
Interoperability and standardization are critical topics to successful DERMS deploy-
ment in an utility context. The following chapter will introduce an overview of the
technologies and protocols used by the power systems industry, not only for DERMS,
but also driven by the grid modernization initiatives. Such protocols will be organized
in two main areas, which are distribution management system (DMS)-to-DERMS
and DERMS-to-DER levels as suggested by [14].
3.1
DMS-to-DERMS Level
In the context of SG applications, there is an increasing need to integrate extensive
amounts of data produced and stored in different information systems. As utilities
become involved with technologies and processes to deploy the SG infrastructure,
such a scenario becomes even more complex once the lack of interoperability and
multiple data sources may create information management mismatches and integra-
tion problems [15]. In [16], the concept of “accidental architecture” is developed,
which describes a system integration architecture built on demand based on the util-
ity needs without considering integration and synergy aspects among information
systems. Such a scenario can eventually generate data duplicity, inconsistency, and
incompatibility may negatively affect the utility operations, support to business deci-
sions, and reliable operations. In [15], there are also three primary aspects to motivate
utilities to consider Enterprise Architecture as the basis for their business:
• Applications integration: business applications are better supported when the sys-
tems involved work with fewer duplicity and incompatibilities.
• Cost optimization: a series of indirect costs associated with not planned integration
of information systems signiﬁcantly impact utility proﬁts. For instance, these costs
are associated with support, personnel, translators development, licensing, and
others.
• Diverse information technology environment: The utilization of different tech-
nologies, protocols, and applications has led the utility to look for central solutions
capable of inter-operating.
In the context of an enterprise utility system, the DERMS might potentially be one
additional subsystem exchanging information with the DMS and its several subsys-
tems in the utility enterprise network. Industry-driven initiatives have been under
development to foment discussion and standardization related to data migration and
communication exchanges between such utility systems, providing reliable and cost-
effective solutions to support SG deployment.

156
A. R. Albertini et al.
3.1.1
CIM Model
As part of the main topics in the SG deployment, data interoperability and standard-
ization are critical aspects of exchanging information among different enterprise
systems and report data to external entities as part of new market regulatory proce-
dures and services. Such a scenario has driven initiatives from organizations targeting
a new standard to deal with data complexity and systems integration. The current
consensus of the industry relies on the Common Information Model (CIM) family of
standards, which has been accepted as the core standard supporting the moderniza-
tion of the electrical grid. As one of the main purposes of CIM is to establish detailed
power system modeling without having to maintain the same database in different
formats, among different subsystems in the utility enterprise network. The model is
conceived using the Uniﬁed Modeling Language (UML) which is well accepted by
the software industry, as well as establishing extensible Markup Language (XML)
and Resource Description Framework (RDF) as the main data representation formats
and exchange between applications. The CIM has been receiving worldwide recog-
nition by utilities and systems vendors as an important standard to bear the future of
the SG [17, 18].
The CIM has three main working groups (WGs) supporting three different areas.
These are the WGs 13, 14 and 16. WG 13 covers the deﬁnitions of electrical modeling
and has more focus on the TSO point of view. WG 14 has its main focus on the system
interfaces for distribution management (SDIM). It has the main purpose of expanding
the foundational CIM concepts, based on the TSO applications, to the distribution
utilities and DSOs, therefore, including the modeling of DERs, unbalanced networks,
medium and low voltage networks. In an ever growing deregulated market scenario,
the WG 16 was established aiming to support data interoperability and exchange
among different electrical sector participants in the energy markets [17, 18].
The three Working Groups have each produced a different International Elec-
trotechnical Commission (IEC) standard concerning the most relevant topics on each
sub-are. As part of WG 13 WG 14, and WG 16, respectively, the IEC Standards
61970, 61968, and 62325 were created which essentially compose the CIM [17, 18].
3.1.2
Utility Enterprise Integration
As introduced priorly, utility enterprise integration is a vital concept to consider when
developing and further expanding the set of technologies deployed in the context of a
distribution utility, mainly in a scenario with constant adoption of SG solutions. As a
way to allow seamless integration between different applications and systems, CIM
also establishes the concepts and rules on how to manage communication among
different applications [19, 20].
The IEC 61968 series of standards [19] develops the CIM concepts of data model-
ing and enterprise integration applied in the context of a distribution utility. Table 2
introduces the different parts of the standard that has been developed and the speciﬁc
areas.

Distributed Energy Resources Management Systems (DERMS)
157
Table 2 Subparts of IEC 61968. Source: [19]
IEC 61968-1
Interface architecture and general recommendations
IEC 61968-2
Glossary
IEC 61968-3
Interface for network operation
IEC 61968-4
Interface for records and asset management
IEC 61968-5
Interface standard for operational planning and optimization
IEC 61968-6
Interface for maintenance and construction
IEC 61968-7
Interface standard for network extension planning
IEC 61968-8
Interface for customer support
IEC 61968-9
Interface for meter reading and control
IEC 61968-11
CIM extensions for distribution
IEC 61968-13
CIM RDF model exchange format for distribution
IEC 61968-100
Implementation proﬁles
General Purpose (IEC61968-1)
The ﬁrst subpart of the IEC 61968 series is concerned with introducing the gen-
eral guidelines and interfaces architecture mostly applied in the context of a DMS
interacting with different enterprise systems [19].
Figure 3 illustrates a typical utility enterprise integration scenario where different
applications may exchange information and data by having IEC 61968 interfaces.
In such a scenario, the possibilities are numerous once applications with their own
generated data may support other applications in their decision-making processes by
transmitting such data on an event driven basis [19].
In addition, the standard explores technological concepts that can support the
implementation of the IEC 61968 standards, such as the Service-Oriented Archi-
tecture (SOA) and the Enterprise Bus Technologies (ESB) [19]. According to [17],
the SOA is deﬁned as a ﬂexible series of design principles to support integration and
message exchange between services running in different systems, typically operating
for different business functions. The author also explores the role of the ESB, which
is deﬁned as an abstraction layer to support inter-communication between distributed
systems and services implemented in the SOA.
Data Modeling (IEC 61968-11)
The eleventh sub part of the standard introduces an extension of the original base CIM
model (IEC 61970-301) to cover distribution networks data modeling. The new
features introduces nine additional UML packages with new classes, attributes, and
associations [17].

158
A. R. Albertini et al.
Interfaces to businesses (IEC 61968-3 to IEC 61968-9)
Sub parts three through nine introduces implementation interfaces to the typical util-
ity enterprise systems. Such interoperability is essential to support reliable operations
in the utility distribution context [19].
DERMS implementation (IEC 61968-5)
Sub part ﬁfth [21] is specially important for the future of distribution operations once
it develops the scope and guidelines required for successfully integrating DERMS
functions in the enterprise context. The scope of this sub part is limited to the DMS-
to-DERMS level of integration.
In addition, the standard [21] develops the idea that a DERMS will be respon-
sible for managing groups of DERs, complying with one of the main requirements
established in the IEEE standard 2030.11, which is the aggregation, simpliﬁcation,
optimization, and translation of complex scenarios existent on individual DER man-
agement to a more generalized approach. To support such concept, the IEC 61968-5
establishes its main set of rules and message exchange with the DERMS system
on the creation, management, forecasting, capability discovery, connection, dis-
connection, dispatch, and status monitoring of DER groups. The use case covered
by IEC 61968-5 for managing a DER group can be summarized on the following use
categories:
• Creation: ways to manage, coordinate, and introduce existing DER in an aggre-
gated manner;
• Maintenance: capable of introduce, remove,and manage DER within an existent
DER group;
• Deletion: delete DER groups;
• Status monitoring: capable of determining and quantifying the operational status
of a DER within a group;
• Forecast: capable of determining and predicting the future capabilities and/or
status of DER;
• Dispatch: capable of requiring
DER capabilities of a group of
DERs to be
dispatched to the grid;
• Voltage ramp rate control: capable of requiring a DER group to follow a ramp
rate scenario;
• Connect/disconnect: capable of requiring individual DER either to disconnect
or connect to the grid;
In terms of systems architecture, a DERMS has no mandatory deﬁnition on how
or where it must be deployed within the enterprise network. Depending on vendors,
or utilities choices, it might be a subsystem within an ADMS solution, hosted by
an aggregator in a cloud infrastructure, or as a local DERMS [21]. Some of the
conﬁgurations can be found in Fig. 3.
The [21] standard also explores DER enterprise integration use cases in terms
of exemplifying the message exchange between two entities during the process of

Distributed Energy Resources Management Systems (DERMS)
159
Fig. 5 Flowchart
representing the Create
DERGroup from the
requester’s point of view
identifying or managing DER groups. Figure 5 presents a ﬂowchart where the inter-
action and message exchange between two entities exempliﬁes the creation of a DER
Group within the DERMS.
Common Integration Technologies (IEC 61968-100)
The following sub part of the IEC 61968 standard concerns with deﬁnition of imple-
mentation proﬁles and technologies often used for enterprise integration. The main
objective is to provide sufﬁcient and detailed information to support the imple-
mentation of IEC 61968 compliant infrastructure, in addition to the description of
integration patterns and methodologies supported by current and future integration
technologies [17, 20].
3.2
DERMS-to-DER Level
DERMS may also be deﬁned as protocol gateway and translator enabling commu-
nication with DERs at ﬁeld. There are several initiatives driven by the industry in
order to establish and maturate such concepts in the power systems industry.

160
A. R. Albertini et al.
3.2.1
Communication Protocols
In regards to communication protocols operating in the DERMS-to-DER level, [13]
introduces a list of common DER protocols that may be supported by the DERMS
solution. The protocol utilized will be normally speciﬁed by the power systems oper-
ator. Additional protocols, including proprietary ones, might be allowed under the
agreement with the power system operator. Usually, communication standards in the
utility context utilize the Open System Interconnection (OSI) Model to determine
the interface layers for the protocol. The OSI is described by seven different layers,
which are: physical, data link, network, transport, session, presentation, and appli-
cation. Typically, different standards may be implemented on a different subset of
such layers [22].
IEEE Std 1815-2012 (DNP3)
DNP3 protocol is one of the most used communication standards by North Amer-
ican utilities. It has been used mostly in the context of power systems monitoring
and control, enabling communications between master station with Remote Termi-
nal Units (RTUs) and Intelligent Electronic Devices (IEDs). DNP3 originally did
not support security features, which were later introduced with DNP3 SA (Secure
Authentication) as part of the IEC 62351-1 standard. DNP3 Secure Authentication is
characterized by an additional security layer introduced in the data package between
the pseud-transport and application layers within the DNP3 message [23].
IEEE Std 2030.5-2018
The IEEE 2030.5-2018 standard has been established and led by the utilization of
the Smart Energy Proﬁle (SEP) protocol. It has been originally driven by the ZigBee
and HomePlug Power Alliances. The protocol implementation is based in the OSI
model and it is implemented in the application layer. IEEE 2030.5 is one of the most
important standards designed for DERMS and DER related applications due to the
extensive support for grid support devices such as ESS, home appliances, EMS
applications, DR, and smart meters [22].
OpenADR
The protocol has been originally designed by the Lawrence Berkeley National Lab-
oratory (LBNL) since 2002 as an incentive from the California Energy Commis-
sion [24], and it is implemented in the application layer based in the OSI Model.
One of the main objectives behind its implementation is to support dynamic pricing
for energy markets specially in the context of DR transactions. OpenADR allows
two way internet protocol communication between electricity providers and DR
users as a way to report price signals and DR events [22].

Distributed Energy Resources Management Systems (DERMS)
161
Sunspec Modbus
Modbus was originally designed by a company called Modicon in 1979, and it was
intended to support communication between master and outstation devices. In 2009,
SunSpec Alliance did upgrade the protocol by enhancing the original Modbus with an
interoperability interface to support communication with DER, then generating the
SunSpec Modbus protocol. The new interface allows backwards compatibility with
the original Modbus implementation, and supports communication with different
types of inverters and DERs [23].
4
DERMS Pilot Projects
The applicability of DERMS in real-world implementations is already being inves-
tigated. The expected development of DERMS technology incentives several pilot
projects that analysed different characteristics involved in the implementation of
these solutions. Over 20 pioneer initiatives have been identiﬁed in three countries,
being United States of America (USA), Canada and Australia, contributing with valu-
able insights for technology development to handle emerging issues in their power
grids. From the analysis of their ﬁnal reports and lessons learned, it is possible to
discuss the current state of the technology, as well as the development challenges
and expectations for future projects. The investigation of the projects was based on
their reports and information available in public sources, which may not gather the
full set of examined functionalities [25].
4.1
United States of America
DER deployment in the USA is rapidly advancing, driven by PV technology and
boosted by USA Federal Energy Regulatory Comission (FERC) Order 2222, which
allowed participation of DER in the wholesale market through aggregators. The
evolution naturally called for the development of DERMS pilots to mitigate the
imposedDER.Insomeotherregions,despiteoflowpenetrationrates,utilitiesalready
foster ADMS/DERMS research and system adaptation as preventive measures for
future grid development. Multiple utilities already concluded the proof of concept
phase with successful results and are moving on to the implementation stage, leading
these researches in partnership with national laboratories and universities.
Projects vary in location, application and managed DER capacity, reaching levels
up to 100 MW [26]. A common goal was to enable higher DER penetration while
mitigating their negative impacts and capturing expanded value with the delivery
of distributed grid services. Real-time and grid support functionalities most often
applied were constraint management, resource visualization and voltage support.

162
A. R. Albertini et al.
The U.S. Department of Energy (DOE) ENERGISE program funded 12 DER inte-
gration projects and research with over US$26 million in 2017 [27]. Ten DERMS
pilots projects from different utilities were identiﬁed in the USA (Tables 3 and 4).
4.2
Canada
Similar trends are happening in Canada in terms of DER integration when com-
pared to the USA scenario. The country considers DERs as important and strategical
technologies contributing to renewable transition and grid modernization. PV-DER
systems are popular in Canada following their trend of cost reduction and facili-
tated integration, indicating the need for novel asset management technologies [28].
Moreover, there is a large adoption of smart grid deployment over the country, which
contributes to provide the infrastructure required for grid modernization currently
reaching almost 70 thousand EV, 8708 charging stations and 84% of metering infras-
tructureclassiﬁedassmartmeters[29].Aspartofthenationalplanstoprovidecleaner
and sustainable energy growth, utility-led initiatives are currently in progress target-
ing better asset utilization with demand fulﬁllment. One example is the Smart Grid
Program, supported by the Government of Canada, promoting the development of
pilot projects and demonstration of smart grid technologies. Some of these are listed
on Table 5. Other projects are related in Table 6 [25]. The following Canadian projects
are categorized as DERMS initiatives and they were intentionally selected to exem-
plify scenarios of DERMS implementation ranging from small to large dimensions.
4.3
Australia
The Australian state-owned utility Horizon Power implemented an innovative system
able to forecast the output of non-managed DER, optimize utility and BTM assets,
customer-owned DER in tandem with a centralized gas-ﬁred generator. With the
largest service area in the world and the lowest customer density, Horizon Power’s
focus with a DERMS program is to enable higher renewable DER capacity while
dealing with their concurring penetration issues. The utility wanted to ensure its
customers were not limited by reliability concerns in their ability to install rooftop
solar panels or batteries.
In partnership with PXiSE Energy Solutions, the utility implemented a microgrid
controller and DERMS to manage the 11 MW microgrid serving a 4 MW peak load
in the city of Onslow, setting the stage to integrate hundreds of solar PV panels and
batteries to expand the utility’s DER hosting capability. The implemented allowed
the integration of a 1 MW solar PV array with two 1 MWh batteries connected at the
Horizon Power substation. As for customer-owned assets, it allowed for 2.1 MW PV
from over 260 houses, 500 kWh of ESS, including 2.5 kW/10 kWh smoothing sys-
tems, and the opportunity for additional 200 kW of customer-owned DER assets.

Distributed Energy Resources Management Systems (DERMS)
163
Table 3 Characteristics of selected DERMS pilot projects reviewed in the USA
Selected DERMS projects in the USA
Project: utility
Partners
DER assets
Goals
Use cases
Austin Energy:
SHINES
Austin, TX
(2017–2019)
Doosan
GridTech
3.0 MW PV
3.2 MW ESS
Balancing DER dispatch for grid and economic opti-
mization; Voltage Support; Peak load reduction; Con-
gestion management; Day-ahead Arbitrage
Study the technical and economic feasibility of dis-
patchable RES, ESS, aggregated DR and vehicle-to-grid
NCE: Distribution
Operator Pilot
North Carolina
(2017–2022)
Duke
Energy;
OATI; GE;
OSI
111 MW PV
6.63 MW ESS
15.8 MW CVR
2.20 MW Thermostat
0.23 MW Boiler
19.0 MW COG
10.5 MW Load
Activate, monitor and adjust customer assets, as invert-
ers, energy storage, smart thermostats; control emer-
gency operations; incentivize DR and DER programs
Demonstrate operational capability to instruct emer-
gency operations using DER curtailment and DR; Ensur-
ing proper data sharing for event post-
analysis and event proper communication protocol
PG&E: DER
Demonstration
San Jose, CA
(2015–2018)
GE; Tesla;
ENGIE
3.35 MW PV
6.86 MW ESS
Using DERs for grid services and market participa-
tion; Capacity and voltage constraint manage-
ment; Economic resource dispatch; Situational aware-
ness; Operational ﬂexibility
EvaluateDERMSabilitytocoordinateDERsforgridser-
vices,as capacity and voltage support; Clar-
ify DERMS requirements and deployment barriers
SMUD: DER
Flexibility
Sacramento, CA
(2018–2021)
OSI
2.25 kW PV
11.7 kWh ESS
(per household)
Load shifting; Aggregated ﬂeet operation; Uninterrupt-
ible power source; Power quality; PV ﬁrming and regu-
lation
Fleet control of ten house-
holds to test DERs as a way to shift load and pro-
vide grid beneﬁts
SCE: Preferred
Resources
Orange County, CA
(2013–2022)
Clean
Coalition
37 MW Efﬁciency
53.4 MW ESS
43.54 MW DR
65.78 MW DG
(Expected by 2022)
Investigate advanced DER management to defer invest-
ments on new power plants while matching increas-
ing customer demand
Energy Efﬁciency; Load Shifting; Procuring DERs; Esti-
mating PV capacity for grid analysis; Develop-
ing DERMS compatible with DER technology
SCE: EASE
Santa Ana, CA
(2017–2021)
SCE;
NREL;
Smarter
Grid
Solutions
Demo use-cases with
10.000 simulated
DERs;
Field case with
over 100 DER units
Advanced DER management to increase hosting capac-
ity; Automated DER registration; Platform to man-
age DER in the delivery of grid services; Implement-
ing IEEE 2030.5 and DNP3 protocols
Communicate and optimize the dis-
patch of DERs through price signals; Real-time ther-
mal constraint management; Self-
provisioned DERs; Substation net load manage-
ment; Voltage management; co-optimization of DER ser-
vices to utility and independent operators

164
A. R. Albertini et al.
Table 4 Key lessons and challenges from selected DERMS pilot projects reviewed in the USA
Selected DERMS projects in the USA
Project: utility
Key lessons
Key challenges
Austin Energy:
SHINES
Austin, TX
(2017–2019)
Summer peak load reduced by 110MW through load control; BTM load con-
trol with rooftop PV resulted in greater economy; Deployment of emerg-
ing technologies involves safety uncertainties; Current pro-
cesses are not at speed with the technology emergence
Current DER communication and integration poses non-trivial risks to wide-
scale deployment; Controlled DERs presented difﬁculties in optimal man-
agement of multiple use cases and interfacing with commercial sys-
tems; Proper system design is highly dependent on application and loca-
tion on the grid; Building permits are not keeping pace with DER technology
NCE: Distribution
Operator Pilot
North Carolina
(2017–2022)
DERMS have are crucial for automating and enhancing DER manage-
ment, including emergency events; Having a DERMS system for cen-
tral and simultaneous dispatch of DR and DER is key for a distribution oper-
ator and will continue to increase in scope, value, and impor-
tance as new devices and resources are added
Communication with ﬁeld devices; Technological integration with third-
party equipment; Data granularity resolution is important in historian soft-
wares; Lack of device integration into DERMS, requiring labor inten-
sive manual intervention to initiate some actions
PG&E: DER
Demonstration
San Jose, CA
(2015–2018)
Utility DERMS effectively mitigated voltage, capacity, and other con-
straints violations;DER grouping with shared characteristics were more
effective; DERMS may offer the capability needed to coordinate DER partic-
ipation in wholesale markets while avoiding accuracy of outputs ris-
ing from the increased DER participation in wholesale markets
Customer-acquisition challenges; Data quality and availability chal-
lenges; The complexity of the optimization for a least-cost economic dis-
patch considering the market structure created signiﬁcant computa-
tional challenges
SMUD: DER
Flexibility
Sacramento, CA
(2018–2021)
DER aggregation, visualization, load shifting and ﬂeet opera-
tion are the most applicable DERMS functions; A use-case prioritization pro-
cess might impact product value, which could inﬂuence customer interest
Challenges in integrating DERs into a DERMS platform, as well as for com-
municating with DERs; Difﬁcult to identify cost-effective pathways to man-
age integration and data exchange across the utility and third-
party DERMS platforms
SCE: Preferred
Resources
Orange County, CA
(2013–2022)
DERMS help to properly guide DER strategies; Risk-informed grid deci-
sions require forecasting variability; Acquir-
ing DERs to meet required resources matters more than prescribing a portfo-
lio mix; Customer programs accelerated project delivery; Competitive-
ness expands innovative and broader pool of resources
Challenges in communica-
tions between DERMS and DERs might be addressed using IEEE 2030.5 pro-
tocol
SCE: EASE
Santa Ana, CA
(2017–2021)
DERMS optimized local DER services considering self-
provisioned DERs and real-time thermal constraint management; Cost-
effective grid services through customer-owned DER are potential rev-
enue streams; IEEE 2030.5 and DNP3 protocols used for DER optimized dis-
patch through price signals
DER management; Grid services considering multiple constraints; Procur-
ing a motivational business model; Resources and DERMS platform commu-
nication and cyber-security; Short-term forecasting and multi-objective opti-
mizations

Distributed Energy Resources Management Systems (DERMS)
165
Table 5 Characteristics of selected DERMS pilot projects reviewed in Canada
Selected DERMS projects in Canada
Project: utility
Partners
DER assets
Goals
Use cases
EPCOR: Smart
Grid Project
Edmonton, AB
(2018–2022)
E.L. Smith;
Natural
Resources
Canada;
AB Innovates
12 MW PV
4 MW ESS
Reduce the peak load demand at a water treat-
ment plant; Enable effective use of the grid-
connected system to address capacity short-
falls in power system
Intelligent controls and monitoring capabili-
ties to optimize grid opera-
tion; Add resiliency to the E.L. Smith water treat-
ment plant; Reduce reliance on the electrical grid
EQUS: Rural
Smart Grid
Project,
AB
(2018–2022)
Rural
Electriﬁcation
Association;
AB Innovates
125 kW PV
3 EV Charger
2 Utility ESS
Advanced metering infrastructure deploy-
ment; Increase penetration of RES, EV charg-
ing stations and a ESS; Address chal-
lenges associated with serving rural cus-
tomers such as terrain, distance, accessibil-
ity and communications; Improve cus-
tomer engagement, aware-
ness and response times for repairs and out-
ages in rural areas
Verify emission offsets; Collect ﬁeld-data, moni-
tor and reconﬁgure the energy load pro-
ﬁle through DER dispatch in na ultra-
rural radio frequency meshed network
Bracebridge:
SPEEDIER
Parry Sound,
ON
(2018–2022)
Opus One
Solutions;
Lakeland
Holding;
Savage Data
Systems
500 kW PV
3.0 MW ESS
4 EV Chargers
50 Hot Water
Tanks (HWTs)
Facilitate the shift towards a carbon-
neutral smart community; Model and inte-
grate diverse DERs and a DERMS to bal-
ance energy consump-
tion and DER power; Develop vir-
tual net metering data infrastruc-
ture to allow a recompensation system
Increase visibility and control of loads and vari-
able RES generation and ESS; Improved reliabil-
ity and resiliency using grid monitor-
ing and automation in feeder level micro-
grid; Automatic response to a variety of out-
age scenarios

166
A. R. Albertini et al.
Key enablers for that system optimization were real-time data from distribution grid,
weather and customer-owned DER.
The DERMS multi-objective optimization includes goals, such as reliability, eco-
nomic dispatch, maximum renewable energy integration and lower emission rates.
By using advanced metering infrastructure’s real-time data added to historical infor-
mation, DER outputs and grid demands are forecasted for the next 24 h to validate
real-time decisions, optimizing DER schedules every ﬁve minutes. As a major lesson
from the pilot, the utility indicate the relevance of cybersecurity in relation to these
integrated platforms. Horizon Power used IEEE 2030.5 protocol to enable secure
communication to any DER asset with Ethernet gateways through connections sim-
ilar to online banking transactions [30].
4.4
Pilot Projects Discussion
The reviewed projects indicates that a DERMS can mitigate foreseen overloads and
reverse power ﬂows by rescheduling an dangerous into an optimized DER dispatch,
enhancing real-time operations and grid services provision. Reactive power dispatch
was able to mitigate voltage issues better than with active power. The method of
asset aggregation was relevant, as grouping DERs with shared characteristics facil-
itated multi-objective optimizations. However, granularity of the problem may lead
to complex scenarios, especially when including market participation [31].
Utilities with moderate to higher DER rates might rapidly beneﬁt from these
systems, while those with lower levels may use them to prepare and avoid expansive
retroﬁts in the future. Table 6 summarizes the investigated pilot projects. Basic and
visualization functions were commonly applied in the projects. Many of them also
covered forecasting and optimization of DER, ESS and controllable loads. Weather
status monitoring was often incorporated within local distribution system platforms
and not applied into the DERMS. The most commonly supported grid services in
the pilots were load shaping and shifting and voltage support [25].
All pilot projects faced challenges with communication and cybersecurity. A poor
communication infrastructure may lead to use of inaccurate data, unreliable asset
management, vulnerabilities and challenging project up scaling. Incompatible DERs
protocols make their interoperability challenging and requires great effort from the
utilities engineers to set up the technology. Several utilities implemented resource
communications via the IEEE 2030.5 server protocol in their pilot projects, as it
may provide a more secure and accurate methodology for the control of a large DER
portfolio.
To support a faster development of large-scale DERMS, enhanced software and
regulatory interfaces must be developed to facilitate prosumer and resources inte-
gration to DERMS programs via automated platforms. DERMS development could
beneﬁt next from more secure and stable communications both at Device and DER-
Group levels [32]. Pioneer Australian utility Horizon Power also experimented with
Blockchain technology to improve DER communication security. Future DERs must

Distributed Energy Resources Management Systems (DERMS)
167
Table 6 Coverage of IEEE standard 2030.11 functions in analyzed DERMS projects. Numbers correspond to following functions: 1-DER Information;
2-Monitoring; 3-Operation; 4-Weather Monitoring; 5-Optimization and Allocation; 6- Forecasting; 7- Fleet and Outage Management; 8-Visualization;
9-Settlements; 10-Business Rules; 11-Historian; 12-Energy Delivery; 13-Load Shaping and Shifting; 14-Ramping Reserve Capacity; 15-Constraint Man-
agement; 16-Cold Load Pick-up; 17-Frequency Control and Response; 18-Black Start; 19-Resilience; 20-Voltage Support. Source: Adapted from [25]
DERMS IEEE 2030.11 Functional Speciﬁcations
Project utility
Region
DER assets
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
AUS
Onslow DER
Horizon Power
PIL
PV, ESS
x
x
x
x
x
x
x
x
x
x
x
x
UNITED STATES
OF AMERICA
Distribution Operator Pilot
North Carolina Electric
NC
PV, ESS, DR, CVR,
Smart Thermostats
and Heaters, COG,
Load Control
x
x
x
x
x
x
x
x
x
x
x
x
x
SHINES
Austin Energy
TX
PV, ESS,
Smart Inverter
x
x
x
x
x
x
x
x
x
x
x
x
x
ENERGISE
Southern California Edison
CA
PV, ESS
x
x
x
x
x
x
x
x
x
Distributed System Plan
Consolidated Edison
NY
PV, ESS,
Smart Inverter
x
x
x
x
x
x
x
x
x
x
Paciﬁc Gas
and Electric
CA
PV, ESS,
Load Control
x
x
x
x
x
x
x
x
x
x
x
x
x
x
x
Sacramento Municipal
Utility District
CA
PV, ESS
x
x
x
x
x
x
x
x
x
x
Solar Partner Program
Arizona Public Service
AZ
PV, ESS,
Smart Inverter
x
x
x
x
x
x
x
x
x
Seven States
Power Corporation
TN,AL,
GA
PV, ESS, DR, EV,
Diesel Generators,
Water Heaters,
Smart Thermostats
x
x
x
x
x
x
x
x
x
x
Keystone Solar Future
PPL Electric
PA
PV, Smart Inverter,
Load Control
x
x
x
x
x
x
x
x
x
x
x
x
x
SHINES
Hawaiian Electric
HI
PV, ESS, DR, EV
x
x
x
x
x
x
x
x
x
x
x
(continued)

168
A. R. Albertini et al.
Table 6 (continued)
DERMS IEEE 2030.11 Functional Speciﬁcations
Project utility
Region
DER assets
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
CANADA
Power.House Hybrid
Alectra Utilities
ON
PV, EV, micro-CHP,
Smart Thermostats
x
x
x
x
x
x
x
x
x
x
x
Integrated Resource Net-
work
Saint John Energy
NB
ESS, Thermal Stor-
age,
Load Control
x
x
x
x
x
x
x
x
x
x
x
x
Collaborative Grid Inno-
vation
NB Power and NS Power
NS,NB
PV, ESS, EV,
Load Control
x
x
x
x
x
x
x
x
x
x
x
Slemon Park Microgrid
PEI Energy
PEI
PV, ESS
x
x
x
x
x
x
x
x
Gridexchange
Alectra Utilities
ON
Not speciﬁed
x
x
x
x
x
x
x
x
x
x
x
Residential DR Program
Yukon Energy
YK
Not speciﬁed
x
x
x
x
x
x
x
West 5 Smart Grid
London Hydro
ON
ESS, EV,
Micro-generation
Smart Thermostats
x
x
x
x
x
x
x
x
x
x
x
x
x
x
Smart Grid System
EPCOR
AB
PV, ESS
x
x
x
x
x
x
x
x
Rural Smart Grid Project
Equs REA
AB
ESS, EV
x
x
x
x
x
x
x
x
x
x
x
x
SPEEDIER Project
Bracebridge Generation
ON
PV, ESS,
EV, Smart Meters
x
x
x
x
x
x
x
x
x
x
x
x

Distributed Energy Resources Management Systems (DERMS)
169
innately incorporate standard IEEE 1547 to facilitate platform compatibility. Critical
features related to power system protection and islanding, such as outage manage-
ment, cold-load pickup and black start, are likely to advance as secure, reliable and
rapid data exchange with distribution system platforms consolidates. Finally, the
study of a cost-effective business model with ﬁnancial motivation for DER partici-
pation is encouraged and might beneﬁt from the development of modular solutions
that facilitate implementation and deployment.
The characteristics of reviewed projects serve as an opportunity analysis of smart
grid development in other regions. North Carolina Electric (NCE)’s pilot project
shows how large metropolitan regions can start their integration of smart grids with
higher DER penetration when managed by a DERMS platform. The pioneer Aus-
tralian case is as an example of how remote communities, with low access to stable
and high quality power connections, may beneﬁt from expanding distributed gener-
ation locally.
Additionally, Hawaiian example of DERMS implementation ﬁts in regions where
many island communities are still powered by local generators. When transitioning to
renewable DERs, they will ﬁnd the need to develop advanced distribution automation
and management to optimize their future grids. DERMS development can beneﬁt
from the opportunity to deploy sustainable DER technology in low electriﬁed areas,
such as remote locations in Latin America, Asia Paciﬁc and Africa, at which hybrid
powered grids with PV panels, diesel generator and batteries might be the solution
with greater economic merit when compared to exclusively fossil fueled for rural
areas [33]. DERMS might help by efﬁciently managing smart hybrid renewable-
battery-fossil microgrids and improving feasibility of 100% renewable grids.
Giants at the Asia Paciﬁc, as India and Indonesia, have ambitious goals for renew-
able technologies. DER management approaches might help in their strategies and
support policies to broaden renewable deployment. The distributed PV is trending in
Southeast Asia, where countries are dealing with increasing electricity demand and
the popular desire for sustainable growth. Despite the barriers, there is a signiﬁcant
customer interest in the Philippines, Thailand, and Vietnam to adopt distributed PV,
which will lead to DER projects that must beneﬁt from the previous experience and
must also give valuable lessons for other regions [34].
5
Conclusion
DERs are one of the critical elements to support the signiﬁcant transformation experi-
enced in the electrical sector. Academic research and industrial experience has been
acknowledging the intrinsic harmful impacts of the widespread adoption of such
resources without proper management and control technologies. The DERMS con-
cept has been gaining attention from the industry and research as a tool to mitigate
the existent gaps in terms of DER simpliﬁcation, aggregation, optimization, and
translation. There are currently also signiﬁcant efforts to develop and standardize

170
A. R. Albertini et al.
protocols, functional guides, and communication requirements to facilitate DERMS
integration to different systems, and vendors.
The bibliography and analysis on current DERMS proof of concepts around the
world have shown that several projects and DERMS implementations are already able
to deliver grid services. Pilot projects are advancing towards more complex use cases,
including larger grids and market signals. However, still lack important use cases,
such as those regarding fault management and grid resilience. The lessons learned
show very frequent challenges with stable and secure communication between DERs
assets and DERMS platform, which may be the barrier to these functionalities devel-
opment. Technology development may proﬁt from guidelines and standardization
to drive modular solutions, ensuring compatibility among future technologies and
their communication capabilities. Increased microgrid deployment worldwide corre-
latedwithnewmodularsolutionsthatfacilitatedend-userimplementationwithoutthe
need of fully understanding the technology. A similar trend might happen to DERMS
accompanying the DER development. Challenges faced by utilities regarding tech-
nology incompatibilities and lack of plug and play interface will hinder in modular
approaches.
References
1. IRENA (2019) Innovation landscape for a renewable-powered future: Solutions to integrate
variable renewables. Technical report Abu Dhabi: international renewable energy agency
2. Veda S et al (2017) Developing use cases for the evaluation of ADMS applications to accelerate
technology adoption. In: 2017 ninth annual ieee green technologies conference (GreenTech).
https://doi.org/10.1109/GreenTech.2017.25
3. Driesen J, Katiraei F (2008) Design for distributed energy resources. IEEE Power Energy
Mag 6(3):30–40. https://doi.org/10.1109/MPE.2008.918703
4. Wang J, Chen C, Xiaonan L (2015) Guidelines for implementing advanced distribution man-
agement systems-requirements for DMS integration with DERMS and microgrids. Technical
report Argonne National Laboratory (ANL)
5. Sajadi A et al (2018) Integration of renewable energy systems and challenges for dynamics,
control, and automation of electrical power systems. Wiley Interdiscip Rev Energy Environ
8(1)
6. Strezoski L, Stefani I (2021) Utility DERMS for active management of emerging distribution
grids with high penetration of renewable DERs. Electronics 10(16). issn: 2079-9292. https://
doi.org/10.3390/electronics10162027. https://www.mdpi.com/2079-9292/10/16/2027
7. Stetz T, Rekinger M, Theologitis I (2014) Transition from uni-directional to bi-directional
distribution grid: management summary of IEA task 14 subtask 2-recommendations based
on global experience. IEA PVPS Program Rep, p 2014
8. U.S. Department of Energy (2017) Modern distribution grid - volume II: advanced technology
maturity assessment. Version 1.1
9. AnayaKL,PollittMG(2021)Theroleofregulatorsinpromotingtheprocurementofﬂexibility
serviceswithintheelectricitydistributionsystem:asurveyofsevenleadingcountries.Energies
14(14). issn: 1996-1073. https://doi.org/10.3390/en14144073. https://www.mdpi.com/1996-
1073/14/14/4073
10. Reilly J, Joos G (2019) Integration and aggregation of distributed energy resources - operating
approaches, standards and guidelines. CIRED 2019 (Madrid, Spain). AIM

Distributed Energy Resources Management Systems (DERMS)
171
11. Enbala (2018) Creating a 21st century utility grid with DERMS and VPPs. Technical report
energy efﬁciency markets
12. Evoenergy (2021) DER integration and automation project. Technical report Evoenergy and
Schneider Electric and GreenSync and Withwyndle. https://arena.gov.au/assets/2021/08/der-
integration-andautomation-project-report.pdf
13. IEEE (2021) IEEE guide for distributed energy resources management systems (DERMS)
functionalspeciﬁcation.IEEEStd2030.11-2021,pp1–61.https://doi.org/10.1109/IEEESTD.
2021.9447316
14. Brian Seal, Renjit A, Deaver B (2018) Understanding DERMS. Electric power research insti-
tute, Technical report 3002013049
15. Parra I, Rodríguez A, Arroyo-Figueroa G (2014) Electric utility enterprise architecture to
support the Smart Grid- Enterprise architecture for the Smart Grid. In: 2014 11th international
conference on informatics in control, automation and robotics (ICINCO), vol. 02. https://doi.
org/10.5220/0005014006730679
16. Giroti T (2009) Integration roadmap for smart grid: from accidental architecture to smart grid
architecture. In: Proceedings of the grid-Interop 2009. http://www.pointview.com/data/ﬁles/
3/2185/1396.pdf
17. Uslar M et al (2012) The common information model CIM: IEC 61968/61970 and 62325 - A
practical introduction to the CIM. In: Power systems 66. issn: 16121287. https://doi.org/10.
1007/978-3-642-25215-0
18. EPRI, Common information model primer eighth edition
19. International Electrotechnical Commission (2022) IEC 61968-1:2020. Technical report IEC,
p 214
20. International Electrotechnical Commission (2022) IEC 61968-100:2022. Technical report
IEC, p 498
21. International Electrotechnical Commission (2022) IEC 61968-5:2020. Technical report IEC,
p 99
22. Obi M, Slay T, Bass R (2020) Distributed energy resource aggregation using customer-owned
equipment: a review of literature and standards. Energy Rep 6:2358–2369
23. Chan K, Kim Y, Jo J-Y (2022) DER communication networks and their security issues. In:
2022 IEEE 12th annual computing and communication workshop and conference (CCWC).
IEEE, pp 0785–0790
24. Koch E, Ann Piette M (2008) Architecture concepts and technical issues for an open, inter-
operable automated demand response infrastructure. Technical report Lawrence Berkeley
National Laboratory
25. Albertini A et al (2022) An overview of distributed energy resources management system
guidelines and functional coverage. In: 2022 ieee international conference on power electron-
ics, smart grid, and renewable energy (PESGRE). https://doi.org/10.1109/PESGRE52268.
2022.9715935
26. NC Electric and Duke Energy (2020) North Carolina electric membership corporation/ duke
energy distribution opeartor pilot project ﬁnal report. Technical report Accessed: 2021-06-29.
North Carolina Electric Membership Corporation
27. U.S. Department of Energy (2017) Enabling extreme real-time grid integration of solar energy
(ENERGISE). Technical report Accessed: 2021-07-13. https://www.energy.gov/eere/solar/
enabling-extreme-realtime-grid-integration-solar-energy-energise
28. Doluweera G et al (2020) Opportunities and challenges for distributed electricity generation
in Canada. Technical report Accessed: 2021-07-05. Canadian Energy Research Institute
29. MaRS Cleantech (2018) Market information report: Canada - prepared for power forward
challenge. Technical report Accessed: 2021-07-08. Advanced Energy Centre. https://
www.marsdd.com/wp-content/uploads/2019/01/AEC%5C_MARKET-INFORMATION-
REPORT%5C_CANADA%5C_2018%5C_F.pdf
30. Asmus P, Kelly M (2021) Horizon power: a case study on integrating customer DER. Technical
report, PXiSE Energy Solutions

172
A. R. Albertini et al.
31. Ardani KB, O’Shaughnessy EJ, Schwabe PD (2018) Coordinating distributed energy
resources for grid services: a case study of paciﬁc gas and electric. Technical report National
Renewable Energy Laboratories (NREL)
32. Cook JJ et al (2018) Expanding PV value: lessons learned from utility-led DER aggregation
in the United States. Technical report National Renewable Energy Laboratories (NREL)
33. Ayodele E et al (2019) Hybrid microgrid for microﬁnance institutions in rural areas - a ﬁeld
demonstration in West Africa. Sustain Energy Technol Assess 35:89–97
34. Junlakarn S et al (2021) A cross-country comparison of compensation mechanisms for dis-
tributed photovoltaics in the Philippines, Thailand, and Vietnam. In: Renewable and sustain-
able energy reviews, p 110820

Virtual Power Plants for Smart Grids
Containing Renewable Energy
Seyed Iman Taheri, Daniela Wolter Ferreira Touma,
and Mauricio Barbosa Camargo de Salles
Abstract This chapter aims to present the optimal models of a VPP and the chal-
lenges and solutions to its implementation. First, it provides an introduction to appli-
cations of a VPP in Smart Grids and describes the deﬁnition and components of a
VPP by using examples from the real world. Then, it presents the other applications
of VPPs in using EVs and in power system security to cover different applications
of a VPP. Next, it includes a brief review of optimization and scheduling problems
faced by VPPs participating in electricity markets. Finally, it targets the application
of a VPP in transportation systems, including electric vehicles. The chapter con-
cludes with the presented contents and possible future research in this ﬁeld of study
by clarifying the book’s scope in smart grids and renewable energy.
1
Introduction
A Virtual Power Plant (VPP) is a technical, economic, and practical structure that
interconnects Distributed Energy Resources (DERs), microgrids, energy storage sys-
tems (ESS), and electric vehicles (EVs) of an electrical power system within a smart
grid.Hence,aVPPinthesmartgridsmayimproveDERsinallaspects,suchasrenew-
able energy (RE) technologies, ﬁnancial-economic, and power quality. However, the
main application of a VPP is in the Electricity Market. Therefore, this chapter pre-
pares the optimal models of a VPP that can be applied in different electricity markets,
including a day-ahead, intra-a-day, and real-time electricity market.
S. I. Taheri
The University of Memphis, Memphis, TN 38152, USA
e-mail: s.taheri@memphis.edu
D. Wolter Ferreira Touma
University of South Alabama, Mobile, AL 36688, USA
e-mail: dtouma@southalabama.edu
M. B. C. de Salles (B)
University of Sao Paulo, Sao Paulo, Brazil
e-mail: mausalles@usp.br
© The Author(s), under exclusive license to Springer Nature Switzerland AG 2024
A. J. Sguarezi Filho et al. (eds.), Smart Grids—Renewable Energy, Power Electronics,
Signal Processing and Communication Systems Applications, Green Energy
and Technology, https://doi.org/10.1007/978-3-031-37909-3_6
173

174
S. I. Taheri et al.
1.1
Overview of Smart Grids and Deﬁnition and Types
of VPP
As the population and economy grow, big houses with more intensive use of elec-
tricity, EVs, and more technology are increasing the peak demand for electricity.
The last report from the International Energy Agency1 [1] projected 230 million
EVs in the global ﬂeet (excluding two- and three-wheeled electric vehicles) by 2030,
depending on government efforts to meet international energy and climate goals.
Similarly, the sixth and ﬁnal report in the Electriﬁcation Futures Study (EFS) series
from the National Renewable Energy Laboratory (NREL)2 [26] presented the oper-
ational analysis of high electriﬁcation scenarios, including detailed grid simulations
of future power systems and electricity demand in the year 2050. This study found
that modest economic and population growth could increase the demand for elec-
tricity by 29%. Under a higher electriﬁcation scenario, in which EVs do 76% of total
vehicle miles traveled in 2050, the increase in electricity demand would reach 81%
in 2050 compared to 2018.
To prepare for the increased demand for electrical energy, the electrical power
industry is moving towards encouraging more sustainable use of renewable energy
and decentralized systems forming Smart Grids. Smart Grids combine the exist-
ing Power System with communication technology and decentralized industrial or
residential Microgrids (MGs) and/or VPPs [2, 3]. Microgrids, as well as VPPs, man-
age DERs along with ESSs at the distribution level integrating them into the Power
System, but they have a few differences [4].
A Microgrid is a localized self-sufﬁcient Power System (usually a particular loca-
tion, such as an island or a community) where the load is connected to small gen-
erators that can connect (grid-tie mode) or disconnect (island mode) from a low or
medium voltage distribution system [5, 6]. Thus, MGs require the use of ESSs, smart
inverters, and switches, and it has lower power capacity. On the other hand, VPPs
can combine multiple resources from any part of the grid through a virtual energy
network controlled by a dedicated center. Thus, it is always connected to the grid
and can command higher capacity. Therefore, VPPs are always in grid-tie form and
can operate without ESSs, but they cannot operate without the grid and require smart
metering and information technology [4].
A VPP doesn’t generate or own energy assets. It only behaves as a single entity
guaranteeing reliable power all the time by aggregating all the power coming from
different sources and disparate locations [4]. More speciﬁcally, a VPP connects and
manages several DERs, allowing the system operator to control other distributed
elements, which may be:
• Renewable energy, such as Wind Turbines (WT), Photovoltaic (PV), Hydroelectric
Power (HP), and others
1 Available online at https://www.iea.org/reports/global-ev-outlook-2021.
2 Available online report: https://www.nrel.gov/docs/fy21osti/79094.pdf.

Virtual Power Plants for Smart Grids Containing Renewable Energy
175
Fig. 1 A virtual power plant structure
• Conventional energy resources - such as combined heat and power plants (CHPs),
ESS, Plug-in hybrid electric vehicles (PHEV), and Flexible Load Demand (LD),
can be residential, commercial, or industrial, among others.
Therefore, it has an Energy Management System (EMS) that gathers technical and
economic information on the distributed elements available in the VPP. This infor-
mation is used in the operation of the VPP. Figure 1 shows the structure of a VPP
with possible distributed elements connected. The EMS of the VPP must have a
dynamic decision-making process integrating the real-time information among the
VPP’s elements, facilitating decentralization, improving the power ﬂow from each
source available, and acting in the power market as a single virtual unit system.
A VPP may be classiﬁed according to its control approaches, objectives, or market
segment. When considering its control approach, a VPP may be classiﬁed as:
Centralized Controlled VPP: All its original uncoordinated low-capacity
DERs communicate only with a central VPP without communicating with each
other. Figure 1 shows an example of a Centralized Controlled VPP. This conﬁg-
uration gives ultimate control to the VPP to integrate and schedule its DERs in
an optimized way converting its DERs into a large-scale generation alliance.
It may be formulated into mixed integer non-linear programming (MINLP)
or mixed integer linear programming (MILP) and use different optimization

176
S. I. Taheri et al.
techniques such as genetic algorithm (GA) or particle swarm optimization
(PSO). However, since all control is centralized in the VPP, the wide number
of variables to be considered makes its optimization procedure difﬁcult and
costly. Moreover, the communication network highly depends on exchanging
information [7].
Distributed Controlled VPP: It is divided into two independent levels of con-
trol with local lower hierarchical level stakeholders coordinating and supervis-
ing a small amount of DERs while decisions are taken at a higher hierarchical
VPP. This structure simpliﬁes the responsibility and communication of the
lower-level subsystems since each can focus on maximizing their individ-
ual proﬁt by scheduling regional energy resources while the VPP exchanges
information between the multiple subsystems. This structure relieves the mas-
sive calculation burden of several decision variables and avoids the market
monopoly in the Centralized Controlled VPP. However, since there is no cen-
tralized optimization, each local selﬁsh subsystem may contradict, increasing
the management computation of the higher level VPP. Different alternatives,
such as Game theory, distributed calculation algorithms, and communication
matrix, among others, may support its coordination with distinct advantages
and disadvantages [7].
Comprehensive Controlled VPP: Also known as Central-Distributed Con-
trolled VPP, it combines the Centralized Controlled VPP and the Distributed
Controlled VPP. It has two levels, with the sub-control agents in the lower level
interconnected among each other through the VPP control center. Each sub-
control agent on level II optimizes the scheduling of its regional DERs with
close coordination with the central level I control that coordinates the bidding
strategy of each level II agent for market participation. This structure reduces
the computational burden of the Central Controlled VPP as the central level
I shares its optimization with the local level II. And it mitigates the chaotic
competition issue of the Distributed Controlled VPP due to the coordination
of the central level I. However, communication continues to be an essential
factor of this VPP added by the compatibility among each agent. Therefore,
cybersecurity in this conﬁguration must be highly invested [7].

Virtual Power Plants for Smart Grids Containing Renewable Energy
177
When considering its objectives, a VPP may be classiﬁed as:
Commercial VPP (CVPP): Its primary function is to aggregate sorts of DERs
from different geographical areas to participate in the electricity market as a
coordinated entity focusing on ﬁnancial or commercial purposes without look-
ing at technical considerations such as system stability. It uses an estimation of
the integrated RESs and non-RESs economic parameters such as cost curves
and power forecasts to deﬁne the priority order of its resources. Then, it uses
electricity market intelligence such as load demand and historical informa-
tion of other participants to optimize the generation proﬁle with an economic
schedule for its resources [7].
Technical VPP (TVPP): It mainly focuses on power scheduling and power
balance to guarantee its safe operation. It manages its DERs within a speciﬁc
geographical area considering technical considerations and improving the efﬁ-
ciency, reliability, and penetration of its DERs despite the operating conditions
in which the DERs operate. Furthermore, it works with CVPP and an indepen-
dent system operator (ISO) to collect and exchange information to maintain
the internal power balance and meet all safety regulations [7].
Still related to the structure of VPPs, there is a suggestion for a new sublevel VPP
called information VPP (IVPP) since information services are the critical aspects of
decision-making in VPPs. IVPPs should combine CVPP and TVPP by exchanging
information through big data, increasing their competitiveness [7].
When considering the market segment, a VPP may be classiﬁed as
[9.basic-contrib]:
• DR-based VPP: most common in the demand response market in the US.
• Supply-side VPP: native to Germany.
• Mixed asset VPP: utilizes demand response and Distributed Generation (DG),
sharing the grid resources.
• Whole-sale auction VPP: is present in Europe and includes large power plants
supplying base loads.

178
S. I. Taheri et al.
2
Components of a VPP
As seen, there is not a single deﬁnition for VPP. Initially, its intention is more toward
the physical and commercial aspects of the VPP. Then, existing technologies started
to aggregate to other characteristics of VPP, complementing its deﬁnition. Therefore,
VPPs can have demand response management [8] and forecast and dispatch opti-
mization models [9], besides its aggregation of electric vehicles [10], controllable
loads, and ESS [11].
Although there is no deﬁned standard of the components of a VPP, all deﬁnitions
state some standard components fundamental to the VPP functioning. For example,
VPPs aggregate dispersed generator units, controllable loads, and storage systems,
inter-exchanging their data and power through an energy management system (EMS).
2.1
Integration of Generation Resources and Load
The VPP could be integrated into the distribution or transmission system or in both,
it depends on where the resources are physically connected. The selection of the
control types depends highly on that to deal with the respective distribution system
operator or the transmission system operator regulations.
The main advantage of the VPP over a Microgrid is that VPP has no limitations
in the number of energy resources that can be connected to it. Therefore, any type
of power generation can supply power to the VPP at any time. This fact facilitates
the integration of RES, which is variable according to the weather. Thus, a VPP may
have WT, PV, HP, CHPs, PHEV in Vehicle to Grid (V2G) mode, and other power
generation supplying the VPP system that absorbs power through its LD and PHEV
in charging mode [12].
Among all those types of DERs, some of them may be small generators working
for individual consumers such as residential, commercial, or industrial. In this case,
sometimes, those domestic DERs may not be able to supply power, which is not a
problem if it is aggregated in a VPP with other DERs. Usually, those domestic DERs
are associated with a load and connected to a low voltage distribution system [12].
Meanwhile, larger public DERs belonging to more than one individual consumer
have the primary goal of producing power for the grid. Therefore, they are associated
only with generators connected to medium voltage distribution networks [12]. The
variety of aggregated generators and demand provide versatility to the VPP to the
trade market, which can help the ISO and the EV owners to increase their proﬁt.
Another energy generation associated with a VPP is the so-called prosumers,
consumers that sometimes produce energy and become suppliers instead of con-
sumers. The prosumer is a type of domestic DER that may have stochastic (RES) or
dispatchable generators (capable of varying their operation regime almost quickly).
The VPP supports the prosumers by representing them in the power market and
bringing beneﬁts to them since other power generators are also aggregated [12].

Virtual Power Plants for Smart Grids Containing Renewable Energy
179
Despite controlling the power generation in the DERs, another methodology to
control the supply-demand balance is through the VPP loads that also support the
VPP’s healthy behavior by maintaining the balance of ancillary services such as
voltage stability and frequency regulation and grid congestion management. Those
loads may be Flexible, Curtailable or Controllable [13]. Controllable loads are the
type of load that voluntarily reduces its consumption during some speciﬁc time to
fulﬁll a contract with the distribution company.
The Flexible loads may automatically adjust their consumption pattern depend-
ing on the power price by using DR when a power company requests the ﬂexible
loads to reduce their power consumption. In terms of the power balance, the power
consumption is equivalent to supplying power when the DR suppresses. Thus, the
reduction of power is called interpreted as a generation.
Example
To better understand DR, suppose a system with two DERs:
1. DER1 has 10 MW capacity, its power cost is $ 1/MWh, and
2. DER2 has 5 MW capacity, and its power cost is $ 10/MWh.
When demand is lower than DER1 capacity, only DER1 will be active
because it is cheaper. However, if the demand is slightly higher than DER1
capacity, DER2 must connect to complete the demand request, and the cost
will be much higher.
In a system with DR, the ﬂexible loads will be controlled so that DER2
doesn’t need to be turned on. Suppose that, among the ﬂexible load, there is
a factory that can turn off its AC units, reducing its load at a certain period
of time. The factory could get $ 5/MWh to reduce its load in order to balance
the supply-demand without turning on DER2, which would be cheaper for the
VPP and beneﬁt the factory. The DR can act fast in real-time and also support
the supply-demand balance by commitment scheduled to reduce the load at
speciﬁc periods, similar to how DERs get paid to commit to supplying power.
2.2
Energy Storage System
The supply-demand balance can have more ﬂexibility when it includes ESSs. ESSs
may be used in the VPP to compensate for the variations of RE generation, which
creates ﬂuctuations in the net load (difference between load power demand and RE
power generations). It may also be used as an energy buffer system to compensate
for the need for energy at a higher price, storing energy at a lower price.
The ESS may be thermal (TES) [14], mechanical (MES) [15–18], chemical (CES)
[19, 20], or electrical (EES) [21–23]. In TES, the storage can be done through latent
heat, sensible heat, or heat created by chemical reactions. In MES, the storage can be
done by Compressed Air (CAES) [16], Hydraulic Pumped Energy (HPES) [17], or

180
S. I. Taheri et al.
conversion of kinetic energy to electric energy, such as in Flywheels (FWES) [18].
Examples of CES storage materials are methane [19] and hydrogen [20], such as in
Fuel Cells (FC). In EES, the system may use a superconductor magnetic (SMES)
[21], supercapacitor (SCES) [22], or battery (BESS) [23].
The BESSs are the most common type of ESS in VPPs. It can be designed with the
Lithium-Ion Battery (Li-IonB), Lead Acid Battery (LAB), Sodium Sulfur Battery
(SSB), or Redox Flow Battery (RFB). Table 1 shows the advantages and disadvan-
tages of each technology. When choosing the best ESS to be used in a VPP, the
engineer must analyze the output, capacity, charge/discharge efﬁciency, durability
(life), charge/discharge rate, and cost of the ESS. Those characteristics can also be
measured by the Capacity Rate (RC) [24], which is given by:
RC = CB/IC[C]
(1)
IC is the charging/discharging current in this equation, and CB is the battery capacity.
Moreover, when analyzing the supply and demand of each ESS, the engineer must
consider the State of Charge (SOC), which relates the amount of energy discharged
(CDC) [Ah] with the battery capacity. Since the capacity of the battery decreases
with its life cycle and long-term storage, only the usable battery capacity (CU SA)
[Ah] should be used [24]. Therefore, the SOC is given by:
SOC = 100CDC/CU SA[%]
(2)
Using the voltage to measure the SOC is the simplest way, but it is not precise because
the voltage may be affected by temperature and the battery material. In addition, the
charging and discharging of the battery affect its charges and voltage, creating an
error in the SOC. Thus, the battery would need to rest at no-load for at least four
hours before measuring the voltage to obtain the SOC. Measuring the SOC using
this method is impracticable for power systems [24]. Therefore, the most affordable
methodology to estimate the SOC is by measuring the current ﬂowing in and out of
the battery and counting the Coulombs. Despite the disadvantages, this is a hot topic
of research and many other propositions are being developed [24].
Each ESS technology serves various applications. Figure 2 summarizes different
ESS applications according to their discharge duration and power applications. Also,
ESS technology has different characteristics in a variety of technologies in these
applications as shown in Fig. 3. These two ﬁgures complete each other and display
the overview viewpoint of ESS [25].

Virtual Power Plants for Smart Grids Containing Renewable Energy
181
Table 1 Comparison among the different ESS technologies
Storage technology
Advantages
Disadvantages
TES-Latent heat
1-Short-term and long-term storage
2-Higher storage density
1-Corrosive in nature 2-Relatively
low thermal conductivity
TES-Sensible heat
1-cost effective 2-Longer life-cycle
Demand geological requirements
TES-Thermo-chemical
Appropriate for large-scale energy
generating
–
MES-CAES
1-Store air diabetically or
adiabatically 2-Can store a large
amount of electrical energy at more
than 100 MW 3-No carbon emission
1-Initial investment cost is expensive
2-Requires gas turbine 3-Combustion
of fossil fuel
MES-HPES
1-Uses stored water at a relatively
high elevation (water potential) 2-
Shorter start-up time 3-Efﬁciency of
about 78 % 4-Capable to respond to
rapid oscillations and high surge in
demands
1-Require a lot of water and height
differences 2-High construction cost
3-Low energy density 4-Higher
surface footprint
MES-FWES
1-Kinetic energy 2-long lifetime
(several hundreds of thousands of full
cycles) 3-high storage efﬁciency (up
to 90–95%).
1-High rate of self-discharge caused
by a high frictional loss 2-High initial
cost 3-Low energy density
CES-Methane
1-Can be developed in a multi-step
procedure 2-Easy to store energy
3-Reduced gas emission 4-Can be
transported to high distances
–
CES-FC
1-Can be stored for longer time
2-Environmental 3-Almost no
emission
1-High cost maintenance 2-Lower
efﬁciency
EES-SMES
1-Uses superconductor, cryogenic
refrigerator, and power conversion
system 2-Efﬁciency of 98 %
3-Lifetime of more than 20 years
1-Low self-discharge 2-High system
cost 3-Strong magnetic ﬁeld creates
environmental issues
EES-SCES
1-Stores electrical energy in the form
of charges commonly due to the
formation of the double-layer
capacitor structure at the boundary
between the electrodes and the
electrolyte 2-Very fast charging (in
seconds) 3-High efﬁciency 4-Long
lifetime 5-Light weight 6-Good
power density 7-Environmentally
friendly
1-Discharge rapidly 2-Lower energy
density
EES-BESS-Li-IonB
1-Less toxic 2-Higher efﬁciency
Very expensive, mainly for long-term
storage
EES-BESS-LAB
1-Usually deployed in cars 2-Provide
a large current 3-Higher energy
density 4-Highly recyclable
–
EES-BESS-SSB
1-Used for load leveling and
integration of renewables in earlier
projects 2-Longer life-cycle
1-High production costs 2-Higher
operating temperature
EES-BESS-RFB
1-Shorter time for the full charge
2-Flexible in nature
1-Leak electrical current 2-Bulky size

182
S. I. Taheri et al.
Fig. 2 Applications of
different ESS
2.3
Electricity Markets
The electricity market at the wholesale level can be categorized into the following
sub-markets:
Day-ahead market (DAM)
The DAM aims at generation scheduling for its trading scheme. It can use ISO
central dispatching system, competitive bidding, or bilateral negotiation.
In the ISO central dispatching system, information about a generous gen-
eration offer and its cost curve are essential for bidding. The ISO uses this
information to schedule the power to maximize social beneﬁt properly. For
example, the electricity tariff could be peak-valley, ﬂat, time-of-use (TOU),
etc. Depending on the price scheme, the VPP may shave the peak and shift the
load or work to establish the electricity price. By using forecast techniques, the
TOU price can be forecasted. The VPP and ISO can work together in a bilateral

Virtual Power Plants for Smart Grids Containing Renewable Energy
183
Fig. 3 Characteristics and discharge duration of different ESS technologies
power scheduling optimization problem to maximize the market revenue while
minimizing ISO social costs and other technical constraints. Thus, depending
on the ISO dispatch plan, the VPP adapts its generation proﬁle [7].
In competitive bidding, individual bidding information with capacity and
the anticipated price is vital for a market-oriented plan. The ISO uses this

184
S. I. Taheri et al.
information to calculate the marginal price. The bidding could be done in a
market clearing price (MCP) or pay as bid (PAB) scheme. In MCP, there is
no price regulation with power transactions set during exchange hours. This
increases the competitiveness of the electricity market with price incentives
from DERs, but it can beneﬁt potential market power by creating an uneven
generation capacity [7]. In the PAB scheme, the cost of the committed power is
the market revenue. The VPP adjusts its bidding strategy to either MCP or PAB.
In MCP, all the energy resources of VPP can be fully integrated due to its cost
advantage. In PAB, VPP can use historical data of its competitors to simulate
their bidding strategy and uses the latter to optimize its own bidding strategy.
Thus, the VPP works as a price-maker inﬂuencing the electricity market. On
the other hand, a VPP with too many DERs and DGs may decrease the market
competition due to its power strength, and thus, market regulations must be
enforced [7].
In bilateral negotiation, major market participants can make a trading con-
tract voluntarily because it supports the knowledge of price and the arbitrage
for both sides. Since DERs cannot participate in ordinary bilateral negotiation,
their integration in a VPP can provide its reliability as an economical energy
supply in this negotiation because VPP combines multiple units to complement
each other insufﬁciency [7].
Real-time balancing market (RBM)
The RBM adjusts the power price in real time to compensate for power devia-
tion, but the integration of RESs creates difﬁculty in keeping a real-time power
balance. The spinning reserve is the main trading factor in this market and can
be positive or negative. The spinning reserve compensates for the lack of power
on demand, and its service provider receives extra money. The VPP integrates
multiple DGs spinning reserves, and thus, it supports the ISO by decreasing
ISO’s computation burden. However, VPP’s spinning reserve capacity needs
an upper limit to avoid market power that may be created by a higher capacity
of VPP’s spinning reserve. Moreover, a VPP may also consume a spinning
reserve if its reserved generation capacity is insufﬁcient to compensate for its
internal RESs. Therefore, the VPP must properly optimize its power allocation
in the case of emergencies [7].
Ancillary-service market (ASM)
The ASM focuses on the ancillary services installed to maintain power quality,
frequency stability, and any other security factor of the power system to make it
reliable. However, since the compensation techniques of its ancillary services

Virtual Power Plants for Smart Grids Containing Renewable Energy
185
are obsolete, it lacks a market-oriented strategy, making it not attractive to
market participants. Therefore, the participation of VPP in this market can
improve the power quality of RESs and the efﬁciency of DGs by increasing
their spare capacity [7].
Besides each sub-market, a VPP could participate in a joint market with opti-
mization in DAM and RBM, transforming it from price-taker to price-maker. The
VPP may participate in DAM to get its revenue, and the RBM and ASM to improve
their security factors and provide extra power reserve. However, integrating all its
resources in multiple sub-markets requires a wide range of calculation methods, and
also speciﬁc regulation [7].
2.4
Transportation System
As mentioned before, EVs are promising technology increasing their penetration in
the global power grid [26]. In the context of a VPP, EVs require speciﬁc control since
they may have a dual function in the power system. EVs may act as a load when
charging in Grid-to-Vehicle (G2V) mode, or as mobile ESSs when supplying the
stored electricity back to the network in Vehicle-to-Grid (V2G) mode. That means
EVs can assist RE intermittence by storing energy when RE produces more than the
load and later supplying back the energy when RE sources are not enough.
TheEVsmayalsosupplypowerattimeswhentheelectricpowerismoreexpensive
and recharge when the electric power is cheaper. This trade may decrease the power
cost for EV owners.
However, charging and discharging the EV’s battery in V2G mode reduces the
battery’s lifetime. Moreover, EVs cannot aggregate directly in the power grid. There-
fore, the VPP acts as an important piece in aggregating the EVs into the power grid
and managing the EV’s charging and discharging, which can be done in several dif-
ferent ways. The VPP may use market price forecasts and EV driving patterns to
optimize its charging and discharging or scheduling the EV charging [27].
The project EDISON (electrical vehicles in a distributed and integrated market
using sustainable energy and open networks) is a real example of VPP created by a
collaboration between Denmark and Germany with the aim to integrate PHEVs into
the power system. This project collects information about each EV’s battery status
and demand and creates an optimized charging/discharging strategy to aggregate the
EVs. It also analyzed the reduction of EVs and PHEVs CO2 emissions in a V2G
system [7].

186
S. I. Taheri et al.
3
Optimization Strategies for a Virtual Power Plant
Optimizing a VPP operation is all about doing more with your data and making
better decisions in the power system. Besides, electrical utilities are driven by data
but do not always know how to use them as a competitive advantage. Thus, an
optimization strategy with a mathematical approach and its software tools can help
decision-makers of power systems to know what to do with data once it is analyzed.
Furthermore, as electricity market competition intensiﬁes, participants (power gen-
erator agents) need to coordinate their operations better. Therefore, an optimization
strategy offers better real-time decision-making and data for analysis and forecast-
ing. As a result, it shows a better Return on investment (ROI) and more measurable
results, meaning better value and service to the utility [28].
Optimization research professionals use various tools, including mathematical
optimization algorithms, statistics, probability theories, simulations, and decision
analysis. These tools are often used in combination. Linear programming is prob-
ably the best-known mathematical optimization technique. Most OR professionals
today perform activities to help organizations improve their business processes and
performances, develop and deploy models and algorithms for information systems
and applications, and contribute to the debate about the purpose and direction of
institutions and policies. OR analysts often also work as consultants who design and
implement optimization-based solutions [29].
The optimization algorithm uses mathematical techniques to ﬁnd the best possible
solution to a power system’s optimization problem. An optimization-based solution
involves:
- An optimization model is deﬁned in terms of an objective, decision variables,
and constraints.
- Data to create an instance of the model.
- An optimization engine to solve the model instance.
The optimization process aims to ﬁnd values for the decision variables to satisfy all
constraints and optimize the objective function. For example, an objective function
could be to maximize proﬁt or minimize costs. The decision variables might represent
how many different types of generators to perform or which generator to assign to a
task. And the constraints could be production or availability restrictions. The number
of domains optimization can be applied to is vast [30].
Two optimization approaches have been applied more than others: mathematical
programming and constraint programming. Mathematical programming techniques
include linear programming, integer programming, mixed-integer programming,
quadratic programming, and mixed-integer quadratic programming. The different
methods address different types of problem structures. Constraint programming is
especially appropriate for detailed scheduling problems, and certain combinatorial

Virtual Power Plants for Smart Grids Containing Renewable Energy
187
optimization problems that cannot be easily linearized and solved using traditional
mathematical programming methods [31].
A typical optimization model development cycle starts with the scope deﬁnition
in power system terms. Next, the OR analyst uses the scoping document to construct
a mathematical optimization model to identify the objectives, decision variables, and
constraints. The OR analyst will gather data to populate the model and then create
and test a prototype with a small data set. The model is then edited as required,
based on the test results. Next, the OR analyst creates and tests a complete model
instance and evaluates the performance. Finally, the model is adjusted as needed, and
advanced solution techniques are developed, if required, to ﬁnd a suitable solution
in a reasonable time [32].
The objective function of an optimization model is a mathematical representation
of the power system objectives or goals to be achieved. Objective functions always
start with the words “maximize” or “minimize” and can be either a simple expression
involving a single utility objective or a more complex presentation combining several
power system objectives [33]. For example, some objectives are to maximize proﬁt,
minimize cost, minimize delay, and maximize customer service.
Decision variables in an optimization model represent values or decisions that are
determined by the solver engine to arrive at the best possible value of the objective
function. Examples of decision variables are:
Questions
- How much of the given electricity to generate?
- How many generators to hire for a given task?
- Which location to choose for a new powerplant, etc.?
The values of the decision variables are determined during the solution process.
These values are usually unknown in a model, although it’s possible to provide an
initial guess to help optimization. Decision variables have:
Attention
- A domain: the set of all possible values for the variable
- Bounds: the lower and upper limits of the domain. Inﬁnite bounds are allowed
- A type: for instance, real, integer, Boolean, or interval. It is crucial to choose
the decision variables well because they impact the formulation of the con-
straints and the solution method used.
Constraints deﬁne the relationships between different decision variables and relate
the data to the decision variables. They represent the limits within which the solution
should exist. Examples of constraints are:

188
S. I. Taheri et al.
Examples
- That the amount produced of the electricity should be less than the production
capacity.
- That the generator hired for a given task should have a minimum set of power
generation.
- That the cost of building a new powerplant should be less than the budgeted
amount, etc.
Constraints are either hard or soft: Hard constraints should not be violated under
any circumstances, for example, a constraint on production capacity when no addi-
tional capacity is available by any means. Soft constraints can be violated under
certain circumstances. In the case of soft constraints, a penalty is often added to the
objective to minimize the constraint violation [34].
In optimization, a solution is a proposal of speciﬁc values for the decision vari-
ables, regardless of whether it is a desirable or an allowable set of choices. Solutions
can be classiﬁed as follows:
Tips
- Feasible is a solution that satisﬁes all the constraints.
- Optimal is a feasible solution that also achieves the best possible value of the
objective function.
- Infeasible is a solution where one or more constraints are violated.
- Unbounded is a solution to a problem where the constraints are not thoroughly
described, resulting in an objective that goes to plus or minus inﬁnity. The set
of all feasible solutions is called the feasible region.
3.1
Single and Multi-objective Scheduling of a VPP
The multi-objective or single-objective approach can ﬁnd the optimization problem
results based on the objective functions. Decision-makers determine their essen-
tial objective functions. The multi-objective concept usually applies in optimization
problems where the objective functions may conﬂict [27]. This section offers the
mathematical formulation’s proposed objective functions and practical constraints.
3.1.1
Objective Functions
According to the economic speciﬁcations of DER, this paper models the cost function
for each unit as [35]:

Virtual Power Plants for Smart Grids Containing Renewable Energy
189
C (p) = (Cost1gen + Cost2gen) × p
(3)
Cost1gen =
Cap × Cost × Ar
LT × LF × 365 × 24
(4)
Cost2gen = Fcost + OMcost
(5)
Cap, Cost, Ar, LT , and LF represent the generator’s capacity, capital cost, rate
of annual interest, the lifetime of the generator, and load factor, respectively. The
total electricity generation cost mathematic model considering photovoltaic units,
fuel cells, and wind turbines are as follows [36]:
f1 (X) =
Npv

i=1
C pv

Ppv

+
N f c

j=1
C f c

Pf c

+
Nwind

k=1
Cwind(Pwind) + costsub
(6)
costsub = Qsub × Psub
(7)
F1 (X) = min[ f1 (X)]
(8)
All existing generators in the VPP should be considered in the formulations. For
example, Eq. (6) considered photovoltaic units, fuel cells, and wind turbines. The
power and location vector of fuel cell units, photovoltaic units, and wind units repre-
sent X. The optimization algorithm should minimize the deﬁned objective function.
The other objective function is voltage deviation which is formulated as follows:
f2 (X) =
Nbus

m=1
|Vnom −Vr|
Vnom
(9)
NBus, Vnom, and Vr represent the bus number, the nominal voltage, and the Voltage
magnitude of the bus number. Another interesting objective function for decision
makers is the loss function which is formulated as follows:
f3 (X) =
Nlt

a=1
Nnb

b=1
(Rm × I 2
m × δt)
(10)
Nlt, Nnb, Rm, Im, and δt represent the lifetime of DER, the distribution system
branches number, the resistance of the branch number, actual current of the branch
number, and the time step, respectively. The other objective functions, such as emis-
sion of greenhouse gasses [35–37] in the same way, can be formulated.

190
S. I. Taheri et al.
3.1.2
Constraints
All the constraints which are limited to the operation of the VPP should be formulated
to have a perfect VPP model. this section has formulated some of them as examples
to ﬁnd out how to do it [38]. These constraints include limitation of voltage, number
of DERs, and size of DERs. These constraints are as follows
Vmin ≤|Vm| ≤Vmax)
(11)
nDG ≤NDG
(12)
nDG

n=1
K W n
DG ≤ηPload
(13)
Vmin, Vm, Vmax, nDG, NDG, K W n
DG, and Pload are lower voltage limits, the magni-
tude of the voltage, upper voltage limits, DER number, maximum DER number, the
capacity of the DER, and the total load power, respectively.
The other existing restrictions for the operation of all components of the VPP
should be considered, such as mentioned formulation in the VPP model. These
considerations make the VPP model more reliable [38–40].
3.2
Optimization Algorithms
Various optimization algorithms have been applied to the VPP models. These algo-
rithms form mostly in evolutionary optimization algorithm types, including Genetic
Algorithm (GA), particle swarm optimization (PSO) algorithm, Honey bee mating
optimization (HBMO) algorithm, Teaching-Learning based optimization (TLBO)
algorithm, etc. However, based on the No Free Lunch theorem, the best optimization
algorithm is not available for all systems. Therefore, the best optimization algorithm
should be found or designed for each system based on the existing optimization con-
ditions. Because of this reason, many optimization algorithms are available for the
VPP model [41–43].
To show the differences in optimization algorithms, the chapter compares some
of the best-reported ones in the same case study of Ref. [44]. In this case study,
the 13-bus VPP system is the test system. all buses of this system have connections
to renewable energy resources. For the single objective, the considered objective
function is the cost objective function that is formulated in the previous section.
Based on the results of Fig. 4, the TLBO algorithm in this case study has the best
accuracy and calculation velocity among these three optimization algorithms.
The results of the multi-objective optimization of the proposed case study show
the comparison of these optimization algorithms for optimizing three formulated
objective functions of cost, loss, and voltage deviation. Figure 5 shows this com-

Virtual Power Plants for Smart Grids Containing Renewable Energy
191
Fig. 4 Single objective
comparison of the
best-reported optimization
algorithms in VPP modeling
parison by presenting the Pareto optimal solutions. The decision maker of the VPP,
based on the requirement of the system and the preferences, can select the best solu-
tion among the non-dominated solutions. The non-dominated solutions are the best
solutions, which at least one of their objective functions is the best one among all
solutions.
This section efforts to help the modeling of VPP modeling. The best model should
consider all existing components, such as renewable generators, energy storage sys-
tems, and transportation systems. First, however, the requirements for the modeling
have been explained. Moreover, optimizing the energy management of the VPP has
been discussed in this chapter to have a perfect VPP model.
4
Conclusion
This chapter sheds light on the various ways of implementing a VPP to support
the reader in understanding the research and development paths toward the future.
The techniques, methods, approaches, and requirements for modeling a VPP were
discussed. The proposed modeling of a VPP was ﬂexible in designing the VPP
model based on existing power system components. Moreover, how to optimize the
implementation of the VPP was explained. Through the discussed issues in VPP
models, integrating the power system’s renewable energy resources and ﬂexibility
can be smooth in an optimal way. The future works will be in the direction of
Dynamic Virtual Power Plants. This topic will be focused on designing the multi-
input multi-output control system of renewable energy resources which are dynamic
in generating electricity.

192
S. I. Taheri et al.
Fig. 5 Multi-objective comparison of the best-reported optimization algorithms in VPP modeling
References
1. Zhongming Z et al (2021) Global EV outlook 2021
2. Allen Hamilton B, Miller J, Renz B (2010) Understanding the beneﬁts of the smart grid-smart
grid implementation strategy. In: United States: United States department of energy’s national
energy technology laboratory
3. Ramchurn SD et al (2012) Putting the ‘smarts’ into the smart grid: a grand challenge for
artiﬁcial intelligence. Commun ACM 55(4):86–97
4. Mostafa Nosratabadi S, Hooshmand R-A, Gholipour E (2017) A comprehensive review on
microgrid and virtual power plant concepts employed for distributed energy resources schedul-
ing in power systems. Renew Sustain Energy Rev 67:341–363

Virtual Power Plants for Smart Grids Containing Renewable Energy
193
5. Lasseter RH, Paigi P (2004) Microgrid: a conceptual solution. In: 2004 IEEE 35th annual power
electronics specialists conference (IEEE Cat. No. 04CH37551), vol 6. IEEE, pp 4285–4290
6. Parhizi S et al (2015) State of the art in research on microgrids: a review. IEEE Access 3:890–
925
7. Zhang G, Jiang C, Wang X (2019) Comprehensive review on structure and operation of virtual
power plant in electrical system. IET Gener Transm Distrib 13(2):145–156
8. Pasetti M, Rinaldi S, Manerba D (2018) A virtual power plant architecture for the demand-side
management of smart prosumers. Appl Sci 8(3):432
9. Baringo A, Baringo L, Arroyo JM (2021) Holistic planning of a virtual power plant with
a nonconvex operational model: a risk-constrained stochastic approach. Int J Electr Power
Energy Syst 132:107081
10. Raab AF et al (2011) Virtual power plant control concepts with electric vehicles. In: 2011 16th
international conference on intelligent system applications to power systems. IEEE, pp 1–6
11. Avila E et al (2017) Energy management of a virtual power plant with a battery-ultracapacitor
based hybrid energy storage system. In: 2017 IEEE Southern Power Electronics Conference
(SPEC). IEEE, pp 1–6
12. Mashhour E, Moghaddas-Tafreshi SM (2009) The opportunities for future virtual power plant
in the power market, a view point. In: 2009 international conference on clean electrical power.
IEEE, pp 448–452
13. Kumar Pandey A, Kumar Jadoun V, Jayalakshmi NS (2021) Virtual power plants: a new era of
energy management in modern power systems. In: 2021 8th international conference on signal
processing and integrated networks (SPIN). IEEE, pp 538–543
14. Zhang H et al (2016) Thermal energy storage: recent developments and practical aspects. Prog
Energy Combust Sci 53:1–40
15. Kyriakopoulos GL, Arabatzis G (2016) Electrical energy storage systems in electricity genera-
tion: energy policies, innovative technologies, and regulatory regimes. Renew Sustain Energy
Rev 56:1044–1067
16. Cheung BC, Carriveau R, Ting DS-K (2014) Parameters affecting scalable underwater com-
pressed air energy storage. Appl Energy 134:239–247
17. Bueno C, Carta JA (2006) Wind powered pumped hydro storage systems, a means of increas-
ing the penetration of renewable energy in the Canary Islands. Renew Sustain Energy Rev
10(4):312–340
18. Bolund B, Bernhoff H, Leijon M (2007) Flywheel energy and power storage systems. Renew
Sustain Energy Rev 11(2):235–258
19. Sterner M (2009) Bioenergy and Renewable Power Methane in Integrated 100% renewable
energy systems. In: Limiting global warming by transforming energy systems: limiting global
warming by transforming energy systems, vol. 14. kassel university press GmbH
20. Walker SB et al (2016) Benchmarking and selection of power-to-gas utilizing electrolytic
hydrogen as an energy storage alternative. Int J Hydrog Energy 41(19):7717–7731
21. Diaz PM, El-Khozondar HJ (2019) Electrical energy storage technologies and the application
potential in power system operation: a mini review. In: 2019 IEEE 7th Palestinian international
conference on electrical and computer engineering (PICECE). IEEE, pp 1–9
22. Sharma P, Kumar V (2020) Current technology of supercapacitors: a review. J Electron Mater
49(6):3520–3532
23. May GJ, Davidson A, Monahov B (2018) Lead batteries for utility energy storage: a review. J
Energy Storage 15:145–157
24. Ninagawa C (2022) Virtual power plant system integration technology. Springer
25. Berger R (2017) Business models in energy storage. In: Focus
26. Zhou E, Mai T (2021) Electriﬁcation futures study: operational analysis of US power systems
with increased electriﬁcation and demand-side ﬂexibility. Technical report National Renewable
Energy Lab. (NREL), Golden, CO (United States)
27. Rashidizadeh-Kermani H et al (2021) A stochastic short-term scheduling of virtual power plants
with electric vehicles under competitive markets. Int J Electr Power Energy Syst 124:106343

194
S. I. Taheri et al.
28. Iman Taheri S et al (2021) A day-ahead hybrid optimization algorithm for ﬁnding the dispatch
schedule of VPP in a distribution system, vol 1, pp 1-6. https://doi.org/10.48011/sbse.v1i1.
2476
29. Iman Taheri S, Salles MBC, Kagan N (2019) A new modiﬁed TLBO algorithm for placement
of AVRs in distribution system. https://doi.org/10.1109/ISGT-LA.2019.8895471
30. Iman Taheri S, Salles MBC (2019) A new modiﬁcation for TLBO algorithm to placement
of distributed generation, pp 593–598. https://doi.org/10.1109/ICCEP.2019.8890101. https://
ieeexplore.ieee.org/document/8890101/
31. Iman Taheri S, Salles MBC, Ahmad Khan I (2021) Supporting distributed energy resources
with optimal placement and sizing of voltage regulators on the distribution system by an
improved !teaching-learningbased optimization algorithm. Int Trans Electr Energy Syst 31(8).
issn: 2050-7038. https://doi.org/10.1002/2050-7038.12974
32. Wang W et al (2021) Research on market operation of power supply virtual power plant based
on system dynamics, pp 748–756. https://doi.org/10.1109/iSPEC53008.2021.9735507
33. Nuvvula RSS et al (2022) Multi-objective mutation-enabled adaptive local attractor quantum
behaved particle swarm optimisation based optimal sizing of hybrid renewable energy system
for smart cities in India. Sustain Energy Technol Assess 49:101689. issn: 22131388. https://
doi.org/10.1016/j.seta.2021.101689
34. Sakr WS et al (2022) Identifying optimal border of virtual power plants considering uncertain-
ties and demand response. Alex Eng J 61(12):9673–9713. issn: 11100168. https://doi.org/10.
1016/j.aej.2022.02.070
35. Niknam T et al (2011) A modiﬁed honey bee mating optimization algorithm for multiobjective
placement of renewable energy resources. Appl Energy 88(12):4817–4830
36. Iman Taheri S et al (2020) A trip-ahead strategy for optimal energy dispatch in ship power
systems. issn: 03787796. https://doi.org/10.1016/j.epsr.2020.106917
37. Ghahgharaee Zamani A, Zakariazadeh A, Jadid S (2016) Dayahead resource scheduling of a
renewable energy based virtual power plant. Appl Energy. issn: 03062619. https://doi.org/10.
1016/j.apenergy.2016.02.011
38. Javad Kasaei M, Gandomkar M, Nikoukar J (2017) Optimal management of renewable energy
sources by virtual power plant. Renew Energy. issn: 18790682. https://doi.org/10.1016/j.
renene.2017.08.010
39. Fang F, Yu S, Liu M (2020) An improved Shapley valuebased proﬁt allocation method for
CHP-VPP. In: Energy. issn: 03605442. https://doi.org/10.1016/j.energy.2020.118805
40. Salles MBC, Aziz MJ, Hogan WW (2016) Potential arbitrage revenue of energy storage systems
in PJM during 2014, pp 1–5. https://doi.org/10.1109/PESGM.2016.7741114
41. Sierla S, Pourakbari-Kasmaei M, Vyatkin V (2022) A taxonomy of machine learning applica-
tions for virtual power plants and home/building energy management systems. Autom Constr
136:104174. issn: 09265805. https://doi.org/10.1016/j.autcon.2022.104174
42. Iman Taheri S, Salles MBC, Costa ECM (2020) Optimal cost management of distributed
generation units and microgrids for virtual power plant scheduling. IEEE Access. issn: 2169-
3536. https://doi.org/10.1109/access.2020.3039169
43. Iman Taheri S, Salles MBC, Nassif AB (2021) Distributed energy resource placement consid-
ering hosting capacity by com bining teaching-learning-based and honey-bee-mating optimi-
sation algorithms. Appl Soft Comput 113:107953. issn: 15684946. https://doi.org/10.1016/j.
asoc.2021.107953
44. BahmaniﬁrouziB,NiknamT,ImanTaheriS(2011)Anewevolutionaryalgorithmforplacement
of distributed generation. In: 2011 ieee power engineering and automation conference 1, pp
104–107. https://doi.org/10.1109/PEAM.2011.6134806

Power Electronics Analysis and Control

Inverter-Based Local Control Methods
for Mitigating Overvoltage in
Photovoltaic Penetrated Low-Voltage
Networks
J. Villavicencio, J. D. Melo, J. B. Leite, and A. Padilha-Feltrin
Abstract A reduced number of smart meters in low-voltage (LV), especially in the
extensive ones, limits the application of centralized, decentralized, or distributed
voltage control in this type of network with small-scale residential photovoltaic
(PV) systems. However, in local control, controllers can respond fast to distributed
generation variability and are not affected by communication failures. Thus, local
voltage control methods can mitigate the overvoltage using droop control curves in
PV inverters, which are set ofﬂine in pre-operational studies. This chapter presents
four local control methods for overvoltage mitigation in LV networks with PV gen-
eration. Three of these methods use one smart control functionality of PV inverters,
while the other uses two smart control functionalities in a coordinated way. Power
ﬂow simulations are performed using data from a Brazilian real-world and extensive
LV network to compare the performance of these control methods. Besides, a broader
comparison is conducted by analyzing power losses in the network, the transformer
power factor, and transformer loading. Finally, the above methods are evaluated con-
sidering several PV integration scenarios. This analysis can help utilities use one or
more local voltage control methods to accommodate more PV systems in their LV
feeders.
J. Villavicencio (B)
Universidad Tecnológica del Perú, Panamericana Norte, Av. Alfredo Mendiola 6377,
Los Olivos, 15306 Lima, Peru
e-mail: joelitoilha@gmail.com
J. D. Melo
Universidade Federal do ABC, Av. dos Estados, 5001 - Bangú,
Santo André-SP 09210-580, Brazil
e-mail: joel.melo@ufabc.edu.br
J. B. Leite · A. Padilha-Feltrin
Sao Paulo State University - UNESP, Ilha Solteira-SP, Brazil
e-mail: jb.leite@unesp.br
© The Author(s), under exclusive license to Springer Nature Switzerland AG 2024
A. J. Sguarezi Filho et al. (eds.), Smart Grids—Renewable Energy, Power Electronics,
Signal Processing and Communication Systems Applications, Green Energy
and Technology, https://doi.org/10.1007/978-3-031-37909-3_7
197

198
J. Villavicencio et al.
1
Introduction
The number of residential photovoltaic (PV) systems in low-voltage (LV) networks
has grown constantly around the world in the last few years [1]. These local micro-
generators reduce the consumers’ energy demand from the network and the power
ﬂow in the network. The power ﬂow reduction can bring some beneﬁts to the network
as the reduction of voltage drops along LV feeders. However, depending on demand
conditions, medium or high levels of PV penetration can lead to overvoltage problems
[2] or increase power losses in LV networks [3].
In countries with high penetration of PV in distribution networks, overvoltage is
a technical problem of most concern in LV networks with PV systems [2]. Thus,
different voltage control methods including decentralized [4] and distributed [5]
control have been proposed in the specialized literature. Voltage control methods
make use of on-load tap-changer (OLTC) transformers [6], [7], batteries or battery
storage systems [8, 9], and PV inverters control functions [10, 11].
Traditionally, devices considered in Volt-VAr control have included OLTC trans-
formers, automatic voltage regulators, and capacitor banks. However, in the current
smart grid scenario, the incorporation of new devices such as distributed genera-
tors, electric vehicles, energy storage and smart grid technologies will affect the
performance of traditional devices [12–14]. Therefore, new research is needed to
investigate the effect of smart grid technologies on the performance of the volt-VAr
optimization (VVO) function. The impact of high penetration of distributed energy
resources and real-time data capture produces challenges in the VVO function that
need to be considered and analyzed [14].
The use of OLTC transformers is a technical challenge in feeders with different
PV penetrations [15]. Moreover, OLTC transformers have a slow response time
[11]. Also, since OLTC transformers are more expensive than ﬁxed tap position
transformers, utilities rarely use OLTC transformers to supply energy to extensive
LV networks.
Batteries allow the storage of excess active power generated by PV systems,
avoiding overvoltage problems in the network. Because the cost of batteries is still
relatively high [8], consumers rarely choose to install PV-plus-storage systems, espe-
cially in countries where there is no incentive to purchase this type of system.
IEEE-1547 [16] and network operators, e.g., [17] consider voltage control through
reactivepowermanagementoractivepowerreductionofinverters.Someauthorshave
taken into account distributed [18, 19] and centralized [11, 20] control methods to
set the reactive power from the inverters. The implementation of these methods
requires the existence of a communication infrastructure for the electrical power
grid. In distribution practice, most PV inverters simply use local droop control [10].
Therefore, acquiring the aforementioned resources would further increase the cost
of transitioning to decentralized voltage control. In this sense, from an economic
viewpoint, it is of interest to eliminate additional requirements and thereby keep
investment at the bare minimum, which consists in implementing the star-topology
networks in each voltage control zone. These methods can respond fast to distributed
generation variability and are not affected by communication failures [21].

Inverter-Based Local Control Methods …
199
In local voltage control methods, the operation of the inverter is adjusted by
measuring the voltage at its respective point of common coupling (PCC) [22, 23].
Local control presents a fast response [24], which is useful, taking into account the
variability of solar radiation and demand. Regulation of voltage without information
exchange makes local control less vulnerable to communication failures [25].
In this book chapter, four local voltage control methods using PV inverters are
presented to mitigate the voltage rise caused by the growing installation of the PV
system in LV networks. An extensive, three-phase, four-wire LV network is used to
test the considered methods. Since this voltage increase depends on the quantity of
active power injected and the point of injection, two load conditions and the stochastic
nature of PV integration in the network (locations and sizes) are assumed in the
test. Monte Carlo simulation is employed for generating the PV system integration
scenarios. As a local voltage control implies independent actions by each inverter,
voltage regulation may not result in a predetermined operational point for the LV
network. Thus, we perform daily power ﬂow simulations to analyze voltage proﬁles
in all nodes.
The considered methods have been adopted for some utilities or proposed in the
specialized literature. Therefore, other utilities that present an increase in the voltage
due to PV installations in their networks can evaluate the use of these methods.
The rest of this chapter is organized as follows.
Section 2 initializes describing the fundamentals of local voltage controls. Then,
four local voltage control methods adopted for utilities or proposed in the specialized
literature are presented. Drooped control curves used in these methods and their
respective control function are provided.
An illustrative example considering the application of the aforementioned meth-
ods in a short LV feeder is presented in Sect. 3. The objective is to understand how
PV generation inﬂuences voltages in the network and how the voltage increase is
mitigated for each voltage control method. For simplicity, it is assumed that all con-
sumers and photovoltaic systems have the same demand proﬁle and power generation
proﬁle, respectively.
The criterion adopted to evaluate the performance of the local voltage control
methods is presented in Sect. 4.
In Sect. 5, an extensive LV feeder is used to evaluate the performance of the
presented voltage control methods. This evaluation considers the stochastic nature
of locations and sizes of PV systems during their integration into the network.
The conclusions of this chapter are presented in Sect. 6.
2
Local Voltage Control Methods
In this type of voltage control, each inverter uses local measurements at its respective
PCC to set its operating point. Figure 1 shows how local control works for a con-
sumer with a small-scale PV system. This PV system is represented by an inverter

200
J. Villavicencio et al.
Fig. 1 Local control for a
grid-connected small-scale
photovoltaic system
whose power generation P and reactive power absorption/injection Q depend on local
measurements.
Voltage control methods use inverter characteristics from the IEEE 1547 standard
to mitigate overvoltage problems using one or two control actions. The control action
sets the inverter when the voltage rise at PCC is near to or higher than the maximum
allowable voltage. Allowable voltage limits vary from country to country and among
standards. For example, in low-voltage applications, the lower and upper voltage
limits in Brazil are 0.92 p.u. to 1.05 p.u. [26]; whereas, in Peru, these values are
0.95 p.u. and 1.05 p.u. [27]. The following subsections describe four local control
methods adopted for some utilities or proposed in the specialized literature.
2.1
P(U) Method
In the P(U) method, the amount of active power injected by an inverter depends on
the level of voltage at its PCC [28]. Figure 2 shows the droop control curve used in
the P(U) method, which is represented by Eq. (1).
P =
⎧
⎪⎨
⎪⎩
Pava,
U < U3
r%×Pava
U3−U4 × (U −U3) + Pava
U3 < U < U4
(1 −r) × Pava,
> U4.
(1)
In [28], a local method based on the reduction of generated active power is pro-
posed, where inverters reduce the active power production based on the voltage at
Fig. 2 P(U) method

Inverter-Based Local Control Methods …
201
their PCC. As consumers are monetarily compensated by the generation of active
power in some countries, such as Brazil [29], a voltage control totally based on the
reduction of active power should discourage consumers to install PV systems.
2.2
Q(U) Method
In the Q(U) method, the amount of reactive power injected or absorbed by an inverter
depends on the level of voltage at its PCC [30]. Figure 3 shows the droop control
curve used in the Q(U) method, which is represented by (2).
Q =
⎧
⎪⎨
⎪⎩
0,
U < U1
Qmax
U1−U2 × (U −U1) U1 < U < U2
−Qmax,
U > U2.
(2)
Proper management of reactive power can be used to aid in voltage control [31,
32], mainly, when the injected power in the network is moderate. However, the
application of this method can face capacity limitations at noon (when active power
production is high). This limitation is due to the small spare of reactive power capacity
in inverters to properly deal with the overvoltage. The same limitation occurs when
the generated power is higher than consumers’ demand [23, 30], because of the high
ratio of resistance to reactance of LV networks.
2.3
Q(P) Method
In the Q(P) method, the amount of reactive power injected or absorbed by an inverter
is determined as a function of the available active power (Pava ) [33]. Figure 4 shows
the droop control curve used in the Q(P) method, which is represented by Eq. (3).
Fig. 3 Q(U) method

202
J. Villavicencio et al.
Fig. 4 Q(P) method
Q =
⎧
⎪⎨
⎪⎩
0,
Pava < P1
Qmax
P1−P2 × (Pava −P1),
P1 < Pava < P2
−Qmax,
Pava > P2.
(3)
According to IEEE-1547, the maximum quantity of reactive power can be used
to aid in voltage control [31, 32], mainly, when the injected power in the network is
moderate. This control method has the same limitations as the Q(U) method.
2.4
cosϕ(P) Method
In the cosϕ(P) method, the inverter power factor (cosϕ) is determined as a function
of the available active power (Pava ) [23]. Figure 5 shows the droop control curve
used in the cosϕ(P) method, which is represented by Eq. (4).
cosϕ =
⎧
⎪⎨
⎪⎩
1,
Pava < P1
1−pfmin
P1−P2 × (Pava −P1) + 1,
P1 < Pava < P2
pfmin,
Pava > P2.
(4)
Fig. 5 cosϕ(P) method

Inverter-Based Local Control Methods …
203
Fig. 6 Q(U)&P(U) method
According to the regulatory energy legislation, a minimum value of the inverter
power factor can be established and should be applied in the cosϕ(P) method.
2.5
Q(U)&P(U) Method
In the Q(U)&P(U) method, each inverter power factor considers both the Q(U)
method and the P(U) method described in Sects. 2.1 and 2.2. Figure 6 shows the
voltage control curves of the Q(U)&P(U) method.
The Q(U)&P(U) method is as effective as the Q (U) method in reducing overvolt-
age at low and medium levels of PV penetration. For high levels of PV penetration,
the Q(U)&P(U) method has the best performance at the expense of active power
reduction from inverters.
3
Illustrative Example
To better understand how the voltage control methods presented in Sect. 2 work, the
short LV feeder shown in Fig. 7 is considered.
This feeder has four residential consumers. For simplicity, it is assumed that all
consumers have the same demand proﬁle, which is shown in Fig. 8a.
Fig. 7 Short LV feeder with four consumers

204
J. Villavicencio et al.
(a) Consumers’ load demand
(b) Power output of 5 kW PV system
Fig. 8 Load demand and PV power generation
3.1
PV Generation
To obtain PV power generation, it is assumed that all residential PV systems have
the same capacity. Since the network under study is a short one, it is considered that
each PV panel receives the same solar irradiance. The considered solar irradiance
proﬁle presents a peak of 0.765 kW/m2. Figure 8b shows the active power generated
by a 5 kW PV system.
3.2
Operational Limits
The bounds of the service voltage in steady-state are assumed Umin = 0.92 p.u. and
Umax = 1.05 p.u. Exceeding values occur if the nodal voltages are between 1.05 and
1.06 p.u., or between 0.87 and 0.92 p.u., for more than 3% of the monitored period
(timespan not necessarily consecutive of 15min in a 24-h measurement). This also
occurs if any voltage is above 1.06 p.u. or below 0.87 p.u., in any 15-min timespan.
3.3
Scenarios Deﬁnition
To identify the inﬂuence caused by the insertion of PV systems and the application
of the local voltage control methods, three cases are considered: Base case, PV case,
and Inverter-control case.
The Base case represents the network without the installation of PV systems.
The tap of the distribution transformer is set to 1.01 p.u. to prevent under-voltage
problems.
In the PV case, the network is analyzed considering PV penetrations (αi%) of
25% and 50% to identify which buses are more sensitive to overvoltage. PV inverters

Inverter-Based Local Control Methods …
205
operate with a unity power factor, and the distribution transformer presents the same
transformer tap setup mentioned above.
In the Inverter-control case, inverters are set according to any of the presented
voltage control methods. These set take into account the minimum value of inverter
power factor (0.95) established for the distribution system operator and the recom-
mendationgivenbytheIEEE1547standard.Tobetterevaluatetheperformanceofthe
voltage control methods, the participation of PV inverters during voltage regulation
is only taken into account for αi% = 25%, 50%, 75% and 100%.
3.4
Voltage Impact Caused by PV Generation
Figure 9 shows the voltage proﬁle at buses 1 and 4 for the Base and PV cases.
Figure 9a, b are results for bus 1, whereas Fig. 9c, d for bus 4.
When comparing voltages of the PV and Base case, it is observed that the voltage
rise is higher when PV is located at the end of the network (Fig. 9c, d) than when
(a) PV system at bus 1
(b) PV system at buses 1 and 2
(c) PV system at bus 4
(d) PV system at buses 3 and 4
Fig. 9 Voltage proﬁle

206
J. Villavicencio et al.
it is located at the beginning of the network (Fig. 9a, b). Voltage changes related to
the Base case occur at hours with power generation. Higher voltage increases are
observed at hours of high power generation (from 11 am to 2 pm). This voltage rise
behavior is in accordance with results found in the specialized literature.
3.5
Voltage Increase Mitigation Using Inverters
In Sect. 3.4 it was concluded that bus 4 presents the highest voltage increase. There-
fore, the voltage analysis of this subsection focuses on bus 4. The setting parameters
of the voltage control methods were set considering recommendations given by
IEEE-1547 [16] and the minimum value of inverter power factor (0.95) established
for the distribution system operator. The considered values of these parameters are
indicated in Table 1.
Figure 10 shows the voltage proﬁle at bus 4 around noon considering the appli-
cation of the voltage control methods described in Sect. 2.
The horizontal red line in Fig. 10 represents the upper voltage limit. The P(U)
method is not activated for αi = 25% of PV penetration since the voltage at bus 4
does not surpass 1.05 p.u. Only the Q(U), Q(P) and Q(U)&P(U) methods eliminate
the overvoltage at bus 4 when α = 50%. With α = 50%, the cosϕ(P) method only
fails to mitigate the overvoltage at t = 12 h.
From αi = 25% to αi = 75%, the Q(U) and Q(U)&P(U) methods present the
same performance to mitigate overvoltage. the order of better performance to miti-
gate the overvoltage is: (i) Q(U)&P(U) method, (ii) Q(U) method, (iii) Q(P) method,
(iv) P(U) method and (v) cosϕ(P) method. When αi = 100%, all control meth-
ods fail to eliminate the overvoltage. Therefore, utilities must consider the use of
complementary voltage regulation equipment for high levels of PV penetration.
Table 1 Setting parameters of local voltage control methods
Method
U1
U2
P1
P2
U3
U4
pfmin
r
P(U)
–
–
–
–
1.05
1.06
–
0.5
Q(U)
1.02
1.05
–
–
–
–
–
–
Q(P)
–
–
0.5
1.0
–
–
–
–
cosϕ(P)
–
–
0.5
1.0
–
–
0.95
–
Q(U)&P(U)
1.02
1.05
–
–
1.05
1.06
–
0.5

Inverter-Based Local Control Methods …
207
(a)
= 25%
(b)
= 50%
(c)
= 75%
(d)
= 100%
Fig. 10 Voltage proﬁle at bus 4 considering voltage control methods
4
Performance of the Voltage Control Methods
In LV networks, the decision to install PV systems is usually made by consumers;
consequently, the sizes and locations of PV systems are uncertain during the inte-
gration of PV systems into the network. Thus, the effectiveness of voltage control
methods to regulate voltage in the network should be evaluated considering all pos-
sible integration scenarios for PV systems. In extensive networks, the number of
possible scenarios is large and the evaluation considering all the PV systems’ inte-
gration scenarios can become impractical [34]. To address this issue, the Monte Carlo
simulation is used to create a number of scenarios, N, lower than the total number
of possible PV systems’ integration scenarios. Several deﬁnitions of PV penetration
have been found in the specialized literature [35]. In this way, the PV penetration
(α) is considered as the ratio between the number of consumers with PV systems
and the total number of consumers connected to a network. Since more than one PV
integration scenario can take place at a speciﬁc level of PV penetration (αi%), the
performance of the voltage control methods at a speciﬁc level of PV penetration is
determined in terms of the probability of overvoltage using (5).

208
J. Villavicencio et al.
P(UM >= Umax | α = αi%) = nU
N
(5)
In (5), UM is the voltage (p.u) at the bus with the highest voltage. Umax is the
upper bound of the allowable voltage range (p.u.), while αi% is the level of PV
penetration. The number of scenarios with overvoltage is represented by nU. The
criterion for determining N is that the probability calculated using this value presents
small changes compared to the probabilities obtained with higher numbers scenarios.
The proposed method performs well at a speciﬁc level of PV penetration if the
probabilities calculated using (5), respectively, are lower than 5%. This tolerance is
commonly used in statistical analysis to make an inference from a sample [36], that
is, the set of N PV system integration scenarios.
5
Application Study
The estimate of the PV potential per sub-areas of a Brazilian city is carried out by
[37]. Here, an LV feeder located in the subarea with the highest PV potential is
analyzed. Figure 11 shows the single-line diagram of the selected feeder which is
an LV feeder with three phases of four wires (3F + N). Three-phase, 11.4 kV / 220-
127 V distribution transformer of 45 kVA couples the selected LV network to the
medium-voltage network. The steady-state service voltage limits, established by the
regulatory agency, are Umin = 0.92 and Umax = 1.05 [26]. Exceeding values occur
if the nodal voltages are between 1.05 and 1.06 p.u., or between 0.87 and 0.92 p.u.,
for more than 3% of the monitored period (timespan not necessarily consecutive of
15 min in a 24-h measurement). This also occurs if any voltage is above 1.06 p.u. or
below 0.87 p.u., in any 15-min timespan.
The selected network presents eight splices, which are joined by three-phase con-
ductors of 95 mm2. The distance between two adjacent splices is 40 m. In total, there
Fig. 11 LV network under analysis

Inverter-Based Local Control Methods …
209
(a) Consumers’ load demand
(b) Power output of PV systems
Fig. 12 Load demand and PV power generation
are 30 residential consumers located in nodes, as shown in Fig. 11. The consumer
nodes are connected to the network using one phase and a neutral conductor (1F +
N) of 35 mm2. The distance between a splice and a consumer node is 20 m.
There are four types of residential consumers: A, B, C and D, which load demand
is shown in Fig. 12a. These consumers were classiﬁed following the methodology
presented in [38] and using measurements of monthly energy consumption. A power
factor equal to 0.95 is assumed for each consumer’s demand.
Statistics of installed PV systems’ capacities in the study city [39] are consid-
ered during the generation of PV systems’ integration scenarios. The most common
installed capacities in this subarea are between 2 kW and 6 kW. Additionally, dur-
ing the selection of PV system capacities, it is taken into account that consumers
cannot install PV systems with capacities higher than their contracted power [40].
Local data of solar radiation and temperature [41], as well as the model presented in
[33], integrates the simulation of power generation by assuming all PV systems are
subjected to the same weather conditions. The power output of the considered PV
systems are shown in Fig. 12b.
Three study cases are conducted: Base case, PV case and Inverter-control case,
which are similar to those described in section Sect. 3.3. The difference corresponds
to the levels of PV penetration analyzed in this section. In the PV case, only PV
penetration levels from 10% to 60% are considered. This consideration is based on
the low performance of the voltage control methods observed in Sect. 3.5 for higher
levels of PV penetration. In the Inverter-control case, the P(U) method was excluded
due to its low performance to mitigate the overvoltage. Therefore, in the Inverter-
control case are considered the following voltage control methods are: Q(U), Q(P),
cosϕ(P) and the Q(U)&P(U). In addition, in this section, the same inverter settings
indicated in Table 1 of Sect. 3.5 are considered.
Due to uncertainties in the locations and capacities of PV systems during their
integration into the network, 200 PV systems integration scenarios are considered at
each level of PV penetration to study the cases. For each scenario, power ﬂows are
performed to obtain voltage proﬁles at all consumers’ nodes. Then, the probability
of overvoltage is computed according to (5). Consideration of a larger number of

210
J. Villavicencio et al.
scenarios results in probabilities that present small changes (less than 1%) for the
network under analysis.
Power ﬂows are carried out to simulate real-time network operation during the
application of voltage control methods in each scenario. Due to data availability,
power ﬂows are conducted with a one-hour resolution.
5.1
Voltage Analysis
The probability of overvoltage at all nodes with αi = 20% and 30% is shown in
Fig. 13. These probabilities are calculated using (5) and represent the percentage of
scenarios in which each node has an overvoltage problem.
With αi%=20%, the probabilities of overvoltage are low occurring in few nodes.
The number of nodes with overvoltage increases when αi = 30%. In Fig. 13, it is
observed that the overvoltage problem from the PV generation is more common to
nodes located at the end of the feeders (e.g., nodes #14 and #15) than those located
close to the transformer (e.g., nodes #1 and #2).
The hourly voltage proﬁle at node #14 in the Base case and in the PV case with
αi = 10% up to 60% is shown in Fig. 14. Each solid green curve represents the
voltage proﬁle at node #14 in one of the 200 simulated scenarios.
In the Base case, there is no voltage problem at node #14. There is a margin
between the voltage proﬁle and the allowable voltage range (0.92 p.u. and 1.05 p.u.).
Therefore, the transformer tap setup ensures the voltage quality against possible
voltage ﬂuctuation in the medium-voltage. Figure 14 shows that the voltage at node
#14 with αi = 20% exceeds the upper voltage limit at 12 h. However, the overvoltage
lasts 6 h (from 10 to 16 h) in one of the simulated scenarios for αi = 50%. This
results in an overvoltage duration index of 27%, which is higher than the limit of 3%
Fig. 13 Probability of overvoltage of nodes in the PV case

Inverter-Based Local Control Methods …
211
(a) Voltage proﬁle at node #14
(b) Voltage proﬁle at node #14
(c) Voltage proﬁle at node #14
Fig. 14 Hourly voltage proﬁles at node #14 in the Base and in the PV cases

212
J. Villavicencio et al.
established by the regulatory agency [26]. The utility must be monetarily charged if
no voltage control actions are taken.
The hourly voltage proﬁle at node #14 in the Base case and in the Inverter-control
case considering the voltage control methods for αi = 30% and 50% is shown in
Fig. 15. Each black curve represents the voltage proﬁle at node #14 in one of the 200
simulated scenarios.
Figure 15 shows that except for the cosϕ (P) method, all other voltage control
methods properly mitigate overvoltage when αi = 30%. With αi = 50%, the over-
voltage lasts 5 h (from 10 to 15 h) when the cosϕ(P) method is applied. This results
in an overvoltage duration index of 22%, which is higher than the limit of 3% estab-
lished by the regulatory agency [26]. For the other voltage control methods, the
overvoltage lasts 1 or 2 h in few scenarios when αi = 50%, being the Q(U)&P(U)
method which present the best performance.
Figure 16 shows the probability of overvoltage after the application of the voltage
control methods. The probability of overvoltage in the PV case is included as well.
The node with the highest probability of overvoltage (node #14) is analyzed for each
level of PV penetration. The probability of overvoltage is calculated using (5) and a
tolerance of 5% is assumed based on Sect. 4.
In Fig. 16, the PV hosting capacity of the network is 25% in the PV case. The
application of the cosϕ(P) method is able to improve the PV hosting capacity of
the network up to 35%. The application of the Q(P) method improves the PV host-
ing capacity of the network up to 55%, whereas the application of the Q(U) and
Q(U)&P(U) methods enhances the PV hosting capacity of the network up to 56%
and 57%, respectively. Therefore, the Q(P), Q(U) and Q(U)&P(U) method relieve
power capacity allowing the installation of more PV systems in the network with a
probability of overvoltage lower than 5%.
Since the application of the Q(U), Q(P), cosϕ(P) or Q(U)&P(U) method is based
on the use of reactive power or active power, it is important to know how it impacts
on network’s operation efﬁciency. In the next subsection, the active losses of the lines
are calculated considering αi = 50%.
5.2
Lines’ Active Losses
Lines’ losses in the network depend on the power ﬂow through the lines. Therefore,
these losses should change when the Q(U), Q(P), cosϕ(P) or Q(U)&P(U) method is
applied, since these methods are based on reactive or active power. Figure 17 shows
the average values of lines’ active losses in the Base case, PV case and when the
voltage control methods are applied.
Active losses in the network increase when inverters operate with a unity power
factor in the PV case. The application of the voltage control methods increases still
more these losses. The Q(P) method results in the highest values of daily active losses
followed by the Q(U) and Q(U)&P(U) methods. The application of the cosϕ(P)
method results in the lowest active losses compared to the other methods. Losses

Inverter-Based Local Control Methods …
213
(a) Voltage proﬁle at node #14
(b) Voltage proﬁle at node #14
(c) Voltage proﬁle at node #14
(d) Voltage proﬁle at node #14
(e) Voltage proﬁle at node #14
(f) Voltage proﬁle at node #14
(g) Voltage proﬁle at node #14
(h) Voltage proﬁle at node #14
Fig. 15 Hourly Voltage proﬁle at bus 14 considering voltage control methods

214
J. Villavicencio et al.
Fig. 16 Overvoltage probabilities of the voltage control methods
Fig. 17 Average of active losses of lines with α = 50%
increase in hours of high generation (11 h to 15 h) and decrease in hours of low
generation (from 7h to 9h and from 16h to 19h) compared to the Base case.
Daily lines’ active losses in the Base case are 3.81 kWh. In the PV case, losses
are 141% of the Base case. When Q(U), Q(P), cosϕ(P) or Q(U)&P(U) are applied,
losses are 159%, 157%, 145% and 159% of the Base case, respectively. The cosϕ(P)
method results in lower daily lines’ active losses.
A comparison between Figs. 16 and 17 shows that the evaluation of control meth-
ods solely based on voltage mitigation effectiveness can hide other negative aspects.
For example, in Fig. 16 it was observed in Fig. 16 that the Q(U) and Q(U)&P(U)
methods present a better performance for voltage mitigation. However, according to
Fig. 17, these methods result in higher lines’ active losses.

Inverter-Based Local Control Methods …
215
Fig. 18 Expected value of power factor at the input of the feeder
5.3
Power Factor at the Beginning of the Feeder
During the calculation of losses in medium-voltage networks, Brazilian utilities gen-
erally assume that distribution transformers operate with power factors equal to or
above 0.92. Therefore, it is important to know how the transformer’s power fac-
tor changes when PV systems are connected to LV networks. Figure 18 shows the
expected value of the power factor at the beginning of the feeder.
In the Base case, the power factor is around 0.94. In the PV case and the Inverter-
control case, the power factor decreases in the periods from 6 h to 11 h and from 15
h to 19 h. However, in the PV case, the power factor is improved from 11 h to 15 h,
while in the Inverter-control case, the power factor is even further reduced.
Moreover, notice that for all methods, there are two instants (at hours 9 and 16) at
which the power factor reaches really low values (around 0.4). The explanation for
these low values is because in those hours, demand and generated active power have
similar values. Thus, most of the active power from the network to the buses with PV
systems is nearly zero while the reactive power has little change, which results in low
values of power factors. However, as active power generation increases and demand
remains relatively low (e.g. between hours 11 and 15), the power factor improves.
Notice that this section is related to the power factor at the input of the feeder and not
to the power factor of inverters. For each inverter, the proposed method guarantees
its operation within the allowable limits (above 0.95).
5.4
Transformer Loading
The expected value of the transformer loading is shown in Fig. 19. It is observed that
there is no transformer overloading in the Base case. Moreover, transformer loading
presents similar behavior that lines’ active losses in the PV and Inverter-control cases.

216
J. Villavicencio et al.
Fig. 19 Expected value of transformer loading
It is essential to mention that Fig. 19 only indicates the expected value of the trans-
former loading and not the actual value observed in each scenario. Therefore, there
are scenarios where the transformer loading is below or above this expected value.
The results obtained indicate that up to αi = 60%, the application of the voltage
control methods do not result in any scenario with transformer overloading between
100% and 120%, except for the Q(P) method. This method presents 28 scenarios
with transformer overload. Therefore, assuming a 5% of tolerance to the proba-
bility of overvoltage, the Q(U) and Q(U)&P(U) methods will have a good perfor-
mance to mitigate the overvoltage for αi = 55% (see Fig. 16) without overloading the
transformer.
6
Conclusion
Inverters can be employed for mitigating overvoltage caused by PV generation. Due
to uncertainties in the location and sizes of PV systems, several scenarios of PV
integration should be considered in planning studies.
The results obtained from the application to a Brazilian LV network with only
residential consumers indicate that the Q(U) and Q(U)&P(U) methods provide better
voltage regulation than similar local voltage control methods. As consequence, it
enables higher levels of PV penetration in the network.
It was observed that at low levels of PV penetration, the Q(P) method needlessly
absorbs excessive reactive power to mitigate the overvoltage, which resulted in higher
active losses, lower values of power factor at the input of the feeder, and a higher
number of scenarios with transformer overloading.
Daily lines’ active losses in the network under study are higher in the PV case
than in the Base case. However, an increase or a reduction of active lines losses could
occur depending on demand and generation characteristics.

Inverter-Based Local Control Methods …
217
For networks with other allowable voltage ranges, other values should be used for
the setting of the inverter parameters to obtain proper voltage regulation.
Acknowledgements This study was ﬁnanced by Programa de Incentivos a las Publicaciones Cien-
tíﬁcas de la Universidad Tecnológica del Perú; by Coordenação de Aperfeiçoamento de Pessoal
de Nível Superior - Brazil (CAPES) - Finance Code 001; by São Paulo Research Foundation -
Brazil (FAPESP) under grants:2015/21972-6, 2019/00466-6 and no 2021/08832-1; by Conselho
Nacional de Desenvolvimento Cientíﬁco e Tecnológico - Brazil (CNPq) undergrant: 422044/2018-
0, 310299/2020-9 and 408898/2021-6; by Instituto Nacional de Ciência e Tecnologia de Energia
Elétrica - Brazil (INCT-INERGE); and by ENEL undergrant: APLPEE-00390-1062/2017 - P&D-
00390-1083-2020_UFABC. The authors also thank the Consejo Nacional de Ciencia, Tecnología
e Innovación Tecnológica - Peru (CONCYTEC) for the access to papers published in international
journals.
References
1. International Energy Agency - IEA (2022) Snapshot of Global PV Markets - 2022. www.iea-
pvps.org
2. Torquato R et al (2018) A comprehensive assessment of PV hosting capacity on low-voltage
distribution systems. IEEE Trans Power Deliv 33(2):1002–1012
3. Sergio Chacon Camargos R, Amaral Shayani R, Aurélio Gonçalves de Oliveira M (2019)
Evaluation whether photovoltaic distributed generation postpones or anticipates reinforcements
detected by distribution network expansion planning. IET Gener Transm Distrib 13(7):1036–
1048
4. Correa HP, Vieira FHT, Negrete LPG (2022) Double pilot node decentralized voltage control
of PV generators via droop- type optimization-free reactive support. IEEE Access 10:109476–
109487. issn: 2169-3536. https://doi.org/10.1109/ACCESS.2022.3214520. https://ieeexplore.
ieee.org/document/9919181/
5. Fu A, Cvetkovic M, Palensky P (2022) Distributed cooperation for voltage regulation in future
distribution networks. IEEE Trans Smart Grid 13:4483–4493. issn: 1949-3053. https://doi.org/
10.1109/TSG.2022.3191389. https://ieeexplore.ieee.org/document/9830781/
6. Procopiou AT, Ochoa LF (2017) Voltage control in PV-rich LV networks without remote
monitoring. IEEE Trans Power Syst 32:1224–1236. issn: 0885-8950. https://doi.org/10.1109/
TPWRS.2016.2591063. http://ieeexplore.ieee.org/document/7514939/
7. Aziz T, Ketjoy N (2017) Enhancing PV penetration in LV networks using reactive power control
and on load tap changer with existing transformers. IEEE Access 6:2683–2691
8. Fortenbacher P, Mathieu JL, Andersson G (2017) Modeling and optimal operation of distributed
battery storage in low voltage grids. IEEE Trans Power Syst 32(6):4340–4350
9. Zeraati M, Esmail Hamedani Golshan M, Guerrero JM (2018) Distributed control of battery
energy storage systems for voltage regulation in distribution networks with high PV penetration.
IEEE Trans Smart Grid 9:3582–3593. issn: 1949-3053. https://doi.org/10.1109/TSG.2016.
2636217. https://ieeexplore.ieee.org/document/7775016/
10. Nousdilis AI, Christoforidis GC, Papagiannis GK (2018) Active power management in low
voltage networks with high photovoltaics penetration based on prosumers’ self-consumption.
Appl Energy 229:614–624. issn: 03062619. https://doi.org/10.1016/j.apenergy.2018.08.032.
https://linkinghub.elsevier.com/retrieve/pii/S0306261918311875
11. Zhang Z et al (2019) Advanced control strategies for back-to-back power converter PMSG
wind turbine systems. In: 2019 ieee international symposium on predictive control of electrical
drives and power electronics (PRECEDE), pp 1–6

218
J. Villavicencio et al.
12. Manbachi M et al (2017) Smart grid adaptive volt-VAR optimization: challenges for sustainable
future grids. Sustain Cities Soc 28:242–255. issn: 22106707. https://doi.org/10.1016/j.scs.
2016.09.014. https://linkinghub.elsevier.com/retrieve/pii/S2210670716304103
13. Satsangi S, Kumbhar GB (2017) Review on volt/VAr optimization and control in electric
distribution system. Inst Electr Electron Eng Inc. isbn: 9781467385879. https://doi.org/10.
1109/ICPEICES.2016.7853324
14. Maitra A et al (2017) DMS advanced applications for accommodating high penetrations of
DERs and microgrids. Inst Eng Technol 2017:2236–2240. https://doi.org/10.1049/oap-cired.
2017.1321
15. Hashemi S, Ostergaard J (2017) Methods and strategies for overvoltage prevention in low
voltage distribution systems with PV. IET Renew Power Gener 11:205–214. issn: 1752-1416.
https://doi.org/10.1049/iet-rpg.2016.0277. http://digitallibrary.theiet.org/content/journals/10.
1049/iet-rpg.2016.0277
16. IEEE 1547-2018 (2018) Standard for interconnection and interoperability of distributed energy
resources with associated electric power systems interfaces. https://doi.org/10.1109/IEEESTD.
2018.8332112
17. IEEE Power Energy Society (2018) Getting it all in the mix. https://www.ieee-pes.org/
18. Cavraro G, Carli R (2018) Local and distributed voltage control algorithms in distribution
networks. IEEE Trans Power Syst 33:1420–1430. issn: 0885-8950. https://doi.org/10.1109/
TPWRS.2017.2731682. http://ieeexplore.ieee.org/document/7993084/
19. Zeraati M, Esmail Hamedani Golshan M, Guerrero JM (2018) Voltage quality improvement in
low voltage distribution networks using reactive power capability of single-phase PV inverters.
IEEE Trans Smart Grid 10(5):5057–5065
20. O’Connell A, Keane A (2017) Volt-var curves for photovoltaic inverters in distribution systems.
IET Gener Transm Distrib 11:730–739. issn: 1751-8687. https://doi.org/10.1049/ietgtd.2016.
0409. http://digital-library.theiet.org/content/journals/10.1049/iet-gtd.2016.0409
21. Antoniadou-Plytaria KE et al (2017) Distributed and decentralized voltage control of smart
distribution networks. IEEE Trans Smart Grid 8:2999–3008. issn: 1949-3053. https://doi.org/
10.1109/TSG.2017.2679238
22. Ahmed A-S et al (2022) Analysis of voltage and reactive power algorithms in low voltage
networks. https://doi.org/10.3390/en15051843
23. Pukhrem S et al (2017) Enhanced network voltage management techniques under the prolif-
eration of rooftop solar PV installation in low- voltage distribution network. IEEE J Emerg
Sel Top Power Electron 5:681–694. issn: 2168-6777. https://doi.org/10.1109/JESTPE.2016.
2614986. http://ieeexplore.ieee.org/document/7590095/
24. Wang Y et al (2019) Decentralised-distributed hybrid voltage regulation of power distribution
networks based on power inverters IET Gener Transm Distrib 13:444–451. issn: 17518687.
https://doi.org/10.1049/iet-gtd.2018.5428
25. Balram P, Carlson O et al (2018) Comparative study of MPC based coordinated voltage control
in LV distribution systems with photovoltaics and battery storage. Int J Electr Power Energy
Syst 95:227–238
26. AgênciaNacional de Energia Elétrica - ANEEL (2021) Procedimentos de Distribuição de Ener-
gia Elétrica no Sistema Elétrico Nacional - Módulo 8 - Qualidade da Energia Elétrica. Agência
Nacional de Energia Elétrica (ANEEL)
27. Ministerio de Energí y Minas - MINEM. Norma Técnica de Calidad de los Servicios Eléctricos.
http://www.minem.gob.pe/minem/archivos/ﬁle/electricidad/legislacion/ds020-97-em.PDF
28. Tonkoski R, Lopes LAC, El-Fouly THM (2010) Coordinated active power curtailment of grid
connected PV inverters for overvoltage prevention. IEEE Trans Sustain Energy 2(2):139–147
29. Agência Nacional de Energia Elétrica - ANEEL (2015) Resolução Normativa no 687 de 2015.
http://www2.aneel.gov.br/cedoc/bren2012482.pdf
30. Ghosh S, Rahman S, Pipattanasomporn M (2016) Distribution voltage regulation through active
power curtailment with PV inverters and solar generation forecasts. IEEE Trans Sustain Energy
8(1):13–22

Inverter-Based Local Control Methods …
219
31. Zhang C et al (2017) Three-stage robust inverter-based voltage/var control for distribution
networks with high-level PV. IEEE Trans Smart Grid 10(1):782–793
32. Safayet A, Fajri P, Husain I (2017) Reactive power management for overvoltage prevention at
high PV penetration in a low-voltage distribution system. IEEE Trans Ind Appl 53(6):5786–
5794
33. Radatz P et al (2020) Open DSS PV system and Inv control element models. Electric power
research institute - EPRI, p 30. http://svn.code.sf.net/p/electricdss/code/trunk/Distrib/Doc/
34. Dubey A, Santoso S (2017) On estimation and sensitivity analysis of distribution circuit’s
photovoltaic hosting capacity. IEEE Trans Power Syst 32:2779–2789. issn: 08858950. https://
doi.org/10.1109/TPWRS.2016.2622286
35. Aziz T, Ketjoy N (2017) PV penetration limits in low voltage networks and voltage varia-
tions. IEEE Access 5:16784–16792. issn: 21693536. https://doi.org/10.1109/ACCESS.2017.
2747086
36. Held L, Sabanés Bové D (2014) Applied statistical inference: likelihood and bayes, vol
9783642378, pp 1-376. isbn: 9783642378874. https://doi.org/10.1007/978-3-642-37887-4
37. Villavicencio Gastelu J, David Melo Trujillo J, Padilha- Feltrin A (2018) Hierarchical Bayesian
model for estimating spatial-temporal photovoltaic potential in residential areas. IEEE Trans
Sustain Energy 9:971–979. issn: 1949-3029. https://doi.org/10.1109/TSTE.2017.2768824.
http://ieeexplore.ieee.org/document/8093694/
38. Jardini JA et al (2002) Daily load proﬁles for residential, commercial and industrial low voltage
consumers. IEEE Trans Power Deliv 15:375–380. issn: 08858977. https://doi.org/10.1109/61.
847276
39. Agência Nacional de Energia Elétrica - ANEEL (2019) Geração distribuída. http://www2.
aneel.gov.br/scg/gd/GD_Estadual.asp
40. Agência Nacional de Energia Elétrica - ANEEL (2012) Resolução normativa No 482, de 17
DE abril de 2012. http://www2.aneel.gov.br/cedoc/bren2012482.pdf
41. Instituto Nacional de Meteorologia - INMET (2018) Estações Automáticas. http://www.inmet.
gov.br/portal/index.php?r=estacoes/estacoesAutomaticas

Variable-Speed-Driven Three-Phase
Surface-Mounted Permanent Magnet
Synchronous Machine Applied to Wind
Generation Systems
José Roberto Bofﬁno de Almeida Monteiro
and Stefan Thiago Cury Alves dos Santos
Abstract Wind generation has been shown to be a suitable alternative source of
energy in the context of smart grids. Among the machines used in wind generation
systems, the permanent magnet synchronous machine (PMSM) stands out for its
high power density, high efﬁciency, absence of rotor windings, among others. This
chapter is dedicated to the study of the variable-speed-driven three-phase surface-
mounted permanent magnet synchronous machine (SMPMSM) applied to power
generation. The machine model is presented in three-phase, stationary orthogonal αβ
and synchronous orthogonal dq coordinate systems, as well as the waveforms of the
backelectromotiveforce(back-EMF)perphaseineachcoordinatesystem.Inthecase
of SMPMSMs with a non-sinusoidal back-EMF waveform, the dqx transformation
is applied in order to reduce the electromagnetic torque ripple. Based on the machine
model inanappropriatereferenceframe, it is possibletodesignadecoupledcontrol of
torque; as an example, the proportional-integral controller is adopted. In addition, to
eliminate the need to use axis angular position sensors or to increase the redundancy,
the concepts of rotor position estimation are introduced, and a strategy presented
is the use of the Kalman ﬁlter together with phase-locked loops. Finally, a study
using data from a real machine, employed in wind turbines, exempliﬁes the concepts
covered in this chapter.
J. R. B. de A. Monteiro (B) · S. T. C. A. Santos
São Carlos School of Engineering, Avenida Trabalhador São-carlense, 400, São Carlos, SP, Brazil
e-mail: jrm@sc.usp.br
S. T. C. A. Santos
e-mail: stefan.santos@usp.br
© The Author(s), under exclusive license to Springer Nature Switzerland AG 2024
A. J. Sguarezi Filho et al. (eds.), Smart Grids—Renewable Energy, Power Electronics,
Signal Processing and Communication Systems Applications, Green Energy
and Technology, https://doi.org/10.1007/978-3-031-37909-3_8
221

222
J. R. B. de A. Monteiro et al.
1
Introduction
In recent years, there has been a growing interest on the part of developed countries
in relation to smart grids [1]. Smart grids can provide more adequate control of
the electricity consumption pattern, provide more security for the system and more
efﬁcient operation, reducing losses. In addition, the great advance in the area of
information technology in smart grids has made possible an uninterrupted supply of
electricity to consumers, and a high level of insertion of distributed generation in the
grid [2]. The insertion of distributed generation contributes to better performance and
more efﬁcient operation of the network. An example is the hybrid solar-wind system
that uses both energy sources and proves to be reliable under different weather and
climatic conditions, since they complement each other, and the weakness of one is
the strength of the other [3, 4].
In the case of wind generation, which is the object of study in this chapter, a turbine
coupled to an electric generator captures the kinetic energy of the winds and converts
it into electrical energy. Based on the turbine’s dimensions and its operating range,
there are different electrical machines that can be applied. The doubly-fed induction
machine is the most commonly employed, however there is an increasing use of the
permanent magnet synchronous machine (PMSM) in which the magnets are mounted
on the surface of the rotor [5]. In the case of the surface-mounted permanent magnet
synchronous machine (SMPMSM), there is no need for excitation, unlike the rotor-
wound synchronous machine and the doubly-fed induction machine, so there is no
need for brushes, which implies maintenance reduction.
Variable-speed-driven SMPMSMs applied to wind generation systems require
full converters [6]. A very common structure consists of the use of two two-level
voltage source converters in the back-to-back conﬁguration, with capacitors in the
DC link. Such conﬁguration allows independent control of amplitude and frequency
in both three-phase terminals, allowing the machine variable speed drive (through
the Machine-Side Converter - MSC) and power delivery to the electrical network
(through the Grid-Side Converter - GSC). Figure 1 exempliﬁes the back-to-back
converter structure applied to wind power generation systems with SMPMSMs.
This chapter aims to develop a theoretical base for applying SMPMSMs in wind
power generation systems, and thereafter, applies this theory to a power genera-
tion system tested with computational simulation. By the end of this chapter, the
reader should be able to understand the SMPMSM modeling and the implications of
choosing the reference frame on the control of the machine and its operation. Brief
considerations on rotor position estimation and connection to the electrical grid are
also presented.

Variable-Speed-Driven Three-Phase Surface-Mounted …
223
Fig. 1 Wind power generation system with SMPMSM and back-to-back converter
2
Three-Phase Surface-Mounted Permanent Magnet
Synchronous Machine Modeling
The mathematical model of the SMPMSM is necessary for studying the operation
and control of this machine. Unless otherwise stated, the following theoretical con-
siderations in this Section are based on [7], where some hypotheses are considered:
1. Reluctance variations due to the rotor position are negligible.
2. The magnetic and electrical properties of the used materials are linear.
3. There is symmetry between the phases of the machine; counter-electromotive
forces (back-EMFs), resistances, self-inductances, and mutual inductances per
phase are equal to each other.
The electrical equations of a wie-connected SMPMSM is:
⎡
⎣
vm,a
vm,b
vm,c
⎤
⎦= Rs
⎡
⎣
im,a
im,b
im,c
⎤
⎦+
⎡
⎣
Ls Ms Ms
Ms Ls Ms
Ms Ms Ls
⎤
⎦d
dt
⎡
⎣
im,a
im,b
im,c
⎤
⎦+
⎡
⎣
ea
eb
ec
⎤
⎦+
⎡
⎣
vm,n
vm,n
vm,n
⎤
⎦,
(1)
where vm,a, vm,b, vm,c are the phase terminal voltages; im,a, im,b, im,c are the stator
phase currents; ea, eb, ec are the back-EMFs; vm,n is the voltage of the stator neutral
terminal; Rs is the stator resistance; Ls is the stator auto-inductance; and Ms is the
mutual inductance between two stator phases. The deduction of this model is in [7].
The counter-electromotive forces per phase, induced when there is movement in
the machine rotor, are the result of the interaction between the ﬁeld generated by the
rotor magnets and the stator windings, ra, rb, rc. It is noteworthy that ra, rb,
rc are function of the rotor position:

224
J. R. B. de A. Monteiro et al.
⎡
⎣
ea
eb
ec
⎤
⎦= d
dt
⎡
⎣
ra
rb
rc
⎤
⎦=
d
dθe
⎡
⎣
ra
rb
rc
⎤
⎦dθr
dt .
(2)
However, the time derivative of θe equals the machine electrical frequency ωe.
Furthermore, one can deﬁne
d
dθe
⎡
⎣
ra
rb
rc
⎤
⎦=
⎡
⎣
′
ra
′
rb
′
rc
⎤
⎦= m
⎡
⎣
Fa
Fb
Fc
⎤
⎦,
(3)
so that the back-EMF can be described as
⎡
⎣
ea
eb
ec
⎤
⎦= ωem
⎡
⎣
Fa
Fb
Fc
⎤
⎦,
(4)
where Fa, Fb, Fc are the normalized back-EMF waveforms,whose amplitude is uni-
tary; and m is the back-EMF amplitude normalized by the machine electrical fre-
quency.
Finally, being n p the number of pole pairs of the SMPMSM, the electromagnetic
torque developed by the machine is:
Tel = n pm

Faim,a + Fbim,b + Fcim,c

.
(5)
The back-EMF waveform has signiﬁcant impact on machine operation and con-
trol. The two most common back-EMF waveforms are sinusoidal and trapezoidal,
which will be discussed next.
SMPMSM with sinusoidal back-EMF The normalized ideal sinusoidal back-EMF
waveforms are presented in Fig. 2, and is deﬁned as:
Fa = −sin θe
Fb = −sin (θe −2π/3)
(6)
Fc = −sin (θe + 2π/3).
SMPMSM with non-sinusoidal back-EMF Non-sinusoidal back-EMF waveforms
are usually modeled and represented as ideal trapezoidal signals with ﬂat top regions
of 120 degrees or 2π/3 rad, as depicted in Fig. 3. The normalized ideal trapezoidal
back-EMF per phase is described as:
Fa = −trap120θe
Fb = −trap120(θe −2π/3)
(7)
Fc = −trap120(θe + 2π/3).

Variable-Speed-Driven Three-Phase Surface-Mounted …
225
Fig. 2 Sinusoidal back-EMF waveform
Fig. 3 Trapezoidal back-EMF waveform
However, any non-sinusoidal back-EMF waveforms are possible in real machines
and can be considered, not only the ideal trapezoidal signal.
2.1
SMPMSM Modeling in Stationary Orthogonal Reference
Frame
A common strategy to reduce model complexity is to change its reference frame [8].
In electrical systems, it is usual to look for orthogonal references to the detriment
of the three-phase reference: taking into account the mathematical principles that
surround electrical engineering, the three-phase values of electrical machines can
be expressed with complex vectors, which can be represented in a Cartesian system
to express the physical relationships of the machine [9]. The electrical variables in

226
J. R. B. de A. Monteiro et al.
Fig. 4 Graphical
representation of the
stationary orthogonal
reference frame (αβ) along
with the three-phase axes [7]
orthogonal reference frames are 90 degrees from each other instead of 120 degrees
as in the three-phase notation.
Arbitrary three-phase values can be described on a stationary orthogonal reference
frame xα, xβ, x0, as depicted in Fig. 4. For this, it is used the αβ transformation.
There are two major variations of such transformation: the amplitude-invariant, also
known as the Clarke transformation [10], and the power-invariant transformation,
also known as Concordia transformation [11], which will be adopted in this chapter:
xαβ =

2
3
	1 e j2π/3 e−j2π/3
⎡
⎣
xa
xb
xc
⎤
⎦
(8a)
x0 =
√
3
3
	1
1
1
⎡
⎣
xa
xb
xc
⎤
⎦,
(8b)
where j is the complex operator and xαβ = xα + jxβ is the vector representation of
x in the αβ axes. Therefore, the SMPMSM model in stationary orthogonal reference
frame is deduced by applying the transformation (8) to (1):
vm,αβ = Rsim,αβ + (Ls −Ms) dim,αβ
dt
+ ωemFαβ
(9a)
vm,0 = Rsim,0 + (Ls + 2Ms) dim,0
dt
+ ωem F0 +
√
3vm,n.
(9b)
Similarly, the electromagnetic torque developed by the machine, from (5), is
described as:
Tel = n pm

Fαim,α + Fβim,β + F0im,0

.
(10)

Variable-Speed-Driven Three-Phase Surface-Mounted …
227
Fig. 5 Back-EMF waveforms in stationary reference frame
Figure 5 shows the back-EMF waveforms in stationary reference frame for both
sinusoidal (a) and trapezoidal (b) back-EMF waveforms. The forms kept similarity,
in the α and β axes, concerning the waveforms in the three-phase reference frame.
However, there is no zero component for the sinusoidal back-EMF, while there is a
zero component for the trapezoidal back-EMF. As a consequence, if the zero compo-
nent of the current is controlled, it is possible to increase the electromagnetic torque
delivered by the SMPMSM with trapezoidal back-EMF, according to (10). The draw-
back is the need in controlling the neutral current, which will not be considered in
this chapter.
The α and β components of the back-EMF waveforms can be plotted parametri-
cally (Fig. 6). The sinusoidal back-EMF waveform generates a circle with a radius
Fig. 6 Parametric plot of back-EMF waveforms in stationary reference frame

228
J. R. B. de A. Monteiro et al.
of √3/2, and the trapezoidal back-EMF waveform generates a regular hexagon of
side 2√2/3.
2.2
SMPMSM Modeling in Synchronous Orthogonal
Reference Frame
A way to simplify the control of electrical machines is to deﬁne a reference frame
where electrical variables are described as DC components. It is also convenient
to equate the electromagnetic torque as a function of only one current component,
which favors the developing of a desired electromagnetic torque with minimum stator
current and, consequently, facilitates the controller design.
The vector xαβ in a stationary orthogonal reference frame can be depicted on a
synchronous reference frame aligned to the rotor electric angle θ = θe, as shown in
Fig. 7, through the rotation of the reference frame at the arbitrary angular velocity
of the machine electrical frequency [8]:
xdq = e−jθxαβ,
(11)
where xdq = xd + jxq is the vector representation of x in the dq axes. Therefore, the
SMPMSM model in synchronous orthogonal reference frame is deduced by applying
the transformation (11) to (9a):
vm,dq = Rsim,dq + (Ls −Ms) dim,dq
dt
+ ωemFdq.
(12)
Likewise, one can depict the electromagnetic torque developed by the machine as
Tel = n pm

Fdim,d + Fqim,q

.
(13)
Figure 8 shows the back-EMF waveforms on the synchronous reference frame.
For the sinusoidal back-EMF waveform, both Fd and Fq are constants, with Fd = 0
and Fq = √3/2. Thus, the synchronous orthogonal reference frame is sufﬁcient to
Fig. 7 Graphical
representation of the
synchronous orthogonal
reference frame (dq) along
with the stationary
orthogonal reference frame
(αβ) [7]

Variable-Speed-Driven Three-Phase Surface-Mounted …
229
Fig. 8 Back-EMF waveforms in synchronous reference frame
describe the SMPMSM model with sinusoidal back-EMF so that the electromagnetic
torque is solely dependent on the quadrature component of the stator current:
Tel = n pm

3
2im,q.
(14)
However, for the SMPMSM with trapezoidal back-EMF waveform, Fd and Fq are
not constants, so it is necessary to deﬁne a new reference frame that allows the torque
modeling as directly proportional to one of the current components so that a constant
current reference in such frame leads to a ripple-free electromagnetic torque.
2.3
The dqx Transformation for SMPMSM With
Non-sinusoidal Back-EMF
The dqx transformation is graphically presented in Fig. 9, and was proposed for
non-sinusoidal PMSMs. Using this reference frame, it is possible to have a simple
expression of the torque for PMSMs with any back-EMF waveforms [7].
Fig. 9 Graphical
representation of the dqx
reference frame along with
the αβ and dq axes [7]

230
J. R. B. de A. Monteiro et al.
Let a transformation be deﬁned such that:
xdqx = 1
ax
e−jθxxdq,
(15)
where xdqx = xdx + jxqx is the vector representation of x in the dqx axes. By the
appropriate choice of the terms ax and θx, the torque is directly proportional to the
quadrature component of the stator current im,qx. Therefore, the SMPMSM model in
the dqx axes is deduced by applying the transformation (15) to (12):
vm,dqx = Rsim,dqx + (Ls −Ms)
dim,dqx
dt
+ ωeim,dqx
a′
x
ax
+ j(1 + θ′
x)

+ ωemFdqx,
(16)
where a′
x and θ′
x are, respectively, the derivatives of ax and θx with respect to θe.
The electromagnetic torque developed by the machine is described in this refer-
ence frame as:
Tel = n pa2
xm

Fdxim,dx + Fqxim,qx

.
(17)
The dqx transformation presupposes that the electromagnetic torque is directly
proportional to the quadrature component of the stator current, so we can deﬁne,
analogously to the sinusoidal back-EMF:

Fdx = 0
a2
x Fqx =

3
2.
(18)
Based on (11) and (15), the solution for (18) is:
⎧
⎨
⎩
ax =

3
2
1
√
F2α +F2
β
θx = arctan −Fα
Fβ −θe,
(19)
and Fig. 10 shows ax and θx waveforms for an ideal trapezoidal waveform.
Fig. 10 ax and θx as a
function of θe for an ideal
trapezoidal waveform

Variable-Speed-Driven Three-Phase Surface-Mounted …
231
Finally, it is possible to rewrite (16), splitting the direct and quadrature axis terms,
as well as the electromagnetic torque in (17), considering the assumptions about Fdx
and Fqx:
vm,dx = Rsim,dx + (Ls −Ms)
dim,dx
dt
+ ωe
a′
x
ax
im,dx −(1 + θ′
x)im,qx

vm,qx = Rsim,qx + (Ls −Ms)
dim,qx
dt
+ ωe
a′
x
ax
im,qx + (1 + θ′
x)im,dx

(20)
+

3
2m
1
a2x
ωe
Tel = n pm

3
2im,qx.
(21)
3
Vector Control for the SMPMSM
As introduced earlier, choosing appropriate reference frames simpliﬁes the model-
ing and control of the electrical machine: three-phase values can be expressed with
complex vectors. The orientation of a vector reference frame for the design and
control of a certain process is known as vector model-based control, or vector con-
trol for short [9]. Vector control techniques have an important role in AC machine
drives nowadays, including SMPMSM applications. Advantages of vector control
include good dynamic performance, increase in efﬁciency, and torque ripple reduc-
tion, among others [12]. Other techniques can also be used, such as scalar control
and six-step with current control [12–14].
A common vector control structure is the ﬁeld-oriented control, in which the
quadrature axis current acts on the electromagnetic torque, and the direct axis current
acts on the direct axis resultant magnetic ﬂux. Since the rotor ﬂux is deﬁned by
permanent magnets in SMPMSMs, it is usual to control the direct axis current at
zero, i∗
m,d = 0 or i∗
m,dx = 0, in order to reduce the power losses, with the exception
of machine operation in ﬂux strengthening or weakening.
Field-oriented control can be applied to SMPMSMs with sinusoidal back-EMF
waveforms through the dq transformation, on a synchronous reference frame aligned
to the rotor electric angle, as presented in Sect. 2.2. For SMPMSMs with non-
sinusoidal back-EMF waveforms, the dqx transformation, introduced in Sect. 2.3, is
the most suitable choice.
It is possible to add the coupling and compensation terms to the output of the
current controllers, shown in Table 1. This feed-forward strategy leads to less effort
on the control. The coupling and compensation terms on the dq axes are a speciﬁc
case of these terms on the dqx axes with ax = 1, a′
x = 0, and θ′
x = 0. Thereby, Fig. 11
represents the ﬁnal block diagram for the vector control of the SMPMSM in a wind
generation system [7].

232
J. R. B. de A. Monteiro et al.
Table 1 Coupling and compensation terms for the SMPMSM
Terms
dq axes (sinusoidal)
dqx axes (non-sinusoidal)
Direct/quadrature decoupling
j(Ls −Ms)ωeim,dq
j(Ls −Ms)ωeim,dqx (1 + θ′
x)
Back-EMF compensation
j

3
2mωe
j

3
2m 1
a2x ωe
Non-sinusoidal back-EMF
compensation
–
(Ls −Ms)ωeim,dqx
a′
x
ax
Fig. 11 Block diagram for the vector control of the SMPMSM in a wind generation system.
The terms of decoupling (blue), back-EMF compensation (red), and non-sinusoidal back-EMF
compensation (yellow) are highlighted [7]. The abc/dqx transformation blocks use the terms ax
and θx from Fig. 10
3.1
Control Methods for Current Control
Figure 11 depicts the generic current controllers Cim,dx and Cim,qx . Several con-
trol methods can be used, both linear, such as Proportional-Integral (PI) [15]
and Proportional-Integral-Derivative (PID) [12], and non-linear, such as sliding
mode [16], model-predictive control [15] and fuzzy [17]. In this chapter, we chose
the PI controller for both current loop controllers; thanks to its advantages, like
robustness, zero steady-state error for type-0 systems, simple structure, easy digital
implementation, and good transient performance, the PI controller is considered a
consolidated technology [18–20].

Variable-Speed-Driven Three-Phase Surface-Mounted …
233
The structure of the PI controller is based on two components, the proportional
(kP) and the integral (kI) parts. For a continuous-time implementation, they act
directly on the error ϵ(t) = x∗−x(t) of the variable to be controlled x(t):
u(t) = kPϵ(t) + kI
 t
0
ϵ(τ)dτ + u(0),
(22)
where u(t) is the controller output control action and u(0) is the controller output ini-
tial value, usually zero. The discrete-time control law for the PI controller, assuming
ϵ(0) = 0, is
uk = kP(ϵk −ϵk−1) + kI Tsϵk + uk−1,
(23)
where Ts is the sampling time and the superscripts k and k −1 refers to the current
signal value and its previous value in the last time sampling, respectively. It was used
the backward Euler method.
4
Rotor Position Estimation of SMPMSM
The application of control techniques to the SMPMSM requires knowledge of the
rotor position. It is common to use rotary position sensors (encoders) concomitantly
with position estimation algorithms to increase the system’s reliability.
Figure 12 presents a succinct classiﬁcation of rotor position estimation methods
for SMPMSMs [21–24]. For low-speed operation, including initial driving, saliency-
based methods are used, like rotor fretting and pulse high-frequency signal injection.
For medium and high-speed operation, methods based on mathematical modeling
are applied. Non-adaptive methods use the back-EMF or ﬂux linkage estimation to
directly infer the rotor position, by means of zero-crossing, integration and third-
harmonic analysis. On the other hand, adaptive methods use closed-loop observa-
tion techniques for the back-EMF, the ﬂux linkage or the rotor angle; those meth-
ods include Model Reference Adaptive System (MRAS), Artiﬁcial Intelligence (AI)
estimators like artiﬁcial neural networks, and observer-based estimators, e.g. sliding-
mode observer, Luenberger observer and Kalman ﬁlter.
Position estimation in SMPMSMs with non-sinusoidal waveforms (and, con-
sequently, expressive harmonic content) involves a greater degree of complexity
because the estimator may eventually synchronize with the higher order harmonic
components of the back-EMF due to dynamic variations of the machine speed, caus-
ing the total desynchronization of the estimator [7]. However, wind generation sys-
tems work with a quasi-steady rotor speed operation. Furthermore, wind generation
requires a medium to high-speed operation, so mathematical modeling methods are
suitable for such an application.
The big problem of the mathematical modeling non-adaptive methods is the uncer-
tainty of the machine parameters; these are open-loop methods which do not guar-
antee a correct estimate. Therefore, the adaptive methods, also called closed-loop

234
J. R. B. de A. Monteiro et al.
Fig. 12 Rotor position
estimation methods for
SMPMSM
methods, work by comparing the output signals of two different systems, a real
system and a mathematically modeled system. The Kalman ﬁlter method is insensi-
tive to measurement noise and parameter inaccuracy and has a good response when
harmonics are present, therefore, it is a good alternative for wind generation with
SMPMSM.
4.1
Kalman Filter-Based Approach for Rotor Position
Estimation
A Kalman ﬁlter-based estimator with two Phase-Locked Loops (PLLs) [25] is shown
in Fig. 13. Each part of this method is described below:
Kalman ﬁlter The Kalman ﬁlter estimates the SMPMSM back-EMF ek
α, ek
β based on
the current measurements ik
m,α, ik
m,β, the applied voltages in the last time step vk−1
m,α ,
vk−1
m,β and the current measurements in the last time step ik−1
m,α , ik−1
m,β . The Kalman ﬁlter
is preferred as a machine’s back-EMF estimator due to its rejection of sensor noise,
producing an estimated back-EMF waveform closer to the real one [7].
Position estimator PLL This ﬁrst PLL corrects the back-EMF angle ˆθr from the
Kalman ﬁlter by comparing it to a rotor angle θ′
r from a back-EMF look-up table e′
α,
e′
β, culminating in a preliminary rotor angle estimation ˆθk
r .

Variable-Speed-Driven Three-Phase Surface-Mounted …
235
Fig. 13 Block diagram for rotor position estimation: Kalman ﬁlter (red); position estimator PLL
(blue); and delay compensation PLL (yellow) [7]
Delay compensation PLL This PLL compensates the delay that is introduced by the
Kalman ﬁlter, improving the control system dynamics. It uses the applied voltages in
the last time step vk−1
m,α , vk−1
m,β and the current measurements in the last time step ik−1
m,α ,
ik−1
m,β to estimate the currents ik
m,α
′, ik
m,β
′ and their respective angle θk
i
′. The real current
measurements ik
m,α, ik
m,β provide the actual angle θk
i . Then a rotor angle variation 
θk
r
is computed and added to ˆθk
r , resulting in a more accurate rotor position estimation
ˆθk
e . Note that ˆωk
e = d ˆθk
e /dt ≈( ˆθk−1
e
−ˆθk−2
e
)/Ts.
5
Grid-Side Converter Modeling and Control
As introduced in Sect. 1, variable-speed-driven SMPMSMs applied to wind gener-
ation systems require full power converters. Since this chapter assumes the use of
the back-to-back converter, it is possible to consider the grid connection modeling
independently of the SMPMSM modeling.

236
J. R. B. de A. Monteiro et al.
Fig. 14 Grid-side converter with an L ﬁlter [26]
The connection to the grid, with a two-level voltage source inverter, can be made
through an L ﬁlter. The grid voltage is considered purely sinusoidal. Figure 14 depicts
such a conﬁguration, as well as the parameters and electrical quantities relevant to
the modeling: ig,a, ig,b, ig,c are the grid phase currents; vg,a, vg,b, vg,c are the grid
phase voltages; Vdc is the DC link voltage; Lg and Rg are the L ﬁlter’s inductance
and resistance, respectively; and Cdc is the DC link capacitance. It is considered that
there is symmetry between the phases, and the magnetic and electrical properties of
the used materials are linear.
The electrical equation of the grid connection is:
⎡
⎣
vi,a
vi,b
vi,c
⎤
⎦= Rg
⎡
⎣
ig,a
ig,b
ig,c
⎤
⎦+ Lg
d
dt
⎡
⎣
ig,a
ig,b
ig,c
⎤
⎦+
⎡
⎣
vg,a
vg,b
vg,c
⎤
⎦−
⎡
⎣
vg,n
vg,n
vg,n
⎤
⎦,
(24)
where vi,a, vi,b, vi,c are the inverter output voltages and vg,n is the voltage of the grid
neutral terminal. The instantaneous active Pg and the reactive Qg powers delivered
to the grid are denoted as:
Pg = vg,aig,a + vg,big,b + vg,cig,c
(25a)
Qg =
√
3
3 (vg,b −vg,c)ig,a + (vg,c −vg,a)ig,b + (vg,a −vg,b)ig,c.
(25b)
The αβ and the dq transformations, as in (8) and (11), applied to (24) and (25),
result in the grid model and the delivered active and reactive powers in terms of the
grid voltages and currents in the synchronous orthogonal reference frame aligned to
the a phase of the grid voltage:

Variable-Speed-Driven Three-Phase Surface-Mounted …
237
vi,dq = Rgig,dq + Lg
dig,dq
dt
+ jωgig,dq + vg,dq,
(26)
Pg = vg,dig,d + vg,qig,q
(27a)
Qg = vg,qig,d −vg,dig,q,
(27b)
where ωg is the grid frequency. The angle of the grid voltage, θ = θg, is estimated by
a quasi-type 1 PLL [27]. It is noteworthy that, for a purely sinusoidal grid voltage,
vg,q = 0.
Besides grid current, the DC link voltage shall be modeled. The nodal analysis in
the DC link is:
iP =iCdc + iinv
=Cdc
dVdc
dt
+ Pinv
Vdc
,
(28)
where iP is the current from the rectiﬁer (related to the generated power by the
SMPMSM); iCdc is the current ﬂowing on the DC link capacitor; and iinv is the
current entering the inverter. Neglecting the active power consumed by the L ﬁlter,
one can denote Pinv ≈Pg = vg,dig,d. Furthermore, iP is assumed as a disturbance
to the system to be controlled, so that the DC voltage dynamics can be described as:
dV 2
dc
dt
+
2
Cdc
vg,dig,d = 0.
(29)
Equation (29) shows a nonlinear relationship between Vdc and ig,d, while a linear
relationship is desirable. To achieve such a relationship, we can use the small signals
theory. The DC link voltage is described as a small perturbation signal ˆvdc superim-
posed on the operating point ¯Vdc, so that Vdc = ¯Vdc + ˆvdc. The intermediary steps are
detailed in [28]. The resultant small signal model, neglecting high frequency terms
and considering vg,d constant, and the process transfer function for the project of the
controller is:
d ˆvdc
dt
+
vg,d
Cdc ¯Vdc
ˆig,d = 0,
(30)
Vdc(s)
ig,d(s) =
−vg,d
¯VdcCdcs .
(31)
Figure11represents theblockdiagramfor thevector control of thegridconnection
with a two-level voltage source inverter and an L ﬁlter, in a wind generation system.
It is worth mentioning that the coupling and compensation terms, shown in Table 2,
are added to the current controllers outputs in order to reduce the effort on the control.

238
J. R. B. de A. Monteiro et al.
Table 2 Coupling and compensation terms for the grid control
Terms
Expressions
Direct/quadrature decoupling
jωgig,dq
Grid voltage compensation
vg,dq
Fig. 15 Block diagram for the vector control of the grid connection in a wind generation system.
The terms of decoupling (blue), and grid voltage compensation (yellow), as well as the PLL structure
(green), are highlighted
Current (Cig,d and Cig,q) and DC voltage (CVdc) controllers can use the PI controller
in its digital implementation, as presented in Sect. 3.1 (Fig.15).
6
Example Case: 240 kW SMPMSM Generator
As an example of the concepts presented in this chapter, a wind power generation
system with an SMPMSM connected to the grid by a back-to-back converter will be
studied through computer simulation. The generator parameters shown in Table 3
refer to a 240 kW commercial machine. The other simulation parameters, referring
to the connection to the grid and the control, are also described in Table 3.

Variable-Speed-Driven Three-Phase Surface-Mounted …
239
Table 3 Simulation parameters
Machine parameters
Rated voltage
380 V
Rated output power
240 kW
Rated frequency
60 Hz
Synchronous speed
1250 rpm
Number of pole pairs n p
3
Stator resistance
0.0185 
Inductances subtraction Ls −Ms
472 µH
Back-EMF normalized amplitude m
0.853 Vs
Inertia coefﬁcient
4.76 kgm2a
Viscous friction coefﬁcient
0.1385 Nms/rada
Grid parameters
Rated voltage
13.8 kVb
Rated frequency
60 Hz
Filter inductance Lg
400 µH
Filter resistance Rg
5 m
Rated DC voltage Vdc
700 V
DC link capacitance Cdc
33,000 µF
Control parameters
Sample time Ts
20 µs
Cim,dx , Cim,qx - Proportional gain
4.6 V/A
Cim,dx , Cim,qx - Integral gain
21 V/(As)
aReferenced to the machine rotor shaft
bThrough a 440 V/13.8 kV 3φ transformer
6.1
Back-EMF Waveform Analysis
Figure 16 presents the normalized back-EMF waveform of the 250 kW generator, and
in Fig. 17, the real phase-a back-EMF waveform is compared to the ideal sinusoidal
and trapezoidal waveforms. Note that the real waveform is similar to a sinusoid,
although it has distortions.
Since the back-EMF waveform is non-sinusoidal, we can use the dqx transforma-
tion. Figure 18 depicts ax and θx for the real back-EMF waveform of Fig. 16.
6.2
Simulation Tests Overview
Two analyses are carried out concerning the SMPMSM vector control. Initially,
a torque ripple analysis related to the choice of the back-EMF waveform in the
SMPMSM vector control is performed. Three possibilities are considered:

240
J. R. B. de A. Monteiro et al.
Fig. 16 Real back-EMF waveform used in simulation
Fig. 17 Comparison between back-EMF waveforms
Fig. 18 ax and θx as a
function of θe for the real
back-EMF waveform

Variable-Speed-Driven Three-Phase Surface-Mounted …
241
• the dqx transformation considering the real back-EMF waveform introduced in
Fig. 16, which is the appropriate choice and is expected to present the best results
regarding torque ripple;
• the dq transformation, for which the control considers a purely sinusoidal back-
EMF waveform, allowing an interesting effect to be observed, since the real back-
EMF waveform resembles a sine wave; and
• the dqx transformation considering an ideal trapezoidal waveform is presented for
curiosity, as a way to show that the dqx transformation is the best solution only if
the considered back-EMF waveform is the correct one.
After this, the results with the real and with the sinusoidal back-EMF waveforms
are compared in terms of the system efﬁciency.
Mechanical parameters in Table 3 imply that speed variations occur over many
seconds. Therefore, it is possible to consider that changes in speed are negligible
when analyzing electrical variables in a time window of tens of milliseconds. The
tests aforementioned are performed at a mechanical speed of 1000 rpm and with a
torque reference of −1900 Nm.1
6.3
Simulation Results
Simulation results of electromagnetic torque, phase a back-EMF, and phase currents
for the adopted machine considering the three variations cited in Sect. 6.2, are pre-
sented. Figure 19 shows the results for a vector control in the dqx axes adopting
the real back-EMF waveform; Fig. 20 refers to the vector control in the dq axes,
therefore the phase currents are sinusoidal; and Fig. 21 presents the results for a
vector control in the dqx axes adopting a ideal trapezoidal signal for the back-EMF
waveform.
The use of the dqx transformation with the real back-EMF waveform reduced the
torque ripple. This becomes clear when computing the torque ripple factor, shown
graphically in Fig. 22: using the dqx transformation with the real back-EMF wave-
form reduced the ripple factor by 16.5% compared to using the sinusoidal back-EMF
and by 61.6% compared to the ideal trapezoidal back-EMF. The torque ripple factor
rTe is deﬁned by:
rTe =

T 2e,rms −T 2e,mean
Te,mean
,
(32)
where Te,rms is the root mean square value of the electromagnetic torque and Te,mean
is its mean value. The results reiterate that considering a back-EMF different from the
real one in the control leads to unsatisfactory behavior, with a higher torque ripple.
Clearly, Fig. 20 presents the sixth torque ripple harmonic component due to the real
1 Considering a positive rotor speed, a negative electromagnetic torque means the power is converted
from the mechanical to the electrical system.

242
J. R. B. de A. Monteiro et al.
Fig. 19 Electromagnetic
torque (Tel), phase a
back-EMF (ea) and phase
currents (im,a, im,b and im,c)
considering the real
back-EMF waveform in the
SMPMSM vector control
-500A
-250A
iabc 0
250A
500A
-200
-100V
ea 0
100V
200V
1900Nm
-1500Nm
-1000Nm
0
0.1
0.105
0.11
0.115
0.12
0.125
0.13
0.135
0.14
t(s)
Tel
T ∗
el
back-EMF being non-sinusoidal. Furthermore, the use of the trapezoidal waveform,
Fig. 21, is illustrative in this aspect, bringing undesirable results.
For the efﬁciency analysis, the real and the sinusoidal back-EMF waveforms are
considered in the control. Table 4 presents the system input and output powers, and
highlights that the global efﬁciency is similar when considering a sine wave or the
real back-EMF waveform in the vector control.

Variable-Speed-Driven Three-Phase Surface-Mounted …
243
Fig. 20 Electromagnetic
torque (Tel), phase a
back-EMF (ea) and phase
currents (im,a, im,b and im,c)
considering a sinusoidal
back-EMF waveform in the
SMPMSM vector control
-500A
-250A
iabc 0
250A
500A
-200
-100V
ea 0
100V
200V
1900Nm
-1500Nm
-1000Nm
0
0.1
0.105
0.11
0.115
0.12
0.125
0.13
0.135
0.14
t(s)
Tel
T ∗
el
7
Chapter Outcomes and Summary
This chapter presented the modeling and vector model-based control of SMPMSMs
considering both sinusoidal and non-sinusoidal back-EMF waveforms. Rotor posi-
tion estimation and the modeling and control of the grid connection were also exam-
ined. Simulation results with parameters from a real wind power generation sys-
tem evince that the dqx transformation shows itself as an appropriate choice for
SMPMSMs with non-sinusoidal back-EMF for torque ripple factor reduction. Since
torque ripple reduces the life of the electrical machine and all the elements mechan-
ically coupled to it, such a reduction is a desirable feature.

244
J. R. B. de A. Monteiro et al.
Fig. 21 Electromagnetic
torque (Tel), phase a
back-EMF (ea) and phase
currents (im,a, im,b and im,c)
considering a trapezoidal
back-EMF waveform in the
SMPMSM vector control
-500A
-250A
iabc 0
250A
500A
-200
-100V
ea 0
100V
200V
1900Nm
-1500Nm
-1000Nm
0
0.1
0.105
0.11
0.115
0.12
0.125
0.13
0.135
0.14
t(s)
Tel
T ∗
el
Fig. 22 Torque ripple factor
(rT e) varying the considered
back-EMF waveform in the
SMPMSM vector control

Variable-Speed-Driven Three-Phase Surface-Mounted …
245
Table 4 System power and efﬁciency
Considered back-EMF
Real
Sinusoidal
Electromagnetic torque
1908.84 Nm
1906.71 Nm
Input: mechanical power
199.893 kW
199.670 kW
Injected power to the grid
189.320 kW
189.070 kW
Efﬁciency
94.71%
94.69%
Acknowledgements Authors would like to thank the University of São Paulo (USP) and the Coor-
denação de Aperfeiçoamento de Pessoal de Nível Superior - Finance Code 001 for the ﬁnancial
support.
References
1. Kakran S, Chanana S (2018) Smart operations of smart grids integrated with distributed gen-
eration: a review. Renew. Sustain. Energy Rev. 81:524–535
2. VineethaCP,BabuCA(2014)Smartgridchallenges,issuesandsolutions.In:2014international
conference on intelligent green building and smart grid (IGBSG), pp 1–4
3. Roy P et al (2022) Recent advances of wind-solar hybrid renewable energy systems for power
generation: a review. IEEE Open J Ind Electron Soc 3:81–104
4. Dalwadi P et al (2011) Optimization of solar-wind hybrid system for distributed generation.
In: 2011 Nirma university international conference on engineering, pp 1–4
5. European Commission et al (2018) JRC wind energy status report: market, technology and
regulatory aspects of wind energy: 2016 edition. Publications Ofﬁce
6. Milivojevic N et al (2008) Electrical machines and power electronic drives for wind turbine
applications. In: 2008 34th annual conference of ieee industrial electronics. IEEE, pp 2326–
2331
7. Monteiro J (2017) Acionamentos Elétricos com Máquinas Síncronas com Ímã Permanente no
Rotor. Technical report habilitation thesis. University of Sao Paulo, Sao Carlos, p 126
8. Krause P et al (2013) Analysis of electric machinery and drive systems. IEEE press series on
power engineering. Wiley. isbn: 9781118524268
9. Quang N, Dittrich J (2015) Vector control of three-phase ac machines: system development in
the practice, 2nd edn. Springer, Berlin
10. Duesterhoeft W, Schulz M, Clarke E (1951) Determination of instantaneous currents and volt-
ages by means of alpha, beta, and zero components. Trans Am Inst Electr Eng 70(2):248–1255
11. GrenierD,LouisJ(1995)Modelingforcontrolofnon-sinewavepermanentmagnetsynchronous
drives by extending Park’s transformation. Math Comput Simul 38(4):445–452
12. Biyani V et al (2021) Comparative study of different control strategies in permanent magnet
synchronous motor drives. In: 2021 IEEE 5th international conference on condition assessment
techniques in electrical systems (CATCON), pp 275–281
13. Kwon Y, Kim S, Sul S (2014) Six-step operation of PMSM with instantaneous current control.
IEEE Trans Ind Appl 50(4):2614–2625
14. Cho B et al (2021) Simple position sensorless V/f scalar control method for permanent-magnet
synchronous motor drives. J. Power Electron 21(1):1020–1029
15. Zhang Z et al (2019) Advanced control strategies for back-to-back power converter PMSG
wind turbine systems. In: 2019 ieee international symposium on predictive control of electrical
drives and power electronics (PRECEDE), pp 1–6

246
J. R. B. de A. Monteiro et al.
16. Chatri C, Ouassaid M, Labbadi M (2021) A novel nonlinear sliding mode control scheme
for PMSG based on wind energy conversion system. In: 2021 3rd international conference
on control systems, mathematical modeling, automation and energy efﬁciency (SUMMA), pp
1108–1112
17. Gencer A (2017) Modelling of operation PMSG based on fuzzy logic control under differ-
ent load conditions. In: 2017 10th international symposium on advanced topics in electrical
engineering (ATEE), pp 736–739
18. Nise N (2013) Control systems engineering, 7th edn. Wiley, Hoboken, NJ
19. Fu X et al (2020) A strongly robust and easy-tuned current controller for PMSM considering
parameters variation. IEEE Access 8:44228–44238
20. Hussain H (2021) Tuning and performance evaluation of 2DOF PI current controllers for
PMSM drives. IEEE Trans Transp Electrif 7(3):1401–1414
21. Tarmizi Y et al (2017) Review and comparison of sensorless techniques to estimate the position
and speed of PMSM. Int J Power Electron Drive Syst 8(3):1062–1069
22. Li Q et al (2018) Sensorless control for surface mounted PM machine with a high inertial load.
CES Trans Electr Mach Syst 2(1):116–122
23. Li Y et al (2021) Rotor position estimation approaches for sensorless control of permanent
magnet traction motor in electric vehicles: a review. World Electr Veh J 12(1)
24. Singh S, Tiwari A (2017) Various techniques of sensorless speed control of PMSM: a review.
In: 2017 2nd international conference on electrical, computer and communication technologies
(ICECCT), pp 1–6
25. Almeida T et al (2017) Sensorless vector control for BLDC machine. In: 2017 Brazilian power
electronics conference (COBEP), pp 1–6
26. Santos S (2021) Operação de motor de indução trifásico conectado á rede por meio de um
conversor de nove chaves com fator de poténcia adiantado. MA thesis. São Carlos: Escola de
Engenharia de São Carlos, Universidade de São Paulo
27. Golestan S et al (2014) A quasi-type-1 phase-locked loop structure. IEEE Trans Power Electron
29(12):6264–6270. https://doi.org/10.1109/TPEL.2014.2329917
28. Zarif M, Monfared M (2015) Step-by-step design and tuning of VOC control loops for grid
connected rectiﬁers. Int J Electr Power Energy Syst 64:708–713

Variable Speed Drives for Household
Wind Energy Systems: Model Predictive
Control of the Squirrel Cage Induction
Generator with the Nine-Switch
Converter
Paulo Roberto Ubaldo Guazzelli, Stefan Thiago Cury Alves dos Santos,
and Manoel Luís de Aguiar
Abstract Household power generation is a key part of smart grids. Among the
power sources, variable speed wind turbines offer good power output with reliability.
This chapter investigates the use of a squirrel cage induction generator in a variable
speed drive system for the aforementioned application. In this downsized scale of
power, reduced-count switch converters are interesting alternatives, for the sake of
cost and size reduction. Therefore, this work applies the Nine-Switch Converter
(NSC) in the integration of a squirrel cage induction generator onto the grid, with
use of Finite Control Set Model Predictive Control (FCS-MPC), a powerful control
theory, specially for power electronics. The converter is analyzed, with focus on its
available voltage vectors, leading to the development of two structures of FCS-MPC:
the concentrated approach and the decoupled approach. Furthermore, the decoupled
approach enables the incorporation of duty cycle optimization into FCS-MPC for the
NSC, which leads to improvements on the generator torque ripple and on the grid
active power ripple. Additionally, considerations are made about the use of NSC wind
energy system also for grid reactive power compensation. All the considerations are
accompanied by simulated results of the considered system. As a result, the NSC
is a feasible alternative for variable speed drive wind energy systems in household
applications.
P. R. U. Guazzelli (B)
Department of Electrical Engineering, Federal University of São Carlos, Rodovia Washington
Luis, km 235, São Carlos, SP, Brazil
e-mail: paulo.ubaldo@ufscar.br
S. T. C. A. dos Santos · M. L. de Aguiar
São Carlos School of Engineering, Avenida Trabalhador São-carlense, 400, São Carlos,
SP, Brazil
e-mail: stefan.santos@usp.br
M. L. de Aguiar
e-mail: aguiar@sc.usp.br
© The Author(s), under exclusive license to Springer Nature Switzerland AG 2024
A. J. Sguarezi Filho et al. (eds.), Smart Grids—Renewable Energy, Power Electronics,
Signal Processing and Communication Systems Applications, Green Energy
and Technology, https://doi.org/10.1007/978-3-031-37909-3_9
247

248
P. R. U. Guazzelli et al.
1
Introduction
This chapter embraces and summarizes the results and advances about the Nine-
Switch Converter (NSC) made under the supervision and guidance of Prof.
Dr. Manoel Luís de Aguiar at University of São Paulo. Mainly, the Ph.D. thesis
of Dr. Paulo Roberto Ubaldo Guazzelli [60], about the decoupled Finite Control Set
ModelPredictiveControl(FCS-MPC),andthedutycycleoptimizationforFCS-MPC
in the NSC. The reactive power compensation derives from the master dissertation
of M.Sc. Stefan Thiago Cury Alves dos Santos [61]. Scientiﬁc publications derived
from these works are found in [1–4].
1.1
Smart Grids and Household Wind Power Generation
The smart grid concept enables efﬁcient power management between diverse power
sources and loads, using state-of-the-art technologies for renewable energy, signal
processing, power electronics, andcommunicationsystems [5, 6]. Its implementation
can improve the power system operation and provide beneﬁts for consumers [7, 8].
Among the smart grids challenges, the renewable and distributed generation
deployment and integration is a topic of great interest [9]: low-voltage and low-
power distributed energy resources such as photovoltaic modules [10, 11], biomass
systems [12], and wind turbines [13, 14] are increasingly present in both residential
and industrial contexts. All these technology gaps and challenges lead to intense
efforts from researchers. This chapter focuses on the latter research topic, nomi-
nally the deployment of low-voltage and low-power wind turbines for household
applications.
Household applications for wind power generation have become possible with
the decrease in its installation and maintenance costs. The Squirrel-Cage Induction
Generator (SCIG) is an appropriate choice because of the simplicity and lower main-
tenance of this electric machine compared to other ones like the doubly-fed induction
generator or the permanent magnet synchronous generator [15, 16]. Although the
SCIG requires a fully-rated converter to operate with a variable speed turbine, the
costs of the power electronics devices have diminished over the years, and Reduced-
Switch-Count AC/AC Converters (RSCs) can lower costs and complexity by the
decrease of the number of electronic switches [17]. Figure1 presents the diagram of
a variable speed turbine with a SCIG and a fully-rated converter.
1.2
Nine-Switch Converter
Fully-rated converters applied to electricity generation using AC machines demand
that both AC terminals shall be controllable; on one hand, the machine-side must be

Variable Speed Drives for Household Wind Energy Systems …
249
Fig. 1 Diagram of a variable speed turbine with a fully-rated converter
able to handle a variable-speed operation, and on the other hand, the grid-side needs
the capabilities of electric power delivery and power factor control [18, 62]. Figure1
depicts the three-phase AC/AC converter as a set of two controlled converters, a
rectiﬁer one (AC/DC converter) and an inverter one (DC/AC converter), and they
are connected through a DC link. This conﬁguration is known as the Back-to-Back
Converter (B2B) and needs 12 controlled power switches for two-level converters.
As said earlier, RSCs aim to decrease the number of semiconductor devices of a
AC/AC converter, compared to B2B, maintaining its capabilities. Examples of RSCs
are the Eight-Switch Back-to-Back converter [19], the Six-Switch Converter [17] and
the Nine-Switch Converter (NSC) [20]. The NSC, Fig.2, can be understood as two
converters that share three power switches S2, S5 and S8 among the rectiﬁer and the
inverter parts. As a result, this converter has 25% less switches than B2B. NSC stands
out from other RSCs for not having derivations on the DC link. Such derivations can
deteriorate system performance [21], so avoiding them is an advantage for the NSC.
Fig. 2 Nine-switch converter (NSC)

250
P. R. U. Guazzelli et al.
1.3
Finite Control Set Model Predictive Control
The application of power electronics in power generation systems requires high-
performance control techniques. Direct Torque Control (DTC) [22] and Field Ori-
ented Control (FOC) [23] are widely used in the control of three-phase induction
machines; on the grid-side, Direct Power Control (DPC) [24] and Voltage Oriented
Control (VOC) [25] are usual options. These techniques adopt control methods such
as PID, sliding mode, deadbeat, and fuzzy, among others, in their current control
loops [26–29].
The Finite Control Set Model Predictive Control (FCS-MPC) [30] is another
high-performance control technique that has gained relevance in recent years. This
technique considers the discrete nature of power converters to determine each future
state of the system from all possible voltages applied to the converter terminals; in
this way, the optimization of the control signal through the minimization of a cost
function is solved by the usage of a search algorithm [31]. Among the advantages of
FCS-MPC, one can cite the easy inclusion of nonlinearities and secondary control
objectives and the fast transient performance [32].
There are several types of FCS-MPC structures. When the cost function considers
current errors, we have the Predictive Current Control (PCC); when torque and ﬂux
errors are considered, Predictive Torque Control (PTC); when active and reactive
power errors are considered, Predictive Power Control (PPC) [33]. PCC is analogous
to FOC and VOC in its current control in a speciﬁc reference frame, PTC is analogous
to DTC in its torque and ﬂux control perspective, and PPC is analogous to DPC in
its power control perspective.
One of the FCS-MPC characteristics is the variable switching frequency, limited
to half of the adopted control frequency, due to the absence of modulators [33].
This feature simpliﬁes the converter implementation but can lead to greater ripple
in the controlled variables. The inclusion of the duty cycle concept in FCS-MPC
signiﬁcantly improves steady-state performance, at the cost of using modulators. As
a consequence, there is a ﬁxed switching frequency [34].
FCS-MPC has been successfully used in the NSC. The most common approach in
the literature is to use a single cost function that concentrates the control objectives of
the two converter ports. This approach was used in applications with loads connected
to both three-phase terminals of the NSC [35–37] and with one of the terminals
connected to the grid, in a conﬁguration analogous to B2B [4, 38]. NSC with FCS-
MPC was also used as a power quality conditioner [39].
However, condensing the control objectives into a single cost function implies
more computational burden due to the high number of search possibilities (up to
27) [40] and may favor the control of one of the ports to the detriment of the other [41].
The separation of the cost function into two parts, which are evaluated in different
control periods, mitigates the aforementioned difﬁculties [2, 40]. Furthermore, duty
cycle optimization becomes possible for such an approach [41].

Variable Speed Drives for Household Wind Energy Systems …
251
1.4
Reactive Power Compensation
Certain loads, such as electrical machines directly connected to the grid, cause elec-
trical power quality problems related to low power factor. Since those problems can
lead to increased expenses due to lower efﬁciency and even penalties in several coun-
tries [42, 43], consumers may beneﬁt from the application of power factor correction
techniques.
A conventional technique for lagging power factor correction is the addition of
capacitor banks. However, it is not possible to control the amount of reactive power
supplied [44], and capacitor banks are sensitive to harmonic components [45]. Solu-
tions that use power converters in order to exclusively supply reactive power can over-
come the existing difﬁculties in the conventional technique and have been extensively
studied in recent years. Static Var compensators and static synchronous compensators
are examples [46–48].
Another possible approach is to use the inherent capability of power factor control
present in the B2B converter and its RSC counterparts [49–51]. Such an approach
was successfully proposed for an NSC-fed electric motor drive with both ﬁxed and
variable-frequency control schemes on the machine-side [3, 4, 52].
1.5
Chapter Objectives and Outline
Given the previous comments and literature review, this chapter develops the theoret-
ical concepts regarding NSC application in household wind generation with SCIG,
with corresponding simulation results for validation. Four PCC techniques are dis-
cussed and compared based on simulation results: the Concentrated FCS-MPC; the
Reduced FCS-MPC; the Decoupled FCS-MPC; and the Duty Cycle Based FCS-
MPC. The capability to supply reactive power by the NSC during active power
generation is also studied.
After the contextualization of Sects.1 and 2 presents the necessary fundamentals
for the components of the generation system, whilst Sect.3 delves into the system
control, with a deeper analysis of the different FCS-MPC implementations for the
NSC control in Sect.4. Simulated results are presented in Sect.5 for validation, and
Sect.6 draws the conclusions.
2
System Modelling
FCS-MPC requires the knowledge of the system models. As a result, the SCIG and
grid analytical models are presented, as well as the enumeration of the NSC possible
Voltage Vectors (VVs).

252
P. R. U. Guazzelli et al.
2.1
Squirrel Cage Induction Generator
The used SCIG model is oriented in the rotor ﬂux angle θ2 synchronous reference
frame [53]. As a result, the rectiﬁer port current ir is represented by (1), where the
symbol j is the complex operator:
ir = idr + jiqr = e jθ2(iαr + jiβr).
(1)
The resulting model is given by (2), for a voltage v1 applied to the stator winding
of the SCIG:
dir
dt =
v1
σ L1
−
 R2L2
H
σ L1L2
2
+ R1
σ L1
+ jω2

ir +
L H
σ L1L2
 R2
L2
−jpωm

ψ2
(2a)
dψ2
dt
= R2L H
L2
ir −R2
L2
ψ2
(2b)
where the stator and rotor resistances are given by R1 and R2, respectively; the
stator, rotor and mutual inductances are given by L1, L2 and L H, respectively; σ :=
1 −
L2
H
L1L2 is an auxiliary variable; and the number of pole pairs is represented by p.
Also, the mechanical speed is represented by ωm, and ω2 is the angular speed of the
rotor ﬂux ψ2.
Since the rotor ﬂux is aligned to its own reference frame, its direct value is its
own amplitude, and its quadrature value is zero. Therefore, the rotor ﬂux amplitude
and angle are estimated according to the recursive structure of (3):
dψ2d
dt
= R2L H
L2
idr −R2
L2
ψ2d
(3a)
ω2 = pωm + R2L H
L2
iqr
ψ2d
(3b)
θ2 =

ω2dt.
(3c)
2.2
Three-Phase Grid
Let θg be the angle of the grid voltage vg. The inverter port currents ii can be aligned
to the grid voltage reference frame, with direct and quadrature coordinates:
ii = idi + jiqi = e jθg(iαi + jiβi).
(4)
The grid model is given by (5), and represents the connection between the NSC
and the grid by the means of an L ﬁlter, with inductance L f and resistance R f :

Variable Speed Drives for Household Wind Energy Systems …
253
dii
dt = 1
L f

vi −vg −R f ii −jωgii

.
(5)
In this work, the angle θg was estimated by a synchronous reference frame PLL
with Moving Average Filter (MAF-PLL). This structure features good performance
under unbalanced voltage conditions [54], and is consolidated in three-phase appli-
cations [55].
2.3
Nine-Switch Converter
Each leg from NSC has three switches. In order to avoid ﬂoating phases on any ports,
there must be always two switches turned on and one switch turned off. This renders
27 different switching combinations for the NSC, which are listed on Table1.
However, each port can assume a more reduced set of possibilities: only eight VVs,
whose coordinates are listed in Table2. It can be seen how the VV applied to rectiﬁer
port is a function only of the switching states of the three upper switches [S1, S4, S7],
and that the VV applied to the inverter port is dependant only of the switching states
of the lower switches [S3, S6, S9]. There are two null VVs and six active VVs, which
are organized in an hexagonal shape, as in Fig.3. Each active VV has half of the
amplitude of the corresponding VV from a regular six-switch inverter. Therefore,
the relation between the DC bus voltage of the NSC and maximum phase voltage at
the AC ports is given by (6).
vdc = 2
√
6v rms
phase.
(6)
3
System Control
Figure4 shows the overall control structure. Grid and SCIG currents are measured
and converted to their respective synchronous reference frames. On the SCIG side,
the direct current reference i∗
dr is set by a PI controller responsible for the rotor ﬂux
amplitude control, whilst the quadrature current referencei∗
qr is direct calculated from
the torque reference, according to (7). On the grid side, the direct current reference i∗
di
is set by a PI controller responsible for the DC bus voltage control, and the quadrature
current reference i∗
qr is set according to the reactive power reference Q∗, in (8).
i∗
qr =
1
KT
· T ∗
el =
2L2
3pL H ˆψ2d
· T ∗
el
(7)
i∗
qi = −2Q∗
3vdg
.
(8)

254
P. R. U. Guazzelli et al.
Table 1 Voltage vectors for each port according to the switching states of NSC
#
Switching state
Applied vector
[S1−9]
Upper port
Lower port
1
[110110110]
v7
v7
2
[110110011]
v2
v2
3
[110110101]
v7
v2
4
[110011110]
v6
v6
5
[110011011]
v1
v1
6
[110011101]
v6
v1
7
[110101110]
v7
v6
8
[110101011]
v2
v1
9
[110101101]
v7
v1
10
[011110110]
v4
v4
11
[011110011]
v3
v3
12
[011110101]
v4
v3
13
[011011110]
v5
v5
#
Switching state
Applied vectors
[S1−9]
Upper port
Lower port
14
[011011011]
v0
v0
15
[011011101]
v5
v0
16
[011101110]
v4
v5
17
[011101011]
v3
v0
18
[011101101]
v4
v0
19
[101110110]
v7
v4
20
[101110011]
v2
v3
21
[101110101]
v7
v3
22
[101011110]
v6
v5
23
[101011011]
v1
v0
24
[101011101]
v6
v0
25
[101101110]
v7
v5
26
[101101011]
v2
v0
27
[101101101]
v7
v0
The FCS-MPC block is the core of the control system, determining the control
action based on the currents measurements and references. Firstly, the two FCS-MPC
core tasks must be addressed: prediction and cost function calculations.

Variable Speed Drives for Household Wind Energy Systems …
255
Table 2 Voltage vectors coordinates on the αβ reference frame, as a function of the DC bus voltage,
for the rectiﬁer port (left) and inverter port (right) switching combinations
#
Vector
vα
vβ
Amplitude
[S1, S4, S7]
[S3, S6, S9]
0
v0
0
0
0
[0,0,0]
[1,1,1]
1
v1
2
3vdc
0
2
3vdc
[1,0,0]
[0,1,1]
2
v2
1
3vdc
√
3
3 vdc
2
3vdc
[1,1,0]
[0,0,1]
3
v3
−1
3vdc
√
3
3 vdc
2
3vdc
[0,1,0]
[1,0,1]
4
v4
−2
3vdc
0
2
3vdc
[0,1,1]
[1,0,0]
5
v5
−1
3vdc
−
√
3
3 vdc
2
3vdc
[0,0,1]
[1,1,0]
6
v6
1
3vdc
−
√
3
3 vdc
2
3vdc
[1,0,1]
[0,1,0]
7
v7
0
0
0
[1,1,1]
[0,0,0]
Fig. 3 NSC voltage vectors
in the αβ reference frame
3.1
Grid Side PCC
The prediction stage for the grid control at a k instant for the nth VV is given by (9):
ik+1
i
= ik
i + tD
L f

vn −vk
g −R f · ik
i −jωgL f ik
i

(9)
where tD is the discretization time. The cost function is then calculated as:
ginvn =

i∗
di −ˆik+1
din
2
+

i∗
qi −ˆik+1
qin
2
.
(10)

256
P. R. U. Guazzelli et al.
Fig. 4 Diagram of the system: grid and SCIG connected to the NSC, with PCC control
3.2
SCIG Side PCC
SCIG control requires the prediction of the dq currents at the rectiﬁer port, according
to (11):
ik+1
r
= ik
r + tD

L H
σ L1L2
 R2
L2
−jpωk
m

ˆψk
2d + vn
σ L1
−
 R2L2
H
σ L1L2
2
+ R1
σ L1
+ jωk
2

ik
r

(11)
with the corresponding cost function calculation:
grectn =

i∗
dr −ˆik+1
drn
2
+

i∗
qr −ˆik+1
qrn
2
.
(12)
4
FCS-MPC Implementation
The aforementioned PCCs, for the grid and the SCIG ports, need to result in the ﬁnal
control action: the switching states for each one of NSC nine switches.

Variable Speed Drives for Household Wind Energy Systems …
257
Fig. 5 Control ﬂowchart of PCC-C
4.1
Concentrated FCS-MPC
The ﬁrst FCS-MPC implementation for the NSC found in the literature is the herein
named Predictive Current Control with a Concentrated cost function and a set of
27 pairs of vectors (PCC-C). It treats the NSC control as one single control. This is
achieved by merging the two PCCs into a single cost function, given by (13). This
cost function depends on both the SCIG and the grid PCCs, according to the ﬂowchart
of Fig.5. At each time step, it evaluates the cost for each one of the 27 pairs of VVs
found in Table1. The resulting VV corresponds to an optimal switching state for the
nine switches, according to its respective row in Table1.
gn = grectn + ginvn.
(13)
4.2
Reduced FCS-MPC
The evaluation of 27 pairs of VVs is a costly task for embedded systems. Looking
into Table1, these pairs can be classiﬁed into four main types:
• Group 1 (null-null VVs): #1, #14 and #27 pairs;
• Group 2 (null-active VVs):#3, #7, #9, #19, #21, and #25 pairs;
• Group 3 (active-null VVs):#15, #17, #18, #23, #24, and #26 pairs;
• Group 4 (active-active VVs): #2, #4, #5, #6, #8, #10, #11, #12, #13, #16, #20, and
#22 pairs;
Group 4 of VVs is redundant, since the other types already contain all the VVs
for every port. Also, the three null-null pairs are redundant. Therefore, one can only
evaluate one VV from group 1, and all the VVs from groups 2 and 3. The resulting
PCC is herein named Predictive Current Control with a Concentrated cost function
and Reduced set of 13 pairs of vectors (PCC-CR). Figure6 depicts its structure,
which is analog to the one from PCC-C, but with a smaller enumeration of VVs. The
chosen VVs are depicted in Table3.

258
P. R. U. Guazzelli et al.
Fig. 6 Control ﬂowchart of PCC-CR
Table 3 Reduced set of voltage vectors for PCC-CR
#
Switching state
Applied Vectors
[S1−9]
Upper Port
Lower Port
1
[110110110]
v7
v7
2
[110110101]
v7
v2
3
[110101110]
v7
v6
4
[110101101]
v7
v1
5
[011011101]
v5
v0
6
[011101011]
v3
v0
7
[011101101]
v4
v0
8
[101110110]
v7
v4
9
[101110101]
v7
v3
10
[101011011]
v1
v0
11
[101011101]
v6
v0
12
[101101110]
v7
v5
13
[101101011]
v2
v0
4.3
Decoupled FCS-MPC
However, the grid and SCIG controls are initially unrelated: therefore, it is desirable
to keep them apart. As a result the Predictive Current Control with Decoupled cost
functions (PCC-D1) was developed. In PCC-D1, the two PCC structures are never
merged into a single cost function. Instead, each time step evaluates only one of the
controls (grid or SCIG), according to Fig.7. The structure for each PCC is seen in
Fig.8. In an even time step, all the NSC lower switches are turned on. This implies
there is a null VV applied to the grid port, and the SCIG PCC must only determine
the switching states for the three upper switches. There are two reductions in the
computational burden of the technique. Firstly, the size of the enumeration: now
only the seven VVs from Table2 need to be considered. Secondly, the evaluation of

Variable Speed Drives for Household Wind Energy Systems …
259
Fig. 7 Overall control ﬂowchart of a decoupled PCC
Fig. 8 Control ﬂowcharts of PCC-D1: SCIG (a) and grid (b) controls

260
P. R. U. Guazzelli et al.
both PCC at the same time step is no longer necessary: in an odd time step, the three
upper switches are turned, and therefore there is a null VV applied to the SCIG port.
As a result, only the grid PCC is evaluated, for only seven VVs, and it determines
the switching states of the lower switches, according to the respective row of from
Table2.
Noteworthy in Fig.8 is that the value of the VVs must be adjusted, dividing it by
half. This is due to the time in which the null VV is being applied to the port.
4.4
Duty Cycle Based FCS-MPC
The last improvement mentioned here for the NSC control is the incorporation of duty
cycle optimization for the PCCs. The Predictive Current Control with a Decoupled
cost function and Duty cycle optimization (PCC-D2) determines not only the optimal
VV for each port, but also its respective duration time. The remaining time is fulﬁlled
by a null VV, thus modulating the amplitude of the chosen VV.
4.4.1
Torque Ripple Minimization
Associated with the optimal VV for the upper/rectiﬁer port, there is a dwell time topt
r
.
In order to reduce the torque ripple of the system, we will actuate on the quadrature
current iqr. We need to ﬁnd the value topt
r
which takes the system faster as possible
to the i∗
qr reference, according to the deadbeat principle:
ik+1
qr
= ik
qr + n
r topt
r
+ 0
r(tD −topt
r
) →i∗
qr
(14)
where n
r and 0
r are the derivative terms of the plant due to the n-th VV and due to
the null VV, respectively, and are calculated by:
0
r = −R1L2
2 + R2L2
H
σ L1L2
2
iqr −ω2idr −L H pωm
σ L1L2
ˆψ2d
(15)
n
r = 0
r + vqn
σ L1
.
(16)
As a result, the optimal time topt
r
and the optimal duty cycle δopt
r
are calculated as
below:
δopt
r
= topt
r
tD
=
i∗
qr −ik
qr −0
rtD
tD(nr −0r)
.
(17)
Noteworthy that the SCIG prediction stages must be updated with its respective
dwell time, as below:

Variable Speed Drives for Household Wind Energy Systems …
261
ik+1
r
= ik
r + tD

L H
σ L1L2
 R2
L2
−jpωk
m

ˆψk
2d + δopt
r
vn
σ L1
−
 R2L2
H
σ L1L2
2
+ R1
σ L1
+ jωk
2

ik
r

.
(18)
The relation between the optimal time δopt
r
and the input for the modulation of
the switches Sl for l ε{1, 4, 7} is given by:
ml = δopt
r
Sl.
(19)
4.4.2
Active Power Ripple Minimization
PCC-D2 follows the same approach for the grid control, however, it acts on the direct
current idi, which is related to the active power injected into the grid. Therefore, the
duty cycle δopt
i
is given by:
δopt
i
= i∗
di −ik
di −0
i tD
(n
i −0
i )tD
(20)
where the grid respective derivative terms are calculated as:
0
i = −vd g −R f idi
L f
+ ωgiqi
(21)
n
i = 0
i + vdn
L f
.
(22)
The grid prediction stage for PCC-D2 incorporates δopt
i
, as follows:
ik+1
i
= ik
i + tD
L f

δopt
i
vn −vk
g −R f · ik
i −jωgL f ik
i

.
(23)
Finally, the input for the modulation of the lower switches, which means Sl for
l ε{3, 6, 9} is calculated as:
ml = (1 −δopt
i
)Sl.
(24)
Therefore, PCC-D2 follows the structures of Fig.9. It can be seen the addition of
the optimization stages in the loops, which increases the computational burden of
the technique. On the other hand, the loop is reduced from seven to six VVs, since
the null VV is already implicit in the evaluation.

262
P. R. U. Guazzelli et al.
Fig. 9 Control ﬂowcharts of PCC-D2: SCIG (a) and grid (b) controls
5
Simulated Results
Computational simulation allows to verify system behaviors before the physical
implementation, which saves time and resources [56]. All simulations were obtained
in MATLAB®/Simulink, from MathWorks®, with the ode45 solver, for the four PCC
strategies presented in the past section. There is no dead time consideration.
The parameters used for the simulation are depicted in Table4, from Appendix.
The simulations use the parameters from a real 73/127V SCIG, obtained according
the procedure of [57]. The DC bus voltage reference was set to 357V, according to
the SCIG rated voltage and the calculation of (6). Additionally, the outer loops have
PI controllers with the anti-windup method of integrator saturation [58], for the rotor
ﬂux amplitude and the DC bus voltage, with their parameters also shown in Table4.
Noteworthy here that, since the four techniques were simulated with the same
acquisition and measurement frequency (20 kHz), consequently PCC-D1 and PCC-
D2 had only half of the control frequency of PCC-C and PCC-CR. The former
techniques only evaluate each port control every other step, alternatively, whilst the
latter techniques evaluate the port controls at every step.

Variable Speed Drives for Household Wind Energy Systems …
263
The following tests are considered:
• Steady-state test: under 7 Nm, with steady-state speed of 1600 rpm;
• Dynamic test: applied torque step from 3 to 6 Nm, with speed at 1500 rpm;
• Dynamic test: reactive power step from 0 to 400 VAr, with speed at 1200 rpm,
under applied torque of 2 Nm;
• Performance indexes: SCIG torque ripple factor, grid active power ripple factor
and grid current THD for steady-state speeds ranging form 800 rpm to 1600 rpm,
under torque of 7 Nm.
5.1
Steady-State Analysis
Figure10 shows the SCIG speed, torque, current and rotor ﬂux for the steady-state
test at 1600 rpm, with a time window of 0.15s. From the speed waveforms, it is clear
the machine is operating in generator mode, with a slip of −4.2%.
It can be seen in Fig.10c how PCC-D1 reduced the torque ripple when compared
to PCC-C and PCC-CR, with only half of the control frequency and a smaller set
of voltage vectors. PCC-D2 further reduced the torque ripple, as shown in Fig.10d.
This is in accordance to the performed optimization. The analysis of the d and q
current graphs show that the quadrature current iq reached the value of 12.5A in
order to provide the desired torque of 7 Nm, and presented a high ripple for the three
techniques without duty cycle optimization, PCC-C, PCC-CR e PCC-D1. This is a
trait from the conventional FCS-MPC [59]. The optimization performed by PCC-D2
managed to signiﬁcantly reduce that oscillation, which prompted the corresponding
reductiononthetorqueripple.Finally,therotorﬂuxreferenceof0.21Wbwasreached
for all cases, with a corresponding direct current id of 7.1A.
For the same test, Fig.11 shows the grid waveforms. The quadrature grid current
was set to zero, in order to keep the reactive power to zero. On the other hand, a
direct grid current of 9.40A is injected into the grid in order to maintain the DC
bus voltage at 357V. This corresponds to a power injection of 840W. It can be seen
how PCC-D1 and PCC-D2 has direct currents with a lower ripple than PCC-C and
PCC-CR. PCC-D2 has the smaller ripple between all techniques, as a consequence
of the duty cycle calculation. This ripple reduction directly affects the active power
ripple reduction also.

264
P. R. U. Guazzelli et al.
Fig. 10 Simulated results of SCIG speed, torque, currents and rotor ﬂux at steady-state speed of
1600 rpm, under applied torque of 7 Nm
5.2
Torque Step Change
Figure12hasthewaveformsofSCIGspeed,torquecurrentsandrotorﬂuxforthesim-
ulated torque step change. For all techniques, the system reached the new reference
set. Quadrature and direct current controls remained decoupled, without interference
on the rotor ﬂux amplitude. After the step, the quadrature current value increase from
5.4 to 10.8A. Figure13 shows a zoomed version of some variables from Fig.12, for
a better view of the dynamics. The four techniques presented a fast dynamics, with
settling times under 1 ms. PCC-C and PCC-CR presented settling times of 0.15 ms,
and PCC-D1 and PCC-D2 had settling times of 0.30 ms.
Figure14 shows the effects of the torque step change on the grid side variables.
Given the presence of a PI controller in the DC bus voltage control loop, these
variables have a slower response. The torque step change implied a larger power

Variable Speed Drives for Household Wind Energy Systems …
265
Fig. 11 Simulated results of DC bus voltage and grid currents and power at steady-state speed of
1600 rpm, under applied torque of 7 Nm
input, and therefore a rise on the DC bus voltage. It presented an overshoot, which was
corrected by an increase in the direct current value from 3.9 to 7.7A; it corresponded
to an active power increase from 350 to 690W. There was no effect on the reactive
power an in the quadrature grid current, which remained set to zero. Again, it is clear
how PCC-D2 presented the performance with smaller ripples.

266
P. R. U. Guazzelli et al.
Fig. 12 Simulated results of SCIG speed, torque, currents and rotor ﬂux for a torque step change
from 3 to 6 Nm, at 1500 rpm
Fig. 13 Simulated results of
SCIG speed, torque, currents
and rotor ﬂux for a torque
step change from 3 to 6 Nm,
at 1500 rpm—detailed
comparison of the four
techniques

Variable Speed Drives for Household Wind Energy Systems …
267
Fig. 14 Simulated results of DC bus voltage and grid currents and power for a torque step change
from 3 to 6 Nm, at 1500 rpm
5.3
Reactive Power Step Change
The SCIG waveforms of speed, torque, currents and rotor ﬂux for the dynamic test
of reactive power step are seen in Fig.15. The SCIG variables did not suffered
inﬂuence from the reactive power step change, for all techniques, showcasing how
the performance of one port is not affected by the other one. Figure16 shows a
different scenario on the grid variables.
The new reactive power reference implied in a increase in the grid quadrature
current reference, from 0 to 4.6A. As a result, the system begun inserting the desired
reactive power into the grid, without interference on the system active power injection
of 150W. Figure17 has a zoomed time window of some variables from Fig.16.

268
P. R. U. Guazzelli et al.
Fig. 15 Simulated results of SCIG speed, torque, currents and rotor ﬂux for a reactive power step
change from 0 to 400 VAr, at 1200 rpm
5.4
Performance Indexes
Figure18 shows the SCIG torque ripple factors, the grid active power ripple factors,
and the grid current THDs for each technique, for seven speed ranging from 800 to
1600 rpm. The ripple factors were calculated according (25), and the THD of the
current considered the 50 ﬁrst harmonic components, according (26).
fr(x) = 100% RMS(xAC)
RMS(xDC)
(25)
THD(i) = 100%
	
50
n=1 I 2n
I1
(26)

Variable Speed Drives for Household Wind Energy Systems …
269
Fig. 16 Simulated results of DC bus voltage and grid currents and power for a reactive power step
change from 0 to 400 VAr, at 1200 rpm
Fig. 17 Simulated results of
DC bus voltage and grid
currents and power for a
reactive power step change
from 0 to 400 VAr, at
1200 rpm—detailed
comparison of the four
techniques

270
P. R. U. Guazzelli et al.
Fig. 18 Performance Indexes—SCIG Torque Ripple Factor (a), grid active power ripple factor (b)
and grid current THD (c) for a range of simulations at different SCIG speeds under applied torque
of 7 Nm
PCC-CR generally depicted larger ripple factors than PCC-C, as well as larger
THDs. Therefore, the reduction on the universe of voltage vectors did impacted on
the performance. The decoupling of the cost functions in PCC-D1 impacted with
generally lower ripple factors than PCC-CR, but with generally larger THDs. The
addition of duty cycle optimization in PCC-D2 managed to improve the overall
performance, with ripple factors consistently lower than the other three techniques,
by a far margin. On the other hand, the current THD was generally reduced when
compared to PCC-CR and PCC-D1, but still surpassed by PCC-C.
6
Conclusions
This work evaluated the use of FCS-MPC in a variable speed drive comprised of a
SCIG and a NSC, a reduced switch count converter, which is an interesting choice
for small-size systems, such as the ones for household applications usually found in
smart grid systems. After the deﬁnition of the prediction and cost functions stages of
FCS-MPC, special attention was devoted to the implementation of the enumeration

Variable Speed Drives for Household Wind Energy Systems …
271
voltage vectors, and also to the system steady-state performance. As a result, four
different PCCs were presented, with improvements in the VV enumeration and in
the addition of duty cycle optimization.
Simulated results showed how the improvements of FCS-MPC reduced the torque
and active power ripple factors of the system. Additionally, PCC-D1 and PCC-D2
providedacontrolstructurewhichresultsinsmallercomputationalburdensinembed-
dedapplications, mitigatinganFCS-MPCknowndrawback. Also, thesystemshowed
itself feasible in a wide array of situations, from steady-state condition to dynamic
test of torque chance, and also of reactive power compensation. Therefore, this work
stimulates the application of FCS-MPC and of the NSC to household wind energy
systems, in smart grid systems.
Acknowledgements Authors would like to thank the Pró-Reitoria de Pesquisa da USP, the Con-
selho Nacional de Desenvolvimento Cientíﬁco e Tecnológico and the Coordenação de Aperfeiçoa-
mento de Pessoal de Nível Superior—under Finance Code 001, for the ﬁnancial support.
Appendix
See Table4.
Table 4 System and control parameters for the simulation results
Parameter
Value
Unit
Parameter
Value
Unit
Rated torque
6.1
Nm
Pre-processing
(low-pass ﬁlter)
660
Hz
Rated voltage
(△/Y)
73/127
V
Measurement
frequency
20
kHz
Rated speed
1750
rpm
Outer control
frequency
(PCC-C and
PCC-CR)
20
kHz
Rated rotor ﬂux
0.21
V·s
Outer control
frequency
(PCC-D1 and
PCC-D2)
10
kHz
ψ∗
2d
0.21
V·s
Inner control
frequency
1
kHz
R1
0.8088

Cdc
750
μF
R2
0.2648

L f
8.5
mH
L1
33.1
mH
R f
0.167

L2
33.1
mH
v∗
dc
357
V
L H
29.5
mH
Grid line voltage
73
V
p
2
–
Grid frequency
60
Hz
K P (ψ2d)
40
–
K P (vdc)
0.05
–
KI (ψ2d)
400
–
KI (vdc)
1.25
–

272
P. R. U. Guazzelli et al.
References
1. Paulo RU, Guazzelli, et al (2022) Model predictive control with duty cycle optimization and
virtual null vector for induction generator with six switch converter. IEEE J Emerg Sel Top
Power Electron 1–1. DOI: https://doi.org/10.1109/JESTPE.2022.3169639
2. Guazzelli PRU (2018) Dual predictive current control of grid connected nine-switch converter
applied to induction generator. In: 13th IEEE international conference industry applications
(INDUSCON), pp 1038–1044
3. dos Santos STCA et al (2020) Grid-Connected variable speed driven squirrel-cage induction
motor through a nine-switch AC/AC converter with leading power factor. In: IECON 2020 the
46th annual con ference of the IEEE industrial electronics society, pp 979–984. https://doi.org/
10.1109/IECON43393.2020.9255355
4. dos Santos STCA et al (2020) Reactive power compensation with nine-switch AC/AC converter
and predictive current control applied to a variable speed driving induction motor. In: 2020
IEEE international conference on power electronics, drives and energy systems (PEDES), pp
1–6. https://doi.org/10.1109/PEDES49360.2020.9379373
5. Hernandez M et al (2019) An analysis of performance by co-simulation of a wind PMSG using
Z-source inverter and coded wireless power control for smart grid applications. IFAC J Syst
Control 7:100035. ISSN: 2468-6018
6. Oliveira AL et al (2021) Co-simulation of an SRG wind turbine control and GPRS/EGPRS
wireless standards in smart grids. IEEE/CAA J Autom Sinica 8(3):656–663
7. AnsarianM,SadeghzadehSM,Fotuhi-FiruzabadM(2015)Optimumgenerationdispatchingof
distributed resources in smart grids. In: International transactions on electrical energy systems,
vol 25.7, pp 1297–1318
8. Kakran S, Chanana S (2018) Smart operations of smart grids integrated with distributed gen-
eration: a review. In: Renewable and sustainable energy reviews, vol 81, pp 524-535. ISSN:
1364-0321
9. Hernandez CV, Pradas AV, Telsnig T (2011) Technology roadmap—smart grids, roadmap,
international energy agency
10. Silva P et al (2019) Photovoltaic distributed generation—an international review on diffusion,
support policies, and electricity sector regulatory adaptation. In: Renewable and sustainable
energy reviews, vol 103, pp 30–39. ISSN: 1364-0321
11. Martin H et al (2022) Using rooftop photovoltaic generation to cover individual electric vehicle
demand-a detailed case study. In: Renewable and sustainable energy reviews, vol 157, p 111969
12. Kaur H, Gupta S, Dhingra A (2022) Analysis of hybrid solar biomass power plant for generation
of electric power. Mater Today: Proc 48:1134–1140
13. Chen Z, Guerrero JM, Blaabjerg F (2009) A review of the state of the art of power electronics
for wind turbines. In: IEEE transactions on power. Electronics, vol 24.8 (Aug 2009), pp 1859–
1875. ISSN: 0885-8993. https://doi.org/10.1109/TPEL.2009.2017082
14. Ni K et al (2019) Highly reliable back-to-back power converter without Redundant Bridge
Armfor doubly-fed induction generator-basedwind turbine. In: IEEE transactions on industry
applications, pp 1–1. ISSN: 0093-9994. https://doi.org/10.1109/TIA.2019.2892925
15. Trzynadlowski AM (2001) Control of induction motors. Academic Press
16. Manaullah et al (2012) Control and dynamic analysis of grid connectedvariable speed SCIG
based wind energy conversion system. In: 2012 fourth in ternational conference on computa-
tional intelligence and communication networks, pp 588–593
17. Heydari
M,
Varjani
AY,
Mohamadian
M
(2011)
A
novel
three-phase
to
three-
phaseAC/ACconverter using six IGBTs. In: 2011 2nd international conference electric power
and energy conversion systems (EPECS), Nov 2011, pp 1–7. https://doi.org/10.1109/EPECS.
2011.6126808
18. Kabir Y, Mohsin YM, Khan MM (2017) Automated power factor correction and energy mon-
itoring system. In: 2017 second international conference on electrical, computer and commu-
nication technologies (ICECCT), pp 1–5

Variable Speed Drives for Household Wind Energy Systems …
273
19. Kim G-T, Lipo TA (1996) VSI-PWM rectiﬁer/inverter system with a reduced switch count. In:
IEEE transactions on industry applications, vol 32.6, pp 1331–1337
20. Liu C et al (2009) A novel three-phase three-leg AC/AC converter using nine IGBTs. In: IEEE
transactions on power electronics, vol 24.5, pp 1151–1160
21. Su J, Sun D (2017) Model predictive torque-vector control for fourswitch three-phase inverter-
fed PMSM with capacitor voltage offset suppression. In: 2017 20th international conference
on electrical machines and systems (ICEMS), pp 1–5
22. Takahashi I, Ohmori Y (1989) High-performance direct torque control of an induction motor.
In: IEEE transactions on industry applications, vol 25.2, pp 257–264. ISSN: 00939994. https://
doi.org/10.1109/28.25540
23. Blaschke F (1971) A new method for the structural decoupling of AC induction machines. In:
Conference record IFAC. Dusseldorf, Germany, pp 1–15. ISBN: 0-8058-0426-9
24. Noguchi T et al (1998) Direct power control of PWM converter without powersource voltage
sensors. In: IEEE transactions on industry applications, vol 34.3, pp 473–479
25. Min B, Kwon B (1994) A unity power factor control for fully softwarecontrolled three-phase
PWM rectiﬁer with voltage link. In: Proceedings of IECON’94—20th annual conference of
IEEE industrial electronics, vol 1, pp 555–560
26. Zhang Z et al (2019) Advanced control strategies for back-to-back power converter PMSG wind
turbine systems. In: 2019 IEEE international symposium on predictive control of electrical
drives and power electronics (PRECEDE), pp 1–6
27. Chatri C, Ouassaid M, Labbadi M (2021) A novel nonlinear sliding mode control scheme
for PMSG based on wind energy conversion system. In: 2021 3rd international conference
on control systems, mathematical modeling, automation and energy efﬁciency (SUMMA), pp
1108–1112
28. Duong L et al (2021) A modiﬁed deadbeat current controller for ﬁeld oriented induction motor
drivers. In: 2021 international conference on system science and engineering (ICSSE), pp
241–245
29. Dahri N, Ouassaid M, YousﬁD (2020) A FOC based robust fuzzy logic controller for a wind
energy conversion system to overcome mechanical parameter uncertainties. In: 2020 IEEE
international autumn meeting on power, electronics and computing (ROPEC), vol 4, pp 1–7
30. Rodriguez J et al (2007) Predictive current control of a voltage source inverter. In: IEEE
transactions on industrial electronics, vol 54.1 (Feb 2007), pp 495–503. ISSN: 0278-0046.
https://doi.org/10.1109/TIE.2006.888802
31. Kouro S et al (2009) Model predictive control—asimple and powerful method to control power
converters. In: IEEE transactions on industrial electronics, vol 56.6 (June 2009), pp 1826–1838.
ISSN: 0278-0046. https://doi.org/10.1109/TIE.2008.2008349
32. Vazquez S et al (2017) Model predictive control for power converters and drives: advances and
trends. In: IEEE transactions on industrial electronics, vol 64.2 (Feb 2017), pp 935–947. ISSN:
0278-0046. https://doi.org/10.1109/TIE.2016.2625238
33. Rodriguez J, Cortes P (2012) Predictive control of power converters and electrical drives, 1st.
Wiley, p 230. ISBN: 9781119963981
34. Zhang X et al (2018) Three vector complete model predictive control for threephase grid-
connected inverters with LCL ﬁlter. In: 2018 13th IEEE conference industrial electronics and
application (ICIEA), May 2018, pp 1470–1475. https://doi.org/10.1109/ICIEA.2018.8397941
35. Gulbudak O, Santi E (2015) Model predictive control of dual-output nine-switch inverter with
output ﬁlter. In: 2015 IEEE energy conversion congress expo IEEE, Sept 2015, pp 1582–1589.
ISBN: 978-1-4673-7151-3. https://doi.org/10.1109/ECCE.2015.7309883
36. Gao H, BinWu, David(Dewei)Xu (2017) Nine-switch ac/ac current source converter for micro-
grid application with model predictive control. In: IET power electronics, vol 10.13 (Oct 2017),
pp 1759–1766. ISSN: 1755-4535. https://doi.org/10.1049/iet-pel.2017.0028
37. Gulbudak O, Gokdag M (2018) Predictive dual-induction machine control using nine-switch
inverter for multi-drive systems. In: 2018 IEEE 12th international conference on compatibility,
power electronics and power engineering (CPE-POWERENG 2018), Apr 2018, pp 1–6

274
P. R. U. Guazzelli et al.
38. Sze SL, Yeh EH, MA R (2016) Finite control set model predictive control of nine-switch AC,
DC, AC converter. In: IEEE international conference power energy, vol 3. IEEE, Nov 2016, pp
746–751. https://doi.org/10.1109/PECON.2016.7951658
39. Jayan V, Ghias A (2019) Finite control set model predictive control of a nine switch dual output
converter as a power quality conditioner. In: 2019 IEEE international conference on industrial
technology (ICIT), Feb 2019, pp 1241–1246. https://doi.org/10.1109/ICIT.2019.8755152
40. Gulbudak O, Gokdag M (2019) Asymmetrical multi-step direct model predictive control of
nine-switch inverter for dual-output mode operation. IEEE Access 7:164720–164733
41. Guazzelli PRU et al (2022) Decoupled predictive current control with duty-cycle optimization
of a grid-tied nine-switch converter applied to an induction generator. In: IEEE transactions on
power electronics, vol 37.3, pp 2778–2789. https://doi.org/10.1109/TPEL.2021.3115049
42. IEC (2020) Electromagnetic compatibility (EMC)—Part 3. Standard. Geneva, CH: Interna-
tional Electrotechnical Commission, Jan 2020
43. ANEEL (2018) Procedimentos de Distribuiçãode Energia Elétrica no Sistema Elétrico
Nacional-PRODIST: Módulo 8–Qualidade da Energia Elétrica. Agência Nacional de Ener-
gia Elétrica, Technical report Brasília, BR
44. Laouer M, Mekkaoui A, Younes M (2014) STATCOM and capacitor banks in a ﬁxed-speedwind
farm. Energy Procedia 50:882–892
45. IEEE (2013) IEEE standard for shunt power capacitors. In: IEEE Std 18-2012 (Revision of
IEEE Std 18-2002), pp 1–39. https://doi.org/10.1109/IEEESTD.2013.6466331
46. Jena R, Swain S, Dash R (2021) Power ﬂow simulation and voltage control in a SPV IEEE-5
bus system based on SVC. Mater Today: Proc 39:1934–1940
47. Farivar G et al (2019) Low-Capacitance StatCom with modular inductive ﬁlter. In: IEEE trans-
actions on power electronics, vol 34.4, pp 3192–3203
48. Bao L, Fan L, Miao Z (2022) Wind farms in weak grids stability enhancement: SynCon or
STATCOM? In: Electric power systems research, vol 202, p 107623
49. Ni K et al (2022) Power compensation-oriented SVM-DPC strategy for a fault- tolerant back-
to-back power converter based DFIM shipboard propulsion system. In: IEEE transactions on
industrial electronics, vol 69.9, pp 8716–8726
50. Costa P et al (2018) Single-Stage grid tied converter to improve solar PV array performance and
powerqualityinmicrogeneration-consumersunits.In:201813thIEEEinternationalconference
on industry applications (INDUSCON), pp 722–729
51. Heydari M, Fatemi A, Varjani AY (2017) A reduced switch count three-phase AC/AC converter
with six power switches: modeling, analysis, and control. IEEE J Emerg Sel Top Power Electron
5.4:1720–1738. ISSN: 2168-6777. https://doi.org/10.1109/JESTPE.2017.2720722
52. Jibhakate CN, Chaudhari MA, Renge MM (2018) Reactive power compensation using induc-
tion motor driven by nine switch AC-DC-AC converter. In: IEEE Access, vol 6, pp 1312–1320.
ISSN: 2169-3536. https://doi.org/10.1109/ACCESS.2017.2778291
53. Vas P (1990) Vector control of AC machines. Monographs in electrical and electronic engi-
neering. Clarendon Press, p 332. ISBN: 9780198593706
54. Golestan S et al (2014) Moving average ﬁlter based phase-locked loops: performance analysis
and design guidelines. In: IEEE transactions on power electronics, vol 29.6, pp 2750–2763.
10.1109/TPEL. 2013.2273461
55. GolestanS,GuerreroJM,VasquezJC(2017)Three-PhasePLLs:AReviEWofrecentadvances.
In: IEEE transactions on power. Electronics, vol 32.3 (Mar 2017), pp 1894–1907. ISSN: 0885-
8993. https://doi.org/10.1109/TPEL.2016.2565642
56. Bazzo WA, do Vale Pereira LT (2009) Introdução áEngenharia: Conceitos, Ferramentas e
Comportamentos. 2nd ed. Florianópolis: Editora da UFSC, p 270. ISBN: 978-85.328.0455-6
57. Couto EB (1996) Identiﬁcação paramétrica de um motor de indução trifásico através de ensaio
degrau em corrente contínua. Dissertação de Mestrado em Engenharia Elétrica. São Carlos,
Brazil: Escola de Engenharia de São Carlos, Universidade de São Paulo, p 88
58. Rolim LGB, da Costa DR, Aredes M (2006) Analysis and software implementation of a robust
synchronizing PLL circuit based on the PQ theory. In: IEEE transactions on industrial elec-
tronics, vol 53.6 (Dec 2006), pp 1919–1926. ISSN: 0278-0046. https://doi.org/10.1109/TIE.
2006.885483

Variable Speed Drives for Household Wind Energy Systems …
275
59. Zhang Y, Yang H (2014) Model predictive torque control of induction motor drives with optimal
duty cycle control. In: IEEE transactions on power. Electronics, vol 29.12 (Dec 2014), pp 6593–
6603. ISSN: 0885-8993. https://doi.org/10.1109/TPEL.2014.2302838
60. Guazzelli PRU (2021) Controle preditivo de estados ﬁnitos de gerador de indução gaiola de
esquilo com conversor compartilhado de nove chaves. Tese de Doutorado. PhD thesis. São
Carlos: Escola de Engenharia de São Carlos, Universidade de São Paulo, Apr 2021
61. Santos S (2021) Operação de motor de indução trifáasico conectado á rede por meio de um
conversor de nove chaves com fator de potêencia adiantado. MA thesis. São Carlos: Escola de
Engenharia de São Carlos, Universidade de São Paulo, Feb 2021
62. Anaya-Lara O et al (2009) Wind energy generation: modelling and control. 1st ed. Wiley,
Chichester, p 288. ISBN: 978-0-470-71433-1

Electromagnetic Analysis of a DFIG‘s
Controlled Operation Using Finite
Elements Method
André L. L. F. Murari, J. S. Solís-Chaves, Ademir Pelizari,
Alfeu J. Sguarezi Filho, Bruno H. P. da Silva, and Renato M. Monaro
Abstract The Doubly Fed Induction Generator (DFIG) is widely employed in wind
energy and this type of source is interesting to the smart grids environment. In
this way, this chapter proposes an electromagnetic analysis using the ﬁnite element
method for the DFIG based Wind Energy System, during its vector controlled oper-
ation by means of a proportional-integral (PI) controller. Moreover, a new design
method for the PI controller gains obtention is presented, based on the fact there
is no guarantee that the DFIG will operate in the unsaturated condition. Therefore,
it can compromise the performance of the power control strategy. Simulation and
experimental results endorse the analyzes during DFIG normal operating conditions.
1
Introduction
In order to meet the ever-growing demand for electricity in the current world context,
it is necessarytoinvest inpower generationmethods usingrenewableprimarysources
with maximum possible efﬁciency. Today, the highlight is to produce electricity from
the force of the winds (wind power), for it is the fastest growing in the world.
The commonly used machines for converting wind energy into electrical are
mainly synchronous and induction generators. Since wind speed is not constant,
A. L. L. F. Murari · A. Pelizari · A. J. S. Filho
Center for Engineering, Modeling and Applied Social Sciences (CECS), Federal University
of ABC (UFABC), Santo André, SP, Brazil
e-mail: alfeu.sguarezi@ufabc.edu.br
A. Pelizari
e-mail: ademir.pelizari@ufabc.edu.br
J. S. Solís-Chaves (B)
Mechatronic Engineering Department, ECCI University, Bogotá, DC, Colombia
e-mail: jsolisc@ecci.edu.co
B. H. P. da Silva · R. M. Monaro
Polytechnic School, University of São Paulo (USP), São Paulo, SP, Brazil
e-mail: monaro@usp.br
© The Author(s), under exclusive license to Springer Nature Switzerland AG 2024
A. J. Sguarezi Filho et al. (eds.), Smart Grids—Renewable Energy, Power Electronics,
Signal Processing and Communication Systems Applications, Green Energy
and Technology, https://doi.org/10.1007/978-3-031-37909-3_10
277

278
A. L. L. F. Murari et al.
wind generation systems must operate at variable speed using power electronics
devices have been adopted. The doubly-fed induction generator (DFIG) working in
variable speeds systems is an efﬁcient technology due to its accurate control and the
low cost of back-to-back (partial scale) converter, compared with ﬁxed speed induc-
tion squirrel cage generators and variable speed generators operating with full-scale
converters [1, 2].
Vector control is the most widely used technique to operate DFIG wind turbine
systems. It is based on stator-ﬂux or stator-voltage orientation [3, 4]. This tech-
nique allows controlling active and reactive power independently by regulating rotor
current. Some researchers investigate the use of PI controllers and stator-ﬂux ori-
entation [5–7]. The PI gains design was studied in electrical machine drives using
Bode diagram as presented in [8]. Regarding the PI gains design of DFIG, Marques
[9] applied the eigenvalues to reach this objective with interesting results. However,
the choice of the model can increase its complexity. Works as [10, 11] apply the pole
compensation technique to design the PI gains in power and current loops control
for DFIG, respectively. Another possibility is using the Modulus Optimum and the
Symmetrical Optimum as is shown by [12].
The model used herein has some simpliﬁcations who can degrade the performance
of the controllers. Advanced controllers for DFIG-based Wind Energy Systems cover
a range from mathematically complex techniques such as model-based predictive
control, including several control strategies as GPC [13], Repetitive Control, etc. to
Artiﬁcial Intelligence techniques such as fuzzy control [14], neural networks and
optimization methods such as PSO [15]. An interesting compilation of most relevant
and popular MPBC DFIG control techniques are presented in [16] including pre-
dictive control techniques with modulator and ﬁnite control sets with experimental
results.
Regarding the DFIG presence in some micro-grids/smart-grids scenarios based
in renewable energy systems are studied in works as [17, 18]. In this, a frequency
control of a DFIG working in a micro-grid is proposed using a modiﬁcation to the
MPPT strategy must be made. These modiﬁed wind turbines have a new Grid Side
Converter (GSC) that governs DC voltage control in the Back-to-Back capacitor, as
is also shown in [18].
In DFIG power control, the machine operates below its rated values. Hence, the
applied voltages and currents are limited under their rated values, which means
that the ferromagnetic material does not operate over-saturated. However, there is
no guarantee that the machine will operate in the unsaturated condition in which
compromise the performance of the power control. Hence, the ﬁnite element methods
can be a powerful tool for DFIG analysis during the controlled operation [19–21].
In this chapter, a design for the PI controller gains by applying the symmetrical
optimum methods for DFIG power control is proposed. In this, the power control is
achieved by rotor current control, as there is no guarantee that the DFIG will operate
in the unsaturated condition during the power control. The analysis of the DFIG
conditions in terms of magnetic induction, using computational simulations by the
FEM has been also proposed, in order to verify and to estimate the DFIG induction
levels and thus ensure that the controller operation ensure the machine non-saturation

Electromagnetic Analysis of a DFIG‘s …
279
condition. These are the contributions of this work. Also, experimental results from
a setup during the controlled operation, endorse the proposed PI design method.
2
Wind Generation Outlook
Wind generation is leading the transition from fossil fuels to clean energy production.
Top 12 displayed in the pie diagram in Fig.1 illustrates the consolidation of North
American and European markets. The installed global wind power on shore capacity
is around 707.37 GW at the end of 2019, a growth of 4.5% compared to the end of
2019 (620.96 GW). The off shore total installed capacity is 35.29 MW at the end
of 2020 [22]. This is shown in Fig.2. A Brazilian Wind Energy panorama is also
presented in Sect.2.2.
2.1
Worldwide Wind Generation
Of all WWG capacity, just 6.06 GW of new onshore wind turbines capacity was
installed in 2021, a decrease of 2% compared to 2020 (with 6.24 GW). Moreover,
Fig.1 shown the unstoppable expansion of Asian markets, with India as a major
example of this fast growth up with a total of 38.6 GW at the end of 2020 (an
increase of 1 GW compared to 2019).
Latin American markets are growing faster, with Brazil as a good example with
17.7 GW, meaning a 3% of the global cumulative capacity. The onshore market
for this region is promising and shown a growth in countries as Mexico, Chile and
Argentina, with 6,7, 2,6 and 2.8 GW, respectively.
The offshore wind turbines market falls by 0.5%, from 6.24 GW in 2019 of new
wind farm installations to 6.06 GW in 2020. In Fig.2 can be shown the Total of WG
offshore installations at December 2020 [22].
China is in the ﬁrst position with 37% of the world total, including 211392 MW of
total installations. The total installed onshore wind grew by 9%, whilst total offshore
wind grew by 20%, reaching 23 GW.
GWEC forecasts [22] that offshore wind will become an increasingly global mar-
ket. If governments remain committed, and projects and investments continue, annual
installations in Asia could reach 5 GW or more each year. In the USA, GWEC expects
the developing offshore wind market to reach 1 GW by 2023.
2.2
Brazilian Wind Generation
Brazil has more than 468 wind power projects in operation from 2017 and at the end
of the 2022, totaling 752 wind turbines accounting for more than three quarters of the

280
A. L. L. F. Murari et al.
Fig. 1 Total on shore installations [MW]—Dec. 2020
Fig. 2 Total off shore installations [MW]—Dec. 2020

Electromagnetic Analysis of a DFIG‘s …
281
Fig. 3 Wind energy in Brazil—2020. Adapted from [24]
installations in South America, with 12332.15 MW. Figure3 shows the generated
wind power in Brazil. States in white color do not have wind energy generation.
States as Rio Grande do Norte, Bahía Ceará and Rio Grande do Sul, are in the top
of the installed Brazilian capacity [23].
Brazilian Wind generation reached 424 T Wh, which represents an increase of
26.5%, wind power is around 12.763 MW with an expansion of 21.3% at the end of
2017 [23]. Precisely, the North–eastern Region which most contributes to this type
of generation with 6.75 GW, the South Region has a 1.78 GW of power generated
and in South–eastern Region the power generated just becomes 28.2 MW [24–26].
In fact, 98 projects are currently working in that Brazilian region. Ceará state has
the biggest Wind Turbine with a rated power of 105 MW named Praia Formosa
and Paraíba has the smallest unit (Milennium) with a rated power of 10.2 MW. The
wind energy produced in the North–Eastern Region accounts for 77% of total energy
generated in this way in Brazil in the same period [25–27].
3
Machine Model and Rotor Current Vector Control
Doubly fed induction generator equations considering synchronous reference frame
(dq) can be expressed by [28, 29], as follows:

282
A. L. L. F. Murari et al.
Vdqs = Rsidqs + dψdqs
dt
+ jωsψdqs
(1)
Vdqs = Rsidqr + dψdqr
dt
+
ωslip



j(ωs −P Pm) ψdqr
(2)
a relationship between ﬂuxes and currents is:
ψdqs = Lsidqs + Lmidqr
(3)
ψdqr = Lmidqs + Lridqr
(4)
and generator active (Ps) and reactive (Qs) power are:
Ps = 3
2(vdsids + vqsiqs)
(5)
Qs = 3
2(vqsids −vdsiqs)
(6)
Subscripts s and r represent the stator and rotor parameters respectively, ωs is
the synchronous speed, ωm is the mechanical speed, ωr is the angular frequency
of voltage and currents of the rotor windings, Rs and Rr are the stator and rotor
windings electrical resistance (per phase), Ls , Lr and Lm are the proper and mutual
inductances of the stator and rotor windings, v , i and ψ are the voltage, current and
ﬂux space vectors respectively, P P is the machine number of pair of poles. In this
paper, mechanical speed m is an input of the DFIG.
The main characteristic of the DFIG power vector control is the stator active (Ps)
and reactive (Qs) power control independence by the rotor current regulation. For
this purpose, Ps and Qs are expressed as functions of each rotor current, idr and iqr.
Using the stator ﬂux-oriented control, which decouples the dq reference frame ψds
= ψs = |ψdqs|and ψqs = 0 means, (3) becomes:
ids = ψs
Ls
−Lm
Ls
idr
(7)
iqs = −Lm
Ls
iqr
(8)
In the same way, using stator ﬂux-oriented the stator voltage becomes vds = 0 and
vqs = vs = |Vdqs|. Hence, the Ps (5) and Qs (6) power can be computed by using (7)
and (8):
Ps = −3
2vs
Lm
Ls
iqr
(9)

Electromagnetic Analysis of a DFIG‘s …
283
Fig. 4 DFIG control overview
Qs = 3
2vs
ψs
Ls
−Lm
Ls
idr

(10)
Thus, it is possible to control the DFIG active and reactive powers by control-
ling the rotor currents. In order to regulate the rotor currents, proportional integral
controllers (PI) can be used as is presented in Fig.4.
4
Converter Control Tuning
The rotor circuit differential equations (2), (3) and (4) can be rewritten as (11) and
(12):
vdr = Rridr −ωrσ Lriqr + σ Lr
didr
dt + Lm
Ls
dψds
dt
(11)
vqr = Rriqr −ωrσ Lridr + σ Lr
diqr
dt + ωr
dψds
dt
(12)
where σ = 1 −
L2
m
Ls Lrs .
In order to facilitate the control design (11) and (12) can be simpliﬁed to (13)
and (14) considering dψds
dt
= 0 (utility voltage constant) and treating (Lm/Ls)ψds
as perturbation [29].

284
A. L. L. F. Murari et al.
vdr = Rridr −ωrσ Lriqr + σ Lr
didr
dt
(13)
vqr = Rriqr −ωrσ Lridr + σ Lr
diqr
dt
(14)
Note the cross-coupling terms −ωrσ Lriqr and −ωrσ Lridr between the two axis,
its decoupling can be obtained by deﬁning vdr and vqr as is explained in [30]:
vdr = vdr + ωrσ Lriqr
(15)
vqr = vqr −ωrσ Lridr
(16)
Applying the Laplace transformation in (13) and (14), idr and iqr respond to vdr
and vqr respectively, using a ﬁrst-order transfer function Hr(s),
Hr(s) =
idr
vdr
=
iqr
vqr
=
1/Rr
1 + τrs
(17)
where τr = σ Lr
Rr .
The PWM generator is taken into account by Hd(s), a ﬁrst-order transfer function
[11],
Hd(s) = vout
vctrl
=
1
1 + ταs
(18)
where vctrl and vout are the input control and output voltages, respectively. τα is
a time delay related to control computation and PWM generation, for the sake of
simplicity, it is taken as the inverse of the PWM carrier frequency, τα = 1/f pwm.
Given a controller Gc(s), a decoupled control is obtained by the feedback loop:
vref
dr = Gc(s)(iref
dr −idr) −ωrσ Lriqr
(19)
vref
qr = Gc(s)(iref
qr −iqr) −ωrσ Lridr
(20)
where the superscript ref represents the reference values.
Figure5 shows the block diagram for idr and iqr currents control considering the
transfer functions afore-presented.
The open loop transfer function is,
HOLr(s) = Hd(s)Hr(s) =
1/Rr
(1 + ταs)(1 + τrs)
(21)
as τα >> τr then
1
1+τrs can be approximated to
1
τrs [19], which implies that HOLr(s)
can be simpliﬁed to:
H approx
OLr
(s) =
1/Rrτr
(1 + ταs)s
(22)

Electromagnetic Analysis of a DFIG‘s …
285
Fig. 5 Current control diagram block
Using (22), the symmetrical optimum method can be applied to tune a PI con-
troller. This method was chosen for its several advantages such as phase margin
maximization, good perturbation rejection and simple and well-deﬁned tuning rela-
tions [31]. The PI parameters (23) can be calculated with (24) [32].
Gc(s) = K p
1 + Tis
Tis
(23)
Ti, K p =

a2Tα
Rrτr
αTα
	
(24)
A lower value of a leads to faster response but worse damped [30].
5
Performance Evaluation of Different Adjustment
Methods
Considering a 3kW 380V DFIM, the parameters of which are available in Table7, the
current PI controllers were designed according to the method described in Sect.2. In
order to evaluate the proposed theoretical method adjustment, simulation and exper-
imental analyses were performed. Only the performance analysis was performed in
the response of the controller seeing that the DFIG control operation is well doc-
umented in the literature [29] and, also, because the magnetic analysis is the other
objective of this paper.

286
A. L. L. F. Murari et al.
Table 1 PI current loop settings
Setting
α
kp
ki
1
2
ωcTα
57.08
2.82 × 104
2
1
ωcTα
114.16
2.25 × 105
3
–
3.63
626.44
Fig. 6 Theoretical step
response
Table1 summarizes three design conﬁgurations applied, of which the ﬁrst two
were based on the optimum symmetric method by varying parameter α, and the last
one based on the method proposed by [33], which discusses the PI adjustment using
the pole compensation method. As a design criterion, a response time of 10ms was
deﬁned in order to obtain the controller gains, described in equations (25) and (26).
kp =
1
5 × 10−3 σ Lr
(25)
ki =
1
5 × 10−3 Rr
(26)
In Table1, ωc refers to the open-loop crossover frequency considered as one order
of magnitude smaller than the PWM switching frequency to avoid noise [30]. Figure6
shows the theoretical step response considering the control block diagram shown in
Fig.5.
Figure6 allows observing that setting #2 has the fastest time response but with
high overshoot. The ﬁrst adjustment has lower rise time but faster damping. The third
conﬁguration showed the slowest rise-time but it does not presented overshoot. The
performance indicators of each conﬁguration are presented in Table2; the settling
time is computed considering a 2% error band.
To further evaluate the PI controllers adjustment an electromagnetic transient
simulation of a DFIG machine, the rotor side converter and its rotor current control
were performed with the Matlab/Simulink software.

Electromagnetic Analysis of a DFIG‘s …
287
Table 2 Control performance indicators
Setting
Rise time
Settling time* (%)
Overshoot
#1
0.18 [ms]
1.34[ms]
20.51
#2
0.48 [ms]
3.81 [ms]
6.48
#3
10.87 [ms]
19.41[ms]
0.0
* 2% error band
Fig. 7 Simulation step
response for iqr
The DFIG parameters are available in Appendix A in Table7. A time step of 1
µs was used. The DFIG stator was connected directly to an 380 VLL, rms, 60Hz
ideal three-phase voltage source. The DC capacitor and the grid side converter was
replaced by an ideal 680 VDC voltage source. A two level voltage source converter
(VSC) operating with 100kHz PWM frequency was used to supply the DFIG rotor
windings.
Figure7 shows the iqr step response simulation considering the three PI controller
settings. For this test the mechanical speed was set to 90% of synchronous angular
frequency andidr was set to zero. The rise-times for setting #1 and #2 are similar to the
values observed in the theoretical analysis. On the other hand setting #3 presented
a smaller rise-time than expected. Considering the overshoot, setting #1 shows a
small increase in comparison to the theoretical analysis; setting #2 presents a small
reduction for the expected value and setting #3 displays a signiﬁcant increase (from
0%toapprox21%).Itisworthnotingthatnolimiterswereemployedinthecontrollers
simulation.
Differences between the theoretical and simulation analysis results can be
attributed to simpliﬁcations used to obtain simpliﬁed decoupled transfer functions.
Also, the response of idr in which iqr was set to 1 A, is presented in Fig.8 and it has
nearly the same behavior.
In order to validate the simulation results and the PI gains design an experimental
setup was used. The proposed PI gains were implemented in a real DFIG with the
same characteristics used for the theoretical and simulation analyses. The DFIG is
driven by a 3 kW Direct Current Motor (DCM). The controller was embedded in

288
A. L. L. F. Murari et al.
Fig. 8 Simulation step
response for idr
Fig. 9 Experimental setup
a digital signal processor (DSP) Texas Instruments TMS320F335, using electronic
boards for signal conditioning, and an encoder with 3600 pulses per revolution. The
space vector modulation used a 10 kHz switching frequency. The DFIG parameters
are presented in Appendix A in Table7. This bench is shown in Fig.9.
For each controller design evaluated a set of step response analysis was performed.
Figure10 shows one test in which the reference for iqr was changed from −1 A to −3
A at t = 0 s and idr was adjusted to 1 A. Also, Fig.11 shows another test in which
the reference for idr was changed from 1 A to 3 A at t = 0 s and and iqr was adjusted
to 2 A. For these tests the DFIG operate at sub-synchronous speed with 10% slip.
The rise-time and overshoot for the three PI design are similar to the values obtained
from the simulation analysis.
Small differences between simulation and experimental results can be explained
by the signal condition delay, signal acquisition errors and controller limiters
(required for safe operation) not considered in the simulation stage. Based on the the-
oretical, simulation and experimental analysis, setting #1 had a better performance,
small overshoot and good setting-time. It also presented consistent response for the
three analyses performed. The results show that the optimum symmetric method

Electromagnetic Analysis of a DFIG‘s …
289
Fig. 10 Experimental step
response for iqr
Fig. 11 Experimental step
response for idr
considering the parameter α =
1
ωcTα with Tα = 1/f pwm and ωc an order smaller that
the switching frequency is a good design rule to determine PI gains applied to DFIG
rotor current control.
6
Finite Element Method Simulation
The main goal of the ﬁnite element method simulation is to estimate under a speciﬁc
value of slip the ﬂux density level in the ferromagnetic material of the induction
generator. Based on the stator and rotor ﬂux densities levels, it is possible to check
some potential saturation that can to hinder the operation of the control system
behavior. Inasmuch as the machine operate in a DFIG arrangement, the injection of
currents in the rotor is required by a power converter to maintain the correct frequency
and power to the grid.
Thus, two simulations were made using two different values of current in the rotor.
At a ﬁrst simulation, a current of 3.16 A was injected into to the slip rings. During
the second simulation, a value of 2.23 A was used. In both situations, a rotor current
frequency of 6 Hz was adopted according to the condition of the slip. These values
of current and frequency were obtained during the laboratory tests in the prototype.

290
A. L. L. F. Murari et al.
Table 3 DFIG prototype data
DFIG general data
Type
WRIG
Number of phases
3
Rated power
3,0 [kW]
Poles
4
Rated speed
1700 [rpm]
Table 4 DFIG Stator data
Stator data
Number of slots
36
Winding
Double layer
Coil pitch
12(slots)
Rated stator voltage (Y)
220 [V]
Rated rotor voltage (Y)
380 [V]
Rated rotor current
11,5 [A]
Source Author’s own
Table 5 DFIG rotor data
Rotor data
Type
Slip rings
Number of slots
27
Winding
Double layer
Coil pitch
7 (slots)
Source Author’s own
Tables3, 4 and 5 show the data of the prototype installed in the LEPS (Laboratory
of Renewable Energy and Power Electronics) at the Universidade Federal do ABC
(UFABC).
7
Magnetic Transient Simulation
To evaluate the DFIG controller operation a magnetic transient regime was applied.
The purpose of the magnetic transient regime simulation is to evaluate the ﬂux
density levels in the ferromagnetic material of the DFIG. The problem formulation
with constant speed, according to the Equation (27), is [34];
▽× v▽× A = J −σx
∂A
∂t −σx▽V + ▽× HC + σxω × ▽× A
(27)

Electromagnetic Analysis of a DFIG‘s …
291
Table 6 DFIG simulation data
Simulation data
Scalar electric potential (V)
220[V]
Operation speed (v)
1619,4 [rpm]
Grid frequency
60 [Hz]
Rotor frequency(s = 60.0,10003184)
6 [Hz]
Simulation time
0,02 [s]
Time step
0,0002 [s]
Were the constants v, σx and ω are magnetic reluctivity, electric conductivity and
the speed in steady state, respectively. In the same equation, V is the source scalar
electric potential; HC is the permanent magnet coercive force, which is zero in this
case, seeing that there are not permanent magnets; vector J is the current density of
the conductors and A is the potential vector. Table6 shows the quantities used in this
simulation.
Due the limited memory size of the computer as well as the symmetry of the
problem, it is much more convenient to use half of the geometry. Figure12 represents
the detailed geometry used and in Fig.13 the boundary conditions of A vector are
shown.
The ferromagnetic material used during the simulation step was the 1010 carbon
steel in which the BH magnetization curve is presented in Fig.14.
Figures15 and 16 represent the results from the computational simulations. The
color maps show the levels of ﬂux density in the stator and in the rotor of the induction
generator according to the conditions described in the experimental results section.
Fig. 12 Detail of the DFIG geometry: a Stator and rotor. b Winding stator. c Winding rotor

292
A. L. L. F. Murari et al.
Fig. 13 Speciﬁc boundaries, physical properties and moving band for magnetic transient analysis
for DFIG
Fig. 14 DFIG BH curve of the 1010 carbon steel used in the stator and in the rotor
8
Conclusions
This chapter proposed a design for the gains in the PI controller for a ﬁeld-oriented
control of DFIG by using the symmetrical optimum methods. Also, magnetic anal-
yses during control operation are performed. The correct selection of the gains will
impact the system response with a null steady-state error. The simulation and exper-
imental results endorse the proposal during the DFIG operation and present several
desired responses.
Hence, the magnetic analysis was performed to guarantee that the DFIG will oper-
ate in the unsaturated condition during the control operation. The simulation results,
in all parts of the geometry, show that the ﬂux densities obtained were under the sat-

Electromagnetic Analysis of a DFIG‘s …
293
Fig. 15 Flux density color map for a RMS current of 2,23 [A] in the DFIG rotor
Fig. 16 Flux density color map for a RMS current of 3,16 [A] in the rotor
uration point of the ferromagnetic material used which is about 2.1 T ; consequently,
the control system can operate correctly, avoiding perturbation during the operation
without saturation.
Appendix A: Doubly-Fed Induction Generator Parameters
See Table7.

294
A. L. L. F. Murari et al.
Table 7 Data used in the
tests
Nominal values
Stator active power
PN
3.5 [kW]
Per phase voltage
VN
220 [V]
Stator Frequency
f
60 [Hz]
Pair of poles number
P P
2
Parameters
Stator resistance
Rs
1 []
Rotor resistance
Rr
3.13 []
Magnetizing inductance
Lm 192 [mH]
Stator inductance
Ls
200 [mH]
Rotor inductance
Lr
200 [mH]
Moment of inertia
J
0.45 [kg × m2 ]
References
1. de Almeida LAL et al (2016) An impulsive noise ﬁlter applied in wireless control of wind tur-
bines. In: Renewable Energy, vol 86, pp 347–353. ISSN: 0960-1481. https://doi.org/10.1016/j.
renene.2015.07.070. https://www.sciencedirect.com/science/article/pii/S0960148115301658
2. Datta R, Ranganathan VT (2002) Variable-speed wind power generation using doubly fed
wound rotor induction machine-a comparison with alternative schemes. In: IEEE transactions
on energy conversion, vol 17.3, pp 414–421. https://doi.org/10.1109/TEC.2002.801993
3. Hopfensperger B, Atkinson DJ, Lakin R (2000) Stator-ﬂux-oriented control of a doubly-fed
induction machine: with and without position encoder. In: Electric power applications, vol
147.4, pp 241–250. https://doi.org/10.1049/ipepa:20000442
4. Shen B, Ooi BT (2005) Novel sensorless decoupled P-Q control of doubly-fed induction gen-
erator (DFIG) based on phase locking to Gamma-Delta frame. In: 2005 IEEE 36th power elec-
tronics specialists conference, pp 2670–2675. https://doi.org/10.1109/PESC.2005.1582010
5. Tapia A et al (2003) Modeling and control of a wind turbine driven doubly fed induction
generator. In: IEEE transactions on energy conversion, vol 18.2, pp 194–204. https://doi.org/
10.1109/TEC.2003.811727
6. Pena R et al (2008) Sensorless control of doubly-fed induction generators using a rotor-current-
based MRAS observer. In: IEEE transactions on industrial electronics, vol 55.1, pp 330–339.
https://doi.org/10.1109/TIE.2007.896299
7. Jacomini VR (2008) Power ﬂux control of doubly fed induction generator operating at sub-
synchronous speeds. University of Campinhas - UNICAMP, Dissertaçao de Mestrado, Camp-
inhas
8. Briz F, Degner MW, Lorenz RD (2000) Analysis and design of current regulators using complex
vectors. In: IEEE transactions on industry applications, vol 36.3, pp 817–825. https://doi.org/
10.1109/28.845057
9. Marques J, Pinheiro H (2005) Dynamic behavior of the doubly-fed induction generator in
stator ﬂuxvectorreference frame. In: 2005 IEEE 36th power electronics specialists conference,
pp 2104–2110. https://doi.org/10.1109/PESC.2005.1581923
10. Poitiers F, Bouaouiche T, Machmoum M (2009) Advanced control of a doubly-fed induc-
tion generator for wind energy conversion. In: Electric power systems research, vol 79.7,
pp 1085–1096. ISSN: 0378- 7796. https://doi.org/10.1016/j.epsr.2009.01.007. https://www.
sciencedirect.com/science/article/pii/S0378779609000352

Electromagnetic Analysis of a DFIG‘s …
295
11. Murari ALLF et al (2017) A Proposal of Project of PI controller gains used on the Control of
doubly-fed induction generators. In: IEEE Latin America transactions, vol 15.2, pp 173–180.
https://doi.org/10.1109/TLA.2017.7854609
12. Flores V (2013) Ride-through fault capability improvement through novel control strategies
applied for doubly-fed induction wind generators. PhD thesis. Belo Horizonte, MG: Federal
University of Minas Gerais, Sept 2013
13. Solís-Chaves JS et al (2019) A long-range generalized predictive control algorithm for a DFIG
based wind energy system. IEEE/CAA J Automatica Sinica 6.5:1209–1219. https://doi.org/
10.1109/JAS.2019.1911699
14. Rocha-Osorio CM et al (2019) Power control of a doubly fed induction wind generator employ-
ing a takagi-sugeno fuzzy logic controller. In: 2019 IEEE 15th Brazilian power electronics con-
ference and 5th IEEE southern power electronics conference (COBEP/SPEC), pp 1–6. https://
doi.org/10.1109/COBEP/SPEC44138.2019.9065821
15. Rodrigues LL et al (2020) Predictive incremental vector control for DFIG with weighted-
dynamic objective constraint-handling method-PSO weighting matrices design. In: IEEE
Access 8:114112–114122. https://doi.org/10.1109/ACCESS.2020.3003285
16. Filho AJS, Model predictive control for doubly-fed induction generators and three-phase
power converters, vol 222. Elsevier. ISBN: 9780323909648. https://doi.org/10.1016/C2020-
0-01024-8
17. Prieto-Cerón CE et al (2022) A generalized predictive controller for a wind turbine providing
frequency support for a microgrid. In: Energies. https://doi.org/10.3390/en15072562. http://
doi.org/10.3390/en15072562
18. Gomez L et al (2020) Combined control of DFIG-based wind turbine and battery energy storage
system for frequency response in microgrids. In: Energies, vol 13.4, p 894
19. Strous T et al (2016) Saturation in brushless doubly-fed induction machines. English. In: 8th
IET international conference on power electronics, Ma396 chines and drives (PEMD 2016).
PEMD 2016 : 8th international conference on power electronics, PEMD 2016; conference date:
19 Apr 2016 Through 21 Apr 2016. IET, 2016, pp 1–7. ISBN: 978-1-78561-188-9. https://doi.
org/10.1049/cp.2016.0274
20. Wang F et al (2015) Model-Based predictive direct control strategies for electrical drives:
an experimental evaluation of PTC and PCC methods. In: IEEE transactions on industrial
informatics, vol 11.3 (June 2015), pp 671–681. ISSN: 1551-3203. https://doi.org/10.1109/TII.
2015.2423154
21. Seman S, Niiranen J, Arkkio A (2006) Ride-Through analysis of doubly fed induction wind-
power generator under unsymmetrical network disturbance. In: IEEE transactions on power
systems, vol 21.4, pp 1782–1789. https://doi.org/10.1109/TPWRS.2006.882471
22. GWEC (2021) GlobalWind Report—Annual MarketUpdate 2021. Technical report Global
Wind Energy Council
23. Ministério de Minas e Energia—MME. Balanço Energético Nacional—Relatório Síntese
2018. Secretaria de Planejamento e Desenvolvimento Energético (eds). Empresa de Pesquisa
Energética - EPE. http://www.epe.gov.br
24. Agência Nacional de Energia Elétrica - ANEEL. Procedimentos de Distribuição de Energia
Elétrica no Sistema Elétrico Nacional - Módulo 8 - Qualidade da Energia Elétrica. Agência
Nacional de Energia Elétrica (ANEEL), 2021
25. ANEEL.
Capacidade
de
Geração
do
Brasil.
Tech.
rep.
Disponível
em:
www2.aneel.gov.br/aplicacoes/capacidadebrasil/capacidadebrasil.cfm.
[Acessado
em
07.Abr.2022]. www2.aneel.gov.br/aplicacoes/capacidadebrasil/capacidadebrasil.cfm
26. ANEEL. Expansão da Oferta de Energia Elétrica - Acompanhamento das Centrais Geradoras
Eólicas. Technical report Aug 2021. http://www.aneel.gov.br/
27. Instituto Nacional de Metereologia - INMET (2021) BD Dados Históricos. Technical report,
Aug 2021. http://www.inmet.gov.br/
28. Leonhard W (1985) Control of electrical drives. Springer, Berlin, Heidelberg, New York, NY
29. Abad G et al (2011) Doubly fed induction machine: modeling and control for wind energy
generation. Wiley, New York, NY

296
A. L. L. F. Murari et al.
30. Quéval L, Ohsaki H (2012) Back-to-back converter design and control for synchronous
generator-based wind turbines. In: 2012 international conference on renewable energy research
and applications (ICRERA), pp 1–6. https://doi.org/10.1109/ICRERA.2012.6477300
31. Aydin O et al (2005) Optimum controller design for a multilevel AC-DC converter system. In:
Twentieth annual IEEE applied power electronics conference and exposition. APEC 2005, vol
3, pp 1660–1666. DOI: https://doi.org/10.1109/APEC.2005.1453262
32. Preitl S, Precup R-E (1999) An extension of tuning relations after symmetrical optimum
method for PI and PID controllers. In: Automatica, vol 35.10, pp 1731–1736. ISSN:
0005-1098. https://doi.org/10.1016/S0005-1098(99)00091-6 . https://www.sciencedirect.
com/science/article/pii/S0005109899000916
33. Murari ALLF et al (2016) Una introducción al ajuste de parámetros de controladores PI utiliza-
dos en el control del generador de inducción con rotor bobinado. In: Revista Iberoamericana de
Automática e Informática industrial, vol 13.1 (ene. 2016), pp 15–21. https://doi.org/10.1016/
j.riai.2015.11.001. https://polipapers.upv.es/index.php/RIAI/article/view/9320
34. Pelizari A, Chabu IE (2014) Finite element analysis of hybrid excitation axial ﬂux machine for
electric cars. en. J Microw Optoelectr Electromagn Appl 13(Dec 2014):223–239. ISSN: 2179-
1074.
http://old.scielo.br/scielo.php?script=sci_arttext&pid=S2179-10742014000200010&
nrm=iso

Signal Processing and Communication
Systems

Signal Processing Technologies Applied
in Smart Grids
Guilherme Torres de Alencar, Ricardo Caneloi dos Santos, and Aline Neves
Abstract Reliable protection schemes for modern electrical energy systems play
a vital role for minimizing the consequences of fault occurrences. Taking advan-
tage of the processing and communication power of intelligent electronic devices,
this chapter presents innovative solutions based on different signal processing tech-
niques for fault detection, classiﬁcation and location in power systems. The presented
methods are based on Euclidean Distance and Independent Components Analysis,
proving that more accurate and fast solutions can be reached when using the resources
available in modern power grids, implementing smart grids concepts. The presented
methods were tested against a system with real characteristics and then compared
with conventional methods.
1
Introduction
Electrical Energy Systems (EES) have become more complex mainly due to the
high penetration of distributed generation (with and without converters) and also the
signiﬁcant increase of power demand over the last few decades. As a result of this
new scenario, EES have been operating closer to their limits, imposing challenges to
system operators [1]. Moreover, conventional protection schemes might fail against
this new EES operating condition, as these schemes were designed for more conser-
vative scenarios before the mentioned changes in the power sector. Therefore, due
to the continuous changes, suitable protection schemes able to quickly detect and
classify faults and so accurately locate them, is still an issue to be addressed [2].
G. T. de Alencar · R. C. dos Santos (B) · A. Neves
Center of Engineering, Modeling and Applied Social Science, Federal University of ABC, Santo
André, SP, Brazil
e-mail: ricardo.santos@ufabc.edu.br
G. T. de Alencar
e-mail: alencar.guilherme@ufabc.edu.br
A. Neves
e-mail: aline.neves@ufabc.edu.br
© The Author(s), under exclusive license to Springer Nature Switzerland AG 2024
A. J. Sguarezi Filho et al. (eds.), Smart Grids—Renewable Energy, Power Electronics,
Signal Processing and Communication Systems Applications, Green Energy
and Technology, https://doi.org/10.1007/978-3-031-37909-3_11
299

300
G. T. de Alencar et al.
Fig. 1 IED application in modern EES
Despite the challenges posed by new EES, they were followed by notable technol-
ogy advances in the Intelligent Electronic Devices (IED) used to monitor, control and
protect power systems. Nowadays, modern IED have high processing and commu-
nication capabilities, allowing the development and implementation of sophisticated
methods for fault detection, classiﬁcation and location, based on advanced signal
processing techniques and wide communication networks for information exchange
[3]. Figure 1 illustrates this concept, often referred to as Smart Grid, where IED
exchange information among them and with the control room to monitor and protect
an EES with different types of distributed generation [4].
Due to the unquestionable importance of this topic for quickly recovering the
EES in case of fault, a large number of fault detection, classiﬁcation and location
methods have been proposed by experts working in this area [5–11]. However, some
of them are very complex and therefore unfeasible in practical terms, as the trade-off
between performance and computational burden is not favorable. On the other hand
some of them are relatively simple, but with limitations considering their scope of
application, still having an unfavorable trade-off. Taking advantage of modern IED
with processing and communication resources, this work proposes a new method for
fault detection and classiﬁcation, based on Euclidean Distance to measure similarity
ofvoltagesignals.Themaincharacteristicoftheproposedmethodisitssimplicityand
accuracy, allowing its implementation for practical application [12]. Moreover, for

Signal Processing Technologies Applied in Smart Grids
301
the sake of completeness, this work also presents an accurate fault location method,
based on Independent Components Analysis (ICA). It is important to highlight that
these proposals are possible due to the remarkable advances in items such as IED
and communication networks available in modern EES. Both methods are evaluated
against a real power grid operating in different conditions, while one of them is
compared with a traditional method for fault location. The results show promising
performance and signiﬁcant beneﬁts, when considering the possibilities offered by
modern EES planned with intelligent devices and reliable communication channels.
2
Foundations
In this section we will review some classical methods used for signal processing,
that will be important for the understanding of the developments and discussions on
the rest of the chapter. Emphasis was given on the most important aspects of each
method. Further information and details may be found in the references.
2.1
Blind Source Separation Problem
Blind source separation (BSS) is a problem that has called the attention of researchers
since 1950 when Cherry studied the recognition of a message from sound mixtures
[13]. However, only in the 80’s the problem begun to receive more attention, when
Hérault, Jutten and Ans [14] tried to computationally separate muscle signals in order
to distinguish between displacement and angular speed of a movement.
A classical example of the BSS problem is the cocktail party problem. In a party,
we are able to speak with others and understand what they are saying, despite the
noise caused by other conversations and music. However, if the sound of the room
is recorded by several microphones, the problem of isolating the voice of a desired
subject is not so simple. That is exactly what BSS techniques search to achieve.
Examples of where such techniques may be applied sweeps a large variety of appli-
cations: communication problems [15], audio, voice and image processing [16, 17],
biomedical signals [18], geophysical data processing [19], as well as fault location
in EES [20].
Retrieving sources from a mixture without any a priori knowledge about the
signals or how they were mixed is a very complex task and still does not have a
solution [21, 22]. Thus, a few assumptions, that are usually satisﬁed by measured
signals in practical situations, are necessary. The most accepted and used is that
of considering the original sources as being independent from each other. Such
assumption gives rise to the well known ICA [23]. In the following, we brieﬂy
present the mathematical modeling of such problem.
Let us consider a linear mixing process. Each source is represented by a signal
si(n) given by a stochastic process of zero mean. Mixtures can thus be written as:

302
G. T. de Alencar et al.
Fig. 2 Blind source
separation system model
x(n) = A s(n),
(1)
where x(n) = [x1(n) x2(n) . . . xM(n)]T is the mixture vector, the source vector is
s(n) = [s1(n) s2(n) . . . sN(n)]T and A is the mixture matrix, upper-script T denotes
transposition. Usually, N = M.
Since s(n) and A are unknown, the objective is to recover the sources using the
measured signals from x(n). Thus, we must ﬁnd a matrix W, ideally the inverse of
A, such that
y(n) = W x(n),
(2)
where y(n) = [y1(n) y2(n) . . . yN(n)]T are the estimated sources. A scale and order
ambiguity are possible [23]. The system model is presented in Fig.2.
To estimate W, the independence among sources is explored. As shown in [24],
if the sources are non-Gaussian (or only one source has a Gaussian distribution), it
is possible to separate the sources, using x(n), restoring the independence between
the estimated signals. Thus, the two most used cost functions in ICA are mutual
information deﬁned as [23]:
I (Y) =
N

i=1
H(yi) −H(y),
(3)
where H(·) is the entropy, and negentropy, deﬁned as a measure of non-gaussianity
JN(y) = H(ygauss) −H(y),
(4)
where ygauss is a Gaussian vector of the same covariance matrix as y. Negentropy
explores the fact that, as stated by the Central Limit Theorem, mixtures tend to
be more Gaussian than the original signals themselves. Since the sources are non-
Gaussian signals (or at most one is Gaussian), the objective is to search for signals
that are as non-Gaussian as possible (maximizing negentropy).
Mutual information is always positive, being equal to zero only if the signals
are independent. Negentropy is also always nonnegative, being equal to zero if y is
Gaussian. Such cost functions lead to the most used and known algorithms in the
context of ICA: FastICA and InfoMax [22, 23]. It is important to notice that, before
applying such algorithms, the mixture signal x must be whitened:

Signal Processing Technologies Applied in Smart Grids
303
z = V x,
(5)
where V is a matrix obtained from the eigendecomposition of the covariance matrix
of x. After (5), E[zzT ] = I, with I being the identity matrix.
Another approach that is largely used in BSS problems is exploring the second-
order statistics of the signals involved in the process, leading to simple and efﬁcient
algorithms. This class of methods can be applied when sources present different
power spectral densities, i.e.,
E[si(n)si(n −τ)] ̸= E[s j(n)s j(n −τ)],
(6)
with i ̸= j and τ ̸= 0.
Differently from ICA, algorithms in this class explore the temporal structure (cor-
relation among samples) of the signals and depend only on second-order statistics.
Considering that the data has been whitened through (5), the autocorrelation matrix
of the observed mixtures for a delay τ can be written as
Rz(τ) = E[zzT ] = QRs(τ)QT
(7)
where Rs(τ) is the autocorrelation matrix of the sources s(n). Since s(n) are consid-
ered to be independent (or are at least decorrelated), Rs(τ) will be a diagonal matrix,
indicating that (7) is the eigendecomposition of Rz(τ). Thus, we may conclude that
the eigendecomposition of Rz(τ) will result in the rotation matrix that enables the
recovery of the sources. It sufﬁces to make W = Q in (2). Such method corresponds
to the AMUSE (Algorithm for Multiple Unknown Signals Extraction) [25].
It is interesting to note that such algorithm can separate more than one Gaussian
source, as long as the signal presents a temporal structure. AMUSE has the dis-
advantage of using only one delay, τ, which must be correctly chosen for a good
performance of the algorithm. To mitigate such problem, an extension of the method,
using several delays, was proposed in [26], leading to the well known SOBI (Second
Order Blind Identiﬁcation) algorithm. Thus, SOBI considers several autocorrelation
matrices, obtained with different delays. Such matrices must be jointly diagonalized.
An exact joint diagonalization is usually not possible, since eigenvectors of different
matrices will not be equal, and also due to estimation errors. The following cost
function may be used for optimization
JSO BI =

τ∈DS
of f

WRz(τ)WT )

(8)
where DS is the set with the delays values being considered and of f is a function
that sums all the off-diagonal elements of a matrix.
The cost function given by (8) may be optimized using several algorithms such as
least squares, the Temporal Decorrelation Source Separation (TDSEP) [27] or SOBI
[26]. The last one is usually preferred in the literature due to its robustness.

304
G. T. de Alencar et al.
2.2
Wavelet Transform
Wavelet Transform (WT) is a data analytic method, as Fourier Transform (FT).
However, while the last one approximates a function by decomposing it into sums of
sinusoidal functions, the ﬁrst one makes use of mother wavelets. Both methods are
frequently used in signal processing for identifying dominant frequencies in a given
analyzed signal. WT is more efﬁcient in dealing with time-frequency analysis, while
FT responds only in frequency domain. Therefore, WT provides a more complete
analysis, since the time domain information is not lost [28].
Wavelets are functions capable of decomposing and representing another function
originally described in the time domain, allowing its analysis in different time and
frequency scales. According to [29] a wavelet family can be deﬁned by (9), where
a,b represents the mother wavelet, and the variables a and b represent information
about scale and time, respectively.
a,b(t) = 1
√a 
t −b
a

(9)
To be considered a mother wavelet the function must have the following require-
ments:
• The area under the curve must be zero, i.e.,
 ∞
−∞(t)dt = 0;
• The energy must be ﬁnite, i.e.,
 ∞
−∞|(t) |2dt < L, L ∈R
The Continuous Wavelet Transform (CWT) of a signal x is deﬁned by (10),
showing that the original signal is mapped into a two-dimensional domain (time and
scale), which depend on the factors a and b
CWT (a, b) =
1
√a
 ∞
−∞
x(t)(t −b
a
).
(10)
In the same way, the Discrete Wavelet Transform (DWT) is deﬁned by (11), where
the parameters a and b change as a function of the parameter m, since a = am
0 and
b = nb0am
0 ,
DWT (m, k) =
1
	
am
0

n
x(n)
k −nb0am
0
am
0

,
(11)
where k represents the number of samples.
Basically, the ﬁltering process using DWT is based on accepting and rejecting
frequency components of a particular signal. When discussing wavelet analysis it is
common to use the terms approximation and detail coefﬁcients, where the ﬁrst one
refers to low frequency components, while the last one refers to high frequency com-
ponents. For three levels of decomposition, the Multi Resolution Analysis (MRA)
of the signal x is shown in Fig.3. Therefore, the MRA aims to divide the frequency
spectrum into sub-bands and then treat each one independently [28, 29].

Signal Processing Technologies Applied in Smart Grids
305
Fig. 3 MRA—Three level decomposition
Fig. 4 Examples of mother wavelet functions
Wavelet decomposition can be done at several levels and its limit depends on the
signal length, the mother wavelet, and the required level of detail. In signal processing
the most used mother wavelets are Daubechies (db), Morlets (morl), Coiﬂets (coif),
and Symlets (sym) [28, 29]. Figure 4 presents some examples of mother wavelet
functions.
The MRA technique can be applied to voltage signals in order to ﬁnd several levels
of approximation and detail, thus making it possible to raise important information
abouttheanalyzedsignal.Therefore,consideringthattheanalyzedvoltagesignalsare

306
G. T. de Alencar et al.
taken at the transmission line terminals, this technique can be used for fault location,
based on the Traveling Wave principle and the high frequency components extracted
by MRA. Currently, the high processing and communication power of intelligent
devices and also their extended memory capacity make this kind of implementation
possible, resulting in more reliable and accurate fault location schemes [30].
3
Transmission Lines and Traveling Waves
3.1
Transmission Line Faults
Modern society is heavily dependent on electricity, independent of the type of con-
sumer, i.e., residential, commercial or industrial. Therefore, the utilities must meet
certain performance criteria, deﬁned by regulatory agencies, to avoid penalties. Con-
tinuity in electricity supply is an important performance criterion for EES. Never-
theless, faults are frequently occurring due to different factors such as external short-
circuit, lightning, insulation breakdown, among others. Transmission Lines (TL) are
the most susceptible elements in EES, due to their extension and exposure to the
most varied types of terrain and weather. Thus, efﬁcient fault location schemes play
a vital role to restore the EES, improving its reliability and availability. Considering
the new IED and their processing and communication power, sophisticated methods
for fault location can be implemented, such as the ones based on Traveling Waves
(TW) [2].
In general TL faults might happen between phase and ground or between phases,
as shown in Fig.5, where R f is the fault resistance, which can be zero when the fault
is solid.
Fig. 5 Fault line types

Signal Processing Technologies Applied in Smart Grids
307
3.2
Traveling Waves in Transmission Lines
TL faults might result in TW, which move from the fault point to the TL terminals,
where they suffer reﬂections and refractions, that is, one part continues to propagate
through the system and the other part propagates back to the fault point. The reﬂec-
tions and refractions occur when the impedance changes (discontinuity points), that
is, fault point, TL terminals, open circuits, machines, among others.
Bewley’s Lattice diagram represents the TW standard behavior as a time function,
showing the direction and distance covered for each TW (reﬂected and refracted) in
different time intervals. Figure 6 illustrates this diagram, assuming a TL with length
L and a fault at point d. As can be seen, two waves arise and travel towards the
TL terminals where the impedance changes (discontinuity points). Thus, at these
moments, part of the waves are refracted to the system and part are reﬂected back to
the fault point. This pattern remains until the TW dissipation due to the TL resistive
effect [11].
Assuming that voltage and current signals are measured in both TL terminals and
also that the TW propagation speed is known (from the TL physical characteristics),
the fault distance can be estimated by using the wavefront arrival times at buses
1 and 2. In general, methods based on TW for fault location use high frequency
components, since the useful information to perform this function is found in the
high frequency spectrum.
With the technology advances IED are more popular and widely used in EES,
allowing the development and implementation of new fault location schemes, based
on sophisticated signal processing techniques and reliable communication networks.
This scenario is typical of future EES, towards the smart grid vision, where faults
will be located faster, improving the system availability and resulting in beneﬁts for
consumers and the productive sector.
Fig. 6 Bewley’s Lattice
diagram of a TL

308
G. T. de Alencar et al.
4
Fault Detection and Classiﬁcation
Fault location is an important function for TL, however its performance greatly
depends on two previous functions, that is, fault detection and fault classiﬁcation [30].
Thus, it is essential to rely on simple, smart and fast fault detection and classiﬁcation
schemes able to precisely isolate the TL in case of faults. To perform these functions,
Euclidean Distance arises as an interesting option to be implemented in IED. The
advantages of using this kind of solution are: (a) simplicity, as only basic operations
are executed; (b) short response time, when implemented in modern IED with high
power processing; (c) reliability and accuracy, by using only voltage signals [12].
Figure 7 shows the ﬂowchart of a possible solution, based on Euclidean Distance,
for fault detection and classiﬁcation in TL.
This proposed solution is based on similarity of voltage signals, that is, for EES
under normal conditions, the superposition of two consecutive semi-cycles is zero (or
it is lower than an acceptable deviation), as presented in Fig.8a. On the other hand,
under fault conditions the superposition of two consecutive semi-cycles is higher
than an acceptable deviation, as presented in Fig.8b.
The distance between the ﬁrst semi-cycle (V1) and the inverted second semi-cycle
(V2) can be measured by Euclidean Distance, thus allowing to differentiate normal
(or expected) conditions from faults. For this purpose, let’s consider N samples of
one cycle of voltage signal, which can be divided into two sequences of a half cycle
each one, as shown by (12) and (13)
V1 = [v1(1) ... v1(N/2)]
(12)
V2 = [v2(1) ... v2(N/2)]
(13)
Fig. 7 Fault location and classiﬁcation functions based on Euclidean Distance

Signal Processing Technologies Applied in Smart Grids
309
Fig. 8 Superposition of two consecutive semi-cycles: a for non-fault events; b for fault events
The Euclidean Distance between the ﬁrst and the second half cycle can be calcu-
lated by (14) where the operator ∥· ∥corresponds to the Euclidean norm.
dist = ∥V1 −(−V2)∥= ∥V1 + V2∥=




N/2

k=1
(v1(k) + v2(k))2
(14)
Assuming a three phase system, (14) could be written for each phase, as in (15),
where ph should be replaced by a, b or c, depending on the analyzed phase.
distph =
Vph1 + Vph2
 .
(15)
4.1
Fault Detection Function
The main goal in determining the distph is to measure the EES disturbance level,
recalling that for normal conditions (or small transients) this level is lower than a
given threshold, while for faults this level is higher than the threshold, generating a
trip signal. In a conventional EES, (16) is used for determining the phase with the
higher deviation, i.e., the higher Euclidean Distance and so the higher disturbance
level.
distdet = max(dista, distb, distc)
(16)
The threshold value (T V ) depends on the analyzed EES and might be deﬁned by
means of simulations and observations. In case of fault, distdet > T V , as depicted
in Fig.9 [12].

310
G. T. de Alencar et al.
Fig. 9 Flowchart of the
developed fault detection
method
4.2
Fault Classiﬁcation Function
The Euclidean Distance deﬁned in (15) can also be employed to indicate the faulted
phases and then for fault classiﬁcation in LT. However, for this purpose it is not
enough to rely on a single threshold value for distph, since the faulted phase might
affect the other two phases. Thus, once the fault detection function is performed,
(17) is used to verify the ground involvement, by comparing distg with a predeﬁned
ground threshold value (T G).
distg = ∥(V a1 + V b1 + V c1) + (V a2 + V b2 + V c2)∥
(17)
Once the ground involvement is conﬁrmed, the fault could be single-phase-ground
or double-phase-ground. Otherwise, the fault could be double-phase or three-phase.
Assuming that the ground is involved, the phases with the highest value, lowest
value and median value of Euclidean Distance must be deﬁned, according to (18).
These values will be used to support the fault classiﬁcation function.

Signal Processing Technologies Applied in Smart Grids
311
distmax
ph
= max(dista, distb, distc)
distmin
ph = min(dista, distb, distc)
(18)
distmed
ph
= med(dista, distb, distc)
Discarding the ground involvement, the fault might only be double-phase (L-L)
or three-phase (L-L-L). Therefore, the classiﬁcation function consists of determining
whether the phase with the shortest Euclidean Distance participates in the fault. For
this purpose, T V could be used. Nevertheless, when the ground is involved, i.e. faults
single-phase-ground (L-G) or double-phase-ground (L-L-G), a more sophisticated
method is employed, since the unfaulted phases could also be affected.
Initially, the classiﬁcation distances are normalized, by computing the phases with
the shortest and longest Euclidean Distance respectively:
distmin = min(dista, distb, distc, distg),
(19)
distmax = max(dista, distb, distc, distg).
(20)
It is important to note that the ground component was also computed. The distance
of any normalized phase is determined as
dist ph(norm) = distph −dist
min
dist
max −distmin .
(21)
Assuming single-phase or double-phase faults, it is concluded that one of the
phases is involved and the other one is not, remaining to determine whether the
phase with a median distance, computed by (22) is under fault condition or not.
distmed
ph(norm) = med(dista(norm), distb(norm), distc(norm))
(22)
In single-phase-faults the median distance tends to be close to zero, while in double-
phase faults it tends to be close to one. The ﬂowchart in Fig.10 summarizes the fault
classiﬁcation method [12].
4.3
Evaluation of the Proposed Fault Detection
and Classiﬁcation Methods
To evaluate the proposed methods a TL of 500 kV (at 60 Hz) and 200 km was
considered [20]. The adopted TL as well as its main parameters are presented in
Fig.11. This TL was modeled and simulated in PSCAD, thus allowing to generate
a large number of different fault and non-fault cases, by changing the parameters
presented in Table1, totalizing 78 fault cases under different operational conditions.

312
G. T. de Alencar et al.
Fig. 10 Flowchart of the developed fault classiﬁcation method
Fig. 11 Adopted transmission line
As can be seen in Table 1 the fault cases differ from each other with respect to
fault location, fault type, fault resistance, fault inception angle, and bus voltage. By
using the software PSCAD, the voltage signals at bus 1 were stored and transferred
to Matlab where the proposed scheme was implemented and tested. Still from Table
1, it is possible to verify that solid and non-solid faults were simulated.
Figures12 and 13 show the results obtained by applying the proposed methods
fault detection and classiﬁcation, i.e., the procedures described in Figs.9 and 10,
respectively. It is important to note that the 78 fault cases were correctly detected and
classiﬁed regardless of fault condition, that is, the resistance, location or type of fault.
Theseﬁguresalsoshowtheadoptedthresholdvalues(T V and T G),deﬁnedbymeans
of simulations and analyses, where the suitable threshold value for discriminating
the ground involvement was T G = 0.005 pu.

Signal Processing Technologies Applied in Smart Grids
313
Table 1 Adopted power system and faults characteristics
Feature
Considered values
Fault location (distance
from bus 1 in km)
From 5 to 195 (steps of 5)
Fault type
A; B; C; AB; AC; BC; ABG;
ACG; BCG; ABC
Fault resistance ()
0; 50 and 100
Fault incidence angle (◦)
−90; −60; −30; 0; 30; 60; 90
Voltage at bus 1 (pu)
1; 1.05
Voltage at bus 2 (pu)
1
Angle at bus 2 (◦)
−5; −10
Inductance at buses 1 and 2 (mH)
5
Fig. 12 Results for fault
detection
It is important to mention that the threshold values change depending on the
power system characteristics, which means that a new study should be performed
when other power systems are considered.
When observing Fig.13, it is clear that some fault cases are close to the threshold
values. However, these cases represent limit conditions (worst cases generated by
Table1) and their occurrence is improbable.

314
G. T. de Alencar et al.
Fig. 13 Results for fault classiﬁcation
4.4
Considerations on Fault Detection and Classiﬁcation
Amethodbasedonthesimilaritylevelbetweentwoconsecutivehalfcycles,estimated
by using Euclidean Distance, was proposed for fault detection and classiﬁcation
purposes. The proposed method is suitable to be implemented in modern IEDs and
could be used in practical applications, as it requires low computational effort when
compared with most of the current solutions. Moreover, the proposed method does
not need communication link or any pre-processing step, correctly responding for
fault resistances up to 100 .
5
Fault Location
After a fault is detected and classiﬁed, locating its position as accurately and fast
as possible is the next step, in order to restore the EES as soon as possible. Due
to its importance, the development and improvement of TL fault location methods
is always an interesting topic of research. Such methods may be divided into two
groups: those based on the use of fundamental frequency, and those based on high
frequencies. In the ﬁrst group one may ﬁnd the most classical methods, those that
represent the ﬁrst solutions proposed to the problem and that have been studied in
detail in the literature. In such group we may include methods based on Fourier
Transform [31–33], Walsh Transform [34, 35], Kalman Filters [36, 37], Minimum
Squares [38], among others.

Signal Processing Technologies Applied in Smart Grids
315
In the second group, which includes methods that are based on the use of high
frequencies, the Travelling Waves (TW) theory is used [39]. Such methods are more
reliable and accurate than the ones based on the use of the fundamental frequency,
but they need a high sampling rate which may imply in a higher computational cost
and special hardware [40]. In this chapter, we will focus on this group of methods.
In recent years, Discrete Wavelet Transform (DWT) has been extensively used for
fault location [41, 42], specially with the Multiresolution Analysis (MRA) process,
as discussed in Sect.2.2.
Anothercommontechniqueusedexploringhighfrequencies,andthatisalsobased
on the concept of orthogonalization, is the Principal Component Analysis (PCA) [43–
45]. Such technique uses only second-order statistics to analyze the signal. However,
in some cases, being able to explore more statistical information of the signals at
hand may improve the accuracy of the result. A natural extension of PCA is ICA
(discussed in Sect.2.1). The later exploits higher-order statistics of the signals.
A few works including the use of ICA may be found in the literature, but are
still very incipient. For example, in [20], the authors use the FastICA algorithm for
fault location and Support Vector Machine (SVM) for fault classiﬁcation. The result
obtained was better than using a DWT with an Artiﬁcial Neural Network (ANN),
but the proposed method has an important drawback since it needs, a priori, a large
database to achieve a good performance.
In the following, we will discuss how it is possible to use ICA through a simple
and robust method for fault location, outperforming DWT-based methods.
5.1
Single Channel ICA
Bringing the fault location problem, through the use of TW (Sect.3), to the BSS
(Sect.2.1) context, the ﬁrst issue that stands out is the fact that, when dealing with
TW, only one or maybe two measured signal(s) (mixtures) are available, depending
on whether the measure is obtained on one terminal or both of them. A possible
solution to such problem is the use of a variation of ICA, named Single Channel
ICA (SCICA), in which each mixture is given by a delayed version of the available
measured signal [46]. Thus, instead of using (2) with x(n) deﬁned in (1), the later
will be given by:
xsc(n) = [x(n) x(n −1) x(n −2) . . . x(n −D)]T
(23)
where D is the total number of delays used (equivalent to considering M = D + 1
mixtures). Equation (2) can then be rewritten as:
ysc(n) = W xsc(n).
(24)
This approach is useful in the case where the latent components of a single time
series must be recovered, thus the name Single Channel ICA. It can be applied when

316
G. T. de Alencar et al.
Fig. 14 Sliding data window
and its updating process
sources are spectrally disjoint from each other [46]. The fault location problem
naturally falls within this context, since the measured signal at the terminal of the
TL is given by a 60Hz sinusoid. If a fault occurs, the signal will suffer the effect of
high frequencies components (in the order of kHz).
5.2
Fault Location with SCICA
The ﬁrst step is the acquisition of a voltage signal, v(n), measured at the TL terminal.
The analysis will always consider a data window of one cycle length, updated at each
half cycle. Figure 14 shows an example.
Next, a modal transformation will be applied to the one cycle length window
voltage signal, decomposing it into three single-phase circuits, allowing the analysis
of each circuit independently. Applying the modal transformation to the three-phase
voltage signals va(n), vb(n) and vc(n) results in the aerial modes vα(n) and vβ(n),
and ground mode v0(n), as shown by
⎡
⎣
v0(n)
vα(n)
vβ(n)
⎤
⎦= 1
3
⎡
⎣
1 1
1
2 −1 −1
0
√
3 −
√
3
⎤
⎦
⎡
⎣
va(n)
vb(n)
vc(n)
⎤
⎦
(25)
For any fault type, aerial mode α will be used, except in the case of line-to-line
faults involving phases B and C (without involving the ground component). Since,
in this case, aerial mode α is zero (see (25)), aerial mode β will be used instead.
Note that faults in the TL affects all phases, faulty and non-faulty, due to the mutual
coupling between them.
Figure 15 exempliﬁes such procedure, showing a faulty three-phase voltage sig-
nal and its modal correspondents. Considering vα as being our measured signal,
SCICA will be applied with the objective of separating its high frequencies (faulty
component). Thus, (23) can be rewritten as
xsc(n) = [vα(n) vα(n −1) vα(n −2)]T
(26)

Signal Processing Technologies Applied in Smart Grids
317
Fig. 15 Voltage signal in case of fault: a Phase voltage; b Modal voltage
Fig. 16 SCICA estimated signals, y1(n), y2(n) and y3(n)
where D has been set to 2 (simulations showed that no improvement is obtained from
increasing D).
From (24), having three mixture signals, after applying ICA and estimating W,
three sources will be estimated ysc(n) = [y1(n) y2(n) y3(n)]T . An example of the
recovered sources ysc is shown in Fig.16. Figure 16a is basically given by the funda-
mental component. In Fig.16b, such component is still present. However, it vanishes
completely in Fig.16c, leaving only the high frequency component of the signal.
Thus, y3(n) is exactly what we need to estimate the fault location. Each peak pre-
sented in y3(n) represents the incidence of the TW on the TL terminal, where the
signal is being measured.
In order to estimate, as precisely as possible, the time instant of the wavefronts, the
energy of y3(n) was obtained, i.e., y2
3(n), and the result was normalized in the interval
[0, 1] by a min-max normalization. The result signal was named ynorm(n). Now, two

318
G. T. de Alencar et al.
Fig. 17 Bewley’s Lattice diagram with faults at: a ﬁrst half of the TL and b second half of the TL
situations are possible and must be analyzed separately: available measurement from
only one terminal or synchronized measurements from both terminals are available.
5.2.1
Fault Location Based on Local Measurements
When only the measure of one terminal is available, the time instants of interest are
the ﬁrst and second reﬂected TW, which corresponds to the ﬁrst peaks of ynorm(n).
However, a particular challenge appears in the deﬁnition of the second peak, since
it may be due to the remote terminal of the TL instead of the fault point. Figure 17
illustrates such problem.
In Fig.17a, for a fault on the ﬁrst half of the TL, the ﬁrst two peaks come from the
fault point. However, Fig.17b shows how the second peak may be due to the remote
terminal, when the fault occurs in the second half of the TL, wrongly interfering on
the identiﬁcation of the fault location.
Three scenarios are possible: if the fault does not involve the ground component,
the fault location may be estimated by
d = vp(tα2 −tα1)
2
,
(27)
where vp is the positive sequence propagation speed and tα1 and tα2 are the time
instants of the ﬁrst and second peaks, respectively, of ynorm(n) obtained from the
aerial mode α (or β, depending on the fault) measured at bus 1.
If the fault involves the ground component, the ﬁrst step is to determine in which
halfoftheTLitoccurred[47].Thisprocedurecanbedonebycomparingtheincidence
times of signals from aerial and ground modes, from which it is possible to conclude
if the fault occurred in the ﬁrst or second half of the TL. If the fault occurred in the
ﬁrst half, (27) can be used. However, if it was on the second half, d must be estimated
as
d = L −vp(tα2 −tα1)
2
,
(28)
where L is the TL length.

Signal Processing Technologies Applied in Smart Grids
319
5.2.2
Fault Location Based on Synchronized Measurements
When measurements from both terminals are available, using the information of the
ﬁrst wavefront at each terminal is sufﬁcient to estimate the fault location. Estimation
in this case is more precise than the one obtained with the local measurement, and
faults in the second half of the TL do not pose a problem. On the other hand, this
scheme is more costly and complex than the preceding one, since measurements
must be synchronized.
In this case, SCICA is applied to the aerial mode α (β if needed) of the signals
measured in both terminals, independently. Analyzing the time instant of the ﬁrst
peak in each case will result in tα1 and t′
α1. Thus, the fault location may be estimated
as
d = L + vp(tα1 −t′
α1)
2
.
(29)
5.3
Performance Analysis of the SCICA method
In this section we will only analyze fault location, considering that the fault has
already been detected and correctly classiﬁed. The SCICA source separation was
implemented using the SOBI algorithm with D = 2 (Eq.26) mixtures and a set of
ﬁve time delays in (8), i.e., DS = 5. For comparison purposes, DWT was also applied
to the same scenario, since it is a classical method for fault location.
The characteristics of the simulated TL is given in Fig.11. Several fault cases were
generated varying fault location, type, resistance, among others, as shown in Table1.
The voltage signals at the TL terminals were sampled at 100kHz and stored. PSCAD
was used for TL modeling and simulation, while the voltage signals were stored
for post-processing in Matlab. Performance was measured by the error between the
estimated distance d and the true value d0
Error(%) = 100|d0 −d|
L
(30)
Figures 18 and 19 show the results obtained for the case of one local measurement
(bus 1) and two synchronized measurements, respectively. Figure 18 shows seven
outliers cases in which the error was higher than 3%, ﬁve for DWT and two for
SCICA. These are cases where the pre-step of determining if the fault occurred on
the ﬁrst or second half of the TL failed. Table 2 summarizes the results, showing the
average error (obtained excluding the outliers). We can see that SCICA outperforms
DWT by over 17%, also presenting fewer outliers.
In the synchronized measurements case, given by Fig.19, the difference in perfor-
mance between DWT and SCICA is not so important, but SCICA still outperforms
DWT in 3%. Figure19 shows how the greater differences in performance occurs
specially for faults near the middle of the TL.

320
G. T. de Alencar et al.
Fig. 18 Performance of DWT and SCICA with measurements in one terminal: a No fault resistance,
b Fault resistances of 30, 50 or 100 
Fig. 19 Performance of DWT and SCICA with measurements in both terminals: a No fault resis-
tance, b Fault resistances of 30, 50 or 100 
Table 2 Average errors obtained for local and synchronized measurements, excluding outliers
Algorithms
One terminal
Two terminals
Errors (%)
Outliers
Errors (%)
Outliers
DWT
0.98
5
0.73
0
SCICA
0.81
2
0.70
0

Signal Processing Technologies Applied in Smart Grids
321
5.4
Considerations on Fault Location
In this section we have discussed the fault location problem. We have focused on
methods that explore high frequencies generated on the signal by the fault. In this
context, DWT and PCA are the most used techniques in the literature. This section
shows how ICA may also be very useful in solving such problem. A simple and
robust method, based on Single Channel ICA, was presented.
The method has shown a better performance than DWT in a simulated TL context.
In addition, when compared to other literature methods, it has the advantage of using
only voltage signals, it does not need a previous database for presenting a good
performance and it presents a low computational burden.
6
Conclusion
This chapter addressed the three important stages that must be considered when
dealing with a fault in an EES: detection, classiﬁcation and location. The reliability
and robustness of an EES depends on the efﬁcacy of these three stages, detecting,
classifying and locating the fault as fast and precisely as possible.
Here we have brieﬂy discussed literature results on treating these problems and
have presented and discussed in detail recently proposed methods, approaching the
three problems through simple solutions.
For fault detection and classiﬁcation, it is shown how the use of Euclidean Dis-
tances on measured voltage signals are able to provide fast and reliable results. On
the other hand, for fault location, a simple method based on SCICA is presented,
showing how it outperforms the classical DWT method.
References
1. Glover JD et al (2022) Power system analysis and design. Cengage learning
2. Horowitz SH, Phadke AGW (2014) Power system relaying
3. Thomas MS, McDonald JD (2015) Power system SCADA and smart grids. Taylor Francis
Group
4. Petite FSV et al (2021) A comprehensive backup protection for transmission lines based on an
intelligent wide-area monitoring system. Int Trans Electr Energy Syst 1:1–21. https://doi.org/
10.1002/2050-7038.12870
5. Gupta OH, Tripathy M (2015) An innovative pilot relaying scheme for shunt-compensated
line. In: IEEE transactions on power delivery, vol 30.3, pp 1439–1448. https://doi.org/10.
1109/TPWRD.2015.2394353
6. Pérez FE, Orduña E, Guidi G (2011) Adaptive wavelets applied to fault classiﬁcation on
transmission lines. In: IET generation, transmission & distribution, vol 5.7, pp 694–702. https://
doi.org/10.1049/iet-gtd.2010.0615

322
G. T. de Alencar et al.
7. Prasad CD, Nayak PK (2019) A DFT-ED based approach for detection and classiﬁcation of
faults in electric power transmission networks. Ain Shams Eng J 10(1):171–178. https://doi.
org/10.1016/j.asej.2018.02.004
8. Kintali M et al (2019) Euclidean metric based fault diagnosis in power transmission line. Int J
Innov Technol Explor Eng 9.2S3:226–231. https://doi.org/10.35940/ijitee.B1057.1292S319
9. Akmaz D et al (2018) Transmission line fault location using traveling wave frequencies and
extreme learning machine. In: Electric power systems research, vol 155, pp 1–7. ISSN: 0378-
7796. https://doi.org/10.1016/j.epsr.2017.09.019
10. Jamil M et al (2014) Generalized neural network and wavelet transform based approach for
fault location estimation of a transmission line. In: Applied soft computing, vol 19, pp 322–332.
ISSN: 1568-4946. https://doi.org/10.1016/j.asoc.2014.02.020
11. Naidu O, Pradhan AK (2019) A traveling wave-based fault location method using unsynchro-
nized current measurements. In: IEEE transactions on power delivery, vol 34.2, pp 505–513.
https://doi.org/10.1109/TPWRD.2018.2875598
12. Alencar GT, Santos RC, Neves A (2022) Euclidean distance-based method for fault detection
and classiﬁcation in transmission lines. J Control Autom Electr Syst 33:1466–1476. https://
doi.org/10.1007/s40313-022-00918-x
13. Cherry EC (1953) Some experiments on the recognition of speech, with one and with two ears.
J Acoust Soc Am 25(5):975–979
14. Héault J, Jutten C, Ans B (1985) Détection de grandeurs primitives dans un message composite
par une architecture de calcul neuromimétique en apprentissage non supervisé. In: 10 Colloque
sur le traitement du signal et des images, FRA, 1985. GRETSI, Groupe d’Etudes du Traitement
du Signal et des Images
15. Ferréol A, Chevalier P, Albera L (2004) Second-order blind separation of ﬁrst-and second-order
cyclostationary sources-application to AM, FSK, CPFSK, and deterministic sources. In: IEEE
transactions on signal processing, vol 52.4, pp 845–861
16. Virtanen T (2007) Monaural sound source separation by nonnegative matrix factorization with
temporal continuity and sparseness criteria. In: IEEE transactions on audio, speech, and lan-
guage processing, 15.3, pp 1066–1074
17. Poh M-Z, McDuff DJ, Picard RW (2010) Non-contact, automated cardiac pulse measurements
using video imaging and blind source separation. In: Optics express, vol 18.10, pp 10762–10774
18. Oosugi N et al (2017) A new method for quantifying the performance of EEG blind source
separation algorithms by referencing a simultaneously recorded ECoG signal. Neural Netw
93:1–6
19. Chen C, Wang Z (2006) ICA and factor analysis application in seismic proﬁling. In: 2006 IEEE
international symposium on geoscience and remote sensing, pp 1560–1563. https://doi.org/10.
1109/IGARSS.2006.402
20. Almeida AR et al (2017) ICA feature extraction for the location an classiﬁcation of faults in
high-voltage transmission lines. Electr Power Syst Res 148:254–263
21. Comon P, Jutten C (2010) Handbook of blind source separation: independent component anal-
ysis and applications. Academic Press
22. Romano JMT et al (2010) Unsupervised signal processing: channel equalization and source
separation. CRC Press
23. Hyvärinen A, Karhunen J, Oja E (2004) Independent component analysis, vol 46. Wiley
24. Comon P (1994) Independent component analysis, a newconcept? In: Signal processing, vol
36.3, pp 287–314
25. Tong L et al (1990) AMUSE: a new blind identiﬁcation algorithm. In: IEEE international
symposium on circuits and systems. IEEE, pp 1784–1787
26. Belouchrani A et al (1997) A blind source separation technique using secondorder statistics.
In: IEEE transactions on signal processing, vol 45.2, pp 434–444
27. Ziehe A, Müller K-R (1998) TDSEP-an efﬁcient algorithm for blind separation using time
structure. In: Niklasson L, Bodén M, Ziemke T (eds) ICANN 98. Springer, London, pp 675–
680
28. Debnath L, Shah FA (2015) Wavelet transforms and their applications. Birkhauser

Signal Processing Technologies Applied in Smart Grids
323
29. Daubechies I (1992) Ten lectures on wavelets. Society for industrial and applied mathematic
30. Rebizant W, Szafran J, Wiszniewski A (2011) Digital signal processing in power system pro-
tection and control. Springer
31. Li M et al (2017) Sixth harmonic-based fault location for VSC-DC distribution systems. In:
IET generation, transmission and distribution, vol 11.14, pp 3485–3490
32. Phade AG, Hlibka T, Ibrahim M (1977) Fundamental basis for distance relaying with sym-
metrical components. In: IEEE transactions on power apparatus and systems, vol 96.2, pp
635–646
33. Saha MM, Izykowski J, Rosolowski E (2010) Fault location on power networks. Springer,
London
34. Ferrer HJA, Verduzco ID, Martinez EV (1996) Fourier and Walsh digital ﬁltering algorithms
for distance protection. In: IEEE transactions on power systems, vol 11.1, pp 457–462
35. Sharma P, Ali S, Kapoor G (2018) Fault detection on series capacitor compensated transmission
line using Walsh Hadamard transform. In: IEEE international conferences on computing power
and communication technologies, pp 763–768
36. Girgis AA (1982) A new kalman ﬁltering based digital distance relay. In: IEEE transactions
on power apparatus and systems PAS-101.9, pp 3471–3480
37. Fan R et al (2018) Precise fault location on transmission lines using ensemble kalman ﬁlter.
In: IEEE transactions on power delivery, vol 33.6, pp 3252–3255
38. Sachdev MS, Baribeau MA (1979) A new algorithm for digital impedance relays. In: IEEE
transactions on power apparatus and systems PAS-98.6, pp 2232–2240
39. Bewley LV (1963) Traveling waves on transmission systems. Wiley
40. Zimmerman RD et al (2011) Steady-state operations, planning, and analysis tools for power
systems research and education. In: IEEE Transactions on power systems, vol 26.1, pp 12–19
41. Saber A, Emam A, Amer R (2016) Discrete wavelet transform and support vector machine-
based parallel transmission line faults classiﬁcation. In: IEEJ transactions on electrical and
electronic engineering, vol 11.1, pp 43–48
42. Arroyo SM, García-Gracia M, Montañés A (2019) The half-sine method: a new accurate
location method based on wavelet transform for transmission- line protection from single-
ended measurements. In: Energies, vol 12.17
43. Jafarian P, Sanaye-Pasand MA (2010) Traveling-Wave-Based protection technique using
wavelet/PCA analysis. IEEE Trans Power Deliv 25:588–599. https://doi.org/10.1109/TPWRD.
2009.2037819
44. Aguilar R, Perez F, Orduña E (2011) High-speed transmission line protection using principal
component analysis, a deterministic algorithm. In: IET generation, transmission and distribu-
tion, vol 5.7, pp 712–719. https://doi.org/10.1049/iet-gtd.2010.0771
45. Alsafasfeh Q, Abdel-Qader I, Harb A (2012) Fault classiﬁcation and localization in power
systems using fault signatures and principal components analysis. Energy Power Eng 04:506–
522. https://doi.org/10.4236/epe.2012.46064
46. Davies ME, James C (2007) Source separation using single channel ICA. Signal Process
87:1819–1832. https://doi.org/10.1016/j.sigpro.2007.01.011
47. Abur A, Magnago FH (2000) Use of time delays between modal components inwavelet based
fault location. Int J Electr Power Energy Syst 22:397–403. https://doi.org/10.1016/S0142-
0615(00)00010-7

Active Power Filters Applied to Smart
Grids: Harmonic Content Estimation
Based on Deep Neural Network
Claudionor Francisco do Nascimento, Alfeu Joãozinho Sguarezi Filho,
Amilcar Flamarion Querubini Gonçalves,
Augusto Matheus dos Santos Alonso, Luiz Gustavo Reis Bernardino,
Paulo Fernando Silva, and Wesley Angelino de Souza
Abstract The increasing penetration of power electronics loads in smart grids inher-
ently leads to severe concerns about power quality (PQ) disturbances. This chapter
presents the principles of synthesizing control references for an active power ﬁl-
ter (APF), which is placed in a smart grid comprising distortion loads, aiming at
achieving PQ enhancement and compliance with standardized indexes. In addition,
it is argued that the APF control system requires harmonic content identiﬁcation
to generate the targeted compensating currents. Thus, to achieve the disturbance
recognition expected for synthesizing control references, harmonic analysis meth-
ods can be devised by automation tools and artiﬁcial intelligence (AI). For instance,
it is demonstrated here that deep neural networks (DNN) can be used in the main
pattern recognition stage, simplifying the harmonic content estimation process. The
DNN-estimated harmonics are then directly used within the APF control system to
C. Francisco do Nascimento (B) · A. Flamarion Querubini Gonçalves · P. Fernando Silva
Federal University of São Carlos (UFSCar), São Carlos-SP, Brazil
e-mail: claudionor@ufscar.br
A. Flamarion Querubini Gonçalves
e-mail: amilcarf@ufscar.br
P. Fernando Silva
e-mail: paulof2016silva@gmail.com
A. J. Sguarezi Filho
Federal University of ABC (UFABC), Santo André-SP, Brazil
e-mail: alfeu.sguarezi@ufabc.edu.br
A. Matheus dos Santos Alonso
University of São Paulo (USP), São Carlos-SP, Brazil
e-mail: augusto.alonso@usp.br
L. Gustavo Reis Bernardino
Federal University of São Carlos (UFSCar), Sorocaba-SP, Brazil
e-mail: lgbernardino@ufscar.br
W. Angelino de Souza
Federal University of Technology – Paraná (UTFPR), Cornélio Procópio-PR, Brazil
e-mail: wesleyangelino@utfpr.edu.br
© The Author(s), under exclusive license to Springer Nature Switzerland AG 2024
A. J. Sguarezi Filho et al. (eds.), Smart Grids—Renewable Energy, Power Electronics,
Signal Processing and Communication Systems Applications, Green Energy
and Technology, https://doi.org/10.1007/978-3-031-37909-3_12
325

326
C. Francisco do Nascimento et al.
compensate disturbances aiming at reducing the total harmonic distortion in a smart
grid. Finally, this chapter also presents case studies using experimental load currents
to depict the feasibility of the DNN-based method.
1
Introduction
Smart grids represent the next technological leap from the conventional grid [1, 2].
These networks are considered a promising solution to modernize electricity distri-
bution since they take advantage of information and communication technologies,
which can improve the efﬁciency, security, and stability of the conventional power
grid [3]. Figure 1 presents, for instance, an example of a microgrid inserted within the
smart grid paradigm, comprising multiple loads and converter interfaced distributed
energy sources, as well as an active ﬁlter.
With regards to power quality (PQ), a smart grid must also follow standards and
grid codes to respect compliance requirements in order to achieve the aforementioned
operational beneﬁts. Otherwise, the network will be inherently prone to instability.
Harmonic distortion is, for instance, one of the most common and yet challenging
PQ problems, which must be tackled by the technical and scientiﬁc community. In
general, the harmonic pollution generated by single-phase and three-phase non-linear
(i.e., power electronics-based) loads is individually small in power [4]. Nevertheless,
the dense penetration of such loads in electrical systems can cause signiﬁcant har-
monic distortion problems. This harmonic pollution is not only restricted to industrial
environments but is also present within the residential and commercial grid perspec-
tives. Furthermore, the ﬂow of harmonic current through the system results in a
number of undesirable effects [5, 6].
Fig. 1 AC low voltage smart microgrid with non-linear local loads

Active Power Filters Applied to Smart Grids …
327
Harmonics can be produced by static converters or saturated reactors, resulting
from the switching process of power electronics-based equipment or being caused
due to the magnetizing current of transformers [7, 8]. In this work, only non-linear
loads based on static converters are taken into consideration.
The unwanted effects of harmonics in electrical systems are straightforwardly evi-
denced by additional heating losses (e.g., in rotating machines), inappropriate inter-
ference with the operating mechanisms of protective equipment, resonance problems,
and increased additional heating losses in parallel capacitor banks. Other issues aris-
ing from harmonic distortions are also related to overvoltages in lighting systems,
degradation of the accuracy of induction-type active energy meters, undesired effects
on the operational characteristics of protection relays, noise excitation in communi-
cation systems, so forth [9, 10]. Moreover, although the perspective of residential
systems indicates that consumers’ perception is mostly concerned about either failure
or interruption in the operation of household equipment, power utilities take the cost
of degradation of the electrical grid as the major motivation to mitigate harmonics
[11].
Despite the fact that harmonic pollution is a present and unquestionable challenge
that affects modern electric power grids, the desire to prevent non-linear behaviors
in voltages and currents has been studied since many decades ago [12]. Thus, the
motivation for the development of auxiliary circuits (i.e., embedded in a pre-existing
operating load) and independent systems acting as power conditioners (e.g., ﬁlters)
have been boosted over the years. Nonetheless, avoiding harmonic distortion under
the presence of non-linear loads is a difﬁcult task, especially in low-power grids, due
to multiple electrical interactions occurring among harmonic sources, attenuators
and grid elements (e.g., line impedances).
So far, several research efforts have been carried out in the power electronics ﬁeld
to mitigate the issues related to harmonic distortion in electrical systems [4, 13–15].
There are practically two methods for determining the solution to the problem. The
ﬁrst one is based on the preventive solution, which aims at improving the performance
of the equipment acting as a harmonic source. In this case, design modiﬁcations are
performed to reduce the harmonic content generated by the non-linear load, which is
usually devised by adjustments in the equipment’s circuit (e.g., the voltage rectiﬁer
pre-regulators) [14, 16]. The second one comprises the corrective techniques that
use ﬁlters for harmonic compensation (e.g., RLC ﬁlters tuned at the 3rd harmonic
order, being allocated in parallel with the load) [17]. As an example, the adoption
of ﬁlters to attain harmonic compensation stands on the corrective perspective, i.e.,
they are not part of the non-linear load circuit existing in the system. Hence, such
ﬁlters act directly on the electrical grid in which this load is inserted.
The problems related to harmonic distortion are traditionally solved in a power
grid by deploying power conditioners (i.e., ﬁlters), aiming at canceling the circulation
of harmonic components in the circuit. There are two general classes of ﬁlters for the
mitigation of harmonic distortions. The ﬁrst class is based on conventional passive
ﬁlters, which is a solution susceptible to trigger resonances due to interactions with
grid impedances and other system loads [18]. Such ﬁlters are unsuitable for systems
comprising loads that are sensitive to variable harmonic content [19, 20]. On the

328
C. Francisco do Nascimento et al.
other hand, the second class comprises active or hybrid (i.e., a combination of active
and passive topologies) power ﬁlters [21], which rely on the control of switching
power interfaces to act on PQ improvement purposes [22]. Thus, due to their ﬂexible
control operationalities, the APF has been consolidated as an effective solution in
correcting harmonic distortion [9, 23].
2
Fundamentals of Shunt Active Power Filters (SAPF)
The APF is usually constituted of a voltage source inverter connected to the electrical
grid [24], having the main function of mitigating either voltage or current harmonic
distortions depending on its topology [24, 25]. In addition, APF can be classiﬁed as
series or parallel (i.e., shunt) [26], which are generally employed to tackle voltage
or current disturbances, respectively. However, a SAPF is the topology that has
been most widely used. APF can also be classiﬁed according to the structure of the
electrical grid, meaning that they can be designed for single-phase or three-phase
applications. For instance, in three-phase circuits, APF can be classiﬁed as three-
phase three-wire (delta) and three-phase four-wire (star) [27].
Note that the topology of SAPF, which is presented in Fig.2, comprises a voltage
source inverter (VSI) connected in parallel with the load [28]. Hence, the SAPF’s
goal is to inject speciﬁc currents into the PCC, allowing to cancel the harmonic
current components drawn from the grid [29–31].
Fig. 2 Shunt active power ﬁlter application on a smart grid with non-linear load

Active Power Filters Applied to Smart Grids …
329
The compensation characteristics of a SAPF are primarily deﬁned by the strategy
adopted for estimating the harmonic content of the load currents, as well as by the
approach responsible for the synthesis of the reference current used to control the
device. The determination of such reference currents has been done in the literature
through two main approaches: (i) the so-called time domain approach e.g., using the
p-q theory [32] or other methods such as the conservative power theory (CPT) [33];
and (ii) the frequency domain approach (e.g., by using the Fourier analysis [34]). It is
important to mention that the frequency domain strategy makes it possible to deter-
mine the harmonic components selectively [35]. Consequently, the compensation
can be either limited to a certain harmonic order (e.g., the 20th component) or it can
consider a group of components. The greater the number of harmonic components,
the greater the number of calculations required to synthesize the reference currents,
leading to a more complex computational implementation of the digital control of
the APF.
2.1
Reference Current of the SAPF
The term “active ﬁlter” is generic and can be applied to a group of power electronics
circuits formed by semiconductor devices devising power switching. These types of
equipment work together with energy storage circuits characterized by the presence
of capacitors and inductors. The APF topology typically depends on the intended
application, requiring an exact design to the targeted power circuit [25].
Basically, an APF detects the harmonic current of the line waveform or the non-
linear load (or set of loads), then generates an adequate reference current. This current
is used by the APF control system to cancel these harmonics. Consequently, such
intervention either eliminates completely or partially attenuates harmonic distortions
in the grid [5].
There are two approaches to generate the reference current of an SAPF, which
are the following: time domain and frequency domain. The SAPF reference current
generation strategy based on the p-q theory is considered in the time domain because
it uses instantaneous values [9]. On the other hand, the frequency domain strategy
uses amplitudes and phase angles generally deﬁned by the DFT or FFT [36].
DFT is a traditional technique widely used in the spectral analysis of the load cur-
rent[36].TheFFTisusedtoquicklycalculateDFTinordertodeterminetheharmonic
components in real time and with less computational effort. In this chapter, the efﬁ-
ciency of DFT and FFT is not addressed. Truncated FFT has also been used in order
to reduce the computational time response intrinsic to this technique. This is because
this response becomes smaller as the number of harmonics involved decreases.
An alternative tool to the FFT is the implementation of AI algorithms applied to
the process of estimating the harmonic content of currents. Among the most used AI
methods lies the ANN. Such an approach implements an intelligent system that is
trained ofﬂine using the data collected from the Fourier analysis of the load currents
(i.e., the ANN design is decoupled from the APF operation process). Thus, based on

330
C. Francisco do Nascimento et al.
the Fourier analysis, the current signals can be reconstructed considering up to the
twentieth harmonic component. Soon after, the reconstructed signal is presented at
the ANN input to carry out the training process. After training, the ANN identiﬁes
each harmonic component online (coupled to the process) based on the load current
amplitudes sampled and presented at the ANN input.
The implementation of AI algorithms presents some advantages over traditional
harmonic estimation methodologies, such as being able to separate harmonic com-
ponents in the time of half a cycle of the line voltage, in addition to continuously
following the harmonics of the load current and transferring this data to the system
responsible for acquisition and control. In some cases, ANN can identify the main
Fourier series coefﬁcients in just one cycle of the grid voltage waveform. There is
also the possibility of using one or more architectures of ANN together in the har-
monic compensation system: for instance, an adaptive linear element (ADALINE)
for the determination of harmonics and a multilayer perceptron for the control of the
active ﬁlter.
This chapter has the main goal of presenting a method based on ANN to determine
the low-frequency (i.e., up to the 20th order) harmonic components of non-linear
load currents, which serve to determine the reference currents of a SAPF, aiming at
achieving selective compensation. Therefore, in this chapter, SAPF operation is used
as an application to evaluate the method for determining harmonic components.
3
Primary Control Structure—Voltage Source Inverter
Control
The control strategies employed on SAPFs depend directly on the circuit topology, as
well as on the control objectives. The operational targets are classiﬁed by the current
components to be corrected and by the required response to the grid’s voltage distor-
tion [26, 37]. For instance, there are several current control techniques for a SAPF:
the hysteresis controller, the deadbeat digital controller, and the linear controller in
rotating frames. All these mentioned techniques present acceptable performance;
however, they differ mainly in the delay caused by the control processing [38].
This section explores the operating principle and linear control structure of the
three-phase SAPF, considering its interface based on a VSI. The parts that compose
the primary control of the SAPF are the PWM, the PLL, the current controller, and
the DC voltage controller. As observed in Fig.3, such a structure adjusts the inverter
gains so that the VSI can synthesize the harmonic reference current generated by
the intelligent algorithm (i.e., the one responsible for the extraction of harmonic
components). Each of these parts are explained as follows.

Active Power Filters Applied to Smart Grids …
331
Fig. 3 Structure of the SAPF control
3.1
PWM Application in SAPF
The modulator generates the PWM signal by comparing the control (i.e., modulating)
signal with the carrier signal. The modulation technique depends on the structure of
the static converter electrical circuit, knowing that for three-phase SAPF, the main
techniques are the SPWM and the SVPWM.
ImplementingSPWMissimplerthanSVPWMbecauseitonlyrequirescomparing
the control signal with a triangular signal. On the other hand, for the SVPWM, it is
necessary to verify the position of spatial vectors to determine the switching states
of the VSI. Nonetheless, the advantage of the SVPWM approach is the lower DC
bus voltage level required to modulate the control signal, resulting in a voltage gain
of approximately 15% higher when compared to SPWM.
SPWM and SVPWM techniques have already been widely explored in the lit-
erature in the past and will not be discussed here. The reader will ﬁnd extensive
discussion in [39, 40], as well as discussions on the digital implementation of PWM.

332
C. Francisco do Nascimento et al.
3.2
SAPF Synchronization Using PLL
The PLL algorithm is required to certify that the SAPF operates synchronized with
the grid voltage, providing adequate compliance with grid codes and proper syn-
thesis of the current compensation components. Hence, the PLL generates a signal
synchronized with the grid and provides the phase angle θ or the grid’s fundamen-
tal frequency ω. Consequently, it is possible to generate a current reference (i.e.,
internally to an embedded system, such a DSP), which is in phase with the grid
voltage.
The desired characteristic of the PLL is that its dynamics should be fast enough
to not compromise the compensation of harmonic distortions. Moreover, it should
provide the precise synchronization angle when the grid voltage is distorted and/or
unbalanced [41]. Herein, it is considered that the adopted PLL algorithm imple-
mented for the SAPF meets the requirements to generate the synchronization refer-
ence with the grid.
3.3
Current Control Loop
The current control loop is the innermost and the fastest loop in the control system
designed for the SAPF, being responsible to adjust the output current according to
the desired compensation reference.
The reference current (i∗) is collected from the harmonic components (ih) pro-
vided by the AI algorithm, and it is summed with the reference fundamental current
(i∗
1). The latter must be calculated to maintain the VSI’s DC link voltage (VDC) stable,
being obtained through the implementation of a PI controller and a trigonometric
function that uses as input the signal (θ; i.e., given by the PLL) in phase with the
grid voltage.
In this chapter, the current controller is based on the static referential control
structure using PR regulators. The PR controller is implemented in the stationary
referential frame (i.e., the αβ frame), being an alternative to the conventional PI
controller, allowing to achieve zero steady-state error and providing inﬁnite gain at
the interest harmonic frequencies [42, 43].
In Yuan et al. [42], the authors use a PR controller (named stationary-frame gen-
eralized integrators), showing that static reference frame control has the advantage
of working under balanced or unbalanced voltage conditions at the PCC. Moreover,
to achieve a better performance of the PR controller, the resonance frequency con-
troller (ωi) must be calculated online from the synchronized frequency provided by
the PLL. As a result, they guarantee that the resonant term always acts in the ωi
frequency even when there are deviations in the grid frequency [44].

Active Power Filters Applied to Smart Grids …
333
The open loop transfer function of the current (Fi(s)) is given by Eq.(1).
Fi(s) =
⎛
⎝K p1 +

i=3,5,7,9,11
Ki1s
s2 + ω2
i
⎞
⎠G(s)
1
R + sL
(1)
In this equation, K p1 and Ki1 represent the proportional and integral gain, respec-
tively, of the PR controller. The VSI output impedance transfer function is simpliﬁed
by the term 1/(R + sL) and G(s) is the VSI voltage transfer function. The value of
G(s) will depend on the topology and the PWM used of the converter. In parentheses
is the PR transfer function adapted for i odd harmonics. The PR controller allows,
in theory, multiple resonant terms to be added at the frequencies of interest (ωi),
but terms are generally used at the odd-order harmonics up to the 15th order. The
maximum frequency to be compensated must respect the maximum sampling rate
and the cutoff frequency of the VSI output ﬁlter [45].
The reader can ﬁnd in [40, 44, 46] more information about this controller and
how to tune the parameters from (1).
3.4
DC Voltage Control Loop
The DC voltage control loop regulates the bus voltage during the stage where the
VSI acts as a rectiﬁer. The regulation of the DC voltage level is essential to ensure
that the VSI can synthesize the compensation current of the SAPF.
The transfer function of the control plant is obtained from the power balance
between the DC and AC sides, disregarding losses. It can be assumed that the active
power ﬂow from the grid to the ﬁlter is equal to the active power on the DC side [47].
Equation (2) represents the open loop transfer function of the DC voltage (VDC)
loop (Fv(s)) using PI controller. In this equation, K p represents the proportional
gain, Ki represents the integral gain of the PI controller, Gi(s) represents the closed
loop transfer function of the current and in parentheses is the plant transfer function,
where Vg−pk is the maximum value of the voltage at the PCC, C is the capacitance
of the DC bus and 3/2 is a proportionality constant that depends on the topology of
the power converter (in this case it is represented for a three-phase power converter).
Fv(s) = K ps + Ki
s
Gi(s)
3
2
Vg−pk
sCVDC

(2)
Regarding the dynamics of this loop, the choice of the closed loop cut-off fre-
quency for the design of the DC controller gain must guarantee the decoupling
between the voltage control loop and the current control loop. Thus, it is essential to
design the controllers so that the DC voltage control loop is slower than the current
control loop [40].

334
C. Francisco do Nascimento et al.
4
Harmonic Content Detection
Harmonics are sinusoidal voltages or currents in which the frequencies are integer
multiples of the fundamental frequency [48]. The main effects caused by harmonics
are: malfunction of control devices, telephone interference, additional losses in power
lines, and the reduction of equipment lifetime together with increased losses in power
systems [48].
The harmonics can be originated from the non-linearity of the magnetization
of the transformer, rotating electrical machines, distortion caused by electric arc
devices, single-phase rectiﬁers, three-phase current source converters, three-phase
voltage source converters, AC drives fed by frequency inverters, thyristor controlled
reactors, phase modulated controls, AC regulators, among others [10].
The non-sinusoidal signal f (t) is depicted in Eq.(3), where Fcc is the continuous
component, Fn is the amplitude value of the n order component, φn is the phase angle
of the n order component, ω is the angular velocity and t is time.
f (t) = Fcc +
nmax

n=1
Fn cos(nωt + φn)
(3)
According to Eq.(4), the value of Fcc is equal to the mean value of the non-
sinusoidal function at period T provided all harmonics are sinusoidal [10, 49].
Fcc = 1
T
	 T
0
f (t)dt
(4)
It is usual to use symmetrical components to describe the behavior of a three-
phase system [49]. Assuming a balanced system of positive phase sequence (ABC),
Eq.(5) depicts the expressions of the fundamental currents (i(1)
a , i(1)
b
e i(1)
c ), where
I (1)
a , I (1)
b
e I (1)
c
are the maximum values of the fundamental currents. The negative
phase angles show that the phasors rotate clockwise in the space-time plane.
⎧
⎪⎨
⎪⎩
i(1)
a (t) = I (1)
a
cos(ωt)
i(1)
b (t) = I (1)
b
cos(ωt −120◦)
i(1)
c (t) = I (1)
c
cos(ωt −240◦)
(5)
For example, the third harmonic has no angular phase shift between the three
phases, according to Eq.(6). This case is called zero-sequence. Zero sequence com-
ponents are essential in four-wire systems with the star connection side of the trans-
former grounded. Here, there is a circulation of zero sequence currents in the neutral
conductor [49].

Active Power Filters Applied to Smart Grids …
335
⎧
⎪⎨
⎪⎩
i(3)
a (t) = I (3)
a
cos(3ωt)
i(3)
b (t) = I (3)
b
cos 3(ωt −120◦) = I (3)
b
cos(3ωt −360◦) = I (3)
b
cos(3ωt)
i(3)
c (t) = I (3)
c
cos 3(ωt −240◦) = I (3)
c
cos(3ωt −720◦) = I (3)
c
cos(3ωt)
(6)
When the lag between the angles is positive, as with the ﬁfth harmonic in Eq.(7),
the phasors rotate counterclockwise, i.e. opposite to the direction of the fundamental
component. This situation is called negative phase sequence [48, 49].
⎧
⎪⎨
⎪⎩
i(5)
a (t) = I (5)
a
cos(5ωt)
i(5)
b (t) = I (5)
b
cos 5(ωt −120◦) = I (5)
b
cos(5ωt −600◦) = I (5)
b
cos(5ωt + 120◦)
i(5)
c (t) = I (5)
c
cos 5(ωt −240◦) = I (5)
c
cos(5ωt −1200◦) = I (5)
c
cos(5ωt + 240◦)
(7)
Regarding quantifying the harmonic content through a single value, the most
widely used index is the THD [10]. Such a measure is the harmonic components’
effective value of a distorted waveform, e.g. the voltage signal (T H DV ), which is
deﬁned according to (8). In (8), V (h) is the effective value of the h harmonic voltage,
and V (1) is the effective value of the fundamental voltage component.
T H DV =




∞

h=2

V (h)2
V (1)
(8)
Harmonic voltages and currents circulating in the electrical system can cause
resonances, effects on rotating machines, effects on power plants, interference in
control systems, interference in protecting electrical systems, effects on consumer
equipment, interference with communication networks and noise in electric motors
[10].
Harmonic monitoring [10] is used to quantify this phenomenon and involves
capturing and processing voltage and current signals at various points in the electrical
system. Once gathered, this information can be sent to a monitoring system, and a
decision-making process [10].
Once the information related to harmonics is available, the next stage is to mitigate
them if there is interest. There are ways to perform this task. Passive, tuned, damped,
DC, and active ﬁlters can be used. The active ﬁlters are designed to eliminate speciﬁc
harmonics and usually need an instantaneous identiﬁcation of these components at
the PCC. Some standards, such as IEEE 1547 [50], IEC 61727 [51], and IEC 61000-
3-2 [52] establish the limitation of harmonic circulation in electrical and microgrids
in order to guarantee an adequate minimum PQ level.
The harmonic analysis estimates the magnitudes (amplitudes) and phase angles
of the fundamental and the harmonic components of a periodic waveform [10]. The
Fourier series can perform the harmonic analysis and establishes the relationship
between a function in the time domain and the frequency domain [48]. The Fourier

336
C. Francisco do Nascimento et al.
series is a special case of the Fourier transform applied to a periodic signal, such as
the voltage and current waveforms.
Waveform information is often obtained as a function of sample time and is
represented by a time series of amplitudes, separated by ﬁxed time intervals of
limited duration [10, 48]. The DFT is used when working with such data discretized
[10]. Implementing the DFT through the so-called FFT [10] comprises the basis of
most modern spectral and harmonic analysis systems.
FFT has become popular because of its simplicity and computational agility.
However,inmanypracticalcases,asthereisthepresenceofinterharmonics,deviation
from the fundamental frequency, presence of noise not multiples of the fundamental
frequency, and time-varying signals, among others, its performance does not reach
the desired level of accuracy in some applications, mainly related to power electronics
[53–56]. FFT needs at least one full cycle of the voltage or current, depending on
the desired resolution. For example, 10 to 12 cycles are needed for a resolution of
5 Hz [57–59].
Transient and stationary voltage and current signals captured from electrical sys-
tems, when viewed using limited data (because of ﬁnite sampling capacity), introduce
errors in the frequency spectrum of that signal [10, 48].
Some more recent methods using automation and the AI can deal satisfactorily
with this problem. ANN are used to automate disturbance and recognition, and they
can be used in the processing stage to recognize patterns [10, 48, 60].
5
Harmonic Content Determination
Avarietyoftechniqueshavebeenappliedtoextractthefrequencyspectrumofvoltage
or current waveforms, such as:
• Fourier series and coefﬁcients;
• Simpliﬁcations resulting from waveform symmetry;
• The complex form of the Fourier series;
• Convolution of harmonic phasors;
• Fourier transform;
• Sampled time functions;
• Discrete Fourier Transform;
• Nyquist frequency and Aliasing;
• Fast Fourier Transform;
• Slicing functions;
• Wavelet transform;
• Automation of disturbance recognition (e.g. ANN).
For digital applications, in which the signals are discretized, the DFT/FFT method
is extensively used [61–64]. In such cases, the frequency domain spectrum is a
function that uses the signal acquisition in the time domain, and a pair of Fourier
transforms is obtained according to (9).

Active Power Filters Applied to Smart Grids …
337
⎧
⎪⎪⎪⎪⎪⎨
⎪⎪⎪⎪⎪⎩
X( fk) = 1
N
N−1

n=0
x(tn)e−j2πkn/N
x(tn) =
N−1

k=0
X( fk)e j2πkn/N
(9)
in which N is the number of samples per period, X( fk) represents the function of the
component in the frequency domain, and x(tn) represents a sample of the function
in the time domain. The element 2nπ/N represents a clockwise rotation, such that
n = 0, 1, 2, ..., (N −1) [10].
For a high N, the multiplications involved in DFT can take a high computational
cost and consume a lot of computational effort. The FFT arises as an alternative since
it considerably reduces the number of multiplications to fetch the solution [10]. In
practice, an algorithm with a mathematical background has been used to resolve
FFT.
The use of ML was restricted years ago due to the unavailability of computational
resources capable of processing the amount of information required. But, with the
greater availability of resources, it is possible to extend the use of heuristic techniques
that require signiﬁcant computational effort, such as ANN, in the signal processing
of power systems [65]. Some proposals for automating the disturbance recognition
and identiﬁcation process have been developed to improve the speed, reliability and
ease of obtaining and storing information [10], as is exposed in the following section.
5.1
ANN Application
Several recent research efforts have been published applying ML techniques, ANN
and DL to identify PQ related disturbances.
In [13, 66–69], the authors have exposed approaches for applying DNN to the har-
monic detection process with the generation of the reference current for an APF. Test
results reinforce that the methods can estimate low-frequency harmonics accurately.
In [70, 71], ML-based approaches are applied to increase the speed of detecting PQ
events such as voltage sags, voltage surges, interruptions and harmonics.
In Abdeslam et al. [72], the authors introduced a harmonic identiﬁcation and
compensation technique in that components can be selected individually, and the
reactive power can also be compensated. In [59, 73–76], the authors employed an
ANN to identify amplitudes and phase angles of distorted signals. The proposed
algorithm achieved higher accuracy, convergence speed, and stability in permanent
regimes than conventional methods used to identify harmonics.
In Nascimento et al. [5, 77], an ANN was used to identify harmonic currents of
a single-phase nonlinear load. The model could efﬁciently estimate the components
present in the electrical system.

338
C. Francisco do Nascimento et al.
In Flores-Garrido et al. [78], an ANN was developed to estimate the Fourier coef-
ﬁcients comparable to the fundamental voltage or current waveforms components.
In Manito et al. [79], the authors presented a method to estimate the impacts caused
by the harmonic voltage distortion of multiple non-linear loads in electrical grids.
The work of Xu et al. [80] considered a solution by using an ANN based control
method for a power electronic converter connected to an industrial microgrid. In [81],
the authors detected islanding and PQ problems using ANN and Wavelet transform in
a hybrid distributed generation system composed of PV and wind systems connected
to PCC.
In the work of Gong and Ruan [82], the authors presented a DNN framework
addressing problems with low convergence speed, low accuracy, and poor general-
ization ability of electrical disturbance identiﬁcation and classiﬁcation methods. In
addition, the authors developed a new disturbance identiﬁcation method speciﬁc to a
microgrid. Compared to other methods used for the same purpose, the proposed one
presented high accuracy, higher convergence speed and strong generalization ability.
In Kumar et al. [83], the authors used a model based on ANN to perform the
prediction of electric charging systems. However, in [84–87], energy management
strategies based on ANN were developed for PV systems, and the beneﬁts of their
use were presented.
The study conducted by Ciabattoni et al. [88] dealt with the insertion of AI in
the residential sector and the possibility of implementing demand-side ﬂexibility.
The AI-based approaches, when applied to estimation, prediction and aggregation of
consumer energy consumption patterns, transform smart applications and the mode
of consumption. They concluded that consumers would become more active in a
short time, and their actions would signiﬁcantly impact the energy sector.
The study conducted by Çetin, Dalcalı and Temurta¸s [89] successfully estimated
the parameters of the equivalent circuit of a squirrel cage induction motor through
a feed-forward neural network. According to the results, using back-fed neural net-
works to predict equivalent circuit parameters of the squirrel cage induction motor
is sufﬁcient.
DL and ML techniques are adequate for identifying PQ disturbances. This type
of solution offers advantages such as low computational effort and simpliﬁcation of
the harmonics identiﬁcation process. The following section discusses the concepts
of ANN and their computational implementation.
6
DNN for Harmonic Estimation
According to Silva et al. [90], the PQ assessment was signiﬁcantly improved after
employing the concept of intelligent systems. Araujo [91] states that the DNN can
keep the information, identify and classify patterns, and perform predictions. Know-
ing that the identiﬁcation of harmonics requires extracting the characteristics and
peculiarities of the electrical signal, it becomes convenient to use DNN for this pur-
pose, as shown in work done, for example, by Lima et al. [92–94].

Active Power Filters Applied to Smart Grids …
339
This section discusses the development of training, validation and testing samples
and the implementation method of the proposed DNN. In addition, it performed
comparisons between the proposed model and other consolidated regressors in the
literature. The programming language used to obtain the information in this chapter
is Python 3.8, through the development environment JupyterLab 3.0.14
[95].
6.1
Training, Validation and Test of the Samples
The training of the DNN is performed from representative system samples that should
represent the model. Thus, the samples containing waveforms of currents distorted
by harmonics must be obtained.
The deﬁned aim is to estimate [96] amplitudes and phase angles of the harmonic
components of the 3rd, 5th, 7th and 9th orders. The inputs to the computational model
are fed with quarter-cycle waveforms in the time domain. The individual harmonic
currents are generated and summed to form the current sample, such that
⎧
⎪⎪⎪⎪⎪⎪⎨
⎪⎪⎪⎪⎪⎪⎩
i1(t) = I1 cos(ωt + φ1)
i3(t) = I3 cos(3ωt + φ3)
i5(t) = I5 cos(5ωt + φ5)
i7(t) = I7 cos(7ωt + φ7)
i9(t) = I9 cos(9ωt + φ9)
(10)
i(t) = i1(t) + i3(t) + i5(t) + i7(t) + i9(t)
(11)
where in(t) is the harmonic current of order n in the time domain, In is the maximum
amplitude of the harmonic current of order n in pu, φn is the phase angle in radians,
ω is the angular velocity in radians per second (rad/s), and t is the time in seconds.
The range of amplitudes and phase angles (Table 1) used in the sample set was
deﬁned based on the method described in [13] and the load currents described in [49,
97, 98]. The proposed DNN aims to estimate the harmonic orders 3rd, 5th, 7th and
9th, but it was also included in the samples the remaining odd and even harmonics
up to the 13th order to represent the load currents observed in the literature.
Similar waveforms in the sample set should be avoided to perform an optimized
training process [99]. When the amplitude of the generated harmonics is 0 pu, only
the phase angle 0 rad is used, ignoring the others. It is noteworthy that the computer
resources used in this work (RAM of 16 GB and the CPU Intel(R) Core(TM) i7-
10750H) limited the size of the dataset. However, it would be theoretically possible
to synthesize a dataset with a more signiﬁcant variation of amplitudes and phase
angles.

340
C. Francisco do Nascimento et al.
Table 1 Amplitudes and phase angles of the harmonics composed in the training and validation
dataset
Harmonic
Amplitudes [pu]
Phase angle [rad]
1
1.00
0
2
0; 0.025
0.1309
3
0; 0.05; 0.10; ... ; 0.35
0; 0.0873; 0.1745; 0.2618
4
0; 0.025
0.1309
5
0; 0.05; 0,10; ... ; 0.30
0; 0.0873; 0.1745; 0.2618
6
0; 0.025
0.1309
7
0; 0.05; 0,10; ... ; 0.25
0; 0.0873; 0.1745; 0.2618
8
0; 0.025
0.1309
9
0; 0.05; 0,10; 0,15; 0.20
0; 0.0873; 0.1745; 0.2618
10
0; 0.025
0.1309
11
0; 0.025
0.1309
12
0; 0.025
0.1309
13
0; 0.025
0.1309
The number of waveforms in the dataset is calculated by combining the number
of permutations of amplitudes and phase angles for each harmonic signal and the
number of sample positions in the quarter-cycle waveform, according to Table 1. The
total size of the dataset is 10,692,864 quarter-cycle waveforms.
The sampling rate deﬁnes the number of sample positions of a waveform and,
consequently, the feature number of the dataset. According to the Implementation
Guideline for Digital Interface for Transformation Instruments using IEC 61850-9-2
[100], the recommended sampling rate for a voltage with a fundamental frequency
of 60 Hz is 15.36 kHz, which results in a signal discretized at 256 samplings per
waveform, i.e., 64 samplings per quarter cycle. Thus, each dataset instance in this
work comprises a vector with 64 sample positions.
The dataset instances used for training, validation and testing of the DNN in this
work were generated through an algorithm that generates a cosine signal, in the
fundamental frequency, with an amplitude of 1 pu and phase angle of 0 rad (A2, A3,
A4, A5, A6, A7, A8, A9, A10, A11, A12, and A13) and sums signals of odd and even
harmonic frequencies of orders 2 to 13 (φ2, φ3, φ4, φ5, φ6, φ7, φ8, φ9, φ10, φ11, φ12,
and φ13), as illustrated in Fig.4a. The stage illustrated in Fig.4b corresponds to the
estimating process of the amplitudes (α3, α5, α7, and α9) and phase angles (ϕ3, ϕ5,
ϕ7, and ϕ9) of raw data composed of a quarter-cycle waveform. It generated the set of
signals of each harmonic order, which are summed together through a mathematics
routine.
After, a Z-score normalization was applied to the dataset, keeping the mean of
each sample close to zero and the standard deviation close to the unit [101, 102].
With the dataset ready, setting up the DNN model can begin.

Active Power Filters Applied to Smart Grids …
341
Fig. 4 Procedures for data sampling and label generation, and the proposed DNN
6.2
DNN Model Architecture
This work proposes an approach based on DNN for identifying amplitudes and phase
angles of harmonics of 3rd, 5th, 7th and 9th orders. This aim does not involve the
classiﬁcation of waveforms into groups but getting a numerical value in each output
close to the expected value of amplitudes and phase angles. Therefore, this work’s
neural network performs the numerical values regression task.
For DNN regression, the Adamax optimizer is convenient in applications involv-
ing a large amount of data and parameters, and it is computationally efﬁcient [103].
Several loss functions and metrics are suitable for DNN regression; however, accord-
ing to Chollet [104], the loss function and metric used in regression networks are,
respectively, MSE and MAE, which can be deﬁned as:
MSE =

yv −yp
(12)
MAE = yv −yp
(13)
where yv is the expected output and yp is the predicted output by the DNN. The
MAE metric reports how close the estimates are to the expected values.
The parameters of the input and output layers of the neural network can be deter-
mined, respectively, based on the shape of the dataset and the deﬁned objectives. A
64-position vector represents each instance in the dataset. Therefore, the input layer
of the model has a 64-position format. The output layer has 8 positions, or 8 neurons,
given that each value will correspond to a value estimation of the amplitude and
phase angle of the four harmonic frequencies analyzed in this work. The most used
activation function (Table 2) to perform regression is the linear function [104].
The proposed ANN has layers fully connected, called dense layers. It is necessary
to determine the number of layers and the number of neurons in each of these layers.

342
C. Francisco do Nascimento et al.
Table 2 Recommended activation function according to problem type [104]
Problem type
Activation function
Binary classiﬁcation
Sigmoid
Multi-class and single-label classiﬁcation
Softmax
Multi-class and multi-label classiﬁcation
Sigmoid
Regression for arbitrary values
–
Regression for values between 0 and 1
Sigmoid
For this, the grid search method performs an exhaustive search on the parameter val-
ues of the ANN to return the best for the dataset and ANN model [102]. This method
implements training and scoring for each model created within pre-established cri-
teria. The grid search for cross-validation, available in the Scikit Learn [105],
uses the k-fold cross-validation method (k-fold). This method provides training and
testing indices to divide the sample set into training and testing. The method divides
the set into 5 folds (k = 5), with each fold used as validation and the remaining folds
forming the training set [106].
Besides k-fold, other cross-validation methods can be found in the literature like
the Stratiﬁed k-fold, which is applied in neural nets for classiﬁcation, and Stratiﬁed
Random Split, which creates divisions preserving the same percentage for each target
class of the dataset [107], used to divide instances into a training set and a test dataset,
which are used, respectively, in neural net training and evaluation.
The parameters aimed are the number of neurons (n) in the hidden layers and the
number of hidden layers (c) with the tested values of n = {32, 40, 48, ..., 120, 128}
and c = {2, 3, 4}. According to [104], the most widely used activation in DNN is
ReLU, which is adopted in the hidden layers of this regression model.
The grid search results were sorted regarding the MAE in the evaluation stage and
the ﬁve best conﬁgurations, i.e., which with the lowest MAE presented in Table 3. The
conﬁguration with the lowest MAE was adopted to estimate amplitudes and phase
angles of the harmonic components, as proposed in this work. The ﬁnal model is
described in Table 4. The DNN layers received the synaptic weights initializer called
“Glorot Uniform” [108], which is the Keras default, with seed set (seed=333), so
Table 3 Results of the grid search
Classiﬁcation
Hidden layers conﬁguration
MAE
1
(120, 120, 120, 120)
0.030348
2
(80, 80, 80, 80)
0.030856
3
(128, 128, 128, 128)
0.031301
4
(88, 88, 88, 88)
0.031316
5
(32, 32, 32, 32)
0.031931

Active Power Filters Applied to Smart Grids …
343
Table 4 Best DNN conﬁguration for the method
Layer (type)
Activation function
Output format
Number of parameters
Input
–
(None, 64)
–
Hidden_1 (Dense)
ReLU
(None, 120)
7,800
Hidden_2 (Dense)
ReLU
(None, 120)
14,520
Hidden_3 (Dense)
ReLU
(None, 120)
14,520
Hidden_4 (Dense)
ReLU
(None, 120)
14,520
Output (Dense)
Linear
(None, 8)
968
that the sequence of values initialized in the synaptic weights of the layers is always
the same and enables a better reproducibility of this ANN.
After deﬁning the conﬁguration of the DNN model, the next step is to perform
the training, as presented in the Sect.6.3.
6.3
Training of the Proposed DNN
The sample dataset was separated into training and testing sets. Two separation
methods were initially used: the random splitting method for training and testing and
the stratiﬁed splitting method, which creates splits preserving the same percentage
for each target group of the entire set. In both cases, 95% of the instances were
destined for the training set and 5% for the test set.
In the Keras interface, training is performed using the ﬁt method [109]. Fifteen
percent of the training samples were selected for validation while tuning the synaptic
weights. The method was conﬁgured to perform the adjustment for 200 epochs and
can be stopped by a stopping criterion when there is no minimum variation in the
MAE of 0.0001 in 5 epochs in sequence. A learning rate scheduling function was
established, the learning rate is initially 0.001 until the 10th epoch, and from this
epoch on, it is updated according to the function presented in (14).
lra = lrc · e−0,1
(14)
where lra is the updated learning rate, lrc is the current learning rate, and e is the
Euler constant.
The history, which is the record of training loss values and metric values at suc-
cessive epochs, as well as validation loss values and validation metric values (if
applicable), during training using random splitting can be seen in Fig. 5a, as well as
the training history using stratiﬁed splitting can be seen in Fig. 5b.
The training with random division occurred until epoch 54, when the stop-
ping criterion was triggered to avoid unnecessary computational effort since the
mean absolute error did not decrease at the speciﬁed rate of 0.0001 in 5 epochs.

344
C. Francisco do Nascimento et al.
Fig. 5 Training history: a using random sample splitting and b with stratiﬁed sample splitting
The training with stratiﬁed division went until epoch 57, when the interruption by
the stopping criterion occurred. In the last training epoch, the MAE was, respectively,
0.0190 and 0.0174.
The evaluation with instances from the test set was performed with the two trained
models. The model trained with randomly split samples reached a MAE of 0.0190;
while the model trained with stratiﬁed split samples reached a MAE of 0.0174; values
considered stabilized according to Fig. 5 and acceptable for the application [110].
The trained model with the samples divided in a stratiﬁed way was chosen from these
results since the average errors were smaller.
Evaluating only the amplitude estimate, the obtained MAE was 0.0051 pu, rep-
resenting 29.3% of the mean absolute error of the training. On the other hand, the
complete evaluation of phase angles found a mean error of 0.0296 rad, corresponding
to 170.1% of the mean training error. This result may show that the DNN presents
a better performance in the estimation of amplitudes when compared to the perfor-
mance in the estimation of phase angles. Statistically, one can evaluate the perfor-
mance of the model when subjected to the test samples by means of the box plot
diagram in Fig. 6, which represents the grouping of individual errors, by harmonic
order, observed in the output of the DNN model through of quartiles.
In the diagrams of Fig. 6, the medians of all amplitude errors were less than 0.01
pu, and the medians of all phase angle errors were less than 0.05 rad. The 99% errors
Fig. 6 Box diagrams of the individual harmonic components from the DNN regarding the a ampli-
tudes and b phase angles

Active Power Filters Applied to Smart Grids …
345
of the amplitude estimates of the 3rd, 5th, 7th, and 9th harmonics were smaller than
0.0296 pu, 0.0246 pu, 0.0188 pu, and 0.007 pu. The 99th percentile errors of the phase
angle estimates of the 3rd, 5th, 7th, and 9th harmonics were smaller than 0.1599 rad,
0.1511 rad, 0.1065 rad, and 0.0368 rad. The 1% of the most signiﬁcant estimation
errors, represented by dashes in the diagram, is considered outliers.
6.4
Regression Methods Comparison
Other methods well-known in the literature were tested and compared to those pro-
posed to justify the application of DNN for harmonics estimation through regression.
For the type of problem to be modeled in this work, the DNN performs a regression
for arbitrary values.
The main criterion for choosing these other methods was their ability to produce an
output with multiple target values since the proposed DNN has this property. It is used
the Ridge, kNN, DT, and RF methods, all available in the library scikit-learn
[107].
The dataset used in the validation stage was extracted from 1% of the samples
generated according to Sect.6.1, totaling 106,928 waveforms. Grid search was used
in all methods to determine the parameters required in each case. The determination
coefﬁcient (R2) was used as a scoring criterion, such that
R2 = 1 −

i(yvi −ypi)2

i(yv −1
n

i yvi)
(15)
where yv is the output label, yp is the prediction performed by the neural network,
and n is the number of performed estimations. The best score is 1.0 [111].
The MAE was employed as a performance metric, so that the conﬁguration with
the lowest error was considered in the analysis result.
6.4.1
Ridge Regression
Ridge regression handles some problems of ordinary least squares by imposing a
penalty on the size of the coefﬁcients [107]. This method solves a regression model
where the loss function is the linear least squares function, and the l2 norm gives the
regularization [107]. It is also known as ridge regression or Tikhonov regularization.
A parameter search was performed to determine a penalty (alpha) that provides
the smallest MAE. Based on the classiﬁcation achieved (Table 5), it was determined
that the penalty would be 1.50. With the parameter set, the model was trained and
run. The average difference between true and estimated amplitudes was 0.013398
pu. Between phase angles, the average error was 0.070651 rad.

346
C. Francisco do Nascimento et al.
Table 5 Best parameters using grid search for the ridge regression
Classiﬁcation
Alpha
Score
MAE
1
1.50
0.596893
0.041797
2
1.75
0.595492
0.041892
3
2.00
0.594384
0.041969
4
2.25
0.593478
0.042035
5
2.50
0.592715
0.042092
6.4.2
k-Nearest Neighbors
The principle behind nearest-neighbor methods is to ﬁnd a pre-deﬁned number of
training instances closest in the distance to the new point and predict the target feature
using a majority voting mechanism from them [112]. The number of samples can
be a user-deﬁned constant (k-neighbor learning) or vary based on the local density
of points (radius-based neighbor learning). The distance can be any metric measure:
the standard Euclidean distance is the most common choice [105].
The neighbor-based regression can be used where the target feature is non-
categoric. The value for the target feature assigned to a query point is calculated
based on the average of the labels of its nearest neighbors [107]. Learning is imple-
mented based on k-nearest neighbors of each query point, where k is an integer value
speciﬁed by the user.
The grid search algorithm was used to determine the number of neighbors (k) and
the metric that provides the lowest MAE (Table 6). The best set of parameters is with
the Euclidean metric and ﬁve neighbors when the MAE in identifying amplitudes
was 0.013746 pu, and the MAE in phase angles was 0.083748 rad.
6.4.3
Decision Tree
The decision tree method is applied in non-parametric supervised learning for clas-
siﬁcation and regression. This method usually represents a table in tree format [113,
114]. The objective is to create a model that predicts the value of a target variable by
learning simple decision rules inferred from the data features. A tree can be viewed as
a piecewise constant approximation [105]. Decision trees are used to ﬁt a sinusoidal
signal with an additional observation of noise. As a result, the model learns local
linear regressions that approximate the sinusoidal signal [107].
The MAE was chosen as the criteria available in this method, the same used in the
proposed DNN. The exhaustive parameter search algorithm was used to determine
the maximum tree depth (max_depth) that provides the smallest MAE (Table 7). The
best model from the grid search was with a maximum depth of 10. The identiﬁcation
MAE referring to amplitudes and phase angles are 0.020137 pu and 0.086628 rad,
respectively.

Active Power Filters Applied to Smart Grids …
347
Table 6 Best parameters using grid search for the k-nearest neighbors
Classiﬁcation
Distance function k
Score
MAE
1
Euclidean
5
0.506460
0.043637
1
Minkowski
5
0.506460
0.043637
3
Euclidean
4
0.494220
0.043654
3
Minkowski
4
0.494220
0.043654
5
Minkowski
3
0.472730
0.043767
5
Euclidean
3
0.472730
0.043767
7
Minkowski
2
0.426658
0.044112
7
Euclidean
2
0.426658
0.044112
9
Manhattan
5
0.492669
0.044459
10
Manhattan
4
0.479548
0.044514
11
Manhattan
3
0.455360
0.044685
12
Manhattan
2
0.405545
0.045256
13
Euclidean
1
0.252745
0.046507
13
Minkowski
1
0.252745
0.046507
15
Manhattan
1
0.228932
0.047716
Table 7 Best parameters using grid search for the decision tree
Classiﬁcation
max_depth
Score
MAE
1
10
0.445989
0.048663
2
20
0.143038
0.052913
3
30
0.093631
0.053568
6.4.4
Random Forest
The random forest method comprises classiﬁers or regressors whose decision is made
by considering individual decisions of a collection of decisions (named forest due
to the collective of decision trees) [102, 113]. In random forests, each tree in the
ensemble is built from a sample taken with replacement from the training set [107].
The function used as criteria in this method was also MAE for the same reason as
the previous method.
The grid search was performed around the maximum tree depth (max_depth)
and the number of trees in the forest (n_estimators) and the highest score of such
parameters presented in Table 8. A model with a maximum depth of 30 and a number
of trees equal to 100 were the best parameters. The MAE from identifying amplitudes
was 0.012640 pu, and from identifying phase angles were 0.075097 rad.

348
C. Francisco do Nascimento et al.
Table 8 Best parameters using grid search for the random forest
Classiﬁcation
max_depth
n_estimators
Score
MAE
1
30
100
0.557278
0.043300
2
30
50
0.553282
0.043367
3
20
100
0.556035
0.043455
4
20
50
0.550981
0.043621
5
30
20
0.540413
0.043707
6
20
20
0.538808
0.043932
7
20
10
0.514939
0.044621
8
30
10
0.511628
0.044666
9
10
100
0.504732
0.047305
10
10
50
0.503401
0.047352
11
10
20
0.502290
0.047388
12
10
10
0.497629
0.047511
6.4.5
Comparison of the Regression Methods
A DNN model was constructed with 4 hidden layers with ReLU activation function
and 120 neurons in each hidden layer. The output layer has 8 neurons and a linear
activation function. The dataset used in the previous regression methods is applied
to the DNN model. This model obtained an average error in angle estimation of
0.011462 pu and 0.064639 radians regarding phase angles.
The result, presented in Table 9 the dense network presented lower error in esti-
mating amplitudes and phase angles. This result reinforces the ability of DNN to
perform harmonic content estimation, which is also in line with the consulted liter-
ature (Sect. 5.1).
Table 9 Result comparison of the regressor methods
Classiﬁcation
Method
Execution [s]
MAE [pu]
1
DNN
0.274272
0.039556
2
Ridge
0.001294
0.041797
3
Random forest
0.214537
0.043300
4
k-Nearest neighbor
0.377839
0.043637
5
Decision tree
0.000554
0.048663

Active Power Filters Applied to Smart Grids …
349
6.5
Case Studies
A study case is herein presented to demonstrate the operation performance of an
APF devising selective harmonic compensation features. It is considered that the
current references used to control the APF are synthesized by means of amplitude and
phase angle setpoints obtained from the proposed DNN-based approach previously
discussed in this chapter. Thus, the following simulation results demonstrate that
the APF acts mitigating the current components from the 5th, 7th, 11th and 13th
harmonic orders.
The computational simulation developed for this study case considers an APF
emulated by a three-phase and balanced controlled current source [115] (i.e., an ideal
compensator), including the implementation of the DNN-based harmonic estimator,
just as depicted in Fig.7. Consequently, the compensation performance of the APF is
mainly given by such an intelligent approach, since it is responsible for determining
theharmoniccontent of theloadcurrents, whichis usedtogeneratethecurrent control
references [9, 116, 117]. In Akagi et al. [32], it is discussed that the instantaneous
active and reactive power theory (i.e., the PQ theory) can be used to synthesize
reference currents to shunt APFs, while allowing them to satisfactorily compensate
harmonics up to the control bandwidth limit [115]. Moreover, by adopting the PQ
theory, one can precisely calculate the DC-link capacitance of the APF, given the
inertial constant of its power electronics interface [4].
Fig. 7 A three-phase shunt APF synthesizing compensation currents based on the DNN-based
selective harmonic estimation approach

350
C. Francisco do Nascimento et al.
On the other hand, by designing the APF’s control system considering a DNN-
based approach that estimates the load’s harmonic content, one has the advantage of
selectively determining current components to be compensated, while achieving it
at the speed of one quarter of the line frequency. Hence, for the following simulation
results, the considered non-linear load is comprised of a controlled three-phase recti-
ﬁer that feeds a balanced RL load. The ﬁring angle of the rectiﬁer semiconductors is
π/6 rad (30◦) and two load scenarios are assessed during simulations. The ﬁrst sce-
nario presents R = 5 	 and L = 2mH; and the second scenario presents R = 10 	
and L = 5mH. It is also important to mention that the grid voltages are considered
to be balanced and purely sinusoidal during simulations.
The synthesis of the compensation currents for the APF starts by handling the
load’s electrical quantities. First, the load’s currents are measured, being later condi-
tionedanddigitized,consideringalow-passﬁlteringprocedurecapableofattenuating
frequency components higher than 780 Hz (i.e., above the 13th harmonic order). The
now digitized current quantizations support the expected harmonic estimation, which
is performed by feature engineering processes and by adopting the DNN approach.
The feature engineering allows to adjust the digital signals to comply with the input
format required by the DNN method, which is attained by a normalization procedure
and by the aggregation of 64 samples within an array at each quarter of the line
frequency. The DNN method is then processed based on the DNN method, which
returns the estimated harmonic amplitudes and phase angles of the input signals.
Such estimated quantities can later be used to synthesize the APF’s control ref-
erences, allowing a selective harmonic compensation feature to be devised. Thus,
the compensation currents can be provided by the APF at the PCC, consequently
improving the THD at this node.
To give a quantitative representation of the compensation performance achieved
by the DNN method, the computational simulation results are presented in Fig.9
and Table 10. It can be clearly noted that all the quantities estimated by the DNN
led to a signiﬁcant compensation of the respective harmonic components, in some
cases resulting in negligible distortions. Hence, the results show that the proposed
DNN method is capable of estimating current harmonic components with satisfactory
performance, allowing adequate compensation currents to be synthesized for the
operation of the APF.
In Fig.8a, the PCC current is shown considering three simulation scenarios for
the APF operation. Initially, between 0 and 37.5 ms, only the load current is depicted
while the APF is disabled (see Fig.8b as well). The compensation action of the APF
starts at 37.5 ms, allowing it to inject the selected harmonic currents at the PCC,
as seen in Fig.8b. One can note in Fig.8a that the PCC current now resembles a
sinusoidal waveform, demonstrating that the harmonic distortions were signiﬁcantly
minimized. The third scenario then shows another perspective, in which the RL
load is changed at 70.8 ms. Such a condition leads to a negative current demand
step that requires the DNN to update its output in order to adequately estimate the
new harmonic content targeted on the compensation. Note that the compensation
provided by the APF maintained an effective operation upon the load step, although
the injected currents were different from the previous scenario (i.e., see Fig.8b).

Active Power Filters Applied to Smart Grids …
351
Fig. 8 a Input AC current of the non-linear load, and b the compensation current injected by the
APF at the PCC. Only one phase is presented in this result
Fig. 9 Harmonic spectrum of the PCC current
Table 10 Percentage of the individual harmonic distortions and THD at the PCC, before and after
the APF operation
Harmonics
Before compensation (%)
After compensation (%)
5
22,3
3,1
7
11,7
2,3
11
9,1
0,5
13
6,6
0,8
THD
29,9
12,2
An overall 57% minimization was achieved for the distortions as a result of the APF
operation based on the DNN method since the THD reduced from 29,88% to 12,16%.
In addition, the individual harmonic components (i.e., the ones selectively targeted
during compensation) could be attenuated by 50 to 92%, indicating that the DNN-
based approach applied to APFs presents satisfactory compensation performance
(see Fig.9). It is also important to mention that the remaining non-linear currents at
the PCC are due to minor errors in the harmonic estimation process, also being a result
of the higher order harmonic components not targeted on the selective compensation.

352
C. Francisco do Nascimento et al.
7
Final Considerations
The smart grid paradigm has grounds on the interdisciplinary utilization of multiple
engineering technological tools. Among such modern tools lie the ﬂexible manage-
ment of active power conditioners, the implementation of control strategies striving
for enhanced energy efﬁciency, as well as the integration of intelligent algorithms.
Hence, this chapter demonstrated the methodological perspective and the applica-
tion features of an approach that incorporates all these three aforementioned tools,
as expected for the deployment of a real digitized power system (i.e., a smart grid).
Therefore, it has been demonstrated that the application of the ANN-based tech-
nique applied to harmonic determination contributes to improving the performance
of the SAPF and, by considering the context of smart grids, provides power quality
improvement for a more efﬁcient operation of the power system.
All in all, the adoption of computational mechanisms capable of generating refer-
ence currents for APFs has signiﬁcant relevance to the electrical power sector, mainly
because artiﬁcial intelligence techniques are deemed to be omnipresent in smart
grids. The integration of intelligent concepts, which in this chapter provides means
to establish an efﬁcient harmonic estimation strategy, assists the reader in acquiring
knowledge of the fundamentals of power quality in modern grids. In addition, the
technical content presented here supports the reader on expanding ones’ understand-
ing on the application of automatic systems in the energy ﬁeld. The results of the
harmonic content estimation depicted in this chapter reinforce the multidisciplinary
application perspective of the approach. At last, it highlights the trend of combining
the electrical and computer engineering areas, striving for the implementation of
smarter and more ﬂexible power grids.
References
1. Radoglou-Grammatikis PI, Sarigiannidis PG (2019) Securing the smart grid: a comprehensive
compilation of intrusion detection and prevention systems. IEEE Access 7:46595–46620 Apr
2. Song EY et al (2022) A methodology for modeling interoperability of smart sensors in smart
grids. In: IEEE transactions on smart grid, vol 13.1(Jan 2022), pp 555–563. https://doi.org/
10.1109/tsg.2021.3124490
3. Saleem Y et al (2019) Internet of things-aided smart grid: technologies, architectures, appli-
cations, prototypes, and future research directions. IEEE Access 7:62962–63003 Apr
4. Nascimento CF et al (2017) Analysis of noncharacteristic harmonics generated by voltage-
source converters operating under unbalanced voltage. In: IEEE transactions on power deliv-
ery, vol 32.2(Apr 2017), pp 951–961. https://doi.org/10.1109/tpwrd.2016.2593684
5. do Nascimento CF et al (2011) Harmonic identiﬁcation using parallel neural networks in
single-phase systems. In: Applied soft computing, vol 11.2(Mar 2011), pp 2178–2185. https://
doi.org/10.1016/j.asoc.2010.07.017
6. dos Santos Alonso AM et al (2022) Resistive shaping of interconnected low-voltage micro-
grids operating under distorted voltages. In: IEEE transactions on industrial electronics, vol
69.9, pp 9075–9086. https://doi.org/10.1109/TIE.2021.3112965
7. Alkahtani AA et al (2020) Power quality in microgrids including supraharmonics: issues,
standards, and mitigations. IEEE Access 8:127104–127122

Active Power Filters Applied to Smart Grids …
353
8. Bernardino LGR et al (2021) Neural-network-based approach applied to harmonic component
estimation in microgrids. In: 2021 Brazilian power electronics conference (COBEP), pp 1–6.
https://doi.org/10.1109/COBEP53665.2021.9684083
9. Akagi H, Watanabe EH, Aredes M (2007) Instantaneous power theory and applications to
power conditioning. IEEE/Wiley, Piscataway, NJ, USA
10. Arrillaga J, Watson NR (2004) Power system harmonics. Wiley, May 2004. 412 pp. ISBN:
9780470871218
11. Shrivastava P, Sharma A, Channi HK (2022) Static security assessment and contingency
analysis for smart grid. In: 2022 6th international conference on computing methodologies
and communication (ICCMC). IEEE, Mar 2022. https://doi.org/10.1109/iccmc53470.2022.
9753814
12. Evans RD, Muller HN (1939) Harmonics in the A-C circuits of grid-controlled rectiﬁers and
inverters. In: Transactions of the American institute of electrical engineers, vol 58.12, pp
861–870. https://doi.org/10.1109/TAIEE.1939.5057906
13. Temurtas F et al (2004) Harmonic detection using feed forward and recurrent neural networks
for active ﬁlters. In: Electric power systems research, vol 72.1(Nov 2004), pp 33–40. https://
doi.org/10.1016/j.epsr.2004.02.005
14. Charu C. Aggarwal. Neural Networks and Deep Learning. Springer International Publishing,
Sept. 2018. 524 pp. isbn: 3319944622
15. Conrado BRP et al (2023) Towards technical and economic feasibility of power qual-
ity compensators. In: Electric power systems research, vol 216, p 109020. ISSN: 0378-
7796. https://doi.org/10.1016/j.epsr.2022.109020. https://www.sciencedirect.com/science/
article/pii/S0378779622010690
16. Awad FH et al (2020) Simpliﬁed methods of the 3D-SVPWM for four-wire three-leg inverter.
J. Power Electron 20:1405–1419. https://doi.org/10.1007/s43236-020-00133-4
17. Busarello TDC et al (2021) Hardware-in-the-loop experimental setup of a LCL-ﬁltered grid-
connected inverter with digital proportional-resonant current controller. In: 2021 IEEE 22nd
workshop on control and modelling of power electronics (COMPEL), pp 1–8. https://doi.org/
10.1109/COMPEL52922.2021.9646047
18. Nunez-Zuniga TE, Pomilio JA (2002) Shunt active power ﬁlter synthesizing resistive loads.
In: IEEE transactions on power electronics, vol 17.2, pp 273–278. https://doi.org/10.1109/
63.988946
19. von Jouanne A, Enjeti PN, Lucas DJ (1996) DSP control of high-power UPS systems feeding
nonlinear loads. In: IEEE transactions on industrial electronics, vol 43.1, pp 121–125. https://
doi.org/10.1109/41.481416
20. Lazzarin T, Barbi I (2012) DESIGN OF A 660V/15 KVA singlephase UPS based on series con-
nection of low-outputvoltage modular UPS. In: Revista Eletrôica de Potência (SOBRAEP),
vol 17.3, pp 584–591. https://doi.org/10.18618/REP.2012.3.584591
21. Singh B, Al-Haddad K, Chandra A (1999) A reviewof active ﬁlters for power quality improve-
ment. In: IEEE transactions on industrial electronics, vol 46.5, pp 960–971. https://doi.org/
10.1109/41.793345
22. Akagi H (1996) New trends in active ﬁlters for improving power quality. Proceedings of
international conference on power electronics, drives and energy systems for industrial growth
1:417–425. https://doi.org/10.1109/PEDES.1996.539652
23. Khan I, Vijay AS (2022) Doolla S (2022) Nonlinear load harmonic mitigation strategies in
microgrids: state of the art. IEEE Syst J 16(3):4243–4255. https://doi.org/10.1109/JSYST.
2021.3130612
24. Tokarev VG, Brovanov SV (2021) An investigation of the performance of single- and double-
converter parallel active power ﬁlters under various modulation modes. In: 2021 XV interna-
tional scientiﬁc—technical conference on actual problems of electronic instrument engineer-
ing (APEIE). IEEE, Nov 2021. https://doi.org/10.1109/apeie52976.2021.9647692
25. Jalil M, Amiri A (2020) An effective structure of three-phase parallel hybrid active power ﬁlter
to accurate harmonic elimination. In: 2020 15th international conference on protection and
automation of power systems (IPAPS). IEEE, Dec 2020. https://doi.org/10.1109/ipaps52181.
2020.9375544

354
C. Francisco do Nascimento et al.
26. AkagiH(2005)Activeharmonicﬁlters.In:ProceedingsoftheIEEE,vol93.12,pp2128–2141.
https://doi.org/10.1109/JPROC.2005.859603
27. Zhang Y, (2021) Three-Phase Four-Wire LCL ﬁlter active damping control based on common
mode capacitor current feedback. In, et al (2021) 6th international conference on power
and renewable energy (ICPRE). IEEE, Sept 2021. https://doi.org/10.1109/icpre52634.2021.
9635447
28. Mouﬁd M, Tahar B (2022) Comparison between harmonic identiﬁcation techniques of active
ﬁlter with experimental validation. In: 2022 IEEE 2nd international maghreb meeting of
the conference on sciences and techniques of automatic control and computer engineering
(MI-STA). IEEE, May 2022. https://doi.org/10.1109/mi-sta54861.2022.9837533
29. Aredes M, Watanabe EH (1995) New control algorithms for series and shunt three-phase
four-wire active power ﬁlters. IEEE Trans Power Del 10(3):1649–1656
30. Xu Q et al (2014) High precision control strategy for three-phase four-wire shunt active power
ﬁlter. In: Proceedings of the 23rd IEEE international symposium on industrial electronics, pp
509–514
31. Lam C-S et al (2012) Adaptive DC-link voltage-controlled hybrid active power ﬁlters for
reactive power compensation. IEEE Trans Power Electron 27(4):1758–1772
32. Akagi H, Kanazawa Y, Nabae A (1984) Instantaneous reactive power compensators compris-
ing switching devices without energy storage components. In: IEEE transactions on industry
applications IA-20.3, pp 625–630
33. Tenti P, Paredes HKM, Mattavelli P (2011) Conservative power theory, a framework to
approach control and accountability issues in smart microgrids. In: IEEE transactions on
power electronics, vol 26.3, pp 664–673. https://doi.org/10.1109/TPEL.2010.2093153
34. Oppenheim AV, Schafer RW (2009) Discrete-Time signal processing, 3rd. Prentice Hall Press,
Upper Saddle River, NJ, USA. 0131988425, 9780131988422
35. Alonso AMS et al (2020) A selective harmonic compensation and power control approach
exploiting distributed electronic converters in microgrids. Int J Electr Power Energy Syst
115:1–15. https://doi.org/10.1016/j.ijepes.2019.105452
36. Nascimento CF et al (2013) Harmonic distortion monitoring for nonlinear loads using neural-
network-method. Appl Soft Comput 13(1):475–482
37. Green TC, Marks JH (2005) Control techniques for active power ﬁlters. In: IEE proceedings—
electric power applications, vol 152(2 Mar 2005), pp 369–381(12). ISSN: 1350-2352
38. Buso S, Malesani L, Mattavelli P (1998) Comparison of current control techniques for active
ﬁlter applications. In: IEEE transactions on industrial electronics, vol 45.5, pp 722–729.
https://doi.org/10.1109/41.720328
39. Holmes DG, Lipo TA (2003) Pulse width modulation for power converters: principles and
practice. IEEE press series on power and energy systems. Wiley. ISBN: 9780471208143.
https://books.google.com.br/books?id=8LGi1AjSfpcC
40. Buso S, Mattavelli P (2015) Digital control in power electronics, 2nd. Morgan & Claypool
Publishers. ISBN: 1627057536
41. Hoon Y et al (2019) Shunt active power ﬁlter: a reviewon phase synchronization
control techniques. In: Electronics, vol 8.7. ISSN: 2079-9292. https://doi.org/10.3390/
electronics8070791. https://www.mdpi.com/2079-9292/8/7/791
42. Yuan X et al (2000) Stationary frame generalized integrators for current control of active power
ﬁlters with zero steady state error for current harmonics of concern under unbalanced and
distorted operation conditions. In: Conference record of the 2000 IEEE industry applications
conference. Thirty-Fifth IAS annual meeting and world conference on industrial applications
of electrical energy (Cat No 00CH37129), vol 4, pp 2143–2150. https://doi.org/10.1109/IAS.
2000.883122
43. Yepes AG et al (2011) Analysis and design of resonant current controllers for voltage-source
converters by means of nyquist diagrams and sensitivity function. In: IEEE transactions on
industrial electronics, vol 58.11, pp 5231–5250. https://doi.org/10.1109/TIE.2011.2126535
44. Yepes AG et al (2010) Effects of discretization methods on the performance of resonant
controllers. In: IEEE transactions on power electronics, vol 25.7, pp 1692–1712. https://doi.
org/10.1109/TPEL.2010.2041256

Active Power Filters Applied to Smart Grids …
355
45. Gonçalves AFQ et al (2016) Voltage and power control used to stabilise the distributed gen-
eration system for stand-alone or gridconnected operation. In: IET power electronics, vol 9.3,
pp 491–501
46. Zmood DN, Holmes DG (2003) Stationary frame current regulation of PWMinverters with
zero steady-state error. In: IEEE transactions on power electronics, vol 18.3, pp 814–822.
https://doi.org/10.1109/TPEL.2003.810852
47. Doval J et al (1998) Shunt active power ﬁlter with harmonic current control strategy. In: PESC
98 record. 29th Annual IEEE power electronics specialists conference (Cat No 98CH36196),
vol 2, pp 1631–1635. https://doi.org/10.1109/PESC.1998.703397
48. Fuchs E, Masoum MAS (2015) Power quality in power systems and electrical machines.
Elsevier Science & Techn, July 2015, 1140 pp
49. Dugan RC et al (2012) Electrical power systems quality, 3rd ed. Mcgraw Hill Book Co, Jan
2012, 580 pp. ISBN: 0071761551
50. IEEE (2018) IEEE standard for interconnection and interoperability of distributed energy
resourceswithassociatedelectric powersystemsinterfaces.In: IEEEStd1547-2018(Revision
of IEEE Std 1547-2003), pp 1–138. https://doi.org/10.1109/IEEESTD.2018.8332112
51. IEC (2004) IEC standard for photovoltaic (PV) systems—characteristics of the utility inter-
face. In: IEC 61727:2004, pp 1–23
52. IEC (2018) IEC standard for electromagnetic compatibility (EMC)—Part 3–2: Limits—
Limits for harmonic current emissions (equipment input current ≤16 A per phase). In: IEC
61000-3-2:2018, pp 1–73
53. Lin HC (2007) Intelligent neural network-based fast power system harmonic detection. In:
IEEE transactions on industrial electronics, vol 54.1(Feb 2007), pp 43–52. https://doi.org/10.
1109/tie.2006.888685
54. Lin HC (2012) Power harmonics and interharmonics measurement using recursive group-
harmonic power minimizing algorithm. In: IEEE transactions on industrial electronics, vol
59.2(Feb 2012), pp 1184–1193. https://doi.org/10.1109/tie.2011.2157281
55. Chang GW, Chen C-I (2010) An accurate time-domain procedure for harmonics and interhar-
monicsdetection.In:IEEEtransactionsonpowerdelivery,vol25.3(July2010),pp1787–1795.
https://doi.org/10.1109/tpwrd.2009.2037230
56. Zhu TX (2007) Exact harmonics/interharmonics calculation using adaptive windowwidth. In:
IEEE transactions on power delivery, vol 22.4(Oct 2007), pp 2279–2288. https://doi.org/10.
1109/tpwrd.2007.899526
57. IEC 61000 (2020) IEC standard for electromagnetic compatibility (EMC)—Part 4–3: testing
andmeasurement techniques—radiated,radio-frequency,electromagnetic ﬁeldimmunitytest.
In: IEC 61000-4-3:2020, pp 1–81
58. Ferreira LRA et al (2019) Analysis of harmonic and interharmonic components by using
an improved recursive algorithm. In: 2019 IEEE PES innovative smart grid technologies
conference—Latin America (ISGT Latin America), pp 1–6. https://doi.org/10.1109/ISGT-
LA.2019.8895462
59. Jain SK, Singh SN (2012) ESPRIT assisted artiﬁcial neural network for harmonics detection
of time-varying signals. In: 2012 IEEE power and energy society general meeting. IEEE, July
2012. https://doi.org/10.1109/pesgm.2012.6343934
60. MoreiraACetal(2018)Evaluationofpatternrecognitionalgorithmsforapplicationsonpower
factor compensation. J Control Autom Electr Syst 29.1(Feb 2018):75–90. ISSN: 2195-3899.
https://doi.org/10.1007/s40313-017-0352-9. https://doi.org/10.1007/s40313-017-0352-9
61. Asiminoael L, Blaabjerg F, Hansen S (2007) Detection is key—Harmonic detection methods
for active power ﬁlter applications. In: IEEE industry applications magazine, vol 13.4, pp
22–33. https://doi.org/10.1109/MIA.2007.4283506
62. Zheng Z et al (2012) A transient harmonic current protection scheme for HVDC transmission
line. In: IEEE transactions on power delivery, vol 27.4, pp 2278–2285. https://doi.org/10.
1109/TPWRD.2012.2201509
63. Xia Y et al (2017) A complex least squares enhanced smart DFT technique for power system
frequency estimation. In: IEEE transactions on power delivery, vol 32.3, pp 1270–1278.
https://doi.org/10.1109/TPWRD.2015.2418778

356
C. Francisco do Nascimento et al.
64. Silva KM, Nascimento FAO (2018) Modiﬁed DFT-Based phasor estimation algorithms for
numerical relaying applications. In: IEEE transactions on power delivery, vol 33.3, pp 1165–
1173. https://doi.org/10.1109/TPWRD.2017.2738621
65. Shukl P, Singh B (2020) Delta-Bar-Delta neural-network-based control approach for power
quality improvement of solar-pv-interfaced distribution system. In: IEEE transactions on
industrial informatics, vol 16.2, pp 790–801. https://doi.org/10.1109/TII.2019.2923567
66. Han Y et al (2009) Study on a novel approach to active power ﬁlter control using neu-
ral network-based harmonic identiﬁcation scheme. In: Electrical engineering, vol 91.6(Nov
2009), pp 313–325. https://doi.org/10.1007/s00202-009-0143-9
67. Dai J, Venayagamoorthy GK, Harley RG (2009) Harmonic identiﬁcation using an Echo State
Network for adaptive control of an active ﬁlter in an electric ship. In: 2009 international
joint conference on neural networks. IEEE, June 2009. https://doi.org/10.1109/ijcnn.2009.
5178808
68. Nguyen NK et al (2011) Harmonics identiﬁcation with artiﬁcial neural networks: application
to active power ﬁltering. Int J Emerg Electric Power Syst 12.5(Aug 2011). https://doi.org/10.
2202/1553-779x.2783
69. Jain SK, Singh SN (2014) Low-Order dominant harmonic estimation using adaptive wavelet
neural network. In: IEEE transactions on industrial electronics, vol 61.1(Jan 2014), pp 428–
435. https://doi.org/10.1109/tie.2013.2242414
70. Ghazanfarpour B et al (2013) Adaptive uniﬁed neural network for dynamic power quality
compensation. In: 2013 IEEE 7th international power engineering and optimization confer-
ence (PEOCO). IEEE, June 2013. https://doi.org/10.1109/peoco.2013.6564526
71. UcarFetal(2019)Bundleextremelearningmachineforpowerqualityanalysisintransmission
networks. In: Energies, vol 12.8(Apr 2019), p 1449. https://doi.org/10.3390/en12081449
72. Abdeslam DO et al (2006) Power harmonic identiﬁcation and compensation with an artiﬁcial
neural network method. In: 2006 IEEE international symposium on industrial electronics.
IEEE, July 2006. https://doi.org/10.1109/isie.2006.295832
73. Temurtas H, Temurtas F (2011) An application of neural networks for harmonic coefﬁcients
and relative phase shifts detection. In: Expert systems with applications, vol 38.4, pp 3446–
3450. ISSN: 0957-4174. https://doi.org/10.1016/j.eswa.2010.08.131
74. Jain SK, Singh SN (2013) Fast harmonic estimation of stationary and time-varying signals
using EA-AWNN. In: IEEE transactions on instrumentation and measurement, vol 62.2(Feb
2013), pp 335–343. https://doi.org/10.1109/tim.2012.2217637
75. Garanayak P, Panda G (2017) An adaptive linear neural network with least mean M-estimate
weight updating rule employed for harmonics identiﬁcation and power quality monitoring. In:
Transactions of the institute of measurement and control, vol 40.6(Mar 2017), pp 1936–1949.
https://doi.org/10.1177/0142331217695402
76. Žnidarec M et al (2019) Harmonic distortion prediction model of a grid-tie photovoltaic
inverter using an artiﬁcial neural network. In: Energies, vol 12.5(Feb 2019), p 790. https://
doi.org/10.3390/en12050790
77. Nascimento CF et al (2013) Harmonic distortion monitoring for nonlinear loads using neural-
network-method. In: Applied soft computing, vol 13.1(Jan 2013), pp 475–482. https://doi.
org/10.1016/j.asoc.2012.08.043
78. Flores-Garrido JL, Salmerón P, Gómez-Gaán JA (2021) Nonlinear loads compensation using
a shunt active power ﬁlter controlled by feedforward neural networks. In: Applied sciences,
vol 11.16(Aug 2021), p 7737. https://doi.org/10.3390/app11167737
79. Manito A et al (2018) Evaluating harmonic distortions on grid voltages due to multiplenonlin-
ear loads using artiﬁcial neural networks. In: Energies, vol 11.12(Nov 2018), p 3303. https://
doi.org/10.3390/en11123303
80. Xu J et al (2011) ANN-based control method implemented in a voltage source converter for
industrial micro-grid. In: sixth international conference on bio-inspired computing: theories
and applications. IEEE, Sept 2011. https://doi.org/10.1109/bic-ta.2011.18
81. Puthenpurakel SP, Subadhra PR, (2016) Identiﬁcation and classiﬁcation of microgrid distur-
bances in a hybrid distributed generation system using wavelet transform. In: International

Active Power Filters Applied to Smart Grids …
357
conference on next generation intelligent systems (ICNGIS). IEEE, Sept 2016. https://doi.
org/10.1109/icngis.2016.7854066
82. Gong R, Ruan T (2020) A new convolutional network structure for power quality disturbance
identiﬁcation and classiﬁcation in micro-grids. IEEE Access 8:88801–88814. https://doi.org/
10.1109/access.2020.2993202
83. KumarSetal(2018)Energyloadforecastingusingdeeplearningapproach-LSTMandGRUin
spark cluster. In: 2018 ﬁfth international conference on emerging applications of information
technology (EAIT). IEEE, Jan 2018. https://doi.org/10.1109/eait.2018.8470406
84. Kumar R, Bansal HO (2019) Real-time implementation of adaptive PV-integrated SAPF
to enhance power quality. In: International transactions on electrical energy systems, vol
29.5(May 2019), p e12004. https://doi.org/10.1002/2050-7038.12004
85. Kumar N, Singh B, Panigrahi BK (2019) PNKLMF-Based neural network control and
learning-based HC MPPT technique for multiobjective grid integrated solar PV based dis-
tributed generating system. In: IEEE transactions on industrial informatics, vol 15.6(June
2019), pp 3732–3742. https://doi.org/10.1109/tii.2019.2901516
86. Faria J et al (2019) Power management control strategy based on artiﬁcial neural networks
for standalone PV applications with a hybrid energy storage system. In: Energies 12.5 (Mar.
2019), p. 902. https://doi.org/10.3390/en12050902
87. Alsaidan I et al (2021) An intelligent approach to active and reactive power control in a grid-
connected solar photovoltaic system. In: Sustainability, vol 13.8(Apr 2021), p 4219. https://
doi.org/10.3390/su13084219
88. Ciabattoni L et al (2020) AI-Powered home electrical appliances as enabler of demand-side
ﬂexibility. In: IEEE consumer electronics magazine, vol 9.3(May 2020), pp 72–78. https://
doi.org/10.1109/mce.2019.2956197
89. Çetin O, Dalcalı A, Temurta¸s F (2020) A comparative study on parameters estimation of
squirrel cage induction motors using neural networks with unmemorized training. Eng Sci
Technol Int J 23.5(Oct 2020):1126–1133. https://doi.org/10.1016/j.jestch.2020.03.011
90. Silva P et al (2019) Photovoltaic distributed generation—an international review on diffusion,
support policies, and electricity sector regulatory adaptation. In: Renewable and sustainable
energy reviews, vol 103, pp 30–39. ISSN: 1364-0321
91. de Araújo MMC (2017) Metodologia baseada em redes neurais artiﬁciais para a deteção
de danos estruturais. Doutorado em Engenharia Elétrica. Universidade de Brasília.
https://repositorio.unb.br/handle/10482/32151
92. Lima MAA (2013) Uma nova metodologia para análise da qualidade da energia elétrica
sob condições de ocorrência de múltiplos distúrbios. PhD thesis. Universidade de São Paulo
(USP). https://doi.org/10.11606/t.18.2013.tde-14112013-102931
93. de Andrade LCM (2017) Transformada Wavelet e técnicas de inteligência computacional
aplicadas a identiﬁcacção, compressão e armazenamento de sinais no contexto de qualidade
da energia elétrica. PhD thesis. Universidade de São Paulo (USP). https://doi.org/10.11606/
t.18.2017.tde-09082017-081609
94. Gelves JJP (2017) Lógica Fuzzy e redes neurais aplicadas para previsão de curvas de carga de
chuveiroselétricosemprogramasdeeﬁciênciaenergéticanoBrasil.DoutoradoemEngenharia
Mecânica. Universidade Estadual de Campinas. http://repositorio.unicamp.br/jspui/handle/
REPOSIP/322819
95. Kluyver T et al (2016) Jupyter Notebooks–a publishing format for reproducible computational
workﬂows. In: Loizides F, Schmidt B (eds) Positioning and power in Academic Publishing:
players, agents and agendas. IOS Press, pp 87–90
96. Grus J (2016) Data Science do Zero. Alta Books, S.l. 9788576089988
97. Masoum EFMAS, Ladjevardi M (2005) Effects on distribution feeders from electronic loads
based on future peak-load growth, part I: measurements. In: Proceedings of the IASTED
international conference on power and energy systems (EuroPES 2005), pp 449–454
98. Michalec L et al (2021) Impact of harmonic currents of nonlinear loads on power quality of
a low voltage network-review and case study. In: Energies, vol 14.12(June 2021), p 3665.
https://doi.org/10.3390/en14123665

358
C. Francisco do Nascimento et al.
99. Gupta Set al (2022)Adaptive sampling-basedartiﬁcial neural networkforsurrogate modeling.
In: AIAA SCITECH 2022 Forum. American Institute of Aeronautics and Astronautics, Jan
2022. https://doi.org/10.2514/6.2022-0805
100. UCA (2004) Implementation guideline for digital interface to instrument transformers
using IEC 61850-9-2. https://iec61850.ucaiug.org/Implementation%20Guidelines/Forms/
AllItems.aspx. Accessed 16 Oct 2021
101. Ba JL, Kiros JR, Hinton GE (2016) Layer normalization. https://doi.org/10.48550/ARXIV.
1607.06450
102. Souza WA et al (2022) Selection of features from power theories to compose NILM datasets.
In: Advanced engineering informatics, vol 52(Apr 2022), p 101556. https://doi.org/10.1016/
j.aei.2022.101556
103. Kingma DP, Ba J (2014) Adam: a method for stochastic optimization. https://doi.org/10.
48550/ARXIV.1412.6980 arxiv:abs/1412.6980
104. Chollet F (2017) Deep learning with python. Manning, Nov 2017. ISBN: 1617294438
105. Scikit Learn (2021) User Guide
106. de Souza WA, de Almeida TA (2022) An effective CPT-based nonintrusive load monitoring
for cognitive meters. In: IEEE transactions on smart grid, vol 13.3, pp 2148–2157. https://
doi.org/10.1109/TSG.2022.3144606
107. Pedregosa F et al (2011) Scikit-learn: machine learning in python. J Mach Learn Res 12:2825–
2830
108. Glorot X, Bengio Y (2010) Understanding the difﬁculty of training deep feedforward neu-
ral networks. In: Teh YW, Titterington M (eds) Proceedings of the thirteenth international
conference on artiﬁcial intelligence and statistics, vol 9. Proceedings of machine learning
research. Chia Laguna Resort, Sardinia, Italy: PMLR, 13–15 May 2010, pp 249–256. https://
proceedings.mlr.press/v9/glorot10a.html
109. Keras K (2021) API reference. https://keras.io/api/ . Accessed 22 Feb 2022
110. Vinayagam A et al (2021) An ensemble approach of classiﬁcation model for detection and
classiﬁcation of power quality disturbances in PV integrated microgrid network. In: Applied
soft computing, vol 106(July 2021), p 107294. https://doi.org/10.1016/j.asoc.2021.107294
111. Ozer DJ (1985) Correlation and the coefﬁcient of determination. In: Psychological bulletin,
vol 97.2, p 307
112. Souza WA et al (2018) A NILM dataset for cognitive meters based on conservative power
theory and pattern recognition techniques. J Control Autom Electr Syst 29.6(Dec 2018):742–
755. ISSN: 2195-3899. https://doi.org/10.1007/s40313-018-0417-4. https://doi.org/10.1007/
s40313-018-0417-4
113. de Melo e Abud L (2018) Modelos computacionais prognósticos de lesões traumáticas do
plexo braquial em adultos. Dissertacção de Mestrado. Instituto de Matemática e Estatística.
https://doi.org/10.11606/d.45.2018.tde-20082018-140641
114. de Araujo MA (2017) Metodologia baseada em medidas dispersas de tensão e árvores de
decisão para localizacção de faltas em sistemas de distribuicção modernos. PhD thesis. Escola
de Engenharia de São Carlos. https://doi.org/10.11606/t.18.2017.tde-20112017-103816
115. Akagi H (1996) New trends in active ﬁlters for power conditioning. In: IEEE transactions on
industry applications, vol 32.6, pp 1312–1322
116. Watanabe EH, Akagi H, Aredes M (2004) The p-q theory for active ﬁlter control: some
problems and solutions. In: Revista Controle & Automação, vol 15.1, pp 78–84
117. Alonso AMS et al (2022) CPT-Based control strategy for a two-phase three-wire PV inverter:
a multifunctional perspective and a comprehensive review. Brazilian J Power Electron
(SOBRAEP) 23.2:1–12. https://doi.org/10.18618/REP.2022.2.0052

Short Message Service System Applied
in Predictive Control of Inverters
Connected to the Electric Grid in Smart
Grids Environments
Angelo Lunardi, Alfeu J. Sguarezi Filho, Carlos E. Capovilla,
and Ivan R. S. Casella
Abstract This chapter presents a study of a system for remote control of active and
reactive power injected into the electrical grid based on the Short Message Service
(SMS) of a mobile telephone communication network. Wireless communication is
widely used in SG and SMS has become a viable option due to its simplicity and low
cost. There are numerous solutions for this application regarding the power control of
the inverter of a Renewable Energy System (RES), however, this chapter will focus
on the use of the Finite Control Set Model Predictive Control (FCS-MPC). In this
type of control, the mathematical model of the inverter connected to the electrical
grid is used so that it is possible to forecast the active and reactive power. In the
optimization process, the cost function selects the switch states so that the controller
reaches the desired active and reactive power references. These references are then
sent via SMS by the SG operator to the RES under control. The results obtained by
the proposed system were validated on an experimental bench.
1
Introduction
Considered as an evolution of the classical power grids, Smart Grids (SGs) employ
a modern bidirectional infrastructure for generation, transmission, distribution and
energy consumption to increase efﬁciency, reliability and security of the complete
power system. They are based on information and communication technologies, in
A. Lunardi (B) · A. J. S. Filho · C. E. Capovilla · I. R. S. Casella
Center for Engineering, Modeling and Applied Social Sciences (CECS), Federal University
of ABC (UFABC), Santo André, SP, Brazil
e-mail: angelo.lunardi@ufabc.edu.br
A. J. S. Filho
e-mail: alfeu.sguarezi@ufabc.edu.br
C. E. Capovilla
e-mail: carlos.capovilla@ufabc.edu.br
I. R. S. Casella
e-mail: ivan.casella@ufabc.edu.br
© The Author(s), under exclusive license to Springer Nature Switzerland AG 2024
A. J. Sguarezi Filho et al. (eds.), Smart Grids—Renewable Energy, Power Electronics,
Signal Processing and Communication Systems Applications, Green Energy
and Technology, https://doi.org/10.1007/978-3-031-37909-3_13
359

360
A. Lunardi et al.
addition to modern power elements, to carry out the monitoring and control tasks of
the power grid [1, 2].
In Fig. 1, a typical SG infrastructure is presented [3].
Among the existing communication technologies, wireless technologies have
stood out to integrate the communication infrastructure of SGs due to their high reli-
ability, high ﬂexibility, low cost, and easy installation and maintenance. However,
the use of wireless technologies brings new challenges that require investigations to
assess their performance and operational viability [4–6].
Considering the economic and technical aspects, including the service cover-
age area, the use of the Short Message Service (SMS) of the Second Generation
(2G) Global System for Mobile Communication (GSM) standard can be an com-
pelling option for control applications in SGs. As an interesting example, the SMS
can remotely control thousands of Plug-in Electric Vehicle (PEV) chargers using
the communication infrastructure of SGs [7]. In fact, a SG can employ the SMS
to increase the performance of the power system, considering the appropriate time
intervals for loading or unloading each PEV of the system [8]. On the other hand,
when power is insufﬁcient for current demand, a Smart Load Management (SLM)
system can meet the customer’s emergency demands as shown in [9]. As an advan-
tage, the SLM system allows the control and conﬁguration of loads through SMS
without the need for hardware or software modiﬁcations [10, 11].
Fig. 1 A typical SG infrastructure

Short Message Service System Applied in Predictive Control …
361
Fig. 2 Renewable energy grid with wireless control for SG applications
Advances in power electronics inverters have also contributed to the power sys-
tem’s efﬁciency and robustness, which permits the link between renewable energy
systems (RES) and the electrical grid [12]. The three-phase power converter is an
ordinary solution that injects active and reactive power from the RES and the elec-
trical grid. In this context, closed-loop control is required in this type of application
[13, 14].
Regarding control, a technique that has aroused great interest recently is the Finite
Control Set Model Predictive Control (FCS-MPC) [15]. This technique is designed
considering future actions according to the plant model, and the minimized cost
function selects the state of the converter in which the output reaches the desired
references. FCS-MPC can be employed in inverters, which are responsible for con-
verting electrical energy produced by photovoltaic modules or wind turbines to the
power grid [16]. For instance, the robust FCS-MPC for rotor current control of DFIG
is presented in [17].
In this context, this chapter’s main objective is to analyze the operation of a three-
phase inverter connected to the grid controlled by FCS-MPC in the scenario of an
SG. Control system power references are sent remotely from the SG operation center
to the RES by SMS over a realistic GSM communication network. Figure 2 shows
the complete proposed FCS-MPC wireless control system.
2
Grid Connected Inverter and Direct Power Predictive
Control
2.1
Stationary Coordinate System
The equations described in the previous section consider the grid connected to a
three-phase source by only three wires, without connection to the neutral point of
the grid. This connection makes the three phases linearly dependent since:
ua + ub + uc = 0
(1)

362
A. Lunardi et al.
In this way, it is possible to describe the three-phase system from two linearly
independent vectors. A common way of describing the system is using the Clarke
transform, or αβ0 transform [18]. This coordinate system has two perpendicular
vectors that can be easily manipulated as a complex number with α being the real
axis and β being the imaginary axis.
Mathematically, the transformation is [19]:
aαβ = 2
3(ua + k.ub + k2.uc)
(2)
k = e j2π/3 = −1
2 + j
√
3
2
(3)
k2 = e j4π/3 = −1
2 −j
√
3
2
(4)
where k represents spatial displacement by 120◦for phase b and c. This transfor-
mation can be performed for voltages, currents, and ﬂuxes, converting the three-
phase system to the stationary coordinate system. Matrix-wise, the Clarke transform
is [20]:
⎡
⎣
uα
uβ
u0
⎤
⎦= 1
3
⎡
⎣
2 −1 −1
0
3
√
3
3
√
3
1 1
1
⎤
⎦.
⎡
⎣
ua
ub
uc
⎤
⎦
(5)
2.2
The Mathematical Model of the Inverter Connected
to the Power Grid
The grid-connected converter is modeled according to the ﬁlter between the inverter
and the grid. It can control the active and reactive powers supplied to the grid, with
the implementation of control strategies such as Voltage Oriented Control (VOC) or
predictive control, among others. For this, it is necessary to use the model in steady
state, according to Eqs.(6), (7) and (8) [19].
vinv,a = Rgig,a + Lg
dig,a
dt
+ vg,a
(6)
vinv,b = Rgig,b + Lg
dig,b
dt
+ vg,b
(7)
vinv,c = Rgig,c + Lg
dig,c
dt
+ vg,c
(8)

Short Message Service System Applied in Predictive Control …
363
where, vinv is the inverter voltage vector, ig is the grid current vector, vg the grid
voltage vector. Rg and Lg are the resistance and inductance of the grid ﬁlter.
2.3
Stationary frame Model of the Inverter Connected
to the Power Grid
The inverter connected to the grid was modeled using a source with variable voltage
and frequency, ﬁlter and grid. In this work, the inductive ﬁlter was applied to the
connection between the inverter and the voltage source. The model is presented in
the Eq.(9). In this way, the power ﬂow analysis becomes possible [21].
vinv,αβ = Rgig,αβ + Lg
dig,αβ
dt
+ vg,αβ
(9)
Equation (9) can be decomposed in two components as (10) and (11):
vinv,α = Rgig,α + Lg
dig,α
dt
+ vg,α
(10)
vinv,β = Rgig,β + Lg
dig,β
dt
+ vg,β
(11)
where vg,αβ and vinv,αβ expresses the voltage vectors of the power grid and the
inverter, respectively. ig,αβ represents the current vector of the grid, Rg and Lg express
the resistance and the inductance of the inductive ﬁlter, respectively [22].
The active (P) and reactive (Q) power can be represented as:
P = 3
2ℜe[vg · i∗
g]
(12)
Q = 3
2ℑm[vg · i∗
g]
(13)
The vector components of voltage and current can be represented by the compo-
nents α and β. After performing the mathematical product and separating the real
and imaginary portions, it obtained the following equations that express the active
and reactive powers.
P = 3
2[vg,αig,α + vg,βig,β]
(14)
Q = 3
2[vg,βig,α −vg,αig,β]
(15)

364
A. Lunardi et al.
2.4
FCS-MPC
FCS-MPC considers the predicted behavior of the system and the minimization of
the cost function [15] to select the optimal state of the inverter. In this application,
its objective is to directly control the elements of the apparent power (S = P + j Q)
injected into the electrical grid. Therefore, the controller, based on the prediction of
powers and references sent using the SMS interface by the SG operator, will select
one of the vectors presented in Table 1 so that the powers are injected according to
the references [23].
Figure 3 shows a block diagram of the inverter connected to the grid with FCS-
MPC, which summarizes the proposal.
The vector form for the prediction of the current vector is presented in (16):
ip
g,αβ(k + 1) =

1 −Ts Rg
Lg

ig,αβ(k) + Ts
Lg
(v1( j) −vg,αβ(k)),
(16)
Table 1 Switching states and voltage vectors of the inverter
Sa
Sb
Sc
Vector voltage vinv( j)
0
0
0
vinv(1) = 0
1
0
0
vinv(2) = 2
3 Vdc
1
1
0
vinv(3) = 1
3 Vdc + j
√
3
3 Vdc
0
1
0
vinv(4) = −1
3 Vdc + j
√
3
3 Vdc
0
1
1
vinv(5) = −2
3 Vdc
0
0
1
vinv(6) = −1
3 Vdc −j
√
3
3 Vdc
1
0
1
vinv(7) = 1
3 Vdc −j
√
3
3 Vdc
1
1
1
vinv(8) = 0
Fig. 3 Finite control set diagram connected to the grid

Short Message Service System Applied in Predictive Control …
365
and its components:
i p
g,α(k + 1) =

1 −Ts Rg
Lg

ig,α(k) + Ts
Lg
(v1( j) −vg,α(k));
(17)
i p
g,β(k + 1) =

1 −Ts Rg
Lg

ig,β(k) + Ts
Lg
(v1( j) −vg,β(k)).
(18)
To predict the apparent power components it is ﬁrst necessary predict the currents
injected into the electrical grid using the Eqs.(17) and (18) is employed for this
task. The mentioned equation can be computed from the discrete representation of
Eqs.(10) and (11) as per Euler method’s.
Where: T s represents the sampling time. The prediction of apparent power ele-
ments P and Q is made after the current prediction, and it can be represented as
follows:
P p(k + 1) = 3
2[vg,α(k + 1)i p
g,α(k + 1) + vg,β(k + 1)i p
g,β(k + 1)]
(19)
Q p(k + 1) = 3
2[vg,β(k + 1)i p
g,α(k + 1) −vg,α(k + 1)i p
g,β(k + 1)]
(20)
For a short sampling time, vg(k + 1) ≈vg(k) can be considered. Using the pre-
dicted power values to minimize cost function is presented in Eq.(21).
g = |PRef −P p(k + 1)| + |Q Ref −Q p(k + 1)|
(21)
PRef and Q Ref are already demodulated references received via SMS by the
control center, unlike P∗
Ref and Q∗
Ref which are the signals sent by the control center.
Thus, the vectors presented in Table 1, which obtain the lowest value of g, are
chosen and applied. Figure 4 shows a ﬂowchart that explains how the algorithm
works.
Then a pseudo-code Algorithm1 is presented to demonstrate the algorithm for
implementing the FCS controller. This code makes it possible to understand the
sequence structure of the operations necessary for the controller to work correctly.
3
Mobile and SMS Communication Infrastructure
GSM is a 2G mobile telephony standard widely used around the world. Although
mobile technologies are currently in the Fourth Generation (4G)/Fifth Generation
(5G) [24, 25], GSM is still very attractive for low-rate applications (e.g. smart homes,
credit card machines) due to its low cost and wide range [26, 27].

366
A. Lunardi et al.
Fig. 4 Flowchart for direct
predictive power control
GSM employs Gaussian Minimum Shift Keying (GMSK) modulation and a com-
bination of Frequency Division Multiple Access (FDMA) and Time Division Mul-
tiple Access (TDMA) to provide service to network users. Each GSM frequency
channel occupies a 200 kHz frequency band and is divided into 8 time slots. Each
user’s voice, data or SMS information is transmitted or received in speciﬁc time slots
[10, 28].
To increase the robustness of the system to the degrading effects of the wireless
communication channel and to guarantee the integrity of the transmitted information,
a Forward Error Correction (FEC) system based on Convolutional Coding (CONV)
is employed [28]. CONV has an excellent relationship between error correction
capability and encoding and decoding complexity [29–31].
The proposed system used to remotely send active (P∗
Ref ) and reactive (Q∗
Ref )
power references is shown in Fig.2. The references are transmitted by SMS messages

Short Message Service System Applied in Predictive Control …
367
while MPC - FCS active do
The system variables as current, reactive and active power are measured
gop = ∞
for
j = 0 : 7 do
v( j) = Switch States of Vdc % Possible states of the converter
ip
g,α(k + 1) =

1 −Ts Rg
Lg

ig,α(k) + Ts
Lg
(v1( j) −vg,α(k)) % System prediction of the
state j for the current
ip
g,β(k + 1) =

1 −Ts Rg
Lg

ig,β(k) + Ts
Lg
(v1( j) −vg,β(k)) % System prediction of the
state j for the current
P p(k + 1) = 3
2[vg,α(k)i p
g,α(k + 1) + vg,β(k)i p
g,β(k + 1)] % Active power prediction
Q p(k + 1) = 3
2[vg,β(k)i p
g,α(k + 1) −vg,α(k)i p
g,β(k + 1)] % Reactive power prediction
g( j) = |PRef −P p(k + 1)| + |Q Ref −Q p(k + 1)| % Cost function calculation
if g( j) < gop then
gop = g( j)
jop = j % Store the state with minor cost function
end if
if j = 7 then
Apply v( jop)
Start again
Else go to for loop again
end if
end for
end while
Algorithm 1: MPC - FCS algorithm
from the SG operator to the RES. Each message contains up to 160 7-bit encoded
characters and the transmission of the messages is performed on the Stand-alone
Dedicated Control Channel (SDCCH). This channel ensures reliable delivery of
power references information to the RES.
4
Analysis of Experimental Results
Predictive control of the inverter for application in SG was implemented using a
digital signal processor from Texas Instruments TMS320F28335, using electronic
boards built in the laboratory for signal conditioning. The inverter used is a three-
phase Semikron inverter with six IGBT switches, with the system data are shown in
Table 2.
The power reference messages are transmitted by a SMS system developed under
the OpenBTS project, which uses the GNU Radio software (version 3.7.10.1) [32,
33], to create a functional GSM network, as illustrated in Fig.5.

368
A. Lunardi et al.
Table 2 Parameters of grid
Parameters
Value
Unit
Prated
3000
[Wh]
VRMS
220
[V]
Lg
22
[mH]
C
2.4
[mF]
f o
≈16
[kHz]
Fig. 5 Communication
system diagram
The GNU Radio software runs on a computer with Ubuntu operating system and
connected to a BladeRF x115 Software Deﬁned Radio (SDR) card, as shown in
Fig.5. To address legal issues, the OpenBTS GSM network was conﬁgured to use
the Absolute Radio Frequency Channel Number (ARFCN) 975 (downlink frequency
of 925.2 MHz), a valid GSM frequency in the ISM (Instrumentation, Scientiﬁc and
Medical) band.
The complete system diagram is shown in Fig.6 and an image of the experimental
bench built for system analysis is shown in Fig.7.
This infrastructure is placed in the control center of the grid operator. There the
power references P∗
ref and Q∗
ref are sent through SMS messages to the controller
responsible for generators if transmitted the P∗
ref or Q∗
ref references, it is informed
at the beginning of the messages.
Each SMS message consists of eight symbols, each symbol containing eight bits,
altogether 256 possible different levels, where each level represents the power mag-
nitudes in a 100 ms time interval. Figure8 shows a complete SMS structure.
Meanwhile,ascriptrunningonOpenBTS(opensourceproject)version4.0creates
SMS messages which contain the references of the active and reactive powers [10].
A sleep command is executed each time a message is sent, which results in a guard
interval between messages. It can be concluded that the efﬁciency of this system is
once a new message is sent only when the power value change, making the need for
continuous transmissions unnecessary.

Short Message Service System Applied in Predictive Control …
369
Fig. 6 Complete wireless control system diagram
Differently from the transmission process, the receiving system is located in the
RES connected to the electrical grid. The receiver system uses a PIC18F45K22
microcontroller development board, which is connected to a Teli G865QUAD GSM
module with a cellular service operator card. During the reception process, the GSM
signal is demodulated and decoded to recovery the transmitted power reference infor-
mation.
Three tests were applied to evaluate the proposed system presented in the ﬂowing
paragraphs.
First test: a step input signal sent by the wireless reference channel of active power
from 0 to 500W which is repeated every 400ms and the reactive power constant at
zero.
The test results are presented in Fig.9, where it can be observed that the predictive
controller achieves the references, and no peaks were associated with errors in the
wireless channel. Figure 10 refers to the dynamic response of the grid voltage and
current during this test. It was also observed that the current increases when the step
occurs.
Second test: As shown in Fig.11, referrals were sent from the wireless channel
containing a −300 to 300 var reactive power reference and maintaining the active
power at 500W. The predictive controller reached the references, and the result in

370
A. Lunardi et al.
Fig. 7 Experimental bench
for analysis of the proposed
wireless control system
Fig. 8 Structure of the SMS
message

Short Message Service System Applied in Predictive Control …
371
Fig. 9 Experimental result of the response to the active power step
Fig. 10 Experimental result showing the current response to the active power step
Fig.12 demonstrated the voltage and current behavior of the grid during the reactive
transient along the test. Therefore, the current changes its phase.
Three test: Fig.13 present an additional test in which it was applied a constant
0 var reactive power reference, while the active power reference varied in 205W,
506W and 830W, respectively. Again, the controller reached the reference, and the
signal conditioning at the wireless channel output justiﬁes the signal curves.
5
Conclusion
An experimental analysis of control systems for power generation systems was pre-
sented in this chapter. It was based on obtaining the references of the grid operator
through a GSM network (a standard wireless communication network). As observed
in the test results, the FCS-MPC matches the expectations of the references received,

372
A. Lunardi et al.
PRef
P
00W
300var
Q
QRef
-300var
Fig. 11 Experimental result of the response to the reactive power step
Fig. 12 Experimental result showing the current response to the reactive power step
830W
506W
245W
00var
PRef
P
Q
QRef
Fig. 13 Control response to a signal proﬁle for active power

Short Message Service System Applied in Predictive Control …
373
and the performance of the control system was not affected by the noise introduced by
the wireless communication system. the proposed system is validated by the results
which are in accordance with control without wireless reference transmissions.
The reliability and ﬂexibility offer an exciting solution in power generation appli-
cations. The implementation offers a signiﬁcantly reduced cost regarding imple-
menting and operating a communication system for the smart-grid concept in power
generation systems. Moreover, the proposed conﬁguration can be used as a com-
munication link for a more traditional implementation, implementing redundancy,
aiming to improve system security.
For Smart Grid systems, security and reliability in the signal transmission are
essential for the system to work efﬁciently and with quality so that the energy deliv-
ered to the consumer is, in addition to being friendly to the environment, supplying
energy for charging the requested energy demand.
As an improvement to the system presented in the chapter, two points can be
investigated an algorithm for a ﬁxed switching frequency and a longer prediction
horizon to optimize power converters’ operation and a new wireless communication
protocol for a comparative protocols analysis.
References
1. Fang X et al (2011) Smart grid-the new and improved power grid: a survey. In: IEEE commu-
nications surveys and tutorials, vol 14.4, pp 944–980
2. Lunardi A et al (2022) Grid-Connected power converters: an overview of control strategies for
renewable energy. In: Energies, vol 15.11, p 4151
3. Panda DK, Das S (2021) Smart grid architecture model for control, optimization and data
analytics of future power networks with more renewable energy. J Clean Prod 301:126877
4. Teymourzadeh R et al (2013) Smart GSM based home automation system. In: IEEE conference
on systems, process and control (ICSPC). IEEE, pp 306–309
5. Gomez LAG et al (2020) Wind-DFIG wireless controlled using EGPRS standard applied to
the ancillary services in a smart grid environment. In: Electric power systems research, vol
189, p 106807. ISSN: 0378-7796. https://doi.org/10.1016/j.epsr.2020.106807. https://www.
sciencedirect.com/science/article/pii/S0378779620306106
6. de Oliveira AL et al (2021) Co-simulation of an SRG wind turbine control and GPRS/EGPRS
wireless standards in smart grids. IEEE/CAA J Automatica Sinica 8.3:656–663. https://doi.
org/10.1109/JAS.2021.1003883
7. Hochgraf C, Tripathi R, Herzberg S (2010) Smart grid charger for electric vehicles using
existing cellular networks and SMS text messages. In: 2010 ﬁrst IEEE international conference
on smart grid communications. IEEE, pp 167–172
8. Tauze ZSF et al (2022) IoT and GSM based smart grid controlling and monitoring system. In:
International conference for advancement in technology (ICONAT). IEEE, pp 1–7
9. Billah M, Islam MR, Sultan Mahmud Rana GM et al (2015) Design and construction of smart
load management system: an effective approach to manage consumer loads during power
shortage. In: 2015 international conference on electrical engineering and information commu-
nication technology (ICEEICT). IEEE, pp 1–4
10. Gomez LAG et al (2019) Analysis of a control system for DFIG wind generators based on the
transmission of power references through a GSM wireless network: a smart grid experimental
approach. In: Energies, vol 12.2, p 241

374
A. Lunardi et al.
11. Jabandži´c E, Konji´c T, Tomaševi´c D (2021) Load management framework in smart grids: a
meta-analysis and review. In: IETE technical review, pp 1–19
12. Özkan Z, Hava AM (2014) Three-phase inverter topologies for gridconnected photovoltaic
systems. In: International power electronics conference (IPEC-Hiroshima 2014-ECCE ASIA).
IEEE, pp 498–505
13. Hudson RM et al (2002) Design considerations for three-phase grid connected photovoltaic
inverters. In: Conference record of the twenty-ninth IEEE photovoltaic specialists conference.
IEEE, pp 1396–1401
14. Angelo L et al (2022) Repetitive predictive control for current control of grid-connected inverter
under distorted voltage conditions. IEEE Access 10:16931–16941
15. Rodriguez J et al (2007) Predictive current control of a voltage source inverter. In: IEEE
transactions on industrial electronics, vol 54.1, pp 495–503
16. Lunardi AS et al (2019) A wireless coded predictive direct power control for renewable
energy sources in smart grid environment. Int J Electr Power Energy Syst 112:319–325.
ISSN: 0142-0615. https://doi.org/10.1016/j.ijepes.2019.05.004. https://www.sciencedirect.
com/science/article/pii/S014206151832324X
17. Filho AJS et al (2018) A robust ﬁnite control set applied to the DFIG power control. IEEE J
Emerg Sel Top Power Electron 6.4:1692–1698
18. Abad G et al (2011) Doubly fed induction machine: modeling and control for wind energy
generation. Wiley
19. Yazdani A, Iravani R (2010) Voltage-sourced converters in power systems: modeling, control,
and applications. Wiley
20. Linder A et al (2010) Model-based predictive control of electric drives. Cuvillier Verlag
21. Rodriguez J, Cortes P (2012) Predictive control of power converters and electrical drives. Vol.
40. Wiley
22. Lunardi A et al (2022) Robust predictive control with three-vector modulation connected to
the power grid. In: Energies, vol 15.6, p 1979
23. Filho AJS (2022) Model predictive control for doubly-fed induction generators and three-phase
power converters, vol 1. Elsevier
24. Agiwal M, Roy A, Saxena N (2016) Next generation 5G wireless networks: a comprehensive
survey. IEEE Commun Surveys Tutor 18(3):1617–1655
25. Chettri L, Bera R (2020) A comprehensive survey on internet of things (IoT) toward 5G wireless
systems. IEEE Internet Things J 7(1):16–32
26. Giménez F, Zerbini C, Riva G (2019) Extending sms service coverage in rural areas by using
lora communication technology. IEEE Latin Am Trans 18(02):214–222
27. Kombo OH, Kumaran S, Bovim A (2021) Design and application of a low-cost, low-power,
LoRa-GSM, IoT enabled system for monitoring of groundwater resources with energy har-
vesting integration. IEEE Access 9:128417–128433
28. Lin X et al (2014) An overview of 3GPP device-to-device proximity services. In: IEEE com-
munications magazine, vol 52.4, pp 40–48
29. Kaiser M et al (2009) A comparison of decoding latency for block and convolutional codes. In:
Proceedings of the 10th international symposium on communication theory and applications
(ISCTA’09), Ambleside, UK
30. Lin S, Costello DJ (2004) Error control coding, vol 2. 4. Prentice Hall
31. Proakis JG, Manolakis DG (2004) In: Digital signal processing. PHI Publication, New Delhi,
India
32. GNU Radio Companion. https://wiki.gnuradio.org/
33. Natalizio E et al (2010) The practical experience of implementing a GSM BTS through open
software/hardware.In:20103rdinternationalsymposiumonappliedsciencesinbiomedicaland
communication technologies (ISABEL 2010). IEEE, pp 1–5. https://doi.org/10.1109/ISABEL.
2010.5702870

Wireless Sensor Network
for Environmental Monitoring in Smart
Cities
Bruno Sousa Dias, Cicero Matheus da Silva Lacerda,
Nailson Martins Dantas Landim, Humberto Xavier Araujo,
and Starley do Nascimento Lobo
Abstract This chapter presents a wireless sensor network as a solution for environ-
ment monitoring in the context of smart grids in smart cities that combines the usage
of two IoT solutions, one for measuring toxic gases, temperature, humidity, UV index
and ﬁre presence. and the other for monitoring the garbage collection by tracking the
trucks and street sweepers carts movements to guarantee its coverage throughout the
city. The two solutions shown effectiveness on obtaining this information dealing
with internet connection oscillations, making the data available though a web appli-
cation where the data can be exported. The tests not only proven its effectiveness as
it shows a direction on a combined environmental monitoring that can address ﬁre
and environmental hazards using technology.
1
Introduction
In smart grids systems, IoT (Internet of Things) devices with embedded sensors
play a key role on electrical grids monitoring, and there are many other applications
that can provide beneﬁts for helping to maintain those systems, and one of these is
environment monitoring on atmosphere gases, presence of smoke and toxic gases,
B. S. Dias · C. M. da Silva Lacerda · N. M. D. Landim · H. X. Araujo (B) ·
S. do Nascimento Lobo
UFT, Palmas, TO, Brazil
e-mail: hxaraujo@mail.uft.edu.br
B. S. Dias
e-mail: bsdias@mail.uft.edu.br
C. M. da Silva Lacerda
e-mail: ciceromatheus@mail.uft.edu.br
N. M. D. Landim
e-mail: mac@mail.uft.edu.br
S. do Nascimento Lobo
e-mail: starley.lobo@mail.uft.edu.br
© The Author(s), under exclusive license to Springer Nature Switzerland AG 2024
A. J. Sguarezi Filho et al. (eds.), Smart Grids—Renewable Energy, Power Electronics,
Signal Processing and Communication Systems Applications, Green Energy
and Technology, https://doi.org/10.1007/978-3-031-37909-3_14
375

376
B. S. Dias et al.
temperature and humidity. With the mentioned monitoring is possible to detect ﬁre
in these areas and take security measures before the ﬁre reaches the electrical grid.
The smart grid can beneﬁt from data coming in other areas of the city, making
part of a smart city ecosystem, that leads to an increase on life quality and with a
better usage of limited natural resources [1] this technological approach comes from
growth and expansion of the internet that allows the creation of robust solutions to
contemporary problems [2].
It’s in this context that the concept of smart cities emerges, that is: Cities that
implements internet-based systems to maximize the population satisfaction, with the
use of protocols and equipment to make it possible [3]. Here the focus is on the
environmental scenario, where it is possible to have implementations both in the
scope of monitoring and pollution reduction [4].
This work deals with environment monitoring considering the following variables:
temperature, humidity, ultraviolet radiation, presence of ﬁres, the concentration of
toxic gases and smoke. And given this context it includes the monitoring of solid
waste collection, with the collection of geolocation data of garbage responsible,
making use of GPS (Global Positioning System) technology.
On smart cities, location-based services working together with environment mon-
itoring applied to the management of garbage collection routes, can have a funda-
mental role in the modernization of the public service leading not only to their
improvement but ultimately impacting on social indicators.
In Brazil, garbage management is the responsibility of municipal authorities.
They must devise strategies to handle garbage disposal and educate its citizen and
technicians to perform this essential task [5]. The development of tools that assist
municipalauthoritiesoncitymonitoringisimportantforthecontinuousimprovement
of provided services.
This work proposes to an environmental monitoring platform for smart cities;
with collection of environmental data, including the tracking of garbage collection
vehicles, with a dedicated hardware connected to the internet, called cell, which can
be present throughout the city, providing information on environmental conditions
and waste disposal in real-time.
Restricting geographically to Brazil, there is a plan to implement smart cities
through the Digital Cities program, instituted in 2011 [6, 7].
2
Embedded System
In this work, we will present two monitoring cell devices, one for collecting data
related to environmental quantities, using the following sensors: DHT11 for temper-
ature and humidity, Guva S12SD for ultraviolet radiation, MQ-135 for smoke and
toxic gases and an infrared sensor for ﬁre; The other cell will act monitoring solid
waste collection by recording the route taken by its personnel, the Neo-6m GPS mod-
ule will be used to obtain the geodesical coordinates, and ﬁnally, with the SIM800L
2G mobile network module will provided the needed internet connectivity.

Wireless Sensor Network for Environmental Monitoring in Smart Cities
377
Fig. 1 ESP32 DevKit V1
development board
Each hardware prototype will be called a cell, where the environment cell will be
responsible for collecting and recording the data obtained through the sensors and
the tracking cell corresponds to the prototype used in the registration of the routes.
Given the scope of the project, the microcontroller used will be the ESP32. This
microcontroller was developed by Espressif Systems [8]. It’s designed for mobile
applications, portable electronics, and IoT. It has WiFi and Bluetooth connectivity
that are optimized for low power consumption during its operation [8].
To manufacture the prototypes, the ESP32 DevKit V1 development board will
be used, which comes equipped with needed built-in circuits for programming and
a micro-USB port as shown in Fig.1. These cells communicate with the server-side
web application through a RESTful API.
REST (Representational State Transfer) is an architectural model focused on
establishing restrictions on access to resources [9]. It is also worth noting another
differential of the REST model: there are no sessions to store data between r
The workﬂow on this architecture is the following: a cell intends to send the sensor
data to the application. First, there is an endpoint capable of dealing with the data
coming from the sensors. This has restrictions on how this data should be sent and
only accepts it if it complies with the restrictions.
Once the requirements are met, the cell will send the data to the resource locating
it through a URI, and the server will return a response and close the connection. If
the cell wants to use some other resource, it must request another connection to the
server. As these requests are stateless, it can deal with intermittent connectivity.
In Fig.2 is possible to see that an example of how communication takes place.
The cell sends a text that meets the criteria determined by the server-side appli-
cation, it issues response and closes the connection. Note that the text sent in the
example follows the JSON (JavaScript Object Notation) format, which is used to
group information into keys and their respective values.
A system whose architecture follows the REST standard is called RESTful [9].
Therefore, the server implements a RESTful architecture to receive the data. When a
set of resources is created to work in a speciﬁc context, it is called an API (Application

378
B. S. Dias et al.
Fig. 2 REST application example
Programming Interface) [9]. Therefore, the server contains an API to communicate
with the cell.
In order to provide more security for this application, the connection will be made
through a VPN (Virtual Private Network); that can be of these two types [10]: Client-
to-Site and Site-to-Site. In this work, the ﬁrst approach is used, which consists of a
VPN server where users connect to it using credentials [10]. When the connection is
established, that server becomes the new client gateway, where everything sent to it
is encrypted as detailed below.
In this work, StrongSwan is used, an Open-Source tool to serve VPNs. In accor-
dance with [11], for this, it is necessary to have the VPN certiﬁcate, a private key for
data encryption, and a range of private IPs to be assigned to clients that connect. As
StrongSwan has tools that make easy these steps, the detailing will not be done here.
With the connection established with the server, the data collected by the mon-
itoring cells are stored in a database, so it is important that periodic backups are
performed so that there is no loss of records.
The backup consists of maintaining data redundancy for later recovery in case of
loss of the original information, the backup procedures are usually done at night so
that the backup does not interfere with other business hours procedures [12]. In this
work, the open-source tool Bacula will be used. The ﬁrst step is to establish that the
storage will be done on the hard disk of the machine with Bacula installed. Once this
is done, the FileSet to be copied is the /var/opt/mssql directory inside the container,
which can be exposed to the outside world from a volume.
Regarding the frequency, incremental backups are performed on working days
and Saturdays. On Sundays, a differential backup takes place. On the ﬁrst Sunday of
each month, a full backup is made. Finally, it is worth mentioning that this process is
carried out during the period in dawn, so as not to signiﬁcantly impact the application
server.

Wireless Sensor Network for Environmental Monitoring in Smart Cities
379
3
Environmental Cell
The working logic of this cell is: it checks if there is any monitoring scheduled.
If it exists, it will take 20 readings from each sensor, calculate the average of each
measurement, and send it to the server so that it can process and store the information.
To build the prototype of this cell, the following components are used.
The DHT 11 temperature and humidity sensor can measure temperatures from
20◦to 60◦C and humidity from 5% to 95% [13]. The Guva S12SD outputs the UV
index (UVi). This index measures the intensity of ultraviolet radiation in an integer,
to signal the necessary precautions, as listed in the ranges below [14]:
• 1 and 2: No precautions.
• 3 to 7: Avoid prolonged exposure to the sun. Preferably use sunscreen and look
for shadows.
• Above 8: Avoid any exposure to the sun.
The MQ-135 sensor, manufactured by Hanwei Electronics, must be powered
with 5V [15] and its resistance varies according to the concentration of measured
gases. Considering that the ESP32 microcontroller works with 3.3V, it is necessary
to include a voltage divider circuit for reading in this case. For ﬁre detection, an
infrared sensor is used, which will emit a digital signal that is true if there is a ﬁre,
otherwise, it will be false.
All sensors presented are development versions, and sold with the needed circuitry
for communication, the remaining step is adding some pull-up resistors and voltage
dividers to calibrate the outputs. Figure3 illustrates the schematic, the thicker lines
are the +Vdc supply lines, and the dashed lines represent the connections of the
GND terminals. The thinnest, continuous lines are the data connections. Finally, the
resistors used are precision resistors with a resistance of 6.7 k . As it can be seen,
there are only three resistors: a pull-up resistor for the DHT 11 and the other two to
form a voltage divider for the MQ-135.
The ﬁrst tests with the prototype were carried out in closed and controlled places,
which had the presence of other reference sensors. The two points chosen were a
municipality in the state of Tocantins and the Federal University of Tocantins (UFT).
Figures4 and 5 illustrate the performed tests.
After this step, the cell was tested in an open-area site inside the UFT. Finally, the
performanceoftheequipmentwasmonitoredinthecity.Itisalsoworthnotingthatthe
reaction of the cell when disconnecting the connection to the network momentarily
was tested. Figure6 shows the debug messages for a cell.
All the collected data is sent to the server and can be accessed by a web application.
On the page, shown in Fig.7, there is a green button that allows the scheduling of
records, if necessary.

380
B. S. Dias et al.
Fig. 3 Cell schematic for environment, containing the microcontroller, sensors and resistors nec-
essary for the construction of the circuit
Fig. 4 Test carried out with the environmental cell at the Federal University of Tocantins
It is also possible to export measurement data to a CSV (Comma Separated Values)
ﬁle. For that, the Fig.8 shows the form to be ﬁlled out, that has the possibility of
choosing multiple environmental cells at once. Figure9, in turn, shows the generated
ﬁle.

Wireless Sensor Network for Environmental Monitoring in Smart Cities
381
Fig. 5 Test carried out with the environmental cell in a municipality in the state of Tocantins, Brazil
Fig. 6 Debug Monitor

382
B. S. Dias et al.
Fig. 7 User interaction page
Fig. 8 Form to export *.csv ﬁle
Fig. 9 Exported *.csv ﬁle, contains raw data of measured magnitudes and can be used for research
and analysis
As seen, the exported ﬁle has, in addition to the six measures, the following infor-
mation: name, address, latitude, longitude, and the time the reading was performed.
With this ﬁle, the user can whatever he needs, be it either a research or at a company.
3.1
Tracking Cell
This cell collects geodesical data through a GPS module, sending it to an application
to register the performed routes. It’s imperative to guarantee that the performed track
is registered, for this reason, the system has two communications possibilities, the

Wireless Sensor Network for Environmental Monitoring in Smart Cities
383
Fig. 10 Photovoltaic
module
primary is mobile network, and the secondary is through Wi-Fi. So, in a failure on
the primary channel, the data is logged to a memory card and once it reaches a known
network it uploads the logged data. With this data the authorities can check their daily
productivity and if the planned routes are effectively being performed to guarantee
that the population is being properly served.
Neo-6m GPS module is a low-cost easy to use option. It is an independent
and high-performance, capable of parallel searches, ﬁnding the GPS satellites
instantly [16]. The precision of the location is about 2,5 meters and it is limited
only to speeds of 500 m/s (1800 km/h–1120 miles/h) and its maximum operation
altitude is 50.000 meters [16]. As primary communication to the server, through a
mobile network connection; the SIM800L is a GSM/mobile network module, capa-
ble of performing phone calls and SMS (Short Message System) messages, it’s main
use is for Internet connectivity using mobile network.
For this application, the internal 4MB ESP32 memory is not enough, for this
reason it was added to 4GB SD memory card using the pins corresponding to the SPI
(Serial Peripheral Interface) of ESP32 to store the registries when mobile network
connection is not available.
To supply the needed power, an 8V and 4400mah battery was used to guarantee
long-lasting autonomy and to charge the battery, a small solar module was included,
with nominal voltage and power of 12V and 1.5W respectively (Fig.10). Whenever
exposed to sunlight, the system will generate its energy, and consequently, it will
reduce the need for human intervention in battery charging.
The system power management is performed by the microcontroller with the
circuit shown in Fig.11. Where the current ﬂow control and monitoring of the bat-
tery charge, is performed by the ESP32 itself through an ADC port which allows
improvements through updates of ﬁrmware.
This cell can receive power from an external 12V source. If the voltage at the solar
module terminals is close to 12V, a relay will be activated and the external source

384
B. S. Dias et al.
Fig. 11 Tracking cell charging control circuit
Fig. 12 Charging selection
with a 12V relay
will be disconnected from the voltage regulator, as shown in Fig.12. This allows the
battery to be primarily charged through its own sustainable generation. Both load
possibilities are connected to the LM7809 voltage regulator, which keeps the voltage
stabilized at 9V.
Figure13 shows the schematic, where all microcontroller connections with load
control circuit, SIM800L and Neo-6m modules and a memory card can be seen. In
addition, an I2C display was also added, which will show the latitude, longitude,
speed and battery level.
Considering that this cell will be in motion and the number of components present,
a printed circuit board was made, according to Fig.14.
The prototype in Fig.15 was assembled using a printed circuit board, where the
components were soldered and connected. For protection, it was used a sealed box,
as seen on Fig.16, with the solar cell being placed on its lid.
A web application was developed as shown in Fig.17, allowing users to access the
registered data. To clearly show the routes was used the Google Maps API. Google
Maps is a worldwide mapping service, where it is possible to visualize maps, satellite
images and even trafﬁc information. Using its API is possible to use this information
on third-part web pages [17].

Wireless Sensor Network for Environmental Monitoring in Smart Cities
385
Fig. 13 Schematic of the tracking cell, with load control circuit and other components
Fig. 14 Printed circuit
board design
4
Results
4.1
Environmental Cell Results
The ambient cell performed as expected during the tests, consistently sends the
readings to the application. When the internet connection was intentionally disrupted,
the cell was able to reconnect. Figure18 displays the information shown on the home
screen.
There are six graphs representing each of the six metrics: Temperature (Celsius
degrees), Humidity (percentage), UV radiation (UVi), concentration of smoke and
toxic gases (ppm) and ﬁre (percentage of occurrences in relation to the number of

386
B. S. Dias et al.
Fig. 15 Developed Prototype of tracking cell
Fig. 16 Developed
Prototype of tracking cell in
the sealed box

Wireless Sensor Network for Environmental Monitoring in Smart Cities
387
Fig. 17 Integrated Google Maps page
Fig. 18 Average values of all measurements
measurements). Finally, each graph has three bars, one for the average of daytime val-
ues (orange), another for nighttime values (dark blue) and the third one encompasses
the two shifts (green).
In the section, shown in Fig.19, there are three tabs available: Real Time, Time
Series,andMeanValues,respectively.Ineachtab,itispossibletoﬁndtheinformation
related to the selected cell.
In the ﬁrst tab, there are six graphs again, one for each magnitude. However,
this time, they are displayed in the form of speedometers and correspond to real-time

388
B. S. Dias et al.
Fig. 19 Real-time data per environmental cell
Fig. 20 Time series per cell
measurements, divided into two regions: a green one, indicating that the measurement
is below the alert threshold, and another red, indicating that the measured value is
alarming. for that cell concerning the magnitude. The black band only shows the
division between zones and is located precisely at the threshold location.
Moving forward through the tabs, Fig.20 shows the Time Series screen, which
plots measurements over a speciﬁc time range. Here it is also possible to choose both
the environmental cell and the quantity to be displayed.

Wireless Sensor Network for Environmental Monitoring in Smart Cities
389
Fig. 21 Average values per environmental cell
Thelast tab, AverageValues, shows theaverages of measurements of eachquantity
within the speciﬁed time range. Figure21 shows the graphics, which are like the ﬁrst
section of the application.
4.2
Tracking Cell Results
The tests took place in Paraiso do Tocantins—TO, Brazil. These tests involves veri-
fying the data sent to the server, recording collected data in the database, backing it
up, operating the web page, and integrating with Google Maps.
The ﬁrst test took place with ﬁxed location, since there was no displacement, it
is possible to observe that although the obtained points are not completely accurate,
the variation is small, as can be seen, in Fig.22.
The next test was carried out on movement, sending the location points in real
time to the server, with the connection provided by the SIM800L module, using a
standard SIM card, with the route shown in Fig.23. When returning to the origin
point, between the Pouso Alegre and Jardim America sectors, the same avenue as
the starting route was traveled. In Fig.24, points are marked in both directions of 23
de Outubro Avenue. With this, the routes taken for the collection of solid waste are
updated in real-time, making it possible to see which areas of the city have already
been served on the day and if the itinerary is being fulﬁlled as expected.
Note that it is possible to identify the route traveled by the obtained location
points, however, in this case, the density of markings on the map can be improved
with the use of a more modern mobile network module than the one used in this
prototype.

390
B. S. Dias et al.
Fig. 22 Fixed location test—map view
Fig. 23 On Movement Test (Mobile Network connection)—map view
One test was performed without Internet connectivity, the points acquired were
stored on the memory card, and each recorded location point generates a text ﬁle with
latitude, longitude, speed, date, and time based on the data obtained by the Neo-6m
module.
At each loop the microcontroller checks if the internet connection with a mobile
network or Wi-Fi is available, as soon as the connection is re-established, all the
backup data will be sent to the server. This step is of paramount importance, as it
prevents the routes taken from being lost due to a lack of internet connection.
The same route taken in the previous tests was done but, the SIM card was removed
from the SIM800L module, so that, there was no possibility of reconnection during

Wireless Sensor Network for Environmental Monitoring in Smart Cities
391
Fig. 24 Location points on both sides of the avenue—map view
Fig. 25 On Movement Test (Backup)—map view
the test. Upon returning to the point of origin, the microcontroller identiﬁed a Wi-Fi
network already registered and started sending data to the server automatically.
With the location records plotted on the map in Fig.25, the density of points
obtained is considerably higher compared to those obtained with the real-time update
by mobile network.
With this test, the Backup system for the tracking cell was validated. As occurred
in the test route with the mobile network, in this test, 23 de Outubro avenue was also
traveled back and forth, the points obtained in both directions are shown in Fig.26.

392
B. S. Dias et al.
Fig. 26 Location points on both sides of the avenue in the backup test
Fig. 27 On Movement Test (Wi-Fi)—map view
In another test on movement and real-time update, the connection was provided
by a 4G mobile phone using a Wi-Fi tether, in this way, it is possible to compare the
results obtained in real-time with the mobile network provided using the SIM800L
module. The route taken is shown in Fig.27.
5
Conclusion
An automated real-time environmental monitoring is paramount for smart grids,
especially in the context of smart cities, where the correct monitoring can prevent
problems and give administrators solid information to make the city better managed
and have a positive impact on its citizens lives.

Wireless Sensor Network for Environmental Monitoring in Smart Cities
393
The system proposes a combined solution that effectively monitor the city envi-
ronment through a sensor network that collect data that’s key for monitor and prevent
ﬁre near energy networks, through an IoT device and a RESTful web application. It
also includes another IoT device that monitors garbage collection, which is key to
city administration helping to maintain its environment.
These connected sensors, called cells, as veriﬁed on performed tests were able
to collect this real-world physical data and through the applications make it easily
available for both administrators and companies, being able to export data that can
be used for analysis or by other applications.
The environmental cell shown on performed tests the ability to do this collection,
with robustness especially on connection interruption, having a dedicated web dash-
board, and a time series data collection. once deployed in scale it can serve to other
uses besides the original proposition, and with the given time series collection can
prove valuable for preventing damage on smart grids as well as other uses besides
the scope of this project.
In the tracking cell, the performed tests shown that the garbage trucks can be cor-
rectly accurately tracked, with intermittent connection, presenting a backup solution
that guarantees that once the connection resumes it send the visited coordinates to the
application. In this device it was observed that the latency on the network connection
using the SIM800L module can affect the coordinates density as the requests to the
API can take longer. The tests that were also performed without connection, relying
on the backup or over Wi-Fi showed a bigger coordinates density.
The tests were performed in a car, and the latency between these different con-
nections could be noticed. Considering that street sweepers and garbage collection
trucks move at low speed, it doesn’t have an impact on the overall use of this solution.
In conclusion, real-time monitoring of environmental variables has the potential to
improve energy security and management in smart grids. Its integration into the IoT
ecosystem of a smart city can provide valuable data for controlling and managing the
electrical network. For example, when the temperature of the entire city or speciﬁc
areas is identiﬁed as elevated, it can serve as an alert for increased consumption due
to the use of cooling systems such as air conditioning.
References
1. Founoun A, Hayar A (2018) Evaluation of the concept of the smart city through local regulation
and the importance of local initiative. In: 2018 IEEE international smart cities conference
(ISC2). IEEE
2. Mora OB et al (2018) A use case in cybersecurity based in blockchain to deal with the security
and privacy of citizens and smart cities cyberinfrastructures. In: 2018 IEEE international smart
cities conference (ISC2). IEEE
3. Anthopoulos LG (2017) Understanding smart cities: a tool for smart government or an industrial
trick?. Springer
4. Hayar A, Betis G (2017) Frugal social sustainable collaborative smart city casablanca paving
the way towards building new concept for “future smart cities by and for all”. In: 2017 sensors
networks smart and emerging technologies (SENSET). IEEE

394
B. S. Dias et al.
5. CEMPRE/IPT (2018) Lixo municipal: manual de gerenciamento integrado. CEMPRE
6. Diário Oﬁcial da União (2011) Portaria n 376. Imprensa Nacional
7. Diário Oﬁcial da União (2012) Portaria n 186. Imprensa Nacional
8. Espressif System (2019) “ESP32” Series datasheet
9. Resca S (2019) Hands-On RESTful Web Services with ASP.NET Core 3: Design production-
ready, testable, and ﬂexible RESTful APIs for web applications and microservices. Packt
Publishing
10. Brito SHB (2017) Serviços de Rede em Servidores Linux. Novatec
11. Digital Ocean (2019) Como Conﬁgurar um sevidor VPN IKEv2 com StrongSwan no Ubuntu
18.04
12. Faria H (2017) Bacula: o software livre de backup. Brasport
13. Aosong (2021) DHT11 SIP packaged temperature and humidity sensor
14. João Correia dos Santos (2010) Radiação Ultravioleta: Estudo Sobre Índices de Radi-
ação...[S.i.]” MA thesis. UESC
15. Hanwei Electronics DHT11 SIP Packaged Temperature and Humidity Sensor
16. U-BLOX (2011) NEO-6 u-blox 6 GPS Modules: Data Sheet
17. LuthﬁA et al (2019) Google maps API implementation on IOT platform for tracking an object
using GPS. In: 2019 IEEE Asia paciﬁc conference on wireless and mobile (APWiMob). IEEE

