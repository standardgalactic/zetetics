
/
Applied
Finite Element Analysis
for Engineers
FRANK L. STASA
Florida Institute of Technology
CBS Publishing -Japan Ltd.
New York
Chicago
San Francisco
Philadelphia
Montreal
Toronto
London
Sydney
Tokyo
Mexico City
Rio de Janeiro
Madrid

To Frank W. and Lena C. Stasa,
Ann R. Holt,
and to the memory of
John A. Holt
-J/--t
'JCf 7l
'~~5:r2
r9~5 .
HRW
Series in
Mechanical
Engineering
L. S. Fletcher, Series Editor
F. L. Stasa
B. J. Torby
APPLIED FINITE ELEMENT ANALYSIS FOR ENGINEERS
ADVANCED DYNAMICS FOR ENGINEERS
Copyright © 1985 CBS Publishing
All rights reserved
Address correspondence to
383 Madison Avenue, New York. NY 10017
Library of Congress Cataloging in Publication Data
Stasa, Frank L.
.
Applied finite eledJent analysis for engineers.
(HRW series in mechanicalengineering)
Includes bibliographies and index.
I. Finite element method.
I. Title.
II. Series.
TA347.F5Sn
1985
.
620'.001'515353
85-742
ISBN 0'{)3'-%2737.{) (US';~llege Edition)
ISBN 0'{)3·910744·2 (CBS International Edition)
This International Edition is not for sale in the United
States of America. its dependencies or Canada.
Printed in Japan. 1986
5678
038
987654321
CBS COLLEGE PUBLISHING
The Dryden Press
Saunders College Publishing

Preface
Written for senior-year undergraduates and first-year graduate students with solid back-
grounds in differential and integral calculus, this book is oriented toward engineers and
applied mathematicians. A course in linear algebra is helpful but not essential. Courses in
elasticity, heat transfer, and fluid mechanics should facilitate the student's understanding of
the applications emphasized in this text. Overall, the author's approach represents a com-
promise between the purely mathematical and the purely applied developments.
Stress or structural analysis is given about the same level of treatment as thermal and
fluid flow analysis. However, this book is structured so that it may be used in courses in
which the application area is strictly stress analysis or strictly thermal analysis. Moreover,
it is also possible to use this book without covering any of the material related to variational
calculus and variational formulations. This strategy is made possible by emphasizing the
Galerkin weighted-residual method in thermal (and fluid flow) analysis and the principle of
virtual displacements in stress analysis. Consequently, this book should be useful to instruc-
tors teaching a course on the finite element method to senior undergraduate students. If the
nonvariational path is desired, the instructor should omit the following sections: the last part
of Sec. 4-2, Sec. 4-3, parts of Sees, 4-4, and Sees. 4-8, 5-3, and 8-6.
The first two chapters are introductory in nature. Chapter 1 contains a brief survey of
what the finite element method is, as well as a brief history of the method. Chapter 2 contains
a review of the necessary mathematical concepts of matrices, vectors, and determinants. The
reason for including this review in the text proper was to establish a common ground from
which the finite element method could be developed, regardless of the specific background
of the engineering student.
All aspects of the finite element are explored in Chapter 3 by way of one of the simplest
of all engineering applications-the truss. The so-called direct approach is adopted for this
purpose and each step in the finite element solution process is given in full detail. For this
reason, all students must be exposed to (and indeed should master) Chapter 3, which is the
only structural analysis chapter that must be covered by all users of this book. Both two-
and three-dimensional trusses are covered, but the former is given broader, more compre-
hensive treatment. The student is also introduced to computer programming concepts and a
two-dimensional truss program.
Chapter 4 provides the g>neral framework. for the development of nearly all (nonstruc-
tural) finite element models. Here the student is introduced to the concepts of globally based
approximations to the true solution of simple ordinary differential equations. Among the
methods covered are the Ritz, Rayleigh-Ritz (variational), point collocation, subdomain
collocation, least squares, and Galerkin methods. The last four of these methods comprise
the class of approximate solution methods known as the weighted-residual methods. Both
the Rayleigh-Ritz (variational) and the Galerkin (weighted-residual) methods are extended
to piecewise continuous approximations and, hence, to the finite element method itself. The
student is introduced, of course, to the concept of shape functions at this point. Chapter 4
concludes with an application in the thermal analysis area: a pin fin (a type of extended
iii

iv
PREFACE
surface). Instructors may wish to have their students review Chapter I before proceeding
with the next chapter.
Chapter 5 is devoted specifically to the development of finite element models in the
stress (or structural) analysis area. A brief review of some of the more important concepts
of elasticity is provided and may be skipped by those who have had a prior graduate course
on this subject. Depending on the instructor's preference, either of two developments may
be used: the principle of minimum potential energy (variational) or the principle of virtual
displacement with a simple one-dimensional application: the uniaxial stress member. The
results from Chapter 5 are used throughout Chapter 7, the primary stress application chapter.
Chapter 6 is, in effect, a catchall chapter, which contains essential material that has
not been covered adequately up to this point. Here the student is introduced more formally
to the concept of parameter functions (such as displacement and temperature functions) and
to the compatibility and completeness requirements that these functions should satisfy. Shape
functions (CD-continuous only) are derived and presented for the following types of one-,
two-, and three-dimensional elements: two-node lineal (I-D), three-node triangular (2-D),
four-node rectangular (2-D), four-node tetrahedral (3-D), and eight-node brick (3-0). Local,
normalized coordinates, such as length, area, and volume coordinates, as well as serendipity
coordinates, are introduced. Axisymmetric elements are also presented. Three simple inte-
gration formulas are given in terms of length, area, and volume coordinates for integrations
over lineal, triangular, and tetrahedral elements, respectively. Finally, an alternative to the
matrix inversion technique is provided, namely, the active zone equation solver. This method
is based on triangular decomposition, forward elimination, and backward substitution, and
takes advantage of the banded, and often symmetric, nature of the assemblage stiffness
matrix. This method requires that the assemblage stiffness matrix be stored as a column
vector (instead of a square matrix).
Chapter 7 is the main stress analysis application chapter. Among the topics covered are
the following: two-dimensional stress analysis (plane stress and plane strain), axisymmetric
stress analysis, three-dimensional stress analysis, and the analysis of beams. The notion of
substructuring and condensation is also introduced and working equations are developed.
The chapter concludes with a brief description of the development of a two-dimensional
stress analysis program. The instructor is referred to the Instructor's Solutions manual for a
listing (in FORTRAN) of one version of this program-called program STRESS (the user's
manual to the program is also included in the Instructor's Solutions manual).
Chapter 8 is the principal thermal and fluid flow analysis chapter, in which the following
topics are covered: one-, two-, and three-dimensional thermal analysis, and axisymmetric
thermal analysis. Material on variational formulations in two-dimensional problems is pro-
vided, but this also may be skipped by those preferring the nonvariational path. Other
application areas in Chapter 8 include convective energy transport, two-dimensional potential
flow, and two-dimensional incompressible fluid flow. The chapter concludes with a brief
description of the development of a two-dimensional, steady-state thermal analysis program.
Again the instructor is referred to the Instructor's Solutions manual for a listing (in FOR-
TRAN) of one version of this program-called HEAT (the user's manual to the program is
also included in the Instructor's Solutions manual).
Chapter 9 introduces higher-order elements and numerical integration (quadrature). The
one-, two-, and three-dimensional elements introduced in Chapter 6 are extended to quadratic
and cubic order. Subparametric, isoparametric, and superparametric elements are also in-
troduced. Two- and three-dimensional isoparametric formulations are developed for the
quadrilateral and triangular elements as well as for the brick and tetrahedral elements. Special
formulas are presented, which facilitate greatly the evaluation of the integrals that naturally
arise.

PREFACE
V
In conclusion, Chapter lOis devoted to transient thermal analysis and dynamic structural
analysis. The concept of partial discretization is presented and applied to stress analysis and
thermal analysis. Lumped and consistent capacitance and mass matrices are discussed. So-
lution methods are developed based on the finite element method itself (i.e., in time) and
on the finite difference method. The result is two- and three-point recurrence schemes for
transient thermal analysis and dynamic structural analysis, respectively. The chapter con-
cludes with a brief introduction to modal analysis.
Appendix A contains the material property data to be used in the problems, unless
otherwise noted in the problem statements. Appendix B contains a short user's manual to
the (two-dimensional)truss programalong with the program listing(in FORTRAN). Appendix C
contains listings of subroutines ACTCOL and UACTCL (and function DOT), which have
been used with the written permission of McGraw-Hill and which appear in Professor
Zienkiewicz's third edition of The Finite Element Method. The length of the STRESS and
HEAT programs and their respective user's manuals precluded their inclusion in this text.
Instructors who would like to have copies of all of these programs on floppy disks are
encouraged to write to the author. The disk formats available are IBM PC, Apple II series,
and 8-inch IBM 3740 standard format for CP/M-based machines. *Other FORTRAN pro-
grams that can be obtained on these disk formats include: beam analysis, a TurboPascal**
version of the two-dimensional truss program, fin analysis, transient one-dimensional thermal
analysis, and transient two-dimensional thermal analysis.
The following suggestions are made to instructors teaching on the quarter and semester
system. For those teaching on the quarter system: Chapters I to 4 can be covered comfortably
during the fall quarter. The winter quarter could be devoted to stress analysis with coverage
of Chapters 5, 6, 7, 9, and 10 (omit Sees, 10-4, 10-7, and 10-8). The spring quarter could
be devoted to thermal and fluid flow analysis with coverage of Chapters 6, 8, 9, and 10
(omit Sees. 10-3, 10-9, and 10-10). For students who take all three courses, some of the
material is necessarily repeated. The author has found this repetition not to be a problem,
because these students get a firmer grasp of the material the second time around.
For those teaching on the semester system: Chapters I to 6 could be covered comfortably
during the first semester, and Chapters 7 to 10 during the second semester. This pace allows
sufficient class time for the discussion of computer programming techniques. A useful project
for the first course is to have the students modify the two-dimensional truss program in
Appendix B so that it could be used in three-dimensional truss applications.
The Instructor's Solutions manual contains a listing (in FORTRAN) of a two-dimen-
sional, static stress analysis program (for Chapter 8). The manual is available from the
publisher upon proper written request. The instructors may find it useful to distribute copies
of these programs to their classes.
The author wishes to thank all of the students who have used the original notes and
class-tested the text manuscript. Their comments and suggestions were taken seriously, and
their words of encouragement will always be remembered. Deserving of special recognition
is Jay A. Buckman, who did an outstanding job of proofreading the page proofs. A special
debt of gratitude is owed to General Herbert McChrystal, who first suggested this project.
Very special thanks are extended to U. Shripathi Kamath, who had the monumental task of
providing the solutions manual to the text, and to Michael Weaver for converting the FOR-
TRAN version of the truss program into Pascal. The author is also thankful to the editors
*CP/M is registered trademark of Digital Research, Inc.
**TurboPascal is a trademark of Borland International.

vi
PREFACE
John J. Beck, Lynn Contrucci, and Rachel Hockett for their help and cooperation in publishing
the manuscript. Finally, and most important of all, the author is once again deeply indebted
to his wife, Donna, who meticulously typed every page of the manuscript and without whose
encouragement this book would probably not have been completed, and to Lisa Ann, for
helping to put this project into proper perspective and for providing the perpetual light at
the end of tunnel.
Frank L. Stasa

Preface
CONTENTS
iii
1
General Concepts
1·1
Introduction
1·2
What Is the Finite Element Method?
1-3
Discretization
1-4
Relationship to the Finite-Difference Method
1-5
Advantages and Disadvantages of the Finite
Element Method
1-6
Brief History of the Finite Element Method
1-7
Remarks
References
2
Mathematical Preliminaries
2-1
Introduction
2-2
Definition of a Matrix
2-3
Equality of Two Matrices
2-4
Matrix Algebra
Matrix Addition and Subtraction
22
Matrix Multiplication
22
The Commutative, Distributive, and Associative
Properties
24
2-5
Transpose of a Matrix
2-6
Determinants, Minors, and Cofactors
1
1
3
5
8
10
13
15
16
19
19
19
21
21
24
25
vii

viii
TABLE OF CONTENTS
2-7
2-8
2-9
2-10
2-11
2-12
2-13
2-14
3
3-1
3-2
3-3
3-4
3-5
3-6
3-7
Adjoint and Inverse of a Matrix
Matrix Partitioning
Definition of a Vector
Equality of Two Vectors
Length of a Vector
Vector Algebra
Direction Cosines
Solution to Systems of Linear Algebraic
Equations
References
Problems
Truss Analysis: The Direct Approach
Introduction
Finite Element Formulation: The Direct
Approach
Discretization
45
ElementStiffnessRelationshipin LocalCoordinates
47
Transformation from Local to Global Coordinates
49
Global Element Stiffness Relationship
51
Assemblage
55
Application of Loads
58
Application of Restraints on Nodal Displacements and
Solution
59
Computation of the Element Resultants
61
Application to a Specific Example
Summary of the Basic Steps
Step I: Discretization
70
Step 2: Determination of the Local Element
Characteristics
71
Step 3: Transformation of the Element
Characteristics
71
Step 4: Assemblage of the Global Element
Characteristics
72
Step 5: Applicationof the PrescribedDisplacements
72
Step 6: Solution
72
Step 7: Calculation of Element Resultants
72
Three-Dimensional Truss Formulation
Description of a Simple Computer Program:
TRUSS
Description of the Program
79
Mesh Generation
83
Remarks
References
Problems
27
28
29
31
31
32
33
35
36
37
43
43
45
62
70
73
79
87
90
90

TABLE OF CONTENTS
ix
4
4-1
4-2
4-3
4-4
4-5
4-6
4-7
4-8
4-9
4·10
4-11
5
5-1
5-2
Variational and Weighted Residual
Formulations
Introduction
Some Approximate Solution Methods
General Concepts
103
The Ritz Method
104
The Variational Method
107
Variational Calculus: An Introduction
Some Additional Mathematics
Integration by Parts
113
Taylor's Series
113
The Differential of a Function
113
The Variation of a Functional
114
The Commutative Properties
114
Miscellaneous Rules of Variational Calculus
114
The Euler-Lagrange Equation, Geometric and
Natural Boundary Conditions
The Method of Weighted Residuals
General Concepts
121
Point Collocation
122
Subdomain Collocation
124
Least Squares
126
Galerkin
128
Comparison with the Exact Solution
129
More Mathematics
Derivative of a Matrix with Respect to a Scalar
131
Integral of a Matrix with Respect to a Scalar
131
Derivative of a Scalar Function with Respect to a
Vector
131
The Integral as a Sum of Other Integrals
133
The Rayleigh-Ritz Finite Element Method
The Galerkin Finite Element Method
Application: One-Dimensional Heat Transfer in a
Pin Fin
The Element Characteristics
147
Heat Removal Rate
149
Fin Efficiency
150
Remarks
References
Problems
General Approach to Structural Analysis
Introduction
Basic Concepts in Elasticity
101
101
102
110
112
115
121
130
133
142
146
155
157
157
185
185
186

X
TABLE OF CONTENTS
Stress at a Point
187
The Equations of Static Equilibrium
189
Principal Stresses
191
Strain at a Point
195
Strain-Displacement Relations
196
The Compatibility Equation
197
A Constitutive Relationship-Hooke's Law
198
Surface Tractions
199
5-3
Principle of Minimum Potential Energy
200
5-4
Principle of Virtual Displacements
204
5-5
The Finite Element Basis
206
5-6
The Shape Function Matrix
207
Two-Node Lineal Element
208
Three-Node Triangular Element
208
Four-Node Tetrahedral Element
210
Properties of CO-Continuous Shape Functions
211
5-7
The Finite Element Characteristics
213
5-8
Application: Tapered Uniaxial Stress Member
215
The Element Characteristics
216
The Element Resultants
219
5-9
Remarks
225
References
226
Problems
227
6
Parameter Functions; CO-Continuous Shape
Functions; Simple Integration Formulas;
Active Zone Equation Solvers
239
6-1
Introduction
6-2
Parameter Functions
Definition of a Parameter Function
240
Restrictions on the Parameter Functions
240
6-3
One-Dimensional Element
Global Coordinates
244
Serendipity Coordinate
247
Length Coordinates
248
6-4
Two-Dimensional Elements
Three-Node Triangular Element
249
Four-Node Rectangular Element
253
6-5
Three-Dimensional Elements
Four-Node Tetrahedral Element
258
Eight-Node Brick Element
263
6-6
Axisymmetric Elements
6-7
Some Simple Integration Formulas
Length Coordinates
267
239
239
244
249
257
265
267

TABLE OF CONTENTS
xi
Area Coordinates
268
Volume Coordinates
269
6-8
Active Zone Equation Solver
Triangular Decomposition
270
Forward Elimination and Backward Substitution
273
Classification of Symmetric Real Matrices
276
Storage Considerations
277
Computer Implementation
279
6-9
Remarks
References
Problems
7
Stress Analysis
7-1
Introduction
7-2
Two-Dimensional Stress Analysis
Definitions of Plane Stress and Plane Strain
288
The Shape Function Matrix N
289
The Strain-Nodal Displacement Matrix B
290
The Constitutive Relationship
291
The Element Stiffness Matrix
294
The Element Nodal Force Vectors
296
Composite Nodal Force Vector
302
Assemblage Step
302
Prescribed Displacements
304
Solution for the Nodal Displacements
305
The Element Resultants
305
Remarks
306
7-3
Axisymmetric Stress Analysis
Definitions
306
The Strain-Displacement Relationship
306
The Shape Function and Strain-Nodal Displacement
Matrices
308
The Constitutive Relationship
309
The Element Stiffness Matrix
310
The Nodal Force Vectors
311
Remarks
315
7-4
Three-Dimensional Stress Analysis
The Strain-Displacement Relationship
317
The Shape Function and Strain-Nodal Displacement
Matrices
318
The Constitutive Relationship
319
The Element Stiffness Matrix
319
The Element Nodal Force Vectors
320
Remarks
322
270
280
281
282
287
287
287
306
316

xii
TABLE OF CONTENTS
7-5
Beams
Review of the Elementary Theory
323
Cl-Continuous Shape Functions
325
The Finite Element Characteristics
329
Remarks
332
7-6
Substructuring
7-7
Development of a Two-Dimensional Stress
Analysis Program: Program STRESS
The Main Program
340
Mesh Generation
340
Data Storage
341
7-8
Remarks
References
Problems
8
Steady-State Thermal and Fluid Flow
Analysis
8-1
Introduction
8-2
The Direct Iteration Method
8-3
One-Dimensional Heat Conduction
The Governing Equation
375
The FEM Formulation
376
8-4
The Green-Gauss Theorem
8-5
Simple Two-Dimensional Heat Conduction
8-6
Variational Formulations in Two Dimensions
The Euler-Lagrange Equation: Geometric and Natural
Boundary Conditions
391
The Finite Element Formulation
396
8-7
The Galerkin Method in Two Dimensions
8-8
General Two-Dimensional Heat Conduction
The Governing Equation
399
The FEM Formulation
400
The Element Resultants
409
8-9
Axisymmetric Heat Conduction
The Governing Equation
422
The Finite Element Formulation
422
8·10
Three-Dimensional Heat Conduction
The Governing Equation
431
The Finite Element Formulation
431
8-11
Two-Dimensional Potential Flow
Velocity Potential Formulation
437
The Element Resultants
443
Stream Function Formulation
445
8-12
Convection Dominated Flows
322
337
339
343
343
344
371
371
371
374
385
388
391
397
398
421
430
436
448

TABLE OF CONTENTS
xiii
8-13
Incompressible Viscous Flow
452
8-14
Development of a Two-Dimensional Thermal
Analysis Program
456
The Main Program
457
Mesh Generation
457
Data Storage
459
Variable Property Routine: SUBROUTINE
VPROP
460
Point Heat Sources
463
8-15
Remarks
463
References
464
Problems
465
9
Higher-Order Isoparametric Elements and
Quadrature
509
9-1
Introduction
509
9-2
One-Dimensional Elements
510
Length Coordinates
510
Serendipity Coordinate
511
9-3
Two-Dimensional Elements
512
The Triangular Element
512
The Rectangular Element
514
9-4
Three-Dimensional Elements
515
The Tetrahedral Element
516
The Brick Element
517
9-5
Subparametric, Isoparametric, and
Superparametric Elements
520
9-6
Two-Dimensional Isoparametric Formulations
525
The Quadrilateral Element
525
The Triangular Element
530
9-7
Three-Dimensional Isoparametric Formulations
534
The Brick Element
535
The Tetrahedral Element
539
9-8
Numerical Integration: Rectangular and Brick
Elements
542
9-9
Numerical Integration: Triangular and
Tetrahedral Elements
553
9·10
Numerical Integration: Required Order
558
References
559
Problems
559
10
Transient and Dynamic Analyses
577
10-1
Introduction
10-2
Partial Discretization
577
578

xiv
TABLE OF CONTENTS
10-3
Dynamic Structural Analysis
579
10-4 • Transient Thermal Analysis
581
10-5
Lumped Versus Consistent Matrices
584
Consistent Matrices
584
Lumped Mass and Capacitance Matrices
586
10-6
Solution Methods
588
10·7
Two-Point Recurrence Schemes: The Finite
Difference Method
589
Forward Difference Scheme
589
Backward Difference Scheme
591
Central Difference Scheme
591
Summary and Application of the Prescribed
Temperatures
592
10-8
Two-Point Recurrence Schemes: The Finite
Element Method
594
Point Collocation
596
Subdomain Collocation
597
Galerkin
597
10-9
Three-Point Recurrence Schemes
604
Special Cases
608
Initial and Boundary Conditions
611
10-10 Introduction to Modal Analysis
614
References
618
Problems
618
Appendix A
Structural and Thermal Properties
623
A-1
Structural Properties
623
A-2
Thermal Properties
624
Appendix B
Program TRUSS
627
B-1
Listing of Source Code for Program TRUSS
627
B-2
Description of Input to Program TRUSS
638
Appendix C
Index
Active Zone Equation Solvers
643
647

1
General Concepts
1-1
INTRODUCTION
The finite element method of analysis is a very powerful, modern computational
tool. The method has been used almost universally during the past 15 years to solve
very complex structural engineering problems, particularly in the aircraft industry.
It is now gaining wide acceptance in other disciplines such as thermal analysis,
fluid mechanics, and electromagnetics. The method requires the use of a digital
computer because of the large number of computations involved.
Structures take many different, sometimes very diverse, forms and utilize many
different materials. Oftentimes a structure itself is composed of a multitude of
materials. For example, bridges and space-deployable antennas are both structures,
but they hardly resemble each other in appearance and materials. A space-deployable
antenna looks like a gigantic umbrella that is closed during launch and opened, or
deployed, once in earth orbit. Figure I-I shows an antenna in the deployed con-
figuration. The structural design and analysis of this antenna was done with large
finite element computer programs such as NASTRAN [I] and STARDYNE [2].
In the design of a bridge, engineers are concerned with the stresses developed
in the bridge as a result of the weight of the vehicles riding on it, in addition to
wind loads and its own weight. These stresses are important because all materials
have upper limits on allowable stresses. When these allowable stresses are exceeded,
the structure may no longer perform its intended function. In the extreme case, the
structure may actually collapse. A tragic example of this is the collapse of two 32-
ton skywalks at the Hyatt Regency Hotel in Kansas City on July 27, 1981.
In the case of the space-deployable antenna, excessively large deflections of
its carefully contoured umbrellalike surface will deteriorate the antenna perfor-

2
GENERAL CONCEPTS
Figure ,-,
Photographof a space-deployableantenna in solar thermal vacuum test cham-
ber. tCounesy ofHarris Corporation and TRW.)
mance. If the distortions are too large. the antenna may not be able to perform its
intended function. These deflections may be caused by the heating effect of the
sun. Most materials stretch when heated and shrink when cooled. If part or all of
the antenna becomes shaded by the spacecraft, an improperly designed antenna may
distort enough to render itself useless.
In a typical thermal analysis application, we may need to know the temperatures
within the body being analyzed. For example. for the space-deployable antenna the
amount of distortion as a result of the temperature change cannot be ascertained
until the temperatures themselves are determined. Sometimes in addition to the
temperatures, we need to know how much heat is flowing through a given area.
In fluid mechanics problems, the analyst may need to determine the fluid velocities
and pressures within or around some device or object. The complex flow pattern
in a coal gasifier, for example, may be needed [3]. The finite element method is
being used today to solve these and many other more complex problems.
It should be obvious that it is not possible to obtain closed-form, analytical
solutions to complex problems such as these. Often a skilled engineer can make
simplifying assumptions to obtain a closed-form solution, but the very nature of

WHAT IS THE FINITE ELEMENT METHOD')
3
Figure '-2
Three-noded triangular element.
some problems, such as the bridge and space-deployable antenna, may preclude
such an approach. Complexities may arise because of the irregular and varied
geometry, mixed boundary conditions, nonlinear material behavior, and nonuniform
loading conditions. The finite element method is particularly well-suited to handle
these and other complications.
1-2
WHAT IS THE FINITE ELEMENT METHOD?
The basic idea behind the finite element method is to divide the structure, body,
or region being analyzed into a large number ofjinite elements, or simply elements.
These elements may be one, two, or three dimensional. A popular and classical
two-dimensional element is the triangle shown in Fig. 1-2. When a two-dimensional
structure (or heat transfer device, etc.) is divided into hundreds or sometimes
thousands of these nonoverlapping triangles, we can see that essentially all planar
geometries can be easily accommodated. Note that this particular element has three
nodes (i, j, k) appropriately placed at the vertices of the triangle. Before explaining
the purpose of these nodes or nodal points, let us see how we may use this type
of element to represent an irregularly shaped plate.
Figure 1-3 shows such a plate. By way of illustration, let us say that the
temperature distribution within the plate is sought for a given plate material, spec-
ified boundary conditions, etc. The field variable of interest here is the temperature.
Because there is an infinite number of points in the plate, there is also an infinite
number of temperatures to be determined. The problem is therefore said to have
an infinite number of degrees of freedom. It should be recalled that when closed-
Figure '-3
Plate with variable thickness and an irregular shape.

4
GENERAL CONCEPTS
form analytical solutions exist, they theoretically allow us to compute the temper-
ature at any point (and hence at an infinite number of them) in the region because
the solution is expressed as a mathematical function of x and y lin the form T =
.fix,y)]. For the plate in Fig. 1-3, the irregular geometry precludes such a c1osed-
form solution. Therefore, an alternate approach is sought.
Instead of requiring that the temperature be determined at every point in the
plate, let us change this unreasonable requirement to a determination of the tem-
perature at only a finite number of points. It would appear that these points could
be taken as the vertices (or nodes) of the triangles. Figure 1-4 shows the plate
discretized into several triangular elements. Note how the curved boundaries are
approximated by the straight-sided triangles. The finite element method will provide
the analyst with the temperatures of the plate only at the nodal points. Interpolation
functions are used within each element to describe the variation of the field variable
(e.g., here the field variable is the temperature) as a function of the global coor-
dinates (x and y in this case). Knowledge of the temperatures at the nodal points
allows the analyst to ascertain the general temperature field within the region. These
temperatures are often referred to as the nodal temperatures. From these, the heat-
flows through each element are also easily determined.
As mentioned earlier, a high-speed digital computer is used to perform the
large number of computations involved. An analyst must provide the relevant
computer program with the coordinates of each node, element definitions, material
data, boundary condition data, etc. Generally the accuracy improves as the number
of elements increases, but computational time, and hence cost, also increase. There
is no substitute for experience in trying to determine the number of elements to be
used. The computer program determines the temperature at each node and the heat-
flows through each element. The results are usually printed or presented in graphic
form. The analyst may then use this information in the design process.
Although the example chosen above was in the heat transfer area, the same
basic idea is applicable to the structural and the fluids areas, as well as to others.
In a structural analysis application, the field variables may be displacements and/
or deflections and slopes. Therefore, in a structural finite element model. we de-
termine the nodal displacements and/or the nodal deflections and slopes. From
these, the stresses and/or bending moments within an element are easily derived.
In a fluid flow analysis, the field variables are frequently, but not always, the fluid
Figure 1-4
Irregularlyshaped plate showndiscretized into manytriangular finite elements.

DISCRETIZATION
5
velocities and pressure. Therefore, the corresponding finite element model enables
a determination of these parameters at the nodal points. These results may then be
used to obtain the shear stresses within each element if they are needed.
In summarizing, the two key ideas of the finite element method are (I) dis-
cretization of the region being analyzed into finite elements and (2) the use of
interpolating polynomials to describe the variation of a field variable within an
element. Both of these notions are developed in subsequent chapters. However, the
power of discretization can be demonstrated by trying to ascertain the value of 'IT
as shown in Sec. 1-3.
1-3
DISCRETIZATION
Let us try to compute the circumference of a circle without assuming a value of
'IT. If the circumference can be computed (or at least approximated) in this way,
the value of 'IT may be computed (approximately, since the circumference is ap-
proximate) from the well-known definition
C
'IT=-
d
(1-1)
where C is the circumference of the circle and d is the diameter.
Two scholars were largely responsible for the determination of the value of 'IT.
The first, Eudoxus of Cnidus, was born about 2400 years ago in southwest Asia
Minor [4]. He developed the method of exhaustion in which he determined the area
bounded by one or more closed curves and the volume bounded by a closed surface
by replacing the original problem with many simpler ones. He then added up the
individual results to obtain the solution to the original problem. For example, to
determine the area under the curve shown in Fig. l-5(a) from point a to point b,
Eudoxus would have divided the unknown area into a number of rectangles whose
areas are readily calculated. Two ways of accomplishing this are shown in Figs.
l-5(b) and (c). Note that the method illustrated in Fig. 1-5(b) would give a low
estimate of the area whereas that in Fig. 1-5(c) would give a high estimate. This
gave rise to the notion of bounding an approximate result. As more and more
rectangles are used, it seems intuitively obvious that better and better approximations
result: this is called convergence.
With this method, Eudoxus showed that the area of a circle is proportional to
the square of its diameter. He also demonstrated that the volumes of a pyramid and
cone are one-third the volumes of the rectangular prisms and cylinders, respectively,
with the same heights and bases. The method ofexhaustion is fully elaborated upon
in Book XII of Euclid's Elements. This method is the forerunner of integral calculus,
which surprisingly was not developed until about 20 centuries later by Leibnitz and
Newton.
The scholar who further advanced the notion of discretization was Archimedes,
a Greek mathematician, scientist and inventor, born in 287 B.C. in the Greek city-
state of Syracuse in Sicily [5]. He extended the method of exhaustion to the point

6
GENERAL CONCEPTS
(a l
h
(e)
h
t b)
Figure '-5
Illustration of the method of exhaustion in obtaining the area under a curve.
(a) Exact area. (b) Lower bound on estimate by using inscribed rectangles. (c) Upper bound
on estimate by using circumscribed rectangles.
where it was actually equivalent to integration in some cases. In one of his extant
treatises, Measurement of a Circle, Archimedes placed the value of the circum-
ference of a circle between 31J7 and 3 10/ 7 1 times its diameter. Consequently, firm
limits were placed on the value of 'IT. Although others throughout the ages subse-
quently improved the value of 'IT, it was Eudoxus and Archimedes who were largely
responsible for determining the value of this important constant.
By way of illustration, let us determine a sequence of approximate values of
'IT by inscribing and circumscribing regular polygons inside and around a circle as
shown in Fig. 1-6 for the case of regular inscribed and circumscribed octagons.
The lengths of the sides of the polygons are readily measured (because they are
straight and not curved), and the resulting lower and upper bounds of 'IT are readily

(a)
(b)
D1SCRETIZAnON
7
Figure '-6
Approximation to the circumference of a circle by (a) an inscribed octagon
and (b) a circumscribed octagon.
calculated from Eq. (I-I). The results are given in Table I-I, first, for an eight-
sided polygon, then, for each successive case doubling the number of sides until
a staggering 1,048,576 sides [6] are used-hence the name method of exhaustion!
Note that the lower estimate converges more rapidly to the accepted value for 7T
of 3.1415926536 (to 10 decimal places).
These simple and antiquated examples illustrate the concept of discretization-i-
the essence of which is the division of a larger, more difficult problem into a number
Table ,-,
Calculation of the Value of 'IT by the Method of Exhaustion Using Inscribed
and Circumscribed Regular Polygons
Number of
Inscribed
Circumscribed
sides
polygons
polygons
8
3.061467458921
4.959315235374
16
3.121445152258
3.878006734963
32
3. 136548490546
3.477392565633
64
3.140331156955
3.302370812490
128
3.141277250933
3.220307554543
256
3.141513801144
3.180543968220
512
3.141572940367
3.160968277095
1024
3.141587725277
3.151255641334
2048
3.141591421511
3.146417964326
4096
3.141592345570
3.144003766021
8192
3.141592576585
3.142797824426
16384
3.141592634339
3.142195142707
32768
3.141592648777
3.141893874079
65536
3.141592652387
3.141743257818
131072
3.141592653289
3.141667954200
262144
3.141592653515
3.141630303519
524288
3.141592653571
3.141611478460
1048576
3.141592653585
3.141602066002

8
GENERAL CONCEPTS
of smaller, simpler problems such that the sum of the solutions for the simpler
problems, in some sense, approximates the solution to the original problem. The
example involving the computation of the area under a curve utilized a very common
finite element-the rectangular element. The example involving the evaluation of
1T utilized another finite element-the lineal element. The rectangle, like the triangle
in Sec.
1-2, is a two-dimensional element, whereas the lineal element is one-
dimensional. Quite appropriately, the two-dimensional element was used to evaJuate
an area, whereas the one-dimensional element was used to determine the circum-
ference (which is a length and, hence, also one-dimensional). Not surprisingly,
three-dimensional elements such as tetrahedra and rectangular prisms (or bricks)
may be used in the method of exhaustion to determine the voJume of three-dimen-
sional objects with complicated boundaries.
1-4
RELATIONSHIP TO THE FINITE-DIFFERENCE METHOD
The finite-difference method (FDM) is an alternate solution technique that may be
used to soJve the same types of problems for which the finite element method (FEM)
is suited. This is particularly true in the cases of thermal and fluid flow analyses.
Both methods require the analyst to discretize the structure, object, or region being
analyzed or modeled. However, the way in which the discretization is done is
fundamentally different.
For the purpose of this discussion, let us restrict our attention to the two-
dimensional case. It should be recalled that the triangular and rectangular elements
may be used in FEM. So as not to obscure the basic point that is to be made here,
let us further restrict the discussion to the case of the rectangular element. In FEM,
the nodes are placed at the corners of the rectangles. Since the rectangle has four
corners, there are four nodes. This is quite different from the way in which the
discretization is done in FDM.
In FDM, the object or region being analyzed is divided into a finite number
of lumps. Note that the word "lump," not the word "element," is used. In the
basic FDM approach, each of these lumps is assumed to have a constant value of
the pertinent field variable (this value, however, may be a function of time in
transient problems). For example, in a heat transfer or thermal analysis problem,
the relevant field variable is the temperature. Therefore, each lump would be
isothermal. Since the entire lump is isothermal, it seems natural that the node for
the lump should be associated not with any of its corners, but rather at its geometric
center or centroid. Figure J-7 shows the two different methods of discretization.
In Fig. 1-7(a), a typical rectangular finite element is shown with four nodes.
It should be recalled from the discussion in Sec. 1-2 that each of these four nodes
may have a different value of the field variable (dispJacements, temperatures,
velocities, pressures, etc.). It should further be recalled that by using interpolation
functions for the field variable within each element, the field variable is generally
not constant over an eJement but varies in some prescribed manner, depending on
the interpolation poJynomial being used.

RELATIONSHIP TO THE HNITE-DIFFERENCE METHOD
9
•
(a)
(b)
Figure 1-7
Two main types of discretization. (a) An element used in finite element analysis.
(b) A lump used in finite-difference analysis. Note the four nodes on the element in (a) and
the one node on the lump in (b).
Figure 1-7(b) shows a typical lump used in FDM analysis. The one and only
node appears at the center of the rectangular lump. In this case, the entire lump is
assumed to have a constant value of the field variable. Inboth FEM and FDM, the
nodes represent the locations at which the field variables are to be determined.
To further illustrate the difference between the FEM and FDM approaches, let
us discretize a rectangular plate into elements and lumps such that the same number
of nodes is used in each case. Figures 1-8(a) and (b) clearly show the difference
between the two approaches. The FDM discretization in Fig. 1-8(a) requires that
if nodes are to be placed on the plate boundaries (e.g., to impose a prescribed
temperature on this boundary), then the surface lump is essentially one-half the size
of an interior lump. Comer lumps are seen to be one-fourth the size of interior
lumps. This assumes that the nodes are to be equally spaced; if they are not, the
situation is even more complicated. Note that for the FEM discretization in Fig.
1-8(b), each element is of the same size for equally spaced nodes. If it is desirable
to assign nodes that are not equally spaced, the FEM approach is more easily
adapted.
More importantly, in cases in which the geometry of the region being analyzed
is irregular, as shown in Fig. l-9(a), the triangular and quadrilateral elements are
routinely used, and it is seen that the plate boundaries are approximated quite well
I
I
I
I
I
r
- -1-- - -- +- - -- -~-- - --~-- --+ -- -+-
I
I
I
I
I
I
lel.!.I.I.1
I
I
I
I
I
j
-+----""-----+-----i-----+----+-
I
I
I
I
I
I
lelelelelel
I
I
I
I
I
I
_+
1.
-+-
..1.
..1.
4-_
I
I
I
I
I
I
lelelel.:.1
I
I
I
I
I
I
_4-
L
__ -1- -- --+----+----+-
I
I
I
I
1
I
(a)
I
1
I
I
I
I
I
I
I
I
I
I
I
1
I
---,----+----.----·----t----
I
I
I
:
I
1
I
I
1
1
I
1
I
I
1
-- --,-----. --- -.. ----.----~----
I
I
1
I
1
I
I
I
I
I
I
I
I
I
1
----~----~---~---~---i'----
I
I
I
I
I
I
I
I
I
1
(b)
Figure 1-8
Rectangular plate discretized into (a) lumps for a finite-difference analysis and
(b) rectangular elements for a finite element analysis.

10
GENERAL CONCEPTS
with these elements. Note that different element types may be used in the same
model, as illustrated here by the use of the triangular, rectangular, and quadrilateral
elements. On the other hand. if the same plate is discretized into lumps for an FDM
analysis, as shown in Fig. 1-9(b). then the effective plate boundary becomes jagged
as shown. The alternative is to write special finite-difference equations for these
nodes that explicitly include the effect of the curved boundary [71. Unlike the
formulation in FEM. the FDM formulation is nontrivial when curved boundaries
are present.
The different methods of discretization in FEM and FDM, however, are not
the only significant differences between the two types of formulations. In FDM, a
basic law is written for each node, such as the first law of thermodynamics (con-
servation of energy) or Newton's second law of motion. For example, in a heat
transfer formulation, an energy balance is made on each lump. This is relatively
straightforward (except when curved boundaries are present).
In FEM, although a direct energy balance approach can be used, other more
powerful and more popular approaches are taken such as the principle of virtual
work, variational methods, and weighted-residual methods. These various methods
of FEM formulations are developed in detail throughout this text. For structural
and stress analysis problems. the principle of virtual work will usually be used,
whereas for nonstructural applications. the method of weighted residuals will be
used almost exclusively. The reasons for favoring the method of weighted residuals
over variational formulations will become evident in Chapters 4 and 8. As the name
implies, the variational formulations require knowledge of variational calculus, an
obvious disadvantage.
1-5
ADVANTAGES AND DISADVANTAGES
OF THE FINITE ELEMENT METHOD [8]
As mentioned in the previous section. one of the main advantages of FEM over
most other approximate solution methods. including the popular finite-difference
(a)
Typical
quadrilateral
clement
TypICal
triangular
element
Iypical
boundary
lump
Typical
corner
lump
Typical
interior lump
(b)
+--l--,--+-
-,
II·i·\·\·~·,
i-.-T~-i;-r;i~-,•
Effective
~__+__ ~_+_-j __ ~_+
,/boundary
lelalelelel·l_
i--t---f--{--f--~--t--f -:
Actual
~_·_~~l~_:_~l~J_·_L~J_
irregular
I
•
:
•
:
•
:
•
:
•
:
•
:
•
:
•
I
/
boundary
~_~__ L_~__ L_J__ L_~__ L_
:.:.:.:.:.:.:.:.:.1
-r--r-f---j--l-- ~- -{- - +--t- --~
lei. lelel.1 .lelel.1
~--~---j--t-i--~-~--~-i--~
Typical
rectangular
element
Irregular
boundar).'
-+-+--+--+-
-+--+--+--+--~~ ..
-+-+-.-.-+-~~-+
I
I
I
I
I
I
I"
-+-+-+-+-+-+-10'-
--+---+---+--~--+--~-~-¥-
-~-+-~-+-+-+-+-+-+-
-+-t-+-t-+-+-+-+-+-
I
1
I
I
I
I
I
I
I
Figure 1-9
Irregularly shaped plate shown discretized into (a) rectangular, triangular. and
quadrilateral clements and (b) lumps.

ADVANTAGES, DISADVANTAGES OF FINITE ELEMENT METHOD
11
method, is the fact that FEM can handle irregular geometries routinely, The tri-
angular element in two-dimensional applications is used with no special consid-
erations, Of course, closed-form analytical solutions are invariably nonexistent when
irregular geometries are present.
Another significant advantage of FEM is that a variable spacing of the nodes
is also routinely handled, When a body is discretized using finite elements (in FEM)
or lumps (in FDM), the nodes are said to form a mesh, Typical two-dimensional
meshes were shown in Figs, 1-8 and 1-9, When the nodes are not equally spaced,
the mesh is said to be graded, The finite element method lends itself to the use of
graded meshes. It will be seen in later chapters that special subroutines can be
written that will automatically or semiautomatically generate unequally spaced nodes,
thereby reducing the amount of input required by the user of such a computer
program,
Another advantage of FEM, again over FDM and especially over analytical
solution techniques (as opposed to numerical techniques) is the ease with which
nonhomogeneous and anisotropic materials may be handled, Materials whose prop-
erties are not spacially dependent are said to be homogeneous, whereas materials
with spacially dependent properties are heterogeneous, A special case of a heter-
ogeneous material in a thermal analysis is one for which the thermal conductivity
is temperature-dependent. The reason for this is simple: the thermal conductivity
is a function of temperature, the temperature is a function of spacial coordinates,
and, therefore, the thermal conductivity must also be a function of spacial coor-
dinates, Concrete is an example of a heterogeneous material.
Materials may also be classified as isotropic and anisotropic, An isotropic
material is one whose properties (Young's modulus, thermal conductivity, etc.) do
not exhibit a direction sensitivity, For example, even though concrete may be
nonhomogeneous, each direction appears to have the same (rather random) variation
in thermal conductivity and, therefore, it is isotropic, Anisotropic materials, on the
other hand, will have one or more properties that are direction-dependent. For
example, a laminated metallic structure quite frequently will have different values
of certain properties, such as Young's modulus or thermal conductivity, in different
directions. Wood is another example of an anisotropic material; it is generally
stronger in the direction of the grain and hence would have a higher value of
Young's modulus in this direction. Very little extra effort is required in the FEM
formulation when heterogeneous and/or anisotropic materials are to be modeled,
even when some parts of the structure or body are made of one material and other
parts are made of different materials.
All the various types of boundary conditions that we may encounter in a typical
FEM application except those that require prescribed values of the field variables
themselves, are automatically included in the formulation. Recall that typical field
variables are displacements in structural and stress analysis, temperatures in thermal
analysis, fluid velocities and pressures in fluid flow analysis, etc. In other words,
prescribed displacements, temperatures, velocities, pressures, etc., are not auto-
matically included in the FEM formulation and solution. They are systematically
enforced just before the solution for the nodal values of the unknown field variables

12
GENERAL CONCEPTS
is obtained, as discussed in subsequent chapters. Among the boundary conditions
that are automatically included are the following:
Structural and stress analysis
Concentrated surface forces
Distributed surface forces (tractions)
Thermal analysis (heat conduction)
Convection
Radiation
Applied heat fluxes
Insulation
Fluid flow analysis
Pressure gradients
Velocity gradients
In all cases, these conditions need not be constant. When these boundary
conditions or other properties are a function of the (unknown) field variable, the
problem becomes nonlinear. Special solution techniques, one of which is discussed
in Chapter 8, must be applied in these cases. The basic finite element method is
applicable, however, for both linear and nonlinear problems.
Another advantage is that higher-order elements may be implemented with
relative ease. Several higher-order elements are shown in Fig. 1-10. Higher-order
elements require the use of higher-order interpolating polynomials. Note that ad-
ditional nodes are introduced along the sides of the two-dimensional elements and
between the two end nodes of the one-dimensional element. In fact, by using
isoparametric elements defined in Chapter 9, curved sides may actually be used
thereby allowing very close fits to essentially all irregular geometries. Occasionally,
interior nodes are introduced as shown in Fig. 1-10. The use of these nodes requires
special considerations as discussed in Chapter 9.
Among the disadvantages of FEM is the necessity for a digital computer and
fairly extensive software. In fact, the MacNeal-Schwendler version of NASTRAN
[I] has more than 430,000 lines of FORTRAN source code. Of course, such a large
general program need not always be used. More specific and significantly smaller
programs may be all that are needed in some applications. The programs included
in the appendices of this book are provided mainly for educational purposes, but
on occasion they may be used to solve small practical problems.
A couple of obvious questions have probably arisen. The first is whether or
not the finite element method is more accurate than the finite-difference method.
We cannot answer this question without a significant number of qualifications, but
FEM seems to be more accurate when curved boundaries are present. By referring
to Fig. 1-9 again, we can see why this is not really surprising: the finite element
method can usually include the curved boundary more precisely than the finite-
difference method can.
The second question that may be asked pertains to the relative execution times
of typical and comparable FDM and FEM models. Once again it is difficult to
make comparisons, but FEM seems to have longer execution times. However, it

(a)
BRIEF HISTORY OF FINITE ELEMENT METHOD
13
(c)
(b)
(d)
(e)
Figure 1·10
Representative higher-order elements. (a) One-dimensional elements. (b)
Two-dimensional triangular elements with straight sides. (c) Two-dimensional triangular
element with curved sides. (d) Two-dimensional rectangular elements with straight sides.
(e) Two-dimensional quadrilateral element with curved sides.
must be said that FDM models will generally require more hours of computer input
preparation by people than will FEM. As will be seen in subsequent chapters, many
of the tedious calculations in FEM are relegated to the computer. For example, in
a thermal application, internal conductances need not be calculated in FEM models
because they are inherently included in the computer software. On the other hand,
FDM thermal models quite frequently require the user to calculate many of the
internal conductances by hand. This will become an even more significant advantage
of FEM as engineering labor costs rise and computational costs decline.
1-6
BRIEF HISTORY OF THE FINITE ELEMENT METHOD
An early but crude application of finite elements was presented in Sec. 1-3 where
the value of 1T was determined by the method of exhaustion. However, the finite

14
GENERAL CONCEPTS
element method used today was developed to its present state very recently. Ac-
cording to Zienkiewicz [9], the development has occurred along two major paths:
one in mathematics and the other in engineering. Somewhere in between these two
extremes are the variational and weighted residual methods, both of which require
the use of trial functions to effect a solution. The use of these functions dates back
almost 200 years.
A trial function is an assumed mathematical function that is usually based on
physical intuition, is applied globally to the region being analyzed, and approximates
the expected behavior of the region to some external forces. These functions are
used in various types of integral formulations [10], described in detail in Chapter
4. A qualitative example may help to clarify these abstract points.
Let us consider again the heat conduction problem in a rectangular plate. If
the temperature is known to be zero along the boundaries of the plate and a maximum
at the center based on physical reasoning, then one or more trial functions could
be chosen that exhibit this known trend. Such a method is rather limited for two
reasons: (I) the trial functions must satisfy the boundary conditions exactly, and
(2) the trial functions must be chosen based on physical reasoning. In other words,
it is very difficult to apply this method to any but the simplest of problems.
As indicated earlier in this chapter, the finite element method is predicated
along the same lines with an important exception: the trial functions are not applied
globally to the entire region being analyzed but only locally (i.e., on an element
basis). This point is of paramount importance, since the method becomes applicable
to real problems with irregular geometries and unknown solutions. This important
step did not occur until 1943 when Courant [II] introduced piecewise continuous
trial functions. But this is getting ahead of the story, which begins in 1795.
As mentioned earlier, the use of trial functions is associated with neither the
purely mathematical nor the engineering developments. In a paper by Gauss [12J
in 1795, trial functions (on a global basis) were used in what is now called the
method of weighted residuals. Later, these functions were used in variational meth-
ods by Rayleigh [I3J in 1870 and by Ritz [141 in 1909. In fact, any variational-
based approximate solution method is frequently referred to today as the Rayleigh-
Ritz method. In a landmark paper in 1915, Galerkin [15J introduced a particular
type of weighted residual method, which to this day bears his name, the Galerkin
method. However, all of these early uses of trial functions were done on a global
basis.
In 1943, Courant [II J introduced piecewise continuous trial functions. As the
name suggests, these functions were not applied globally to the entire region being
analyzed but rather to many small regions or elements. By using trial functions on
a local basis, Courant greatly extended the applicability of trial functions in obtaining
approximate solutions to real-world problems. Many feel that the finite element
method has its roots in this paper by Courant, although he did not introduce the
terminology finite element.
Along more mathematical lines, the finite-difference method was introduced
by Richardson [16] in 1910 and later improved by Liebman [17 J in 1918 and
Southwell [18 J in 1946. Variational finite differences were developed by Varga

REMARKS
15
[19] in 1962. These mathematical developments lead directly to the present-day
finite element method, and it may now be said that the finite-difference method is
a special case of the more general finite element method [20].
In the early 1940s, aircraft engineers were developing and using analysis meth-
ods that are now recognized as early forms of the finite element method. The first
applications used the so-called force matrix method (also known as the redundant
force method). In this method, the nodal unknowns are the forces, not the dis-
placements. When the displacements of each node are taken as the unknowns, the
method is called the stiffness method.
However, the stiffness method was not developed until 1953 in an important
paper by Levy [21]. Other key contributors were Schuerch [22] also in 1953; Argyris
and Kelsey [23] in 1955; and Turner, Clough, Martin, and Topp [24] in 1956. In
a paper in 1960, Clough [25] first introduced the term finite element. Readers
interested in the historical details of the development of the finite element method
along the structural engineering lines are referred to the book by Martin and Carey
[26] in which a fascinating account is given.
The application of the finite element method to nonstructural problems has an
equally interesting history. Among the first to apply the method to general problems
described by Laplace's and Poisson's equations were Zienkiewicz and Cheung [27]
and Visser [28] in 1965. The application at this particular time happened to be
conduction heat transfer, but it was immediately recognized that the procedure was
applicable to all problems that could be stated in a variational form.
Other researchers, such as Szabo and Lee [29], showed how the method of
weighted residuals, particularly the Galerkin method, could be used in the study
of nonstructural applications to retain the basic finite element process. Zienkiewicz
[30] in 1971, in a second edition of an earlier book, was evidently the first to
include in one book the general applicability of the finite element method to problems
describable by ordinary and partial differential equations, or field problems in
general. Field problems include all the problems normally associated with the
continuum. Zienkiewicz's third edition [31] of the same book in 1977 is an out-
standing example of the level of maturity that the finite element method now enjoys.
Since the second edition of Zienkiewicz's book, numerous other books have ap-
peared; those that have not already been cited are included in references 32 to 46.
Interestingly, the present-day finite element method does not have its roots in
anyone discipline. The mathematicians continue to put the finite element method
on firm theoretical ground, and the engineers continue to find interesting applications
and extensions in many branches of engineering. These concurrent developments
have made the finite element method one of the most powerful of the approximate
solution methods.
1-7
REMARKS
In this chapter some of the more important introductory concepts were developed.
The basic finite element method was introduced by contrasting it to the more familiar

16
GENERAL CONCEPTS
finite-difference method. The notion of discretization, which is critical to the use
of the finite element method, was introduced. The advantages and disadvantages
of the method were also discussed. The use of trial functions, particularly on a
local (or element) basis, was also introduced.
It cannot be emphasized enough that it is the notions of discretization and the
use of local trial functions (or interpolating polynomials) that make the finite element
method applicable to real-world problems with irregular geometries, heterogeneous
and anisotropic materials, mixed boundary conditions, and so forth. Although these
concepts may seem abstract to the uninitiated, they will undoubtedly become much
more familiar in subsequent chapters.
The reader will be exposed further to discretization beginning with Chapter 3
and to global and local trial functions beginning with Chapter4, where the variational
and weighted residual methods are also formally introduced. Because the direct
approach is taken, trial functions are not needed in Chapter 3 in which the two-
dimensional truss model is developed. Our study begins in Chapter 2 with a review
of some of the more important mathematics needed in the development of the truss
model.
REFERENCES
I. MSCINASTRAN. User's Manual, MacNeal-Schwendler Corp .. Los Angeles. 1979.
2. STARDYNE [or Scope 3.4 Operating System, User Information Manual, Cybernet Ser-
vices. Control Data Corp .. Minneapolis. Minn., 1978.
3. Kolbe. R. L.. and K. K. Kimble. "The Development and Usc of a Two-dimensional
Finite Element Program for Incompressible-Viscous Flow Through a Complex Internal
Geometry." Int. Congr. Technol . Technol, Exchange. Pittsburgh, Pa., May 3-6, 1982.
4. Macropaedia, "Eudoxus of Cnidus." Encyclopaedia Britannica, vol. 6, pp. 1021-1022,
1981.
5. Macropaedia." Archimedes," Encyclopaedia Britannica. vol. I. pp. 1087-1088, 198/.
6. Demonstration Program. FORTRAN-80 User's Guide. Microsoft FORTRAN-80/iJr the
Apple /I Computer, Microsoft Consumer Products, Bellevue, Wash ..
iJ 1980.
7. Myers, G. E.. Analytical Methods in Conduction Heat Transfer. McGraw-Hill. New
York, 1971, pp. 310-313.
8. Zicnkiewicz, 0, c., The Finite Element Method, McGraw-Hili (UK), London. 1977.
pp. 430-432.
9. Zienkiewicz, O. c., The Finite Element Method. McGraw-Hill (UK), London, 1977,
pp. 3-4.
10. Arpaci, V. S., Conduction Heat Transfer, Addison-Wesley. Reading. Mass .. 1966. pp.
59-83.
II. Courant, R.. "Variational Methods for the Solution of Problems of Equilibrium and
Vibrations." Bull. Am. Math. Soc., vol. 49, pp. 1-23. 1943.
12. Gauss, C. F., Carl Friedrich Gauss Werks, vol. VII, Gottingen. Germany. 1871.
13. Lord Rayleigh, "On the Theory of Resonance." Trans. Roy. Soc. (London). vol. A161,
pp. 77-118. 1870.
14. Ritz. W.. "Uber cine neue Methode zur Losung gewissen Variations-Probleme der
mathematischen Physik." J. Reine Angell'. Math., vol. 135. pp. 1-61, 1909.

REFERENCES
17
15. Galerkin, B. G., "Series Solution of Some Problems of Elastic Equilibrium of Rods
and Plates" (in Russian), Vestn. lnzh, Tekh .. vol. 19, pp. 897-908, 1915.
16. Richardson, L. F., "The Approximate Arithmetical Solution by Finite Differences of
Physical Problems," Trans. Roy. Soc. (London), vol. A2lO, pp. 307-357, 1910.
17. Liebman, H., "Die angenaherte Ermittlung: harmonischen, functionen und konformer
Abbildung." Sitzungsber. Math. Physik Kl. Bayer Akad. Wiss. Muchen, vol. 3, pp.
65-75, 1918.
18. Southwell, R. V., Relaxation Methods in Theoretical Physics, Clarendon Press, Oxford,
England, 1946.
19. Varga, R. S., Matrix Iterative Analysis, Prentice-Hall, Englewood Cliffs, N.J., 1962.
20. Zienkiewicz, O. c., The Finite Element Method, McGraw-Hill (UK), London, p. 569,
1977.
21. Levy, S., "Structural Analysis and Influence Coefficients for Delta Wings," J. Aero-
naut. Sci .. vol. 20, no. 7, pp. 449-454, July 1953.
22. Schuerch, H. U.. "Delta Wing Design Analysis," Nat. Aeron. Meeting. Soc. Automot.
Eng .. Los Angeles, Paper No. 141, September 29-0ctober 3, 1953.
23. Argyris, J. H., and S. Kelsey, Energy Theorems and Structural Analysis. Butterworth,
1960 (reprinted from Aircraft Eng .. 1954-1955).
24. Turner, M. J., et al., "Stiffness and Deflection Analysis of Complex Structures," J.
Aeronaut. Sci .. vol. 23., no. 9, pp. 805-824, September 1956.
25. Clough, R. W.. "The Finite Element in Plane Stress Analysis," Proc. Znd ASCE Conf.
on Electron. Computation, Pittsburgh, Pa .. September 1960.
26. Martin. H. C.; and G. F. Carey, Introduction to Finite Element Analysis: Theory and
Application, McGraw-Hill, New York, 1973, pp. 1-13.
27. Zienkiewicz, O. c., and Y. K. Cheung, "Finite Elements in the Solution of Field
Problems," The Engineer, 1965, pp. 507-510.
28. Visser, W., "A Finite Element Method for the Determination of Nonstationary Tem-
perature Distribution and Thermal Deformations," Proc. Conf. Math. Methods Struc.
Mech., Air Force Institute of Technology, Dayton, Ohio, 1965.
29. Szabo, B. A., and G. C. Lee, "Derivation of Stiffness Matrices for Problems in Plane
Slasticity by Galerkins Method." Int. J. Numer. Methods Eng., vol. I, pp. 301-310,
1969.
30. Zicnkiewicz. O. C.. The Finite Element Method in Engineering Science, McGraw-Hill
(UK), London, 1971.
31. Zicnkicwicz, O. c.. The Finite Element Method, McGraw-Hill (UK), London, 1977.
32. Desai, C. S., and J. Abel, Introduction to the Finite Element Method, Van Nostrand-
Reinhold, New York, 1971.
33. Oden, J. T., Finite Elements oj Nonlinear Continua, McGraw-Hill, New York, 1972.
34. Gallagher, R. H., Finite Element Analysis: Fundamentals, Prentice-Hall, Englewood
Cliffs, N.J., 1975.
35. Norrie, D. H., and G. de Vries, The Finite Element Method, Academic, New York,
1973.
36. Robinson, J.. Integrated Theory of Finite Element Methods, Wiley, London, 1973.
37. Huebner, K. H., The Finite Element Method jar Engineers, Wiley, New York, 1975.
38. Bathe, K.-J., and E. L. Wilson, Numerical Methods in Finite Element Analysis. Prentice-
Hall, Englewood Cliffs, N.J .. 1976.
39. Segerlind, L. J., Applied Finite Element Analysis, Wiley, New York, 1976.
40. Tong, P., and J. N. Rossettos, Finite-Elemellt Method: Basic Technique and Imple-
mentation, MIT Press, Cambridge, Mass., 1977.

18
GENERAL CONCEPTS
41. Norris. D. H.. and G. de Vries. An Introduction to Finite Element Analysis. Academic.
New York. 1978.
42. Hinton. E.. and D. R. J. Owen. An Introduction to Finite Element Computations,
Pineridge Press Limited. Swansea. UK. 1979.
43. Cheung, Y. K.. and M. F. Yeo. A Practical tntroduction to Finite Element Analvsis,
Pitman. London, 1979.
44. Desai. C. S., Elementarv Finite Element Method. Prentice-Hall. Englewood Cliffs.
N.J .. 1979.
45. Becker. E. B.. G. F. Carey. and J. T. Oden. Finite Elements: An Introduction. vol. I.
Prentice-Hall, Englewood Cliffs. N.J .. 1981.
46. Bathe. K.-J .. Finite Element Procedures in Engineering Analysis. Prentice-Hall. En-
glewood Cliffs, N.J .. 1982.

2
Mathematical Preliminaries
2-1
INTRODUCTION
Before actually developing the truss model in Chapter 3, a review of the necessary
mathematics is given here. Inall practical finite element analyses, matrix and vector
notation must be used because of the large number of variables and computations
involved.
This mathematical review includes the following topics relating to matrices
and vectors: the definitions of matrices and vectors; matrix and vector equalities;
matrix and vector algebra; transpose, determinant, cofactor, minor, adjoint, and
inverse of a matrix; matrix partitioning; length of a vector; direction cosines; and
solutions to linear systems of equations. Additional review material is presented at
appropriate places throughout the text, usually immediately preceding the appli-
cation of the topic. The matrices and vectors we discuss are always assumed to be
composed of only real elements unless explicitly stated otherwise.
2-2
DEFINITION OF A MATRIX
A matrix is a rectangular or square array of elements or numbers. The use of the
word "element" should not be confused with its use in the phrase "finite element."
The context usually makes the usage clear. An element in a matrix is simply an
entry in the matrix as explained below. The notion of a matrix is more easily
understood by means of a linear system of equations. For example, the system of
equations

20
MATIIEMATICAL PRELIMINARIES
could be written in the compact matrix form
Ax = b
where by definition
b = [:J
(2-1)
(2-2)
The array of elements in the matrix A is a matrix of coefficients. The size (or
dimension) of A is said to be 2 x 3 (or 2 by 3). Note that first the number of rows
is given, then the number of columns is given. The matrix x contains three rows
and one column, and the matrix b two rows and one column. Hence, the matrices
x and b are said to be of size 3 x
I and 2 x
I, respectively.
A column vector is defined as a matrix with only one column. Therefore, x
and b are also referred to as column vectors. A row vector is a matrix with only
one row. An example of a row vector is given by the I x 4 matrix
[I
3
- 2
01
These notions are readily generalized. An m x n matrix is a rectangular array
of elements with m rows and n columns. If m is equal to n, the matrix is said to
be square. Quite frequently, each entry in a matrix may be an algebraic expression,
a derivative, or possibly an integral; it need not always be a pure number. A column
vector is an n x
I array of elements, whereas a row vector is a I x
II array. After
the transpose of a matrix is introduced, the row vector will always be written in
terms of its column vector representation (see Sec. 2-5).
An element or entry in the ith row and jth column of an m x n matrix A is
written aij' The first subscript denotes the ith row and the second subscript the jth
column, where I "" i "" m and I ""j "" II. The ith entry in an n x
I column vector
b may be written as hi' where I "" i "" fl. Similar remarks hold for a I x n row
vector. In general, matrices (where neither m nor n is unity) are denoted with
uppercase English and Greek boldface letters. Column (and row) vectors are denoted
with lowercase English and Greek boldface letters.
Two special types of square matrices are the identity matrix and the null matrix.
The identity matrix is denoted as I or III x /1' and has unity on its main diagonal and
zero elsewhere. For example, the 3 x 3 identity matrix is given by
'.",
[~~~]
The main diagonal always runs from the upper left to the lower right. The null

MATRIX ALGEBRA
21
matrix is denoted as 0 or 0" »:n and, as its name suggests, has only zero elements
or entries. The 2 x 2 null matrix is given by
The equation Ax = b contains the notions of matrix equality and matrix
multiplication. Matrix equality is very easy to define and understand and is reviewed
next.
2-3
EQUALITY OF TWO MATRICES
Two m x n matrices A and B are said to be equal if and only if the corresponding
clements of A and B arc equal. Note that A and B must be of the same size. Stated
differently, two m x
n matrices A and B are equal if and only if aij =
bij for
I ~ i ~ m and I ~ j
~ n.
Example 2-1
Consider the four matrices A, B, C, and D given below and determine which of
the various combinations are equal (taking two at a time);
Solution
A
C
B
D
[3
I]
2
-2
I
0
[i -i]
Only B, C, and D can possibly be equal because they are at least of the same size.
Each element in B is equal to the corresponding element in C; hence B = C.
However, B # D because b21 = 2 and d21 = 8. Since these two elements are not
equal, the corresponding matrices Band D cannot be equal. Similarly, C # D.
Therefore, only Band C are equal.
•
2-4
MATRIX ALGEBRA
In this section the notions of matrix addition and subtraction are discussed. This is
followed by a review of the two types of matrix multiplication and finally a summary
of the commutative, distributive, and associative laws for matrices.

22
MATHEMATICAL PRELIMINARIES
Matrix Addition and Subtraction
Matrix addition (and subtraction) is performed by adding (or subtracting) the cor-
responding elements of two m x n matrices to form a third m x 11 matrix. Let A
and B be two m x n matrices and let the m x n matrices C and D be defined by
C=A+B
and
D=A-B
The matrices A and B are said to be conformable for addition (and subtraction)
because they both have the same number of rows and columns. From the above
definitions, these may be written on an element basis as
and
for
I "" i "" m
and
Example 2-2
For A and B given by
A =
[~
-~ ;J
determine A + B and A-B.
Solution
and
B
First, both A and Bare of the same size so the matrices may be added and subtracted.
The results are
A + B = [
6 + 2
-I + 0
2 + 5J [-~
-I
~J
0+(-8)
3 + 3
5 + 4
6
and
A-B
[
6 -
2
-) -
0
2 -
5J
[:
-I -n •
0-(-8)
3 -
3
5 -
4
0
Matrix Multiplication
Two types of multiplication may be defined: (I) multiplication of a matrix by a
scalar and (2) multiplication of two (or more) matrices. The former is simpler and
is defined first.
Multiplication of a Matrix by a Scalar
Let s be any real scalar and A any m x
11 matrix. The product of s and A, written
sA, is obtained by multiplying every element of A by s. In other words, the elements

MATRIX ALGEBRA
23
of sA are Saij. Note that the product is of size m x
n (such as A itself). This type
of matrix multiplication is commutative; that is, sA = As.
Example 2-3
For the matrix A given in Example 2-2, determine the matrix C defined by 6A.
Solution
•
(2-31
Multiplication of Two Matrices
The product of an m x p matrix A and a q x n matrix B, written AB, is only
defined when p equals q. Furthermore, the matrices A and B are said to be con-
formable for multiplication when p equals q. The matrix A is said to premultiply
B, and the matrix B to postmultiply A.
Let an m x r matrix A premultiply an r x n matrix B to form a third (m x n)
matrix C. The elements of C, or the cij's, are given by
r
cij =
2: aikbkj
k=l
for I ~ i ~ m and I ~ j ~ n. It can be shown that this type of matrix multiplication
is not commutative in general; that is, AB "'" BA. In fact, the product BA may not
even be defined if B and A are not conformable for multiplication (even though A
and B, in that order, are conformable). Another way of checking whether or not
two matrices A and B are conformable for multiplication is to check if the number
of columns of A is equal to the number of rows of B; if they are, AB is defined.
A similar test may be stated for the product BA.
Example 2-4
Given the two matrices A and B, determine if AB and BA are defined; if they are,
compute them. The matrices A and Bare
Solution
A=[ ~~]
-5
3
and
B
14]
42
-35
A is of size 3 x 2 and B is 2 x 2. Therefore, AB is defined and is of size 3 x 2
by 2 x 2 or 3 x 2. Using Eq. (2-3), we get
[
(2)( - 4) + (0)(5)
(2)(7) + (0)(0)]
[ - 8
AB =
(6)( -4) + (4)(5)
(6)(7) + (4)(0)
=
-4
(-5)(-4) + (3)(5)
(-5)(7) + (3)(0)
35

24
MATHEMATICAL PRELlMI~ARILS
On the other hand, BA is not defined because the number of columns of B (in
this case two) is not equal to the number of rows of A (in this case three). The
matrices A and B are conformable for multiplication, but B and A (in this order)
~~.
.
The Commutative, Distributive, and Associative Properties
Let A, B, and C be matrices and let s be a scalar. In the laws summarized below,
it is assumed that the matrices are conformable for addition and multiplication as
the situation warrants.
Commutative laws:
A + B
B + A
(2-4)
sA
As
(2-5)
Distributive laws:
s(A + B)
sA + sB
(2-6)
A(B + C)
AB + AC
(2-7)
(A + B)C
AC + BC
(2-8)
Associative laws:
A
B
A + (-B)
(2-9)
(A + B) + C
A + (B + C)
(2-10)
(AB)C
A(BC)
(2-11)
The proofs of these laws are relatively straightforward and are left to the reader as
exercises (see Problems 2-18 to 2-20). It should be remembered that the product
of two matrices is not commutative, that is, AB ~ BA.
2-5
TRANSPOSE OF A MATRIX
The transpose of an m x n matrix A with elements au is an n x m matrix denoted
as AT (and stated A transpose) whose elements are given by aji' The switching of
the subscripts should be noted. The transpose of a product of two or more matrices
occurs often and an important property is given by
(AB)T = BTA T
(ABC)T = CTBIAT
(2-12)
(2-13)
and so forth. If A = AT (or ail = at,), the matrix A is said to be symmetric. If
A = - AT (or au = - aji), A is skew-symmetric. A skew-symmetric matrix must
have zeros on its main diagonal. Symmetric and skew-symmetric matrices must be
square. The transpose of a column vector is a row vector, and vice versa. From
this point on a lower case boldface letter will always represent a column vector.
The transpose will always be used to indicate a row vector (see Example 2-10).

DETERMINANTS. MINORS. AND COFACTORS
25
Example 2-5
Determine the transpose of
Solution
Since A is 3 x 2, the transpose is 2 x 3 and is given by
AT =
[ 2 I 6]
-I
9
5
Example 2-6
•
Determine if the matrices A, B, C defined below are symmetric, skew-symmetric,
or neither:
H
-I
~]
B ~ [
~
-I
3
~l
0
-6
A
2
-2
6
5
0
4
7
-5
H
I -6]
C
0
-3
3
0
Solution
Since aij
=
aj i for i =
I to 3 and j =
I to 3, the matrix A is symmetric. Since
b31 ¥C b l3 and b3 1 ¥C - b l3 , the matrix B is neither symmetric nor skew-symmetric.
Finally, since cij =
- cji for i =
1 to 3 and j =
I to 3, the matrix C is skew-
symmetric. Symmetric matrices arise quite frequently in finite element analysis.
2-6
DETERMINANTS, MINORS, AND COFACTORS [1]
Consider an n x n matrix A. The determinant of A, written det A, is a scalar
function of A which for n = I, 2, and 3 is given by
det Al x I
det A2 x 2
det A3 x3
(2-14a)
(2-14b)
(2-14c)

26
MATHEMATICAL PRELIMINARIES
Although this pattern can be generalized, it is not a very practical way to evaluate
determinants for n larger than 3. Fortunately, another method exists called the
Laplace expansion method. This method is most easily explained after the minor
and cofactor of a matrix are defined.
The minor Mij of a square matrix A is the determinant of the n -
I x n -
I
matrix derived from A by eliminating the ith row and the jth column of A. Such
as the determinant itself, the minor is also scalar-valued and is only defined for
square matrices. An n x n matrix A contains n2 minors.
The cofactor Cij of a matrix A is easily defined in terms of the minor Mij by
Ci/
=0 (- I)' +iMij
(2-151
Note that when i + j is even, the cofactor and minor are identical; when i + j is
odd, the cofactor and minor differ only in the signs. An n x n matrix A has n 2
cofactors.
The determinant of the original n
X Il matrix A may now be computed utilizing
the notion of the cofactor by selecting any arbitrary column j and using
n
det A
=0 2 ak,Ckj
k=1
An equivalent expression for evaluating the determinant is given by
n
det A
=0
2 a,mC;m
m=\
(2-161
(2-17l
where row i is selected for the expansion. Although these expressions look for-
midable, they are not difficult to apply in practice, as shown in Example 2-7.
Equations (2-16) and (2-17) are used repeatedly until determinants of matrices of
size 2 x 2 need to be evaluated, at which point Eq. (2-14b) is used (see Example
2-7). This method of evaluating the determinant of a matrix is known as the Laplace
expansion method.
Example 2-7
Using the Laplace expansion method and expanding with respect to the second row,
find the determinant of A where
A
[;
~
=~]
-I
2
-3
Solution
The three minors associated with the second row are
-6J
-3

ADJOINT AND INVERSE OF A MATRIX
27
Each of these 2 x 2 determinants may be evaluated with the help of Eq. (2-14b)
to give
M2I
= 0
The corresponding cofactors are
C2I = (-1)2+1(0) = 0
and
-12
8
-12
C2)=(-I)2+3(8)
-8
Therefore, the determinant of A is given by
detA = (3)(0) + (1)(-12) + (-5)(-8) = 28
Try to evaluate the determinant of A by expansion with respect to another row or
~~.
.
2-7
ADJOINT AND INVERSE OF A MATRIX [1]
The adjoint (adj) of an n
X n matrix A, denoted as adj(A), is easily defined in
terms of the transpose of the cofactor matrix C. Stated mathematically,
adj(A)
= C T
(2·181
The adjoint itself is another n x n matrix and is particularly useful in providing a
concise expression for the inverse of a matrix as described below.
The inverse of an n X n matrix A, denoted as A- I (and stated A inverse), is
another n x n matrix such that
where I is the n x n identity matrix. In other words, the inverse of an n X n
matrix A is another n x n matrix such that when it is both premultiplied and
postmultiplied by A itself, the result is the n x n identity matrix. In terms of the
adjoint, the inverse of A is given by
adj(A)
det A
(2-191
If the determinant of A is zero, then A - I does not exist and A is said to be singular.
When the determinant of A is nonzero, the inverse of A is unique and A is said to
be nonsingular. The inverse is only defined for square matrices. When Eq. (2-19)
is applied to a nonsingular 2 x 2 matrix A, the inverse is given by
A-I = _1_ [
a22
det A
-a21
(2-201

28
MATHEMATICAL PRELIMINARIES
where det A is given by Eq. (2-14b). A useful identity is given by
(AB) - 1 = B-1A-I
(2-21)
providing A and B are both square, of the same size, and nonsingular. Similarly,
if in addition C is also square, of the same size, and nonsingular, then
(2-22)
The identities given by Eqs. (2-21) and (2-22) may be readily extended to products
involving four or more matrices. If A-I = AT, then the matrix A is said to be
orthogonal. Orthogonal matrices will arise quite naturally in Chapter 3.
Actually, Eq. (2-19) is not a very practical way to evaluate an inverse. A more
practical method is based on Gauss-Jordan elimination (see Chapter 6). In addition,
computer programs or subroutines abound that may be used effectively to compute
inverses of rather large matrices. One such subroutine is given in Appendix B
(subroutine INVDET) [21.
Example 2-8
Evaluate the inverse of A where
Solution
By Eq. (2-20), A -I is computed as follows:
A-I =(2)(4)
1(-3)(8)[~
-~]
Example 2-9
Compute the inverse of A which is given by
A = [~
~]
•
Solution
Since det A
0, A - I does not exist. The matrix A is singular.
•
2-8
MATRIX PARTITIONING
It is always possible to subdivide or partition matrices into a number of smaller
submatrices. If the submatrices are conformable, they may be treated as though
they are scalar elements when adding, subtracting, or multiplying two matrices.

MATRIX PARTITIONING
29
The order of the products is not arbitrary, however, as it is if the elements are truly
scalars. For example, let us compute the product of A and B to form C in two
different ways:
or
C
AB
The subdivisions of A and B must be chosen in order to ensure that the products
such as AIB j and AliBI are meaningful (i.e., the submatrices must be conformable).
Stated differently, the number of columns in Al must equal the number of rows in
B I , etc. Matrix partitioning is not introduced here to provide an alternate means of
multiplying two matrices. In Chapter 3, matrix partitioning arises quite naturally
when the element stiffness matrix is developed for a two-dimensional truss.
2-9
DEFINITION OF A VECTOR
Let us initially restrict our definition of a vector to that in a three-dimensional space
in which a vector is a directed line segment with a unique length (magnitude) and
direction as shown in Fig. 2-1. It is convenient to resolve a vector into its three
components along three mutually perpendicular axes. These axes establish a co-
ordinate system, and since they are mutually perpendicular they are said to be
orthogonal. For example, a vector v may be written with respect to a cartesian
reference frame in terms of its three components V"
V"
V, as
where i, J. and k are the three unit vectors along the x, y, and z axes, respectively.
A unit vector has a length of unity (see Sec. 2-11) and is directed along its associated
coordinate axis. Figure 2-1 shows a cartesian reference frame and the three unit
vectors.
A vector is often written in column matrix form as mentioned in Sec. 2-2. For
example, the vector v may be written as
Often numerical subscripts, as shown above, prove to be more convenient than
letter subscripts. In this text, a matrix represented by boldfaced lowercase letters
(e.g., v) will denote a column matrix (or simply a vector). In order to indicate a
row matrix, the transpose will be used. In other words, vT represents a row matrix,
whereas v represents a column matrix (or a vector). There are two reasons for this

30
MATHEMATICAL PRELIMINARIES
y
k~~":-------
Figure 2-1
Vector v in a cartesian reference frame.
convention: the first is that it removes any ambiguity in matrix expressions developed
later, and the second is that it conserves space in writing the vector out, as the next
example illustrates. It is important to recognize that all vectors may be written in
matrix form (as a column matrix), but not all matrices have a vector meaning.
Example 2-10
Write v in matrix form where
v
Ii -
4j + 3k
Solution
In column matrix or column vector form,
which in tum may be written as
y1
[I
-4
3]
or as
v = [I
-4
31 1
Clearly these all convey the same information, but the second two forms require
fewer lines.
•
Although the notion of a vector was introduced from a geometrical point of
view, vectors need not have only three components. In later chapers, vectors with
four or more components will naturally arise.

EQUALITY OF TWO VECTORS
31
2-10
EQUALITY OF TWO VECTORS
Two vectors u and v are equal if and only if their respective components are equal
and if they are both written with respect to the same coordinate system. If u and
v are given by
u = u) + u,.j + u,k
and
v -
v.l + vJ + v.k
and if v
u, then
u,
u,
V.r
v,
since both are assumed to be written with respect to the same xyz coordinate system.
2-11
LENGTH OF A VECTOR
A vector that is directed from the origin of the coordinate system to another point
is said to be a position vector. In Fig. 2-2, the position vectors p and q, which are
directed from the origin to the points P and Q, respectively, are shown. If point P
has coordinates (PI' P2' P3) and Q has coordinates (q!, q2, q3), then p and q are
given by
~---------x
Figure 2-2
Vector v defined in terms of the position vectors p and q.

32
MATHEMATICAL PRELIMINARIES
and
q
= qji + qcj + q,k
From Fig. 2-2, it is noted that p + v = q (see Sec. 2-12) and so
v = q -
p = (ql -
PI)i + (qc
-
Pc)j + (q, -
p,)k
Based on geometrical considerations. the length of the vector v, denoted as [v], is
given by
/2-23)
Although Eq. (2-23) is based on geometrical considerations in three dimensions.
the notion of vector length may be readily extended to multidimensional space (sec
Problems 2-41 and 2-42).
Example 2-11
Compute the length of the vector that runs from point Pat (3. -4,6) to point Q at
(2,5. -7).
Solution
The vector v is easily determined as
v = q -
p = [2
~ 3ji + [5 - (-4)]j + [-7 -
6jk
or
v =
- Ii + 9j -
13k
The length of v is now calculated from Eq. (2-23) as
Ivl
= V(-I)c + (9)" + (-13)2
2-12
VECTOR ALGEBRA
15.8
•
Vector algebra includes the notions of vector addition and subtraction. as well as
two types of vector multiplication. In this chapter only one type of vector multi-
plication, the dot product. is needed and thus reviewed. The other type is reviewed
in later chapters.
Two vectors are simply added component by component to obtain the vector
sum, provided the vectors are written with respect to the same coordinate system.
The rules for vector addition and subtraction are identical to those presented in Sec.
2-4 for matrix addition and subtraction. Addition of two vectors is frequently given
a geometrical interpretation by using the parallelogram law. However. simple ad-
dition of the respective components is generally more useful in this text.
The dot product of two vectors p and q is denoted as p'q and is a scalar defined
by

VECTOR ALGEBRA
33
p-q
= Ipllql cos Ct
(2-24)
where Ct is the smaller angle included between p and q. Equation (2-24) implies
and
H
= rJ
= k-k =
I
i-] = j·k = k·i
= 0
(2-25)
(2-26)
With the help of Eqs. (2-25) and (2-26), p-q may be given in terms of the cartesian
components as
P'q = Plq, + P2q2 + P3Q3
which in turn can be written as
(2-27)
(2-28)
Therefore, the dot product of P and q is frequently written in matrix form as pTq.
The dot product is also frequently referred to as a scalar product and an inner
product.
Example 2-12
Given the vectors p and q from Example 2-11, determine p + q, P -
q, and P'q.
Solution
From Example 2-11, we have
P
3i -
4j + 6k
and
q = 2i + 5j -
7k
Therefore, the required results are
p + q
5i + Ij
lk
P -
q =
Ii -
9j + 13k
and
P'q
(3)(2) + (- 4)(5) + (6)( -7)
-56
•
2-13
DIRECTION COSINES
The direction cosines of a vector v are defined as the cosines of the angles formed
by the vector v and the three coordinate axes. Figure 2-3 shows a vector v in two

34
MATHEMATICAL PRELIMINARIES
Figure 2-3
The cosines of the angles lXI and lX, are the direction cosines.
dimensions. The angles that v makes with the x and y axes are <XI and <X2' respec-
tively. From Fig. 2-3 and the notion of the dot product, it follows that
v·i = Ivllil cos <XI
But v·i
I, and solving for cos <XI gives
(2-29a)
(2-29b)
In a similar fashion, it is readily shown that
V2
cos <X2 = ~
In three dimensions, if <X3 is the angle between a vector v and the z axis, then in
addition to the above, we have
12-29c)
In general, the direction cosines are not all independent and are related by the
following:
(2-30)
The simple proof is left to the reader (see Problem 2-49).
Example 2-13
For the vector v in Example 2-11, determine the three direction cosines and verify
that Eq. (2-30) is satisfied.

DIRECTION COSINES
35
Solution
From Eq. (2-29), we compute
from which we get
-I
15.8
9
15.8
-13
15.8
-0.0633
+0.570
-0.823
Equation (2-30) is readily verified once (Xl' (X2, and (X3 are known.
•
2-14
SOLUTION TO SYSTEMS OF LINEAR ALGEBRAIC EQUATIONS
In all static stress analysis and other steady-state applications, a system of linear
algebraic equations of the form
Ka = f
(2-31)
will have to be solved for the vector a. The system of equations implied in Eq.
(2-31) may be solved by many methods, but only the matrix inversion method is
reviewed here. Chapter 6 contains a more practical method based on Gaussian
elimination.
The solution to Eq. (2-31) by the matrix inversion method is straightforward.
If both sides of Eq. (2-31) are premultiplied by the inverse of the n X n matrix K
(assuming the inverse exists) and if it is noted that K -IK = I and Ia = a, then
an explicit expression for a results and is given by
(2-32)
Unfortunately this method is not very practical in large problems because of the
time consumed (even by a computer) in obtaining the inverse. Nevertheless, it
provides a concise expression for the solution to Eq. (2-31). As mentioned in Sec.
2-7, the inverse of a matrix is most readily performed by a subroutine on a digital
computer. Such a subroutine (subroutine INVDET) may be found in Appendix B.
Equation (2-32) simply states that to obtain a (which may be the nodal displace-
ments, temperatures, velocities, pressures, etc.), we simply invert K and post-
multiply this result by the vector f (which is known).

36
MATIIEMATICAL PRELIMINARIES
Example 2-14
Determine the solution to the following system of linear algebraic equations:
Solution
From the matrix representation, we have
8x,
X,1
5
22
16
K =
[
~
-7
-3
4
8
-~]
-I
and
from which K - I is computed (using subroutine INVDET) to be
[
- 0.52632
0.02632
-0.21053]
K- 1 =
-0.50877
0.00877
-0.07018
- 0.38596
- 0.11404
- 0.08772
The solution for XI' X2' and X3 is then easily computed from Eq. (2-32) by a simple
matrix multiplication to be
XI
-5.421
X2
- 3.474
X3
- 5.842
The reader should verify these by direct substitution into the original system of
~d~.
•
It should be mentioned that K will always have an inverse for well-posed
problems solved by the finite element method. Therefore, the questions as to whether
the system of equations represented by Eq. (2-31) has one solution, no solution,
or several solutions do not arise. For well-posed problems, Eq. (2-31) has only one
solution for a and therefore the solution is unique. One solution method applicable
to nonlinear algebraic equations is described in Chapter 8. The reader may wish to
consult references 3 to 12 for additional material relating to matrices and vectors.
REFERENCES
I. Brogan, W. L., Modern Control Theon'. Quantum, New York, 1974, pp. 45-48.
2. Hornbeck, R. W., Numerical Methods. Quantum. New York, 1975.
3. Bellman, R. E.. Introduction to Matrix Analysis, 2nd ed., McGraw-Hili, New York,
1970.
4. Bronson. R.. Matrix Methods-An Introduction, Academic. New York, 1969.

PROBLEMS
37
5. Campbell. H. G.. Matrices with Applications. Appleton-Century-Crofts. New York.
1968.
6. Franklin. J. H.. Matrix Theory. Prentice-Hall. Englewood Cliffs. N.J .. 1968.
7. Fuller. L. E.. Basic Matrix Theory. Prentice-Hall. Englewood Cliffs. N.J .. 1962.
8. Hohn, F. E.. Elementary Matrix Algebra. 3rd ed .. Macmillan. New York. 1973.
9. Moore. J. T.. Elements ofLinear Algebra and Matrix Theory. Mcfiraw-Hill, New York.
1968.
10. Pipes. L. A.. Matrix Methods/or Engineering. Prentice-Hall. Englewood Cliffs. N.J ..
1963.
11. Schneider. H.. and G. P. Barker. Matrices and Linear Algebra. Holt, Rinehart and
Winston. New York. 1968.
12. Stein. F. M.. Introduction to Matrices and Determinants, Wadsworth. Belmont. Calif..
1967.
PROBLEMS
2-1
Represent the following systems of equations in the matrix form Ax
b:
a.
2.1'] + 3X2
4
-5x] + 6x,
-6
b.
-8.1'] + 3x, + 6x)
-9
4X2
5x,
6
x)
5
C.
4.1']
5X2 + 6x)
5
2x] + 5X2
x)
2
2-2
Express the following systems of equations in matrix form:
a.
3x] + 4.1'2 +
x,
= 6
2.1'2
t«,
= -2
-8x] + 6x, +
x,
=
0
b. 6.1'] + 5X2 + 3x) +
X.j
10
7.1'] + 3X2
6x.j
-7
2-3
What is the 6 x 6 identity matrix and the 4 x 4 null matrix?
2-4
For the matrices A and 8 given below. determine if A and 8 are equal:
a. A
b. A
c. A
8
B
B
[-~
~]
[-~
~]
[j n

38
MATHEMATICAL PRELIMINARIES
2·5
Which of the matrices given below are equal (taking two at a time)?
A= [~
-~]
B = [~
-8 -;]
6
C
[~
-~]
D
[~
-8 -;]
6
E = [~
~]
F [-~ J]
2-6
For the matrices in Problem 2-5, determine the sums and differences indicated below.
If the matrices are not conformable for addition or subtraction, so state this.
a. A + B
e. B + D
b. A
C
f.
C + E
C. A - D
g. D + F
d. A + E
2-7
Repeal Problem 2-6 for the following sums and differences:
a. B + C
e. C + D
b. B -
C
f.
E -
E
c. B -
D
g. F + F
d. C -
E
2-8
For the matrices of Problem 2-5, determine
a.5A
b. -7B
c. 8C
d. OD
e. -2E
f.
5F
2-9
Repeat Problem 2-8 for
a.
-7A
b. OB
c. -C
d. 8D
e.4E
f.
OF
2-10
For the matrices of Problem 2-5. determine the following products. If the matrices
are not conformable for multiplication, so state this.
a. AB
b. AC
c. DA
d. DF
e. FD
2-11
Repeat Problem 2-10 for the following products:
a. CB
b. BC
c. CE
d. EF
e. FE
2-12
What is the size (or dimensions) of the matrices given in Problem 2-5'1
2-13
What is the size of each of the products in Problem 2-10'1
2-14
What is the size of each of the products in Problem 2-11'1
2-15
For the matrices in Problem 2-5, show that
a. A + E = E + A
b. 6D = D6
c.
F(A + E)
= FA + FE
d. C -
E = C + (- E)

PROBLEMS
39
2·16
For the matrices of Problem 2-5, show that
a, B + D = D + B
b. 8(C + E) = 8C + 8E
c. (B + D)F = BF + DF
d. (A + C) + E = A + (C + E)
2-17
For the matrices of Problem 2-5, show that
a. 5(A + C) = 5A + 5C
b. BF "" FB
c. (BF)A
= B(FA)
d. AE"" EA
2-18
By writing the matrices on an element basis (e.g., C is denoted as Ci), prove the
commutative laws given by Eqs. (2-4) and (2-5).
2·19
Prove the distributive laws given by Eqs. (2-6) to (2-8) by writing each matrix on
an clement basis.
2-20
Prove the associative laws given by Eqs. (2-9) to (2-11).
2-21
Consider the matrices given below:
A = [~
-~]
[-~
-7
-n
B
3
5
[-~
4
-~]
[~
-~]
C
0
D=
-3
[-;
6 -3
-iJ
[-~
5 -6]
E =
2
5
F
0
-3
5
-8
4
-2
3
-2
G = [~
-3
~]
4
a. Which matrices are symmetric? Why')
b. Which matrices are skew-symmetric? Why')
2·22
For the matrices of Problem 2-21, determine
c. FT
2-23
For the matrices of Problem 2-21, determine
a. C T
b. DT
2·24
For the matrices of Problem 2-21, show that
a. (AD)T = DTAT
b. (GBFl = FBTG T
c. DT = D

40
MATIIEMATICAL PRELIMINARIES
2-25
For the matrices of Problem 2-21, show that
a, (BC)T = CIBT
b. C = -C I
C, (ADG)T
= GIDIA I
2-26
Prove for all symmetric matrices M that pIMP is also always symmetric, where P
is not necessarily symmetric (but conformable).
2-27
Using Eqs. (2-14) and the matrices from Problem 2-21. determine
a, dct A
b. det B
2-28
Repeat Problem 2-27 for
a. dct D
b. dct E
2-29
For the matrix A of Problem 2-21. determine the following:
a.
The matrix formed by the minors of A
b. The matrix formed by the cofactors of A
c.
The adjoint of A
d. The determinant of A
e.
The inverse of A
2-30
Repeat all parts of Problem 2-2<) for the matrix D of Problem 2-21.
2-31
Repeat all parts of Problem 2-2<) for the matrix B of Problem 2-21.
2-32
It may be shown in general that if A and B are both square and of the same size,
then det(AB) =
(det Ajrdct B). For the matrices A and D of Problem 2-21. show
that det(AD) = (dct Audc: D).
2-33
Repeat Problem 2-32 for matrices Band C of Problem 2-21.
2-34
Write the following vectors as column vectors:
a. p
3i -
2j + 19k
b. q =
-8i + 6j
c. r
= 6i + 28k
2-35
Write the column vectors implied in Problem 2-34 as row vectors (by using the
transpose) .
2-36
For the vectors given below. determine which are equal (taking two at a time):
p =
3i
6j + 4k
q
5i + 7k
r
5i + 7j
s
= 3i
6j + 4k
u
7i
8j + 15k
v
7i -
8j + 15k
2-37
For the vectors p. q. and u from Problem 2-36. determine
a. Ipl
b. jql
c. lui

PROBLEMS
41
2-38
For the vectors r , s, and v from Problem 2-36, determine
a. [r]
b. lsi
c. Ivl
2-39
A vector v is directed from point P at (3, - 2,5) to point Q at (7, - I, - 3) in a
cartesian frame of reference.
a. Determine the position vectors for both points.
b. Determine the vector v.
c. Calculate the length of v.
2-40
A vector u is directed from point R at (- 5.4,2) to point S at (0,6,7) in a cartesian
frame of reference.
a. Determine the position vectors for both points.
b. Determine the vector u.
c. Determine the length of u.
2-41
By a direct extension of Eq. (2-23), show that the length of v may be computed from
Ivl = w;
for three-dimensional vectors. The result is, in fact, valid for n-dimensional vectors.
2-42
By using the result of Problem 2-41, compute the lengths of u and v where
a. u = [6
-5
0
4
2jT
b. v = I- 1
2
5
- 3
6
7jT
2-43
For the vectors p, r , and v from Problem 2-36, determine
a. p + r
d. v -
p
b. p -
r
e. p-r
c. r + v
f. r-v
2-44
For the vectors q, s, u, and v of Problem 2-36, determine
a. q + S
d. u -
v
b. S -
u
e. u·v
C. U + v
f. q-u
2-45
For the vectors p, r , and v of Problem 2-36, determine the angle between
a. p and r
b. r and v
Hint: Use Eq. (2-24) with the help of Eq. (2-28).
2-46
For the vectors q, u , and v of Problem 2-36, determine the angle between
a.
U and v
b. q and U
2-47
Determine the direction cosines of the vectors p, q, and r from Problem 2-36 and
verify that Eq. (2-30) is satisfied in each case.
2-48
Determine the direction cosines of the vectors sand u from Problem 2-36 and verify
that Eq. (2-30) is satisfied in each case.
2-49
Prove that the sum of the squares of the direction cosines is unity [Eq. (2-30)]. Hint:
Use Eqs. (2-29) and the definition of the length of a vector.

42
MATHEMATICAL PRELIMINARIES
2-50
Solve the following systems of equations by the matrix inversion method:
a. 3xI + 5X2
=
- 6
2x, -
4X2 = 5
b.
6x 1
3X2
5
- 3xI + 5X2 = 3
2-51
Using the matrix inversion method. solve the following systems of equations:
a. 5xI
6X2
7
3xI + 7X2
8
b. 5xI + 2X2 + 3x,
5
2x, + 3X2 + 4x,
7
3xI + 4X2 + 5x,
9

3
Truss Analysis:
The Direct Approach
3-1
INTRODUCTION
One of the most important practical types of engineering structures is the truss. A
truss may be defined as a structure that is composed of straight members connected
at the joints by smooth pins. Smooth pin joints cannot support a moment. A typical
truss is shown in Fig. 3-I. As shown in this figure, external loads such as P and
Q may act only at the joints. A truss must be restrained in some manner so that it
does not undergo free-body motion when loaded. The truss in Fig. 3-1 is restrained
by a pin joint at A and a roller joint at B. The reader may wish to consult a statics
textbook, such as Beer and Johnston [I], for a review of the various types of
supports.
Q
Figure 3-1
A typical two-dimensional truss.
43

44
TRUSS ANALYSIS, THE DIRECT APPROACH
Each member in the truss can only support axial loads, which implies that
lateral loads may not act between two joints. All loads, therefore, must act at the
joints. Moreover, members in a truss are connected only at their extremities; hence,
members may not be continuous through a joint. In Fig. 3-1, for example, there
are two distinct members, CD and DE, and not one member, CEo A truss is said
to be rigid if it does not collapse when loaded. A rigid truss, however, may and
will deform slightly under the action of one or more loads. The most common types
of trusses are shown in Fig. 3-2.
In this chapter, the finite element formulation of a two-dimensional truss is
developed. The direct approach, which does not require the use of variational
principles, virtual work principles, or weighted residual methods, is taken. The
main purpose for considering this type of problem is to demonstrate how the direct
approach is used and to provide a step-by-step illustration of the finite element
~~~
Pratt
Howe
ltuk
rur
~~~
Pratt
Howe
Wam-u
(hi
Stadium
~
,,,
Cantilever portion
of a truss
""~
Figure 3·2
Typical trusses. (a) Typical roof trusses. (b) Typical bridge trusses. (c) Other
types of trusses. (From Vector Mechanics/or Engineers: Statics and Dynamics by Bear and
Johnston. Copyright © 1962by McGraw-Hill. New York. Used with permission of McGraw-
Hill Book Company.)

FINITE ELEMENT 1'0RMULATlON: THE DIRECT APPROACH
45
method. A specific problem is worked out completely by hand, and the basic steps
are then summarized. A simple computer program called TRUSS is described and
applied to this problem.
3-2
FINITE ELEMENT FORMULATION: THE DIRECT APPROACH
As mentioned in Sec. 3-1, a truss is assumed to be composed of only uniaxial force
members or bar elements. In other words, the joints are all assumed to be pinned
and the members cannot withstand bending or torsional moments. This particular
formulation is restricted to the two-dimensional truss only and will yield the dis-
placements of each joint as well as the axial elongation, strain, stress, and force
for each member. The finite element method is applicable to both statically deter-
minate and indeterminate trusses (and structures in general). The FEM formulation
for the three-dimensional truss is given in Sec. 3-5.
Discretization
The first step in any finite element analysis is discretization. Here the truss must
be discretized into a number of finite elements. The truss is composed of axial
tensile and compressive members, and it seems quite natural to consider each
member as an element. A typical truss element e is shown in Fig. 3-3. Note that
the element has two nodes, i and), one at either end. It is at these nodes that the
forces are transmitted from one element to the next. These elements are frequently
referred to as bar elements, as opposed to beam or frame elements. Bar elements
can withstand only axial forces; beam elements allow bending moments; and frame
elements include axial forces, bending moments, and torsion [2J.
Each joint in the truss is represented by a node that is given a unique number.
Nodes are typically numbered consecutively from one to the maximum number
present. These node numbers are often referred to as the global node numbers, as
opposed to the local node "numbers" i and j. The numbering scheme has a strong
influence on the computational time to obtain the solution (see Chapter 7). Elements
are also numbered consecutively from one to the maximum number of elements.
However, the numbering scheme for the elements is totally arbitrary, unlike the
nodal numbering scheme. Local node numbers in this book are denoted with low-
ercase letters i.], k, etc. For example, element e has only two nodes, and they are
denoted as nodes i and). However, all nodes in a structure have global node numbers
and on element 3, for example, the global node numbers may be 10 (node i) and
7 (node i). The corresponding global node numbers are denoted with capital letters
i •
• i
Figure3-3
Typical finite element in truss model.

46
TRUSS ANALYSIS: THE DIRECT APPROACH
I, J, K, etc. The point is that every element in the truss has local node "numbers"
i and j with corresponding global node .. numbers" 1 and J. In the example above,
1 is 10 and J is 7.
An essential part of every finite element analysis and computer program is the
data that defines the coordinates of every node present in the truss and the elements.
Element data are typically composed of nodal connectivity information and material
set flags. Nodal and element data are generally generated within a computer pro-
gram, but the user must still provide some minimum amount of data to describe
the particular problem at hand. This is called mesh generation, and one method for
accomplishing this is presented in Sec. 3-6.
Example 3-1
Figure 3-4(a) shows a cantilever truss with only five members and four joints.
Members A, C, and E are composed of a O.S-in.-diameter steel rod (with a modulus
of elasticity of 30 x 106 psi), and members Band D are composed of a O.4-in.-
diameter aluminum rod (with a modulus of II
x
106 psi). Discretize the truss
showing the nodal coordinate data and the element data in tabular form (hence
suitable for use in a computer program). The coordinates (in inches) of the joints
are shown in Fig. 3-4(a).
Solution
Since the truss has five members, it is natural to discretize the truss into five
elements, each member being an element. Each joint can then be taken as a node.
Therefore, four nodes are used. The first step in the discretization process is to
~~.r:;....---......-~(12.0)_x
2000lb
(u)
(b)
O
Node
number
O
Element
number
Figure 3-4
(a) A cantilever truss with five members and four joints. (b) Truss discretized
into five elements and four nodes.

FINITE ELEMENT FORMULATION: THE DIRECT APPROACH
47
number each joint or node consecutively from one to the maximum number of
nodes present. For the truss under consideration the nodes are numbered I to 4, as
shown in Fig. 3-4(b). Using the coordinates shown in Fig. 3-4(a) we may summarize
the nodal coordinate data as shown below:
Node
number
I
2
3
4
x coordinate. in.
12.0
12.0
0.0
0.0
y coordinate. in.
0.0
6.0
0.0
10.0
Let us use material set flags I and 2 to denote the O.5-in. steel and OA-in. aluminum,
respectively. With the help of Fig. 3-4(b), the element data may be summarized
as follows:
Element
number
I
2
3
4
5
Node
I
3
3
4
3
Node
j
2
I
2
2
4
Material
set flag
I
2
I
2
I
•
Element Stiffness Relationship in Local Coordinates
It will soon prove to be very convenient if a local coordinate system, x'v', is chosen
as shown in Fig. 3-5. This x'y' coordinate system is known as a local coordinate
system. since it is defined locally on the element. Note that the x' axis is directed
U/. u/
Figure 3-5
Truss element in local coordinate system showing nQ9a1 forces and nodal
displacements.

48
TRUSS ANALYSIS: THE DIRECT APPROACH
along the length of the element from node i to node j. The v' axis must be chosen
to be perpendicular to the x' axis, but its sense is arbitrary. Nodal forces in the .r'
and v' directions at node i are denoted as V; and V;, respectively, and nodal
displacements as u; and <' respectively. Similarly, at node i. the nodal forces are
V; and V; and the nodal displacements are ui and v; in the x' and y' directions,
respccti veIy.
It should be recalled from elementary strength of materials that the axial elon-
gation 8 is given by
PL
8 = AE
(3-1)
(3-2a)
where L is the length of the member (or element), P the axial force, A the cross-
sectional area, and E the modulus of elasticity (Young's modulus). It is assumed
that the elastic range is not exceeded and that A is constant. Solving Eq. (3-1) for
P and interpreting it as the axial force at node i W;), we can write
V'
=
AE (u'
-
II')
,
L
'
I
where the effective elongation 8 is given by the difference between the nodal
displacements along the element. In a similar fashion, we may write
,
AE,
,
V, = L
(u, -
u,)
(3-2b)
Note that V; = - V; , which must be the case if element e is to be in static
equilibrium in the x' direction. Because this particular type of element cannot support
transverse forces, we also have
V; = 0
V; = 0
Equations (3-2) may be written in matrix form as
t
I
0 1- I
o~ tll;~
AE
Q__9J__Q__ Q_
_~·.L_
L
-I
0 I IOu;
()
() i
0
0
v'
I
,
(3-2c)
(3-2d)
(3-3)
Since the global nodal coordinates denoted as (x;,yJ and (xi'Y,) are specified for
any given truss, the element length may be computed from
L = V(xj
-
xY + (v, - vy
(3-4)
The other two properties, A and E, are also specified for every element, usually
with the help of material set flags in a c0l!1puter program (see Example 3-1 and
Sees. 3-3 and 3-6). Equation (3-3) may be written concisely as
Kc'a',' = fe'
(3-5)

FINITE ELEMENT FORMULATION: THE DIRECT APPROACH
49
where Ke' represents the local element stiffness matrix, a e ' the local element nodal
displacement vector, and fe' the local element nodal force vector. The superscript
(e) is used throughout this text to denote element and a prime (') to denote the
local coordinate system, unless stated otherwise. Before Eq. (3-5) can be applied
to the truss on the whole, it must be transformed to the global (xy) coordinate
system. This transformation is developed in the next section.
Example 3-2
Determine the local element stiffness matrix for member C (or element 3) for the
truss in Example 3-1.
Solution
From Eqs. (3-3) and (3-5), the local element stiffness matrix K',' for element 3 (or
e = 3) is given by
K(Jl' =
A(JIE(JI t--~--~--t-~--~j
£13)
-1
0
I
I
0
o
0 ! 0
0
where element 3 has material set flag 1, which corresponds to the 0.50-in. steel or
1T
,
0
.
2
4' (0.5)- =
.196 m.
30 x
106 psi
Y(X3 -
X2)2 + (Y3 -
Y2)2
Computing K(3)' gives
Y(O -
12)2 + (0 -
6)2
13.42 in.
t
438
0 !-438
OJ
"
0
0:
0
0
.
K() = 103 --=-43S--o-T--43S--0-
lbf/m.
o
O!
0
0
for the local element stiffness matrix for element 3 (member C). The 103 scalar
multiplier should be noted.
•
Transformation from Local to Global Coordinates
A local (x'y') coordinate system was used to derive the stiffness relationship given
by Eq. (3-3). The x' axis was purposely taken to be directed from node i to node
j. The y' axis, which must be chosen to be perpendicular to the x' axis, is otherwise
arbitrary (with respect to its sense). Figure 3-6 shows a global coordinate system
in relation to a typical element e. The purpose of this discussion is to find a

50
TRUSS ANALYSIS: THE DIRECT APPROACH
Figure 3-6
Relationship between local and global coordinate systems.
transformation that will enable us to write Eq. (3-5) with respect to a global co-
ordinate system.
First, let us set up a global xy system as shown in Fig. 3-7(a) and draw a
position vector r to an arbitrary point P. The vector r may be written in terms of
its two cartesian components r, and r; as follows:
r=r)+rj
(3-6)
Next, let us define the same vector r in terms of the rotated coordinate system x'y'
where, with no loss in generality, the x' axis is purposely taken to be in the same
direction as r itself, as shown in Fig. 3-7(b). In terms of the cartesian components
(r; and r;) in the rotated frame. the vector r becomes
r
= r;i' +
r~r
(3-7)
where i' and j' are the two unit vectors in the x' and y' directions, respectively.
From Eqs. (3-6) and (3-7), we have
r,i + rj
y
r;i' + r;r
y
(3-8)
r,
.....-:-+_------'--_x
(a)
l'
"-\
\
\
\,
\
\,
(b)
/x
/'
/'
/'
/'
fJ
Figure 3-7
Position vector r (a) in global coordinate system and (b) in local coordinate
system.

FINITE ELEMENT FORMULATION: THE DIRECT APPROACH
51
Taking the dot product of both sides of this equation with respect to i gives
r, = r;H' + r;j'j'
(3-9)
where H = I and i-j = 0 have been used. Note that H' represents the cosine of
the angle between the x and x' axes, and i-]' represents the cosine of the angle
between the x and y' axes. It should be recalled that these are the direction cosines,
which will be denoted as
cos(x,x')
cos(x,y')
i-j'
(3-10a)
(3-10b)
where cos(x,x') represents the cosine of the angle between the x and x' axes, etc.
Therefore, with the help of Eqs. (3-10), Eq. (3-9) becomes
(3-11a)
By forming the dot product of Eq. (3-8) with j in a completely analogous manner
we also have
(3-11b)
where n21 represents the cosine of the angle between the y and x' axes, and n22
represents the cosine of the angle between the y and y' axes. Clearly, in the notation
for the direction cosines, the first subscript is associated with the global coordinate
system and the second with the local (rotated) system. Equations (3-11) may be
written in matrix form as
or more concisely as
(3-12a)
r = Tr '
(3-12b)
where T is the so-called transformation matrix that transforms a vector in the local
system to one in the global system. It can be shown that the matrix T is orthogonal
(see Problem 3-21) because T- I
TT (see Sec. 2-7). Therefore, it follows from
Eq. (3-l2b) that
(3-13)
This last result may be used to transform a vector in the global system to one in a
local system. These transformations are used next to determine the stiffness rela-
tionship with respect to the global coordinate system.
Global Element Stiffness Relationship
Before the element stiffness matrices K c' and nodal force vectors fe" can be assem-
bled to represent the entire truss, they must be transformed to a global coordinate
system. Interpreting r ' as [u; v;V and r as lUi v;f in Eq. (3-13), we have

52
TRUSS ANALYSIS: THE DIRECT APPROACH
(3-14)
where u, and Vi are the displacements at node i in the global coordinate directions
x and y, respectively. Similarly, for the displacements at node j, it follows from
Eq. (3-13) that
(3-15)
Figure 3-8(a) shows the relationship between the local and global nodal displace-
ments. Equations (3-14) and (3-15) may be written in one matrix equation as
or more concisely as
Ra"
where, by definition
(3-16)
(3-171
(3-18)
R =
[-~~-;-;T-]
and a" represents the vector of nodal displacements for element e referred to the
global coordinate system, or
I
. .
a" = Iu,
\',
I
uJ
v;F
I
In a completely analogous manner we may also write
(3-19)
r
t'
I
I
I\,
\
\
\
(a)
v
~i'
I
(h)
le'
V;
I
I\,
\
\
\
Figure 3-8
Typical element e showing global and local (a) nodal displacements and (b)
nodal forces, All forces and displacements are shown with a positive sense.

FINITE ELEMENT FORMULATION: THE DIRECT APPROACH
53
fe' = Rfe
(3-201
where f" is the vector of nodal forces for element e referred to the global coordinate
system, or
I
r- = IV,
V
I
U
VJY
(3-211
I
I
J
Figure 3-8(b) shows the relationship between the local and global nodal forces.
With the help of Eqs. (3-17) and (3-20), we may write Eq. (3-5) as
(3-221
which may then be premultiplied by R T to give
RTKe'Rae = f"
(3-231
where RTR = R -I R = I has been used on the right-hand side, Equation (3-23)
may be written simply as
Kea" = r-
(3-241
where K", the element stiffness matrix referred to global coordinates, is obtained
directly from the element stiffness matrix referred to local coordinates (Ke) by
Ke = RTK','R
(3-251
The matrix K" is often simply referred to as the global element stiffness matrix (as
opposed to the local element stiffness matrix Ke\ If the multiplications indicated
in Eq. (3-25) are carried out, we get
(3-261
Ke
[
IITI
n2l 1l11
I -nT,
-1I21111lJ
AE
2
I
2
11111121
1121
1-11111121
-1121
L
---~~1~----~~~~;~-1--~1~-----7z;~~~--
?
I
2
-11 111121
-1121
:
nllll21
n21
It should be noted that in the expression for K" only two of the four possible
direction cosines appear: nil and n2l' By definition, 1111 is the cosine of the angle
between the x and x' axes, and 1121 is the cosine of the angle between the Y and x'
axes, Recall that the x' axis is directed along the element from node i to node i-
From Fig, 3-9 it is immediately apparent that
L
x, -
Xi
1111 = cos e., =
(3-27al
and
v - v
e
.J
• I
1121 = cos
v = --L-
(3-27bl
where (xi,y;) and (xj,Y) for element e are the global coordinates of nodes i and i.
respectively, andL is the element length [easily computed from Eq. (3-4)]. It should
be recalled that the coordinates of each node are a vital part of the input to every

54
TRUSS ANALYSIS: THE DIRECT APPROACH
(Xl.-"j)
(Xj • ."/)
;
I
I
I
I
Ox
\
I
..
(x/ ,.\',)
(X; 'Yi)
Figure 3-9
Definition of angles e, and e, used in obtaining the direction cosines.
finite element analysis (and computer program). Consequently, the two needed
direction cosines are routinely computed with Eqs. (3-27). It must be emphasized
that the important result is Eq. (3-26), which enables us to compute the global
element stiffness matrix for every element since A and E are specified, and L, 1111'
and 1121 are easily computed (for every element). In the next section, the notion of
assemblage is introduced. It is an easy matter to show that K" is symmetric because
K'" is itself symmetric (see Problem 2-26).
Example 3-3
For the truss in Example 3-1, determine the global element stiffness matrix for
element 3.
Solution
The global element stiffness matrix, denoted as K", is given by Eq. (3-26) in terms
of the direction cosines II)) and
1121, which are computed from Eqs. (3-27) for
element 3 as follows:
X2
-
x}
12.0 -
0.0
1111
LUI
13.42
0.8944
.\'2 -
Y.l
6.0
-
0.0
1121 =
= 0.4472
LUI
13.42
where the result for the element length from Example 3-2 has been used. The
calculation of KO I from Eq. (3-26) is now straightforward, and the result is
[
351
176 \ - 351
- 176J
KUI = IO}
~7_~
~~_L.:::n.?
-=..?..?_
Ibf/in
-351
-176:
351
176
.
-176
-88:
176
88
where the cross-sectional area A(}) was also taken from Example 3-2. As expected,
KO) is symmetric.
•

(3...28)
(3·29)
FINITE ELEMENT FORMULATION: THE DIRECT APPROACH
55
Assemblage
The assemblage step is necessary in all finite element analyses. It is in this step
that the original truss (or in general, any structure, body, or region being analyzed)
is put back together or assembled from the individual elements comprising it. Suffice
it to say now that the assemblage step is based on the principle of compatibility;
that is, the x and y displacements associated with a particular node on any given
element must be identical to those associated with the same node on each element
that shares this node [3].
Consider a two-dimensional truss with N nodes. Each element e has two nodes
i and j with global node numbers I and J. Since each node has two degrees of
freedom (i.e., two components of displacement) the 4 x 4 global element stiffness
matrix may be thought of as being partitioned into four submatrices, each of size
2 x 2, or
[
Ke : KeJ
Ke =
__!.!.....L
...Y....
Kj;! KL
These 2 x 2 submatrices are easily extracted from Eq. (3-26). Since global node
number I corresponds to local node i and global node number J to local node j,
Eq. (3-28) may be written in terms of the global nodal subscripts as
K e = [~~!.__!.<L-J
KJ"
KJ.JJ
The assemblage stiffness matrix, denoted as K", is always of the form
Ki,l
Ki,2
K"
K"
1,3
I,N
K"
K Z,2
K"
KZ,N
2,1
2.3
K"
K~,I
K"
K"
K"
(3-30)
3.2
3.3
3,N
KN,I
K"
K"
KN,N
N,2
N,3
Note that the superscript (") denotes assemblage. Each of these Ki/s are 2 x 2
submatrices. To begin the assemblage process, the assemblage stiffness matrix K"
is zeroed out. Then the individual global element stiffness submatrices (i.e., the
KI./s) are added to the corresponding position in the matrix K" (i.e., at K/',}) for
element I, then for element 2, and so forth, up to and including the last element.
The assemblage of each 2 x
2 submatrix in Eq. (3-30) may be given by the
relationship
M
Ki.J =
L Ki.J
e=1
for I = I to Nand J = I to N
(3...31)
In Eq. (3-31), M is the maximum number of elements, and Ki.J is taken as the 2
x 2 null matrix if element e does not have nodes I and J. The next example will

56
TRUSS ANALYSIS: THE DIRECT APPROACH
help to clarify the assemblage process for the truss (see Sec. 3-3 for a numerical
example).
Example 3-4
For the truss of Example 3-1, determine the assemblage stiffness matrix in terms
of the 2 x 2 global element stiffness submatrices KJ.J.
Solution
Element I has global node numbers I and 2 (i.e., I and J, respectively), and so
the global element stiffness matrix for element I, denoted as K(I I, is given by
[
K (II : Kill]
K(li =
Kh+-:-Kb~
2.1
I
-.-
Having first zeroed-out the assemblage stiffness matrix K", we may then "add"
this result to K" to get
~
K \ I \ : K\I~ : 0 : O~
K" = -KvftK1Tr1-oto-
-----1-----1--1---
o
I
0
10 10
_____4-
~__4-__
o : 0
10 10
This is not the complete form of the assemblage stiffness matrix because four more
elements have yet to be considered. Element 2 has global node numbers 3 and I
(i.e., I and J, respectively) and the global element stiffness matrix for element 2
is given by
[
K \21 : K(2)]
K(2) =
K~~~-;-K3\~~
1.3 I
.1
After combining this element stiffness matrix with the result from element I, we
get
~
K ' I ) + Kl21
I Klil
: K'21 : OJ
--J~~-----~~--~---~~-~--21-1----
K" ~
:::::~~t::g~:t:~~~(t:i:
Note the position of each entry in K" carefully. After considering element 3 (with
nodes 3 and 2), element 4 (with nodes 4 and 2), and element 5 (with nodes 3 and
4), the assemblage stiffness matrix becomes
K" ~ ~~~~~i~=~~i~=::=~~~tii~~tilt~iE~
[
0
:
K~4\
:
K~'\
: K~4~ + K~'~~I

FINITE ELEMENT FORMULATION: THE DIRECT APPROACH
57
Several significant observations should be made. First, each of the individual 2 x
2 element stiffness submatrices is symmetric, as an examination of Eq. (3-26)
clearly shows. Mathematically, this may be stated as
K1.J = K/.I
(3-32)
It then follows that K" itself is symmetric, which has several advantages as delin-
eated in Chapters 6 and 7. Another property of K" is that it is banded, which means
the nonzero entries in KU are gathered along the main diagonal. In the example
above, this is not very obvious because the truss has only five elements and four
nodes. Because of the symmetric nature of KU, we usually use the term half-
bandwidth, denoted as b; in this text. A general expression for the half-bandwidth
is given by
(3-33)
where NDOF is the number of degrees of freedom per node and ~max is the maximum
of the maximum differences between node numbers on each element considering
all elements one at a time. In the truss model there are two degrees of freedom
associated with each node (the two components of displacement). From Eq. (3-33)
it can be seen that the way in which the nodes are numbered can have a strong
influence on the half-bandwidth. In a computer program, the execution time in-
creases with the square of the bandwidth for the usual solution techniques [4].•
Example 3-5
Determine the half-bandwidth of the assemblage stiffness matrix from Example 3-
4 by direct examination of K" and by computation using Eq. (3-33).
Solution
Let us write K" in the following form showing each potentially nonzero entry as
an x and each zero entry as a 0:
1<
bw
)1
x
x
x
x
x
x"""O
0
x"""x
x
x
x
x
O~O
x
<,
x
x
x
x
x
x
X
K"
X
X
X"""-x
x
x
x
x
x
x
x
x ""'-x
x
x
x
x"""x
x
x
x ""'-x
x
x
o
O~x
x
x
x"""x
x
o
0
x
x
x
x
x"""-x
A direct count of the number of nonzero entries in the half-bandwidth above yields
6. Equation (3-33), of course, must give the same result for the half-bandwidth,
but let us compute it. There are two degrees of freedom per node, hence N DOF =
2. The maximum difference between any two node numbers considering all elements

58
TRUSS ANALYSIS: THE DIRECT APPROACH
one at a time is 2, or ~max
2) = 6 as expected.
Application of Loads
2. Therefore, Eq. (3-33) readily gives b.;
2(1 +•
The assemblage nodal force vector f" may be obtained by an assemblage process
similar to the one used to obtain K". It is simpler, however, because each element
nodal force vector, f", is a column vector (of size 4 x I), as opposed to a matrix.
The assemblage of each element nodal force vector in this manner is illustrated in
subsequent chapters. Because the external loads on the truss can only occur at the
joints, the effective assemblage nodal force vector f" can be obtained by a more
direct route as explained below.
The assemblage nodal force vector, with 2N entries, is first zeroed-out, where
N is the number of nodes present. Let us assume that at global node number K,
there is a point load with components F, and Ft' These components are referred
to the global coordinate system as shown in Fig. 3-10. Because the load is applied
at node K, we must add F, and F, to the (2K -
l)st and 2Kth positions in f",
respectively. Reaction forces are not considered to be loads in finite element anal-
ysis. They are handled routinely as restraints (see Sec. 3-3).
Example 3-6
For the loading shown in Fig. 3-4(a) for the truss in Example 3-1, determine the
assemblage nodal force vector f".
Solution
The 2000-1bf load is the only external load and must be resolved into its two cartesian
components, F, and Ft' Note from Example 3-1 that an xy (global) coordinate
system is implied as shown in Fig. 3-4(a). The x and y components of the applied
load are given by F, = - 2000 cos 60° = - 1000 Ib and F; = - 2000 sin 60° =
r
-T---t--r~T-......~F,
Figure 3-10
Portion of truss showing node K with external load (components F, and F,).

FINITE ELEMENT FORMULATION: THE DIRECT APPROACH
59
- 1732 lb. Since this load is applied to node I, the first [from 2( I) -
I] and second
[from 2(1)] entries in fll must be changed to yield the following result:
r-
-1000
- 1732
--------
o
o
--------
o
o
--------
o
o
F,} Node I
Fy
F,} Node 2
r,
F,} Node 3
F"
F, }
Node 4
Fy
If another force also acts at node I, the respective components would be added
to those above. The restraints on the nodal displacements are considered next. •
Application of Restraints on Nodal Displacements and Solution
The assemblage stiffness matrix K" and nodal force vector fll are obtained as
described above. The assemblage system equation is of the form
Kva = fll
(3-34)
where a is the vector of nodal unknowns or, in this case, the vector of unknown
nodal displacements. The vector a is given by
(3·35)
where N is the maximum number of nodes and Ufo VI are the x and y components
of the displacement at global node number I. In Eq. (3-35), the transpose is used
to conserve space-a itself is a column vector as implied by Eq. (3-34). Equation
(3-34) cannot be solved for the vector a because the restraints on the nodal dis-
placements have not been considered. In fact, the inverse of K" does not exist. in
general. until the restraints on displacements are taken into account. Inother words,
K" is singular. After the restraints are considered, Eq. (3-34) is written as
Ka = f
where K is no longer singular. Therefore, K - I exists, which implies a unique
solution for the vector of nodal displacements a. Two methods are commonly used
to impose the prescribed displacement restraints [5J. Each is discussed below.
Method 1
The first method is most easily explained by an example. Consider the system of
equations
(3-36a)

60
TRUSS ANALYSIS: THE DIRECT APPROACH
k2I(/ 1 + kn (/ 2 + kn (/ 3 = f2
k3 1(/ , + k32(/ 2 + k33(/ 3 = I,
(3-36b)
(3-36c)
(3-37)
Let us impose a restraint on (/2, in other words, that (/2 is to have a specified value,
e.g.,
(/1' (a prescribed displacement in this truss analysis). Let us further assume
that the system of equations is symmetric (such as the truss model) and that the
symmetry is to be preserved. Let us replace Eq. (3-36b) with
The system of equations thus becomes
k,,(/, + k12(/ 2 + kU (/ 3 = I,
But the symmetry has been destroyed, and to preserve it we need a zero coefficient
on (/2 in the first equation. We can get that by noting that (/2 =
(/1' (which is known)
and writing
kl ,(/ , + k U (/ 3 = II -
k12(/p
Note that the term involving (/2 is conveniently transposed to the right-hand side
(and (/1' replaces (/2)' After performing a similar operation on the third equation and
using matrix notation, we get
[~ '
~
k~'][:~]: [~p k
I2(/p]
k3 ,
0
kB
(/3
13 -
k32ap
Note that 12 disappears! The implication is that for degrees of freedom in the truss
model where an unknown reaction force exists, this unknown force (f2 above) never
really enters the formulation. Instead, a known displacement is imposed. In struc-
tural analysis problems, these prescribed displacements are usually zero, and in this
case
(/1' = 0 in Eq. (3-37).
Method 2
A much simpler method exists for imposing prescribed displacement restraints. The
method is based on the concept of penalty functions, and a proof of why the method
works is given in Zienkiewicz [61. The purpose here is not to prove it but to learn
how to apply it.
Let us again consider the system of equations in Eq. (3-36). In this method a
large number ~ is selected, say six to twelve orders of magnitude larger than the
largest coefficient kij , and is added to the coefficient k,j if a, is to be prescribed. In
addition, the right-hand side of the ith equation is changed to ~ times the prescribed

(3-381
FINITE ELEMENT FORMULATION: TilE DIRECT APPROACH
61
value (of displacement). In the example above, since a2 is to be prescribed (i.e.,
a2 = ap), the second equation becomes
k2la I + (kn + 13 )U2 + k2JaJ = l3ap
Note that 13 is chosen to be much larger than the coefficients and, for all practical
purposes, this last equation is really equivalent to
l3a 2 = l3ap
or
U2 =
up
which is the desired result. The other equations are unchanged. In matrix form the
system of equations becomes
[
k l l
k2 1
kJ 1
Note that this simple method automatically preserves symmetry. In a computer
program, Method 2 is extremely easy to apply. Examples that demonstrate Methods
I and 2 are given in Sees. 4-8 and 3-3, respectively.
Both methods result in the system of equations represented by the matrix
equation
Ka = f
(3-391
(without any superscripts). This equation may be solved for the nodal displacements
contained in the vector a by any method applicable to the solution of linear, algebraic
equations. In fact, some solution techniques, such as the one in Sec. 6-8, take
advantage of the symmetric and banded nature of the stiffness matrix K, but let us
use the matrix inversion method here. If K - I is computed and if Eq. (3-39) is
premultiplied by it, we get
a = K -If
(3-401
This method is used in Sec. 3-3 in the solution to an example problem. A much
more practical method of solution is presented in Sec. 6-8.
Computation of the Element Resultants
By definition, the element resultants for the truss include quantities such as the
axial elongations, strains, stresses, and forces. Each of these is computed more or
less directly from the nodal displacements a that were computed to be the solution
of Ka = f.
The elongation I) for element e may be computed in terms of the x' components
of nodal displacements at nodes i and j by

62
TRUSS ANALYSIS: THE DIRECT APPROACH
u;
But from Eq. (3-14), we have
,
u,
(3-41)
,
U,
(3-42a)
and from Eq. (3-15),
(3-42b)
Note that in Eqs. (3-42) only two of the direction cosines appear (nil and n2l):
these are easily computed for every element by Eqs. (3-27). In Eqs. (3-42), U;,
VI'
uJ' and Vi are known once the nodal displacements are determined (from the solution
of Ka = f). Therefore, for any element e, the elongation 0 is readily computed.
The axial strain E for a typical element e is computed from
o
E = -
L
(3-43)
where L is the element length computed from Eq. (3-4). The material is assumed
to be elastic so that Hooke's law applies. Therefore, the axial stress a in the element
is computed from
a = EE
Finally the axial force F in the element is determined by
F = aA
(3-44)
(3-45)
In Eqs. (3-41), (3-43), (3-44), and (3-45), positive values of 0, E, a, and F denote
tension, whereas negative values denote compression. The formulation of this sec-
tion is utilized in the next section in an example.
3-3
APPLICATION TO A SPECIFIC EXAMPLE
In this section, a simple problem is executed completely by hand in order to illustrate
the basic steps in the finite element method. Let us reconsider the truss in Example
3-1 shown in Fig. 3-4(a). It should be recalled that members A, C. and E are made
of a 0.5-in.-diameter steel rod and members Band D of a O.4-in.-diameter aluminum
rod. The modulus of elasticity of steel and aluminum are 30 x 106 and II
x 106
psi, respectively. The truss is constrained and loaded as shown in Fig. 3-4(a), which
also shows the coordinates of each joint.
The first step in any finite element analysis is discretization. Let us use the
results of Example 3-1 where we took each member of the truss to be an element.
It should be recalled from that example that the discretization step may be divided
into two separate but related tasks: (I) specification of the nodal coordinates and
(2) specification of the element data, including material set definitions. Because
this step is so vitally important, let us summarize the results of the discretization
from Example 3-1:

APPLICATION TO A SPECIFIC EXAMPLE
63
Nodal Coordinate Data
Node
number
x coordinate, in.
y coordinate, in.
I
12.0
0.0
2
12.0
6.0
3
0.0
0.0
4
0.0
10.0
Element Data
Element
Node
Node
Material
number
j
set
I
I
2
I
2
3
I
2
3
3
2
I
4
4
2
2
5
3
4
I
Note that member A is taken as element 5, member B as element 4, and so forth.
In addition, material set I is the D.5-in. steel and material set 2, the DA-in. alu-
minum. The nodal numbering scheme used above will result in the smallest possible
bandwidth of the assemblage stiffness matrix.
In Sec. 3-2, three properties were needed for each element: the cross-sectional
area, the modulus of elasticity, and the length. The length is easily calculated by
Eq. (3-4) from the nodal coordinates. However, the remaining two "material prop-
erties" must be specified:
Material
Cross-sectional
Modulus of
set
area, in.?
elasticity, psi
I
0.1963
30 x 106
2
0.1257
II x 106
All of the above information is used frequently throughout the finite element solution
process. In summary, the truss model will be composed of four nodes and five
elements involving two different types of materials. Not surprisingly, this same
information becomes an integral part of the input to the computer program described
in Sec. 3-6.
The next step is to determine the local element stiffness matrix for element I,
to transform it to the global element stiffness matrix, and finally to "add" it into
the assemblage stiffness matrix (which is always zeroed-out before processing the
first element). From Eqs. (3-3) and (3-5), the local element stiffness matrix is given
by

64
TRUSS ANALYSIS: THE DIRECT APPROACH
K'
= AE t--~--~-L~~--~j
L
-I
0
I
I
0
o O!
0
0
(3-461
Element I is composed of material I, and so we have
(0.1963)(30 x 10
6
)
t--~--~-'-~_t_~j
(3-47al
Y(l2.
~ 12.)2 + (6. -
0.)"
- I
0 I
I
0
00100
or
(3-47bl
Although only three or four significant digits are shown here, all calculations
were carried out using nine digits and, therefore, numbers may not add exactly as
shown during the assemblage. The reader should note the scalar multiplier of 101
and verify that each entry in K( I)' has units of pound-force per inch. The stiffness
terms in structural models will always have units of force per unit length-similar
to the units of the stiffness for a spring. Although KI I)' can be transformed to K( 1)
by applying Eq. (3-25) to element I, it is easier to use the result for K' given by
Eq, (3-26). Recall that only two of the direction cosines are needed, which. for
element I, are readily computed as follows:
X,
-
X,
12.0
-
12.0
11((
0.0
(3-48al
L
6.0
y
-
y.
6.0
-
0.0
1121 = ~
= 1.0
(3-48bl
L
6.0
The reader should examine the orientation of element I in Fig. 3-4(b) to verify
these direction cosines by inspection. With the help of Eq. (3-26), the global element
stiffness matrix for element I may be verified to be
(3-491
This result must now be added into the assemblage stiffness matrix (which at this
point is simply a null matrix). Since element I connects nodes I and 2, the assem-
blage stiffness matrix K" becomes

APPLICATION TO A SPECIFIC EXAMPLE
65
o
0
110
0
10
010
0
I
I
o
982 I 0
- 982 • 0
O' 0
0
---------~---------~------~-----
o
0
10
0
10
0,0
0
o - 982 : 0
982 I 0
0 10
0
KO
---------r---------+------l------
Ibf/in.
(3-50)
o
0
10
0
10
010
()
o
0
10
0
10
010
0
---------i----------~----~-----
o
0.0
0
10
010
0
00 100100100
•
•
I
The reader should corroborate this result for the assemblage stiffness matrix
(after processing the first element) with Example 3-4.
Although the nodal force vectors r-', f", and fO could be considered at this
point for element I, it proves to be more convenient to obtain fO directly as indicated
by Example 3-6. This same comment applies, of course, to the nodal force vectors
for elements 2 through 5.
Element 2 is considered next, and since it is composed of material set 2, K(2)'
is given by
or
(0.1257)(11 x
12.0
(3-51a)
(3-51b)
[
115
0 1- us
01
K(2)' = 103
~
Q_~---.9---.9-
-115
0 I
us
0
o
0 I
0
0
The reader may verify that for element 2 we have nIl = 1.0 and n 21 = 0.0, both
by inspection and by using Eqs. (3-27). Therefore, we have K(2) =
K(2)', or the
global element stiffness matrix is identical to the local element stiffness matrix [see
Eq. (3-26)]. Since element 2 is connected by nodes 3 and I, the assemblage stiffness
matrix becomes (after processing two elements)
us
0:0
0
I-liS 0;00
o
982 I 0
- 982:
0
0 10
0
-------------~----------+--------1r-----
o
0
10
0
I
0
0.0
0
o
- 982 10
982 1
0
0 10
0
._-----------~----------+---------~-----
- us
0
10
0
1
115
0 10
0
o
0
10
0
1
0
010
0
-------------r---------~---------~-----
o
010
0:
0
0:00
o
0
10
0:
0
0:0
0
I
I
I
(3-52)
Again the reader should examine this result in light of Example 3-4.

66
TRUSS ANALYSIS: THE DIRECT APPROACH
Element 3 is a little more interesting than the previous two elements because
it is oriented neither horizontally nor vertically. The length of element 3 is easily
computed from Eq. (3-4) to be
L = y'(I2. - o.v + (6. - OY = 13.42 in,
and KO" becomes
(3-53a)
(3-53b)
or
K(3)' = 10
3 [---~~~--~-l-~~~~--~-j
-439
0
I
439
0
I
o
0:
0
0
In order to transform K13)' into KOI, the direction cosines are needed. Recall from
Example 3-3, for element 3 we calculated "11
= 0.894,1121 = 0.447. With the
help of Eq. (3-26), the global element stiffness matrix for element 3 is computed
to be
[
351
176 1-351
-176]
KO) =
I0
1
-=--}}}--=--li~1-~-H~---~~~-
-176
-881
176
88
(3-54)
(3-56)
This matrix must now be included in the assemblage matrix K", and since element
3 connects nodes 3 and 2, we get the result
115
0 I
0
0
1 - 115
0
10
0
o
982 1
0
- 982 I
0
0
I 0
0
------------~------------~------------~------
o
0 I
351
176 I - 351
- 176 I 0
0
0-982\
17610701-176
-88100
K" = 10J
':.Tr5-----5-'--=3S"i--·::T76T--;r66----"i761o---6-
(3-55)
I
I
I
___Q
J~_1_~l~~
:~~_1__ !2~
~~12
Q_
o
0:
0
0
1
0
0
10
0
o
0:
0
() I
0
0
10
0
Once again the reader should reexamine Example 3-4. This last result is the as-
semblage stiffness matrix after processing three elements.
The procedure to be used on element 4 is identical to that used above. The
reader should verify that for element 4 we get
[
109
0 I - 109 0]
,
1
001
00,
K(4)
= 10· ----------fo---------
lbf/in
- 109
0 I
109
0
.
o
0 I
0
0

(3-57)
APPLICATION TO A SPECIFIC EXAMPLE
67
and with nIl = 0.949 and nZI = -0.316,
[
98
-33 I -98
33j
4
- 33
II 1
33
- II
.
K( ) =
103
-----------~-----------
lbf/in.
-98
33 I
98
-33
I
33
- II l - 33
II
After processing four elements and noting that element 4 connects nodes 4 and 2,
the assemblage matrix Ka becomes
115
0:
0
0 I - 115
0:
0
0
o
982:
0
- 981 I
0
0:
0
0
------------1------------~------------~-----------
o
0
I
450
143. -351
-176: -98
33
___2
~_~~~~_!±l
~OJ2_~-~12~---~-~~i--]2--~JJ--
- 115
0
1- 351
- 176 1
466
176 I
0
0
1
1
1
___Q
2__J_~12~
~_~~~--12~----§§-L--Q-----~--
o
0: - 98
33 :
0
0:
98
- 33
o
0:
33
- II:
0
0: - 33
II
I
(3-58)
(3-59)
and with nil
(3-61)
The pertinent results for element 5 are now summarized. The local element
stiffness matrix K(5)' is given by
K(5)' = 103 [
~~~__~_L~~r__~j
-589
0 I
589
0
o
O!
0
0
0.0 and n21 = 1.0, the global element stiffness matrix becomes
K(5) =
I 0
3 t~----~~d-~---~2~2j
(3-60)
o
0
10
0
o
-589! 0
589
Since element 5 connects nodes 3 and 4 (in this order), the assemblage stiffness
matrix becomes
115
0 l
0
0
I - 115
0
i
0
0
o
982:
0
- 982:
0
0:
0
0
---o------5-ii--450----143-1~-35i--~i761-:98-----33-
0-982:
14310801-176
-88:
33
-II
------------~------------r-----------~-----------
- 115
0: - 351
- 176:
466
176 I
0
0
o
0
1-176
-88 1
176
677 I
0
-589
-------------~------------t------------~------------
o
0:
- 98
33 I
0
0 I
98
- 33
o
0:
33
- II:
0
- 589 : - 33
600
All five elements have now been processed, and this last version of the assemblage
stiffness matrix represents the complete assemblage stiffness matrix for the entire
truss. Note that it is symmetric and slightly banded with a half-bandwidth of 6 as
observed from the third row (also see Example 3-5).

68
TRUSS ANALYSIS: THE DIRECT APPROACH
The next step is to determine the assemblage nodal force vector. Because the
truss and loading in the present example are the same as those in Example 3-6, we
may use the result of that example directly. For completeness, f" is restated here:
f" = [ - 1000
- 1732 : 0
0: 0
0 i 0
O}T
(3·62)
Note the use of the transpose to denote f", a column vector in row matrix form.
Actually, there are three other loads as a result of the reactions. As mentioned
in Sec. 3-2, these reaction forces need not be considered in the construction of f",
However, let us include these reactions in fa to review why this is the case. Let us
denote the reaction in the x direction at node 3 as U3 and denote the reactions in
the x and y directions at node 4 as U4 and V4 ' respectively. If these external forces
are included in the assemblage nodal force vector, we get
The assemblage system equation K"a = fa becomes
lIS
0 i
0
() I - lIS
() i
0
0
II,
o
982 I
0
- 982 I
0
0:
0
0
_'.2_
·--lj----(j-t--4S-0----r4:ft-=--3sT--=-T76T=9s----r.,-'
II,
o
- 982
I
143
1080' - 176
- 88'
33
- II
v,
-~i~-----O-t-=--3S1---=--D6-t-466---i76-t--O----O--·-~-
___2
2_~:l~~-_~~~~__lZ~-__~L~~__~
~~~:.
_~_
o
0,
- 98
33 I
0
0
I
98
- 33
II.
o
0 I
33
- II I
0
- S89 I - 33
600
".
(3-63)
-1000
- 1732
---0---
__2 _
v,
__2
_
v.
v,
(3·64)
At this point, the matrix on the left is singular; that is, its inverse does not exist
and, therefore, it is impossible to solve for a, the vector of unknown nodal dis-
placements. However, the restraints on some of the nodal displacements must be
considered, namely u-; = 0,
1/4 = 0, and V4 = O. Let us use the second method
presented in Sec. 3-2 to impose these restraints. (The first method is illustrated
numerically in Chapter 4.) An arbitrary value of 1.0 x 1018 is taken as ~, and Eq.
(3-64) becomes
10'
us
0 I
0
0 I - liS
0:
0
0
o
982
I
0
- 982'
0
()'
0
0
---O-----O-,--450---~3-~=35r--~T761-~98----33'
o
-982 I
143
1080 I -176
-88'
33
-II
·~TT5----0-,-~35r----D6;--r~~---T76t--o-----o-
o
0
1-176
-88'
176
677'
0
-S89
----------~----------~----------1r--r<------
o
0,
- 98
33,
0
0, 10'
- 33
o
0:
33
- II I
0
- S89 I - 33
10"
v-
----
- IOOO
- 1732
----0--
o
0-;-10"
o
0-;-10"
o x 10"
(3-65)

U2 = +0.00996
V2 = -0.03351
U4 =
0.00000
V4 =
0.00000
APPLICATION TO A SPECIFIC EXAMPLE
69
The 1015 (and not 1018) is entered on the appropriate diagonal entries because of
the 103 scalar multiplier. Note that after the restraints are considered, the right-
hand side is effectively
f = [- 1000
- 1732 ! 0
O! 0
0 i 0
0 f
which is precisely the same as Eq. (3-62). Therefore, the loads as a result of the
reactions need not be considered-a very fortuitous result.
If Eq. (3-65) is solved by the matrix inversion method presented in Sec. 2-14,
the resulting nodal displacements, in inches, are
u1
-0.00868
VI
-0.03528
U3
0.00000
V3
-0.00176
Note that the restrained degrees of freedom all have zero displacements, as expected.
The only remaining task is to determine the so-called element resultants, which
include the axial elongations, strains, stresses, and forces. Element 3 is considered
in detail to illustrate the use of Eqs. (3-41) to (3-45). The final results for all
elements are subsequently summarized below. Recall that element 3 connects nodes
3 and 2 (in this order). From Eqs. (3-41) and (3-42) with 1111 = 0.894 and 1121
0.447, the axial elongation & for element 3 becomes
1')0) =
(I1 I1Uj + I121V)
-
(111 lUi + 1121Vi)
or
/)13)
[(0.894)(0.00996) + (0.447)( -0.03351)]
-
[(0.894)(0.0) + (0.447)( -0.00176))
- 0.00529 in.
The strain in element 3 is readily computed by Eq. (3-43) as
-0.00529
---- =
- 394 X 10- 6 in.lin.
13.42
the stress from Eq. (3-44) as
a(3) =
EE = (- 394 x 10- 6)(30 X 106)
-11,800 psi
and finally the force as
F(J) = aA = (- 11,800)(0.1963) = 2320 Ibf compression
The reader should determine the axial elongations, strains, stresses, and forces for
the remaining elements (see Problems 3-53 to 3-56). The results are summarized
below.

70
TRUSS ANALYSIS: THE DIRECT APPROACH
Element
number
5, in.
E, in./in.
a, psi
F,lbf
1
0.00176
0.000294
8,820
1730
2
-0.00868
-0.000723
-7,960
-1000
3
-0.00529
-0.000395
-11,800
-2320
4
0.02004
0.001585
17,400
2190
5
0.00176
0.000176
5,290
1040
Note that elements I, 4, and 5 (members E, B, and A) are in tension and elements
2 and 3 (members D and C) are in compression. The maximum force of 2320
(compression) occurs in element 3 (member C) but the maximum stress of 17,400
psi (tension) occurs in element 4 (member B). In Problem 3-57 the reader is asked
to do a force balance on each node, which serves as a check on these results and
also yields the (unknown) reaction forces UJ , U4 , and V4 . In Problem 3-58, the
reader is asked to determine these reaction forces directly with the help of Eq.
(3-64).
This completes the two-dimensional truss example. In Sec. 3-4 the basic steps
in all finite element analyses are summarized. This is followed by the three-di-
mensional truss formulation and a description of a two-dimensional truss program,
called TRUSS, which automates in a computer program all of the steps executed
above. The program may be applied to the problem here, as well as to many other
more complicated two-dimensional truss problems.
3-4
SUMMARY OF THE BASIC STEPS
The simple problem in Sec. 3-3 illustrated all the basic steps in the finite element
method. In the steps that are summarized below, it is assumed that the problem is
well-posed, a global coordinate system is defined, and all pertinent geometrical and
material data are known.
Step 1: Discretization
The structure, body, or region being analyzed must be discretized into a suitable
number of elements. Each of the elements has several nodes associated with it. For
example, each element in the truss model has two nodes-one at either end of the
element. Discretization results in the specification of the finite element mesh and
involves two distinct but related tasks: nodal definitions and element definitions.

SUMMARY OF THE BASIC STEPS
71
The nodes are always numbered consecutively from one to the total number
of nodes present. The nodal numbering pattern has a strong influence on execution
time in a computer program (for large problems), as explained in Chapters 7 and
8. The basic idea is to number the nodes in such a way so as to minimize the
bandwidth of the assemblage stiffness matrix. Many large, canned finite element
programs renumber the nodes automatically to ensure this. Nodal definitions are
complete when the coordinates of each of the nodes are also specified.
To define the elements, we first number them consecutively from one to the
maximum number of elements present. The element numbering scheme is com-
pletely arbitrary. The nodes associated with each element must be specified. In
addition, the material property data to be used for each element are specified with
the help of material set flags. Using material set flags reduces significantly the
amount of material property data to be supplied in any computer program.
It should be mentioned that any practical finite element program must have
provisions for automatic or semiautomatic mesh generation. A simple mesh gen-
erator is discussed in Sec. 3-6.
Step 2: Determination of the Local Element Characteristics
Expressions for the local element characteristics must be derived or taken from a
suitable reference. By element characteristics we mean the element stiffness ma-
trices and nodal force vectors. The word "local" refers to the fact that the element
characteristics are derived in a local reference system, which usually changes from
element to element. The proper expressions for the element characteristics in struc-
tural problems may be derived by the direct approach, the variational approach,
including the principle of minimum potential energy, the virtual-work approach,
or the weighted-residual approach. In the truss problem, the direct approach was
used. The other approaches are covered in detail in several of the following chapters.
In nonstructural problems, the variational and weighted-residual approaches are
used most often. With expressions in hand for the local element characteristics, the
local element stiffness matrices (and nodal force vectors) may be determined nu-
merically for each element.
Step 3: Transformation of the Element Characteristics
The element characteristics from Step 2 must be transformed from the local co-
ordinate systems to the global system. This is accomplished with the help of a
transformation matrix as explained in Sec. 3-2 for the truss model. The transfor-
mation of the local element characteristics needs to be performed only when the

72
TRUSS ANALYSIS, THE DIRECT APPROACH
unknown parameter function is a vector, such as the (nodal) displacements in the
truss problem, and then only when a local coordinate system is used.
Step 4: Assemblage of the Global Element Characteristics
The global element stiffness matrices and global element nodal force vectors must
be assembled to form the assemblage stiffness matrix and assemblage nodal force
vector. The basic idea behind Step 4 is that the unknown parameter function must
have the same value at any given node regardless of the element containing the
node. The assemblage procedure for the truss was illustrated symbolically in Ex-
ample 3-4 and numerically in Sec. 3-3.
Step 5: Application of the Prescribed Displacements
After the assemblage step, the assemblage stiffness matrix and assemblage nodal
force vector must be modified according to one of the two methods presented in
Sec. 3-2 in order to impose the constraints on the restrained degrees of freedom.
In structural and stress analysis problems, these are typically the nodal displacements
(or deflections and slopes in models involving bending). In thermal analysis prob-
lems, the prescribed nodal temperatures must be imposed in a similar manner. In
fluid flow problems, the prescribed nodal velocities and pressures must be similarly
imposed. The resulting stiffness matrix after Step 5 is nonsingular for well-posed
problems.
Step 6: Solution
The resulting system of equations Ka = f must be solved for the vector of nodal
unknowns a. In the truss problem, the vector a contains the nodal displacements
as given by Eq. (3-35). The solution may be obtained by any of the methods suitable
to a system of linear algebraic equations. In this chapter, only the matrix inversion
method of solution is used. In Chapter 6, another method is presented.
In thermal analysis problems the vector a is generally composed of the nodal
temperatures, and in fluid flow problems it is composed of the nodal velocities and
nodal pressures.
Step 7: Calculation of the Element Resultants
The element resultants, such as axial elongations, strains, stresses, and internal
forces, are computed more or less directly from the nodal displacements from the
solution step. In thermal analysis and fluid flow problems, the element resultants

SUMMARY OF THE BASIC STEPS
73
are the internal heat-flows and fluid stresses, which are computed from the nodal
temperatures and nodal velocities, respectively.
3-5
THREE-DIMENSIONAL TRUSS FORMULATION
Let us now extend the development in Sec. 3-2 to the three-dimensional truss.
Consider the global xyz coordinate system shown in Fig. 3-II(a). Note the position
vector r which defines an arbitrary point P. Let us write the vector r in terms of
its three cartesian components as follows
r = r,i + rj + r.k
(3-66)
where i, j, and k are the three unit vectors in the x, y, and z directions, respectively,
as shown on the figure.
As in the two-dimensional truss formulation, let us write the same vector r in
terms of its components in the rotated coordinate system x'y'z' where, with no loss
of generality, the x' axis is purposely taken to be in the same direction as r itself,
as shown in Fig. 3-ll(b). Writing the vector r in terms of its components
(r;,
r~, and r;) in the rotated system, we have
r = r;i' + <j' + r;k'
(3-67)
where i', j', and k ' are the unit vectors in the x', y', and z' directions, respectively.
Again the x'y'z' coordinate system is commonly referred to as a local coordinate
system. From Eqs. (3-66) and (3-67), we have
r,i + rj + r.k = r;i' + ,:r + r;k'
(3-68)
Forming the dot product of this last equation with i gives
h'
f
/
I
v,
\
\
\
\
\
\
\,
,,\
)
\
~-------~y
x
x
(a)
(b)
Figure 3-11
Position vector r in a three-dimensional (a) global coordinate system and (b)
local coordinate system.

74
TRUSS ANALYSIS: TIlE DIRECT APPROACH
But
H'
j.j'
and
COS(x.x')
costr.y')
(3-69)
(3-70a)
(3-70b)
i-k'
Therefore, Eq. (3-69) becomes
COS(x.z')
(3-70c)
In a completely analogous manner, we also have
and
The last three equations may be written in matrix notation as
(3-71)
(3-72)
(3-73)
(3-74a)
or more concisely as
r = Tr'
(3-74b)
Equation (3-74b) transforms the components of an arbitrary vector in the local
coordinate system to the components in the global system. Since it can be shown
that the transformation matrix T is orthogonal, we have
T' = T- 1
and
where
r '
T -Ir
(3-75)
We are now in a position to develop the global element stiffness matrix from
the local one for the three-dimensional truss. First of all, we must extend the notation
to include the z and z' components of the nodal displacements and nodal forces.
Let us represent the three components of displacement as u, v, wand the three
components of nodal forces as U. V. W. The subscripts i and j are used as usual
to denote the two respective nodes on each element. A prime (') denotes that the

THREE-DIMENSIONAL TRUSS FORMULATION
75
variable in question is referenced to the local system (i.e., the x'y'z' coordinate
system), while the absence of a prime refers to the global system (i.e., the xyz
coordinate system). Figure 3-12 may help to clarify the notation; only nodal dis-
placements are shown, since the figure showing nodal forces would look identical
except that uppercase letters would be used to denote the forces.
As in the development for the two-dimensional truss, the two nodal displace-
ments in the x' direction, u; and u;, are related to the two nodal forces in the same
direction, V; and VJ, by
V'
AE
,
uJ)
= -(u
-
I
L
'
and
V'
AE
,
u;)
= -(u
-
J
L
.I
(3-77al
(3-77bl
where A represents the cross-sectional area of the element, E the modulus of
elasticity, and L the element length. Now L may be computed from
L = Y(xi - xif + (vi - yY + (Zj
-
zY
(3-781
For the truss element only axial loads are allowed, and so we have
and
v; = W; = 0
(3-77cl
v'.I
W'.I
o
Iii
..-__ I'j
(3-77dl
Figure 3-12
Nodal displacements in xyz and x'y"z' coordinate systems.

76
TRUSS ANALYSIS: THE DIRECT APPROACH
In other words, all joints are assumed to be pinned. Let us write Eqs. (3-77) in
matrix form as
I
0
0 I-I
0
0
I
V'
I
u,
I
0
0
0
I
0
0
0
I
V'
I
Vi
I
AE
0
0
0
I
0
0
0
w~
W
I
-
-----------~---------
I
I
(3-79a)
L
--7-
-7F
-I
0
0
I
I
0
0
Uj
I
,
0
0
0
I
0
0
0
v;
V'
I
;
0
0
0
I
0
0
0
~~/
W'
I
I
,
or much more concisely as
(3-79b)
where KC' represents the local element stiffness matrix, a" the local element nodal
displacement vector, and r' the local element nodal force vector.
Let us now determine the global element stiffness matrix. From the development
in Sec. 3-2, it should be obvious that
and
where
R
Rfl'
nil
n21
nll I 0
0
0
.
1
nl2
n22
n32 I 0
0
0
n 13
n23
n,,: 0
0
0
---------------r-------------
o
0
0 I nil
n 21
nll
o
0
O! n12
n22
n32
o
0
0 I n 13
n23
n"
(3-80)
(3-81)
(3-82)
As usual, a" and f", respectively, denote the vector of nodal displacements and the
vector of nodal forces for element e, referred to the global system. These are given
explicitly by
and
fC = I Vi
V,
W, i V,
Vi
W; IT
Equation (3-79b) becomes
K,,'Ral' = Rf"
which may be premultiplied by R - I (which equals RT) to give
(3-83)
(3-84)
(3-85)
(3-86)

THREE-DIMENSIONAL TRUSS FORMULATION
77
where K" represents the global element stiffness matrix and is obviously defined
by
-n3l nll
-
n31 n21
-n~1
If K" is determined explicitly, one gets
,
nil
n21 nll
n31 nll
AE
n lln21
n~1
n31 n21
Ke
-
n l ln11
n2l n31
n~1
L
-------- --------------- - -- - - - - - --
-nT,
-n2l nll
-n3l nll
-nlln21
-n~1
-
n31 n21
-nlln31
-n2l n31
-n~1
(3-87)
-nT,
-n2l nll
-n l ln21
-n~1
-n l ln31
-n21 n31
------------------ - - - -- - ----- - ----
nT,
n2lnl,
n31 nll
n l ln21
n~1
n31 n21
n1lnn
n2ln31
n~1
(3-88)
Interestingly, the global element stiffness matrix K" is a function of only three
easily calculated direction cosines, namely, nib n2l, and n3b in addition to A, E,
and L. By definition of the direction cosines, we have
nil = cos(x,x')
costy.x')
cos(z,x')
(3-89a)
(3-89b)
(3-89c)
Let us define the vector rij which runs from node i to j in the global system as
(3-90)
But Irijl = L, and
SO we have
i'
~
L
(3-91)
( X - X)
(v - v)
(z - z)
i'=Ti+yj+T k
But dotting both sides of Eq. (3-92) with i gives
x'
-
x-
•• /
I
f
1'1 =-'--
L
(3·92)
where H'
and
costx.x')
nil' Similarly dotting Eq. (3-92) withj and k gives
Yj -
Yi
L

78
TRUSS ANALYSIS: THE DIRECT APPROACH
k-i'
'I
L
In summary, the three direction cosines 1111,11210 and 1131 are given by
Xj
-
Xi
1111 = COS(X,X') =
(3·93a)
costy.x')
Yj - Yi
L
(3·93b)
f
Z)
-
Zj
1111 = COS(Z,X ) = ---
.
L
(3·93c)
where L, of course, is the length of the element given by Eq. (3-78). For any
element, the global nodal coordinates are known since they are an integral part of
the input to any finite element program. Therefore, the global element stiffness
matrix K' is easily computed from Eq. (3-88).
The assemblage process remains the same as described in Sec. 3-2 except that
each of the four 2 X 2 submatrices in K" is now a 3 x 3 submatrix. Prescribed
displacement boundary conditions are applied in the usual manner. External nodal
forces are also applied in the same manner as described in Sec. 3-2 for the two-
dimensional truss. The resulting assemblage system equation
Ka = f
(3-94)
is solved for the nodal displacements, which in tum can be used to solve for the
internal axial forces and stresses in each element. The procedure is summarized
below. The elongation 8 of an element is given by
where from Eq. (3-75), we have
8 = u; - u;
(3-95)
and
(3-96a)
(3·96b)
Since the direction cosines are readily calculated with the help of Eq. (3-93). and
since the nodal displacements u., Vi.
Wi. "r- Vj' and wi are now known (i.e .• from
the solution for a in Ka = fl. the elongation 8 is easily found for each element.
The axial strains E. stresses
(J. and forces F within each element can then be
determined by using Eqs. (3-43) to (3-45). Negative values of E, (J. and F denote
compression (when 8 < 0). This completes the formulation of the three-dimensional
truss problem.

;)ESCRIPTION OF A SIMPLE COMPUTER PROGRAM: TRUSS
79
3-6
DESCRIPTION OF A SIMPLE COMPUTER PROGRAM: TRUSS
A simple FORTRAN program for the analysis of two-dimensional trusses is pre-
sented in this section. A complete listing of the program is provided in Appendix
B. The program is capable of analyzing trusses with up to 20 joints and 30 members.
No more than 5 different types of "materials" may be present with no more than
15 different nodal forces and 5 different prescribed displacements. Although nearly
20 subroutines are used, the program is quite simple. In fact, the use of subroutines
in this manner should facilitate one's understanding of the program. In general,
each subroutine performs only one task or a few related tasks. Any consistent set
of units may be used.
The program is written in the American National Standards Institute FORTRAN
language as described in the ANSI document X3.9-1966 (approved on March 7,
1966). The newer FORTRAN 77 is not used, but the program should run with no
significant changes on systems using FORTRAN 77. The program is meant to be
run from a console where the variable LCONSL in the main program is the console
device number (e.g., 3 on an Apple II microcomputer, 5 on the VAX 11/780). The
user should change this number accordingly on his or her particular system.
The input to the program is described in detail in Appendix B. Table 3-1
contains a ready reference for the input to TRUSS and should be used in conjunction
with Appendix B. The input is divided into seven sections. Section I begins with
an SO-column title, which may be used to document the case being run. This title
is followed by the master control data, which includes the number of nodes, the
number of elements, the number of materials, the number of different prescribed
displacements, the number of different point loads, and the output device number.
Each of the remaining six input sections is always preceded by a dummy subtitle
whose only purpose is to make the input file more readable.
Input Sections 2 and 3 are used to define the mesh, including nodal coordinate
and element data, as well as the material set flags for each element. As explained
in Appendix B, the nodal coordinate and element data may be defined on a one-
by-one basis or they may be generated. Input Section 4 contains the material
property data for each material set present. For the truss, these properties are the
cross-sectional area and modulus of elasticity. Input Sections 5, 6, and 7 include
the boundary condition flag data, the imposed nodal force data, and the imposed
nodal displacement data. Input Sections 2 through 7 must be terminated with a
mandatory blank line.
Description of the Program
A simplified flowchart of the main program is shown in Figure 3-13. This flowchart
is typical of all finite element programs that are based on the so-called stiffness
approach. The main program does not do any of the finite element computations-
these are relegated to the subroutines.

80
TRUSS ANALYSIS: THE DIRECT APPROACH
Table 3-1
Summary of Input to TRUSS Program
The input to TRUSS is summarized to provide a ready reference once the detailed input
explanations are understood (see Appendix B). All titles are read under 20A4 formats, all
integer input variables arc read with 18 formats, and all real input variables are read with
F8.0 formats. Integer variables always begin with the letters I to N. Microsoft's FORTRAN-
80 allows the user to enter the data in free format style with eommas or tabs (control-I)
separating the input fields.
Section I Input
TITLE (80-column title)
NNODES
NELEM
NMATLS
NPDIS
NPLDS
LOUT
Section 2 Input
SUBT
(e.g., NODAL COORDINATE DATA)
NI
NG
NF
XI
YI
XF
YF
(blank line)
Section 3 Input
SUBT (e.g., ELEMENT DATA)
LI
MS
LG
LF
NG
NI
NJ
(blank line)
Section 4 Input
SUBT (e.g.. MATERIAL PROPERTY DATA)
MSNO
AREA
ELMOD
(blank line)
Section 5 Input
SUBT (e.g .. BOUNDARY CONDITION FLAG DATA)
NI
IBCX
IBCY
NG
NF
(blank line)
Section 6 Input
SUBT (e.g., NODAL FORCE DATA)
NFORCE
FORCE
(blank line)
Section 7 Input
SUBT (e.g.. NODAL DISPLACEMENT DATA)
NDISP
DISP
(blank line)
The main program begins by setting LCONSL to the console device number
and by writing on the screen:
INPUT THE NUMBER OF THE INPUT FILE (6-10):

DESCRIPTION OF A SIMPLE COMPUTER PROGRAM, TRUSS
81
to which the user responds "6" if the input file is FORT06.DAT, "7" if the input
file is FORT07.DAT, etc. If the user enters "0" or presses the RETURN key,
the program stops. This gives the capability to run multiple cases. This is the only
oortion of the program that is system-dependent and it may need to be modified
for use on other systems. The description given here applies to the Microsoft version
of FORTRAN called FORTRAN-80 (7), and the program runs without changes on
the Apple II Plus microcomputer with a Z-80 card installed, as well as on other
microcomputers with the CP/MI operating system.
The main program then reads the 80-column title and the master control data.
The mesh is generated by calls to subroutines NODGEN and ELEGEN. In sub-
routine NODGEN, Section 2 of the input file is read and the nodal coordinates are
specified either on a node-by-node basis or by generation. The x and y coordinates
of node I are stored in XCOOR(l) and YCOOR(l), respectively. In subroutine
ELEGEN, Section 3 of the input file, which is used to define the elements and to
specify the material set flags for each element, is read. Again, these data may either
be given on a element-by-element basis or by generation. The method used to
generate the mesh is described later in this section. For element L, the global node
numbers I and J are stored in NODl(L) and NODJ(L), respectively, and the material
set flag is stored in MATFLG(L). The material property data in Input Section 4
are read next by a call to subroutine MATERL. For material set number MSNO,
the cross-sectional area and the modulus of elasticity are read and stored in DAT-
MAT(MSNO,I) and DATMAT(MSNO,2), respectively.
Subroutine BCOND is then called; it reads the boundary condition flags, the
imposed nodal forces, and the imposed nodal displacements. The boundary con-
dition flags may be specified either on a node-by-node basis or by generation. For
node I, the two boundary condition flags in the x and y direction are stored in
NBCX(l) and NBCY(I), respectively. For nodal force number NFORCE, the value
of the force is read and stored in FORCE(NFORCE). Similarly, for nodal displace-
ment number NDlSP, the value of the displacement is read and stored in DlSP(NDlSP).
The use of the boundary condition flags is explained in detail in Appendix B.
Suffice it to say now that negative flags are used to denote forces and positive flags
to denote displacements. The input data are then printed in summary form by a call
to subroutine SUMMRY.
In the next section of the main program, the assemblage nodal force vector
and the assemblage stiffness matrix are zeroed-out. The respective array names are
ANFY and ASM. Since 20 joints or nodes are allowed and each node has two
degrees of freedom (x and y components of displacement), the dimensions of ANFY
and ASM are 40 x I and 40 x 40, respectively.
In the DO loop labeled "2500" the global element stiffness matrices are
generated by a call to subroutine STIFF with the help of prior calls to subroutines
COORDS, LENGTH, PROPTY, and TRANSF. Subroutine COORDS simply re-
'CP/M is a registered trademark of Digital Research.

Read input file
number from
console (LIN)
Is
L1N=O
No
Read title and
input data
(generate mesh)
Yes
Stop
No
Is
"--------,
L = NELEM
Figure 3-13
Flowchart of program TRUSS.

DESCRIPTION Of A SIMPLE COMPUTER PROGRAM: TRUSS
83
turns the x and y coordinates of nodes I and J for element L and stores them in
XX(l), YY(l) for node I and XX(2), YY(2) for node J. Subroutine LENGTH
computes the length of a straight line between two points and, of course, is used
to compute the element length. Subroutine PROPTY returns the cross-sectional
area (AREA) and the elastic modulus (ELMOD) to be used for element L from the
DATMAT array. Subroutine TRANSF returns the two direction cosines, nil and
n2l' which are needed to obtain the global element stiffness matrix for element L.
These direction cosines are stored in DlRCOS(l) and DlRCOS(2), respectively.
Subroutine STIFF then generates the global element stiffness matrix directly
by using Eq. (3-26). As in the example problem in Sec. 3-3, it is more expedient
to use Eq. (3-26) rather than Eq. (3-25) since the matrix multiplications result in
the disappearance of nl2 and n22 as shown in Sec. 3-2. The 4 x 4 global element
stiffness matrix, stored in array ESM, for element L is immediately assembled into
the assemblage stiffness matrix ASM by a call to subroutine ASSEMK. In other
words, the element stiffness matrix for element I is generated and assembled, then
for element 2, and so forth. This reduces the memory required since the individual
element stiffness matrices are not saved. The reader should examine the listing of
subroutine ASSEMK in Appendix B carefully because it gives the algorithm for
the assemblage step in a very explicit form.
The assemblage nodal force vector ANFY is generated by subroutine ANFYEC
that applies the nodal forces. Then the assemblage stiffness matrix and the assem-
blage nodal force vector are modified to impose the prescribed displacements by a
call to subroutine PDBC. Method I of Sec. 3-2 is used to impose these displace-
ments. The system of equations Ka = f is then solved by calling subroutine
EQSOLY which returns the solution for the nodal displacements in the vector SOLN.
Subroutine EQSOLY obtains the solution by calling the matrix inversion subroutine
INYDET [8] (which computes K -I), and the matrix-vector multiplication subrou-
tine MATYEC (which computes a by postmultiplying K - I by the vector f). The
nodal displacements are printed by calling subroutine PRINTN, and the element
resultants are computed and printed via a call to the postprocessor subroutine
POSTPR. The element resultants include the following for every element: the axial
elongation, strain, stress, and force.
The main program then returns to the beginning for a new case. The user may
then enter the input file number for a second case. If no more cases are to be run,
the user simply presses the RETURN key on the console to stop execution. Cases
may also be stacked in one input file.
Mesh Generation
All practical finite element programs must have provisions for some type of node
and element generation-referred to collectively as mesh generation. The TRUSS
program can be used to illustrate one simple mesh generation scheme. Some schemes
generate the nodes and elements in two separate steps (such as the one to be presented
here), whereas others generate nodes and elements in one integrated step. References

84
TRUSS ANALYSIS, THE DIRECT APPROACH
[9-11] give other mesh-generating algorithms. The scheme used here is patterned
after that presented by Zienkiewicz [12].
Node Generation
The easiest way to introduce the node generation scheme used in the TRUSS program
is to illustrate it with an example. Consider the straight line shown in Fig. 3-14(a)
along which six equally spaced nodes are to be placed. Let us assume that the
nodes are numbered in such a way that the difference between two successive node
numbers is a constant, as shown in the figure. Let NI be the initial node, NG the
nodal increment, and NF the final node. In the present example, we have NI =
3, NG = 4, and NF = 23. Let us further assume that the coordinates of nodes
NI and NF are also known and are given by (XI,YI) and (XF,YF), respectively.
The number of equally spaced divisions, DIY, is given by
NF -
NI
DIY =
NG
which is always a whole number (providing the nodes are numbered properly). The
increments in the x and y directions, OX and OY, are then given by
XF -
XI
OX =
DIY
and
YF -
YI
OY =
DIY
The first node in this generation sequence is completely specified since its node number
is NI and its coordinates are (XI,YI). The second node is defined from the first with
the global nodal number given by NI + NG, the x coordinate by XI + OX, and the
y coordinate as YI + OY. The third node is generated from the second in a similar
fashion. This process is repeated until the last node (whose global number is NF) is
generated. In order to avoid round-off errors, it is prudent to assign the known co-
ordinates (XF,YF) to node NF. In the present example, DIY = (23 -
3)/4 = 5,
o
(a)
13. I hi
o Node numbers
o Node numbers
D Element numbers
(b)
Figure 3-14
Illustration of mesh generation for (a) the nodes and (b) the elements.

DESCRIPTION OF A SIMPLE COMPUTER PROGRAM: TRUSS
85
ox = [3 -
(-2)]/5 = I, and OY
dinates are summarized as follows.
(16 -
6)/5
2. The resulting nodal coor-
Node number
x coordinate
y coordinate
3
-2
6.
7
-I
8.
II
0
10.
15
I.
12.
19
2.
14.
23
3.
16.
In summary, the following variables must be provided as input: NI, NG, NF,
XI, VI, XF, YF. The reader should compare these variables with those required
in Input Section 2 described in Appendix B and summarized in Table 3-1. In Chapter
7, this method is modified slightly so that the nodes are not necessarily equally
spaced. This modification allows the practical use of graded meshes.
Element Generation
Like nodal generation, element generation is explained most easily by an illustration.
Let us consider the elements shown in Fig. 3-14(b). It should be noted that not
only is there a constant difference between two successive node numbers, but there
is also a constant difference between two successive element numbers. Let LI be
the initial element number, LG the element number increment, LF the final element
number, and NG the nodal number increment, Furthermore, let us assume that
nodes i and j for the initial element LI are given by NI and NJ, respectively. This
is also a very convenient place to specify the material set to be used for all elements
in this generation sequence. Let us denote the material set flag as MS. It should
be apparent that the first element is completely defined because the element number
is LI' nodes i and j are Nl and NJ, and the material set number is MS. From this
element, it is a simple matter to define the second element: the element number is
LI + LG, node i is NI + NG, node j is NJ + NG, and again the material set
number is MS. The third element is defined from the second, and so on, until the
last element LF is defined. For the example above, LI = 4, LG = 7, LF = 32,
and NG = 4. Let us assume arbitrarily that material set 2 is to be used for these
elements. The resulting element definitions in this element generation sequence are
summarized as follows:
----
Element
Node
Node
Material
number
j
set number
4
3
7
2
II
7
II
2
18
II
15
2
25
15
19
2
32
19
23
2

86
TRUSS ANALYSIS: THE DIRECT APPROACH
In summary, the following variables must be specified for each element gen-
eration sequence: L1, MS, LG, LF, NG, NI, and NJ. These variables should be
compared with those required in Input Section 3 (Table 3-1 and Appendix B). The
reader should also examine subroutines NODGEN and ELEGEN in Appendix B
carefully so that this method of mesh generation is thoroughly understood.
Example 3-7
Using the TRUSS program. resolve the example problem in Sec. 3-3. More spe-
cifically, determine the displacements of each joint, and for each member determine
the axial elongation, strain, stress, and internal force. The truss is shown in Fig.
3-4(a).
Solution
For convenience, let us use the discretization (or mesh) shown in Fig. 3-4(b). A
complete listing of the input file is given in Table 3-2. The reader should study
this input with frequent reference to Table 3-1 and Appendix B. A few key points
with respect to the input are made below.
First note that following the TITLE are the master control data: four nodes,
five elements, two materials, one prescribed displacement, two different point loads,
and 3 for the output device number (the Apple II console). This is immediately
followed by the NODAL COORDINATE DATA subtitle and the actual input. Note
that nodes I and 2 are defined on a node-by-node basis (NG = 0), while nodes 3
and 4 are defined via the generation feature (with NG = I). These input lines are
followed by a mandatory blank line.
The ELEMENT DATA subtitle and data follow next. Elements I, 3, and 5
are defined in the first-generation sequence and elements 2 and 4 in the second-
generation sequence. From the first sequence note that element 3 would be defined
as having nodes 2 and 3 (in this order). It is desirable to use the discretization from
Example 3-1, and for this reason element 3 is redefined in the input file as having
nodes 3 and 2. The TRUSS program always uses the latest nodal coordinate and
element data specified. Again a mandatory blank line terminates this input section
(as well as all the following sections).
The MATERIAL OATA subtitle and material property definitions then follow.
Note that the material data can be specified in any order. The BOUNDARY CON-
DITION FLAGS subtitle and data follow. Note that the flags for node 2 are not
defined, so IBCX = 0 and IBCY = 0 are used (by default) for this node. The
input file is completed by the NODAL FORCE LOADS and CONSTRAINED
NODAL DISPLACEMENTS subtitles and data. The material data, force data, and
displacement data may be specified more than once for each condition (like the
nodal coordinate, element, and boundary condition flag data). The program simply
uses the last values read when conflicting input data are provided.
The output from the program is shown in Table 3-3 and is self-explanatory.
The nodal displacements and element resultants agree with the results from Sec.
3-3.
..

DESCRIPTION OF A SIMPLE COMPUTER PROGRAM: TRUSS
87
Table 3·2
Input Data File for Example 3-7
10.
1;
o.
0.0
6.0
1
O.
EXAMPLE 3-7: MODEL OF TRUSS SHOWN IN FIG. 3-1;
1;
5
2
1
2
3
NODAL COORDINATE DATA
1
12.0
2
12.0
3
O.
ELEMENT DATA
1
1
2
5
1
1
2
2
2
2
1;
1
3
1
3
1
0
0
0
3
2
MATERIAL DATA (2 DIFFERENT MATERIALS)
2
0.1257
11.E+06
1
0.1963
3o.E+06
BOUNDARY CONDITION FLAGS
1
-1
-2
0
3
100
1;
110
o
oo
NODAL FORCE LOADS
1
-1000.
2
-1732.
CONSTRAINED NODAL DISPLACEMENTS
1
0.00
(blank line)
3-7
REMARKS
It is important to put this rather lengthy chapter into perspective. The two-dimen-
sional truss was defined, and the complete finite element formulation was presented.
A simple problem was solved by hand to illustrate the process. The basic steps
were then summarized and extended to the three-dimensional truss. A simple pro-
gram called TRUSS was described; it may be used to solve more complicated two-
dimensional truss problems. The program illustrates the basic features of most finite
element programs.

Table 3-3
Output from Program TRUSS for Example 3-7
EXAMPLE 3-7: MODEL OF TRUSS SHOWN IN FIG. 3-L;
NUMBER OF NODES:
L;
NUMBER OF ELEMENTS:
5
NUMBER OF MATERIALS:
2
NUMBER OF PRES DISP:
1
NUMBER OF PT LOADS:
2
OUTPUT UNIT NUMBER:
3
NODE NO.
1
2
3
L;
IBCX
-1
o
1
1
IBCY
-2o
o
1
X-COORD
12.000
12.000
0.0000
0.0000
Y-COORD
0.0000
6.0000
0.0000
10.0000
ELEMENT NO.
1
2
3
L;
5
NODE I
1
3
3
L;
3
NODE J
2
1
2
2
L;
MAT SET FLAG
1
2
1
2
1
MATERIAL
1
2
AREA
.1%3
.1257
ELASTIC MODULUS
. 3000E + DB
.1100E + DB
SUMMARY OF DIFFERENT EXTERNAL LOADS
NUMBER
NODAL FORCE
1
-1000.0
2
-1732.
SUMMARY OF PRESCRIBED NODAL DISPLACEMENTS
NUMBER
NODAL DISP.
1
0.000
SUMMARY OF NODAL DISPLACEMENTS
NODE NO.
X-COMPONENT
1
-.B67B7E-02
2
.99552E-02
3
0.0000
L;
0.0000
Y-COMPONENT
-.35277E-01
-.33513E-01
-.176L;6E-02
0.0000
SUMMARY OF ELEMENT RESULTANTS
ELEMENT NO.
ELONGATION
STRAIN
1
.176L;6E-02.29L;11E-03
2
-.B67B7E-02 -.72322E-03
3
-.52939E-02 -.39L;59E-03
L;
.200L;2E-01
.15M5E-02
5
.176L;6E-02
.176L;6E-03
88
STRESS
FORCE
BB23.2
1732.0
-7955.L; -1000.00
-111'131'1.
-2323.7
17L;29.
2190.1'1
5293.9
1039.2

REMARKS
89
Although the approach illustrated in this chapter is referred to as the finite
element method, this is but one type of many finite element methods. The method
presented here and throughout this book is referred to as the stiffness approach,
where the primary unknowns a are related to the nodal forces f by the relationship
Ka
=
f. Not surprisingly, K is referred to as the stiffness matrix. An alternate
finite element method exists, called theflexibility method or theforce matrix method,
where the primary unknowns are the nodal forces. The form of the global system
equation is Lf = a, where a, as usual, represents the (now known) nodal displace-
ments. Obviously, the flexibility matrix L is related to the inverse of the stiffness
matrix K. The stiffness approach is much more powerful and popular than the
flexibility approach. For this reason, the stiffness approach is used exclusively in
this book.
Although the finite element method is generally regarded as an approximate
solution technique, it does give the exact solution for the two-dimensional truss
(and the three-dimensional truss). The reason for this is that the elongation 0 is
given exactly by PLiAE (providing that A and E are constant in any member). The
assumption of smooth pin joints, which is also accommodated exactly in the finite
element formulation, also contributes to the exact solution by the finite element
method. Some argue that because the truss model is exact it should not be considered
a bona fide application of the finite element method. Needless to say, the author
does not agree with this point of view.
Section 3-2 deserves some special attention. It will become evidentin later
chapters that most of the steps delineated in this section are routine and are readily
extended to other applications in structural analysis, as well as to problems in other
disciplines. The reader will soon come to appreciate the following steps as being
routine in structural analysis: (I) discretization, (2) assemblage of the stiffness
matrix and nodal force vector, (3) application of the prescribed displacements, (4)
solution for the nodal displacements, and (5) calculation of element resultants. The
steps that are different for different models are the ones in which we determine the
local and/or global element stiffness matrices and nodal force vectors-conveniently
referred to as the element characteristics. Anyone of several methods may be used
to derive the element characteristics: (I) the direct approach, (2) the variational
approach, (3) the virtual-work approach, or (4) the weighted-residual approach. In
this chapter, only the direct approach is used (although it may not seem to be very
direct to the newcomer to the finite element method). Nevertheless, a direct and
well-known relationship, namely,
AE
P =-8
L
was used to obtain the element characteristics as given by Eq. (3-3) in the local
coordinate system and by Eq. (3-24) [and Eq. (3-26)] in the global system. The
direct approach is not easy to apply when the elements to be used are not obvious.
In these cases other, more indirect, approaches are taken. These other approaches
are discussed in several of the following chapters.

90
TRUSS ANALYSIS, TIlE DIRECT APPROACH
REFERENCES
I. Beer, F. P., and E. R. Johnston, Jr.. Vector Mechanics for Engineers: Statics and
Dynamics, McGraw-HilI, New York, 1962, p. Ill.
2. Cheung, Y. K., and M. F. Yeo, A Practical Introduction to Finite Element Analysis,
Pitman, London, 1979, p. I.
3. Desai, C. S., Elementary Finite Element Method, Prentice-Hall, Englewood Cliffs,
N.J., 1979, pp. 30-31.
4. Zienkiewicz, O. c., The Finite Element Method, McGraw-Hill (UK), London, 1977,
pp. 135-136.
5. Huebner, K. H., The Finite Element Methudfor Engineers, Wiley, New York, 1975,
pp.51-53.
6. Zienkiewicz, O. c.. The Finite Element Methud, McGraw-Hill (UK), London, 1977,
p. 85.
7. FORTRAN-SO User's Guide, Microsoft FORTRAN-SOfor the Apple II Computer, Mi-
crosoft Consumer Products, © 1980, Bellevue, Wash.
8. Hornbeck, R. W., Numerical Methods, Quantum, New York, 1975,
9. Zienkiewicz, O. C.; The Finite Element Method, McGraw-Hill (UK), London, 1977,
pp. 204-207.
10. Zienkiewicz, O. C.; and D. V. Phillips, "An Automatic Mesh Generation Scheme for
Plane and Curved Element Domains," lnt . J. Numer. Methods Eng., vol. 3, pp. 519-
528, 1971.
11. Gordon, W. J., and C. A. Hall, "Construction of Curvilinear Coordinate Systems and
Application to Mesh Generation," Int. J. Numer. Methods Eng.; vol. 7, pp. 461-477,
1973.
12. Zienkiewicz, O. c., The Finite Element Methud, McGraw-Hill (UK), London, 1977,
p.693.
PROBLEMS
3-1
Discretize the simple Warren truss shown in Fig. P3-1 by making tables similar to
those in Example 3-1. Use the global coordinate system shown in the figure. The
truss is composed of equilateral triangles whose sides are 3 feet long. Members A,
C, E, G, I, and K are made ofO.5-in.-diameter steel rods and members B, D, F, H,
and J of 0.25-in.-diameter aluminum rods.
Figure P3-1
3-2
Discretize the Pratt truss shown in Fig. P3-2 by making tables similar to those in
Example 3-1. Use the global coordinate system shown in the figure. All members

PROBLEMS
91
are square in cross section and are made of steel. The horizontal, slanted, and vertical
members have dimensions I x
1 em, 0.75
x 0.75 em, and 0.5
x 0.5 em, re-
spectively.
H
y
r-
lOi--'..+--O----:.=---O'---<>-"'-----Al
0,
X1 1 1
r.
!.-2m
2m
2m
2m---l'
Figure P3-2
3-3
Discretize the cantilever truss shown in Fig. P3-3 by making tables similar to those
in Example 3-1. Use the global coordinate system shown in the figure. Members A,
B, and C are made of O.75-in.-diameter steel rods; members J and K are of 0.5-in.-
diameter steel rods; and the remaining members are of 0.6-in.-square aluminum bars.
Figure P3·3
3·4
Discretize the K truss shown in Fig. P3-4 by making tables similar to those in Example
3-1. Use the global coordinate system shown in the figure. All horizontal members
are 0.75-cm-diameter steel rods, and all other members are I-em-square steel bars.
~lm-1--lm-i--1 m-1--1m~
T+
1m
--.L
Figure P3·4

92
TRUSS ANALYSIS, THE DIRECT APPROACH
3-5
Compute the local element stiffness matrix for element 5 in the discretized Warren
truss shown in Fig. P3-5. The truss is composed of equilateral triangles with sides
of length L. and the members are steel rods with diameter D, where L = 2 m and
D =
I cm.
Figure P3-5
3-6
Repeat Problem 3-5 for element 8 with L = 6 ft and D = 0.5 in.
3-7
For the discretized Prall truss shown in Fig. P3-7. compute the local element stiffness
matrix for element 7 if L = 6 ft and h = 9 ft. Element 7 has a 0.5
x
1.0 in.
rectangular cross section and is composed of aluminum.
T
h1
Figure P3-7
3-8
Repeat Problem 3-7 for element 5 if L =
I m and h =
1.5 m. Element 5 has a
I x 2 cm rectangular cross-section and is composed of steel.
3-9
A cantilever truss is discretized as shown in Fig. P3-9. For element 6, determine the
local element stiffness matrix if L = 5 m and h = 7 m. Element 6 is composed of
a I-cm-diameter steel rod.
Figure P3-9

PROBLEMS
93
3-10
Repeat Problem 3-9 for element 2. which is composed of 0.5-in.-diameter steel. Take
L = to ft and h =
14 ft.
3-11
For the discretized K truss shown in Fig. P3-11. compute the local element stiffness
matrix for element 9. which is composed of a 0.75-in.-diameter aluminum rod. Take
L = 4 ft and h =
2 ft.
v~
'L2J
Figure P3-11
T"+
lt
3-12
Repeat Problem 3-11 for element 10. which is composed of a 2-cm-diameter aluminum
rod. Take L = 1.5 m and h = 0.75 m.
3-13
For element 5 of the Warren truss in Problem 3-5. determine the global element
stiffness matrix if element 5 connects
a. Nodes 3 and 4 (in this order)
b. Nodes 4 and 3 (in this order)
3-14
For element 8 of the truss in Problem 3-6. determine the global element stiffness
matrix if element 8 connects
a. Nodes 6 and 7 (in this order)
b. Nodes 7 and 6 (in this order)
3-15
For element 7 of the Pratt truss in Problem 3-7. determine the global element stiffness
matrix if element 7 connects
a. Nodes 4 and 7 (in this order)
b. Nodes 7 and 4 (in this order)
3-16
For element 5 of the Pratt truss in Problem 3-8. determine the global element stiffness
matrix if element 5 connects
a. Nodes 3 and 4 (in this order)
b. Nodes 4 and 3 (in this order)
3-17
For element 6 of the cantilever truss in Problem 3-9. determine the global element
stiffness matrix if element 6 connects
a. Nodes 4 and 5 (in this order)
b. Nodes 5 and 4 (in this order)

94
TRUSS ANALYSIS: THE DIRECT APPROACH
3-18
For element 2 of the cantilever truss in Problem 3-10, determine the global element
stiffness matrix if element 2 connects
a. Nodes 3 and 5 (in this order)
b. Nodes 5 and 3 (in this order)
3-19
For element 9 of the K truss in Problem 3-11. determine the global element stiffness
matrix if element 9 connects
a. Nodes 6 and 8 (in this order)
b. Nodes 8 and 6 (in this order)
3-20
For element 10 of the K truss in Problem 3-12, determine the global element stiffness
matrix if element 10 connects
a. Nodes 5 and 8 (in this order)
b. Nodes 8 and 5 (in this order)
3-21
Show that the matrix T defined in Sec. 3-2 is orthogonal; i.e .. show that T - I = TT
3-22
Show that the matrix R defined by Eq. (3-18) is orthogonal; i.e .. show that R-I =
RT
3·23
Indicate how the global element stiffness matrix is added to the assemblage stiffness
matrix for element 5 of the Warren truss in Problem 3-13 if element 5 connects
a. Nodes 3 and 4 (in this order)
b. Nodes 4 and 3 (in this order)
3·24
Indicate how the global element stiffness matrix is added to the assemblage stiffness
matrix for element 8 of the Warren truss in Problem 3-14 if element 8 connects
a. Nodes 6 and 7 (in this order)
b. Nodes 7 and 6 (in this order)
3-25
Indicate how the global element stiffness matrix is added to the assemblage stiffness
matrix for element 7 of the Pratt truss in Problem 3-15 if element 7 connects
a. Nodes 4 and 7 (in this order)
b. Nodes 7 and 4 (in this order)
3-26
Indicate how the global element stiffness matrix is added to the assemblage stiffness
matrix for element 5 of Problem 3-16 if element 5 connects
a. Nodes 3 and 4 (in this order)
b. Nodes 4 and 3 (in this order)
3-27
How is the global element stiffness matrix for element 6 of Problem 3-17 added to
the assemblage stiffness matrix if element 6 connects
a. Nodes 4 and 5 (in this order)
b. Nodes 5 and 4 (in this order)
3-28
Indicate how the global element stiffness matrix for element 2 of Problem 3-18 is
added to the assemblage stiffness matrix if element 2 connects
a. Nodes 3 and 5 (in this order)
b. Nodes 5 and 3 (in this order)

PROBLEMS
95
3-29
How does the global element stiffness matrix for element 9 of Problem 3-19 contribute
to the assemblage stiffness matrix if element 9 connects
a. Nodes 6 and 8 (in this order)
b. Nodes 8 and 6 (in this order)
3-30
Indicate how the global element stiffness matrix for element 10 of Problem 3-20 is
added to the assemblage stiffness matrix if element 10 connects
a. Nodes 5 and 8 (in this order)
b. Nodes 8 and 5 (in this order)
3-31
Determine the half-bandwidth of the assemblage stiffness matrix for the discretized
Warren truss in Problem 3-5:
a. By direct examination of KG
b. By Eg. (3-33)
3-32
What is the half-bandwidth of the assemblage stiffness matrix for the discretized Prall
truss of Problem 3-7:
a. By direct examination of KG
b. By Eg. (3-33)
3-33
Determine the half-bandwidth of the assemblage stiffness matrix for the discretized
cantilever truss of Problem 3-9:
a. By direct examination of KG
b. By Eg. (3-33)
3-34
What is the half-bandwidth of the assemblage stiffness matrix for the discretized K
truss of Problem 3-11:
a. By direct examination of KG
b. By Eg. (3-33)
3-35
A stadium truss is loaded as shown in Fig. P3-35. The global node numbers are also
shown. What is the assemblage nodal force vector if there are no other loads present?
7JN
-
-
C'
--
-
-
-'
-f-
1\
30
0 \(2) -_.-
-
1/ ~r-,8
CD1/
I"'"
<,'<,
JIOOU,-
i
/~
C0
(0
@
f--
I
/
\
/
\0
4000
~
01\
~
1/
\
I
i
i)J
\0)
--11l1-
"faWA
~~
,- ---
Figure P3-35

96
TRUSS ANALYSIS: THE DIRECT APPROACH
3·36
A Fink truss to be used in a roof is loaded as shown in Fig. P3-36. The global node
numbers are also shown. Determine the assemblage nodal force vector if there are
no other loads present. Note that two loads act on node 8.
2S001b\
~ r----
1--2 ft-
25" \ @
1000Ib
1/1~ '8f
70"
0 V / \ ~
\
CD1/r-,
/ -.@
30001b-
r
/ !\ / CD CD \
/ -,
G)V
\/
\1/
r-, 'lJI
~b
0)
®
.,J; Wi
x
ISOPIb
Figure P3·36
3·37
A cantilever truss is loaded as shown in Fig. P3-37. The global node numbers are
also shown. Determine the assemblage nodal force vector. Note the two loads acting
at node 7.
<, G)
0)
CD
2S0J Ib
I""
-,
""
y ..
r-,
-, ...- so" /20001b
+.
-,
I""
I""/ r\
CD
x
0
G
CD-.I)
,
1--4 rt-
'- 40"
""
I
30~01b
SOOplb
Figure P3-37

PROBLEMS
97
3-38
A Howe truss is loaded as shown in Fig. P3-38. The global node numbers are also
shown. Determine the assemblage nodal force vector.
-2m-
120~ N
35°r---
CD
0
f \ 0
-
-1500 N
I
/
-,
1\
/
/
f\..
\
y
/
V
\
\
CD/
/
CD
\
\ CD
~im
x 0)
A
70° / 0) -In ~
801
N
u
!800N
Figure P3-38
3-39
For the stadium truss in Problem 3-35:
a. Specify which degrees of freedom are restrained.
b. Indicate how the assemblage system equation Kva
these prescribed displacements.
3-40
For the Fink truss in Problem 3-36:
a. Specify which degrees of freedom are restrained.
b. Indicate how the assemblage system equation Kva
these prescribed displacements.
3-41
For the cantilever truss in Problem 3-37:
a. Specify which degrees of freedom are restrained.
b. Indicate how the assemblage system equation Kva
these prescribed displacements.
3-42
For the Howe truss in Problem 3-38:
a. Specify which degrees of freedom are restrained.
b. Indicate how the assemblage system equation Kva
these prescribed displacements.
3-43
Consider the following system of equations:
fa is modified to impose
fa is modified to impose
fa is modified to impose
fa is modified to impose
7
2
5
Using Method I of Sec. 3-2, modify (but do not solve) the system of equations to
impose X3 = -2. Do not destroy the symmetry.

98
TRUSS ANALYSIS, THE DIRECT APPROACH
3-44
Repeat Problem 3-43 using Method 2 of Sec. 3-2.
3-45
Consider the following system of four equations and four unknowns:
6Xl + 2x, + 4x) + 5X4
8
2tl + 5x,
h) +
2t4
7
4Xl
h, + 8x,
7X4
2
5xI + z.,
t», + 3X4
5
Using Method 1 of Sec. 3-2, modify (but do not solve) the system of equations to
impose Xl = 5 and x) = 3 (concurrently). Do not destroy the symmetry.
3-46
Repeat Problem 3-45 using Method 2 of Sec. 3-2.
3-47
Solve the resulting system of equations from Problem 3-43 for the unknowns (after
imposing x)
=
- 2). Use the matrix-inversion method.
3-48
Solve the resulting system of equations from Problem 3-45 for the unknowns (after
imposing Xl = 5 and .r, = 3). Use the matrix-inversion method.
3-49
Reconsider the Warren truss in Problem 3-5. If nodes 3 and 4 are found to have
displacements
0.0100 em
0.0200 em
-0.0150 em
0.0015 em
for some loading condition, determine for clement 5 the axial
a. Elongation
b. Strain
C, Stress
d, Force
3-50
Reconsider the Prall truss in Problem 3-7. If for some loading condition, nodes 4
and 7 are found to have displacements
0.0100 in.
0.0300 in.
Determine for element 7 the axial
-0.0020 in.
0.0045 in.
a, Elongation
b. Strain
C. Stress
d. Force
3-51
For some loading condition, nodes 4 and 5 for the cantilever truss in Problem 3-9
are known to have the following displacements:
0.0100 em
0.0000 em
Determine for element 6 the axial
-0.0315 em
-0.0126 em
a. Elongation
b. Strain
c. Stress
d. Force
3-52
For some particular loading condition, nodes 6 and 8 for the K truss in Problem
3-11 are known to have the following displacements:
0.0000 in.
-0.0158 in.
Us
l's
-0.0269 in.
+0.0105 in.

PROBLEMS
99
Determine for element 9 the axial
a. Elongation
b. Strain
c. Stress
d. Foree
3-53
For the truss deseribed in Sec. 3-3 and shown in Fig. 3-4. determine the element
resultants for element I by using the results in Sec. 3-3 (show the calculations).
3-54
For the truss described in Sec. 3-3 and shown in Fig. 3-4. determine the element
resultants for element 2 by using the results in Sec. 3-3 (show the calculations).
3-55
For the truss described in Sec. 3-3 and shown in Fig. 3-4, determine the element
resultants for element 4 by using the results in Sec. 3-3 (show the calculations).
3-56
For the truss described in Sec. 3-3 and shown in Fig. 3-4, determine the element
resultants for element 5 by using the results in Sec. 3-3 (show the calculations).
3-57
Verify the values obtained for the forces in each member of the truss in Sec. 3-3 by
doing a force balance on each node. Remember to include the unknown reaction
force U, at node 3 and forces U. and V4 at node 4. From the force balances. determine
the values of UJ • U•. and V. for static equilibrium.
3-58
With the help of Eq. (3-64) and the results for the nodal displacements. determine
the unknown reaction forces UJ, U4 • and V4 for the truss in Sec. 3-3. Are these results
consistent with those from static equilibrium considerations'?
3-59
Reconsider the stadium truss shown in Fig. P3-35. The nodal coordinates may be
obtained from the superimposed grid. All horizontal members are made of l-cm-
diameter steel rods and all remaining members of O.75-cm-diameter aluminum rods.
The truss is loaded and restrained as shown in the figure. Using the TRUSS program.
determine the nodal displacements and the element resultants (for all nodes and
elements. respectively).
3-60
A Fink truss is loaded and restrained as shown in Fig. P3-36. All horizontal members
are made of O.5-in.-diameter steel rods and all other members of O.75-in. square
aluminum bars. The nodal coordinates may be taken directly from the figure with
the help of the superimposed grid. Using the TRUSS program, determine the nodal
displacements and element resultants.
3-61
Reconsider the cantilever truss shown in Fig. P3-37. The horizontal. slanted. and
vertical members are made of O.75-in.-, O.5-in.-. and I.O-in.-diameter steel rods.
The nodal coordinates may be taken directly from the figure with the help of the
superimposed grid. The truss is loaded and restrained as shown. Using the TRUSS
program. determine the nodal displacements and the element resultants.
3-62
The Howe truss shown in Fig. P3-38 is to be analyzed. The truss is loaded and
restrained as shown. All vertical members are made of 1.5-cm square steel bars and
all other members of 2.0-cm-diameter aluminum rods. The nodal coordinates may
be obtained directly from the figure. With the help of the TRUSS program. determine
the nodal displacements and the element resultants.
3-63
Modify the TRUSS program in Appendix B so that it can be used to analyze three-
dimensional trusses. Make use of the formulation in Sec. 3-5.


4
Variational and Weighted
Residual Formulations
4-1
INTRODUCTION
In Chapter 3 the direct approach was introduced when the two-dimensional truss
problem was formulated. It was pointed out that alternate, more indirect approaches
exist that may be used to develop finite element models. Some of these methods
of formulation are introduced in this chapter. The reader will soon come to appreciate
that virtually all problems that are describable by ordinary and partial differential
equations can be solved by the finite element method. Moreover, linear and non-
linear problems may be solved in nearly the same way, although nonlinear problems
generally require an iterative solution.
In this chapter only steady-state problems are studied. By steady-state we mean
that the field variable is a function of spacial coordinates only and not a function
of time. Problems that allow for time-varying field variables are said to be unsteady,
transient, dynamic, or time-dependent. In some texts transient problems are referred
to as propagation problems [I). In structural and stress analysis, time-independent
problems are referred to as static or equilibrium problems, whereas time-dependent
problems are almost exclusively referred to as dynamic.
In all steady-state, static, or equilibrium problems, a system of algebraic equa-
tions results that is always in the form
Ka = f
It should be recalled that the truss model resulted in a system of equations in exactly
this form [see Eq. (3-39)). Furthermore, the vector or column matrix a always
contains the nodal unknowns, which are really the values of the field variables at
the nodal points. It cannot be emphasized enough that in structural models (without
101

102
VARIATIONAL AND WEIGHTED RESIDUAL FORMULATIONS
bending), these unknowns are the nodal displacements; in thermal models, they are
the nodal temperatures; and in fluid flow problems, they are the nodal velocities
and pressures. When a fluid mechanics problem is formulated in terms of velocities
and pressures, the formulation is said to involve the primitive variables. This is in
contrast to stream function and vorticity formulations that are less direct 12]. The
main purpose of a finite element analysis is to determine the values of the field
variable(s) at the node points. Other quantities such as the stresses or heat-flows
may then be determined in subsequent calculations.
This chapter is further restricted to the study of only one-dimensional problems.
This means that the field variable of interest is a function of only one variable,
e.g., x. Two- and three-dimensional problems are covered in subsequent chapters.
In addition, variational calculus is introduced in this chapter to familiarize the reader
with one of the most popular types of finite element formulations.
The basic difference between ordinary differential calculus and variational
calculus may be explained as follows. If we want to determine the value of x that
maximizes or minimizes some function y = f(x), we simply take the derivative of
Y with respect to x, set the result equal to zero, and solve for x. The sign of the
second derivative at this value of x indicates whether a minimum, maximum, or
point of inflection has been found. On the other hand, if we want to know what
function results in a certain definite integral taking on a minimum or maximum
value, then the calculus of variations is required. For example, if we want to obtain
the equation of the "curve" that results in the shortest distance between two points
in a plane, the calculus of variations may be used. This very example is illustrated
later in this chapter and gives the expected result: the equation is that of a straight
line that connects the two points.
4·2
SOME APPROXIMATE SOLUTION METHODS
Oftentimes exact solutions to differential equations are not easily obtained. In fact,
quite frequently, it is not even possible to obtain an exact solution with currently
available mathematical techniques. This is particularly true when the geometry is
irregular, or the properties vary spacially, or perhaps, the properties are a function
of the field variable. Problems of the latter variety are said to be nonlinear. En-
gineers, mathematicians, and applied scientists find approximate solution methods
indispensable in these cases.
Among the approximate solution techniques that are useful to a thorough un-
derstanding of how the finite element method works are the following: the Ritz
method, the variational, or Rayleigh-Ritz, method, and the weighted-residual method.
Each of these is said to be an integral method because we work with an integral
form of the problem statement instead of the governing differential equation directly.
The Ritz and variational methods are illustrated in this section.
The Ritz method is quite simple, requires no additional mathematics beyond
"'
calculus, and is, in fact, a special case of a particular weighted-residual method
(see Sec. 4-6). The variational method, on the other hand, requires some knowledge

SOME APPROXIMATE SOLUTION METHODS
103
of variational calculus-a definite disadvantage. For this reason, Sees. 4-3 to 4-5
are devoted to the development of some of the more basic concepts in variational
calculus. The weighted residual methods are deferred until Sec. 4-6. The reader is
referred to the book by Arpaci [3] for a review of the approximate solution methods
based on integral formulations to problems in heat conduction.
In some books the Ritz method is referred to as the Rayleigh-Ritz method.
Unfortunately, the variational method is also referred to as the Rayleigh-Ritz method.
Inthis text, the Ritz method always refers to the nonvariational integral formulation
and the Rayleigh-Ritz method always refers to the variational formulation.
General Concepts
Before actually illustrating the Ritz and Rayleigh-Ritz methods with a specific
problem, let us establish some general concepts. So as not to obscure the basic
ideas behind the approximate solution methods, let us restrict the present discussion
to a single governing differential equation with only one independent variable. Let
us represent the governing equation as
![T(x)] = 0
in n
(4-1)
where T represents the function sought (e.g., temperature) that is a function of x
only. The symbol n represents the domain of the region governed by Eq. (4-1).
In addition, let us specify the boundary conditions symbolically in the form
(4-2a)
and
(4-2b)
etc., where r I and r 2 include only those parts of the domain n that are on the
boundary. Figure 4-1 may help to clarify the notation.
Let us approximate the solution to Eqs. (4-1) and (4-2) with the approximate
function T' where
11
T' = T'(x; aI, a-, ... , all) = L
a;N;(x)
i= I
(4-3)
which has one or more unknown (but constant) parameters aI, a2,
, all and
that satisfies the boundary conditior.s given by Eqs. (4-2) exactly. Note that the
Domain n
01
• .v
Figure 4-1
Schematic of one-dimensional problem domain n with two global boundaries
r, and r;

104
VARIATIONAL AND WEIGHTED RESIDUAL FORMULATIONS
prime (') denotes an approximate solution (not a derivative). The functions Nj(x)
are referred to as trial functions. The problem reduces to having to make somewhat
judicious choices for these trial functions and solving for the parameters ai, a2,
, all" In general, if a sequence of approximations could be made, such as
T'
T'
T'
(4-4a)
(4-4b)
(4-4c)
then presumably better accuracy could be obtained with each successive higher-
order approximation. Equations (4-4) are referred to as the first-order, second-order,
and third-order approximations, respectively. The reader is referred to Becker,
Carey, and Oden [4] for a discussion on the necessary properties of the trial func-
tions. Suffice it to say here that they must be continuous and differentiable up to
the highest order present in the integral form of the governing equation.
It should not be surprising that if T' given in Eq. (4-3) is substituted for Tin
Eq. (4-1), the governing equation will not be satisfied exactly. Instead of getting
f(T') equal to zero, we get a residual R. Mathematically, we may write
(4-5)
where the notation is supposed to indicate that the residual R is a function of x and
the parameters ai' a2, etc. The exact solution results when the residual R is zero
for all points in the domain D. For the approximate solution methods, the residual
is not in general zero everywhere in n, although it may be zero at some selected
points.
The Ritz Method
Only the first-order Ritz approximation is considered here. Refer to the book by
Arpaci [51 for an illustration of the second-order Ritz approximation. The basic
Ritz method for the first-order approximation simply requires that the integral of
the residual R(x;aI) with respect to x be zero over the domain n, or
(4-6)
Note that since x is essentially a dummy variable in the integral, Eq. (4-6) results
in an algebraic equation in the unknown parameter aI' For well-posed problems
and a well-behaved trial function NI(x), this equation may be solved for al' Well-
behaved trial functions include those included in the set of polynomials, circular
functions, and other continuous and differentiable functions. This simple method
is best illustrated by an example.

SOME APPROXIMATE SOLUTION METHODS
105
Example 4-1
Solve the ordinary linear differential equation
d 2T
dx 2 + IOOOx 2 = 0
subject to the boundary conditions
O~x~l
(4-7)
and
T(O)
o
(4-8a)
T(l) = 0
by using the Ritz method with the trial function
NI(x) = x(l -
x2)
(4-8b)
(4-9)
This particular trial function was chosen because it allows T' to satisfy the boundary
conditions exactly, and it does not grossly violate the physics of the problem as
explained later.
Solution
The first-order approximation T' from Eq. (4-4a) becomes
T' = aINI(x) = alx(l -
x 2 )
(4-10)
An expression for the residual R is needed, but first verify that T' given by Eq.
(4-10) satisfies the boundary conditions exactly (see Problem 4-1). The residual R
by definition may be computed from
d 2T'
R = -- + lOOOx2
dx 2
And since
we have
(4-11)
Note that as the notation R(x;aI) indicates, the residual is indeed a function of x
and the parameter aI' By Eq. (4-6), the first-order Ritz method requires
L
I
( - 6alx + 1000x2) dx = 0
which may be readily integrated to give
[ -3a Ix
2 + 1000~3] I~
0

106
VARIATIONAL AND WEIGHTED RESIDUAL FORMULATIONS
Evaluating and solving for (/1 gives
(4-12)
Therefore, an approximate solution is given by
(4-13)
In Sec. 4-6, this approximate solution is compared with the other approximate
solutions as well as with the exact solution.
•
Let us try to give some physical significance to the governing differential
equation given by Eq. (4-7). The reader may recognize this as a special form of
the heat conduction equation. More specifically, Eq. (4-7) represents one-dimen
sional heat conduction in a bar of unit length insulated around the periphery with
an internal heat source (internal energy generation) that is proportional to the square
of x as depicted in Fig. 4-2. Therefore, higher temperatures are expected near the
end x = I, although the temperatures at both ends must be zero by Eqs. (4-8). In
other words, the maximum temperature T is expected to occur somewhere between
x =
0.5 and x =
1.0. It is for this reason that the trial function given by Eq.
(4-9) is most appropriate, for it too shows a maximum temperature between x =
0.5 and x =
1.0 (in fact, the reader may wish to show that the maximum occurs
at x = 0.577). In short, the trial function (and hence, the approximate solution)
used in Example 4-1 is said to satisfy, albeit approximately, the physics of the
problem. This may be stated differently as follows: the assumed temperature dis-
tribution does not grossly violate the physics of the problem.
It is emphasized that two requirements must be met by the assumed trial
function(s): (I) the physics of the problem must not be grossly violated and (2) the
boundary conditions must be satisfied exactly. Later it will be seen that the finite
II .v
Insulation around
periphery' of bar
Figure 4-2
Schematic of problem posed in Example 4-1.

SOME APPROXIMATE SOLUTION METHODS
107
element method completely eliminates these rather restrictive conditions, which are
very difficult to satisfy in most real-world problems.
The Variational Method (Ravleigh-Ritz)
Although variational calculus is covered in the next several sections, it is illustrative
to consider the main idea behind the variational method here in a numerical example.
A typical one-dimensional problem in variational calculus is one in which we try
to find a function T that minimizes or maximizes integrals of the form
f"
1 =
<I F[x,T(x),T,(x)] dx
(4-14a)
where T, denotes the first derivative of T with respect to x. The processes of
minimization and maximization are frequently referred to collectively as extremi-
zation, and the integral is said to be extremized or to be made stationary. This
integral 1 is referred to as afunctional; sometimes the integrand F is also referred
to as the functional. This is not terribly surprising because the word "functional"
means function of functions. Since F is a function of x, T, and T" and T is a
function of x itself, clearly 1 is also a function of functions. Itshould be emphasized
that the notation T, denotes the derivative of T with respect to x. The prime (') is
used to represent an approximation, not the derivative (i.e., T' is the approximation
to T, not the derivative of T). The subscript notation for the derivatives proves to
be very convenient in two- and three-dimensional variational formulations (see
Chapter 8).
It will be shown in Sec. 4-5 that the functional F that corresponds to Eq.
(4-7) from Example 4-1 is
I (dT)2
F = - -
-
+ IOOOx 2T
2
dx
(4-15)
(4-14b)
Consequently, the variational formulation of the problem in Example (4-1) becomes
1 = L'[IOOOX
2T - H~:r] dx
The idea is to find the function T(x) that extremizes I. Before illustrating how Eq.
(4-14b) is used in an approximate solution, several key points must be made.
For a well-posed problem such as that in Example 4-1, the function T(x) that
extremizes I in Eq. (4-14b) is exactly the same as that which satisfies the original
differential equation and boundary conditions. This implies that the solution T(x)
is unique, which is always the case for well-posed problems. A second observation
is that the original differential equation IEq. (4-7) Jcontains a second-order derivative
of T, whereas the variational formulation given by Eq. (4-l4b) contains only a first-
order derivative! Therefore, the variational form may be used to obtain solutions
to problems that are not readily admitted by the differential formulation. An example

108
VARIATIONAL AND WEIGHTED RESIDUAL FORMULATIONS
of this is a body with two different materials and, hence, thermal conductivities.
At the point where the two materials meet, the second derivative of the temperature
required by the differential formulation may not exist. A variational formulation of
the problem would readily yield the correct solution, since the second-derivative
in this example is not needed in the formulation. For this reason, the variational
formulation of a physical problem is often referred to as the weak formulation.
Although the discussion in the previous paragraph alluded to an exact solution
of Eq. (4-14b) for the function T(x) that extremizes the functional I, we shall use
this equation to obtain an approximate solution for T(x) , as shown in the next
example. In this text we will only be concerned with the use of variational for-
mulations in approximate solutions, except for a simple illustrative problem in Sec.
4-3.
Example 4-2
Solve the problem posed in Example 4-1 by the variational method by extremizing
I given by Eq. (4-14b) with respect to parameter a, in the approximation T (to T)
given by
(4-16)
(4-17)
(4-18)
Note that this same form of the approximate solution was assumed in Example
4-1.
Solution
In terms of the approximation T, Eq. (4-14b) may be written
I(a,) = f: [1000x2T - H~}J dx
Note that I is a function of al [as indicated by the notation I(a,)] because T is a
function of x and the parameter aI' and the x is integrated-out. The idea is to
determine a, such that
dl
= 0
da,
or, in words, such that the functional I is extremized (or made stationary). To
determine whether a minimum or maximum has been found, we may check the
second derivative of I with respect to al at the value of al that extremizes I in the
first place. If d 21!daf > 0, a minimum has been found; if d 21/day < 0, a maximum
has been found. The first derivative of T'(x; is needed in Eq. (4-17), which is
readily computed from Eq. (4-16) to be
dT
T =-
,
dx
(4-19)

SOME APPROXIMATE SOLUTION METHODS
109
Therefore, Eq. (4-17) becomes
l(a,) = L
I
{looox2(alX(l -
x 2 ) ] -
Y2(a,(l
-
3x2)J2} dx
Integration and evaluation readily yields
(4-20)
from which we may compute
Setting the right-hand side to zero and solving for a, gives
(4-21)
An approximate solution to Eq. (4-7) by the variational method subject to the
boundary conditions given by Eqs. (4-8) is
(4-22)
The reader should compare this approximate result with that from the Ritz method
of Example 4-1. The approximate solutions from Examples 4-1 and 4-2 are shown
for comparison in Fig. 4-3. These approximate solutions are compared to the exact
solution later in this chapter.
•
50
40
h
.,;
30
2
E
"0-
E
cO
"
f-
0.2
-- Ritz method
--- Rayleigh-Ritz method
(variational}
Distance along rod, x
10
Figure 4-3
Comparison of approximate solutions to problem posed in Example 4-1.

110
VARIATIONAL AND WEIGHTED RESIDUAL FORMULATIONS
4-3
VARIATIONAL CALCULUS: AN INTRODUCTION
The calculus of variations is introduced in this section for functions that are a
function of one independent variable only, e.g., y = f(x). The basic approach that
is taken utilizes only ordinary differential and integral calculus. The result is then
interpreted in light of the calculus of variations. In what follows, when a derivative
is needed the subscript notation from Sec. 4-2 is used; e.g., dTldx is denoted as
T, (not as T) and dyldx as Yr'
In general, we usually know the differential equation that describes a phenom-
enon. However, the variational formulation is usually not obvious. For example,
is it obvious that Eq. (4-14b) is the variational formulation that corresponds to the
differential formulation given by Eqs. (4-7) and (4-8)? The idea then is to develop
a systematic procedure by which we may derive the variational form of a problem
from the differential formulation.
It is very important to put the material in this section into proper perspective.
The author is of the opinion that although the variational formulation allows us to
obtain a firmer grasp of the underlying concepts behind the finite element method,
it is by no means absolutely essential to the application of the method to practical
problems. It will be learned later that the weighted-residual methods are far easier
to apply and can be used even when no variational formulation or principle exists.
This last point should be clarified. All variational formulations have a corresponding
differential formulation, but, unfortunately, the converse is not true: some differ-
ential formulations have no classical variational principle. The reader is referred
to Zienkiewicz [6] for a procedure that yields a nonclassical variational formulation
to some of these problems. This does not mean that the finite element method
cannot be used in these cases, because we simply resort to the more powerful (and
simpler) weighted-residual approach.
Before a systematic procedure is developed that will allow us to obtain the
variational form of a problem from the differential formulation, let us examine one
of the classical problems in variational calculus, that of finding the equation of the
curve that has the shortest length between two points in a plane. Obviously, the
curve is a straight line joining the two points, but let us show how the calculus of
variations may be used to prove this intuitively obvious result. First, we must set
up an integral! that represents the length of the curve. Figure 4-4 shows a family
of curves that connects points A and B in the plane of the figure. By minimizing
the integral!, we will obtain the equation of the line that results in the shortest
possible length.
An elemental arc length ds from the Pythagorean theorem is given by
which may be written as
ds = V(dx)2 + (dyf
(4-23)
ds
(4-24)

VARIATIONAL CALCULUS: AN INTRODUCTION
111
\'
B
'-----'-----------'---x
x=a
x=b
Figure 4-4
Family of curves that connects points A and B in the plane of the paper.
Therefore, the total length of the curve from x
B is given by
a at point A to x
b at point
Let us denote this integral in a slightly more general form as
I = (bF(x,y,yx) dx
j"
(4·25)
(4-26)
where x and y are included for generality, and Yx denotes dy/dx. It is shown in Sec.
4-5 that if y(x) is found such that it minimizes the integral in Eq. (4-26), the
functional F must satisfy the following differential equation:
aF _ !!.- (aF)
= 0
ay
dx
ayx
From Eqs. (4-26) and (4-25) we have
F = (I +
y~)1/2
Therefore, application of Eq. (4-27) yields
d [
Yx
]
dx
(I +
y~ )1/2
o
(4-27)
(4·28)
(4-29)
It follows that the expression in the brackets is a constant, e.g., C I> or
y,
-
C
(I +
y~)112 -
1

112
VARIATIONAL AND WEIGHTED RESIDUAL FORMULATIONS
from which it may be concluded that YI itself is (another) constant, or
Y, = C2
But Y,
dyldx and so dytdx
C2, which may be integrated to give
(4-30)
The integration constants C2 and C3 could then be determined for a particular
problem by using the boundary conditions
y(a)
y(b)
\', I
(4-31a)
(4-31b)
In any event, Eq. (4-30) represents a straight line as expected.
Figure 4-5 shows the function y(x) that actually results in the shortest length
between the two points A and B. In addition, the variation of y, denoted as oy, is
also shown. Ify(x) and its variation oy are added, we get other possible curves y(x)
for which the integral I may be evaluated. It is emphasized that in this case only
one particular curve, namely that labeled y(x), actually results in the shortest length.
4-4
SOME ADDITIONAL MATHEMATICS
Several concepts from ordinary calculus are reviewed in this section. An extension
of these concepts to variational calculus is also provided. Since our goal is to
develop an operational understanding of these concepts, no attempt is made to prove
them here. The reader may wish to consult the references at the end of this chapter
for additional information.
II
'-------------_x
Figure 4-5
The curve that results in the shortest length connecting A and B is shown along
with the variation liy and the curve ,,,(x).

(4-321
(4-331
SOME ADDITIONAL MATHEMATICS
113
Integration by Parts [7J
If du/dx and dv/dx are continuous functions of x over a suitable interval, e.g., from
x = a to x = b, then the formula for integration by parts applies and is given by
["
"
dv
b du
f u-dx = uv
- f v-dx
u
dx
a
dx
a
The first term on the right-hand side is frequently referred to as the integrated term.
Taylor's Series [8J
A function f(x) that is continuous and differentiable over an interval that includes
x = a may be written in terms of an infinite series such as
x -
a
(x -
a)2
f(x) = f(a) + fx(a)-I!- + f,,(a)
2!
+ ...
This infinite series is the Taylor series expansion for the interval. Note that f,(a)
denotes that the first derivative off with respect to x is to be evaluated at x = a,
thatf,Aa) denotes that the second derivative off with respect to x is likewise to be
evaluated at x = a, and so on. Oftentimes the terms involving the factors (x -
a)"/
n! for n ~ 2 are small in comparison to the first-order term and the truncated series
given by
f(x) = f(a) + f,(a)(x -
a)
(4-34)
(4-35)
(4-36)
is often referred to as a first-order Taylor expansion (of the function f about the
point x =
a). It is emphasized that Eq. (4-34) may be used only for values of x
very close to a.
The Differential of a Function
Consider a continuous and differentiable function f(x,y) that has two independent
variables, x and y. The differential df is then given by
af
af
df = -dx + -'-dv
ax
ay .
For a functionf(x,y,z) with three independent variables x, y, and z, we have
df = af dx + af dv + ?ldz
ax
ay'
dZ
and so on. Note that we may take the differential of a function but not of a functional,
which is a function of functions. Instead we speak of a variation, as discussed next.

114
VARIATIONAL AND WEIGHTED RESIDUAL FORMULATIONS
The Variation of a Functional
Let us now consider a functional F(x,y,y,). It should be obvious from the example
depicted in Fig. 4-5 that the variation is not taken on the variable x but rather on
the function y(x) and possibly some of its derivatives. Therefore, the variation of
x, written 8x, is identically zero, and the variation of F is given by
dF
dF
8F = -8y + -8y
dY'
dy,' .r
(4-37)
It is hinted here that the usual rules of ordinary calculus apply in the calculus of
variations, and in most cases they do. For example, Eq. (4-37) follows from Eq.
(4-36) if the differential operator d is replaced by the variational operator 8 and, if
further, it is recognized that 8x == O. Of course,Jin Eq. (4-36) is a true function,
whereas F in Eq. (4-37) is a function of functions; i.e., a functional. One other
subtle difference exists in the expressions for the differential: the variables x, y,
and z are truly independent, whereas in the expression for the variation, y and y,
are treated as though they are independent (they are actually related by y, = dy/
dx). Equation (4-37) may be readily extended to cases in which the functional F
is a function of more than two functions (see Problem 4-15).
The Commutative Properties
One of the most important properties of variational calculus is the commutative
property that states that the differential of the variation of a function y is identical
to the variation of the differential of the same function. The commutative property
may be written mathematically as
d(8y) = 8(dy)
(4-38)
A simple proof of this relationship is provided in reference [9]. It is assumed here
that the function y is differentiable.
Another commutative property is the one that states that the variation of the
integral of a functional F is the same as the integral of the variation of the same
functional, or mathematically as
J"
J"
8
a F dx
=
a 8F dx
Note that the two integrals must be evaluated between the same two limits.
Miscellaneous Rules of Variational Calculus
(4-39)
From the definitions of differentiation and variation, it can be shown that all the
rules of differentiation have variational counterparts. Let y and z be any continuous
and differentiable functions. Then we may write

THE EULER-LAGRANGE EQUATION
115
&(y + z) = &y + &z
(4-40)
&(yz) = y &z + z &y
(4-41)
&(~)
z &y -
y &z
(4-42)
0r
&(y/)
ny"-'&y
(4-43)
and so forth. The similarity between these and each of their counterparts in dif-
ferential calculus should be obvious.
4-5
THE EULER-LAGRANGE EQUATION: GEOMETRIC
AND NATURAL BOUNDARY CONDITIONS
In this section it will be seen how we may obtain the variational formulation from
the differential. As mentioned earlier, a systematic procedure to accomplish this is
desirable because, more often than not, the differential equation that describes a
particular problem is easily derived and the variational form is not. Obtaining the
variational form from the differential allows us to take advantage of some of the
approximate solution techniques-including the finite element method itself (see
Sec. 4-8).
The necessary condition for the existence of an extremum of the functional
/ = fb F(x,y,yx) dx
u
is that its first variation &/ must be zero, or
&/ = &fbF(x,y,y.) dx = 0
a
(4-44)
(4-45)
provided that
I
"
aF
-&v
a
-
Yx
1I
o
(4-46)
is satisfied [9]. We now want to find the condition(s) that y(x) must satisfy such
that the integral/ is extremized or made stationary. Let us proceed by noting that
by Eq _(4-39) the variation of the integral is the same as the integral of the variation,
and so Eq. (4-45) becomes
&/ = J:&F(x,y,y.) dx
Now with the help of Eq. (4-37), we may write
o
(4-47)
fb(aF
aF)
8/ =
-8y + -.8y,
dx
a
ay
d}"r
(4-48)

116
VARIATIONAL AND WEIGHTED RESIDUAL FORMULATIONS
Let us rewrite &y, in a more convenient form by using Eq. (4-38):
&y,
&(dy)
dx
d(&y)
dx
(4-49)
Therefore, Eq. (4-48) becomes
f
h[iJF
iJF d(&Y)]
&/ =
-&v + - --
dx
a
iJy·
iJy,
dx
(4-50)
Let us now integrate by parts the second term in the integral [see Eq. (4-32)) with
aF
u =-
iJy,
from which it follows that
and
dv
d(&y)
dx
dx
(4-51)
:
= ~(::)
Therefore, Eq. (4-50) becomes
and
v = &y
(4-52)
I
h
[
()]
iJF
h sr
d
iJF
&I = -by
+ f - -- -.
&y dx = 0
ay,
a
a
ay
dx
iJy,
One way for Eq. (4-53) to be true is if
I
h
aF
-.&v
= 0
iJv
.
• -\
a
for then we have
f
h[ aF
d (iJF)]
.
&/ =
-
- -
-
&y dx = 0
a
iJy
dx
iJy,
(4-53)
(4-54)
(4-55)
(4-56)
Note that the condition expressed by Eq. (4-54) is identical to that already stipulated
by Eq. (4-46). Since Eq. (4-55) is to hold for all arbitrary variations by, the only
way for Eq. (4-55) to hold in general is if the expression in the brackets itself is
zero or
~: - ~(:.:)
= 0
This last result is really a differential equation with y and y, as the pseudoin-
dependent variables. In fact, Eq. (4-56) is precisely the same differential equation
that results from the differential formulation in the first place. Actually F is a
functional because it is a function of two functions, y and y,. Equation (4-56) is
referred to as the Euler or Euler-Lagrange equation for the problem whose functional
is given by Eq. (4-44).

THE EULER·LAGRANGE EQUATION
117
Before interpreting these results, let us show that the functional to be extremized
for the problem in Example 4-1 is, in fact, given by Eq. (4-14b).
Example 4-3
For the problem posed in Example 4-1, show that the functional to be extremized
is given by Eq. (4-14b). Recall that the problem in Example 4-1 was stated as
follows:
Solution
d 2r
dx 2 + IOOOx 2 = 0
T(O) = 0
T(I) = 0
O~x~l
(4-7)
(4-8a)
(4-8b)
First, let us check to see whether or not the condition expressed in Eq. (4-46) [or
Eq. (4-54)] is met. In terms of the notation in this problem, Eqs. (4-56) and
(4-46) may be written
(4-57a)
(4-57b)
Since the value of T is to be held fixed at either end of the interval, 0 ~ x ~ I,
the variation of T or oT must be zero at these two points. Therefore, Eq. (4-57b)
is satisfied by virtue of the conditions T(O) = 0 and T(I) = 0, since oT = 0 at
these points. This type of boundary condition is referred to as a geometric boundary
condition [10]. When aFlaT, = 0 on the boundary, we have a natural boundary
condition (see Example 4-4). Let us now turn to Eq. (4-57a) and make a term-by-
term comparison with the governing equation expressed in Eq. (4-7), which yields
aF
-
= 1000x2
aT
and
~G;J
=
- ~ ( - :)
A further comparison of the latter yields
aF
-T,
_ d( - T,)
dx
(4-58)
(4-59)

118
VARIATIONAL AND WEIGHTED RESIDUAL FORMULATIONS
The reader may verify that Eq. (4-58) implies
F = 1000x2T + f(TJ
and Eq. (4-59) implies
F =
- Y2T/ + g(T)
(4-60)
(4-61)
by direct substitutions. A further comparison of Eq. (4-60) with Eq. (4-61) yields
.tIT,) = - Y2 T/
and
so that
(4-15)
Actually a constant term may be added to the right-hand side since the resulting
expression for F would still satisfy Eq. (4-56); however, this constant in no way
affects the extremum of the functional!. From Eqs. (4-44) and (4-15), the functional
is given by
(4-14b)
This last result is identical to that presented in Eq. (4-14b) for this same problem.
It is emphasized that the function T(x) that extremizes the functional! given in Eq.
(4-14b) is the same one that satisfies the governing differential equation and bound-
ary conditions given by Eqs. (4-7) and (4-8), respectively.
•
In Example 4-4, Eq. (4-14b) is derived in an alternate but completely equivalent
manner.
Example 4-4
By starting with Eq. (4-55) derive Eq. (4-14b) for the problem stated in Example
4-1.
Solution
We now recognize the bracketed term in Eq. (4-55). When it is equated to zero,
it becomes the differential equation for the problem. We may write from Eq.
(4-55)
o! =
(1 [1000X2 + !:!.-(dT)] st dx
Jo
dx
dx
(4-62)

THE EULER-LAGRANGE EQUATION
119
This may be broken into two separate integrals to give
(4-63)
and
U = oT
0/ = (I IOOOx2 st dx + (I!!... (dT) oT dx = 0
Jo
Jo dx
dx
Integrating the second integral by parts with
dv = !!...(dT) dx
dx
dx
yields
0/ = f IOOOx2oT dx + dT OTI'
o
dx
0
(I dT d(oT) dx
Jo dx
dx
(4-64)
Working with the second integral and using Eq. (4-38), we have
(I dT d(oT) dx = (I dT o(dT) dx = (I Y20(dT)2dX
Jo dx
dx
Jo dx
dx
Jo
dx
If in Eq. (4-64) we require that
(4-65)
dT OTI
1
= 0
dx
0
(4-66)
we are left with
(4-67)
0/ = fo
l
[ IOOOx20T -
~ 0 (~r] dx
Since the variation of x 2 is zero (recall that only T and T, have a variation), Eq.
(4-67) may be written with the help of Eq. (4-39) as
0/ = 0 fol[lOOOx2T -
~ (~~)2] dx
(4-68)
from which we conclude that the functional/itself is given by
/ = fal [IOOOX2T - ~(~r] dx
which again is identical to Eq. (4-14b).
(4-69)
•
Let us examine the condition expressed by Eq. (4-66) a little more closely.
For the geometric boundary conditions in Example 4-1, we have oT = 0 at x = 0
and x =
I. Another way in which Eq. (4-66) could be satisfied is when dTldx is
zero on the boundaries, i.e., at x = 0 and x = I in this problem. This type of
boundary condition is the so-called natural boundary condition. If T represents
temperature, then dTldx is zero when insulation is present. In a similar fashion, in
Eq. (4-57b) the condition that aFlaT, = 0 is also referred to as a natural boundary
condition.

(4-71)
120
VARIATIONAL AND WEIGHTED RESIDUAL FORMULATIONS
If in Eq. (4-64) we do not require the integrated term to be zero, the reader
may show that Eq. (4-68) becomes
o[ = O{~TI:) + Io
1
[ 1000X
2T - ~(~r]dX}
(4-70)
which introduces a mechanism by which nonzero values of dT/dx on the boundaries
may be accommodated. In Eq. (4-70) it is implied that
) [
I
[I
dT
dT
o -T
- -oT
(dX
0
-
dx
0
or that the variation is made on T only and not on dT/dx (in the integrated term
only).
In this section, we have learned how to obtain the variational formulation from
the differential in two different but equivalent ways. The class of problems has
been restricted to a single second-order differential equation in a single independent
variable x, i.e., one-dimensional problems. The Euler-Lagrange equation was in-
troduced for the class of problems whose functional F is given by Eq. (4-44),
providing we also satisfy
I
h
aF-ov
= 0
av
-
• .t
a
In Problem 4-23, the reader is asked to show that for the functional
[ = I: F(x,y,ypYxxldx
the corresponding Euler-Lagrange equation is
sr
d (aF)
d
2 (aF)
= 0
a,v -
d.x
ayx
+ dx2
ayxx
(4-72)
(4-73)
(4-74)
where y" denotes the second derivative of y(x) with respect to x. The following
conditions are assumed to exist in this case:
and
[
]
[
h
aF
d
aF
-
- -
-
ov
= 0
ayx
dx CYu) - u
[~ ] o \' Ih = 0
ayxx
~ .r
(/
(4-75a)
(4-75b)
Equations (4-74) and (4-75) are readily derived from Eq. (4-73) by following the
first of the two procedures indicated earlier in this section and by integrating by
parts twice. From Eq. (4-75a), one set of natural boundary conditions must be
given by

THE METHOD OF WEIGHTED RESIDUALS
121
o
(4-76)
while from Eq. (4-75b), we must have
::J
o
(4-77)
and
as another set of natural boundary conditions. The geometric boundary conditions
are given by
oyI: = 0
(4-78)
oyxI: = 0
(4-79)
Equation (4-78) is equivalent to the statements that y(a) is prescribed and y(b) is
prescribed, i.e., the function y(x) is prescribed on the boundaries. Equation (4-79)
implies that dyldx is prescribed at x = a and x = b as well. What order differential
equation does Eq. (4-74) correspond to? What is the highest-order derivative present
in the. functional? Try to generalize this observation.
In Problems 4-26 and 4-27, the reader will begin to appreciate why classical
variational formulations exist for only those problems whose differential formula-
tions do not contain odd-ordered derivatives.
4-6
THE METHOD OF WEIGHTED RESIDUALS
The method of weighted residuals provides an analyst with a very powerful ap-
proximate solution procedure that is applicable to a wide variety of problems. It is
the existence of the various weighted-residual methods that makes it unnecessary
to search for variational formulations to nonstructural problems in order to apply
the finite element method to these problems. Before presenting four of the most
popular weighted-residual methods, let us present a general framework around which
the various methods are developed. In the process of doing this, it is necessary to
repeat some of the general concepts given in Sec. 4-2.
General Concepts
Let us restrict the present discussion to a single governing equation with only one
independent variable. Let us represent the governing equation as
J[T(x)) = 0
in n
(4·80)

122
VARIATIONAL AND WEIGHTED RESIDUAL FORMULATIONS
where T represents the function sought (say temperature), which is a function of
only x, and where n is the domain of the region governed by Eq. (4-80). In addition,
let us specify the boundary conditions in the form
g,[T(x)]
g2[T(x)]
o
o
(4-81)
etc., where [, and [2 include only those parts of n that are on the boundary. Let
us again approximate the solution to Eqs. (4-80) and (4-81) with an approximate
function T that is given by
11
T = T't;x: a" a2, ... , (/1/) = L (/;Nlr)
i= I
(4-82)
which has one or more unknown (but constant) parameters (/"
(/2' aj, .
. (/1/ and
that satisfies the boundary conditions given by Eq. (4-81) exactly. As before, the
functions N,(x) are referred to as the trial functions. If this approximate solution T
is substituted into Eq. (4-80) for T(x), it should not be surprising that it will not
necessarily satisfy this equation exactly; that is, some residual error Rtx, a" ... ,
an) results. Therefore, we write
(4-83)
The method of weighted residuals requires that the parameters ai' (/2' ... ,
an be determined by satisfying
fnWi(X) R(x; a" a2,' .. , (/1/) dx = 0
i = 1,2, ... , n
(4-84)
where the functions wi(x) are the n arbitrary weighting functions. The choice of the
weighting functions is left largely up to personal preference, but four particular
functions are used most often. The most popular weighted-residual methods are
referred to as (I) point collocation, (2) subdomain collocation, (3) least squares,
and (4) Galerkin. Each of these is developed in turn, and the problem stated in
Example 4-1 is solved in Examples 4-5 to 4-8 with each of the methods, respectively.
Of these four methods, the Galerkin method has the widest use in finite element
analysis for reasons that will become apparent later. The least-squares method is
also used but to a much lesser extent. Some of these methods are used in Chapter
IO when FEM formulations to unsteady problems are considered.
Point Collocation
In the point collocation method, the weighting functions wi(x) are denoted as 5(x -
x;)
and defined such that
f
b 5(x -
Xi) dx =
for x = Xi
a
and
(4-85)
J: 5(x -
x;) dx = 0
for x"" Xi

THE METHOD OF WEIGHTED RESIDUALS
123
The x;'s are referred to as the collocation points and are selected arbitrarily by the
analyst. The °here has nothing to do with the variational operator but rather is
defined by Eq. (4-85). Substitution of O(x -
.r.) for Wi(X) in Eq. (4-84) gives
Ino(x -
Xi) R(x; al> a-, ... , a,rl dx = 0
for i = 1,2, ... , n
(4-86)
If Eq. (4-86) is evaluated at n collocation points, XI' X2,'
., x", then n algebraic
equations in n unknowns result:
, all)
o
o
(4-87)
R(x,,; ai' a2, ... , all) = 0
It is emphasized that the n unknowns in Eq. (4-87) are the constant parameters a I'
a2, ... , all" Once these are determined, the approximate solution is given by Eq.
(4-82) and the problem is solved, at least approximately. The constants al> a2,
... , all are dependent on the choices made for the n trial functions, NI(x), N 2(x),
... , NII(x), and on the choice made for the n collocation points. For well-posed
problems and well-behaved trial functions, the solution of the system of equations
implied in Eq. (4-87) will yield the numerical values for the ai'S. Equation (4-87)
may be written more concisely as
for i = I, 2, ... , n
(4-88)
where Xi is the ith collocation point. This method is illustrated numerically in
Example 4-5.
Example 4-5
Using the trial function assumed in Example 4-1 , determine an approximate solution
to the problem posed in that example by the point collocation method.
Solution
Note that since only one trial function is used, only one parameter (namely, aI)
may be introduced. This implies that only one collocation point may be selected.
It is as good a choice as any to choose the (one and only) collocation point XI to
be in the middle of the domain, or XI =
1f2. Recall that the residual R(x;al) is
given by Eq. (4-11) or
(4-11)
By Eq. (4-88), we must evaluate this residual at the collocation point or at XI
112 and set the result to zero, or

124
VARIATIONAL AND WEIGHTED RESIDUAL FORMULATIONS
Solving for a, yields
(4-89)
Therefore, an approximate solution to the problem by the point collocation method
is given by
(4-90)
The reader should compare this approximate solution with those from Examples
4-1 and 4-2.
•
Subdomain Collocation
In subdomain collocation, the weighting functions are chosen to be unity over a
portion of the domain and zero elsewhere. Mathematically, the wJx) are given by
w,(x) g
for x in 0,
for x not in 0 1
W2(X)
{6
for x in O2
for x not in O2
(4-91)
wn(x) = {6
for x in On
for x not in On
where 0, is a portion of the domain not included in°2,°3, ... ,On' Itis instructive
to show these particular weighting functions in graphical form; for example, see
Fig. 4-6 for n = 3.
Let us return now to our general discussion with n unknown parameters. Sub-
stitution of IVi(X) given by Eq. (4-91) into Eq. (4-84) gives n integral equations:
In,R(x; ai' a-, .
In2R(x; a" a2' .
, a,J dx = 0
, a,J dx = 0
(4-92)
InnR(x; ai' a-; ... , an) dx = 0
The different integration domains should be noted. Since the residual error R is a
known function of x, ai' a2, ... , an [see Eq. (4-83)], the integrations in Eq.
(4-92) can be carried out, resulting again in n equations in n unknowns. Again it
is emphasized that the unknowns are ai' a2, ... .u.; The values obtained for these

THE METHOD OF WEIGHTED RESIDUALS
125
oX
oX
,,
I'l
0,
~ ItJ
i'
°I
,"-----------
t--I1,---+1
~'U
I
0,
I
1----112~
,
,,
'r-----
I l.
,
,
,l+--111i
.1
Figure 4-6
Possible subdomains and weighting functions for the subdomain collocation
weighted-residual method (for three subdomains).
constants are, in general, dependent on the n subdomains chosen as well as on the
choice of the n trial functions.
Example 4-6
Repeat Example 4-1 by using the subdomain collocation method with the same trial
function.
Solution
Since there is only one trial function and one unknown parameter GI, only one
integral of the residual (over the entire domain from x = 0 to x =
I) needs to be
evaluated:
fa' R(x;GI) dx = 0
(4-931
Substituting R(x,GI) given by Eq. (4-11) into Eq. (4-93) gives
fo
l
(- 6G lx + IOOOx2 ) dx = 0
Integrating, evaluating, and solving for GI yields
(4-941

126
VARIATIONAL AND WEIGHTED RESIDUAL FORMULATIONS
Therefore, the approximate solution to the problem by the subdomain collocation
method is given by
(4-95)
The reader will undoubtedly note that the same value for a l was obtained from the
Ritz method in Example 4-1. This is not just a coincidence: the first-order Ritz
method is identical to the first-order subdomain collocation weighted-residual
~~.
.
Least Squares
The method of least squares requires that the integral! of the square of the residual
R be minimized. The integral! is given by
1 = In[R(xi ; ai' az, ... , an)F dx
(4-96)
The problem is reduced to the determination of the parameters aI' az,
.., all
such that the value of the integral! is minimized. Therefore, we must take the
partial derivative of I, first, with respect to a l and set the result to zero, then, with
respect to az and set that result to zero, and so forth. Mathematically, this may be
written as
a I
z
-
nlR(xi, ai' az, ... , all)]
dx
aaz
o
!!i-~I
z
-
-
n[R(Xi, ai, az• . . . , an»)
dx -
0
aa ll
aa n
where n includes the entire x domain. Because the limits on the integral are not a
function of the a;'s. the order of the integration and differentiation may be inter-
changed to give
a
In-
[R(x" ai' a-, ... , all)]z dx
0
aa,
I
~
z
-
n
[R(x;, ai' az, ... , a,J]
dx -
0
aaz
and so forth. Carrying out the differentiations and dividing by the constant factor
2 (and dropping the arguments on R for now) gives

THE METHOD OF WEIGHTED RESIDUALS
127
aR
fnR-dx = 0
aa\
aR
fnR-dx = 0
aa2
(4-97)
aR
fnR-dx = 0
oa;
Now it is a simple matter to determine the weighting functions by a direct comparison
of Eq. (4-97) with Eq. (4-84) from which we get
aR
WI(X) =-
aaI
(4-98)
aR
wn(x) =
-Ba;
These may be summarized concisely as
aR
w;(x) = -aa,
for i = I, 2, ... , n
(4-99)
Therefore, the least-squares weighted-residual method requires the solution of the
n equations given by Eq. (4-84) for the n unknown parameters ab a2, ... , an'
where the Wj(x)'s are given by Eq. (4-99). Alternately, the system of equations
implied in Eq. (4-97) may be solved simultaneously for the a;'s. Again the values
obtained for the a;'s are dependent on the n trial functions chosen.
Example 4-7
Resolve (approximately) the problem in Example 4-1 by using the least-squares
method and the same trial function.
Solution
The residual error R(x,a 1) , given by Eq. (4-11), is repeated here for easy reference:
R(x,a I) =
-6aIx + lOOOx2
(4-11)
Since there is only one unknown parameter ai' only the first of Eq. (4-97) needs
to be used, namely,

128
VARIATIONAL AND WEIGHTED RESIDUAL FORMULATIONS
i
l
e«
R- dx = 0
o
ha,
Computing aRiaa I gives
(4-1001
aR
-6x
and Eq. (4-100) becomes
fo
l
( - 6x)( - 6a,x + 1000x2) dx = 0
(4-1011
Simplifying the integrand, integrating, evaluating, and solving for a, yields
from which we may write the approximate solution from the least-squares method
as
The reader should note that still another value for a I is obtained.
Galerkin
(4-1021
•
In the Galerkin weighted-residual method, the trial functions N;(x) themselves are
used as the weighting functions, or
w;(x) = N;(x)
For the Galerkin method Eq. (4-84) becomes
In N;(x) Rtx; ai' a2, ... , all) dx = 0
for i =
I to n
(4-1031
(4-1041
Because there is one trial function for each unknown parameter, Eq. (4-104) reall y
gives n such equations that, when solved, yield the values of the unknown param-
eters, ai' a2, ... , all' It should be obvious that again the values obtained for the
a;'s are dependent on the choice of trial functions. The Galerkin method is seen to
be quite simple.
Example 4-8
Resolve the problem in Example 4-1 by using the Galerkin method and the same
trial function.
Solution
The trial function N,(x) is given by Eq. (4-9), or
N,(x) = x(1
-
x2)
(4-91

THE METHOD OF WEIGHTED RESIDUALS
129
Substituting R from Eq. (4-11) and N 1(x) from Eq. (4-9) into Eq. (4-104) for i
only gives
(4-105)
Simplifying the integrand, integrating, evaluating, and solving for QI yields
(4-106)
Therefore, an approximate solution by the Galerkin method is given by
(4-107)
The reader should note that exactly the same value for QI was obtained in Example
4-2. There an approximate solution was obtained by the Rayleigh-Ritz method,
which is a variational method. This is not a coincidence for it can be shown that
the variational and Galerkin methods must give identical results, providing the
problem has a classical variational statement (or principle) in the first place [II].
This profound result carries over into the application of these methods to FEM, as
shown in Sees. 4-8 and 4-9 for the same problem.
•
Comparison with the Exact Solution
If the problem posed in Example 4-1 is solved exactly, we get
(4-108)
Note the exponent of 3 on the x in the parentheses; our approximate solution was
assumed to be of the form
(4-109)
which is slightly different than the exact solution above. The exact solution from
Eq. (4-108) is compared to the four approximate solutions by the various weighted-
residual methods in Fig. 4-7. The approximate solution from the Ritz method
(Example 4-1) is identical to that obtained from subdomain collocation. Similarly,
the Rayleigh-Ritz (variational) and Galerkin solutions are identical.
It is seen that none of the methods seems to do a particularly outstanding job
of approximating the exact solution. However, in Sees. 4-8 and 4-9, the variational
and Galerkin methods are adapted to a finite element formulation for a solution to
the same problem. The fundamental difference between what we have done so far
and what we will be doing next lies in the type of trial functions that are assumed.
Recall that trial functions were chosen that applied globally to the entire domain
being analyzed. From this point onward, trial functions will be chosen that are to
be applied locally (over each and every finite element). These trial functions will

130
VARIATIONAL AND WEIGHTED RESIDUAL FORMULATIONS
50
40
30
20
10
0.2
0.4
0.1>
ox
1.0
Distance along rod. .v
Figure 4-7
Comparison of approximate solutions to problem posed in Example 4-1 with
the exact solution.
be said to be piecewise continuous, Piecewise continuous trial functions in this text
will be referred to as shape functions.
This important step is fundamental to the finite element method and has as-
sociated with it two important implications: (I) the piecewise continuous trial func-
tions or shape functions need not satisfy the physics of the problem since they are
to be applied locally in every element, not globally, and (2) the global boundary
conditions need not be satisfied. This is not to say that the shape functions have
no restrictions placed on them. These restrictions are delineated in Chapter 6. Before
actually illustrating this procedure, we need to review some additional mathematics
with which the reader may not be familiar.
4·7
MORE MATHEMATICS
In this section we will review the following: (I) the derivative of a matrix with
respect to a scalar, (2) the integral of a matrix with respect to a scalar, (3) the
derivative of scalar with respect to a vector, and (4) the integral as a sum of other
integrals. Examples of the use of these notions are provided throughout the text in
general and in the next two sections in particular.

MORE MATHEMATICS
131
Derivative of a Matrix with Respect to a Scalar
Consider an m x n matrix M whose elements are functions of x. The derivative
of M with respect to x is obtained by taking the derivative of each of the entries
(or elements) in M with respect to x, or
dM 11
dM l 2
dM11l
dx
dx
dx
dM(x)
dM21
dM22
dM21l
dx
dx
dx
dx
(4-110)
dMmll
dx
The instances when M is a column matrix (n
(m =
I) are seen to be special cases.
I) or when M is a row matrix
Integral of a Matrix with Respect to a Scalar
Let us again consider an m x n matrix M whose elements are functions of x. It
follows that the integral of M with respect to x may be found by taking the integral
of each element in M, or
JM11 dx
J M I2 dx
JM 11l dx
J M 2I dx
JM 22 dx
JM21l dx
JM(x) dx
(4-111)
JMm l dx
JMm2 dx
JM l1l1l dx
Although Eq. (4-111) is written with indefinite integrals, the same idea holds for
definite integrals (providing the same limits are used on all integrals). Like differ-
entiation, integration of a column matrix and a row matrix are seen to be special
cases of Eq. (4-111).
Derivative of a Scalar Function with Respect to a Vector
Let us now consider the following scalar function:
y(x) = aIN1(x) + a2N2(x) + ... + aIlNIl(x)
and determine ay/aa" or
(4-112)

132
VARIATIONAL AND WEIGHTED RESIDUAL FORMULATIONS
av
-'- = N,,(x)
aa"
We may write
(4-113a)
(4-113b)
(4-113c)
ay = NJxl
aa,
If we define N and a as
for i
1,2, ... , II
(4-114)
N
and
N,,(x)]
allY
(4-115)
(4-116)
then Eq. (4-112) may be concisely written as
y(x) = Na
(4-117)
where it is implied that N = N(x). Note the use of the transpose in Eq. (4-116)
that is used simply to conserve space since a is really a column matrix. From Eqs.
(4-113) it follows that
ay
aa,
N1(x)
av
av
NT
Nz(x)
aa
aaz
(4-118)
ay
aa"
N,,(x)
Therefore, it may be concluded for N and a defined by Eqs. (4-115) and (4-116),
respectively. that
a(Na)
aa
(4-119)

THE RAYLEIGH-RITZ FINITE ELEMENT METHOD
133
This result may not be what we would intuitively expect because of the need to
transpose N. It is particularly useful in the next section where the Rayleigh-Ritz
method is adapted to FEM. This result is not needed in the Galerkin method.
The Integral as a Sum of Other Integrals
It follows directly from the definition of integration that an integral may be evaluated
by dividing the domain n into M nonoverlapping subdomains ne and summing the
integrals over each subdomain, or
fn!(x) dx
M
2:
fw!(x)dx
e=l
(4-120)
Each nonoverlapping subdomain ne will correspond to one finite element in this
text. The superscript (e) will be interpreted to be the element number.
4-8
THE RAYLEIGH-RITZ FINITE ELEMENT METHOD
In Sec. 4-2 the Rayleigh-Ritz method was used to find an approximate solution to
the problem posed in Example 4-1. In this section, we wish to obtain another
approximate solution but now in the context of the finite element method. As in
Example 4-2, the variational statement will be the starting point. However, the
fundamental difference in the treatment here compared to that in Sec. 4-2 is the
following: piecewise continuous trial functions will be used that apply only to a
small portion of the entire domain, i.e., over a finite element. The reader should
recall that the trial functions used in Sees. 4-2 to 4-6 were applied globally, i.e.,
to the entire domain. Now the trial functions will be taken to be interpolation
polynomials as described below.
Consider the domain that includes the interval a ~ x ~ b as shown in Fig.
4-8. Let us divide this interval into M subintervals as shown. Actually, this process
is called discretization and a typical subinterval from Xi to Xk is really a finite element
and is simply denoted as element e. The ends of the subinterval are the locations
of the two nodes, nodes j and k. Since the element e has two nodes, a linear
interpolating polynomial may be used to describe the behavior of the field variable,
e.g., y(x), over the element, or
y e = mx + b
(4-121)
The superscript (e) on the field variable serves to remind us that the approximation
applies only over element e and not globally. But at x = Xj' we must have ye = Yj'
and at x = xi; we must have ye = Yk. Therefore, applying these two conditions
to Eg. (4-121) yields
(4-122a)
(4-122b)

134
VARIATIONAL AND WEIGHTED RESIDUAL FORMULATIONS
;1T
T,
I
:
:
Ilk
"
:
I
I
I
I
I
\" =a
x=h
Figure 4-8
Typical one-dimensional problem domain discretized into M elements with N
nodes with an assumed linear variation of the field variable y(x) over a typical element e
with nodes j and k,
that may be solved for m and b to give
m
and
b = v -
. }
Yk -
YI
x, - xj
(
V . - v)
• k
_}
---
X
Xk
-
Xj
}
(4-123a)
(4-123b)
Substituting these expressions for m and b in Eq. (4-121) and some rearrangement
gives the following:
It is observed that Eq. (4-124) is of the form
y" =
aIN1(x) + a2N2(x)
or
where
(4-124)
(4-125a)
(4-125b)
(4-1268)
(4-126b)
(4-127a)

THE RA YLEIGH-RITZ FINITE ELEMENT METHOD
135
I
I
I
I
Yk
I
I
Yj T
\
1
Nj(x)
1.0
10
Figure 4-9
Typical element e showingthe two shape functions and the resultingvariation
of the field variabley'(x) (linear between nodesj and k).
and
(4-127b)
The functions Nj(x) and Nk(x) are referred to as the shape functions for the element.
We see that instead of using higher-order polynomials that apply globally to
the entire domain, we will now use two first-order shape functions that apply only
to a small subinterval or element. These particular shape functions are shown in
Fig. 4-9. Note that they are both linear and at x = xj , we have N, = I and N, = 0,
and at x =
Xb we have Nj
0 and N, =
I. Equation (4-125b) may be written in
matrix form as follows:
where by definition
ye
Na e
(4-128)
and
N
(4-129a)
(4-129b)
It should be emphasized that the vector a" contains the values of the field variable
at the two nodes. The idea is to use Eq. (4-128) to represent y(x) over each element
in the discretized domain and to find the values of the a/s by extremizing the
functional J with respect to the ai's. The set of all ai's for the entire domain represents
the finite element solution to the original problem.

136
VARIATIONAL AND WEIGHTED RESIDUAL FORMULATIONS
Because the function y(x) itself given by Eq. (4-121) is continuous and the
first derivatives are not necessarily continuous (from element to element), the
function y(x) is said to be CO-continuous. A function with continuous first derivatives
is said to be C'-continuous, etc. In a similar fashion, the two shape functions given
by Eq. (4-127) are also said to be CO·continuous or to possess CO-continuity. Some
Cl-continuous shape functions are derived in Chapter 7 for the beam model.
These rather abstract ideas are best illustrated by tackling a numerical example,
which again, for comparison purposes, is taken to be the problem posed in Example
4-1.
Example 4-9
Using the Rayleigh-Ritz finite element method, find an approximate solution to the
problem posed in Example 4-1 by determining the value of the field variable, T,
at six equally spaced node points.
Solution
Before the Rayleigh-Ritz method can be used, the variational statement of the
problem is needed. Because of the two prescribed temperature boundary conditions
at x = 0 and x = 1(i.e., on the global boundary), we could start with the functional
given by Eq. (4-69) from Example 4-4. However, let us use the functional implied
in Eq. (4-70) so as to show what happens to the integrated term. Therefore, the
functional to be used here is
I =
~ {dTp·I" + f' [IOOOX 2T" - ~ (dT")2J dX}
e = I
dX'J
x,
2
dx
(4-130)
(4-131)
Note that Eq. (4-120) has been used to represent I as a sum of the integrals over
each element. The integrated term above will be appreciated later to be completely
equivalent to that implied in Eq. (4-70) because the internal contributions will
cancel during the assemblage step and only the end conditions will survive. The
summation sign in Eq. (4-130) unnecessarily clutters the equations; therefore, let
us drop the summation and write the functional for a typical element e as
I"
[
(2J
dT"
I ar:
I' = -T' ... + I
IOOOx 2T" - - -)
dx
dx',
2
dx
"
where
At
I = L /'"
e=1
(4-132)
and where M is the number of elements used. This summation is really considered
at the assemblage step later. The a;'s in the approximation ye [to y(x)) in element
e are to be determined by differentiating I with respect to a and setting the result
to zero, or

THE RAYLEIGH-RITZ FINITE ELEMENT METHOD
137
dl
da
M
dIe
2:-
e= I dae
(4-1331
For now, let us extremize l" in Eq. (4-131) with respect to the vector a" where for
T" we take
Te = Na"
as implied by Eq. (4-128), or
dl'
dT dTe IX'.' , lX' [
dP
I
d (dP)2]
-
= -
-
T
1000x2-
- - -
-
dx = 0
dae
dx dae
Xl
de"
2 de'
dx
Xl
But from Eq. (4-119) we have
(4-1341
(4-1351
dTe
dae
d(Nae)
dae
(4-1361
and it also follows that
.,
2
r'. 1/
1 d (dTe)
I" dTe d (dP)
dj dTe) a:
'2 dae
dx
="2(2) d:; dae d:;
= dae \'dx
d:;
dNTdN
= -- -- a"
dx
dx
/71
(4-1371
Using the results from Eqs. (4-136) and (4-137) in Eq. (4-135) yields
dT
I,n
lX'
ln dN T dN
-
NT
+
. IOOOx 2 NT dx -
-- -- ae dx = 0
dx
Xl
Xl
dx
dx
Xl
(4-1381
But the vector a" is not a function of x so it can be removed from the right (why
not from the left?) to give
[ (X, dN
T
dN dx] ae = dT NT IX' + (x, 1000x2NT dx
(4-1391
JXl
dx
dx
dx
JXl
Xl
which is of the form
(4-1401
where K" may be referred to as the element stiffness matrix, fe as the element nodal
force vector, and a" as the vector of nodal unknowns (i.e., T, and Tk ) . Before Eq.
(4-140) can be solved, however, two more important tasks must be completed: (I)
assemblage of the Ke's and fe's to form Ka and fa and (2) application of the
geometric boundary conditions (prescribed temperatures) at x = 0 and x = I. The
matrix K" is referred to as the assemblage stiffness matrix and the vector fa is
referred to as the assemblage nodal force vector (before considering the geometric
boundary conditions). After the geometric boundary conditions are applied, we have
a system of equations represented by
Ka = f

(4-141)
138
VARIATIONAL AND WEIGHTED RESIDUAL FORMULATIONS
which may be solved for the values of the field variables at the node points (i.e.,
ai, a2, ... ). From Eqs. (4-139) and (4-140), we define
i
x, dNT dN
Ke =
-- -- dx
"
dx
dx
and
I
"
aT
x,
0"
r- = -NT',
+11000rN l dx
dr',
r
(4-142)
It should be noted that K" is a symmetric 2 x 2 matrix, whereas f" is a 2 x I
matrix (or column vector). Obviously, a" is also a 2 x
I matrix. It is very easy
to evaluate K" given by Eq. (4-141) if the expressions for N,(x) and Nk(x) from
Eq. (4-127) are used. The final result may be verified to be (see Problem 4-51)
K"_- __1_[ 1-IIJ
(4-143)
Xk -
xJ
- I
In arnvmg at Eq. (4-143), the reader should make use of some of the review
material in Sec. 4-7, namely, differentiation and integration of a matrix with respect
to a scalar.
The integrated term in Eq. (4-142) is evaluated as follows:
aTNTI',"
= dT(Xk)
T
dT(xj)NT
dx
-;;;- N (xk)
dx
(x)
r
But from Eqs. (4-127) and (4-129a) we have
and
Therefore, the integrated term becomes
dT NTI" = dT(Xk) [OJ + dT(x,) [- IJ
dx
dx
I
dx
°
.',
(4-144)
'the evaluation of the remaining part of f", namely the integral contribution, is very
tedious but routine. The reader should show (see Problem 4-52) that the final result
is given by
(4-145)
An alternate (and approximate) method of evaluating this integral is outlined in
Problem 4-53.

THE RAYLEIGH-RITZ FINITE ELEMENT METHOD
139
8!
CD CD;
[2]0\
IT] 8; 00l 001
o~'l-+-Ol~O"'-+-O'-+-Ol--1
Figure 4-10
Discretized problem domain for problem posed in Example 4-1 and solved
by the Rayleigh-Ritz finite element method in Example 4-9.
Before making use of these results in carrying out the numerical computations,
we must discretize the global domain into five equally sized elements that require
six equally spaced nodes, as shown in Fig. 4-10. It proves to be very convenient
to organize the nodal coordinate and element connectivity data as shown in Tables
4-1 and 4-2, respectively. Note that a material set flag is not used because only
one material is present in the model.
By using the data in these tables it is easy to compute the element stiffness
matrices K(I), K(2), etc., and the element nodal force vectors f(ll, f(2), etc. For
example, for KI 1) we have
I
[
I
K(I) = ---
_
X2
-
XI
I -IJ I[ I
I
= 0.2
-I -:J
[-~
-~J
Table 4-1
Nodal Coordinate Data for Example 4-9
Node
number
I
2
3
4
5
6
Table 4-2
Element Data for Example 4-9
X
0.0
0.2
0.4
0.6
0.8
1.0
Element
Nodes connected
number
j
I
I
2
2
2
3
3
3
4
4
4
5
5
5
6

140
VARIATIONAL AND WEIGHTED RESIDUAL FORMULATIONS
Obviously, we also have
(4-146a)
For I'll), we have
f(l) =
[~J dT~z) +
or
I'll)
[-IJdT(xl)
°
dx
1000
[(0.2)4 - 4(0.2)(0.0)3 + 3(0.WJ
+ (12)(0.2)
3(0.2)4 - 4(0.0)(0.2)3 + (0.0)4
[ojdT(xz) + [-I] dT(x l ) + [0.667J
I
dx
°
dx
2.00
Similarly, we find
r Z) [°]dT(X3) + [ - I] dT(xz) + [ 7.3]
I
dx
°
dx
11.3
( 3) = [~J d~4) + [ - I J dT(X3) + [22.0]
°
dx
28.6
(4-146a)
( 4) = [0] dT(xs)
[ - IJ dT(x4)
[44.7]
I
dx
+
°
dx
+
54.0
r S) = [0] dT(X6) + [ - I] dT(xs) + [75.4]
I
dx
°
dx
87.3
The assemblage of the element stiffness matrices to form K" follows the same
line of reasoning presented in Chapter 3 where the truss was studied. However,
the situation here is even simpler because the submatrices in the Ke's are of size
I x
I, or simply scalars. The reader is reminded that the primary factor in deciding
where the element stiffness matrix K" for element e is added into the assemblage
stiffness matrix K" is the two global node numbers (! and J) associated with the
element. This assemblage step was summarized in Chapter 3 for elements containing
only two nodes (such as the present problem) in Eq. (3-31). The details of the
assemblage of the stiffness matrices are omitted below, but the reader should show
the missing steps if there is still some doubt as to how this important step is
accomplished.
The assemblage of the nodal force vectors to form f" is done in a completely
analogous manner, except that it is even simpler because only a column matrix is
involved. If the element nodal force vector is imagined to be partitioned as
r- = [lLJ
if
(4-147a)

THE RAYLEIGH-RITZ FINITE ELEMENT METHOD
141
then the assemblage of these to form fa may be summarized by the following
equation:
(4-147bl
where M is the maximum number of elements used in the model and file is taken
to be zero if element e does not contain node n. With this algorithm, the reader
should be able to show that the assemblage nodal force vector in the following
matrix equation results:
5
-5
0
0
0
0
T)
0.667
dT(x)
dx
-5
10
-5
0
0
0
T2
9.33
0
-5
10
-5
0
0
T3
33.3
14-148)
0
0
-5
10
-5
0
T4
73.3
0
0
0
-5
10
-5
Ts
129.4
0
0
0
0
-5
5
T6
873 + dT(X6)
.
dx
Note how the unknown derivatives (dTldx) for the interior nodes have canceled.
Physically this may be interpreted as follows: although there is a temperature
gradient and hence a heat flux at each node and hence between two neighboring
elements, these internal heat fluxes cancel. The only heat fluxes that survive are
those on the global boundary, and then only if there is actually an imposed heat
flux there. If the temperature gradients (or heat fluxes) at either or both ends were
specified, the value would simply be entered as indicated above. That case would
correspond to a prescribed heat flux into or from the ends. In any event, in the
problem at hand we have prescribed temperatures at both ends, and by using Method
I (Method 2 may also be used), Eq. (4-148) is modified to impose T) = 0 and
T6 = 0, which results in
I
0
0
0
0
0
T)
0.0
0
10
-5
0
0
0
T2
9.3
0
-5
10
-5
0
0
T3
33.3
(4-149)
0
0
-5
10
-5
0
T4
73.3
0
0
0
-5
10
0
Ts
129.4
0
0
0
0
0
I
T6
0.0
The disappearance of the (unknown) temperature gradients at nodes I and 6
should be noted and thoroughly understood: in thermal problems, in general, the
boundary nodes must have either a prescribed temperature or a prescribed gradient
(heat flux), convective, and/or radiative boundary conditions. It should be noted
further that the case of insulation is a special case of a specified gradient since dT/
dx = O. This zero-gradient case is the so-called natural boundary condition. In any
event, solving Eq. (4-149) for the nodal temperatures yields

142
VARIATIONAL AND WEIGHTED RESIDUAL FORMULATIONS
T) = 0
Tz
16.5
T3
31.2
T4
39.2
Ts
32.5
T6 = 0
The reader will note that these values lie right on the curve for the exact solution
in Fig. 4-7! The significant point here is that two linear shape functions (or trial
functions on a local or piecewise basis) have given results that are extremely close
to the exact solution, whereas the use of cubic-order, global trial functions in the
Rayleigh-Ritz method resulted in an error as large as 21% (at x = 0.2). Except
for the Galerkin method, the other global approximate solution methods resulted
in even larger errors.
•
So far it has been seen that the variational (Rayleigh-Ritz) and Galerkin weighted-
residual methods perform the best out of all the approximate solution techniques
considered here. The variational FEM solution presented in this section resulted in
a solution very close to the exact one (with only five elements). The next section
will illustrate how the Galerkin method is adapted to FEM.
4·9
THE GALERKIN FINITE ELEMENT METHOD
InSec. 4-6, four different weighted-residual methods were introduced. In addition,
four approximate solutions to the same problem were obtained by each of these
methods. Global trial functions were used; these functions applied to the entire
domain. Inthis section we wish to repeat the solution only for the Galerkin method,
but this time in the context of the finite element method. The implication is that
piecewise continuous trial functions or shape functions will be employed for each
element. In fact, as in the Rayleigh-Ritz FEM (see Sec. 4-8), these shape functions
will actually be interpolation polynomials.
As in Sec. 4-8, the problem domain is divided or discretized into a number of
elements. Figure 4-8 is again applicable to this formulation, and the interval a '%
x'% b (i.e., the problem domain) is divided into M such elements. A typical element
e has two nodes, j and k, with coordinates Xj and Xb respectively. The field variable
Y at nodes j and k has values Yj and Yb respectively. As before, since each element
has two nodes and since a unique straight line may be drawn between two points,
the interpolation polynomial to be used to describe the field variable, e.g., y(x),
must be of the form
y e = mx + b
(4-150a)

THE GALERKIN FINITE ELEMENT METHOD
143
which is identical to Eq. (4-121). Therefore, the results of the first part of Sec.
4-8 are directly applicable here. In other words, we wish to express ye(x) in the
form
ye(x)
=
yjNj(x) + YkNk(X)
(4-150b)
From Eqs. (4-125) to (4-127), we see that at x = xj we have ye(Xj)
Yj' and at
x = Xk we have ye(Xk) = Yk. As in the Rayleigh-Ritz FEM formulation in Sec.
4-8, two piecewise continuous linear trial functions are to be used. The functions
Nj(x) and Nk(x) are referred to as shape functions.
Example 4-10
Resolve the problem posed in Example 4-1 (approximately) by the Galerkin finite
element method by using six equally spaced nodes.
Solution
Recall that the Galerkin method requires that the trial functions themselves be used
as the weighting functions. The integral of the weighted residual R in this case is
written as
(4-151)
But instead of using trial functions N;(x) that are applied globally to the entire x
domain and that satisfy the boundary conditions automatically (and exactly), let us
try to represent the solution T' over a small interval (really a finite element), say
from Xj to xi, as
(4-152)
where Tj and Tk are analogous to the unknown parameters, GI and G2' in the general,
weighted-residual method. Moreover, if N/x) and Nk(x) , in addition to being linear,
are such that when x = Xj we have N, = I and Nk = 0, and when x = Xk we have
Nj = °and N, = I, then in fact we have appropriate shape functions. The reader
should verify that for N/x) and Nk(x) given in Eq. (4-127) this is in fact the case.
In summary, in one-dimensional CO-continuous problems with two nodes per ele-
ment, the shape functions must be linear because there are two nodal points per
element and they must satisfy the following conditions:
(4-153a)
and
(4-153b)
In the Galerkin method, the two shape functions Nj and N; are the weighting
functions. From Eq. (4-104), we may write the following weighted-residual equa-
tions:

144
VARIATIONAL AND WEIGHTED RESIDUAL FORMULATIONS
(4·1548)
M
L t Nj(x)[W(x;Tj,Tk)] dx = 0
e=l
and
(4-154b)
where e denotes the element and M is the number of elements (or intervals into
which the domain is divided). A typical finite element goes from xj (where the
temperature is Tj ) to Xk (where the temperature is Tk ) . If matrix notation is used
and NT is defined as
then Eqs. (4-154) may be written in one equation as
M
L r W[W(x;Tj,Tk)] dx = 0
e= I
:C,
(4-155)
(4-156)
But the residual W for a typical element e in the problem at hand is, by definition,
d 2T"
R" = -- + lOOOx2
dx 2
(4-157)
where the approximate solution T", applicable only to element e, has been substituted
for the exact temperature T in the governing equation and the result set equal to
the residual W for the element. Therefore, Eq. (4-155) becomes
M 1"
(d
2
T"
)
L
W
--2 + IOOOx2
dx = 0
e=l
x,
dx
Before breaking this integral into two separate integrals, let us agree to drop the
summation sign. The reason for this is simple: it represents the assemblage step
that it is hoped is becoming routine. In other words, it is preferred to work with a
typical element (element e) and at some later stage we will put the pieces back
together. Breaking Eq. (4-157) into two separate integrals gives
(4-158)
If the first integral is integrated by parts we get
o
(4-159)

THE GALERKIN FINITE ELEMENT METHOD
145
But we have already agreed to write T' in terms of two (linear) shape functions,
N, and Ni; and the two nodal temperatures, T, and Ti, as
T" = Na"
where
(4-160)
N
(4-161)
and
a" =
[ Tj
]
r,
Using Eq. (4-160) in the integral terms only in Eq. (4-159) gives
dT'l
x
,
iX' dN
T dN
iX'
NT -
. -
.. -
-ae dx +
. N T(l000X2) d.x = 0
d.x
x,
dx
d.x
Xi
.\j
(4-162)
(4-163)
The reason for not using Eq. (4-160) in the integrated term is that by not doing so,
we have allowed a mechanism for imposing gradient boundary conditions (see
Problem 4-56). But a" is not a function of x and may be pulled out of the integral
from the right to give a rather simple equation of the form
where
and
Keae = fe
(4-164)
(4-165)
(4-166)
For all practical purposes, Eqs. (4-165) and (4-166) from the Galerkin method are
identical to Eqs. (4-141) and (4-142), respectively, from the variational method!
As mentioned before, this is not surprising because when a classical variational
principle exists, it must give the same FEM formulation as the Galerkin method.
Again the element stiffness matrix is seen to be symmetric.
Equation (4-165) for the element stiffness matrix and Eq. (4-166) for the element
nodal force vector are the so-called element characteristics. Note that it is not
necessary to distinguish between the local and global element stiffness matrices
since a local coordinate system was not used in the development of these equations.
Moreover, the function T(x) is a scalar function (such as temperature) and hence
no transformation from a local to a global coordinate system would be necessary
before the assemblage step. It should be obvious that the remaining part of the

146
VARIATIONAL AND WEIGHTED RESIDUAL fORMULATIONS
Base at
temperaturer,
Insulated
til'
Figure 4·11
Circular pin fin undergoing convection to an ambient fluid.
solution by the Galerkin finite element method is identical to that in
4-9.
4-10
APPLICATION: ONE-DIMENSIONAL HEAT TRANSFER
IN A PIN FIN
Example•
(4-1671
for 0 ~ x ~ Lf
Consider a circular pin fin of length Lr and varying cross-sectional area A and
perimeter P as shown in Fig. 4-11. Fins such as these are used to increase the heat
transfer rate, particularly to gases. Gases generally have low convective heat transfer
coefficients. By increasing the surface area, such as in the pin fin, we can increase
the heat transfer rate significant!y. The heat transfer rate is also referred to as the
heat removal rate in this text. Depending on the circumstances, fins are also
commonly used in liquids.
The temperature distribution in the fin is needed for the case when the base is
held at a temperature Tb , the tip is insulated, and the fin itself convects to a fluid
at a temperature Tll with a heat transfer coefficient h. The thermal conductivity is
denoted as k, and the temperature at any point along the fin is denoted as T. The
heat removal rate and fin efficiency (defined below) are to be determined also.
The governing equation may be shown to be (see Problem 4-66)
~ (kA:) - hP(T -
Tll ) = 0
subject to the two boundary conditions
T(O)
(4-168al
dT
dx (Lr) = 0
(4-168bl
The intent is to obtain an approximate solution using the finite element method. In
particular the finite element characteristics will bederived using the Galerkin method.

APPLICATION, ONE-DIMENSIONAL HEAT TRANSFER IN A PIN FIN
147
The Element Characteristics
The derivation begins by forming the integral of the weighted residual and setting
the result to zero, or
(4-1i!1
where a typical element e is assumed to connect node j (at x = x) to node k (at
x =
Xk) as shown in Fig. 4-12. The superscript (e) on the field variable, T in this
case, is no longer shown. Note that the weighting function is taken to be the transpose
of the shape function matrix, since the Galerkin method is used. At nodes j and k,
the temperatures are Tj and Tb respectively. Note also that each node represents a
planar surface and not just a point.
Let us integrate by parts the term with the second-order derivative as follows:
i·"
d (
dT)
dT IX'
iX' dN
T
dT
.. NT- kA-
dx = NTkA-
.. -
. -kA-dx
"
dx
dx
dx
x,
dx
dx
.\}
(4-1711
As illustrated in Example 4-9, the so-called integrated term cancels for all interior
nodes during the assemblage step. Moreover, at the base of the fin, the temperature
is prescribed. As shown in Example 4-9, the unknown temperature gradient at the
corresponding node is eventually eliminated when the prescribed temperature is
imposed on this node. Also, at x = Lf, we have dT(Lf)ldx = O. Therefore, this
integrated term need no longer be considered here. (See Sec. 8-3 for the case of a
noninsulated tip.) Therefore, Eq. (4-169) becomes
o
(4-1711
o~
ox
Figure 4-12
One-dimensional element with nodes j and k.

141
VARIATIONAL AND WEIGHTED RESIDUAL FORMULATIONS
But using T = Na" and noting that only N is a function of x, we get
(4-172)
where
and
i
" d N T
dN
K: =
-kA-dx
I
'i
dx
dx
f"
L
K~v =
... NThPN dx
I,
and
f"
f" =
WhPT dx
..
a
.',
The vector of nodal unknowns a" is given by
and the shape function matrix N by
(4-173)
(4-174)
(4-175)
(4-1715)
(4-177)
(4-178)
where N, and N, are, in tum, given by Eqs. (4-127).
In the most general case, k, h, A, P, and T; may all be functions of x. However,
let us perform the integrations in Eqs. (4-174) to (4-176) approximately by taking
the following approach. Let us treat these parameters as constants in any given
element by using .!he_ v~u~ at the midpoint of the element where x = x and by
denoting them as k, h, A, P, and Ta . It can be shown that (see Problem 4-69)
Ke
= ~[-: -:]
.1
/)
<J\. :)./' +
,J. :,'
J
= hPL [2
~]
\
I
K~v
6I
r)
\..and
hPLTa[I]
fe =--
2
I
(4-17i)
(4-180)
(4-181)
where L is the element length, or L =
Xk
-
Xj.
The element stiffness matrices and nodal force vectors may be determined for
every element with the help of Eqs. (4-179) to (4-181). The assemblage of these
2 x 2 matrices and 2 x I vectors is performed in the usual manner to give a

APPLICATION: ONE-DIMENSIONAL HEAT TRANSFER IN A PIN FIN
149
system of N algebraic equations in the N unknown nodal temperatures. This assumes
the fin is discretized into M elements with N nodes, where M is equal to N -
I.
The result is Kva = fa. The geometric (or prescribed temperature) boundary con-
ditions are applied at this point to yield Ka = f. This matrix equation may be
solved for the nodal temperatures in the vector a. Therefore, it is assumed that the
nodal temperatures are known in what follows.
Heat Removal Rate
The heat removal rate can be determined by two different methods, once the nodal
temperatures are known. The first method is based on differentiation, and the second
method is based on integration. Not surprisingly, the second method is significantly
more accurate, as illustrated numerically in Example 4-11 below.
In the first method, the heat removal rate QR from the fin is evaluated by
computing the heat flux from conduction at the base of the fin (where x = 0), and
by multiplying this value by the cross-sectional area A. This may be summarized
as
(4-182)
where it is assumed that element I is at the base of the fin as shown in Fig. 4-13.
It follows (see Problem 4-70) that
L=1
Base
A,k
of
fin
T, CD
T2 CD
TJ CD
[iJ
IT]
[2]
(4-183)
01
• x
Figure 4-13
Portion of the discretized fin showing some elements near the base.

ISO
VARIATIONAL AND WEIGHTED RESIDUAL FORMULATIONS
where it is further assumed that element I connects nodes I and 2, and where L is
the element length. More accurate results are usually obtained if the cross-sectional
area at the base is used instead of the area at the element centroid. If QR is negative,
heat is conducted toward the base of the fin.
In the second method, the heat removal rate is determined by integrating the
heat loss from the exposed surfaces of the fin that undergo convection. Let us
assume the tip of the fin is insulated, so that only the fin periphery needs to be
considered. Therefore, we have
rLf
QR = Jo hP(T -
To> dx
(4·184)
However, it is preferred to write this as a sum of M separate integrals over each
of the M elements, or
M
QR =
2: r hP(T -
To) dx
e= 1 x)
(4-185)
(4-186)
It can be shown (see Problem 4-70) that if T = Na" is used, and if h, T,l' ~n<iP
are evaluated at x = x(i.e., at the centroid of the element) and denoted as h, Ta ,
and P, then Eq. (4-185) becomes
~ _ (Tj + t;
-)
QR =
c: hPL -- -
Ta
e= I
2
where Tj and T, are the temperatures at nodes j and k for element e. These nodal
temperatures are known from the solution of Ka = r. It is emphasized that the
heat removal rate from Eq. (4-186) is more accurate than that from Eq. (4-183).
Fin Efficiency
The fin efficiency TJf may be defined in several ways, but only one definition is
given here. This definition is based on the hypothetical condition that the entire fin
is at the base temperature, because this would result in the maximum possible heat
removal rate. This corresponds to an infinite thermal conductivity and, therefore,
is not physically realizable. Nonetheless, this definition of fin efficiency does give
an indication of the relative effectiveness of the fin in increasing the heat removal
rate. Denoting this maximum rate as Qmax' we may write
where
Qmax
QR
TJj = --
Qmax
(4·187)
(4·188)

(4-189)
APPLICATION: ONE-DIMENSIONAL HEAT TRANSFER IN A PIN FIN
151
If average values of h, P, and Ta are used for each element, Eq. (4-188) becomes
M
Qmax =
L hPL(Tb
-
'ta>
e=l
Again it has been assumed that the tip of the fin is insulated.
Example 4-11
Determine the temperatures, heat removal rate, and efficiency of the circular pin
fin shown in Fig. 4-14(a). The fin is made of pure copper and has a thermal
conductivity k of 400 W/m-°e. The base is held at T; = 8YC and the ambient
fluid temperature Ta is maintained at 2Ye. The fin length Lf is 2 cm, and the
diameter D is 0.4 ern. The convective heat transfer coefficient h is 150 W/m 2-oC
and the tip at x = Lf is insulated.
Solution
The first step in the finite element solution is discretization of the fin. Let us
arbitrarily assume only two elements (and three nodes) as shown in Fig. 4-14(b).
It is convenient to summarize the node and element data in tabular form as shown
in Table 4-3. The calculations are summarized below in a form that may be readily
implemented in a computer program (see Problem 4-78).
Base of
fin
I-----L/------I
o
x
Insulated
tip
(b)
Figure 4-14
Circular pin fin (a) analyzed in Example 4-11 and (b) discretized into two
elements and three nodes.

152
VARIATIONAL AND WEIGHTED RESIDUAL FORMULATIONS
Table 4-3
Node and Element Data for Example 4-11
Node number
I
2
3
.r, m
0.0
0.01
0.02
Nodes connected
Element number
I
2
j
I
2
k
2
3
Element 1:
Node j is I.
Node k is 2.
Xj = 0.0 m
and
Xk = 0.01 m
L =
Xk
-
xJ = 0.01 -
0.00 = 0.01 m
D = 0.004 m
7rD 2
7r(0.004)2
A = -
=
1.2566 X 10- 5 m2
4
4
P = 7rD = 7r(0.004) = 1.2566 x 10- 2 m
K(I) = (400)(1.2566 x 10- 5) [
1
- I]
x
0.01
-I
1
= [
0.50265
-0.50265] W/oC
-0.50265
0.50265
KIll = (150)(1.2566 x 10-2)(0.01) [2
21]
cv
6
1
= [0.00628
0.00314] W;OC
0.00314
0.00628
KII) =
K.11I
K(I) =
[
0.50893
-0.49951] wrc:
r
+
cv
- 0.49951
0.50893
[
0.50893
-0.49951
0]
K" =
- 0.49951
0.50893
0
W/oC
000
II) = (150)(1.2566 x 10- 2)(0.01)(25) [ 1]
[0.23561]W
f
2
1
0.23561
r- ~ [~;i;::]w

APPLICATION ONE-DIMENSIONAL HEAT TRANSFER IN A PIN FIN
153
Element 2:
Node j is 2.
Node k is 3.
xj = 0.01 m
and
Xk = 0.02 m
L =
Xk
-
xj
= 0.02 -
0.01 = 0.01 m
D = 0.004 m
A = 1.2566
X 10- 5 m2
P = 1.2566 X 10- 2 m
K~2) = KVJ
[
0.50265
-0.50265
- 0.50265] WIDe
0.50265
K~~) =
K~V
[
0.00628
0.00314] wrc:
0.00314
0.00628
K(2) =
K~2) +
K~~ = K'!'
= [
0.50893
- 0.49951] wrc
- 0.49951
0.50893
[
0.50893
- 0.49951
0]
x- =
-0.49951
1.01786
-0.49951
WIDe
o
-0.49951
0.50893
f(2) = r» = [0.23561] W
0.23561
fa = [~:;~~~~] w
0.23561
Before application of the prescribed temperatures we have Kaa =
fa, or
[
0.50893
-0.49951
o
-0.49951
1.01786
- 0.49951
o
][T
1
]
[0.23561]
-0.49951
T2
=
0.47122
0.50893
T)
0.23561
Note that the assemblage stiffness or conductance matrix K" is symmetric and
banded with a half-bandwidth of 2 [this also follows from Eq. (3-33)]. The pre-
scribed temperature boundary condition at the base of the fin will be imposed by
using Method I from Sec. 3-2. The first step is to modify the first row (since T)
is to be imposed) as shown below:
o
1.01786
- 0.49951
-0.4g951][~~]
= [0.4~~22]
0.50893
T)
0.23561

154
VARIATIONAL AND WEIGHTED RESIDUAL FORMULATIONS
In order to preserve symmetry, the K 21 entry must be multiplied by the prescribed
temperature and transposed to the right-hand side (in the same row). Therefore, 12
must be replaced by 0.47122 - (- 0.4995 I)(85.) or 42.930. This is the only term
that needs to be modified because K is now symmetric. The system of equations
to be solved is given by
o
1.01786
-0.4995 I
o J[TIJ [
85 J
-0.49951
T2
=
42.930
0.50893
T,
0.23561
Solving this system of linear, algebraic equations by the matrix inversion method
yields the following nodal temperatures:
The heat removal rates may now be computed as summarized below:
2
(
)
_
T, + T,
QR = L hPL -- -
T"
e= I
2
(
85 + 81.8
)
150'lT(0.004)(0.01)
2
-
25
+ 150'lT(0.004)(0.01)(81.8 ;
80.8 -
25)
1.10 + 1.06 = 2.16 W
If the alternate (less accurate) method is used, we get
](A
400'lT(0.004j2/4
QR = L (T I -
T2) =
0.01
(85
81.8) =
1.60 W
This is quite different than the result from the method based on integration. It is
shown below that the exact value for the heat removal rate is 2.155 W. Clearly,
the method based on integration is significantly more accurate.
Finally, the fin efficiency is readily computed to be
QR
2.16
TIl =
Qrnax =
150'lT(0.OO4)(0.02)(85 -
25)
2.16
= -
= 0.956
or
95.6%
2.26
The results from Example 4-11 are compared in Table 4-4 to the exact solution
given by (13)
and
T(x)
cosh 'A(Lf -
x)
T" + (Tb
- T,,)-----'---
cosh 'ALf

REMARKS
ISS
where
,=~
Note that the results for 4 and 8 elements are also given in this table. These results
were obtained by the computer program described in Problem 4-78. The nodal
temperatures, heat removal rates, and efficiencies in Table 4-4 converge to the
exact solution as the number of elements is increased. Five significant digits are
shown for the purpose of comparison only.
A detailed discussion of error predictions and convergence is beyond the scope
of this text. Introductory material on these topics may be found in the book by
Becker, Carey, and Oden [14].
4-11
REMARKS
This chapter began with an introduction to some of the more important integral
methods that lead to the present-day finite element method in nonstructural appli-
cations. Only one-dimensional problems were considered, but the basic groundwork
Table 4-4
Summary of Results for Example 4-11
Temperatures, °C
x, em
Exact
2 Elements
4 Elements
8 Elements
0.0
85.000
85.000
85.000
85.000
0.25
83.998
83.998
0.50
83.134
83.133
83.134
0.75
82.407
82.407
1.00
81.814
81.807
81.812
81.814
1.25
81.354
81.354
1.50
81.027
81.024
81.026
1.75
80.830
80.830
2.00
80.765
80.756
80.762
80.765
Heat removal rate, W
Case
Eg. (4-183)
Eg. (4-186)
Fin efficiency, %*
2 Elements
1.6050
2.1618
95.6
4 Elements
1.8771
2.1569
95.4
8 Elements
2.0149
2.1557
95.3
Exact
2.1552
2.1552
95.3
'Based on Bq. (4-187) with QR from Eq. (4-186).

156
VARIATIONAL AND WEIGHTED RESIDUAL FORMULATIONS
has been laid for extension to two and three dimensions in later chapters. Among
the integral methods introduced here were the Ritz method, the variational or
Rayleigh-Ritz method, and the weighted-residual method. All these approximate
solution methods may be used to solve differential equations. However, we generally
work with an integral form of the governing equation. Each of these methods was
introduced on a global basis, which meant that the trial functions were assumed to
apply globally to the entire problem domain.
The Ritz method is the simplest and least powerful of the methods. A specific
example problem was considered. Following this, the Rayleigh-Ritz method was
introduced and applied to the same problem. This method requires a rudimentary
knowledge of variational calculus, which is the main disadvantage of this approach.
Some of the more important concepts in the calculus of variations were reviewed.
Then four of the most popular weighted-residual methods were introduced, which
included the point collocation method, the subdomain collocation method, the least-
squares method, and the Galerkin method. These weighted-residual methods do not
require any advanced mathematics beyond ordinary calculus (i.e., variational cal-
culus is not needed in these methods). Moreover, it was stated that the weighted-
residual methods could be used even when a classical variational principle does not
exist. Each of these methods was illustrated by solving the same example problem,
and the results of each of the approximate solution methods were compared with
the exact solution. None of them did a particularly good job of matching the exact
solution, but the Galerkin and Rayleigh-Ritz methods were among the best.
After some additional mathematics was reviewed, the Rayleigh-Ritz and Gal-
erkin methods were cast into a form that is directly useful in the finite element
method. The same example problem was solved, approximately, by using trial
functions that no longer applied globally to the entire problem domain but rather
applied locally over each element. These piecewise continuous trial functions gave
rise to two other functions that are referred to as shape functions. These particular
shape functions allow the field variable to be continuous within each element and
at the ends of each element. However, the derivatives at the ends of each element
are not necessarily continuous. Therefore, these particular shape functions are said
to be CO-continuous, or to possess CO-continuity. In Chapter 7, shape functions
with continuous first derivatives will be introduced; shape functions with continuous
first derivatives are said to be Cl-continuous. or to possess Cl-conrinuity. It was
seen that accurate results could be obtained with the use of the piecewise continuous
trial functions, which are really interpolating polynomials. The reader is referred
to the book by Myers [I2l for additional material relating to the variational finite
element method as it applies to one-dimensional problems in heat transfer.
When the Rayleigh-Ritz method is applied to a second-order differential equa-
tion with no first-order derivative present, it results in an integral formulation that
has only a first-order derivative. Therefore, the integral formulation is said to be
a week formulation. In a similar fashion, the Galerkin method also results in a
similar result if the term containing the second-order derivative is integrated by
parts. This is a fundamental step in the finite element method and one that we will
see throughout the book. The implication is that the finite element method can be

PROBLEMS
157
used to obtain solutions to problems that possess real material discontinuities, such
as composite materials with two or more thermal conductivities.
The emphasis in this chapter has been the solution of one-dimensional, second-
order differential equations. In the next chapter, as in Chapter 3, we turn to the
structural analysis area where the general finite element formulation to problems
in stress analysis is presented. Two additional methods of finite element formula-
tions, which are more readily applied to these problems, are introduced.
REFERENCES
1. Hinton, E., and D. R. J. Owen, An Introduction to Finite Element Computations,
Pineridge Press, Swansea, UK, 1979. pp. 3-5.
2. Huebner, K. H., The Finite Element Methodfor Engineers, Wiley, New York, 1975,
pp. 339-357.
3. Arpaci, V. S., Conduction Heat Transfer, Addison-Wesley, Reading, Mass., 1966.
4. Becker, E. B., G. F. Carey, and J. T. aden, Finite Elements: An Introduction, vol. I,
Prentice-Hall, Englewood Cliffs, N.J., 1981, pp. 6-9.
5. Arpaci, V. S., Conduction Heat Transfer, Addison-Wesley, Reading, Mass., 1966, pp.
163-164.
6. Zienkiewicz, O. c., The Finite Element Method, McGraw-Hill (UK), London, 1977,
pp. 74-75.
7. Schwartz, A., Calculus and Analytic Geometry, Holt, Rinehart and Winston, New York,
1967, p. 357.
8. Schwartz, A., Calculus and Analytic Geometry, Holt, Rinehart and Winston, New York,
1967, pp. 798-799.
9. Arpaci, V. S., Conduction Heat Transfer, Addison-Wesley, Reading, Mass., 1966, pp.
439-440.
10. Huebner, K. H., The Finite Element Method for Engineers, Wiley, New York, 1975,
p.445.
11. Zienkiewicz, O. c., The Finite Element Method, McGraw-Hili (UK), London, 1977,
pp.70-72.
12. Myers, G. E., Analytical Methods in-Conduction Heat Transfer, McGraw-Hill, New
York, 1971, pp. 320-362.
13. Incropera, F. P., and D. P. DeWitt, Fundamentals ofHeat Transfer, Wiley, New York,
1981, pp. 105-117.
14. Becker, E. B., G. F. Carey, and J. T. aden, Finite Elements: An Introduction, vol. I,
Prentice-Hall, Englewood Cliffs, N.J., 1981, pp. 36-38.
PROBLEMS
4-1
For the problem posed in Example 4-1, verify that the approximate solution given by
Eq. (4-10) satisfies the boundary conditions given by Eq. (4-8) exactly.
4-2
Reconsider the problem posed in Example 4-1. It is desired to obtain another approx-
imate solution by the first-order Ritz method by using the following trial function:
N1(x)
=
x( I -
.r')

O:sx:S 10
158
VARIATIONAL AND WEIGHTED RESIDUAL FORMULATIONS
a. Does the use of this trial function satisfy, at least approximately, the physics of
the problem?
b. Does the assumed approximate solution satisfy the boundary conditions exactly?
c. Determine the value of UI and hence the approximate solution corresponding to the
above trial function.
d. How does the result from part (c) compare to the exact solution? Show the com-
parison on a graph that includes the approximate solution from Example 4-1.
4-3
For the problem posed in Example 4-1, another first-order Ritz solution is sought by
assuming the following trial function:
N1(x)
= sin 1TX
a. Does this trial function satisfy, at least approximately, the physics of the problem?
b. Does the assumed approximate solution satisfy the boundary conditions exactly?
c. Determine the value of UI and hence the approximate solution corresponding to the
above trial function.
d. How does the result from part (c) compare to the exact solution? Show the com-
parison on a graph that includes the approximate solution from Example 4-1 .
4-4
Recall that the exact solution to the problem posed in Example 4-1 is given by
Ttx;
=
1000/12 x(l - x3)
a. Obtain the first-order Ritz approximation to the problem by assuming the following
trial function:
b. How does the resulting approximate solution compare to the exact solution? Try
to generalize this result.
4-5
Consider the following differential equation:
d2r
-
+ 100 = 0
dx2
subject to the boundary conditions
nO) = 0
T(lO) =
0
a. What phenomenon might these equations represent? Hint: see Example 4-1.
b. Consider the following trial function to be used in the first-order Ritz solution:
N1=x(IO-x)
Verify that the approximate solution that utilizes this trial function satisfies the
boundary conditions exactly.
c. Does the assumed form of the approximate solution satisfy the physics of the
problem, at least approximately?
d. Obtain the first-order Ritz solution to the problem.
e. Determine the exact solution and compare it with the Ritz solution from part (d).
Try to generalize this result.

PROBLEMS
159
4-6
Reconsider the problem posed in Problem 4-5.
a. Verify that the first-order approximate solution with the following trial function
satisfies the boundary conditions exactly:
N (x)
= sin TIX
I
10
b. Is the physics of the problem satisfied, at least approximately?
c. Obtain the first-order Ritz solution to the problem and compare it to the exact
solution.
4-7
Reconsider the problem posed in Example 4-1 except that now an approximate solution
is sought by using the Rayleigh-Ritz method.
a. For the trial function
verify that the boundary conditions are satisfied exactly and that the physics of the
problem is not grossly violated.
b. Obtain the corresponding approximate solution by the Rayleigh-Ritz (variational)
method.
c. Compare the result from part (b) with the exact solution.
4-8
Solve all parts of Problem 4-3 by using the Rayleigh-Ritz method.
4-9
a.
Obtain the first-order Rayleigh-Ritz solution to the problem posed in Example
4-1 by assuming the following trial function:
N1(x) = x(l -
x3)
b. Compare the result from part (a) with the exact solution. Try to generalize this
result.
4-10 For the problem posed in Problem 4-5, verify that the functional/is given by
/ =r[-~ (~) 2 + lOOT] dx
Use the method in Example 4-3.
4-11 Redo Problem 4-10 by using the method in Example 4-4.
4-12 Reconsider the problem posed in Problem 4-5.
a. Determine the approximate solution by the first-order Rayleigh-Ritz method by
using the trial function
The functional/is given in Problem 4-10.
b. Compare the result from part (a) to the exact solution.
c. How does the result from part (a) compare to the approximate solution from the
Ritz method (see Problem 4-6)?

160
VARIATIONAL AN') WEIGHTED RESIDUAL FORMULATIONS
4-13
Reconsider the problem posed in Problem 4-5.
a. Determine the approximate solution by the second-order Rayleigh-Ritz method
by assuming
•
1TX
31Tt
T'sxi =
al Sin TO + a, sin ~
The functional to be extremized is given in Problem 4-10.
b. Compare the result from part (a) with the approximate solution from Problem
4-12 and with the exact solution.
c. Make an educated guess as to what would happen if a series such as
,
~.
(2k -
lIrr.r
T (x)
=
.L. a, Sin ----'-
k=l
10
were used in the Rayleigh-Ritz method for increasingly larger values of 1/.
4-14
Reconsider the problem posed in Example 4-1.
a. Obtain the second-order Rayleigh-Ritz solution that corresponds to the following
trial functions:
Nl(x)
xO -
xl)
Nlt)
xO -
x 4 )
b. Compare the results from part (a) with the approximate solution from Example
4-2 and with the exact solution.
c. Compare the results from part (a) with the approximate solution from Problem
4-7.
4-15
Extend Eq. (4-37) to the case when the functional F is a function of x, y(x). v.Lr),
and y,,(x), where the subscripts are used to denote derivatives.
4-16
Consider the following differential equation:
d'\"
dt', + 6.1' =
lOx
subject to the boundary conditions
y(O)
Y(2)
0
a. By using the method in Example 4-3. verify that the functional to be extremized
is given by
b. Are the boundary conditions given above geometric or natural?
c.
Do the boundary conditions satisfy Eq. (4-46)? Why or why not?

PROBLEMS
1'1
4-17
Reconsider the differential equation given in Problem 4-16. State whether each of
the following sets of boundary conditions is geometric, natural, or neither:
a. .1'(0) = 5
.1'(2) = 3
b. .1',(0) = 5
y(2)
= 3
c. .1'(0)
= 6
y,(2)
= 0
4-18
Reconsider the problem posed in Problem 4-16. Repeat part (a) by using the method
illustrated in Example 4-4.
4-1lj
Nonlinear differential equations may also have a variational formulation. For example,
consider the differential equation
O-Sx-sS
subject to
T(O) = 9
T(5)
= 0
a. Which term (or terms) makes the differential equation nonlinear?
b. Show that the corresponding variational formulation is given by
I = f [3T
l
-
5xlT - ~(~r]at
if the method illustrated in Example 4-3 is used.
4-20
Repeat part (b) of Problem 4-19 by using the method in Example 4-4.
4-21
Consider the following nonlinear differential equation:
d(dT)2
at at
+ ST = 0
subject to the boundary conditions
dT(O)
dx
and
o
(4-73)
T(4) =
100
a. Classify the boundary conditions: i.e .. are they geometric, natural, or neither?
b. Show that the corresponding functional I is given by
f
4
[
I(dT)l]
I =
"/2T2- - ----:
at
o
3 dx
by using the method in Example 4-3.
4-22
Repeat Part b of Problem 4-21 by using the method in Example 4-4.
4-23
The necessary condition for the existence of an extremum of the functional
I
= fF(x,y,y"yu) dx

162
VARIATIONAL AND WEIGHTED RESIDUAL FORMULATIONS
is that its first variation &1 must be zero provided that
[iiF
d(iiF)]
Ib
-
-
-
-
&v
= 0
iiy,
dx iiyu
~
a
and
I
b
aF
-OV
= 0
a.
.1
}\\
(J
(4·75al
(4-75bl
a.
Show that the corresponding Euler-Lagrange equation is given by Eq. (4-74).
b. What order differential equation does Eq. (4-74) eorrespond to? Hint: See Problem
4-25.
c.
What is the highest-order derivative present in the functional F?
d. Try to generalize the results from parts (b) and (e). Explain why the variational
formulation may be called the weak formulation.
4-24
In Problem 4-23. identify:
a. The geometric boundary conditions and explain physically what these imply.
b. The natural boundary conditions and explain physically what these imply.
4·25
Consider the following fourth-order differential equation:
subject to the boundary conditions
0:Sx:s5
o
I
y(5)
r,(5)
100
o
a.
Indicate whether each of the boundary conditions is geometric. natural, or neither.
Hint: See Eqs. (4-73) to (4-79) and Problems 4-23 and 4-24.
b. Show that the corresponding functional 1 is given by
1= r[~(d,~)2 - 4(c!l)' + 2y' - lor] dx
()
_
dv
d\
c.
Do the boundary conditions meet the conditions expressed in Eqs. (4-75)') Which
ones?
d. What is the highest-order derivative present in the governing differential equation')
In the variational formulation (i.c.. in the functional /)')
e.
From the results of part (d), explain why the variational formulation may be called
the weak formulation?
4-26
It is not possible to obtain a classical variational formulation to problems whose
governing differential equation contains an odd-ordered derivative. For example,
consider
d\'
dv
----'- + 4~ + 51' = 3
dx?
dx
.
Using the method illustrated in Example 4-3. try to obtain an expression for the
functional I. Describe clearly the difficulties that are encountered.

PROBLEMS
163
4-27
Reconsider the dilemma posed in Problem 4-26. Using the method illustrated in
Example 4-4, try to obtain an expression for the functional I. Describe clearly the
difficulties that are encountered.
4-28
Reconsider the problem posed in Example 4-1 and obtain additional approximate
solutions by using the trial function
NI(x) = x(l -
x4)
and the following weighted-residual methods:
a. Point collocation
c. Least squares
b. Subdomain collocation
d. Galerkin
4-29
Reconsider the problem posed in Example 4-1 and obtain additional approximate
solutions by using the trial function
NI(x)
sin 1TX
and the following weighted-residual methods:
a. Point collocation
c. Least squares
b. Subdomain collocation
d. Galerkin
4-30
Recall that the exact solution to the problem posed in Example 4-1 is given by
T(x) =
1000/12 x( I -
.r')
Consider the following trial function
NI(x) = x(l -
.r ')
a. Obtain the corresponding approximate solution by using each of the four weighted-
residual methods.
b. How do the approximate solutions from part (a) compare with the exact solution?
Try to generalize this result.
4-31
Solve the problem posed in Example 4-1 by using the point collocation method if
the following two trial functions are used in a second-order approximation:
NI(x) = x( I -
x2)
N2(x ) = x(l -
x 4)
Take the two collocation points at x
=
II, and x
=
:y,.
4-32
Repeat Problem 4-31 by using the subdomain collocation method. Use two equally
spaced intervals.
4-33
Repeat Problem 4-31 by using the least-squares method.
4-34
Repeat Problem 4-31 by using the Galerkin method.
4-35
Solve the problem posed in Example 4-1 by using the point collocation method if
the following two trial functions are used in a second-order approximation:
NI(x)
sin 1TX
N2(x)
sin 31TX

164
VARIATIONAL AND WEIGHTED RESIDUAL FORMULATIONS
4-36
Repeat Problem 4-35 by using the subdornain collocation method. Use two equally
spaced intervals.
4-37
Repeat Problem 4-35 by using the least-squares method.
4-38
Repeat Problem 4-35 by using the Galerkin method.
4-39
Reconsider the problem posed in Example 4-1 and obtain the first-order approximate
solution for the point collocation method by using the trial function
N1(x)
= x( I -
.1")
a. Assume the followingcollocation points: x = 0.2.0.4.0.6. and 0.8.
b. Plot the four approximate solutions from part (a) on a graph that also includes
the exact solution. How do these results compare to that from Example 4-5'1
Which is the best result"
4-40
Consider the differential equation
deT
-, + 100 = 0
dx:
subject to the boundary conditions
O:sx:sIO
T(O)
0
T(l0)
0
Assume the trial function
Obtain the corresponding approximate solution from the point collocation method
and compare it to the exact solution by showing both on a graph. Take the collocation
point at .r = 5.
4-41
Repeat Problem 4-40 by using the subdomain collocation method.
4·42
Repeat Problem 4-40 by using the least-squares method.
4-43
Repeat Problem 4-40 by using the Galerkin method.
4-44
Consider the differential equation
T + 100x
subject to the boundary conditions
o
o :s .r :s 10
T(O)
0
T(IO)
0
a. Assume the trial function
and obtain the corresponding approximate solution by
loI~illg the Ritz Metltotl.

PROBLEMS
165
b. Obtain the exact solution and compare it with the result from part (a) by showing
both on a graph.
4-45
Repeat Problem 4-44 by using the Rayleigh-Ritz method.
4-46
Repeat Problem 4-44 by using the point collocation method. Take the collocation
point at x
= 5.
4-47
Repeat Problem 4-44 by using the subdomain collocation method.
4-48
Repeat Problem 4-44 by using the least-squares method.
4-49
Repeat Problem 4-44 by using the Galerkin method.
4-50
Consider the following differential equation for the temperature T in a bar undergoing
convection to ambient at 25°C:
d 2T
-
-3(T -
25)
dx 2
subject to the boundary conditions
T(O)
dT(2)
dx
o
150
o
a.
Are the boundary conditions geometric, natural, or neither?
b. What does the second boundary condition physically represent?
c.
Derive the integral that represents the functional for the problem. Use either of
the two methods illustrated in the text.
d. Explain clearly and concisely why the following approximate solution is appro-
priate.
T'(x)
=
150 -
a 1x(4 -
x)
e. Obtain the approximate solution corresponding to the Rayleigh-Ritz method.
f.
Obtain the approximate solutions corresponding to the point collocation, subdo-
main collocation, least-squares, and Galerkin methods.
4-51
Verify that the element stiffness matrix for Example 4-9 [which is given by Eq.
(4-141)] evaluates to the result given by Eq. (4-143).
4-52
Verify Eq. (4-145) by performing the exact integration.
4-53
In arriving at Eq. (4-145), an exact integration was performed. Because integrals
such as these arise in essentially all finite element formulations, very sophisticated
numerical integration methods have been developed. These techniques are illustrated
later in the text. One simple method can, however, be introduced here. Let xdenote
the value of the x coordinate at the centroid of the element, or x = (x) + Xk)l2. The
integral is then evaluated approximately by evaluating the integrand at the centroid,
pulling the result through the integral and evaluating the trivial integral that remains.
Therefore, an alternate (but approximate) way to evaluate

166
VARIATIONAL AND WEIGHTED RESIDUAL FORMULATIONS
from Example 4-9 (and Example 4-10) is given by
rIOOOx2Nf dx =
1000 (XI: X} [~J (Xk - x)
a.
Verify that NTis given by
0:5x:51
o
when evaluated at x =
(x, + Xk)J2.
b. Redo Example 4-9 by using this approximate integration method. Repeat only
those parts of the finite element solution that are different from those in Example
4-9.
c.
How do the resulting nodal temperatures compare to those obtained from the exact
integration?
d. Why is it reasonable to expect this approximate integration to yield more accurate
nodal temperatures as the number of elements is increased?
4-54
Consider the differential equation
d2T
-
+ 1000t'
dx'
.
subject to the boundary conditions
T(O)
25
T(I)
50
By making usc of as much of Example 4-9 as is possible. determine the values of T
at six equally spaced nodal points.
4-55
Repeat Problem 4-54 for the following boundary conditions:
T(O)
dT(l)
dt
25
o
4-56
Repeat Problem 4-54 for the following boundary conditions:
T(O)
dT(l)
dx
50
100
4-57
Let us determine the governing equation for the uniaxial stress member as follows.
Consider the tapered uniaxial stress member shown in Fig. P4-57(a). The cross-
sectional area varies with X and may be denoted as A(x). or simply A. The axial stress
is denoted as CT, where CT is positive for tensile stresses and negative otherwise. The
axial force CTA is assumed to vary according to a first-order Taylor expansion as
shown in Fig. P4-57(b). Also shown is the body force bA dx as a result of gravity.
where b is the body force (or weight) per unit volume.

PROBLEMS
167
aA
d
aA -;;; (aA) dx
(b)
Load
(a)
Figure P4·57
a. By considering the elemental volume shown in Fig. P4-57(b) to be in static
equilibrium in the x direction, show that
d(oA) + bA = 0
dx
(4·190a)
b. Rewrite Eq. (4-190a) in terms of the axial strain € by invoking Hooke's law (which
is a constitutive relationship) or o = E€. Note that this implies that we are assuming
the material to be linear elastic.
c.
Next, eliminate the strain € in the result from part (b) by invoking the strain-
displacement relationship, € = duidx , where u is the axial displacement that is,
in general, a function of x. In other words, show that Eq. (4-190a) becomes
d (
dU)
d;
AE dx
+ bA = 0
(4·190b)
Equation (4-190b) is now in a suitable form for a Ritz, Rayleigh-Ritz, or weighted-
residual solution. It is the governing equation for the problem.
4-58
Reconsider Problem 4-57 in general and Eq. (4-190b) in particular. It is desired to
obtain the corresponding functional. Let us proceed as follows: from Eq. (4-55) it
follows that
(4·191a)
r
L
I
(d )2
r
L
s Jo 2: AE ~
dx + s J, ubA dx = 0
In the usual manner (by integrating by parts, etc.), show that this may be written as
I
L
du
&/ = AE- &u
dx
0

168
VARIATIONAL AND WEIGHTED RESIDUAL FORMULATIONS
(4-191b)
I
t
+
ubA dx
o
But E duldx =
(J and (fA = P, where P is the axial force; therefore, show that I
itself is given by
I = -l-~rAE(dU)2 dx
()
2
0
dx
(4-192a)
4-59
Reconsider Problems 4-57 and 4-58 in general and Eq, (4-19Ib) in particular. Let
us now obtain the finite clement characteristics (i.c.. K" and f") by the Rayleigh-Ritz
method. We proceed in the following manner:
a, Rewrite Eq. (4-/91 b) on an clement basis as follows:
/" = PII<'I ,( -
~r At (dll<,)2 dx + j" lI'bA dx
',
~
I,
d.\
1/
where a typical clement e connects node j at x
=
XI and node k at X
=
X! as
shown in Fig. P4-59. Note that a typical node actually represents a plane and not
just a point as shown.
b. Since the shape functions from Sees. 4-8 and 4-9 arc applicable here (why"), the
axial displacement u" over a typical clement e can be represented as
(4-192b)
where N is given by
N
(4-192c)
o
Figure P4-59
Note that L is defined here to be the clement length, or L

PROBLEMS
169
and a" by
(4-192d)
where, in turn, Uj and Uk are the axial displacements at nodes j and k, respectively
(positive in the +x direction). Substitute for u" in Eq. (4-l92a) with u" given by
Eq. (4-192b), compute dr/dar, set the result to zero, and rearrange the terms to
show that we get
where
and
Ke
K'ae = fe
J"dNT
dN
-AE-dx
Xl
dx
dx
(4-192e)
(4-192f)
(4-192g)
c. Treating A. b, and E as constants in any given element by using the values at the
midpoint of the element where x = xand denoting them as A, b, and E, respec-
tively. show that
and
fe =
[-;~] + b~L [: ]
(4-192h)
(4-192i)
where L is the element length, or L =
Xk
-
xJ; and P, and P, are the axial forces
at nodes j and k, respectively (positive in the +x direction).
d. After the assemblage step and the geometric boundary conditions (prescribed
displacements) have been imposed, the following matrix equation may be used
to represent the entire uniaxial stress member:
Ka = f
This equation is solved in the usual manner for the vector of nodal unknowns a.
Therefore. the axial displacement at each nodal point is now known. Show that
the average strain E within the element is given by
the average axial stress a by
E =
Uk
-
U,
L
(4-192j)
(4-192k)

170
VARIATIONAL AND WEIGHTED RESIDUAL FORMULATIONS
and the average axial force F by
AE(u,
U,)
F =
L
(4-192m)
These average axial strains, stresses. and forces are generally associated with the
centroid of the element. i.e., at x = x = (x, + x,)/2.
4-60
Reconsider Problem 4-57 in general and Eq. (4-190b) in particular. Let us now obtain
the finite element characteristics (i.c.. K" and f") by the Galerkin weighted-residual
method. We proceed in the following manner.
a,
Form the weighted-residual equation for a typical clement in the usual manner
by writing rNT l!!.. (AE dU) + bAJdX = 0
"
dx
dx
(4-193a)
where a typical element e connects node} at x = x, and node k at x = x, as
shown in Fig. P4-59. Note that a typical node actually represents a plane and not
a point as shown. Integrate by parts the term in Eq. (4-l93a) containing the second
derivative and show that
I
',
NTAE du
dx '.
b. Note that
I',dN t
du
I"
-
-
AE -
dx +
NTbA dx
'I
dx
dx
r
AE du = AEf. = Au = P
dr
o
(4-193b)
where f. is the axial strain, rr is the axial stress, and P is the axial force. Use this
result only in the integrated term in Eq. (4-193b) to give
I
', (' dN T
d ,.
IX,
PN T
- J. -
AE --!!- dx + .
NTbA dx= 0
r
,dI
dx
,
J
1
J
(4-193c)
Note that superscript (") has now been added to u to give u' because the assumed
displacement function applies only on an element basis, not globally.
c,
Since the shape functions from Sees. 4-8 and 4-9 are applicable here (why"), we
can represent the axial displacement over a typical element e as
u" = Nat'
where N is given by Eqs. (4-129a) and (4-127) and ae is given by
(4-193d)
(4-193e)
where uJ and u, are the axial displacements at nodes) and k, respectively (positive
in the +x direction). Show that Eq. (4-l93c) can be written in the form
(4-193f)

where
and
f"dNT
dN
K' =
-AE-dx
X
J
dx
dx
PROBLEMS
171
(4-193g)
(4-193h)
Note that these expressions for the finite element characteristics are identical to
those obtained by the Rayleigh-Ritz method in Problem 4-59.
d. Do part (c) in Problem 4-59.
e. Do part (d) in Problem 4-59.
4-61
Consider the tapered uniaxial stress member shown in Fig. P4-61(a). The top of the
member is fixed, and a load P is applied to the bottom end. It is desired to obtain
the displacements and the internal strains, stresses, and forces. Although it is possible
to obtain the exact solution, a finite element solution is sought as described below.
The member has a circular cross section with D =
1.0 in., d = 0.5 in., H =
12
in., and P =
5000 Ibf. In addition, the material is 0.6% carbon steel with E =
30
X
106 psi and b =
0.283 lbf/in.:'. Using the discretization shown in Fig.
P4-61(b) with five equally spaced nodes and making use of the results of Problem
4-59 (or Problem 4-60), do the following.
8. Determine the displacement at each nodal point.
b,' Determine the element resultants that are defined here to include the strains,
stresses, and forces within each element.
c. Show that the body force contribution to the assemblage nodal force vector may
be neglected with very little error.
d. Compare these results with those from the exact solution.
4-62
Solve Problem 4-61 if the member has a circular cross section with D
=
2 ern,
d =
I cm, H = 25 ern, and P =
18 kN. In addition. the material is 0.6% carbon
steel with E = 21
X
1010 N/m2 and b = 77 kN/m3
r-D----l
%
0
T1
H
p
Figure P4·61

172
VARIATIONAL AND WEIGHTED RESIDUAL FORMULATIONS
4-63
Solve Problem 4-61 if the cross section of the member is square.
4-64
Solve Problem 4-62 if the cross section of the member is square.
4-65
What is the half-bandwidth of the assemblage stiffness matrix for the discretized
uniaxial stress member in Problem 4-6l'1 Does Eq. (3-33) give the correct result'}
4-66
Let us derive the governing equation for the temperature T(x) in a circular pin fin of
varying cross-sectional area A and perimeter P as shown in Fig. P4-66(a). We proceed
by taking an infinitesimal slice of the fin with thickness dx and represent the heat
transfer rate to the slice from conduction as qA, where q, is the heat flux. As shown
in Fig. P4-66(b), the corresponding heat transfer rate leaving the slice is obtained by
assuming a first-order Taylor expansion. In addition, the convective heat transfer
from the exposed surface of the fin is given by hP(T -
Ta ) dx, where h is the
convective heat transfer coefficient and T; is the ambient fluid temperature far removed
from the fin. The length of the fin is LI"
a. From a steady-state energy balance on the infinitesimal slice shown in Fig.
P4-66(b), show that
d
-- (q A)
-
hP(T - T)
dx
.r
a
o
(4-194a)
Base of
fin at
temperaturer,
,
I
I
~I
I+--------Lf~
0"----"" x
(a)
hP(T- T,ldx
Insulated
tip
(b)
Figure P4-66

PROBLEMS
173
b. Next, invoke Fourier's law of heat conduction
dT
q, = -kdx
(4-194b)
where k is the thermal conductivity. Equation (4-194b) is referred to as a COII-
stitutive relationship, The minus sign is necessary because q, is assumed to be
positive in the direction of decreasing temperature. With the help of Eq. (4-194b),
show that Eq. (4-194a) becomes
d (
dT)
-
kA - - hP (T -
T) = 0
dx
dx
"
(4-194c)
Equation (4-194c) is now in a suitable form for a Ritz, Rayleigh-Ritz, or weighted-
residual solution and represents the governing equation for the problem.
4-67
Reconsider Problem 4-66 in general and Eq. (4-194c) in particular. It is desired to
obtain the corresponding functional. Let us proceed as follows. From Eq. (4-55) it
follows that
&I = iLl [~ (kA dT) -
hP(T -
T,,)lOT dx = 0
o
dx
dx
In the usual manner (by integrating by parts, etc.) show that this may be written as
I
Lf
0/ = kA dT st
dx
0
oiLl ~ kA (dT)2 dx
() 2
dx
-
0f'i hPT2 dx + 0rhPT"T dx = 0
(4-195a)
(4-195b)
But k dT/dx
=
- q" where q, is the heat flux from conduction. Therefore, show
that / itself is given by
/ = -qAT!: rikA (:)2 dx
I iLl
JLf
-
-
hPT2 dx +
0
hPT"T dx
2
0
4-68
Reconsider Problems 4-66 and 4-67 in general and Eq. (4-195b) in particular. Let
us now obtain the finite element characteristics (i.e .. K" and f") by the Rayleigh-
Ritz method by proceeding in the following manner:
a. Rewrite Eq. (4-l95b) on an element basis as
/"=
(4-196a)
where a typical element e connects node j at x = XI and node k at X = x" as
shown in Fig. 4-12. Each node actually represents a planar surface, not just a
point.

174
VARIATIONAL AND WEIGHTED RESIDUAL FORMULATIONS
b. Since the shape functions from Sees. 4-8 and 4-9 are applicable here (why?), the
temperature T' over a typical element e can be represented as
where N is given by
T' = Na e
(4-196b)
and a" by
N
x- x]
Xk
-
~i
(4-196c)
a' = [~]
(4-196d)
where TJ and T, are the temperatures at nodes j and k, respectively. Substitute for
T' in Eq. (4-196a) with T' given by Eq. (4-196b), compute dl'lde", set the result
to zero, and rearrange the terms to yield
where
and
K"
Kea' = p'
(4-196e)
(4-196f1
and, further,
and
Ke.r
feq
fe
f~ + f[,
f"dNT
dN
-kA-dx
,dx
dx
jr WhPN dx
'j
(4-196g)
(4-196h)
(4-196i)
(4-196j)
(4-196k)
Note that K~ and K[, are 2 x 2 element stiffness or conductance matrices, and
the nodal force vectors
f~ and f[v are both of size 2 x I.
c.
It should be noted that k, h, A, P, and T; may all be functions of x. However,
let us perform the integrations in Eqs. (4-196h) to (4-196k) approximately by
taking the following approach. Let us treat these parameters as constants in any
given element by using the values at the midpoint of the element where x = x
and by denoting them as k, Ii, :4, P, and Ta • Show that
kA [
I
Ke --
.r
-
L
-I -:]
(4-196m)

PROBLEMS
175
= hPL [2
1-'
K~v
6
I 2J
(4-196n)
fe
=
[ +qjA;]
(4-196p)
q
-qkAk
f~v = hP~aL [:]
(4-196q)
where qj and qk represent the heat fluxes from conduction at nodes j and k; Aj
and Ak are the values of the cross-sectional areas at nodes j and k; and L is the
element length (i.e., L =
Xk
-
Xj)' In Chapter 8 it will be seen how convection,
radiation, and prescribed heat flux boundary conditions may be included. In the
fin model, heat fluxes are not usually imposed on the ends of the fin; therefore,
f~ is identically zero for all elements.
4-69
For the pin fin problem formulated in Sec. 4-10, begin with the expressions for the
element characteristics [given by Eqs. (4-174) to (4-176)] and derive Eqs. (4-179)
to (4-181).
4-70
The heat removal rate from a fin may be computed by Eq. (4-183) or by Eq. (4-186)
once the nodal temperatures are known.
a. Derive Eq. (4-183) by beginning with Eq. (4-182).
b. Derive Eq. (4-186) by beginning with Eq. (4-185).
c. Which of the two methods gives more accurate results? Why?
4-71
Consider the fin shown in Fig. P4-71(a). The base of the fin (at x = 0) is held at a
fixed temperature Tho the surface of the fin (except the tip) is exposed to a fluid at
temperature Ta , and the tip of the fin is insulated. It is desired to obtain the steady-
state temperatures within the fin and the heat removal rate. Although it may be
possible to obtain an exact solution, a finite element solution is sought. The fin has
a circular cross section with D = 0.5 ern, d = 0.2 cm, and Lf = 3 cm. It undergoes
convection to a fluid at T; = 25T with h = 75 W/m2_oC. The fin is made of cast
aluminum (4.5% copper) with k =
168 W/m-oC and has a base temperature Th of
90°C. Using five equally spaced nodes as shown in Fig. P4-71(b) and making use
of the results of Sec. 4-10 or Problem 4-68:
a.
Determine the temperature at each nodal point.
b. Determine the heat removal rate from the fin using the two methods given in Sec.
4-10. Which of these is more accurate? Determine the fin efficiency.
4-72
Solve Problem 4-71 for a fin of circular cross section with D = 0.20 in., d = 0.10
in., and Lr =
1.5 in. The fin is made of mild steel (I % carbon) that has a thermal
conductivity of 26 Btu/hr-ft- OF and undergoes convection to a fluid at 70°F with a
heat transfer coefficient of 50 Btu/hr-ft 2-oF. The base temperature is 250°F.
4-73
Consider the straight fin of a rectangular cross section shown in Fig. P4-73. The fin
is made of mild steel (I % carbon) that has a thermal conductivity of 26 Btu/hr-ft-
OF. Both the upper and lower surfaces undergo convection to a fluid at 35°F with a
heat transfer coefficient of 30 Btu/hr-ft-c'F. The base temperature is 120°F. Take
Lf = 1.625 in. and t = 0.375 in. The fin width W is much greater than Lf and so a
one-dimensional temperature distribution is sought.

176
VARIATIONAL AND WEIGHTED RESIDUAL FORMULATIONS
Base al
temperature
t;
(b)
Figure P4·71
Insulaled
tip
Figure P4-73

PROBLEMS
177
a. Discretize the fin into four equal-length elements with five nodes.
b. Using the results of Sec. 4-10 or Problem 4-68, determine the temperature at each
nodal point.
c. Determine the heat removal rate in two different ways. Which of these two results
is more accurate? What is the fin efficiency?
d. Compare the results from parts (b) and (c) with those from the exact solution.
4-74
Solve Problem 4-73 if the fin is made of cast aluminum (4.5% copper) with a thermal
conductivity of 168 W/m-°C. The convective heat transfer coefficient is 85 W/m 2-
°C on both the upper and lower surfaces to a fluid at 5°C. The base temperature is
at 95°C. Take Lf = 3 cm and t = 0.75 cm.
4-75
Consider the straight fin of triangular cross section shown in Fig. P4-75. The fin
material is aluminum alloy 2024-T6, and has a thermal conductivity of 177 W/m-
"C. Both the upper and lower surfaces convect to a fluid at 35°C through a heat
transfer coefficient of 150 W/m 2_oC. Assume a base temperature of 100°C and take
Lf =
1.0 em and H = 0.4 cm. Since the fin width W is much greater than Lf , a one-
dimensional temperature distribution is expected.
a. Discretize the fin into four equal-length elements with five nodes.
b. Use the results of Sec. 4-10 or Problem 4-68, and determine the temperature at
each nodal point.
c. Determine the heat removal rate in two different ways. Which of these two results
is more accurate? What is the fin efficiency?
4-76
Solve all parts of Problem 4-75 if the fin is made of mild steel with k = 26 Btu/hr-
ft-T', h = 150 Btu/hr-ft2-oF, Tb = 200°F, Ta = 75°F, H = 0.25 in., and Lf = 1.0
m.
T
H1
Base at
temperature
r;
Figure P4-75

178
VARIATIONAL AND WEIGHTED RESIDUAL FORMULATIONS
4-77
Convert the TRUSS program in Appendix B into one that could be used to find the
displacements, strains. stresses, and forces within a uniaxial stress member. Allow
up to 30 elements (and 31 nodes) with up to five different materials. The program
should be able to handle prescribed displacements as well as imposed nodal forces.
Take advantage of the developments in Problem 4-59 (or 4-60). A uniform taper may
be assumed.
4-78
Convert the TRUSS program in Appendix B into one that could be used to find the
temperature distribution within, the heat removal rate from, and the efficiency of an
arbitrary fin. Allow up to 30 elements (and 31 nodes) with up to five different
materials. The program needs to handle only prescribed temperature boundary con-
ditions (and insulation, which, being a natural boundary condition, is automatically
included). Take advantage of the development in Sec. 4-10. Allow for spacially
dependent thermal conductivities, cross-sectional areas, heat transfer coefficients,
perimeters, and ambient fluid temperatures by taking the following approach. Change
SUBROUTINE PROPTY to the following:
C••••
C
C
1
SUBROUTINE PROPTY (L, MATFLG, DATMAT,
THERCN, AREA, HTC, PERIM, TAMB)
DEFINES THE THERMAL CONDUCTIVITY, CROSS- SECTIONAL
AREA, HEAT TRANSFER COEFFICIENT, PERIMETER, AND
AMBIENT TEMPERATURE FOR ELEMENT L
DIMENSION MATFLG(3D), DATMAT(S,S)
NFLAG
~ MATFLG(L)
THERCN
= DATMAT(NFLAG, 1)
IF (THERCN .LT. D.)
CALL VPROP (THERCN)
AREA
= DATMAT(NFLAG, 2)
IF (AREA. LT. D.)
CALL VPROP (AREA)
HTC
= DATMAT(NFLAG, 3)
IF (HTC .LT. D.)
CALL VPROP (HTC)
PERIM
~DATMAT(NFLAG,~)
IF (PERIM . LT. D.)
CALL VPROP (PERIM)
TAMB
= DATMAT(NFLAG, 5)
IF (TAMB .LT. D.)
CALL VPROP (TAMB)
RETURN
END
Note that if a negative value is read for any property. then SUBROUTINE VPROP is called,
which is given by
SUBROUTINE VPROP (PROP)
COMMON/CONST/C(lD)
COMMON IV PROPS; X

C..••
1
2
3
5
MATHEMATICAL CONSTANTS:
PI
~ 3.M1593
IPROP = -PROP
GO TO (1, 2, 3, c , 5), I PROP
PROP
=
definition of first variable property
as a function of x and the C(i)'s
RETURN
PROP
=
definition of second variable
property and so forth.
RETURN
CONTINUE
RETURN
CONTINUE
RETURN
CONTINUE
RETURN
END
PROBLEMS
179
Note that if PROP is negative, it is converted to a positive integer IPROP. The computed
go to then transfers control to the line whose label is numerically equal to IPROP. Thus by
simply including the proper FORTRAN statements in SUBROUTINE VPROP, variable
properties are easily accommodated. The C(il's are user-defined constants that should be
read in Section I of the input file (after NNODES. NELEM, etc.) and may be used in
SUBROUTINE VPROP. By way of example, let us say that we want to use this technique
to allow for the varying cross-sectional area for the fin in Problem 4-75. Let us define
CO) = 0.004 (for H in meters) and C(2) = 0.0 I (for LJ in meters). If we use a "- 3" as
the input for the area A in Section 4 of the input file (see Appendix B for a description of
the input to the TRUSS program), the statement with label "3" should read
3
PROP = C(1) * (1. -x I C(2»
since this in effect gives
A = WH( I. -
x/Lr)
which represents the correct area variation with x (W is unity since a unit width is assumed).
Note that the variable X represents the x coordinate and is passed to VPROP via the labeled
common (namely, VPROPS).
4-79
Use the computer program from Problem 4-77 (or one furnished by the instructor)
to solve Problem 4-61.
a. Run the program for 5. 9, and 17 equally spaced nodes.
b. What is concluded from the results of part (a)?
4-80
Use the computer program from Problem 4-77 (or one furnished by the instructor)
to solve Problem 4-63.

180
VARIATIONAL AND WEIGHTED RESIDUAL fORMULATIONS
a. Run the program for 5. 9, and 17 equally spaced nodes.
b. What is concluded from the results of part (a)'?
4·81
Use the computer program from Problem 4-78 (or one furnished by the instructor)
to solve Problem 4-71. Use SUBROUTINE VPROP to include the spacially varying
cross-sectional area and perimeter.
a. Run the program for 5, 9, and 17 equally spaced nodes.
b. What is conduded from the results of part (a)'?
4-82
Solve Problem 4-72 by using the computer program from Problem 4-78 (or one
furnished by the instructor) to solve Problem 4-72. Use SUBROUTINE VPROP to
include the spacially varying cross-sectional area and perimeter.
a. Run the program for 5,9, and 17 equally spaeed nodes.
b. Is there a significant difference in the results from part (a)'? Explain.
4-83
Solve Problem 4-73 by using the computer program from Problem 4-78 (or one
furnished by the instructor). Use 5, 9, and 17 nodes to demonstrate increased accuracy
as the element size decreases.
4·84
Solve Problem 4-74 by using the computer program from Problem 4-78 (or one
furnished by the instructor). Use 5, 9, and 17 nodes to demonstrate increased accuracy
as the element size decreases.
4·85
Solve Problem 4-75 by using the computer program from Problem 4-78 (or one
furnished by the instructor). Use 5, 9, and 17 nodes and SUBROUTINE VPROP to
model the cross-sectional area variation with x.
4·86
Solve Problem 4-76 by using the computer program from Problem 4-78 (or one
furnished by the instructor). Assume 5, 9, and 17 nodes, and use SUBROUTINE
VPROP to model the cross-sectional area variation with x.
4·87
Consider the annular fin of constant thickness as shown in Fig. P4-87. The outer
edge at radius R; is insulated. The inner edge at radius R, is held at the base temperature
Th. Both top and bottom surfaces convect to a fluid at temperature Tothrough a heat
transfer coefficient h.
a. Show that the governing equation is given by
~ (klr dT) -
2hr(T -
To)
0
dr
dr
and the boundary conditions by
T(R i )
r,
dT
dr (R,,)
0
b. Explain why the finite element formulation from Sec. 4-10 or Problem 4-68 is
applicable providing that we use
A
2'ITrl

PROBLEMS
181
Base at
temperature
r,
Insulated
edge
Figure P4·87
and
P = 41Tr
4·88
Use the program from Problem 4-78 (or one furnished by the instructor) to determine
the temperature distribution within, the heat removal rate from, and the efficiency
of the brass annular fin shown in Fig. P4-87. Take k = 60 Btu/hr-ft-T', t = 0.125
in., R; = 0.625 in., R" = 1.5 in., T; = 300°F, h = 20 Btu/hr-ft2-OF, and Ta =
70°F. Use 30 nodes.
Hint: See Problems 4-78 and 4-87 and make use of SUBROUTINE VPROP to
take the variable cross-sectional area A and perimeter P into account. The variable
X in SUBROUTINE VPROP should be interpreted to be the radial coordinate r.
4·89
Do Problem 4-88 for an annular fin made of AISI 1010 carbon steel with k = 64
W/m-oC, t = 5 mm, R; = 1.0 em, R" = 2.0 em, T; = 160°C, h = 15 W/m 2-oC,
and T; = 40°C. Use 30 nodes. (See Problem 4-88 for a hint.)
4·90
Consider the differential equation and boundary conditions in Problem 4-5.
a. Derive the integral expressions for the element characteristics. Use the variational
method.
b. Evaluate the integrals from part (a) by using the shape functions given by Eqs.
(4-127) for the two-node one-dimensional element.
c. Use four equally spaced nodes (three elements) and determine the value of T at
these nodes.
4-91
Solve all parts of Problem 4-90 by using the Galerkin method.
4·92
Consider the differential equation and boundary conditions in Problem 4-16.
a. Derive the integral expressions for the element characteristics. Use the variational
method.

182
VARIATIONAL AND WEIGHTED RESIDUAL FORMULATIONS
b. Evaluate the integrals from part (a) by using the shape functions given by Eqs.
(4-127) for the two-node one-dimensional element.
c.
Use four equally spaced nodes (three elements) and determine the value of y at
these nodes.
4-93
Solve all parts of Problem 4-92 by using the Galerkin method.
4-94
Consider the differential equation and boundary conditions in Problem 4-25. Try to
derive the integral expressions for the element characteristics. Use the variational
method. Can the shape functions for the two-node one-dimensional element be used
to evaluate the integrals? Why or why no!") Hint: Integration by parts must be used
twice.
4·95
Do Problem 4-94 by using the Galerkin method.
4·96
The differential equation given in Problem 4-26 does not have a classical variational
formulation.
a.
Use the Galerkin method and derive the integral expressions for the finite clement
characteristics. Allow for only natural and geometric boundary conditions.
b. Is each of the stiffness matrices symmetric')
c.
What can be concluded when the differential equation contains an odd-order
derivative?
4-97
Consider the differential equation and boundary conditions in Problem 4-44.
a.
Derive the integral expressions for the element characteristics. Use the variational
method.
b. Evaluate the integrals from part (a) by using the shape functions given by Eqs.
(4-127) for the two-node one-dimensional element.
c.
Use four equally spaced nodes (three elements) and determine the value of T at
these nodes.
4·98
Solve all parts of Problem 4-97 by using the Galerkin method.
4·99
Consider the differential equation and boundary conditions in Problem 4-50.
a.
Derive the integral expressions for the element characteristics. Use the variational
method.
b. Evaluate the integrals from part (a) by using the shape functions given by Eqs.
(4-127) for the two-node one-dimensional element.
c.
Use four equally spaced nodes (three elements) and determine the value of T at
these nodes.
4-100
Solve all parts of Problem 4-99 by using the Galerkin method.
4·101
Consider the differential equation and boundary conditions in Problem 4-87.
a.
Derive the integral expressions for the element characteristics. Use the variational
method. Note that the elements in this case are concentric annuli with nodes j
and k at radii TJ and T" respectively.
b. Evaluate the integrals from part (a) by using the shape functions given by Eqs.
(4-127) for the two-node one-dimensional element. Note that x must be replaced
by T, x) by TJ• and Xk by Tk' Do not evaluate the integrals exactly. Instead. evaluate
the integrand at the element centroid. and proceed.

PROBLEMS
183
4-102
Solve all parts of Problem 4-101 by using the Galerkin method.
4-103
Solve Problem 4-88 by hand using two elements and the formulation from Problem
4-101 or Problem 4-102.
4-104
Solve Problem 4-89 by hand using two elements and the formulation from Problem
4-101 or Problem 4-102.
4-105
Use the variational approach to determine the integral expressions for the element
characteristics for the differential equation and boundary conditions given in Problem
4-19. Note that the differential equation is nonlinear. Comment on how this problem
might be solved numerically with the finite element method.
4-106
Solve Problem 4-105 by using the Galcrkin method to derive the integral expressions
for the element characteristics.


5
General Approach
to Structural Analysis
5-1
INTRODUCTION
One of the most important and challenging steps in all finite element analyses is
the derivation of the finite element characteristics. It should be recalled that these
are defined to be the expressions for the element stiffness matrix K" and nodal
force vector f". The superscript (e) serves as a reminder that the expressions are
derived on an element basis. In the last chapter these finite element characteristics
were derived based on the Rayleigh-Ritz and Galerkin methods. The former is a
variational method, whereas the latter is based on the weighted-residual method.
These methods, particularly the Galerkin method, are easily applied to nonstructural
two- and three-dimensional analyses, as will be seen in later chapters. However,
in stress and structural analysis applications, the finite element characteristics are
more easily derived by invoking one of the following: (I) the principle of minimum
potential energy, (2) the principle of virtual displacements, (3) the minimum com-
plementary energy principle, (4) the principle of virtual stress, (5) Reissner's prin-
ciple, or (6) Hamilton's principle [IJ.
The principles of minimum potential energy and of virtual displacements are
used in this chapter. Both approaches result in the so-called stiffness (or displace-
ment) method, wherein the primary unknowns are the nodal displacements (as
opposed to the nodal forces). The finite element formulation based on these two
principles is presented in Sec. 5-5 after each is introduced. The four remaining
methods are outside the scope of this book. This chapter is further restricted to
static stress analysis.
The chapter begins with a review of the basic concepts of elasticity, which
include the notions of stress and strain at a point, principal stresses, and constitutive
185

186
GENERAL APPROACH TO STRUCTURAL ANALYSIS
relationships (generalized Hooke's law); the equations of static equilibrium and
compatibility; and the strain-displacement relationships. This is followed by the
development of the principles of minimum potential energy and virtual displace-
ments for direct use in the finite element method. The piecewise continuous trial
functions that are used to represent the displacements within an element will be
referred to as displacement functions. The criteria that these functions must satisfy
to ensure convergence are delineated in Chapter 6. Although the approach is illus-
trated with a simple one-dimensional example, it should be emphasized that the
expressions to be derived for the finite element characteristics are applicable to
one-, two-, and three-dimensional stress analysis problems, as well as to those with
axisymmetry. In fact, these results can even be used in the analysis of plates and
shells.
5-2
BASIC CONCEPTS IN ELASTICITY
The terms stress and strain as used below are defined quantitatively in subsequent
sections. For now let us define stress as force per unit area and strain as elongation
per unit length. In this book only linear elastic materials are considered. This
particular class of materials behaves in such a way that when loaded and subse-
quently unloaded, the stress-strain relationship is linear, as shown in Fig. 5-l(a),
and the material returns to its original undeformed state. A material that returns to
its original shape with a stress-strain relationship, as depicted in Fig. 5-I(b), is said
to be nonlinear elastic. The elastic limit of the material is the stress at which
permanent deformation occurs. The proportional limit is the same as the elastic
limit for linear elastic materials. The analysis of structures outside the linear elastic
range is beyond the scope of this book.
For a more formal development of the material in this section, the reader is
referred to references [2-41 for several excellent books on the subject. In keeping
Strain
(a)
Strain
(b)
Figure 5-1
Stress-strain curves for (a) linear clastic and (b) nonlinear elastic materials.

BASIC CONCEPTS IN ELASTICITY
187
with the introductory nature of this book, indicial notation (cartesian tension no-
tation) is not used.
It should be pointed out that the equations of static equilibrium and compatibility
that are reviewed here are not explicitly needed in the finite element method. There
are, however, two reasons for including them here. The first is that reference will
be made to these equations, and the reader should have no doubt as to which set
of equations the reference is being made. The second reason is that a review of
these equations will heip to put the finite element method in the proper context in
this chapter as well as in Chapter 7.
Stress at a Point
The review begins with the definition of stress. Consider a body in static equilibrium,
loaded as shown in Fig. 5-2(a). The external forces F l , Fl , etc., are transmitted
through the body in a complex manner. Based on static equilibrium considerations,
y
F3
F)
'~
tl
F.
F1
F,
R n
F5
Rt 2
x
x
(a)
(b)
y
F3
F~lRt'
LA
F 1
.
LR n
LR t 1
(c)
x
Figure 5-2
(a) External forces acting on body; (b) forces acting on cut surface; (c) forces
acting on an infinitesimally small surface area ~ on cut surface.

(5-1)
188
GENERAL APPROACH TO STRUCTURAL ANALYSIS
when the body is cut along some plane in general, a force R is required to maintain
static equilibrium. Such a plane is shown in Fig. 5-2(b), where the force R has
been resolved into a normal component R" and two tangential and orthogonal
(perpendicular) components Rt l and Rr2. The latter two components are in the plane
of the cut. Instead of working with the entire area A, let us work with a much
smaller area IlA such that the respective forces are IlR", IlR r l , and IlR r2 as shown
in Fig. 5-2(c). The normal stress a" is then defined as
_
I'
IlR"
a" -
lffl
.lA~O IlA
and
and the two shear (or tangential) stresses as
.
IlRtI
atl =
11m --
t>A~O IlA
(5·2)
In other words, as the area over which the force acts is reduced to zero at a point,
three different stresses arise: one normal to the plane containing the point and the
other two tangential. The two tangential stresses are referred to as shear stresses.
The shear stresses are orthogonal to each other as well as to the normal stress.
In the United States where the English engineering system of units is still being
used, the customary unit of stress is pounds per square inch (psi) or kilopounds per
square inch (ksi). In the International System of Units (SI), the unit of stress is
newtons per square meter (N/m 2 ) . For conversion purposes, we may use
I psi = 6895 N/m2
(5-3)
The trend in the United States in engineering has been and will continue to be
toward the SI system of units. It is for this reason that both sets of units are used
in this text.
Let us now consider an infinitesimal volume element of a body positioned at
a point in a global xyz-coordinate system as shown in Fig. 5·3(a). There are six
faces to the cube, and on each face one normal and two shear stresses act as shown.
Note that the two subscripts are identical for normal stresses, whereas they are
different for shear stresses. Thus, no ambiguity should result in using the same
symbol to represent both types of stresses. This nomenclature makes use of the
following convention. The first subscript is associated with the outward normal to
the plane over which the stress acts, and the second subscript is associated with
the direction of the stress. Positive faces are defined to have outward normals in
the same direction as the coordinate axes; negative faces have outward normals
opposite the coordinate axes. The three visible faces in Fig. 5-3(a) happen to be
positive faces, while the three hidden faces are negative. An infinitesimal two-
dimensional element is shown in Fig. 5-3(b), where the top and right sides are
positive faces and the bottom and left sides are negative faces.
With the notions of positive and negative faces in hand, the following sign
convention is adopted. Normal and shear stresses are considered to be positive if
directed in the positive coordinate direction on a positive face. Normal and shear
stresses are also considered to be positive if directed in the negative coordinate

BASIC CONCEPTS IN ELASTICITY
189
y
I
tayy
I~ayx
I
0J'Z
x
(a)
y
Ib)
Figure 5·3
Definition of positive normal and shear stresses in (a) three dimensions and
(b) two dimensions.
direction on a negative face. Otherwise, the stress is considered to be negative. All
stresses shown in Fig. 5-3 have a positive sense. This convention ensures that
positive normal stresses are tensile, whereas negative normal stresses are com-
pressive.
The Equations of Static Equilibrium
Let us now consider an infinitesimal two-dimensional volume element (with thick-
ness t) as shown in Fig. 5-4. The normal and shear stresses are shown in Fig.
5-4, and it is assumed that these stresses vary from point to point in the body in

1
1 b,t
dy --It
a
xx
axy
f-o-+--dx
b
x
~
t a~,~.
190
GENERAL APPROACH TO STRUCTURAL ANALYSIS
y
OOn
~
an
+
a;"
d'
oa l ·x
0rx +~ dv
~
+ aOX'dx
xy
ax
aoxx
°xx + h
dx
x
Figure 5-4
Infinitesimal two-dimensional clement with stresses and body forces shown.
some continuous manner. Consequently, a first-order Taylor expansion is used to
represent the stresses. Each of the stresses in Fig. 5-4 is shown with a positive
sense. The two components of the body force per unit volume (b, and b,) are also
shown. The reader may show that the following equations result if static equilibrium
is to be assured (see Problem 5-1):
iJuxx + au" + b;
0
ax
ay
au" + au" + b.
0
ax
ay
and
«.. = au
(5-4a)
(5-4b)
(5-5)
These equations can be extended to the three-dimensional case by taking an ele-
mental volume dx dy dz and applying the equations of static equilibrium in a similar
manner (see Problem 5-2). The final result is given by
au" + au"
+ au:, + b, = 0
(5-6al
ax
ay
az
iJu.\\ +
aU n + au". + b,.
0
(5-6b)
ax
ay
ilz
au"
au,.:
au__
b,
+
+
+
0
(5-6c)
iJx
ily
az

BASIC CONCEPTS IN ELASTICITY
191
with
and
(5-7)
Obviously, b= is the z component of the body force per unit volume. Equations
(5-4) and (5-6) are known as the equilibrium equations in two and three dimensions,
respectively.
Principal Stresses
The reader will recall that Mohr's circle may be used to obtain the two-dimensional
stresses at a point on a plane whose normal makes an angle 8 with the x axis. Such
a plane is shown in Fig. 5-5. Because a computer program implementation is our
ultimate goal, the transformation equations from
(T.LP (Tvv' and (Txy to (Tx'x', (Tlv"
and (Tx'y' are given here:
(Ty) cos 28 +
(Txy sin 28
(5-8a)
-
Y2((Txx
-
(Tyy) sin 28 + (TX). cos 28
(5-8b)
(5-8c)
Note that (TI",' is not shown in Fig. 5-5 and is the normal stress on the plane with
a normal in the y' direction.
Now let us summarize the equation for the principal stresses in two dimensions.
Recall that the principal stresses occur on the so-called principal planes whose
r
x
Figure 5-5
Element for transformation of stress at a point.

192
GENERAL APPROACH TO STRUCTURAL ANALYSIS
outward normals are rotated through an angle Ill' from the x and y axis, respectively,
where
2u"
tan 21l1' =
a
t X
-
(J'yy
The two principle stresses, U\ and U2' are given by
(5-9)
Un +
2
Un
+
(5-10)
By definition u, is taken to be the algebraically larger principal stress, as shown
on the Mohr's circle in Fig. 5-6. The reader should recall from solid mechanics
that Mohr's circle of stress is a circle on the U-T plane, where
U and T denote
general normal and shear stresses, respectively. Therefore, the maximum principal
stress is u, and the minimum principal stress is U2. In terms of these principal
stresses, the maximum shear stress Tlllax is given by
2
(5-11)
and occurs on a plane oriented 45° from the principal planes. For the purpose of
plotting Mohr's circle or using Eqs. (5-8), a shear stress is positive if it would
cause a counterclockwise rotation about a point within the element and is negative
otherwise.
The principal stresses for the general three-dimensional state of stress are given
by the solution of the following cubic equation:
(5-12a)
a
Figure 5-6
Mohr's circle for the two-dimensional state of stress.

BASIC CONCEPTS IN ELASTICITY
193
where I), 12, and 13 are known as the stress tensor invariants that are defined by
I)
(TXT +
tTy." +
a~~
(5-12b)
12
Uxxayy + UyyIT:: +
U::(J.\X
IT}"
a\2~
a;,
(5-12c)
der[;::
(TXY u,]
13
Un
ay~
(5-12d)
a~.\
U zy
az~
Since Eq. (5-l2a) is third order in a, three roots may be obtained. These roots
represent the three principal stresses.
Example 5-1
For the two-dimensional state of stress shown in Fig. 5-7:
a. Determine the principle stresses.
b. Show the orientation of the element that results in the stresses from part (a).
c. Determine the maximum shear stress and the associated normal stresses.
d. Show these results on Mohr's circle of stress.
Solution
a. The principal stresses are readily computed from Eq. (5-10) to be
or
1000 + (- 30(0)
±
2
[
1000 - (- 3000)J 2
2
-
2
+ (- 2(00)
y
a 1.2
- 1000 ± 2828
J:Si
~D~OOPSi
I
~20001:si
T
x
Figure 5-7
State of stress for Example 5-1.

194
GENERAL APPROACH TO STRUCTURAL ANALYSIS
or
U j
=
1828 psi
and
U2 = - 3828 psi
Note that UI is taken to be the algebraically larger stress [see the Mohr's circle in
part (d)].
b. The angle 8" is easily computed from Eq. (5-9) to be
8" = Y2 tan - I [
2( - 2000)
]
1000 - (- 3000)
or
8" = - 22.5°
Therefore, the principal stresses from part (a) result if the element is rotated - 22.5°
(or 22.5° clockwise) as shown in Fig. 5-8(a). Note that the shear stress is zero in
this state of stress.
c. The maximum shear stress is given by
1828 - (- 3828)
2
2828 psi
3828 psi
(a)
Tmax = 2828 psi
(c )
2828PSi~.j;L---'"""'"
,oo~\;? "'.'"
\1000 pSi
Ihl
a
Figure 5-8
Element orientations for (a) principal stress state and (b) maximum shear stress
state. (c) Mohr's circle of stress.

BASIC CONCEPTS IN ELASTICITY
195
and occurs on an element rotated 45° counterclockwise from the principal stress
orientation, or at 6 = 45° + (- 22.5°) = 22.5° as shown in Fig. 5-8(b). From
Eqs. (5-8),
1000 + (- 3000)
1000 - (- 3000)
2 22 50)]
2
+
2
cos [(
.
+ (- 2000) sin [2(22Sl] = - 1000 psi
O"x'x' = - 1000 psi
1000 - (- 3000)
°
-
2
sin [2(22.5 )]
+ (- 2000) cos [2(22S)] = - 2828 psi
The negative sign of O"x'\,' means that the shear stress on the x' x' face is directed
as shown in Fig. 5-8(b), since this would cause the element to rotate clockwise
about some internal point.
d. Mohr's circle is shown in Fig. 5-8(c) and clearly indicates that the shear
stress is zero on the principal planes and that the maximum shear stress results
when the element is rotated 45° from the principal stress orientation. Recall that a
counterclockwise element rotation 6 is represented on Mohr's circle with a coun-
terclockwise rotation 26.
•
Strain at a Point
Strain like stress generally varies from one point to another in a body under load.
Consider a square element whose sides are of unit length as shown in Fig. 5-9(a).
Under the action of some external loading, the element will deform such that the
sides of the square are no longer perpendicular. In Fig. 5-9(b) the element is shown
after such a deformation. The normal strains En and Eyy are defined with the help
of Fig. 5-9(b) as
Exx =
x~
-
XA
(5-13a)
and
Eyy =
Y~
-
YB
(5-13bl
Recall that these definitions are based on the fact that OA and OB are both of unit
length before the deformation. Also, from this figure it is seen that the shear strain
En is defined as
Ex\,
=
'YI + 'Yz
(5-13cl
These normal and shear strains are all shown with a positive sense. Hence, the
shear strain En is positive when the angle BOA becomes smaller than TII2. Note
that two subscripts are again used: for normal strains the two SUbscripts are identical.
It is seen, therefore, that positive normal and shear stresses will give positive normal

/
Ex x = X~
-
XA
196
GENERAL APPROACH TO STRUCTURAL ANALYSIS
.\'
€rl' =y~ -Ya
(x~,I~1
_-----/
r-;--
I
(XB.Ys If
I
B I
/ Strained
I X2
I dement
I
I
I"
I
1
I
J
- 'xx
/!j..
I
-
-
1.14".1 I
_--
T"j-A
(a)
x
(bl
Figure 5-9
Definition of normal and shear strains. (a) Unstrained element with sides of
unit length and (b) distorted clement.
and shear strains, retaining the notion that positive normal stresses place the element
in tension. Note also that positive shear stresses will cause the element to deform
as shown in Fig. 5-9(b). All of the concepts of stress transformation and principal
stresses applies here for the strain provided that u" is replaced with E.)2 151.
Obviously, strain is dimensionless, but it is customary to report strain in units of
inch per inch (in.lin.), meter per meter (rn/rn). or as microstrain (us) which is IO~ e
in./in.
Strain-Displacement Relations
In stress analysis, the Lagrangian point of view is usually adopted in that we follow
a point in the body as it moves by virtue of the loading and subsequent deformation.
An arbitrary point P therefore is said to undergo displacements in the .r, y, and z
directions, which are denoted as u. v, and w. This is in contrast to the Eulerian
point of view, which is much more convenient in problems involving fluid motion,
whereby we concentrate on a fixed point and observe the fluid velocities and pressure
at this point. In any event, the strains and displacements are not independent but
rather are related for small deformations in two-dimensional problems as
au
al'
au
av
EX \ = -
En = -
E..n = -
+
aX
ay
ay
ax
and In three-dimensional problems as
au
av
all'
Exx = -
E.\,.\ =
Eo:
ax
ay
az
au
av
all'
av
au
all'
En'
-
+
E",
+
E,r
-
+ -
ay
aX
ay
dZ
az
ax
(5-14)
(5-15)

BASIC CONCEPTS IN ELASTICITY
197
Equations (5-14) and (5-15) are known as the strain-displacement relations or
the kinematic relations. Relations similar to those given in Eq. (5-14) hold for
problems in axisymmetric stress analysis, although it will be seen in Chapter 7 that
an additional relation must be satisfied (see Problem 5-8). It should be emphasized
that these equations hold only for small deformations. Stress analysis involving
large deformations is beyond the scope of this text.
It will prove to be convenient in Sec. 5-7 and in most of Chapter 7 to write
Eq. (5-14) [and Eq. (5-15)J in matrix form as
E = Lu
where in two dimensions, we define the strain vector E as
the linear-operator matrix L as
a
0
ax
L
0
a
ay
a
a
-ay
ax
and the displacement vector u as
u =
[u
vjT
(5-16)
(5-17)
(5-18)
(5-19)
The reader should determine L in three dimensions (see Problem 5-9) given that E
and u are defined as
and
u = lu
v
wV'
(5-20)
(5-21)
Note that E is written in Eq. (5-20) in column vector form instead of its
symmetrical tensor form because the former proves to be very convenient in finite
element analysis as shown later in this chapter and throughout Chapter 7. The matrix
L is seen to be a linear-operator matrix; it may also be referred to as the strain-
displacement matrix.
The Compatibility Equation
The strain components themselves are not independent but rather are related in two-
dimensional problems undergoing small deformations by
a2 EX\'
ax ay
(5-22)

198
GENERAL APPROACH TO STRUCTURAL ANALYSIS
The relationship stems from the fact that there are two displacements (in two
dimensions) and three strains. Therefore, the strains must be related to the dis-
placements with the relationship given by Eq. (5-22).
In Problem 5-10, the reader is asked to show that Eq. (5-22) holds and in
Problem 5-11 to state the six compatibility equations that must hold in three di-
mensions. Since these equations are automatically satisfied in the stiffness approach
to FEM, the three-dimensional form of these equations is not explicitly stated here.
A Constitutive Relationship-Hooke's Law
As mentioned, only linear elastic materials that undergo small deformations are
considered in this text. It is assumed that the deformations do not result in strains
that would cause the material to exceed the proportional limit; that is, the material
is assumed to remain within the elastic limits of Hooke's law. It should be recalled
that in the most simple form, Hooke's law states that the normal stress a is pro-
portional to the normal strain E in a uniaxial state of stress, or
a = EE
(5-23)
where E, the proportionality constant, is known as Young's modulus, the elastic
modulus, or the modulus of elasticity. The reader will recall that this important
material constant was used in the two-dimensional truss model developed in Chapter
3. Note that since the strain E is dimensionless, E has units of newtons per square
meter (N/m 2 ) or pounds per square inch (psi), which are the same as the units of
stress.
Equation (5-23) is more appropriately referred to as a constitutive relationship
as opposed to a law. A law in engineering typically holds for all conditions and
under all circumstances (barring relativistic effects). Examples of laws of nature
are the conservation of mass, the first and second laws of thermodynamics, and
Newton's laws of motion. Examples of constitutive relationships are Fourier's law
of heat conduction, Newton's viscosity law, Fick's law of diffusion, and Hooke's
law. In some texts constitutive relationships are referred to as particular laws. Note
that these relationships only hold for a certain class of materials operating in some
limited range. However, without these relationships it would not be possible to
ascertain stress distributions, temperature distributions, velocity and pressure dis-
tributions, and so forth. The reason for this is simple: constitutive relationships are
used to bring the total number of equations used in a given model up to the total
number of unknowns.
For example, in three-dimensional stress analysis, there are fifteen unknowns:
three displacements, six stresses, and six strains. With the constitutive relationship,
there are a total of fifteen equations: three equilibrium equations, six strain-dis-
placement equations, and six constitutive (stress-strain) relationships. The com-
patibility equations are derived from the strain-displacement relations and, therefore,
are automatically satisfied if the other fifteen equations and boundary conditions
are satisfied. In other words, statically indeterminate problems become solvable

BASIC CONCEPTS IN ELASTICITY
199
largely because of the use of some relevant constitutive relationship that describes
the material behavior. The importance of constitutive relationships cannot be over-
emphasized.
Hooke's law in the form of Eq. (5-23) is of rather limited use. A much more
general form is given by [61
(1 = D(E -
Eo) + (10
(5-241
where D is referred to as the material property matrix, (1 the stress vector, E the
strain vector, Eo the self-strain vector, and (10 the initial (or residual) stress vector.
In three dimensions, D is a 6 x 6 matrix and each of the remaining column vectors
is of size 6 x
I. Specific D matrices are given in Chapter 7 for plane stress, plane
strain, axisymmetric stress, and three-dimensional stress analyses. In three-dimen-
sional analysis, we define (1, E, (10, and Eo as follows:
(1
[uu
«.,
a"
ax\,
ITyz
a,xV
(5-251
E
-
[Exx
En
E::
E.n'
Ev,
E:xV
(5-261
(10
[a"
un
a"
ax\,
a,.:
a z, V
15-271
0
0
0
'0
.
0
0
Eo
[ Exxo
E,,\
E__
E.n
El'z
E_, V
15-281
··0
w-o
'0
0
~. 0
We have already reviewed the stress and strain components contained in (1 and E.
However, (10 and Eo deserve comment.
The initial stress vector (10 represents prestresses that are known to exist in a
material before it is loaded. The finite element method (or any method) cannot
predict these. They must be specified by the analyst.
The self-strain vector Eo may be a result of crystal growth, shrinkage, or, most
commonly, temperature changes. Various forms of Eo are presented in Chapter 7
for the different types of stress analysis. The material property matrix D is symmetric
for both isotropic and anisotropic materials. In the isotropic case, the material
property matrix will be seen to centain only two independent material properties
(such as Young's modulus E and Poisson's ratio p.).
Surface Tractions
A surface traction, or simply traction, is defined to be a distributed external or
surface loading per unit area. In this text, the surface traction vector is denoted by
S, which may be written in vector form in three dimensions as
S = Is,
.I',
15-29\
where
.1'."
.1'"
and
.1': are the forces per unit area in the x, v, and z directions,
respectively. In two-dimensional applications, we simply takes. = O. An example
of a surface traction is the hydrostatic pressure (a force per unit area) on the water-
filled side of a dam. Note that in Eq. (5-29) only a single subscript is used to denote
the component of the traction.

200
GENERAL APPROACH TO STRUCTURAL ANALYSIS
For the two-dimensional situation depicted in Fig. 5-IO(a), note that .1', = (T\\
and .1',. = an because the plane over which the surface traction acts happens to be
parallel to the y axis. In a similar fashion, in Fig. 5-10(b), we have .1', =
(T"
and
.1', = cr.,; On nonplanar surfaces or surfaces that are not parallel to one of the
coordinate axes, no such simple relationships exist between the surface tractions
and the stresses acting on the surface.
5-3
PRINCIPLE OF MINIMUM POTENTIAL ENERGY
The principle of minimum total potential energy 17 J may be stated as follows: out
of all the possible displacement fields that satisfy the geometric boundary conditions
(i .e., the prescribed displacements), the one that also satisfies the equations of static
equilibrium results in the minimum total potential energy of the structure (or body).
This has been proved rigorously by Sokolnikoff [81. The total potential <'/lerg.'" II
is defined here to be the sum of two different types of potential energy: that
associated with the internal potential energy V, (i.e., the so-called strain energy)
and that associated with the external potential energy V" from the external forces
that act on the system, or
(5-301
But for conservative force systems the loss in the external potential energy during
the loading process must be equal to the work done, We' on the system by the
external forces, or - V" = + W,,, and Eq. (5-30) becomes
(5-311
The principle of minimum total potential energy requires that II be a minimum for
stable equilibrium. Furthermore, since II is a function of functions (the strain and
displacement functions), it is a functional. The minimization of the total potential
Two-
dimensional
region
I a)
Two-dimensional
region
(b)
Figure 5-10
Relationship between surface tractions and stresses on surface of two-
dimensional bodyfor two special cases: (a) surface parallel to y axis:(b) surface parallel to
x axis.

PRINCIPLE OF MINIMUM POTENTIAL ENERGY
201
energy is a problem in variational calculus. In order to minimize Il, we insist that
the first variation of the total potential energy be zero, that is,
or
oU; = oW"
(5-32)
(5-33)
For convenience, a cartesian reference frame is assumed with .r, y, and z axes. The
term oU; represents the first variation in the strain energy (as a result of a variation
in the strain) or
oU; = f V(UxxOExx + UVVOE'T + U::OE::
+ UXI'0E n · + UI':OEI" + U,xOEt.,) dV
(5-34a)
Equation (5-34a) can be written much more concisely using the matrix notation
from Sec. 5-2:
sn, = f V (OE)'cr dV
(5-34b)
(5-35a)
where OE represents the first variation of the strain vector. The integral in Eqs. (5-
34) is said to be a volume integral because the integration is to be performed over
the volume of the body or structure being analyzed.
In considering the variation in the work done, oW"' by the external forces, we
must allow for the following possibilities: a body force b (per unit volume), a
surface traction s, and up to N point loads f". The first variation of the work done
by these external forces (as a result of a variation in the displacements) is given
by
oWe = f v(bl' ou + b, ov + b, Ow) dV + fs(s, ou + s,ov
N
+ .1', Ow) dS + L U;" ou + L; ov + f;, ow)
p=1
where the first term represents a volume integral and the second term a surface
integral. As the name suggests, a surface integral must be evaluated only on the
surface S of the body or structure being analyzed. With the help of matrix notation,
Eq. (5-35a) may be written as
N
oWe = f v(ou)/b dV + fS(OU)/ S dS + L (Oun"
p=l
where the body force vector b is given by
b = [b,
b.
bX
the surface traction vector s by
(5-35b)
(5-36)
s
(5-37)

202
GENERAL APPROACH TO STRUCTURAL ANALYSIS
and the point load vector f" by
f" = U;"
t.
t. IT
(5-38)
Obviously the vector (OU)T represents the frist variation in the displacement vector,
or
(ou)! = lOll
01'
owl
(5-39)
where 1I, I', and ware the displacements in the .r, v, and: directions, respectively.
With the help of Eqs. (5-34) and (5-35), we may write Eq. (5-33) as
N
f y(O"j1u dV
=
f y(ouJ)b dV + fs(oujls dS + L (ou)!f
"
(5-40)
,,=1
Let us now assume a linear elastic material and eliminate rr by invoking the
constitutive (or stress-strain) relationship given by Eq. (5-24) and rearranging the
result (see Problem 5-18) to get
N
+ f y(ou)!b dV + fs(ou)ls dS + L (llU)lf"
(5-41)
,,=1
This equation looks formidable but the reader need not despair. This result will be
the starting point in Sec. 5-7, where it is used to obtain the finite element char-
acteristics for essentially all problems in static, linear elasticity.
In Problem 5-19 the reader is asked to show that the total potential energy II
must be given by
n =
!I,f~,,,JD,,dV -
fy,,'O"odV + fy,,!uodV
N
-
f yU'b dV - fsu!s dS -
L u!f"
,,=1
(5-42)
The first three terms represent the strain energy as a result of the strains, the self-
strains, and the prestresses, respectively. The last three terms represent the work
done on the structure by the body forces, the surface tractions, and the point loads,
respectively.
Example 5-2
Use the principle of minimum total potential energy to determine the relationship
between the elongation ti and an axial force P in a uniaxial stress member of
uniform cross-sectional area A, length L, and modulus of elasticity E. One end of
the bar is restrained and the load P is applied to the free end, as shown in Fig.
5-11.

PRINCIPLE OF MINIMUM POTENTIAL ENERGY
203
Load
p
(a)
L+6
Load
P
(b)
Figure 5-11
Uniaxial stress member of length L in (a) unloaded condition and (b) loaded
with axial force P.
Solution
Although it is possible to start with Eq. (5-41), it is easier in this example to use
Eq. (5-42) directly by taking
or
EO = 0
(To = 0
b = 0
s = 0
since D is simply E for the state of uniaxial stress. The first term in the expression
for Il represents the strain energy and the second, the work done by the point load
P in moving a distance Il. Noting that E = Il/L gives
n = ~'E(ZrAL - PIl
Since we want to determine the elongation Il for equilibrium and hence the Il that
minimizes Il, we compute dflldll, set the result to zero, solve for Il, and get
Il = PL
AE

204
GENERAL APPROACH TO STRUCTURAL ANALYSIS
which is a very well-known result. In fact, this result was used in the truss for-
mulation in Chapter 3 where the direct approach was illustrated. In Problem 5-20,
the reader is asked to show that the potential energy has in fact been minimized
by examining the sign on d 2I11d62
•
5-4
PRINCIPLE OF VIRTUAL DISPLACEMENTS
The principle of virtual displacements is actually a special case of the more general
principle of virtual work. Recall from elementary mechanics that work is the product
of a displacement and the component of the force in the direction of the displacement.
Virtual work is imagined to occur in one of two ways: (I) when the forces are real
and the displacements are virtual (imagined) or (2) when the displacements are real
and the forces are virtual. The principle of virtual displacements applies to the
former, and the principle ofvirtualforces to the latter. One statement of the principle
of virtual displacements is the following. If the work done by the external forces
on a structural system is equal to the increase in strain energy of the system for
any set of admissible virtual displacements, then the system is in equilibrium. By
admissable virtual displacements we mean those that satisfy the prescribed dis-
placement boundary conditions but are otherwise arbitrary. Before actually devel-
oping this principle, let us illustrate it in a simple example.
Example 5-3
Use the principle of virtual displacements to derive an expression for the elongation
6 in a uniaxial stress member of constant cross-sectional area A, length L, and
elastic modulus E if a load P is applied to the free end while the other end is
completely restrained as shown in Fig. 5-11.
Solution
From Fig. 5-11 it is seen that the work done by the force P is P6. Note that this
is not given by P6/2 because the load P is assumed to be at its full value during
the loading (and elongation) process. Note further that the virtual displacement is
entirely arbitrary and is purposely (and conveniently) taken to be equal to the actual
elongation 6! Similarly, the increase in the strain energy is given by UEV, or
UEV = (EE)EAL = AEL(Z) 2
where E
6/L has been used. The principle of virtual displacements states that
AEL(Zr = P6

(5-43)
,
PRINCIPLE OF VIRTUAL DISPLACEMENTS
205
whereupon solving for fl, we get
fl = PL
AE
which again is the desired and well-known result. As mentioned in Example 5-2,
this result was the basis for the direct approach illustrated by the two-dimensional
truss model in Chapter 3.
•
Let us now develop the appropriate mathematical form of the principle of
virtual displacements. For reasons that will become evident at the end of this section,
let us denote the virtual displacements in the x, v, and z directions as ou, ov, and
ow, respectively. It should be emphasized that OU does not represent the variation
in U but instead is the virtual displacement as defined above. We must recognize
that the virtual displacements will cause virtual straining, with the virtual strains
to be denoted as OE", OE", etc. Let us further consider the external loads as a result
of body force b, surface tractions s, and N point loads f" defined as
b
[b,
b.
b,f
(5-36)
S -
Is,
s,
s,f
(5·37)
and
f" = If;"
t;"
t;,V
(5-38)
The principle of virtual displacements may now be stated mathematically [91 as
I v «Txx OExx + U II' OE"" + U" OE" + U'I' OE" +
(T "Z OE"z +
(T r.r OEzx) dV
= Iy(b, ou + b,ov + b. ow) dV + Is(s, ou + S"ov + Sz ow) dS
N
+
L: (1", ou + 1", ov + 1", ow)
1'=1
or, more concisely, in matrix form as
N
Iy(OE)T(J dV = Iy(ou)Tb dV + Is (ouJ1s dS +
L: (ou)Tf"
1'=1
It is seen that this is identical to the result given by Eq. (5-40), which was obtained
by the principle of minimum potential energy. Equation (5-43) lor (5-40)1 is known
as the weak form of the equilibrium equations, because the equilibrium equations
are seen to contain second derivatives of the displacements (after Hooke's law is
invoked), whereas Eq. (5-43) [or (5-40)1 contains only first derivatives. Further-
more, these two equations are valid for nonlinear as well as linear stress-strain
(constitutive) relationships. Obviously, if Eq. (5-43) is applied to a linear elastic
material with the constitutive relationship given by Eq. (5-24), then Eq. (5-41)
results.

206
GENERAL APPROACH TO STRUCTURAL ANALYSIS
It is seen that the principles of minimum potential energy and of virtual dis-
placements give identical results if the virtual displacements (and strains) are as-
sociated with the variations in the displacements (and strains), and vice versa. The
reason for representing the first variation of each displacement in the same manner
as a virtual displacement should now be obvious. In effect. we have proven the
equivalence of the principles of minimum potential energy and of virtual displace-
ments.
5-5
THE FINITE ELEMENT BASIS
In Sees. 5-3 and 5-4 the principles of minimum total potential energy and of virtual
displacements were used to develop a very important relationship among the internal
stresses (and strains) and the external loads. Both approaches gave virtually the
same result. In any event. volume and surface integrals arose that looked rather
formidable. However, by discretizing the region to be analyzed into a number of
suitable finite elements. as shown in Fig. 5-12, the integrations may be performed
with relative ease; for example,
M
L f v' (0£)/0' dV
e=J
/5-44)
o
c~
(a)
(b)
(e)
1>,
I
~m
;k:5;/
Figure 5·12
Discretization in one, two, and three dimensions with (a) the two-node lineal
clement, (b) the three-node triangular clement. and (c) the four-node tetrahedral clement.

THE FINITE ELEMENT BASIS
207
M
f S (OU)7S dS =
L f SdOU)7S dS
e=1
(5-45)
where ve and S" serve as a reminder that the integrations are to be performed over
the element volume and element boundary, respectively. Note that the results from
the M nonoverlapping elements are, in effect, added together to obtain the integrals
over the original body or region. As we have seen several times before, the sum-
mation is not usually carried in the mathematical manipulations because we simply
consider it to represent the assemblage step. If Eqs. (5-40) and (5-43) hold over
the entire body or region and the region is arbitrarily selected by the analyst (such
as the selection of a free body), then these equations must also hold on an element
basis, or
where f" must be interpreted to be the point loads acting at each node of the element
in addition to any other imposed loads acting within the clement. The notations V"
and S" represent the element volume and clement boundary or surface, respectively.
On internal nodes where no external loading is to be applied, f" from one element
will cancel (during the assemblage step) that from the adjacent element(s) that
shares the same nodes. These same comments hold for the surface traction term
(see Sec. 5-8). In other words, although the integral over S" is nonzero in general
on the element boundaries for element e , the contribution to the assemblage nodal
force vector will be seen to be effectively zero. The reason for this is that the
contribution from the neighboring element will always be of the same magnitude
but of the opposite sign (by Newton's third law) unless an external load is explicitly
applied there.
Returning to Fig. 5-12, it is seen that the two-node lineal element may be used
effectively in one-dimensional problems, the three-node triangular element in two-
dimensional (and axisymmetric) problems, and the four-node tetrahedral element
in three-dimensional problems. In the next section, the shape function matrix N is
...
developed in terms of the shape functions Ni , Nj , etc., associated with each of the
nodes.
5-6
THE SHAPE FUNCTION MATRIX
Recall from Chapter 4 that the field variable in the finite element method is routinely
represented by an interpolating polynomial on a piecewise continuous basis. Let
us restrict the present discussion to applications that require only CO-continuity such
as plane stress, plane strain, axisymmetric stress, and three-dimensional stress (but
not beam or plate bending or shell analysis). The field variables in the stiffness-
based finite element method are always the displacements u, v, and w.

208
GENERAL APPROACH TO STRUCTURAL ANALYSIS
Two-Node Lineal Element
It is instructive to review what happened in Chapter 4 where a scalar field val
was represented in one-dimension with the lineal element. If we now interpret tt..
scalar field variable to be the displacement U in the case of one-dimensional stress
analysis, we may take the interpolating polynomial
(5-47)
to represent this displacement within a typical element. In fact, Eq. (5-47) is referred
to as a displacement function in particular and as a parameter function in general.
If we insist that at node i we have u(x,) = u, and at node i. u(x;)
u;, then we
can find Nj(x) and N;(x) such that
(5-48)
where u, and uJ are the displacements at nodes i and j, respectively. In Chapter 4
we found it convenient to represent this last result in the matrix form
U = Na"
where N, the shape function matrix, is defined as
and a', the vector of nodal unknowns, as
a" =
lUi
u;f
(5-49)
(5-50)
(5-51)
Because the assumed displacement function is linear in x, the shape functions are
also linear in x. Moreover. they must satisfy the following conditions:
N,(xj)
I
N,(x i ) = 0
Three-Node Triangular Element
Nj(x;) = 0
N,(x;) = I
(5-52)
In a similar fashion, it seems reasonable to represent the x component of displace-
ment in two-dimensional (and axisymmetric) problems as
(5-53)
if the three-node triangular element from Fig. 5-12 is used. Note that the triangle
has three nodes and, not accidentally, the parameter function for the displacement
(i.e., the displacement function) has three constants. Therefore, three shape func-
tions should be expected for this element, or
(5-54)

THE SHAPE FUNCTION MATRIX
209
where u., uj , and Uk are the x components of the nodal displacements, and N;, N"
"',J N; are the three shape functions. Because we insist that U(Xi,yJ = U;, u(xj,Y;l
;;11" and U(X"Yk) = u.; it should not come as any surprise that
",rl>
N;(x;,y;)
N/ti,y;)
0
Nk(Xi,Yi)
0
Ni(xj,y;l
0
N/xl,Yj)
Nk(xj,Yj)
0
(5-55)
N,(X"Yk)
0
N/X"Yk)
0
Nk(X"~,,,)
Moreover, because the assumed function for II given by Eq. (5-53) is linear in x
and y, the shape functions themselves must also be linear in x and y. In two-
dimensional problems, the Y component of displacement v must also be considered,
or
(5-56)
where three new constants are introduced. However, because the conditions ex-
pressed by Eq, (5-55) must also hold for the Y component of displacement (why"),
we may write
(5-57)
where Vi' Vj' and Vk are the y components of nodal displacements. Let us now define
u and a" as
and
so that we may write
where
a"
u =
[u
vjT
[IIi
Vi
u = Na"
(5-58)
(5-59)
(5-60)
(5-61)
The shape function matrix N is seen to be of size 2 x 6, since each node has two
degrees of freedom (the x and Y components of displacement) and the element has
three nodes. A typical shape function (that for node i) is plotted in the x-y plane
in Fig. 5-13. Note how N;(x,y) varies from unity at node i to zero at nodesj and
k in a linear fashion. The reader should make an attempt to plot N/t,y) and Nk(x,y)
in a similar fashion (see Problem 5-22).

210
GENERAL APPROACH TO STRUCTURAL ANALYSIS
T
i\'
I \'
I \'
I
\',
I
I
\
-,
I
\
-,
\
-,
x
Figure 5-13
Plot of shape function for node i for the three-node triangular element (with
Cl-continuity).
Four-Node Tetrahedral Element
Finally, it seems reasonable to represent the x component of displacement in three-
dimensional problems by
(5-62)
if the four-node tetrahedral element from Fig. 5-12 is used. Note now that the
tetrahedral element has four nodes and the assumed displacement function has four
constants. Therefore, four shape functions should be expected for this element, and
the displacement function for the x component may be written as
U = N;(x,,,,,,,,z)u; + N;fx,."""z)uj + Nk(x,,,,,,,,Z)Uk + N",(x,y.z)lI,1I
(5·63)
where u, u}' ui ; and u.; are the x components of the nodal displacements. and Ni •
Nj, Ni; and N", are the four shape functions. Again we insist that lI(xi,y"Zi) = u.,
u(xj'Y;'z,) = uj, and so forth. It should be obvious by now that we must have
Nj(x,.y,.z;) = I
N;(x,.y,.z;)
= 0
NI(.r,.Yj,zj)
= 0
NmC'(j'Yi. 2i)
= 0
N;(xJ'Y"z) = 0
N,(x"Yj.z,)
= 1
Nk(x,.r,.z,)
= 0
NII/(x"Y"z,)
= 0
(5-64)
Ni(Xk,Yk.Zk) = 0
N/Xl, Yl'ztl
= 0
Nl(.rl.."k,ztl
= I
NII/(Xk'Yk.Zk)
= 0
Nj(xm,Ym.zm) = 0
N,(xm.Ym.zm) = 0
N.I,:(.tm.Ym,zlI/) = 0
Nm(xm.Ym, zl1l ) = 1
In a similar fashion, if we assume the displacement functions for the
..... at
.
)
components of displacement to be
and
(5-6 y
w
(5-66)

THE SHAPE FUNCflON MATRIX
211
we can in turn use the same shape functions to write these as
v = Nj(x,y,Z)V; + N/x,y,z)Vj + Nk(x,y,Z)Vk + Nm(x,y,Z)Vm
and
(5-67)
W = Nj(x,y,Z)W j + NiX,y,Z)Wj + Nk(x,y,Z)Wk + Nm(x,y,z)wm
(5-68)
where
Vj, Vj' Vb and Vm are the y components of the nodal displacements, etc. If
we now define u and a" as
u = Iu
v
wjT
(5-69)
and
a" = IUj
v,
W;
Uj
V·
W
Uk
Vk
Wk
Um
Vm
wmf
(5-70)
}
}
we may write
u -
Na"
where
[N
0
0
I Nj
0
0
I
Nk
0
0 : »:
0 JJ
N =
~'
I
I
N;
0
I
0
Nj
O'
0
Nk
0
I
0
Nm
I
I
I
0
N j:
0
0
Nj :
0
0
Nk
I
0
0
I
(5-71)
(5-72)
Now the shape function matrix is seen to be of size 3 x 12, because each node
has three degrees of freedom and the element has four nodes. A typical shape
function, e. g., N; will be seen in Chapter 6 to vary linearly from unity at the node
in question (node i) to zero at each of the remaining nodes.
Properties of CO-Continuous Shape Functions
For the one-, two-, and three-dimensional elements in Fig. 5-12, the shape functions
satisfy the following three properties:
1. A shape function associated with a particular node (e.g., node i) must evaluate
to unity if evaluated at the coordinates of this node (node i); all other shape
functions must evaluate to zero at this same node. Actually, this property is
contained in the next property.
2. A shape function associated with a particular node (e.g., node i) varies linearly
from unity at the node in question (node i) to zero at each of the remaining
nodes.
} 1 The sum of all the shape functions at any point within the element or on the
\~·'.~Iement boundaries must sum to unity, or
,
L.N~ =
I
(5-73)
where the element is assumed to have n nodes and 13 takes on i, j, k, etc., as
appropriate. In this text, whenever a shape function for an arbitrary node is
referenced, the subscript 13 is used and the shape function is denoted as N~.

212
GENERAL APPROACH TO STRUCTURAL ANALYSIS
The shape functions for the lineal element were derived in Chapter 4; in terms
of the nomenclature in this chapter they are
and
=
Xi
-
X
Ni(x)
(5-74al
15-74bl
The shape functions for the three-node triangular and four-node tetrahedral elements
are derived in Chapter 6.
Example 5-4
Verify that the shape functions for the one-dimensional, two-node lineal element
given by Eqs. (5-74) have the three properties given above.
Solution
First, note that we have
N,(x,) =
Xi
-
Xi
X;
-
Xi
Xi
-
Xi
Xi
-
X, =1
Xi -
Xi
N/xi)
0
Xi -
Xi
Xi -
Xi
N,(xi) =
= 0
x, -
Xi
which verifies the first property. In fact. these conditions were summarized earlier
in Eq. (5-52).
Next, note that N,(x) is unity at X =
Xi (i.e., at node i) and decreases linearly
to zero atx =
Xi (i.e., at node)). Similarly, note that Ni(x) is unity atx =
Xi (i.e.,
at node j) and decreases linearly to zero at X = Xi (i.e., at node i). Thus the second
property is verified.
Finallv. note that
Xi
-
X
X
-
X,
N, + Ni =
+
Xi
-
X,
Xi
-
X,
Xi
-
X + X
-
Xi =1
for all x. Actually, because the shape functions apply to an element that connects
node i at X =
Xi to node j at X =
Xi' we should say that the above condition strictly
holds for Xi ~ X ~ Xi (assuming Xi is less than Xi). Thus the third and final property
is verified.
•
Throughout this text, the shape function matrix is referred to quite often. B:
gaining an appreciation of where the shape functions themselves come from, it is
hoped that the development in the next section will be more readily understood.
The next section picks up where we left off with Eq. (5-46), which will now be

THE FINITE ELEMENT CHARACTERISTICS
213
the starting point for the derivation of the finite element characteristics for all
problems in static stress analysis. The reader may find it helpful to reread Sec.
5-2, with special attention given to the definitions of (1, E, (10' Ell> and L.
5-7
THE FINITE ELEMENT CHARACTERISTICS
We are now in a position to formulate the finite element characteristics for all
problems in static, linear stress analysis. Equation (5-46) provides the starting point
and is restated here for convenience:
f v" (oEl(1 dV = f v- (oulb dV + f 5' (ouls dS + 2: (Oun"
(5-46)
Recall that this equation was derived in two seemingly different, but completely
equivalent, ways: first from the principle of minimum total potential energy and
then from the principle of virtual displacements. In what follows, the symbol OU
may represent either the variation on the displacements or the virtual displacements,
depending on the reader's preference. Similar comments apply to OE and oa".
Let us begin by relating the strain vector E to the vector of nodal unknowns
a" (i.e., the nodal displacements) by using Eqs. (5-16) and (5-60) [or (5-71)], or
E = Lu = LNa"
(5-75)
Let us refer to the matrix LN as the strain-nodal displacement matrix and denote
it by B, or
B = LN
Therefore, Eq. (5-75) may be written as
E = Ba"
(5-76)
(5-77)
Recall from Sec. 5-2 that L is a linear operator matrix that contains first derivatives
with respect to only x and y in problems requiring only CO-continuity. If the shape
function matrix N contains only linear functions (in x and y) such as those in Sec.
5-6, then the matrix B contains only constants. In any event, B does not contain
any of the nodal displacements, which implies that
and
OE = o(8a") = Boa"
(5-78)
(5-79)
Again depending on the reader's preference, oa" may denote either the variation
in the nodal displacements or the virtual nodal displacements. Similarly, we have
and
ou = o(Na") = N oa"
(5-801
(OU)T = (N oa'Y
(5-81)

214
GENERAL APPROACH TO STRUCTURAL ANALYSIS
Substituting the results from Eqs. (5-79) and (5-81) into Eq. (5-46), after transposing
all the terms to the left-hand side and pulling the (oa'f through the integrals and
the summation, yields
(oa'1 {Jv- B T (1 dV - Iv' Wb dV - Is' Ws dS - 2: Wf,,} = 0
(5-82)
But the term in braces must be zero because (oa'f is not necessarily zero and is
quite arbitrary. If the principle of minimum potential energy path is followed, then
oa' represents the first variation of nodal displacements. This variation is quite
arbitrary, and so the term in braces must be zero. If the principle of virtual dis-
placements is the basis for Eq. (5-46), then oa' is arbitrary because it represents
arbitrary virtual displacements. Actually, if the statements of these principles from
Sees. 5-3 and 5-4 are read carefully, the variations in the displacements and the
virtual displacements are not completely arbitrary because they must satisfy the
prescribed displacement boundary conditions. In any event, oa' is nonzero, in
general, and again it is concluded that the term in braces is zero, or
(5-83)
Equation (5-83) is still quite general because a constitutive relationship has not
yet been invoked. However, let us now consider only linear elastic materials for
which the constitutive (or stress-strain) relationship from Sec. 5-2 applies, or
(1 = D(E -
Eo) + (10
(5-24)
where the material property matrix D contains pertinent material properties such as
the elastic modulus and Poisson's ratio. Specific examples of this matrix as well
as the self-strain vector Eo and the prestress vector (10 are presented in Sec. 5-8
and Chapter 7. With the help of Eqs. (5-77) and (5-24), we may write Eq. (5-83)
as
{Jv- BTDB dV} a' - I v- BTDEo dV + I v' BT (10 dV
- Iv« NTb dV - Is' NTs dS - 2: Wf" = 0
(5-84)
Note how the vector a'> was pulled out of the integral (to the right) because it is
not a function of the spacial coordinates. Finally we get an equation of the form
where
f' =
~o -
t;,.o + fb +
f~ + f'pL
and where we define the element stiffness matrix K' by
K' = I v- BTDB dV
and the five element nodal force vectors by
f~o = I v' BTDEo dV
t;,.o = I v- BT(10 dV
(5-85)
(5-86)
(5-87)
(5-88)
(5-89)

APPLICATION:. TAPERED UNIAXIAL STRESS NUMBER
215
and
Ive NTb dV
IseNTsdS
(5-90)
(5-91)
(5-92)
For the uniaxial stress member, discretized with the two-node lineal element,
the matrix B is of size I X 2 because L is a scalar and N is I x 2 (recall that
B = LN). The matrix D is actually a scalar (or a I x
I matrix). The element
stiffness matrix K" is of size 2 x 2 as expected, since there are only two nodes
on each element and each node has only one degree of freedom. In a similar fashion,
it may be shown that each of the five nodal force vectors is of size 2 x
I (see
Problem 5-24).
Similarly, for problems in two-dimensional stress analysis, analyzed with the
three-node triangular element, the matrix B is of size 3 x 6 because L is 3 x 2
and N is 2 x 6. The matrix D is of size 3 x 3. The element stiffness matrix K"
is 6 x 6 as expected, because there are three nodes per element and each node
has two degrees of freedom. Not surprisingly, each of the nodal force vectors must
be of size 6 x
I (see Problem 5-25).
Finally, for three-dimensional problems in stress analysis analyzed with the
four-node tetrahedral element, it can be determined (see Problem 5-26) that K" and
f" are of sizes 12 x 12 and 12 x
I, respectively.
In the next section these rather abstract notions are illustrated with a problem
in one-dimensional stress analysis.
5-8
APPLICATION: TAPERED UNIAXIAL STRESS MEMBER
In this section the general expressions for the finite element characteristics given
by Eqs. (5-87) to (5-92) are applied to a simple stress analysis problem-a tapered
uniaxial stress member analyzed with the two-node lineal element. First the for-
mulation is given for a general problem in this class and then it is illustrated
numerically in an example for a specific problem.
Consider the tapered uniaxial stress member shown in Fig. 5-14(a). Note that
the conditions on the ends of the member are quite arbitrary. In other words, the
ends of the member may both be restrained (prescribed displacements), both loaded
(via surface tractions and/or point loads), or a combination of both.
The member is discretized into a number of two-node lineal elements as shown
in Fig. 5-14(b) with node i (at x = Xi) and nodej (at x = xi). Note that a node is
associated with a planar surface and not a single point. The nodal displacement u,
occurs at x = Xi' while the nodal displacement uj occurs at x = xi.
A typical element e is shown in Fig. 5-14(c) with point loads j, andjj and/or
surface tractions s, and si acting at the nodes and with a body force b =
"y as a
result of gravity, where "y is the weight density of the material. In addition, this

216
GENERAL APPROACH TO STRUCTURAL ANALYSIS
End restrained
or loaded
o
f i
T
1
x
i
xi
e
x
Xj
j
'---'
,....
....",
.......
./
If
l
lh
If
2
End restrained
or loaded
fa)
(b)
(e)
Figure 5-14
General one-dimensional stress problem: (a) uniaxial stress member. (0)
discretized intoseveral two-node lineal clements. and(c) typical clement with positive point
loads and tractions shownon nodal planes.
element is assumed to undergo a temperature change /iT and to be prestressed to
a stress of Un.
The Element Characteristics
From Eq. (5-50), the shape function matrix N is of size I x 2 where the shape
functions Nj(x) and N/x) are given by Eqs. (5-74) and N itself by
x ~ Xi]
X,
Xi
(5-931
(5-941
But the strain-nodal displacement matrix 8 is related to N through the linear operator
matrix L by 8 = LN, where L = dldx. This follows from the fact that the strain-
displacement relationship for this class of problems is given by E = dutdx and from
the definition of L. namely. E = Lu. Therefore.
dN
[-I
I]
8--- --
--
dx
Xi
-
Xi
Xi
-
Xi

APPLICATION: TAPERED UNIAXIAL STRESS NUMBER
217
The material property matrix D is really a scalar here as explained below. The
stress-strain relationship for the state of uniaxial stress is given by
<T = E(E -
Eo) + (To
(5-95)
Comparing Eqs. (5-95) and (5-24) yields D = E. Note that each term in Eq. (5-
95) is a scalar. This constitutive relationship is a somewhat more general form of
Hooke's law (<T = EE) because it includes the possibilities of both self-strains EO
(e.g., as a result of a temperature change) and prestresses <To. The self-strain EO is
related to the temperature change t:.T by
(5-96)
where a, is the coefficient of thermal expansion, in units of inches per inch per
degree Fahrenheit (in./in.-OF) or meters per meter per degree Celsius (m/m-T').
We are now in a position to evaluate the element stiffness matrix K" by
beginning with Eq. (5-87) and writing
x- = f ve BTDB dV
1
= :sr[-:] E [ - I
I] A(x) dx
(5-97)
where dV = A(x) dx has been used and A is the cross-sectional area of the element
at a specified value of x. The notation Xii is used to represent xi -
Xi in a more
concise manner and really represents the element length. If the constants in the
integral are pulled through the integration, we get
(5-98)
One of the simplest ways to evaluate the remaining integral is to evaluate the area
at X = X, where
Xi + Xi
2
denote it as A, and treat A as a constant to get
Ke = A.E [
I
Xii
-I -I] = AE [ I
I
xii-I -:]
(5-99)
The bar C) on the area A is dropped with the understanding that if the cross-
sectional area varies with x, a constant value may be used that corresponds to the
value at X = x. Equation (5-99) provides an expression for the element stiffness
matrix for the uniaxial stress member. Next we turn to the nodal force vectors.

(5-100)
(5-102)
218
GENERAL APPROACH TO STRUCTURAL ANALYSIS
Let us first determine the element nodal force vector as a result of the self-
strain that happens to be caused by a temperature change tiT. With the help of
Eqs, (5-94), (5-96), and D = E, it can be shown from Eq, (5-88) that
f~o = f v- BTDEo dV
= ~r[-~] s«,st A dx
xji
x,
= AEa, sr [ - ~]
In Eq. (5-100) it is assumed that
0. , and tiT are constant in anyone element. If
they vary as a function of x, they may simply be evaluated at x = x and treated
as constants in anyone element. In a similar fashion, it can be shown that (see
Problems 5-27 and 5-28)
t;',.o = f v- BT(10 dV = <ToA [ -
~ ]
(5-101)
and
fh'
= f v- Wb dV =
)'~r/j [:]
where again <Toand)' are assumed to be constant in the element, or suitable average
values (i.e., evaluated at x =
x) are used. The nodal force vector as a result of
the surface tractions s, and s, may be determined from Eq. (5-91) as follows:
f/
fyNTsdS
N{(xj ) fA, s, dA + NT(xj) f A,si ciA
s,A, [~] + s,A, [~]
[~;1;]
(5-103)
where A j and Aj are the cross-sectional areas at nodes i and), respectively. Finally,
the nodal force vectorfPL as a result of the point loads at nodes i andj is determined
from Eq. (5-92) to be
fpL = L Wfp = W(x,)1; + W(x)fj
= I; [~] + fj [~] - [1]
(5-104)
Note that if a point load 1" is imposed within the element, e.g., at .r = x," then
fpl. is evaluated as follows:
fPL = W (X',),~' + [1]
For example, if x" = x, then half of1" is allocated to node i and half to node .i
(see Problem 5-29).

APPLICATION: TAPERED UNIAXIAL STRESS NUMBER
219
This completes the evaluation of the element characteristics for the two-node
lineal element in one-dimensional stress analysis. It should be emphasized that s.,
s;,};, andjj, are positive if directed in the positive direction.
The Element Resultants
The element stiffness matrices and nodal force vectors may be determined for every
element with the help of Eqs. (5-99) to (5-104). The assemblage of each of these
2 x 2 matrices and 2 x
I vectors is performed in the usual manner to give a
system of N linear algebraic equations in N unknown nodal displacements assuming
the member is discretized into N -
I elements with N nodes. The result is Kva = f".
The geometric (or prescribed displacement) boundary conditions are applied at this
point to yield Ka = f', which may be solved for the nodal displacements contained
in the vector a. Therefore, in what follows it is assumed that all the nodal dis-
placements are now known. Each element nodal displacement vector a" is also
assumed to be known.
The element strains and stresses may be computed from Eq. (5-77) as
E = Ba"
and from Eq. (5-24) [or Eq. (5-95)1 as
0' = ElBac
-
CI.{ ~TI + (To
(5-105)
(5-106)
Note that the axial strain and stress within the element are denoted as E and 0',
respectively, where the bars C) imply average strain and average stress. The
strains and stresses within an element are not necessarily constant. However, Eqs.
(5-105) and (5-106) can only result in one strain and one stress for each element
(both constant and not a function of x) because B is a constant matrix in this case.
Therefore, the strain E and stress iT are generally assumed to be the local values of
EO and (T a.!....:!. = x. It follows that the average force F within an element is given
by F
= (TA.
The use of the equations developed in this section is illustrated numerically in
the next example.
Example 5-5
Determine the displacements, strains, and stresses within the tapered circular, uni-
axial stress member loaded as shown in Fig. 5-15(a), which also shows the di-
mensions of the rod. The rod is fabricated from carbon steel with a modulus of
elasticity of 30 x
106 psi (21 x
1010 Nzm").
Solution
The first step in any finite element analysis is discretization of the region under
consideration into a suitable number of finite elements. For the purpose of illustrating
the basic approach, let us take only two elements and three nodes as shown in Fig.
5-15(b). It is convenient to summarize the node and element data in a tabular form

220
GENERAL APPROACH TO STRUCTURAL ANALYSIS
("'
a
.r
D, = 1.0 in.
D2 = 0.5 in.
L. = 11. in.
F
= 3000 Ibf
s
= 10.100 Ibf/in2
CD
rn
o
Global node numbers
o
Global element numbers
(b)
Figure 5-15
Uniaxial stress member in Example 5-5. (a) Dimensions and loads and (b)
discretization into two elements and three nodes.
as shown in Table 5-1. Note that the radius of the rod is supplied as part of the
node data. In a computer program, it is somewhat more expedient to include the
cross-sectional area in the material property data. This was in fact done in the
TRUSS program. The variable area could be taken into account with the help of a
variable property routine (see Problem 5-39).
Table 5-1
Node and Element Data for Example 5-5
Node
number
.r, in.
r, in.
I
0.0
0.500
2
6.0
0.375
3
12.0
0.250
Element
Node
Node
-:
j
number
I
I
2
2
2
3

APPLICATION: TAPERED UNIAXIAL STRESS NUMBER
221
The radius of the bar at x = x is denoted as r and is easily computed from
r =
~ [D1L b
-
(D, - D2)X]
2
t,
where D, is the diameter of the rod at the base, D2 is the diameter at the tip, and
L" is the length of the bar.
The calculations are summarized below in a form that may be readily imple-
mented in a computer program.
Element 1
Node i is I.
Node j is 2.
Xi = 0.0 in.
Xi = 6.0 in.
6 -
0 = 6.0 in.
E = 30 x 106 psi
Xi + Xi
0 + 6
x =
= 3.0 in.
2
2
r
~ [1.0 -
(1.0 -12~;)(3.0)]
= 0.4375 in.
A = Try2 = (3.14)(0.4375)2 = 0.601 in.?
-:]
K"
fll)
f"
Element 2
(0.601 )(30 x 10
6
)l
I
6.0
- 1
l
3007
- 3007]
l'
_ 3007
3007
x 10 lbf/in.
[
3007
- 3007
0]
- 3007
3007
0
x
103 lbf/in.
000
l~] Ibf
m'bf
Node i is 2.
Node j is 3.
Xi
6.0 in.
Xi =
12.0 in.
Xji
12.0 -
6.0 = 6.0 in.

222
GENERAL APPROACH TO STRUCTURAL ANALYSIS
E = 30 X
)06 psi
6 + 12
X = --- = 9.0 in.
2
r = ~ [1.0 _ (1.0 -
0.5)(9.0)]
2
2
12.0
= 0.31 5 in.
A = (3.14)(0.3125)2 = 0.307 in.?
A3 = 7T(0.25)2 = 0.196 in.?
103 Ibflin.
-:]
K(21 = (0.307)(30
X
)06) [
I
6.0
-I
[
1534
-1534] x )03Ibf/in.
- 1534
1534
[
3007
-3007
K" =
-3007
4541
o
- 1534
Before the application of the prescribed displacement we have K"a = f", or
-3007
4541
-1534
where both sides have been divided by )03. Note that the assemblage stiffness
matrix is symmetric and banded, with a half-bandwidth of two [this also follows
from Eq. (3-33)]. If the prescribed displacement boundary condition is applied by
using Method I from Sec. 3-2, we get
[~
o
4541
- 1534
Solving this system of linear, algebraic equations (e.g., by the matrix inversion
method) yields the following nodal displacements:
UI
= 0.0 in.
U2 = 0.00166 in.
U3 = 0.00492 in.

APPLICATION: TAPERED UNIAXIAL STRESS NUMBER
223
The element resultants are now easily determined as summarized below:
Element 1
8320 psi
I) in.-)
B= [-1
_1_]
=
Y6 [ _I
6-0
6-0
Ba
l
)
=
Y6[ -I
I) [0.OgI66]
0.0002772 in.zin.
0'
E(e -
#,0) + 10 = (30 x 106)(0.0002772)
F = O'A = (8320)(0.601) = 5OO0lbf
Element 2
•
[
-1
12 -
6
B
__1_] = Yd-I
I) in.-)
12 -
6
Bam =
Y6[ -I
I) [0.00166]
0.00492
0.0005433 in./in.
(I
Ee = (30 x 106)(0.0005433) = 16,300 psi
F = O'A = (16,300)(0.307) = 5000 Ibf
A few subtle points regarding the calculation of the element nodal force vectors
in Example 5-5 need to be discussed. The reader may observe that on an individual
element there are surface tractions (or point loads) acting at the nodes as a result
of the forces exerted by the adjacent elements or by the restrained end. For example,
let us consider a bar discretized into three elements as shown in Fig. 5-16. It should
be apparent that the internal surface tractions and/or point loads cancel during the
assemblage step. Moreover, if a node is restrained (e.g., node I), then there is in
effect an unknown force at this node. The reader should be convinced, however,
that this unknown force never really enters into the formulation because of the
application of the prescribed displacement at this node. This same observation was
made in Chapter 3 where the two-dimensional truss model was developed (and in
Chapter 4 where the pin fin was modeled). The second point to be made is that
the stress distribution near the point of application of point loads (and nonuniform
surface tractions) is never attained in a one-dimensional formulation, no matter how
many elements are used. Predicting such stress distributions requires at least a two-
dimensional analysis (see Chapter 7).
The results from Example 5-5 are compared to the exact solution (see Problem
5-37) in Table 5-2, where the finite element solutions for four and eight elements
are also given. These FEM results were obtained by the computer program described
in Problem 5-39. Stresses are reported with five significant digits in order to show

224
GENERAL APPROACH TO STRUCTURAL ANALYSIS
Internal point
forces cancel
Internal point
forces cancel
Internal surface
tractions cancel
(a)
~L...L..L-I\
lnternal surface
tractions caller!
...-r........T"""l/
r-r-r....,.....-r-r-r--'l /
-s2
......................I-J.....L...j
~l
0T
Figure 5-16
Graphical explanation of the cancellation of (a) internal surface tractions and
(b) internal point forces that occurs during the assemblage step.
the remarkable accuracy of the results. The nodal displacements in Table 5-2
demonstrate convergence to the exact solution as the number of elements is in-
creased-here the maximum error decreases from - 3.3% for two elements to less
than - 0.3% for eight elements.
A detailed discussion of error predictions and convergence is beyond the scope
of this text. The interested reader may find introductory material on this important
subject in the book by Becker, Carey, and Oden [10].

REMARKS
225
Table 5-2
Summary of Results for Example 5-5
Displacements, in.
x
Exact
Two Elements
Four Elements
Eight Elements
0.0
0.0
0.0
0.0
0.0
1.5
0.000340
0.000339
3.0
0.000728
0.000724
0.000727
4.5
0.00118
0.00117
6.0
0.00170
0.00166
0.00169
0.00170
7.5
0.00231
0.00231
9.0
0.00306
0.00304
0.00305
10.0
0.00396
0.00395
12.0
0.00509
0.00492
0.00505
0.00508
Stresses, psi
x
Exact
Two Elements
Four Elements
Eight Elements
0.75
6,784
6,784
1.50
7,243
7,243
2.25
7,752
7,752
3.00
8,315
8,315
3.75
8,942
8,942
4.50
9,644
9,644
5.25
10,430
10,430
6.00
IUl8
6.75
12,323
12,323
7.50
13,469
13,469
8.25
14,782
14,782
9.00
16,298
16,297
9.75
18,058
18,058
10.50
20,120
20,120
11.25
22,557
22,557
5-9
REMARKS
This chapter began with a review of some of the more important topics from the
theory of elasticity and solid mechanics. Following this, the principles of minimum
potential energy and virtual displacements were developed into forms that were
directly useful in finite element formulations of stress or structural analysis prob-
lems. These two principles were seen to be equivalent, and both yielded the stiffness-
based finite element method (wherein the primary unknowns are the nodal dis-
placements and not the nodal forces). Moreover, both resulted in a weak form of
the equilibrium equations in that at most only first derivatives of the displacements
appear in the equations (after the generalized form of Hooke's law is applied). The
implication is that lower-order displacement functions may be used in the finite

226
GENERAL APPROACH TO STRUCTURAL ANALYSIS
clement solution. For example, first-order displacement functions were used throughout
this chapter, whereas the equilibrium equations would require at least second-order
functions. In the stiffness-based finite element method, the compatibility equations
are satisfied exactly by these displacement functions (see Problems 5-49 and 5-50).
The shape function matrix was introduced for the three-node triangular and
four-node tetrahedral elements. Although the shape functions themselves were not
derived in this chapter, the basic properties that these functions must satisfy for
problems requiring only CO-continuity were presented. In the next chapter, explicit
expressions for these shape functions will be derived.
Following this, the finite element characteristics were derived for all problems
in linear, static stress or structural analysis. It should be recalled that by finite
element characteristics we mean expressions for the element stiffness matrix K"
and the element nodal force vectors f". These expressions are given by Eq. (5-87)
and Eqs. (5-88) to (5-92), respectively. Their importance cannot be overemphasized
because they may be used to formulate all problems in linear, static stress analysis.
The general approach was illustrated with the simple application of a uniaxial
stress member. Admittedly, this example is of little practical importance, but it
should help to clarify some of the concepts developed in this chapter. When applied
to a numerical example, convergence to the exact solution was demonstrated as the
number of elements was increased. The stresses from the finite element solution
also compared very favorably with those from the exact solution.
Chapter 6 is devoted to the derivations of the shape functions that we will need
in our study of two- and three-dimensional stress analysis in Chapter 7. It will be
seen in Chapter 8 that these same shape functions may be used in one-, two-, and
three-dimensional thermal analysis and fluid mechanics. Indeed, they also may be
used in the analysis of problems in lubrication, electrornagnetics, etc. Ill).
REFERENCES
I. Huebner, K. H.. The Finite Element Method for Engineers, Wiley, New York. 1975,
pp. 457-462.
2. Fitzgerald, R. W., Strength ofMaterials, Addison-Wesley, Reading, Mass.. 1967.
3. Timoshenko, 5., and D. H. Young, Elements of Strength of Materials, 5th cd., Van
Nostrand, New York, 1968.
4. Popov, E. P., Introduction to Mechanics of Solids, Prentice-Hall, Englewood Cliffs,
N.J., 1968.
5. Popov, E. P., Introduction to Mechanics of Solids, Prentice-Hall, Englewood Cliffs,
N.J., 1968, pp. 308-309.
6. Zienkiewicz , O. C., The Finite Element Method, McGraw-Hili (UK), London, 1977,
p. 28.
7. Love, A. E. H., A Treatise on the Mathematical Theory of Elasticity, Dover, New
York, 1944.
8. Sokolnikoff. I. 5., Mathematical Theory of Elasticity, 2nd ed., McGraw-Hili, New
York, 1956.

PROBLEMS
227
9. Ugural, A. C., and S. K. Fenster, Advanced Strength and Applied Elasticity, American
Elsevier, New York, 1975, pp. 315-316.
10. Becker, E. B., G. F. Carey, and J. T. aden, Finite Elements: An Introduction, vol. I,
Prentice-Hall, Englewood Cliffs, N.J., 1981, pp. 36-38.
II. Zienkiewicz, O. c., The Finite Element Method, McGraw-Hill (UK), London, 1977,
pp. 423-449.
PROBLEMS
Note:
The properties in Appendix A should be used unless stated otherwise in the problem
statement.
5-1
With the help of Fig. 5-4, show that the equations of static equilibrium in two
dimensions are given by Eq. (5-4) by doing force balances in the x and y directions.
Show that Eq. (5-5) holds by doing a moment balance about the center of the
infinitesimal element.
5-2
f Derive the three-dimensional form of the equilibrium equations given by Eqs. (5-6).
Show that Eq. (5-7) holds by doing a moment balance about the center of an infin-
itesimal cubic element.
5-3
Consider the two-dimensional state of stress shown in Fig. P5-3.
y
x
Figure P5-3
a.
Plot Mohr's circle of stress.
b. Determine the principal stresses and show the corresponding element orientation.
c. Determine the maximum shear stress and the associated normal stress and element
orientation.
d.
Use Eqs. (5-9) to (5-11) to corroborate the results from Mohr's circle.
5-4
Consider the two-dimensional state of stress shown in Fig. P5-4.
a.
Plot Mohr's circle of stress.
b. Determine the principal stresses and show the corresponding element orientation.
c. Determine the maximum shear stress and the associated normal stress and element
orientation.
d. Use Eqs. (5-9) to (5-11) to corroborate the results from Mohr's circle.

228
GENERAL APPROACH TO STRUCTURAL ANALYSIS
y
Figure P5·4
5-5
Consider the two-dimensional state of stress shown in Fig. P5-5.
a. Plot Mohr's circle of stress.
b. Determine the principal stresses and show the corresponding element orientation.
c. Determine the maximum shear stress and the associated normal stress and element
orientation.
d. With help of Eqs. (5-12), verify the principal stresses from part (b). Assume that
0'", 0'", and 0'" are zero. What is the value of the third principal stress in this
case'?
.r:
JDF5000rSI
I
2000rsi
T
Figure P5·5
5-6
Consider the two-dimensional state of stress shown in Fig. P5-6.
a. Plot Mohr's circle of stress.
b. Determine the principal stresses and show the corresponding clement orientation.
c. Determine the maximum shear stress and the associated normal stress and clement
orientation.
d. With help of Eqs. (5-12), verify the principal stresses from part (b). Assume that
0'", 0'", and 0'" are zero. What is the value of the third principal stress in this
case'?

PROBLEMS
229
--I::lcm
2rr
I
SOOOn/cm
2
I
x
Figure P5·6
5-7
In Chapter 7, the state of plane stress is defined as that state of stress such that the
stresses lTx"
lTv" and IT,, are identically zero (see Sec. 7-2).
a. What can you conclude about one of the principal stresses? Hint: Equations
(5-12) must be used.
b. Derive Eq. (5-10) by beginning with Eqs. (5-12) and using the fact that lTx"
lTY"
and IT,, are zero.
5-8
What are the four strain-displacement or kinematic relationships for small defor-
mations in axisymmetric problems? It is not necessary to derive them. Instead, use
a suitable reference.
5-9
What is the linear operator matrix L in three-dimensional stress analysis? The matrix
L is defined by E = Lu, where
E and u are given by Eqs. (5-20) and (5-21),
respectively.
5-10
Show that the compatibility equation in two dimensions is given by Eq. (5-22).
5-11
By using a suitable reference, state the six compatibility equations that must hold in
three dimensions. Why are there six relationships?
5-12
A portion of the boundary of a two-dimensional body to be analyzed is shown in
Fig. P5-l2. On this boundary, a uniform surface traction acts as shown.
y
Portion of a
two-dimensional
body
Figure P5-12
3000 N/cm 2
Uniform surface
traction acting
on the global
boundary

230
GENERAL APPROACH TO STRUCTURAL ANALYSIS
a. Determine Sx and Sy on this surface.
b. Suggest an application that could result in this type of surface traction.
5-13
Part of the boundary of a two-dimensional body to be analyzed is shown in Fig.
P5-13. On this boundary, a uniform surface traction acts as shown.
a. Determine Sx and s,. on this surface.
b. Suggest an application that could result in this type of surface traction.
5001bf/in. 2
Figure P5-13
Uniform surface
traction acting
on the global
boundary
x
5-14
Part of the boundary of a two-dimensional body to be analyzed is shown in Fig.
P5-14. On this boundary, a uniform surface traction acts as shown.
a. Determine Sx and SI' on this surface.
b. Suggest an application that could result in this type of surface traction.
y
Uniform surface traction
acting on the global boundary
7501bf/in.2
Portion of a
two-dimensional
body
x
Figure P5-14
5-15
A portion of the boundary of a two-dimensional body to be analyzed is shown in
Fig. P5-15. On this boundary, a uniform surface traction acts as shown.

PROBLEMS
231
y
2000 N/cm 2
Uniform surface traction
acting on the global boundary
x
Figure P5-15
a. Determine s, and s,. on this surface.
b. Suggest an application that could result in this type of surface traction.
5-16
A portion of the boundary of a two-dimensional body to be analyzed is shown in
Fig. P5-l6. On this boundary, a uniform surface traction acts as shown.
y
Uniform
Surface
traction acting
on a portion of
the global boundary
x
Figure P5-16
a. Determine s, and s" on this surface.
b. Suggest an application that could result in this type of surface traction.
5-17
Part of the boundary of a two-dimensional body to be analyzed is shown in Fig.
P5-l7. On this boundary, a uniform surface traction acts as shown.
a. Determine Sx and s, on this surface.
b. Suggest an application that could result in this type of surface traction.

232
GENERAL APPROACH TO STRUCTURAL ANALYSIS
y
Uniform surface trac~on
acting on the global
boundary of the body
Figure P5-17
5-18
Starting with Eq. (5-40) and using the constitutive relationship for a linear elastic
material, show that Eq. (5-41) holds.
5-19
Show that the total potential energy of a structural system in static equilibrium is
given by Eq. (5-42). given that the first variation oIl is given by Eq. (5-32) and that
Eqs. (5-34b) and (5-35b) hold.
5-20
Reconsider Example 5-2 and show that potential energy II has indeed been minimized
by computing d 2J1id.l'. Hint: What is the significance of the sign of this result'
5-21
Show the two shape functions graphically for the two-node lineal element for ('''-
continuity given that they are linear and must satisfy Eq. (5-52). Clearly label each
of the shape functions.
5-22
For the three-node triangular element. show the shape functions N/x.r) and N,(\,r)
in a manner similar to that in Fig. 5-13.
5-23
Derive Eq. (5-84) from Eq. (5-83) with the help of Eqs. (5-77) and (5-24),
5-24
Clearly show why each of the clement nodal force vectors given by Eqs. (5-88) to
(5-92) is of size 2 x
I for the two-node lineal clement.
5-25
Show why each of the element nodal force vectors given by Eqs. (5-88) to (5-92) is
of size 6 x
I for the three-node triangular clement. In two-dimensional problems in
stress analysis, how many degrees of freedom are there per node"! What do the degrees
of freedom represent?
5-26
For three-dimensional problems in stress analysis analyzed with the four-node tetra-
hedral element, show that the clement stiffness matrix and nodal force vectors given
by Eq. (5-87) and Eqs. (5-88) to (5-92) are of sizes 12 x
12 and 12 x
I. respec-
tively. In three-dimensional problems in stress analysis, how many degrees of freedom
are there per node? What do the degrees of freedom represent'>
5-27
Show that the element nodal force vector from a prestress in a uniaxial stress member
is given by the result in Eq, (5-101) if the two-node lineal element is used. What
assumptions have to be made in arriving at this result"!

PROBLEMS
233
5·28
Show that the element nodal force vector from a body force in a uniaxial stress
member is given by the result in Eq. (5-102) if the two-node lineal element is used.
What assumptions have to be made in arriving at this result?
5·29
Consider the one-dimensional element shown in Fig. P5-29. This element has been
extracted from a discretized brass bar in a state of uniaxial stress. The bar has a
circular cross section with a constant diameter D and undergoes a temperature change
11T. A load P is applied as shown at point p, A surface traction s also acts as shown.
If Xi = 2 ern, Xj = 5 ern, xp = 3.5 ern, D = I ern, I1T = + 15°C, P = 1300 N,
and s = 3000 Nzcm":
r-.................,-x,
Figure P5·29
a. Determine the element stiffness matrix.
b. Determine the relevant element nodal force vectors. The weight may be neglected.
c. Determine the composite element nodal force vector.
5-30
SolveallpartsofProblem5-29ifx, = 2 in.,x; = 5 in.,xp = 3.5 in.,D = 0.5 in.,
I1T = + 10°F, P = 1500 lbf, and s = 1800 lbf/in.".
5-31
Consider the one-dimensional element shown in Fig. P5-31. This element has been
extracted from a discretized bar and is in a state of uniaxial stress. The bar is made
of hard drawn copper and has a rectangular cross section with dimensions wand h.
Two point loads PI and P2 are applied as shown. A surface traction s also acts as
shown. The bar undergoes a temperature change 11T and is initially under a prestress
ao. If Xi = 3 in.,
Xj = 5 in., xp = 4.5 in., w = 0.75 in., h = 0.60 in., I1T =
-20°F, PI = 1000 lbf, P2 = 200 lbf, s = 600 lbf/in.", and au = -400 lbf/in.":
,.......................,-x,
Figure P5·31

234
GENERAL APPROACH TO STRUCTURAL ANAL YSIS
a. Determine the element stiffness matrix.
b. Determine the relevant element nodal force vectors. The weight may beneglected.
c. Determine the composite element nodal force vector.
5-32
Solve all parts of Problem 5-31 ifr, = I ern. xi = 3 ern, xI' = 2.5 ern, W = 1.5 ern,
I h = 1.0cm,.iT = -25°C. PI = 5OON.P, = looN.s = 6ooN/cm2,andu
il =
-350 Nzcm-.
5-33
Consider the one-dimensional element shown in Fig. P5-33. This element has been
extracted from a discretized circular bar and is in a state of uniaxial stress. The bar
is made of aluminum alloy 6061 and is tapered such that at nodes i and} the diameters
of the bar are D, and DI • respectively. Two point loads PI and P, are applied as
shown. A surface traction s also acts as shown. The bar undergoes a temperature
change .iT and is initially under a prestress uo. If .r, = 23 ern, XI = 20 cm . .\1'
=
22 cm, D, = 2.0 em, D, =
1.50 ern, :J.T = -30°C. PI = 400 N. P2 = 150 N.
s =
200 Nzcm', and U ll
=
+ 400 Nrcm'.
Figure P5-33
a. Determine the element stiffness matrix.
b. Determine the relevant element nodal force vectors. The weight may be neglected.
c. Determine the composite clement nodal force vector.
5-34
Solve all parts of Problem 5-33 if .r, = !O in.. x, = 7 in.. XI' = 9 in.. D, = 0.75 in..
D,
0.50 in.. .iT = -40°F. PI = 500 lbf, P, = 200 lbf', s =
800 lbf/in.:'. and
U u =
+700Ibf/in.'.
5-35
Consider the uniaxial stress member shown in Fig. P5-35.
a. Solve for the displacements and the clement resultants for D I
I ern, {),
=
0.75 ern, L" = 6 ern, F = 1500 N. and.\ = 5000 Nzcm-. Take E = 21 X
!O11l
Nzrn", Use only two elements.
b. Compare the results from part (a) with the exact solution given in Problem 5-37.

PROBLEMS
235
Tapered
circular
bar
Figure P5-35
5-36
Solve both parts of Problem 5-35 if D 1 = 0.75 in., D2 = 0.25 in., Lb
s = -8000 lbf/in.", E =
II
x
I06Ibf/in. 2, and F =
1500 Ibf.
5 in.,
5·37
Show that the exact solution for the displacement to the problem posed in Example
5-5 is given by
where P is the sum of the point load and the force from the surface traction acting
on the tip of the rod.
5·38
The exact solution for the displacement at the tip of an untapered uniaxial stress
member is given by u = FLhIAE, where F is the axial force, L" is the length of the
member. A is the cross-sectional area (assumed to be constant). and E is the elastic
modulus. Show that the exact solution for the displacements in a tapered uniaxial
stress member gives this same result if D 1 approaches D 2• The exact solution is given
in Problem 5-37.
5·39
Convert the TRUSS program in Appendix B into one that may be used to solve
problems in one-dimensional stress analysis. The program should allow for self-
strains (from a temperature change). prestresses. body forces. surface tractions. and
point loads. Assume no more than 30 elements (and 31 nodes). The following pa-
rameters should be taken as the material properties: E, A, o.. I1T. <To. and b. Allow
up to five different types of materials and make use of material set flags. Allow for
two different prescribed displacements (using positive boundary condition flags) and

236
GENERAL APPROACH TO STRUCTURAL ANALYSIS
up to five different tractions (using negative boundary condition flags). such as the
scheme used in the TRUSS program. Allow for point loads by specifying the node
number that corresponds to the location of the load. Also specify on the same input
line the magnitude of the point load (positive in the positive x direction). Use the
variable property subroutine VPROP and subroutine PROPTY. both given below. to
allow for spacially varying properties.
SUBROUTINE PROPTY (L,
MATFLG, DATMAT,
ELMOD,
1
AREA,
ALPHA,
DELTAT,
SIGMAO,
BODYF)
C
C
DEFINES THE ELASTIC MODULUS,
CROSS-SECTIONAL AREA,
C
COEFFICIENT OF THERMAL EXPANSION,
TEMPERATURE CHANGE,
C
PRESTRESS,
AND
BODY FORCE
(PER UNIT VOLUME).
DIMENSION MATFLG(3D), DATMAT(5,6)
NFLAG
=
MATFLG(L)
C
ELMOD
DATMAT(NFLAG,
1)
IF
(ELMOD
.LT.
D.)
CALL VPROP
(ELMOD)
C
C
AREA
IF
(AREA
=
DATMAT(NFLAG,
2)
.LT.
D.)
CALL VPROP
(AREA)
C
C
C
C
ALPHA
DATMAT(NFLAG,
3)
IF
(ALPHA
.LT.
D.)
CALL VPROP
(ALPHA)
DELTAT
DATMAT(NFLAG,~)
IF
(DELTAT
.LT.
D.)
CALL VPROP
(DELTAT)
SIGMAO
=
DATMAT(NFLAG,
5)
IF
(SIGMAO
.LT. 0.)
CALL VPROP
(SIGMAO)
BODYF
DATMAT(NFLAG,
6)
IF
(BODYF .LT. 0.)
CALL
VPROP
(BODYF)
RETURN
END
SUBROUTINE
VPROP
(PROP)
COMMON
ICONSTI C(10)
COMMON
IVPROPSI X
C
C
THE C(I)'S
ARE TEN USER-DEFINED CONSTANTS
READ IN
C
THE FIRST INPUT SECTION (SEE THE TRUSS PROGRAM).
C
NOTE THAT OTHER CONSTANTS,
SUCH
AS PI,
MUST BF
C
DEFINED BEFORE THE COMPUTED
GO TO. THE 'X'
IS
C
THE
VALUE OF THE X COORDINATE
WHEN THIS
SUBRO~TINE
C
IS
CALLED.
C
PI
= 3. 1L; 159
IPROP
=
-PROP
GO TO (1,
2, 3,
L;, 5), IPROP
C
C
1
2
PROP
=
some function of X, C(1), C(2), etc.
RETURN
PROP
=
some other function of X, C(1), etc.
RETURN

PROBLEMS
237
C
3
CONTINUE
RETURN
C
<;
CONTINUE
RETURN
C
5
CONTINUE
RETURN
C
END
Note that if PROP is negative, it is converted to a positive integer lPROP. The computed
go to then transfers control to the line whose label is numerically equal to lPROP. Thus by
simply including the proper FORTRAN statements in SUBROUTINE VPROP, variable
properties are easily accommodated. The Curs are user-defined constants that should be
read in Section I of the input file (after NNODES, NELEM, etc.) and may be used in
SUBROUTINE VPROP. By way of example, let us say that we want to use this technique
to allow for the varying cross-sectional area in the problem posed in Example 5-5. Let us
define CO) = 1.0 (for D[ in inches), C(2) = 0.5 (for D1 in inches), and C(3) = 12.0 (for
L; in inches). If we use a .. - 4" as the input for the area A in Section 4 of the input file
(see Appendix B for a description of the input to the TRUSS program), the statements
beginning with label "4" should read
CONTINUE
DIAM
~
(C(1)*(C(3)-X)
+ C(2)*X)
PROP
~
PI
*
(DIAM**2)
1<;.
RETURN
since this in effect gives
C(3)
where the expressions for D(x) and A(x) represent the correct diameter and area variations
with x. Note that the variable X in the subroutine represents the x coordinate and is passed
to VPROP via the labeled common (namely. VPROPS). Use the program to verify the results
in Example 5-5 and Table 5-2.
5-40
Use the program developed in Problem 5-39 (or one furnished hy the instructor) to
solve Problem 5-35 with two, four, and eight clements. What happens to the results
as the number of elements is increased')
5-41
Use the program developed in Problem 5-39 (or one furnished by the instructor) to
solve Problem 5-36 with two, four. and eight elements. What happens to the results
as the number of elements is increased')
5-42
Reconsider Example 5-5. Instead of the point load F and traction v acting on the rod.
the free end is now also completely restrained. In other words, both ends of the bar
are restrained and the bar is assumed to be initially in a stress-free state. The bar

238
GENERAL APPROACH TO STRUCTURAL ANALYSIS
then undergoes a temperature decrease of 150°F. Assuming a, = 6.5 x
10- 6 in.!
in.-oF, determine the nodal displacements and element resultants if only two elements
are used. Do not use a computer program.
5·43
Determine an expression for the exact solution for Problem 5-42. Give the result in
terms of the pertinent variables and then apply it to the situation in Problem 5-42.
5-44
Solve Problem 5-42 with the help of the computer program from Problem 5-39 (or
one furnished by the instructor) for two, four, and eight elements. What happens to
the results as the number of elements is increased?
5·45
Consider the problem posed in Problem 5-35. Instead of the point load F and traction
s acting, the free end is now also completely restrained. In other words, both ends
of the bar are restrained and the bar is assumed to be initially in a stress-free state.
The bar then undergoes a temperature increase of 15°C. Assuming a, =
11.7 x
10- 6 m/rn-X', determine the nodal displacements and element resultants if only two
elements are used.
5-46
Solve Problem 5-45 with the help of the computer program from Problem 5-39 (or
one furnished by the instructor) for two, four, and eight elements. What happens to
the results as the number of elements is increased?
5-47
Consider the problem posed in Problem 5-36. Instead of the point load F and traction
s acting, the free end is now also completely restrained. In other words, both ends
of the bar are restrained and the bar is assumed to be initially in a stress-free state.
The bar then undergoes a temperature decrease of 120°F. Assuming a l = 13 x 10- 6
in.zin.v'F. determine the nodal displacements and element resultants if only two
elements are used.
5·48
Solve Problem 5-47 with the help of the computer program from Problem 5-39 (or
one furnished by the instructor) for two, four, and eight elements. What happens to
the results as the number of elements is increased?
5-49
Show that the trial functions given by Eqs. (5-53) and (5-56) for the three-node
triangular element satisfy exactly the compatibility equation given by Eq. (5-22).
5-50
Show that the trial functions given by Eqs. (5-62), (5-65), and (5-66) for the four-
node tetrahedral element satisfy exactly the six compatibility equations.

6
Parameter Functions;
CO-Continuous Shape Functions;
Simple Integration Formulas; Active
Zone Equation Solvers
6-1
INTRODUCTION
Inthis chapter, the concept of the parameter function is formalized. This is followed
by a review of what is meant by Co- and CI-continuous problems. The conditions
that the assumed parameter functions must satisfy are given and are discussed in
some detail. The shape functions are then derived for some of the more popular
one-, two-, and three-dimensional elements. In addition, normalized coordinates,
which facilitate the use of these shape functions, are introduced. Axisymmetric
elements are also considered. Three special integration formulas, which may be
used to evaluate the integrals when the lineal, triangular, and tetrahedral elements
are used, are presented. The chapter concludes with an alternate equation solver.
Up to now the rather inefficient matrix inversion method has been used to solve
the resulting systems of algebraic equations. The equation solver presented at the
end of this chapter takes advantage of the banded and symmetric nature of the
assemblage stiffness matrix.
6-2
PARAMETER FUNCTIONS
In this section, parameter functions are defined in the context of problems in stress
analysis, thermal analysis, and fluid flow analysis. Following this, the requirements
that the assumed parameter functions must satisfy are given and discussed.
239

240
PARAMETER AND SHAPE FUNCTIONS. INTEGRATION FORMULAS
Definition of a Parameter Function
By now it should be evident that in stress analysis problems to be formulated using
the stiffness approach to FEM, the field variables of interest are the displacements.
From a knowledge of the displacements, the element resultants such as the stresses
and strains -may be easily computed. The functions to be used to represent the
displacements on an element basis are referred to as displacement [unctions in
particular and as parameterjunctions in general. For example, a typical displacement
function in one-dimensional stress analysis is given by Eq, (5-47) and in two-
dimensional stress analysis by Eqs. (5-53) and (5-56).
In thermal analysis problems, the field variable of interest is the temperature.
On an element basis, the temperature within a typical element is approximated by
an assumed temperature function. Again, in general terms, this function is referred
to as a parameter function. This situation is slightly simpler than the corresponding
stress analysis problem because the temperature field is a scalar, whereas the dis-
placement field is a vector. Not surprisingly, for the three-node triangular element,
a suitable parameter function for the temperature is of the same form as that given
by Eq. (5-53) for a typical displacement.
In fluid flow problems, the field variables of interest are the fluid velocities
and pressure. If a finite element analysis is to be performed with these so-called
primitive variables, the parameter functions to be used may be referred to more
specifically as velocity and pressure functions. Because the velocities are vectors,
this situation is more closely related to the situation in stress analysis. However,
we usually take the Eulerian approach whereby we observe the fluid velocities and
pressure at fixed points. This is in contrast to the Lagrangian point of view whereby
an individual particle is followed throughout its motion. The reader will recall that
in stress analysis, the Lagrangian point of view is adopted.
Let us now summarize. By parameter function we mean any suitable function
that is used to represent the field variable in a typical element. Parameter functions
are most often taken to be polynomials because of the ease with which they can
be manipulated, as well as for the reasons delineated below. In stress analysis, the
parameter functions are really the displacement functions; in thermal analysis, the
temperature function; and in fluid flow analysis, the velocity and pressure functions
(if the formulation is based on the primitive variables). The reader should be able
to extend these notions to other disciplines, such as electromagnetics and mass
transfer.
Restrictions on the Parameter Functions
As explained below, the assumed parameter functions must meet two primary
requirements: compatibility and completeness. The primary reason for satisfying
these requirements is to ensure convergence as the element size is reduced or, more
specifically, as the mesh is refined in a regular fashion. Before actually discussing

PARAMETER FUNCTIONS
241
the meaning of these requirements, it may be instructive to review what is meant
by a weak formulation.
It should be recalled that a weak formulation to a problem is an integral
formulation that contains in its integrand derivatives of the field variable that are
of a lower order than those in the original governing differential equation. For an
example, the reader may wish to compare the differential equation given by Eq.
(4-7) with its corresponding weak formulations: Eq. (4-130) from the variational
approach and Eq. (4-159) from the Galerkin method.
Furthermore, it should be recalled that a CD-continuous problem is one whose
weak formulation contains at most only first-order derivatives. In a similar fashion,
a C'-continuous problem is one whose weak formulation contains at most only
second-order derivatives. This may be generalized as follows: a C"- '-continuous
problem is one whose weak formulation contains at most only nth order derivatives.
We are now in a position to present the compatibility requirement.
Compatibility
The compatibility requirement may be stated as follows. For CO-continuous prob-
lems, the parameter function itself (not its derivatives) must be continuous along
the boundaries of the element. For Cl-continuous problems, the parameter function
and its first derivative must be continuous, and not necessarily zero, along the
boundaries of the element. This may be generalized as follows. In C"-continuous
problems, the parameter function and its first n derivatives are continuous, and not
necessarily zero, along the boundaries of the element.
It is instructive to discuss this requirement as it relates to one-dimensional
problems, as shown in Fig. 6-1. In particular, consider Fig. 6-I(a). Note that for
the CO-continuous problem, such as the uniaxial stress member or one-dimensional
heat transfer in a fin, the field variable itself is continuous at the interface between
any two elements (in this case, at each node). It should be recalled that the weak
formulation to these problems involves at most only first-order derivatives.
----+- x -Xj
+x
(3)
~,.--tf
d
e~~
---.. x -Xj
+x
(b)
Figure 6-1
One-dimensional clement with (a) CO-continuous parameter functions and (b)
C'-continuous parameter functions. In (a) only the parameter function itself is continuous at
each element interface; in (b) the parameter function and its slope are continuous at each
element interface.

242
PARAMETER AND SHAPE FUNCTIONS. INTEGRATION FORMULAS
On the other hand, in C I-continuous problems, the parameter function itself
and its first derivative must be continuous on the interface between any two elements.
This situation arises in the case of the beam element shown in Fig. 6-I(b) where
both deflection continuity and slope continuity must be guaranteed so that the beam
does not develop kinks. Recall from elementary solid mechanics that the slope of
the beam at any point is simply the derivative of the deflection at this point (see
Sec. 7-5).
The reader should be thoroughly convinced that problems in two-dimensional
stress (plane stress and plane strain), axisymmetric stress, and three-dimensional
stress are all CO-continuous problems. The reason for this is that the weak for-
mulation to these problems involves at most first-order derivatives of the displace-
ment(s). Therefore, only the displacement function itself (not any of its derivatives)
needs to be continuous along the element boundaries. In Example 6-1 (in Sec.
6-3), the two-node lineal element is shown to satisfy the compatibility requirement
for CO-continuous problems. The reader should be further convinced that the pa-
rameter functions assumed in Sec. 5-6 for the triangular and tetrahedral elements
do in fact satisfy the compatibility requirement (see Problems 6-3 and 6-4).
On the other hand, in problems involving the bending of plates and shells, the
deflections and slopes should be continuous along the element boundaries. This
ensures that the plate or shell does not kink. Problems of this type are C'-continuous
because the weak formulation contains at most only second-order derivatives of the
deflections.
Elements that obey the compatibility requirement are said to be conforming,
and those that do not obey this requirement are said to be nonconforming. Each of
the elements presented in Sec. 5-6 is conforming for problems with CO-continuity.
In the analysis of plate bending with the three-node triangular element, slope con-
tinuity along the element boundaries cannot be guaranteed (the slopes at the nodes
are continuous). Therefore, this element is said to be nonconforming. However,
this element is used in such analyses because it gives results of acceptable accuracy
(particularly if special precautions are taken), even though it violates the compat-
ibility requirement [I].
Let us now turn to the second requirement, that of completeness.
Completeness
For CO-continuous problems, the completeness requirement may be stated as fol-
lows. The parameter function must be capable of representing both a constant value
of the field variable and constant first partial derivatives as the element size decreases
to a point. For Cl-continuous problems, the parameter function must be capable of
representing both a constant value of the field variable and constant first and second
partial derivatives as the element size decreases to a point. This may be generalized
as follows. For C"-continuous problems, the parameter function must be capable
of yielding a constant value of the field variable as well as constant partial derivatives
of up to order n + I as the element size decreases to a point.

PARAMETER FUNCTIONS
243
Let us examine what this requirement implies for CO-continuous problems in
stress analysis. Consider, for example, the state of uniaxial stress. Constant values
of both the displacement itself and the derivative of the displacement (i.e., the
strain) must be possible in the assumed form of the displacement function. For the
two-node lineal element, we have been assuming a function of the form
16-1)
Note that if C2 is zero, we have u =
CI> which is a constant as required. This is
referred to as the rigid body mode since the body should be able to undergo a rigid
body displacement without straining (when C2 takes on a value of zero). In addition,
duldx
=
C2' which is also a constant as required (regardless of the value of (',).
Since the derivative of the displacement is the strain, this second condition requires
the displacement function to allow a constant strain in the element. This notion is
readily extended to two- and three-dimensional analyses.
Thermal analysis problems involving heat conduction require only CO-contin-
uous parameter functions because the weak formulations contain at most only first-
order derivatives of the temperature. The completeness requirement is equivalent
to allowing for constant temperature and constant derivative of the temperature.
Since the derivatives of the temperature [with respect to the spatial coordinate(s)]
are proportional to the heat fluxes as a result of conduction, the second condition
is equivalent to the requirement that constant heat fluxes be possible within the
element. Not surprisingly, the assumed forms of the parameter functions in Sec.
5-6 for the displacements are applicable to problems in thermal analysis (see Chapter
8).
Problems in viscous fluid flow analysis that are formulated in terms of the
primitive variables are CO-continuous because the weak formulation is seen to
contain derivatives of the velocities of no order greater than one. The completeness
requirement requires that it be possible to have both constant velocities and stresses
within the element. Potential flow problems formulated in terms of velocity potential
function (or stream function) will also be seen to be CO-continuous. In this case,
the completeness requirement is equivalent to the requirements that it be possible
to have constant values of the velocity potential function (or stream function) and
of the velocity components within the element.
This may be generalized in the case of all CO-continuous problems as follows.
The assumed parameter function must contain a pure constant term in addition to
terms that are first order in the spatial coordinates. The reader should review the
assumed form of the parameter functions in Sec. 5-6 in order to be thoroughly
convinced that these assumed parameter functions satisfy the completeness require-
ment (see Problems 6-5 and 6-6). Elements that satisfy the completeness requirement
are said to be complete.
Further discussion of the compatibility and completeness requirements may be
found in several other books on the finite element method. The reader may wish
to consult the books by Huebner [2], Desai [3], and Martin and Carey [4], as well
as other general books on this subject (see references 38 to 46 at the end of Chapter
I).

244
PARAMETER AND SHAPE FUNCTIONS, INTEGRATION FORMULAS
6-3
ONE-DIMENSIONAL ELEMENT
In this section the familiar two-node lineal element is reexamined. It should be
recalled from Chapters 4 and 5 that this element has a node at each end, as shown
for a typical element e in Fig. 6-1(a): node i at x = Xi and node j at x = Xj' Each
node is usually associated with a planar surface, not just a single point.
Let us represent the parameter function in general as <l> such that it has a value
<l>i at node i and <l>j at node j, The variable <l> may represent the displacement,
temperature, velocity, and so forth, In what follows, the problem is assumed to be
CO-continuous.
The shape functions for the two-node lineal element can be given in terms of
several different coordinate systems, However, we will limit the present develop-
ment to three of the most popular and convenient types of coordinates: (I) global
coordinates, (2) serendipity coordinates, and (3) length coordinates, Each of these
is discussed. The main reason for introducing the latter two coordinates is to simplify
the element integrations that arise,
Global Coordinates
Although the shape functions have already been derived for the two-node lineal
element in terms of the global coordinate x in Chapter 4, it is instructive to review
the procedure in terms of the present nomenclature, The method to be presented
here may be extended easily to two and three dimensions,
We begin by assuming some type of parameter function, In light of the dis-
cussion in Sec, 6-2, the form
(6-28)
or
(6-2b)
is appropriate, because for CO-continuous problems it meets both the compatibility
and completeness requirements (see Example 6-1 below), At node i, where X =
Xi'
we require <l> = <l>i; and at nodei. where x = Xj' we require <l>
<l>j' Therefore,
we may write
<l>i = ('\ + ('2 Xi
<l>j =
('I + ('2 Xi
which may be written in matrix form as
(6-38)
(6-3b)
(6-4)

ONE-DIMENSIONAL ELEMENT
24S
(6-6)
Xi] - J[<I>i]
Xi
<l>j
Solving for the vector of constants yields
[CI]
[I
x,]-J[<I>']
(6-5)
C2
I
x,
<l>J
Substituting this into Eq. (6-2b) yields
<I> =
[I XJ[:
If the 2 x 2 matrix is inverted and if the matrix multiplications are carried out,
we get
( X - X)
(X - X.)
<I> =
_J__
<l>i + __'
<l>i
Xj - Xi
Xi - Xi
(6-7)
which is of the form
<I> = Ni(x)<I>i + N;<x)<I>j
The shape functions are given by
(6-8)
X· -
X
.I
(6-9a)
X
-
Xi
(6-9b)
which the reader will recall. In Fig. 6-2 these shape functions are shown super-
imposed on a typical element. It should be recalled further that these shape functions
satisfy the three properties stated in Sec. 5-6, as shown in Example 5-4.
Example 6-1
Show that the following parameter function <I> = CI + C2X for the two-node lineal
element satisfies the compatibility requirement for CO-continuous problems.
T
r~
~
Figure 6-2
Two-node lineal element with shape functions shown for CO-continuous prob-
lems.

246
PARAMETER AND SHAPE fUNCfIONS. INTEGRATION fORMULAS
Solution
Consider two adjacent elements with global node numbers I, 2, and 3 as shown
in Fig. 6-3. The compatibility requirement requires that, in effect, the value of the
parameter function at node 2 (i.e., <1>2) must be the same regardless of whether
element I or element 2 is considered. The assumed form of the parameter function
results in the equivalent form given by Eq. (6-7), or
(
x. - x)
(x - x)
<1>(x) =
_J--
<1>i +
-.__I
<1>i
xj
-
Xi
Xi -
Xi
In terms of the global coordinates, for element I at x = X2 we have
( X2 -
X2)
(X2 - XI)
<1>(X2) =
<1>, + --
<1>2 = <1>2
X2 -
XI
X2 - X,
and for element 2 at X = X2 we have
<1>(X2) = (X3 - X2) <1>2
X3 -
X2
Since <1>(X2) from element I is the same as <1>(X2) from element 2 [i.e., both are
equal to <1>2], the compatibility requirement is satisfied. Obviously, every other
shared node in problems with more than two one-dimensional elements can be
shown to satisfy the compatibility requirement in a similar fashion.
•
Note that the element has two nodes and the assumed parameter function has
two constants, c, and C2' Therefore, two shape functions should be expected, which
was, in fact, what resulted: one for each node. All of this is predicated on the
assumption, however, that we are dealing only with CO-continuous problems. In
any event, Eqs. (6-9) provide us with the shape functions for this simple element
in terms of the global coordinate (i.e., x).
Next a new coordinate system is introduced that allows us to perform the
required integrations more easily, especially when numerical integrations are per-
formed (see Chapter 9).
1>3
t
1>2
ml
1>1
eDt---
CDt
x = XI
x = X2
x > X3
Figure 6-3
Two adjacent two-node lineal elemenls used in Example 6-1 to show element
compatibility.

ONE-DIMENSIONAL ELEMENT
247
Serendipity Coordinate
The so-called serendipity coordinate r is a local, normalized coordinate defined in
Fig. 6-4 relative to the global coordinate system. The reason for the name serendipity
is given in Sec. 6-4. Note that r = 0 at x = x, where x =
(Xi + xY2. Note also
that r varies from - I at x = Xi to + I at x = Xi' that is, - I ,,; r ,,; I. It should
be obvious that r and X are related by
2(x -
x)
r =
Xi
-
Xi
In terms of this new coordinate, the shape functions become
N, =
Y2 (I -
r)
and
N, =
Y2 (I + r)
as shown in Example 6-2 and Problem 6-9.
(6-101
(6-11al
(6·11bl
Example 6-2
Show that the shape function for node i is given by Eq. (6-lla) for the two-node
lineal element.
Solution
I
N, = -(I
2
_
r) = ~(I _2(x - x»)
2
XI
-
Xi
-
Xi
- 2; : ~i[(Xi + XY21]
r =-1
=
~(2Xj ~ 2X)
2
Xi
X,
r = +\
Xi
-
Xi
Figure 6·4
Two-node lineal elemenI showing global coordinate x and serendipity coor-
dinate r.

248
PARAMETER AND SHAPE FUNCTIONS. INTEGRATION FORMULAS
which is the desired result [see Eq. (6-9a»). The reader should be convinced that
the shape functions given by Eqs. (6-11) have the three properties delineated in
Sec. 5-6 and that, when plotted on a typical element, the result is the same as Fig.
6-2.
..
Length Coordinates
The main reason for introducing length coordinates is to take advantage of the
simple integration formulas given in Sec. 6-7. Unlike the single global coordinate
x and the single serendipity coordinate r, two length coordinates are associated with
the lineal element. However, these two length coordinates are not independent, as
will be seen shortly. Consider the element shown in Fig. 6-5(a). An internal point
p is also shown (point p is not a node). Let us now define the so-called length
coordinates L, and L, as follows:
Lj
length pj
length ij
and
L= length ip
.I
length ij
(6-12a)
(6-12b)
Obviously, we have 0,,;;: L, ,,;;: I and 0,,;;: L, ,,;;: I. Moreover, we must also have
L, + L, = I
(6·13)
because the sum of the fractional lengths must equal unity. The two length coor-
dinates are shown on the element in Fig. 6-5(b). If the point p is located at the
general global coordinate x, then Eqs. (6-12) are equivalent to
__
Xj
-
X
Lj
(6-14a)
and
x -
Xj
L j = ---
xj
-
Xj
(6-14b)
O~Lj
Lj----10
il
t;
Lj = I
l., = 0
ep
(a)
O~X l_i
I;
o»
Figure 6-5
Two-node lineal element showing (a) interior point p and (b) the two length
coordinates L, and Lj • Note: Point p is not a node.

lWO-DIMENSIONAL ELEMENTS
249
The reader should recognize the expressions on the right-hand sides as N; and Nj ,
and we have the fortuitous result that the shape functions, in terms of the length
coordinates, are given by
and
N, = L;
16-15a)
Nj = Lj
16-15b)
Once again, these shape functions are seen to have all three properties stated in
Sec. 5-6 and can be plotted as shown in Fig. 6-2. Like the serendipity coordinate,
the length coordinates are also referred to as the local, normalized coordinates (or
simply normalized coordinates) because they are defined locally in each element
and are normalized to unity.
&-4 TWO-DIMENSIONAL ELEMENTS
In this section two of the most popular two-dimensional elements are considered:
the three-node triangular element and the four-node rectangular element. In both
cases, the appropriate shape functions are derived in terms of the global coordinates
and then cast into forms that utilize suitable normalized coordinates. In both cases,
only the shape functions for CO-continuous problems are considered.
Three-Node Triangular Eilement
A typical triangular element is shown in Fig. 6-6(a) with nodes i, j, and k. By
convention, the nodes associated with a particular element are always given in a
counterclockwise order. For example, the element shown in Fig. 6-6(b) with global
[5
(Xk , Yk )
Y
e
~
. (Xj'Yj)
.
I
I (x,.y,)
x
(a)
(bl
Figure 6-6
Three-node triangular element showing (a) nodal coordinates in general and
(b) global node numbers for a typical element.

250
PARAMETER AND SHAPE FUNCTIONS. INTEGRATION FORMULAS
node numbers 5, 17, and 21 may be defined as having nodes 5,21, 17 or 21. 17,
5 or 17, 5, 21 because each of these designations is in accordance with the con-
vention just given.
It is convenient to set up a cartesian reference frame and to define the coordinates
of the nodes in terms of these coordinates. In other words, the coordinates of nodes
i, j, and k are (Xi,Yi), (xi.y,), and (Xk,Yk), respectively. Let us again represent the
parameter function as Q> such that at nodes i, j, and k we have Q>i' Q>,. and Q>k' In
other words, the parameter function Q> must evaluate to Q>, at (Xi'Yi)' etc. Once
again Q> may be the x or Y component of displacement, the temperature. etc.
We are now in a position to derive the shape functions for the three-node
triangular element in terms of the global (x,y) coordinates.
Global Coordinates
We begin by assuming some type of parameter function. From Sees. 5-6 and 6-2
it would appear that the form
(6-16a)
or
16-16b)
is appropriate because it meets both the compatibility and the completeness re-
quirements for CO-continuous problems. At node i where x = Xi and y = Yi' we
require Q> = Q>i; at node j where x = Xi and Y = Yi' we require Q> = Q>i; and finally
at node k where x = Xk and Y = Yk, we require
Q> = Q>k' From this and Eq.
(6-16a), it follows that
Q>i
('I +
C2X i + (',Yi
16-17a)
Q>,
('I +
('~x, + ("Yi
16-17b)
Q>k
('I +
('~Xk + (',Yk
16-17c)
Writing these in matrix form gives
16-18)
Solving for the vector of constants and substituting the result into Eq. (6-16b) yields
Q> = II
16-19)
Equation (6-19) is of the form
Q> -= Nlt.v)Q>i + N/t.y)Q>i + Nk(x,Y)Q>k
(6-20)

TWO-DIMENSIONAL ELEMENTS
251
where it can be shown (see Problem 6-10) that the shape functions are given by
N;(x,y)
mil + m2lx + m31Y
(6-21a)
N;Cr:,y)
ml2 + m22 x + m32Y
(6-21b)
Nk(x,y)
m" + m2.1x + m33Y
(6-21c)
and in turn
m l ]
(XiY, -
x,y;)IZA
and
m~1 = (\' -
YkllZA
m]l = (Xk -
x,l/ZA
. ,
In2:' = (Yk -
Yi)/ZA
tn~2 = (Xi -
xk)/ZA
(6-21d)
In1.1.
(Yi -
Y,)/ZA
m.B = (Xi -
xil/ZA
:~;
:~;] = area of triangle ijk
Xk v.
(6·21e)
It should be noted that these mil's are strictly a function of the nodal coordinates.
Since the area A of the triangular element is never zero, the inverse indicated in
Eq. (6-19) will always exist. This in turn implies unique values of the mil's for
every element. The reader should show that these shape functions satisfy the three
properties given in Sec. 5-6 (see Problem 6-11).
Note that the element has three nodes and the assumed parameter function has
three constants, ("I' ("2, and ("3' Therefore, three shape functions are to be expected
and, indeed, three such functions were found, as given by Eqs. (6-21). Next a new
type of normalized coordinate is introduced that allows us to evaluate easily the
various integrals that arise.
Area Coordinates
Consider the three-node triangular element shown in Fig. 6-7. The point p is an
arbitrary internal point, not a node. The area coordinates Li , Li , and Lk are defined
as follows:
Li
area pjk
(6·22a)
area ijk
t.,
area pki
(6·22b)
area ijk
Lk = area pij
(6-22c)
area ijk
From these definitions it follows that the area coordinates are not all independent
but are related by
(6·23)

252
PARAMETER AND SHAPE FUNCTIONS, INTEGRATION FORMULAS
k
IIigtIr. 6·7
Three-node triangular element with interior point p. Note: Point p is not a
node.
because the sum of the fractional areas must equal unity. It should also be obvious
that when point P coincides with node i, L; = I and L, = Lk = O. This last
observation is generalized and summarized below:
L;(x;,y;)
L;(xj,y)
0
Li(Xk,Yk)
0
L/Xi'Yi)
0
L/xj'Yj)
Lj(Xk,Yk)
0
(6-24)
Lk(x;'Yi)
0
Lk(xj,y)
0
Lk(Xk,Yk) =
I
Now consider points PI and pz, which happen to be on a straight line that is
parallel to leg jk as shown in Fig. 6-8(a). Because the area of a triangle is given
by one-half the product of the base and the altitude, it should be clear that lines of
constant area coordinate, e.g., L;, are parallel to the opposite leg, in this case leg
jk. Moreover, as the line containing points PI and Pi is moved parallel to leg jk,
the area pjk varies linearly. Therefore, the area coordinates L, must vary linearly
k
(a)
L, = constant
k
(b)
Figure 1·1
Three-node triangular element showing lines of constant area coordinates. In
(a) triangles pijk and pJk have the same areas and hence the dashed line represents a line
of constant L;. In (b) specific lines of constant L; are shown.

TWO-DIMENSIONAL ELEMENTS
253
from zero on leg jk to unity at node i. These observations are summarized in Fig.
6-8(b), which shows several lines of constant Lj • Similar conclusions may be drawn
about the behavior of L, and Li.
The reader may have noted by now that the area coordinates possess the three
properties of CO-continuous shape functions given in Sec. 5-6 for the triangular
element. Consequently, the shape functions for nodes i, j, and k may be given in
terms of the area coordinates as
N, = L,
N, = L,
and
N, = Lk
(6-25)
The implication of this result will be appreciated when integrals must be evaluated
that contain the shape functions, as shown in Example 6-8 in Sec. 6-7. Example
6-3 below shows a little more rigorously why N, = Li, and the reader may show
that N, = L, and Nk = Lli in a similar fashion (see Problems 6-13 and 6-14).
Example 6-3
From the definition of L, given by Eq. (6-22a), show that L, is the same as the
shape function N, given in Eqs. (6-21), and hence N, = L,
Solution
From the definition of L, we have
Y]
V./
v.
Y2 det [:1
~j
area pjk
Xk
L j = --- = --=----=-
area ijk
A
(XjYk
-
XkYj)
2A
where mil' m2\' and m3\ are defined in Eq. (6-2Id).
•
Four-Node Rectangular Element
Figure 6-9 shows a typical rectangular element with nodes i, i. k, and m in a
cartesian reference. frame. The element must be oriented such that sides ij and km
are parallel to the Y axis, and sides jk and mi parallel to the x axis. This element
is useful in situations in which the geometry is regular. In this text, the nodes
associated with a given element must be given by starting at node i and proceeding
counterclockwise to node m. For example, the element shown in Fig. 6-9(b) must
be defined as having nodes 18, 5, 10, 7, in this order, if the shape functions given
below are used. In Chapter 9, these restrictions are lifted at the expense of a little
more mathematics.

254
PARAMETER AND SHAPE FUNCTIONS. INTEGRATION FORMULAS
'-------------x
(a>
(b)
Figure 6-9
Four-node rectangular element showing (a) nodal coordinates in general and
(b) global node numbers for a typical element.
Each node is defined by a unique global node number and by its coordinates.
In other words, the coordinates of node i are (x;,Y;); those of node j are (xl'Y);
etc. Again let us represent the parameter function as <I> such that at nodes i, j, k,
and m, we have <l>i, <l>j,
<1>.. and <1>/11' Stated differently, the parameter function <I>
evaluates to <l>i at (xi,y;), and so forth. Of course,
<I> may represent the x or Y
component of displacement, the temperature, and so forth.
The shape functions for the four-node rectangular element may now be derived
in terms of the global (x,y) coordinate system.
Global Coordinates
As usual we start by assuming some type of parameter function. The following
function meets the compatibility and completeness requirements for CO-continuous
problems from Sec. 6-2:
or
(6-26a)
[I
(6-26b)
In the usual manner, we require <I> to be equal to <l>i at node i where x =
Xi and
y = y" or
(6-27a)
Similarly, we have
<l>j
('I +
('2Xi + (',Y; +
('4 XiYi
<l>k
(', +
('2X, + c,y, +
('4XL\"
4>111
('I + ('2X/II + ('3."111 + CtXmYm
(6-27b)
(6-27c)
(6-27d)

TWO-DIMENSIONAL ELEMENTS
2SS
Writing Eqs. (6-27) in matrix form yields
(6-28)
Solving Eq. (6-28) for the vector of constants and substituting into Eq, (6-26b)
gives
II x, x{
(6·29)
which is of the form
(6-30)
The explicit form of the shape functions in terms of the nodal coordinates and the
global (x,y) coordinates is left as an exercise (see Problems 6-15 to 6-18). The fact
of the matter is that the shape functions for this element are rarely given in terms
of the global coordinates. Instead, they are given in terms of the serendipity co-
ordinates as explained next.
Serendipity Coordinates
The word "serendipity" was invented by Horace Walpole in the eighteenth century
on the inspiration of a Persian fairy tale, "The Three Princes of Serendip," the
heroes of which often made fortuitous discoveries by chance [5). Evidently, the
shape functions for the four-node rectangular element in terms of the normalized
coordinates I' and s, defined in Fig. 6-10, were also originally discovered by chance;
v
I-----x---
k
-I
T
b
!---~~~
l11t-- a
a--J
Y
'---
.L--_x
Figure 6-10
Four-node rectangular element showing serendipity coordinates (r.s) relative
to the global coordinates (r.y). Note: -
I S r S + I and - Iss s + I. Also note: r
= (x -
"i)la and s = (y -
y)/b.

256
PARAMETER AND SHAPE FUNCfIONS, INTEGRATION FORMULAS
hence the name serendipity coordinates. Note that r = 0 and s = 0 at x = xand
Y = y, respectively, where
and
x =
xi + Xk
2
Xi + X/II
2
(6·318)
Yi +.vi
v. + .'"/11
y=---=':"'::""_-'-"'-
2
2
The serendipity coordinates rand s are normalized by
x - x
r=--
a
and
" -
\'
s=-'--'
b
(6·31b)
(6-328)
(6-32b)
where a and b are the element half-lengths as shown in Fig. 6-10. It also follows
that - I .;;; r .;;; I and - I .;;; s .;;; I.
Since the element has four nodes and each node has one shape function as-
sociated with it, four shape functions must be found. Although these functions can
be derived based on the results of Eqs. (6-29), (6-31), and (6-32) after much
algebraic manipulation, let us simply present the shape functions as
N, =
Y4(l + r)(l -
s)
N, =
Y4(1 + r)(l + s)
N, = Y4(l -
r)(1 + s)
Nm = Y4(l -
r)(l -
s)
(6-33)
It should be noted that each of these shape functions has the same form as the
assumed parameter function [see Eq. (6-26a)]. Moreover, the shape functions given
in Eq. (6-33) have the following properties:
l. The shape function associated with a particular node evaluates to unity at this
node; all other shape functions evaluate to zero at this node.
2. The shape function associated with a given node varies from unity at the node
in question to zero at each of the remaining nodes.
3. The sum of the shape functions is identically equal to unity.
The parameter function may be given in terms of these shape functions and
the nodal values <!>i' <!>j' etc., as
<!> =
Y4(1 + r)(I
-
s)<!>j + Y4(1 + r)(I + s)<!>j
+ Y4(1 -
r)(I + S)<!>k + Y4(1 -
r)(I
-
S)<!>1I1
(6-34)
This form of the parameter function meets the compatibility and completeness
requirements stated in Sec. 6-2.

lWO-DIMENSIONAL ELEMENTS
257
Example 6-4
Integrals arise routinely in the finite element method. In Chapter 8, for example,
the integral for the stiffness matrix as a result of convection from a surface will be
seen to contain the shape functions and the convective heat transfer coefficient h.
A typical entry in the matrix is given by the integral IAN;N;h d.x dy. With the help
of the shape functions given by Eq. (6-33), evaluate this integral for the four-node
rectangular element. Assume h to be constant.
Solution
First, from Eqs. (6-32) we note that
d.x = a dr
and
dy = b ds
The integral is then evaluated as follows:
i NiNjh d.x dy = II II [Y4(l + r)(l
A
-I
-I
s)][ Y4(l + r)(l + s)jh ab dr ds
=
abh II II (I + 2r + r2)(l
-
S2) dr ds
16
-)-1
abh II
II
= -
[
(I + 2r + r2)dr][
(I -
s2)ds]
16
-I
-1
= at: [(r + r
2 + ~)I~:J[(s _~')I~]
= alb: G) (~)
= ~abh = ~
Note that the area A of the element is given by (2a)(2b) and, in fact, has been used
above. It will be shown in Chapter '9 how integrals such as this may be evaluated
using Gauss-Legendre quadrature (a particular type of numerical integration).
•
6-5
THREE-DIMENSIONAL ELEMENTS
Two of the most popular three-dimensional elements are now considered: the four-
node tetrahedral element and the eight-node brick element. In the case of the former,
the appropriate shape functions are derived in terms of the global coordinates and
then given in terms of suitable normalized coordinates. In the case of the brick
element, the shape functions are simply given in terms of the serendipity coordinates,
now r, s, and t. In both cases, only the shape functions for CO-continuousproblems
are considered.

258
PARAMETER AND SHAPE FUNCTIONS. INTEGRATION FORMULAS
Four-Node Tetrahedral Element
A typical tetrahedral element with nodes i, j, k, and m is shown in Fig. 6-11. The
nodes associated with a particular element must be given in the order specified by
the following convention:
1. Any of the nodes may be specified to be the first node.
2. The next three nodes must be taken in a counterclockwise direction as viewed
from the first node.
In effect, this gives twelve different ways in which an element may be defined, as
summarized in Table 6-1. Zienkiewicz [6] gives a systematic way of splitting an
eight-cornered brick into six tetrahedra. Such a process could be relegated to a
subroutine and obviously makes the tetrahedral element much more practical because
it is easier to picture a three-dimensional body discretized into bricks.
Table 6-1
Proper Element Definitions for
the Four-Node Tetrahedral Elements
Nodes
2
3
4
j
k
m
k
m
j
m
j
k
j
k
m
j
m
k
j
m
k
k
j
m
k
j
m
k
m
j
m
k
j
m
k
j
m
j
k
Example 6-5
Consider the element shown in Fig. 6-12. Which of the following element definitions
satisfies the ordering convention?
a. 5,9, 18,21
b. 9,5, 18,21
Solution
The order 5,9, 18, 21 does satisfy the convention because nodes 9, 18, and 21
occur in a counterclockwise order when viewed from node 5. The order 9, 5, 18,

THREE-DIMENSIONAL ELEMENTS
259
y
r----------x
Figure 6-11
Four-node tetrahedral element showing nodal coordinates in general.
@
Figure 6-12
Tetrahedral element with global node numbers shown for a typical element.
21 does not satisfy the convention because nodes 5, 18, and 21 do not occur in a
counterclockwise direction when viewed from node 9.
•
Let us set up a cartesian reference frame and define the coordinates of the
nodes in terms of these global coordinates. In other words, the coordinates of nodes
i, j, k, and mare (Xi'Yi'Z;), (Xj,yj'z), etc. Let us again represent the parameter
function as <P such that at nodes i, j, k, and m, we have <Pi' <Pj, <Pb and <Pm. Stated
differently, the parameter function <P must evaluate to <Pi at (Xi'Yi'Z;), etc. Of course,
<P may be the x, y, or Zcomponents of displacements, the temperature, etc.
The shape functions for the four-node tetrahedral element are now derived in
terms of the global (x.y.z) coordinates by using the procedure illustrated in Sees,
6-2 and 6-3.

260
PARAMETER AND SHAPE FUNCTIONS, INTEGRATION FORMULAS
Global Coordinates
From Sees. 5-6 and 6-2, it may be concluded that the parameter function
<!> = CI + C2X + C3Y + C4Z
or
16-35al
16-35bl
l
CI]
<!> = [I
x
Y
z)
~:
is appropriate because it meets both the compatibility and the completeness re-
quirements for CO-continuous problems. At node i, where x = Xi' Y = Y" and
Z = z.; we insist that <!> = <!>j, or
In a completely analogous manner, we have
<!>j = CI + C2Xj + C3Yj + C4Zj
<!>k =
C I + C2 Xk + C3Yk + C4 Zk
and
Writing Eqs. (6-36) in matrix form yields
16-36al
16·36bl
16-36cl
16-36d1
16-371
Solving for the vector of constants and substituting the result into Eq. (6-35b) gives
which is of the form
[I
x
Y
Zll:1 ~ ~
;~]-Il~]
xm Ym
zm
4>m
16-381
<!> = Nj(x,y,Z)<!>i + Nj(x,y,z)<!>j + Nk(x,y,Z)<!>k + Nm(x,y,z)<!>m
16-391
It can be shown that the shape functions are given by
Nj(x,y,Z) :; mil + m2lx + m31Y + m41z
Nj(x,y,z) = ml2 + m22x + m32Y + m42z
Nk(x,y,z) =
m13 + m23x + m33Y + m43z
Nm(x,y,z) = ml4 + m24x + m34Y + m44 z
16-40al
16-40bl
16-4OcI
16-4OdI

THREE-DIMENSIONAL ELEMENTS
261
where
I
[x,
y ,]
, ['
v. ,]
. J
.I
.J
~
mil
6V det
Xk
Yk
Zk
m2l
-- det
I
Yk
Xm
Ym
2m
6V
I
Ym
Zm
(6-40e)
I
['
Xj
'I ]
I
['
Xj
v ]
.J
m 3l
-det
I
Xk
Zk
m4l
-- det
I
Xk
Yk
6V
I
Xm
Zm
6V
I
Xm
YIII
(6-401)
V
Z,]
YJ
Z,
= volume ijkm
Yk
Zk
YIIl
2m
and so forth. In these expressions, V is the volume of the tetrahedron and is given
in terms of the nodal coordinates by
[
I
Xi
V =
~ det
I
Xj
•
I
Xk
I
Xm
The reader may want to review Sec. 2-7 in order to see more clearly how these
results were obtained. Since the volume of the tetrahedral element is never zero,
the indicated inverse in Eq. (6-38) always exists and, therefore, each of the mij's
may be computed for each element as indicated above. It can be shown that these
shape functions satisfy the three properties given in Sec. 5-6 (see Problems 6-30
to 6-32).
Finally, it is noted that the element has four nodes and the assumed parameter
function has four constants, which in tum implies four shape functions. This is, in
fact, seen to be the case. In effect, this assures us that the four-node tetrahedral
element meets the compatibility requirement for CO-continuous problems.
Next another normalized coordinate is introduced-the volume coordinate. In
Sec. 6-7 (and Chapter 9), the reader will come to appreciate these coordinates.
Volume Coordinates
Consider the four-node tetrahedral element shown in Fig. 6-13, where the internal
point p is not to be confused with a node. In effect, point p is used to create four
m
k
Figure 6-13
Tetrahedral element with interior point p. Note: Point p is not a node.

262
PARAMETER AND SHAPE FUNCfIONS. INTEGRATION FORMULAS
other tetrahedra, each contained in the original tetrahedron. The volume coordinates
L;, Lj , Lk • and Lm are defined as follows:
Li
volume pjkm
Lk
volume pijm
volume ijkm
volume ijkm
(6-41)
L= volume pkmi
Lm = volume pijk
./
volume ijkm
volume ijkm
Because the sum of these fractional volumes must equal unity. the four volume
coordinates are not independent but rather are related by
L, + L, + Lk + Lm =
I
(6·42)
Obviously, if the point p coincides with one of the nodes, the volume coordinate
associated with that node has a value of unity and all other volume coordinates are
zero. Since the volume of a tetrahedron is one-third the product of the area of any
face and the height normal to the face, it follows that the volume coordinates vary
linearly throughout the tetrahedron. It also follows that planes of constant volume
coordinate for a given node are parallel to the face of the tetrahedron that is opposite
the node.
Like the length and area coordinates, the volume coordinates possess the same
three properties that the shape functions have for CO-continuous problems. There-
fore, the shape function for a particular node is equal to the corresponding volume
coordinate, or
N; = L,
N; = L;
N, = L,
and
Nm = Lm
(6-43)
Example 6-6 below shows more rigorously why N; = L; from which the reader
may show in a similar fashion the validity of the remaining equalities in Eq. (6-
43) (see Problems 6-33 to 6-35).
Example 6-6
With the help of the definition of L, given in Eq. (6-41), show that L; is the same
as the shape function N, given in Eqs. (6-40), and hence N, = L;
Solution
Beginning with the definition of Li , we write
I-det
6
volume pjkm
volume ijkm
[
~ :./
~J
;J J
1
Xk
Yk
Zk
1
Xm
Ym
Zm
v

THREE-DIMENSIONAL ELEMENTS
263
or
1
[Xi
v.
z ]
[1
v
'j ]
. ./
z' - ~ det
I
~./
L,
6V det
».
Yk
k
6V
Yk
Zk
Xm
.Vm
ZI/I
I
YIII
2m
+ led" [:
Xi
z ]
[1
Xj
s, ]
./
Z
Xk
Zk
-
6V det
I
Xk
Yk
6V
I
Xm
ZI/I
I
Xm
YI1/
or
where mil' m21, m31, and m41 are defined in Eqs. (6-40).
•
Eight-Node Brick Element
The eight-node brick element, shown in Fig. 6-14(a) is also known as the rectangular
prismatic element. Note that the nodes are conveniently numbered I, 2, ... , 8.
The letter designation (i, j, etc.) for this element is cumbersome and, therefore, is
abandoned.
Each element must be defined by its eight global node numbers given in the
order I, 2, ... , 8. For example, the brick element in Fig. 6-14(b) must be defined
as having nodes 15, 18, 14, 10,21,62,81, and 45 (in this order) if the shape
functions given below are used. The element must be oriented such that its
1-2-3-4 face is parallel to the X-Y plane. the 1-5-6-2 face is parallel to the Y-Z plane,
and so forth. In Chapter 9 these overly restrictive requirements are relaxed.
Each node is typically given a unique global node number and is defined by
its nodal coordinates. For example. the coordinates of node I are (Xj,YI,ZI)' Let
us represent the parameter function as <1>. It follows that at nodes I, 2, ... , 8,
3
(8)...---....------.'1
I
I
I
I
~-----_--
5 (xs.Ys·zs)
y
@J---------
Y
/
(xs.Ys.zs)
~
/
1 4~:'Y4.Z4)
I
(XI,YI'ZI)
@ /
~x
x
Z
Z
(a)
(b)
Figure6-14
(a) Eight-node brick element showing nodal coordinates in general. (b) Eight-
node brick element showing global node numbers for a typical clement.

264
PARAMETER AND SHAPE FUNCTIONS. INTEGRATION FORMULAS
the parameter function evaluates to <1> I' <1>2, . . . ,
<1>~. As usual,
<1> may represent
one of the components of the displacement, the temperature, and so forth.
Global Coordinates
The shape functions for the brick element may be derived in terms of the global
coordinates by following the standard procedure that has been illustrated in this
chapter for each of the other elements. As a starting point, the following parameter
function may be assumed:
<1> = CI + C2X + C3Y + C4Z + csxy + C6YZ + C7ZX +
c~xYz
(6-441
The reader is assured that this form of the parameter function satisfies both the
compatibility and completeness requirements for CO-continuous problems. Although
the standard procedure would yield the shape functions (after much algebra), it is
far more convenient to use the shape functions for this element if they are given
in terms of the serendipity coordinates as given below.
Serendipity Coordinates
Figure 6-15 shows the four-node brick element and a local, normalized coordinate
system (r,s,t) with its origin at the centroid (x,y) of the brick. The coordinates
of the centroid are given by
YI + Y2
2
X2 + X3
--2--' etc.
V1 +
V4
~-'-2-'- , etc.
(6-45al
(6-45bl
y
, =-1
5=+1
1=-1
Figure 6-15
Brick element showing the serendipity coordinates r, I, and I. Note: - I 5:
r 5: + 1, -) 5:
I
5: + J. and - I 5:
I 5: + I. AlIO note: r = (x -
xl/a. I
= (y -
Y)/b.
and I = (z -
z)/c.

AXISYMMETRIC ELEMENTS
26S
z =
Z) +
Z5 =
Z4 +
Z8
etc
(6-45cl
22'
The so-called serendipity coordinates are defined in terms of global coordinates by
x - x
r=--
a
y - y
s=--
b
Z -
Z
t=--
c
(6-461
where a, b, and c are the element half-lengths in the x, y, and z directions, re-
spectively. It follows that each serendipity coordinate has a value between - I and
+ I, or - I ~ r ~ + I, - I ~ s ~ + I, and - I ~ t ~ + I. The shape functions
for the eight-node brick element are given below (for CO-continuous problems):
N)
Y8(l + r)(l
s)(l + t)
Ns
Y8(l + r)(l
s)(l -t)
Nz
Y8(l + r)(l + s)(l + t)
N6
Y8(l + r)(l + s)(l
r)
(6-471
N) = Y8(l -
r)(l + s)(l + t)
N7 = Y8(l -
r)(l + s)(l
t)
N4 = Y8(l -
r)(l
-
s)(l + t)
N8 = Y8(l -
r)(l
-
s)(l -
t)
Each of these shape functions has the same form as the assumed parameter function
[i.e., Eq. (6-44)]. In addition, the shape functions given by Eqs. (6-47) have the
same three properties that the two-dimensional serendipity shape functions possess.
Also, the compatibility requirement is met by these shape functions on each face
of the element (i.e., on the element boundaries).
Special numerical integration methods make this element quite practical as the
reader will come to appreciate in Chapter 9 where Gauss-Legendre quadrature is
introduced.
6-6
AXISYMMETRIC ELEMENTS
Many practical problems are axisymmetric in nature. Such problems must meet
two conditions to be classified as axisymmetric. The first is that the body must be
a body of revolution as shown in Fig. 6-16(a). Consequently, a cylindrical coordinate
system is usually adopted with global coordinates r, 6, and z. However, because
of the geometric axisymmetry, the geometry is invariant with respect to the 6
coordinate. This means that, in effect, only the two remaining coordinates (r,z)
need to be considered. The second requirement is that the material properties, the
external effects, boundary conditions, and so forth, may not be a function of 6.
External effects include surface tractions, body forces, prestresses, and heat sources.
Despite these restrictions, many practical problems fall into this class of problems.
The axisymmetry, in effect, allows us to analyze a three-dimensional problem
as though it were a two-dimensional problem. This implies that the three-node
triangular element and the four-node rectangular element may be used provided
that they are rotated through 2'TT radians as shown in Fig. 6-16. The elemental
volume is then given by dV =
2'TTr dr dz. Note that these elements are actually

266
PARAMETER AND SHAPE FUNCTIONS. INTEGRATION FORMULAS
(b)
(el
Figure 6·16
(a) Body of revolution discretized into (b) triangular and (c) rectangular
donut-shaped elements.
triangular and rectangular donuts or toroids. However, becauseof the axisymmetry,
only half of the planar domain needs to be analyzed, as shown for the axisymmetric
body in Fig. 6-17. The planar domain is any plane that goes through and is parallel
to the centerline of the body. The analysis for all practical purposes is thus tll'o
dimensional.
The shape functions for the three-node triangular element are given by Eqs.
(6-21) [or Eq. (6-25)1 provided that x is replaced by r (or z) and y is replaced by
z (or r). Of course, each of the nodal coordinates must be similarly reinterpreted.
The shape functions for the four-node rectangular element are also readily adapted
to this situation.
(a I
(b)
~
~
....---
....---
~
(e)
Figure 6-17
(a) Axisymmetric body with its half-plane discretized into (b) triangular
elements and (c) rectangular elements.

(6-48)
·1
SOME SIMPLE INTEGRATION FORMULAS
267
6-7
SOME SIMPLE INTEGRATION FORMULAS
When the length, area, and volume coordinates were introduced, it was stated that
the main reason for doing so was to allow the use of simple integration formulas
in evaluating the integrals that routinely arise. These integration formulas are pre-
sented in this section and are illustrated in several examples. In each of these
formulas the factorial operator is used, where n! = (n)(n -
l)(n -
2) ... (2)(1)
and O! =
I.
Length Coordinates
The appropriate integration formula in terms of the length coordinates L, and L, is
given by
a'!3!
J, L" Lf' dl =
I)! 1
"
(a + !3 +
where dl is an elemental length between nodes i and j and 1 is the length of line
between nodes i and j, as shown in Fig. 6-18. The exponents a and !3 must be
positive integers.
Example 6-7
With the help of Eq. (6-48) evaluate the element nodal force vector for the body
force (that is, fb) as given by Eq, (5-102) for the uniaxial stress member.
Solution
The nodal force vector fb is given by
f'; =
{Xl WbA dx =
{Xl [Ni ] 'YA dx
Il:/
J~I
Nj
Let us assume that "I, the weight per unit volume, and A, the cross-sectional area.
are both constant, so that the product 'YA may be removed from the integral.
"I"
i ...------------__ /
I·
Figure 6-18
One-dimensional clement showing infinitesimal length dl as well as the actual
clement length I.

268
PARAMETER AND SHAPE FUNCTIONS. INTEGRATION FORMULAS
Moreover, if the shape functions N; and Nj are given in terms of the length coor-
dinates [see Eqs, (6-15»), we have
f
be
J [L;]
-
[(1 + ~!O~ I)! 11
'YA
I
L,
dl -
'YA
O!I!
(0 + I + I)! 1
Simplifying and noting that 1 is the element length in this case or 1 =
Xj
-
Xi
~
Xji' we get
f e =
'YAxji [ I]
b
2
I
which is the expected result [see Eq. (5-102»).
Area Coordinates
•
The appropriate integration formula in terms of the area coordinates is given by
(6-491
where dA is an elemental area of the element (usually dx dy or dr dz) and A is the
area of the triangle formed by nodes i, i, and k. The area A is easily computed
from Eq. (6-2Ie) since the nodal coordinates are always known. The exponents ex,
13, and 'Y must be positive integers.
Example 6-8
A typical entry in the stiffness matrix as a result of convection from a thin two-
dimensional body is given by fAN;Njh dx dy (as shown in Chapter 8). Evaluate
this integral if the three-node triangular element is used.
Solution
With the help of Eqs. (6-25) and (6-49), we evaluate the integral as follows:
JAN;Njh dx dy = JAL;Ljh dA
I!I!O!
hA
h
2A
(I + I + 0 + 2)!
12

(6-50)
SOME SIMPLE INTEGRATION FORMULAS
269
Volume Coordinates
The appropriaIe integration formula in terms of the volume coordinates Li , Lj , Li;
and Lm is given by
a!I3!'Y!&!
I vL'tLrqL~n dV =
6V
(a + 13 + 'Y + & + 3)!
where dV is the elemental volume (usually dx dy dz) and V is the volume of the
tetrahedron formed by nodes i, j, k, and m. This volume is readily computed from
Eq. (6-40£). The exponents a, 13, 'Y, and & must be positive integers.
Example 6-9
A typical entry in the element nodal force vector as a result of a constant volumetric
heat generation rate Q (per unit volume) is seen in Chapter 8 to be given by
I VNjQ dx dy dz. Assuming a four-node tetrahedral element, evaluate this integral.
Solution
With the help of the second equation in Eq. (6-43), we get
I VNjQ dx dy dz
I VLjQ dV
O! I!O!O!
Y.
Q(o+ I +0+0+3)!6V=
-lQV
assuming Q is constant over the element. From this result it is concluded that one-
fourth of the heat generation is allocated to node j. In a similar fashion, it may be
shown that one-fourth of QV is allocated to each of the remaining three nodes. The
total amount is, therefore, given by QV. The validity of this result should be
intuitively obvious.
•
Example 6-10
Redo Example 6-9 with the following spacially dependent volumetric heat gener-
ation rate:
Q = Qox
where Qo is a constant.
Solution
The global coordinate x can be represented in the terms of the x coordinates of each
of the nodes by writing

270
• PARAMETER AND SHAPE FUNCTIONS. INTEGRATION FORMULAS
where the volume coordinates have been used. The integral may now be evaluated
in the following manner:
f v NJQ dx dy dz = Qo f Y L/Lixi + LJxJ + Lix, + LmxmldV
= QoCf vLJL,x, dV + f vLJxJdV + f yLjL,x, dV + f yLJLmxmdV)
[
(
1'1!O!O!
0!2!0!0!
Q
x
6Y + x
-----6y
o
, (I + I + 0 + 0 + 3)!
J (0 + 2 + 0 + 0 + 3)!
0' I!I !O!
O! I !O! I!
]
+ x
6Y + x
6V
, (0 + I + I + 0 + 3)!
m (0 + I + 0 + 1 + 3)!
=
(YZOX j + YIOXj + Y20Xk + Y20Xm) QoY
QoV
= (Xi + 2xJ + x, + xm)2i)
Unlike the previous example, this result is not at all intuitively obvious.
•
6-8
ACTIVE ZONE EQUATION SOLVER
Up to now we have used only the matrix inversion method to solve the system of
algebraic equations implied in Ka
= f. This approach is not very practical in large
finite element models because the computation of the inverse of a large matrix can
result in excessive computer execution time. A much more efficient solution method
is discussed in this section. The basic idea is to decompose the matrix K into lower
and upper triangular matrices Land U such that K = LV. It is shown below how
this results in a straightforward solution for the vector a, once this triangular
decomposition (or LV decomposition) has been performed. Note: The matrix L in
this section is in no way related to the linear operator matrix (also L) from Chapter
5.
Triangular Decomposition
The triangular decomposition of K into L and V such that K = LU is readily
summarized in the form of a short algorithm. Let us first illustrate the basis for the
algorithm by working on a 3 x 3 matrix K. It follows from K = LV that
(6-51)
The number of unknowns on the right-hand side of Eq. (6-51) is seen to be greater
than the number of implied equations, that is, twelve unknowns and nine equations.
The number of unknowns may always be reduced to the number of implied equations

ACTIVE ZONE EQUATION SOLVER
271
(6-52)
I. Therefore, Eg.
by requiring each diagonal entry in L to be unity, or L;;
(6-51) becomes
(i)Q)CD
[
~ KI2
KI3]
K21
K22
K2)
K31
K 32
K 33
Note that the matrix K has been divided into (three) zones. In general, an n X n
matrix K would be divided into n such zones. If the matrices on the right-hand
side are multiplied out and equated with the left-hand side, entry by entry, the
following nine equations in nine unknowns (L2 1, L 3 1, L 32 ,
VII>
V i2 , etc.) are
obtained:
Zone I:
Zone 2:
Zone 3:
K I I = VII
K i2 = V i2
K 21 = L 21V I I
K 22 = L2IV i2 + V 22
K 13 = V 13
K 3 1 = L 31V I I
K 32 = L 31V I2 + L 32V22
K 23 = L2IV I3 + V23
K 33 = L3 1V 13 + L 32V23 + V33
VII
K I I
V I2
K i2
L2 1
K 21
VII
Vn
K n -
L 2 IV i2
V 13
K 13
L 3 1
K 31
VII
L 32
K}2 -
L3 1V I2
V 22
V 23
K 23 -
L 21VU
V33
K 33 -
L 3 1VU -
L 32V23
Zone 3:
These equations may in turn be solved for the nine unknowns to give the following:
Zone I:
Zone 2:
A few subtle points should be made here. Note how the calculations in each
zone use only the entries in the K matrix that are in this zone and only those entries
from the Land U matrices from previous and present zones (but not from subsequent

272
PARAMETER AND SHAPE FUNCTIONS. INTEGRATION FORMULAS
zones). The present zone here is more commonly referred to as the active zone;
hence, the name active zone equation solver.
The above equations may be generalized for an n X n matrix K as follows
[7). For the first active zone, we have
VI) = K)I
L I ) = I
and for each subsequent active zone j from 2 to n, we have
Kj l
L) =-
1
VII
VI) = K I}
and
(6-53)
(6-54)
(6-55)
(6-56)
for
1 = 2, 3, ... ,j -
and finally
i-I
x,
~
LjlllVlIli
m=\
u,
i-I
~
LilllVlIlj
m=\
for
2,3, ... , j -
I
(6-57)
(6-58)
(6-59)
j-I
"» =
K))
-
~
L;IIlVIIl)
m=\
(6-60)
For a symmetric K matrix, the entries in the lower triangular matrix L can be
obtained directly from the upper triangular matrix U from
Vi)
l-» = -.
Vi;
for j
~ i
(6-61)
In Problem 6-44, the reader is asked to show why Eq. (6-61) holds when K is
symmetric.
The use of these equations is best illustrated by an example.
Example 6-11
Perform the triangular decomposition of the following symmetric matrix:
[84 2]
K =
4
8
4
248

ACTIVE ZONE EQUATION SOLVER
273
Solution
The calculations are summarized below for each of the three zones. Although K
is symmetric, Eq. (6-61) is not used in order to illustrate the more general equations.
Zone I:
CD
CD
CD
[~4 :J ~ [lJ I' ]
4
8
2
4
Note: L I I
and
VII
8
Zone 2:
CD
[~ ~]
248
CD
CD
[iiJ ][~ ]
Note: L21 = % = 0.5, V12 = 4, Ln = I, and Vn = 8 -
(0.5)(4) = 6.
Zone 3:
®
®
®
[.
12]
[. I
I][8 4I2]
~4
- ~
~3
2
4
8
0.25
0.5
I
6
Note: L 31 =
2;'8 = 0.25, V 13 = 2, L32 = [4 - (0.25)(4)]/6 = 0.5,
V 23
4 - (0.5)(2) = 3, L 33 = I, and V33 = 8 - (0.25)(2) -
(0.5)(3) = 6.
It is concluded that
L =
[
0~5
~
~]
0.25
0.5
I
and
[84 2]
V =
0
6
3
006
The reader should verify that the product of L and V (in this order) does indeed
give the original K matrix. The L matrix could also be obtained with Eq. (6-61)
since K is symmetric.
•
Forward Elimination and Backward Substitution
Let us now reconsider the system of algebraic equations Ka = f and try to obtain
the solution for the vector a by taking advantage of the material in the previous
section. Beginning with Ka = f and using K = LV, we may write
LVa = f
(6-62)

274
PARAMETER AND SHAPE FUNCTIONS, INTEGRATION FORMULAS
Denoting Ua as the vector z, we have, in effect, two systems of equations:
Lz = f
and
Ua = z
(6-63)
(6-64)
Let us write these out explicitly for the case of a 3 x 3 K matrix in order to gain
some insight into the general algorithm to be presented. Equation (6-63) implies
ZI
r,
L lI z l + "2
f2
L,IZI + L12Z2 + Z1
r,
(6-65)
and Eq. (6-64) implies
(6-66)
From Eq. (6-65) it follows that the Zi'S may be obtained by a forward sweep as
follows:
ZI = II
Z2 = 12
L 21Z1
23 = I,
L,IZI
-
L'2Z2
(6-67)
From these and Eq. (6-66), it follows that
a1 =
V,.1
Z2
V 2.1a 1
(12
Vn
ZI
V n(l.1
V I2(12
(II =
VII
(6-68)
These steps may be generalized to the case of an n x n K matrix in the
following manner:
ZI = II
(6-69a)
z, = 1;
i-I
L
LjjZj
;= I
.
2, 3, ... , II
(6-69b)

ACTIVE ZONE EQUATION SOLVER
275
and
V III1
==~
all
( Zi -
. i
Uilli)
J=I+ I
u;
i = n - I, n -
2, ... , I
(6-70a)
(6-7Ob)
For rather obvious reasons, the steps in Eqs. (6-69) and (6-70) are referred to as
the forward elimination and backward substitution steps, respectively. A numerical
example should help to clarify the procedure.
Example 6-12
Solve the following system of algebraic equations by using forward elimination and
backward substitution:
8al + 4a2 + 2a3
34
4a} + 8a2 + 4a3
56
2al + 4a2 + 8a3 = 46
Solution
Since the matrix K is the same as that in Example 6-11, the results of the triangular
decomposition from that example may be used. The forward elimination step gives
ZI
34
Z2
56
(0.5)(34) = 39
Z3 = 46 -
(0.25)(34) -
(0.5)(39)
18
and the backward substitution step gives
a3
1% = 3
39 -
(3)(3)
5
a2
6
34 -
(2)(3)
(4)(5) =1
al =
8
Therefore, the solution to the original system of equations is given by
A quick check by direct substitution reveals that this is indeed the solution.
•

276
PARAMETER AND SHAPE FUNCTIONS. INTEGRATION FORMULAS
When the K matrix is very large. the triangular decomposition requires much
more execution time than the forward elimination and backward substitution steps.
Therefore, once the triangular decomposition step has been performed. the system
Ka = f may be solved for several different f's rather economically. This capability
is very important in all practical finite element programs and is referred to as
resolution capability.
Next we turn to the question of when the active zone solution method is
guaranteed to give valid results. In order to answer such a question, we must first
define what is meant by a symmetric, positive (or negative) definite matrix.
Classification of Symmetric Real Matrices [8J
First, the principal minors of a matrix K must be defined. If K is an 11 x
11 matrix,
then the 11 principal minors of K are denoted as ill' ilz• . . . , il ll and are given by
ill = K I I
ilz = det [~~:
~~~]
il,~ = det [~~:
~~~
~~:]
(6-71)
K~I
K3z
K~3
and so forth, up to il ll = det K.
With the help of the principal minors, symmetric real matrices can then be
classified as (I) positive definite, (2) negative definite, (3) positive semidefinite,
(4) negative semidefinite, and (5) indefinite, as summarized in Table 6-2. Note that
a positive definite, symmetric real matrix is one whose principal minors are all
strictly positive. On the other hand, note how the principal minors alternate between
strictly negative and strictly positive for negative definite matrices.
Fortunately, the finite element formulations in this text result in positive (or
negative) definite K matrices, except in a few cases as noted later. This is fortunate
because the active zone equation solver presents no unusual difficulties in these
cases and may be used as presented. When the K matrix is unsymmetric (see
Chapter 8) or indefinite, some additional checks may be necessary to ensure that
the equations can be solved. In these cases, certain rows and columns of K may
Table 6-2
Classification of Symmetric Real Matrices*
Classification
of symmetric real matrix
Positive definite
Negative definite
Positive semidefinite
Negative semidefinite
Indefinite
Conditions
on the principal minors
a l > o. a2 > O. ' , , . a" > 0
al < O.a2 > O. a~ < O. etc.
al ~ O. a2 ~ O. ' ... a" ~ 0
al oS O.a2 ~ O. a, oS O. etc,
None of the above patterns
'From Brogan. W, L.. Modem Control Theon'. Quantum Publishers. New York. 1974,

ACTIVE ZONE EQUATION SOLVER
277
have to be interchanged to effect a solution. Treatment of such cases is beyond the
scope of this text; the interested reader may wish to consult references [9-11]. In
what follows it is tacitly assumed that interchanges of rows and columns are not
necessary.
Storage Considerations
It should be recalled that the assemblage stiffness matrix K is generally banded
and symmetric. This is quite significant because it becomes possible to reduce
significantly the storage requirements of such a matrix. If it is symmetric, then the
entries below the main diagonal need not be stored. This alone reduces the storage
requirement by a factor of nearly one-half. If the matrix is banded or if there are
many leading zeros in the upper triangular portion of the matrix, then the storage
requirements are reduced further.
Consider, for example, the 7 x 7 matrix K that is given by
K 11
K I2
K13
0
0
0
0
K22
K23
0
0
K'L6
0
K'3
K34
0
K36
0
K
K44
K4S
0
0
(6-72)
Kss
KS6
KS7
symmetric
K66
K67
Kn
The half-bandwidth b; in this case is readily seen to be five, as dictated by the
second row. One way to store the coefficients in this matrix is by the so-called
banded storage method.
Banded Storage Method
If an 11 X
11 matrix K has a half-bandwidth b"., then the nonzero coefficients (and
the imbedded zeros by row) are stored in a compacted II x b.; matrix. The matrix
in Eq. (6-72), for example, would be stored in a 7 x 5 matrix as follows:
Note how each row from the diagonal entry is slid to the left, with imbedded zeros
in the row also necessarily being stored. If the original matrix K is not banded, no
reduction in storage requirements occurs. Nevertheless, in this example, the original

278
PARAMETER AND SHAPE FUNCTIONS, INTEGRATION FORMULAS
matrix would require 49 (or 7 x 7) storage locations, whereas the banded storage
would require 35 (or 7 x 5) locations. A more efficient storage method is presented
next.
Skyline Storage Method
It is far more efficient to store the K matrix in a column vector form as illustrated
below. The method is most easily understood by way of an example. Reconsider
the 7 x 7 matrix given by Eq. (6-72). Let us store the nonzero coefficients (and
imbedded zeros by column) in a column vector AU) as shown in Fig, 6-19, Note
how each column in the K matrix is stacked in AU). Note further that leading zeros
in the column need not be stored. Zeros that are imbedded in a column, however,
must be stored.
i
AU)
I
K II
2
K 12
3
K 2 2
4
K 13
5
K 2 3
6
K))
7
K H
8
K..
9
K 4 5
10
K5 5
II
K 26
12
K 36
13
0
14
K 5 6
15
K6 6
16
K 5 7
17
K6 7
18
K"
JDIAG(j)
6
4
8
10
6
15
18
Figure 6-19
Skyline storage method for K matrix in Eq. (6-72).

ACTIVE ZONE EQUATION SOLVER
279
The JDIAG(J) array in Fig. 6-19 is used to find the location of each nonzero
(or imbedded zero) entry in the column vector. Physically, for a given value of j
(l "" j "" n), JDIAG(j) represents the number of entries stored in AU) up to and
including the diagonal entry (i.e., Kjj) . For example, K55 is the tenth entry in A(i)
and, hence, JDIAG(5) is 10. The location of Kmn in AU) is most easily found by
using the following simple formula:
i = JDlAG(n) -
I(n -
m)1
(6-73)
For example, let us locate the position in the AU) array that is reserved for K36 .
Here n is 6 and m is 3. Therefore, i = JDIAG(6) -
1(6 -
3)1 :: 15 -
3 = 12.
The reader should note in Fig. 6-19 that K36 is indeed the twelfth entry in the AU)
array. Note: n should always be the larger subscript (not necessarily the second
subscript).
This same method can be used to store unsymmetric matrices with a symmetric
profile. In this case, the lower coefficients are stored by row, with unity assigned
to each diagonal entry in another column vector, e.g., the C(i) array. Because the
profile is assumed to be symmetric, the same JDIAG(J) array may be used. For
obvious reasons, the JDIAG(j) array is frequently referred to as the pointer array
of the diagonal pivots, or simply the pointer array.
COMputer knplementation
Subroutines are readily available that incorporate the active zone solution and skyline
storage methods. Two such FORTRAN subroutines are introduced in this section-
subroutine ACTCOL for symmetric matrices and subroutine UACTCL for unsym-
metric matrices [12]. These subroutines are given in Appendix C. In Chapter 8, it
will be seen how an unsymmetric K matrix may arise. In such cases, subroutine
UACTCL must be used. The subprogram header lines are given by
SUBROUTINE
ACTCOL
(A,
B, JDIAG,
NEQ,
AFAC,
BACK)
and
SUBROUTINE
UACTCL
(A,
C,
B,
JDIAG,
NEQ,
AFAC,
BACK)
where the parameters A, B, C, JDIAG, NEQ, AFAC, and BACK are defined in
Table 6-3. In subroutine UACTCL, the diagonal entries in the C array (see Table
6-3) are set to unity (the actual diagonal entries are stored in the A array). The
reader may wish to consult the original reference [12] for further details on the use
of these subroutines. It should also be remarked that these subroutines require
function DOT (also given in Appendix C), which performs a vector dot product.

280
PARAMETER AND SHAPE FUNCTIONS. INTEGRATION FORMULAS
Table 6-3
Variables Used in Equation Solution Subprograms ACTCOL and UACTCL*
A(NAD)
B(NEQ)
C(NAD)
JDIAG(NEQ)
NEQ
NAD
AFAC
BACK
Upper triangular coefficients when called, replaced by U on return
Right-hand side vector at call (i.e., f), solution vector (i.c.. a) upon
return to calling program
Lower triangular coefficients at call, L at return (used in UACTCL
only)
Pointer array to determine location in A or C of diagonal pivots
Number of equations to be solved
Length of A or C arrays: equal to JDIAG(NEQ)
Logical variable: if true, triangular decomposition performed
Logical variable: if true, forward elimination and backward
substitution performed
'Copyright © 1977 McGraw-Hili (UK). London. From Zienkicwicz. O. C.. The Finite Element Method.
3d ed. Reproduced by permission of the publisher.
6-9
REMARKS
In this chapter, the compatibility and completeness requirements have been intro-
duced. If the assumed form of the parameter function satisfies these requirements,
convergence is guaranteed as the elements are reduced in size in some regular
fashion.
The one-dimensional lineal element was reintroduced along with two new one-
dimensional normalized coordinates: the serendipity coordinate and the length co-
ordinates. The shape functions for this element were derived in terms of all three
coordinate systems.
Among the two-dimensional elements considered in this chapter were the three-
node triangular element and the four-node rectangular element. The shape functions
were derived for the triangular element in terms of the global coordinates. Then
the so-called area coordinates were introduced, and each shape function was seen
to be equal to the corresponding area coordinate. This fact has important implications
in the evaluation of the resulting integrals because special integration formulas may
be used. The shape functions for the rectangular element were given in terms of
the serendipity coordinates.
In a similar fashion, the shape functions for two three-dimensional elements
were presented. For the four-node tetrahedral element the shape functions were
derived in terms of the global coordinates using the standard procedure. Volume
coordinates, which facilitate the evaluation of the volume integrals that will naturally

REMARKS
281
arise, were introduced. The eight-cornered brick element was introduced along with
its associated shape functions in the so-called serendipity coordinates.
A special type of problem was discussed that is not strictly one, two, or three
dimensional. These problems are refemed to as axisymmetric problems and must
meet two basic conditions: both the geometry and the external effects must be
axisymmetric. It was shown how the two-dimensional elements may be used in
such situations. This point will be demonstrated in more detail in Chapters 7 and
8.
As mentioned above, special integration formulas may be used when line, area,
and volume integrals need to be evaluated. Such integrals may be readily evaluated
if the lineal, triangular, and tetrahedral elements are used with the shape functions
given in terms of the length, area, and volume coordinates. Examples were given,
but the reader may expect to see many more applications of these formulas in the
next several chapters.
The chapter was concluded with a more efficient method for the solution of
the system of algebraic equations-the active zone equation solver. This method
may be divided into three steps: (I) triangular decomposition, (2) forward elimi-
nation, and (3) backward substitution. Up to now, we have been using the relatively
inefficient matrix inversion method. The active zone method takes advantage of
the banded (and symmetric) nature of the assemblage system equations. Two special
FORTRAN subroutines were introduced that very effectively perform the necessary
tasks, thereby paving the way to our obtaining solutions to larger, more practical
problems.
In Chapters 7 and 8, specific application areas are considered: stress analysis
in Chapter 7 and thermal and fluid flow analysis in Chapter 8. These two chapters
will pull together everything that has been covered up to this point. The reader may
wish to review Chapter 5 before tackling the next chapter.
REFERENCES
1. Zienkiewicz, O. c.. The Finite Element Method, McGraw-Hill (UK). London. 1977,
pp. 287-288.
2. Huebner, K. H.. The Finite Element Method for Engineers, Wiley, New York. 1975,
pp. 79-81.
3. Desai, C. S., Elementary Finite Element Method, Prentice-Hall, Englewood Cliffs,
N.J .. 1979, pp. 43-45.
4. Martin, H. C.. and G. F. Carey. introduction to Finite Element Analysis: Theory and
Application, McGraw-HilI, New York. pp. 52-53.
5. Micropaedia, "Serendib." Encvclopaedia Britannica, vol. IX, p. 67, 1981.
6. Zienkiewicz, O. c., The Finite Element Method, McGraw-Hill (UK). London. 1977,
pp. 141-144.
7. Zienkiewicz, O. C.. The Finite Element Method, McGraw-Hill (UK), London. 1977,
p.719.
8. Brogan, W. L.. Modern Control Theory. Quantum Publishers, New York. 1974, p.
134.

282
PARAMETER AND SHAPE FUNCTIONS, INTEGRATION FORMULAS
9. Wilkinson, J. H" and C. Reinsch, Linear Algebra, Handbook for Automatic Compu-
tation II, Springer-Verlag, New York, 1971.
10. Ralston, A" A First Course in Numerical Analyses, McGraw-Hili, New York, 1965.
11. Fox, L., An Introduction to Numerical Linear Algebra, Oxford University Press, New
York, 1965.
12. Zienkiewicz, 0, c., The Finite Element Method, McGraw-Hili (UK), London, 1977,
pp, 740-746.
PROBLEMS
6-1
In a mass transfer model, we typically try to find the concentration distribution of
some chemical species in a fluid or a solid, What specific name could be suggested
for the parameter funciton in this case?
6-2
In electromagnetics, what could be suggested for specific name(s) of the parameter
function(s)?
6-3
Show that the three-node triangular element satisfies the compatibility requirement
if a parameter function of the form <I> =
CI + C:zX + C3Y is assumed for CO-continuous
problems,
6-4
Show that the four-node tetrahedral element satisfies the compatibility requirement
if a parameter function of the form <I> =
CI + C:zX + C3Y + C4Z is assumed for C o_
continuous problems,
6-5
Show that the three-node triangular element satisfies the completeness requirement
if a parameter function of the form <I> =
CI + CZX + cJY is assumed for CO-continuous
problems,
6-6
Show that the four-node tetrahedral element satisfies the completeness requirement
if a parameter function of the form <I> =
CI + C:zX + C3Y + C4Z is assumed for Co-
continuous problems,
6-7
In Problem 6-5, which term (or terms) represents the rigid-body mode and which
term (or terms) represents the constant strain?
6-8
In Problem 6-6, which term (or terms) represents the rigid-body mode and which
term (or terms) represents the constant strain?
6·9
Show that the shape function for node j for the two-node lineal element (with Co-
continuity) is given by Eq. (6-llb) in terms of the serendipity coordinate r,
6-10
With the help of Eqs. (6-19) and (6-20), show that the shape functions for thc three-
node triangular element are given by Eqs. (6-21) for CO-continuous problems. Hint:
See Sec, 2-7 for the method to be used in obtaining the matrix inverse. Denote the
entries in the inverted matrix as mil' mlZ, etc.
6-11
Show that the shape functions given by Eqs. (6-21) for the triangular element satisfy
the three properties delineated in Sec. 5-6,
6-12
Saow the lines of constant LJ and Lk on the three-node triangular element for L,
0, Y4, Yz, %, and I and for L,
= 0, Y4, etc,

PROBLEMS
283
6-13
From the definition of L; given by Eq. (6-22b), show that Lj is the same as the shape
function N, given in Eqs. (6-21), and hence N, = Lj .
6-14
From the definition of L, given by Eq. (6-22c), show that L, is the same as the shape
function N, given in Eqs. (6-21), and hence Nk = Li.
6-15
Determine the explicit form of the shape function for node i for the rectangular
element in terms of the global coordinates (x,y) and the nodal coordinates. Hint: See
Eqs. (6-29) and (6-30).
6-16
Repeat Problem 6-15 for nodej.
6-17
Repeat Problem 6-15 for node k.
6-18
Repeat Problem 6-15 for node m.
6-19
For the four-node rectangular CO-continuous element,
a. Plot N, on face mi.
b. Plot Nj on face ij.
c. Plot N, along the straight line connecting nodes i and k.
6-20
For the four-node rectangular CO-continuous element,
a. Plot Nj on face ij.
b. Plot N, on face jk.
c. Plot N, along the straight line connecting nodes j and m.
6-21
For the four-node rectangular CO-continuous element,
a. Plot N, on face jk.
b. Plot Nk on face km.
c. Plot N, along the straight line connecting nodes k and i.
6-22
For the four-node rectangular CO-continuous element,
a. Plot Nm on face mi.
b. Plot Nm on face km.
c.
Plot Nm along the straight line connecting nodes m and j.
6-23
Evaluate the following integral for the four-node rectangular element:
where A denotes the area of the rectangle and h is a constant.
6-24
Evaluate the following integral for the four-node rectangular element:
where A denotes the area of the rectangle and h is a constant.
6-25
Evaluate the following integral for the four-node rectangular element:
where A is the area of the rectangle and h is a constant.

284
PARAMETER AND SHAPE FUNCTIONS. INTEGRATION FORMULAS
6-26
For the four-node tetrahedral element shown in Fig. 6-12. give all twelve possible
element definitions in terms of the four global node numbers.
6·27
Determine expressions similar to those in Eq. (6-40e) for m12. m22. m12. and m42 for
the four-node tetrahedral element.
6-28
Determine expressions similar to those in Eq. (6-40e) for mil.
m2]. mn. and m4.1 for
the four-node tetrahedral element.
6-29
Determine expressions similar to those in Eq. (6-40e) for m1 4• m24. mH' and m44 for
the four-node tetrahedral element.
6-30
Show that N, evaluates to unity at node i for the four-node tetrahedral clement and
that N, is zero if evaluated at the coordinates of node l- node k, and node m.
6-31
From Problem 6-30 and Eqs. (6-40). give a plausible argument for why N, must
decrease linearly from unity at node i to zero at each of the remaining nodes.
6-32
Show that L N~ =
I for the four shape functions given by Eqs. (6-40) for the four-
node tetrahedral clement.
6-33
With the help of the definition of LJ given by Eq. (6-41). show that L; is the same
as the shape function N, given in Eqs. (6-40) for the four-node tetrahedral clement.
6-34
With the help of the definition of L, given by Eq. (6-41), show that Lk is the same
as the shape function N, given in Eqs. (6-40) for the four-node tetrahedral element.
6-35
With the help of the definition of Lm given by Eq. (6-41). show that Lm is the same
as the shape function N", given in Eqs. (6-40) for the four-node tetrahedral clement.
6-36
What two conditions must a problem satisfy in order to beconsidered axisymmetric"
6-37
For the axisymmetric body shown in Fig. 6-17(a) and discretized in Fig. 6-17(b).
what are the shape functions in terms of the radial and axial coordinates rand:.
6-38
Evaluate the following line integrals for the two-node lineal element:
a. II NT dl
c. II NTNJ dl
b. II NiNj dl
d. II NTNf dl
6-39
Evaluate the following line integrals for the two-node lineal clement:
a. II NiX dl
b. II NiN,x 2 dl
6-40
Evaluate the following area integrals for the three-node triangular element:
a. IA NiNk dA
c. IA NJNk dA
b. IA Nt dA
d. IA NtNJNk dA
6·41
Evaluate the following area integrals for the three-node triangular clement:
a. IA NiX dA
b. IA N;)' dA
6-42
Evaluate the following volume integrals for the four-node tetrahedral clement:
a. I yN, dV
c. I v NiN,NkN", dV
b. I yN,Nk dV
d. I v NiN~, dV

PROBLEMS
285
6-43
Evaluate the following volume integrals for the four-node tetrahedral element:
a. I V NlNfn dV
b. Iv N,x dV
6-44
For symmetric n x n K matrices. show that the entries in the lower triangular matrix
L can beobtained directly from the upper triangular matrix U. In other words. show
that Eq. (6-61) is valid for n x n symmetric K matrices.
6-45
Determine Land U for the following matrix:
[
10
5
K =
5
20
2
5
Is K positive definite? If not. classify it.
6-46
Determine Land U for the following matrix:
[
20
10
K
=
10
30
5
10
Is K positive definite'! If not. classify it.
l~]
20
6-47
Determine Land U for the following matrix:
[
20
15
10]
K
=
10
30
15
15
10
20
Can Table 6-2 be used to classify this matrix'! Why or why not"?
6-48
With the results from Problem 6-45. solve the following system of equations:
lOa] +
5a2 +
2a,
26
Sa] + 20a2 +
Sa,
60
2a] +
5a2 + lOa)
42
6-49
With the help of the results from Problem 6-46. solve the following system of
equations:
20a] + IOa2 +
Sa,
90
IDa] + 30a2 + lOa)
200
Sa] + IOa2 + 20a,
135
6-50
Solve the following set of equations by using the results from Problem 6-47:
20a] + 15a2 + lOa)
155
lOa] + 30a2 + ISa,
210
15a] + IOa2 + 20a,
135

286
PARAMETER AND SHAPE FUNCTIONS. INTEGRATION FORMULAS
K=
6-51
Consider the following symmetric matrix:
[
20
~~
2~
I~
40
20
40
symmetric iLl]
40
20
20
a. What is the half-bandwidth?
b. How many storage locations are required if this matrix is stored by the banded
storage method? What is the resulting banded storage matrix?
c. How many storage locations are required if this matrix is stored by the skyline
storage method (i.e., in column-vector form)? What is the column vector [i.c.,
the AU) array in ACTCOLP
d. What is the JDlAG(j) array for part (c)?
6-52
Consider the following symmetric matrix:
50
20
10
0
0
0
0
0
75
50
0
25
0
0
0
80
20
0
50
0
0
K
30
0
0
0
0
40
20
0
0
symmetric
50
5
10
2
5
I
a. What is the half-bandwidth?
b. How many storage locations are required if this matrix is stored by the banded
storage method? What is the resulting banded storage matrix?
c. How many storage locations are required if this matrix is stored by the skyline
storage method (i.e .. in column-vector form)? What is the column vector [i.e.,
the AU) array in ACTCOLj?
d. What is the JDIAG(j) array for part (c)?
6-53
Consider the unsymmetric matrix:
50
20
0
4
0
0
0
0
0
30
100
80
20
5
0
0
0
0
5
20
130
40
20
10
0
0
0
0
90
100
150
100
80
40
0
0
K
0
50
75
80
180
100
60
40
0
0
0
0
90
150 200
90
85
40
0
0
0
10
75
80
210
215
35
0
0
0
0
5
50
100 220
190
0
0
0
0
0
6
10
55
160
a. What is the half-bandwidth?
b. What are the AU) and eU) arrays for use in subroutine UACTCL?
c. What is the JDIAGU) array for part (b)?

7
Stress Analysis
7-'
INTRODUCTION
In this chapter, the finite element method is applied to several different classes of
problems in stress analysis. The chapter begins with two-dimensional problems,
since one-dimensional stress analysis was introduced in Chapter 5. This is followed
by the finite element formulations to axisymmetric and three-dimensional problems.
In each case, expressions for the element stiffness matrix and element nodal force
vectors are derived from Eqs. (5-87) to (5-92). However, an alternate approach is
taken in the study of the beam model. More specifically, the finite element char-
acteristics for the beam are derived with the help of the Galerkin method (one of
the weighted-residual methods from Chapter 4). Appropriate working expressions
are then derived for the element stiffness matrix and element nodal force vectors
for the beam element. The concept of substructuring is described, which makes the
development of extremely large finite element models feasible. The chapter is
concluded with a brief description of a two-dimensional stress analysis program.
7-2
TWO-DIMENSIONAL STRESS ANALYSIS
In this section, the plane stress and plane strain models are defined. The finite
element characteristics are derived from Eqs. (5-87) to (5-92) for the case of a
specific two-dimensional element. Each of the basic steps in the FEM solution to
such problems is discussed.
287

288
STRESS ANALYSIS
Definitions of Plane Stress and Plane Strain
Plane stress and plane strain models are both two-dimensional idealizations of three-
dimensional problems. The situations in which each is appropriate are discussed
below.
Plane Stress
The plane stress model is appropriate when a thin plate is loaded uniformly across
its thickness t and in a direction parallel to the lateral surfaces of the plate as shown
in Fig. 7-1. Note that the thickness t of the plate need not be constant. The loading
around the plate periphery may be a result of tensile. compressive. or shear forces.
The definition of plane stress implies
(L = 0
(T"
= 0
and
IT"
= 0
17-1)
both within and on the faces of the plate. Also. the body force b, must be zero.
The body forces b; and b. may each be functions of .r and v. Therefore. there are
three nonzero stress components (Tn' o.,; and (T". which are functions of .r and y
and which remain constant through the thickness of the plate (in the z direction) at
any point. It should be pointed out that the strain in the z direction. E". is not
necessarily zero for the state of plane stress [see Eq. (7-16)]. In addition, the body
may have self-strains E.u " , E,.",,, Eno". and E"" possibly because of a temperature
change ti.T. Also, initial residual stresses (Trr,,' (Tu", and (T"II may exist.
Point
load
Surface traction
Point
load
L-
-jL-
,
(a)
Loading
(b)
Figure 7-1
Plane stress (all loads are in the x-y plane only).

TWO-DIMENSIONAL STRESS ANALYSIS
289
In summary, a problem may be classified as plane stress when the body to be
analyzed is a relatively thin plate loaded only in the plane of the plate.
Plane Strain
The plain strain model is appropriate when the normal strain in the z direction, Ezz ,
and the shear strains, Exz and E"z, may be assumed to be zero, or
Ezz = 0
Exz = 0
and
(7-2)
This situation is most likely to arise when a long prismatic member of constant
cross section is held between two smooth fixed rigid planes as shown in Fig. 7-2.
Although this is not a very practical situation, St. Venant's principle
[~] allows us
to use the plane strain model in the regions far from the ends that may not meet
the above conditions.
Note the coordinate system shown in Fig. 7-2. External forces may have only
x and y components and may be a function of x and y only. All cross sections are
expected to have the same deformations. Body forces, b, and b.
per unit volume
may each be functions of x and y only, and in the z direction we must have b, = O.
As in plane stress, the body may have self-strains E n o' E,'.',o' and E,n'Opossibly because
of a temperature change J1T and initial stresses (Tuo' (T,,\,o' (T,n'o' and (Tzzo' Note that
in general (Tzz is not necessarily zero in plane strain and, therefore, we must allow
for the possibility of nonzero (Tzzo [see Eq. (7-21)].
The Shape Function Matrix N
Before the shape function matrix can be derived, the two-dimensional region to be
analyzed must be discretized into a suitable number of elements. From Chapter 6,
two elements in particular can be used in this situation: the three-node triangular
element and the four-node rectangular element. Because the triangular element can
accommodate practically all two-dimensional regions, let us restrict the finite ele-
ment formulation to only these elements, as shown in Fig. 7-3. In both plane stress
and plane strain, each node has two degrees of freedom: the x and y components
/I-+---~---,1-,---
YLz
Long prismatic member
Side view
Smooth fixed
rigid plane
Smooth fixed
rigid plane
I'
End view
Figlilre 7-2
Plane strain (all loads are in the x-y plane only).

290
STRESS ANALYSIS
Figure 7·3
Typical two-dimensional region discretized into triangular elements.
of the displacements. Since each element has three nodes and each node has two
degrees of freedom, the shape function matrix N is given by Eq. (5-61), which is
repeated here for easy reference:
o : N
,
J
N; i 0
(5·61)
The three shape functions are given by Eqs. (6-21). The shape function matrix N
is, therefore, the same for plane stress and plane strain and is given by Eqs.
(5-61) and (6-21).
The StraiR-Nodal Displacement Matrix B
Recall that the strain-nodal displacement matrix B is given by Eq. (5-76) or B == LN,
where L is the linear operator matrix. It should further be recalled from Eq. (5-75)
that E
== Lu, where
t:
==
[ E"
En
ExyV
(7·3)
and
"
[u
vV
(7-4)
u ==
where u and v are the x and y components of the displacement field. The strain-
displacement (or kinematic) relationships for both plane stress and plane strain are
given by Eq. (5-14) for small deformations:
au
E
==-
xx
ax
dV
E\,\, =-
'.
ay
E.n
au
ay
av
+-ax
(5·14)

TWO-DIMENSIONAL STRESS ANALYSIS
291
It follows that the linear operator matrix L is given by
L
a
ax
o
a
ay
o
a
ay
a
ax
(7-5)
The matrix B is then easily determined to be
aNi
,
i}!!1
: aNk
,
0
,
0
0
,
:-
,
ax
, ax
, ax
,
:
,,
:
,
i}!!1
aNi ,
,
aNk
B
LN
,
0
,
0
(7-6)
0
,
,
.
,
ay i
ay i
ay
aNi
aN ! i}!!1
i}!!1 ! aNk
aNk
-',
,-
,
,
ay
ax , ay
ax , ay
ax
!
!
But the shape functions are given by Eqs. (6-21), so the matrix B is seen to be
composed of the m;/s and is given by
o
o
i
: m23
! 0
! m33
(7-7)
Since the mij's are known functions of the nodal coordinates [see Eq. (6-2Id)], the
B matrix is determined. The fact that this matrix is composed of only constant
entries (for the three-node triangular element) has an important implication when
the integrals defining the finite element characteristics are to be evaluated, as will
be seen shortly.
The Constitutive Relationship
Recall that the constitutive relationship for a linear, elastic material is given by Eq.
(5-24), which is repeated here for convenience:
(5-24)
The material property matrix D depends on whether the material is isotropic or
anisotropic. Only the isotropic case is considered here. The interested reader should
consult Zienkiewicz's book [2] for the anisotropic form of the material property
matrix. The matrix D and the vector Eo are different for plane stress and plane
strain as indicated below.

292
STRESS ANALYSIS
Plane Stress
For an isotropic material in plane stress, we have by the generalized Hooke's law:
v..
fl(T,·, +
(7-8a)
e.,
=
-
- --
E.lx O
E
E
fl(T,., +
(Tn +
(7-8b)
En
E
E
En o
I
En
= C
U
" +
E..n o
(7-8e)
where fl is Poisson's ratio, E is the modulus of elasticity, and G is the shear modulus
(one of the Lame constants) related to fl and E by
E
G=---
2(1 + p.)
(7-9)
If we solve Eqs. (7-8) for the three stresses and recognize that the initial stresses
not shown in Eqs. (7-8) are simply additive to (T,P etc., we get
(7-10a)
E
(T"
=
I _
fl2 1fl(E n
-
En o) + (En
-
Ey,o)J + (T'TO
(7-10b)
(T" = I: fl2 [I ; fl (E".
-
En o)] + (T"o
(7-10e)
Equations (7-10) may now be cast into the form of Eq. (5-24) by defining the
following [in addition to E from Eq. (7-3)J:
(J = lU.n
an
cr.\",]T
(To = (a u o
(J'nll
U.\\"o]T
(7-11)
(7-12)
(7-13)
and
D=_E l~
I -
fl2
o
o
(7-14)
If the self-strain vector Eo is a result of a temperature change !!.T, then Eo is
given by
Eo=[a,!!.T
a,!!.T
Of
(7-15)

TWO-DIMENSIONAL STRESS ANALYSIS
293
In Eq. (7-15), at is the coefficient of thermal expansion. Note that no shear strain
is induced by a Ihermal excursion in an isotropic material. This is not the case in
anisotropic materials.
It is noted that E== is not necessarily zero and is given by
(7-16)
where E==o is taken to be a t!!1T in the case of a thermal strain. However, this strain
component need not be included in Eq. (7-3); E:: is simply determined from Eq.
(7-16) after 0"" and 0"", have been found.
Plane Strain
The material property matrix D for the case of plane strain proves to be different
from that for plane stress. For a linear, elastic isotropic material in plane strain,
the appropriate form of Hooke's law is
(2G + A)(E xx -
Exxo) + A(Eyy
A(Exx -
Exxo) + (2G + A)(Eyy
G( Ery
-
Eryo) + 0".ryo
Eyyo) + 0"xxo
Eyyo) + O"yyO
(7-17a)
(7-17b)
(7-17c)
where the shear modulus G is given by Eq. (7-9) and A is another one of the Lame
constants defined by
A =
(7-18)
If (1, E,
(10' and Eo are defined as above, it follows from Eqs, (7-17) that the
material property matrix D is given by
D
E
(I + f.L)(l
o
(7-19)
Therefore, the material property matrix for an isotropic material in plane strain is
known in terms of the material constants E and f.L.
If the initial or self-strains are a result of a temperature change !!1T, we have
EO =
[(I + f.L)at!!1T
(I + f.L)a,!!1T
(7-20)
Note the additional factor I + f.L, which was not present for the case of plane stress
[see Eq, (7-15)]. In Eq. (7-20), at is the coefficient of thermal expansion. Again
it is pointed out that the shear strains as a result of a temperature change cannot
develop in an isotropic material.

294
STRESS ANALYSIS
It should be noted that 0":: is not necessarily zero for the case of plane strain
and is given by
(7-21)
where E::o is taken to be 0., t1T in the case of a thermal strain.
This completes the determination of the constitutive relationship for the cases
of plane stress and plane strain. It is emphasized that only linear, elastic, isotropic
materials are considered here. The reader is referred to Zienkiewicz's book [21 for
the case of anisotropic materials.
The Element Stiffness Matrix
The element stiffness matrix is given by Eq. (5-87) for all problems in stress analysis
and is repeated here for convenience:
(5-87)
Both Band D are composed only of constants. Moreover, the elemental volume
dV is given by
dV = tdxdy
(7-22)
where t is the thickness of the plate for plane stress or the length of the long
prismatic member in plane strain. The thickness t is frequently taken to be unity
for the plane strain case. Therefore, Eq. (5-87) becomes
K" = BTDBJAet dx dy
(7-23)
For reasonably small elements, the thickness t may be taken as a constant average
value (perhaps the value at the centroid or the average of the three values at the
nodes). It then follows that t may be taken through the integral. We are left with
f dx dy, which is really the area A of the triangle and is given by Eq. (6-2Ie).
Therefore, the element stiffness matrix is given by
(7-24)
It should be noted that K" is a 6 x 6 matrix because BT is 6 x 3, D is 3 x 3,
and B is 3 x 6. This is consistent with the fact that there are six nodal displacements
(two at each of the three nodes of the triangle).
Example 7-1
Consider the element shown in Fig. 7-4. Determine the element stiffness matrix if
nodes i, i. k are 2, 1,3, respectively. The material is steel, which has an elastic
modulus of 30 x
106 psi and a Poisson's ratio of 0.3. The thickness may be
assumed to be 0.25 in. (constant). The nodal coordinates (in inches) are shown on
the figure. All loads (not shown) may be assumed to be in the plane of the element;
hence the plane stress case applies.

TWO-DIMENSIONAL STRESS ANALYSIS
295
(D.....
i
-----..oi0
(0.2)
(4.2)
0k
(0.0)
Figure 7-4
Element used in Example 7-1.
Solution
From Eq. (7-7), we see that we need six of the nine mij's, which are easily calculated
as shown below. The area A of the element is needed in the calculation of the m;/s
and is determined from Eq. (6-2Ie) as follows:
[I 4 2]
A = V2 det
I
0
2
= 4 in.?
100
This result checks with the value of the area from the simple formula that is given
by the product of one-half the base and height. The mij's are calculated as follows:
Yj -
Yk
YI -
Y3 = 2 -
0 = 0.25 in. -I
m21 = ~ =
2A
2(4)
Xk
-
xj
X3
-
XI = 0 -
0 = 0
m31 = ~ =
2A
2(4)
_
Yk -
Yi _
Y3 -
Y2 _ 0 -
2 _
m22 -
2A
-
2A
-
2(4)
-
-0.25 in.-
I
X
X
4 -
0
2 -
3 = __ = 0.50 in. -I
2A
2(4)
Yi -
Yj
Y2 -
YI = 2 -
2 = 0
m23 = ~ =
2A
2(4)
_
Xj
-
Xi
_
XI
-
X2
_
0 -
4 _
I
m33
-
2A
-
2A
-
2(4)
-
-0.50 in.-
It then follows that the B matrix is given by
[
0.25
0
B =
0
0
o
0.25
-0.25
o
0.50
o
0.50
-0.25
o
o
-0.50 -+]

296
STRESS ANALYSIS
The material property matrix D (for plane stress) is given by
or
D = ~[~
~
I -
fL·
o
0
o
] _ 30 X 106 [I
o
-
1
0.3
I -
fL
1 -
0.3-
--
0
2
0.3
I
o
[
33.0
9.89
D =
9.89
33.0
o
0
~
]
X 106 Ibf/in."
11.5
The reader may now verify that product BJDBrA gives the following stiffness
matrix for this element:
2.06
O! - 2.06
1.24 \
0
- 1.24
____9
~:?~__j
]:~~
=~:??__L_~_!;~_~
9 _
-2.06
1.44:
4.94
-2.68 i -2.88
1.24
1.24
-0.72 \-2.08
8.97 i
1.44
-8.25
----6-- ---=-1~44- --i-~2-.88------I.44--r---2'.88-------0--
- 1.24
0
i
1.24
- 8.25:
0
8.25
X 106 lbflin.
The symmetry of K" should be noted. The 2 x 2 submatrices, however, are not
necessarily symmetric. Partitioning the element stiffness matrix in this way greatly
facilitates the assemblage step.
•
The Element Nodal Force Vectors
Each of the five nodal force vectors given by Eqs. (5-88) to (5-92) may now be
evaluated for plane stress and plane strain problems.
Self-Strain
The element nodal force vector as a result of the self-strains is given by Eq.
(5-88), or
(7-251
where, for thermal strains. Eo is given by Eq. (7-15) for plane stress and by Eq.
(7-20) for plane strain. If we limit the present discussion to thermal strains and take
the coefficient of thermal expansion
(XI and the temperature change as constants
within an element (and hence constant Eo), then Eq. (7-25) becomes
(7-261

TWO-DIMENSIONAL STRESS ANALYSIS
297
Note that the thickness t was also assumed to be constant. Whenever a property
varies over the element, it may be evaluated at the centroid and subsequently treated
as a constant. More sophisticated integration schemes are discussed in Chapter 9.
Note that
f.~ is 6 x
I because BT is 6 x 3, Dis 3 x 3, and Eo is 3 x I. It is
emphasized that Band D are known and are given by Eqs. (7-7) and (7-14) [or
Eq. (7-19)], respectively.
Example 7-2
For the element in Example 7-1, determine the vector f.~ if the coefficient of thermal
expansion is 6.0 x 10- 6 in.lin.-oF and the temperature increases by 150°F.
Solution
First we calculate Eo from Eq. (7-15) since the plane stress case is applicable:
[
a/ 6.T]
[(6.0 x 10-
6
)(150)]
[900]
Eo =
o./06.T
=
(6.0 x Ig- 6)(l 50)
=
9~0
x 10- 6 in.zin.
Then, using the results for the Band D matrices from Example 7-1, we have
0.25
0
0
_______Q_________9________Qof). __ [330
9.89
o ][900]
f.~) =
-0.25
0
0.50
9.89
33.0
o
900 (0.25)(4.0)
0
0.50
-0.25
---- ---------- - - - ------ - - - - - ----
0
0
11.5
0
0
0
-0.50
0
-0.50
0
or
Prestresses
9,650
-------_Q_----
-9,650
19,300
-------0-----
- 19,300
Ibf
•
The element nodal force vector as a result of the prestresses a u o' a.".'o' and uno is
easily determined from Eq. (5-89) as follows:
Note that the prestresses are assumed to be constant within the element (or the
values at the centroid are used). Once again it is noted that to is of size 6 x 1.

298
STRESS ANALYSIS
Body Forces
It follows from Eq. (5-90) that the nodal force vector as a result of the body forces
b; and b; is given by
Nj
0
o
Nj
-N
k-----6---
o
Nk
(7-28)
Noting that each shape function is given by its respective area coordinate [see Eqs.
(6-25)], it follows that
fi,=
f Lib,t dx dy
f Lib,t dx dy
·--T(b~idX-;[y----
f Ljbyt dx dy
--7i;bid;dy----
f Lkb,t dx dy
(7-29)
Integrating each term with the help of the integration formula given by Eq. (6-49)
gives the very simple (and expected) result below. A typical term is evaluated in
the following manner:
The complete result is given by
tA
fb =-3
b,
b;
---b,---
by
.---6;---
b,
(7-30)
which says, in effect, that the body forces in the x and y directions are allocated
equally to each node. This would not necessarily be the case if b., b., or t were
not constant within the element.

TWO-DIMENSIONAL STRESS ANALYSIS
299
Surface Tractions
(7-32)
(7-31)
The element nodal force vector as a result of the surface tractions Sx and s"as given
by Eq. (5-91) may be evaluated by first noting that
-
N;
0
o
N;
---~----o---
Is-
O
Nj
--N;----(j---
o
Nk
Note that the integrals are to be evaluated around the element boundaries (in a
counterclockwise direction) as denoted by the integration limit S". As we have seen
in the examples presented thus far, the evaluation of such integrals for elements
totally within the body never contributes to the assemblage nodal force vector. In
this case, each internal force is equal and opposite on adjacent sides of the element,
therefore, the net contribution of these internal forces to the assemblage nodal force
vector is zero.
Figure 7-5(a) shows an element e with nodes i and j (but not k) on the global
boundary. A surface traction is assumed to act on leg ij. Let us denote the length
of this leg as Ii). The integral may be evaluated rather easily if the shape functions
are written in terms of the area coordinates [see Eq. (6-25») and if dS is replaced
by t dl, Inaddition, on leg ij, we have Nk = Lk = 0, and hence Eq. (7-31) becomes
flij L;sxt dl
flij L;syt dl
--·j~jTj-;:idr-
fl'j Ljsyt dl
--------(j-----_.-
o
Variable
surface traction
'-------_x
Global
boundary
(a)
(b)
Figure 7-5
(a) Portion of the global boundary showing a surface traction on leg lj of
element e and (b) a variable surface traction.

300
STRESS ANALYSIS
With the help of the integral formula for the length coordinates [i.e., Eq. (6-48)],
and assuming Sl' S"
and t to be constant over leg ij, the nodal force vector as a
result of the surface tractions becomes
s,
Sy
Sx
S"
---0--
o
for leg ij on the global boundary
/7-33)
Expressions may be derived in a similar fashion, or set up by inspection if leg jk
or ki happen to be on the portion of the global boundary over which a surface
traction acts. If the surface traction is distributed as shown in Fig. 7-5(b), the
integrals in Eq. (7-32) could be evaluated as illustrated in the problems or a numerical
integration method from Chapter 9 may be used.
Example 7-3
Reconsider the element in Example 7-1. A distributed surface traction acts on the
leg connecting nodes I and 3 (local nodesj and k), as shown in Fig. 7-6. Determine
the corresponding element nodal force vector.
Solution
First, we need to determine s, and S,. Since the traction is directed only in the x
direction, we have s, = O. The surface traction s, is not constant over leg jk and,
therefore, the effective s, is taken to be the average of 1600 and 2000 lbf/in.", or
s, =
1800 lbf/in.", Noting that legjk (and not leg ij) in this case is on the global
boundary, we write the following using Eq. (7-33) as a general guide:
0
0
0
0
0
0
r,:
tIj k
Sx
(0.25)(2)
1800
450
Ibf
2
__ ~.L__
2
0
---_Q_---
SX
1800
450
Sv
0
0
""1/70
2000 Ibf/in. 20
Figure 7-6
Element with imposed surface traction for Example 7-3.

TWO-DIMENSIONAL STRESS ANALYSIS
301
Because an average value for the surface traction is used, the allocation to nodes
I and 3 is equal.
•
Point Loads
The nodal force vector as a result of a point load (PL) at (xo,Yo) is given by Eq.
(5-92), or
N;
0
o
Ni
L-~----O---
o
Nj
-N~----O--
o
Nk
Ni(xo,Yo)fpx
N;(xo,Yol!p,
--N;<x~~y~rt~--
N/xo,Yol!p,
--N:(x~-,-y~Yt:--
Nk(xo,Yol!p,
(7-34)
where t; and .f", are the magnitudes of the point load in the x and Y directions,
respectively. Note that if the point load is applied at, e.g., node i, then the cor-
responding shape function (Ni ) is unity and the others are zero, thus giving the
obvious intuitive result. Although the summation sign has been dropped above, it
is implied. In other words, each point load acting within an element has a corre-
sponding nodal force vector as given above. Given the coordinates of the point of
application of the point load [i.e., (XIl>YO)], we can determine the element in which
the load occurs by evaluating Ni , Ni , and N, at (xo,Yo). When all three shape
functions yield values between zero and unity (i.e., nonnegative and less than one),
the element containing the point load is found.
Example 7-4
A point load acts at (0.6, 1.6) for the element in Example 7-1. The x and Y
components of the point load are + 1500 and - 2300 lbf, respectively. Determine
the corresponding nodal force vector.
Solution
The shape functions are given by Eqs. (6-21). Since they make use of all nine of
the mi;'s, we must compute mil' m12' and ml.' (which were not needed in Example
7-1 ):
XiYk
-
XLV,
XIY.1
-
X.1YI
(0)(0)
-
(0)(2)
mil
2A
2A
0
2(4)
XLVi
-
x.v;
X1Y2
-
X2Y.1
(0)(4)
-
(4)(0)
ml2
2A
2A
0
2(4)
x.», - s.».
X2YI
-
XIY2
(4)(2)
-
(0)(2)
ml.l
2A
2A
2(4)

t'f,L =
302
STRESS ANALYSIS
Therefore, the shape functions may be evaluated at x = 0.6 and y = 1.6 as follows:
N, = 0 + (0.25)(0.6) + (0)( 1.6) = 0.15
Nj = 0 + (- 0.25)(0.6) + (0.50)( 1.6) = 0.65
Nk = I + (0)(0.6) + (- 0.50)( 1.6) = 0.20
Note that the sum of the three shape functions is unity as expected. It follows from
Eq. (7-34) that fV.L is given by
(0.15)(1500)
225 J
___(~~!?)L~_?_~<!9L_
_
-=-_~~_~. _
(0.65)(1500)
975 J
(0.65)( - 2300)
- 1495
___(Q}QK!~Q<!L___
_
}9Q _
(0.20)( - 2300)
- 460
Note that most of the point load is allocated to the node j (global node number I)
because this node is the closest to the point load. In a similar fashion, node i (global
node number 2) receives the lowest allocation since it is farthest from the point
~.
.
Composite Nodal Force Vector
The reader is reminded that the contributions from each of the nodal force vectors
for a given element must be combined according to Eq. (5-86), which is repeated
here for convenience:
(5·161
The vector f" (without subscripts) may be referred to as the composite nodal force
vector. We are now in a position to discuss the assemblage step.
Assemblage Step
The assemblage of the element stiffness matrices K" and the composite nodal force
vector fe follows the standard procedure illustrated in Chapters 3 and 4. Example
7-5 should help to clarify further the basic idea.
Example 7-5
Consider the mesh shown in Fig. 7-7, which contains only two elements. The
elements are defined in terms of the global node numbers, as indicated below the

lWO-DiMENSIONAL STRESS ..NALYSIS
383
CDr------~0
CD
Element number
Node;
Nodej
2
1
3
4
Node k
3
2
K"
Figure 7·7
Mesh used in Example 7-5.
mesh. The 6 x 6 element stiffness matrices for the two elements may be written
symbolically in terms of nine 2 x 2 submatrices as follows:
[
K (ll ! K(\)
: KIll]
22
I
21:
23
K(\l =
-~~1rf-~~1!~~~~~1~~~'
32:
31:
33
!
I
and
SK
(2)
: K(2l
: K(2l]
33:
34!
32
K(2) =
-K~~--r-K~~' TK~~--
-------.;- -..-----------_.
K(2)
I K(2l
: K(2l
23
:
24:
22
Show the assemblage stiffness matrix in terms of the 2 x 2 submatrices.
Solution
The assemblage stiffness matrix K" is of size' 8 x 8 and is given by
K (\ l
:
K(ll
:
K(I)
: O!
tI:
12
:
13
:
-j(C)j---r--K'ii-+-Kc2)"---:---j{cij-.+--K<2j--l---j(ii
2 )
:
22
22:
23
23:
24
----.----j-------------------.-------------------j-------
K()
,
K(I) + K(2)
,
K(\) + K(2 l
,
K(2 l
___~~
L
}}
J3 J
~~
~~
1
)_~
0:
K~~)
:
K~~
:
K~~
I
I
1_
Although it is not obvious from this result, the assemblage stiffness matrix is
symmetric. Moreover, it is banded, although the bandedness is not too obvious
because only two elements were considered here. It should be recalled that the
assemblage stiffness matrix K" is zeroed-out before the element stiffness matrix
for the first element is added into it.
•

304
STRESS ANALYSIS
Example 7-6
Reconsider the mesh given in Example 7-5. The 6 x I composite nodal force
vectors for both elements may be written symbolically in terms of three 2 x
I
subvectors as follows:
[
f\111
r-r
21
]
r" ~
-:~~:~J
"d
r" ~ l~~~-
Show the assemblage nodal force vector in terms of the 2 x
I subvectors.
Solution
The assemblage nodal force vector is of size 8 x
I and is given by
r- ~ tg~~~~fJ
In the two previous examples, the mesh was comprised of only two elements. In
general, the assemblage step is performed for every element. This results in an
assemblage stiffness matrix and an assemblage nodal force vector of sizes 2N x
2N and 2N x
I, respectively, where N is the number of nodes used in the entire
mesh. The reader is reminded that the half-bandwidth of K" is given by Eq. (3-
33). Like the assemblage stiffness matrix, the assemblage nodal force vector is
zeroed-out before the nodal force vector for the first element is added into it.
•
Prescribed Displacements
The prescribed displacements are imposed according to either of the two methods
illustrated in Sec. 3-2. Method I is preferred because it results in a hetter conditioned
stiffness matrix in large problems. After application of the prescribed displacements,
the system of equations to be solved is given by
Ka = f
It should be recalled that the vector a is defined by
a =
(u l
VI
!
U2
V2 i .. , !
UN
VNV
(7-35)
(7-36)
where u, and Vi are the displacements in the x and y directions at node i, and where
N is the maximum number of nodes used.

TWO-DIMENSIONAL STRESS ANALYSIS
305
Solution for the Nodal Displacements
Before application of the prescribed displacements, K" is singular and does not
possess an inverse. After the proper application of the prescribed displacements,
K is nonsingular for well-posed problems. Thus, a unique solution for the nodal
displacements is ensured. Subroutine ACTCOL from Sec. 6-8 may be used quite
effectively to obtain the solution. It should be recalled that the subroutine utilizes
a three-step procedure: triangular decomposition, forward elimination, and back-
ward substitution.
The Element Resultants
Let us now indicate how we could obtain the strains and stresses within a typical
element once the nodal displacements in the vector a have been found. Recall that
the strains within the region are related to the nodal displacements on an element
basis by
E = Ba'
(5-77)
Since both the matrix B for any element e and a" are known (because a is known),
it is clear that Eq. (5-77) can be used to determine the strains (En' E"", and E.n,)
within element e. It should be noted that the resulting strains are really averages
for the element and are generally associated with the centroid of the element. In
terms of the m,/s[defined by Eqs. (6-21)J and the now known nodal displacements,
the average strains (denoted by E.n, E,.", and En) within element e are given explicitly
by
m2l ui + m22 ui +
m2J uk
mJ1vi +
mJ2 vi + mJ3 vk
mJ1ui + m21vi + mJ2 ui + mnvi + m 3Juk + m23 vk
(7-37a)
(7-37b)
(7-37c)
The average stresses (0'1'<' 0'"", and 0',,.) within element e may be evaluated from
(j' = D[Ba" -
Eol + (10
(7-38)
where each matrix or vector on the right-hand side is known. These average stresses
are also generally associated with the centroid of the element. It should be recalled
that in the case of plane stress, the strains in the z direction are not necessarily zero
and can be computed from Eq. (7-16). Similarly, in the case of plane strain, the
stresses in the z direction are not necessarily zero and may be determined from Eq.
(7-21). Like the other stresses and strains, these too are average values and are
usually associated with the centroid.

J06
STRESS ANALYSIS
Remarks
The displacement function for the three-node triangle was taken to be linear [see
Eq. (6-16a»). Hence, the displacements are assumed to vary linearly within each
element. The strains and stresses, on the other hand, being related to the derivatives
of the displacements, must then be constant. Hence, this element is often referred
to as the constant strain triangle.
Although the expressions for the finite element characteristics have been eval-
uated for the triangular element, the reader should have little difficulty in extending
this development to the rectangular element. In Chapter 9, other, more powerful,
two-dimensional elements are introduced.
7-3
AXISYMMETRIC STRESS ANALYSIS
In this section, the axisymmetric stress model is defined. The finite element char-
acteristics are derived from Eqs. (5-87) to (5-92) for the case of the axisymmetric
triangular element. Each of the basic steps in the FEM formulation and solution is
discussed.
Definitions
An axisymmetric problem in stress analysis represents another example in which
a three-dimensional problem may be idealized as a two-dimensional problem. Such
problems must meet the two basic conditions delineated in Sec. 6-6. It should
further be recalled that these problems lend themselves to a cylindrical coordinate
system with coordinates (r,8,z) as opposed to a cartesian (x,y,z) system. However,
because of the axisymmetry, the 8 coordinate need not be included. In other words,
the geometry, material properties, loadings, etc., may be a function of rand z only
(and not a function of 8). For example, in Fig. 7-8, note how the line load acts in
an axisymmetricmanner about the z axis. The displacements in the rand z directions
are denoted by u and v, respectively. In this section, the triangular element discussed
in Sec. 6-6 is used for illustrative purposes. The element is really a triangular donut
or toroid with the nodes being represented as circles formed about the z axis, as
shown in Fig. 7-9.
The Strain-Displacement Relationship
A fundamental difference exists between axisymmetric stress analysis and that of
plane stress and plane strain; namely, a fourth component of the strain Eau (and
hence stress <Taa) must be explicitly considered in addition to the other three strains,
Err> Ezz , and Erz (and stresses, <Tn'
<T", and
<Tr,). The circumferential strain at a

AXISYMMETRIC STRESS ANALYSIS
307
Figure 7-8
Axisymmetric body with an axisymmetric line load.
point within the axisymmetric body is caused by the radial displacement u at this
same point. Therefore, the strain vector E has four components and is defined by
(7-39)
(7-40a)
These strains are related to the radial displacement u and the axial displacement v
by the following strain-displacement relationships [3):
au
E.rr
=
iJr
Figure 7-9
Axisymmetric body showing the axisymmetric triangular element (i.e., a tri-
angular toroid).

308
STRESS ANALYSIS
u
Eee
r
dl'
E__
dZ
dV
+-
dr
(7-40b)
(7-40c)
(7-40d)
Defining the displacement field vector u by u
(7-40) in a very compact form as
E = Lu
where the linear operator matrix L is defined by
d
0
fJr
L
0
r
d
0
fJz
d
d
fJz
fJr
[u
vjT, we may write Eqs.
(7-41)
(7-42)
The Shape Function and Strain-Nodal Displacement Matrices
Let us define the nodal displacement vector a" by
(5-59)
since each of the three nodes i, j, k has two components of displacement. It follows
from Sec. 5-6 that the shape function matrix is given by
(5-61)
where the shape functions themselves are given by Eqs. (6-21) with x and y replaced
by rand z, respectively. Hence, the displacement field vector u may be related to
the nodal displacement vector a" in the usual manner:
u = Na"
(7-43)

It then follows from E
Lu
AXISYMMETRIC STRESS ANALYSIS
309
LNa" = Ba" that
aN;
0
aN;
0
aNk
0
ar
ar
ar
N;
0
N;
0
Nk
0
r
r
r
B
LN
0
aN;
0
aN}
0
aNk
az
az
az
aN;
aN;
aN;
aN;
aNk
aNk
az
ar
az
ar
az
ar
whereupon computing the derivatives we get
m21
0
m22
0
m23
0
N;
0
!'!L
0
Nk
0
r
r
r
B
0
0
0
m31
m32
m33
m31
m21
m32
m 22
m33
m23
(7-44)
(7-45)
Note that Nitr , N;lr, and Nk/r are not constant but rather are functions of rand z.
Nevertheless, the shape function matrix N and the strain-nodal displacement matrix
B are both determined.
The Constitutive Relationship
As mentioned earlier, four stress components need to be considered. Hence, let us
define
(7-46)
Note the addition of the stress <Tee, which acts in the e direction (i.e., circumfer-
entially). This definition is consistent with that given for the strain vector E in Eq.
(7-39). Restricting the present discussion to isotropic materials only and assuming
the self-strain is a result of a temperature change t:.T, we define
(7-47)
where at is the coefficient of thermal expansion. Note that a thermal shear strain
cannot exist in an isotropic material. Let us also define the residual stress vector
as
[(J'rrn
(J'eeo
a;:;:o
(J"r.:o]T
(7-48)

310
STRESS ANALYSIS
For a linear, elastic material, the constitutive equation is given by Eq. (5-24), or
(1 = D(E -
Eo) + (10
(5-24)
Zienkiewicz (4] gives the corresponding material property matrix (for an isotropic
material) as
E
[I
D-------
(I + J.L)(I -
2J.L)
-
J.L
J.L
J.Lo
J.L
J.L
o
o
~J
(7-49)
where E and J.L are the modulus of elasticity and Poisson's ratio, respectively. The
material property matrix is seen once again to be symmetric.
The Element Stiffness Matrix
The general expression for the stiffness matrix is given by Eq. (5-87). If we substitute
21Tr dr dz for the elemental volume dV, we get
x- = Jv"BTDB dV = 21T JA"BTDBr dr dz
(7-50)
Note that the volume integration reduces to an integration over the cross-sectional
area of the triangular donut. In other words, we must evaluate the latter integral as
an area integral. In effect, the half-plane of the body has been discretized with a
number of triangular elements as shown in Fig. 7-10.
/
Figure 7-10
Axisymmetric body discretized into a number of three-node triangular ele-
ments.

AXISYMMETRIC STRESS ANALYSIS
311
The area integral to be evaluated in Eq. (7-50) is not as simple as the plane
stress or plane strain counterpart because the integrand is now a function of rand
z. The integration in this case is no longer trivial. At this point we could revert to
quadrature or numerical integration to evaluate the area integral in Eq. (7-50), as
explained in Chapter 9. However, let us evaluate the integral approximately by
evaluating the integrand at the centroid of the triangle and then treating Band r as
though they were constants. The coordinates of the area centroid are denoted by r
and 2 and are given in terms of the nodal coordinates by
r, + r, + r,
r =
.I
3
and
z, + Z + Zk
Z
.I
3
(7-51)
(7-52)
The resulting B matrix is denoted as B, where B = B(r,2), denotes that B is
evaluated at the coordinates of the centroid rand 2. Therefore, Eq. (7-50) may be
written as
x- = 21rIVDBr fAedr dz
Clearly, the remaining integral is simply the area A of the triangle given by Eq.
(6-2Ie) with rand z replacing x and y, respectively. The resulting element stiffness
matrix is given by
(7-53)
Note that K" is of size 6 x 6 and is symmetric. The matrix and scalar multiplications
in Eq. (7-53) would actually be performed in a computer program by calls to
appropriate subroutines.
This simple approach is known to give convergent and valid results if it gives
the exact value for the volume. For example, the volume of a triangular toroid is
given exactly by 21rrA, which is what this approximate integration method yields.
Therefore, this approximate integration method is guaranteed to give good results.
The accuracy deteriorates as the elements increase in size.
The Nodal Force Vectors
Useful expressions for each of the five nodal force vectors are now derived for
axisymmetric stress analysis performed with the three-node triangular element.
Self-Strain
The nodal force vector as a result of the self-strain is given by Eq. (5-88) and may
be evaluated here by first noting that
eo = f veBTDEo dV = 21rfAeBTDEor dr dz
(7-54)

312
STRESS ANALYSIS
where the integrand is seen once again to be a function of rand z (because B is
actually a function of rand z). Let us, therefore, take the approximate approach
first by evaluating the integrand at the coordinates of the centroid (1')) and then
by treating the integrand as a constant to give
(7-55)
where B
B(r,z), as in the evaluation of the stiffness matrix. This nodal force
vector is of size 6 X I as expected. If the self-strain is due to a temperature change,
then we simply use Eq. (7-47), which explicitly includes the coefficient of thermal
expansion a, and the temperature change 6.T. If 6.T varies over the element in
question, then the value at the centroid may be used and thus treated as a constant.
This simple approach is consistent with the approximation made above.
Residual Stresses
The element nodal force vector as a result of the residual stresses is determined in
the following manner beginning with Eq. (5-89):
1;." = f v-BT0'0 dV = 2TIf AeBTO'or dr dz = 2TIIFO'orA
(7-56)
where 0'0 is given by Eq. (7-48). If the element in question is not under a prestress,
then 0'0 is simply taken to be zero.
Body Forces
The body forces per unit volume in the radial and axial directions are denoted as
b, and b, respectively. The corresponding nodal force vector is evaluated by starting
with Eq. (5-90) and noting that
fb = f v-NTb av = 2'rrf AeNTb r dr dz
(7-57)
where the body force vector b is defined by
(7-58)
for this axisymmetric analysis. Recall that N is a function of rand z. If the body
forces are assumed to be constant over the element in question and the integrand
is evaluated at rand z, then Eq. (7-57) may be evaluated to give
br
b,
2'rrrA
b.
fb
r
(7-59)
3
bz
br
b,
Thus it is seen that one-third of the body force in each direction is allocated to
each node. This result should be intuitively obvious since b, and b, were assumed
to be constant.

AXISYMMETRIC STRESS ANALYSIS
313
If the axisymmetric body is oriented such that the z axis is collinear with
direction of gravity, then b, = PI? may be used, where P is the mass density and
g is the acceleration due to gravity. If the body is rotating at an angular speed w
about the z axis, then we may take b, = prw2. In this case, b, is seen to be a
function of r and we may, in effect, use b, = prw2.
Surface Tractions
The integral representing the nodal force vector as a result of the surface tractions
is not a volume integral, but rather a surface integral. Equation (5-91) provides the
starting point, which may be rewritten in terms of the elemental surface area on
the boundary of the element as
~ = fseNTS dS = 21T flNTsr dl
(7-60)
where s is defined in terms of the surface tractions s, and S: by
s = [sr
s:f
(7-61)
and dl is the elemental length around the boundary of the element. If the leg of the
triangular element in question is internal and not on the global boundary, then the
corresponding nodal force vector as a result of the internal loads do not contribute
to the assemblage nodal force vector. The reader will recall that these internal
surface tractions are always equal and opposite and, hence, contribute nothing to
the assemblage nodal force vector. In other words, only those legs on the global
boundary over which surface tractions are imposed need to be considered.
For example, consider leg ij for the element shown in Fig. 7-11. One way to
evaluate the integral in Eq. (7-60) is to evaluate the integrand at the midpoint of
Surface
traction
Figure 7-11
Typical triangular element with leg ij on the global boundary on which a
surface traction is imposed. Note: The surface traction must be axisymmetric.

314
STRESS ANALYSIS
leg ij and then treat the integrand as a constant. Let us define rii as the radial
coordinate at the point halfway between nodes i and j. Let us also note that N, is
zero on leg ij. With these assumptions. it can be shown that Eq. (7-60) simplifies
to
5,/2
__!I!:.__
5,/2
---~~~~-­
o
o
for leg ij on the global boundary
(7-62)
where lij is the length of leg ij. A more sophisticated way of evaluating this integral
is illustrated in the problems where the special integration formula [see Eq. (6-48))
involving length coordinates is used to simplify the integration. The reader should
be able to write, by inspection. the expression for ~ when leg jk or ki is on the
global boundary.
It is interesting to note that if a body of revolution is loaded in a nonaxisymmetric
manner. it may still be possible to perform an axisymmetric analysis by using a
one-term Fourier series of sine and cosine functions to represent the loads and the
displacements. The loads, however, must still be symmetric about a plane through
the z axis. An example of such a case would be the wind load on a circular smoke
stack. Huebner [5) and Wilson [6) give further details. Treatment of this situation
is beyond the scope of this text.
Line Loads
For axisymmetric bodies the so-called point loads are actually line loads around
the circumference of the body as shown in Fig. 7-8. It is customary to define the
line load in the radial and axial directions on a per unit circumference basis. Let
us define the line load per unit circumference in the radial and axial directions as
F, and F:, respectively. The equivalent point loads are then given by
(7-63a)
and
(7-63b)
Let us also assume the load acts at coordinates (ro,zo). Beginning with Eq. (5-92).
we can write
Ni(ro.zo)
0
o
Ni(ro,zo)
-- ----- ----------------------
L:
N,(ro. zo)
0
_______~
!'!L~::L·_~~!__
Nk(ro.z o)
0
o
Nk(ro.zo)
(7-64)

(7-65)
AXISYMMETRIC STRESS ANALYSIS
315
If leg ij is the leg on which the load acts as shown in Fig. 7-12, then Nk(ro,zo) is
identically zero, and the nodal force vector as a result of a line load is given by
Ni(ro,zo)Fr
Ni(ro,zo)Fz
------------------
Nj(ro,zo)Fr
-N;(ro,zo)F,
------------------
o
o
In Eq. (7-65) the summation sign has been dropped because it is understood
that all line load contributions would be added in the usual manner. Similar expres-
sions can be set up by inspection if leg jk or ki is on the global boundary. It should
be obvious that the shape functions in Eq. (7-65) allocate the intuitively expected
amounts of 2TIroFr and 2TIroF, to each of the nodes. For example, if leg ij is on
the global boundary and if the line load acts one-third of the distance from node i
to node j, then Eq. (7-65) would give
fk = 2TIrO[¥3Fr
¥3Fz [
Y3Fr
I!JFz i 0
Or
as expected. In these cases, however, the stress distribution in the immediate vicinity
of the load would be very poorly represented unless hundreds of tiny elements were
used in this region. It is generally recommended that nodes be placed at the locations
of these line loads for improved accuracy. In this case, Eq. (7-65) still gives the
correct result.
Remarks
The assemblage of the element stiffness matrices and nodal force vectors is per-
formed in the usual manner. The discussion on the assemblage step in Sec. 7-2 is
Figure 7-12
Typical triangular element with leg ij on the global boundary on which an
axisymmetric line load is applied.

316
STRESS ANALYSIS
applicable here as well. Again Method I is recommended for the application of the
prescribed displacements. Finally, the resulting system of equations embodied in
Ka = f may be solved with the help of subroutine ACTCOL, as explained in Sec.
6-8. Thus, the nodal displacements for every node are known and may be used to
obtain the element strains and stresses'as follows. The average strains within an
element may be computed with the help of E = HaC or
and the average stresses from
(j'
E = Rae
D(Ba" -
Eo) + (10
(7-66)
(7-67)
These average stresses and strains are generally associated with the centroid of the
element.
7-4
THREE-DIMENSIONAL STRESS ANALYSIS
Three-dimensional stress analysis encompasses all practical structural engineering
problems since no approximations or simplifying assumptions are inherently made.
The price paid for this generality is that of much larger computer storage require-
ments and obviously longer computational times, as shown in Table 7-1 where two
problems are compared. Note that the computational time is roughly proportional
to the number of unknowns and to the square of the half-bandwidth. Table 7-1
illustrates the enormity of the three-dimensional problem and has motivated the
development of higher-order (distorted) elements, some of which are presented in
Chapter 9.
The simplest three-dimensional element is the four-node tetrahedral element
with nodes i, J, k, m as shown in Fig. 7-13. The finite element formulation of
Table 7-1
Comparison of Computational Times for Typical Two- and
Three-dimensional Problems*
Number of nodes
Number of equations (and un-
knowns)
Variables in bandwidth
Relative computational time
Two-dimensional
problem
30 x 30 = 900
2 x 900
=
1800
2 x 30 = 60
I unit
Three-dimensional
problem
30 x 30 x 30 =
27.000
3 x 27.000 = 81.000
3 x 30 x 30 =
2700
90.000 units
'The computational time is roughly proportional to the number of unknowns and to the square of the
half-bandwidth.

THREE-DIMENSIONAL STRESS ANALYSIS
317
III
k
Figure 7-13
The four-node tetrahedral element.
problems in three-dimensional stress analysis is illustrated quite well with this
element. Recall from Sec. 6-5 that two rules must be followed when specifying
which nodes are associated with a particular element. The reader may want to
review the pertinent material in Sec. 6-5 in general and Example 6-5 in particular.
If the reader understands the basic approach taken here, little difficulty will be
encountered if an alternate formulation in terms of the eight-node brick is desired.
The integrations in this case would be best performed numerically as illustrated in
Chapter 9, where other, more practical, elements are introduced.
The Strain-Displacement Relationship
The strain-displacement or kinematic relationship for small deformations in three
dimensions was given by Eq. (5-15) and is repeated here for easy reference:
au
av
aw
E.\"X
En
-
E::
aX
ay
az
(5-15)
au
av
av
aw
aw
au
Ex.\'
+
E\":
+
Ezx
+
ay
ax
az
ay
ax
az
where u, v, and ware the displacements in the x, y, and z directions, respectively.
Let us define the displacement field vector u as
u = [u
v wf
and the strain vector as
Equation (5-15) may then be written in the usual compact form E
(5-69)
(5-26)
Lu, where

318
STRESS ANALYSIS
a
0
0
ax
a
0
0
ay
a
L
0
0
az
(7-68)
a
a
0
ay
ax
a
a
0
-
az
ay
a
a
0
az
ax
The Shape Function and Strain-Nodal Displacement Matrices
Let us define the nodal displacement vector a" as follows:
since each of the four nodes i. i. k, m has three components of displacement. It
follows from Sec. 5-6 that the shape function matrix N is given by
[
Ni
0
0
N =
0
N j
0
o
0
N j
o
0
iNk
N;
0 I 0
o
N; i 0
~ I~n
Nk ! 0
o
0 ]
Nm
0
o
N,"
(5-72)
where the shape functions themselves are given by Eqs. (6-40). It then follows that
the displacement field vector u is related to the nodal displacmeent vector a" in the
usual manner by
u = Na"
(7-69)
and from B = LN that
[mi'
0
0
, mn
0
0 .
0
0
0
0
"~]
0
:
m~.,
:
m2~
0
mll
0
0
0
m]!
0 ! 0
1n].1
0
:
0
m,4
0,
0
m., . 0
0
m4~ ! 0
0
Jn4 1 ! 0
0
B
,
(7-70)
,
0
,
0
0
mll
m?1
0
In,?
1n 2:.
:
m,~
1n21
:
111'14
Jn2A
0
0
m4 1
mll
0
0
m4 2
In,:'. ! 0
In ...]
m" ! 0
m44
Jnq
.,
m4 1
0
1n 21 , m4 2
0
In:.:.
0
0
,
I
m4~
1n2,'
I moW
Jn24
where the m;;'s are known for any given element and may be computed from Eq.
(6-40e). Clearly, the strain-nodal displacement matrix B is known for any given
element.

THREE-DIMENSIONAL STRESS ANALYSIS
319
The Constitutive Relationship
Assuming a linear, elastic material, we can write the stress-strain relationship in
the usual form:
(1 =
D(E -
Eo) + (10
where in this case, in addition to E from Ego (5-26), we define
(1
[ O"xx
ITy."
O"z:
(Jxy
cry:
O"z.,]T
Eo
[ Exxo
E.,·yO
E.::o
E._no
EyzO
Ezxo]T
(10
[ O"no
(1'''''0
(J==0
U xyo
(JyzO
O"zxo] T
(5-24)
(5-25)
(5-27)
(5-28)
The corresponding material property matrix for linear. elastic isotropic materials is
given by Zienkiewicz [7] as
-
fJ.
fJ.
fJ.
0
0
0
fJ.
-
fJ.
fJ.
0
0
0
fJ.
fJ.
-
fJ.
0
0
0
(7-71)
E
~
0
D=
0
0
0
0
(1 + fJ.)(l -
2fJ.)
2
0
0
0
0
~
0
2
0
0
0
0
0
I -
2fJ.
2
If the self-strains EO stem from a temperature change t:J.T, then we have
Eo = [a, t:J.T
a,t:J.T
aT t:J.T
0
0
Of
(7-72)
where «, is the coefficient of thermal expansion for the material comprising the
element. Once again it is noted that only normal strains are induced by a temperature
change in an isotropic material.
The Element Stiffness Matrix
Starting with Ego (5-87) and recognizing that Band D are constant, we get
(7-73)
where V, the volume of the tetrahedron, is given by Ego (6-400 and is a function
of the nodal coordinates only
0 For the four-node tetrahedral element, the element
stiffness matrix is of size 12 x 12 and is symmetric 0

320
STRESS ANALYSIS
The Element Nodal Force Vectors
The element nodal force vector as a result of the self-strains is easily determined
from Eq. (5-88):
(7-74)
If the self-strain is due to a temperature change I1T in a material with a coefficient
of thermal expansion UI' then Eq. (7-72) should be used for Eo' This element nodal
force vector is of size 12 x
I since the element has four nodes and three degrees
of freedom per node.
The clement nodal force vector as a result of the prestresses is computed from
Eq, (5-89) to give
(7-75)
which also is of size 12 x
I.
The element nodal force vector as a result of the body forces is computed by
starting with Eq. (5-90). Writing the shape functions in terms of the volume co-
ordinates and integrating the result with the help of Eq, (6-50), we get
f v-NTb dV = f v-
L;
0
0
o
L,
0
o
0
L;
----- - - - --- - - ------
Lj
0
0
o
Lj
0
o
0
Lj
-~--_··O---··(f-
o
Lk
0
o
0
Lk
Lm
0
0
-- -----------------
o
t.;
0
o
0
t.;
b,
b.
b,
b,
b;
V
b,
4
-b~-
b;
b,
b,
by
b,
(7-76)
Note that jhe body forces per unit volume tb ;
b.
and b,) were assumed to be
constant. As expected, one-fourth of b, is allocated to the .r degrees of freedom of
each of the four nodes, etc.
The nodal force vector as a result of the surface tractions needs to be evaluated
for only those clements that have one or more faces on the global boundary.
Moreover, only those exposed faces with imposed surface tractions acting on them
need to be considered. For example, consider the tetrahedron shown in Fig. 7-14,
which is assumed to have face ijk on the global boundary and an imposed surface

THREE-DIMENSIONAL STRESS ANALYSIS
321
y
j'.:
Face iik on
global boundary
,L.-------.....x
Figure 7-14
Tetrahedral element with face ijk on the global boundary with an imposed
surface traction.
traction with components s" s"
and s.. On this face Nm is identically zero, and
Eq. (5-91) simplifies to
Nj
0
0
o
N j
0
----------------
o
0
N;
Nj
0
0
o
Nj
0
-~,--+---~',m
dA
o
s,
0
o
0
Nk
._-------------_.
000
000
000
Njs,
Njs"
N;sz
Njsx
Njsy
_!'!i!!__
dA
Nksx
Nksy
s,»,
o
o
o
(7-77)
where AUk is the area of the triangle ijk that comprises face ijk of the tetrahedron.
Equation (7-77) may be integrated with the help of the integration formula for area
coordinates [Eq. (6-49)J providing the shape functions are written in terms of the
area coordinates [see Eq. (6-25)J to give the intuitively obvious result
_
AUk
:
:
:
T
ff - :3 [s,
Sy
Sz
:
s,
Sy
s,
:
Sx
Sy
s,
:
0
0
OJ
(7-78)
If any of the remaining three faces were on the global boundary, the corresponding
nodal force vector could easily be set up using Eq. 0-78) as a guide.
The element nodal force vector as a result of a point load may be computed
from Eq, (5-92) as follows. First, note that the external load must necessarily act

322
STRESS ANALYSIS
on one of the four faces of the tetrahedron (or at a node), but only if the face (or
node) is on the global boundary. For example, consider a point load acting some-
where on face ijk of the tetrahedral element in Fig. 7-14. Let the location of the
point load be represented by the coordinates (xo,yo,zo). Obviously, N",(xo,yo,zo)
is identically zero on this face. Therefore, in this case Eq. (5-92) reduces to
N,
0
0
N,(xo,Yo' zo)f;,,
0
N,
0
N,(xo,yo,zo).I;"
0
0
N,
N,(xo,yo,zo).I;,
._-------------
-N;Ct(~~~,~)-,-;;ff~,~-
N,
0
0
0
Ni
0
N,(xo,yo,zo).I;"
ff.L
~NTfp
0
0
N, [1,:]
_
!~J5~:'(~ :.~!!_,_z~~!J.'__
'u.:«:«
.I",
Nk(xo,Yo, zo).I;"
(7-79)
0
Nk
0
f;,
Nk(xo,yo,zo).I;"
0
0
Nk
._~k_(~:'(~:·~9:_z!~)!!,_.
-------------- ~
0
o
0
0
0
0
0
0
0
0
0
x=xo
0
-"=Yn
: =:0
Similar expressions for fl',L can be set up by inspection if the point load acts on any
of the other three faces.
Remarks
The assemblage, application of prescribed displacements, and solution of Ka = f
yield the three nodal displacements for every node. These displacements may be
used to obtain strains and stresses for any element e from
and
£ = Ba"
U' = D(Bae
-
Eo) + (10
(7-80)
(7-81)
These strains and stresses are average values for the element and are usually as-
sociated with the volume centroid of the tetrahedron. Principal stresses can be
computed with the help of Eqs, (5-12).
7-5
BEAMS
The finite element characteristics for the beam element based on the elementary
theory of beams are derived in this section. This particular model proves to be very

BEAMS
323
useful when statically indeterminate beams are encountered, although the model is
equally applicable to the statically determinate case. It should be pointed out that
in some cases the plane stress finite element characteristics may be used to model
certain types of beams with greater accuracy and detail than the elementary theory
can provide. For example, if a thin flat plate is cantilevered and loaded as shown
in Fig. 7-15, a rather detailed two-dimensional stress distribution may be found
within the beam using the plane stress formulation described in Sec. 7-2. In Fig.
7-15, the point loads PI' P2, and P3 and the distributed load p(x) must act in the
plane of the plate for the plane stress model to be valid.
Review of the Elementary Theory
The following assumptions are consistent with the elementary theory of beams.
Hooke's law applies in that the stresses are related to the strains in the usual linear
fashion. The deflections are assumed to be small in comparison to the beam di-
mensions. Loadings (forces and moments) must be transverse to the beam, and
longitudinal strains are assumed to be negligible.
A typical beam is shown in Fig. 7-16, where the point loads PI and P2 act on
the beam in the plane of the paper. In addition, a distributed load p(x) and the
externally applied moments M, and M2 are shown. The distributed load p(x) may
be a function of x. The left end of the beam is said to be cantilevered while the
right end is simply supported. The deflection and slope at the cantilevered end are
zero, whereas the deflection and moment at the simply supported end are zero.
With the help of Fig. 7-17, the following sign conventions are adopted: A
positive moment M results in compressive stresses for positive values of y; otherwise
pix)
y
x
Figure 7-15
Beamfor which the plane stress model is valid.

324
STRESS ANALYSIS
p(x)
~
.. x
y
0)
0)
I
(7-82)
Figure 7-16
Typical beam with a distributed load per unit length ptx), point loads PI and
P2, and applied moments M I and M 2·
the moment is negative. A shear force V is posiuve if directed in the posurve
direction on a positive face (a positive face is one in which the outward normal to
the face is in the positive coordinate direction) or if directed in the negative direction
on a negative face; otherwise the shear force is negative. This sign convention for
shear force is consistent with that defined in Sec. 5-2. A distributed lateral force
p is positive if directed in the positive y direction. Note that p(x) is shown to be
constant in Fig. 7-17 because as dx approaches zero, p(x) approaches a constant
from x to x + dx.
With these sign conventions, the following equations 181 relate the shear force
V, the moment M, and the lateral load p:
dV
-
= -p
dx
Neutral
plane
1'1_.----dx----
dV
v+- dx
dx
'-..\I+J!! dx
o
dx
Figure 7-17
Infinitesimal beam element showing positive shear forces, moments, and
distributed loading.

BEAMS
325
dM
-
-V
(7-831
d.x
d 2w
M
EI-
(7-841
dx?
where w represents the deflection in the y direction and EI is the product of the
modulus of elasticity E and the moment of inertia I of the cross section about the
axis going through the neutral plane of the beam. The stresses as a result of bending
are zero in the neutral plane. The product El is often referred to as the flexural
rigidity. Recall that the moment of inertia is defined by
I = fA idA
(7-851
(7-881
(7-871
(7·861
where A is the cross-sectional area of the beam. Furthermore, the slope e of the
beam is related to the lateral deflection w by
dw
e =-
dx
If Eqs. (7-82) and (7-83) are combined, we obtain
d 2M
dx 2
= p
If the last result is combined with Eq. (7-84), we get
~22 ( EI ~:\~)
= p(x)
which is the governing equation for the deflection of the beam. Equation (7-88)
allows for the fact that the flexural rigidity EI may vary along the length of the
beam.
C'-Continuous Shape Functions
The finite element characteristics for the beam model can be derived from Eq. (5-
87), etc., provided that the generalized displacements are taken to be the deflections
and slopes (wand dwldx); the strains to be the curvatures of the neutral plane (~wl
dx 2) ; and the stresses as the bending moments (M). However, let us take an alternate
but completely equivalent approach by deriving the finite element characteristics
by using the Galerkin weighted-residual method presented in Chapter 4.
Recall that the Galerkin method (in the finite element context) requires that we
choose a suitable trial or basis function that is applied locally over only a portion
of the complete x domain; i.e., over a typical finite element. Let us denote this
trial displacement function or parameter function by w. Figure 7-18 shows a typical
finite element e with nodes i and j over which IV is to apply. However, we must
ensure that we have not only interelement deflection continuity but slope continuity

326
STRESS ANALYSIS
~ ~
;f
fi
~
IIX,
0
X
~--~'\r-------------+jXi
Figure 7-18
Typical beam element e with nodes i and j.
as well. In other words, at each element boundary (or node in this case) we insist
that both the deflection and slope be continuous, or that the parameter function be
C I-continuous.
Recall further that problems were defined to be CI-continuous when the weak
formulation contains at most only second-order derivatives. The weak formulation
corresponding to Eq. (7-88) may be obtained by either the variational approach or
by the Galerkin weighted-residual method. The latter is illustrated in this section
and indeed yields an integral equation that contains no derivatives of higher order
than two. Therefore, the beam model requires Cl-ccntinuous parameter functions,
which in turn requires Cl-continuous shape functions as seen below.
Each element has two nodes, but four requirements must be met: the deflections
and slopes at the two nodes must be continuous. Stated differently, at node i, we
must have a deflection W; and slope 6;, while at node j we must have deflection Wi
and slope 6j . Therefore, four constants must be introduced in the assumed form of
the parameter function. Not surprisingly, the following function meets the com-
patibility and completeness requirements delineated in Sec. 6-2:
(7-89)
(7-90)
From Eq. (7-86) we see that the slope within an element must be taken to be
_ dw _
.
2
6 -
dx -
(2 + 2C3X + 3C4X
These last two equations provide the starting point for the derivation of the shape
functions.
For a typical element e, the vector a" is taken as
ae = l w.
6j i
Wi
6j V
From Eqs. (7-89) and (7-90) it follows that
W;
CI + C2Xj + C)x7 + C4Xt
6;
C2 + 2C3Xj + 3C4X7
wj
CI + C2Xj + c)X] + C4XJ
e,
C2 + 2c)Xj + 3C4X]
(7-91)

BEAMS
327
Let us rewrite these last four equations in matrix form as
a" =l;:j l6
~'
~, ;::j l~~j
WJ
I
XJ
XJ
XJ
C3
SJ
0
I
2xJ
3xJ
C4
If we solve for the vector of coefficients we get
(7-92)
(7-93)
Note that the inverse of the 4 x 4 matrix of nodal coordinates is indicated, but let
us postpone getting this inverse for now. Instead let us rewrite Eq. (7-89) in matrix
form as
W
(7-94)
If Eqs. (7-93) and (7-94) are combined by eliminating the vector of coefficients in
the usual manner, we get
W
[ I
(7-95)
(7-96)
It is very convenient from a mathematical point of view to work in terms of a local
coordinate ~ defined by
~ = x
-
Xi = ;r
-
Xi
Xj
-
Xi
L
where L (not to be confused with the linear operator matrix L, which is not used
in this section) is defined by
L =
Xj
-
Xi
(7-97)
Clearly, L represents the length of the element.
Furthermore, let us write the parameter function
W in terms of the shape
functions and nodal deflections and slopes as fol1ows:
W = Na" = Nw1w" + Ne"Si + NwJwj + NejSj
(7-98)
Note that each node has two shape functions associated with it: one for the deflection
and one for the slope. If the right-hand side of Eq. (7-95) is multiplied out (after

328
STRESS ANALYSIS
performing the indicated inversion) and the variable x is eliminated in favor of the
local coordinate
~ by using Eq. (7-96), we get
IV = I I -
3e + 2e jlV, + I L(~ -
2e + e) l8i
+ 13e - 2e jw, + I L(-e + c) 18,
(7-99)
Comparing Eqs. (7-99) and (7-98) reveals that the shape function matrix N in terms
of the local coordinate ~ is given by
T
T
(7-100)
The reader should verify that these shape functions satisfy the following conditions:
at x = x, (where
~ = 0), we have N", =
I and NHi = Nu , = NH, = 0: and at
x = xJ (where ~ = I), we have N"J = I and N", = NHi = Nu, = O. In addition,
by Eq. (7-86) we must have
dw
8 =-
dx
dsv d~
d~ dx
I dw
L
d~
J dN
= --at'
L
d~
(7-101)
Therefore, the slope 8 within an element is given by
( I dN",,)
(I dNHi )
.
(I dNu ,)
.
(I dNu,)
8 = ---
II' + -- e +
-----'""
w +
----= e
L
d~
,
L
d~
,
L
d~
,
L
d~
,
(7-102)
Again the reader should verify that the derivatives of the shape functions satisfy
the following conditions: at x = x, (where
~ = 0), we have
I dNH:
"o}
L
d~
I dN",
~ dN,,! =~~
at ~
0
L
d~
L
d~
L
ci~
and at x = x, (where ~ = I). we have
~~
"0 }
L
d~
I dN".,
~ dNu, =
~ dN",
at ~ = I
L
d~
L
d~
L
d~
(7-103)
(7-104)
With these shape functions in hand, we are now in a position to determine the finite
clement characteristics for the beam element.

BEAMS
329
The Finite Element Characteristics
As stated earlier, the Galerkin weighted-residual method will be used to obtain the
finite element characteristics for the beam element. Recall from Chapter 4 that the
Galerkin method requires that
n I"
{d2(d2W)
}
2:
.. NT
2
EI-
2
- P dx = 0
e= I
x,
dx
dx
(7-105)
Note that the term in the braces is really the residual that results when the assumed
parameter function for the element is substituted into the governing equation, Eq.
(7-88). The so-called weighting functions are precisely the shape functions as
embodied in the shape function matrix N.
Again it is more convenient to work in terms of the local coordinate ~ defined
by Eq. (7-96). Therefore, dx = L d~ and Eq. (7-105) may be written in terms of
the local coordinate ~ as follows:
(I
{I
d
2 (EI j2w)
}
Jo NT Lde
L 2 d~2
-
pL
d~ = 0
(7-106)
where the summation over the n elements has been intentionally dropped because
we are seeking the element stiffness matrix and the element nodal force vectors. It
should be a well-known fact by now that the summation represents the assemblage
step, which is considered later.
Equation (7-106) may be written as follows:
I II
d
2 (EI j2w)
II
-
NT -
-
-
d
-
NT L d
LOde
L2 d~2
~ -
0
p
~
If we integrate the term on the left-hand side of this last equation by parts, we get
I
d (EI d 2W) II
I (I dN Td (EI d 2W)
(I
L W d~
£2 de
0
- LJo ---;jf d~
L2 de
d~ = Jo WpL d~
(7-107)
•
Writing Eqs. (7-83) and (7-84) in terms of the local coordinate
~, we get
I dM = -v
L
d~
and
(7-108)
(7-109)
Combining these last two results gives
I d (EI d2W)
L d~
L2 de
-v
(7-110)

330
STRESS ANALYSIS
Therefore, with the help of Eq. (7-110), the integrated term in Eq. (7-107) becomes
Therefore, Eq. (7-107) becomes
Integrating the integral on the left-hand side of this last equation by parts again
gives
Evaluating the integrated term in this last equation with the help of Eqs. (7-109)
and (7-100), we get
_!dNTEld2WI~~1 =
_M!dNTI~~1
L
d~ L2 d~2
~~o
L
d~
~~o
= (-M) [1-Z~~ZIt'J ~~I
-2~ + 3e
~~o
- M(x)m
+ M(x,lm
Therefore, Eq. (7-I I I) becomes
r
Vex)l
M(x)
I
I d 2N T
d2w
I
- vex,)
+ L3 fo
de
EI de d~ = fo WpL d~
-M(x)
(7-112)

BEAMS
331
With the help of Eq. (7-98) and noting a" is not a function of~, we may write Eq.
(7-112) as follows:
{
I
{I d 2N T
d2N}
[~~~;»]
(I
L3 Jo
d~2
EJ de
d~
a" =
+ V(x;)
+ Jo NTpL d~
(7-113)
+M(x;l
This last equation may be written concisely as
K"a" = f"
where f" is defined by
fe =
f~M +
f~
and Ke is the element stiffness matrix given by
I
[I d2NT
d 2N
x- = L3 Jo
de EJ de d~
(7-114)
(7-115)
(7-116)
(7-117)
In Eq, (7-115) f~M is the element nodal force vector as a result of shear forces and
moments and is defined by
". = L=vi\J~J
[
M(J)
and
f~ is the element nodal force vector as a result of the distributed load p and is
defined by
f" = (' NTpL d~
(7-118)
p
Jo
Let us now evaluate K" and
f~. Working on K" first, we note that
d
2NT = [L~~/+ I~~)]
(7-119)
de
6 -
12~
L( - 2 +
6~)
If the right-hand side of Eq. (7-119) is substituted into Eq. (7-116), the integrand
multiplied out, and the integral integrated and evaluated, we get
(7-120)
Note that EJ was assumed to be constant for the element. IfEJis variable, a suitable
average value could be used.

(7-121)
332
STRESS ANALYSIS
Next the element nodal force vector
f~ as a result of the distributed lateral
loading p is evaluated. Let us take an average value of the distributed load (written
p) for the element, which is defined as
_
p(x,) + p(x)
P =
2
Then Eq. (7-118) becomes
fC = pL {I NT dt; = pL
I'
Jo
Remarks
{J (1 _ 3t;2 +-2t;3) dt;
Jo
CL(t; - 2t;2 + t;3) dt;
--- - - ------ - ------ - -------------
r(3t;2 - 2t;3) dt;
rL( - t;2 + t;3) dt;
pL/2
pL 2112
--------------
(7-122)
pL/2
-pL 2112
The assemblage step is routine and is performed in the manner illustrated in Chapter
3 for the two-dimensional truss model. Imposed external moments and point loads
may be readily applied via f'l'M providing that a node is placed at such points. The
point loads are applied via the shear force vex,) or vex}). Application of the prescribed
deflections and slopes is also routine, and Method I is again recommended. The
solution of Ka = f for the nodal deflections and slopes may be obtained either by
the matrix inversion method or with the help of subroutine ACTCOL [91 given in
Appendix C. These nodal deflections and slopes may be used to obtain the element
resultants, as explained below.
Inthis case, the element resultants include the internal moments M, shear forces
V, maximum longitudina! stresses (TIll"" and maximum shear stresses T Illax at each
point along the beam. The internal moments M may be evaluated from
and the shear forces V from
M
(7-123)
I d (EI J2N)
V = - Ldt;
L2 dt;2
a"
17-124)
Note that these last two equations imply that M varies linearly over the element e,
whereas V is constant. The maximum longitudinal stress (or bending stress) occurs

BEAMS
333
in the outermost fibers of the beam (i.e., the upper or lower surface) and is given
by
Me
U max =
I
(7-125)
where e is the distance from the neutral plane to the outermost fibers of the beam
as shown in Fig. 7-17. The maximum shear stress Tmax occurs in the neutral plane
and is given by
vf~y dA
fb
(7-126)
where b is the width of the beam in the neutral plane. Note that in these equations,
we would use the results from Eqs. (7-123) and (7-124) to provide M and Vat any
value of x.
Example 7-7 below illustrates the use of the material in this section and intro-
duces a new simple element-the linear spring element. In this example, one point
on the beam is supported by a spring with a known spring constant k.. Up to now,
only one type of element has been used in anyone problem or model. Example
7-7 shows how we can easily model systems with a variety of elements. Large
structural analysis programs such as NASTRAN [10] and STARDYNE [II] have
hundreds of different types of built-in elements.
Example 7-7
Solve for the deflections and slopes at the ends and midspan of the beam shown
in Fig. 7-19(a). The distributed load pis 4800 N/m and the point load P is 3000
N. The left end is cantilevered and the right end is attached to a linear, elastic
spring with a spring constant k, of 200 kN/m. The beam has a rectangular cross
section with a width b of 3 cm and a height h of 4.31 ern and is made of steel with
an elastic modulus E of 2.0 X 1011 N/m2 • Also determine the moment, shear force,
and maximum bending and shear stresses at the middle of the distributed load.
Assume L I = L 2 = 1 m.
Solution
First, we must determine the moment of inertia f for the beam:
f =
Yl2bh3 =
Yl2 (0.03)(0.0431)3
or
Therefore, the flexural rigidity is given by
40.0 X 103 Nm2

334
STRESS ANALYSIS
The element computations are summarized below. Note that only two equal-length
beam elements are used (here L = I m) in addition to the spring element as shown
in Fig. 7-19(b).
t
2.41
____ 2.~~__
X 103
2.4
-0.4
Q
~
~LI---I-.--L 2-----I
(a)
OJ
+
(b)
[II
I--b--j
Figure 7·19
Beam used in Example 7-7. (a) Loading and restraints and (b) discretization
for the FEM solution.

BEAMS
335
If the point load P is considered in the computation of fVM for element I, we get
f(ll
= l-~--l
X
10
3
VM
3.0
o
Therefore, the composite nodal force vector for element I is given by
Element 2
The stiffness computation for element 2 is identical to that of element I. There is
no distributed load acting on element 2, so fj,2) is zero. Moreover, the point load
was considered in element I, so tVk is zero as well. (How would these computations
be modified if the point load is considered in the computations for element 2? Is
the same result obtained for the assemblage nodal force vector?)
Element 3
The stiffness relationship for the spring element is given by
KI31 = k [
I
S
-I
-I]
=
[
200
I
-200
- 200]
X 103
200
This follows immediately from the direct approach illustrated in Chapter 3 for the
truss element (AE/L for the truss element is analogous to the spring constant k).
The assemblage of these element stiffness matrices may be more readily un-
derstood if it is given symbolically as follows if we let k = E/IL3:
where the vector of nodal unknowns a is implied to be

336
STRESS ANALYSIS
Note how the element stiffness matrix for the spring element is incorporated into
the assemblage stiffness matrix. Numerically, we have
480
240
- 480
240
0
0
0
240
160
- 240
80
0
0
0
----480---=-240-----960------0-----:::48lr----Z4Cf-----(j---
240
80
0
320
- 240
80
0
---o--------d----::480----=240-----iixjy---:::24-0----=-iOO--
o
0
240
80
-240
160
0
·---(j-------(1-------0-------O----::206------(j------2()0--
24
04
---n--
-04
----6---
()
()
But WI
= 0, fl)
= 0, and w. = 0 must be imposed, and if Method I is used from
Chapter 3. the result is
o
0
0
000
0100000
--0---6------960--------6-----=480------24Cf--o--
o
0
0
320
~ 240
80
0
--6---0---=-486----=-240------686----=240---iY--
o
0
240
80
- 240
160
0
--ir--6--------6---------0---------6---------0----r--
Solving for the nodal unknowns yields
H/ I
fl l
W2
___~L__
W3
fl3
IV.
o
o
----5~4---
-0.4
-----0----
o
-----0----
11'2 = 0.01166 m
fl2 = 0.00648 rad
11'.1 = 0.00680 m
fl3
=
-0.01052 rad
o
The moment in the beam at the middle of the distributed load (where ~
Y2
for element I) is determined from Eqs. (7-123) and (7-119) as follows:
_ £/ d
2NTI
II)
£/
M -
- --
a
= L2 (011'1 -
Lfl l + OW2 + Lfl 2)
L
2 de
t~ 1/2
(40 x
103)(0.00648 -
0.)
(I)
or
M = 259 N'rn
Therefore, the maximum bending stress at this location is
_ Me _ (259)(0.043112) _
6
2
U max -
-/-
-
2 x 10- 7
-
27.9 x 10 N/m
The shear force V at this point is computed from Eq. (7-124) as follows:

BEAMS
337
-EI
V
L:3(12w\ + 6L8 1 -
12w2 + 6L8 2 )
-40 x 103 [12(0) + 6(1)(0) -
12(0.01166) + (6)(0.00648)]
or
V=4040N
Therefore, the maximum shear stress at this location is
'Tmax
(h12
V )0
y dA =
Vb (y2/2) I
hl2
lb
lb
0
or
Tmax
(4040)(0.0431)2
8(2 x 10- 7 )
4.7
X 106 N/m 2
•
7-6
SUBSTRUCTURING
Occasionally, the structure to be analyzed results in a model that is too large to be
solved even on the largest computers. In this section we will see how it is possible
to analyze such a structure by breaking it into several substructures. For example,
the Boeing 747 airliner was analyzed by breaking the airplane into four parts, or
substructures [12]. This approach is referred to as substructuring and is explained
below. Substructuring can also make it feasible to solve practical structural analysis
problems on microcomputers with limited memory.
In an effort to make this discussion a little less abstract, consider the two-
dimensional region shown in Fig. 7-20(a). The ultimate goal is to find the nodal
displacements and the element resultants. The concept of substructuring requires
that we divide the original region into two or more parts as shown in Fig. 7-20(b).
Let us concentrate on the first substructure and temporarily disregard the second.
The element characteristics for this substructure are determined and assembled in
the usual manner to form Kaaa = fa for this substructure only. Actually, the
assemblage step is not performed in exactly the usual manner; instead, we assemble
K" and fa such that in partitioned form we have
(7-127)
where ai' contains the displacements of the nodes that are on the boundary of the
substructure, and a2 contains the displacements of the internal nodes. The displace-
ments of the internal nodes may be eliminated as described below.
If the second matrix equation in Eq. (7-127) is written out and solved for
a2, we get

338
STRESS ANALYSIS
(a)
Superelement
I
Superelement
II
(b)
(e)
Figure 7-20
Two-dimensional region illustrating the concept of substructuring. (a) Original
mesh, (b) divided into two substructures. and (c) creating two supcrelements.
(7-1281
But the first matrix equation in Eq. (7-127) implies
(7-1291
Eliminating a~ with the help of Eq. (7-128) and rearranging the result gives
(7-1301
which is of the form
(7-131)
where the superscript E is used to denote the superelement created by eliminating
the internal degrees of freedom. It can be shown that K E is still symmetric. The

STRESS ANALYSIS PROGRAM
339
process summarized by Eqs. (7-127) to (7-131) is referred to as condensation and
may be performed on each substructure. The resulting superelements shown in Fig.
7-20(c) have nodes only on the boundaries. The stiffness matrix K E and nodal force
vector f E for each superelement E are assembled in the usual manner to form the
assemblage stiffness matrix K A and assemblage nodal force vector fA. The pre-
scribed displacements are also imposed in the usual manner (Method I from Chapter
3 is preferred). The resulting system of equations in Ka = f is solved for the nodal
displacements. However, the vector a contains only the displacements for nodes
on the boundaries of the superelements. Inorder to obtain the nodal displacements
of the internal nodes, we may use Eq. (7-128) for each substructure, where af is
now known from the solution of Ka = f. With the nodal displacements now known
for each of the original nodes, the element resultants may be obtained in the usual
manner.
Note that Eq. (7-130) requires the inverse of Kf2' which can be a rather large
matrix in practical problems. Subroutine ACTCOL [9] may be used to obtain this
inverse by successively solving Kf2X = 0, where 0 is taken to be [I
0
0
... jT
to get the first column in (Kf2)-I. then [0
I
0
0 ...V to get the second
column in (Kf2)- I, and so forth. The triangular decomposition of Kf2 needs to be
performed only once (which is accomplished by setting AFAC to .FALSE. after
the first decomposition), Since a large portion of the solution time is spent on the
triangular decomposition phase, obtaining the inverse in this way is quite practical.
In addition to the obvious advantages of substructuring just mentioned, there
are others. For example, the analysis of large structures can be performed by several
different groups of engineers, with each group responsible for developing the finite
element model for one of the substructures. Obviously, each group must use the
same number of nodes at the same locations along the substructure interfaces.
Moreover, those portions of the design, and hence the model, that are finalized
need not be regenerated during each computer run. Only those portions of the design
that are being changed need to be modeled during each run. This can result in an
obvious economic advantage when large and complex models are used.
Substructuring may also be performed quite readily in all nonstructural appli-
cations, such as in thermal and fluid flow analyses. In addition, substructuring is
not limited to static or steady-state analyses. After mastering Chapter 10, the reader
should have little difficulty in applying substructuring to dynamic structural and
transient thermal problems.
7-7
DEVELOPMENT OF A TWO-DIMENSIONAL STRESS ANALYSIS
PROGRAM: PROGRAM STRESS
Some helpful hints and comments are given in this section so that the reader can
develop a two-dimensional stress analysis program with further instructions from
the instructor. I Specific comments are made with respect to the main program,
mesh generation, and data storage.
I A two-dimensional stress analysis program and a user's manual are included in the Instructor/Solution's
manual for this text.

340
STRESS ANALYSIS
The Main Program
The main program should be kept as brief as possible. An example is the following
seven lines of code:
PROGRAM STRESS
COMMON XL (2500)
MAX = 2500
LCONSL = 3
CALL DRIVER (MAX, LCONSL)
CALL EXIT
END
The variable MAX represents the length of the XL array, the contents of which
are described below. This variable should be assigned the value of the dimension
of XL in the unlabeled COMMON. Much larger problems may be solved with the
program by increasing this parameter to the memory limit of the computer being
used. The variable LCONSL (as in the TRUSS program) represents the logical unit
number for the console. Control is then transferred to subroutine DRIVER.
Mesh Generation
The same type of mesh generator discussed in Sec. 3-6 may be used in this program
except that the nodes no longer need to be equally spaced. This is accomplished
with the help of two spacing factors I, and f, (FX and FY in the program). These
factors are used as described below.
Consider the starting node NI and the final node NF shown in Fig. 7-21(a).
Additional nodes can be generated between these two end nodes if a nonzero value
of NG is used. The nodes need not be equally spaced, however. Without loss of
generality, let us number the nodes 1,2, ... , n, as shown in Fig. 7-21(b) and
refer to the x and Y coordinates of node I by XI' YI, etc. Then the spacing factors
I, and Iy may be defined by
Xn -
Xn - I
Xn - 1 -
Xn-2
(7-132)
and
f,
=
Y3 -
Y2 =
Y4 -
Y3 _ ... _
YII -
YII-I
v
-
-
.
Y2 -
YI
Y3 -
Y2
YII--I -
YII-2
Concentrating on the X direction for now. we may write
(7-133)
(7-134a)
(7-134b)

(a)
STRESS ANALYSIS PROGRAM
341
(b)
Figure 7-21
(a) Starting node NI and ending node NF are used to generate additional
nodes. (b) Line along which n nodes are generated (not necessarily equally spaced).
Adding these results gives
XII
-
XI = [I + I, + I? + ... + 1/1-2 ] (X 2
-
XI)
from which it follows that
(7-134c)
(7-134d)
(7-135)
XII
-
XI
n
2
1+ L 1/
i= I
(7-136)
Since XI and XII may be input (as XI and XF, respectively) and since I, may be
input (as FX), then
X2 can be found from Eq. (7-136). Note that n is the total
number of nodes in the generating sequence (including Nl and NF). Obviously X3
can be computed from Eq. (7-134b), or
(7-137)
and so forth. It should also be obvious that in the y direction the same results hold
except that each Xi is replaced by Yi and I, is replaced by I,· Note that ifI, (or I,)
is greater than unity, the nodes are spaced farther apart in moving from Nl to NF;
if I, (or /.,) is less than unity (but greater than zero), the spacing between two
consecutive nodes decreases in moving from Nl to NF.
Data Storage
The data for the nodal coordinates, elements, boundary conditions, material prop-
erties, surface tractions, point loads, and so forth, should be stored in the XL array.
In addition, the assemblage stiffness matrix (in column vector form), the assemblage
nodal force vector, and the diagonal pointer array (JDIAG from Sec. 6-8) should

342
STRESS ANALYSIS
also be stored in the XL array. The partitions between each of these sections should
float, and if fewer nodes are used, for example, more materials may be present.
The number of storage locations required must not exceed MAX. If it does, an
error message should be displayed on the console and execution should be termi-
nated.
The numbering of the nodes is critical if the program does not renumber the
nodes to minimize the bandwidth of the assemblage stiffness matrix. However, the
program should store only the banded portion of these matrices, which reduces the
storage requirements drastically over storing the full matrices. Nodes on the object
being analyzed are always numbered consecutively, from I to the maximum number
of nodes. The bandwidth is minimized when the maximum difference between any
two nodes on each element is minimized. Figure 7-22 shows that this is accomplished
quite simply by numbering the nodes in the direction of fewer nodes.
Note that in Fig. 7-22(a) the nodes are numbered in the direction of the smaller
number of nodes. In Fig. 7-22(b) the nodes are numbered to the right and in the
direction of the greater number of nodes. The storage requirements for the mesh
in the latter are higher than for the mesh in the former. In Fig. 7-22(c) the nodes
are numbered in an alternating sweeping fashion, which more than doubles the
storage requirements over that required in Fig. 7-22(a). Finally, in Fig. 7-22(d) the
element on the lower left has nodes I, 2, and 21; the implication is that the stiffness
matrix is no longer banded, which in turn means higher storage requirements and
increased execution times. Although the program need not store the zero terms in
(a)
(c)
(b)
(d)
Figure 7-22
(a) Proper node numbering scheme. (b) Less-desirable node numbering scheme.
(c) Nodes should never be numbered in an alternating sweeping fashion. (d) Worst node
numbering scheme-results in an unbanded stiffness matrix.

18t----_
17¥--------4020
(3)
18~---_
17-------....,.20
(b)
REFERENCES
343
Figure 7-23
(a) Preferred way of dividing a quadrilateral into two triangles and (b) less-
desirable way of forming two triangles.
the stiffness matrix outside the bandwidth, it should store everything within the
bandwidth (including leading zeros).
Numbering the elements is not critical, but some sort of regular numbering
scheme usually allows the use of an automatic element generation feature. Note
that in forming the elements shown in the lower right-hand comer of Fig. 7-22(a),
the quadrilateral formed by nodes 17, 20, 21, and 18 is divided into two triangles
by using the shorter diagonal (nodes 17 and 21) as opposed to the longer diagonal
(nodes 18 and 20). This is summarized by Fig. 7-23. Regular triangles generally
give better results than obtuse or needle-shaped triangles.
7·8
REMARKS
This chapter illustrates how the finite element method is used in static, linear stress
analysis. The formulations for plate bending and nonlinear problems are conspic-
uously absent. For these applications, the reader is referred to more advanced books
on this subject by Zienkiewicz [13], Bathe [14], and Ugural [15].
REFERENCES
1. Ugural, A. C., and S. K. Fenster, Advanced Strength and Applied Elasticity, American
Elsevier, New York, 1975, pp. 57-58.
2. Zienkiewicz, O. c., The Finite Element Method, McGraw-Hill (UK), London, 1977,
pp. 99-101.
3. Ugural, A. C., and S. K. Fenster, Advanced Strength and Applied Elasticity, American
Elsevier, New York, 1975, pp. 75-77.
4. Zienkiewicz, O. c., The Finite Element Method, McGraw-Hill (UK), London, 1977,
p. 125.
5. Huebner, K. H., The Finite Element Methodfor Engineers, Wiley, New York, 1975,
pp. 218-219.
6. Wilson, E. L., "Structural Analysis of Axisymmetric Solids," AIAA Journal, vol. 3,
no. 12, pp. 2267-2274, December 1965.

344
STRESS ANAl,.YSIS
7. Zienkiewicz, O. c.. The Finite Element Method, McGraw-Hili (UK), London, 1977,
p. 140.
8. Popov, E. P., Introduction to Mechanics of Solids, Prentice-Hall, Englewood Cliffs,
N.J., 1968, pp. 32-36.
9. Zienkiewicz, O. c., The Finite Element Method, McGraw-Hili (UK), London, 1977,
pp.740-741.
10. MSCINASTRAN, User's Manual, MacNeal-Schwendler Corporation, Los Angeles, 1979.
II. STARDYNE for Scope 3.4 Operating System, User Information Manual, Cybernet
Services, Control Data Corporation, Minneapolis, 1978.
12. Hansen, S. D., et aI., "Analysis of the 747 Aircraft Wing-Body Intersection," Pro-
ceedings of the 2nd Conference on Matrix Methods in Structural Mechanics, Wright-
Patterson Air Force Base, Dayton, Ohio, October 15-17, 1968.
13, Zienkiewicz, O. c., The Finite Element Method, McGraw-Hili (UK), London, 1977,
pp. 226-267,450-526.
14. Bathe, K., Finite Element Procedures in Engineering Analysis, Prentice-Hall, Engle-
wood Cliffs, N.J., 1982, pp. 251-260.
IS. Ugural, A. c., Stresses in Plates and Shells, McGraw-Hili, New York, 1981. pp. 126-
136.
PROBLEMS
Note: The properties in Appendix A should be used unless stated otherwise.
7-1
Show that the B matrix for the three-node triangular element in plane stress or plane
strain is given by Eq. (7-7).
7-2
Derive the B matrix for the cases of plane stress and plane strain for the four-node
rectangular element. How does this matrix differ from that for the three-node tri-
angular element?
7-3
For an isotropic material, how is the shear modulus related to the modulus of
elasticity and Poisson's ratio?
7-4
Why is the normal strain E" not necessarily zero for a thin plate in plane stress'?
Give a specific example.

PROBLEMS
345
7-5
Why is the normal stress IT" not necessarily zero in a long bar in plane strain? Give
a specific example.
7-6
Repeat Example 7-1 for the case of plane strain. Since the member is now assumed
to be long in the longitudinal direction, take I to be unity. Use as much of Example
7-1 as possible.
7-7
Consider the triangular element shown in Fig. P7-7. The plate from which the
element is .extracted is made of cast iron and has a thickness of 0.5 in. The nodal
coordinates are Xi = 2.0, v, = 1.5, Xi = 1.7, Y, = 3.0, Xk = 0.6, and Yk = 1.8 in.
Determine the clement stiffness matrix if all external forces act in the plane of the
plate (and hence in the plane of the element).
k~-------""
(2)
Figure P7-7
7-8
Repeat Problem 7-7 for the case of plane strain. Take Ito be unity.
7·9
Consider the triangular element shown in Fig. P7-9. The plate from whieh the
element is extracted is made of brass and has a thickness of I em. The nodal
coordinates are Xi = 5. Y, = 6, Xj = 4, Y, = 4, Xk = 6, and Yk = 4 cm. Determine
the element stiffness matrix if all external forces act in the plane of the plate (and
hence in the plane of the element).
k
0 ...
j
-
-
-
-
-
4 0
Figure P7-9
7-10
Repeat Problem 7-9 for the case of plane strain. Take Ito be unity.

346
STRESS ANALYSIS
7·11
Consider the triangular element shown in Fig. P7-11. The element is extracted from
a thin plate of thickness 0.5 em. The material is hot rolled, low carbon steel. The
nodal coordinates are Xi = 0, Yi = 0, xJ = 0, YI =
- I, XI = 2, and YI =
- I em.
Determine the element stiffness matrix if all external forces act in the plane of the
plate (and hence in the plane of the element).
;0
i_-
--"'ek
CD
@
Figure P7·11
7·12
Repeat Problem 7-11 for the case of plane strain. Take t to be unity.
7·13
Consider the triangular element shown in Fig. P7-13. The element is extracted from
a thin plate of thickness 0.75 in. The material is hard drawn copper. The nodal
coordinates are Xi = 0, Yi = 0, XI = I, YJ = 2, XI =
- I. and YI = 2 in. Determine
the element stiffness matrix if all external forces act in the plane of the plate (and
hence in the plane of the element).
k
j
0---------0
Figure P7·13
7-14
Repeat Problem 7-13 for the case of plane strain. Take t to be unity.
7·15
Show that the element stiffness matrix for plane stress and plane strain as given by
Eq. (7-24) for the three-node triangular element is always symmetric.
7·16
Show that the element stiffness matrix for plane stress and plane strain for the four-
node rectangular element is always symmetric.
7·17
What is the size of the element stiffness matrix for the case of plane stress (or plane
strain) if the four-node rectangular element is used? Explain your answer.
7·18
Determine the element stiffness matrix for the element shown in Fig. P7-18. The
element is extracted from an aluminum (6061 alloy) plate with a thickness of

PROBLEMS
347
1.25 cm. All external forces are in the plane of the plate. The coordinates of the
nodes are Xi = 4, Yi = 2, xi = 4, Yi = 3, Xk = 2, Yk = 3, Xm = 2, and Ym =
2 cm. Perform the integrations by evaluating the integrands at the element centroid
and treating the integrand as a constant.
@
@
k .---------~ j
m_._--------_
@
Figure P7-18
7-19
Repeat Problem 7-18 for the case of plane strain. Take t to be unity.
7-20
Determine the element stiffness matrix for the element shown in Fig. P7-20. The
element is extracted from a brass plate with a thickness of 0.375 in. All external
forces are in the plane of the plate. The coordinates of the nodes are Xi = 5, Yi =
2, xi = 5, Yi = 4, Xk = 2, Yk = 4, x; = 2, and Ym = 2 in. Perform the integrations
by evaluating the integrands at the clement centroid and treating the integrand as a
constant.
@
@
kt----------,
m.!:-
~i
0)
@
Figure P7-20
7-21
Repeat Problem 7-20 for the case of plane strain. Take t to be unity.
7-22
What size is the element nodal force vector from a self-strain if the four-node
rectangular element is used in plane stress or plane strain formulations?
7-23
Determine a general expression for the element nodal force vector from a uniform
self-strain for the rectangular element in plane stress. Perform the integrations by
evaluating the integrand at the element centroid and treating the integrands as though
they were constants.
7-24
Repeat Problem 7-23 for the case of plane strain.
7-25
For the element in Problem 7-7, determine the element nodal force vector as a result
of a self-strain if the temperature increases by 50°F. Assume plane stress.

348
STRESS ANALYSIS
7-26
For the element in Problem 7-7. determine the element nodal force vector as a result
of a self-strain if the temperature increases by 50°F. Assume plane strain and take
t to be unity.
7-27
For the element in Problem 7-9, determine the element nodal force vector as a result
of a self-strain if the temperature increases by 30°C. Assume plane stress.
7-28
For the element in Problem 7-9, determine the element nodal force vector as a result
of a self-strain if the temperature increases by 30°C. Assume plane strain and take
t to be unity.
7-29
For the element in Problem 7-11. determine the element nodal force vector as a
result of a self-strain if the temperature decreases by 40°C. Assume plane stress.
7-30
For the element in Problem 7-11. determine the element nodal force vector as a
result of a self-strain if the temperature decreases by 40°C. Assume plane strain
and take t to be unity.
7-31
For the element in Problem 7-13. determine the element nodal force vector as a
result of a self-strain if the temperature decreases by 75°F. Assume plane stress.
7-32
For the element in Problem 7-13. determine the element nodal force vector as a
result of a self-strain if the temperature decreases by 75°F. Assume plane strain and
take t to be unity.
7-33
For the element in Problem 7-18, determine the element nodal force vector as a
result of a self-strain if the temperature decreases by 35°C. Assume plane stress
and perform the integrations by evaluating the integrands at the element centroid
and treating the integrands as though they were constants.
7-34
For the element in Problem 7-18. determine the element nodal force vector as a
result of a self-strain if the temperature decreases by 35°C. Assume plane strain
with t taken as unity and perform the integrations by evaluating the integrands at
the element centroid and treating the integrands as though they were constants.
7-35
For the element in Problem 7-20, determine the element nodal force vector as a
result of a self-strain if the temperature decreases by 80°F. Assume plane stress and
perform the integrations by evaluating the integrands at the element centroid and
treating the integrands as though they were constants.
7-36
For the element in Problem 7-20. determine the element nodal force vector as a
result of a self-strain if the temperature decreases by 80°F. Assume plane strain
with t taken as unity and perform the integrations by evaluating the integrands at
the element centroid and treating the integrands as though they were constants.
7-37
Determine a general expression for the element nodal force vector from a uniform
prestress for the rectangular element in plane stress or plane strain. Perform the
integrations by evaluating the integrand at the element centroid and treating the
integrands as though they were constants.
7·38
For the element in Problem 7-7. determine the element nodal force vector as a result
of the following prestresses: a u o =
1000. a n o =
-750. and a n o = 500 psi.

PROBLEMS
349
7-39
For the element in Problem 7-9, determine the clement nodal force vector as a result
of the following prestresses: (Jx,o = - 2000, (JITO = 1200, and (Jxm = - 1500
Nzcm'.
7-40
For the element in Problem 7-11, determine the element nodal force vector as a
result of the following prestresses: (Juo = 1300,
(JITO = - 800, and
(J.",o = 0
Nzcm'.
..
7-41
For the element in Problem 7-13. determine the element nodal force vector as a
result of the following prestresses:
(Jno = 4200.
(Jrro = - 2800, and
(Jno =
-1400 psi.
7-42
For the element in Problem 7-18, determine the element nodal force vector as a
result of the following prestresses:
(Jno = - 3400, (J"o = 1800. and (J"o =
- 2200 Nzcm'. Perform the integrations by evaluating the integrands at the element
centroid and treating the integrands as though they were constants.
7-43
For the element in Problem 7-20. determine the clement nodal force vector as a
result of the following prestresses: (Jxxo = - 400. (Jn o = 800, and (Jxro = - 1200 psi.
Perform the integrations by evaluating the integrands at the element centroid and
treating the integrands as though they were constants.
7-44
Determine a general expression for the element nodal force vector from a uniform
body force for the rectangular element in plane stress or plane strain. Perform the
integrations by evaluating the integrand at the element centroid and treating the
integrands as though they were constants.
7-45
For the element in Problem 7-7. determine the element nodal force vector as a result
of a body force with the following components: b, =
100 and b; = 0lbf/in 3.
7-46
For the element in Problem 7-9, determine the element nodal force vector as a result
of a body force with the following components: b, = 500 and b; = 700 Nzcm',
7-47
Assume that the element in Problem 7-11 is oriented such that the y axis is in the
direction opposite that of gravity. If there are no other body forces present. determine
the clement nodal force vector. The acceleration due to gravity is 9.81 m/s'.
7-48
Assume that the element in Problem 7-13 is oriented such that the x axis is in the
same direction as that of gravity. If there are no other body forces present. determine
the element nodal force vector. The acceleration due to gravity is 32.2 ft/s",
7-49
For the clement in Problem 7-18, determine the element nodal force vector as a
result of a body force with the following components: b, = 500 and b; = 0
Nzcm', Perform the integrations by evaluating the integrands at the element centroid
and treating the integrands as though they were constants.
7-50
Assume that the clement in Problem 7-20 is oriented such that the y axis is in the
direction opposite that of gravity. If there are no other body forces present, determine
the clement nodal force vector. The acceleration due to gravity is 32.2 ft/sec '.
Perform the integrations by evaluating the integrands at the element centroid and
treating the integrands as though they were constants.
7-51
Determine a general expression for the element nodal force vector from a uniform
surface traction on face ij for the rectangular element in plane stress or plane strain.

350
STRESS ANALYSIS
Perform the integrations by evaluating the integrand at the center of face ij and
treating the integrands as though they were constants.
7·52
For the element in Problem 7-7, determine the element nodal force vector as a result
of a surface traction on leg ij with the following components: s, = 1000 and Sy =
200 psi.
7·53
For the element in Problem 7-9, determine the element nodal force vector as a result
of a surface traction on leg jk with the following components: s, = 1500 and s, =
800 N/cm 2.
7·54
For the element in Problem 7-11, determine the element nodal force vector as a
result of a surface traction on leg ki with the following components: Sx = 1200 and
Sy = 750 Nzcrrr'.
7·55
For the element in Problem 7-13, determine the element nodal force vector as a
result of a surface traction on legjk with the following components: 5x = 4200 and
s,
=
1800 psi.
7·56
For the element in Problem 7-18, determine the element nodal force vector as a
result of a surface traction on face ij with the following components: Sx =
1500
and s, = 500 Nzcm", Perform the integrations by evaluating the integrands at the
centroid of face ij and treating the integrands as though they were constants.
7·57
For the element in Problem 7-20, determine the element nodal force vector as a
result of a surface traction on face mi with the following components: r, =
1100
and s,' =
1500 psi. Perform the integrations by evaluating the integrands at the
centroid of face mi and treating the integrands as though they were constants.
7·58
It has been assumed in the derivation leading to Eq. (7-33) in the text that the
surface traction is uniform over the leg of the triangle in question. Derive an alternate
expression for the nodal force vector for a linearly varying surface traction on leg
ij of the three-node triangular element shown in Fig. P7-58. Proceed by assuming
the following forms for s, and 5,:
Sr = N;Sxi + Nj 5xj
S" = NjS'-i + Njs,}
where Sxi is the x component of the surface traction at node i, etc. Write the shape
functions in terms of the length coordinates (defined on leg ij) and use Eq. (6-48)
to perform the integrations,
k
S)'i
k
Syj
Figure P7·58

PROBLEMS
351
7-59
Repeat Problem 7-S8 for a uniformly varying surface traction on leg jk. At nodes
j and k, the x and y components of the surface traction are Srj and Srk and sYj and
Svk' respectively.
7-60
Repeat Problem 7-S9 for a uniformly varying surface traction on leg ki. At nodes
k and i, the x and y components of the surface traction are S.k and Sri' and Syk and
Svi' respectively.
7-61
For the element in Problem 7-7, determine the element nodal force vector as a result
of a point load that has the following components: fpx = 2000 and fpy = 1200 Ibf.
The point load is located at Xo = I.S and Yo = 2.0 in.
7-62
For the element in Problem 7-9, determine the element nodal force vector as a result
of a point load with the following components: fp• = 1000 and fpy =
SOO N. The
point load is located at Xo = S and Yo = Scm.
7-63
For the element in Problem 7-11, determine the element nodal force vector as a
result of a point load with the following cornponents.jj, = 2400 andfpy = - ISOO N.
The point load is located at Xo = 2 and Yo = - I cm.
.
7-64
For the element in Problem 7-13, determine the element nodal force vector as a
result of a point load with the following components: fp. =
- 12S0 and /py =
-1800 Ibf. The point load is located at Xo =
I and Yo = 2 in.
7-65
For the element in Problem 7-18, determine the element nodal force vector as a
result ofa point load with thefollowing components.jj, = 2330 andfpy =
- ISoo N.
The point load is located at Xo = 3.0 and Yo = 2.S cm.
7-66
For the element in Problem 7-18, determine the element nodal force vector as a
result of a point load with the following components: fp. =
- 2330 and /py =
ISoo N. The point load is located at Xo = 4 and Yo = 2 cm.
7-67
For the element in Problem 7-20, determine the element nodal force vector as a
result of a point load with the following components: fp. =
- 2000 and fpy
=
1000 Ibf. The point load is located at Xo = 4 and Yo = 3 in.
7-68
For the element in Problem 7-20, determine the element nodal force vector as a
result of a point load with the following components.jj, = 2SOO and/p, =
- 3000 lbf.
The point load is located at Xo = 2 and Yo = 4 in.
7-69
Using the symbolic notation from Example 7-S, give the expression for the assem-
blage stiffness matrix for the discretized two-dimensional region in Fig. P7-69.
What is the half-bandwidth? Can the half-bandwidth be reduced? If so, explain
how.
CD
[2]
Element
Nodes
number
i
k
1
4
1
2
2
1
4
3
4
0--------.
0--------~
Figure P7·69

352
STRESS ANALYSIS
7-70
Using the symbolic notation from Example 7-6, give the expression for the assem-
blage nodal force vector for the discretized two-dimensional region in Fig. P7-69.
7-71
Using the symbolic notation from Example 7-5, give the expression for the assem-
blage stiffness matrix for the discretized two-dimensional region in Fig. P7-71.
What is the half-bandwidth? Can the half-bandwidth be reduced? If so, explain
how.
Nodes
i
k
0----------.::
[i]
0--------..;:.
Figure P7-71
Element
number
1
2
3
2
3
3
3
2
4
1
4
5
7-72
Using the symbolic notation from Example 7-6, give the expression for the assem-
blage nodal force vector for the discretized two-dimensional region in Fig. P7-71.
7-73
Using the symbolic notation from Example 7-5, give the expression for the assem-
blage stiffness matrix for the discretized two-dimensional region in Fig. P7-73.
What is the half-bandwidth? Can the half-bandwidth be reduced? If so, explain
how.
(i)
0
[2]
Element
Nodes
CD
number
i
k
[i]
8]
1
3
1
2
2
3
4
1
3
2
5
3
[2]
4
5
4
3
0
0
Figure P7-73
7-74
Using the symbolic notation from Example 7-6. give the expression for the assem-
blage nodal force vector for the discretized two-dimensional region in Fig. P7-73.
7-75
By extending the symbolic notation from Example 7-5. give the expression for the
assemblage stiffness matrix for the discretized two-dimensional region in Fig. P7-
75. What is the half-bandwidth? Can the half-bandwidth be reduced? If so. explain
how.

PROBLEMS
353
CD
8
CD
Element
Nodes
OJ
[2]
number
k
m
1
3
4
2
1
2
5
6
4
3
CD
0)
0
Figure P7-75
7-76
Be extending the symbolic notation from Example 7-6, give the expression for the
assemblage nodal force vector for the discretized two-dimensional region in Fig.
P7-75.
7-77
By extending the symbolic notation from Example 7-5, give the expression for the
assemblage stiffness matrix for the discretized two-dimensional region in Fig.
P7-77. What is the half-bandwidth? Can the half-bandwidth be reduced? If so,
explain how.
0
4
[i]
Element
Nodes
CD
number
k
m
1
5
4
3
2
2
6
5
2
1
[2J
6
Figure P7-77
7-78
By extending the symbolic notation from Example 7-6, give the expression for the
assemblage nodal force vector for the discretized two-dimensional region in Fig.
P7-77.
7-79
By extending the symbolic notation from Example 7-5, give the expression for the
assemblage stiffness matrix for the discretized two-dimensional region in Fig.
P7-79. Note the use of two different types of elements. What is the half-bandwidth?
Can the half-bandwidth be reduced? If so, explain how.

354
STRESS ANALYSIS
0)
CD
CD
Element
Nodes
number
k
m
CD
[2J
CD
1
3
4
2
1
2
5
6
4
3
3
6
5
7
(0
0
Figure P7-79
7·80
By extending the symbolic notation from Example 7-6, give the expression for the
assemblage nodal force vector for the discretized two-dimensional region in Fig.
P7-79. Note the use of two different types of clements.
7·81
For the element in Problem 7-7 for a particular loading condition, the following
values of nodal displacements are obtained: u, = 0.00105, Vi = 0.0, ui = -0.00055,
vi = 0.00200, Uk = 0.00150, and Vk = -0.00405 in. Determine the element strains
and stresses that correspond to these displacements if the element is in a state of
plane stress. Assume both the self-strains and prestresses arc zero.
7-82
Repeat Problem 7-81 for the case of plane strain. Take t to be unity.
7-83
For the clement in Problem 7-9 for a particular loading condition, the following
values of nodal displacements arc obtained: u, = 0.00215, Vi =
-0.00300, uJ =
0.0, vi = 0.00560, u, '= -0.00520, and Vk = 0.00650 cm. Determine the element
strains and stresses that correspond to these displacements if the clement is in a
state of plane stress. Assume both the self-strains and prestresses are zero.
7-84
Repeat Problem 7-83 for the case of plane strain. Take t to be unity.
7-85
For the element in Problem 7-11 for a particular loading condition, the following
values of nodal displacement are obtained: Ui = - 0.01250, Vi = 0.02300, uJ =
0.01500, vJ = - 0.01550, u, = 0.01750, and Vk = 0.0 cm. Determine the element
strains and stresses that correspond to these displacements if the clement is in a
state of plane stress. Assume the self-strains and prestresses from Problems 7-29
and 7-40.
7-86
Repeat Problem 7-85 for the case of plane strain. Take t to be unity. Assume the
self-strains and prestresses from Problems 7-30 and 7-40.
7-87
For the element in Problem 7-13 for a particular loading condition, the following
values of nodal displacements are obtained: u, = 0.02150,
Vi = 0.02350, uJ =
-0.01575, Vi = 0.02550, Uk = 0.02500, and Vk = 0.0 in. Determine the element
strains and stresses that correspond to these displacements if the element is in a
state of plane stress. Assume the self-strains and prestresses from Problems 7-31
and 7-41.
7-88
Repeat Problem 7-87 for the case of plane strain. Take t to be unity. Assume the
self-strains and prestresses from Problems 7-32 and 7-41.

PROBLEMS
355
7-89
For the element in Problem 7-18 for a particular loading condition, the following
values of nodal displacements are obtained: Uj = 0.02250, Vi =
- 0.°1250, Uj =
0.02555, Vj = 0.02350, Uk = 0.02500, Vk =
-0.02340, Um = 0.01235, and Vm
=
- 0.02500 cm. Determine the element strains and stresses at the element centroid
that correspond to these displacements if the element is in a state of plane stress.
Assume both the self-strains and prestresses are zero.
7-90
Repeat Problem 7-89 for the case of plane strain. Take t to be unity.
7-91
For the element in Problem 7-20 for a particular loading condition, the following
values of nodal displacements are obtained: u, = -0.01250,
Vj = -0.03050, Uj
= 0.02500,
Vj = 0.03150,
Uk =
- 0.02500, Vk = 0.03350, Um = 0.0, and Vm =
0.03500 in. Determine the element strains and stresses at the element centroid that
correspond to these displacements if the element is in a state of plane stress. Assume
both the self-strains and prestresses are zero.
7-92
Repeat Problem 7-91 for the case of plane strain. Take t to be unity.
7·93
Derive the 8 matrix for the case of axisymmetric stress analysis for the four-node
rectangular element.
7-94
Consider the triangular element shown in Fig. P7-7. The body from which the
element is extracted is made of hard drawn copper. The nodal coordinates are ri =
2.0, z, =
1.5, rj =
1.7, Zj = 3.0,
rk
= 0.6, and Zk =
1.8 in. Determine the
element stiffness matrix assuming the body is a body of revolution and is loaded
axisymmetrically.
7-95
Consider the triangular element shown in Fig. P7-9. The body from which the
element is extracted is made of cast iron. The nodal coordinates are ri = 5, z, =
6, rj = 4,
Zj = 4, rk = 6, and Zk = 4 ern, Assuming the body is a body of
revolution loaded axisymmetrically, determine the element stiffness matrix.
7-96
Consider the triangular element shown in Fig. P7-II. The element is extracted from
a body of revolution and is loaded axisymmetrically. The material is aluminum
(6061 alloy). The nodal coordinates are r, = 10, z, = 10, rj = 10, Zj = 9, rk =
12, and Zk = 9 ern. Determine the element stiffness matrix.
7-97
Consider the triangular element shown in Fig. P7-13. The element is extracted from
a body of revolution and is loaded axisymmetrically. The material is cast iron. The
nodal coordinates are r, = 20, z, = 20, rj = 21, Zj = 22, rk =
19, and Zk =
22 in. Determine the element stiffness matrix.
7-98
Show that the element stiffness matrix for axisymmetric stress analysis as given by
Eq. (7-53) for the three-node triangular element is always symmetric.
7-99
Show that the element stiffness matrix for axisymmetric stress analysis for the four-
node rectangular element is always symmetric.
7-100
What is the size of the element stiffness matrix for the case of axisymmetric stress
analysis if the four-node rectangular element is used? Justify your answer.
7-101
Determine the element stiffness matrix for the element shown in Fig. P7-18.' The
element is extracted from a cast iron body of revolution that is loaded axisym-
metrically. The coordinates of the nodes are rj = 34, z, = 32, rj = 34, Zj = 33,

356
STRESS ANALYSIS
rk = 32, Zk = 33, r m = 32, and Zm = 32 em. Perform the integrations by evaluating
the integrands at the element centroid and treating the integrands as constants.
7-102
Determine the element stiffness matrix for the element shown in Fig. P7-20. The
element is extracted from a hot rolled, low carbon steel body of revolution that is
loaded axisymmetrically. The coordinates of the nodes are r, = 55, z, = 52, rj =
55. z) = 54, rk = 52, Zk = 54, r m = 52, and Zm = 52 in. Perform the integrations
by evaluating the integrands at the element centroid and treating the integrands as
constants.
7-103
What size is the element nodal force vector from a self-strain if the four-node
rectangular element is used in axisymmetric stress analysis?
7·104
Determine a general expression for the element nodal force vector from a uniform
self-strain for the rectangular element in axisymmetric stress formulations. Perform
the integrations by evaluating the integrand at the element centroid and treating the
integrands as though they were constants.
7-105
For the element in Problem 7-94, determine the element nodal force vector as a
result of a self-strain if the temperature increases by 70°F.
7-106
For the element in Problem 7-95, determine the element nodal force vector as a
result of a self-strain if the temperature increases by 25°C.
7-107
For the element in Problem 7-96, determine the element nodal force vector as a
result of a self-strain if the temperature decreases by 60°C.
7·108
For the element in Problem 7-97, determine the element nodal force vector as a
result of a self-strain if the temperature increases by 55°F.
7-109
For the element in Problem 7-101, determine the element nodal force vector as a
result of a self-strain if the temperature increases by 35°C. Perform the integrations
by evaluating the integrands at the element centroid and treating the integrands as
though they were constants.
7·110
For the element in Problem 7-102. determine the element nodal force vector as a
result of a self-strain if the temperature decreases by nOF. Perform the integrations
by evaluating the integrands at the element centroid and treating the integrands as
though they were constants.
7-111
Determine a general expression for the element nodal force vector from a uniform
prestress for the triangular element in axisymmetric stress analysis by performing
the exact integrations. Hint: Use area coordinates to represent r in the following
manner:
r = Lr, + Lj"j + L~k
and then apply Eq. (6-49).
7·112
Determine a general expression for the element nodal force vector from a uniform
prestress. for the rectangular element in axisymmetric stress analysis. Perform the
integrations by evaluating the integrand at the element centroid and treating the
integrands as though they were constants.

PROBLEMS
357
7-113
For the element in Problem 7-94, determine the element nodal force vector as a
result of the following prestresses: arro = - 800, aeeo = 1750, a"o = 1000, and
a"o =
- 500 psi.
7-114
For the element in Problem 7-95, determine the element nodal force vector as a
result of the following prestresses: arro = 2000, aeeo = - 3200, azzo = 1500, and
a"o =
- 1800 Nzcm".
7-115
For the element in Problem 7-96, determine the element nodal force vector as a
result of the following prestresses: arro = 2300, aeeo = 0, a"o =
1550, and a"o
=
-2100 Nzcm'.
7-116
For the element in Problem 7-97, determine the element nodal force vector as a
result of the following prestresses: afrO =
1200, aeeo =
-800, a"o = 900, a"o
= 400 psi.
7-117
For the element in Problem 7-10 I, determine the element nodal force vector as a
result of the following prestresses: afrO = - 2400, aeeo = - 1500, a"o = 2000,
and a rzo = 500 Nzcm', Perform the integrations by evaluating the integrands at the
element centroid and treating the integrands as though they were constants.
7-118
For the element in Problem 7-102, determine the element nodal force vector from
the following prestresses: arro =
1400, aeeo = - 2800, a"o = 900 and a rzo =
1925 psi. Perform the integrations by evaluating the integrands at the element cen-
troid and treating the integrands as though they were constants.
7-119
Determine a general expression for the element nodal force vector from a uniform
body force for the triangular element in axisymmetric stress problems by performing
the exact integrations. Hint: See Problem 7-111.
7-120
Determine a general expression for the element nodal force vector from a uniform
body force for the rectangular element in axisymmetric stress problems. Perform
the integrations by evaluating the integrand at the element centroid and treating the
integrands as though they were constants.
7-121
For the element in Problem 7-94, determine the element nodal force vector as a
result of a body force with the following components: b,
=
500 and b,
=
125
lbf/in'.
7-122
For the element in Problem 7-95, determine the element nodal force vector as a
result of a body force with the following components: b, =
1500 and b, = 500
Nzcm',
7-123
Assume that the element in Problem 7-96 is oriented such that the z axis is in the
direction opposite that of gravity. If the body is rotated at 12 rad/sec about the z
axis, determine the element nodal force vector. The acceleration due to gravity is
9.81 m/s', State all assumptions made.
7·124
Assume that the element in Problem 7-97 is oriented such that the z axis is in the
same direction as that of gravity. If the body is rotated at 15 rad/sec about the z
axis, determine the element nodal force vector. The acceleration due to gravity is
32.2 ft/s'. State all assumptions made.

358
STRESS ANALYSIS
7·125
For the element in Problem 7·101, determine the element nodal force vector from
a body force with the following components: b, =
1500 and bz = 450 Nzcrn'.
Perform the integrations by evaluating the integrands at the element centroid and
treating the integrands as though they were constants.
7·126
Assume that the element in Problem 7-102 is oriented such that the z axis is in the
direction opposite that of gravity. If the body is rotated at 20 rad/sec about the z
axis, determine the element nodal force vector. The acceleration due to gravity is
32.2 ft/sec '. Perform the integrations by evaluating the integrands at the element
centroid and treating the integrands as though they were constants.
7·127
Determine a general expression for the element nodal force vector from a uniform
surface traction on face ij for the rectangular element in a state of axisymmetric
stress. Perform the integrations by evaluating the integrand at the center of face ij
and treating the integrands as though they were constants.
7·128
Determine a general expression for the element nodal force vector from a uniform
surface traction on face km for the rectangular element in a state of axisymmetric
stress. Perform the integrations by evaluating the integrand at the center of face km
and treating the integrands as though they were constants.
7·129
For the element in Problem 7-94, determine the element nodal force vector as a
result of a surface traction on leg ij with the following components: s, =
- 1000
and s, = 500 psi.
7·130
For the element in Problem 7·95, determine the element nodal force vector as a
result of a surface traction on leg ki with the following components: s, =
- 1500
and s, = -800 Nzcm",
7·131
For the element in Problem 7·96, determine the element nodal force vector as a
result of a surface traction on leg jk with the following components: s, =
- 1200
and s, = 925 Nzcm-.
7·132
For the element in Problem 7·97, determine the element nodal force vector as a
result of a surface traction on leg ki with the following components: s, =
- 4200
and s, = 0 psi.
7·133
For the element in Problem 7-101, determine the element nodal force vector as a
result of a surface traction on face ij with the following components: s, =
- 2350
and s, = 500 Nzcm'. Perform the integrations by evaluating the integrands at the
center of face ij and treating the integrands as though they were constants.
7·134
For the element in Problem 7·102, determine the element nodal force vector as a
result of a surface traction on face mi with the following components: s, =
- 1600
and s, = 800 psi. Perform the integrations by evaluating the integrands at the center
of face mi and treating the integrands as though they were constants.
7·135
It has been assumed in the derivation leading to Eq. (7-62) in the text that the
surface traction is uniform over the leg of the triangle in question. Derive an altemate
expression for the nodal force vector for a linearly varying surface traction on leg
ij of the three-node triangular element, shown in Fig. P7-135. Proceed by assuming
the following forms for s, and S,:

PROBLEMS
359
s, =
N;sr; + N;rj
S; =
N;sz; + N;;j
where
Sri is the r component of the surface traction at node i, etc. In addition,
represent the variable r in the integrands in terms of the nodal values of r (i.e., r;
and rj) and the length coordinates L; and Lj . Finally, write the shape functions in
terms of the length coordinates (defined on leg ij) and use Eq. (6-48) to perform
the integrations.
Figure P7-135
k
Szi
Szj
k
7-136
Repeat Problem 7-135 for a uniformly varying surface traction on legjk. At nodes
j and k, the rand 2 components of the surface traction are Srj and Srk, and Szj and
S,b respectively.
7-137
Repeat Problem 7-136 for a uniformly varying surface traction on leg ki. At nodes
k and i, the rand 2 components of the surface traction are Srk and Sri' and Szk and
Sz;, respectively.
7-138
For the element in Problem 7-94, determine the element nodal force vector as a
result of a point load that has the following components: fpr
=
1200 and fpz
=
-750 Ibf/in. The point load is located at ro = 1.2 and 20 = 2.2 in.
7-139
For the element in Problem 7-95, determine the element nodal force vector as a
result of a point load with the following components: fpr
=
- 1000 and fpz
=
500 N/cm. The point load is located at ro = 5.5 and 20 = 4.3 em.
7-140
For the element in Problem 7-96, determine the element nodal force vector as a
result of a point load with the following components: fpr = 2400 and /pz = 1500
N/cm. The point load is located at ro = II and 20 = 9 em.
7-141
For the element in Problem 7-97, determine the element nodal force vector as a
result of a point load with the following components: fpr = - 2250 and fpz =
-2800 Ibf/in. The point load is located at ro = 20 and 20 = 21.5 in.
7-142
For the element in Problem 7-101, determine the element nodal force vector as a
result of a point load with the following components: fpr
=
- 3150 and /pz
1500 N/cm. The point load is located at ro = 33.0 and 20 = 32.5 em.

360
STRESS ANALYSIS
1-143
For the element in Problem 7-101. determine the clement nodal force vector as a
result of a point load with the following components: 1,,, =
- 3150 and J~,
=
1500 N/em. The point load is located at 'u = 34 and Zo = 32 em.
1-144
For the element in Problem 7-102. determine the element nodal force vector as a
result of a point load with the following components: Ip,
=
- 2575 and J;"
=
1260 lbf/in. The point load is located at '0 = 54 and Zo = 53 in.
1-145
For the element in Problem 7-102. determine the element nodal force vector as a
result of a point load with the following components: I p,
=
- 3500 and .f,,, =
800 lbf/in. The point load is located at '0 = 52 and Zo = 54 in.
1-146
Using the symbolic notation from Example 7-5. give the expression for the assem-
blage stiffness matrix for the discretized axisymmetric region in Fig. P7-69.
1-141
Using the symbolic notation from Example 7-6. give the expression for the assem-
blage nodal force vector for the discretized axisymmetric region in Fig. P7-69.
1-148
Using the symbolic notation from Example 7-5. give the expression for the assem-
blage stiffness matrix for the discretized axisymmetric region in Fig. P7-71.
1-149
Using the symbolic notation from Example 7-6. give the expression for the assem-
blage nodal force vector for the discretized axisymmetric region in Fig. P7-71.
1-150
Using the symbolic notation from Example 7-5. give the expression for the assem-
blage stiffness matrix for the discretized axisymmetric region in Fig. P7-73.
1-151
Using the symbolic notation from Example 7-6. give the expression for the assem-
blage nodal force vector for the discretized axisymmetric region in Fig. P7-73.
1-152
By extending the symbolic notation from Example 7-5. give the expression for the
assemblage stiffness matrix for the discretized axisymmetric region in Fig. P7-75.
1-153
By extending the symbolic notation from Example 7-6. give the expression for the
assemblage nodal force vector for the discretized axisymmetric region in Fig.
P7-75.
1-154
By extending the symbolic notation from Example 7-5. give the expression for the
assemblage stiffness matrix for the discretized axisymmetric region in Fig. P7-77.
1·155
By extending the symbolic notation from Example 7-6, give the expression for the
assemblage nodal force vector for the discretized axisymmetric region in Fig.
P7-77.
1-156
By extending the symbolic notation from Example 7-5, give the expression for the
assemblage stiffness matrix
for
the discretized axisymmetric region
in Fig.
P7-79. Note the use of two different types of elements.
1-151
By extending the symbolic notation from Example 7-6, give the expression for the
assemblage nodal force vector for the discretized axisymmetric region in Fig.
P7-79. Note the use of two different types of elements.
1-158
For the element in Problem 7-94 for a particular loading condition, the following
values of nodal displacements are obtained: U; = 0.00235, V; = 0.0. Uj = - 0.00555.
v, = 0.00260. u, = 0.00150, and I'k = - 0.00645 in. Determine the element strains

PROBLEMS
361
and stresses that correspond to these displacements. Assume that both the element
self-strains and prestresses are zero.
7-159
For the element in Problem 7-95 for a particular loading condition, the following
values of nodal displacements are obtained: u, = 0.01215,
Vi = -0.01300, Uj =
0.0,
Vj = 0.00560,
Uk = -0.00555, and
Vk = -0.00750 em. Determine the
element strains and stresses that correspond to these displacements. Assume that
both the self-strains and prestresses are zero.
7·160
For the element in Problem 7-96 for a particular loading condition, the following
values of nodal displacements are obtained: u, = -0.01250, Vi = -0.02350, Uj
= 0.03500, v) = 0.01550,
Uk = - 0.01775, and Vk = 0.01010 em. Determine
the element strains and stresses that correspond to these displacements. Assume that
both the self-strains and prestresses are zero.
7·161
For the element in Problem 7-97 for a particular loading condition, the following
values of nodal displacements are obtained: Ui = -0.02150, Vi = -0.02350, uj
= 0.01875. Vj = 0.02550, Uk = 0.02500, and Vk = 0.0 in. Determine the element
strains and stresses that correspond to these displacements. Assume that both the
self-strains and prestresses are zero.
7-162
For the element in Problem 7-101 for a particular loading condition, the following
values of nodal displacements are obtained: ui =
- 0.02750, Vi = 0.01250,
Uj =
0.04555, v) = 0.03350,
Uk = 0.02555,
Vk = -0.02350,
Um = -0.01235, and
Vm = 0.02500 em. Determine the element strains and stresses at the element centroid
that correspond to these displacements. Assume that both the self-strains and pre-
stresses are zero.
7-163
For the element in Problem 7-102 for a particular loading condition, the following
values of nodal displacements are obtained: u, =
- 0.02250,
Vi =
- 0.02050,
Uj
= 0.01500, vi = - 0.03150,
Uk = 0.02530,
Vk = - 0.03350,
Um = 0.0, and Vm
= 0.03500 in. Determine the element strains and stresses at the element centroid
that correspond to these displacements. Assume that both the self-strains and pre-
stresses are zero.
7·164
The body from which a tetrahedral element is extracted is made of bronze. The
nodal coordinates of the element are Xi = 2.0, Yi = 1.5, Z, = 0.0, Xj = I. 7, Yj =
3.0,
Zj = -0.2, Xk = 1.5, Yk = 2.0, Zk = 1.7, Xm = 0.6, Ym = 1.8, and Zm =
0.1 in. Determine the element stiffness matrix.
7·165
The body from which a tetrahedral element is extracted is made of hard drawn
copper. The nodal coordinates of the element are Xi = 5, Yi = 6, z, = 0, Xj = 4,
Yj = 4,
Zj = 0,
Xk = 5, Yk = 5,
Zk = 4, x; = 6, Ym = 4, and Zm = 0 em.
Determine the element stiffness matrix.
7-166
Show that the element stiffness matrix for three-dimensional stress analysis as given
by Eq. (7-73) for the four-node tetrahedral element is always symmetric.
7-167
Show that the element stiffness matrix for three-dimensional stress analysis for the
eight-node brick element is always symmetric.
7-168
What is the size of the element stiffness matrix for the case of three-dimensional
stress analysis if the eight-node brick element is used?

362
STRESS ANALYSIS
7·169
Determine the element stiffness matrix for the eight-node brick element defined
below. The element is extracted from a hot rolled, high carbon steel structure. The
coordinates of the nodes are XI
= 34,)'1 = 32, ZI
= 20, Xz = 34,)'z = 33, 2Z
= 20, X3 = 32,)'3 = 33, 23 = 20, X4 = 32, )'4 = 32, Z4 = 20, X5 = 34')'5 =
32, Z5 =
18, X6 = 34')'6 = 33, Z6 =
18, X7 = 32,)'7 = 33, Z7 = 18, X8 = 32,
)'g = 32, and Zg =
18 in. Perform the integrations by evaluating the integrands at
the element centroid and treating the integrands as constants.
7·170
Determine the element stiffness matrix for the eight-node brick element defined
below. The element is extracted from an aluminum (6061 alloy) structure. The
coordinates of the nodes are XI
= 45')'1 = 32,
ZI
=
12, Xz = 45, ),z = 34, Zz
=
12, X3 = 42')'3 = 34, Z3 =
12, X4 = 42, )'4 = 32, Z4 = 12, X5 = 45')'5 =
32, Z5 = 9, X6 = 45, )'6 = 34, Z6 = 9, X7 = 42, )'7 = 34, Z7 = 9, Xg = 42')'8
= 32. and Z8 = 9 em. Perform the integrations by evaluating the integrands at the
element centroid and treating the integrands as constants.
7·171
What size is the element nodal force vector from a self-strain if the eight-node brick
element is used in three-dimensional stress analysis?
7·172
Determine a general expression for the element nodal force vector from a uniform
self-strain for the brick element in three-dimensional stress formulations. Perform
the integrations by evaluating the integrands at the element centroid and treating
the integrands as though they were constants.
7·173
For the element in Problem 7-164, determine the element nodal force vector as a
result of a self-strain if the temperature increases by 50°F.
7-174
For the element in Problem 7-165, determine the element nodal force vector as a
result of a self-strain if the temperature decreases by n°e.
7·175
For the element in Problem 7-169, determine the element nodal force vector as a
result of a self-strain if the temperature decreases by 48°F. Perform the integrations
by evaluating the integrands at the element centroid and treating the integrands as
though they were constants.
7·176
For the element in Problem 7-170, determine the element nodal force vector as a
result of a self-strain if the temperature increases by 37°e. Perform the integrations
by evaluating the integrands at the element centroid and treating the integrands as
though they were constants.
7·177
Determine a general expression for the element nodal force vector from a uniform
prestress for the brick element in three-dimensional stress analysis. Perform the
integrations by evaluating the integrand at the element centroid and treating the
integrands as though they were constants.
7·178
Determine a general expression for the element nodal force vector from a uniform
body force for the brick element in three-dimensional stress problems. Perform the
integrations by evaluating the integrand at the element centroid and treating the
integrands as though they were constants.
7·179
For the element in Problem 7-164, determine the element nodal force vector as a
result of a body force with the following components: b, =
100, by =
125, and
b, = 75 lbf/in '.

PROBLEMS
363
7·180
For the element in Problem 7-165, determine the element nodal force vector as a
result of a body force with the following components: b, = 70, b; = 100, and b,
= 40 Nzcrn'.
.
7·181
For the element in Problem 7-169, determine the element nodal force vector from
a body force with the following components: b, = 30, b; = 50, and bz = 20
Ibf/in. 3. Perform the integrations by evaluating the integrands at the element centroid
and treating the integrands as though they were constants.
7-182
Assume that the element in Problem 7-170 is oriented such that the z axis is in the
direction opposite that of gravity. If no other body forces exist, determine the
corresponding element nodal force vector. The acceleration due to gravity is 9.81
m/s'. Perform the integrations by evaluating the integrands at the element centroid
and treating the integrands as though they were constants.
7·183
Derive a procedure that could be used to evaluate the area of a typical face of the
tetrahedral element. This area is need for use in Eq. (7-78).
7-184
Determine a general expression for the element nodal force vector from a uniform
surface tractions on face 1-2-3-4 for the brick element in a state of three-dimensional
stress. Perform the integrations by evaluating the integrand at the center of the face
and treating the integrands as though they were constants.
7-185
Determine a general expression for the element nodal force vector from a uniform
surface traction on face 5-6-2-1 for the brick element in a state of three-dimensional
stress. Perform the integrations by evaluating the integrand at the center of the face
and treating the integrands as though they were constants.
7-186
For the element in Problem 7-164, determine the element nodal force vector as a
result of a surface traction on face ijk with the following components: s, =
- 1000,
s, = 500, and s, = 750 psi.
7-187
For the element in Problem 7-165, determine the element nodal force vector as a
result of a surface traction on face ikm with the following components: s, =
- 1500,
Sy =
- 800, and s, = 300 Nzcm'.
7-188
For the element in Problem 7-169, determine the element nodal force vector as a
result of a surface traction on face 5-6-7-8 with the following components: s, =
1600, s, = -925, and s, = -400 psi. Perform the integrations by evaluating the
integrands at the centroid of the face and treating the integrands as though they were
constants.
7-189
For the clement in Problem 7-170, determine the element nodal force vector as a
result of a surface traction on face 8-7-3-4 with the following components: s, =
- 3200, s, = 0, and s. = 2500 Nzcm'. Perform the integrations by evaluating the
integrands at the centroid of the face and treating the integrands as though they were
constants.
7-190
It has been assumed in the derivation leading to Eq. (7-78) in the text that the
surface traction is uniform over the face of the tetradedral clement in question.
Derive an alternate expression for the nodal force vector for a linearly varying
surface traction on face ijk of a four-node tetrahedral element. Proceed by assuming
the following forms for .I'p S,' and S,:

364
STRESS ANALYSIS
.1', = Nis; + N,S'j + Nks,k
.1', = Nis., + Ni»; + Nks,k
.1': = N;s" + NJs:J + Nks:k
where .1',; is the x component of the surface traction at node i, etc. Write the shape
functions in terms of the area coordinates (defined on face ijk) and use Eq. (6-49)
to perform the integrations.
7-191
Repeat Problem 7-190 for a linearly varying surface traction on legjkm.
7-192
For the element in Problem 7-165, determine the element nodal force vector as a
result of a point load that has the following components: Jp , = 600, Jp, =
- 750,
and Jp: = 500 N. The point load is located at Xo = 5, Yo = 5, and 20 = 4 cm.
7-193
For the element in Problem 7-169, determine the element nodal force vector as a
result of a point load with the following components: Jp•
=
-1500, Jp,
= 500,
and Jp: = 880 Ibf. The point load is located at Xo = 33.5, Yo = 32.5. and 20 =
20.0 in.
7-194
For the element in Problem 7-164 for a particular loading condition, the following
values of nodal displacements are obtained: u, =
- 0.01250, V; =
- 0.02350, W, =
0.02220, Uj = 0.03500. vJ = 0.01550, wJ = -0.01245, Uk = -0.01775, VI =
0.01010, Wk = 0.0, u ; = -0.01135, I'm = 0.00990, and w'" = 0.0 in. Determine
the element strains and stresses that correspond to these displacements. Assume that
both the self-strains and prestresses are zero.
7-195
For the element in Problem 7-165 for a particular loading condition, the following
values of nodal displacements are obtained: U; = 0.02250, V; = 0.02050,
W, =
-0.05520, uJ = -0.03575, Vj = 0.01750, Wj = 0.03245, Uk = 0.01775, Vk =
-0.01750, Wk = 0.07850, u ; = 0,02435, I'm = -0.01990, and W m = 0.05450
cm. Determine the element strains and stresses that correspond to these displace-
ments. Assume that both the self-strains and prestresses are zero.
7-196
With the help of Fig. 7-17, verify Eq. 0-82) by doing a force balance on the
infinitesimal beam clement in the y direction.
7-197
With the help of Fig. 7-17, verify Eq. (7-83) by doing a moment balance about
some convenient point on the infinitesimal beam element.
7-198
Derive the variational principle that corresponds to Eq. 0-88). What is the highest-
order derivative present in the functional? Please explain. Hint: Refer to Chapter 4
(and use integration by parts twice).
7-199
Verify that the shape functions given by Eq. 0-100) for the beam element satisfy
the following conditions:
a. At x =
Xi (where
~ = 0):
N u ; =
I
b. At x = xJ (where ~ = I):
NUJ =
I
N"'i = N A; = N Oj = 0

PROBLEMS
365
7-200
Verify that the shape functions given by Eq. (7-100) for the beam element satisfy
the conditions given by Eqs. (7-103) and (7-104).
7-201
Derive the finite element characteristics for the beam model [i.e., Eqs. (7-116) to
(7-118)l from the variational principle from Problem 7-198. Are the resulting integral
expressions the same as those derived with the Galerkin method? Please explain.
It is not necessary to evaluate the integrals.
7-202
Consider the beam element shown in Fig. P7-202. The beam from which the element
is extracted is made of hot rolled, low carbon steel. The beam is rectangular in
cross-section with a width w of 4 ern and a height h of 8 em. The coordinates of
nodes i and j are Xi = 5 and Xj = 6 ern. Determine the element stiffness matrix.
H
D1
Figure P7-202
7-203
Consider the beam element shown in Fig. P7-202. The beam from which the element
is extracted is made of aluminum (6061 alloy). The beam is rectangular in cross-
section with a width w of 3 in. and a height h of 4 in. The coordinates of nodes i
and j are Xi = 32 and xJ = 36 in. Determine the clement stiffness matrix.
7-204
Consider the beam element shown in Fig. P7-204. The I-beam from which the
element is extracted is made of hot rolled, high carbon steel. The cross-section of
the beam is also shown in Fig. P7-204 with the dimensions w = 4 in., h = 8 in..
and t = I in. The coordinates of nodes i and j are Xi = 42 and XI = 48 in. Determine
the element stiffness matrix.
Beam element
Figure P7-204
7-205
Consider the beam c1cment shown in Fig. P7-204. The I-beam from which the
element is extracted is made of cast iron. The cross-section of the beam is shown
in Fig. P7-204 with the dimensions w = 6 ern, h =
10 cm, and t = 2 ern. The
coordinates of nodes i and j are Xi = 20 and Xi = 24 cm. Determine the element
stiffness matrix.
7-206
A solid circular bar made from brass is to be used as a beam in a certain application.
The diameter of the bar is 3 ern. The coordinates of nodes i andj are Xi = 32 and
Xj = 36 in. Determine the element stiffness matrix.
7-207
A solid circular bar made from hot rolled, low carbon steel is to be used as a beam
in a certain application. The diameter of the bar is I in. The coordinates of nodes
i and j are Xi = 16 and xJ = 18 in. Determine the element stiffness matrix.

366
STRESS ANALYSIS
7·208
Consider the beam element from Problem 7-202. Determine the nodal force vector
for the element if a downward force of 1000 N and a counterclockwise moment of
800 N'cm act at node i.
7-209
Consider the beam element from Problem 7-203. Determine the nodal force vector
for the element if a downward force of 1200Jbf and a counterclockwise moment
of 800 lbf-in act at node i.
7·210
Consider the beam element from Problem 7-204. Determine the nodal force vector
for the element if an upward force of 1500 Ibf and a clockwise moment of 1800
Ibf·in act at node i,
7-211
Consider the beam element from Problem 7-205. Determine the nodal force vector
for the element if an upward force of 500 N and a clockwise moment of 750 N'cm
act at node j.
7-212
Consider the beam element from Problem 7-206. If an upward force of 350 Nand
a counterclockwise moment of 400 N-cm act at node i, and if a downward force
of 425 N acts at node i, determine the nodal force vector for the element.
7-213
Consider the beam element from Problem 7-207. If an upward force of 425 Ibf and
a clockwise moment of 675 lbf·in act at node i, and if a counterclockwise moment
of 425 Ibf·in acts at node j, determine the nodal force vector for the element.
7-214
For the beam element from Problem 7-202, determine the nodal force vector for
the element if a uniformly distributed load of 1500 N/cm acts in the downward
direction.
7-215
For the beam element from Problem 7-203, determine the nodal force vector for
the element if a uniformly distributed load of 1200 Ibf/in. acts in the downward
direction.
7-216
For the beam element from Problem 7-204, determine the nodal force vector for
the element if a uniformly distributed load of 1650 lbf/in. acts in the upward
direction.
7-217
For the beam element from Problem 7-205, determine the nodal force vector for
the element if a uniformly distributed load of 850 Nrcm acts in the upward direction.
7-218
For the beam element from Problem 7-206, determine the nodal force vector for
the element if a uniformly distributed load of 785 N/cm acts in the downward
direction.
7-219
For the beam element from Problem 7-207, determine the nodal force vector for
the element if a uniformly distributed load of 685 Ibf/in. acts in the upward direction.
7-220
Using as much of Example 7-7 as is possible, resolve for the nodal deflections and
slopes if the spring is removed. Assume only two elements and that the right end
of the beam is simply supported.
7-221
Assuming only two elements and using as much of Example 7-7 as is possible,
resolve for the nodal deflections and slopes if the left end of the beam is simply
supported.
7-222
Using as much of Example 7-7 as is possible, resolve for the nodal deflections and
slopes if the both ends of the beam are simply supported (the spring is removed).
Assume only two elements.

PROBLEMS
367
7-223
Assuming only two elements and using as much of Example 7-7 as is possible,
resolve for the nodal deflections and slopes if both ends of the beam are cantilevered
(the spring is removed).
7-224
Reconsider the beam in Example 7-7. The distributed load p is now 3000 lbf/ft and
the point load Pis 1000 Ibf. The spring is removed (so k, should be taken as zero).
The beam is rectangular in cross-section with a width b of 1.5 in. and a height h
of 3 in. The beam is made of hot rolled, high carbon steel and is 3 ft long. Using
only two equal-length elements, determine the deflections and slopes at the ends
and midspan of the beam. In addition, determine the moment, shear force, maximum
bending stress, and maximum shear stress at the middle of the distributed load.
7-225
Modify the TRUSS program in Appendix B so that it may be used to solve for the
nodal deflections and slopes of a beam. Allow for up to 30 elements with up to 5
different materials. The input to the program should be modeled after the input to
the TRUSS program. For each material, read in the following parameters: the elastic
modulus E, the moment of inertia J, the distributed loading p, and the distance Cmax
from the neutral plane to the outermost fibers (needed in the stress calculations).
Treat the prescribed deflections and slopes with positive boundary condition flags,
and the imposed forces and moments with negative flags (see the TRUSS program).
At the center of each element, the following results should be given in the output:
the bending moment, the shear force, the maximum bending stress, and the maximum
shear stress. These results should be calculated in a postprocessor subroutine.
7-226
Using the computer program from Problem 7-225 or one furnished by the instructor,
solve for the nodal deflections and slopes for the beam from Problem 7-220. In
addition, determine the element resultants at the midpoint of each element. Use 2,
4, and 8 elements.
7-227
Using the computer program from Problem 7-225 or one furnished by the instructor,
solve for the nodal deflections and slopes for the beam from Problem 7-222. In
addition, determine the element resultants at the midpoint of each element. Use 2,
4, and 8 elements.
7-228
Using the computer program from Problem 7-225 or one furnished by the instructor,
solve for the nodal deflections and slopes for the beam from Problem 7-223. In
addition, determine the element resultants at the midpoint of each element. Use 2,
4, and 8 elements.
7-229
Using the computer program from Problem 7-225 or one furnished by the instructor,
solve for the nodal deflections and slopes for the beam in Problem 7-224. In addition,
determine the element resultants at the midpoint of each element. Use 2, 4, and 8
elements.
7-230
Explain in your own words what is meant by substructuring and why is it so vital
in large finite element models. Do not hesitate to use some equations in your
explanation.
7-231
Using the stress analysis program furnished by the instructor, solve for the two-
dimensional stress distribution in the thin plate shown in Fig. P7-231. Note that the
plate has a circular hole in it, and therefore a stress concentration exists in the
vicinity of the hole. Verify that the stress concentration factor is 3 for this condition.
Assume the following: D = 0.5 in.,
W = 6 in., h = 8 in., and s =
1000 psi.

368
STRESS ANALYSIS
0,
I------w----__±_~
Figure P7-231
The plate is made of hot rolled, high carbon steel and has a thickness of 0.375 in.
Note that only one-fourth of the plate needs to be modeled because of the two-axis
symmetry. Use at least 100 elements.
7-232
Using the stress analysis program furnished by the instructor, solve for the two-
dimensional stress distribution in the thin plate shown in Fig. P7-231. Note that the
plate has a circular hole in it, and therefore a stress concentration exists in the
vicinity of the hole. Verify that the stress concentration factor is 3 for this condition.
Assume the following: D = 2 em, W = 12 em, h = 16 em, and s = 1500 N/
ern", The plate is made of hot rolled, high carbon steel and has a thickness of 0.75
em. Note that only one-fourth of the plate needs to be modeled because of the two-
axis symmetry. Use at least 100 elements.
ffi'
f+-----w-----+-.,
Figure P7-233

PROBLEMS
369
7-233
Using the stress analysis program furnished by the instructor, solve for the two-
dimensional stress distribution in the thin plate shown in Fig. P7-233. Note that the
plate has an elliptical hole in it, and therefore a stress concentration exists in the
vicinity of the hole. Determine the value of the stress concentration factor for this
condition. Assume the following: a = 2 ern, b = 1 ern, W = 10 em, h = 20 ern,
and s =
1800 Nzcm-, The plate is made of brass and has a thickness of 0.5 cm.
Note that only one-fourth of the plate needs to be modeled because of the two-axis
symmetry. Use at least 100 elements.
7-234
Using the stress analysis program furnished by the instructor, solve for the two-
dimensional stress distribution in the thin plate shown in Fig. P7-233. Note that the
plate has an elliptical hole in it, and therefore a stress concentration exists in the
vicinity of the hole. Determine the value of the stress concentration factor for this
condition. Assume the following: a = 1 in., b = 0.5 in., W = 5 in., h = 10 in.,
and s = 1400 psi. The plate is made of brass and has a thickness of 0.25 in. Note
that only one-fourth of the plate needs to be modeled because of the two-axis
symmetry. Use at least 100 elements.
7-235
Using the stress analysis program furnished by the instructor, solve for the two-
dimensional stress distribution in the thin plate shown in Fig. P7-235. Note that the
plate has a square hole in it, and therefore a stress concentration exists in the vicinity
of the hole. Determine the value of the stress concentration factor for this condition.
Assume the following: d = 0.5 in.,
W = 10 in., h = 10 in., and s = 2000 psi.
The plate is made of cast iron and has a thickness of 0.5 in. Note that only one-
fourth of the plate needs to be modeled because of the two-axis symmetry. Use at
least 100 elements.
01
h
f-d-J
--...-----w-----++f~-
Figure P7-235
7-236
Using the stress analysis program furnished by the instructor, solve for the two-
dimensional stress distribution in the thin plate shown in Fig. P7-235. Note that the
plate has a square hole in it, and therefore a stress concentration exists in the vicinity
of the hole. Determine the value of the stress concentration factor for this condition.
Assume the following: d = 1 ern, W = 20 em, h = 20 ern, and s = 2500 Nzcrn".
The plate is made of cast iron and has a thickness of 0.5 cm. Note that only one-
fourth of the plate needs to be modeled because of the two-axis symmetry. Use at
least 100 elements.


8
Steady-State Thermal and Fluid
Flow Analysis
8-1
INTRODUCTION
In this chapter several nonstructural applications are considered. Heat conduction
is given fairly extensive treatment. One-, two-, and three-dimensional problems are
formulated; these include convection, thermal radiation to a large enclosure, pre-
scribed heat fluxes, insulation, and prescribed temperatures. Axisymmetric prob-
lems are also formulated. In all cases, the thermal conductivity may be dependent
on temperature. Only isotropic materials, however, are considered in the formal
development. Several problems involving fluid flow are also formulated. The first
is a problem involving convective energy transport. The second is that of two-
dimensional potential flow. This is followed by a general formulation to steady,
two-dimensional, incompressible viscous fluid flow. The chapter is concluded with
a description of a steady, two-dimensional heat transfer program.
Before these formulations are developed, however, it is necessary to introduce
the reader to one of the simpler nonlinear solution methods. This is necessitated
by the fact that if any of the thermal properties is temperature-dependent, the
resulting system of equations for the nodal temperatures is nonlinear. It will also
be seen that the system of equations in some fluid flow problems is nonlinear as
well.
8-2
THE DIRECTITERATION METHOD
From both implementation and mathematical points of view, the direct iteration
method is the simplest of the nonlinear solution methods. However, this method
371

372
STEADY-STATE THERMAL AND FLUID FLOW ANALYSIS
has two main drawbacks. The first is that it does not always converge, and the
second is that the system matrix equation must be in the special form
[K(a)]a = f
as opposed to the more general form
g(a) = f
18-1)
18-2)
Nonetheless, this method is worth studying because of the simplicity it affords.
To solve Eq. (8-1) for the nodal unknowns a, we start the solution process by
guessing appropriate values for a. These values are then used to compute K. The
system Ka = f is then solved for the vector a. If the new a, denoted by a, + I'
agrees with the old a, denoted by a., to within an acceptable tolerance, then the
solution process is stopped; otherwise, a new K matrix is formed using the newly
calculated values in the vector a and the process is repeated. This method Is
summarized in Fig. 8-1. Let us now illustrate this method with two examples.
Guess
a;
1
Compute
K(a;)
1
Solve
Set
K(a;)a;+1 = f
Ii =1;+1
for 8;+1
1
No
Check
ai+1~ai?
res
a = 8;+1 is the
approximate
solution
Figu're 8·1
The direct iteration method.

THE DlRECf ITERATION METHOD
373
Example 8-1
Use the direct iteration method to solve the following nonlinear equation:
x2 + 6x -
5 = 0
Solution
The equation must be cast into the form given by Eq. (8-1), or
(x + 6)x = 5
In terms of the indices i and i + I, we have
(Xi + 6)Xi+l = 5
For an initial guess of Xo = 10, the iterations are as follows:
Xi
Xi+1
0
10.
0.3125
I
0.3125
0.7921
2
0.7921
0.7362
3
0.7362
0.7423
4
0.7423
0.7416
5
0.7416
0.7417
6
0.7417
0.7417
It is seen that convergence to four-place accuracy is attained in six iterations. The
reader should take note that the second root is - 6.7416 (obtained from the quadratic
formula). Innonlinear problems, the root that is taken to be the solution is generally
based on physical reasoning (e.g., perhaps x cannot be negative).
•
Example 8-2
Use the direct iteration method to obtain a set of roots to the following system of
nonlinear equations:
x 2 + 6x + xy2 = 23
6x+xy= 10
Solution
These equations must be cast into the form of Eq. (8-1), or

374
STEADY -STATE THERMAL AND FLUID FLOW ANALYSIS
Using the indices i and i + I, we have
[Xi; 6
X~i][~:::] = [~~]
which may be solved by the matrix-inversion method once an initial guess for X
and Y is made. Alternatively, such a system could be solved with the active zone
equation solver from Sec. 6-8. For initial guesses of Xo = 2 and Yo = 2, the
iterations are summarized as follows:
Xi
Yi
Xj+1
Yi+ I
0
2.000
2.000
- .7500
7.250
I
- .7500
7.250
1.294
-2.980
2
1.294
-2.980
2.097
- 1.997
3
2.097
- 1.997
2.140
- 1.354
4
2.140
- 1.354
2.247
-1.626
5
2.247
-1.626
2.181
- 1.373
6
2.181
- 1.373
2.237
-1.569
7
2.237
-1.569
2.192
-1.409
8
2.192
-1.409
2.228
-1.537
9
2.228
- 1.537
2.199
-1.433
10
2.199
- 1.433
2.222
- 1.517
II
2.222
-1.517
2.203
-1.449
12
2.203
-1.449
2.219
-1.503
13
2.219
-1.503
2.206
- 1.459
14
2.206
-1.459
2.216
-1.495
15
2.216
- 1.495
2.208
-1.466
16
2.208
- 1.466
2.215
-1.489
17
2.215
-1.489
2.209
- 1.470
18
2.209
-1.470
2.214
-1.486
The iterations were stopped when two successive iterations were within I% of each
other.
•
It is emphasized that nonlinear equations in general have more than one solution.
For example, try to verify that x =
I and y = 4 is also a solution to the problem
posed in Example 8-2. Caution must be exercised when attempting to obtain the
solutions to nonlinear problems. For all problems formulated in this chapter, the
direct iteration method tends to give only the physically realizable solution, pro-
viding the initial guesses are reasonable.
8-3
ONE-DIMENSIONAL HEAT CONDUCTION
Recall that a one-dimensional finite element formulation to a specific heat con-
duction problem was presented in Sec. 4-10. In the problem presented there, con-

ONE-DIMENSIONAL HEAT CONDUCfION
375
vection from the lateral surface of the body was included, but not thermal radiation.
In this section, the one-dimensional heat conduction problem is extended to allow
for radiation from the lateral surface of the body. Convection, radiation, and heat
fluxes are also included on the ends of the body, i.e., on the boundaries. One
application of such a problem is an extended surface (or fin) convecting to a fluid
and/or radiating to some other large body or to space. Inthe interest of completeness,
heat generation is also included. A schematic of the one-dimensional heat conduction
model is shown in Fig. 8-2(a).
The Governing Equation
The governing equation for the temperature T is given by
~ ( kA:) -
hP(T -
Ta )
-
wP(T4
-
T:) + QA = 0
(8-3)
where k is the thermal conductivity of the materials, h is the convective heat transfer
coefficient, E is the emissivity of the surface of the body, P is the perimeter, A is
the cross-sectional area, Ta is the ambient fluid temperature far removed from the
Boundary
convection
Boundary_
heat flux
Boundary
radiation
Lateral
convection
(a)
ir-:--li
~XI
x = Xi
(b)
Boundary
radiation
Boundary
convection
Figure 8-2
(a) Schematic of one-dimensional heat transfer problem and (b) typical element.
Note that the boundary heat fluxes may act at a distance (such as the sun).

(8-4)
376
STEADY-STATE THERMAL AND FLUID FLOW ANALYSIS
body, T, is the receiver temperature for the radiation, Q is the heat generation rate
per unit volume, and CT is the Stefan-Boltzmann constant, given by
CT = 5.670 X 10- 8 W/m 2_K4
or
Except for CT, each of these parameters may be a function of x. In addition, the
thermal properties (k, h, and e) may be temperature-dependent. Note that an absolute
temperature scale must be used if radiation is present.
The FEM Formulation
Recall from Chapter 4 that two different approaches may be taken to obtain the
finite element formulations once the governing differential equation is known: the
variational and weighted-residual approaches. The former is not as convenient as
the latter since it requires the intermediate step of determining the corresponding
functional. The Galerkin weighted residual method is particularly well-suited to
nonstructural problems and is used here.
Recall that if an approximation to the temperature T on an element basis is
substituted into Eq. (8-3), the equation will not be satisfied exactly. In general, a
residual R' results. The weighted residual method is stated mathematically by
(
M -....
_ ..•-.--
• '~1 Iv. WTR' dV = 0)
...-/
where M elements are assumed and the matrix W T is the transpose of the so-called
weighting function matrix. For the specific case of the Galerkin method, Eq.
(8-4) becomes
(8-5)
where N represents the shape function matrix. Since the terms in Eq. (8-3) represent
rate of energy transfer per unit length, the form of Eq. (8-5) to be applied to Eq.
(8-3) is
(8-6)
However, let us agree to drop the summation sign because we are really seeking
the finite element characteristics for a typical element. The summation represents
the assemblage process and is no longer delineated since this step is routine.
In what follows, the lineal element from Sec. 6-3 is used. As shown in Fig.
8-2(b), a typical element e connects nodes i and j with coordinates Xi and Xj and

ONE-DIMENSIONAL HEAT CONDUCTION
377
temperatures T, and T;, respectively. This implies a linear temperature distribution
in each element. Therefore, Eq. (8-6) may be written as
LNT [~ (kA:) - hP(T -
Ta) -
EcrP(T4
-
T:) + QA] dx = 0
(8-7)
If the first term is integrated by parts, we get
NTkA ar/
Xi
. _
{ dWkA ardx _
{ WhPT dx + { WhPT dx
dx
J"
dx
dx
J"
J/,
a
x,
The first term in Eq. (8-8) is related to the heat flux qx from conduction in the x
direction. By Fourier's law of heat conduction, we have
(8-9)
This heat flux represents the heat transfer rate per unit cross-sectional area in the
x direction. The minus sign is used to give a positive heat flux in the direction of
decreasing temperature. The first term in Eq. (8-8) will contribute to the assemblage
equations for only the two elements at each end of the body; all internal contributions
to the assemblage equations cancel each other during the assemblage step. Therefore,
this term needs to be evaluated for elements I and M only, assuming the elements
are numbered consecutively from one end of the body to the other.
Let us assume that the heat transfer to or from the ends is given by any
combination of the following three conditions: (I) convection with heat transfer
coefficients hi and hj to a fluid at ambient temperature Tai and Taj , (2) radiation
with surface emissivities e, and Ej and receiver temperatures Tri and Trj , and (3) heat
fluxes qi and qj (possibly acting at a distance such as sun). The subscripts i and j
are used to denote the local node numbers i and j. Let us denote the heat flux from
convection and radiation as qcv and q., respectively. The imposed heat flux will
be denoted as qs. These boundary conditions are shown in Fig. 8-3 for one end of
the body. An energy balance on this end of the body gives
-q,
a,
Figure 8-3
Typical boundary in the one-dimensional heat conduction problem showing
the heat fluxes considered in the finite element formulation.

378
STEADY· STATE THERMAL AND FLUID FLOW ANALYSIS
(8-10a)
or
(8-10b)
Note that qs is defined to be positive if the heat flux is imposed toward the surface.
From Newton's law of cooling at nodej, we have
qcv = hj(T -
Taj)
and from the Stefan-Boltzmann law,
qr = Ep(T4
-
T~)
Since qs = qj at node j, we have for the integrated term at x = Xj'
WkA ::lx~XJ = W( -q,A)I,="
NTAi - q" - qr + qs)lx=x/
(- NThjAjT + NThjAjTa;
-
NT€jApT4
+ NTEjApT~ + NTAjq)lx=x,
A similar expression results for the integrated term at node i, namely,
T
dTl
_
T
T
- N kA d.x
. - (- N hjA;T + N hjAjTaj
X=XI
(8-11)
(8-12)
(8-13)
-
NTEjAjuT 4 + NTEjAjuT~ + NTAjq;llx=Xi
(8-14)
Note the sign of the term on the left; with the minus sign included here, the integrated
term is now given by the sum of the right-hand sides of Eqs. (8-13) and (8-14).
At this point, the parameter function T must be related to the nodal temperatures
in the usual manner by
T = Na"
For convenience, let us write t- as follows:
T4 = T3T = (Nae)3Nae
(8-15)
(8-16)
With the help of Eqs. (8-13) to (8-16), we may write Eq. (8-8) in the form
Keae = f"
(8-17) ~
The composite element stiffness matrix K" is comprised of five element stiffness
or conductance matrices, or
(8-18)
and the composite element nodal force vector f" is comprised of six other element
nodal force vectors, or
fe = f:, + f; + fQ + f,e,'8 + f;B + f;B
(8-19)

ONE-DIMENSIONAL HEAT CONDUCfION
379
(8-20c)
(8-20a)
(8-20b)
Ke =
r
Ke=
.,
K;,. =
Note the use of the B in the subscripts on those terms that arise from the boundary
conditions. The expressions for the element characteristics are given by
I
dNT
dN
-kA-dx
I' dx
dx
LNThPN dx
( NTEaP(Nae)3N dx
)1'
NThiAiNlx~x, + NThjAjNlx~xJ
NTEiAi(J(Nae)3Nlx~Xi + NTEjAp(Nae)3Nlx=xj
(8-20d)
(8-20e)
fe
r
f,e,. = LNThPTv dx
LNTEaPT: dx
(8-21a)
(8-21b)
feQ
(8-21c)
NThiAiTvilx=xi + NThjAjTQjlx=xJ
NTEiAi(JT~lx~x, + NTEjAj(JT~lx~xj
(8-21d)
(8-21e)
and
(8-21f)
Although it has been stated at the outset that the two-node lineal element from
Sec. 6-3 is to be used here, the above expressions for the element characteristics
are quite general. They can be applied readily to all other one-dimensional elements,
some of which are presented in Chapter 9. Several of these expressions will now
be evaluated by way of examples.
Example 8-3
Evaluate the element stiffness matrix K~ for the lineal element from Sec. 6-3.
Solution
1
L
Recognizing that we need the derivatives of the shape functions in the expression
for K~ given by Eq. (8-20a), we first write
dN i = !!.. (Xi - X)
dx
dx
xj
-
Xi
and
~ = !!.. (X - Xi)
dx
dx
Xj
-
Xi
1
+-L

(8·22)
380
STEADY-STATE THERMAL AND FLUID FLOW ANALYSIS
where L is the element length. Substituting these results into Eq. (8-20a) gives
or
Ke=kA[
I
-11]
x
L
-I
where it has been assumed that k and A are constant. If this is not the case, then
suitable average values may be used [e.g., values at x = (x; + x)/2].
•
Example 8-4
Try to evaluate the element stiffness matrix
K~. Use the lineal element from Sec.
6-3.
Solution
For mathematical convenience, let us use the serendipity form of the shape functions
given by Eqs. (6-11), or
and
where
N;
(6·118)
(6·11b)
r =
2(x -
x)
x - x
Ll2
(6·10)
and x =
(Xi + xj)12 defines the centroid of the element. With these definitions,
we attempt to evaluate K~ as follows:
1 + r]
f
+ 1
L
K~ =
NTEOP(Nae)3N - dr
-I
2
f
+ 1 EfJPL[I -r]
--
[I -
r
-I
8
I + r
. [Y2(1 -
r)T; + Y2(1 + r)Tj ]3dr
(8·23)
This integral is most easily evaluated using Gauss-Legendre quadrature, discussed
in Chapter 9. For now, we shall leave K~ in this form.
•

ONE-DIMENSIONAL HEAT CONDUCTION
381
From Example 8-4, it should be noted that the matrix K~ contains the (unknown)
nodal temperatures (Tj and 1]) and, therefore, the resulting assemblage system
equations will be nonlinear. The direct iteration method from Sec. 8-2 may be used
to obtain the solution. However, if the major stiffness contribution is from the
matrix
K~, the direct iteration method is likely to be divergent. In this case, ov-
errelaxation or underrelaxation may be needed to obtain convergence. A detailed
discussion of these refinements to the direct iteration method is beyond the intended
scope of this text.
Example 8-5
Evaluate the element stiffness matrix
K~vB if the lineal element from Sec. 6-3 is
used.
Solution
Recall that one of the properties of the shape functions is given by
Nj(Xj) =
I
Nix;) = 0
Therefore, K~vB may be evaluated as
K~vB =
[~] hjAj[1
or
N;(x) = 0
Nix) =
I
I]
(8-24)
(8-25)
•
It is emphasized that the stiffness matrix given by Eq. (8-25) will contribute
to the assemblage stiffness matrix only if the element is on the boundary (that is,
at one of the ends). Naturally, convection must be present at this end also. For
example, if element 1 connects nodes I and 2, then
K (1 )
= [hlA I
0]
("vB
0
0
Similarly for element M that connects nodes n -
I and n we have
K~~J = [~
h~ ]
IJ
11
All other K~vB's may be taken as the 2 x 2 null matrix.
Example 8-6
Evaluate the element nodal force vector rf.,,. Use the lineal element from Sec. 6-3.

382
STEADY-STATE THERMAL AND FLUID FLOW ANALYSIS
Solution
It is convenient to evaluate the integral in Eq, (8-2Ia) by using length coordinates
and the integration formula given by Eq. (6-48):
f,c" =
( [Li] hPT dx
JI'
Lj
U
[
LLi hPT"dxl
( Lj hPT" dx
J"
(0 + I + I)! LhPTu
[
(I + 16°~ I)! LhPT,,]
(8-26)
O!I!
or
fC = hPLTu [I]
n'
2
I
(8-27)
Not surprisingly, one-half of the total hPLTu is allocated to each node, Note that
, L (without subscripts) represents the element length and is not to be confused with
the length coordinates.
•
Example 8-7
Evaluate the element nodal force vector f"l'B' Use the two-node lineal element.
Solution
Referring back to Example 8-5 and using Eq, (8-2Id), it follows that
or
(8-28)
•
Again it is emphasized that this particular element nodal force vector will
contribute to the assemblage stiffness matrix only if the element has a node on the
global boundary (assuming convection there). For example, if element I connects
nodes I and 2, then

ONE-DIMENSIONAL HEAT CONDUCTION
383
f«(~1 =
[hIA~Tal]
(8-29a)
Similarly for element M that connects nodes n -
I and n we have
f~~ = [h AOT ]
(8-29b)
II
II
un
In effect, all other f,'vB'S may be taken to be the 2 x I null vector.
Example 8-8
Reevaluate the element stiffness matrix K~ by assuming the cross-sectional area A
varies linearly from node i to node j over the lineal element.
Solution
It proves to be very convenient to write the linearly varying cross-sectional area A
as
A(x) = Ni(x)A j + Nj(x)Aj
where Ai and Aj are the cross-sectional areas at nodes i and j. Note that the shape
functions from Sec. 6-3 are linear themselves and, in effect, provide a convenient
interpolation polynomial. Therefore, we have
where L is the element length. In terms of the length coordinates L, and Lj , this
becomes
K' - r [
I
.r
-
)1'
-I
Using the integration formula given by Eq. (6-48), this reduces to the following
simple result:
where A is defined by
K'x
(8-30a)
(8-30b)
•

18-31)
384
STEADY-STATE THERMAL AND FLUID FLOW ANALYSIS
The reader is cautioned about generalizing this result. For example, if K~v is
evaluated in a similar fashion by assuming the perimeter varies linearly over the
lineal element, the result is
Ke
= hL [3P i + Pj
cv
12
Pi + Pj
This is quite different from the result obtained when the perimeter is evaluated at
the element centroid.
Example 8-9
Reconsider Example 4-11 from Sec. 4-10. Recall that the tip of the fin was assumed
to be insulated. Resolve for the temperature distribution for the case of convection
at the tip. Assume that the tip is in contact with a boiling fluid at 10°Cwith a heat
transfer coefficient of 4000 W/m2_oC.
Solution
The element stiffness matrix
K(2l
= [0
0]
[0
evB
0
hjAj
=
0
needs to be added to K(2) in Example 4-11, or
K(2) = [
0.50893
- 0.49951]
- 0.49951
0.50893
[
0.50893
-0.49951]
-0.49951
0.55919
The assemblage stiffness matrix Ka becomes
0.0~026]
[
0.50893
x- =
-0.4~951
-0.49951
1.01786
-0.49951
-0.4~951] W/oC
0.55919
In addition, the element nodal force vector
~~ = [
0
] = [
0
]
ev
hATaj
(4000)(1.2566 x 10- 5)(10)
needs to be added to f(2) in Example 4-11, or
f(2)
_
[0.23561] + [
0
]
_ [0.23561]
-
0.23561
0.50264
-
0.73825
The assemblage nodal force vector fa becomes

THE GREEN-GAUSS THEOREM
38S
[
0.23561]
fa =
0.47122
0.73825
After application of the prescribed temperature of 85°C at node I (using Method I
from Sec. 3-2), we get
[~
o
1.01786
-0.49951
o ][TI] [
85
]
-0.49951
T2
=
42.930
0.55919
T3
0.73825
Solving for the nodal temperatures gives
(8-32)
As expected, the tip temperature is much lower than that obtained in Example
4-11, where the tip was assumed to be insulated. Section 4-10 should be consulted
for a discussion of how the element resultants may be obtained.
•
8-4
THE GREEN·GAUSS THEOREM
The Green-Gauss theorem is essentially a multidimensional version of integration
by parts, the latter of which is given by Eq. (4-32). We found this equation to be
useful when we developed the finite element characteristics in one-dimensional
nonstructural problems. When dealing with two- and three-dimensional problems,
we will again need to use integration by parts. However, the Green-Gauss theorem
is far easier to apply and is mathematically more rigorous.
The Green-Gauss theorem may be derived from the divergence theorem. It
may be recalled that the divergence theoremstates that the integral of the divergence
of a vector over a volume V is precisely equal to the integral of the flux of the
same vector through the closed surface S that bounds the volume V. Stated math-
ematically, the three-dimensional form of the divergence theorem is given by
IvV·q dV = !sq'n dS
where q is any vector, dV is an infinitesimal volume element, dS is an infinitesimal
surface element bounding the volume V, and n is a unit vector that is always normal
to the closed surface S and always directed outward from the body, as shown in
Fig. 8-4(a). The divergence of q is written V·q and in cartesian coordinates is given
by
V'q __ iJqx + ~ + iJqz
(8·33)
iJx
iJy
iJz
where qx, qy' and qz are the x, y, and z components of q. As Eq. (8-33) implies,
the divergence of a vector is a scalar.

386
STEADY-STATE THERMAL AND FLUID FLOW ANALYSIS
Volume V
z
(a)
Area A
v
n
(8-341
'----------x
(b)
Figure 8-4
Definition of terms used in the divergence theorem in (a) three dimensions
and (b) two dimensions.
Equation (8-32) may also be used to represent the two-dimensional form of
the divergence theorem if V is interpreted to be an area A, S to be the path C
enclosing the area, and n to be the normal unit vector pointing outward from the
bounding path in the plane of the area A. In this case Eq. (8-32) is written
LV·q dA = fcq·n dC
The integration around the path C must be performed in the counterclockwise
direction. Figure 8-4(b) should help to clarify this notation.
We are now in a position to derive the Green-Gauss theorem. Let us write the
vector q as the product of a scalar 13 and another vector p, or
q = I3p
Substituting this expression for q in Eq. (8-32) yields
IvV'(l3p) dV = !,l3p·n dS
(8-351
(8-361

THE GREEN-GAUSS THEOREM
387
The following identity [I] proves to be useful:
V'(13p) = 13V,p + V13'P
(8-31)
where V13 denotes the gradient of the scalar 13. In cartesian coordinates, V13 is given
in three dimensions by
and in two dimensions by
V13 = a13 i + a13 j + a13 k
ax
ay
az
(8-388)
(8-38b)
'"'A
_ a13. + a13.
vI-'
- -I
-J
ax
ay
Note that the gradient of a scalar is a vector. Returning to Eq. (8-36) and using
Eq. (8-37), we may write the following:
for the three-dimensional case and
L13V·p dA = !c13P'n dC - LV13'P dA
(8-39)
(8-40)
for the two-dimensional case. Since Px is independent of Py and Pz' and vice versa,
it follows that
(8-418)
(8-41b)
and
(8-41c)
In the two-dimensional case, Px is independent of Py' and vice versa; so Eq. (8-40)
implies
(8-428)
(8-42b)
and
1
13 ~ dA = r13pyny dC -1 a13 Py dA
A
ay
Jc
A ay
In the above, dV is generally taken to be dx dy dz and dA to be dx dy; p., Py'
and pz are the x, y, and z components of P; and nx, ny, and nz are the direction
cosines of the outward normal unit vector with respect to the coordinate axes. Figure

388
STEADY-STATE THERMAL AND FLUID FLOW ANALYSIS
8-5 shows that nx is the cosine of the angle 0:1 between the vector n (the outward
normal unit vector) and the x axis. Similarly, ny is the cosine of the angle <X2'
Hence, nx and ny are the respective direction cosines.
Equations (8-42) and (8-4l) are the two- and three-dimensional forms of the
Green-Gauss theorem. Specific examples that illustrate the use of Eqs. (8-41) and
(8-42) are not given here because several applications are forthcoming in the re-
mainder of this chapter.
8-5
SIMPLE TWO-DIMENSIONAL HEAT CONDUCTION
Consider a long bar of uniform cross section as shown in Fig. 8-6(a). It is assumed
that each cross section through the bar is no different from any other both geo-
metrically and thermally. Note that only imposed heat fluxes and prescribed tem-
peratures are allowed. Perfect insulation is a special case of zero heat flux. Let us
allow for a heat source or internal energy generation Q per unit volume and unit
time that is at most a function of x and y only. This three-dimensional body may
therefore be analyzed as though it were two-dimensional. The governing equation
for the steady-state temperature T for a typical cross section far from the ends is
given by
T
a(aT)
a( aT)
-
k-
+ -
k-
+ Q = 0
ax
ax
ay
ay
n
(8-43)
Bounding
path C
Figure 8-5
Two-dimensional region illustrating the unit normal n (perpendicular to the
boundary C) and the angles <X. and <X2' Note that cos <XI = n, and cos <X2 = n,.

SIMPLE TWO-DIMENSIONAL HEAT CONDUCTION
389
Boundary
heat flux -~,'"'-J
Prescribed
temperature
(a)
Prescribed
temperature
Boundary
insulation
Insulated
lateral
faces
(b)
Figure 8-6
Schematic of simple two-dimensional heat conduction problem: (a) infinitely
long body and (b) thin plate with insulated lateral faces.
Note that this same equation describes the plate of constant thickness shown in Fig.
8-6(b), providing the lateral faces of the plate are well-insulated.
In the next several sections, the heat flux in a direction normal to some surface,
usually the global boundary, will be needed. A heat flux is generally a vector and
represents the heat transfer rate per unit area. In isotropic materials, the heat flux
is always normal to isothermal surfaces. A surface is isothermal if the temperature
is constant on that surface. In any event, the net heat flux through a surface from
conduction must be taken in the direction normal to the surface. Clearly, no con-
tribution can be made by the tangential heat flux (if any exists). Let us denote the
net (normal) heat flux vector as qn' the magnitude of which is simply qn. In terms
of the outward normal unit vector n, q, may be written
18-44)

390
STEADY-STATE THERMAL AND FLUID FLOW ANALYSIS
In terms of the heat fluxes in the global coordinate directions, this same net (normal)
heat flux from conduction may be written
(8-45)
where qx and qv are the heat fluxes in the x and y directions. This is illustrated in
Fig. 8-7. Invoking Fourier's law of heat conduction for heterogeneous (but isotropic)
materials, we have
aT
qx = -k ax
and
aT
q
= -k-
Y
ay
(8-46)
(8-47)
(8-48)
It should be recalled from elementary heat transfer that the minus signs are included
so that a positive heat flux vector always points in the direction of decreasing
temperature. From Eqs. (8-44) to (8-46), we conclude that
sr
et .
qn =
- k axi -
k ayJ
If the dot product of both sides of this last result is taken with the vector n, we get
st
st
q
= -k-n
- k-n
n
ax
x
ayY
where n, = I-n and ny = j-n are the cosines of the angles formed by the x and y
axes with the vector n; that is, nx and ny are the direction cosines. Equation (8-48)
is very important. It will be used frequently in what follows and may be extended
by inspection to the three-dimensional case. It is emphasized that qn represents the
net (normal) heat flux from conduction leaving a surface.
In the next section some of the concepts of variational calculus introduced in
Chapter 4 are extended to two dimensions. In Sec. 8-6, these concepts are applied
to Eq. (8-43) in order to derive the expressions for the finite element characteristics.
Figure 8-7
Boundary of two-dimensional region showing net (normal) heat flux qn and
the components in the x and y directions.

VARIATIONAL FORMULATIONS IN TWO DIMENSIONS
391
This is followed by the derivation of these expressions with the Galerkin method
in Sec. 8-7. The latter will be seen to be much simpler and applicable to a wider
variety of problems. Therefore, after Sec. 8-6, the Galerkin method will be used
throughout the remainder of the book.
8-6
VARIATIONAL FORMULATIONS IN TWO DIMENSIONS
Recall from Chapter 4 that if the governing differential equation contains second-
order derivatives, the functional contains only first-order derivatives. For Eq.
(8-43) it seems reasonable to assume a functional F of the form
F = F(x,y,T,Tx,Tv)
where the subscripts on T indicate derivatives, i.e.,
(8-49)
aT
T=-
x
ax
and
aT
T=-
Y
ay
(8-50)
The integral to be extremized is then given by
/ = LF(x,y,T,TnTv) dx dy
(8-51)
(S-52)
Using a procedure that is completely analogous to that used in Sec. 4-5, let us
derive the corresponding Euler-Lagrange equation. It should further be recalled that
the Euler-Lagrange equation is really the governing differential equation for the
problem.
The Euler-Lagrange Equation: Geometric and Natural Boundary
Conditions
We proceed by taking the first variation of Eq. (8-51) and setting it to zero, or
'6/ = '6 ff(X,y,T,TxTv) dx dy = 0
From one of the commutative properties, we have
'6LF dx dy = L'6F dx dy
and by an extension of Eq. (4-37), we write
aF
aF
aF
'6F = -'6T + -'6T + -'6T
er
er,
.r
sr,
Y
Another of the cummutative properties allows us to write
aF '6T = aF '6 (aT) = aF .i ('6D
aTx
.r
aTx
ax
aT. ax
(8·53)
(8-54)
(8-55a)

392
STEADY-STATE THERMAL AND FLUID FLOW ANALYSIS
and, similarly
of 'OT
= of ~ ('OT)
oTy
y
aTy oy
Therefore, Eq. (8-52) becomes
f[
oF
aF 0
of 0
]
'01 =
-
'OT + -
-
('OT) + -
- ('On
dx dy = 0
A
oT
aTx ox
oTy ay
(8-55b)
(8-56)
Normally, we would use integration by parts at this point. However, since the
problem is two-dimensional, we use the Green-Gauss theorem instead. For example,
let us examine the second term which is in effect an integral of the form
f
al3 dA
Pxox
where Px is analogous to of/oTx and 13 to 'OT. From Eq. (8-42a), it follows that
f of 0
i of
f 0 (OF)
-
- ('OT) dx dy =
-
n 'OT dC -
-
-
'OT dx dy
A oTx ox
c aTx
x
A ax aTx
(8-57)
In a similar fashion, the third term in Eq. (8-56) may be written as
f
aF 0
i of
f 0 (OF)
-
-
('OT) dx dy =
-
n . 'OT dC -
-
-
'OT dx dy
AoTy oy
c aTy
Y
Aay oTy
(8-58)
Therefore. Eq. (8-56) becomes
'Of = f [OF - ~ (OF) - ~ (OF)] 'OT dx dy
A er
ax et,
oy et;
i [oF
OF]
+
-Tn, + -n"
'OT dC = 0
c a x
aT" '
(8-59)
(8-60)
a (OF)
- ay oT
y
= 0
Continuing further with the analogies from Chapter 4, we conclude that the Euler-
Lagrange equation is given by
of
0 (OF)
st
ox sr,
and the natural boundary condition by
(8-61)
aF
of
-n + -no = 0
oTx
X
oT"
y
This last result will be shown to be related to the condition of a zero temperature
gradient; hence no conduction on that part of the boundary can occur (i.e., it is
perfectly insulated), Also, the second integral in Eq. (8-59) is zero on those portions

VARIATIONAL FORMULATIONS IN TWO DIMENSIONS
393
of the global boundary where the temperature is prescribed because if T is prescribed,
we have 'OT = O. This last condition is the so-called geometric boundarycondition.
Example 8-10
For the problem described by the governing equation given by Eq. (8-43):
(a) Determine the functional F if the method illustrated in Example 4-3 is used.
(b) Determine the variational principle if the method illustrated in Example 44 is
used, and if an imposed heat flux qsb is assumed to act on the boundary.
Solution
(a) We first write Eq. (8-43) in a form where a one-to-one correspondence of terms
can be made more readily with the Euler-Lagrange equation, or
Q _ ~ ( _ kaT) _ ~ ( _ kaT)
= 0
/8-62)
ax
ax
ay
ay
from which it is concluded that
/8-63a)
/8-63b)
aT
-k- =
-r kl',
ax
aF = Q
aT
aF
aT
-k- = -kTy
ay
aF
er,
If Eqs. (8-63) are integrated, we get
F = QT + f(Tx,Ty )
F =
- 1/2kT; + g(T,Ty )
/8-63c)
/8-64a)
/8-64b)
and
F =
- V2kT; + h(T,Tx)
where f, g, and h must be such that F itself is given by
F = QT - 1/2kT; -
V2kT;
/8-64c)
/8·65a)
or
/8·65b)
F = QT - V2k(~:r - V2k(~~r
Actually a constant may be added to the expression for the functional F. However,
since it would have no effect whatsoever on the extremization process to be illus-
trated below, it is not included in Eqs. (8-65).
(b) From Example 4-4, we begin by writing
'OJ =1[Q + ~ (k aT) + ~ (k aT) ] 'OT dx dy = 0
/8-66)
A
ax
ax
ayay

394
STEADY-STATE THERMAL AND FLUID FLOW ANALYSIS
The two terms containing second derivatives may be rewritten with the help of the
Green-Gauss theorem [see Eqs. (8-42)] if we note that
13 = &T
= kaT
Py
ay
(8-67)
For example,
f a( aT)
i et
f a
er
- k- &T dx dy =
k-n f &T dC -
-(&T)k- dx dy
AaX
ax
cax·
AaX
ax
and
.i(&T)
ax
and
sr a
st (aT)
(aT) 2
k- -(&T) = k-& -
= Y2k& -
ax ax
ax
ax
ax
A similar result is obtained for the other term. The final result is given by
&I = L[Q &T - 1/2k&G:r - 1/2k&(~~r] dx dy
+ {(k aTn, + kaTn,) &T dC = 0
Jc
ax
ay .
This implies that I itself is given by
I = L[QT -
l12kG:r
Y2k(~~r] dx dy - !cql1T dC
(8-68)
(8-69)
(8-70)
(8-71)
(8-72)
Integrations around the boundary C are always performed in a counterclockwise
direction as shown in Figure 8-8. If we assume that an imposed heat flux qsB acts
on the boundary (transferring energy toward the two-dimensional region) as shown
in Fig. 8-9. then an energy balance at this point on the boundary gives
I = L[QT - Y2k(~:r - Y2kG~r] dx dy + !cq,BT dC
(8-73)
This result is used as a starting point in the next section in the finite element
formulation to the problem.
•
Example 8-11
Using the funct!onal from Example 8-10, determine the so-called natural boundary
condition for the problem described by the governing equation given by Eq.
(8-43).

Two-dimensional
region
y
~x
VARIATIONAL FORMULATIONS IN TWO DIMENSIONS
395
Direction of
integration
around the
boundary
Figure 8-8
The boundary integrals for a two-dimensional region are evaluated by inte-
grating in a counterclockwise direction as shown.
Solution
With the help of Eq. (8-65a), the natural boundary condition expressed in Eq.
(8-61) becomes
aT
aT
-k-n
- k-n
= 0
(8-74)
ax
x
ay
Y
From Eq. (8-48) it is concluded that the part of the boundary C over which Eq.
(8-74) holds is insulated. The net heat flux qn from conduction is zero in this
case.
•
From Examples 8-10 and 8-1l and Eqs. (8-73) and (8-74) it is concluded that
the variational principle corresponding to Eq. (8-43) is given by
I = L[QT - V2kG:f- V2k(~~f] dx dy
(8-75)
Figure 8-9
Two-dimensional region showing the heat fluxes from conduction and that
which is imposed on a typical part of the global boundary.

396
STEADY-STATE THERMAL AND FLUID FLOW ANALYSIS
providing the boundary conditions are either natural or geometric on various parts
of the global boundary.
The Finite Element Formulation
The functional 1 given by Eq. (8-73) holds over the entire area A. It is convenient
to perform the integrations on an element basis by noting that
M
1= 2:1'
e=1
(8-76)
where M elements are assumed. Instead of extremizing the original integral 1, we
take the derivative of I' with respect to the nodal unknowns in the vector a'. Recall
that the parameter function for the temperature T may be written in terms of the
.nodal temperatures by writing
T = Na"
(8-77)
where N is the shape function matrix. For the three-node triangular element, for
example, N is given by
N = [N j
Nj
Nd
(8-78)
where the shape functions themselves are given by Eqs. (6-21). In this case, a"
contains the three nodal temperatures or
(8-79)
Taking the derivative of I' with respect to a' and remembering that Eq. (4-119)
must be used, we have
dI'
da' f [
aNT aN
aNT aN
]
QNT - k- -a' -
k -
-a'
dx dy
A'
ax
ax
ay
ay
+ i q
NT de = 0
(8-80)
Ct'
s8
This last result may be written in the standard form
K'a' = r-
by defining
K' =
K~x + K§y
and
where in turn
(8-81)
(8-82)
(8-83)

THE GALERKIN METHOD IN TWO DIMENSIONS
397
and
Co =
f
aNT aN dx d
-k-
y
A' ax
ax
i
aNT aN
-k-dxdy
A' ay
ay
LWQdxdy
(8-84a)
(8-84b)
(8-85a)
(8-85b)
In Sec. 8-8, several of these integrals are evaluated for the triangular element.
8-7
THE GALERKIN METHOD IN TWO DIMENSIONS
In direct contrast to the previous section, the Galerkin weighted-residual method
is applied to Eq. (8-43) in a very straightforward manner. We begin the formulation
on an element basis from the outset by forming the integral of the weighted residual
and setting that result to zero where the weighting functions are the shape functions,
or
{ W [~ (k aT) + ~ (k aT) + Q] dx dy = 0
JA'
ax
ax
ay
ay
Applying the Green-Gauss theorem to the first two terms by noting
(8-86)
we get
aT
Px = k ax
aT
Py = k-
ay
i
st
f aW et
i
st
NTk-nx dC -
-k- dx dy +
NTk-n, dC
C'
ax
A' ax
ax
C'
ay-
-
{ aW kaT dx dy + { WQ dx dy = 0
JA' ay
ay
JA'
Combining the two boundary integrals into one integral and using Eq. (8-48) gives
i
aNT aT
LaNT aT
i
i
-k- dx dy +
-k- dx dy =
WQ dx dy -
Wq dC
A' ax
ax
A' ay
ay
A'
C'
n
If a heat flux qsB is assumed to be imposed as shown in Fig. 8-9, we have
(8-87)
from an energy balance at the point of application. Furthermore, using T = Na"
(and noting that a' is independent of x and y) gives

398
STEADY-STATE THERMAL AND FLUID FLOW ANALYSIS
K'a' = fe
where
and
where in tum
(8-88)
(8-89)
(8-90)
(8-84a)
(8-84b)
(8-85a)
(8-85b)
These expressions are identical to those derived via the variational approach. Ob-
viously, the Galerkin method requires significantly fewer steps. Several of these
integrals are evaluated in the next section for the triangular element for which the
shape function matrix N is given by
N = [N;
Nj
Nkl
where the shape functions themselves are given by Eqs. (6-21). The vector of nodal
unknowns a' is comprised of the three nodal temperatures in this case.
Since the Galerkin method is simple, the variational approach is abandoned in
the remaining part of the chapter (and the book). The Galerkin method will be used
exclusively from now on.
8-8
GENERAL TWO·DIMENSIONAL HEAT CONDUCTION
Inthis section the simple heat conduction problem defined in Sec. 8-5 is generalized
as shown in Fig. 8-10. Note that the two-dimensional region is shown as a relatively
thin plate of variable thickness. As in the simple model, a volumetric heat source
is also to be included. Both lateral and boundary heat transfer effects are to be
modeled including convection, simple radiation, and imposed heat fluxes. Simple
radiation is defined to be radiation to or from a large enclosure. The imposed heat
fluxes may act at a distance such as the sun and, therefore, may be present in
addition to convection and radiation. Prescribed temperatures on the global boundary
are also allowed.
The intent in this section is to derive the expressions for the element charac-
teristics in general, i.e., without regard to the type of element. As mentioned in

GENERAL TWO-DIMENSIONAL HEAT CONDUCfION
399
Boundary
heat flux
Boundary
insulation
Boundary
radiation
Prescribed
temperature
Boundary
heat flux
(may act at a
distance)
Lateral
radiation
Lateral
_
heat flux
(may act at a
distancel
Lateral
convection
(8·91)
Figure 8·10
Schematic of general two-dimensional heat conduction problem.
Sec. 8-7, the Galerkin method will be used. Then several of these expressions will
be evaluated by way of examples for the three-node triangular element. However,
before these expressions can be derived, the governing equation that describes this
general problem is needed.
The Governing Equation
The governing differential equation for the temperature T is derived quite easily if
an energy balance is done on an elemental volume t dx dy, where t is the thickness
of the plate. It can be shown that the governing equation is given by
~ (kt aT) + ~ (kt aT) - h(T - Ta ) - Ecy(T4
- T:) + a, + Qt = 0
ax
ax
ay
ay
where k is the thermal conductivity, h is the sum of the convective heat transfer
coefficients on the two lateral faces, E is the sum of the two surface emissivities
on the two lateral faces, qs is the sum of the heat fluxes imposed on the two lateral
faces, Q is the heat generation per unit time and volume, Ta is the ambient tem-
perature of the fluid in contact with the lateral faces, T, is the temperature of the
enclosure receiving the radiation from the lateral surfaces, and
CY is the Stefan-
Boltzmann constant (given in Sec. 8-3). Note that qs is positive if it is directed as
shown in Fig. 8-10.
As mentioned earlier, boundary convection, radiation, and heat fluxes are to
be included also. These boundary conditions are considered in the next section
where we derive the element characteristics. The reason for this is that it is far
easier to apply these conditions on an element basis. Prescribed temperatures will
also be handled quite routinely after the assemblage step.

400
STEADY·STATE THERMAL AND FLUID FLOW ANALYSIS
It should be noted that if a particular heat transfer effect is negligible or not
present. the corresponding term in Eq. (8-91) is simply omitted. For example, let
us say that in a given problem we have negligible lateral radiation and no imposed
lateral heat flux. In this case, we may taken E and qs both to be zero in a general
computer program. It will be seen in the next section that this will eliminate the
corresponding contributions to the element stiffness matrices and/or nodal force
vectors.
The FEM Formulation
The expressions for the finite element characteristics may be derived without actually
specifying the type of element at this point. However, later in this section the
emphasis will be on the three-node triangular element from Sec. 6-4. Recall that
in this case the shape function matrix N is given by
N = [N;
Nj
Nd
18-92)
where the shape functions themselves are given by Eqs. (6-21). A typical element
e has nodes i, j, and k, specified in a counterclockwise order with temperatures T;,
Tj , and Tk• On an element basis, the Galerkin method requires
1NT[i (kt aT) +i (kt aT) -
h(T -
Ta )
At
ax
ax
ay
ay
-
m(T4
-
T:) + a, + Qt] dx dy = 0
18-93)
It is emphasized that this integral applies to a typical element e and the integrations
are to be performed over the area Ae of the element. Note that each term in Eq.
(8-93) has units of energy per unit time. If the Green-Gauss theorem is applied to
the two terms containing second-order derivatives, we get
i
st
1aNT
er
NTkt-n dC -
-kt- dx dy
C'
ax
x
A' ax
ax
i
st
1aNT st
+
Wkt-n dC -
-kt- dx dy
c'
ay
Y
A' ay
ay
-1WhT dx dy +1wn, dx dy
At
At
+1NTqs dx dy +1WQt dx dy = 0
At'
At'
18-94)
However, the two integrals around the element boundary may be combined with
the help of Eq. (8-48) to give
r W(k aTn. + k aTnv) t dC =
( NT( -qn)t dC
18.95)
Jc'
ax
ay .
Jc'

GENERAL TWO-DIMENSIONAL HEAT CONDUCTION
401
where qn represents the heat flux from conduction in the direction of the outward
normal to the boundary as shown in Fig. 8-7.
At this point it is convenient to consider the nongeometric boundary conditions
(i.e., all except the prescribed temperatures). As mentioned earlier, convection,
radiation, and imposed heat fluxes are to be included. Perfect insulation is a special
case of zero heat flux. Let us perform an energy balance (on an area basis) on the
global boundary shown in Fig. 8-11 such that we may write
18-96)
where qcvB, qrB, and qsB represent the convective, radiation, and imposed heat
fluxes. Using this result to eliminate qn in Eq. (8-95) gives
{ W( -qn)t dC =
( W(qsB -
qcvB -
qrB)t dC
18-97)
lee
Jee
But from Newton's law of cooling, we have
q"vB = hB(T -
TaB)
and by application of the Stefan-Boltzmann law, we have
qrB =
EBCT(T4 -
T:n)
18-98)
18-99)
where hB is the convective heat transfer coefficient on the element boundary, EB is
the surface emissivity of the boundary, TaB is the ambient fluid temperature, and
TrB is the temperature of the enclosure receiving the radiation from the boundary.
Strictly speaking, the T in Eqs. (8-98) and (8-99) should be the temperature at the
element boundary, but the shape function matrix in Eq. (8-95) will automatically
take care of this as shown later.
With the help of Eqs. (8-98) and (8-99), we may write Eq. (8-97) as
{ W( - qn)t dC =
{ W qsBt dC -
{ WhBtT dC
Jel'
lee
Jet
Global
boundary
Figure 8-11
Typical part of the global boundary in the two-dimensional heat conduction
problem showing the heat fluxes considered in the finite element formulation.

402
STEADY-STATE THERMAL AND FLUID FLOW ANALYSIS
Recalling that
T = Nae
(8·100)
(8·101)
where N is the shape function matrix and ae is the vector of the nodal temperatures
for element e. As in Sec. 8-3. it is convenient to write t- as follows:
r
= T3T = (Nae)3Nae
It follows that Eq. (8-94) may be written as
Keae = fe
where
and
fe = f{v + f: + f; + fo+ f{vB + f:B + f;B
The element stiffness matrices are in tum given by
1
aNT
aN
K~ =
-kt- dx dy
A' ax
ax
1
aNT
aN
Ke =
-kt- dx dy
YY
A' ay
ay
Ke
= r NThN dx dy
CV
JAt'
K~ = r NTw(Nae)3N dx dy
JA-
K;vB = r NThBtN dC
Jee
K~B = r NTEB<J"t(Nae)3N dC
Jee
and the element nodal force vectors by
t: = r NThTa dx dy
JA-
t: = r NTE<J"T: dx dy
JA-
f e = r NTq dx dy
q
JAt.
s
(8·102)
(8·103)
(8-104)
(8·105)
(8·1068)
(8·106b)
(8·106c)
(8·106d)
(8·106e)
(8·106f)
(8·1018)
(8-101b)
(8·101c)

GENERAL TWO-DIMENSIONAL HEAT CONDUCTION
403
fe
LNTQt dx dy
18-107d)
Q
ffvB 1NThBtTaB dC
18-107e)
C'
f:B 1NTEBmT~ dC
18-107fl
c-
f;B = 1NTqsBt dC
18-107g)
c-
For the three-node triangular element, the stiffness matrices and nodal force
vectors are each of sizes 3 x 3 and 3 x I, respectively. It can be seen almost by
inspection that each of these stiffness matrices is symmetric. Note the use of the
subscript B on those terms that arise from the boundary conditions. In these cases,
the integrations are to be performed around the boundaries of each element. How-
ever, if all legs of the element are internal (i.e., within the body) and not on the
global boundary, the corresponding stiffness matrices (i.e., K~vB and K:B) and the
nodal force vectors (i.e., ffvB' f:B, and f;B) are simply taken to be null matrices
and vectors, respectively. This is illustrated in Example 8-17.
Example 8-12
Evaluate the stiffness matrix from conduction in the x direction by using the three-
node triangular element from Sec. 6-4.
Solution
Recall that the shape function matrix is given by Eq. (8-92) for the triangular
element. From the definition of K~x given by Eq. (8-106a) we see that the first
derivatives of the shape functions are needed with respect to x. From Eqs. (6-21),
we note that
aNi
ax
Therefore, we may evaluate
K~< as follows:
K~x = L[:~~] kt[m21
m22
m23] dx dy
m23
m21 m22
m~2
m23 m22
18-108)
The mij's and area A are a function only of the nodal coordinates and may be
computed with the help of Eqs. (6-21). In Eq. (8-108), the integrations were
performed by treating k and t as constants. If these parameters are not constant,
the above expression still holds, but k and t then represent the values at the element

404
STEADY-STATE THERMAL AND FLUID FLOW ANALYSIS
centroid. The accuracy of this approximation improves as the number of elements
used in the discretization is increased.
•
The reader may show in a completely analogous manner that the stiffness
matrix from conduction in the y direction is given by
K~y = ktA [m:~31
m~h32
:~:~~~]
(8-109)
m33m31
m33m32
m33
for the triangular element.
Note that both
K~ and
K~y are symmetric as
expected.
Example 8-13
Evaluate the element stiffness matrix from lateral convection for the three-node
triangular element.
Solution
From the definition of K~v given by Eq. (8-106c), we see that the integrand contains
the shape functions directly (not the derivatives). Therefore, it is more convenient
to replace each shape function Nf3 with its corresponding area coordinate Lf3 from
Eq. (6-25). The integrals may then be evaluated with the help of the special inte-
gration formula given by Eq. (6-49). From Eqs. (8-106c) and (6-25), we have
K'
= I [ii][L L Lk]h dx dy = I [LLL L{/
~I~:]h dx dy
cv
At)
,
'j
At'
J
I
J
'J
t.,
LkL; LkLj
u
Using Eq. (8-49), we may evaluate a typical integral as follows:
I h[2 dx dy = hI [2 dx dy
At'
I
At
I
= h
2!O!O!
2A
Y6hA
(2 + 0 + 0 + 2)!
Another integral is evaluated as
I hLL dx dy = hI LiL dx dy
At
I
J
At
J
I !I!O!
2A
=h------
(I + I + 0 + 2)!
and so forth. Clearly K~v must be given by
K'
= hA [~
;
2~]
cv
12
I
I
(8·110)

GENERAL TWO-DIMENSIONAL HEAT CONDUCfION
405
Recall that h is the sum of the two convective heat transfer coefficients on the two
lateral faces of the plate. Moreover, if h varies with x and y, the value of h at the
centroid of element should be used in Eq. (8-110).
•
Example 8-14
Try to evaluate the element stiffness matrix as a result of radiation from the lateral
faces. Use the three-node triangular element.
Solution
Inspection of the expression for Ki given in Eq. (8-106d) reveals that (Na") is
needed. Using area coordinates for the shape functions and noting that
we have
(Na e)3 = (L;T; + LjTj + LkTk )3
Since this is a scalar, we may write
K; ~ L'0[t}L,
LJ L,I(L,T, + LJTJ + L,T,~ dx dy
(8-111)
(8-112)
The indicated multiplications could be carried out and Eq. (6-49) used to integrate
the various terms. However, this approach is not very practical, and a numerical
integration should be performed. Such integration methods are covered in detail in
Chapter 9. The unknown temperatures appear in this matrix and the resulting
problem is nonlinear. The direct iteration method from Sec. 8-2 may be used in
this case.
•
Examples 8-12 to 8-14 have illustrated how the integrals are evaluated over
the area of the element (i.e., over N). In the expressions for K:vB and K:B, we
note that the integrations are to be performed around the element boundaries (in a
counterclockwise direction). However, there is no convection or radiation (assuming
an opaque body) between two internal and adjacent elements. Therefore, these two
matrices need to be evaluated only for those elements with at least one leg on the
global boundary B as shown in Fig. 8-12 for the triangular element. Note that leg
ij happens to be on the global boundary. The next example illustrates how the
corresponding stiffness matrix from convection is evaluated in this case.
Example 8-15
Evaluate K~vBfor the element shown in Fig. 8-12 with leg ij on the global boundary.

406
STEADY-STATE THERMAL AND FLUID FLOW ANALYSIS
Solution
From Eq. (8-106e), we note that the shape functions themselves are needed in the
integrand. This generally means that area coordinates should be used to facilitate
the evaluation of the integral in this two-dimensional application. Therefore, Eq.
(8-106e) becomes
But on leg ij, we have L, = 0 and de = dl , or
K~vB = rhBt [L~L
L;Jj
~O] dl
JI'1
0
0
Note that the integration is to be performed only on leg ij, the length of which is
denoted as lij. The area coordinates have in effect degenerated to length coordinates.
Equation (6-48) may now be used to perform the integrations. For example,
i
2
2!0!
2hBtlij
hBtL dl = hBt
l. =
1'1
I
(2 + 0 + I)! IJ
6
and
for leg ij on the
global boundary
i
I !I !
= hBtlij
.hBtLLdl = hBt(1
l
1'1
I
J
+ I + I)! IJ
6
The complete result is given by
hBt/[2
Ke
=:.:.!!..:..:..!
I
evB
6
o
(8·1138)•
(8·113b)
for leg jk on the
global boundary
!]
o
2
I
The results from Example 8-15 can be generalized. If nodes j and k are on the
global boundary, we have
Ke
= hBtljk [~
evB
6
o
(8·113c)
whereas if nodes k and i are on the global boundary, we have
Ke
= hBtlki [~
~
0
2
1]
for leg ki on the
evB
6
I
0
global boundary
where ljkand lkidenote the lengths of legs jk and ki, respectively. Strictly speaking,
the thickness tin Eqs. (8-113) represents the average thickness of the element along
the leg in question.

18-114)
GENERAL TWO-DIMENSIONAL HEAT CONDUCfION
407
The reader should try to show that the stiffness matrix given by Eq. (8-1060
may be written as
K~, ~ L,,"{~}L' Lj
OJ(L,T, + L]T])' dl
for the element shown in Fig. 8-12. This integral may be evaluated with the help
of Eq. (6-48). It may also be evaluated numerically using one of the techniques
presented in Chapter 9.
Let us now tum to the nodal force vectors given by Eqs. (8-107). Note that
C:v, Ci, C:, and Co are to be evaluated by integrating over the element area Ae,
whereas C:vB, CiB' and C:Bare to be evaluated on the element boundaries. The former
are readily evaluated if area coordinates are used with the following results:
I' ~ hATf]
18-115)
cv
3
I
I; ~ ,"~lt]
18-116)
I; ~ qi[:]
18-117)
IQ~ Q:t[:]
18-118)
The result for Co in Eq. (8-118) deserves special attention. This nodal force
vector results from a volumetric heat source, generally considered to be distributed
Global
boundary
Figure 8-12
Typical element with at least one leg of the triangular element on the global
boundary.

408
STEADY-STATE THERMAL AND FLUID FLOW ANALYSIS
within the body. If Q is not uniform, then the value at the element centroid is to
be used in Eq. (8-118). Let us derive an expression for the nodal force vector if Q
happens to represent a point source at (xo,yo). With the help of the 8-function
defined by Eq. (4-85), we may represent the nodal force vector for the point source
as
fJ ~ L[~;]Q't &(x -
xo) 8(y -
Yo) dx dy
(8-119)
(8-120)
where Q' is the energy generation per unit time and per unit thickness. From the
definition of the 8 function, the above integral evaluates to zero everywhere within
the element except at (xo,Yo). Therefore, it follows that fois given by
[
N;(XO,YO)]
fo= Q't
N/xo,Yo)
Nk(xo,Yo)
If more than one point source is present in the element, additional nodal force
vectors similar to Eq. (8-120) would simply be included in the analysis.
From a practical point of view, it is best to situate a node at each point source.
Not only does this give more accurate results, but it also allows us to consider the
point sources after the assemblage is complete. For example, if a point source of
Q' is located at global node I, then Q't is simply added to the Ith position in the
assemblage nodal force vector. If the point source is within an element (not at a
node), we must use Eq. (8-120) at the element level. Section 8-14 discusses one
method of implementing Eq. (8-120) in a computer program.
Let us now tum to the nodal force vectors that are to be evaluated on the
element boundary. The results are
f:vB = h.t'i'~m
for leg ij on the
(8-121)
global boundary
f:B -r
for leg ij on the
(8-122)
global boundary
f;B = q~tl"m
for leg ij on the
(8-123)
global boundary
Similar expressions may be set up by inspection if leg jk or ki is on the global
boundary.
The assemblage of the element stiffness matrices and nodal force vectors is
routine (see Example 8-17). The prescribed temperature boundary conditions, if
any exist, are applied with either of the two methods illustrated in Sec. 3-2. It has
been noted that if radiation heat transfer is included, the problem becomes nonlinear.
The problem is nonlinear also if temperature-dependent properties are to be used.

GENERAL TWO-DIMENSIONAL HEAT CONDUCTION
409
In these cases, the direct iteration method from Sec. 8-2 may be used to solve the
system of equations for the nodal temperatures.
The Element Resultants
The heat fluxes qx and qy in the x and y directions, respectively, may be computed
for every element by applying Fourier's law of heat conduction and writing
and
and
st
aN
qx = -k- = -k-a'
ax
ax
et
aN
qy = -k- = -k-a'
ay
ay
If the triangular element is used, we get
qx =
- k(m21 T; + m22Tj + m23Tk)
(8·1248)
(8·124b)
(8·1258)
qy =
- k(m31 T, + m32Tj + m33Tk)
(8·125b)
where the m;/s are calculated by Eqs. (6-21) and T;, Tj, and Tk represent the nodal
temperatures. Recall that these temperatures are known from the solution of Ka = f.
Note that a bar C) is used on qx and qy to indicate that these are actually average
heat fluxes for the element. This is a consequence of the fact that the shape functions
are linear (and the derivatives are therefore constants). These average heat fluxes
are usually associated with the centroid of the element.
Example 8-16
Consider the element shown in Fig. 8-13. Note that a point heat source with a
strength of 500 Btu/hr per inch of thickness is located at Xo =
I in. and Yo =
0.2 in. The nodal coordinates are shown in Fig. 8-13. The plate thickness is 0.5 in.
The element is defined as having nodes I, 3, and 4, in this order.
(2,0.9)0
0)~~
(0.0)
Qo(xo, Yo)
(2.0.1 )
Figure 8·13
Element in Example 8-16 with the nodal coordinates shown in inches and a
point heat source (denoted as x) at 0, 0.2).

410
STEADY-STATE THERMAL AND FLUID FLOW ANALYSIS
Solution
From Eq. (8-120) we see that the shape functions need to be evaluated at (xo,yo).
The shape functions for the triangular element are given by Eqs. (6-21). Each of
the m;/s needs to be computed with the help of Eq. (6-21) with the results sum-
marized as follows:
1.0
-0.50
O.
ml2 = O.
m22 = 0.5625
m32 = -1.25
ml3 = O.
m23 =
-0.0625
m33 = 1.25
In these computations the area A of the element was needed and was computed to
be 0.8 in.? from Eq. (6-2Ie). The shape functions may now be evaluated at the
location of the heat source as follows:
= 1.0 + (-0.50)(1.0) + (0.00)(0.2) = 0.5000
= 0.0 + (0.5625)( 1.0) + (- 1.25)(0.2) = 0.3125
= 0.0 + (- 0.0625)( 1.0) + (1.25)(0.2) = 0.1875
Note that the sum of the shape functions evaluated at (xo,yo) is unity. From Eq.
(8-120) we compute Co as follows:
[
0.5000]
[125]
Co = (500)(0.5)
0.3125
=
78
Btu/hr
0.1875
47
Note that nodes 1 and 3 are closer to the source than node 4 and, therefore, most
of the source is automatically allocated to nodes 1 and 3. It should also be noted
that the sum of the values allocated to each node is 250 Btu/hr, the total amount
available.
•
Example 8-17
The temperature distribution is needed in the device shown in Fig. 8-14(a). This
device is very long in the direction normal to the plane of the paper. The upper
and lower surfaces convect to fluids at 36 and 24°C, through convective heat transfer
coefficients of 500 and 1000 W/m2_oC, respectively. The outside boundary is held
at a fixed temperature of 35°C. The device is comprised of two materials that are
fused together at x = ± 3 ern. The materials are bronze and aluminum with thermal
conductivities of 52 and 186 W/m-oC, respectively. A volumetric heat source with
a strength of 5 W/cm3 is present in the bronze only. Determine the temperature

GENERAL TWO-DIMENSIONAL HEAT CONDUCTION
411
distribution within and the heat fluxes through the device. Neglect the effects of
thermal radiation.
Solution
Because of the symmetry about the centerline, only one-half of the region needs
to be modeled as shown in Fig. 8-l4(b). The boundarycondition on this line of
symmetry is equivalent to that of perfect insulation (i.e., the natural boundary
condition). A problem such as this one is usually analyzed with hundreds of ele-
ments. However, in order to show each step in the finite element solution process,
h B = 500 W/m2 .oc
TaB = 36°C
Aluminum
Bronze
Bronze
k = 52 W/m' "C
Aluminum
k= 186W/m'oC
Boundary
convection
a;
Boundary L,.
insulation
Prescribed
temperature
:&
(b]
Boundary
convection
0
y
CD
CD
0)
(cl
hB
= l000W/m2.oC
T. B = 24°C
(al
Figure 8-14
(a) Schematic of device in Example 8-17. (b) Region to be analyzed with
heat transfer mechanisms shown. (c) Discretization of the two-dimensional region.

-0.020]
-0.017
0.020
412
STEADY-STATE THERMAL AND FLUID FLOW ANALYSIS
let us use only four triangular elements as shown in Fig. 8-14(c). The nodal co-
ordinates are obtained from a scaled drawing of the cross section and are summarized
in Table 8-1 along with the element definitions. The bandwidth of the assemblage
stiffness matrix is minimized by numbering the nodes as shown. Note that two
material set flags are used, one for each material. The element stiffness matrices
and nodal force vectors are calculated as shown below. The assemblage stiffness
matrix and assemblage nodal force vector are also determined after each element
is processed.
Element 1
Element I is defined as having nodes I, 3, and 2 (in this order) and material set
I. The nodal coordinates are summarized in Table 8-1. Recall that the element
stiffness matrix for conduction in the x direction is given by Eq. (8-108). The area
of the element is computed from Eq. (6-2Ie) as follows:
A = V2det[~
~:
~:] = V2det[~
~::
I
X2
Y2
I
0.000
or
A = 0.00060 m2
The three mij's that are needed are computed from Eq. (6-2Id) as follows:
_
Yj
-
Yk
_
Y3
-
Y2
m21
-
2A
-
2A
Table 8-1
Node and Element Data for Example
8-17
Node number
x, em
y. em
I
0.0
-2.0
2
0.0
2.0
3
3.0
-1.7
4
3.0
1.7
5
5.0
-1.0
6
5.0
1.0
Element
Nodes
Material
number
j
k
set number
I
I
3
2
I
2
2
3
4
I
3
3
5
4
2
4
5
6
4
2

GENERAL TWO-DIMENSIONAL HEAT CONDUCTION
413
-0.017 -
0.020
2(0.00060)
-30.833 m- I
m
-
Yk -
Yi _
Y2 -
YI
22
-
2A
-
2A
0.020 - (-0.020)
2(0.00060)
33.333 m- I
= Yi - Yj =
YI -
Y3
2A
2A
= -0.020 - (-.017) = -2
00
-I
2(0.00060)
.5
m
The thermal conductivity k for the material comprising this element is 52 W/m-°C.
Therefore, for K~x we get
[
(- 30.833)'
(- 30.833)(33.333)
(- 30.833)( - 2.5(0)]
K\V = (52.)( 1.0)(0.0006)
(33.333)( - 30.833)
(33.333)'
(33.333)( - 2.5(0)
(- 2.5(0)( - 30.833)
(- 2.5(0)(33.333)
(-2.500)'
or
[
29.662
K~~) =
- 32.067
2.405
-32.067
34.667
-2.600
2.405]
-2.600 wrc:
0.195
Note that the thickness is taken to be 1 m since the body is very long in the direction
perpendicular to the two-dimensional region being analyzed. Any value for the
thickness t may be used as long as the same value is used in each element. Similarly,
in the Y direction we need
_
Xk
-
xi _
X2
-
X3
_ 0.0 -
0.030
m31
-
2A
-
2A
-
2(0.00060)
= -25.ooom- 1
Xi
-
Xk
XI
-
X2
0.0 - 0.0
m32 = ~ = 2A = 2(0.00060)
= O.
m
_
Xj
-
Xi
_
X3 -
XI
_
0.030 -
0.0
33
-
2A
-
2A
-
2(0.00060)
= 25.000 m- I
(- 25.0)(25.0)]
(0.0)(25.0)
(25.W
(- 25.0)(0.0)
(O·W
(25.0)(0.0)
The element stiffness matrix for conduction in the Y direction is calculated from
Eq. (8-109) as follows:
[
(-25.W
K~,~.l = (52.)( 1.0)(0.0006)
(0.0)( - 25.0)
(25.0)( -25.0)

414
STEADY-STATE THERMAL AND FLUID FLOW ANALYSIS
or
[
19.500
K\Y =
0.000
- 19.500
0.000
0.000
0.000
-19.500]
0.000
W;OC
19.500
Leg ij or 1-3 is on the global boundary and undergoes convection to a fluid at
a temperature TaB of 24°C. The convective heat transfer coefficient he is 1000
W/m2-"C, From Eq. (8-113a), we see that we also need the length of leg 1-3. This
length is easily computed from
lij = V(xj - xY + (Yj - yY = V(X3 -
XI)2 + (Y3 -
YIf
= Y(O.030 -
0.0)2 + [-0.017 - (-0.020W
or
Ii) = 0.03015 m
The element stiffness matrix from convection from leg ij is calculated as follows:
K
( I)
_
(1000.)(1.0)(0.03015) [2
I
0]
("B-
120
6
0
0
0
or
[
10.050
K~~k =
5.025
0.000
5.025
10.050
0.000
0.000]
0.000
W;OC
0.000
There are no other contributions to the element stiffness matrix because the
boundary radiation is neglected and the lateral effects are zero (because a two-
dimensional slice out of a long body is being analyzed). Therefore, the composite
stiffness matrix for element I is given by Eq. (8-104) or, in this case, as
or
[
59.212
K(I) =
- 27.042
-17.095
-27.042
44.717
-2.600
- 17.095]
-2.600
19.695
The assemblage stiffness matrix after processing one element is given by
59.212
-17.095
-27.042
0.000
0.000
0.000
- 17.095
19.695
- 2.600
0.000
0.000
0.000
-27.042
- 2.600
44.717
0.000
0.000
0.000
Ka =
0.000
0.000
0.000
0.000
0.000
0.000
0.000
0.000
0.000
0.000
0.000
0.000
0.000
0.000
0.000
0.000
0.000
0.000

GENERAL TWO-DIMENSIONAL HEAT CONDUCTION
415
Recall that Ka is zeroed out before adding the results from the first element.
The element nodal force vectors are now calculated as follows. The volumetric
heat generation Q of 5 W/cm3 or 5 x 106 W/m3 is present in element I. From Eq.
(8-118) we get
(5 x 106)(1.0)(0.0006)[I]
[1000.]
fbi) =
I
=
1000.
W
3
I
1000.
Leg ij or 1-3 undergoes convection and the corresponding nodal force vector is
given by Eq. (8-121) or
f
(l) =
.:....(1_00_0.:....)(:-1._0:....:.)(0_._03_0_15...:..)(.:-2---'-4)[1] = [3661.8]
cvB
I
3 1.8
W
2
°
0.0
All other contributions to the composite nodal force vector are zero, and from Eq.
(8-105) we have
or
[
1361.8]
f(l) =
1361.8
W
1000.0
The assemblage nodal force vector after processing one element is given by
Element 2
fa =
1361.8
1000.0
1361.8
0.0
0.0
0.0
W
Element 2 is defined as having nodes 2, 3, and 4 (in this order) and material set 1
with k = 52 W/m-oC and Q = 5 X 106W/m3• Moreover, leg ki or 4-2 is on the
global boundary and undergoes convection with hB = 500 W/m2-oC and TaB =
36°C. The results are summarized below.
A = hdol[:
Y,dol[:
0.000
0.030
0.030
0.020]
-0.017
= 0.00051 m2
0.017

416
STEADY·STATE THERMAL AND FLUID FLOW ANALYSIS
or
m21
=
- 33.333
m31
=
0.000
m22 =
-2.941
m32 =
- 29.412
m23 = 36.274
m33 = 29.412
[
29.467
2.600
- 32.067]
K~) =
2.600
0.229
- 2.829
- 32.067
- 2.829
34.896
[
0.000
0.000
0.000]
K};) =
0.000
22.941
-22.941
0.000
-22.941
22.941
lki = 0.0315 m
[
5.025
0.000
2.512]
K!~1 =
0.000
0.000
0.000
2.512
0.000
5.025
K(2) =
K~~) + KW +
K!~1
[
34.492
2.600
- 29.554]
=
2.600
23.171
-25.771
-29.554
-25.771
62.862
59.212
-17.095
-27.042
0.000
0.000
0.000
-17.095
54.187
0.000
-29.554
0.000
0.000
-27.042
0.000
67.887
-25.771
0.000
0.000
0.000
-29.554
-25.771
62.862
0.000
0.000
0.000
0.000
0.000
0.000
0.000
0.000
0.000
0.000
0.000
0.000
0.000
0.000
f?J) = [:~~:~]
850.0
fl~,1 = [27~:~]
271.3
(\2) = f?J) + fl,~1 = [1 ~;~:~]
1121.3
1361.8
2121.3
2211.8
fa =
1121.3
0.0
0.0

GENERAL TWO-DIMENSIONAL HEAT CONDUCfION
417
Element 3
Element 3 is defined as having nodes 3, 5, and 4 (in this order) and material set 2
with k = 186 W/m-oC and Q = O. Leg ij or 3-5 is on the global boundary and
undergoes convection with hB = 1000 W/m2_oC and TaB
= 24°C. The results are
summarized below.
A = 0.00034 m'
m21 =
-39.706
m22 = 50.000
m23 =
-
10.294
m3I =
-29.412
m32 =
0.000
m33 =
29.412
[
99.701
-125.550
25.849]
K~) =
- 125.550
158.100
- 32.550
25.849
-32.550
6.701
[
54.706
0.000
- 54.706]
K~) =
0.000
0.000
0.000
- 54.706
0.000
54.706
lij = 0.02119 m
[
7.063
3.532
0.000]
K~~1 =
3.532
7.063
0.000
0.000
0.000
0.000
59.212
-17.095
-27.042
0.000
0.000
0.000
K(3) =
K~) + KW + K~~1
[
161.471
-122.018
-28.857]
=
-122.018
165.163
- 32.550
- 28.857
- 32.550
61.407
-17.095
-27.042
0.000
0.000
54.187
0.000
- 29.554
0.000
0.000
229.358
-54.628
-122.018
- 29.554
- 54.628
124.270
- 32.550
0.000
-122.018
- 32.550
165.163
0.000
0.000
0.000
0.000
0.000
0.000
0.000
0.000
0.000
0.000

418
STEADY·STATE THERMAL AND FLUID FLOW ANALYSIS
Element 4
fa =
1361.8
2121.3
2466.1
1121.3
254.3
0.0
Element 4 is defined as having nodes 5, 6, and 4 (in this order) and material set 2
with k = 186 W/m-oC and Q = O. Leg jk or 6-4 is on the global boundary and
undergoes convection with hB = 500 W/m2_oC and TaB = 36°C. The results are
summarized below.
A = 0.00020 m2
m21
-
17.500
m22 = 67.500
m23 = - 50.000
m31
- 50.000
m32
= 50.000
m33 =
0.000
[
11.393
-43.943
32.550]
K~) =
-43.943
169.492
-125.550
32.550
-125.550
93.000
[
93~
-93.000
O~]
K(4) =
-93.000
93.000
0.000
yy
0.000
0.000
0.000
ilk = 0.02119 m
[
0.000
0.000
0.000]
K:~1 =
0.000
3.532
1.766
0.000
1.766
3.532
K(4) =
K~) +
K~~) +
K~~1
[
104.392
-136.942
32.550]
=
-136.942
266.024
-123.784
32.550
-123.784
96.532
59.212- 17.095 -27.042
0.000
0.000
0.000
-17.095
54.187
0.000 -29.554
0.000
0.000
-27.042
0.000
229.358 -54.628-122.018
0.000
0.000-29.554 -54.628
220.801
0.000-123.784
0.000
0.000-122.018
0.000
269.556-136.942
0.000
0.000
0.000-123.784-136.942
266.024

GENERAL TWO-DIMENSIONAL HEAT CONDUCTION
419
[
0.0]
~~1 =
190.7
190.7
[
0.0]
£<4) = t1i) +
~~~ =
190.7
190.7
1361.8
2121.3
2466.1
1312.0
254.3
190.7
Before applying the prescribed temperature boundary conditions on nodes 5 and 6,
we have Kaa = f", or
[
59.212
-17.095
-27.042
0.000
0.000
0.000
-17.095
54.187
0.000
-29.554
0.000
0.000
-27.042
0.000
229.358
-54.628
-122.018
0.000
0.000
0.000
- 29.554
0.000
- 54.628
-122.018
220.801
0.000
0.000
269.556
- 123.784
-136.942
[
~i~: :~]
2466.1
1312.0
254.3
190.7
0,000] [TI]
0.000
T,
0.000
T3
- 123.784
T_
-136.942
T5
266.024
T6
After imposing the two prescribed temperatures with Method 1 from Sec. 3-2, we
get
[
59,212
-17.095
-27.042
-17.095
54.187
0.000
- 27.042
0.000
229.358
0.000
-29.554
-54.628
0.000
0.000
0.000
0.000
0.000
0.000
0.000
- 29.554
- 54.628
220.801
0.000
0.000
~:: ~::J [f~]
= [mu]
0.000
0.000
T_
5644.5
1.000
0.000
T5
35.0
0.000
1.000
T6
35.0
The solution is given by
TI = 71.3°C
Tz = 88.8°C
T3 = 49.6°C
T4 = 49.7°C
Ts = 35.0°C
T6 = 35.0°C
The average heat fluxes through the elements may be computed from Eqs. (8-125).
For example, for element 1 we have
- 52. [( - 30.833)(71.3) + (33.333)(49.6) + (- 2.5(0)(88.8)]
39,900 W/m 2

420
STEADY-STATE THERMAL AND FLUID FLOW ANALYSIS
and
q}l)
- 52. [(- 25.000)(71.3) + (0.0)(49.6) + (25.000)(88.8)]
- 22,800 W/m 2
or
+3.99 W/cm 2
and
q}l) =
- 2.28 W/cm 2
The negative sign indicates that the heat is flowing in the negative y direction. Both
of these signs seem to be intuitively correct (why?). The results for the other three
elements are as follows:
13.6 W/cm 2
q?)
- 0.01 W/cm 2 q}3)
- 0.05 W/cm 2 q}4) = 0.0 W/cm 2
Recall that these average heat fluxes are generally taken to be the local values at
the respective element centroids. Because of the crude mesh used, these results are
very approximate.
•
2
q
..:.::...~l_)_+_q:..::~,-2)
qx =
One way to improve the results for the element resultants such as the heat
fluxes is to average the results of two adjacent triangular elements as shown in
Fig. 8-15. For example, if the results for elements I and 2 are averaged, we get
3.99 + 6.76
8
2
2
= 5.3
W/cm
and
-q( I) + -q(2)
y
y
2
(-2.28) + (-0.01)
2
-1.14 W/cm 2
Figure 8·15
The methodof quadrilateral averages. Notehoweach pair of trianglesforms
a quadrilateral. The element resultantsfor each pair of triangles are averagedand assigned
to the centroid of the quadrilateral. Although this is illustrated here in a heat transfer ap-
plication, the same technique is used in stress analysis.

AXISYMMETRIC HEAT CONDUCTION
421
whereas for elements 3 and 4, we get
13.6 + 13.7
2
and
13.65 W/cm2
qy =
-0.05 + 0.0 = -0.025 W/cm2
2
This method of combining the element resultants for two adjacent triangular elements
is known as the method of quadrilateral averages. Note that a quadrilateral is
formed by the two triangles. The combined element resultants from two triangles
that form a quadrilateral are then associated with the centroid of the resulting
quadrilateral as shown in Fig. 8-15.
8-9
AXISYMMETRIC HEAT CONDUCTION
Three-dimensional heat conduction may be modeled as a two-dimensional ideali-
zation ifaxisymmetry exists with respect to both the geometry and the thermal
loads imposed on the body. A body of revolution is obviously geometrically axi-
symmetric as shown in Fig. 8-16. Each thermal load must also be axisymmetric,
however, in order to take the temperature T as a function of only the radial coordinate
r and the axial coordinate z. When conditions such as these exist, the problem is
said to be one of axisymmetric heat conduction.
Prescribed
temperature
Boundary
convection
Figure 8-16
Schematic of axisymmetric heat conduction problem. Note that the body is
a body of revolution about the z axis, and the thermal loading is axisymmetric as well.

(8-126)
422
STEADY-STATE THERMAL AND FLUID FLOW ANALYSIS
Only the isotropic case is considered in the formal development; that is, the
thermal conductivity k may be a function of rand z (for a heterogeneous body)
and even the temperature T, but it may not be dependent on direction. Clearly,
axisymmetric heat transfer cannot occur in a fully anisotropic body. Only if the
body is stratified in such a way that the principal values of thermal conductivity
occur in the rand z directions (with thermal conductivities k; and kz' respectively)
can the problem be considered axisymmetric. The formulation to be presented could
easily be extended to include this special anisotropic case.
Three types of boundary conditions are considered: convection, imposed heat
fluxes, and prescribed temperatures. It should be apparent by now that convection
and imposed heat fluxes are inherently included in the FEM formulation. Prescribed
temperature boundary conditions, on the other hand, are handled in the usual manner
after the assemblage step. Thermal radiation from the surface of the axisymmetric
body is not included, but could easily be added by following the approach taken
in Sees. 8-3 and 8-8.
The Governing Equation
The governing equation for axisymmetric steady-state heat conduction in an iso-
tropic, heterogeneous body with a volumetric heat source is given by
1 a (aT)
a ( aT)
- -
rk -
+ -
k -
+ Q = 0
r ar
ar
az
az
where T is the temperature, k is the thermal conductivity, and Qis the heat generation
per unit time and per unit volume. The global coordinates are denoted as rand z
in the radial and axial directions, respectively. Note that Eq. (8-126) is actually the
heat conduction equation in cylindrical coordinates with the term representing the
circumferential conduction set to zero.
The mathematical statements of the boundary conditions for convection and
imposed heat fluxes are more conveniently given later during the FEM formulation.
The Finite Element Formulation
It is not really necessary at this point to choose the particular type of axisymmetric
element to be used in the discretization. However, after the general expressions for
the element characteristics have been derived, the emphasis will be on the triangular
donut-shaped element. This element and the rectangular donut-shaped element are
shown in Fig. 8-17 for a typical axisymmetric body. Additional axisymmetric ele-
ments are presented in Chapter 9.
The Galerkin method will be used on an element basis to derive the expressions
for the element characteristics. We begin by forming the volume integral of the
product of the residual and transpose of the shape function matrix N and setting
the result to zero, or

AXISYMMETRIC HEAT CONDUCTION
423
(3)
(b)
Figure 8·17
Typical axisymmetric elements: (a) the triangular donut-shaped element and
(b) the rectangular donut-shaped element.
{ NT [! i (kr aT) + i (k aT) + Q] dV = 0
Jv'
r ar
ar
az
az
(8-127)
where it is appropriate to take
dV = 2nr dr dz
(8-128)
(8-129)
2TI {
NTi (k aT) r dr dz
JA'
az
az
+ Zrr {
NTQr dr dz = 0
JA'
for the elemental volume dV. It is emphasized that the expression in the brackets
in Eq. (8-127) is the residual that results when the approximation for the temperature
T on an element basis (i.e., T = Na") is substituted into Eq. (8-126). Note that
each term in Eq. (8-127) has dimensions of energy per unit time. If Eqs. (8-127)
and (8-128) are combined and if the result is split into three separate integrals, we
get
2'IT {
NTi (kr aT) dr dz +
JA'
ar
ar
The 2n may be cancelled from each term, but we will continue to carry it. Note
that the. integration limit has been changed from ve to A". Recall from Sec. 6-6
that we will, in effect, be analyzing the half-plane as shown in Fig. 6-17 for a
typical axisymmetric body. For all practical purposes, the problem has been made
two-dimensional with the thickness t (in the two-dimensional problem) being re-
placed by 2nr! However, let us explicitly show how the expressions for the element

424
STEADY·STATE THERMAL AND FLUID FLOW ANALYSIS
characteristics can be derived when the integrands are functions of one or more of
the global coordinates. Because r is independent of z, we should note that
!!- (k aT) r = !!- (kr aT)
(8.130)
az
az
az
az
Furthermore, if we apply the Green-Gauss theorem to the two terms in Eq. (8-129)
that involve second-order derivatives, we get
i
aT
J aNT
aT
21T
NTkr-nrdC -
21T
-kr-drdz
C'
ar
A' ar
ar
+ 2"11" r NTkr aT n, dC
Jer
az
i
aNT
er
2"11"
-
kr-drdz
A' az
az
+ 2"11"i
NTQr dr dz = 0
A'
(8·131)
where C' denotes that the integrations are to be performed around the boundary of
the element (in a counterclockwise direction). The direction cosines n, and nz are
shown in Fig. 8-18(a) for a typical triangular element. In a manner completely
analogous to Eq. (8-48), we may write
aT
q" =
-
k -
nr
ar
aT
k-n
az
z
(8·132)
where qn represents the net normal heat flux from conduction from within the
element to the boundary of the element as shown in Fig. 8-18(b). As mentioned
earlier both convection and imposed heat fluxes are to be considered. It is convenient
at this point to perform an energy balance on the global boundary as shown in
Fig. 8-18(b). If qsB and qcvB denote the imposed and convective heat fluxes,
respectively. then we may write
(8·1338)
or
We must now invoke Newton's law of cooling, or
qn'B = hB(T -
TaB)
(8·133b)
(8·134)
where hB is the convective heat transfer coefficient and TaB is the temperature of
the fluid far removed from the boundary. If Eqs. (8-131) to (8-134) are combined,
we get

AXISYMMETRIC HEAT CONDUCTION
425
------
(a)
z
Global
boundary
(b)
Figure 8-18
(a) Normal unit vector n shown for a typical triangular axisymmetric element.
(b) Typical part of the global boundary in the axisymmetric heat conduction problem showing
the heat fluxes considered in the finite element formulation.
J
aNT
st
J aNT
et
2'TT
-
kr -
dr dz -
2'TT
-
kr -
dr dz
A'
ar
ar
A'
Bz
az
+ 2'TTf NTQr dr dz = 0
A<
But the temperature T within an element e is given by
T = Na e
(8-135)
(8-136)
where N is the shape function matrix and ae is the vector of nodal temperatures
for element e. For the three-node triangular element, N is given by
(8-137)
and
a e = [T;
T,
TkV
(8-138)
where the shape functions themselves are given by Eqs. (6-21) with x and y replaced
by rand z. If the temperature Tin Eq. (8-135) is eliminated by using Eq. (8-136),
we get

426
STEADY·STATE THERMAL AND FLUID FLOW ANALYSIS
Keae =
fe
(8-139)
where Ke may be referred to as the composite element stiffness matrix and fe as
the composite element nodal force vector, both defined as
ceQ
and
fe =
Co +
C~B +
C~vB
The element stiffness matrices themselves are defined by
f
aNT
aN
2TI
-
kr -
dr dz
A' ar
ar
f
aNT
aN
2TI
-
kr -
dr dz
A'
az
az
and
and the element nodal force vectors by
2TIf NTQr dr dz
A'
2TI (
NTqsBr de
)c'
and
(8·140)
(8-141)
(8-1428)
(8-142b)
(8-142c)
(8-1438)
(8-143b)
(8-143c)
It is emphasized that the element characteristics given by Eqs. (8-142) and
(8-143) are quite general and may be applied to any suitable axisymmetric element.
Let us illustrate the use of the triangular axisymmetric element by way of several
examples.
Example 8-18
Evaluate the element stiffness matrix from conduction in the radial direction for
the triangular axisymmetric element.
Solution
From Eq. (8-142a), we see that the derivatives of each of the shape functions are
needed with respect to r. Recall that the shape functions for this element are given
by Eqs. (6-21) with rand zreplacing x and y, respectively, or
(8-1448)
(8-144b)

AXISYMMETRIC HEAT CONDUCTION
427
(8-144c)
where the mij's are given by Eq. (6-2Id) with r, and Zi replacing Xi and Yi, etc.
Therefore, Eq. (8-142a) becomes
K;, = 2TIL[:~~] [m21
m22
m23] kr dr dz
(8-145)
m23
Since the mi/s are constants and the thermal conductivity is assumed to be constant
(in each element), Eq. (8-145) may be written
K;, =
21T [:~~] [m21
m22
md Lr dr dz
(8-146)
m23
It proves to be very convenient at this point to represent the radial coordinate r
over the element as follows:
(8-147a)
where ri' ri , and rk denote the radial coordinates of nodes i, j, and k. If the shape
functions are written in terms of the area coordinates [see Eq. (6-25)], we get
(8-147b)
Note that at node i, the radial coordinate r becomes r., etc. Moreover, the area
coordinates (like the shape functions in this case) vary linearly with r over the
element. It seems quite reasonable, therefore, to use Eqs. (8-147b) to represent r.
The integral in Eq. (8-146) may be written as
J r dr dz
r,J t; dr dz + r J L dr dz
A'
A'
}
N'
}
(8-148)
+ r, J" i, dr dz
A'
Using the integration formula given by Eq. (6-49), we may evaluate a typical
integral as follows:
J
I!O!O!
L· dr dz =
2A
N
I
(I + 0 + 0 + 2)!
It should now be apparent that
J r dr dz = Y3(ri + rj + rk)A
A'
(8-149)
where A, the area of the element, may be calculated with the help of Eq. (6-2Ie)
if r, and z, are used in place of Xi and Yi' etc. Let us defined r as
r =
l!J(ri + rj + rk)
so that the final result for K;r may be given as
(8-150)

428
STEADY-STATE THERMAL AND FLUID FLOW ANALYSIS
/8-151)
/8-152)
The reader should compare the approach taken here with that used in Sec. 7-3 for
axisymmetric stress analysis.
•
It can be shown in a similar manner that the element stiffness matrix from
conduction in the axial direction is given by
[
m~1
K;z = 21TkrA
m32m31
m33m31
for the triangular element. In Eqs. (8-151) and (8-152) k is interpreted to be the
average value of the thermal conductivity over the element if it varies from point
to point. The element stiffness matrix from boundary convection is evaluated in
the next example for the triangular element.
Example 8-19
Evaluate K;vB given by Eq. (8-142c) for the element shown in Fig. 8-19.
Solution
From Fig. 8-19 we note that leg ij of element e is on the global boundary B. In
order to facilitate the evaluation of Eq. (8-142c), we should represent the shape
functions in terms of the area coordinates. In this case, the integral is to be evaluated
on leg ij where L k = 0 (and N, = 0). Therefore, on leg ij the shape function matrix
may be written
N = [L;
Lj
OJ
and the matrix K:vB may be written
/8-153)
Global
boundary
k
Figure 8·19
Typical element with at least one leg of the axisymmetric triangular element
on the global boundary.

AXISYMMETRIC HEAT CONDUCTION
429
K~vB = 2'lT r [2;] [Li
Lj
0] hBrdl
J1'l
0
Let us represent r on leg ij as follows:
Thus, Eq. (8-154) becomes
[
0
L;L
0]
K~vB = 2'lThBL L~;
Ll
0
(Lir; + LI} dl
'J
0
0
0
18-154)
18-155)
18-155)
where hB is assumed to be constant over leg ij. It should be noted that there are
two different types of terms that need to be evaluated. The first is evaluated as
( O(Lr) dl = r { £3 dl
J'ij
I
I
I
I J'ij
I
3!0!
= r,
[..
I (3 + 0 + I)!
I}
and the second as
( L;L(Lr) dl = r ( L 2L dl
)'ij
)
I
I
I )'ij
I
J
2!1!
= r,
l..
I (2 + 1 + I)!
I}
=
1/12 r/ij
18·156bl
where lij represents the length of leg ij. The final result for K~vB is given by
21Th I [3r; + rj
r. + rj
0]
K~vB = ~
r, + rj
r, + 3rj
0
(for leg ij on B)
18-157)
12
0
0
0
The reader should be able to derive the corresponding result if leg jk or ki happens
to be on the global boundary.
•
The three element nodal force vectors may be evaluated in a similar fashion
with the results
2'lTQA [2r; +
rj +
rk]
fQ'
= --
r, + 2r +
rk
12
I
}
r, +
rj + 2rk
f'
_ 2'lThBTaBlij [2r; +
rj ]
evB -
r; + Zr,
6
0
(for leg ij on B)
18-158)
18-1591

430
STEADY-STATE THERMAL AND FLUID FLOW ANALYSIS
and
2
I [2ri + rJ]
f c
=
rrq,n ij
. + 2
qB
r,
rJ
6
0
(for leg ij on B)
(8-160)
Equations (8-159) and (8-160) are valid if leg ij ison the global boundary. Similar
expressions could be written by inspection or easily derived for legs jk and ki. The
reader should derive the expressions for foin the case of a line source Q' at (ro.zo),
where Q: is the heat generation rate per unit circumference (i.e., at r = ro and
z = zo).
This completes the evaluation of each of the element stiffness matrices and
each of the nodal force vectors. The assemblage equations are formed in the usual
manner. The prescribed temperature boundary conditions, if any are present, would
be applied next. The solution for the temperatures would then follow and the heat
flows through the body could be evaluated. If the thermal conductivity k or con-
vective heat transfer coefficient hB is dependent on the temperature, the direct
iteration method from Sec. 8-2 may be used to solve for the nodal temperatures.
If a nonsymmetrical thermal load is imposed on the body, it may be possible
to perform an axisymmetric analysis by using a one-term Fourier series of sine and
cosine functions to represent the thermal loads and temperatures. The loads, how-
ever, must still be symmetric about a plane through the z axis. Huebner [2] and
Wilson [3) give additional details. Treatment of this aspect of axisymmetric heat
conduction is beyond the scope of this book.
8-10
THREE·DIMENSIONAL HEAT CONDUCTION
In this section the three-dimensional heat conduction problem is formulated. Figure
8-20 shows an arbitrary three-dimensional body in an xyz coordinate system. The
boundary conditions that will be considered on the surface of the body are the
following: convection, imposed heat fluxes (possibly acting at a distance such as
the sun), and prescribed temperatures. Recall that perfect insulation is a special
case of zero heat flux. A volumetric heat source will also be included. Thermal
radiation from the surface is not considered but could easily be added.
In Fig. 8-20, the heat fluxes from conduction in the x. y, and z directions are
denoted by q,. q., and q.. These heat fluxes may be related to the temperature T
within the body by Fourier's law of heat conduction for an isotropic body in three
dimensions, or
aT
q
- -k-
.r
-
iJx
aT
qz = -kaz
(8-161)
where k is the thermal conductivity. The minus signs in Eq. (8-161) are necessary
to ensure that each heat flux is positive if directed in the direction of decreasing
temperature.

Prescribed
temperature
Boundary
heat flux
(may act at
a distance)
THREE-DIMENSIONAL HEAT CONDUCTION
431
Boundary
convection
Boundary
radiation
(8-162)
Figure 8-20
Schematic of three-dimensional heal conduction problem.
The Governing Equation
The governing equation for general three-dimensional heat conduction in a heter-
ogeneous, isotropic body is given by
a(aT)
a(aT)
a( aT)
-
k- +- k- +- k-
+Q=O
ax
ax
ay
ay
az
az
where Q is the heat generation rate per unit volume. The thermal conductivity k
may vary throughout the body and may even be a function of temperature. The
mathematical form of the boundary conditions is given during the FEM formulation.
The Finite Element Formulation
As in the other heat conduction formulations, it is not necessary to choose the type
of element to be used in the discretization in order to determine the expressions for
the element characteristics. The reader may recall that in Sec. 6-5 two particular
three-dimensional elements were presented, namely, the four-node tetrahedral and
eight-node brick elements. After the general expressions for the element charac-
teristics have been derived, the emphasis will be on the tetrahedral element. Ad-
ditional three-dimensional elements are presented in Chapter 9.
The Galerkin method will be used on an element basis to derive the expressions
for the element characteristics. We begin by writing

432
STEADY·STATE THERMAL AND FLUID FLOW ANALYSIS
{
NT [i (k aT) + i
(k aT) + i (k aT) + Q] dx dy dz = 0
18-163)
Jv'
ax
ax
ay
ay
az
az
Note that each term in Eq. (8-163) has dimensions of energy per unit time. Using
the Green-Gauss theorem on the three terms involving second-order derivatives
gives
f.
st
1aNT er
i
st
NTk-
n dS -
-
k -
dx dy dz +
NTk-
n dS
S'
sx"
v'ax
ax
S'
ayY
1
aNT
er
i
st
-
k -
dx dy dz +
NTk-
n dS
v' ay
ay
S'
az
Z
1
aNT et
1
-
k -
dx dv dz +
NTQ dx dy dz = 0
v' az
az'
v'
18-164)
Note that three surface integrations arise. These integrals are identified by the S'
on the integrals and must be evaluated over the face (of each element) that is on
the global boundary. However, at this point it is convenient to combine these three
surface integrals into one integral by noting that
aT
aT
aT
q
=
- k- n
-
k -
n. -
k -
n.
n
~
x
~'
~.
18-165)
where qn is the net (normal) heat flux from conduction, i.e., in the direction of the
unit normal n to the surface as shown in Fig. 8-2I. Equation (8-165) is the three-
dimensional form of Eq. (8-48).
Now it is convenient to consider the convective and imposed heat flux boundary
conditions. An energy balance on the surface of the body in Fig. 8-21 gives
or
18-1668)
qll
18-166b)
Figure 8-21
Typical part of the global boundary in the three-dimensional heat conduction
problem showing the heat fluxes considered in the finite element formulation.

THREE-DIMENSIONAL HEAT CONDUCTION
433
Recall that the heat flux qcvB is proportional to the temperature difference between
the body and the ambient or
(8·167)
(8-168)
o
where hB is the convective heat transfer coefficient and TaB is the temperature of
fluid far removed from the body. If Eqs. (8-164) to (8-167) are combined, we get
(
NThBT dS + f.
NThBTaB dS + ( NTqsB dS
J~
~
J~
f,
aNT
et
f,
aNT
et
-
k -
dx dy dz
-
k -
dx dy dz
v- ax
ax
v- ay
ay
f,
aNT
et
f,
-
k -
dx dy dz +
NTQ dx dy dz
v- az
az
v-
The temperature T within an element may be represented by
T = Na"
(8-169)
where the shape function matrix N for the four-node tetrahedral element is given
by
(8-170)
N = [N, Nj
Nk
Nml
and the vector of nodal temperatures a e by
ae = [T, r, t,
Tmf
(8·171)
The shape functions themselves are given by Eqs. (6-40) in this case. If the tem-
perature T in Eq. (8-168) is eliminated by using Eq. (8-169), we get
Keae = fe
(8-172)
where Ke is the composite element stiffness matrix and fe is the composite element
nodal force vector, or
(8-173)
and
fe=fQ+f~B+f;'vB
The element stiffness matrices are defined as
(8·174)
Ke
=
xr
Ke =
yy
Ke =
zz
f,
aNT
aN
-k-dxdydz
v- ax
ax
f,
aNT
aN
-k-dxdydz
v'
ay
ay
f,
aNT
aN
-k-dxdydz
v' az
az
(8-175a)
(8-175b)
(8-175c)

434
STEADY-STATE THERMAL AND FLUID FLOW ANALYSIS
and
whereas the element nodal force vectors are defined as
(8-175d)
and
feQ
LNTQ dx dy dz
{
NTq,n dS
)s'
(8-1768)
(8-176b)
(8-176c)
The next step is to evaluate these integrals for the particular three-dimensional
element used in the discretization. For example, if the four-node tetrahedral element
is used, it can be shown that the results for the three element stiffness matrices
from conduction are given by[ "
m'il
m21 m22
m2l m23
m"mu]
K~x
kV
m 22m21
mi2
m 22m 23
m22m24
(8-177)
m23m2I
m23 m22
mi3
m23 m24
m24m2I
m24 m22
m24 m23
mi4
[ m"
mJl m32
mJI m33 mum,,]
K;y
kV
mJ2mJI
m~2
mJ2mJ3
m32 m34
(8-178)
m3Jm31
mJ3mJ2
m~3
m33m34
mJ4m3I
m34m32
mJ4m3J
m~4
and
[
mJ,
m 41m 42
m41 m4J
m"m"]
K: = kV
m42m41
ml2
m42m4J
m42 m44
(8-179)
zz
m 4J m41
m 4Jm42
ml3
m 43m44
m 44m4 I
m44m42
m44m 4J
ml4
where the mij's and volume V are given by Eqs. (6-40).
The element stiffness matrix from boundary convection deserves special atten-
tion. Note that the integral for K~vB is a surface integral, not a volume integral.
The surface referred to here is the surface of the element. The tetrahedral element
has four surfaces and, strictly speaking, K~vB should be evaluated over each of these
faces. However, if all faces are internal and not on the global boundary, we must
take K~vB to be the 4 x 4 null matrix since there is no convection on the internal
faces. Moreover, if a face is on the global boundary but no convection is present,
then again K~vB is taken to be the 4 x 4 null matrix. A nontrivial case is shown
in Fig. 8-22, where face ijk of the element e is on the part of the global boundary
that undergoes convection.

THREE-DIMENSIONAL HEAT CONDUCTION
435
Figure 8-22
Typical element with at least one face of the tetrahedral element on the global
boundary.
Example 8-20
Evaluate the element stiffness matrix KZvB for the element shown in Fig. 8-22.
Solution
From Eq. (8-l75d) we see that the shape functions themselves appear in the inte-
grand. It is convenient to represent the shape functions in terms of the volume
coordinates [see Eq. (6-43»). Note that Lm = 0 on face ijk. Therefore, Eq, (8-175d)
becomes
(8·180)
where A ijk denotes the area of face ijk. Note that this face is a triangle and the
volume coordinates have degenerated to the three area coordinates. It seems ap-
propriate, therefore, to use the special integration formula given by Eq. (6-49). For
example, a typical term in the matrix may be evaluated as follows:
i. hBL;Lj dS = hB
I!I!O!
2A
_ hBAijk
A~
(I + 1+0+ 2)!
ijk-
12
The final result is given by
e
_ h,A,{
I
I
~]
2
I
for face ijk on the
(8-181)
KnoB -
12
I
I
2
global boundary B
0
0
0
It is emphasized that this result is valid if face ijk of the tetrahedral element is on
the global boundary B. The reader should be able to evaluate K;'vB if any of the
other faces happen to be on the global boundary.
•
The nodal force vector Co may be evaluated with the help of Eq. (6-50) if the
shape functions are written in terms of the volume coordinates. The result is

436
STEADY-STATE THERMAL AND FLUID FLOW ANALYSIS
fe = QV [~J
Q
4
I
I
(8·182)
where the volume V is given by Eq. (6-4Of). The heat source Q is assumed to be
constant in arriving at Eq. (8-182); if Q is nonuniformly distributed in the body,
then Q should be taken to represent a suitable average value over the element or
the value of Q at the element centroid may be used. Note that one-fourth of the
total heat source QV is allocated to each of the four nodes. Refer to Problem
8-176 for the case of a point heat source.
The same arguments used in the evaluation of K;'vB apply to the evaluation of
~B and evB with the results
fe
= ~ [~J
qB
3
I
o
for face ijk on the
global boundary B
(8-183)
and
(8-184)
for face ijk on the
global boundary B
~
= hnAijkT
aB [~J
<'vB
3
I
o
Note that Eqs. (8-183) and (8-184) hold if face ijk is on the global boundary. These
results can be extended by inspection if faces jkm, ijm, or ikm happen to be on the
global boundary.
This completes the evaluation of the element stiffness matrices and the nodal
force vectors. The assemblage step could now be done in the usual manner. The
solution is also standard, providing the thermal properties are not a function of
temperature; otherwise the direct iteration method presented in Sec. 8-2 could be
used. The element heat fluxes qx. qy. and qz may also be calculated using the general
approach taken in Sec. 8-8. These heat fluxes would represent average values and
are associated with the centroid of the tetrahedron.
8·11
TWO-DIMENSIONAL POTENTIALFLOW
The flow of an incompressible and frictionless fluid (also known as an ideal fluid)
is referred to as potential flow. No real fluid is truly frictionless. Outside the
boundary layer, however, frictional effects may be neglected. In addition, if the
fluid may be assumed to be incompressible, then the assumption of potential flow
is valid. The flow is also then said to be irrotational. It may be recalled from gas
dynamics that the flow of a gas may be considered to be incompressible for Mach
numbers of 0.3 or less. A few of the many applications of potential flow are

18-185)
18-186)
TWO-DIMENSIONAL POTENTIAL FLOW
437
aerodynamics (including flow around airfoils), groundwater flow, flow through
large enclosures (such as a reservoir), and flow around corners.
Only two-dimensional incompressible flow is modeled in the formal devel-
opment. However, both the velocity potential and stream function formulations are
developed. In both types of formulations, the continuity equation is given by
au
av
-
+
= 0
ax
ay
and the irrotational flow condition by
au
av
---=0
ay
ax
where u and v represent the x and y components of the fluid velocity. The velocity
potential formulation will be seen to satisfy the irrotational flow condition exactly,
whereas the stream function formulation will be seen to satisfy the continuity
equation exactly.
The development in this book is limited further to external flows around sym-
metric bodies such as the one shown in Fig. 8-23. For unsymmetrical bodies such
as airfoils, an additional condition called the Kutta or Kutta-Joukowski condition
must be satisfied. This condition requires that the downstream stagnation point be
located at the downstream edge. This can only happen if there is circulation around
the body, thus causing lift. The reader is referred to several excellent books on
fluid mechanics [4-6] for more information on this aspect of potential flow.
Velocity Potential Formulation
The irrotational flow condition given by Eq. (8-186) is satisfied exactly if the
velocity potential <l> is defined by
Figure 8-23
Two-dimensional potential flow around a symmetric body.

438
STEADY-STATE THERMAL AND FLUID FLOW ANALYSIS
al!>
u =
aX
and
al!>
v =
ay
(8-1878)
(8-187b)
(8-188)
(8-189)
(8-190)
(8-191)
If these expressions for the velocity components are substituted into the continuity
equation given by Eq. (8-185), the result is the two-dimensional form of Laplace's
equation, or
a2l!>
a2l!>
-+-=0
ax2
ay2
The Galerkin method on an element basis gives
J
[
a2l!>
a2l!>]
NT -
+ -
dx dy = 0
A'
ax2
ay2
where the shape function matrix N is dependent on the type of element used. We
will derive the expressions for the element characteristics in general and then apply
these results to the triangular element in particular.
If the Green-Gauss theorem is used, we get
f
NT al!> n dC _ I aNT al!> dx dy
Je-
ax
x
A'
ax
ax
+ f W al!> n
v dC _ f aW al!> dx dy = 0
Jc'
ay·
JA' ay
ay
Let us use Eqs. (8-187) to introduce the two velocity components into the for-
mulation or
_ f
W un dC _ f aNT al!> dx dy
Je-
.r
JA' ax
ax
- f.
NT vn, dC - J aW al!> dx dy = 0
C'
.
A'
ay
ay
At this point it is convenient to represent the velocity potential l!> on an element
basis by writing
¢ = Na"
(8-192)
where the vector a e contains the values of the potential at the nodes for element e.
Since ae is not a function of x or y, we can combine Eqs. (8-191) and (8-192) to
get
Keae = fe
where the composite element stiffness matrix K" is defined by
(8-193)
(8-194)

TWO-DIMENSIONAL POTENTIAL FLOW
439
and the composite element nodal force vector fe is defined by
fe = fZn +
f~B
The element stiffness matrices K~ and K;y are defined by
i
aNTaN
Ke =
--dxdy
xx
A' ax
ax
and
i
aNTaN
K~
=
--dxdy
.Y
A'
ay
ay
whereas the element nodal force vectors f~B and f~B are defined by
f~B =
-
(
NT un.r de
Je-
and
(8·195)
(8-196a)
(8-196b)
(8·197a)
(8-197b)
Equations (8-196) and (8-197) are quite general in that they may be applied to any
two-dimensional element. For example, if the three-node triangular element is used,
K~.. and K;y evaluate to
(8-198)
and
(8-199)
The integrals for f~B and f~B in Eqs. (8-197) need to be evaluated on the element
boundaries only. However, each direction cosine takes on opposite signs on legs
shared' by two elements. Ineffect, the vectors f~B and f~B on an internal leg for one
element cancel the corresponding vectors on the same leg for the adjacent element.
The cancellation occurs at the assemblage step. Therefore, Eqs. (8-197) need to be
evaluated only for those elements with at least one leg on the global boundary. For
example, consider the triangular element shown in Fig. 8-24(a). Note that leg ij is
on the global boundary. In Example 8-21,
f~B is evaluated for the case when u is
assumed to vary linearly over the leg as shown in Fig. 8-24(b).
Example 8-21
Evaluate FuB for the element shown in Fig. 8-24(b). Note that u is assumed to vary
linearly over the leg such that at nodes i and j, the x components of velocity are
u, and Uj' respectively.

440
STEADY-STATE THERMAL AND FLUID FLOW ANALYSIS
(al
n
U;
(b]
y
L:.
n
(e)
Figure 8-24
(a) Typical element with at least one leg of the triangular element on the
global boundary. (b) Linearly varying x component of velocity on leg ij of triangle. (c) Linearly
varying y component of velocity on leg ij of triangle.
Solution
On leg ij we have Nk = L,
0, and so we may write
(8-200)
since this gives the desired linear variation of u over the leg. Equation (8-197a)
becomes
r.:B =
- L[Z~] a», + Lp)nt dl
I'J
0
(8-201)

•
(8-202)
TWO-DIMENSIONAL POTENTIAL FLOW
441
where lij is the length of leg ij. If L, and Lj are interpreted to be length coordinates,
Eq. (6-48) may be used to integrate Eq. (8-201) to give
~~ = -"t [2:: ~ 2~]
The reader should show that if v is assumed to vary linearly over leg if as
shown in Fig. 8-24(c), the result is
l.n
[2Vi +
Vj]
~B =
_:JJ:2
v. + Zv,
v
6
I
}
o
(8-203)
where Vi and Vj are the Y components of velocity at nodes i and j, respectively.
Similar expressions could be derived or written by inspection if legjk or ki happens
to be on the global boundary.
One method for determining the two direction cosines n, and ny for any leg of
the triangular element is now presented. Let us arbitrarily concentrate on leg if and
define the vector rij as the vector running from node i to node j, as shown in Fig.
8-25. Therefore, we have
(8-204)
where Xi and Yi are the coordinates of node i; Xj and Yj are the coordinates of node
i. and i and j are the unit vectors along the X and Y axes, respectively. The unit
vector n is defined to be the outward normal to leg if such that
n = n) + nyj
(8-205)
where the direction cosines n f and ny are to be determined. The reader may recall
that the cross product of two vectors results in another vector whose direction is
determined by the right-hand screw rule moving from the first vector to the second
v
k
n
L----------_x
Figure 8·25
Vectors riik and n needed to determine nx and ny, the direction cosines.

442
STEADY·STATE THERMAL AND FLUID FLOW ANALYSIS
through the smaller angle. If this is applied to the situation shown in Fig. 8-25, we
may write
n =
fij X k
If;; x k]
(8·2061
where k is the unit vector in the z direction. The cross product of two vectors a
and b is most easily evaluated from
[. . k]
a x b = det
~..r
~\
Go
b,
b,
bo
(8-2071
= ta.b, -
Gob,.) i + (Gob, -
a,bz)j + tab; -
a,.bl ) k
where at' a,., and a, are the x, y. and z components of a, etc. When Eqs. (8-205)
and (8-206) are compared after the cross products are evaluated with the help of
Eq. (8-207), the result is
and
__ Xl
-
Xi
n; -
I
/}
where lij is the length of leg ij and is given by
lij = V(xj -
X)2 + (Yj -
y;)2
Similar results may be obtained if leg jk or ki is on the global boundary.
Example 8-22
(8-208sl
(8-208bl
(8-2091
17,5)
Determine the direction cosines n, and n, on leg ij for the element shown in Fig.
8-26.
(3,8)
j
k_----------"I
(3,5)
Figure 8-26
Triangular element in Example 8-22.

TWO-DIMENSIONAL POTENTIAL FLOW
443
Solution
Using the nodal coordinates shown in Fig. 8-26, we get
n" =
8 -
5
YO - 7)2 + (8 - W
_ 3 -
7 = 0.8
5
3
5
0.6
Note that the sum of the squares of the direction cosines is unity as it should be.•
On occasion it proves to be convenient to combine f:;B and t;.B into one term
by noting that the normal velocity V" may be written in terms of u and v as
V" = un, + vn"
Equations (8-197) may be combined and FvB may be defined as
FvB = f;,B + f:'B = - J.
NTv" de
C"
It also follows that
a<l>
V
= --
"
an
where n represents the coordinate in the direction of the outward normal.
The Element Resultants
(8-210)
(8-211)
(8-212)
This completes the velocity potential formulation of two-dimensional, steady po-
tential flow problems, The assemblage of each element stiffness matrix and nodal
force vector is routine. Note that imposed velocities are not considered to be
geometric boundary conditions; instead, nodal velocities are imposed via Eqs.
(8-202) and (8-203) for the triangular element and by Eqs. (8-197) in general. The
geometric boundary conditions are the prescribed velocity potentials, These may
be applied with either Method I or 2 from Sec. 3-2, The resulting system of linear
equations may be solved either by the matrix inversion method or by the active
zone equation solver. The average velocities Ii and vfor a typical triangular element
e could then be determined from
a<l>
aN
-m21<l>i -
m22<l>j -
m23<l>k
u =
--ae
(8-213a)
ax
ax
a<l>
aN
- m31<l>i -
m32<l>j - m33<l>k
V
- -ae =
(8-213b)
ay
ay
where the mij's are computed from Eqs. (6-21) and <l>;, <l>j, and <l>k are the now
known nodal values of the potential. These average velocities are generally asso-

444
STEADY·STATE THERMAL AND FLUID FLOW ANALYSIS
ciated with the centroid of the triangular element. The method of quadrilateral
averages could be used to improve these results.
Application: Flow around a Long Cylinder
Let us consider a long cylinder positioned transversely in a flow field between two
flat plates as shown in Fig. 8-27(a). Because the cylinder is assumed to be long,
end effects may be neglected; hence, the flow field is two-dimensional. Only the
region outside of the boundary layer is considered so that viscous effects may be
neglected. Let us also assume the fluid to be incompressible. Clearly, the potential
flow formulation applies and the resulting streamlines and potential lines are shown
in Fig. 8-27(b).
Because of the two-axis symmetry, only one-fourth of the region needs to be
modeled as shown in Fig. 8-28. Note that the inlet velocity U enters the finite
Velocity U ==:
(a)
Streamlines
I
I
I
1
I· \
I
I
(b)
Figure 8-27
Application of two-dimensional, incompressible potential flow. (a) Long
cylinder placed transversely in a uniform flow field between two flat plates and (b) the
associated flow field around the cylinder. Lines of constant potential are always perpendicular
to the streamlines.

TWO-DIMENSIONAL POTENTIAL FLOW
445
element formulation via f~B (or f~B) for those elements with a leg along side a-e.
Also note that f~B and f;'B (or fV'B) are identically zero along sides a-b and d-e. Since
the flow cannot penetrate the solid cylinder, VII must be zero along the cylinder be
and hence
f~B is zero here. Finally, along side e-d, an arbitrary value of <l> (a
constant) must be chosen. This last boundary condition is not explicitly included
in the finite element formulation and is imposed in the usual manner after the
assemblage equations are formed.
Stream Function Formulation
The continuity equation given by Eq. (8-185) is satisfied exactly if the stream
function IjJ is defined by
iJljJ
u =
iJy
and
iJljJ
v =
iJx
(8-214a)
(8-214b)
If these expressions for the velocity components are substituted in the irrotational
flow condition given by Eq. (8-186), the result is the two-dimensional form of
Laplace's equation or
~=o
3n
I
u = - ~
1-1--+----t""-
I
v ~--+---4:_~~
x
~ =0
3n
o
c
(8-215)
Figure8-28
Only one-quarter of the flow field needs to be modeled because of the double
symmetry. The boundary conditions shown apply to the velocity potential formulation.

18-216)
446
STEADY·STATE THERMAL AND FLUID FLOW ANALYSIS
It should be noted that lines of constant 1/1 are really streamlines, and lines of
constant potential <I> must always be orthogonal or perpendicular to these lines.
Using the Galerkin method on an element basis gives
f [
a21/1
a21/1]
NT -
+ -
dx dy = 0
A'
ax2
ay2
where the shape function matrix N is dependent on the type of element used.
Following the approach taken in the velocity potential formulation, the reader should
be able to show that Eq. (8-216) can be written
Keae = fe
where
18-217)
and
Ke
K~x +
K~)
18-218)
The element stiffness matrices are now defined by
i
aNTaN
Ke
=
--dxdv
.cr
A' ax ax
-
and
l
aw aN
K~, =
-
-. dx dv
..
A'
ay ay
..
and the element nodal force vectors by
f'~B =
( NTun; de
le.
or
18-219)
18-2208)
18-220b)
18·2218)
18-221b)
The evaluation of these element stiffness matrices and nodal force vectors for
typical two-dimensional problems is left as an exercise. For the triangular element,
the direction cosines can be evaluated with the help of Eqs. (8-208).
Application: Flow around a Long Cylinder
Let us reconsider the example from the velocity potential formulation: a long
cylinder placed transversely in a flow field between two flat plates as shown in
Fig. 8-27(a). Figure 8-27(b) shows the streamlines and lines of constant velocity
potential. The streamlines actually represent lines of constant stream function 1/1.
Because of the two-axis symmetry, only one-fourth of the flow field needs to be
modeled as shown in Fig. 8-29. The line a-hocrepresents one streamline and hence

TWO-DIMENSIONAL POTENTIAL FLOW
447
llJ is a constant on this line. Let us denote this constant value of llJ as llJl' The line
d-e represents a different streamline. Let us denote the value of the stream function
along d-e as llJ2' Only one of these values is arbitrary, with the other value to be
determined from physical considerations as shown below. Let us assume that the
inlet velocity U on face a-e is constant. The velocity U can be related to llJ by Eq.
(8-2l4a) or
U
18-222a)
Since U is constant, we may write
U
Ye -
Ya
18-222b)
If llJI is taken arbitrarily to be zero, then llJ2 is given as
18-222c)
where Ye and Ya denote the Y coordinates of points e and a, respectively. Since
there is no tangential velocity along faces a-e and c-d, it follows that
f'~B = 0
on these faces. Furthermore, since ny = 0 on these faces, we also have
f'~B = 0
18-223a)
18-223b)
The conditions expressed by Eqs. (8-223) are equivalent to the condition that the
streamlines are normal to the boundary. Hence
c
'" = '" 1 (arbitrary)
\
\
I
I
\
\
\
\
x
\
I
I
I
I
I
\
I
aL---.......--...w,r---.:::-~
I
~ = 0
f-I--+-~~-+--+---r-:
an
'-...l
u- f-i--+----1r---
V I-----l----r~
Figure 8-29
Only one-quarter of the flow field needs to be modeled because of the double
symmetry. The boundary conditions shown apply to the stream function formulation.

448
STEADY·STATE THERMAL AND FLUID FLOW ANALYSIS
(8-224)
aljJ = 0
an
where n is the coordinate in the direction normal to the boundary. Clearly we have
natural boundary conditions along faces a-e and cod.
8-12
CONVECTION DOMINATED FLOWS
The governing equations for heat conduction that we have seen in previous sections
did not allow for any type of fluid motion within the region being analyzed. In
general, fluid motion is very effective in transporting energy, usually much more
effective than conduction alone. The purpose of this section is to provide an intro-
duction on how the finite element method may be used to model such problems.
Although a particular case is described and the FEM formulation given, the same
basic approach may be applied to other similar problems. In this section, a particular
velocity profile will be assumed for the purpose of illustrating how the temperature
distribution may be obtained.
Let us consider the case of forced flow of a Newtonian, constant property,
incompressible fluid between two flat plates as shown in Fig. 8-30. It is assumed
that the flow is laminar and hydrodynamically fully developed, so that a parabolic
velocity profile results. In this case the thermal energy equation alone needs to be
solved for the temperature distribution. Various boundary conditions may be im-
posed as shown in Fig. 8-30. The governing equation to such a problem is given
by
Imposed heat flux
Prescribed
temperature
T= T(x.y)
I
I
I
It..
I
I
I
I
I
I
I
I
Unheated
entrance ~------iH­
region 1-------1
H
Fully developed
velocity profile
Imposed heat
flux
Figure 8-30
Thermal entrance region of a hydrodynamically, fully developed laminar flow
of a Newtonian fluid between two long flat plates.

CONVECTION DOMINATED FLOWS
449
(8-2258)
pcu(y)aT = ~(k aT) + ~(k aT)
ax
ax
ax
ay
ay
where T is the temperature of the fluid at any point (x,y), u is the x component of
velocity, p is the fluid density, c is the specific heat (at constant pressure), and k
is the thermal conductivity. Because of the hydrodynamically, fully developed flow
assumption, the y component of velocity is assumed to be zero and, thus, is not
present in Eq. (8-225a). The velocity u is given by
u(y) = Y2U[1 - (~r]
(8-225b)
where Uis average velocity of the fluid and H is half of the plate separation distance
as shown in Fig. 8-30.
In this formulation, the properties are assumed to be constant. However, we
would proceed in much the same manner if c and k were functions of temperature.
The solution (and the problem), however, would be nonlinear and the direct iteration
method from Sec. 8-2 could be used to obtain the solution for the nodal temperatures.
The density p may not be temperature-dependent because this would not result in
a parabolic velocity profile. In fact, in this case the continuity, Navier-Stokes, and
energy equations would have to be solved simultaneously. Because the formulation
is two-dimensional, Eq. (8-225a) assumes that the two plates are infinitely long
perpendicular to the paper.
It is interesting to note that, except for liquid metals, axial conduction may be
neglected for Peelet numbers greater than 100 [7]. For liquid metals, axial con-
duction may be neglected for Peelet numbers greater than 160. The Peelet number
is denoted as Pe and is defined to be the ratio of energy transport by convection
to energy transport by conduction. If U represents the average velocity in the x
direction, Dh is the hydraulic diameter, and a is the thermal diffusivity, the Peelet
number is defined by
UDh
Pe =--
a
where the thermal diffusivity is given by
k
a =-
pc
(8·226)
(8-227)
The hydraulic diameter D; is defined by
4 x flow area
Dh =
(8-228)
wetted perimeter
Note that the Peelet number is equal"to the product of the Reynolds and Prandtl
numbers, or
Pe = Re Pr
where the Reynolds number is defined by
(8·229)

450
STEADY-STATE THERMAL AND FLUID FLOW ANALYSIS
Re = UDh
V
and the Prandtl number by
V
Pr = -
ex
where V is the kinematic viscosity, related to the absolute viscosity 1.1. by
(8-230)
(8-231)
(8-232)
1.1.
v = -
p
In the case of two large flat plates separated by a distance 2H, the Peclet number
is given by
4UH
Pe =--
ex
(8-233)
(8-234)
(8-235)
The Galerkin method will be applied to Eq. (8-225a) in the usual manner.
Interestingly it is not even possible to obtain the classical variational principle that
corresponds to Eq. (8-225a). It will be seen that the Galerkin method in this case
yields an unsymmetric stiffness matrix. The implications of this will be discussed
briefly later. Try to make an educated guess as to which term in Eq. (8-225a) yields
the unsymmetric stiffness matrix.
On an element basis, the Galerkin method requires that we write
i [
aT
a(aT)
a( aT)]
NT pcu- - -
k-
- -
k-
t dx dy = 0
A'
ax
ax
ax
ay
ay
The thickness t is introduced so that each term in Eq. (8-234) has dimensions of
energy per unit time. We can take t to be unity for convenience. If the Green-Gauss
theorem is applied to the two terms involving second-order derivatives, and if the
boundary integrals are combined by using Eq. (8-48), we get
i
et
1
J aNT st
NTpcu-t dx dy +
NTqnt de +
-kt- dx dy
A'
ax
C'
A' ax
ax
i
aNT
et
+
-kt- dx dy = 0
A' ay
ay
If the heat fluxes qs8 on the global boundary are imposed in the direction toward
the fluid, then we have
(8-236)
Furthermore, if we represent the temperature T on an element basis and write
T = Na"
(8-237)
and note that the vector a' is independent of x and y, Eq. (8-235) becomes
Keae = fe
(8-238)

CONVECTION DOMINATED FLOWS
451
where the composite element stiffness matrix Ke is given by
Ke = Kit + K;y + K~
and the element nodal force vector by
r- =
{
NTqsBt dC
]e'
(8-239)
(8-240)
The element stiffness matrices from conduction are identical to the expressions for
Kit and K;y from Sec. 8-8 [see Eqs. (8-106)]. The element stiffness matrix-from
the convective transport is given by
f
aN
K~ =
NTpcut- dx dy
A'
ax
(8-241)
Note that K~ is unsymmetric, unlike Kit and K;yo The element stiffness matrices
and nodal force vector may be evaluated for particular two-dimensional elements,
such as the triangular and rectangular elements. This is fairly routine and the details
are omitted here.
The fact that one of the element stiffness matrices is unsymmetric deserves
special attention. The assemblage of the element characteristics is done in the usual
manner, except that the upper and lower parts of the assemblage stiffness matrix
need to be stored. Recall from Sec. 6-8 that subroutine UACTCL [8] from Appendix
C may be used in this case to obtain the solution for the nodal temperatures (after
the prescribed temperatures have been imposed). In this subroutine, the upper
triangular coefficients are stored in the array A, whereas the lower triangular coef-
ficients are stored in the array C. Recall that unity is stored for the diagonal entries
in the C array (the actual diagonal entries are stored in the A array).
Because the assemblage matrix is unsymmetric, the nodal temperatures that
are calculated mayor may not be correct. When the results are not correct, it is
usually quite obvious-for example, the temperatures may be oscillatory with
respect to the spacial coordinates. This oscillatory behavior should be expected if
the elements are larger than a certain threshold size. More specifically, the threshold
of oscillatory behavior is given in terms of a particular Peclet number referred to
as the cell Peclet number defined as
UL
a
(8-242)
where L is a characteristic element length. Oscillatory behavior generally occurs
when the cell Peclet number is greater than 2 [9] for one-dimensional models.
Therefore, by reducing the size of the elements (and increasing the number of
elements), we can generally improve the results after the threshold size is reached.
Gresho and Lee [10) contend that the use of higher-order elements (see Chapter 9)
will substantially improve the results. This contention has been verified further by
Srivastiva [II) who did follow-up research on the study by Kundu and Stasa [12).
The Galerkin method is mathematically equivalent to a central finite difference.
Convection-dominated flows generally require a backward (or upwind) difference

18-243)
18-2448)
452
STEADY-STATE THERMAL AND FLUID FLOW ANALYSIS
to aid the convergence. In the finite element method, upwinding schemes also exist.
References 13 and 14 should be consulted for more information on modeling con-
vection-dominated flow problems. In these references, the use of upwinding schemes
is also discussed. Further discussion of these topics is beyond the intended scope
of this text.
8-13
INCOMPRESSIBLE VISCOUS FLOW
In this section, it will be shown how the finite element method may be used to
solve for the velocity distribution in convection-dominated flows. Let us consider
the laminar flow of a viscous fluid for the case of moderate Reynolds numbers such
that the convective terms in the Navier-Stokes equations are significant. Typical
examples would include external boundary-layer flows and internal flows. For
example, we may want to determine the two-dimensional velocity field for a fluid
moving through a duct with an obstruction in it as shown in Fig. 8-31. The flow
field at the entrance of the duct may be assumed to be either fully developed or
developing. Let us indicate how the finite element characteristics may be derived
for such a complicated problem by starting with the two-dimensional form of the
continuity and Navier-Stokes equations for a constant-property, incompressible,
Newtonian fluid.
The continuity equation for an incompressible fluid is given by
au
av
-
+ -
= 0
ax
ay
where u and v are the x and y components of the fluid velocity at any point (x,y).
The Navier-Stokes equations in the x and y directions are given by
(
d2U a2u)
~ 2
+ 2
+ F,
ax
ay
Figure 8·31
Viscous flow through an obstructed duct.

INCOMPRESSIBLE VISCOUS FLOW
453
(8-244b)
(8-245)
where p is the fluid density, p is the pressure, f.L is the absolute viscosity, and F,
and F; are the body forces per unit volume in the x and y directions, respectively.
In Eqs. (8-244) the convective acceleration terms [on the left-hand side of Eqs.
(8-244)] make the problem to be solved nonlinear. The region to be analyzed may
be discretized in the usual manner with triangular or rectangular elements. The goal
is to determine the nodal values of the pressure and the velocity components, since
the formulation is to be based on the so-called primitive variables.
If the Galerkin method is applied to Eq. (8-243), we get
i (au
av)
.
NT -+- tdxdy=O
A'
ax
ay
where the thickness t is introduced so that each term in Eq. (8-245) has dimensions
of volume per unit time (i.e., a volumetric flow rate). For convenience, t can be
taken to be unity. Let us assume
and
where a~ and a~ are given by
and
u =
Na~
v =
Na~
(8-246a)
(8-246b)
(8-247a)
(8·247b)
for the triangular element. In Eqs. (8-247), U;, Uj, and Uk are the x components of
the velocity at nodes i, j, and k, etc. Since a~ and a~ are independent of x and y,
Eq. (8-245) can be written in the form
where
(8-248)
and
K'u i
aN
NT -t dx dy
A'
ax
(8-249)
i
aN
K~ =
W-tdxdy
A'
ay
Let us now apply the Galerkin method to Eq. (8-244a) by writing
i NT[p(uau + vau) + ap _ f.L(a
2u
+ a
2u)
- Fx]tdxdY = 0
A'
ax
ay
ax
ax2
{ly2
(8-250)
(8-251)

454
STEADY-STATE THERMAL AND FLUID FLOW ANALYSIS
Note that each term in Eq. (8-251) has units of force. The _green~(]llass theor~~
may be applied in the usual manner to the two terms involving second-order
derivatives. However, the integrals around the element boundary (over C') need
not be considered further because the velocity components are generally prescribed
on the global boundary. The boundary integral terms are related to the shear stresses
(which are not generally prescribed). Noting Eqs. (8-246) and representing the
pressure p over the element by
p =
Na~
Eq. (8-251) may be written in the form
where
f'.r
18-2521
18-2531
and
K~u =
K'ux
i
aN
NT pNa~-t dx dy
A'
ax
J
aN
NTpNa~-t dx dy
A'
ay
i
aNT
aN
-f.l-tdxdy
A' ax
ax
J
aNT
aN
-f.l-tdxdy
A' ay
ay
J
aN
NT-t dx dy
A'
ax
18-25481
18-254bl
18-254cl
18-254dl
18-254el
18-254fl
In a similar fashion, it can be shown that if the Galerkin method is applied to Eq.
(8-244b), the result is
where
(K~v +
K~\ +
K~x +
K~y)a~ +
K;va~ =
f\~
J
aN
NTpNa'-t dx dy
A'
/I ax
18-2551
18-25681
K~v =
K~y =
J
aN
NTpNa~-t dx dv
A'
\ ay
.
J
aNT
aN
-f.l-tdxdy
A' ax
ax
J
aNT
aN
-f.l-tdxdy
A' ay
ay
18-256bl
18-256cl
18-256dl

INCOMPRESSIBLE VISCOUS FLOW
455
and
K~y = J
aN
W-tdxdy
A'
ay
(8·256e)
fJ~ = i NTFyt dx dy
(8·256f)
A'
There are two different ways in which the assemblage step may be performed.
The first step in both procedures is to write Eqs. (8-248), (8-253), and (8-255) in
the following partitioned matrix form:
[
~l
~---------I5~---------~--~-] E~1
~2~
K~u + K~u + K~, + K~, I
0
l!S:x
a~
=
f:
(8·257)
---------O----------r-Ri~+-K7;+-K~;+-~;-1-Kh
-~-
-~-
In the first method of assemblage, the individual terms in Eq. (8-257) are assembled
such that the vector of nodal unknowns is given by
v" i PI
P2
...
P"V
(8·258)
(8·259)
where n nodes are assumed in the discretization of the region being analyzed. This
type of assemblage results in a significantly increased bandwidth of the assemblage
system equations. Therefore, a more practical method of assemblage is needed,
and one such method is presented below.
Let us denote the submatrices and subvectors in Eq. (8-257) as follows:
[
K
11
I KI2 I KI3]~ae~
[fl~
'i{21-t-i{"TI-t-i{21 -ii-
=
C'r
•
.J..
.I____
---
K31 I K32 : K33
a~
f3
Note the use of the numerical superscripts to indicate the relative position of each
submatrix and subvector in Eq. (8-259). Let us now use subscripts to indicate the
entries within each submatrix. For example, if the three-node triangular element
is used, let us write
and
[K
I III
K~ = K 11 =
K~l
K 11
31
KU
Kg]
K 1I
KII
22
23
KH
KH
(8·260a)
(8·260b)
and so forth. Note that KI3, K22, and K31 are 3 x 3 null matrices and fI is a
3 x I null vector. Let us now do a miniassemblage such that the vector of nodal
unknowns on an element basis is given by
(8·261)
Using the nomenclature illustrated by Eqs. (8-260), Eq. (8-257) may be written

456
STEADY-STATE THERMAL AND FLUID FLOW ANALYSIS
K I I
KI2
K I3
II K"
K I2
K 13 I K"
K I2
KI3
II
II
II
12
12
12113
13
13
K 21
K22
K 23 I K21
K 22
K23
II K21
K22
K23
II
II
II
I
12
12
12
I
13
13
13
K 31
K 3? KP tK31
K 32
K33 I Kn
Kn
KTl
-~1----~r---i1- --tt----~----P31--Tr----~----1!
~I
~I
~I
~
~
~l~
~
~
K 21
K22
K 23 I K 21
K22
K23: K21
K 22
K 23
21
2I
2I
22
22
22
I
23
23
23
K 31
K32
K 33 J K31
K32
K33
I K31
K 32
K33
-~--- 2!
~-~*---¥i.---f~+-ll_%R---~
K 31
K!I
K!I I K 32
K 32
K 32: KH
K 33
K!j
K 21
K22
K 23: K21
K22
K23
I K21
K 22
K23
31
3I
3I
J
32
32
32 I
33
33
33
K 31
K32
K 33 J K31
K32
K 33: K31
K 32
K33
3I
31
3I
J
32
32
32
I
33
33
33
Ui
Vi
.n.
Uj
Vj
.EL
Uk
Vk
Pk
The assemblage of Eq. (8-262) may now be done in the usual manner such that
the vector of nodal unknowns is given by
(8-263)
where again n nodes are assumed in the discretization of the region being analyzed.
Note that this type of assemblage was done routinely in all stress analyses in Chapter
7 and results in a significantly smaller bandwidth than would result otherwise.
Prescribed velocities and pressures would be applied by using either of the two
methods from Sec. 3-2. Since the assemblage system equations are unsymmetric,
subroutine UACTCL [8] from Sec. 6-8 (see Appendix C) may be used to obtain
the solution for the nodal velocities and pressures.
;;,l,'heabove f,.onn.uJ~:~..~J.9.D ,'.~ '~.'
..' ~
...•.'....••.........
· ' :.·v~ van.·.a.b
.. les: the. ve-
locities and~.~,~sex~.,·, .••... ;.~:fulUitiOn. As
in the analysis of two-dimensional potential flow problems, the stream function is
defined such that the continuity equation is satisfied exactly. The three governing
equations reduce to two partial differential equations, and the order of the highest
derivative present increases from two to three. The interested reader should consult
References 15 and 16 for more details on the stream function formulation, as well
as another approach referred to as the vorticity formulation.
It has been assumed above that the same shape functions may be used for the
pressure and velocity functions. This seems to give good results for rather low fluid
velocities. For high fluid velocities, the elements (and hence shape functions) used
for the velocity function should be one order higher than those used for pressure.
Several such higher-order elements are presented in Chapter 9. Again the reader is
referred to References 15 and 16 for further details.
8·14
DEVELOPMENT OF A TWO-DIMENSIONAL THERMAL
ANALYSIS PROGRAM
Some helpful hints and comments are given in this section so that the reader can
develop a two-dimensional thermal analysis program with further instructions from

THERMAL ANALYSIS PROGRAM: PROGRAM HEAT
457
the instructor.* Specific comments are made with respect to the main program,
mesh generation, data storage, variable properties, and point heat sources.
The Main Program
The main program should be kept as brief as possible. An example is the following
seven lines of code:
PROGRAM HEAT
COMMON XL (2500)
MAX = 2500
LCONSL = 3
CALL DRIVER (MAX, LCONSL)
CALL EXIT
END
The variable MAX represents the length of XL array, the contents of which are
described below. This variable should be assigned the value of the dimension of
XL in the unlabeled COMMON. Much larger problems may be solved with the
program by increasing this parameter to the memory limit of the computer being
used. The variable LCONSL (as in the TRUSS program) represents the logical unit
number for the console. Control is then transfered to subroutine DRIVER.
Mesh Generation
The same type of node generator discussed in Sec. 3-6 may be used in this program
except that the nodes no longer need to be equally spaced. This may be accomplished
with the help of two spacing factors j, and j, (FX and FY in the program). These
factors are used as described below. This same approach is used in the stress analysis
program described in Sec. 7-7. The reader who is familiar with the mesh generator
in the stress analysis program may wish to skip this section.
Consider the starting node NI and the final node NF shown in Figure 8-32(a).
Additional nodes can be generated between these two end nodes if a nonzero value
of NO is used. The nodes need not be equally spaced, however. Without loss of
generality, let us number the nodes I, 2, ... , n, as shown in Figure 8-32(b), and
refer to the x and y coordinate of node I by Xl' Y10 etc. Then the spacing factors
I, andf y may be defined by
*A two-dimensional thermal analysis program and a user's manual are included in the Instructor/
Solution's manual for this text.

458
STEADY -STATE THERMAL AND FLUID FLOW ANALYSIS
(a)
(b)
Figure 8-32
(a) Starting node Nl and ending node NF are used to generate additional
nodes. (b) Line along which n nodes are generated (not necessarily equally spaced).
I, = X3 -
Xz = X4 -
X3
xn - xn- I
(8-264)
Xz -
XI
X3 -
Xz
xn- !
-
xn-z
and
Iy = Y3 - Yz = Y4 -
Y3
= ... =
Yn - Yn- I
Yz - YI
Y3 - Yz
Y,,-I - Yn-Z
Concentrating on the X direction for now. we may write
X3 -
Xz = f,(xz -
XI)
X4 -
X3 = f,(X3 -
Xz) = f/(xz -
XI)
X" -
Xn-I = fixn- I - x,,-z) = j;'-z(xz -
XI)
Adding these results gives
Xn -
XI = [I + Ix + f/ + ... + fxn-Zj(xz -
XI)
from which it follows that
X"
-
XI
"
Z
1+2:f/
i= I
(8-265)
(8-2668)
(8-266b)
(8-266c)
(8-266d)
(8·267)
(8-268)
Since XI and Xnmay be input (as XI and XF. respectively), and since Ix may be
input (as FX), Xz can be found from Eq. (8-268). Note that n is the total number

THERMAL ANALYSIS PROGRAM
459
of nodes in the generation sequence (including NI and NF). Obviously X3 can be
computed from Eq. (8-266b) or
(8-269)
and so forth. It should also be obvious that in the y direction, the same results hold
except that each Xi is replaced by Yi and I. is replaced byIy • Note that ifIx (or Iy )
is greater than unity, then the nodes are spaced farther apart in moving from NI to
NF; ifI, (or1;,) is less than unity (but greater than zero), then the spacing between
two consecutive nodes decreases in moving from NI to NF.
Data Storage
The data for the nodal coordinates, elements, boundary condition flags, material
properties, boundary condition parameters, and so forth should be stored in the XL
array. In addition, the assemblage stiffness matrix (in column vector form), the
assemblage nodal force vector, and the diagonal pointer array (JDIAG from Sec.
6-8) should also be stored in the XL array. The partitions between each of these
sections should float and if fewer nodes are used, for example, more materials may
be present. The total number of storage locations required must not exceed MAX.
If it does, an error message should be displayed on the console and execution should
be terminated.
The numbering of the nodes is critical if the program does not renumber the
nodes to minimize the bandwidth of the assemblage stiffness matrix. However, the
program should store only the banded portion of this matrix, which reduces the
storage requirements drastically over that of storing the full matrix. Nodes on the
object being analyzed are always numbered consecutively, from I to the maximum
number of nodes. The bandwidth is minimized when the maximum difference
between any two nodes on each element is minimized. Figure 8-33 shows that this
is accomplished quite simply by numbering the nodes in the direction of fewer
nodes.
Note that in Fig. 8-33(a) the nodes are numbered in the direction of the smaller
number of nodes. In Fig. 8-33(b) the nodes are numbered to the right and in the
direction of the greater number of nodes. The storage requirements for the mesh
in the latter are higher than for the mesh in the former. In Fig. 8-33(c) the nodes
are numbered in an alternating sweeping fashion which more than doubles the
storage requirements over that required in Fig. 8-33(a). Finally, in Fig. 8-33(d) the
element on the lower left has nodes I, 2, and 21; the implication is that the stiffness
matrix is no longer banded which in tum means higher storage requirements and
increased execution times. Although the program need not store the zero terms in
the stiffness matrix outside the bandwidth, it should store everything within the
bandwidth.
Numbering the elements is not critical but some sort of regular numbering
scheme usually allows the use of the automatic element generation feature. Note

460
STEADY-STATE THERMAL AND FLUID FLOW ANALYSIS
(a)
18
19
20
(b)
21
20
19
(e)
6
--~----~----....
(d)
Figure 8·33
(a) Proper node numbering scheme; (b) less desirable node numbering scheme;
(c) nodes should never be numbered in an alternating sweeping fashion; and (d) worst node
numbering scheme (results in an unbanded stiffness matrix).
that in forming the elements shown in the lower right comer of Figure 8-33(a), the
quadrilateral formed by nodes 17,20,21, and 18 is divided into two triangles by
using the shorter diagonal (node 17 to node 21) as opposed to the longer diagonal
(node 18 to node 20). This is iIlustrated in Fig. 8-34. Regular triangles generaIly
give better results than obtuse or needle-shaped triangles.
Variable Property Routine: SUBROUTINE VPROP
It is relatively easy to provide the capability to handle both spacially dependent
and temperature-dependent properties. For example, the thermal conductivity, heat
transfer coefficients, etc. may be functions of either the global coordinates x and
y or the temperature T. If any of the properties is a function of temperature, the
problem becomes nonlinear and the direct iteration method from Sec. 8-2 is used
to obtain the solution of the nodal temperatures.
The method that may be used to accomplish this is now described. If any of
the material or boundary condition properties is a function of x, y, and/or T, then
the user should simply enter a unique negative integer from - I to - 10 instead
of an actual value for the property. In the discussion below, these unique negative
integers are referred to as the variable-property indicators. For these properties,
the program should be designed to caIl SUBROUTINE VPROP, an abridged listing
of which is given below:
SUBROUTINE VPROP (PROP)

THERMAL ANALYSIS PROGRAM
461
18_--_
fI------_ 20
(a)
18~--_
17-------20
(b)
Figure 8-34
(a) Preferred way of dividing a quadrilateral into two triangles and (b) less
desirable way of forming two triangles.
COMMON
/VPHELP/
X, Y, T
COMMON
/CONST
/
PI, SIGMA, C (30)
IPROP = lABS (PROP)
GO TO (1, 2, 3, L;, 5, 6, 7, 8, 9, 10), I PROP
1
PROP
=
definition of first variable property (may be a function of
X, Y, and/or T)
RETURN
2
PROP = definition of second variable property
RETURN
10
PROP = definition of tenth variable property
RETURN
END
The reader may want to examine SUBROUTINE PROPTY in Problem 4-78
in order to see how this may be implemented. The basic idea is that if a negative
value is read for a property, the program (SUBROUTINE PROPTY in particular)
should call SUBROUTINE VPROP when that property is needed and transfers
control to the statement whose label is equal to the absolute value of the variable-
property indicator. Note that a computed GO TO statement is used. Also note that
the user may define up to 30 constants [CO), C(2), ... , C(30») that may be used
in the SUBROUTINE VPROP. These constants should be read by the program in
the first input section. For example, let us say that the thermal conductivity is
known to vary quadratically with temperature as
k = 32 + lOT - 0.5T2
The user simply needs to decide which variable-property indicator he or she would

462
STEADY-STATE THERMAL AND FLUID FLOW ANALYSIS
like to use subject to the conditions that it be a unique negative integer between
- I and - 10. A unique integer is one that is not used to represent any other variable
property. For example, let us say that variable-property indicator 3 is not being
used for any other property. In the input file, the user simply enters" - 3" for the
thermal conductivities of the materials for which the above equation applies. SUB-
ROUTINE VPROP is modified such that the statement with the label of 3 reads:
The constants C(I), C(2), and C(3) are three user-defined constants described above.
It should be clear that C(I) = 32., C(2) = 10., and CO) = -0.5. Recall that
these constants should be read in Input Section I. Note the use of T*T in the above
expression instead of T**2, since the former executes faster than the latter.
With respect to the material property data, the reader may note that two thermal
conductivities could be input for each material. These are interpreted to be the
principal values of thermal conductivity in the local x and local y directions, re-
spectively (i.e., the x/ and y' directions) and allows for the possibility of anisotropic
materials. Recall that anisotropic materials are materials that exhibit a direction
sensitivity as shown in Fig. 8-35(a). Note that 6 is the angle that the x' axis makes
with the global x axis (6 is also the angle between the y' axis and the global y axis).
y
y
x
x
(al
(b)
Figure 8-35
Heat conduction in anisotropic materials. (a) The principal values of thermal
conductivity occur in the x/ and y' directions. (b) The orientation of the local .r'y' coordinate
system may change from point to point.

REMARKS
463
The thermal conductivities in the x' and y' directions may be denoted as TKX and
TKY, respectively, in the program, and the angle 0 by THETA. Note that materials
such as the one depicted in Fig. 8-35(b) may be modeled with the program by
defining THETA as a function of x and y (with the variable-property routine). The
reader should review Problems 8-115 to 8-117 for more information on how ani-
sotropic materials are handled with the finite element method.
Point Heat Sources
Point heat sources may be implemented in the program by specifying the value of
the heat source (in units of energy per unit time and unit thickness) and the x and
y coordinates of the location of the source. Any number of points sources should
bepresent (including more than one source in an element) up to the memory limits
of the computer. In the program, the element in which each source is located may
be determined by checking the values of the shape functions at the location of the
source. If each shape function has a value between zero and unity, then the element
in which the source is located has been found. Four storage locations should be
reserved in the XL array for each point source. The following information should
be stored in these locations: the value of the source, the x coordinate, the y coor-
dinate, and a flag. The flag should be equal to zero before the element is found
and is equal to the element number after the proper element is found (i.e., the
element that contains the source). In this way, some execution time will be saved
since it is not necessary to check the locations of a source if the element in which
it occurs is known. Also, this technique ensures that a source which may be on the
boundary between two elements is added into the assemblage nodal force vector
only once. The reader should be convinced that this approach will also yield correct
results if the source happens to be at the same location as a node.
8-15
REMARKS
This chapter illustrates how the finite element method is used in steady-state thermal
and fluid flow analyses. In particular, the finite element formulations of steady-
state heat conduction problems in one-, two-, and three-dimensions were developed
in detail. Also included was axisymmetric heat conduction. The full complement
of thermal loads and boundary conditions were considered, including simple
radiation to or from a large enclosure in several of the models. The extension to
internodal radiation (or interelement radiation in the case of FEM) is beyond the
scope of this book. Finite element formulations for steady-state, two-dimensional,
incompressible potential flow were also provided. Both the velocity potential and
stream function formulations were presented. Viscous effects are insignificant under
the assumption of potential flow.
Various types of problems involving the flow of viscous fluids were also
considered. The first type was a problem in which the energy equation including
the convective energy transport term provided the governing equation. In this case

464
STEADY-STATE THERMAL AND FLUID FLOW ANALYSIS
the velocity profile was assumed to be given, and the main purpose of the analysis
was to compute the temperature distribution in the flow field. The Galerkin method
was seen to provide a relatively straightforward analysis, whereas the variational
method simply could not be used (why not?). An unsymmetric stiffness matrix was
seen to arise for the first time, because of the convective energy term in the governing
differential equation. It was mentioned that the numerical solution may be iII-
behaved unless relatively small elements (or higher-order elements) are used.
The finite element formulation was provided for the velocity and pressure
distribution in a viscous fluid flowing in a two-dimensional region under steady-
state conditions. The formulation was based on the Galerkin method. At first glance,
the assemblage step appeared to be different from what we have seen so far.
However, a closer examination revealed that the same type of assemblage procedure
was used in two- and three-dimensional stress analyses in Chapter 7. Again un-
symmetrical stiffness matrices arose, and again it may be necessary to use many
relatively small elements (or higher-order elements) to obtain convergence. The
convective acceleration terms in the Navier-Stokes equation make the formulation
nonlinear. The direct iteration method from Sec. 8-2 may be used to obtain the
solution for the nodal velocities and pressures. Only the formulation with the so-
called primitive variables was provided in the formal development. Alternate for-
mulations such as the stream function and vorticity formulations exist, but were
not presented in detail here.
The two-dimensional, steady-state thermal analysis program was described.
The program is capable of handling variable properties and allows graded meshes.
Although substructuring was introduced in Chapter 7 with an application to
structural and/or stress analysis, it may also be applied to nonstructural problems.
It should be recalled that substructuring makes the use of large finite element models
quite practical. In fact, significant problems may be solved on microcomputers if
substructuring is used. The reader should make an attempt to adapt the material in
Sec. 7-6 to the analysis of two-dimensional, steady-state heat conduction with the
finite element method.
REFERENCES
I. Arpaci, V. S., Conduction Heat Transfer, Addison-Wesley, Reading, Mass., 1966,
p.32.
2. Huebner, K. H., The Finite Element Methodfor Engineers, Wiley, New York, 1975,
pp. 218-219.
3. Wilson, E. L., "Structural Analysis of Axisymmetric Solids," AIM Journal, vol. 3.,
no. 12, pp. 2267-2274, December 1965.
4. Roberson, J. A., and C. T. Crowe, Engineering Fluid Mechanics, 2nd ed., Houghton
Mifflin, New Jersey, 1980, pp. 437-449.
S. Shames, I. H., Mechanics of Fluids, McGraw-Hill, New York, 1962, pp. 173-185.

REFERENCES
465
6. Currie, 1. G., Fundamental Mechanics of Fluids, McGraw-Hill, New York, 1974, pp.
65-142.
7. Rohsenow, W. M., and J. P. Hartnett, eds., Handbook of Heat Transfer, McGraw-
Hill, New York, 1973.
8. Zienkiewicz, O. c., The Finite Element Method, McGraw-Hill (UK), London, 1977,
pp.746-747.
9. Leonard, B. P., "A Survey of Finite Differences of Opinion on Numerical Muddling
of the Incomprehensible Defective Confusion Equation," Proc. ASME, AMD-vol. 34,
pp. 1-18, New York, December 2-7, 1979.
10. Gresho, P., and R. L. Lee, "Don't Suppress the Wiggles-They're Telling You Some-
thing," Proc. ASME, AMD-vol. 34, pp. 37-62, December 2-7,1979.
11. Srivastava, A. K., "A Finite Element Method to Solve the Graetz Problem Using
Subparametric Elements," M.S. Thesis, Florida Institute of Technology, Melbourne,
Fla.• July 1982.
12. Kundu, D., and F. L. Stasa, "Finite Element Solution to the Graetz Problem and Its
Extensions." International Congress on Technology and Technology Exchange, Pitts-
burgh, May 3-6, 1982.
13. Hughes, T. J. R., ed., Finite Elements Methodsfor Convection Dominated Flows, Proc.
of the ASME, AMD-vol. 34, December 2-7,1979.
14. Chung, T. J., Finite Element Analysis in Fluid Dynamics, McGraw-Hill, New York,
1975.
15. Baker, A. J., Finite Element Computational Fluid Mechanics, McGraw-Hill, New York,
1983, pp. 233-305.
16. Huebner, K. H., The Finite Element Method for Engineers, Wiley, New York, 1975,
pp. 346-361.
PROBLEMS
Note: The properties in Appendix A should be used unless indicated otherwise.
8-1
Use the direct iteration method to obtain a solution to the following nonlinear
algebraic equation:
Xl
-
3x2 + 6x - 4 = 0
Stop the solution process when three significant digits of accuracy are obtained.
Use an initial guess of
a. x = 0
b. x = 10
c. x =
- 5
8-2
Use the direct iteration method to obtain a solution to the following nonlinear
algebraic equation:
x4 -
5xJ + IOx2 + 4x -
24 = 0
Terminate the solution process when three significantdigits of accuracy are obtained.
Use an initial guess of
a. x = 0
b. x = 10
c. c =
- I

466
STEADY-STATE THERMAL AND FLUID FLOW ANALYSIS
8·3
Use the direct iteration method to obtain a solution to the following nonlinear
transcendental equation:
6x cos 1TX =
I
Use an initial guess of x = 0 and stop the iterations when an accuracy of three
significant digits is obtained. It may be verified by direct substitution that x =
'/,
is also a solution of this equation. What happens if the direct iteration method is
used for initial guesses of x = 0.33 and x = 0.34? What can be concluded from
this?
8·4
Use the direct iteration method to obtain a solution to the following system of
algebraic equations:
x 2 + xy2 + 3x -
15 = 0
3x+xy-7=0
Assume an initial guess of x
=
3 and y =
3, and stop the iterations when an
accuracy of three significant digits is obtained.
8·5
Use the direct iteration method to obtain a solution to the following system of
algebraic equations:
y2 + 5x + x 2 = 25
x2y
= 10
Assume an initial guess of x = I and y = 2, and terminate the iterations when an
accuracy of three significant digits is obtained.
8-6
With the help of the infinitesimal element of length dx shown in Fig. P8-6, derive
Eq. (8-3). Proceed by performing an energy balance on the infinitesimal element.
Assume that the heat flow from conduction in the x direction varies according to a
first-order Taylor expansion as shown in the figure. Use Fourier's law of heat
conduction (a constitutive relationship) to eliminate the heat flux qx. Clearly state
all assumptions.
hP(T - T.) dx
+x
Figure P8·6
wP(T4 - r;) dx
QAdx

PROBLEMS
467
8-7
Show that the variational principle that corresponds to Eq. (8-3) is given by
I = J:! [QAT -
Y2hPT2 + hPTaT -
YSErIPTs
+ ErIPT:T _ Y2kA (:)2] dx
providing that only geometric or natural boundary conditions are allowed. Note that
the one-dimensional body is assumed to have length Lf .
8-8
Determine the more general form of the variational principle in Problem 8-7 for the
case of convection, radiation, and imposed heat fluxes on the boundaries as shown
in Fig. 8-3.
8-9
Show that the element stiffness or conduction matrix, given by Eq. (8-20b), evaluates
to
hPL [2 I]
K~v=6
I
2
if the lineal element from Sec. 6-3 is used. Note that L is the element length. Clearly
state all assumptions made in arriving at this result.
8-10
Show that the element stiffness or conduction matrix from boundary radiation, given
by Eq. (8-20e), evaluates to
K'
= [fjITAiT[
0]
,8
0
fFAjTJ
Use the lineal element from Sec. 6-3. Explain how this result should be used.
8-11
Show that the element nodal force vector from lateral radiation, given by Eq.
(8-2Ib), evaluates to
f' = errPLT: [I]
,
2
I
where L is the element length. Assume the lineal element from Sec. 6-3. Clearly
state all assumptions made in arriving at this result.
8-12
Show that the element nodal force vector from the internal heat source, given by
Eq. (8-2Ic), evaluates to
fe = QAL [I]
Q
2
I
where L is the element length. Assume the lineal element from Sec. 6-3. Clearly
state all assumptions made in arriving at this result. Does the result seem to be
intuitively correct? Please explain.
8·13
Show that the element nodal force vector from boundary radiation, given by Eq.
(8-2Ie), evaluates to

468
STEADY-STATE THERMAL AND FLUID FLOW ANALYSIS
Assume the lineal element from Sec. 6-3. Clearly explain how this result should
be used.
8-14
Show that the element nodal force vector from the imposed boundary heat fluxes,
given by Eq. (8-210, evaluates to
f:B = [:~~J
Assume the lineal element from Sec. 6-3. Clearly explain how this result should
be used. Note that the heat fluxes qi and qj are positive if directed toward the body.
8-15
Show that Eq. (8-31) holds if the element stiffness matrix from lateral convection
[see Eq. (8-20b)] from a one-dimensional body is evaluated under the assumption
that the perimeter P varies linearly from node i to node j over the element. Assume
the lineal element from Sec. 6-3 and state all assumptions.
8-16
Consider the circular pin fin shown in Fig. P8-16. The fin is made of aluminum
and has a length Lf and diameter D. The base is held a fixed temperature Tb and
the tip undergoes convection. The lateral and boundary heat transfer coefficients
are equal and denoted as h. The entire fin is exposed to a fluid at temperature To
(including the tip). Discretize the fin into two equal-length elements (i.e., with three
nodes). If h =
2500 W/m2-oC, Lf =
5 ern, D =
I ern, Tb =
75°C, and To =
15°C, neglect radiation and determine:
h, T.
h, T.
I--+-----L,-----.....
Figure PS-16
a.
The temperatures at the nodal points
b. The heat removal rate from the fin (using the integration method from Sec.
4-10)
c.
The fin efficiency (see Sec. 4-10)
8-17
Consider the circular pin fin shown in Fig. P8-16. The fin is made of aluminum
and has a length Lf and diameter D. The base is held a fixed temperature Tb and
the tip undergoes convection. The lateral and boundary heat transfer coefficients
are equal and denoted as h. The entire fin is exposed to a fluid at temperature To
(including the tip). Discretize the fin into two equal-length elements (i.e., with three
nodes). If h =
100 Btuihr-ft2_oF, Lf = 3 in., D = 0.5 in., Tb =
150°F, and To
= 50°F, neglect radiation and determine:
a.
The temperatures at the nodal points

PROBLEMS
469
b. The heat removal rate from the fin (using the integration method from Sec.
4-10)
c. The fin efficiency (see Sec. 4-10)
8-18
Consider the square pin fin of length Lf shown in Fig. P8-18. The fin is made of
copper and has a cross-sectional area A. The base of the fin is held at fixed tem-
perature Tb and the tip undergoes convection. The lateral and boundary heat transfer
coefficients are equal and denoted as h. The entire fin is exposed to a fluid at
temperature To(including the tip). Discretize the fin into two equal-length elements
(i.e., with three nodes). If h = 5000 Btulhr-ft2-OF, Lf = 1 in., A = 1.5 in.", Tb
= 185°F, and To = 70°F, neglect radiation and determine:
h. Ta
-qx
h, Ta
!---+----L,-----_+{ \
Figure P8-18
h, Ta
a. The temperature at each nodal point
b. The heat removal rate from the fin (see Sec. 4-10)
c. The fin efficiency (see Sec. 4-10)
8-19
Consider the square pin fin of length Lf shown in Fig. P8-18. The fin is made of
copper and has a cross-sectional area A. The base of the fin is held a fixed temperature
Tb and the tip undergoes convection. The lateral and boundary heat transfer coef-
ficients are equal and denoted as h. The entire fin is exposed to a fluid at temperature
To (including the tip), Discretize the fin into two equal-length elements (i.e., with
three nodes). If h = 10,000 W/m2_oC, Lf = 10 em, A = 9 crrr', Tb = 100°C, and
To = 30°C, neglect radiation and determine:
a. The temperature at each nodal point
b. The heat removal rate from the fin (see Sec. 4-10)
c. The fin efficiency (see Sec. 4-10)
8-20
Repeat part (a) of Problem 8-16 if a heat flux of 5 W/cm2 is imposed on the tip of
the fin (toward the fin), and
a. There is no convection from the tip of the fin.
b. There is simultaneous convection from the tip of the fin.
8-21
Repeat part (a) of Problem 8-17 if a heat flux of 500 Btu/hr-ft/ is imposed on the
tip of the fin (toward the fin), and
a. There is no convection from the tip of the fin.
b. There is simultaneous convection from the tip of the fin.

470
STEADY-STATE THERMAL AND FLUID FLOW ANALYSIS
8·22
Repeat part (a) of Problem 8-18 if a heat flux of -7000 Btu/hr-ft? is imposed on
the tip of the fin (away from the fin), and
a. There is no convection from the tip of the fin.
b. There is simultaneous convection from the tip of the fin.
8·23
Repeat part (a) of Problem 8-19 if a heat flux of - 1.0 W/cm2 is imposed on the
tip of the fin (away from the fin), and
a. There is no convection from the tip of the fin.
b. There is simultaneous convection from the tip of the fin.
8·24
Repeat part (a) of Problem 8-16 if a uniform heat source with a strength of 10
W/cm3 exists.
8·25
Repeat part (a) of Problem 8-17 if a uniform heat source with a strength of 120
Btu/hr-in." exists.
8·26
Repeat part (a) of Problem 8-18 if a uniform heat source with a strength of 780
Btu/hr-in.:' exists.
8·27
Repeat part (a) of Problem 8-19 if a uniform heat source with a strength of 0.2
W/cm3 exists.
8·28
Reconsider the one-dimensional heat conduction model developed in Sec. 8-3.
Assume that a lateral heat flux qlat is imposed (along the length of the one-dimen-
sional body) such that a fraction IX is absorbed on the surface of the body. Let us
denote the projected area that receives the heat flux as Ap • If the heat flux happens
to be from the sun. then the parameter IX is referred to as the solar absorptivity.
a. Derive the integral expression for the corresponding nodal force vector. Use the
Galerkin method. Note that Ap is then interpreted to be the projected area of the
element.
b. Evaluate the result for part (a) if the lineal element from Sec. 6-3 is used. Assume
that IX and qlat are constant over the element.
8·29
Consider the annular fin shown in Fig. P8-29. Using the general nomenclature from
Sec. 8-3 (k is the thermal conductivity, h is the convective heat transfer coefficient,
h. T.
h. T.
Figure Pa·29

PROBLEMS
471
etc.), derive the expressions for the element characteristics. Inparticular, determine
the expressions for the element stiffness matrices from conduction (in the radial
direction), lateral convection, and boundary convection. Inaddition, determine the
expressions for the element characteristics for the nodal force vectors from lateral
convection, boundary convection, and boundary heat flux. Do not perform the
integrations. Describe the type of element that would be appropriate here (a simple
drawing showing the nodes would suffice). Hint: The governing equation is given
in Problem 4-87 (the boundary conditions, however, are different in this problem).
8-30
Using the annular-shaped element shown in Fig. P8-30, evaluate the integrals that
result in Problem 8-29. Instead of performing exact integrations, evaluate the in-
tegrands at the element centroid and treat the integrands as though they were constant.
Explain how the results from the formulation in Sec. 8-3 could be used directly
without reformulating the problem as required in Problem 8-29. Hint: What is the
effective cross-sectional area for heat conduction? What is the effective perimeter?
~­
K-.J>t
Figure P8-30
8-31
The governing equation for one-dimensional heat conduction in a sphere with a
volumetric heat source is given by
~ ~ (kr2 dT) + Q
0
r2 dr
dr
where T is the temperature, r is the radial coordinate, k is the thermal conductivity,
and Q is the strength of the heat source. What are the units of Q? Derive the
expressions for the element characteristics for the case of a hollow sphere undergoing
convection with heat transfer coefficients hiand ho on the inside and outside surfaces
of the sphere, respectively, to fluids at temperatures T, and TO' Hint: When setting
up the integral for the Galerkin method, integrate the product of NT and the residual
with respect to the elemental volume 4'ITr 2 dr.
8-32
Explain how the one-dimensional heat conduction model developed in Sec. 8-3
could be used to solve for the temperature in the hollow sphere described in Problem
8-31. Be specific. Hint: What is the effective cross-sectional area for heat conduc-
tion? Is there any lateral convection?
8-33
Extend the program developed in Problem 4-78 (or the program furnished by the
instructor) so that it can handle convection and imposed heat fluxes on the boundary
of an arbitrary one-dimensional body as well as a uniform heat source. Boundary
condition flags should be used to indicate the type of boundary conditions that exist
on any given node (generally on the ends of the body). Positive integer flags should
be used to denote prescribed temperature conditions, whereas negative integer flags

472
STEADY-STATE THERMAL AND FLUID FLOW ANALYSIS
should be used to denote convection and/or imposed heat fluxes. More specifically,
three different input sections should be used in this regard as given below:
BOUNDARY CONDITION FLAG DATA
N
±IBC
(blank line)
CONVECTION AND OR HEAT FLUX DATA
IBC
QS
H
TA
(b lank line)
PRESCRIBED TEMPERATURE DATA
IBC
TEMP
(blank line)
where N is the node number that has a positive IBC flag if a prescribed temperature
is to be imposed, and a negative IBC flag if convection exists and/or a heat flux is
to be imposed. IBC is zero (by default) if neither condition exists at the node in
question. For each positive IBC used, a corresponding prescribed temperature (TEMP)
must be declared in the PRESCRIBED TEMPERATURE DATA input section. For
each negative IBC used, a corresponding set of imposed heat fluxes, convective
heat transfer coefficients, and ambient temperatures must be present (QS, H, and
TA, respectively). If only convection is present on a boundary, then the user simply
sets QS to zero in the corresponding input line. If only an imposed heat flux exists
on a boundary, then the user simply sets Hand TA to zero in a similar fashion.
Note that each of the input sections is terminated with a blank line. The program
should check if N is zero (i.e., if the line is blank). If N is zero, the next input
section should be read; otherwise, another set of data should be read in the same
input section. Let QVOL represent the heat source strength (per unit volume) and
include it in the material property data.
The variable property routine (SUBROUTINE VPROP) should be implemented
as described in Problem 4-78. This approach will allow the same program to be
used to solve a wide variety of one-dimensional, steady heat conduction problems.
8-34
Extend the program in Problem 8-33 (or one furnished by the instructor) to allow
for lateral and boundary radiation as formulated in Sec. 8-3. Extend the material
data to include the emissivity (ELAT) and receiver temperature (TRLAT) for the
lateral radiation. Allow for boundary radiation by using negative boundary condition
flags, and modify the next to the last input section (see Problem 8-33) to the
following:
IMPOSED HEAT FLUX, CONVECTION, AND/OR RADIATION DATA
IBC
QS
H
TA
E
TR
(blank line)
where E and TR are the boundary emissivity and receiver temperatures, respectively.
If radiation is not present on a boundary, then the user simply sets E and TR to
zero in the corresponding input line. Similar comments hold for the case of ELAT
and TRLAT.

PROBLEMS
473
8-35
Solve Problems 8-16, 8-20, and 8-24 with the computer program from Problem
8-33 (or with the program furnished by the instructor). For Problem 8-16, use two,
four, and eight elements to show the increased accuracy that results as the number
of elements (and nodes) is increased. For Problems 8-20 and 8-24, use only eight
elements.
8-36
Solve Problems 8-17, 8-21, and 8-25 with the computer program from Problem
8-33 (or with the program furnished by the instructor). For Problem 8-17, use two,
four, and eight elements to show the increased accuracy that results as the number
of clements (and nodes) is increased. For Problems 8-21 and 8-25, use only eight
elements.
8-37
Solve Problems 8-18, 8-22, and 8-26 with the computer program from Problem
8-33 (or with the program furnished by the instructor). For Problem 8-18, use two,
four, and eight elements to show the increased accuracy that results as the number
of elements (and nodes) is increased. For Problems 8-22 and 8-26, use only eight
elements.
8-38
Solve Problems 8-19, 8-23, and 8-27 with the computer program from Problem
8-33 (or with the program furnished by the instructor). For Problem 8-19, use two,
four, and eight elements to show the increased accuracy that results as the number
of elements (and nodes) is increased. For Problems 8-23 and 8-27, use only eight
elements.
8-39
Use the two-dimensional form of the Green-Gauss theorem [Eqs. (8-42)] to rewrite
the integrals below as a sum of two other integrals: one integral around the boundary
of the two-dimensional region and the other integral over the area of the region.
a. L~~(kt::) dx dy
b. i ~ ~ (ktaT) dx dy
A
ay
ay
8-40
Use the three-dimensional form of the Green-Gauss theorem [Eqs. (8-41)] to rewrite
the integrals below as a sum of two other integrals: one integral over the surface
of the three-dimensional region and the other integral over the volume of the region.
a. ( ~ ~ (k aT) dx dy dz
Jv
ax
ax
b.
( ~ ~ (k aT) dx dy dz
Jv
ay
ay
c. ( ~ ~ (k aT) dx dv dz
Jv
az
az
.
8-41
By performing an energy balance on the infinitesimal area element (of unit thickness)
shown in Fig. P8-41, and by invoking Fourier's law of heat conduction (a constitutive
relationship) to eliminate the heat fluxes from conduction tq, and q,,), derive Eq.
(8-43). Note that a heat source Q is present. Assume a uniform thickness.

474
STEADY·STATE THERMAL AND FLUID FLOW ANALYSIS
I--t-----dx------f
dy
Q(x.y)
yLx
Figure P8-41
8·42
Extend Eq. (8-48) to the three-dimensional case first by inspection and then by
formally extending the development in Sec. 8-5.
8·43
By performing an energy balance on the infinitesimal element of thickness t shown
in Fig. P8-43 , and by invoking Fourier's law of heat conduction (a constitutive
«.
t
y
I
L
qv t
x
Figure P8-43
E. T,
h. Ta
relationship) to eliminate the heat fluxes from conduction iq, and q,), derive Eq.
(8-91). Note that lateral convection and radiation are included, as well as a laterally
imposed heat flux. In addition, a heat source Q is also included.

PROBLEMS
475
8-44
Obtain the variational principle that corresponds to Eq. (8-9\) by using the approach
illustrated in Example 8-IO(a). Assume that either the boundary is insulated (i.e.,
the natural boundary condition) or a prescribed temperature is specified on the
boundary (the geometric boundary condition).
8-45
Obtain the variational principle that corresponds to Eq. (8-91) by using the approach
illustrated in Example 8-IO(b). Allow for the possibility of boundary convection,
radiation, and imposed heat fluxes.
8-46
Show that the element stiffness matrices from conduction in a two-dimensional body
are always symmetric [i.e., the element stiffness matrices given by Eqs. (8-106a)
and (8-106b)].
8·47
Show that the element stiffness matrices from lateral convection and radiation from
a two-dimensional body are always symmetric [i.e., the element stiffness matrices
given by Eqs. (8-106c) and (8-106d)].
8-48
Show that the element stiffness matrices from boundary convection and radiation
from a two-dimensional body are always symmetric [i.e., the element stiffness
matrices given by Eqs. (8-106e) and (8-106f)].
8-49
Show that the element stiffness matrix from conduction in the y direction in a two-
dimensional body is given by Eq. (8-109) if the three-node triangular element is
used. Clearly state all assumptions made in arriving at this result.
8-50
Show that the element nodal force vector from lateral convection from a two-
dimensional body is given by Eq. (8-115) if the three-node triangular element is
used. Clearly state all assumptions made in arriving at this result.
8-51
Show that the element nodal force vector from lateral radiation from a two-dimen-
sional body is given by Eq. (8-116) if the three-node triangular element is used.
Clearly state all assumptions made in arriving at this result.
8-52
Show that the element nodal force vector from a laterally imposed heat flux on a
two-dimensional body is given by Eq. (8-117) if the three-node triangular element
is used. Clearly state all assumptions made in arriving at this result.
8-53
Show that the element nodal force vector from an internal heat source in a two-
dimensional body is given by Eq. (8-118) if the three-node triangular element is
used and if the heat source is uniformly distributed over the element.
8-54
Show that the element nodal force vector from boundary convection from a two-
dimensional body is given by Eq. (8-12\) if the three-node triangular element is
used and if the convection occurs on leg ij. What is the form of this result if legs
jk and ki happen to be on the global boundary?
8-55
Show that the element nodal force vector from boundary radiation from a two-
dimensional body is given by Eq. (8-122) if the three-node triangular element is
used and if the radiation occurs on leg ij. What is the form of this result if legs jk
and ki happen to be on the global boundary?
8-56
Show that the element nodal force vector from an imposed heat flux on the boundary
of a two-dimensional body is given by Eq. (8-123) if the three-node triangular

476
STEADY-STATE THERMAL AND FLUID FLOW ANALYSIS
element is used and if the heat flux is imposed on leg ij. What is the form of this
result if legs jk and ki happen to be on the global boundary?
8-57
The expressions for the element stiffness matrices from conduction in a two-
dimensional body are given by Eqs. (8-I06a) and (8-I06b). Since these results hold
for any two-dimensional element, let us evaluate these stiffness matrices for the
four-node rectangular element presented in Sec. 6-4 by proceeding as follows:
a. With the help of Eqs. (6-32), show that
aN
I aN
ax
a ar
aN
I aN
ay
b as
where rand s are the serendipity coordinates.
b. Using the results from part (a), rewrite the integrals in terms of derivatives of
the shape functions with respect to the serendipity coordinates rand s. Do not
forget to change the limits on the integrations. Also note that dx dy = ab dr ds.
c. Evaluate the resulting integrands at the element centroid (i.e., at r = 0 and
s = 0). Then treat the integrands as though they are constants and pull them
through the integral. Evaluate the remaining trivial integrals. Show that the result
for the element stiffness from conduction in the x direction is given by
Kt
= ktb [
:
u
4a
-I
-I
I
I
-I
-I
-I
-I
1
I -I]
-I
I
I
State the assumptions made in arriving at this result.
d. Derive the corresponding result for K;y? What assumptions are made?
8·58
Evaluate the element stiffness matrix from lateral convection from a two-dimensional
body [i.e., Eq. (8-106c)) if the four-node rectangular element from Sec. 6-4 is used.
Evaluate the integrals by first evaluating the integrands at the element centroid (i.e.,
at r = 0 and s = 0) and then treating the integrands as though they were constants.
8-59
Evaluate the element stiffness matrix from boundary convection from a two-
dimensional body [i.e., Eq. (8-106e)] if the four-node rectangular element from
Sec. 6-4 is used and if face ij happens to be on the global boundary. Evaluate the
integrals by first evaluating the integrands at the centroid of face ij (i.e., at r = + 1
and s = 0) and then treating the integrands as though they were constants.
8-60
Evaluate the element stiffness matrix from boundary convection from a two-di-
mensional body [i.e., Eq. (8-106e)] if the four-node rectangular element from Sec.
6-4 is used and iffacejk happens to be on the global boundary. Evaluate the integrals
by first evaluating the integrands at the centroid of face jk (i.e., at r = 0 and
s = + I) and then treating the integrands as though they were constants.
8-61
Evaluate the element nodal force vector from lateral convection from a two-dimen-
sional body [i.e., Eq. (8-107a)] if the four-node rectangular element from Sec.
6-4 is used. Evaluate the integrals by first evaluating the integrands at the element

PROBLEMS
477
centroid (i.e., at r = 0 and s = 0) and then treating the integrands as though they
were constants.
8-62
Evaluate the element nodal force vector from lateral radiation from a two-dimen-
sional body [i.e., Eq. (8-107b)] if the four-node rectangular element from Sec.
6-4 is used. Evaluate the integrals by first evaluating the integrands at the element
centroid (i.e., at r = 0 and s = 0) and then treating the integrands as though they
were constants.
8-63
Evaluate the element nodal force vector from a laterally imposed heat flux on a
two-dimensional body [i.e., Eq. (8-107c)] if the four-node rectangular element from
Sec. 6-4 is used. Evaluate the integrals by first evaluating the integrands at the
element centroid (i.e., at r = 0 and s = 0) and then treating the integrands as
though they were constants.
8-64
Evaluate the element nodal force vector from an internal heat source in a two-
dimensional body [i.e., Eq. (8-107d)] if the four-node rectangular element from
Sec. 6-4 is used. Evaluate the integrals by first evaluating the integrands at the
element centroid (i.e., at r = 0 and s = 0) and then treating the integrands as
though they were constants.
8-65
Evaluate the element nodal force vector from boundary convection from a two-
dimensional body [i.e., Eq. (8-107e)] if the four-node rectangular element from
Sec. 6-4 is used and if face ij happens to be on the global boundary. Evaluate the
integrals by first evaluating the integrands at the centroid of face ij (i.e., at r = + I
and s = 0) and then treating the integrands as though they were constants.
8-66
Evaluate the element nodal force vector from boundary convection from a two-
dimensional body [i.e., Eq. (8-107e)] if the four-node rectangular element from
Sec. 6-4 is used and if face jk happens to be on the global boundary. Evaluate the
integrals by first evaluating the integrands at the centroid of face jk (i.e., at r = 0
and s = + I) and then treating the integrands as though they were constants.
8-67
Evaluate the element nodal force vector from boundary radiation from a two-
dimensional body [i.e., Eq. (8-107f)] if the four-node rectangular element from
Sec. 6-4 is used and if face km happens to be on the global boundary. Evaluate the
integrals by first evaluating the integrands at the centroid offace km (i.e., at r =
- I
and s = 0) and then treating the integrands as though they were constants.
8-68
Evaluate the element nodal force vector from a boundary heat flux imposed on a
two-dimensional body [i.e., Eq. (8-107g)] if the four-node rectangular element from
Sec. 6-4 is used and if face mi happens to be on the global boundary. Evaluate the
integrals by first evaluating the integrands at the centroid of face mi (i.e., at r = 0
and s =
- I) and then treating the integrands as though they were constants.
8-69
The element resultants (i.e., the heat fluxes from conduction in thex and Ydirections)
are given by Eqs. (8-125) for the three-node triangular element. Derive the corre-
sponding expressions for the average heat fluxes if the four-node rectangular element
is used. Assume that the heat fluxes at the element centroid represent the average
heat fluxes in the element. Explain why these results seem to be intuitively correct.
8-70
Consider the triangular element shown in Fig. P8-70. The plate from which the
element is extracted is made of cast iron and has a thickness of 0.5 in. The nodal
coordinates are r, = 2.0,Yj = 1.5,xJ = 1.7'Yj = 3.0,Xk = 0.6,andYk = 1.8 in.

478
STEADY-STATE THERMAL AND FLUID FLOW ANALYSIS
~ _---1'------41
CD
Figure P8-70
a. Determine the element stiffness matrices from conduction in the x and Y direc-
tions.
b. Determine the element stiffness matrix from lateral convection if the element
convects from both faces to a fluid at 35°F through a convective heat transfer
coefficient of 25 Btu/hr-ft2•of.
c. Determine the element stiffness matrix from boundary convection if leg ij happens
to be on the part of the global boundary that undergoes convection to a fluid at
40°F through a convective heat transfer coefficient of 50 Btulhr-ft 2-OF.
8-71
For the element in Problem 8-70, determine the nodal force vectors
a. From lateral convection
b. From a laterally imposed heat flux of 200 Btu/hr-ft? on each face of the plate
c. From an internal heat source of 350 Btu/hr-fr'
d. From boundary convection
e. From a boundary heat flux of 425 Btu/hr-ft? imposed on leg ij (which is on the
part of the global boundary also undergoing convection)
8-72
Consider the triangular element shown in Fig. P8-72. The plate from which the
element is extracted is made of brass and has a thickness of I cm. The nodal
coordinates are Xi = 5, Yi = 6, Xj = 4, Yj = 4, Xk = 6, and Yk = 4 cm.
h, T.
i_--i-----...
CD
Figure P8-72
Q

PROBLEMS
479
a. Determine the element stiffness matrices from conduction in the x and Y direc-
tions.
b. Determine the element stiffness matrix from lateral convection if the element
convects from both faces to a fluid at 20°C through a convective heat transfer
coefficient of 125 WIcm 2-"C.
c. Determine the element stiffness matrix from boundary convection if leg ki hap-
pens to be on the part of the global boundary that undergoes convection to a
fluid at 25°C through a convective heat transfer coefficient of 250 W/cm2-"C.
8-73
For the element in Problem 8-72, determine the nodal force vectors
a. From lateral convection
b. From a laterally imposed heat flux of 300 W/cm2 on each face of the plate
c. From an internal heat source of 160W/cmJ
d. From boundary convection
e. From a boundary heat flux of 235 W/cm2 imposed on leg ki (which is on the
part of the global boundary also undergoing convection)
8-74
Consider the triangular element shown in Fig. P8-74. The element is extracted from
a thin plate of thickness 0.5 em. The material is hot rolled, low carbon steel. The
nodal coordinates are r, = O'Yi = O,x} = O,Y} = -l,xk = 2, andy, = -I em.
Q
i----+-----,r---...::>e k
o
@
Figure P8-74
a. Determine the element stiffness matrices from conduction in the x and Y direc-
tions.
b. Determine the element stiffness matrix from lateral convection if the element
convects from both faces to a fluid at 40°C through convective heat transfer
coefficients of 250 and 300 W/cm2_
0C.
c. Determine the element stiffness matrix from boundary convection if leg jk hap-
pens to be on the part of the global boundary that undergoes convection to a
fluid at 45°C through a convective heat transfer coefficient of 35 W/cm2-
0C.
8-75
For the element in Problem 8-74, determine the nodal force vectors
a. From lateral convection
b. From a laterally imposed heat flux of 225 W/cm2 on one face of the plate
c. From an internal heat source of 10 W/crn'
d. From boundary convection

480
STEADY-STATE THERMAL AND FLUID FLOW ANALYSIS
e. From a boundary heat flux of 35 W/cm 2 imposed on legjk (which is on the part
of the global boundary also undergoing convection)
8·76
Consider the triangular element shown in Fig. P8-76. The element is extracted from
a thin plate of thickness 0.75 in. The material is pure copper. The nodal coordinates
are Xi = 0, Yi = 0, Xj = I, Yj = 2, Xk = - I, and Yk = 2 in.
Q
_---+---__i ®
h, T.
Figure P8·76
a. Determine the element stiffness matrices from conduction in the x and Y direc-
tions.
b. Determine the element stiffness matrix from lateral convection if the element
convects from both faces to a fluid at 50°F through a convective heat transfer
coefficient of 135 Bru'hr-ft"-OF.
c. Determine the element stiffness matrix from boundary convection if leg ki hap-
pens to be on the part of the global boundary that undergoes convection to a
fluid at 40°F through a convective heat transfer coefficient of 50 Btu/hr-ft2-of.
8·77
For the element in Problem 8-76, determine the nodal force vectors
a. From lateral convection
b. From a laterally imposed heat flux of 150 Btu/hr-ft" on each face of the plate
c. From an internal heat source of 215 Btu/hr-ft'
d. From boundary convection
e. From a boundary heat flux of 450 Btu/hr-ft? imposed on leg ki (which is on the
part of the global boundary also undergoing convection)
8·78
Consider the rectangular element shown in Fig. P8-78. The element is extracted
from an aluminum plate with a thickness of 1.25 em. The coordinates of the nodes
q,s
l
hs , r..
@k
i@
Q
q,
m
i
@
h, T.
@
Figure P8·78

PROBLEMS
481
are Xi = 4, Yi = 2, x} = 4, Y} = 3, Xk = 2, Yk = 3, xm = 2, and Ym = 2 cm
Perform the necessary integrations by following the approaches mentioned in Prob-
lems 8-57 to 8-60, and
a. Determine the element stiffness matrices from conduction in the x and Y direc-
tions.
b. Determine the element stiffness matrix from lateral convection if the element
convects from both faces to a fluid at 15°C through convective heat transfer
coefficients of 10 and 12 W/cm 2_
0C.
c. Determine the element stiffness matrix from boundary convection if face jk
happens to be on the part of the global boundary that undergoes convection to
a fluid at 20°C through a convective heat transfer coefficient of 35 W/cm 2_oC.
8-79
Consider the element in Problem 8-78. Perform the necessary integrations by fol-
lowing the approaches indicated in Problems 8-61 to 8-68, and determine the nodal
force vectors
a. From lateral convection
b. From a laterally imposed heat flux of 125 W/cm 2 on each face of the plate
c. From an internal heat source of 15 W/cm 3
d. From boundary convection
e. From a boundary heat flux of 350 W/cm 2 imposed on face jk (which is on the
part of the global boundary also undergoing convection)
8-80
Consider the rectangular element shown in Fig. P8-80. The element is extracted
from a brass plate with a thickness of 0.375 in. The coordinates of the nodes are
Xi = 5'Yi = 2,x} = 5,y} = 4,Xk = 2'Yk = 4,xm = 2,andYm = 2 in. Perform
the necessary integrations by following the approaches mentioned in Problems
8-57 to 8-60, and
@
Q
@
k
i
qs8~
hB• TaB
ha• TaB m
i
0
«.
@
Figure P8-80
a. Determine the element stiffness matrices from conduction in the x and Y direc-
tions.
b. Determine the element stiffness matrix from lateral convection if the element
convects from both faces to a fluid at 6Q°F through a convective heat transfer
coefficient of 235 Btu/hr-ft"OF.
c. Determine the element stiffness matrix from boundary convection if face Ian
happens to be on the part of the global boundary that undergoes convection to
a fluid at 60°F through a convective heat transfer coefficient of 150 Btu/hr-fr<
OF.

482
STEADY·STATE THERMAL AND FLUID FLOW ANALYSIS
8-81
Consider the element in Problem 8-80. Perform the necessary integrations by fol-
lowing the approaches indicated in Problems 8-61 to 8-68, and determine the nodal
force vectors
a. From lateral convection
b. From laterally imposed heat fluxes of 350 and 400 Btu/hr-ft? on each face of
the plate
c. From an internal heat source of 100 Btu/hr-ft!
d. From boundary convection
e. From a boundary heat flux of 340 Btu/hr-ft! imposed on face km (which is on
the part of the global boundary also undergoing convection)
8-82
For the element in Problem 8-70, determine the element nodal force vector from a
point heat source with a strength of 100 Btu/hr-in. (of thickness) if the source is
located at Xo = 1.5 and Yo = 2.0 in.
8·83
For the element in Problem 8-72, determine the element nodal force vector from a
point heat source with a strength of 120 W/cm (of thickness) if the source is located
at Xo = 5 and Yo = 5 em.
8·84
For the element in Problem 8-74, determine the element nodal force vector from a
point heat source with a strength of 150 W/cm (of thickness) if the source is located
at Xo = 2 and Yo = - I em.
8-85
For the element in Problem 8-76, determine the element nodal force vector from a
point heat source with a strength of 230 Btu/hr-in. (of thickness) if the source is
located at Xo = I and Yo = 2 in.
8-86
For the element in Problem 8-78, determine the element nodal force vector from a
point heat source with a strength of 35 W/cm (of thickness) if the source is located
at Xo = 3.2 and Yo = 2.7 em:
8-87
For the element in Problem 8-78, determine the element nodal force vector from a
point heat source with a strength of 45 W/cm (of thickness) if the source is located
at Xo = 4 and Yo = 2 em.
8-88
For the element in Problem 8-80, determine the element nodal force vector from a
point heat source with a strength of 50 Btu/hr-in. (of thickness) if the source is
located at Xo = 4 and Yo = 3 in.
8-89
For the element in Problem 8-80, determine the element nodal force vector from a
point heat source with a strength of 60 Btu/hr-in. (of thickness) if the source is
located at Xo = 2, and Yo = 4 in.
8-90
Consider the mesh shown in Fig. P8-90. The elements are defined in terms of the
global node numbers as indicated in the figure. The 3 x 3 composite element
stiffness matrix for element I, for example, may be denoted symbolically as
Note that the superscript (in parentheses) denotes the element number and the
subscripts are determined by the global node numbers associated with the element

PROBLEMS
483
CD
IT]
Element
Nodes
number
j
k
1
4
1
2
2
1
4
3
0
CD~---------.
0------
Figure P8·90
(the order is significant). With the help of this symbolic notation, give the expression
for the assemblage stiffness matrix for the discretized two-dimensional region in
Fig. P8-90. What is the half-bandwidth? Can the half-bandwidth be reduced? If so,
explain how.
8-91
Consider the mesh shown in Fig. P8-90. The elements are defined in terms of the
global node numbers as indicated in the figure. The 3 x I composite element nodal
force vector for element I, for example, may be denoted symbolically as
Note that the superscript (in parentheses) denotes the element number and the
subscripts are determined by the global node numbers associated with the element
(the order is significant). With the help of this symbolic notation, give the expression
for the assemblage nodal force vector for the discretized two-dimensional region in
Fig. P8-90.
8-92
Consider the mesh shown in Fig. P8-92. The elements are defined in terms of the
global node numbers as indicated in the figure. Using the symbolic notation from
Problem 8-90, give the expression for the assemblage stiffness matrix for the dis-
cretized two-dimensional region in Fig. P8-92. What is the half-bandwidth? Can
the half-bandwidth be reduced? If so, explain how.
CD
0
CD
Element
Nodes
number
i
k
CD
1
2
3
1
2
3
2
4
3
3
4
5
0
0
Figure P8-92
8-93
Using the symbolic notation from Problem 8-91, give the expression for the assem-
blage nodal force vector for the discretized two-dimensional region in Fig. P8-92.

484
STEADY-STATE THERMAL AND FLUID FLOW ANALYSIS
The elements are defined in terms of the global node numbers as indicated in the
figure.
8-94
Consider the mesh shown in Fig. P8-94. The elements are defined in terms of the
global node numbers as indicated in the figure. Using the symbolic notation from
Problem 8-90, give the expression for the assemblage stiffness matrix for the dis-
cretized two-dimensional region in Fig. P8-94. What is the half-bandwidth? Can
the half-bandwidth be reduced? If so, explain how.
CD
0
0
Element
Nodes
0)
number
j
k
CD
0
1
3
1
2
2
3
4
,
3
2
5
3
[2]
4
5
4
3
CD
CD
Figure P8-94
8-95
Using the symbolic notation from Problem 8-91, give the expression for the assem-
blage nodal force vector for the discretized two-dimensional region in Fig. P8-94.
The elements are defined in terms of the global node numbers as indicated in the
figure.
8·96
Consider the mesh shown in Fig. P8-96. The elements are defined in terms of the
global node numbers as indicated in the figure. By extending the symbolic notation
from Problem 8-90 to the case of the rectangular element, give the expression for
the assemblage stiffness matrix for the discretized two-dimensional region in Fig.
PS-96. What is the half-bandwidth? Can the half-bandwidth be reduced? If so,
explain how.
Element
Nodes
CD
0
number
i
j
k
m
1
3
4
2
1
2
5
6
4
3
Figure P8-96
8-97
By extending the symbolic notation from Problem 8-91, give the expression for the
assemblage nodal force vector for the discretized two-dimensional region in Fig.
P8-96. The elements are defined in terms of the global node numbers as indicated
in the figure.

PROBLEMS
48S
8-98
Consider the mesh shown in Fig. P8-98. The elements are defined in terms of the
global node numbers as indicated in the figure. By extending the symbolic notation
from Problem 8-90 to the case of the rectangular element, give the expression for
the assemblage stiffness matrix for the discretized two-dimensional region in Fig.
P8-98. What is the half-bandwidth? Can the half-bandwidth be reduced? If so,
explain how.
0
Element
Nodes
CD
number
j
k
m
1
5
4
3
2
2
6
5
2
1
~----""0
CD
CD
CD
IT]
CD
Figure P8-98
8-99
By extending the symbolic notation from Problem 8-91, give the expression for the
assemblage nodal force vector for the discretized two-dimensional region in Fig.
P8-98. The elements are defined in terms of the global node numbers as indicated
in the figure.
8-100
Consider the mesh shown in Fig. P8-100. The elements are defined in terms of the
global node numbers as indicated in the figure. By extending the symbolic notation
from Problem 8-90 to the case of the rectangular element, give the expression for
the assemblage stiffness matrix for the discretized two-dimensional region in Fig.
P8-100. Note the two different types of elements. What is the half-bandwidth? Can
the half-bandwidth be reduced? If so, explain how.
:1
0
0
I
[0>0
Element
Nodes
number
k
m
CD
IT]
-
1
3
4
2
1
2
5
6
4
3
3
6
5
7
CD
CD
Figure P8-100
8-101
By extending the symbolic notation from Problem 8-91, give the expression for the
assemblage nodal force vector for the discretized two-dimensional region in Fig.
P8-100. The elements are defined in terms of the global node numbers as indicated
in the figure. Note the use of the two different types of elements.

486
STEADY-STATE THERMAL AND FLUID FLOW ANALYSIS
8·102
For the element in Problem 8-70 the nodal temperatures are obtained from the
solution of Ka = r and are T, = 175, '0 = 168, and T, = 173°F. Determine the
average heat fluxes from conduction in the x and y directions, respectively. At what
point in the element are these heat fluxes normally associated?
8·103
For the element in Problem 8-72 the nodal temperatures are obtained from the
solution of Ka = r and are T, = 75, T, = 82, and T, = 73°C. Determine the
average heat fluxes from conduction in the x and y directions, respectively. At what
point in the element are these heat fluxes normally associated?
8-104
For the element in Problem 8-74 the nodal temperatures are obtained from the
solution of Ka = r and are T, = 94, T, = 91, and T, = 96°C. Determine the
average heat fluxes from conduction in the x and y directions, respectively. At what
point in the element are these heat fluxes normally associated?
8·105
For the element in Problem 8-76 the nodal temperatures are obtained from the
solution of Ka = f and are T, = 154, T} = 148, and T, = 157°F. Determine the
average heat fluxes from conduction in the x and y directions, respectively. At what
point in the element are these heat fluxes normally associated?
8·106
For the element in Problem 8-78 the nodal temperatures are obtained from the
solution of Ka = rand are T, = 92, T, = 96, T, = 89, and Tm = 95°C. Determine
the heat fluxes at the element centroid from conduction in the x and y directions,
respectively. These heat fluxes may be regarded as the average conduction heat
fluxes.
8·107
For the element in Problem 8-80 the nodal temperatures are obtained from the
solution of Ka = r and are T, = 192, '0 = 195, T, = 189, and Tm = 196°C.
Determine the heat fluxes at the element centroid from conduction in the x and y
directions, respectively. These heat fluxes may beregarded as the average conduction
heat fluxes.
8·108
The necessary condition for the existence of an extremum of the functional
1= LF(X,y,w,wx>Wy,Wu,wxy,wyy ) dx dy
is that the first variation & must vanish (i.e., equal to zero) provided that
and
f(
aF
aF
I aF
I aF
)
-
n x &wx + -
n, &wy + - -
n
&wx + - -
n x &Wy de = 0
c awxx
aWyy
.
2 awxy
y
2 awxy
on the boundary of the two-dimensional region. In the above, w is the field variable,
x and yare the two independent coordinates, Wx indicates the first (partial) derivative
of w with respect to .r, Wxx indicates the second (partial) derivative of w with respect
to x, etc.

iJ2 (iJF)
+ iJi
iJwry
= 0
PROBLEMS
487
a. Show that the corresponding Euler-Lagrange equation is given by
iJF
iJ (iJF)
iJ (iJF)
iJ2 ( iJF )
iJw - ~
iJwx
- ay
iJwl'
+ iJx2 iJwxx
iJ2
(iJF)
+ iJx iJy
iJWry
b. What order differential equation does the Euler-Lagrange equation from part (a)
correspond to? Please explain.
c. What is the highest order derivative present in the functional F?
d. Try to generalize the results from parts (b) and (c). Explain why the variational
formulation may be referred to as the weak formulation.
8-109
In Problem 8-108, identify:
a. The geometric boundary conditions
b. The natural boundary conditions
8-110
The bending of a thin isotropic plate of constant thickness t may be described by
the well-known biharmonic equation
iJ4w
iJ4w
iJ4w
12(1 -
IJ.o2)
iJx4 + 2iJx2 iJy2 + iJy4 +
Et3
q(x,y) = 0
where w is the deflection of the neutral plane of the plate (in the direction perpen-
dicular to the xy plane), q is lateral distributed load per unit area,
IJ.o is Poisson's
ratio, and E is the modulus of elasticity. Assume that the plate is rigidly supported
around the boundary such that the plate has zero deflections and zero slopes on the
boundary. Note that the rotations 9x and 9y about the x and y axes at any point in
the plate are related to the deflection at the same point by
iJw
9 =.-
x
iJy
and
9 = iJw
y
iJx
With the help of the Euler-Lagrange equation from Problem 8-108, show that the
corresponding variational principle under these assumptions is given by
J[
I (iJ2w)2
( iJ2w )2
I (iJ2W)2
12(1 -
1J.o2)
] dx
J=
--+--+--+
qw
dy
2
iJx2
iJx iJy
2
iJi
Et3
8-111
Derive the variational principle for Problem 8-110 by writing
i[
iJ4W
iJ4w
iJ4w
12(1 -
1J.o2)
]
-4+ 2-2-2+-4+
E3
q(x,y)
8wdxdy=O
AiJX
iJxiJy
iJy
t
and by applying the Green-Gauss theorem twice. Hint: The boundary integrals that
arise are identically zero for the assumptions stated in Problem 8-110. Clearly explain
why.
8-112
Explain what is meant by the method of quadrilateral averages. Why is the method
used? Illustrate how the method is applied with a numerical example. Assume that
we have two adjacent triangular elements for which the element resultants (i.e., the
conduction heat fluxes in the x and y directions) are already known (from the finite
element solution).

488
STEADY-STATE THERMAL AND FLUID FLOW ANALYSIS
8-113
How could the method of quadrilateral averages be used in two-dimensional stress
analysis (i.e., plane stress or plane strain) to improve the resulting stresses when
the three-node triangular element is used? Be specific and illustrate with a numerical
example.
8-114
How could the method of quadrilateral averages be used in axisymmetric stress
analysis to improve the resulting stresses when the three-node triangular element is
used? Be specific and illustrate with a numerical example.
8-115
In the formal development of two-dimensional, steady-state heat conduction in Sec.
8-8, only isotropic materials were considered. Let us now extend the development
of that section to the case of anisotropic materials. For anisotropic materials, the
thermal conductivity is dependent on direction. It is convenient to consider the two
values of thermal conductivity in the so-called principal directions as shown in Fig.
P8-115. Let us denote the principal values of the thermal conductivities as k'; and
k; in the local x and y directions, respectively. Let us denote these local directions
as x' and y' (similar to the development in Chapter 3 where the transformation
matrices for two- and three-dimensional trusses were developed). Note that 6 is the
angle between the x and x' axes (and the y and y' axes) as shown in Fig. P8-ll5.
In this case the governing equation for two-dimensional, steady-state heat conduction
must be modified to reflect the fact that there are different values of thermal con-
ductivity in the x' and y' directions. Also, it proves to be much more convenient
to express the governing equation in the local coordinate system. Only the two terms
involving conduction in Eq. (8-9\), i.e., the first two terms, must be modified with
the resulting governing equation given by
a ( , «r\
a ( , aT)
4
4
-
k t-j + -
kt-
-
h(T - T) - m(T
-
T ) + q + Qt = 0
ax'
x ax'
ay'"
ay'
U
's
In general the local x'y' axes are not in the same directions as the global xy axes
as shown in Fig. P8-115. Therefore. it seems reasonable to apply the Galerkin
method on an element basis where the local x'y' coordinate system is used.
y
y
x
x
Figure P8-115
a. Show that the resulting expressions for the element stiffness matrices from
conduction in the x' and y' directions are given by
i
aN'T
aN'
K"
=
-- k' t -
dx' dy'
.r.r,
At' ax'
.r
ax'

PROBLEMS
489
and
i
aN'T
aN'
e
'_"
K,.y -
k).t, dx dy
'.
A' ay'
ay
where N' indicates that the shape functions must be written in terms of the local
x'y' system before taking the indicated derivatives.
b. Convince yourself that since the field variable is a scalar in this problem (i.e.,
the temperature) that the procedure for implementing anisotropic material prop-
erties in the finite element formulation is as follows: (I) Transform the coor-
dinates of every node for a given element from the global xy system to the x'y'
system with the help of Eq. (3-13), (2) compute the element stiffness matrices
from the above expressions for the element stiffnesses (or conductances) using
the coordinates in the local x'y' system, and (3) do the remaining part of the
analysis as described in Sec. 8-8. Note that it is not necessary to transform the
local element stiffness matrices to global element stiffness matrices (such as in
Chapter 3) because the field variable here is a scalar, not a vector. In effect,
the local and global element stiffness matrices are identical in this case.
8·116
Let us apply the development of Problem 8-115 to a specific example. Consider
the case of anisotropic heat conduction in a triangular element. The principal values
of the thermal conductivities are denoted as k; and k; in the local x' and y' directions,
respectively. The angle e is defined to be the angle between the x and x' axes (or
the y and y' axes) as shown in Fig. P8-1I5. The plate from which the element is
extracted has a thickness of 0.5 in. The nodal coordinates are Xi = 2.0, Yi = 1.5,
Xj = 1.7, Yj = 3.0,
Xk = 0.6, and Yk = 1.8 in. with respect to the global xy
coordinate system. If k; and k; are 120 and 60 Btu/hr-ft-T; respectively, and if e
is 30°, determine the global element stiffness matrices for this element (from con-
duction only).
8-117
Repeat Problem 8-116 for an element whose nodal coordinates are Xi = 5, Yi .= 6,
Xj = 4, Yj = 4, Xk = 6, and Yk = 4 em with respect to the global xy coordinate
system. The plate from which the element is extracted has a thickness of I em.
Assume k; and k; are 200 and 110 W/m-oC, respectively, and e is 25°.
8-118
Consider the elemental volume shown in Fig. P8-118. Perform a steady-state energy
balance that includes the effects of the heat conduction in the rand z directions as
well as the internal heat source Q. Assume that the conduction heat fluxes vary
according to a first-order Taylor expansion as shown on the figure. Use Fourier's
law of heat conduction (a constitutive relationship) to eliminate the conduction heat
fluxes, thereby showing the validity of Eq, (8-126). Hint: Note that the effective
area for heat conduction in the r direction is not constant.
8-119
Show that the variational principle that corresponds to Eq. (8-126) is given by

490
STEADY-STATE THERMAL AND FLUID FLOW ANALYSIS
a,
Figure P8-118
providing that imposed heat fluxes and convection are allowed on the boundary of
the axisymmetric body. Note that the nomenclature from Sec. 8-9 is used and the
imposed heat flux qsB is positive if the heat flux is directed toward the body.
8-120
Extend the finite element formulation of the axisymmetric heat conduction problem
to the case of radiation from the surface of the body to a large enclosure. The energy
balance on the boundary (or surface of the body) given by Eq. (8-l33a) must be
modified to include the heat flux from the radiation qrB which is given by
qrB =
EBcr(T4 -
T~)
Note that this assumes that the heat flux from radiation is directed away from the
surface. Does this mean the formulation applies only if the radiation is from the
body (being analyzed) to the receiver? Please explain. Does this boundary radiation
yield another element stiffness matrix, another nodal force vector, or both? Derive
them.
8-121
Show that the element stiffness matrix from conduction in the axial direction (z
direction) is given by Eq. (8-152) if the three-node, axisymmetric triangular element
is used. What assumptions are made in arriving at this result?

PROBLEMS
491
8-122
Evaluate the element stiffness matrix from boundary convection for the axisymmetric
heat conduction problem [given by Eq. (8-142c») for the case of a three-node,
axisymmetric triangular element
a. With leg jk on the global boundary
b. With leg ki on the global boundary
8-123
Show that the element nodal force vector from an internal heat source that is assumed
to be uniform over the element is given by Eq. (8-158) if the three-node, axisym-
metric triangular element is used.
8-124
Show that the element nodal force vector from boundary convection from leg ij of
the a three-node, axisymmetric triangular element is given by Eq. (8-159). State
all assumptions made in arriving at this result.
8-125
Evaluate the element nodal force vector from boundary convection from an axi-
symmetric body [given by Eq. (8-143c») if the three-node, axisymmetric triangular
element is used, with leg jk on the global boundary.
8-126
Evaluate the element nodal force vector from boundary convection from an axi-
symmetric body [given by Eq. (8-143c») if the three-node, axisymmetric triangular
element is used, with leg ki on the global boundary.
8-127
Show that the element nodal force vector from an imposed heat flux on the boundary
of an axisymmetric body is given by Eq. (8-160) if the three-node, axisymmetric
triangular element is used and leg ij is on the global boundary. State all assumptions
made in arriving at this result.
8-128
Evaluate the element nodal force vector from an imposed heat flux on the boundary
of an axisymmetric body [given by Eq. (8-143b») if the three-node, axisymmetric
triangular element is used, with leg jk on the global boundary.
8-129
Evaluate the element nodal force vector from an imposed heat flux on the boundary
of an axisymmetric body [given by Eq. (8-143b») if the three-node, axisymmetric
triangular element is used, with leg ki on the global boundary.
8·130
Consider the axisymmetric heat conduciton problem for the case of a "point" heat
source. In order for the problem to be considered axisymmetric, the heat source
must be uniform in the circumferential direction and is generally specified on a unit
circumference basis. Consequently, it is more appropriate to refer to such a heat
source as a circumferential line source. Let Q' be the heat source per unit circum-
ference and unit time at point (ro.zo). Determine the corresponding element nodal
force vector for the case of a three-node, axisymmetric triangular element.
8-131
Determine the expressions for the element resultants, i.e., the heat fluxes from
conduction in the rand z directions if the three-node, axisymmetric triangular element
is used. Note that these heat fluxes are usually considered to be the average heat
fluxes over the element and are generally associated with the element centroid.
8-132
In the formal development of the axisymmetric heat conduction problem in Sec.
8-9, only isotropic materials were considered (the material may be heterogeneous,
however). Recall that it is not possible to have fully anisotropic, axisymmetric
materials. Why not? It is possible to have stratified materials such that the principal

492
STEADY·STATE THERMAL AND FLUID FLOW ANALYSIS
values of thermal conducti vity, k, and k, (see Problems 8-115 to 8-117), occur in
the rand z directions, respectively, as shown in Fig. P8-132.
z
Figure P8·132
a. By using the approach indicated in Problem 8-118, show that the governing
equation in this case is given by
I a (
aT)
a (
aT)
- -
rk, -
+ -
kz -
+ Q = 0
r ar
ar
az
az
b. How must the expressions for the element stiffness matrices given by Eqs.
(8-142a) and (8-142b) be modified in order to account for this stratified material?
Be specific.
8-133
The expressions for the element stiffness matrices from conduction in an axisym-
metric body are given by Eqs. (8-142a) and (8-142b). Since these results hold for
any axisymmetric element, let us evaluate these stiffness matrices for the four-node,
axisymmetric rectangular element by proceeding as follows:
a. With the help of Eqs. (6-32), show that
aN
I aN
ax
a ar
aN
I aN
= --
ay
b as
b. Using the results from part (a), rewrite the integrals in terms of derivatives of
the shape funcitons with respect to the serendipity coordinates rand s. Do not
confuse the radius r that appears in the integral with the serendipity coordinate
r (e.g., use r' to represent the radial coordinate). Do not forget to change the
limits on the integrations. Also note that the elemental area dr dz in the rz
coordinate system is related to the elemental area in the rs coordinate system
by dr' dz = ab dr ds.
c. Evaluate the resulting integrands at the element centroid (i.e., at r = 0 and
s
=
0). Then treat the integrands as though they are constant and pull them
through the integral. Evaluate the remaining trivial integrals. Show that the result
for the element stiffness from conduction in the radial direction is given by

e
_
2-rrrkb [
:
K rr -
4a
-I
-I
I
I
-I
-I
-I
-I
I
I
-1]
-1
I
I
PROBLEMS
493
where r is the radial coordinate at the centroid of the element. State the other
assumptions made in arriving at this result.
d. Derive the corresponding result for K~s: What assumptions are made?
8-134
Evaluate the element stiffness matrix from boundary convection from an axisym-
metric body [i.e., Eq. (8-142c») if the four-node, axisymmetric rectangular element
is used and if face ij happens to be on the global boundary. Evaluate the integrals
by first evaluating the integrands at the centroid of face ij (i.e., at serendipity
coordinates r = + I and s =
0) and then treating the integrands as though they
were constant. Do not confuse the radial coordinate r with the serendipity coordinate
r (e.g., use r' to denote the radial coordinate).
8-135
Evaluate the element stiffness matrix from boundary convection from an axisym-
metric body [i.e., Eq. (8-142c») if the four-node, axisymmetric rectangular element
is used and if face jk happens to be on the global boundary. Evaluate the integrals
by first evaluating the integrands at the centroid of face jk (ie., at serendipity
coordinates r = 0 and s = + I) and then treating the integrands as though they
were constant. Do not confuse the radial coordinate r with the serendipity coordinate
r (e.g., use r' to denote the radial coordinate).
8-136
Evaluate the element nodal force vector from an internal heat source in an axisym-
metric body [i.e., Eq. (8-143a») if the four-node, axisymmetric rectangular element
is used. Evaluate the integrals by first evaluating the integrands at the element
centroid (i.e., at serendipity coordinates r = 0 and s = 0) and then treating the
integrands as though they were constant. Do not confuse the radial coordinate r
with the serendipity coordinate r (e.g., use r' to denote the radial coordinate).
8-137
Evaluate the element nodal force vector from boundary convection from an axi-
symmetric body [i.e., Eq. (8-143c») if the four-node, axisymmetric rectangular
element is used and if face ij happens to be on the global boundary. Evaluate the
integrals by first evaluating the integrands at the centroid of face ij (i.e., at serendipity
coordinates r = + I and x = 0) and then treating the integrands as though they
were constant. Do not confuse the radial coordinate r with the serendipity coordinate
r (e.g., use r' to denote the radial coordinate).
8-138
Evaluate the element nodal force vector from boundary convection from an axi-
symmetric body [i.e., Eq. (8-143c») if the four-node, axisymmetric rectangular
element is used and if face jk happens to be on the global boundary. Evaluate the
integrals by first evaluating the integrands at the centroid of face jk (i.e., at ser-
endipity coordinates r = 0 and s = + I) and then treating the integrands as though
they were constant. Do not confuse the radial coordinate r with the serendipity
coordinate r (e.g., use r' to denote the radial coordinate).
8-139
Evaluate the element nodal force vector from a boundary heat flux imposed on an
axisymmetric body [i.e., Eq. (8-143b») if thefour-node, axisymmetric rectangular
element is used and if face mi happens to be on the global boundary. Evaluate the
integrals by first evaluating the integrands at the centroid of face mi (i.e., at ser-

494
STEADY-STATE THERMAL AND FLUID FLOW ANALYSIS
endipity coordinates r = 0 and s =
- I) and then treating the integrands as though
they were constant. Do not confuse the radial coordinate r with the serendipity
coordinate r (e.g., use r' to denote the radial coordinate).
8-140
Derive the expressions for the average heat fluxes within an element if the four-
node, axisymmetric rectangular element is used. Hint: Evaluate the expressions for
Fourier's law of heat conduction at the element centroid and interpret these results
to be the average heat fluxes from conduction in the radial and axial directions.
8-141
Consider the axisymmetric, triangular element shown in Fig. P8-141. The body
from which the element is extracted is made of cast iron. The nodal coordinates
are rj = 2.0, z, = 1.5, rj = 1.7, Zj = 3.0, rk = 0.6, and Zk = 1.8 in.
Figure PS-141
a, Determine the element stiffness matrices from conduction in the rand Z direc-
tions.
b. Determine the element stiffness matrix from boundary convection if leg ij happens
to be on the part of the global boundary that undergoes convection to a fluid at
58°F through a convective heat transfer coefficient of 75 Btu/hr-ft2-of.
8-142
For the element in Problem 8-141, determine the nodal force vectors
a. From an internal heat source of 40 Btu/hr-ft'
b. From boundary convection
c. From a boundary heat flux of 325 Btu/hr-ft? imposed on leg ij (which is on the
part of the global boundary also undergoing convection.)
8·143
Consider the axisymmetric, triangular element shown in Fig. P8-143. the body from
which the element is extracted is made of brass. The nodal coordinates are rj = 5,
Z; = 6, ri = 4, z} = 4, rk = 6, and Zk = 4 cm.
a. Determine the element stiffness matrices from conduction in the rand Z direc-
tions.
b. Determine the element stiffness matrix from boundary convection if leg ki hap-
pens to be on the part of the global boundary that undergoes convection to a
fluid at 55°C through a convective heat transfer coefficient of 4 W/cm 2-
0C.

PROBLEMS
495
0.
t
Q
(j) ....--------e
I
Figure P8-143
8-144
For the element in Problem 8-143, determine the nodal force vectors
a. From an internal heat source of 80 W/cm3
b. From boundary convection
c. From a boundary heat flux of 35 W/cm2 imposed on leg ki (which is on the part
of the global boundary also undergoing convection)
8-145
Consider the axisymmetric, triangular element shown in Fig. P8-145. The element
is extracted from an axisymmetric body that is fabricated from hot rolled, low carbon
steel. The nodal coordinates are r,
= 0, z, = 0, rj = 0, Zj =
- I, rk = 2, and
Zk = -I em.
0;
Q
j '------......,-------"e
k @
o
Figure P8-145
a. Determine the element stiffness matrices from conduction in the rand Z direc-
tions.
b. Determine the element stiffness matrix from boundary convection if leg jk hap-
pens to be on the part of the global boundary that undergoes convection to a
fluid at 75°C through a convective heat transfer coefficient of 5 W/cm 2_oC.
8-146
For the element in Problem 8-145, determine the nodal force vectors
a. From an internal heat source of 15 W/cm3
b. From boundary convection

496
STEADY-STATE THERMAL AND FLUID FLOW ANALYSIS
c.
From a boundary heat flux of 50 W/cm 2 imposed on Iegjk (which is on the part
of the global boundary also undergoing convection)
8-147
Consider the axisymmetric, triangular element shown in Fig. P8-147. The element
is extracted from an axisymmetric body that is fabricated from pure copper. The
nodal coordinates are r j = 10, z, = 10, r j = 11, Zj = 12, rk = 9, and Zk = 12 in.
a
Figure P8-147
a. Determine the element stiffness matrices from conduction in the rand Z direc-
tions.
b. Determine the element stiffness matrix from boundary convection if leg ki hap-
pens to be on the part of the global boundary that undergoes convection to a
fluid at 56°F through a convective heat transfer coefficient of 63 Btu/hr-ft2-oF.
8-148
For the element in Problem 8-147, determine the nodal force vectors
a. From an internal heat source of 25 Btu/hr-ft'
b. From boundary convection
c.
From a boundary heat flux of 50 Btu/hr-ft? imposed on leg ki (which is on the
part of the global boundary also undergoing convection)
8-149
Consider the axisymmetric, rectangular element shown in Fig. P8-149. The element
is extracted from an axisymmetric body that is made of aluminum. The coordinates
of the nodes are r, = 4, z, = 2, rj = 4, ZI = 3, rk = 2, Zk = 3, r m = 2, and
Zm = 2 em. Perform the necessary integrations by following the approaches men-
tioned in Problems 8-133 to 8-135 and
@
@
k..----.....c..----..i
a
m_--------.. i
@
@
Figure P8-149

PROBLEMS
497
a. Determine the element stiffness matrices from conduction in the' and Z direc-
tions.
b. Determine the element stiffness matrix from boundary convection if face jk
happens to be on the part of the global boundary that undergoes convection to
a fluid at 10°C through a convective heat transfer coefficient of 5 W/cm2-"C.
8-150
Consider the element in Problem 8-149. Perform the necessary integrations by
following the approaches indicated in Problems 8-136 to 8-139, and determine the
nodal force vectors
a. From an internal heat source of 5 W/cm3
b. From boundary convection
c. From a boundary heat flux of 30 W/cm2 imposed on face jk (which is on the
part of the global boundary also undergoing convection)
8-151
Consider the rectangular element shown in Fig. P8-151. The element is extracted
from an axisymmetric body that is made of brass. The coordinates of the nodes are
r, = 5, z, = 2, 'j = 5, Zj = 4, 'k = 2, Zk = 4, rm = 2, and Zm = 2 in. Perform
the necessary integrations by following the approaches mentioned in Problems
8-133 to 8-135 and
Q
@
@
k t----+-------.. i
q,s-
m_-------_;
CD
@
Figure P8-151
a. Determine the element stiffness matrices from conduction in the' and Z direc-
tions.
b. Determine the element stiffness matrix from boundary convection if face km
happens to be on the part of the global boundary that undergoes convection to
a fluid at 720°F through a convective heat transfer coefficient of 75 Btu/hr-ftj-
Of.
8-152
Consider the element in Problem 8-151. Perform the necessary integrations by
following the approaches indicated in Problems 8-136 to 8-139, and determine the
nodal force vectors
a. From an internal heat source of 10,000 Btu/hr-ft'
b. From boundary convection
c. From a boundary heat flux of 420 Btu/hr-ft? imposed on face km (which is on
the part of the global boundary also undergoing convection)
8-153
For the element in Problem 8-141, determine the element nodal force vector from
a circumferential line source with a strength of 50 Btulhr per inch of circumference
at the location of the source. The source is located at '0 = 1.5 and Zo = 2.0 in.

498
STEADY·STATE THERMAL AND FLUID FLOW ANALYSIS
8-154
For the element in Problem 8-143, determine the element nodal force vector from
a circumferential line source with a strength of 65 W per centimeter of circumference
at the location of the source. The source is located at,o = 5 and Zo = 5 cm.
8-155
For the element in Problem 8-145, determine the element nodal force vector from
a circumferential line source with a strength of 40 W per centimeter of circumference
at the location of the source. The source is located at,o = 2 and Zo = - I cm.
8-156
For the element in Problem 8-147, determine the element nodal force vector from
a circumferential line source with a strength of 130 Btu/hr per inch of circumference
at the location of the source. The source is located at '0 = II and Zo = 12 in.
8-157
For the element in Problem 8-149, determine the element nodal force vector from
a circumferential line source with a strength of 30 W per centimeter of circumference
at the location of the source. The source is located at '0 = 3.0 and Zo = 2.5 cm.
8-158
For the element in Problem 8-151, determine the element nodal force vector from
a circumferential line source with strength of 30 Btulhr per inch of circumference
at the location of the source. The source is located at '0 = 4 and Zo = 3 in.
8-159
For the element in Problem 8-141 the nodal temperatures are obtained from the
solution of Ka = r and are T, = 175, T, = 168, and T, = 173°F. Determine the
average heat fluxes from conduction in the' and z directions, respectively. With
what point in the element are these heat fluxes normally associated?
8-160
For the element in Problem 8-143 the nodal temperatures are obtained from the
solution of Ka = r and are T, = 75, Tj = 82, and T, = 73°C. Determine the
average heat fluxes from conduction in the' and z directions, respectively. With
what point in the element are these heat fluxes normally associated?
8-161
For the element in Problem 8-149 the nodal temperatures are obtained from the
solution of Ka = r and are T, = 92, T, = 95, and T, = 89, Tm = 96°C. Determine
the heat fluxes at the element centriod from conduction in the' and z directions,
respectively. These heat fluxes may be regarded as the average conduction heat
fluxes.
8-162
For the element in Problem 8-151 the nodal temperatures are obtained from the
solution of Ka = r and are T, =
192, Tj =
195, T, =
189, and Tm =
196°F.
Determine the heat fluxes at the element centroid from conduction in the' and z
directions, respectively. These heat fluxes may be regarded as the average conduction
heat fluxes.
8·163
Consider the elemental volume dx dy dz shown in Fig. P8-163. Note that the
conduction heat fluxes in the .r, y, and z directions are assumed to vary according
to a first-order Taylor expansion. In addition, an internal heat source Q is present.
By performing a steady-state energy balance and by invoking Fourier's law of heat
conduction, given by Eq. (8-161), show that the governing equation for steady-
state heat conduction in a heterogeneous, isotropic, three-dimensional body is given
by Eq. (8-162).
8-164
Show that the variational principle that corresponds to Eq. (8-162) for three-
dimensional, steady-state heat conduction in a heterogeneous, isotropic body is given
by

PROBLEMS
499
Q
zJ,
x
Figure P8-163
I
I
I
I:dz
I
I
I
I
I
/",,,..J-------
" ""''''dx
//
dy
--------
I = Iv [ QT -
Y2 k (~:f-Y2 k (~~f-Y2 k G:fJ dx dy dz
+ Is (qsBT -
~2hBT2 + hBTaBD dS
if imposed heat fluxes (qsB) and convection from the boundary (i.e., the surface)
of the three-dimensional body are taken into account. Note that the nomenclature
from Sec. 8-10 is used.
8-165
Extend the formulation for three-dimensional heat conduction in Sec. 8-10 to the
case of radiation from (or to) the surface of the body to (or from) a large enclosure
at temperature T,B. In particular, derive the expressions for the corresponding element
stiffness matrix and element nodal force vector.· Note that the governing equation
[given by Eq. (8-162)) does not need to be modified. Why not?
8-166
Show that the element stiffness matrix from conduction in the x direction in a three-
dimensional body is given by Eq. (8-177) if the four-node tetrahedral element is
used. What assumptions are made in arriving at this result?
8-167
Show that the element stiffness matrix from conduction in the y direction in a three-
dimensional body is given by Eq. (8-178) if the four-node tetrahedral element is
used. What assumptions are made in arriving at this result?
8-168
Show that the element stiffness matrix from conduction in the z direction in a three-
dimensional body is given by Eq. (8-179) if the four-node tetrahedral element is
used. What assumptions are made in arriving at this result?

500
STEADY-STATE THERMAL AND FLUID FLOW ANALYSIS
8·169
Evaluate the element stiffness matrix and element nodal force vector from boundary
convection from a three-dimensional body [see Eqs. (8-175d) and 8-176c») if the
four-node tetrahedral element is used, and if face jkm of the tetrahedron happens
to be on the part of the global boundary that undergoes convection.
8·170
Evaluate the element stiffness matrix and element nodal force vector from boundary
convection from a three-dimensional body [see Eqs. (8-l75d) and (8-176c») if the
four-node tetrahedral element is used, and if face ikm of the tetrahedron happens
to be on the part of the global boundary that undergoes convection.
8-171
Evaluate the element stiffness matrix and element nodal force vector from boundary
convection from a three-dimensional body [see Eq. (8-l75d) and (8-176c») if the
four-node tetrahedral element is used, and if face ijm of the tetrahedron happens to
be on the part of the global boundary that undergoes convection.
8-172
Evaluate the element nodal force vector from an imposed boundary heat flux on
the surface of a three-dimensional body [see Eq. (8-176b)] if the four-node tetra-
hedral element is used. Assume that face jkm of the tetrahedron happens to be on
the part of the global boundary on which a heat flux is imposed.
8-173
Evaluate the element nodal force vector from an imposed boundary heat flux on
the surface of a three-dimensional body [see Eq. (8-176b») if the four-node tetra-
hedral element is used. Assume that face ijm of the tetrahedron happens to be on
the part of the global boundary on which a heat flux is imposed.
8-174
Evaluate the element nodal force vector from an imposed boundary heat flux on
the surface of a three-dimensional body [see Eq. (8-176b») if the four-node tetra-
hedral element is used. Assume that face ikm of the tetrahedron happens to be on
the part of the global boundary on which a heat flux is imposed.
8-175
Show that the element nodal force vector from an internal heat source in a three-
dimensional body is given by Eq. (8-182) if the four-node tetrahedral element is
used. What assumptions are made in arriving at this result?
8·176
Consider the case of a point heat source in a three-dimensional body. Let us derive
an expression for the corresponding nodal force vector for such a point source.
Assume the strength of the source is Qo(in units of Watts or Btulhr) and the location
is Xo. Yo, and Zo0 Use the three-dimensional form of the delta-function (see Sec. 8-
8 for the two-dimensional form of the delta-function) to represent the internal heat
source in Eq. (8-176a) and evaluate the result to get
[
Ni(XO,YO.ZO) ]
C(\ = Qo
Nixo.Yo.zo)
N.(xo,Yo.zo)
Nm(xo.Yo.zo)
Explain the physical significance of this result.
8·177
Develop a procedure, formula, or algorithm that could be used to determine the
area of a typical face of the tetrahedral element, given the coordinates of the nodes
of the element. Note that this is needed in order to evaluate Ai}k in Eqs. (8-181),
(8-183), and (8-184).

PROBLEMS
501
8-178
The solution of Ka = r for the three-dimensional heat conduction problem yields
the nodal temperatures. Assuming these temperatures are known, show how the
average heat fluxes from conduction in the x, y, and z directions may be calculated
if the four-node tetrahedral element is used.
8-179
The expression for the element stiffness matrix from conduction in the x direction
in a three-dimensional body, given by Eq. (8-175a), is quite general and may be
applied to any three-dimensional element. Evaluate the integral for the case of an
eight-node brick element by evaluating the integrand at the element centroid (i.e.,
at serendipity coordinates r = 0, s = 0, and t = 0) and then treating the integrand
as though it were constant.
8-180
Repeat Problem 8-179 for the element stiffness matrix from conduction in the y
direction in a three-dimensional body, given by Eq. (8-175b).
8-181
Repeat Problem 8-179 for the element stiffness matrix from conduction in the z
direction in a three-dimensional body, given by Eq. (8-175c).
8-182
The expression for the element stiffness matrix from convection from (or to) the
surface of a three-dimensional body, given by Eq.(8-175d), is quite general and
may be applied to any three-dimensional element. Evaluate the integral for the case
of an eight-node brick element with face 1-2-3-4 on the global boundary byeval-
uating the integrand at the centroid of face 1-2-3-4 (what are the values of serendipity
coordinates at this point?) and then treating the integrand as though it were constant.
Determine the corresponding element nodal force vector in this case.
8-183
Repeat Problem 8-182 if face 1-2-5-6 of the brick element is on the part of the
global boundary undergoing convection.
8-184
Repeat Problem 8-182 if face 3-4-7-8 of the brick element is on the part of the
global boundary undergoing convection.
8-185
The expression for the element nodal force vector from a distributed internal heat
source in a three-dimensional body, given by Eq. (8-176a), is quite general and
may be applied to any three-dimensional element. Evaluate the integral for the case
of an eight-node brick element by evaluating the integrand at the centroid of the
element (what are the values of serendipity coordinates at this point?) and then
treating the integrand as though it were constant.
8-186
The expression for the element nodal force vector from an imposed heat flux on
the surface of a three-dimensional body, given by Eq. (8-176b), is quite general
and may be applied to any three-dimensional element. Evaluate the integral for the
case of an eight-node brick element with face 1-2-3-4 on the global boundary by
evaluating the integrand at the centroid of face 1-2-3-4 (what are the values of
serendipity coordinates at this point) and then treating the integrand as though it
were constant.
8-187
Repeat Problem 8-186 if face 1-2-5-6 of the brick element is on the part of the
global boundary over which a heat flux is imposed.
8-188
Repeat Problem 8-186 if face 3-4-7-8 of the brick element is on the part of the
global boundary over which a heat flux is imposed.

502
STEADY·STATE THERMAL AND FLUID FLOW ANALYSIS
8-189
The body from which a tetrahedral element is extracted is made of pure copper.
The nodal coordinates of the element are Xi = 5, Yi = 6, z, = 0, Xj = 4, Yj = 4,
Zj = 0, Xk = 5, Yk = 5, Zk = 4, Xm = 6, Ym = 4, and Zm =°em. Determine the
element stiffness matrices from conduction in
a. The X direction
b. The Y direction
c. The Z direction
8·190
The body from which a tetrahedral element is extracted is made of aluminum. The
nodal coordinates of the element are Xi = 2.0, Yi = 1.5, z, = 0.0, Xj = 1.7, Yj =
3.0, Zj = -0.2, Xk = 1.5, Yk = 2.0, Zk = 1.7, Xm = 0.6, Ym = 1.8, and Zm
0.1 in. Determine the element stiffness matrices from conduction in
a. The X direction
b. The Y direction
c. The Z direction
8-191
For the element in Problem 8-189, determine the element stiffness matrix and ele-
ment nodal force vector from convection if face ijk of the tetrahedron is on the part
of the global boundary that is undergoing convection. The convective heat transfer
coefficient is 100 W/m2_oC and the ambient temeprature is 45°C.
8-192
For the element in Problem 8-190, determine the element stiffness matrix and ele-
ment nodal force vector from convection if face ikm of the tetrahedron is on the
part of the global boundary that is undergoing convection. The convective heat
transfer coefficient is 50 Btu/hr-ft2-oF and the ambient temperature is 72°F.
8-193
For the element in Problem 8-189, determine the element nodal force vector from
a uniform internal heat source of 50 W/cm3•
8-194
For the element in Problem 8-190, determine the element nodal force vector from
a uniform internal heat source of 10,000 Btu/hr-ft".
8-195
For the element in Problem 8-189, determine the element nodal force vector from
a boundary heat flux of 200 W/cm2 if face ijk is receiving the imposed flux.
8·196
For the element in Problem 8-190, determine the element nodal force vector from
a boundary heat flux of 1000 Btu/hr-ft? if face ikm is receiving the imposed flux.
8-197
For the element in Problem 8-189, determine the element nodal force vector from
a point heat source of 75 W at Xo = 5, Yo = 5, and Zo = Oem.
8-198
For the element in Problem 8-190, determine the element nodal force vector from
a point heat source of 185 Btu/hr at Xo = 1.6, Yo = 2.1, and Zo = 1.1 in.
8·199
Consider the velocity potential formulation of the two-dimensional potential flow
problem in Sec. 8-11.
a. Show that the velocity components defined by Eqs. (8-187) satisfy the irrotational
flow condition exactly.
b. Show that Laplace's equation (8-188) results if these expressions for the velocity
components are substituted into the two-dimensional continuity equation for an
incompressible fluid.
8·200
Extend the two-dimensional velocity potential formulation in Sec. 8-11 to the three-
dimensional case. In particular, determine the equations that correspond to Eqs.

PROBLEMS
503
(8-187) to (8-197). Use u. v, and w to denote the velocity components in the x, y,
and z directions, respectively. Do not evaluate the integrals that appear in the
expressions for the element characteristics.
8·201
Under what conditions do Eqs. (8-202) and (8-203) hold? Derive the analogous
equations that would need to be used if leg jk were on the global boundary and if
the velocity components U and v are assumed to vary linearly over the leg. At node
j the velocity components are Uj and Vj' and at node k the velocity components are
u, and Vk'
8·202
Under what conditions do Eqs. (8-202) and (8-203) hold? Derive the analogous
equations that would need to be used if leg ki is on the global boundary and if the
velocity components U and v are assumed to vary linearly over the leg. At node i
the velocity components are u, and Vj, and at node k the velocity components are
Uk and Vk'
8·203
The direction cosines (nx and ny) of the outward normal unit vector on leg ij of the
triangular element may be computed with the help of Eqs. (8-208) and (8-209).
Extend these equations to the case when leg jk is on the global boundary.
8·204
The direction cosines (nx and n) of the outward normal unit vector on leg ij of the
triangular element may be computed with the help of Eqs. (8-208) and (8-209).
Derive the corresponding equations for the case of leg ki on the global boundary.
8-205
Determine the direction cosines n, and ny on leg jk for the element in Example
8-22 (see Fig. 8-26).
8·206
Determine the direction cosines nx and n, on leg ki for the element in Example
8-22 (see Fig. 8-26).
8·207
Consider the stream function formulation of the two-dimensional potential flow
problem in Sec. 8-11.
a. Show that the velocity components defined by Eqs. (8-214) satisfy the two-
dimensional continuity equation exactly (for an incompressible fluid).
b. Show that Laplace's equation (8-215) results if these expressions for the velocity
components are substituted into the irrotational flow condition.
8-208
By applying the Galerkin method (on a element basis) to the governing equation
given by Eq. (8-215) for two-dimensional potential flow of an incompressible fluid
[see Eq. (8-216)], show that Eqs. (8-217) to (8-221) hold if the stream function
formulation is used.
8-209
By performing an energy balance on the elemental area dx dy shown in Fig.
P8-209, derive the governing equation given by Eq. (8-225a). Assume that the
conduction heat fluxes vary according to a first-order Taylor expansion as shown
on the figure. Remember to include the effect of the fluid motion in the x direction
(i.e., the energy transport by fluid motion or convection). Clearly state the conditions
under which Eq. (8-225a) holds.
8-210
Show that the element stiffness matrix given by Eq. (8-241) is unsymmetric. Recall
that this matrix results from the convective energy transport term in the governing
equation [i.e., Eq. (8-225a)]. Evaluate the integral in Eq. (8-241) for the case of
the three-node triangular element.

S04
STEADY-STATE THERMAL AND FLUID FLOW ANALYSIS
3T
1---- pcuT +pcu ~
3q.
I----q. + a;dx
pcuT
vLx
Figure P8-209
8·211
Show that the element stiffness matrix given by Eq. (8-241) is unsymmetric. Recall
that this matrix results from the convective energy transport term in the governing
equation [i.e., Eq. (8-225a)). Evaluate the integral in Eq. (8-241) for the case of
the four-node rectangular element by evaluating the integrand at the element centroid
and then treating the integrand as though it were constant.
8-212
Try to obtain the variational principle that would correspond to Eq. (8-225a), and
clearly explain the difficulties that are encountered.
8-213
Consider the case of a fully developed laminar flow of an incompressible Newtonian
fluid in a duct of circular cross section. On the walls of the duct, either the tem-
perature is prescribed or a heat flux is imposed (these two boundary conditions may
occur on different parts of the boundary). It is assumed further that the boundary
conditions are axisymmetric. It is desired to obtain the governing equation in this
case. Recall from elementary fluid mechanics that if the viscosity of the fluid is
assumed to be constant, the velocity profile is given by
where Ii is the average fluid velocity in the duct and R is the radius of the duct. By
performing an energy balance on an annular-shaped elemental volume 2'lTr dr dz,
show that the governing equation is given by
sr la(
aT)
a(aT)
pcu(r) -
= - -
kr -
+ -
k-
az
r ar
ar
az
az
if axial conduction is not neglected. Assume a first-order Taylor expansion for the
conduction heat fluxes. Include the effect of the convective energy transport in the
derivation. Which term in the governing equation above results from the convective
energy transport?
8-214
Obtain the expressions for the element characteristics for the situation described in
Problem 8-213. Do not evaluate the resulting integrals. Identify the element stiffness

PROBLEMS
505
matrix that is not symmetric. What is the implication of this in the solution of
Ka = f for the nodal temperatures in the vector a?
8-215
Consider the case of laminar flow of a Newtonian fluid as described in Sec. 8-13.
By beginning with Eq. (8-251) and making use of Eqs. (8-246) and (8-252), show
that Eqs. (8-253) and (8-254) hold.
8-216
Identify the element stiffness matrices in Sec. 8-13 that are unsymmetric. What is
the implication of this during the assemblage step? What effect do the unsymmetric
stiffness matrices have on the solution for the nodal velocities and pressures? How
can the results be improved?
8-217
Clearly explain the differences between the two different assemblage procedures
described in Sec. 8-13 when each node has more than one degree of freedom. Which
procedure results in a larger bandwidth? Please explain. Which procedure is anal-
ogous to the assemblage procedure used in stress analysis (see Chapter 7)? Please
explain.
8-218
In a corrosion study to be performed on aluminum, a long specimen with rectangular
cross section is to be held between two isothermal surfaces at T1 and T2, as shown
in Fig. P8-218. The height and width of the specimen are Hand W, respectively.
T,
Q
H
v
1+--+-w------I
x
T2
Figure P8-218
The specimen is exposed to a cold corrosive environment at a temperature T; with
a convective heat transfer coefficient h., The other side is exposed to relatively
warm stagnant water at a temperature T; with a convective heat transfer coefficient

S06
STEADY-STATE THERMAL AND FLUID fLOW ANALYSIS
h.; A current is passed through the specimen such that a distributed internal heat
source Q results at a rate given by
Q = C sin 21TX
'w
where x is measured in the same units as Wand H. Note that the heat source is
zero on the surfaces of the specimen and reaches a maximum value at x =
W12.
The global coordinate system is shown in Fig. P8-218. The speciment is isotropic
with a thermal conductivity k. A finite element solution for the steady-state tem-
perature distribution is sought with 5 nodes in the x direction and II nodes in the
y direction. Determine the temperature distribution for the following parameters:
W = 10 em, H = 25 em, T, = 125°C, T2 = 40°C, T; = 5°C, F; = 25°C, he =
1000 W/m 2.oC, n; = 75 W/m 2-oC, and C1 = 2000 W/m 3.
8·219
Repeat Problem 8-218 for the following parameters: W = 0.32 ft, H = 0.75 ft.
T, = 2500F, T2 = 110°F, T; = 35°F, T; = 75°F, he = 250 Btu/hr-ft-r'F, h.. =
15 Btu/hr-ft 2.oF, and C1 = 60,000 Btu/hr-ft'.
8·220
Half of the outside surface of a long thick-walled boiler tube receives a uniform
heat flux q,B while the other half is insulated. The inside is cooled convectively
with heat transfer coefficient he to a fluid at temperature ToB ' The tube is fabricated
from stainless steel and copper as shown in Fig. P8-220. The inner and outer radii
\
Figure P8·220
of the tube are R; and Ro' and the interface between the stainless steel and copper
is located at a radius Rm. Determine the steady-state temperature distribution in the
tube for the following parameters: q,B = 20,000 Btu/hr-ft", hB = 10,000 Btu/hr-

PROBLEMS
507
ft2_OF, TaB = 500°F, R, = 1.0 in., Rm = 1.25 in., and R; = 1.5 in. Note that
because of the symmetry, only one-half of the tube needs to be analyzed. Use
approximately 100 three-node triangular elements.
8-221
Repeat Problem 8-220 for the following parameters: q,B
=
1000 W/cm2, he =
50,000 W/m 2-oC, TaB = 250°C, R, = 2.5 ern, Rm = 3.5 ern, and R; = 4.5 cm.
8-222
It is desired to obtain the two-dimensional steady-state temperature distribution in
the thin tapered bronze fin of length Lf shown in Fig. P8-222. The thickness of the
fin is 11 at the base and tapers linearly to 12 at the tip. The height of the fin at the
base and tip are HI and H2, respectively. The base is held at a temperature of Tb ,
while all exposed surfaces of the fin convect to a fluid at a temperature Tf with
convective heat transfer coefficients of hi' h2 and h3 on the lateral faces and tip,
on the bottom edge, and on the top edge as shown in the figure. Use at least 80
three-node triangular elements to determine the two-dimensional temperature dis-
tribution in the fin for the following parameters: Lf = 2.0 ern, 11 = 1 em, 12 =
0.5 ern, HI = 1.5 ern, H 2 == 0.75 cm, Tb = 200°C, Tf = 100°C, hi = 1100 WI
m2_oC, h2 = 600 W/m 2-oC, and h3 = 1500 W/m 2-oC.
Figure P8-222
8-223
Repeat Problem 8-222 for the following parameters: Lf =
1.0 in., 11 = 0.4 in.,
12 = 0.25 in., HI = 0.75 in., H2 = 0.375 in., Tb = 390°F, Tf = 212°F, hi
200 Btu/hr-ft 2-OF , h2 = 120 Btu/hr-ft 2- OF , and h3 = 300 Btu/hr-fts-'F.


9
Higher-Order Isoparametric
Elements and Quadrature
9-1
INTRODUCTION
In Chapter 6 shape functions of the lowest possible order were derived for one-,
two-, and three-dimensional elements. Recall that it was convenient to introduce
local normalized coordinates, such as length, area, volume, and serendipity coor-
dinates. More specifically, length, area, and volume coordinates are used with
lineal, triangular, and tetrahedral elements, respectively. Serendipity coordinates
are used with lineal, rectangular, and brick elements. The use of these types of
coordinates is even more important when higher-order elements are used.
In this chapter several higher-order elements are described, and the shape
functions are given. Numerical integration methods are also presented. Recall further
from Chapter 6 that shape functions generally must meet the compatibility and
completeness criteria. All the shape functions presented in this section meet these
requirements. In addition, these shape functions are continuous, but their derivatives
are not necessarily continuous from one element to the next at the element bound-
aries. In other words, the shape functions presented here have CO-continuity only.
In this book, the only shape functions with C'-continuity were those derived
for the beam element in Sec. 7-5. When analyzing plates and shells, C'-continuity
is required because both deflection and slope continuity must be assured. The study
of higher-order shape functions with CI-continuity is beyond the scope of this text.
The interested reader may want to consult the book by Zienkiewicz [I].
The letter designations for the local node numbers (i.e., i. j, k, etc.) prove to
be cumbersome for the higher-order elements. Therefore, we will designate the
local node numbers as 1,2,3, etc., and the length, area, and volume coordinates
will be denoted L j • Lz, etc.

510
HIGHER-ORDER ISOPARAMETRIC ELEMENTS AND QUADRATURE
9-2
ONE-DIMENSIONAL ELEMENTS
Two higher-order one-dimensional elements can be created by adding one or two
nodes to the interior of the element as shown in Fig. 9-1. Recall that for the two-
node lineal element the shape functions were linear. This is reasonable because the
shape functions provide a convenient interpolation polynomial and a unique straight
line may be drawn through two points. We may refer to this element as the linear-
order lineal element. If we add one node to the lineal element such that it lies
halfway between the two original nodes, we can obtain a quadratic-order lineal
element. Note that either length or serendipity coordinates may be used. Similarly
adding two nodes such that the four nodes are equidistant yields a cubic-order lineal
element. The shape functions are given below in terms of the length coordinates
L, and L2. This is followed by the shape functions in terms of the serendipity
coordinate r.
Length Coordinates
Linear order (two nodes):
·1
_-------_.2
Ll~O
(a)
f-- ~-+-~----1
1 •
.2
o~r
(9-1)
f-+---l-+---1
f--+-+-+-j
•
•
•
•
•
1
3
2
3
2
0~L2
Ll~O
o~r
(b)
f-t+t+t-j
f-~+~+t-1
•
•
•
•
•
•
•
•
1
3
4
2
1
3~
2
0~L2
L 1---1 0
o
r
(e)
Figure 9-'
One-dimensional elements in terms of length coordinates L, and L2, and
serendipity coordinate r. (a) Linear order. (b) quadratic order, and (c) cubic order.

ONE-DIMENSIONAL ELEMENTS
SI1
Quadratic order (three nodes):
N I = L1(U1 -
I)
N2 = Li2L2 -
I)
N3 = 4L 1L 2
Cubic-order (four nodes):
N1
Y2 L1 (3L1 -
1)(3L1 -
2)
N2 =
Y2 L2 (3L2 -
1)(3L2 -
2)
Serendipity Coordinate
Linear-order (two nodes):
N I = V2(l -
r)
N2 =
V2(l + r)
Quadratic-order (three nodes):
N]
- Y2r(l -
r)
N 2 = V2r(1 + r)
N 3 = (l + r)(l -
r)
Cubic-order (four nodes):
N]
=
-0/144 (r -
1)(3r + 1)(3r -
I)
N 2 =
0/144 (3r + 1)(3r -
I)(r + I)
N 3 =
21148 (r + I)(r -
1)(3r -
I)
N4 =
-21148 (r + 1)(r -
1)(3r + I)
(9-2)
(9-3)
(9-4)
(9-5)
(9-6)
The shape functions for the lineal element are illustrated graphically in Fig.
9-2. Note how the shape function N; is unity at node i. Note also that two, three,
and four nodes allow linear-, quadratic-, and cubic-order interpolations. Indeed,
the shape functions themselves in Fig. 9-2(a) are linear, whereas they are quadratic
and cubic in Figs. 9-2(b) and (c), respectively.
The fact that the nodes must be equally spaced is significant. This restriction
is relaxed later in this chapter after isoparametric elements are introduced.

512
HIGHER-ORDER ISOPARAMETRIC ELEMENTS AND QUADRATURE
T
1
er:;.......--~1
2
(a)
Figure 9-2
Plot of the shape functions for the (a) linear order, (b) quadratic order, and
(c) cubic order one-dimensional elements.
9-3
TWO-DIMENSIONAL ELEMENTS
Inthis section, the triangular and rectangular elements from Chapter 6 are modified
so that some of the higher-order terms are represented in the corresponding parameter
functions. As in the one-dimensional higher-order element, the shape functions will
be seen to be higher-order as well.
The Triangular Element
The triangular element is in the unique position of being able to include complete
polynomials in the parameter function as the Pascal triangle in Fig. 9-3 shows.
Recall from Chapter 6 that for the linear-order or three-node triangular element we
assumed a polynomial that involves the first three terms in Fig. 9-3. A typical
parameter function <I> is represented by
(9-7)
where c,. C2. and C3 are constants. The position of the terms in the Pascal triangle
corresponds to the position of the nodes on the triangular element. The three-node
or linear-order triangular element is shown in Fig. 9-4(a).
The quadratic-order triangular element requires that the parameter function
contain the first six terms from the Pascal triangle with the nodes on the element
\ 1 It..
Figure 9-3
The Pascal triangle.

TWO-DIMENSIONAL ELEMENTS
513
arranged as shown in Fig. 9-4(b). Note that nodes 4, 5, and 6 are on the midsides
of legs 1-2,2-3, and 3-1, respectively. A typical parameter function in this case
is represented by
<l> =
C1 + CzX + C3Y + C4XZ + csXY + C6Yz
(9-8)
There are six constants in the parameter function and six nodes in the element. The
quadratic-order triangular element may also be referred to as the six-node triangular
element.
If Fig. 9-3 is examined carefully, it is seen that 10terms are needed to represent
a cubic-order parameter function, or
U =
CI + CzX + C3Y + C4XZ + Cyty + c6Yz
+ C7x3 + cgXZy + c<jX)'z + ClOy3
(9-9)
Note the position of the xy term in the Pascal triangle. Since it is in the interior of
the triangle, a node must be placed in the interior of the triangular element as shown
in Fig. 9-4(c). Infact, this node must be placed at the centroid of the triangle. The
remaining nodes are placed on the legs of the triangle such that each leg is divided
into three equal parts. Note that nodes 4 and 5 are located on leg 1-2, with node
4 closer to node I. Similar observations may be made about the nodes on the
remaining legs. Node 10 is the interior node.
The shape functions below assume the relative positions of the nodes are as
shown in Fig. 9-4. In Sec. 9-6, these restrictions are relaxed.
Linear-order (three nodes):
3
2
(a)
3
N, = L 1
Nz = Lz
N3 = L 3
2
(9-10)
Figure 9-4
The triangular element: (a) linear order, (b) quadratic order, and (c) cubic
order. Note the internal node (node 10) on the cubic-order element.

514
HIGHER-ORDER ISOPARAMETRIC ELEMENTS AND QUADRATURE
Quadratic-order (six nodes):
N] = LI(U)
I)
Nz = Lz(Uz -
I)
N) = L)(U)
I)
N4 = 4LILz
Ns = 4LzL)
N6 = 4L)L)
19-11)
Cubic-order (ten nodes):
N(
Yz L) (3LI
1)(3LI -
2)
Nz =
112 Lz (3Lz -
1)(3Lz -
2)
N)
Yz L) (3L)
I)(3L) -
2)
N4 = 0/2 LILz (3LI
I)
Ns
'liz LILz (3Lz
I)
N6 = 912 LzL) (3L2
I)
N7 = 0/2 LzL) (3L)
I)
Ng = 9/2 LIL) (3L)
I)
19-12)
N9 = 0/2 LIL) (3L]
I)
N IO = 27L]LzL)
The interior node (node 10) in the cubic-order element is not shared with any
other element. Therefore, before this element is assembled in the assemblage matrix
K", the node should be condensed by using the substructuring technique described
in Sec. 7-6. Node 10 is treated simply as an interior node, and the element without
this node becomes the superelement. The nodal value of the parameter function at
this (and other) interior nodes could be recovered as described in Sec. 7-6.
The Rectangular Element
Several higher-order rectangular elements are shown in Fig. 9-5. Note that addi-
tional nodes are added to the sides of the rectangle. For the quadratic-order element,
the midside nodes must be located midway between the comer nodes. For the cubic-
order element, the midside nodes must be located such that the nodes on each side
are equally spaced. In addition, the global x and y axes must be parallel to the local
rand s axes, respectively. In Sec. 9-6, all these restrictions are relaxed. The shape
functions are given below in terms of the serendipity coordinates rand s:
6
8
3
2
3
2
3
2
SLr
SLr
9
SLr
6
5
10
5
4
1
4
4
(a)
8
11
12
(b)
(e)
Figure 9-5
The rectangular (serendipity) element: (a) linear order, (b) quadratic order,
and (c) cubic order.

THREE-DIMENSIONAL ELEMENTS
515
Linear-order (four nodes):
N I =
\4(1 + r)(I -
s)
N3 =
Y4(1 -
r)(I + s)
Quadratic-order (eight nodes):
N I =
\4(1 +r)(I-s)(r-s-l)
N2 =
\4(1 + r)(I + s)
N4 =
\4(1 -
r)(I -
s)
N2 =
Y4(1 +r)(I +s)(r+s-l)
(9·13)
N3 = \4(1-r)(I +s)( -r+s-l)
N4 = Y4(1-r)(I-s)( -r-s-l)
(9-14)
Ns =
Yz(l +r)(I-sZ)
N7 =
Yz(l - r)(I - S2)
Cubic-order (12 nodes):
N6 = Yz(l- r 2)(1 + s)
Ng = Yz(l- r 2)(1 - s)
N I = !hz(l + r)(I -
s)[ - 10 + 9(rz + S2»)
N2 =
~3Z( I + r)(I + s)[ - 10 + 9(r2 + s2»)
N3 = Y3Z( I -
r)(I + s)[ - 10 + 9(r2 + S2»)
N4 = !hz(l -
r)(I -
s)[ - 10 + 9(r2 + S2))
Ns =
0/32(1 + r)(I -
S2)(I -
3s)
N6 = 9/32(1 + r)(I -
S2)(I + 3s)
(9-15)
N7 = 0/3Z(l + s)(I -
r 2)(I + 3r)
Ng = 9/3Z(l + s)(I -
r2)(1 -
3r)
N9 = 913z( I -
r)(I -
S2)( I + 3s)
N 10 =
0/32(1 -
r)( I -
S2)(I -
3s)
Nil = 913z(l -
s)( I -
r 2)(1 -
3r)
N I2 = o/.n(l -
s)(I -
r 2)(I + 3r)
9·4
THREE-DIMENSIONAL ELEMENTS
In Chapter 6, the tetrahedral and brick elements were presented. In this section,
these elements are modified so that some of the higher-order terms are represented
in the corresponding parameter functions. The shape functions are presented for
these elements in terms of volume coordinates for the tetrahedral element and
serendipity coordinates for the brick element.

516
HIGHER-ORDER ISOPARAMETRIC ELEMENTS AND QUADRATURE
The Tetrahedral Element
The tetrahedral element is similar to the triangular element in that it is also able to
include the complete polynomial in the parameter function. In Chapter 6, a typical
parameter function cP is represented by
(9·16)
for the four-node or linear-order tetrahedral element shown in Fig. 9-6(a). The
quadratic-order tetrahedral element requires that the parameter function be of the
form
cP =
CI + C~ + C3Y + C4Z + C~2 + C&XY
+ C7y2 + cgyz + Cl)Z2 + CIOZX
(9-17)
Note that 10 terms are needed, and hence 10 nodes are present in the corresponding
element as shown in Fig. 9-6(b). In a similar fashion, the cubic-order tetrahedral
element requires a parameter function with 20 terms, and hence the element has
20 nodes.
In the case of the quadratic-order element, nodes 5 to 10 are located midway
between the respective comer nodes as shown in Fig. 9-6(b). For the cubic-order
element, nodes 5 to 16 are located as shown in Fig. 9-6(c), where nodes 5 and 8
are placed such that leg 1-2 is divided into three equal segments. Similar comments
hold about the remaining midside nodes. Nodes 17 to 20 are located at the centroids
of faces 1-2-3, 1-3-4, etc. as shown in Fig. 9-6(c). Most of these restrictions are
relaxed in Sec. 9-7, where the isoparametric tetrahedral element is presented. The
shape functions are given below in terms of the volume coordinates for the tetra-
hedral elements.
Linear-order (four nodes):
(9-18)
'~- .
2LV
3
(a)
2
3
(bl
4
3
(e)
4
Figure 9-6
The tetrahedral element: (a) linear order, (b) quadratic order, and (c) cubic
order. Note that for the cubic-order element, nodes 17, 18, 19, and 20 are located at the
centroid of the respective faces of the tetrahedron.

THREE-DIMENSIONAL ELEMENTS
517
Quadratic-order (ten nodes):
N I = L I (2L] -
1)
N3 = L3 (2L3 -
1)
Ns = 4L IL2
N7 = 4L IL4
N9 =
4L~4
Cubic-order (twenty nodes):
N I =
Y2 L] (3L] -
1)(3LI
-
2)
N3 =
Y2 L3 (3L3 -
1)(3L3 -
2)
Ns = % L IL2 (3L] -
1)
N9 = % L]L3 (3L3
-
1)
Nil
= % L2L3 (3L2 -
1)
Nis = % L2L4 (3L4 -
1)
N 17 = 27LIL2L3
N I9 = 27L]L2L4
The Brick Element
N2 = L2 (2L2 -
1)
N4 = L4 (2L4 -
1)
N6 = 4L IL3
(9·19)
Ng = 4L2L3
N IO = 4L2L4
N2 = Y2 L2 (3L2 -
1)(3L2 -
2)
N4 = Y2 L4 (3L4 -
1)(3L4 -
2)
N6 = % L IL3 (3L] -
1)
Ng = % L1L2 (3L2 -
1)
N IO = 0/2 L]L4 (3L4 -
1)
(9-20)
N 12 = % L2L3 (3L3 -
1)
N]4 = 9/2 L~4 (3L4 -
1)
N]6 = % L2L4 (3L2 -
1)
N i g = 27L]L~4
N20 = 27L2L~4
The linear-, quadratic-, and cubic-order brick elements are shown in Fig. 9-7. Again
the midside nodes must be positioned such that the edges are divided into equal
segments. As mentioned in Chapter 6, the faces of the brick must line up with the
global coordinate system. In Sec. 9-7, these restrictions are relaxed. The shape
functions for these elements are given below in terms of the serendipity coordinates
r, s, and t.
Linear-order (eight nodes):
NI =
\Is(l + r)(l -
s)(l + t)
N2 = Ys (l + r)(l + s)(l + z)
N3 = Ys (l -
r)(l + s)(l + t)
N4 = \Is(l -
r)(l -
s)(l + t)(9-21)
Ns = Ys (l + r)(l -
s)(l -
t)
N6 = \Is(l + r)(l + s)(l -
t)
N7 = Ys (l -
r)(l + s)(l -
t)
N« = Ys (l -
r)(l -
s)(l -
t)

518
HIGHER-ORDER ISOPARAMETRIC ELEMENTS AND QUADRATURE
19
3
32
25
26
20
t21
st
2
I
t/-r
/t-----
18
,#
12
-- -.--
,'#/- 13
11
----
5
4
'
14
17
10
23
24
6
6
3
14
16
5
5
4
9
(a)
(bl
29
30
6
3
4
(e)
Figure 9·7
The brick element: (a) linear order, (b) quadratic order, and (c) cubic order.
Quadratic-order (20 nodes):
N 1 = Y8(\+r)(\ -S)(I +t)(r-s+t-2)
N2
Y8(1 +r)(\ +S)(I +t)(r+s+t-2)
N3
Y8(1-r)(I +s)(I +t)( -r+s+t-2)
N4
Ys(l-r)(\ -s)(I +t)( -r-s+t-2)
Ns
Ys(l+r)(\ -s)(I-t)(r-s-t-2)
N6 = Y8(\ +r)(I +s)(I-t)(r+s-t-2)
N7
Ys(l-r)(I +s)(I-t)( -r+s-t-2)
Ns
Y8(\-r)(I-s)(\ -t)( -r-s-t-2)
N9 =
Y4(1 - t2)(\ +r)(I- S)

THREE-DIMENSIONAL ELEMENTS
519
N IO =
Y4(1- r 2)(1 - S)(I- 1)
19-22)
NIl =
Y4(1- t2)(1- r)(I- S)
N 12 = Y4(1- r 2)(1 - S)(I + r)
N 13 = Y4(1- S2)(I + r)(I +t)
N I4 = Y4(1-s2)(I+r)(I-t)
Nss = Y4(1-s2)(I-r)(I-t)
N I6 = Y4(1- S2)(I- r)(I +t)
N 17 =
Y4(1 - t2)(1 + r)(I + S)
NIs = Y4(1- r 2)(1+S)(I- z)
N 19 =
Y4(1 - t2)(1 - r)(I + S)
N20 =
1,4(1- r 2)(1 + S)(I +t)
Cubic-order (32 nodes):
N I =
Y64(1 +r)(I - s)(I + t)[9(r2+ S2+ t2) - 19]
N2 =
Y64(1 +r)(I + s)(I + t)[9(r2+s2 +t2) - 19]
N3 =
Y64(1- r)(I +s)(I +t)[9(r2+S2+ t2) - 19]
N4 =
Y64(1 - r)(I- s)(I + t)[9(r2+s2 +t2) - 19]
Ns =
Y64(1 +r)(I-s)(I-t)[9(r2+s2+t2)-19]
N6 =
Y64(1 +r)(I +s)(I - t)[9(r2+S2+ t2) - 19]
N7 =
Y64(1 - r)(I +s)(I - t)[9(r2+S2+ t2) - 19]
Ns =
Y64(1 - r)(I - s)(I - t)[9(r2+ S2+ t2) - 19]
N9 = 0/64(1-t2)(1 +3t)(I-s)(I +r)
N IO =
0/64(1 - t2)(1- 3t)(I- s)(I +r)
Nil =
9/64(1 - r 2)(1 + 3r)(I- s)(I- t)
N 12 = 0/64(1- r 2)(1 - 3r)(I- s)(I- t)
N 13 = 0/64(1- t2)(1- 3t)(I - s)(I- r)
NI4 = 0/64(1- t2)(1 + 3t)(I- s)(I- r)
N is =
9/64(1 - r 2)(1 - 3r)(I- s)(I +t)

(9-23)
520
HIGHER-ORDER ISOPARAMETRIC ELEMENTS AND QUADRATURE
N 16 = 0/64(1-r2)(I+3r)(I-s)(I+t)
NI7 = 0/64(1- S2)(I - 3s)(I + r)(I + t)
NI8 = %4(1-s2)(I+3s)(I+r)(I+t)
N 19 = 0/64(1-s2)(I-3s)(I +r)(I-t)
N20 = 0/64(1-S2)(I +3s)(I +r)(I-t)
N21 = 0/64(1 - S2)(I - 3s)(I - r)( I - t)
N22 = 0/64(1-S2)(I+3s)(I-r)(I-t)
N23 =
0/64(1 - S2)(I- 3s)(I- r)(I + t)
N24 = 9/64(1-S2)(I+3s)(I-r)(I+t)
N25 = 9/64(1 - t2)(1 + 3t)(I + S)(I + r)
N26 = 0/64(1 - t2)(1 - 3t)(I + S)(I + r)
N27 =
0/64(1 - r 2)(1 + 3r)(I + S)(I- t)
N28 = 0/64(1-r2)(I-3r)(I+s)(I-t)
N20 =
0/64(1 - t2)(1- 3t)(I + S)(I- r)
N30 = 0/64(1 - t2)(1 + 3t)(I + S)( I - r)
N31 = 9/64(1-r2)(I-3r)(I +S)(I +t)
N32 = 0/64(1- r2)(1 + 3r)(I + S)(I + t)
It should be noted that when t = ± I, the above shape functions reduce to the
corresponding two-dimensional shape functions. Therefore, these particular ele-
ments may join a similar-order rectangular or lineal element as shown in Fig.
9-8 for the quadratic-order element.
9·5
SUBPARAMETRIC, ISOPARAMETRIC, AND SUPERPARAMETRIC
ELEMENTS
As discussed below, it is relatively easy to distort elements. In particular, the
distorted rectangular and brick elements can be used to accommodate practically
any geometry. For example, let us take the quadratic-order rectangular element and
modify it to a distorted quadrilateral element as shown in Fig. 9-9. Note that the
nodes can be used for two purposes: One is to specify the locations where the
parameter function is sought (i.e., the nodal displacements, temperatures, etc.),

SUBPARAMETRIC, ISOPARAMETRIC, AND SUPERPARAMETRIC ELEMENTS
521
I+
I
I
I
I
-_...._--
----
(a)
(b)
(e)
Figure 9-8
A typicalface of the (a) brickelementinterfaces readilywith the two-dimen-
sional rectangular element in (b), which in tum interfaces with the (c) one-dimensional
element.
and the other purpose is to define the geometry of the element. Note in Fig. 9-9
that a quadratic-order curve may be passed through three points (i.e., the nodes on
anyone side of the quadrilateral). Thus, it appears to be possible to include curved
boundaries explicitly in the FEM formulations. The geometry of the boundaries is
approximated by polynomials of finite order, and so the boundaries are not exactly
represented in general. However, by using more nodes (or smaller elements), we
can approach the actual curved boundary to a high degree of accuracy.
The isoparametric element is now defined as follows with the help of Fig.
9-1O(a). When the same nodes are used to define the element geometry and the
locations where the parameter function is sought, the element is said to be isopar-
ametric.
When the number of nodes used to define the geometry is less than the number
used to represent the parameter function as shown in Fig. 9-1O(b), the element is
said to be subparametric. Finally, when the number of nodes used to define the
(b)
3
5
6
8
(a)
4
3_----_----.....2
7
Figure 9-9
The quadraticcorder rectangular element shown in (a) may be distorted into
the quadratic-order quadrilateral element shown in (b). Note the curvedelementboundaries
in (b).

522
HIGHER-ORDER ISOPARAMETRIC ELEMENTS AND QUADRATURE
geometry is greater than the number used to represent the parameter function as
shown in Fig. 9-IO(c), the element is said to be superparametric. Isoparametric
and subparametric elements are used quite frequently in finite element analysis,
whereas superparametric elements are rarely used.
Let us illustrate how we can distort an element into a more useful shape. For
this purpose let us concentrate on the linear-order element shown in Fig. 9-11. Note
that by distorting the rectangle in Fig. 9-II(a) into a quadrilateral, we may now
(a)
Ib)
(c)
Figure 9·10
(a) isoparametric elements, (b) subparametric elements, and (c) superpara-
metric elements. Note that. specifies the locations where the values of the parameter function
are sought and that 0 specifies the geometry.

SUBPARAMETRIC. ISOPARAMETRIC, AND SUPERPARAMETRIC ELEMENTS
523
3_------.....2
4_------...
(b)
4
(a)
Figure 9·11
The linear-order rectangular elementshown in (a) may be distorted into the
linear-order quadrilateral element shown in (b).
place the nodes at more convenient locations. Thus, irregular geometries may be
accommodated. Actually there are some restrictions on the placement ofthese nodes.
These restrictions are delineated in subsequent sections.
We should be quite familiar by now with representing the parameter functions
in terms of the nodal values with the help of the shape functions. For example, let
us represent the temperature T within the element shown in Fig. 9-ll(b) as
T = NIT I + N2T2 + N3T3 + N4T4
Let us also represent the two global coordinates (r.y) as follows:
x = N;xI + N2h + Nix3 + N~X4
and
19-24)
19-25a)
19-25b)
where N;. N;. etc. represent the shape functions used to define the geometry and
Xl. Yl. etc. are the nodal coordinates. Since the same nodes in Fig. 9-II(b) are
being used to define the geometry and the parameter function nodal points, we
have an isoparametric element. For this and all other isoparametric elements, the
shape functions N; and N; are equal. In other words, the same shape functions are
used to define the geometry and the parameter function. Therefore, we have
N; = N;
for all nodal points i
It is of interest to note that if Eqs. (9-25) are evaluated at a particular node,
for example, node 2, we get
X =
X2
and
Y = Y2

S24
HIGHER-ORDER ISOPARAMETRIC ELEMENTS AND QUADRATURE
because N2(X2'Y2) = 1, whereas N 1(X2.Y2 ) = N3(X2'Y2) = N4(X2.Y2) = O. Clearly
this must be the result if the equations given by Eqs. (9-25) are to be meaningful.
Equations (9-25) can be generalized for all isoparametric elements by writing
n
X = 2: NjX;
(9-268)
i=l
n
Y = 2: N;)i;
(9-26b)
i= 1
where the N;'s are the shape functions, (x;.y;) denotes the coordinates of node i,
and n is the number of nodes associated with the element.
Equations (9-26) are very powerful in that they allow us to map any point in
the (local) coordinate system to a point in the (r.y) coordinate system. Therefore,
Eqs. (9-26) are said to provide an isoparametric mapping from the undistorted
element to the distorted element. Undistorted elements may also be referred to as
parent elements. In subsequent sections, the conditions will be given such that we
are assured of a unique or one-to-one mapping. This is to say that a point in the
parent element should map into one and only one point in the distorted element
(and vice versa). This will enable us to take a distorted element and map it into an
undistorted element for the purpose of evaluating the integrals that naturally arise.
In Sec. 9-6, the two-dimensional isoparametric elements are developed further.
In Sec. 9-7, the three-dimensional isoparametric elements are presented. In each
case, the explicit form of the mapping is given.
Example 9-1.
Consider the four-node quadrilateral element defined by the following nodal co-
ordinates: XI = 5., YI = 7., X2 = I., Y2 = 4., X3 = 2., Y3 = I., X4 = 8., and
Y4 = 4. Determine the global coordinates that correspond to r = + 1.0 and s =
+0.75 on the parent element.
Solution.
From Eqs. (9-26) and (9-13), we have
x= 1/;.(1 + r)(I
-
s)x l + 14(1 + r)(I + S)X2
+ 14(1 -
r)(I + S)X3 + Y4 (I -
r)(I
-
S)X4
and
Y = 14(1 + r)(I
-
S)YI + Y4 (1 + r)(I + s)Y2
+ Y4 (1
r)(I + S)Y3 + Y4 (1
-
r)(1
-
S)Y4
Substituting the values of the nodal coordinates gives
X = %(1 + r)(I -
s) + 14(1 + r)(I + s)
+ 1'4 (I -
r)(l + s) + % (1
-
r)(l -
s)

TWO-DIMENSIONAL ISOPARAMETRIC FORMULATIONS
525
and
y =
714 (1 + r)(1
-
s) + % (l + r)(1 + s)
+ Y4 (1- r) (1 + s) + % (1 -
r)(1
-
s)
Now we are in a position to perform the actual mapping:
x =
Y4(l + 1)(1 -
0.75) + Y4 (1 + 1)(1 + 0.75)
+ ¥4(l -
I)(l + 0.75) + %(1 -
1)(1 -
0.75)
and
y =
714 (1 + 1)(1 -
0.75) + % (1 + 1)(1 + 0.75)
+ Y4 (1
l)(1 + 0.75) + % (1
1)(1 -
0.75)
or
x = 1.500
and
y = 4.375
The parent element should be plotted on a piece of graph paper in order to verify
that (1.5, 4.375) is on the element boundary. More specifically, this point is located
between nodes I and 2. Why does this seem reasonable?
•
9-6
TWO-DIMENSIONAL ISOPARAMETRIC FORMULATIONS
In Sec. 9-5 we have seen how it is possible to distort an element in order to give
it a more arbitrary shape. In this section we want to show how the element stiffness
matrix and element nodal force vectors are transformed for the two-dimensional
isoparametric elements into those for the undistorted element. The reason for this
transformation is to simplify the resulting integrations. If the integrands contain the
shape functions directly (i.e., not the derivatives), then we simply represent the
shape functions in terms of the appropriate normalized coordinates. No additional
transformation is necessary in order to evaluate the integrals in this case (see Sec.
9-8).
Both the triangular and quadrilateral element are considered. The quadrilateral
element is considered first because it is described by two independent coordinates
rand s. It should be recalled that the three area coordinates used to describe the
triangular element are not all independent; this will require some additional special
attention.
The Quadrilateral Element
Figure 9-12 shows the isoparametric forms of the rectangular element. Both the
parent (rectangular) and distorted quadrilateral elements are shown. Note that for
the linear-order distorted element both the parameter function and the sides of the

526
HIGHER-ORDER ISOPARAMETRIC ELEMENTS AND QUADRATURE
Order
Linear
Quadratic
Cubic
Parent element
Distorted element
-------L
/
--
/
r
/
/
/
/
SL
_------ I
r
\
I
I
I
I
Figure 9-12
The isoparametric quadrilateral elements.
quadrilateral are linear; for the quadratic-order distorted element both the parameter
function and the sides of the element are of quadratic order; for the cubic-order
distorted element both the parameter function and the sides of the element are cubic
order.
It should be recalled from Chapters 5 and 8 that typical, two-dimensional
element stiffness matrices are given by Eqs. (5-87) and (8-106) for problems in
stress analysis and heat transfer, respectively. Recall that the derivatives of the
shape functions frequently appear in the integrands. If we wish to perform the
integrations over the undistorted element, the integrals must be transformed into
ones that contain only rand s (instead of x and y). This is accomplished as described
below.
Let us first note that we have the shape functions in terms of the serendipity
coordinates rand s for the parent elements as given in Sec. 9-3. Let us work with
a typical shape function, for example, the ith, and note that
r = r(x,y)
s = s(x,y)
and
N; = N;(r,s)

TWO-DIMENSIONAL ISOPARAMETRIC FORMULATIONS
527
Therefore, we may write the total derivatives of N; as
aNi
aN; ax
aN; ay
-=--+--
ar
ax ar
ay ar
and
aN,
aN, ax
aN, ay
-=--+--
as
ax as
ay as
Let us write these last two equations in matrix form as
[
aNi]
[ax
a
y]
[aNi]
ar
ar
ar
ax
aN,
-
ax
ay
aNi
as
as
as
ay
(9-27a)
(9-27b)
(9-28)
The 2 x 2 matrix on the right-hand side is known as the Jacobian matrix and is
denoted by J, or
[
ax
J =
arax
as
a
y]
ar
ay
as
(9-29)
The reader may recall from calculus [2] that an infinitesimal area element dx dy is
related to an infinestimal area element in the (r,s) coordinate system by
dx dy = [detJI dr ds
(9-30)
(9-31)
In Eq. (9-30), the determinant of the Jacobian matrix is indicated. This determinant
is referred to simply as the Jacobian. If Eq. (9-28) is premultiplied by J- t , we get
the desired result
[:~:]
= [E ;]-
I [:f:]
ay
as
as
as
Let us examine the Jacobian matrix more carefully. Since we have an isopar-
ametric element, we may write [see Eqs. (9-26)]:
x = 2: Njxj
(9-32a)
and
(9-32b)
where the summations are made over the total number of nodes present in the
element, and Xj and Yj are the coordinates of the nodes. Therefore, the Jacobian
matrix becomes

528
HIGHER-ORDER ISOPARAMETRIC ELEMENTS AND QUADRATURE
(9-33)
Note that for the Iinear-, quadratic-, and cubic-order elements, the summations
involve four, eight, and twelve terms, respectively. With the help of Eqs. (9-30),
(9-31) and (9-33), every integral over the element area A' may be transformed into
an integral of the form
or
J+IJ+I
K' =
-I
-I H(r,s) dr ds
J+!J+I
f' =
_ I
_ 1 g(r,s) dr ds
(9-34a)
(9-34b)
Note that the integration limits also change. InSec. 9-8, we will see that integrals
in these forms may be evaluated numerically.
It should be noted that the size of the element stiffness matrix is directly related
to the order of the element as shown in Table 9-1. Note that a two-dimensional
stress analysis problem analyzed with the cubic-order isoparametric, quadrilateral
element has an element stiffness matrix that is of size 24 x 24. In this case, each
node has 2 degreees of freedom and there are 12 nodes; thus the stiffness matrix
is 24 x 24. Since the corresponding heat transfer problem has I degree of freedom
per node, the element stiffness matrix is of size 12 x 12 for the cubic-order element.
Recall that integrations around the element boundary result in integrals of the
form
{ WsdS
ls,
and
{
NThNt de
Je-
The first is recognized as the element nodal force vector from surface tractions,
and the second is recognized as the element stiffness matrix from convection from
the boundary of a two-dimensional body. In the case of the integral for the traction,
the elemental area dS around the boundary may be expressed as
Table 9-1
Size of the Element Stiffness Matrices for the Quadrilateral Elements
Order of element
Linear
Quadratic
Cubic
Structural
(2 DOF per node)
8 x 8
16 x 16
24 x 24
Thermal
(I OOF per node)
4 x 4
8 x 8
12 x 12

TWO-DIMENSIONAL ISOPARAMETRIC FORMULATIONS
529
dS = t dC
(9-35)
where t is the element thickness and dC is the infinitesimal arc length. From calculus,
dC is given by
(9-36)
since we have x = x(r,s) and y = y(r,s), we may write the differentials dx and dy
as:
and
ax
ax
dx = -
dr + -
ds
ar
as
ay
ay
dy=-dr+-ds
ar
as
(9-37a)
(9-37b)
where rand s are the serendipity coordinates. The boundary integrals need to be
evaluated around the element boundary.
Let us derive the appropriate form of the expression for dC by restricting the
development to the legs of the element over which the serendipity coordinate s is
constant; i.e., s =
± I on these faces. Therefore with the help of Eqs. (9-32), we
may write Eqs. (9-37) as
and
ax
'" aNj
dx = -
dr = LJ -
x· dr
ar
ar
J
ay
"
aNj
dy = -
dr = LJ -
Y dr
ar
ar
J
(9-38a)
(9-38b)
on faces where s =
± I. A typical side (side 2-3) of a quadrilateral element for
which Eqs. (9-38) apply is shown in Fig. 9-13. The elemental surface area dS or
t dC on sides of constant s becomes
dS=tdC=t (2: aNj X)2 + (2: aNj y)2 dr
ar
J
ar
J
(9·39)
Figure 9·13
Typical quadrilateral element with leg 2-3 on the global boundary. Note that
s = + I on this leg.

S30
HIGHER-ORDER ISOPARAMETRIC ELEMENTS AND QUADRATURE
In a similar fashion, it can be shown that on faces of constant r (i.e., faces 1-2
and 3-4), the elemental surface area dS is given
dS=tdC=t
(9-40)
The serendipity coordinate S (a scalar) should not be confused with the surface
traction s (a vector). Therefore, when these expressions for dS or t dC are substituted
into typical boundary integrals, we get integrals of the form
or
fe =
(
NT s dS = JI
g(r,s) 1
dr
)s..
~ 1
J=:!: I
x- = (
NThNt dC = JI
H(r,s) I
dr
)C-
-I
s= ± t
(9-41)
(9-42)
on faces of constant serendipity coordinate s. Similar integrals result when faces
of constant r are on the global boundary except that the integrands are evaluated
at r =
± I before integrating with respect to s.
The integrals in Eqs. (9-34), (9-41), and (9-42) look formidable. However,
they may be evaluated in a relatively straightforward manner by using Gauss-
Legendre quadrature as described in Sec. 9-8.
The degree of distortion that is possible before the mapping breaks down (and
is no longer one-to-one) is now given. For a linear-order quadrilateral element, a
one-to-one mapping is assured if the maximum angle formed by any two sides of
the quadrilateral is less than 180
0 as shown in Fig. 9-14(a). For a quadratic-order
quadrilateral element, not only must the same angle condition be satisfied but also
the midside nodes must be in the middle one-third of the distorted sides. This
condition is illustrated in Fig. 9-14(b). For cubic and other higher-order elements,
no such simple conditions apparently exist and the necessary and sufficient condition
for a one-to-one mapping is stated as follows: for a one-to-one mapping, the sign
of the Jacobian (the determinant of the Jacobian matrix) must remain the same for
all points in the domain mapped [3). For cubic and higher-order elements, it is not
practical to check the sign of the Jacobian at every point within the element. Instead,
a few points are checked as explained later.
The Triangular Element
The isoparametric forms of the triangular element are shown in Fig. 9-15. Note
that both the parent and distorted elements are shown. As in the case of the rec-
tangular element, the number of nodes on each leg of the triangle determines the
order of element (two, three, and four nodes on a leg for linear-, quadratic-, and
cubic-order, respectively). Note how a quadratic-order curve may be drawn through
three points (i.e., the nodes), and a cubic-order curve through four points.

(a)
TWO-DIMENSIONAL ISOPARAMETRIC FORMULATIONS
531
E:::jird
zone
(b)
Figure 9-14
For the linear-order quadrilateral element in (a) each internal angle must be
less than 180
0 for a unique mapping. For the quadratic-order quadrilateral element in (b)
each internal angle must be less than 180
0 and the midside nodes must be within the middle
one-third of each leg.
Order
Linear
Quadratic
Cubic
Parent element
Distorted element
Same as the
parent element
Figure 9-15
The isoparametric triangular elements.

532
HIGHER-ORDER ISOPARAMETRIC ELEMENTS AND QUADRATURE
The development in this section is very similar to that in the previous section
for the quadrilateral element, except that the local, normalized coordinates are area
coordinates. not serendipity coordinates. It should be recalled that the three area
coordinates are not all independent because they must sum to unity [see Eq.
(6-23)]. This may be taken into account by taking L1 and Lz to be the independent
coordinates. The fact that L) is dependent (on LI and Lz) is explicitly taken into
consideration later. Therefore, we may write
L I = LI(x.y)
Lz = Lz<x.y)
and
from which it follows that
aNi
aNi~ + aNi .!!I.
aLI
ax aLI
ay aLI
and
aN;
aN; ax
aNi ay
-=--+--
«,
ax aLz
ay aLz
In matrix form, we have
(9-438)
(9-43b)
Now the Jacobian matrix J is defined by
l
ax
J =
aLI
ax
aLz
from which it follows that
(9-44)
(9-45)
l
a~i]
aNi
ay
(9-46)
Note that the partial derivatives of the shape functions N, are needed in the
column vector on the right-hand side of Eq. (9-46). Recall that we have assumed
N; to be a function of L I and Lz only, since L) is then dependent on L I and Lz by
Eq. (6-23). This implies that in the computations of aN/aLI and aN/aLz, we must
substitute

TWO-DIMENSIONAL ISOPARAMETRIC FORMULATIONS
533
L 3 = 1 - LI
-
L2
(9-47)
into the shape functions N; before computing these partial derivatives. For higher-
order elements this approach is very tedious; fortunately, there is an easier way.
Let us denote the partial derivative of N; with respect to L I as
(aN)
aL:
L2.L,
where the shape function N; is now a function L,. L2• and L3 , but L2 and L3 are
held constant in performing the differentiation. The notation
aN;
aLI
implies N; is a function of L, and L2 , and L2 is held constant [the L2 is not written
since it is not written in Eq. (9-46)]. It follows that
CJN;
aLI (aN;)
aL2 (aN;)
aL3 (aN;)
(9-48)
aLI = aLI
aLI
L2.L, + aLl
aL2
LI.L, + aLI
aL3
LI.L2
and since
we have
-1
(9-49)
Here N, is taken to be a function of L,. L2•
and L,
aN
(aN.)
(aN)
aL:
=
aL:
L2.L,
-
aL;
L,.L2
---
--...-.-
Here N, is taken to be a
function of L I and L2 as
required by Eq. (9-46)
In a completely analogous manner it follows that
(9-50)
(9-51)
aN
(aN)
(aN)
aL~ =
aL~
L"L,
-
aL;
L I.L2
Equations (9-50) and (9-51) make it unnecessary to get N; as a function of only L,
and L2 before computing the partial derivatives on the right-hand side of Eq.
(9-46).
The Jacobian matrix may be cast into a more usable form by writing
(9-52)

S34
HIGHER-ORDER ISOPARAMETRIC ELEMENTS AND QUADRATURE
where the partial derivatives can be computed with help of Eqs. (9-50) and (9-51).
Note that for the linear-, quadratic-, and cubic-order triangular elements, the sum-
mations are made over three, six, and ten terms, respectively. From elementary
calculus it follows that
dx dy = [det JI dl., dL2
(9-53)
It also follows that typical element stiffness matrices and nodal force vectors may
be cast into the form
(9-54)
and
(9-55)
These integrals are in a form that may be integrated relatively easily as shown
in Sec. 9-9. The resulting sizes of the element stiffness matrices for linear-, quad-
ratic-, and cubic-order elements are given in Table 9-2. Note that the element
stiffness matrices for stress analysis and heat transfer are 20 x 20 and 10 x 10,
respectively, if the cubic-order element is used.
The transformation of boundary integrals (i.e., over S" or C') is left to the
exercises. As in the case of the quadrilateral element, the necessary and sufficient
condition for a one-to-one mapping is that the sign of the Jacobian remain the same
for each point in the domain mapped.
9·7
THREE-DIMENSIONAL ISOPARAMETRIC FORMULATIONS
In this section the brick and tetrahedral elements are distorted into more general
shapes. However, the resulting integrations are to be done in the undistorted region.
The brick is considered first because the three local normalized coordinates r, s,
and t associated with such an element are all independent. In contrast, the four
volume coordinates (now L!. L2• L3 , and L4 ) associated with the tetrahedral element
are not all independent. As in the two-dimensional isoparametric formulation, this
will require a little more attention.
Table 9-2
Size of the Element Stiffness Matrices for the Triangular Elements
Order of element
Linear
Quadratic
Cubic
Structural
(2 DOF per node)
6 x 6
12 x 12
20 x 20
Thermal
(I DOF per node)
3 x 3
6 x 6
10 x 10

THREE-DIMENSIONAL ISOPARAMETRIC FORMULATIONS
535
The Brick Element
The isoparametric forms of the brick element are shown in Fig. 9-16. For the linear-
order distorted brick, the four points used to define a face must lie in a plane. Note
that the Iinear-, quadratic-, and cubic-order elements have two, three, and four
nodes, respectively, along each of the edges.
As in the two-dimensional case, it is necessary to evaluate the element stiffness
matrices and nodal force vectors for these elements. However, it is very desirable
to perform the integrations in the parent element, as explained in Sec. 9-8. Let us
show how the integrals for the element characteristics may be transformed into ones
over the undistorted or parent regions.
Recall from Sec. 9-4 that the appropriate shape functions for the parent elements
are given by Eqs. (9-21) to (9-23) in terms of the serendipity coordinates r, s, and
t. Let us take a typical shape function, e.g. the ith, and denote its dependence on
r, s, and t by writing
N, = N;(r,s,t)
But we also have
r = r(x,y,z)
S = s(x,y,z)
t(x,y,z)
Order
Parent element
Distorted element
Linear
I
I
I
I
--....-........-...
I•I
I
--....
................
---....
Cubic
Quadratic
Figure 9-16
The isoparametric brick elements.

(9-56c)
(9-568)
(9-56b)
536
HIGHER-ORDER ISOPARAMETRIC ELEMENTS AND QUADRATURE
where x, y. and z are the global coordinates. The total derivatives of a typical shape
function N; are given by
aN;
aN; ax
aN; ay
aN; az
-=--+--+--
ar
ax ar
ay ar
az ar
aN;
aN; ax
aN; ay
aN; az
-=--+--+--
as
ax as
ay as
az as
aN; __ aN; ~
aN; ay
aN; az
+--+--
at
ax at
ay at
az at
Rewriting Eqs. (9-56) in matrix form gives
aN;
ax
~
az
aN;
ar
ar
ar
ar
ax
aN;
ax
~
az
aN;
as
as
as
as
ay
aN;
ax
~
az
aNi
at
at
at
at
az
Now a 3 x 3 Jacobian matrix arises and with the help of
x = 2: Njxj
y = 2: NjYj
z = 2: NjZj
we may write the Jacobian matrix as
2: aNj x
2: aNj
2: aNj z,
ar
J
ar Yj
ar
J
2: aN
2: aNj
2: aNj z,
J =
_J x.
as
J
as Yj
as
J
2: aNj x
aN
2: aNj z.
2: a/ y}
at
J
at
J
(9-57)
(9-58)
where x}. y}, and z} denote the global coordinates of the jth node. The summations
in Eq. (9-58) are made over the 8, 20, and 32 nodes for the linear-, quadratic-,
and cubic-order elements, respectively.
If Eq. (9-57) is premultiplied by the inverse of the Jacobian matrix, we get the
desired result:
aNi
2: aNj x
2: aN}
2: aN} z.
-)
aN;
ar y}
-
ax
ar
J
ar
J
ar
aN;
2: aN}x
2: aN}
2: aN} z
aNi
(9-59)
-
as v,
-
ay
as
J
as
J
as
aN;
2: aNj x
2: aN}
2: aN} z.
aN;
-
iiY}
-
az
at
J
at
J
at

THREE-DIMENSIONAL ISOPARAMETRIC FORMULATIONS
537
Equation (9-59) is useful because it may be used to replace derivatives of the form
aN;lax, aN;lay, and aN;laz with expressions involving aNi/ar, aN;las, and aN;lat.
The elemental volume dx dy dz may be written in terms of dr ds dt by noting that
dx dy dz = [det JI dr ds dt
(9-60)
Therefore, the element stiffness matrices and nodal force vectors may be written
in the form
and
K" = [[[HCr,s,t)drdsdt
r- = [[ [g(r,s,t) dr ds dt
(9-61)
(9-62)
The simple integration limits should be noted. These integrals may be evaluated
by the numerical integration technique described in Sec. 9-8.
The element stiffness matrices can become quite large for these elements as
Table 9-3 shows. Note that for the cubic-order element, the element stiffness
matrices are 96 x 96 and 32 x 32 for problems in stress analysis and thermal
analysis, respectively. The numerical integration technique described in Sec. 9-8
makes the use of these elements practical.
Table 9-3
Size of the Element Stiffness Matrices for the Brick Elements
Order of element
Linear
Quadratic
Cubic
Structural
(3 DOF per node)
24 x 24
60 x 60
96 x 96
Thermal
(\ DOF per node)
8 x 8
20 x 20
32 x 32
It will now be shown how the integrals over the element surfaces S" may be
transformed into ones over the faces on the parent element. The integrands may be
converted directly to functions of r, s, and t in a straightforward manner, since the
shape functions are already known as a function r, s, and t. It should be noted"
however, that on any given face, one of the serendipity coordinates is plus or minus
unity. For example, on face 1-5-6-2, we have r = + I, whereas on face 5-6-7-8,
we have t =
- I, and so forth. Therefore, on face 1-5-6-2, the integrations are
performed over sand t only (since r = + I on this face).
The only part of the integrals over S' that requires special attention is the
elemental surface area dS. Let dA represent the outward normal area vector to a
surface of constant serendipity coordinate, i.e., on one of the faces of the brick.
For example, let us assume that face 1-2-3-4 is on the global boundary. On this
face t = + I and it can be shown that dA, in this case, is given by [4]

538
HIGHER-ORDER ISOPARAMETRIC ELEMENTS AND QUADRATURE
( ax .
ay.
az)
(ax
ay
az)
dA =
-I + - J + - k
x
- i + - j + - k
dr ds
ar
ar
ar
as
as
as
(9-63)
where the vector cross product is used and may be evaluated by writing it in
determinant form as follows
dA
det
ax
ar
j
k
~
az
ar
ar
dr ds
(9-64)
ax
~
az
as
as
as
The magnitude of dA is actually dS, and so we have
dS =
(~ ~ _ ay ~)2 +c:_
~ ~)2 +
ar as
as ar
ar as
as ar
(~ ay _ ~ ay) 2 dr ds
ar as
as ar
(9-65)
where we may further note that
ax
2: aN; x
ax = 2: aNjx
-
ar
ar
J
as
as
J
ay
2: aN;
ay
2: aNj
(9-66)
ar
i:»
as
as Yj
az
2: aNjz
az
2: aNj
-
-z
ar
ar
J
as
as
J
Clearly dS may be written as a function of only r, s, and t and the nodal coordinates
if Egs. (9-65) and (9-66) are used. Note that Eq. (9-65) holds on surfaces of constant
t (such as t =
I or t =
- I). If integrations over surfaces of constant s (or constant
r) are desired. then an expression analogous to Eq. (9-65) may be written by
inspection or easily derived. Therefore, integrals over a face of the element may
be converted to integrals of the form
and
J+IJ+I
I
Ke=
_I
_IH(r,s,t)r:+ldrds
J+IJ+I
I
f
e
=
-I
_lg(r,s,t)t~+Jdrds
(9-67)
(9-68)
if the face over which t = + I is on the global boundary. Similar integrals result
if the other faces are on the global boundary. Again, numerical integration of these
integrals is necessary as explained in Sec. 9-8.

THREE-DIMENSIONAL ISOPARAMETRIC FORMULATIONS
539
As in the two-dimensional case, the necessary and sufficient condition for a
one-to-one mapping is that the sign of the Jacobian must remain the same for all
points in the domain that is mapped. Obviously it is not practical to check every
point. Instead, a few select points are used as explained later.
The Tetrahedral Element
Figure 9-17 shows the isoparametric forms of the tetrahedral element. Note that
the linear-, quadratic-, and cubic-order elements have 2, 3, and 4 nodes, respec-
tively, on each edge of the tetrahedral element. Again we must convert integrals
over a complicated distorted element to integrals over an undistorted parent element.
This is easily accomplished if the integrals in terms of the global coordinates (x.y.z)
are transformed into integrals in terms of L 1, L2 , L3, and L4 (the volume coordinates).
The development is similar to that for the triangular element, except that an ad-
ditional coordinate (L4 ) needs to be considered. Now L4 is taken to be the dependent
coordinate related to the others by
Order
Parent element
Distorted element
/9-69)
Linear
Quadratic
Cubic
Same as the
parent element
Figure9-17
The isoparametric tetrahedral elements.

540
HIGHER-ORDER ISOPARAMETRIC ELEMENTS AND QUADRATURE
Therefore, a typical shape function, e.g., the ith, may be written as a function of
LI, L2, and L3, or
But we also have
L, = LI(x,y,z)
L2 = L2(x,y,z)
and
L3 = L3(x,y,z)
Therefore, the total derivatives are given by
aN;
aN; ax
aN; ay
aN; az
-=--+--+--
aLI
ax aLI
ay aLI
az aLI
aN; ax
aN; ay
aN; az
--+--+--
ax aL2
ay «,
az aL2
aN;
aN; ax
aNi ay
aN; az
-=--+--+--
aL3
ax aL3
ay aL3
az aL3
These three equations may be written in matrix form as
aN;
ax
~
az
aN;
-
-
aLI
aLI
aLI
aLI
ax
aN;
ax
ay
az
aN;
-
-
aL2
riL2
aL2
aL2
ay
aN;
ax
ay
riz
aNi
-
-
aL3
aL3
aL3
aL3
az
Again a 3 x 3 Jacobian matrix arises and with the help of
x = LN)x)
Y = LN)y;
z = LN)z)
the Jacobian matrix is given by
LaN) x
LaN) v
LaN)
-z
aLI 1
aLI ~)
aLI 1
LaN) x
aN
LaN) z
J
L-1v
aL2 1
aL2" )
aL2 1
LaN) x
LaN) v
LaN) z.
aL3 1
aL
~j
aL3 1
3
(9-70)
(9-718)
(9-71b)
(9-71c)
(9-72a)
(9-72b)
(9-72c)
(9-73)
(9-74)
where x), y), and z) denote the global coordinates of the jth node. The summations
in Eq. (9-74) are made over the 4, 10, and 20 nodes for the Iinear-, quadratic-,
and cubic-order elements, respectively.

19-76)
THREE-DIMENSIONAL ISOPARAMETRIC FORMULATIONS
541
If Eq. (9-73) is premultiplied by the inverse of the Jacobian matrix, we get the
following useful result:
-,
aN;
2:
aNj
x
aN
2: aNjz
aNj
2: aL~ Yj
-
ax
aLI
j
aLl
j
aLl
aN;
2:
aNj
x
aN
2: aNjz
aN;
2: aL~Yj
-
19-75)
ay
aLz
j
aLz
j
aLz
aNj
2: aNjx
2: aN;
2: aNjz
aN;
aL)Yj
-
az
aL)
j
aL) j
aL)
Again it is seen that derivatives of the shape functions must be obtained. Because
we have assumed L" Lz, and L) to be independent, and L4 to be dependent, we
would have to use Eq. (9-69) to eliminate L4 in the shape functions before taking
the derivatives. This approach is not very practical and an alternate method is now
presented. Let us denote the partial derivative of N, with respect to L, as
( aN )
aL: L,.L,.L4
where the shape function N; is now a function of L" Lz, L), and L4 (but Lz, L),
and L4 are held constant in performing the differentiation). The notation
aN;
aLl
implies N; is a function of L" Lz, and L) only, and Lz and L) are held constant [Lz
and L) are not written since they are not written in Eq. (9-75)]. It follows that
aN;
aLI (aN;)
aLz (aN;)
aL)(aN;)
aLl = aLl aLl
L,.L,.L4 + aLI
aLz L,.L,.L4 + aLI
aL) L,.L,.L4
aL4 (aN;)
+- -
aLI
aL4
L,.L,.L,
But
aLl =
aLI
and so we have
o
19-77)
Here N, is taken
to be a function
of only L j • L,.
and L, as required
by Eq. (9-75)
aN
(aN)
(aN)
~ =
aL; L,.L,.L4 -
aL~
L,.L"L3
.-....--
Here N, is taken to be
a function of L" L,.
L,. and L4
19-78)

542
HIGHER-ORDER ISOPARAMETRIC ELEMENTS AND QUADRATURE
It can similarly be shown that
(aN)
aL~
L"L',L.-
and
/9-79)
Finally, the element volume dx dy dz may be written as
dx dy dz = [detJI dL I dL2 dl.,
/9-80)
/9-80)
Therefore, each integral over the element volume may be transformed into an
integral of the form
or
Ke
/9-81)
/9-82)
These integrals are in forms that are suitable for numerical integration as explained
in Sec, 9-9, The resulting sizes of the element stiffness matrices are given in Table
9-4, As in all other previous cases, the necessary and sufficient condition for a
one-to-one mapping is that the sign of the Jacobian be the same for all points
mapped,
Table 9-4
Size of the Element Stiffness Matrices for the Tetrahedral Elements
Order of element
Linear
Quadratic
Cubic
Structural
(3 DOF per node)
12 x 12
30 x 30
60 x 60
Thermal
(I DOF per node)
4 x 4
10 x 10
20 x 20
9-8
NUMERICAL INTEGRATION: RECTANGULAR AND BRICK
ELEMENTS
As mentioned in Sees, 9-6 and 9-7, the use of numerical integration techniques
makes the isoparametric element practical. Integrals such as
/ = J: !(x) dx
may be evaluated approximately by writing
/9-83)

NUMERICAL INTEGRATION: RECTANGULAR AND BRICK ELEMENTS
i
b
n
I =
a f(x) dx =
i~l WJ(X;)
543
19-84)
where the Wi are referred to as the weights and the Xi as the sampling points.
If the sampling points are chosen such that the interval a ~ X -s b is divided
into n -
I equal-length segments, the integration is referred to as Newton-Cotes
quadrature. Quadrature is another name for numerical integration. Familiar ex-
amples of this type of numerical integration are the trapezoidal and Simpson's rules.
In effect, a polynomial is used on a piecewise basis to represent f(x) over the
interval. The trapezoidal rule will integrate a linear function exactly, whereas Simp-
son's rule will integrate a quadratic function exactly. If n sampling points are used,
the integration is exact iff(x) is a polynomial of order n -
I or less. This method
is frequently used when the data to be integrated is in tabular form and equally
spaced.
Integrals that arise in the finite element method have integrands that are explicit
functions of the global coordinates. It was shown in Sees, 9-6 and 9-7 how these
integrals could be transformed into ones in the serendipity domains for the rectan-
gular and brick isoparametric elements. Recall, for example, Eqs. (9-34), (9-41),
(9-42), etc. Note that the integration limits are also changed to reflect the fact that
- I ~ r ~ + I, - I -s s ~ + I, etc. Therefore, we need to integrate functions
such as
fl
I
_I f(r) dr
19-85a)
flfl
I
_I
_If(r,s)drds
19-85b)
flflfl
I =
_I
_I
_If(r,s,t)drdsdt
19·85e)
In Eqs. (9-85), a scalar integrand is implied because the integral of a matrix is
simply the matrix of integrals.
Gauss quadrature is a numerical integration method that allows the sampling
points to be chosen such that the best possible accuracy may be obtained. If the
sampling points and weights in Eq. (9-84) are based on Legendre polynomials,
then the numerical integration is referred to as Gauss-Legendre quadrature. The
derivation of these weights and sampling points is beyond the scope of this book.
The interested reader may wish to consult reference 5. This method will integrate
polynomials of order 2n -
I exactly, where n is the number of sampling points.
Gauss-Legendre quadrature requires the integral to be in the form of Eqs. (9-85),
and in one dimension we have
J
+ I
n
I =
_I f(r) dr =
i~l wJ(ri )
19-86)
where the weights Wi and sampling points r, are given in Table 9-5 for up to six
sampling points (or n = 6).

544
HIGHER-ORDER ISOPARAMETRIC ELEMENTS AND QUADRATURE
Table 9·5
Sampling Point Values and Weights for Gauss-Legendre Quadrature
f
+ 1
"
_ 1 j(r) dr =
~1 wJ(r;)
r,
n = 1
0.OOOOOOOOOOOOOOO
n = 2
±0.577350269189626
n = 3
O.OOOOOOOOOOOOOOO
±0.77459666924 ~483
n = 4
±0.339981043584856
±0.861 13631 1594053
n = 5
0.OOOOOOOOOOOOOOO
±0.538469310I05683
±0.906179845938664
n = 6
± 0.238619186083197
±0.661209386466265
±0.932469514203152
Example 9-2
Evaluate the integral
f
+ 1
I =
_I (r 4 + r) dr
Wi
2.OOOOOOOOOOOOOOO
I.OOOOOOOOOOOOOOO
0.888S8888888~889
0.555555555555556
0.652145154862546
0.347854845137454
0.568888888888889
0.478628670499366
0.236926885056189
0.467913934572691
0.360761573048139
0.171324492379170
by using Gauss-Legendre quadrature. Perform an integration of such an order that
the integral is evaluated exactly. Compare the result from the numerical evaluation
with that from the analytical integration.
Solution
First, we note that the integral is in the proper form for evaluation by Gauss-
Legendre quadrature. Second, since the integrand is a polynomial, we can determine
the order of the quadrature that will result in an exact evaluation from
2n -
I = 4
where the order of the polynomial is 4. Solving for n yields n = 512, which must
be rounded to give n = 3. Therefore, we must take three sampling points in Table

9-5. If we let f(r)
following table:
NUMERICAL INTEGRATION: RECTANGULAR AND BRICK ELEMENTS
545
r4 + r, then the calculations may be summarized in the
r,
Wi
f(rj)
wJ(r;)
I
-0.77460
0.55556
-0.41459
-0.23033
2
0.0ססoo
0.88889
0.0ססoo
0.0ססOO
3
+0.77460
0.55556
1.13461
0.63033
~ =
0.4ססoo
It can readily be shown that the exact result is ¥s. Only five significant digits were
carried in the numerical evaluation summarized in the table above. For all practical
purposes, we have obtained the exact result by using three Gauss points.
•
Because we frequently need to integrate over rectangular and brick elements,
Eq. (9-84) needs to be extended to two and three dimensions. Let us begin with
Eq. (9-85b) and integrate first with respect to r by applying Eq. (9-86) to get
f+'f+'
f+'
n
J =
_I
_I f(r,s) dr ds =
_I
j~l wJ(rj,s) ds
or
f+'
J=
_,g(s)ds
where
n
g(s) = L: wJ(rj,s)
i=l
Integrating Eq. (9-88) by applying Eq. (9-86) again gives
m
J = L: Wjg(s)
j=l
But g(s) from Eq. (9-89) is given by
n
g(s) = L: wJ(rj,sj)
i=l
Combining Eqs. (9-90) and (9-91) gives the desired result
19-88)
19-89)
19-90)
19-91)
19-92)
J = f,'f,' f(r,s) dr ds = j~ j~ wiwd(ri,s)
Note that n sampling points are assumed in the r direction and m in the s direction.
Usually m is equal to n, but this is not necessary.
Equation (9-92) is extended to three dimensions in a straightforward manner
with the result

546
HIGHER-ORDER ISOPARAMETRIC ELEMENTS AND QUADRATURE
pm"
2: 2: 2: W,WjWd(rj,Sj,tk)
k=)j=li=)
(9-931
where p sampling points are assumed in the t direction. The use of these equations
is demonstrated in Examples 9-3 and 9-4.
•
Example 9-3
Evaluate the integral
J+IJ+I
I =
_I
_I (r2 + rs)s4 dr ds
by using Gauss-Legendre quadrature. Compare the result with that from the exact
evaluation.
Solution
Because the integrand is a polynomial, we could determine the required number of
sampling points (or Gauss points) in each direction in order to get the exact value
for the integral. Note that the integral is of order 2 in r and of order 5 in s. Therefore,
in the r direction we have 2n -
I = 2 or n = Jh and in the s direction 2m -
I
= 5 or m = 3. Hence we take n = 2 (Y2 rounds to 2) and m = 3, or two Gauss
points in the r direction, and three points in the s direction. It is instructive to show
the six sampling points (i.e., 2 x 3) on a typical element as shown in Fig. 9-18.
0.57735
0.57735
s
T
[!]o
[!]c
460
~
~
~E
~B
460
1
[!]F
[!]A
,
I
1
0.77
0.77
Figure 9-18
Quadrilateral element in Example 9-3. Note that 0 denotes a Gauss (or
sampling) point.

NUMERICAL INTEGRATION: RECTANGULAR AND BRICK ELEMENTS
547
Let us denote the integrand by I(r,s), where
I(r,s) = (r 2 + rs)s4
The calculations are summarized (to five significant digits) in the following table:
Point
r,
Sj
Wj
Wj
I(r;,s)
wjwJ!(rj,s)
A
0.57735
-0.77460
1.00000
0.55556
-0.04100
-0.02278
B
0.57735
0.00000
1.00000
0.88889
0.00000
0.00000
C
0.57735
+0.77460
1.00000
0.55556
0.21800
0.15611
D
-0.57735
+0.77460
1.00000
0.55556
-0.04100
-0.02278
E
-0.57735
0.00000
1.00000
0.88889
0.00000
0.00000
F
-0.57735
-0.77460
1.00000
0.55556
0.28100
0.15611
2: = 0.26666
This compares favorably with the exact evaluation of I =
'!I15 or I = 0.26667 to
five significant digits. The exact result is approached as the number of significant
digits used is increased.
•
Example 9-4
Evaluate the element stiffness (or conductance) matrix for heat conduction in the
x direction for the element shown in Fig. 9-19, where the nodal coordinates are
shown in inches. Assume a thermal conductivity k of I Btu/hr-in-T' and an element
thickness t of 1 in.
Solution
From Eq. (8-106a), the expression for the stiffness matrix from heat conduction in
the x direction is given by
yL,
(5.1,4.01
i
aNT
aN
K'
=
-kt-dxdy
xx
A' ax
ax
15.2,4.31
15.3,4.21
(8-106a)
Figure 9-19
Quadrilateral element in Example 9-4.

S48
HIGHER-ORDER ISOPARAMETRIC ELEMENTS AND QUADRATURE
For the element under consideration, the shape function matrix N is given by
l
\4(1 + r)(I - S)]T
N =
\4(1 + r)(I + s)
Y4(1 -
r)(I + s)
Y4( I -
r)(I -
s)
Note that the four nodes are being used for two purposes: (I) to define the element
geometry, and (2) to specify the locations where the values of the parameter function
(in this case the temperature) are sought. Hence, the isoparametric formulation from
Sec. 9-6 is directly applicable here. Recall that the Jacobian matrix J is given by
Eq. (9-33) for this element or
±aN) x) ±aN)
-y
)= I ar
)= I ar }
J
±aN)x) ±aN)
-y
)=, as
)=, as }
Note that four terms are included in the summations because there are four nodes
(per element). For convenience. let us denote the entries comprising J- I as A,1o
A12, A21• and A22• or
The A;/s are functions of rand s. From Eq. (9-31) we may write
aN;
aN;
aN;
-
= A II -
+ A12 -
ax
ar
as
If all four shape functions are considered at one time, we have
aN
aN
aN
= A JJ -
+ A12 -
ax
ar
as
from which it also follows that
aNT
(aN
aN)T
aNT
aNT
-
=
AJJ -
+ A12 -
= AII -
+ A12 -
ax
ar
as
ar
as
Finally, we also have
dx dy = [detJI dr ds
and may write
J+IJ+I(
aNT
aNT)
(aN
aN)
Ki. =
All -
+ A12 -
kt
All -
+ A12 -
[det JI dr ds
- ,
- I
ar
as
ar
as

NUMERICAL INTEGRATION: RECTANGULAR AND BRICK ELEMENTS
549
Note that the integrand is a function of rand s only. In other words, the original
quadrilateral element has been mapped into the corresponding undistorted (parent)
element. The global coordinates (x,y) have been eliminated in favor of the seren-
dipity coordinates (r,s).
Let us denote the integrand by H(r,s) or
H(r,s) = cTktc [det JI
where
[
]
T
Y4(l -
s)
Y4(l + s)
- Y4(l + s)
- Y4(l -
s)
ar
aN
Clearly, we need the derivatives of the shape functions with respect to rand s, or
aNI
T
ar
aN2
ar
aN3
iJr
aN4
ar
and
aN
as
T
aNI
as
aN2
as
aN3
as
aN4
as
The Jacobian matrix J has four entries denoted J 11, J 12 , J 2 1, and h2' From Eg.
(9-33), these are given by
Y4( I -
S)XI + Y4(l + S)X2 -
Y4(l + s)X3 -
Y4(l -
S)X4
4 aN
JI2 =2: - 1Yj
j=1 ar
Y4(l -
S)YI + Y4(l + S)Y2 -
Y4(l + s)Y3 -
Y4(l -
S)Y4
±aNjXj
j= I as

550
HIGHER-ORDER ISOPARAMETRIC ELEMENTS AND QUADRATURE
- Y4(1 + r)x, + Y4(l + r)X2 + '14(1 -
r)X3 -
Y4(1 -
r)X4
4 aN
122 = L _J Yj
j~ I as
=
- Y4(1 + r)YI + Y4(l + r)Y2 + Y4(l -
r)Y3 -
Y4(l -
r)Y4
Since the nodal coordinates are known, the Jacobian matrix can be readily deter-
mined for any given (r,s) and subsequently inverted to get AII' A12' etc. Two Gauss
points in each direction will be used, since it is not possible (or desirable) to evaluate
the integral exactly. Why not? The parent (undistorted) element is shown in Fig.
9-20. The calculations are summarized below for each of the four Gauss points.
Gauss point A:
r: =
+0.57735027
SI
=
-0.57735027
J =
[
0.100ססOO0
0.08943376]
- 0.05000ooo
0.06056624
det J = 0.01052831
J-I = A = [5.75270206
-8.49459588]
4.74909931
9.49819863
. [
]T
[
]T
0.39433757
- 0.39433757
aN =
0.10566243
aN =
0.39433757
ar
- 0.10566243
as
0.10566243
- 0.39433757
- 0.10566243
0.5
s
T
0c
08
77r
77t35
1
0D
0A
I
I
I 0.57735
0.57735
Figure 9-20
Parent element showing the 2 x 2 Gaussian quadrature for Example 9-4.
0.5

NUMERICAL INTEGRATION: RECTANGULAR AND BRICK ELEMENTS
551
[
aN
aN]
c =
A 11 -
+ All-
ar
as
[
5.61824481]T
-2.74189378
-1.50540416
- 1.37094687
H(rz,sl) = cTktcldet JI
=
[
0,33232274
-0.16218476
-0.08904561
0.07915165
0.04345727
0.02385970
(Symmetric)
Gauss point B:
-0.08109238]
0.03957583
0.02172864
0.01978791
0.00000000]
0.0ססoo000
0.ססOO0000
0.0000ססOO
rz =
+ 0.57735027
Sz =
+0.57735027
[
0.100ססOO0
0.06056624]
J =
-0.05000000
0.06056624
det J = 0.00908494
J-1 = A = [6.66666667
-6.66666667]
5.50361582
11.00723165
~~
[-~:i~:~~~~~]'
'a~ = [-~:H~HH~]T
- 0.10566243
- 0.10566243
c = [AII~~ + AIZaa~]
= [_~:~~~:]T
0.000ססoo0
H(rz,sz) = cTktcldetJI
[
0,10094373
0.00ססOO00
- 0.10094373
0.0000ססoo
0.00ססOO00
0.10094373
(Symmetric)
Gauss point C:
rl =
- 0.57735027
Sz = + 0.57735027
J =
[
0.10000000
0.06056624]
-
0.050ססOO0
0.08943376

552
HIGHER-ORDER ISOPARAMETRIC ELEMENTS AND QUADRATURE
det J = 0.01197169
J-1 = A = [7.47043843
-5.05912314]
4.17652052
8.35304105
[
0.10566243]T
[-0.10566243]T
aN
0.39433757
aN
0.10566243
ar =
-0.39433757
a; =
0.39433757
-0.10566243
-0.39433757
[
1.32390396]T
2.41131526
- 4.94087683
1.20565761
H(rIoS2) = cTktcldetJI
=
[
0,02098304
0.03821782
-0.07830976
0.06960868
-0.14263083
0.29225601
(Symmetric)
Gauss point D:
0.01910891]
0.03480434
-0.07131541
0.01740217
[
aN
aN]
c =
A II -
+ A 12-
ar
as
aN
ar
r l =
-0.57735027
SI
=
-0.57735027
J =
[
0.10000000
0.08943376]
- 0.05000000
0.08943376
det J = 0.01341506
J-1
= A = [6.66666667
-6.66666667]
3.72715342
7.45430684
[
0.39433757]T
[-0.10566243]T
0.10566243
aN
0.10566243
- 0.10566243
a; =
0.39433757
- 0.39433757
- 0.39433757
[
3.33333333]T
0.OOOOOOOO
- 3.33333333
0.OOOOOOOO

NUMERICAL INTEGRATION: TRIANGULAR AND TETRAHEDRAL ELEMENTS
553
cTktcldet JI
[
0,14905627
0.ססOOססOO
0.00ססoo00
(Symmetric)
- 0.14905627
0.0ס0ooooo]
0.0ס0ooooo
0.0ס0ooooo
0.14905627
0.o00ooo00
0.o00ooo00
These results may now be used to obtain the stiffness matrix for this element
by noting that
Ke
=
xx
[aWktaN dxdy = J+1J+1H(r,S)drds
JA ax
ax
-I
-I
2
2
2: 2: wiwjH(ri,Sj)
i= 1 j= 1
where each weight (i.e., Wi and Wj) has a value of unity (see Table 9-5 for n = 2).
The final result is given by
Ke
=
[
0.60330578
-0.12396694
0.14876033
xx
(Symmetric)
- 0.41735537
-0.09917356
0.56611571
-0.06198347]
0.07438017
- 0.04958677
0.03719008
It is not possible to compare this result with that from an exact, analytical integration.
Why not?
•
9-9
NUMERICAL INTEGRATION: TRIANGULAR AND TETRAHEDRAL
ELEMENTS
In Sec. 6-7 three special integration formulas were presented that could be used to
evaluate integrals for the lineal, triangular, and tetrahedral elements. These for-
mulas, given by Eqs. (6-48) to (6-50) were illustrated many times in Chapters 7
and 8. Although these formulas are applicable to the higher-order lineal, triangular,
and tetrahedral elements, they are not very practical in these situations. Instead,
we resort to numerical integration.
Recall from Sees. 9-6 and 9-7 that integrals with rather complicated integrands
arose when higher-order triangular and tetrahedral elements were considered. For
example, typical element stiffness matrices and nodal force vectors are of the forms
given by Eqs, (9-54), (9-55), (9-81), and (9-82). Analytical evaluation of such
integrals is impossible, and so we must resort to a numerical scheme. Formulas
derived by Hammer, Marlowe, and Stroud [6] are particularly useful and easy to
apply. The use of these formulas for the case of the triangle is based on the
approximation given by

554
HIGHER-ORDER ISOPARAMETRIC ELEMENTS AND QUADRATURE
(9-94)
where W; denotes the ith weight and L I;, L2;, and L3i denote the coordinates of the
ith sampling points. Note that n sampling points are assumed. A similar formula
holds for the tetrahedral element, or
x- = fa' fa
1
-
LJ fa' ~L2~LJ H dLI dL2 dL3
n
= 2: Y6 w;H;(LI;,L2;,L3j,L4i)
i= I
(9-95)
Note that the dependent area coordinate L3 and the dependent volume coordinate
L4 were reintroduced into the integrands in Eqs. (9-94) and (9-95). The sampling
points and weights are given in Figs. 9-21 and 9-22 for the triangular and tetrahedral
elements, respectively. The use of these formulas is illustrated in Examples 9-5
and 9-6.
Example 9-5
By using Eg. (9-94) and Fig. 9-21, evaluate the following element stiffness matrix
for the three-node triangular element
K~, = f NThN dx dy
A'
Perform a linear-order integration. Recall that this element stiffness matrix arose
in Sec. 8-8 and resulted from convection from the lateral surface(s) of a plate [see
Eg. (8-106c)J. The exact integration is given in Example 8-13 and will serve as a
check on the numerical integrations.
Solution
In terms of the area coordinates, the shape function matrix N for this element is
given by
N = [LI
L2
L31
Therefore, the integrand H(L I ,L2,L3 ) is given by
H(L"L"L,) ~ [~:}[L'
L, L,] [detJI
The determinant of the Jacobian matrix J needs to be computed. From Eg. (9-50)
we get

NUMERICAL INTEGRATION: TRIANGULAR AND TETRAHEDRAL ELEMENTS
555
Area
Order
Points
coordinates
Weights
L,
L2
L3
Wi
0
Linear
a
1/3
1/3
1/3
a
1/2
1/2
,:,}
Quadradic
b
1/2
0
1/3
c
0
1/2
1/2
where '" = 0.059715872
{J = 0.470142064
'Y = 0.797426985
8 = 0.101286507
Cubic
Quintic
a
b
c
d
a
b
d
e
9
1/3
0.6
0.2
0.2
1/3
{J
{J
1/3
0.2
0.6
0.2
1/3
{J
1/3
0.2 }
0.2
0.6
1/3
-27/48
25/48
0.225000000
0.132394153
0.125939180
Figure 9-21
Numerical integration formulas for triangles.
1 -
0
0-0
0-1
o
-I

SS6
HIGHER-ORDER ISOPARAMETRIC ELEMENTS AND QUADRATURE
Order
Linear
Points
a
Volume
coordinates
L,
L 2
L 3
L4
1/4
1/4
1/4
1/4
Weights
Wi
a
'"
13
13
13}
b
13
o
13
13
Quadratic
c
13
13
'"
13
1/4
d
13
13
13
o
where
"
= 0.58541020
13
= 0.13819660
a
1/4
1/4
1/4
1/4
-4/5
b
o
13
13
13 }
Cubic
c
13
'"
13
13
9/20
d
13
13
'"
(l
e
13
13
13
'"
where '" = 1/3
13 = 1/6
Figure 9-22
Numerical integration formulas for tetrahedra.
and from Eq. (9-51), we get
aNI
(aNI)
(aNI)
0-0
0
aL2
aL2
L,.Ll
aL3 L,.L2
aN2
(aN2)
(aN2)
1 - 0
aL2
aL2
L,.L,
aL3 L,.L2
aN3 e
N3
)
(aN3)
0- 1
-1
aL2
aL2
L,.L,
aL3 L,.L2

NUMERICAL INTEGRATION: TRIANGULAR AND TETRAHEDRAL ELEMENTS
557
Let us denote the nodal coordinates as (XI,yI), (xz,yz), and (X3,Y3). Therefore, from
the above results and Eq. (9-52), we have
YI -
Y3]
Yz -
Y3
and
det J =
(Xl
-
x3)(Yz -
Y3) -
(xz -
X3)(YI -
Y3)
= XIYZ -
X3YZ -
XIY3 -
XZYI + X3YI + XZY3 = 2A
where A is the area of the triangle. If the reader is not convinced the above expression
is 2A, the expression should be compared with Eq. (6-21e). Therefore, the integrand
H is given by
For the linear-order integration, only one sampling point and one weight are given
in Fig. 9-21. Note that the sampling point in this case corresponds to the centroid
of the triangle and the weight is unity. Therefore, we have
I
K~v = 2: Yz wjH(L 1i, LZi , L3,)
i=l
(Y3)(Y3)
(Y3)z
(Y.1)(YJ)
This result differs somewhat from that obtained in Example 8-13 from an exact
integration. However, the error on the values of the nodal unknowns (i.e., the
vector a in Ka = f) can be reduced by increasing the number of elements used.•
Example 9-6
Redo Example 9-5 by performing a quadratic-order quadrature. Compare the re-
sulting stiffness matrix with that from Example 8-13, where an exact integration
was performed.

558
HIGHER-ORDER ISOPARAMETRIC ELEMENTS AND QUADRATURE
Solution
The first part of Example 9-5 is applicable here, and so we may begin with
[
L}
L]L2
L1L3]
H = 2hA
L2L1
L~
L2L3
L3L1
L3L2
L~
Note that the quadratic-order integration requires three sampling points (and three
weights). If the sampling points and weights in Fig. 9-21 are applied to the problem
at hand, the result is
(Yz)(Yz)
(Y2)(O)]
(Yz)2
(Yz)(O)
(O)(Y2)
(W
(Yz)(O)
(Yz)(Yz)]
(W
(O)(Y2)
(Yz)(O)
(Yz)2
(O)(Y2)
(O)(Y2)]
(Y2)2
(Y2)(Y2)
(Yz)(Yz)
(Yz)2
or
K~" =
[
(1,-'2)2
Y2(YJ)(2hA)
(Y2)(Yz)
(O)(Yz)
[
(Y2)2
+ Yz(Y,)(2hA)
(O)(Yz)
(Yz)(Y2)
[
(W
+ Yz(Y,)(2hA)
(Yz)(O)
(Yz)(O)
K;, ~ ~[:
\ lJ
This last result is the same as that in Example 8-13, where an exact integration
was performed. Note that the integrand was of quadratic order and hence a quadratic
order numerical integration gave the exact result.
•
It should be noted that the Jacobian matrix is a matrix composed solely of
constants for the linear-order (or three-node) triangular element. For higher-order
elements this will not necessarily be the case. Inother words, the Jacobian matrix
in general will be a function of the three area coordinates, in addition to the nodal
coordinates. This presents no problem because the quadrature method presented
here can easily accommodate this.
9-10
NUMERICAL INTEGRATION: REQUIRED ORDER
The question as to what order of integration we should use naturally arises. Zien-
kiewicz [7] argues that the linear-order integrations will always be convergent, but
not always practical. The general guidelines may be summarized as follows. For
linear-order triangles and quadrilaterals, single-point integration suffices. For quad-
ratic-order quadrilateral and brick elements, 2 x 2 and 2 x 2 x 2 Gauss point

PROBLEMS
559
integrations are adequate. For quadratic-order triangular and tetrahedral elements,
we should use three-point and four-point formulas from Figs. 9-21 and 9-22 (i.e.,
quadratic-order integrations). Cubic-order integrations should generally be per-
formed on cubic-order elements. This implies 3 x 3 and 3 x 3 x 3 Gauss point
integrations from Table 9-5 for the cubic-order quadrilateral and brick elements,
and four-point and five-point formulas from Figs. 9-21 and 9-22 for the cubic-order
triangular and tetrahedral elements. Zienkiewicz's book [7] should be consulted for
more information on this important aspect of finite element analysis.
REFERENCES
1. Zienkiewicz, O. C., The Finite Element Method, McGraw-Hili (UK), London, 1977,
pp. 253-261.
2. Kaplan, W., Advanced Calculus, 2nd ed., Addison-Wesley, Reading, Mass., 1973,
pp. 269-274.
3. Zienkiewicz, O. C., The Finite Element Method. McGraw-Hili, (UK) London, 1977,
p. 186.
4. Zienkiewicz, O. C,; The Finite Element Method, McGraw-Hili, (UK) London, 1977,
p. 192.
S. Carnahan, B., H. A. Luther, and J. O. Wilkes, Applied Numerical Methods, Wiley,
New York, 1969, pp. 100-116.
6. Hammer, P. C., O. P. Marlowe, and A. H. Stroud, "Numerical Integration over Sim-
plexes and Cones," Math. Tables Aids Comp., Vol. 10., pp. 130-137, 1956.
7. Zienkiewicz, O. C., The Finite Element Method, McGraw-Hili (UK), London, 1977,
pp. 201-204.
PROBLEMS
9-1
Show that the shape function N1 evaluates to unity at node I and to zero at all other
nodes for the linear-, quadratic-, and cubic-order lineal element if the shape functions
are given in terms of
a. Length coordinates L 1 and L2
b. Serendipity coordinate r
9-2
Show that the shape function N2 evaluates to unity at node 2 and to zero at all other
nodes for the linear-, quadratic-, and cubic-order lineal element if the shape functions
are given in terms of
a. Length coordinates L 1 and L2
b. Serendipity coordinate r
9·3
Show that the shape function N3 evaluates to unity at node 3 and to zero at all other
nodes for the quadratic- and cubic-order lineal element if the shape functions are
given in terms of
a. Length coordinates L 1 and L2
b. Serendipity coordinate r

S60
HIGHER-ORDER ISOPARAMETRIC ELEMENTS AND QUADRATURE
9-4
Show that the shape function N4 evaluates to unity at node 4 and to zero at all other
nodes for the cubic-order lineal element if the shape functions are given in terms of
8. Length coordinates L 1 and Lz
b. Serendipity coordinate r
9·5
Plot the shape functions for the lineal element on a typical element if the element is
of
8. Linear order
b. Quadratic order
c. Cubic order
9·6
For the quadratic-order triangular element, show that Nz evaluates to unity at node
2. Also show that Ni evaluates to zero if evaluated at each of the five other nodes.
9-7
For the quadratic-order triangular element, show that N6 evaluates to unity at node
6. Also show that N6 evaluates to zero if evaluated at each of the five other nodes.
9-8
For the cubic-order triangular element, show that N) evaluates to unity at node 3.
Also show that N) evaluates to zero if evaluated at each of the nine other nodes.
9·9
For the cubic-order triangular element, show that N7 evaluates to unity at node 7.
Also show that N7 evaluates to zero if evaluated at each of the nine other nodes.
9·10
For the cubic-order triangular element, show that NIO evaluates to unity at node 10.
Also show that NIO evaluates to zero if evaluated at each of the nine other nodes.
9-11
For the quadratic-order rectangular element, show that N) evaluates to unity at node
3. Also show that N) evaluates to zero if evaluated at each of the seven other nodes.
9-12
For the quadratic-order rectangular element, show that N6 evaluates to unity at node
6. Also show that N6 evaluates to zero if evaluated at each of the seven other nodes.
9-13
For the cubic-order rectangular element, show that N: evaluates to unity at node 2.
Also show that N: evaluates to zero if evaluated at each of the II other nodes.
9-14
For the cubic-order rectangular element, show that NIO evaluates to unity at node 10.
Also show that N IO evaluates to zero if evaluated at each of the II other nodes.
9-15
For the quadratic-order tetrahedral element, show that Nz evaluates to unity at node
2. Also show that N, evaluates to zero if evaluated at each of the nine other nodes.
9·16
For the quadratic-order tetrahedral element, show that Ng evaluates to unity at node
8. Also show that N« evaluates to zero if evaluated at each of the nine other nodes.
9-17
For the cubic-order tetrahedral element, show that Nil evaluates to unity at node II.
Also show that Nil evaluates to zero if evaluated at each of the 19 other nodes.
9-18
For the cubic-order tetrahedral element, show that N I9 evaluates to unity at node 19.
Also show that N I9 evaluates to zero if evaluated at each of the 19 other nodes.
9-19
For the quadratic-order brick element, show that Ns evaluates to unity at node 5.
Also show that Ns evaluates to zero if evaluated at each of the 19 other nodes.
9-20
For the quadratic-order brick element, show that N I4 evaluates to unity at node 14.
Also show that N I4 evaluates to zero if evaluated at each of the 19 other nodes.

PROBLEMS
561
9-21
For the cubic-order brick element, show that N4 evaluates to unity at node 4. Also
show that N4 evaluates to zero if evaluated at each of the 31 other nodes.
9·22
For the cubic-order brick element, show that N29 evaluates to unity at node 29. Also
show that N29 evaluates to zero if evaluated at each of the 31 other nodes.
9-23
Consider the linear-order, isoparametric quadrilateral element shown in Fig. P9-23.
The nodal coordinates are shown on the figure. Map the point r =
+ 0.50 and s =
- 1.0 on the parent element to the proper point on the distorted element (i.e., the
quadrilateral). Show the distorted element on graph paper in order to see the mapping.
y
(10,1.5)
(2,11)
2
(6,6)
l..-
x
Figure P9-23
9-24
For the element in Problem 9-23, map the point r =
+0.5 and s = -0.75 on the
parent element to the proper point on the distorted element (i.e., the quadrilateral).
Show the distorted element on graph paper in order to see the mapping.
9·25
Consider the quadratic-order, isoparametric quadrilateral element shown in Fig.
P9-25. The nodal coordinates are shown on the figure. Map the point r =
-0.35
and s = + 1.0 on the parent element to the proper point on the distorted element.
Show the distorted element on graph paper in order to see the mapping.
9·26
For the element in Problem 9-25, map the point r = +0.75 and s = -0.25 on the
parent element to the proper point on the distorted element. Show the distorted element
on graph paper in order to see the mapping.
9·27
Consider the cubic-order, isoparametric quadrilateral element shown in Fig. P9-27.
The nodal coordinates are shown on the figure. Map the point r =
+0.50 and s =
- 1.0 on the parent element to the proper point on the distorted element Show the
distorted element on graph paper in order to see the mapping.

562
HIGHER-ORDER ISOPARAMETRIC ELEMENTS AND QUADRATURE
y
(12,20)
(6,10)
1
(10,9)
2
(14,7)
6
(17,171
3
(21,131
(17,10)
~--------------x
Figure pg-25
y
(22,19)
(8,17)
4
2
(26,15)
(12,13)
11
6
(24,11).
(14,8)
12
(17,41
5
(21,8)
L-----
.... x
Figure pg·27
9-28
For the element in Problem 9-27, map the point r = -0.45 and s = +0.75 on the
parent element to the proper point on the distorted element. Show the distorted element
on graph paper in order to see the mapping.
9-29
Consider the quadratic-order, isoparametric triangular element shown in Fig. P9-29,
The nodal coordinates are shown on the figure. Map the point L) = 0.5 and L2 =
0.5 on the parent element to the proper point on the distorted element. Show the

PROBLEMS
563
y
(20,151
(6.7)
'---------------x
Figure P9-29
distorted element on graph paper in order to see the mapping. What is the value of
L3? Please explain.
9-30
For the element in Problem 9-29, map the point L 1 = 0.25 and L3 = 0,35 on the
parent element to the proper point on the distorted element. Show the distorted element
on graph paper in order to see the mapping. What is the value of L2? Please explain.
9-31
Consider the cubic-order, isoparametric triangular element shown in Fig. P9-31. The
nodal coordinates are shown on the figure. Map the point L2 = 0.5 and L 3 = 0.5
on the parent element to the proper point on the distorted element. Show the distorted
element on graph paper in order to see the mapping. What is the value of L 1? Please
explain.
y
(10,20)
(6,3)
10•
(12,111
6
(10,6)
(16.71
3
(21,81
"----------------x
Figure P9-31

S64
HIGHER-ORDER ISOPARAMETRIC ELEMENTS AND QUADRATURE
9·32
For the element in Problem 9-31, map the point L2 = Y3 and L3 = Y3 on the parent
element to the proper point on the distorted element. Show the distorted element on
graph paper in order to see the mapping. What is the value of L,? Please explain.
9·33
For the isoparametric, quadrilateral element in Fig. 1'9-33, determine the Jacobian
matrix.
y
(13.5)
L-----------· x
Figure pg·33
9·34
Determine the Jacobian matrix for the isoparametric, quadrilateral element shown in
Fig. 1'9-34.
y
(15,20)
3
(10,5)
l-
x
Figure pg·34
9·35
Recall from Sec. 8-3 that the element stiffness matrix from one-dimensional heat
conduction is given by

PROBLEMS
565
f
tiNT
tiN
Ke =
-
kA-dx
.r
/' dx
dx
where k is the thermal conductivity, A is the cross-sectional area (of the one-dimen-
sional body in the direction x), N is the shape function matrix, and Ie denotes that
the integration is to be performed over the length of the element. Let us consider a
quadratic-order, lineal element where the nodes are not necessarily equally spaced.
In order to evaluate K: for this element, we must first perform an isoparametric
mapping.
a. Show that the Jacobian matrix in this case is a scalar and is given by
How many terms are included in the summation? Please explain.
b. Show that K: may be written
f
+1tiNT
kA
tiN
Ke =
-
-dr
x
_I
dr
'" dNj
dr
LJ dr Xj
c. How arethe results from parts (a) and (b) affected if the cubic-order, lineal element
is used?
9-36
Consider a one-dimensional body in a two-dimensional space such as the one shown
in Fig. P9-36(a). The body may be discretized as shown in Fig. P9-36(b). Note that
lineal elments of any order may be used [although Fig. P9-36(b) shows only linear-
order elements]. Note further that two global coordinates must be used to define the
location of each node. Let us denote the global coordinates of the jth node as (Xj'Y)'
Let us also use the coordinate I as shown in Fig. P9-36(c) to represent the direction
that is always tangential to the one-dimensional body. In other words, the coordinate
I is measured along the body. It then follows that
N; = N;(r)
r = r(l)
and
I = I(x,y)
where r is the serendipity coordinate, and N; is the shape function for node i,
a. Show that the element stiffness matrix from heat conduction in the I direction
(i.e., from one-dimensional heat conduction along the length of the body) is given
by
f
dNT
dN
Kr =
/eill kA dl dl
where k is the thermal conductivity, A is the cross-sectional area (in the I direction),
and Ie denotes that the integration is to be performed over the length of the element.

S66
HIGHER-ORDER ISOPARAMETRIC ELEMENTS AND QUADRATURE
y
L.....
x
(a)
Figure pg-36
y
~
1
L..-
X
(b)
y
o
L..-----------_x
(e)
b. Show that the Jacobian matrix is a scalar in this case and is given by
c. Show that K1 becomes
f
+ I dNT
K1=
-
-1
dr
d. Extend the results from parts (b) and (c) to the case of a one-dimensional body
in a three-dimensional space.
9-37
For the isoparametric, triangular element in Fig. P9-37, determine the Jacobian rna-
trix.
9-38
Determine the Jacobian matrix for the isoparametric, triangular element shown in
Fig. P9-38.
9·39
Derive the expressions that correspond to Eqs. (9-39) and (9-40) for the isoparametric,
triangular element. In other words, derive the expressions to be used in the trans-

PROBLEMS
567
y
(8,10)
(3,5)
(9,3)
L-
x
Figure P9-37
y
(15,18)
4
(20,14)
(15,11)
(11,7)
L--------------_x
Figure P9-38
formation of dS (the elemental surface area around the boundary of the two-dimen-
sional element) to the local coordinate system (in terms of the area coordinates). Note
that the area coordinates degenerate to length coordinates in this case. Why?
9-40
Compute the following derivatives for the quadratic-order, isoparametric triangular
element:
9-41
Compute the following derivatives for the quadratic-order, isoparametric triangular
element:

568
HIGHER-ORDER ISOPARAMETRIC ELEMENTS AND QUADRATURE
9-42
Compute the following derivatives for the cubic-order, isoparametric triangular ele-
ment:
b. aN?
aLz
9-43
Derive the expressions that correspond to Eq. (9-65) for the isoparametric brick
element if faces of constant r (i.e., r =± I) happen to be on the global boundary.
In other words, derive the expression to be used in the transformation of dS on faces
of constant r (the elemental surface area on the boundary of the three-dimensional
element) to the local coordinate system (in terms of the serendipity coordinates sand
r).
9-44
Derive the expressions that correspond to Eq. (9-65) for the isoparametric brick
element if faces of constant s (i.e., s =
± I) happen to be on the global boundary.
In other words, derive the expression to be used in the transformation of dS on faces
of constant s (the elemental surface area on the boundary of the three-dimensional
element) to the local coordinate system (in terms of the serendipity coordinates rand
t).
9-45
Derive the expressions that correspond to Eq. (9-65) for the isoparametric tetrahedral
element. In other words, derive the expression to be used in the transformation of
dS (the elemental surface area on the boundary of the three-dimensional element) to
the local coordinate system (in terms of the volume coordinates). Note that the volume
coordinates degenerate to area coordinates in this case. Why?
9-46
Compute the following derivatives for the quadratic-order, isoparametric tetrahedral
element:
9-47
Compute the following derivatives for the cubic-order, isoparametric tetrahedral ele-
ment:
9-48
Evaluate the integral given below by using Gauss-Legendre quadrature of such an
order that the integral is evaluated exactly. Compare this result with that from the
analytical evaluation.
f
+ 1
I =
_I (r + 3r3) dr
9-49
Evaluate the integral given below by using Gauss-Legendre quadrature of such an
order that the integral is evaluated exactly. Compare this result with that from the
analytical evaluation.

PROBLEMS
569
9-50
Evaluate the integral given below by using two-point Guass-Legendre quadrature.
Compare this result with that from the analytical evaluation.
f
+ 1
I =
sin? 7rr dr
-I
9-51
Repeat Problem 9-50 by performing a three-point Gauss-Legendre quadrature.
9-52
Evaluate the integral given below by using two-point Gauss-Legendre quadrature.
Compare this result with that from the analytical evaluation.
f
+ 1
I =
cos? 7rr dr
-I
9-53
Repeat Problem 9-52 by performing a three-point Gauss-Legendre quadrature.
9·54
Evaluate the integral given below by using Gauss-Legendre quadrature of such an
order that the integral is evaluated exactly. Compare this result with that from the
analytical evaluation.
I = L+II L+II (2rs + 3r2s 3) dr ds
9·55
Evaluate the integral given below by using Gauss-Legendre quadrature of such an
order that the integral is evaluated exactly. Compare this result with that from the
analytical evaluation.
f+1f+1
I
=
_ 1
_ 1 (2r 3s 2 + 5rs 3) dr ds
9-56
Evaluate the element nodal force vector from a uniform body force b acting on a
two-dimensional body if the four-node rectangular element with length 2a and height
2b is used [see Eq. (7-28)]. Perform a 2 x 2 Gauss-Legendre quadrature. Give the
result in terms of the two components of the body force (per unit volume) b, and by,
the element thickness t, and the element dimensions a and b.
9-57
Evaluate the element nodal force vector from a uniform surface traction s acting on
leg 2-3 of the four-node rectangular element with length 2a and height 2b [see Eq.
(7-31). Use only two Gauss points. Give the result in terms of the two components
of the surface traction Sx and Sy' the element thickness t, and the element dimensions
a and b.
9-58
Evaluate the element stiffness matrix from conduction in the x direction [given by
Eq. (8-106a)] for the four-node rectangular element with length 2a and height 2b by
performing 2 x
2 Gaussian quadrature. Give the result in terms of the element
dimensions a and b, the thermal conductivity k, and the element thickness t. Hint:
See Problem 8-57 [parts (a) and (b)].
9-59
Evaluate the element stiffness matrix from conduction in the y direction [given by
Eq. (8-I06b)] for the four-node rectangular element with length 2a and height 2b by
performing 2 x 2 Gaussian quadrature. Give the result in terms of the element

570
IIIGHER-ORDER ISOPARAMETRIC ELEMENTS AND QUADRATURE
dimensions a and b, the thermal conductivity k, and the element thickness t. Hint:
See Problem 8-57 [parts (a) and (b)).
9-60
Evaluate the element stiffness matrix from lateral convection given by Eq. (8-106c)
for the four-node rectangular element with length 2a and height 2h by performing
2 x 2 Gaussian quadrature. Give the result in terms of the element dimensions a
and b, and the convective heat transfer coefficient h.
9-61
Evaluate the element stiffness matrix from boundary convection given by Eq.
(8-106e) for the four-node rectangular element with length 2a and height 2b by
assuming two Gauss points. Assume also that leg 1-2 is on the global boundary (and
undergoes convection). Give the results in terms of the element dimensions a and b,
the convective heat transfer coefficient he- and the element thickness I.
9-62
Evaluate the element stiffness matrix from boundary convection given by Eq.
(8-106e) for the four-node rectangular element with length 2a and height 2b by
assuming two Gauss points. Assume also that leg 4-1 is on the global boundary (and
undergoes convection). Give the results in terms of the element dimensions a and b,
the convective heat transfer coefficient he. and the element thickness t.
9-63
Evaluate the element nodal force vector from lateral convection given by Eq.
(8-107a) for the four-node rectangular element with length 2a and height 2b by
performing 2 x 2 Gaussian quadrature. Give the result in terms of the element
dimensions a and b, the convective heat transfer coefficient h. and the ambient
temperature Ta.
9-64
Evaluate the element nodal force vector from a lateral heat flux given by Eq.
(8-107c) for the four-node rectangular element with length 2a and height 2b by
performing 2
X 2 Gaussian quadrature. Give the result in terms of the element
dimensions a and b, and the imposed heat flux q,.
9-65
Evaluate the element nodal force vector from a distributed heat source given by
Eq. (8-107d) for the four-node rectangular element with length 2a and height 2h by
performing 2 x
2 Gaussian quadrature. Give the result in terms of the clement
dimensions a and b. the heat source strength Q, and the element thickness t,
9-66
Evaluate the element nodal force vector from boundary convection given by Eq.
(8-107e) for the four-node rectangular element with length 2a and height 2b by
assuming two Gauss points. Also assume that leg 2-3 is the global boundary (and
undergoes convection). Give the result in terms of the element dimensions a and b,
the convective heat transfer coefficient he. the ambient temperature TaB' and the
element thickness t.
9-67
Evaluate the element nodal force vector from a heat flux imposed on leg 3-4 of the
four-node rectangular element with length 2a and height 2b by assuming two Gauss
points. See Eq. (8-107g). Give the result in terms of the element dimensions (/ and
b, the heat flux q,B' and the element thickness t.
9-68
Evaluate the element nodal force vector from a uniform body force b acting on a
two-dimensional body if the three-node triangular element is used [see Eq. (7-28)).
Perform a quadratic order quadrature. Give the result in terms of the two components
of the body force (per unit volume) b, and b., the element thickness t, and the element
area A.

PROBLEMS
571
9-69
Evaluate the element nodal force vector from a uniform surface traction s acting on
leg 2-3 of the three-node triangular element. Use only two Gauss points. Give the
result in terms of the two components of the surface traction s, and s", the element
thickness t, and the length of leg 2-3. Hint: Note that N 1 is zero on leg 2-3. Replace
Nz and N] on leg 2-3 with the serendipity form of the shape functions for the linear
element and then use Gauss-Legendre quadrature.
9-70
Evaluate the element stiffness matrix from lateral convection given by Eq. (8-106c)
for the three-node triangular element by performing a quadratic order numerical
integration (quadrature). Give the result in terms of the element area A and the
convective heat transfer coefficient h.
9-71
Evaluate the element nodal force vector from lateral convection given by Eq.
(8-107a) for the three-node triangular element by performing a quadratic-order nu-
merical integration (quadrature). Give the result in terms of the element area A, the
convective heat transfer coefficient h, and the ambient temperature To.
9-72
Evaluate the element nodal force vector from a lateral heat flux given by Eq.
(8-107c) for the three-node triangular element by performing a quadratic-order nu-
merical integration (quadrature). Give the result in terms of the element area A and
the imposed heat flux q..
9-73
Evaluate the element nodal force vector from a distributed heat source given by
Eq. (8-107d) for the three-node triangular element by performing a quadratic-order
numerical integration (quadrature). Give the result in terms of the element area A,
the heat source strength Q, and the element thickness t.
9-74
Reconsider the element in Example 9-4. Determine the element stiffness (or con-
ductance) matrix from conduction in the y direction [see Eq. (8-106b)). Assume
2 x 2 Gaussian quadrature. Take the thermal conductivity k to be I Btu/hr-in-T and
the element thickness to be I in.
9-75
Reconsider the element in Example 9-4. Determine the element nodal force vector
from lateral convection [see Eq. (8-107a)]. Assume 2 x 2 Gaussian quadrature. Take
the convective heat transfer coefficient h to be 4 Btu/hr-inz-oF on each side of the
plate and the ambient temperature to be 70°F (the same on both sides).
9-76
Reconsider the element in Example 9-4. Determine the element nodal force vector
from a laterally imposed heat flux [see Eq. (8-107c)). Assume 2 x 2 Gaussian
quadrature. Take the heat flux qs to be 100 Btu/hr-in/.
9-77
Reconsider the element in Example 9-4. Determine the element nodal force vector
from an imposed heat flux q,B acting on leg 2-3 of the element [see Eq. (8-107g)).
Assume two Gauss points and a heat flux of 75 Btu/hr-in",
9-78
Consider the element shown in Fig. P9-78 where the nodal coordinates are shown
in centimeters. Determine the element stiffness (or conductance) matrix from con-
duction in the x direction [see Eq. (8-106a»). Assume 2 x 2 Gaussian quadrature.
Take the thermal conductivity k to be 150 W/m-oC and the element thickness to be
2 ern.
9-79
Consider the element from Problem 9-78. Determine the element stiffness (or con-
ductance) matrix from conduction in the y direction [see Eq. (8-106b)). Assume

572
HIGHER-ORDER ISOPARAMETRIC ELEMENTS AND QUADRATURE
y
(15,18)
2
(8,8)
(23,15)
1
120,5)
'----------------x
Figure P9-78
2 x 2 Gaussian quadrature. Take the thermal conductivity k to be 150 W/m-oC and
the element thickness to be 2 cm.
9-80
Consider the element from Problem 9-78. Determine the element nodal force vector
from lateral convection [see Eq. (8-107a)]. Assume 2 x 2 Gaussian quadrature. Take
the convective heat transfer coefficient h to be 2000 W/m2_oC on each side of the
plate and the ambient temperature to be 48°C (the same on both sides).
9-81
Consider the element from Problem 9-78. Determine the element nodal force vector
from a laterally imposed heat flux [see Eq. (8-107c)]. Assume 2 x 2 Gaussian
quadrature. Take the heat flux qs to be 100 W/cm 2•
9-82
Consider the element from Problem 9-78. Determine the element nodal force vector
from an imposed heat flux qsB of 125 W/cm 2 acting on leg 3-4 of the element [see
Eq. (8-107g)]. Assume two Gauss points.
9-83
Consider the problem posed in Problem 9-36. An alternate, but completely equivalent,
formulation to such a problem is developed here. The main reason for the alternate
formulation given below is that it may be more readily extended to the case of a
two-dimensional body in a three-dimensional space (see Problem 9-84).
Consider a one-dimensional body in a two-dimensional space such as the one
shown in Fig. P9-83(a). The body may be discretized as shown in Fig. P9-83(b).
Note that lineal elements of any order may be used [although Fig. P9-83(b) shows
only linear-order elements]. Note further that two global coordinates must be used
to define the location of each node. Let us denote the global coordinates of the jth
node as (.Xj'Y)' Let us also use the coordinate x' as shown in Fig. P9-83(c) to represent
the direction that is always tangential to the one-dimensional body. In other words,
the coordinate x' is measured along the body. It then follows that
N, = Nj(r)
r = rex')

y
'------------x
(a)
y
~~-x'
o
l----------_x
(e)
Figure P9-83
and
PROBLEMS
573
y
~
1
'------------x
(b)
x'
= x'(x,y)
where r is the serendipity coordinate, and N; is the shape function for node i.
a. Show that the element stiffness matrix from heat conduction in the x' direction
(i.e., from one-dimensional heat conduction along the length of the body) is given
by
i
dNT
dN
,
K'=
-kA-dx
"dx'
dx'
where k is the thermal conductivity, A is the cross-sectional area (in the x' di-
rection), and l' denotes that the integration is to be performed over the length of
the element.
b. Show that the Jacobian matrix is a scalar in this case and is now given by

574
HIGHER-ORDER ISOPARAMETRIC ELEMENTS AND QUADRATURE
where nil is the cosine of the angle between the x and x' axes, and n21 is the
cosine of the angle between the y and the x' axes (i.e., nil and n21 are the two
direction cosines).
c. Show that K' becomes
K' =
Note that the integral may be evaluated numerically with the help of Gauss-
Legendre quadrature.
d. Extend the results from parts (b) and (c) to the case of a one-dimensional body
in a three-dimensional space.
e. Show that formulation above is equivalent to that in Problem 9-36 by showing
that the Jacobian J from Problem 9-36 is equivalent to the expression for J given
above.
9-84
Let us extend the formulation presented in Problem 9-83 to the case of a two-
dimensional body in a three-dimensional space as shown in Fig. P9-84(a). The body
may be discretized into quadrilateral elements as shown in Fig. P9-84(b). Note that
quadrilateral clements of any order may be used [although Fig. P9-84(b) shows only
linear-order clements). Note further that three global coordinates must be used to
define the location of each node. Let us denote the global coordinates of the jth node
as (Xj'Yj'z), Let us also use the coordinates x' and y' as shown in Fig. P9-84 to
represent the local coordinate system that is in the plane of the two-dimensional body.
Note that x' and y' are always perpendicular to each other (in other words, the local
coordinate system and the global coordinate system both form orthogonal coordinate
systems). It then follows that
N; = N;(r,s)
r = r(x' ,y')
and
S = s(x',y')
where
x'
= x'(x,y,z)
and
y' = y'(x,y,z)
Note that rand s are the serendipity coordinates, and N; is the shape function for
node i. It follows that the element stiffness matrices for conduction in the x' and y'
directions are given by
1
ilWk ilN dx'
,
-
t-
dy
Ac ax'
ax'
and
1
aNTk aN
r
,
-
t-dx dy
A' ily'
ay'

PROBLEMS
575
y'
y
x'
z
~------x
(a)
y'
y
x'
)-------x
(b)
z
ar
ax'
Figure P9-84
where k is the thermal conductivity, t is the thickness of the element, and A' denotes
that the integration is to be performed over the area of the element.
a. Show that the Jacobian matrix is now given by
l
ax' ail
ar
ar
J =
ax'
ay'
as
as
where the entries in the Jacobian matrix are given by
aN
aN·
aN·
nilL a/Xj + nz,L a/yj + n31L a/Zj
ai
liz = -
=
ar

576
HIGHER-ORDER ISOPARAMETRIC ELEMENTS AND QUADRATURE
and where nil is the cosine of the angle between the x and x' axes, and n21 is the
cosine of the angle between the y and the .r' axes, etc. (i.e., nil' n21' etc. are the
direction cosines).
b. By denoting the entries in the inverted Jacobian matrix as All' A12, A21, and An,
determine the explicit form of the element stiffness (or conductance) matrices for
conduction in the x and y directions in terms of the local, serendipity coordinates
rand s [and the nodal coordinates (xl'Yj'z)], Note the integration is performed
over the parent element and, thus, the integrals may be evaluated numerically
with Gauss-Legendre quadrature. Do not attempt to perform the quadrature, how-
ever.
9·85
Recall that the condition for a one-to-one mapping is that the sign of the Jacobian
remain the same for all points in the domain mapped. For the quadratic-order, lineal
element show that this implies that the interior node must be in the middle one-half
lone. Hint: Problem 9-35 gives the expression for the Jacobian.

10
Transient and Dynamic Analyses
10-1
INTRODUCTION
Up to now we have only considered steady-state nonstructural applications and
static stress analysis applications. In this chapter the finite element method is
extended to transient and dynamic analyses. The reader may recall from Chapter
4 that transient (nonstructural) analyses are frequently referred to as unsteady, time-
dependent, or propagation problems. In structural and stress analyses, time-inde-
pendent problems are referred to as static or equilibrium problems, whereas time-
dependent problems are almost exclusively referred to as dynamic.
The chapter begins with a new notion referred to as partial discretization. In
effect, this will allow us to discretize the time domain. The reader will recall that
up to now we have only had to perform discretization in space.
The introduction to partial discretization is followed by a presentation of the
governing equations for dynamic structural analysis and transient thermal analysis
in Sees, 10-3 and 10-4, respectively. No longer will we get the familiar Ka = f,
but rather several additional terms will arise. The concept of lumped and consistent
mass and capacitance matrices is then introduced in Sec. 10-5 with the implications
of each briefly discussed.
Solution methods are presented for transient thermal analysis problems in Sees.
10-7 and 10-8, following a brief introduction to this subject in Sec. 10-6. The
development in Sec. 10-7 is based on the finite difference method, whereas that in
Sec. 10-8 is based on the finite element method. It will be seen that both methods
give the same two-point recurrence formula which will allow us to compute the
nodal temperatures as a function of time. Indeed, it will be seen that the results
577

578
TRANSIENT AND DYNAMIC ANALYSES
from the finite difference method are actually special cases of the more general
finite element method. It is emphasized that in all cases the goal is to compute the
temperatures at the nodal points as a function of time.
Finally, in Sees. 10-9 and 10-10, solution methods to dynamic structural anal-
ysis problems are presented. In Sec. 10-9 a three-point recurrence scheme is derived
by using suitable finite elements in time. This will allow us to compute the nodal
displacements within a structure as a function of time. Both the inertia and damping
within the structure will be explicitly included in the analysis. In Sec. 10-10 an
introduction to modal analysis is given which will allow us to compute the undamped
natural frequencies and the so-called mode shapes of a structure.
10-2
PARTIAL DISCRETIZATION
In the previous chapters, the unknown parameter function <t> on an element basis
was assumed to be of the form
<t> = Na"
/10-1)
where <t> is a vector or a scalar and may represent the displacement, temperature,
velocity, and/or pressure fields. Recall that the shape function matrix N is a function
of the particular coordinates being used (i.e., global or local) and the vector a e is
composed strictly of constants. These constants are the values of the parameter
functions at the locations of the nodes. For example, in two-dimensional stress
analysis, we have assumed the displacement u on an element basis to be given by
u = N(x,y)a e
/10·2)
where u itself is given by Eq. (5-58). Similarly in two-dimensional thermal analysis,
we have assumed the temperature T on an element basis to be given by
T = N(x,y)a e
/10-3)
It is emphasized that N in both cases is a function of the global (or local) coordinates
whereas a e is composed of constants (albeit unknown constants).
Let us now consider the case of a dynamic structural problem and unsteady
heat transfer problem. Unsteady problems may also be referred to as transient or
time-dependent problems. Since the time variable T enters into such problems, Eqs.
(l0-1) to (10-3) could be modified such that the shape function matrix could include
the time variable in addition to the spatial coordinates. For example, Eq. (l0-1)
could be written as
<t> = N(x,y,T)ae
/10-4)
where a new shape function matrix N could be derived. The principal disadvantage
of this approach is that it increases the number of dimensions by one. For example,
a one-dimensional problem becomes two-dimensional, a two-dimensional problem
becomes three-dimensional, and so forth.

DYNAMIC STRUCTURAL ANALYSIS
579
This additional complexity may be avoided if we allow the vector of nodal
unknowns a" itself to be a function of time. This isreferred to aspartial discretization
[1]. Equation (10-1) could then be written as
<I> = Nae(T)
(10-5)
where the explicit dependence of a e on T is shown. The implication is that no longer
will we get the familiar equation
Keae = fe
(10-6)
Instead, two additional terms will arise in dynamic structural analysis problems,
and one additional term will arise in transient thermal analysis problems. The explicit
forms for these equations are given in Sees, 10-3 and 10-4 for dynamic structural
and transient heat transfer problems, respectively.
10-3
DYNAMIC STRUCTURAL ANALYSIS
Recall from Chapter 5 that the principle of minimum potential energy or principle
of virtual work may be used to derive Eq. (5-46). Both approaches gave virtually
the same result, which is repeated here for easy reference:
Note that the right-hand side of Eq. (5-46) is composed of three terms, each of
which represents an external force acting on the structure, and hence the element.
By applying D'Alembert's principle [2], we may introduce additional terms to the
right-hand side from the inertia and the damping as shown below.
The inertia results from the mass of the structure, whereas the damping results
from energy dissipation or friction within the structure. The inertial force per unit
volume is given by the product of the mass density p and the acceleration. The
damping force per unit volume is generally assumed to be the product of a viscous
matrix J.L and the velocity vector. Let us denote the first derivative of the displace-
ment field vector u (i.e., the parameter function) as 0, and the second derivative
as ii. Note that 0 and ii represent the velocity and acceleration fields, respectively.
It follows from D'Alembert's principle that the elemental inertial and damping
forces dfl and dfD are given by
and
dfl = -po dV
(10-71
(10-8)
Recall that the minus signs are necessary if these additional terms are to be regarded
as stemming from external forces. It then follows from Chapter 5 that Eq. (5-46)
may be written as

580
TRANSIENT AND DYNAMIC ANALYSES
I,
(&E)T(J' dV = I,
(&u)Tb dV +1(&U)TS dS + 2: (&u)Tfp
v..
V"
s'
- I,
(&U)Tpo dV - I,
(&U)T,ui dV
(10-9)
v..
VII!'
Note that
and
Ii = du = d(Na
e
) = N da
e = Nae(T)
dt
ds
dr
(10-10)
(10-11a)
u = Nae(T)
where, for example, ae(T) is given by
ae = [U,(T)
V1(T) ! U2(T)
V2(T) i··· i UiT)
Vn(TW
(10-11b)
for two-dimensional problems. In Eq. (IO-llb), u;(T) and V;(T) are the x and y
components of displacement of node i at time T, and n is the number of nodes used
to define element e.
Following the procedure used in Sec. 5-7 for static stress analysis formulations,
we may write Eq. (l0-9) in the form
Meae + Deae + Keae = fe
(1.-12)
(10-13)
The element stiffness matrix K" and element nodal force vector fe remain the same
as in Sec. 5-7 [see Eqs. (5-86) to (5-92)]. However, two additional terms and
matrices arise. The matrix Me may be referred to as the element mass matrix,
whereas De may be referred to as the element damping matrix, both defined by
Me = I,
NT pN dV
v'
and
De = I,
NTflN dV
v'
(10-14)
The element damping matrix D' should not be confused with the material property
matrix D from previous chapters because the context makes the meaning clear (also
the material property matrix D is never written with a superscript). Note that for
each element, the nodal displacements, velocities, and accelerations are given by
ae, a e, and ae, respectively.
Equation (10-12) reduces to the more familiar
Keae = fe when the velocities and accelerations are zero or negligible.
The assemblage of the element mass matrices Me to form the assemblage mass
matrix Ma follows the procedure used to obtain the assemblage stiffness matrix Ka
from the element stiffness matrices K". An explicit form for the assemblage damping
matrix no is not usually known because the viscous matrix fl is not usually known.
Therefore, the assemblage damping matrix D is generally assumed to be given by
a linear combination of the assemblage mass and stiffness matrices, or

TRANSIENT THERMAL ANALYSIS
581
D = aM +
~K
(10-15)
where a and ~ are experimentally determined constants [3]. The damping implied
by Eq. (10-15) is referred to as Rayleigh damping. In any event, the assemblage
system equation may be written in the form
Ma+Da+Ka=f
(10-16)
Note that the superscript (") that is normally used to denote assemblage is no longer
written. The solution to Eq. (10-16) requires the specification of initial conditions
on the nodal displacements and velocities. In addition, the boundary conditions on
the nodal displacements must be imposed. These matters are dealt with in Sec.
10-9 where solution methods for Eq. (10-16) are presented.
Example 10-1
Determine the element mass matrix for one-dimensional, dynamic structural analysis
problems. Assume the two-node, lineal element.
Solution
If length coordinates are used, we may write Eq. (10-13) as
Me = r [L1] p[L,
L2 ] A dx = r [Lr
LI~2] pA dx
JJ<
L2
JI'
L2L 1
L2
With the help of Eq. (6-48) each entry in the matrix may be integrated to give
Me = pAL [2
1]
(10-17)
6
I
2
where L, the length of the element, should not be confused with the length coor-
dinates (which are always written with subscripts). Note that the total mass of the
element is given by pAL.
•
10-4
TRANSIENT THERMAL ANALYSIS
In Chapter 8 steady-state heat transfer problems were formulated. Recall that the
formulations were quite general, but no mechanism for energy storage was included.
It can be shown from the first law of thermodynamics that an additional term arises
in each of the governing equations presented in Chapter 8. For example, for one-
dimensional problems, the governing equation given by Eq. (8-3) becomes
st
a (
aT)
peA -
= -
kA -
-
hP(T -
Ta)
-
ECTP(T4
-
T:) + QA
(10-18)
aT
ax
ax
where p and e are the mass density and specific heat, respectively. Let us limit the
present discussion to heat conduction in solids (and quiescent liquids) so that the
specific heats at constant volume and constant pressure are virtually the same.

582
TRANSIENT AND DYNAMIC ANALYSES
Therefore, there is no need to distinguish between these two specific heats and,
hence, no subscript on c is needed. In Eq. (10-18), the variable A represents the
cross-sectional area of the object being analyzed and may be a function of x.
Similarly, for two- and three-dimensional heat conduction problems, the gov-
erning equations are given by
and
et
a (aT)
a (
aT)
pct- = -
kt -
+ -
kt -
-
h(T -
Ta)
aT
ax
ax
ay
ay
-
ECJ'(T4
-
T:) + qs + Qt
(10-191
(10-201
pc aT = i (J!!-) + i (kaT) + i (kaT) + Q
aT
ax
ax
ay
ay
az
az
In Eq. (l0-19), the variable t is the thickness of the two-dimensional region (and
hence the element thickness). Note that the variable T (not t) is used to represent
time. The governing equation for axisymmetric heat conduction is similarly mod-
ified, and the result is
st
I a (aT)
a ( aT)
pc- = - -
rk -
+ -
k-
+ Q
aT
r ar
ar
az
az
(10-211
Since a transient formulation is desired, we may employ partial discretization and
write the temperature T within a typical element e as
T =
Nae(T)
The shape function matrix N is unchanged from Chapter 8 and a'(r) is given by
(10-221
where Tj(T) is the temperature of node i at time T, and n is the number of nodes
used to define element e.
The Galerkin weighted-residual method may be used to derive the finite element
characteristics providing the energy storage term is represented in the governing
equation and hence the residual. The energy storage term is on the left-hand side
of Eqs. (10-18) to (10-21). For example, in two-dimensional problems, we begin
by writing the weighted residual equation as
f
[
aT
a (aT)
a (aT)
]
NT
pet -
-
-
kt -
-
-
kt -
+...
dx dy = 0
A'
aT
ax
ax
ay
ay
(10-231
The Green-Gauss theorem is applied in the usual manner on the terms involving
second-order derivatives. Except for the energy storage term, the formulation is
identical to that presented in Sec. 8-8. Because of the presence of the energy storage
terms, we no longer get Keae = fe but rather
ceile + Keae = fe
(10-241

(10-25)
(10·26)
TRANSIENT THERMAL ANALYSIS
583
The matrix C' is referred to as the element capacitance matrix and is defined by
C' = r NT pctN dx dy
JA'
for two-dimensional problems. Ina similar fashion it can be shown that the element
capacitance matrix in one-dimensional, transient heat conduction is given by
C' = rNT pcAN dx
J"
whereas in three-dimensional problems it is given by
C' = r NT pcN dx dy dz
Jv'
Finally, for axisymmetric problems, we have
C" = r 2'lTNT perN dr dz
JA'
Example 10-2
(10-27)
(10·28)
Show that the element capacitance matrix for one-dimensional heat conduction
problems is given by Eq. (10-26).
Solution
From the weighted residual equation
1 [
aT
a(
aT)
NT
pcA- -
-
kA-
A'
aT
ax
ax
-"']dx=O
it follows that an additional term, namely, celie, arises because we have
et
d(Na e)
-=--=
aT
dT
da e
N- = Nae
dT
and
r NT pcA aT dx = r NT pcA Nae dx = [r NT pcAN dx] ae = c-s-
J"
aT
J"
J"
The expression in the brackets is recognized as the element capacitance matrix
defined by Eq. (10-26).
•
Example 10-3
Evaluate the element capacitance matrix for the linear-order triangular element used
in the discretization of a two-dimensional region.

584
TRANSIENT AND DYNAMIC ANALYSES
Solution
The element capacitance matrix in this case is given by Eq. (10-25). If the shape
functions are written in terms of the area coordinates, we get
C' ~ L[~:] per IL, ~
L,l dx dy
With the help of Eq. (6-49), this matrix evaluates to
tA [2 I I]
C' = ~
I
2
I
12
I
I
2
(10-29)
where A is the area of the triangle. Note that the total capacitance of the element
(i.e., pctA) is distributed as given by Eq. (10-29).
•
The assemblage of the element capacitance matrices into the assemblage ca-
pacitance matrix is done in precisely the same manner as the assemblage of the
element stiffness (or conductance) matrices to form the assemblage stiffness (or
conductance) matrix. The assemblage system equation then takes the form
Cia + Ka = f
(10-30)
Before Eq, (10-30) can be solved forthe nodal temperatures, the initial and boundary
conditions must be imposed as shown in Sec. 10-7. Note that Eq, (10-30) is not
written with the superscript (0) which is generally used to indicate the assemblage
matrices before application of the geometric boundary conditions. This superscript
is dropped because it will unnecessarily clutter the notation in Sections 10-7 and
10-8.
10-5
LUMPED VERSUS CONSISTENT MATRICES
Lumped mass and capacitance matrices are always diagonal matrices, whereas
consistent mass or capacitance matrices are not necessarily diagonal. A diagonal
matrix is defined as a square matrix whose entries are zero everywhere but on the
principal diagonal. Recall from Chapter 2 that the principal diagonal always runs
from the upper left corner to the lower right corner of a matrix. The identity matrix
is an example of a diagonal matrix.
Consistent Matrices
Recall that the element mass matrix in all dynamic structural analysis problems
may be determined from Eq. (10-13), where dV must be taken to be A dx, t dx dy,

LUMPED VERSUS CONSISTENT MATRICES
585
or dx dy dz for one-, two-, and three-dimensional problems, respectively. For dy-
namic axisymmetric stress analysis, we simply take dV to be 2'Tl'r dr dz. When the
shape functions from the previous chapters are used, the resulting element mass
matrices are referred to as consistent element mass matrices.
In a similar fashion, the element capacitance matrices for one-, two-, and three-
dimensional transient thermal analysis problems are given by Eqs. (10-25) to
(10-27). Moreover, the element capacitance matrix for axisymmetric, transient
thermal analysis is given by Eq. (10-28). When the shape functions from previous
chapters are used, the resulting element capacitance matrices are referred to as
consistent element capacitance matrices.
Consistent element mass and capacitance matrices are discussed in more detail
below.
(10-31)
ptA
12
Me
Consistent mass matrices
Recall from Example 10-1 that the element mass matrix for one-dimensional dy-
namic, structural analysis problems is given by
Me =
pAL [2 i I]
(10-17)
6
I i 2
providing the linear-order, lineal element is used. Note that this matrix is not
diagonal. Note further that this result was derived in a consistent manner by using
the appropriate shape functions and Eq. (10-13) directly. It is for this reason that
this result is referred to as a consistent mass matrix. It can be shown that for the
linear-order, triangular element the consistent mass matrix is given by
20110:10
02:01101
_________ 1
1
_
10:20:10
01:02:01
---. - - - --:.--- - --_.:.--------
10:10:20
01:01:02
!
!
Again it is seen that the consistent mass matrix is not a diagonal matrix. This implies
that the assemblage mass matrix also will not be " diagonal matrix. Further im-
plications of this are discussed later in this section. These results may be generalized
to three-dimensional and axisymmetric problems as follows: If the element mass
matrix is evaluated from Eq. (10-13), a consistent mass matrix is obtained (assuming
that the shape functions from Chapters 6 and 9 are used).
Consistent capacitance matrices
Let us now consider the result from Example 10-3 where the element capacitance
matrix for two-dimensional, transient heat conduction problems is given by Eq.
(10-29) for the linear-order, triangular element. Note that this matrix is not diagonal
and that this result was derived in a consistent manner by using the appropriate

586
TRANSIENT AND DYNAMIC ANALYSES
shape functions and Eq. (10-25) directly. Therefore, the element capacitance matrix
given by Eq. (10-29) is referred to as a consistent capacitance matrix. This implies
that the assemblage capacitance matrix also will not be diagonal. The implications
of this in the solution step are discussed below. These results may be generalized
to other heat conduction problems as follows: If the element capacitance matrix is
evaluated from Eqs. (10-25) to (10-28), a consistent capacitance matrix is obtained
(assuming that the shape functions from Chapters 6 and 9 are used).
Lumped Mass and Capacitance Matrices
In the solution for the nodal displacements and temperatures, the initial part of the
solution may tend to be oscillatory about the true solution if the consistent mass or
capacitance matrix is used. These oscillations generally do not occur if the so-called
lumped mass or capacitance matrix is used. Recall that a Iumped matrix is a diagonal
matrix. In order to illustrate these trends, consider the temperature versus time
curve for a typical node in a thermal analysis shown in Fig. 10-1. Note that the
solution with the consistent capacitance matrix oscillates about the solution for the
lumped matrix. This does not imply that the solution with the lumped matrix is the
exact solution. Some researchers argue that the wiggles that arise when the consistent
matrix is used are a signal to the analyst that smaller time steps should be used in
the vicinity of the wiggles. Others such as Gresho and Lee [4] contend that the
results from the lumped matrix are no more accurate, but since there are no wiggles,
these results are erroneously accepted as correct.
/"" Consistent capacitance matrix
/' Lumped capacitance matrix
Time
Figure 10-1
Temperature of a typical node versus time for a transient thermal analysis
performed with a consistent capacitance matrix and a lumped capacitance matrix.

LUMPED VERSUS CONSISTENT MATRICES
587
A rule of thumb will now be given that can be used to obtain the lumped form
of the mass and capacitance matrices from the consistent matrices. The lumped
mass or capacitance matrix is obtained by scaling the diagonal entries in the con-
sistent mass or capacitance matrix such that the total mass or capacitance is preserved
[5]. In general, any lumping that preserves the total mass or capacitance will lead
to convergent results. If this rule is applied to the consistent mass matrices given
by Eqs. (10-17) and (10-31), the corresponding lumped mass matrices are given
by
and
Me = pAL[1 i0]
2
0 i I
(10-32)
ptA
Me =-
3
o 0 000
o
I
0
0
0
0
-- - -- - - - --- - - - ---- ------
o 0
I 000
000
1
0
0
._-------- - --------------
000
0
1
0
o 0 000
1
(10-33)
(10-34)
respectively. Note that in both cases the total mass for the element is equally
allocated to the nodes (and to each degree of freedom). Similarly, the lumped form
of the capacitance matrix that corresponds to Eq. (10-29) is given by
[I 0 0]
C e =
pctA 0
I
0
3
0
0
1
The reader may recall that the finite difference method always yields the lumped
matrices directly. One advantage of the lumped form of the capacitance matrix is
that the solution for the nodal unknowns (i.e., the nodal temperatures) may be
obtained in a more straightforward manner as explained in Sec. 10-7 (i.e., a so-
called explicit solution results).
The above rule of thumb may also be applied to the higher-order elements
from Chapter 9. For example, for the quadratic-order, rectangular element in the
serendipity family, it can be shown that the consistent capacitance matrix is given
by
6
2
3
2
-6
-8
-8
-6
2
6
2
3
-6
-6
-8
-8
3
2
6
2
-8
-6
-6
-8
C" =
pctA
2
3
2
6
-8
-8
-6
-6
(10-35)
180
-6
-6
-8
-8
32
20
16
20
-8
-6
-6
-8
20
32
20
16
-8
-8
-6
-6
16
20
32
20
-6
-8
-8
-6
20
16
20
32

S88
TRANSIENT AND DYNAMIC ANALYSES
Note that the nodes must be numbered as shown in Fig. 9-5(b). If the diagonal
entries in Eq. (10-35) are scaled such that the total capacitance is preserved, the
lumped capacitance matrix is given by
C'
pctA
12
-I
0
o - I
o
0
o
0
o
0
o
0
o
0
o
0
000000
000000
-I
0
0
0
0
0
o -I
0
0
0
0
004000
o
0
0
4
0
0
o
0 004
0
o
0
0
0
0
4
(10-368)
This matrix was obtained by summing the entries in a given row in the consistent
matrix, dividing the result by the total capacitance, and allocating this result to the
diagonal entry of the row under consideration. Interestingly, the capacitance allo-
cated to the comer nodes as given by Eq. (1O-36a) is negative. Although this is
known to give good results, this form of the lumped matrix is numerically incon-
venient and is seldom used. Instead, the following form of the lumped capacitance
matrix is frequently used:
C'
pctA
36
1
0
0
0
0
0
0
0
o
I
0
0
0
0
0
0
o 0
1
0
0
0
0
0
000
1
0
0
0
0
o 0 008 000
o 0 000
8
0
0
o 0 000
0
8
0
o 0
0
0
0
0
0
8
(10-36b)
Equation (l0-36b) gives excellent results and is the recommended form of the
lumped capacitance matrix in this case.
Ineach case, the consistent and lumped form of the matrices appear to be quite
different. However, except for the very early portion of the solution, both give
virtually the same results. The reader may want to consult Zienkiewicz's book [6]
for more information on the subject of lumping.
10-6
SOLUTION METHODS
Equations (10-16) and (10-30) need to be solved for the nodal displacements and
temperatures, respectively, as a function of time. The boundary and initial conditions
also need to be imposed. The two main methods of solution that can be used are
based on the finite difference and finite element methods. Both of these methods
result in a two-point recurrence scheme for the solution of Eq. (10-30), whereas a
three-point recurrence scheme results for the solution of Eq. (10-16). In Sec.
10-7, Eq. (10-30) is solved by using three different types of finite difference

TWO-POINT RECURRENCE SCHEMES: THE FINITE DIFFERENCE METHOD
589
schemes. In Sec. 10-8, it is shown that these three schemes are really a special
case of the more general finite element solution in time. The three-point recurrence
scheme for the solution of Eq. (10-16) is derived in Sec. 10-9. The subject of
numerical stability of the various solution methods is a very important one. Although
a very brief introduction to this is given in Sec. 10-7, the reader should consult
references 7 to 9 for more complete discussions. Recurrence schemes may also be
referred to as recursion formulas. In this text, both designations are used inter-
changeably.
10-7
TWO-POINT RECURRENCE SCHEMES: THE FINITE DIFFERENCE
METHOD
Recall that all transient thermal analyses result in the equation
Ca+Ka=f
(10-30)
(10-37)
(10-38)
(10·39)
In this section three different solution methods are derived for the solution of this
equation by using three different types of finite differences. In particular, forward,
backward, and central differences are used. It will be seen that the resulting re-
currence schemes can be summarized by one all-encompassing equation. Boundary
and initial conditions will be considered at the appropriate point in the development.
Forward Difference Scheme
By definition, the derivative of the a with respect to the time T is given by
.
da
.
a(T +
~T) -
a(T)
a = -
= lim
dt
LlT~O
~T
Recall from elementary differential calculus that arr) and a(T + ~T) 'denote the
values of the vector a at times T and T +
~T, respectively. However, the notion
of a finite difference implies that we do not require ~T to approach zero. Instead,
a small but nonzero ~T is used, and we approximate aby
.
a(T + ~T) -
a(T)
a == -'----'---'--'-
~T
The change in time, or ~T, is referred to as the time step. If Eq. (10-38) is used
to eliminate ain Eq. (10-30), we get
C a(T + ~T) -
a(T) + Ka = f
~T
Since we desire a forward difference, we must evaluate the remaining terms in Eq.
(10-39) at time T, or

S90
TRANSIENT AND DYNAMIC ANALYSES
C
a(T + .:IT) -
a(T)
K
.:IT
+
a(T) =
f(T)
(10-40)
If Eq. (10-40) is multiplied by .:IT and written such that only the term containing
a(T + .:IT) appears on the left-hand side, we get
Ca(T + .:IT) =
[C
-
K.:lT)a(T) + f(T) M
(10-41)
Let us denote the vectors a(T) and a(T + .:IT) as a, and ai+1> respectively, and f(T)
and f(T + .:IT) as fi and fi+ J • Therefore, we may write Eq. (10-41) as
(10-42)
Equation (10-42) is referred to as a two-point recurrence scheme because the right-
hand side is completely known at any time T, including T = 0 for which the initial
conditions apply. Therefore, Eq. (10-42) may be applied recursively to obtain the
nodal temperatures for a subsequent time given the temperatures for the preceding
time. Boundary conditions may be imposed as described later in this section. The
forward difference method is also known as Euler's method.
Note that if the lumped form of the capacitance matrix is used, the assemblage
capacitance matrix C is diagonal. In this case the solution for the jth nodal tem-
perature is given explicitly by dividing the jth row on the right-hand side of Eq.
(10-42) by the jth diagonal entry in the C matrix. Hence, the solution in this case
is frequently referred to as an explicit solution. This is the principal advantage of
the forward difference (or Euler's) method. Conversely, if the consistent capacitance
matrix is used, an implicit solution for a.; J is required because C is no longer
diagonal. In this case, the matrix inversion method or the active zone equation
solver (i.e., subroutine ACTCOL [10)) may be used to determine the nodal tem-
peratures at time T + .:IT.
Euler's method is also convenient from the standpoint of nonlinear analyses.
Recall that a thermal analysis becomes nonlinear if any of the properties is tem-
perature-dependent or if thermal radiation is present. Since the terms in Eq.
(10-30) must be evaluated at time T and since the temperatures are always known
at this time, it is not necessary to iterate to obtain the solution for time T + .:IT
for such problems.
The principal disadvantage of this method will be illustrated numerically in
Sec. 10-8 where an application is presented. Suffice it to say here that this method
requires a relatively small time step for both stability and accuracy. In other words,
if the time step exceeds a certain critical value for the mesh used, the solution
becomes oscillatory and blows up as the time increases. Even though the time step
may be below this critical value, the results may still be quite inaccurate (but stable).
The accuracy of this method generally improves for successively smaller time steps.
In fact, one somewhat practical way to assess the accuracy of the solution is to
compare the results for two different time steps, e.g., .:IT and 2 .:IT. If the results
for the two different time steps are within some acceptable tolerance, a good
approximation to the true solution has been obtained.

TWO-POINT RECURRENCE SCHEMES: THE FINITE DIFFERENCE METHOD
591
Backward Difference Scheme
If the derivative of a with respect to the time 7 is written in the backward direction
(with respect to the time) and if we do not require the time step Ll7 to be zero, we
may write
(10-43)
.
a(7)
a == --'---'----'-----'-
a(1 -
Ll7)
Ll7
Recognizing that the remaining terms in Eq. (10-30) should be evaluated at time
7, we get
C a(7) -
~~ -
Ll7) + Ka(7) = f(7)
(10-44)
After multiplying each term by Ll7 and rearranging such that the terms involving
arr) appear on the left-hand side, we have
[C + KLl7]a(7) = Ca(7 -
Ll7) + f(7) Ll7
(10-45)
Note that the arguments 7 and 7 -
Ll7 on a and f are relative; in other words,
nothing is changed if we substitute 7 + Ll7 for 7 (and 7 for 7 -
Ll7) to give
[C + KLl7]a(7 + M) = Ca(7) + f(7 + Ll7) Ll7
(10-46)
Let us again use the subscripts i and i + I to denote times 7 and 7 + Ll7, re-
spectively, so that the two-point recurrence scheme from the backward difference
method is given by
(10-47)
As in the case of the recurrence formula from the forward difference method, the
right-hand side is completely known at time 7 including fi+1 because it will be
recalled that the vector f represents the forcing function for the analysis. Therefore,
Eq. (10-47) may be applied recursively to obtain the nodal temperatures for a
subsequent time given the temperatures for the previous time.
Note that even if the capacitance matrix C is diagonal, an implicit solution for
the vector a.; I must be obtained because the stiffness (or conductance) matrix K
is never a diagonal matrix. The backward difference method is stable for all Ll7,
but the accuracy deteriorates as the time step is increased. Again the accuracy may
be assessed by comparing the results for two different time steps.
Central Difference Scheme
Let us again represent the time derivative of a by Eq. (10-38). However instead of
evaluating the other terms in Eq. (lO-30) at time 7 or time 7 + Ll1', let us use the
average values. In other words, let us' take

(10-49)
592
TRANSIENT AND DYNAMIC ANALYSES
a(T + llT) + a(T)
a =
2
and
f = f(T + llT) + f(T)
2
This is equivalent to taking a central difference and we have
C a(T + llT) -
a(T) + K a(T + llT) + a(T) = f(T + llT) + f(T)
~
2
2
Multiplying through by llT and isolating the terms containing a(T + llT) gives
(c + K 2
11T)a(T + llT)
(c
KilT)
[f(T) + f(T + llT)] llT
=
- -2-
a(T) +
2
(10-48)
In terms of the subscript notation used above, Eq. (10-48) becomes
(c + K 2~)a;+1 = (c _K
211T)a; + (f; + ~+I) llT
As in the backward difference scheme, the recursion formula given by Eq.
(10-49) requires an implicit solution for the nodal temperatures at time T + llT
given those at time T. This method results in an oscillatory solution if the critical
time step for stability is exceeded. For time steps smaller than this critical value,
the accuracy of the solution improves as the time step is decreased. Not surprisingly,
the central difference method is more accurate than both the forward and backward
difference schemes because the central difference favors neither the temperatures
at time T nor those at time T + llT. The central difference method is also referred
to as the Crank-Nicolson method.
Summary and Application of the Prescribed Temperatures
The three recurrence formulas given by Eqs. (10-42), (10-47), and (10-49) may be
summarized in one convenient equation as
[C + 6K llT]a;+ 1 = [C - (I - 6)K llT]a; + [(I - 6)f; + 8f;+ d llT
(10-50)
where the parameter 6 takes on values 0, liz and I for the forward, central, and
backward difference schemes, respectively.
Strictly speaking, for values of 6 other than 0, an iterative solution is required
for each time step if any of the properties is temperature dependent or if thermal
radiation is included in the model. In other words, the matrices K and C should

TWO-POINT RECURRENCE SCHEMES: THE FINITE DIFFERENCE METHOD
593
really be evaluated with the nodal temperatures that correspond to the value of 6
being used. The temperatures for the (j+ l)st iteration (denoted by a/" 1) may be
computed from the nodal temperatures from the jth iteration with the help of the
following equation:
aj + 1 = (1 -
6)al + 6a/+ 1
(10-51)
where a( and a(+ 1 denote the nodal temperatures at times T and T + IlT, respec-
tively, for the jth iteration. Note that for the forward difference or Euler's method
(for which 6 is zero) it is not necessary to iterate (why not?).
Recall that the initial conditions or 30 = a(O) are automatically incorporated
in the solution process because these values of a (at T = 0) are used to start the
recursion process. This is to say that 30 is taken as a(O) from which a, may be
found from Eq, (10-50). The recursion process is illustrated schematically in Fig.
10-2.
Only prescribed temperature boundary conditions need to be considered at this
point because all other boundary conditions (prescribed heat flux, convection, etc.)
are automatically included in the finite element formulation. Prescribed temperatures
may be imposed by either of the two methods from Sec. 3-2 because Eq. (10-50)
is of the form Keffa = feff, where K eff is really C + 6K IlT from Eq. (10-50) and
feff is given by the entire right-hand side of Eq. (10-50). As in the steady-state case,
it is desirable to preserve symmetry because this substantially reduces the storage
requirements in large problems. In summary, application of the prescribed tem-
perature boundary conditions for transient thermal analyses is really no different
from that in steady-state problems, if the prescribed temperatures are imposed on
the vector a.; I in Eq, (10-50). Note that the prescribed temperatures may possibly
be a function of time.
From a practical point of view, if the numerical solution appears to oscillate
when the physics of the problem would preclude this, the time step is too large for
the mesh used. Reducing the time step to below that for which the instability or
oscillation disappears is a very practical remedy. These comments apply in particular
to the forward and central difference schemes. Accuracy may be assessed by com-
r = t!.r
i = 0
ao = a(O)
_
a
r = 2t!.r
i = 1
_______
1
<>:
.,
r = 3t!.r
i = 2
a,.>:
r = 4t!.r
i = 3
a3~a.
r = 5t!.r
i = 4
etc.
etc.
a. _______ ",
etc.
Figure 10-2
Schematic diagram of the two-point recursion process.

S94
TRANSIENT AND DYNAMIC ANALYSES
paring the results for two cases with different time steps: If there is a significant
difference between the results, then the time step should be reduced further and
the analysis repeated.
10-8
TWO-POINT RECURRENCE SCHEMES: THE FINITE ELEMENT
METHOD
The finite element method itself may be applied to Eq. (10-30) as shown in this
section. Because the time domain is to be discretized, the elements used may be
referred to as temporal elements to distinguish them from the elements used to
discretize the body. It will be seen that the three recursion formulas from Sec.
10-7 are really a special case of the more general finite element method. In particular
Eq. (10-50) will be derived by discretizing the time domain from time T to time
T + /IT with a suitable first-order element. One such element is shown in Fig.
10-3 where times T and T + /IT are denoted as T; and T;+ I> respectively. Note the
shape functions N; and N;+ I are also shown. These shape functions are now a
function of time. However, mathematically they are no different than those presented
in previous chapters except that T replaces x. If the weighted-residual method is
used to solve Eq. (10-30), we may write
iT'+' W[Cil + Ka -
f] dt = 0
T,
(10-52)
where the weighting function W is a scalar in this case. Different choices for W
will yield different two-point recurrence schemes.
With the help of the shape functions, we may represent the vector a in Eq.
(10-52) as
(10·53)
because the shape functions are linear with time and evaluation of Eq. (10-53) at
times T; and T; + I yields a; and a; + I' respectively, as desired.
_1c><l1_'T
T,
Ti + 1
Figure 10-3
The two-node temporal element and its associated shape functions.

TWO-POINT RECURRENCE SCHEMES, THE FINITE ELEMENT METHOD
595
For convenience let us define a local normalized coordinate ~ as follows:
T
-
Tj
~ =
Ti+1
-
Tj
T
-
Tj
~T
(10-54)
such that for T =
Tj and T =
Tj + l' we have
~ = 0 and
~
follows that the shape functions N, and Ni; I are given by
N, =
I -
~
and
I, respectively. It
(10-55a)
(10-55b)
Figure 10-3 shows the behavior of the shape functions over the time interval from
T = Tj to T =
Tj + 1. As mentioned above, these shape functions are no different
from those for the linear-order, lineal element in Chapters 6 and 9.
With the help of Eqs. (10-55), we may write Eq. (10-53) as
a = (I -
~)aj +
~aj + 1
from which it follows that
or
Similarly, f may be represented as
f = N,fj + N'+lf,+1
or
f = (I -
~)fj +
~fj +1
From Eq. (10-54), it follows that dt is related to d~ by
ds =
~T d~
Therefore, Eq. (10-52) may be written as
(10-56)
(10-56)
(10-57)
(10-58)
(10-59)
(10-60)
!olW{ C [ - ~T a, + ~T a, + 1] + K[(I -
~)aj + ~aj + d
-
[(I -
~)fj + ~fj+d} ~T d~ = 0
(10-61)
where the weighting function W is still unspecified. Equation (10-61) may be put
into the following more convenient form:

S96
TRANSIENT AND DYNAMIC ANALYSES
[ Ci
J
W d~ + K~Ti' W~ d~] a., 1 = [Ci
J
W d~ -
K~Ti
J
W(I -
~)d~] a,
+ [~Ti
J
W(I -
~) d~] f i + [~Ti
J
W~ d~Jri+1 (10-62)
Dividing both sides of Eq. (10-62) by f~ W d~ gives the desired result:
[C +
6K~Tlai+ 1 =
[C -
(I -
6)K~Tlai + [(I -
6)fi + 6fi+ d ~T
(10-63)
where the parameter 6 is defined by
i'W~ d~
6 = i'W d~
(10-64)
Note that Eqs. (10-50) and (10-63) are identical. It is emphasized that Eq. (10-50)
was derived and generalized from three different finite difference schemes, whereas
Eq. (10-63) was derived directly via the finite element method. Different choices
for the weighting function W will yield different values for the parameter 6. In
particular the point collocation, subdomain collocation, and Galerkin methods
from Chapter 4 will be used to determine the corresponding value of 6 from
Eq. (10-64).
Point Collocation
Recall from Sec. 4-6 that the weighting functions for the point collocation method
are given by &(~ -
~) such that
il&(~ -
~)d~ =
I
for
~ =
~j
(10-668)
and
for
~ ¥
~j
110-66b)
where
~j is known as a collocation point. For point collocation at time Ti (i.e.,
Ti = T) where ~ = 0, it can be shown that 6 = O. Similarly for point collocation
at times (Ti + Ti+ 1)/2 and Ti+ I> where
~ = Yz and ~ = I, it can be shown that
6 = Yz and 6 = I, respectively. Thus it is seen that point collocations at times Ti'
(r, + T i + \)/2, and Ti+ 1 correspond to the forward, central, and backward difference
schemes, respectively.
Example 10-4
Show that point collocation at time (r, + Ti+ \)/2 gives 6 = Yz.

TWO-POINT RECURRENCE SCHEMES: THE FINITE ELEMENT METHOD
597
Solution
At time (r, + Ti + 1)/2 we have ~ = !h and so the collocation point
~j must be Yz.
Thus the weighting function W is given by
W =
o(~ -
Yz)
and Eq. (10-64) gives
6
faJ o(~ -
Yz)~ d~
faJ o(~ -
Yz) d~
Yz
Yz
6
Note that the numerator in the above expression for 6 is zero except at the collocation
point where
~ =
!h.
•
Subdomain Collocation
It should be recalled from Sec. 4-6 that the weighting functions for the subdomain
collocation method are unity over a particular subdomain and are zero elsewhere.
Since only one unknown, namely, a, + J, is to be found, we must take only one
weighting function or W = lover the time interval from T to T + llT (i.e., from
Ti to Ti+ I)' The value of 6 for this case may be determined as follows:
faJ W~ d~
fa! (1)~ d~
~ I~
faJWd~
faJ(1)d~ =
~I~ = Yz
Therefore, the subdomain collocation method is analogous to the central difference
scheme or Crank-Nicolson method from Sec. 10-7.
Galerkin
The weighting functions for the Galerkin method are taken to be the shape functions
themselves. In other words, we may take either
or
W = N, =
I -
~
(10-67al
(10-67bl
The shape functions are shown graphically in Fig. 10-3. It can be shown that if
Eq. (10-67a) is used, we get 6 =
YJ, whereas if Eq. (1O-67b) is used, we get 6 =
¥3. Neither of these values corresponds to any of the results from the finite difference

598
TRANSIENT AND DYNAMIC ANALYSES
method. However, 8 =
¥3 is particularly useful because it is more accurate than
the backward difference scheme (8 =
I) and more stable than the central difference
scheme (6 =
Y2).
Example 10-5
Show that the parameter 8 takes on a value of ¥1 if the weighting function is given
by Eq. (1O-67b).
Solution
By definition of 8, we have
which is the desired result.
8
!oj (~)~ d~
fo
l
(~) d~
•
Example 10-6
Reconsider the circular pin fin from Example 4-11. For convenience, the fin is
shown in Fig. 1O-4(a). Recall that the fin is made of pure copper with a thermal
conductivity k of 400 W/m-oC. The base is held at a temperature Th of 85°C and
Baseof
fin
(bl
Insulated
tip
Figure 10-4
Circular pin fin (a) analyzed in Example 10-6 and (b) discretized into two
elements and three nodes.

TWO-POINT RECURRENCE SCHEMES; THE FINITE ELEMENT METHOD
599
the ambient temperature To is maintained at 25°C. The fin length Lf is 2 em, and
the diameter D is 0.4 cm. The tip of the fin at x = Lf is insulated. Determine the
transient temperature distribution within the fin if the entire fin is initially at 25°C.
The density p and specific heat e are 8900 kg/m' and 375 J/kg-OC, respectively.
Assume the consistent form of the capacitance matrix, a time step of 0.1 sec, and
e = 1'3. Use only two elements of equal length as shown in Fig. 1O-4(b).
Solution
Equation (10-50) or (10-63) provides the basis for the transient solution. Because
the same fin was analyzed in Example 4-11, we may use most of the results from
that example. In particular, the element stiffness matrix and nodal force vectors are
unchanged. It follows that the assemblage stiffness matrix and nodal force vector
are also unchanged. Therefore, from Example 4-11, we have
[
0.50893
-0.49951
0]
K =
-0.49951
1.01786
-0.49951
o
- 0.49951
0.50893
and since the nodal force vector is not time-varying, we have
[
0.23561]
f; = fi + I = f =
0.47122
0.23561
We now need to compute the element capacitance matrix. It can be shown for
the linear-order lineal element that Eq. (10-26) evaluates to
c- =
peAL [2 I]
6
I
2
(10-68)
where A and L are the cross-sectional area and length of the element, respectively.
Equation (10-68) is an expression for the consistent capacitance matrix. Let us now
evaluate this matrix for the problem at hand. Noting that the two elements are
identical, we may write
(8900)(375)(1.256
66
X 10-5)(0.01) [2
1
21]
C(I) = Cm = -'----'----'--------'-----'-
or
C(I> = Cm = [0.13980
0.06990]
0.06990
0.13980
The assemblage of the element capacitance matrices is done in precisely the same
manner as the assemblage of the element stiffness matrices. The result is
[
0.13980
0.06990
0]
C =
0.06990
0.27960
0.06990
o
0.06990
0.13980

-0.4~951]
0.50893
- 0.4~951 ]}[;;:]
0.50893
25.
o
][25.]
[0.02356]
0.08655
25.
+
0.04712
0.12284
25.
0.02356
600
TRANSIENT AND DYNAMIC ANALYSES
Note that C is not diagonal because the consistent capacitance matrix has been
used. The matrix K"rr may now be computed as
[
0.13980
0.06990
0]
Keff = C + 6K I1T =
0.06990
0.27960
0.06990
o
0.06990
0.13980
[
0.50893
- 0.49951
+ 1'1(0.1)
-0.49951
1.01786
o
-0.49951
or
[
0.17373
0.03660
0]
Keff =
0.03660
0.34746
0.03660
o
0.03660
0.17373
Similarly the vector ferr is given by the right-hand side of Eq. (10-50) [or Eq,
(10-63)], or
feff = [C -
(I -
6)KI1T]3; + [(I -
6)f; + 6f;+d I1T
Since the force vector f does not change with time in this application, we should
note that
[(I -
6)f; + 6f;+d I1T = [(I -
6)f + 6f]I1T = f I1T
Therefore, from
ferr = [C -
(I -
6)K I1T]3; + f I1T
and the fact that 3; is the vector of nodal temperatures at time T = 0 at this point
in the solution, we get
{[
0.13980
0.06990
0]
feff =
0.06990
0.27960
0.06990
o
0.06990
0.13980
[
0.50893
- 0.49951
-
(I -
1')0.1
-0.49951
1.01786
o
-0.49951
[
0.23561]
+
0.47122
(0.1)
0.23561
[
0.12284
0.08655
0.08655
0.24567
o
0.08655
or
feff = [I~:;~~;]
5.2582

TWO-POINT RECURRENCE SCHEMES: TilE FINITE ELEMENT METHOD
601
The temperatures at time 'T
Keffa = feff , or
0.1 sec are then computed from the solution of
[
0.17373
0.03660
o
0.03660
0 ][TI]
[5.2582]
0.34746
0.03660
t;
=
10.5165
0.03660
0.17373
T3
5.2582
However, the prescribed temperature of 85°C must be imposed on node 1. Using
Method I from Sec. 3-2 (and preserving the symmetry), we get
[
1.00000
0
0 ][TI]
[85.0000]
o
0.34746
0.03660
t,
=
7.4055
o
0.03660
0.17373
T3
5.2582
Solving this system of linear algebraic equations gives
T) = 85.0°C
T: = 18.5°C
T3 = 26.4°C
for the nodal temperatures at the end of the first time step, i.e., at 'T = 0.1 sec.
Note that the temperature of node 2 (i.e., Tz) is not physically realizable. This is
a consequence of using the consistent capacitance matrix and is discussed further
below.
The nodal temperatures at subsequent time steps may be computed from the
two-point recurrence relation:
[
0.17373
0.03660
0
][TI('T + Jh)]
0.03660
0.34746
0.03660
Tz('T + 11'T)
o
0.03660
0.17373
T3('T + 11'T)
[
0.12284
0.08655
0
] [TI('T)]
[0.02356]
=
0.08655
0.24567
0.08655
Tz{'T)
+
0.04712
o
0.08655
0.12284
Ti'T)
0.02356
The results are summarized in Table 10-1 for r up to 2 sec and in Fig. 1O-5(a) for
'T up to 6 sec, the time at which steady-state appears to have been attained. In order
to see the initial oscillations in the nodal temperatures, the results for the first five
time steps are shown in Fig. 1O-5(b). Recall that these initial oscillations are
characteristic of the solution when the consistent capacitance matrix is used.
•
With the help of the problem posed in Example 10-6, let us discuss the accuracy
and stability issues further. Figure 10-6 shows the solution for the temperature of
the tip of the fin from Example 10-6 in comparison with two other cases. Both of
these other transients were obtained with a 0.5-sec time step. The first case cor-
responds to Euler's method (6 = 0); the second case to the Crank-Nicolson method
(6 =
Yz). Note that the critical time step for stability has been exceeded in the case
of Euler's method. This is evidenced by the oscillatory temperature as a function
of time. Note further that the amplitudes of the oscillations are growing with time
(recall that this solution can be made stable if a small enough time step is used).
In direct contrast the Crank-Nicolson method happens to be stable for a 0.5-sec
time step. Although it is not shown heres the Crank-Nicolson method tends to give

602
TRANSIENT AND DYNAMIC ANALYSES
Table 10-1
Resulting Nodal Temperatures for Example 10-6
Time. sec
TI.oC
r.;«:
T3• oC
0.1
85.0
18.5
26.4
0.2
85.0
29.7
21.7
0.3
85.0
36.4
22.7
0.4
85.0
41.0
25.6
0.5
85.0
44.7
29.3
0.6
85.0
47.8
33.1
0.7
85.0
50.5
36.7
0.8
85.0
53.0
40.1
0.9
85.0
55.2
43.2
1.0
85.0
57.3
46.1
1.I
85.0
59.2
48.8
1.2
85.0
61.0
51.3
1.3
85.0
62.6
53.6
1.4
85.0
64.1
55.7
1.5
85.0
65.5
57.7
1.6
85.0
66.8
59.5
1.7
85.0
67.9
61.1
1.8
85.0
69.0
62.7
1.9
85.0
70.0
64.1
2.0
85.0
70.9
65.4
oscillatory (but stable) results if an excessively large time step is used and the
accuracy of the solution deteriorates as well. Recall that the backward difference
scheme is stable for all time steps, but it becomes increasingly less accurate as the
time step increases. Hence, a good compromise is to carry out the solution with a
value of e of 1'3.
Example 10-7
Repeat Example 10-6 with a lumped capacitance matrix in order to illustrate the
lack of oscillations in the early portion of the transient solution for the nodal
temperatures.
Solution
The lumped form of the capacitance matrix for the two-node, lineal element is
given by
c- =
peAL[I 0]
2 ° I
Therefore, numerically the element capacitance matrices are given by
C(\l = C(2) = [0.20970
0]
°
0.20970

TWO-POINT RECURRENCE SCHEMES: THE FINITE ELEMENT METHOD
603
80
70
u
",60!
0-
E 50
'"
f-
40
30
50
2
3
Time, sec
(a)
4
40
u
~- 30
~
'"0-
E 20
'"
f-
10
......-
..........
............
--
----..-
Node 3
Time, sec
(b)
Figure 10-5(a)
Temperature as a function of time for the node at the tip of the fin in
Example 10-6. (b)
Temperatures as a function of time of nodes 2 and 3 in Example
10-6. Note the oscillations in the early portion of the transient.
It is left as an exercise to show that the two-point recurrence relation in this case
becomes
[
0.24363
- 0.03330
- 0.03330
0.48726
o
-0.03330
[
0_19274
0.01665
0.01665
0.38547
o
0.01665
o
][T1(T + Lh)]
-0.03330
T2(T + Lh)
0.24363
TiT + .:IT)
o
][Tl(T)]
[0.02356]
0.01665
T2(T)
+
0.04712
0.19274
T3(T)
0.02356

604
TRANSIENT AND DYNAMIC ANALYSES
100
90
~\
'\, \
/ \
80
70
~
~-ae
'"0-
E'"
f-
Time, sec
Figure 10-6
Comparison of the tip temperatures for the fin in Example 10-6for different
values of the parametere.
Table 10-2 shows the nodal temperatures for the first 2 sec of the transient. Note
the lack of oscillations in the nodal temperatures during the first few time steps
(unlike the results with the consistent capacitance matrix), Note also that the results
from Example 10-6 with a consistent capacitance matrix and the results from this
example are within 1°C of each other after about one second,
•
10-9
THREE-POINT RECURRENCE SCHEMES
In this section we will develop a three-point recursion formula for the solution of
Eq. (10-16). A suitable temporal element is used as shown below. In particular,
the time domain will be discretized with second-order, lineal elements. One such
element is shown in Fig. 10-7 where the shape functions are also shown. Note that
the element runs from time T - .h to time T + i1T and the center node corresponds
to time T, Times T
-
i1T, T, and T + i1T will be denoted by Tj - 1, Tj, and T,+l'
respectively. The shape functions for nodes i-I, i, and i + I are denoted as
N, _I' Nj , and N j + I and are given by Eq. (9-5) in terms of the serendipity coordinate
r.

THREE-POINT RECURRENCE SCHEMES
605
Table 10-2
Resulting Nodal Temperatures for Example 10-7
Time, sec
r.. °C
T2,oC
T3,oC
0.1
85.0
29.1
25.6
0.2
85.0
34.6
27.0
0.3
85.0
39.1
29.2
0.4
85.0
42.9
31.7
0.5
85.0
46.2
34.4
0.6
85.0
49.1
37.2
0.7
85.0
51.6
39.9
0.8
85.0
53.9
42.6
0.9
85.0
56.0
45.1
1.0
85.0
57.9
47.5
1.1
85.0
59.7
49.8
1.2
85.0
61.3
52.0
1.3
85.0
62.7
54.0
1.4
85.0
64.1
55.8
1.5
85.0
65.4
57.6
1.6
85.0
66.5
59.2
1.7
85.0
67.6
60.7
1.8
85.0
68.6
62.1
1.9
85.0
69.6
63.5
2.0
85.0
70.4
64.7
The weighted-residual method requires that we weight the residual with a
weighting function, integrate the result with respect to time over the interval from
Tj _ I to Tj + l e and set the result to zero, or
(+,' W{Mli + Dit + Ka - f} dt = 0
(10-691
Figure 10·7
The three-node temporal element and its associated shape functions.

606
TRANSIENT AND DYNAMIC ANALYSES
As in the case of the two-point recurrence formula, different choices for the scalar
weighting function W will yield different three-point recurrence schemes.
With the help of the shape functions, the vector a in Eq. (10-69) may be written
as
(10-70)
Note that the vector a is assumed to vary parabolically with time such that at time
Tj _ I' we have a, _I' etc. It is emphasized that the shape functions are functions of
time and ai-I, a., and a.; I are constant vectors, where a., I denotes the nodal
displacements at time
T +
~T, etc. The second derivative of a [the ii in Eq.
(10-69)) requires that at least second-order shape functions be used; otherwise, ii
would be identically zero. For convenience the shape functions are given below.
Yn(l + r)
N 3
(I + r)(I
-
r)
(9-5)
Recall that the midside node (at time T;) must be midway between the two end
nodes. Note that the serendipity coordinate r is related to the time T by
T
-
Tj
r =
and dr is related to dt by
for
Ti-I ::; T ::; Tj + I
I
dr = -
dt
~T
(10-71)
(10-72)
Therefore, we may write Eq. (10-70) as
a =
- Yzr(l
-
r)a j _ 1 + (I
-
r)(I + r)a i + Yzr(l + r)a i+ I
(10-73)
For it, we get
or
da
dT
da dr
dr dT
I da
~T dr
(10-74a)
For ii, we have
I
~T[(- Yz + r)ai_ 1 -
2raj + (Yz + r)ai+d
ii
d(dit)
d(I
da) dr
= dT
dT
= d;
~T dr
dT
(10-74b)
(10-75a)

THREE-POINT RECURRENCE SCHEMES
607
or
I
d 2a
I
a = (.l,.f dr2 = (.l,.)2[aj-1 -
2aj + aj+d
Similarly, the vector f may be represented as
f = Nj_1fj_ 1 + Njfj + Nj+1fj+1
or
(10-75b)
(10-76a)
f =
-
YIT(I -
r)fj_ I + (I
-
r)(I + r)fj + Y2r(l + r)fj+1
(10-76b)
Therefore, Eq. (10-69) may be written as
+1
{ (1)2
f-I W
M
.l,.
[a;_1 -
2a; + a;+d
I
+ D .l,.[(- Y2 + r)a;_l -
2ra; + (Yz + r)aj+d
+ K[ - Y2r(l -
r)aj_1 + (I -
r)(l + r)aj
+ Y2T(l + r)aj+ d - [- Y2r(l -
r)fi _ 1
+ (I -
r)(I + r)f; + YIT(I + r)fi+ d}.l" dr = 0
(10-77)
It should be emphasized that the weighting function W is as yet unspecified. Let
us rewrite this last equation in a more convenient form by first multiplying every
term by .IT and then rearranging to get
[Mfl
1
W dr
+ n s-fll
W(Y2 + r) dr
+ K(.lT)2 fllY2Wr(l + r) drJai+ 1
=
- [ -2Mf-+II W dr -
2D .ITfl1
Wr dr
+ K(.lT)2fll
W(I -
r)(I + r) drJa,
- [Mfl1
W dr + D.l,.fl1
W( - Y2 + r) dr
-
K(.lT)2fll
Y2 Wr(l -
r) drJa, - 1
-[fll
Y2 Wr(l -
r) dr}.IT)2f;_1

608
TRANSIENT AND DYNAMIC ANALYSES
+ [[I W(I -
r)( I + r) dr] (~T)2ri
+ [fllYzwr(l + r)dr](~T)2ri+l
(10-781
(10-791
After dividing both sides by f~: W dr and after some manipulation, we get [II]
[M
+ 'YD~T + AK(~T)zlai+l
= [2M - (I - 2'Y)D ~T - (Yz - 2A+ 'Y)K(~T)21ai
+ [-M + (I - 'Y)D ~T - (Yz+ A-
'Y)K(~Tflai-'
-
(Yz + A -
'Y)(~T)2ri_l
-
(V2 -
2A +
'Y)(~T)2ri -
A(~T)2ri+ I
where A and 'Yare defined by
(10-801
and
(10-811
Special Cases
Equation (10-79) is a three-point recursion formula for the solution of Eq. (10-16).
Various schemes arise depending on the choice of the weighting function W. Table
10-3 shows the values of Aand 'Y that correspond to the point collocation, subdomain
collocation, and Galerkin weighted-residual methods. Note that A and 'Yare not
necessarily positive.
Point collocation
Recall that the weighting functions for the point collocation method are given by
S(r - r), such that
f
+ 1
_ 1 S(r - r) dr = I
for r = rj
(10-8281

THREE-POINT RECURRENCE SCHEMES
609
Table 10-3
Summary of the Valuesof the Parameters A and v for Use in the Three-Point
Recursion Formula
Weighted Residual Method
A
'Y
Point collocation at T;_I
0
-V,
Point collocation at T;
0
V,
Point collocation at TH 1
I
Y,
Subdomain collocation
Yo
V,
Galerkin based on N;_I
- Vs
-V,
Galerkin based on N;
VIO
V,
Galerkin based on NH 1
O/S
11,
fl o(r -
rj) dr = 0
for
r =I' rj
(10-82b)
-I
where rj is known as the collocation point. For point collocation at time T j -I where
r = - 1, it can be shown that 'A = 0 and "I = - Y2. Similarly, for point collocation
at times Tj and Tj + I' where r = 0 and r = + 1, it can be shown that 'A = 0 and
"I = Y2, and 'A = 1 and "I = 312, respectively. These results are summarized in
Table 10-3.
Example 10-8
Show that 'A = 0 and "I
Solution
-
Y2 in Eq. (10-79) for point collocation at time Tj _ I.
At time Tj_1> we have r =
- 1 and the collocation point rj must be - 1. Thus the
weighting function W is given by
W = o(r + 1)
and Eqs. (l0-80) and (l0-81) give
fll
Y20(r + I)r(l + r) dr
1-+llo(r + 1) dr
and
0/1
o
"I J
+ I
_I o(r + 1)(Y2 + r) dr
J
+ I
_10(1 + I) dr
•

610
TRANSIENT AND DYNAMIC ANALYSES
Subdomain collocation
The weighting function for the subdomain collocation method is given by W =
I
over the interval T; _ 1 to T; + I' It is shown in Example 10-9 that A =
Y6 and 'Y =
1/2 in this case.
Example 10-9
Show that A =
Y6 and "{
Y2 in Eq. (10-79) for subdomain collocation over the
interval from T;_I to T;+I'
Solution
Using W =
I in Eqs, (10-80) and (10-81) we get
f
+ 1
_I 1/2(1)r(l + r) dr
f
+ 1
_I (I) dr
and
r1+
1
-I
2
I+ I
f'
_I (I)(Y2 + r) dr
(r/2 + r 2/2)
_I
"{
fl
r[
Y2
_ t (I) dr
Galerkin
•
Since the weighting functions for the Galerkin method are the shape function
themselves, we may take
or
W = N; _I =
- Yu(l -
r)
W = N; = (I
-
r)( I + r)
W = N;+I = Yu(l + r)
(10-83a)
(10-83b)
(10-83c)
The shape functions are shown graphically in Fig. 10-7. It can be shown that if
Eq. (1O-83a) is used, we get A = - Ys and"{ = - Y2. Also, if Eq, (l0-83b) is
used, we get A = 'lia and
"{ =
Y2. Finally, if Eq. (1O-83c) is used, we get
A = 0/5 and "{ = )/2.

THREE-POINT RECURRENCE SCHEMES
611
Example 10-10
Show that X. =
-!Is and 'Y
sponding to Eq. (1O-83a).
Solution
-
Y2 in Eq. (10-79) for Galerkin weighting corre-
From the definition x., we have
fl1
Yz[ - Yzr(1 -
r)]r(1 + r) dr
1-+,' - Yu(1 -
r) dr
or
f
+ l
Yz
-I (r2 -
r4 ) dr
f
+ l
-I r -
r2 dr
-!Is
and from the definition of 'Y, we have
f
+ 1
-I [- Yu(1 -
r)](Y2 + r) dr
f
+ 1
-I
-
Y2r(1 -
r) dr
or
Initial and Boundary Conditions
- Yz
We have seen how the second-order, vector-differential equation given by Eq.
(10-16) may be solved by the three-point recursion formula given by Eq. (10-79).
The values of X. and 'Y used in the recursive solution are summarized in Table
10-3. In order to start the solution process, the values of a, and ai-I are needed
for i =
1 in order to determine a, + I' It will now be shown how the initial conditions
on the nodal displacements and velocities can be used to provide the starting vectors
llo and at. Two different methods are used; the first method is simpler but less
accurate than the second. Both methods require that Eq. (10-16) be written as a
set of two, first-order vector differential equations, or

612
TRANSIENT AND DYNAMIC ANALYSES
Mb + Db + Ka = f
a = b
(10-841
(10-S51
It should be noted that since the vector a represents the nodal displacements, the
vector b (defined to be a) must represent the nodal velocities. The initial displace-
ments and velocities may be denoted as 30 and bo, respectively.
Euler starting method
The starting values for a,_ I are simply given by the initial nodal displacements ao.
We seek the starting values for the vector a.. The simplest approach is to apply the
forward difference scheme or Euler's method to Eq. (10-85) to get
a(T +
~T) -
arr)
b
=
(T)
~T
or
Solving for a, gives
aj -
aj~ I
~T
s..,
For ii, Eq. (10-86) becomes
a, = ao + bo ~T
(10-861
(10-871
Since 30 and bo are provided by the initial conditions on the nodal displacements
and velocities, respectively, Eq. (10-87) provides a means of obtaining a.. With
30 and a, known, the three-point recursion formula given by Eq. (10-79) could be
used to determine a2' and so forth. The recurrence scheme is shown schematically
in Fig. 10-8.
ao
a (0)
t: = ar
i
=
---a2
a,
ao~
l
t
= 2ar
i
= 2
a,
and a2~a3
/
r
= 3ar
i
= 3
a2 and a3~a4
/
r
= 4ar
i
= 4
a3 and ~'
/
etc.
etc.
etc.
Figure 10-8
Schematic diagram of the three-point recursion process.

THREE-POINT RECURRENCE SCHEMES
613
Crank-Nicolson starting method
While the Euler starting method is simple, it is not very accurate and a better
approach results if Eqs. (10-84) and (10-85) are solved using the central difference
or Crank-Nicolson method. In this case Eq. (10-84) becomes
In a similar fashion, we may write Eq. (10-85) as
f; + f;_1
2
(10-88)
a; -
a;-J
IlT
b; + b;-J
2
(10-89)
The vector b, contains the nodal velocities at the end of one time step IlT and is
unknown at the start of the solution. Therefore, if b, is eliminated between Eqs.
(10-88) and (10-89), we get the following convenient result:
[ 2M + D + K IlTJa.
IlT
2
1
= [2M + D _ K IlTJ a
+ 2Mb
+ f; IlT + f;_ J IlT
(10-90)
IlT
2
1- I
; - J
2
2
Equation (10-90) is useful because it provides the starting values of a; when i =
for which we also have
a;-J = ao = a(O)
(10-91)
b., J
bo = b(O)
(10-92)
f;_1
f(O)
(10-93)
f;
f(IlT)
(10-94)
Equations (10-91) and (10-92) represent the initial conditions on the nodal dis-
placements and velocities, respectively. The vectors f(O) and f(IlT) in Eqs. (10-93)
and (10-94) denote the values of f(T) at T = 0 and T = IlT, respectively.
Boundary conditions
The three-point recurrence scheme given by Eq. (10-79) is of the form Kerra
ferr, where Kerr is given by M + -yDIlT + X-K(IlTf and ferr is given by the right-
hand side of Eq. (10-79). As in the case of the two-point recursion formula, we
may use either Method 1 or Method 2 from Sec. 3-2 to impose the prescribed
displacement boundary conditions. Since Kerr is symmetric, it is prudent to preserve
symmetry if Method 1 is used. Note that an implicit solution for the nodal dis-
placements results even if the lumped form of the mass matrix is used because
Table 10-3 shows that X- and -yare never both zero.

614
TRANSIENT AND DYNAMIC ANALYSES
10·10
INTRODUCTION TO MODAL ANALYSIS
In Chapter 7 the finite element method was applied to several different problems
in static stress analysis. The resulting nodal displacements were then used to cal-
culate the element strains, stresses, etc. In this chapter several sections were devoted
to dynamic structural analysis. In this case, the nodal displacements are computed
as a function of time for some set of initial conditions. The element resultants could
be computed via the techniques from Chapter 7. In both cases, the prescribed
displacements could be imposed in a routine manner
Many times in dynamic structural analysis, the nodal displacements as a func-
tion of time are not really needed. Instead, the natural frequencies of the sustained
vibrations are needed. For example, consider the case of the mass and spring system
shown in Fig. 1O-9(a). If the spring is assumed to be perfectly elastic and linear
(i.e., linear-elastic) and massless, then the governing differential equation is given
by
Mi + Kx = f{t)
(10-95)
where x{t) is the displacement of the mass M from the equilibrium position, K is
the spring constant (i.e., the stiffness), and f{t) denotes the forcing function. If
damping is present as shown in Fig. 1O-9(b), then the governing equation is given
by
Mi + Dx + Kx = f(t)
(10-96)
where D is the damping coefficient. Note that i and x represent the velocity and
acceleration of the mass, respectively. Note also that Eq. (10-96) reduces to Eq.
(10-95) if the damping is negligible.
The natural frequency of a system is defined to be the frequency at which the
system oscillates if the forcing function is identically zero. Nonzero initial conditions
give rise to the oscillations in this case. If the system has only one discrete mass
such as that in Fig. 1O-9(a), then only one natural frequency results. However, if
Figure 10-9
(a) A mass-spring system, and (b) a mass-spring-damper system.

INTRODUCTION TO MODAL ANALYSIS
615
the system is distributed such as a vibrating string, then an infinite number of natural
frequencies exist. Because the finite element method approximates a continuous
system by discrete elements (and hence masses), the stiffness-based finite element
method is only capable of yielding the natural frequencies on the low end of the
spectrum. In contrast, the force matrix method (not covered in this book) yields
the natural frequencies on the high end of the spectrum. In both cases, the number
and accuracy of the computed natural frequencies increase as the number of elements
is increased.
Let us review how we obtain the natural frequencies by using Eq. (10-95) as
an example. Since we desire the oscillatory or sinusoidal variations of x, we may
represent x(t) in complex polar form as
x(t)
= xe
iW T
where from Euler's identity we have
e'"" = cos WT + i sin WT
Here i denotes the imaginary number defined by
i = v=1
(10-97)
(10-98)
(10-99)
and W is the frequency of the vibration. In Eq. (10-97), x denotes the amplitude of
the vibration corresponding to the frequency w. Recall that the natural frequency
is obtained by assuming a zero forcing function. It follows that
Mi + Kx = 0
(10-100)
and W then represents the undamped natural frequency. From Eq. (10-97), we get
.
dx
.
x = -
= iwxe,wT
dT
and
x
(10·101)
Using Eqs. (10-97) and (10-101), we may write Eq. (10-100) as follows:
(10·102)
But er" is not generally zero, and we want to exclude x = 0 as a solution because
this would yield the trivial solution X(T) = O. Therefore, the expression in the
parenthesis must be zero, and we get
W=~
(10-103)
The reader may recall this result from elementary vibrations. The natural frequency
W is frequently referred to as an eigenvalue. The nontrivial vector x is referred to

616
TRANSIENT AND DYNAMIC ANALYSES
as the eigenvector that corresponds to the frequency w. A geometric interpretation
of the eigenvector is given later in this section. The natural frequency of the mass-
spring-damper system in Fig. 1O-9(b) may be obtained in a similar manner by
beginning with Eq. (10-96). However, the eigenvalues in this case are now complex.
This implies that the oscillations decay with time.
Let us now return to Eq. (10-16) and extend this development to the finite
element method. Only the undamped natural frequencies are to be determined here.
In this case, Eq. (10-16) reduces to
Mil + Ka = 0
(10-104)
where the assemblage nodal force vector (the forcing function) has been set to zero.
Now we represent the vector of nodal displacements as
(10·105)
from which it follows that
(10-106)
where a is now referred to as the eigenvector corresponding to the natural frequency
w. Equation (10-104) becomes
(10-107)
Since the nontrival solutions for a are sought, the determinant of the expression in
the parenthesis must be zero, or
det( -w2M + K) = 0
(10-108)
because this guarantees that the matrix - w2M + K is singular, thus admitting
nontrivial solutions for the vector a. Consequently, Eq. (10-108) may be solved
for the natural frequencies w of the structure.
Note that if N nodes are used in the discretization and each node has m degrees
of freedom, then Eq. (10-108) results in a polynomial of order mN and hence yields
mN natural frequencies. Recall that the original (continuous) structure really has
an infinite number of natural frequencies. It follows that the natural frequencies on
the high end of the spectrum (i.e., for large or's) are not accurately computed.
Fortunately, the frequencies on the low end of the spectrum are quite accurate if
enough elements are used. Standard FORTRAN library subroutines may be used
to determine the mN values of w2 (and hence w) that satisfy Eq. (10-108). The
roots may be shown to be positive real numbers because the matrices K and Mare
always positive definite. The w's are recognized to be eigenvalues.
Recall that the vector a in Eq. (10-105) may be referred to as the eigenvector
that corresponds to the frequency w. In particular, let us define aj to be the eigen-
vector that corresponds to the natural frequency Wj' It follows from Eq. (10-107)
that the eigenvector aj must satisfy
(-wJM + K)a/
W T = 0
(10-109)

INTRODUCTION TO MODAL ANALYSIS
617
But e
iW T is not zero, so we must have
(wJM -
K)aj = 0
(10-110)
Equation (10-110) has a nontrivial solution for the eigenvector aj because the Wj
are computed such that Eq. (10-108) holds; otherwise only the trivial solution for
aj exists. It should be recalled that the system of equations in Eq. (IO-ll0) is
singular. Therefore, the solution for the eigenvector is not unique and one of the
entries inaj is arbitrary. Because the eigenvectors are not unique, they are generally
normalized such that
aJMaj = 1
Standard FORTRAN library subroutines may be used to compute the eigenvectors.
The reader is referred to the book by Zienkiewicz (12) for a more detailed discussion.
The eigenvectors may be interpreted geometrically as follows. Consider the
simply supported beam shown in Fig. 1O-IO(a). The eigevector al that corresponds
to the lowest natural frequency
WI results in the mode shape shown in Fig.
10-1O(b).The eigenvector a2 that corresponds to the second lowest natural frequency
W2 results in the mode shape shown in Fig. 1O-IO(c). Because the beam is contin-
uous, there are really an infinite number of natural frequencies and eigenvectors or
mode shapes. The human eye sees the superposition of all mode shapes during the
vibration of a structure. If a system with negligible damping is excited at one of
the natural frequencies of the structure, resonance will ocur. The result is usually
catastrophic.
Finally it should be mentioned that the lumped form of the mass matrix may
be used to determine the natural frequencies and mode shapes of the structure.
However, the results from the consistent mass matrix will generally be more accurate
(13).
lal
(b)
(e)
Figure 10-10
(a) A simply supported beam with (b) its first mode shape and (c) its second
mode shape.

618
TRANSIENT AND DYNAMIC ANALYSES
REFERENCES
I. Zienkiewicz, O. c.. The Finite Element Method, McGraw-Hili (UK), London, 1977,
pp.60-62.
2. Hibbeler, R. C., Engineering Mechanics: Dynamics, Macmillan, New York, 1983,
p.80.
3. Clough, R. W., and J. Penzien, Dynamics of Structures, McGraw-Hili, New York,
1975.
4. Gresho, P., and R. L. Lee, "Don't Suppress the Wiggles-They're Telling You Some-
thing," Finite Element Methods for Convection Dominated Flows, AMD-Vol. 34, pp.
37-61, Winter Annual Meeting of the ASME, New York, Dec. 2-7, 1979.
S. Hinton, E., A. Rock, and o. C. Zienkiewicz, "A Note on Mass Lumping in Related
Process in the Finite Element Method," Int. J. Earthquake Eng. Struct. Dynam., Vol.
4., pp. 245-249, 1976.
6. Zienkiewicz, O. C., The Finite Element Method, McGraw-Hili (UK), London, 1977,
pp. 535-539.
7. Zienkiewicz, O. C., The Finite Element Method, McGraw-Hili (UK), London, 1977,
pp. 576-588.
8. Bathe, K. -J., Finite Element Procedures in Engineering Analysis, Prentice-Hall, En-
glewood Cliffs, N.J., 1982, pp. 553-554.
9. Reddy, J. N., An Introduction to the Finite Element Method, McGraw-Hili, New York,
1984. pp. 50-56.
10. Zienkiewicz, O. C., The Finite Element Method, McGraw-Hili (UK), London, 1977,
pp. 740-741.
II. Zienkiewicz, O. C., The Finite Element Method, McGraw-Hili (UK), London, 1977,
p.582.
12. Zienkiewicz, o. c., The Finite Element Method, McGraw-Hili (UK), London, 1977,
pp. 546-558.
13. Reddy, J. N., An Introduction to the Finite Element Method, Mcflraw-Hill, New York,
1984, p. 406.
PROBLEMS
10-1
The element mass matrix is given by Eq. (10-13). Since this expression is applicable
to any element, evaluate it for the case of the three-node lineal element by using
length coordinates. Use Eq. (6-48) to evaluate the integrals.
10-2
The element mass matrix is given by Eq. (10-13). Since this expression is applicable
to any element, evaluate it for the case of the three-node lineal element by using
the serendipity coordinate r. Hint: Use Gauss-Legendre quadrature of such an order
that the integrals are evaluated exactly.
10-3
Consider the expression for the element mass matrix given by Eq. (10-13). Since
this expression is applicable to any element, evaluate it for the case of the three-
node triangular element by writing the shape functions in terms of area coordinates.
Hint: Use the numerical integration formula from Section 9-9 of such an order that
the integrals are evaluated exactly.

PROBLEMS
619
10-4
Consider the expression for the element mass matrix given by Eq. (10-13). Since
this expression is applicable to any element, evaluate it for the case of the four-
node rectangular element by writing the shape functions in terms of the serendipity
coordinates rand s. Hint: Use Gauss-Legendre quadrature of such an order that the
integrals are evaluated exactly.
10-5
The element capacitance matrix is given by Eq. (10-26) for all one-dimensional
elements. Evaluate the integral for the case of the three-node lineal element by using
length coordinates. Use Eq. (6-48) to evaluate the integrals.
10-6
One form of the element capacitance matrix is given by Eq. (10-26). Since this
expression is applicable to anyone-dimensional thermal analysis problem, evaluate
it for the case of the three-node lineal element by using the serendipity coordinate
r. Hint: Use Gauss-Legendre quadrature of such an order that the integrals are
evaluated exactly.
10-7
Consider the expression for the element capacitance matrix given by Eq. (10-25).
Since this expression is applicable to any two-dimensional thermal analysis problem,
evaluate it for the case of the four-node rectangular element by writing the shape
functions in terms of the serendipity coordinates rand s. Hint: Use Gauss-Legendre
quadrature of such an order that the integrals are evaluated exactly.
10-8
Consider the expression for the element capacitance matrix given by Eq. (10-25).
Since this expression is applicable to any two-dimensional thermal analysis problem,
evaluate it for the case of the eight-node rectangular element by writing the shape
functions in terms of the serendipity coordinates rand s. In other words, show that
Eq. (10-35) holds in this case. Hint: Use Gauss-Legendre quadrature of such an
order that the integrals are evaluated exactly. It may be more convenient to write
a short FORTRAN program.
10-9
Determine the lumped form of the mass matrix for Problem 10-1. Clearly explain
or indicate how the lumped form is obtained from the consistent form.
10-10
Determine the lumped form of the mass matrix for Problem 10-2. Clearly explain
or indicate how the lumped form is obtained from the consistent form.
10-11
Determine the lumped form of the mass matrix for Problem 10-3. Clearly explain
or indicate how the lumped form is obtained from the consistent form.
10-12
Determine the lumped form of the mass matrix for Problem 10-4. Clearly explain
or indicate how the lumped form is obtained from the consistent form.
10-13
Determine the lumped form of the capacitance matrix for Problem 10-5. Clearly
explain or indicate how the lumped form is obtained from the consistent form.
10-14
Determine the lumped form of the capacitance matrix for Problem 10-6. Clearly
explain or indicate how the lumped form is obtained from the consistent form.
10-15
Determine the lumped form of the capacitance matrix for Problem 10-7. Clearly
explain or indicate how the lumped form is obtained from the consistent form.
10-16
Determine the lumped form of the capacitance matrix for Problem 10-8. Clearly
explain or indicate how the lumped form is obtained from the consistent form.

620
TRANSIENT AND DYNAMIC ANALYSES
10·17
Conisder the following assemblage capacitance and stiffness (or conductance) mat-
rices
c=[~
~]
and
and the following assemblage nodal force vector:
r = [;~]
Using the forward-difference (or Euler's) method, determine the nodal temperatures
for the first four time steps if a 0.25-sec time step is used. Assume that there are
no prescribed temperatures and both nodes are initially at 50°F. Explain what might
happen if the time step is increased too much.
10·18
Consider the following assemblage capacitance and stiffness (or conductance) mat-
rices
C = [: :]
and
K =
[
14
-II
-II]
14
and the following assemblage nodal force vector:
r = [125]
125
Using the forward-difference (or Euler's) method, determine the nodal temperatures
for the first five time steps if a 0.2-sec time step is used. Assume that there are no
prescribed temperatures and both nodes are initially at 25°C. Explain what might
happen if the time step is increased too much.
10·19
Consider the following assemblage capacitance and stiffness (or conductance) mat-
rices
[
500
250
0]
C =
250
1000
250
o
250
500
and
[
400
K =
-4~
-400
800
-400
-4~]
400
and the following assemblage nodal force vector:
r = [n
Using the forward-difference (or Euler's) method, determine the nodal temperatures
for the first 20 time steps if a O.I-sec time step is used. Assume that node I is to
be prescribed at 100°C and that all nodes are initially at 10°C. Explain what might
happen if the time step is increased too much.
10·20
Consider the following assemblage capacitance and stiffness (or conductance) mat-
rices
and
[
100
K
=
.-I~
-100
200
-100
-I~]
100

PROBLEMS
621
and the following assemblage nodal force vector:
Using the forward-difference (or Euler's) method, determine the nodal temperatures
for the first five time steps if a 0.05-sec time step is used. Assume that node I is
to be prescribed at 150°F and that all nodes are initially at 75°F. Explain what might
happen if the time step is increased too much.
10-21
Repeat Problem 10-17 with the backward difference scheme and a 0.5-sec time
step. Explain what happens to the results as the time step is increased.
10-22
Repeat Problem 10-18 with the backward difference scheme and a 0.5-sec time
step. Explain what happens to the results as the time step is increased.
10·23
Repeat Problem 10-19 for 10 time steps with the backward difference scheme and
a 0.20-sec time step. Explain what happens to the results as the time step is increased.
10-24
Repeat Problem 10-20 with the backward difference scheme and a 0.05-sec time
step. Explain what happens to the results as the time step is increased.
10-25
Repeat Problem 10-17 with the central difference scheme and a 0.5-sec time step.
Explain what happens to the results as the time step is increased.
10-26
Repeat Problem 10-18 with the central difference scheme and a 0.5-sec time step.
Explain what happens to the results as the time step is increased.
10-27
Repeat Problem 10-19 with the central difference scheme and a 0.20-sec time step.
Explain what happens to the results as the time step is increased.
10-28
Repeat Problem 10-20 with the central difference scheme and a 0.05-sec time step.
Explain what happens to the results as the time step is increased.
10-29
Show that point collocation at time T, gives e = O. Which of the finite difference
schemes does this situation correspond to? Please explain.
10-30
Show that point collocation at time T,+ I gives e =
I. Which of the finite difference
schemes does this situation correspond to? Please explain.
10-31
Show that the parameter etakes on a value of Y3 if the weighting function is given
by Eq. (I0-67a). Is this value of e likely to result in a stable solution for any time
step tn? Pleast explain the plausibility of your conclusion.
10-32
Write a small FORTRAN program that can be used to obtain the transient temperature
distributions in a fin. It is recommended that the program from Problem 4-78 be
used as the starting point. Allow for different values Ofe. In addition, allow for
either the lumped or consistent capacitance matrix (via an input parameter ILUMP,
where ILUMP is 0 and I for a consistent and lumped capacitance matrix, respec-
tively).
10-33
With the help of the computer program from Problem 10-32 (or one furnished by
the instructor) repeat Example 10-6 for e = 0 and for both a consistent and lumped
capacitance matrix. Use a O.I-sec time step and carry out the solution until steady

622
TRANSIENT AND DYNAMIC ANALYSES
state is achieved (approximately 6 sec). Is the solution stable? How do the results
compare with those from Example 10-6 (with e = ¥3)?
10·34
With the help of the computer program from Problem 10-32 (or one furnished by
the instructor) repeat Example 10-6 for e =
Y2 and for both a consistent and lumped
capacitance matrix. Use a O.I-sec time step and carry out the solution until steady
state is achieved (approximately 6 sec). Is the solution stable? How do the results
compare with those from Example 10-6 (with e = ¥3)?
10·35
With the help of the computer program from Problem 10-32 (or one furnished by
the instructor) repeat Example 10-6 for e =
I and for both a consistent and lumped
capacitance matrix. Use a O.I-sec time step and carry out the solution until steady
state is achieved (approximately 6 sec). How do the results compare with those
from Example 10-6 (with e = :jIl)?
10-36
With the help of the computer program from Problem 10-32 (or one furnished by
the instructor) repeat Example 10-6 for e =
Y3 and for both a consistent and lumped
capacitance matrix. Use a O.I-sec time step and carry out the solution until steady
state is achieved (approximately 6 sec). Is the solution stable? How do the results
compare with those from Example 10-6 (with e = ¥3)?
10·37
Show that A = 0 and "y = Y2 for point collocation at 'r i .
10·38
Show that A = I and v = V2 for point collocation at 'ri+l.
10-39
Show that A =
Via and "y =
Y2 for Galerkin weighting corresponding to Eq.
(lO-83b).
10-40
Show that A
(lO-83c).
4j, and
"y
312 for Galerkin weighting corresponding to Eq.

A
Structural and Thermal Properties
A-1
Structural Properties
English Units
Modulus of
Coefficient of
Poisson's
Weight
elasticity
thermal expansion
ratio
density
106 psi
10- 6 in/in-oF
lbf/in'
Aluminum, 6061 alloy
10.
12.8
0.33
0.100
Brass
15.
10.5
0.33
0.300
Bronze
IS.
10.0
0.33
0.300
Cast iron
IS.
6.0
0.27
0.256
Copper, hard drawn
17.
9.4
0.33
0.340
Steel, hot rolled low carbon
30.
6.5
0.30
0.283
Steel, hot rolled high carbon
30.
7.0
0.30
0.283
623

624
APPENDIX A
STRUCTURAL AND THERMAL PROPERTIES
51 Units
Modulus of
elasticity
1010 N/m2
Coefficient of
thermal expansion
10- 6 m/m-X'
Poisson's
ratio
Weight
density
Nzcm'
Aluminum, 6061 alloy
6.90
23.0
0.33
0.0271
Brass
10.3
18.9
0.33
0.0814
Bronze
10.3
18.0
0.33
0.0814
Cast iron
10.3
10.8
0.27
0.0695
Copper, hard drawn
11.7
16.9
0.33
0.0923
Steel, hot rolled low carbon
20.7
11.7
0.30
0.0758
Steel, hot rolled high carbon
20.7
12.6
0.30
0.0758
A-2
Thermal Properties
English Units
Aluminum (pure)
Brass
Bronze
Cast iron
Copper (pure)
Stainless steel
Steel, hot rolled low carbon
Steel, hot rolled high carbon
Thermal
conductivity
Btu/hr-ft-T'
117.
64.
15.
30.
224.
9.2
3I.l
21.7
Mass
density
lbm/ft'
169.
530.
540.
454.
558.
488.
488.
483.
Specific
heat
Btu/Ibm-oF
0.208
0.089
0.079
0.100
0.092
0.107
0.108
0.113

APPENDIX A
STRUCTUAL AND THERMAL PROPERTIES
625
51 Units
Thermal
Mass
Specific
conductivity
density
heat
W/m-oC
kg/rn'
J/kg-OC
Aluminum (pure)
203.
2720.
872.
Brass
Ill.
8520.
373.
Bronze
26.
8670.
331.
Cast iron
52.
7305.
419.
Copper (pure)
389.
8980.
386.
Stainless steel
16.
7820.
449.
Steel, hot rolled low carbon
54.
7830.
452.
Steel, hot rolled high carbon
38.
7750.
473.


B
Program TRUSS
B·'
Listing of Source Code for Program TRUSS*
1
2
1
c....
6
8
C
10
c....
C
20
PRCGRAM muss
D]}~SION XCOOR(20), YCOOR(20), NODI(30),
~DDJ(30), MATFLG(30),
DATMAT(S,2), f£CX(20), mcY(20), DISP(S), FCRCEClS), XX(2),
YY(2), DIR<DS(2), OOLN(40), JlSM(40,40), ANFV(40), ESM(4,4)
CDMMCN NN)[)FS,
NELEM, NMATLS, NPDIS, NPLDS, LClJT, LPRINT, LIN,
TITLE (20)
LCCNSL IS THE SCREEN DE.VICE NUMBER
LCCNSL = 3
vffi!TE (LCCNSL,8)
FORMAT (// / / / ,2X, I INRJT THE NUMBER OF THE INPUT FILE (6-10):
I)
READ
(LCCNSL,20l LIN
IF
(LIN
.~.
0)
GO 'ill 9999
READ AN 8O-COWMN TI'ILE "CARD"
READ
(LIN,10)
(TITLE(J), J = 1, 20)
FCRMAT (20M)
READ THE NUMBER OF NODES, ELEMENTS, 1-1ATERIALS, PRESCRIBED
DISPLACEMENTS, mINT LOADS,
AND aJTRJT UNIT
READ
(LIN,20)
NNJDES, NEW1, NMATLS, NIDIS, NPLDS, LClJT
FCIDlAT (618)
'The main program TRUSS is followed by the subroutines in the order called. Section B-2 describes
the input to this program in detail. The input is also summarized in Table 3-1 in the main part of the
text.
627

628
APPENDIX B
PROGRAM TRUSS
c.. • •
ZERO aJl' 'lllE "BaJNDARY CC1IDITloo" FLlGS
DO 1000
I = 1, 20
NBCX(I) = 0
merCIl
= 0
1000
CCNTINJE
C....
READ MESH, MATERIAL, AND BCUNDARY CC1IDITloo DATA
CALL NXGEN (XCOCR, YCQCR)
CALL ELEX;EN (IDOI, IDDJ,
MATFLG)
CALL MATERL CDMW.T)
CALL BCCND (N8CX, NBCY, FORCE, DISP)
C. • • •
PRINT SJMM1lRY OF INR1l' DATA
CALL smtmY (XClX>R, YCOOR, IDOI, IDDJ,
MATFLG, DATMAT, N8CX,
1
mer, ~, OISP)
C....
ZEIlO cor 'lllE ASSDlBI.JlGE IDDAL FORCE VEClOR AND STIFrnESS MATRIX
DO 2000
I =1, 40
ANEV(Il = 0.0
DO 2000
J = 1, 40
ASM(I,J) = 0.0
2000
CCNTINJE
C. • • •
GENERATE 'lllE GLCBAL ELEMENT AND ASSEMBI..lGE STIFrnESS MATRIX
DO 2500
L =1, NELEM
CALL ClX>RDS (L, NJDI, IDDJ,
XCOOR, YCOOR, XX, yy)
CALL Lau:m (XX, YY, ELENm)
CALL PROPl'Y (L,
MATFLG, DATMAT, AREA, ELMJD)
CALL 'mANSF (L, XX, YY, ELENm, DIRCOS)
CALL STIFF
<AREA, ELMJD, ELEN'm,
DI~, ESM)
CALL ASSEMK (L, IDOl, IDDJ,
ESM,
ASM)
2500
CCNTINJE
C....
GENERATE JlSSDlBLIlGE IDDAL FORCE VEO:'OR
CALL ANEVEx:: (NBCX, mer, ~, ANEV)
C. • • •
IMPalE RES'IRAINIS 00 'lllE IDDAL DISPIJlCEMENIS
CALL Pr.eC (NBCX, mer, E>ISP, ASM, ANEV)
N = 2*NOODES
C....
OOLVE 'lllE ElJUATIooS, PRINl' 'lllE OODAL DISPIJlCEMENIS, AND PRINr
C
'IHE ELEMENT RESULTANTS
CALL ms::>LV (N, ASM, ANFV, sam)
CALL PRIN'lN (som)
CALL POSTPR (OODI, IDDJ,
XCOOR, YCOOR, MATFLG, DATMAT, sam)
GO TO 6
9999
CXNrImE
S'lOP
END
9JBKXJTINE lDXiEN (XCOOR, YCOOR)
C....
READS IDDAL <XXlIDINATE DATA AND GENERATES IDDES
DIMENSION XCCXJR(20),
YCOOR(20)
a:MM:lN NNDES,
NELEM, NMATLS, NIDIS, NPIDS, tnrr, LPRIN1', LIN,
1
Tl'lt.E (20)
READ (LIN,20)
SJBT
20
F'C'mOO' (A4)

APPENDIX B
PROGRAM TRUSS
629
25
a:NTUm:
C....
READ STARl'IN> NDE NUfoI3ER, :rNCRFl1ENT, AND FINAL ~JJDE NUMBER
READ (LIN,30) NI, N>, NE'
30
~T (318)
C.. ••
IF NI IS ZERO, RETURN SINCE OODE Sa:CIFlCATION AND GENERATION
C. • ••
IS <DMPLETE
IF (NI .EQ. 0) 00 '10 9999
C....
IF N> IS ZERO, 00 GENERATION IS DESIRED.
NDES ARE Sa:crFIED
C.. ••
CN A ONE BY ONE BASIS.
IF
(N) .NE. 0) 00 '10 40
READ (LIN,35) Xa::XJHNI), YCOOR(NI)
35
~T (4F8.0)
GO '10 25
40
CCNTHUE
C....
N:>DAL GENERATICN-XI,YI ARE 'mE STARTIN> QX)RDlNATE PAIR AND
C
XF,YF ARE 'lHE ENDIN> axlIDINATE PAIR
READ (LIN,35) XI, YI, XF, YF
DIV = (NF - NI) /
N>
OX = <xF - XI)
/ DIV
DY =
(YF -
YI) /
DIV
NOIV = DIV - 1
NN=NI+N>
NIl = NI
XCOOR(NI) = XI
YCOOR(NI) = YI
00 1000
I = 1, NOIV
XCOOR(NN) = XQX)R(NII) + OX
YCOOR(NN) = YCOOR(NIl) + DY
NIl = NN
NN=m+N>
1000
CCNTUUE
C... •
FINAL CXXlRDlNATES DEFINED OIRECI'LY '10 AVOID RCXJ1\llOFF ERROR
XCOOR(NF) = XF
YCOOR(NF) = YF
GO '10 25
9999
CCNTINJE
RE1'URN
END
&JBnrrINE ELEXiEN (roOI, rom, MATFlG)
C. • ••
RFAnS ELEMENT DATA AND GENERATES 'lHE ELEMENTS
DIMENSION NDI(30), NODJ(30), MATFlG(30)
<DfoIoKlil NNDES, NELEM, NMATLS, NPlJIS, NPLDS, LClJT, LPRINT, LIN,
1
TITLE(2Q)
READ (LIN,20)
SU8T
20
~T <A4)
25
CCNTImE
c....
RFAnS 'mE STARTIN> ELEMENT NUMBER, MATERIAL SET FIJlG,
ELEMENl'
C
IlOEMENT,
FINAL ELEMENT liUMBER, AND roDJ\L nx:REMENl'

630
APPENDIX B
PROGRAM TRUSS
READ (LIN,30l
LI, MS, IG,
LF, N:i
30
FalMAT (SISl
C....
IF LI IS muM.. 'ID ZERO, '!HEN ELEMENl' DATA IS CDMPLE'IED
IF (LI .m. Ol 00 'ID 9999
C. • ••
READ '!HE GLOOAL NJDE WMBERl OF ELEMENl' LI
READ (LIN,30l NI, NJ
NDI (LI) =NI
N:Q1(LIl = NJ
MM.'FIG(LI) = MS
C....
IF IG IS ZERO, INFUl' ELEMENl' DATA ON lIN ELEMENT-BY-ELEMENl' BASIS;
C
CYffiFai'ISE, GmERATE CYffiER ELEMENl' DATA
IF
(IG .m. Ol
00 'ID 25
50
CCNl'IKJE
LI = LI + IG
NI
=NI
+N:i
NJ=NJ+N:i
IF
(LI
.GT. LFl
GO 'ID 25
NJDI(LI) = NI
ooro (LI) = NJ
MATFIG (LI) = MS
GO 'ID 50
9999
CCNITNUE
REmJRN
END
SUBroJTINE MATERL (DA1MAT)
C....
RFADS IN '!HE MATERIAL PIDPERrY OATh
DIMENSION DA1MAT(S,2l
Cl:loM:N NN)l)ES, NELEM, NMATLS, NIDIS, NPLDS, LCUT, LPRINT,
L~,
1
TITLE (20)
READ (LIN,20l
aJBT
20
~ (A4l
c., ..
READ FOR ~TERIAL SET MSNJ: CRCSS-SECl'IONAL AREA [DA1MAT(MSNO,ll]
C
lIND r-oDULUS OF ELASTICITY [DA'lMAT (MSOO, 2l]
30
CCNITNUE
READ (LIN,40l
MSNJ, AREA, ELMJD
40
~ <IS,
2FS.Ol
IF
(MSNO .m. 0 .OR. MSNO .GT. Sl
GO 'ID 9999
DA'lMAT (MSOO,ll = AREA
DAnolAT (MSOO, 2l = ELMJD
GO 'ID 30
9999
CCNl'IKJE
RF:lURN
END
SlBRCllTINE BCCND (NBCX, mcY, FCRCE, DISPl
C....
RFADS AND GENERATES BaJIDARY <nIDITION FLlGS, N::DAL FORCES, AND
C
N:l)AL DISPlACEMEN'lS
DIMENSION NBCX(20l, N!3CY(20l, FORCE US) , DISP(Sl

APPENDIX B
PROGRAM TRUSS
631
<Dft4CN NNJDES, NELEM, NMATLS, NPDIS, NPLDS, LOJT, LPRINT, LIN,
1
TITLE (20)
c. • • •
ZERO CUT '!HE mcx AND mCY ARRAYS
DO 10
I = 1, 20
mcx<I> = 0
NBCY<I> = 0
10
CCNTINJE
READ (LIN,20)
aJBT
20
FCRMAT (A4)
c.. ..
READS 'lHE
STARTI~ NJDE NUMBER, Be FIJlGS IN X- AND
C....
Y-DlRECTlOOS, NJDAL INCREMENl', AND ElIDIN; NJDE NJMBER
25
READ (LIN,30) NI, IBCX, I&.."Y,
~,
NF
30
FCRMAT (sIa)
C....
IF NI IS ZERO, Be FLAG INPUT IS a:t-1PLEl'E, READ OODAL FORCES
IF
(NI .EQ. 0) GO TO 200
C... •
IF ~ IS ZERO, so GENERATlOO OF BC'S IS DESIRED.
Be INFO IS
C....
SPECIFIED CN A NJDE-BY-NJDE BASIS
IF
(~ .NE. 0)
GO TO 100
mcx(NI) = IBCX
NBCY(NI) = mcy
GO TO 25
C....
GENERATION roRI'ION OF BC'S FIJlGS
100
CCNTINJE
NN = NI
120
CCNTImE
NBCX (NN) = mcx
N3CY(NN)
= mcy
NN=NN+~
IF
(NN .GT.
NF)
GO 'ID 25
GO 'ID 120
200
CCNTImE
C.. • •
READ APPLIED roDAL FORCES
READ (LIN,20)
SUBT
C....
READ FORCE FLAG AND FORCE
220
CCNTINJE
READ
(LIN,230)
NFORCE, FORe
230
~ (la, Fa.O)
IF
(NFORCE .zo, 0
.OR.
NFORCE .GT. 15)
GO TO 300
FORCE (NFORCE)
= FORe
GO TO 220
300
CCNTINJE
C....
READ PRESCRIBED OODAL DISPLPCEMENTS
READ {LIN, 20)
SUBT
C....
READ DISPLPCEMENr FLAG AND DISPLPCEMENr
320
CCNTINJE
READ {LIN,230l
NJISP, DISPL
IF (NDISP .EQ. 0
.OR. NDISP .GT. 5) GO 'ID 9999
DISP{NDISP) = DISPL
GO TO 320

632
APPENDIX B
PROGRAM TRUSS
9999
CCNTINJE
'RETURN
END
SUBKUrINE SUMMRY
(XCOOR, YCOOR, NJDI, NJnJ, MATFU;, DA'lMAT,
1
mcx, mcY, FCRCE, DISP)
DIMENSION XCOQR(20), YCOOR(20), NJDI(30), NJnJ(30), MATFU;(30),
1
~(5,2), mcx(20), NBCY(20), DISP(5), FCRCE(15)
<XX+m NN:lDES, NELEM, NMATLS, NPDIS, NPIDS, raJT, LPRINl',
LIN,
1
TI'lLE(20)
WRITE (raJT, 100)
TITLE
100
F<»lAT (2X, 20M, /)
110
1
2
3
4
5
WRITE (raJT, 110)
NOODES,
NELEM,
F<»lAT (ax,
'NJMBER OF mDES:
ax,
'NJ1-t3ER OF ELENENTS:
ax,
'NJMBER OF MATERIALS:
ax, 'RlmER OF PRES DISP:
ax,
'NJMBER OF PI' LOADS:
ax,
'CXJTPIJl' UNTI' NUmER:
NMATLS, NPDIS, NPLDS, raJT
"
13, /,
"
13, /,
"
13, I,
I, 13, /,
1 I
13, /,
"
13)
WRITE (LOJT, 380)
FORMAT o, 2X, ,MATERIALI, 7X,
I AREA', 7X
I ELASI'IC lo{)LULUS')
00 450
I '" 1, NMATLS
WRITE (LOJT, 420) I, DATMAT(I,l),
~(I,2)
FCRMAT (4X, 12, ax, G11.4, 4X, Gl1.4)
C<NI'INUE
WRI'IE uorr, 510)
FORMAT o, 2X,
'SUMMARY OF DIFFERENl' EXTERNAL LOADS' ,I,
lOX,
'RlmER', 4X, 'IDDAI, FCRCE')
00 550
I = 1, NPIDS
WRI'IE
(LaJT,520) I, FCRCE (I)
FORMAT <l2X, 12, 5X, Gl3.4)
CCNTINJE
WRI'IE (LOJT,320)
FORMAT o , 2X,
'ELEMENI' NO.', 4X,
'NJDE I', 3X,
'NJDE J',
ax,
I MAT SET FLAGI)
00 350
I '" 1, NELEM
WRITE (LalT, 340) I, mDI(I), mDJ(I), MATFU;(I)
F<»lAT (16, lOX, 14, 5X, 14, 13X, 14)
C<NI'INUE
WRI'IE (LalT, 230)
FORMAT c, 2X,
'NJDE m. ', 4X, 'IBCX', 2X, 'IBCY', 5X,
'X-<XX1ID', 6X, 'Y-<:CXlID ' )
00 250
I '" 1, NNJDES
WRITE (raJT,240)
I, NBCX(I), NBCY(I), XCOOR(I), YCOOR(I)
F<»lAT (2X, 14, 7X, 14, 2X, 14, 4X, 2G13.5)
C<NI'INUE
WRITE (raJT,610)
FORMAT v, 2X,
'SJMMARY OF PRESCRIBFD NODAL DISPIJlCEMENTS' ,
/, lOX, 'NJMBER', 4X, 'IDDAI, DISP.')
00 650
I '" 1, NPDIS
WRI'IE (LalT,520) I, DISP(I)
200
230
1
240
250
300
320
1
340
350
300
400
420
450
510
1
520
550
610
1

APPENDIX B
PROGRAM TRUSS
633
650
CCNTINUE
RETURN
END
roBRCUTINE a::oRDS (L,
NJDI, NJill, XCOOR, YCOOR, XX, yy)
C.. ••
DE:rERMINES X- AND Y-{;<XJIDINATES FOR NJDES I
AND J OF ELEMENT L
DIMENSION NJDI (30), NJOJ(30), XCOOR(20), YCOOR(20), XX (2) ,
1
YY(2)
NDI = N:lDI(L)
NDJ = NJDJ(L)
xxm = XCOOR(NDI)
XX (2) = XCOOR (NDJ)
yym = YCOOR(NDI)
yy (2) = YCOOR (NDJ)
RETURN
END
roBR:XmNE LENG'IH (XX, YY, ELENTH)
C....
CALCULATES '!HE DISTANCE BmwEEN 'lWO FOINTS
(ELEMENT LEN3TH)
DIMENSION XX(2), YY(2)
ELEN'IH = ~RT
«(XXm - XX (2) ) **2 + (YY (l)
-
YY (2» **2)
RE'lURN
END
roBRCUTINE PROPI'Y (L,
MATFLG, DA'lMAT, AREA,
ELMJD)
C....
DEFINES '!HE CROSS-SECl'IrnAL AREA AND IDDULUS OF ELASTICITY FCR
C
ELEMENT L
DIMENSION MATFIC(30), DATMAT(5,2)
NFLAG
AREA
ELMJD
RE'1URN
END
= MATFI.G(L)
= DA'll-lAT (NFUG,l)
= DATMAT(NFLAG,2)
SUBRCUTINE 'IRANSF (L, XX, YY, ELENrn, DIRCOS)
C.. • •
CCMPU'IES '!HE 'lWO DIREX::l'ION COSINES
DIMENHCN XX(2), YY(2), DIRCOS(2)
DIRCOS (l)
(XX (2)
-
XX (l)
/
ELEN'IH
DIRCOS (2) = (yy (2)
-
YY (l)
/
ELENrn
RE'1URN
END
roBR:XJTINE STIFF
<AREA, ELMJD, ELENTH, DIRCOS, ESM)
C....
mMPUTES '!HE GLOOAL ELEMENT STIFFNESS MA'lRIX
DIMENSION DIRCOS(2), ESM(4,4)
COEF = AREA * EI.n::o /
ELENrn
ESM(l,ll = COEF * DIRcn:;(l)
* DIRcn:;(l)
ESM(l,2) = COEF * DIRCOS(l)
* DIRCOS(2)
ESM(l,3) = -ESM(l,l)
ESM(l,4) = -ESM(l,2)

634
APPENDIX B
PROGRAM TRUSS
ESMC2,ll = ESMCl,2l
ESMC2,2l = COEF * DIRCQSC2l * DIRCOSC2l
ESMC2,3l = -ESMC2,ll
ESMC2,4l = -ESMC2,2l
ESMC3,ll = ESMCl,3l
ESMC3,2l = ESMC2,3l
ESMC3,3l = -ESMC3,ll
ESMC3,4l =-ESMC3,2l
ESMC4,ll = ESMCl,4l
ESMC4,2l = ESMC2,4l
ESMC4,3l = ESMC3,4l
ESMC4,4l = ESMC2,2l
REIURN
END
SUBRCUTINE ASSE}lJ( CL, mDI, NJUJ, ESM, ASMl
C••••
ASSENlLES 'lEE ASSDlBLAGE STIFFNESS
~lATRIX
DIMENSION NJDIC30l, NQDJC30l, ESMC4,4l, ASMC40,40l
NI = NJDICLl
NJ = NQDJCLl
ASMC2*NI-l,2*NI-ll =ASMC2*NI-l,2*NI-ll + ESMCl,ll
A')MC2*NI-l,2*NIl
= ASMC2*NI-l,2*NIl
+ ESMCl,2l
ASMC2*NI,2*NI-ll
=ASMC2*NI,2*NI-ll
+ ESMC2,ll
A')MC2*NI,2*NIl
= ASMC2*NI,2*NIl
+ ESMC2,2l
ASMC2*NI-l,2*NJ-ll =ASMC2*NI-l,2*NJ-ll + ESMCl,3l
A')MC2*NI-l,2*NJl
= ASMC2*NI-l,2*NJl
+ ESMCl,4l
ASMC2*NI,2*NJ-ll
=ASMC2*NI,2*NJ-ll
+ ESMC2,3l
A')MC2*NI,2*NJl
= ASMC2*NI,2*NJl
+ ESMC2,4)
ASMC2*NJ-l,2*NI-ll = A')MC2*NJ-l,2*NI-ll + ESMC3,ll
ASMC2*NJ-l,2*NIl
=ASMC2*NJ-l,2*NIl
+ ESMC3,2l
ASM(2*NJ,2*NI-ll
= ASMC2*NJ,2*NI-ll
+ ESMC4,ll
ASMC2*NJ,2*NIl
=ASMC2*NJ,2*NIl
+ ESMC4,2l
ASM(2*NJ-l,2*NJ-ll = ASM(2*NJ-l,2*NJ-ll + ESM(3,3l
ASM(2*NJ-l,2*NJl
=ASM(2*NJ-l,2*NJl
+ ESM(3,4l
A')M(2*NJ,2*NJ-ll
= A')M(2*NJ,2*NJ-ll
+ ESM(4,3l
ASM(2*NJ, 2*NJl
=ASM(2*NJ,2*NJl
+ ESM(4,4l
REIURN
END
SUBRCXJTINE ANFVEX: (NBCX, NBCY, FCRCE, ANFVl
C....
GENERATE ASSE:01BLPGE NJDAL FCRCE VEC'lffi DIRECI'LY
DIMENSION NBCX(20l, NBCY(20l, FCRCE(lSl, ANFV(40l
cx:>I'MOO NNJDES, NELE)I, NMATLS, NFDIS, NPLDS, LCllT, LPRINT, LIN,
1
~(20l
DO 100
I = 1, NN:XlES
IFLAGX = NBCX(Il
IFLAGY = NBCY(Il

APPENDIX B
PROGRAM TRUSS
635
IF (IFIJ\GX .GE. 0) 00 '10 50
IFLI\G = -IFIJlGX
ANFV(2*I-l)
= FORCE(IFLAG)
50
CCNrINJE
IF (IFLAGY .GE. 0) 00 '10 100
IFLI\G = -IFLAGY
ANFV(2*I) =FORCE(IFLAG)
100
CCNrIIDE
SUBRXJTINE !?DOC
(NBCX, NBCY, DISP, ASM, ANEV)
C....
APPLY RES'ffiAINTS rn 'lHE IDDAL DISPLACEMENTS
DIMENSION NBCX(20), NBCY(20), DISP(5), ASM(4O,40), ANEV(4O)
CD!olMOO NNJDFS, NELEM, NMATLS, NPDIS, NPLDS, LaJT, LPRINT, LIN,
1
~E(20)
N2 = 2*NN::lDFS
00 1000
I = 1, NNJDFS
IFIJ\GX = NBCX(I)
IFLAGY = NBCYeI)
IF
(IFI.Jl.GX .LE. 0) GO '10 500
00 200
J = 1, N2
ASM(2*I-l,J) =o.
200
CCNTIIDE
00 300
J = 1, N2
ANEVeJ) = ANEV(J) - ASM(J,2*I-l)*DISP(IFIJ\GX)
ASM(J,2*I-l) = 0.0
300
CCNrINJE
ANFV(2*I-l) = L~SP(IFIJ\GX)
ASMe2*I-l,2*I-l) =1.
500
CCNrIIDE
IF (IFLAGY .LE. 0) 00 '10 1000
00 700
J = 1, N2
ASM(2*I,J)
= O.
700
CCNrIIDE
00 800
J = 1, N2
ANEVeJ) = ANEV(J) - ASMeJ,2*I)*DISP(IFLAGY)
ASMeJ,2*I) = 0.0
800
CCNrIIDE
ANFV(2*I) = DISP(IFLAGY)
ASM(2*I,2*I) = 1.
1000
CCNrIIDE
SUBROUTINE mroLv eN, A, B, X)
C....
EQUATIrn roLVER BY MA'lRIX INVERSIrn
DIMENSION A(4O,40), Be4O), Xe4O)
CALL INVDEI' eA, N, DINRN, DE'lM)
CALL MA'lVEX: (N, A, B, X)
RElURN
END

636
C••••
C
C
C
C
C
C
C
C
123
124
125
126
135
127
128
137
138
139
129
130
141
142
144
131
132
136
APPENDIX B
PROGRAM TRUSS
roBR:XJTINE INVDET (C, N, D'lNRM, DE'lM)
MAnuX INIlERSICN srJ3R<lJTINE-USED BY PmMISSICN OF PRmrICE-
HALL, INC., ENG!.Fl'KXD CLIFFS, N.J.
FRCM RCBERT W. OORNBOCK,
NUMERICAL METHODS, 1975, P. 295.
INVERTS AN N BY N MATRIX C AND RElURNS '!HE INVERl'ID MATRIX BJlCK
'10 '!HE MATRIX C;
ImlRM IS '!HE DETERMINANT OF '!HE MAnuX DIVIDED
BY ras EUCLIDEAN NORM; DE'lM IS SIMPLY 'mE DETERMINANT.
'mE
DIMENSICNS OF J MUST BE lIT LEAST 21 GREATER 'IHAN '!HE RCW OR
COLUMN DIMENSION OF C.
'mE RanINE EMPLOYS GAUSS-JaIDAN ELIM-
INlITICN Wrffi mWMN 9lIFTIN; '10 MAXIMIZE '!HE PIVOI' ELEMENTS.
DIMENSION C(40,40), J(BO)
PO=I.
00 124 L =1, N
In = O.
00 123
K =1, N
In = In + C(L,K)*C(L,K)
00 = OORT (DOl
PO = PD*DD
DE'lM = I.
00 125
L = 1, N
J(Ir+-20) = L
DO 144
L = 1, N
CC = O.
M = L
DO 135
K = L, N
IF «ABS(CC) - ABS(C(L,K») .GE. 0.)
GO '10 135
M=K
CC =C(L,K)
CCNTINUE
IF
(L .m. M)
GO '10 DB
K = J(M+20)
J(M+20) = J(Ir+-20)
J(L+20) =K
DO 137
K =1, N
S = C(K,L)
C(K,L) = C(K,M)
C(K,M) = S
C(L,L) = I.
DEDI '" DE'lM*CC
DO 139
M = 1, N
C(L,M) '" C(L,M) I CC
DO 142
M=1, N
IF (L .EQ. M) GO '10 142
CC = C<M,L)
IF (ABS(CC) .LE. I.E-IOl
GO '10 142
C(M,L) = O.
DO 141
K = 1, N
C(M,K) = C(M,K) - CC*C(L,K)
CCNTINUE
CCNTINUE
DO 143
L = 1, N
IF (J(L+20) •EO. L) GO '10 143
M = L
M = M + 1
IF (J(M+20) .m. L)
GO '10 133
IF (N .GT. M)
GO '10 132

APPENDIX B
PROGRAM TRUSS
637
133
J(M+20) = J(L+-20)
00 163
K = 1, N
ex: = C(L,K)
C(L,K) = C(M,K)
163
C(M,K) = ex:
J(L+20) = L
143
CCNl'mJE
DE'lM = lIBS
(DE'IM)
ImlRM = DE'IM I
PI)
RETURN
END
SUBKXJTINE ~ (N, A, B, X)
C....
PJlGE 217 "EN'lRY ~" OF CARNAHAN, llJ'lHER,
J\ND WILKES
DIMENSION A(4O,40), B(4O), X(4O)
00 100
I = 1, N
100
XCI) = O.
00 200
I = 1, N
00 200
J = 1, N
200
XCI) =A(I,J) * B(J) + XCI)
RETURN
END
SUBR<IJTINE ffiIN'lN
(ARRAY)
C. • • •
PRINI'S 'mE OODAL DISPIJlCEI>lENTS IN rss CUTPUT
DIMENSICN ARRAY(4O)
CCHI:N NN:DES, NELEM, titolATLS, NIDIS, NPIDS, IDJT, LPRINl',
LIN,
1
TITLE(2Q)
WRITE (IDJT,25)
25
FORMAT o, 2X,
'SUMMARY OF OODAL DISPIJlCEI>lENTS' ,1,
1
5X,
'NJDE NO.', 3X,
'X-<DMl'CNENl", 5X, 'Y-aJMPONENI")
00 100
J = 1, NNJDES
WRITE (IDJT,50)
J, ARRAY (2*J-ll , lIRRAY(2*J)
50
FCRMAT (4X, IS, 6X, G12.5, 4X, G12.5)
100
CCNTINUE
1
c....
C
1
2
1
SUBIOJTINE POSTPR (roDI, sonr, XCOOR, YCOJR, MATFlG,
DI\'IMAT, SOLN)
PC6TPROCESSCR~
AXIAL ELCNGATICNS, S'lRAINS, Sl'RESSES,
J\ND FCRCES
DIMENSION OODI (30), NJDJ (30), XCOOR(20l., YCCXJR(2Q),
~~LG(30),
DI\~UIT(5,2), SOLN(40), DIRCOS(2),
xx(2) ,
YY(2)
COMMJN NNJDES, NELEl1,
N/>1ATLS, NIDIS, NPIDS, IDJT, LPRINT, LIN,
TITLE (20)
WRITE (IDJT,50)
50
FORMAT u, 2X,
'SJf1MARY OF ELEMENT RESUL~' ,1,
1
3X, 'ELEMENT NO.', 4X, 'ELON3ATICN', 5X,
'S'IRAIN',
2
5X,
'S'lRESS', 6X, 'FORCE')
00 200
L = 1, NELEM

638
APPENDIX B
PROORAM TRUSS
C....
PRELIMINARY CALCULATIONS
CALL <XX)RDS (L, IDOl, 0000, XCOOR, YCCOR, XX, yy)
CALL Lrn:;TH (XX, YY, ELENrH)
CALL PROPrY (L,
MATFLG, DA'lTolAT, AREA,
EL!oI)D)
CALL ~ (L, XX, YY, ELENrH, DIRCOS)
C....
CALCULATION OF ELENENT EI.ll-<GATION
NI = OODI (L)
ro = !'mJ(L)
UI = SOIlH2""NI - 1)
VI = SOLN(2*NIl
UJ = SOLN(2*NJ - 1)
VJ = SOLN(2*NJ)
UIPR = DIRCOS(1)*UI + DIRCOS(2)*VI
UJPR = DIRCOS(l)*UJ + DIRCOS(2)*VJ
DELTA = UJPR - UIPR
c....
CALCULATION OF ELEMENT STRAIN
STRAIN = DELTA I
ELENTH
C... •
CALCULATION OF ELPJlENT STRESS
STRESS = ELNJD • STRAIN
C....
CALCULATION OF ELPJlENT FORCE
FORCE =STRESS • AREA
C....
PRINT THE ELPJlENT RESULTANTS
WRITE (LOOT. 100)
L, DELTA. STRAIN, STRESS, FORCE
100
FORHAT (51, 14, 71, 012.5. 11. 012.5, 11, 2012.5)
200
CONTINUE
RETORN
END
B-2
Description of Input to Program TRUSS
The purpose of this part of the appendix is to give the details on the input parameters
needed to run the TRUSS program described in Sec. 3-6. Any consistent set of
units may be used. It is convenient to think of the input as being divided into seven
different sections. The information provided to the program in each of these sections
is summarized below. A ready reference is provided in Table 3-1 in the main text.
Section
Description of Input
Contains two lines of input, the first of which is an 80-column title (printed in
the output) and the second contains the" master control data" which define the
number of nodes. the number of elements. etc.
2
Contains nodal coordinate information: the nodes could be defined both with and
without nodal coordinate generation.

APPENDIX B
PROGRAM TRUSS
639
Section
Description of Input
3
Contains the element data including the nodal connectivity as well as the material
set specification for each element; the element data could be defined both with
and without element generation.
4
Contains the two "material properties" (cross-sectional area and elastic modulus)
for each "material" present.
5
Contains the "boundary condition" flags, which are defined in detail later; again
the flags could be generated or specified on a node-by-node basis.
6
Contains the applied nodal forces.
7
Contains the imposed nodal displacements.
Section 1 Input
Line I-Format 20A4
TITLE
Line 2-Format 618
NNODES
NELEM
NMATLS
NPDIS
NPLDS
LOUT
where
TITLE
NNODES
NELEM
NMATLS
NPDIS
NPLDS
LOUT
80-column title
total number of nodes
total number of elements
number of different materials
number of different prescribed displacements (usually only I)
number of different point loads
output unit (for example, on the Apple II Plus microcomputer,
the console is 3)
Notes:
I. Restrictions: NNODES ::; 20, NELEM ::; 30, NMATLS ::; 5, NPDIS ::;
5, and NPLDS ::; 15
2. This is the only input section which is not terminated with a blank line.
Section 2 Input
Line I-Format 20A4
SUBT
Line 2, 4, 6, etc.-Format 318
NI
NG
NF
Line 3,5,7, etc.-Format 4F8.0
XI
YI
XF
YF
where
SUBT
appropriate identifier or subtitle like "NODAL COORDINATE
DATA"

640
APPENDIX B
PROGRAM TRUSS
NI
= starting node number in the generation sequence (see note 2 below)
NO
nodal increment
NF
number of the final node to be generated in this sequence
XI
x coordinate of node NI,
YI
Ycoordinate of node NI
XF
x coordinate of node NF
YF
Y coordinate of node NF
Notes:
I. Restrictions: NI :S 20, NF :S 20
2. If no generation is desired, then NO, NF, XF and YF need not be input
(or zero will do).
3. A mandatory blank line must end this input section.
4. See Sec. 3-6 for more details.
Section 3 Input
Line I-Format 20A4
SUBT
Line 2, 4, 6, etc.-Format 518
LI
MS
LO
LF
NO
Line 3, 5, 7, etc.-Format 218
NI
NJ
where
SUBT = appropriate identifier or subtitle like "ELEMENT DATA"
LI
starting element number in the element generation sequence (see note
2 below)
MS
material set flag to be set for all elements in this generation sequence
LO
= element number increment
LF
number of the final element to be generated in the sequence
NO
nodal increment
NI
global node number corresponding to node "I" on element LI
NJ
global node number corresponding to node "j" on element LI
Notes:
I. Restrictions: LI :S 30, MS :S 5, LF :S 30, NI :S 20, NJ :S 20
2. If no generation is desired, then LO, LF and NO need not be input (or zero
will do).
3. A mandatory blank line must end this input section.
4. See Sec. 3-6 for more details.
Section 4 Input
Line I-Format 20A4
SUBT
Line 2, 3, 4, etc.-Format 18, 2F8.0
MSNO
AREA
ELMOD

APPENDIX B
PROGRAM TRUSS
641
where
SUBT
appropriate identifier or subtitle such as "MATERIAL PROP-
ERTY DATA"
MSNO
unique material set flag
AREA
= corresponding cross-sectional area
ELMOD = corresponding elastic modulus
Notes:
I. Restriction: MSNO :s: 5
2. A mandatory blank line must end this input section.
3. Each material set may be defined only once.
Section 5 Input
Line I-Format 20A4
SUBT
Lines 2, 3, 4, etc.-Format 518
NI
IBCX
IBCY
NG
NF
where
SUBT = appropriate identifier or subtitle like "BOUNDARY CONDITION
FLAG DATA"
NI
= number of the starting node in this generation sequence (see note 2
below),
IBCX = boundary condition flag on the x degree of freedom which will be
assigned to all nodes in this generation sequence; the meaning of
each of the possible values of IBCX is given below:
IBCX
Meaning
-N
The Nth force (see Section 6 Input) is applied in the x direction.
o The node (or nodes) is neither restrained nor "loaded" in the
x direction.
N
The Nth displacement (see Section 7 Input) is imposed in the
x direction.
IBCY
boundary condition flag on the y degree of freedom which will be
assigned to all nodes in this generation sequence; the meaning of
each of the possible values of IBCY is identical to those for IBCX,
except the y direction is affected.
NG
increment to be added to NI to get the next node number with the
same boundary condition flags, which is in tum incremented again
to get the next node number and so forth (see note 2 below)
NF
= final node number whose boundary condition flags are set to IBCX
and IBCY in the generation sequence.

642
APPENDIX B
PROGRAM TRUSS
Notes:
I. Restrictions: NI :::; 20, NF :::; 20, - 15 :::; IBCX :::; 5, - 15 :::; IBCY :::; 5
2. If no generation is desired, then NO and NF need not be input (or zero will
do).
3. A mandatory blank line must end this input section.
4. If the flags are not specified for one or more nodes, both flags are auto-
matically taken to be zero by the program.
Section 6 Input
Line I-Format 20A4
SUBT
Line 2, 3,4, etc.-Format 18, F8.0
NFORCE
FORCE
where
SUBT
appropriate identifier or subtitle like "NODAL LOADS"
NFORCE = load identification number
FORCE
corresponding force
Notes:
J. Restrictions: I :::; NFORCE :::; 15
2. A mandatory blank line must end this input section.
Section 7 Input
Line I-Format 20A4
SUBT
Line 2, 3, 4, etc.-Format 18, F8.0
NDISP
DISP
where
SUBT
appropriate identifier or subtitle like "PRESCRIBED DISPLACE-
MENTS"
NDISP = displacement identification number
DISP
= corresponding displacement
Notes:
I. Restrictions: I :::; NDISP :::; 5
2. A mandatory blank line must end this input section.

c
Active Zone Equation Solvers
SUBROUTINEs ACTCOL and UACTCL were adapted from the subroutines of the
same name in O. C. Zienkiewicz's book, The Finite Element Method, published
by McGraw-Hill Book Company (UK), 1977. These two subroutines are listed
below and require the dot-product function, FUNCTION DOT (also listed below).
These subprograms are used with the written permission of McGraw-Hill.
SUBROUTINEs ACTCOL and UACTCL should be used when the assemblage
stiffness matrix is symmetric and unsymmetric, respectively. Recall from Sec.
6-8 in the text that the lower triangular coefficients of an unsymmetric stiffness
matrix are stored in the C array, with the diagonal entries set to unity (the actual
diagonal entries are stored in the A array). See Eq. (6-72) and Fig. 6-19 for ail
example of the A and JDIAG arrays, and refer to Table 6-3 on page 280 for the
definition of the parameters A, B, C, JDIAG, NEQ, AFAC, and BACK.
SUBROUTINE ACTCOL (A, B, JDIAG,
NEQ,
AFAC, BACK)
LOGICAL AFAC, BACK
REAL JDIAG ( 1)
DIMENSION A(l), B(l)
C
C
C
FACTOR A TO UT-D-U,
REDUCE B
AENGY = 0.0
JR = 0
DO 600
J = 1,
NEQ
JD = JDIAG(J)
JH = JD - JR
IS = J - JH + 2
IF (JH - 2) 600, 300, 100
643

644
100
C
C
C
200
C
C
C
300
400
C
C
C
500
600
C
C
C
700
C
C
C
800
APPENDIX C
ACTIVE WNE EQUATION SOLVERS
IF (.NOT. AFAC) GO TO 500
IE = J - 1
K = JR + 2
ID = JDIAG(IS - 1)
REDUCE ALL EQUATIONS EXCEPT DIAGONAL
DO 200
I = IS, IE
IR = ID
ID = JDIAG(I)
IH = MINO (ID - IR - 1,
I
- IS + 1)
IF (IH .LE. 0) GO TO 200
KKK = K - IH
KKL = ID - IH
A(K) = A(K) - DOT(A(KKK). A(KKL), IH)
K = K + 1
REDUCE DIAGONAL TERM
IF (.NOT. AFAC) GO TO 500
IR = JR + 1
IE=JD-1
K = J - JD
DO 400
I = IR, IE
KKK=K+I
ID = JDIAG(KKK)
IF (A(ID) .EQ. 0.0) GO TO 400
D = A(I)
A(I) = A(I)/A(ID)
A(JD) = A(JD) - D-A(I)
CONTINUE
REDUCE RIGHT-HAND SIDE
IF (BACK) B(J) = B(J) -DOT (A(JR + 1),B(IS - 1), JH - 1)
JR = JD
IF (.NOT. BACK) RETURN
DIVIDE BY DIAGONAL PIVOTS
DO 700
I = 1, NEQ
ID = JDIAG(I)
IF (A(ID) .NE. 0.0)
B(I) = B(I)/A(ID)
AENGY = AENGY + B(I)-B(I)-A(ID)
BACK SUBSTITUTE
J = NEQ
JD = JDIAG (J)
D = B(J)
J = J -
1
IF (J .LE. 0) RETURN

APPENDIX C
ACI1VE ZONE EQUATION SOLVERS
645
JR = JDIAG (J)
IF «JD - JR) .LE. 1) GO TO 1000
IS = J - JD + JR + 2
K=JR-IS+1
DO 900
I = IS, J
KKK=I+K
900
B(I) = B(I) - A(KKK).D
1000
JD = JR
GO TO 800
END
SUBROUTINE UACTCL (A, C, B, JDIAG, NEQ, AFAC, BACK)
REAL
A(1), B(1), C(1), JDIAG(1)
LOGICAL
AFAC, BACK
C
C
FACTOR A TO UT.D.U, REDUCE B TO Y
C
JR = 0
DO 300 J = 1, NEQ
JD = JDIAG( J)
JH = JD - JR
IF (JH .LE. 1) GO TO 300
IS = J + 1 - JH
IE = J -
1
IF (.NOT. AFAC) GO TO 250
K = JR + 1
ID = 0
C
C
C
REDUCE ALL EQUATIONS EXCEPT DIAGONAL
DO 200 I = IS, IE
IR = ID
ID = JDIAG(I)
IH = MIN (ID - IR - 1, I - IS)
IF (IH .EQ. 0) GO TO 150
A(K) = A(K) - DOT (A(K - IH), C(ID - IH), IH)
C(K) = C(K) - DOT (C(K - IH), A(ID - IH), IH)
150
IF (A(ID) .NE. 0.0) C(K) = C(K)/A(ID)
200
K = K + 1
C
C
REDUCE DIAGONAL TERM
C
A(JD) = A(JD) - DOT (A(JR + 1), C(JR + 1), JH - 1)
C
C
FORWARD REDUCE THE R.H.S.
C
250
IF (BACK) B(J) = B(J) - DOT (C(JR + 1), B(IS), JH - 1)
300
JR = JD
IF (.NOT.BACK) RETURN
C
C
BACK SUBSTITUTION
C
J = NEQ

646
APPENDIX C
ACTIVE WNE EQUATION SOLVERS
JD = JDIAG(J)
500
IF (A(JD) .NE. 0.0)
B(J) = B(J)/A(JD)
D = B(J)
J = J -
1
IF (J .LE. 0) RETURN
JR = JDIAG(J)
IF «JD - JR) .LE. 1) GO TO 700
IS = J
- JD + JR + 2
K = JR - IS + 1
DO 600 I = IS, J
600
B(I) = B(I) - A(I + K)*D
700
JD = JR
GO TO 500
C
END
FUNCTION DOT (A, B, N)
DIMENSION A(1), B(1)
DOT = 0.0
DO 100
I = 1, N
DOT = DOT + A(I)*B(I)
100
CONTINUE
RETURN
END

Absolute viscosity, 450
ACTCOL, subroutine;
calling parameters,
definitions (table), 280
list, 279
source code (listing), 643-645
use of,
substructuring, 339
transient thermal analysis, 590
Active zone equation solver (see Equation sol-
ver, active zone)
Adjoint, 27
AFAC, 279, 280
Allowable distortion;
brick element, 539
quadrilateral element, 534
tetrahedral element, 542
triangular element, 534
Anisotropic heat conduction:
two-dimensional heat conduction program,
462,463
axisymmetric (stratified), 491, 492
problems, 489
theory, 488, 489
Anisotropic materials, II
Annular fin, 180, 181,470,471
Application of prescribed displacements,
two-dimensional truss, 72
Approximate solution methods (see Integral
formulations)
Area coordinates;
definition, 251
integration formula, 268
Area moment of inertia (see Moment of in-
ertia)
Assemblage, 72
INDEX
Assemblage step:
two-dimensional heat conduction, 413-419
two-dimensional incompressible viscous
flow, 455-456
two-dimensional stress analysis, 302-304
Associative properties, 24
Average strains:
axisymmetric stress analysis, 315, 316
plane stress and plane strain, 305
three-dimensional stress analysis, 322
Average stresses:
axisymmetric stress analysis, 315, 316
plane stress and plane strain, 305
three-dimensional stress analysis, 322
Axisymmetric elements:
shape functions, 265, 266
Axisymmetric heat conduction, 421-430
boundary conditions, 424, 425
FEM formulation,
examples, 426-430
general, 422-426
governing equation, 422
Axisymmetric stress analysis, 306-316
circumferential strain, 306, 307
circumferential stress, 309
constitutive relationship, 309, 310
definition, 306
element nodal force vectors, 311-315
body forces, 312, 313
line loads, 314, 315
prestresses (residual stresses), 312
surface tractions, 313, 314
thermal strains (self-strains), 311, 312
element resultants, 315, 316
element stiffness matrix, 310, 311
linear operator matrix, 308
647

648
INDEX
Axisymmetric stress analysis (continued)
material property matrix, 310
shape function matrix, 308
strain-displacement relationships, 3O<r308
strain-nodal displacement matrix, 309
strain vector, 307, 308
BACK, 279, 280
Baltimore truss, 44
Banded matrix, 57
Bandwidth, 57
Bar elements, 45
Bascule (truss), 44
Beam elements, 45, 325-328
Beams:
analysis of, 322-337
elementary theory of, 322-325
element nodal force vectors, 331, 332
element resultants, 332, 333
element stiffness matrix, 331
example, 333--337
Galerkin method, 329--332
maximum bending stress, 333
maximum shear stress, 333
shape functions, 325-328
Bending moment, 332
beam analysis, 324, 325
B matrix (see Strain-nodal displacement
matrix)
Body forces:
axisymmetric stress analysis, 312, 313
plane stress and plane strain, 298
three-dimensional stress analysis, 320
Body of revolution:
general discussion, 265
stress analysis, 307
thermal analysis, 421
Boundary conditions:
dynamic structural analysis, 613
steady-state heat conduction,
axisymmetric, 424, 425
one-dimensional, 377, 378
three-dimensional, 432, 433
two-dimensional,401
transient thermal analysis, 593
two-dimensional potential flow, 440, 441
Boundary convection:
axisymmetric heat conduction, 426
one-dimensional heat conduction, 379
three-dimensional heat conduction, 433, 434
two-dimensional heat conduction, 402, 403
Boundary radiation:
axisymmetric heat conduction, 490
one-dimensional heat conduction, 379
three-dimensional heat conduction, 499
two-dimensional heat conduction, 402, 403
Brick elements (see also Elements, types of)
numbering convention, 263
Bridge trusses, 44
Cantilever truss, 44
Capacitance matrix:
assemblage of, 584
axisymmetric, 583
consistent, 585, 586
example, 598--602
lumped, 586-588
example, 602-604
one-dimensional,
general, 583
lineal element, 599
three-dimensional, 583
two-dimensional,
general, 583
element, 583, 584
Cell Peelet number, 451
Circulation, 437
Circumferential strain, 306, 307
Circumferential stress, 309
Classification of matrices, 276
Coefficient of thermal expansion, 292, 293
Cofactors, 26
Column matrix, 29-30
Column vector, 20
Commutative properties:
matrices, 24
variational calculus, 114
Compatibility equation, 197, 198
Complete elements, 243
Complex polar form, 615
Composite element stiffness matrix:
incompressible viscous flow, 453-455
potential flow,
stream function formulation, 446
velocity potential formulation, 439
thermal analysis,
axisymmetric heat conduction, 426
convection dominated flow, 451
one-dimensional heat conduction. 378.
379
three-dimensional heat conduction. 433,
434
two-dimensional heat conduction. 402,
403
Composite nodal force vector:
incompressible viscous flow, 453-455
potential flow,
stream function formulation. 446
velocity potential formulation. 439
stress analysis, 214, 215
plane stress and plane strain, 302
thermal analysis.
axisymmetric heat conduction, 426
convection dominated flow. 451
one-dimensional heat conduction. 378,
379
three-dimensional heat conduction, 433.
434
two-dimensional heat conduction, 402,
403
Computational times:
two-dimensional vs three-dimensional stress
analysis, 316
Condensation, 339
Conduction. heat (see Heat conduction)
C'-continuous shape functions, 325-328
Conformable elements (see Conforming ele-
ments)
Conforming elements. 242
Consistent matrices, 584-586
capacitance, 585, 586
mass, 585
Constant strain triangle, 306
Constitutive relationships:

Constitutive relationships (continued)
Fourier's law,
axisymmetric form, 489
one-dimensional form, 173
three-dimensional form, 430
two-dimensional form, 390
Hooke's law,
generalized, 199
axisymmetric stress, 309, 310
plane stress and plane strain, 291-294
three-dimensional stress, 319
uniaxial stress, 198
Continuity equation:
incompressible visous flow, 452
two-dimensional potential flow, 437
Convection dominated flow, 448-452
UACTCL, application of, 451
Convergence, 5
Crank-Nicolson method, 592
Crank-Nicolson starting method, 612, 613
Crystal growth, 199
Cylindrical coordinate system, 265
C'-continuous shape functions (see also Shape
functions)
properties (lowest order), 211
D (see Material property matrix), 199
Damping matrix, 580
Data storage:
two-dimensional heat conduction, 459
two-dimensional stress analysis, 342, 343
Deflection function (see Parameter functions,
beam analysis)
Degrees of freedom:
two-dimensional truss, 57
Derivative:
of a matrix, 131
of a scalar with respect to a vector, 131,
132
Determinant, 25-27
Differential of a function, 113
Direct approach:
three-dimensional truss, 73-78
two-dimensional truss, 45-62
Direction cosines, 33-35
Direct iteration method, 371-374
examples, 373, 374
flow chart, 372
Discretization, 5, 70, 71
two-dimensional truss, 45-47
value of 'IT, ~8
Displacement functions, 186,240
Displacement method (see Stiffness method)
Displacement vector, definition of, 197
Distorted elements:
brick, 535
quadrilateral, 526
tetrahedral, 539
triangular, 531
Distributed loads (see also Surface tractions)
beam analysis, 324, 325
Distributive properties, 24
Divergence theorem, 385
Dot product, 32-33
function DOT, 279
Dynamic stress analysis (see Dynamic structu-
ral analysis)
INDEX
649
Dynamic structural analysis, 577-581, 584-
586,604-617
solution methods, 604-608
boundary conditions, application of, 613
initial conditions, use of,
Crank-Nicolson starting method, 613
Euler starting method, 612
special cases,
Galerkin, 610, 611
point collocation, 608, 609
subdomain collocation, 610
Eigenvalue, 614, 615
Eigenvector, 616, 617
Elastic modulus, 198
Elementary theory of beams, 323-325
Element capacitance matrix, 582, 583 (see
also Capacitance matrix)
Element characteristics:
global,71
local,71
Element conductance matrix (see Element stiff-
ness matrix)
Element damping matrix, 580 (see also Damp-
ing matrix)
Element generation:
two-dimensional heat conduction, 457-459
two-dimensional stress analysis, 340, 341
Element mass matrix, 580 (see also Mass
matrix)
Element nodal force vectors:
axisymmetric stress analysis,
body forces, 312, 313
line loads, 314, 315
prestresses (residual stresses), 312
surface tractions, 313, 314
thermal strain (self-strain), 311, 312
plane stress and plane strain,
body forces, 298
point loads, 301
prestresses (residual stresses), 297
surface tractions, 299, 300
thermal strain (self-strain), 296, 297
three-dimensional stress analysis, 320-322
Element numbering:
two-dimensional heat conduction, 459, 460
two-dimensional stress analysis, 342, 343
Element resultants, 72
potential flow, two-dimensional, 443, 444
stress analysis,
axisymmetric stress analysis, 315, 316
beams, 332, 333
one-dimensional stress analysis, 219
plane stress and plane strain, 305
three-dimensional stress analysis, 322
thermal analysis,
axisymmetric heat conduction, 491
one-dimensional heat conduction, 149-
151
two-dimensional heat conduction, 409
Element stiffness matrix,
axisymmetric heat conduction, 426
axisymmetric stress analysis, 310, 311
convection dominated flow, 451
incompressible viscous flow, 453-455
plane stress and plane strain, 294
size of,
•

650
INDEX
Element stiffness matrix
(continued)
structural analysis,
brick elements, 537
quadrilateral elements, 528
tetrahedral elements, 542
triangular elements, 534
thermal analysis,
brick elements, 537
quadrilateral elements, 528
tetrahedral elements, 542
triangular elements, 534
three-dimensional heat conduction, 433, 434
three-dimensional stress analysis, 319
three-dimensional truss,
global,77
local,76
transformation, 73-77
two-dimensional heat conduction,
general model, 402, 403
simple model,
Galerkin method, 398
variational, 396, 397
two-dimensional potential flow,
stream function formulation, 446
velocity potential formulation, 439
two-dimensional truss,
assemblage, 55-57
global,51-53
local, 47--49
transformation, 49-51
Elements, types of:
brick element,
cubic-order (32 nodes),
serendipity coordinates, 519, 520
linear-order (8 nodes),
serendipity coordinates, 264, 265, 517
quadratic-order (20 nodes),
serendipity coordinates, 518, 519
lineal element,
cubic-order (4 nodes),
length coordinates, 511
serendipity coordinates, 511
linear-order (2 nodes),
global coordinates, 244, 245
length coordinates, 248, 249, 510
serendipity coordinates, 247, 248
quadratic-order (3 nodes),
length coordinates, 511
serendipity coordinates, 511
rectangular,
cubic-order (12 nodes),
serendipity coordinates, 515
linear-order (4 nodes),
global coordinates, 254, 255
serendipity coordinates, 255-257, 514,
515
quadratic-order (8 nodes),
serendipity coordinates, 515
tetrahedral,
cubic-order (20 nodes),
volume coordinates, 517
linear-order (4 nodes), 258-263
global coordinates, 260, 261
volume coordinates, 261-263, 516
quadratic-order (10 nodes),
volume coordinates, 517
triangular,
cubic-order (10 nodes),
area coordinates, 514
linear-order (3 nodes), 249-253
area coordinates, 251-253, 513
global coordinates, 250, 251
quadratic-order (6 nodes),
area coordinates, 514
Equation solver, active zone, 270-280
backward substitution, 273-275
forward elimination, 273, 274
subroutine ACTCOL, 279, 280
subroutine UACTCL, 279, 280
triangular decomposition, 270-273
Equations of static equilibrium, 189-191
Equilibrium equations, 189-191
three-dimensional form, 190, 191
two-dimensional form, 190
Equilibrium problems, 101
Euler equation (see Euler-Lagrange equation)
Eulerian approach, 240
Euler-Lagrange equation:
ordinary differential equations (ODE),
fourth-order, 120, 121
second-order, 115, 116
partial differential equations (POE),
fourth-order, 486, 487
second-order, 392
Euler's identity, 615
Euler's method, 590
Euler starting method, 612
Explicit solutions, 590
Extended surface (see One-dimensional heat
conduction; see also Fin, pin)
Extremization, 107
Fin, pin:
boundary conditions, 146
element characteristics, 147-148
element nodal force vector, 148
element stiffness (conductance) matrices,
148
example, 151-155
application of prescribed base tempera-
ture. 153, 154
assemblage stiffness (conductance) mat-
rix, 153
element nodal force vectors, 152, 153
element stiffness matrices, 152, 153
exact solution, 154, 155
fin efficiency, 154
heat removal rate, 154
solution for nodal temperatures, 154
table of results, 155
.
fin efficiency, 150, 151
governing equations, 146
derivation of, 172, 173
heat removal rate, 149-150
by differentiation, 149
by integration, 150
simple fin model, 146-155
variational,
FEM, 173-175
global, 173
Finite-difference method:
comparison with FEM, 8-10
transient tnermal analysis, applied to, 577-
579, 581-604

Finite element, 3-5
Fink truss, 44
First-order Ritz method, 104-106
First-order Taylor series, 113
Flexibility method (see Force matrix method)
Flexural rigidity, 325
Fluid flow, viscous (see Incompressible
viscous flow)
Force matrix method, 15, 89
Fourier's law:
axisymmetric analysis, 489
one-dimensional, 173
three-dimensional, 430
two-dimensional, 390
Frame elements, 45
Functional, 107
Galerkin method:
dynamic structural analysis, use in, 610
example, 611
global basis, 128
example, 128, 129
transient analysis, use in, 597, 598
example, 598
Galerkin method (FEM), 14, 15
axisymmetric heat conduction, 421-430
beam analysis, 322-337
convection dominated flow, 448-452
dynamic structural analysis, 610, 611
example, 143-145
element nodal force vector, 145
element stiffness matrix, 145
incompressible viscous flow, 452-456
interpolation polynomials, 142, 143
introduction, 142, 143
one-dimensional heat conduction,
fin, 146-155
general model, 374-385
shape functions, 143
three-dimensional heat conduction, 430-436
transient thermal analysis, 582, 597, 598
two-dimensional potential flow, 436-445
two-dimensional heat conduction,
general model, 398-421
simple model, 397, 398
Galerkin method:
dynamic structural analysis, use in, 610
example, 611
global basis, 128
example, 128, 129
transient analysis, use in, 597. 598
example, 598
Gauss-Legendre quadrature (see also Quad-
rature)
sampling points and weights, table of, 544
Geometric boundary conditions:
ordinary differential equations (ODE),
fourth-order, 120, 121
second-order, 117, 119
partial differential equations (POE).
fourth-order, 486, 487
second-order, 392
Global node numbers, 45
proper numbering,
two-dimensional stress analysis, 342, 343
INDEX
651
two-dimensional thermal analysis, 459-
461
Green-Gauss theorem:
applications.
axisymmetric heat conduction, 424
convection dominated flow, 450
fourth-order POE, 486, 487
three-dimensional heat conduction, 432
two-dimensional heat conduction,
Galerkin method, 397, 400
variational, 392
two-dimensional potential flow, 438
two-dimensional potential flow, stream
function, 446
theory, 385-388
Half-bandwidth, 57
Half-plane. 266
Heat conduction:
axisymmetric, 421-430
one-dimensional,
general model, 374-385
simple model, 146-155
three-dimensional, 430-436
two-dimensional
general model, 398-421
simple model,
Galerkin, 388-391, 397-398
variational, 388-397
Heterogeneous materials (see
Nonhomogeneous materials)
Higher-order elements, 509-520
Higher-order elements:
axisymmetric,
rectangular element, 514, 515
triangular element, 512-514
one-dimensional,
length coordinates, 510, 511
serendipity coordinates, 511, 512
three-dimensional.
brick element, 517-520
tetrahedral element, 516. 517
two-dimensional,
rectangular element, 514, 515
triangular element, 512-514
Homogeneous materials, II
Hooke's law:
general stress state, 199
uniaxial stress state, 198
Howe truss, 44
Hydraulic diameter, 449
Identity matrix, 20
Implicit solutions, 590--592
Incompressible viscous flow, 452-456
assemblage step, 455, 456
continuity equation, 452
FEM formulation, 453-455
Navier-Stokes equations, 452, 453
UACTCL, application of, 456
Indefinite matrix, 276
Initial conditions:
dynamic structural analysis,
Crank-Nicolson starting method, 612, 613
Euler starting method, 612
transient thermal analysis, 593
Initial stresses (see Residual stress vector)

652
INDEX
Inner product (see Dot product)
Integral:
of a matrix, 131
as sum of other integrals, 133
Integral formulations (global),
general concepts, 103, 104
method of weighted residuals, 121- 130
Galerkin method, 128, 129
general concepts, 121, 122
least squares method, 126-128
point collocation method, 122-124
subdomain collocation method, 124-126
Rayleigh-Ritz method, 107-109
example, 108, 109
Ritz method, 104-106
example, 105, 106
variational method, 107-109
example, 108, 109
Integral methods (see Integral formulations)
Integrated term, 113
Rayleigh-Ritz FEM, 136
Integration formulas:
analytical, 267-270
area coordinates, 268
length coordinates, 267
volume coordinates, 269
Gauss-Legendre quadrature, 542-546
numerical, 542-559
for rectangles and bricks, 542-546
for triangles and tetrahedra, 553-556
Integration by parts, ]]3
Inverse of a matrix, 27-28
Irrotational flow condition, 437
Isoparametric elements, 520-525
Isoparametric formulations:
one-dimensional,
in three-dimensional space, 574
in two-dimensional space, 564-566, 572-
574
three-dimensional, 534-542
brick element, 535-539
tetrahedral element, 539-542
two-dimensional,525-534
quadrilateral element, 525-530
in three-dimensional space, 574-576
triangular element, 530-534
Isoparametric mapping (see Mapping,
isoparametric)
Isoparametric mapping, example, 524, 525
Isotropic materials, II
Jacobian matrix:
brick element, 536
quadrilateral element, 527, 528
tetrahedral element, 540
triangular element, 532, 533
JDIAG array, 278, 279
Kinematic relationships (see Strain-
displacement relations)
Kinematic viscosity, 450
Kutta-Joukowski condition, 437
L matrix (see Linear-operator matrix)
Lagrangian approach, 240
Lame constant, 292, 293
Lateral convection:
one-dimensional model, 148, 379
two-dimensional model, 402, 403
Lateral imposed heat flux:
one-dimensional model, 470
two-dimensional model, 402, 403
Lateral loads (see Distributed loads)
Lateral radiation:
one-dimensional model, 379
two-dimensional model, 402, 403
Least squares weighted residual method:
global basis, 126, 127
example, 127, 128
Length coordinates:
definition, 248
integration formula, 267
Length of vector, 31
Lift,437
Line loads:
axisymmetric stress analysis, 314, 315
Lineal elements (see Elements, types of)
Linear operator matrix:
axisymmetric stress analysis, 308
plane stress and plane strain, 291
three-dimensional stress analysis, 318
Linear spring element (see Spring element)
Local normalized coordinates (see Length,
Area, and Volume coordinates and
Serendipity coordinates)
Lumped matrices:
capacitance, 586-588
mass, 586-588
Mapping, isoparametric, 522-524
allowable distortion,
brick element, 539
quadrilateral element, 534
tetrahedral element, 542
triangular element, 534
examples, 524, 525, 547-553
Mass matrix, 580
assemblage of, 580
consistent, 585
lumped, 586-588
Mass-spring-damper system, 614
Mass-spring system, 614-616
Material property matrix, 199
axisymmetric stress, 310
plane strain, 293
plane stress, 292
three-dimensional stress, 319
Matrices:
classification of symmetric real matrices,
276
Matrix:
adjoint, 27
algebra, 21-24
addition, 22
associative property, 24
commutative property, 24
distributive property, 24
multiplication,
matrix by scalar, 22
two matrices, 23
subtraction, 22
cofactors, 26
definition, 19

Matrix (continued)
determinant, 25-27
element, 19
equality, 21
identity, 20
inverse, 27-28
minors, 26
null,20
orthogonal, 28
partitioning, 28, 29
transpose, 24
Matrix calculus:
derivative with respect to a scalar, 131
derivative of a scalar with respect to a vec-
tor, 131, 132
integral of a matrix, 131
integral as a sum of other integrals, 133
Maximum bending stress, 333
Maximum shear stress, 333
Mesh, II
Mesh generation, 46
plane stress and plane strain, 340, 341
two-dimensional heat conduction, 457--459
Mesh. graded, II
Method of exhaustion, 5
Minimum potential energy principle (see Prin-
ciple of minimum potential energy)
Minors, 26
Modal analysis, 614-617
Mode shapes, 617
Modulus of elasticity, 198, 292
Mohr's circle, 192, 194, 195
Moment of inertia, 325
NASTRAN, I, 12
Narural boundary conditions:
ordinary differential equations (ODE),
fourth-order, 120, 121
second-order, 117, 119
partial differential equations (POE),
fourth-order, 486, 487
second-order, 392
Natural frequency, 614
Navier-Stokes equations, 452, 453
Negative definite matrix, 276
Negative faces, 188
Negative semidefinite matrix, 276
N matrix (see Shape function matrix)
Node generation:
plane stress and plane strain, 340, 341
two-dimensional heat conduction, 457--459
Node numbering, restrictions on:
plane stress and plane strain, 342, 343
two-dimensional heat conduction, 459, 460
Nonconformable elements, 242
Nonconforming elements, 242
Nonhomogeneous materials, II
Normal stress:
definition, 188
sign convention, 188, 189
Null matrix, 20
Numerical integration (see Quadrature)
One-dimensional elements (see Elements,
types of)
One-dimensional heat conduction:
computer program, 178, 179
INDEX
653
subroutine PROPTY, 178
subroutine VPROP, 178, 179
general model, 374-385
examples, 379-385
FEM formulation, 376-379
governing equation, 375
miscellaneous fins, 175-177, 180, 181,
468--470
pin fin,
boundary conditions, 146
element characteristics, 147-148
element nodal force vector, 148
element stiffness (conductance) matrices,
148
example, 151-155
application of prescribed base tempera-
ture, 153, 154
assemblage stiffness (conductance) mat-
rix, 153
element nodal force vectors, 152, 153
element stiffness matrices, 152, 153
exact solution, 154, 155
fin efficiency, 154
heat removal rate, 154
solution for nodal temperatures, 154
table of results, 155
fin efficiency, 150, 151
governing equations, 146
derivation of, 172, 173
heat removal rate, 149-150
by differentiation, 149
by integration, 150
variational,
finite element solution, 173-175
global, 173
simple fin model, 146-155
One-dimensional stress analysis, (see also Un-
iaxial stress member)
computer program,
subroutine PROPTY, 236
subroutine VPROP, 236, 237
example, 219-223
FEM formulation, 215-219
Orthogonal matrix, 51
Parameter functions, 239-243
beam analysis, 325, 326
compatibility, 241, 242
completeness, 242, 243
definition, 240
restrictions, 240-243
weak formulations, 241
Parent element, 524
Partial discretization, 578, 579
Partitioned matrices, 28, 29
Pascal triangle, 512, 513
Peclet number, 449
Piecewise continuous trial functions, 130
Pin fin (see Fin, pin and One-dimensional heat
conduction)
Planar domain (in axisymmetric problems),
266
Plane strain:
constitutive relationship, 293, 294
definition, 289
material property matrix, 293
shape function matrix, 289, 290

654
INDEX
Plane strain (continued)
strain-nodal displacement matrix, 290, 291
thermal strains (self-strains), 292
Plane stress:
constitutive relationship, 292, 293
definition, 288
material property matrix, 292
shape function matrix, 289, 290
strain-nodal displacement matrix, 290, 291
thermal strains (self-strains), 292
Point collocation:
dynamic structural analysis, use in, 608,
609
example, 609
global basis, 122, 123
example, 123, 124
transient analysis, use in, 596
example, 596, 597
Pointer array (see JDlAG array)
Point heat source:
axisymmetric models, 430
computer program, implementation in, 463
three-dimensional models, 500
two-dimensional models, 407--408
Point loads:
beams, 323, 324
plane stress and plane strain, 301
three-dimensional stress, 321, 322
Position vector, 31
Positive definite matrix, 276
Positive faces, 188
Positive semidefinite matrix, 276
Potential flow, two-dimensional, 436--448
circulation, 437
continuity equation, 437
irrotational flow condition, 437
Kutta-Joukowski condition, 437
lift, 437
stream function formulation,
application, 446--448
general, 445, 446
velocity potential formulation,
application, 444, 445
element resultants, 443, 444
examples, 439--443
general, 437-439
Prandtl number, 450
Pratt truss, 44
Prescribed displacements, application of,
plane stress and plane strain, 304
Prescribed temperatures, application of,
two-dimensional heat conduction, 419
Pressure functions, 240
Prestress (residual stresses):
axisymmetric stress analysis, 312
one-dimensional stress analysis, 218
plane stress and plane strain, 297
three-dimensional stress analysis, 320
Primitive variables, 102, 456
Principal stresses, 191-195
three-dimensional, 192, 193
two-dimensional, 191, 192
example, 193-195
Principle of minimum potential energy, 185,
200-204
example, 202-204
external potential energy, 200
internal potential energy, 200
total potential energy, 200, 202
Principle of virtual displacements, 185, 204-
206
example, 204, 205
mathematical statement, 205
Principle of virtual forces, 204
Principle of virtual work (see Principle of vir-
tual displacements, or Principle of
virtual forces)
Quadrature:
brick element, 545, 546
Gauss-Legendre,
sampling points and weights, table of,
544
rectangular element, 542-553
required order, 558, 559
tetrahedral element, 554, 556
sampling points and weights, summary
of, 556
triangular element, 553-555
sampling points and weights, summary
of, 555
Quadrilateral averages, method of:
two-dimensional heat conduction, 419-421
two-dimensional stress analysis, 420
Rayleigh dampling, 581
Rayleigh-Ritz finite element method:
C'-continuous shape functions, 136
CO-continuousshape functions, 136
example, 136-142
element nodal force vector, 137
element stiffness matrix, 137
interpolation polynomials, 133, 134
introduction, 133-136
shape functions, 134, 135
Rayleigh-Ritz method, 102, 103 (see also
Rayleigh-Ritz finite element method)
FEM, 133-136
example, 136-142
general, 115-121
global, 107-109
example, 107-109
Rectangular elements (see also Elements, types
of)
numbering convention, 253, 254
Rectangular prismatic element (see Brick ele-
ment)
Redundant force method, 15
Residual stresses (see Prestresses)
Resolution capability, 276
Resonance, 617
Reynolds number, 449, 450
Ritz method (global), 102, 104-106
example, 105, 106
Roof trusses, 44
Row matrix, 29-30
Row vector, 20
Sampling points and weights:
Gauss-Legengre quadrature, 544
serendipity elements, 544
tetrahedral elements, 556
triangular elements, 555
Scalar product (of two vectors), 32-33 (see
also Dot product)
Self-strains (see Thermal strains)

Serendipity coordinates, definition of:
one-dimensional, 247
three-dimensional, 264, 265
two-dimensional, 255, 256
Shape function matrix:
axisymmetric stress analysis, 308
plane stress and plane strain, 207-213
three-dimensional stress analysis, 318
Shape functions, first-order, 130 (see also
Higher-order elements)
axisymmetric elements, 265, 266
beam element, 325-328
one-dimensional elements, 244-249
2-node lineal element,
global coordinates, 244--246
length coordinate, 248, 249
serendipity coordinate, 247, 248
three-dimensional elements, 257-265
8-node brick element, 263-265
global coordinates, 264
serendipity coordinates, 264, 265
4-node tetrahedral element, 258-263
element, global coordinates, 260, 261
volume coordinates, 261, 262
two-dimensional elements, 249-257
4-node rectangular element, 253-257
global coordinates, 254, 255
serendipity coordinates, 255-257
3-node triangular element, 249-253
area coordinates, 251, 253
global coordinates, 250, 251
Shear force, 332
beam analysis, 324, 325
Shear modulus, 292, 293
Shear stress:
definition, 188
sign convention, 188, 189
Shrinkage, 199
Sign conventions (stress), 188, 189
Simplex elements (see Lineal elements,
Triangular elements, and Tetrahedral
elements)
Skew-symmetric matrix, 24
Slope (of a beam), 325
Solutions, system of algebraic equations:
active zone equation solver, 270-280
matrix inversion method, 35-36
Spring element:
application, 333, 335
definition, 333
Spring-mass system. 614--616
Stadium truss, 44
STAROYNE, I
Statically indeterminate beams, 323
Static equilibrium equations (see Equilibrium
equations)
Static equilibrium problems, 101
Static problems, 101
Static stress analysis (see Stress analysis)
Steady-state problems, 10I
Stiffness method, 15, 89, 185
Storage considerations, 277-279
banded storage method, 277, 278
half-bandwidth, 277
skyline storage method, 278, 279
JDIAG array, 278, 279
two-dimensional heat conduction, 459, 460
two-dimensional stress analysis, 342, 343
tNDEX
655
Strain, 195, 196
Strain-displacement relations, 196, 197
axisymmetric stress analysis, 306-308
linear-operator matrix, 197
plane stress and plane strain, 290, 291
three-dimensional stress analysis, 317
Strain-nodal displacement matrix:
axisymmetric stress analysis, 309
definition, 213
plane stress and plane strain, 291
three-dimensional stress analysis, 318
Strain vector, definition of, 197, 199, 317
Stream function formulation, 102
two-dimensional potential flow, 445, 446
Stress:
conversion factor, 188
definition, 186-188
Stress analysis:
axisymmetric, 306-316 (see also
Axisymmetric stress analysis)
element characteristics, general, 213-215
element nodal force vectors, general, 214,
215
element stiffness matrix, general, 214
finite element basis,
four-node tetrahedral element (3-D), 206,
210,211
mathematical statement, 207
three-node triangular element (2-0), 206,
208-210
two-node lineal element (I-D), 206, 208
generalized Hooke's law, 214
material property matrix, general, 214
shape function matrix (CO-continuity), 207-
213
three-dimensional, 316-322 (see also Three-
dimensional stress analysis)
two-dimensional, 287-306 (see also Plane
stress and Plane strain)
Stresses, sign convention of, 188, 189
Stress transformation, 191, 192
Stress-strain relationships (see Constitutive re-
lationships and Hooke's law)
Stress vector, 199, 319
Subdomain collocation:
dynamic structural analysis, use in, 610
example, 610
global basis, 124, 125
example, 125, 126
transient analysis, use in, 597
Subparametric elements, 520-525
Subroutine ACTCOL (see ACTCOL)
Subroutine UACTCL (see UACTCL)
Substructuring, 337-339
advantages of, 339
subroutine ACTCOL, use of, 339
Superparametric elements, 520-525
Surface tractions, 199, 200, 320, 321
Symmetric matrix, 24
Tapered fin, 177
Tapered uniaxial stress member (see Uniaxial
stress member)
Taylor series expansion, 113
Temperature functions. 240
Temporal element. 594
Tetrahedral element (see also Elements, types
of)

656
INDEX
Tetrahedral element (continued)
numbering convention, 258-263
volume of, 261
Thermal diffusivity, 449
Thermal strain (self-strains):
axisymmetric stress analysis, 309
plane strain, 293
plane stress, 292
three-dimensional stress analysis, 319, 320
Thermal stresses, 199
Three-dimensional elements (see Elements,
types of)
Three-dimensional heat conduction, 430--436
FEM formulation, examples, 435, 436
general, 431-434
Fourier's law, 430
governing equation, 431
Three-dimensional stress analysis, 316-322
computational times, 316
constitutive relationship, 319
displacement vector, 317
element nodal force vectors, 320-322
element resultants, 322
element stiffness matrix, 319
linear operator matrix, 318
material property matrix, 319
shape function matrix, 318
strain-displacement relationship, 317
strain-nodal displacement matrix, 318
strain vector, 317
thermal strains (self-strains), 319
Three-dimensional truss (see Truss, three-
dimensional)
Three-point recurrence schemes, 604-613 (see
also Dynamic structural analysis)
Time step, 589
Transient thermal analysis, 577-579, 581-604
ACTCOL, use of, 590
examples, 598-604
prescribed temperatures, application of,
592-594
solution methods, 588-598
backward difference scheme, 591
central difference scheme, 591, 592
difference schemes, generalized, 592-594
FEM-based, 594-598
Galerkin, 597, 598
generalized solution, 596
point collocation, 596, 597
subdomain collocation, 597
forward difference scheme, 589-590
Transpose of a matrix, 24
Trial functions, 14
piecewise continuous, 14
requirements, 106
Triangular elements: (see also Elements, types
of)
area of, 251
numbering convention, 249, 250
Truss:
definition, 43-44
three-dimensional,
degrees of freedom, 75
direction cosines, 77-78
element resultants, 78
global element stiffness matrix, 76-77
local element stiffness matrix, 75-76
transformation matrix, 73-74
two-dimensional,
application, 62-70
application of displacement contraints,
59--61
Method I, 59-60
Method 2 (penalty function), 60-61
application of loads, 58-59
assemblage, 55-58
degrees of freedom, 57
direction cosines, 51-53
discretization, 45-47
element resultants, 61-6:t
axial elongation, 6-1-62
axial force, 61-62
axial strain, 61-62
axial stress, 61-62
global element stiffness matrix, 51-54
half-bandwidth, 57-58
local element stiffness matrix, 47-49
transformation matrix, 49-51
types, 44
TRUSS program, 79-87
Two-dimensional elements (see Elements,
types of)
Two-dimensional heat conduction:
assemblage step,
example, 414-419
computer program,
anisotropic material, 462, 463
data storage, 459, 460
main program, 457
mesh generation, 457-459
node numbering schemes, 459, 460
point heat source, implementation of, 463
variable property routine, 460--463
element resultants, example, 419-421
general model, 409
FEM formulation, 400--421
application, 410--421
examples, 403-410
general development, 400--403
governing equation, 399
schematic, 399
quadrilateral averages, 420--421
simple model,
boundary conditions, 389
Fourier's law, 390
Galerkin method, 397-398
governing equation, 388
variational formulation, 391-397
Two-dimensional stress analysis (see also
Plane stress and plane strain)
computer program,
data storage, 342, 343
main program, 340
mesh generation, 340, 341
node numbering schemes, 342, 343
Two-node lineal element (see Elements, types
of)
Two-point recurrence schemes, (see also Tran-
sient thermal analysis)
based on FEM, 594-598
based on finite differences, 589-594
schematic of, 593
UACTCL, subroutine:
application of, 451
calling parameters,

UACTCL, subroutine (continued)
definitions (table), 280
list, 279
source code (listing), 645-646
Undamped natural frequency, 615
Uniaxial stress member, tapered, 215-225
Uniaxial stress member:
cancellation of internal forces, 223, 224
element nodal force vectors, 218
element resultants, 218
element stiffness matrix, 217
example, 218-225
application of prescribed displacement,
222
assemblage, 221, 222
discretization, 220
element nodal force vectors, 221, 222
element resultants, 223
element stiffness matrices, 221, 222
solution for nodal displacements, 222
table of results, 225
Galerkin FEM, 170, 171
governing equation, 166, 167
linear-operator matrix L, 216
self-strain (from temperature change), 217
shape function matrix, 216
strain-nodal displacement matrix B, 216
stress-strain relationship, 217
variational FEM, 168--170
variational formulation (global), 167, 168
Unit vectors, 29-30
Unsteady heat conduction (see Transient ther-
mal analysis)
Unsteady thermal analysis (see Transient ther-
mal analysis)
Upwinding schemes, 451, 452
Variable property routine:
one-dimensional heat conduction program,
178, 179
one-dimensional stress analysis program,
235-237
two-dimensional heat conduction program,
460-462
Variational calculus:
classical problem, 110--112
commutative properties, 114
definition, 102
Euler-Lagrange equation,
ordinary differential equations (ODE),
fourth-order, 120, 121
second-order, 115, 116
partial differential equations (POE),
fourth-order, 486, 487
second-order, 392
functional, 107
geometric boundary conditions,
ordinary differential equations (ODE),
fourth-order, 120, 121
second-order, 117, 119
partial differential equations (POE),
fourth-order, 486, 487
INDEX
657
second-order, 392
introduction, 110--115
miscellaneous rules, 114, 115
natural boundary conditions,
ordinary differential equations (ODE),
fourth-order, 120, 121
second-order, 117, 119
partial differential equations (POE),
fourth-order, 486, 487
second-order, 392
odd-order derivatives, 121
power rule, 115
product rule, 115
quotient rule, 115
variation of a functional, 114
Variational method, 102, 103
example, 108, 109
global, 107-109
Variational principles (see Variational calculus)
Vector:
algebra, 32
addition, 32
dot product, 32-33
subtraction, 32
definition, 29-30
direction cosines, 33-35
equality, 31
length, 31
position, 31
Velocity functions, 240
Virtual displacement principle (see Principle of
virtual displacements)
Virtual force principle (see Principle of virtual
forces)
Virtual work principle (see Principle of virtual
displacements, or Principle of virtual
forces)
Viscosity:
absolute, 450
kinematic, 450
Volume coordinates:
definition, 261, 262
integration formula, 269
Vorticity formulation, 102
Warren truss, 44
Weak formulation, 108
Weighted-residual methods (global), 102, 103
Galerkin, 126-128
general concepts, 121, 122
least squares, 126-128
point collocation, 122-124
subdomain collocation, 124--126
Weights (see Sampling points and weights)
XL arrav:
two-dimensional heat conduction program,
459, 460
two-dimensional stress analysis program
342, 343
'
Young's modulus, 198

,

\\\11111\111\1\\111\1\1111\111\11\\\11\\ .
01:02:6883
;":1 .JJl..A ~'Q ,,~L .; :f..r
4,,).::...:,::£

