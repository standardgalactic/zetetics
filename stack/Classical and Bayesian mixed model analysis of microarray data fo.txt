Graduate Theses and Dissertations
Iowa State University Capstones, Theses and
Dissertations
2009
Classical and Bayesian mixed model analysis of
microarray data for detecting gene expression and
DNA differences
Cumhur Yusuf Demirkale
Iowa State University
Follow this and additional works at: https://lib.dr.iastate.edu/etd
Part of the Statistics and Probability Commons
This Dissertation is brought to you for free and open access by the Iowa State University Capstones, Theses and Dissertations at Iowa State University
Digital Repository. It has been accepted for inclusion in Graduate Theses and Dissertations by an authorized administrator of Iowa State University
Digital Repository. For more information, please contact digirep@iastate.edu.
Recommended Citation
Demirkale, Cumhur Yusuf, "Classical and Bayesian mixed model analysis of microarray data for detecting gene expression and DNA
differences" (2009). Graduate Theses and Dissertations. 10760.
https://lib.dr.iastate.edu/etd/10760

Classical and bayesian mixed model analysis of microarray data for detecting
gene expression and DNA diﬀerences
by
Cumhur Yusuf Demirkale
A dissertation submitted to the graduate faculty
in partial fulﬁllment of the requirements for the degree of
DOCTOR OF PHILOSOPHY
Major: Statistics
Program of Study Committee:
Dan Nettleton, Co-major Professor
Tapabrata Maiti, Co-major Professor
Alicia Carriquiry
Heike Hofmann
Roger P. Wise
Iowa State University
Ames, Iowa
2009
Copyright c⃝Cumhur Yusuf Demirkale, 2009. All rights reserved.

ii
TABLE OF CONTENTS
LIST OF TABLES . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
v
LIST OF FIGURES . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
vii
ABSTRACT . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
ix
CHAPTER 1.
General Introduction . . . . . . . . . . . . . . . . . . . . . . . .
1
CHAPTER 2.
Linear Mixed Model Selection for False Discovery Rate Con-
trol in Microarray Data Analysis . . . . . . . . . . . . . . . . . . . . . . . .
5
2.1
Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
5
2.2
Example: Gene Expression in Barley . . . . . . . . . . . . . . . . . . . . . . . .
8
2.2.1
Data . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
9
2.2.2
Linear Mixed Model . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
9
2.3
Candidate Analysis Methods
. . . . . . . . . . . . . . . . . . . . . . . . . . . .
11
2.3.1
Methods Involving Selection . . . . . . . . . . . . . . . . . . . . . . . . .
12
2.3.2
The ANOVA Approach
. . . . . . . . . . . . . . . . . . . . . . . . . . .
13
2.4
Simulation Study . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
14
2.4.1
Simulation Design
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
14
2.4.2
Simulation Results . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
15
2.5
Two-Stage Hybrid Method . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
17
2.5.1
Description . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
17
2.5.2
Application to Simulated data
. . . . . . . . . . . . . . . . . . . . . . .
18
2.5.3
Application of the Hybrid Method to the Barley Data . . . . . . . . . .
18
2.6
Performance when ANOVA Tests are Not Exact
. . . . . . . . . . . . . . . . .
19

iii
2.6.1
Assessing the Impact of Heavy-Tailed Errors
. . . . . . . . . . . . . . .
20
2.6.2
Assessing the Impact of Missing Data
. . . . . . . . . . . . . . . . . . .
20
2.7
Concluding Remarks . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
21
2.8
References . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
23
2.9
Appendix A: Model Selection . . . . . . . . . . . . . . . . . . . . . . . . . . . .
24
2.9.1
BIC Formulation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
24
2.9.2
AIC and BIC for Model Selection . . . . . . . . . . . . . . . . . . . . . .
24
2.10 Appendix B: Exact Inference Using ANOVA . . . . . . . . . . . . . . . . . . . .
25
2.10.1 Mixed Linear Model . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
25
2.10.2 ANOVA Construction of F-tests Based on Expected Mean Squares . . .
26
2.11 Appendix C: Tests for Main Eﬀects . . . . . . . . . . . . . . . . . . . . . . . . .
33
2.11.1 The Test of Genotype Main Eﬀects . . . . . . . . . . . . . . . . . . . . .
34
2.11.2 The Test of Time Main Eﬀects . . . . . . . . . . . . . . . . . . . . . . .
36
2.12 Appendix D: Additional Simulation Studies . . . . . . . . . . . . . . . . . . . .
38
2.12.1 Assessing the Impact of Percentage of Non-null Genes in the Data . . .
38
2.12.2 Assessing the Impact of Heavy-Tailed Errors
. . . . . . . . . . . . . . .
39
2.12.3 Assessing the Impact of Missing Data
. . . . . . . . . . . . . . . . . . .
39
CHAPTER 3.
Bayesian Analysis of Microarray Experiments with Multiple
Sources of Variation: A Mixed Model Approach . . . . . . . . . . . . . . .
71
3.1
Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
71
3.2
Example: Gene Expression in Barley . . . . . . . . . . . . . . . . . . . . . . . .
73
3.2.1
Data . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
73
3.2.2
Linear Mixed Model Analysis of the Barley Data . . . . . . . . . . . . .
74
3.3
Bayesian Hierarchical Analysis
. . . . . . . . . . . . . . . . . . . . . . . . . . .
76
3.3.1
Hierarchical Model . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
76
3.3.2
Prior Speciﬁcation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
77
3.3.3
Inference
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
79
3.4
Simulation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
81

iv
3.4.1
Simulation 1
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
82
3.4.2
Simulation 2
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
84
3.4.3
Simulation 3
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
86
3.5
Application of the Hierarchical Bayesian Method to the Barley Data . . . . . .
87
3.6
Concluding Remarks . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
88
3.7
References . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
89
CHAPTER 4.
Identifying Single Feature Polymorphisms Using Aﬀymetrix
Gene Expression Data . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
101
4.1
Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 101
4.2
Background . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 103
4.2.1
Aﬀymetrix GeneChips . . . . . . . . . . . . . . . . . . . . . . . . . . . . 103
4.2.2
Description of Single Feature Polymorphism . . . . . . . . . . . . . . . . 104
4.3
Materials and Methods . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 104
4.3.1
Data Sets . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 104
4.3.2
Candidate Analysis Methods
. . . . . . . . . . . . . . . . . . . . . . . . 106
4.4
Application . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 112
4.4.1
Identiﬁcation of Single Feature Polymorphisms in Maize . . . . . . . . . 112
4.4.2
Identiﬁcation of Single Feature Polymorphisms in Barley . . . . . . . . . 114
4.4.3
Identiﬁcation of Single Feature Polymorphisms in the Soybean Data . . 116
4.5
Concluding Remarks . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 118
4.6
References . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 119
CHAPTER 5.
General Conclusion . . . . . . . . . . . . . . . . . . . . . . . . .
143
ACKNOWLEDGEMENTS . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
145

v
LIST OF TABLES
Table 2.1
AIC and BIC Selection for the Barley Data Set . . . . . . . . . . . . .
41
Table 2.2
Genotype-by-time Interaction Test: Results for the Complete Data . .
41
Table 2.3
Application of the Hybrid Method to the Barley Data Set . . . . . . .
42
Table 2.4
Genotype-by-time Interaction Test: Results for the Missing Data
. . .
43
Table 2.5
AIC Selection for the Simulated Data with no Treatment Eﬀect . . . .
44
Table 2.6
BIC selection for the Simulated Data with no Treatment Eﬀect
. . . .
44
Table 2.7
ANOVA Table . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
45
Table 2.8
Genotype Test: Results for the Complete Data
. . . . . . . . . . . . .
46
Table 2.9
Time Test: Results for the Complete Data . . . . . . . . . . . . . . . .
47
Table 2.10
Genotype-by-time Interaction Test: Results for the Complete Data . .
48
Table 2.11
Genotype Test: Results for the Non-Normal Data . . . . . . . . . . . .
49
Table 2.12
Time Test: Results for the Non-Normal Data
. . . . . . . . . . . . . .
50
Table 2.13
Genotype-by-time Interaction Test: Results for the Non-Normal Data .
51
Table 2.14
Genotype Test: Results for the Missing Data . . . . . . . . . . . . . . .
52
Table 2.15
Time Test: Results for the Missing Data . . . . . . . . . . . . . . . . .
53
Table 2.16
Genotype-by-time Interaction Test: Results for the Missing Data
. . .
54
Table 3.1
MMA Results for the First Simulated Data
. . . . . . . . . . . . . . .
91
Table 3.2
MMA and HBA results for the First Simulated Data . . . . . . . . . .
91
Table 3.3
MMA Analysis Results for the Second Simulated Data . . . . . . . . .
92
Table 3.4
MMA and HBA results for the Second Simulated Data . . . . . . . . .
92
Table 3.5
Genotype Test: Correlations between F4 statistics . . . . . . . . . . . .
93
Table 3.6
Time Test: Correlations between F4 statistics . . . . . . . . . . . . . .
93

vi
Table 3.7
Genotype-by-time interaction Test: Correlations between F4 statistics
94
Table 3.8
Identifying Signiﬁcant Genes in the Barley Data Set
. . . . . . . . . .
94
Table 4.1
SFP Identiﬁcation by the Seven Method for the Five Tissues in the
Maize Data Set . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 122
Table 4.2
SFP Identiﬁcation by the Seven Method for the Six Tissues in the Barley
Data Set . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 123
Table 4.3
Identifying SFPs in the Soybean Data Set . . . . . . . . . . . . . . . . 124

vii
LIST OF FIGURES
Figure 2.1
Genotype-by-time Interaction: Results for the Complete Data . . . . .
55
Figure 2.2
Genotype Test: Results for the Full Data Sets . . . . . . . . . . . . . .
56
Figure 2.3
Time Test: Results for the Full Data Sets
. . . . . . . . . . . . . . . .
58
Figure 2.4
Genotype-by-time Interaction Test: Results for the Full Data Sets . . .
60
Figure 2.5
Genotype Test: Results for the non-normal Data
. . . . . . . . . . . .
62
Figure 2.6
Time Test: Results for the non-normal Data . . . . . . . . . . . . . . .
63
Figure 2.7
Genotype-by-time interaction Test: Results for the non-normal Data .
64
Figure 2.8
Genotype Test: Results for the Missing Data . . . . . . . . . . . . . . .
65
Figure 2.9
Time Test: Results for the Missing Data . . . . . . . . . . . . . . . . .
67
Figure 2.10
Genotype-by-time Interaction Test: Results for the Missing Data
. . .
69
Figure 3.1
Genotype Test: ROC Curves for the First Simulated Data . . . . . . .
95
Figure 3.2
Time Test: ROC Curves for the First Simulated Data
. . . . . . . . .
96
Figure 3.3
Genotype-by-Time Interaction Test: ROC Curves for the First Simu-
lated Data . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
97
Figure 3.4
Genotype Test: ROC Curves for the Second Simulated Data . . . . . .
98
Figure 3.5
Time Test: ROC Curves for the Second Simulated Data
. . . . . . . .
99
Figure 3.6
Genotype-by-Time Interaction Test: ROC Curves for the Second Sim-
ulated Data . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 100
Figure 4.1
Single Feature Polymorphisms Description . . . . . . . . . . . . . . . . 125
Figure 4.2
Maize Data: Endosperm 19 DAP Tissue . . . . . . . . . . . . . . . . . 126
Figure 4.3
Maize Data: Endosperm 13 DAP Tissue . . . . . . . . . . . . . . . . . 127

viii
Figure 4.4
Maize Data: Immature Ear Tissue
. . . . . . . . . . . . . . . . . . . . 128
Figure 4.5
Maize Data: 19 DAP Embryo Tissue . . . . . . . . . . . . . . . . . . . 129
Figure 4.6
Maize Data: Seedling Tissue . . . . . . . . . . . . . . . . . . . . . . . . 130
Figure 4.7
Barley Data: RAD Tissue . . . . . . . . . . . . . . . . . . . . . . . . . 131
Figure 4.8
Barley Data: COL Tissue
. . . . . . . . . . . . . . . . . . . . . . . . . 132
Figure 4.9
Barley Data: CRO Tissue
. . . . . . . . . . . . . . . . . . . . . . . . . 133
Figure 4.10
Barley Data: GEM Tissue . . . . . . . . . . . . . . . . . . . . . . . . . 134
Figure 4.11
Barley Data: LEA Tissue
. . . . . . . . . . . . . . . . . . . . . . . . . 135
Figure 4.12
Barley Data: ROO Tissue . . . . . . . . . . . . . . . . . . . . . . . . . 136
Figure 4.13
Soybean Data: SFPs in Probe set Gma.734.1.A1 at . . . . . . . . . . . 137
Figure 4.14
Soybean Data: SFPs in Probe set Gma.11144.2.S1 at . . . . . . . . . . 138
Figure 4.15
Soybean Data: SFPs in Probe set GmaAﬀx.39499.1.S1 at
. . . . . . . 139
Figure 4.16
Soybean Data: SFPs in Probe set Gma.734.1.A1 at . . . . . . . . . . . 140
Figure 4.17
Soybean Data: SFPs in Probe set Gma.11144.2.S1 at . . . . . . . . . . 141
Figure 4.18
Soybean Data: SFPs in Probe set GmaAﬀx.39499.1.S1 at
. . . . . . . 142

ix
ABSTRACT
This thesis focuses on classical and Bayesian mixed model analysis of microarray data for
detecting gene expression and DNA diﬀerences. It consists of three research papers. The ﬁrst
study discusses the selection of gene speciﬁc linear mixed models in microarray data analysis.
In a microarray experiment, one experimental design is used to obtain expression measures
for all genes. One popular analysis method involves ﬁtting the same linear mixed model for
each gene, obtaining gene-speciﬁc p-values for tests of interest involving ﬁxed eﬀects, and then
choosing a threshold for signiﬁcance that is intended to control False Discovery Rate (FDR)
at a desired level. When one or more random factors have zero variance components for some
genes, the standard practice of ﬁtting the same full linear mixed model for all genes can result
in failure to control FDR. We propose a new method which combines results from the ﬁt of full
and selected linear mixed models to identify diﬀerentially expressed genes and provide FDR
control at target levels when the true underlying random eﬀects structure varies across genes.
The second study discusses a hierarchical Bayesian modeling strategy for microarray data
analysis. Some microarray experiments have complex experimental designs that call for mod-
eling of multiple sources of variation through the inclusion of multiple random factors. While
large amounts of data on thousands of genes are collected in these experiments, the sample
size for each gene is usually small. Therefore, in a classical gene-by-gene mixed linear model
analysis, there will be very few degrees of freedom to estimate the variance components of all
random factors considered in the model and low statistical power for testing ﬁxed eﬀects of
interest. To address these challenges, we propose a hierarchical Bayesian modeling strategy
to account for important experimental factors and complex correlation structure among the
expression measurements for each gene. We use half-Cauchy priors for the standard deviation

x
parameters of the random factors with few eﬀects. We rank genes with respect to evidence
of diﬀerential expression across the levels of a factor of interest by calculating a single sum-
mary statistic per gene from the posterior distribution of the treatment eﬀects considered in
the model. Simulation shows that our hierarchical Bayesian approach is much better than a
traditional gene-by-gene mixed linear model analysis at distinguishing diﬀerentially expressed
genes from non-diﬀerentially expressed genes.
The third study focuses on the identiﬁcation of Single Feature Polymorphisms (SFPs)
using Aﬀymetrix gene expression data. In microarray data analysis, the identiﬁcation of SFPs
is important for producing more accurate expression measurements when comparing samples
of diﬀerent genotypes. Also, portions of DNA that diﬀer between parental lines can serve
as markers for tracking DNA inheritance in oﬀspring. We summarize several SFPs discovery
methods in the literature. To identify single probes deﬁning SFPs in the data, we developed
two new algorithms where a diﬀerence value is deﬁned for each probe after accounting for
the overall gene expression level diﬀerences in the probe set. The ﬁrst method contrast the
diﬀerence value of each probe with the average of the diﬀerence values for the rest of the probes
in that probe set. Second method is a robust version of the ﬁrst method. The performance
of all methods are compared through two publicly available published data sets, where truth
about the sequence polymorphism is known for some “Gold Standard” probes. It was shown
that our algorithms provided performance superior to the other methods in ordering probes
for evidence of SFPs.

1
CHAPTER 1.
General Introduction
Introduction:
Microarray technology has become an important tool in conducting biological research. It
provides simultaneous measurements for the abundance of thousands of mRNA transcripts in
multiple biological samples. These measurements are used to detect diﬀerentially expressed
genes over diﬀerent experimental conditions, time points, tissue samples, etc. Microarray ex-
periments allow scientists to understand gene functions and learn how genes work together
to carry out biological process. Based on the biological interest, microarray experiments are
designed in various ways and based on the design, diﬀerent statistical methods have been
proposed for identifying diﬀerentially expressed genes. When the experiments have complex
experimental designs that call for modeling of multiple sources of variation through the inclu-
sion of multiple random factors, the use of linear mixed models is one of the common choice
to make inference for each of thousands of genes. The motivation of this thesis is to provide
improvement over analyses of microarray data that use linear mixed model for each gene.
In a microarray experiment, one experimental design is used to obtain expression measures
for all genes. Traditional analysis method involves ﬁtting the same linear mixed model for each
gene, obtaining gene-speciﬁc p-values for the test of interest involving ﬁxed eﬀects and then
choosing a threshold for signiﬁcance that is intended to control False Discovery Rate (FDR) at
a desired level. The primary focus in this analysis is the inference for ﬁxed parameters. Such
inference depends on the correct choice of random factors in each linear mixed model. Even
though every gene shares the same experimental design, one or more random factors may aﬀect
the expression of only a subset of all measured genes. Then the standard practice of ﬁtting
the same full linear mixed model for all genes can result in failure to control FDR. Therefore

2
we propose a new method which combines results from the ﬁt of full and selected linear mixed
models to identify diﬀerentially expressed genes and provide FDR control at target levels when
the true underlying random eﬀects structure varies across genes.
Some biological problems require microarray experiments to have complex experimental de-
signs. The linear mixed model need to include multiple random factor to account for multiple
sources of variation. While large amounts of data on thousands of genes are collected in these
experiments, the sample size for each gene is usually small. When a classical gene-by-gene
mixed linear model analysis is conducted, there will be very few degrees of freedom to estimate
the variance components of all random factors considered in the model and low statistical
power for testing ﬁxed eﬀect(s) of interest. To address these challenges, it is common to use
Bayesian models, which borrows strength across genes in estimating the gene speciﬁc parame-
ters. One important requirement for this method to work properly is to choose the right prior
distribution to account for the shared information between genes on the same array. We pro-
pose a hierarchical Bayesian modeling strategy to account for important experimental factors
and complex correlation structure among the expression measurements for each gene. Instead
of classical prior choices for variance parameters, this model make use of the half-Cauchy priors
for the standard deviation parameters of the random factors with few eﬀects. We rank genes
with respect to evidence of diﬀerential expression across the levels of a factor of interest by
calculating a single summary statistic per gene from the posterior distribution of the ﬁxed
treatment eﬀects considered in the model. We showed that our hierarchical Bayesian approach
is much better than a traditional gene-by-gene mixed linear model analysis at distinguishing
diﬀerentially expressed genes from non-diﬀerentially expressed genes.
In many microarray experiments, high-density oligonucleotide arrays are often used for
measuring gene expression levels over diﬀerent experimental conditions, time points, tissue
samples. These arrays are also used for identifying possible DNA diﬀerences between genotypes,
which include single nucleotide polymorphisms (SNPs) and insertion/deletions polymorphisms
(IDPs) (Cui et al., 2005). Polymorphisms detected by a single probe in an oligonucleotide array
are called a single-feature polymorphism (SFPs), where a feature refers to a probe in the array

3
(Borevitz et al., 2003). The identiﬁcation of SFPs is important for producing more accurate
expression measurements when comparing samples of diﬀerent genotypes. Also, portions of
DNA that diﬀer between parental lines can serve as markers for tracking DNA inheritance
in oﬀspring. Therefore, there is need for new statistical methods to identify possible SFPs
between genotypes. We address this problem by introducing two new statistical algorithms
that make use of the linear mixed model analysis.
Finally, microarray experiments arise many challenging statistical problems, which moti-
vates statistician to search for more appropriate methods in microarray data analysis. By this
thesis, we provided an improvement over some current statistical analyses of microarray data
that use the linear mixed models.
Thesis Organization:
This thesis consists of an introduction, three research papers, and a conclusion.
The second chapter is a paper accepted by Biometrics for publication. It focuses on se-
lection of gene speciﬁc linear mixed models in microarray data analysis. The objective is to
provide an improvement over analyses of microarray data that use the same linear mixed model
for each gene. We proposed a two-step hybrid method for identifying diﬀerentially expressed
genes with linear mixed model analysis. We have shown that our method provides better rank-
ing with respect to evidence of diﬀerential expression across the levels of a factor of interest
and FDR control at target levels. We used a barley microarray experiment as a motivating
example.
The third chapter is an unpublished manuscript in which we present a hierarchical Bayesian
modeling strategy for microarray data analysis. When the classical gene-by-gene linear mixed
models cannot provide precise estimates of gene speciﬁc parameters due the small sample size
for each gene, our hierarchical Bayesian model borrows strength across genes in estimating
the gene speciﬁc parameters. We showed that with the right prior selection, the hierarchical
Bayesian approach is much better than a traditional gene-by-gene mixed linear model analysis
at distinguishing diﬀerentially expressed genes from non-diﬀerentially expressed genes.
The fourth chapter is also an unpublished manuscript which focuses on the identiﬁca-

4
tion of Single Feature Polymorphisms using Aﬀymetrix gene expression data. In microarray
data analysis, the identiﬁcation of SFPs is important for producing more accurate expression
measurements when comparing samples of diﬀerent genotypes. We summarized several SFP
discovery methods in the literature, and additionally, we introduced two new algorithms. The
performances of all methods were compared through two publicly available published data sets,
where truth about the sequence polymorphism is known for some “Gold Standard” probes. It
was shown that our algorithms provided performance superior to the other methods in ordering
probes for evidence of SFPs.
Chapter 5 provides a brief summary and general discussion.

5
CHAPTER 2.
Linear Mixed Model Selection for False Discovery Rate
Control in Microarray Data Analysis
A paper accepted by Biometrics
Cumhur Yusuf Demirkale, Dan Nettleton, and Tapabrata Maiti
Abstract: In a microarray experiment, one experimental design is used to obtain expression
measures for all genes. One popular analysis method involves ﬁtting the same linear mixed
model for each gene, obtaining gene-speciﬁc p-values for tests of interest involving ﬁxed eﬀects,
and then choosing a threshold for signiﬁcance that is intended to control False Discovery Rate
(FDR) at a desired level. When one or more random factors have zero variance components
for some genes, the standard practice of ﬁtting the same full linear mixed model for all genes
can result in failure to control FDR. We propose a new method which combines results from
the ﬁt of full and selected linear mixed models to identify diﬀerentially expressed genes and
provide FDR control at target levels when the true underlying random eﬀects structure varies
across genes.
KEY WORDS: Analysis of variance; Method of moments; Multiple testing; Restricted maxi-
mum likelihood; SAS; Variance component estimation.
2.1
Introduction
Microarray technology provides a means for simultaneously measuring the abundance of
thousands of mRNA transcripts in multiple biological samples. These measurements are used
to detect diﬀerentially expressed genes over diﬀerent experimental conditions, time points,

6
tissue samples, etc.
Many statistical methods for identifying diﬀerentially expressed genes
have been proposed in the statistics literature in recent years.
One popular strategy involves conducting a linear mixed model analysis for each of thou-
sands of genes. The basic approach was ﬁrst proposed by Wolﬁnger et al. (2001) and has been
applied in various forms by many researchers. The use of linear mixed modeling is convenient
because such models allow for a natural and principled accounting for multiple sources of vari-
ation. Because all the observations from a single microarray slide or chip share the same levels
of all factors in a microarray experiment, the same experimental design applies to every gene.
Thus, it is customary to ﬁt the same linear mixed model for each gene. The common model
is ﬁt separately to the data from each gene to allow model parameters to be gene-speciﬁc.
Tests for ﬁxed eﬀects of interest are carried out for each gene, and some correction for multiple
testing is employed to help focus attention on the most relevant results.
False Discovery Rate (FDR) has become the most common error measure to control or
estimate when declaring genes to be diﬀerentially expressed. FDR was ﬁrst introduced by
Benjamini and Hochberg (1995) and is formally deﬁned as E(Q) where Q is the proportion of
mistakenly rejected null hypotheses among all rejected null hypotheses or 0 if no hypotheses
are rejected. Among many other approaches, Storey and Tibshirani’s (2003) method for FDR
estimation has become a popular procedure that is less conservative than the original proposal
of Benjamini and Hochberg.
When applying linear mixed models in microarray analysis, inference for the ﬁxed param-
eters is the primary focus. Such inference depends on the correct choice of random factors in
each linear mixed model. Even though every gene shares the same experimental design, one or
more random factors may aﬀect the expression of only a subset of all measured genes. Thus,
an analysis that ﬁts the same linear mixed model for each gene may not provide correct ﬁxed
eﬀect inferences, and it may be important to consider strategies for selecting the most appro-
priate random factors on a gene-by-gene basis. Ideally, random factors with positive variance
should be retained while those with zero variance components should be excluded. Tests for
nonzero variance components could be used to identify relevant random factors. However,

7
available tests (e.g., Stram and Lee, 1994; Lin, 1997; Hall and Praestgaard, 2001) are only
valid asymptotically. As the sample size for each gene is usually small, application of these
tests to microarray data may be problematic.
A novel approach proposed by Chen and Dunson (2003) is to use a hierarchical Bayesian
model for random-eﬀects model selection, based on a decomposition of the covariance matrix of
the random-eﬀects distribution. The decomposition enables speciﬁcation of a prior distribution
that allocates positive probability to reduced models that exclude one or more random eﬀects
by setting their variances to zero. Although this method worked well for their simulated data,
the application of this method to a simulated data set mimicking microarray data described
in the next section was not successful, perhaps because of the limited per-gene sample sizes
typical in microarray experiments. Additionally, this method is computationally intensive so
that it is impractical to apply to each of thousands of genes in a microarray experiment.
Statistical analysts often use standard model selection measures such as Akaike’s informa-
tion criterion (AIC) or Bayesian information criterion (BIC) to compare models with diﬀerent
random components. Although using AIC or BIC to choose random factors may be asymp-
totically eﬀective, application of these methods to analysis of a small data set for each gene
from a microarray experiment may not be successful. In general for small data sets, these in-
formation criteria unfortunately often fail to identify the correct covariance structure (Gomez
et al. 2005). Furthermore, ﬁxed eﬀects testing following AIC or BIC model selection may not
lead to valid inferences. In particular, we demonstrate in Section 2.4 that FDR controlling
procedures can fail seriously when applied to p-values from tests of ﬁxed eﬀects from AIC- or
BIC-selected linear mixed models.
In this paper, we propose a two-step hybrid method for identifying diﬀerentially expressed
genes with linear mixed model analysis. Our method oﬀers an improvement over analyses of
microarray data that use the same linear mixed model for each gene. In the ﬁrst step, we ﬁt
a full model for each gene based on the design of the experiment and produce a traditional
ANOVA table. We construct F-tests for each ﬁxed factor of interest based on appropriate
ratios of mean squares to obtain a list of p-values (one for each gene) for any ﬁxed factor of

8
interest. Each list of p-values is used in conjunction with a standard FDR estimation procedure
to ﬁnd the number of genes to be declared as diﬀerentially expressed while controlling FDR
at a speciﬁed level. In the second step, a gene-speciﬁc model is determined by using BIC
to select the random part of the model among all random factors considered based on the
design of the experiment. An hypothesis test of a ﬁxed factor is performed by ﬁtting the BIC
favored model for each gene. Genes are ordered with respect to the p-values from this analysis.
A target level false discovery rate is achieved for this list by declaring the same number of
genes to be diﬀerentially expressed as identiﬁed in the ﬁrst step. Therefore, the new method
combines results from the ﬁt of full and selected linear mixed models to identify diﬀerentially
expressed genes and provides FDR control at target levels when the true underlying random
eﬀects structure varies across genes.
Our approach is motivated by several key observations that we note below and illustrate
in subsequent sections of this paper. First, the traditional ANOVA analysis described above
provides valid p-values as long as the true model is either the full linear mixed model or a
reduced linear mixed model that contains a subset of the factors in the full model. Second,
ﬁxed eﬀects inference following model selection is too liberal; i.e., estimated FDR levels tend
to be much lower than the actual FDR. Third, although model selection prior to ﬁxed eﬀects
inference leads to underestimation of FDR, the rank ordering of genes from most signiﬁcant
to least signiﬁcant that is produced by model selection prior to testing is superior to the rank
ordering produced by the traditional ANOVA analysis. Taken together, these observations
imply that our procedure will be superior to a traditional full-model ANOVA analysis with
regard to identiﬁcation of diﬀerentially expressed genes but will also control FDR. Thus, our
procedure maintains the most desirable features of full-model ANOVA analysis and analysis
following model selection.
2.2
Example: Gene Expression in Barley
Caldo, Nettleton and Wise (2004) conducted a microarray experiment to identify barley
genes that play a role in resistance to a fungal pathogen. To illustrate our methods, we describe

9
the analysis of a subset of the data they considered.
2.2.1
Data
Two genotypes of barley seedlings, one resistant and one susceptible to a fungal pathogen,
were grown in separate trays randomly positioned in a growth chamber. Each tray contained
six rows of 15 seedings each. The six rows in each tray were randomly assigned to six tissue
collection times: 0, 8, 16, 20, 24, and 32 hours after fungal inoculation. After simultaneously
inoculating plants with the pathogen, each row of plants was harvested at its randomly assigned
time. One Aﬀymetrix GeneChip was used to measure gene expression in the plant material
from a pool of the 15 seedlings in each row. The entire process was independently repeated
a total of three times, yielding data on 22,840 probe sets (corresponding to barley genes) for
each of the 36 GeneChips (two genotypes × six time points × three replications). The actual
experiment involved a third barley genotype as well as a second infection type, but we focus
on the reduced data set here to simplify the presentation of our main ideas. The expression
levels in the reduced data were log-transformed and median centered before an analysis was
performed.
2.2.2
Linear Mixed Model
The design of the experiment can be viewed as a split-plot with replications as blocks, trays
as whole plots and rows of seedlings within trays as split plots. Note that although time is
a factor in this experiment, this is not a repeated-measures design because no one plant or
pool of plants is measured at multiple time points. Instead, because the measurement process
is destructive, diﬀerent randomly selected plants are sampled at each time.
Therefore the
following linear mixed model corresponding to the split-plot design was considered as a base
model for each gene. Let
Yijk = µ + γj + τk + θjk + αi + βij + δik + ǫijk
(2.1)
i = 1, 2, 3; j = 1, 2; k = 1, . . . , 6;

10
where Yijk is the observed intensity of a gene at the kth harvesting time for the jth genotype
during the ith replication, γj is the ﬁxed genotype eﬀect, τk is the ﬁxed tissue collection time
eﬀect, θjk is the genotype-by-time interaction eﬀect, αi ∼NID(0, σ2
α) is the random replica-
tion eﬀect, βij ∼NID(0, σ2
β) is the replication-by-genotype interaction eﬀect (corresponding to
trays) , δik ∼NID(0, σ2
δ) is the replication-by-time interaction eﬀect, and ǫijk ∼NID(0, σ2
ǫ )
is the error (NID=Normally and Independently Distributed).
Though not standard for a
split-plot design, the replication-by-time interaction eﬀects were included to account for the
possibility of variation across harvest events; one random eﬀect was included for each combi-
nation of replication and time so that the two observations for the two samples (one of each
genotype) collected at any one time in any one replication were allowed to be correlated due to
the shared replication-by-time random eﬀect. All the random eﬀects are assumed to be jointly
independently distributed and to be independent of the residual errors.
For each gene, this linear mixed model was ﬁt to the 36 log-scale measures of expression
using the SAS PROC MIXED procedure. Scientists were interested in identifying barley genes
that play a role in resistance to the fungal pathogen. Such genes were expected to show patterns
of expression over time that diﬀered between the two genotypes. Therefore, the hypothesis
test for interaction between genotype and time was considered to be of primary importance
for each linear mixed model analysis, though tests for genotype main eﬀects and time main
eﬀects were conducted also. Restricted Maximum Likelihood (REML) was used to estimate
the variance components, and the Kenward-Roger (KR) method (Kenward and Roger, 1997)
was used to determine the denominator degrees of freedom and F-statistics for tests of ﬁxed
eﬀects. Applying the method of Storey and Tibshirani (2003) to obtain nominal control of
FDR at 1% yielded a total of 399, 13202, and 93 genes for the tests of genotype, time, and
interaction eﬀects, respectively.
For each of the 22,840 genes, SAS PROC MIXED also produced REML estimates of the
three variance components corresponding to three random factors. The variance component
estimate for replication, replication-by-genotype, and replication-by-time was reported as zero
for a total of 8153, 7824, and 7235 genes, respectively. For these genes, SAS PROC MIXED

11
with KR adjustment automatically ﬁts a reduced model that excludes random factors whose
variance component estimates are zero.
Thus, this common analysis strategy employs an
implicit gene-speciﬁc model selection step where random factors are selected for the model if
and only if their variance component estimates are positive. Considering the full model or
a reduced model may alter the result of any ﬁxed-eﬀect test substantially. In Section 4, we
investigate the impact of this and other model selection strategies on tests for ﬁxed-eﬀects
inference in linear mixed model analysis of microarray data when correct random structure
varies from gene to gene.
2.3
Candidate Analysis Methods
In this section, we describe ﬁve methods for conducting gene-by-gene linear mixed model
analysis of our microarray data set. Our list of methods is, of course, not exhaustive. However,
we have included what we believe are the ﬁve most obvious choices, and it is easy to generalize
our ﬁnal recommendation to incorporate other strategies. We ﬁrst list the ﬁve methods and
then provide some additional explanation of the methods before comparing them in a simulation
study in Section 4.
1. SKR: REML estimation of variance components with the KR method for conducting
ﬁxed-eﬀects inference.
2. SC: REML estimation of variance components with SAS’s containment method for con-
ducting ﬁxed-eﬀects inference.
3. SAIC: Selection of random factors according to Akaike’s Information Criterion (AIC)
followed by analysis of the selected model using REML estimation of variance components
with the KR method for conducting ﬁxed-eﬀects inference.
4. SBIC: Selection of random factors according to Schwarz’s Bayesian Information Criterion
(BIC) followed by analysis of the selected model using REML estimation of variance
components with the KR method for conducting ﬁxed-eﬀects inference.

12
5. ANOVA : Full model ﬁtting using the method of moments to estimate variance compo-
nents and F-test construction based on expected mean squares.
Note that, for our experimental design and tests, methods 1, 2, and 5 produce identical p-values
when all REML variance component estimates are positive. All ﬁve methods produce identical
p-values when all REML variance component estimates are positive and AIC and BIC each
select the full model.
2.3.1
Methods Involving Selection
The ﬁrst four methods have abbreviations that begin with S to indicate that some form
of model selection is employed. If there are q random factors, 2q candidate models can be
considered. According to the experimental design of the barley data set described in Section
2.1, three random factors were considered in the full model for each gene. Therefore we can
choose the best model for each gene among 23 = 8 models. For the SKR and SC approaches, the
model selection is simply carried out by removing random factors whose variance components
are estimated to be zero. The SKR approach was described in Section 2.2.2. The SC approach
diﬀers from SKR in that the denominator degrees of freedom used for testing genotype, time,
and genotype-by-time interaction are held constant at their full model values of 2, 10, and 10,
respectively, regardless of which variance components are estimated to be zero.
The SAIC and SBIC approaches use the standard model selection measures AIC and BIC
to choose random factors. For each of these models, AIC and BIC are calculated by SAS
PROC MIXED as
AIC = −2l + 2d
and
BIC = −2l + d log(n),
respectively, where l is the maximized log-likelihood (ML) or maximized restricted log-likelihood
(REML), d is the total number of parameters in the model (ML) or number of parameters in
the covariance structure (REML), and n equals the number of levels of the ﬁrst random factor
speciﬁed in the model. A model with smaller AIC or BIC is considered to be better. We used
the total number of observations per gene (36 in our data set) as n when using BIC to compare
models with diﬀerent random factors. We argue in Appendix A that this is preferable to the

13
SAS default which depends on the order that factors are listed in the RANDOM statement and
can lead to obviously poor model choices when leading factors have zero variance component
estimates.
Eight models were ﬁtted for each of 22,840 genes in the barley data set. AIC and BIC were
used to select random factors for each gene. The number of models favored by AIC and BIC
are reported in Table 2.1. For example, for 4277 genes, AIC chose a model whose random part
consisted of the replication random factor only, whereas BIC favored this same model for 3787
genes. Gomez et al. (2005) conducted a simulation study regarding the performance of AIC and
BIC in selecting the true covariance structure from a large set of repeated-measures covariance
structures. In Appendix A, we examine the eﬀectiveness of AIC and BIC covariance selection
in the context of our linear mixed model and present ﬁndings similar to those of Gomez et al.
(2005).
2.3.2
The ANOVA Approach
The ANOVA approach involves no model selection. The full model is ﬁt to every gene
regardless of variance component estimates or information criteria. The classical analysis of
variance (ANOVA) table is used to construct F-tests for the ﬁxed eﬀects of interest. The test
statistic for testing each ﬁxed factor is deﬁned by
F
=
SSFF /df1
SSRF /df2
,
(2.2)
where SSFF and df1 are the sum of square and degrees of freedom with respect to a ﬁxed
factor of interest, respectively, and SSRF and df2 are the sum of squares for the random
factor corresponding to the experimental units of the ﬁxed factor and its degrees of freedom,
respectively. The expected mean squares E(SSFF /df1) and E(SSRF /df2) are identical when
the null hypothesis is true.
Under the standard linear mixed model assumptions outlined
previously, the test statistic follows an F-distribution under the null hypothesis, even if one
or more true variance components are zero. Details for our model and tests are provided in
Web Appendix B. These ANOVA-based F-tests are easily obtained with SAS PROC MIXED
by setting METHOD=TYPE3.

14
2.4
Simulation Study
The power and type I error properties of tests of ﬁxed-eﬀects following random factor
selection are generally unknown and analytically intractable. Nonetheless, some type of data-
dependent model selection – either formal or informal – is commonly used by data analysts
when ﬁtting linear mixed models to individual data sets. Because microarray data analysis
involves thousands of such analyses, the impact of model selection on inferential properties
can be dramatic. In this section, we describe a large data-driven simulation study designed to
examine the performance of the methods described in Section 2.3.
2.4.1
Simulation Design
Fifty data sets, each containing 22,840 genes, were generated from versions of the linear
mixed model (1) described in Section 2.2.2. When simulating the data sets, we mimicked the
original barley data by generating a random eﬀects structure for each gene that matched the
random eﬀects structure of the model selected by AIC for that gene (see Table 2.1). The
selected random eﬀects were sampled independently from normal distributions with mean zero
and variance equal to the variance component estimate of the corresponding random factor.
Genotype, time, and genotype-by-time interaction eﬀects were set to zero for 90% of the genes
in each data set. For the other 10% of the genes in each data set, the observed gene-speciﬁc
means for each combination of genotype and time in the original barley data were added to
the normally distributed mean-zero random eﬀects to create non-null genotype, time, and
genotype-by-time interaction eﬀects for these genes.
The ﬁve methods described in Section 2.3 were used to analyze each of the 50 data sets.
One set of 22,840 p-values was produced for each combination of data set, method, and test
(genotype, time, or interaction) for a total of over 17 million p-values. More than 9 million
linear mixed model analyses were conducted because the SAIC and SBIC methods required
that 8 models be ﬁt to each data set and gene. Each set of 22,840 p-values was converted to
q-values using the method of Storey and Tibshirani (2003), and these q-values were used to
produce estimates of FDR for any signiﬁcance threshold.

15
2.4.2
Simulation Results
In this section, we describe the performance of our methods for the test of genotype-by-
time interaction which is of primary interest in our application. Analogous results, including
tables and ﬁgures, are presented for the test of genotype main eﬀects and time main eﬀects
in Appendix C. For the test of interaction, we begin with an examination of receiver oper-
ator characteristic (ROC) curves to compare the eﬀectiveness of the methods for separating
diﬀerentially and non-diﬀerentially expressed genes. The p-values produced by each method
provide a rank order of genes from most evidence for diﬀerential expression to least evidence.
The quality of the ranking varies from method to method and can be judged by comparing
ROC curves. The greater the area under an ROC curve the better the corresponding method
is at distinguishing null genes from non-null genes. The left panel of Figure 2.12.3 shows ROC
curves for the ﬁve methods averaged over the 50 simulated data sets. The patterns of the
curves and diﬀerences among the curves were quite similar for each simulation run so little in-
formation is lost by averaging. Diﬀerences among the curves are statistically signiﬁcant except
for the SAIC and SBIC comparison. For example, pointwise standard errors are approximately
0.001 or less at 1−speciﬁcity values of 0.005, 0.015, and 0.025; and simple sign tests for pair-
wise diﬀerences between the curves at these 1−speciﬁcity values yield signiﬁcance at below the
0.000001 level for all comparisons except SAIC vs. SBIC. Note also that we have plotted the
curves over only the most informative ranges of sensitivity and 1−speciﬁcity. The left panel of
the ﬁgure shows that an analysis with AIC or BIC selected models is slightly more eﬀective at
distinguishing non-null from null genes than the SKR approach. The SC approach lags behind
the SKR approach, and the ANOVA method is least eﬀective.
The ability to correctly rank genes with regard to evidence for diﬀerential expression is
clearly important because the goal of our analysis is to identify diﬀerentially expressed genes.
However, the eﬀectiveness of a method at ranking genes is not the only important measure
of performance. Good statistical procedures include an accurate assessment of the degree of
uncertainty associated with an analysis. In microarray analysis, it is common to produce a list
of diﬀerentially expressed genes and an estimated false discovery rate. The number of genes

16
placed on the list is often determined by the FDR level that a researcher is willing to tolerate.
Thus, we now investigate the FDR control properties of our ﬁve methods.
Using notation from the seminal FDR paper by Benjamini and Hochberg (1995), we let
V = the number of type I errors when the R tests with the smallest p-values are declared to
be non-null. Separately for each set of p-values, we recorded the actual false positive fraction
(V/R) and the estimated FDR level ( d
FDR given by the q-value for the Rth gene) for all values
of R from 1 to 22,840. We averaged the results for each method over the 50 data sets to
obtain the right panel of Figure 2.12.3. Again, the results for individual data sets were quite
consistent so that no important information was lost by averaging.
Ideally, the plotted curves would fall on or above the diagonal reference line to indicate
that the actual average false positive fraction (V/R) was no larger than the average estimated
FDR level. For all methods that involve some form of model selection, the estimated curves
fell substantially below the reference line. This indicates a clear problem with FDR control
for these methods. In contrast, the ANOVA approach produced FDR estimates that were on
average very close to the actual average false positive fraction. This is expected because the
ANOVA-based F-tests have the correct size as discussed in Appendix B.
The top portion of Table 2.2 further illustrates the error control properties of our proce-
dures. For each of the 50 data sets and each of the ﬁve methods discussed in Section 3, the
approach of Storey and Tibshirani (2003) was used to generate lists of signiﬁcant genes for
nominal FDR control at the 0.01 and 0.05 levels. The number of genes on each list and the
number of false positives on each list was recorded. The average V/R fraction and the average
number of genes on the list across the 50 data sets were computed. Although the ANOVA ap-
proach identiﬁed the fewest genes on average, it was the only procedure that provided control
of FDR at or below nominal levels. Note that the SKR and SAIC approaches had estimated
FDR levels (V/R) more than twice the nominal rate. Although not presented in Table 2.2, for
each of the 50 data sets, the false positive fraction was always higher than the nominal FDR
levels (0.01 and 0.05) for the ﬁrst four methods in the Table 2.2.
The results in this section present a challenging situation summarized as follows. Of the

17
ﬁve analysis methods, the one that is least eﬀective at distinguishing null from non-null tests
(ANOVA) is the only approach that appropriately controls type I error rate for each individual
test and the FDR for a family of tests. In the next section, we discuss a hybrid procedure that
combines the positive attributes of the testing procedures into a single approach that provides
good power for distinguishing null and non-null tests while controlling FDR.
2.5
Two-Stage Hybrid Method
2.5.1
Description
We propose a hybrid method which combines results from the ﬁt of full and selected linear
mixed models to identify diﬀerentially expressed genes and provide FDR control at target levels
when the true underlying random eﬀects structure varies across genes. The two-step procedure
can be described as follows:
1. For each gene, perform the ANOVA F-test of ﬁxed eﬀects. For any test of a ﬁxed factor of
interest, estimate FDR by using the method of Storey and Tibshirani (2003) or any other
method with similar FDR controlling properties. For a desired level of FDR, determine
D = the number of genes to be declared as diﬀerentially expressed.
2. For q possible random factors in the design of the experiment, ﬁt all 2q possible models
for each gene. Find the model with the lowest AIC or BIC value for each gene and obtain
the p-value for the test of interest from that model. Declare the D genes with the D
smallest p-values to be diﬀerentially expressed, where D is as determined in step 1.
Because both the AIC- and BIC-selected models better distinguish null and non-null genes
than the ANOVA approach, this hybrid method will have lower FDR and better power than
the ANOVA approach. Because the ANOVA approach appropriately controls FDR, the hybrid
will also control FDR – albeit at lower levels than nominal. We demonstrate these properties
via simulation in the next subsection.

18
2.5.2
Application to Simulated data
To illustrate the performance of the hybrid method in identifying diﬀerentially expressed
genes and providing FDR control at or below target levels, 50 microarray data sets were
generated. As described in Section 2.4, in each data set, the true underlying random eﬀects
structure varied across genes, and the data for 10% of the genes were simulated with non-zero
genotype, time, and interaction eﬀects.
We applied the hybrid method using AIC model selection in step 2 and also using BIC model
selection in step 2. We also considered the hybrid approach where the full model ﬁt with the
KR method and containment method were used in step 2 rather than either of the formal
model selection approaches. These methods are referred to as ANOVA-SAIC, ANOVA-SBIC,
ANOVA-SKR, and ANOVA-SC, respectively, in the results presented below. For brevity, we
report the results only for the test of interaction between genotype and time. Similar results
for the test of genotype and time are discussed in Appendix C.
As for the methods of Section 2.3, we calculated the length of the signiﬁcant gene list
and the true false positive fraction (V/R) associated with each of the gene lists for each
data set and averaged over the 50 data sets. The results are presented in the lower portion
of Table 2.2.
By comparison with the top portion of Table 2.2, we can see that each of
the two-step hybrid methods improved on the ANOVA approach by providing smaller false
positive fractions than the ANOVA approach. In practice, the hybrid approach will identify
the same number of genes as ANOVA but will tend to include more genes that are truly
diﬀerentially expressed than ANOVA alone.
Though our simulation results show that all
the hybrid methods provided FDR control at better than nominal levels, ANOVA-SAIC and
ANOVA-SBIC outperformed ANOVA-SKR and, especially, ANOVA-SC. Thus, we recommend
either ANOVA-SAIC or ANOVA-SBIC in practice.
2.5.3
Application of the Hybrid Method to the Barley Data
Scientists were interested in identifying barley genes that play a role in resistance to a
fungal pathogen. Such genes are believed to have patterns of expression over time following

19
infection that diﬀer between susceptible and resistant genotypes. Therefore, we are particularly
interested in identifying genes that exhibit interaction between genotype and time.
Table 2.3 shows the number of genes identiﬁed as diﬀerentially expressed at nominal FDR
levels of 0.01 and 0.05 using each of the nine methods that we have studied in this paper. The
gene lists produced by the recommended methods ANOVA-SAIC and ANOVA-SBIC diﬀered
from each other by 2 and 23 genes at nominal FDR of 0.01 and 0.05, respectively, and diﬀered
from the pure ANOVA approach by 17 and 86 genes (ANOVA-SAIC) and 15 and 89 genes
(ANOVA-SBIC). Either the ANOVA-SAIC gene lists or the ANOVA-SBIC gene lists would be
appropriate to use in practice. Although the ﬁrst four methods in Table 2.3 provided longer
gene lists, the simulations in Section 2.4 suggest that FDR levels will be higher than nominal
for these procedures.
2.6
Performance when ANOVA Tests are Not Exact
Although our proposed method is versatile and can be applied to data from many complex
experimental designs, the approach is not guaranteed to perform well when ANOVA-based
F-tests are not exact. An approximate F-test will not necessarily control type I error rates at
nominal levels, especially when sample sizes are small. If the type I error rate of an individual
test is not controlled, the usual FDR controlling procedures will fail in the multiple hypothesis
testing setting.
In practice, there are several situations in which ANOVA-based F-tests may fail to be ex-
act. Missing data or the presence of outlying observations are two related problems commonly
encountered in microarray analysis that can lead to non-exact tests. Due to the technological
challenges of measuring the expression of thousands of genes simultaneously in multiple sam-
ples, some outlying observations are inevitable. If such observations are included as part of the
data set, the error distribution tends to be heavy-tailed for at least some genes, and the usual
assumption of normally distributed errors becomes questionable. As an alternative, some data
analysts favor strategies that involve automated outlier detection and removal. The impact of
these often ad hoc strategies on the inferential properties of subsequent tests is unknown and

20
cannot be studied here. However, we have conducted additional simulation studies to assess
the eﬀect of either heavy-tailed errors or missing data on our proposed analysis strategies.
2.6.1
Assessing the Impact of Heavy-Tailed Errors
The simulation study described in Subsection 2.4.1 was repeated using scaled t-distributed
errors rather than normal errors. For each gene, the ǫijk terms in model (1) were obtained
by drawing 36 independent observations from a t distribution with ﬁve degrees of freedom.
These observations were then multiplied by the gene-speciﬁc error standard deviation that was
estimated from the original barley data. Other than a decrease in power for all methods, the
results were essentially the same as those discussed in Sections 2.4 and 2.5. In particular, for
the interaction test, the ANOVA approach controlled FDR at the 0.01 and 0.05 levels, the
methods involving selection were too liberal, and the hybrid approaches ANOVA-SAIC and
ANOVA-SBIC performed best overall. The complete results – including ﬁgures and tables
for the tests of genotype main eﬀects, time main eﬀects, and interaction – are provided in
Appendix D.
2.6.2
Assessing the Impact of Missing Data
Imbalance in data due to missing observations can make some ANOVA F-tests non-exact.
In our case, the test for interaction between genotype and time remains exact when data are
missing completely at random. In contrast, the ANOVA F-tests for genotype and time main
eﬀects become only approximate (unless data remain balanced following the loss of a complete
replication). To study the eﬀect of imbalance caused by missing data on ANOVA-based mixed
linear model analyses, we conducted two new variations of the simulation study described
in Subsection 4.1. In the ﬁrst version, three entire gene chips were randomly selected and
removed from the data set so that all genes were missing three of their 36 observations. In
the second version, four genotype-by-time combinations were randomly selected and two of the
three observations for each selected combination were randomly selected for removal from the
data set. This process was done separately for each gene. Thus, in the second version of the

21
simulation study, a random eight of the 36 observations were missing for each gene.
Table 2.4 presents results for the test of interaction between genotype and time when data
are missing. By comparison with Table 2.2, it is clear that all methods suﬀered a decrease
in power as the proportion of missing data increased. Also, the failure of the SKR, SAIC,
and SBIC methods to control FDR worsened as the proportion of missing data increased. In
contrast, the liberal bias of the SC method – although still clearly evident at the nominal
5% level – was reduced by missing data. The ANOVA method and all hybrid approaches
continued to control FDR at or below nominal levels. As in the case of no missing data, the
ANOVA-SAIC and ANOVA-SBIC methods provided the best performance among methods
that controlled FDR. However, note that when eight of the 36 observations were missing for
each gene, the ANOVA and hybrid approaches had almost no power to identify diﬀerentially
expressed genes. This is not surprising given that nearly one fourth of each data set was missing
and only two error degrees of freedom were available for nearly half the genes. Although the
ANOVA tests for genotype and time main eﬀects deﬁned in (2.2) are no longer exact when
data are missing, control of FDR below nominal levels was obtained for both of our missing
data scenarios. Complete results for the tests of genotype and time main eﬀects are provided
in Appendix D.
2.7
Concluding Remarks
We have focused on the speciﬁc problem of using linear mixed model analyses of microarray
data to control the false discovery rate when identifying diﬀerentially expressed genes. Our
main idea applies in greater generality.
Consider any multiple hypothesis testing problem
involving N tests where FDR control is desired. Consider two procedures (denoted P1 and P2)
for ranking the tests from most evidence against the null hypothesis to least evidence. Suppose
that it is possible to determine R1 = the number of tests according to P1 to declare non-null
so that FDR will be controlled at level α. By deﬁnition of FDR, this means that
E[V1(R1)/(R1 ∨1)] ≤α,
(2.3)

22
where Vk(r) denotes the number of true null hypotheses among the top r tests as ranked by
procedure Pk. Suppose that
E[V1(r)] ≥E[V2(r)] for all r = 1, . . . , N.
(2.4)
It is straightforward to show that (2.3) and (2.4) imply E[V2(R1)/(R1 ∨1)] ≤α. Thus, using
procedure P1 to determine the number of null hypotheses to reject while using procedure P2
to determine which null hypotheses to reject will control FDR and provide fewer type 2 errors
on average than using procedure P1 alone. In our case, we can choose ANOVA and SAIC (or
SBIC) approaches as P1 and P2, respectively, to obtain the desired performance characteristics
as illustrated through simulation in Section 2.4.
Although we have focused on obtaining correct ﬁxed-eﬀects inference rather than necessarily
identifying the correct random-eﬀects model, correct inference and correct model selection
are undeniably connected.
Tables 2.5 and 2.6 are contingency tables that give counts for
each combination of true and selected model for AIC and BIC selection, respectively, for
one simulated example data set. Both AIC and BIC selected the correct model for slightly
more than 50% of the genes (52.5% for AIC and 52.8% for BIC). This performance is typical
and consistent with the ﬁndings of Gomez et al. (2005). It is likely that other model selection
strategies (e.g., corrected AIC, Hurvich and Tsai, 1989) could improve the probability of correct
selection, but such methods will undoubtedly suﬀer from the type I error control problems that
we have documented for AIC and BIC selection.
Based on our simulation results in Sections 2.4 through 2.6, it is clear that our hybrid
procedure can be quite conservative in that actual FDR levels may be far below nominal. This
situation results because the operator characteristics of testing following model selection are
far superior to those of the ANOVA method alone. We are of the traditional opinion that an
error rate below nominal is preferred to an error rate above nominal. The ability to produce
error rates no larger than nominal is one hallmark of a good statistical testing procedure and
a feature that distinguishes statistical approaches from other approaches that oﬀer decisions
without assessments of the uncertainty associated with those decisions. Nonetheless, there is
room to improve the power of our proposed procedures, and we hope to address this issue in

23
future research.
2.8
References
Benjamini, Y., and Hochberg,Y. (1995). Controlling the false discovery Rate: a Practical and
Powerful Approach to Multiple Testing. Journal of the Royal Statistical Society, Series
B, 57, 289-300.
Caldo, R. A., Nettleton, D., Wise, R. P. (2004). Interaction-dependent gene expression in
Mla-speciﬁed response to barley powdery mildew. The Plant Cell., 16, 2514-2528.
Chen, Z., and Dunson, D.B.(2003). Random eﬀects selection in linear mixed models. Biometrics,
59, 762-769.
Gomez, E.V., Schaalje, G.B., and Fellingham, G.W. (2005). Performance of the Kenward-
Roger method when the covariance structure is selected using AIC and BIC. Communications
in Statistics — Simulation and Computation, 34, 377-392.
Hall, D.B. and Praestgaard, J.T. (2001).
Order-restricted score tests for homogeneity in
generalized linear and non-linear mixed models. Biometrika, 88, 739-751.
Hurvich, C.M. and Tsai, C.-L. (1989). Regression and time series model selection in small
samples. Biometrika, 76, 297-307.
Kenward, M. G. and Roger, J. H. (1997).
Small sample inference for ﬁxed eﬀects from
restricted likelihood. Biometrics, 53, 983-997.
Lin, X. (1997). Variance component testing in generalized linear models with random eﬀects.
Biometrika, 84, 309-326.
Storey, J.D., and Tibshirani, R. (2003). Statistical signiﬁcance for genomewide studies. Proc.
Natl. Acad. Sci. USA, 100, 9440-9445.
Stram, D.O. and Lee, J.W. (1994). Variance components testing in the longitudinal mixed
eﬀects model. Biometrics, 50, 1171-1177.

24
Wolﬁnger, R., Gibson, G.,Wolﬁnger, E., Bennett, L., Hamadeh, H., Bushel, P., Afshari, C.,
and Paules, R. (2001). Assessing Gene Signiﬁcance from cDNA Microarray Expression
Data via Mixed Models. Journal of Computational Biology, 8, 625-637.
2.9
Appendix A: Model Selection
2.9.1
BIC Formulation
Selection of the preferred model using BIC as computed by SAS can be problematic when
some variance components are estimated to be zero. For example, assume that a full mixed
linear model including d random factors is ﬁt to a data set. Suppose the variance component
of the ﬁrst random factor is estimated to be zero while all other variance components are
estimated to be positive. Then PROC MIXED will automatically ﬁt a reduced model that
excludes the ﬁrst random factor. SAS will correctly use d −1 as the number of parameters
in the REML likelihood but will inappropriately use the number of levels of the ﬁrst random
factor as n in BIC calculation even though this factor has been excluded from the model. If
we manually ﬁt the reduced model by omitting the ﬁrst random factor, all results are identical
to the results from the full model ﬁt except that the number of levels of the second random
factor in the full model will be used as n in BIC calculation. If the number of levels of second
random factor is greater than the number of levels of the ﬁrst random factor, the BIC that
SAS calculate for the full model will be lower than the BIC that SAS calculates for the reduced
model even though requesting the full model ﬁt in SAS actually results in the reduced model
ﬁt. An algorithm that would ﬁt all 2d mixed models would favor the full model over the reduced
model which excludes the ﬁrst random factor even though there is no evidence to support the
more complicated model. To avoid this problem, we calculated BIC using the total number of
observations per gene (36 in our data set) as n in the BIC formula.
2.9.2
AIC and BIC for Model Selection
We conducted a simulation study to explore AIC and BIC covariance selection in the setup
of the barley data design. A data set, containing 22,840 genes, was generated by following

25
the method described in Section 2.4. Eight models were ﬁt for each of 22,840 genes, and AIC
and BIC were each used to select a model for each gene. Both AIC and BIC selected the
correct model for slightly more than 50% of the genes (52.5% for AIC and 52.8% for BIC).
The following supplementary Tables 2.5 and 2.6 are contingency tables that give counts for
each combination of true and selected model for AIC and BIC selection, respectively.
2.10
Appendix B: Exact Inference Using ANOVA
2.10.1
Mixed Linear Model
Consider the mixed linear model described in Section 2.2.2
Yijk = µ + γj + τk + θjk + αi + βij + δik + ǫijk
(2.5)
i = 1, 2, 3; j = 1, 2; k = 1, . . . , 6.
where
• Yijk is the observed intensity of a gene at the kth harvesting time for the jth genotype
during the ith replication,
• γj is the ﬁxed genotype eﬀect,
• τk is the ﬁxed tissue collection time,
• θjk is the genotype-by-time interaction,
• αi is the random replication eﬀect, assume αi ∼NID(0, σ2
α),
• βij is the replication-by-genotype interaction, assume βij ∼NID(0, σ2
β),
• δik is the replication-by-time interaction, assume δik ∼NID(0, σ2
δ), and
• ǫijk ∼NID(0, σ2
ǫ ) is the error.
Hence Y ∼N(0, Σ) with

26
Σ =


V
0
0
0
V
0
0
0
V


V =


(σ2
δ + σ2
ǫ )I + (σ2
α + σ2
β)J
σ2
δI + σ2
αJ
σ2
δI + σ2
αJ
(σ2
δ + σ2
ǫ )I + (σ2
α + σ2
β)J


• where I is the 6 × 6 identity matrix and
• J equals the 6 × 6 matrix containing only ones.
2.10.2
ANOVA Construction of F-tests Based on Expected Mean Squares
For testing ﬁxed eﬀects, we can construct F tests from the ANOVA table (Table 2.7) by
taking the ratio of mean squares. For example, the F-statistic for testing the ﬁxed genotype
eﬀect is the ratio of the mean square for genotype and the mean square for replication-by-
genotype. Under the standard mixed linear model assumptions outlined previously, this test
statistic follows an F distribution even if the underlying true model for this gene is diﬀerent
from the full model. As an illustration, for three cases (underlying true models), we will show
that this is true. For other models, the same argument follows.
1. Assume that full model was the true model for the data, i.e., σ2
α > 0, σ2
β > 0, and
σ2
δ > 0.
• Hypothesis Test for fixed genotype effect: The null hypothesis is
H0 : γ1 + 1
K
X
k
θ1k = γ2 + 1
K
X
k
θ2k
(2.6)
and based on the ANOVA table above, the test statistic is the ratio of two mean squares
such that
F1
=
MSgeno
MSrep−geno
=
IK P
j(Y .j. −Y ...)2/(J −1)
K P
i
P
j(Y ij. −Y i.. −Y .j. + Y ...)2/(I −1)(J −1)
=
Y T A1Y/(J −1)
Y T A2Y/(I −1)(J −1)
(2.7)

27
where
A1 = 1
36


J
−J
J
−J
J
−J
−J
J
−J
J
−J
J
J
−J
J
−J
J
−J
−J
J
−J
J
−J
J
J
−J
J
−J
J
−J
−J
J
−J
J
−J
J


,
A2 = 1
36


2J
−2J
−J
J
−J
J
−2J
2J
J
−J
J
−J
−J
J
2J
−2J
−J
J
J
−J
−2J
2J
J
−J
−J
J
−J
J
2J
−2J
J
−J
J
−J
−2J
2J


and A1A1 = A1, A2A2 = A2, A1A2 = 0.
A1Σ = (σ2
ǫ + 6σ2
β)A1 and A2Σ = (σ2
ǫ + 6σ2
β)A2
Then Y T A1Y/(σ2
ǫ + 6σ2
β) ∼χ2
(J−1) and Y T A2Y/(σ2
ǫ + 6σ2
β) ∼χ2
(I−1)(J−1) and
A1ΣA2 = (σ2
ǫ + 6σ2
β)A1A2 = 0. Hence Y T A1Y and Y T A2Y are independent.
Hence, F1 ∼F(J−1),(I−1)(J−1).
• Hypothesis Test for fixed time effect: The null hypothesis is,
H0 : τ1 + 1
J
X
j
θj1 = τ2 + 1
J
X
j
θj2 = . . . = τK + 1
J
X
j
θK1
(2.8)
and based on the ANOVA table, the test statistic is expressed as,
F2
=
MStime
MSrep−time
=
IJ P
k(Y ..k −Y ..)2/(K −1)
I P
j
P
k(Y .jk −Y .j. −Y ..k + Y ...)2/(I −1)(K −1)

28
=
Y T A3Y/(K −1)
Y T A4Y/(I −1)(K −1)
(2.9)
where
A3 = 1
36


6I −J
· · ·
6I −J
...
...
...
6I −J
· · ·
6I −J


and
A4 = 1
36


2(6I −J)
2(6I −J)
−(6I −J)
−(6I −J)
−(6I −J)
−(6I −J)
2(6I −J)
2(6I −J)
−(6I −J)
−(6I −J)
−(6I −J)
−(6I −J)
−(6I −J)
−(6I −J)
2(6I −J)
2(6I −J)
−(6I −J)
−(6I −J)
−(6I −J)
−(6I −J)
2(6I −J)
2(6I −J)
−(6I −J)
−(6I −J)
−(6I −J)
−(6I −J)
−(6I −J)
−(6I −J)
2(6I −J)
2(6I −J)
−(6I −J)
−(6I −J)
−(6I −J)
−(6I −J)
2(6I −J)
2(6I −J)


and A3A3 = A3, A4A4 = A4, and A3A4 = 0.
A3Σ = (σ2
ǫ + 2σ2
δ)A3 and A4Σ = (σ2
ǫ + 2σ2
δ)A4
Then Y T A3Y/(σ2
ǫ + 2σ2
δ) ∼χ2
(K−1) and Y T A4Y/(σ2
ǫ + 2σ2
δ) ∼χ2
(I−1)(K−1) and
A3ΣA4 = (σ2
ǫ + 2σ2
δ)A3A4 = 0. Hence Y T A3Y and Y T A4Y are independent.
Hence, F2 ∼F(K−1),(I−1)(K−1).
• Hypothesis Test for the interaction between genotype and time:
The null hypothesis is,
H0 : θ1k −θ2k −θ1l + θ2l = 0, k ̸= l = 1, . . . , 6.
(2.10)

29
and based on the ANOVA table, the test statistic follows as,
F3
=
MSgeno−time
MSE
= I P
j
P
k(Y .jk −Y .j. −Y ..k + Y ...)2/(J −1)(K −1)
MSE
=
Y T A5Y/(J −1)(K −1)
Y T A6Y/(I −1)(J −1)(K −1)
(2.11)
where
A5 = 1
36


(6I −J)
−(6I −J)
(6I −J)
−(6I −J)
(6I −J)
−(6I −J)
−(6I −J)
(6I −J)
−(6I −J)
(6I −J)
−(6I −J)
(6I −J)
(6I −J)
−(6I −J)
(6I −J)
−(6I −J)
(6I −J)
−(6I −J)
−(6I −J)
(6I −J)
−(6I −J)
(6I −J)
−(6I −J)
(6I −J)
(6I −J)
−(6I −J)
(6I −J)
−(6I −J)
(6I −J)
−(6I −J)
−(6I −J)
(6I −J)
−(6I −J)
(6I −J)
−(6I −J)
(6I −J)


and A6 =
1
36


2(6I −J)
−2(6I −J)
−(6I −J)
(6I −J)
−(6I −J)
(6I −J)
−2(6I −J)
2(6I −J)
(6I −J)
−(6I −J)
(6I −J)
−(6I −J)
−(6I −J)
(6I −J)
2(6I −J)
−2(6I −J)
−(6I −J)
(6I −J)
(6I −J)
−(6I −J)
−2(6I −J)
2(6I −J)
(6I −J)
−(6I −J)
−(6I −J)
(6I −J)
−(6I −J)
(6I −J)
2(6I −J)
−2(6I −J)
(6I −J)
−(6I −J)
(6I −J)
−(6I −J)
−2(6I −J)
2(6I −J)


and A5A5 = A5, A6A6 = A6, A5A6 = 0.
A5Σ = σ2
ǫ A5 and A6Σ = σ2
ǫ A6
Then Y T A5Y/σ2
ǫ ∼χ2
(J−1)(K−1) and Y T A6Y/σ2
ǫ ∼χ2
(I−1)(J−1)(K−1) and
A5ΣA6 = σ2
ǫ A5A6 = 0. Hence Y T A5Y and Y T A6Y are independent.
Hence, F3 ∼F(J−1)(K−1),(I−1)(J−1)(K−1).
2. Assume that none of the random eﬀects is present in the model, i.e., σ2
α = 0, σ2
β = 0, and
σ2
δ = 0.

30
The full model from (1) will reduce to
Yijk = µ + γj + τk + θjk + ǫijk
and the variance-covariance matrix will be,
Σ1 = σ2
ǫ I
where I is the 36 × 36 identity matrix.
• Hypothesis Test for fixed genotype effect: The null hypothesis is the same as
(2) and the test statistic is the same as (3). It is suﬃcient to show
A1
(σ2ǫ + 6σ2
β)Σ1 = A1
σ2ǫ
σ2
ǫ I = A1,
A2
(σ2ǫ + 6σ2
β)Σ1 = A2
σ2ǫ
σ2
ǫ I = A2,
and A1 and A2 are idempotent. Then,
Y T A1Y/(σ2
ǫ + 6σ2
β) ∼χ2
(J−1) and Y T A2Y/(σ2
ǫ + 6σ2
β) ∼χ2
(I−1)(J−1) and
A1Σ1A2 = σ2
ǫ A1A2 = 0. Hence Y T A1Y and Y T A2Y are independent.
Hence, F1 ∼F(J−1),(I−1)(J−1).
• Hypothesis Test for fixed time effect: The null hypothesis is the same as (4)
and the test statistic is the same as (5). It is suﬃcient to show
A3
(σ2ǫ + 2σ2
δ)Σ1 = A3
σ2ǫ
σ2
ǫ I = A3,
A4
(σ2ǫ + 2σ2
δ)Σ1 = A4
σ2ǫ
σ2
ǫ I = A4,
and A3 and A4 are idempotent. Then,

31
Y T A3Y/(σ2
ǫ + 2σ2
δ) ∼χ2
(K−1) and Y T A4Y/(σ2
ǫ + 2σ2
δ) ∼χ2
(I−1)(K−1) and
A3Σ1A4 = σ2
ǫ A3A4 = 0. Hence Y T A3Y and Y T A4Y are independent.
Hence, F2 ∼F(K−1),(I−1)(K−1).
• Hypothesis Test for the interaction between genotype and time: The null
hypothesis is the same as (6) and the test statistic is the same as (7). It is suﬃcient to
show
A5
σ2ǫ
Σ1 = A5
σ2ǫ
σ2
ǫ I = A5,
A6
σ2ǫ
Σ1 = A6
σ2ǫ
σ2
ǫ I = A6,
and A5 and A6 are idempotent. Then,
Y T A5Y/σ2
ǫ ∼χ2
(J−1)(K−1) and Y T A6Y/σ2
ǫ ∼χ2
(I−1)(J−1)(K−1) and
A5Σ1A6 = σ2
ǫ A5A6 = 0. Hence Y T A5Y and Y T A6Y are independent.
Hence, F3 ∼F(J−1)(K−1),(I−1)(J−1)(K−1).
3.
Assume that replication and replication-by-genotype random eﬀects are present in the
model but no replication-by-time, i.e., σ2
α > 0, σ2
β > 0, and σ2
δ = 0.
The full model from (1) will reduce to
Yijk = µ + γj + τk + θjk + αi + βij + ǫijk
and the variance-covariance matrix will be,
Σ5 =


V5
0
0
0
V5
0
0
0
V5



32
V5 =


σ2
ǫ I + (σ2
α + σ2
β)J
σ2
αJ
σ2
αJ
σ2
ǫ I + (σ2
α + σ2
β)J


• Hypothesis Test for fixed genotype effect: The null hypothesis is the same as
(2) and the test statistic is the same as (3). It can be shown that
A1
(σ2ǫ + 6σ2
β)Σ5 = A1,
A2
(σ2ǫ + 6σ2
β)Σ5 = A2.
and A1 and A2 are idempotent. Then,
Y T A1Y/(σ2
ǫ + 6σ2
β) ∼χ2
(J−1) and Y T A2Y/(σ2
ǫ + 6σ2
β) ∼χ2
(I−1)(J−1) and
A1Σ5A2 = (σ2
ǫ + 6σ2
β)A1A2 = 0. Hence Y T A1Y and Y T A2Y are independent.
Hence, F1 ∼F(J−1),(I−1)(J−1).
• Hypothesis Test for fixed time effect: The null hypothesis is the same as (4)
and the test statistic is the same as (5). It can be shown that
A3
(σ2ǫ + 2σ2
δ)Σ5 = A3,
A4
(σ2ǫ + 2σ2
δ)Σ5 = A4.
and A3 and A4 are idempotent. Then,
Y T A3Y/(σ2
ǫ + 2σ2
δ) ∼χ2
(K−1) and Y T A4Y/(σ2
ǫ + 2σ2
δ) ∼χ2
(I−1)(K−1) and

33
A3Σ5A4 = σ2
ǫ A3A4 = 0. Hence Y T A3Y and Y T A4Y are independent.
Hence, F2 ∼F(K−1),(I−1)(K−1).
• Hypothesis Test for the interaction between genotype and time: The null
hypothesis is the same as (6) and the test statistic is the same as (7). It can be shown
that
A5
σ2ǫ
Σ5 = A5,
A6
σ2ǫ
Σ5 = A6.
and A5 and A6 are idempotent. Then,
Y T A5Y/σ2
ǫ ∼χ2
(J−1)(K−1) and Y T A6Y/σ2
ǫ ∼χ2
(I−1)(J−1)(K−1) and
A5Σ5A6 = σ2
ǫ A5A6 = 0. Hence Y T A5Y and Y T A6Y are independent.
Hence, F3 ∼F(J−1)(K−1),(I−1)(J−1)(K−1).
2.11
Appendix C: Tests for Main Eﬀects
In this supplementary section, we describe the performance of our methods for the test of
genotype main eﬀects and time main eﬀects. As stated in the main paper, the scientists were
interested in identifying genes that exhibit interaction between genotype and time. Therefore
the test for interaction between genotype and time was considered to be of primary importance
for each mixed linear model analysis, though tests for genotype main eﬀects and time main
eﬀects were conducted also. Note, however, that the test for genotype main eﬀects has only
2 denominator degrees of freedom in the full model and thus will have low power. The test
for time main eﬀects, on the other hand, is based on 10 degrees of freedom in the full model.
Furthermore, many genes are expected to undergo substantial changes in expression over the

34
time period spanning more than 24 hours because of circadian rhythms and extreme changes
associated with the transition from light to dark and back. Such changes were not the focus
of this experiment, but we present the results here for the sake of completeness and comment
on the similarities and diﬀerences between our conclusions for the interaction test and our
conclusions for the tests of main eﬀects.
2.11.1
The Test of Genotype Main Eﬀects
For the test of genotype main eﬀects, we begin with examination of receiver operator char-
acteristic (ROC) curves to compare the eﬀectiveness of the methods for separating diﬀerentially
and non-diﬀerentially expressed genes. The p-values produced by each method provide a rank
order of genes from most evidence for diﬀerential expression to least evidence. The quality of
the ranking varies from method to method and can be judged by comparing ROC curves. The
greater the area under an ROC curve the better the corresponding method is at distinguishing
null genes from non-null genes. The left panels of Figure 2.12.3 show ROC curves for the ﬁve
methods averaged over the 50 simulated data sets. The pattern of the curves was quite similar
for each simulation run so little information is lost in averaging. Note also that we have plotted
the curves over only the most informative ranges of sensitivity and 1−speciﬁcity. Unlike the
interaction test, the ﬁgure shows that the SC approach is as eﬀective as an analysis with AIC
or BIC selected models at distinguishing non-null from null genes for the genotype eﬀect. The
SKR approach lags behind the SAIC and SBIC, and the ANOVA method is least eﬀective.
The ability to correctly rank genes with regard to evidence for diﬀerential expression is
clearly important because the goal of our analysis is to identify diﬀerentially expressed genes.
However, the eﬀectiveness of a method at ranking the genes is not the only important measure
of performance. Good statistical procedures include an accurate assessment of the degree of
uncertainty associated with an analysis. In microarray data analysis, it is common to produce
a list of diﬀerentially expressed genes and an estimated false discovery rate. The number of
genes placed on the list is often determined by the FDR level that a researcher is willing to
tolerate. Thus, we now investigate the FDR control properties of our ﬁve methods.

35
Using notation from the seminal FDR paper by Benjamini and Hochberg (1995), we let
V = the number of type I errors when the R tests with the smallest p-values are declared to
be non-null. Separately for each set of p-values, we recorded the actual false positive fraction
(V/R) and the estimated FDR level ( d
FDR given by the q-value for the Rth gene) for all values
of R from 1 to 22,840. We averaged the results for each method over the 50 data sets to obtain
the panels on the right side of Figure 2.12.3. Again, the results for individual data sets were
quite consistent so that no important information is lost by averaging.
Ideally, the plotted curves would fall on or above the diagonal reference line to indicate that
the actual average false positive fraction (V/R) was no larger than the average estimated FDR
level. The analysis by ﬁtting the same model under containment method (SC) produced FDR
estimates almost around 1 for any number of genes declared to be signiﬁcant. This approach
is extremely conservative and would provide little if any power for identifying diﬀerentially
expressed genes under our simulation settings.
Table 2.8 further illustrates the error control properties of our procedures. For each of
the 50 data sets and each method, the approach of Storey and Tibshirani (2003) was used
to generate lists of signiﬁcant genes for nominal FDR control at the 0.1 and 0.2 levels. The
number of genes on each list and the number of false positives on each list was recorded. The
average V/R ratio and the average count of the number of genes on the list across the 50
data sets was computed. Since the FDR control under SC approach is very conservative, we
could not declare any genotype main eﬀects signiﬁcant at these FDR levels. Although the
ANOVA approach identiﬁed very few genes on average, it was the only procedure (besides
the SC approach) that provided control of FDR at or below nominal levels. Note that other
methods, involving some form of model selection, had estimated FDR levels (V/R) far more
than the nominal rate. Although not presented in Table 2.8, for each of the 50 data sets, the
false positive fraction was always higher than the nominal FDR levels (0.1 and 0.2) for the
SKR, SAIC and SBIC approaches.
The 50 simulated microarray data sets were also used to illustrate the performance of two-
stage hybrid method in identifying diﬀerentially expressed genes and providing FDR control

36
at or below target levels. As described in Section 2.4 of the main paper, in each data set, the
true underlying random eﬀects structure varies across genes, and the data for ten percent of
the genes were simulated with non zero genotype, time, and interaction eﬀects.
We applied the two-stage hybrid method using AIC model selection in step 2 and also using
BIC model selection in step 2. We also considered the hybrid approach where the full model ﬁt
with KR method and containment method were used in step 2 rather than either of the formal
model selection approaches. These methods are referred to as ANOVA-SAIC, ANOVA-SBIC,
ANOVA-SKR, and ANOVA-SC, respectively. For these methods, we calculated the length of
the signiﬁcant gene list and the actual false positive fraction (V/R) associated with each of the
gene lists for each data set and averaged over the 50 data sets. The results are also presented
in Table 2.8. The table shows that each of the two-step hybrid methods improved on the
ANOVA approach by providing smaller false positive ratios than the ANOVA approach. In
practice, the hybrid approach will identify the same number of genes as ANOVA. Therefore,
for genotype main eﬀects, all the methods declared only very few genes to be diﬀerentially
expressed. This illustrates the importance of additional replication whenever genotype main
eﬀects are of scientiﬁc interest.
2.11.2
The Test of Time Main Eﬀects
For the test of time main eﬀects, we also begin with examination of ROC curves to compare
the eﬀectiveness of the methods for separating diﬀerentially and non-diﬀerentially expressed
genes. The panels on the left side of the Figure 2.12.3 show ROC curves for the ﬁve methods
averaged over the 50 simulated data sets. The pattern of the curves was quite similar for each
simulation run so little information is lost in averaging. Note also that we have plotted the
curves over only the most informative ranges of sensitivity and 1−speciﬁcity. Similar to ROC
panels in Figure 2.12.3, ROC panels in Figure 2.12.3 show that an analysis with AIC or BIC
selected models is as eﬀective as the SC approach at distinguishing non-null from null genes.
The SKR approach lags behind the SC approach, and the ANOVA method is least eﬀective.
We also investigated the FDR control properties of our ﬁve methods when testing for the

37
time eﬀects. We averaged the results for each method over the 50 data sets to obtain the
panels on the right side of the Figure 2.12.3. Again, the results for individual data sets were
quite consistent so that no important information is lost by averaging. The analysis where
the full model ﬁt with KR method and containment method produced FDR estimates above
the reference line. For other methods that involve some form of formal model selection (AIC
or BIC), the estimated curves fell below the reference line. This indicates a clear problem
with FDR control for these methods. In contrast, the ANOVA approach still produces FDR
estimates that are on average close to the actual average false positive fraction.
Table 2.9 further illustrates the error control properties of our procedures. For each of
the 50 data sets and each method, the approach of Storey and Tibshirani (2003) was used to
generate lists of signiﬁcant genes for nominal FDR control at the 0.01 and 0.05 levels. The
number of genes on each list and the number of false positives on each list was recorded. The
average V/R fraction and the average count of the number of genes on the list across the 50
data sets was computed. When 10% or 20% of genes are non-null, SKR and SC approaches
had estimated FDR levels (V/R) lower than the nominal rate, and of those two methods, SKR
was most powerful. Note that SAIC and SBIC approaches had estimated FDR levels far more
than the nominal rate. Again, the ANOVA approach provided control of FDR at the nominal
levels. However, the ANOVA approach was less powerful than SKR, which also appropriately
controlled FDR in this case. Thus, for the test of time main eﬀects, the SKR procedure can
be recommended.
In Table 2.9, we also summarize the performance of two-stage hybrid method in identifying
diﬀerentially expressed genes and providing FDR control at or below target levels. All of the
two-step hybrid methods improved on the ANOVA approach by providing smaller false positive
ratios than the ANOVA approach. In practice, the hybrid approach will identify the same
number of genes as ANOVA but will tend to include more genes that are truly diﬀerentially
expressed than ANOVA alone. Though our simulation results show that all the hybrid methods
provided FDR control at better than nominal levels, ANOVA-SC outperformed other two-step
hybrid methods.

38
In conclusion, we note that the ANOVA-SAIC and ANOVA-SBIC approaches recommended
for the test of interaction are also appropriate for the tests of genotype main eﬀects and time
main eﬀects. For the test of time main eﬀects, however, the SKR method also controlled FDR
at nominal levels and provided longer gene lists than our hybrid procedures. Of the hybrid
procedures, ANOVA-SC incurred fewer type I errors than the other hybrids for the time test,
though the performance was quite similar to ANOVA-SAIC and ANOVA-SBIC.
2.12
Appendix D: Additional Simulation Studies
To assess the performance of our proposed analysis strategies under diﬀerent scenarios, we
conducted additional simulation studies. In the ﬁrst additional simulation study, we examine
the eﬀect of the proportion of non-null genes. In the second addional simulation study, we
assess the eﬀect of the heavy-tailed errors. And in the last additional simulation study, we
examine the eﬀect of imbalance caused by missing data on ANOVA-based mixed linear model
analyses.
2.12.1
Assessing the Impact of Percentage of Non-null Genes in the Data
We repeated the simulation study described in Subsection 2.4.1 of the main paper under
two new scenarios. In the ﬁrst case, we let only 1% of the genes in each of the 50 data sets
to have non-zero genotype, time, and interaction eﬀects. In the second case, we increased the
portion of non-null genes from 1% to 20% in each data set.
The results of the simulation with diﬀerent proportion of non-null genes – presented in Fig-
ures 2.12.3 through 2.12.3 and Tables 2.8 through 2.10 – show that the bottom-line conclusions
do not diﬀer in a practically important way from the case of 10% of the genes are non-null.
For instance, consider the test of interacton between genotype and time. The top portion –
refering to 1% non-null genes – and the bottom portion – refering to 20% non-null genes – in
Table 2.10 provide similar conclusions as the middle portion – refering to 10% non-null genes
– of that table. The ANOVA approach identiﬁed the fewest genes on average, and it was the
only procedure that provided control of FDR at or below nominal levels. The SKR and SAIC

39
approaches had estimated FDR levels more than twice the nominal rate. The performance of
our hybrid procedure remains essentially the same for the new simulations. Portions – refering
to 1% and 20 % non-null genes – summarizing the performance of hybrid methods in Table 2.10
provide similar conclusions as the portion corresponding to 10% of genes were non-null. These
tables show that each of the two-step hybrid methods improved on the ANOVA approach by
providing smaller false positive fractions than the ANOVA approach. All the hybrid methods
provided FDR control at better than nominal levels, ANOVA-SAIC and ANOVA-SBIC out-
performed ANOVA-SKR and, especially, ANOVA-SC. Thus, the conclusions of the simulation
study in the main paper do not appear to be sensitive to the proportion of non-null genes.
2.12.2
Assessing the Impact of Heavy-Tailed Errors
As mentioned in Subsection 2.6.1 of the main paper, the simulation study described in
Subsection 2.4.1 of the main paper was repeated using scaled t-distributed errors rather than
normal errors.
For each gene, the ǫijk terms in model (2.1) were obtained by drawing 36
independent observations from a t distribution with ﬁve degrees of freedom. These observations
were then multiplied by the gene-speciﬁc error standard deviation that was estimated from the
original barley data.
The results of the simulation based on t-distributed errors – presented in Figures 2.12.3
through 2.12.3 and Tables 2.11 through 2.13 – show that, other than a decrease in power for
all methods, the bottom-line conclusions do not diﬀer in a practically important way from the
case of normal errors. Our proposed model selection/ANOVA hybrid method still provides
conservative estimates of the false discovery rate while methods based on model selection
approaches alone are too liberal.
2.12.3
Assessing the Impact of Missing Data
As discussed in Subsection 2.6.2 of the main paper, we conducted two new variations of
the simulation study to examine the eﬀect of imbalance caused by missing data on ANOVA-
based mixed linear model analyses described in Subsection 2.4.1 of the main paper. In the ﬁrst

40
version, three entire gene chips were randomly selected and removed from the data set so that
all genes were missing three of their 36 observations. In the second version, four genotype-by-
time combinations were randomly selected and two of the three observations for each selected
combination were randomly selected for removal from the data set. This process was done
separately for each gene. Thus, in the second version of the simulation study, a random eight
of the 36 observations were missing for each gene. The results of the simulation with missing
data are presented in Figures 2.12.3 through 2.12.3 and Tables 2.14 through 2.16.

41
Table 2.1
AIC and BIC selected models for the Barley Data Set.
none=model involving no random factor, r=model involving
random replication factor, rg=model involving random repli-
cation-by-genotype factor, rt=model involving random replica-
tion-by-time factor.
Random factor
none
r
rg
rt
r, rg
r, rt
rg, rt
r, rg, rt
AIC count
8407
4277
5253
2001
38
671
2133
60
BIC count
11409
3787
4928
1449
1
219
1047
0
Table 2.2
Genotype-by-time Interaction Test: Results for the Complete
Data. The average false positive fraction (V/R) and the average
number of signiﬁcant genes (R) for nominal control of FDR at the
0.01 and 0.05 levels over 50 simulated data sets for ﬁve methods
described in Section 3 and the hybrid methods introduced in
Section 5. V is the number of false positives and R is the number
of rejected null hypotheses.
d
FDR=0.01
d
FDR=0.05
Method
V/R
(S.E.)
R
(S.E.)
V/R
(S.E.)
R
(S.E.)
SKR
0.0255 (0.0010)
435.8 (3.3)
0.1186 (0.0018)
685.8 (5.1)
SC
0.0142 (0.0009)
295.0 (2.6)
0.0739 (0.0015)
512.9 (3.7)
SAIC
0.0237 (0.0009)
465.8 (3.3)
0.1021 (0.0017)
673.2 (4.1)
SBIC
0.0198 (0.0008)
447.1 (3.1)
0.0810 (0.0016)
625.2 (3.9)
ANOVA
0.0088 (0.0008)
229.4 (2.4)
0.0486 (0.0016)
393.6 (2.8)
ANOVA-SKR
0.0013 (0.0004)
229.4 (2.4)
0.0159 (0.0009)
393.6 (2.8)
ANOVA-SC
0.0058 (0.0008)
229.4 (2.4)
0.0351 (0.0014)
393.6 (2.8)
ANOVA-SAIC
0.0002 (0.0001)
229.4 (2.4)
0.0094 (0.0007)
393.6 (2.8)
ANOVA-SBIC
0.0002 (0.0001)
229.4 (2.4)
0.0101 (0.0007)
393.6 (2.8)

42
Table 2.3
Application of the Hybrid Method to the Barley Data Set. The
number of barley genes identiﬁed as diﬀerentially expressed at
nominal FDR levels of 0.01 and 0.05 for the test of interaction
under the ﬁve standard methods and the four hybrid methods.
d
FDR
0.01
0.05
SKR
93
933
SC
52
598
SAIC
96
598
SBIC
75
438
ANOVA
37
311
ANOVA-SKR
37
311
ANOVA-SC
37
311
ANOVA-SAIC
37
311
ANOVA-SBIC
37
311

43
Table 2.4
Genotype-by-time Interaction Test:
Results for the Missing
Data. Performance of the methods when three entire microar-
ray chips are missing or eight observations per gene are missing.
Table values are average false positive fraction (V/R) and the
average number of signiﬁcant genes (R) for nominal control of
FDR at the 0.01 and 0.05 levels over 50 simulated data sets,
where V = the number of type I errors when R tests with the
smallest p-values are declared to be non-null.
d
FDR=0.01
d
FDR=0.05
Method
V/R
(S.E.)
R
(S.E.)
V/R
(S.E.)
R
(S.E.)
SKR
0.0263 (0.0012)
335.5 (3.8)
0.1256 (0.0021)
574.6 (5.6)
SC
0.0122 (0.0016)
111.4 (3.4)
0.0651 (0.0021)
294.4 (5.1)
Missing
SAIC
0.0266 (0.0011)
388.8 (3.6)
0.1165 (0.0020)
599.2 (5.1)
three
SBIC
0.0225 (0.0010)
373.1 (3.5)
0.0956 (0.0017)
555.4 (4.7)
entire
ANOVA
0.0091 (0.0019)
57.9 (2.8)
0.0434 (0.0023)
173.7 (4.6)
chips
ANOVA-SKR
0.0000 (0.0000)
57.9 (2.8)
0.0025 (0.0007)
173.7 (4.6)
ANOVA-SC
0.0059 (0.0015)
57.9 (2.8)
0.0250 (0.0019)
173.7 (4.6)
ANOVA-SAIC
0.0000 (0.0000)
57.9 (2.8)
0.0006 (0.0003)
173.7 (4.6)
ANOVA-SBIC
0.0000 (0.0000)
57.9 (2.8)
0.0006 (0.0003)
173.7 (4.6)
SKR
0.0335 (0.0021)
142.4 (2.4)
0.1374 (0.0029)
300.7 (4.0)
Missing
SC
0.0000 (0.0000)
0.5 (0.2)
0.0684 (0.0300)
1.7 (0.4)
eight
SAIC
0.0420 (0.0045)
227.0 (3.4)
0.1578 (0.0041)
418.2 (5.0)
data
SBIC
0.0391 (0.0043)
223.0 (3.4)
0.1381 (0.0043)
391.8 (4.6)
points
ANOVA
0.0200 (0.0200)
0.4 (0.1)
0.0440 (0.0196)
1.2 (0.2)
per
ANOVA-SKR
0.0000 (0.0000)
0.4 (0.1)
0.0000 (0.0000)
1.2 (0.2)
gene
ANOVA-SC
0.0000 (0.0000)
0.4 (0.1)
0.0300 (0.0170)
1.2 (0.2)
ANOVA-SAIC
0.0000 (0.0000)
0.4 (0.1)
0.0000 (0.0000)
1.2 (0.2)
ANOVA-SBIC
0.0000 (0.0000)
0.4 (0.1)
0.0000 (0.0000)
1.2 (0.2)

44
Table 2.5
AIC Selection for the Simulated Data with no Treatment Ef-
fect. none=model involving no random factor, r=model involv-
ing random replication factor, rg=model involving random repli-
cation-by-genotype factor, rt=model involving random replica-
tion-by-time factor.
True\Selected
none
r
rg
rt
r, rg
r, rt
rg, rt
r, rg, rt
Total
none
7152
277
338
552
0
3
85
0
8407
r
2102
1522
298
211
7
92
41
4
4277
rg
2077
596
2122
185
16
19
231
7
5253
rt
997
90
53
786
0
18
57
0
2001
r, rg
26
5
1
6
0
0
0
0
38
r, rt
312
162
28
116
3
30
18
2
671
rg, rt
655
190
553
322
8
27
369
9
2133
r, rg, rt
35
4
8
6
0
2
5
0
60
Total
13356
2846
3401
2184
34
191
806
22
22840
Table 2.6
BIC selection for the Simulated Data with no Treatment Ef-
fect. none=model involving no random factor, r=model involv-
ing random replication factor, rg=model involving random repli-
cation-by-genotype factor, rt=model involving random replica-
tion-by-time factor.
True\Selected
none
r
rg
rt
r, rg
r, rt
rg, rt
r, rg, rt
Total
none
7900
118
136
234
0
0
19
0
8407
r
2603
1322
194
116
0
27
15
0
4277
rg
2650
481
1936
88
1
6
91
0
5253
rt
1258
54
22
648
0
3
16
0
2001
r, rg
31
3
0
4
0
0
0
0
38
r, rt
388
161
19
92
0
9
2
0
671
rg, rt
891
164
560
270
2
6
240
0
2133
r, rg, rt
43
3
7
5
0
1
1
0
60
Total
15764
2306
2874
1457
3
52
384
0
22840

45
Table 2.7
ANOVA Table
Source of
Variation
d.f.
Sum of Squares
Replication
I −1
JK P
i(Y i.. −Y ...)2
Genotype
J −1
IK P
j(Y .j. −Y ...)2
Replication-by-Genotype
(I −1)(J −1)
K P
i
P
j(Y ij. −Y i.. −Y .j. + Y ...)2
Time
K −1
IJ P
k(Y ..k −Y ..)2
Genotype-by-Time
(J −1)(K −1)
I P
j
P
k(Y .jk −Y .j. −Y ..k + Y ...)2
Replication-by-Time
(I −1)(K −1)
J P
i
P
k(Y i.k −Y i.. −Y ..k + Y ...)2
Error
(I −1)(J −1)(K −1)
“Subtraction”
Corrected Total
IJK −1
P
i
P
j
P
k(Yijk −Y ...)2

46
Table 2.8
Genotype Test: Results for the Complete Data. Performance
of the methods described in Section 2.3 and in Section 2.5 of
the main paper for the test of genotype main eﬀects when 1%,
10%, and 20% of genes are non-null. Table values are the actual
average false positive fraction (V/R) and the average number ( ¯R)
of signiﬁcant genes for nominal control of FDR at the 0.1 and 0.2
level over 50 simulated data sets, where V = the number of type
I errors when R tests with the smallest p-values are declared to
be non-null.
d
FDR=0.1
d
FDR=0.2
Null
Method
V/R (S.E.)
¯R (S.E.)
V/R (S.E.)
¯R (S.E.)
SKR
0.7468 (0.0060)
91.3 (2.2)
0.7904 (0.0045)
134.9 (2.9)
SC
0.0000 (0.0000)
0.0 (0.0)
0.0000 (0.0000)
0.0 (0.0)
SAIC
0.8534 (0.0035)
292.0 (5.0)
0.8854 (0.0027)
446.6 (7.0)
SBIC
0.8629 (0.0033)
324.4 (5.3)
0.8917 (0.0023)
495.3 (7.5)
1%
ANOVA
0.1000 (0.0429)
0.1 (0.1)
0.1667 (0.0515)
0.4 (0.1)
ANOVA-SKR
0.0000 (0.0000)
0.1 (0.1)
0.0167 (0.0119)
0.4 (0.1)
ANOVA-SC
0.0000 (0.0000)
0.1 (0.1)
0.0267 (0.0210)
0.4 (0.1)
ANOVA-SAIC
0.0000 (0.0000)
0.1 (0.1)
0.0100 (0.0100)
0.4 (0.1)
ANOVA-SBIC
0.0000 (0.0000)
0.1 (0.1)
0.0100 (0.0100)
0.4 (0.1)
SKR
0.2838 (0.0033)
394.0 (3.8)
0.3523 (0.0027)
541.2 (4.5)
SC
0.0000 (0.0000)
0.0 (0.0)
0.0000 (0.0000)
0.0 (0.0)
SAIC
0.4222 (0.0022)
826.1 (4.8)
0.5003 (0.0020)
1159.1 (6.7)
SBIC
0.4375 (0.0021)
885.5 (4.9)
0.5138 (0.0020)
1234.0 (7.2)
10%
ANOVA
0.0950 (0.0341)
1.1 (0.3)
0.1692 (0.0324)
3.7 (0.7)
ANOVA-SKR
0.0000 (0.0000)
1.1 (0.3)
0.0020 (0.0020)
3.7 (0.7)
ANOVA-SC
0.0000 (0.0000)
1.1 (0.3)
0.0000 (0.0000)
3.7 (0.7)
ANOVA-SAIC
0.0000 (0.0000)
1.1 (0.3)
0.0013 (0.0013)
3.7 (0.7)
ANOVA-SBIC
0.0000 (0.0000)
1.1 (0.3)
0.0000 (0.0000)
3.7 (0.7)
SKR
0.1881 (0.0018)
816.4 (5.5)
0.2526 (0.0017)
1137.0 (7.8)
SC
0.0000 (0.0000)
0.0 (0.0)
0.0000 (0.0000)
0.1 (0.1)
SAIC
0.2840 (0.0018)
1490.7 (6.0)
0.3636 (0.0017)
2048.2 (8.7)
SBIC
0.2938 (0.0017)
1567.4 (6.3)
0.3723 (0.0017)
2139.0 (8.4)
20%
ANOVA
0.0887 (0.0313)
2.8 (0.5)
0.1623 (0.0142)
28.2 (4.3)
ANOVA-SKR
0.0000 (0.0000)
2.8 (0.5)
0.0056 (0.0021)
28.2 (4.3)
ANOVA-SC
0.0000 (0.0000)
2.8 (0.5)
0.0028 (0.0012)
28.2 (4.3)
ANOVA-SAIC
0.0000 (0.0000)
2.8 (0.5)
0.0009 (0.0005)
28.2 (4.3)
ANOVA-SBIC
0.0000 (0.0000)
2.8 (0.5)
0.0011 (0.0006)
28.2 (4.3)

47
Table 2.9
Time Test: Results for the Complete Data. Performance of the
methods described in Section 2.3 and in Section 2.5 of the main
paper for the test of time main eﬀects when 1%, 10%, and 20%
of genes are non-null. Table values are the actual average false
positive fraction (V/R) and the average number ( ¯R) of signiﬁcant
genes for nominal control of FDR at the 0.01 and 0.05 level
over 50 simulated data sets, where V = the number of type I
errors when R tests with the smallest p-values are declared to be
non-null.
d
FDR=0.01
d
FDR=0.05
Null
Method
V/R (S.E.)
¯R (S.E.)
V/R (S.E.)
¯R (S.E.)
SKR
0.0130 (0.0016)
79.9 (1.1)
0.0486 (0.0031)
101.0 (1.2)
SC
0.0000 (0.0000)
55.5 (1.1)
0.0023 (0.0008)
74.4 (1.1)
SAIC
0.0361 (0.0028)
101.4 (1.3)
0.1137 (0.0039)
128.1 (1.6)
SBIC
0.0390 (0.0029)
104.5 (1.3)
0.1249 (0.0042)
132.4 (1.7)
1%
ANOVA
0.0082 (0.0016)
62.4 (1.1)
0.0518 (0.0029)
85.9 (1.2)
ANOVA-SKR
0.0034 (0.0010)
62.4 (1.1)
0.0214 (0.0019)
85.9 (1.2)
ANOVA-SC
0.0000 (0.0000)
62.4 (1.1)
0.0097 (0.0017)
85.9 (1.2)
ANOVA-SAIC
0.0007 (0.0005)
62.4 (1.1)
0.0139 (0.0023)
85.9 (1.2)
ANOVA-SBIC
0.0004 (0.0004)
62.4 (1.1)
0.0112 (0.0021)
85.9 (1.2)
SKR
0.0084 (0.0005)
972.7 (3.9)
0.0365 (0.0007)
1211.8 (3.5)
SC
0.0004 (0.0001)
780.8 (3.5)
0.0064 (0.0003)
1023.9 (3.6)
SAIC
0.0196 (0.0007)
1141.1 (4.0)
0.0713 (0.0010)
1400.0 (4.2)
SBIC
0.0212 (0.0007)
1164.6 (4.0)
0.0748 (0.0009)
1425.0 (4.4)
10%
ANOVA
0.0103 (0.0005)
858.8 (3.5)
0.0506 (0.0009)
1156.1 (3.8)
ANOVA-SKR
0.0039 (0.0003)
858.8 (3.5)
0.0274 (0.0007)
1156.1 (3.8)
ANOVA-SC
0.0011 (0.0002)
858.8 (3.5)
0.0178 (0.0007)
1156.1 (3.8)
ANOVA-SAIC
0.0019 (0.0002)
858.8 (3.5)
0.0218 (0.0007)
1156.1 (3.8)
ANOVA-SBIC
0.0016 (0.0002)
858.8 (3.5)
0.0201 (0.0007)
1156.1 (3.8)
SKR
0.0073 (0.0003)
2130.8 (5.1)
0.0341 (0.0005)
2649.2 (4.8)
SC
0.0006 (0.0001)
1783.0 (5.4)
0.0084 (0.0003)
2325.0 (5.4)
SAIC
0.0161 (0.0004)
2441.9 (5.0)
0.0625 (0.0007)
2982.2 (5.4)
SBIC
0.0172 (0.0004)
2485.2 (5.0)
0.0655 (0.0007)
3027.0 (5.4)
20%
ANOVA
0.0093 (0.0003)
1942.5 (5.6)
0.0476 (0.0006)
2583.6 (5.2)
ANOVA-SKR
0.0036 (0.0002)
1942.5 (5.6)
0.0291 (0.0005)
2583.6 (5.2)
ANOVA-SC
0.0014 (0.0001)
1942.5 (5.6)
0.0212 (0.0005)
2583.6 (5.2)
ANOVA-SAIC
0.0022 (0.0001)
1942.5 (5.6)
0.0247 (0.0005)
2583.6 (5.2)
ANOVA-SBIC
0.0019 (0.0001)
1942.5 (5.6)
0.0233 (0.0005)
2583.6 (5.2)

48
Table 2.10
Genotype-by-time Interaction Test: Results for the Complete
Data. Performance of the methods described in Section 2.3 and
in Section 2.5 of the main paper for the test of genotype-by–
time interaction eﬀects when 1%, 10%, and 20% of genes are
non-null. Table values are the actual average false positive frac-
tion (V/R) and the average number ( ¯R) of signiﬁcant genes for
nominal control of FDR at the 0.01 and 0.05 level over 50 sim-
ulated data sets, where V = the number of type I errors when
R tests with the smallest p-values are declared to be non-null.
d
FDR=0.01
d
FDR=0.05
Null
Method
V/R (S.E.)
¯R (S.E.)
V/R (S.E.)
¯R (S.E.)
SKR
0.0369 (0.0043)
27.8 (0.9)
0.1442 (0.0077)
44.7 (1.3)
SC
0.0145 (0.0041)
13.5 (0.7)
0.0849 (0.0085)
27.0 (1.2)
SAIC
0.0370 (0.0040)
33.7 (0.9)
0.1367 (0.0066)
48.6 (1.2)
SBIC
0.0346 (0.0039)
33.2 (0.9)
0.1254 (0.0066)
47.0 (1.1)
1%
ANOVA
0.0071 (0.0035)
9.5 (0.6)
0.0708 (0.0092)
19.9 (0.9)
ANOVA-SKR
0.0000 (0.0000)
9.5 (0.6)
0.0121 (0.0029)
19.9 (0.9)
ANOVA-SC
0.0056 (0.0032)
9.5 (0.6)
0.0552 (0.0081)
19.9 (0.9)
ANOVAS-AIC
0.0000 (0.0000)
9.5 (0.6)
0.0013 (0.0013)
19.9 (0.9)
ANOVAS-BIC
0.0000 (0.0000)
9.5 (0.6)
0.0013 (0.0013)
19.9 (0.9)
SKR
0.0255 (0.0010)
435.8 (3.3)
0.1186 (0.0018)
685.8 (5.1)
SC
0.0142 (0.0009)
295.0 (2.6)
0.0739 (0.0015)
512.9 (3.7)
SAIC
0.0237 (0.0009)
465.8 (3.3)
0.1021 (0.0017)
673.2 (4.1)
SBIC
0.0198 (0.0008)
447.1 (3.1)
0.0810 (0.0016)
625.2 (3.9)
10%
ANOVA
0.0088 (0.0008)
229.4 (2.4)
0.0486 (0.0016)
393.6 (2.8)
ANOVA-SKR
0.0013 (0.0004)
229.4 (2.4)
0.0159 (0.0009)
393.6 (2.8)
ANOVA-SC
0.0058 (0.0008)
229.4 (2.4)
0.0351 (0.0014)
393.6 (2.8)
ANOVA-SAIC
0.0002 (0.0001)
229.4 (2.4)
0.0094 (0.0007)
393.6 (2.8)
ANOVA-SBIC
0.0002 (0.0001)
229.4 (2.4)
0.0101 (0.0007)
393.6 (2.8)
SKR
0.0234 (0.0007)
1007.6 (5.2)
0.1120 (0.0012)
1606.7 (7.4)
SC
0.0131 (0.0007)
737.2 (4.7)
0.0744 (0.0011)
1267.9 (6.6)
SAIC
0.0213 (0.0006)
1044.5 (4.8)
0.0909 (0.0011)
1521.0 (6.1)
SBIC
0.0175 (0.0006)
997.1 (4.6)
0.0714 (0.0009)
1409.7 (5.5)
20%
ANOVA
0.0085 (0.0004)
575.8 (4.3)
0.0476 (0.0011)
980.8 (5.6)
ANOVA-SKR
0.0018 (0.0002)
575.8 (4.3)
0.0211 (0.0009)
980.8 (5.6)
ANOVA-SC
0.0057 (0.0004)
575.8 (4.3)
0.0355 (0.0010)
980.8 (5.6)
ANOVA-SAIC
0.0009 (0.0002)
575.8 (4.3)
0.0159 (0.0007)
980.8 (5.6)
ANOVA-SBIC
0.0009 (0.0002)
575.8 (4.3)
0.0163 (0.0007)
980.8 (5.6)

49
Table 2.11
Genotype Test: Results for the Non-Normal Data. Performance
of the methods described in Section 2.3 and in Section 2.5 of
the main paper for the test of genotype main eﬀects when 10%
of genes are non-null and errors follow a Normal distribution
or t-distribution with ﬁve degrees of freedom. Table values are
the actual average false positive fraction (V/R) and the average
number ( ¯R) of signiﬁcant genes for nominal control of FDR at
the 0.1 and 0.2 level over 50 simulated data sets, where V = the
number of type I errors when R tests with the smallest p-values
are declared to be non-null.
d
FDR=0.1
d
FDR=0.2
Method
V/R (S.E.)
¯R (S.E.)
V/R (S.E.)
¯R (S.E.)
SKR
0.2838 (0.0033)
394.0 (3.8)
0.3523 (0.0027)
541.2 (4.5)
SC
0.0000 (0.0000)
0.0 (0.0)
0.0000 (0.0000)
0.0 (0.0)
N
SAIC
0.4222 (0.0022)
826.1 (4.8)
0.5003 (0.0020)
1159.1 (6.7)
o
SBIC
0.4375 (0.0021)
885.5 (4.9)
0.5138 (0.0020)
1234.0 (7.2)
r
ANOVA
0.0950 (0.0341)
1.1 (0.3)
0.1692 (0.0324)
3.7 (0.7)
m
ANOVA-SKR
0.0000 (0.0000)
1.1 (0.3)
0.0020 (0.0020)
3.7 (0.7)
a
ANOVA-SC
0.0000 (0.0000)
1.1 (0.3)
0.0000 (0.0000)
3.7 (0.7)
l
ANOVA-SAIC
0.0000 (0.0000)
1.1 (0.3)
0.0013 (0.0013)
3.7 (0.7)
ANOVA-SBIC
0.0000 (0.0000)
1.1 (0.3)
0.0000 (0.0000)
3.7 (0.7)
SKR
0.3008 (0.0037)
297.3 (2.9)
0.3693 (0.0034)
418.5 (4.0)
SC
0.0000 (0.0000)
0.0 (0.0)
0.0000 (0.0000)
0.0 (0.0)
SAIC
0.4261 (0.0029)
643.3 (4.2)
0.5074 (0.0021)
928.1 (5.3)
SBIC
0.4401 (0.0027)
688.9 (4.5)
0.5188 (0.0022)
989.7 (5.9)
t5
ANOVA
0.0500 (0.0258)
0.4 (0.1)
0.1915 (0.0402)
1.8 (0.3)
ANOVA-SKR
0.0000 (0.0000)
0.4 (0.1)
0.0000 (0.0000)
1.8 (0.3)
ANOVA-SC
0.0000 (0.0000)
0.4 (0.1)
0.0029 (0.0029)
1.8 (0.3)
ANOVA-SAIC
0.0000 (0.0000)
0.4 (0.1)
0.0000 (0.0000)
1.8 (0.3)
ANOVA-SBIC
0.0000 (0.0000)
0.4 (0.1)
0.0000 (0.0000)
1.8 (0.3)

50
Table 2.12
Time Test: Results for the Non-Normal Data.
Performance
of the methods described in Section 2.3 and in Section 2.5 of
the main paper for the test of time main eﬀects when 10%
of genes are non-null and errors follow a Normal distribution
or t-distribution with ﬁve degrees of freedom. Table values are
the actual average false positive fraction (V/R) and the average
number ( ¯R) of signiﬁcant genes for nominal control of FDR at
the 0.01 and 0.05 level over 50 simulated data sets, where V =
the number of type I errors when R tests with the smallest
p-values are declared to be non-null.
d
FDR=0.01
d
FDR=0.05
Method
V/R (S.E.)
¯R (S.E.)
V/R (S.E.)
¯R (S.E.)
SKR
0.0084 (0.0005)
972.7 (3.9)
0.0365 (0.0007)
1211.8 (3.5)
SC
0.0004 (0.0001)
780.8 (3.5)
0.0064 (0.0003)
1023.9 (3.6)
N
SAIC
0.0196 (0.0007)
1141.1 (4.0)
0.0713 (0.0010)
1400.0 (4.2)
o
SBIC
0.0212 (0.0007)
1164.6 (4.0)
0.0748 (0.0009)
1425.0 (4.4)
r
ANOVA
0.0103 (0.0005)
858.8 (3.5)
0.0506 (0.0009)
1156.1 (3.8)
m
ANOVA-SKR
0.0039 (0.0003)
858.8 (3.5)
0.0274 (0.0007)
1156.1 (3.8)
a
ANOVA-SC
0.0011 (0.0002)
858.8 (3.5)
0.0178 (0.0007)
1156.1 (3.8)
l
ANOVA-SAIC
0.0019 (0.0002)
858.8 (3.5)
0.0218 (0.0007)
1156.1 (3.8)
ANOVA-SBIC
0.0016 (0.0002)
858.8 (3.5)
0.0201 (0.0007)
1156.1 (3.8)
SKR
0.0074 (0.0005)
764.4 (3.5)
0.0315 (0.0007)
983.4 (3.7)
SC
0.0002 (0.0001)
575.7 (3.2)
0.0037 (0.0003)
799.7 (3.7)
SAIC
0.0162 (0.0006)
930.4 (3.4)
0.0631 (0.0010)
1164.6 (4.0)
SBIC
0.0171 (0.0006)
950.4 (3.5)
0.0654 (0.0010)
1186.9 (3.9)
t5
ANOVA
0.0088 (0.0005)
645.6 (3.4)
0.0455 (0.0009)
916.4 (4.2)
ANOVA-SKR
0.0025 (0.0003)
645.6 (3.4)
0.0217 (0.0007)
916.4 (4.2)
ANOVA-SC
0.0006 (0.0001)
645.6 (3.4)
0.0117 (0.0006)
916.4 (4.2)
ANOVA-SAIC
0.0009 (0.0002)
645.6 (3.4)
0.0151 (0.0006)
916.4 (4.2)
ANOVA-SBIC
0.0005 (0.0001)
645.6 (3.4)
0.0136 (0.0006)
916.4 (4.2)

51
Table 2.13
Genotype-by-time Interaction Test: Results for the Non-Nor-
mal Data. Performance of the methods described in Section 2.3
and in Section 2.5 of the main paper for the test of genotype-
-by-time interaction eﬀects when 10% of genes are non-null and
errors follow a Normal distribution or t-distribution with ﬁve
degrees of freedom. Table values are the actual average false
positive fraction (V/R) and the average number ( ¯R) of signiﬁ-
cant genes for nominal control of FDR at the 0.01 and 0.05 level
over 50 simulated data sets, where V = the number of type I
errors when R tests with the smallest p-values are declared to
be non-null.
d
FDR=0.01
d
FDR=0.05
Method
V/R (S.E.)
¯R (S.E.)
V/R (S.E.)
¯R (S.E.)
SKR
0.0255 (0.0010)
435.8 (3.3)
0.1186 (0.0018)
685.8 (5.1)
SC
0.0142 (0.0009)
295.0 (2.6)
0.0739 (0.0015)
512.9 (3.7)
N
SAIC
0.0237 (0.0009)
465.8 (3.3)
0.1021 (0.0017)
673.2 (4.1)
o
SBIC
0.0198 (0.0008)
447.1 (3.1)
0.0810 (0.0016)
625.2 (3.9)
r
ANOVA
0.0088 (0.0008)
229.4 (2.4)
0.0486 (0.0016)
393.6 (2.8)
m
ANOVA-SKR
0.0013 (0.0004)
229.4 (2.4)
0.0159 (0.0009)
393.6 (2.8)
a
ANOVA-SC
0.0058 (0.0008)
229.4 (2.4)
0.0351 (0.0014)
393.6 (2.8)
l
ANOVA-SAIC
0.0002 (0.0001)
229.4 (2.4)
0.0094 (0.0007)
393.6 (2.8)
ANOVA-SBIC
0.0002 (0.0001)
229.4 (2.4)
0.0101 (0.0007)
393.6 (2.8)
SKR
0.0231 (0.0011)
279.9 (2.2)
0.1088 (0.0020)
469.7 (3.4)
SC
0.0129 (0.0013)
169.2 (2.2)
0.0676 (0.0021)
325.3 (3.2)
SAIC
0.0202 (0.0010)
308.4 (2.3)
0.0936 (0.0020)
467.6 (3.3)
SBIC
0.0172 (0.0012)
294.1 (2.3)
0.0753 (0.0018)
432.9 (2.9)
t5
ANOVA
0.0097 (0.0013)
124.6 (1.8)
0.0464 (0.0019)
238.2 (2.8)
ANOVA-SKR
0.0008 (0.0003)
124.6 (1.8)
0.0120 (0.0010)
238.2 (2.8)
ANOVA-SC
0.0061 (0.0010)
124.6 (1.8)
0.0325 (0.0015)
238.2 (2.8)
ANOVA-SAIC
0.0000 (0.0000)
124.6 (1.8)
0.0060 (0.0007)
238.2 (2.8)
ANOVA-SBIC
0.0000 (0.0000)
124.6 (1.8)
0.0058 (0.0007)
238.2 (2.8)

52
Table 2.14
Genotype Test: Results for the Missing Data.
Performance
of the methods described in Section 2.3 and in Section 2.5 of
the main paper for the test of genotype main eﬀects when 10%
of genes are non-null and no data are missing or three entire
microarray chips are missing or random eight observations are
missing for every gene.
Table values are the actual average
false positive fraction (V/R) and the average number ( ¯R) of
signiﬁcant genes for nominal control of FDR at the 0.1 and 0.2
level over 50 simulated data sets, where V = the number of type
I errors when R tests with the smallest p-values are declared to
be non-null.
d
FDR=0.1
d
FDR=0.2
Method
V/R (S.E.)
¯R (S.E.)
V/R (S.E.)
¯R (S.E.)
SKR
0.2838 (0.0033)
394.0 (3.8)
0.3523 (0.0027)
541.2 (4.5)
SC
0.0000 (0.0000)
0.0 (0.0)
0.0000 (0.0000)
0.0 (0.0)
SAIC
0.4222 (0.0022)
826.1 (4.8)
0.5003 (0.0020)
1159.1 (6.7)
Full
SBIC
0.4375 (0.0021)
885.5 (4.9)
0.5138 (0.0020)
1234.0 (7.2)
ANOVA
0.0950 (0.0341)
1.1 (0.3)
0.1692 (0.0324)
3.7 (0.7)
Data
ANOVA-SKR
0.0000 (0.0000)
1.1 (0.3)
0.0020 (0.0020)
3.7 (0.7)
ANOVA-SC
0.0000 (0.0000)
1.1 (0.3)
0.0000 (0.0000)
3.7 (0.7)
ANOVA-SAIC
0.0000 (0.0000)
1.1 (0.3)
0.0013 (0.0013)
3.7 (0.7)
ANOVA-SBIC
0.0000 (0.0000)
1.1 (0.3)
0.0000 (0.0000)
3.7 (0.7)
SKR
0.2943 (0.0029)
354.7 (4.7)
0.3639 (0.0025)
494.4 (5.7)
SC
0.0000 (0.0000)
0.0 (0.0)
0.0000 (0.0000)
0.0 (0.0)
Missing
SAIC
0.4302 (0.0026)
773.2 (7.2)
0.5131 (0.0024)
1106.5 (8.2)
three
SBIC
0.4434 (0.0026)
826.2 (7.0)
0.5239 (0.0023)
1173.3 (8.5)
entire
ANOVA
0.1000 (0.0404)
0.5 (0.1)
0.1432 (0.0388)
1.8 (0.4)
chips
ANOVA-SKR
0.0000 (0.0000)
0.5 (0.1)
0.0000 (0.0000)
1.8 (0.4)
ANOVA-SC
0.0000 (0.0000)
0.5 (0.1)
0.0000 (0.0000)
1.8 (0.4)
ANOVA-SAIC
0.0000 (0.0000)
0.5 (0.1)
0.0000 (0.0000)
1.8 (0.4)
ANOVA-SBIC
0.0000 (0.0000)
0.5 (0.1)
0.0000 (0.0000)
1.8 (0.4)
SKR
0.2745 (0.0045)
221.5 (3.1)
0.3663 (0.0039)
344.2 (4.1)
Missing
SC
0.0000 (0.0000)
0.0 (0.0)
0.0000 (0.0000)
0.0 (0.0)
eight
SAIC
0.4327 (0.0033)
573.5 (4.8)
0.5386 (0.0026)
926.6 (7.0)
data
SBIC
0.4420 (0.0033)
612.7 (5.1)
0.5438 (0.0026)
972.6 (7.5)
points
ANOVA
0.0670 (0.0300)
0.3 (0.1)
0.1736 (0.0421)
1.5 (0.3)
per
ANOVA-SKR
0.0000 (0.0000)
0.3 (0.1)
0.0022 (0.0022)
1.5 (0.3)
gene
ANOVA-SC
0.0000 (0.0000)
0.3 (0.1)
0.0050 (0.0050)
1.5 (0.3)
ANOVA-SAIC
0.0000 (0.0000)
0.3 (0.1)
0.0000 (0.0000)
1.5 (0.3)
ANOVA-SBIC
0.0000 (0.0000)
0.3 (0.1)
0.0000 (0.0000)
1.5 (0.3)

53
Table 2.15
Time Test: Results for the Missing Data. Performance of the
methods described in Section 2.3 and in Section 2.5 of the main
paper for the test of time main eﬀects when 10% of genes are
non-null and no data are missing or three entire microarray
chips are missing or random eight observations are missing for
every gene. Table values are the actual average false positive
fraction (V/R) and the average number ( ¯R) of signiﬁcant genes
for nominal control of FDR at the 0.01 and 0.05 level over
50 simulated data sets, where V = the number of type I er-
rors when R tests with the smallest p-values are declared to be
non-null.
d
FDR=0.01
d
FDR=0.05
Method
V/R (S.E.)
¯R (S.E.)
V/R (S.E.)
¯R (S.E.)
SKR
0.0084 (0.0005)
972.7 (3.9)
0.0365 (0.0007)
1211.8 (3.5)
SC
0.0004 (0.0001)
780.8 (3.5)
0.0064 (0.0003)
1023.9 (3.6)
SAIC
0.0196 (0.0007)
1141.1 (4.0)
0.0713 (0.0010)
1400.0 (4.2)
Full
SBIC
0.0212 (0.0007)
1164.6 (4.0)
0.0748 (0.0009)
1425.0 (4.4)
ANOVA
0.0103 (0.0005)
858.8 (3.5)
0.0506 (0.0009)
1156.1 (3.8)
Data
ANOVA-SKR
0.0039 (0.0003)
858.8 (3.5)
0.0274 (0.0007)
1156.1 (3.8)
ANOVA-SC
0.0011 (0.0002)
858.8 (3.5)
0.0178 (0.0007)
1156.1 (3.8)
ANOVA-SAIC
0.0019 (0.0002)
858.8 (3.5)
0.0218 (0.0007)
1156.1 (3.8)
ANOVA-SBIC
0.0016 (0.0002)
858.8 (3.5)
0.0201 (0.0007)
1156.1 (3.8)
SKR
0.0086 (0.0005)
874.2 (5.4)
0.0367 (0.0008)
1119.1 (6.2)
SC
0.0006 (0.0001)
737.0 (5.6)
0.0087 (0.0004)
983.7 (6.1)
Missing
SAIC
0.0198 (0.0006)
1063.3 (5.7)
0.0751 (0.0011)
1332.5 (6.2)
three
SBIC
0.0213 (0.0007)
1085.3 (5.8)
0.0791 (0.0011)
1357.1 (6.3)
entire
ANOVA
0.0081 (0.0005)
763.7 (7.9)
0.0420 (0.0010)
1044.8 (8.4)
chips
ANOVA-SKR
0.0041 (0.0003)
763.7 (7.9)
0.0247 (0.0008)
1044.8 (8.4)
ANOVA-SC
0.0012 (0.0002)
763.7 (7.9)
0.0145 (0.0007)
1044.8 (8.4)
ANOVA-SAIC
0.0014 (0.0002)
763.7 (7.9)
0.0174 (0.0008)
1044.8 (8.4)
ANOVA-SBIC
0.0010 (0.0002)
763.7 (7.9)
0.0161 (0.0008)
1044.8 (8.4)
SKR
0.0105 (0.0006)
651.8 (3.1)
0.0465 (0.0010)
905.3 (3.8)
Missing
SC
0.0026 (0.0003)
556.5 (3.2)
0.0229 (0.0008)
817.9 (3.8)
eight
SAIC
0.0242 (0.0032)
847.5 (5.0)
0.0896 (0.0032)
1142.3 (5.4)
data
SBIC
0.0244 (0.0032)
858.2 (4.9)
0.0872 (0.0032)
1145.0 (5.4)
points
ANOVA
0.0059 (0.0005)
479.5 (3.0)
0.0312 (0.0009)
724.6 (3.7)
per
ANOVA-SKR
0.0022 (0.0003)
479.5 (3.0)
0.0167 (0.0007)
724.6 (3.7)
gene
ANOVA-SC
0.0013 (0.0002)
479.5 (3.0)
0.0124 (0.0007)
724.6 (3.7)
ANOVA-SAIC
0.0039 (0.0032)
479.5 (3.0)
0.0118 (0.0031)
724.6 (3.7)
ANOVA-SBIC
0.0034 (0.0030)
479.5 (3.0)
0.0112 (0.0030)
724.6 (3.7)

54
Table 2.16
Genotype-by-time Interaction Test:
Results for the Missing
Data.
Performance of the methods described in Section 2.3
and in Section 2.5 of the main paper for the test of genotype-
-by-time interaction eﬀects when 10% of genes are non-null and
no data are missing or three entire microarray chips are missing
or random eight observations are missing for every gene. Table
values are the actual average false positive fraction (V/R) and
the average number ( ¯R) of signiﬁcant genes for nominal control
of FDR at the 0.01 and 0.05 level over 50 simulated data sets,
where V = the number of type I errors when R tests with the
smallest p-values are declared to be non-null.
d
FDR=0.01
d
FDR=0.05
Method
V/R (S.E.)
¯R (S.E.)
V/R (S.E.)
¯R (S.E.)
SKR
0.0255 (0.0010)
435.8 (3.3)
0.1186 (0.0018)
685.8 (5.1)
SC
0.0142 (0.0009)
295.0 (2.6)
0.0739 (0.0015)
512.9 (3.7)
SAIC
0.0237 (0.0009)
465.8 (3.3)
0.1021 (0.0017)
673.2 (4.1)
Full
SBIC
0.0198 (0.0008)
447.1 (3.1)
0.0810 (0.0016)
625.2 (3.9)
ANOVA
0.0088 (0.0008)
229.4 (2.4)
0.0486 (0.0016)
393.6 (2.8)
Data
ANOVA-SKR
0.0013 (0.0004)
229.4 (2.4)
0.0159 (0.0009)
393.6 (2.8)
ANOVA-SC
0.0058 (0.0008)
229.4 (2.4)
0.0351 (0.0014)
393.6 (2.8)
ANOVA-SAIC
0.0002 (0.0001)
229.4 (2.4)
0.0094 (0.0007)
393.6 (2.8)
ANOVA-SBIC
0.0002 (0.0001)
229.4 (2.4)
0.0101 (0.0007)
393.6 (2.8)
SKR
0.0263 (0.0012)
335.5 (3.8)
0.1256 (0.0021)
574.6 (5.6)
SC
0.0122 (0.0016)
111.4 (3.4)
0.0651 (0.0021)
294.4 (5.1)
Missing
SAIC
0.0266 (0.0011)
388.8 (3.6)
0.1165 (0.0020)
599.2 (5.1)
three
SBIC
0.0225 (0.0010)
373.1 (3.5)
0.0956 (0.0017)
555.4 (4.7)
entire
ANOVA
0.0091 (0.0019)
57.9 (2.8)
0.0434 (0.0023)
173.7 (4.6)
chips
ANOVA-SKR
0.0000 (0.0000)
57.9 (2.8)
0.0025 (0.0007)
173.7 (4.6)
ANOVA-SC
0.0059 (0.0015)
57.9 (2.8)
0.0250 (0.0019)
173.7 (4.6)
ANOVA-SAIC
0.0000 (0.0000)
57.9 (2.8)
0.0006 (0.0003)
173.7 (4.6)
ANOVA-SBIC
0.0000 (0.0000)
57.9 (2.8)
0.0006 (0.0003)
173.7 (4.6)
SKR
0.0335 (0.0021)
142.4 (2.4)
0.1374 (0.0029)
300.7 (4.0)
Missing
SC
0.0000 (0.0000)
0.5 (0.2)
0.0684 (0.0300)
1.7 (0.4)
eight
SAIC
0.0420 (0.0045)
227.0 (3.4)
0.1578 (0.0041)
418.2 (5.0)
data
SBIC
0.0391 (0.0043)
223.0 (3.4)
0.1381 (0.0043)
391.8 (4.6)
points
ANOVA
0.0200 (0.0200)
0.4 (0.1)
0.0440 (0.0196)
1.2 (0.2)
per
ANOVA-SKR
0.0000 (0.0000)
0.4 (0.1)
0.0000 (0.0000)
1.2 (0.2)
gene
ANOVA-SC
0.0000 (0.0000)
0.4 (0.1)
0.0300 (0.0170)
1.2 (0.2)
ANOVA-SAIC
0.0000 (0.0000)
0.4 (0.1)
0.0000 (0.0000)
1.2 (0.2)
ANOVA-SBIC
0.0000 (0.0000)
0.4 (0.1)
0.0000 (0.0000)
1.2 (0.2)

55
0.000
0.005
0.010
0.015
0.020
0.025
0.030
0.10
0.15
0.20
0.25
0.30
0.35
0.40
1−specificity
sensitivity
SKR
SC
SAIC
SBIC
ANOVA
0.00
0.05
0.10
0.15
0.20
0.25
0.30
0.00
0.05
0.10
0.15
0.20
0.25
0.30
V R
FDR
SKR
SC
SAIC
SBIC
ANOVA
Figure 2.1
Genotype-by-time Interaction: Results for the Complete Data.
ROC curves (left panel) and average actual false positive frac-
tion (V/R) vs. the average estimated FDR level ( d
FDR) (right
panel) corresponding to the ﬁve analysis methods of Section 2.3
for testing interaction between genotype and time. Each curve
was averaged over 50 simulated data sets.

56
0.00
0.05
0.10
0.15
0.20
0.0
0.1
0.2
0.3
0.4
0.5
1−specificity
sensitivity
SKR
SC
SAIC
SBIC
ANOVA
0.0
0.2
0.4
0.6
0.8
1.0
0.0
0.2
0.4
0.6
0.8
1.0
V R
FDR
SKR
SC
SAIC
SBIC
ANOVA
0.00
0.05
0.10
0.15
0.20
0.0
0.1
0.2
0.3
0.4
0.5
1−specificity
sensitivity
SKR
SC
SAIC
SBIC
ANOVA
0.0
0.2
0.4
0.6
0.8
1.0
0.0
0.2
0.4
0.6
0.8
1.0
V R
FDR
SKR
SC
SAIC
SBIC
ANOVA
Figure 2.2
Genotype Test: Results for the Full Data Sets.
Left: ROC
curves corresponding to the ﬁve standard analysis methods for
testing genotype main eﬀects when 1% (top) and 10% (bottom)
of the genes are non-null. Each ROC curve was averaged over
50 simulated data sets. Right: The average actual false posi-
tive fraction (V/R) vs. the average estimated FDR level ( d
FDR)
corresponding to the ﬁve standard analysis methods for testing
genotype main eﬀects when 1% (top) and 10% (bottom) of the
genes are non-null. Each curve was averaged over 50 simulated
data sets.

57
0.00
0.05
0.10
0.15
0.20
0.0
0.1
0.2
0.3
0.4
0.5
1−specificity
sensitivity
SKR
SC
SAIC
SBIC
ANOVA
0.0
0.2
0.4
0.6
0.8
1.0
0.0
0.2
0.4
0.6
0.8
1.0
V R
FDR
SKR
SC
SAIC
SBIC
ANOVA
Figure 2.2
(Continued)
Genotype Test: Results for the Full Data Sets. Left: ROC curves corresponding to the ﬁve
standard analysis methods for testing genotype main eﬀects when 20% of the genes are non-
null. Each ROC curve was averaged over 50 simulated data sets. Right: The average actual
false positive fraction (V/R) vs. the average estimated FDR level ( d
FDR) corresponding to the
ﬁve standard analysis methods for testing genotype main eﬀects when 20% of the genes are
non-null. Each curve was averaged over 50 simulated data sets.

58
0.00
0.01
0.02
0.03
0.04
0.05
0.06
0.2
0.3
0.4
0.5
0.6
0.7
1−specificity
sensitivity
SKR
SC
SAIC
SBIC
ANOVA
0.0
0.1
0.2
0.3
0.4
0.5
0.0
0.1
0.2
0.3
0.4
0.5
V R
FDR
SKR
SC
SAIC
SBIC
ANOVA
0.00
0.01
0.02
0.03
0.04
0.05
0.06
0.2
0.3
0.4
0.5
0.6
0.7
1−specificity
sensitivity
SKR
SC
SAIC
SBIC
ANOVA
0.0
0.1
0.2
0.3
0.4
0.5
0.0
0.1
0.2
0.3
0.4
0.5
V R
FDR
SKR
SC
SAIC
SBIC
ANOVA
Figure 2.3
Time Test: Results for the Full Data Sets. Left: ROC curves
corresponding to the ﬁve standard analysis methods for test-
ing time main eﬀects when 1% (top) and 10% (bottom) of the
genes are non-null. Each ROC curve was averaged over 50 sim-
ulated data sets. Right: The average actual false positive frac-
tion (V/R) vs. the average estimated FDR level ( d
FDR) corre-
sponding to the ﬁve standard analysis methods for testing time
main eﬀects when 1% (top) and 10% (bottom) of the genes are
non-null. Each curve was averaged over 50 simulated data sets.

59
0.00
0.01
0.02
0.03
0.04
0.05
0.06
0.2
0.3
0.4
0.5
0.6
0.7
1−specificity
sensitivity
SKR
SC
SAIC
SBIC
ANOVA
0.0
0.1
0.2
0.3
0.4
0.5
0.0
0.1
0.2
0.3
0.4
0.5
V R
FDR
SKR
SC
SAIC
SBIC
ANOVA
Figure 2.3
(Continued)
Time Test: Results for the Full Data Sets. Left: ROC curves corresponding to the ﬁve standard
analysis methods for testing time main eﬀects when 20% of the genes are non-null. Each ROC
curve was averaged over 50 simulated data sets.
Right: The average actual false positive
fraction (V/R) vs. the average estimated FDR level ( d
FDR) corresponding to the ﬁve standard
analysis methods for testing time main eﬀects when 20% of the genes are non-null. Each curve
was averaged over 50 simulated data sets.

60
0.000
0.005
0.010
0.015
0.020
0.025
0.030
0.05
0.10
0.15
0.20
0.25
0.30
0.35
0.40
1−specificity
sensitivity
SKR
SC
SAIC
SBIC
ANOVA
0.00
0.05
0.10
0.15
0.20
0.25
0.30
0.00
0.05
0.10
0.15
0.20
0.25
0.30
V R
FDR
SKR
SC
SAIC
SBIC
ANOVA
0.000
0.005
0.010
0.015
0.020
0.025
0.030
0.10
0.15
0.20
0.25
0.30
0.35
0.40
1−specificity
sensitivity
SKR
SC
SAIC
SBIC
ANOVA
0.00
0.05
0.10
0.15
0.20
0.25
0.30
0.00
0.05
0.10
0.15
0.20
0.25
0.30
V R
FDR
SKR
SC
SAIC
SBIC
ANOVA
Figure 2.4
Genotype-by-time Interaction Test: Results for the Full Data
Sets. Left: ROC curves corresponding to the ﬁve standard anal-
ysis methods for testing interaction between genotype and time
when 1% (top) and 10% (bottom) of the genes are non-null.
Each ROC curve was averaged over 50 simulated data sets.
Right: The average actual false positive fraction (V/R) vs. the
average estimated FDR level ( d
FDR) corresponding to the ﬁve
standard analysis methods for testing interaction between geno-
type and time when 1% (top) and 10% (bottom) of the genes
are non-null. Each curve was averaged over 50 simulated data
sets.

61
0.000
0.005
0.010
0.015
0.020
0.025
0.030
0.05
0.10
0.15
0.20
0.25
0.30
0.35
0.40
1−specificity
sensitivity
SKR
SC
SAIC
SBIC
ANOVA
0.00
0.05
0.10
0.15
0.20
0.25
0.30
0.00
0.05
0.10
0.15
0.20
0.25
0.30
V R
FDR
SKR
SC
SAIC
SBIC
ANOVA
Figure 2.4
(Continued)
Genotype-by-time Interaction Test: Results for the Full Data Sets. Left: ROC curves corre-
sponding to the ﬁve standard analysis methods for testing interaction between genotype and
time when 20% of the genes are non-null. Each ROC curve was averaged over 50 simulated
data sets. Right: The average actual false positive fraction (V/R) vs. the average estimated
FDR level ( d
FDR) corresponding to the ﬁve standard analysis methods for testing interaction
between genotype and time when 20% of the genes are non-null. Each curve was averaged over
50 simulated data sets.

62
0.00
0.05
0.10
0.15
0.20
0.0
0.1
0.2
0.3
0.4
0.5
1−specificity
sensitivity
SKR
SC
SAIC
SBIC
ANOVA
(a)
0.0
0.2
0.4
0.6
0.8
1.0
0.0
0.2
0.4
0.6
0.8
1.0
V R
FDR
SKR
SC
SAIC
SBIC
ANOVA
(b)
0.00
0.05
0.10
0.15
0.20
0.0
0.1
0.2
0.3
0.4
1−specificity
sensitivity
SKR
SC
SAIC
SBIC
ANOVA
(c)
0.0
0.2
0.4
0.6
0.8
1.0
0.0
0.2
0.4
0.6
0.8
1.0
V R
FDR
SKR
SC
SAIC
SBIC
ANOVA
(d)
Figure 2.5
Genotype Test: Results for the non-normal Data. Left: ROC
curves corresponding to the ﬁve standard analysis methods
for testing genotype main eﬀects when 10% of the genes
are non-null and errors follow a Normal distribution (a) or
t-distribution with ﬁve degrees of freedom (c). Each ROC curve
was averaged over 50 simulated data sets. Right: The average
actual false positive fraction (V/R) vs. the average estimated
FDR level ( d
FDR) corresponding to the ﬁve standard analysis
methods for testing genotype main eﬀects when 10% of the
genes are non-null and errors follow a Normal distribution (b)
or t-distribution with ﬁve degrees of freedom (d). Each curve
was averaged over 50 simulated data sets.

63
0.00
0.01
0.02
0.03
0.04
0.05
0.06
0.2
0.3
0.4
0.5
0.6
0.7
1−specificity
sensitivity
SKR
SC
SAIC
SBIC
ANOVA
(a)
0.0
0.1
0.2
0.3
0.4
0.5
0.0
0.1
0.2
0.3
0.4
0.5
V R
FDR
SKR
SC
SAIC
SBIC
ANOVA
(b)
0.00
0.01
0.02
0.03
0.04
0.05
0.06
0.2
0.3
0.4
0.5
0.6
1−specificity
sensitivity
SKR
SC
SAIC
SBIC
ANOVA
(c)
0.0
0.1
0.2
0.3
0.4
0.5
0.0
0.1
0.2
0.3
0.4
0.5
V R
FDR
SKR
SC
SAIC
SBIC
ANOVA
(d)
Figure 2.6
Time Test: Results for the non-normal Data. Left: ROC curves
corresponding to the ﬁve standard analysis methods for testing
time main eﬀects when 10% of the genes are non-null and er-
rors follow a Normal distribution (a) or t-distribution with ﬁve
degrees of freedom (b).
Each ROC curve was averaged over
50 simulated data sets. Right: The average actual false posi-
tive fraction (V/R) vs. the average estimated FDR level ( d
FDR)
corresponding to the ﬁve standard analysis methods for test-
ing time main eﬀects when 10% of the genes are non-null and
errors follow a Normal distribution (b) or t-distribution with
ﬁve degrees of freedom (d). Each curve was averaged over 50
simulated data sets.

64
0.000
0.005
0.010
0.015
0.020
0.025
0.030
0.10
0.15
0.20
0.25
0.30
0.35
0.40
1−specificity
sensitivity
SKR
SC
SAIC
SBIC
ANOVA
(a)
0.00
0.05
0.10
0.15
0.20
0.25
0.30
0.00
0.05
0.10
0.15
0.20
0.25
0.30
V R
FDR
SKR
SC
SAIC
SBIC
ANOVA
(b)
0.000
0.005
0.010
0.015
0.020
0.025
0.030
0.05
0.10
0.15
0.20
0.25
0.30
1−specificity
sensitivity
SKR
SC
SAIC
SBIC
ANOVA
(c)
0.00
0.05
0.10
0.15
0.20
0.25
0.30
0.00
0.05
0.10
0.15
0.20
0.25
0.30
V R
FDR
SKR
SC
SAIC
SBIC
ANOVA
(d)
Figure 2.7
Genotype-by-time interaction Test: Results for the non-normal
Data.
Left: ROC curves corresponding to the ﬁve standard
analysis methods for testing interaction between genotype and
time when 10% of the genes are non-null and errors follow a
Normal distribution (a) or t-distribution with ﬁve degrees of
freedom (c). Each ROC curve was averaged over 50 simulated
data sets.
Right: The average actual false positive fraction
(V/R) vs. the average estimated FDR level ( d
FDR) correspond-
ing to the ﬁve standard analysis methods for testing interaction
between genotype and time when 10% of the genes are non-null
and errors follow a Normal distribution (b) or t-distribution
with ﬁve degrees of freedom (d). Each curve was averaged over
50 simulated data sets.

65
0.00
0.05
0.10
0.15
0.20
0.0
0.1
0.2
0.3
0.4
0.5
1−specificity
sensitivity
SKR
SC
SAIC
SBIC
ANOVA
0.0
0.2
0.4
0.6
0.8
1.0
0.0
0.2
0.4
0.6
0.8
1.0
V R
FDR
SKR
SC
SAIC
SBIC
ANOVA
0.00
0.05
0.10
0.15
0.20
0.0
0.1
0.2
0.3
0.4
0.5
1−specificity
sensitivity
SKR
SC
SAIC
SBIC
ANOVA
0.0
0.2
0.4
0.6
0.8
1.0
0.0
0.2
0.4
0.6
0.8
1.0
V R
FDR
SKR
SC
SAIC
SBIC
ANOVA
Figure 2.8
Genotype Test: Results for the Missing Data. Left: ROC curves
corresponding to the ﬁve standard analysis methods for testing
genotype main eﬀects when 10% of the genes are non-null and
no data are missing (top) or three microarray chips are miss-
ing (bottom). Each ROC curve was averaged over 50 simulated
data sets.
Right: The average actual false positive fraction
(V/R) vs. the average estimated FDR level ( d
FDR) correspond-
ing to the ﬁve standard analysis methods for testing genotype
main eﬀects when 10% of the genes are non-null and no data are
missing (top) or three microarray chips are missing (bottom).
Each curve was averaged over 50 simulated data sets.

66
0.00
0.05
0.10
0.15
0.20
0.0
0.1
0.2
0.3
0.4
1−specificity
sensitivity
SKR
SC
SAIC
SBIC
ANOVA
0.0
0.2
0.4
0.6
0.8
1.0
0.0
0.2
0.4
0.6
0.8
1.0
V R
FDR
SKR
SC
SAIC
SBIC
ANOVA
Figure 2.8
(Continued)
Genotype Test: Results for the Missing Data. Left: ROC curves corresponding to the ﬁve
standard analysis methods for testing genotype main eﬀects when 10% of the genes are non-
null and random eight observations are missing for every gene. Each ROC curve was averaged
over 50 simulated data sets. Right: The average actual false positive fraction (V/R) vs. the
average estimated FDR level ( d
FDR) corresponding to the ﬁve standard analysis methods for
testing genotype main eﬀects when 10% of the genes are non-null and random eight observations
are missing for every gene. Each curve was averaged over 50 simulated data sets.

67
0.00
0.01
0.02
0.03
0.04
0.05
0.06
0.2
0.3
0.4
0.5
0.6
0.7
1−specificity
sensitivity
SKR
SC
SAIC
SBIC
ANOVA
0.0
0.1
0.2
0.3
0.4
0.5
0.0
0.1
0.2
0.3
0.4
0.5
V R
FDR
SKR
SC
SAIC
SBIC
ANOVA
0.00
0.01
0.02
0.03
0.04
0.05
0.06
0.2
0.3
0.4
0.5
0.6
0.7
1−specificity
sensitivity
SKR
SC
SAIC
SBIC
ANOVA
0.0
0.1
0.2
0.3
0.4
0.5
0.0
0.1
0.2
0.3
0.4
0.5
V R
FDR
SKR
SC
SAIC
SBIC
ANOVA
Figure 2.9
Time Test: Results for the Missing Data. Left: ROC curves
corresponding to the ﬁve standard analysis methods for testing
time main eﬀects when 10% of the genes are non-null and no
data are missing (top) or three microarray chips are missing
(bottom).
Each ROC curve was averaged over 50 simulated
data sets.
Right: The average actual false positive fraction
(V/R) vs. the average estimated FDR level ( d
FDR) correspond-
ing to the ﬁve standard analysis methods for testing time main
eﬀects when 10% of the genes are non-null and no data are miss-
ing (top) or three microarray chips are missing (bottom). Each
curve was averaged over 50 simulated data sets.

68
0.00
0.01
0.02
0.03
0.04
0.05
0.06
0.1
0.2
0.3
0.4
0.5
0.6
1−specificity
sensitivity
SKR
SC
SAIC
SBIC
ANOVA
0.0
0.1
0.2
0.3
0.4
0.5
0.0
0.1
0.2
0.3
0.4
0.5
V R
FDR
SKR
SC
SAIC
SBIC
ANOVA
Figure 2.9
(Continued)
Time Test: Results for the Missing Data. Left: ROC curves corresponding to the ﬁve standard
analysis methods for testing time main eﬀects when 10% of the genes are non-null and random
eight observations are missing for every gene. Each ROC curve was averaged over 50 simulated
data sets. Right: The average actual false positive fraction (V/R) vs. the average estimated
FDR level ( d
FDR) corresponding to the ﬁve standard analysis methods for testing time main
eﬀects when 10% of the genes are non-null and random eight observations are missing for every
gene. Each curve was averaged over 50 simulated data sets.

69
0.000
0.005
0.010
0.015
0.020
0.025
0.030
0.10
0.15
0.20
0.25
0.30
0.35
0.40
1−specificity
sensitivity
SKR
SC
SAIC
SBIC
ANOVA
0.00
0.05
0.10
0.15
0.20
0.25
0.30
0.00
0.05
0.10
0.15
0.20
0.25
0.30
V R
FDR
SKR
SC
SAIC
SBIC
ANOVA
0.000
0.005
0.010
0.015
0.020
0.025
0.030
0.05
0.10
0.15
0.20
0.25
0.30
0.35
1−specificity
sensitivity
SKR
SC
SAIC
SBIC
ANOVA
0.00
0.05
0.10
0.15
0.20
0.25
0.30
0.00
0.05
0.10
0.15
0.20
0.25
0.30
V R
FDR
SKR
SC
SAIC
SBIC
ANOVA
Figure 2.10
Genotype-by-time Interaction Test: Results for the Missing
Data. Left: ROC curves corresponding to the ﬁve standard
analysis methods for testing interaction between genotype and
time when 10% of the genes are non-null and no data are
missing (top) or three microarray chips are missing (bottom).
Each ROC curve was averaged over 50 simulated data sets.
Right: The average actual false positive fraction (V/R) vs.
the average estimated FDR level ( d
FDR) corresponding to the
ﬁve standard analysis methods for testing interaction between
genotype and time when 10% of the genes are non-null and no
data are missing (top) or three microarray chips are missing
(bottom). Each curve was averaged over 50 simulated data
sets.

70
0.000
0.005
0.010
0.015
0.020
0.025
0.030
0.00
0.05
0.10
0.15
0.20
0.25
1−specificity
sensitivity
SKR
SC
SAIC
SBIC
ANOVA
0.00
0.05
0.10
0.15
0.20
0.25
0.30
0.00
0.05
0.10
0.15
0.20
0.25
0.30
V R
FDR
SKR
SC
SAIC
SBIC
ANOVA
Figure 2.10
(Continued)
Genotype-by-time Interaction Test: Results for the Missing Data. Left: ROC curves corre-
sponding to the ﬁve standard analysis methods for testing interaction between genotype and
time when 10% of the genes are non-null and random eight observations are missing for every
gene. Each ROC curve was averaged over 50 simulated data sets. Right: The average actual
false positive fraction (V/R) vs. the average estimated FDR level ( d
FDR) corresponding to the
ﬁve standard analysis methods for testing interaction between genotype and time when 10% of
the genes are non-null and random eight observations are missing for every gene. Each curve
was averaged over 50 simulated data sets.

71
CHAPTER 3.
Bayesian Analysis of Microarray Experiments with
Multiple Sources of Variation: A Mixed Model Approach
Cumhur Yusuf Demirkale, Tapabrata Maiti, and Dan Nettleton
Abstract: Some microarray experiments have complex experimental designs that call for
modeling of multiple sources of variation through the inclusion of multiple random factors.
While large amounts of data on thousands of genes are collected in these experiments, the
sample size for each gene is usually small. Therefore, in a classical gene-by-gene mixed linear
model analysis, there will be very few degrees of freedom to estimate the variance components
of all random factors considered in the model and low statistical power for testing ﬁxed eﬀects
of interest. To address these challenges, we propose a hierarchical Bayesian modeling strategy
to account for important experimental factors and complex correlation structure among the
expression measurements for each gene. We use half-Cauchy priors for the standard deviation
parameters of the random factors with few eﬀects. We rank genes with respect to evidence
of diﬀerential expression across the levels of a factor of interest by calculating a single sum-
mary statistic per gene from the posterior distribution of the treatment eﬀects considered in
the model. Simulation shows that our hierarchical Bayesian approach is much better than a
traditional gene-by-gene mixed linear model analysis at distinguishing diﬀerentially expressed
genes from non-diﬀerentially expressed genes.
KEY WORDS: Hierarchical Model; Linear Mixed Models; Markov chain Monte Carlo.
3.1
Introduction
Microarray technology provides a means for simultaneously measuring the abundance of
thousands of mRNA transcripts in multiple biological samples. These measurements are used

72
to detect diﬀerentially expressed genes over diﬀerent experimental conditions, time points,
tissue samples, etc.
Many statistical methods for identifying diﬀerentially expressed genes
have been proposed in the statistics literature in recent years.
One popular strategy involves conducting a linear mixed model analysis for each of thou-
sands of genes. The basic approach was ﬁrst proposed by Wolﬁnger et al. (2001) and has been
applied in various forms by many researchers. The use of mixed linear modeling is convenient
because such models allow for a natural and principled accounting for multiple sources of vari-
ation. Because all the observations from a single microarray slide or chip share the same levels
of all factors in a microarray experiment, the same experimental design applies to every gene.
Thus, it is customary to ﬁt the same linear mixed model for each gene. The common model
is ﬁt separately to the data from each gene to allow model parameters to be gene-speciﬁc.
Tests for ﬁxed eﬀects of interest are carried out for each gene, and some correction for multiple
testing is employed to help focus attention on the most relevant results.
False Discovery Rate (FDR) has become the most common error measure to control or
estimate when declaring genes to be diﬀerentially expressed. FDR was ﬁrst introduced by
Benjamini and Hochberg (1995) and is formally deﬁned as E(Q) where Q is the proportion of
mistakenly rejected null hypotheses among all rejected null hypotheses or 0 if no hypotheses
are rejected. Among many other approaches, Storey and Tibshirani’s (2003) method for FDR
estimation has become a popular procedure that is less conservative than the original proposal
of Benjamini and Hochberg.
Some microarray experiments have complex experimental designs that call for modeling of
multiple sources of variation through the inclusion of multiple random factors. While large
amounts of data on thousands of genes are collected in these experiments, the sample size for
each gene is usually small. Therefore, in a classical gene-by-gene mixed linear model analysis,
there will be very few degrees of freedom to estimate the variance components of all random
factors considered in the model and low statistical power for testing ﬁxed eﬀect(s) of interest.
To address these challenges, in this article we propose a hierarchical Bayesian modeling
strategy to account for important experimental factors and complex correlation structure

73
among the expression measurements for each gene. Our method estimates treatment eﬀects
in the model with fully Bayesian approaches by Markov Chain Monte Carlo (MCMC). We
use half-Cauchy priors for the standard deviation parameters of the random factors with few
eﬀects. We rank genes with respect to evidence of diﬀerential expression across the levels of a
factor of interest by calculating a single summary statistic per gene from the posterior distri-
bution of the treatment eﬀects considered in the model. Simulation shows that our hierarchical
Bayesian approach is much better than a traditional gene-by-gene mixed linear model analysis
at distinguishing diﬀerentially expressed genes from non-diﬀerentially expressed genes.
This paper is organized as follows.
In Section 3.2, we introduce the motivating barley
microarray experiment and gene-by-gene linear mixed model analysis. Section 3.3 proposes a
hierarchical model for the microarray experiment and discusses in detail the choice of prior
distribution, and explains Bayesian inference for the factor(s) of interest. In Section 3.4, we
compare the performance of the classical gene-by-gene linear mixed model analysis with the
hierarchical Bayesian analysis through diﬀerent simulation scenarios. In Section 3.5, we apply
hierarchical Bayesian analysis to the barley data set, and Section 3.6 gives a few concluding
comments and explains the future direction of this research.
3.2
Example: Gene Expression in Barley
Caldo, Nettleton and Wise (2004) conducted a microarray experiment to identify barley
genes that play a role in resistance to a fungal pathogen. To illustrate our methods, we describe
the analysis of a subset of the data they considered.
3.2.1
Data
Two genotypes of barley seedlings, one resistant and one susceptible to a fungal pathogen,
were grown in separate trays randomly positioned in a growth chamber. Each tray contained
six rows of 15 seedings each. The six rows in each tray were randomly assigned to six tissue
collection times: 0, 8, 16, 20, 24, and 32 hours after fungal inoculation. After simultaneously
inoculating plants with the pathogen, each row of plants was harvested at its randomly assigned

74
time. One Aﬀymetrix GeneChip was used to measure gene expression in the plant material
from a pool of the 15 seedlings in each row. The entire process was independently repeated a
total of three times, yielding data on 22,840 probe sets (corresponding to barley genes) for each
of the 36 GeneChips (2 genotypes × 6 time points × 3 replications). Note that the complete
experiment involved a third barley genotype as well as a second infection type, but we focus
on the reduced data set here to simplify the presentation of our main ideas. The expression
levels in the reduced data were log-transformed and median centered before an analysis was
performed.
3.2.2
Linear Mixed Model Analysis of the Barley Data
The design of the experiment can be viewed as split-plot with replications as blocks, trays
as whole plots and rows of seedlings as split plots. Note that although time is a factor in this
experiment, this is not a repeated-measures design because no one plant or pool of plants is
measured at multiple time points. Instead, because the measurement process is destructive,
diﬀerent randomly selected plants are sampled at each time. Therefore the following linear
mixed model corresponding to the split-plot design was considered as a base model for each
gene. Let
Yijk = µ + γj + τk + θjk + αi + βij + δik + ǫijk
(3.1)
i = 1, 2, 3; j = 1, 2; k = 1, . . . , 6;
where Yijk is the observed intensity of a gene at the kth harvesting time for the jth genotype
during the ith replication, γj is the ﬁxed genotype eﬀect, τk is the ﬁxed tissue collection time
eﬀect, θjk is the genotype-by-time interaction eﬀect, αi ∼NID(0, σ2
α) is the random replica-
tion eﬀect, βij ∼NID(0, σ2
β) is the replication-by-genotype interaction eﬀect (corresponding to
trays) , δik ∼NID(0, σ2
δ) is the replication-by-time interaction eﬀect, and ǫijk ∼NID(0, σ2
ǫ )
is the error (NID=Normally and Independently Distributed).
Though not standard for a
split-plot design, the replication-by-time interaction eﬀects were included to account for the
possibility of variation across harvest events; one random eﬀect was included for each combi-
nation of replication and time so that the two observations for the two samples (one of the

75
each genotype) collected at any one time in any one replication were allowed to be correlated
due to the shared replication-by-time random eﬀect. All the random eﬀects are assumed to be
jointly independently distributed and to be independent of the residual errors.
For each gene, this linear mixed model was ﬁt to the 36 log-scale measures of expression by
the SAS PROC MIXED procedure. In this experiment, scientists were interested in identifying
barley genes that play a role in resistance to the fungal pathogen. Such genes were expected
to show patterns of expression over time that diﬀered between the two genotypes. Therefore,
the hypothesis test for interaction between genotype and time was considered to be of primary
importance for each linear mixed model analysis, though tests for genotype main eﬀects and
time main eﬀects were conducted also. When the Restricted Maximum Likelihood (REML)
method was used to estimate the variance components, the Kenward-Roger (KR) method
(Kenward and Roger, 1997) was used to determine the denominator degrees of freedom and
F-statistics for test of ﬁxed eﬀects. Applying the method of Storey and Tibshirani (2003) to
obtain nominal control of FDR at 1% yielded a total of 399 genes for the test of genotype
eﬀect, 13202 genes for the test of time eﬀect, and 93 genes for the test of interaction between
genotype and time.
For each of the 22,840 genes, SAS PROC MIXED also produced REML estimates of the
three variance components corresponding to three random factors. The variance component
estimate for replication, replication-by-genotype, and replication-by-time was reported as zero
for a total of 8153, 7824, and 7235 genes, respectively. In other words, almost one third of
variance components for each random factor were estimated to be zero across all the genes in
the data set. Accounting the high variation in estimate of variance components due to small
sample size for each gene, the inference for ﬁxed treatment eﬀects is questionable under gene-
by-gene linear mixed model analysis. Therefore we need to consider the important practical
problem of conducting ﬁxed-eﬀects inference in linear mixed model analysis of microarray data
when there are very few degrees of freedom to estimate the variance components of all random
factors considered in the model.

76
3.3
Bayesian Hierarchical Analysis
We will start this section by introducing another possible linear mixed model for the barley
microrray data set. To borrow information across genes and to express the natural hierarchy
of the random factors considered in the design of the experiment, this model will be formalized
in a hierarchical setup. Later, we will introduce reasonable priors for the variance parameters
of the ﬁxed and the random factors considered in the model. Finally, we will deﬁne several
summary statistics for each gene. They can be used for ordering genes from most signiﬁcant
to least signiﬁcant with respect to a test of interest.
3.3.1
Hierarchical Model
The following model is an alternative linear mixed model, which also accounts for the ﬁxed
and the random eﬀects considered in the design of the Barley experiment.
Ygijk = µg + Rgi + RGgij + τgjk + ǫgijk
(3.2)
g = 1, . . . , N; i = 1, 2, 3; j = 1, 2; k = 1, . . . , 6.
where Ygijk is the observed intensity of gene g at the kth harvesting time for jth genotype during
ith replication, µg ∼NID(0, α2
g) is the mean for gene g, Rgi ∼NID(0, β2
g) is the replication
eﬀect, RGgij ∼NID(0, δ2
g) is the replication-by-genotype interaction, τgjk ∼NID(0, θ2
g) is
the genotype-by-time interaction. All these random eﬀects are assumed to be independently
distributed from each other and the residual-error components ǫgijk ∼NID(0, σ2
g). We can
rewrite this model as sum of two parts: the hierarchical random eﬀects part and the ﬁxed
treatment eﬀects part.
Ygijk = µ(0)
gijk + ǫ(0)
gijk
µ(0)
gijk = µ(1)
gij + τgjk
µ(1)
gij = µ(2)
gi + ǫ(1)
gij
(3.3)

77
µ(2)
gi = µ(3)
g
+ ǫ(2)
gi
µ(3)
g
= µ + ǫ(3)
g
where ǫ(0)
gijk ∼N(0, σ2
g) is the residual-error components, τgjk ∼N(0, θ2
g) is the genotype-by-
time interaction, ǫ(1)
gij ∼N(0, δ2
g) is the replication-by-genotype interaction, ǫ(2)
gi ∼N(0, β2
g) is
the replication eﬀect, ǫ(3)
g
∼N(0, α2
g) is the gene eﬀect, and µ ∼N(0, K) is the overall mean.
3.3.2
Prior Speciﬁcation
A full Bayesian analysis requires introducing prior distributions on model parameters to
express uncertainty about their values, combining these with the data to obtain posterior
distributions, and drawing inference based on the posterior samples. Several kinds of priors for
the mean and variance of a normal distribution have been studied in the literature, including
the non informative improper prior and the conjugate prior.
Several non informative prior distributions have been suggested for scale parameters in
Bayesian literature.
Among all, two commonly-considered improper densities are inverse-
gamma(ǫ,ǫ), as ǫ →0, and uniform(0,κ), as κ →∞.
But these priors do not necessarily
lead to proper posterior distributions in some cases for hierarchical models. When ǫ →0,
the inverse-gamma(ǫ,ǫ) prior yields an improper density. Thus, ǫ must be set to a reasonable
value. In datasets where the standard deviation parameter is estimated to be near zero, the
posterior inferences are sensitive to ǫ under this prior speciﬁcation. The uniform(0,κ) model
yields a limiting proper posterior density as κ →∞, as long as the number of eﬀects of the
corresponding random factor is at least 3 (Gelman 2006).
If the number of eﬀects of the
random factor is smaller than 3, this non informative prior can lead to an improper posterior
or a proper posterior with an unrealistically broad range. In datasets where random factors
with large numbers of eﬀects and for a ﬁnite but suﬃciently large κ, inferences are not sensitive
to the choice of κ.
For hierarchical standard deviation parameters, Gelman(2006) illustrated that the choice

78
of non informative prior distribution can have a big eﬀect on inferences when the number
of eﬀects of the random factor is small or the variance component of the random factor is
close to zero. Our prior choice for the variance parameter of each random factor in the model
is based on the distribution of REML estimates of the variance components from the linear
mixed model analysis described in Section 3.2.2. Under that analysis, the variance component
for replication, replication-by-genotype, and replication-by-time was estimated zero for a total
of 8153, 7824, and 7235 genes, respectively and the standard deviation parameter of residual
error is estimated substantially greater than zero for all the genes. Note also that there were
only three replications and two genotypes in the barley experiment. These results imply that
we should not consider an inverse-gamma or uniform prior for the variance parameters of the
replication and replication-by-genotype random factors in our hierarchical model.
As an alternative to these two non informative priors, Gelman (2006) proposed a folded-
noncentral-t family of conditionally conjugate priors when the number of eﬀects of the random
factor is small or the random factor variance is close to zero. These distributions are simply a
ratio of the absolute value of a normal random variable and the square root of a gamma random
variable. This family of distributions has many special cases. For example, when restricting
mean of the normal distribution to zero, the distribution becomes simply a half-t, that is,
the absolute value of a Student-t distribution centered at zero. Further, if the denominator
degrees of freedom equals 1, it becomes the half-Cauchy distribution. This very special prior is
more ﬂexible and has better behavior near zero compared to the inverse-gamma prior. Thus,
a half-Cauchy prior distribution with a peak at zero and scale equal to a constant A was used
for the standard deviation parameters of the replication and replication-by-genotype random
factors. For computational consistency, we also consider similar half-Cauchy prior distribution
as a prior for the standard deviation parameter of the gene eﬀects.
A non informative inverse-gamma was taken as a prior distribution for the variance param-
eter of the residual error because this prior distribution leads to posterior conjugacy, which
makes the computations more eﬃcient. For some genes, variation due to genotype-by-time
eﬀects is assumed to be close to zero. As discussed before, it is not appropriate to consider an

79
inverse-gamma prior for the variance parameter of this factor. As suggested in Gelman (2006),
we used a positive uniform distribution on (0, κ) for the standard deviation parameter of the
genotype-by-time factor.
Finally, the following equations summarize the formulation of the priors for the standard
deviation or variance parameters,
• Gene eﬀects: αg ∼Half −Cauchy(0, A1)
• Replication eﬀects: βg ∼Half −Cauchy(0, A2)
• Replication-by-genotype eﬀects: δg ∼Half −Cauchy(0, A3)
• Genotype-by-time eﬀects: θg ∼Unif(0, κ)
• Error variance: σ2
g ∼Inv −Gamma(a, b)
We set diﬀerent values for the hyper-parameters A1, A2, A3, κ, a, and b in a simulation study,
which showed that the ranking of the genes is not aﬀected. Therefore, any reasonable values
from data can be used for these hyper-parameters.
3.3.3
Inference
The aim of the barley experiment is to identify genes showing diﬀerent time patterns over
two genotypes. We would also like to identify signiﬁcantly diﬀerentially expressed genes with
respect to genotype eﬀect and time eﬀect. We proposed four diﬀerent statistics to order the
genes from the most signiﬁcant to the least signiﬁcant with respect to these ﬁxed eﬀects. They
are calculated by a similar formula of the classical F statistic.
For gene g, let τg be twelve a dimensional treatment vector corresponding to the combi-
nations of two genotypes and six time points. By using the hierarchical model and the prior
distributions, WinBUGS or some other software can be used to generate M realizations from
the posterior distributions of each of the twelve components, τgjk. For each gene, each statistic
is calculated by using the posterior sample (τ (1)
g , τ (2)
g , . . . , τ (M)
g
).
For gene g, the following are deﬁnitions of the four statistics:

80
1.
F1 = (C ¯τg)
′ h
C ˆΣgC
′i−1 (C ¯τg)
(3.4)
where
• ¯τg is the average vector over (τ (1)
g , τ (2)
g , . . . , τ (M)
g
).
• ˆΣg is the sample variance-covariance matrix estimate over (τ (1)
g , τ (2)
g , . . . , τ (M)
g
).
• C is the contrast vector or matrix. For testing genotype eﬀect, vector C is deﬁned
as
C = [1, 1, 1, 1, 1, 1, −1, −1, −1, −1, −1, −1]
When testing for time eﬀect, C matrix is deﬁned to be
C =


1
−1
0
0
0
0
1
−1
0
0
0
0
0
1
−1
0
0
0
0
1
−1
0
0
0
0
0
1
−1
0
0
0
0
1
−1
0
0
0
0
0
1
−1
0
0
0
0
1
−1
0
0
0
0
0
1
−1
0
0
0
0
1
−1


and for the test of genotype-by-time interaction, C matrix is deﬁned as
C =


1
−1
0
0
0
0
−1
1
0
0
0
0
1
0
−1
0
0
0
−1
0
1
0
0
0
1
0
0
−1
0
0
−1
0
0
1
0
0
1
0
0
0
−1
0
−1
0
0
0
1
0
1
0
0
0
0
−1
−1
0
0
0
0
1


2.
F2 = (C ˜τg)
′ h
C ˆΣgC
′i−1 (C ˜τg)
(3.5)
where
• ˜τg is the median vector over (τ (1)
g , τ (2)
g , . . . , τ (M)
g
).

81
• ˆΣg and C are the same as before.
3.
F3 = 1
n
n
X
i=1
F (i)
(3.6)
where
•
F (i) = (Cτ (i)
g )
′ h
C ˆΣgC
′i−1 (Cτ (i)
g )
• ˆΣg and C are the same as before.
4.
F4 = median

F (i), i = 1, . . . , n

(3.7)
where F (i), C, and ˆΣg are the same as before.
After calculating F1, . . . , F4, any of these statistics can be used to order genes. For example,
we can employ F4 to identify highly diﬀerentially expressed genes with respect to genotype
eﬀect. The gene with the largest F4 value is declared to be the most signiﬁcant gene with
respect to genotype eﬀect. In the following section, we will use ROC curves to compare the
power of these statistics for ordering genes with respect to eﬀects of interest.
3.4
Simulation
Two data sets, each having one thousand genes, were simulated by using the linear mixed
model (3.1) described in Section 3.2. We tried to mimic the original barley data when gen-
erating both data sets. Therefore, the ﬁrst step in data generation was to select a set of one
thousand genes randomly from the original barley data set. These genes were analyzed by ﬁt-
ting the linear mixed model (3.1) separately for each gene and estimating variance components
for random factors (replication, replication-by-genotype, and replication-by-time) in the model
by the REML method. Later, these variance component estimates were used for generating
data from the random part of the linear mixed model for each gene in the simulated data set.

82
3.4.1
Simulation 1
For the ﬁrst simulated data set, we chose a list of one thousand genes randomly in a
way that variance component estimates for all three random factors were nonzero for each
gene in this list. We start generating data for these genes by using the random part of the
linear mixed model (3.1). Random eﬀects for a gene were simulated by sampling from Normal
distributions with mean zero and variance equal to the variance component estimate of the
corresponding random factor for that gene from the original barley data. Residual errors were
generated similarly by using the variance estimates of the residual error. After simulating
from the random part of the model (3.1) for each of the one thousand genes, ten percent of
the genes were set to have ﬁxed treatment eﬀects. Therefore, a set of hundred genes were
selected randomly among previously chosen one thousand genes. For those hundred genes,
intensities were changed by adding ﬁxed treatment eﬀects, which were the twelve genotype-
by-time interaction means of the corresponding gene from the original barley data.
After
simulation, the data set was analyzed by two methods: the analysis by ﬁtting the generating
linear mixed model for each gene independently and the analysis by ﬁtting the hierarchical
Bayesian model described in the previous section.
We used the SAS PROC MIXED procedure to ﬁt the full mixed linear model 3.1 for each
gene independently. Variance components were estimated under REML method, and the KR
method was set to determine the denominator degrees of freedom and F-statistics for the
test of ﬁxed eﬀects. By applying the method of Storey and Tibshirani (2003), the number
of signiﬁcant genes with respect to ﬁxed eﬀects are reported in Table 3.1 at four nominal
control levels of False Discovery Rate (FDR). For example, when FDR is controlled under 0.1,
twenty ﬁve genes are declared to have signiﬁcant genotype eﬀect. Sixteen of these genes are
correctly identiﬁed (Table 3.2). Controlling the FDR at same nominal level, ﬁfty seven genes
are declared to be signiﬁcant for changing expression levels over time. Fifty six of them are
correctly identiﬁed (Table 3.2). Twenty one genes are declared to have signiﬁcantly diﬀerent
time patterns over two genotypes. Nineteen of them were correctly identiﬁed for signiﬁcant
interaction between genotype and time (Table 3.2).

83
The ﬁrst simulated data set was also analyzed by ﬁtting the hierarchical Bayesian model
described in Section 3.3. Four statistics (3.4, 3.5, 3.6, and 3.7) were calculated for each gene by
using the posterior distribution of each treatment eﬀect. Genes were ordered for signiﬁcance
with respect to genotype, time, and genotype-by-time eﬀects by using the values of F1, F2, F3,
or F4. Table 3.2 reports the number of correctly identiﬁed genes under hierarchical Bayesian
analysis when F4 is used for ranking the genes. For example, all of the most signiﬁcant 25
genes with respect to genotype eﬀect were correctly identiﬁed. Similarly, 55 genes among the
most signiﬁcant 57 genes with respect to time eﬀect, have true time eﬀect, and 20 out of top
21 genes with the highest F4 value for interaction eﬀect, were correctly identiﬁed for having
true diﬀerent time patterns over two genotypes. If we looked at the most signiﬁcant 100 genes
under both analyses, the hierarchical Bayesian method identiﬁes many more signiﬁcant genes
correctly than the classical mixed linear model analysis (Table 3.2). For example, when testing
for genotype eﬀect, the classical mixed linear model analysis identiﬁed 30 genes correctly among
the most signiﬁcant 100 genes whereas the hierarchical Bayesian analysis identiﬁed sixty ﬁve
genes correctly among the most signiﬁcant 100 genes. These sixty ﬁve genes includes all of
the 30 genes, which were correctly identiﬁed by the classical mixed linear analysis.
These
observations imply that the hierarchical Bayesian approach will be superior to a traditional
full linear mixed model analysis with regard to identiﬁcation of diﬀerentially expressed genes.
Formally, we can use receiver operator characteristic (ROC) curves to compare the eﬀec-
tiveness of the methods for separating diﬀerentially and non-diﬀerentially expressed genes. The
p-values produced by each method provide a rank order of genes from most evidence for diﬀer-
ential expression to least evidence. The quality of the ranking varies from method to method
and can be judged by comparing ROC curves. The greater the area under an ROC curve the
better the corresponding method is at distinguishing null genes from non-null genes. In Fig-
ure 3.7 and Figure 3.7, we observe that hierarchical Bayesian analysis with F4 statistic has the
highest power for separating diﬀerentially and non diﬀerentially expressed genes with respect
to the genotype eﬀect and the genotype-by-time interaction, respectively. For genotype, time,
and interaction eﬀects, the hierarchical Bayesian analysis with F1 and F3 statistics produced

84
the same rank order of genes. As a last observation, we should also mention that the simulated
data set was analyzed by ﬁtting the true generating linear mixed model for each gene under
the classical approach. But the hierarchical Bayesian analysis provided much better rank order
of the genes with respect to genotype, time, and interaction eﬀects (Figures 3.7, 3.7, and 3.7).
3.4.2
Simulation 2
In classical gene-by-gene mixed linear analysis of the original barley data set in Section 3.2,
the variance components of some random factors were estimated to be zero under the REML
method for many genes.
Based on this observation, we assumed that the true underlying
random part of the model (3.1) may diﬀer from gene to gene, and totally, 23 = 8 versions
of the model (3.1) can be considered for the barley data set.
Therefore, when generating
the second data set, we try to mimic the original barley data set by allowing some variance
components to be zero for some genes.
Similar to ﬁrst simulation, a random set of one thousand genes were chosen from the original
barley data set such that not all the variance component estimates were nonzero for some genes
in that list. All eight models were equally represented in this simulation. In other words, under
each of the eight models, data for 125 genes were generated, respectively. Random eﬀects and
residual errors were simulated similar to ﬁrst simulated data set. Again we let only 10 percent
of the genes to have ﬁxed treatment eﬀects. After generating the data set, it is also analyzed
by the classical linear mixed model approach and the hierarchical Bayesian modeling approach.
Similar to analysis of the ﬁrst data set, we used the SAS PROC MIXED procedure to ﬁt
the full linear mixed model (3.1) for each gene in this data set. Variance components were
estimated under REML method, and the KR method was set to determine the denominator
degrees of freedom and F-statistics for the test of ﬁxed eﬀects. Again by applying the method
of Storey and Tibshirani (2003), the number of signiﬁcant genes with respect to ﬁxed eﬀects
are determined for four nominal control levels of FDR (Table 3.3). For example, when FDR is
controlled under 0.1, twenty genes are declared to have signiﬁcant genotype eﬀect. Fourteen of
these genes are correctly identiﬁed with the true genotype eﬀect by this analysis (Table 3.4).

85
Controlling the FDR at the same nominal level, forty six genes are declared to be signiﬁcant
for changing expression levels over time, and thirty eight genes are declared to have signiﬁcant
interaction between genotype and time (Table 3.4). Again in this analysis, forty four genes
among the most signiﬁcant 46 genes were correctly identiﬁed with the true time eﬀect, and
twenty six genes among the most signiﬁcant 38 genes were correctly identiﬁed with the true
interaction eﬀect (Table 3.4).
We also analyzed the second simulated data set with the hierarchical Bayesian model
described in Section 3.3. Four (3.4, 3.5, 3.6, and 3.7) statistics were calculated for each gene
by using the posterior distribution of each treatment eﬀect. Genes were ordered for signiﬁcance
with respect to genotype, time, and interaction eﬀects by using the values of F1, F2, F3, or
F4. Table 3.4 reports the number of correctly identiﬁed genes under hierarchical Bayesian
analysis when F4 is used for ranking the genes. For example, all of the of the most signiﬁcant
20 genes with respect to genotype eﬀect were correctly identiﬁed with the true genotype eﬀect.
Similarly, 42 genes among the most signiﬁcant 46 genes with respect to time eﬀect were truly
diﬀerentially expressed, and 31 genes among the most signiﬁcant 38 genes with interaction eﬀect
were correctly identiﬁed for having diﬀerent time patterns over two genotypes (Table 3.4).
If we looked at the most signiﬁcant 100 genes under both analyses, the hierarchical Bayesian
method identiﬁed many more signiﬁcant genes correctly than the classical mixed linear model
analysis (Table 3.4). For example, when testing for genotype eﬀect, the classical mixed linear
model analysis identiﬁed 31 genes correctly whereas the hierarchical Bayesian analysis identiﬁed
61 genes correctly.
These 65 genes includes 26 of the the 31 genes, which were correctly
identiﬁed by the classical analysis. Similarly, for genotype-by-time interaction, classical mixed
linear model analysis identiﬁed 37 genes correctly. Hierarchical mixed model analysis identiﬁed
54 genes correctly (Table 3.4). These observations show some evidence that the hierarchical
Bayesian approach provides a better order rank of the genes than the classical mixed linear
model analysis of ﬁtting the same model for every gene.
We also used ROC curves to compare the power of the method for distinguishing diﬀeren-
tially and non diﬀerentially expressed genes with respect to ﬁxed eﬀects. In Figures 3.7 – 3.7,

86
we plot ROC curves corresponding to the analysis by ﬁtting the true underlying linear mixed
model for each gene, the analysis by ﬁtting full linear mixed model (3.1), and the analysis with
the hierarchical Bayesian approach. In Figure 3.7 and Figure 3.7, we observe that hierarchi-
cal Bayesian analysis with the F4 statistic has the highest power to distinguish diﬀerentially
and non diﬀerentially expressed genes with respect to genotype eﬀect, and genotype-by-time
interaction, respectively. For all the ﬁxed eﬀects, hierarchical Bayesian analysis with F1 and
F3 statistics produced the same ordering for genes (Figures 3.7, 3.7, and 3.7). In addition,
both statistics have the best ranking of the genes with respect to time eﬀect (Figure 3.7). In
all ﬁgures, it can be concluded that an analysis by hierarchical Bayesian modeling with any
F statistic is better for rank ordering genes than the analysis by ﬁtting the same mixed linear
model for each gene or the analysis by ﬁtting the true underlying model for each gene.
3.4.3
Simulation 3
In simulation 1 and 2, our aim was to show that an analysis by hierarchical Bayesian
modeling is better than an analysis by ﬁtting the same mixed linear model for every gene
when ordering the genes with respect to a ﬁxed eﬀect.
In this simulation study, we will
discuss how to deal with the computational problems when analyzing thousands of genes in a
microarray data set by hierarchical Bayesian modeling.
A typical microarray data set includes thousands of genes. Due to memory restrictions,
it may not be possible to simulate from the posterior distribution of the treatment eﬀects of
interest for every gene in the whole data set at one time. To deal with this problem, we can
partition the whole data set into smaller data sets with reasonable number of genes so that it
will be feasible to generate samples from the posterior distributions of the treatment eﬀects of
interest. After applying the hierarchical Bayesian analysis to each partition data set separately,
we can combine the list of summary statistics (F values) for each partition data set into one
single ﬁle, and get the order of each gene in the whole data set.
In this simulation study, we will show that the signiﬁcance rank of a gene within the whole
data set does not depend on the other genes in its partition data set. In other words, we can

87
randomly assign the genes into the partition groups, and this will not change the ordering of
any gene within the whole data set. As an example, we considered the second simulated data
set. First, it was divided into 10 partial data sets randomly such that each was containing 100
genes. Then each partial data set was analyzed by hierarchical Bayesian approach separately.
Finally, summary F statistic for every gene in each partial data set were put together in a
single ﬁle. We repeated this procedure ﬁve times. As a sixth analysis, we again partitioned
the full data set into 10 partial data sets but this time, all the genes simulated with treatment
eﬀect were put in one partial group, and the other genes simulated without treatment eﬀect
were randomly partitioned into nine data sets. We have lists of F4 values from analyzing the
data in six diﬀerent partitioning and the list of F4 values by analysis without partitioning the
same data from simulation 2. In Tables 3.5 through 3.7, we report the correlations between
the seven lists of F4 values for genotype, time, and genotype-by-time interaction, respectively.
In each Table, correlation values are almost one. This shows that the order of the genes does
not depend on the way of partitioning when hierarchical Bayesian analysis is applied.
3.5
Application of the Hierarchical Bayesian Method to the Barley Data
Scientist were interested in identifying barley genes that play a role in resistance to a
fungal pathogen. Such genes are believed to have patterns of expression over time following
infection that diﬀer between susceptible and resistant genotypes. Therefore, we are particularly
interested in identifying genes that exhibit interaction between genotype and time. We also
provided results for the genotype test and the time test to show the performance of the discussed
methods in the previous sections.
Table 3.8 shows the number of genes identiﬁed as diﬀerentially expressed at nominal FDR
levels at 0.01 and 0.05 using the linear mixed model analysis that we introduced in Section 3.2.
For the genotype-by-time interaction test, the gene lists produced by the linear mixed model
and the hierarchical Bayesian method diﬀered from each other by 43 and 395 genes at nominal
control of FDR of 0.01 and 0.05, respectively. Similarly, for the genotype test, the gene lists
produced by the linear mixed model and the hierarchical Bayesian method diﬀered from each

88
other by 278 and 503 genes at nominal control of FDR of 0.01 and 0.05, respectively. Finally,
for the time test, the gene lists produced by the linear mixed model and the hierarchical
Bayesian method diﬀered from each other by 1046 and 1011 genes at nominal control of FDR
of 0.01 and 0.05, respectively.
3.6
Concluding Remarks
We have introduced a hierarchical Bayesian analysis method for discovering diﬀerentially
expressed genes when a microarray experiment involves multiple sources of variation through
the inclusion of multiple random factors. Since sample size is usually small for microarray
experiment, there will be very few degrees of freedom to estimate the variance components of
all random factors considered in the linear mixed model. But Hierarchical formulation allow
us to borrow strength across genes for making inference. The simulation studies show that our
hierarchical Bayesian approach is more powerful than a traditional gene-by-gene mixed linear
model analysis at distinguishing diﬀerentially expressed genes from non-diﬀerentially expressed
genes.
We have illustrated several advantages of working in Bayesian framework. It is shown that
posterior samples of model parameters are directly used to draw inference by forming functions
of these parameters. Another beneﬁt of the Bayesian approach is that the parameters for one
gene are estimated using the information of all genes in the data through the hierarchical
speciﬁcation. Finally, the Bayesian method will allow formal incorporation of the knowledge
through prior densities (Tadesse et al. (2003)).
Although the inverse-gamma prior distribution can be formalized as a non informative
prior for the standard deviation parameters of the random factors with few eﬀects, this condi-
tionally conjugate prior distribution yields an improper posterior density under some common
conditions in microarray experiments. As recommended in Gelman 2006, we used half-Cauchy
priors for the standard deviation parameters of the random factors. Under this prior elicitation,
posterior distribution of the treatment eﬀects of interest in our model ranged in reasonable
boundaries. By calculating a single summary statistic per gene from the posterior distribution

89
of the treatment eﬀects considered in the model, we rank genes with respect to evidence of
diﬀerential expression across the levels of a factor of interest.
Although our proposed methodology provides better ordering of the genes, further work
needs to be done in developing the next level of hierarchical models, in which we should be
able to estimate the false discovery rate to ﬁnd a reasonable cutoﬀpoint on the list.
3.7
References
Baldi, P. and Long, A. D. (2001). A Bayesian framework for the analysis of microarray expres-
sion data: regularized t-test and statistical inferences of gene changes. Bioinformatics,
17, 509-519.
Benjamini,Y., and Hochberg,Y. (1995). Controlling the false discovery Rate: a Practical and
Powerful Approach to Multiple Testing. Journal of the Royal Statistical Society, Series
B, 57, 289300.
Caldo, R. A., Nettleton, D., Wise, R. P. (2004). Interaction-dependent gene expression in
Mla-speciﬁed response to barley powdery mildew. The Plant Cell., 16, 2514-2528.
Feng, S., Wolﬁnger, R. D., Chu, M., Gibson, C., and McGraw, L. A. (2006). Empirical Bayes
Analysis of Variance Component Models for Microarray Data. Journal of Agricultural,
Biological, and Environmental Statistics, 11, 197-209.
Gelman, A. (2006). Prior distributions for variance parameters in hierarchical models. Bayesian
Analysis, 3, 515-533.
Gottardo, R., Raftery, A. E., Yeung, K. Y., and Bumgarner, R. E. (2006). Bayesian Ro-
bust Inference for Diﬀerential Gene Expression in Microarrays with Multiple Samples.
Biometrics, 62, 1018
Kenward, M. G. and Roger, J. H. (1997).
Small sample inference for ﬁxed eﬀects from
restricted likelihood. Biometrics, 53, 983-997.

90
Lewin, A., Richardson, S., Marshall, C., Glazier, A., and Aitman, T. (2006).
Bayesian
Modeling of Diﬀerential Gene Expression. Biometrics, 62, 1-9.
Lewin, A., Bochkina, N., and Richardson, S. (2007).
Fully Bayesian mixture model for
diﬀerential gene expression: simulation and model checks.
Statistical Applications in
Genetics and Molecular Biology, 6, 36.
Storey, J.D., and Tibshirani, R. (2003). Statistical signiﬁcance for genomewide studies. Proc.
Natl. Acad. Sci. USA, 100, 9440-9445.
Tadesse, M. G., Ibrahim, J. G., and Mutter, G. L. (2003). Identiﬁcation of Diﬀerentially Ex-
pressed Genes in High-Density Oligonucleotide Arrays Accounting for the Quantiﬁcation
Limits of the Technology. Biometrics, 59, 542-554.
Smyth, G. K. (2004). Linear models and empirical Bayes methods for assessing diﬀerential
expression in microarray experiments. Statistical Applications in Genetics and Molecular
Biology, 3, 3.
Wolﬁnger, R., Gibson, G.,Wolﬁnger, E., Bennett, L., Hamadeh, H., Bushel, P., Afshari, C.,
and Paules, R. (2001). Assessing Gene Signiﬁcance from cDNA Microarray Expression
Data via Mixed Models. Journal of Computational Biology, 8, 625637.

91
Table 3.1
MMA Results for the First Simulated Data.
The number of
genes declared to be non-null at diﬀerent nominal FDR levels.
Test
d
FDR <= 0.001
d
FDR <= 0.01
d
FDR <= 0.05
d
FDR <= 0.1
genotype
9
13
20
25
time
37
45
51
57
genotype-by-time
7
12
18
21
Table 3.2
MMA and HBA results for the First Simulated Data. MMA: The
number of correctly identiﬁed non-null genes under the linear
mixed model analysis. HBA: The number of correctly identiﬁed
non-null genes under the hierarchical Bayesian analysis with F4.
Common: The number of genes common to all the collections
of genes represented by MMA and HBA. Common Among Top
Genes: The number of genes common to MMA and HBA when
25, 100 genes are declared to be diﬀerentially expressed with
respect to genotype eﬀects; 57, 100 genes are declared to be dif-
ferentially expressed with respect time eﬀects; 21, 100 genes are
declared to be diﬀerentially expressed with respect genotype-by–
time interaction eﬀects.
Genotype
Time
Genotype-by-Time
Cut oﬀlevel from Top
25
100
57
100
21
100
MMA
16
30
56
64
19
41
Correctly
HBA
25
65
55
68
20
66
Identiﬁed
Common
15
30
55
63
14
39
Common Among Top Genes
15
35
55
83
14
55

92
Table 3.3
MMA Analysis Results for the Second Simulated Data.
The
number of genes declared to be non-null at diﬀerent nominal
FDR levels.
Test
d
FDR <= 0.001
d
FDR <= 0.01
d
FDR <= 0.05
d
FDR <= 0.1
genotype
3
9
12
20
time
22
25
35
46
genotype-by-time
8
16
19
38
Table 3.4
MMA and HBA results for the Second Simulated Data. MMA:
The number of correctly identiﬁed non-null genes under the
mixed linear model analysis.
HBA: The number of correctly
identiﬁed non-null genes under the hierarchical Bayesian analy-
sis with F4. Common: The number of genes common to all the
collections of genes represented by MMA and HBA. Common
Among Top Genes: The number of genes common to MMA
and HBA when 20, 100 genes are declared to be diﬀerentially
expressed with respect to genotype eﬀects; 46, 100 genes are de-
clared to be diﬀerentially expressed with respect time eﬀects; 38,
100 genes are declared to be diﬀerentially expressed with respect
genotype-by-time interaction eﬀects.
Genotype
Time
Genotype-by-Time
Cut oﬀlevel from Top
20
100
46
100
38
100
MMA
14
31
44
59
26
37
Correctly
HBA
20
61
42
66
31
54
Identiﬁed
Common
10
26
40
58
25
34
Common Among Top Genes
10
40
41
78
30
60

93
Table 3.5
Genotype Test: Correlations between F4 statistics corresponding
to six analyses corresponding to ﬁve diﬀerent way of partitioning
and no partitioning.
full
part1
part2
part3
part4
part5
part6
full
1.0000
0.9903
0.9813
0.9756
0.9831
0.9906
0.9809
part1
0.9903
1.0000
0.9900
0.9727
0.9897
0.9908
0.9866
part2
0.9813
0.9900
1.0000
0.9778
0.9729
0.9859
0.9822
part3
0.9756
0.9727
0.9778
1.0000
0.9434
0.9712
0.9782
part4
0.9831
0.9897
0.9729
0.9434
1.0000
0.9884
0.9747
part5
0.9906
0.9908
0.9859
0.9712
0.9884
1.0000
0.9866
part6
0.9809
0.9866
0.9822
0.9782
0.9747
0.9866
1.0000
Table 3.6
Time Test: Correlations between F4 statistics corresponding to
six analyses corresponding to ﬁve diﬀerent way of partitioning
and no partitioning.
full
part1
part2
part3
part4
part5
part6
full
1.0000
0.9990
0.9988
0.9974
0.9993
0.9990
0.9997
part1
0.9990
1.0000
0.9991
0.9980
0.9992
0.9991
0.9990
part2
0.9988
0.9991
1.0000
0.9968
0.9992
0.9985
0.9991
part3
0.9974
0.9980
0.9968
1.0000
0.9985
0.9990
0.9969
part4
0.9993
0.9992
0.9992
0.9985
1.0000
0.9994
0.9992
part5
0.9990
0.9991
0.9985
0.9990
0.9994
1.0000
0.9988
part6
0.9997
0.9990
0.9991
0.9969
0.9992
0.9988
1.0000

94
Table 3.7
Correlations between F4 statistics corresponding to six analyses
corresponding to ﬁve diﬀerent way of partitioning and no parti-
tioning.
full
part1
part2
part3
part4
part5
part6
full
1.0000
0.9977
0.9990
0.9979
0.9992
0.9987
0.9993
part1
0.9977
1.0000
0.9977
0.9992
0.9969
0.9984
0.9967
part2
0.9990
0.9977
1.0000
0.9986
0.9992
0.9990
0.9994
part3
0.9979
0.9992
0.9986
1.0000
0.9977
0.9989
0.9976
part4
0.9992
0.9969
0.9992
0.9977
1.0000
0.9990
0.9995
part5
0.9987
0.9984
0.9990
0.9989
0.9990
1.0000
0.9988
part6
0.9993
0.9967
0.9994
0.9976
0.9995
0.9988
1.0000
Table 3.8
Identifying Signiﬁcant Genes in the Barley Data Set. MMA: Lin-
ear mixed model analysis; HBA: Hierarchical Bayesian Analysis.
Table entries are the number of genes declared to be diﬀeren-
tially expressed. The bottom row of the table give the number
of genes common to all the collections of genes represented in
each column.
Genotype
Time
Genotype-by-Time
Method
d
FDR=0.01
d
FDR=0.05
d
FDR=0.01
d
FDR=0.05
d
FDR=0.01
d
FDR=0.05
MMA
399
782
13202
17832
93
933
HBA
399
782
13202
17832
93
933
Common
121
279
12156
16821
50
538

95
0.0
0.2
0.4
0.6
0.8
1.0
0.2
0.4
0.6
0.8
1.0
Genotype Test
1−specificity
sensitivity
MMA
F1
F2
F3
F4
Figure 3.1
Genotype Test:
ROC Curves for the First Simulated Data.
ROC curves corresponding to the ﬁve analysis methods for test-
ing genotype main eﬀects. MMA: the analysis by ﬁtting the
mixed linear model for each gene. F1, F2, F3, and F4: the anal-
ysis with hierarchical Bayesian model by calculating diﬀerent
summary statistics.

96
0.0
0.2
0.4
0.6
0.8
1.0
0.5
0.6
0.7
0.8
0.9
1.0
Time Test
1−specificity
sensitivity
MMA
F1
F2
F3
F4
Figure 3.2
Time Test: ROC Curves for the First Simulated Data. ROC
curves corresponding to the ﬁve analysis methods for testing
time main eﬀects.
MMA: the analysis by ﬁtting the mixed
linear model for each gene. F1, F2, F3, and F4: the analysis with
hierarchical Bayesian model by calculating diﬀerent summary
statistics.

97
0.0
0.2
0.4
0.6
0.8
1.0
0.2
0.4
0.6
0.8
1.0
Genotype vs Time Interaction
1−specificity
sensitivity
MMA
F1
F2
F3
F4
Figure 3.3
Genotype-by-Time Interaction Test: ROC Curves for the First
Simulated Data. ROC curves corresponding to the ﬁve analysis
methods for testing genotype-by-time interaction. MMA: the
analysis by ﬁtting the mixed linear model for each gene. F1,
F2, F3, and F4: the analysis with hierarchical Bayesian model
by calculating diﬀerent summary statistics.

98
0.0
0.2
0.4
0.6
0.8
1.0
0.2
0.4
0.6
0.8
1.0
Genotype Test
1−specificity
sensitivity
MMA−F
MMA−T
F1
F2
F3
F4
Figure 3.4
Genotype Test: ROC Curves for the Second Simulated Data.
ROC curves corresponding to the six analysis methods for test-
ing genotype main eﬀects. MMA-F: the analysis by ﬁtting the
full mixed linear model (3.1) for each gene. MMA-T: the anal-
ysis by ﬁtting the generating mixed linear model (true model)
for each gene. F1, F2, F3, and F4: the analysis with hierarchical
Bayesian model by calculating diﬀerent summary statistics.

99
0.0
0.2
0.4
0.6
0.8
1.0
0.4
0.6
0.8
1.0
Time Test
1−specificity
sensitivity
MMA−F
MMA−T
F1
F2
F3
F4
Figure 3.5
Time Test: ROC Curves for the Second Simulated Data. ROC
curves corresponding to the six analysis methods for testing
time main eﬀects. MMA-F: the analysis by ﬁtting the mixed
linear model (3.1) for each gene. MMA-T: the analysis by ﬁt-
ting the generating mixed linear model (true model) for each
gene.
F1, F2, F3, and F4:
the analysis with hierarchical
Bayesian model by calculating diﬀerent summary statistics.

100
0.0
0.2
0.4
0.6
0.8
1.0
0.2
0.4
0.6
0.8
1.0
Genotype vs Time Interaction
1−specificity
sensitivity
MMA−F
MMA−T
F1
F2
F3
F4
Figure 3.6
Genotype-by-Time Interaction Test:
ROC Curves for the
Second Simulated Data.
ROC curves corresponding to the
six analysis methods for testing genotype-by-time interaction.
MMA-F: the analysis by ﬁtting the mixed linear model (3.1)
for each gene. MMA-T: the analysis by ﬁtting the generating
mixed linear model (true model) for each gene. F1, F2, F3, and
F4: the analysis with hierarchical Bayesian model by calculating
diﬀerent summary statistics.

101
CHAPTER 4.
Identifying Single Feature Polymorphisms Using
Aﬀymetrix Gene Expression Data
Cumhur Yusuf Demirkale and Dan Nettleton
Abstract: In microarray data analysis, the identiﬁcation of Single Feature Polymorphisms
(SFPs) is important for producing more accurate expression measurements when comparing
samples of diﬀerent genotypes. Also, portions of DNA that diﬀer between parental lines can
serve as markers for tracking DNA inheritance in oﬀspring.
We summarize several SFPs
discovery methods in the literature. To identify single probes deﬁning SFPs in the data, we
developed two new algorithms where a diﬀerence value is deﬁned for each probe after accounting
for the overall gene expression level diﬀerences in the probe set. First method contrast the
diﬀerence value of each probe with the average of the diﬀerence values for the rest of the probes
in that probe set. Second method is a robust version of the ﬁrst method. The performance
of all methods are compared through two publicly available published data sets, where truth
about the sequence polymorphism is known for some “Gold Standard” probes.
KEY WORDS: Aﬀymetrix GeneChips; Linear Mixed Models; Microarrays; Outliers; Robust
Methods; Single Feature Polymorphisms.
4.1
Introduction
Microarray technology provides a means for simultaneously measuring the abundance of
thousands of mRNA transcripts in multiple biological samples. Mainly, these measurements
are used to detect diﬀerentially expressed genes over diﬀerent experimental conditions, time
points, tissue samples, etc.
High-density oligonucleotide arrays are often used for measur-
ing gene expression levels.
These arrays are also used for identifying possible DNA diﬀer-

102
ences between genotypes, which include single nucleotide polymorphisms (SNPs) and inser-
tion/deletions polymorphisms (IDPs) (Cui et al., 2005). Polymorphisms detected by a single
probe in an oligonucleotide array are called a single-feature polymorphism (SFPs), where a
feature refers to a probe in the array (Borevitz et al., 2003). The identiﬁcation of SFPs is
important for producing more accurate expression measurements when comparing samples of
diﬀerent genotypes. Also, portions of DNA that diﬀer between parental lines can serve as
markers for tracking DNA inheritance in oﬀspring. Therefore, several statistical methods for
identiﬁcation of possible SFPs between genotypes have been proposed in the literature in recent
years.
Winzeler et al. (1998) pioneered the idea of identifying sequence polymorphisms by the
direct hybridization of labeled genomic DNA to oligonucleotide yeast microarrays. Borevitz et
al. (2003) applied this approach to organisms with more complex genomes, such as Arabidopsis
thaliana. Cui et al. (2005) considered using RNA as a surrogate for DNA, and proposed a
statistical method for identifying SFPs in barley from Aﬀymetrix GeneChip RNA hybridization
signals. Similarly, with RNA-derived barley data, Rostoks et al. (2005) proposed a statistical
algorithm for identifying SFPs by distinguishing genotype-dependent hybridization diﬀerences
after accounting for overall gene expression level. Ronald et al. (2005) extended the idea by
hybridizing mRNA to oligonucleotide arrays for simultaneously discovering polymorphic loci
and analyzing gene expression in yeast. West et al. (2006) demonstrated that hybridization of
gene expression microarrays with RNA allows simultaneous phenotyping with gene expression
markers and genotyping with SFP markers. In contrast to previous studies, Greenhall et al.
(2007) demonstrated the performance of their algorithm in identiﬁcation of possible sequence
diﬀerences between strains, species, or individuals. They identiﬁed SFPs for the data obtained
from inbred mice and from humans and chimpanzees.
Except Greenhall et al. (2007), none of the previously published papers mentioned above
provided a performance comparison across multiple methods. The methods were evaluated
separately using, for the most part, distinct data sets. In this paper, we compare the per-
formance of these methods for detecting SFPs from oligonucleotide array data using multiple

103
gold-standard data sets. Additionally, we include in our comparison three new algorithms that
exhibit advantages over the existing techniques.
This paper is organized as follows.
In Section 4.2, we provide background information
on Aﬀymetrix GeneChips and describe the concept of an SFP in greater detail. Section 4.3
presents three microarray data sets and summarizes several SFP discovery methods in the
literature.
Further, we introduce two new algorithms in that section.
In Section 4.4, we
compare the performance of all methods through two publicly available published data sets,
where truth about the sequence polymorphism is known for some “Gold Standard” probes.
Results of the application of selected methods to soybean data is also summarized in that
section. Finally, section 4.5 gives a few concluding comments and explains the future direction
of this research.
4.2
Background
4.2.1
Aﬀymetrix GeneChips
An oligonucleotide is a short sequence of nucleotides. Aﬀymetrix GeneChips are oligonu-
cleotide arrays, where each oligo is intended to be 25 nucleotides in length. On a Aﬀymetrix
oligonucleotide array, each gene (more accurately sequence of interest or feature) is represented
by a probe set which consists of multiple probe cells that contains millions of copies of one
oligo. Probe cells in a probe set are arranged in 11∼20 diﬀerent oligonucleotide probe pairs.
Each probe pair contains a perfect match (PM) probe cell and a mismatch (MM) probe cell.
A PM oligo perfectly matches part of a gene sequence. A MM oligo is identical to a PM
oligo except that the middle nucleotide (13th of 25) is intentionally replaced by its comple-
mentary nucleotide. The MM serves as a measure of non-speciﬁc background binding and
noise. Although Aﬀymetrix GeneChips were not designed to detect sequence diﬀerences, they
do provide individual probe hybridization values that are sensitive to small regions of sequence
mismatch. Thus, Aﬀymetrix GeneChips are useful for SFP detection.

104
4.2.2
Description of Single Feature Polymorphism
The sequence variation detected by a single probe in an oligonucleotide array is called a
Single Feature Polymorphism (SFP), where a feature refers to a probe in the array. When
an SFP is not present in a probe set, ideally some constant expression diﬀerence is expected
between two genotypes for all probes in the probe set. The magnitude and direction of the
diﬀerence depends on gene expression diﬀerences between two genotypes. The top right panel
in Figure 4.1 illustrates a gene that has higher expression in genotype A than in genotype B.
In both top panels in Figure 1, there is a constant signal intensity diﬀerence between the two
genotypes for every probe in the probe set. The ﬂuctuations of intensities over probes can be
explained by diﬀerences in probe sequence that result in diﬀerent hybridization characteristics.
When an SFP is present in a probe set, the expression diﬀerence between two genotypes
is not constant for every probe in the probe set. The bottom panels in the Figure 4.1 are
examples of an SFP in Probe 5. The low intensity signal for genotype B at this probe is due to
poor hybridization, which can be explained by the diﬀerence between the probe sequence and
the RNA molecule produced by genotype B. The right bottom panel in Figure 4.1 shows an
example of a gene that is diﬀerentially expressed between genotypes. In particular, genotype A
produces more RNA for this gene than genotype B. Because the diﬀerence between genotypes
is substantially larger for Probe 5 than for the other probes, there is evidence for an SFP.
4.3
Materials and Methods
In this section, we describe several data sets that will be used to examine the performance
of SFP detection methods. We then present some details about ﬁve published methods for
detecting SFPs and introduce two new methods.
4.3.1
Data Sets
Maize Data:
CEL ﬁles containing raw Aﬀymetrix Maize GeneChip array data are available from NCBI
Gene Expression Omnibus (GEO) database (http://www.ncbi.nlm.nih.gov/geo/). The dataset

105
GSE8194 consists of 36 Genechip arrays. For seedling aerial, immature ear, and embryo tissues,
three biological replications for each of inbred lines B73, Mo17, B73×Mo17, and Mo17×B73 are
available (Stupar et al., 2006). GSE8308 contains 24 Genechip arrays corresponding to three bi-
ological replications for each of two tissues (endosperm 13 days after pollination and endosperm
19 days after pollination) and four genotypes B73, Mo17, B73×Mo17, and Mo17×B73 (Stupar
et al., 2007). We only focus on the inbred lines B73 and Mo17 here to simplify the presentation
of our main ideas. Therefore, by combining GSE8194 and GSE8308, we have 30 arrays from
three biological replications for each combination of ﬁve tissue types and two inbred lines.
Barley Data:
This data set was analyzed in Rostoks et al. (2005).
As described there, Aﬀymetrix Bar-
ley1 GeneChip data was produced within an international collaborative project (A.Druka,
G.Muehlbauer, I.Druka, R.Caldo, U.Baumann, N.Rostoks, A.Schreiber, R.Wise, A.Kleinhofs,
T.Close, et al., unpublished work). The complete data set consists of 36 arrays, with three
replicate arrays for each of 12 combinations of genotype (two levels) and tissue type (six lev-
els). The two genotypes studied are Golden Promise (GP) and Morex (MX), and the six tissue
types are abbreviated COL, CRO, GEM, LEA, RAD, and ROO. Rostoks et al. (2005) found
that for the ROO tissue, one replicate that was nominally of GP genotype had a very high
correlation with the three replicates of the MX genotype. This replicated was re-assigned as
genotype MX.
Soybean Data:
Data from 75 Aﬀymetrix Soybean GeneChips are available from an experiment involving ﬁve
genotypes, ﬁve harvest times, and three replications. The experiment was designed as a ran-
domized complete block design with replications as blocks and genotypes as treatments. Re-
peated measures of each experimental unit (pot containing multiple soybean plants) yielded
expression measures at ﬁve times for each combination of genotype and replication. Two of
the ﬁve genotypes are parental lines that diﬀer in seed protein content and will be denoted
here by H and L for high and low protein. The other three lines resulted from a cross between
the parental lines, repeated selﬁng, and then repeated backcrosses to the low-protein parental

106
line L. The three backcross lines (denoted BC1, BC2, and BC3) were selected from many such
lines for their high-protein seed content. Thus, the backcross lines have a genome with DNA
content that is very similar to the parent line L (due to repeated backcrossings) but protein
producing characteristics that are very similar to the parent line H. The hypothesis is that the
backcross lines possess unknown segments of DNA from the parental line H that are important
for protein production. By identifying SFPs that distinguish parental line L from the backcross
lines and parental line H, we can gain clues about regions of the genome that may be important
for protein production.
4.3.2
Candidate Analysis Methods
In this section, we describe seven methods for SFP identiﬁcation from oligonucleotide mi-
croarray data. We have included what we believe to be the ﬁve most popular methods from
the literature, along with two new methods that we have developed.
1. Borevitz: This is the method proposed in Borevitz et al. (2003). Initially, the method
performs a spatial correction to the data. After the correction step, the log-scale perfect
match (PM) intensities are used in the analysis. For each probe, the samples from both
genotypes are compared by using a modiﬁed t-statistic. The test statistic is very similar
to that used in Signiﬁcance Analysis of Microarrays (SAM) (Tusher et al., 2001). The
diﬀerence between the probe sample mean for one genotype and the probe sample mean
for the other genotype is divided by the square root of the sum of the probe-speciﬁc
sample variance pooled across both genotypes and the median of all such probe-speciﬁc
sample variances in the probe set. The permutation testing was applied according to SAM
to get some nominal control of false discovery rate. R functions for this method were
downloaded from http://naturalvariation.org/sfp and adjusted slightly for appropriate
application to our data sets.
2. Cui: This is the method proposed in Cui et al. (2005).
The idea of the method is
based on the expectation that, for each gene, two genotypes will have parallel expression
values for all probes in a given probe set, except for probes that cover SFPs.
The

107
ﬁrst step in the method involves removing all probe sets that are not called present by
Aﬀymetrix software on all chips. The log-scale PM values without background correction
and normalization were considered for the further steps of the analysis. As described in
the paper, the log-scaled observed PM value of a probe is modeled as the sum of a probe
set expression index, a probe aﬃnity eﬀect, and a random error. After estimating an
expression index for the probe set and probe aﬃnity eﬀects for each probe in the probe
set by using the replicate samples of each genotype, the diﬀerence between the median
estimated aﬃnity eﬀects of the two genotypes are calculated for each probe. An extreme
diﬀerence for any probe in the probe set suggests the presence of an SFP in that probe.
To identify the extreme diﬀerences, they used the projection pursuit method, which is a
robust measure of the outlyingness of an observation in a sample. The authors calculate
an overall score that measures the extent to which a particular probe set is judged to
be outlying, as well as probe-speciﬁc scores that quantify the contribution of individual
probes to the overall outlyingness of their probe sets. The probe sets with the highest
overall outlying scores are then identiﬁed as containing putative SFP probe(s). Then an
SFP will be located at the probe with the highest individual outlying score. Dr. Cui
kindly provided the R scripts that we adjusted appropriately for application to our data
sets.
3. Greenhall: This is the method proposed in Greenhall et al. (2007). The proposed al-
gorithm, called GeSNP, identiﬁes probes which show hybridization diﬀerences between
two genotypes after normalizing for expression level diﬀerences. GeSNP has ﬁve major
steps. First, the individual hybridization intensity values are extracted from the CEL
ﬁles. Second, the diﬀerence between PM and MM intensities is calculated for each probe
pair in each probe set. Some of probe sets are ﬁltered, i.e., a probe set from a sample
is excluded if <65% of the PM-MM values for the probe set are positive. Third, the
PM-MM values in each probe set of a sample are scaled. The scaling factor is calculated
by dividing an arbitrary target value of 200 with the standard deviation of the PM-MM
values for a probe set excluding the largest and smallest PM-MM values. Fourth, for

108
each genotype, sample average and sample standard deviation of the scaled PM-MM
values are calculated. Fifth, the hybridization pattern diﬀerences are identiﬁed for each
probe by using two-sample t-test that is computed using separate variance estimates for
each genotype. Probes are ordered with respect to their t values. The performance of
the GeSNP algorithm was compared with the algorithm of Ronald et al. (2005), which
uses a diﬀerent approach for background subtraction, normalization, and calculating the
summary t-statistic for each probe. It was shown on a test data set that the GeSNP algo-
rithm performed better in ordering the probes than Ronald’s algorithm. We downloaded
the source C++ GeSNP code from http://porifera.ucsd.edu/ cabney/cgi-bin/geSNP.cgi
and applied to our test data.
4. Rostoks: This is the method proposed in Rostoks et al. (2005). The hybridization in-
tensities for each of the perfect match (PM) probes are extracted from the CEL ﬁles.
Background correction and quantile normalization are performed by using the RMA
method in the Bioconductor aﬀy package. For a given probe set, a linear model that
includes genotype eﬀects, probe eﬀects, and other eﬀects speciﬁc to the data at hand
is ﬁt to the background corrected and normalized PM data. Although the model in-
cludes genotype eﬀects and probe eﬀects, interactions between genotypes and probes
are intentionally excluded. The residuals from this model ﬁt are captured and used for
subsequent analysis. In particular, the residuals for each probe serve as a data set that
is used to test for a signiﬁcant probe-speciﬁc genotype eﬀect. If the residuals for one
genotype tend to be larger than residuals for another genotype for a given probe, this
provides evidence of genotype-dependent hybridization diﬀerences for that probe. These
probe speciﬁc tests for genotype eﬀects are carried out using SAM approach (Tusher et
al., 2001) available in the Bioconductor package siggenes. Signiﬁcant probes from this
analysis are called SFPs. To implement this method, we used the R script available at
http://naturalvariation.org/barley and adjusted it slightly for application to our data
sets.

109
5. West: This is the method proposed in West et al. (2006). As described in the paper,
the CEL ﬁles are subjected to background correction by using the RMA method in the
aﬀy package. The background-corrected hybridization values for each of the PM oligonu-
cleotide probes in each probe set are then used for subsequent analysis. A summary
measure is used to describe each probe in relation to the other probes within the probe
set on a given chip. The summary measure, called SFPdev, is calculated for the ith
probe on the jth chip as follows:
SFPdevij =
sij −¯s(i)j

sij
,
where sij denotes the signal of the ith probe on the jth chip and ¯s(i)j denotes the average
of the other signals in the probe set containing probe i on the jth chip. A “parental min-
max” algorithm is then used to calculate a “gap” value. The minimum SFPdev value
among the replicate samples of the given genotype is divided by the maximum SFPdev
value among the replicate samples of other genotype and vice versa. An SFP is declared
for a particular probe if its gap value is greater than 2. We implemented this method in
R for application to our data sets.
6. Contrast: This is a new method that we propose as follows. To illustrate Contrast
method, we will consider a simple microarray experiment, where there are K biological
replications for each of two genotypes. The following linear mixed model can be used as
a base model for each probe set. Let
Yijk = µ + ρi + γj + θij + cj(k) + eijk
(4.1)
i = 1, 2, . . . , p; j = 1, 2; k = 1, . . . , K;
where Yijk is the background corrected, quantile normalized, log-scaled observed PM
value of the ith probe from the kth GeneChip of the jth genotype; µ is an intercept
parameter; ρ1, . . . , ρp are ﬁxed probe eﬀects, γ1 and γ2 are ﬁxed genotype eﬀects; the θij
values are probe-by-genotype interaction eﬀects; the cj(k) values are normally distributed
random chip eﬀects with mean 0 and variance σ2
c; and the eijk terms are normally

110
distributed random errors with variance σ2
e. The GeneChip random eﬀects are included
in the model to account for correlation between probes from the same chip, and as is
standard, all random eﬀects are assumed to be independent. For each probe i in a probe
set, we deﬁne a diﬀerence value between the average signal intensities of two genotypes
as
di = Y i1. −Y i2.,
i = 1, 2, . . . , p.
From model (4.1), it follows that
d ≡(d1, . . . , dp)′ ∼N(δ, Σ),
where δ ≡(δ1, . . . , δp)′; δi ≡γ1−γ2+θi1−θi2 for i = 1, . . . , p; and Σ = 2σ2
e
K Ip×p+ 2σ2
c
K Jp×p.
When an SFP is not present in a given probe set, ideally the mean of di should be the
same for each probe. That is,
δ1 = . . . = δi = . . . = δp.
(4.2)
However, if there is an SFP in a probe, the equality in (4.2) will not hold due to interaction
between probe and genotype. A test for interaction between probe and genotype based
on model (4.1) could be used to identify probe sets that contain one or more SFPs,
but we require more speciﬁc information about which individual probes contain SFPs.
Therefore, we focus on ﬁnding probes with genotype diﬀerences (di) that are signiﬁcantly
diﬀerent from the average of the genotype diﬀerences of the other probes in the same
probe set ({d1, . . . , dp} \ {di}).
Suppose that only the ith probe in a given probe set contains an SFP. Let δ−i denote
the assumed constant value of δj for all j ̸= i. Consider the test of
H∗
0i : δi = δ−i
vs.
H∗
Ai : δi ̸= δ−i.
This null hypothesis will be false when only the ith probe contains an SFP. A natural test
statistic for measuring evidence against H∗
0i – and therefore ranking probes for evidence

111
of an SFP – is
ti =
di −
1
p−1
P
j̸=i dj
q
2
K ˆσ2e(1 +
1
p−1)
,
(4.3)
where ˆσ2
e is the REML estimate of σ2
e obtained from the ﬁt of linear model (4.1). More
generally, this test is actually a special contrast which tests
H0i : δi =
1
p −1
X
j̸=i
δj
vs.
HAi : δi ̸=
1
p −1
X
j̸=i
δj.
(4.4)
7. RContrast: This is a robust version of the contrast test. Note that the null H0i in (4.4)
will actually be false for all i = 1, . . . , p whenever a probe set contains one or more SFPs.
Also, the presence of multiple probes with SFPs can reduce power for SFP detection
when the eﬀects of the SFPs are in the same direction. For these reasons, we consider a
robust test statistic deﬁned as
tRi =
di −Tbi
s
2
K ˆσ2e

1 + P
j̸=i w2
j/
P
j̸=i wj
2,
(4.5)
where Tbi is the Tukey biweight estimator of the mean for the sample of diﬀerences
S−i ≡{d1, . . . , . . . , dp} \ {di} and the wj values are weights discussed below.
The Tukey biweight estimator is introduced on page 382 of Hoaglin et al. (1983) and is
deﬁned in our case as follows. Let M−i denote the median of S−i, and let MAD−i denote
the median absolute deviation of S−i. For all j ̸= i, deﬁne
uj = dj −M−i
9MAD−i
,
(4.6)
and let
wj =





(1 −u2
j)2
if |uj| ≤1
0
otherwise
(4.7)
Then
Tbi =
P
j̸=i djwj
P
j̸=i wj
.
(4.8)

112
Due to the weighting scheme, outlying dj values are downweighted or removed in the
Tukey biweight estimator. Thus, the presence of multiple SFPs will be less problematic
for the RContrast approach. Also, for a probe set that does contain an SFP, the tRi
value for any probe that does not contain the SFP will tend to be closer to 0 than the
ti value due to the downweighting of the dj value corresponding to the SFP-containing
probe. Thus, the tRi values may be better able to distinguish SFP-containing probes
from non-SFP-containing probes than the ti values.
4.4
Application
In this section, we use two publicly available data sets to examine the performance of the
methods described in Section 3. The validation rates of predicted SFPs will be established via
comparisons to a known set of SNPs for both data sets. Additionally, we will apply selected
methods to the soybean data set to identify potential probes with SFPs.
4.4.1
Identiﬁcation of Single Feature Polymorphisms in Maize
Our maize data sets each contain of 17,734 probe sets. We will consider in our analysis the
17,579 probe sets that each contain 15 probe pairs. Wu et al. (2009, unpublished manuscript)
state that 273 probes were found to target 213 of 1,016 validated SNPs and 6,270 probes had
perfect matches to 2,100 non-SNP-containing gene regions. Of these 6,270 probes with no SFP,
6,216 probes were contained in the probe sets with 15 probes that we analyzed. Therefore,
273 SNP probes and 6,216 no-SNP probes were treated as “gold standard” probes for SFP
detection.
Each of the ﬁve maize tissue samples was analyzed by each of the seven methods. The
prediction results of each algorithm in each tissue were ranked in descending order according
to the algorithm-speciﬁc SFP selection statistic. The top 2000, 4000,. . ., 10000 probes were
picked and compared with the 273 Gold standard SNP probes and the 6,216 gold standard
no-SNP probes. At each level, we calculated true positives (TP) (the number of correctly-
predicted SNP probes), false positives (FP) (the number of no-SNP probes that were incorrectly

113
predicted as SFP probes), false negatives (FN) (the number of SNP probes missed in the SFP
prediction, here FN=273-TP), and true negatives (TN) (the number of no-SNP probes that
were not predicted to be SFPs, here TN=6216-FP). Then sensitivity (SN) was calculated as
TP/(TP + FN), and speciﬁcity (SP) was calculated as TN/(TN + FP).
Table 4.1 summarizes the TP values for each of the seven methods when the top 2000,
4000,. . ., 10000 probes were called SFPs in each of the ﬁve maize tissues. At every cut-oﬀ
level, the RContrast method identiﬁed the highest number of SFPs correctly for the immature
ear tissue. In addition, for endosperm 13 DAP and endosperm 19 DAP tissues, RContrast had
the highest TP value when the top 4000 or more probes were considered. For all ﬁve maize
tissues, RContrast found the highest number of SFPs correctly for cut-oﬀlevels of 5000 probes
or higher. For lower cut-oﬀlevels, the method of Cui et. al. (2005) performed better than
other procedures for 19 DAP embryo tissue and seedling tissue.
We also examine receiver operator characteristic (ROC) curves to compare the eﬀectiveness
of the methods for separating probes with a SFP from probes with no SFP. The SFP selection
statistic produced by each method provides a rank order of probes from most evidence for an
SFP to least evidence. The quality of the ranking varies from method to method and can
be judged by comparing ROC curves. The greater the area under an ROC curve the better
the corresponding method is at distinguishing probes with SFPs from probes with no SFPs.
Because the patterns of the curves and diﬀerences among the curves were quite similar for
each maize tissue data, here we only examine the plots for the endosperm 19 DAP tissue
(Figure 4.2).
Figure 4.2 has four panels. Both panels on the top were produced by using the all the
probes in the endosperm 19 DAP tissue data set. Top left panel shows the number of correctly
identiﬁed SFPs when top 10, 20,. . . , 10000 probes were declared to contain SFPs. The curve
corresponding to the RContrast method were slightly higher than curves corresponding to
other methods. This plot provides information similar to that in Table 4.1 and shows that the
RContrast method identiﬁed more SFP probes correctly than the other methods when the top
3000 or more probes were declared to contain SFPs. The top right panel of Figure 4.2 shows

114
ROC curves for the seven methods. This plot illustrates that an analysis with the RContrast
method is slightly more eﬀective at distinguishing probes with SFPs from probes without SFPs
than the other methods.
In the bottom panels of Figure 4.2, we only used the 6,489 gold standard probes. The
bottom left panel shows the number of correctly identiﬁed SFPs when the top 1, 5,. . ., 6489
probes were declared to be SFPs. Similar to the panel above, the curve corresponding to the
RContrast method is slightly higher than curves corresponding to other methods. Rostock’s
approach lags behind the RContrast method. Because Cui’s method ﬁlters probe sets with
present and absent calls, it could not identify all of the 273 gold standard SFP probes. The
bottom right panel of this ﬁgure illustrates ROC curves corresponding to the seven methods
when using only the gold standard probes after present and absent call ﬁltering. The plot
shows that an analysis with the RContrast method is slightly more eﬀective at distinguishing
probes with SFP from probes without SFPs than the other methods. Similar to the TP panel,
Rostoks approach lags behind the RContrast approach. All these panels in this ﬁgure suggest
that the RContrast method is the most eﬀective method for identifying probes that contain
SFPs.
Figures for other maize tissues are presented in the Supplementary Materials that
accompany this manuscript and provide similar results in favor of the RContrast approach.
4.4.2
Identiﬁcation of Single Feature Polymorphisms in Barley
Each of six tissues in the barley data set contains of 22,840 probe sets. We focus our analysis
on the subset of 22,801 probe sets that each contain 11 probe pairs. Rostoks et al. (2005) pro-
vided sequence polymorphism information for 2667 probes at http://naturalvariation.org/barley.
They found 66 probes that matched neither genotype in the data set and thus excluded those
probes from further analysis. We use the remaining 2601 probes as a gold standard set in
which 401 probes contained SFPs and 2200 probes did not.
Each of the six tissue samples was analyzed by each of the seven methods. For 250,811
(22,801 × 11) probes, the prediction results of each algorithm in each tissue/development stage
were ranked according to the method-speciﬁc SFP selection statistic. The top 1000, 2000,. . .,

115
10000 probes were picked and compared with the 401 gold-standard SNP probes and the 2,200
gold-standard no-SNP probes.
From these comparisons, the number of true positives, the
number of false positives, the number of false negative, the number of true negatives, the
sensitivity value, and the speciﬁcity value were calculated as deﬁned previously.
Table 4.2 summarizes the TP values for each of the seven methods when the top 2000,
4000,. . ., 10000 probes were declared to contain SFPs in each of the six barley tissues. At
each cut-oﬀlevel, the Contrast or RContrast method identiﬁed the highest number of SFPs
correctly for the ROO tissue. Also, the RContrast method identiﬁed the highest number of
SFPs correctly for every tissue when the top 5000 or more probes were declared to contain
SFPs. When the cut-oﬀlevel was equal to 2000 probes, Cui’s method performed better than
the other procedures for all the tissues except the ROO tissue. If the top 4000 probes were
considered, the TP value for the Cui method was the highest for only one tissue, the TP value
for the RContrast method was the highest for 4 tissues, and the Contrast method TP value
was the highest for one tissue. In summary, there are totally 36 cut-oﬀlevels in the table (6 cut
oﬀlevels × 6 tissues). For 25 combinations of tissue and cut-oﬀlevel, the RContrast method
identiﬁed the highest number of SFPs correctly. For 7 combinations of tissue and cut-oﬀ, Cui’s
method provide the highest TP count. For the other 4 combinations, the Contrast method had
the highest TP value. These observations suggest that the RContrast method was the most
eﬀective for identiﬁcation of SFPs in the barley data.
We also used ROC panels to compare the eﬀectiveness of the methods for separating probes
with SFPs and probes with no SFPs in the barley data. Because the patterns of the curves and
diﬀerences among the curves were quite similar for each barley tissue, here we only examine
Figure 4.7 for the RAD tissue.
The ﬁgure has four panels.
Both panels on the top were
produced by using the all the probes in the RAD tissue data set. The top left panel shows
the number of correctly identiﬁed SFPs when top 10, 20,. . . , 10000 probes were declared to
contain SFPs. The curve corresponding to the RContrast method is slightly higher than curves
corresponding to other methods. This plot provides similar information to that contained in
Table 4.2 and shows that the RContrast method identiﬁed more SFP probes correctly than

116
the other methods when the top 4000 or more probes were declared to contain SFPs. The
top right panel of Figure 4.7 shows ROC curves for the seven methods. The plot illustrates
that an analysis with the RContrast method is slightly more eﬀective at distinguishing probes
with SFPs from probes without SFPs than the other methods. Cui’s method seems to work
well when a smaller number of probes are declared to contain SFPs, but it loses power as
the number of probes declared to contain SFPs increases. The Greenhall method was least
eﬀective among all seven methods.
The bottom panels of Figure 4.7 were produced by using only 2601 gold standard probes.
The left panel shows the number of correctly identiﬁed SFPs when the top 1, 5,. . ., 2601 probes
were declared to contain SFPs. It shows that the curve corresponding to the RContrast method
is slightly higher than curves corresponding to other methods.
The Contrast and Rostoks
approaches lag behind the RContrast method. Because Cui’s method excludes probe sets with
absent calls, it could not identify all of the 401 gold standard SNP probes. Lastly, we examine
the bottom right panel of this ﬁgure, which illustrates ROC curves corresponding to the seven
methods when using only the gold standard probes after present and absent call ﬁltering. It
shows that an analysis with the RContrast method is slightly more eﬀective at distinguishing
probes with SFPs from probes without SFPs than the other methods. The Borevitz method
seems to be powerful when few probes are declared to contain SFPs, but it lags behind the
Rostoks and Contrast approaches when greater numbers of probes are declared to contain
SFPs. All these panels in this ﬁgure indicate that the RContrast method is the most eﬀective
method for identifying probes with SFPs. Figures for other barley tissues are presented in
Supplementary Materials accompanying this paper. These plots also support the conclusion
discussed here.
4.4.3
Identiﬁcation of Single Feature Polymorphisms in the Soybean Data
Each of the 75 Aﬀymetrix soybean GeneChip contains 37,593 soybean probe sets.
We
present results for the analysis of the 37,376 probe sets that each contain 11 probe pairs. To
identify SFPs that distinguish parental line L from the backcross lines and parental line H,

117
we considered four analyses comparing BC1 versus L, BC2 versus L, BC3 versus L, and H
versus L by using the RContrast method. We conducted a separate analysis for each of the
ﬁve harvest time points, which leads to 20 analyses (4 pairwise comparisons of genotypes at 5
time points).
The prediction results within each time point and each comparison were ranked according
to their |tRi| values. The top 300 probes were identiﬁed from each comparison of parental line
L versus the three backcross lines, and the top 1500 probes were identiﬁed from the comparison
of parental lines L and H at each time point. These collections of top probes were compared
to identify probes common to all collections. Such probes may correspond to genomic regions
where DNA from the H line is important for high protein production. (Recall that the backcross
lines produce seeds with high protein content similar to the H line despite having very little
DNA from the H line.) Counts of common probes are summarized in the bottom row and in
the last column of Table 4.3. At each of the ﬁve time points, respectively, the bottom row
shows that the method identiﬁed a total of 73, 66, 53, 61, and 46 common probes among
the four genotype comparisons. For each of the four genotype comparisons, respectively, the
method identiﬁed a total of 51, 54, 100, and 608 common probes across the ﬁve times points.
We identiﬁed 32 probes showing SFPs at all ﬁve time points for all four genotype comparisons.
To illustrate SFPs discovery in soybean data, we will use three probesets as an example.
These probe sets include probe(s) that was(were) among the 32 probes which were identiﬁed
as containing SFPs in all sets. Figure 4.14 illustrates the di values of the 11 probes in probe
set Gma.11144.2.S1 at. Probes 10 and 11 in this probe set were among the 32 probes that
were identiﬁed as containing SFPs in all sets. The ﬁgure has four panels corresponding to the
comparisons of BC1 versus L (top left), BC2 versus L (top right), BC3 versus L (bottom left),
and H versus L (bottom right). In each of the four panels of the ﬁgure, the di values of these
two probes were signiﬁcantly higher than the di values of the other 9 probes at each of the 5
time points. Similarly, Probe 9 is identiﬁed to carry SFP in probe set Gma.734.1.A1 at (Fig-
ure 4.13) and probes 7, 8, and 9 are identiﬁed to have SFPs in probe set GmaAﬀx.39499.1.S1 at
(Figure 4.15). Figures 4.16, 4.17, and 4.18 illustrate SFPs in these probe sets in an alternative

118
way.
4.5
Concluding Remarks
We have introduced two new statistical algorithms to identify single feature polymorphisms
from oligonucleotide array data. The idea of our methodology is to ﬁnd – after accounting for
the overall gene expression level diﬀerences in the probe set – extreme hybridization diﬀerences
between two genotypes that are often caused by sequence polymorphism. For each probe in
a probe set, we deﬁne a diﬀerence value that is contrasted with the average of the diﬀerence
values for the rest of the probes in that probe set. We have modiﬁed our contrast statistic
by using the Tukey biweight estimator of the average diﬀerences in our test statistic to avoid
potential problems caused by the presence of multiple SFPs within a single probe set.
We have compared the performance of our algorithms with ﬁve previously published meth-
ods by using two publicly available microarray data sets. The validation rates of predicted
SFPs were established via comparisons to a known set of SFPs for both data sets. It was
shown that our algorithms provided performance superior to the other methods in ordering
probes for evidence of SFPs.
The SFP selection statistic of the Borevitz method was not
formulated to separate the binding diﬀerences due to sequence diﬀerences from overall gene
expression diﬀerences. The Rostoks method identiﬁes SFPs by using the residuals from a probe
level model which accounts for the overall gene expression level in the probe set. However,
their probe level model does not include individual chip eﬀects. Furthermore, residuals from
their model ﬁt were used as data points in subsequent SAM analysis to ﬁnd probes contain-
ing SFPs. By construction, residuals contain dependencies that are not accounted for in the
SAM analysis. Although the West method calculates an SFP selection statistic with the idea
of comparing the intensity level of each probe to the intensity level of the rest of the probes
in a probe set, it fails to correct for overall diﬀerential gene expression properly. The same
problem was also seen in the Greenhall approach. Although Cui’s method and our method
share the similar idea of identifying the outlying probe in the probe set, we have observed that
their preﬁltering with presence calls cause to miss the several probes with SFPs in the gold

119
standard data. Finally, we believe that all these observations could explain why our method
works better than existing methods for most of the data sets that we examined.
Although the RContrast method provided a better ordering of the probes for evidence of
SFPs than other methods for most of the data sets we presented, it is diﬃcult to use this
or other methods to assess the false discovery rate in a set of probes declared to be SFPs.
Assuming that model (4.1) is correct, the Contrast approach can be used to obtain a valid test
of H0i vs. HAi for each probe. However, as discussed previously, it is possible for H0i to be
false even when there is no DNA variation between the genotypes for the ith probe in a probe
set. More generally, the assumption of no genotype-by-probe interaction for probes with no
SFPs may not hold. For example, due to variation in the sequences of probes within any probe
set, the hybridization characteristics of probes vary. Some probes may be more eﬀective at
detecting diﬀerential expression than others. Thus, for genes that are diﬀerentially expressed
between genotypes, interactions between genotype and probes may exist even when no SFPs
are present in the probe set. For these reasons, we do not believe it is feasible at this time to
provide formal assessments of error rates in SFP calls without gold standard data sets. We
believe that the existing and our newly proposed SFP detection approaches can be used to
identify good SFP candidates that must be further veriﬁed using other means.
4.6
References
Borevitz J. O., Liang D., Plouﬀe D., Chang H-S., Zhu T., Weigel D., Berry C. C., Winzeler
E., and Chory J. (2003). Large-Scale Identiﬁcation of Single-Feature Polymorphisms in
Complex Genomes. Genome Research, 13, 513–523.
Cui X., Xu J., Asghar R., Condamine P., Svensson J. T., Wanamaker S., Stein N., Roose M.,
and Close T. J. (2005). Detecting single-feature polymorphisms using oligonucleotide
arrays and robustiﬁed projection pursuit. Bioinformatics, 21, 3852–3858.
Das S., Bhat P. R., Sudhakar C., Ehlers J.D., Wanamaker S., Roberts P.A., Cui X., and Close
T. J. (2008). Detection and validation of single feature polymorphisms in cowpea (Vigna

120
unguiculata L. Walp) using a soybean genome array. BMC Genomics, 9, 107.
Greenhall J. A., Zapala M. A., Caceres M., Libiger O., Barlow C., Schork N. J., and Lock-
hart D. J. (2007). Detecting genetic variation in microarray expression data. Genome
Research, 17, 1228–1235.
Hoaglin D. C., Mosteller F., and Tukey J. W. (1983). Understanding Robust and Exploratory
Data Analysis. John Wiley & Sons, Inc.
Ronald J., Akey J. M., Whittle J., Smith E. N., Yvert G., and Kruglyak L. (2005). Simultane-
ous genotyping, gene-expression measurement, and detection of allele-speciﬁc expression
with oligonucleotide arrays. Genome Research, 15, 284–291.
Rostoks N., Borevitz J., Hedley P., Russell J., Mudie S., Morris J., Cardle L., Marshall D., and
Waugh R. (2005). Single-feature polymorphism discovery in the barley transcriptome.
Genome Biology, 6(6):R54.
Stupar R. M., Springer N. M. (2006).
Cis-transcriptional variation in maize inbred lines
B73 and Mo17 leads to additive expression patterns in the F1 hybrid. Genetics 173,
2199–2210.
Stupar R. M., Hermanson P. J., and Springer N. M. (2007). Nonadditive expression and
parent-of-origin eﬀects identiﬁed by microarray and allele-speciﬁc expression proﬁling of
maize endosperm. Plant Physiol, 145 411–425.
Tusher V. G., Tibshirani R., and Chu G. (2001). Signiﬁcance analysis of microarrays applied
to the ionizing radiation response. Proc Natl Acad Sci USA, 98, 5116–5121.
West M. A. L., van Leeuwen H., Kozik A., Kliebenstein D. J., Doerge R.W., St.
Clair
D. A., and Michelmore R. W. (2006). High-density haplotyping with microarray-based
expression and single feature polymorphism markers in Arabidopsis. Genome Research,
16, 787–795.

121
Winzeler E. A., Richards D. R., Conway A. R., Goldstein A. L., Kalman S., McCullough M.
J., McCusker J. H., Stevens D. A., Wodicka L., Lockhart D. J., and Davis R. W. (1998).
Direct Allelic Variation Scanning of the Yeast Genome. Science, 281, 1194–1197.

122
Table 4.1
SFP Identiﬁcation by the Seven Method for the Five Tissues in
the Maize Data Set. The table values provide the number of
probes correctly identiﬁed as containing an SFP when the top
2000, 4000,. . ., 10000 probes were declared to contain SFPs using
each method.
Tissue
Cut-oﬀ
Borevitz
Cui
Greenhall
Rostoks
West
Contrast
RContrast
2000
53
76
49
45
43
68
68
4000
77
107
82
85
72
105
107
13
5000
92
119
95
89
88
118
124
DAP
6000
102
125
111
106
92
127
130
Endo
7000
112
131
120
111
104
134
139
8000
118
134
126
116
109
139
147
10000
139
143
136
130
119
152
165
2000
43
70
50
53
47
66
65
4000
75
97
76
82
76
101
105
19
5000
81
102
88
93
86
108
112
DAP
6000
88
108
97
99
93
116
123
Endo
7000
100
115
104
108
97
124
129
8000
111
120
111
116
101
130
138
10000
120
130
120
123
117
139
146
2000
66
85
69
66
58
85
86
4000
102
121
108
107
90
125
136
Immature
5000
118
131
123
119
101
140
148
6000
133
144
131
130
108
149
164
Ear
7000
147
150
143
137
118
159
171
8000
156
156
151
147
122
168
181
10000
176
166
168
159
136
175
190
2000
36
78
42
46
42
72
67
4000
67
114
79
76
72
109
109
19
5000
80
131
94
90
88
128
131
DAP
6000
88
137
112
99
98
136
142
Embryo
7000
102
142
125
110
107
147
151
8000
109
145
133
118
112
152
163
10000
137
156
144
133
126
163
177
2000
39
72
54
52
38
71
71
4000
73
113
83
86
69
105
106
5000
94
123
97
99
83
115
125
Seedling
6000
109
131
112
110
92
124
133
7000
126
138
122
122
99
135
141
8000
134
141
134
132
104
140
145
10000
152
148
144
141
122
149
160

123
Table 4.2
SFP Identiﬁcation by the Seven Method for the Six Tissues in
the Barley Data Set. The table values provide the number of
probes correctly identiﬁed as containing an SFP when the top
2000, 4000,. . ., 10000 probes were declared to contain SFPs using
each method.
Tissue
Cut-oﬀ
Borevitz
Cui
Greenhall
Rostoks
West
Contrast
RContrast
2000
66
131
86
102
86
120
122
4000
133
163
127
160
143
177
181
COL
5000
160
170
141
182
163
198
204
6000
177
175
154
189
174
207
216
8000
208
179
173
212
197
226
225
10000
220
184
186
222
214
234
242
2000
49
157
74
92
95
124
126
4000
81
185
130
155
148
183
186
CRO
5000
94
192
152
177
169
205
211
6000
118
197
167
190
179
217
227
8000
157
206
189
222
204
241
247
10000
186
213
213
240
225
259
265
2000
61
159
82
94
93
118
115
4000
131
195
142
175
159
199
194
GEM
5000
160
204
160
201
187
215
219
6000
183
207
177
218
207
236
242
8000
223
215
198
245
237
259
278
10000
243
224
215
266
254
277
291
2000
46
146
71
92
74
99
98
4000
82
172
119
134
124
159
167
LEA
5000
112
181
134
155
135
174
182
6000
132
184
143
178
152
189
199
8000
166
187
166
201
170
212
220
10000
183
188
179
215
195
231
231
2000
74
154
89
101
107
128
120
4000
135
188
138
162
163
189
199
RAD
5000
161
192
159
190
186
221
226
6000
185
194
175
214
206
236
242
8000
222
204
199
248
230
258
271
10000
249
210
213
261
241
275
282
2000
67
6
88
90
82
116
112
4000
143
58
127
158
147
172
179
ROO
5000
170
60
144
180
165
199
209
6000
190
60
154
196
187
216
225
8000
217
92
173
234
218
242
250
10000
237
111
186
255
231
261
266

124
Table 4.3
Identifying SFPs in the Soybean Data Set. Table entries are the
number of probes declared to contain an SFP for each combi-
nation of time and genotype comparison. The margins of the
table give the number of probes common to all the collections of
probes represented in each column or row of the table.
Time=20
Time=25
Time=30
Time=35
Time=45
Common
BC1 vs L
300
300
300
300
300
51
BC2 vs L
300
300
300
300
300
54
BC3 vs L
300
300
300
300
300
100
H vs L
1500
1500
1500
1500
1500
608
Common
73
66
53
61
46
32

125
Probe 1
Probe 2
Probe 3
Probe 4
Probe 5
Intensity
genotype A
genotype B
Probe 1
Probe 2
Probe 3
Probe 4
Probe 5
Intensity
genotype A
genotype B
Probe 1
Probe 2
Probe 3
Probe 4
Probe 5
Intensity
genotype A
genotype B
Probe 1
Probe 2
Probe 3
Probe 4
Probe 5
Intensity
genotype A
genotype B
Figure 4.1
Single Feature Polymorphisms Description. Top left panel: For
all probes, genotype A and genotype B have same expression
level. Top right panel: A gene has higher expression in geno-
type A than in genotype B. Bottom left panel: For all probes,
genotype A and genotype B have same expression level except
probe 5 which reveals an SFP. Bottom right panel: A gene is
diﬀerentially expressed between genotypes and there is evidence
for an SFP in probe 5.

126
0
2000
4000
6000
8000
10000
0
50
100
150
Probes
Correctly Identified
Borevitz
Cui
Greenhall
Rostoks
West
Contrast
RContrast
0.000
0.005
0.010
0.015
0.020
0.025
0.030
0.0
0.1
0.2
0.3
0.4
0.5
1−specificity
sensitivity
Borevitz
Cui
Greenhall
Rostoks
West
Contrast
RContrast
0
1000
2000
3000
4000
5000
6000
0
50
100
150
200
250
Probes
Correctly Identified
Borevitz
Cui
Greenhall
Rostoks
West
Contrast
RContrast
0.0
0.2
0.4
0.6
0.8
1.0
0.0
0.2
0.4
0.6
0.8
1.0
1−specificity
sensitivity
Borevitz
Cui
Greenhall
Rostoks
West
Contrast
RContrast
Figure 4.2
Maize Data: Endosperm 19 DAP Tissue. Performance of the
methods for SFP discovery in the maize Endosperm 19 DAP tis-
sue. Top Left: The number of correctly identiﬁed SFPs when
the top 10, 20,. . ., 10000 probes among all probes were declared
to contain SFPs. Top Right: ROC curves corresponding to the
seven methods when using all the probes in the data set. Bot-
tom Left: The number of correctly identiﬁed SFPs when the
top 1, 5,. . ., 6489 probes among all gold-standard probes were
declared to contain SFPs. Bottom Right: ROC curves corre-
sponding to the seven methods when using only gold-standard
probes.

127
0
2000
4000
6000
8000
10000
0
50
100
150
Probes
Correctly Identified
Borevitz
Cui
Greenhall
Rostoks
West
Contrast
RContrast
0.000
0.005
0.010
0.015
0.020
0.025
0.0
0.1
0.2
0.3
0.4
0.5
0.6
1−specificity
sensitivity
Borevitz
Cui
Greenhall
Rostoks
West
Contrast
RContrast
0
1000
2000
3000
4000
5000
6000
0
50
100
150
200
250
Probes
Correctly Identified
Borevitz
Cui
Greenhall
Rostoks
West
Contrast
RContrast
0.0
0.2
0.4
0.6
0.8
1.0
0.0
0.2
0.4
0.6
0.8
1.0
1−specificity
sensitivity
Borevitz
Cui
Greenhall
Rostoks
West
Contrast
RContrast
Figure 4.3
Maize Data: Endosperm 13 DAP Tissue. Performance of the
methods for SFP discovery in the maize Endosperm 13 DAP tis-
sue. Top Left: The number of correctly identiﬁed SFPs when
the top 10, 20,. . ., 10000 probes among all probes were declared
to contain SFPs. Top Right: ROC curves corresponding to the
seven methods when using all the probes in the data set. Bot-
tom Left: The number of correctly identiﬁed SFPs when the
top 1, 5,. . ., 6489 probes among all gold-standard probes were
declared to contain SFPs. Bottom Right: ROC curves corre-
sponding to the seven methods when using only gold-standard
probes.

128
0
2000
4000
6000
8000
10000
0
50
100
150
Probes
Correctly Identified
Borevitz
Cui
Greenhall
Rostoks
West
Contrast
RContrast
0.000
0.005
0.010
0.015
0.020
0.025
0.030
0.0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
1−specificity
sensitivity
Borevitz
Cui
Greenhall
Rostoks
West
Contrast
RContrast
0
1000
2000
3000
4000
5000
6000
0
50
100
150
200
250
Probes
Correctly Identified
Borevitz
Cui
Greenhall
Rostoks
West
Contrast
RContrast
0.0
0.2
0.4
0.6
0.8
1.0
0.0
0.2
0.4
0.6
0.8
1.0
1−specificity
sensitivity
Borevitz
Cui
Greenhall
Rostoks
West
Contrast
RContrast
Figure 4.4
Maize Data: Immature Ear Tissue. Performance of the meth-
ods for SFP discovery in the maize Ear tissue. Top Left: The
number of correctly identiﬁed SFPs when the top 10, 20,. . .,
10000 probes among all probes were declared to contain SFPs.
Top Right: ROC curves corresponding to the seven methods
when using all the probes in the data set. Bottom Left: The
number of correctly identiﬁed SFPs when the top 1, 5,. . ., 6489
probes among all gold-standard probes were declared to contain
SFPs. Bottom Right: ROC curves corresponding to the seven
methods when using only gold-standard probes.

129
0
2000
4000
6000
8000
10000
0
50
100
150
Probes
Correctly Identified
Borevitz
Cui
Greenhall
Rostoks
West
Contrast
RContrast
0.000
0.005
0.010
0.015
0.020
0.0
0.1
0.2
0.3
0.4
0.5
0.6
1−specificity
sensitivity
Borevitz
Cui
Greenhall
Rostoks
West
Contrast
RContrast
0
1000
2000
3000
4000
5000
6000
0
50
100
150
200
250
Probes
Correctly Identified
Borevitz
Cui
Greenhall
Rostoks
West
Contrast
RContrast
0.0
0.2
0.4
0.6
0.8
1.0
0.0
0.2
0.4
0.6
0.8
1.0
1−specificity
sensitivity
Borevitz
Cui
Greenhall
Rostoks
West
Contrast
RContrast
Figure 4.5
Maize Data: 19 DAP Embryo Tissue. Performance of the meth-
ods for SFP discovery in the maize Embryo tissue. Top Left:
The number of correctly identiﬁed SFPs when the top 10, 20,. . .,
10000 probes among all probes were declared to contain SFPs.
Top Right: ROC curves corresponding to the seven methods
when using all the probes in the data set. Bottom Left: The
number of correctly identiﬁed SFPs when the top 1, 5,. . ., 6489
probes among all gold-standard probes were declared to contain
SFPs. Bottom Right: ROC curves corresponding to the seven
methods when using only gold-standard probes.

130
0
2000
4000
6000
8000
10000
0
50
100
150
Probes
Correctly Identified
Borevitz
Cui
Greenhall
Rostoks
West
Contrast
RContrast
0.000
0.005
0.010
0.015
0.0
0.1
0.2
0.3
0.4
0.5
0.6
1−specificity
sensitivity
Borevitz
Cui
Greenhall
Rostoks
West
Contrast
RContrast
0
1000
2000
3000
4000
5000
6000
0
50
100
150
200
250
Probes
Correctly Identified
Borevitz
Cui
Greenhall
Rostoks
West
Contrast
RContrast
0.0
0.2
0.4
0.6
0.8
1.0
0.0
0.2
0.4
0.6
0.8
1.0
1−specificity
sensitivity
Borevitz
Cui
Greenhall
Rostoks
West
Contrast
RContrast
Figure 4.6
Maize Data: Seedling Tissue. Performance of the methods for
SFP discovery in the maize Seedling tissue.
Top Left: The
number of correctly identiﬁed SFPs when the top 10, 20,. . .,
10000 probes among all probes were declared to contain SFPs.
Top Right: ROC curves corresponding to the seven methods
when using all the probes in the data set. Bottom Left: The
number of correctly identiﬁed SFPs when the top 1, 5,. . ., 6489
probes among all gold-standard probes were declared to contain
SFPs. Bottom Right: ROC curves corresponding to the seven
methods when using only gold-standard probes.

131
0
2000
4000
6000
8000
10000
0
50
100
150
200
250
Probes
Correctly Identified
Borevitz
Cui
Greenhall
Rostoks
West
Contrast
RContrast
0.00
0.01
0.02
0.03
0.04
0.05
0.0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
1−specificity
sensitivity
Borevitz
Cui
Greenhall
Rostoks
West
Contrast
RContrast
0
500
1000
1500
2000
2500
0
100
200
300
400
Probes
Correctly Identified
Borevitz
Cui
Greenhall
Rostoks
West
Contrast
RContrast
0.0
0.2
0.4
0.6
0.8
1.0
0.0
0.2
0.4
0.6
0.8
1.0
1−specificity
sensitivity
Borevitz
Cui
Greenhall
Rostoks
West
Contrast
RContrast
Figure 4.7
Barley Data: RAD Tissue. Performance of the methods for SFP
discovery in the Barley RAD tissue. Top Left: The number of
correctly identiﬁed SFPs when the top 10, 20,. . ., 10000 probes
among all probes were declared to contain SFPs. Top Right:
ROC curves corresponding to the seven methods when using
all the probes in the data set. Bottom Left: The number of
correctly identiﬁed SFPs when the top 1, 5,. . ., 2601 probes
among all gold-standard probes were declared to contain SFPs.
Bottom Right: ROC curves corresponding to the seven methods
when using only gold-standard probes.

132
0
2000
4000
6000
8000
10000
0
50
100
150
200
250
Probes
Correctly Identified
Borevitz
Cui
Greenhall
Rostoks
West
Contrast
RContrast
0.00
0.01
0.02
0.03
0.04
0.0
0.1
0.2
0.3
0.4
0.5
0.6
1−specificity
sensitivity
Borevitz
Cui
Greenhall
Rostoks
West
Contrast
RContrast
0
500
1000
1500
2000
2500
0
100
200
300
400
Probes
Correctly Identified
Borevitz
Cui
Greenhall
Rostoks
West
Contrast
RContrast
0.0
0.2
0.4
0.6
0.8
1.0
0.0
0.2
0.4
0.6
0.8
1.0
1−specificity
sensitivity
Borevitz
Cui
Greenhall
Rostoks
West
Contrast
RContrast
Figure 4.8
Barley Data: COL Tissue. Performance of the methods for SFP
discovery in the Barley COL tissue. Top Left: The number of
correctly identiﬁed SFPs when the top 10, 20,. . ., 10000 probes
among all probes were declared to contain SFPs. Top Right:
ROC curves corresponding to the seven methods when using
all the probes in the data set. Bottom Left: The number of
correctly identiﬁed SFPs when the top 1, 5,. . ., 2601 probes
among all gold-standard probes were declared to contain SFPs.
Bottom Right: ROC curves corresponding to the seven methods
when using only gold-standard probes.

133
0
2000
4000
6000
8000
10000
0
50
100
150
200
250
Probes
Correctly Identified
Borevitz
Cui
Greenhall
Rostoks
West
Contrast
RContrast
0.00
0.01
0.02
0.03
0.04
0.05
0.06
0.0
0.1
0.2
0.3
0.4
0.5
0.6
1−specificity
sensitivity
Borevitz
Cui
Greenhall
Rostoks
West
Contrast
RContrast
0
500
1000
1500
2000
2500
0
100
200
300
400
Probes
Correctly Identified
Borevitz
Cui
Greenhall
Rostoks
West
Contrast
RContrast
0.0
0.2
0.4
0.6
0.8
1.0
0.0
0.2
0.4
0.6
0.8
1.0
1−specificity
sensitivity
Borevitz
Cui
Greenhall
Rostoks
West
Contrast
RContrast
Figure 4.9
Barley Data: CRO Tissue. Performance of the methods for SFP
discovery in the Barley CRO tissue. Top Left: The number of
correctly identiﬁed SFPs when the top 10, 20,. . ., 10000 probes
among all probes were declared to contain SFPs. Top Right:
ROC curves corresponding to the seven methods when using
all the probes in the data set. Bottom Left: The number of
correctly identiﬁed SFPs when the top 1, 5,. . ., 2601 probes
among all gold-standard probes were declared to contain SFPs.
Bottom Right: ROC curves corresponding to the seven methods
when using only gold-standard probes.

134
0
2000
4000
6000
8000
10000
0
50
100
150
200
250
300
Probes
Correctly Identified
Borevitz
Cui
Greenhall
Rostoks
West
Contrast
RContrast
0.00
0.01
0.02
0.03
0.04
0.05
0.0
0.2
0.4
0.6
1−specificity
sensitivity
Borevitz
Cui
Greenhall
Rostoks
West
Contrast
RContrast
0
500
1000
1500
2000
2500
0
100
200
300
400
Probes
Correctly Identified
Borevitz
Cui
Greenhall
Rostoks
West
Contrast
RContrast
0.0
0.2
0.4
0.6
0.8
1.0
0.0
0.2
0.4
0.6
0.8
1.0
1−specificity
sensitivity
Borevitz
Cui
Greenhall
Rostoks
West
Contrast
RContrast
Figure 4.10
Barley Data: GEM Tissue. Performance of the methods for
SFP discovery in the Barley GEM tissue. Top Left: The num-
ber of correctly identiﬁed SFPs when the top 10, 20,. . ., 10000
probes among all probes were declared to contain SFPs. Top
Right: ROC curves corresponding to the seven methods when
using all the probes in the data set. Bottom Left: The num-
ber of correctly identiﬁed SFPs when the top 1, 5,. . ., 2601
probes among all gold-standard probes were declared to con-
tain SFPs. Bottom Right: ROC curves corresponding to the
seven methods when using only gold-standard probes.

135
0
2000
4000
6000
8000
10000
0
50
100
150
200
Probes
Correctly Identified
Borevitz
Cui
Greenhall
Rostoks
West
Contrast
RContrast
0.00
0.01
0.02
0.03
0.04
0.0
0.1
0.2
0.3
0.4
0.5
1−specificity
sensitivity
Borevitz
Cui
Greenhall
Rostoks
West
Contrast
RContrast
0
500
1000
1500
2000
2500
0
100
200
300
400
Probes
Correctly Identified
Borevitz
Cui
Greenhall
Rostoks
West
Contrast
RContrast
0.0
0.2
0.4
0.6
0.8
1.0
0.0
0.2
0.4
0.6
0.8
1.0
1−specificity
sensitivity
Borevitz
Cui
Greenhall
Rostoks
West
Contrast
RContrast
Figure 4.11
Barley Data: LEA Tissue. Performance of the methods for
SFP discovery in the Barley LEA tissue. Top Left: The num-
ber of correctly identiﬁed SFPs when the top 10, 20,. . ., 10000
probes among all probes were declared to contain SFPs. Top
Right: ROC curves corresponding to the seven methods when
using all the probes in the data set. Bottom Left: The num-
ber of correctly identiﬁed SFPs when the top 1, 5,. . ., 2601
probes among all gold-standard probes were declared to con-
tain SFPs. Bottom Right: ROC curves corresponding to the
seven methods when using only gold-standard probes.

136
0
2000
4000
6000
8000
10000
0
50
100
150
200
250
Probes
Correctly Identified
Borevitz
Cui
Greenhall
Rostoks
West
Contrast
RContrast
0.00
0.01
0.02
0.03
0.04
0.05
0.0
0.1
0.2
0.3
0.4
0.5
0.6
1−specificity
sensitivity
Borevitz
Cui
Greenhall
Rostoks
West
Contrast
RContrast
0
500
1000
1500
2000
2500
0
100
200
300
400
Probes
Correctly Identified
Borevitz
Cui
Greenhall
Rostoks
West
Contrast
RContrast
0.0
0.2
0.4
0.6
0.8
1.0
0.0
0.2
0.4
0.6
0.8
1.0
1−specificity
sensitivity
Borevitz
Cui
Greenhall
Rostoks
West
Contrast
RContrast
Figure 4.12
Barley Data: ROO Tissue. Performance of the methods for
SFP discovery in the Barley ROO tissue. Top Left: The num-
ber of correctly identiﬁed SFPs when the top 10, 20,. . ., 10000
probes among all probes were declared to contain SFPs. Top
Right: ROC curves corresponding to the seven methods when
using all the probes in the data set. Bottom Left: The num-
ber of correctly identiﬁed SFPs when the top 1, 5,. . ., 2601
probes among all gold-standard probes were declared to con-
tain SFPs. Bottom Right: ROC curves corresponding to the
seven methods when using only gold-standard probes.

137
1
2
3
4
5
6
7
8
9
10
11
Probe Number
di
−0.5
0.0
0.5
1.0
1.5
2.0
2.5
3.0
Time 1
Time 2
Time 3
Time 4
Time 5
1
2
3
4
5
6
7
8
9
10
11
Probe Number
di
−0.5
0.0
0.5
1.0
1.5
2.0
2.5
3.0
Time 1
Time 2
Time 3
Time 4
Time 5
1
2
3
4
5
6
7
8
9
10
11
Probe Number
di
0
1
2
3
Time 1
Time 2
Time 3
Time 4
Time 5
1
2
3
4
5
6
7
8
9
10
11
Probe Number
di
0
1
2
3
Time 1
Time 2
Time 3
Time 4
Time 5
Figure 4.13
Soybean Data: SFPs in Probe set Gma.734.1.A1 at. For the
ﬁve time points, each panel shows di values of 11 probes in the
probe set Gma.734.1.A1 at which is identiﬁed to have SFP in
Probe 9. Top Left: BC1 versus L, Top Right: BC2 versus L,
Bottom Left: BC3 versus L, and Bottom Right: H versus L.

138
1
2
3
4
5
6
7
8
9
10
11
Probe Number
di
0
1
2
3
4
Time 1
Time 2
Time 3
Time 4
Time 5
1
2
3
4
5
6
7
8
9
10
11
Probe Number
di
0
1
2
3
4
Time 1
Time 2
Time 3
Time 4
Time 5
1
2
3
4
5
6
7
8
9
10
11
Probe Number
di
0
1
2
3
4
5
Time 1
Time 2
Time 3
Time 4
Time 5
1
2
3
4
5
6
7
8
9
10
11
Probe Number
di
0
1
2
3
4
5
Time 1
Time 2
Time 3
Time 4
Time 5
Figure 4.14
Soybean Data: SFPs in Probe set Gma.11144.2.S1 at.
For
ﬁve time points, each panel shows di values of 11 probes in the
probe set Gma.11144.2.S1 at which is identiﬁed to have SFPs
in Probes 10 and 11. Top Left: BC1 versus L, Top Right: BC2
versus L, Bottom Left: BC3 versus L, and Bottom Right: H
versus L.

139
1
2
3
4
5
6
7
8
9
10
11
Probe Number
di
0
1
2
3
4
Time 1
Time 2
Time 3
Time 4
Time 5
1
2
3
4
5
6
7
8
9
10
11
Probe Number
di
0
1
2
3
Time 1
Time 2
Time 3
Time 4
Time 5
1
2
3
4
5
6
7
8
9
10
11
Probe Number
di
−1
0
1
2
3
4
Time 1
Time 2
Time 3
Time 4
Time 5
1
2
3
4
5
6
7
8
9
10
11
Probe Number
di
−1
0
1
2
3
4
Time 1
Time 2
Time 3
Time 4
Time 5
Figure 4.15
Soybean Data: SFPs in Probe set GmaAﬀx.39499.1.S1 at. For
ﬁve time points, each panel shows di values of 11 probes in the
probe set GmaAﬀx.39499.1.S1 at which is identiﬁed to have
SFPs in Probes 7, 8, and 9. Top Left: BC1 versus L, Top
Right: BC2 versus L, Bottom Left: BC3 versus L, and Bottom
Right: H versus L.

140
1
2
3
4
5
Time
di
−0.5
0.0
0.5
1.0
1.5
2.0
2.5
3.0
1
2
3
4
5
6
7
8
9
10
11
1
2
3
4
5
Time
di
−0.5
0.0
0.5
1.0
1.5
2.0
2.5
3.0
1
2
3
4
5
6
7
8
9
10
11
1
2
3
4
5
Time
di
0
1
2
3
1
2
3
4
5
6
7
8
9
10
11
1
2
3
4
5
Time
di
0
1
2
3
1
2
3
4
5
6
7
8
9
10
11
Figure 4.16
Soybean Data: SFPs in Probe set Gma.734.1.A1 at. At ﬁve
time points, each panel shows di values of 11 probes in the
probe set Gma.734.1.A1 at which is identiﬁed to have SFP in
Probe 9. Top Left: BC1 versus L, Top Right: BC2 versus L,
Bottom Left: BC3 versus L, and Bottom Right: H versus L.

141
1
2
3
4
5
Time
di
0
1
2
3
4
1
2
3
4
5
6
7
8
9
10
11
1
2
3
4
5
Time
di
0
1
2
3
4
1
2
3
4
5
6
7
8
9
10
11
1
2
3
4
5
Time
di
0
1
2
3
4
5
1
2
3
4
5
6
7
8
9
10
11
1
2
3
4
5
Time
di
0
1
2
3
4
5
1
2
3
4
5
6
7
8
9
10
11
Figure 4.17
Soybean Data: SFPs in Probe set Gma.11144.2.S1 at. At ﬁve
time points, each panel shows di values of 11 probes in the
probe set Gma.11144.2.S1 at which is identiﬁed to have SFPs
in Probes 10 and 11. Top Left: BC1 versus L, Top Right: BC2
versus L, Bottom Left: BC3 versus L, and Bottom Right: H
versus L.

142
1
2
3
4
5
Time
di
0
1
2
3
4
1
2
3
4
5
6
7
8
9
10
11
1
2
3
4
5
Time
di
0
1
2
3
1
2
3
4
5
6
7
8
9
10
11
1
2
3
4
5
Time
di
−1
0
1
2
3
4
1
2
3
4
5
6
7
8
9
10
11
1
2
3
4
5
Time
di
−1
0
1
2
3
4
1
2
3
4
5
6
7
8
9
10
11
Figure 4.18
Soybean Data: SFPs in Probe set GmaAﬀx.39499.1.S1 at. At
ﬁve time points, each panel shows di values of 11 probes in the
probe set GmaAﬀx.39499.1.S1 at which is identiﬁed to have
SFPs in Probes 7, 8, and 9. Top Left: BC1 versus L, Top
Right: BC2 versus L, Bottom Left: BC3 versus L, and Bottom
Right: H versus L.

143
CHAPTER 5.
General Conclusion
In the ﬁrst research chapter of this thesis, we proposed a method that combines results
from the ﬁt of full and selected linear mixed models to identify diﬀerentially expressed genes
and provide FDR control at target levels when the true underlying random eﬀects structure
varies across genes. Our simulation illustrated that the performance of our hybrid method
is not eﬀected by the proportion of non-null genes in the data set. We also showed that our
method is robust with respect to the presence of outlying observations and the method can
tolerate some level of missing data.
It is also observed that our hybrid procedure provide
conservative FDR levels maybe far below nominal. This situation results because the operator
characteristics of testing following model selection are far superior to those of the ANOVA
method alone. We are of the traditional opinion that an error rate below nominal is preferred
to an error rate above nominal.
Nonetheless, there is room to improve the power of our
proposed procedures, and we hope to address this issue in future research.
In the second research chapter, we have introduced a hierarchical Bayesian analysis method
for discovering diﬀerentially expressed genes when a microarray experiment involves multiple
sources of variation through the inclusion of multiple random factors. When microarray ex-
periment have complex experimental design and the sample size for each gene is small, the
analysis with the classical gene-by-gene mixed linear model suﬀers from low degrees of freedom
to estimate all the model parameter considered in the model. Our hierarchical Bayesian model
borrows strength across genes by for estimating the gene speciﬁc model parameters. Instead of
inverse gamma or uniform priors, this model make use of the half-Cauchy priors for the standard
deviation parameters of the random factors with few eﬀects. Simulation study showed that
our hierarchical Bayesian approach is much powerful than a traditional gene-by-gene mixed

144
linear model analysis at distinguishing diﬀerentially expressed genes from non-diﬀerentially
expressed genes. Although our proposed methodology provides better ordering of the genes,
further work needs to be done in developing the next level of hierarchical models, in which we
should be able to estimate the false discovery rate to ﬁnd a reasonable cutoﬀpoint on the list.
Therefore, in a classical gene-by-gene mixed linear model analysis, there will be very few
degrees of freedom to estimate the variance components In the ﬁnal research chapter, we dis-
cuss about the identiﬁcation of Single Feature Polymorphisms (SFPs) from oligonucleotide
arrays. This is important for producing more accurate expression measurements when com-
paring samples of diﬀerent genotypes. To identify SFPs from oligonucleotide array data, we
have developed two new statistical algorithms where a diﬀerence value is deﬁned for each probe
after accounting for the overall gene expression level diﬀerences in the probe set. First method
contrast the diﬀerence value of each probe with the average of the diﬀerence values for the rest
of the probes in that probe set. Second method is a robust version of the ﬁrst method. We also
summarized several SFPs discovery methods in the literature. The performance of all these
methods were compared with the performance of our proposed methods by using two publicly
available data sets. Our methods provided a better ordering of the probes for evidence of SFPs
than other methods for most of the data sets we presented.

145
ACKNOWLEDGEMENTS
I would like to express my sincere thanks to my major professors Dr. Dan Nettleton and Dr.
Taps Maiti for their guidance through my studies. I am incredible grateful to Dr. Nettleton
who helped me with various aspects of conducting research and the writing of this thesis. He
has always been prompt to respond my questions and been available at all times.
Special thanks to my parents for their understanding and unconditional support throughout
all stages of this hard but equally rewarding years at Iowa State.
I ﬁnally thank Dr. Alicia Carriquiry, Dr. Heike Hofmann, and Dr. Roger Wise for serving
in my dissertation committee.

