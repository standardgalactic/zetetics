Bayesian Inference of Manning’s n coeﬃcient of a
Storm Surge Model: an Ensemble Kalman ﬁlter
vs. a polynomial chaos-based MCMC
Thesis by
Adil Siripatana
In Partial Fulﬁllment of the Requirements
For the Degree of
Masters of Science
King Abdullah University of Science and Technology, Thuwal,
Kingdom of Saudi Arabia
Insert Date (August, 2014)

2
Bayesian Inference of Manning’s n coeﬃcient of a Storm Surge Model: an Ensemble
Kalman ﬁlter vs. a polynomial chaos-based MCMC
Committee Chairperson: Ibrahim Hoteit
Committee Member: Omar M. Knio
Committee Member: Shuyu Sun

3
Copyright ©2014
Adil Siripatana
All Rights Reserved

4
ABSTRACT
Bayesian Inference of Manning’s n coeﬃcient in a Storm Surge
Model Framework: comparison between Kalman ﬁlter and
polynomial based method
Adil Siripatana
Conventional coastal ocean models solve the shallow water equations, which de-
scribe the conservation of mass and momentum when the horizontal length scale is
much greater than the vertical length scale. In this case vertical pressure gradients
in the momentum equations are nearly hydrostatic. The outputs of coastal ocean
models are thus sensitive to the bottom stress terms deﬁned through the formulation
of Manning’s n coeﬃcients. this thesis considers the Bayesian inference problem of
the Manning’s n coeﬃcient in the context of storm surge based on the coastal ocean
ADCIRC model.
In the ﬁrst part if the thesis, we apply an ensemble-based Kalman ﬁlter, the
singular evolutive interpolated Kalman (SEIK) ﬁlter to estimate both a constant
Manning’s n coeﬃcient and a 2-D parameterized Manning’s coeﬃcient on one ideal
and one of more realistic domain using observation system simulation experiments
(OSSEs). We study the sensitivity of the system to the ensemble size. we also access
the beneﬁts from using an inﬂation factor on the ﬁlter performance.
To study the limitation of the Guassian restricted assumption on the SEIK ﬁlter,

5
we also implemented in the second part of this thesis a Markov Chain Monte Carlo
(MCMC) method based on a Generalized Polynomial chaos (gPc) approach for the
estimation of the 1-D and 2-D Mannning’s n coeﬃcient. The gPc is used to build a
surrogate model that imitate the ADCIRC model in order to make the computational
cost of implementing the MCMC with the ADCIRC model reasonable.
We evaluate the performance of the MCMC-gPc approach and study its robustness
to diﬀerent OSSEs scenario. we also compare its estimates with those resulting from
SEIK in term of parameter estimates and full distributions. we present a full analysis
of the solution of these two methods, of the contexts of their algorithms, and make
recommendation for fully realistic application.

6
ACKNOWLEDGEMENTS
I would like to declare the highest gratitude toward my advisor, Prof. Ibrahim Hoteit,
for your guidance throughout the process of the thesis study, for providing me abundant
amount of resources and connections needed for me to ﬁnish the work. I also would
like to give a big thanks to Dr.Talea Mayo and Dr.Ihab Sraj for your knowledge and
assistance, for teaching me the researching procedures in details. It is also my pleasure
to thank Prof. Omar M. Knio, Prof. Shuyu Sun and Prof.Olivier Le Maitre, as a
very strong committee, giving me such a deep and broad perspectives in the ﬁeld of
my on-going research. Finally, I would like to thank my family who always supported
me.

7
TABLE OF CONTENTS
Examination Committee Approval
2
Copyright
3
Abstract
4
Acknowledgements
6
List of Figures
9
List of Tables
13
1
Introduction
14
1.1
Problem descriptions . . . . . . . . . . . . . . . . . . . . . . . . . . .
16
1.2
Bayesian viewpoint on parameter estimation problems . . . . . . . . .
18
1.2.1
The dynamic models and measurements
. . . . . . . . . . . .
18
1.2.2
Bayesian formulation . . . . . . . . . . . . . . . . . . . . . . .
20
1.2.3
Recursive formulation of Bayes’ rule . . . . . . . . . . . . . . .
21
1.3
Related studies . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
25
1.4
Thesis objectives and outline . . . . . . . . . . . . . . . . . . . . . . .
26
2
ADCIRC model
28
2.1
The Shallow Water Equations . . . . . . . . . . . . . . . . . . . . . .
29
2.2
ADCIRC Features and Capabilities . . . . . . . . . . . . . . . . . . .
32
2.2.1
Model Inputs . . . . . . . . . . . . . . . . . . . . . . . . . . .
32
2.2.2
Model Outputs . . . . . . . . . . . . . . . . . . . . . . . . . .
33
2.2.3
Parallel implementation
. . . . . . . . . . . . . . . . . . . . .
33
2.3
Experimental setups
. . . . . . . . . . . . . . . . . . . . . . . . . . .
34
2.3.1
Observation Simulation System Experiments . . . . . . . . . .
34
2.3.2
Computational Domains . . . . . . . . . . . . . . . . . . . . .
35
2.3.3
Parameterizing a ﬁeld of Manning’s n Coeﬃcient
. . . . . . .
37

8
2.3.4
Parameter estimation methodology . . . . . . . . . . . . . . .
37
3
Manning’s coeﬃcient estimation with SEIK
41
3.1
Kalman ﬁltering applications in shallow water model
. . . . . . . . .
42
3.2
Kalman ﬁltering and its variants . . . . . . . . . . . . . . . . . . . . .
43
3.3
The SEIK ﬁlter for state estimation . . . . . . . . . . . . . . . . . . .
47
3.4
The SEIK ﬁlter for parameter estimation . . . . . . . . . . . . . . . .
49
3.5
Numerical results and discussion . . . . . . . . . . . . . . . . . . . . .
51
3.5.1
Constant Manning’s n coeﬃcient
. . . . . . . . . . . . . . . .
52
3.5.2
A ﬁeld of piecewise constant Manning’s n coeﬃcients . . . . .
53
3.6
The eﬀect of increasing ensembles size
. . . . . . . . . . . . . . . . .
55
3.7
The eﬀect of using inﬂation factor . . . . . . . . . . . . . . . . . . . .
56
3.8
Discussions
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
57
4
PC-MCMC based for Manning’s n coeﬃcient estimation
74
4.1
MCMC theory and Algorithm . . . . . . . . . . . . . . . . . . . . . .
76
4.2
Polynomial Chaos, Theory and Methodology . . . . . . . . . . . . . .
79
4.2.1
Linear systems
. . . . . . . . . . . . . . . . . . . . . . . . . .
81
4.2.2
Nonlinear systems . . . . . . . . . . . . . . . . . . . . . . . . .
84
4.2.3
Polynomial chaos quadrature
. . . . . . . . . . . . . . . . . .
85
4.2.4
Non-intrusive spectral projection (NISP) . . . . . . . . . . . .
88
4.3
ADCIRC uncertainties recast as stochastic variables . . . . . . . . . .
92
4.3.1
PC representation of ADCIRC model for the idealized ebb shoal 93
4.4
Manning’s n coeﬃcient estimation using PC-based ADCIRC model
and MCMC . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
94
4.5
Conclusion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
95
5
Concluding Remarks
109
References
113

9
LIST OF FIGURES
2.1
idealized inlet with ebb shoal domain . . . . . . . . . . . . . . . . . .
35
2.2
Galveston Bay domain . . . . . . . . . . . . . . . . . . . . . . . . . .
36
3.1
point estimation of various constant Manning’s n ﬁelds parameterized
for the idealized inlet with ebb shoal case.
. . . . . . . . . . . . . . .
59
3.2
Estimates of various Manning’s n ﬁelds parameterized by a single value
for the idealized inlet with ebb shoal case using 10 ensemble members.
The width of the pdf from the mean is equal to 3th standard deviation. 60
3.3
point estimation of various constant Manning’s n ﬁelds parameterized
for Galveston Bay.
. . . . . . . . . . . . . . . . . . . . . . . . . . . .
61
3.4
Estimates of various Manning’s n ﬁelds parameterized by a single value
for Galveston Bay. The width of the pdf from the mean is equal to 3th
standard deviation. . . . . . . . . . . . . . . . . . . . . . . . . . . . .
62
3.5
point estimates of α (left) and β (right) from various initial guesses for
the idealized inlet with ebb shoal case.
. . . . . . . . . . . . . . . . .
63
3.6
pdf estimates of α (left) and β (right) from various initial guesses for
the idealized inlet with ebb shoal case using 10 ensembles.
. . . . . .
63
3.7
point estimates of β from various initial guesses with the same α for
Galveston bay case. . . . . . . . . . . . . . . . . . . . . . . . . . . . .
63
3.8
point estimates of β from various initial guesses with the same α for
Galveston bay case using 10 ensembles. . . . . . . . . . . . . . . . . .
64
3.9
Comparison of the posterior distribution resulting from SEIK for con-
stant Manning’s n coeﬃcient with three diﬀerent number of ensembles
and initial guess = 0.015. (Left column) the 95 percentile over time,
(Right column) the pdf of the posterior at the end of the simulations.
65
3.10 Comparison of the posterior distribution resulting from SEIK for con-
stant Manning’s n coeﬃcient with three diﬀerent number of ensembles
and initial guess = 0.06. (Left column) the 95 percentile over time,
(Right column) the pdf of the posterior at the end of the simulations.
66

10
3.11 Comparison of the posterior distribution result from SEIK for piecewise
Manning’s n coeﬃcient in the open ocean with diﬀerent number of
ensembles from several initial guesses. (Left column) the 95 percentile
over time, (Right column) the pdf of the posterior at the end of the
simulations. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
67
3.12 Comparison of the posterior distribution result from SEIK for piecewise
Manning’s n coeﬃcient in the landlocked area with diﬀerent number of
ensembles from several initial guesses. (Left column) the 95 percentile
over time, (Right column) the pdf of the posterior at the end of the
simulations. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
68
3.13 Estimates of various true Manning’s n ﬁelds parameterized by a single
value for the idealized inlet with ebb shoal case using 10 ensemble
members with inﬂation factor of 0.5. The width of the pdf from the
mean is equal to 3th standard deviation. . . . . . . . . . . . . . . . .
69
3.14 Comparison of the posterior distribution result from SEIK for constant
Manning’s n coeﬃcient between SEIK and SEIK with inﬂation factor,
initial guess = 0.015. (Left column) the 95 percentile over time, (Right
column) the pdf of the posterior at the end of the simulations. . . . .
70
3.15 Comparison of the posterior distribution result from SEIK for constant
Manning’s n coeﬃcient between SEIK and SEIK with inﬂation factor,
initial guess = 0.06. (Left column) the 95 percentile over time, (Right
column) the pdf of the posterior at the end of the simulations. . . . .
71
3.16 Comparison of the posterior distribution result from SEIK for 2D piece-
wise Manning’s n coeﬃcient between SEIK and SEIK with inﬂation
factor in the open ocean of idealized inlet case. (Left column) the 95
percentile over time, (Right column) the pdf of the posterior at the
end of the simulations. . . . . . . . . . . . . . . . . . . . . . . . . . .
72
3.17 Comparison of the posterior distribution result from SEIK for 2D piece-
wise Manning’s n coeﬃcient between SEIK and SEIK with inﬂation
factor in the open ocean of idealized inlet case. (Left column) the 95
percentile over time, (Right column) the pdf of the posterior at the
end of the simulations. . . . . . . . . . . . . . . . . . . . . . . . . . .
73

11
4.1
(Left) The distributions of the ADCIRC surrogate model output(water
elevation) of idealized Ebb Shoal case with several polynomial orders at
the selected points and times. The distributions is created by a million
samples. (Right) Polynomial chaos coeﬃcients at the corresponding
points and times. . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
97
4.2
(Left) The distributions of the ADCIRC surrogate model output(water
elevation) of idealized Ebb Shoal case with several polynomial orders at
the selected points and times. The distributions is created by a million
samples. (Right) Polynomial chaos coeﬃcients at the corresponding
points and times. . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
98
4.3
(Left) The distributions of the ADCIRC surrogate model output(water
elevation) of idealized Ebb Shoal case with several polynomial orders at
the selected points and times. The distributions is created by a million
samples. (Right) Polynomial chaos coeﬃcients at the corresponding
points and times. . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
99
4.4
(Right) Water elevations simulated in time from the true model and
the surrogate model at several quadrature points (diﬀerent Manning’s
n coeﬃcients). (Left) The residuals. . . . . . . . . . . . . . . . . . . .
100
4.5
The comparisons between the posterior distributions of 1D Manning’s
n coeﬃcient between SEIK ﬁlter( after 108 analysis iterations)and
MCMC method. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
101
4.6
The comparisons between the posterior distributions of 1D Manning’s
n coeﬃcient between SEIK ﬁlter( after 108 analysis iterations)and
MCMC method. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
102
4.7
The comparisons between the posterior distributions of 1D Manning’s
n coeﬃcient between SEIK ﬁlter( after 108 analysis iterations)and
MCMC method. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
103
4.8
The comparisons between the posterior distributions of 1D Manning’s
n coeﬃcient between SEIK ﬁlter with inﬂation( after 108 analysis it-
erations)and MCMC method.
. . . . . . . . . . . . . . . . . . . . . .
104
4.9
The comparisons between the posterior distributions of 1D Manning’s
n coeﬃcient between SEIK ﬁlter with inﬂation( after 108 analysis it-
erations)and MCMC method.
. . . . . . . . . . . . . . . . . . . . . .
105
4.10 The comparisons between the posterior distributions of 1D Manning’s
n coeﬃcient between SEIK ﬁlter with inﬂation( after 108 analysis it-
erations)and MCMC method.
. . . . . . . . . . . . . . . . . . . . . .
106

12
4.11 The comparisons between the posterior distributions of 2D Manning’s
n coeﬃcient between SEIK ﬁlter( after 108th analysis iterations)and
MCMC method, (Right) the distributions of α, (Left) the distribution
of β . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
107
4.12 The comparisons between the posterior distributions of 2D Manning’s
n coeﬃcient between SEIK ﬁlter( after 108th analysis iterations)and
MCMC method, (Right) the distributions of α, (Left) the distribution
of β. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
108

13
LIST OF TABLES
2.1
Values of the Manning’s n coeﬃcient for various surfaces.
the left
columns in the tables describe the land characteristics and the right
columns are the associated empirically deﬁned Manning’s n coeﬃcients. 31
4.1
The type of generalized polynomial chaos and their corresponding ran-
dom variables . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
80
4.2
The random input parameters for ADCIRC
. . . . . . . . . . . . . .
92
4.3
The random input parameters for RMSE between the true model and
the surrogate model (water elevations)
. . . . . . . . . . . . . . . . .
94

14
Chapter 1
Introduction
Coastal and estuarine systems are home to more than a half of the human population
[1, 2]. Understanding and forecasting the dynamics of coastal and estuarine systems
is critical for human sustenance around the world both economically and ecologically.
Coastal inundation during extreme events such as hurricanes and tsunamis is a major
cause of destruction to human lives and their habitats. Even in moderate conditions,
accurately forecasting the ocean states (e.g. tides and coastal ﬂows) is crucial for
human’s marine and related activities. Coastal ocean modeling has been extensively
utilized to simulate the main features of the ocean circulation such as water surface
elevation and currents, for the purposes of conservation, contaminant transport, de-
velopment of coastal structures (e.g. bridges, damps and breakwaters) and emergency
and economic planing.
Tidal and coastal ﬂows are very complex phenomena and cannot be easily pre-
dicted with even the most comprehensive mathematical models and computational
facilities available today [1, 2]. Instead of employing complex computational ﬂuid
dynamics, which require prohibitive computational cost, most researchers resort on
model simpliﬁcations to develop computationally less intensive techniques. The goal
is to obtain good enough models while balancing the usability and the resources
requirements.
State-of-the-art coastal ocean models are based on the shallow water equations

15
(SWEs), which are derived from the depth-integrating Navier−Stokes equations, as-
suming hydrostatic pressure and horizontal length scales that are large in comparison
to the vertical length scales. The result of this derivation is a ﬁrst−order hyper-
bolic continuity equation for water elevation coupled with the momentum equation
for horizontal depth-averaged velocities. The shallow water equations describe the
ﬂow below a pressure surface in a ﬂuid. Even at this level of simpliﬁcation, the model
contains many parameters, carrying uncertainties on which the accuracy of model pre-
diction depends [1]. Moreover, many of the parameters cannot be directly measured
or the relevant data to estimate these parameters are diﬃcult to collect [61]. Thus
the values of these parameters must be inferred and estimated using the data from
diﬀerent, but simpler to observe variables, which are not always be very accurate [3].
Quantifying and reducing the uncertainties in the model outputs associated with the
uncertainties in the parameter is essential for more reliable and robust storm surge
predictions [4]. Of particular importance in tides and storm surge prediction is the
Manning’s n coeﬃcient of roughness, introduced in the SWEs through the bottom
stress as components in the momentum equation [5, 6].
The traditional approach to estimate model parameters in coastal models is the
variational approach. This deterministic approach consists of looking for the param-
eter that best ﬁt the model to the collected data. The disadvantage of variational
methods is that they can be computational intensive and are diﬃcult to implement
because they normally require an adjoint model [67]. In addition, these methods are
not formulated for real-time parameter estimation, in the sense they are not suitable
for applications with highly transient and/or abrupt ﬂow regime changes, eg. as a
hurricane approaches landfall. Consequently recently developed statistical data as-
similation methods became more popular because they are non-intrusive and could be
implemented with reasonable computational cost. They also provide a framework to
quantify the uncertainty associated with the predicted model state. These methods

16
were ﬁrst developed for the estimation of the model state [4]. They have been re-
cently reformulated to include the estimation of the model parameter as well, though
it is not yet widely used in coastal modeling. Moreover, statistical data assimilation
methods are not based on physical principles, and may violate mass and momentum
conservation principles [73].
1.1
Problem descriptions
Statistical data assimilation methods are based on the Bayes rule, which states that
the probability distribution function (pdf) of the unknown parameters given available
data [7, 8], can be written as
π(θ | y) = p(y | θ)πpr(θ)
πY (y)
(1.1)
with π(θ | y) is the pdf of the unknown parameter θ given the observation y, p(y |
θ) is the likelihood function of obtaining data y if we have parameter value θ, πpr(θ) is
the prior distribution deﬁnes the prior knowledge of the parameters and ﬁnally, πY (y)
is the scaling factor, which is the density function of all possible measurements.
One popular approximation framework used to compute p(y | θ) is the well-known
Kalman ﬁlter (KF). The KF provides the best estimation of a quantity of interests
(QoIs) given the observations arrive sequentially in time for a linear system with
Gaussian noise assumption [9].
The parameter estimation problems is often dealing with nonlinear system. One
popular approach that has been developed in oceanography to cope with the non-
linearity of the ocean modeling problem is the Ensemble Kalman ﬁlter (EnKF) and
its variants [10, 11, 12, 13]. The EnKF avoid the linearity of the system by using
an ensemble of realizations of the unknown parameter, which is used to estimate the

17
ﬁrst two moments of the quantity estimated assuming a Gaussian distribution. The
parameter correction step can then be applied every time new observations become
available. EnKF methods can be divided into stochastic EnKF which perturb the
observations in each assimilation cycle and deterministic EnKF which do not require
perturbing the observations [14, 15].
In the last decade, Bayesian framework was established as a preferred method
for uncertainty quantiﬁcation and calibration of computer simulation.
Since then
the interest in the application of Bayesian approach in calibration of parameters in
stochastic models have grown exponentially [16, 17, 18, 19, 20].
One of the appealing features of Bayesian approach is the ability to provide the
complete posterior estimation and statistics. However, this approach requires sta-
tistical sampling techniques to obtain the solutions of the Bayesian calibration and
uncertainty propagation.
For this purpose, Markov Chain Monte Carlo (MCMC)
method is one of the most popular sampling technique [16, 21, 22]. However, MCMC
requires a large number of samples for satisfactory approximation (often in the range
103 −106 ), rendering Bayesian framework computational prohibitive and the de-
velopment of an eﬃcient solution generation is essential. To this end, Polynomial
Chaos (PC) based spectral projection method has been investigated extensively. PC
methods, particularly the generalized polynomial chaos (gPC), have become one of
standard approaches for solving stochastic problems to propagate and quantify un-
certainties in various disciplines including both physical [23, 24, 25] and chemical
systems [26, 27, 28, 29]. These methods approximate the model variables and pa-
rameters in terms of spectral expansion in an orthogonal polynomial basis according
to the their probabilistic distributions. The resulting surrogate models then can be
used to eﬃciently produce the solutions and the statistical properties of quantities of
interests (QOIs). The current popular trend is the to incorporate Bayesian inference,
gPC, Markov chain Monte Carlo (MCMC) and ﬁeld measurement in data assimilation

18
process which continuously updates the state variables, parameters. Although earlier
attempts at using PC for turbulent ﬂuid ﬂow modeling were not successful [30, 31],
it was found satisfactory to obtain eﬃcient surrogate model for stochastic ﬁnite ele-
ment and stochastic ﬂuid ﬂow problems [32, 33]. In recent development, Xiu and his
coworkers [34, 35, 36] have developed a generalized version of polynomial chaos called
generalized polynomial chaos (gPC). Since then gPC has been applied for uncertainty
propagation through computational simulators in many ﬁeld of engineering.
1.2
Bayesian viewpoint on parameter estimation
problems
The traditional approaches in parameter estimation are concerned with minimizing
cost function, which measured the distance between the model solution and the mea-
surements in addition to the deviation between the estimated prior and its prior, with
respect to the parameters [66]. Alternatively, parameter estimation problems can be
viewed as an attempt to formulate the joint distribution between the model state
and the parameters, given a set measurement and a dynamical model with known
uncertainties.
1.2.1
The dynamic models and measurements
Consider the following equations deﬁne the model associates with initial and boundary
conditions on the spatial domain D, boundary ∂D and a set of measurements,
∂ψ(x, t)
∂t
= G(ψ(x, t), α(x)) + q(x, t),
(1.2)

19
ψ(x 0, t) = Ψ0(x) + a(x),
(1.3)
ψ(x, t)|∂D = Ψb(ξ, t) + a(ξ, t),
(1.4)
α(x) = α0(x) + α′(x),
(1.5)
M [ψ, α] = d + ϵ
(1.6)
Here ψ(x, t) ∈ℜnψ is the model state vector consists of spatially-time varying
variables (i.g. water elevation computed in ADCIRC model). The dynamic parts of
the system is ﬁrst deﬁned by the nonlinear operator G(ψ(x, t) ∈ℜnψ. The model
state is initialized and evolve from the initial condition Ψ0(x) ∈ℜnψ deﬁne in (1.3).
The boundary condition is deﬁned in (1.4) where ξ is the coordinate running over
the domain’s boundary. In addition, the poorly known model parameters is deﬁned
in (1.5). This parameter can either be a vector of spatial ﬁelds or a vector of scalar
with is a stationary process i.e. these parameters do not change in time. (1.5) specify
the measurements as a function of the model state and the parameters, this can be a
direct point measurements or a more complex form of function related to the model
state. Finally, the system is closed by the additional terms at the end of each and
every equations (1.2 - 1.6). Without these terms, the system over-determined with
no solution. However, simply adding these errors term will not solve the system.
The statistical assumptions about these errors must be incorporated in order for the
system to be solved, i.g. in many applications these errors is assumed to be Gaussian
which means equal to zero and subjected to speciﬁc error covariances.

20
1.2.2
Bayesian formulation
Following the problem formulation from equations (1.2 - 1.6), the model variables,
the indisposed parameters, the initial boundary and initial conditions and the mea-
surements are now treated as random variables. The solution of the system, which
is subjected to uncertainties, cannot be described merely by point estimations but
instead can be represented by pdfs.
Suppose the joint pdf of the model state f(ψ, α) and the likelihood function com-
prise of the measurements f(d|ψ, α) are known, Bayes’ theorem for the parameter
estimation dictates
f(ψ, α|d) ∝f(ψ, α)f(d|ψ, α)
(1.7)
In general, the normalized function is used as a denominator on the right-hand-side
of (1.7) to equalized this expression.
We have previously deﬁned the boundary condition ,initial condition and the
parameter prior as random variables f(ψ0), f(ψb) and f(α). The likelihood Bayes’
theorem is now expressed as
f(ψ, α, ψ0, ψb)
=
f(ψ, α|ψ0, ψb)f(ψ0)f(ψb)
(1.8)
=
f(ψ|α, ψ0, ψb)f(ψ0)f(ψb)f(α)
(1.9)
(1.7) is then written as
f(ψ, α, ψ0, ψb|d) ∝f(ψ|α, ψ0, ψb)f(ψ0)f(ψb)f(α)f(d|ψ, α)
(1.10)

21
Here f(ψ|α, ψ0, ψb) is the prior density of the model solution given the parameter,
initial and boundary conditions.
1.2.3
Recursive formulation of Bayes’ rule
In order to see how the sequential data assimilation is derived from Bayes’ rule, it
is convenient to assume the model as the discretization in time. The model state is
represented at the ﬁxed time interval ψi(x) = ψ(x, ti), i = 0, 1, ..., k.
Assuming the model is a ﬁrst order Markov process, the pdf for the model inte-
gration from time ti−1 to ti is deﬁned as f(ψi|(ψi−1, α, ψb(ti)). The joint pdf of the
model state and the parameters can now be written as
f(ψ1, ...ψk, α, ψ0, ψb) ∝f(ψ0)f(ψb)f(α)
k
Y
i=1
f(ψi|(ψi−1, α, ψb)
(1.11)
Now we can assume that the measurements are divided into subsets of measure-
ment vector dj ∈ℜmj, acquired at time ti(j), with j = 1, ..., J and 0 < i(1) < i(2) <
... < i(J). Together with the uncorrelated measurement errors assumption in time,
the likelihood function is rewritten as
f(d|ψ, α) =
J
Y
j=1
f(d j|ψi(j), α)
(1.12)
Combining the results from (1.11) and (1.12), Bayes’ theorem can now be written
as
f(ψ1, ...ψk, α, ψ0, ψb|d) ∝f(ψ0)f(ψb)f(α)
k
Y
i=1
f(ψi|(ψi−1, α)
J
Y
j=1
f(d j|ψi(j), α) (1.13)

22
Or the more general form where the model is not assumed to be the ﬁrst order
Markov process,
f(ψ1, ...ψk, α, ψ0, ψb|d) ∝f(ψ0)f(ψb)f(α)
k
Y
i=1
f(ψi|(ψl̸=i, α)
J
Y
j=1
f(d j|ψi(j), α) (1.14)
With the assumption of correlated model errors, equation (1.14) establishes the
most general formulation of the state and parameter estimation problem.
In the application of ocean and atmospheric modeling, it is not over-simplifying
to assume the dynamical process as a ﬁrst order Markov process [67].
A general
smoother and ﬁlter could be derived from the Bayesian formulation given in (1.13)
as follows:
f(ψ1, ...ψk, α, ψ0, ψb|d) ∝f(ψ0)f(ψb)f(α)
i(1)
Y
i=1
f(ψi|(ψi−1, α)f(d 1|ψi(1), α)
...
(1.15)
i(J)
Y
i=i(J−1)+1
f(ψi|(ψi−1, α)f(d J|ψi(J), α)
k
Y
i=i(J)+1
f(ψi|(ψi−1, α)
It is simple to break apart the this expression as the sequential evaluation in time
as follows:

23
f(ψ1, ...ψi(1), α, ψ0, ψb|d1) ∝
f(ψ0)f(ψb)f(α)
i(1)
Y
i=1
f(ψi|(ψi−1, α)f(d 1|ψi(1), α),
(1.16)
f(ψ1, ...ψi(2), α, ψ0, ψb|d1, d2) ∝
f(ψ1, ...ψi(1), α, ψ0, ψb|d1)
i(2)
Y
i=i(1)+1
f(ψi|(ψi−1, α)f(d 2|ψi(2), α),
(1.17)
...
f(ψ1, ...ψi(J), α, ψ0, ψb|d1, . . . , dJ) ∝
f(ψ1, ...ψi(J−1), α, ψ0, ψb|d1, . . . , dJ−1)
i(J)
Y
i=i(J−1)+1
f(ψi|(ψi−1, α)f(d J|ψi(J), α),
(1.18)
f(ψ1, ...ψk, α, ψ0, ψb|d1, . . . , dJ) ∝
f(ψ1, ...ψi(J), α, ψ0, ψb|d1, . . . , dJ)
k
Y
i=i(J)+1
f(ψi|(ψi−1, α).
(1.19)
The expressions (1.16-1.19) demonstrate the implementation of the propagation

24
rule in discrete form on Bayes’ theorem, on the condition that the dynamical model
in ﬁrst order Markov process with independent measurement errors in time. In this
case the measurements can be assimilated sequentially at any data-available time.
Overall, these expressions represent ﬁltering approach in data assimilation problem.
(1.16) start oﬀby computing the joint conditional pdf from the product of the
priors f(α), f(ψ0) and f(ψb) with the likelihood function containing measurement
d1. In Kalman ﬁlter scheme, this is equivalent to evaluating both forecasting and
analysis steps between [t1, ti−1] interval. The sequence is then proceeded in (1.16)
with the introduction of the new observation d2, but the priors is replaced by the joint
conditional pdf from the previous step and so on. These process is then continue until
the last assimilation cycle where the measurements are available. Then the model
forecasting continue toward the ﬁnishing time of the model run from (1.18).
It is worth emphasize that although we have arrived at (1.16-1.19) where the full
inversion scheme is formulated sequentially. The sequential-in-time algorithm, while
intuitive, is not the fundamental the the update. It is convenient in the case where
the model is assume to be the ﬁrst order Markov process where the posterior pdf of
the present step can be generated if the model state vector form the previous time
step is known so the sequential scheme is well-suited to apply to the online model
forecasting where the data is made available from sensor networks in real-time.
In general the calculation of the posterior distribution can be done by processing
all the measurements simultaneously as is normally done in variational formulation.
In the next section, the approach to sampling the joint conditional pdf from full
inverse formulation: MCMC, will be introduced. The posterior distribution of the
estimated parameters from MCMC is used to compare the pdf from SEIK approach.
The detail derivations of the Ensemble Kalman Smoother (EnKS) and the En-
semble Kalman Filter (EnKF) from Bayes’ theorem can be found in [66] for further
reading.

25
1.3
Related studies
Uncertainties in spatially variable parameter can be represented as a particular re-
alization of a random ﬁeld [37, 38]. We aim to estimate low-dimensional represen-
tations of the Manning’s n ﬁeld. Since only small number of realizations are needed
to estimate second-order statistics, this representation is thus suitable for low-rank
non-intrusive data assimilation methodologies such as the singular evolutive interpo-
lated Kalman (SEIK) ﬁlter [39, 40, 41]. Furthermore, since modeling the uncertainty
propagation of the uncertain the Manning’s n coeﬃcient through the model by SEIK
requires a large number of samplings which in turn aﬀects the time of the simula-
tions, Polynimial chaos projection is implemented to contruct surrogate versions of
the highly complicated original model. The PCs implementation greatly reduces the
time of simulations and at the same time neglect the Gaussion assumption enforced
by Kalman ﬁlter yeilding the full distribution of state vectors at forcasting step in
statistical data assimilation scheme.
Among the recent work in the ﬁeld, the work of Mayo et al. [4, 2] and Alexanderian
et al. [42] are closely related to this work and need special mention here. Mayo et al.
reformulated statistical data assimilation to estimate the bottom stress terms in a
2-D coastal ocean model. A square root Kalman ﬁlter was implemented to minimize
the amount of noise due to the data assimilation. Speciﬁcally, the authors inverted
synthetic water elevation data by implementing the singular interpolated evolutive
Kalman (SEIK) ﬁlter to the Advanced Circulation (ADCIRC) coastal ocean model. In
all cases they studied, true ﬁeld of Manning’s n coeﬃcients were accurately recovered.
With the methodology, they improved the accuracy of forecasted water elevations in
all experiments. When estimating the values of the Mannings n coeﬃcients directly,
they found smaller values could be recovered from nearly any initial guesses.
In
estimating larger values, however, either a relatively accurate initial guess or many
data assimilation cycles (updates using data) were required for the method to converge

26
to the true parameter value.
Alexanderian and his co-workers [42] used the polynomial chaos (PC) expansion
to propagate parametric uncertainties in ocean global circulation model (OGCM),
focusing on short-time, high resolution simulations of the Gulf of Mexico (GOM),
using the hybrid coordinate ocean model, with wind stresses corresponding to hur-
ricane Ivan. A sparse spectral projection approach was implemented to propagate
and quantify parametric uncertainty in an OGCM. A non-intrusive spectral projec-
tion scheme, based on a Smolyak sparse quadrature grid, was used to derive the PC
representation of the stochastic response of selected QoIs. The quality of the PC rep-
resentation was examined, reﬁned and utilized to compute distributions of quantities
of interest (QoIs) and to analyze the local and global sensitivity of these QoIs to the
uncertain parameters. Their work provides an essential tool (gPC) and illustrates
the advantage gPC to create a surrogate model used to generate the response in very
a eﬃcient way, facilitating the calculation of various statistics. In this thesis similar
method the surrogate model for Markov chain Monte Carlo (MCMC) is derived to
obtain probability distribution function (pdf) of the responses. The development gPC
in this thesis is described in Chapter 4.
1.4
Thesis objectives and outline
In this work, we exploit a speciﬁc coastal ocean model to solve the SWEs and imple-
ment the SEIK ﬁlter to estimate the Manning’s n coeﬃcient. By conducting obser-
vation system simulation experiments on coastal ocean model, we attempt to recover
the true Manning’s n coeﬃcient from sets of initial guesses and available data. The
OSSEs is divided into two parts. We ﬁrst conduct the OSSES using SEIK ﬁlter,
which well-suited to the parameter estimation problem with large number of uncer-
tain parameters and for real-time online applications, however, has a limitation on

27
the correctness of the posterior distribution of the parameter estimated due to its
Gaussianity. The solution to avoid the Gaussian restriction of Kalman based meth-
ods is to use MCMC sampling based method, which produces full distribution of the
posterior. As the implementation of MCMC becomes too costly for highly sophis-
ticate model, PC is used to reduce the size of the model in order to apply MCMC
eﬃciently. Our ﬁnal objective is to compare the posterior distributions produced by
OSSEs from both Kalman based method and PC-MCMC based.
In the remainder of this thesis, we will formally describe all ingredients used
in this research. In Chapter 2 provides the description of shallow water equations
(SWEs) as implemented in advanced circulation model (ADCIRC) and used in this
work. Chapter 3 focuses on the description of Manning’s n coeﬃcients and popular
methods the estimate this important parameters. Since some part of the thesis is to
follow up the work of Mayo [4, 2], it is appropriate to the discuss on the principle
of data assimilation, Kalman ﬁlters and its variation, particularly singular evolutive
Kalman ﬁlter (SEIK). Similar layout is used for Chapter 4 but their main focuses
are on the development of surrogate model using generalized polynomial chaos (gPC)
and the uncertainty characterization using Markov chain Monte Carlo (MCMC) re-
spectively. The experimental setups and the results for each topic are embedded in
the corresponding Chapters as described. Finally, Chapter 5 is designed to wrap up
the ﬁndings, discussions and the concluding remarks.

28
Chapter 2
ADCIRC model
The sophisticate coastal ocean model namely ADvanced CIRCulation (ADCIRC)
[43] was selected for this study. The model has been used in many coastal, estuaries
water elevation and currents analysis in many studies [4, 2, 44]. ADCIRC solves the
shallow−water equations on an unstructured, triangular elements discretized in the
physical domain. Instead of solving directly SWEs, the continuity equation is replaced
by the second−order, hyperbolic generalized wave continuity equation (GWCE). This
prevents spurious oscillations that often arise from the numerical solution of the
original form [45]. The coupling between the reformulation of continuity equation
and the momentum equation represents the governing equations of ADCIRC which
solves for the quantities of interest (i.e. water elevation and velocity). This system of
equations are discretized spatially by a ﬁrst−order continuous Galerkin ﬁnite element
scheme. The time derivatives are approximated using centered ﬁnite diﬀerences in
GWCE and forward diﬀerences in the momentum equations.
Variety of physical domain scales and complex bathymetry structures can be in-
corporated by ADCIRC, including the scales range from the deep ocean through
basins and continental shelves to coastal in land [13]. The minimum requirements for
ADCIRC are the description of the ﬁnite element mesh and tidal forcing parameter
[46]. ADCIRC has been implemented and validated intensively in many studies us-
ing hindcast studies. The hindcast studies have been conducted on several storms,

29
including Hurricanes Betsy (1965), Ivan (2004), Dennis (2004), Katrina (2005), Rita
(2005) [47, 48, 49], Gustav (2008) [3] and Ike (2008) [5]. The accuracy of the hindcasts
depends signiﬁcantly upon the the accuracy of model inputs and data. In this study
we focus on the characterization of the bottom friction and we use ADCIRC input
ﬁles for uncertainty propagation of the Manning’s n coeﬃcient.
2.1
The Shallow Water Equations
The shallow water model is derived from the Navier-Stokes equations assuming the
incompressibility and hydrostatic pressure approximation. The SWEs is well-suited
to model the ﬂow with large horizontal scales relative to the vertical scales. ADCIRC
in particular implements the depth−integration where the water elevation and depth-
averaged velocities are solved for each node. The SWEs in ADCIRC framework is
given by
∂H
∂t + ∂
∂x(Qx) + ∂
∂y(Qy) = 0
(2.1)
∂Qx
∂t + ∂UQx
∂x
+ ∂V Qx
∂y
−fQy = −gH ∂[ζ + Ps/gρ0 −αη]
∂x
+ τsx
ρ0
−τbx
ρ0
+ Mx −Dx −Bx
∂Qy
∂t + ∂UQy
∂x
+ ∂V Qy
∂y
−fQx = −gH ∂[ζ + Ps/gρ0 −αη]
∂y
+ τsy
ρ0
−τby
ρ0
+ My −Dy −By.
(2.2)
Here, ζ is free-surface elevation relative to geoid, h is the bathymetry depth rel-
ative to geoid, H = ζ + h is the water depth, Uxi are the depth-avaraged horizontal
velocity components, Qxi = UxiH is the ﬂux per unit width in the xi direction, f

30
is the Coriolis parameter, Ps is the atmospheric pressure at the free surface, ρ0 is
the reference density of water, α is the Earth elasticity factor, η in the Newtonian
equailibrium tide potential, τsxi are the applied free surface stresses, τbxi are the bot-
tom friction components, Mxi is the vertically-integrated lateral stress gradient, Dxi
is the momentum dispersion, and Bxi is the vertically-integrated boroclinic pressure
gradient.
To replace the continuity equation with GWCE, a multiple, τ0 ≥0, of the con-
tinuity equation is added to the time derivative of the continuity equation. Then
by assumming the constant bathymetric depth, ∂H
∂t = ∂ζ
∂t . Finally, subtituting the
momentum equations into this equation completes the derivation:
∂2ζ
∂t2 + τ0
∂ζ
∂t
+ ∂
∂x(−∂UQx
∂x
−∂V Qx
∂y
+ fQy −gH ∂[ζ + Ps/gρ0 −αη]
∂x
+ τsx
ρ0
−τbx
ρ0
+ Mx −Dx −Bx + τ0Qx)
+ ∂
∂y(−∂UQy
∂x
−∂V Qy
∂y
+ fQx −gH ∂[ζ + Ps/gρ0 −αη]
∂y
+ τsy
ρ0
−τby
ρ0
+ My −Dy −By + τ0Qy)
−UH ∂τ0
∂x −V H ∂τ0
∂y = 0.
(2.3)
The bottom stress components in the momentum equation are deﬁned through
the coeﬃcient Kslip = cf|u| as stated in a quadratic drag law. Then cf is determined
using Manning’s n formulation,
cf = gn2
H1/3
(2.4)
where n is the Manning’s n coeﬃcient of roughness, which vary spatially depending
on the surface characteristics of the sea ﬂoor. The Manning’s n coeﬃcient values

31
are obtained from tables of well-deﬁned empirical estimates for land classiﬁcations
since there is no method to directly measure it. the Mannning’s n coeﬃcient can be
roughly deﬁned at the nodes of discretized physical domain (e.g. at the seabed) which
in turn construct the piecewise linear representation of bottom friction. Since these
values are often determined from the data sources that are incomplete or with several
missing time periods, the outputs from coastal ocean model is always subjected to
large amounts of uncertainty due to the uncertainty in the Manning’s n coeﬃcient
(Table 2.1).
Open water
0.020
Mixed forest
0.170
Ice/snow
0.022
Shrub land
0.070
Pasture
0.033
Grassland
0.035
Commercial
0.050
Low residential
0.120
Bare rock/sand
0.040
High residential
0.121
Gravel pit water
0.060
Row crops
0.040
Fallow
0.032
Small grains
0.035
Transitional
0.100
Recreational grass
0.030
Deciduous forest
0.160
Woody wetland
0.140
Evergreen forest
0.180
Herbaceous wetland
0.035
Table 2.1: Values of the Manning’s n coeﬃcient for various surfaces. the left columns
in the tables describe the land characteristics and the right columns are the associated
empirically deﬁned Manning’s n coeﬃcients.
Multiple formulations of the bottom stress are accommodated by ADCIRC model.
A linear, quadratic or the hybrid law (i.e. a constant friction coeﬃcient in deep water
and a quadratic friction law elsewhere) can be implemented. A Chezy or Manning’s
n formulation of the bottom stress in supported. ADCIRC allow for the point-wise
parameters speciﬁcation on each discretized vortex. This can be assigned via the
input ﬁle described in the next section. In this work, we adopt the quadratic ﬁction
coeﬃcient law using the Manning’s n formulation.
The SEIK ﬁlter is implemented to the ADCIRC in matlab in order to run the
model and to update the Manning’s n coeﬃcients at each node at every assimilation
step. The ensemble is initialized by sampling on the random distribution around the

32
expected value. Then the ensembles are used to create the multiple instance of the
input ﬁles. These ﬁles then run simultaneously by ADCIRC. When the model run
reach the iteration where the data are available, the matlab script is used to read in
the model state variables. The discrepancy between the model state and the synthetic
data, which considering the truth is then employed to update the parameters expected
value with SEIK ﬁlter. New ensembles is then created from this update, and the of
model run/ﬁltering cycle is repeated until the end of the parameter estimation.
2.2
ADCIRC Features and Capabilities
The depth-integration GWCE mode in ADCIRC is designed to solve for water el-
evation and velocity. The model represents the domain by using ﬁnite elements to
generate unstructures triangular ﬁnite-element mesh. This is a standard and eﬃcient
approach for resolving complex bathymetry, coastline and island boundaries. The
size of unstructured elements can vary as desired.
2.2.1
Model Inputs
The ADCIRC code is written in Frotran. The minimum requirement to run the model
are two input ﬁles. The ﬁrst is fort.14: this ﬁle describes the structure of the can be
obtained from several geophysical database. Then formating and reﬁning are required
to generate the desired bathymetry mesh ﬁle for ADCIRC. After we acquired fort.14,
the ﬁle remains the same from the beginning through the subsequence simulation
until the end. The second mandatory input ﬁle is fort.15: this ﬁle contains the wide
range of adjustable parameters such as the mode of the run (2D or 3D), the type of
coordinate used, model timestep and the period of model running etc.
Supplementary input ﬁles can be incorparted depending on the problems the user
has to solve. The follwing bullets summarize the main forcing used in ADCIRC:

33
 Tidal potential due to the gravity pull of both the Earth and the moon. The
phase of the tidal constituent being forced can be deﬁned in fort.15
 Meteorological conditions, mostly used for strom surge prediction. Meteorolog-
ical forcings are represnted through fort.22 ﬁle.
 Fleshwater inﬂows, contains in fort.20 ﬁle.
Of particular importance for our experimental setup is fort.13 ﬁle, which contains
nodal attribute on each of the element mesh. The Manning’s n coeﬃcient of the
bottom surface can be customized nodally in this ﬁle. Nodal Manning’s n coeﬃcient
in fort.13 will be constantly changed during the simulation when data assimilation
for parameter estimation is applied.
2.2.2
Model Outputs
The type of output data is speciﬁed in fort.15. There exists many options for output
format. For instance, users can customize the model outputs in fort.61 and fort.62
to obtain the selected points water elevations and velocity respectively. On the other
hand, the water elevations and velocities at all points are provided by fort.63 and
fort.64, respectively. This thesis focus solely on the surface water elevations output.
2.2.3
Parallel implementation
Serial and parallel versions of the ADCIRC are available in researchers and developer
communities. The parallelized version of ADCIRC can run on interconnected pro-
cessors. This speciﬁc feature gives the advantage of decreasing the run times. It is
worth emphasizing that parallelrized ADCIRC mode is the most appropriate to the
problem encountered in our research. The data assimilations scheme we adopt in this
research requires a large amount of parameter sample and therefore model runs. the
parallel code may signiﬁcantly reduces the amount of running time for each sample.

34
2.3
Experimental setups
In this chapter, we implement the SEIK to estimate the Manning’s n coeﬃcients
deﬁned in the bottom stress terms within the shallow water equations of the ADCIRC
model. We conduct observation simulation system experiments (OSSEs), where the
synthetic water elevation data generated by ADCIRC in the moderate conditions are
assimilated into a perturbed model, in order to recover the true parameters deﬁning
various values of Manning’s n coeﬃcient.
In this thesis, we adopt the same experiment setup as in [4], i.e. with the similar
domains and forcing. we estimate both constant ﬁelds and parametrically deﬁned
2-D ﬁeld of Manning’s n coeﬃcients. We are interested in estimating the parameters
in two diﬀerent domain conﬁgurations, the ﬁrst domain is the idealized inlet with an
ebb shoal, and the more realistic domain representation of the Galveston Bay as the
second domain. Here only the parameters are estimated with the SEIK, while the
state is assumed known.
2.3.1
Observation Simulation System Experiments
Observation simulation system experiments (OSSEs) is conducted in this study. The
synthetic data obtained from running ADCIRC model with speciﬁc initial condition
are considered as the true observations. The Manning’s n coeﬃcients, which generate
these data are considered the truth and we attempt to recover it based on the data and
ADCIRC. SEIK uses the synthetic data to update the parameters at each assimilation
cycle. We initiate the model simulation with an incorrect estimated ﬁeld of Manning’s
n coeﬃcients, then apply the data assimilation scheme for the parameters to converge
to the truths in later iterations. Performing the OSSEs enable the eﬀect of the data
assimilation to be quantiﬁed.

35
2.3.2
Computational Domains
Idealized Inlet with Ebb Shoal
The ﬁrst computational domain in our OSSEs is the idealized inlet with ebb shoal.
The structure of the domain includes a bay that is connected to the open ocean on
the west side through an inlet with twin jetties. An ebb shoal is located right to the
west of the inlet. This domain structure is the simpliﬁed version of the real ebb shoal,
which is a common natural occurrence at coastal inlets. An ebb shoal is formed by
the deceleration of the water while exiting the inlet, which in turn withdraw the large
amount of sediment from the bay [50].
This computational domain contains 1,518 grid nodes and 2,828 elements, covers
the area of 4500 m wide and 3000 m long (Figure 3.1). The bathymetry of the domain
is measured downward from the geoid toward the ocean ﬂoor. The depth of the ocean
ﬂoor is increase linearly from 3.8 m at the left-most boundary to 1 m at the mouth
of the inlet on the west side of the domain. The landlocked area of the domain has
a constant bathymetry of 1 m. The diameter of the ebb shoal is 750 m and the
maximum height at the center of the ebb shoal is 4 m (Figure 2.1).
Figure 2.1: idealized inlet with ebb shoal domain

36
Galveston Bay
A more realistic domain is the coarse representation of Galveston Bay, located on
the upper Texas coast in the Gulf of Mexico. Galveston Bay is economically active
area, with Port of Houston, one of the busiest port in the world. The location of
the Bay make it vulnerable to the eﬀect of hurricane storm surge, which cause a lot
of damages to the U.S. economy and the security of its habitats. There is a record
of the third costliest hurricane in U.S. history, Hurricane Ike, which destroyed many
facilities and households in Galveston Bay area in 2008 [51].
The computational domain representing Galveston Bay contains 2,113 nodes and
3,397 elements. The open ocean boundary located on the southeast side of the domain
and the landlocked area on the remaining sides. There are also island boundaries
surrounding 17 small islands inside the bay area. The bathymetry of the domain
ranges from 0.345 inside the bay to 17.244 m in the Gulf of Mexico (Figure 2.2).
Figure 2.2: Galveston Bay domain

37
2.3.3
Parameterizing a ﬁeld of Manning’s n Coeﬃcient
Instead of estimating Manning’s n coeﬃcient on each and every node on the domains,
we ﬁrst model the ﬁeld with low-dimensional parameterizations. Then the parameter
estimation problem reduces to the estimation of small number of parameters.
In
this thesis, we primarily focus on the parameter estimation on a ﬁeld of piecewise
constant Manning’s n Coeﬃcients. In the ﬁrst case, we assign the same constant
value of Manning’s n coeﬃcient at every node of the domain. This ﬁeld represents
an invariant ﬁeld in space, which is often implemented in most of the coastal ocean
models..
The second aim is an attempt to estimate two model parameters, α and β, which
parametrically deﬁne 2-D ﬁeld of Manning’s n coeﬃcients. This is simply the param-
eterization of the ﬁeld with two piecewise constants. We let α be the Manning’s n
coeﬃcient in the open ocean, and β be the Manning’s n coeﬃcient within the inlet
and the bay. This ﬁeld is denoted by nα,β. This conﬁguration is enforced to both
computational domain mentioned before.
2.3.4
Parameter estimation methodology
In general, the parameter estimation problem is about solving for the parameters
that produce the model output that best match the observations.
However, this
problem can often be ill-posed due to the it’s complexity, since the diﬀerent sets of
parameters may produce very similar model outputs. The study in [4] shows that a
small perturbation of Manning’s n coeﬃcient only induce small changes in the model
water elevation. So it is suﬃcient in our OSSE to attempt to recover a value that
approximately produces close enough water elevation to the observations.
In order to evaluate the performance in estimating the Manning’s n coeﬃcient,
we divide the range of Manning’s n coeﬃcients into classes based on the water ele-
vation data they produce. Then we generate the synthetic water elevation data from

38
the middle of each class, and ﬁnally try to recover these values from initial guesses
initiated at the middle of the other classes.
Classifying Manning’s n coeﬃcients
We divide the Manning’s n coeﬃcients ranging from 0.005 to 0.2 (deﬁned in Table
1.2), incremented value of 0.005, into ﬁve classes. These classes are deﬁned by the
level of the water elevation data produced by ADCIRC model. It is worth mentioning
that the smaller Manning’s n coeﬃcients produce the larger water elevations. AD-
CIRC is forced using the principal lunar semi-diurnal (M2) tidal constituent, with the
amplitude of 0.25 m for the idealized inlet case and 0.1 m for Galveston Bay relative
to the geoid. The simulation is run for ﬁve 5 days including 12 hours ramp up period,
with a 2 s time step. The largest mean amplitude of the tides at several locations
throughout the whole domain is computed, and the Manning’s n coeﬃcients that
generate tides with mean amplitudes less than 20%, 40%, 60%, 80%, and 100% of
this value are divided in ﬁve classes. The more details of this classiﬁcation framework
can be found in [4]
It is worth emphasizing that for both domains, the tides are more sensitive to the
variation in smaller Manning’s n coeﬃcients than that of the larger values, as the
classes become larger. Thus, the larger classes contain more Mannin’s n coeﬃcients
in comparison to the smaller classes. This will aﬀect the recovering of the parameters
using SEIK in the larger classes from the smaller classes.
Simulating synthetic water elevation data
The result from the previous section is the classiﬁcation of Manning’s n coeﬃcients
into 5 classes for both idealized inlet and Galveston bay domains. We simulate tides
using the same forcing and setups as prescribed in the previous sections, and set
the constant Manning’s n coeﬃcient to a value from the middle of each prescribed

39
classes. For the idealized inlet, the values are 0.015, 0.035, 0.06, 0.105 and 0.17. For
Galveston Bay, the constant values we attempt to estimate are 0.01, 0.02, 0.03, 0.06
and 0.14. We generate the data considering as ”truth” from these values and trying
to recover them from several initial guesses.
Recovering the true class of Manning’s n coeﬃcients
For each constant Manning’s n coeﬃcients, we ﬁrst generate the synthetic water
elevation data at the predeﬁned location representing the observation stations. There
are 15 stations for the inlet case (represented by red circles in Figure 2.1). We run our
simulation using the values from four remaining classes as the initial guesses. After
the 12 hour ramp up period, the assimilation cycle begins. We assimilate the data
every 5 hour over 5 day. We vary the ensemble size for both domain with 10, 20
and 100 ensembles, with σ = 0.01, where σ2 is the standard deviation in the initial
estimate of the parameter. For the case of Galveston Bay, we use 21 observation
stations (Figure 2.2) with the same ensemble sizes and again we let σ = 0.01.
For the two parameter case, nα,β, we perform OSSEs in the same manner as
described in 1D constant value case.
We generate synthetic water elevation data
from prescribed setting of Manning’s n coeﬃcients and consider these data the truth.
Then we try to recover these values from several initial guesses. However in this
case, we cannot divided the Manning’s n coeﬃcients by class as was done in the 1D
case without substantial amount of computation. Thus, we instead deﬁne a single
true ﬁeld n0.005,0.1, where the coeﬃcient is set to 0.005 in the deep water of the open
ocean (highlighted in green in Figure 2.1 and 2.2), and let 0.1 in the shallow bay area
(highlighted in blue). The value of the coeﬃcient increases linearly within the inlet
for the idealized inlet case (highlighted in purple) and the initial guesses selected are
n0.005,0.005,n0.1,0.1,n0.06,0.06 and n0.1,0.1005. Thus we evaluate the results from incorrect
initial guesses of either α, β or α and β. The forcing used in 2D case is similar to

40
that in the 1D case. We however use a total simulation time of 30 days for Galveston
Bay.

41
Chapter 3
Manning’s coeﬃcient estimation
with SEIK
In general, there are two directions to reduce the model uncertainties due to uncertain-
ties in the parameters used in the model simulation. The ﬁrst approach is parameter
estimation attempts to reduce the uncertainty of the parameters themselves. The
second approach called, state estimation, attempts to compensate for errors in the
parameters by adjusting the model input against the observed data.
Traditionally, parameter estimation is done through numerical methods based on
optimal control theory where a cost functional penalizing model-data discrepancies
is minimized over the estimated parameters. This is called the variational approach.
Many parameter estimation methods have been used to estimate the bottom stress
parameters in coastal ocean models [52, 53, 54, 55, 56, 57, 58, 59] with varying com-
plexity and success. Most of the successful cases are limited to a few numbers of
parameters on very simple domains. More complex cases are still an active area of
research although implementing variational methods for these cases is computation-
ally quite expensive. Moreover, variational methods may suﬀer from instabilities,
non-uniqueness, failing to converge to the optimum parameter values [4, 60].

42
3.1
Kalman ﬁltering applications in shallow water
model
In recent years state estimation, particularly statistical data estimation, has been
widely applied to reduce the uncertainties in coastal ocean models due to uncertainty
in various parameters and inputs.
Budgell [61] was the ﬁrst to use state estimation in storm surge modeling. He
applied the Kalman ﬁlter to a linearized 1-D SWEs to reduce the uncertainty in the
boundary conditions and the momentum balances. He was able to recover the true
state of systems with the accuracy of the numerical approximation of the governing
equations. In a subsequent work, Budgell used the extended Kalman ﬁlter to estimate
the true state of nonlinear SWEs.
He found that the ﬁlter performance did not
degrade even when the model and observation error were non-Gaussian. The ﬁlter
also improved the estimates of water elevations as well as velocities. Heemink and
Kloosterhuis [12, 62] applied the extended Kalman ﬁlter to a 2-D shallow water model
with a continuity equation assumed to be error free in the momentum equation to
predict tides during normal weather and during storm surge. The state estimation
problem was solved on a large and realistic domain with a reduced rank approximation
of the model error covariance in the Kalman ﬁlter.
In a more complex domain,
Sorensen and Madsen [10] estimated the state variables of a 3-D model of surface
ﬂow in the North Sea and Baltic Sea [63]. A four-week hindcast data including a
storm surge event were used to test the state estimation, concluding that the methods
were suitable for on-line applications. Later [10] assimilated tidal gauge data into a
3-D hydrodynamic model using several variations of the ensamble Kalman ﬁlters.
They found that the ﬁlters provide robust performance in the experimental range of
Gaussian noise, the rank of the model error covariance and the standard deviation of
the measurement error.

43
Other examples of successful applications of statistical data assimilation, partic-
ularly the variants of Kalman ﬁlters to hydrodynamic models, can be found in a few
other works [64, 13, 11, 65]. Thus it can be concluded that statistical data assimula-
tion is a promising approach for reducing the uncertainties in applications of shallow
water models with a reasonable computational cost. Moreover the methods also pro-
duce not only the best estimate of the modeled state, but also an estimate of the
corresponding error covariance, which could be used as a measure of uncertainty in
the ﬁlter solution.
3.2
Kalman ﬁltering and its variants
The Kalman ﬁlter was formulated in 1960 by Rudolf Kalman [66], and has been suc-
cessfully used to assimilate data for linear models. In this method, a model forecast,
generally represented as an n-dimensional state vector, xf
k at time tk, is updated by
observed data prior to and at the time, tk, of the forecast. The data at a certain time,
yo
k, form a p-dimensional vector and the model forecast is updated using a weighted
residual between xf
k and yo
k to form the analyzed state, xa
k. The weight for updating,
called Kalman gain, is chosen such that the error covariance of the analyzed state is
minimized under certain assumptions.
It is customary for all statistical data assimilation methods to begin with an initial
estimate of true model state, and a numerical forecast model, Mk, which predicts the
state at one time step ahead, tk :
xt
k = Mkxt
k−1 + ηk
The model error, ηk, is unknown but we assume that it has Gaussian pdf with zero
mean and a given error covariance, Qk.
The current model state, xt
k, can be projected into the observation space through

44
an observation operator, Hk:
yt
o = Hkxt
k + ϵk
Here yt
o is the observation of the true state, where the error in the observation oper-
ator, ϵk is assumed Gaussian with and zero-mean and a given error covariance, Rk .
Rk is often assumed diagonal matrix σ2
kI, where I is the identity matrix having di-
mension of the observation space and σ2
k denotes the error variance. These errors are
from data points which are assumed to be independent and identically distributed.
The Kalman ﬁlter applies both operators in its two main steps, the forecast step
and the analysis step. The forecast step computes the system state at one future step
ahead from the product of Mk and the current analyzed state,xa
k−1:
xf
k = Mkxa
k−1
The error covariance of the initial state, Pa
k−1 can be then directly computed as
follows:
Pf
k
=
(xt
k −xf
k)(xt
k −xf
k)T
=
M(xt
k−1 −xa
k−1)(xt
k−1 −xa
k−1)TMT + η2
k
+
2M(xt
k−1 −xa
k−1)ηk
=
MPa
k−1MT + Qk.
(3.1)
Using the assumption of independent model and observation noise, in the analysis
step, the observation is used to update the forecast model state and the associated
error covariance.
Firstly, the forecast state, xf
k, is projected into the observation
space, providing a direct comparison with the current measured data, yo
k. Then the
Kalman gain matrix Kk is used to weight the residual an updating xf
k to obtain the

45
analysis state as
xa
k = xf
k + Kk(yo
k −Hkxf
k).
(3.2)
Let Pa
k be the error covariance of xa
k which can be computed by expressing xf
k, xa
k,
and yo
k in terms of their unknown errors, as follows.
xf
k = xt
k + ϵf
k
yo
k = Hkxt
k + ϵy
k
xa
k = xt
k + ϵa
k
From these relations, we can deﬁne the error in the analyzed state, xa
k, by the
following expression:
ϵa
k = ϵf
k + Kk(ϵy
k −Hkϵf
k).
One can show that the optimal gain that minimize the mean of the error variance is
given by
Kk = Pf
kHT
k [HkPf
kHT
k Rk]−1,
the analysis error covariance is then
Pa
k = ϵa
kϵaT
k
= (I −KkHk)Pf
k
(3.3)
The matrix Kk is the weight that minimizes the error covariance, Pa
k, of xa
k and is

46
called the Kalman gain matrix.
For a linear perfect model, the equation for the
analyzed state (3.2) is equivalent to the result of minimizing the cost function in the
variational formulation of the data assimilation problem [67].
There are several assumptions used in the formulation of the Kalman ﬁlter, but
the most restrictive one is that the model is linear.
Most practical problems are
however non-linear, making the computation of the forecast error covariance not
straightforward. Several methods have been developed totackle this problem including
Extended Kalman Filtering (EKF) [68] and the ensemble Kalman ﬁlters (EnKF)
[39, 40, 41].
In practice, the extended Kalman ﬁlter requires linearization the system equation
and may be computational prohibitive when implemented with large dimentional
systems [4]. Reduced rank Kalman ﬁlters were then formulated to mitigate these
problems. With a good selection of the initial error covariance, the computational
and storage saving of a low rank approximation can be achieved while maintaining
acceptable ﬁlter performance. The SEEK is developed based on a similar approach
in the assimilation process with a modiﬁed analysis step. However, in the case of
highly non-linear models, EKF based ﬁlters have diﬃculties in accurately computing
the gradient of the model.
Evensen proposed the Ensemble Kalman Filter (EnKF) [69] as a Monte Carlo
approximation of the EKF, reducing its computational requirements and avoiding
the need for linearization. In addition the EnKF is designed to deal with nonlinear
models, allowing the forecast error covariance to be more accurately estimated than
it is in the EKF. One of the problem with EnKF is that it requires perturbing the
measurements used to create the analysis ensemble of and this may introduce noise
in the system [13]. Square root EnKFs have been then developed to avoid this noise.
Among the most popular EnKFs we cite are the ETKF, the EAKF and the SEIK. All
these ﬁlters diﬀer in the way the analysis ensemble is generated after every analysis

47
step, and are statistically equivalent, SEIK will be discussed more thoroughly in the
next section.
3.3
The SEIK ﬁlter for state estimation
The singular evolutive interpolated Kalman (SEIK) ﬁlter is a variation of EnKF [40].
It is among the class of square-root ensemble Kalman ﬁlters [70], which update the
mean of the ensemble of forecasted state, xt
k, along with a square root matrix of the
respective error covariance [71]. This update of the mean eliminates the addition of
Gaussian noise to the observations required in the EnKF. The SEIK ﬁlter is generally
implemented in three step: (1) the sampling step, (2) the forecast step, and (3) the
analysis step. The sampling step uses second-order sampling so that the sample mean
and sample covariance computed from the ensemble are exactly the analyzed state
and error covariance xa
k−1 and Pa
k−1. The forecast step uses the model to evolve the
ensemble members forward in time. The analysis step updates the forecasted mean
and covariance.
In the SEIK ﬁlter, the initial error covariance is represented using an ensemble of
states. However, SEIK has a minimal size of the ensemble because of the reduced rank
of this matrix. In this case, the ensemble containd only r + 1 members. Moreover,
an ensemble formulation is used to represent the matrix HkLk used in (??), avoiding
the linearization of Hk if it is nonlinear.
The forecast and analysis steps of the SEIK ﬁlter diﬀer from those of the SEEK
ﬁlter only slightly. Firstly, we determine an ensemble of initial state vector, xa
i,k−1,
from an initial estimate of the model state, xa
k−1 and the factored form of its corre-
sponding error covariance, Pa
k−1 = Lk−1Uk−1LT
k−1. Here Lk−1 is n × r, and Uk−1 is
and r × r positive deﬁnite matrix, where r << n is the rank of Pa
k−1. Then we com-
pute a Cholesky factor of U−1
k−1, Ck−1, is computed and multiply it by an (r + 1) × r

48
random matrix, Ωk−1 with orthonormal columns and zero column sum. Thus Pa
k−1
can be written as
Pa
k−1 = Lk−1(C−1
k−1)TΩT
k−1Ωk−1C−1
k−1LT
k−1.
The introduction of the random matrix Ωk−1 results in a stochastic sampling of the
initial state:
xa
i,k−1 = xa
k−1 +
√
r + 1Lk−1(Ωk−1C−1
k−1)T, i = 1, ..., r + 1.
Then the nonlinear model is applied to this ensemble of initial state vector, creating
an ensemble of forecasted state vectors, xf
i,k. Taking the everage of these, xf
i,k, as the
forecasted state, and the sample covariance as the forecast error covariance, which
can be written as
Pf
k = LkUk−1LT
k + Qk,
(3.4)
where
Lk
=
h
xf
1,k −xf
i,k...xf
r+1,k −xf
i,k
i
T
Lk
=
h
xf
1,k −...xf
r+1,k
i
T,
(3.5)
and
Uk−1 =

(r + 1)TTT
−1 .
Here, T is an (r+1)×r full rank matrix with zero column sums and (3.4) is the sample
error covariance of the xf
i,k. Just like the SEEK ﬁlter, Uk−1 is updated through its

49
inverse in analysis step. However, U−1
k−1 has new deﬁnition and is no longer recursive:
U−1
k
= U−1
k−1(HkLk)TR−1
k (HkLk).
Here we apply the observation operator Hk to the columns of Lk in (3.5) to compute
HkLk. Then Uk and HkLk are used to compute the Kalman gain matrix,
Kk = LkUk(HkLk)TR−1
k ,
and the current data are used to update the forecasted state:
xa
k = xf
k + Kk(yo
k −Hkxf
k).
(3.6)
Finally, the analysis error covariance can be written as
Pa
k = LkUkLT
k .
(3.7)
A few works successfully utilized the SEIK ﬁlter for state estimation in the studying
storm surge forecasting [13, 64, 4]. It was found that, in SEIK ﬁlter, an ensemble
is used to accurately capture the error statistics of the system without introducing
additional observation noise to the system, the size of the ensemble is minimized
without losing the ﬁlter’s eﬀectiveness.
3.4
The SEIK ﬁlter for parameter estimation
Anderson [71] suggested that an EnKF could be used for parameter estimation of
nonlinear models through joint estimation [72], also commonly referred to as state
augmentation. In this method model parameters are considered to be part of the
model state and are then appended to the state vector. Thus whenever the state

50
variables are forecasted and analyzed, they are also updated.
In this process, an initial guess model parameters, wa
k−1, is appended to the initial
state vector, xa
k−1, to form the joint state-parameter vector, ˜xa
k−1:
˜xa
k−1 =


xa
k−1
wa
k−1

.
In the ensemble methods, the initial ensemble of state-parameter vectors can be
created by adding the Gaussian noise to ˜xa
k−1. It is important that the chosen variance
of the Gaussian noise reﬂects the uncertainty in the model parameters. A procedure
for initializing the parameters is described in [73]
In the process of estimating the true parameter values, it is assumed that the evo-
lution of the models parameters is a stationary process, and so the (state) numerical
forecast model, Mk, can be modiﬁed so that the parameters remain constant after
the model is applied:
˜xf
k =


xf
k
wf
k

=


˜
Mkxa
k−1
wa
k−1

= ˜
Mk˜xa
k−1,
and so ˜
M := [Mk Ik]. The model parameter are not observed, so that the augmented
observation operator can be written as
˜Hk˜xf
k =


Hkxf
k
0

,
Finally, the initial error covariance matrix is formulated as a cross-covariance matrix,
˜P
a
k−1, which represents the relationship between the error in xa
k−1 and wa
k−1. After
this modiﬁcation, the forecast and analysis steps proceed as in any state estimation

51
method discussed previously, so one can estimate both model state and unknown
parameters, and the associated error statistics.
Joint estimation has a few desirable characteristics. Its implementation is straight-
forward and the computational cost is modest.
In addition, it also provides the
information about the uncertainty of parameter estimates. However, in practice we
should consider the following issues in its implementation. The most implemented one
is when the scales of state variables and parameters diﬀer vastly, the cross-covariance
matrix can be extremely ill-conditioned. There is also the issue related to the station-
ary assumption which may cause the ﬁlter to diverge in certain situations. To prevent
this problem, the common practice is to use inﬂation factor. In this approach, the
posterior standard deviation is inﬂated by some factor to maintain the variance in
the ensemble members. However, Aksoy et al. [73] found that inﬂation may not be
always eﬀective, depending on the characteristics of the parameter being estimated.
Another inherent issue in the joint estimation is that the parameters are only
obseverd through the model state. Thus, in most case the model state variables tend
to converge to the true state much more rapidly than the estimated parameters. This
means that more assimilation cycles are required to obtain satisfactory estimates of
the parameters. Furthermore, the eﬀectiveness of joint estimation depends on the size
of the ensembles and observation locations [73]. Regardless of this issues, the joint-
state estimation approach has been successfully implemented and used in a wide range
of problems [72, 74, 40, 75, 73].
3.5
Numerical results and discussion
In this section, we discuss the results of the OSSEs presented in the previous sections.
Since our experiment setup is similar to that conducted in [4], We only brieﬂy discuss
the results of the same experiment in this thesis. However, speciﬁcally to this work,

52
we are also concerned with the distribution of the parameter estimation with SEIK
ﬁlter, while the work in [4] only evaluated the point estimations of the Manning’s n
coeﬃcient. The pdf of the parameter posterior resulting from the SEIK ﬁlter shown
in this chapter will be used for the comparison of the results with those of the MCMC
method will be discussed in the later chapters.
3.5.1
Constant Manning’s n coeﬃcient
For the idealized inlet case, the OSSEs show that we are able to accurately recover
the Manning’s n coeﬃcient to the correct class in the case where the truth lie in
of three smallest classes, A, B, and C, regardless of from which classes the initial
guesses were initialized. The ﬁnal estimate lies in the same class as the truth. In
the case where we try to estimate the truth in class D (i.e.
constant ﬁeld equal
to 0.105), ﬁnal estimates belong to class D were obtained from all but the smallest
initial guess form class A. Finally, for the estimation of the truth in class E, SEIK
is able to recover this value accurately with the initial guess from one class below
(i.e. class D). The diﬃculty in recovering the large value of the ”true” Manning’s n
coeﬃcients from a small initial guess arises from the fact that the ADCIRC model is
more sensitive to small variations in the smaller coeﬃcients than that in the larger
coeﬃcients. Thus, in estimating the large coeﬃcients from small guesses, resulting
smaller model/data discrepancies, and thus smaller ﬁlter updates in each iteration.
It is then expected to experience more diﬃculty as the gap between a larger truth
and a smaller initial guess increases. The parameter estimation requires more time to
converge to the truth. Aside from the estimation of the parameters, [4] also mentions
the improvement in the water elevation prediction after the data are assimilated.
However, we will not focus on this topic since our focus remains on the study of the
pdf of the estimated parameters. The point estimations of Manning’s n coeﬃcient for
inlet case are shown in Figure 3.1.

53
In SEIK, the initial ensemble is generated by adding Gaussian noise to the initial
state vector. Then the ensemble is updated after every forecast step and analyzed
step. By construction, the ﬁlter ensemble represents, approximately and based on
Gaussian assumption, the pdf of the parameter conditional on the available observa-
tion. We can then plot the evolution of the 95% percentile of Manning’s n coeﬃcient
along with their ﬁlter estimates, take as the mean of the ensemble member (Fig-
ure 3.2). It is clear from this ﬁgure that the uncertainties in the parameters decrease
as the assimilation advance.
For Galvenson Bay, SEIK again accurately estimates almost all of the Manning’s
n coeﬃcients from any initial estimates. Similarly to the inlet case, the only exception
occurs in the estimation of the largest class, where the truth is 0.14. In this case, ﬁnal
estimates belonging to this class only obtained from all classes but the two smallest
class with the initial guesses 0.1 and 0.2. The underline cause of this phenomena could
be explained in the same manner as the inlet case (i.e. the diﬀerence in the sensitivity
of ADCIRC upon the diﬀerent in Manning’s n coeﬃcient). The point estimations of
Manning’s n coeﬃcient for inlet case are shown in Figure 3.3.
For Galveston Bay, we again plot the point estimations with their 95% percentile
around the estimated parameters (Figure 3.4). The pdf produced by the SEIK ﬁlter
will be compared with the posterior pdf computed by the MCMC in chapter 4.
3.5.2
A ﬁeld of piecewise constant Manning’s n coeﬃcients
In the second set of OSSES we estimate a 2-D parameterized ﬁeld of Manning’s n
coeﬃcients.
For the idealized inlet case, we obtain the accurate estimates of the
parameter for all initial guesses.
For each initial estimate, the initial errors with
respect to the truth are reduced by at least 80%. We have found that the estimation
of α = 0.005 is slightly overestimated and β = 0.1 is slightly under estimated. The
inaccuracy of estimating β is greater than α by nearly 33%. However, in the 2-D

54
parameterized case, the choice of the initial guess hardly aﬀect the ﬁnal estimate.
We ﬁnd no speciﬁc correlation between errors in initial guess and errors in the ﬁnal
estimate. The point estimation of the 2-D parameterized Manning’s n coeﬃcients
plots can be seen in Figure 3.5 and their extended version including uncertainties is
shown in Figure 3.6.
In estimating the 2-D parameterized Manning’s n coeﬃcients ﬁeld for Galveston
Bay, we observe that the variations of β signiﬁcantly aﬀect the water elevations com-
puted by ADCIRC, while varying the value of α barely cause any noticeable variation
in the water elevations, meaning that ADCIRC is not sensitive to variations in the
valuse of Manning’s n coeﬃcient in the deep water for this computational domain.
Thus, the experiment is designed in such a way that α is ﬁxed to 0.005 we only
estimate β. This is suﬃcient for our purpose of our study.
We begin with the initial guesses n0.005,0.01, n0.005,0.05, n0.005,0.15 and n0.005,0.2. We
assimilate data from 20 stations located in Galveston Bay. We run the model for 30
days including a 12 hours ramp up period. The simulation time for Galveston Bay
has to be longer in comparison to the case of Inlet (only 5 days) since it takes longer
for the sequence to converge to the true value.
As ﬁnal result, the ﬁnal estimates from all initial guesses converge to 0.1. All
initial estimates accurately recover the true β except that from the smallest initial
guess 0.01. This is to be expected with the same explanation regarding the sensitivity
of the ADCIRC model toward the variations in small Manning’s n coeﬃcients. The
plots of the point parameters estimation for the Galveston Bay is shown in Figure 3.7
and its extended version including uncertainties is presented in Figure 3.8.

55
3.6
The eﬀect of increasing ensembles size
In general on EnKF, as the SEIK, beneﬁt from increasing the ensemble size. However,
increasing the number of ensemble members means increased computational cost,
doubling ensemble would double the model runs, which in the case of ADCIRC may
signiﬁcantly increase the computational load. This section studies the SEIK ﬁlter
performance with respect to ensemble size with the idealized inlet Ebb Shoal.
For the constant Manning’s n coeﬃcient case, we run SEIK with the ensemble
sizes of 10, 20 and 100, and compared the parameter estimates in time focusing on
both the means and the 95% percentile of the parameter. The posterior distribution
at the ﬁnal assimilation time are compared between all ensemble size. We conducted
this experiment in two cases where the initial guess did and did not recovered the
truth, using the initial guesses equal to 0.06 (Figure 3.10) and 0.015 (Figure 3.9)
respectively.
Using 100 ensemble members, the results show signiﬁcant improvement in com-
parison to using only 10 ensemble members, especially for the case where we estimate
the Manning’s n coeﬃcient 0.17 from the smallest initial guess 0.015. In the 10 en-
semble case, the recovering truth after the end of the assimilation is 0.07. When we
used 100 members, the estimation increased to 0.14, which is considered to be within
the same class as the truth. However, it’s clear that a hundred ensemble members is
still not suﬃcient to accurately recover the class E exactly for small initial guesses.
As for the case where we start the guess from class C (Figure 3.10), no signiﬁcant
improvement results from increasing the ensemble size as the estimates was accurate
enough to begin with. Nevertheless, the recovering of the truth from class E from
class C is more accurate with increased ensemble size. one can also observe faster
convergence toward the truth with increased ensemble sizes.
In the case of estimating a 2-D parameterized Manning’s n ﬁeld, we compare the
results obtained from 10 ensemble and 100 ensemble members for both α (Manning’s

56
n coeﬃcient in the open ocean) and β (Manning’s n coeﬃcient in the landlocked
area). As expected, we found the improvement in estimating the parameters, espe-
cially β when using 100 ensembles, in comparison to using 10 only ensembles, which
underestimated the truth for all initial guesses.
3.7
The eﬀect of using inﬂation factor
The previous section was shown that increasing ensemble size is eﬀective, however
large number of members are needed to accurately recovering the parameters, and
this means increased computational cost. Another way to improve the robustness
of an EnKF is to inﬂate the forecast error covariance by multiplying by an inﬂation
factor > 1 [76]. The use of an inﬂation factor in described thoroughly in Pham [39].
Covariance inﬂation is becoming important assimilation technique in the successful
implementation.
We perform the same OSSEs as in the previous section for the idealized inlet
Ebb Shoal, with an inﬂation of 2. Figure 3.13 shows the performance of the SEIK
ﬁlter in recovering the true Manning’s n coeﬃcient from several initial guesses for
the 1D constant Manning’s n value. Signiﬁcant improvement was observed and any
true value is now accurately recovered from any starting point. This is due to the
inﬂation of the background error covariance at every forecast step, as illustrated by
the opaque color background around the estimated means.
Similarly to the previous section, we compared the SEIK implementation with
and without inﬂation for the initial guess equal to 0.015 and 0.06, which represent
the classes with the resulting least and most accurate estimates respectively (Figure
3.14 and Figure 3.14). The recovering of a constant Manning’s n coeﬃcient is now
accurate regardless of the classes we started from, with an additional widening of the
distribution around the mean.

57
The results estimating of 2D parameterized Manning’s n ﬁeld in Figure 3.16 and
Figure 3.17 show somewhat similar improvements as for the 1D cases.
3.8
Discussions
In this chapter, we discuss the use of the SEIK for parameter estimation to recover
the true value of the Manning’s n coeﬃcient. We conducted the OSSEs in two distinct
domains. The eﬀort was spent to recover both constant ﬁelds and 2D parameterized
piecewise constant ﬁeld. The result shows that in the case where we apply SEIK
with small number of ensembles, large true values can hardly be recovered from small
initial guesses with with short simulation windows, and better estimates required
longer simulation time will be needed.
Increasing the ensemble size signiﬁcantly
improve the ﬁlter solutions, however this also requires much more computation. The
most suitable solution to tackle this underestimation issue is to inﬂate the background
forecast error covariance, which in turn speeds up the convergence of the estimation
to the truth, with no signiﬁcant increase in computational resources. In addition to
the work of Talea et al., which mainly focus only on the point estimation of Manning’s
n ﬁeld, we also look at the uncertainty propagation of this parameter by analyzing
at its marginal distribution. The distribution of the parameters estimated by the
SEIK are Gaussian, with their statistics can be completely determined by the ﬁrst to
moment statistics. We observed that while increasing the ensemble size signiﬁcantly
improves the estimates, the variance in respect to ensemble size are approximately
the same. The use of an inﬂation factor widen the estimated Manning’s n coeﬃcient
distributions depends on the size of inﬂation factor. While the EnKF-based approach
for the parameter estimation provide good estimations of the mean, the correctness
of its marginal distribution is still needed to be addressed.
In the next chapter,
the PC-MCMC based parameter estimation will be implemented to compute the full

58
distribution of the estimated Manning’s n coeﬃcient, and then compared with the
results from EnKF based estimation approach.

59
Figure 3.1: point estimation of various constant Manning’s n ﬁelds parameterized for
the idealized inlet with ebb shoal case.

60
Figure 3.2:
Estimates of various Manning’s n ﬁelds parameterized by a single value
for the idealized inlet with ebb shoal case using 10 ensemble members. The width of
the pdf from the mean is equal to 3th standard deviation.

61
Figure 3.3:
point estimation of various constant Manning’s n ﬁelds parameterized
for Galveston Bay.

62
Figure 3.4:
Estimates of various Manning’s n ﬁelds parameterized by a single value
for Galveston Bay. The width of the pdf from the mean is equal to 3th standard
deviation.

63
Figure 3.5:
point estimates of α (left) and β (right) from various initial guesses for
the idealized inlet with ebb shoal case.
Figure 3.6: pdf estimates of α (left) and β (right) from various initial guesses for the
idealized inlet with ebb shoal case using 10 ensembles.
Figure 3.7: point estimates of β from various initial guesses with the same α for
Galveston bay case.

64
Figure 3.8: point estimates of β from various initial guesses with the same α for
Galveston bay case using 10 ensembles.

65
Figure 3.9: Comparison of the posterior distribution resulting from SEIK for constant
Manning’s n coeﬃcient with three diﬀerent number of ensembles and initial guess =
0.015.
(Left column) the 95 percentile over time, (Right column) the pdf of the
posterior at the end of the simulations.

66
Figure 3.10: Comparison of the posterior distribution resulting from SEIK for con-
stant Manning’s n coeﬃcient with three diﬀerent number of ensembles and initial
guess = 0.06. (Left column) the 95 percentile over time, (Right column) the pdf of
the posterior at the end of the simulations.

67
Figure 3.11: Comparison of the posterior distribution result from SEIK for piecewise
Manning’s n coeﬃcient in the open ocean with diﬀerent number of ensembles from
several initial guesses. (Left column) the 95 percentile over time, (Right column) the
pdf of the posterior at the end of the simulations.

68
Figure 3.12: Comparison of the posterior distribution result from SEIK for piecewise
Manning’s n coeﬃcient in the landlocked area with diﬀerent number of ensembles from
several initial guesses. (Left column) the 95 percentile over time, (Right column) the
pdf of the posterior at the end of the simulations.

69
Figure 3.13: Estimates of various true Manning’s n ﬁelds parameterized by a single
value for the idealized inlet with ebb shoal case using 10 ensemble members with
inﬂation factor of 0.5. The width of the pdf from the mean is equal to 3th standard
deviation.

70
Figure 3.14: Comparison of the posterior distribution result from SEIK for constant
Manning’s n coeﬃcient between SEIK and SEIK with inﬂation factor, initial guess
= 0.015. (Left column) the 95 percentile over time, (Right column) the pdf of the
posterior at the end of the simulations.

71
Figure 3.15: Comparison of the posterior distribution result from SEIK for constant
Manning’s n coeﬃcient between SEIK and SEIK with inﬂation factor, initial guess
= 0.06. (Left column) the 95 percentile over time, (Right column) the pdf of the
posterior at the end of the simulations.

72
Figure 3.16: Comparison of the posterior distribution result from SEIK for 2D piece-
wise Manning’s n coeﬃcient between SEIK and SEIK with inﬂation factor in the
open ocean of idealized inlet case. (Left column) the 95 percentile over time, (Right
column) the pdf of the posterior at the end of the simulations.

73
Figure 3.17: Comparison of the posterior distribution result from SEIK for 2D piece-
wise Manning’s n coeﬃcient between SEIK and SEIK with inﬂation factor in the
open ocean of idealized inlet case. (Left column) the 95 percentile over time, (Right
column) the pdf of the posterior at the end of the simulations.

74
Chapter 4
PC-MCMC based for Manning’s n
coeﬃcient estimation
Chapter 3 presented and discussed the use of a Bayesian ﬁltering approach based on
the ensemble Kalman ﬁlter, the SEIK ﬁlter, for estimating the Manning’s n coeﬃ-
cient of the ADCIRC model. In this chapter we use the MCMC method to directly
sampling the pdf of Manning’s n coeﬃcient from Bayes’s rule. To alleviate the huge
computational requirements of MCMC we also resort to a PC-based appraoch to built
a surrogate model that allows to sample the likelihood with reasonable computational
requirements.
In the following section in will be shown that the EnKF and SEIK ﬁlter can be
derived from the Bayes’ theorem under speciﬁc assumptions they rely on. The notion
that all data assimilation methods can be formulated from the Bayes’ theorem will
lead us the resemblance between ﬁltering problem and Markov Chain Monte Carlo
(MCMC) methods for parameter estimation since MCMC also provides the method
for sampling the distribution from the posterior provided by Bayes’ theorem with less
restriction than Kalman ﬁlter.
In general circumstances, since the large number of sampling iterations in MCMC
is required for the distribution to converge to the posterior, it is too costly and time-
consuming to apply MCMC to the sophisticate model such that of the ADCIRC

75
model since for each model run is already costly. However, since we have reduced
the size of the model in the form of the surrogate model presented in the previous
chapter (By applying polynomial chaos expansion to the model), the evaluation of
MCMC with huge sampling become cheap and applicable.
In fact, KF and its derivatives based on the ﬁltering theory are considered to
be well-established, robust and ﬂexible method in data assimilation for real-world
applications. Their sequential nature has made them suitable for real-time ocean and
atmospheric forecasting. They also capable of updating the huge state vector which
is not the case for MCMC if the model evaluated by MCMC is slow. Furthermore,
the reduced version of the model using PCs required that the number of parameters
we want to estimate must be small. It cannot account for the big vector of the initial
condition (i.g. The water elevation at each and every node on the domain) using
PCs. In this thesis, it is only reasonable to apply the PCs to the model because
the maximum number of the parameters we want to approximate is two, while the
forcing, boundary conditions and other initial conditions are remain unchanged.
Since the ﬁltering approaches in data assimilation are more practical and appro-
priately utilized in storm surge forecasting, however, with the restricted Gaussian
statistics assumption, the question that needs to be addressed here is, how well the
posterior distribution obtained from SEIK approximates the true posterior distribu-
tion?. In this chapter, we represent the posterior distribution of the Manning’s n
coeﬃcients with the PDF generated by MCMC methods. The comparison of both
approaches is the main objective of this chapter and also serve as the conclusion to
the whole work devoted in this thesis.

76
4.1
MCMC theory and Algorithm
In the context of parameter estimation, it is useful to look at the data assimila-
tion problem in the view of Baysian inference. Especially since MCMC algorithm is
constructed on the calculation of the prior and the likelihood function derived from
Bayes’ theorem, we will start our framework by explaining the Bayes’ theorem.
Suppose that we have a set of data ({di}N
i=1) and we assume a certain model to
describe the data. Let H be the set of parameters (i.e. our hypotheses) deﬁning our
model. Bayes’ theorem is given by,
p(H| {di}N
i=1) ∝p({di}N
i=1 |H)p(H)
(4.1)
where,
 p(H) is the prior of H.
 p({di}N
i=1 |H) is the likeihood function.
 p(H| {di}N
i=1) is the posterior probability.
The likelihood function p({di}N
i=1 |H) represents the probability of obtaining the
data given the hypotheses H. The prior p(H) represents the information that we
have about the unknown parameters before the observations are taken into consid-
eration. The choice of a prior is a key step in the inference process and should be
based, when possible, on some a priori knowledge about the parameters. In general,
we distinguish between informative (e.g. a Gaussian with known mean and variance),
and non-informative priors (e.g. a uniform distribution where we only need the upper
and lower bounds). Bayes’ theorem describes a process of continuously updating the

77
current state of knowledge in view of new observation.
Let’s now consider our model,
h(ξ, x, t) =
P
X
k=0
ck(x, t)Ψk(ξ, x, t)
(4.2)
where h(ξ, x, t) represents the solution of shallow water equation is the water el-
evations as a function of ξ = (α, β)T, position on x-y coordinate and time. It follows
that our hypothesis is H = {α, β}.
The purpose is to recover the original model given the true data from the ob-
servation which means recovering the parameters. In our case, we run the original
ADCIRC model with a set of Manning’s n coeﬃcients α and β, recording the eleva-
tion at the chosen points and times then we consider those data the truth (or the
observation vector).
To build the likelihood function we assump the following relationship:
d(x, t) = h(ξ, x, t) + ϵ
(4.3)
where ϵ is a random variable which represents the discrepancy between our model,
h(ξ, x, t) , and the observations.
Assuming N independent realizations and to be
normally distributed, the likelihood function can be written as
L ≡p({di}N
i=1 |H) =
N
Y
i=1
1
√
2πσ2exp((di,j −h(xi, tj))2
2σ2
)
(4.4)

78
By assuming that ϵ follows a Gaussian distribution with mean zero and variance
σ2, i.e. ϵ ≃N(0, σ2). The objective here is to jointly infer σ2, α and β.
The prior of α and β is deﬁned by a uniform distribution,
p(ξi) =





1/2
for -1 ⩽ξi ⩽1,
0
Otherwise ,
We know that σ2 cannot be negative. This is what we deﬁned a priori knowledge
about a parameter. We assume a Jeﬀreys prior:
p(σ2) =





1/σ2
for σ2 > 0
0
Otherwise ,
Now the ﬁnal form of the joint posterior is,
p({ξk}p
k=0 | {di}N
i=1) ∝[
N
Y
i=1
1
√
2πσ2exp((di,j −h(xi, tj))2
2σ2
)]p(σ2)
p
Y
j=0
p(ξj)
(4.5)
The next step after we formulate the posterior is to simulate it. This can be done
by usig MCMC sampling algorithm.
Markov Chain Monte Carlo (MCMC) methods generates a Markov chain in which
at a certain time t, the each state xt depends only on the previous one xt1. Suppose
the current value of the chain is xt. We draw a proposal state x from a Gaussian
function centered at the current state: Q(xt) ∼N(xt, β2I). Then we Calculate the
ratio of the likelihood evaluated for the proposed sample x and the previous sample
xt:

79
r = L(x′)
L(xt)
(4.6)
The new state xt+1 is chosen according to the following rule:
xt+1 =





x′
if α < r, ACCEPTED,
xt
if Otherwise , REJECTED.
Here α ∼U(0, 1) and β2 is the variance in proposal drawing step. β2 need to be
well-tuned in order to produce a well-mixed chain. Unfortunately there is no standard
procedure to know the best β2. This value has to be ﬁgured out by trials-and-errors
method. In general, the objective is to have an average acceptance ratio between 0.40
and 0.50.
4.2
Polynomial Chaos, Theory and Methodology
Uncertainties in the input variables, parameters and state variables can be modeled
as stochastic variables. The system states can be represented by a random vector,x(t)
and its time evolution is given by the following diﬀerential equation:
˙x(t, Θ) = f(t, Θ, x, u),
x(t0) = x0
(4.7)
Here, Θ represents uncertain parameters and u is deterministic forcing terms.
The initial state estimate x0 may be also uncertain. Let p(tk, xk, Θ) is the probability
distribution function (pdf) of the state vector tk. Our aim is to compute full pdf,
characterizing the space-time evolution of state vector xk, monitoring uncertainty in

80
terms of multi-modal distribution, exploiting Bayesian inference to update estimated
parameters.
Various techniques have been developed to propogate uncertainties in the inputs
and the parameters forward in time [77]. The most popular one being Monte Carlo
(MC) [78] , Gaussian closure [79], equivalent linearization [80], and stochastic aver-
aging [81, 82]. All of these methods, except the MC methods are suitable only for
linear or moderately nonlinear systems. The MC method requires however exten-
sive computational resources and can be prohibitive for high-dimensional dynamic
systems.
Recently new uncertainties propagation methods have been developed based on
the polynomial chaos theory [33]. Generalized polynomial chaos (gPC) is an extension
of the homogeneous chaos idea of Wiener. The idea is to separate the random variables
from deterministic one while solving the stochastic diﬀerential equation. Then the
random variables are expanded using a suitable polynomial expansion. Suitable type
of basis polynomial for random variables of diﬀerent probability distribution as shown
in the following table.
Table 4.1: The type of generalized polynomial chaos and their corresponding random
variables
Distribution of Z
gPC basis polynomials
Support
Continuous
Gaussian
Hermite
(−∞, ∞)
Gamma
Laguerre
[0, ∞)
Beta
Jocobi
[a, b]
Uniform
Legendre
[a, b]
Discrete
Poisson
Charlier
{0, 1, 2, ..}
Binomial
Krawtchouk
0, 1, ..., N
Negative binomial
Meixner
{0, 1, 2, ...}
Hypergeometric
Hahn
0, 1, ..., N

81
4.2.1
Linear systems
A linear ﬁrst-order stochastic equation can be written in the following generic form:
˙x (t, Θ) = A(Θ) + B(Θ)u(t)
(4.8)
where A ∈Rn×n and B ∈Rn×p · u ∈Rp×1 is vector of input signals and θ ∈Rr
is a vector of uncertain parameters which is a function of the random variable ξ with
a known probability distribution p(ξ). We assume that the uncertain state vector
x(t, θ) and system parameter Aij and Bij can be written as a linear combination of
basis function, φk(ξ), which span the stochastic space of random variable ξ :
xi(t, ξ) =
N
X
k=0
xik(t)φk(ξ) = xT
i (t)Φ(ξ)
(4.9)
Aij =
N
X
k=0
aijkφk(ξ) = xT
ijΦ(ξ)
(4.10)
Bij(ξ) =
N
X
k=0
bijkφk(ξ) = bT
ijΦ(ξ)
(4.11)
where Φ(.) ∈RN is a vector of polynomial basis function orthogonal to p(ξ)
constructed using the Gram-Schimidt Orthogonalization process. The choice of poly-
nomial basis functions and the corresponding pdf of p(ξ) is summarized in 4.1 [36].
The coeﬃcient aijk and bijk are calculated from the following normal equations:
aijk = ⟨Aij(Θ(ξ)), φk(ξ)⟩
⟨φk(ξ), φk(ξ)⟩
(4.12)
bijk = ⟨Bij(Θ(ξ)), φk(ξ)⟩
⟨φk(ξ), φk(ξ)⟩
(4.13)
where ⟨u(ξ), v(ξ)⟩
R
Rr u(ξ)v(ξ)p(ξ)dξ is the inner product with p(ξ) as a weighing
function.

82
The total number of terms in the gPC expansion (N) depends on the selected
highest order of basis polynomial φk(ξ) , denoted by l. The dimension of the vector
of uncertain parameters Θ is then
N =



l + m
m


= (l + m)!
m!l!
(4.14)
Now, substituting Eq. 4.9, 4.10 and Eq. 4.11 in Eq. 4.8, we obtain:
ei(ξ) =
N
X
k=0
˙xik(t)φk(ξ) −
n
X
j=1
 N
X
k=0
aijkφk(ξ)
!  N
X
k=0
xik(t)φk(ξ)
!
−
p
X
j=1
 N
X
k=0
bijkφk(ξ)
!
uj,
i = 1, 2, ..., n
(4.15)
Eq.(4.15) gives the error of gPC solution of Eq.(4.8) which contains n(N + 1) time-
varying unknown coeﬃcients xik(t). This unknown coeﬃcients can be obtained by
projecting the error of Eq.
4.8 onto the space of basis function φk(ξ) (Galerkin
process).
⟨ei(C, ξ), φk(ξ)⟩= 0,
i = 1, 2, ..., n,
k = 1, 2, ..., N
(4.16)
Thus we obtain the following set of n(N + 1) deterministic diﬀertial equations:
˙xpc(t) = Axpc(t) + Bu(t)
(4.17)
Here xpc(t) =

xT
1 , xT
2 , ..., N
	
is a vector of n(N + 1) unknown coeﬃcients, A ∈
Rn(N+1)×n(N+1) and B ∈Rn(N+1)×p. Let P and Tk, for k = 0, 1, 2, ..., N denote the

83
matrices of the inner product between the orthogonal polynomials deﬁned as follows:
Pij = ⟨φi(ξ), φj(ξ)⟩,
i, j = 0, 1, 2, ..., N
(4.18)
Tkij = ⟨φi(ξ), φj(ξ), φk(ξ)⟩. i, j = 0, 1, 2, ..., N
(4.19)
Then we can write A and B as an n(N + 1) × n(N + 1) block-diagonal matrix, each
of them being an (N + 1) × (N + 1) matrix. The matrix A is composed of blocks
Aij ∈R(N+1)×(N+1) deﬁned as:
Aij = AijP,
i, j = 1, 2, ..., n
(4.20)
which can be written as
Aij(k, :) = aT
ijTk,
i, j = 1, 2, ..., n
(4.21)
The matrix B consists of blocks Bij ∈R(N+1×1), which is deﬁned as:
Bij = Pbij i = 1, 2, ..., n,
i = 1, 2, ..., p
(4.22)
Eq.
(4.9) together with Eq.
(4.17) deﬁne the uncertain state vector x(t, ξ) as a
function of the random variable ξ. Following this formulation any order moment of
uncertain state variables can then be computed. For example, the ﬁrst two moments
for state vector x(t) can be computed as follow:
E [xi(t)] =
n
X
i=1
xi1(t),
i = 1, ..., n
(4.23)
E [xi(t)xj(t)] =
N
X
k=0
xik(t)xjk(t),
i, j = 1, ..., n
(4.24)

84
4.2.2
Nonlinear systems
To extend the gPC method to propagating the state and parameter uncertainties with
a nonlinear system, we start from the following generic equation:
˙x(t, Θ) = f(t, Θ, x, u),
x(t0) = x0
(4.25)
where u(t) is the input vector at time t, x(t, Θ) = [x2(t, Θ), x1(t, Θ), ..., xn(t, Θ)]T ∈
Rn is the state vector of stochastic system. Here the uncertain parameter vector
Θ = [θ1, θ2, ..., θm]T ∈Rm is assumed to be constant with time and a function of
a random vector ξ = [ξ1, ξ2, ..., ξm]T ∈Rm deﬁned by p(ξ) over the support Ω. In
general f(t, Θ, x, u) can be a nonlinear function.
In this case the gPC expansion for the state vector x and the uncertain parameter
Θ is given by:
xi(t, Θ) =
N
X
k=0
xik(t)φk(ξ) = xT
i (t)Φ(ξ) ⇒x(t, ξ) = Xpc(t)Φ(ξ)
(4.26)
θi(ξ) =
N
X
k=0
θikφk(ξ) = θT
i φ(ξ) ⇒Θ(t, ξ) = ΘpcΦ(ξ)
(4.27)
where, Xpc and Θpc are matrices of coeﬃcients of gPC expansion for state x and
parameter Θ respectively. The coeﬃcients θik are obtained through the normal equa-
tions, as in the linear case:
θik = ⟨θi(ξ), φk(ξ)⟩
⟨θk(ξ), φk(ξ)⟩
(4.28)
Similar to linear case,we substitute Eq. (4.26) and (4.27) into (4.25) and obtain:
ei(Xpc, ξ) =
N
X
k=0
˙xik(t)φk(ξ) −fi(t, Xpc(t)Φ(ξ), ΘpcΦ(ξ), u),
i = 1, 2, ..., n (4.29)

85
Applying the Galerkin process to Eq. (4.16) we obtain n(N + 1) time-varying coeﬃ-
cients xik. However, for nonlinear stochastic diﬀerential equations, Galerkin process
will lead to a set of n(N + 1) nonlinear deterministic diﬀerential equations and diﬃ-
culties may arise during the computation of projection integrals of Eq. (4.16). This
problem can be overcome by using the Polynomial Chaos Quadrature (PCQ) tech-
nique , which is discussed in the next section.
4.2.3
Polynomial chaos quadrature
Dalbey et al. [83] proposed a technique called ,Polynomial Chaos Quadrature (PCQ),
for the implementation of polynomial chaos integration with non linear model. The
idea is to replaced the projection step of the gPC by a PCQ. After substituting Eq.
(4.26) and Eq. (4.27) into (4.25) one obtains:
N
X
k=0
˙xik(t)φk(ξ) −fi(t, Xpc(t)Φ(ξ, ΘpcΦ(ξ)), u) = 0,
i = 1, ..., n
(4.30)
Upon the projection step of PC yields:
N
X
k=0
⟨φk(ξ), φj(ξ)⟩˙xik −⟨fi(t, Xpc(t)Φ(ξ), ΘpcΦ(ξ), u), φj(ξ)⟩= 0
(4.31)
i = 1, ..., n,
j = 0, ..., N
When f is linear it is possible to evaluate the projection integral in Eq. (4.31) an-
alytically.
When f is nonlinear, the exact integration is replaced by a numerical
integration, in this case the Gauss quadrature method. Then one obtain:
⟨φi(ξ), φj(ξ)⟩=
Z
φi(ξ)φj(ξ)p(ξ)dξ ≃
M
X
q=1
wqφi(ξq)φj(ξq)
(4.32)

86
⟨φi(ξ), φj(ξ)φk(ξ)⟩=
Z
φi(ξ)φj(ξ)φk(ξ)p(ξ)dξ
≃
M
X
q=1
wqφi(ξq)φj(ξq)φk(ξq)
(4.33)
⟨fi(t, Xpc(t)Φ(ξ), ΘpcΦ(ξ), u), φj(ξ) =
Z
fi(t, Xpc(t)Φ(ξ), ΘpcΦ(ξ), u))
φj(ξp(ξ)dξ ≃
M
X
q=1
wq⟨fi(t, Xpc(t)Φ(ξq), ΘpcΦ(ξq), u), φj(ξq)
(4.34)
where M is the number of quadrature used. Substituting Eq. (4.32), (4.33) and (4.34)
into Eq. (4.31) and interchanging summation and diﬀerentiation we obtain:
d
dt
M
X
q=1
N
X
k=0
wqφj(ξq)φk(ξq)xik −
M
X
q=1
wqfi(t, Xpc(t)Φ(ξq), ΘpcΦ(ξq), u), φj(ξq) = 0,
(4.35)
which becomes after simpliﬁcation:
d
dt
M
X
q=1
φj(ξq)xi(t, ξq)wq −
M
X
q=1
wqfi(t, Xpc(t)Φ(ξq), ΘpcΦ(ξq), u), φj(ξq) = 0.
(4.36)
Performing integration with respect to time t yields:
M
X
q=1
(xi(t, ξq) −xi(t0, ξq))φj(ξq)wq
−
Z t
t0
M
X
q=1
wqfi(t, Xpc(t)Φ(ξq), ΘpcΦ(ξq), u), φj(ξq)dt = 0.
(4.37)

87
Interchanging the order of integration and summation leads to the following equation.
M
X
q=1

(xi(t, ξq) −xi(t0, ξq)) −
Z t
t0
fi(t, Xpc(t)Φ(ξq), ΘpcΦ(ξq), u), φj(ξq)dt

φj(ξq)wq = 0
i = 1, ..., n
(4.38)
The integral term in Eq. (4.38) can be evaluated by integrating the model equation
with a speciﬁc instance of the random variable ξ. In this way the statistics of the
system responses can be computed by sampling the random input with a speciﬁc pdf.
Finally, the coeﬃcients of the gPC representation can be computed as follows:
xik = 1/d2
k
M
X
q=1
Xi(t0, t, ξq, u)φk(ξq)wq,
k, j = 0, 1, ..., n
(4.39)
where
Xi(it, ξq, u)
=
xi(t0, ξq) +
Z t
t0
fi(t, Xpc(t)Φ(ξq), ΘpcΦ(ξq), u)
(4.40)
d2
k
=
Z
Ω
φk(ξ)φk(ξ)p(ξ)dξ
(4.41)
The moments of the system state and parameters can be estimated by the following
relation:
E

xi(t)N
=
Z
Ω
Z t
t0
˙xidt

dp(ξ)
=
Z
Ω

xi(t0, xi) +
Z t
t0
fi(t, x, Θ, u)dt
N
dp(ξ). i = 1, ..., n (4.42)
For a ﬁxed Θ = Θq, the time integration is simply deterministic and can be computed
with standard numerical methods. Applying PCQ over the certain inputs to estimate

88
the state pdf yields the following moment relation.
E

xi(t)N
=
X
q
wq

Xi(t0, t, ξq, u)
N
i = 1, 2, ..., n
(4.43)
Thus the moments of state variables are approximated as a weighted sum of the out-
puts of simulation run at the quadrature points of the uncertain input parameters.
In the standard Gaussian quadrature applied in this work, we have to exactly inte-
grate polynomials up to degree 2N + 1 with N + 1 quadrature points. Consequently
the number of quadrature points increase exponentially as the number of input pa-
rameters increases. To mitigate this error of PCQ under sampling, an adaptive or
nested quadrature scheme which successively reﬁnes the accuracy of the solutions by
increasing the number of sample points, such as Clenshaw-Curtis quadrature method
[84], [85] was developed. Some examples of gPC formulation and simulation results
for linear and nonlinear systems are given in [36] and [77].
4.2.4
Non-intrusive spectral projection (NISP)
In the process of formulating gPC, one can compute the coeﬃcients of PC expansion
following two main approaches: (1) intrusive methods, and (2) the non-intrusive
methods.
The most straightforward way to build a gPC model is to reformulate
the original stochastic model through Galerkin projection onto PC basis and then
solve for the time/space evolution of PC coeﬃcients [23], [24]. This is exactly what
we call, an intrusive approach. This reformulation may however be diﬃcult to code
and requires considerable skills for rather complex models like ADCIRC. In the non-
intrusive methods, the requisite spectral representation is computed through direct
application of existing deterministic solvers. This approach reduces the complexity
of gPC formulation while still providing satisﬁed gPC representation of the original
model as has been shown in many application [42, 34, 16].

89
In the non-intrusive approach we may use diﬀerent methods to compute the PC
expansion coeﬃcients including non-intrusive spectral projection (NISP), the colloca-
tion methods (CM), and the regression-like methods. In the regression-like methods
[86], the PC coeﬃcients can be estimated by minimizing the distance between the PC
expansion and experimental observations/simulations. Using interpolation, the CM
methods computes the PC coeﬃcients by using the PC basis as a set of interpolants
[87, 88, 28, 89] . The NISP method, which we chose to apply in this work, computes
the PC coeﬃcients through L2-projection of variables onto PC basis.
However NISP is not without drawbacks but in general all non-intrusive methods
suﬀer from the so-called curse of dimensionality. In the NISP method, a rapid increase
in the number of deterministic realizations is required to compute the PC coeﬃcient
as the order of expansion and number of stochastic dimensions increase. One way
to mitigate this drawback of NISP is to use sparse quadrature techniques where the
quality of the PC representation can be monitored and the sparse grid is successively
reﬁned to meet the accuracy required.
The following discussion summarize the use of Non-intrusive spectral projection
in the PC method.
We denote a probability space by (Ω, F, µ), where Ωis the
sample space, F is an appropriate σ-algebra on Ω, and µ is a probability measure.
Let ξ is a random variable on Ωhaving a uniform pdf ξ ∼U (a, b) on the interval
[a, b]. The cumulative distribution function of random variable ξ on Ωis given by
Fξ(x) = µ(ξ ≤x) for x ∈R
Let us consider a model with ﬁnite uncertain parameters. These parameters are
parameterized by a ﬁnite collection of real-valued, independently and identical dis-
tributed (iid) random variables ξ1, ..., ξd on Ωwhere d refers to the number of random
variables or the dimension of the stochastic problem. Let Fξ denote the joint dis-
tribution function of the random vector ξ = (ξ1, ..., ξd)T.
Since all events ξj are
independent, Fξ(x) = Qd
j=1 F(xj) for x ∈Rd, where F is the common distribution

90
function for ξ1, ..., ξd.
In computation we normally work in the image probability space (Ω∗, B(Ω∗), Fξ)
for convenience. Here Ω∗⊆Rd is the image of Ωunder ξ, and B(Ω∗) is the Borel σ-
algebra on Ω∗. Let X and Y denote the two random variables. Thus the expectations
are deﬁned for X, Y : Ω∗→R as:
⟨X⟩=
Z
Ω∗X(s)dFξ(s).
(4.44)
The space of square integrable random variable on Ω∗, L2(Ω∗):
⟨XY ⟩= (X, Y ) =
Z
Ω∗X(s)Y (s)dFξ(s)
(4.45)
and the norm of X is deﬁned by ∥X ∥L2(Ω∗)= (X, X)1/2 = ⟨X2⟩1/2. If we parameterize
these random inputs with canonical random variables ξi
iid
∼U (−1, 1) and use the d-
variate Legendre polynomials {Ψk}∞
0 . Each Ψk is deﬁned as follows.
Ψk(ξ) =
d
Y
i=1
Ψαk
i (ξi),
ξ ∈Ω∗
(4.46)
where αk = (αk
1, αk
2, ..., αk
d) is a multi index vector, with αk
i being the order of 1D
Legendre polynomial, Ψ, in ξi. With this basis, any X ∈L2(Ω∗) can be written as a
gPC as follows.
X =
∞
X
k=0
ckΨk.
(4.47)
For computation, we truncate Eq. 4.47 to a ﬁnite series
X(ξ) ˙=
P
X
k=0
ckΨk.(ξ)
(4.48)
P depends on the stochastic dimension d and expansion order, p, according to the

91
following relation
P = (d + p)!
d!p!
−1.
(4.49)
Let X belongs to L2(Ω∗). Since {Ψk}P
0 form an orthogonal system, we can simplify
the following dot product.
(X, Ψk) =
 P
X
l=0
clΨl, Ψk
!
=
P
X
l=0
cl(Ψl, Ψk) = ck(Ψk, Ψk),
(4.50)
and the coeﬃcient ck is computed from
ck = ⟨XΨk⟩
⟨Ψ2
k⟩.
(4.51)
Here the moments ⟨Ψ2
k⟩of multivariate Legendre polynomials in 4.51 can be evaluated
analytically [24] while ⟨X, Ψk⟩require more elaborated computation. As we note that
⟨X, Ψk⟩=
Z
Ω∗X(s)Ψk(s)dFξ(s),
k = 0, ..., P.
Thus evaluating coeﬃcient ck involves computing the values of a set of P +1 integrals
over Ω∗⊆Rd which can be discretized as ﬁnite sums using an appropriate quadrature
formula which takes the form
Z
Ω∗X(s)Ψk(s)dFξ(s) ˙=
Nq
X
j=1
wjX(ξj)Ψk(ξj),
(4.52)
where ξj ∈Ω∗and wj are the nodes and weights.
As mentioned previously, the
complexity of NISP scales with Nq = nd, the number of nodes n and number of
uncertain parameters d.
Thus this approach is limited to low d.
Indeed, as the
number of uncertain parameters increase the integral in Eq. (4.52) becomes more
complex exponentially, creating the so-called ’the curse of dimensionality’. To this

92
end one way to mitigate the diﬃculty is to use Smolyak’s formula [90] which leads
to sparse quadrature technique [91, 92, 93]. In this approach, the set of integration
nodes comprise what we call the NISP sample denoted by
S = {ξj}Nq
j=1 ⊂Ω∗.
(4.53)
Thus, to evaluate Eq.
4.52 , one needs to compute X(ξq) for all (ξq ∈S .
Let
Π ∈R(P+1)×Nq be the matrix called ”the NISP projection matrix” which is given by
Πk,j = wjΨk(ξj)
⟨Ψ2
k⟩
,
k = 0, ..., P,
j = 1, ..., Nq
Let ζ be the vector with coordinates ζi = X(ξj), then the vector c = Πζ, or in
component form
ck =
Nq
X
j=1
Πkjζj =
Nq
X
j=1
ΠkjX(ξj),
k = 0, ..., P.
(4.54)
4.3
ADCIRC uncertainties recast as stochastic vari-
ables
Let p = (p1, p2)T be the vector of random model inputs having uniform distri-
bution as speciﬁed in Table 4.2.
Speciﬁcally, the inputs pi are parameterized by
Table 4.2: The random input parameters for ADCIRC
Parameter
Description
Distribution
p1
(Manning’s n coeﬃcient in the open ocean)
U (−1, 1)
p2
(Manning’s n coeﬃcient in the landlocked area)
U (−1, 1)

93
ξi ∼U (−1, 1), i = 1, 2 through
pi(ξ) = µi + σiξi,
i = 1, 2
(4.55)
where ξ = (ξ1, ξ2)T, µi = (1/2)(ai +bi), and σi = (1/2)(bi −ai), so that pi ∼U (ai, bi)
as in Table 4.2. Now let G be the physical domain in consideration. At a given time t
and a point x ∈G and with a given vector of random inputs p(ξ) we have the model
output denoted by X(t, x, ξ). Here
X(t, x, ξ) = A(t, x; p(ξ))
(4.56)
where A(t, x; p(ξ)) is the output of a deterministic ADCIRC solved at time t and
point x with the input parameters p(ξ). X may correspond to any output considered
the quantities of interest (QoIs).
4.3.1
PC representation of ADCIRC model for the idealized
ebb shoal
Based on the results of the SEIK implementation in chapter 3, we will only apply
the PC representation to the idealized Ebb Shoal case.
The polynomial chaos is
applied to the ADCIRC model, where the boundary conditions and initial conditions
are assumed perfectly known as in chapter 3. We used NISP with a level 6 Smolyak
quadrature to compute the spectral expansion of the model output in the PC basis.
Figure 4.4 plots the water elevation in time for both original ADCIRC model and
its surrogate counterpart at station one of the idealized Inlet Ebb Shoal. To ensure
that level 6 quadrature is a good representation of ADCIRC in this speciﬁc case, we
generated many PC version of the model with diﬀerent number of quadrature levels
ranging from 1 up to 6 and observed the convergence of these representations. This

94
is shown in Figure 4.3 alongside with the convergence to the PC coeﬃcients at a
selected station and time. According to these results, the distribution seems to level
oﬀat the PC order level p = 6 suggesting that a sixth−order expansion is suﬃcient.
In addition, we also compute the RMSE between the water elevation from ADCIRC
model and its counterpart. The RMSE is less than 5% of the wave amplitude for all
quadrature points. The errors are shown in Table 4.3.
Table 4.3: The random input parameters for RMSE between the true model and the
surrogate model (water elevations)
Quadrature point
RMSE (at station 1)
1st quadrature
0.088
10th quadrature
0.0011
20th quadrature
0.00036
30th quadrature
0.0012
4.4
Manning’s n coeﬃcient estimation using PC-
based ADCIRC model and MCMC
The following results are the posterior distribution of Manning’s n coeﬃcients com-
pared between SEIK and MCMC with the optimal β2. They were generated using
100000 iterations of MCMC. The accuracy of the estimations from MCMC are not
aﬀected by the initial guesses while SEIK is suﬀer the recovering of high value Man-
ning’s n coeﬃcients from the low-value initial guesses. Since the inﬂation factor was
used to improve the posterior from SEIK in chapter 3, we can show the comparison
between the two schemes (SEIK and MCMC) with and without inﬂation factor for
SEIK.
Figure 4.7 and 4.11 shows the comparison of the posterior pdfs of Manning’s
n coeﬃcient between SEIK ﬁlter approach with 10 ensemble members and MCMC
in a constant ﬁeld and 2D parameterized ﬁeld respectively. The pdfs produced by

95
SIEK is much more narrow in comparison to those produced by MCMC. This is due
to our initial setup of background error covariance when we run SEIK. SEIK ﬁlter
also underestimated the truths in many cases while MCMC experiences no diﬃculty
in the mentioned manner. The distributions produced by MCMC cover the wide
range of Manning’s n coeﬃcient and clearly portray to the Gaussian distribution
with their means approximately at the truth values. It is concluded that SEIK ﬁlter
with small ensembles size is not a good representation to propagate the uncertainty
of the estimated parameters. However, the distribution can be improved to match
the goal standard MCMC by using background error covariance inﬂation.
Figure 4.10 and 4.12 shows the comparison of the posterior pdfs of Manning’s n
coeﬃcient between SEIK ﬁlter with the inﬂation factor of 2 and MCMC in a constant
ﬁeld and 2D parameterized ﬁeld respectively. The eﬀect of enforcing inﬂation factor
is more spread among the samples of the joint pdfs produced by SEIK as well as the
improvement in the estimation means of Manning’s n coeﬃcients in all cases. The pa-
rameter estimation with SEIK ﬁler in this case is appears to be a good representation
of the true posterior distribution formulated by Bayes’s rule.
4.5
Conclusion
The main focus of the theoretical part of this chapter is to portray of the link between
sequential data assimilation and the general parameter estimation framework based
on Bayesian theorem. We shown that any form of sequential data assimilation scheme
including SEIK can be fundamentally derived from the Bayes’s rule for the ﬁrst-order
Markov process. Given the suﬃcient amount of the observations, Bayes’s rule gives
the full pdfs of the estimated parameters with no Guassian restriction as prescribed
by Kalman ﬁltering framework.
The sampling of the posterior from the Bayes’s
rule using Metropolis-Hasting algorithm in MCMC is treated as the reference to

96
other data assimilation schemes. Thus, for the experimental part of this chapter, we
compared the pdfs of Manning’s n coeﬃcient from SEIK ﬁlter both with and without
inﬂation factor to the gold standard MCMC method.
The result reﬂect that the
uncertainty representation by SEIK for parameter estimation with inﬂation is a good
approximation of the true pdfs computed from the Bayes’s rule.

97
Figure 4.1: (Left) The distributions of the ADCIRC surrogate model output(water
elevation) of idealized Ebb Shoal case with several polynomial orders at the selected
points and times. The distributions is created by a million samples. (Right) Polyno-
mial chaos coeﬃcients at the corresponding points and times.

98
Figure 4.2: (Left) The distributions of the ADCIRC surrogate model output(water
elevation) of idealized Ebb Shoal case with several polynomial orders at the selected
points and times. The distributions is created by a million samples. (Right) Polyno-
mial chaos coeﬃcients at the corresponding points and times.

99
Figure 4.3: (Left) The distributions of the ADCIRC surrogate model output(water
elevation) of idealized Ebb Shoal case with several polynomial orders at the selected
points and times. The distributions is created by a million samples. (Right) Polyno-
mial chaos coeﬃcients at the corresponding points and times.

100
Figure 4.4: (Right) Water elevations simulated in time from the true model and
the surrogate model at several quadrature points (diﬀerent Manning’s n coeﬃcients).
(Left) The residuals.

101
Figure 4.5: The comparisons between the posterior distributions of 1D Manning’s n
coeﬃcient between SEIK ﬁlter( after 108 analysis iterations)and MCMC method.

102
Figure 4.6: The comparisons between the posterior distributions of 1D Manning’s n
coeﬃcient between SEIK ﬁlter( after 108 analysis iterations)and MCMC method.

103
Figure 4.7: The comparisons between the posterior distributions of 1D Manning’s n
coeﬃcient between SEIK ﬁlter( after 108 analysis iterations)and MCMC method.

104
Figure 4.8: The comparisons between the posterior distributions of 1D Manning’s n
coeﬃcient between SEIK ﬁlter with inﬂation( after 108 analysis iterations)and MCMC
method.

105
Figure 4.9: The comparisons between the posterior distributions of 1D Manning’s n
coeﬃcient between SEIK ﬁlter with inﬂation( after 108 analysis iterations)and MCMC
method.

106
Figure 4.10: The comparisons between the posterior distributions of 1D Manning’s n
coeﬃcient between SEIK ﬁlter with inﬂation( after 108 analysis iterations)and MCMC
method.

107
Figure 4.11: The comparisons between the posterior distributions of 2D Manning’s n
coeﬃcient between SEIK ﬁlter( after 108th analysis iterations)and MCMC method,
(Right) the distributions of α, (Left) the distribution of β .

108
Figure 4.12: The comparisons between the posterior distributions of 2D Manning’s n
coeﬃcient between SEIK ﬁlter( after 108th analysis iterations)and MCMC method,
(Right) the distributions of α, (Left) the distribution of β.

109
Chapter 5
Concluding Remarks
The parameter estimation problem is the on-going research area requires that there is
suﬃcient data provided from the real-world observation system. The inverse problem
can then be formulated in order to estimate the parameter in the model that ﬁt
the observations.
This thesis focus on determining the parameters related to the
ocean modeling system. The accurate knowledge about the bottom stress terms in a
physical domain is essential for the modeling of the hydrodynamics system. In the
ﬁeld of ocean modeling, bottom stress terms are embedded in the momentum equation
of the shallow water model, which is used vastly in the prediction sea level, tides
and storm surge under both moderate and extreme conditions. These stress terms
is formulated using Manning’s n coeﬃcient which relating the bottom stress to the
height of the water column above it. However, Manning’s n coeﬃcient is empirically
deﬁned constant and always subjected to large amount of uncertainty in the real-
world physical simulations. The recovering of the true Manning’s n coeﬃcient from
the observations is an active research area. An attempt to ﬁnd the eﬃcient framework
for the parameter estimation in storm surge and tides modeling is served as the prior
guaranty to the eﬀective coastal ocean prediction system.
In this work, we made an attempt to validate the correctness in estimating Man-
ning’s n coeﬃcient by SEIK ﬁlter, which is one of the most recent scheme in statistical
data assimilation introduced in many literature, by comparing the posterior distri-

110
bution of the parameter we estimated from SEIK to the distribution form the gold
standard approach, MCMC as our reference.
In the ﬁrst part, we conducted the Observation Simulation System Experiments
(OSSEs) on Advance Circulation (ADCIRC) model.
We generated the synthetic
water elevation data from several ﬁelds of Manning’s n coeﬃcient. Using the singu-
lar interpolated evolutive Kalman (SEIK) ﬁlter, we then recover these Manning’s n
coeﬃcient ﬁelds from incorrect initial guesses. We separated our OSSEs in to two
domains, one is idealized inlet with Ebb Shoal with comprising the open ocean area,
landlocked area and the inlet, another is the Galveston Bay represents the more re-
alistic version of the ﬁrst domain. We estimated two conﬁguration of Manning’s n
coeﬃcient ﬁelds. The ﬁrst was deﬁned by a constant Manning’s n coeﬃcient across
the domain. The second conﬁguration is 2D parameterized piecewise Manning’s n
coeﬃcient where the bottom stress in the bay was deﬁned by one constant value,
and the bottom stress in the open ocean was deﬁned by the other. For the constant
Manning’s ﬁeld, with small ensemble size (i.e. 10 ensemble members), there arise the
diﬃculty in estimating the large Manning’s ﬁeld from the small initial guess for both
domain. This is mainly due to the sensitivity diﬀerence of ADCIRC between the
small Manning’s n coeﬃcient values and the large value. ADCIRC is more sensitive
to the change in small Manning’s n coeﬃcient compare to the same amount of change
in large Manning’s n coeﬃcient. Increasing the size of ensemble members improved
the estimations. We have experimented with 10, 20 and 100 ensemble members for all
cases. The estimation from the small initial guess increase by 200% when using 100
ensemble members for the most diﬃcult case (i.e. estimating the largest Manning’s n
ﬁeld from the smallest initial guess). For the 2D parameterized ﬁeld of both domain,
the use of small ensemble size is suﬃcient to recover the truths. Since the increasing of
ensemble members requires greater computation, we instead used an inﬂation factor
as the solution to increase the the background error covariance. We found that the

111
estimations converge to the truth faster with less computation compare to increasing
ensemble size and the estimation of the means are accurate regardless of the accuracy
of initial guesses. It also can be observed that the use of inﬂation factor has widen
the posterior distribution of the parameter produced by SEIK.
In the second part, a spectral projection approach was implemented to propagate
parametric uncertainties in a coastal ocean model. A non-intrusive spectral projection
scheme was used to derive the PC representation of ADCIRC for selected Quantity
Of Interests (QoIs), which in our case, the water elevation. Using PC expansion, we
created the surrogate ADCIRC model of the idealized inlet with Ebb Shoal with the
same forcing as the previous OSSEs with SIEK. The input of the surrogate ADCIRC
model requires two inputs including the Manning’s n coeﬃcient in the landlocked
area and another in the open ocean. The output of the surrogate model following
the variation in these inputs are the water elevations at each node on the domain
in time. The merit of applying spectral projection approach to the model is that
its surrogate counterpart is much faster to execute, which allows the high frequency
sampling of the model in practical application possible. For our presented setups,
conditions and dimensions of stochastic problem, a level 6 sparse quadrature was
found to be adequate for producing the desirable model response.
In the last part of this study, we investigated more deeply into the Bayesian
viewpoint of sequential data assimilation. We emphasized that Kalman ﬁlter can be
viewed as the derivation of Bayesian’s rule sequentially in time. The Bayes’s rule
compute joint probability density functions (pdfs) of the estimated parameters given
the model and a set of observations. The surrogate version of ADCIRC created by
PC expansion was used in MCMC sampling of the posterior distribution of Manning’s
n coeﬃcients for the idealized inlet with Ebb Shoal. The implementation of PC and
MCMC alleviate upon the restriction of Gaussian posterior distribution imposed by
implementing Kalman ﬁlter to the parameter estimation problem. The Metropolis-

112
Hastings algorithm is used for our sampling of the posterior distribution for both
a constant Manning’s n ﬁeld and 2D parameterized Manning’s n ﬁeld. We ﬁnally
compared the posterior distribution produced by SEIK ﬁlter and MCMC on PC-
based model, it is found that the Manning’s n coeﬃcient estimation with SEIK, when
using the inﬂation factor, is a good approximation to the pdfs produced by the gold
standard MCMC.
In conclusion, while the PC-based approach coupled with MCMC for parameter
estimation is well-served for oﬄine application with low dimension stochastic system,
it is not designed for the usage in the online coastal ocean forecasting system which
includes a large number of uncertain parameters. The sequential data assimilation
scheme such as Kalman ﬁlter provides a robust solution to approximate the pdfs
in real-time.
However with the Guassion restriction, the parameter uncertainties
propagation by Kalman ﬁlter can be deceiving. The result of our study shows that
implementing the SEK ﬁlter to estimate Manning’s n coeﬃcient in ADCIRC model,
in additional with appropriate inﬂation factor, produces the pdfs close to that of the
goal standard MCMC. This indicates that the use SEIK ﬁlter is valid and eﬃcient to
estimate the uncertainty of low dimensional bottom stress term in ADCIRC model.

113
REFERENCES
[1] T. Yanagi, Coastal oceanography, Vol. 1.
Springer, 1999.
[2] T. Mayo, T. Butler, C. Dawson, and I. Hoteit, “Data assimilation within the
advanced circulation (adcirc) modeling framework for the estimation of mannings
friction coeﬃcient,” Ocean Modelling, vol. 76, pp. 43–58, April 2014.
[3] J. Dietrich, J. Westerink, A. Kennedy, J. Smith, R. Jensen, M. Zijlema,
L. Holthuijsen, C. Dawson, R. L. Jr, M. Powell, and et al., “Hurricane gus-
tav (2008) waves and storm surge: Hindcast, synoptic analysis, and validation
in southern louisiana,” Monthly Weather Review, vol. 139, no. 8, pp. 2488–2522,
2011.
[4] T. Mayo, “Data assimilation for parameter estimation i coastal ocean hydrody-
namics modeling.”
[5] A. B. Kennedy, U. Gravois, B. C. Zachry, J. J. Westerink, M. E. Hope, J. C.
Dietrich, M. D. Powell, A. T. Cox, R. A. Luettich, and R. G. Dean, “Origin of
the hurricane ike forerunner surge,” Geophysical Research Letters, vol. 38, no. 8,
2011.
[6] C. P. Jelesnianski, “Numerical computations of storm surges without bottom
stress,” Monthly Weather Review, vol. 94, no. 6, pp. 379–394, 1966.
[7] S. E. Kaipio J., “Statistical and computational inverse problems,” Applied Math-
ematical Sciences, vol. 160, no. ISBN 0-387-22073-9, p. 344, 2005.
[8] G. Robert, P. Casella, “Monte carlo statistical methods,” Applied Mathematical
Sciences, vol. 160, no. ISBN 0-387-22073-9, p. 344, 2004.

114
[9] R. Kalman, “a new approach to linear ﬁltering and prediction problems 1,”
Transactions of the ASMEJournal of Basic Engineering,, vol. 82, no. Series D.,
pp. 35–45, 1960.
[10] J. V. T. Sorensen and H. Madsen, “Parameter sensitivity of three kalman ﬁlter
schemes for assimilation of water levels in shelf sea models,” Ocean Modelling,
vol. 11, pp. 441–463, 2006.
[11] G. Y. H. E. Serafy and A. E. Mynett, “Improving the operational forecasting
system of the stratiﬁed ﬂow in osaka bay using an ensemble kalman ﬁlter-based
steady state kalman ﬁlter,” Water Resource Research, vol. 44, pp. W06 416,
doi:10.1029 2006WR005 412, 2008.
[12] A.W.Heemink and H. Kloosterhuis, “Data assimilation for non-linear tidal mod-
els,” International Journal of numerical methods in ﬂuids, vol. 11, pp. 1097–1112,
1990.
[13] T. Butler, M. U. Altaf, C. Dawson, I. Hoteit, X. Luo, and T. Mayo, “Data
assimilation within the advanced circulation (adcirc) modeling framework for
hurricane storm surge forecasting,” Monthly Weather Review, vol. 140, pp. 2215–
2231, 2012.
[14] A. Bennet, Inverse Methods in Physical Oceanography.
Cambridge University
Press, 1992.
[15] I. Hoteit, G. Triantafyllou, and G. Patihakis, “Eﬃcient data assimilation into a
complex 3d physical-biogeochemical model using a partially local kalman ﬁlter,”
Annales Geophysicae, vol. 23, pp. 1–15, 2005.
[16] P. M. Tagade and H.-L. Choia, “A generalized polynomial chaos-based method
for eﬃcient bayesian calibration of uncertain computational models,” Inverse
Problems in Science and Engineering, vol. 22, no. 4, pp. 602–624, 2014.
[17] N. Oreskes, K. Shrader-Frechett, and K. Belitz, “Veriﬁcation, validation and
conﬁrmation of numerical models in earth sciences, science,” Science, vol. 263,
pp. 641–647, 1994.

115
[18] U. Mehta, “Some aspects of uncertainty in computational ﬂuid dynamics re-
sults,” J. of Fluid Engg., vol. 113, pp. 538–543, 1991.
[19] S. Cheung, T. Oliver, E. Prudencio, S. Prudhomme, and R. Moser, “Bayesian
uncertainty analysis with applications to turbulence modeling,” Rel. Engg. and
Syst. Safety, vol. 96, pp. 1137–1149, 2011.
[20] M. Kennedy and A. OHagan, “Bayesian calibration of computer models,” J. of
the Royal Stat. Soc. Series B (Stat. Method.) 63 (2001), vol. 63, pp. 425–464,
2011.
[21] D. H. J. Besag, P. Green and K. Mengersen, “Bayesian computation and stochas-
tic systems,” Stat. Sci., vol. 10, pp. 3–41, Mon. 1995.
[22] D. Gamerman and H. Lopes, Markov Chain Monte Carlo: Stochastic Simulation
for Bayesian Inference.
Boca Raton: Chapman and Hall/CRC,, 2006.
[23] R. Ghanem and P. Spanos, : Stochastic Finite Elements: A Spectral Approach,
2nd ed.
New York: Dover, 2002.
[24] O. Matre and O. Knio, Spectral Methods for Uncertainty Quantiﬁcation with
Applications to Computational Fluid Dynamics.
Berlin: Springer, 2010.
[25] O. L. Matre, O. Knio, H. Najm, and R. Ghanem, “A stochastic projection
method for ﬂuid ﬂow. i. basic formulation,” Journal of Computational Physics,
vol. 173, pp. 481–511, 2001.
[26] O. L. Matre, H. Najm, P. Pbay, R. Ghanem, and O. Knio, “Multi-resolution-
analysis scheme for uncertainty quantiﬁcation in chemical systems,” SIAM Jour-
nal Scientiﬁc Computation, vol. 29, no. 2, pp. 864–889, 2007.
[27] H. Najm, B. Debusschere, Y. Marzouk, S. Widmer, and O. L. Matre, “Multi-
resolution-analysis scheme for uncertainty quantiﬁcation in chemical systems,”
International Journal of Numerical Methods in Engineering, vol. 80, no. 6, pp.
789–814, 2009.

116
[28] B. Phenix, J. Dinaro, M. Tatang, J. Tester, J. Howard, and G. McRae, “Incorpo-
ration of parametric uncertainty into complex kinetic mechanisms: application
to hydrogen oxidation in supercritical water,” Combustion and Flame, vol. 112,
pp. 132–146, 1998.
[29] M. Reagan, H. Najm, P. Pbay, O. Knio, and R. Ghanem, “Incorporation of
parametric uncertainty into complex kinetic mechanisms: application to hydro-
gen oxidation in supercritical water,” International Journal of Chemical Kinetics,
vol. 37, no. 6, pp. 368–382, 2005.
[30] W. Meecham and D. Jeng, “Use of the wiener-hermite expansion for nearly
normal turbulence,” J. of Fluid Mech., vol. 32, pp. 225–249, 1968.
[31] A. Chorin, “Gaussian ﬁelds and random ﬂow,” J. of Fluid Mech., vol. 85, pp.
325–347, 1974.
[32] R. Ghanem and J. Red-Horse, “Propagation of probabilistic uncertainty in com-
plex physical systems using a stochastic ﬁnite element approach,” Fluid Dyn.
Res., vol. 133, pp. 137–144, 1999.
[33] O. Knio and O. Maitre, “Uncertainty propagation in cfd using polynomial chaos
decomposition,” Physica D, vol. 38, pp. 616–640, 2006.
[34] D. Xiu and G. Karniadakis, “The weiner-askey polynomial chaos for stochastic
diﬀerential equations,” SIAM J. of Sci. Comp., vol. 24, pp. 619–644, 2002.
[35] ——, “Modeling uncertainty in ﬂow simulations via generalized polynomial
chaos,” J. of Comp. Phys., vol. 187, pp. 137–167, 2003.
[36] D. Xiu, Numerical methods for stochastic computation: A spectral approach.
New Jersey: Princeton University Press, 2010.
[37] N. Wiener, “The homogeneous chaos,” American Journal of Mathematics,
vol. 60, no. 4, pp. 897–936, 1938.
[38] R. Ghanem, Stochastic ﬁnite elements: a spectral approach.

117
[39] D. Pham, “Stochastic methods for sequential data assimilation in strongly non-
linear systems,” Monthly weather review, vol. 12, no. 5, pp. 1194–1207, 2001.
[40] J. B. I. Hoteit, D. Pham, “A simpliﬁed reduced order kalman ﬁltering and ap-
plication to altimetric data assimilation in tropical paciﬁc,” Journal of Marine
systems, vol. 36, no. 1, pp. 101–127, 2002.
[41] G. P. G. Triantafyllou, I. Hoteit, “A singular evolutive interpolated kalman ﬁlter
for eﬃcient data assimilation in a 3-d complex physicalbiogeochemical model of
the cretan sea,” Journal of Marine systems, vol. 40, pp. 213–231, 2003.
[42] A. Alexanderian, J. Winokur, I. Sraj, A. Srinivasan, M. Iskandarani, W. C.
Thacker, and O. M. Knios, “Global sensitivity analysis in an ocean general circu-
lation model: a sparse spectral projection approach,” Computational Geoscience,
vol. 16, pp. 757–778, 2012.
[43] R. Luettich and J. Westerink, Formulation and numerical implementation of the
2D/3D ADCIRC ﬁnite element model version 44. XX.
R. Luettich, 2004.
[44] C. B. N. S. J.J.Westerink, R.A. Luettich, “Adcirc:
an advanced three-
dimensional circulation model for shelves, coasts and estuaries. report 1: theory
and methodology of adcirc-2ddi and adcirc-3dl,” Technical Report DRP-92-6,
1992.
[45] C. Dawson and J. Proft, “Coupled discontinuous and continuous galerkin ﬁnite
element methods for the depth-integrated shallow water equations,,” Computer
Methods in Applied Mechanics and Engineering, vol. 193, no. 3, pp. 289–318,
2004.
[46] D. Hill, “Tidal modeling of glacier bay, alaska - methodology, results, and ap-
plications,” Department of Civil, Environmental Engineering, The Pennsylvania
State University, Tech. Rep., 2007.
[47] S. Bunya, J. Dietrich, J. Westerink, B. Ebersole, J. Smith, J. Atkinson, R. Jensen,
D. Resio, R. Luettich, C. Dawson, and et.al., “A high-resolution coupled river-
ine ﬂow, tide, wind, wind wave, and storm surge model for southern louisiana

118
and mississippi. part i: Model development and validation,” Monthly Weather
Review, vol. 138, no. 2, pp. 345–377, 2010.
[48] J. Dietrich, S. Bunya, J. Westerink, B. Ebersole, J. Smith, J. Atkinson, R. Jensen,
D. Resio, R. Luettich, C. Dawson, and et al., “A high-resolution coupled riverine
ﬂow, tide, wind, wind wave, and storm surge model for southern louisiana and
mississippi. part ii: Synoptic description and analysis of hurricanes katrina and
rita,” Monthly Weather Review, vol. 138, no. 2, pp. 378–404, 2010.
[49] J. J. Westerink, R. A. Luettich, J. C. Feyen, J. H. Atkinson, C. Dawson, H. J.
Roberts, M. D. Powell, J. P. Dunion, E. J. Kubatko, and H. Pourtaheri, “A
basin-to channel-scale unstructured grid hurricane storm surge model applied to
southern louisiana,” Monthly Weather Review, vol. 136, no. 3, pp. 833–864, 2008.
[50] J. J. W. Ethan J Kubatko and C. Dawson, “Discon- tinuous galerkin methods
for advection dominated problems in shallow water ow,” Computer Methods in
Applied Mechanics and Engineering, vol. 196(1), pp. 437–451, 2006.
[51] R. Berg, “Tropical cyclone report:
Hurricane ike (al092008),1-14 september
2008,” National Hurricane, Center,, 2009.
[52] P. T. Brummelhuis and A. Heemink, “Parameter identiﬁcation in tidal mod-
els with uncertain boundary conditions,” Stochastic Hydrology and Hydraulics,
vol. 4, no. 43, pp. 193–208, 1990.
[53] P. T. Brummelhuis, A. Heemink, and H. V. D. Boogaard, “Identiﬁcation of shal-
low sea models,” International journal for numerical methods in ﬂuids, vol. 17,
no. 8, pp. 637–665, 1993.
[54] S. Das and R. Lardner, “On the estimation of parameters of hydraulic models
by assimilation of periodic tidal data,” Journal of Geophysical Research: Oceans
(19782012), vol. 96, no. C8, pp. 15 187–15 196, 1991.
[55] A. W. Lal, “Calibration of riverbed roughness,” Journal of Hydraulic Engineer-
ing, vol. 121, no. 9, pp. 664–671, 1995.

119
[56] R. H. Khatibi, J. J. Williams, and P. R. Wormleaton, “Identiﬁcation problem of
open-channel friction parameters,” Journal of Hydraulic Engineering, vol. 123,
no. 12, pp. 1078–1088, 1997.
[57] G. A. Atanov, E. G. Evseeva, and E. A. Meselhe, “Estimation of roughness
proﬁle in trapezoidal open channels,” Journal of Hydraulic Engineering, vol. 8,
no. 1, pp. 135–154, 2005.
[58] R. Ramesh, B. Datta, S. M. Bhallamudi, and A. Narayana, “Optimal estimation
of roughness in open-channel ﬂows,” Journal of Hydraulic Engineering, vol. 126,
no. 4, pp. 299–303, 2000.
[59] A. Ishii and M. Kawahara, “Parameter identiﬁcation of manning roughness coef-
ﬁcient using analysis of hydrauric jump with sediment transport,” Proceeding of
the ﬁrst Asian-Paciﬁc Congress on Computational Mechanics, vol. 2, pp. 1071–
1076, 2006.
[60] I. Navon, “Practical and theoretical aspects of adjoint parameter estimation and
identiﬁability in meteorology and oceanography,” Dynamics of Atmospheres and
Oceans, vol. 27, no. 1, pp. 55–79, 1998.
[61] W. Budgell, “Stochastic ﬁltering of linear shallow water wave processes,” SIAM
journal on scientiﬁc and statistical computing, vol. 8, no. 2, pp. 152–170, 1987.
[62] M. Verlaan and A. Heemink, “Tidal ﬂow forecasting using reduced rank square
root ﬁlters,” Stochastic Hydrology and Hydraulics, vol. 11, no. 5, pp. 349–368,
1997.
[63] J. V. T. Srensen and H. Madsen, “Eﬃcient kalman ﬁlter techniques for the
assimilation of tide gauge data in three-dimensional modeling of the north sea
and baltic sea system,” Journal of Geophysical Research: Oceans (1978-2012),
vol. 109, no. C3, 2005.
[64] M. U. Altaf, T. Butter, X. Luo, C. Dawson, T., and I. Hotit, “Improving short-
range ensemble kalman storm surge forecasting using robust adaptive inﬂation,”
Monthly Weather Reviews, vol. 141, pp. 2705–2720, 2013.

120
[65] O.-P. Tossavainen, J. Percelay, A. Tinka, Q. Wu, and fAlexandre M Bayen,
“Eﬃcient kalman ﬁlter techniques for the assimilation of tide gauge data in
three-dimensional modeling of the north sea and baltic sea system,” In Decision
and Control, 2008. CDC 2008. 47th IEEE Conference on, pp. 1783–1790, 2008.
[66] G. Evensen, Data assimilation: the ensemble Kalman ﬁlter.
Verlag: Springer,
2009.
[67] ——, “The ensemble kalman ﬁlter: Theoretical formulation and practical imple-
mentation,” Ocean dynamics, vol. 53, no. 4, pp. 343–367, 2013.
[68] A. Gelb, Applied Optimal Estimation.
MIT Press, 1974.
[69] G. Evensen, “Eﬃcient kalman ﬁlter techniques for the assimilation of tide gauge
data in three-dimensional modeling of the north sea and baltic sea system,”
Journal of Geophysical Research: Oceans (19782012), vol. 99, no. C5, pp. 10 143–
10 162, 1994.
[70] L. Nerger, T. Janjic, J. Schroter, and W. Hiller, “A uniﬁcation of ensemble square
root kalman ﬁlters,” Monthly Weather Review, vol. 140, no. 7, pp. 2335–2345,
2012.
[71] C. H. B. T. M. H. J. S. W. M.K. Tippett, J. L. Anderson, “Ensemble square
root ﬁlter*,” Monthly Weather Review.
[72] J. Anderson, “An ensemble adjustment kalman ﬁlter for data assimilation,”
Monthly weather review, vol. 129, no. 12, pp. 2884–2903, 2001.
[73] A. Aksoy, F. Zhang, and J. Nielsen-Gammon, “Ensemble-based simultaneous
state and parameter estimation in a two-dimensional sea-breeze model,” Monthly
weather review, vol. 134, no. 10, pp. 2951–2970, 2006.
[74] J. Annan, J. Hargreaves, N. Edwards, and R. Marsh, “Parameter estimation
in an intermediate complexity earth system model using an ensemble kalman
ﬁlter.” Ocean Modelling, vol. 8, no. 1, pp. 135–154, 2005.

121
[75] H. H. Franssen and W. Kinzelbach, “Real-time groundwater ﬂow modeling with
the ensemble kalman ﬁlter: Joint estimation of states and parameters and the
ﬁlter inbreeding problem,” Water Resources Research, vol. 44, no. 9, 2008.
[76] X. Luo and I. Hoteit, “Robust ensemble ﬁltering and its relation to covariance
inﬂation in the ensemble kalman ﬁlter,” Monthly Weather Reviews, vol. 139, p.
39383953, 2011.
[77] R. Madankan, “Polynomial chaos based method for state and parameter estima-
tion.”
[78] A. Doucet, N. de Freitas, and N. Gordon, Sequential Monte-Carlo Methods in
Practice.
Springer-Verlag, 2001.
[79] R. N. Iyengar and P. K. Dash, “Study of the random vibration of nonlinear sys-
tems by the gaussian closure technique,” Journal of Applied Mechanics, vol. 45,
pp. 393–399, 1978.
[80] J. B. Roberts and P. D. Spanos, Random Vibration and Statistical Linearization.
Wiley, 1990.
[81] T. Lefebvre, H. Bruyninckx, and J. Schutter, “Comment on a new method for the
nonlinear transformations of means and covariances in ﬁlters and estimators,”
IEEE Transactions on Automatic Control, vol. 48, no. 8, 2002.
[82] ——, “Kalman ﬁlters of non-linear systems: A comparison of performance,”
International journal of Control, vol. 77, no. 7, pp. 639–653, 2004.
[83] K. Dalbey, A. K. Patra, E. B. Pitman, M. I. Bursik, and M. Sheridan, “Input un-
certainty propagation methods and hazard mapping of geophysical mass ﬂows,”
Journal of Geophysical Research, vol. 113, pp. 1–16, 2008.
[84] C. W. Clenshaw and A. R. Curtis, “A method for numerical integration on an
automatic computer,” NUMERISCHE MATHEMATIK, vol. 2, no. 1, pp. 197–
205, 1960.

122
[85] E. Cheney and D. Kincaid, Numerical mathematics and computing, 5th ed. CA:
Brooks/Cole, Paciﬁc Grove, 1999.
[86] M. Berveiller, B. Sudret, and M. Lemaire, “Stochastic ﬁnite element: a non in-
trusive approach by regression,” Europian Journal of Computational Mechanics,
vol. 15, pp. 81–2, 2006.
[87] I. Babuka, F. Nobile, and R. Tempone, “A stochastic collocation method for
elliptic partial diﬀerential equations with random input data,” SIAM Journal of
Numerical Analysis, vol. 45, no. 3, pp. 1005–1034, 2007.
[88] L. Mathelin and M. Hussaini, “A stochastic collocation algorithm for uncertainty
analysis.”
[89] D. Xiu and J. Hesthaven, “High-order collocation methods for diﬀerential equa-
tions with random inputs,” SIAM Journal of Scientiﬁc Computation, vol. 27,
no. 3, pp. 1118–1139, 2005.
[90] S. Smolyak, “Quadrature and interpolation formulas for tensor products of cer-
tain classes of functions,” Doklady Akademii Nauk SSSR, vol. 4, pp. 240–243,
1963.
[91] T. Gerstner and M. Griebel, “Numerical integration using sparse grids,” Numer-
ical Algorithms, vol. 18, pp. 209–232, 1998.
[92] K. Petras, “On the smolyak cubature error for analytic functions,” Advances in
Computational Mathematics, vol. 12, pp. 71–93, 2000.
[93] ——, “Fast calculation in the smolyak algorithm,” Numerical Algorithms, vol. 26,
pp. 93–109, 2001.
[94] ——, “Smolyak cubature of given polynomial degree with few nodes for increas-
ing dimension.” Numerical Mathematics, vol. 93, no. 4, pp. 729–753, 2003.

