arXiv:2306.13739v1  [quant-ph]  23 Jun 2023
Going Beyond Gadgets: The Importance of Scalability for Analogue
Quantum Simulators
Dylan Harley1, Ishaun Datta2, Frederik Ravn Klausen1, Andreas Bluhm1,3, Daniel Stilck
França1,4, Albert Werner1, and Matthias Christandl1
1Department of Mathematical Sciences, University of Copenhagen, Universitetsparken 5, 2100
Copenhagen, Denmark
2Stanford University, 450 Serra Mall, Stanford, CA 94305, USA
4Univ Lyon, ENS Lyon, UCBL, CNRS, Inria, LIP, F-69342, Lyon Cedex 07, France
3Univ. Grenoble Alpes, CNRS, Grenoble INP, LIG, 38000 Grenoble, France
June 27, 2023
Abstract
We propose a theoretical framework for analogue quantum simulation to capture the full
scope of experimentally realisable simulators, motivated by a set of fundamental crite-
ria ﬁrst introduced by Cirac and Zoller. Our framework is consistent with Hamiltonian
encodings used in complexity theory, is stable under noise, and encompasses a range of
possibilities for experiment, such as the simulation of open quantum systems and over-
head reduction using Lieb-Robinson bounds. We discuss the requirement of scalability
in analogue quantum simulation, and in particular argue that simulation should not in-
volve interaction strengths that grow with the size of the system. We develop a general
framework for gadgets used in Hamiltonian complexity theory, which may be of interest
independently of analogue simulation, and in particular prove that size-dependent scal-
ings are unavoidable in Hamiltonian locality reduction. However, if one allows for the
additional resource of intermediate measurements, we demonstrate a scheme that circum-
vents the locality reduction no-go theorem using the quantum Zeno eﬀect. Our gadget
framework opens the door to formalise and resolve long-standing open questions about
gadgets. We conclude with a discussion on universality results in analogue quantum sim-
ulation.
1

Contents
1
Introduction
4
1.1
Background . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
4
1.2
Overview and motivation for work
. . . . . . . . . . . . . . . . . . . . . . . . . . .
4
1.3
Criteria for quantum computation and analogue quantum simulation . . . . . . . .
5
1.4
Existing theoretical work . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
6
2
Framework
8
2.1
Deﬁnition . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
8
2.2
Justiﬁcation and applications
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
10
3
Modular encodings and gadgets
14
3.1
Overview
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
14
3.2
A general deﬁnition for gadgets . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
14
3.3
Energy scaling is inevitable for gadgets . . . . . . . . . . . . . . . . . . . . . . . . .
16
3.4
Gadgets from the quantum Zeno eﬀect . . . . . . . . . . . . . . . . . . . . . . . . .
17
3.5
Outlook on universality for analogue quantum simulators . . . . . . . . . . . . . . .
20
4
Conclusion
21
References
22
A General gadgets
25
A.1 Existing constructions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
25
A.2 “Exact” 3-to-2 gadget . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
27
A.3 Combining gadgets . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
28
B Proofs
30
B.1
Qutrit-to-qubit energy scaling . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
30
B.2
Gadget characterisation
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
32
B.2.1
The gadget property from gadgets
. . . . . . . . . . . . . . . . . . . . . . .
33
B.2.2
Gadgets from the gadget property
. . . . . . . . . . . . . . . . . . . . . . .
33
B.3
Gadget energy scaling
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
39
B.4
Gadget combination
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
40
B.4.1
Combination of general gadgets . . . . . . . . . . . . . . . . . . . . . . . . .
40
2

B.4.2
Combination of low-energy gadgets . . . . . . . . . . . . . . . . . . . . . . .
43
B.4.3
Ground-state estimation with bounded-strength low-energy gadgets . . . . .
46
B.5
Measurement gadgets . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
48
B.5.1
Measurement gadgets in isolation . . . . . . . . . . . . . . . . . . . . . . . .
48
B.5.2
Trotter errors . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
49
B.5.3
Measurement gadgets with other terms . . . . . . . . . . . . . . . . . . . . .
50
3

1
Introduction
1.1
Background
In the decades since Feynman’s famous 1981 talk “Simulating physics with computers” that formu-
lated and popularised the idea of what we now call a quantum simulator [Fey82], there has been a
proliferation of increasingly sophisticated quantum devices (see for example [GAN14, ALGTS+19]
for reviews). The simulation of quantum systems remains a particularly promising application of
quantum technologies owing to its classical intractability and the possibilities of attaining quantum
advantage on near-term hardware, both digital [CMN+18] and analogue [TRC22].
The generic problem of quantum simulation is as follows: one is given a state ρ, a Hamiltonian H,
and an observable O. The task is to determine how the measured values of O change as ρ evolves
under H.
From here there are two main approaches: digital and analogue. A digital quantum simulator uses
discrete time steps to calculate the evolution of a system under the Hamiltonian H through a series
of quantum gates [Llo96]. This method provides the greatest control and ﬂexibility for quantum
simulation problems, and over recent decades there has been extensive development of algorithms
for this task [BCK15, BCC+15, LC17, LC19], and in particular optimisations for applications
to quantum chemistry [HWBT15, BBMC20]. Despite this, and experimental progress [LHN+11,
BLK+15, HMR+18, NCP+20], useful and scalable digital simulations still lie out of reach for NISQ
technology [Pre18] that lacks fault-tolerance.
By contrast, an analogue quantum simulator encodes the Hamiltonian H into a better-controlled
laboratory Hamiltonian H′, such that the dynamics of the H′ system reveal properties of the dy-
namics of H. Instead of a sequence of quantum gates, the simulation in this regime takes place
through the natural time evolution of the laboratory system. The aim of analogue quantum simu-
lation is not to precisely calculate the time-evolved state, but instead to provide qualitative insight
into the time evolution of observables in the system. Such simulators do not require individual
qubit control, which constitutes a major advantage for near-term hardware, on which individual
gates incur a signiﬁcant noise penalty. On the other hand, this approach suﬀers the disadvantage
of poor ﬂexibility: the laboratory system may only be capable of implementing a relatively small
family of Hamiltonians. Nevertheless, experimental setups can be tailored for a variety of tasks,
from spin systems [JZ05, GTHC+15, PCK+21] to quantum chemistry [ALGTS+19, MC23].
Presently, there exist hundreds of analogue quantum simulators realised on a diversity of exper-
imental platforms [GB17, MW21, NA16], some of which have already demonstrated hundreds of
interacting sites [EWL+21], pushing them beyond the frontier of classical simulability [ABC+21].
For some analogue simulators, this already constitutes a kind of quantum advantage over any
available classical computers [DBK+22].
1.2
Overview and motivation for work
Unlike the digital case, analogue quantum simulation is relatively under-explored from the theoret-
ical perspective (notable exceptions include [CMP18, AZ18, ZA21], which we address in this work).
Despite extensive study of Hamiltonian complexity theory (see Section 1.4), abstract complexity-
theoretic results generally do not reﬂect experimental possibilities for analogue quantum simulators.
In particular, constructions for universal Hamiltonian simulators [CMP18] often require high-degree
polynomial, or even exponential, scalings for interaction strengths with respect to the system size.
In Section 1.3 we discuss the Cirac-Zoller criteria [CZ12] for analogue quantum simulators and
the necessity for an additional size-independence requirement, for which we provide a candidate
4

deﬁnition. In Section 1.4 we review existing theoretical work and combine the conclusions of these
sections to motivate a new deﬁnition for analogue quantum simulation in Section 2. In Section 2.2
we verify that our deﬁnition is suitable for noisy simulators, is in a sense consistent with the notion
of simulation deﬁned in [CMP18], and demonstrate applications which are not captured by the
latter.
In Section 3, we generalise gadget constructions used extensively in Hamiltonian complexity theory
[KKR06, OT08, BH17]. Armed with a general deﬁnition, we argue that gadget locality reduction
techniques necessarily require scaling interaction strengths with the system size. This has signiﬁcant
consequences for the applicability of universal simulation results to experimental systems, which
we discuss in Section 3.5.
1.3
Criteria for quantum computation and analogue quantum simulation
In a review of the prospective possibilities of quantum computing [DiV00] the author provided a
set of requirements, now known as the DiVincenzo criteria, designed to serve as a full speciﬁcation
for implementations of universal quantum computers. These are summarised in Fig. 1.
The DiVincenzo criteria for quantum
computation [DiV00]
The Cirac-Zoller criteria for quantum
simulation [CZ12]
(A) A scalable physical system with well-
characterised qubits.
(B) The ability to initialise the state of the
qubits to a simple ﬁducial state, such as
|000 . . .⟩.
(C) Long relevant decoherence times, much
longer than the gate operation time.
(D) A “universal” set of quantum gates.
(E) A qubit-speciﬁc measurement capabil-
ity.
(I) A system of bosons/fermions conﬁned in
a region of space, containing a large number
of degrees of freedom.
(II) The ability to approximately prepare a
known quantum state — ideally pure.
(III) The ability to engineer and adjust the
values of a set of interactions between the
particles, and possibly external ﬁelds or a
reservoir.
(IV) The capability to measure the system,
either on speciﬁc sites or collectively.
(V) A procedure for increasing conﬁdence in
the results of the simulation.
Figure 1: A summary of the DiVincenzo and Cirac-Zoller criteria.
As well as concretely providing the experimentalist with a necessary set of criteria to aim towards,
the suﬃciency of the DiVincenzo criteria provides the theorist with a canonical yardstick to judge
the applicability of their protocol to idealised quantum hardware. It is therefore important that
such requirements reﬂect exactly what can be expected from quantum technology in the long term,
neither excluding feasible technologies nor including unfeasible procedures.
A similar set of criteria for analogue quantum simulators is discussed in [CZ12], also summarised
in Fig. 1. These are all natural requirements to ask of a quantum simulator, but it is noteworthy
that (III) does not provide any restriction on the interactions that one should expect the simulator
to include. This leads to a problem which does not arise for the DiVincenzo criteria: whereas
a quantum computer can approximate arbitrary k-qubit gates from the compact set U((C2)k) of
5

unitary transformations relatively cheaply due to the Solovay-Kitaev theorem [Kit97], the task of
an analogue quantum simulator is to implement k-qudit interactions from the unbounded set of
possible Hamiltonians Herm((Cd)⊗k). The ability to realise arbitrarily strong interactions on a
physical device is clearly an impossibility.
Thus, the key extra criterion which we demand of an analogue quantum simulator is that the
encoding of the target Hamiltonian should be size-independent. Concretely, if the Hamiltonian
H to be encoded consists of local interactions (hi)m
i=1 on n sites then the encoding of individual
terms should not depend, for instance by polynomial scaling of interaction strengths, on the size
of the physical system n. In particular, we argue that methods for practical analogue quantum
simulation must respect a limit on the interaction strengths of the simulator Hamiltonian. The
strongest interactions should be bounded by some constant ﬁxed by physical limitations, and the
weakest interactions should be similarly bounded from below (since suﬃciently weak interactions
will be overwhelmed by noise in the simulator). We summarise this requirement with the following
qualitative deﬁnition:
Deﬁnition 1 (Size-independent simulation). We say that an analogue quantum simulation is size-
independent if the simulation of a n-site Hamiltonian can be implemented scalably with n. By this,
we mean that the number of qubits used in the simulation should grow no faster than linearly in n,
and the interaction strengths necessary should remain Θ(1).1
In addition to the physical limits of a simulator, there is philosophical motivation to be suspicious
of analogue quantum simulation procedures which require interaction strengths that scale with the
system size. A many-body Hamiltonian is inherently a modular object, and an analogue quantum
simulation should reﬂect this. The addition of a few qubits and local interactions to one end of the
physical system should require an analogous action on the simulator — it should not require the
adjustment of every other interaction in the system. Compare this to a civil engineer “simulating”
their bridge design by building a model: if the density of the bricks they use to build the model
must, for some reason, scale polynomially with the length of their bridge, then their modelling
procedure is clearly ﬂawed and inevitably limited in its capabilities. This is not what analogue
simulation, classical or quantum, should look like.
Moreover, encoding interactions independently has quantitative beneﬁts; as noted in [CMP18], for
a suitably “local” Hamiltonian encoding, local errors on the simulator system will correspond to
local errors on the target system. For NISQ hardware, this represents an extremely useful way to
mitigate the negative eﬀects of a noisy simulation: rather than random scrambling, noise can be
viewed as the manifestation of physically reasonable noisy eﬀects on the target system.
Finally, studying the power of Hamiltonians subject to interaction energies that are constant in
system size is well-motivated in its own right, from the perspective of Hamiltonian complexity. For
example, [AZ18] show that restriction to such Hamiltonians will necessarily sacriﬁce some sense of
universality of the simulator. Earlier results in Hamiltonian complexity theory [BDLT08], however,
show that in many cases it is still possible to simulate ground state energies up to an extensive
error.
1.4
Existing theoretical work
Much of the existing theoretical work on analogue quantum simulation has been motivated by the
complexity of the local Hamiltonian problem [KSV02]. We say that a Hamiltonian H on the space
1It is worth noting that further formalisation is required to make this deﬁnition robust. For example, suppose we
are given a Hamiltonian H = h1 + h2 where ∥h1∥, ∥h2∥= O(n−1), which violates the size-independence requirement.
One could simply deﬁne h′
1 = h1 + K, h′
2 = h2 −K, for some K = Θ(1), and then H = h′
1 + h′
2 can be written in
a form which does not obviously violate Deﬁnition 1. To exclude such possibilities, we could impose an additional
requirement that H is given in a canonical form, such as that described by [WW22].
6

of n qubits H = (C2)⊗n is k-local if it can be written as H = PN
j=1 hj, where each of the terms hj
acts on at most k of the qubit sites. We consider the hj individual interactions in the Hamiltonian
and make reference to the interaction hypergraph, whose vertices are qubits and whose (hyper)edges
are interactions (joining the qubits on which they act), illustrated in Fig. 2.
1
2
3
4
H = A123 ⊗I4 + I12 ⊗B34
Figure 2: A Hamiltonian H on 4 qubits, and its associated interaction hypergraph. The Hamiltonian
consists of a 3-local and a 2-local term, so we say that H is 3-local.
Informally, the k-local Hamiltonian problem asks whether the ground state energy of a k-local
Hamiltonian is less than a, or greater than b, for some real numbers a < b separated by a suitably
large gap. This problem lies in the QMA complexity class: the natural quantum analogue to the
classical NP, containing problems whose solutions can be eﬃciently veriﬁed (but not necessarily
found) on a quantum computer.
Deﬁnition 2 (k-local Hamiltonian problem). The k-local Hamiltonian problem is the promise
problem which takes as its input a k-local Hamiltonian H = PN
j=1 hj on the space of n qubits
H = (C2)⊗n, where N = poly(n), and for each j we have ∥hj∥⩽poly(n) and hj is speciﬁed by
O(poly(n)) bits.
Given a < b with b−a > 1/ poly(n), let λ0(H) denote the lowest eigenvalue of H. Then the output
should distinguish between the cases
• Output 0: The ground state energy of H has λ0(H) ⩽a.
• Output 1: The ground state energy of H has λ0(H) ⩾b.
Through the Feynman-Kitaev circuit-to-Hamiltonian construction [KSV02], it was established that
the 5-local Hamiltonian problem is QMA-complete, and subsequent works optimising the con-
struction [KR03] and using gadget techniques [KKR06] reduced this further to show the QMA-
completeness of the 2-local Hamiltonian problem. Various further optimisations have been found
to reﬁne the problem and further restrict the family of allowed Hamiltonians (see for example
[HNN13, CM16]); indeed hardness results have been shown to hold even under the signiﬁcant re-
striction to 1-dimensional translationally invariant systems [GI09]. QMA-completeness is closely
related to a notion of universality for simulators; an equivalence was proved in [KPBC22].
The constructions involved in the aforementioned results contain Hamiltonian interaction strengths
which scale polynomially, or exponentially, with system size. Such Hamiltonians are infeasible for an
analogue simulator, as discussed in Section 1.3. A notable exception to this is [BDLT08], in which
the authors use the Schrieﬀer-Wolﬀtransformation to show that bounded-strength interactions
are suﬃcient for one to reproduce the ground-state energy of the original Hamiltonian up to an
extensive error.
As much of this Hamiltonian simulation literature focuses on speciﬁc complexity-theoretic prob-
lems, comparatively little work has been done to actually deﬁne a mathematical framework for
analogue quantum simulation to be used in experiment.
Notable recent work in this direction
includes [CMP18], in which the authors study methods of encoding Hamiltonians via a map
Eobs : Herm(H) →Herm(H′), which satisfy the natural requirement of preserving the spectrum of
7

observables. Additionally, in the case that H = ⊗n
i=1Hi is a space of many sites, they introduce
the further notion of local encodings, which map local observables in H to local observables in
H′ = ⊗n′
i=1H′
i. The authors arrive at the following deﬁnition.
Deﬁnition 3 (Local Hamiltonian encoding [CMP18]). A local Hamiltonian encoding is a map
Eobs : Lin(⊗n
i=1Hi) →Lin(⊗n
i=1H′
i) of the form
Eobs(M) = V (M ⊗P + ¯
M ⊗Q)V † ,
where P and Q are locally distinguishable2 orthogonal projectors on an ancillary space A = ⊗n
i=1Ai,
and V = ⊗n
i=1Vi where Vi ∈Isom(Hi ⊗Ai, H′
i) for all i.
Generally, we consider the case of rank(P) > 0 (referred to as standard in [CMP18]), for which one
can deﬁne a corresponding state encoding
Estate(ρ) = V (ρ ⊗τ)V † ,
(1)
where τ is a state on A satisfying Pτ = τ.
Moreover, the authors deﬁne the following notion of simulation, which relaxes the requirements of
locality and allows for some error in the simulated eigenvalues.
Deﬁnition 4 ((∆, η, ε)-simulation [CMP18]). A Hamiltonian H′ ∈Herm(H′) = Herm(⊗n
i=1H′
i)
is said to (∆, η, ε)-simulate a Hamiltonian H ∈Herm(H) = Herm(⊗n
i=1Hi) if there exists a local
encoding (Deﬁnition 3) Eobs(M) = V (M ⊗P + ¯
M ⊗Q)V † such that
(i) There exists an encoding ˜Eobs(M) = ˜V (M ⊗P + ¯
M ⊗Q) ˜V † (where ˜V ∈Isom(H ⊗A, H′)
need not have a tensor product structure as in Deﬁnition 3) such that ∥V −˜V ∥⩽η and
˜Eobs(I) = P⩽∆(H′) is the projection onto the low-energy (⩽∆) subspace of H′, and
(ii) ∥P⩽∆(H′)H′P⩽∆(H′) −˜Eobs(H)∥⩽ε.
This approach (later generalised in [AC22]) provides an elegant framework to capture a notion of
one Hamiltonian fully simulating another. However, we believe that this regime does not capture
the scope of possibilities for analogue quantum simulation experiments. On one hand, the formalism
requires the entire physics of the target system to be encoded into the low-energy subspace of a
simulator — this rules out simulators which only simulate part of the target system, or in a diﬀerent
subspace. On the other hand, the formalism is too broad in the sense that it does not prohibit
unrealistically scaling interaction strengths in violation of Deﬁnition 1.
2
Framework
2.1
Deﬁnition
The generic task of an analogue quantum simulator is to estimate the dynamics of observables in
a system H under the evolution of a target Hamiltonian H, up to some maximum time tmax. In
particular, it is not always necessary to simulate the entire target system in arbitrary conﬁgurations:
it may be convenient to restrict to a particular subset of initial states Ωstate, for example lying in
a subspace invariant under the Hamiltonian or corresponding to the states which can be reliably
prepared by the simulator, and similarly to a particular subset of observables of interest Ωobs. We
2Projectors P, Q ∈Proj(⊗iAi) are locally distinguishable if, for all i, there exist orthogonal projectors Pi, Qi ∈
Proj(Ai) such that (Pi ⊗I)P = P and (Qi ⊗I)Q = Q.
8

Target system H
Simulator H′
State preparation
Time evolution
Measurement
ρ
Estate(ρ) = ρ′
ρ(t) = e−iHtρeiHt
ρ′(t) = Tt(ρ′)
ρ(t) 7→tr[Oρ(t)]
ρ′(t) 7→tr[O′ρ′(t)]
O 7→Eobs(O) = O′
ρ 7→Estate(ρ) = ρ′
tr[Oρ(t)] ≈tr[O′ρ′(t)]
Figure 3: The general procedure of analogue quantum simulation as described by Deﬁnition 5.
denote by H′ the Hilbert space corresponding to the simulator system, and for t ∈[0, tmax] we
write Tt : D(H′) →D(H′) for the family of time evolution quantum channels implemented by
the simulator, where D(H′) is the set of density matrices on H′.
This approach, in which we
view simulations in terms of individual observables rather than the entire Hamiltonian, has been
considered in earlier work [KS17, BCSF21, TRC22].
The minimal requirement for a simulator is that it should approximate the expectation values of
the elements of Ωobs. That is, tr[Oe−iHtρeiHt] should be close to tr[O′Tt(ρ′)] for all ρ ∈Ωstate
and O ∈Ωobs, where ρ′ and O′ are some encoded versions of the states and operators respectively.
Notice that, in principle, the experimentalist could be using a completely diﬀerent simulator for
each choice of ρ and O, with H′ a space large enough to contain all of them and by encoding ρ
into several copies. However, this would violate the size-independence requirement of Deﬁnition 1
if Ωobs and Ωstate both do not only contain O(1) elements. Furthermore, it is natural to consider
analogue quantum simulators as machines taking quantum, rather than classical, input — possibly
prepared by another experiment — which cannot be cloned. For this reason, we assume that the
state encoding takes the form of a quantum channel Estate : D(H) →D(H′). Correspondingly, to
accommodate for quantum outputs, we require the observable encoding O 7→O′ to be a unital and
completely positive map Eobs : Herm(H) →Herm(H′). This perspective sets analogue quantum
simulators apart from the framework of digital quantum computation, for which fault-tolerant
architectures require both inputs and outputs to be classical.
This deﬁnition is still suﬃciently versatile to capture the simulation of global observables that are
a sum of local parts O = P
k Ok (a task, for example, useful for variational quantum algorithms
[CAB+21]), in the following way. Often the Ok cannot be simultaneously measured due to non-
commutativity relations or experimental limitations. The simplest approach to estimating O is to
run many simulations, measuring one of the Ok each time (this process can be sped up by combining
simultaneously measurable terms [MRBAG16]), and summing the average results.
The above discussion leads us to the following deﬁnition, which is illustrated by Fig. 3.
Deﬁnition 5 (Analogue quantum simulation). Given a set of states Ωstate on a Hilbert space H, a
normalised set of observables Ωobs (i.e. ∥O∥= 1 for all O ∈Ωobs, where ∥· ∥denotes the operator
norm), a time tmax > 0, a Hamiltonian H ∈Herm(H), and ε > 0, we say that a family of quantum
channels Tt : D(H) →D(H), for t ∈[0, tmax] simulates H with respect to Ωstate and Ωobs with
accuracy ε if there exists
1. A state encoding quantum channel Estate : D(H) →D(H′) which maps states to the simulator
Hilbert space H′,
9

2. An observable encoding, given by a unital and completely positive map Eobs : Herm(H) →
Herm(H′),
such that
 tr[Eobs(O)(Tt ◦Estate)(ρ)] −tr[O(e−itHρeitH)]]
 ⩽ε ,
(2)
for all ρ ∈Ωstate, O ∈Ωobs, and t ∈[0, tmax].
Our use of a Hamiltonian H for the target system is mostly for simplicity; the simulation of more
general dynamics, of open quantum systems for example, can be deﬁned analogously, with the target
Hamiltonian H replaced by any generator of a quantum dynamical semigroup [GKS76, Lin76]. It
should be noted also that Deﬁnition 5 could equivalently have been phrased in terms of a set of
POVMs rather than observables Ωobs. We use the latter for convenience in relating our work to
other results.
By the triangle inequality, (2) holds for any convex combination of the states and observables in
Ωstate and Ωobs respectively, so we could without loss of generality assume that the two sets are
convex to begin with.
Often the simulation channels Tt in Deﬁnition 5 are taken simply as time evolution under some
simulator Hamiltonian H′ ∈Herm(H′), but it is useful to consider a more general case. Firstly, this
allows one to directly account for, and possibly exploit, dissipative errors in the experimental setup
[VWC09]. Secondly, it enables the possibility of a more complicated simulation experiment, for
example involving intermediate measurements. Moreover, it is important to allow the simulation of
open quantum systems for our deﬁnition to be consistent with (III). Despite the generality aﬀorded
by Deﬁnition 5, we emphasise that experimentally practical simulations should be size-independent
as in Deﬁnition 1. That is, the implementation of Tt should not require engineering a system of
size which grows more than linearly in n, or boundlessly scaling interaction energies.
2.2
Justiﬁcation and applications
In this section, we discuss some basic applications of our notion of analogue quantum simulation
in the sense we have introduced in Deﬁnition 5.
Firstly, we give an example of a trivial but
illustrative situation in which encoding qudits into qubits incurs an unavoidable cost for low-energy
encodings, but which is not an issue in our framework. We then demonstrate the robustness of the
deﬁnition under noise, and show that it is consistent with the existing notion of simulation given
in Deﬁnition 4. Finally, we note how Lieb-Robinson bounds can be used to reduce the overhead of
simulating local observables.
Qudits to qubits
To motivate this example, we ﬁrst notice that the requirement in [CMP18] (Deﬁnition 4) that
the simulator Hamiltonian should reproduce the target dynamics in its low-energy subspace is too
strong for some practical situations. As observed by the authors, this can require the simulator to
use strong interactions to “push” unwanted states out of the low-energy subspace. Proposition 6
provides a formal proof of this fact in the context of encoding a simple qutrit Hamiltonian into
qubits.
Here we consider qutrits with individual state spaces C3 spanned by a basis {|↓⟩, |0⟩, |↑⟩}. We
write P (j)
0
= |0⟩⟨0| and P (j)
↑
= |↑⟩⟨↑|, where the superscript indicates that the projectors act on the
jth qutrit.
10

Energy
1
0
Energy
1
0
∆
H1
H2
...
Hn
H′
1
H′
2
...
H′
n
(∆, η, ε)
sim.
Figure 4: (Left) The original non-interacting qutrits have on-site energy levels 0,1,1. (Right) The
(∆, η, ε)-simulation, in this case sending each qutrit into two qubits, leads to approximately the
same on-site energy levels, but the extra state must be given an energy above ∆. (This illustration
is a simpliﬁcation; in principle the simulator sites H′
i can interact.)
Proposition 6. Let H = (C3)⊗n be the space of n qutrits acted on by the Hamiltonian
Hn =
n
X
j=1
(P (j)
0
+ P (j)
↑) .
Suppose H′
n = PK
j=1 h′
j is a k-local Hamiltonian on H′ = (C2)⊗m, where m = O(n1+α), for
α ∈[0, 1] and k = O(1). Assume the interaction hypergraph of H′
n has degree bounded by d = O(1).
If H′
n is a (∆, η, ε)-simulation for Hn in the sense of Deﬁnition 4, for η ∈[0, 1) and ε ⩾0, then
max
j
∥h′
j∥= Ω(n1−α(1 −η2)) .
(3)
(Proof in Appendix B.1)
From (3) we see that simulating this simple system with a low-energy encoding, an interaction
hypergraph of bounded degree, and bounded locality, requires either the qubit count or interaction
energy (or a mixture) to scale unfeasibly with n: a violation of the requirements of Deﬁnition 1. The
proof of this fact follows from a dimension-counting argument, since the state space of the qutrits
cannot be surjectively encoded into the qubit simulator, see Fig. 4. In contrast, the simulation task
is trivial in our framework given in Deﬁnition 5 because the low-energy encoding requirement is
relaxed.
Letting Hn = Pn
j=1(P (j)
0
+ P (j)
↑) as in Proposition 6, we can simulate all observables under Hn on
H′ = ⊗n
j=1(C2 ⊗C2) via any isometry
V : C3 →C2 ⊗C2 ,
encoding each qutrit into two qubits. To realise a simulator in the sense of Deﬁnition 5, we let
Estate : ρ 7→V ⊗nρ(V ⊗n)† ,
Eobs : O 7→V ⊗nO(V ⊗n)† ,
and
Tt = e−itEobs(Hn)(·)eitEobs(Hn) ,
which is just time evolution under a 2-local Hamiltonian with bounded strength interactions.
11

Noisy analogue simulators
Suppose we have quantum channels Tt, for t ∈[0, tmax] which simulate some H ∈Herm(H) with
respect to Ωstate and Ωobs up to accuracy ε as in Deﬁnition 5, corresponding to encoding maps
Estate and Eobs.
In practice, the experimental setup will suﬀer from noise in the steps of state preparation, evolution,
and measurement. This will correspond to noisy versions of the above maps, which we denote by
˜Tt, ˜Estate, and ˜Eobs. For any O ∈Ωobs, ρ ∈Ωstate, we may bound the additional error in observable
expectation values incurred by the noisy maps by
| tr[Eobs(O)(Tt ◦Estate)(ρ)] −tr[ ˜Eobs(O)( ˜Tt ◦˜Estate(ρ)]|
= | tr[O
 E∗
obs ◦Tt ◦Estate −˜E∗
obs ◦˜Tt ◦˜Estate

(ρ)]
⩽∥E∗
obs ◦Tt ◦Estate −˜E∗
obs ◦˜Tt ◦˜Estate∥1→1
⩽∥E∗
obs −˜E∗
obs∥1→1 + ∥Tt −˜Tt∥1→1 + ∥Estate −˜Estate∥1→1 ,
where ∥· ∥1→1 denotes the one-to-one norm ∥Λ∥1→1 = supρ ∥Λ(ρ)∥1 (deﬁned as the induced trace
norm in [Wat18], for example — note that this is in particular upper bounded by the diamond
norm). Hence the noisy simulator ˜Tt also simulates H with respect to Ωstate and Ωobs, up to error
ε′ ⩽ε + sup
t
∥Tt −˜Tt∥1→1 + ∥Estate −˜Estate∥1→1 + ∥E∗
obs −˜E∗
obs∥1→1 .
Local Hamiltonian simulation in a subspace
Suppose that H′ is a (∆, η, ε)-simulation of H as deﬁned by [CMP18] (Deﬁnition 4), corresponding
to encodings Estate and Eobs, with the projector Q = 0. Here we show that the time evolution
channel under H′, (·) 7→e−itH′(·)eitH′ gives a simulation in our sense, Deﬁnition 5.
We make use of the following lemmas. Lemma 7 ensures that measurement and time evolution are
consistent with the encodings of Deﬁnition 4, and Lemma 8 bounds the error of (∆, η, ε)-simulations
under time evolution.
Lemma 7 ([CMP18], Proposition 4). If Estate and Eobs are encodings as in Deﬁnition 4 and (1),
then for all observables O and states ρ on the target system H,
tr[Eobs(O)Estate(ρ)] = tr[Oρ] .
Moreover if the encoding is standard (rank(P) > 0 in Deﬁnition 4) then
e−iEobs(H)tEstate(ρ)eiEobs(H)t = Estate
 e−iHtρeiHt
.
Lemma 8 ([CMP18], Proposition 28). Let H′ be a (∆, η, ε)-simulation of H in the sense of Deﬁni-
tion 4 corresponding to encodings Eobs, Estate. If ρ′ is a state in the simulator system H′ satisfying
Eobs(I)ρ′ = ρ′, then for all t
∥e−iH′tρ′eiH′t −e−iEobs(H)tρ′eiEobs(H)t∥1 ⩽2εt + 4η .
12

Combining these lemmas, we see that for any observable O and state ρ on H,
| tr[Eobs(O)e−iH′tEstate(ρ)eiH′t] −tr[Oe−iHtρeiHt]|
= | tr[Eobs(O)

e−iH′tEstate(ρ)eiH′t −e−iEobs(H)tEstate(ρ)eiEobs(H)t
]|
⩽∥O∥(2εt + 4η) .
Hence the channels Tt : ρ′ 7→e−iH′tρ′eiH′t, for t ∈[0, tmax] simulate H in the sense of Deﬁnition 5
with respect to any Ωstate and Ωobs, up to error
ε′ ⩽2εtmax + 4η.
This provides some consistency between existing work and our notion of simulation; we have shown
that evolution under a simulator Hamiltonian in the sense of [CMP18] constitutes an analogue
quantum simulator in our framework given by Deﬁnition 5.
Short-time simulation with Lieb-Robinson bounds
One advantage of only requiring the simulation of a particular set of observables Ωobs in Deﬁni-
tion 5, as opposed to reproducing the entire physical system, is that one can take advantage of the
limited spread of correlations for short-time dynamics [LR72]. The idea of exploiting Lieb-Robinson
bounds to reduce necessary hardware overhead has already been considered for the study of many-
body quantum states on quantum computers [KS17, BCSF21], and more recently in the setting of
analogue simulators [TRC22]. We explain here how the latter ﬁts into our framework.
Consider the case of a Hamiltonian Hn on a d-dimensional lattice of n qubits H ∼= (C2)⊗n, such
that
Hn =
n
X
x=1
hx ,
where the hx is a nearest-neighbour local interaction with ∥hx∥⩽1, translated to position x in the
lattice, so that Hn is translationally invariant.
If one is only interested in simulating the ﬁnite-time dynamics of a few local observables Ωobs which
are contained within a small neighbourhood of the origin, starting from a state ρ = |0⟩⟨0|⊗n, then
it is suﬃcient (up to exponentially small error) to simulate a far smaller subsystem, corresponding
to the Lieb-Robinson light cone, as in Fig. 5. This situation is studied in [TRC22], in particular
for the thermodynamic limit n →∞.
Let Hm = Pm
y=1 hy be the simulator Hamiltonian, deﬁned identically to Hn but on a lattice of size
m < n, H′ ∼= (C2)⊗m. We encode ρ and O simply by restricting them to the smaller subsystem.
Then a simulation of an observable O ∈Ωobs up to accuracy ε, satisfying
| tr[Oe−iHntρeiHnt] −tr[Eobs(O)e−iHmtEstate(ρ)eiHmt]| ⩽ε ,
can be accomplished in the large-n regime for all t ∈[0, tmax] if one takes m = O
 logd(1/ε) + td
(see [TRC22, Lemma 1]).
13

O
. . .
. . .
. . .
. . .
ρ(0)
ρ(t)
e−iHt
Figure 5: Simulation of a 1-dimensional spin system under a Hamiltonian H for time t. In theory,
the system extends inﬁnitely, but to estimate the value of a local observable O it is only necessary
to simulate a subsystem corresponding to the Lieb-Robinson light cone.
3
Modular encodings and gadgets
3.1
Overview
In this section, we focus on the case of a simulator channel Tt given by time evolution under a local
simulator Hamiltonian H′, which should reproduce the dynamics of the local target Hamiltonian
H = P
i Hi. In light of the size-independence requirement of Deﬁnition 1, it is natural to encode
each Hi term separately into some term H′
i, but systematically doing so is a non-trivial task: we
need the encoded terms to interact with each other in a way which mimics the original system.
This problem can be tackled using perturbative gadgets. Perturbative gadgets were initially intro-
duced by [KKR06] as a means of proving QMA-completeness of the 2-local Hamiltonian problem by
reduction from the 3-local case [KR03], and have since been used extensively in the ﬁeld of Hamil-
tonian complexity theory. In this work, we especially focus on the use of gadgets for Hamiltonian
locality reduction, though it should be noted that perturbative gadgets can also be used to simplify
the structure of the interaction hypergraph [OT08] and in general to reduce Hamiltonians to more
restrictive families of interactions [BL08, SV09, CM16].
In this work, we introduce a formalism which we argue encompasses any attempt at gadgetisation,
in a sense which we make precise (Deﬁnition 9), in order to prove general properties of such
constructions. Note that our approach, and the (η, ε) accuracy parameters, are closely related to
those used in the deﬁnitions of simulation in [CMP18] and [BH17]. We reﬁne the approach of the
latter by generalising to a potentially non-perturbative regime and by considering the feature of
“combining well” with other interactions as a generic requirement for gadgets. We use these results
to argue that any size-independent encoding of a Hamiltonian H into another H′ cannot reduce
the locality of interactions (for example, reducing a 3-local Hamiltonian to a 2-local Hamiltonian).
3.2
A general deﬁnition for gadgets
The setup is as follows: we consider a large system H = ⊗n
i=1Hi, within which a local interaction
H ∈Herm(H) acts on a subsystem of O(1) sites. With the introduction of a small ancillary system
A, we aim to replace H by some “gadget” H′ ∈Herm(H ⊗A), which acts on O(1) sites in H and
A.
A simulator Hamiltonian in the sense of Deﬁnition 5 need not necessarily capture the entire spectrum
of its target Hamiltonian. In this case, however, we are thinking of H as a single interaction in
a larger system, and as such we cannot generally assume that its eigenspaces will be preserved
under time evolution. Therefore, we require as a minimum that H′ should (when restricted to some
14

subspace deﬁned by a projector P ′) approximately reproduce the full spectrum of H. Moreover, for
H′ to be a useful gadget, it must combine well with other Hamiltonian terms acting on H. That
is to say, there should exist P ′ ∈Proj(H ⊗A) such that P ′(H′ + Helse ⊗I)P ′ approximates the
spectrum of H + Helse, for any Helse ∈Herm(H) (see Fig. 6). We formalise this with the following
deﬁnition.
Deﬁnition 9 ((ζ, ε)-gadget property). Given a Hamiltonian H ∈Herm(H) acting on a system
H = ⊗n
i=1Hi, and H′ ∈Herm(H ⊗A) for A an ancillary system, we say that (H′, A) satisﬁes the
(ζ, ε)-gadget property for H if there exists P ′ ∈Proj(H ⊗A), ˜P ∈Proj(A) \ {0} such that, for any
Helse ∈Herm(H), there exists a unitary ˜UHelse ∈U(H ⊗A) with
∥P ′(H′ + Helse ⊗I)P ′ −˜UHelse
 (H + Helse) ⊗˜P
 ˜U †
Helse∥⩽ε + ζ∥Helse∥.
Figure 6: An example of a mediator gadget. The (blue) 3-local interaction is replaced by a set of
2-local terms with an ancillary site. Crucially, the other (red) terms in the original Hamiltonian
are unchanged, allowing the encoding to take place term-by-term.
In other words, (H′, A) satisﬁes the (ζ, ε)-gadget property for H if, when restricted a subspace
deﬁned by P ′, H′+Helse⊗I approximates the spectrum of H +Helse up to error ε+ζ∥Helse∥. Notice
that ˜P is almost arbitrary; its rank determines the multiplicity of each eigenvalue of H + Helse in
the simulator system, but otherwise it can be rotated by ˜UHelse, which rotates the eigenvectors of
(H + Helse) ⊗˜P approximately onto those of P ′(H′ + Helse ⊗I)P ′.
As noted in [CMP18], there are two distinct types of gadgets used in literature:
• Mediator gadgets, in which ancillary qubits are inserted between logical qubits to mediate
interactions, and
• Subspace gadgets, in which single logical qubits are encoded into several physical qubits,
restricted to a two-dimensional subspace by strong interactions.
Deﬁnition 9 encompasses the former, but not the latter.
Qualitatively this is because whereas
mediator gadgets replace interactions, subspace gadgets replace entire qubits, including all of the
interactions they take part in. It would be possible to extend our formalism to subspace gadgets,
by restricting the range of Helse in Deﬁnition 9 to terms which do not interact with the target qubit.
We do not consider this here, however, for brevity and because subspace gadgets do not reduce the
locality of interactions, which is our primary motivation for this section.
Although Deﬁnition 9 is a natural requirement, it is not convenient to work with due to the ap-
pearance of the general Helse acting on the entire of H, upon which ˜U depends. The following
alternative deﬁnition does not suﬀer from this problem.
Deﬁnition 10 ((η, ε)-gadget). Let H ∈Herm(H) be a Hamiltonian on a Hilbert space H, and let
A be an ancillary Hilbert space. For H′ ∈Herm(H ⊗A), we say that (H′, A) is a (η, ε)-gadget for
H if there exists P ∈Proj(A) \ {0} and U ∈U(H ⊗A) such that
∥U −I∥⩽η ,
∥P ′H′P ′ −U(H ⊗P)U †∥⩽ε ,
where P ′ = U(I ⊗P)U † ∈Proj(H ⊗A).
15

The advantage of Deﬁnition 10 is that it is stated in terms of a “local” rather than global property.
Assuming that H, H′, P ′ act on only O(1) sites in H and A, we can without loss of generality
restrict to this signiﬁcantly smaller subspace to check whether H′ is a gadget. This is in contrast
with Deﬁnition 9, which requires us to in principle consider interactions over the full n-site space
in order to check the gadget property.
To motivate the use of Deﬁnition 10, we show that the above notions are in correspondence; things
that look like gadgets are always gadgets, and vice-versa. This is formalised by the following two
theorems.
Theorem 11 ((η, ε)-gadgets have the (ζ, ε)-gadget property). Suppose that (H′, A) is a (η, ε)-
gadget for H. Then (H′, A) satisﬁes the (ζ, ε)-gadget property for H, where ζ = O(η).
(Proof in Appendix B.2.1)
Theorem 12 (The (ζ, ε)-gadget property requires a (η, ε)-gadget). Suppose that (H′, A) satisﬁes
the (ζ, ε)-gadget property for H, where H, H′, and P ′ act on O(1) sites in H = ⊗n
i=1Hi. Then
(H′, A) is a (η, ε′)-gadget for H, where η = O(ε) + O(ζ
1
2 ) and ε′ = O(ε) + O(ζ).
(Proof in Appendix B.2.2)
The roles of the η and ε parameters are to bound the error in the eigenvectors and eigenvalues
respectively. Roughly speaking, η quantiﬁes how well the gadget combines with other terms, and
ε quantiﬁes the spectral error of the gadget in isolation. A good gadget requires both of these
parameters to be small. In Appendix A.2 we present a 3-to-2 local gadget which is an extreme case
of this, with ε = 0 at the cost of a large η error.
Prior work in Hamiltonian complexity theory has focused on gadgetisation in the context of ground
state estimation [KR03, CM16, BH17] or simulation in a low energy subspace [CMP18]; as a result,
a case of particular relevance is when P ′ projects onto the low-energy subspace of H′. For ∆∈R,
we write P⩽∆(H′) for the projector onto the span of the eigenvectors of H′ with eigenvalues in the
range (−∞, ∆].
Deﬁnition 13 ((∆, η, ε)-gadget). Let H ∈Herm(H) be a Hamiltonian on a Hilbert space H, and
let A be an ancillary Hilbert space. For H′ ∈Herm(H⊗A), we say that (H′, A) is a (∆, η, ε)-gadget
for H if there exists P ∈Proj(A) \ {0}, and U ∈U(H ⊗A) such that P⩽∆(H′) = U(I ⊗P)U †, and
∥U −I∥⩽η ,
∥P⩽∆(H′)H′P⩽∆(H′) −U(H ⊗P)U †∥⩽ε .
In other words, the pair (H′, A) satisfy Deﬁnition 10, in the special case where we can use P ′ =
P⩽∆(H′).
Notice that Deﬁnition 13 imposes a signiﬁcantly stronger requirement on H′ than Deﬁnition 10; a
priori there is no reason to expect that there will exist any choice of P and U such that P⩽∆(H′) =
U(I ⊗P)U †. Deﬁnitions 10 and 13 are suﬃcient to guarantee desirable combination properties (see
Appendix A.3), and are satisﬁed by widely-used constructions (see Appendix A.1).
3.3
Energy scaling is inevitable for gadgets
Here we present the main result of the section: general locality reduction gadgets cannot exist
without unfavourably scaling energies. This result holds in the most general setting of (η, ε)-gadgets
(Deﬁnition 10), and hence follows even from the relaxed (ζ, ε)-gadget property of Deﬁnition 9.
16

Theorem 14 (Gadget energy scaling). Let H = (C2)⊗k be the space of k = O(1) qubits, and let H
be the k-fold tensor product of Pauli Z operators with strength J > 0,
H = J
k
O
i=1
Zi .
Suppose (H′, A) is a (η, ε)-gadget for H for H′ a k′-local Hamiltonian, where k′ < k.
Then, provided ε < 2−k′J, the gadget must have energy scale ∥H′∥⩾2−k′J−ε
η
= Ω(η−1).
(Proof in Appendix B.3)
The method of proof is simple, and very likely does not provide an optimal lower bound for ∥H′∥,
due to the lack of any dependence on k.
We expect that such dependence should be present;
any approach which iteratively lowers the locality of an interaction from k-local to 2-local will
accumulate scalings from each round of gadgetisation, but this does not rule out a more direct
approach. Existing methods to reduce locality, such as the subdivision and 3-to-2 gadgets of [OT08]
(described in Appendix A.1) and the higher-order gadgets of [JF08], give scalings that suggest that
any k-to-2-local gadget construction should require energies which scale exponentially in k. The
question of whether such exponential scaling is the best possible was ﬁrst raised in [BDLT08], and
is still unresolved. Using the formalism introduced here, this problem can be precisely stated, and
optimisation of Theorem 14 may provide a negative result. Furthermore, we expect that it may
be possible to answer similar questions about gadget energy scaling in other cases, for example in
simplifying the structure of an interaction graph or reducing to smaller families of interactions.
The signiﬁcance of Theorem 14 is that it essentially rules out a size-independent (Deﬁnition 1)
simulation of a k-local Hamiltonian H by another k′-local Hamiltonian H′ for k′ < k, for the
following reason. Any “modular” encodings require the use of term-by-term gadgets, which must
each satisfy the (ζ, ε)-gadget property (Deﬁnition 9) with ζ, η = O(n−1) to guarantee that they can
be combined (since the rest of the Hamiltonian will have ∥Helse∥= O(n)). By Theorem 12, this
requires the use of (ε, η)-gadgets (Deﬁnition 10) with η = O(n−1/2), and by Theorem 14 this will
require interactions which scale at least as Ω(n1/2).
A couple of notes on gadget energy scalings in existing work: [Bau20] gives a method to reduce
the exponential or doubly-exponential scaling in perturbative Hamiltonians to polynomial scaling,
and in [CN15] the authors present gadgets whose interaction strengths do not grow with accuracy.
However, both cases violate size-independence (Deﬁnition 1) in other ways such as polynomial
scaling in the number of simulator qubits or instead shrinking the interaction strengths.
3.4
Gadgets from the quantum Zeno effect
In this section, we demonstrate an alternative approach for reducing the locality of an interaction
in a Hamiltonian — a task for which Theorem 14 establishes the need for energies which scale
with the size of the system, when conventional gadgets are used. The construction presented here,
however, uses the freedom aﬀorded by the general simulation channel Tt in Deﬁnition 5 to take
advantage of an additional resource: intermediate measurements.
We will see that, despite some impractical features, this approach oﬀers an improvement in scal-
ings over the conventional gadget techniques discussed earlier in the section. Additionally, this
construction captures a key feature of our framework for analogue simulators given in Deﬁnition 5
in contrast with existing work: we deﬁne simulators in terms of their dynamic behaviour, rather
than in terms of the properties of static Hamiltonians.
For the process we describe here, we repeatedly refer to “measurement” for conceptual simplicity
when talking about probabilities, but this terminology is somewhat misleading; we do not record
17

or use the outcome. The construction may alternatively be viewed as a sort of quantum simulation
driven by engineered decoherence.
Construction
Let H ∈Herm(H) be a single interaction in a many-body system, which we intend to simu-
late. As before, we will introduce an ancillary qubit A ∼= C2, and evolve under a Hamiltonian
H′ ∈Herm(H ⊗A), but now we supplement the natural time evolution with regular projective
measurements on the A system at time intervals of δt. By the quantum Zeno eﬀect [MS77], this
forces the A system to stay in the |0⟩state with high probability, meanwhile simulating the desired
interaction on the H system.
The following result, Proposition 15, provides a formal construction for the measurement-based
gadgets described above. Qualitatively, this result tells us that if we evolve |ψ⟩⊗|0⟩for time δt
under the simulator Hamiltonian H′, and then measure the ancillary qubit, we will obtain a ‘1’
result with probability O((δt)3) (corresponding to an amplitude of O((δt)3/2). In the more likely
case that we obtain ‘0’, the post-measurement state (on the H space) is e−iδtH |ψ⟩, for some new
Hamiltonian H, up to error O((δt)2). By repeating this process t/δt times, we will hence obtain a
state e−itH |ψ⟩+ O(t(δt)) on the H space if ‘0’ is measured in every round of measurement. The
probability of a measurement error in this process scales as t(δt)2, hence can be controlled provided
that δt = O(t−1/2).
Proposition 15. For a Hilbert space H and an ancillary qubit A = C2, let H′ ∈Herm(H ⊗A) be
a Hamiltonian given by
H′ = HI ⊗I + HX ⊗X + H|1⟩⟨1| ⊗|1⟩⟨1| ,
for some HI, HX, H|1⟩⟨1| ∈Herm(H) depending on a small parameter δt such that ∥HI∥= O(1),
∥HX∥= O((δt)−1/2), and ∥H|1⟩⟨1|∥= O((δt)−1) with H2
|1⟩⟨1| = ω2I, ω = 2π
δt .
Then, for any |ψ⟩∈H,
e−iδtH′(|ψ⟩⊗|0⟩) =
 e−iδtH |ψ⟩+ O((δt)2)

⊗|0⟩+ O((δt)3/2) ⊗|1⟩,
where
H = HI −ω−2HXH|1⟩⟨1|HX .
(Proof in Appendix B.5)
This provides a new 3-to-2-local gadget for Pauli strings. For example, we can set HI = −Z1,
HX = p ω
2 (Z2 + Z3), H|1⟩⟨1| = −ωZ1; this yields a 2-local Hamiltonian H′ simulating the 3-local
interaction H = Z1 ⊗Z2 ⊗Z3. More generally, given three commuting Pauli strings Aa, Bb, Cc, we
can set HI = −Aa, HX = p ω
2 (Bb+Cc), H|1⟩⟨1| = −ωAa to simulate the interaction H = Aa⊗Bb⊗Cc.
This procedure may be used to simulate a k-local Pauli string using a (⌈k/3⌉+1)-local Hamiltonian.
Although Proposition 15 shows that evolution and repeated measurements under H′ reproduce the
dynamics of H, it is also important to guarantee that it can be combined with other interactions,
as discussed in Section 3.2. Proposition 16 provides the necessary result for this, by verifying that
the conclusions of Proposition 15 also hold when an additional term Helse ∈Herm(H) is added to
both the target and simulator Hamiltonian.
Proposition 16. Let H = (C2)⊗n be a d-dimensional lattice of n qubits, and let Helse ∈Herm(H)
be a Hamiltonian of the form Helse = P
i hi, where each hi is a O(1)-local interaction on a set of
neighbouring sites such that the degree of the interaction hypergraph is bounded by an O(1) constant,
such that ∥hi∥= O(1).
18

Introduce an ancillary qubit A = C2, and let H′ ∈Herm(H ⊗A) be a Hamiltonian given by
H′ = HI ⊗I + HX ⊗X + H|1⟩⟨1| ⊗|1⟩⟨1| ,
for some HI, HX, H|1⟩⟨1| ∈Herm(H) depending on a small parameter δt such that ∥HI∥= O(1),
∥HX∥= O((δt)−1/2), and ∥H|1⟩⟨1|∥= O((δt)−1) with H2
|1⟩⟨1| = ω2I, ω = 2π
δt . Assume that HI, HX,
and H|1⟩⟨1| act on O(1) sites in H.
Then, for any |ψ⟩∈H,
e−iδt(H′+Helse⊗I)(|ψ⟩⊗|0⟩) =
 e−iδt(H+Helse) |ψ⟩+ O((δt)2)

⊗|0⟩+ O((δt)3/2) ⊗|1⟩,
where
H = HI −ω−2HXH|1⟩⟨1|HX .
(Proof in Appendix B.5)
The signiﬁcance of Proposition 16 is that the errors do not depend on the size of the system through
∥Helse∥. Qualitatively, this is because the requirement that Helse is formed from geometrically local
interactions in a d-dimensional lattice ensures that for suﬃciently small times δt, only terms within
a light cone of size (δt)d “talk” to the gadget site. Formally, this is due to bounds we place on
the Trotter error in the expansion e−iδt(H+Helse) ≈e−iδtHe−iδtHelse, using methods discussed in
[CST+21].
Discussion and comparison to conventional gadgets
Given the result of Proposition 16, we can now describe how the measurement gadget construction
ﬁts into our framework of analogue quantum simulation described in Deﬁnition 5.
Given a Hamiltonian H = Z1 ⊗Z2 ⊗Z3 + Helse on a d-dimensional lattice of n qubits H = (C2)⊗n,
with Helse ∈Herm(H) satisfying the requirements of Proposition 16, we ﬁx some δt > 0 and deﬁne
the simulator space H′ = H ⊗A, where A = C2. Let H′ ∈Herm(H′) be given by
H′ = −Z1 ⊗I +
rω
2 (Z2 + Z3) ⊗X −ωZ1 ⊗|1⟩⟨1| ,
where ω = 2π
δt . Deﬁne the state and observable encodings Estate and Eobs by
Estate(ρ) = ρ ⊗|0⟩⟨0| ,
Eobs(O) = O ⊗I ,
and deﬁne channels Eδt, M : D(H′) →D(H′) by
Eδt(ρ′) = e−iδt(H′+Helse⊗I)ρ′eiδt(H′+Helse⊗I) ,
M(ρ′) = trA[ρ′(I ⊗|0⟩⟨0|)] ⊗|0⟩⟨0| + trA[ρ′(I ⊗|1⟩⟨1|] ⊗|1⟩⟨1| ,
so that Eδt corresponds to evolution under the Hamiltonian H′ + Helse for time δt, and M corre-
sponds to a measurement of the A system. Then, for all t, deﬁne the time evolution channel
Tt = (M ◦Eδt) ◦(M ◦Eδt) ◦· · · ◦(M ◦Eδt) ,
containing ⌊t/δt⌋copies of (M ◦Eδt).
This evolution is described by Fig. 7.
The content of
Proposition 16 tells us that
(Tt ◦Estate)(ρ) =
 e−itHρeitH + O(tδt)

⊗|0⟩⟨0| + O(t(δt)2) ⊗|1⟩⟨1| ,
19

ρ ⊗|0⟩⟨0|A
. . .
Apply e−iδtH′
Apply e−iδtH′
Measure A
≈
 e−itHρeitH
⊗|0⟩⟨0|A
Repeat ⌊t/δt⌋times
Tt
Figure 7: Time-evolution with a measurement gadget for the simulation of an interaction H with
a gadget Hamiltonian H′.
and hence for any observable O ∈Herm(H) with ∥O∥= 1,
tr[Eobs(Tt ◦Estate)(ρ)] = tr[Oe−itHρeitH] + O(tδt) .
The channels Tt therefore simulate H (in the sense of Deﬁnition 5) with respect to any states Ωstate
and normalised observables Ωobs, up to accuracy ε > 0 and maximum time tmax, provided that
one chooses δt = O(εt−1
max). Therefore we require interaction strengths and measurement frequency
which scale as J = O(ε−1tmax) — note that this does not depend on n, the size of the system.
We can compare these scalings with those obtained if we were to use conventional gadgets. Suppose
we have a (η, ε)-gadget in the sense of Deﬁnition 10, with η = O(n−1ε) to ensure an absolute error
of O(ε) when combined with a Hamiltonian of order n, comparable with the above construction.
By Theorem 14, this must involve energy scalings of J = Ω(ε−1n) (and even without Theorem 14, a
low-energy (∆, η, ε)-gadget as in Deﬁnition 13 would require energies scaling as Ω(n) to ensure that
unwanted states are suﬃciently penalised). In fact, this is likely not the optimal bound; the best
known 3-to-2 gadget construction (see Appendix A.1) requires energy scales of O(ε−3 +η−3), which
in this case would require interaction strengths scaling as J = O((ε−1n)3). Even if the system size
is restricted via Lieb-Robinson bounds as described in Section 2.2 to set n = O(logd(1/ε) + td
max),
the measurement-based gadget still provides an improvement.
Despite this advantage, the measurement gadget construction involves repeated instantaneous de-
coherence of the ancillary qubit at precise time intervals without disturbing the rest of the system,
and may still require large (albeit non-scaling) interaction strengths. Moreover, if Ngad such gad-
gets were used in parallel, we expect (though do not calculate here) that an additional overhead of
at least δt = O
 (tmaxNgad)−1/2
would be necessary to control the probability of measuring a 1 at
any of the ancillary sites. Nonetheless, the construction provides a marked improvement in scalings
over existing gadgets for a single 3-local term in a Hamiltonian, and gives some positive clues as
to the ways in which simulators might take advantage of more general possibilities for channels
allowed by Deﬁnition 5.
3.5
Outlook on universality for analogue quantum simulators
In analogy to universal quantum computation, one may consider the notion of universality for
quantum simulators. Roughly speaking: given a family F = {Hm} of Hamiltonians, when is F
universal, in some sense of being able to simulate the dynamics of all other Hamiltonians?
20

Precise deﬁnitions of universality have been provided by [CMP18, ZA21]. These, and subsequent
works [PB20, PM21, KPBC20, KPBC22], have characterised several such universal families F.
The proofs of these results often involve perturbative gadgets (as in Deﬁnition 13) as a central
ingredient for reducing general Hamiltonians to simple families.
Constructions can also make
use of sophisticated techniques involving mapping between analogue and digital problems [ZA21,
KPBC20], which incur interaction strengths scaling (at least polynomially) with n.
As discussed in Section 3.3, the use of gadgets may in fact necessitate unfavourable energy scalings,
which (for instance) creates a barrier for Hamiltonian locality reduction in the size-independent
regime. Although our gadget construction with intermediate measurements in Section 3.4 demon-
strates how the more general simulation procedures aﬀorded by our notion of simulation (Def-
inition 5) may be leveraged to provide some improvement, this still falls short of completely
size-independent simulation as in Deﬁnition 1. Further limitations for practical Hamiltonian sim-
pliﬁcation procedures come from [AZ18], in which the authors show that the reduction of local
Hamiltonians with dense interaction hypergraphs to simulator Hamiltonians with sparse interac-
tion hypergraphs is generally impossible without introducing scalings in interaction strengths. This
result holds even with their weaker requirement of gap-simulation, in which the simulator needs
only to replicate the ground and ﬁrst excited energies of the system.
These results suggest that we cannot expect to talk about a simple class of practical analogue
quantum simulators which can mimic the physics of all other Hamiltonians in any sense resembling
previous universality results. In fact, we argue that this should not be expected; if a notion of
simulation renders almost all simple Hamiltonian families universal, then it is unlikely to capture
the actual capabilities of experimentally realistic simulators. On the other hand, our deﬁnition of
simulation leads to a new notion of universality, not phrased in terms of the static classiﬁcation of
Hamiltonians but rather the dynamics of observable quantities. Such a notion could take advantage
of the generality aﬀorded by our deﬁnition of simulation channels, as well as take into account the
constraints of size-independence for realisable systems. We expect that in this regime a resource
theory for simulation should arise, relating the capabilities of simulators with a preorder analogously
to the theory of SLOCC state transformations [DVC00, WDGC13].
4
Conclusion
In this work, we have presented a new deﬁnition for analogue quantum simulators, Deﬁnition 5,
which provides a general theoretical setting to study experimentally realisable simulations. We
argue that a requirement of scalability (Deﬁnition 1) is necessary for this task. Our framework
emphasises the broad dynamical possibilities of experiments, and we have shown how this may be
leveraged to provide improvements on other notions of simulation in Section 2.2 and Section 3.4.
Our work stands in contrast to existing literature (reviewed in Section 1.4) which has typically
focused on analogue simulation in the context of Hamiltonian complexity theory, using perturbative
gadget constructions to make general statements about universality.
To describe this, we have
produced general deﬁnitions for gadgets (Deﬁnition 10 and Deﬁnition 13) motivated by a natural
requirement (Deﬁnition 9), and with these in hand we have shown that gadgets require unavoidable
scalings of interaction strengths in the setting of locality reduction in Theorem 14, posing an
obstacle for experimental realisations. We argue that a more general notion of simulation (such as
Deﬁnition 5), tempered by scalability requirements, is necessary to provide a clear description of
the computational power and possibilities of analogue quantum simulators.
21

Acknowledgements
We
acknowledge
ﬁnancial
support
from
the
Novo
Nordisk
Foundation
(Grant
No.
NNF20OC0059939 ‘Quantum for Life’), the European Research Council (ERC Grant Agreement
No. 81876) and VILLUM FONDEN via the QMATH Centre of Excellence (Grant No.10059).
References
[ABC+21]
Ehud Altman, Kenneth R. Brown, Giuseppe Carleo, Lincoln D. Carr, Eugene Demler, Cheng Chin,
Brian DeMarco, Sophia E. Economou, Mark A. Eriksson, Kai-Mei C. Fu, et al. Quantum simulators:
Architectures and opportunities. PRX Quantum, 2(1):017003, 2021.
[AC22]
Harriet Apel and Toby Cubitt. A mathematical framework for quantum Hamiltonian simulation and
duality. arXiv preprint arXiv:2208.11941, 2022.
[ALGTS+19] Javier Argüello-Luengo, Alejandro González-Tudela, Tao Shi, Peter Zoller, and J. Ignacio Cirac. Ana-
logue quantum chemistry simulation. Nature, 574(7777):215–218, 2019.
[AZ18]
Dorit Aharonov and Leo Zhou.
Hamiltonian sparsiﬁcation and gap-simulations.
arXiv preprint
arXiv:1804.11084, 2018.
[Bau20]
Johannes Bausch. Perturbation gadgets: Arbitrary energy scales from a single strong interaction. In
Annales Henri Poincaré, volume 21, pages 81–114. Springer, 2020.
[BBMC20]
Bela Bauer, Sergey Bravyi, Mario Motta, and Garnet Kin-Lic Chan. Quantum algorithms for quantum
chemistry and quantum materials science. Chemical Reviews, 120(22):12685–12717, 2020.
[BCC+15]
Dominic W. Berry, Andrew M. Childs, Richard Cleve, Robin Kothari, and Rolando D. Somma. Simu-
lating Hamiltonian dynamics with a truncated Taylor series. Physical Review Letters, 114(9):090502,
2015.
[BCK15]
Dominic W. Berry, Andrew M. Childs, and Robin Kothari. Hamiltonian simulation with nearly optimal
dependence on all parameters. In 2015 IEEE 56th Annual Symposium on Foundations of Computer
Science, pages 792–809. IEEE, 2015.
[BCSF21]
Johannes Borregaard, Matthias Christandl, and Daniel Stilck França.
Noise-robust exploration of
many-body quantum states on near-term quantum devices. npj Quantum Information, 7(1):45, 2021.
[BDL11]
Sergey Bravyi, David P. DiVincenzo, and Daniel Loss. Schrieﬀer–Wolﬀtransformation for quantum
many-body systems. Annals of Physics, 326(10):2793–2826, 2011.
[BDLT08]
Sergey Bravyi, David P. DiVincenzo, Daniel Loss, and Barbara M. Terhal.
Quantum simulation
of many-body Hamiltonians using perturbation theory with bounded-strength interactions. Physical
Review Letters, 101(7):070503, 2008.
[BH17]
Sergey Bravyi and Matthew Hastings. On complexity of the quantum Ising model. Communications
in Mathematical Physics, 349(1):1–45, 2017.
[Bha13]
Rajendra Bhatia. Matrix analysis, volume 169. Springer Science and Business Media, 2013.
[BL08]
Jacob D. Biamonte and Peter J. Love.
Realizable Hamiltonians for universal adiabatic quantum
computers. Physical Review A, 78(1):012352, 2008.
[BLK+15]
Rami Barends, L. Lamata, Julian Kelly, L. García-Álvarez, Austin G. Fowler, A. Megrant, Evan
Jeﬀrey, Ted C. White, Daniel Sank, Josh Y. Mutus, et al. Digital quantum simulation of fermionic
models with a superconducting circuit. Nature Communications, 6(1):7654, 2015.
[CAB+21]
Marco Cerezo, Andrew Arrasmith, Ryan Babbush, Simon C. Benjamin, Suguru Endo, Keisuke Fujii,
Jarrod R. McClean, Kosuke Mitarai, Xiao Yuan, Lukasz Cincio, et al. Variational quantum algorithms.
Nature Reviews Physics, 3(9):625–644, 2021.
[CM16]
Toby Cubitt and Ashley Montanaro. Complexity classiﬁcation of local Hamiltonian problems. SIAM
Journal on Computing, 45(2):268–316, 2016.
22

[CMN+18]
Andrew M. Childs, Dmitri Maslov, Yunseong Nam, Neil J. Ross, and Yuan Su. Toward the ﬁrst quan-
tum simulation with quantum speedup. Proceedings of the National Academy of Sciences, 115(38):9456–
9461, 2018.
[CMP18]
Toby S. Cubitt, Ashley Montanaro, and Stephen Piddock. Universal quantum Hamiltonians. Proceed-
ings of the National Academy of Sciences, 115(38):9497–9502, 2018.
[CN15]
Yudong Cao and Daniel Nagaj. Perturbative gadgets without strong interactions. Quantum Informa-
tion and Computation, 15(13-14):1197–1222, 2015.
[CST+21]
Andrew M. Childs, Yuan Su, Minh C. Tran, Nathan Wiebe, and Shuchen Zhu. Theory of Trotter
error with commutator scaling. Physical Review X, 11(1):011020, 2021.
[CZ12]
J. Ignacio Cirac and Peter Zoller. Goals and opportunities in quantum simulation. Nature Physics,
8(4):264–266, 2012.
[DBK+22]
Andrew J. Daley, Immanuel Bloch, Christian Kokail, Stuart Flannigan, Natalie Pearson, Matthias
Troyer, and Peter Zoller. Practical quantum advantage in quantum simulation. Nature, 607(7920):667–
676, 2022.
[DiV00]
David P. DiVincenzo. The physical implementation of quantum computation. Fortschritte der Physik:
Progress of Physics, 48(9-11):771–783, 2000.
[DK69]
Chandler Davis and William M. Kahan. Some new bounds on perturbation of subspaces. Bulletin of
the American Mathematical Society, 75(4):863–868, 1969.
[DK70]
Chandler Davis and William Morton Kahan. The rotation of eigenvectors by a perturbation. III. SIAM
Journal on Numerical Analysis, 7(1):1–46, 1970.
[DVC00]
Wolfgang Dür, Guifre Vidal, and J. Ignacio Cirac. Three qubits can be entangled in two inequivalent
ways. Physical Review A, 62(6):062314, 2000.
[EWL+21]
Sepehr Ebadi, Tout T. Wang, Harry Levine, Alexander Keesling, Giulia Semeghini, Ahmed Omran,
Dolev Bluvstein, Rhine Samajdar, Hannes Pichler, Wen Wei Ho, et al. Quantum phases of matter on
a 256-atom programmable quantum simulator. Nature, 595(7866):227–232, 2021.
[Fey82]
Richard P. Feynman. Simulating physics with computers. International Journal of Theoretical Physics,
21(6-7):467–488, 1982.
[GAN14]
Iulia M. Georgescu, Sahel Ashhab, and Franco Nori. Quantum simulation. Reviews of Modern Physics,
86(1):153, 2014.
[GB17]
Christian Gross and Immanuel Bloch. Quantum simulations with ultracold atoms in optical lattices.
Science, 357(6355):995–1001, 2017.
[GI09]
Daniel Gottesman and Sandy Irani. The quantum and classical complexity of translationally invariant
tiling and Hamiltonian problems. In 2009 50th Annual IEEE Symposium on Foundations of Computer
Science, pages 95–104. IEEE, 2009.
[GKS76]
Vittorio Gorini, Andrzej Kossakowski, and Ennackal Chandy George Sudarshan. Completely positive
dynamical semigroups of n-level systems. Journal of Mathematical Physics, 17(5):821–825, 1976.
[GTHC+15]
Alejandro González-Tudela, C.-L. Hung, Darrick E. Chang, J. Ignacio Cirac, and H. J. Kimble. Sub-
wavelength vacuum lattices and atom–atom interactions in two-dimensional photonic crystals. Nature
Photonics, 9(5):320–325, 2015.
[HMR+18]
Cornelius Hempel, Christine Maier, Jonathan Romero, Jarrod McClean, Thomas Monz, Heng Shen,
Petar Jurcevic, Ben P. Lanyon, Peter Love, Ryan Babbush, et al. Quantum chemistry calculations on
a trapped-ion quantum simulator. Physical Review X, 8(3):031022, 2018.
[HNN13]
Sean Hallgren, Daniel Nagaj, and Sandeep Narayanaswami. The local Hamiltonian problem on a line
with eight states is QMA-complete. Quantum Information and Computation, 13(9-10):721–750, 2013.
[HWBT15]
Matthew B. Hastings, Dave Wecker, Bela Bauer, and Matthias Troyer. Improving quantum algorithms
for quantum chemistry. Quantum Information and Computation, 15(1-2):1–21, 2015.
[JF08]
Stephen P. Jordan and Edward Farhi. Perturbative gadgets at arbitrary orders. Physical Review A,
77(6):062329, 2008.
23

[JZ05]
Dieter Jaksch and Peter Zoller. The cold atom Hubbard toolbox. Annals of Physics, 315(1):52–79,
2005.
[Kit97]
A. Yu Kitaev. Quantum computations: algorithms and error correction. Russian Mathematical Surveys,
52(6):1191, 1997.
[KKR06]
Julia Kempe, Alexei Kitaev, and Oded Regev.
The complexity of the local Hamiltonian problem.
SIAM Journal on Computing, 35(5):1070–1097, 2006.
[KPBC20]
Tamara Kohler, Stephen Piddock, Johannes Bausch, and Toby Cubitt. Translationally invariant uni-
versal quantum Hamiltonians in 1D. In Annales Henri Poincaré, pages 1–32. Springer, 2020.
[KPBC22]
Tamara Kohler, Stephen Piddock, Johannes Bausch, and Toby Cubitt. General conditions for univer-
sality of quantum Hamiltonians. PRX Quantum, 3(1):010308, 2022.
[KR03]
Julia Kempe and Oded Regev.
3-local Hamitonian is QMA-complete.
Quantum Information and
Computation, 3(3):258–264, 2003.
[KS17]
Isaac H. Kim and Brian Swingle. Robust entanglement renormalization on a noisy quantum computer.
arXiv preprint arXiv:1711.07500, 2017.
[KSV02]
Alexei Yu Kitaev, Alexander Shen, and Mikhail N. Vyalyi. Classical and quantum computation. Amer-
ican Mathematical Society, 2002.
[LC17]
Guang Hao Low and Isaac L. Chuang. Optimal Hamiltonian simulation by quantum signal processing.
Physical Review Letters, 118(1):010501, 2017.
[LC19]
Guang Hao Low and Isaac L. Chuang. Hamiltonian simulation by qubitization. Quantum, 3:163, 2019.
[LHN+11]
Ben P. Lanyon, Cornelius Hempel, Daniel Nigg, Markus Müller, Rene Gerritsma, F. Zähringer, Philipp
Schindler, Julio T. Barreiro, Markus Rambach, Gerhard Kirchmair, et al. Universal digital quantum
simulation with trapped ions. Science, 334(6052):57–61, 2011.
[Lin76]
Goran Lindblad. On the generators of quantum dynamical semigroups. Communications in Mathe-
matical Physics, 48:119–130, 1976.
[Llo96]
Seth Lloyd. Universal quantum simulators. Science, 273(5278):1073–1078, 1996.
[LR72]
Elliott H. Lieb and Derek W. Robinson. The ﬁnite group velocity of quantum spin systems. Commu-
nications in Mathematical Physics, 28:251–257, 1972.
[MC23]
Daniel Malz and J. Ignacio Cirac. Few-body analog quantum simulation with Rydberg-dressed atoms
in optical lattices. PRX Quantum, 4(2):020301, 2023.
[MRBAG16]
Jarrod R. McClean, Jonathan Romero, Ryan Babbush, and Alán Aspuru-Guzik. The theory of varia-
tional hybrid quantum-classical algorithms. New Journal of Physics, 18(2):023023, 2016.
[MS77]
Baidyanath Misra and E. C. George Sudarshan. The Zeno’s paradox in quantum theory. Journal of
Mathematical Physics, 18(4):756–763, 1977.
[MW21]
M. Morgado and S. Whitlock. Quantum simulation and computing with Rydberg-interacting qubits.
AVS Quantum Science, 3(2), 2021.
[NA16]
Changsuk Noh and Dimitris G. Angelakis. Quantum simulations and many-body physics with light.
Reports on Progress in Physics, 80(1):016401, 2016.
[NCP+20]
Yunseong Nam, Jwo-Sy Chen, Neal C. Pisenti, Kenneth Wright, Conor Delaney, Dmitri Maslov, Ken-
neth R. Brown, Stewart Allen, Jason M. Amini, Joel Apisdorf, et al. Ground-state energy estimation
of the water molecule on a trapped-ion quantum computer. npj Quantum Information, 6(1):33, 2020.
[OT08]
Roberto Oliveira and Barbara M. Terhal.
The complexity of quantum spin systems on a two-
dimensional square lattice. Quantum Information and Computation, 8(10):900–924, 2008.
[PB20]
Stephen Piddock and Johannes Bausch.
Universal translationally-invariant Hamiltonians.
arXiv
preprint arXiv:2001.08050, 2020.
[PCK+21]
Avikar Periwal, Eric S. Cooper, Philipp Kunkel, Julian F. Wienand, Emily J. Davis, and Monika
Schleier-Smith. Programmable interactions and emergent geometry in an array of atom clouds. Nature,
600(7890):630–635, 2021.
24

[PM17]
Stephen Piddock and Ashley Montanaro. The complexity of antiferromagnetic interactions and 2D
lattices. Quantum Information and Computation, 17(7-8):636–672, 2017.
[PM21]
Stephen Piddock and Ashley Montanaro. Universal qudit Hamiltonians. Communications in Mathe-
matical Physics, 382:721–771, 2021.
[Pre18]
John Preskill. Quantum computing in the NISQ era and beyond. Quantum, 2:79, 2018.
[SV09]
Norbert Schuch and Frank Verstraete. Computational complexity of interacting electrons and funda-
mental limitations of density functional theory. Nature physics, 5(10):732–735, 2009.
[TRC22]
Rahul Trivedi, Adrian Franco Rubio, and J. Ignacio Cirac. Quantum advantage and stability to errors
in analogue quantum simulators. arXiv preprint arXiv:2212.04924, 2022.
[VWC09]
Frank Verstraete, Michael M. Wolf, and J. Ignacio Cirac. Quantum computation and quantum-state
engineering driven by dissipation. Nature Physics, 5(9):633–636, 2009.
[Wat18]
John Watrous. The Theory of Quantum Information. Cambridge University Press, 2018.
[WDGC13]
Michael Walter, Brent Doran, David Gross, and Matthias Christandl. Entanglement polytopes: mul-
tiparticle entanglement from single-particle information. Science, 340(6137):1205–1208, 2013.
[WW22]
Henrik Wilming and Albert H. Werner. Lieb-Robinson bounds imply locality of interactions. Physical
Review B, 105(12):125101, 2022.
[ZA21]
Leo Zhou and Dorit Aharonov.
Strongly universal Hamiltonian simulators.
arXiv preprint
arXiv:2102.02991, 2021.
A
General gadgets
A.1
Existing constructions
Lemmas 4-7 in [BH17] can be naturally adapted to give several constructions for (∆, η, ε) gadgets,
which we use to demonstrate that Deﬁnition 10 encompasses commonly-used techniques. In the
following we take H′ = H ⊗A, and A ∼= C2. For V an operator on H′ we write it in block-diagonal
form with respect to the basis of A as
V =
V00
V01
V10
V11

,
where, for instance, V00 = (I ⊗⟨0|)V (I ⊗|0⟩).
Lemma 17 (First-order gadgets, adapted from [BH17]). Suppose H ∈Herm(H) and V ∈Herm(H′)
are such that
∥H −V00∥⩽ε
2 .
Then H′ = ∆H0 + V deﬁnes a (O(∆), η, ε)-gadget for H, where H0 = I ⊗|1⟩⟨1|, provided that
∆⩾O(ε−1∥V ∥2 + η−1∥V ∥).
Lemma 18 (Second-order gadgets, adapted from [BH17]). Let H ∈Herm(H), and suppose
V (1), V (0) ∈Herm(H′) are such that ∥V (1)∥, ∥V (0)∥⩽Λ, V (0)
10 = V (0)
01 = V (1)
00 = 0, and
∥H −V (0)
00 + V (1)
01 V (1)
10 ∥⩽ε
2 .
Then H′ = ∆H0 + ∆
1
2 V (1) + V (0) is a (O(∆), η, ε)-gadget for H, where H0 = I ⊗|1⟩⟨1|, if
∆⩾O(ε−2Λ6 + η−2Λ2) .
25

A
B
A
B
C
Figure 8: Interaction hypergraphs of a 2-system interaction before (left) and after (right) the use
of the subdivision gadget.
Lemma
19
(Third-order
gadgets,
adapted
from
[BH17]).
Let
H
∈
Herm(H),
and
suppose
V (2), V (1), V (0)
∈
Herm(H′)
are
such
that
∥V (2)∥, ∥V (1)∥, ∥V (0)∥
⩽
Λ,
V (1)
10 = V (1)
01 = V (0)
10 = V (0)
01 = 0, V (2)
00 = 0,
∥H −V (0)
00 −V (2)
01 V (2)
11 V (2)
10 ∥⩽ε
2 ,
and
V (1)
00 = V (2)
01 V (2)
10
.
Then H′ = ∆H0 +∆
2
3V (2) +∆
1
3V (1) +V (0) is a (O(∆), η, ε)-gadget for H, where H0 = I⊗|1⟩⟨1|, if
∆⩾O(ε−3Λ12 + η−3Λ3) .
We illustrate the application of these lemmas to our deﬁnition with the following ubiquitous gadgets
from [OT08]:
Subdivision gadget
Given a target Hamiltonian H = A⊗B ∈Herm(HA⊗HB), the subdivision gadget on HA⊗HB⊗HC
(where HC ∼= C2) is deﬁned by
H′ = ∆H0 + ∆
1
2V (1) + V (0) ,
where
H0 = I ⊗I ⊗|1⟩⟨1| ,
V (1) =
1
√
2(−A ⊗I + I ⊗B) ⊗X ,
V (0) = 1
2(A2 ⊗I + I ⊗B2) ⊗I .
Then by Lemma 18 we see that, for suﬃciently large ∆, (H′, HC) deﬁnes a (O(∆), η, ε)-gadget for
H (see Fig. 8).
3-to-2 gadget
Given a target Hamiltonian H = A ⊗B ⊗C ∈Herm(HA ⊗HB ⊗HC), the 3-to-2 local gadget on
HA ⊗HB ⊗HC ⊗HD (where HD ∼= C2) is deﬁned by
H′ = ∆H0 + ∆
2
3 V (2) + ∆
1
3 V (1) + V (0) ,
26

A
B
C
A
C
B
D
Figure 9: Interaction hypergraphs of a 3-system interaction before (left) and after (right) the use
of the 3-to-2 gadget.
where
H0 = I ⊗I ⊗I ⊗|1⟩⟨1| ,
V (2) =
1
√
2(−A ⊗I + I ⊗B) ⊗I ⊗X −I ⊗I ⊗C ⊗|1⟩⟨1| ,
V (1) = 1
2(−A ⊗I + I ⊗B)2 ⊗I ⊗I ,
V (0) = 1
2(A2 ⊗I + I ⊗B2) ⊗C ⊗I .
By Lemma 19 we see that, for suﬃciently large ∆, (H′, HD) deﬁnes a (O(∆), η, ε)-gadget for H
(see Fig. 9).
A.2
“Exact” 3-to-2 gadget
We provide the following example to illustrate the importance of the η parameter as a quantiﬁer of
how well a gadget combines with other terms.
Let H = A ⊗B ⊗C ∈Herm((C2)⊗3) be a 3-qubit interaction, and diagonalise A, B, and C as
A = λA
0 |0⟩⟨0| + λA
1 |1⟩⟨1| ,
B = λB
0 |0⟩⟨0| + λB
1 |1⟩⟨1| ,
C = λC
0 |0⟩⟨0| + λC
1 |1⟩⟨1| .
Let H′ ∈Herm((C2)⊗4) be deﬁned as
H′ = λB
0 (A −λA
0 I) ⊗I ⊗I ⊗C
+ λB
1 I ⊗(A −λA
0 I) ⊗I ⊗C
+ λA
0 I ⊗I ⊗B ⊗C ,
and let P ′ ∈Proj((C2)⊗4) be
P ′ = (I ⊗|0⟩⟨0| ⊗|0⟩⟨0| + |0⟩⟨0| ⊗I ⊗|1⟩⟨1|) ⊗I .
Then in fact the restriction of H′ to the image of P ′ exactly reproduces the spectrum of H. This
hence deﬁnes a 3-to-2 (η, 0)-gadget — or a (∆, η, 0)-gadget, if one adds a term of the form O(∆)(I−
P ′) to H′. The caveat is that this gadget has a large η parameter, and hence it does not combine
well with other interactions. For instance, in Deﬁnition 10 we might take P = |0⟩⟨0| ⊗I ⊗I ⊗I, and
U = (F ⊗|0⟩⟨0| + I ⊗I ⊗|1⟩⟨1|) ⊗I, where F is the two-qubit swapping operator. This gives η = 2.
The construction of H′ can be thought of as splitting the A qubit into two qubits (see Fig. 10),
and controlling whether the ﬁrst or second qubit is excited depending on the value of the B qubit.
Therefore, if the full Hamiltonian contains another interaction term which acts on the A site in H,
then the locality of this term will be increased under the gadgetisation procedure. Such a gadget
cannot be used to systematically reduce the locality of a Hamiltonian with many interactions.
27

A
B
C
E
B
C
E
A1
A2
Figure 10: Eﬀect of the “exact” 3-to-2 gadget on an interaction hypergraph. The (blue) 3-local
interaction between A, B, and C is replaced by a series of (blue) 2-local interactions, where the
A site has been split into two sites A1 and A2. However after this process, the 2-local interaction
(red) between A and another qubit E is replaced by two 3-local interactions between E, A1, B and
E, A2, B. Compare this with Fig. 9, for which additional interactions on qubit A will remain on
qubit A of the gadgetised Hamiltonian without any need for adjustment.
A.3
Combining gadgets
The following results show that gadgets satisfying Deﬁnition 10 or Deﬁnition 13 can be systemati-
cally combined as desired. Our techniques and proofs extend prior work [BDLT08, OT08, PM17],
using the convenient formalism of the direct rotation [BDL11]. The scalings of the parameters η′, ε′
are not necessarily optimal, though they suﬃcient for application to the subdivision and 3-to-2
gadget constructions exhibited in Appendix A.1.
We summarise the setup below, which will be used throughout the following results.
Setup 20. Let H ∈Herm(H) be a Hamiltonian on n sites, H = ⊗n
i=1Hi. Assume H = PN
i=1 Hi,
where N = O(n), such that each Hi acts on at most k = O(1) of the sites Hi, and each site
participates in at most d = O(1) interactions. Assume also that H has bounded interaction strengths,
that is, ∥Hi∥⩽J for all i.
In the below propositions we consider gadgets (H′
i, Ai) for Hi, with Ui, Pi, and P ′
i deﬁned as in
Deﬁnition 10, for each i. Assume that Ai consists of O(1) ancillary sites and that H′
i is a local
Hamiltonian consisting of O(1) interactions, such that
∥H′
i∥⩽J′ ,
∥(I ⊗Pi)H′
i(I ⊗P ⊥
i )∥⩽J′
O .
Firstly, we state the main result: that gadgets as in Deﬁnition 10 may be systematically combined
to produce new gadgets.
Proposition 21 (Parallel (η, ε)-gadget combination). Let H = P
i Hi be as in Setup 20, and
suppose that each (H′
i, Ai) deﬁnes a (η, ε)-gadget for Hi.
Deﬁne
H′ =
X
i
H′
i ∈Herm
 H ⊗(⊗iAi)

.
Then (H′, ⊗iAi) is a (η′, ε′)-gadget for H, where
ε′ = O(nε + nηJ + nη3J′
O + nη4J′) ,
η′ = O(nη) .
(Proof in Appendix B.4.1)
For completeness, we also prove a similar result that (∆, η, ε)-gadgets can be combined to create
a new (∆′, η′, ε′)-gadget. It follows from Proposition 21 that the combination of many (∆, η, ε)-
gadgets deﬁnes a (η′, ε′)-gadget, however it still remains to show that the projector P ′ in the sense
of Deﬁnition 10 may be taken as a low-energy projector P⩽∆′(H′).
28

Proposition 22 (Parallel (∆, η, ε)-gadget combination). Let H = P
i Hi be as in Setup 20, and
suppose that each (H′
i, Ai) deﬁnes a (∆, η, ε)-gadget for Hi, where
∆⩾∥H∥+ J + N(ε + 2Jη)
1
4 −2η
= O(nJ) ,
(4)
and assume that the scaling of η with n is bounded as
η = o(n−1
2) ,
(5)
and moreover that, for large J′,
nε + nηJ + nη3J′
O + nη4J′ = o(J′) ,
J′ = O(∆) .
(6)
Deﬁne
H′ =
X
i
H′
i ∈Herm(H ⊗(⊗iAi)) .
Then (H′, ⊗iAi) is a (∆′, η′, ε′)-gadget for H, where
∆′ = 1
2∆,
ε′ = O(nε + nηJ + nη3J′
O + n3η4J′) ,
η′ = O(nη) .
(Proof in Appendix B.4.2)
For an example of how these conditions can be satisﬁed, consider the case of combining many of
the 3-to-2 gadgets described in Appendix A.1. Setting J = 1 for convenience, we have J′ = Θ(∆),
J′
O = Θ(∆2/3), and ε, η = O(∆−1/3). The errors ε′ and η′ both grow as O(n∆−1/3), so a good
gadget will require ∆= Ω(n3).
A direct computation veriﬁes that this condition also ensures
that (4-6) are satisﬁed. Hence reduction from a 3-local to 2-local Hamiltonian in this way requires
interaction strengths to scale as n3.
To combine (∆, η, ε) gadgets using Proposition 22 requires the unappealing conditions of (4)-(5),
which explicitly require the gadget energies to scale with n. In fact, as noted by [BDLT08], the
regime of bounded-strength interactions does still allow approximation of the ground state energy
of H — the caveat being that the errors are extensive. Below is a generalisation of their main
result.
Theorem 23 (Ground state energy estimation with (∆, η, ε)-gadgets, generalising [BDLT08], The-
orem 1). Let H = P
i Hi be as in Setup 20,and suppose that each (H′
i, Ai) deﬁnes a (∆, η, ε)-gadget
for Hi.
Deﬁne
H′ =
X
i
H′
i ∈Herm(H ⊗(⊗iAi)) .
Then the ground state energies of H and H′ satisfy
|λ0(H) −λ0(H′)| = O(nε + nηJ + nη3J′
O + nη4J′) .
(Proof in Appendix B.4.3)
29

B
Proofs
B.1
Qutrit-to-qubit energy scaling
Here we prove Proposition 6. The idea is simple: by encoding a qutrit into a set of qubits, we
must end up with an “unused” state in the qubit system, since the encoding cannot be surjective
by dimension counting. Since the (∆, η, ε) simulation requires all simulated states to lie in the
low-energy subspace of the simulator, this implies that the unused qubit states must lie in the
high-energy (above ∆) subspace.
In the proof below, we start with the encoded ground state ρ0, and construct a state ρ1 which
diﬀers only from ρ0 only in one set of qubits in which it is in such an “unused” state. The similarity
of the states and their diﬀerences in energies lead to the requirement for strong interactions.
In this proof, and subsequent sections, we make frequent use of the following standard result from
matrix analysis (see for instance [Bha13, Corollary III.2.6]).
Lemma 24 (Weyl’s Perturbation Theorem). Let A, B ∈Herm(H) be Hermitian matrices, with
spectra λ0 ⩽λ1 ⩽. . . and µ0 ⩽µ1 ⩽. . . respectively. Then
max
j
|λj −µj| ⩽∥A −B∥.
Proof of Proposition 6.
Write H = ⊗n
i=1Hi, where Hi = C3 is a single qutrit site. By Deﬁnition 4,
we have two encodings Eobs and ˜Eobs of the form (using that H is real to set Q = 0 without loss of
generality)
Eobs(M) = V (M ⊗P)V † ,
˜Eobs(M) = ˜V (M ⊗P) ˜V † ,
where P is a projector on the ancillary space A, and V, ˜V are both isometries H ⊗A →H′. These
encodings satisfy the properties:
• Eobs is a local encoding, in the sense that A = ⊗n
i=1Ai and V = ⊗n
i=1Vi where Vi : Hi ⊗Ai →
H′
i. Here we write H′
i ∼= (C2)⊗mi for the set of mi qubits into which qutrit i is encoded. Note
P
i mi = m.
• ˜Eobs satisﬁes
˜Eobs(I) = ˜V (I ⊗P) ˜V † = P⩽∆(H′n) ,
where P⩽∆(H′n) is the low-energy (below ∆) projector for H′
n, and
∥P⩽∆(H′n)H′
nP⩽∆(H′n) −˜Eobs(Hn)∥⩽ε .
(7)
• Eobs and ˜Eobs are close, in the sense that
∥V −˜V ∥⩽η .
Now we deﬁne a state τ ∈span(P) and deﬁne a state encoding (as in (1))
˜Estate(ρ) = ˜V (ρ ⊗τ) ˜V † .
Let ρ0 = ˜Estate(|↓⟩⟨↓|⊗n) be the encoded ground state of Hn, which by deﬁnition satisﬁes
P⩽∆(H′n)ρ0 = ρ0 ,
˜Eobs(Hn)ρ0 = 0 .
30

Hence we can bound the energy of ρ0 under H′
n by
tr[H′
nρ0] = tr[P⩽∆(H′n)H′
nP⩽∆(H′n)ρ0]
= tr[(P⩽∆(H′n)H′
nP⩽∆(H′n) −˜Eobs(Hn))ρ0]
⩽∥P⩽∆(H′n)H′
nP⩽∆(H′n) −˜Eobs(Hn)∥
⩽ε .
(8)
Now without loss of generality we assume that m1 = mini mi. Notice that V1 : H1 ⊗A1 →H′
1
cannot be surjective, since
dim(H1 ⊗A1) = 3 dim A1 ̸= 2m1 .
We can therefore choose some pure state ψ = |ψ⟩⟨ψ| in H′
1 which is orthogonal to the image of V1,
and deﬁne
ρ1 = ψ ⊗tr1[ρ0] ∈Lin(H′) ,
Where tr1 denotes the partial trace over the H′
1 system. This satisﬁes V †ρ1 = ρ1V = 0, so we have
tr[P⩽∆(H′n)ρ1] = tr[(I ⊗P) ˜V †ρ1 ˜V ]
⩽tr[ ˜V †ρ1 ˜V ]
= tr[( ˜V −V )†ρ1( ˜V −V )]
⩽∥( ˜V −V )( ˜V −V )†∥
⩽η2 ,
from which we deduce that
tr[H′
nρ1] ⩾∆tr[(I −P⩽∆(H′n))ρ1] −ε tr[P⩽∆(H′n)ρ1] ⩾∆(1 −η2) −εη2 ,
using that the smallest eigenvalue of H′
n is at least −ε, by (7) and Lemma 24. Therefore, using (8),
tr[H′
n(ρ1 −ρ0)] ⩾∆(1 −η2) −ε(1 + η2) .
(9)
On the other hand, by expanding H′
n we can write
tr[H′
n(ρ1 −ρ0)] =
K
X
j=1
tr[h′
j(ρ1 −ρ0)] .
(10)
Notice that if h′
j acts trivially on H′
1, that is h′
j = I1 ⊗˜hj, then
tr[h′
j(ρ1 −ρ0)] = tr[(I1 ⊗˜hj)(ψ ⊗tr1 ρ0 −ρ0)]
= tr1[ψ] tr2,3,...[˜hj tr1[ρ0]] −tr[(I ⊗˜hj)ρ0]
= 0 .
Hence the only non-zero contributions to (10) come from j in the set
I1 = {1 ⩽j ⩽K | h′
j acts non-trivially on H′
1} .
So (10) can be bounded by
tr[H′
n(ρ1 −ρ0)] =
X
j∈I1
tr[h′
j(ρ1 −ρ0)] ⩽2|I1| max
j∈I1 ∥h′
j∥,
(11)
using the Hölder inequality for Schatten p-norms.
31

Now notice that, since the largest eigenvalue of Hn is n, and the encoding ˜Eobs preserves spectra,
we have
∥˜Eobs(Hn)∥= ∥Hn∥= n ,
so by (7) and Lemma 24
∥P⩽∆(H′n)H′
nP⩽∆(H′n)∥⩾n −ε .
Hence, by the deﬁnition of P⩽∆(H′n), we must have ∆> n −ε. Combining this fact with (9) and
(11), we deduce that
max
j∈I1 ∥h′
j∥>
1
2|I1|
 (n −ε)(1 −η2) −ε(1 + η2)

.
Finally, note that m1 ⩽m/n = O(nα) and |I1| ⩽dm1, so for large n we have the desired scaling
max
j∈I1 ∥h′
j∥⩾Ω
 n1−α(1 −η2)

.
■
B.2
Gadget characterisation
In this section, we give the proofs of Theorems 11 and 12. The former is quite simple, but the latter
requires several preparatory lemmas. In particular, we will make heavy use of the direct rotation
— for a detailed introduction see [BDL11]. We summarise the basic deﬁnitions and properties here
without proof.
The direct rotation
Consider two states |ψ⟩, |φ⟩lying in some Hilbert space H ∼= CN. There are many unitary matrices
U ∈U(H) which rotate between these states (that is, U |ψ⟩= |φ⟩), but a particularly natural choice
is the unitary Uψ→φ which rotates only within the subspace spanned by |ψ⟩and |φ⟩. Deﬁning the
reﬂections Rψ = I −2|ψ⟩⟨ψ| and Rφ = I −2|φ⟩⟨φ|, we can write
Uψ→φ =
p
RφRψ ,
assuming it is well-deﬁned. This is the direct rotation from |ψ⟩to |φ⟩.
This construction can be generalised to rotations between subspaces:
Deﬁnition 25 (Direct rotation). Let P and Q be linear subspaces of equal dimension corresponding
to orthogonal projectors P and Q respectively. Deﬁne
RP = I −2P ,
RQ = I −2Q ,
then direct rotation between P and Q is
UP→Q =
p
RQRP ,
where the square root is taken with a branch cut along the negative axis and such that
√
1 = 1.
This is well-deﬁned whenever ∥P −Q∥< 1.
Then UP→Q satisﬁes
UP→QPU †
P→Q = Q .
Moreover, as shown in [BDL11], the direct rotation may be written in terms of its generator: an
anti-Hermitian operator S = −S† which can be chosen so that UP→Q = eS, with ∥S∥< π/2 and
32

which is oﬀ-diagonal with respect to both P and Q:
PSP = (I −P)S(I −P) = QSQ = (I −Q)S(I −Q) = 0 .
Notice that, writing S = i diag(θ1, θ2, . . . , θn) for θj ∈(−π/2, π/2), we have
∥UP→Q −I∥= max
j
|2 sin(θj/2)| ,
∥S∥= max
j
|θj| ,
and hence
∥S∥⩽
π
2
√
2
∥UP→Q −I∥.
(12)
B.2.1
The gadget property from gadgets
Proof of Theorem 11.
This follows directly from the deﬁnition, since for any Helse ∈Herm(H), we
have
∥P ′(H′ + Helse ⊗I)P ′ −U
 (H + Helse) ⊗P

U †∥
⩽∥P ′H′P ′ −U(H ⊗P)U †∥+ ∥P ′(Helse ⊗I)P ′ −U(Helse ⊗P)U †∥.
The ﬁrst term is bounded by ε by deﬁnition, and the second term can be bounded using
∥P ′(Helse ⊗I)P ′ −U(Helse ⊗P)U †∥
= ∥(I ⊗P)U †(Helse ⊗I)U(I ⊗P) −Helse ⊗P∥
⩽2η∥Helse∥.
Hence Deﬁnition 9 is satisﬁed, putting ˜P = P and ˜UHelse := U for all Helse.
■
B.2.2
Gadgets from the gadget property
The proof of Theorem 12 requires Lemma 26, a basic linear algebra fact which we prove here for
convenience. Two projectors P and Q commute if and only if they are simultaneously diagonalisable,
in which case PQP is also a projector. This lemma says that this is also true in the approximate
setting: [P, Q] is small if and only if PQP is close to some projector ˜P.
Lemma 26. Let P, Q ∈Proj(H) be projectors, and deﬁne
f(P, Q) :=
min
˜P ∈Proj(H)
∥PQP −˜P∥.
Then
∥[P, Q]∥=
p
f(P, Q) −f(P, Q)2 .
Proof of Lemma 26.
Write P and Q in the block-diagonal basis of P, so that
P =
I
0
0
0

,
Q =
 A
B
B†
C

,
for some matrices A, B, C. The requirement Q ∈Proj(H) implies that BB† = A(I −A). We have
PQP =
A
0
0
0

.
33

Let {λj}j be the eigenvalues of A; notice that these satisfy 0 ⩽λj ⩽1, since 0 ⩽PQP ⩽Q. Then
f(P, Q) is given by
f(P, Q) = max
j
 min{|λj|, |1 −λj|}

.
(13)
To see why (13) holds, note that the upper bound on f follows by constructing ˜P to have the same
eigenvectors as PQP, but with each eigenvalue replaced by either 0 or 1 depending on which is
closer. The lower bound follows from Lemma 24.
Now we can compute
−[P, Q]2 =
BB†
0
0
B†B

,
hence
∥[P, Q]∥2 = ∥−[P, Q]2∥= ∥BB†∥= ∥A(I −A)∥= max
j
|λj||1 −λj| .
(14)
Note that the maximising j in (13) and (14) must be the same (the functions min{|λ|, |1 −λ|} and
|λ||1 −λ| are both maximised by the λj closest to 1/2), hence we can deduce
∥[P, Q]∥2 = f(P, Q)
 1 −f(P, Q)

,
which gives the result.
■
In order to obtain the correct unitary U in Deﬁnition 10, the proof of Theorem 12 requires con-
structing rotations between eigenspaces of diﬀerent operators.
The Davis-Kahan sin θ theorem
below provides a bound on the size of these rotations. This is also used in the proof of Proposi-
tion 22.
Lemma 27 (Davis-Kahan sin θ theorem [DK69]). Let A, B ∈Herm(H), and take PA, PB ∈Proj(H)
projectors of equal rank which block-diagonalise A and B respectively, so that
A = PAAPA + P ⊥
A AP ⊥
A ,
B = PBBPB + P ⊥
B BP ⊥
B .
Assume α, β ∈R and λgap are such that
spec
 A|PAH

⊂[α, β] ,
spec
 B|P ⊥
B H

⊂R \ (α −λgap, β + λgap) .
Then the direct rotation U ∈U(H) from PA to PB satisﬁes
∥U −I∥⩽
√
2
λgap
∥(B −A)PA∥.
Proof of Lemma 27.
The statement found in [DK69] is phrased in terms of a matrix Θ0 =
diag(θ1, θ2, . . . , θn), where the eigenvalues (possibly excluding some 1’s) of U are given by eiθj and
π/2 ⩾θ1 ⩾θ2 ⩾· · · ⩾θn. Speciﬁcally, the authors give the following result:
λgap∥sin Θ0∥⩽∥(B −A)PA∥.
To recover our restatement of the theorem, we use the identity |1 −eiθ| = |2 sin(θ/2)| to deduce
that
∥U −I∥= |2 sin(θ1/2)| ⩽
√
2| sin θ1| =
√
2∥sin Θ0∥.
■
The following lemmas from [BDLT08] are used extensively in the rest of the gadget proofs. They
provide bounds on a series expansion of eSHe−S, for S small and anti-Hermitian, in particular
34

showing that
eSHe−S = H + [S, H] + 1
2![S, [S, H]] + 1
3![S, [S, [S, H]]] + . . . .
Lemma 28 (Lemma 1 from [BDLT08]). Let S be an anti-Hermitian operator. Deﬁne a superopera-
tor adS such that adS(X) = [S, X], and let adk
S be the k-fold composition of adS, with ad0
S(X) = X.
For any operator H deﬁne r0(H) = ∥eSHe−S∥= ∥H∥, r1(H) = ∥eSHe−S −H∥, and
rk(H) = ∥eSHe−S −
k−1
X
p=0
1
p! adp
S(H)∥,
k ⩾2 .
Then for all k ⩾0 one has
rk(H) ⩽1
k!∥adk
S(H)∥.
Lemma 29 (Lemma 2 from [BDLT08]). Let S = P
i Si and H = P
j Hj be any O(1)-local operators
acting on n qubits with interaction strengths JS and JH respectively (i.e. ∥Si∥⩽JS and ∥Hj∥⩽JH
for all i and j). Let each qubit be acted on non-trivially by O(1) terms in both S and H. Then, for
any k = O(1),
∥adk
S(H)∥= O(nJk
SJH) .
These lemmas provide us with the necessary tools to prove Theorem 12.
Proof of Theorem 12.
The idea of the proof is as follows.
By Deﬁnition 9, we have
∥P ′(H′ + Helse ⊗I)P ′ −˜UHelse
 (H + Helse) ⊗˜P
 ˜U †
Helse∥⩽ε + ζ∥Helse∥,
(15)
for any Helse ∈Herm(H).
1. First we consider (15) the case where Helse dominates the expression, and argue that that P ′
is “almost” a projector I ⊗P on A.
2. Next, by setting Helse = 0 in (15), we observe that P ′H′P ′ has approximately the same
spectrum as H ⊗P.
3. By setting Helse = −H in (15), we argue that P ′H′P ′ ≈H ⊗P.
4. Using steps 2 and 3, and Lemma 27, we construct a rotation U such that ∥P ′H′P ′ −U(H ⊗
P)U †∥⩽ε, by inductively rotating each eigenspace.
Here we start step 1. Assume that ∥Helse∥= 1, and let λ > 0. Then putting Helse 7→λHelse in (15)
yields
∥P ′(Helse ⊗I)P ′ −˜UλHelse(Helse ⊗˜P) ˜U †
λHelse∥⩽ζ + O(λ−1) ,
for large λ, which in particular, by Lemma 24, implies that P ′(Helse ⊗I)P ′ has the same spectrum
as Helse ⊗˜P, up to error ζ. (That is, the kth smallest eigenvalue, counted with multiplicity, of
P ′(Helse ⊗I)P ′, diﬀers from that of Helse ⊗˜P by an absolute error of at most ζ.)
In particular, if Helse = Q ∈Proj(H) is a projection, then so is P ′(Q ⊗I)P ′ (up to spectral error
ζ). Hence by Lemma 26, we have
∥[P ′, Q ⊗I]∥⩽
p
ζ .
Without loss of generality we may assume that dim H = K = O(1), by disregarding all the systems
on which H, H′, and P ′ do not act. So by writing Helse as a linear combination of at most K
projections, we have
∥[P ′, Helse ⊗I]∥⩽πK
p
ζ ,
35

for all Helse ∈Herm(H) with ∥Helse∥⩽π.
Therefore, for any V ∈U(H), we can write V = eiHelse for some Helse as above, and then by
Lemma 28,
∥(V ⊗I)P ′(V † ⊗I) −P ′∥⩽πK
p
ζ .
Integrating over all V ∈U(H) using the Haar measure (normalised with
R
dV = 1) yields

Z
dV (V ⊗I)P ′(V † ⊗I) −P ′
 ⩽πK
p
ζ ,
but
Z
dV (V ⊗I)P ′(V † ⊗I) = K−1IH ⊗trH[P ′] ,
hence
∥P ′ −IH ⊗K−1 trH[P ′]∥⩽πK
p
ζ .
In particular, this implies that K−1 trH[P ′] has spectrum in [−πK√ζ, πK√ζ] ∪[1 −πK√ζ, 1 +
πK√ζ] (where for suﬃciently small ζ there will be a gap), so there exists a projector P ∈Proj(A)
such that
∥P ′ −I ⊗P∥⩽πK
p
ζ .
Now we can apply Lemma 27, using A = PA = P ′, B = PB = I ⊗P, and λgap = 1. Then for ζ
small enough, the direct rotation W from I ⊗P to P ′ satisﬁes
P ′ = W(I ⊗P)W † ,
∥W −I∥⩽
√
2πK
p
ζ ,
(16)
which completes step 1. Without loss of generality we can now adjust the ˜UHelse so that ˜P = P.
Hence for all Helse ∈Herm(H) we have
∥P ′(H′ + Helse)P ′ −˜UHelse
 (H + Helse) ⊗P
 ˜U †
Helse∥⩽ε + ζ∥Helse∥.
With the above expression, we can begin steps 2 and 3. Putting Helse = 0, this becomes
∥P ′H′P ′ −˜U(0)(H ⊗P) ˜U †(0)∥⩽ε ,
(17)
and putting Helse = −H we have
∥P ′H′P ′ −P ′(H ⊗I)P ′∥⩽ε + ζ∥H∥.
(18)
Moreover, by (16) we can bound
∥P ′(H ⊗I)P ′ −H ⊗P∥= ∥W(I ⊗P)W †(H ⊗I)W(I ⊗P)W † −H ⊗P∥
= ∥(W −I)(I ⊗P)W †(H ⊗I)W(I ⊗P)W †
+ (I ⊗P)(W † −I)(H ⊗I)W(I ⊗P)W †
+ (H ⊗P)(W −I)(I ⊗P)W †
+ (H ⊗P)(W † −I)∥
⩽4∥H∥· ∥W −I∥
⩽4
√
2πK
p
ζ∥H∥.
(19)
Combining (18) and (19), we complete step 3:
∥P ′H′P ′ −H ⊗P∥⩽ε + (ζ + 4
√
2πK
p
ζ)∥H∥:= δ .
(20)
Now we begin step 4. Let H(0) = H ⊗P. Write the eigenvalues of this operator as {λk}M+1
k=1 , where
36

λ1 = 0 and 0 < λ2 < · · · < λM+1 are the M distinct eigenvalues of H. If H has any non-positive
eigenvalues, then we shift both H and H′ by a O(1) factor of the identity for the duration of
the proof; notice that Deﬁnition 9 then still holds up to a redeﬁned ε which does not aﬀect the
conclusions of this theorem. We deﬁne
λgap = min
j̸=k |λj −λk| ,
which is O(1) since H acts on O(1) sites, and does not scale with η or ε. Let Pk be the eigenspace
of H(0) corresponding to λk.
We also diagonalise P ′H′P ′ — see Fig. 11. By (17) and Weyl’s inequality we can write the eigen-
values as {µ(ik)
k
} such that
|µ(ik)
k
−λk| ⩽ε ,
for all ik, and for all k.
Let P′
k be the eigenspace of P ′H′P ′ corresponding to the eigenvalues {µ(ik)
k
}ik, which by (17)
satisﬁes dim P′
k = dim Pk for ε suﬃciently small. Note that for j ̸= k we have
|µ(ij)
j
−λk| ⩾λgap −ε .
We aim to construct a unitary operator which rotates all of the Pi onto the P′
i eigenspaces. We
do this by induction, deﬁning W (k) to be a unitary operator which performs these rotations for
i = 1, . . . , k. Moreover the deﬁne H(k) = W (k)H(0)(W (k))† to be the version of H ⊗P whose ﬁrst k
eigenspaces have been rotated in this way. We will use bounds on the direct rotation provided by
Lemma 27; we will see that the direct rotations are be well-deﬁned for suﬃciently small η and ε.
The inductive construction we use will bound the rotations by ∥W (k) −I∥⩽ωk, where
ωk =
δ
2∥H∥

1 + 2
√
2∥H∥
λgap −ε
k
−1

.
Energy
P ′H′P ′
H ⊗P
P1
P2
P3
P′
1
P′
2
P′
3
λgap
ε
Figure 11: The degenerate eigenvalues of H ⊗P are approximated by eigenvalues of P ′H′P ′ up
to error ε, corresponding to eigenspaces P′
i. We construct a unitary operator which rotates the
eigenspaces Pi onto the P′
i
We now inductively deﬁne the H(k) ∈Herm(H ⊗A) and W (k) ∈U(H ⊗A) as described above. For
the base case, we see that clearly H(0) satisﬁes the conditions with the trivial W (0) = I.
37

For the inductive step, suppose we are given H(k−1) and W (k−1). Notice that
∥P ′H′P ′ −H(k−1)∥⩽δ + 2ωk−1∥H∥,
(21)
using (20) and the bound ∥W (k−1) −I∥⩽ωk−1. Hence, applying Lemma 27 to (P ′H′P ′)|⊕j⩾kP′
j,
and H(k−1)|⊕j⩾kP′
j, we may construct the direct rotation V (k) on ⊕j⩾kP′
j which maps from
W (k−1)Pk(W (k−1))† to P′
k, and which satisﬁes
∥V (k) −I∥⩽
√
2
λgap −ε∥(P ′H′P ′)|⊕j⩾kP′
j −(H(k−1))|⊕j⩾kP′
j∥
⩽
√
2
λgap −ε(δ + 2ωk−1∥H∥) .
For the above step, it is necessary to verify that the direct rotation is well-deﬁned. If it were not,
then there would be a nonzero vector |ψ⟩∈W (k−1)P(W (k−1))† ∩(P′
k)⊥. Then, by the deﬁnition of
these subspaces,
⟨ψ| P ′H′P ′ |ψ⟩⩾λk+1 −ε ⩾λk + (λgap −ε) ,
⟨ψ| H(k−1) |ψ⟩= λk ,
which would imply that
∥P ′H′P ′ −H(k−1)∥⩾λgap −ε .
By (21), this is prohibited for suﬃciently small η and ε — so we can safely assume that the direct
rotation is well-deﬁned.
Now we can let
W (k) = (I⊕j<kP′
j ⊕V (k))W (k−1) ,
and
H(k) = W (k)H(0)(W (k))† ,
which satisﬁes
∥W (k) −I∥⩽ωk−1 +
√
2
λgap −ε(δ + 2ωk−1∥H∥) = ωk .
After M + 1 inductive steps, we have constructed the operator
H(M+1) = W (M+1)(H ⊗P)(W (M+1))† ,
whose λk-eigenspace is P′
k for all k. Hence
∥P ′H′P ′ −W (M+1)(H ⊗P)(W (M+1))†∥⩽ε .
Moreover, since H′ has no zero eigenvalues (since otherwise we shifted by a factor of the identity),
we are guaranteed that the null space of H ⊗P is exactly that of (I ⊗P), and the null space of
P ′H′P ′ is exactly that of P ′. Hence by construction of W (M+1),
P ′ = W (M+1)(I ⊗P)(W (M+1))† .
We have therefore shown that (H′, A) is a gadget in the sense of Deﬁnition 10, using U = W (M+1),
with accuracy ε (possibly with an additional O(η) if shifting of H′ was necessary earlier in the
proof) and η = O(ε) + O(√ζ) given explicitly by
η = ωM+1 =
1
2∥H∥

2
√
2
λgap −ε∥H∥+ 1
M
−1

ε + (ζ + 4
√
2πK
p
ζ)∥H∥

.
■
38

B.3
Gadget energy scaling
In this section, we prove Theorem 14. Firstly, we introduce the notion of a k-local function, which
can be thought of as a classical k-local observable on a state space {0, 1}n.
Deﬁnition 30 (k-local function). Let f : {0, 1}n →R be a function. We say that f is k-local if it
can be written as a sum of functions
f(x1, x2, . . . , xn) =
X
i
fi(x1, x2, . . . , xn) ,
where the fi : {0, 1}n →R each depend on at most k of their inputs.
The following simple lemmas show that there exist k-local functions which cannot be approximated
well by k′-local functions for k′ < k.
Lemma 31. Let f be a k-local function on n inputs. Then Rf : {0, 1}n−1 →R, deﬁned by
Rf(x1, . . . , xn−1) = f(x1, . . . , xn−1, 0) −f(x1, . . . , xn−1, 1)
is (k −1)-local.
Proof of Lemma 31.
Decomposing f = P
i fi as in Deﬁnition 30, note that any fi which does not
depend on xn has Rfi = 0. Moreover, any fi which does depend on xn depends on at most (k −1)
other inputs, hence Rfi is (k −1)-local.
■
Lemma 32. Let k
> k′
> 0.
There exists a k-local function f
: {0, 1}n
→R with
maxx∈{0,1}n |f(x)| ⩽1 such that for any k′-local function g : {0, 1}n →R,
max
x∈{0,1}n |f(x) −g(x)| ⩾2−k′ .
Proof of Lemma 32.
For any r ⩾1, we can deﬁne Rrf : {0, 1}n−r →R by
Rrf(x1, . . . , xn−r) =
X
xn−r+1,...,xn∈{0,1}
(−1)
Pr
j=1 xn−r+jf(x1, . . . , xn) .
(22)
Applying Lemma 31 inductively, note that Rrf is (k −r)-local. In particular, Rk′g is constant for
any k′-local g.
Let ˜f : {0, 1}n−k′ →R be the (k −k′)-local function given by
˜f(x1, . . . , xn−k′) = (−1)
Pk−k′
i=1
xi .
(23)
Then deﬁne
f(x1, . . . , xn) =
 ˜f(x1, . . . , xn−k′)
if
xn−k′+1 = · · · = xn = 0
0
otherwise
.
Note that Rk′f = ˜f. Since ˜f can take values ±1 yet Rk′g is constant, there must exist y ∈{0, 1}n−k′
such that
|Rk′f(y) −Rk′g(y)| ⩾1 ,
39

and hence, expanding Rk′f(y) and Rk′g(y) using (22) into 2k′ terms of f and g, we must have
max
x∈{0,1}n |f(x) −g(x)| ⩾2−k′ .
■
Note that Lemma 32 uses a single illustrative function given by (23) (which appears in the proof
of Theorem 14), but a similar argument could apply to most k-local functions; the vector space of
k-local functions has a higher dimension than that of k′-local functions.
The following proof uses the intuition from Lemma 32 to argue that the target k-local term cannot
be reproduced by a k′-local Hamiltonian.
Proof of Theorem 14.
By Deﬁnition 10, we have U ∈U(H ⊗A) and P ∈Proj(A) such that
∥U −I∥⩽η ,
∥P ′H′P ′ −U(H ⊗P)U †∥⩽ε ,
where P ′ = U(I ⊗P)U † .
For any given x ∈{0, 1}k, deﬁne |ψx⟩∈H to be the pure state whose ith qubit is in the state |xi⟩.
Moreover let |φ⟩∈A be some state satisfying P |φ⟩= |φ⟩. Then deﬁne functions F, f : {0, 1}k →R
by
F(x) = tr[H|ψx⟩⟨ψx|] ,
f(x) = tr[H′ |ψx⟩⟨ψx| ⊗|φ⟩⟨φ|

] .
Notice that F and f are k- and k′-local respectively, and by Lemma 32 there exists some y ∈{0, 1}k
such that
|F(y) −f(y)| ⩾2−k′J .
On the other hand, for all x ∈{0, 1}k we have
|F(x) −f(x)| = | tr[(H ⊗P)(|ψx⟩⟨ψx| ⊗|φ⟩⟨φ|)] −tr[H′(|ψx⟩⟨ψx| ⊗|φ⟩⟨φ|)]|
⩽∥(I ⊗P)H′(I ⊗P) −H ⊗P∥
= ∥P ′UH′U †P ′ −U(H ⊗P)U †∥
⩽ε + ∥P ′(H′ −UH′U †)P ′∥
⩽ε + 2η∥H′∥.
Hence we must have scaling
∥H′∥⩾2−k′J −ε
2η
,
as required.
■
B.4
Gadget combination
B.4.1
Combination of general gadgets
Here we introduce some preparatory lemmas before proving Proposition 21.
The ﬁrst lemma allows us to immediately reduce gadgets to the case that U (in Deﬁnition 10) is a
direct rotation, deﬁned in Deﬁnition 25. This allows us to write U = eS for S the generator of the
direct rotation — the oﬀ-diagonal properties of S will simplify calculations considerably.
40

Lemma 33. Suppose (H′, A) is a (η, ε)-gadget for H, where η <
√
2. Let ˜ε = ε + 4η∥H∥.
Then (H′, A) is also a (η, ˜ε)-gadget for H, where the unitary U in Deﬁnition 10 can be assumed to
be the direct rotation W [BDL11] between the subspaces deﬁned by (I ⊗P) and P ′.
Proof of Lemma 33.
By Deﬁnition 10 we have U such that
P ′ = U(I ⊗P)U † ,
∥U −I∥⩽η .
As noted in [DK70], the direct rotation W between (I ⊗P) and P ′ minimises ∥W −I∥subject to
the ﬁrst equality above, hence we have
P ′ = W(I ⊗P)W † ,
∥W −I∥⩽η .
So
∥P ′H′P ′ −W(H ⊗P)W †∥⩽ε + ∥U(H ⊗P)U † −W(H ⊗P)W †∥
⩽ε + ∥U(H ⊗P)U † −H ⊗P∥
+ ∥W(H ⊗P)W † −H ⊗P∥
⩽ε + 4η∥H∥.
■
A gadget H′ for H as in Deﬁnition 10 has ∥P ′H′P ′∥⩽∥H∥+ ε by deﬁnition, however outside the
span of P ′ there are no bounds on H′. For η small, P ′ will be close to the projector I ⊗P. The
following lemma provides a bound for H′ when instead restricted to the span of I ⊗P.
Lemma 34. Suppose (H′, A) is a (η, ε)-gadget for H, with U, P ′, and P as in Deﬁnition 10, and
where U is the direct rotation between (I ⊗P) and P ′. Assume ∥H′∥⩽J′, and
∥(I ⊗P)H′(I ⊗P ⊥)∥⩽J′
O .
Then
∥(I ⊗P)H′(I ⊗P)∥⩽∥H∥+ O(ε + ηJ′
O + η2J′) .
Proof of Lemma 34.
Let S be the generator of the direct rotation U, so that ∥S∥= O(η) (see
(12)) satisﬁes
P ′ = eS(I ⊗P)e−S .
Hence
∥(I ⊗P)H′(I ⊗P)∥⩽∥(I ⊗P)(e−SH′eS −H′)(I ⊗P)∥+ ∥P ′H′P ′∥.
By Deﬁnition 10, we have ∥P ′H′P ′∥⩽∥H∥+ ε, and using Lemma 28 we can bound the ﬁrst term
as
∥(I ⊗P)(e−SH′eS −H′)(I ⊗P)∥⩽∥(I ⊗P)[S, H′](I ⊗P)∥+ O(η2J′) .
Furthermore, since S is oﬀ-diagonal with respect to (I ⊗P) we have
∥(I ⊗P)[S, H′](I ⊗P)∥⩽O(ηJ′
O) ,
completing the proof.
■
We now have the necessary tools to prove the gadget combination result Proposition 21. We are
provided with the gadgets (H′
i, Ai) for each of the Hi (corresponding to Ui, Pi, P ′
i as in Deﬁnition 10),
41

which immediately suggest using P = ⊗iPi for the gadget H′ = P
i H′
i for H = P
i Hi. It is not
immediately clear what unitary U, and hence projector P ′, should be used here, since the Ui do
not necessarily commute so cannot be naïvely composed. The direct rotation provides a natural
choice, however; writing Ui = eSi for all i, we can choose U = e
P
i Si. The content of the proof is
just a long computation to verify that this choice indeed satisﬁes the gadget deﬁnition.
The following proof is a generalisation of that in [BDLT08], in which similar techniques are used.
Proof of Proposition 21.
We begin by reducing to the case of the direct rotation. By Lemma 33,
we may replace ε with
˜ε = ε + 4ηJ = O(ε + ηJ) ,
and hence assume that each gadget (H′
i, Ai) uses the direct rotation Ui = eSi. Speciﬁcally, there
exists Pi ∈Proj(Ai) such that
∥(I ⊗Pi)e−SiH′
ieSi(I ⊗Pi) −Hi ⊗Pi∥⩽˜ε ,
(24)
where Si is the generator of the direct rotation between the projectors I⊗Pi and P ′
i := eSi(I⊗Pi)e−Si.
We have ∥Si∥⩽O(η) and Si is an anti-Hermitian operator which is block oﬀ-diagonal with respect
to the projectors I ⊗Pi and P ′
i [BDL11].
We deﬁne the operators
P := ⊗iPi ∈Proj(⊗iAi) ,
S =
X
i
Si .
We now use the triangle inequality along with Lemmas 28-29 to bound
∥(I ⊗P)e−SH′eS(I ⊗P) −H ⊗P∥
⩽
X
i
∥(I ⊗P)(H′
i −[S, H′
i] + 1
2[S, [S, H′
i]] −1
6[S, [S, [S, H′
i]]])(I ⊗P)
−Hi ⊗P∥+ O(nη4J′) .
Now we bound the terms in the norm separately, using that Sj is block-oﬀ-diagonal with respect
to (I ⊗Pj), and that (I ⊗Pj) commutes with H′
k and Sk if j ̸= k.
• (I ⊗P)[S, H′
i](I ⊗P):
Expanding S = P
j Sj, notice that (I ⊗P)[Sj, H′
i](I ⊗P) = 0 whenever j ̸= i, since then we
can commute (I ⊗Pj) past H′
i. Hence
(I ⊗P)[S, H′
i](I ⊗P) = (I ⊗P)[Si, H′
i](I ⊗P) .
• (I ⊗P)[S, [S, H′
i]](I ⊗P):
Note that if j ̸= k, then
(I ⊗P)[Sj, [Sk, H′
i]](I ⊗P) = 0 ,
since at least one of them must be also diﬀerent to i. Then, for instance if j ̸= i, we can
commute (I ⊗Pj) past H′
i and Sk. Hence it remains to consider terms of the form
(I ⊗P)[Sj, [Sj, H′
i]](I ⊗P) .
In this case, if j ̸= i, then we have
∥(I ⊗P)[Sj, [Sj, H′
i]](I ⊗P)∥⩽4∥Sj∥2∥(I ⊗Pi)H′
i(I ⊗Pi)∥
⩽O(η2J + η3J′
O + η4J′) ,
42

using Lemma 34. Hence
(I ⊗P)[S, [S, H′
i]](I ⊗P) = (I ⊗P)[Si, [Si, H′
i]](I ⊗P) + O(η2J + η3J′
O + η4J′) .
• (I ⊗P)[S, [S, [S, H′
i]]](I ⊗P):
Here we consider terms of the form (I⊗P)[Sj, [Sk, [Sl, H′
i]]](I⊗P) in various situations. Firstly,
note that if none of j, k, l are equal to i then we can commute (I ⊗Pi) into the commutator
to obtain
∥(I ⊗P)[Sj, [Sk, [Sl, H′
i]]](I ⊗P)∥⩽8∥Sj∥∥Sk∥∥Sl∥∥(I ⊗Pi)H′
i(I ⊗Pi)∥
⩽O(η3J + η4J′
O + η5J′) ,
by Lemma 34, neglecting the O(η2η) term.
If exactly two of the j, k, l are equal to i (k = l = i ̸= j, say), then we can commute (I ⊗Pj)
past the other terms to kill the Sj term, and the expression vanishes.
If exactly one of the j, k, l is equal to i, then by commuting (I⊗Pi)Si = Si(I⊗P ⊥
i ), we arrive
at
∥(I ⊗P)[Sj, [Sk, [Sl, H′
i]]](I ⊗P)∥⩽O(η3)∥(I ⊗P ⊥
i )H′
i(I ⊗Pi)∥
= O(η3J′
O) .
Hence
(I ⊗P)[S, [S, [S, H′
i]]](I ⊗P) = (I ⊗P)[Si, [Si, [Si, H′
i]]](I ⊗P)
+ O(η3J + η3J′
O + η5J′) .
So putting the above bounds together and applying Lemma 28, we obtain
∥(I ⊗P)e−SH′eS(I ⊗P) −H ⊗P∥⩽
X
i
∥(I ⊗P)e−SiH′
ieSi(I ⊗P) −Hi ⊗P∥
+ O(nη2J + nη3J′
O + nη4J′)
⩽O(nε + nηJ + nη3J′
O + nη4J′) ,
(25)
where the last inequality follows because the H′
i are gadgets for the Hi.
Noting also that ∥eS −I∥= O(nη), this completes the proof that (H′, A) is a (η′, ε′)-gadget for H
as required.
■
B.4.2
Combination of low-energy gadgets
Having proved Proposition 21, we know that the H′ from Proposition 22 is an (η′, ε′)-gadget for
H in the sense of Deﬁnition 10. It remains to prove that it is in fact a (∆′, η′, ε′)-gadget, which
requires replacing the projector ˜P = eS(I⊗P)e−S in (25) by a low-energy projector P⩽∆′(H′). This
requires the use of the following corollary to the Davis-Kahan sin θ theorem (Lemma 27).
Lemma 35. Let A ∈Herm(H), and let P ∈Proj(H) be a projector of the same rank as P⩽∆(A),
where P⩽∆(A) ∈Proj(H) is the projector onto the eigenvectors of A with eigenvalues less than ∆.
Suppose that ∥PAP∥⩽λ.
43

Then, for any ∆> λ, the direct rotation U ∈U(H) from P to P⩽∆(A) satisﬁes
∥U −I∥⩽
√
2
∆−λ∥P ⊥AP∥.
Proof of Lemma 35.
Follows from Lemma 27 using A 7→PAP, B 7→A.
■
Proof of Proposition 22.
By Proposition 21, we have
τ := ∥(I ⊗P)e−SH′eS(I ⊗P) −H ⊗P∥⩽O(nε + nηJ + nη3J′
O + nη4J′) .
Letting ˜P = eS(I ⊗P)e−S and the triangle inequality, this gives
∥˜PH′ ˜P∥⩽∥H∥+ τ .
(26)
We seek to use Lemma 35 to argue that ˜P is “close to” P⩽∆′(H′). To do this, we start by bounding
∥˜PH′ ˜P ⊥∥. We have
∥˜PH′ ˜P ⊥∥= ∥(I ⊗P)e−SH′eS(I ⊗P ⊥)∥
⩽
X
i
∥(I ⊗P)e−SH′
ieS(I ⊗P ⊥)∥,
(27)
by the triangle inequality. For each i, we deﬁne ˜Hi = e−SiH′
ieSi. Note that this operator is block
diagonal in the basis of the projector (I⊗Pi), in which Si is block oﬀ-diagonal. Note also that each
˜Hi acts on O(1) sites. Now we can write
∥˜PH′ ˜P ⊥∥⩽
X
i
∥(I ⊗P)e−SeSi ˜Hie−SieS(I ⊗P ⊥) .
From here we use Lemma 28 to expand
eSi ˜Hie−Si = ˜Hi + [Si, ˜
Hi] + Ri ,
where Ri acts on O(1) sites, and by Lemma 29 we can bound ∥Ri∥= O(J′η2). Hence
e−SeSi ˜Hie−SieS = ˜Hi + [Si, ˜Hi] + Ri
−[S, ˜Hi + [Si, ˜Hi] + 1
2[Si, [Si, ˜Hi]] + Ri]
+ ˜Ri ,
where the remainder ˜Ri is similarly obtained by Lemmas 28-29 with ∥˜Ri∥= O(Jη2). Then, using
that Si, ˜Hi, and Ri each act on O(1) sites, we can estimate
e−SeSi ˜Hie−SieS = ˜Hi −
X
j̸=i
[Sj, ˜Hi] + O(J′η2) .
But note that, if j ̸= i, then [Sj, ˜Hi] is block-diagonal with respect to (I ⊗Pk) for all k. Hence
(I ⊗P)e−SeSi ˜Hie−SieS(I ⊗P ⊥) = O(Jη2) ,
and so, inserting into (27), we have
∥˜PH′ ˜P ⊥∥:= ω = O(nJ′η2) .
(28)
44

Now we show that the restriction of H′ to the image of ˜P ⊥has high-energy eigenvalues.
Let
|ψH⟩⊗|ψAi⟩∈H ⊗Ai. We consider the expression (⟨ψH| ⊗⟨ψAi|)H′
i(|ψH⟩⊗|ψAi⟩) in two cases:
• Case 1: |ψAi⟩∈PiAi
Then
(⟨ψH| ⊗⟨ψAi|)H′
i(|ψH⟩⊗|ψAi⟩)
⩾(⟨ψ|H ⊗⟨ψAi|)P⩽∆(H′
i)H′
iP⩽∆(H′
i)(|ψH⟩⊗|ψAi⟩)
⩾(⟨ψ|H ⊗⟨ψAi|)eSi(Hi ⊗Pi)e−Si(|ψH⟩⊗|ψAi⟩) −ε
⩾⟨ψH| Hi |ψH⟩−(ε + 2Jη) .
• Case 2: |ψAi⟩∈P ⊥
i Ai
Then
(⟨ψH| ⊗⟨ψAi|)H′
i(|ψH⟩⊗|ψAi⟩)
⩾∆(⟨ψH| ⊗⟨ψAi|)P>∆(H′
i)(|ψH⟩⊗|ψAi⟩)
= ∆
 (⟨ψH| ⊗⟨ψAi|)eSi(I ⊗P ⊥
i )e−Si(|ψH⟩⊗|ψAi⟩)

⩾∆(1 −2η)
⩾⟨ψH| Hi |ψH⟩,
using that ∆(1 −2η) ⩾J for large enough n, as ∆= Θ(nJ) by assumption.
Now consider any |ψ⟩∈H ⊗(⊗iAi) of the form
|ψ⟩= eS |ψH⟩⊗(⊗i |ψAi⟩) ,
where Pj |ψAj⟩= 0 for at least one value of j. Note that such states span the image of ˜P ⊥. Then
⟨ψ| ˜P ⊥H′ ˜P ⊥|ψ⟩=
X
i
⟨ψ| H′
i |ψ⟩
⩾
X
i̸=j
 ⟨ψH| Hi |ψH⟩−ε −2Jη

+ ∆(1 −2η)
⩾⟨ψH| H |ψH⟩−(N −1)(ε + 2Jη) −J + ∆(1 −2η)
⩾∆(1 −2η) −
 ∥H∥+ J + N(ε + 2Jη)

⩾3
4∆,
(29)
where we have used the condition (4).
Now let ˜H := ˜PH′ ˜P + ˜P ⊥H′ ˜P ⊥, so that ∥H′ −˜H∥= O(nJ′η2) by (28). Based on (26) and (29),
we know that
spec ˜H ⊂[−(∥H∥+ τ), ∥H∥+ τ] ∪[3
4∆, ∞) ,
(30)
corresponding to low- and high-energy projectors ˜P and ˜P ⊥respectively. Notice that, for suﬃciently
large n, by condition (5), we will have ω < 1
2∆−(∥H∥+ τ), and hence
spec ˜H ⊂(−∞, 1
2∆−ω] ∪[3
4∆, ∞) ,
once again corresponding to subspaces deﬁned by ˜P and ˜P ⊥. Now, by Eq. (28) and Lemma 24, we
see that the full Hamiltonian H′ has a (⩽1
2∆)-low energy subspace with the same dimension as
45

the rank of ˜P, and moreover
spec H′ ⊂(−∞, ∥H∥+ ω] ∪[3
4∆−ω, ∞) .
Now set ∆′ = ∆/2. Notice that ∥˜P −P⩽∆′(H′)∥< 1, since otherwise there would be a state of energy
less than ∆′ in the image of ˜P ⊥, which is disallowed by (30). So the direct rotation W ∈U(H ⊗A)
from ˜P to P⩽∆′(H′) is well-deﬁned, and by Lemma 35
∥W −I∥⩽
√
2
1
2∆−∥H∥−τ ω .
Note that (4) in particular implies that ∆⩾4∥H∥, so 1
2∆−∥H∥⩾1
4∆= Ω(∆). By (6), this will
dominate the relatively small τ term, so using (28) and that ∆= Ω(J′) we have
∥W −I∥= O(nη2) .
We can write W in terms of its anti-Hermitian and oﬀ-diagonal generator X, W = eX, where
∥X∥= O(nη2) by (12). Then
P⩽∆′(H′) = U(I ⊗P)U † ,
where U = eXeS. Note that
∥U −I∥⩽∥eX(eS −I)∥+ ∥eX −I∥
⩽∥S∥+ ∥X∥
= O(nη) + O(nη2) = O(nη) .
It remains to bound ﬁnd ε′ to achieve a bound of the form
∥P⩽∆′(H′)H′P⩽∆′(H′) −U(H ⊗P)U †∥⩽ε′ .
Using (26) and the triangle inequality we have
∥P⩽∆′(H′)H′P⩽∆′(H′) −U(H ⊗P)U †∥⩽∥˜P(e−XH′eX −H′) ˜P∥+ τ ,
and the ﬁrst term can be bounded using Lemma 28 by
∥˜P(e−XH′eX −H′) ˜P∥⩽∥˜P[X, H′] ˜P∥+ 1
2∥[X, [X, H′]]∥
⩽2∥X∥· ∥˜PH′ ˜P ⊥∥+ 2∥X∥2 · ∥H′∥
⩽O(n3J′η4) .
In the second inequality we have used that X is oﬀ-diagonal with respect to ˜P, and in the third
inequality we have used (28) to bound ∥˜PH′ ˜P ⊥∥. Hence
ε′ = O(nε + nηJ + nη3J′
O + n3η4J′) .
■
B.4.3
Ground-state estimation with bounded-strength low-energy gadgets
The following proof of Theorem 23 is a simple corollary of Proposition 21, and generalises the proof
of [BDLT08] Theorem 1.
46

Proof of Theorem 23.
For the ﬁrst part of this proof, we seek to put a lower bound on the
individual gadgets H′
i. We write
H′
i = P⩽∆(H′
i)H′
iP⩽∆(H′
i) + P>∆(H′
i)H′
iP>∆(H′
i) ,
and consider the high- and low-energy parts separately.
For the low-energy part, we can apply the gadget deﬁnition (Deﬁnition 10) to write
∥P⩽∆(H′
i)H′
iP⩽∆(H′
i) −Hi ⊗Pi∥⩽ε + ∥eSi(Hi ⊗Pi)e−Si −Hi ⊗Pi∥
⩽O(ε + ηJ) ,
using Lemma 28, and hence
P⩽∆(H′
i)H′
iP⩽∆(H′
i) ⩾Hi ⊗Pi + O(ε + ηJ) .
(31)
For the high-energy part, we ﬁrst notice that since the spectrum of P>∆(H′
i)H′
iP>∆(H′
i) lies in (∆, ∞),
where ∆⩾∥Hi∥−ε, and so
P>∆(H′
i)H′
iP>∆(H′
i) ⩾P>∆(H′
i)(Hi ⊗I)P>∆(H′
i) + O(ε) .
Furthermore, we can approximate the RHS of this expression by
∥P>∆(H′
i)(Hi ⊗I)P>∆(H′
i) −Hi ⊗P ⊥
i ∥
= ∥eSi(I ⊗P ⊥
i )e−Si(Hi ⊗I)eSi(I ⊗P ⊥
i )e−Si −Hi ⊗P ⊥
i ∥
⩽O(ηJ) ,
by applying Lemma 28. Hence
P>∆(H′
i)H′
iP>∆(H′
i) ⩾Hi ⊗P ⊥
i + O(ε + ηJ) .
(32)
Summing (31) and (32) for all i, we obtain
H′ =
X
i
H′
i ⩾
X
i
(Hi ⊗I + O(ε + ηJ)) = H ⊗I + O(nε + nηJ) ,
and so the ground state energy of H′ must satisfy
λ0(H′) ⩾λ0(H) + O(nε + nηJ) .
(33)
Now notice that the restriction of H′ to a subspace can only increase λ0, so3
λ0(H′) = λ0(e−SH′eS) ⩽λ0((I ⊗P)e−SH′eS(I ⊗P)) ,
so by Proposition 21 we have
λ0(H′) ⩽λ0(H) + O(nε + nηJ + nη3J′
O + nη4J′) .
(34)
Combining (33)-(34) gives the desired result.
■
3Here, as in [BDLT08], we abuse notation slightly: in the expression λ0((I ⊗P)e−SH′eS(I ⊗P)), we implicitly
take the ground state of the restriction of e−SH′eS to the image of (I ⊗P).
47

B.5
Measurement gadgets
B.5.1
Measurement gadgets in isolation
Here we ﬁrst prove Proposition 15. This follows from direct calculation, by Taylor expanding the
expression e−iδtH′ and identifying the leading order terms in δt. This approach is complicated by
the fact that H′ itself consists of terms that are O((δt)−1) and O((δt)−1/2), but the task is simpliﬁed
since we only need to calculate the time evolution of states of the form |ψ⟩⊗|0⟩.
Proof of Proposition 15.
First, notice that the requirement H2
|1⟩⟨1| = ω2I implies that
e−iδtH|1⟩⟨1| = I ,
H−1
|1⟩⟨1| = ω−2H|1⟩⟨1| .
(35)
Now we expand e−iδtH′:
e−iδtH′ =
X
k⩾0
(−iδt)k
k!
 HI ⊗I + HX ⊗X + H|1⟩⟨1| ⊗|1⟩⟨1|
k.
(36)
We can expand out this expression so that each term is a product of a factors of HI ⊗I, b factors of
HX ⊗X, and c factors of H|1⟩⟨1|, for some a, b, c ∈N. Such a term is accompanied by (δt)a+b+c, to
give a total order of (δt)a+ 1
2 b (using that ∥HX∥= O((δt)−1/2) and ∥H|1⟩⟨1|∥= O((δt)−1)). There
are eight cases producing terms of order O((δt)3/2) and lower, which we enumerate in Fig. 12.
Case
a
b
c
Order
1
0
0
0
O(1)
2
0
0
N+
3
0
1
N
O((δt)1/2)
4
1
0
0
O(δt)
5
1
0
N+
6
0
2
N
7
1
1
N
O(t3/2)
8
0
3
N
Figure 12: Enumeration of possible cases for the values of a, b, c giving rise to terms of order
O((δt)3/2) and lower in (36). We denote N+ = {1, 2, . . . } and N = {0, 1, 2, . . . }.
In particular, we are interested in the block-elements (I⊗⟨0|)e−iδtH′(I⊗|0⟩) and (I⊗⟨1|)e−iδtH′(I⊗
|0⟩), since the other blocks in e−iδtH′ will annihilate states of the form |ψ⟩⊗|0⟩.
• (I ⊗⟨0|)e−iδtH′(I ⊗|0⟩):
Note that each factor of HX ⊗X ﬂips the ancillary qubit A, whereas each factor of H|1⟩⟨1| ⊗
|1⟩⟨1| annihilates states with the ancillary qubit in state |0⟩. As a result, the only contributions
to (I ⊗⟨0|)e−iδtH′(I ⊗|0⟩) from Fig. 12 are those such that b is even. Moreover, c can only
be nonzero if b is at least 2 (so that the factors of H|1⟩⟨1| ⊗|1⟩⟨1| can be sandwiched between
two HX ⊗X factors). This restricts us to cases 1, 4, and 6, so
(I ⊗⟨0|)e−iδtH′(I ⊗|0⟩) = I −iδtHI +
X
k⩾2
(−iδt)k
k!
HXHk−2
|1⟩⟨1|HX + O((δt)2) .
48

Furthermore, the sum can be simpliﬁed to
X
k⩾2
(−iδt)k
k!
HXHk−2
|1⟩⟨1|HX = HXH−2
|1⟩⟨1|
 X
k⩾2
(−iδt)k
k!
Hk
|1⟩⟨1|

HX
= HXH−2
|1⟩⟨1|

e−iδtH|1⟩⟨1| −I + iδtH|1⟩⟨1|

HX
= iδtω−2HXH|1⟩⟨1|HX ,
using (35). Hence we have shown that
(I ⊗⟨0|)e−iδtH′(I ⊗|0⟩) = I −iδt(HI −ω−2HXH|1⟩⟨1|HX) + O((δt)2) .
(37)
• (I ⊗⟨1|)e−iδtH′(I ⊗|0⟩):
By a similar argument to above, the only contributing terms from Fig. 12 are those such that
b is odd, so we can reduce to the cases 3, 7, and 8. In case 3, also notice that the HX ⊗X
term must appear on the right of all the H|1⟩⟨1| ⊗|1⟩⟨1| terms. Hence
(I ⊗⟨1|)e−iδtH′(I ⊗|0⟩) =
X
k⩾1
(−iδt)k
k!
Hk−1
|1⟩⟨1|HX + O((δt)3/2) .
The sum here can be similarly simpliﬁed by Eq. (35):
X
k⩾1
(−iδt)k
k!
Hk−1
|1⟩⟨1|HX = H−1
|1⟩⟨1|
 X
k⩾0
(−iδt)k
k!
Hk
|1⟩⟨1| −I

HX
= H−1
|1⟩⟨1|
 e−iδtH|1⟩⟨1| −I

HX
= 0 ,
so
(I ⊗⟨1|)e−iδtH′(I ⊗|0⟩) = O((δt)3/2) ,
(38)
which, along with (37), completes the proof.
■
B.5.2
Trotter errors
The idea for the proof of Proposition 16 is to factorise the overall evolution operator
e−iδt(H′+Helse⊗I) ≈e−iδtHelse⊗Ie−iδtH′ .
From here, we simply apply Proposition 15 to the initial state |ψ⟩⊗|0⟩, and then evolve the H
system of the resultant state under Helse. The technical diﬃculty is in bounding the errors of this
Trotter expansion in a way which does not depend on the size of the system. Qualitatively, one
might expect this behaviour due to the bounded spread of correlations [LR72] in the system over
a short time δt, under which only a limited set of interactions in Helse can “interfere” with the
evolution under H′. The diﬃculty of obtaining such bounds is compounded by the presence of
terms in H′ which scale as O((δt)−1) and O((δt)−1/2). Our approach uses an explicit form of the
Trotter error given in [CST+21], which can be phrased in terms of commutators. We brieﬂy outline
this process here.
Let A, B ∈Lin(H). We aim to ﬁnd an expression for the Trotter error incurred by the expansion
et(A+B) ≈etAetB.
49

Observe that the function f(t) = etAetB satisﬁes the diﬀerential equation
f ′(t) = AetAetB + etABetB
= (A + B)f(t) + etA B −e−tABetA
etB .
(39)
This diﬀerential equation, with initial condition f(0) = I, can be solved using following lemma.
Lemma 36 (Variation of parameters formula [CST+21]). Let K ∈Lin(H), and let L(t) ∈Lin(H)
be a continuous operator-valued function of t. Suppose that f(t) satisﬁes the diﬀerential equation
f ′(t) = Kf(t) + L(t) ,
f(0) = I .
Then there is a unique solution for f which is given by
f(t) = etK +
Z t
0
dτe(t−τ)KL(τ) .
Hence, using Lemma 36 with K = A + B and L(t) = etA(B −e−tABetA)etB, we ﬁnd that the
Trotter error is given by
etAetB −et(A+B) =
Z t
0
dτe(t−τ)(A+B)eτA B −e−τABeτA
eτB
(40)
The expression (40) is particularly convenient because the bracketed term (B −e−τABeτA) can be
expressed as a series of nested commutators of A and B as described by Lemma 28.
B.5.3
Measurement gadgets with other terms
Proof of Proposition 16.
Using (40) with t = δt, A = −iHelse ⊗I, and B = −iH′, we obtain a
Trotter error given by
e−iδtHelse⊗Ie−iδtH′ −e−iδt(Helse⊗I+H′) := E
= −i
Z δt
0
dτe−i(δt−τ)(Helse⊗I+H′)e−iτHelse⊗I H′ −eiτHelse⊗IH′e−iτHelse⊗I
e−iτH′
= i
∞
X
k=1
Z δt
0
dτ (iτ)k
k! e−i(δt−τ)(Helse⊗I+H′)e−iτHelse⊗I adk
Helse⊗I(H′)e−iτH′ ,
by using Lemma 28. The convergence of the series can be seen since the truncation error is bounded
by
(δt)k+1
(k + 1)!∥adk
Helse⊗I(H′)∥⩽(δt)k+1
(k + 1)!2k∥Helse∥k∥H′∥→0 .
We can write E in block form in the basis of the ancillary space,
E =
(I ⊗⟨0|)E(I ⊗|0⟩)
(I ⊗⟨0|)E(I ⊗|1⟩)
(I ⊗⟨1|)E(I ⊗|0⟩)
(I ⊗⟨1|)E(I ⊗|1⟩)

,
and we will focus on individually bounding these blocks. Note that in order to calculate adk
Helse⊗I(H′)
we can restrict to a subset of the terms in Helse of size O(kd), due to the restrictions placed on the
interaction hypergraph of Helse. Moreover, expanding the commutators, the expression adk
Helse(H′)
contains 2k products. Notice also that we can bound the δt-dependence of the diﬀerent blocks by
commuting projectors past Helse ⊗I, for example
(I ⊗⟨0|) adk
Helse⊗I(H′)(I ⊗|0⟩) = adk
Helse
 (I ⊗⟨0|)H′(I ⊗|0⟩)

= adk
Helse(HI) ,
50

so the (I ⊗|0⟩⟨0|) block has no δt-dependence, since HI is O(1). In this way, we can obtain the
following bounds:
∥(I ⊗⟨0|) adk
Helse⊗I(H′)(I ⊗|0⟩)∥= O(2kkd) ,
(41a)
∥(I ⊗⟨1|) adk
Helse⊗I(H′)(I ⊗|0⟩)∥= O(2kkd(δt)−1/2) ,
(41b)
∥(I ⊗⟨0|) adk
Helse⊗I(H′)(I ⊗|1⟩)∥= O(2kkd(δt)−1/2) ,
(41c)
∥(I ⊗⟨1|) adk
Helse⊗I(H′)(I ⊗|1⟩)∥= O(2kkd(δt)−1) .
(41d)
Since our initial state is of the form |ψ⟩⊗|0⟩, we need only bound the magnitudes of the blocks
(I⊗⟨0|)E(I⊗|0⟩) and (I⊗⟨1|)E(I⊗|0⟩). To this end, we need to describe the action of the operator
e−iτH′ on the operators (I ⊗|0⟩) and (I ⊗|1⟩), for 0 ⩽τ ⩽δt. By considering the series expansion
as in (36), and noting that the ancillary qubit can only be ﬂipped by a HX ⊗X term of order
O((δt)1/2), we see that
e−iτH′(I ⊗|0⟩) = O(1) ⊗|0⟩+ O((δt)1/2) ⊗|1⟩,
e−iτH′(I ⊗|1⟩) = O((δt)1/2) ⊗|0⟩+ O(1) ⊗|1⟩.
Notice that here we abuse big-O notation for matrices; for example, in the above expression
O((δt)1/2) should be interpreted as a matrix with operator norm bounded by O(δt1/2). We can
also crudely upper bound E as follows:
∥E∥⩽
∞
X
k=1
1
k!
Z δt
0
dττ k∥adk
Helse⊗I(H′)∥
⩽
∞
X
k=1
1
(k + 1)!(δt)k+1 · O(2kkd(δt)−1)
⩽O(1)
∞
X
k=1
1
k!(2δt)kkd−1
⩽O(δt) ,
assuming that d = O(1), and using (41d) to give the most pessimistic bound. Therefore in particular
eiτHelse⊗Iei(δt−τ)(Helse⊗I+H′) = eiδtHelse⊗Iei(δt−τ)H′ + O(δt) ,
so
eiτHelse⊗Iei(δt−τ)(Helse⊗I+H′)(I ⊗|0⟩) = e−iδtHelse⊗Iei(δt−τ)H′(I ⊗|0⟩) + O(δt)
= O(1) ⊗|0⟩+ O((δt)1/2) ⊗|1⟩,
(42)
and similarly
eiτHelse⊗Iei(δt−τ)(Helse⊗I+H′)(I ⊗|1⟩) = O((δt)1/2) ⊗|0⟩+ O(1) ⊗|1⟩.
(43)
51

We can now obtain the necessary bounds on the blocks of E. Firstly, we have
∥(I ⊗⟨0|)E(I ⊗|0⟩)∥
⩽
∞
X
k=1
1
k!
Z δt
0
dττ k∥(I ⊗⟨0|)e−i(δt−τ)(Helse⊗I+H′)e−iτHelse⊗I adk
Helse⊗I(H′)e−iτH′(I ⊗|0⟩)∥
⩽
∞
X
k=1
(δt)k+1
(k + 1)!
h
O(1)∥(I ⊗⟨0|) adk
Helse⊗I(H′)(I ⊗|0⟩)∥
+ O((δt)1/2)∥(I ⊗⟨1| adk
Helse⊗I(H′)(I ⊗|0⟩)∥
+ O((δt)1/2)∥(I ⊗⟨0| adk
Helse⊗I(H′)(I ⊗|1⟩)∥
+ O(δt)∥(I ⊗⟨1| adk
Helse⊗I(H′)(I ⊗|1⟩)∥
i
=
∞
X
k=1
(δt)k+1
(k + 1)!O(2kkd) = O((δt)2) ,
(44)
where the second inequality follows by substituting the expressions (42) and (43), and the ﬁnal line
follows from (41a-41d).
The second block can be bounded in the same way:
∥(I ⊗⟨1|)E(I ⊗|0⟩)∥
⩽
∞
X
k=1
1
k!
Z δt
0
dττ k∥(I ⊗⟨1|)e−i(δt−τ)(Helse⊗I+H′)e−iτHelse⊗I adk
Helse⊗I(H′)e−iτH′(I ⊗|0⟩)∥
⩽
∞
X
k=1
(δt)k+1
(k + 1)!
h
O(1)∥(I ⊗⟨1|) adk
Helse⊗I(H′)(I ⊗|0⟩)∥
+ O((δt)1/2)∥(I ⊗⟨0| adk
Helse⊗I(H′)(I ⊗|0⟩)∥
+ O((δt)1/2)∥(I ⊗⟨1| adk
Helse⊗I(H′)(I ⊗|1⟩)∥
+ O(δt)∥(I ⊗⟨0| adk
Helse⊗I(H′)(I ⊗|1⟩)∥
i
=
∞
X
k=1
(δt)k+1
(k + 1)!O(2kkd(δt)1/2) = O((δt)3/2) .
(45)
(46)
With the bounds (44) and (45) on the blocks of the Trotter error we can now conclude that
e−iδt(H′+Helse⊗I)(|ψ⟩⊗|0⟩) = e−iδtHelse⊗Ie−iδtH′(|ψ⟩⊗|0⟩) + E(|ψ⟩⊗|0⟩)
= e−iδtHelse⊗I(e−iδtH |ψ⟩+ O((δt)2)) ⊗|0⟩+ O((δt)3/2) ⊗|1⟩
+ O((δt)2) ⊗|0⟩+ O((δt)3/2) ⊗|1⟩
=
 e−iδtHelsee−iδtH |ψ⟩+ O((δt)2)

⊗|0⟩+ O((δt)3/2) ⊗|1⟩,
(47)
where in the second inequality we invoke Proposition 15. It remains only to bound the Trotter
error in the product e−iδtHelsee−iδtH, but this is a relatively easy task. Using (40) with t = δt,
52

A = −iHelse, B = −iH, we obtain
e−iδtHelsee−iδtH −e−iδt(H+Helse)
= −i
Z δt
0
dτe−i(δt−τ)(H+Helse)e−iτHelse(H −eiτHelseHe−iτHelse)e−iτH
= i
∞
X
k=1
Z δt
0
(iτ)k
k! e−i(δt−τ)(H+Helse)e−iτHelse adk
Helse(H)e−iτH .
(48)
By the same procedure as earlier, we can restrict Helse to its action on a subsystem of size O(kd)
and bound
∥adk
Helse(H)∥= O(2kkd) ,
and hence (48) gives
e−iδtHelsee−iδtH −e−iδt(H+Helse) ⩽
∞
X
k=1
(δt)k+1
(k + 1)!∥adk
Helse(H)∥
⩽O(1)
∞
X
k=1
(2δt)k+1
(k + 1)! kd
= O((δt)2) .
(49)
Combining (49) with (47) completes the proof.
■
53

