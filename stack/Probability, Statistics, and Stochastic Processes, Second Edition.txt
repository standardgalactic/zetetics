

PROBABILITY,
STATISTICS, AND
STOCHASTIC
PROCESSES


PROBABILITY,
STATISTICS, AND
STOCHASTIC
PROCESSES
Second Edition
PETER OLOFSSON
MIKAEL ANDERSSON

Copyright © 2012 by John Wiley & Sons, Inc. All rights reserved
Published by John Wiley & Sons, Inc., Hoboken, New Jersey
Published simultaneously in Canada
No part of this publication may be reproduced, stored in a retrieval system, or transmitted in any form or
by any means, electronic, mechanical, photocopying, recording, scanning, or otherwise, except as
permitted under Section 107 or 108 of the 1976 United States Copyright Act, without either the prior
written permission of the Publisher, or authorization through payment of the appropriate per-copy fee to
the Copyright Clearance Center, Inc., 222 Rosewood Drive, Danvers, MA 01923, (978) 750-8400, fax
(978) 750-4470, or on the web at www.copyright.com. Requests to the Publisher for permission should
be addressed to the Permissions Department, John Wiley & Sons, Inc., 111 River Street, Hoboken, NJ
07030, (201) 748-6011, fax (201) 748-6008, or online at http://www.wiley.com/go/permission.
Limit of Liability/Disclaimer of Warranty: While the publisher and author have used their best efforts in
preparing this book, they make no representations or warranties with respect to the accuracy or
completeness of the contents of this book and speciﬁcally disclaim any implied warranties of
merchantability or ﬁtness for a particular purpose. No warranty may be created or extended by sales
representatives or written sales materials. The advice and strategies contained herein may not be suitable
for your situation. You should consult with a professional where appropriate. Neither the publisher nor
author shall be liable for any loss of proﬁt or any other commercial damages, including but not limited to
special, incidental, consequential, or other damages.
For general information on our other products and services or for technical support, please contact our
Customer Care Department within the United States at (800) 762-2974, outside the United States at (317)
572-3993 or fax (317) 572-4002.
Wiley also publishes its books in a variety of electronic formats. Some content that appears in print may
not be available in electronic formats. For more information about Wiley products, visit our web site at
www.wiley.com.
Library of Congress Cataloging-in-Publication Data:
Olofsson, Peter, 1963–
Probability, statistics, and stochastic processes / Peter Olofsson, Mikael
Andersson. – 2nd ed.
p. cm.
ISBN 978-0-470-88974-9 (hardback)
1.
Stochastic processes–Textbooks.
2.
Probabilities–Textbooks.
3.
Mathematical
statistics–Textbooks. I. Andersson, Mikael. II. Title.
QA274.O46 2012
519.2′3–dc23
2011040205
Printed in the United States of America
ISBN: 9780470889749
10
9
8
7
6
5
4
3
2
1

CONTENTS
Preface
xi
Preface to the First Edition
xiii
1
Basic Probability Theory
1
1.1
Introduction
1
1.2
Sample Spaces and Events
3
1.3
The Axioms of Probability
7
1.4
Finite Sample Spaces and Combinatorics
15
1.4.1
Combinatorics
17
1.5
Conditional Probability and Independence
27
1.5.1
Independent Events
33
1.6
The Law of Total Probability and Bayes’ Formula
41
1.6.1
Bayes’ Formula
47
1.6.2
Genetics and Probability
54
1.6.3
Recursive Methods
55
Problems
63
2
Random Variables
76
2.1
Introduction
76
2.2
Discrete Random Variables
77
2.3
Continuous Random Variables
82
2.3.1
The Uniform Distribution
90
2.3.2
Functions of Random Variables
92
2.4
Expected Value and Variance
95
2.4.1
The Expected Value of a Function of a Random Variable
100
2.4.2
Variance of a Random Variable
104
v

vi
CONTENTS
2.5
Special Discrete Distributions
111
2.5.1
Indicators
111
2.5.2
The Binomial Distribution
112
2.5.3
The Geometric Distribution
116
2.5.4
The Poisson Distribution
117
2.5.5
The Hypergeometric Distribution
121
2.5.6
Describing Data Sets
121
2.6
The Exponential Distribution
123
2.7
The Normal Distribution
127
2.8
Other Distributions
131
2.8.1
The Lognormal Distribution
131
2.8.2
The Gamma Distribution
133
2.8.3
The Cauchy Distribution
134
2.8.4
Mixed Distributions
135
2.9
Location Parameters
137
2.10 The Failure Rate Function
139
2.10.1 Uniqueness of the Failure Rate Function
141
Problems
144
3
Joint Distributions
156
3.1
Introduction
156
3.2
The Joint Distribution Function
156
3.3
Discrete Random Vectors
158
3.4
Jointly Continuous Random Vectors
160
3.5
Conditional Distributions and Independence
164
3.5.1
Independent Random Variables
168
3.6
Functions of Random Vectors
172
3.6.1
Real-Valued Functions of Random Vectors
172
3.6.2
The Expected Value and Variance of a Sum
176
3.6.3
Vector-Valued Functions of Random Vectors
182
3.7
Conditional Expectation
185
3.7.1
Conditional Expectation as a Random Variable
189
3.7.2
Conditional Expectation and Prediction
191
3.7.3
Conditional Variance
192
3.7.4
Recursive Methods
193
3.8
Covariance and Correlation
196
3.8.1
The Correlation Coefﬁcient
201
3.9
The Bivariate Normal Distribution
209
3.10 Multidimensional Random Vectors
216
3.10.1 Order Statistics
218
3.10.2 Reliability Theory
223
3.10.3 The Multinomial Distribution
225
3.10.4 The Multivariate Normal Distribution
226
3.10.5 Convolution
227

CONTENTS
vii
3.11 Generating Functions
231
3.11.1 The Probability Generating Function
231
3.11.2 The Moment Generating Function
237
3.12 The Poisson Process
240
3.12.1 Thinning and Superposition
244
Problems
247
4
Limit Theorems
263
4.1
Introduction
263
4.2
The Law of Large Numbers
264
4.3
The Central Limit Theorem
268
4.3.1
The Delta Method
273
4.4
Convergence in Distribution
275
4.4.1
Discrete Limits
275
4.4.2
Continuous Limits
277
Problems
278
5
Simulation
281
5.1
Introduction
281
5.2
Random Number Generation
282
5.3
Simulation of Discrete Distributions
283
5.4
Simulation of Continuous Distributions
285
5.5
Miscellaneous
290
Problems
292
6
Statistical Inference
294
6.1
Introduction
294
6.2
Point Estimators
294
6.2.1
Estimating the Variance
302
6.3
Conﬁdence Intervals
304
6.3.1
Conﬁdence Interval for the Mean in the Normal Distribution
with Known Variance
307
6.3.2
Conﬁdence Interval for an Unknown Probability
308
6.3.3
One-Sided Conﬁdence Intervals
312
6.4
Estimation Methods
312
6.4.1
The Method of Moments
312
6.4.2
Maximum Likelihood
315
6.4.3
Evaluation of Estimators with Simulation
322
6.4.4
Bootstrap Simulation
324
6.5
Hypothesis Testing
327
6.5.1
Large Sample Tests
332
6.5.2
Test for an Unknown Probability
333

viii
CONTENTS
6.6
Further Topics in Hypothesis Testing
334
6.6.1
P-Values
334
6.6.2
Data Snooping
335
6.6.3
The Power of a Test
336
6.6.4
Multiple Hypothesis Testing
338
6.7
Goodness of Fit
339
6.7.1
Goodness-of-Fit Test for Independence
346
6.7.2
Fisher’s Exact Test
349
6.8
Bayesian Statistics
351
6.8.1
Noninformative priors
359
6.8.2
Credibility Intervals
362
6.9
Nonparametric Methods
363
6.9.1
Nonparametric Hypothesis Testing
363
6.9.2
Comparing Two Samples
370
6.9.3
Nonparametric Conﬁdence Intervals
375
Problems
378
7
Linear Models
391
7.1
Introduction
391
7.2
Sampling Distributions
392
7.3
Single Sample Inference
395
7.3.1
Inference for the Variance
396
7.3.2
Inference for the Mean
399
7.4
Comparing Two Samples
402
7.4.1
Inference about Means
402
7.4.2
Inference about Variances
407
7.5
Analysis of Variance
409
7.5.1
One-Way Analysis of Variance
409
7.5.2
Multiple Comparisons: Tukey’s Method
412
7.5.3
Kruskal–Wallis Test
413
7.6
Linear Regression
415
7.6.1
Prediction
422
7.6.2
Goodness of Fit
424
7.6.3
The Sample Correlation Coefﬁcient
425
7.6.4
Spearman’s Correlation Coefﬁcient
429
7.7
The General Linear Model
431
Problems
436
8
Stochastic Processes
444
8.1
Introduction
444
8.2
Discrete -Time Markov Chains
445
8.2.1
Time Dynamics of a Markov Chain
447
8.2.2
Classiﬁcation of States
450

CONTENTS
ix
8.2.3
Stationary Distributions
454
8.2.4
Convergence to the Stationary Distribution
460
8.3
Random Walks and Branching Processes
464
8.3.1
The Simple Random Walk
464
8.3.2
Multidimensional Random Walks
468
8.3.3
Branching Processes
469
8.4
Continuous -Time Markov Chains
475
8.4.1
Stationary Distributions and Limit Distributions
480
8.4.2
Birth–Death Processes
484
8.4.3
Queueing Theory
488
8.4.4
Further Properties of Queueing Systems
491
8.5
Martingales
494
8.5.1
Martingale Convergence
495
8.5.2
Stopping Times
497
8.6
Renewal Processes
502
8.6.1
Asymptotic Properties
504
8.7
Brownian Motion
509
8.7.1
Hitting Times
512
8.7.2
Variations of the Brownian Motion
515
Problems
517
Appendix A Tables
527
Appendix B Answers to Selected Problems
535
Further Reading
551
Index
553


PREFACE
The second edition was motivated by comments from several users and readers
that the chapters on statistical inference and stochastic processes would beneﬁt
from substantial extensions. To accomplish such extensions, I decided to bring in
Mikael Andersson, an old friend and colleague from graduate school. Being ﬁve
days my junior, he brought a vigorous and youthful perspective to the task and I am
very pleased with the outcome. Below, Mikael will outline the major changes and
additions introduced in the second edition.
Peter Olofsson
San Antonio, Texas, 2011
The chapter on statistical inference has been extended, reorganized, and split into
two new chapters. Chapter 6 introduces the principles and concepts behind standard
methods of statistical inference in general, while the important case of normally
distributed samples is treated separately in Chapter 7. This is a somewhat different
structure compared to most other textbooks in statistics since common methods such
as t tests and linear regression come rather late in the text. According to my experience,
if methods based on normal samples are presented too early in a course, they tend
to overshadow other approaches such as nonparametric and Bayesian methods and
students become less aware that these alternatives exist.
New additions in Chapter 6 include consistency of point estimators, large
sample theory, bootstrap simulation, multiple hypothesis testing, Fisher’s exact test,
Kolmogorov–Smirnov test and nonparametric conﬁdence intervals, as well as a
discussion of informative versus noninformative priors and credibility intervals in
Section 6.8.
xi

xii
PREFACE
Chapter 7 starts with a detailed treatment of sampling distributions, such as the t,
chi-square, and F distributions, derived from the normal distribution. There are also
new sections introducing one-way analysis of variance and the general linear model.
Chapter 8 has been expanded to include three new sections on martingales, renewal
processes, and Brownian motion. These areas are of great importance in probabil-
ity theory and statistics, but since they are based on quite extensive and advanced
mathematical theory, we offer only a brief introduction here.
It has been a great privilege, responsibility, and pleasure to have had the opportunity
to work with such an esteemed colleague and good friend. Finally, the joint project
that we dreamed about during graduate school has come to fruition!
I also have a victim of preoccupation and absentmindedness, my beloved Eva whom
I want to thank for her support and all the love and friendship we have shared and
will continue to share for many days to come.
Mikael Andersson
Stockholm, Sweden, 2011

PREFACE TO THE FIRST EDITION
THE BOOK
In November 2003, I was completing a review of an undergraduate textbook in prob-
ability and statistics. In the enclosed evaluation sheet was the question “Have you
ever considered writing a textbook?” and I suddenly realized that the answer was
“Yes,” and had been for quite some time. For several years I had been teaching a
course on calculus-based probability and statistics mainly for mathematics, science,
and engineering students. Other than the basic probability theory, my goal was to
include topics from two areas: statistical inference and stochastic processes. For many
students this was the only probability/statistics course they would ever take, and I
found it desirable that they were familiar with conﬁdence intervals and the maximum
likelihood method, as well as Markov chains and queueing theory. While there were
plenty of books covering one area or the other, it was surprisingly difﬁcult to ﬁnd one
that covered both in a satisfying way and on the appropriate level of difﬁculty. My
solution was to choose one textbook and supplement it with lecture notes in the area
that was missing. As I changed texts often, plenty of lecture notes accumulated and it
seemed like a good idea to organize them into a textbook. I was pleased to learn that
the good people at Wiley agreed.
It is now more than a year later, and the book has been written. The ﬁrst three
chapters develop probability theory and introduce the axioms of probability, random
variables, and joint distributions. The following two chapters are shorter and of an
“introduction to” nature: Chapter 4 on limit theorems and Chapter 5 on simulation.
Statistical inference is treated in Chapter 6, which includes a section on Bayesian
statistics, too often a neglected topic in undergraduate texts. Finally, in Chapter 7,
Markov chains in discrete and continuous time are introduced. The reference list at
xiii

xiv
PREFACE TO THE FIRST EDITION
the end of the book is by no means intended to be comprehensive; rather, it is a
subjective selection of the useful and the entertaining.
Throughout the text I have tried to convey an intuitive understanding of concepts
and results, which is why a deﬁnition or a proposition is often preceded by a short
discussion or a motivating example. I have also attempted to make the exposition
entertaining by choosing examples from the rich source of fun and thought-provoking
probability problems. The data sets used in the statistics chapter are of three different
kinds: real, fake but realistic, and unrealistic but illustrative.
THE PEOPLE
Most textbook authors start by thanking their spouses. I know now that this is far more
than a formality, and I would like to thank Aλκμ´ηνη not only for patiently putting
up with irregular work hours and an absentmindedness greater than usual but also for
valuable comments on the aesthetics of the manuscript.
A number of people have commented on various parts and aspects of the book.
First, I would like to thank Olle H¨aggstr¨om at Chalmers University of Technology,
G¨oteborg, Sweden for valuable comments on all chapters. His remarks are always
accurate and insightful, and never obscured by unnecessary politeness. Second, I
would like to thank Kjell Doksum at the University of Wisconsin for a very helpful
review of the statistics chapter. I have also enjoyed the Bayesian enthusiasm of Peter
M¨uller at the University of Texas MD Anderson Cancer Center.
Other people who have commented on parts of the book or been otherwise
helpful are my colleagues Dennis Cox, Kathy Ensor, Rudy Guerra, Marek Kimmel,
Rolf Riedi, Javier Rojo, David W. Scott, and Jim Thompson at Rice University;
Prof. Dr. R.W.J. Meester at Vrije Universiteit, Amsterdam, The Netherlands; Timo
Sepp¨al¨ainen at the University of Wisconsin; Tom English at Behrend College;
Robert Lund at Clemson University; and Jared Martin at Shell Exploration and
Production. For help with solutions to problems, I am grateful to several bright Rice
graduate students: Blair Christian, Julie Cong, Talithia Daniel, Ginger Davis, Li
Deng, Gretchen Fix, Hector Flores, Garrett Fox, Darrin Gershman, Jason Gershman,
Shu Han, Shannon Neeley, Rick Ott, Galen Papkov, Bo Peng, Zhaoxia Yu, and
Jenny Zhang. Thanks to Mikael Andersson at Stockholm University, Sweden for
contributions to the problem sections, and to Patrick King at ODS–Petrodata, Inc.
for providing data with a distinct Texas ﬂavor: oil rig charter rates. At Wiley, I would
like to thank Steve Quigley, Susanne Steitz, and Kellsee Chu for always promptly
answering my questions. Finally, thanks to John Haigh, John Allen Paulos, Jeffrey
E. Steif, and an anonymous Dutchman for agreeing to appear and be mildly mocked
in footnotes.
Peter Olofsson
Houston, Texas, 2005

1
BASIC PROBABILITY THEORY
1.1
INTRODUCTION
Probability theory is the mathematics of randomness. This statement immediately
invites the question “What is randomness?” This is a deep question that we cannot
attempt to answer without invoking the disciplines of philosophy, psychology, math-
ematical complexity theory, and quantum physics, and still there would most likely
be no completely satisfactory answer. For our purposes, an informal definition of ran-
domness as “what happens in a situation where we cannot predict the outcome with
certainty” is sufficient. In many cases, this might simply mean lack of information.
For example, if we ﬂip a coin, we might think of the outcome as random. It will be
either heads or tails, but we cannot say which, and if the coin is fair, we believe that
both outcomes are equally likely. However, if we knew the force from the fingers at
the ﬂip, weight and shape of the coin, material and shape of the table surface, and
several other parameters, we would be able to predict the outcome with certainty,
according to the laws of physics. In this case we use randomness as a way to describe
uncertainty due to lack of information.1
Next question: “What is probability?” There are two main interpretations of prob-
ability, one that could be termed “objective” and the other “subjective.” The first is
1To quote the French mathematician Pierre-Simon Laplace, one of the first to develop a mathematical
theory of probability: “Probability is composed partly of our ignorance, partly of our knowledge.”
Probability, Statistics, and Stochastic Processes, Second Edition. Peter Olofsson and Mikael Andersson.
© 2012 John Wiley & Sons, Inc. Published 2012 by John Wiley & Sons, Inc.
1

2
BASIC PROBABILITY THEORY
0
20
40
60
80
100
0 
1/2
1 
FIGURE 1.1
Consecutive relative frequencies of heads in 100 coin ﬂips.
the interpretation of a probability as a limit of relative frequencies; the second, as a
degree of belief. Let us brieﬂy describe each of these.
For the first interpretation, suppose that we have an experiment where we are
interested in a particular outcome. We can repeat the experiment over and over and
each time record whether we got the outcome of interest. As we proceed, we count
the number of times that we got our outcome and divide this number by the number of
times that we performed the experiment. The resulting ratio is the relative frequency
of our outcome. As it can be observed empirically that such relative frequencies tend
to stabilize as the number of repetitions of the experiment grows, we might think of
the limit of the relative frequencies as the probability of the outcome. In mathematical
notation, if we consider n repetitions of the experiment and if Sn of these gave our
outcome, then the relative frequency would be fn = Sn/n, and we might say that
the probability equals limn→∞fn. Figure 1.1 shows a plot of the relative frequency
of heads in a computer simulation of 100 hundred coin ﬂips. Notice how there is
significant variation in the beginning but how the relative frequency settles in toward
1
2 quickly.
The second interpretation, probability as a degree of belief, is not as easily quan-
tified but has obvious intuitive appeal. In many cases, it overlaps with the previous
interpretation, for example, the coin ﬂip. If we are asked to quantify our degree of
belief that a coin ﬂip gives heads, where 0 means “impossible” and 1 means “with
certainty,” we would probably settle for 1
2 unless we have some specific reason to
believe that the coin is not fair. In some cases it is not possible to repeat the experi-
ment in practice, but we can still imagine a sequence of repetitions. For example, in
a weather forecast you will often hear statements like “there is a 30% chance of rain
tomorrow.” Of course, we cannot repeat the experiment; either it rains tomorrow or it
does not. The 30% is the meteorologist’s measure of the chance of rain. There is still
a connection to the relative frequency approach; we can imagine a sequence of days

SAMPLE SPACES AND EVENTS
3
with similar weather conditions, same time of year, and so on, and that in roughly
30% of the cases, it rains the following day.
The “degree of belief” approach becomes less clear for statements such as “the
Riemann hypothesis is true” or “there is life on other planets.” Obviously, these
are statements that are either true or false, but we do not know which, and it is not
unreasonable to use probabilities to express how strongly we believe in their truth. It is
also obvious that different individuals may assign completely different probabilities.
How, then, do we actually define a probability? Instead of trying to use any of
these interpretations, we will state a strict mathematical definition of probability. The
interpretations are still valid to develop intuition for the situation at hand, but instead
of, for example, assuming that relative frequencies stabilize, we will be able to prove
that they do, within our theory.
1.2
SAMPLE SPACES AND EVENTS
As mentioned in the introduction, probability theory is a mathematical theory to
describe and analyze situations where randomness or uncertainty are present. Any
specific such situation will be referred to as a random experiment. We use the term
“experiment” in a wide sense here; it could mean an actual physical experiment such
as ﬂipping a coin or rolling a die, but it could also be a situation where we simply
observe something, such as the price of a stock at a given time, the amount of rain in
Houston in September, or the number of spam emails we receive in a day. After the
experiment is over, we call the result an outcome. For any given experiment, there is
a set of possible outcomes, and we state the following definition.
Deﬁnition 1.1. The set of all possible outcomes in a random experiment is called
the sample space, denoted S.
Here are some examples of random experiments and their associated sample spaces.
Example 1.1. Roll a die and observe the number.
Here we can get the numbers 1 through 6, and hence the sample space is
S = {1, 2, 3, 4, 5, 6}
□
Example 1.2. Roll a die repeatedly and count the number of rolls it takes until the
first 6 appears.
Since the first 6 may come in the first roll, 1 is a possible outcome. Also, we may fail
to get 6 in the first roll and then get 6 in the second, so 2 is also a possible outcome. If

4
BASIC PROBABILITY THEORY
we continue this argument we realize that any positive integer is a possible outcome
and the sample space is
S = {1, 2, . . . }
the set of positive integers.
□
Example 1.3. Turn on a lightbulb and measure its lifetime, that is, the time until it fails.
Here it is not immediately clear what the sample space should be since it depends on
how accurately we can measure time. The most convenient approach is to note that
the lifetime, at least in theory, can assume any nonnegative real number and choose
as the sample space
S = [0, ∞)
where the outcome 0 means that the lightbulb is broken to start with.
□
In these three examples, we have sample spaces of three different kinds. The first is
finite, meaning that it has a finite number of outcomes, whereas the second and third
are infinite. Although they are both infinite, they are different in the sense that one
has its points separated, {1, 2, . . . } and the other is an entire continuum of points.
We call the first type countable infinity and the second uncountable infinity. We will
return to these concepts later as they turn out to form an important distinction.
In the examples above, the outcomes are always numbers and hence the sample
spaces are subsets of the real line. Here are some examples of other types of sample
spaces.
Example 1.4. Flip a coin twice and observe the sequence of heads and tails.
With H denoting heads and T denoting tails, one possible outcome is HT, which
means that we get heads in the first ﬂip and tails in the second. Arguing like this,
there are four possible outcomes and the sample space is
S = {HH, HT, TH, TT}
□
Example 1.5. Throw a dart at random on a dartboard of radius r.
If we think of the board as a disk in the plane with center at the origin, an outcome is
an ordered pair of real numbers (x, y), and we can describe the sample space as
S = {(x, y) : x2 + y2 ≤r2}
□

SAMPLE SPACES AND EVENTS
5
Once we have described an experiment and its sample space, we want to be able to
compute probabilities of the various things that may happen. What is the probability
that we get 6 when we roll a die? That the first 6 does not come before the fifth roll?
That the lightbulb works for at least 1500 h? That our dart hits the bull’s eye? Certainly,
we need to make further assumptions to be able to answer these questions, but before
that, we realize that all these questions have something in common. They all ask for
probabilities of either single outcomes or groups of outcomes. Mathematically, we
can describe these as subsets of the sample space.
Deﬁnition 1.2. A subset of S, A ⊆S, is called an event.
Note the choice of words here. The terms “outcome” and “event” reﬂect the fact
that we are describing things that may happen in real life. Mathematically, these are
described as elements and subsets of the sample space. This duality is typical for
probability theory; there is a verbal description and a mathematical description of
the same situation. The verbal description is natural when real-world phenomena
are described and the mathematical formulation is necessary to develop a consistent
theory. See Table 1.1 for a list of set operations and their verbal description.
Example 1.6. If we roll a die and observe the number, two possible events are that
we get an odd outcome and that we get at least 4. If we view these as subsets of the
sample space, we get
A = {1, 3, 5} and B = {4, 5, 6}
If we want to use the verbal description, we might write this as
A = {odd outcome} and B = {at least 4}
□
We always use “or” in its nonexclusive meaning; thus, “A or B occurs” includes the
possibility that both occur. Note that there are different ways to express combinations
of events; for example, A \ B = A ∩Bc and (A ∪B)c = Ac ∩Bc. The latter is known
as one of De Morgan’s laws, and we state these without proof together with some
other basic set theoretic rules.
TABLE 1.1
Basic Set Operations and Their Verbal Description
Notation
Mathematical Description
Verbal Description
A ∪B
The union of A and B
A or B (or both) occurs
A ∩B
The intersection of A and B
Both A and B occur
Ac
The complement of A
A does not occur
A \ B
The difference between A and B
A occurs but not B
Ø
The empty set
Impossible event

6
BASIC PROBABILITY THEORY
Proposition 1.1. Let A, B, and C be events. Then
(a) (Distributive Laws) (A ∩B) ∪C = (A ∪C) ∩(B ∪C)
(A ∪B) ∩C = (A ∩C) ∪(B ∩C)
(b) (De Morgan’s Laws) (A ∪B)c = Ac ∩Bc
(A ∩B)c = Ac ∪Bc
As usual when dealing with set theory, Venn diagrams are useful. See Figure 1.2 for
an illustration of some of the set operations introduced above. We will later return to
how Venn diagrams can be used to calculate probabilities. If A and B are such that
A ∩B = ∅, they are said to be disjoint or mutually exclusive. In words, this means
that they cannot both occur simultaneously in the experiment.
As we will often deal with unions of more than two or three events, we need more
general versions of the results given above. Let us first introduce some notation. If
A1, A2, . . . , An is a sequence of events, we denote
n
k=1
Ak = A1 ∪A2 ∪· · · ∪An
the union of all the Ak and
n
k=1
Ak = A1 ∩A2 ∩· · · ∩An
the intersection of all the Ak. In words, these are the events that at least one of the
Ak occurs and that all the Ak occur, respectively. The distributive and De Morgan’s
laws extend in the obvious way, for example
 n
k=1
Ak
c
=
n
k=1
Ac
k
B
A
A ∩B
B \A
B
A
FIGURE 1.2
Venn diagrams of the intersection and the difference between events.

THE AXIOMS OF PROBABILITY
7
It is also natural to consider infinite unions and intersections. For example, in Example
1.2, the event that the first 6 comes in an odd roll is the infinite union {1} ∪{3} ∪
{5} ∪· · · and we can use the same type of notation as for finite unions and write
{first 6 in odd roll} =
∞

k=1
{2k −1}
For infinite unions and intersections, distributive and De Morgan’s laws still extend
in the obvious way.
1.3
THE AXIOMS OF PROBABILITY
In the previous section, we laid the basis for a theory of probability by describing ran-
dom experiments in terms of the sample space, outcomes, and events. As mentioned,
we want to be able to compute probabilities of events. In the introduction, we men-
tioned two different interpretations of probability: as a limit of relative frequencies
and as a degree of belief. Since our aim is to build a consistent mathematical theory, as
widely applicable as possible, our definition of probability should not depend on any
particular interpretation. For example, it makes intuitive sense to require a probability
to always be less than or equal to one (or equivalently, less than or equal to 100%).
You cannot ﬂip a coin 10 times and get 12 heads. Also, a statement such as “I am
150% sure that it will rain tomorrow” may be used to express extreme pessimism
regarding an upcoming picnic but is certainly not sensible from a logical point of
view. Also, a probability should be equal to one (or 100%), when there is absolute
certainty, regardless of any particular interpretation.
Other properties must hold as well. For example, if you think there is a 20% chance
that Bob is in his house, a 30% chance that he is in his backyard, and a 50% chance
that he is at work, then the chance that he is at home is 50%, the sum of 20% and
30%. Relative frequencies are also additive in this sense, and it is natural to demand
that the same rule apply for probabilities.
We now give a mathematical definition of probability, where it is defined as a
real-valued function of the events, satisfying three properties, which we refer to as
theaxiomsofprobability.Inthelightofthediscussionabove,theyshouldbeintuitively
reasonable.
Deﬁnition 1.3 (Axioms of Probability). A probability measure is a function P,
which assigns to each event A a number P(A) satisfying
(a) 0 ≤P(A) ≤1
(b) P(S) = 1

8
BASIC PROBABILITY THEORY
(c) If A1, A2, . . . is a sequence of pairwise disjoint events, that is, if i /= j, then
Ai ∩Aj = ∅, then
P
 ∞

k=1
Ak

=
∞

k=1
P(Ak)
We read P(A) as “the probability of A.” Note that a probability in this sense is a real
number between 0 and 1 but we will occasionally also use percentages so that, for
example, the phrases “The probability is 0.2” and “There is a 20% chance” mean the
same thing.2
The third axiom is the most powerful assumption when it comes to deducing
properties and further results. Some texts prefer to state the third axiom for finite
unions only, but since infinite unions naturally arise even in simple examples, we
choose this more general version of the axioms. As it turns out, the finite case follows
as a consequence of the infinite. We next state this in a proposition and also that the
empty set has probability zero. Although intuitively obvious, we must prove that it
follows from the axioms. We leave this as an exercise.
Proposition 1.2. Let P be a probability measure. Then
(a) P(∅) = 0
(b) If A1, . . . , An are pairwise disjoint events, then
P(
n
k=1
Ak) =
n

k=1
P(Ak)
In particular, if A and B are disjoint, then P(A ∪B) = P(A) + P(B). In general,
unionsneednotbedisjointandwenextshowhowtocomputetheprobabilityofaunion
in general, as well as prove some other basic properties of the probability measure.
Proposition 1.3. Let P be a probability measure on some sample space S and let
A and B be events. Then
(a) P(Ac) = 1 −P(A)
(b) P(A \ B) = P(A) −P(A ∩B)
(c) P(A ∪B) = P(A) + P(B) −P(A ∩B)
(d) If A ⊆B, then P(A) ≤P(B)
2If the sample space is very large, it may be impossible to assign probabilities to all events. The class of
events then needs to be restricted to what is called a σ-field. For a more advanced treatment of probability
theory, this is a necessary restriction, but we can safely disregard this problem.

THE AXIOMS OF PROBABILITY
9
Proof. We prove (b) and (c), and leave (a) and (d) as exercises. For (b), note that
A = (A ∩B) ∪(A \ B), which is a disjoint union, and Proposition 1.2 gives
P(A) = P(A ∩B) + P(A \ B)
which proves the assertion. For (c), we write A ∪B = A ∪(B \ A), which is a disjoint
union, and we get
P(A ∪B) = P(A) + P(B \ A) = P(A) + P(B) −P(A ∩B)
by part (b).
■
Note how we repeatedly used Proposition 1.2(b), the finite version of the third axiom.
In Proposition 1.3(c), for example, the events A and B are not necessarily disjoint but
we can represent their union as a union of other events that are disjoint, thus allowing
us to apply the third axiom.
Example 1.7. Mrs Boudreaux and Mrs Thibodeaux are chatting over their fence
when the new neighbor walks by. He is a man in his sixties with shabby clothes and
a distinct smell of cheap whiskey. Mrs B, who has seen him before, tells Mrs T that
he is a former Louisiana state senator. Mrs T finds this very hard to believe. “Yes,”
says Mrs B, “he is a former state senator who got into a scandal long ago, had to
resign and started drinking.” “Oh,” says Mrs T, “that sounds more probable.” “No,”
says Mrs B, “I think you mean less probable.”
Actually, Mrs B is right. Consider the following two statements about the shabby
man: “He is a former state senator” and “He is a former state senator who got into
a scandal long ago, had to resign, and started drinking.” It is tempting to think that
the second is more probable because it gives a more exhaustive explanation of the
situation at hand. However, this is precisely why it is a less probable statement. To
explain this with probabilities, consider the experiment of observing a person and the
two events
A = {he is a former state senator}
B = {he got into a scandal long ago, had to resign, and started drinking}
The first statement then corresponds to the event A and the second to the event A ∩B,
and since A ∩B ⊆A, we get P(A ∩B) ≤P(A). Of course, what Mrs T meant was
that it was easier to believe that the man was a former state senator once she knew
more about his background.
In their book Judgment under Uncertainty, Kahneman et al. [5], show empirically
how people often make similar mistakes when asked to choose the most probable
among a set of statements. With a strict application of the rules of probability, we get
it right.
□

10
BASIC PROBABILITY THEORY
Example 1.8. Consider the following statement: “I heard on the news that there is a
50% chance of rain on Saturday and a 50% chance of rain on Sunday. Then there
must be a 100% chance of rain during the weekend.”
This is, of course, not true. However, it may be harder to point out precisely where
the error lies, but we can address it with probability theory. The events of interest are
A = {rain on Saturday}
and
B = {rain on Sunday}
and the event of rain during the weekend is then A ∪B. The percentages are refor-
mulated as probabilities so that P(A) = P(B) = 0.5 and we get
P(rain during the weekend) = P(A ∪B)
= P(A) + P(B) −P(A ∩B)
= 1 −P(A ∩B)
which is less than 1, that is, the chance of rain during the weekend is less than 100%.
The error in the statement lies in that we can add probabilities only when the events
are disjoint. In general, we need to subtract the probability of the intersection, which
in this case is the probability that it rains both Saturday and Sunday.
□
Example 1.9. A dartboard has an area of 143 in.2 (square inches). In the center of
the board, there is the “bulls eye,” which is a disk of area 1 in.2. The rest of the
board is divided into 20 sectors numbered 1, 2, . . . , 20. There is also a triple ring
that has an area of 10 in.2 and a double ring of area 15 in.2 (everything rounded to
nearest integers). Suppose that you throw a dart at random on the board. What is the
probability that you get (a) double 14, (b) 14 but not double, (c) triple or the bull’s
eye, and (d) an even number or a double?
Introduce the events F = {14}, D = {double}, T = {triple}, B = {bull’s eye}, and
E = {even}. We interpret “throw a dart at random” to mean that any region is hit with
a probability that equals the fraction of the total area of the board that region occupies.
For example, each number has area (143 −1)/20 = 7.1 in.2 so the corresponding
probability is 7.1/143. We get
P(double 14)
= P(D ∩F) = 0.75
143 ≈0.005
P(14 but not double) = P(F \ D) = P(F) −P(F ∩D)
= 7.1
143 −0.75
143 ≈0.044

THE AXIOMS OF PROBABILITY
11
P(triple or bulls eye) = P(T ∪B) = P(T) + P(B)
= 10
143 +
1
143 ≈0.077
P(even or double)
= P(E ∪D) = P(E) + P(D) −P(E ∩D)
= 71
143 + 15
143 −7.5
143 ≈0.55
□
Let us say a word here about the interplay between logical statements and events.
In the previous example, consider the events E = {even} and F = {14}. Clearly, if
we get 14, we also get an even number. As a logical relation between statements, we
would express this as
the number is 14 ⇒the number is even
and in terms of events, we would say “If F occurs, then E must also occur.” But this
means that F ⊆E and hence
{the number is 14} ⊆{the number is even}
and thus the set-theoretic analog of “⇒” is “⊆” that is useful to keep in mind.
Venn diagrams turn out to provide a nice and useful interpretation of probabilities.
If we imagine the sample space S to be a rectangle of area 1, we can interpret the
probability of an event A as the area of A (see Figure 1.3). For example, Proposition
1.3(c) says that P(A ∪B) = P(A) + P(B) −P(A ∩B). With the interpretation of
probabilities as areas, we thus have
P(A ∪B) = area of A ∪B
= area of A + area of B −area of A ∩B
= P(A) + P(B) −P(A ∩B)
Total area = 1
S
area of A
P (A)=
FIGURE 1.3
Probabilities with Venn diagrams.

12
BASIC PROBABILITY THEORY
B
A
C
FIGURE 1.4
Venn diagram of three events.
since when we add the areas of A and B, we count the area of A ∩B twice and must
subtract it (think of A and B as overlapping pancakes where we are interested only
in how much area they cover). Strictly speaking, this is not a proof but the method
can be helpful to find formulas that can then be proved formally. In the case of three
events, consider Figure 1.4 to argue that
Area of A ∪B ∪C = area of A + area of B + area of C
−area of A ∩B −area of A ∩C −area of B ∩C
+ area of A ∩B ∩C
since the piece in the middle was first added three times and then removed three
times, so in the end we have to add it again. Note that we must draw the diagram so
that we get all possible combinations of intersections between the events. We have
argued for the following proposition, which we state and prove formally.
Proposition 1.4. Let A, B, and C be three events. Then
P(A ∪B ∪C) = P(A) + P(B) + P(C)
−P(A ∩B) −P(A ∩C) −P(B ∩C)
+ P(A ∩B ∩C)
Proof. By applying Proposition 1.3(c) twice—first to the two events A ∪B and C
and second to the events A and B—we obtain
P(A ∪B ∪C) = P(A ∪B) + P(C) −P((A ∪B) ∩C)
= P(A) + P(B) −P(A ∩B) + P(C) −P((A ∪B) ∩C)

THE AXIOMS OF PROBABILITY
13
The first four terms are what they should be. To deal with the last term, note that by
the distributive laws for set operations, we obtain
(A ∪B) ∩C = (A ∩C) ∪(B ∩C)
and yet another application of Proposition 1.3(c) gives
P((A ∪B) ∩C) = P((A ∩C) ∪(B ∩C))
= P(A ∩C) + P(B ∩C) −P(A ∩B ∩C)
which gives the desired result.
■
Example 1.10. Choose a number at random from the numbers 1, . . . , 100. What is
the probability that the chosen number is divisible by either 2, 3, or 5?
Introduce the events
Ak = {divisible by k} for k = 1, 2, . . .
We interpret “at random” to mean that any set of numbers has a probability that is
equal to its relative size, that is, the number of elements divided by 100. We then get
P(A2) = 0.5, P(A3) = 0.33, and P(A5) = 0.2
For the intersection, first note that, for example, A2 ∩A3 is the event that the number
is divisible by both 2 and 3, which is the same as saying it is divisible by 6. Hence
A2 ∩A3 = A6 and
P(A2 ∩A3) = P(A6) = 0.16
Similarly, we get
P(A2 ∩A5) = P(A10) = 0.1,
P(A3 ∩A5) = P(A15) = 0.06
and
P(A2 ∩A3 ∩A5) = P(A30) = 0.03
The event of interest is A2 ∪A3 ∪A5, and Proposition 1.4 yields
P(A2 ∪A3 ∪A5) = 0.5 + 0.33 + 0.2 −(0.16 + 0.1 + 0.06) + 0.03 = 0.74
□
It is now easy to believe that the general formula for a union of n events starts by
adding the probabilities of the events, then subtracting the probabilities of the pairwise
intersections, adding the probabilities of intersections of triples, and so on, finishing
with either adding or subtracting the intersection of all the n events, depending on
whether n is odd or even. We state this in a proposition that is sometimes referred to

14
BASIC PROBABILITY THEORY
as the inclusion–exclusion formula. It can, for example, be proved by induction, but
we leave the proof as an exercise.
Proposition 1.5. Let A1, A2, . . . , An be a sequence of n events. Then
P
 n
k=1
Ak

=
n

k=1
P(Ak)
−

i<j
P(Ai ∩Aj)
+

i<j<k
P(Ai ∩Aj ∩Ak)
...
+ (−1)n+1P(A1 ∩A2 ∩· · · ∩An)
We finish this section with a theoretical result that will be useful from time to time.
A sequence of events is said to be increasing if
A1 ⊆A2 ⊆· · ·
and decreasing if
A1 ⊇A2 ⊇· · ·
In each case we can define the limit of the sequence. If the sequence is increasing,
we define
lim
n→∞An =
∞

k=1
Ak
and if the sequence is decreasing
lim
n→∞An =
∞

k=1
Ak
Note how this is similar to limits of sequences of numbers, with ⊆and ⊇correspond-
ing to ≤and ≥, respectively, and union and intersection corresponding to supremum
and infimum. The following proposition states that the probability measure is a con-
tinuous set function. The proof is outlined in Problem 18.

FINITE SAMPLE SPACES AND COMBINATORICS
15
Proposition 1.6. If A1, A2, . . . is either increasing or decreasing, then
P( lim
n→∞An) = lim
n→∞P(An)
1.4
FINITE SAMPLE SPACES AND COMBINATORICS
The results in the previous section hold for an arbitrary sample space S. In this section,
wewillassumethatS isfinite,S = {s1, . . . , sn},say.Inthiscase,wecanalwaysdefine
the probability measure by assigning probabilities to the individual outcomes.
Proposition 1.7. Suppose that p1, . . . , pn are numbers such that
(a) pk ≥0, k = 1, . . . , n
(b)
n

k=1
pk = 1
and for any event A ⊆S, define
P(A) =

k:sk∈A
pk
Then P is a probability measure.
Proof. Clearly, the first two axioms of probability are satisfied. For the third, note
that in a finite sample space, we cannot have infinitely many disjoint events, so we
only have to check this for a disjoint union of two events A and B. We get
P(A ∪B) =

k:sk∈A∪B
pk =

k:sk∈A
pk +

k:sk∈B
pk = P(A) + P(B)
and we are done. (Why are two events enough?)
■
Hence, when dealing with finite sample spaces, we do not need to explicitly give the
probability of every event, only for each outcome. We refer to the numbers p1, . . . , pn
as a probability distribution on S.
Example 1.11. Consider the experiment of ﬂipping a fair coin twice and counting the
number of heads. We can take the sample space
S = {HH, HT, TH, TT}

16
BASIC PROBABILITY THEORY
and let p1 = · · · = p4 = 1
4. Alternatively, since all we are interested in is the number
of heads and this can be 0, 1, or 2, we can use the sample space
S = {0, 1, 2}
and let p0 = 1
4, p1 = 1
2, p2 = 1
4.
□
Of particular interest is the case when all outcomes are equally likely. If S has n
equally likely outcomes, then p1 = p2 = · · · = pn = 1
n, which is called a uniform
distribution on S. The formula for the probability of an event A now simplifies to
P(A) =

k:sk∈A
1
n = #A
n
where #A denotes the number of elements in A. This formula is often referred to as
the classical definition of probability since historically this was the first context in
which probabilities were studied. The outcomes in the event A can be described as
favorable to A and we get the following formulation.
Corollary 1.1. In a finite sample space with uniform probability distribution
P(A) = # favorable outcomes
# possible outcomes
In daily language, the term “at random” is often used for something that has a uniform
distribution. Although our concept of randomness is more general, this colloquial
notion is so common that we will also use it (and already have). Thus, if we say “pick
a number at random from 1, . . . , 10,” we mean “pick a number according to a uniform
probability distribution on the sample space {1, 2, . . . , 10}.”
Example 1.12. Roll a fair die three times. What is the probability that all numbers
are the same?
The sample space is the set of the 216 ordered triples (i, j, k), and since the die is fair,
these are all equally probable and we have a uniform probability distribution. The
event of interest is
A = {(1, 1, 1), (2, 2, 2), . . . , (6, 6, 6)}
which has six outcomes and probability
P(A) = # favorable outcomes
# possible outcomes
=
6
216 = 1
36
□

FINITE SAMPLE SPACES AND COMBINATORICS
17
Example 1.13. Consider a randomly chosen family with three children. What is the
probability that they have exactly one daughter?
There are eight possible sequences of boys and girls (in order of birth), and we get
the sample space
S = {bbb, bbg, bgb, bgg, gbb, gbg, ggb, ggg}
where, for example, bbg means that the oldest child is a boy, the middle child a boy,
and the youngest child a girl. If we assume that all outcomes are equally likely, we
get a uniform probability distribution on S, and since there are three outcomes with
one girl, we get
P(one daughter) = 3
8
□
Example 1.14. Consider a randomly chosen girl who has two siblings. What is the
probability that she has no sisters?
Although this seems like the same problem as in the previous example, it is not. If, for
example, the family has three girls, the chosen girl can be any of these three, so there
are three different outcomes and the sample space needs to take this into account. Let
g∗denote the chosen girl to get the sample space
S = {g∗gg, gg∗g, ggg∗, g∗gb, gg∗b, g∗bg, gbg∗, bg∗g, bgg∗, g∗bb, bg∗b, bbg∗}
and since 3 out of 12 equally likely outcomes have no sisters we get
P(no sisters) = 1
4
which is smaller than the 3
8 we got above. On average, 37.5% of families with three
children have a single daughter and 25% of girls in three-children families are single
daughters.
□
1.4.1
Combinatorics
Combinatorics, “the mathematics of counting,” gives rise to a wealth of probability
problems. The typical situation is that we have a set of objects from which we draw
repeatedly in such a way that all objects are equally likely to be drawn. It is often
tedious to list the sample space explicitly, but by counting combinations we can find
the total number of cases and the number of favorable cases and apply the methods
from the previous section.
The first problem is to find general expressions for the total number of com-
binations when we draw k times from a set of n distinguishable objects. There are
different ways to interpret this. For example, we can draw with or without replacement,

18
BASIC PROBABILITY THEORY
depending on whether the same object can be drawn more than once. We can also
draw with or without regard to order, depending on whether it matters in which order
the objects are drawn. With these distinctions, there are four different cases, illustrated
in the following simple example.
Example 1.15. Choose two numbers from the set {1, 2, 3} and list the possible
outcomes.
Let us first choose with regard to order. If we choose with replacement, the possible
outcomes are
(1, 1), (1, 2), (1, 3), (2, 1), (2, 2), (2, 3), (3, 1), (3, 2), (3, 3)
and if we choose without replacement
(1, 2), (1, 3), (2, 1), (2, 3), (3, 1), (3, 2)
Next, let us choose without regard to order. This means that, for example, the outcomes
(1, 2) and (2, 1) are regarded as the same and we denote it by {1, 2} to stress that this
is the set of 1 and 2, not the ordered pair. If we choose with replacement, the possible
cases are
{1, 1}, {1, 2}, {1, 3}, {2, 2}, {2, 3}, {3, 3}
and if we choose without replacement
{1, 2}, {1, 3}, {2, 3}
□
To find expressions in the four cases for arbitrary values of n and k, we first need the
following result. It is intuitively quite clear, and we state it without proof.
Proposition 1.8. If we are to perform r experiments in order, such that there are
n1 possible outcomes of the first experiment, n2 possible outcomes of the second
experiment, . . . , nr possible outcomes of the rth experiment, then there is a total of
n1n2 · · · nr outcomes of the sequence of the r experiments.
This is called the fundamental principle of counting or the multiplication principle.
Let us illustrate it by a simple example.
Example 1.16. A Swedish license plate consists of three letters followed by three
digits. How many possible license plates are there?
Although there are 28 letters in the Swedish alphabet, only 23 are used for license
plates.Hencewehaver = 6,n1 = n2 = n3 = 23,andn4 = n5 = n6 = 10.Thisgives
a total of 233 × 103 ≈12.2 million different license plates.
□

FINITE SAMPLE SPACES AND COMBINATORICS
19
We can now address the problem of drawing k times from a set of n objects. It turns
out that choosing with regard to order is the simplest, so let us start with this and first
consider the case of choosing with replacement. The first object can be chosen in n
ways, and for each such choice, we have n ways to choose also the second object, n
ways to choose the third, and so on. The fundamental principle of counting gives
n × n × · · · × n = nk
ways to choose with replacement and with regard to order.
If we instead choose without replacement, the first object can be chosen in n ways,
the second in n −1 ways, since the first object has been removed, the third in n −2
ways, and so on. The fundamental principle of counting gives
n(n −1) · · · (n −k + 1)
ways to choose without replacement and with regard to order. Sometimes, the notation
(n)k = n(n −1) · · · (n −k + 1)
will be used for convenience, but this is not standard.
Example 1.17. From a group of 20 students, half of whom are female, a student
council president and vice president are chosen at random. What is the probability
of getting a female president and a male vice president?
The set of objects is the 20 students. Assuming that the president is drawn first,
we need to take order into account since, for example, (Brenda, Bruce) is a favorable
outcome but (Bruce, Brenda) is not. Also, drawing is done without replacement. Thus,
we have k = 2 and n = 20 and there are 20 × 19 = 380 equally likely different ways
to choose a president and a vice president. The sample space is the set of these 380
combinations and to find the probability, we need the number of favorable cases.
By the fundamental principle of counting, this is 10 × 10 = 100. The probability of
getting a female president and male vice president is 100
380 ≈0.26.
□
Example 1.18. A human gene consists of nucleotide base pairs of four different
kinds, A, C, G, and T. If a particular region of interest of a gene has 20 base pairs,
what is the probability that a randomly chosen individual has no base pairs in
common with a particular reference sequence in a database?
The set of objects is {A, C, G, T}, and we draw 20 times with replacement and with
regard to order. Thus k = 20 and n = 4, so there are 420 possible outcomes, and let
us, for the sake of this example, assume that they are equally likely (which would
not be true in reality). For the number of favorable outcomes, n = 3 instead of 4
since we need to avoid one particular letter in each choice. Hence, the probability is
320/420 ≈0.003.
□

20
BASIC PROBABILITY THEORY
Example 1.19 (The Birthday Problem). This problem is a favorite in the probability
literature. In a group of 100 people, what is the probability that at least two have the
same birthday?
To simplify the solution, we disregard leap years and assume a uniform distribution
of birthdays over the 365 days of the year. To assign birthdays to 100 people, we
choose 100 out of 365 with replacement and get 365100 different combinations. The
sample space is the set of those combinations, and the event of interest is
A = {at least two birthdays are equal}
and as it turns out, it is easier to deal with its complement
Ac = {all 100 birthdays are different}
To find the probability of Ac, note that the number of cases favorable to Ac is obtained
by choosing 100 days out of 365 without replacement and hence
P(A) = 1 −P(Ac) = 1 −365 × 364 × · · · × 266
365100
≈0.9999997
Yes, that is a sequence of six 9s followed by a 7! Hence, we can be almost certain
that any group of 100 people has at least two people sharing birthdays. A similar
calculation reveals the probability of a shared birthday already exceeds 1
2 at 23 peo-
ple, a quite surprising result. About 50% of school classes thus ought to have kids
who share birthdays, something that those with idle time on their hands can check
empirically.
□
A check of real-life birthday distributions will reveal that the assumption of birthdays
being uniformly distributed over the year is not true. However, the already high proba-
bility of shared birthdays only gets higher with a nonuniform distribution. Intuitively,
this is because the less uniform the distribution, the more difficult it becomes to avoid
birthdays already taken. For an extreme example, suppose that everybody was born
in January, in which case there would be only 31 days to choose from instead of 365.
Thus, in a group of 100 people, there would be absolute certainty of shared birthdays.
Generally, it can be shown that the uniform distribution minimizes the probability of
shared birthdays (we return to this in Problems 55 and 56).
Example 1.20 (The Birthday Problem Continued). A while ago I was in a group of
exactly 100 people and asked for their birthdays. It turned out that nobody had the
same birthday as I do. In the light of the previous problem, would this not be a very
unlikely coincidence?
No, because here we are only considering the case of avoiding one particular birthday.
Hence, with
B = {at least 1 out of 99 birthdays is the same as mine}

FINITE SAMPLE SPACES AND COMBINATORICS
21
we get
Bc = {99 birthdays are different from mine}
and the number of cases favorable to Bc is obtained by choosing with replacement
from the 364 days that do not match my birthday. We get
P(B) = 1 −P(Bc) = 1 −36499
36599 ≈0.24
Thus, it is actually quite likely that nobody shares my birthday, and it is at the same
time almost certain that at least somebody shares somebody else’s birthday.
□
Next, we turn to the case of choosing without regard to order. First, suppose that we
choose without replacement and let x be the number of possible ways, in which this
can be done. Now, there are n(n −1) · · · (n −k + 1) ways to choose with regard to
order and each such ordered set can be obtained by first choosing the objects and then
order them. Since there are x ways to choose the unordered objects and k! ways to
order them, we get the relation
n(n −1) · · · (n −k + 1) = x × k!
and hence there are
x = n(n −1) · · · (n −k + 1)
k!
(1.1)
ways to choose without replacement, without regard to order. In other words, this is
the number of subsets of size k of a set of size n, called the binomial coefficient, read
“n choose k” and usually denoted and defined as
n
k

=
n!
(n −k)!k!
but we use the expression in Equation (1.1) for computations. By convention,
n
0

= 1
and from the definition it follows immediately that
n
k

=

n
n −k

which is useful for computations. For some further properties, see Problem 24.

22
BASIC PROBABILITY THEORY
Example 1.21. In Texas Lotto, you choose five of the numbers 1, . . . , 44 and one
bonus ball number, also from 1, . . . , 44. Winning numbers are chosen randomly.
Which is more likely: that you match the first five numbers but not the bonus ball or
that you match four of the first five numbers and the bonus ball?
Since we have to match five of our six numbers in each case, are the two not equally
likely? Let us compute the probabilities and see. The set of objects is {1, 2, . . . , 44}
and the first five numbers are drawn without replacement and without regard to order.
Hence, there are
	44
5

combinations and for each of these there are then 44 possible
choices of the bonus ball. Thus, there is a total of
	44
5

× 44 = 47, 784, 352 different
combinations. Introduce the events
A = {match the first five numbers but not the bonus ball}
B = {match four of the first five numbers and the bonus ball}
For A, the number of favorable cases is 1 × 43 (only one way to match the first five
numbers, 43 ways to avoid the winning bonus ball). Hence
P(A) =
1 × 43
44
5

× 44
≈9 × 10−7
To find the number of cases favorable to B, note that there are
	5
4

= 5 ways to match
four out of five winning numbers and then
	39
1

= 39 ways to avoid the fifth winning
number. There is only one choice for the bonus ball and we get
P(B) = 5 × 39 × 1
44
5

× 44
≈4 × 10−6
so B is more than four times as likely as A.
□
Example 1.22. You are dealt a poker hand (5 cards out of 52 without replacement).
(a) What is the probability that you get no hearts? (b) What is the probability that
you get exactly k hearts? (c) What is the most likely number of hearts?
We will solve this by disregarding order. The number of possible cases is the number
of ways in which we can choose 5 out of 52 cards, which equals
	52
5

. In (a), to get
a favorable case, we need to choose all 5 cards from the 39 that are not hearts. Since
this can be done in
	39
5

ways, we get
P(no hearts) =
39
5

52
5
 ≈0.22

FINITE SAMPLE SPACES AND COMBINATORICS
23
In (b), we need to choose k cards among the 13 hearts, and for each such choice, the
remaining 5 −k cards are chosen among the remaining 39 that are not hearts. This
gives
P(k hearts) =
13
k
 39
5 −k

52
5

,
k = 0, 1, . . . , 5
and for (c), direct computation gives the most likely number as 1, which has
probability 0.41.
□
The problem in the previous example can also be solved by taking order into account.
Hence, we imagine that we get the cards one by one and list them in order and note
that there are (52)5 different cases. There are (13)k(39)5−k ways to choose so that
we get k hearts and 5 −k nonhearts in a particular order. Since there are
	5
k

ways to
choose position for the k hearts, we get
P(k hearts) =
5
k

(13)k(39)5−k
(52)5
which is the same as we got when we disregarded order above. It does not matter
to the solution of the problem whether we take order into account, but we must be
consistent and count the same way for the total and the favorable number of cases. In
this particular example, it is probably easier to disregard order.
Example 1.23. An urn contains 10 white balls, 10 red balls, and 10 black balls. You
draw ﬁve balls at random without replacement. What is the probability that you do
not get all colors?
Introduce the events
R = {no red balls}, W = {no white balls}, B = {no black balls}
The event of interest is then R ∪W ∪B, and we will apply Proposition 1.4. First note
that by symmetry, P(R) = P(W) = P(B). Also, each intersection of any two events
has the same probability and finally R ∩W ∩B = ∅. We get
P(not all colors) = 3P(R) −3P(R ∩W)
In order to get no red balls, the 5 balls must be chosen among the 20 balls that are not
red and hence
P(R) =
20
5
 30
5


24
BASIC PROBABILITY THEORY
Similarly, to get neither red nor white balls, the ﬁve balls must be chosen among the
black balls and
P(R ∩W) =
10
5
 30
5

We get
P(not all colors) = 3
20
5

−
10
5
 30
5

≈0.32
□
Example 1.24. The final case, choosing with replacement and without regard to order,
turns out to be the trickiest. As we noted above, when we choose without replacement,
each unordered set of k objects corresponds to exactly k! ordered sets. The relation is
not so simple when we choose with replacement. For example, the unordered set {1, 1}
corresponds to one ordered set (1, 1), whereas the unordered set {1, 2} corresponds
to two ordered sets (1, 2) and (2, 1). To find the general expression, we need to take
a less direct route.
Imagine a row of n slots, numbered from 1 to n and separated by single walls where
slot number j represents the jth object. Whenever object j is drawn, a ball is put in slot
number j. After k draws, we will thus have k balls distributed over the n slots (and slots
corresponding to objects never drawn are empty). The question now reduces to how
many ways there are to distribute k balls over n slots. This is equivalent to rearranging
the n −1 inner walls and the k balls, which in turn is equivalent to choosing positions
for the k balls from a total of n −1 + k positions. But this can be done in
	n−1+k
k

ways, and hence this is the number of ways to choose with replacement and without
regard to order.
□
Example 1.25. The Texas Lottery game “Pick 3” is played by picking three numbers
with replacement from the numbers 0, 1, . . . , 9. You can play “exact order” or
“any order.” With the “exact order” option, you win when your numbers match the
winning numbers in the exact order they are drawn. With the “any order” option, you
win whenever your numbers match the winning numbers in any order. How many
possible winning combinations are there with the “any order” option?
We have n = 10, k = 3, and the winning numbers are chosen with replacement and
without regard to order and hence there are
10 −1 + 3
3

=
12
3

= 220
possible winning combinations.
□

FINITE SAMPLE SPACES AND COMBINATORICS
25
Example 1.26. Draw twice from the set {1, . . . , 9} at random with replacement.
What is the probability that the two drawn numbers are equal?
We have n = 9 and k = 2. Taking order into account, there are 9 × 9 = 81 possible
cases, 9 of which are favorable. Hence the probability is
9
81 = 1
9. If we disregard
order, we have
	9−1+2
2

= 45 possible cases and still 9 favorable and the probability
is 9
45 = 1
5. Since whether we draw with or without regard to order does not seem to
matter to the question, why do we get different results?
The problem is that in the second case, when we draw without regard to order,
the distribution is not uniform. For example, the outcome {1, 2} corresponds to the
two equally likely ordered outcomes (1, 2) and (2, 1) and is thus twice as likely as
the outcome {1, 1}, which corresponds to only one ordered outcome (1, 1). Thus, the
first solution 1
9 is correct.
□
Thus, when we draw with replacement but without regard to order, we must be careful
when we compute probabilities, since the distribution is not uniform, as it is in the
other three cases. Luckily, this case is far more uncommon in applications than are
the other three cases. There is one interesting application, though, that has to do
with the number of integer solutions to a certain type of equation. If we look again
at the way in which we arrived at the formula and let xj denote the number of balls
in slot j, we realize that we must have x1 + · · · + xn = k and get the following
observation.
Corollary 1.2. There are
	n−1+k
k

nonnegative integer solutions (x1, . . . , xn) to the
equation x1 + · · · + xn = k.
The four different ways of choosing k out of n objects are summarized in Table 1.2.
Note that when we choose without replacement, k must be less than or equal to n, but
when we choose with replacement, there is no such restriction.
We finish with another favorite problem from the probability literature. It combines
combinatorics with previous results concerning the probability of a union.
Example 1.27 (The Matching Problem). The numbers 1, 2, . . . , n are listed in
random order. Whenever a number remains in its original position in the permutation,
we call this a “match.” For example, if n = 5, then there are two matches in the
TABLE 1.2
Choosing k Out of n Objects
With Replacement
Without Replacement
With regard to order
nk
n(n −1) · · · (n −k + 1)
Without regard to order

n −1 + k
k


n
k


26
BASIC PROBABILITY THEORY
permutation 32541 and none in 23451. (a) What is the probability that there are no
matches? (b) What happens to the probability in (a) as n →∞?
Before we solve this, let us try to think about part (b). Does it get easier or harder
to avoid matches when n is large? It seems possible to argue for both. With so many
choices, it is easy to avoid a match in each particular position. On the other hand,
there are many positions to try, so it should not be too hard to get at least one match.
It is not easy to have good intuition for what happens here.
To solve the problem, we first consider the complement of no matches and intro-
duce the events
A = {at least one match}
Ak = {match in the kth draw}, k = 1, 2, . . . , n
so that
A =
n
k=1
Ak
We will apply Proposition 1.5, so we need to figure out the probabilities of the events
Ak as well as all intersections of two events, three events, and so on.
First, note that there are n! different permutations of the numbers 1, 2, . . . , n. To
get a match in position k, there is only one choice for that number and the rest can be
ordered in (n −1)! different ways. We get the probability
P(Ak) = # favorable outcomes
# possible outcomes
= (n −1)!
n!
= 1
n
which means that the first sum in Proposition 1.5 equals 1. To get a match in both
the ith and the jth positions, we have only one choice for each of these two positions
and the remaining n −2 numbers can be ordered in (n −2)! ways and
P(Ai ∩Aj) = (n −2)!
n!
=
1
n(n −1)
Since there are
	n
2

ways to select two events Ai and Aj, we get the following equation
for the second sum in Proposition 1.5:

i<j
P(Ai ∩Aj) =
n
2

1
n(n −1)
= n(n −1)
2!
×
1
n(n −1) =
1
2!

CONDITIONAL PROBABILITY AND INDEPENDENCE
27
Proceeding to the third sum, a similar argument gives that, for fixed i < j < k,

i<j<k
P(Ai ∩Aj ∩Ak) =
n
3

×
1
n(n −1)(n −2) = 1
3!
and the pattern emerges. The jth sum in Proposition 1.5 equals 1/j!, and with the
alternating signs we get
P(at least one match) = 1 −
n

j=2
(−1)j
j!
= 1 −
n

j=0
(−1)j
j!
which finally gives
P(no matches) =
n

j=0
(−1)j
j!
This is interesting. First, the probability is not monotone in n, so we cannot say
that it gets easier or harder to avoid matches as n increases. Second, as n →∞,
we recognize the limit as the Taylor expansion of e−1 and hence the probability of
no matches converges to e−1 ≈0.37 as n →∞. We can also note how rapid the
convergence is; already for n = 4, the probability is 0.375. Thus, for all practical
purposes, the probability to get no matches is 0.37 regardless of n. In Problem 36,
you are asked to find the probability of exactly j matches.
□
1.5
CONDITIONAL PROBABILITY AND INDEPENDENCE
In this section, we introduce the important notion of conditional probability. The idea
behind this concept is that the value of a probability can change if we get additional
information. For example, the probability of contracting lung cancer is higher among
smokers than nonsmokers and the probability of voting Republican is higher in Texas
than in Massachusetts.
To arrive at a formal definition of conditional probabilities, we consider the ex-
ample with the dartboard from Example 1.9. Suppose you throw darts repeatedly
at random on a dartboard and consider only those darts that hit the number 14. In
the long run, what proportion of those will also be doubles? Since the area of 14 is
142/20 = 7.1 in.2 and the area of the double ring inside 14 is 15/20 = 0.75 in.2, in the
long run we expect the proportion 0.75/7.1 ≈0.11 of hits of 14 to also be doubles.
To express this as a statement about probabilities, we can say that if we know that
a dart hits 14, the probability that it is also a double is 0.11. Since the probability
of 14 is P(F) = 7.1/143 and of both double and 14 is P(F ∩D) = 0.75/143, we
see that the probability that a dart hits a double if we know that it hits 14 is the ratio
P(F ∩D)/P(F).
Now, consider a sample space in general and let A and B be two events. If we know
that B occurred in an experiment, what is the probability that A also occurred? We

28
BASIC PROBABILITY THEORY
can draw a Venn diagram and apply the same reasoning as above. Since the fraction of
area of A inside B is P(A ∩B)/P(B), it seems reasonable that this is the probability
we seek. This is the intuition behind the following definition.
Deﬁnition 1.4. Let B be an event such that P(B) > 0. For any event A, denote and
define the conditional probability of A given B as
P(A|B) = P(A ∩B)
P(B)
We think of this as the probability of A if we know that B has occurred. Hence, to
compute a conditional probability means to compute a probability given additional
information.
Example 1.28. Let us revisit Mrs B and Mrs T from Example 1.7. If we introduce a
third event
C = {he is shabby-looking}
then one way to interpret Mrs T’s comment “that sounds more probable” is that
P(A|B ∩C) > P(A|C)
that is, given that more of the background is known, it seems more likely that the
person is who Mrs B says he is.
□
Example 1.29. Roll a die and observe the number. Let
A = {odd outcome} and B = {at least 4}
What is P(A|B)?
We solve this in two different ways: (1) by using the definition and (2) by intuitive
reasoning. Since P(A ∩B) = P({5}) = 1
6 and P(B) = 1
2, the definition gives
P(A|B) = P(A ∩B)
P(B)
= 1/6
1/2 = 1
3
If we think about this intuitively, to condition on the event B means that we get the
additional information that the outcome is at least 4. Since one of these three outcomes
is also odd and outcomes are equally likely, the conditional probability of odd is 1
3. □
There is no general rule for whether it is easier to use the definition or intuitive
reasoning. In the previous example, the “one out of three” approach works since
outcomes are equally likely, but this is not always the case.
Conditional probabilities can make it easier to compute probabilities of inter-
sections. Say that we want to compute P(A ∩B) but that it is tricky to do so

CONDITIONAL PROBABILITY AND INDEPENDENCE
29
directly. However, if we can find P(B) and P(A|B), then the definition tells us that
P(A ∩B) = P(A|B)P(B) and we are done. Let us look at some examples of this.
Example 1.30. In Example 1.8, we had the events A = {rain on Saturday} and
B = {rain on Sunday}, where P(A) = P(B) = 0.5. Now, suppose that a rainy day is
followed by another rainy day with probability 0.7. What is the probability of rain
during the weekend?
We already know that the probability of a rainy weekend is
P(A ∪B) = 1 −P(A ∩B)
where we can now compute P(A ∩B) as
P(A ∩B) = P(B|A)P(A) = 0.7 × 0.5 = 0.35
and we get
P(A ∪B) = 0.65
as the probability of rain during the weekend.
□
Example 1.31. From a deck of cards, draw four cards at random, without replace-
ment. If you get j aces, draw j cards from another deck. What is the probability of
getting exactly two aces from each deck?
With
A = {two aces from the first deck}
B = {two aces from the second deck}
the event of interest is A ∩B, and it is not that easy to figure out its probability
directly. However, if we use conditional probabilities, it is simple. We get
P(A) =
4
2
48
2

52
4

and
P(B|A) =
4
2

52
2

and hence
P(A ∩B) = P(B|A)P(A) =
4
2
48
2

52
4

×
4
2

52
2
 ≈0.0001
□

30
BASIC PROBABILITY THEORY
Example 1.32. The online bookseller amazon.com has a feature called the “Gold
Box.” When you enter this, you are presented with 10 special offers to buy various
merchandise, anything from books and DVDs, to kitchenware and the “Panasonic
ER411NC nose and ear hair groomer.” The offers are presented one at a time and
each time you have to decide whether to take it or to pass. If you take it, you are done
and will not get to see the rest of the offers. If you pass, that offer is gone and cannot
be retrieved. Suggest a strategy that gives you at least 25% chance to win the best offer.
Let us assume that the offers are presented in random order. If your strategy is to
always take the first offer or if you choose at random, your chance to win is 10%.
How can this be improved?
A better strategy is to let five offers pass, remember the best thus far, and take the
next offer that is better. If this never happens, you are forced to take the last offer.
One case in which you will certainly win is if the second best offer is among the first
five and the best is among the remaining five. Thus, let
A = {second best offer is among the first five}
B = {best offer is among the last five}
so that the event of interest is A ∩B, which has probability
P(A ∩B) = P(A|B)P(B)
Since the offers are randomly ordered, the best offer is equally likely to be in any
position and hence P(B) = 5
10. Given that the best is among the last five, the second
best is equally likely to be any of the remaining nine, so the probability that it is
among the first five is P(A|B) = 5
9 and we get
P(get the best offer) = 5
9 × 5
10 ≈0.28
which is larger than 0.25. Note that A ∩B is not the only way in which you can get
the best offer, so the true probability is in fact higher than 0.28.
Generally, if there are n offers, the same strategy gives a probability to get the best
offer that is at least
P(A ∩B) = P(A|B)P(B) = n/2
n −1 × n/2
n
=
n
4(n −1)
which is greater than 1
4 regardless of n [if n is odd, we can replace n/2 by (n + 1)/2].
It is quite surprising that we can do so well and for example have at least 25%
chance to find the best of 10 million offers. It can be shown that an even better
strategy is to first discard roughly ne−1 offers and then take the next that is better. The
probability to win is then approximately e−1 ≈0.37 (a number that also showed up in
Example 1.27).
□

CONDITIONAL PROBABILITY AND INDEPENDENCE
31
The way in which we have defined conditional probability makes good intuitive sense.
However, remember that a probability is defined as something that satisfies the three
axioms in Definition 1.3. We must therefore show that whenever we condition on an
event B, the definition of conditional probability does not violate any of the axioms.
We state this in a proposition.
Proposition 1.9. For fixed B, P(A|B) satisfies the probability axioms:
(a) 0 ≤P(A|B) ≤1
(b) P(S|B) = 1
(c) If A1, A2, . . . is a sequence of pairwise disjoint events, then
P
 ∞

k=1
Ak
 B

=
∞

k=1
P(Ak|B)
Proof. Since A ∩B ⊆B, we get 0 ≤P(A ∩B) ≤P(B) and part (a) follows. For (b),
note that B ⊆S so that P(S ∩B) = P(B) and hence P(S|B) = 1. Finally, for (c) first
note that
 ∞

k=1
Ak

∩B =
∞

k=1
(Ak ∩B)
and since A1, A2, . . . are pairwise disjoint, so are the events A1 ∩B, A2 ∩B, . . . ,
and we get
P
 ∞

k=1
Ak

∩B

=
∞

k=1
P(Ak ∩B)
Divide both sides with P(B) to conclude the proof.
■
It is easily realized that P(B|B) = 1, and with this in mind, we can think of
conditioning on B as viewing B as the new sample space. The nice thing about the
proposition is that we now know that conditional probabilities have all the properties
of probabilities that we stated in Proposition 1.3. We restate these properties for
conditional probabilities in a corollary.
Corollary 1.3. Provided that the conditional probabilities are defined, the following
properties hold:
(a) P(Ac|B) = 1 −P(A|B)
(b) P(B \ A|C) = P(B|C) −P(A ∩B|C)

32
BASIC PROBABILITY THEORY
(c) P(A ∪B|C) = P(A|C) + P(B|C) −P(A ∩B|C)
(d) If A ⊆B, then P(A|C) ≤P(B|C)
It is important to keep in mind that properties of probabilities hold for events to the
left of the conditioning bar and that the event to the right is fixed (see Problem 37).
If we think of probability as a measure of degree of belief, we can think of condi-
tional probability as an update of that degree, in the light of new information. Here
is an example of a logical oddity that philosophers of science love to toss around to
confuse the rest of us.
Example 1.33. Consider the hypothesis “all swans are white.” We can say that
each observation of a white swan strengthens our belief in, or corroborates, the
hypothesis. Also, since the two statements “all swans are white” and “all nonwhite
objects are nonswans” are logically equivalent, the hypothesis is also corroborated
by the observation of something that is neither white nor a swan. Thus, every sighting
of a yellow dog corroborates the hypothesis that all swans are white.3
Weird, isn’t it? A zoologist trying to prove the hypothesis would certainly decide
to examine swans for whiteness, rather than checking various red, green, and blue
objects to make sure that they are not swans. Still, there is certainly nothing wrong
with the logic, so how can the paradox be resolved? Let us try a probabilistic approach.
Suppose that we have all examinable objects in a big urn. Suppose that there are
n such objects, k of which are white, and that the other n −k are black (representing
“nonwhite”). Suppose further that j of the objects are swans, and call the remaining
objects “ravens,” another favorite bird among philosophers of science. If we do not
know anything about the whiteness of swans, we may assume that the j swans are
randomly spread among the n objects. Thus, when we choose a swan, the probability
that it is white is k
n (if we have very strong belief in the hypothesis to begin with, we
can just introduce a lot of white “dummy objects” to make this probability anything
we want). The probability that the hypothesis is true can now be thought of as the
probability to get only white objects when we draw without replacement j times
(assign the “swan property” to j objects). Our hypothesis is then the event
H = {all swans are white} = {get j white objects}
Let us choose with regard to order (which does not matter to the problem, but expres-
sions get less messy). Thus, the probability that all swans are white is
P(H) = k(k −1) · · · (k −j + 1)
n(n −1) · · · (n −j + 1)
3For ornithologists: This has nothing to do with Cygnus atratus.

CONDITIONAL PROBABILITY AND INDEPENDENCE
33
We now follow two different strategies: (a) to examine swans and (b) to examine
black objects. Suppose that we get a corroborating observation. How does this affect
the probability of H, now pertaining to the remaining n −1 objects? Let Ca and Cb
be the events to get corroborating observations with the two strategies, respectively.
With strategy (a), a corroborating observation means that one white swan has been
removed, and the conditional probability of H becomes
P(H|Ca) = (k −1)(k −2) · · · (k −j + 1)
(n −1)(n −2) · · · (n −j + 1)
With strategy (b), one black raven has been removed, and we get
P(H|Cb) =
k(k −1) · · · (k −j + 1)
(n −1)(n −2) · · · (n −j)
Both these are larger than the original P(H), so each corroborating observation indeed
strengthens belief in the hypothesis. But do they do so to equal extents? Let us compare
the two conditional probabilities. We get
P(H|Ca)
P(H|Cb) = n −j
k
If we now assume that the number of swans is less than the number of black objects,
certainly a reasonable assumption, we have that j < n −k, which gives k < n −j,
and hence
P(H|Ca)
P(H|Cb) > 1
so that the observation of a black raven does corroborate the hypothesis but not as
much as the sighting of a white swan. The intuition is simple: since there are fewer
swans than black objects, it is easier to check the swans. If instead j > n −k, strategy
(b) would be preferable. If we, for example, were to corroborate the hypothesis “All
Volvo drivers live outside the Vatican,” it would be better to ask a thousand Vaticanos
what they drive, than to track down Volvo drivers in London and Paris to check if
they happen to be vacationing Swiss Guardsmen.
□
1.5.1
Independent Events
In the previous section, we dealt with conditional probabilities and learned to interpret
them as probabilities that are computed given additional information. It is easy to
think of cases when such additional information is irrelevant and does not change the
probability. For example, if we are about to ﬂip a fair coin, the probability to get heads
is 1
2. Now suppose that we get the additional information that the coin was ﬂipped once
yesterday and showed heads. Since our upcoming coin ﬂip is not affected by what
happened yesterday and we know that the coin is fair, the conditional probability given
this information is still 1
2. With A = {heads in next ﬂip} and B = {heads yesterday}
we thus have P(A) = P(A|B); the unconditional and conditional probabilities are the

34
BASIC PROBABILITY THEORY
same. Since P(A|B) = P(A ∩B)/P(B), this means that P(A ∩B) = P(A)P(B), and
we call two events with this property independent.
Deﬁnition 1.5. If A and B are two events such that
P(A ∩B) = P(A)P(B)
then they are said to be independent.
Not surprisingly, events that are not independent are called dependent. In the intro-
ductory motivation for the definition, we talked about conditional and unconditional
probabilities being equal. We could take this as the definition of independence, but
since conditional probabilities are not always defined, we use the definition of inde-
pendence above and get the following consequence.
Corollary 1.4. If P(A|B) is defined, then the events A and B are independent if
and only if P(A) = P(A|B).
When checking for independence, it might sometimes be easier to condition on the
eventBc insteadofB,thatis,bysupposingthatB didnotoccur.Intuitively,information
regarding B and information on Bc are equivalent since saying that one occurred is
the same as saying that the other one did not occur. This is stated formally as follows.
Proposition 1.10. If A and B are independent, then A and Bc are also independent.
Proof. By Proposition 1.3(b), we get
P(A ∩Bc) = P(A \ B) = P(A) −P(A ∩B)
and if A and B are independent, this equals
P(A) −P(A)P(B) = P(A)(1 −P(B)) = P(A)P(Bc)
and A and Bc are independent.
■
Example 1.34. In Example 1.30, suppose that a rainy Saturday and a rainy Sunday
are independent events. What is the probability of rain during the weekend?
In this case
P(A ∩B) = P(A)P(B) = 0.25

CONDITIONAL PROBABILITY AND INDEPENDENCE
35
and hence
P(A ∪B) = 0.75
which we note is higher than the 0.65 we obtained if rainy Saturdays are more likely
to be followed by rainy Sundays. The reason is that under this assumption, rainy
Saturdays and Sundays tend to come together more often than under the independence
assumption.
□
Example 1.35. A card is chosen at random from a deck of cards. Consider the events
A = {the card is an ace}
and
H = {the card is a heart}
Are A and H independent?
Let us first solve this by using the definition. We have P(A) = 4
52, P(H) = 1
4, and
P(A ∩H) = P(ace of hearts) = 1
52 and hence
P(A ∩H) = P(A)P(H)
so that A and H are independent. Intuitively, the events give no information about
each other. The probability of drawing an ace is
4
52 = 1
13 and if we are given the
information that the chosen card is a heart, the probability of an ace is still 1
13. The
proportion of aces is the same in the deck as within the suit of hearts.
□
Example 1.36. Consider the previous example but suppose that we have removed
the 2 of spades from the deck. Are the events A and H still independent?
At first glance, we might think that the answer is “Yes” since the 2 of spades
has nothing to do with either hearts or aces. However, the probabilities are now
P(A) = 4
51, P(H) = 13
51, and P(A ∩H) = P(ace of hearts) = 1
51 and hence
P(A ∩H) /= P(A)P(H)
and A and H are no longer independent. Intuitively, although the 2 of spades has
nothing to do with hearts or aces, its removal changes the proportion of aces in the
deck from 4
52 to 4
51 but does not change the proportion within the suit of hearts, where
it remains at 1
13. Formulated as a statement about conditional probabilities, we have
that
P(A) = 4
51
and
P(A|H) = 1
13
which are not equal.
□

36
BASIC PROBABILITY THEORY
Example 1.37. Are disjoint events independent?
It seems that disjoint events have nothing to do with each other and should thus be
independent. However, this reasoning is faulty. The correct reasoning is that if we
condition on one event having occurred, then the other cannot have occurred, and
hence its conditional probability drops to 0. We can also see this from the definition
of independence since if A and B are disjoint, then A ∩B = ∅and hence P(A ∩B) =
P(∅) = 0, which does not equal the product P(A)P(B) (assuming that neither of these
probabilities equal 0). Hence, the answer in general is “absolutely not.”
□
In Example 1.36, the events {ace} and {hearts} are dependent. Computation yields that
P(A) = 0.078 and P(A|H) = 0.077, so the difference is negligible from a practical
point of view. We could say that although the events are dependent, the dependence is
not strong. Compare this with the case of disjoint events where the conditional prob-
ability drops down to 0, which indicates a much stronger dependence. Dependence
could also go in different directions; P(A|B) could be either larger or smaller than
P(A). We will later return to the problem of measuring the degree of dependence in
a more general context (see also Problem 42).
The following two examples illustrate how it is not always obvious which event
to condition on and how it is important to find the correct such event.
Example 1.38. You know that your new neighbors have two children. Given that
they have at least one daughter, what is the conditional probability that they have two
daughters?
The sample space is
S = {bb, bg, gb, gg}
where b represents boy, g represents girl, and the order is birth order. If we assume
that genders are equally likely and that genders of different children are independent,
each outcome has probability 1
4. Since the outcome bb is out of the question and
one out of the other three outcomes has two girls, the conditional probability is 1
3.
Formally
P(gg|bg, gb, gg) =
P(gg)
P(bg, gb, gg) = 1/4
3/4 = 1
3
□
Example 1.39. You know that your new neighbors have two children. One day you
see the mother taking a walk with a girl. What is the probability that the other child
is also a girl?
This looks like the same problem. On the basis of your observation, you rule out the
outcome bb and the conditional probability of another girl is 1
3. On the other hand,

CONDITIONAL PROBABILITY AND INDEPENDENCE
37
since we assume that genders of different children are independent, the probability
ought to be 1
2.
Confusing? Let us clear it up. The first solution is incorrect, but why? While it
is true that the probability of two girls, given at least one girl, is 1
3, this is not the
correct event on which to condition in this case. We are not just observing “at least
one girl;” we are observing the mother walking with a particular girl. This distinction
is important but quite subtle, and requires that we extend the sample space to be able
to also describe how the mother chooses which child to walk with.4 Thus, we split
each outcome into two, and if we denote the child that goes for the walk by an asterisk,
the new sample space is
S = {b∗b, bb∗, b∗g, bg∗, g∗b, gb∗, g∗g, gg∗}
where, for example, b∗g means that the older child is a boy, and the younger, a girl,
and that the mother takes a walk with the boy. If the mother chooses child at random,
each outcome has probability 1
8. It is now easy to see that four outcomes have the
mother walking with a girl and that two of these have another girl, and we arrive at
the solution 1
2 once more (see also Problem 80).
□
We also want to define independence of more than two events. To arrive at a
reasonable definition, let us first examine an example that highlights one of the
problems that must be addressed.
Example 1.40. Flip two fair coins and consider the events
A = {heads in first ﬂip} = {HH, HT}
B = {heads in second ﬂip} = {HH, TH}
C = {different in first and second ﬂip} = {HT, TH}.
Then, for example, P(A ∩B) = P(HH) = 1
4 = P(A)P(B), so A and B are indepen-
dent. Similarly, it is easy to show that any two of the events are independent. Hence,
these events are pairwise independent. However, it does not seem quite right to say
that the three events A, B, and C are independent since, for example, C is not inde-
pendent of the event A ∩B. Indeed, P(C) = 1
2 but P(C|A ∩B) = 0, since if A ∩B
has occurred, both ﬂips showed heads and C is impossible.
□
This example indicates that in order to call three events independent, we want each
event to be independent of any combination of the other two. It turns out that the
following definition guarantees this (see Problem 53).
4Ironically, in the first edition of his excellent book Innumeracy: Mathematical Illiteracy and Its Conse-
quences, John Allen Paulos described this problem a bit obscurely [4]. His terse formulation was “Consider
now some randomly selected family of four. Given that Myrtle has a sibling, what is the conditional prob-
ability that her sibling is a brother?” and he went on to claim that the probability is 2
3 . This ambiguity was
clarified in the 2001 edition.

38
BASIC PROBABILITY THEORY
Deﬁnition 1.6. Three events A, B, and C are called independent if the following
two conditions hold:
(a) They are pairwise independent
(b) P(A ∩B ∩C) = P(A)P(B)P(C)
For more than three events, the definition is analogous and can also be extended to
infinitely many events.
Deﬁnition 1.7. The events A1, A2, . . . are called independent if
P(Ai1 ∩Ai2 ∩· · · ∩Aik) = P(Ai1)P(Ai2) · · · P(Aik)
for all sequences of integers i1 < i2 < · · · < ik, k = 2, 3, . . .
Sometimes events satisfying this definition are called mutually independent, to dis-
tinguish from pairwise independent, which, as we have seen, is a weaker property.
Example 1.41. Recall the experiment of rolling a die repeatedly until the first 6
appears. What is the probability that this occurs in the nth roll for n = 1, 2, . . . ?
The event of interest is
Bn = {first 6 in nth roll},
n = 1, 2, . . .
and let us also introduce the events
Ak = {6 in kth roll},
k = 1, 2, . . .
Note the difference: Bn is the event that the first 6 comes in the nth roll; Ak, the event
that we get 6 in the kth roll but not necessarily for the first time. How do the events
relate to each other? Obviously, B1 = A1. For n = 2, note that B2 is the event that
we do not get 6 in the first roll and that we do get 6 in the second roll. In terms of the
Ak, this is Ac
1 ∩A2. In general
Bn = Ac
1 ∩Ac
2 ∩· · · ∩Ac
n−1 ∩An
To compute the probability of Bn, we make two reasonable assumptions: that the die
is fair and that rolls are independent. The first assumption means that P(Ak) = 1
6 for

CONDITIONAL PROBABILITY AND INDEPENDENCE
39
all k and the second that probabilities of intersections equal products of probabilities.
Since independence carries over to complements, we get
P(Bn) = P(Ac
1 ∩Ac
2 ∩· · · ∩Ac
n−1 ∩An)
= P(Ac
1)P(Ac
2) · · · P(Ac
n−1)P(An)
= 5
6 × 5
6 × · · · × 5
6 × 1
6
and we conclude that
P(Bn) = 1
6
5
6
n−1
, n = 1, 2, . . .
□
More generally, consider independent repetitions of a trial where the event A occurs
with probability p > 0 and let E be the event that we never get A. With
Bn = {first occurrence ofA comes after the nth trial}
we have
E =
∞

n=1
Bn
where
P(Bn) = P(the first n trials give Ac) = (1 −p)n
by independence. The Bn are clearly decreasing (why?), so by Proposition 1.6 we get
P(E) = lim
n→∞P(Bn) = 0
and we summarize in the following corollary.
Corollary 1.5. In independent repetitions of a trial, any event with positive proba-
bility occurs sooner or later.
From Example 1.21, we can compute the probability to win the Texas Lotto jackpot
(match all numbers including bonus ball) as 1/47, 784, 352 = 2.1 × 10−8. This is
very small, but if you keep playing, the last result tells you that you will win even-
tually.5 It may take some time, though; there are two draws a week and if you play
every time for 50 years, the probability that you never win is
(1 −2.1 × 10−8)5200 ≈0.9999
5The subtle difference between certain occurrence and occurrence with probability one is important in a
more advanced study of probability theory but not for us at this point.

40
BASIC PROBABILITY THEORY
The probability that you win in a drawing is very low, but since there are millions
of players in each draw, the probability that somebody wins is much higher. Suppose
that 5 million number combinations are played independently and at random for a
drawing. The probability that somebody wins is
1 −(1 −2.1 × 10−8)5,000,000 ≈0.10
which is not that low, and it could be you.
Example 1.42 (Reliability Theory). Consider a system of two electronic compo-
nents connected in series. Each component functions with probability p and the
components function independent of each other. What is the probability that the
system functions?
If we interpret “functions” as the natural “lets current through,” then the system
functions if and only if both components function. Hence, with the events
A = {system functions}
A1 = {first component functions}
A2 = {second component functions}
we get A = A1 ∩A2 and by independence
P(A) = P(A1)P(A2) = p2
If the components are instead connected in parallel, the system functions as long as
at least one of the components function, and we have
A = A1 ∪A2
which gives
P(A) = P(A1 ∪A2) = 1 −P(Ac
1 ∩Ac
2)
= 1 −(1 −P(A1))(1 −P(A2)) = 1 −(1 −p)2
These are simple examples from the discipline of reliability theory where the proba-
bility of functioning is referred to as the reliability of a system. Hence, we have seen
that the reliability of a series system is p2 and that of a parallel system is 1 −(1 −p)2.
An obvious generalization is to n components, where the reliability of a series system
is pn and that of a parallel system is 1 −(1 −p)n. This does not have to be about
electronic components but applies to any situation where a complex system is depen-
dent on its individual parts to function. The series system is sometimes referred to as
a weakest-link model.
□

THE LAW OF TOTAL PROBABILITY AND BAYES’ FORMULA
41
1.6
THE LAW OF TOTAL PROBABILITY AND BAYES’ FORMULA
In this section, we will address one of the most important uses of conditional proba-
bilities. The basic idea is that if a probability is hard to compute directly, it might help
to break the problem up in special cases, where in each special case the conditional
probability is easier to compute. For example, suppose that you buy a used car in
a city where street ﬂooding due to heavy rainfall is a common problem. You know
that roughly 5% of all used cars have previously been ﬂood-damaged and estimate
that 80% of such cars will later develop serious engine problems, whereas only 10%
of used cars that are not ﬂood-damaged develop the same problems. What is the
probability that your car will later run into this kind of trouble?
Here is a situation where you can compute the probability in each of two different
cases, ﬂood-damaged or not ﬂood-damaged (and no used-car dealer worth his salt
would ever let you know which).
Let us first think about this in terms of proportions. Out of every 1000 cars sold,
50 are previously ﬂood-damaged and of those, 80%, or 40 cars, will develop serious
engine problems. Among the 950 that are not ﬂood-damaged, we expect 10%, or 95
cars, to develop the same problems. Hence, we get a total of 40 + 95 = 135 cars out
of a 1000, and the probability of future problems is 0.135.
If we introduce the events F = {ﬂood-damaged} and T = {trouble}, we have ar-
gued that P(T) = 0.135. We also know that P(F) = 0.05, P(Fc) = 0.95, P(T|F) =
0.80, and P(T|Fc) = 0.10 and the probability we computed is in fact 0.80 × 0.05 +
0.10 × 0.95 = 0.135. Our probability is a weighted average of the probability in
the two different cases, ﬂood-damaged or not, and the weights are the correspond-
ing probabilities of the cases. The example illustrates the idea behind the following
important result.
Theorem 1.1 (Law of Total Probability). Let B1, B2, . . . be a sequence of events
such that
(a) P(Bk) > 0 for k = 1, 2, . . .
(b) Bi and Bj are disjoint whenever i /= j
(c) S =
∞

k=1
Bk
Then, for any event A, we have
P(A) =
∞

k=1
P(A|Bk)P(Bk)
Condition (a) is a technical requirement to make sure that the conditional probabilities
are defined, and you may recall that a collection of sets satisfying (b) and (c) is called
a partition of S.

42
BASIC PROBABILITY THEORY
Proof. First note that
A = A ∩S =
∞

k=1
(A ∩Bk)
by the distributive law for infinite unions. Since A ∩B1, A ∩B2, . . . are pairwise
disjoint, we get
P(A) =
∞

k=1
P(A ∩Bk) =
∞

k=1
P(A|Bk)P(Bk)
which proves the theorem.
■
By virtue of Proposition 1.2, we realize that the law of total probability is also true for
a finite union of events, B1, . . . , Bn. In particular, if we choose n = 2 and B1 equal
to some event B, then B2 must equal Bc, and we get the following corollary.
Corollary 1.6. If 0 < P(B) < 1, then
P(A) = P(A|B)P(B) + P(A|Bc)P(Bc)
The verbal description of conditions (b) and (c) in Theorem 1.1 is that we are able
to find different cases that exclude each other and cover all possibilities. This way
of thinking about it is often sufficient to solve problems and saves us the effort to
explicitly find the sample space and the partitioning events.
Example 1.43. A sign reads HOUSTON. Two letters are removed at random and
then put back together again at random in the empty spaces. What is the probability
that the sign still reads HOUSTON?
There are two different cases to consider: the case where two Os are chosen, in
which case the text will always be correct and the case when two different letters are
chosen, in which case the text will be correct when they are put back in their original
order. Clearly, these two cases exclude each other and cover all possibilities and the
assumptions in the law of total probability are satisfied. Hence, without spelling out
exactly what the sample space is, we can define the events
A = {the sign still reads HOUSTON}
B = {two Os are chosen}
and obtain
P(A) = P(A|B)P(B) + P(A|Bc)P(Bc)

THE LAW OF TOTAL PROBABILITY AND BAYES’ FORMULA
43
If the two letters are different, they are put back in their original order with probability
1
2. Hence, the conditional probabilities are
P(A|B) = 1
and
P(A|Bc) = 1
2
and P(B) is obtained by noting that we are choosing two letters out of seven without
replacement and without regard to order. The total number of ways to do this is
	7
2

= 21, and since there is only one way to choose the two Os, we get P(B) = 1
21.
This gives P(Bc) = 20
21 and we get
P(A) = 1 × 1
21 + 1
2 × 20
21 = 11
21
which is slightly larger than 1
2, as was to be expected.
□
Example 1.44. In the United States, the overall risk of developing lung cancer is
about 0.1%. Among the 20% of the population who are smokers, the risk is about
0.4%. What is the risk that a nonsmoker will develop lung cancer?
Introduce the events C = {cancer} and S = {smoker}. The percentages above give
P(C) = 0.001, P(S) = 0.20, and P(C|S) = 0.004, and we wish to compute P(C|Sc).
The law of total probability gives
P(C) = P(C|S)P(S) + P(C|Sc)P(Sc)
which with our numbers becomes
0.001 = 0.004 × 0.20 + P(C|Sc) × 0.80
which we solve for P(C|Sc) to get
P(C|Sc) = 0.00025
in other words, a 250 in a million risk.
□
Example 1.45. Here is an example of a simple game of dice that does not seem to be
to your advantage but turns out to be so.
Consider three dice, A, B, and C, numbered on their six sides as follows:
Die A: 1, 1, 5, 5, 5, 5
Die B: 3, 3, 3, 4, 4, 4
Die C: 2, 2, 2, 2, 6, 6
The game now goes as follows. You and your opponent bet a dollar each, and you offer
your opponent to choose any die and roll it. Next, you choose one of the remaining
dice and roll it, and whoever gets the higher number wins the money. It seems that

44
BASIC PROBABILITY THEORY
Lose
Win
Win
C = 6
A = 1
A = 5
C = 2
FIGURE 1.5
Tree diagram when you roll die C against die A in Example 1.45.
your opponent will have an edge since he gets to choose first. However, it turns out
that once you know his choice, you can always choose so that your probability to win
is more than one half! The reason for this is that, when rolled two by two against each
other, these dice are such that on average A beats B, B beats C, and C beats A. The
probabilities are (using A and C also to denote the numbers on dice A and C)
P(A beats B) = P(A = 5) = 2
3
P(B beats C) = P(C = 2) = 2
3
For the third case, we need to use the law of total probability and get
P(C beats A) = P(C beats A|A = 1) × 1
3 + P(C beats A|A = 5) × 2
3
= 1 × 1
3 + P(C = 6) × 2
3 = 1
3 + 1
3 × 2
3 = 5
9
which is also greater than 1
2. Although you appear generous to let your opponent
choose first, this is precisely what gives you the advantage.6
□
Tree diagrams provide a nice way to illustrate the law of total probability. We represent
each different case with a branch and look at the leaves to see which cases are of
interest. We then compute the probability by first multiplying along each branch,
then adding across the branches. See Figure 1.5 for an illustration of the situation in
Example 1.45, where you roll die C against die A.
Sometimes, we need to condition repeatedly. For example, to compute P(A|B), it may
be necessary to condition further on some event C. Since a conditional probability is
6A completely deterministic version of this is the game “rock, paper, scissors,” in which you would always
win if your opponent were to choose first. Games like these are called nontransitive.

THE LAW OF TOTAL PROBABILITY AND BAYES’ FORMULA
45
a probability, this is nothing new, but the formula looks more complicated. We get
P(A|B) = P(A|B ∩C)P(C|B) + P(A|B ∩Cc)P(Cc|B)
(1.2)
where we note that every probability has the event B to the right of the conditioning
bar. In Problem 81 you are asked to prove this.
Example 1.46 (Simpson’s Paradox). In a by now famous study of gender bias at
the University of California, Berkeley, it was noted that men were more likely
than women to be admitted to graduate school. In 1 year, in the six largest majors,
45% of male applicants but only 30% of the female ones were admitted. To
further study the bias, we divide the majors into two groups “difficult” and “easy,”
referring to whether it is relatively difficult or easy to be admitted, not to the
subjects themselves. It then turns out that in the “difficult” category, 26% of both
men and women were admitted (actually even slightly above 26% for women and
slightly below for men), so the bias obviously has to be in the other category.
However, in the “easy” category, 80% of women but only 62% of men were
admitted. Thus, there was no bias for difficult majors, a bias against men in easy
majors, and an overall bias against women! Clearly there must be an error somewhere?
Consider a randomly chosen applicant. Let A be the event that the applicant is ad-
mitted, and let M and W be the events that the applicant is a man and a woman,
respectively. We then have P(A|M) = 0.45 and P(A|W) = 0.30. Now also introduce
the events D and E, for “difficult” and “easy” majors. By Table 1.3 we have, for men
P(A|M ∩D) = 334
1306 ≈0.26
and
P(A|M ∩E) = 864
1385 ≈0.62
and for women
P(A|W ∩D) ≈0.26
and P(A|W ∩E) ≈0.80
and hence
P(A|M ∩D) = P(A|W ∩D)
and
P(A|M ∩E) < P(A|W ∩E)
but
P(A|M) > P(A|W)
TABLE 1.3
Numbers of Admitted, and Total Numbers
(in Parentheses) of Male and Female Applicants in the
Two Categories “Easy” and “Difficult” at UC Berkeley
Male
Female
Easy major
864 (1385)
106 (133)
Difficult major
334 (1306)
451 (1702)

46
BASIC PROBABILITY THEORY
Thus, the conditional probabilities of being admitted are equal or higher for women
in both categories but the overall probability for a woman to be admitted is lower
than that of a man. Apparently, there was no error, but it still seems paradoxical. To
resolve this, recall Equation 1.43, by which
P(A|W) = P(A|W ∩D)P(D|W) + P(A|W ∩E)P(E|W)
and
P(A|M) = P(A|M ∩D)P(D|M) + P(A|M ∩E)P(E|M)
and we realize that the explanation lies in the conditional probabilities P(D|W),
P(E|W), P(D|M), and P(E|M), which reﬂect how men and women choose their
majors. The probabilities that a man chooses a difficult major and an easy major,
respectively, are
P(D|M) = 1306
2691 ≈0.49
and
P(E|M) ≈0.51
and the corresponding probabilities for women are
P(D|W) = 1702
1835 ≈0.93
and
P(E|W) ≈0.07
Thus, women almost exclusively applied for difficult majors, whereas men applied
equally for difficult and easy majors, and this is the resolution of the paradox. Was
it harder for women to be admitted? Yes. Was this due to gender discrimination? No.
The effect on admission rates that was initially attributed to gender bias was really
due to choice of major, an example of what statisticians call confounding of factors.
The effect of gender on choice of major is a completely different issue.
□
The last example is a version of what is known as Simpson’s paradox. If we formulate
itasamathematicalproblem,itcompletelylosesitscharm.Thequestionthenbecomes
if it is possible to find numbers A, a, B, b, p, and q, all between 0 and 1, such that
A > a
and
B > b
and
pA + (1 −p)B < qa + (1 −q)b
No problems here. Let A > a > B > b, and choose p sufficiently close to 0 and q
sufficiently close to 1. Ask your mathematician friends this question, and also if there
is something strange about the Berkeley admissions data, and don’t be surprised if
you get the answer “Yes” to both questions!

THE LAW OF TOTAL PROBABILITY AND BAYES’ FORMULA
47
1.6.1
Bayes’ Formula
We next turn to the situation when we know conditional probabilities in one direction
but want to compute conditional probabilities “backward.” The following result is
helpful.
Proposition 1.11 (Bayes’ Formula). Under the same assumptions as in the law
of total probability and if P(A) > 0, then for any event Bj, we have
P(Bj|A) =
P(A|Bj)P(Bj)
∞

k=1
P(A|Bk)P(Bk)
Proof. Note that, by the law of total probability, the denominator is nothing but P(A),
and hence we must show that
P(Bj|A) = P(A|Bj)P(Bj)
P(A)
which is to say that
P(Bj|A)P(A) = P(A|Bj)P(Bj)
which is true since both sides equal P(A ∩Bj), by the definition of conditional
probability.
■
Again, the obvious analog for finitely many conditioning events holds, and in partic-
ular we state the case of two such events, B and Bc, as a corollary.
Corollary 1.7. If 0 < P(B) < 1 and P(A) > 0, then
P(B|A) =
P(A|B)P(B)
P(A|B)P(B) + P(A|Bc)P(Bc)
Example 1.47. The polygraph is an instrument used to detect physiological signs
of deceptive behavior. Although it is often pointed out that the polygraph is not a
lie detector, this is probably the way most of us think of it. For the purpose of this
example, let us retain this notion. It is debated how accurate a polygraph test is, but
there are several reports of accuracies above 95% (and as a counterweight, a Web site
that gladly claims “Don’t worry, the polygraph can be beaten rather easily!”). Let
us assume that the polygraph test is indeed very accurate and that it decides “lie” or
“truth” correctly with probability 0.95. Now consider a randomly chosen individual

48
BASIC PROBABILITY THEORY
who takes the test and is determined to be lying. What is the probability that this
person did indeed lie?
First, the probability is not 0.95. Introduce the events
L
= {the person tells a lie}
LP = {the polygraph reading says the person is lying}
and let T = Lc and TP = Lc
P. We are given the conditional probabilities P(LP|L) =
P(TP|T) = 0.95, but what we want is P(L|LP). By Bayes’ formula
P(L|LP) =
P(LP|L)P(L)
P(LP|L)P(L) + P(LP|T)P(T)
=
0.95P(L)
0.95P(L) + 0.05(1 −P(L))
and to be able to finish the computation we need to know the probability that a
randomly selected person would lie on the test. Suppose that we are dealing with a
largely honest population; let us say that one out of a thousand would tell a lie in the
given situation. Then P(L) = 0.001, and we get
P(L|LP) =
0.95 × 0.001
0.95 × 0.001 + 0.05 × 0.999 ≈0.02
and the probability that the person actually lied is only 0.02. Since lying is so rare,
most detected lies actually stem from errors, not actual lies. One way to understand
this is to imagine that a large number of, say, 100,000, people are tested. We then
expect 100 liars and of those, 95 will be discovered. Among the remaining 99,900
truthtellers, we expect 5%, or 4995 individuals to be misclassified as liars. Hence,
out of a total of 95 + 4995 = 5090 individuals who are classified as liars, only 95,
or 2% actually are liars. A truth misclassified as a lie is called a “false-positive” and
in this case, we say that the false-positive rate is 98%.
□
In the last example, there are two types of errors we can make: classifying a lie as
truth, and vice versa. The probability P(LP|L) to correctly classify a lie as a lie is
called the sensitivity of the procedure. Obviously, we want the sensitivity to be high
but with increased sensitivity we may risk to misclassify more truths as lies as well.
Another probability of interest is therefore the specificity, namely, the probability
P(TP|T) that a truth is correctly classified as truth. For an extreme but illustrative
example, we can achieve maximum sensitivity by classifying all statements as lies;
however, the specificity is then 0. Likewise, we can achieve maximum specificity by
classifying all statements as truths but then instead getting sensitivity 0. The terms
are borrowed from the field of medical testing for illnesses where good procedures
should be both sensitive to detect an illness but also specific for that illness. For
example, using high fever to diagnose measles would have high sensitivity (not many

THE LAW OF TOTAL PROBABILITY AND BAYES’ FORMULA
49
cases of measles will go undetected) but low specificity (many other diseases cause
high fever and will be misclassified as measles).
Another probability of interest in any kind of testing situation is the false-positive
rate, mentioned above. In the lie-detector example, it is P(T|LP), the probability
that a detected lie is actually a truth. Also, the false-negative rate is P(L|TP), the
probability that a detected truth is actually a lie. The sensitivity, specificity, false-
positive rate, and false-negative rate are related via Bayes’ formula where we also
need to know the base rate, namely, the unconditional probability P(T) of telling a lie
(or having a disease). For typical examples from medical testing, see Problem 92 and
subsequent problems.
Example 1.48 (The Monty Hall Problem). This problem has become a modern
classic and was hotly discussed after it first appeared in the column “Ask Marilyn”
in Parade Magazine in 1991. The problem was inspired by the game show “Let’s
Make a Deal” with host Monty Hall, and it goes like this. You are given the choice
of three doors. Behind one door is a car; behind the others are goats. You pick a
door without opening it, and the host opens another door that reveals a goat. He
then gives you the choice to either open your door and keep what is behind it,
orswitchtothe remainingdoorandtakewhatisthere.Is ittoyouradvantagetoswitch?
At first glance, it would not seem to make a difference whether you stay or switch
since the car is either behind your door or behind the remaining door. However, this is
incorrect, at least if we make some reasonable assumptions. To solve the problem, we
assume that the car and goats are placed at random behind the doors and that the host
always opens a door and shows a goat. Let us further assume that in the case where
you have chosen the car, he chooses which door to open at random. Now introduce
the two events
C = {you chose the car}
G = {he shows a goat}
so that the probability to win after switching is 1 −P(C|G). But
P(C|G) =
P(G|C)P(C)
P(G|C)P(C) + P(G|Cc)P(Cc) = P(C) = 1
3
since P(G|C) = P(G|Cc) = 1. Thus, if you switch, you win the car with probabil-
ity 2
3, so switching is to your advantage. Note that the events G and C are in fact
independent.
Intuitively, since you know that the host will always show you a goat, there is
no additional information when he does. Since there are two goats and the host will
always show one of them, to choose a door and then switch is equivalent to choosing
the two other doors and telling the host to open one of them and show you a goat.
Your chance of winning the car is then 2
3.
One variant of the problem that has been suggested to make it easier to understand
is to assume that there are not 3 but 1000 doors. One has a car, and 999 have goats.

50
BASIC PROBABILITY THEORY
Once you have chosen, the host opens 998 doors and shows you 998 goats. Given how
unlikely it is that you found the car in the first pick, is it not obvious that you should
now switch to the remaining door? You could also use one of the several computer
simulations that are available online, or write your own. Still not convinced? Ask
Marilyn.
□
Example 1.49 (The Monty Hall Problem Continued). Suppose that you are playing
“Let’s Make a Deal” and have made your choice when the host suddenly realizes
that he has forgotten where the car is. Since the show must go on, he keeps a straight
face, takes a chance, and opens a door that reveals a goat. Is it to your advantage to
switch?
Although the situation looks the same from your perspective, it is actually different
since it could have happened that the host revealed the car. With C and G as above,
Bayes’ formula now gives
P(C|G) =
P(G|C)P(C)
P(G|C)P(C) + P(G|Cc)P(Cc)
=
1 × (1/3)
1 × (1/3) + (1/2) × (2/3) = 1
2
so it makes no difference whether you stay or switch. In this case, the showing of a
goat behind the open door actually does give some additional information, and G and
C are no longer independent.
□
Example 1.50 (The Island Problem). Probability theory is frequently used in courts
of law, especially when DNA evidence is considered. As an example, consider the
following situation. A person is murdered on an island, and the murderer must be one
of the n remaining islanders. DNA evidence on the scene reveals that the murderer
has a particular genotype that is known to exist in a proportion p in the general
population, and we assume that the islanders’ genotypes are independent. Crime
investigators start screening all islanders for their genotypes. The first one who is
tested is Mr Joe Bloggs, who turns out to have the murderer’s genotype. What is the
probability that he is guilty?
To solve this, we introduce the events
G = {Mr Bloggs is guilty}
B = {Mr Bloggs’ genotype is found at the scene of the crime}
so that we are asking for the probability P(G|B). By Bayes’ formula
P(G|B) =
P(B|G)P(G)
P(B|G)P(G) + P(B|Gc)P(Gc)

THE LAW OF TOTAL PROBABILITY AND BAYES’ FORMULA
51
Here, P(G) is the probability that Mr Bloggs is guilty before any genotyping has been
done, and if we assume that there is no reason to suspect any particular person more
than anyone else, it is reasonable to let P(G) = 1
n. If Mr Bloggs is guilty, then his
genotype is certain to show up at the scene of the crime, and we have P(B|G) = 1.
If Mr Bloggs is innocent, his genotype can still show up by chance, which gives
P(B|Gc) = p, the proportion of his genotype in the population. All put together, we
get
P(G|B) =
1 × 1/n
1 × 1/n + p × (n −1)/n =
1
1 + (n −1)p
as the probability that Mr Bloggs is guilty.
□
The last problem is a simple example of the general problem of how to quantify the
weight of evidence in forensic identification. This “island problem” has been analyzed
and discussed by lawyers and probabilists and different approaches have shown to
give different results (not all correct).7 We will return to this in more detail in Section
2.5. For now, let us present a simple example that demonstrates how calculations can
go agley.
Example 1.51. You know that your new neighbors have two children. One night you
hear a stone thrown at your window and you see a child running from your yard into
the neighbor’s house. It is dark, and the only thing you can see for certain is that
the child is a boy. The next day you walk over to the neighbor’s house and ring the
doorbell. A boy opens the door. What is the probability that he is guilty?
We will do this in two different ways. First approach: If the other child is a girl, you
know that the boy is guilty and if the other child is a boy, the boy who opened the
door is equally likely to be guilty or not guilty. Thus, with
G = {child who opened the door is guilty}
we condition on the gender of the other child and recall Example 1.39 to obtain
P(G) = P(G|boy)P(boy) + P(G|girl)P(girl)
= 1
2 × 1
2 + 1 × 1
2 = 3
4.
Second approach: Note how the situation is similar to that in the previous example,
with genotype replaced by gender and Mr Bloggs replaced by the child who opened
7The island problem is made up (yes, really!), but there is a famous real case, People versus Collins, in
which a couple in Los Angeles was first convicted of a crime, on the basis of circumstantial evidence,
and later acquitted by the California Supreme Court. Both the initial verdict and the appeal were based on
(questionable) probability arguments.

52
BASIC PROBABILITY THEORY
the door. In that formulation, we have n = 2 and p = 1
2 and we get
P(child who opened the door is guilty) =
1
1 + 1 × (1/2) = 2
3
There we go again; different methods give different results! As usual, we need to
be very careful with which events we condition on. Let us assume that each child is
equally likely to decide to go out and throw a stone at your window and that each
child is equally likely to open the door. For each gender combination of two children,
we thus choose at random who is guilty and who opens the door, so that each gender
combination is split up into four equally likely cases. Let us use the subscript d for
the child who opened the door and the superscript g for the child who is guilty. The
sample space consists of the 16 equally likely outcomes
S = {bg
db, bdbg, bgbd, bbg
d, bg
dg, bdgg, bggd, bgg
d,
gg
db, gdbg, ggbd, gbg
d, gg
dg, gdgg, gggd, ggg
d}
and the event that the child who opened the door is guilty is
G = {bg
db, bbg
d, bg
dg, gbg
d, bgg
d, gg
db, gg
dg, ggg
d}
What event do we condition on? We know two things: that the guilty child is a boy
and that a boy opened the door. These events are
A = {bg
db, bdbg, bgbd, bbg
d, bg
dg, bggd, gdbg, gbg
d}
B = {bg
db, bdbg, bgbd, bbg
d, bg
dg, bdgg, ggbd, gbg
d}
and we condition on their intersection
A ∩B = {bg
db, bdbg, bgbd, bbg
d, bg
dg, gbg
d}
Since four of these six outcomes are in G and the distribution on S is uniform, we get
P(child who opened the door is guilty) = P(G|A ∩B) = 2
3
in accordance with the previous example.
The first approach gives the wrong solution but why? When we computed the
probabilities P(boy) and P(girl), we implicitly conditioned on event B above but
forgot to also condition on A. What we need to do is to compute P(boy) as
P(other child is a boy |A ∩B) = 2
3
and not 1
2. Note how the conditional probability that the other child is a boy is higher
now that we also know that the guilty child is a boy. This is quite subtle and resembles
the situation in Example 1.39, in the sense that we need to be careful to condition on
precisely the information we have, no more and no less. We can now state the correct

THE LAW OF TOTAL PROBABILITY AND BAYES’ FORMULA
53
version of the first solution. Everything must be computed conditioned on the event
A ∩B, but for ease of notation let us not write this conditioning out explicitly. We get
P(G) = P(G|boy)P(boy) + P(G|girl)P(girl)
= 1
2 × 2
3 + 1 × 1
3 = 2
3
just as we should. For a variant, see Problem 99.
□
Example 1.52. Consider the previous example and also assume that on your way
over to the neighbor’s, you meet another neighbor who tells you that she saw the
mother of the family take a walk with a boy a few days ago. If a boy opens the door,
what is the probability that he is guilty?
By now you know how to solve this. In the previous sample space, split each outcome
further into two, marking who the mother took a walk with, and proceed. The sample
space now has 32 outcomes, and we will suggest a more convenient approach. We
can view the various sightings of a boy as repeated sampling with replacement from
a randomly chosen family. Let us convert this into a problem about black and white
balls in urns.
Consider three urns, containing two balls each, such that the kth urn contains k
black balls, k = 0, 1, 2. We first choose an urn according to the probabilities 1
4, 1
2, and
1
4 (think of the gender combinations above) and then pick balls with replacement and
note their colors. If we do this j times and get only black balls, what is the probability
that we have chosen the urn with only black balls? Let
B
= {get only black balls}
Uk = {the kth urn chosen}, k = 0, 1, 2
and compute P(U2|B). The reversed probabilities are
P(B|U0) = 0,
P(B|U1) = 1
2j ,
P(B|U2) = 1
and Bayes’ formula gives
P(U2|B) =
P(B|U2)P(U2)
P(B|U1)P(U1) + P(B|U2)P(U2)
=
1 × (1/4)
(1/2j) × (1/2) + 1 × (1/4) =
2j−1
2j−1 + 1
In our examples with families and their children, we let urns represent families and
black and white balls represent genders. Consider the probability that the other child
has the same gender as the observed child. In Example 1.39, we have j = 1, which
gives probability 1
2 and in Example 1.51 we have j = 2, which gives probability 2
3.
Finally, in this example we have j = 3 and probability 4
5. The more observations we
have on boys, the stronger our belief that both children are boys.
□

54
BASIC PROBABILITY THEORY
From mother:
From
father:
A
aa
aA
Aa
a
AA
A
a
FIGURE 1.6
A Punnett square illustrating possible genotypes.
1.6.2
Genetics and Probability
Genetics is a science where probability theory is extremely useful. Recall that genes
occur in pairs where one copy is inherited from the mother and one from the father.
Suppose that a particular gene has two different alleles (variants) called A and a.
An individual can then have either of the three genotypes AA, Aa, and aa. If the
parents both have genotype Aa, what is the probability that their child gets the same
genotype?
We assume that each of the two gene copies from each parent is equally likely to
be passed on to the child and that genes from the father and the mother are inherited
independently. There are then the four equally likely outcomes illustrated in Figure
1.6, and the probability that the child also has genotype Aa is 1
2 (order has no meaning
here, so Aa and aA are the same). Each of the genotypes AA and aa has probability
1
4. The square in the figure is an example of a Punnett square.
Example 1.53. An allele is said to be recessive if it is required to exist in two copies
to be expressed and dominant if one copy is enough. For example, the hereditary
disease cystic fibrosis (CF) is caused by a recessive allele of a particular gene. Let us
denote this allele C and the healthy allele H so that only individuals with genotype
CC get the disease. Individuals with genotype CH are carriers, that is, they have
the disease-causing allele but are healthy. It is estimated that approximately 1 in 25
individuals are carriers (among people of central and northern European descent; it
is much less common in other ethnic groups). Given this information, what is the
probability that a newborn of healthy parents has CF?
Introduce the events
D = {newborn has CF}
B = {both parents are carriers}
so that
P(D) = P(D|B)P(B)

THE LAW OF TOTAL PROBABILITY AND BAYES’ FORMULA
55
since Bc is the event that at least one parent has genotype HH, in which case the
baby will also be healthy. Assuming that the mother’s and father’s genotypes are
independent, we get
P(B) = 1
25 × 1
25 =
1
625
and since the child will get the disease only if it inherits the C allele from each parent,
we get P(D|B) = 1
4, which gives
P(D) =
1
625 × 1
4 =
1
2500
In other words, the incidence of CF among newborns is 1 in 2500, or 0.04%.
Now consider a family with one child where we know that both parents are healthy,
that the mother is a carrier of the disease allele and nothing is known about the father’s
genotype. What is the probability that the child neither is a carrier nor has the disease?
Let E be the event we are interested in. The mother’s genotype is CH, and we
condition on the father’s genotype to obtain
P(E) = P(E|CH)P(CH) + P(E|HH)P(HH)
= 1
4 × 1
25 + 1
2 × 24
25 = 0.49
where we figure out the conditional probabilities with Punnett squares. See the prob-
lem section at the end of the chapter for more on genetics.
□
1.6.3
Recursive Methods
Certain probability problems can be solved elegantly with recursive methods,
involving the law of total probability. The general idea is to condition on a number
of cases that can either be solved explicitly or lead back to the original problem. We
will illustrate this in a number of examples.
Example 1.54. In the final scene of the classic 1966 Sergio Leone movie The Good,
the Bad, and the Ugly, the three title characters, also known as “Blondie,” “Angel
Eyes,” and “Tuco,” stand in a cemetery, guns in holsters, ready to draw. Let us
interfere slightly with the script and assume that Blondie always hits his target, Angel
Eyes hits with probability 0.9, and Tuco with probability 0.5. Let us also suppose
that they take turns in shooting, that whomever is shot at shoots next (unless he is
hit), and that Tuco starts. What strategy maximizes his probability of survival?
Introduce the events
S = {Tuco survives}
H = {Tuco hits his target}

56
BASIC PROBABILITY THEORY
Let us first suppose that Tuco tries to kill Blondie. If he fails, Blondie kills Angel
Eyes, and Tuco gets one shot at Blondie. We thus have
P(S) = P(S|H)P(H) + P(S|Hc)P(Hc) = P(S|H)1
2 + 1
4
where we need to find P(S|H), the probability that Tuco survives a shootout with
Angel Eyes, who gets the first shot. If we assume an infinite supply of bullets (hey,
it’s a Clint Eastwood movie!), we can solve this recursively. Note how this is repeated
conditioning, as in Equation (1.43), but let us ease the notation and rename the event
that Tuco survives the shootout T. Now let p = P(T) and condition on the three
events
A = {Angel Eyes hits}
B = {Angel Eyes misses, Tuco hits}
C = {Angel Eyes misses, Tuco misses}
to obtain
p = P(T|A)P(A) + P(T|B)P(B) + P(T|C)P(C)
where P(A) = 0.9, P(B) = 0.1 × 0.5 = 0.05, P(C) = 0.1 × 0.5 = 0.05, P(T|A) =
0, and P(T|B) = 1. To find P(T|C), note that if both Angel Eyes and Tuco have
missed their shots, they start over from the beginning and hence P(T|C) = p. This
gives
p = 0.05 + 0.05p
which gives p = 0.05/0.95, and with this strategy, Tuco has survival probability
P(S) = 0.05
0.95 × 0.5 + 0.25 ≈0.28
Next, suppose that Tuco tries to kill Angel Eyes. If he succeeds, he faces certain
death as Blondie shoots him. If he fails, Angel Eyes will try to kill Blondie to maximize
his own probability of survival. If Angel Eyes fails, Blondie kills him for the same
reason and Tuco again gets one last shot at Blondie. Tuco surviving this scenario has
probability 0.5 × 0.1 × 0.5 = 0.025. If Angel Eyes succeeds and kills Blondie, Tuco
must again survive a shootout with Angel Eyes but this time, Tuco gets to start. By
an argument similar to that stated above, his probability to survive the shootout is
p = 0.5 + 0.05p that gives p = 0.5/0.95 and Tuco’s survival probability is
P(S) = 0.025 + 0.5 × 0.9 × 0.5
0.95 ≈0.26
not quite as good as with the first strategy.
Notice, however, that Tuco really gains from missing his shot, letting the two better
shots fight it out first. The smartest thing he can do is to miss on purpose! If he aims at
Blondie and misses, Blondie kills Angel Eyes and Tuco gets one last shot at Blondie.

THE LAW OF TOTAL PROBABILITY AND BAYES’ FORMULA
57
His survival probability is 0.5. An even better strategy is to aim at Angel Eyes, miss
on purpose, and give Angel Eyes a chance to kill Blondie. If Angel Eyes fails, he is a
dead man and Tuco gets one last shot at Blondie. If Angel Eyes succeeds, Tuco again
needs to survive the shootout which, as we just saw, has probability p = 0.5/0.95
and his overall survival probability is
P(S) = 0.1 × 0.5 + 0.9 × 0.5
0.95 ≈0.52
When Fredric Mosteller presents a similar problem in his 1965 book Fifty Challenging
Problems in Probability [1], he expresses some worry over the possibly unethical
dueling conduct to miss on purpose. In the case of Tuco, we can safely disregard any
such ethical considerations.
□
Example 1.55. The shootout between Tuco and Angel Eyes in the previous example
is a special case of the following situation: Consider an experiment where the events
A and B are disjoint and repeat the experiment until either A or B occurs. What is
the probability that A occurs before B?
First, by Corollary 1.5, we will sooner or later get either A or B. Let C be the event
that A occurs before B, let p = P(C), and condition on the first trial. If we get A, we
have A before B for certain and if we get B, we do not. If we get neither, that is, get
(A ∪B)c, we start over. The law of total probability now gives
p = P(C|A)P(A) + P(C|B)P(B) + P(C|(A ∪B)c)P(A ∪B)c)
= P(A) + p(1 −P(A ∪B))
= P(A) + p(1 −(P(A) + P(B)))
and we have established an equation for p. Solving it gives
p =
P(A)
P(A) + P(B)
□
Example 1.56. Recall that a single game in tennis is won by the first player to win
four points but that it must also be won by a margin of at least two points. If no
player has won after six played points, they are at deuce and the first to get two
points ahead wins the game. Suppose that Ann is the server and has probability p of
winning a single point against Bob, and suppose that points are won independent of
each other. If the players are at deuce, what is the probability that Ann wins the game?
We are waiting for the first player to win two consecutive points from deuce, so let
us introduce the events
A = {Ann wins two consecutive points from deuce}
B = {Bob wins two consecutive points from deuce}

58
BASIC PROBABILITY THEORY
with the remaining possibility that they win a point each, in which case they are back
at deuce. By independence of consecutive points, P(A) = p2 and P(B) = (1 −p)2,
and by Example 1.55 we get
P(Ann wins) =
p2
p2 + (1 −p)2
□
Example 1.57. The next sports application is to the game of badminton. The scoring
system is such that you can score a point only when you win a rally as the server. If
you win a rally as the receiver, the score is unchanged, but you get to serve and thus
the opportunity to score. Suppose that Ann wins a rally against Bob with probability
p, regardless of who serves (a reasonable assumption in badminton but would,
of course, not be so in tennis, where the server has a big advantage). What is the
probability that Ann scores the next point if she is the server?
If Ann is the server, the next point is scored either when she wins a rally as server
or loses two consecutive rallies starting from being server. In the remaining case, the
players will start over from Ann being the server with no points scored yet. Hence,
we can apply the formula from Example 1.55 to the events
A = {Ann wins a rally as server}
B = {Ann loses two consecutive rallies as server}
to obtain
P(Ann scores next point) =
P(A)
P(A) + P(B) =
p
p + (1 −p)2
If the players are equally good, so that p = 1
2, the server thus has a 2
3 probability to
score the next point.
□
Example 1.58 (Gambler’s Ruin). Next, Ann and Bob play a game where a fair coin
is ﬂipped repeatedly. If it shows heads, Ann pays Bob one dollar, otherwise Bob
pays Ann one dollar. If Ann starts with a dollars and Bob with b dollars, what is the
probability that Ann ends up winning all the money and Bob is ruined?
Introduce the event
A = {Ann wins all the money}
and let pa be the probability of A if Ann’s initial fortune is a. Thinking a few minutes
makes us realize that it is quite complicated to compute pa directly. Instead, let us
condition on the first ﬂip and note that if it is heads, the game starts over with the

THE LAW OF TOTAL PROBABILITY AND BAYES’ FORMULA
59
new initial fortunes a −1 and b + 1, and if it is tails, the new fortunes are a + 1 and
b −1. Introduce the events
H = {heads in first ﬂip} and T = {tails in first ﬂip}
and apply the law of total probability to get
pa = P(A|H)1
2 + P(A|T)1
2 = 1
2(pa−1 + pa+1)
or equivalently
pa+1 = 2pa −pa−1
First note that p0 = 0 and let a = 1 to obtain
p2 = 2p1
With a = 2 we get
p3 = 2p2 −p1 = 3p1
and we find the general relation
pa = ap1
Now, pa+b = 1, and hence
p1 =
1
a + b
which finally gives the solution
P(Ann wins all the money) =
a
a + b
By symmetry, the same argument applies to give
P(Bob wins all the money) =
b
a + b
Note that this means that the probability that somebody wins is 1, which excludes the
possibility that the game goes on forever, something we cannot immediately rule out.
This gambler’s ruin problem is an example of a random walk. We may think of
a particle that in each step decides to go up or down (or, if you prefer, left/right),
and does so independent of its previous path.8 We can view the position after n steps
as Ann’s total gain, so if the walk starts in 0, Ann has won the game when it hits
b, and she has lost when it hits −a. We refer to −a and b as absorbing barriers
(see Figure 1.7).
□
8A more romantic allegory is that of a drunken Dutchman who staggers back and forth until he either is
back in his favorite bruine cafe or falls into the canal.

60
BASIC PROBABILITY THEORY
Ruin after 13 steps
b
− a
FIGURE 1.7
Gambler’s ruin as a random walk.
Example 1.59. Consider the gambler’s ruin problem from the previous example, but
suppose that Ann has only one dollar and Bob is infinitely wealthy. What is the
probability that Ann eventually goes broke?
Since the range is infinite, we cannot use the technique from above, but let us still
condition on the first coin ﬂip. If it shows heads, Ann’s fortune drops to zero and she
is ruined. If it shows tails, Ann’s fortune goes up to $2, and the game continues. If
Ann is to go broke, her fortune must eventually hit 0, and before it does so, it must
first hit 1. Now, the probability to eventually hit 1 starting from 2 is the same as the
probability to eventually hit 0 starting from 1, and once her fortune is back at 1, the
game starts over from the beginning. If we let B = {Ann goes broke eventually} and
condition on the first ﬂip being heads or tails, we thus get
P(B) = P(B|H)P(H) + P(B|T)P(T) = 1
2 + P(B|T)1
2
Now let q = P(B). By the argument above, P(B|T) = q2, and we get the equation
q = 1
2 + q2
2
which we solve for q to get q = 1, so Ann will eventually go broke. Since the game
is fair, there is no trend that drags her fortune down toward ruin, only inevitable bad
luck.
□
Example 1.60. Consider the gambler’s ruin problem but suppose that the game is
unfair, so that Ann wins with probability p /= 1
2 in each round. If her initial fortune
is a and Bob’s initial fortune is b, what is the probability that she wins?
The solution method is the same as in the original gambler’s ruin: to condition on
the first ﬂip and apply the law of total probability. Again, let A be the event that Ann

THE LAW OF TOTAL PROBABILITY AND BAYES’ FORMULA
61
wins and pa the probability of A if she starts with a dollars. For ease of notation, let
q = 1 −p, the probability that Ann loses a round. We get
pa = P(A|H)P(H) + P(A|T)P(T) = pa−1q + pa+1p
which gives
pa+1 = 1
p(pa −qpa−1)
First let a = 1. Since p0 = 0, we get
p2 = 1
pp1
which we rewrite as
p2 =

1 + q
p

p1
For a = 2, we get
p3 = 1
p(p2 −qp1)
= 1
p

1 + q
p −q

p1 =

1 + q
p +
 q
p
2
p1
and the general formula emerges as
pa =

1 + q
p +
 q
p
2
+ · · · +
 q
p
a−1
p1 = 1 −(q/p)a
1 −(q/p) p1
Finally, we use pa+b = 1 to obtain
1 −(q/p)a+b
1 −(q/p)
p1 = 1
which gives
p1 =
1 −(q/p)
1 −(q/p)a+b
and the probability that Ann wins, starting from a fortune of a dollars, is thus
pa =
1 −(q/p)a
1 −(q/p)a+b
if p /= 1
2. The game is unfair to Ann if p < 1
2 and to Bob if p > 1
2. It is interesting to
note that the change in winning probabilities can be dramatic for small changes of p.

62
BASIC PROBABILITY THEORY
For example, if the players start with 20 dollars each and p = 1
2, they are equally
likely to win in the end. Now change p to 0.55, so that Ann has a slight edge. Then
p20 = 1 −(0.45/0.55)20
1 −(0.45/0.55)40 ≈0.98
so Ann is almost certain to win. See Problem 106 for an interesting application to
roulette.
□
Example 1.61 (Penney-ante). We finish the section with a game named for Walter
Penney, who in 1969 described it in an article in Journal of Recreational Mathematics.
If a fair coin is ﬂipped three times, there are eight outcomes
HHH, HHT, HTH, THH, HTT, THT, TTH, TTT
each of which has probability 1
8. You now suggest the following game to your friend
John.9 You bet $1 each, he gets to choose one of the eight patterns, and you choose
another. A coin is ﬂipped repeatedly, and the sequence of heads and tails is recorded.
Whoever first sees his sequence come up wins. Since all patterns are equally likely
to come up in a sequence of three ﬂips, this game seems fair. However, it turns out
that after John has chosen his pattern, you can always choose so that your chance of
winning is at least 2
3!
The idea is to always let your sequence end with the two symbols that his begins with.
Intuitively, this means that whenever his pattern is about to come up, there is a good
chance that yours has come up already. For example, if he chooses HHH, you choose
THH, and the only way in which he can win is if the first three ﬂips give heads.
Otherwise, the sequence HHH cannot appear without having a T before it, and thus
your pattern THH has appeared. With these choices, your probability to win is 7
8.
The general strategy is to let his first two be your last two, and never choose a
palindrome. Suppose that John chooses HTH so that according to the strategy, you
choose HHT. Let us calculate your probability of winning.
Let A be the event that you win, and let p be the probability of A. To find p, we
condition on the first ﬂip. If this is T, the game starts over, and hence P(A|T) = p.
If it is H, we condition further on the second ﬂip. If this is H, you win (if we start
with HH, then HHT must come before HTH), and if it is T, we condition further on
the third ﬂip. If this is H, the full sequence is HTH, and you have lost. If it is T, the
full sequence is HTT and the game starts over. See the tree diagram in Figure 1.8 for
9Named after John Haigh, who in his splendid book Taking Chances: Winning with Probability [3] describes
this game and names the loser Doyle after Doyle Lonnegan, victim in the 1973 movie The Sting. I feel that
Doyle has now lost enough and in this way let him get a small revenge. Hopefully, John’s book has sold
so well that he is able to take the loss.

PROBLEMS
63
H
Lose
Start over
T
H
T
H
T
Start over
Win
FIGURE 1.8
The four possible cases in Penney-ante when HHT competes with HTH.
an illustration of the possible cases. The law of total probability gives (ignoring the
case in which you lose)
p = P(A|T)P(T) + P(A|HH)P(HH) + P(A|HTT)P(HTT)
= p × 1
2 + 1 × 1
4 + p × 1
8 = 2 + 5p
8
which we solve for p to get p = 2
3. Just as in the dice game in Example 1.45, your
apparent generosity to let your opponent choose first is precisely what gives you the
advantage. See also Problem 108.
□
PROBLEMS
Section 1.2. Sample Spaces and Events
1. Suggest sample spaces for the following experiments: (a) Three dice are rolled
and their sum computed. (b) Two real numbers between 0 and 1 are chosen.
(c) An American is chosen at random and is classified according to gender and
age. (d) Two different integers are chosen between 1 and 10 and are listed in
increasing order. (e) Two points are chosen at random on a yardstick and the
distance between them is measured.
2. Suggest a sample space for Example 1.8.
3. Consider the experiment to toss a coin three times and count the number of
heads. Which of the following sample spaces can be used to describe this
experiment?
(a) S = {H, T}
(b) S = {HHH, TTT}
(c) S = {0, 1, 2, 3}
(d) S = {1, 2, 3}
(e) S = {HHH, HHT, HTH, THH, HTT, THT, TTH, TTT}

64
BASIC PROBABILITY THEORY
4. Let A, B, and C be three events. Express the following events in terms of A, B,
and C: (a) exactly one of the events occurs. (b) None of the events occurs. (c)
At least one of the events occurs. (d) All of the events occur.
5. The Stanley Cup final is played in best of seven games. Suppose that the good
old days are brought back and that the final is played between the Boston
Bruins and Montreal Canadiens. Let Bk be the event that Boston wins the kth
game and describe the following events in terms of the Bk: (a) Boston wins
game 1, (b) Boston loses game 1 and wins games 2 and 3, (c) Boston wins the
series without losing any games, (d) Boston wins the series with one loss, and
(e) Boston wins the first three games and loses the series.
Section 1.3. The Axioms of Probability
6. A certain thick and asymmetric coin is tossed and the probability that it lands
on the edge is 0.1. If it does not land on the edge, it is twice as likely to show
heads as tails. What is the probability that it shows heads?
7. Let A and B be two events such that P(A) = 0.3, P(A ∪B) = 0.5, and
P(A ∩B) = 0.2. Find (a) P(B), (b) the probability that A but not B occurs,
(c) P(A ∩Bc), (d) P(Ac), (e) the probability that B does not occur, and (f) the
probability that neither A nor B occurs.
8. LetAbetheeventthatitrainsonSaturdayandB theeventthatitrainsonSunday.
Suppose that P(A) = P(B) = 0.5. Furthermore, let p denote the probability
that it rains on both days. Express the probabilities of the following events as
functions of p: (a) it rains on Saturday but not Sunday. (b) It rains on one day
but not the other. (c) It does not rain at all during the weekend.
9. The probability in Problem 8(b) is a decreasing function of p. Explain this
intuitively.
10. People are asked to assign probabilities to the events “rain on Saturday,” “rain
on Sunday,” “rain both days,” and “rain on at least one of the days.” Which of
the following suggestions are consistent with the probability axioms: (a) 70%,
60%, 40%, and 80%, (b) 70%, 60%, 40%, and 90%, (c) 70%, 60%, 80%, and
50%, and (d) 70%, 60%, 50%, and 90%?
11. Two fish are caught and weighed. Consider the events A = {the first weighs
more than 10 pounds}, B = {the second weighs more than 10 pounds}, and
C = {the sum of the weights is more than 20 pounds}. Argue that C ⊆A ∪B.
12. Let A, B, and C be three events, such that each event has probability 1
2, each
intersection of two has probability 1
4, and P(A ∩B ∩C) = 1
8. Find the proba-
bility that (a) exactly one of the events occurs, (b) none of the events occurs,
(c) at least one of the events occurs, (d) all of the events occur, and (e) exactly
two of the events occur.
13. (a) Let A and B be two events. Show that
P(A) + P(B) −1 ≤P(A ∪B) ≤P(A) + P(B)

PROBLEMS
65
(b) Let A1, . . . , An be a sequence of events. Show that
n

k=1
P(Ak) −(n −1) ≤P
 n
k=1
Ak

≤
n

k=1
P(Ak)
14. A particular species of fish is known to weigh more than 10 pounds with prob-
ability 0.01. Suppose that 10 such fish are caught and weighed. Show that the
probability that the total weight of the 10 fish is above 100 pounds is at most
0.1.
15. Consider the Venn diagram of four events below. If we use the “area method”
to find the probability of A ∪B ∪C ∪D, we get
P(A ∪B ∪C ∪D) = P(A) + P(B) + P(C) + P(D)
−P(A ∩B) −P(A ∩C) −P(B ∩D) −P(C ∩D)
+ P(A ∩B ∩C ∩D)
However, this does not agree with Proposition 1.5 for n = 4. Explain!
D
C
A
B
16. Choose a number at random from the integers 1,. . . ,100. What is the probability
that it is divisible by (a) 2, 3, or 4, (b) i, j, or k?
17. Consider Example 1.9 where you throw a dart at random. Find the probability
that you get (a) 14 or double, (b) 14, double, or triple, (c) even, double, a number
higher than 10, or bull’s eye.
18. Prove Proposition 1.6 by considering disjoint events B1, B2, . . . defined by
B1 = A1, B2 = A2 \ B1, . . . , Bk = Ak \ Bk−1, . . .
Section 1.4. Finite Sample Spaces and Combinatorics
19. You are asked to select a password for a Web site. It must consist of five
lowercaselettersandtwodigitsinanyorder.Howmanypossiblesuchpasswords
are there if (a) repetitions are allowed, and (b) repetitions are not allowed?
20. Consider the Swedish license plate from Example 1.16. Find the probability that
a randomly selected plate has (a) no duplicate letters, (b) no duplicate digits,
(c) all letters the same, (d) only odd digits, and (e) no duplicate letters and all
digits equal.
21. “A thousand monkeys, typing on a thousand typewriters will eventually type
the entire works of William Shakespeare” is a statement often heard in one

66
BASIC PROBABILITY THEORY
form or another. Suppose that one monkey presses 10 keys at random. What is
the probability that he types the word HAMLET if he is (a) allowed to repeat
letters, and (b) not allowed to repeat letters?
22. Four envelopes contain four different amounts of money. You are allowed to
open them one by one, each time deciding whether to keep the amount or
discard it and open another envelope. Once an amount is discarded, you are not
allowed to go back and get it later. Compute the probability that you get the
largest amount under the following different strategies: (a) You take the first
envelope. (b) You open the first envelope, note that it contains the amount x,
discard it and take the next amount which is larger than x (if no such amount
shows up, you must take the last envelope). (c) You open the first two envelopes,
call the amounts x and y, and discard both and take the next amount that is larger
than both x and y.
23. In the early 1970s, four talented Scandinavians named Agneta, Annifrid, Benny,
and Bj¨orn put a band together and decided to name it using their first name
initials. (a) How many possible band names were there? What if a reunion is
planned and the reclusive Agneta is replaced by some guy named Robert? (b) A
generalization of (a): You are given n uppercase letters such that the numbers of
A, B, . . . , Z are nA, nB, . . . , nZ, respectively (these numbers may be 0). Show
that you can create
n!
nA!nB! · · · nZ!
different possible words. Compare with your answers in part (a).
24. Prove the following identities (rather than using the definition, try to give
combinatorial arguments):
(a)
n + 1
k + 1

=

n
k + 1

+
n
k

(b) k
n
k

= n
n −1
k −1

(c)
2n
n

=
n

k=1
n
k
2
(d)
n

k=0
n
k

= 2n
25. On a chessboard (8 × 8 squares, alternating black and white), you place three
chess pieces at random. What is the probability that they are all (a) in the first
row, (b) on black squares, (c) in the same row, and (d) in the same row and on
the same color?
26. In a regular coordinate system, you start at (0, 0) and ﬂip a fair coin to decide
whether to go sideways to (1, 0) or up to (0, 1). You continue in this way, and
after n ﬂips you have reached the point (j, k), where j + k = n. What is the
probability that (a) all the j steps sideways came before the k steps up, (b) all
the j steps sideways came either before or after the k steps up, and (c) all the
j steps sideways came in a row?

PROBLEMS
67
27. An urn contains n red balls, n white balls, and n black balls. You draw k
balls at random without replacement (where k ≤n). Find an expression for the
probability that you do not get all colors.
28. You are dealt a bridge hand (13 cards). What is the probability that you do not
get cards in all suits?
29. Recall Texas Lotto from Example 1.21, where five numbers are chosen among
1,. . . ,44 and one bonus ball number from the same set. Find the probability that
you match (a) four of the first five numbers but not the bonus ball, (b) three of
the first five numbers and the bonus ball.
30. You are dealt a poker hand. What is the probability of getting (a) royal ﬂush,
(b) straight ﬂush, (c) four of a kind, (d) full house, (e) ﬂush, (f) straight, (g)
three of a kind, (h) two pairs, and (i) one pair? (These are listed in order of
descending value in poker, not in order of difficulty!)
31. From the integers 1, . . . , 10, three numbers are chosen at random without re-
placement. (a) What is the probability that the smallest number is 4? (b) What
is the probability that the smallest number is 4 and the largest is 8? (c) If you
choose three numbers from 1, . . . , n, what is the probability that the smallest
number is j and the largest is k for possible values of j and k?
32. An urn contains n white and m black balls. You draw repeatedly at random and
without replacement. What is the probability that the first black ball comes in
the kth draw, k = 1, 2, . . . , n + 1?
33. In the “Pick 3” game described in Example 1.25, suppose that you choose the
“any order” option and play the numbers 111. Since there are a total of 220
cases and 1 favorable case, you think that your chance of winning is 1/220.
However, when playing this repeatedly, you notice that you win far less often
than once every 220 times. Explain!
34. How many strictly positive, integer-valued solutions (x1, . . . , xn) are there to
the equation x1 + · · · + xn = k?
35. Ann and Bob shufﬂe a deck of cards each. Ann wins if she can find a card
that has the same position in her deck as in Bob’s. What is the (approximate)
probability that Ann wins?
36. Consider the matching problem in Example 1.4.17 and let nj be the number of
permutations with exactly j matches for j = 0, 1, . . . , n. (a) Find an expression
for n0. Hint: How does n0/n! relate to the probability computed in the example?
(b) Find the probability of exactly j matches, for j = 0, 1, . . . , n and its limit
as n →∞. Hint: You need to find nj. First fix a particular set of j numbers,
for example, {1, 2, . . . , j} and note that the number of ways to match exactly
those equals the number of ways to have no matches among the remaining n −j
numbers, which you can obtain from part (a).
Section 1.5. Conditional Probability and Independence
37. Let A and B be two events. Is it then true that P(A|B) + P(A|Bc) = 1? Give
proof or counterexample.

68
BASIC PROBABILITY THEORY
38. Let A and B be disjoint events. Show that
P(A|A ∪B) =
P(A)
P(A) + P(B)
39. Let A, B, and C be three events such that P(B ∩C) > 0. Show that
P(A ∩B ∩C) = P(A|B ∩C)P(B|C)P(C)
and that
P(A|B ∩C) = P(A ∩B|C)
P(B|C)
40. Let A and B be events, with P(A) = 1
2 and P(B) = 1
3. Compute both P(A ∪B)
and P(A ∩B) if (a) A and B are independent, (b) A and B are disjoint, (c) Ac
and B are independent, and (d) Ac and B are disjoint.
41. A politician considers running for election and has decided to give it two tries.
He figures that the current conditions are favorable and that he has about a
60% chance of winning this election as opposed to a 50–50 chance in the next
election. However, if he does win this election, he estimates that there ought to
be a 75% chance of being reelected. (a) Find the probability that he wins both
elections. (b) Find the probability that he wins the first election and loses the
second. (c) If you learn that he won the second election, what is the probability
that he won the first election? (d) If he loses the first election, what is the
probability that he wins the second?
42. Consider two events A and B. We say that B gives positive information about A,
denoted B↗A, if P(A|B) > P(A), that is if knowing B increases the probability
of A. Similarly, we say that B gives negative information about A, denoted
B↘A, if P(A|B) < P(A). Are the following statements true or false? (a) If
B↗A, then A↗B. (b) If A↗B and B↗C, then A↗C. (c) If B↗A, then
B↘Ac. (d) A↘Ac.
43. Show that both ∅and the sample space S are independent of any event. Explain
intuitively.
44. Let S be a sample space with n equally likely outcomes where n is a prime
number. Show that there are no independent events (unless one of them is S or
∅).
45. A coin has probability p of showing heads. Flip it three times and consider
the events A = {at most one tails} and B = {all ﬂips are the same}. For which
values of p are A and B independent?
46. A fair coin is ﬂipped twice. Explain the difference between the following: (a)
the probability that both ﬂips give heads, and (b) the conditional probability
that the second ﬂip gives heads given that the first ﬂip gave heads.
47. In December 1992, a small airplane crashed in a residential area near Bromma
Airport outside Stockholm, Sweden. In an attempt to calm the residents, the
airport manager claimed that they should now feel safer than before since the

PROBLEMS
69
probability of two crashes is much smaller than the probability of one crash
and hence it has now become less likely that another crash will occur in the
future.10 What do you think of his argument?
48. Bob and Joe are working on a project. They each have to ﬁnish their individual
tasks to complete the project and work independent of each other. When Bob is
asked about the chances of him getting his part done, Joe getting his part done,
and then both getting the entire project done, he estimates these to be 99%,
90%, and 95%, respectively. Is this reasonable?
49. You roll a die and consider the events A: get an even outcome, and B: get at
least 2. Find P(B|A) and P(A|B).
50. You roll a die twice and record the largest number (if the two rolls give the same
outcome, this is the largest number). (a) Given that the first roll gives 1, what is
the conditional probability that the largest number is 3? (b) Given that the first
roll gives 3, what is the conditional probability that the largest number is 3?
51. Roll two fair dice. Let Ak be the event that the first die gives k, and let Bn be the
event that the sum is n. For which values of n and k are Ak and Bn independent?
52. The distribution of blood types in the United States according to the “ABO
classification” is O:45%, A:40%, B:11%, and AB:4%. Blood is also classified
according to Rh type, which can be negative or positive and is independent of
the ABO type (the corresponding genes are located on different chromosomes).
In the U.S. population, about 84% are Rh positive. Sample two individuals at
random and find the probability that (a) both are A negative, (b) one of them is
O and Rh positive, while the other is not, (c) at least one of them is O positive,
(d) one is Rh positive and the other is not AB, (e) they have the same ABO
type, and (f) they have the same ABO type and different Rh types.
53. Let A, B, and C be independent events. Show that A is independent of both
B ∩C and B ∪C.
54. You are offered to play the following game: A roulette wheel is spun eight times.
If any of the 38 numbers (0,00,1–36) is repeated, you lose $10, otherwise you
win $10. Should you accept to play this game? Argue by computing the relevant
probability.
55. Consider the following simplified version of the birthday problem in Example
1.19. Divide the year into “winter half” and “summer half.” Suppose that the
probability is p that an individual is born in the winter half. What is the proba-
bility that two people are born in the same half of the year? For which value of
p is this minimized?
56. Consider the birthday problem with two people and suppose that the probability
distribution of birthdays is p1, . . . , p365. (a) Express the probability that they
havethesamebirthdayasafunctionofthepk.(b)Showthattheprobabilityin(a)
is minimized for pk =
1
365, k = 1, 2, . . . , 365. If you are familiar with Lagrange
10True story!

70
BASIC PROBABILITY THEORY
multipliers, you can use these. Alternatively, first show that 365
k=1(pk −
1
365 +
1
365)2 ≥
1
365.
57. A certain text has one-third vowels and two-thirds consonants. Five letters are
chosen at random and you are asked to guess the sequence. Find the probability
that all guesses are correct if for each letter you (a) guess vowel or consonant
with equal probabilities, (b) guess vowel with probability 1
3 and consonant with
probability 2
3, and (c) always guess consonant.
58. Two events A and B are said to be conditionally independent given the event C
if
P(A ∩B|C) = P(A|C)P(B|C)
(a) Give an example of events A, B, and C such that A and B are independent but
not conditionally independent given C. (b) Give an example of events A, B, and
C such that A and B are not independent but conditionally independent given C.
(c) Suppose that A and B are independent events. When are they conditionally
independent given their union A ∪B? (d) Since the information in C and Cc
is equivalent (remember Proposition 1.10 and the preceding discussion), we
might suspect that if A and B are independent given C, they are also independent
given Cc. However, this is not true in general. Give an example of three events
A, B, and C such that A and B are independent given C but not given Cc.
59. Roll a die twice and consider the events A = {first roll gives at least 4 }, B =
{second roll gives at most 4 }, and C = {the sum of the rolls is 10 }. (a) Find
P(A), P(B), P(C), and P(A ∩B ∩C). (b) Are A, B, and C independent?
60. Roll a die n times and let Aij be the event that the ith and jth rolls give the
same number, where 1 ≤i < j ≤n. Show that the events Aij are pairwise
independent but not independent.
61. You throw three darts independently and at random at a dartboard. Find the
probability that you get (a) no bull’s eye, (b) at least one bull’s eye, (c) only
even numbers, and (d) exactly one triple and at most one double.
62. Three fair dice are rolled. Given that there are no 6s, what is the probability that
there are no 5s?
63. You have three pieces of string and tie together the ends two by two at random.
(a) What is the probability that you get one big loop? (b) Generalize to n pieces.
64. Choose n points independently at random on the perimeter of a circle. What is
the probability that all points are on the same half-circle?
65. Do Example 1.23 assuming that balls are instead drawn with replacement.
66. A fair coin is ﬂipped n times. Let Ak = {heads in kth ﬂip}, k = 1, 2, . . . , n,
and B = {the total number of heads is even}. Show that A1, . . . , An, B are not
independent but that if any one of them is removed, the remaining n events are
independent (from Stoyanov, Counterexamples in Probability [9]).
67. Compute the reliability of the two systems below given each component func-
tioning independently with probability p.

PROBLEMS
71
68. A system is called a “k-out-of-n system” if it functions whenever at least k
of the n components function. Suppose that components function independent
of each other with probability p and find an expression for the reliability of
the system.
69. You play the following game: You bet $1, a fair die is rolled and if it shows
6 you win $4, otherwise you lose your dollar. If you must choose the number
of rounds in advance, how should you choose it to maximize your chance of
being ahead (having won more than you have lost) when you quit, and what is
the probability of this?
70. Suppose that there is a one-in-a-million chance that a person is struck by light-
ning and that there are n people in a city during a thunderstorm. (a) If n is 2
million, what is the probability that somebody is struck? (b) How large must n
be for the probability that somebody is struck to be at least 1
2?
71. A fair die is rolled n times. Once a number has come up, it is called occupied
(e.g., if n = 5 and we get 2, 6, 5, 6, 2, the numbers 2, 5, and 6 are occupied).
Let Ak be the event that k numbers are occupied. Find the probability of A1
(easy) and A2 (trickier).
Section 1.6. The Law of Total Probability and Bayes’ Formula
72. In the United States, the overall chance that a baby survives delivery is 99.3%.
For the 15% that are delivered by cesarean section, the chance of survival
is 98.7%. If a baby is not delivered by cesarean section, what is its survival
probability?
73. You roll a die and ﬂip a fair coin a number of times determined by the number
on the die. What is the probability that you get no heads?
74. In a blood transfusion, you can always give blood to somebody of your own
ABOtype(seeProblem52).Also,typeOcanbegiventoanybodyandthosewith
type AB can receive from anybody (people with these types are called universal
donors and universal recipients, respectively). Suppose that two individuals are
chosen at random. Find the probability that (a) neither can give blood to the
other, (b) one can give to the other but not vice versa, (c) at least one can give
to the other, and (d) both can give to each other.
75. You have two urns, 10 white balls, and 10 black balls. You are asked to distribute
the balls in the urns, choose an urn at random, and then draw a ball at random
from the chosen urn. How should you distribute the balls in order to maximize
the probability to get a black ball?
76. A sign reads ARKANSAS. Three letters are removed and then put back into
the three empty spaces again, at random. What is the probability that the sign
still reads ARKANSAS?

72
BASIC PROBABILITY THEORY
77. A sign reads IDAHO. Two letters are removed and put back at random, each
equally likely to be put upside down as in the correct orientation. What is the
probability that the sign still reads IDAHO?
78. In the “Pick 3” game from Example 1.25, play the “any order” options and
choose your three numbers at random. What is the probability that you win?
79. From a deck of cards, draw four cards at random without replacement. If you get
k aces, draw k cards from another deck. What is the probability to get exactly
k aces from the first deck and exactly n aces from the second deck?
80. Recall Example 1.39, where you observe a mother walking with a girl. Find the
conditional probability that the other child is also a girl in the following cases:
(a) The mother chooses the older child with probability p. (b) If the children are
of different genders, the mother chooses the girl with probability p. (c) When
do you get the second solution in the example that the probability equals 1
2?
81. Let A, B, and C be three events. Assuming that all conditional probabilities are
defined, show that
P(A|B) = P(A|B ∩C)P(C|B) + P(A|B ∩Cc)P(Cc|B).
82. Graduating students from a particular high school are classified as “weak” or
“strong.” Among those who apply to college, it turns out that 56% of the weak
students but only 39% of the strong students are accepted at their first choice.
Does this indicate a bias against strong students?
83. In Example 1.45, if all three dice are rolled at once, which is the most likely to
win?
84. Consider the introduction to Section 1.6. If your car develops engine problems,
how likely is it that the dealer sold you a ﬂood-damaged car?
85. Consider the Monty Hall problem in Example 1.48. (a) What is the relevance
of the assumption that Monty opens a door at random in the case where you
chose the car? (b) Suppose that there are n doors and k cars, everything else
being the same. What is your probability of winning a car with the switching
strategy?
86. The three prisoners Shadrach, Mesach, and Abednego learn that two of them
will be set free but not who. Later, Mesach finds out that he is one of the two,
and, excited, he runs to Shadrach to share his good news. When Shadrach finds
out, he gets upset and complains “Why did you tell me? Now that there are only
me and Abednego left, my chance to be set free is only 1
2, but before it was 2
3.”
What do you think of his argument? What assumptions do you make?
87. A box contains two regular quarters and one fake two-headed quarter. (a) You
pick a coin at random. What is the probability that it is the two-headed quarter?
(b) You pick a coin at random, ﬂip it, and get heads. What is the probability
that it is the two-headed quarter?
88. Two cards are chosen at random without replacement from a deck and inserted
into another deck. This deck is shufﬂed, and one card is drawn. If this card is
an ace, what is the probability that no ace was moved from the first deck?

PROBLEMS
73
89. A transmitter sends 0s and 1s to a receiver. Each digit is received correctly (0
as 0, 1 as 1) with probability 0.9. Digits are received correctly independent of
each other and on the average twice as many 0s as 1s are being sent. (a) If
the sequence 10 is sent, what is the probability that 10 is received? (b) If the
sequence 10 is received, what is the probability that 10 was sent?
90. Consider two urns, one with 10 balls numbered 1 through 10 and one with 100
balls numbered 1 through 100. You first pick an urn at random, then pick a ball
at random, which has number 5. (a) What is the probability that it came from
the first urn? (b) What is the probability in (a) if the ball was instead chosen
randomly from all the 110 balls?
91. Smoking is reported to be responsible for about 90% of all lung cancer. Now
consider the risk that a smoker develops lung cancer. Argue why this is not
90%. In order to compute the risk, what more information is needed?
92. The serious disease D occurs with a frequency of 0.1% in a certain population.
The disease is diagnosed by a method that gives the correct result (i.e., positive
result for those with the disease and negative for those without it) with proba-
bility 0.99. Mr Smith goes to test for the disease and the result turns out to be
positive. Since the method seems very reliable, Mr Smith starts to worry, being
“99% sure of actually having the disease.” Show that this is not the relevant
probability and that Mr Smith may actually be quite optimistic.
93. You test for a disease that about 1 in 500 people have. If you have the disease, the
test is always positive. If you do not have the disease, the test is 95% accurate.
If you test positive, what is the probability that you have the disease?
94. (a) Ann and Bob each tells the truth with probability 1/3 and lies otherwise,
independent of each other. If Bob tells you something and Ann tells you Bob
told the truth, what is the probability Bob told you the truth? (b) Add a third
person, Carol, who is as prone to lying as Ann and Bob one. If Ann says that
Bob claims that Carol told the truth, what is the probability Carol told the truth?
95. A woman witnesses a hit-and-run accident one night and reports it to the police
that the escaping car was black. Since it was dark, the police test her ability
to distinguish black from dark blue (other colors are ruled out) under similar
circumstances and she is found to be able to pick the correct color about 90%
of the time. One police officer claims that they can now be 90% certain that
the escaping car was black, but his more experienced colleague says that they
need more information. In order to determine the probability that the car was
indeed black, what additional information is needed, and how is the probability
computed?
96. Joe and Bob are about to drive home from a bar. Since Joe is sober and Bob is
not, Joe takes the wheel. Bob has recently read in the paper that drunk drivers
are responsible for 25% of car accidents, that about 95% of drivers are sober,
and that the overall risk of having an accident is 10%. “You sober people cause
75% of the accidents,” slurs Bob, “and there are so many of you too! You should
let me drive!” Joe who knows his probability theory has his answer ready. How
does he respond?

74
BASIC PROBABILITY THEORY
97. Consider Example 1.50, where the murderer must be one of n individuals.
Suppose that Joe Bloggs is initially considered the main suspect and that the
detectives judge that there is a 50–50 chance that he is guilty. If his DNA matches
the DNA found at the scene of the crime, what is then the probability that he is
guilty?
98. Consider a parallel system of two components. The first component functions
with probability p and if it functions, the second also functions with probability
p. If the first has failed, the second functions with probability r < p, due to
heavier load on the single component. (a) What is the probability that the second
component functions? (b) What is the reliability of the system? (c) If the second
component does not function, what is the probability that the first does?
99. Recall Example 1.51, where you know that the guilty child is a boy, a boy opens
the door, and he has one sibling. Compute the probability that the child who
opened the door is guilty if the guilty child opens the door with probability p.
100. Your new neighbors have three children. (a) If you are told about three indepen-
dent observations of a boy, what is the probability that they have three boys? (b)
If you get two confirmations of an observed boy and one of an observed girl,
what is the probability that they have two boys and a girl? (c) If you get j ≥1
confirmations of an observed boy and n −j ≥1 of an observed girl, what is
the probability that they have two boys and a girl?
101. Consider Example 1.53 about cystic fibrosis. (a) What is the probability that
two healthy parents have a child who neither is a carrier nor has the disease?
(b) Given that a child is healthy, what is the probability that both parents are
carriers (you may disregard parents with the disease)?
102. A genetic disease or condition is said to be sex-linked if the responsible gene
is located on either of the sex chromosomes, X and Y (recall that women have
two X chromosomes and men have one each of X and Y). One example is
red-green color-blindness for which the responsible gene is located on the X
chromosome. The allele for color-blindness is recessive, so that one normal
copy of the gene is sufficient for normal vision. (a) Consider a couple where
the woman is color-blind and the man has normal vision. If they have a daughter,
what is the probability that she is color-blind? If they have a son? (b) Compute
the probabilities in (a) under the assumption that both parents have normal
vision and the woman’s father was color-blind. (c) It is estimated that about 7%
of men are color-blind but only about 0.5% of women. Explain!
103. Tay–SachsDiseaseisaseriousgeneticdiseasethatusuallyleadstodeathinearly
childhood. The allele for the disease is recessive and autosomal (not located
on any of the sex chromosomes). (a) In the general population, about 1 in 250
is a carrier of the disease. What incidence among newborns does this give?
(b) Certain subpopulations are at greater risk for the disease. For example, the
incidence among newborns in the Cajun population of Louisiana is 1 in 3600.
What proportion of carriers does this give? (c) Generally, if a serious recessive
disease has a carrier frequency of one in n and an incidence among newborns

PROBLEMS
75
of one in N, what is the relation between n and N? (Why is it relevant that the
disease is “serious?”)
104. Consider the game of badminton in Example 1.57. (a) Find the probability that
Ann scores the next point if she is the receiver. (b) Now suppose that Ann wins
a rally as server with probability pA and let the corresponding probability for
Bob be pB. If Ann serves, what is the probability that she is the next player to
score?
105. In table tennis, a set is won by the first player to reach 11 points, unless the
score is 10–10, in which case serves are alternated and the player who first
gets ahead by two points wins. Suppose that Ann wins a point as server with
probability pA and Bob wins a point as server with probability pB. If the score
is 10–10 and Ann serves, what is the probability that she wins the set?
106. You are playing roulette, each time betting on “odd,” which occurs with prob-
ability 18
38 and gives you even money back. You start with $10 and decide to
play until you have either doubled your fortune or gone broke. Compute the
probability that you manage to double your fortune if in each round you bet
$10, $5, $2, and $1 dollar, respectively. After you have found the best strategy,
give an intuitive explanation of why it is the best and why it is called “bold
play.”
107. In Example 1.59, suppose that Ann wins each round with probability p > 1
2.
What is the probability that she eventually goes broke?
108. The game of Penney-ante can be played with patterns of any length n. In the
case n = 1, the game is fair (this is trivial); if n = 2, it can be fair or to your ad-
vantage, depending on the patterns chosen, and if n ≥3, you can always choose
a winning strategy. (a) Let n = 2, so that the possible patterns are HH, HT, TH,
and TT. Suggest a strategy and compute your winning probability in the dif-
ferent cases. (b) Let n = 4 and suppose that your opponent chooses HHHH.
Suggest how you should choose your best pattern and compute the winning
probability.
109. In the game of craps, you roll two dice and add the numbers. If you get 7 or
11 (a natural) you win, if you roll 2, 3, or 12 (craps) you lose. Any other roll
establishes your point. You then roll the dice repeatedly until you get either 7
or your point. If you get your point first you win, otherwise you lose. Starting
a new game of craps, what is the probability that you win?

2
RANDOM VARIABLES
2.1
INTRODUCTION
We saw in the previous chapter that many random experiments have numerical out-
comes. Even if the outcome itself is not numerical, such as the case is Example 1.4,
where a coin is ﬂipped twice, we often consider events that can be described in terms
of numbers, for example, {the number of heads equals 2}. It would be convenient to
have some mathematical notation to avoid the need to spell out all events in words.
For example, instead of writing {the number of heads equals 1} and {the number of
heads equals 2}, we could start by denoting the number of heads by X and consider
the events {X = 1} and {X = 2}. The quantity X is then something whose value is
not known before the experiment but becomes known after.
Deﬁnition 2.1. A random variable is a real-valued variable that gets its value from
a random experiment.
There is a more formal deﬁnition that deﬁnes a random variable as a real-valued
function on the sample space. If X denotes the number of heads in two coin ﬂips,
we would thus, for example, have X(HH) = 2. In a more advanced treatment of
probability theory, this formal deﬁnition is necessary, but for our purposes, Deﬁnition
2.1 is enough.
Probability, Statistics, and Stochastic Processes, Second Edition. Peter Olofsson and Mikael Andersson.
© 2012 John Wiley & Sons, Inc. Published 2012 by John Wiley & Sons, Inc.
76

DISCRETE RANDOM VARIABLES
77
A random variable X is thus something that does not have a value until after the
experiment. Before the experiment, we can only describe the set of possible values,
that is, the range of X and the associated probabilities. Let us look at a simple example.
Example 2.1. Flip a coin twice and let X denote the number of heads. Then X has
range {0, 1, 2} and the associated probabilities are
P(X = 0) = 1
4, P(X = 1) = 1
2, P(X = 2) = 1
4
and we refer to these probabilities as the distribution of X.
□
In the last example, any three numbers between 0 and 1 that sum to 1 is a possible
distribution (recall Section 1.4), and the particular choice in the example indicates
that the coin is fair. Let us next restate some of the examples from Section 1.2 in terms
of random variables. In each case, we deﬁne X and ﬁnd its range.
Example 2.2. Let X be the number of dots when a die is rolled. The range of X is
{1, 2, . . . , 6}.
□
Example 2.3. Let X be the number of rolls of a die until the ﬁrst 6 appears. The range
of X is {1, 2, . . .}.
□
Example 2.4. Let X be the lifetime of a lightbulb. The range of X is [0, ∞), the
nonnegative real numbers.
□
As noted in Section 1.2, the three sets above are different in nature. The ﬁrst is
ﬁnite, the second is countably inﬁnite, and the third is uncountable. The formal
deﬁnition of a countably inﬁnite set is one that can be put in a one-to-one corre-
spondence with the natural numbers. Examples of such sets are the natural num-
bers themselves {1, 2, 3, . . .}, the odd natural numbers {1, 3, 5, . . .}, and the integers
{. . . , −2, −1, 0, 1, 2, . . .}. Countably inﬁnite sets need not be sets of integers only;
for example, the set { 1
n : n = 1, 2, . . .} = {1, 1
2, 1
3, . . .} is countably inﬁnite. Hope-
fully it is intuitively clear what a countably inﬁnite set is, and we will not discuss the
complications and subtleties that arise in the study of cardinality of sets.
We use the term countable to refer to a set that is either ﬁnite or countably inﬁnite.
The reason for this is that in the study of random variables, the important distinction
turns out to be not between ﬁnite and inﬁnite ranges, but between countable and
uncountable ranges.
2.2
DISCRETE RANDOM VARIABLES
We distinguish primarily between random variables that have countable range and
those that have uncountable range. Let us examine the ﬁrst case and start with a
deﬁnition.

78
RANDOM VARIABLES
Deﬁnition 2.2. If the range of X is countable, then X is called a discrete random
variable.
For a discrete random variable X, we are interested in computing probabilities of
the type P(X = xk) for various values of xk in the range of X. As we vary xk, the
probability P(X = xk) changes, so it is natural to view P(X = xk) as a function of
xk. We now formally deﬁne and name this function.
Deﬁnition 2.3. Let X be a discrete random variable with range {x1, x2, . . .} (ﬁnite
or countably inﬁnite). The function
p(xk) = P(X = xk),
k = 1, 2, . . .
is called the probability mass function (pmf) of X.
Sometimes, we also use the notation pX for the pmf, if it is needed to stress which
the random variable is. When we represent a pmf as a bar chart, the height of a bar
equals the probability of the corresponding value on the x axis. Since X cannot take
on values other than x1, x2, . . ., we can imagine bars of height 0 at all other values
and could thus view the pmf as a function on all of R (the real numbers) if we wish.
The numbers x1, x2, . . . do not have to be integers, but they often are.
Example 2.5. Let X be the number of daughters in a family with three children.
By Example 1.13, the range of X is {0, 1, 2, 3} and the values of the pmf are
p(0) = 1
8, p(1) = 3
8, p(2) = 3
8, p(3) = 1
8. The pmf is illustrated in Figure 2.1.
□
0
1
2
3
 0
1/8
 2/8
3/8
FIGURE 2.1
Bar chart for the number of daughters in Example 2.5. The probability of 0
daughters is 1
8 and so on.

DISCRETE RANDOM VARIABLES
79
1
2
3
4
5
6
0 
50 
 100 
 150 
 200 
1
2
3
4
5
6
1/6 
FIGURE 2.2
Pmf and histogram of the roll of a fair die.
Now suppose that we have a discrete random variable X with pmf p and repeat the
experiment over and over to get a number, say, n, of outcomes of X. We then expect
the absolute frequency, that is, the number of times that we get the outcome xk, to be
approximately equal to np(xk). We can plot the absolute frequencies in a histogram,
which would then be expected to look similar in shape to the pmf (but different in
scale). In other words, we can think of the pmf as representing the “perfect histogram.”
Example 2.6. If we roll a die and let X denote the outcome, then X has pmf
p(k) = P(X = k) = 1
6,
k = 1, 2, . . . , 6
which is plotted in Figure 2.2, together with a histogram of 1000 simulated rolls of
the die. This is an example of a uniform distribution (compare with Section 1.4),
characterized by the pmf having the same value for all the possible outcomes of X.
Note that it is not possible to have a uniform distribution on an inﬁnite set (why?), so
there is no immediately clear interpretation of a statement such as “choose an integer
at random.”
□
Example 2.7. If we roll a die and let X denote the number of rolls until the ﬁrst 6
appears, then Example 1.41 reveals that the pmf of X is
p(k) = P(X = k) = 1
6
5
6
k−1
,
k = 1, 2, . . .
which is plotted in Figure 2.3 together with a histogram of 1000 simulated observa-
tions on X. The pmf has a bar at every positive integer, but the histogram must end
somewhere. In this case, the largest observed value of X was 44.
□
By the properties of probability measures, we have the following proposition.

80
RANDOM VARIABLES
0
20
40
60
0 
50 
100 
150 
0
20
40
60
0 
 0.05 
0.1 
FIGURE 2.3
Pmf and histogram of the number of rolls until the ﬁrst 6 appears.
Proposition 2.1. A function p is a possible pmf of a discrete random variable on
the range {x1, x2, . . .} if and only if
(a) p(xk) ≥0
for k = 1, 2, . . .
(b)
∞

k=1
p(xk) = 1
If the range of X is ﬁnite, the sum in (b) is ﬁnite. So far we have considered events of
the type {X = k}, the event that X equals a particular value k. We could also look at
events of the type {X ≤k}, the event that X is less than or equal to k. For example,
when we roll a die we might ask for the probability that we get at most 1, at most 2,
and so on. This leads to another function to be deﬁned next.
Deﬁnition 2.4. Let X be any random variable. The function
F(x) = P(X ≤x),
x ∈R
is called the (cumulative) distribution function (cdf) of X.
The word “cumulative” appears in parentheses because it is rarely used other than for
the acronym cdf. Note that the cdf is a function on the entire real line. To get an idea
of what it typically looks like, let us return to Example 2.5.
Example 2.8. In a family with three children, let X be the number of daughters. The
range of X is {0, 1, 2, 3}, so let us start by computing F(k) for these values. We get
F(0) = P(X ≤0) = p(0) = 1
8

DISCRETE RANDOM VARIABLES
81
since the only way to be less than or equal to 0 is to be equal to 0. For k = 1, we ﬁrst
note that being less than or equal to 1 means being equal to 0 or 1. In terms of events,
we have
{X ≤1} = {X = 0} ∪{X = 1}
and since the events are disjoint, we get
F(1) = P(X ≤1) = P(X = 0) + P(X = 1)
= p(0) + p(1) = 1
8 + 3
8 = 1
2
Continuing like this, we also get F(2) = 7
8 and F(3) = 1. Now we have the values
of F at the points in the range of X. What about other values? Let us, for example,
consider the point 0.5. Noting that X ≤0.5 means that X ≤0, we get
F(0.5) = F(0) = 1
8
andwerealizethatF(x) = F(0)forallpointsx ∈[0, 1).Similarly,allpointsx ∈[1, 2)
have F(x) = F(1) and all points x ∈[2, 3) have F(x) = F(2). Finally, since X cannot
take on any negative values, we have F(x) = 0 for x < 0, and since X is always at
most 3, we have F(x) = 1 for x ≥3. This gives the ﬁnal form of F, which is illustrated
in Figure 2.4.
□
The graph in Figure 2.4 is typical for the cdf of a discrete random variable. It jumps
at each value that X can assume, and the size of the jump is the probability of that
value. Between points in the range of X, the cdf is constant. Note how it is always
nondecreasing and how it ranges from 0 to 1. Also note in which way the points are
ﬁlled where F jumps, which can be expressed by saying that F is right-continuous.
−1
1
2
3
4
0 
1/2 
1 
0 
FIGURE 2.4
Graph of the cdf of the number of daughters in Example 2.8.

82
RANDOM VARIABLES
Some of these observed properties turn out to be true for any cdf, not only for that of
a discrete random variable. In the next section, we shall return to this.
In Example 2.8, F assumes the values 0 and 1. If the range of X is ﬁnite, this is
always the case but not necessarily if the range is countably inﬁnite, as the following
example shows.
Example 2.9. When X is the number of rolls until the ﬁrst 6 appears, the range is
{1, 2, . . .} and the pmf is given in Example 1.41. The value of the cdf at an integer n
is
F(n) =
n

k=1
p(k) = 1
6
n

k=1
5
6
k−1
= 1
6 × 1 −(5/6)n
1 −5/6
= 1 −
5
6
n
,
n = 1, 2, . . .
and the cdf approaches but never reaches 1.
□
The cdf and the pmf are related according to the following proposition, which we
state without proof.
Proposition 2.2. Let X be a discrete random variable with range {x1, x2, . . .}, pmf
p, and cdf F. Then
(a) F(x) =

k:xk≤x
p(xk), x ∈R
(b) p(xk) = F(xk) −lim
y↑xk
F(y), k = 1, 2, . . .
(c) For B ⊆R, P(X ∈B) =

k:xk∈B
p(xk)
Note how part (b) says that the probability of a point is the size of the jump of F in
that point. If F does not jump at x, the left-hand side limit limy↑x F(y) equals F(x)
and the probability that X equals x is 0. Also note that part (a) is a special case of part
(c) with the particular choice B = (−∞, x].
2.3
CONTINUOUS RANDOM VARIABLES
To introduce another type of random variable, let X be the lifetime of a lightbulb
so that it has range [0, ∞). Since this is an uncountable set, X is not a discrete
random variable. However, we can still imagine computing probabilities of events of
the type {X ≤x} for different values of x, and we can deﬁne the cdf as previously,
F(x) = P(X ≤x). Indeed, Deﬁnition 2.4 is stated for an arbitrary random variable,
not necessarily discrete. What does F look like in this case?

CONTINUOUS RANDOM VARIABLES
83
Recall the cdf for a discrete random variable. This is a nondecreasing function,
ranging from 0 to 1, which jumps precisely at the points that X can assume. For
our lightbulb, the cdf should be nondecreasing (why?), range from 0 to 1, and have
F(x) = 0 for x < 0. Finally, since X can assume every positive value, there must be
an “inﬁnitely small jump at every point,” and the only way for this to be possible is
if F is a continuous function. With the deﬁnition of cdf remaining the same as in the
previous section, we deﬁne the following.
Deﬁnition 2.5. If the cdf F is a continuous function, then X is said to be a continuous
random variable.
The deﬁnitions of discrete and continuous random variables are qualitatively different.
A discrete random variable is deﬁned through its range; a continuous random variable,
through its cdf. Although a continuous random variable must have an uncountable
range, this is not the deﬁnition and as we will see later, a random variable can have
an uncountable range and still have discontinuities in its cdf.
In Example 2.8 and Figure 2.4, we observed some properties of the cdf. These turn
out to hold in general, and we state the following proposition.
Proposition 2.3.
If F is the cdf of any random variable, F has the following
properties:
(a) It is nondecreasing.
(b) It is right-continuous.
(c) It has the limits F(−∞) = 0 and F(∞) = 1 (where the limits may or may
not be attained at ﬁnite x).
Since these properties are intuitively reasonable, we omit the technical proof. It should
be noted that F(∞) is deﬁned as limx→∞F(x) and is not the same as P(X ≤∞)
but rather P(X < ∞). This is so because, for any increasing sequence {xn} of real
numbers that is such that xn →∞, we have
{X < ∞} =
∞

n=1
{X ≤xn}
since if X is ﬁnite, it must be less than some xn. By continuity of probabilities (Propo-
sition 1.6), we get
P(X < ∞) = lim
n→∞P(X ≤xn) = lim
n→∞F(xn) = F(∞)
by deﬁnition (and similarly for −∞, using instead decreasing sequences). Right now,
this is no big deal since we do not allow random variables to be inﬁnite and hence
both P(X < ∞) and P(X ≤∞) equal 1. However, there are situations where it is

84
RANDOM VARIABLES
natural to let random variables also take on the value ∞. Consider, for example, the
gambler’s ruin problem from Example 1.58, and let the random variable T be the
time until Ann is ruined. It is then natural to let T = ∞mean that Bob was ruined
ﬁrst, that is, Ann’s ruin never occurred. We will see more examples of inﬁnite-valued
random variables in Chapter 8.
The properties listed in Proposition 2.3 are useful for a quick “sanity check” as
to whether a function is a cdf. If you have attempted to ﬁnd a cdf and your candi-
date violates any of (a) through (c) above, you have made an error somewhere. For
computations, the cdf can be used as follows.
Proposition 2.4. Let X be any random variable with cdf F. Then
(a) P(a < X ≤b) = F(b) −F(a), a ≤b
(b) P(X > x) = 1 −F(x), x ∈R
Proof. To prove (a), take a ≤b and ﬁrst note that
{X ≤b} = {X ≤a} ∪{a < X ≤b}
which is a disjoint union. Hence
P(X ≤b) = P(a < X ≤b) + P(X ≤a)
which is to say that
P(a < X ≤b) = P(X ≤b) −P(X ≤a) = F(b) −F(a)
by the deﬁnition of cdf. For part (b), note that the event {X > x} is the complement of
the event {X ≤x}, so this follows from Proposition 1.3 together with the deﬁnition
of cdf. Alternatively, we can view this as a special case of (a) with b = ∞.
■
The cdf is thus deﬁned in the same way for discrete and continuous random variables.
For discrete random variables, we also deﬁned the pmf, p(xk) = P(X = xk), for
values xk in the range of X where p(xk) measures the size of the jump of the cdf
at xk. In the continuous case, there are no such jumps, so there is no exact analogy.
However, instead of considering the jump size, let us consider the slope of the cdf. A
large jump size in the discrete case then corresponds to a steep slope in the continuous
case. Since the size of the slope of a function is measured by its derivative, we present
the following deﬁnition.
Deﬁnition 2.6. The function f(x) = F′(x) is called the probability density function
(pdf) of X.

CONTINUOUS RANDOM VARIABLES
85
1 
x2
x1
x2
x1
FIGURE 2.5
A pdf and corresponding cdf of a continuous random variable. Note how high
values of the pdf correspond to sharp increases in the cdf.
For a continuous random variable, the pdf plays the role of a discrete random variable’s
pmf. Since the pdf is the derivative of the cdf, the fundamental theorem of calculus
gives that we can obtain the cdf from the pdf as
F(x) =
 x
−∞
f(t)dt
(see Figure 2.5). Compare with the discrete case where the relation between cdf and
pmf is
F(x) =

k:xk≤x
p(xk)
We get the following analog of Proposition 2.2, stated without proof.
Proposition 2.5.
Let X be a continuous random variable with pdf f and cdf F.
Then
(a) F(x) =
 x
−∞
f(t)dt,
x ∈R
(b) f(x) = F′(x),
x ∈R
(c) For B ⊆R, P(X ∈B) =

B
f(x)dx
The notation

B means that we compute the integral over the set B. Often
B is simply an interval but it could also be a union of intervals or possibly some
more complicated set.1 The special case of an interval, B = (a, b], gives, for a
1It turns out that B cannot be any set but must be chosen among the so-called “Borel sets.” This is a
necessary restriction in a more advanced treatment of probability theory but is of no concern to us. The
sets that are not Borel sets are very bizarre and never arise in practice. It should also be pointed out that the
existence of a function f satisfying part (c) of Proposition 2.5 is often taken as the deﬁnition of a continuous

86
RANDOM VARIABLES
P(a<X≤ b)
a
b
FIGURE 2.6
Illustration of Proposition 2.5(c); the probability that X is between a and b is
the area under the pdf.
continuous random variable
P(a < X ≤b) =
 b
a
f(x)dx
and combining this with Proposition 2.4(a) gives
F(b) −F(a) =
 b
a
f(x)dx
The probability that X falls in the interval (a, b] is thus the area under the pdf between
a and b (see Figure 2.6).
Since P(X ∈R) = 1, we also get the following analog of Proposition 2.1.
Proposition 2.6. A function f is a possible pdf of some continuous random variable
if and only if
(a) f(x) ≥0, x ∈R
(b)
 ∞
−∞
f(x)dx = 1
random variable. In fact, our deﬁnition in terms of the continuity of the cdf is slightly more restrictive since
there exist continuous functions that are not differentiable anywhere. However, such functions are of no
practical use, so we stick to our deﬁnition.

CONTINUOUS RANDOM VARIABLES
87
Since the value of an integral does not change by the inclusion or exclusion of a single
point, we realize that we can alter the inequalities between strict and nonstrict, and,
for instance, we get
P(a ≤X ≤b) =
 b
a
f(x)dx = F(b) −F(a) = P(a < X ≤b)
and so on. Let us state this important fact as a corollary.
Corollary 2.1. For a continuous random variable X, probabilities do not change
if strict and nonstrict inequalities are interchanged in events.
This is not true for discrete random variables. For example, if we roll a die there is
a difference between P(X ≤6) and P(X < 6). The intuition behind Corollary 2.1 is
that the probabilities are so “smeared out” over the range of X that it does not matter
if we add or remove single points.
Example 2.10. Let X be the lifetime (in hours) of a lightbulb and suppose that X has
pdf
f(x) =

0
if x < 0
0.001e−0.001x if x ≥0
Verify that this is a possible pdf and ﬁnd (a) P(X < 1000), (b) P(100 ≤X ≤1000),
(c) a number x such that a lightbulb survives the age x with probability 0.5.
First note that the fact that X can assume only nonnegative values is reﬂected in the
pdf being 0 for negative x. Clearly f is nonnegative and also
 ∞
−∞
f(x)dx =
 ∞
0
0.001e−0.001xdx
=
	
−e−0.001x
∞
0
= 1
and f is a possible pdf. To compute the probabilities, let us ﬁrst ﬁnd the cdf:
F(x) =
 x
−∞
f(t)dt =
 x
0
0.001 e−0.001tdt
= 1 −e−0.001x, x ≥0
For (a) we get
P(X < 1000) = P(X ≤1000) = F(1000)
= 1 −e−0.001×1000 ≈0.63

88
RANDOM VARIABLES
and for (b)
P(100 ≤X ≤1000) = F(1000) −F(100)
= 1 −e−1 −(1 −e−0.1) ≈0.54
and ﬁnally for (c), note that “surviving age x” is the event {X > x}, and we get
0.5 = P(X > x) = 1 −F(x) = e−0.001x
which gives
x = log 0.5
−0.001 ≈693
This number is called the median of X. If we have a large number of lightbulbs, about
half of them function longer than 693 h.
□
In the example, we formally integrate the pdf from −∞to ∞, but the negative part
vanishes since f equals 0 there. From now on, we will give the functional expression
for a pdf only where it is positive and understand that it is 0 everywhere else.
Now let X be a continuous random variable and consider a point x in the range of
X. If X is less than or equal to x, then it is either strictly less than x or exactly equal
to x, or in terms of events
{X ≤x} = {X < x} ∪{X = x}
This union is clearly disjoint and hence
P(X ≤x) = P(X < x) + P(X = x)
which gives
P(X = x) = P(X ≤x) −P(X < x)
and by Corollary 2.1 this equals 0! The probability that a continuous random variable
equals any particular value is thus 0, which at ﬁrst sight may seem surprising since
we must get some value of X in the experiment. If we think about the underlying
mathematics, this becomes less mysterious since we know that the integral over an
interval can be positive even though the interval over each single point is 0. We will
not delve any deeper into this; just remember that the range of a continuous random
variable is so large that we cannot assign positive probabilities to individual points,
only to intervals.
One consequence of the discussion above is that the interpretation of the pdf is
different from its discrete counterpart, the pmf. Recall that if X is discrete and has
pmf p, then p(x) = P(X = x). If X is continuous, however, P(X = x) = 0 for all x
and is thus not equal to the pdf f(x). How, then, should we interpret f(x)?
To get some feeling for what a pdf is, consider a continuous random variable X
with pdf f and take two points, x1 and x2, in the range of X such that f(x1) > f(x2).

CONTINUOUS RANDOM VARIABLES
89
x1
x2
f(x1) 
f(x2) 
FIGURE 2.7
Interpretation of the pdf. Since f(x1) > f(x2), it is more likely that X is close
to x1 than to x2.
Now take a small ϵ > 0 and place symmetric intervals of lengths ϵ around x1 and x2
(see Figure 2.7). Let us call the intervals I1 and I2, respectively. We get
P(X ∈I1) =
 x1+ϵ/2
x1−ϵ/2
f(t)dt ≈ϵf(x1)
and similarly
P(X ∈I2) ≈ϵf(x2)
Now, since f(x1) > f(x2), the probability that X belongs to I1 is the larger of the
two. This suggests an interpretation of the pdf in a point x; it measures how likely
it is that X is in the neighborhood of x, not exactly equal to x. Although not exactly
the same as the pmf, the shape of the pdf still gives information on where X is most
likely to assume its values.
Consider again the lightbulb with the pdf given in Example 2.10 above. In Figure
2.8, the pdf and a histogram of 1000 simulated values of X are plotted. To construct
a histogram for a continuous distribution, we divide the x-axis into bins and count
the number of observations in each bin. The number of bins depends on how many
observations we have and has to be decided in each case. (Think about what the
histogram would look like if we had too many or too few bins.) Note how the shape
of the histogram mirrors the shape of the pdf.
Whenever the pdf of X is given, we say that it deﬁnes the distribution of X. By
virtue of Proposition 2.5, we realize that the pdf is uniquely determined by the cdf
and vice versa, so either of the two speciﬁes the distribution of X. The advantage

90
RANDOM VARIABLES
0
2000
4000
6000
0
2000
4000
6000
FIGURE 2.8
Pdf of the lifetime of the lightbulb in Example 2.10 and histogram of 1000
simulated such lifetimes. Since we are interested only in comparing the shape, the scale on the
y-axis has been omitted.
of stating the pdf is that it has the graphical interpretation mentioned above, and the
advantage of the cdf is that it is directly interpretable as a probability.
2.3.1
The Uniform Distribution
Consider the experiment to choose a real number at random between 0 and 1. As
usual, the interpretation of “at random” is that no number is more likely than any
other to be chosen. Since the range is an uncountable set, we now need to specify
what this means in terms of probabilities of intervals rather than single points. Call
the number X, and consider an interval Ih ⊆[0, 1] of length h. The interpretation of
“at random” is then that
P(X ∈Ih) = h
regardless of the value of h and where the interval Ih is located. This means that
the pdf must be constant between 0 and 1 (and 0 otherwise), and since it must also
integrate to one, we realize that the pdf of X is
f(x) = 1,
0 ≤x ≤1
and we say that X has a uniform distribution on [0, 1]. To ﬁnd the cdf of X, take
x ∈[0, 1] to obtain
F(x) =
 x
−∞
f(t)dt = x,
0 ≤x ≤1
and F(x) = 0 for x < 0, and F(x) = 1 for x > 1. Note that the cdf is a continuous
function, so X is by deﬁnition a continuous random variable. With a similar argument,
we can deﬁne the uniform distribution on any interval [a, b] as follows.

CONTINUOUS RANDOM VARIABLES
91
Deﬁnition 2.7. If the pdf of X is
f(x) =
1
b −a,
a ≤x ≤b
then X is said to have a uniform distribution on [a, b], written X ∼unif[a, b].
The corresponding cdf is
F(x) =
 x
a
f(t)dt = x −a
b −a,
a ≤x ≤b
Since this is a continuous distribution, it does not matter if we include or exclude the
endpoints of the interval, since these have probability 0. Thus, a uniform distribution
on the open interval (a, b) is, from this perspective, the same as a uniform distribution
on the closed interval [a, b]. Also note how the cdf F is not differentiable at the points
a and b, which for the same reason does not matter.
Recall that we previously talked about the uniform distribution on a ﬁnite set (Sec-
tion 1.4 and Example 2.6). This was an example of the discrete uniform distribution
characterized by a constant pmf on a ﬁnite set. What we have deﬁned here is the con-
tinuous analog, characterized by a constant pdf on a ﬁnite interval. It is impossible to
have a uniform distribution on an inﬁnite interval (why?). Hence, a statement such as
“choose a real number at random” does not have a clear interpretation.
The uniform distribution on [0, 1] is often referred to as the standard uniform
distribution. There is a simple relation between the general and the standard uniform
distribution, which we state next.
Proposition 2.7.
Let X ∼unif[0, 1] and deﬁne the random variable Y by
Y = a + (b −a)X. Then Y ∼unif[a, b].
Proof. Note that Y has range [a, b]. We need to show that the pdf of Y is of the form
in Deﬁnition 2.7. To do this, let us ﬁrst consider the cdf of Y, FY. Take x ∈[a, b] to
obtain
FY(x) = P(a + (b −a)X ≤x)
= P

X ≤x −a
b −a

= FX
x −a
b −a

the cdf of the random variable X evaluated at the point (x −a)/(b −a). Now we can
use the fact that X ∼unif[0, 1] and thus FX(t) = t, to obtain
FY(x) = x −a
b −a,
a ≤x ≤b

92
RANDOM VARIABLES
from which we get the pdf
fY(x) = F′
Y(x) =
1
b −a,
a ≤x ≤b
which we recognize as the pdf of a uniform distribution on [a, b].
■
Thus we can transform a standard uniform distribution into any other uniform dis-
tribution. Conversely, if X ∼unif[a, b], then the random variable (X −a)/(b −a) is
standard uniform. As we will see later, the standard uniform distribution is a funda-
mental tool for computer simulation of random variables. In that context, observations
generated from the standard uniform distribution are called random numbers, and we
see here that if we are given such random numbers, we can transform them to
observations from a uniform distribution on [a, b] by multiplying each with b −a
and adding a (scaling and translating).
Finally, a word on terminology. The term used for the distribution may also be
applied directly to the random variable. Hence, we mean the same thing by saying
“X is a uniform random variable” and “X has a uniform distribution” and the phrase
“generate a couple of standard uniforms” is a quicker way to say “generate a couple
of random variables that have the uniform distribution on [0, 1].”
2.3.2
Functions of Random Variables
In Proposition 2.7, we started from a random variable X and deﬁned a new random
variable Y through the relation Y = a + (b −a)X. We then managed to ﬁnd the dis-
tribution of Y from knowledge of the distribution of X. More generally, suppose that
we are given a random variable X with known distribution and a function g, and deﬁne
a new random variable Y = g(X). Can we ﬁnd the distribution of Y on the basis of
our knowledge of the distribution of X?
We need to distinguish between the discrete and the continuous cases. The discrete
case is easy and can be treated with methods that we already know. Suppose that X is
discrete with range {x1, x2, . . .} and pmf pX and let Y = g(X). The range of Y is then
{y1, y2, . . .}, the possible function values. Note that this range may be strictly smaller
than the range of X, in the case that g maps several x values to the same y value. In
the extreme case that g is constant, Y can only assume one value, regardless of what
X is. Now consider the value of the pmf of Y in a point yk, pY(yk) = P(Y = yk). We
can express the event {Y = yk} as a subset of the range of X. Thus, let
Bk = {xj : g(xj) = yk}
the set of values that are mapped to yk and apply Proposition 2.2(c) to obtain
pY(yk) = P(Y = yk) = P(X ∈Bk) =

j:xj∈Bk
pX(xj)
The continuous case is more complicated since a distribution is deﬁned through its
pdf. The trick here is to start with the cdf, and we illustrate this in a few examples.

CONTINUOUS RANDOM VARIABLES
93
Example 2.11. Suppose that X ∼unif(−π/2, π/2) and let Y = sin(X). Find the pdf
of Y.
First note that the range of Y is (−1, 1). Now take a y in this range and note that
{Y ≤y} = {X ≤sin−1(y)} to obtain
FY(y) = P(Y ≤y) = P(X ≤sin−1(y))
= FX(sin−1(y)) = 1
π sin−1(y) + 1
2
where we have used that the cdf of X is FX(x) = (x + π/2)/π, −π/2 ≤x ≤π/2.
This gives the pdf
fY(y) = F′
Y(y) = 1
π
d
dy sin−1(y) =
1
π

1 −y2 ,
−1 < y < 1
We chose to deﬁne the uniform distribution on the open interval rather than the closed
interval to avoid inﬁnite values of the pdf, but as noted previously, this is merely a
cosmetic issue.
□
Example 2.12. Road salt is spread on a road to melt snow and ice. Suppose that the
resulting water has a temperature of X◦C, which has pdf
fX(x) = 1
25(10 −2x), 0 ≤x ≤5
What is the pdf of the temperature if we convert it to degrees Fahrenheit?
The relation between Fahrenheit Y and Celsius X is
Y = 1.8X + 32
so the range of Y is [32, 41]. Start with the cdf to obtain
FY(y) = P(1.8X + 32 ≤y)
= P

X ≤y −32
1.8

= FX
y −32
1.8

which we differentiate to get the pdf
fY(y) = F′
Y(y) =
d
dyFX
y −32
1.8

= fX
y −32
1.8

× 1
1.8 =
1
45

10 −2 × y −32
1.8

= 1
81(82 −2y), 32 ≤y ≤41.
□

94
RANDOM VARIABLES
These examples illustrate how to arrive at the desired pdf. Start with the cdf of one
random variable, express it in terms of the cdf of the other, and ﬁnally differenti-
ate to get the pdf. The last example deals with a linear transformation of the form
Y = aX + b, where a > 0. By going through the same steps as in the example, we
realize that the pdf of Y is
fY(y) = 1
afX
y −b
a

for y in the range of Y. Generally, if Y = g(X) where g is a strictly increasing and
differentiable function, the event {g(X) ≤y} is the same as {X ≤g−1(y)}, and we
have the relation
FY(y) = FX(g−1(y))
which gives the pdf
fY(y) = fX(g−1(y)) d
dyg−1(y)
If g is instead strictly decreasing and differentiable, the event {g(X) ≤y} is the same
as {X ≥g−1(y)} and we get
FY(y) = 1 −FX(g−1(y))
and
fY(y) = fX(g−1(y))

−d
dyg−1(y)

We summarize in the following proposition.
Proposition 2.8.
Let X be a continuous random variable with pdf X, let g be a
strictly increasing or strictly decreasing, differentiable function, and let Y = g(X).
Then Y has pdf
fY(y) =

d
dyg−1(y)
 fX(g−1(y))
for y in the range of Y.
Functions that are not strictly increasing or decreasing can usually be broken up into
pieces that are. In practice, it is often just as easy to start with the cdf of Y and work
through the steps in the examples, as it is to apply the proposition.
Example 2.13. Let X ∼unif[−1, 1], and let A be the area of a square that has one
corner at the origin and the next at the point X on the x-axis. Find the pdf of A.

EXPECTED VALUE AND VARIANCE
95
The range of A is [0, 1] and since A = X2, we get the cdf
FA(a) = P(X2 ≤a) = P(−√a ≤X ≤√a)
= FX(√a) −FX(−√a)
=
√a + 1
2
−−√a + 1
2
= √a,
0 ≤a ≤1
which gives the pdf
fA(a) = F′
A(a) =
1
2√a,
0 ≤a ≤1
It would be more cumbersome to try to apply Proposition 2.8 by considering the cases
X > 0 and X ≤0 separately.
□
We ﬁnish with an example that shows that applying a function g can turn a continuous
random variable into a discrete random variable.
Example 2.14. Let X ∼unif[0, 1] and let Y = [6X] + 1, where [ · ] denotes integer
part. What is the distribution of Y?
First note that the range of Y is {1, 2, . . . , 6} so Y is a discrete random variable.
Second, for k in the range of Y, we obtain
{Y = k} = {k −1 ≤[6X] < k} =
k −1
6
≤X < k
6

which gives
P(Y = k) = P
k −1
6
≤X < k
6

= 1
6,
k = 1, 2, . . . , 6
and Y has the discrete uniform distribution on {1, 2, . . . , 6}. Thus, if we generate
random numbers and apply the function g(x) = [6x] + 1 to each, we can simulate
rolls of a fair die. We will return to this in Chapter 5.
□
2.4
EXPECTED VALUE AND VARIANCE
In both daily language and scientiﬁc reporting, quantitative properties are often
described in terms of averages. For example, a tourist guide for a travel destina-
tion may state average monthly temperatures. The stock market indices are weighted
averages of several individual stock prices. We talk about averages when we discuss
salaries, home prices, amounts of rainfall, and so on. Common for all these examples
is that instead of presenting the entire data set, a single number is given to summarize
the data. This is convenient, and if I plan to visit Honolulu in December, the informa-
tion that the average daily high temperature is 81°F is enough for me to plan my trip.

96
RANDOM VARIABLES
It probably would not give me any extra useful information to see the entire data set
of all the temperature measurements from which this number is computed.
With this in mind, it would be convenient to have a similar way to describe random
variables. That is, instead of giving the entire distribution, we could give a single
number that summarizes it and gives useful information. How should we choose this
number? Let us consider the experiment of rolling a die. If we roll it repeatedly and
denote the consecutive outcomes X1, X2, . . ., we can consider the average (X1 +
· · · + Xn)/n of the n ﬁrst rolls. If we further denote the number of k’s by Nk for
k = 1, 2, . . . , 6, we get
X1 + · · · + Xn
n
=
6

k=1
kNk
n
and if n is large, we expect the relative frequencies Nk/n to be approximately equal
to the corresponding probabilities, which in this case are all 1
6. But this means that
we expect
X1 + · · · + Xn
n
≈1
6(1 + 2 + · · · + 6) = 3.5
and we expect the approximation to be better the larger the value of n. Hence, 3.5 is
a long-term average of the rolls of a die, and we can give this number as a summary
of the experiment. Inspired by this we state the following deﬁnition.
Deﬁnition 2.8. Let X be a discrete random variable with range {x1, x2, . . .} (ﬁnite
or countably inﬁnite) and probability mass function p. The expected value of X is
deﬁned as
E[X] =
∞

k=1
xkp(xk)
The expected value is thus a weighted average of the possible values of X, with the
corresponding probabilities as weights. It can be thought of as a theoretical spatial
average over the range of X, whereas we can describe the consecutive averages men-
tioned above as time averages. Note that the expected value is a number computed
from the distribution, whereas time averages are computed from experiments and are
thus random. We will return to this discussion and make it strict in Chapter 4.
The terms expectation and mean are used as synonyms of expected value, and the
letter μ is often used to denote it. Let us look at some examples.
Example 2.15. An American roulette table has the numbers 1–36, plus 0 and 00.
Suppose that you bet $1 on “odd.” What is your expected gain?

EXPECTED VALUE AND VARIANCE
97
If the winning number is odd, you win $1; if it is not, you lose $1, which we can
describe as a negative gain. Hence, if X is your gain, we have
X =

1 with probability 18/38
−1 with probability 20/38
and get
E[X] = 1 × 18
38 + (−1) × 20
38 = −1
19
so on average you lose about 5 cents for each dollar you bet.
□
Example 2.16. In the previous example, consider instead a straight bet, which means
that you bet on a single number. Which payout should the casino choose for you to
have the same expected loss as when you bet on odd?
Again denote your gain by X. We have
X =

a with probability 1/38
−1 with probability 37/38
which has expected value
E[X] = a × 1
38 + (−1) × 37
38 = a −37
38
which we set equal to −1
19 to obtain a = 35.
□
As you have noticed by now, the expected value is not necessarily a value that X can
assume, so in this sense, the term “expected” is slightly misleading.
If the random variable is nonnegative, there is an alternative way to compute the
expected value according to the following proposition.
Proposition 2.9. Let X be a discrete random variable with range {0, 1, . . .}. Then
E[X] =
∞

n=0
P(X > n)

98
RANDOM VARIABLES
Proof. Note that k = k
n=1 1, and use the deﬁnition of expected value to obtain
E[X] =
∞

k=1
kP(X = k) =
∞

k=1
k

n=1
P(X = k)
=
∞

n=1
∞

k=n
P(X = k) =
∞

n=1
P(X ≥n)
=
∞

n=0
P(X > n)
■
Example 2.17. Whatistheexpectednumberofrollsof afairdieuntilwegettheﬁrst6?
If we let the number be X, Example 2.9 gives
P(X > n) = 1 −F(n) =
5
6
n
, n = 0, 1, . . .
and the expected value is
E[X] =
∞

n=0
P(X > n) =
∞

n=0
5
6
n
=
1
1 −5/6 = 6
so on average it takes 6 rolls to get the ﬁrst 6. We leave it to the reader to ponder
whether this is intuitively clear.
□
We proceed to the deﬁnition of expected value in the continuous case. Remember
how sums are replaced by integrals, and the following deﬁnition should not come as
a surprise.
Deﬁnition 2.9. Let X be a continuous random variable with pdf f. The expected
value of X is deﬁned as
E[X] =
 ∞
−∞
xf(x)dx
The formal integral limits are −∞and ∞, but in reality the limits are determined by
the range of X, which is where f(x) is positive.

EXPECTED VALUE AND VARIANCE
99
Example 2.18. Let X ∼unif[a, b]. Find E[X].
By Deﬁnition 2.9,
E[X] =
 ∞
−∞
xf(x)dx =
1
b −a
 b
a
x dx = a + b
2
which is the midpoint of the interval [a, b].
□
For nonnegative continuous random variables, there is an analog of Proposition 2.9.
We leave the proof as an exercise.
Proposition 2.10. Let X be a continuous random variable with range [0, ∞). Then
E[X] =
 ∞
0
P(X > x)dx
Example 2.19. Find the expected lifetime of the lightbulb in Example 2.10.
The pdf is
f(x) = 0.001e−0.001x, x ≥0
so we can ﬁnd the expected value according to the deﬁnition as
E[X] =
 ∞
0
xf(x)dx
Since the range of X is [0, ∞), we can also use Proposition 2.10. We know from the
example that
P(X > x) = e−0.001x, x ≥0
and get
E[X] =
 ∞
0
e−0.001xdx =

−e−0.001x
0.001
∞
0
= 1000
which, if done by hand, is a little bit simpler than using the deﬁnition directly since
it avoids the partial integration.
□
One important property of the expected value is that it is linear, in the following sense.

100
RANDOM VARIABLES
Proposition 2.11. Let X be any random variable, and let a and b be real numbers.
Then
E[aX + b] = aE[X] + b
Proof. We prove this in the continuous case, for a > 0. The discrete is analogous,
replacing integrals by sums. Let Y = aX + b, and note that Y is a continuous random
variable, which by Proposition 2.8 has pdf
fY(y) = 1
afX
y −b
a

and by deﬁnition, the expected value of Y is
E[Y] =
 ∞
−∞
yfY(y)dy = 1
a
 ∞
−∞
yfX
y −b
a

dy
where the variable substitution y = ax + b gives dy = a dx and hence
E[Y] =
 ∞
−∞
(ax + b)fX(x)dx
= a
 ∞
−∞
xfX(x)dx + b
 ∞
−∞
fX(x)dx = aE[X] + b
and we are done.
■
In the proof we discovered the identity
E[aX + b] =
 ∞
−∞
(ax + b)fX(x)dx
which, as we shall see next, is a special case of a more general result.
2.4.1
The Expected Value of a Function of a Random Variable
In the previous section, we considered the expected value of a linear transformation
aX + b. It is natural to ask what can be said about the expected value of an arbitrary
function g applied to X, E[g(X)]. In Section 2.3.2, we learned how to ﬁnd the pdf
of g(X), at least for strictly monotone functions g, and this can be used to ﬁnd the
expected value of g(X) according to the deﬁnition, but there is a quicker way. Let us
start with an example.
Example 2.20. Let X ∼unif[0, 2]. What is the expected area of a square with side-
length X?

EXPECTED VALUE AND VARIANCE
101
The random variable of interest is A = X2. To ﬁnd E[A], we compute it according
to the deﬁnition of expected value. Let us ﬁrst ﬁnd the pdf of A, fA. Since we are
dealing with a continuous random variable, we need to start with the cdf, FA. Note
that the range of A is [0, 4], and take an a in this range to obtain
FA(a) = P(A ≤a) = P(X ≤√a) =
√a
2 ,
0 ≤a ≤4
since X ∼unif[0, 2]. We get the pdf
fA(a) = F′
A(a) =
1
4√a
and expected value
E[A] =
 4
0
afA(a)da = 1
4
 4
0
√a da = 1
4
2
3a√a
4
0
= 4
3
□
This example is illuminating in several ways. First, note that the expected area is not
equal to the square of the expected sidelength. At ﬁrst it might seem paradoxical that
the “typical square has side 1 and area 4
3,” but the situation clears up if we think of
expected values as averages of large numbers of observations. For the sidelength,
small values (near 0) and large values (near 2) average each other out around 1.
However, when the values are squared, values near 0 stay near 0 but those near 2
end up closer to 4. Thus, larger values have more impact when squared, and push the
expected area up.
Second, note that the distribution of A is not uniform on its range [0, 4]. To un-
derstand why, consider, for example, the two intervals [0, 0.25] and [3.75, 4], both
of length 0.25. The probability that A is in the ﬁrst is the probability that X is in
[
√
0,
√
0.25] = [0, 0.5], which is 0.25, and the probability that A is in the second is
the probability that X is in [
√
3.75,
√
4] = [1.94, 2], which is only 0.03.
Finally, if we make the variable substitution x = √a in the expression for E[A]
above, we get da = 2x dx, the new integral limits [0, 2], and
E[A] =
 4
0
afA(a)da = 1
4
 4
0
√a da = 1
2
 2
0
x2dx
Since the pdf of X is fX(x) = 1
2, 0 ≤x ≤2, we have shown that
E[X2] =
 2
0
x2fX(x)dx

102
RANDOM VARIABLES
that is, in this case, we could have computed the expected value of A without ﬁrst
ﬁnding its pdf. Compare the two expressions
E[A]
=
 4
0
afA(a)da
E[X2] =
 2
0
x2fX(x)dx
where the ﬁrst is according to the deﬁnition, and uses the range and pdf of A. In
contrast, the second expression uses the range and pdf of the original random variable
X and plugs in the function x2 in the integral. It turns out that this is no coincidence,
and we have the following result.
Proposition 2.12.
Let X be a random variable with pmf pX or pdf fX, and let
g : R →R be any function. Then
E[g(X)] =
⎧
⎪
⎪
⎪
⎪
⎪
⎪
⎨
⎪
⎪
⎪
⎪
⎪
⎪
⎩
∞

k=1
g(xk)pX(xk)
if X is discrete with range {x1, x2, . . .}
 ∞
−∞
g(x)fX(x)dx if X is continuous
Proof. The discrete case is straightforward. We will do the proof only for the con-
tinuous case in the special case when g is strictly increasing. By Proposition 2.8, the
pdf of Y = g(X) is
fY(y) =
 d
dyg−1(y)

fX(g−1(y))
which gives
E[Y] =
 ∞
−∞
yfY(y)dy =
 ∞
−∞
y
 d
dyg−1(y)

fX(g−1(y))dy
where we make the change of variables x = g−1(y), which gives y = g(x), dx =
d
dyg−1(y)dy, and
E[Y] =
 ∞
−∞
g(x)fX(x)dx
as desired.
■
The general case of continuous X is more complicated. For instance, depending on
the function g, g(X) may be discrete even if X is continuous (recall Example 2.14).
Proposition 2.18 is true for any function g, but the general proof is more involved

EXPECTED VALUE AND VARIANCE
103
and we skip it here. We are fortunate to have this proposition, since it is generally
much easier to compute E[g(X)] according to this method than it is to go through the
procedure of ﬁrst ﬁnding the distribution of g(X).
In Example 2.20, we saw that the expected area did not equal the square of the
expected sidelength. In other words, with μ = E[X], we had E[X2] /= μ2. Generally,
if g is a function and μ = E[X], it is most often the case that
E[g(X)] /= g(μ)
with one important exception: the linear case g(x) = ax + b, stated in Proposition
2.11.
Example 2.21. Recall Example 2.14, where X ∼unif[0, 1] and Y = [6X] + 1. Find
E[Y].
The function applied to X is g(x) = [6x] + 1 so it has expected value
E[g(X)] =
 1
0
([6x] + 1)fX(x)dx =
 1
0
[6x]dx + 1
and since [6x] = k if k
6 ≤x < k+1
6
for k = 0, 1, . . . , 5, we get
 1
0
[6x]dx = 0 + 1 + · · · + 5
6
= 2.5
which gives E[X] = 3.5, the mean of a fair die.
□
Example 2.22. A chemical reaction in a solution in a test tube produces a certain
chemical compound. The amount X in grams thus created has pdf
f(x) = 2x, 0 ≤x ≤1
Amounts below 0.5 g are considered too low, and in that case the solution is
discarded. After the reaction, what is the expected amount of the compound that is
kept?
We are looking for E[g(X)], where g is the function
g(x) =

0 if x ≤0.5
x if x > 0.5
and Proposition 2.12 gives
E[g(X)] =
 1
0
g(x)f(x)dx = 2
 1
0.5
x2dx ≈0.58
□

104
RANDOM VARIABLES
Expected values do not have to be ﬁnite, as the following famous example shows.
Example 2.23 (St Petersburg Paradox). Consider the following roulette strategy.
You bet $1 on odd, and if you win, you quit. If you lose, you bet $2 on odd, and in
each subsequent round either quit if you win or double your bet if you lose. (a) What
is the expected number of rounds until you win, and what is then your net gain? (b)
What is your expected loss before the ﬁrst win?
In each round, you win with probability 18
38, and in an analogy with Example 2.17,
the expected number of rounds until your ﬁrst win is 38
18 ≈2.1. If you have had n −1
consecutive losses prior to the ﬁrst win in the nth round, you have lost 1 + 2 + · · · +
2n−2 = 2n−1 −1, and since you bet 2n−1 in the nth round, your net gain is one dollar.
Hence, each time you quit, you have gained a dollar, and each dollar takes on average
2.1 rounds to gain. This sounds almost too good to be true, does it not?
The problem with the strategy is revealed by solving (b). Let the time of your ﬁrst
win be T. In an analogy with Example 2.7, the pmf of T is
P(T = n) = 18
38
20
38
n−1
, n = 1, 2, . . .
and your accumulated loss before the ﬁrst win is the random variable L = 2T−1 −1,
which has expected value
E[L] =
∞

n=1
(2n−1 −1)P(T = n) = 18
38
∞

n=1
40
38
n−1
−
20
38
n−1
= ∞
so your expected loss before the ﬁrst win is inﬁnite! In practice, this means that
whatever fortune you start with, eventually you will go broke if you play this strategy.
It was indeed too good to be true, and Donald Trump is still wealthier than all the
world’s probabilists.
This example is one version of the St Petersburg paradox, which dates back to the
eighteenth century, and occurs in many variants in the probability literature.
□
There is nothing strange about the random variable L in the last example. Each
outcome of T gives an outcome of L, and the range of L is the set {0, 1, 3, 7, . . .}.
Thus, L itself is always ﬁnite but its expected value is inﬁnite. If we were to get
consecutive observations on L, the consecutive averages would tend to grow beyond
all bounds.
2.4.2
Variance of a Random Variable
We introduced the expected value as a number that summarizes the distribution of a
random variable X. Since it gives an idea of where X is on the average, the expected
value is often referred to as a location parameter. The expected value does, however,
not give any information of the variability of X, as the following example illustrates.

EXPECTED VALUE AND VARIANCE
105
Example 2.24. Suppose that we are about to weigh a piece of metal, and have at
our disposal two different scales, one that gives the correct weight with an error of
±0.01 g, and the second with an error of ±0.1 g. If the true weight of the piece is
w g, we thus assume that the scales give the weights X ∼unif[w −0.01, w + 0.01]
and Y ∼unif[w −0.1, w + 0.1], respectively. The expected values are
E[X] = w
and
E[Y] = w
that is, both scales give the correct weight on average. However, it is clear that the ﬁrst
scale is preferred because of its better precision. This is not reﬂected in the expected
values.
□
If we, together with the expected value, also had a measure of variability, the two
numbers together would give more information about the distribution than would
the expected value alone. Since the expected value μ measures location, we want to
somehow measure the random variable’s variability relative to the location, that is,
measure the average behavior of X −μ. This is a random quantity, and we would like
to describe it by a single number. We could try to take the expected value of X −μ,
but this would always give 0 since E[X −μ] = E[X] −μ = 0. Intuitively, values to
the left of μ cancel values to the right. Another attempt would be to take the expected
value of |X −μ|, which would give us a nonnegative number that measures the extent
to which X deviates from μ on average. As it turns out, the following deﬁnition gives
a more convenient measure than using the absolute value.
Deﬁnition 2.10. Let X be a random variable with expected value μ. The variance
of X is deﬁned as
Var [X] = E
	
(X −μ)2
The variance is often denoted σ2. Notice that (X −μ)2 ≥0, so the variance is a
nonnegative measure of variability where large values indicate thatX tends to ﬂuctuate
a lot around μ. Just like the mean, the variance can be inﬁnite. Since we have squared
the values, the variance is not on the same scale as X and μ. For example, if X and
μ are weights in grams, the unit of measure of Var[X] is square grams that does not
have a clear meaning. For this reason, we often use the following deﬁnition.
Deﬁnition 2.11. Let X be a random variable with variance σ2 = Var[X]. The stan-
dard deviation of X is then deﬁned as σ = √Var[X].
To compute the variance, we can use Proposition 2.12 with g(x) = (x −μ)2, but it is
often easier to use the following formula.

106
RANDOM VARIABLES
Corollary 2.2.
Var[X] = E[X2] −(E[X])2
Proof. We prove the continuous case. The discrete is the obvious analog. By Propo-
sition 2.12, we have
Var[X] = E[(X −μ)2] =
 ∞
−∞
(x −μ)2f(x)dx
=
 ∞
−∞
(x2 −2xμ + μ2)f(x)dx
=
 ∞
−∞
x2f(x)dx −2μ
 ∞
−∞
xf(x)dx + μ2
 ∞
−∞
f(x)dx
= E[X2] −2μE[X] + μ2 = E[X2] −(E[X])2
■
Example 2.25. Let X be the number when a die is rolled. Find Var[X].
The pmf is p(k) = 1
6, k = 1, 2, . . . , 6, which gives expected value
E[X] =
6

k=1
kp(k) = 1
6
6

k=1
k = 7
2
and by Proposition 2.12,
E[X2] =
6

k=1
k2p(k) = 1
6
6

k=1
k2 = 91
6
which gives
Var[X] = E[X2] −(E[X])2 = 35
12
□
Example 2.26. In Example 2.15, we calculated the expected gain in roulette.
Compute the variance of your gain if you (a) bet on odd and (b) make straight bets.
For (a), your gain X has distribution
X =

1 with probability 18/38
−1 with probability 20/38

EXPECTED VALUE AND VARIANCE
107
which has mean E[X] = −1
19. For the variance we need E[X2], which equals 1 since
X2 ≡1. Hence
Var[X] = E[X2] −(E[X])2 = 1 −

−1
19
2
= 360
361 ≈0.997
For (b) denote the gain by Y, which has distribution
Y =

35
with probability 1/38
−1 with probability 37/38
which has mean E[Y] = −1
19. Furthermore,
E[Y2] = 352 × 1
38 + (−1)2 × 37
38 = 631
19
which gives
Var[Y] = E[Y2] −(E[Y])2 = 631
19 −

−1
19
2
= 11988
361
≈33.2
Thus, X and Y have the same mean, so on average you lose just as much with either
strategy. The variance of Y is much larger than the variance of X, which reﬂects the
fact that you are more likely to lose a round with a straight bet, but when you win,
you win more.
□
Example 2.27. Let X ∼unif[a, b]. Find the variance of X.
We already know that E[X] = (a + b)/2. For the variance, we need E[X2] and get
E[X2] =
 b
a
x2f(x)dx =
1
b −a
x3
3
b
a
= a2 + ab + b2
3
which gives
Var[X] = a2 + ab + b2
3
−
a + b
2
2
= (b −a)2
12
after some elementary algebra.
□
Notice how these expressions for mean and variance are similar to those of the discrete
uniform distribution in Example 2.25. Let us state them separately.
Proposition 2.13. If X ∼unif[a, b], then
E[X] = a + b
2
and
Var[X] = (b −a)2
12

108
RANDOM VARIABLES
In mechanical engineering, these can be interpreted as the center of gravity and mo-
ment of inertia, respectively, of a solid bar with endpoints in a and b. The variance
formula in Corollary 2.2 can then be interpreted as Steiner’s theorem about moment
of inertia.
Example 2.28. Recall Example 2.24 about the two scales, where one gives a mea-
surement X ∼unif[w −0.01, w + 0.01] and the other, Y ∼unif[w −0.1, w + 0.1].
They both have expected value w, and by the formula given above, the variances are
Var[X] = 3.3 × 10−5
and
Var[Y] = 3.3 × 10−3
and the ﬁrst scale’s higher precision is reﬂected in its lower variance. The standard
deviations are 0.006 and 0.06, respectively, so we could say that the ﬁrst scale has 10
times better precision than the second.
□
Unlike the expected value, there is no immediate intuition behind the value of the
variance. In the previous example, we can use the variances to compare the two
scales, but the actual numbers are not immediately interpretable. Even if we calculate
the standard deviations, it is not clear what these numbers mean. Some help is given
by the following result.
Proposition 2.14 (Chebyshev’s Inequality). Let X be any random variable with
mean μ and variance σ2. For any constant c > 0, we have
P(|X −μ| ≥c σ) ≤1
c2
Proof. Let us prove the continuous case. Fix c and let B be the set {x ∈R : |x −μ| ≥
c σ}. We get
σ2 = E[(X −μ)2] =
 ∞
−∞
(x −μ)2f(x)dx
≥

B
(x −μ)2f(x)dx ≥c2σ2

B
f(x)dx = c2σ2P(X ∈B)
which gives the desired inequality.
■
Chebyshev’s inequality tells us that the probability is at least 1 −1/c2 that a random
variable is within c standard deviations of its mean, regardless of what the distribution
of X is. For example, X is within two standard deviations of its mean with probability
at least 0.75, and within three standard deviations with probability at least 0.89.
Example 2.29. The IQ of a randomly sampled individual can be viewed as a random
variable X. It is known that this has mean 100 and standard deviation 15. The highest

EXPECTED VALUE AND VARIANCE
109
recorded IQ is 228, belonging to Marilyn vos Savant, mentioned in Example 1.48.
What is the probability that a randomly sampled individual has an IQ that is at least
as high as Marilyn’s?
We apply Chebyshev’s inequality with μ = 100, σ = 15. Since
{|X −μ| ≥cσ} = {X ≤μ −cσ} ∪{X ≥μ + cσ}
we get
P(X ≥μ + cσ) ≤P(|X −μ| ≥cσ) ≤1
c2
Setting μ + cσ = 228 gives c ≈8.5, which in turn gives
P(X ≥228) ≤0.014
In words, at most 1.4% of the population has an IQ that is at least as high as Marilyn’s.
Note that this is only an upper bound, and the true number is likely to be smaller. See
also Problem 47.
□
Since Chebyshev’s inequality holds for all random variables, it is fairly coarse (as
you can see by plugging in c = 1) and we can get much better bounds if we know the
distribution of X. This is, for example, the case in the IQ example above, and we will
return to it later (with better news for Marilyn). Chebyshev’s inequality is of mostly
theoretical use.
In the previous section we saw that the expected value is linear. This is not true for
the variance, but the following proposition holds.
Proposition 2.15. Let X be any random variable, and let a and b be real numbers.
Then
Var[aX + b] = a2Var[X]
Proof. By the deﬁnition of variance applied to the random variable aX + b, we obtain
Var[aX + b] = E
	
(aX + b −E[aX + b])2
= E
	
(aX + b −aE[X] −b)2
= E
	
a2(X −E[X])2
= a2E
	
(X −E[X])2
= a2Var[X]
where we have used Proposition 2.11 repeatedly.
■

110
RANDOM VARIABLES
Example 2.30. Consider Example 2.12, where the temperature X in degrees Celsius
has pdf
fX(x) = 10 −2x
25
, 0 ≤x ≤5
Find the mean and variance of X, and the mean and variance of Y, which is the
temperature in degrees Fahrenheit.
The mean of X is
E[X] = 1
25
 5
0
x(10 −2x)dx = 5
3 ≈1.7
and since
E[X2] = 1
25
 5
0
x2(10 −2x)dx = 25
6
we get
Var[X] = 25
6 −25
9 = 25
18 ≈1.4
Since Y = 1.8X + 32, we get
E[Y] = 1.8E[X] + 32 = 35
and
Var[Y] = 1.82Var[X] = 4.5
□
Note how adding the constant b does not affect the variance. This is intuitively clear
since adding b simply shifts the entire distribution, including the mean, b units but
does not affect how X varies around the mean. The following proposition is intuitively
obvious.
Proposition 2.16. Let μ = E[X]. Then Var[X] = 0 if and only if X ≡μ.
In words, if a random variable has variance 0, it must be constant.2 The “if” part
follows immediately from the deﬁnition of variance; the “only if” part turns out to be
trickier, and we leave it for Problem 48.
2Strictly speaking, it must be constant with probability one, but this is a subtle distinction that we need not
worry about.

SPECIAL DISCRETE DISTRIBUTIONS
111
Above we learned how to compute E[g(X)] for an arbitrary function g. To ﬁnd the
variance of g(X), simply use the variance formula applied to g(X), that is
Var[g(X)] = E[g(X)2] −(E[g(X)])2
where E[g(X)] and E[g(X)2] are computed by applying Proposition 2.12 to the func-
tions g(x) and g(x)2, respectively.
Example 2.31. Let X ∼unif[0, 2], and let A = X2, the area of a square with
sidelength X. Find Var[A].
We already know that E[A] = 4
3 and need to ﬁnd E[A2]. Proposition 2.12 gives
E[A2] = E[X4] = 1
2
 2
0
x4dx = 16
5
which gives
Var[A] = E[A2] −(E[A])2 = 16
5 −16
9 = 64
45
□
2.5
SPECIAL DISCRETE DISTRIBUTIONS
In this section, we examine some special discrete distributions. First, the term “dis-
crete” may be used to describe the random variable itself or its distribution. The same
goes for the name of the distribution. For example, if we roll a die, we may say that
“X has a uniform distribution on 1, . . . , 6” or “X is uniform on 1, . . . , 6.”
2.5.1
Indicators
This is the simplest type of discrete random variable. Consider an experiment where
the event A may occur.
Deﬁnition 2.12. Let A be an event. The random variable IA deﬁned by
IA =

1 if A occurs
0 otherwise
is called the indicator of the event A.
This type of random variable is also called a Bernoulli random variable. If the event
A has probability p, the pmf of IA is
p(k) =

p
for k = 1
1 −p for k = 0

112
RANDOM VARIABLES
and the mean and variance are
E[IA]
= 1 × p + 0 × (1 −p) = p
Var[IA] = E[I2
A] −(E[IA])2 = p(1 −p)
since I2
A = IA. Indicators are much more useful than they may seem at ﬁrst glance.
In more advanced treatments of probability theory they function as “building blocks”
that are used to deﬁne random variables and expected values in greater generality
than we have done. We will later see how indicators are also very useful in problem
solving.
2.5.2
The Binomial Distribution
Consider an experiment where we are interested in some particular event A, where
the probability of A is p. Suppose that we repeat the experiment independently n
times and count how many times we get A. Denote this number by X, which is then
a discrete random variable with range 0, 1, . . . , n. What is the pmf of X?
Let us call an occurrence of A a “success” (S) and a nonoccurrence a “failure”
(F). The event {X = k} then means that we have a sequence of k successes and n −k
failures, which can, for example, be
S F S S F · · · F S F
By independence, this particular sequence has probability
p × (1 −p) × p × p × (1 −p) × · · · × (1 −p) × p × (1 −p) = pk(1 −p)n−k
But this is only one possible conﬁguration of k successes and n −k failures, and since
the position for the k Ss can be chosen in
n
k

ways, we get
P(X = k) =
n
k

pk(1 −p)n−k, k = 0, 1, . . . , n
and we give this probability distribution a name.
Deﬁnition 2.13. If X has probability mass function
p(k) =
n
k

pk(1 −p)n−k, k = 0, 1, . . . , n
it is said to have a binomial distribution with parameters n and p, and we write X ∼
bin(n, p).
The binomial distribution thus describes the experiment to count successes in indepen-
dent trials and is deﬁned through its pmf. The parameter p is often called the success

SPECIAL DISCRETE DISTRIBUTIONS
113
0
2
4
6
8
10
0
0.1
0.2
0.3
0
2
4
6
8
10
0
0.1
0.2
0.3
FIGURE 2.9
The pmf’s of two binomial distributions with parameters n = 10, p = 0.5 and
n = 10, p = 0.8, respectively.
probability. In Figure 2.9, a binomial pmf with n = 10 and p = 0.5 and another with
n = 10 and p = 0.8 are plotted. Note how the pmf with p = 0.5 is symmetric, which
for this value of p is the case for any value of n.
Proposition 2.17. If X ∼bin(n, p), then
E[X] = np
and
Var[X] = np(1 −p)
Proof. First note that, by Problem 24(b) in Chapter 1
kp(k) = np
n −1
k −1

pk−1(1 −p)n−k
and we get
E[X] =
n

k=0
kp(k) = np
n

k=1
n −1
k −1

pk−1(1 −p)n−k = np
since the terms in the sum are the probabilities in a binomial distribution with param-
eters n −1, and p and hence the sum equals 1. The proof of the variance formula is
left for Problem 65.
■
Example 2.32. Consider the following two sequences of heads and tails. Only one
of them was obtained by repeatedly ﬂipping a fair coin. Let us call this sequence
“random.” Which one is it? For better readability, we represent heads by X and tails
by O:
X O O X X O O X X X O X O O X X O O X X O O O X O O O O X X
X X O X O X O O X O X O X O X X O O X O X O X X O X O X X O

114
RANDOM VARIABLES
This is, of course, impossible to answer with certainty. The second sequence seems a
little better “mixed,” whereas the ﬁrst has some suspicious occurrences of long runs
of tails at the end, but we need to come up with some more formal way to make a
decision.
Let us try to ﬁgure out which sequence is most unlikely to be random. Since each
particular sequence of heads and tails has the same probability ( 1
2)30, this will not
help us. Let us consider the number of heads. The expected number is 15, and the
sequences have 14 and 16 heads, respectively, so this does not help us, either. Let
us instead consider the number of changes from X to O and vice versa. A count
reveals that the ﬁrst sequence has 14 changes and the second 23. Which is closer to
the expected?
Since each change has probability 1
2, we can denote the number of changes by X
and thus have
X ∼bin

29, 1
2

which has E[X] = 14.5. Thus, the second sequence has far more changes than what
is expected. But how extreme is it? The probability to get a values as large as 23 or
larger, is
P(X ≥23) =
29

k=23
29
k
 1
2
29
≈0.001
which is a very small probability. In other words, only once in 1000 experiments of
30 independent coin ﬂips would we get an outcome this extreme, and we decide that
this sequence is not random.
So, what is the answer? The ﬁrst sequence is random, and the second was
obtained by letting the probability of a change be 0.7. The number of changes is
then bin(29, 0.7), which has expected value 29 × 0.7 = 20.3, and our outcome of 23
is not at all extreme.
That the second sequence looks “better mixed” is precisely why we should not
believe that it is random. Considerations like these are important when testing random
number generators, which use deterministic algorithms to produce numbers that seem
to be random. It is quite typical that people, when asked to write down a random
sequence, are likely to come up with something similar to the second rather than
the ﬁrst sequence. Most human brains are not forgetful enough to be good random
number generators.
□
Example 2.33. Let us revisit Mr Bloggs from Example 1.50 and give an alternative
computation of the probability of his guilt.
Suppose that each person on the island has the genotype with probability p, inde-
pendent of other people. We know that Mr Bloggs has the genotype, so if there
are a total of k people with it, he is guilty with probability 1
k, for k = 1, 2, . . . , n.
Let X be the total number of individuals with the genotype. We already know that

SPECIAL DISCRETE DISTRIBUTIONS
115
Mr Bloggs has the genotype, and among the remaining n −1 individuals, the number
with the genotype should thus be binomial with parameters n −1 and p. Let G be the
event that Mr Bloggs is guilty and condition on the events {X = k}, k = 1, 2, . . . , n
to obtain
P(G) =
n

k=1
P(G|X = k)P(X = k)
=
n

k=1
1
k
n −1
k −1

pk−1(1 −p)n−k = 1 −(1 −p)n
np
after some algebra. In Example 1.50, we found that the probability that he is guilty
is 1/(1 + (n −1)p), which is not the same answer. What is wrong this time? Just as
in the case of the stone-throwing boys from Example 1.51, we forgot to condition on
all the information we have. We know not only that Mr Bloggs has the genotype but
also that the murderer has it and under these two conditions, the proposed binomial
distribution is not correct. What, then, is the distribution of X?
Initially and unconditionally, the number of people on the island with the genotype
is X ∼bin(n, p). Given the event A = {both the murderer and Mr Bloggs have the
genotype}, what is the conditional distribution of X? We can think of observations
on genotypes as sampling with replacement, just as we did in Example 1.52. Thus,
if there are k individuals with the genotype, then the conditional probability of A is
k2/n2, since we have sampled twice and gotten the genotype both times. We can now
apply Bayes’ formula to obtain
P(X = k|A) =
P(A|X = k)P(X = k)
n

j=0
P(A|X = j)P(X = j)
=
k2
n2
n
k

pk(1 −p)n−k
n

j=0
j2
n2
n
j

pj(1 −p)n−j
=
k2
n
k

pk(1 −p)n−k
E[X2]
and the probability that Mr Bloggs is guilty becomes
P(G|A) =
n

k=1
P(G|A ∩{X = k})P(X = k|A)
=
n

k=1
1
k ×
k2
n
k

pk(1 −p)n−k
E[X2]
=
E[X]
E[X2]
=
np
n2p2 + np(1 −p) =
1
1 + (n −1)p

116
RANDOM VARIABLES
where we used the variance formula E[X2] = (E[X])2 + Var[X]. Thus, we got the
same solution as in Example 1.50 once more. The conditional distribution of X we
computed is an example of a size-biased distribution; for more on this topic, see
Problem 32.
□
2.5.3
The Geometric Distribution
Consider again the situation of successive independent trials where the event A occurs
with probability p. This time let X be the number of trials until A ﬁrst occurs. Then X
is discrete with range 1, 2, . . ., and the event {X = k} means that we have the sequence
F F · · · F S
of k −1 failures and success in the kth trial. By independence, this has probability
(1 −p)(1 −p) · · · (1 −p)p = p(1 −p)k−1
and we state the following deﬁnition.
Deﬁnition 2.14. If X has probability mass function
p(k) = p(1 −p)k−1, k = 1, 2, . . .
it is said to have a geometric distribution with parameter p, and we write
X ∼geom(p).
The parameter p is again called the success probability. If we instead count the number
of trials before the ﬁrst occurrence of A and denote this by Y, then Y has pmf
p(k) = p(1 −p)k, k = 0, 1, . . .
The difference is that the range includes 0. We refer to this as a “geometric distribution
including 0” and note thatY = X −1. In Example 2.9, we found the cdf of a geometric
distribution with p = 1
6 by using the deﬁnition of cdf. There is, however, a quicker
way, if we instead consider the probability that X is strictly greater than n. Since this
is equivalent to saying that the ﬁrst n trials resulted in failure, we get
P(X > n) = P(n consecutive failures) = (1 −p)n
which gives the cdf
F(n) = 1 −(1 −p)n, n = 1, 2, . . .
which is also what we got in the special case in the example.
Proposition 2.18. If X ∼geom(p), then
E[X] = 1
p
and
Var[X] = 1 −p
p2

SPECIAL DISCRETE DISTRIBUTIONS
117
Proof. From Proposition 2.9, we get
E[X] =
∞

n=0
P(X > n) =
∞

n=0
(1 −p)n = 1
p
which is certainly quicker than using the deﬁnition directly. We will prove the variance
formula in Section 3.7.4.
■
The expression for the mean makes good sense. In a large number of trials, the
proportion p are successes, and hence they come on average every (1/p)th trial. The
mean in the geometric distribution including 0 is 1/p −1 = (1 −p)/p.
Example 2.34. If you play the Texas Lotto twice a week, how long is your expected
wait to win the jackpot?
According to Example 1.21, the probability to win is 1/47, 784, 352, so your expected
wait is 47, 784, 352 draws or about 459,000 years. Good luck.
□
Example 2.35. The government of a war-torn country decides that the proportion of
males in the population needs to be increased. It therefore declares that families are
allowed to keep having children as long as the newborn babies are boys, but as soon
as they have a daughter, they are not allowed any more children. Will the goal be
achieved?
Consider a family that has no children yet, and let X be the number of children they
will have. With the rule to stop after the ﬁrst daughter, X ∼geom( 1
2), and hence the
expected number of children is 2. Given Y as the number of sons, we have Y = X −1
and hence E[Y] = E[X] −1 = 1, so the expected number of sons is 1, the same as the
expected number of daughters. The suggested policy will not change the long-term
sex ratio. See also Problem 60.
□
2.5.4
The Poisson Distribution
The distribution we investigate in this section is different from those discussed previ-
ously, in the sense that it does not primarily describe a particular experiment. Rather,
it is a distribution that has been observed empirically in many different applications.
Deﬁnition 2.15. If X has probability mass function
p(k) = e−λ λk
k! , k = 0, 1, . . .
it is said to have a Poisson distribution with parameter λ > 0, and we write
X ∼Poi(λ).

118
RANDOM VARIABLES
0
10
20
30
0
10
20
30
FIGURE 2.10
Histogram of Paciﬁc tropical cyclones 1988–2003. (Source: U.S. National
Oceanic and Atmospheric Administration, www.noaa.gov), and pmf of a Poisson distribution
with mean 15. Since we are interested only in the shapes, the scales on the y-axes have been
omitted.
Since we have not derived this expression from any particular experiment, let us ﬁrst
check that it is indeed a pmf according to the two criteria in Proposition 2.1. Clearly
it is nonnegative and by Taylor’s theorem
∞

k=0
λk
k! = eλ
so the p(k) sum to one. The Poisson distribution tends to arise when we count the
number of occurrences of some unpredictable event over a period of time. Typical
examples are earthquakes, car accidents, incoming phone calls, misprints in a newspa-
per, radioactive decay, and hits of a Web site.3 These all have in common the fact that
they are rare on a short timescale but more frequent if we count over a longer period of
time. For some real data, consider Figure 2.10, which is a histogram over the annual
numbers of tropical cyclones (tropical storms or hurricanes) that were formed off the
U.S. Paciﬁc coast during the years 1988–2003. The average number is 15, and we also
plot the pmf of a Poisson distribution with λ = 15 (we will soon see that λ is the mean
in the distribution). With so few observations, we cannot expect the histogram to look
exactly like the pmf, but there is certainly nothing that contradicts the assumption of
a Poisson distribution. Thus, both the physical nature of cyclones (unpredictable, rare
on a short timescale) and actual observations support the assumption.
Example 2.36. Suppose that the annual number of tropical cyclones that are formed
off the U.S. Paciﬁc coast has a Poisson distribution with mean 15. What is the prob-
ability that a given year has at most ﬁve cyclones?
3It would be a shame not to also mention Sim´eon Poisson’s original use of the distribution that would later
bear his name, the classical application to the number of Prussian soldiers annually kicked to death by
their horses in the nineteenth century. The ﬁt to a Poisson distribution is remarkably good (and the term
“success probability” takes on an interesting meaning).

SPECIAL DISCRETE DISTRIBUTIONS
119
Let X be the number of cyclones, so that X ∼Poi(15). The probability of at most 5
cyclones is
P(X ≤5) = e−15

1 + 15 + 152
2! + 153
3! + 154
4! + 155
5!

≈0.003
□
It should be stressed that the events must be not only rare but also random. Compare
the two statements “large asteroids hit Earth every thousand years” and “a millennium
year occurs every thousand years.” The ﬁrst statement is about the average behavior of
a random phenomenon, whereas there is no randomness at all in the second. Even with
randomness, we must make sure that there is “enough” of it. For example, if buses are
supposed to arrive at a bus stop every 10 min, there will be some random variation in
their arrival times. However, since the bus drivers attempt to follow a schedule, there
is too much regularity to assume a Poisson distribution for the number of arriving
buses in a given time interval.
Proposition 2.19. If X ∼Poi(λ), then
E[X] = λ
and
Var[X] = λ
Proof. First note that the pmf satisﬁes the relation
kp(k) = λp(k −1)
for k ≥1, which gives
E[X] =
∞

k=0
kp(k) =
∞

k=1
kp(k) = λ
∞

k=1
p(k −1) = λ
The proof of the variance expression is left for Problem 65.
■
Example 2.37. A microliter of normal human blood contains on average about 7000
white blood cells and 5 million red blood cells, as well as platelets, plasma, and
other matter. In a diluted blood sample, distributed in hundreds of test tubes, it was
observed that about 1% of the test tubes contained no white blood cells. What is the
mean number of white blood cells per test tube?
Since white blood cells are comparatively rare, we assume a Poisson distribution
(and here we are describing events in space rather than time). More speciﬁcally, let
X denote the number of white blood cells in a test tube and assume that X ∼Poi(λ),
and the question is what λ = E[X] equals. That 1% of the tubes had no white blood
cells at all means that we estimate p(0) = P(X = 0) to be 0.01. Since
p(0) = e−λ

120
RANDOM VARIABLES
we get
λ = −log p(0)
which in our case equals −log 0.01 ≈4.6. Hence, the mean is 4.6 white blood cells
per test tube.
□
The Poisson distribution can be used as an approximation to the binomial distribution.
To illustrate why, consider a newspaper page with n letters and assume that each letter
is misprinted with probability p, independent of other letters. The number of misprints
is then binomial with parameters n and p. On the other hand, since n is large and p
is small, we are dealing with a rare and unpredictable event, and this ﬁts the situation
for a Poisson distribution. Since the mean in the binomial distribution is np, we can
argue that the number of misprints is approximately Poi(np). It is also possible to
argue directly that
n
k

pk(1 −p)n−k ≈e−np (np)k
k!
for large n and small p and in Section 4.4, we will state a limit result that warrants
the use of the approximation.
How good is the approximation? One obvious difference between the binomial
and the Poisson distributions is that the former has ﬁnite range {0, 1, . . . , n} and the
latter, inﬁnite range {0, 1, . . .}. This is also reﬂected in the variances, which for the
binomial distribution is np(1 −p) and for the approximating Poisson distribution np,
slightly larger because of the wider range. There are various rules of thumb for when
approximation is allowed, but since this is really a numerical problem, depending on
how many correct decimals we are satisﬁed with, we will not address it here. Let us,
however, point out that the approximation is good enough to be of practical use. In
Figure 2.11, pmfs are plotted for n = 10 and p = 0.1.
0
5
10
15
0
0.1
0.2
0.3
0.4
0
5
10
15
0
0.1
0.2
0.3
0.4
FIGURE 2.11
Pmfs of a binomial distribution with n = 10, p = 0.1 (left) and the approxi-
mating Poisson distribution with λ = 1 (right).

SPECIAL DISCRETE DISTRIBUTIONS
121
2.5.5
The Hypergeometric Distribution
Consider a set of N objects, r of which are of a special type. Suppose that we choose
n objects, without replacement and without regard to order. What is the probability
that we get exactly k of the special objects?
Let X denote the number of special objects that we get. This is a discrete random
variable with range 0, 1, . . . , n, and its pmf is easily found by combinatorial methods.
Deﬁnition 2.16. If X has probability mass function
p(k) =
r
k
N −r
n −k

N
n

, k = 0, 1, . . . , n
it is said to have a hypergeometric distribution with parameters N, r, and n, written
X ∼hypergeom(N, r, n).
The parameters must be such that n ≤r and n −k ≤N −r, which we assume im-
plicitly without spelling it out. In Example 1.22, we had a hypergeometric distribution
with parameters N = 52, r = 13, and n = 5. We next state expressions for the mean
and variance and defer the proof to Section 3.6.2.
Proposition 2.20. If X ∼hypergeom(N, r, n), then
E[X] = nr
N
and
Var[X] = n × N −n
N −1 × r
N

1 −r
N

Now suppose that N is large and r is moderate and let p = r/N, the proportion
of special objects. If n is small relative to N, we would expect that drawing without
replacement would not be very different from drawing with replacement. For example,
if the ﬁrst object drawn is of the special type, the proportion changes from r/N to
(r −1)/(N −1), which is then still approximately equal to p. But drawing with
replacement gives a binomial distribution with success probability p, and we have
argued that the hypergeometric distribution can be approximated by the binomial
distribution for suitable parameter values. Also, compare the means and variances for
the two distributions.
2.5.6
Describing Data Sets
The concepts of mean, variance, and standard deviation that we use to describe random
variables are often used to describe data sets. For example, the mean and standard

122
RANDOM VARIABLES
deviation may be given to describe the performance by a school class on a test or to
summarize a survey of home prices in a neighborhood. Suppose that we have a data
set
D = {x1, x2, . . . , xn}
where the xk are not necessarily different from each other. We then deﬁne the mean
of this set as the arithmetic average
¯x = 1
n
n

k=1
xk
and the variance is deﬁned as4
s2
x = 1
n
n

k=1
(xk −¯x)2
How does this ﬁt into the framework of random variables? If we choose a value X at
random from the data set, then X is a discrete random variable whose range is S, the
set of distinct values in D. The pmf of X is precisely the histogram of the data set:
pX(x) = #{k : xk = x}
n
, x ∈S
The expected value is
μ =

x∈S
xpX(x) =

x∈S
x#{k : xk = x}
n
= 1
n
n

k=1
xk = ¯x
and the variance
σ2 =

x∈S
(x −¯x)2pX(x) = 1
n
n

k=1
(xk −¯x)2 = s2
x
and the standard deviation as usual is the square root of the variance. Thus, we can
describe data sets in a way that is commonly done and view this as a special case of our
theory of random variables and their distributions. Note that ¯x and s2
x change if we add
more data to D, so this corresponds to deﬁning a new random variable. Alternatively,
we could think of X as an ideal random variable over all possible values that could
belong to the data set, in which case X could be either discrete or continuous and
would have unknown mean and variance. We can then view the histogram as an
approximation of the true but unknown pmf or pdf, and ¯x and s2
x as approximations
of the true mean μ and variance σ2. We will return to this view in Chapter 6.
4It is also common to divide by n −1 rather than n, and we will address the reason for this in detail in
Chapter 6.

THE EXPONENTIAL DISTRIBUTION
123
Example 2.38. A survey of salaries at a company with 11 employees gave the fol-
lowing values: D = {30, 30, 30, 30, 30, 40, 40, 60, 70, 150, 220} (1000 dollars per
year). The mean is ¯x = (30 + 30 + · · · + 220)/11 = 66.4 and the variance
s2
x = 1
11
11

k=1
(xk −¯x)2 = 3514
which gives standard deviation s ≈59.3. In this case, there is no more data to be
collected, so the mean and variance are exact. Note that only three salaries are above
the mean and eight below, and merely stating the mean as a summary of the data does
not reveal this fact. We say that the data set is skewed (to the left).
□
Example 2.39. A die was rolled seven times and gave D = {2, 2, 2, 2, 4, 5, 5}. The
mean of this data set is ¯x = (2 + 2 + · · · + 5)/7 = 3.1, and the variance
s2
x = 1
7
7

k=1
(xk −¯x)2 = 1.8
If we choose at random from D and call the number X, the distribution of X is
P(X = 2) = 4
7, P(X = 4) = 1
7, P(X = 5) = 2
7
In this case, it is more natural to think of ¯x and s2
x as approximations to the true mean
and variance, which if the die is fair are 3.5 and 35
12 ≈2.9, respectively. If the die is
rolled repeatedly to increase the data set, the approximations become increasingly
more accurate.
□
2.6
THE EXPONENTIAL DISTRIBUTION
We will introduce several named continuous distributions. In an analogy with the
discrete case, these are deﬁned in terms of the pdf, and we may apply the name to
the distribution or the random variable itself. Also as in the discrete case, there are
essentially two different types of distribution: those that describe a clearly deﬁned
experiment or mathematical model from which we can derive the pdf and those that
have been empirically determined to ﬁt certain types of data sets. We have already
seen one distribution of the ﬁrst category; the uniform distribution describes how to
choose a point at random from an interval. We continue with another distribution in
this category.
Let X be a continuous random variable that denotes the lifetime of something
(e.g., an electronic component) that does not age in the sense that the probability of
functioning yet another time unit does not depend on its current age. We can describe
this in a formula as
P(X > x + y|X > y) = P(X > x)
(2.1)

124
RANDOM VARIABLES
for x, y ≥0. This means that the probability of surviving another x time units does
not depend on how many time units y that the component has survived so far. For the
left-hand side, we get
P(X > x + y|X > y) = P({X > x + y} ∩{X > y})
P(X > y)
= P(X > x + y)
P(X > y)
where the last equality follows since X > x + y ⇒X > y, that is, the event
{X > x + y} is included in the event {X > y}. Hence, if we let
G(x) = P(X > x), x ≥0
we get the equation
G(x + y) = G(x)G(y)
for x, y ≥0. Note that the function G at a point x gives the probability that the
component survives the age x and G is therefore called the survival function. Also
note that G(x) = 1 −F(x) where F is the cdf of X. It can be shown (see Problem 75)
that the only possible solutions to the equation are
(a) G(x) ≡0
(b) G(x) ≡1
(c) G(x) = e−λx
where λ is any constant
From a practical point of view, (a) and (b) are uninteresting. The solution G(x) ≡0
would mean that the component has probability 0 of surviving any time, which means
thatitdoesnotfunctiontobeginwith.Thesolution G(x) ≡1,ontheotherhand,means
that it functions forever. These two solutions also contradict the assumption that X
is a continuous random variable, and we are left with (c) as the only possibility. The
cdf of X is therefore
F(x) = 1 −G(x) = 1 −e−λx,
x ≥0
and by differentiation we get the pdf
f(x) = F′(x) = λe−λx,
x ≥0
For this to be a possible pdf, the constant λ must be strictly positive.
Deﬁnition 2.17. If the pdf of X is
f(x) = λe−λx,
x ≥0
then X is said to have an exponential distribution with parameter λ > 0, written
X ∼exp (λ).

THE EXPONENTIAL DISTRIBUTION
125
In Example 2.10, we thus had an exponential distribution with λ = 0.001. Note how
we started by making one seemingly innocent assumption, that there is no aging and
how this forced on us only one possible form of the pdf. The property in Equation
(2.1) is called the memoryless property. Hence, we have the following result.
Proposition 2.21. A continuous random variable has the memoryless property if
and only if it has an exponential distribution.
It is the shape of the pdf that is connected to the memoryless property, so this property
holds for any value of λ. To investigate the role of λ, we note that larger λ means
that the pdf is higher near 0, which indicates that values of X tend to be smaller. By
computing the expected value, we can see that this is indeed the case.
Proposition 2.22. If X ∼exp (λ), then
E[X] = 1
λ
and
Var[X] = 1
λ2
Proof. Direct computation gives
E[X] =
 ∞
0
xλ e−λxdx = 1
λ
by partial integration. For the variance we need E[X2]:
E[X2] =
 ∞
0
x2λ e−λxdx = 2
λ2
This gives
Var[X] = E[X2] −(E[X])2 = 1
λ2
■
Example 2.40. The technique of carbon 14 dating is based on decay of the isotope
carbon 14 into nitrogen 14. The half-life, that is, the time required for half the atoms
in the sample to decay, of carbon 14 is approximately 5700 years. What is the
expected lifetime of a single carbon 14 atom?
Since lifetimes are random, we need to interpret half-life. If we start with a number n0
of atoms, the half-life h is the time when there are roughly n0/2 atoms left. Thus, half
the atoms have “survived” h, and half have not, which indicates that the probability

126
RANDOM VARIABLES
to survive age h is 1
2. Let T be the lifetime of an individual atom and let h be the
number that satisﬁes
P(T > h) = 1
2
and from Example 2.10 we recognize h as the median lifetime.
Next,weassumethatT hasanexponentialdistribution.Thisiscertainlyreasonable
as an atom decays spontaneously, not as a result of old age or wear and tear. Thus,
T ∼exp(λ), and we get
P(T > 5700) = e−5700λ = 1
2
which gives λ = log 2/5700 and the expected lifetime
E[T] = 1
λ = 5700
log 2 ≈8200 years
We will examine the problem of half-life in radioactive decay more closely in Section
3.10.1.
□
The parameter λ is often referred to as the failure rate or hazard rate and is a measure
of how likely failure is at any given age. It is a natural extension to allow the failure
rate to depend on age and thus deﬁne the failure rate function, a concept to which
we return in Section 2.10. The exponential distribution is characterized by having a
constant failure rate function.
The exponential distribution is also used to model times between random events
such as earthquakes, customer arrivals to a store, or incoming jobs to a computer.
Recall how we previously used the Poisson distribution to model the number of
such events in a ﬁxed time period. There is an interesting connection between the
exponential and the Poisson distributions, which we describe brieﬂy here and return
to address in detail in Section 3.12.
Suppose that events occur in such a way that the time between two events is exp(λ).
Suppose further that the occurrence of an event is independent of the occurrences of
other events. It can then be shown that the number of occurrences in a time interval
of length t is a random variable that has a Poisson distribution with mean λt. Such a
stream of events is called a Poisson process.
Example 2.41. According to the U.S. Geological Survey, earthquakes with magnitude
at least 7 occur on average 18 times a year (worldwide). (a) What is the probability
that two consecutive such earthquakes are at least 2 months apart? (b) What is the
probability that there are no earthquakes in a 2-month period?
Suppose that earthquakes occur according to a Poisson process with rate λ = 1.5
earthquakes per month. Let T be the time between two consecutive earthquakes and

THE NORMAL DISTRIBUTION
127
X the number of earthquakes in a 2-month period. Then we have T ∼exp(1.5) and
X ∼Poi(3) and we get for (a)
P(T > 2) = e−1.5×2 ≈0.05
and for (b)
P(X = 0) = e−3 ≈0.05
Note that the two events {T > 2} and {X = 0} are identical.
□
2.7
THE NORMAL DISTRIBUTION
The next distribution falls into the second category, those who are motivated pri-
marily by empirical observations rather than describing a particular experiment or
mathematical model. Let us ﬁrst deﬁne it.
Deﬁnition 2.18. If X has pdf
f(x) =
1
σ
√
2π
e−(x−μ)2/2σ2, x ∈R
it is said to have a normal distribution with parameters μ and σ2, written
X ∼N(μ, σ2).
This is also often called the Gaussian distribution, after German mathematician Carl
Friedrich Gauss, who used it to describe errors in astronomical measurements. The
typical bell-shaped pdf is shown in Figure 2.12. The normal distribution shows up
naturally in many situations where there are measurement errors or ﬂuctuations due
to randomness, noise, and other factors, and it is the most widely used of all distribu-
tions. It is used in models of signal processing, the velocities of gas molecules, and
the movement of stock market prices. It also arises in the study of many biological
µ
µ
FIGURE 2.12
The pdfs of two normal distributions with the same mean. The one on the left
has higher variance.

128
RANDOM VARIABLES
phenomena, where the randomness is typically composed of different components.
As an example, consider taking the blood pressure of a person. First, there is the
variation that occurs between individuals, which gives rise to randomness due to the
selection of individual. Then there is variation over time within each individual, and
ﬁnally there is uncertainty in the actual measuring procedure.
Note that the pdf is symmetric around μ. By computing the usual integrals, it is
easily shown that
Proposition 2.23. If X ∼N(μ, σ2), then E[X] = μ and Var[X] = σ2.
A word of caution regarding notation is due here. We have chosen to give σ2 as the
second parameter, so that if we write N(0, 4), we mean that the variance is 4 (and the
standard deviation 2). Some texts prefer to give the standard deviation as the second
parameter, as does, for example, Matlab, so you need to pay attention.
Since we cannot ﬁnd a primitive function of the pdf, there is no hope of an explicit
expression for the cdf, and it must be computed numerically. The normal distribution
with μ = 0 and σ2 = 1 is of particular interest and is called the standard normal dis-
tribution. For the standard normal distribution, we use the following special notation
for the pdf and cdf:
ϕ(x) =
1
√
2π
e−x2/2, x ∈R
(x) =
 x
−∞
ϕ(t)dt, x ∈R
The signiﬁcance of the standard normal distribution is spelled out in the next propo-
sition.
Proposition 2.24.
Suppose that X ∼N(μ, σ2) and let Z = (X −μ)/σ. Then
Z ∼N(0, 1).
Proof. Let FZ denote the cdf of Z. Then
FZ(x) = P(Z ≤x) = P(X ≤μ + σx) =
 μ+σx
−∞
1
σ
√
2π
e−(t−μ)2/2σ2dt
Making the variable substitution y = (t −μ)/σ gives dt = σdy, and the new integral
limits −∞and x and the expression equals
 x
−∞
1
σ
√
2π
e−(σy+μ−μ)2/2σ2σdy =
 x
−∞
ϕ(y)dy = (x)
■

THE NORMAL DISTRIBUTION
129
Hence,anynormal distributioncanbebroughtbackto thestandard normaldistribution
bysubtractingthemeananddividingbythestandarddeviation,aproceduresometimes
referred to as computing the Z score of X. We state in a corollary how this is used in
computations.
Corollary 2.3. Let X ∼N(μ, σ2). For any x, a, b ∈R, we have
(a) P(X ≤x) = 
x −μ
σ

(b) P(a ≤X ≤b) = 
b −μ
σ

−
a −μ
σ

Proof. (a) If X ∼N(μ, σ2), then
P(X ≤x) = P
X −μ
σ
≤x −μ
σ

= 
x −μ
σ

where the ﬁrst equality holds since we subtracted and divided by the same quantities
on both sides of the inequality in the probability statement, where σ > 0, thus not
changing the inequality. The second equality holds by Proposition 2.24. Part (b) is
true because of Proposition 2.4(a).
■
By Corollary 2.3, we have to compute only the cdf of the standard normal distribution,
and Table A.1 gives numerical values of (x). Note that only values for positive x
are given; for negative x, we use the following result.
Corollary 2.4. For any x ∈R
(−x) = 1 −(x)
Proof. Note that ϕ is symmetric around 0, which gives
(−x) =
 −x
−∞
ϕ(t)dt =
 ∞
x
ϕ(t)dt = 1 −(x)
■
Another immediate consequence of Proposition 2.24 is that a linear transformation
of a normal distribution is normal, in the following sense.
Corollary 2.5. Let X ∼N(μ, σ2), let a, b ∈R, and let Y = aX + b. Then
Y ∼N(aμ + b, a2σ2)

130
RANDOM VARIABLES
Proof. Let us do the case a > 0. Start with the cdf of Y.
P(Y ≤x) = P(aX + b ≤x) = P

X ≤x −b
a

= 
(x −b)/a −μ
σ

= 
x −(aμ + b)
aσ

which is precisely the cdf of a random variable, which is N(aμ + b, a2σ2). The case
a < 0 is similar.
■
Let us look at a few examples.
Example 2.42. The IQ of a randomly selected individual is often supposed to follow
a normal distribution with mean 100 and standard deviation 15. Find the probability
that an individual has an IQ (a) above 140 and (b) between 120 and 130, and (c) ﬁnd
a value x such that 99% of the population has IQ at least x.
We have X ∼N(100, 152) and get for (a)
P(X > 140) = 1 −P(X ≤140) = 1 −
140 −100
15

= 1 −(2.67) ≈0.004
For (b), we get
P(120 ≤X ≤130) = 
130 −100
15

−
120 −100
15

= (2) −(1.33) ≈0.07.
For the last part, we need to ﬁnd x such that P(X > x) = 0.99. By Corollary 2.4
we get
P(X > x) = 1 −
x −100
15

= 
100 −x
15

= 0.99
and Table A.2 gives
100 −x
15
= 2.33
which gives x ≈65. The value x is called the 99th percentile.
□
Example 2.43. A power source gives an output voltage of 12 (volts). Because of
random ﬂuctuations, the true voltage at any given time is V = 12 + X, where
X ∼N(0, 0.1). The voltage is measured once an hour, and if it is outside the interval

OTHER DISTRIBUTIONS
131
[11.5, 12.5] the power source needs to be adjusted. What is the probability that no
adjustment is needed during a 24 h period?
Let us ﬁrst note that by Corollary 2.5, V ∼N(12, 0.1). At any given hour, the prob-
ability that the voltage is within bounds is
P(11.5 ≤V ≤12.5) = 
11.5 −12
√
0.1

−
12.5 −12
√
0.1

≈(1.58) −(−1.58) = 2(1.58) −1 ≈0.89
and hence the probability that it is out of bounds is 0.11. Now consider the experiment
to check the voltage every hour for 24 h. Assuming that hours are independent, the
number of hours that has the voltage out of bounds is a binomial random variable with
n = 24 and p = 0.11. Call this number Y to obtain the probability that no adjustment
is needed as
P(Y = 0) = (1 −0.11)24 ≈0.06
□
For values of x larger than those in Table A.1, the approximation
(x) ≈1 −ϕ(x)
x
can be used. See Problems 89 and 90.
2.8
OTHER DISTRIBUTIONS
So far we have seen the uniform, exponential, and normal distributions as examples
of continuous distributions. In this section, we list a number of other continuous
distributions, as well as some of their properties. We will also encounter a type of
random variable that is neither discrete nor continuous.
2.8.1
The Lognormal Distribution
Sometimes, observations do not follow a normal distribution but their logarithms do.
This may simply be an empirically observed fact but can also be argued theoretically.
The normal distribution arises in situations such as those mentioned in the previous
section because the randomness has an additive effect. It may instead be the case that
randomness has a multiplicative effect. This is true in many applications in science
and engineering, for example, reliability and material fatigue analysis, and also in
models for ﬁnancial markets where it is more realistic to model a price change by
multiplying by a percentage than to add a dollar amount.

132
RANDOM VARIABLES
Deﬁnition 2.19. Let X ∼N(μ, σ2) and let Y = eX. Then Y is said to have a log-
normal distribution with parameters μ and σ2.
For practical reasons, this time we deviated from our usual convention of deﬁning a
continuous distribution in terms of its pdf. The reason is that we can always compute
probabilities in the lognormal distribution by referring to the normal distribution. We
leave it as an exercise to show the following.
Corollary 2.6. Let Y be lognormal with parameters μ and σ2. Then Y has pdf
fY(x) =
1
xσ
√
2π
e(log x−μ)2/2σ2,
x > 0
Note that the parameters μ and σ2 are the mean and variance of the underlying normal
random variable X, not of the lognormal random variable Y. By computing the usual
integrals, it can be shown that the mean and variance are
E[Y] = eμ+σ2/2
and
Var[Y] = e2μ+σ2 
eσ2 −1

Example 2.44. Suppose that the price Y of a particular stock at closing has a log-
normal distribution with E[Y] = 20 dollars and Var[Y] = 4. What is the probability
that the price exceeds $22?
First we need to ﬁnd μ and σ. By the expressions above we have
eμ+σ2/2 = 20
and
e2μ+σ2 
eσ2 −1

= 4
where the ﬁrst equation gives
μ + σ2
2 = log 20
which we substitute in the second equation to get
e2 log 20 
eσ2 −1

= 4
which gives
σ2 = log(1.01) ≈0.01

OTHER DISTRIBUTIONS
133
and
μ = log 20 −log 1.01
2
≈3.0
Finally, since log Y is normal, we get
P(Y > 22) = 1 −P(Y ≤22) = 1 −P(log Y ≤log 22)
= 1 −
log 22 −3.0
√
0.01

≈0.18.
□
2.8.2
The Gamma Distribution
The gamma distribution is ﬂexible, ﬁts many different types of real-world data sets,
and can be used as an alternative to the normal distribution when data are nonnegative
and not exactly symmetric. Before we deﬁne the gamma distribution, let us introduce
the gamma function, which is deﬁned as
(α) =
 ∞
0
e−ttα−1dt
If α is a positive integer, n, this reduces to
(n) = (n −1)!
so the gamma function can be regarded as an extension of the factorial to the entire
real line. We are now ready to deﬁne the gamma distribution.
Deﬁnition 2.20. If X has pdf
f(x) = e−λxλα xα−1
(α) , x ≥0
it is said to have a gamma distribution with parameters α > 0 and λ > 0, written
X ∼(α, λ).
Note that α = 1 gives the exponential distribution with parameter λ. The parameter α
is called the shape parameter and λ is called the scale parameter. Figure 2.13 gives
the pdfs for three gamma distributions with λ = 1 and different values of α. Notice
how the shape changes with the value of α; as α increases, it increasingly resembles
the normal distribution. Changing the parameter λ corresponds to changing the unit

134
RANDOM VARIABLES
0
2
4
6
8
10
α=2
α=3 
α=5 
FIGURE 2.13
Pdfs of the gamma distribution with ﬁxed λ and different values of α. Note
the increasing resemblance to the pdf of a normal distribution.
of measure and does not affect the shape qualitatively (see Problem 95). In particular,
if α is an integer, n, we get the pdf
f(x) = e−λxλn
xn−1
(n −1)!, x ≥0
This has an interpretation to which we will return in Section 3.10.5. In this case, we
can get an explicit expression for the cdf as
F(x) = 1 −e−λx
n−1

k=0
λkxk
k! , x ≥0
which can be shown by partial integration and induction. By computing the usual
integrals and using some special properties of the gamma function, it can be shown
that
E[X] = α
λ
and
Var[X] = α
λ2
In Section 3.6.2, we will show this for the integer case α = n.
2.8.3
The Cauchy Distribution
We ﬁnish with a distribution that does not have much practical use. It is, however,
derived from an easily described experiment and turns out to have some interesting
properties, which makes it a favorite in various counterexamples in the probability
and statistics literature.

OTHER DISTRIBUTIONS
135
x
X
y
1
Θ
FIGURE 2.14
If 
 is chosen at random between −π/2 and π/2, X has the Cauchy
distribution.
In an ordinary coordinate system, start at the point (0, 1), choose an angle between
−π/2 and π/2 at random and at this angle draw a line to the x-axis (the angle 0 gives
a line to the origin). Let X be the point where you hit the x-axis (Figure 2.14). The
range of X is (−∞, ∞) and we next ﬁnd the pdf of X. Denote the angle by 
 and
assume that 
 ∼unif(−π/2, π/2). Then X = tan 
 and has cdf
FX(x) = P(tan 
 ≤x) = P(
 ≤tan−1 x)
= F
(tan−1 x) = tan−1 x + π/2
π
, x ∈R
Differentiation gives
fX(x) = F′
X(x) =
1
π(1 + x2), x ∈R
This is called the Cauchy distribution. Something interesting happens when we
attempt to compute its expected value:
E[X] = 1
π
 ∞
−∞
x
1 + x2 dx =
1
2π
	
log(1 + x2)

∞
−∞
This is not well deﬁned since it is of the form “∞−∞.” In this case, we say that
the expected value does not exist. If the experiment were to be repeated over and
over and consecutive averages computed, these would not converge but keep jumping
around the x-axis forever, which is somewhat surprising since the pdf is symmetric
around 0.
2.8.4
Mixed Distributions
The distinction between discrete and continuous random variables is fundamental but
not exhaustive. There are random variables that belong to neither of the two categories,
as the following example shows.

136
RANDOM VARIABLES
2
4
0 
 0.2 
0.4 
0.6 
0.8 
1 
0
FIGURE 2.15
The cdf of a mixed distribution with a discrete part at 0 and a continuous part
on (0, ∞).
Example 2.45. Jobs arrive at a computer. With probability 0.8, the computer is busy
and the incoming job must wait in queue for a time (in seconds), which has an
exponential distribution with parameter 1. Let X be the waiting time for an incoming
job and ﬁnd the cdf of X.
The crux here is that the waiting time is 0 if the computer is free and has an exponential
distribution otherwise. Let B be the event that the computer is free and ﬁx an x ≥0.
The law of total probability gives
P(X ≤x) = P(X ≤x|B)P(B) + P(X ≤x|Bc)P(Bc)
where P(X ≤x|B) = 1 and P(X ≤x|Bc) = 1 −e−x. Since P(B) = 0.2 and
P(Bc) = 0.8, the cdf becomes
F(x) = 1 −0.8e−x,
x ≥0
The cdf is shown in Figure 2.15. Clearly, the range is uncountable, so this is not a
discrete distribution. On the other hand, since the cdf has a discontinuity at 0, it is not
a continuous distribution either. This is an example of a mixed distribution (and X is
called a mixed random variable) that has a discrete part at 0 and a continuous part on
(0, ∞).
□
Let us conclude this section by mentioning that there are even stranger creatures in the
world of probability, namely, distributions that are neither discrete nor continuous, nor
a mixture of the two. These so-called singular distributions are strange mathematical
constructions and of no use in any of the applications we consider.

LOCATION PARAMETERS
137
2.9
LOCATION PARAMETERS
The mean is not the only possible location parameter and in some cases may not be
the best choice. For example, in Problem 40, we learn that if X ∼unif(0, 1), then
E[1/X] = ∞. Since we always get ﬁnite values of 1/X, the mean may not be the
best way to summarize the distribution. Another location parameter is the median,
which can be considered the midpoint of the distribution in the sense that, on average,
half the observations fall below and half above it. We state the formal deﬁnition.
Deﬁnition 2.21. Let X be a random variable. Any number m that is such that
P(X ≥m) ≥1
2
and
P(X ≤m) ≥1
2
is called a median of X.
Note that the median is not necessarily unique. For example, if X is the number when
we roll a fair die, both 3 and 4 are medians, as are all numbers in-between. If the
distribution is continuous with cdf F, a median always satisﬁes F(m) = 1
2, and if
the range of X does not have any “holes,” the median is also unique. We state the
following result without proof.
Corollary 2.7. Let X be a continuous random variable with pdf f and cdf F,
such that f is strictly positive in an entire interval (a, b) and 0 otherwise, where
−∞≤a < b ≤∞. Then the median m is the unique number that satisﬁes
F(m) = 1
2
The mean is thus the average and the median the midpoint of a distribution. If X is
continuous with a unique median and its pdf is symmetric around μ, then the mean
and median are equal.
Example 2.46. Consider the random variable Y = 1/X, where X ∼unif(0, 1). What
is the median of Y?
We need to ﬁnd the cdf of Y. Take y > 1 to obtain
FY(y) = P(Y ≤y) = P

X ≥1
y

= 1 −FX
1
y

= 1 −1
y, y > 1.

138
RANDOM VARIABLES
Solving the equation FY(m) = 1
2 gives the median m = 2. On average, half the
observations are less than 2 and half are larger. Values that are larger have a good
chance to be much larger, in fact so much that the mean is inﬁnite.
□
For a data set, the median is deﬁned as the value that is in the middle. If the number of
observations is even, it is the average of the two middle values (note that the median
for a data set is always unique). Consider the following example.
Example 2.47. A survey of salaries at a small company with 11 employees gives
the following values: 30, 30, 30, 30, 30, 40, 40, 60, 70, 150, 220 (×1000 dollars per
year). This gives a mean salary of 66, 364 and a median of 40, 000 dollars per year. If
the manager doubles his salary from 220, 000 to 440, 000, the mean goes up to over
86, 000, whereas the median stays the same. It is probably fair to say that the median
better represents the data set.
□
The distribution in the example is skewed, and in such a case it is common to give the
median instead of the mean. Also note how the median is less sensitive to extreme
values; it does not change with the manager’s doubled salary, whereas the mean
increases signiﬁcantly. Yet another location parameter is the following.
Deﬁnition 2.22. Let X be a random variable with pmf or pdf f. Any number xm
with the property
f(xm) ≥f(x) for all x ∈R
is called a mode of X.
Whereas the mean is the average and the median the midpoint, the interpretation of
the mode is that it is the most likely value of X. It need not be unique in either the
discrete or continuous case. For example, for a uniform distribution, any number in
the range is a mode. We can also deﬁne local modes, which have the property that the
pdf or pmf has a local but not necessarily global maximum. Depending on the number
of such local modes, distributions can be classiﬁed as unimodal, bimodal, and so on.
For example, the pdf in Figure 2.5 is bimodal.
Example 2.48. Let X ∼exp(λ). Find the mean, median, and mode of X.
We already know that the mean is μ = 1/λ. For the median, we need to solve the
equation
1 −e−λm = 1
2
which gives
m = log 2
λ
≈0.69μ

THE FAILURE RATE FUNCTION
139
which means that the median is smaller than the mean for the exponential distribution.
The intuition behind this is that the range above the mean is inﬁnite and large values
tend to push the average up. This distribution is said to be skewed to the right. The
mode xm is the x value that maximizes the pdf
f(x) = λe−λx, x ≥0
which gives xm = 0. It seems strange that 0 is the “most likely value,” but since this is
a continuous distribution, we need to think of the mode as the value that observations
are most likely to be near, not exactly equal to.
□
For a data set, the mode is simply the most frequent value, which may not be unique.
Example 2.49. In the example of salaries above, the mode is 30, 000, the “typical”
salary for an employee. Like the median, it does not change with the manager’s
doubled salary.
□
2.10
THE FAILURE RATE FUNCTION
In this section we study nonnegative, continuous random variables, with the interpre-
tation that they are lifetimes of some object. We use the notation T for “time” rather
than X, and the argument of cdfs and pdfs is t.
Deﬁnition 2.23. Let T be a random variable with cdf F and pdf f. The failure rate
function is deﬁned as
r(t) =
f(t)
1 −F(t),
t ≥0
Some alternative terms for r(t) are hazard rate function and death rate function. The
interpretation of r(t) is that it is a measure of how likely failure is at time t of an object
that is already t time units old. Compare this with the pdf f(t), which is a measure of
how likely failure is at t of a brand new object. Hence, the failure rate is a conditional
measure of failure and the pdf an unconditional such measure.
This is easier to understand if we instead think of a discrete case. Consider a human
lifespan measured in years, and let t = 100 years. The pmf p(100) is the probability
that a newborn individual dies at age 100, which is pretty low. The failure rate r(100),
on the other hand, is the conditional probability that an individual who is already 100

140
RANDOM VARIABLES
dies before turning 101, which is much higher. With L denoting lifespan, we thus
have
p(100) = P(L = 100)
r(100) = P(L = 100|L ≥100)
Indeed, as t gets large, we have p(t) going to 0 but r(t) going to 1. As we discussed in
Example 1.3, it is convenient to model lifetimes as continuous, even though we always
have a discrete timescale in practice. We will therefore treat only the continuous case,
but see Problem 107 for more on the discrete failure rate function.
Example 2.50. Let T ∼exp(λ). Find the failure rate function of T.
From the deﬁnition, we get
r(t) =
f(t)
1 −F(t) =
λe−λt
1 −(1 −e−λt) = λ, t ≥0
so the exponential function has constant failure rate. This was to be expected since
we introduced the exponential distribution as the lifetime of something that does not
age.
□
Example 2.51. Let T ∼(2, 1). Find the failure rate function of T.
From Section 2.8.2, we have
f(t) = e−tt, t ≥0
and
F(t) = 1 −(1 + t)e−t, t ≥0
which gives the failure rate function
r(t) =
f(t)
1 −F(t) =
t
1 + t , t ≥0
□
Note how r(t) in Example 2.51 is an increasing function of t. This means that failure
becomes more and more likely with time; that is, unlike the exponential distribution,
aging is present. This is an example of a distribution with increasing failure rate
(IFR). We could also imagine that aging is beneﬁcial so that failure is most likely
early on, and becomes less likely as time passes. This is the case of decreasing failure
rate (DFR). Constant failure rate is appropriately labeled CFR.
In reality, most failure rate functions are combinations. Consider, for example, a
human life. There is certainly an elevated risk of death both at and shortly after birth.
After a couple of years, the risk of death is fairly constant, mainly due to accidents
and other unpredictable causes. Then aging starts to kick in (around the time you start

THE FAILURE RATE FUNCTION
141
Age
Failure rate
Age
(a)
(b)
Failure rate
IFR 
DFR 
CFR 
FIGURE 2.16
Different types of failure rate functions: (a) decreasing, constant, and increas-
ing; (b) bathtub-shaped.
college), and the risk of dying starts to increase. This is typically true for mechanical
objects as well. First, there is a certain “break-in” period during which, for example,
manufacturing errors may cause failure. After this is over, there is a period of fairly
constant failure rate, and after a while material fatigue starts to have an impact, thus
causing the failure rate to increase. Such failure rate functions are said to be “bathtub-
shaped,” as shown in Figure 2.16.
When the standards of living in different countries are compared, one summary
statistic that is often given is the life expectancy. In our terms, this is the expected
value of the lifetime of a newborn individual, and it varies greatly between ﬁrst world
and third world countries. For example, life expectancy in Japan is 81 years, and in
Angola, only 37 years. What does this mean? Are there no old people in Angola? One
important explanatory factor is the infant mortality, measured in deaths per thousand
live births, or in our terminology, the probability that a newborn child survives. In
Japan this number is 3.3 and in Angola 193.8! Thus, the probability that a newborn
Angolan does not survive its ﬁrst year is almost 0.2, and this brings the expected
lifetime down signiﬁcantly. Instead of just comparing the expected lifetimes, we can
compare the failure rate functions, which would be more informative, and we would
then notice a large gap in the beginning, corresponding to infant mortality.
If we still want a single number to describe lifetime, rather than the entire failure
rate function, it might be more appropriate to use the median from Section 2.9 since
this is less sensitive to a skewed distribution. We discussed human lifespans above,
but the same problems are present in any kind of lifetime analysis, or, as it is more
commonly termed, survival analysis.
2.10.1
Uniqueness of the Failure Rate Function
As we will soon see, the failure rate function uniquely determines the distribution.
This is convenient, since when we model lifetimes, it is much easier to ﬁgure out
what the failure rate function should look like, than it is to describe the cdf or pdf.

142
RANDOM VARIABLES
For example, the bathtub shape shown in Figure 2.16b makes perfect sense, but it is
not easy to ﬁgure out what this means for the pdf or cdf.
When lifetimes are studied, it is often convenient to consider the probability that T
is greater than t instead of less than t. We therefore introduce the following function.
Deﬁnition 2.24. Let T be a nonnegative, continuous random variable with cdf F.
The function
G(t) = 1 −F(t), t ≥0
is called the survival function of T.
Thus, the survival function is decreasing with G(0) = 1 and G(∞) = 0. In terms of
G, the failure rate function is
r(t) = f(t)
G(t)
and we have the following relation.
Proposition 2.25. Let T be a nonnegative, continuous random variable with failure
rate function r. Then T has survival function
G(t) = exp

−
 t
0
r(u)du

,
t ≥0
Proof. First note that
r(u) =
f(u)
1 −F(u) = −d
du log(1 −F(u))
and integrate both sides to obtain
 t
0
r(u)du = −log(1 −F(t)) = −log G(t)
which gives
G(t) = exp

−
 t
0
r(u)du

and we are done. We have implicitly used the boundary condition F(0) = 0, which
always holds for a nonnegative continuous random variable.
■
Example 2.52. In the late 1990s, it was reported that ﬂu shots cut the death rate by half
among elderly people in the United States and Canada. Suppose that an unvaccinated
70-year-old person has probability 0.8 to survive another 10 years. How much (in
percent) does this probability increase for a vaccinated person?

THE FAILURE RATE FUNCTION
143
Denote the lifespan for an unvaccinated person by U and a vaccinated person by
V. Denote the corresponding failure rate functions and cdfs by rU, rV and FU, FV ,
respectively. Hence, rU(t) = 2 rV (t), and the desired probability is
P(V > 80|V > 70) = P(V > 80)
P(V > 70)
= exp

−
 80
0
rV (u)du
 
exp

−
 70
0
rV (u)du

= exp

−
 80
70
rV (u)du

= exp

−1
2
 80
70
rU(u)du

=

P(U > 80|U > 70) =
√
0.8 ≈0.894
which constitutes a 12% increase in the 10-year survival probability.
□
Example 2.53. Consider a certain type of ball bearing that wears down gradually
at a slow but steady rate. To model this, we suppose that its failure rate function is
linearly increasing, r(t) = at for some a > 0. It has been observed that the median
lifetime is 3 years. What is the probability that such a ball bearing lasts for more than
4 years?
Let T be the lifetime. Then T has survival function
G(t) = exp

−
 t
0
au du

= exp

−at2
2

and since the median m = 3 satisﬁes G(3) = 1
2, we get exp(−9a/2) = 1
2, which gives
a = 2 log 2/9 and
P(T > 4) = exp

−2 log 2 × 42
18

≈0.29
□
If we differentiate F(t) = 1 −G(t) in the previous example, we get the pdf
f(t) = ate−at2/2, x ≥0
which is a special case of the following distribution.
Deﬁnition 2.25. If T has pdf
f(t) = λα tα−1e−λtα, t ≥0
it is said to have a Weibull distribution with parameters α > 0 and λ > 0.

144
RANDOM VARIABLES
The parameter α is called the shape parameter and λ, the scale parameter. In the
example, we had λ = a/2 and α = 2. The cdf of the Weibull distribution is
F(t) = 1 −e−λtα, t ≥0
and the failure rate function
r(t) = λα tα−1, t ≥0
Thus, by choosing different values of α we can model increasing failure rate (α > 1),
decreasing failure rate (α < 1), or constant failure rate (α = 1, exponential distribu-
tion). This makes the Weibull distribution one of the most commonly used distri-
butions for lifetime modeling. Note how α determines the shape of the failure rate
function, and how the other parameter, λ, can be varied to change the scale, for
example, to change between different units of measure.
Example 2.54. Let T ∼unif[0, 1]. Find the failure rate function of T.
This is straightforward. Since f(t) = 1 and F(t) = t, we get
r(t) =
1
1 −t , 0 ≤t ≤1
where we notice that r(t) →∞as t approaches 1. If we think of this as a lifetime
distribution, then failure will always occur before age 1. Thus, as the age approaches
1, failure becomes more and more likely, which is reﬂected in the failure rate going
to inﬁnity. Compare with the argument for human lifespans in the introduction, but
remember that r(t) is now a rate and not a probability.
□
PROBLEMS
Section 2.2. Discrete Random Variables
1. The discrete random variable X has cdf F that is such that F(x) = 0, x < 1,
F(x) = 1
3, 1 ≤x < 3, and F(x) = 1, x ≥3. Find (a) F(2), (b) P(X > 1),
(c) P(X = 2), and (d) P(X = 3).
2. The discrete random variable X has cdf
F(x) =
⎧
⎪
⎪
⎪
⎪
⎨
⎪
⎪
⎪
⎪
⎩
0
for x < 1
1/4 for 1 ≤x < 2
3/4 for 2 ≤x < 3
1
for x ≥3
Find (a) P(X = 1), (b ) P(X = 2), (c) P(X = 2.5), and (d) P(X ≤2.5)

PROBLEMS
145
3. Roll two dice and ﬁnd the pmf of X if X is (a) the smallest number and (b) the
difference between the largest and the smallest numbers.
4. The random variable X has pmf p(k) = ck, k = 1, 2, 3. Find (a) the constant
c, (b) the cdf F, (c) P(X ≤2), and (d) P(X > 1).
5. The random variable X has pmf p(k) = c/2k, k = 0, 1, . . . Find (a) the constant
c, (b) P(X > 0), and (c) the probability that X is even.
6. Five cards are drawn at random from a deck of cards. Let X be the number
of aces. Find the pmf of X if the cards are drawn (a) with replacement and
(b) without replacement.
7. A fair coin is ﬂipped twice. Let X be the number of heads minus the number of
tails. Find the pmf and sketch the cdf of X.
8. Cards are drawn one by one at random from a deck of cards. Let X be the
number of draws needed to draw the ace of spades. Find the pmf of X if we
draw (a) with replacement and (b) without replacement.
9. Let the random variable X have pmf p(k) = 1/2k, k = 1, 2, . . ., and let
Y = 1/X. Find the cdf of Y.
Section 2.3. Continuous Random Variables
10. Let X and Y be nonnegative random variables with the same cdf F. Show that,
for any x ≥0
1 −2F(x) ≤P(X + Y > 2x) ≤2(1 −F(x))
Hint: Problem 13, Chapter 1.
11. The concept of a random variable can be extended to allow for inﬁnite values
as was mentioned in the text following Proposition 2.3. Suppose that X is a
nonnegativerandomvariablesuchthat P(X = ∞) = p > 0. Show thatF(x) →
1 −p as x →∞.
12. Let f be the pdf of a continuous random variable X. Is it always true that
f(x) ≤1 for all x in the range of X? Does it have to be true for some x in the
range of X?
13. The function f is deﬁned as f(x) = cx2, 0 ≤x ≤1. (a) Determine the constant
c so that this becomes a pdf of a random variable X. (b) Find the cdf and compute
P(X > 0.5). (c) Let Y =
√
X and ﬁnd the pdf of Y.
14. Which of the following functions are possible pdfs for continuous random
variables? For those that are, also ﬁnd the cdf.
(a) f(x) = |x|, −1 ≤x ≤1
(b) f(x) = 3
2(x2 −1), 0 ≤x ≤2
(c) f(x) = 1, −1 ≤x ≤0
(d) f(x) = 1/x2, x ≥1.
15. Consider the function f(x) = ax + b, 0 ≤x ≤1. For which values of a and b
is this a possible pdf for a continuous random variable?
16. The random variable X has pdf f(x) = 1/x3, x ≥a. Find (a) the value of a,
(b) P(X > 3), and (c) a value x such that P(X > x) = 1
4.

146
RANDOM VARIABLES
17. Suppose that the rate of growth of striped bass (Morone saxatilis) is constant
between the ages of 5 and 15 years. Let A be the age and W the weight in
pounds of a randomly sampled bass from this age interval, and suppose that
W = 2A + 3. Let the pdf of A be
fA(x) = a(20 −x), 5 ≤x ≤15
Find (a) the constant a and (b) the pdf of W.
18. The continuous random variable X has pdf
f(x) =

1/2
if 0 < x ≤1
1/(2x2) if x ≥1
(a) Show that this is a possible pdf of a continuous random variable. (b) Find
the cdf of X and sketch its graph. (c) Let Y = 1/X. Find the pdf of Y.
19. Let X ∼unif(0, 1). What is the distribution of 1 −X?
20. Let X ∼unif(0, 1). Find the pdfs and sketch their graphs of the following
random variables (be careful with the ranges): (a) Y = 1/X, (b) Y = 1/
√
X,
and (c) Y = log X.
21. Let X have pdf f(x) = e−x, x ≥0. Find the pdf of e−X. What is this distribution
called?
22. Let X have pdf f(x) = e−x, x ≥0, and let Y =
√
X. Find the pdf of Y.
23. We have seen that if X is continuous and g is a function, g(X) can be discrete.
Is it possible to have discrete X and continuous g(X)?
Section 2.4. Expected Value and Variance
24. Roll two dice and ﬁnd E[X] if X is (a) the smallest number and (b) the difference
between the largest and the smallest numbers.
25. (a) Consider a randomly chosen family with three children. What is the expected
number of daughters?(b)Considerarandomlychosen girlwho has two siblings.
What is her expected number of sisters? (Recall Example 1.14.)
26. Draw three cards without replacement from a deck of cards and let X be the
number of spades drawn. Find E[X].
27. One hundred people are to have their blood drawn to be tested for a disease.
Instead of immediately analyzing each individual sample, a pooled sample of
all individuals is analyzed ﬁrst. If the pooled sample is negative, everybody
is declared healthy; if it is positive, each individual blood sample is analyzed.
Suppose that individuals have the disease with probability p, independent of
each other. Let X be the number of blood sample analyses that are done; ﬁnd
E[X] and for which value of p this is ≤100.
28. In a “street bet” in roulette you bet on three numbers. If any of these come up,
you win 11 times your wager, otherwise lose your wager. Let X be your gain if
you bet one dollar on a street bet. Find the mean and variance of X.

PROBLEMS
147
29. In a “ﬁve number bet” in roulette, you win if any of the numbers 00, 0, 1, 2, or
3 comes up. (a) In order to get the usual expected gain of −2/38, what should
the payout be if you wager a dollar? (b) The actual payout on this bet is 6:1.
What is your expected gain?
30. The game of chuck-a-luck is played with three dice, rolled independently. You
bet one dollar on one of the numbers 1 through 6 and if exactly k of the dice show
your number, you win k dollars k = 1, 2, 3 (and keep your wagered dollar). If
no die shows your number, you lose your wagered dollar. What is your expected
loss?
31. You are given two envelopes containing money and are told that one contains
twice as much as the other. You choose one at random, open it, and ﬁnd $100.
You are now given the options to either keep the money or switch to the other
envelope and take what is inside. Since you chose at random, you ﬁgure that the
other envelope with equal probabilities contains $50 or $200. If you switch and
it contains $50, you lose $50 and if it contains $200, you gain $100. Since the
average of −50 and 100 is 25, you ﬁgure that your expected gain is positive and
that it makes sense to switch. Now you realize that you would reach the same
conclusion regardless of the amount you found in the ﬁrst envelope, so you did
not even have to open it, just take it and immediately switch to the other. So,
you might as well just pick the other envelope to start with. But then, by the
same argument, you should switch to the ﬁrst! This obviously does not make
any sense. Where is the error?
32. In the island problem in Example 1.50, let X be the number of individuals
on the island with the genotype, let pk = P(X = k), k = 0, 1, . . . , n, and let
μ = E[X]. (a) Suppose that we know that the murderer has the genotype. Show
that the conditional distribution of X given this fact is given by
pk = kpk
μ , k = 0, 1, . . . , n
and explain why this is called a size-biased distribution. (b) Suppose that we
have an old report stating that an islander has the genotype but that the name
has been erased, and that we also ﬁnd out that Mr Bloggs has it (so that we
have three observations of the genotype, which could be from one, two, or
three individuals). Find the conditional distribution of X, and show that the
probability that Mr Bloggs is guilty is E[X2]/E[X3]. (c) Generalize (b) to j
independent observations of the genotype.
33. There are n families living in a neighborhood. Of these, nk have k children,
where k = 0, 1, . . . , 4. Let pk = nk/n, the probability that a randomly chosen
family has k children and let μ be the mean number of children. You observe a
child playing in the street. Show that the probability that this child belongs to a
family with k children is kpk/μ. Explain how both this and Problem 32(a) can
be explained by a “balls in urns” model.
34. You bid on an object at a silent auction. You know that you can sell it later
for $100 and you estimate that the maximum bid from others is uniform on

148
RANDOM VARIABLES
[70, 130] (for convenience, you assume that it is continuous, thus disregarding
the possibility of two equal bids). How much should you bid to maximize your
expected proﬁt, and what is the maximum expected proﬁt?
35. A stick measuring one yard in length is broken into two pieces at random.
Compute the expected length of the longest piece.
36. A European roulette table has the numbers 1–36 plus 0 (but no 00), and the
payout is the same as for the American table. What is the mean and variance of
the gain if you (a) bet on odd and (b) make a straight bet?
37. Compute the means and variances of A and W in Problem 17.
38. The random variable X has pdf f(x) = 3x2, 0 ≤x ≤1. (a) Compute E[X] and
Var[X]. (b) Let Y =
√
X and compute E[Y] and Var[Y].
39. Let X ≥0 be continuous. Show that E[X] =
 ∞
0
P(X > x)dx and E[X2] =
2
 ∞
0
xP(X > x)dx. Hint: x =
 t
0 dt and x2 = 2
 x
0 t dt.
40. Let X ∼unif(0, 1), let Y = 1/X, and let Z = 1/
√
X. Compute the expected
values and variances of Y and Z where possible.
41. Let R ∼unif[0, 1] V be the volume of a sphere with radius R. Compute E[V]
and Var[V].
42. Let X ∼unif[0,2] and let V be the volume of a cube with side X. Find E[V]
and Var[V].
43. The continuous random variable X has pdf f(x) = 2x, 0 ≤x ≤1. Find (a)
E[X] and Var[X], (b) the expected volume of a sphere with radius X.
44. The random variable X has pdf f(x) = c sin x, 0 ≤x ≤π. Find (a) the constant
c, (b) the cdf F(x) of X, and (c) E[csc X].
45. Let X have mean μ and variance σ2. (a) What are the mean and variance of −X?
Explain intuitively. (b) Find constants a and b such that the random variable
Y = aX + b has mean 0 and variance 1 (this is called standardization).
46. The coefﬁcient of variation for a nonnegative random variable is deﬁned as
c = σ/μ. (a) Let X ∼unif[a, b] and ﬁnd c. (b) In (a), if a = n and b = n + 1,
what happens to c as n →∞?
47. Let X be a nonnegative random variable with mean μ and variance σ2. Prove
the following inequalities and compute the bounds they give in Example 2.29.
(a) Markov inequality: P(X ≥c) ≤μ/c
(b) One-sided Chebyshev inequality: P(X ≥μ + a) ≤σ2/(σ2 + a2)
48. Prove Proposition 2.16 by letting cσ = 1/k in Chebyshev’s inequality, and
apply Proposition 1.6.
Section 2.5. Special Discrete Distributions
49. Let A and B be events. Show that (a) I2
A = IA, (b) IAc = 1 −IA, (c) IA∩B =
IAIB, and (d) IA∪B = IA + IB −IA∩B.
50. Suppose that the probability of a rainy day in Seattle in December is 0.8. If a
day is not rainy, call it sunny. In which of the following cases is it reasonable

PROBLEMS
149
to assume a binomial distribution? Argue why/why not and give the parameter
values where you have a binomial distribution. (a) You count the number of
rainy days on Christmas Eve for 10 consecutive years. (b) You count the number
of rainy days in December next year. (c) You count the number of rainy days
on the ﬁrst of each month for a year. (d) You count the number of sunny days
on Christmas Eve for 10 consecutive years.
51. TherandomvariableXhasabinomialdistributionwithE[X] = 1andVar[X] =
0.9. Compute P(X > 0).
52. Roll a die 10 times. What is the probability of getting (a) no 6s, (b) at least two
6s, and (c) at most three 6s.
53. Let X be the number of 6s when a die is rolled six times, and let Y be the
number of 6s when a die is rolled 12 times. Find (a) E[X] and E[Y] and
(b) P(X > E[X]) and P(Y > E[Y]).
54. A fair coin is ﬂipped n times. What is the probability of getting a total of k
heads if (a) the ﬁrst ﬂip shows heads, (b) the ﬁrst ﬂip shows tails, and (c) at
least one ﬂip shows heads?
55. Ann and Bob ﬂip a fair coin 10 times. Each time it shows heads, Ann gets
a point; otherwise Bob gets a point. (a) What is the most likely ﬁnal result?
(b) Which is more likely: that it ends 5–5 or that somebody wins 6–4? (c) If
Ann wins the ﬁrst three rounds, what is the probability that she ends up the
winner? (d) If Ann wins the ﬁrst four rounds, what is the probability that Bob
never takes the lead? (e) What is the probability that the lead changes four times?
56. A multiple-choice test consists of six questions, each with four alternatives. At
least four correct answers are required for a passing grade. What is the proba-
bility that you pass if you (a) guess at random; (b) know the ﬁrst three answers,
and guess on the rest; (c) for each question know the correct answer with prob-
ability 1
2, otherwise guess at random? (d) In (c), to ensure at least 95% certainty
that you will pass, how high must the probability that you know an answer be?
(e) For (a)–(c), ﬁnd the mean and variance of the number of correct answers.
57. A restaurant has 15 tables, and it is known that 70% of guests who make reser-
vations actually show up. To compensate for this, the restaurant has a policy of
taking more than 15 reservations, thus running a risk to become overbooked.
How many reservations can they take to limit this risk to at most 5%?
58. Let X ∼bin(n, p) and Y ∼geom(p). (a) Show that P(X = 0) = P(Y > n).
Explain intuitively. (b) Express the probability P(Y ≤n) as a probability
statement about X.
59. You ﬂip each of n coins repeatedly until it shows heads. Let X be the number
of coins that require at least ﬁve ﬂips. Find P(X = 0) and E[X].
60. In Example 2.35, let S be the number of sons and D the number of daughters.
Find P(D > S), P(D = S), and P(D < S).
61. Consider a sequence of independent trials that result in either success or failure.
Fix r ≥1 and let X be the number of trials required until the rth success. Show

150
RANDOM VARIABLES
that the pmf of X is
p(k) =
k −1
r −1

pr(1 −p)k−r, k = r, r + 1, . . .
This is called a negative binomial distribution with parameters r and p, written
X ∼negbin(r, p). What is the special case r = 1?
62. Each workday (Monday–Friday) you catch a bus from a street corner. You have
estimated that you arrive too late and miss the bus on average every 5 days.
Consider a new workweek. (a) What is the probability that the next missed bus
will be on Friday? (b) You decide to start biking after you have missed the bus
ﬁve times. What is the probability that this happens on Friday the next week?
63. The number of customers X who call a certain toll-free number in a minute has
a Poisson distribution with mean 2. A minute is classiﬁed as “idle” if there are
no calls and “busy” otherwise. (a) What is the probability that a given minute
is busy? (b) Let Y be the number of calls during a busy minute. Find the pmf
of Y and E[Y]. (c) If a minute is idle, what is the expected number of busy
minutes before the next idle minute? What assumptions are you making?
64. Insects of a certain type lay eggs on leaves such that the number of eggs on
a given leaf has a Poisson distribution with mean 1. For any given leaf, the
probability is 0.1 that it will be visited by such an insect, and leaves are visited
independent of each other. (a) What is the probability that a given leaf has no
eggs? (b) If a leaf is inspected and has no eggs, what is the probability that it
has been visited by an insect? (c) If 10 leaves are inspected and none have any
eggs, what is the probability that at least one leaf has been visited by an insect?
65. Prove the expressions for the variances of the binomial and the Poisson
distributions by ﬁrst ﬁnding useful recursive expressions for k(k −1)p(k) and
then using the fact that E[X2] = E[X(X −1)] + E[X].
66. (a) Flip a coin 10 times and let X be the number of heads. Compute P(X ≤1)
exactly and with the Poisson approximation. (b) Now instead ﬂip four coins 10
times and let X be the number of times you get four heads. Compute P(X ≤1)
exactly and with the Poisson approximation. (c) Compare (a) and (b). Where
does the approximation work best and why?
67. Do Example 1.22 with the binomial approximation to the hypergeometric
distribution and compare with the exact probabilities.
68. Compare the variance of the hypergeometric distribution with the variance of
the binomial approximation. Which is smaller, and why?
69. Let X be hypergeometric with parameters N, r, and n. Argue that X can be
approximated by a Poisson distribution. What is required of the parameters for
the approximation to be good.
Section 2.6. The Exponential Distribution
70. Jobs arrive at a computer such that the time T between two consecutive jobs
has an exponential distribution with mean 10 s. Find (a) Var[T], (b) P(T ≤5),

PROBLEMS
151
(c) the probability that the next job arrives within 5 s given that the last job
arrived 25 s ago, (d) P(T > E[T]).
71. A large number of lightbulbs are turned on in a new ofﬁce building. A year
later, 80% of them still function, and 2 years later, 30% of the original light-
bulbs still function. Does it seem likely that the lifetimes follow an exponential
distribution?
72. Let X ∼exp(λ) and let Y = λX. Show that Y ∼exp(1).
73. The element nobelium has a half-life of 58 min. Let X be the lifetime of an
individual nobelium atom. Find (a) P(X > 30), (b), P(X ≤60|X > 30), and
(c) E[X] and Var[X].
74. Let T ∼exp(λ) and let X = [T] + 1 (“[ · ]” denoting integer part). Show that
X ∼geom(1 −e−λ) (success probability 1 −e−λ). If T is the lifetime of a
component, what could be the interpretation of X?
75. ProveProposition2.21byﬁrstsubtractingG(y)anddividingbyxintheequation
G(x + y) = G(x)G(y). Solve the resulting differential equation.
76. You are at a post ofﬁce where there are two clerks, you are being served by one
of them, the other clerk serves another customer, and one customer is waiting
in line. If service times are independent and exp(λ), what is the probability that
you are the last of the three customers to leave the post ofﬁce?
Section 2.7. The Normal Distribution
77. Let X have a normal distribution with mean μ = 200 and standard deviation
σ = 10. Find (a) P(X ≤220), (b) P(X ≤190), (c) P(X > 185), (d) P(X >
205), (e) P(190 ≤X ≤210), and (f) P(180 ≤X ≤210).
78. Let X have a normal distribution with mean μ and standard deviation σ.
(a) Find an expression involving  for the probability that X is within c stan-
dard deviations of its mean where c is a positive real number. (b) If you want
the probability in (a) to be 0.99, what value of c do you get?
79. Suppose that heights in a population follow a normal distribution with mean 70
and standard deviation 3 (inches). Find the 10th and the 90th percentiles.
80. Suppose that X ∼N(μ, σ2). Find the Z-score corresponding to the X-value
μ + cσ where c is any real number (negative or positive).
81. Two species of ﬁsh have weights that follow normal distributions. Species A
has mean 20 and standard deviation 2; species B has mean 40 and standard
deviation 8. Which is more extreme: a 24 pound A-ﬁsh or a 48 pound B-ﬁsh?
82. Jane takes a test and scores 80 points. The test results in her class follow a
normal distribution with mean 70 and standard deviation 10. On the second
test, the mean is instead 150 and the standard deviation is 30. How much must
she score to do as well as on the ﬁrst test?
83. The number of free electrons in a metal fragment is measured with a mea-
surement error that is normally distributed. More speciﬁcally, if there are
n free electrons, the number Y = n + X is recorded where X has a normal

152
RANDOM VARIABLES
distribution with mean 0 and standard deviation σ = 0.43. If Y is rounded to
the nearest integer, what is the probability that we get the correct answer?
84. Amanuallyoperatedstopwatchisusedtoclocktimesina100mtrackrace.Ifthe
true time of a runner is t seconds, the watch will show the time T = t + 0.1 + X,
where X has a normal distribution with mean 0 and variance 0.01. (a) For a
given t, what is the distribution of T? (b) If the true time t is 11.5 s, what is
P(T ≤11.5)? (c) What is the probability that T is within 0.05 s of the true time
t?
85. Let X ∼N(0, 1). Express the pdfs of the following random variables in terms
of the standard normal pdf ϕ(x): (a) −X, (b) |X|, (c) X2, (d) eX.
86. Let H and W be the height and weight of a randomly chosen individual. In
the light of the previous problem, is it reasonable to assume that they are both
normal?
87. A type of metal rod is desired to have a length of 100 cm. It is ﬁrst cut crudely
by a machine and then ﬁnished by hand. It is known that the machine gives
lengths that are normal with mean μ and variance 2, where μ can be set by the
operator. If a machine-cut rod is shorter than 100, it is wasted and if it is longer
than 100, the excess material is wasted. (a) If the length of a rod is X, which
function of X describes the amount of waste? (b) How should μ be chosen in
order to minimize the expected waste?
88. The random variable X has cdf F(x) = 1 −e−x2, x ≥0. Use properties of the
normal distribution together with Proposition 2.10 to ﬁnd E[X].
89. If X has a normal distribution, what is the probability that it deviates more than
k standard deviations from its mean for k = 1, 2, . . .? Compare with the bounds
given by Chebyshev’s inequality.
90. Use the approximation formula given in Section 2.7 to ﬁnd the probability that
a randomly selected person has an IQ at least as high as Marilyn’s (see Example
2.29).
91. Let X ∼N(0, 1). Show that P(X > x + ϵ|X > x) ≈e−xϵ for large x and small
ϵ.
Section 2.8. Other Distributions
92. Let X be lognormal with parameters μ and σ2. Find the distributions of X2 and
X3.
93. Let W and H be the weight and height of a randomly chosen individual. If H
is lognormal, is it reasonable to assume that W is also lognormal?
94. Let X be lognormal with parameters μ = 0 and σ2 = 1. Find (a) P(X ≤2),
(b) P(X2 ≤2), (c) P(X > E[X]), and (d) the median m of X.
95. Let X ∼(α, λ), and let Y = λX. Show that Y ∼(α, 1).
96. Let X have the Cauchy distribution. (a) Find the cdf of X. (b) Let Y = 1/X.
Show that Y also has the Cauchy distribution.

PROBLEMS
153
97. On my drive to work from home, I have a left turn where there is a stoplight.
About 80% of the time it is red, in which case my waiting time until it turns
green is uniform on (0,30) seconds. Let X be my waiting time when I arrive at
the stoplight. Find the cdf of X and sketch its graph. Is X discrete? Continuous?
Why or why not?
98. A box contains equally many electronic components of two types, I and II. A
type I component has a lifetime that is exp(1); a type II component has a lifetime
that is exp(2). Consider a randomly chosen component and let X be its lifetime.
(a) Find the cdf of X. Is X exponential? (b) Given that a component works after
t hours, what is the probability that it is of type I?
Section 2.9. Location Parameters
99. For the following pdfs, ﬁnd means, medians, and modes where possible.
Compare them and argue which best represents the distribution. (a) f(x) =
1/x2, x ≥1,
(b) f(x) = 1
2, x ∈[0, 1] ∪[2, 3], (c) f(x) = 2(1 −x), x ∈
[0, 1], (d) f(x) = −x, −1 ≤x ≤0 and f(x) = x, 0 ≤x ≤1, and (e) f(x) =
1/(π(1 + x2)), x ∈R.
100. For the following pairs of expressions, explain the difference in terms of location
parameters: (a) “taller than average” and “taller than most people,” (b) “typical
new home price” and “average new home price,” and (c) “a majority of the
salaries are between $50, 000 and $60, 000” and “a plurality of the salaries are
between $50, 000 and $60, 000.”
101. Let X be a random variable. If there exists a constant a such that P(X ≥
a + x) = P(X ≤a −x) for all x ≥0, X is said to have a symmetric distribution.
(a) Which of the following distributions are symmetric? (i) N(0, 1), (ii) exp(λ),
(iii) unif[0, 1], (iv) Poi(λ), (v) bin(n, 1
2), and (vi) bin(n, p), where p /= 1
2.
(b) What does the pmf or pdf look like for a symmetric distribution? (c) Sup-
pose that X is continuous and has a symmetric distribution with mean μ. Show
that a = μ, and that the median equals the mean (under the assumptions of
Corollary 2.7).
102. Let X have mean μ and variance σ2. The skewness of X is deﬁned as skw[X] =
E[(X −μ)3]/σ3 and is a measure of the asymmetry of the distribution. Show
that skw[X] = (E[X3] −3μE[X2] + 2μ3)/σ3 (compare Corollary 2.2).
103. Find skw[X] if (a) X ∼exp(λ) (Note: E[X3] = 6/λ3), (b) X ∼Poi(λ) (Note:
E[X3] = λ3 + 3λ2 + λ). (c) What happens in (a) and (b) as λ increases?
Explain!
104. Let X have mean μ and variance σ2. The kurtosis of X is deﬁned as kur[X] =
E[(X −μ)4]/σ4 and is a measure of the peakedness of the pdf. Show that
kur[X] = (E[X4] −4E[X3]μ + 6E[X2]μ2 −3μ4)/σ4 (compare with Corol-
lary 2.2).
105. Find kur[X] if (a) X ∼N(μ, σ2) (Note: E[Z4] = 3 if Z ∼N(0, 1)), (b) S ∼
exp(λ) (Note: E[X4] = 24/λ4), (c) X ∼unif[0, 1], and (d) X ∼Poi(λ) (Note:
E[X4] = λ4 + 6λ3 + 7λ2 + λ).

154
RANDOM VARIABLES
106. The kurtosis can be used to check for deviations from the normal distribution.
For this purpose, the excess kurtosis can be deﬁned as xkur[X] = kur[X] −3.
Find xkur[X] for the distributions in the previous problem and interpret in terms
of deviations from normality.
Section 2.10. The Failure Rate Function
107. Let X be a discrete random variable with range {0, 1, 2, . . .}. The (discrete)
failure rate function is then deﬁned as
r(k) = P(X = k)
P(X ≥k)
(a) Show that r(k) = P(X = k|X ≥k). (b) Let X be the number when you roll
a fair die. Find the failure rate function of X. Sketch the pmf and the failure rate
function of X and explain the difference between the two graphs. Also suggest
an interpretation in terms of lifetimes.
108. Let T be a nonnegative, continuous random variable. Express E[T] as an inte-
gral that includes the failure rate function r(t) but not the pdf, cdf, or survival
function.
109. Find the failure rate function of the random variable T if it has pdf (a) f(t) =
2t, 0 ≤t ≤1, (b) f(t) = 1/t2, t ≥1, (c) f(t) = 2t exp(−t2), t ≥0.
110. Find the cdfs of the nonnegative continuous random variables with the following
failure rate functions: (a) r(t) = 1/(1 + t), (b) r(t) = 2t, (c) r(t) = t3, (d) r(t) =
e−t.
111. A certain type of lightbulb has failure rate function r(t). The probability is 0.2
that such a lightbulb functions for more than 5000 h. Suppose that we want to
double this probability by decreasing the failure rate function by a factor c < 1,
to cr(t). How should we choose c?
112. The lifetime L of a certain insect has median 2 months and failure rate function
r(t) = at2, t ≥0
Find (a) the constant a and (b) the probability that a newborn insect lives at
least 3 months.
113. The time T in seconds between consecutive jobs arriving to a computer has
failure rate function
r(t) =

1 −t if 0 ≤t ≤1
t −1 if t ≥1
Find (a) P(0.5 ≤T ≤1.5) and (b) the pdf f and the median m of T.

PROBLEMS
155
114. The lifetime T in years of a lawn mower has failure rate function
r(t) =
⎧
⎪
⎨
⎪
⎩
1/2 if 0 ≤t ≤2
t/4 if 2 ≤t ≤6
9
if t ≥6
Find (a) the probability that a new mower breaks down within 6 months,
(b) the probability that a 2-year-old mower works for yet another year,
(c) the probability that a 7-year-old mower breaks down within a month,
(d) the median lifelength of a new mower, and (e) the median remaining life-
length of a 2-year-old mower.
115. The lifetime T in hours of a type of electronic component is a continuous
random variable with failure rate function r(t) that equals the constant c for
t ≤100. For t ≥100, r(t) is such that the failure rate doubles every 2 h and r(t)
is continuous at 100. Find (a) the expression for r(t), (b) the value of c if it is
known that the median lifetime is 110 h, and (c) the probability that a lifetime
is at most 100 h.

3
JOINT DISTRIBUTIONS
3.1
INTRODUCTION
In the previous chapter, we introduced random variables to describe random ex-
periments with numerical outcomes. We restricted our attention to cases where the
outcome is a single number, but there are many cases where the outcome is a vector
of numbers. We have already seen one such experiment, in Example 1.5, where a
dart is thrown at random on a dartboard of radius r. The outcome is a pair (X, Y) of
random variables that are such that X2 + Y2 ≤r2. For another example, suppose that
we measure voltage and current in an electric circuit with known resistance. Owing
to random ﬂuctuations and measurement error, we can view this as an outcome (V, I)
of a pair of random variables.
These examples have in common that there is a relation between the random
variables that we measure, and by describing them only one by one, we do not get all
the possible information. The dart coordinates are restricted by the board, and voltage
and current are related by Ohm’s law. In this chapter, we extend the notion of random
variables to random vectors.
3.2
THE JOINT DISTRIBUTION FUNCTION
Wewillfocusprimarilyonrandomvectorsintwodimensions.Letusbeginbyformally
deﬁning our fundamental object of study.
Probability, Statistics, and Stochastic Processes, Second Edition. Peter Olofsson and Mikael Andersson.
© 2012 John Wiley & Sons, Inc. Published 2012 by John Wiley & Sons, Inc.
156

THE JOINT DISTRIBUTION FUNCTION
157
Deﬁnition 3.1. Let X and Y be random variables. The pair (X, Y) is then called a
(two-dimensional) random vector.
Our aim is to describe random vectors in much the same way as we described
random variables in Chapter 2, and we will thus deﬁne analogs of the cdf, pmf,
and pdf. For a given random vector (X, Y), we will often be interested in events of the
type {X ∈A} ∩{Y ∈B}, that is, the event that X belongs to the set A and Y at the same
time belongs to the set B. To ease the notation, we write P(X ∈A, Y ∈B) instead of
P({X ∈A} ∩{Y ∈B}). With this in mind, we can state the following deﬁnition.
Deﬁnition 3.2. The joint distribution function (joint cdf) of (X, Y) is deﬁned as
F(x, y) = P(X ≤x, Y ≤y)
for x, y ∈R.
The joint cdf is a function of two variables. It has properties similar to those of the one-
dimensional cdf, but since it requires three dimensions to plot, it is more difﬁcult to
visualize. It also turns out to be somewhat less central for computation of probabilities
than its one-dimensional analog. The reason for this is that in one dimension, virtually
any event involving a random variable is of the form {X = x} or {a < X ≤b}, and the
probabilities of these events can be directly expressed in terms of the cdf according
to Propositions 2.2 and 2.4.
In two dimensions, things become more difﬁcult. The cdf in a point (x, y) is the
probability that X ≤x and Y ≤y, that is, the probability that (X, Y) is in the set
(−∞, x] × (−∞, y], the inﬁnite rectangle “southwest” of the point (x, y). For a ﬁnite
rectangle B = (a, b] × (c, d], it is easy to show (Problem 1) that
P(a < X ≤b, c < Y ≤d) = F(b, d) −F(b, c) −F(a, d) + F(a, c)
and we can ﬁnd probabilities of other types of rectangular sets in a similar way.
However, in two dimensions, there are many other types of sets. For example, if C is
theunitcircledisk,C = {(x, y) : x2 + y2 ≤1},thenwecannotexpressP((X, Y) ∈C)
directly by the joint cdf. (Try it!) The same problems arise for events such as {X ≤Y}
or {|X −Y| > 1}. The plane R2 is much more complicated than the nicely ordered
real line.
If we are given the joint cdf F of (X, Y), we can obtain the individual cdfs of X
and Y by noticing that the event {X ≤x} is the same as the event {X ≤x, Y < ∞},
which puts no restrictions on Y. Since this has probability
P(X ≤x, Y < ∞) = F(x, ∞)
we get the following result.

158
JOINT DISTRIBUTIONS
Proposition 3.1. If (X, Y) has joint cdf F, then X and Y have cdfs
FX(x) = F(x, ∞) and FY(y) = F(∞, y)
for x, y ∈R.
The cdfs of X and Y are called the marginal cdfs of (X, Y).
3.3
DISCRETE RANDOM VECTORS
Just as in the one-dimensional case, we make the distinction between discrete and
continuous random vectors.
Deﬁnition 3.3. If X and Y are discrete random variables, then (X, Y) is called a
discrete random vector.
If the range of X is {x1, x2, . . .} and the range of Y is {y1, y2, . . .}, then the range of
(X, Y) is {(xj, yk), j, k = 1, 2, . . .}, which is also a countable set. Hence, a discrete
random vector (X, Y) is characterized by a countable range, in the same way as is a
discrete random variable. In an analogy with the one-dimensional case, we state the
following deﬁnition.
Deﬁnition 3.4. If (X, Y) is discrete with range {(xj, yk) : j, k = 1, 2, . . .}, the func-
tion
p(xj, yk) = P(X = xj, Y = yk)
is called the joint pmf of (X, Y).
Example 3.1. Roll a die twice. Let X be the ﬁrst and Y the second number. Find the
joint pmf of (X, Y).
The range is {(j, k) : j = 1, 2, . . . , 6, k = 1, 2, . . . , 6}, and for any pair (j, k), we get
p(j, k) = P(X = j, Y = k)
= P(X = j)P(Y = k) =
1
36

DISCRETE RANDOM VECTORS
159
0 1 2 3 4 5
0 1 2 3 4 5
0.08 
1 2 3 4 5 6
1 2 3 4 5 6
1/36 
FIGURE 3.1
Joint pmfs for Examples 3.1 and 3.2, respectively.
since the events {X = j} and {Y = k} are independent. We say that (X, Y) has a
uniform distribution on {(j, k) : j = 1, 2, . . . , 6, k = 1, 2, . . . , 6}.
□
Example 3.2. Phone calls arrive to a mail order company such that the number of
phone calls in a minute has a Poisson distribution with mean 4. A given caller is
female with probability 0.5, independent of other callers. In a given minute, let X
be the number of female callers and Y the total number of callers. Find the joint pmf
of (X, Y).
Unlike the previous example, events pertaining to X and Y are not independent, which
is clear since X is always less than or equal to Y. However, we can use conditional
probabilities by noting that if Y = k, then the number of female callers is binomial
with parameters k and 0.5, and we get
p(j, k) = P(X = j|Y = k)P(Y = k)
=
k
j

0.5j0.5k−je−4 4k
k!
= e−4
2k
j!(k −j)!,
0 ≤j ≤k, k = 0, 1, 2, . . .
□
The joint pmfs for the two examples are depicted in Figure 3.1.
If we are given the pmf of (X, Y), we might be interested in ﬁnding the marginal
(one-dimensional) pmfs of the random variables X and Y. Since the event {X = xj}
can be described in terms of (X, Y) as {X = xj, “Y =anything”}, we get
pX(xj) =
∞

k=1
P(X = xj, Y = yk) =
∞

k=1
p(xj, yk)
with the obvious analog for pY. We have the following result.

160
JOINT DISTRIBUTIONS
Proposition 3.2. If (X, Y) has joint pmf p, then the marginal pmfs of X and Y are
pX(xj) =
∞

k=1
p(xj, yk),
j = 1, 2, . . .
pY(yk) =
∞

j=1
p(xj, yk),
k = 1, 2, . . . .
Example 3.3. Find the marginal pmfs in Example 3.2.
From the problem it is given that Y ∼Poi(4). To ﬁnd the pmf of X, start from the
joint pmf
p(j, k) = e−4
2k
j!(k −j)!,
0 ≤j ≤k, k = 0, 1, 2, . . .
and note that for ﬁxed j, k ranges from j to ∞. This gives
pX(j) = e−4
∞

k=j
2k
j!(k −j)!
= e−4 2j
j!
∞

k=j
2k−j
(k −j)! = e−2 2j
j! , j = 0, 1, . . .
which means that X ∼Poi(2).
□
3.4
JOINTLY CONTINUOUS RANDOM VECTORS
Deﬁnition 3.5. If there exists a function f such that
P((X, Y) ∈B) =

B
f(x, y)dx dy
for all subsets B ⊆R2, then X and Y are said to be jointly continuous. The function
f is called the joint pdf.

JOINTLY CONTINUOUS RANDOM VECTORS
161
We may also say simply that the vector (X, Y) is continuous. The notation

B means
that we integrate over the two-dimensional region B.1 In particular, the choice B =
{(s, t) : s ≤x, t ≤y} = (−∞, x] × (−∞, y] gives
F(x, y) =
 y
−∞
 x
−∞
f(s, t)ds dt
which also gives the following proposition.
Proposition 3.3. If X and Y are jointly continuous with joint cdf F and joint pdf
f, then
f(x, y) =
∂2
∂x∂yF(x, y), x, y ∈R
The intuition is the same as in the one-dimensional case; f(x, y) is a measure
of how likely it is that (X, Y) is in the neighborhood of the point (x, y), not ex-
actly equal to (x, y). Again, the probability that (X, Y) equals (x, y) is 0 for all
x and y. Even more holds in the jointly continuous case. Since lines and curves
in R2 have area 0, integrating the joint pdf over them also gives 0 and hence the
probability that (X, Y) takes values on any ﬁxed line or curve is 0. In particular,
P(X = Y) = 0.
Since probabilities are always nonnegative and P((X, Y) ∈R2) = 1, we get the
following analog of Proposition 2.6.
Proposition 3.4. A function f is a possible joint pdf for the random variables X
and Y if and only if
(a) f(x, y) ≥0 for all x, y ∈R
(b)
 ∞
−∞
 ∞
−∞
f(x, y)dx dy = 1
Example 3.4. The random vector (X, Y) has joint pdf
f(x, y) = c(x + 2y),
0 ≤x ≤1, 0 ≤y ≤1
Find (a) the constant c and (b) the joint cdf F(x, y).
1As in the one-dimensional case, some restrictions must in general be imposed on the class of possible
subsets B, but we can again safely disregard this problem.

162
JOINT DISTRIBUTIONS
For part (a), we use Proposition 3.4. Clearly, f ≥0 and since
 1
0
 1
0
f(x, y)dx dy = c
 1
0
 1
0
(x + 2y)dx dy
= c
 1
0
1
2 + 2y

dy = 3c
2
we get c = 2
3. For part (b), we get
F(x, y) =
 y
0
 x
0
2
3(s + 2t)ds dt =
 y
0
x2
3 + 4xt
3

dt
=
tx2
3 + 4xt2
6
y
t=0
= 1
3
	
x2y + 2xy2
,
0 ≤x ≤1, 0 ≤y ≤1
□
In an analogy with the result regarding marginal pmfs, we have the following result
in the jointly continuous case.
Proposition 3.5. Suppose that X and Y are jointly continuous with joint pdf f.
Then X and Y are continuous random variables with marginal pdfs
fX(x) =
 ∞
−∞
f(x, y)dy, x ∈R
fY(y) =
 ∞
−∞
f(x, y)dx, y ∈R
Example 3.5. Find the marginal pdfs in Example 3.4.
The joint pdf is
f(x, y) = 2
3(x + 2y),
0 ≤x ≤1, 0 ≤y ≤1
which gives
fX(x) = 2
3
 1
0
(x + 2y)dy
= 2
3

xy + y21
y=0 = 2
3(x + 1),
0 ≤x ≤1

JOINTLY CONTINUOUS RANDOM VECTORS
163
and
fY(y) = 2
3
 1
0
(x + 2y)dx
= 2
3
x2
2 + 2xy
1
x=0
= 1
3(1 + 4y),
0 ≤y ≤1
□
Example 3.6. Choose a point (X, Y) at random in the unit disk {(x, y) : x2 + y2 ≤1}.
Find the joint pdf and the marginal pdfs.
In an analogy with the one-dimensional case, “at random” means that the joint pdf
must be constant on the unit disk (and 0 outside). Since the joint pdf must also integrate
to 1 and the area of the unit disk is π, we realize that (X, Y) has joint pdf
f(x, y) = 1
π,
x2 + y2 ≤1
We call this a uniform distribution on the unit disk. Since the boundary has probability
0, we can replace “≤” by “<” if we wish, and thus it makes no difference whether we
consider the closed or open disk (compare the one-dimensional uniform distribution).
What is the marginal distribution of X? First note that the range of X is [−1, 1]. Is
X uniform on this range? To ﬁnd the marginal pdf of X, ﬁx x ∈[−1, 1] and compute
fX(x) =
 ∞
−∞
f(x, y)dy
The integral limits are determined by where the joint pdf f(x, y) is strictly positive,
which is where the point (x, y) is inside the unit disk. For ﬁxed x, this happens when
y is between −
√
1 −x2 and
√
1 −x2. Hence, we get
fX(x) = 1
π
 √
1−x2
−√
1−x2 dy = 2
π

1 −x2,
−1 ≤x ≤1
and by symmetry, Y has the same marginal distribution as X. Now, this is certainly
not the pdf of a uniform distribution on [−1, 1]. To understand why X is not uniform,
consider an interval Ih of a ﬁxed length h inside [−1, 1]. For a uniform distribution,
the probability P(X ∈Ih) is the same regardless of where the interval is located, but
in our case this probability is larger the closer the interval is to the origin. Remember
that we are choosing a point uniformly in the unit disk, and getting X in a speciﬁc
interval corresponds to (X, Y) being in a speciﬁc region. For a ﬁxed interval length,
this region is larger the closer the interval is to 0 (draw a ﬁgure).
□

164
JOINT DISTRIBUTIONS
3.5
CONDITIONAL DISTRIBUTIONS AND INDEPENDENCE
Recall the concept of conditional probability from Section 1.5. The intuition behind
P(A|B) is that this is the probability of A if we know that the event B has occurred.
Now suppose that the event A is related to a discrete random variable Y, for example,
A = {Y = y}. The conditional probability of the event {Y = y} given B can then be
regarded as the conditional pmf of Y, given the event B, evaluated in the point y.
If the event B is also related to a discrete random variable, say, X, we can state the
following deﬁnition.
Deﬁnition 3.6. Let X and Y be discrete random variables with ranges {x1, x2, . . .}
and {y1, y2, . . .}, respectively, and joint pmf p. The conditional pmf of Y given
X = xj is deﬁned as
pY(yk|xj) = p(xj, yk)
pX(xj)
for yk in the range of Y
We view this as a function of yk where the value xj is ﬁxed. An application of the law
of total probability gives
pY(yk) =
∞

j=1
pY(yk|xj)pX(xj)
for yk in the range of Y, which is the same formula as in Proposition 3.2. To get the
conditional cdf, we compute the sum
FY(y|xj) =

k:yk≤y
pY(yk|xj)
for y ∈R.
Example 3.7. Consider Example 3.2, where X is the number of female callers and Y
the total number. Find the conditional pmf of Y given X = j.
We computed the joint pdf and found it to be
p(j, k) = e−4
2k
j!(k −j)!,
0 ≤j ≤k, k = 0, 1, 2, . . .
and in Example 3.3, we found that X ∼Poi(2). Conditioned on X = j, the range of
Y is j, j + 1, . . . and we get the conditional pmf
pY(k|j) = e−4 2k/(j!(k −j)!)
e−2 2j/j!
= e−2
2k−j
(k −j)!, k = j, j + 1, . . .

CONDITIONAL DISTRIBUTIONS AND INDEPENDENCE
165
which means that, given that there are j female callers, the total number of callers is
j plus a number that has a Poisson distribution with mean 2, which is of course the
number of male callers.
□
The continuous case is similar, but we have to be careful since pdfs are not proba-
bilities. Let us ﬁrst consider what we should mean by the conditional pdf of Y given
an event B. Intuitively, it is clear that this should be a pdf that is computed given
the information that the event B has occurred. If Y were discrete, we would simply
go ahead according to the deﬁnition above, but for continuous Y, the event {Y = y}
has probability 0 for all y, and we need to proceed differently. Since the pdf is not a
probability but the cdf is, let us ﬁrst deﬁne the conditional cdf as
F(y|B) = P(Y ≤y|B) = P({Y ≤y} ∩B)
P(B)
and then the conditional pdf of Y given B as
f(y|B) = d
dyF(y|B)
This is ﬁne as long as B is an event with P(B) > 0, but what if B is also related to
a continuous random variable of the form B = {X = x} so that B has probability 0?
Clearly, it still makes intuitive sense to talk about the “distribution of Y given that X =
x,” but if X is continuous, we cannot use the deﬁnition of conditional probability as we
did above. Our deﬁnition of conditional pdf instead mimics its discrete counterpart,
and we state the following.
Deﬁnition 3.7. Let (X, Y) be jointly continuous with joint pdf f. The conditional
pdf of Y given X = x is deﬁned as
fY(y|x) = f(x, y)
fX(x) ,
y ∈R
We interpret this as the pdf of Y if we know that X = x. Note that x is a ﬁxed value and
the argument of the pdf is y. To deﬁne the conditional cdf, we integrate the conditional
pdf and get
FY(y|x) = P(Y ≤y|X = x) =
 y
−∞
fY(t|x)dt
for y ∈R. More generally, for any set B ⊆R, we have
P(Y ∈B|X = x) =

B
fY(y|x)dy
Example 3.8. Consider again Example 3.6, where a point (X, Y) is chosen uniformly
in the unit disk. What is the conditional pdf of Y given X = x?

166
JOINT DISTRIBUTIONS
The joint pdf is
f(x, y) = 1
π,
x2 + y2 < 1
and the marginal pdf of X is
fX(x) = 2
π

1 −x2,
−1 ≤x ≤1
For a ﬁxed x, the range of Y is (−
√
1 −x2,
√
1 −x2), and the conditional pdf is
fY(y|x) = f(x, y)
fX(x) =
1
2
√
1 −x2 ,
−

1 −x2 ≤y ≤

1 −x2
But this functional expression does not depend on y, so we conclude that fY(y|x) is
constant as a function of y (remember that x is a ﬁxed value). Hence, the conditional
distribution of Y given that X = x is uniform on (−
√
1 −x2,
√
1 −x2), which we
may write as
Y|X = x ∼unif
	
−

1 −x2,

1 −x2

and by symmetry we also get
X|Y = y ∼unif

−

1 −y2,

1 −y2

□
In the above example, we started by describing (X, Y) and found the marginals and
conditional distributions. It is also possible to go the other way, that is, to ﬁrst deﬁne
the marginal pdf of X and then the conditional pdf of Y given X = x. This is natural
if the experiment is performed in stages, as the following example shows.
Example 3.9. Choose a point X uniformly on [0, 1] and given X = x, choose Y
uniformly on [0, x]. Find the joint pdf of (X, Y).
First note that the range of (X, Y) is the triangle {(x, y) : 0 ≤x ≤1, 0 ≤y ≤x}. The
pdf of X is
fX(x) = 1,
0 ≤x ≤1
and the conditional pdf of Y given X = x is
fY(y|x) = 1
x,
0 ≤y ≤x
which gives joint pdf
f(x, y) = fY(y|x)fX(x) = 1
x,
0 ≤x ≤1, 0 ≤y ≤x

CONDITIONAL DISTRIBUTIONS AND INDEPENDENCE
167
Note that this is not a uniform distribution on the triangle since values tend to be
more likely near the origin. Think about why this is the case.
□
The following proposition is a continuous version of the law of total probability.
Proposition 3.6. Let X and Y be jointly continuous. Then
(a) fY(y) =
 ∞
−∞
fY(y|x)fX(x)dx, y ∈R
(b) P(Y ∈B) =
 ∞
−∞
P(Y ∈B|X = x)fX(x)dx, B ⊆R
Proof. For (a), just combine Proposition 3.5 with the deﬁnition of conditional pdf
and for (b), part (a) gives
P(Y ∈B) =

B
fY(y)dy =

B
 ∞
−∞
fY(y|x)fX(x)dx dy
=
 ∞
−∞

B
fY(y|x)fX(x)dy dx
=
 ∞
−∞
P(Y ∈B|X = x)fX(x)dx
as desired.
■
Note again how intuition is quite clear. To ﬁnd, for example, P(Y ∈B), we condition
on a particular value, X = x, and compute P(Y ∈B|X = x). Then we compute a
weighted average over all possible values of X and use the pdf of X to ﬁnd the
weights. Since X is continuous, the averaging is done by an integral instead of a sum.
In particular, with B = (−∞, y], we get
FY(y) =
 ∞
−∞
FY(y|x)fX(x)dx
Another version of the law of total probability that we state without proof can be
helpful for computing probabilities of events involving both X and Y.

168
JOINT DISTRIBUTIONS
Proposition 3.7. Let X and Y be jointly continuous. Then, for B ⊆R2
P((X, Y) ∈B) =
 ∞
−∞
P((x, Y) ∈B|X = x)fX(x)dx
Note how P((x, Y) ∈B|X = x) is in fact the probability of a statement about Y alone,
for ﬁxed x. The usefulness of the proposition is best illustrated by an example.
Example 3.10. Let X ∼unif[0, 1], and given X = x, let Y ∼unif[0, x]. Find
P(Y ≤X2).
The region B is the set {(x, y) : 0 ≤x ≤1, 0 ≤y ≤x2}, and we have
P((x, Y) ∈B|X = x) = P(Y ≤x2|X = x) = x
since given X = x, Y has cdf P(Y ≤t|X = x) = t/x. We get
P(Y ≤X2) = P((X, Y) ∈B) =
 1
0
x dx = 1
2
□
Part (b) in Proposition 3.6 is also valid if Y is discrete and X continuous. In this case,
the pair (X, Y) is neither jointly discrete nor jointly continuous, but it still makes sense
to talk about conditional distributions. We illustrate this in an example.
Example 3.11. Let X ∼unif[0, 1] and given X = x, let Y ∼geom(x). Thus, we
consider a geometric distribution where the success probability is chosen at random
from [0, 1]. Find the distribution of Y.
The quickest way is to note that P(Y > k|X = x) = (1 −x)k, which gives
P(Y > k) =
 1
0
(1 −x)kdx =
1
k + 1, k = 0, 1, 2, . . .
which in turn gives
P(Y = k) = P(Y > k −1) −P(Y > k) =
1
k(k + 1), k = 1, 2, . . .
and it is interesting to note that this is not a geometric distribution.
□
3.5.1
Independent Random Variables
Recall Example 3.6, where a point (X, Y) is chosen uniformly in the unit disk. When
we computed the marginal pdf of X, we saw that X tends more likely to be near

CONDITIONAL DISTRIBUTIONS AND INDEPENDENCE
169
the midpoint 0 than the endpoints −1 and 1. By symmetry, Y has the same marginal
distribution as X on the y axis and hence also Y tends to be more likely to be near
0. But this seems to indicate that the pair (X, Y) is more likely to be near the origin
(0, 0), which would contradict the assumption that (X, Y) is uniform on the unit disk.
How is this possible?
The solution to this apparent paradox is that X and Y do tend to be concentrated
near 0 when considered one by one but not at the same time. Recall the condi-
tional distributions that state that if, for example, X = x, Y is uniform on the interval
(−
√
1 −x2,
√
1 −x2). Hence, if X is near 0, there is a lot of room for variability in
Y, but if X is far from 0, there is less room and Y must be near 0.
It would be natural to say that X and Y are dependent, since knowing the value of
one of them gives us information on the possible values and hence the distribution of
the other. We next state the formal deﬁnition of independence of random variables.
Deﬁnition 3.8. The random variables X and Y are said to be independent if
P(X ∈A, Y ∈B) = P(X ∈A)P(Y ∈B)
for all A, B ⊆R.
Note that this means that {X ∈A} and {Y ∈B} are independent events. It can be
difﬁcult to check this for all possible sets A and B, but it turns out that there is a
simpler characterization of independence.
Proposition 3.8. The random variables X and Y are independent if and only if
F(x, y) = FX(x)FY(y)
for all x, y ∈R.
The proof of the proposition is beyond the scope of this book. If X and Y are inde-
pendent and g and h are any functions, it can be shown that g(X) and h(Y) are also
independent. While intuitively reasonable, the proof is quite advanced and we will
not give it. For some special cases, see Problem 37.
In the case when X and Y are discrete, independence can be easily characterized
directly in terms of the probability mass functions, as the following proposition shows.
Proposition 3.9. Suppose that (X, Y) is discrete with joint pmf p. Then X and Y
are independent if and only if
p(x, y) = pX(x)pY(y)
for all x, y ∈R.

170
JOINT DISTRIBUTIONS
Proof. Suppose that X and Y are independent. In the deﬁnition of independence,
choose A = {x} and B = {y} to obtain
p(x, y) = P(X = x, Y = y) = P(X = x)P(Y = y) = pX(x)pY(y)
Conversely, suppose that p(x, y) = pX(x)pY(y) and take two subsets of R, A and B.
Then
P(X ∈A, Y ∈B) =

x∈A

y∈B
p(x, y) =

x∈A
pX(x)

y∈B
pY(y)
which equals P(X ∈A)P(Y ∈B), and hence X and Y are independent.
■
Not surprisingly, an analogous relation characterizes independence in the jointly con-
tinuous case. The proof, which relies on Proposition 3.8, is left as an exercise.
Proposition 3.10. Suppose that X and Y are jointly continuous with joint pdf f.
Then X and Y are independent if and only if
f(x, y) = fX(x)fY(y)
for all x, y ∈R.
Thus, there are several equivalent characterizations of independence, depending on
what type of random variables we are dealing with. Regardless of whether we are
talking about cdfs, pmfs, or pdfs, we can keep the following informal description
in mind.
Corollary 3.1. The random variables X and Y are independent if and only if “the
joint is the product of the marginals.”
It also follows from the deﬁnitions that independence is equivalent to equality between
conditional and unconditional distributions. Thus, all our intuition from independent
events carries over to independent random variables.
Example 3.12. Recall Example 3.6, where a point (X, Y) is chosen uniformly in the
unit disk. The joint pdf is
f(x, y) = 1
π,
x2 + y2 ≤1
and the marginals
fX(x) = 2
π

1 −x2,
−1 ≤x ≤1

CONDITIONAL DISTRIBUTIONS AND INDEPENDENCE
171
and
fY(y) = 2
π

1 −y2,
−1 ≤y ≤1
and since f(x, y) /= fX(x)fY(y), X and Y are not independent, as was to be expected
from the discussion at the beginning of this section.
□
In the last example, it is immediately clear that X and Y cannot be independent since
if we know the value of one of them, this changes the range of possible values of the
other. This leads us to realize that two random variables X and Y can be independent
only if the range in two dimensions of the pair (X, Y) has a shape such that the ranges
of X and Y individually do not change in this way. Thus, only ranges that are shaped
as rectangles (possibly inﬁnite) parallel to the axes are possible to get independent
random variables. Note that this is a necessary but not sufﬁcient condition. Even if
the shape is rectangular, the joint pdf may still not equal the product of the marginals
(as in Example 3.4).
When we compute probabilities pertaining to independent random variables, the
following corollary to Proposition 3.7 can be very useful.
Corollary 3.2.
P((X, Y) ∈B) =
 ∞
−∞
P((x, Y) ∈B)fX(x)dx
Proof. By independence
P((x, Y) ∈B|X = x) = P((x, Y) ∈B)
and everything else follows from Proposition 3.7.
■
Example 3.13 (Buffon’s Needle). A table is ruled by equidistant parallel lines, 1
in. apart. A needle of length 1 in. is tossed at random on the table. What is the
probability that it intersects a line?
We describe the needle’s position by distance D from the center of the needle to the
nearest line and the (smallest) angle A between the needle and that line. In Figure
3.2, we see how the left needle and the line form a triangle that has a hypotenuse of
length D/sin A. The right needle does not intersect the line but would also form such
a triangle if extended toward the line. Thus, we realize that the needle intersects the
line if and only if
D
sin A ≤1
2

172
JOINT DISTRIBUTIONS
A
A
D
D
FIGURE 3.2
Buffon’s needle. The needle to the left has D/sin A ≤1
2 and thus intersects a
line.
where the range of D is [0, 1/2] and that of A is [0, π/2]. If we interpret “tossed at
random” as D and A being independent and uniform on their respective ranges, we
can apply Corollary 3.2 to obtain the probability of an intersection as
P
 D
sin A ≤1
2

=
 π/2
0
P
 D
sin a ≤1
2

fA(a)da
= 2
π
 π/2
0
P

D ≤sin a
2

da
= 2
π
 π/2
0
sin a da = 2
π
yet another of the many appearances of the number π in mathematics.2
□
3.6
FUNCTIONS OF RANDOM VECTORS
Just as in the one-dimensional case, we may be interested in a function g of (X, Y).
There are two principal cases of interest: g:R2 →R, resulting in a random variable,
and g:R2 →R2, resulting in another random vector. We start with the ﬁrst of these.
3.6.1
Real-Valued Functions of Random Vectors
The typical situation here is that we have a random vector (X, Y) and apply a real-
valued function g to get the random variable g(X, Y). To compute probabilities of the
type P(g(X, Y) ∈B) for B ⊆R, we need to identify the outcomes of (X, Y) that are
mapped to B. Let us illustrate this with a couple of examples.
2In the late eighteenth century, Count de Buffon, French naturalist and avid needle tosser, designed this
experiment to estimate a numerical value of π. We will return to this aspect of the problem in Chapter 4.

FUNCTIONS OF RANDOM VECTORS
173
Example 3.14. Let X and Y be independent and unif[0, 1], and let A be the area of a
rectangle with sides X and Y. Find the pdf of A.
Here, A = XY and the range of A is [0, 1]. Take a in this range and start with the cdf
to obtain
FA(a) = P(XY ≤a) =

B
f(x, y)dx dy
where B is the two-dimensional region
B = {(x, y) : 0 ≤x ≤1, 0 ≤y ≤1, xy ≤a}
and f(x, y) = fX(x)fY(y) = 1 by independence. Draw a picture to realize that
FA(a) = a +
 1
a
 a/x
0
dy dx
= a + a
 1
a
1
xdx = a −a log a,
0 ≤a ≤1
which we differentiate to get the pdf
fA(a) = F′
A(a) = −log a,
0 ≤a ≤1
□
Example 3.15. Let X and Y be independent and exp(λ), and let Z = X/(X + Y).
Find the pdf of Z.
First note that the range of Z is [0, 1]. Take z in this range and consider the cdf
FZ(z) = P

X
X + Y ≤z

= P

Y ≥
1
z −1

X

This means that we integrate the joint pdf over the region
B =

(x, y) : y ≥
1
z −1

x

By independence, the joint pdf is
f(x, y) = λe−λxλe−λy,
x ≥0, y ≥0

174
JOINT DISTRIBUTIONS
and with a = 1/z −1, we get
FZ(z) =
 ∞
0
 ∞
ax
λe−λyλe−λxdy dx
=
 ∞
0
λe−λaxe−λxdx =
1
a + 1
in which we substitute a by 1/z −1 to obtain
FZ(z) =
1
1/z −1 + 1 = z,
0 ≤z ≤1
which we recognize as the uniform distribution on [0, 1]. It is tempting to believe
that this has nothing to do with the exponential distribution and that X/(X + Y) is
uniform on [0, 1] as long as X and Y are independent and have the same distribution.
However, this is not the case; see, for example, Problem 43(b). In fact, it is a special
property of the exponential distribution that gives this result, and we return to this in
Section 3.12.
□
Sometimes, two-dimensional methods can be used even if there is seemingly nothing
two-dimensional in the problem. Here is one typical example.
Example 3.16. Choose two points at random on a yardstick. What is the probability
that they are at most half a yard apart?
Let us ﬁrst formulate this strictly as a probability problem. Thus, we let X and Y be
independent unif[0, 1] and wish to ﬁnd P(|X −Y| ≤1
2). Although there is nothing
two-dimensional in this problem from a physical point of view, we can solve it by
viewing (X, Y) as a random vector in two dimensions. By independence, the joint pdf
is
f(x, y) = fX(x)fY(y) = 1,
0 ≤x ≤1, 0 ≤y ≤1
and the region of interest B = {(x, y) : |x −y| ≤1
2}, which is illustrated in
Figure 3.3. Since f(x, y) ≡1, the integral of f over B is equal to the area of B,
which gives
P

|X −Y| ≤1
2

= 3
4
□
We have seen examples of how to ﬁnd the distribution of a function g(X, Y) of a
random vector (X, Y). If all we are interested in is the expected value E[g(X, Y)],
we do not need to ﬁnd the distribution, according to the following two-dimensional
analog of Proposition 2.12, which we state without proof.

FUNCTIONS OF RANDOM VECTORS
175
0 
1/2
1 
1/2
1
|x–y| ≤ 1/2 
FIGURE 3.3
Illustration of Example 3.16. Every outcome of (X, Y) in the region bounded
by the axes and the lines has |X −Y| at most half a yard apart.
Proposition 3.11. Let (X, Y) be a random vector with joint pmf p or joint pdf f
and let g:R × R →R be any function. Then
E[g(X, Y)] =
⎧
⎪
⎪
⎪
⎪
⎪
⎪
⎨
⎪
⎪
⎪
⎪
⎪
⎪
⎩
∞

j=1
∞

k=1
g(xj, yk)p(xj, yk)
if (X, Y) is discrete
 ∞
−∞
 ∞
−∞
g(x, y)f(x, y)dx dy if (X, Y) is continuous
Example 3.17. Choose a point at random in the unit disk. What is its expected
distance to the origin?
If the point is (X, Y), the distance is R =

X2 + Y2. We thus have g(x, y) =

x2 + y2 in the proposition above, and the joint pdf of (X, Y) is
f(x, y) = 1
π,
x2 + y2 ≤1
which by Proposition 3.11 gives
E[R] = E

X2 + Y2

= 1
π
 
x2+y2≤1

x2 + y2dx dy
which we solve by changing to polar coordinates. Thus, let x = r cos θ, y = r sin θ,
which gives region of integration 0 ≤r ≤1 and 0 ≤θ ≤2π. The Jacobian matrix

176
JOINT DISTRIBUTIONS
for the transformation (r, θ) →(x, y) is
J =
⎛
⎜
⎜
⎜
⎜
⎝
∂x
∂r
∂x
∂θ
∂y
∂r
∂y
∂θ
⎞
⎟
⎟
⎟
⎟
⎠
=

cos θ −r sin θ
sin θ r cos θ

which has determinant
|J| = cos θ × r cos θ −(−r sin θ) × sin θ
= r(cos2 θ + sin2 θ) = r
which gives dx dy = r dr dθ and
E[R] = 1
π
 2π
0
 1
0
√
r2 r dr dθ = 1
π
 2π
0
dθ
 1
0
r2dr = 2
3
□
3.6.2
The Expected Value and Variance of a Sum
We can use Proposition 3.11 to show that expected values are linear in the sense that
the expected value of a sum is the sum of the expected values.
Proposition 3.12. Let X and Y be any random variables. Then
E[X + Y] = E[X] + E[Y]
Proof. Let us do the jointly continuous case. By Proposition 3.11, with the function
g(x, y) = x + y, we get
E[X + Y] =
 ∞
−∞
 ∞
−∞
(x + y)f(x, y)dx dy
=
 ∞
−∞
 ∞
−∞
xf(x, y)dx dy +
 ∞
−∞
 ∞
−∞
yf(x, y)dx dy
=
 ∞
−∞
xfX(x)dx +
 ∞
−∞
yfY(y)dy = E[X] + E[Y]
where the second to last equality follows from Proposition 3.5. The discrete case is
similar, replacing integrals by sums.
■
Combining Propositions 3.12 and 2.11 gives the following result.

FUNCTIONS OF RANDOM VECTORS
177
Corollary 3.3. Let X and Y be any random variables, and let a and b be real
numbers. Then
E[aX + bY] = aE[X] + bE[Y]
From Proposition 2.15, we already know that the variance is not linear since
Var[aX] = a2Var[X], but the question remains whether the variance is additive, that
is, if Var[X + Y] = Var[X] + Var[Y]. The following simple example shows that there
might be a problem.
Example 3.18. Let X ∼unif[0, 1] and let Y = −X. By Propositions 2.13 and 2.15,
we have
Var[X] = Var[Y] = 1
12
and hence
Var[X] + Var[Y] = 1
6
However, X + Y ≡0, so by Proposition 2.16, Var[X + Y] = 0 and
Var[X + Y] /= Var[X] + Var[Y]
in this case.
□
The problem in the example is that there is no variability at all in the sum X + Y,
even though X and Y have variability individually. Intuitively, this is because variation
in X is canceled by variation in Y in the opposite direction. Note that X and Y are
dependent (and very strongly so), and it turns out that independence is an assumption
that allows us to add variances. We state this next, together with a result about the
expected value of a product.
Proposition 3.13. Let X and Y be independent random variables. Then
(a) E[XY] = E[X]E[Y]
(b) Var[X + Y] = Var[X] + Var[Y]
Proof. Let us again consider the continuous case only. First note that when
X and Y are independent, then f(x, y) = fX(x)fY(y) by Proposition 3.10. By

178
JOINT DISTRIBUTIONS
Proposition 3.11, we get
E[XY] =
 ∞
−∞
 ∞
−∞
xyf(x, y)dx dy
=
 ∞
−∞
xfX(x)dx
 ∞
−∞
yfY(y)dy = E[X]E[Y]
whichprovespart(a).Forpart(b),useCorollary2.2togetherwithlinearityofexpected
values to obtain
Var[X + Y] = E

(X + Y)2
−
	
E[X + Y]

2
= E[X2] + 2E[XY] + E[Y2] −E[X]2 −2E[X]E[Y] −E[Y]2
= E[X2] −E[X]2 + E[Y2] −E[Y]2 = Var[X] + Var[Y]
where we used part (a) for the second to last equality.
■
Finally, combining Propositions 2.15 and 3.13(b), we get the following corollary.
Corollary 3.4. Let X and Y be independent random variables, and let a and b be
real numbers. Then
Var[aX + bY] = a2Var[X] + b2Var[Y]
Example 3.19. You have an instrument to measure length, which gives a small
measurement error. If the true length is l, the instrument gives the estimated length
L = l + ϵ, where ϵ is a random variable with mean 0 and variance σ2. You have two
rods of different lengths and are allowed a total of two measurements to determine
their lengths. Can you do better than one measurement of each?
Yes, you can. Let the true lengths be a and b, where a > b. If you take one measure
of the longer rod, you get the measurement A = a + ϵ, which has mean E[A] = a +
E[ϵ] = a and variance Var[A] = Var[ϵ] = σ2. Similarly, the shorter rod is measured
to be B, with mean b and variance σ2.
Instead, put the rods side by side and measure the difference D, and then put them
end to end and measure the sum S. To estimate a and b, let A = (S + D)/2 and
B = (S −D)/2. Since S = a + b + ϵ1 and D = a −b + ϵ2, where ϵ1 and ϵ2 are the
two errors that we assume are independent, Corollary 3.3 gives
E[A] = 1
2E[S + D] = 1
2(a + b + a −b) = a

FUNCTIONS OF RANDOM VECTORS
179
and similarly E[B] = b, so your estimates are correct on average. The precision of A
and B are measured by their variances, and Corollary 3.4 gives
Var[A] = 1
22 (Var[S] + Var[D]) = σ2
2
Var[B] = 1
22 (Var[S] + (−1)2Var[D]) = σ2
2
and the precision is better than that of two individual measurements. The reason is
that in effect we get two measurements on each rod instead of one. We are assuming
that there is no error in the alignment of the rods side by side; see Problem 49 for a
variant of this.
□
Example 3.20. Let X and Y be independent and uniform on [0, 1], and let C be
the circumference of a rectangle with sides X and Y. Find the mean and variance of C.
Since C = 2X + 2Y, Propositions 3.3 and 3.4 give
E[C]
= 2E[X] + 2E[Y] = 2
Var[C] = 4Var[X] + 4Var[Y] = 2
3
□
If we have a sequence X1, . . . , Xn of random variables, Corollary 3.3 and induction
give the general result about linearity of expected values:
Proposition 3.14. Let X1, X2, . . . , Xn be random variables and let a1, a2, . . . , an
be real numbers. Then
E
 n

k=1
akXk

=
n

k=1
akE[Xk]
We will look at several examples. The ﬁrst two examples concern repeated rolls of a
die and are special cases of more general problems. The ﬁrst is a coupon collecting
problem and the second an occupancy problem.
Example 3.21. Roll a die repeatedly, and let X be the number of rolls it takes to get
all the numbers. Find E[X].
The ﬁrst number comes in the ﬁrst roll. Then we wait for any number that is different
from the ﬁrst. Since the probability of this in each roll is 5
6, the time it takes has
a geometric distribution with success probability 5
6. Once the second number has

180
JOINT DISTRIBUTIONS
appeared, we start waiting for the third one, and now the waiting time is geometric
with success probability 4
6 and so on. Hence,
X = 1 +
6

k=2
Xk
where Xk ∼geom
	
7−k
6

and
E[X] = 1 +
6

k=2
E[Xk] = 1 +
6
5 + 6
4 + · · · + 6
1

≈14.7
To explain the term “coupon collecting problem,” replace the die with coupons num-
bered 1, 2, . . . , 6, which are collected until we have all of them. For a general version,
see Problem 54.
□
Example 3.22. Roll a die six times and let X be the number of different numbers that
are represented. For example, if you get 1, 6, 3, 5, 3, 5, then X = 4 since 1, 3, 5, and
6 are represented. What is E[X]?
Note that the range of X is 1, 2, . . . , 6. It is possible to ﬁnd the pmf of X and compute
E[X] according to the deﬁnition, but it is much quicker to use indicators. Let
Ik =

1 if k is represented
0 otherwise
so that
X =
6

k=1
Ik
and
E[X] =
6

k=1
E[Ik]
Now, Ik equals 1 unless all six rolls gave numbers different from k. The probability
in one roll to get a number different from k is 5
6 and hence
E[Ik] = P(Ik = 1) = 1 −
5
6
6
which gives
E[X] = 6

1 −
5
6
6
≈3.99

FUNCTIONS OF RANDOM VECTORS
181
If we call a number “occupied” once it has been rolled, we understand the term
“occupancy problem” (see also Problem 55).
□
Example 3.23. Recall the matching problem from Example 1.27. What is the
expected number of matches?
Again, let us use indicators. Thus, let
Ik =

1 if there is a match at k
0 otherwise
so that
X =
n

k=1
Ik
Following the calculations in Example 1.27, we get
E[Ik] = P(Ik = 1) = 1
n
for all Ik. Hence,
E[X] =
n

k=1
E[Ik] = n × 1
n = 1
so on average one match is expected, regardless of the value of n.
□
To deal with more than two random variables, let us ﬁrst state the obvious general-
ization of the independence concept.
Deﬁnition 3.9. The random variables X1, X2, . . . are said to be independent if
P(Xi1 ∈B1, Xi2 ∈B2, . . . , Xik ∈Bk) =
k
 
i=1
P(Xik ∈Bk)
for all choices of i1 < · · · < ik and sets B1, . . . , Bk ⊆R, k = 2, 3, . . .
Note that we have deﬁned independence for an inﬁnite sequence, exactly as we did
for events in Deﬁnition 1.7. As in the two-dimensional case, independence can be
characterized in terms of joint and marginal distributions, and we return to this in
Section 3.10. For now, let us concentrate on the general variance formula. By
Proposition 3.13, Corollary 3.4, and induction, we get the following result:

182
JOINT DISTRIBUTIONS
Proposition 3.15. If X1, . . . , Xn are independent, then
(a) E[X1X2 · · · Xn] = E[X1]E[X2] · · · E[Xn]
(b) Var
 n

k=1
akXk

=
n

k=1
a2
kVar[Xk]
Example 3.24. Let X ∼bin(n, p). Find the mean and variance of X.
Recall that a binomial distribution counts the number of successes in n independent
trials. By introducing the indicators
Ik =

1 if the kth trial gives a success
0 otherwise
we can write
X =
n

k=1
Ik
where Ik are independent and have mean E[Ik] = p and variance Var[Ik] = p(1 −p)
(see Section 2.5.1). Hence,
E[X] =
n

k=1
E[Ik] = np
and
Var[X] =
n

k=1
Var[Ik] = np(1 −p)
which is in agreement with Proposition 2.17, but note how much simpler it was to
use indicators.
□
3.6.3
Vector-Valued Functions of Random Vectors
Previously, we saw how we can apply a real-valued function g to map (X, Y) to a
random variable g(X, Y). The following example illustrates a situation where (X, Y)
is mapped to another two-dimensional random vector.

FUNCTIONS OF RANDOM VECTORS
183
Example 3.25. Choose a point (X, Y) at random in the unit disk, and let its polar
coordinates be (R, ). What is the joint distribution of R and ?
First note that the random radius R and the random angle  relate to X and Y through
X = R cos 
and
Y = R sin 
where the range of R is [0, 1] and the range of  is [0, 2π]. Are they uniform on these
ranges? Let us try to ﬁnd the joint cdf of (R, ), that is,
F(r, θ) = P(R ≤r,  ≤θ)
for ﬁxed r in [0, 1] and θ in [0, 2π]. Now let
C =

(x, y) : 0 ≤

x2 + y2 ≤r, 0 ≤tan−1 	y
x

≤θ

so that we have
F(r, θ) = P((X, Y) ∈C)
(see Figure 3.4). Since (X, Y) is uniform, the probability that it belongs to the sector
C is simply the area of C divided by the area of the unit disk, and we get
F(r, θ) = P((X, Y) ∈C) = πr2θ/2π
π
= θr2
2π
By differentiating, we get the joint pdf
f(r, θ) =
∂2
dr dθ F(r, θ) = r
π,
0 ≤r ≤1,
0 ≤θ ≤2π
C
θ
r
FIGURE 3.4
A point in the disk has angle less than θ and radius less than r if it is chosen in
the region C.

184
JOINT DISTRIBUTIONS
which has marginals
fR(r) = r
π
 2π
0
dθ = 2r,
0 ≤r ≤1
and
f(θ) = 1
π
 1
0
r dr = 1
2π,
0 ≤θ ≤2π
Hence,  is uniform but R is not, which should not be too surprising. It is easier to
get a radius near 1 than near 0 since a ring of ﬁxed width has larger area near 1. There
is no reason why any particular angle would be more likely than any other, though.
Note also that f(r, θ) = fR(r)f(θ), which means that the radius and the angle are
independent. Think about why this makes sense.
□
The following is a two-dimensional analog of Proposition 2.8, which is stated without
proof.
Proposition 3.16. Let (X, Y) be jointly continuous with joint pdf f(X,Y). Further-
more, let (U, V) = (u(X, Y), v(X, Y)), where the map (x, y) →(u, v) is invertible.
The pair (U, V) then has joint pdf
f(U,V)(u, v) = f(X,Y)(x(u, v), y(u, v)) |J(x(u, v), y(u, v))|
where |J(x(u, v), y(u, v))| is the absolute value of the Jacobian determinant of the
inverse map (u, v) →(x(u, v), y(u, v)).
Example 3.26. Let X and Y be independent standard normal random variables and
consider the pair (X, Y) in its polar representation (R, ). Find the joint pdf of
(R, ) and the marginal distributions of R and .
By independence, the joint pdf of (X, Y) is
f(X,Y)(x, y) = fX(x)fY(y) = 1
2πe−(x2+y2)/2
and (X, Y) is mapped to (R, ) according to
R =

X2 + Y2
and
 = tan−1
 Y
X

The inverse map is
X = R cos 
and
Y = R sin 

CONDITIONAL EXPECTATION
185
and we apply Proposition 3.16. We know from before that |J| = r and get
f(R,)(r, θ) = f(X,Y)(r cos θ, r sin θ) × r
= 1
2πre−r2/2,
r ≥0, 0 ≤θ ≤2π
The marginals are easily found to be
fR(r) = re−r2/2,
r ≥0
and
f(θ) = 1
2π,
0 ≤θ ≤2π
so that R and  are independent and  is uniform on [0, 2π]. If we consider R2, the
squared distance to the origin, Proposition 2.8 with g(r) = r2 gives
fR2(x) =
1
2√xfR(√x) = 1
2e−x/2,
x ≥0
which we recognize as an exponential distribution with parameter λ = 1
2. We will
later see that this observation is useful to simulate observations from a normal
distribution.
□
3.7
CONDITIONAL EXPECTATION
Once we have deﬁned conditional distributions, it is a logical step to also deﬁne
conditional expectations. The intuition is clear; these are simply the expected values
in the conditional distributions, and the deﬁnitions are straightforward. We start with
conditioning on an event.
Deﬁnition 3.10. Let Y be a random variable and B an event with P(B) > 0. The
conditional expectation of Y given B is deﬁned as
E[Y|B] =
⎧
⎪
⎪
⎪
⎪
⎪
⎪
⎨
⎪
⎪
⎪
⎪
⎪
⎪
⎩
∞

k=1
ykP(Y = yk|B)
if Y is discrete with range {y1, y2, . . .}
 ∞
−∞
yfY(y|B)dy
if Y is continuous
Now recall the law of total probability that allows us to compute probabilities by
ﬁnding suitable conditioning events. There is an analog for expected values, a “law

186
JOINT DISTRIBUTIONS
of total expectation,” which states that
E[Y] =
∞

k=1
E[Y|Bk]P(Bk)
under the same conditions as the law of total probability. As usual, the sum may be
ﬁnite or inﬁnite. We omit the proof and illustrate with an example.
Example 3.27. Consider the computer from Example 2.45, which is busy with
probability 0.8, in which case an incoming job must wait for a time that is exp(1).
Find the expected waiting time of an incoming job.
The two cases pertain to whether the computer is busy, so let B be the event that it is
busy to obtain
E[Y] = E[Y|B]P(B) + E[Y|Bc]P(Bc)
where E[Y|Bc] = 0 since there is no wait if the computer is free and E[Y|B] = 1
since the expected wait is 1 s if it is busy. Hence, the expected waiting time is
E[Y] = 0 × 0.2 + 1 × 0.8 = 0.8 s
□
Next, we condition on the outcome of a random variable. If this random variable is
discrete, the situation is the same as above, with events of the type Bj = {X = xj}.
Deﬁnition 3.11. Suppose that X and Y are discrete. We deﬁne
E[Y|X = xj] =
∞

k=1
ykpY(yk|xj)
The law of total expectation now takes the form
E[Y] =
∞

j=1
E[Y|X = xj]pX(xj)
where the sum is over the range of X. Finally, we consider the continuous case where,
as usual, sums are replaced by integrals.
Deﬁnition 3.12. Suppose that X and Y are jointly continuous. We deﬁne
E[Y|X = x] =
 ∞
−∞
yfY(y|x)dy

CONDITIONAL EXPECTATION
187
Following the usual intuitive interpretation, this is the expected value of Y if we know
that X = x. The law of total expectation now takes the following form.
Proposition 3.17. Suppose that X and Y are jointly continuous. Then
E[Y] =
 ∞
−∞
E[Y|X = x]fX(x)dx
Proof. By deﬁnition of expected value and Proposition 3.6
E[Y] =
 ∞
−∞
yfY(y)dy =
 ∞
−∞
 ∞
−∞
yfY(y|x)fX(x)dx dy
where we change the order of integration to obtain
E[Y] =
 ∞
−∞
 ∞
−∞
yfY(y|x)dyfX(x)dx
where the inner integral equals E[Y|X = x] by deﬁnition, and we are done.
■
Example 3.28. Consider Example 3.9 where X ∼unif[0, 1] and the conditional
distribution of Y is Y|X = x ∼unif[0, x]. What is E[Y]?
There are two possible ways to solve this: using the deﬁnition of expected value or
using Proposition 3.17.
The ﬁrst solution is as follows. By deﬁnition
E[Y] =
 1
0
yfY(y)dy
where
fY(y) =
 ∞
−∞
f(x, y)dx =
 1
y
1
xdx
since for ﬁxed y, the joint pdf is strictly positive when x is between y and 1. Hence,
fY(y) =
!
log x
"1
y = −log y,
0 < y ≤1
The expected value is
E[Y] = −
 1
0
y log y dy
which can be shown to equal 1
4.

188
JOINT DISTRIBUTIONS
The second solution is as follows. Since Y|X = x ∼unif[0, x], we have
E[Y|X = x] = x
2
and by Proposition 3.17, we obtain
E[Y] =
 1
0
E[Y|X = x]fX(x)dx =
 1
0
x
2dx = 1
4
□
Example 3.29. A Geiger counter is an instrument used to detect radiation, such as
emission of alpha particles. When a particle is detected, the so-called dead period
follows, during which the counter cannot register anything. Dead periods are often
given as single numbers, but it is more realistic to assume that they are random.
Suppose that alpha particles are emitted at a rate of 10, 000 per second and that a
dead period lasts for a random time that has pdf
f(t) = 6t(1 −t), 0 ≤t ≤1
where we take the basic time unit to be 100 s. What is the expected number of
particles that go undetected during a dead period?
Let us denote the number of particles in an interval of ﬁxed length t × 100 s by X(t)
and assume that X(t) has a Poisson distribution with mean t (emissions per 100 s).
Since the length of a dead period is not ﬁxed but random, say, T, the number of
emissions during this period is X(T), and we condition to obtain
E[X(T)] =
 1
0
E[X(T)|T = t]fT (t)dt
= 6
 1
0
t × t(1 −t)dt = 1
2
so, on average, we miss one particle for every two that are detected.
□
We have considered both jointly discrete and jointly continuous random vectors. It is
also possible to have a mixture in the sense that, for example, X is discrete and Y is
continuous. In that case, neither a joint pmf nor a joint pdf exists, but we can still use
conditional distributions and expectations.
Example 3.30. Let Y ∼unif[0, 1] and independently choose one of the endpoints 0
and 1 such that 0 is chosen with probability p. What is the expected distance between
Y2 and the chosen point?
Let X be the point so that P(X = 0) = p and P(X = 1) = 1 −p, and we are looking
forE[|Y2 −X|].Now, XisdiscreteandY continuous,sowesolvethisbyconditioning

CONDITIONAL EXPECTATION
189
on X. First note that
|Y2 −X| =

Y2
if X = 0
1 −Y2 if X = 1
This means that
E

|Y2 −X|
###X = 0

= E[Y2|X = 0] = E[Y2]
since X and Y are independent. Similarly,
E

|Y2 −X|
###X = 1

= 1 −E[Y2]
and since E[Y2] = 1
3, we get
E

|Y2 −X|

= E

|Y2 −X|
###X = 0

P(X = 0)
+ E

|Y2 −X|
###X = 1

P(X = 1)
= E[Y2]p + (1 −E[Y2])(1 −p) = 2 −p
3
□
3.7.1
Conditional Expectation as a Random Variable
In the previous section, we learned that the conditional expectation E[Y|X = x] is
the expected value of Y if we know that X = x. We can therefore view E[Y|X = x]
as a function of x, g(x), and it is natural to deﬁne a random variable g(X) that equals
E[Y|X = x] whenever X = x. We use the notation E[Y|X] for this random variable
and get the following deﬁnition.
Deﬁnition 3.13. The conditional expectation of Y given X, E[Y|X], is a random
variable that equals E[Y|X = x] whenever X = x.
To get a better understanding, let us reconsider Example 3.28. There we had E[Y|X =
x] = x/2 and hence
E[Y|X] = X
2
the conditional expectation of Y given X. We also showed that
E[Y] =
 1
0
x
2dx

190
JOINT DISTRIBUTIONS
and since the integral is the expected value of the random variable X/2, we see that
we have
E[Y] = E
X
2

In fact, it is a simple consequence of the laws of total expectation that we always have
this type of relation.
Corollary 3.5.
E[Y] = E

E[Y|X]

We can now restate Example 3.28 in a more compact way. Let Y ∼unif[0, X], where
X ∼unif[0, 1]. Then it is clear that E[Y|X] = X/2, the midpoint, and by Corollary
3.5 we get
E[Y] = E
X
2

= 1
4
Make sure that you understand the difference between conditioning on the event
{X = x} and the random variable X. In the ﬁrst case, the conditional expectation is
a number (dependent on x) and in the second case it is a random variable (dependent
on X). When we condition on X, we can think of X as a known quantity, and the
following result, stated without proof, is easy to believe.
Corollary 3.6.
(a) E[XY|X] = XE[Y|X]
(b) If X and Y are independent, then E[Y|X] = E[Y]
(c) For any function g, E[g(X)|X] = g(X)
Note that (b) and (c) are the two extremes of independence and total dependence.
The conditional expectation changes from being equal to E[Y] (no information from
X) to g(X) (complete information from X).
Example 3.31. Let X ∼unif[0, 1] and let Y|X ∼unif[0, X2]. Let A be the area of a
rectangle with sidelengths X and Y and ﬁnd E[A].

CONDITIONAL EXPECTATION
191
By Corollary 3.5, we get E[A] = E[E[A|X]], and since A = XY, Corollary 3.6(a)
gives
E[A|X] = E[XY|X] = XE[Y|X]
where E[Y|X] = X2/2, and we get
E[A] = 1
2E[X3] = 1
2
 1
0
x3dx = 1
8
□
3.7.2
Conditional Expectation and Prediction
A common problem in many applications is that we are interested in one random
variable but observe another. For example, if a signal is received and we know that
there is noise that distorts the transmission, we wish to predict the most likely signal
that was sent. Another application might be that we are interested in the concen-
tration of a chemical compound in a solution but can measure only the concen-
tration of a by-product of the reaction that creates the compound. A third applica-
tion could be a company predicting sales ﬁgures for next year based on this year’s
sales.
In all these cases, we are interested in a random variable Y but observe another X
and want to predict Y by a function of X, g(X), called a predictor of Y. Clearly, we
want g(X) to be as close to Y as possible and to be able to quantify this idea, we need
a “measure of closeness.” The following is the most common.
Deﬁnition 3.14. Let g(X) be a predictor of Y. The mean square error is deﬁned as
E

(Y −g(X))2
It turns out that the best predictor of Y is the conditional expectation E[Y|X] in the
following sense.
Proposition 3.18. Among all predictors g(X) of Y, the mean square error is mini-
mized by E[Y|X].
We omit the proof and instead refer to an intuitive argument. Suppose that we want
to predict Y as much as possible by a constant value c. Then, we want to minimize

192
JOINT DISTRIBUTIONS
E[(Y −c)2], and with μ = E[Y] we get
E

(Y −c)2
= E

(Y −μ + μ −c)2
= E

(Y −μ)2
+ 2(μ −c)E[(Y −μ)] + (μ −c)2
= Var[Y] + (μ −c)2
since E[Y −μ] = 0. But the last expression is minimized when c = μ and hence μ
is the best predictor of Y among all constants. This is not too surprising; if we do not
know anything about Y, the best guess should be the expected value E[Y]. Now, if
we observe another random variable X, the same ought to be true: Y is best predicted
by its expected value given the random variable X, that is, E[Y|X].
Note here how we view the conditional expectation as a random variable. If we
observe a particular value x, the best predicted value of Y is E[Y|X = x]. Thus, if we
plot observations on (X, Y), the curve y = E[Y|X = x] gives the best ﬁt to the data.
3.7.3
Conditional Variance
Once we have introduced conditional expectation, the next logical deﬁnition is that
of conditional variance.
Deﬁnition 3.15. The conditional variance of Y given X is deﬁned as
Var[Y|X] = E

(Y −E[Y|X])2|X

Note that the conditional variance is also a random variable and we think of it as the
variance of Y given the value X. In particular, if we have observed X = x, then we
can denote and deﬁne
Var[Y|X = x] = E

(Y −E[Y|X = x])2 ###X = x

Also note that if X and Y are independent, E[Y|X] = E[Y], and the deﬁnition boils
down to the regular variance. There is an analog of Corollary 2.2, which we leave to
the reader to prove.
Corollary 3.7.
Var[Y|X] = E

Y2|X

−(E[Y|X])2
There is also a “law of total variance,” which looks slightly more complicated than
that of total expectation.

CONDITIONAL EXPECTATION
193
Proposition 3.19.
Var[Y] = Var

E[Y|X]

+ E

Var[Y|X]

Proof. Take expected values in Corollary 3.7 to obtain
E

Var[Y|X]

= E[Y2] −E

(E[Y|X])2
(3.1)
and since E[E[Y|X]] = E[Y], we have
Var

E[Y|X]

= E

(E[Y|X])2
−(E[Y])2
(3.2)
and the result follows by adding Equations (3.1) and (3.2).
■
The ﬁrst term in the formula in Proposition 3.19 accounts for how much of the vari-
ability in Y is explained by Y’s dependence on X; the second, how much is explained
by other sources. To understand this, note that if X and Y are highly dependent, then
it should make little difference whether we consider Y or E[Y|X], so their variances
should be about the same. On the other hand, if the dependence is weak, then E[Y|X]
should not change much as a result of variation in X, and thus have a small vari-
ance. The extreme cases are if Y is a function of X, in which case the second term
is 0, and if X and Y are independent, in which case the ﬁrst term is 0 (see Problem
76). For all cases in between, the size of the ﬁrst term relative to Var[Y] measures
how good X is at predicting Y. We will formalize the idea of strength of dependence
in Section 3.8.
Example 3.32. Let us revisit Example 3.28 again and use the proposition to ﬁnd
Var[Y]. Since Y ∼unif[0, X], Proposition 2.13 gives
E[Y|X] = X
2
and Var[Y|X] = X2
12
and we get
Var[Y] = Var
X
2

+ E
X2
12

= 1
4 × 1
12 + 1
12
 1
0
x2dx =
7
144
□
3.7.4
Recursive Methods
In Section 1.6.3, we saw several examples of how the law of total probability can be
used to compute probabilities with recursive methods. The same type of technique
can be applied to compute expected values and variances, and we start by a simple
illustration of this.

194
JOINT DISTRIBUTIONS
Example 3.33. Let X ∼geom(p). Show that E[X] = 1/p.
Recall that the geometric distribution counts the number of independent trials needed
to get the ﬁrst success. We condition on the ﬁrst trial, which can be either success (S)
or failure (F). Let μ = E[X] to obtain
μ = E[X] = E[X|S]P(S) + E[X|F]P(F)
where P(S) = p and P(F) = 1 −p. For the conditional expectations, note that if the
ﬁrst trial is a success, then we know that X = 1 and hence E[X|S] = 1. If the ﬁrst
trial is a failure, one trial has gone by and we start over to wait for the ﬁrst success
and hence E[X|F] = 1 + μ. We get
μ = 1 × p + (1 + μ)(1 −p) = 1 + μ −μp
which gives μ = 1/p as desired. There was a little bit of handwaving in the argument.
To make it strict, we should let IS and IF be the indicators of success or failure in the
ﬁrst trial and let Y be a random variable with the same distribution as X. Then, we
have the relation
X = IS + IF(1 + Y)
(3.3)
and by linearity of expected values and independence of IF and Y, we get
μ = E[IS] + E[IF](1 + E[Y]) = p + (1 −p)(1 + μ)
which is the same equation as above. We will generally not be this picky since it is
intuitively clear what we are doing. In Problem 77, you are asked to compute the
variance with a recursive argument, and then Equation (3.3) comes in handy.
□
Example 3.34. A fair coin is ﬂipped repeatedly and we count the number of ﬂips
required until the ﬁrst occurrence of the pattern HH. Let X be this number and ﬁnd
the expected value of X.
To compute E[X] directly, we would need to ﬁnd the probabilities P(X = k), which
leads to a challenging combinatorial problem. Instead, let us use a recursive approach.
There are three different possibilities: (1) the ﬁrst ﬂip gives T and we start over, (2)
the ﬁrst two ﬂips give HT and we start over, and (3) the ﬁrst two ﬂips give HH and
we are done (see Figure 3.5). With μ = E[X], we get
μ = E[X|T] × 1
2 + E[X|HT] × 1
4 + E[X|HH] × 1
4
Clearly, E[X|HH] = 2, and for the other conditional expectations, note that in each
case we have already spent a number of ﬂips and then start over to wait for HH, which
takes an additional number of ﬂips with mean μ. Hence,
μ = (1 + μ)1
2 + (2 + μ)1
4 + 2 × 1
4 = 6
4 + 3
4μ

CONDITIONAL EXPECTATION
195
Done in two ﬂips
Start over, wait another µ ﬂips
H
T
T
Start over, wait another µ ﬂips
H
FIGURE 3.5
Waiting for HH.
which gives μ = 6. Hence, on average, we have to wait six ﬂips until the ﬁrst occur-
rence of HH (see also Problem 80).
Now let us instead consider the same problem for the pattern TH. Since the proba-
bility to get TH in any two ﬂips is 1
4, the same as the probability to get HH, we might
guess that the mean number of ﬂips is still 6. Let us compute it by conditioning on
the ﬁrst ﬂip. If this is H, we have spent one ﬂip and start over. If it is T, we have spent
one ﬂip and wait for the ﬁrst H, which takes a number of ﬂips with mean 2 (the mean
of a geometric distribution with success probability 1
2). We get
μ = (1 + μ)1
2 + (1 + 2) × 1
2 = μ
2 + 2
which gives μ = 4. Although the two patterns HH and TH are equally likely to occur
in any particular two ﬂips, TH tends to show up before HH after repeated ﬂipping. To
compensate for its tardiness, HH has the possibility of repeating itself immediately
in the next ﬂip (in HHH there are two occurrences of HH), whereas we must wait
at least an additional two ﬂips before we can see TH repeat itself. Hence, in a large
number of ﬂips, we see on average equally many occurrences of HH and HT, but
HH tends to come in bursts and TH more evenly spread out.
This “pattern of patterns” becomes more pronounced the longer our pattern se-
quence is. Recall the game of Penney-ante from Example 1.61, which is constructed
so that the inherent asymmetries work to your advantage. It can be shown that the
expected number of ﬂips until HHH is 14, whereas the same number for HTH is 10
and for HTT and HHT only 8 (see Problem 82).
It turns out that the key in determining the length of the waiting time for a particular
pattern is how much overlap it has (with itself). For example, the pattern HTH has
an overlap of length 1 since the last letter can be the ﬁrst letter of another occurrence
of the pattern. For the same reason, the pattern HHH has one overlap of length 1 but
also one of length 2 since the last two letters can be the ﬁrst two in another occurrence
of the pattern. Finally, the patterns HHT and HTT have no overlap at all. The higher
the amount of overlap, the longer the waiting time and there is a nice and simple
formula that expresses the expected waiting time in terms of the amount of overlap.

196
JOINT DISTRIBUTIONS
In Problem 83, you are asked to ﬁnd this formula in a special case. For a general
overview of waiting times for patterns and plenty of other good stuff, see Problems
and Snapshots from the World of Probability by Blom et al. [2].
□
Example 3.35. Recall Example 1.59, the gambler’s ruin problem when Ann starts
with a dollar and plays against the inﬁnitely wealthy Bob. We saw that she eventually
goes broke, and we now address the question of how long the game can be expected
to last.
Let N be the time when Ann goes broke and let μ = E[N]. Again, we condition on
the ﬁrst ﬂip. If this is heads, Ann goes broke immediately, and hence E[N|H] = 1.
If the ﬁrst ﬂip is tails, one round of the game has passed and Ann’s fortune is $2. In
order for her to go broke eventually, she must ﬁrst arrive at a fortune of $1, which
takes a time that has mean μ. Then she starts over, and the remaining time until ruin
has mean μ. Hence, the total time until ruin, given that the ﬁrst ﬂip gives tails, is
E[N|T] = 1 + μ + μ and we get
μ = E[N|H]P(H) + E[N|T]P(T)
= 1 × 1
2 + (1 + 2μ)1
2 = 1 + μ
and since the only possible solution to the equation μ = 1 + μ is μ = ∞, we have
shown that the expected time until ruin is inﬁnite! Note that it is the mean of N that
is inﬁnite, not the random variable N itself (compare with the St. Petersburg paradox
in Example 2.23). Ann will eventually go broke, but it may take a long time.
□
3.8
COVARIANCE AND CORRELATION
So far we have distinguished between random variables that are independent and
those that are not. This is a crude distinction, and in the case of dependent random
variables, we would like to be able to quantify the strength of the dependence. Another
consideration is that dependence can go in different directions. For example, consider
the ideal gas law from chemistry. This states that in 1 mol of gas, the pressure P,
volume V, and temperature T are related through the formula
P = RT
V
where R is the universal gas constant. Hence, pressure increases with increasing
temperature but decreases with increasing volume. We could express this as having
a “positive” dependence between P and T but a “negative” dependence between P
and V.
It would be convenient to have a quantitative measure of the degree and direction
of dependence. If X and Y are two random variables, it is reasonable to require such
a measure to

COVARIANCE AND CORRELATION
197
• be 0, if X and Y are independent
• be > 0, if larger X values on average correspond to larger Y values
• be < 0, if larger X values on average correspond to smaller Y values
• be higher (in absolute value) the “stronger” the dependence between X and Y.
Only the ﬁrst requirement is mathematically precise, but hopefully there is a clear
intuition for what we want to achieve. Our ﬁrst attempt at a measure of dependence
is the following.
Deﬁnition 3.16. The covariance of X and Y is deﬁned as
Cov[X, Y] = E

(X −E[X])(Y −E[Y])

To compute the covariance, we can use Proposition 3.11, but it is often easier to use
the following formula, which is easily proved by the repeated use of Corollary 3.3.
Proposition 3.20.
Cov[X, Y] = E[XY] −E[X]E[Y]
The covariance satisﬁes the requirements we stated above. For example, by Proposi-
tion 3.13(a), we get
Corollary 3.8. If X and Y are independent, then Cov[X, Y] = 0.
In the next section, we will see that the converse is not true; the covariance can be
0 even if X and Y are dependent. The covariance satisﬁes the other requirements as
well. Suppose, for example, that X and Y are “positively dependent,” that is, that
larger X values tend to correspond to larger Y values. This means that when the
factor X −E[X] is positive, the factor Y −E[Y] also tends to be positive and so is
the product. On the other hand, if larger X values correspond to smaller Y values,
then positive values of X −E[X] correspond to negative values of Y −E[Y], and the
product is negative. Hence, we have Cov[X, Y] > 0 in the ﬁrst case and Cov[X, Y]
< 0 in the second.
In the same way, we can argue that “strong positive dependence” means that large
values of X −E[X] correspond closely to large values of Y −E[Y] and the product
becomes large as well. A weak positive dependence means that the correspondence
is less precise and the product, while still positive, may not be as large.

198
JOINT DISTRIBUTIONS
Example 3.36. Let X and Y be independent and uniform on [0, 1]. Let C be the
circumference and A the area of a rectangle with sides X and Y. Find the covariance
of A and C.
Since A = XY and C = 2X + 2Y, we get AC = 2X2Y + 2XY2 and hence
E[AC] = 2E[X2]E[Y] + 2E[X]E[Y2] = 2 × 1
3 × 1
2 + 2 × 1
2 × 1
3 = 2
3
which gives
Cov[A, C] = E[AC] −E[A]E[C] = 2
3 −1
4 × 2 = 1
6
□
One important use of the covariance is that it allows us to state a general formula for
the variance of a sum of random variables.
Proposition 3.21.
Var[X + Y] = Var[X] + Var[Y] + 2 Cov[X, Y]
Proof. By the deﬁnitions of variance and covariance and repeated use of properties
of expected values, we get
Var[X + Y] = E

(X + Y −E[X + Y])2
= E

(X −E[X] + Y −E[Y])2
= E

(X −E[X])2 + (Y −E[Y])2 + 2(X −E[X])(Y −E[Y])

= Var[X] + Var[Y] + 2 Cov[X, Y]
and we are done.
■
Note that Proposition 3.13(b) is a special case of this with Cov[X, Y] = 0.
Example 3.37. In Example 3.18, we had X ∼unif[0, 1] and Y = −X. Verify that
Var[X + Y] = 0.
We have Var[X] = Var[Y] = 1
12 and covariance
Cov[X, Y] = Cov[X, −X] = E[X(−X)] −E[X]E[−X] = −Var[X]
and Proposition 3.21 gives Var[X + Y] = 0.
□

COVARIANCE AND CORRELATION
199
Letusinvestigatesomeofthepropertiesofthecovariance.Westartwiththecaseoftwo
random variables and proceed to a more general result. The proof of the following
proposition is a straightforward application of the deﬁnition and the properties of
expected values.
Proposition 3.22. Let X, Y, and Z be random variables and let a and b be real
numbers. Then
(a) Cov[X, X] = Var[X]
(b) Cov[aX, bY] = ab Cov[X, Y]
(c) Cov[X + Y, Z] = Cov[X, Z] + Cov[Y, Z]
By Proposition 3.22 and induction, we can now show that covariances are bilinear in
the following sense.
Proposition 3.23. Let X1, . . . , Xn and Y1, . . . , Ym be random variables and let
a1, . . . , an and b1, . . . , bm be real numbers. Then
Cov
⎡
⎣
n

j=1
ajXj,
m

k=1
bkYk
⎤
⎦=
n

j=1
m

k=1
ajbkCov[Xj, Yk]
Wealsogetthefollowinggeneralvarianceformula,provedbycombiningPropositions
3.22(a) and 3.23.
Proposition 3.24. Let X1, . . . , Xn be random variables and let a1, . . . , an be real
numbers. Then
Var
 n

k=1
akXk

=
n

k=1
a2
kVar[Xk] +

i /= j
aiajCov[Xi, Xj]
Example 3.38. Let X have a hypergeometric distribution with parameters N, r, and
n. Prove Proposition 2.20 about the mean and variance of X.
Recall that X is the number of special objects, when we draw n out of N objects,
r of which are special. Just as for the binomial distribution, we can solve this by
introducing indicators. Thus, let
Ik =

1 if the kth draw gives a special object
0 otherwise

200
JOINT DISTRIBUTIONS
to obtain
X =
n

k=1
Ik
It is easily realized that Ik have the same distribution and that
P(Ik = 1) = r
N
which is the proportion of special objects. This gives the mean of X as
E[X] =
n

k=1
E[Ik] =
n

k=1
r
N = nr
N
which proves the ﬁrst part of Proposition 2.20. The Ik are not independent this time
since, for example,
P(I2 = 1) = r
N
but
P(I2 = 1|I1 = 1) = r −1
N −1
since repeated drawing without replacement changes the proportion of special objects.
To ﬁnd the variance of X, we thus need to use the general formula from Proposition
3.24. The variance of Ik is
Var[Ik] = r
N
	
1 −r
N

and we also need to ﬁnd the covariances Cov[Ij, Ik]. By symmetry, we realize that
these are the same for all j /= k, so let us ﬁnd Cov[I1, I2]. We have
Cov[I1, I2] = E[I1I2] −E[I1]E[I2]
where
E[I1I2] = P(I1 = 1, I2 = 1)
since this is the only case when I1I2 /= 0. But
P(I1 = 1, I2 = 1) = P(I2 = 1|I1 = 1)P(I1 = 1) = r −1
N −1 × r
N
and we get
Cov[I1, I2] = r −1
N −1 × r
N −r
N
r
N = −r(N −r)
N2(N −1)

COVARIANCE AND CORRELATION
201
which ﬁnally gives
Var[X] =
n

k=1
Var[Ik] +

i /= j
Cov[Ij, Ik]
= n r
N
	
1 −r
N

−n(n −1) r(N −r)
N2(N −1)
= n × N −n
N −1 × r
N
	
1 −r
N

after doing some algebra. Note that if we draw with replacement, we get a binomial
distribution with parameters n and p = r/N. The mean is the same, but the variance
is changed by a factor (N −n)/(N −1). If N is large relative to n, this factor is
approximately 1, which indicates that the hypergeometric distribution in that case
can be approximated by a binomial distribution.
□
Note how the general variance formula shows that the assumptions of independence
in Propositions 3.13 and 3.15 can be replaced by Cov[Xj, Xk] = 0, j /= k, a weaker
assumption. However, since independence is a central concept, we stick to the
formulations that we have.
3.8.1
The Correlation Coefﬁcient
The covariance is an important and widely used concept in probability theory, but
it turns out that it has shortcomings as a measure of dependence. To see where the
problem lies, consider the experiment of measuring the weight and height of a ran-
domly chosen individual. Let X be the weight in pounds and Y the height in inches.
The degree of dependence between X and Y is then Cov[X, Y]. Now let us instead
use the metric system, and let S denote the weight in kilograms and T the height in
centimeters. Then S = 0.45X and T = 2.5Y and Proposition 3.22(b) gives
Cov[S, T] = Cov[0.45X, 2.5Y] = 1.12 Cov[X, Y]
so if covariance measures the degree of dependence, we would thus have “12%
stronger dependence” if we use kilograms and centimeters than if we use pounds
and inches. If we further change from centimeters to millimeters, the covariance in-
creases by another factor of 100! Clearly this makes no sense, and we realize that any
reasonable measure of dependence must be dimensionless, that is, not be affected by
such changes in units of measure. It turns out that we can achieve this by scaling the
covariance by the standard deviations, and we state the following deﬁnition.
Deﬁnition 3.17. The correlation coefﬁcient of X and Y is deﬁned as
ρ(X, Y) =
Cov[X, Y]
√Var[X]Var[Y]

202
JOINT DISTRIBUTIONS
The correlation coefﬁcient is dimensionless. To demonstrate this, take a, b > 0 and
note that
ρ(aX, bY) =
Cov[aX, bY]
√Var[aX]Var[bY]
=
abCov[X, Y]

a2Var[X]b2Var[Y]
= ρ(X, Y)
We also call ρ(X, Y) simply the correlation3 between X and Y. Here are some more
good properties of the correlation coefﬁcient.
Proposition 3.25. The correlation coefﬁcient of any pair of random variables X
and Y satisﬁes
(a) −1 ≤ρ(X, Y) ≤1
(b) If X and Y are independent, then ρ(X, Y) = 0
(c) ρ(X, Y) = 1 if and only if Y = aX + b, where a > 0
(d) ρ(X, Y) = −1 if and only if Y = aX + b, where a < 0
Proof. Let Var[X] = σ2
1 and Var[Y] = σ2
2. For (a), ﬁrst apply Proposition 3.21 to the
random variables X/σ1 and Y/σ2 and use properties of the variance and covariance
to obtain
0 ≤Var
 X
σ1
+ Y
σ2

= Var[X]
σ2
1
+ Var[Y]
σ2
2
+ 2Cov[X, Y]
σ1σ2
= 2 + 2ρ
which gives ρ ≥−1. To show that ρ ≤1, instead use X/σ1 and −Y/σ2. Part (b) fol-
lows from Corollary 3.8, and parts (c) and (d) follow from Proposition 2.16, applied to
the random variables X/σ1 −Y/σ2 and X/σ1 + Y/σ2, respectively. Note that this also
gives a and b expressed in terms of the means, variances, and correlation coefﬁcient
(see Problem 90).
■
The correlation coefﬁcient is thus a number between −1 and 1, where −1 and 1
denote the maximum degrees of dependence in the sense that Y can be computed
from X with certainty. Part (b) states that independent random variables have cor-
relation 0, but it turns out that the converse of this is not true; the correlation co-
efﬁcient can be 0 even if the random variables are dependent, as we will see in an
example.
3In the electrical engineering literature, the term “correlation” is used in a slightly different meaning,
namely, to denote E[XY]. Statisticians refer to this quantity as the product moment.

COVARIANCE AND CORRELATION
203
ρ > 0
ρ = 0
ρ < 0
FIGURE 3.6
Simulated observations on pairs (X, Y) that are positively correlated, uncorre-
lated, and negatively correlated, respectively.
Example 3.39. Choose a point (X, Y) uniformly in the unit disk. What is ρ(X, Y)?
The joint pdf is f(x, y) = 1/π. Denote the unit disk by D to obtain
E[XY] = 1
π

D
xy dx dy
which we realize must equal 0 by symmetry. Also, by symmetry, E[X] = E[Y] = 0,
so we get Cov[X, Y] = 0 and hence also ρ(X, Y) = 0. Thus, the correlation is 0, but
we already know that X and Y are dependent random variables.
□
The explanation is that the correlation coefﬁcient measures only the degree of linear
dependence. Thus, if we have a number of observations on (X, Y), the correlation
coefﬁcientmeasureshowwelltheobservationsﬁtastraightline.Ifρ(X, Y) > 0,Xand
Y are said to be positively correlated; if ρ(X, Y) < 0, they are negatively correlated;
and if ρ(X, Y) = 0, they are uncorrelated (see Figure 3.6 for an illustration with
simulated values). We have seen that
X, Y independent ⇒X, Y uncorrelated
but not the converse. In the case of the uniform points in the disk, although X and Y
are dependent, there is no linear dependence (see Figure 3.7 for an illustration with
simulated values). Note how the boundaries of the disk are clear but how there is no
particular straight line that would ﬁt better than any other. Thus, there is no linear
dependence and, in fact, no functional dependence at all.
The following example shows how there can be functional dependence (in this
case quadratic) and how the correlation coefﬁcient can fail to detect it but how the
dependence structure can still be revealed by an appropriate change of random vari-
ables.
Example 3.40. Let X ∼unif[0, 1] and let A be the area of a disk with radius X. What
is ρ(X, A)?

204
JOINT DISTRIBUTIONS
FIGURE 3.7
One hundred simulated points, uniform in a disk. Note how the boundary is
clearly discernible, indicating dependence, but how there is no obvious way to ﬁt a straight
line, indicating uncorrelatedness.
We have E[X] = 1
2, Var[X] = 1
12, and since A = πX2, we get
E[A] = π
 1
0
x2dx = π
3 ,
E[A2] = π2
 1
0
x4dx = π2
5
which gives Var[A] = 4π2/45. We also obtain
E[XA] = πE[X3] = π
 1
0
x3dx = π
4
which gives Cov[X, A] = E[XA] −E[X]E[A] = π/12. We get
ρ(X, A) =
π/12

(1/12) × (4π2/45)
≈0.97
which is certainly high but does not reveal the fact that A is completely determined
by X. However, if we instead compute the correlation coefﬁcient of A and the random
variable Y = X2, we have A = πY, and by Proposition 3.25(c), ρ(A, Y) = 1. Hence,
by changing the random variable, we can view the quadratic dependence on X as
linear dependence on X2 and reveal the completely deterministic relation between X
and A.
□

COVARIANCE AND CORRELATION
205
Example 3.41. If X ∼unif[0, 1] and given X = x, Y ∼unif[0, x], what is ρ(X, Y)?
From previous treatment of this example, we know that the means are
E[X] = 1
2
and
E[Y] = 1
4
and the variances
Var[X] = 1
12
and
Var[Y] =
7
144
so all we need to ﬁnd is the covariance Cov[X, Y] and since
Cov[X, Y] = E[XY] −E[X]E[Y]
all that remains is to compute E[XY]. A direct application of Proposition 3.11 gives
E[XY] =
 1
0
 x
0
xy1
xdy dx = 1
6
which gives the correlation
ρ(X, Y) = 1/6 −(1/2) × (1/4)
√(1/12) × (7/144) ≈0.65
□
The logical next question is “What is a high correlation?” We can understand the
extremes of correlations of 0, −1, or 1 and also values close to them, as in Example
3.40. But how about intermediate values? For example, is the 0.65 we got in the last
example a high correlation? What does it tell us about the strength of the relationship
between X and Y? To come up with an interpretation of the value of ρ, we revisit the
concept of prediction from Section 3.7.2.
Recall how we argued that E[Y|X] is the best predictor of Y, based on observing
X. To compute the conditional expectation, we need to know the joint distribution of
(X, Y). This is not necessarily the case, and even if we do, the calculations may be
intractable. If we restrict our goal to ﬁnding the best linear predictor, that is, of the
form l(X) = aX + b, we need to know only the means, variances, and the correlation
coefﬁcient, as the following result shows.
Proposition 3.26. Let X and Y be random variables with means μX and μY, vari-
ances σ2
X and σ2
Y, and correlation coefﬁcient ρ. The best linear predictor of Y based
on X is
l(X) = μY + ρ σY
σX
(X −μX)

206
JOINT DISTRIBUTIONS
Proof. Suppose ﬁrst that μX = μY = 0 and σ2
X = σ2
Y = 1. The mean square error is
then
E[(Y −(aX + b))2] = E[Y2] + a2E[X2] + b2 −2aE[XY] = 1 + b2 + a(a −2ρ)
which is minimized for b = 0 and a = ρ. For the general case, consider the random
variables (X −μX)/σX and (Y −μY)/σY, which have means 0 and variances 1, and
apply the result we just proved.
■
Thus, for any two random variables X and Y, the correlation coefﬁcient can be re-
garded as a parameter that is chosen so that the relation between X and Y becomes
“as linear as possible.” If we have a number of observations on (X, Y), we can regard
the line y = l(x) as the best linear ﬁt, whereas the curve y = E[Y|X = x] is the best
possible ﬁt among all functions.
Example 3.42. Let X ∼unif[0, 1] and given X = x, let Y ∼unif[0, x2]. Find
E[Y|X = x] and l(x).
It is clear from the description that E[Y|X = x] = x2/2. For l(x), we need to ﬁnd
all the parameters involved in its deﬁnition. We have E[X] = 1
2 and Var[X] = 1
12,
and to ﬁnd the mean of Y, as well as the correlation coefﬁcient, we use conditional
expectations and variances. Since
ρ σY
σX
= Cov[X, Y]
σ2
X
we do not need to compute the variance of Y. We have E[Y|X] = X2/2, which gives
μY = E[Y] = E
X2
2

= 1
2
 1
0
x2dx = 1
6
and for the covariance we also need E[XY], which equals 1
8, by Example 3.31. We
get
Cov[X, Y] = E[XY] −E[X]E[Y] = 1
24
which ﬁnally gives
l(x) = 1
6 + 1/24
1/12

x −1
2

= x
2 −1
12
which is depicted in Figure 3.8 together with E[Y|X = x] and 100 simulated obser-
vations. Overall, the ﬁts are both pretty good, but the detail in Figure 3.8b shows that
the linear ﬁt is poor near the origin.
□
In the previous example, the line l(x) is computed from the values of the parameters
μX, μY, and so on, and we can see how well the line ﬁts the observations. In practice,

COVARIANCE AND CORRELATION
207
0
0.1
0.2
0 
0.02 
0.04 
0
0.5
(a)
(b)
1
0 
0.5 
1 
FIGURE 3.8
(a) One hundred simulated values of (X, Y) in Example 3.42 together with the
curve y = E[Y|X = x] (dashed) and the line y = l(x) (solid). (b) A detail of the region near
the origin.
the situation is usually the reverse; we start from a set of observations, do not know
the values of the parameters, and wish to ﬁnd the straight line that best ﬁts the data.
This means that we are trying to ﬁnd the ideal line l(x) by ﬁnding approximations of
the parameters on the basis of the data. We will return to this relationship between
theory and data in Chapter 6.
We still do not know what a particular value of ρ means, so let us now ﬁnally
address this question. One way to evaluate the linear ﬁt is to compare the variances
of Y and l(X). The random variable Y has a certain variance σ2
Y. If Y is strongly
correlated with X, then Y is closely approximated by the straight line l(X), and most
of the variation in Y can be attributed to variation in X. By computing the variance
of l(X), we get
Var[l(X)] = ρ2 σ2
Y
σ2
X
Var[X] = ρ2σ2
Y
and see that Var[l(X)] ≤Var[Y] always holds. Moreover, we see that
Var[l(X)]
Var[Y]
= ρ2
which gives an interpretation of ρ2; it measures how much of the variation in Y can
be explained by a linear relationship to X. The number ρ2 is called the coefﬁcient of
determination. Hence, a value of ρ = 0.65, as in Example 3.41, gives ρ2 = 0.42 with
the interpretation that X explains about 42% of the variation in Y, whereas the rest is
due to other sources of randomness. The following example is illustrative and good
to remember.
Example 3.43. Roll two fair dice, letting X and Y be the numbers and letting
Z = X + Y, the total number. What is ρ(X, Z)?

208
JOINT DISTRIBUTIONS
First, we ﬁnd the covariance of X and Z. By Proposition 3.22 and Example 2.25, we
have
Cov[X, Z] = Cov[X, X + Y] = Var[X] + Cov[X, Y] = 35
12
sinceXandY areindependentandhenceCov[X, Y] = 0.Furthermore,byProposition
3.13(b)
Var[Z] = Var[X] + Var[Y] = 35
6
and we get
ρ(X, Z) =
Cov[X, Z]
√Var[X]Var[Z] =
1
√
2
and if we square this, we get the coefﬁcient of determination ρ2 = 1
2. Thus, half
the variation in Z is explained by variation in X, which is intuitively clear since
Z = X + Y, where X and Y are independent and on average contribute equally to the
sum (see also Problem 99).
□
Recall from Section 2.5.6 how we can summarize a data set by stating its mean and
variance and how this can be viewed in the context of random variables. The same is
true for the correlation. Given a data set D = {(x1, y1), . . . , (xn, yn)}, we deﬁne its
correlation as
r =
n

k=1
(xk −¯x)(yk −¯y)
(
)
)
*
n

k=1
(xk −¯x)2
n

k=1
(yk −¯y)2
Again, we can think of this as an approximation of the true but unknown correlation,
computed from a set of observations.
Example 3.44. The following data are eight of astronomer Edwin Hubble’s 1929
measurements on a galaxy’s distance from Earth (megaparsecs) and recession
velocity (km/s).
Distance: 0.032, 0.263, 0.45, 0.63, 0.90, 1.00, 1.4, 2.0
Velocity: 170, −70, 200, 200, 650, 920, 500, 850

THE BIVARIATE NORMAL DISTRIBUTION
209
Computing the sums in the expression above gives r = 0.78. We view this as an
approximation of the true value, an approximation that would get better the more data
we have. We will return to Hubble’s data in Chapter 6.
□
It is important to realize that the correlation coefﬁcient does not measure causation,
only association between random variables. This means that even if there is a high
correlation, it does not necessarily follow that large values of one random variable
cause large values of the other, only that such large values tend to appear together.
One amusing example is to let X be the number of ﬁreﬁghters sent to a ﬁre and
Y the economic damage in dollars of the ﬁre. It can then be observed that there is a
positive correlation between X and Y. Conclusion? To keep your economic loss down
in case of a ﬁre, don’t call the ﬁre department? In this case, there is a third variable
that explains the correlation: the size of the ﬁre. The correlation is thus caused by an
underlying factor that affects both X and Y.
A similar effect can also be caused by an intermediate factor, for example, in the
Berkeley admissions data in Example 1.46, where a correlation between gender and
admission rate was demonstrated, but the real cause was that female students applied
for majors that were more difﬁcult to be admitted to. Thus, gender affected the choice
of major, which in turn affected the chance of being admitted.
3.9
THE BIVARIATE NORMAL DISTRIBUTION
In Section 2.7, the importance of the normal distribution was pointed out. In this
section, its two-dimensional analog is introduced.
Deﬁnition 3.18. If (X, Y) has joint pdf
f(x, y) =
1
2πσ1σ2

1 −ρ2
× exp

−
1
2(1 −ρ2)
(x −μ1)2
σ2
1
+ (y −μ2)2
σ2
2
−2ρ(x −μ1)(y −μ2)
σ1σ2

for x, y ∈R, then (X, Y) is said to have a bivariate normal distribution.
The formula is ugly, but the pdf itself is beautiful (see Figure 3.9). The bivariate
normal distribution has ﬁve parameters: μ1, μ2 ∈R, σ1, σ2 > 0, and −1 < ρ < 1.
The center of the bell in Figure 3.9 is above the point (μ1, μ2), and its shape is
determined by the other three parameters. The notation suggests that these are means,
variances, and the correlation coefﬁcient of X and Y, but we need to prove that this
is actually the case.

210
JOINT DISTRIBUTIONS
FIGURE 3.9
The joint pdf of a bivariate normal distribution.
Proposition 3.27. Let (X, Y) have a bivariate normal distribution with parameters
μ1, μ2, σ1, σ2, ρ. Then
(a) X ∼N(μ1, σ2
1) and Y ∼N(μ2, σ2
2)
(b) ρ is the correlation coefﬁcient of X and Y
Proof. (a) Let f(x, y) be the joint pdf of (X, Y). To ﬁnd the pdf of X, we need
to integrate the joint pdf with respect to y. We ﬁrst make the change of variables
u = (x −μ1)/σ1 and v = (y −μ2)/σ2, so that dy = σ2 dv and the integral limits
remain −∞and ∞. We get
fX(x) =
 ∞
−∞
f(x, y)dy
=
1
2πσ1

1 −ρ2
 ∞
−∞
exp

−
1
2(1 −ρ2)(u2 + v2 −2ρuv)

dv
Now note that u2 + v2 −2ρuv = (v −ρu)2 + u2(1 −ρ2) and hence
fX(x) =
1
σ1
√
2π
exp

−u2
2

×
 ∞
−∞
1

1 −ρ2√
2π
exp

−
1
2(1 −ρ2)(v −ρu)2

dv

THE BIVARIATE NORMAL DISTRIBUTION
211
(a)
(b)
(c)
FIGURE 3.10
Simulated observations from bivariate normal distributions: (a) ρ = 0,
σ2
1 = σ2
2; (b) ρ = 0, σ2
2 > σ2
1; (c) ρ < 0.
Now note that the integrand in the last integral is the pdf of a normal distribution with
mean ρu and variance 1 −ρ2, and hence this integral equals 1. Finally, substituting
back u = (x −μ1)/σ1 gives
fX(x) =
1
σ1
√
2π
exp

−(x −μ1)2
2σ2
1

which we recognize as the pdf of a normal distribution with mean μ1 and variance
σ2
1. We prove (b) in Example 3.45.
■
It is instructive to consider the contours of the joint pdf, that is, the sets of points
(x, y) for which f(x, y) equals some ﬁxed constant. These contours are ellipses that
reﬂect how observations are typically spread in the plane. Such an ellipse is centered
in (μ1, μ2), and its shape and direction depend on the other parameters. If ρ = 0, the
ellipse is parallel to the axes, and if, in addition, σ2
1 = σ2
2, it is in fact a circle (see Fig-
ure 3.10 for an illustration of some different cases). Each plot shows 100 simulated ob-
servations from a bivariate normal distribution, displayed together with two contours.
We have seen that a bivariate normal distribution has normal marginals. Is the
converse also true; that is, if X and Y are normal, then the pair (X, Y) is bivariate
normal? The answer is “almost,” but if Y is a linear function of X, the pair (X, Y)
is concentrated on a straight line and there is no joint pdf. We can also see this in
the expression for f(x, y) above since ρ would then be −1 or 1. It is also possible to
construct a nonnormal joint pdf such that both marginals are normal, but this is not
of much practical interest and we will not address it further. A nice property of the
bivariate normal distribution is that not only the marginals but also the conditional
distributions are normal.
Proposition 3.28. Let (X, Y) be bivariate normal. Then, for ﬁxed x ∈R
Y|X = x ∼N

μ2 + ρσ2
σ1
(x −μ1), σ2
2(1 −ρ2)


212
JOINT DISTRIBUTIONS
Proof. Carry out the division in
fY(y|x) = f(x, y)
fX(x)
and identify the expression with the desired normal pdf.
■
Note that Proposition 3.28 states that
E[Y|X] = μ2 + ρσ2
σ1
(X −μ1)
which we note is a linear function of X. Hence, in the case of a bivariate normal
distribution, the best predictor of Y given X is linear (see also Proposition 3.26). This
indicates that the dependence that exists between X and Y can be attributed to linear
dependence, and the following result shows that this is indeed so.
Proposition 3.29. Let (X, Y) be bivariate normal. Then X and Y are independent
if and only if they are uncorrelated.
Proof. Simply note that the joint pdf equals the product of the marginal pdfs if and
only if ρ = 0.
■
This is a convenient result since it says that if we cannot ﬁnd any linear depen-
dence structure in observations that are bivariate normal, then there is no dependence
structure at all. Another ramiﬁcation of Proposition 3.28 is that we can easily prove
Proposition 3.27(b) that ρ is the correlation coefﬁcient of X and Y.
Example 3.45. Let (X, Y) be bivariate normal. Show that ρ(X, Y) = ρ.
First, let Z and W be standard normal. By Corollaries 3.5 and 3.6, we obtain
Cov[Z, W] = E[ZW] = E

E[ZW|Z]

= E

ZE[W|Z]

= ρE[Z2] = ρ
and since both variances are 1, this is also the correlation coefﬁcient. Next, consider
the random variables X = μ1 + σ1Z and Y = μ2 + σ2W. Then X ∼N(μ1, σ2
1) and
Y ∼N(μ2, σ2
2), and since
Cov[X, Y] = Cov[X −μ1, Y −μ2]
we get
ρ(X, Y) = ρ(σ1Z, σ2W) = ρ(Z, W) = ρ
□

THE BIVARIATE NORMAL DISTRIBUTION
213
Example 3.46. At a measuring station for air pollutants, the amounts of ozone and
carbon particles are recorded at noon every day. Let X be the concentration of car-
bon (g/m3) and Y the concentration of ozone (ppm), and suppose that (X, Y) has
a bivariate normal distribution such that X ∼N(10.7, 29.0), Y ∼N(0.1, 0.02), and
ρ = 0.72. The ozone level is considered unhealthy if it exceeds 0.30. Suppose that
the equipment used to measure ozone fails, so we can measure only the carbon level.
If this turns out to be 20.0 g/m3, what is (a) the predicted ozone level and (b) the
probability that the ozone level is unhealthy?
We have observed X = 20.0. For (a), we need to ﬁnd E[Y|X = 20]. From Proposition
3.28, we know that Y is normal with mean
E[Y|X = 20] = 0.1 + 0.72
√
0.02
√
29.0
(20 −10.7) ≈0.28
so this is the predicted ozone level asked for in part (a). For (b), we wish to ﬁnd the
probability
P(Y > 0.30|X = 20.0)
and also need the conditional variance, which is
Var[Y|X = 20] = 0.02(1 −0.722) ≈0.01
which gives
P(Y > 0.30|X = 20.0) = 1 −P(Y ≤0.30|X = 20)
= 1 −
0.30 −0.28
√
0.01

≈0.42
□
The line
y = E[Y|X = x] = μ2 + ρσ2
σ1
(x −μ1)
is called the regression line. For an observed value X = x, it is the best predicted
value of y, in the sense discussed in Section 3.7.2. It might be tempting to believe
that the regression line is an axis of the ellipses describing the pdf, but this is not
the case. The reason is probably best understood by considering a plot of observed
values. Figure 3.11 shows 500 simulated values from a bivariate normal distribution
with means 0, variances 1, and correlation ρ = 0.5. The major axis is the dashed line
y = x and the regression line, the solid line y = 0.5x. Since the regression line in a
point x is the conditional mean of Y, given X = x, it has roughly the same number
of points above and below for any given x. Look, for example, at x in the vicinity of
2. Note how the regression line cuts through the points roughly in the middle, and
compare with the ellipse axis, which is entirely above all the points.

214
JOINT DISTRIBUTIONS
−2
0
2
−3
−2
−1
0
1
2
3
FIGURE 3.11
Simulated observations on (X, Y), with the corresponding regression line
(solid) and major ellipse axis (dashed).
There is an interesting observation to be made here. Suppose, for example, that the
points represent standardized test scores (μ = 0, σ = 1) for students where X is the
score on the ﬁrst test and Y the score on the second. The positive correlation reﬂects
that students with high scores on one test are expected to have high scores on the
other as well. Now consider students with good scores on the ﬁrst test, say, above 1.
On the second test, most of them did worse! What happened? Well, this is completely
normal. If your test score is X = 1 on the ﬁrst test, your predicted score on the second
test is E[Y|X = 1] = 0.5. In the same way, those who did poorly on the ﬁrst test are
expected to do better on the second. It is important to understand that such changes
are natural and do not necessarily indicate anything in particular. The phenomenon
is called regression to the mean4 and is frequently misinterpreted.
By working through more tedious calculations, it can be shown that linear combi-
nations are also normal. More speciﬁcally, consider the following proposition.
Proposition 3.30. Let (X, Y) be bivariate normal and let a and b be real numbers.
Then
aX + bY ∼N
	
aμ1 + bμ2, a2σ2
1 + b2σ2
2 + 2abρσ1σ2

In particular, if X and Y are independent, this leads to the following corollary.
4The British aristocrat and scientist Sir Francis Galton, who was one of the ﬁrst to use linear regression
methods, used the term “regression to mediocrity.”

THE BIVARIATE NORMAL DISTRIBUTION
215
Corollary 3.9. If X ∼N(μ1, σ2
1), Y ∼N(μ2, σ2
2), and X and Y are independent,
then
aX + bY ∼N
	
aμ1 + bμ2, a2σ2
1 + b2σ2
2

The noteworthy property of the bivariate normal distribution is not that the means
and variances add the way as they do; we know that this holds generally. What is
noteworthy is that the normal distribution is retained by taking a linear combination
of X and Y, independent or not. This is not true for most distributions; for example,
the uniform and exponential distributions do not have this property. With induction,
we get the following immediate extension.
Corollary 3.10.
If X1, . . . , Xn are independent with Xk ∼N(μk, σ2
k) and
a1, . . . , an are constants, then
n

k=1
akXk ∼N
 n

k=1
akμk,
n

k=1
a2
kσ2
k

Example 3.47. Two different types of diets are used on a salmon farm. Suppose
that one group of ﬁsh is given diet A and the other diet B. To check if there is a
difference in weights, n salmon from each group are weighed, and the average weight
is computed for each group. Suppose that the weights are N(20, 5) and N(18, 4)
(kilograms) in the two groups. How large must n be in order for us to be at least 99%
certain to determine that diet A yields bigger salmon?
Call the weights X1, . . . , Xn and Y1, . . . , Yn, and let ¯X and ¯Y be the two averages.
Corollary 3.10 with a1 = · · · = an = 1
n gives
¯X ∼N

20, 5
n

and
¯Y ∼N

18, 4
n

and Corollary 3.9 with a = 1, b = −1 gives
¯X −¯Y ∼N

2, 9
n

We get
0.99 ≤P( ¯X ≥¯Y) = P( ¯X −¯Y ≥0) = 1 −
 0 −2
3/√n

= 

2
3/√n

which gives 2√n/3 ≥2.33, so n must be at least 13.
□

216
JOINT DISTRIBUTIONS
3.10
MULTIDIMENSIONAL RANDOM VECTORS
Everything we have done for two-dimensional random variables in the previous sec-
tions generalizes in an obvious way to n dimensions as well. Thus, if X1, . . . , Xn are
random variables, we call (X1, . . . , Xn) an n-dimensional random vector. If the Xk
are discrete, we deﬁne the joint pmf as p(x1, . . . , xn) = P(X1 = x1, . . . , Xn = xn),
and if there is a function f : Rn →R such that
P((X1, . . . , Xn) ∈B) =

· · ·

B
f(x1, . . . , xn)dx1 · · · dxn
for sets B ∈Rn, then X1, . . . , Xn are said to be jointly continuous with joint pdf f.
The joint cdf is deﬁned as
F(x1, . . . , xn) = P(X1 ≤x1, . . . , Xn ≤xn)
and we have the relations
F(x1, . . . , xn) =
 xn
−∞
· · ·
 x1
−∞
f(t1, . . . , tn)dt1 · · · dtn
and
f(x1, . . . , xn) =
∂n
∂x1 · · · ∂xn
F(x1, . . . , xn)
for x1, . . . , xn ∈R, in the jointly continuous case. The marginals for the Xk are ob-
tained by summing the joint pmf or integrating the joint pdf over other variables. Note,
however, that when n ≥3, we also get “multidimensional marginals,” for example,
the joint distribution of (X, Y) when we start from (X, Y, Z). Independence between
random variables now means that all possible joint distributions are products of the
possible marginals.
Rather than stating formal multidimensional analogs of the two-dimensional re-
sults, we illustrate these in an example that deals with a uniform distribution in three
dimensions.
Example 3.48. Suppose that we choose a point (X, Y, Z) uniformly in the unit sphere
{(x, y, z) : x2 + y2 + z2 ≤1}. By an argument similar to that for the uniform distri-
bution in one or two dimensions, we must have the joint pdf
f(x, y, z) = 3
4π,
x2 + y2 + z2 ≤1
since the volume of the sphere is 4π/3. We might now wonder what the joint distri-
bution of X and Y is. Is it the uniform distribution on the unit disk in the (x, y) plane?
We need to integrate over z, so let us ﬁrst note that for ﬁxed x and y, z ranges from

MULTIDIMENSIONAL RANDOM VECTORS
217
−

1 −x2 −y2 to

1 −x2 −y2 and we get
f(X,Y)(x, y) = 3
4π
 √
1−x2−y2
−√
1−x2−y2 dz = 3
2π

1 −x2 −y2,
x2 + y2 ≤1
which is certainly not a uniform distribution. The intuition is that a region of ﬁxed
size in the (x, y) plane is more probable if it is near the origin (0, 0) because it then
corresponds to a larger volume to pick (X, Y, Z) from. With the experience from
Example 3.6, this was to be expected. We also expect that the conditional distribution
of (X, Y) given Z = z is uniform on the disk with radius
√
1 −z2. Let us verify this.
The conditional pdf of (X, Y) given Z = z is deﬁned in the obvious way:
f(X,Y)(x, y|z) = f(x, y, z)
fZ(z)
, x2 + y2 ≤1 −z2
and we must thus ﬁnd the marginal pdf fZ(z). We get
fZ(z) =
 
x2+y2≤1−z2 f(x, y, z)dx dy = 3
4π
 
x2+y2≤1−z2 dx dy
where we change to polar coordinates to obtain
fZ(z) = 3
4π
 2π
0
 √
1−z2
0
r dr dθ
= 3
4π × 2π
r2
2
√
1−z2
0
= 3
4(1 −z2), −1 ≤z ≤1
We now get
f(X,Y)(x, y|z) =
1
π(1 −z2), x2 + y2 ≤1 −z2
and it is reassuring to note that this is indeed a uniform distribution on the disk with
center 0 and radius
√
1 −z2.
□
If the random variables X1, X2, . . . can be regarded as repeated measurements on
some quantity, they can be assumed to be independent, and they also all have the
same distribution. If this is the case, we use the following terminology.
Deﬁnition 3.19. If X1, X2, . . . are independent and have the same distribution, we
say that they are independent and identically distributed or i.i.d. for short.
Example 3.49 (Waiting Time Paradox). Bob often catches a bus from a street corner
to go downtown. He arrives at different timepoints during the day but has estimated
that his average wait is 17 min. His friend Joe, who can see the bus stop from his

218
JOINT DISTRIBUTIONS
living room window, assures Bob that the buses run on average every half hour. But
then Bob’s average wait ought to be 15 min, not 17. Explain!
This is an example of the waiting time paradox and the explanation is simple. The
times between consecutive arrivals are i.i.d. random variables with mean 30 min. If
Bob arrives at an arbitrary timepoint, he is more likely to arrive in a time interval
between buses that is longer than usual. For example, suppose that three consecutive
buses arrive at 1:00, 1:40, and 2:00. The time intervals are 40 and 20 min, which have
the average 30 min. However, if Bob arrives at a uniform time between 1:00 and 2:00,
the probability that he arrives in the ﬁrst interval is 2
3, in which case his expected
wait is 20 min and with probability 1
3, his expected wait is 10 min. This gives the
expected wait 20 × 2
3 + 10 × 1
3 ≈17 min. Hence, it is perfectly normal that buses
run on average every half hour, but Bob’s expected wait is more than 15 min.
□
Call the times between successive arrivals in the example T1, T2, . . ., which are i.i.d.
random variables. This is an example of a renewal process. Now let μ = E[T], the
mean interarrival time, and consider the time T ′ until the next arrival at some arbitrary
timepoint t. We argued above that E[T ′] does not equal μ/2. It can be shown that for
large t (the process has been going on for a while), this expected time is
E[T ′] = E[T 2]
2μ
For example, if the Tk are uniform [0, 1], the mean is μ = 1
2 and E[T 2] = 1
3, which
gives E[T ′] = 1
3. Note that this means that the expected length of the interval that
contains t is E[T 2]/μ, which is reminiscent of the size-biased distributions studied
in Problems 32 and 33 in Chapter 2. If you sample a person at random, this person
is more likely to belong to a large family. If you arrive at random at a bus stop, you
are more likely to arrive in a long time interval and we might call this a length-biased
distribution.
3.10.1
Order Statistics
As we know from many applications and real-life situations, it is often of practical
interest to order observations by size. In terms of random variables, we have the
following deﬁnition.
Deﬁnition 3.20. Let X1, . . . , Xn be independent and denote by X(j) the jth smallest
of the Xk. The random variables X(1) ≤X(2) ≤· · · ≤X(n) are called the order
statistics of the random variables X1, . . . , Xn.
Note that Xk are independent but X(k) are obviously not. Of particular interest are
X(1) and X(n), the smallest and largest of Xk.

MULTIDIMENSIONAL RANDOM VECTORS
219
Example 3.50. Let X1, . . . , Xn be independent where Xk ∼exp(λk), k = 1, . . . , n.
What is the distribution of X(1)?
First note that X(1) > x if and only if X1 > x, X2 > x, . . . , Xn > x. Hence, using
independence, we obtain
P(X(1) > x) = P(X1 > x, . . . , Xn > x)
= P(X1 > x) · · · P(Xn > x)
= e−λ1x · · · e−λnx = e−(λ1+···+λn)x, x ≥0
which gives the cdf
FX(1)(x) = 1 −e−(λ1+···+λn)x, x ≥0
which we recognize from Section 2.8.2 as the cdf of an exponential distribution with
parameter λ1 + · · · + λn. Hence,
X(1) ∼exp(λ1 + · · · + λn)
□
Example 3.51. Recall Example 2.40, where the concept of half-life of a radioactive
material was ﬁrst introduced informally as the time required until half the atoms
have decayed and then deﬁned as the median lifetime of an individual atom. Let us
now examine this more closely.
Suppose that we start from a number 2n of atoms. The half-life is then the time it
takes until we have n atoms left. If we assume that lifetimes are i.i.d. exp(λ) for some
λ, the time until the ﬁrst decay is T(1), the minimum of 2n exponentials. We then start
over with 2n −1 atoms and wait for the next decay. The time until this is T(2), which
by the memoryless property is the minimum of 2n −1 exponentials (note that this
is also the second smallest among the original 2n lifetimes if T(1) is subtracted from
all of them, and hence the subscript). The time until half the atoms have decayed is
then
T =
n

k=1
T(k)
which is a random time. To describe this by a number, we deﬁne half-life as the
expected time until half the atoms have decayed:
h = E[T]
Now, by Example 3.50, T(1) ∼exp(2nλ), . . . , T(n) ∼exp((n + 1)λ), which gives
h =
n

k=1
E[T(k)] = 1
λ
2n

k=n+1
1
k = 1
λ
 2n

k=1
1
k −
n

k=1
1
k


220
JOINT DISTRIBUTIONS
It is a well-known result that the harmonic series Hn = 1 + 1
2 + · · · + 1
n is approxi-
mately equal to log n for large n, and we get5
h ≈1
λ(log(2n) −log n) = 1
λ log 2
which is precisely the median of T. Thus, if the radioactive sample is large, the
interpretation of half-life as the median in the individual lifetime distribution works
ﬁne. However, as the sample gets smaller, this becomes less and less accurate and
the decay tends to speed up. Consider the extreme case when only two atoms remain.
The time until only one is left is then the minimum of two exponentials, which gives
h = 1/(2λ), which is smaller than the median log 2/λ.
□
The deﬁnition of half-life as “the time until half the atoms have decayed” is a
deterministic description, and our approach with exponential lifetimes is probabilistic
(or stochastic). We have seen that they agree when the number of atoms is large, but
only the probabilistic description is accurate for small numbers.
If the random variables are not just independent but also have the same distribu-
tion, there are some nice and simple formulas for the distribution of individual order
statistics, as well as their joint distribution. We start by a result that gives the cdfs of
the minimum and the maximum.
Proposition 3.31. Let X1, . . . , Xn be i.i.d. with cdf F. Then X(1) and X(n) have
cdfs
F(1)(x) = 1 −(1 −F(x))n,
x ∈R
F(n)(x) = F(x)n,
x ∈R
Proof. We do the maximum and leave the minimum as an exercise. First note that
{X(n) ≤x} = {X1 ≤x, . . . , Xn ≤x}
that is, the maximum is less than or equal to x if and only if all the Xk are less than
or equal to x. We get
F(n)(x) = P(X(n) ≤x) = P(X1 ≤x, . . . , Xn ≤x)
= P(X1 ≤x) · · · P(Xn ≤x) = F(x)n, x ∈R
where the second to last equality is due to independence of the Xk. For the minimum,
instead start with the event {X(1) > x}.
■
5The exact result is that the difference between the harmonic series Hn and log n approaches a number γ
as n →∞. The number γ is known as Euler’s constant and is approximately equal to 0.58.

MULTIDIMENSIONAL RANDOM VECTORS
221
This result is valid for both discrete and continuous random variables, but there are
some differences between the two cases when it comes to more properties of order
statistics. In the discrete case, we may get duplicate values, and the order statistics are
not necessarily unique. Thus, we can, for example, have maximum values attained
at two or more different Xk, and computing the joint pmf of the order statistics
is complicated by this fact. In the continuous case, however, duplicate values are
impossible (recall from Section 3.4 that P(Xj = Xk) = 0 for all j /= k), so there is
only one possible set of order statistics.
Example 3.52. You are selling your car and receive consecutive bids. The bidders do
not know each other’s bids and for each bid you need to decide immediately whether
or not to take it. If you decline, you cannot accept the offer later. Your strategy is to
decline the very ﬁrst bid, and then accept the ﬁrst bid that is larger. How long can
you expect to wait?
Let us assume that the consecutive bids, X1, X2, . . ., are i.i.d. continuous random
variables. You are thus waiting for the ﬁrst time n such that
X1 > X2, . . . , X1 > Xn−1, X1 < Xn
which means that Xn is the largest and X1 the second largest among the Xk. We thus
deﬁne
N = min{n : X(n) = Xn, X(n−1) = X1}
and wish to ﬁnd E[N]. The assumption of continuous Xk means that all Xk are
different from each other, and since they are i.i.d., each Xk is equally likely to be the
maximum. Once a maximum is decided, each of the remaining Xk is equally likely
to be the second largest. Hence, the probability that N equals a particular n is
P(N = n) = P(X(n) = Xn, X(n−1) = X1)
= P(X(n−1) = X1|X(n) = Xn)P(X(n) = Xn)
=
1
n −1 × 1
n =
1
n(n −1), n = 2, 3, . . .
and the expected value of N is
E[N] =
∞

n=2
nP(N = n) =
∞

n=2
1
n −1 = ∞
so you can deﬁnitely expect to wait for a long time! See Problem 109 for a strategy
that enables you to sell your car faster.
□
In the continuous case, it turns out that it is easy to ﬁnd the marginal pdf of the order
statistics as well as their joint pdf. We start by the following corollary, which follows
immediately by differentiating the expressions in Proposition 3.31.

222
JOINT DISTRIBUTIONS
Corollary 3.11. Let X1, . . . , Xn be i.i.d. and continuous with pdf f and cdf F.
Then X(1) and X(n) have pdf’s
f(1)(x) = nf(x)(1 −F(x))n−1
and
f(n)(x) = nf(x)F(x)n−1
for x ∈R.
In Problem 113, you are asked to ﬁnd the pdfs for the remaining order statistics. In the
case of i.i.d. continuous random variables, we can easily ﬁnd not only the marginals
but also the entire joint distribution of the order statistics.
Proposition 3.32. Let X1, X2, . . . , Xn be i.i.d. and continuous with the common
pdf fX. Then the vector of order statistics (X(1), X(2), . . . , X(n)) has joint pdf
f(x1, x2, . . . , xn) = n! fX(x1)fX(x2) · · · fX(xn)
for −∞< x1 ≤x2 ≤· · · ≤xn < ∞
The intuition behind the expression in the proposition is quite clear if we skip the
strict deﬁnition of the joint pdf for a moment and instead think of it as a proba-
bility. Then, the “probability” that the ordered Xk values equal the particular vec-
tor (x1, x2, . . . , xn) is simply the “probability” that the unordered random variables
X1, X2, . . . , Xn equal the numbers x1, x2, . . . , , xn in any order. Since there are n!
different ways to order these numbers and the “probability” of any particular order is
fX(x1)fX(x2) · · · fX(xn), the expression follows.
Proof. We will do the proof only in the case n = 2. Thus, ﬁx x ≤y and consider the
joint cdf of (X(1), X(2)):
F(x, y) = P(X(1) ≤x, X(2) ≤y),
x ≤y
In terms of the unordered X1 and X2, this means that both must be less than or equal
to y but that at most one can be between x and y. Denoting the cdf of Xk by FX, we
thus get
F(x, y) = P(X1 ≤y, X2 ≤y) −P(x < X1 ≤y, x < X2 ≤y)
= FX(y)2 −(FX(y) −FX(x))2
which we differentiate twice to get the joint pdf of (X(1), X(2)):
f(x, y) =
∂2
∂x ∂y
	
FX(y)2 −(FX(y) −FX(x))2
= d
dy2(FX(y) −FX(x))fX(x) = 2fX(y)fX(x)

MULTIDIMENSIONAL RANDOM VECTORS
223
as desired. The general case is proved in the same way, only keeping track of more
different cases.
■
3.10.2
Reliability Theory
Recall Example 1.42, where we deﬁned the reliability of a system as the probability
that it functions, given that its components function independent of each other. We
will now instead consider this as a process in time. Thus, suppose that each component
has a random lifetime that has some continuous distribution and consider the time T
until failure of the system. Let us ﬁrst consider the case of two components.
Example 3.53. Suppose that the individual lifetimes are T1 and T2, which are i.i.d.
continuous and nonnegative random variables with pdf f and cdf F. What is the pdf
of the lifetime T for a series system and for a parallel system?
Since a series system functions as long as both components function, the time until
failure is the minimum of T1 and T2. Hence, by Corollary 3.11
fT (x) = 2f(x)(1 −F(x)), x ≥0
The parallel system functions as long as at least one component functions, and hence
T = T(2), the largest of T1 and T2. We get
fT (x) = 2f(x)F(x), x ≥0
(see Figure 3.12). In particular, if we assume that lifetimes are exp(λ), we get
fT (x) = 2λe−2λx, x ≥0
for the series system and
fT (x) = 2λ(e−λx −e−2λx), x ≥0
for the parallel system. Note how the lifetime for the series system is exp(2λ) (see
also Problem 112).
□
T = min(T1; T2)
T1
T2
T2
T1
T = max(T1; T2)
FIGURE 3.12
Systems in series and parallel.

224
JOINT DISTRIBUTIONS
Example 3.54. Recall the failure rate function from Section 2.10. Consider a series
system where the kth component has failure rate function rk and components function
independent of each other. What is the failure rate function of the system?
Denote the lifetimes by X1, . . . , Xn, and let the corresponding survival functions be
G1, . . . , Gn. Then the lifetime of the system is the minimum X(1), whose survival
function and failure rate function we denote by G(1) and r(1), respectively. We get
G(1)(t) = P(X1 > t, . . . , Xn > t) = G1(t) · · · Gn(t)
by independence. By Proposition 2.25, we obtain
G(1)(t) =
n
 
k=1
exp

−
 t
0
rk(u)du

= exp

−
 t
0
n

k=1
rk(u)du

and also since
G(1)(t) = exp

−
 t
0
r(1)(u)du

we identify the exponents to conclude that
r(1)(u) =
n

k=1
rk(u), u ≥0
Note how Example 3.50 was a special case of this for exponential lifetimes.
□
Example 3.55. In Example 2.53, we considered a type of ball bearing whose failure
rate function r(t) = at was chosen to describe an increasing risk of failure due
to continuing wear and tear. Now suppose that in addition to this, a ball bearing
may also suddenly break as a result of external factors such as explosions or other
accidents, which occur at random. What failure rate function does this give?
We need to interpret the expression “at random.” If we assume that this means that
the time until the next accident is independent of the age of the ball bearing, then the
time until failure because of an accident is exponential with some parameter b > 0.
Thus, if we denote the time until failure due to wear by T1 and the time until failure
due to an accident by T2, the time T until failure of the ball bearing satisﬁes
T = min(T1, T2)
where T1 and T2 are independent. By Example 3.54, T has failure rate function
rT (t) = rT1(t) + rT2(t) = at + b, t ≥0
Adding a constant to a failure rate function thus corresponds to introducing failure
due to random incidents.
□

MULTIDIMENSIONAL RANDOM VECTORS
225
3.10.3
The Multinomial Distribution
Recall how the binomial distribution counts the number of successes in n independent
trials, where each trial can result in success or failure. An immediate extension of this
is to consider the case where each trial has more than two different outcomes. For
example, consider a soccer match and the three outcomes “win,” “loss,” and “tie”
for the home team. Suppose that we consider n matches and that we let the vector
(W, L, T) be the numbers of wins, losses, and ties, respectively. What is the joint
distribution of (W, L, T), expressed in terms of n and the probabilities p = P(W),
q = P(L), and r = P(T)? Let us consider the joint pmf in a point (w, l, t), that is,
p(w, l, t) = P(W = w, L = l, T = t)
where w + l + t = n and the probabilities p, q and r add to one. First note that each
conﬁguration of w wins, l losses, and t ties has probability pwqlrt, so the issue is how
many such conﬁgurations are there. First, there are
+n
w
,
ways to choose positions for
the w wins. For each such choice, there are then
+n−w
l
,
ways to choose positions for
the l losses. Once this is done, the t ties are put in the remaining positions. Hence, the
probability is
p(w, l, t) =
n
w
n −w
l

pwqlrt
for w ≥0, l ≥0, t ≥0 and w + l + t = n. Now note that
n
w
n −w
l

=
n!
w!(n −w)! ×
(n −w)!
l! (n −w −l)! =
n!
w! l! t!
a quantity that is called the multinomial coefﬁcient. We generalize to r dimensions.
Deﬁnition 3.21. If (X1, . . . , Xr) has joint pmf
p(n1, . . . , nr) =
n!
n1! n2! · · · nr!pn1
1 pn2
2 · · · pnr
r
for n1 + · · · + nr = n and p1 + · · · + pr = 1, then (X1, . . . , Xr) is said to have a
multinomial distribution with parameters (n, p1, . . . , pr).
Note that the binomial distribution is a special case with r = 2, p1 = p, and p2 =
1 −p.
Example 3.56. Roll a die 12 times. What is the probability that you get exactly two
of each number 1, . . . , 6?

226
JOINT DISTRIBUTIONS
With Xk = the number of k values, we have a multinomial distribution with r = 6
and parameters (12, 1
6, 1
6, . . . , 1
6) and get
p(2, 2, . . . , 2) =
12!
2! 2! · · · 2!
1
6
2 1
6
2
· · ·
1
6
2
≈0.003
□
What are the one-dimensional marginal distributions in a multinomial distribution? If
we consider Xk, this is the number of times we get the kth outcome, and it is easy to
realize that the distribution of Xk is binomial with parameters n and pk. To prove this
formally, we would have to sum over all the other variables in the joint pmf, but we
will not do this. Thus, each Xk is binomial when considered individually, but clearly
Xk are not independent; for example, P(X1 = n) = pn
1, but P(X1 = n|X2 > 0) = 0.
In Problem 124, you are asked to ﬁnd the covariance and correlation.
3.10.4
The Multivariate Normal Distribution
In Section 3.9, we introduced the bivariate normal distribution. Notice how the expo-
nent in Deﬁnition 3.18 is a quadratic form, which we will now rewrite in convenient
matrix notation. Introduce the column vectors
X =

X
Y

and
x =

x
y

for x, y ∈R
and deﬁne the mean vector μ and covariance matrix  as
μ =

μ1
μ2

and
 =

σ2
1
ρσ1σ2
ρσ1σ2 σ2
2

Note that all entries in  are covariances, since Cov[X, Y] = Cov[Y, X] = ρσ1σ2,
Cov[X, X] = Var[X] = σ2
1, and Cov[Y, Y] = σ2
2. The covariance matrix has determi-
nant
|| = σ2
1σ2
2 −ρ2σ2
1σ2
2 = σ2
1σ2
2(1 −ρ2)
and inverse
−1 =
1
σ2
1σ2
2(1 −ρ2)

σ2
2
−ρσ1σ2
−ρσ1σ2 σ2
1


MULTIDIMENSIONAL RANDOM VECTORS
227
and we get, with the superscript T denoting matrix transposition,
(x −μ)T −1(x −μ)
=
1
1 −ρ2
(x −μ1)2
σ2
1
+ (y −μ2)2
σ2
2
−2ρ(x −μ1)(y −μ2)
σ1σ2

and taken altogether, we can write the joint pdf of the bivariate normal distribution as
fX(x) =
1
2π√|| exp

−1
2(x −μ)T −1(x −μ)

, x ∈R2
We can now generalize and deﬁne an n-dimensional multivariate normal distribution.
Let X1, X2, . . . , Xn be random variables with means μ1, μ2, . . . , μn, and let
X =
⎛
⎜
⎜
⎜
⎜
⎝
X1
X2
...
Xn
⎞
⎟
⎟
⎟
⎟
⎠
and
μ =
⎛
⎜
⎜
⎜
⎜
⎝
μ1
μ2
...
μn
⎞
⎟
⎟
⎟
⎟
⎠
Furthermore, let  be a n × n matrix where the (i, j)th entry is ij = Cov[Xi, Xj].
This means that the diagonal elements are the variances of the Xi and the off-diagonal
elements can be written as ij = ρσiσj.
Deﬁnition 3.22. If X has n-dimensional joint pdf
f(x) =
1
√(2π)n|| exp

−1
2(x −μ)T −1(x −μ)

for x = (x1, x2, . . . , xn)T ∈Rn, it is said to have a multivariate normal distribution
with parameters μ and , written X ∼Nn(μ, ).
As in the bivariate case, marginals are normal, keeping in mind that marginals can now
themselves be multidimensional. Linear combinations and conditional distributions
are also normal.
3.10.5
Convolution
We have seen how to ﬁnd the expected value and variance of a sum of random
variables. Sometimes, we want to know more, and in the case of independent random
variables, it turns out that we can establish nice formulas for the entire distribution
of their sum. We will start with the discrete case, for which we already possess the
necessary tools.

228
JOINT DISTRIBUTIONS
Let us start by examining random variables with ﬁnite ranges. Suppose that X and
Y are independent discrete random variables, both with range {1, 2, . . . , n} and pmfs
pX and pY, respectively. We wish to ﬁnd the pmf of the sum X + Y. First, note that
the range of X + Y is {2, 3, . . . , 2n}, take a value k in this range, and apply the law
of total probability to obtain
P(X + Y = k) =
n

j=1
P(X + Y = k|X = j)P(X = j)
=
n

j=1
P(Y = k −j|X = j)P(X = j)
=
n

j=1
P(Y = k −j)P(X = j)
where we used the independence of X and Y in the last equality. In terms of the pmfs,
we have thus shown that
pX+Y(k) =
n

j=1
pY(k −j)pX(j),
k = 2, 3, . . . , 2n
This is called the convolution of the two pmfs pX and pY. The assumption of ﬁnite
range was made only to simplify things a little, but it does not change anything vital,
and we have the following general result.
Proposition 3.33. Let X and Y be independent discrete random variables, with
ranges {x1, x2, . . .} and {y1, y2, . . .}, respectively, and pmfs pX and pY. The sum
X + Y then has pmf
pX+Y(x) =
∞

j=1
pY(x −xj)pX(xj)
for x in the range of X + Y
Once we have established the formula in the discrete case, we can guess that the
corresponding formula in the continuous case is similar, with pdfs instead of pmfs
and that the sum is replaced by an integral.
Proposition 3.34. Let X and Y be independent continuous random variables with
pdfs fX and fY, respectively. The pdf of the sum X + Y is then
fX+Y(x) =
 ∞
−∞
fY(x −u)fX(u)du,
x ∈R

MULTIDIMENSIONAL RANDOM VECTORS
229
For a formal proof, start with the cdf of X + Y and use Corollary 3.2 to express this
as an integral involving FY and fX. It can be shown that it is allowed to interchange
differentiation and integration; use this fact to obtain the pdf of X + Y and ﬁnish the
proof.
Just as in the discrete case, this is called the convolution of fX and fY. The actual
limits of the integral are determined according to where the integrand is positive,
which means that we must have both fX(u) > 0 and fY(x −u) > 0.
Example 3.57. Let X and Y be independent and uniform on [0, 1]. Find the pdf of
the sum X + Y.
By Proposition 3.34,
fX+Y(x) =
 ∞
−∞
fY(x −u)fX(u)du
where we need to determine what the actual integral limits are. First, we note that the
range of X + Y is [0, 2], so we need to pick our x from that interval. Now, fX(u) = 1
if u is between 0 and 1 and 0 otherwise. For the other factor in the integrand, note
that fY(x −u) = 1 if its argument x −u is between 0 and 1, that is, 0 ≤x −u ≤1
and 0 otherwise. Since x is ﬁxed and u is the variable of integration, we rewrite this
as x −1 ≤u ≤1. Hence, for any x ∈[0, 2], the two inequalities
0 ≤u ≤1 and x −1 ≤u ≤x
(3.4)
must be satisﬁed and if they are, the integrand equals 1. We need to distinguish
between two cases:
Case 1: x ∈[0, 1]. In this case, the two conditions in Equation (3.4) are satisﬁed
if 0 ≤u ≤x. Hence, for 0 ≤x ≤1
fX+Y(x) =
 x
0
du = x,
0 ≤x ≤1
Case 2: x ∈[1, 2]. Here, the conditions are satisﬁed if x −1 ≤u ≤1, and we get
fX+Y(x) =
 1
x−1
du = 2 −x,
1 ≤x ≤2
and the pdf of X + Y is therefore
fX+Y(x) =

x
if 0 ≤x ≤1
2 −x if 1 ≤x ≤2
This is for obvious reasons called a triangular distribution.
□

230
JOINT DISTRIBUTIONS
Example 3.58. Consider radioactive decay that is such that times between consecu-
tive emissions are independent and exp(λ). Find the pdf of the time between ﬁrst and
third emissions.
This example asks for the pdf of X + Y, where X and Y are independent and exp(λ).
We have
fX(u) = λe−λu if u ≥0
and
fY(x −u) = λe−λ(x−u) if x −u ≥0
Recalling that x is ﬁxed and u the variable of integration, we get
fX+Y(x) =
 x
0
λe−λuλe−λ(x−u)du
= e−λxλ2
 x
0
du = e−λxλ2x,
x ≥0
which we recognize from Section 2.8.2 as the gamma distribution with n = 2, that is,
X + Y ∼(2, λ).
□
The last example can be extended to sums of more than one random variable. For
example, if X, Y, and Z are independent and exponential with parameter λ, then
X + Y ∼(2, λ), and we can apply Proposition 3.34 to the random variables X + Y
and Z to obtain
fX+Y+Z(x) =
 ∞
−∞
fZ(x −u)fX+Y(u)du
=
 x
0
λe−λ(x−u)e−λuλ2u du
= e−λxλ3
 x
0
u du = e−λxλ3 x2
2 , x ≥0
by integration by parts of the last integral. Again, we recognize a gamma distribution,
this time with parameters n = 3 and λ. By induction it is easily shown that this holds
generally, and we get the following nice result.
Proposition 3.35. Let X1, . . . , Xn be i.i.d. variables that have the exponential dis-
tribution with parameter λ, and let S = -n
k=1 Xk. Then S ∼(n, λ).
This means that in the case of integer values of the parameter α, we have a direct
interpretation of the gamma distribution as the sum of independent exponentially
distributed random variables.

GENERATING FUNCTIONS
231
3.11
GENERATING FUNCTIONS
Generating functions, or transforms, are very useful in probability theory as in other
ﬁelds of mathematics. Several different generating functions are used, depending on
the type of random variable. We will discuss two, one that is useful for discrete random
variables and the other for continuous random variables.
3.11.1
The Probability Generating Function
When we study nonnegative, integer-valued random variables, the following function
proves to be a very useful tool.
Deﬁnition 3.23. Let X be nonnegative and integer valued. The function
GX(s) = E[sX],
0 ≤s ≤1
is called the probability generating function (pgf) of X.
Note that by Proposition 2.12 we compute GX as the power series
GX(s) =
∞

k=0
skpX(k),
0 ≤s ≤1
where pX is the pmf of X. If the range of X is ﬁnite, the sum is ﬁnite. Note that
GX(s) = pX(0) +
∞

k=1
skpX(k)
which immediately gives the following corollary.
Corollary 3.12. Let X be nonnegative and integer valued with pgf GX. Then
GX(0) = pX(0)
and
GX(1) = 1
Before we examine further properties of the pgf, let us ﬁnd the pgf for two of our
common distributions.
Example 3.59. X ∼bin(n, p). The pgf is
GX(s) =
n

k=0
n
k

(ps)k(1 −p)n−k = (1 −p + ps)n,
0 ≤s ≤1
by the binomial theorem.
□

232
JOINT DISTRIBUTIONS
Example 3.60. X ∼Poi(λ). The pgf is
GX(s) = e−λ
∞

k=0
(λs)k
k!
= eλ(s−1),
0 ≤s ≤1
by Taylor’s theorem.
□
One important property of the pgf is that it uniquely determines the distribution.
In other words, if we are given a pgf, exactly one pmf corresponds to it and we can
compute this pmf explicitly. Above, we saw that pX(0) = GX(0), and to obtain pX(1),
we ﬁrst differentiate the pgf
G′
X(s) = d
ds

pX(0) +
∞

k=1
skpX(k)

=
∞

k=1
ksk−1pX(k) = pX(1) +
∞

k=2
ksk−1pX(k)
where we have used a result from calculus that says that this power series may be
differentiated termwise. We now see that if we are given the pgf, we have
pX(1) = G′
X(0)
To see the general pattern, let us differentiate once more:
G′′
X(s) = d
ds

pX(1) +
∞

k=2
ksk−1pX(k)

=
∞

k=2
k(k −1)sk−2pX(k)
= 2pX(2) +
∞

k=3
k(k −1)sk−2pX(k)
which gives
pX(2) = G′′
X(0)
2
Ifwecontinuetodifferentiate,wegetthegeneralformulathatwestateasaproposition.

GENERATING FUNCTIONS
233
Proposition 3.36. Let X be nonnegative and integer valued with pgf GX. Then
pX(k) = G(k)
X (0)
k!
,
k = 0, 1, . . .
where G(k)
X denotes the kth derivative of GX.
Another property of the pgf is that we can obtain the mean and variance, also by
differentiating. From the formulas for the derivatives above, we get
G′
X(1) = E[X]
G′′
X(1) = E[X(X −1)]
and we get the following result.
Proposition 3.37. If X has pgf GX, then
E[X] = G′
X(1)
and
Var[X] = G′′
X(1) + G′
X(1) −G′
X(1)2
Let us check the formulas for the Poisson distribution. If X ∼Poi(λ), then it has pgf
G(s) = eλ(s−1)
which has ﬁrst and second derivatives
G′(s) = λeλ(s−1)
and
G′′(s) = λ2eλ(s−1)
which gives
G′(1) = λ
and
G′′(1) = λ2
and
E[X] = λ
and
Var[X] = λ2 + λ −λ2 = λ
which is in accordance with Proposition 2.19 (or, if you wish, a proof of the propo-
sition). Note how it is simpler to ﬁnd the mean and variance using pgfs than to work
directly with the deﬁnition. Another central property of the pgf is that it turns sums
into products, in the following sense.

234
JOINT DISTRIBUTIONS
Proposition 3.38. Let X1, X2, . . . , Xn be independent random variables with pgfs
G1, G2, . . . , Gn, respectively and let Sn = X1 + X2 + · · · + Xn. Then Sn has pgf
GSn(s) = G1(s)G2(s) · · · Gn(s), 0 ≤s ≤1
Proof. Since X1, . . . , Xn are independent, the random variables sX1, . . . , sXn are also
independent for each s in [0, 1], and we get
GSn(s) = E[sX1+X2+···+Xn]
= E[sX1]E[sX2] · · · E[sXn]
= G1(s)G2(s) · · · Gn(s)
and we are done.
■
This result is useful for proving results for sums of random variables. Let us look at
one example.
Example 3.61. Let X1, . . . , Xn be independent such that Xk ∼Poi(λk). What is the
distribution of Sn = X1 + · · · + Xn?
By Proposition 3.38 and Example 3.60, Sn has pgf
GSn(s) = eλ1(s−1) · · · eλn(s−1) = e(λ1+···+λn)(s−1)
which we recognize as the pgf of a Poisson distribution with parameter λ1 + · · · + λn.
We have shown that the sum of independent Poisson is again Poisson. We could have
done this with the convolution methods from Section 3.34, but note how much quicker
it is to use generating functions.
□
In particular, if Xk are i.i.d. with pgf G(s), then the sum has pgf G(s)n. We look at
one example of this.
Example 3.62. Let X ∼bin(n, p). Then X can be written as -n
k=1 Ik, where Ik are
i.i.d. indicators with P(Ik = 1) = p. The pgf of each Ik is
G(s) = s0(1 −p) + s1p = 1 −p + ps
and hence X has pgf (1 −p + ps)n, in accordance with Example 3.59.
□
A different situation arises if the number of summands is not ﬁxed but random,
which is a very natural assumption in many applications. Suppose, for example, that
customers arrive at a convenience store and each customer buys a number of lottery
tickets. How many tickets are sold in a day? We can suppose that the number of
customers is a random variable N and that the kth customer buys Xk tickets, where
X1, X2, . . . are i.i.d. nonnegative integer-valued random variables, independent of N.

GENERATING FUNCTIONS
235
The total number of tickets sold is then
SN =
N

k=1
Xk
which is the sum of a random number of random variables, where we interpret SN as
0 if N = 0. If we are given distributions of N and Xk, we can ﬁnd the distribution of
SN via probability generating functions according to the following result.
Proposition 3.39. Let X1, X2, . . . be i.i.d. nonnegative and integer valued with
common pgf GX, and let N be nonnegative and integer valued, and independent of
the Xk, with pgf GN. Then SN = X1 + · · · + XN has pgf
GSN(s) = GN(GX(s))
the composition of GN and GX.
Proof. We condition on N to obtain
GSN(s) =
∞

n=0
E

sSN |N = n

P(N = n) =
∞

n=0
E

sSn

P(N = n)
since N and Sn are independent. Now note that
E

sSn

= GX(s)n
by Proposition 3.38 and we get
GSN(s) =
∞

n=0
GX(s)nP(N = n) = GN(GX(s))
the pgf of N evaluated at the point GX(s).
■
Note the similarity between the cases of ﬁxed and random numbers of summands:
GSn(s) = GX(s)n
GSN(s) = E
!
GX(s)N"
Example 3.63. Suppose that customers arrive at a rural convenience store such that
the number of customers in a not so busy hour has a Poisson distribution with mean
5. Each customer buys a number of lottery tickets, independent of other customers,
and this number has a Poisson distribution with mean 2. For this hour, ﬁnd (a) the
pgf of the total number of tickets sold, (b) the probability that no tickets are sold, and
(c) the expected number of tickets sold.

236
JOINT DISTRIBUTIONS
We have the situation in Proposition 3.39 with the pgfs
GX(s) = e2(s−1)
GN(s) = e5(s−1)
and get
GSN(s) = exp
	
5(e2(s−1) −1)

which answers (a). For (b), we let s = 0 to obtain
P(SN = 0) = exp
	
5(e−2 −1)

≈0.01
and for (c), we differentiate and get
G′
SN(s) = 10e2(s−1) exp
	
5(e2(s−1) −1)

and plugging in s = 1 gives
E[SN] = 10
□
There are two interesting observations to be made in the last example: (1) SN does
not have a Poisson distribution, so “the sum of independent Poisson is Poisson” from
Example 3.61 is not true for random sums, and (2) we can note that E[SN] = 10
equals the product of E[N] = 5 and E[X] = 2. This is no coincidence, and we next
state a general result for the mean and variance of a random sum.
Corollary 3.13. Under the assumptions of Proposition 3.39, it holds that
E[SN]
= E[N]μ
Var[SN] = E[N]σ2 + Var[N]μ2
where μ = E[Xk] and σ2 = Var[Xk].
Proof. First note that
G′
SN(s) = d
dsGN(GX(s)) = G′
N(GX(s))G′
X(s)
by the chain rule. Combining this with Propositions 3.37 and 3.39 now gives
E[SN] = G′
SN(1) = G′
N(GX(1))G′
X(1) = G′
N(1)G′
X(1) = E[N]μ
where we also used the fact that GX(1) = 1. We leave the proof of the variance
formula as an exercise.
■

GENERATING FUNCTIONS
237
Recall from Section 3.6.2 that for a sum of n i.i.d. random variables, we have E[Sn] =
nμ and Var[Sn] = nσ2. In the case of a random number of summands N, we can thus
replace n by E[N] for the mean, but things are a little more complicated for the
variance. The ﬁrst term in the variance formula accounts for the variability of the Xk
and the second for the variability of N.
3.11.2
The Moment Generating Function
The probability generating function is an excellent tool for nonnegative and integer-
valued random variables. For other random variables, we can instead use the following
more general generating function.
Deﬁnition 3.24. Let X be a random variable. The function
MX(t) = E[etX], t ∈R
is called the moment generating function (mgf) of X.
If X is continuous with pdf fX, we compute the mgf by
MX(t) =
 ∞
−∞
etxfX(x)dx
and for discrete X, we get a sum instead. Note that if X is nonnegative integer valued
with pgf GX, then
MX(t) = GX(et)
which immediately gives the mgf for the distributions for which we computed the pgf
above. Let us look at some continuous distributions.
Example 3.64. Let X ∼unif[0, 1]. Find the mgf of X.
We get
MX(t) =
 1
0
etxdx = et −1
t
, t ∈R
where we interpret MX(0) as the limit limt→0 MX(t) = 1.
□
Example 3.65. Let X ∼exp(λ). Find the mgf of X.
We get
MX(t) =
 ∞
0
etxλe−λxdx = λ
 ∞
0
e(t−λ)xdx =
λ
λ −t ,
t < λ
□

238
JOINT DISTRIBUTIONS
Note that the integral in the calculation above is inﬁnite if t ≥λ, and hence the mgf
of the exponential distribution is deﬁned only for t < λ. In general, the mgf is not
necessarily deﬁned on all of R, and for some random variables it turns out that the
mgf does not exist at all (Problem 146). Before the next example, we state a useful
property of the mgf. We leave the proof as an exercise.
Corollary 3.14. Let X be a random variable that has mgf MX and let Y = aX + b.
Then Y has mgf
MY(t) = ebtMX(at)
Example 3.66. Let X ∼N(μ, σ). Find MX(t).
Let us start with the standard normal distribution. Thus, let Z ∼N(0, 1) and ﬁnd
MZ(t). We get
MZ(t) =
 ∞
−∞
etxϕ(x)dx =
1
√
2π
 ∞
−∞
e(t2/2−(x−t)2/2)dx
= et2/2
 ∞
−∞
1
√
2π
e−(x−t)2/2dx = et2/2,
t ∈R
where the last equality follows since the integrand is the pdf of a normal distribution
with mean t and variance 1, and hence the integral equals 1. Now let X = μ + σZ so
that X ∼N(μ, σ2), to obtain
MX(t) = etμMZ(σt) = etμ+σ2t2/2,
t ∈R
by an application of Corollary 3.14.
□
The moment generatingfunctionhasmanypropertiesthatareanalogousto thoseofthe
probability generating function. Thus, the mgf uniquely determines the distribution
of X, a fact that we will not prove. We can also obtain the mean and variance from
the mgf, according to the following formula.
Corollary 3.15. If X has mgf MX(t), then
E[X] = M′
X(0)
and
Var[X] = M′′
X(0) −(M′
X(0))2
Proof. By differentiating MX(t) with respect to t, we get
M′
X(t) = d
dt E[etX] = E[XetX]

GENERATING FUNCTIONS
239
where we assumed that we can interchange differentiation and expectation. Note how
t is the variable of differentiation and we view X as ﬁxed. In the case of a discrete X,
this amounts to differentiating a sum termwise, and in the case of a continuous X, it
means that we can differentiate under the integral sign. This is by no means obvious
but can be veriﬁed. We will not address this issue further. Differentiating once more
gives
M′′
X(t) = d
dt E[XetX] = E[X2etX]
which gives
Var[X] = E[X2] −(E[X])2 = M′′
X(0) −(M′
X(0))2
as desired.
■
Note that we get the general result
E[Xn] = M(n)
X (0), n = 1, 2, . . .
where M(n)
X is the nth derivative of MX. The number E[Xn] is called the nth moment
of X, hence the term moment generating function. Compare it with the probability
generating function that generates probabilities by differentiating and setting s = 0.
The moment generating function also turns sums into products, according to the
following proposition, which you may prove as an exercise.
Proposition 3.40. Let X1, X2, . . . , Xn be independent random variables with mgfs
M1, M2, . . . , Mn, respectively, and let Sn = X1 + · · · + Xn. Then Sn has mgf
MSn(t) = M1(t)M2(t) · · · Mn(t), t ∈R
Example 3.67. Let X ∼N(μ1, σ2
1) and Y ∼N(μ2, σ2
2) and suppose that X and Y
are independent. Show that X + Y ∼N(μ1 + μ2, σ2
1 + σ2
2).
By Proposition 3.40 and Example 3.66, the mgf of X + Y is
MX+Y(t) = exp

tμ1 + σ2
1t2
2

exp

tμ2 + σ2
2t2
2

= exp

t(μ1 + μ2) + (σ2
1 + σ2
2)t2
2

which we recognize as the mgf of a normal distribution with parameters μ1 + μ2 and
σ2
1 + σ2
2, and by uniqueness of the mgf we are done.
□

240
JOINT DISTRIBUTIONS
We have seen how summation of independent random variables corresponds to multi-
plication of their pgfs or mgfs. Also, we have previously learned that the distribution
of the sum of independent random variables can be obtained as the convolution of their
distributions in both discrete and continuous cases. We summarize this observation
in an informal statement that can be useful to remember.
The following are equivalent:
(a) Summation of independent random variables
(b) Convolution of distributions
(c) Multiplication of generating functions
3.12
THE POISSON PROCESS
Suppose that we are observing some system where changes occur randomly in time.
For example, we could be observing incoming jobs to a computer, customers arriving
at a store, accidents occurring on a certain highway, earthquakes, or emission of
radioactive particles. Each of these examples has in common that we can represent
them as points on a timeline; see Figure 3.13, where each “×” marks the time when
something was observed.
We call this a point process. To be able to investigate the behavior of this point
process, we need to make assumptions on how the points are distributed. We therefore
assume that the times between consecutive points are independent random variables
T1, T2, . . ., which have exponential distributions with the same parameter λ. As-
suming an exponential distribution means that we assume that the process is very
unpredictable. Tk are called the interarrival times. By the memoryless property, this
means that at any ﬁxed time, the time until the next point is exp(λ) regardless of
when the previous point came. Such a process is sometimes referred to as completely
random, but we use another term, already mentioned in Section 2.6.
Deﬁnition 3.25. A point process where times between consecutive points are i.i.d.
random variables that are exp(λ) is called a Poisson process with rate λ.
Time
×
×
×
×
×
×
0
FIGURE 3.13
A point process in time. Each “×” marks the occurrence of some event of
interest.

THE POISSON PROCESS
241
×
0
T1 > t
t
X(t) = 0
FIGURE 3.14
The relation between the random variables X(t) and T1.
The rate λ has unit mean number of points per time unit. Hence, larger values of λ
correspond to more points per time unit, which is also clear since the expected time
between points is 1/λ.
One random variable of interest is the number of points in a interval. Fix t ≥0 and
deﬁne the random variable
X(t) = the number of points in a time interval of length t
and note that X(t) is a discrete random variable with range {0, 1, 2, . . .}. Also note
that by the memoryless property, it does not matter where the interval is located
since at any given time, the time until the next point has the same distribution. Thus,
we can without loss of generality consider the interval [0, t]. Let us ﬁrst investigate
P(X(t) = 0). If we denote the time for the ﬁrst point by T1, we realize that X(t) = 0
if and only if T1 > t (see Figure 3.14). Hence, we get
P(X(t) = 0) = P(T1 > t) = e−λt
For general k, note that X(t) = k if and only if the kth point came before t and the
(k + 1)th point after t. With Sk = T1 + · · · + Tk, the time for the kth point, we can
express this in terms of events as
{X(t) = k} = {Sk ≤t} \ {Sk+1 ≤t}
the event that the kth but not the (k + 1)th point came before t. Also, since Sk+1 ≤t
implies that Sk ≤t, we have {Sk+1 ≤t} ⊆{Sk ≤t}, and we get
P(X(t) = k) = P(Sk ≤t) −P(Sk+1 ≤t)
and by Proposition 3.35, Sk ∼(k, λ) for all k. From Section 2.8.2, we now get
P(X(t) = k) = 1 −e−λt
k−1

j=0
λjtj
j! −
⎛
⎝1 −e−λt
k

j=0
λjtj
j!
⎞
⎠
= e−λt (λt)k
k! ,
k = 0, 1, 2, . . .
which we recognize as the Poisson distribution from Section 2.5.4. Hence, we arrive
at the following proposition.

242
JOINT DISTRIBUTIONS
Proposition 3.41. Consider a Poisson process with rate λ, where X(t) is the number
of points in an interval of length t. Then
X(t) ∼Poi(λt)
Recall that the parameter in the Poisson distribution is also the expected value. Hence,
we have
E[X(t)] = λt
which makes sense since λ is the mean number of points per time unit and t is the
length of the time interval. In practical applications, we need to be careful to use the
same time units for λ and t.
Now consider two disjoint time intervals. By the memoryless property, we real-
ize that the number of points in one of the intervals is independent of the number
of points in the other. Thus, in a Poisson process with intensity λ, the numbers of
points in disjoint time intervals are independent and have Poisson distributions with
means λ times the interval lengths. Formally, let I1, I2, . . . be any sequence of disjoint
time intervals of lengths t1, t2, . . ., and let X(tj) denote the number of points in Ij.
Furthermore, let T1, T2, . . . be the times between points deﬁned above. We have the
following proposition.
Proposition 3.42. In a Poisson process with rate λ
(a) T1, T2, . . . are independent and exp(λ)
(a) X(t1), X(t2), . . . are independent and X(tj) ∼Poi(λtj), j = 1, 2, . . .
We have used (a) as the deﬁnition of the Poisson process and argued that (b)
follows. In fact, we could as well use (b) as the deﬁnition and argue that (a) follows.
The independence assumption in (b) implies the memoryless property for times
between points and the relation above between numbers of points and times between
consecutive points gives the exponential distribution. Hence,
The properties (a) and (b) in Proposition 3.42 are equivalent.
We know that the number of points in the interval [0, t] in a Poisson process with
rate λ has a Poisson distribution with mean λt. Now suppose that we know there is
exactly one point in the interval. What is the distribution of its position?
By the memoryless property, it does not matter whether there is also a point ex-
actly at time t, so we can assume that the second point arrived at t. What is the
distribution for the position of the ﬁrst point? In terms of the interarrival times, we

THE POISSON PROCESS
243
ask for the conditional distribution of T1 given T1 + T2 = t. To ﬁnd this, consider the
transformation
S1 = T1, S2 = T1 + T2
that is, S1 and S2 aresimplythearrivaltimesoftheﬁrstandsecondpoints,respectively.
We wish to ﬁnd the conditional distribution of S1 given S2 = t. The joint distribution
of (T1, T2) is, by independence,
f(T1,T2)(t1, t2) = λ2e−λ(t1+t2), t1, t2 ∈R
The joint pdf of (S1, S2) is obtained by noting that the Jacobian matrix for the trans-
formation (t1, t2) →(t1, t1 + t2) has determinant 1 (and so does its inverse), and
Proposition 3.16 gives
f(S1,S2)(s, t) = f(T1,T2)(s, t −s) = λ2e−λt, 0 ≤s ≤t
We already know that S2 ∼(2, λ), so S2 has pdf
fS2(t) = λ2te−λt
which gives the conditional pdf
fS1(s1|t) = f(S1,S2)(s, t)
fS2(t)
= 1
t , 0 ≤s ≤t
which is a uniform distribution on [0, t]. Thus, given that the second point arrives
at time t, the position for the ﬁrst is uniform between 0 and t. Considering the
memorylessness of the exponential interarrival times, this comes as no big surprise.
Also, by the memoryless property, it is equivalent to condition on the fact that the
second point arrived at t and that there is exactly one point in the interval [0, t].
Whether there is in fact a point at time t does not matter. More generally, if we con-
dition on n points in [0, t] or, equivalently, that the (n + 1)th point arrived at time
t, the n points are distributed as independent uniforms on the interval. Let us state
this formally.
Proposition 3.43. Consider a Poisson process with rate λ. If there are n points in
the time interval [0, t], their joint distribution is the same as that of n i.i.d. random
variables that are unif[0, t].
The property in the proposition is called the order statistic property of the Poisson
process since the points are distributed as n order statistics from a uniform distribution
on [0, t]. The proof is similar to what we did previously in the case of n = 1, invoking
Proposition 3.32.
Example 3.68. Suppose that earthquakes in a region occur according to a Poisson
process with an average of 104 earthquakes per year. Find the probability that (a)
a given week has at most one earthquake, (b) three consecutive earthquakes are at

244
JOINT DISTRIBUTIONS
×
×
×
×
×
×
×
FIGURE 3.15
The original Poisson process with observed points encircled and the resulting
thinned process.
least 1 week apart from each other, and (c) a week with two earthquakes has them
on different days.
The rate is 104 earthquakes per year. (a) With X as the number of earthquakes in a
week, we have λ = 104 and t = 1
52 and hence X ∼Poi(2) and get
P(X ≤1) = P(X = 0) + P(X = 1) = e−2(1 + 2) ≈0.41
For (b), the times T1 and T2 between consecutive earthquakes are independent and
exp(2), which gives
P(T1 > 1, T2 > 1) = P(T1 > 1)P(T2 > 1) = e−4 ≈0.02
For (c), by the order statistic property, the two earthquakes are distributed as two
independent uniform random variables over the week. Hence, any given day has
probability 1
7, and the probability that the other falls on another day is 6
7 (formally,
condition on the day of one of the quakes).
□
3.12.1
Thinning and Superposition
Suppose now that we have a Poisson process with rate λ, where we do not observe
every point, either by accident or on purpose. For example, phone calls arrive as a
Poisson process, but some calls are lost when the line is busy. Hurricanes are formed
according to a Poisson process, but we are interested only in those that make landfall.
These are examples of thinning of a Poisson process (see Figure 3.15).
We assume that each point is observed with probability p and that different points
are observed independent of each other. Then, it turns out that the thinned process is
also a Poisson process.
Proposition 3.44. The thinned process is a Poisson process with rate λp.
Proof. We work with characterization (b) in Proposition 3.42. Clearly, the numbers of
observed points in disjoint intervals are independent. To show the Poisson distribution,
we use probability generating functions. Consider an interval of length t, letting X(t)
be the total number of points and Xp(t) be the number of observed points in this
interval. Then,
Xp(t) =
X(t)

k=1
Ik

THE POISSON PROCESS
245
where Ik is 1 if the kth point was observed and 0 otherwise. By Proposition 3.39,
Xp(t) has pgf
GXp(s) = GX(t)(GI(s))
where
GX(t)(s) = eλt(s−1)
and
GI(s) = 1 −p + ps
and we get
GXp(s) = eλt(1−p+ps−1) = eλpt(s−1)
which we recognize as the pgf of a Poisson distribution with parameter λpt.
■
It is deﬁnitely reasonable that the expected number of observed points in the thinned
process is λpt. The more interesting aspect of Proposition 3.44 is that the Poisson
process properties are retained. It is important, though, that the thinning is done in
the independent way described above; otherwise, the Poisson process properties are
ruined. The following result is not only interesting but also surprising.
Proposition 3.45. The processes of observed and unobserved points are indepen-
dent.
Proof. Fix an interval of length t, let X(t) be the total number of points, and Xp(t)
and X1−p(t) the number of observed and unobserved points, respectively. Hence,
X(t) = Xp(t) + X1−p(t) and by Proposition 3.44, we obtain
Xp(t) ∼Poi(λpt)
and
X1−p(t) ∼Poi(λ(1 −p)t)

246
JOINT DISTRIBUTIONS
Also, given that X(t) = n, the number of observed points has a binomial distribution
with parameters n and p. We get
P(Xp(t) = j, X1−p(t) = k) = P(Xp(t) = j, X(t) = k + j)
= P(Xp(t) = j|X(t) = k + j)P(X(t) = k + j)
=
k + j
j

pj(1 −p)ke−λt (λt)k+j
(k + j)!
= (k + j)!
k!j!
pj(1 −p)ke−λt (λt)k+j
(k + j)!
= e−λpt (λpt)j
j!
e−λ(1−p)t (λ(1 −p)t)k
k!
= P(Xp(t) = j)P(X1−p(t) = k)
■
This result should end with an exclamation mark instead of a mere period. For exam-
ple, suppose that we have a Poisson process such that we expect 10 points per hour.
If in 1 h we observe 20 points and in another no points at all, it seems that the second
hour ought to have more unobserved points. However, the last result tells us that this
is not so, but the distribution of unobserved points is the same in both cases.
Example 3.69. Consider the earthquakes in Example 3.68, occurring on average
twice a week. Each time there is an earthquake, it is of category “major” with
probability 0.01; otherwise, “minor.” (a) What is the probability that there are no
major earthquakes in a given year? (b) What is the probability that there are no major
earthquakes and at least one minor quake in a given week?
For(a),notethatthenumberXofmajorearthquakesinayearhasaPoissondistribution
with mean λp = 104 × 0.01 = 1.04 and hence
P(X = 0) = e−1.04 ≈0.35
For (b), the mean of X is instead 0.02 (quakes per week) and if we let Y be the number
of minor quakes, then Y has a Poisson distribution with mean 2 × 0.99 = 1.98 and
by independence of X and Y, we obtain
P(X = 0, Y > 0) = P(X = 0)(1 −P(Y = 0)) = e−0.02(1 −e−1.98) ≈0.84
□

PROBLEMS
247
×
×
×
×
×
×
×
×
×
×
×
×
FIGURE 3.16
Two independent Poisson processes and their superposition.
Let us ﬁnally consider a situation that is in a sense the opposite of thinning. Instead of
removing points from a Poisson process, we add points according to another Poisson
process. Hence, we are considering a situation where we have two Poisson processes
and observe the total number of points in both of them; that is, we observe the su-
perposition of the two. For example, jobs may arrive at a computer according to
Poisson processes from different sources or cars pass a point on a road according to
two Poisson processes, one in each direction (see Figure 3.16). Just as in the case of
thinning, the Poisson process properties are retained, provided the two processes are
independent.
Proposition 3.46. Consider two independent Poisson processes with rates λ1 and
λ2, respectively. The superposition of the two processes is a Poisson process with
rate λ1 + λ2.
Proof. For this we use characterization (a) in Proposition 3.42. Fix a time where there
is a point in either of the two processes. Denote the time until the next point in the ﬁrst
process by S and the corresponding time in the second by T. Since the two processes
are independent, S and T are independent random variables. Also, by the memoryless
property, the distributions are S ∼exp(λ1) and T ∼exp(λ2), regardless of which of
the two processes the last point came from. Hence, the time until the next point in
the superposition process is the minimum of S and T, and by Example 3.50, this is
exp(λ1 + λ2). Thus, the superposition process is a Poisson process with rate λ1 + λ2
and we are done.
■
PROBLEMS
Section 3.2. The Joint Distribution Function
1. Let (X, Y) have joint cdf F. Show that
P(a < X ≤b, c < Y ≤d) = F(b, d) + F(a, c) −F(a, d) −F(b, c)

248
JOINT DISTRIBUTIONS
2. Let (X, Y) have joint cdf F and let x ≤y. For which set do we get the probability
if we compute F(y, y) −F(x, x)?
3. Let F be a joint cdf. Find the limit as x →∞of (a) F(x, x), (b) F(−x, x),
(c) F(−x, −x).
4. Are the following statements true or false in general? (a) F(x, y) ≤FX(x) for
all x, y ∈R, (b) P(X > x, Y > y) = 1 −F(x, y) for all x, y ∈R.
5. Let (X, Y) have joint cdf F and let G be the cdf of the random variable X + Y.
Show that F(x, x) ≤G(2x) for all x ∈R.
6. Find the marginal cdf’s of X and Y
for the following joint cdfs:
(a)
F(x, y) = 1 −e−x −e−y + e−(x+y), x, y ≥0,
(b)
F(x, y) = x2√y,
0 ≤x ≤1, 0 ≤y ≤1,
(c)
F(x, y) = 2xy, 0 ≤x ≤1
2, 0 ≤y ≤1,
and
(d) F(x, y) = 1
3(x2y + 2xy2), 0 ≤x ≤1, 0 ≤y ≤1.
Section 3.3. Discrete Random Vectors
7. Let (X, Y) be uniform on the four points (0, 0), (1, 0), (1, 1), (2, 1). (a) Find
the marginal pmfs of X and Y. (b) For which joint pmf of (X, Y) are X and Y
uniform on their respective ranges?
8. Is it true in general that p(x, y) ≤pX(x) for all x, y?
9. Consider a family with three children. Let X be the number of daughters and
Y the number of sons. Find the joint pmf of (X, Y).
10. Roll a die twice and let Y be the sum of the two rolls. Find the joint pmf of
(X, Y) if X is (a) the number on the ﬁrst roll, and (b) the smallest number.
11. Draw three cards without replacement from a deck of cards. Let H be the
number of hearts and S the number of spades drawn. (a) Find the joint pmf of
(H, S). (b) Find P(H = S).
12. Draw one card from a deck of cards. Let H be the number of hearts and A the
number of aces drawn. (a) Find the joint pmf of (H, A). (b) Find P(H ≤A).
13. Consider a population of individuals that reproduce in such a way that the num-
ber of children of an individual has probability distribution ( 1
4, 1
2, 1
4) on the set
{0, 1, 2} and that individuals reproduce independently. Consider a randomly
chosen individual, let X be the number of children and Y the number of grand-
children of this individual, and let p be the joint pmf of (X, Y). Find (a) p(0, 0),
(b) p(2, 2), and (c) P(Y = 0).
Section 3.4. Jointly Continuous Random Vectors
14. Showthatthefollowingfunctionsarepossiblejointpdfs:(a)f(x, y) = e−y, 0 ≤
x ≤y < ∞, (b) f(x, y) = xe−x(y+1), x, y ≥0, (c) f(x, y) = 1/(x2y2), x, y ≥
1, and (d) f(x, y) = x/√y, 0 ≤x ≤1, 0 ≤y ≤1.
15. Which of the following functions are possible joint pdfs on [0, 1] × [0, 1]:
(a)
f(x, y) = xy,
(b)
f(x, y) = 4y −2x,
(c)
f(x, y) = 3|y −x|,
and
(d) f(x, y) = 2x?

PROBLEMS
249
16. The random variables X and Y have joint pdf
f(x, y) = c(x −y), 0 ≤y ≤x ≤1
Find (a) the constant c, (b) P(X > 1
2, Y ≤1
2), (c) P(X ≤2Y), and (d) the
marginal pdfs of X and Y.
17. The random variables X and Y have joint cdf F(x, y) = 1
2(x2y + xy2), 0 ≤x ≤
1, 0 ≤y ≤1. Find the joint pdf and the marginal pdfs of X and Y.
18. Let X ∼unif[0, 1] and let A be the area of a square with sidelength X. Show
that X and A are continuous when viewed one by one but that (X, A) is not
jointly continuous.
19. Let (X, Y) be uniform on the set ([0, 1
2] × [0, 1
2]) ∪([ 1
2, 1] × [ 1
2, 1]) (draw a
ﬁgure). Find the marginals of X and Y.
20. Consider a dart thrown at a dartboard with radius 1. Suppose that the player
aims at the center and that this is reﬂected in the joint pdf of (X, Y) being
f(x, y) = c(1 −(x2 + y2)), x2 + y2 ≤1. Find (a) the constant c, and (b) the
probability that the dart hits within distance d of the center.
21. Are the following statements true in general for a joint pdf: (a) f(x, y) ≤fX(x)
for all x, y ∈R, (b) f(x, y) ≤fX(x) for some x, y ∈R, (c) f(x, y) ≤1 for all
x, y ∈R, and (d) f(x, y) ≤1 for some x, y ∈R?
Section 3.5. Conditional Distributions and Independence
22. Eggs are delivered to a restaurant by the gross (1 gross = 12 dozen). From each
gross, a dozen of eggs are chosen at random. If none are cracked, the gross is
accepted, and if more than one egg is cracked, the gross is rejected. If exactly
one egg is cracked, an additional dozen eggs from the same gross are inspected.
If this lot has no cracked eggs, the entire gross is accepted, otherwise it is
rejected. Suppose that a gross has eight cracked eggs. What is the probability
that it is accepted?
23. Customers arrive to a store such that the number of arriving customers in an
hour has a Poisson distribution with mean 4. A customer is male or female with
equal probabilities. Let X be the number of female customers in an hour and
ﬁnd P(X = 0).
24. Let X be a random variable and c a constant. Show that X and c are independent.
25. Let X and Y be independent and have Poisson distributions with means λ1 and
λ2, respectively. Show that the conditional distribution of X given X + Y = n
is binomial and identify the parameters.
26. Let X and Y be independent and have the same binomial distribution with
parameters n and p. Show that the distribution of X given X + Y = n is hyper-
geometric and does not depend on p. Explain intuitively.
27. Let X and Y be independent and have the same geometric distribution with
success probability p. Find the conditional distribution of X given X + Y = n.
Explain intuitively.

250
JOINT DISTRIBUTIONS
28. A salesman has a weekly net income that is uniform on [−1, 2] ($1000; a
negative number means a net loss). Let X be his income in a week when he
makes a proﬁt. Find the pdf of X.
29. Consider Example 2.22 where the amount X of the compound has pdf f(x) =
2x, 0 ≤x ≤1 and is kept if X ≥0.5. What is the conditional pdf of the com-
pound in a test tube that is kept?
30. Let (X, Y) be jointly continuous. Is it then always true that FY(y|x) =
F(x, y)/FX(x)? If not, give a condition for when it is true.
31. For the joint pdfs in Problem 14, ﬁnd the conditional pdf of Y given X = x.
32. Let X have a uniform distribution on (0, 1), and given that X = x, let the con-
ditional distribution of Y be uniform on (0, 1/x). (a) Find the joint pdf f(x, y)
and sketch the region where it is positive. (b) Find fY(y), the marginal pdf of
Y, and sketch its graph. (c) Compute P(X > Y).
33. Let X ∼unif[0, 1]. Find the pmf of Y if the conditional distribution of
Y given X = x is bin(n, x). Does Y have a binomial distribution? Note:
 1
0 xa(1 −x)bdx = a!b!/(a + b + 1)!
34. Adam and Billy Bob have agreed to meet at 12:30. Assume that their arrival
times are independent random variables, Adam’s uniformly distributed between
12:30 and 1:00 and Billy Bob’s uniformly distributed between 12:30 and 1:15.
(a) Compute the probability that Billy Bob arrives ﬁrst. (b) Compute the prob-
ability that the one who arrives ﬁrst must wait more than 10 min.
35. Let X and Y be nonnegative, independent continuous random variables.
(a) Show that
P(X < Y) =
 ∞
0
FX(x)fY(x)dx
(b) What does this become if X ∼exp(λ1) and Y ∼exp(λ2)?
36. Decide whether X and Y are independent if (X, Y) has the following joint
pdfs on [0, 1] × [0, 1]: (a) f(x, y) = 4xy, (b) f(x, y) = x + y, (c) f(x, y) =
x(2y + 1), (d) f(x, y) = 6xy2, (e) f(x, y) = 2y.
37. (a) Let X and Y be independent random variables. Show that X2 and Y2 are also
independent. (b) The converse of (a) is not true. Let X, Y, and U be independent
such that X and Y are exp(1) and U is −1 or 1 with equal probabilities. Let
S = UX and T = UY. Show that S2 and T 2 are independent but that S and T
are not independent. (c) Let X and Y be independent random variables and g
and h be two functions that are strictly monotone. Show that g(X) and h(Y) are
independent.
38. LetR1 andR2 beindependentandunif[0, 1],andletV1 bethevolumeofasphere
with radius R1 and V2 the volume of a cube with side 2R2. Find P(V1 > V2).
39. Consider the quadratic equation x2 + Bx + C = 0 where B and C are indepen-
dent and have uniform distributions on [−n, n]. Find the probability that the
equation has real roots. What happens as n →∞?

PROBLEMS
251
40. Consider the bass from Problem 17 in Chapter 2. A more realistic model is
that the weight at age A is W = 2A + 3 + X, where X is a random variable,
independent of A, accounting for the fact that not all ﬁsh of a particular age have
exactly the same weight. Suppose that X ∼unif[−2, 2] and ﬁnd the probability
that (a) a 10-year-old bass weighs less than 22 pounds, (b) a randomly chosen
bass is older than 8 years and weighs more than 20 pounds, and (c) two randomly
chosen bass of the same age differ in weight by at least 2 pounds.
41. Let f and g be two pdfs, let p ∈(0, 1), and let h(x) = pf(x) + (1 −p)g(x),
x ∈R. (a) Show that h is a pdf. (b) If X has pdf f and Y has pdf g, what does
the pdf h describe?
Section 3.6. Functions of Random Vectors
42. Let X and Y have the same distribution (but not necessarily be independent)
and let Z = X −Y. Show that Z has a symmetric distribution (see Problem 101
in Chapter 2).
43. Let X and Y be independent and unif[0, 1]. Find the cdf and pdf of the random
variables (a) |X −Y|, (b) X/(X + Y).
44. A current of I ﬂows through a resistance of R, thus generating the power
W = I2R. Suppose that I has pdf f(x) = 2x, 0 ≤x ≤1, R ∼unif[0, 1] and
that I and R are independent. Find the pdf of W.
45. In Problem 34, compute the expected time that (a) Billy Bob must wait for
Adam, (b) the ﬁrst person to arrive must wait for the second.
46. Water ﬂows in and out of a dam such that the daily inﬂow is uniform on [0, 2]
(megaliters) and the daily outﬂow is uniform on [0, 1], independent of the
inﬂow. Each day the surplus water (if there is any) is collected for an irrigation
project. Compute the expected amount of surplus water in a given day.
47. Let X and Y be independent and exp(1). Find E[e−(X+Y)/2].
48. Let X and Y be independent and unif[0, 1]. Find (a) E[XY], (b) E[X/Y],
(c) E[log(XY)], and (d) E[|Y −X|].
49. Consider the two rods in Example 3.19. Suppose that there is an error X when we
lay the rods side by side that is independent of the measurements and such that
E[X] = 0 and Var[X] = τ2. Now measure the sum and difference S and D and
estimate a by A = (S + D)/2. (a) Find the mean and variance of A. (b) When
is the precision with this method better than taking one single measurement of
the longer rod?
50. Let X1, X2, . . . , Xn be i.i.d. random variables with mean μ and variance σ2, let
Sn = X1 + · · · + Xn, and let ¯X = Sn/n (called the sample mean). Find E[ ¯X]
and Var[ ¯X].
51. Let X1, . . . , Xn be independent with the same mean μ and the same variance
σ2. Express the following expected values in terms of n, μ, and σ2: (a) E[X2
1 +
· · · + X2
n], (b) E[(X1 + · · · + Xn)2].

252
JOINT DISTRIBUTIONS
52. Let X have a negative binomial distribution with parameters r and p (see Prob-
lem 61, Chapter 2). Find E[X] and Var[X] without using the deﬁnition; instead,
consider how X can be written as a sum of independent random variables.
53. Recall the concepts of skewness and kurtosis from Problems 102 and 104 in
Chapter 2. Let X1, . . . , Xn be independent and have the same distribution with
skewness s and kurtosis c, and let Sn = -n
k=1 Xk. (a) Show that skw[Sn] =
s/√n. (b) Show that kur[Sn] = 3 + (c −3)/n. (c) Find skw[X] and kur[X] if
X ∼bin(n, p).
54. Consider coupons numbered 1, 2, . . . , n that you collect until you have all
numbers. Each time you get a coupon, its number is independent of previous
numbers and all numbers are equally likely. Let N be the number of coupons
you need and show that (a) E[N] = n -n
k=1(1/k) ≈n log n for large n, and
(b) there is a constant c such that Var[N] ≈cn2 for large n. What is c?
55. In the previous problem, let X be the number of different coupons when you
have collected k coupons. (a) Find E[X]. Hint: Let Ij be the indicator that there
is at least one coupon with number j, among the k coupons. (b) Show that, for
large n and k = cn, E[X] ≈n(1 −e−c), c = 1, 2, . . . .
56. You roll a die repeatedly until all numbers have shown up. What is the expected
number of 6s? Hint: Let Nk be the expected number of k’s and N as in Problem
54 and argue that E[N1] + · · · + E[N6] = E[N].
57. You throw darts at random on a chessboard (64 squares). After n throws, let X be
the number of squares that are not hit. Find E[X] and show that E[X] ≈ne−1/64
for large n. For which values of n is the approximation useful?
58. Consider N married couples. If there are n deaths, what is the expected number
of married couples remaining?
59. Consider a sample containing 2n carbon-14 atoms (see Example 2.40). Show
that the expected time until all have decayed is approximately 5700 log n/ log 2
years. How can you come up with this number in the deterministic
description?
60. Consider the inclusion–exclusion formula in Proposition 1.5. Prove this by ﬁrst
expressing the indicator of the union in terms of indicators of intersections, and
then take expected values.
61. Let X and Y be nonnegative and have joint pdf f and let Z = Y/X. (a) Express
the joint pdf of (X, Z) in terms of f. (b) If X and Y are independent exp(1),
ﬁnd the joint pdf of (X, Z) and the marginal pdf of Z.
62. Let X and Y be independent and unif[0, 1]. Find the joint pdf of U = X + Y
and V = X/(X + Y).
63. Let X and Y be independent N(0, 1) and let U = X −Y, V = X + Y. Find the
joint pdf of (U, V).
64. A point (X, Y) is chosen in the unit disk by letting its polar coordinates R and
 be independent and uniform on their respective ranges. Find the joint pdf of
(X, Y).

PROBLEMS
253
65. A battery with voltage U is connected to a resistance of R, thus creating a current
of I = U/R and a power of W = U2/R. Suppose that U has pdf f(u) = 2u, 0 ≤
u ≤1, R has pdf f(r) = 1/r2, r ≥1 and that U and R are independent. Find
the joint pdf of (I, W) and the marginal pdfs of I and W (be careful with the
ranges).
66. Let (X, Y) have joint pdf f(x, y) = x + y, 0 ≤x ≤1, 0 ≤y ≤1 and let U =
2X, V = X + Y. Find the joint pdf of (U, V) (be careful with the range).
67. Let (X, Y) have joint pdf
f(x, y) =
1
π
√
3
e−2(x2+y2−xy)/3, x, y ∈R
and let U = X + Y, V = X −Y. Find the joint pdf of (U, V).
Section 3.7. Conditional Expectation
68. Let X be a continuous random variable with pdf f and let b be a real number.
Show that
E[X|X > b] =
 ∞
b
xf(x)dx
P(X > b)
69. A saleswoman working for a company sells goods worth X $1000 per week,
where X is unif[0, 2]. Of this, she must pay the company back up to $800 and
gets to keep the rest. Compute her expected proﬁt (a) in a given week, and
(b) in a week when she makes a proﬁt.
70. In Problem 10(a) and (b), compute E[Y|X = k] for k = 1, . . . , 6.
71. Compute the conditional expectations E[Y|X = x] in Problem 14.
72. Let X ∼unif[0, 1]. Compute E[Y] if the conditional distribution of Y given
X = x is (a) unif[0, x2], (b) unif[0, sin(πx)], (c) unif[0, 1/x], and (d) exp(1/x).
73. Let X ∼exp(1). Compute E[Y] if the conditional distribution of Y given X = x
is (a) unif[0, x], (b) unif[x, x + 2], and (c) exp(x).
74. Let X ∼unif[0, 1]. Compute E[Y] if the conditional distribution of Y given
X = x is (a) geom(x), and (b) bin(n, x) (recall Example 3.11 and Problem 33).
75. Suppose that X and Y are such that E[Y|X] = 2X. Thus, if we know X, we
would expect Y to be twice as much. Does this imply that E[X|Y] = Y/2?
76. Consider
the
variance
formula
Var[Y] = Var[E[Y|X]] + E[Var[Y|X]].
(a) Show that Var[E[Y|X]] = 0 if X and Y are independent. (b) Show that
E[Var[Y|X]] = 0 if X and Y are totally dependent in the sense that Y = g(X)
for some function g (recall Corollary 3.6).
77. Let X ∼geom(p). Use a recursive argument to show that Var[X] = (1 −p)/p2.
Hint: First, let τ = E[X2] and obtain an equation for τ by using Equation (3.3)
and properties of indicators.

254
JOINT DISTRIBUTIONS
78. Recall Example 1.56, where Ann and Bob play tennis and Ann wins a point
as server with probability p. Suppose that the players are at deuce and that
Ann serves. What is the expected number of played points until the game
is over?
79. Recall Example 1.57, where Ann and Bob play badminton and Ann wins a rally
with probability p. If Ann is about to serve, what is the expected number of
rallies until the next point is scored?
80. In Example 3.34, we arrived at the equation μ = 6
4 + 3
4μ, which has solution
μ = 6. However, μ = ∞also is a solution, so we need to argue why this can
be ruled out. Show that μ can be at most 8 (think about coins ﬂipped two by
two).
81. In Example 3.34, compute the variances of the waiting times for the patterns
HH and TH.
82. Flip a fair coin repeatedly and verify the expected number of ﬂips until the ﬁrst
occurrence of HHH, HHT, HTH, and HTT, as given in Example 3.34.
83. Flip a fair coin repeatedly and wait for the ﬁrst occurrence of n consecutive
heads, HH · · · H. Find an expression for the expected number of ﬂips until this
occurs.
84. Roll a die repeatedly. What is the expected number of rolls until the ﬁrst occur-
rence of the pattern (a) 36, (b) 666?
Section 3.8. Covariance and Correlation
85. Let U and V be independent and unif[0, 1] and let X = min(U, V) and Y =
max(U, V). Find Cov[X, Y] and comment on its sign.
86. Find the variance of the number of matches in Example 3.23. First argue that
Ik are not independent but that Cov[Ij, Ik] is the same for all j /= k, and then
compute it.
87. Drawthreecardswithoutreplacementfromadeckofcards.LetH bethenumber
of hearts and S the number of spades drawn. Find ρ(H, S) and comment on its
sign.
88. In Deﬁnition 3.17, it is necessary that Var[X] > 0 and Var[Y] > 0. If this is not
the case, what value is reasonable to assign to the correlation?
89. Let ρ be the correlation between X and Y. What is the correlation between
X + a and Y + b, where a and b are constants?
90. Prove Proposition 3.25(c) using the method suggested in the proof and also
express a and b in terms of μ1, μ2, σ2
1, σ2
2, and ρ.
91. Compute ρ(Ij, Ik) in Example 3.38. What is its sign and how does it depend
on the parameters of the hypergeometric distribution? Explain intuitively.
92. Let (X, Y) be uniformly distributed on the triangle with corners in (0, 0), (0, 1),
and (1, 0). (a) Compute the correlation coefﬁcient ρ(X, Y). (b) If you have done
(a) correctly, the value of ρ(X, Y) is negative. Explain intuitively.

PROBLEMS
255
93. Let A and B be two events. The degree of dependence between A and B can
then be measured by the correlation between their indicators IA and IB. Sup-
pose P(A) = P(B) = 1
2 and express the correlation coefﬁcient ρ(IA, IB) as a
function of P(A|B). Give an intuitive interpretation.
94. Let A and B be independent events. Show that IA + IB and |IA −IB| are un-
correlated. Are they independent?
95. For the following random variables, X and Y, determine whether they are uncor-
related and independent. (a) X ∼unif[0, 1] and Y = X2, (b) X ∼unif[−1, 1]
and Y = X2, (c) X = cos(U) and Y = sin(U), where U ∼unif[0, 2π], and
(d) X ∼N(0, 1) and Y = X2.
96. Let X and Y be independent and uniform on [0, 1]. Let A be the area and C the
circumference of a rectangle with sides X and Y. Find the correlation coefﬁcient
of A and C.
97. Let X and Y be independent with the same variance σ2, and let S = X + Y and
T = XY. Under what conditions are S and T uncorrelated?
98. Let (X, Y) be uniform on the region {(x, y) : 0 ≤x ≤1, 0 ≤y ≤x2}. Find
E[Y|X] and the best linear predictor l(X).
99. Let X and Y be independent, with the same mean μ and the same variance σ2,
and let Z = X + Y. Find ρ(X, Z). Explain intuitively in terms of the coefﬁcient
of determination.
100. You are dealt a bridge hand (13 cards). Let X be the number of aces and Y
the number of hearts. Show that X and Y are uncorrelated but not independent.
Hint: Write both X and Y as sums of indicators and show that indicators in one
sum are independent of indicators in the other.
101. Recall the sample mean ¯X from Problem 50. (a) Show that Cov[X1, ¯X] =
σ2/n and ﬁnd ρ(X1, ¯X). Interpret the value of ρ in terms of the coefﬁcient
of determination. (b) Show that ¯X and Xk −¯X are uncorrelated for each k =
1, 2, . . . , n.
Section 3.9. The Bivariate Normal Distribution
102. Which of the following are plots from a bivariate normal distribution? For those
that are, what can you say about variances and correlation? For those that are
not, what looks wrong?
103. A company manufactures rectangular metal plates of size 5 × 10 (inches). Ow-
ing to random ﬂuctuations, a randomly selected plate has a size of X × Y in.
where (X, Y) follows a bivariate normal distribution with means 5 and 10, vari-
ances 0.01 and 0.04, and correlation coefﬁcient 0.8. Let C be the circumference
and A the area of a plate. (a) Find E[C] and E[C|X = x]. (b) Find E[A] and
E[A|X = x]. (c) A plate is useless if C is less than 29 or more than 31 in.
What is the probability that this happens? (d) If the sidelength X of a plate is
measured to be 5.1 in., what is the probability that the plate is useless? (e) One
way to improve the process is to reduce the variances of X and Y. Suppose that

256
JOINT DISTRIBUTIONS
(a)
(d)
(g)
(b)
(e)
(h)
(c)
(f)
(i)
we can calibrate the process so that both variances are reduced by a factor c
(so that X has variance 0.01c and Y 0.04c). To get the probability in (c) down
below 0.01, how small must c be?
104. Suppose that the weights (in kilograms) of Norwegian salmon of a certain age
follow a normal distribution with mean 20 and variance 15 and that those of
Canadian salmon of the same age are normal with mean 22 and variance 21.
What is the probability that a randomly chosen Norwegian salmon weighs more
than a randomly chosen Canadian one?
105. Lead ﬁshing sinkers of two types are being manufactured. One type has weights
N(5, 1) and the other N(7, 1) (ounces). Choose one of each, and let X and Y
be their weights. Find (a) P(X ≥Y), and (b) P(Y ≥2X). (c) Let ¯X and ¯Y be
the average weights of n sinkers of the two types. How large must n be for
P( ¯Y ≥¯X) to be at least 0.99?
106. Let X ∼N(0, 1) and let Y be a random variable such that
Y =

X if |X| ≤1
−X if |X| > 1

PROBLEMS
257
(a) Show that Y ∼N(0, 1). (b) Is (X, Y) bivariate normal?
107. Let (X, Y) be bivariate normal with means 0, variances 1, and correlation co-
efﬁcient ρ > 0, and let U = X + Y, V = X −Y. What is the joint distribution
of (U, V)?
108. Two types of lightbulbs are being manufactured, one whose lifetime is
N(1000, 100) and the other whose lifetime is N(800, 81) (hours). (a) Choose
one of each type and let Z be the average lifetime. Express the pdf of Z in terms
of the standard normal pdf ϕ. (b) Choose a lightbulb at random, so that it is
equally likely to be of either type, and let W be its lifetime. Express the pdf of X
in terms of the standard normal pdf ϕ. Does W have a normal distribution? What
does its pdf look like? Hint: Write W as IX + (1 −I)Y, where I is a suitably
chosen indicator. (c) Find the means and variances of Z and W. Compare.
Section 3.10. Multidimensional Random Vectors
109. Consider the following variation of Example 3.52. Instead of accepting the ﬁrst
bid that is higher than the ﬁrst, you decide to accept the ﬁrst bid that is higher
than the one immediately preceding it. Let N be the number of the bid you
accept. Deﬁne N formally and ﬁnd E[N].
110. In the previous problem, suppose that you instead decide to take the ﬁrst offer
that exceeds c dollars. If the independent bids have cdf F, what is E[N]?
111. The Old Faithful geyser in Yellowstone National Park is so named for its regular
eruptions, about once an hour on average. However, most tourists have to wait
for more than half an hour, which they think indicates that the geyser is slowing
down. (a) Explain why their longer waiting times do not contradict hourly
eruptions. (b) Suppose that times between eruptions are i.i.d. random variables
that are uniform between 30 and 90 min. What is the expected wait for an
arriving tourist (recall Example 3.49)?
112. Consider a parallel system of n components whose lifetimes are i.i.d. exp(λ).
Find the pdf of the lifetime of the system.
113. Let X1, . . . , Xn be i.i.d. and continuous with cdf F and pdf f. Find the pdf of
X(j), the jth smallest order statistic. Hint: Let N(x) be the number of Xk that
are less than or equal to x and express the event {X(j) ≤x} in terms of N(x).
What is the distribution of N(x)?
114. Consider the sinkers from Problem 105 with weights that are N(5, 1) and
N(7, 1), respectively. Choose one of each and let M be the maximum weight
of the two. (a) Express the pdf of M in terms of the standard normal cdf 
 and
pdf ϕ. (b) Find P(M ≤6).
115. Let X1, . . . , Xn be i.i.d. exponential with parameter λ. Show that the expected
value of the maximum X(n) is approximately log n/λ for large n. Hint: Example
3.51.
116. Let X1, . . . , Xn be independent such that Xk has cdf Fk(x) and pdf fk(x). Find
the cdf and pdf of X(1) and X(n).

258
JOINT DISTRIBUTIONS
117. Let X, Y, Z and W be i.i.d. continuous random variables. Find the probability
that (a) X > Y and Z < W, (b) X < Y < Z < W, (c) X < Y < Z > W, and
(d) X < Y > Z > W.
118. You and four other people are bidding at a silent auction. The bids are inde-
pendent and you assume that the other bids are uniform on [100, 200] dollars.
How much must you bid to be at least 90% sure to win the bidding?
119. An electronic component has failure rate function r(t) = a + r1(t) + r2(t),
where a is a constant, r1(t) is an increasing function, and r2(t) is decreasing.
What does the failure rate function r(t) describe?
120. Consider a parallel system of two components that have lifetimes that are
exp(1). When one of them breaks down, the other has to take more stress
and has a remaining lifetime that is exp(2). Find the failure rate function of
the system.
121. A machine manufactures two types of components with exponential lifetimes,
one with mean 1 and one with mean 1
2 year. Find the failure rate function of the
lifetime of a randomly chosen component.
122. Let X1 and X2 be jointly continuous with joint pdf f (not necessarily in-
dependent). Find an expression for the joint pdf of (X(1), X(2)) in terms
of f.
123. Consider the ABO classiﬁcation of blood types from Problem 52 in Chapter 1.
If you choose eight people at random, what is the probability that you get two
of each type?
124. Let (X1, . . . , Xr) have a multinomial distribution with parameters n and
(p1, . . . , pr). Use indicators to show that
Cov[Xj, Xk] = −npjpk
for j /= k. Why is it intuitively clear that the covariance is negative? What is
the correlation coefﬁcient?
125. Let X, Y, and Z be independent and N(1, 1). Find the probability that X + Y ≥
3Z.
126. Jobs arrive at a computer. When the computer is free, the waiting time W until
the next incoming job has an exponential distribution with mean 1 ms. The
time C it takes to complete a job has a uniform distribution with mean 0.5 ms.
Consider a time when the computer is free, and let T be the time until the next
job is completed. Find the pdf of T and sketch its graph.
127. Recall the Geiger counter from Example 3.29. Consider a time when the counter
registers a particle and let T be the time until the next registration. Find the pdf
of T.
128. Let X and Y be independent, both with pdf f(x) = exp(1 −x), x ≥1. Find the
pdf of X + Y.
129. Let X ∼exp(λ1) and Y ∼exp(λ2) be independent. Find the pdf of X + Y.

PROBLEMS
259
130. Let (X, Y) have joint pdf f(x, y). Show that the pdf of the sum X + Y is
fX+Y(x) =
 ∞
−∞
f(u, x −u)du
131. Let (X, Y) have joint pdf
f(x, y) = 1
2(x + y)e−(x+y), x, y ≥0
Find the pdf of X + Y.
Section 3.11. Generating Functions
132. Describe the random variables that have the following pgfs: (a) G(s) ≡1,
(b) G(s) = s, and (c) G(s) = 1
2(s + s2).
133. Let G be the pgf of a random variable X. Show that G is increasing and convex.
When is it strictly increasing? Strictly convex?
134. (a) Let X be the number when a fair die is rolled. Find the pgf of X. (b) Let S
be the sum when ﬁve fair dice are rolled. Find the pgf of S and describe how
you can use it to ﬁnd the probability P(S = 20).
135. (a) Let X ∼geom(p). Find the pgf of X. (b) Let Y ∼negbin(r, p) (see Problem
61, Chapter 2). Use (a) and Proposition 3.38 to ﬁnd the pgf of Y.
136. Let X and Y be independent random variables with range {1, 2, . . .} and pgfs
GX and GY. Show that
E

X
X + Y

=
 1
0
G′
X(s)GY(s) ds
137. Let X1, X2, . . . be i.i.d. nonnegative and integer valued, and let N ∼Poi(λ),
independent of Xk. If the random sum SN = X1 + · · · + XN has a Poisson
distribution with mean μ, what is the distribution of Xk?
138. In the department I am working in, there is a self-service coffee bar downstairs
from my ofﬁce. Each week I go down for coffee a number of times N, which has
a Poisson distribution with mean 20. Each time, I am equally likely to choose
the small size for 75 cents or the medium for one dollar, and I am equally likely
to pay directly or to record my purchase to pay later. At the end of a week, what
is my expected debt?
139. Jobs arrive at a computer at a rate of 1.8 jobs/day. Each job requires an exe-
cution time (in milliseconds) that has a binomial distribution with n = 10 and
p = 0.5 (where a zero execution time means that the job is rejected). Find
(a) the probability that the total execution time in a day for this type of job is at
least 2 ms, and (b) the expected total execution time in a day.
140. Cars arrive at a park entrance such that the number of cars in 1 h has a Poisson
distribution with mean 4. Each car is equally likely to contain one, two, three, or
four people. Let Y be the number of people who arrive at the park during an hour.

260
JOINT DISTRIBUTIONS
Find (after making appropriate assumptions) (a) the pgf of Y, (b) P(Y = 0),
and (c) E[Y] and Var[Y].
141. Roll a fair die repeatedly and keep track of the numbers. When the ﬁrst 6
shows up, you add what you have thus far, not including the 6. Hence, we have
X1, X2, . . . i.i.d. die rolls, N ∼geom(1/6), and observe
Y =
N−1

k=1
Xk
where Y is 0 if we get 6 in the ﬁrst roll. We wish to ﬁnd the expected value of
Y. By Proposition 3.13, we get E[Y] = E[N −1]E[X] that equals 5 × 3.5 =
17.5. We could also argue that the values we add cannot contain any 6s and
are thus uniform on 1, 2, . . . , 5, which would instead give E[Y] = 5 × 3 = 15.
Which of the answers is correct? Does Proposition 3.13 apply?
142. Let X1, X2, . . . be i.i.d. nonnegative with cdf F and let N be nonnegative and
integer valued with pgf G, independent of Xk. Let MN = max(X1, . . . , XN)
with MN = 0 if N = 0. (a) Show that P(MN ≤x) = G(F(x)). If Xk are con-
tinuous, what type of distribution does MN have? (b) You are bidding on a silent
auction where the number of other bidders has a Poisson distribution with mean
2. Bids are independent and uniform on [0, 100] dollars. What is the minimum
amount that you would need to bet to be at least 90% sure to win the bidding?
143. If we allow random variables to take on inﬁnite values, the pgf can still be
deﬁned in the same way, but many of the results are no longer valid. Let X take
values in {0, 1, . . . , ∞} and have pgf G, and let p = P(X = ∞) > 0. (a) Show
that G(1) = 1 −p (recall Problem 11 in Chapter 2). (b) Give an example to
show that we may have E[X] /= G′(1).
144. Let X have mgf M(t). Show that
M(t) =
∞

k=0
tk
k!E[Xk]
145. Let X ∼N(0, 1). Use the mgf to ﬁnd E[X3] and E[X4].
146. Let X have the Cauchy distribution from Section 2.8.3. Show that the mgf of X
does not exist (in the sense that the integral deﬁning it is of the form “∞−∞”).
147. There is an analog to Proposition 3.39 that deals with mgfs. Thus, let X1, X2, . . .
be i.i.d. random variables with common mgf MX and common mean μ, and let
N be nonnegative and integer valued, and independent of the Xk, with pgf GN
(note that this is the pgf). (a) Show that SN has mgf
MSN(t) = GN(MX(t)),
t ∈R
(b) Let Xk ∼exp(λ) and let N ∼geom(p). Show that SN ∼exp(λp). (c) Show
that E[SN] = E[N]μ.

PROBLEMS
261
148. Let X1, X2, . . . be i.i.d. N(0, 1), and let Sn = X1 + · · · + Xn, in which case we
know that Sn ∼N(0, n). Now roll a die to decide how many Xk to sum. Find
the mgf of the resulting sum. Is it normal, and if so, what are the parameters?
149. If X and Y are nonnegative and integer valued, the function G(s, t) =
E[sXtY], 0 ≤s ≤1, 0 ≤t ≤1 is called the joint pgf of X and Y. (a) Express
the pgfs of X and Y in terms of G. (b) Use differentiation to ﬁnd formulas for
expected values, variances, and the covariance of X and Y. (c) Show that the
joint pgf G uniquely determines the joint pmf p of (X, Y) and that X and Y are
independent if and only if G = GXGY. (d) Suggest how to deﬁne the joint mgf
and do (a) and (b) in this case.
Section 3.12. The Poisson Process
150. Alaska has over half of all earthquakes in the United States. In particular, earth-
quakes withmagnitude >8 ontheRichterscaleoccur inAlaskaonaverageevery
13 years. Suppose that these occur according to a Poisson process. Compute
the probability that (a) a decade has no such earthquakes, (b) two consecutive
such earthquakes are at least 5 years apart, (c) a 13-year period has exactly
one such earthquake, and (d) three consecutive decades have exactly one such
earthquake each.
151. Trafﬁc accidents in a town occur according to a Poisson process at a rate of
two accidents per week. (a) What is the probability that a given day has no
accidents? (b) Whenever there is an accident, the risk is 1 in 10 that it will
cause personal injury. What is the probability that a given month has at least
one such accident? (c) Let N be the number of accident-free weeks in a year.
What is the distribution of N?
152. In any given hurricane season (6 months from June to November), there is about
a 50–50 chance that the Gulf Coast will be hit by a hurricane. Assume a Poisson
process with rate λ and use time unit “months.” (a) Find the value of λ. (b) Let
X be the number of hurricanes that hit the Gulf Coast during the months of
August and September. What is the distribution of X (name and parameter(s))?
(c) Let Y be the number of months that have no hits during one season. What
is the distribution of Y (name and parameter(s))?
153. Large meteorites hit Earth on average once every 1000 years. Find (a) the
probability that Earth gets hit within the next 1000 years, (b) the probability
that Earth gets hit more than once within the next 1000 years, and (c) the
probability that there are no hits within the next 100 years.
154. Consider a radioactive sample that decays at rate λ. You turn on the Geiger
counter, wait for the ﬁrst registered emission, and wonder how long this takes
on average. Since the timepoint at which you turned it on is completely arbitrary
and independent of the decay process, you ﬁgure out that you ought to be on
average in the middle between two consecutive emissions, and since the average
time between two emissions is 1/λ, you decide that the average wait must be

262
JOINT DISTRIBUTIONS
1/(2λ). However, experience tells you that the average wait is longer. Explain!
What is the average wait?
155. Explain Problem 147(b) in terms of thinning of Poisson processes.
156. Consider two independent Poisson processes with rates λ1 and λ2. Given that
a total of n points are observed in the interval [0, t], what is the probability that
k of those came from the ﬁrst process? Hint: Problem 25.
157. Southbound and northbound cars pass a point on a rural highway according
to two independent Poisson processes at rates two and three cars per minute,
respectively. (a) What is the probability that exactly two cars pass in a given
minute? (b) What is the probability that exactly one northbound car and one
southbound car pass in a given minute? (c) If two cars pass in a minute, what
is the probability that they are both northbound? (d) If four cars pass between
11:55 am and 12:05 pm, what is the probability that two pass before and two
after noon.
158. Accidents in a town occur according to a Poisson process at a rate of two acci-
dents per week. Two towing companies, Adam’s Towing and Barry’s Wrecker,
have agreed to take turns in dealing with the accidents on a weekly basis. Adam,
who has been in town longer, takes care of the ﬁrst accident of the week, Barry
the second, and so on. (a) Consider the process of accidents that Adam takes
care of. Is this a Poisson process? If so, what is the rate? (b) What is the prob-
ability that Barry gets no business in a given week? (c) What is the probability
that Adam and Barry get an equal amount of business in a given week?
159. Consider the superposition of two independent Poisson processes with rates
μ and λ, respectively. Let X be the number of points in the ﬁrst between two
consecutive points in the second. Show that X has a geometric distribution
including 0 (see Section 2.5.3) and identify the success probability. Explain
intuitively. You may need to utilize the fact that
 ∞
0
e−axxkdx = k!/ak+1 or
you can use generating functions.

4
LIMIT THEOREMS
4.1
INTRODUCTION
In advanced studies of probability theory, limit theorems form the most important
class of results. A limit theorem typically starts with a sequence of random variables,
X1, X2, . . . and investigates properties of some function of X1, X2, . . . , Xn as n →
∞. From a practical point of view, this allows us to use the limit as an approximation
to an exact quantity that may be difﬁcult to compute.
When we introduced expected values, we argued that these could be consid-
ered averages of a large number of observations. Thus, if we have observations
X1, X2, . . . , Xn and we do not know the mean μ, a reasonable approximation ought
to be the sample mean
¯X = 1
n
n

k=1
Xk
in other words, the average of X1, . . . , Xn. Suppose now that the Xk are i.i.d. with
mean μ and variance σ2. By the formulas for the mean and variance of sums of
independent random variables, we get
E[ ¯X] = E

1
n
n

k=1
Xk

=
n

k=1
1
nE[Xk] = μ
Probability, Statistics, and Stochastic Processes, Second Edition. Peter Olofsson and Mikael Andersson.
© 2012 John Wiley & Sons, Inc. Published 2012 by John Wiley & Sons, Inc.
263

264
LIMIT THEOREMS
and
Var[ ¯X] = Var

1
n
n

k=1
Xk

=
n

k=1
1
n2 Var[Xk] = σ2
n
that is, ¯X has the same expected value as each individual Xk and a variance that
becomes smaller the larger the value of n. This indicates that ¯X is likely to be close
to μ for large values of n. Since the variance goes to 0, we might want to say that
“ ¯X converges to μ as n →∞,” but exactly what does this mean? For a sequence of
real numbers, an →a means that for any ϵ > 0, we can always make |an −a| < ϵ if
n is large enough. This cannot be true for ¯X and μ, though. Since ¯X is random, we
can never say for certain that we will have | ¯X −μ| < ϵ from some n on. We need to
come up with a deﬁnition of what convergence means for random quantities such as
¯X, and in the next section we address this issue.
4.2
THE LAW OF LARGE NUMBERS
Although we can never guarantee that | ¯X −μ| is smaller than a given ϵ, we can say
that it is very likely that | ¯X −μ| is small if n is large. That is the idea behind the
following result.
Theorem 4.1. (The Law of Large Numbers).
Let X1, X2, . . . be a sequence of
i.i.d. random variables with mean μ, and let ¯X be their sample mean. Then, for
every ϵ > 0
P(| ¯X −μ| > ϵ) →0 as n →∞
Proof. Assume that the Xk have ﬁnite variance, σ2 < ∞. Apply Chebyshev’s in-
equality to ¯X and let c = ϵ√n/σ. Since E[ ¯X] = μ and Var[ ¯X] = σ2/n, we get
P(| ¯X −μ| > ϵ) ≤σ2
nϵ2 →0 as n →∞
The assumption of ﬁnite variance is necessary for this proof to work. However, the
law of large numbers is true also if the variance is inﬁnite, but the proof in that case
is more involved and we will not give it.
■
We say that ¯X converges in probability to μ and write
¯X
P→μ as n →∞

THE LAW OF LARGE NUMBERS
265
0
1000
2000
3000
4000
5000
0 
2 
4 
6 
0
50
100
150
200
1 
 2 
3 
4 
5 
6 
FIGURE 4.1
Consecutive averages of 200 (left) and 5000 (right) simulated rolls of a fair
die.
The law of large numbers thus states that although we can never be certain that ¯X is
within ±ϵ of μ, the probability that this happens approaches one as n increases.1
In general, if Y1, Y2, . . . is any sequence of random variables and a a constant,
Yn
P→a means that P(|Yn −a| > ϵ) →0 as n →∞for all ϵ > 0. It is also possible
to have a random variable Y in the limit instead of the constant a but we will not
consider any such examples.
To illustrate the law of large numbers, let us consider the example of rolling a
die. In the left plot in Figure 4.1, consecutive averages in a total of 200 rolls are
plotted. Note the typical wild ﬂuctuations in the beginning, followed by a fairly rapid
stabilization around the mean 3.5. After about 130 rolls, the average appears to have
settled, but then there is a sudden decline after roll 160. By pure chance, between rolls
160 and 180, there were unusually large numbers of ones and twos which dragged the
average down. In the right plot in Figure 4.1, the sequence is continued to 5000 rolls.
The dip around 180 is visible, as are a few subsequent excursions above and below
3.5, but after that, all deviations are signiﬁcantly smaller in size. If another sequence
of 20 rolls similar to that between 160 and 180 would occur after 5000 rolls, it would
have no visible impact.
A consequence of the law of large numbers is that we can now prove that the
probabilityofaneventisthelimitoftherelativefrequencies.Recallhowwementioned
this as a source of inspiration for the axioms of probability and how we have often
argued that we can think of a probability as a relative frequency in a large number of
trials.
1More precisely, for ﬁxed ϵ > 0 we can never be certain that ¯X is in μ ± ϵ for any ﬁxed n. However, it can
be shown that the probability is one that ¯X will eventually be in μ ± ϵ but this occurs at a random N so in
practice we never know whether it has actually occurred. The exact formulation is P( ¯X →μ) = 1, a type
of convergence called convergence almost surely, which is stronger than convergence in probability. The
distinction between these two convergence concepts is crucial in a more advanced treatment of probability
theory; we will consider convergence only in probability.

266
LIMIT THEOREMS
Corollary 4.1. Consider an experiment where the event A occurs with probability
p. Repeat the experiment independently, let Sn be the number of times we get the
event A in n trials, and let fn = Sn/n, the relative frequency. Then
fn
P→p as n →∞
Proof. Deﬁne the indicators
Ik =

1
if we get A in the kth trial
0
otherwise
for k = 1, 2, . . . , n. Then the Ik are i.i.d. and we know from Section 2.5.1 that they
have mean μ = p. Since fn is the sample mean of the Ik, the law of large numbers
gives fn
P→p as n →∞.
■
The law of large numbers is also popularly known as the “law of averages” and is
frequently misunderstood. Let us illustrate some of the common misperceptions by
considering the experiment of ﬂipping a fair coin.
The ﬁrst mistake we examine is the confusion between relative and absolute fre-
quencies. If we ﬂip the coin n times and let Sn be the number of heads, this is the
absolute frequency and fn = Sn/n is the relative frequency. The expected value of
Sn is n
2, and the expected value of fn is 1
2. The law of large numbers states that fn
gets close to 1
2, not that Sn gets close to n
2. In fact, the difference |Sn −n
2| tends to
increase with n, which is illustrated in Figure 4.2. In the next section, we will see that
the rate of increase is on the order of √n.
Thesecondmistakeistheincorrectnotionthatextremeoccurrencesinonedirection
are compensated by extreme occurrences in the other. As an illustration, look at
Figure 4.3, where the consecutive relative frequencies in a total of 200 coin ﬂips are
plotted. This is a sequence of coin ﬂips that had an unusually large number of tails
0
5000
10000
0 
20 
40 
60 
80 
0
5000
10000
0 
0.2 
0.4 
0.6 
0.8 
1 
FIGURE 4.2
Successive relative frequencies fn (left) and absolute differences |Sn −n
2|
(right) of repeated coin ﬂips. Note the stabilization to the left and the increase to the right.

THE LAW OF LARGE NUMBERS
267
0
50
100
150
200
0 
0.2 
0.4 
0.6 
0.8 
1 
FIGURE 4.3
Successive relative frequencies of repeated coin ﬂips.
in the beginning. After 100 ﬂips, there had only been 39 heads, quite far from the
expected number of 50, and thus the relative frequency f100 is only 0.39. The relative
frequencies slowly but steadily work their way up toward 0.5, and after 200 ﬂips
we get quite close. Now, this must mean that the unusually low number of heads in
the ﬁrst 100 ﬂips was compensated for by an unusually high number of heads in the
last 100 ﬂips, right?
Wrong! Actually, there were 54 heads in the last 100 ﬂips, not far from the expected
number of 50. If we had had exactly 50 heads in the last 100 ﬂips, the relative frequency
f200 would have been 89
200 = 0.445, signiﬁcantly higher than 0.39. Even if we got a
little bit less than the expected number of heads, say, 45, the relative frequency would
still go up, to 0.42. As we keep ﬂipping, the unusual number of heads in the ﬁrst 100
ﬂips will have less and less impact on the relative frequency. Thus, there is no trend
to compensate, only the persistence of completely normal behavior that in the long
run erodes the effects of any abnormalities.2
Sometimes, we are interested in a function of ¯X rather than ¯X itself. The following
result is useful.
Corollary 4.2. Let g be a continuous function. Under the conditions of the law of
large numbers
g( ¯X) P→g(μ) as n →∞
2My good friend, the eminent probabilist Jeff Steif, once pointed out to me over a roulette table that it is
sometimes better to be completely ignorant than to have only a little bit of knowledge. After seven straight
occurrences of red, the ignorant gambler does not blink (nor does Jeff), whereas he who has heard of, but
not understood, the law of large numbers believes that more occurrences of black must follow.

268
LIMIT THEOREMS
It certainly feels reasonable that if ¯X is close to μ, then g( ¯X) by continuity must be
close to g(μ). However, since “close” now refers to convergence in probability, it
must be shown that P(|g( ¯X) −g(μ)| > ϵ) →0. We omit the technical proof.
Example 4.1. In Example 3.13, we examined Buffon’s needle tossing scheme that
can be used as a primitive way to estimate π, based on the law of large numbers. We
saw that the probability that the needle intersects a line is 2/π, and if we let fn be the
relative frequency of intersections in n tosses, the law of large numbers tells us that
fn
P→2
π
as n →∞
and by Corollary 4.2 with g(x) = 2/x we get
2
fn
P→π as n →∞
which suggests the estimate 2/fn of π. We will later investigate how good an estimate
this is.
□
We ﬁnish this section with an example of convergence in probability that does not
involve the sample mean.
Example 4.2. Let X1, X2, . . . be i.i.d. exp(λ), and as usual let X(1) denote the
minimum of X1, . . . , Xn. Show that X(1)
P→0 as n →∞.
By Example 3.50 we have X(1) ∼exp(nλ) and hence for ﬁxed ϵ > 0
P(|X(1) −0| > ϵ) = P(X(1) > ϵ) = e−nλϵ →0
as n →∞.
□
4.3
THE CENTRAL LIMIT THEOREM
In the previous section, we saw that ¯X
P→μ as n →∞or, in other words, that ¯X ≈μ
if n is large. It would be good to also have an idea of how accurate this approximation
is, that is, have an idea of the extent to which ¯X tends to deviate from μ. The next
result gives the answer.
Theorem 4.2 (The Central Limit Theorem).
Let X1, X2, . . . be i.i.d. random
variables with mean μ and variance σ2 < ∞and let Sn = n
k=1 Xk. Then, for
each x ∈R, we have
P
Sn −nμ
σ√n
≤x

→(x)
as n →∞, where  is the cdf of the standard normal distribution.

THE CENTRAL LIMIT THEOREM
269
Before the proof, let us point out that this is a truly remarkable result. It states that
the cdfs of the random variables (Sn −nμ)/σ√n converge to the cdf of a standard
normal distribution. In other words, for large n
P
Sn −nμ
σ√n
≤x

≈(x)
which we can also write as
Sn −nμ
σ√n
d≈N(0, 1)
where “
d≈” is notation for approximate distribution. Since Sn has mean nμ and vari-
ance nσ2, we can also write this as
Sn
d≈N(nμ, nσ2)
Thus, the central limit theorem states that the sum of i.i.d. random variables has an
approximate normal distribution regardless of the distribution of the Xk! The Xk
do not even have to be continuous random variables; if we just add enough random
variables, the sum becomes approximately normal anyway.
The central limit theorem gives theoretical justiﬁcation for why the normal distri-
bution tends to show up so often in practice. If a quantity is the result of many small
independent contributions, it is likely to be approximately normal. For example, the
weight of a bag of potato chips is the sum of the weights of many individual chips.
Whatever the distribution of the weight of a single chip, the sum has an approximate
normal distribution. For another example, consider the change in location of a dust
particle in the air. This is due to the bombardment of a huge number of air molecules
from different directions, and when added up, the changes in coordinates are likely
to follow normal distributions.
Proof. We will only outline the proof and skip the details. The main idea is to work
with moment generating functions instead of working directly with the distribution
functions.Thus,wewillshowthatthemomentgeneratingfunctionof(Sn −nμ)/σ√n
converges to the moment generating function of a standard normal distribution.
Let us ﬁrst assume that μ = 0 and σ2 = 1. Let Yn = Sn/√n, and let M(t) be the
mgf of the Xk. Combining Corollary 3.14 and Proposition 3.40, we see that Yn has
mgf
MYn(t) =

M
 t
√n
n
(4.1)
Now do a Taylor expansion of M(s) around s = 0 to obtain
M(s) = M(0) + sM′(0) + s2 M′′(0)
2

270
LIMIT THEOREMS
where we have neglected the error term. By Corollary 3.15, we get
M(s) = 1 + s2
2
(remember that μ = 0 and σ2 = 1). By inserting this into Equation (4.1), we obtain
MYn(t) =

1 + t2
2n
n
→et2/2
as n →∞
which we recognize from Example 3.66 as the mgf of the standard normal distribution.
The result for general μ and σ2 follows by considering the random variables X∗
k =
(Xk −μ)/σ, which have mean 0 and variance 1, and we leave it to the reader to ﬁnish
the proof.
The details that we have omitted include an explanation of why convergence of
the mgfs is the same as convergence of the distribution functions (which is a fairly
deep result and not exactly a detail) and why the error term in the Taylor expansion
can be neglected as n →∞.
■
Example 4.3. You play 1000 rounds of roulette, each time betting $1. What is the
probability that you end up with a gain if you (a) bet on odd and (b) play straight bets?
Denote your gain in round k by Xk so that your total gain in n rounds is
Sn =
n

k=1
Xk
By the central limit theorem, Sn has an approximate normal distribution with mean
nμ and variance nσ2. We computed the means and variances in Example 2.26, and
for (a) we have
μ = −1
19
and
σ2 = 360
361
and with n = 1000 we get
P(Sn > 0) = 1 −P(Sn ≤0)
≈1 −
0 −1000 × (−1/19)
√1000 × 360/361

= 1 −(1.67) ≈0.05
For (b) we have
μ = −1
19
and
σ2 = 11988
361

THE CENTRAL LIMIT THEOREM
271
which gives
P(Sn > 0) ≈1 −
 0 −1000 × (−1/19)
√1000 × 11988/361

≈0.39
so you are much more likely to be ahead with the straight bet strategy. Now, the
expected gains are the same for the two strategies, so the strategy to bet on odd must
have some other advantage instead. To illustrate this, let us compute the probability
that you lose more than $100. With the straight bet strategy this is
P(Sn ≤−100) ≈
−100 −1000 × (−1/19)
√1000 × 11988/361

≈0.40
and with the strategy to bet on odd
P(Sn ≤−100) ≈
−100 −1000 × (−1/19)
√1000 × 360/361

≈0.07
so you are more likely to lose more money with the straight bet strategy. The smaller
variance of the strategy to bet on odd means that your loss is likely to be fairly close
to the expected loss of 1000 × 1
19 ≈53 dollars. With the straight bet strategy, there
is more ﬂuctuation and you take a greater risk for the chance to gain more.
□
Example 4.4. We have previously seen that the binomial distribution can be repre-
sented as a sum of indicators. Thus, if X ∼bin(n, p), the central limit theorem states
that
X −np
√np(1 −p)
d≈N(0, 1)
or equivalently
X
d≈N(np, np(1 −p))
Historically, this was among the ﬁrst versions of the central limit theorem that was
proved. It is often called the de Moivre–Laplace theorem. Figure 4.4 shows the pmfs
of three binomial distributions with p = 0.8 and n = 5, 10, and 100, respectively.
The pdfs of the corresponding approximating normal distributions are plotted for
comparison. Note how the binomial pmf for n = 5 is quite asymmetric but how the
pmfs become more symmetric as n increases. This suggests that the accuracy of the
normal approximation depends not only on n but also on p; the more symmetric
the binomial pmf is to start with, the better the approximation. This is indeed true; for
ﬁxed n, the approximation works best if p = 1
2 and gets worse as p approaches 0 or
1. A general rule of thumb for a decent approximation is that both np and n(1 −p)
should be at least 5.
□

272
LIMIT THEOREMS
70
80
90
4
8
12
0
1
2
3
4
5
6
7
8
FIGURE 4.4
The central limit theorem in action; pmfs for three binomial distributions
with parameters p = 0.8 and n = 5, 10, and 100, respectively. The dashed curve shows the
corresponding normal pdf.
If we divide Sn by n, we get
¯X
d≈N

μ, σ2
n

or in the case of relative frequencies,
fn
d≈N

p, p(1 −p)
n

(4.2)
Hence, we have two results about the sample mean ¯X: the law of large numbers,
which states that
¯X ≈μ
and the central limit theorem, which states that
¯X
d≈N

μ, σ2
n

Note how the ﬁrst result talks about the value of ¯X whereas the second talks about its
distribution. The type of convergence in the central limit theorem is therefore called
convergence in distribution, and we will return to this in Section 4.4.
We can now get an idea of how close ¯X tends to be to μ. The central limit theorem
gives
P(| ¯X −μ| > ϵ) ≈2

1 −
ϵ√n
σ

regardless of the distribution of the Xk.
Example 4.5. Consider again Buffon’s needle problem. Recall that the probability
that the randomly tossed needle intersects a line is 2/π and how we argued in the
previous section that 2/fn
P→π as n →∞. Let 	π denote our estimate of π after n
tosses:
	π = 2
fn

THE CENTRAL LIMIT THEOREM
273
As mentioned previously, Buffon himself actually intended that this experiment be
used to estimate π. Let us say that on some occasion he tossed the needle 1000 times.
What is the probability that he got the estimate correct to two decimals?
We wish to ﬁnd
P(|	π −3.14| ≤0.005) = P

2
3.145 ≤fn ≤
2
3.135

where, by Equation (4.2) with p = 2/π
fn
d≈N
 2
π, 2(π −2)
nπ2

With n = 1000 we now get
P(|	π −3.14| ≤0.005) = P

2
3.145 ≤f1000 ≤
2
3.135

= 

2/3.135 −2/π

2(π −2)/1000π2

−

2/3.145 −2/π

2(π −2)/1000π2

= (0.09) −(−0.05) ≈0.06
which is not a very good reward for all that needle tossing.
□
4.3.1
The Delta Method
We have learned that the sample mean ¯X has an approximate normal distribution. It is
often the case that we are interested in some function of the sample mean, g( ¯X), and we
already know from Corollary 4.2 that g( ¯X) converges in probability to g(μ). It would
be useful to also supplement this with a result about the approximate distribution
of g( ¯X). The following proposition, usually referred to as the delta method, gives
the answer. Although it should formally be stated as a limit result, we state it as an
approximation, which is how it is useful to us.
Proposition 4.1 (The Delta Method). Let X1, X2, . . . be i.i.d. with mean μ and
variance σ2, and let ¯X be the sample mean. Let further g be a function such that
g′(μ) /= 0. Then
g( ¯X)
d≈N

g(μ), σ2(g′(μ))2
n

for large n.

274
LIMIT THEOREMS
Proof. A ﬁrst-order Taylor expansion of g around μ gives
g( ¯X) ≈g(μ) + ( ¯X −μ)g′(μ)
where we know that
¯X
d≈N

μ, σ2
n

and since g( ¯X) is (approximately) a linear function of ¯X, we know that it has
(approximately) a normal distribution. The mean is
E[g( ¯X)] ≈g(μ) + g′(μ)E[ ¯X −μ] = g(μ)
since E[ ¯X −μ] = E[ ¯X] −μ = 0. The variance is
Var[g( ¯X)] ≈(g′(μ))2Var[ ¯X] = σ2(g′(μ))2
n
as was to be shown.
■
Note how there are two factors in the variance of g( ¯X): σ2/n, which measures how
much ¯X deviates from μ, and (g′(μ))2, which measures how sensitive the function g
is to deviations from μ. The smaller these quantities are, the better the approximation.
Example 4.6. Let X1, X2, . . . , Xn be i.i.d. random variables. The geometric mean Gn
is deﬁned as
Gn = (X1X2 · · · Xn)1/n
Suppose that the Xk are unif[0, 1]. Find the limit of Gn and its approximate
distribution for large n.
To be able to apply the law of large numbers, we need to transform the product into
a sum. Thus, let Yk = log Xk to obtain
log Gn = 1
n
n

k=1
Yk
that is
Gn = e ¯Y
By the law of large numbers, ¯Y
P→μ, where
μ = E[Yk] = E[log Xk] =
 1
0
log x dx = −1

CONVERGENCE IN DISTRIBUTION
275
Hence, ¯Y
P→−1, and since the function g(x) = ex is continuous, Proposition 4.1
gives
Gn
P→e−1
as n →∞. To get the approximate distribution, we apply the delta method to ¯Y
and the function g(x) = ex. We have g′(x) = ex that gives (g′(μ))2 = e−2, and since
σ2 = Var[Yk] = 1, we get the approximate distribution
Gn
d≈N

e−1, e−2
n

□
4.4
CONVERGENCE IN DISTRIBUTION
In the previous sections, we looked at two limit results: the law of large numbers and
the central limit theorem. As we pointed out, these are different in the sense that the
ﬁrst deals with convergence of ¯X itself and the second, with its distribution. In this
section, we take a closer look at this second type of convergence.
4.4.1
Discrete Limits
We ﬁrst consider the case of discrete random variables and state the following
deﬁnition.
Deﬁnition 4.1. Let X1, X2, . . . be a sequence of discrete random variables such
that Xn has pmf pXn. If X is a discrete random variable with pmf pX and
pXn(x) →pX(x) as n →∞for all x
then we say that Xn converges in distribution to X, written Xn
d→X.
This limit result is used much in the same way as we used our previous limit results,
as the approximation P(Xn = x) ≈P(X = x). The largest and most useful class of
limit theorems for discrete random variables is when the limiting random variable
has a Poisson distribution. Let us look at the simplest example of this: the Poisson
approximation of the binomial distribution. In Section 2.5.4, we learned that if X is
bin(n, p), where n is large and p small, then X is approximately Poi(np). We will
now state a limit result that motivates the approximation.
Proposition 4.2. Let X1, X2, . . . be a sequence of random variables such that Xn ∼
bin(n, pn), where npn →λ > 0 as n →∞, and let X ∼Poi(λ). Then Xn
d→X.

276
LIMIT THEOREMS
Proof. We sketch a proof based on probability generating functions. Let Gn(s) be the
pgf of Xn so that
Gn(s) = (1 −pn + pns)n
of which we take the logarithm to obtain
log Gn(s) = n log(1 + pn(s −1))
Now, by a Taylor expansion around 0, we obtain
log(1 + x) ≈x
(4.3)
for small x. Since npn →λ > 0, we must have pn →0, and the approximation in
Equation (4.3) can be used to get
log Gn(s) = n log(1 + pn(s −1))
≈npn(s −1) →λ(s −1) as n →∞
Hence
Gn(s) →eλ(s−1) as n →∞
where we recognize the limit as the pgf of a Poisson distribution with parameter λ.
It is true but not trivial that convergence of the pmfs is equivalent to convergence of
the pgfs. We will not prove this.
■
Hence, the informal statement “large n and small p” can be formalized as npn →λ,
and the limit result legitimizes the use of the approximation.
Another approximation was suggested in Section 2.5.5, where the hypergeometric
distribution was considered. We argued that under some circumstances, sampling with
or without replacement ought to give approximately the same result. Thus, if X ∼
hypergeom(N, r, n), then
P(X = k) =
r
k
N −r
n −k

N
n

≈
n
k
  r
N
k 
1 −r
N
n−k
The limit result that justiﬁes the approximation is stated in the following proposition.
It is proved by a direct computation according to Deﬁnition 4.1 and we leave the proof
as an exercise.
Proposition 4.3.
Let XN ∼hypergeom(N, r, n), where N →∞and r/N →
p > 0, and let X ∼bin(n, p). Then
XN
d→X as N →∞

CONVERGENCE IN DISTRIBUTION
277
In words, the approximation works well if n is small and r is moderate relative to N.
We leave it to the reader to contemplate what may go wrong if n is too large or if r is
either too large or too small.
4.4.2
Continuous Limits
Let us next consider the case when the limiting random variable is continuous. As
we already know from the de Moivre–Laplace theorem, the limit can be continuous
even if the random variables themselves are not.
Deﬁnition 4.2. Let X1, X2, . . . be a sequence of random variables such that Xn has
cdf Fn. If X is a continuous random variable with cdf F and
Fn(x) →F(x) as n →∞for all x ∈R
we say that Xn converges in distribution to X, written Xn
d→X.
The most important result of this type is the central limit theorem. Another class of im-
portant results regarding convergence in distribution deals with the so-called extreme
values, for example, the minimum or maximum in a sequence of random variables.
Example 4.7. Let X1, X2, . . . be i.i.d. random variables that are unif[0, 1], and
let X(1) = min(X1, . . . , Xn), the minimum of the n ﬁrst Xk. As n increases, X(1)
can only get smaller so as n →∞, we expect X(1) to go to 0. However, if we
adjust for this by multiplying X(1) by a suitable factor, we can get something inter-
esting in the limit. Thus, let Yn = nX(1) and let Y ∼exp(1). Then Yn
d→Y as n →∞.
Note that the range of Yn is [0, n] and that of Y is [0, ∞). We need to ﬁnd the cdf of
Yn and get
FYn(x) = P(nX(1) ≤x) = P

X(1) ≤x
n

In Section 3.10.1, we studied order statistics, and by Proposition 3.31 we have
P(X(1) ≤t) = 1 −(1 −t)n,
0 ≤t ≤1
which gives
FY(n)(x) = 1 −

1 −x
n
n
→1 −e−x
as n →∞
which is the cdf of Y ∼exp(1). Note that this holds for any x since eventually n will
be large enough so that x is in the range of Yn. Thus, we have that nX(1)
d≈exp(1),
which can be used to approximate probabilities for X(1), for example, as
P(X(1) ≤x) = P(nX(1) ≤nx) ≈1 −e−nx,
0 ≤x ≤1
□

278
LIMIT THEOREMS
PROBLEMS
Section 4.2. The Law of Large Numbers
1. Let X1, X2, . . . be a sequence of random variables with the same mean μ and
variance σ2, which are such that Cov[Xj, Xk] < 0 for all j /= k. Show that
¯X P→μ as n →∞.
2. Let X1, X2, . . . and Y1, Y2, . . . be two sequences of random variables and a and
b two constants such that Xn
P→a and Yn
P→b. Show that Xn + Yn
P→a + b.
Hint: Problem 10 in Chapter 2.
3. Let X1, X2, . . . be i.i.d. unif[0, 1] and let g : [0, 1] →R be a function. What is
the limit of n
k=1 g(Xk)/n as n →∞? How can this result be used?
4. Let X1, X2, . . . , Xn be i.i.d. random variables. The harmonic mean is deﬁned
as
Hn =

1
n
n

k=1
1
Xk
−1
Suppose that the pdf of the Xk is f(x) = 3x2,
0 ≤x ≤1, and ﬁnd the limit
of Hn as n →∞.
5. Let X1, X2, . . . be i.i.d. continuous with a pdf that is strictly positive in some
interval [0, a]. Show that X(1)
P→0 as n →∞.
6. Let X1, X2, . . . be i.i.d. exp(1). Show that X(n)/ log n P→1 as n →∞.
Section 4.3. The Central Limit Theorem
7. In Problem 53(a) and (b), Chapter 3, what happens as n →∞? Explain this in
the light of the central limit theorem.
8. Use the central limit theorem to argue that the following random variables are
approximately normal; also give the parameters: (a) X ∼(n, λ) for large n
and (b) X ∼Poi(λ) for large λ.
9. Radioactive decay of an element occurs according to a Poisson process with
rate 10, 000 per second. What is the approximate probability that the millionth
decay occurs within 100.2 s?
10. In any given day, a certain email account gets a number of spam emails that has
a Poisson distribution with mean 200. What is the approximate probability that
it receives less than 190 spam emails in a day?
11. How many times do you need to roll a die to be at least ≈99% certain that the
sample mean is between 3 and 4?
12. Let X ∼bin(5, 0.8). Compute P(X ≤k) for k = 4, 5, and 6, both exactly and
with the approximate normal distribution. Compare and comment.

PROBLEMS
279
13. A multiple-choice test has 100 questions, each with four alternatives. At least
80 correct answers are required for a passing grade. On each question, you
know the correct answer with probability 3
4, otherwise you guess at random.
What is the (approximate) probability that you pass?
14. In Buffon’s needle problem, what is the probability that the value of π is correct
to one decimal?
15. A parking lot is planned for a new apartment complex with 200 apartments.
For each apartment it is assumed that the number of cars is 0, 1, or 2, with
probabilities 0.1, 0.6, and 0.3, respectively. In order to be approximately 95%
certain that there is room for all cars, how many spaces must the parking lot
have?
16. Let X be a random variable with mean μ and variance σ2, and let g be a
differentiable function. Use the idea in the proof of the delta method to deduce
the two approximations
E[g(X)] ≈g(μ)
and E[g(X)] ≈g(μ) + σ2g′′(μ)
2
Compare these if X ∼unif[0, 1] for (a) g(x) = x, (b) g(x) = x2, (c) g(x) = x4,
(d) g(x) = ex, (e) g(x) = e−x, (f) g(x) = sin(πx), and (g) g(x) = sin(2πx).
17. Consider Buffon’s needle problem. Use the delta method to compute how many
times we must toss the needle in order to be at least 95% certain to be within
±0.01 of π?
18. Consider Problem 4. Find the approximate distribution of Hn for large n.
Section 4.4. Convergence in Distribution
19. Let X ∼hypergeom(N, r, n). Argue that X has an approximate Poisson dis-
tribution and what is required of the parameters for the approximation to
be justiﬁed. Try to both state a formal limit result and give an intuitive
argument.
20. Let X1, X2, . . . be a sequence of random variables such that Xn is uniform on
the set {0, 1, . . . , n}, and let X ∼unif[0, 1]. Show that Xn/n
d→X as n →∞.
21. Let X1, X2, . . . be a sequence of random variables such that Xn ∼geom(1/n),
and let X ∼exp(1). Show that Xn/n
d→X as n →∞.
22. Let X1, X2, . . . be i.i.d. unif[0, 1], let Yn = n(1 −X(n)), where X(n) is the max-
imum, and let Y ∼exp(1). Show that Yn
d→Y as n →∞.
23. Let X1, X2, . . . be i.i.d. exp(λ), and let Y ∼exp(1). Show that X1/ ¯X
d→Y as
n →∞. Hint: Let the Xk be interarrival times in a Poisson process, and use
the order statistic property from Proposition 3.43.

280
LIMIT THEOREMS
24. Let X1, X2, . . . be i.i.d. random variables with pdf f(x) = 2x, 0 ≤x ≤1. Show
that the sequence of random variables Yn = √nX(1) converges in distribution
to a random variable Y that has a Weibull distribution. What are the parameters?
25. Let X1, X2, . . . be i.i.d. random variables with pdf f(x) = 3x2, 0 ≤x ≤1.
Find a sequence an such that the random variables Yn = anX(1) converges in
distribution to a random variable Y, and identify the distribution of Y.

5
SIMULATION
5.1
INTRODUCTION
Simulation is one of the most commonly used techniques to gain information about
complicated systems, but the term simulation is used to convey many different
meanings. According to the Merriam-Webster Online Dictionary, simulation is “the
imitative representation of the functioning of one system or process by means of
the functioning of another.” We probably think of simulation as something involving
computers, but it does not have to be so. For example, airplanes ﬂying in speciﬁc
parabolic patterns are used in astronaut training to simulate weightless conditions in
space. Even when we restrict our attention to computer simulation, there are many
different meanings. For example, an airline pilot in training sits in a ﬂight simulator,
and a mathematician may simulate a numerical solution to a differential equation
by plugging in different starting values in an algorithm. For us, however, simulation
will always mean “imitating randomness,” and for this reason the term stochastic
simulation is often used. The term Monte Carlo simulation is also common.
The main use of stochastic simulation is to approximate quantities that are difﬁcult
to obtain analytically. To take a frivolous example from the world of gambling, in
roulette it is easy to specify a probability model and compute probabilities of winning,
expected gains, and so on. But what about the game of blackjack? This is a card game
played against a dealer where you are dealt cards one by one and after each card
decide whether to stop or take another card. The dealer has one card face up that you
can see. If you go above 21, you lose. If you stop below 21, the dealer draws cards
Probability, Statistics, and Stochastic Processes, Second Edition. Peter Olofsson and Mikael Andersson.
© 2012 John Wiley & Sons, Inc. Published 2012 by John Wiley & Sons, Inc.
281

282
SIMULATION
and must stop at or above 17. If the dealer goes over 21, you win, otherwise whoever
has the higher total wins. It is difﬁcult to ﬁnd exact answers to questions such as “If
I adopt a particular strategy, what is the probability that I win?” but it is easy to run a
computer simulation of the game.
When we use simulations, we rely on the law of large numbers. Suppose, for
instance, that we wish to ﬁnd an approximate value of p, the probability of winning
in blackjack using some particular strategy. We run a number n of simulated rounds
of the game and observe wins in X of them. The relative frequency X/n is our
approximation of p, and we know by the law of large numbers that this gets close to p
for large n (and “large n” is something we can often guarantee in simulation studies).
If we are interested in the expected gain, μ, save the gain in each round to obtain a
sequence Y1, Y2, . . . , Yn of gains and use the sample mean ¯Y to approximate μ.
We have already seen how simulated data can be used to illustrate concepts such
as pmf, pdf, and expected value. Such data can be generated for a wide variety of
distributions by using ready-made routines in any of the major mathematical or sta-
tistical software packages (Matlab has been used in our examples). In this chapter,
we take a closer look at how such simulated data are generated.
5.2
RANDOM NUMBER GENERATION
The most fundamental object in simulation is the standard uniform distribution. Even
simple calculators can often generate what are usually called random numbers, which
are precisely simulated observations from the standard uniform distribution. So how
do we simulate the standard uniform distribution?
There are several issues, and we will not address them all. An immediate
problem that comes to mind is that [0, 1] is an entire interval, but a computer
has only ﬁnite precision. Hence, we must be satisﬁed with values on some lattice
{0, 1
m, . . . , m−1
m , 1}, which is not too serious a restriction if m is large. One way to do
this is to generate random integers between 0 and m and divide them by m. In other
words, if Y has the discrete uniform distribution on {0, 1, . . . , m}, then U = Y/m
has the discrete uniform distribution on {0, 1
m, . . . , m−1
m , 1}, which for large m is
an acceptable approximation. But this only shifted the problem to how to generate
random integers. How do we do that?
Here is where we must admit that random number generators seldom produce
“truly” random numbers. Instead, deterministic algorithms are used that produce
sequences that “look random.” For this reason, the term pseudorandom numbers is
often used.1 We want to achieve two main goals: that the numbers seem to have a
uniform distribution and that they seem independent. One common way to generate
random integers is by congruential random number generators (or power residue
generators). These start with a value Y0, the seed, and generate a sequence of integers
by computing the next from the previous according to the formula
Yn+1 = aYn + b (mod (m + 1))
1Incidentally, Merriam-Webster also gives the alternative meaning of simulation as “a sham object.”

SIMULATION OF DISCRETE DISTRIBUTIONS
283
where a, b, and m are ﬁxed integers. Note that the sequence is periodic since once
a value is repeated, the entire sequence will be repeated. Let us now take m = 19,
a = b = 1, and Y0 = 0. We get
Y1 = 1 × Y0 + 1 (mod 20) = 1
Y2 = 1 × Y1 + 1 (mod 20) = 2
...
Y19 = 1 × Y18 + 1 (mod 20) = 19
Y20 = 1 × Y19 + 1 (mod 20) = 20 (mod 20) = 0
which gives the sequence 0, 1, 2, . . . , 19, 0, 1, 2, . . . , 19, 0, 1, 2, . . . , where each
number in the long run shows up with relative frequency 1
20, so the distribution would
look uniform. However, the observations do not look independent. Indeed, if we are
presented this sequence, we would quickly ﬁgure out the algorithm that produced it.
Not good. Let us instead try m = 19, a = 5, b = 3, and Y0 = 0. We now get
Y1 = 5 × 0 + 3 (mod 20) = 3
Y2 = 5 × 3 + 3 (mod 20) = 18
Y3 = 5 × 18 + 3 (mod 20) = 93 (mod 20) = 13
Y4 = 5 × 13 + 3 (mod 20) = 8
Y5 = 5 × 8 + 3 (mod 20) = 3
which gives the sequence 0, 3, 18, 13, 8, 3, 18, 13, 8, 3, . . . , where the pattern
3, 18, 13, 8 is repeated indeﬁnitely. This is an improvement since there is no im-
mediate clear structure for short pieces of the sequence. On the other hand, when a
period is completed, most numbers between 0 and 19 have not shown up at all, so we
do not get the uniform distribution. A problem here is that the period is too short.
These calculations illustrate some potential problems with random number gener-
ation. We will not address this further but mention that nice results can be obtained
from number theory that give criteria for how to choose m, a, and b to avoid these
problems and get a good random-looking sequence. For practical purposes, m must,
of course, be much larger than in the two examples above.
Assuming thus that we can generate observations from the standard uniform
distribution, how can we transform these to observations from other distributions?
In the following sections, we will investigate this.
5.3
SIMULATION OF DISCRETE DISTRIBUTIONS
Let us start with the simplest of discrete random variables, indicators. Recall that
an indicator function IA assumes the value 1 if the event A occurs and 0 otherwise.
Suppose that the probability of A is p so that IA assumes the values 0 or 1 with

284
SIMULATION
probabilities 1 −p or p, respectively. How can we generate an observation on IA if
we are given U ∼unif[0, 1]? The idea is simple. Let
IA =

1 if U ≤p
0 if U > p
which gives the correct distribution because
P(IA = 1) = P(U ≤p) = p
which also gives P(IA = 0) = 1 −p. Note that it does not matter what the event A
is since we are not simulating the underlying experiment directly. We are interested
only in getting the right distribution for IA.
Any discrete distribution can be simulated by a similar idea. If X assumes the
values x1, x2, . . . with probabilities p1, p2, . . . , we divide the interval [0, 1] into
subintervals where the kth subinterval has length pk, and if U falls there, we set
X = xk. It does not matter whether the range of X is ﬁnite or countably inﬁnite. To
express X explicitly as a function of U, we state the following proposition.
Proposition 5.1. Consider the pmf p on the range {x1, x2, . . .} and let
F0 = 0, Fk =
k

j=1
p(xj),
k = 1, 2, . . .
Let U ∼unif[0, 1] and let X = xk if Fk−1 < U ≤Fk. Then X has pmf p.
Proof. Note that X = xk if and only if U ∈(Fk−1, Fk], which has probability
P(X = xk) = P (Fk−1 < U ≤Fk) = Fk −Fk−1 = p(xk),
k = 1, 2, . . .
as desired. If the range is ﬁnite, {x1, . . . , xn}, we get Fn = 1.
■
The number Fk is in fact FX(xk), the distribution function of X in the point xk (and
we can let x0 = −∞). In the next section, we will see how this is a special case of a
more general method.
For certain special discrete distributions, there are alternative and more attractive
ways to simulate. We will look at one example and leave others for the Problems
section.
Example 5.1. Let X ∼bin(n, p). We can use Proposition 5.1 to generate an observa-
tion on X, but we can also use the fact that the binomial distribution can be represented
as a sum of indicators
X =
n

k=1
Ik

SIMULATION OF CONTINUOUS DISTRIBUTIONS
285
where the Ik are i.i.d. with P(Ik = 1) = p. Thus, we simulate standard uniforms
U1, . . . , Un, and for each of these let Ik = 1 if Uk ≤p and add Ik. One advantage of
this method compared to using Proposition 5.1 is that if we need to change n from
100 to 200, for example, we simply simulate 100 more indicators, which is easier
than having to start over and recalculate all the Fk.
□
5.4
SIMULATION OF CONTINUOUS DISTRIBUTIONS
From previous results we know that if U ∼unif[0, 1] and we let X = (b −a)U +
a, then X ∼unif[a, b]. Hence, it is clear how to generate observations from any
uniform distribution, starting from a standard uniform distribution: simply multiply
each observation by b −a and add a. As it turns out, this is a special case of a more
general result that we state next.
Proposition 5.2 (The Inverse Transformation Method).
Let F be a distribution
function that is continuous and strictly increasing. Further, let U ∼unif[0, 1] and
deﬁne the random variable Y = F−1(U). Then Y has distribution function F.
Proof. Start with FY, the distribution function of Y. Take x in the range of Y to obtain
FY(x) = P(F−1(U) ≤x)
= P(U ≤F(x)) = FU(F(x)) = F(x)
where the last equality follows since FU(u) = u if 0 ≤u ≤1. The argument here is
u = F(x), which is between 0 and 1 since F is a cdf.
■
To generate observations from a distribution with cdf F, we thus ﬁnd F−1, generate
i.i.d. uniform [0,1] variables U1, . . . , Un, and let Xk = F−1(Uk) for k = 1, . . . , n.
Note that the assumptions on F, continuous and strictly increasing, together guarantee
that F−1 exists as a function on the entire interval [0, 1].
Example 5.2. Generate an observation from an exponential distribution with param-
eter λ.
Here,
F(x) = 1 −e−λx, x ≥0
To ﬁnd the inverse, as usual solve F(x) = u, to obtain
x = F−1(u) = −1
λ log(1 −u), 0 ≤u < 1

286
SIMULATION
Hence, if U ∼unif[0, 1], the random variable
X = −1
λ log(1 −U)
is exp(λ). We can note here that since 1 −U is also uniform on [0, 1] (see Problem
19 in Chapter 2), we might as well take X = −log U/λ.
□
Example 5.3. Generate an observation (X, Y) from a uniform distribution on the
triangle with corners in (0, 0), (0, 1), and (1, 0) (see Problem 92 in Chapter 3).
Our approach will be to ﬁrst generate X, and then, given the value X = x, we will
generate Y from the conditional distribution. Since the triangle has area 1
2, the joint
pdf is
f(x, y) = 2,
0 ≤x ≤1, 0 ≤y ≤1 −x
which gives the marginal pdf
fX(x) = 2
 1−x
0
dy = 2(1 −x),
0 ≤x ≤1
which in turn gives the cdf
FX(x) =
 x
0
2(1 −t)dt = 2x −x2, 0 ≤x ≤1
Next we ﬁnd the inverse, F−1. Solve
u = 2x −x2
to obtain
x = F−1(u) = 1 −
√
1 −u, 0 ≤u ≤1
Note that solving the quadratic gives two solutions but only the one with “−” is correct
(why?). We also need the conditional distribution for Y given X = x, which is
fY(y|x) = f(x, y)
fX(x) =
1
1 −x, 0 ≤y ≤1 −x
that is, Y|X = x ∼unif[0, 1 −x]. Now let U and V be independent and uniform on
[0, 1], and let
X = 1 −
√
1 −U
Y = V(1 −X)
to get a pair (X, Y) with the desired distribution. Figure 5.1 shows the outcome of
100 generated such pairs (X, Y). Note that we cannot use the same random number
U for both X and Y. This would give the correct marginal distributions of X and Y

SIMULATION OF CONTINUOUS DISTRIBUTIONS
287
0
0.5
1
0.5 
1 
FIGURE 5.1
One hundred simulated observations, uniform on a triangle.
but not the correct joint distribution since Y would become a deterministic function
of X. Also note that since X and Y are dependent, we need to pair each X value with
its corresponding Y value.
□
The assumptions on F are that it is continuous and strictly increasing. If there are
parts where F is constant, these parts correspond to values that X cannot assume,
so this is not a problem. If there are points where F jumps, these are points that X
can assume with strictly positive probability. In particular, if X is a discrete random
variable, F consists entirely of jumps and constant parts, but also remember that there
are random variables that are mixtures of discrete and continuous parts. For a general
cdf F, we can introduce the generalized inverse, or quantile function, F←, deﬁned
by
F←(u) = inf{x : F(x) ≥u}
This has the property that
F←(u) ≤x ⇔u ≤F(x)
and in the case of strictly increasing F, we have F−1 = F←. It can be shown that if
U ∼unif[0, 1] and we let X = F←(U), then X has cdf F. In principle, this solves
the problem of simulating any distribution, discrete or continuous. For example, the
random variable X in Proposition 5.1 is merely F←(U) in disguise.
If we do not know the functional form of the cdf F, we cannot use the inverse
transformation method. This is, for example, the case for the normal distribution and
since we have pointed out the importance of this distribution, we would certainly like
to have a way for generating observations from it. We next describe a clever method

288
SIMULATION
to generate observations from a continuous distribution that requires that we know
the pdf but not the cdf.
We want to generate observations on a continuous random variable X that has pdf
f. Suppose that there is another random variable Y with pdf g, from which we know
how to generate observations and that there is a constant c > 1 such that
f(x) ≤cg(x) for all x
We can then use consecutive generated observations on Y to create observations on
X according to a certain algorithm, which we state as a proposition.
Proposition 5.3 (The Rejection Method).
1. Generate Y and U ∼unif[0, 1] independent of each other.
2. If U ≤f(Y)
cg(Y), set X = Y. Otherwise return to step 1.
The random variable X generated by this algorithm has pdf f.
When the criterion is satisﬁed in step 2 and we set X = Y, we say that we accept Y
and otherwise reject it. Hence the name of the method.
Proof. Let us ﬁrst make sure that the algorithm terminates. The probability in any
given step 2 to accept Y is, by Corollary 3.2,
P

U ≤f(Y)
cg(Y)

=

R
P

U ≤f(y)
cg(y)

g(y)dy
=

R
f(y)
cg(y)g(y)dy = 1
c

R
f(y)dy = 1
c
where we used the independence of U and Y and the fact that U ∼unif[0, 1]. Hence,
the number of iterations until we accept a value has a geometric distribution with
success probability 1/c. The algorithm therefore always terminates in a number of
steps with mean c from which it also follows that we should choose c as small as
possible.
Next we turn to the question of why this gives the correct distribution. To show
this, we will show that the conditional distribution of Y, given acceptance, is the same
as the distribution of X. Recalling the deﬁnition of conditional probability and the
fact that the probability of acceptance is 1/c, we get
P

Y ≤x
 U ≤f(Y)
cg(Y)

= c P

Y ≤x, U ≤f(Y)
cg(Y)


SIMULATION OF CONTINUOUS DISTRIBUTIONS
289
By independence, the joint pdf of (U, Y) is f(u, y) = g(y), and the above expression
becomes
c P

Y ≤x, U ≤f(Y)
cg(Y)

= c
 x
−∞
 f(y)/cg(y)
0
g(y)du dy
= c
 x
−∞
f(y)
cg(y)g(y)dy = P(X ≤x)
which is what we wanted to prove.
■
Let us now see how this applies to the normal distribution.
Example 5.4. Let X ∼N(0, 1) so that X has pdf
ϕ(x) =
1
√
2π
e−x2/2, x ∈R
We will use the pdf of an exponential distribution as the function g. However, the
normal distribution can take on values on the entire real line and the exponential, only
positive values, so we have to make some adjustments. Since the standard normal
distribution is symmetric around 0, we can get the right distribution of X by ﬁrst
generating a value of |X| and then choosing “+” or “−” with equal probabilities.
According to Problem 85 in Chapter 2, the pdf of |X| is
f(x) = 2ϕ(x) =
2
√
2π
e−x2/2, x ≥0
Now let Y ∼exp(1). By Example 5.2, we know how to generate observations on Y
that has pdf
g(x) = e−x, x ≥0
and we will proceed to ﬁnd the constant c. Note that
f(x)
g(x) =

2
π exp
−(x2 −2x)
2

=

2e
π exp
−(x −1)2
2

after completing the square (note that we use “exp” in two different meanings: the
exponential distribution and the exponential function; do not confuse these). Since
the second factor is at most 1, we can take c = √2e/π to obtain f(x) ≤cg(x). To
apply the method, we follow the two steps:
1. Generate U ∼unif[0, 1] and Y ∼exp(1) independent of each other.
2. If U ≤exp(−(Y −1)2/2), set |X| = Y. Otherwise repeat step 1.
Finally, to choose the sign of X, generate V ∼unif[0, 1]. If V ≤1
2, set X = |X|,
otherwise set X = −|X|.

290
SIMULATION
The mean number of steps until acceptance is c ≈1.32, so the algorithm terminates
quickly. There are ways to improve the efﬁciency of the method, but we will not
address them here.
□
We conclude this section with another way to simulate the standard normal distribu-
tion.
Example 5.5 (Box–Muller Method). Recall from Example 3.26 that if X and Y are
independent and have standard normal distributions, then their polar coordinates R
and  are independent with R2 ∼exp( 1
2) and  ∼unif[0, 2π]. Since we know how
to generate the uniform and exponential distributions, we should be able to use this
to generate observations on X and Y.
Suppose that we have U and V independent uniform on [0, 1]. The inverse trans-
formation method gives that −2 log U ∼exp( 1
2), and hence observations on R and 
are generated by
R =
	
−2 log U
 = 2πV
and since X = R cos  and Y = R sin , we get
X =
	
−2 log U cos(2πV)
Y =
	
−2 log U sin(2πV)
which are independent, and each has the standard normal distribution. Hence, with
this method we get two observations at a time, so (X, Y) is bivariate normal with
correlation ρ = 0. In Problem 17, we investigate how to generate observations on the
bivariate normal distribution in general.
Note the somewhat surprising fact that X and Y are independent even though they
are both functions of the same random variables U and V (but recall Problem 95(c)
in Chapter 3).
□
5.5
MISCELLANEOUS
A nice use of simulation is that it can help us suggest what an analytical formula
should look like, which we can then set out to formally prove. We look at an example
of this.
Example 5.6. Recall the gambler’s ruin problem, where two players, Ann and Bob,
take turns ﬂipping a fair coin and the winner in each round gets a dollar from the other
player. Suppose that the players start with a and b dollars, respectively. How long can
we expect the game to last?

MISCELLANEOUS
291
TABLE 5.1
Average Simulated Duration Times ¯T Until
Ruin and Their Standard Deviations s ¯T for Different
Values of a and b
a
b
¯T
s ¯T
ab
2
3
6.5
0.7
6
3
4
11.0
1.1
12
3
5
15.4
1.5
15
4
6
22.2
2.0
24
Let T be the duration of the game. If we denote Ann’s fortune after the nth round by
Sn, we thus have
T = min{n : Sn = −a or Sn = b}
and we want to ﬁnd E[T]. To use the deﬁnition, we need the distribution of T, and
this is quite tricky to ﬁnd. (Just try!) However, we can investigate the problem with a
computer simulation for different values of a and b and see if we can guess a formula
for E[T]. Table 5.1 shows average values of T obtained from simulations for different
values of a and b. It seems that E[T] = ab is a good guess. Of course, this is not a
proof, but now that we have an expression, we can try to prove it.
Let us follow the idea from Example 1.58 and condition on the ﬁrst ﬂip or in
the random-walk interpretation, the ﬁrst step S1. Let μa,b be the expected number
of rounds until the game is over when the initial fortunes are a and b. After the ﬁrst
round, we are at either −1 or 1 with equal probabilities, so the law of total expectation
gives
μ = E[T|S1 = −1]P(S1 = −1) + E[T|S1 = 1]P(S1 = 1)
= (1 + μa−1,b+1)1
2 + (1 + μa+1,b−1)1
2
= 1 + 1
2(μa−1,b+1 + μa+1,b−1)
and since
1 + 1
2

(a −1)(b + 1) + (a + 1)(b −1)

= ab
our suggested expression satisﬁes the equation. Thus, the expected duration of the
game is the same in the case a = 1, b = 100 as in the case a = 10, b = 10. Since
the game can be over already after one round in the ﬁrst case (and will be so half of
the time) but there must be at least 10 rounds (and most likely many more) in the
second, we realize that although the means are the same, the distributions in the two
cases must be different.
□
Finally, an example that shows how simulation can help us guess better than random.

292
SIMULATION
Example 5.7. In an urn there are two slips of paper, each with a real number written
on it. You do not know how the numbers have been chosen, only that they are
different. You pick a slip at random, look at the number, and are asked to guess
whether it is the larger or smaller of the two. Can you do this and be correct with a
probability strictly greater than 1
2?
Surprisingly, you can! Call the two numbers a and b and suppose that a < b. Call the
number you picked X so that X equals a or b with probability 1
2 each. Now generate
an observation Y from a continuous distribution with range R, for example, a normal
distribution, independent of X. Your rule to decide is to pretend that the number on
the other slip in the urn is Y. Hence, if X < Y, you guess that you have the smaller
number; if X > Y, you guess that you have the larger. It is easy to realize that you
will guess correctly if either X = a and Y > a, or if X = b and Y < b. (Since Y is
continuous, we rule out the possibility that Y is exactly equal to a or b. In the actual
simulation, we are limited by ﬁnite precision, but with sufﬁciently many decimals in
our observation on Y, it is very unlikely that Y equals a or b.) Let F be the cdf of Y.
Since X and Y are independent, the probability to guess correctly is
p = P(X = a, Y > a) + P(X = b, Y < b)
= P(X = a)P(Y > a) + P(X = b)P(Y < b)
= 1
2(1 −F(a) + F(b)) > 1
2
since F(b) > F(a). The value of p of course depends on a, b, and F, but in any
case, the probability of guessing correctly is always strictly greater than 1
2. Since the
simulation of Y has nothing to do with the problem of choosing and guessing, this is
really mysterious, isn’t it?
□
PROBLEMS
Section 5.3. Simulation of Discrete Distributions
1. A family with three children is chosen at random and the number X of daughters
is counted. Show how to simulate an observation on X based on U ∼unif[0, 1].
2. A girl who has two siblings is chosen at random and the number X of her sisters
is counted. Show how to simulate an observation on X based on U ∼unif[0, 1].
3. Let Y ∼Poi(λ) and suppose that you can simulate X1, X2, . . . that are inde-
pendent exp(1). Suggest how the Xk can be used to simulate observations on
Y.
4. SupposethatyouknowhowtogeneratetheuniformandthePoissondistribution.
Describe how you can use this to simulate a Poisson process on a given interval
[0, t]. Hint: The order statistic property.

PROBLEMS
293
5. Let X have a negative binomial distribution with parameters r and p. Describe
how to simulate observations on X. Hint: Problem 52, Chapter 3.
Section 5.4. Simulation of Continuous Distributions
6. Let U ∼unif[0, 1] and let X = (b −a)U + a. From previous discussions, we
know that X ∼unif[a, b], which can be used to simulate values of X. Show that
this is a special case of the inverse transformation method.
7. The random variable X has pdf f(x) = 3x2,
0 ≤x ≤1. Describe how to
generate an observation on X based on U ∼unif[0, 1].
8. Let X have a Cauchy distribution (see Section 2.8.3). (a) Describe how to
generate an observation on X based on U ∼unif[0, 1]. (b) Use the result from
(a) to create repeated samples of some large size, for example, n = 100, 000,
and each time compute the sample mean. What do you observe and why?
9. Let X have a Weibull distribution (see Section 2.10). Describe how to generate
an observation on X based on U ∼unif[0, 1].
10. Let X have a geometric distribution with success probability p. Demonstrate
how you can simulate an observation on X based on U ∼unif[0, 1] using
Problem 74 in Chapter 2.
11. The mixed random variable X in Example 2.44 has cdf F(x) = 1 −0.8e−x, x ≥
0. Describe how to generate an observation on X based on U ∼unif[0, 1].
12. Suppose that you have a random number generator, a fair coin, and Table A.1.
Describe how you can use these to generate observations on the standard normal
distribution.
13. Let X ∼exp(1). Use simulation to determine an approximate value of E[log X].
14. LetX ∼N(0, 1).UsesimulationtodetermineanapproximatevalueofE[sin X].
15. Let X, Y, and Z be independent and uniform [0, 1]. Use simulation to ﬁnd an
approximate value of P(X + Y + Z ≤2.5).
16. Let g: [0, 1] →R be a function whose integral I =
 1
0 g(x)dx is impossible
to compute explicitly. How can you approximate I by simulation of standard
uniforms U1, U2, . . .?
17. The Box–Muller method gives you a pair (X, Y) of independent standard nor-
mals. Describe how you can use these to generate observations on a bivariate
normal distribution with parameters μ1, μ2, σ2
1, σ2
2, and ρ.
18. Describe how to generate observations on a pair (X, Y) that is uniform on the
unit disk {(x, y) : x2 + y2 ≤1}. Hint: Use polar coordinates.
19. Let X have pdf f(x) = 4x2e−x2/√π,
x ≥0. Apply the rejection method to
generate observations on X.

6
STATISTICAL INFERENCE
6.1
INTRODUCTION
In the previous chapters, we developed a theory of probability that allows us to model
and analyze random phenomena in terms of random variables and their distributions.
While developing this theory, we often referred to real-world observations and data
sets, for example, in the assumption that the tropical cyclones in Example 2.36 follow
a Poisson distribution with mean 15. Although we might be able to argue that the
distribution should be Poisson from purely physical and meteorological principles
point of view, where did the number 15 come from? It is simply the average number
of cyclones per year that has been observed during the years 1988–2003, so we used
this measured value as our parameter. This is a typical situation in any application of
probability theory. We formulate a model by making assumptions about distributions
and their parameters, but in order to be able to draw any useful conclusion, we need
data. In this chapter, we outline the ﬁeld of statistical inference, or statistics for short,
which ties together probability models and data collection.
6.2
POINT ESTIMATORS
Suppose that we manufacture lightbulbs and want to state the average lifetime on the
box. Let us say that we have the following ﬁve observed lifetimes (in hours):
983, 1063, 1241, 1040, 1103
Probability, Statistics, and Stochastic Processes, Second Edition. Peter Olofsson and Mikael Andersson.
© 2012 John Wiley & Sons, Inc. Published 2012 by John Wiley & Sons, Inc.
294

POINT ESTIMATORS
295
which give us the average 1086. If this is all the information we have, it seems
reasonable to state 1086 as the average lifetime (although “at least 1000 h” might
sound better from a commercial point of view). Let us now describe this in terms of
random variables.
Let the random variable X be the lifetime of a lightbulb and let μ = E[X]. Here μ
is an unknown parameter. We decide to repeat the experiment to measure a lifetime
ﬁve times and will then get an outcome on the ﬁve random variables X1, . . . , X5 that
are i.i.d. We now estimate μ by
¯X = 1
5
5

k=1
Xk
which we recall from Section 4.1 as the sample mean. We can think of this as the way
we would describe it before actually performing the experiment. The Xk are random
and so is ¯X. After the experiment, we get observed values, and with the values given
above we get the outcome ¯X = 1086. We now generalize the idea of this example,
for which we need the following deﬁnition.
Deﬁnition 6.1. If the random variables X1, . . . , Xn are i.i.d., we refer to them
collectively as a (random) sample.
Note that it is the entire collection X1, . . . , Xn that is called “a sample,” which may
be a bit different from the way the word “sample” is used in everyday language. In
practice, it is not necessarily the case that observations are independent or have the
same distribution, and we will later use the term “sample” in such more general cases
as well. For now, however, we will stick to the i.i.d. observations.
Suppose now that we want to use a random sample to gain information about an
unknown parameter θ. The following deﬁnition is central.
Deﬁnition 6.2. A random variable θ, which is a function of a random sample and is
used to estimate an unknown parameter θ, is called an estimator of θ. The observed
value of θ is called an estimate of θ.
Thus, if we have a sample X1, . . . , Xn, an estimator is a random variable of the type
g(X1, . . . , Xn) for some function g : Rn →R. It is important to understand that a
parameter θ is a ﬁxed but unknown number and an estimator θ is a random variable
to be computed from a sample. We will stick to the distinction between estimator and
estimate, although these terms are sometimes used interchangeably in the statistics
literature.

296
STATISTICAL INFERENCE
In the lightbulb example, we have the parameter μ and the function
g(X1, . . . , Xn) = (X1 + · · · + Xn)/n, which gives the estimator μ = ¯X and the esti-
mate 1086. If we repeat the experiment with ﬁve new lightbulbs, the estimator is the
same but the estimate will change.
It is natural to estimate the mean μ by the sample mean ¯X, but how do we know
that there are no other estimators that are better? What does “better estimator” mean,
anyway? The intuitive general criterion for a good estimator θ is simply that it is “as
close to θ as possible.” How can we formalize this intuition?
Since an estimator θ is a random variable, it has an expected value E[θ ]. Since
this is a number and we use the estimator to estimate the unknown number θ, it seems
reasonable to require that the two are equal.
Deﬁnition 6.3. The estimator θ is said to be unbiased if
E[θ ] = θ
If E[θ ] /= θ,θ is said to be biased. Thus, an unbiased estimator “aims at the true value
of θ” or is “correct on average.” For an illustration of the idea, consider Figure 6.1,
where histograms are given for unbiased and biased estimators, respectively. Each
histogram is computed from 1000 values of θ, and each such value is computed from
a new sample of a ﬁxed size n.
From Section 4.1, we know that E[ ¯X] = μ, and ¯X is thus an unbiased estimator
of μ. It is not the only unbiased estimator of the mean μ, though. We could also use
X1, the ﬁrst observation, and disregard all the others. Since E[X1] = μ, this is also
an unbiased estimator, and in the lightbulb example we get the estimate X1 = 983.
Intuitively ¯X ought to be a better estimator than X1 since it uses all the informa-
tion in the sample. To extend this argument, if we would increase the number of
θ
θ
FIGURE 6.1
A parameter θ and histograms of repeated observations on its estimator θ. On
the left, the estimator is unbiased and on the right, it is biased with E[θ ] < θ.

POINT ESTIMATORS
297
observations in the sample we would increase the amount of available information
and, consequently, should obtain an even better estimator. This brings us to another
important property of estimators.
Deﬁnition 6.4. The estimator θn based on the sample X1, . . . , Xn is said to be
consistent if
θn
P→θ
as n →∞.
This property can often be difﬁcult to verify for a given estimator, so the following
result is very useful.
Proposition 6.1. Let θn be an unbiased estimator based on the sample X1, . . . ,
Xn. If
Var[θn ] →0
as n →∞, then θn is consistent.
Proof. Apply Chebyshev’s inequality to θn and let c = ϵ/

Var[θn ]. This yields
P(|θn −θ| > ϵ) ≤Var[θn ]
ϵ2
Now, if Var[θn ] →0 as n →∞, we see that
P(|θn −θ| > ϵ) →0
as n →∞for all ϵ > 0, which completes the proof.
■
Hence, unbiasedness and consistency are two desirable properties that we should look
for when considering estimators. This invites the following question: If we have two
unbiased and consistent estimators θ and θ, which should we choose? Intuitively, we
should choose the one that tends to be closer to θ, and since E[θ ] = E[θ ] = θ, it
makes sense to choose the estimator with the smaller variance.

298
STATISTICAL INFERENCE
Deﬁnition 6.5. Suppose that θ and θ are two unbiased estimators of θ. If
Var[θ ] < Var[θ ]
then θ is said to be more efﬁcient than θ.
Let us again return to the lightbulb example and the two estimators ¯X and X1. If σ2
is the variance of an individual lifetime, we thus have
Var[ ¯X] = σ2
5
and
Var[X1] = σ2
so ¯X is more efﬁcient than X1. Since the sample mean is a natural estimator of the
mean, regardless of distribution, let us restate its properties from Section 4.1.
Proposition 6.2. Let X1, . . . , Xn be a sample with mean μ and variance σ2. Then
the sample mean ¯X has mean and variance
E[ ¯X] = μ
and
Var[ ¯X] = σ2
n
There are numerous other ways to construct unbiased estimators, and it can be shown
that the sample mean is the most efﬁcient among a large class of unbiased estimators
(see Problem 1).
When two estimators, θ and θ, are given, one is not necessarily more efﬁcient
than the other. The reason for this is that the variances of the estimators typically
depend on unknown parameters (most notably θ itself), and it may well happen that
Var[θ ] < Var[θ ] for some parameter values and Var[θ ] > Var[θ ] for others.
Example 6.1. Let X1, . . . , Xn be a random sample from a uniform distribution
on [0, θ] where θ is unknown. Since the mean is θ/2, one reasonable estimator is
θ = 2 ¯X. Also, since the maximum value X(n) ought to be close to θ but is always
smaller, another reasonable estimator is θ = cnX(n), where cn > 1. Determine cn so
that θ becomes unbiased and compare the two estimators.
We need to ﬁnd cn such that
E[θ ] = cnE[X(n)] = θ
To compute E[X(n)], we recall Corollary 3.11, which states that the pdf of X(n) is
f(n)(x) = nf(x)F(x)n−1

POINT ESTIMATORS
299
where in our case f(x) = 1/θ and F(x) = x/θ, and we get
f(n)(x) = nxn−1
θn
,
0 ≤x ≤θ
This now gives
E[X(n)] =
 θ
0
xf(n)(x)dx = n
θn
 θ
0
xndx =
n
n + 1θ
which gives cn = (n + 1)/n and the estimator
θ = n + 1
n
X(n)
Let us compare the two estimators. We already know that θ is unbiased and since
E[θ ] = 2E[ ¯X] = 2θ
2 = θ
θ is also unbiased. Let us next compare the variances of the two estimators. For θ we
have
Var[θ ] = 4Var[ ¯X] = 4 θ2
12n = θ2
3n
where we got the variance for the uniform distribution from Proposition 2.13. For θ
we have
Var[θ ] = E[θ2 ] −(E[θ ])2 =
n + 1
n
2
E[X2
(n)] −θ2
so we need to ﬁnd E[X2
(n)]. The pdf of X(n) is given above, and we get
E[X2
(n)] = n
θn
 θ
0
xn+1dx =
n
n + 2θ2
which ﬁnally gives
Var[θ ] =
n + 1
n
2
n
n + 2θ2 −θ2 =
θ2
n(n + 2)
Since
Var[θ ] < Var[θ ]
for n ≥2, θ is the more efﬁcient estimator. Note that the difference in variance is
quite substantial since θ has n2 in the denominator whereas θ has only n.
□
When given two (or more) alternative estimators, Deﬁnition 6.5 thus gives a criterion
to use for selecting the most efﬁcient one. However, it does not say anything about

300
STATISTICAL INFERENCE
optimality, that is, is it good enough or should we keep looking for something even
better? To answer that question, we need the following result.
Proposition 6.3. (Cram´er–Rao Lower Bound1) Let θ be an unbiased estimator
of the parameter θ based on the sample X1, . . . , Xn. Then
Var[θ ] ≥
1
nI(θ)
where
I(θ) = −E
	 ∂2
∂θ2 log fθ(X)

is the Fisher information.2
The proof of Proposition 6.3 is rather involved and falls beyond the scope of this
book.
This result gives us the smallest possible variance of an unbiased estimator for a
given sample distribution, so if we manage to attain this, or come sufﬁciently close,
we can be conﬁdent that we have a good estimator. We can also use it to obtain an
absolute measure of efﬁciency.
Deﬁnition 6.6. The efﬁciency of an unbiased estimator θ is
e(θ) =
1
nI(θ)Var[θ ]
We can interpret the efﬁciency as the ratio of the variance of the best possible unbiased
estimator (if it exists) and the variance of the given θ, and from Proposition 6.3 we
get that e(θ) ≤1.
Example 6.2. Let us assume that we have a sample X1, . . . , Xn, which is normally
distributed with mean μ and variance σ2. Proposition 6.2 says that the point estimator
μ = ¯X is an unbiased estimator of μ. Let us now see how efﬁcient this estimator is.
1Named after the Swedish mathematician Harald Cram´er (1893–1985) and the Indian statistician C. R.
Rao (1920-).
2Named after the English statistician Sir Ronald A. Fisher (1890–1962) who, among other things, intro-
duced the method of maximum likelihood (see Section 6.4.2).

POINT ESTIMATORS
301
The Fisher information of the normal distribution with respect to μ is
I(μ) = −E
	 ∂2
∂μ2 log

1
σ
√
2π
e−(X−μ)2/2σ2
= −E
	 ∂2
∂μ2

−log(σ
√
2π) −(X −μ)2
2σ2

= −E
	
−1
σ2

= 1
σ2
The Cram´er–Rao Lower Bound hence becomes 1/nI(μ) = σ2/n, which, by Pro-
position 6.2, is equal to the variance of ¯X. This shows that there does not exist any
other unbiased estimator of μ with a higher efﬁciency than the sample mean.
□
Efﬁciency is thus a criterion that we can use to choose from among estimators. To get
a better idea of what the actual numbers mean, rather than using the variance, we use
the standard deviation that has the correct unit of measure. For an estimator, there is
a special piece of terminology.
Deﬁnition 6.7. The standard deviation of an estimator, σθ =

Var[θ ], is called
the standard error.
In practice, the standard error typically depends on unknown parameters, and by
estimating these, we get the estimated standard error, denoted by sθ. This is also
sometimes referred to as the standard error if there is no risk of confusion. Let us
revisit our examples.
Example 6.3. In Example 6.1, suppose that we have the following 10 observations,
ordered by size:
0.94, 1.56, 2.52, 3.54, 3.91, 4.16, 4.49, 6.50, 7.42, 8.69
which gives the estimates
θ = 2 ¯X = 8.8
and
θ = n + 1
n
X(n) = 11
10 × 8.69 = 9.6
The standard errors are
σθ =
θ
√
3n
and
σθ =
θ
√n(n + 2)

302
STATISTICAL INFERENCE
which, as we can see, depend on both θ and n. For the estimated standard errors, we
insert n = 10 and the values of θ and θ to obtain
sθ =
θ
√
3n
= 8.8
√
30
= 2.6
and
sθ =
θ
√n(n + 2) =
9.6
√
120
= 0.77
□
Example 6.4. In the lightbulb example, the estimators are ¯X and X1 and the standard
errors are
σ ¯X = σ
√
5
and
σX1 = σ
which depend on the unknown parameter σ. Thus, in order to estimate the standard
errors, we need to know how to estimate σ from the sample. We address this in the
next section.
□
6.2.1
Estimating the Variance
We have learned that the sample mean is a good estimator of the mean. Now suppose
that we also wish to estimate the variance σ2. Recall the deﬁnition
σ2 = E

(X −μ)2
where μ is the mean. Thus, the variance is the mean of the random variable (X −μ)2
and a good estimator is the sample mean of the random variables
(X1 −μ)2, . . . , (Xn −μ)2
that is, we could use
σ2 = 1
n
n

k=1
(Xk −μ)2
as our estimator of σ2. One obvious problem is that this requires that we know the
mean μ, and this is rarely the situation. However, we can replace μ by its estimator
¯X and hopefully still get a good estimator of σ2. It turns out that this results is an
estimator that is slightly biased, and instead the following is most often used.
Deﬁnition 6.8. Let X1, . . . , Xn be a random sample. The sample variance is deﬁned
as
s2 =
1
n −1
n

k=1
(Xk −¯X)2

POINT ESTIMATORS
303
For computations, it is easier to use the following formula, easily proved by expanding
the square and doing some simple algebra.
Corollary 6.1.
s2 =
1
n −1
 n

k=1
X2
k −n ¯X2

It may seem strange to divide by n −1 when there are n terms in the sum. The reason
for this is that it gives an unbiased estimator.
Proposition 6.4. The sample variance s2 is an unbiased and, if E[X4
i ] is ﬁnite,
consistent estimator of σ2.
Proof. By Corollary 6.1, we obtain
E[s2] =
1
n −1
 n

k=1
E[X2
k] −nE[ ¯X2]

=
1
n −1

n(σ2 + μ2) −n
σ2
n + μ2

= σ2
where we used the variance formula from Corollary 2.2. The proof of consistency is
left as an exercise.
■
Dividing by n would thus give an estimator that is on average too small. The intuitive
reason for this is that the Xk tend to be closer to ¯X than they are to μ itself. The
square root of s2 is denoted by s and called the sample standard deviation. While s2
is an unbiased estimator of σ2, s is not an unbiased estimator of σ but is nevertheless
commonly used (see Problem 11).
Example 6.5. Find the sample standard deviation s in the lightbulb example and use
it to estimate the standard errors of the estimators X1 and ¯X.
Our observed sample is 983, 1040, 1063, 1103, 1241, which has an observed sample
mean ¯X = 1086 and
5

k=1
X2
k = 5, 934, 548

304
STATISTICAL INFERENCE
which gives
s2 = 1
4(5, 934, 548 −5 × 10862) = 9392
which ﬁnally gives s = 96.9. This is also the estimated standard error of X1. The
estimated standard error of ¯X is
s ¯X = 96.9
√
5
= 43.3
which is less than half that of X1. Note how the estimation of σ achieves two things:
(1) we get an estimate of the variation in individual lifetimes and (2) we get an estimate
of the standard error of ¯X.
□
By comparing standard errors, we can compare estimators. It is still not clear, however,
what the actual value of the standard error means. It somehow measures the accuracy
of our estimator and we would like to use it to get error bounds. In the lightbulb
example, we have the estimate ¯X = 1086, which has an estimated standard error 43.
Perhaps, we could summarize this as 1086 ± 43, but exactly what does this mean?
The mean μ is unknown, so either it is in the interval [1043, 1129] or it is not. Note,
however, that the interval is an outcome of the random interval [ ¯X −s ¯X, ¯X + s ¯X],
so what we can do is to ﬁnd the probability that this random interval contains μ. We
could then further supplement our error bounds with a probability that tells how much
we believe in the bounds. Instead of taking ±sX, we could take ±2s ¯X, ±3s ¯X, or ±c s ¯X
for some other constant c. The probability of catching μ changes with c, and in the
next section we introduce a systematic way to determine error bounds.
6.3
CONFIDENCE INTERVALS
As discussed in the previous section, it is desirable to be able to supplement an
estimator with error bounds, to get an idea of its accuracy. The following deﬁnition
gives the formal description.
Deﬁnition 6.9. Let X1, . . . , Xn be a random sample and θ an unknown parameter.
If T1 and T2 are two functions of the sample such that
P(T1 ≤θ ≤T2) = q
we call the interval [T1, T2] a conﬁdence interval for θ with conﬁdence level q. We
write this as follows:
T1 ≤θ ≤T2
(q)

CONFIDENCE INTERVALS
305
A conﬁdence interval is thus a random interval that contains the parameter θ with
probability q. Note that the probability statement in the deﬁnition seems to be a bit
“backward” from what we are used to since there is a constant θ in the middle and
random variables at the ends. Once we have numerical observations on our sample,
we get numerical values of T1 and T2 and refer to this as an observed conﬁdence
interval. We often refer to the conﬁdence level as a percentage, and instead of saying
“a conﬁdence interval with conﬁdence level 0.95,” we may say “a 95% conﬁdence
interval.” We can regard a conﬁdence interval as an estimator that is an entire interval
instead of a single point, and for this reason, the distinction between point estimation
and interval estimation is often made.
Example 6.6. Let us return to Example 6.1 where we used the estimator
θ = n + 1
n
X(n)
to estimate θ from a uniformly distributed sample on the interval [0, θ]. To ﬁnd a
conﬁdence interval of θ, we ﬁrst need to determine the distribution of the order statistic
X(n). Since X(n) is the maximum of the n independent random variables X1, . . . , Xn,
we can write the distribution function
FX(n)(x) = P(X(n) ≤x) = P(X1 ≤x, . . . , Xn ≤x)
= P(Xi ≤x)n =
x
θ
n
(6.1)
The next step is to ﬁnd values x1 and x2 such that
P(x1 ≤X(n) ≤x2) = q
This can be done in several ways (inﬁnitely many, actually), so let us also require the
interval to be symmetric, that is,
P(X(n) < x1) = P(X(n) > x2) = 1 −q
2
Equation (6.1) implies that
x1
θ
n
= 1 −q
2
whose solution is
x1 = θ
1 −q
2
1/n
Correspondingly, we get the upper limit as the solution to
1 −
x2
θ
n
= 1 −q
2

306
STATISTICAL INFERENCE
which is
x2 = θ
1 + q
2
1/n
A conﬁdence interval is now obtained from the inequality
θ
1 −q
2
1/n
≤X(n) ≤θ
1 + q
2
1/n
by dividing it by θ and X(n) and ﬁnally taking the reciprocal. The ﬁnal result can then
be expressed as
X(n)
1 + q
2
−1/n
≤θ ≤X(n)
1 −q
2
−1/n
(q)
(Note that the upper and lower limits switch when we take the reciprocal.)
Let us now apply this to the observed sample in Example 6.3 for q = 0.95. The
maximum observation was x(n) = 8.69 in a sample of size n = 10. The lower limit
will then become
8.69 × 0.975−1/10 = 8.71
and the upper limit
8.69 × 0.025−1/10 = 12.57
Hence, we can claim with 95% conﬁdence that the actual value of θ lies somewhere
between 8.7 and 12.6.
□
This example illustrates the most common way to calculate conﬁdence intervals,
namely, to ﬁrst determine the distribution of an efﬁcient estimator (or a related
statistic), use this to obtain an interval for the estimator, and ﬁnally transform this
into a conﬁdence interval. However, it is often the case that the interval is of the form
[θ −R,θ + R ]
where θ is an estimator of θ and R is an error bound determined such that
P(θ −R ≤θ ≤θ + R) = q
We then usually write the interval in the form
θ = θ ± R (q)
where the error bound R may be deterministic or random. A general observation is
that we want the conﬁdence interval to be as short as possible since this means that
our estimator has high accuracy. On the other hand, we also want the conﬁdence level
q to be as high as possible since this means that we have strong belief that we have
caught the true parameter θ in our interval. However, these two wishes are conﬂicting,

CONFIDENCE INTERVALS
307
and there is the trade-off that higher conﬁdence levels correspond to longer intervals.
It is more important to have high values of q since it would not be of much use to
have a very short interval if we did not have any conﬁdence in it. For that reason, the
value of q is typically determined in advance and the interval then computed. Some
standard values of q are 0.90, 0.95, and 0.99.
Finding a conﬁdence interval requires computation of a probability, and this, in
turn, means that we must know something about the distribution of our sample. To
be able to compute the probability P(θ −R ≤θ ≤θ + R), we need to know the
distribution of the estimator θ and of R if it is random. We next look at one important
special case, when the observations come from a normal distribution.
6.3.1
Conﬁdence Interval for the Mean in the Normal Distribution
with Known Variance
Suppose that X1, . . . , Xn is a sample from a normal distribution with unknown mean
μ and known variance σ2. As usual, we estimate μ with ¯X, but how can we ﬁnd a
conﬁdence interval of the form μ = ¯X ± R? This means that we need to ﬁnd R such
that
P( ¯X −R ≤μ ≤¯X + R) = q
By transformation we obtain the equivalent inequality
−
R
σ/√n ≤
¯X −μ
σ/√n ≤
R
σ/√n
where we know that the quantity in the middle is N(0, 1). With z = R√n/σ, we get
the following equation by symmetry:
q = P

−z ≤
¯X −μ
σ/√n ≤z

= (z) −(−z) = 2(z) −1
This implies the following proposition.
Proposition 6.5. If X1, . . . , Xn is a sample from a N(μ, σ2) distribution where σ2
is known, a 100q% conﬁdence interval for μ is
μ = ¯X ± z σ
√n
(q)
where z is such that (z) = (1 + q)/2.
Example 6.7. Consider the lightbulb example and ﬁnd a 95% conﬁdence interval for
μ under the assumption that σ = 100.

308
STATISTICAL INFERENCE
Since (1 + q)/2 = 0.975, we need to ﬁnd z such that (z) = 0.975. Table A.2,
speciﬁcally constructed for conﬁdence intervals, gives us z = 1.96, which yields the
conﬁdence interval
μ = 1086 ± 1.96 × 100
√
5
= 1086 ± 88 (0.95)
□
This result is mostly of theoretical interest since, in most practical situations, the
variance is usually not known beforehand. It is possible, however, to generalize this for
unknown variance, but it requires some additional mathematics and will be deferred
to the next chapter.
6.3.2
Conﬁdence Interval for an Unknown Probability
Suppose that we are interested in the probability p of some event A, repeat the experi-
ment n times, and observe A in X of these. Then X ∼bin(n, p), and a good estimator
is the relative frequency p = X/n (in Section 4.2 denoted fn). Thus, by Equation
(4.2), a consequence of the normal approximation to the binomial distribution is that
p
d≈N

p, p(1 −p)
n

which means that
P

−z ≤
p −p
√p(1 −p)/n ≤z

≈q
where (z) = (1 + q)/2. Although we could get an interval for p from the preceding
expression, we make yet another simplifying approximation and replace p by p in
the denominator, which gives
P

−z ≤
p −p

p (1 −p )/n
≤z

≈q
which in turn gives the following result.
Proposition 6.6. An approximate 100q% conﬁdence interval for p is given by
p = p ± z

p (1 −p )
n
(≈q)
where (z) = (1 + q)/2.

CONFIDENCE INTERVALS
309
Let us comment on the substitution of p for p. Since
p −p

p (1 −p )/n
=
p −p
√p(1 −p)/n

p(1 −p)
p (1 −p )
where the ﬁrst factor is approximately N(0, 1) and by Corollary 4.2 the second factor
is approximately 1, the product should also be approximately N(0, 1). We are not
explaining the exact asymptotic results that are needed here, but hope this gives some
intuition as to why the substitution is valid. We cannot substitute p for p just anywhere;
if we do it in the numerator, for instance, we get 0.
An application where the approximation works well is political opinion polls. Let
p be the unknown proportion of supporters of a particular candidate, draw a sample of
n individuals, and ask if they favor this candidate. If this number is X, we can estimate
p by p = X/n as usual. Now, the distribution of X is not exactly binomial since we
sample without replacement but by Proposition 4.3, on the binomial approximation
to the hypergeometric, we can assume that X is binomial for all practical purposes.3
The total population size N is typically on the order of many millions; the sample
size n, typically around 1000. The conﬁdence interval is, as above
p = p ± z

p (1 −p )
n
(≈q)
where the quantity ±z

p (1 −p )/n is referred to as the margin of error or the
sampling error.
Example 6.8. As an illustrative example, let us consider a historical opinion poll from
October 2000, on the upcoming presidential election. In this poll, 2207 likely voters
were asked whom they would vote for. The results were George Bush 47%, Al Gore
44%, Ralph Nader 2%, and Pat Buchanan 1%; the rest were either undecided or
supporting other candidates. The poll was reported to have a ±2% margin of error.
Let us take conﬁdence level q = 0.95, which gives z = 1.96. The four conﬁdence
intervals are
pBush = 0.47 ± 1.96

0.47(1 −0.47)
2207
= 0.47 ± 0.02
pGore = 0.44 ± 1.96

0.44(1 −0.44)
2207
= 0.44 ± 0.02
3This “two-step” approximation suggests that we can approximate the hypergeometric distribution directly
by the normal, without going via the binomial distribution. This is indeed true, and we could then use the
slightly lower variance of the hypergeometric distribution instead. In the given example, there is nothing
to gain from this.

310
STATISTICAL INFERENCE
pNader = 0.02 ± 1.96

0.02(1 −0.02)
2207
= 0.02 ± 0.006
pBuchanan = 0.01 ± 1.96

0.01(1 −0.01)
2207
= 0.01 ± 0.004
or in terms of percentage points, pBush = 47 ± 2 and so on. Note how the margins
of error differ because the length of the conﬁdence interval depends on p. When the
margin of error is stated as ±2%, this is correct for Bush’s and Gore’s numbers, but
for the smaller numbers of Nader and Buchanan, the margin of error is signiﬁcantly
smaller. See Problem 21 for more on this.
□
Note that the margin of error does not depend on the population size N, but on the
sample size n. Obviously this is an effect of the approximation and not true in general;
if we ask the 25 inhabitants of Luckenbach, Texas, whether they are feeling any pain,
our margin of error will be 0. However, as long as n is small relative to N, the size of
the population does not matter. Thus, if we ask 2000 people, the poll will be as much
valid in the United States as in Canada, Chile, or China.
Another point is that the margin of error also depends on the conﬁdence level,
and this is rarely reported in the media. A conﬁdence level of 95% is supposedly the
standard for the polling companies and a reasonable choice. Too much lower, and the
results are not trustworthy, too much higher and the margin of error may become too
large to be useful.
The theory of opinion polls is part of the area of survey sampling, an impor-
tant subdiscipline of statistics. There are many ways to improve the estimates and
conﬁdence intervals, such as by ensuring that different population subgroups are pro-
portionally represented in the sample, but we will not discuss this further. Instead,
we will focus on a common question regarding opinion polls: If there is a change
in support for a candidate between two consecutive polls, does this indicate a real
change in the population? The question can be answered with a conﬁdence interval
for the difference between two probabilities, p1 and p2. In short, suppose that we have
observed that p2 > p1. We then conclude that p2 > p1 if the conﬁdence interval for
p2 −p1 does not include 0. We call the difference statistically signiﬁcant, a concept
that will be further clariﬁed in Section 6.5. If the interval includes 0, we cannot rule
out that p2 ≤p1 and that the observed difference was due only to chance. Let us
revisit the election year 2000.
Example 6.9. Shortly after the October 2000 poll described in Example 6.8, another
poll was taken where 2167 individuals were surveyed and the percentages were 48%
for Bush, 43% for Gore, 3% for Nader, and 1% for Buchanan. Thus, two of the
candidates had gained support in the second poll. Does this indicate a real change in
the population?
Let us start with Bush’s numbers, p1 denoting the support in the population at the
time of the ﬁrst poll and p2 the support at the time of the second poll. The estimators

CONFIDENCE INTERVALS
311
are p1 and p2, and we have
p1
d≈N

p1, p1(1 −p1)
n

,
p2
d≈N

p2, p2(1 −p2)
m

where n and m are the sizes of the two polls. If we assume that the second poll is
done independent of the ﬁrst, this means that p1 and p2 are independent, and thus
p2 −p1
d≈N

p2 −p1, p2(1 −p2)
m
+ p1(1 −p1)
n

and we can construct a conﬁdence interval for p2 −p1 with methods similar to those
used before. If we thus substitute p1 and p2 with their estimators in the expression
for the variance, we get the conﬁdence interval
p2 −p1 = p2 −p1 ± z

p2(1 −p2)
m
+ p1(1 −p1)
n
(≈q)
where as usual (z) = (1 + q)/2. Again taking q = 0.95 gives
p2 −p1 = 0.48 −0.47 ± 1.96

0.48(1 −0.48)
2167
+ 0.47(1 −0.47)
2207
= 0.01 ± 0.03
which is the interval (−0.02, 0.04). Since this includes 0, the change is not large
enough to rule out randomness and the change is thus not statistically signiﬁcant. For
Nader’s numbers, we get
p2 −p1 = 0.03 −0.02 ± 1.96

0.03(1 −0.03)
2167
+ 0.02(1 −0.02)
2207
= 0.01 ± 0.009
which is an interval entirely above 0, so this change is statistically signiﬁcant, al-
beit just barely, and roundoff errors may also play a role here. The important point,
though, is that an increase by one percentage point in the polls is much more sig-
niﬁcant for Nader’s numbers in the single digits than for Bush’s, which are in the
40–50% range.
□
Another obvious question is whether the difference between Bush’s and Gore’s num-
bers of 47% and 44% in the ﬁrst poll is statistically signiﬁcant. Again, this can be
answered with a conﬁdence interval for the difference between two probabilities, pB
and pG, but note that the estimators pB and pG are not independent since they come
from the same sample. You are asked to investigate this in Problem 24.
In the media, we often hear statements like “candidate A leads candidate B in
the poll,” and later it is mentioned that the difference is within the margin of error.
Such statements are meaningless. To “lead in the poll” in the sense that the estimated

312
STATISTICAL INFERENCE
proportion is higher has no value unless the conﬁdence interval for the difference is
entirely above 0.
6.3.3
One-Sided Conﬁdence Intervals
Our conﬁdence intervals thus far have been of the type T1 ≤θ ≤T2 or θ = θ ± R,
which we call two-sided. Sometimes, it is more desirable to have one-sided intervals,
of the type θ ≤θ + R or θ ≥θ −R. For instance, consider Example 6.7 where the
conﬁdence interval for the mean lifetime of a lightbulb was 1086 ± 88 h. Instead
of claiming that the mean lifetime is between 998 and 1174, we may be interested
in claiming only that it is at least 998. Thus, we are interested only in one of the
conﬁdence limits and in such a case, it is a “waste of conﬁdence level” to construct a
two-sided interval by splitting 1 −q in two (equal) parts. Let us say that we want an
interval with only a lower bound. In the lightbulb example, this can be expressed as
μ ≥¯X −z σ
√n
(q)
where (z) = q. For q = 0.95, Table A.2 gives us z = 1.64, which yields the interval
μ ≥1086 −1.64100
√
5
= 1086 −73 = 1013 (0.95)
We see that if we are interested only in a lower bound of life expectancy we can make
a slightly stronger statement than before.
6.4
ESTIMATION METHODS
The estimators that we have come up with so far have been based on common sense,
such as estimating the mean by the sample mean. In more complicated situations,
there might not be an obvious estimator, and the question is how to ﬁnd one. In
this section, we will examine two general methods to ﬁnd estimators, based on two
different principles. Both methods work in great generality, and in simple cases they
give estimators that are intuitively reasonable.
6.4.1
The Method of Moments
We have seen that the sample mean ¯X is a natural estimator of the mean μ = E[X]
and that it has good properties. Suppose instead that the parameter we wish to estimate
is θ = E[X2]. Since this is the expected value of the random variable X2, it is logical
to estimate it by the sample mean of the squared observations:
θ = 1
n
n

k=1
X2
k

ESTIMATION METHODS
313
In the same way, we can estimate any expected value of the type E[Xr] by the
corresponding sample mean of the observations raised to the rth power. Let us state
some deﬁnitions.
Deﬁnition 6.10. Let X be a random variable. The rth moment of X is deﬁned as
μr = E[Xr]
Hence μ1 = E[X], μ2 = E[X2], and so on. Next we deﬁne the corresponding sample
means to be used as estimators.
Deﬁnition 6.11. X1, . . . , Xn be a random sample. The rth sample moment is deﬁned
as
μr = 1
n
n

k=1
Xr
k
In particular, μ1 = ¯X, the sample mean. Note that the moments are parameters com-
puted from the distribution and that the sample moments are estimators computed
from the sample. Also note that for each r, μr has mean and variance
E[ μr] = μr,
Var[ μr] = 1
nVar[Xr]
so that each sample moment is an unbiased estimator of the corresponding moment
and has a variance that is small for large n (unless Var[Xr] = ∞). Now, our parameter
of interest may not be one of the moments, but if it can be expressed as a function
of moments, it can be estimated by replacing moments by the corresponding sample
moments. This is the main idea behind the following deﬁnition.
Deﬁnition 6.12. Suppose that we can express the unknown parameter θ as a function
of the ﬁrst j moments, θ = g(μ1, . . . , μj). The estimator θ = g(μ1, . . . , μj) is then
called the moment estimator of θ.
The representation θ = g(μ1, . . . , μj) is not necessarily unique since parameters may
often be written as different functions of different moments. The convention is to
start by computing the ﬁrst moment μ1. If θ can be expressed as a function of μ1,
we are done. If not, we go on to compute the second moment and so on, until we
get the desired expression. Let us look at a few examples to illustrate the method,
appropriately named the method of moments.

314
STATISTICAL INFERENCE
Example 6.10. Let X1, . . . , Xn be a sample from an exponential distribution with
unknown parameter λ. Find the moment estimator of λ.
We start by computing the ﬁrst moment
μ1 = E[X] = 1
λ
and hence λ = 1/μ1. In the terminology of Deﬁnition 6.12, we have j = 1 and g(x) =
1/x. The moment estimator is therefore
λ = 1
μ1
= 1
¯X
□
In the last example, it was sufﬁcient to ﬁnd the ﬁrst moment. Let us next look at a few
examples where this is not the case. The ﬁrst of these also illustrates the fact that we
do not always need to know the distribution of the Xk to ﬁnd moment estimators.
Example 6.11. Let X1, . . . , Xn be any random sample with mean μ and variance σ2.
Find the moment estimators of μ and σ2.
Since μ1 = μ, the moment estimator of μ is μ1 = ¯X. For the variance, note that
σ2 = E[X2] −(E[X])2 = μ2 −μ2
1
so the moment estimator is
σ2 = μ2 −μ2
1 = 1
n
n

k=1
X2
k −¯X2 = 1
n
n

k=1
(Xk −¯X)2
after some algebra. Note that this is not equal to the unbiased estimator s2. Moment
estimators are not necessarily unbiased but can sometimes be adjusted to be so. In
this case, we can multiply σ2 by n/(n −1) to obtain an unbiased estimator.
□
Example 6.12. The following is an observed sample from a uniform distribution on
[−θ, θ], where θ is unknown. Find the moment estimate of θ:
−6.9, 2.8, 3.4, 6.4, 6.7, 8.0
Let us ﬁrst ﬁnd the moment estimator for a sample X1, . . . , Xn. The ﬁrst moment
is μ1 = E[X] = 0, which does not help us, so we need to proceed to the second
moment. We get
μ2 =
 θ
−θ
x2f(x)dx = 1
2θ
	x3
3

θ
−θ
= θ2
3

ESTIMATION METHODS
315
which gives
θ =

3μ2
The moment estimator is therefore
θ =

3μ2 =



3
n
n

k=1
X2
k
and in our case this becomes
θ =

3
6 × 217 = 10.4
which is an estimate that we would certainly have been unable to ﬁgure out by intuition
alone.
□
6.4.2
Maximum Likelihood
The method of moments from the previous section was based on the simple idea of
estimating each moment by its corresponding sample moment. In this section, we
consider another estimation principle, which is based on the idea of choosing the
most likely parameter value for a given sample. We illustrate this in an example.
Example 6.13. A digital communication system transmits 0s and 1s. We know that on
average, one of the bits is sent twice as often as the other, but we do not know which
one. In an attempt to decide which, we have the following four observations: 1, 1, 0, 1
(independent transmissions and no transmission error). Of course, our immediate
observation is that there are more 1s than 0s and hence we ought to believe that 1
is the more common. We now formalize this intuitive reasoning as an estimation
problem.
Let p be the probability that 1 is sent. Then we know that p is either 1
3 or 2
3. Hence
we can view p as an unknown parameter with possible values in { 1
3, 2
3}. Let us now
compute the probability to get the outcome that we actually got. By independence
P(1, 1, 0, 1) = p × p × p × (1 −p) × p = p3(1 −p)
If p = 1
3, this equals 0.025, and if p = 2
3, it equals 0.099. Since p must be either of
the two and P(1, 1, 0, 1) is higher if p is 2
3, we may say that 2
3 is a more likely value
of p than 1
3 and choose 2
3 as our estimate of p.
□
Note the idea in the example. We look at the outcome we got and then ask which value
of the parameter we think it came from. The parameter that maximizes the probability
of the outcome is chosen as the estimate. Let us return to the example.

316
STATISTICAL INFERENCE
Example 6.14. Now assume that we do not know anything about p and wish to esti-
mate it on the basis of the same observations and the same principle. The probability
of our outcome is a function of p, say, L(p), where
L(p) = p3(1 −p),
0 ≤p ≤1
just as above but p can now be any number in [0, 1]. On the basis of the same principle
as above, we wish to ﬁnd the most likely value of p, and to that extent we ﬁnd the
maximum of L(p) by the usual method of differentiation. We get
L′(p) = 3p2 −4p3 = p2(3 −4p)
Setting this to 0 yields p = 0 or p = 3
4, and since the second derivative is
L′′(p) = p(6 −12p) < 0
for p = 3
4
we see that p = 3
4 gives the maximum (the value p = 0 is also unreasonable since
we have 1s in our sample). Our estimate is p = 3
4, the relative frequency of 1s.
□
Let us now generalize the method from the example. First, let us restate the example
in terms of random variables. Thus, let X be a random variable that describes a
transmitted bit. Then X = 1 with probability p and X = 0 with probability 1 −p,
and the probability mass function of X is therefore
fp(0) = 1 −p,
fp(1) = p
The index p emphasizes that the probability mass function depends on the parameter
p (and it looks better to use f rather than the previous p for the pmf). We now realize
that the function L in Example 6.14 can be written as
L(p) = fp(1)fp(1)fp(0)fp(1)
the product of the probability mass function evaluated at the observed values. We can
now easily generalize to the case where we have a sample X1, . . . , Xn of 0s and 1s
with probability mass function as above. The function L becomes
L(p) =
n

k=1
fp(Xk)
where we note that there are Xk in the arguments so L(p) is actually random. However,
we view it as a function of p, and for that purpose we can view the Xk as ﬁxed. When
we maximize, the maximum is attained at some point p that must then be a function
of the Xk and p is a random variable exactly as we want an estimator to be. To ﬁnd
out what p is in this case, see Problem 33.
The method described above can be directly generalized to any discrete distri-
bution. If X1, . . . , Xn is a sample from a discrete distribution with pmf fθ, we can de-
ﬁne L(θ) as the product fθ(X1) · · · fθ(Xn), which again describes how likely different

ESTIMATION METHODS
317
parameter values are to produce the sample X1, . . . , Xn. For a continuous distribu-
tion, the probability mass function is replaced by the pdf, which, as we already know,
is not directly interpretable as a probability. It is still a measure of how X is distributed
over its range, in the sense that large values of f correspond to regions where X is
more likely to be. Hence, we can still deﬁne the function L(θ) and interpret it as a
measure of how likely a parameter value θ is to produce the sample X1, . . . , Xn. We
now formalize this.
Deﬁnition 6.13. Let X1, . . . , Xn be a random sample from a distribution that has
pmf or pdf fθ. The function
L(θ) =
n

k=1
fθ(Xk)
is called the likelihood function. The value θ where L attains its maximum is called
the maximum-likelihood estimator (MLE) of θ.
To ﬁnd the MLE, we thus view X1, . . . , Xn as ﬁxed and ﬁnd the maximum of the
function L(θ) by using common techniques from calculus. As it is most often easier
to maximize a sum than a product, we deﬁne the log-likelihood function as
l(θ) = log L(θ)
and maximize this instead of L. Since the logarithm is a strictly increasing function,
l and L attain maximum for the same argument. To ﬁnd the MLE, the following
algorithm often works:
1. Find L(θ) and l(θ) = log L(θ).
2. Differentiate l(θ) with respect to θ and set equal to 0.
3. Solve for θ and denote the solution θ.
4. Check that l′′(θ) < 0 to ensure maximum. If this holds, then θ is the MLE.
Although L(θ) could have several local maxima, it can be shown that the MLE exists
and is unique under some fairly general assumptions. The second derivative check in
step 4 is also often superﬂuous, as the function l(θ) is often strictly concave. We will
not address these issues here and instead turn to some examples.
Example 6.15. Let X1, . . . , Xn be a sample from an exponential distribution with
unknown parameter λ. Find the MLE of λ.
The pdf is
fλ(x) = λ e−λx,
x ≥0

318
STATISTICAL INFERENCE
which gives likelihood function
L(λ) =
n

k=1
λ e−λXk = λn exp

−λ
n

k=1
Xk

The log-likelihood function is
l(λ) = log L(λ) = n log λ −λ
n

k=1
Xk
which has derivative
d
dλl(λ) = n
λ −
n

k=1
Xk = n
1
λ −¯X

and the equation
d
dλl(λ) = 0
has solution
λ = 1
¯X
which is the MLE (the second derivative is always negative), and we note that it is
the same as the moment estimator from the previous section.
□
Example 6.16. Let X1, . . . , Xn be a sample from a Poisson distribution with mean
λ. Find the MLE of λ.
This time the random variable is discrete with pmf
fλ(k) = e−λ λk
k! , k = 0, 1, . . .
which gives
L(λ) =
n

k=1
e−λ λXk
Xk! = Ce−nλλn ¯X
where C = (X1! · · · Xn!)−1. We get
l(λ) = log C −nλ + n ¯X log λ
which has derivative
d
dλl(λ) = −n + n
¯X
λ

ESTIMATION METHODS
319
which set equal to 0 gives the MLE
λ = ¯X
the sample mean.
□
Note how there is no difference between the discrete and the continuous cases in
the way the method is applied. The next example is a case where differentiating the
log-likelihood function does not work.
Example 6.17. Let X1, . . . , Xn be a sample from a uniform distribution on [0, θ].
Find the MLE of θ.
The pdf is
fθ(x) =

1/θ
if 0 ≤x ≤θ
0
otherwise
When we write down the likelihood function, we need to remember that we view the
Xk as ﬁxed and θ as the parameter. We get the following expression:
L(θ) =

1/θn
if θ ≥all Xk
0
otherwise
We may ﬁrst try to take the logarithm and differentiate with respect to θ, but this leads
us to nowhere. In Figure 6.2, we can see that L attains its maximum precisely where
X(1)
X(3)
X(2)
θ
L(θ) 
FIGURE 6.2
The likelihood function L(θ) for a sample of size n = 3 from a uniform
distribution on [0, θ]. The maximum is attained at the largest observation X(3).

320
STATISTICAL INFERENCE
the largest X value is. Recalling the order statistics from Deﬁnition 3.20, we realize
that
θ = X(n)
the maximum value in the sample. Note that this estimator is different from the one
obtained previously by the method of moments, and also recall Example 6.1.
□
We will next ﬁnd the MLEs of μ and σ2 in the N(μ, σ2) distribution. If one of
the parameters is known, it is straightforward to estimate the other, and if both are
unknown, we can view them as a two-dimensional parameter θ = (μ, σ2). In the
deﬁnition of maximum likelihood, we simply maximize over two variables instead
of one, everything else remaining the same. We could argue whether we should ﬁnd
the MLE of σ or σ2, but it turns out that we can ﬁnd either one and then square or
take the square root to ﬁnd the other. This is by virtue of the following proposition,
which we state without proof.
Proposition 6.7. If θ is the MLE of θ and g is a one-to-one function, then g(θ) is
the MLE of g(θ).
Example 6.18. Let X1, . . . , Xn be a random sample from a N(μ, σ2) distribution
where both μ and σ2 are unknown. Find the MLEs of μ and σ2.
By virtue of Proposition 6.7, we can view the likelihood function as a function of μ
and σ, rather than μ and σ2. The likelihood function is
L(μ, σ) =
n

k=1
fμ,σ(Xk) =
n

k=1
1
σ
√
2π
e−(Xk−μ)2/2σ2
=

1
√
2π
n 1
σn exp

−1
2σ2
n

k=1
(Xk −μ)2

and the log-likelihood function is
l(μ, σ) = −n log
√
2π −n log σ −
1
2σ2
n

k=1
(Xk −μ)2
We set the partial derivative with respect to μ equal to 0 to obtain
∂l
∂μ = 1
σ2
n

k=1
(Xk −μ) = 1
σ2
 n

k=1
Xk −nμ

= 0

ESTIMATION METHODS
321
which gives μ = ¯X. The partial derivative with respect to σ, with μ replaced by ¯X,
gives
∂l
∂σ = 1
σ

−n + 1
σ2
n

k=1
(Xk −¯X)2

= 0
which gives the MLEs
μ = ¯X

σ2 = 1
n
n

k=1
(Xk −¯X)2
which are the same as the moment estimators. By virtue of Proposition 6.7, the MLE
of the standard deviation σ is
σ =



1
n
n

k=1
(Xk −¯X)2
□
The maximum-likelihood principle is central to statistics and can be used to solve
various estimation problems, even for quite complex models. Besides being general,
it can also be shown to produce good estimates. In fact, MLEs are in a sense optimal,
at least asymptotically, which the following result formalizes.
Proposition 6.8. Let θn be the MLE of θ based on the sample X1, . . . , Xn and
assume that the Fisher information I(θ) exists. Then
(i) E[θn ] →θ
(ii) θn is consistent
(iii) e(θn) →1
(iv) √nI(θ)(θn −θ)
d→N(0, 1)
as n →∞.
The ﬁrst and the third part says that an MLE is asymptotically unbiased and asymp-
totically efﬁcient, which implies that, for large samples, there is (practically) no better
estimator. The last part is very useful when deriving approximate conﬁdence intervals
based on MLEs. It can be reformulated for large n as
θn
d≈N

θ,
1
nI(θ)


322
STATISTICAL INFERENCE
which can be used in the same way as in Section 6.3.1 to obtain the interval
θ = θn ±
z

nI(θn)
(≈q)
where z satisﬁes (z) = (1 + q)/2. Note that I(θ) is replaced by I(θn) in the error
bound. Since θ is unknown, we cannot compute I(θ), but if n is sufﬁciently large we
know that θ ≈θn and, consequently, that I(θ) ≈I(θn). One has to be aware that this
interval is probably slightly narrower than an exact interval or, correspondingly, that
the true conﬁdence level is lower than q since Var(θn) ≥1/nI(θ), but for large n this
will be negligible.
Example 6.19. Let us apply this to Example 6.15 to derive an approximate conﬁdence
interval for λ in the exponential distribution. The Fisher information in this case
becomes
I(λ) = −E
	 ∂2
∂λ2 log(λe−λX)

= 1
λ2
Replacing λ with λ = 1/ ¯X yields
λ = 1
¯X ±
z
√
n ¯X2 = 1 ± z/√n
¯X
(≈q)
However, the exponential distribution is notoriously difﬁcult to approximate by the
normal distribution because of its heavily skewed nature, so n would have to be really
large for this interval to be accurate. In this case, it is actually preferable to use the
central limit theorem
¯X
d≈N

μ = 1
λ, σ2
n =
1
nλ2

to derive an approximate conﬁdence interval for μ as
μ = ¯X ±
z

nλ2 = ¯X ± z
¯X
√n
(≈q)
and then taking the reciprocal to obtain
1
¯X(1 + z/√n) ≤λ ≤
1
¯X(1 −z/√n)
(≈q)
□
6.4.3
Evaluation of Estimators with Simulation
Estimators derived using the method of moments or maximum-likelihood can have
complicated expressions as functions of the sample. If, for example, we want to

ESTIMATION METHODS
323
check unbiasedness or compute the standard error for quality assessment, this may be
difﬁcult or even impossible. One way to evaluate such estimators is to use simulation.
Example 6.20. Let X1, X2, . . . , Xn be a random sample from a distribution with pdf
f(x) = θxθ−1,
0 ≤x ≤1
where θ is an unknown parameter. Find the moment estimator of θ and examine its
properties.
The ﬁrst moment is
μ =
 1
0
xf(x)dx = θ
 1
0
xθdx =
θ
1 + θ
which gives
θ =
μ
1 −μ
and the moment estimator
θ =
¯X
1 −¯X
It is difﬁcult to compute the mean and variance of θ, so let us instead examine its
properties by simulation. To do so, we ﬁrst choose a value of θ and a sample size n,
then run repeated simulations of samples X1, . . . , Xn and each time compute θ. This
gives us a sample θ1, . . . ,θN, where N is the number of simulated samples. Now we
can use the sample mean (let us call it θ to avoid putting a bar on top of a hat)
θ = 1
N
N

k=1
θk
and sample variance
s2 =
1
N −1
N

k=1
(θk −θ)2
to estimate E[θ ] and Var[θ ] (where as usual it is more informative to take the square
root to get the standard deviation s). Note that each observation on θ is computed
from n observations, so we simulate a total of N × n X values. We also need to repeat
this for various values of θ and n.
To simulate observations on X, we use the inverse transform method from Propo-
sition 5.2. The cdf of X is
F(x) =
 x
0
f(t)dt = θ
 x
0
tθ−1dt = xθ,
0 ≤x ≤1

324
STATISTICAL INFERENCE
TABLE 6.1
Estimated Means θ and
Standard Deviations s of the Estimator
θ, Based on Simulations of Sample Size n
and True Parameter Value θ
n
θ
θ
s
5
2
2.32
1.33
10
2
2.18
0.85
50
2
2.01
0.30
100
2
2.02
0.21
1000
2
2.00
0.07
the inverse of which is
F−1(x) = x1/θ,
x ≥0
Let us take θ = 2. If U1, . . . , Un are i.i.d. standard uniform, our sample is
X1 =
√
U1, . . . , Xn =

Un
and from this we compute
θ =
¯X
1 −¯X
This gives us one observation on θ, and we repeat the procedure N times to get our
sample of observations on θ. Let us take N = 1000 and n = 10. A Matlab simulation
gave the estimated mean θ = 2.18, which we compare with the true mean 2, and it
looks pretty good. The standard error was s = 0.85. Make sure not to confuse the
two sample sizes; n is the “real” sample size and N is the number of simulations that
we decide to run. To investigate the effect of the sample size n, simulations were run
with n = 5, 10, 50, 100, and 1000. The results are summarized in Table 6.1.
We can see that θ tends to overestimate θ a little but that it is pretty accurate and
becomes more so when the value of n is larger. This last observation is not surprising
since θ is based on ¯X, and we can invoke the law of large numbers and Corollary
4.2. These results are of no help when it comes to smaller values of n, though. Figure
6.3 gives histograms for the cases n = 10 and n = 1000. We will stop here, but to
continue the investigation we would need to run simulations for many different values
of θ. If we have reason to believe that θ is in some particular range, this can help us
reduce the number of simulations.
□
6.4.4
Bootstrap Simulation
The simulation method presented in the previous section works only when we have
full knowledge about the underlying distribution of an actual sample, something that

ESTIMATION METHODS
325
0
2
4
6
8
0 
50 
100 
150 
200 
250 
1.9
2
2.1
2.2
0 
20 
40 
60 
80 
100 
120 
FIGURE 6.3
Histograms from simulations of the estimator θ for θ = 2, n = 10 and θ = 2,
n = 1000, respectively. Note the different scales on the x-axis.
is rarely true in reality. Let us assume that we have the observed sample x1, . . . , xn and
we want to say something about the point estimator θ = g(X1, . . . , Xn). The general
idea that the properties of estimators may be evaluated by generating new random
samples can still be used, but instead of the true distribution we use the empirical
distribution function
Fn(x) = 1
n
n

i=1
I{xi≤x}
where IA denotes the indicator of the event A. In practice, it simply means that a
simulated sample X1, . . . , Xn is obtained by picking n values at random from the
observed sample with replacement. Finally, we obtain a simulated sample of values
of θ by repeating this procedure N times as in the previous section. If n is large, the
empirical distribution Fn(x) approximates the true distribution F(x), which means
the obtained sample of θ values will reﬂect the true distribution reasonably well.
This method of simulating random samples from an unknown distribution is called
bootstrap simulation4.
Example 6.21. The concentrations of antibodies against pertussis (whooping cough)
in the blood of umbilical cords of 30 randomly chosen mothers in Sweden from 2007
are presented below.
0.0
0.0
0.0
0.0
1.7
2.3
2.9
3.3
4.0
4.5
5.3
6.1
6.7
7.9
8.9
10.3
11.1
12.2
13.1
14.4
16.0
17.4
21.0
24.4
29.4
33.5
42.1
52.2
93.9
353.7
4Using a distribution we know nothing about is like lifting ourselves by the bootstraps much like the
eighteenth century nobleman and adventurer Baron M¨unchhausen.

326
STATISTICAL INFERENCE
Let us say that we want to estimate the mean concentration and give a 95% conﬁdence
interval based on the sample. The observed sample mean and sample variance are
¯x = 26.6 and s2 = 4201. Since we have a rather large sample size, we can hope that
the approximate conﬁdence interval
μ = ¯x ± z s
√n = 26.6 ± 1.96

4201
30
= 26.6 ± 23.2
or
3 ≤μ ≤50
(95%)
is somewhat reliable. Now, let us instead generate N = 1000 independent bootstrap
samples of size 30 by resampling the original data set and calculate the sample mean
of each one. This produces a sample ¯x1, . . . , ¯xN that hopefully represents the true
sampling distribution of ¯X. We then get the bootstrap mean as
¯¯x = 1
N
N

i=1
¯xi = 26.8
and bootstrap variance as
s2
¯x =
1
N −1
N

i=1
(¯xi −¯¯x)2 = 141
The latter quantity corresponds to the standard error, which also can be estimated as
s2
n = 4201
30
= 140
which is reassuring. However, since the simulated means can be regarded as a random
sample from the underlying sampling distribution of ¯X, we can calculate a conﬁdence
interval by taking the 2.5 and 97.5 percentiles, that is, the 25th smallest value ¯x(25)
and the 25th largest value ¯x(975). In this case, we get the bootstrap conﬁdence interval
10 ≤μ ≤55
(95%)
Note that this yields an asymmetric interval, which reﬂects the asymmetrical nature
of the observed sample.
Since this procedure can be applied to any estimator, we can also get a conﬁdence
interval for the variance. Again, generate N = 1000 bootstrap samples as before (or
recycle the old ones) and calculate the sample variances s2
1, . . . , s2
N for all of them. It
turns out that we get the bootstrap mean
¯s2 = 1
N
N

i=1
s2
i = 4074

HYPOTHESIS TESTING
327
and bootstrap variance
s2
s2 =
1
N −1
N

i=1
(s2
i −¯s2)2 = 1.216 × 107
Again, the second value is an estimate of the sampling variance of s2, which usually is
difﬁcult to obtain analytically. Finally, we ﬁnd the 25th smallest s2
(25) and 25th largest
s2
(975) to get a 95% conﬁdence interval as
108 ≤σ2 ≤11100
(95%)
□
In Section 6.4.3, we could increase the number of simulations to achieve any desired
precision in our estimates since we used the exact sample distribution. Here, we are
limited by the size of our original observed sample, and increasing the number of
bootstrap samples beyond some level does not improve the results very much. In this
example, we used N = 1000, which is quite sufﬁcient for a sample of size n = 30.
It makes no sense to put a lot of simulation power into a bootstrap analysis if the
results refer only to the empirical distribution, which is just an approximation of the
true underlying distribution.
6.5
HYPOTHESIS TESTING
We have learned to ﬁnd estimators and conﬁdence intervals for unknown parameters,
based on observed data. Once this has been done, we are also often interested in
drawing some particular conclusion about the underlying distribution. Let us look at
a simple example to illustrate the main problem and idea.
Example 6.22. Suppose that we have a coin and want to test whether it is fair. To do
so, we ﬂip it 100 times and count the number of heads. How can we decide if the
coin is fair?
First, if the coin is fair, the expected number of heads is 50. Now, we do not require
to get exactly 50 heads since there is variability due to randomness, so the question is
whether our outcome is easily explained by such natural variability or indicates that
the coin is unfair. What if we get 55 heads? What if we get 70, 80, or 100 heads?
Certainly all of these outcomes are possible, so the only criterion we can use is how
probable they are, and to assess this, we need to invoke the distribution of the number
of heads.
Let us ﬁrst restate the problem in terms of the unknown parameter p, the probability
of getting heads in a single ﬂip. Our estimate of p is the observed relative frequency
p, and if the coin is fair, then p = 0.5. The question is now whether the value of
p deviates too much from 0.5 for us to believe in fairness. We need to quantify

328
STATISTICAL INFERENCE
“too much” and decide how much deviation we can accept. Let us say that an outcome
that has probability as small as 0.05 is acceptable but not any smaller. Thus, we ﬁrst
assume that p = 0.5 and will change our mind and decide that the coin is unfair if p
deviates from 0.5 by more than d, where
P(| p −0.5 | ≥d) = 0.05
By the central limit theorem, we know that p has an approximate normal distribution
with mean 0.5 and standard deviation √0.5(1 −0.5)/100 = 0.05. Thus, we choose
d such that
0.05 = P(| p −0.5 | ≥d) = 1 −P

−d
0.05 ≤p −0.5
0.05
≤
d
0.05

= 2

1 −
 d
0.05

which gives (d/0.05) = 0.975, which in turn gives d = 1.96 × 0.05 = 0.098. Thus,
if p is less than 0.402 or greater than 0.598, we decide that this is not because of
random variation but rather that the coin is not fair. In this case, we say that we reject
the hypothesis of fairness. In terms of the number of heads, this means that we reject
the hypothesis of fairness if there are ≤40 or ≥60 heads. There is a possibility that
such a conclusion is wrong and we know that the probability of this is 0.05. We are
thus taking a 5% risk of classifying a fair coin as unfair.
□
This example illustrates the main idea in hypothesis testing. We set up a hypothesis
about an unknown parameter and test it by estimating the parameter. According to
how extreme the estimate comes out, we either reject or accept the hypothesis.
Note how this is reminiscent of mathematical proof by contradiction. In such
a proof, we start by making an assumption, and if we arrive at a contradiction, we
conclude that the assumption was false. In hypothesis testing we make an assumption,
and if we observe a very unlikely outcome, we decide that the assumption was false,
realizing that there is a small risk that we are wrong.
Let us introduce some concepts and notation. Suppose that θ is an unknown pa-
rameter and we want to decide whether θ equals some speciﬁc value θ0. We then
formulate the null hypothesis that θ = θ0, written
H0 : θ = θ0
In conjunction with the null hypothesis, we also have an alternative hypothesis,
denoted HA. This could, for example, be
H0 : θ = θ0
versus HA : θ > θ0
Such an alternative hypothesis is said to be one-sided (as is HA : θ < θ0). A test
against a two-sided alternative has the form
H0 : θ = θ0
versus HA : θ /= θ0

HYPOTHESIS TESTING
329
It has to be decided in each case whether a one-sided or two-sided alternative hypo-
thesis is reasonable. To test H0 versus HA, we need the following concepts.
Deﬁnition 6.14. A test statistic T is a function of the sample, used to test H0. The
signiﬁcance level α and the critical region C are determined such that
P(T ∈C) = α
under the assumption that H0 is true. If T ∈C, we reject H0 in favor of HA.
The critical region is often an interval of the form C = (−∞, c ] or something similar.
The number c is then called the critical value. The test statistic5 is typically based on
an estimator θ. It could be θ itself or some function of θ. Two things are important
for the test statistic: it indicates whether we should believe more in HA than in H0
and its distribution is completely known. The signiﬁcance level α is the risk we are
willing to take to reject a hypothesis that is in fact true, and some standard values
of α are 0.05, 0.01, and 0.001 or as percentage points, 5%, 1%, and 0.1%. If we
cannot reject H0, we say that we accept it. This does not mean that we prove it, it
is only that the data do not support a rejection. In the coin ﬂip example, even if we
cannot reject fairness, the coin may still be unfair but to such a small extent that it is
hard to detect. This is a typical problem in hypothesis testing, and we will return to
it later.
In the coin ﬂip example above, we have the null and alternative hypotheses
H0 : p = 0.5 versus HA : p /= 0.5
Here we want a two-sided alternative since we are not interested primarily in any
particular “direction of unfairness.” The estimator of p is p, the relative frequency.
Large deviations of p from 0.5 indicate that H0 is not true. Rather than using p
directly, let us use the test statistic T deﬁned as
T = p −0.5
0.05
which is approximately N(0, 1) if H0 is true and we proceed to ﬁnd the critical region
C. We should reject H0 if the observed value of T deviates too much from 0. The
critical region should be of the form C = (−∞, −c ] ∪[ c, ∞), and if we choose
signiﬁcance level 0.05, we get
0.05 = P(T ∈C) = 2(1 −(c))
which gives (c) = 0.975, which ﬁnally gives c = 1.96. Thus, we reject H0 in favor
of HA on the 5% level if |T| ≥1.96.
5Generally, the term statistic is used for any function of a random sample. Thus, an estimator is a statistic
used to estimate an unknown parameter, and we have previously introduced order statistics.

330
STATISTICAL INFERENCE
Example 6.23. The IQ of a randomly chosen individual in a population is, as pointed
out in Example 2.41, constructed to be normally distributed with mean 100 and
standard deviation 15. Assume that a group of eight pupils have tested a new peda-
gogical method, designed to increase IQ, for one semester. To evaluate the method,
they take an IQ test after the study period, which yields the results
87, 92, 97, 110, 115, 120, 121, 122
The main question is now: Does this sample provide enough evidence to conclude that
the method works? Clearly, ﬁve out of the eight pupils recorded IQs above average,
some of them quite far above. On the other hand, can we call the test successful when
three pupils ended up below average? Since we want to draw general conclusions
about the method and not just how these eight pupils performed, we can consider this
as an observed sample from some underlying distribution. But which distribution?
If the method does not work, that is, it does not affect the IQ, we would expect the
sample to be normally distributed with parameters μ = 100 and σ = 15. On the other
hand, if it had been effective, we would expect that the pupils had increased their IQs
by some quantity. If we assume that the individual variation is the same, we can then
assume that it is normally distributed with some μ larger than 100 and σ = 15. To
formalize this, we want to test the hypotheses
H0 : μ = 100 versus HA : μ > 100
Since we estimate μ by the sample mean ¯X, we can use that as a test statistic or,
equivalently,
Z =
¯X −μ0
σ/√n =
¯X −100
15/
√
8
Now, we are looking for evidence to reject H0 in favor of HA, so we should only reject
if Z is large enough. Under the assumption that H0 is true, Z d= N(0, 1), which
means that
α = P(Z > c) = 1 −(c)
For α = 0.10, for example, we get that c = 1.28. In this case, the value of the test
statistic becomes
Z = 108 −100
15/
√
8
= 1.51
which means that we can reject the null hypothesis and claim that the method indeed
works.
□
The IQ example illustrates a typical situation in hypothesis testing—it is often the
alternative hypothesis that we want to prove, and we therefore set up a null hypothesis
that we wish to reject in favor of the alternative. From a scientiﬁc point of view, it is
easier to falsify a hypothesis than to prove it, and the philosophy of hypothesis testing

HYPOTHESIS TESTING
331
reﬂects this principle.6 If we cannot reject the null hypothesis, we say that we accept
it, which does not mean that it is proven, only that we cannot show it to be false.
In legal terminology, the null hypothesis is “innocent until proven guilty.” The two
examples illustrate the general procedure to perform a hypothesis test:
1. State the null and alternative hypotheses, H0 and HA.
2. Find the test statistic T and decide for which type of values (large, small, posi-
tive, negative, . . . ) it rejects H0 in favor of HA. Make sure that the distribution
of T is completely known under the assumption that H0 is true (often expressed
“under H0”).
3. Choose a signiﬁcance level α. Find the critical region C by assuming that H0 is
true and set P(T ∈C) = α. The general form of C was determined in 2, now
you get the numbers.
4. Compute T and compare with the critical region. If T ∈C, reject H0 in favor
of HA, otherwise accept H0.
Although the method of hypothesis testing seems somewhat different from calculating
conﬁdence intervals, they are in fact two sides of the same coin, which can be
formalized as follows.
Proposition6.9 (CorrespondenceTheorem). LetX1, . . . , Xn bearandomsample
and θ an unknown parameter.
(i) Let I be a conﬁdence interval for θ such that P(θ ∈I) = q. Then θ0 /∈I is a
rejection rule for the test of H0 : θ = θ0 on signiﬁcance level 1 −q.
(ii) Let C be a critical region for the test statistic T such that P(T ∈C) = α
under the assumption that H0 : θ = θ0 holds. Then I = {θ0 : T /∈C} is a
conﬁdence interval of θ on conﬁdence level 1 −α.
The proof is rather straightforward and is left as an exercise.
More informally, the correspondence theorem says that a conﬁdence interval
consists of exactly those parameter values that cannot be rejected in a hypothesis
test and vice versa. This means that a hypothesis test can always be carried out by ﬁrst
calculating a conﬁdence interval and then checking if θ0 is included, and if not, H0
can be rejected. However, it is the second part that is most useful because there are
situations where it is easier to come up with a good hypothesis test than a conﬁdence
interval, so then the former can be used to construct the latter. This will be used in
6Recall our discussion in Example 1.33 regarding the hypothesis “All swans are white.” To falsify this, we
only need to observe a single black swan, but to prove it we would need to observe all swans and note that
they are white. As long as all hitherto observed swans are white, we may say that we accept the hypothesis
but it has not been proved.

332
STATISTICAL INFERENCE
Section 6.9 where some alternative methods of hypothesis testing will be introduced
and where it is not obvious how conﬁdence intervals for the parameters involved
should be constructed.
6.5.1
Large Sample Tests
In Section 6.4, we introduced an approximate method of calculating conﬁdence
intervals for MLEs. The same result can also be used to obtain an approximate test
procedure.
Proposition 6.10. Let θ be an MLE of the unknown parameter θ based on the large
sample X1, . . . , Xn. We wish to test the null hypothesis
H0 : θ = θ0
versus HA : θ /= θ0
The test statistic is
Z =

nI(θ0)(θ −θ0)
where I(θ0) is the Fisher information at θ0, and we reject H0 on level ≈α if
|Z| ≥c
where (c) = 1 −α/2.
Proof. Proposition 6.8 implies that
Z =

nI(θ0)(θ −θ0)
d≈N(0, 1)
for large n under the condition that H0 holds. The approximate signiﬁcance level is
then
P(|Z| ≥c) = P(Z ≤−c) + P(Z ≥c) ≈(−c) + 1 −(c)
= 2(1 −(c)) = α
■
Example 6.24. Let X1, . . . , Xn be a random sample from the Poisson distribution
with parameter λ. We want to test the hypotheses
H0 : λ = λ0
versus HA : λ /= λ0

HYPOTHESIS TESTING
333
on the 5% level under the assumption that n is large. In Example 6.16, the MLE of λ
was derived as λ = ¯X. The Fisher information for the Poisson distribution is
I(λ) = −E
	 ∂2
∂λ2 log

e−λ λX
X!

= −E
	
−X
λ2

= 1
λ
This yields the test statistic
Z =
√n(λ −λ0)
√λ0
and the rejection rule |Z| ≥1.96.
□
6.5.2
Test for an Unknown Probability
The coin ﬂip example also ﬁts into a general test situation. Suppose that we want to
test whether an unknown probability p equals a speciﬁc value p0. We can then test
H0 : p = p0 based on the estimator p.
Proposition 6.11. Let p be an unknown probability, estimated by the relative fre-
quency p based on n independent trials. We wish to test the null hypothesis
H0 : p = p0
versus HA : p /= p0
The test statistic is
T =
p −p0

p0(1 −p0)/n
and we reject H0 on level ≈α if
|T| ≥c
where (c) = 1 −α/2.
Proof. Under H0, we know that
p
d≈N

p0, p0(1 −p0)
n

and hence T
d≈N(0, 1) and
α = P(|T| ≥c) ≈2(1 −(c))
■
For one-sided alternatives, we reject if T ≥c (or T ≤−c), where (c) = 1 −α, in
an analogy with previous results. Note that we are using the normal approximation,

334
STATISTICAL INFERENCE
so the signiﬁcance level can be reported to be only ≈α. If there is a reason to suspect
that the normal approximation does not work well, a test could be derived from the
binomial distribution instead.
Example 6.25. A company makes plastic paper clips and the manufacturing process
needs to be adjusted if the probability that a clip is defective exceeds 10%. To
investigate whether adjustment is needed, 500 randomly selected clips are checked
and 55 of these are found to be defective. Test on the 5% level whether adjustment is
needed.
The hypotheses are
H0 : p = 0.1 versus HA : p > 0.1
and we use the test statistic
T =
p −0.1
√0.1 × 0.9/500
and reject if T ≥c, where (c) = 0.95 (one-sided alternative). Table A.2 gives c =
1.64, and since we have observed p = 55/500 = 0.11, we get T = 0.75 and cannot
reject H0. There is no need for adjustment.
□
6.6
FURTHER TOPICS IN HYPOTHESIS TESTING
In this section, we will address some topics related to testing methodology, potential
problems and errors, and quality criteria for hypothesis tests. We start with a closer
examination of signiﬁcance levels.
6.6.1
P-Values
The choice of signiﬁcance level is quite arbitrary, although certain values have
emerged as being typical. Still, it is not always satisfactory to ﬁx α in advance.
Let us revisit Example 6.23 about the IQ test to see an example of this. We chose
α = 0.10, which gave the critical value c = 1.28, and since we observed T = 1.51,
we could reject H0. Now, 1.51 is not much higher than 1.28, so we might not have
been able to reject also on the level α = 0.05. For this α, Table A.2 gives c = 1.64, so
we cannot indeed reject on the 5% level. There is still some room for improvement,
and we realize that we can reject on any level as long as the corresponding c does not
exceed 1.51. With c = 1.51 and Table A.1, we get
P(Z ≥1.51) = 1 −(1.51) = 0.066
which is the lowest signiﬁcance level on which we can reject H0 from the observed
data. By stating this number instead of merely testing on some ﬁxed signiﬁcance
level, we have given a measure of how strong evidence the data give against H0.

FURTHER TOPICS IN HYPOTHESIS TESTING
335
Deﬁnition 6.15. The P-value of a test is the lowest signiﬁcance level on which we
can reject H0 for a given data set.
Thus, if we compute the P-value p, we reject on level α if p ≤α. It is common to
state the P-value when a hypothesis test is performed. This is desirable since the
reader of a scientiﬁc report can in this way evaluate the strength of evidence against
a hypothesis, rather than just being told that it was rejected on a particular level. The
reason for using signiﬁcance levels is historical; before the days of computers, values
needed to be computed by hand and tabulated for easy access and in the process the
standard signiﬁcance levels emerged. There is nothing scary about 5% as opposed
to 4.7% or 5.2% but in practice, conclusions must be drawn and actions taken, and
using nice round numbers such as 1% or 5% is easier on the ear and mind.
Example 6.26. Consider Example 6.25, where 55 out of 500 examined clips were
defective and we could not reject H0 on the 5% level. Since the estimate is 0.11,
above the limit of 10% defective, there might still be some suspicion that the process
is not correct. To get a measure of how bad it is, compute the P-value.
The observed value of the test statistic was T = 0.75 and since T ∼N(0, 1) and the
test is one-sided and rejects large values of T, the P-value is
p = P(T ≥0.75) = 1 −(0.75) = 0.23
which is not likely small enough to arouse suspicion.
□
6.6.2
Data Snooping
Forahypothesistesttobemeaningful,itisimportantthatthehypothesesbeformulated
before the data are analyzed as the following example illustrates.
Example 6.27. On the Texas Lottery Web site, number frequencies for the various
games are published. When I looked at the number frequencies for “Pick 3” (recall
Example 1.25) during the year 2003, I noticed that the number 7 seemed to be
overrepresented on Wednesdays. Out of 150 numbers drawn on a Wednesday, 22
were 7s. Are 7s overrepresented? Test on the 5% level.
Let p be the probability that 7 is drawn on a Wednesday. If the drawing procedure is
fair, we should have p = 0.1, and we test
H0 : p = 0.1
versus
HA : p > 0.1
We have p = 0.147, and from Section 6.5.2 we get the test statistic
T =
0.147 −0.1
√0.1(1 −0.1)/150 = 1.91

336
STATISTICAL INFERENCE
The critical value is the value c for which (c) = 0.95, which gives c = 1.64. We
reject H0 and conclude that Wednesdays give more 7s.
□
Why are 7s overrepresented? Note that Wednesday is the third day of the week and
since the numbers 3 and 7 are often assumed to have mystical powers, maybe we are
onto something here.
Sorry to get your hopes up, but we are not about to prove numerology to be helpful
in playing the lottery. This is a typical example of data snooping: to ﬁrst look at the
data and then formulate and test the hypothesis. The P-value, that is, the probability
of getting at least twenty-two 7s on a Wednesday, is
P(T ≥1.91) = 0.028
which is certainly quite low. However, the probability of getting at least twenty-two
7s on some day of the week is
1 −(1 −0.028)12 = 0.29
(numbers are drawn twice a day Monday–Saturday). Now, this is not a very small
probability. The probability that some number is overrepresented some day of the
week is even larger. Thus, if we look at the lottery data, it is not at all unlikely that we
ﬁnd some number that is overrepresented on some day of the week, and after we have
found it, we can easily prove the claim in a hypothesis test. If we look speciﬁcally
for 7 and Wednesday, we can go through the last 10 years and have a 25% chance
of ﬁnding at least 1 year with overrepresentation. In this case, I was lucky enough to
ﬁnd it the ﬁrst year I looked at; now what are the odds of that. . . ?
This example may be frivolous but the problem that it illustrates is real. If a
hypothesis is formulated after examination of a data set, then it cannot be tested on
the same data set. Indeed, if you keep generating various hypotheses from the same
data set, eventually you will ﬁnd one that you can reject, or as statisticians put it: “If
you torture data long enough, it will confess.” This is also related to the problem of
multiple hypothesis testing, which we address in Section 6.6.4.
6.6.3
The Power of a Test
When a hypothesis test is performed, the signiﬁcance level is the probability that a true
null hypothesis is rejected. This is not the only error that we can commit, however;
it could also happen that the null hypothesis is false and should have been rejected
but that our test fails to do so. These two types of error are referred to as type I and
type II errors, respectively. By choosing a low signiﬁcance level, we have ensured a
low probability of committing a type I error but what about the other type, to accept
a false null hypothesis?
Let us consider Example 6.22, to test whether a coin is fair on the basis of 100
ﬂips and the relative frequency p. The hypotheses are
H0 : p = 0.5 versus HA : p /= 0.5

FURTHER TOPICS IN HYPOTHESIS TESTING
337
the test statistic is T = ( p −0.5)/0.05, and we reject H0 on the 5% level if |T| ≥
1.96, which is to say that p ≤0.402 or p ≥0.598. If H0 is true, the probability that
we reject it in error is 0.05.
So far so good, but now suppose that H0 is false and HA is true. What is the
probability that we fail to reject H0? This cannot be answered immediately since HA
speciﬁes a whole range of parameter values, not just one value as H0 does. Thus, the
probability of rejecting H0 depends on “how false” it is or, more precisely, which of
the values in the range of HA is the true parameter value. Let us, for example, assume
that the true value of p is 0.6. Then p is approximately normal with mean 0.6 and
variance 0.6(1 −0.6)/100 = 0.0024, and the probability of rejecting H0 is
1 −P(0.402 ≤p ≤0.598) = 1 −


0.598 −0.6
√
0.0024

−
0.402 −0.6
√
0.0024

= 1 −((−0.04) −(−4.04)) = 0.52
If instead the true value is p = 0.7, a similar computation gives the probability to
reject H0 as 0.99, which is higher, since it is easier to reject H0 the farther the
true p is from 0.5. Generally, if the true value is p, the probability of rejecting
H0 is
1 −



0.598 −p
√p(1 −p)/100

−

0.402 −p
√p(1 −p)/100

which we note is a function of p. This function is called the power function, or simply
the power, of the test. If we denote it by g(p), we thus have g(0.5) = 0.05 (that is
how the signiﬁcance level is deﬁned), g(0.6) = 0.52, and g(0.7) = 0.99. Let us state
a general deﬁnition.
Deﬁnition 6.16. Suppose that we test the null hypothesis H0 : θ = θ0. The function
g(θ) = P (reject H0 if the true parameter value is θ)
is called the power function of the test.
Note that g(θ0) = α, the signiﬁcance level. If we have a one-sided alternative, for
example, HA : θ > θ0, we want the power function to increase as quickly as possible
as soon as θ increases above θ0. Below θ0 we want the power function to take on low
values. If we instead have a two-sided alternative, HA : θ /= θ0, we want the power
function to increase on both sides of θ0. See Figure 6.4 for an illustration.
The power function can be used to choose between tests. Suppose that we have
two test procedures that both have signiﬁcance level α. If the power functions g1 and
g2 are such that g1(θ) > g2(θ) for all θ such that HA is true, we say that the ﬁrst test
is more powerful than the second and is preferable since it is more likely to detect
deviations from H0. If we have two test procedures, it is not necessarily the case that

338
STATISTICAL INFERENCE
θ
α
g(θ) 
1 
θ0
θ0
α
1 
θ
g(θ)
FIGURE 6.4
Power functions for test of H0 : θ = θ0. To the left, the alternative is one-sided,
θ > θ0, and to the right, the alternative is two-sided.
one is more powerful than the other since we can have g1(θ) > g2(θ) for some values
of θ and g1(θ) < g2(θ) for others (see Problem 59). In particular, if one test is more
powerful than any other test, it is said to be uniformly most powerful and according
to what we just stated, such a test does not necessarily exist. The power function can
also be used to determine sample sizes (see Problem 60).
6.6.4
Multiple Hypothesis Testing
By carefully chosing the appropriate level of signiﬁcance, we can, as pointed out in
the previous section, control the risk of rejecting a true null hypothesis in a statistical
hypothesis test. This works well when we have one single parameter of interest, but
in many situations we typically have many different parameters and, consequently,
many different hypotheses we want to test.
Let us say that we want to investigate the effect of a new drug on the human body
and therefore administer the drug to a group of randomly selected individuals and
monitor their well-being by measuring blood pressure, heart rate, body temperature,
oxygen uptake, amount of sleep, you name it. For comparison, we measure the same
variables by monitoring a control group of comparable individuals that did not get
the drug or, preferably, a placebo to minimize the well-known placebo effect. The
natural next step is to carry out a series of tests for each measured variable sepa-
rately to investigate whether the drug had any signiﬁcant effect on the body. The
problem is that if we choose signiﬁcance level α for each single test, the overall
risk of rejecting at least one true null hypothesis usually becomes much larger than
we want.
Let us, for example, say that we carry out 20 independent tests on level α = 0.05,
we get the multiple signiﬁcance level
αm = 1 −P(A1 ∩. . . ∩A20) = 1 −
20

i=1
P(Ai) = 1 −(1 −0.05)20 = 0.64

GOODNESS OF FIT
339
where Ai denotes the event of accepting the null hypothesis in test i. Hence, even if
not one single null hypothesis is true, it is quite likely that we will still reject at least
one of them and risk drawing wrong conclusions.
As long as we carry out independent tests, it is easy to choose α so that we get
the right level of αm (Problem 61), but often the tests are dependent as in the drug
example above where we measure different variables but on the same individuals.
However, there is a simple procedure called Bonferroni correction that guarantees
that the multiple signiﬁcance level at least does not exceed a desired value.
Assume that we want to carry out a sequence of n dependent tests, each on the
same signiﬁcance level α, so that the multiple signiﬁcance level αm does not exceed
the value α′. The inequality in Problem 10 in Chapter 1 yields that
αm = 1 −P(A1 ∩. . . ∩An) = P(Ac
1 ∪. . . ∪Ac
n)
≤P(Ac
1) + . . . + P(Ac
n) = nα
Consequently, if we choose α = α′/n, we guarantee that αm ≤α′.
The advantage of this procedure is that it always works no matter what kind of
tests we are performing, but the major disadvantage is that it is quite conservative
especially for large n. Again, let us say that we wish to carry out 20 different test
and that the multiple signiﬁcance level should not exceed 5%. Then we end up with
α = 0.05/20 = 0.0025, which means that it is much more difﬁcult to reject any null
hypothesis, even the false ones.
Luckily,thereisanextensionofthismethodcalledtheBonferroni–Holmcorrection
that remedies this to some extent. First, calculate the p-value for every single test and
order them as p(1) ≤. . . ≤p(n). Then, reject the null hypothesis of the test with the
smallest p-value if p(1) ≤α′/n. If this is true, move on and reject the null hypothesis of
the test with the second smallest p-value if p(2) ≤α′/(n −1). If this is also true, reject
the null hypothesis of the test with the third smallest p-value if p(3) ≤α′/(n −2),
until you get to a test whose null hypothesis cannot be rejected, where you stop and
accept all other null hypotheses.
6.7
GOODNESS OF FIT
In the previous sections, we tested hypotheses that were stated in terms of unknown
parameters. To be able to do this, we had to assume that our observations came
from some speciﬁc distribution, for example, normal or binomial. Sometimes, this
assumption is precisely what we wish to test: whether our data actually do come from
a speciﬁc distribution. In this section, we will look at one method of doing this. Let
us start with an example.
Example 6.28. A transmitter sends 0s and 1s and is supposed to do so such that 1s are
twice as likely as 0s. It has been observed that out of 1500 independently transmitted
bits, 470 were 0s and 1030 were 1s. Does this support the claim that 1s are twice as
likely as 0s?

340
STATISTICAL INFERENCE
We can describe the null hypothesis as a hypothesis about an entire distribution as
H0 : the distribution is
1
3, 2
3

on {0, 1}
against the alternative that H0 is not true. Let us start by arguing intuitively. Suppose
that we have observed X 0s and Y 1s. We should then reject H0 if the observed
frequencies X and Y deviate too much from the expected frequencies of 500 and
1000, respectively. The deviation of X from 500 can be measured by the squared
difference
(X −500)2
but since we would expect this to be quite large even by pure chance because the
number of trials is large, we account for this by also dividing by the expected number,
500.TreatingY inasimilarmannersuggeststhesummarymeasureZ2 ofthedeviation,
deﬁned as
Z2 = (X −500)2
500
+ (Y −1000)2
1000
(we will soon see why we denote it as a square). We should now reject H0 for large
values of Z2 and need to ﬁgure out its distribution. Since Y = 1500 −X, we get
(Y −1000)2 = (1500 −X −1000)2 = (X −500)2
which gives
Z2 = (X −500)2
500
+ (X −500)2
1000
= (X −500)2
1000/3
and since X ∼bin(1500, 1/3), we know that
X
d≈N

500, 1000
3

and hence the quantity Z2 is the square of a random variable that is approximately
N(0, 1). Thus, we reject H0 on level α if Z2 ≥x where (√x) = 1 −α. With α =
0.05, Table A.2 gives x = 1.962 = 3.84. Our observed value of Z2 is
(470 −500)2
500
+ (1030 −1000)2
1000
= 2.70
and since this is less than 3.84, we cannot reject H0. The observed values of
(470, 1030) are close enough to the expected (500, 1000) to ﬁt the suggested
distribution well.
□
Note how the test statistic in this example is the sum of two squared random variables
but how we can rewrite it as the square of one random variable, which is approximately
N(0, 1). This illustrates a general principle and result. Suppose that our observations

GOODNESS OF FIT
341
are such that there are r possible different outcomes (which need not necessarily
be numerical) and that we wish to test for a particular distribution. We calculate
the squared differences between observed and expected frequencies and divide by
the expected frequencies for each of the r outcomes. When we add these together, the
sum can be rewritten as the sum of the squares of r −1 independent N(0, 1) variables.
The general proof is beyond the scope of this text, but we state the result.
Proposition 6.12. Suppose that in an experiment, an observation can fall into any
of the r different categories, with probabilities p1, . . . , pr. If the experiment is
repeated n times and Xk denotes the number of observations that fall into category
k, for k = 1, . . . , r, then
r

k=1
(Xk −npk)2
npk
d≈χ2
r−1
an approximate chi-square distribution with r −1 degrees of freedom.7
Note that the random vector (X1, . . . , Xr) has a multinomial distribution with pa-
rameters (n, p1, . . . , pr), and a more formal statement of the proposition would be an
asymptotic result regarding such a distribution. The random variable in the proposition
is often denoted χ2 and written in the alternative form
χ2 =
r

k=1
(Ok −Ek)2
Ek
(6.2)
where “O” and “E” stand for “observed” and “expected,” respectively. As a rule of
thumb, the approximation is valid whenever Ek ≥5 for all k. As indicated above, our
interest in the proposition is to test the hypothesis of some speciﬁed distribution, and
next we state the test.
Corollary 6.2. To test the null hypothesis
H0 : the distribution is (p1, . . . , pr)
against the alternative that H0 is not true, we use the test statistic χ2 above and
reject H0 on level α if
χ2 ≥x
where Fχ2
r−1(x) = 1 −α.
7The chi-square distribution will be deﬁned and treated in more detail in Chapter 7. For the present
exposition, it sufﬁces to know that critical values can be obtained from Table A.4.

342
STATISTICAL INFERENCE
This is one example of the so-called goodness-of-ﬁt test, where we test whether a
proposed distribution ﬁts the observed data well. The intent is not necessarily to
reject the null hypothesis, but we may also wish to argue that a particular distribution
is reasonable. The test is one-sided since we reject the null hypothesis for large
deviations from what is expected. Sometimes, however, it can be argued that we
should also reject for small values, since these could indicate that the ﬁt is “too good
to be true” and that data may have been manipulated to ﬁt the desired distribution.8
We will not address this in the text, but see the Problems section.
Example 6.29. Recallthatinthelotterygame“Pick3,”thewinningthree-digitnumber
is chosen by picking at random three times from 0, 1, . . . , 9. The following tabulation
shows the observed and expected number frequency for 2070 drawn numbers. Is the
drawing procedure fair? Test on the 5% level.
Number
0
1
2
3
4
5
6
7
8
9
Observed
182
201
211
184
212
199
209
241
214
217
Expected
207
207
207
207
207
207
207
207
207
207
If the drawing procedure is fair, each integer should have probability 1/10, and our
null hypothesis is
H0 : the distribution is
 1
10, . . . , 1
10

and the chi-square statistic
χ2 =
10

k=1
(Ok −Ek)2
Ek
= (182 −207)2
207
+ · · · + (217 −207)2
207
= 12.6
which we compare with the value x, which is such that Fχ2
9(x) = 0.95, giving
x = 19.92, and we cannot reject H0. The P-value is P(χ2 ≥12.6) = 1 −Fχ2
9(12.6)
that can be computed in Matlab as “1-cdf( ’chi2’, 12.6, 9)” and equals 0.18; thus, the
drawing procedure shows no signs of unfairness (but see Problem 63).
□
If the expected frequency in a class is too small, this can be ﬁxed by lumping
classes together. For instance, if we have only 30 observations in the Texas Lottery
example above, the expected frequencies are 3, which is below the number 5 in our
rule of thumb. If we lump the classes together two by two, we get the ﬁve classes
{0, 1}, {2, 3}, . . . , {8, 9}, each with expected frequency 6, so we can go ahead and
8A famous example is Gregor Mendel’s experiments with garden peas, which led him to discover the
fundamental laws of genetics. His data ﬁt his hypotheses so well that foul play seems hard to rule out.
It has been suggested that an overzealous gardener who knew what results Mendel wanted, manipulated
the data.

GOODNESS OF FIT
343
do the goodness-of-ﬁt test on these classes and the resulting chi-square statistic has
4 degrees of freedom. This idea of lumping classes together makes it possible to
do goodness-of-ﬁt tests also for distributions with inﬁnite range. Let us look at an
example.
Example 6.30. A “great earthquake” is deﬁned as one that has magnitude ≥8.0 on the
Richter scale. Suppose that it has been claimed that the number of great earthquakes
worldwide is on average 1.5 per year. The tabulation below gives the numbers of great
earthquakes between 1969 and 2001. Do the data support the claim? Test on the 5%
signiﬁcance level.
Number of earthquakes
0
1
2
3
4
5
. . .
Number of years
15
13
4
1
0
0
. . .
Thus, there were 15 years with no earthquakes, 13 years with one earthquake, and so
on. No year had more than three earthquakes. If we assume that earthquakes occur
according to a Poisson process, the claim is that the number of earthquakes in a given
year is Poi(1.5). Let us thus do a goodness-of-ﬁt test of the null hypothesis
H0 : data come from a Poi(1.5) distribution
against the alternative that H0 is false. Since the range is inﬁnite, we have to lump
classes together, so let us look at the expected frequencies. The probabilities are
pk = e−1.5 1.5k
k! ,
k = 0, 1, . . .
and with n = 33, we get the following expected frequencies
E0 = 7.4,
E1 = 11.0,
E2 = 8.3,
E3 = 4.1,
E4 = 1.6
and there is a rapid decline as we continue. To get expected frequencies that are at
least 5, we create a new class, “≥3.” If X ∼Poi(1.5), this new class has an expected
frequency
nP(X ≥3) = n(1 −P(X ≤2)) = 33(1 −(p0 + p1 + p2)) = 6.3
The four classes with their observed and expected frequencies are
Class
0
1
2
≥3
Observed
15
13
4
1
Expected
7.4
11.0
8.3
6.3
The chi-square statistic is χ2 = 14.9 that we compare with the number x, which is
such that Fχ2
3(x) = 0.95, and a look at Table A.4 reveals that x = 7.82, and hence we

344
STATISTICAL INFERENCE
reject H0 on the 5% level. The P-value is
P(χ2 ≥14.9) = 1 −F3(14.9) = 0.002
and thus the ﬁt to a Poisson distribution with mean 1.5 is poor.
□
In the last example, we rejected the hypothesis that the data came from a Poi(1.5)
distribution. Since the alternative in a goodness-of-ﬁt test is simply “H0 is false,” this
means that it could be the claim of a Poisson distribution that was rejected or only that
it did not have the right mean. Suppose that we want to test whether the data come
from some Poisson distribution but not with a speciﬁed mean.
The idea is to simultaneously estimate the mean λ from the data and test H0 with
the estimated values of the probabilities (which we recall are all functions of λ). We
can think of this as testing the Poisson distribution that ﬁts the data the best, and if
this is rejected, so is any other Poisson distribution. Here is the general result.
Proposition 6.13. Under the assumptions of Proposition 6.12, suppose that the
probabilities depend on an unknown parameter, say, p1(θ), . . . , pr(θ). If θ is the
MLE of θ and the pk(θ) satisfy certain technical conditions, then
r

k=1
(Xk −npk(θ ))2
npk(θ )
d≈χ2
r−2
a chi-square distribution with r −2 degrees of freedom.
The technical conditions are assumptions of differentiability of the pk(θ), which are
always satisﬁed in our examples. A more general result is that if there are j unknown
parameters, we replace them by their MLEs and the resulting distribution is chi-
square with r −1 −j degrees of freedom. Thus, we lose one degree of freedom
for each estimated parameter. In Equation (6.2), the Ek are now estimated expected
frequencies, Ek = npk(θ ), and for the goodness-of-ﬁt test, we should make sure that
all the npk(θ ) ≥5. We should also point out that it is not necessary to use the MLEs;
the result is true for any estimators that satisfy certain asymptotic properties. We will,
however, stick to MLEs.
Example 6.31. In the earthquake example above, test whether the data come from a
Poisson distribution.
The pmf for a Poisson distribution is
pk(λ) = e−λ λk
k!

GOODNESS OF FIT
345
where we need to estimate λ. From Section 6.4 we know that the MLE of λ is λ = ¯X.
We have the observed value
λ = 0 × 15 + 1 × 13 + 2 × 4 + 3 × 1
33
= 0.73
which gives the estimated probabilities
pk( λ ) = e−0.73 0.73k
k!
,
k = 0, 1, 2, . . .
and estimated expected frequencies
Ek = 33 e−0.73 0.73k
k!
,
k = 0, 1, 2, . . .
Again, we need to make sure to deﬁne classes such that the Ek are at least 5 and
computation gives the following classes and numbers.
Class
0
1
≥2
Observed
15
13
5
Expected
15.9
11.6
5.5
This time, the chi-square statistic is
χ2 = 0.27
which we need to compare with x which is such that Fχ2
1(x) = 0.95 since there
are now three classes and one estimated parameter and hence 3 −1 −1 = 1 degree
of freedom. Table A.4 gives x = 3.84, and we cannot reject H0. The P-value is
1 −F1(0.27) = 0.60, which means that we cannot reject on any reasonable level.
The ﬁt to a Poisson distribution is good, so the rejection in Example 6.30 was due to
the fact that the suggested mean was wrong.
This is a good place to remind the reader that accepting a null hypothesis is not
the same as proving it. Even if the ﬁt to a Poisson distribution is good, the true
distribution may still be something else, but the difference is too subtle to detect. All
we can conclude is that it is not unreasonable to assume a Poisson distribution. It
gives a good ﬁt and unless it is rejected, we can keep using it as a working model.
See Problem 66 for more.
□
In the previous example, it is important to note that we do not test the null hypothesis
that the data come from a Poisson distribution with mean 0.73, only that they come
from some Poisson distribution. The estimation of λ is part of the test. If we ﬁrst
estimate λ by 0.73 and then test H0 : Poi(0.73) with Proposition 6.2, we are guilty of
data snooping since we let the data generate our hypothesis. But since we still need
the estimate of λ to do the test, what is the difference? One degree of freedom! The
fact that the estimation is part of the test gives us r −2 degrees of freedom instead

346
STATISTICAL INFERENCE
of r −1, and this makes the null hypothesis a little easier to reject. Thus, the proper
test takes into account the fact that there is variability also in the estimation, whereas
data snooping would make the ﬁt look better than it really is.
The goodness-of-ﬁt test can be used also to test for continuous distribution. All we
have to do is to divide the range into classes, compute the probability of each class,
and go on as before. See Problem 70 for an example.
6.7.1
Goodness-of-Fit Test for Independence
A special case of the goodness-of-ﬁt test from the precious section is to test for
independence between certain characteristics. If we consider two characteristics, A
and B, we can think of these as events that may occur when an object is sampled at
random. There are then four possibilities: A ∩B, A ∩Bc, Ac ∩B, and Ac ∩Bc. Our
null hypothesis is
H0 : A and B are independent
and if we let p = P(A) and q = P(B), H0 speciﬁes the probabilities
Category
A ∩B
A ∩Bc
Ac ∩B
Ac ∩Bc
Probability
pq
p(1 −q)
(1 −p)q
(1 −p)(1 −q)
If p and q are known, we have the situation from the previous section with r = 4
and can do a chi-square test based on observed frequencies in the four categories.
More commonly, however, the probabilities are not known and must be estimated
from the data. According to the comments following Proposition 6.13, the degrees
of freedom will be reduced by one for each estimated parameter. Here, we need to
estimate two parameters, p and q, and get 4 −1 −2 = 1 degree of freedom. Suppose
that we examine n objects and classify them into each of the four categories and that
we get the numbers X11, X12, X21, and X22, respectively. It is practical to display
these types of data in a contingency table:
B
Bc
A
X11
X12
Ac
X21
X22
The estimators of p and q are the relative frequencies
p = X11 + X12
n
and
q = X11 + X21
n

GOODNESS OF FIT
347
and the chi-square statistic
χ2 = (X11 −npq )2
npq
+ (X12 −np (1 −q ))2
np (1 −q )
+(X21 −n(1 −p )q )2
n(1 −p )q
+ (X22 −n(1 −p )(1 −q ))2
n(1 −p )(1 −q ))
which has a χ2
1 distribution.
Example 6.32. Recall the Berkeley admissions data from Example 1.46. Below is a
contingency table of the numbers of male and female applicants in the categories
“easy” and “difﬁcult,” respectively. Is choice of major independent of gender? Test
on the 5% level.
Male
Female
Easy major
1385
133
Difﬁcult major
1306
1702
We have n = 4526, and the observed numbers are X11 = 1385, X12 = 133, X21 =
1306, and X22 = 1702. This gives the estimates
p = 1385 + 133
4526
= 0.34
and
q = 1385 + 1306
4526
= 0.59
and the chi-square statistic
χ2 = (1385 −4526 × 0.34 × 0.59)2
4526 × 0.34 × 0.59
+ (133 −4526 × 0.34 × 0.41)2
4526 × 0.34 × 0.41
+ (1306 −4526 × 0.66 × 0.59)2
4526 × 0.66 × 0.59
+ (1702 −4526 × 0.66 × 0.41)2
4526 × 0.66 × 0.41
= 957.1
which we compare with x, which is such that Fχ2
1(x) = 0.95, giving x = 3.84, and
we can reject independence. Since our observed value is huge, it would be interesting
to compute the P-value. Recall the relation between the chi-square and the normal
distributions to realize that our chi-square statistic is the square of a N(0, 1) variable.
Thus, for any x
P(χ2 ≥x) = 1 −P(−√x ≤χ ≤√x) = 2(1 −(√x))
and by the approximation at the end of Section 2.7, we get
P(χ2 ≥x) ≈2ϕ(√x)/√x

348
STATISTICAL INFERENCE
which, with x = 957.1, equals 3.8 × 10−210! Quite impressive evidence against in-
dependence.
□
The characteristics do not necessarily have to be binary (male/female, easy/difﬁcult,
etc.). Suppose that the ﬁrst characteristic deﬁnes the n1 categories A1, A2, . . . , An1
with corresponding probabilities p1, . . . , pn1 and the second characteristic deﬁnes
the n2 categories B1, B2, . . . , Bn2 with probabilities q1, . . . , qn2. There are then in
all n1n2 categories, and we still wish to test for independence between the two char-
acteristics, and hence our null hypothesis is
H0 : Ai and Bj are independent for all i and j
Supposethatwehaveatotalofnclassiﬁedobjects;lettheobservednumberincategory
(i, j) be Xij, so that the contingency table has n1 rows and n2 columns. Under H0,
the expected number of objects in category (i, j) is npiqj. Assuming that the pi and
qj are unknown, we estimate them by relative frequencies as
pi = 1
n
n2

j=1
Xij
and
qj = 1
n
n1

i=1
Xij
and deﬁne the chi-square statistic
χ2 =
n1

i=1
n2

j=1
(Xij −npiqj)2
npiqj
and need to ﬁgure out how many degrees of freedom it has. In the notation of the
previous section, we have r = n1n2, and we need to estimate the pi and qj. Since
each set of probabilities adds to one, we have to estimate only n1 −1 of the pi and
n2 −1 of the qj. Thus, the resulting chi-square distribution has
n1n2 −1 −(n1 −1) −(n2 −1) = (n1 −1)(n2 −1)
degrees of freedom. We may need to lump classes together to make sure that npiqj
are ≥5 for all i, j and also make sure that this is done in a sensible manner.
Example 6.33. The following contingency table shows the classiﬁcation of 1031
blood donors, according to blood type (A, B, AB, or O) and according to Rh fac-
tor (Rh+ or Rh−). Are blood type and Rh factor independent? Test on level 5%.
A
B
AB
O
Rh+
320
96
40
412
Rh−
66
23
9
65

GOODNESS OF FIT
349
The estimated probabilities are
p1 = 320 + 96 + 40 + 412
1031
= 0.84,
p2 = 1 −p1 = 0.16
q1 = 320 + 66
1031
= 0.37,
q2 = 96 + 23
1031
= 0.12
q3 = 40 + 9
1031 = 0.05,
q4 = 1 −(q1 + q2 + q3) = 0.46
and the chi-square statistic becomes
χ2 = 3.54
We have n1 = 4 and n2 = 2, which gives the number of degrees of freedom as (n1 −
1)(n2 −1) = 3. The critical value is thus the x, which has Fχ2
3(x) = 0.95, giving
x = 7.8, so we cannot reject independence.
□
6.7.2
Fisher’s Exact Test
As long as we have sufﬁcient number observations, the test above is quite reliable, but
what can we do if the rule of thumb npiqj ≥5 cannot be satisﬁed even after lumping
classes together? For 2 × 2 tables, there is an alternative approach called Fisher’s
exact test.
First, let us introduce the convenient notation Xi· = Xi1 + Xi2, where i = 1, 2,
for the row sums and X·j = X1j + X2j, where j = 1, 2, for the column sums in the
contingency table
B
Bc
A
X11
X12
Ac
X21
X22
Next, we condition on the observed row and column sums, that is, the events
{X1· = x1·} and {X·1 = x·1}. Under the null hypothesis that the two classiﬁcations
are independent, we can interpret the variable X11 as the number of objects with
property A we get when randomly selecting x·1 objects from a set of n objects. This
means that X11 follows the hypergeometric distribution introduced in Section 2.5.5
with parameters n, x1·, and x·1 and we get the probability mass function
P(X11 = x11) =
x1·
x11
 n −x1·
x·1 −x11

 n
x·1

=
x1·
x11
x2·
x21

 n
x·1

(6.3)
Note that when X11 = x11 the rest of the table is determined automatically.

350
STATISTICAL INFERENCE
If the null hypothesis is false, we get an unbalanced table with an unusually small
or unusually large value of X11. Hence, X11 can be used as a test statistic in a test
of independence and the hypergeometric distribution can be used to obtain critical
values.
Example 6.34. Crohn’s disease is a serious chronic inﬂammatory disease of the in-
testines that may cause severe symptoms like abdominal pain, diarrhea, vomiting,
and weight loss. It is believed that specialized diets may mitigate symptoms, so 20
hospitalized patients were randomly assigned to two groups of 10 patients each where
one group (control) had a regular diet and the other group (treatment) were given a
diet without some of the food items that were believed to aggravate the disease. After
6 months it was found that 7 of the 10 in the treatment group remained in remission
compared to none in the control group, which was reduced to 8 since two patients
had to undergo surgery. We can summarize the trial in the following table:
Remission
No Remission
Treatment
7
3
Control
0
8
If the two diets do not affect the chance of remission, the number of patients in the
treatment group that would be in remission follows the hypergeometric distribution
with parameters 18, 7, and 10. The probability mass function is given in Figure 6.5.
In order to ﬁnd appropriate critical values, we have to calculate the probabilities
of the most extreme outcomes. Using Equation (6.3) with these parameter values
7
6
5
4
3
2
1
0
0.0
0.1
0.2
0.3
0.4
FIGURE 6.5
The probability mass function of X11 in Example 6.34.

BAYESIAN STATISTICS
351
yields that P(X11 = 0) = 0.0003, P(X11 = 1) = 0.0088, and P(X11 = 7) = 0.0038.
A rejection region consisting of the values 0, 1, and 7 thus gives us a conﬁdence level
of α = 0.013. Including the value with the next smallest probability (6) would add
0.053 to α and produce a signiﬁcance level larger than 5%. In any case, since our
observed value falls into the rejection region, we can reject the hypothesis that diet
and remission are independent and conclude that the specialized diet indeed affects
the chance of remission of patients suffering from Crohn’s disease.
□
6.8
BAYESIAN STATISTICS
The ﬁeld of Bayesian statistics has a starting point that differs from those of the
methods we have encountered so far. It is inspired by Bayes’ formula, which in its
simplest form (Corollary 1.7) says that
P(B|A) = P(A|B)P(B)
P(A)
As an example, consider Example 1.50, where there are n equally suspected potential
murderers. In particular, Mr Bloggs is considered to be guilty with probability
P(G) = 1
n. After he has been screened and found to have the murderer’s genotype,
the probability of his guilt is updated to
P(G | same genotype ) =
1
1 + (n −1)p
Now, either Mr Bloggs is guilty or he is not, and this fact does not change after his
genotype has been found, so the probabilities reﬂect our belief in his guilt before and
after screening. One way to think about this is that Mr Bloggs comes with a “guilt
parameter” that is either 0 for innocent or 1 for guilty. We can describe our initial
degree of belief in his guilt by assigning probabilities to the two outcomes 0 and 1.
As new evidence is gathered, we update these probabilities.
The fundamental idea in Bayesian statistics is similar. By interpreting probability
as a measure of the degree of belief, we can view an unknown parameter as a random
variable instead of an unknown constant. We can then assign it a distribution that de-
scribes how likely we think different parameter values are, and after we have gathered
the data, we update the distribution of the parameter to the conditional distribution
given the data, using some variant of Bayes’ formula. The methods we have previ-
ously developed, where parameters are viewed as ﬁxed but unknown constants, are
often referred to as frequentist statistics.9
9Or “classical statistics,” which is somewhat ironic since these methods were developed mainly in the
twentieth century, whereas early Bayesian methods, as we will soon see, were used by Laplace 100 years
earlier. However, modern Bayesian methods have been proven useful relatively only recently since they
often involve substantial computational problems.

352
STATISTICAL INFERENCE
Example 6.35. A digital communication system transmits 0s and 1s where the
probability that 1 is sent is p, which is either 1
3 or 2
3. The four observed values are
1, 1, 0, 1. In Example 6.13, we viewed p as an unknown parameter to be estimated
from these observations. We will now apply the Bayesian reasoning.
We view p as a random variable with range { 1
3, 2
3}. Thus, p has a distribution and
assuming that before the experiment we have no reason to believe more in any par-
ticular one of the values, it is natural to assume that p is uniform on its range. Thus,
P

p = 1
3

= 1
2
and
P

p = 2
3

= 1
2
We now observe 1, 1, 0, 1 and wish to update our distribution. This means that we
compute the conditional distribution of p given the observations. With D denoting
“data” (i.e., 1, 1, 0, 1), Bayes’ formula gives
P

p = 1
3
D

=
P(D|p = 1/3)P(p = 1/3)
P(D|p = 1/3)P(p = 1/3) + P(D|p = 2/3)P(p = 2/3)
=
(1/3)3(2/3)(1/2)
(1/3)3(2/3)(1/2) + (2/3)3(1/3)(1/2) = 1
5
which also gives P(p = 2
3|D) = 4
5. Thus, the new distribution is ( 1
5, 4
5) on the range
{ 1
3, 2
3}. The data made us believe more in 2
3 than in 1
3, but the latter is not ruled out.
The uniform distribution we started with, before we got any data, is called the prior
distribution (or prior for short) and the conditional distribution after we get the data is
called the posterior distribution. If we were to collect more data, it would make sense
to use the distribution ( 1
5, 4
5) as the new prior and thus take previous measurements
into account.
□
The use of Bayes’ formula is what gives this methodology its name. Generally, if θ
is the parameter and we denote the data by D, we have
P(θ|D) = P(D|θ)P(θ)
P(D)
Here P(θ) is the prior distribution, that is, the probability distribution before the
experiment and P(θ|D) the posterior distribution, that is, the distribution conditioned
on the data. The other probabilities are P(D|θ), the probability of the data if the
parameter value is θ and P(D), the unconditional probability of the data. To compute
P(D), we sum or integrate over θ in the numerator, depending on whether θ is discrete
or continuous.
Note that we use θ to denote both the random variable and its value. Although not
strictly in line with how we usually formulate probability statements, this is convenient
and is also the standard notation.
In Bayesian analysis, the posterior distribution contains all the relevant information
about the parameters. If we want to summarize the information with a single number,

BAYESIAN STATISTICS
353
we may, for example, use the mean in the posterior distribution. Thus, computing the
posterior mean can be regarded as the Bayesian equivalence of point estimation.
Deﬁnition 6.17. Let θ be a parameter and D a set of data. The posterior mean
E[θ|D] is then called a Bayes estimator of θ.
This is not the only way to deﬁne a Bayes estimator but the only one that we will
consider. As before, we refer to this as an estimator if data are described in terms of
random variables and an estimate if data are actual numerical observations on these
random variables.
Note that “estimator of θ” does not have the same meaning in the Bayesian as in
the frequentist setting. In frequentist theory, an estimator is a random variable used to
approximate the unknown constant θ; in Bayesian theory it is the mean of the random
variable θ conditioned on data.
Example 6.36. Reconsider the previous example but suppose that we know nothing
at all about p. Suggest a prior, then ﬁnd the posterior distribution and the Bayes
estimate of p.
If we do not know anything about p, we would tend to let the prior be uniform on
[0, 1], that is, let p have pdf
f(p) = 1,
0 ≤p ≤1
and with the same data as above we get
f(p|D) = P(D|p)f(p)
P(D)
Here p is a continuous random variable and the observations come from a discrete
distribution. Thus, P(D|p) and P(D) are actual probabilities, and we get
P(D|p) = p3(1 −p)
and
P(D) =
 1
0
P(D|p)f(p)dp =
 1
0
p3(1 −p)dp = 1
20
which gives the posterior pdf
f(p|D) = 20p3(1 −p),
0 ≤p ≤1
The mean in this distribution is
E[p] =
 1
0
pf(p|D)dp = 20
 1
0
(p4 −p5)dp = 2
3

354
STATISTICAL INFERENCE
which is the Bayes estimate. Compare this with the frequentist estimate of the
unknown parameter p, which is the observed relative frequency 3
4. The Bayes es-
timate is smaller since it can be thought of as a weighted average of the prior mean,
which is 1
2 and the sample mean 3
4. For more on this, see Problems 77 and 78.
□
Example 6.37 (Laplace’s Rule of Succession). Consider an experiment where an
event occurs with unknown probability p. The experiment is repeated n times, and
the event is observed every time. Assume a uniform prior and ﬁnd the posterior
distribution and Bayes estimate.
With p ∼unif[0, 1], we have f(p) = 1, P(D|p) = pn, and P(D) =
1
n+1, which gives
posterior distribution
f(p|D) = P(D|p)f(p)
P(D)
= (n + 1)pn,
0 ≤p ≤1
The mean in this distribution is
E[p|D] =
 1
0
pf(p|D)dp = (n + 1)
 1
0
pn+1dp = n + 1
n + 2
When Laplace computed this value, he interpreted it as the probability that something
that has always occurred will occur once more; hence the expression “Laplace’s rule
of succession.” The example he chose as an illustration was the event that the sun will
rise again tomorrow, knowing that it has risen every day so far. Probably realizing
that this was not the best chosen example, he quickly added that the probability would
be much higher for “he who, seeing the principle regulating the days and seasons,
realizes that nothing at the present moment can arrest the course of it.” In probability
terms, consecutive observations regarding sunrise are not independent.
□
The uniform prior in this example is reasonable if we have no prior knowledge of p
whatsoever. In practice, it is likely that we know at least something. We might have
previous data from some similar experiment or other information that make some
values of p more likely than others. A useful distribution on [0, 1] is the following.
Deﬁnition 6.18. If X has pdf
f(x) =
1
B(α, β)xα−1(1 −x)β−1, 0 ≤x ≤1
it is said to have a beta distribution with nonnegative parameters α and β.
The function B(α, β) is the beta function, deﬁned as
B(α, β) =
 1
0
xα−1(1 −x)β−1dx

BAYESIAN STATISTICS
355
which for integer values of α and β equals
B(α, β) = (α −1)!(β −1)!
(α + β −1)!
and can otherwise be expressed in terms of the gamma function. Note that α = β
gives a beta distribution that is symmetric around 0.5, and in particular α = β = 1
gives the standard uniform distribution. By computing the usual integrals and using
some additional properties of the beta function, it can be shown that
E[X] =
α
α + β
and
Var[X] =
αβ
(α + β)2(α + β + 1)
Example 6.38. Reconsider Example 6.36, where we have observed 1, 1, 0, 1 and
choose as prior for p a beta distribution with α = β = 10. Find the posterior
distribution and the Bayes estimate of p.
This choice of prior means that we believe that p is centered at, and symmetric
around, 0.5 but that we do not have strong belief in extreme deviations. The posterior
distribution is
f(p|D) = P(D|p)f(p)
P(D)
where, as usual, P(D|p) = p3(1 −p) and
f(p) = p9(1 −p)9
B(10, 10)
which gives
f(p|D) = p3(1 −p) × p9(1 −p)9
P(D)B(10, 10)
=
p12(1 −p)10
P(D)B(10, 10)
We could compute the denominator explicitly but instead note that if it were equal to
B(13, 11), then this would be a beta distribution with α = 13 and β = 11. But then
this must be the case, for otherwise f(p|D) would not be a pdf. Hence, we conclude
that the posterior pdf is
f(p|D) = p12(1 −p)10
B(13, 11)
a beta distribution with α = 13 and β = 11. See Figure 6.6 for a plot of the prior and
posterior distributions. By the formula for the mean, the Bayes estimate is
E[p|D] =
13
11 + 13 ≈0.54
□

356
STATISTICAL INFERENCE
0
0.2
0.4
0.6
0.8
1
FIGURE 6.6
The pdf’s of the prior (solid) and posterior (dashed) of p, as in Example 6.38.
In the previous example, we recognized the principal form of the beta distribution
and therefore we did not have to compute the denominator explicitly. This is typical
for these types of calculations and it is common to write
f(p|D) ∝P(D|p)f(p)
that is, the posterior is proportional to the probability of the data times the prior.
We can also note that P(D|p) is in fact the likelihood function, so the fundamental
equation in Bayesian statistics becomes
Posterior ∝likelihood × prior
Computation of the proportionality constant 1/P(D) is one of the most challenging
problems in Bayesian statistics. In complex models it is impossible, and sophis-
ticated simulation methods, called Markov chain Monte Carlo (MCMC) methods,
have been developed in order to get approximate solutions. For a nice introduction to
such methods in a nonstatistical setting, see H¨aggstr¨om, Finite Markov Chains and
Algorithmic Applications [8].
In the last example, the number of 1s in the sample has a binomial distribution. It
is easy to see that if the prior of p is beta, then the posterior is also beta, regardless
of the sample size or the outcome. We say that the beta distribution is conjugate
to the binomial distribution. To choose a conjugate distribution as prior has several
advantages. As we saw in Example 6.38, a conjugate prior distribution means that
we do not have to calculate the proportionality constant explicitly but can identify
the posterior distribution by examining the functional form of the product of the prior
and the likelihood with respect to the parameter. Another great advantage is that it
simpliﬁes comparisons between priors and posteriors as illustrated in Figure 6.6. Since
the prior distribution is a quantiﬁcation of our knowledge about a parameter before

BAYESIAN STATISTICS
357
observing data, we want to see how this changes when we include the information
given in a sample.
So, when we have chosen a model for the sample, how do we ﬁnd the corresponding
family of conjugate distributions? For most standard distributions, we can use the
following result.
Proposition 6.14. Consider a sample X1, . . . , Xn with pmf p(x|θ) or pdf f(x|θ)
where x = (x1, . . . , xn). If p(x|θ) or f(x|θ) can be written in the form10
c(x)g(θ)neh(θ)t(x)
where c, g, h, and t are arbitrary functions, the conjugate distribution can be ex-
pressed
f(θ) ∝g(θ)aeh(θ)b
where a and b are arbitrary constants.
Proof. Let us consider a prior distribution of the form above. Then the posterior
distribution can be written
f(θ|x) ∝p(x|θ)f(θ) ∝c(x)g(θ)neh(θ)t(x) × g(θ)aeh(θ)b
∝g(θ)n+aeh(θ)(t(x)+b) = g(θ)a′eh(θ)b′
where a′ = n + a and b′ = t(x) + b. The proof of pdf’s is completely analogous. ■
Let us assume that we do not know that the beta distribution is conjugate to the
binomial distribution. The probability mass function of the binomial distribution can
be written
p(x|p) =
n
x

px(1 −p)n−x =
n
x

(1 −p)nex log(p/(1−p))
where we identify c(x) =
n
x

, g(p) = 1 −p, t(x) = x, and h(p) = log(p/(1 −p)).
Hence, the prior pdf can be written as
f(p) ∝(1 −p)aeb log(p/(1−p)) = pb(1 −p)a−b
and by setting a = α + β −2 and b = α −1, we can identify this as the beta distri-
bution. For more, see the Problems section.
10Any class of distributions that can be written in this form is called an exponential family. There are
several statistical advantages in expressing distributions in this form, which we will not develop further
here. It sufﬁces to say that most standard distributions are in fact exponential families.

358
STATISTICAL INFERENCE
In the examples thus far, the data have been discrete and the parameter continuous.
Let us next consider an example where both data and parameter are continuous and
all probability statements must be made in terms of pdf.
Example 6.39. Consider a normal distribution with unknown mean μ and known
variance 1 where the prior distribution of μ is N(0, 1), the standard normal. Suppose
that we have observed the values x1, . . . , xn; ﬁnd the posterior distribution and the
Bayes estimate.
Let x = (x1, . . . , xn) to get the posterior pdf
f(μ|x) = f(x|μ)f(μ)
f(x)
(6.4)
Let us look at the factors one by one. First note that
f(μ) =
1
√
2π
e−μ2/2
Next, the observations are i.i.d. N(μ, 1), and we get
f(x|μ) =
n

k=1
f(xk|μ) =
n

k=1
1
√
2π
e−(xk−μ)2/2
=

1
√
2π
n
exp

−1
2
n

k=1
(xk −μ)2

The numerator in Equation (6.4) becomes
f(x|μ)f(μ) =

1
√
2π
n+1
exp

−1
2
 n

k=1
(xk −μ)2 + μ2

where we will rewrite the exponent of the exponential. First note that
n

k=1
(xk −μ)2 + μ2 =
n

k=1
x2
k −2μ
n

k=1
xk + (n + 1)μ2
= (n + 1)

1
n + 1
n

k=1
x2
k −2μ n
k=1 xk
n + 1
+ μ2

= (n + 1)

μ −
1
n + 1
n

k=1
xk
2
+ R

BAYESIAN STATISTICS
359
where R is what is left over after we complete the square and depends on n and
x1, . . . , xn. Since n
k=1 xk = n¯x, we now get the posterior pdf
f(μ|x) =

1
√
2π
n+1 e−R/2
f(x) exp

−1
2(n + 1)

μ −
n¯x
n + 1
2
= C exp

−1
2(n + 1)

μ −
n¯x
n + 1
2
where C does not depend on μ. Now comes the next part. We know that f(μ|x) is
a pdf as a function of μ (remember that x is ﬁxed). Also, we recognize that with
C = (n + 1)/
√
2π, the last expression is the pdf of a normal distribution with mean
n¯x/(n + 1) and variance 1/(n + 1). Thus, there is no other possible value for C (or
f(μ|x) would not be a pdf), and the posterior distribution is
μ|x ∼N
 n¯x
n + 1,
1
n + 1

The Bayes estimate is thus
E[μ|D] =
n¯x
n + 1
which we can compare with the standard frequentist estimate
μ = ¯x
Note how the Bayes estimate is closer to 0. This reﬂects the inﬂuence from the prior
distribution in which the mean is 0. The posterior mean can in this case be regarded
as a weighted average of the prior mean 0 and the observed sample mean ¯x, with the
weights being 1/(n + 1) and n/(n + 1). Note that a much larger weight is put on the
sample mean and that for large n, E[μ|D] ≈¯x. This suggests that the choice of prior
is less important than what the data support, and this observation reduces some of the
arbitrariness in the choice of prior. See also Problem 84.
□
6.8.1
Noninformative priors
The greatest strength of Bayesian statistics is that it enables us to incorporate prior
knowledge in a statistical analysis in a mathematically stringent way. However, we
also need to address the issue of what to do if we do not know anything whatsoever
beforehand or if we do not want our prior belief to affect our results. In Example 6.36,
we introduced a uniform prior to account for lack of information, but is this really the
best choice?
If we do not know the value of a certain parameter in a given distribution it does
makes sense to spread out the probability mass uniformly over the parameter space
because no particular parameter value will then get a larger density than any other
value. As long as the parameter space is bounded, this works well, but most parameters

360
STATISTICAL INFERENCE
in the standard probability distributions are actually deﬁned on unbounded spaces like
λ in the Poisson distribution and μ and σ2 in the normal distribution. One way of
getting around that is to choose the so-called vague prior, which is some distribution
that gives almost equal weight to all parameter values like the uniform distribution
on a really large interval and a normal distribution with a really large variance. This
solves the practical problem but is still somewhat unsatisfactory from a theoretical
point of view. However, it turns out that we can still use Bayes’ formula if we pretend
that uniform distributions on unbounded spaces do exist.
Since any uniform distribution, by deﬁnition, gives equal weight to all parameter
values and, consequently, should have a constant pdf, we can express a uniform prior
on θ as f(θ) ∝1. If the parameter space is unbounded, the proportionality constant
cannot be positive, but let us disregard that for the moment. The posterior density can
then be written
Posterior ∝likelihood × prior ∝likelihood
and as long as the likelihood has ﬁnite and positive integral with respect to θ, we have
a correct posterior distribution.11
Example 6.40. Let us return to Example 6.39 and see what happens if we choose a
noninformative prior f(μ) ∝1 for μ. Then, we get the posterior
f(μ|x) ∝f(x|μ)f(μ) ∝f(x|μ) =

1
√
2π
n
exp

−1
2
n

k=1
(xk −μ)2

∝exp

−n
2(μ −¯x)2
where the last step follows from the fact that
n

k=1
(xk −μ)2 = n(μ −¯x)2 + C
We recognize the posterior as the normal distribution N(¯x, 1/n), which means that the
Bayes estimate becomes E[μ|D] = ¯x. Using a noninformative prior thus produces a
Bayes estimate identical to the frequentist estimate, which is logical since no prior
belief should affect our results in any direction. Moreover, the posterior variance
coincides with the frequentist variance of the mean ¯X, which implies that the statistical
error is the same in the two approaches.
□
As we have seen, the uniform distribution works in many situations as a rea-
sonable model for the absence of prior information about parameter values, even
11This argument can be put in correct mathematical form by considering a sequence of correct priors fν(θ)
where the probability mass is gradually spread out uniformly on the parameter space as ν →∞, for exam-
ple, the normal distribution N(0, ν). The posterior can then be expressed as f(θ|D) = limν→∞
P(D|θ)fν(θ)
P(D)
.

BAYESIAN STATISTICS
361
for unbounded parameter spaces. But that depends on what parameter we are
interested in.
Let us, for example, say that we have observed a sample of lifelengths that are
assumed to be exponentially distributed. One alternative is to choose a uniform prior
for the parameter λ, but if we are interested in the mean lifelength it would perhaps be
more natural to consider the parameter μ = 1/λ instead. To see that these approaches
are incompatible, assume a uniform prior f(λ) ∝1 and compute the distribution of
μ as
f(μ) = f(λ)

dμ
dλ
 ∝1 · 1
μ2
which is deﬁnitely not uniform.
Consequently, the choice of a noninformative prior should not depend on the choice
of parametrization.
Proposition 6.15 (Jeffrey’s Prior). The prior density
f(θ) ∝

I(θ)
where
I(θ) = −E
	 d2
dθ2 log f(X|θ)

is the Fisher information, is invariant under parameter transformation.
What Proposition 6.15 says is essentially that if we have an alternative parameteri-
zation φ = g(θ), it does not matter if we choose f(θ) ∝√I(θ) or f(φ) ∝√I(φ), we
will still get the same result.
Example 6.41. Let us return to the binomial distribution and see what happens if we
use Jeffrey’s prior for p. We ﬁrst calculate the Fisher information
I(p) = −E
	 d2
dp2 log p(X|p)

= −E
	
−X
p2 −n −X
(1 −p)2

=
n
p(1 −p)
This yields the prior
f(p) ∝

I(p) ∝
1
√p(1 −p) = p−1/2(1 −p)−1/2
which we identify as the beta distribution with parameters α = 1/2 and β = 1/2.
Since we know that the beta distribution is conjugate to the binomial distribution, we
immediately get that the posterior is the beta distribution with parameters α = x + 1/2

362
STATISTICAL INFERENCE
and β = n −x + 1/2. If we, for instance, apply this to Example 6.36, we would get
a Bayes estimate of
E(p|D) = 3 + 1/2
4 + 1
= 7
10
This is closer to the frequentist estimate 3
4 than the Bayes estimate obtained from the
uniform prior ( 2
3) but still not equal.
□
This example clearly illustrates the problematic nature of the concept of noninforma-
tive priors. In a nutshell, introducing a prior distribution always brings some subjective
information into the analysis and the two intuitive choices of uniform or Jeffrey’s prior
to minimize the impact of the prior sometimes coincide and sometimes differ.
6.8.2
Credibility Intervals
When we have obtained an estimate, the next natural step, as in the frequentist case, is
to try to get an idea about the accuracy of this value. Since the posterior distribution is
interpreted as our knowledge about a parameter, as a combination of our prior belief
and the information contained in the observed data, the posterior standard deviation
is the obvious choice of uncertainty measure analogous to the standard error. There
is also a Bayesian analog to conﬁdence interval called credibility interval deﬁned as
[x1, x2], where
P(x1 ≤θ ≤x2|D) = q
Note that it is the parameter and not the interval limits, conditioned on the data D, that
is random in this framework. This makes a credibility interval more intuitive because
now we can interpret q as a (posterior) probability given an observed data set. In the
frequentist setting, a given conﬁdence interval is either right or wrong since θ is ﬁxed.
The conﬁdence level only tells us what proportion of conﬁdence intervals would be
correct if we would repeat our calculations using new independent samples from the
same underlying distribution, which many nonstatisticians ﬁnd confusing.
Example 6.42. Let us again consider the important special case where we want to
estimate the probability p based on a binomial response X and a beta prior. If the
parameters of the prior distribution are denoted α and β, we have seen that the posterior
is also beta with parameters α + x and β + n −x. The posterior standard deviation
is then

Var(p|X) =
1
α + β + n

(α + x)(β + n −x)
α + β + n + 1
and the limits of a symmetric credibility interval can be obtained as the solution to
P(p < x1|X) = P(p > x2|X) = 1 −q
2

NONPARAMETRIC METHODS
363
which has to be calculated numerically. In earlier examples, we have used three
different priors for the communication system example where x = 3 and n = 4. For
the uniform prior, which can be seen as a beta distribution with α = β = 1, we got
the Bayes estimate 2
3. The posterior standard deviation for this case becomes

Var(p|X) = 1
6

4 × 2
7
= 0.178
and a 95% credibility interval turns out to be [0.28, 0.95]. The informative prior with
α = β = 10 yields the Bayes estimate 0.54, the posterior standard deviation

Var(p|X) = 1
24

13 × 11
25
= 0.100
and the credibility interval [0.34, 0.73]. Not surprisingly, we see that an informative
prior yields a smaller posterior standard deviation and, consequently, a narrower
credibility interval.
□
6.9
NONPARAMETRIC METHODS
All the methods we have developed in this chapter have been based on parametric
models: assumptions of speciﬁc distributions and their parameters. In this section,
we will investigate methods used to construct tests that make no assumptions other
than that the distribution is continuous and sometimes also symmetric. Such methods
are said to be nonparametric12 and are widely used when it is not obvious what
distribution to assume.
6.9.1
Nonparametric Hypothesis Testing
Suppose that we are interested in testing a hypothesis about some location parameter
of a data set and do not know anything about its distribution other than that it is
continuous. It is then suitable to use the median m as the location parameter, recalling
from Section 2.9 that this has the property
P(X ≤m) = P(X ≥m) = 1
2
Our null hypothesis is H0 : m = m0 and if H0 is true, we expect to have roughly the
same number of observations above and below m0, and if our sample deviates too
much from this, we reject H0. The test is usually described as assigning a plus sign
to those observations that are above m0 and a minus sign to those that are below (the
12A perhaps more correct term is distribution-free, but the term nonparametric is so well established that
we will use it here.

364
STATISTICAL INFERENCE
assumption of a continuous distribution rules out observations that are exactly equal
to m0, at least in theory). In this formulation, let N+ be the number of plus signs:
N+ = #{k : Xk > m0}
Suppose that the alternative is two-sided, HA : m /= m0. We then reject H0 if N+ is
either too large or too small, and the resulting test is called the sign test. Let us state
the test formally.
Proposition 6.16 (The Sign Test). Suppose that X1, . . . , Xn is a sample from a
continuous distribution with median m and we wish to test
H0 : m = m0
versus HA : m /= m0
We reject H0 if
N+ ≤k
or
N+ ≥n −k
on signiﬁcance level
α =
1
2n−1
k

j=0
n
j

Proof. Under H0, N+ ∼bin(n, 1
2), which means that the random variable n −N+
(the number of minus signs) is also bin(n, 1
2) and hence
P(N+ ≤k) = P(N+ ≥n −k) = 1
2n
k

j=0
n
j

which gives the signiﬁcance level α in the proposition.
■
Since the signiﬁcance level can be expressed in terms of the cdf of the bin(n, 1
2) distri-
bution, it is easy to compute. For large n, we can use the normal approximation to the
binomial, and for one-sided alternatives, the obvious adjustments are made, rejecting
for only one of the inequalities N+ ≤k and N+ ≥n −k and getting signiﬁcance level
α = 1
2n
k

j=0
n
j

Previously, we set the signiﬁcance level in advance, usually at 5%. Since the distri-
bution of N+ is discrete, we are seldom able to achieve those levels exactly but
choose k so that we come as close as possible.
Example 6.43. Laboratory rats run through a maze, and the time until exit is measured.
It is known that they either manage to exit relatively soon or they get lost and it takes
a long time to exit, thus making intermediate times rare. The distribution of times can

NONPARAMETRIC METHODS
365
be assumed to be symmetric. It has been claimed that the mean exit time is more than
100 s. Use the following data to test this on level ≈5%:
26, 31, 43, 163, 171, 181, 193, 199, 206, 210
Since the distribution is symmetric, the mean μ and median m are equal. The hy-
potheses are H0 : μ = 100 versus HA : μ > 100, and we reject H0 if N+ ≥n −k
where n = 10 and k satisﬁes
1
210
k

j=0
10
j

≈0.05
which gives k = 2. Thus, we reject if N+ ≥8, and since the observed value is N+ = 7,
we cannot reject H0.
□
Take a look at the data in the previous example. Since there were only seven observa-
tions above 100, the sign test could not reject H0. However, the observations above
100 tend to deviate more from 100 than those below. Since the distribution is sym-
metric, this might indicate that the mean is more than 100 but the sign test does not
take into account the values themselves, only whether they are greater than 100. We
will introduce a more reﬁned test that also takes into account the magnitudes of the
deviations from the median but requires a symmetric distribution. If the distribution
is symmetric, the mean and median are equal and we state hypotheses in terms of the
mean μ instead. Suppose thus that we wish to test
H0 : μ = μ0
based on the observations X1, . . . , Xn, a sample from a continuous and symmetric
distribution. Consider the absolute deviations from μ0
|X1 −μ0|, . . . , |Xn −μ0|,
and order these by size, from smallest to largest. This gives each Xk a rank Rk, such
that Rk = j if Xk has the jth smallest absolute deviation from μ0. Also for each Xk,
keep track of which side of μ0 it is on by assigning to it an indicator function
Ik =

1 if Xk > μ0
0 otherwise
Thus, for each observation Xk we have a pair (Rk, Ik), a rank, and an indicator for
which side of μ0 it is on. The test statistic we will use is
W =
n

k=1
RkIk
(6.5)
which is simply the sum of the ranks of all the observations that are above μ0. Note
that W ranges from 0 (all observations below μ0) to n(n + 1)/2 (all observations

366
STATISTICAL INFERENCE
above μ0). If H0 is true, it is not too difﬁcult to realize that the distribution of W is
symmetric with mean n(n + 1)/4, and we reject H0 if W deviates too much from its
mean. As usual, we need the distribution of W to be able to quantify “too much.” This
turns out to be a nice exercise in the use of probability generating functions, and you
are asked to do it in Problem 93.
Proposition 6.17. The probability mass function of W, deﬁned above, is
P(W = r) = a(r)
2n ,
r = 0, 1, . . . , n(n + 1)
2
where a(r) is the coefﬁcient of sr in the expansion of n
k=1(1 + sk).
By summing probabilities P(W = r), we can ﬁnd critical values and signiﬁcance
levels. For example, in a one-sided test of H0 : μ = μ0 against HA : μ > μ0, we
reject if W ≥C and get signiﬁcance level
n(n+1)/2

r=C
P(W = r)
which we can choose to be close to the desired α or put in the observed value of W to
get the P-value. Since the distribution of W is symmetric around its mean, the identity
P(W = r) = P

W = n(n + 1)
2
−r

can be used for computations and the signiﬁcance level can instead be computed as
n(n+1)/2−C

r=0
P(W = r)
Corollary 6.3 (Wilcoxon Signed Rank Test).
Suppose that X1, . . . , Xn is a
sample from a continuous and symmetric distribution with mean μ and we wish to
test
H0 : μ = μ0
versus HA : μ /= μ0
With the test statistic W in Equation (6.5), H0 is rejected if
W ≤c
or
W ≥C
where C = n(n + 1)/2 −c. The signiﬁcance level is
2P(W ≤c) = 2
c

r=0
P(W = r)

NONPARAMETRIC METHODS
367
If the alternative is one-sided, we make the obvious adjustments. Thus, if the alterna-
tive is HA : μ < μ0, we reject if W ≤c and for HA : μ > μ0, we reject if W ≥C.
In both cases, the signiﬁcance level is P(W ≤c). The test is called the Wilcoxon
signed rank test. Table A.7 lists critical values that give signiﬁcance levels approx-
imately equal to 0.05 for one-sided and two-sided tests. Note that if we remove
the ranks and only sum the indicators, we get the sign test. The assumption of a
symmetric distribution makes it possible to replace the median by the mean, but
even if we test for the median, it is still important to have a symmetric distribu-
tion. If this is not the case, it is natural to have larger deviations on one side of the
median than the other so that such behavior does not necessarily indicate anything
suspicious.
Example 6.44. For the lab rats in Example 6.43, we wish to test
H0 : μ = 100
versus
HA : μ > 100
on level ≈5%, and from Table A.7 we get c = 11, which gives C = 10 × 11/2 −
11 = 44, so we reject H0 in favor of HA if W ≥44. The observed values are
26, 31, 43, 163, 171, 181, 193, 199, 206, 210
The absolute differences |Xk −100| are
74, 69, 57, 63, 71, 81, 93, 99, 106, 110
and if we order these by size we get
57, 63, 69, 71, 74, 81, 93, 99, 106, 110
where the underlined numbers belong to positive deviations. The ranks of the under-
lined values are
2, 4, 6, 7, 8, 9, 10
and if we sum these, the value of our test statistic becomes W = 46 and we can reject
the null hypothesis, something the sign test failed to do.
□
Note how the test statistic W is based on the ranks of the deviations from μ, not the
values of the deviations themselves. Thus, in the last example, if the largest three
values were instead 299, 306, and 310, the value of W remains the same, so although
this would be even stronger reason to reject, W does not take this into account. For
large sample sizes, we can use the following normal approximation for W. The proof
is left for Problem 94.

368
STATISTICAL INFERENCE
Proposition 6.18. If H0 is true, the mean and variance of W are
E[W] = n(n + 1)
4
Var[W] = n(n + 1)(2n + 1)
24
and for large values of n
T =
W −n(n + 1)/4
√n(n + 1)(2n + 1)/24
d≈N(0, 1)
Example 6.45. The density of Earth is usually reported to be 5.52 g/cm3. In a famous
experiment in 1798, Henry Cavendish used a clever apparatus to measure the density.
Cavendish’s 29 observations were
4.07, 4.88, 5.10, 5.26, 5.27, 5.29, 5.29, 5.30, 5.34, 5.34, 5.36, 5.39
5.42, 5.44, 5.46, 5.47, 5.50, 5.53, 5.55, 5.57, 5.58, 5.61, 5.62, 5.63
5.65, 5.75, 5.79, 5.85, 5.86
which have sample mean 5.42. Let μ be the true mean of Cavendish’s data and test
H0 : μ = 5.52
versus
HA : μ /= 5.52
on the 5% level.
We will use the statistic T and the normal approximation from above. With α =
0.05, we thus reject if |T| ≥1.96, and we have n = 29. The absolute deviations
|Xk −5.52|, k = 1, . . . , 29, ordered by size, with positive deviations underlined are
0.01, 0.02, 0.03, 0.05, 0.05, 0.06, 0.06, 0.08, 0.09, 0.10, 0.10, 0.11
0.13, 0.13, 0.16, 0.18, 0.18, 0.22, 0.23, 0.23, 0.23, 0.25, 0.26, 0.27
0.33, 0.34, 0.42, 0.64, 1.45
This is a good place to comment on the problem of ties. Note, for example, how
there are two occurrences of 0.05, coming from the two measurements 5.47 and
5.57. Under our assumption of a continuous distribution, this is impossible but in real
life we are limited by the accuracy of our measurements. When we put the values
together, the value of the test statistic will depend on which we decide to under-
line, which is an arbitrary decision. Since the two 0.05s should really have the same
rank, we assign them both the mean rank (4 + 5)/2 = 4.5 and proceed as before.
If there are not too many ties, this is no big deal, but in general this is a problem
that cannot be ignored. The test statistic and its distribution must then be adjusted to
account for ties, but we will not address this issue further. Using mean ranks we

NONPARAMETRIC METHODS
369
get
W = 1 + 3 + 4.5 + 6.5 + 9 + 10.5 + 12 + 13.5 + 20 + 24 + 25 + 26 = 155,
which gives the test statistic
T =
155 −29 × 30/4
√29 × 30 × (2 × 29 + 1)/24 = −1.35
and with |T| = 1.35 we cannot reject H0.
□
If we compare the two nonparametric tests we have seen so far, we can note that the
sign test is a very crude test and it is therefore often unable to detect deviations from
the null hypothesis, especially for small samples (see Problem 90). If it is reasonable
to assume a symmetric distribution, the signed rank test is preferable as it takes more
information into account and is thus better able to detect deviations from the null
hypothesis. In the terminology of Section 6.6.3, the signed rank test is more powerful
than the sign test.
If we want to test the stronger statement that the sample comes from a particu-
lar continuous distribution, we can use the so-called Kolmogorov–Smirnov test. Let
us assume that we have a random sample X1, . . . , Xn with continuous distribution
function F(x) and we want to test the hypotheses
H0 : F(x) = F0(x) for all x
HA : F(x) /= F0(x) for some x
for a given F0(x).
As an estimator of F(x), we use the empirical distribution function
Fn(x) = 1
n
n

i=1
I{Xi≤x}
where IA denotes the indicator of the event A, and the maximum distance
Dn = max
x
|Fn(x) −F0(x)|
as test statistic.
Since Fn(x) and F0(x) are nondecreasing and Fn(x) is a step function that only
jumps at the points X1, . . . , Xn, the test statistic can be somewhat simpliﬁed as
Dn = max
1≤i≤n

max

i −1
n
−F0(X(i))
 ,

i
n −F0(X(i))

 
(6.6)
where X(1) ≤. . . ≤X(n) are the order statistics. Since F0(Xi) ∼unif[0, 1] under H0,
we can actually rewrite (6.6) as
Dn = max
1≤i≤n

max

i −1
n
−U(i)
 ,

i
n −U(i)

 
where U(1) ≤. . . ≤U(n) are the order statistics from a sample from the uniform dis-
tribution on [0, 1]. This implies that the null distribution of Dn is actually independent

370
STATISTICAL INFERENCE
of F0(x) and we can use the properties of the uniform distribution to derive this dis-
tribution. However, although it is possible to obtain analytical expressions for the
density and distribution function for Dn for different values of n, they are much too
complex to be of any practical use, especially for large n. Instead, critical values for
signiﬁcance levels 0.01 and 0.05 can be found in Table A.9 for n ≤30. For large n,
it is possible to use the limiting distribution
P(√nDn ≤x) →1 −2
∞

k=1
(−1)k−1e−2(kx)2
(6.7)
as n →∞, to calculate approximate critical values or, somewhat easier, p-values.
For instance, the condition for rejection on the 5% level becomes Dn > 1.358/√n
and on the 1% level it becomes Dn > 1.628/√n.
Example 6.46. In 2009, a comparative study used different scales to test IQ scores
of a group of 12 randomly selected pupils. The results for one scale were
78, 93, 95, 96, 99, 100, 104, 105, 110, 113, 124, 127
A correct IQ scale should, by deﬁnition, give a normally distributed score with mean
100 and standard deviation 15. Does the data above support this claim?
The empirical distribution function F12(x) for the data and distribution function F0(x)
for the normal distribution with mean 100 and standard deviation 15 are shown in
Figure 6.7 together with the test statistic D12.
It turns out that the maximum difference is attained at x = 93, which yields
D12 = |F12(93) −F0(93)| = 
93 −100
15

−1
12 = 0.237
From Table A.9 we get the critical value 0.375 on the 5% level, which means that
we cannot reject the null hypothesis. If we use the limiting distribution above, we
get the approximate critical value 1.358/
√
12 = 0.392, which is quite close to the
exact value.
□
6.9.2
Comparing Two Samples
There are two different situations for comparisons of two samples: pairwise observa-
tions and independent samples. If we have paired observations (X1, Y1), . . . , (Xn, Yn)
and wish to test H0 : μ1 = μ2, we can base this on the differences Dk = Yk −Xk
and the nice thing is that as long as the Xk and Yk have the same distribution, Dk
has a symmetric distribution even if Xk and Yk do not (see Problem 42 in Chapter
3). Thus, in this case, we can use the signed rank test to test whether the differences
have mean 0.
The other two-sample situation occurs when we compare the means of two in-
dependent samples. We assume that we have two continuous distributions that have

NONPARAMETRIC METHODS
371
70
80
90
100
110
120
130
140
0.0
0.2
0.4
0.6
0.8
1.0
D12
FIGURE 6.7
The empirical distribution function (solid line) for the data in Example 6.46 and
the distribution function (broken line) of the normal distribution with mean 100 and standard
deviation 15. The Kolmogorov–Smirnov test statistic D12 is also shown.
the same spread and shape and that the only possible difference is the mean (this is
called a translation model). The distributions do not have to be symmetric. Now let
X1, . . . , Xm and Y1, . . . , Yn be the samples, where m ≤n. The fundamental idea is
to put X and Y values together in a big sample, sort this combined sample by size,
and consider the positions of the X values (the smaller sample). If H0 : μ1 = μ2
is true, the X values should be uniformly spread within the combined sample, so
if they tend to concentrate too much on either left or right, this indicates that H0
is false.
Let W be the sum of the ranks of X1, . . . , Xm in the combined sample. Then W
ranges from 1 + 2 + · · · + m = m(m + 1)/2 (all X values smaller than all Y values)
to (n + 1) + (n + 2) + · · · + (n + m) = m(m + 2n + 1)/2 (all X values larger than
all Y values) and if H0 is true, the distribution of W is symmetric around its mean
m(m + n + 1)/2. Let us state the test based on W.
Proposition 6.19 (Wilcoxon Rank Sum Test).
In the translation model above,
we wish to test
H0 : μ1 = μ2
versus HA : μ1 /= μ2
and reject H0 if
W ≤c or W ≥C

372
STATISTICAL INFERENCE
where C = m(m + n + 1) −c. The signiﬁcance level is
2P(W ≤c) = 2
c

r=m(m+1)/2
P(W = r)
The usual adjustments are done for one-sided tests. The probabilities P(W = r) are
more complicated to compute than in the signed rank test, and we will consider an
example in Problem 98. Table A.8 can be used to ﬁnd critical values for signiﬁcance
levels approximately equal to 0.05 for one-sided and two-sided tests.
Example 6.47. When oil companies drill in the North Sea, they charter drilling rigs.
After bidding and negotiating, a deal is struck with a contractor and a daily rate is
set. The following data are daily rates ($1000, rounded to integer values) for two
different regions, Denmark and the Netherlands, from the year 2002. (The data were
kindly provided by Dr. Patrick King of ODS-Petrodata, Inc., Houston, Texas.) Test
on level ≈5% whether there is a difference in rates between the two regions.
Netherlands: 58, 62, 63, 68, 69, 70, 77
Denmark:
50, 52, 52, 60, 60, 63, 64, 70, 82
With μD and μN as the two means, our hypotheses are
H0 : μD = μN
versus
HA : μD /= μN
We have m = 7 and n = 9, and Table A.8 gives c = 41, which gives C = 7(7 + 9 +
1) −41 = 78 (remember that the test is two-sided so the signiﬁcance level equals
2P(W ≤c)). We thus reject H0 in favor of HA if W ≤41 or W ≥78. The data put
together and ordered by size, with the Netherlands values underlined, are
50, 52, 52, 58, 60, 60, 62, 63, 63, 64, 68, 69, 70, 70, 77, 82
Since there are some ties, we use mean ranks and get the sum of the Netherlands ranks
W = 4 + 7 + 8.5 + 11 + 12 + 13.5 + 15 = 71
and we cannot reject H0.
□
Example 6.48. The drilling rigs in the previous example are of two different types:
“jackup” and “semisubmersible.” It is assumed that the semisubmersible rigs are
more expensive to charter. Do the following data support this hypothesis?
Semisubmersible: 72, 89, 90, 94, 100, 104, 127, 155
Jackup:
50, 58, 60, 64, 68, 70, 77, 83, 103, 125

NONPARAMETRIC METHODS
373
The hypotheses are, in obvious notation,
H0 : μS = μJ
versus
HA : μS > μJ
We have m = 8 and n = 10, and Table A.8 gives c = 57, which gives C = 8(8 +
10 + 1) −57 = 95, so we reject H0 in favor of HA if W ≥95. The data put together
with values for semisubmersible rigs underlined are
50, 58, 60, 64, 68, 70, 72, 77, 83, 89, 90, 94, 100, 103, 104, 125, 127, 155
which gives the rank sum
W = 7 + 10 + 11 + 12 + 13 + 15 + 17 + 18 = 103
and we reject H0 on the 5% level and conclude that the semisubmersible rigs are
indeed more expensive.
□
For large values of m and n, there is a normal approximation, which is slightly more
complicated than the one for the signed rank test. Since W is a sum of ranks, the mean
E[W] is straightforward, but since the ranks are not independent, the variance requires
a bit more work, using the general formula for the variance of a sum. As for the normal
approximation, our central limit theorem does not apply since the summands are not
independent, but more general versions of the theorem can be applied. We will not
address this further but just state the result. For an application, see Problem 102.
Proposition 6.20. If H0 is true, then
T = W −m(m + n + 1)/2
√mn(m + n + 1)/12
d≈N(0, 1)
When comparing samples from two continuous distributions, we can also apply the
ideas behind the Kolmogorov–Smirnov test introduced in Section 6.9.1. Let us denote
the distribution function for sample X1, . . . , Xm by FX(x) and the distribution func-
tion for sample Y1, . . . , Yn by FY(x). The relevant hypotheses can now be expressed
H0 : FX(x) = FY(x)
for all x
HA : FX(x) /= FY(x)
for some x
and we use the test statistic
Dm,n = max
x
|FX
m(x) −FY
n (x)|
where FX
m(x) and FY
n (x) are the empirical distribution functions for the samples. Since
all empirical distribution functions are nondecreasing step functions, we realize that

374
STATISTICAL INFERENCE
the maximum distance is attained at one of the points in the combined sample.
Dm,n = max

max
1≤i≤m |FX
m(Xi) −FY
n (Xi)|, max
1≤j≤n |FX
m(Yj) −FY
n (Yj)|

Furthermore, it turns out that it sufﬁces to know the relative order, that is, the ranks,
of the variables in the combined sample to be able to determine the value of Dm,n.
Unfortunately, the actual calculations are somewhat more involved, especially for
large samples, compared to the Wilcoxon rank sum test and are best left to a computer.
Under the null hypothesis, we can again use the conclusion from above that the ranks
are uniformly spread out on the combined sample to calculate the distribution of Dm,n
and, consequently, critical values, which are given in Table A.10. For large samples,
the limiting distribution
P
 mn
m + nDm,n ≤x

→
∞

i=−∞
(−1)ie−2(ix)2
can be used to obtain critical values or p-values. The condition for rejecting on the
5% level can be expressed
Dm,n > 1.358

m + n
mn
Example 6.49. Let us apply this test to Examples 6.47 and 6.48 and see if we get
similar results. We ﬁrst consider the daily rates of the Netherlands versus Denmark
and calculate the test statistic D7,9. This is easiest done in tabular form, which is
displayed in Table 6.2.
TABLE 6.2
The Maximal Absolute Distance Between Daily
Rates in the Netherlands and Denmark (Denoted in Boldface)
F X
7 (x)
F Y
9 (x)
|F X
7 (x) −F Y
9 (x)|
x < 50
0
0
0
50 ≤x < 52
0
1/9
1/9
52 ≤x < 58
0
3/9
1/3
58 ≤x < 60
1/7
3/9
4/21
60 ≤x < 62
1/7
5/9
26/63
62 ≤x < 63
2/7
5/9
17/63
63 ≤x < 64
3/7
6/9
5/21
64 ≤x < 68
3/7
7/9
22/63
68 ≤x < 69
4/7
7/9
13/63
69 ≤x < 70
5/7
7/9
4/63
70 ≤x < 77
6/7
8/9
2/63
77 ≤x < 82
1
8/9
1/9
x ≥82
1
1
0

NONPARAMETRIC METHODS
375
We see that the maximal distance is D7,9 = 26/63 = 0.413, which is smaller than
the critical value c = 0.667 from Table A.10 so we cannot reject the null hypothesis
using the Kolmogorov–Smirnov test either.
Again, caution is advised in the presence of ties, especially when the two empirical
distribution functions compared jump simultaneously. Consider, for instance, what
happens in the point x = 63. If daily rates had been measured more accurately, it is
quite possible that ˆFY
9 (x) would assume the value 6/9 before ˆFX
7 (x) jumps to 3/7.
In that case the absolute difference would have been |2/7 −6/9| = 8/21 before it
would decrease to 5/21. In this particular example, it does not matter since the maximal
absolute difference is 26/63 anyway, but in general there is a risk of underestimating
Dm,n in the presence of ties.
In Example 6.48, there are no ties, so we can be conﬁdent that the result is correct.
Without going into details, it turns out that the test statistic becomes D8,10 = 27/40 =
0.675 and since the critical value from Table A.10 is c = 0.6, we can reject H0 on
the 5% level.
□
6.9.3
Nonparametric Conﬁdence Intervals
It is not obvious how to construct conﬁdence intervals in the absence of a distribution
assumption or even for what parameter. To approach this problem, Proposition 6.9
turns out to be quite useful. It claims that if we can formulate a hypothesis test for a
speciﬁc problem, we can always translate that into a conﬁdence interval for a required
conﬁdence level.
Let us ﬁrst consider the sign test, introduced in the previous section, where we
only make the assumption that a given sample comes from a continuous distribution.
Proposition 6.9 basically says that we can obtain a conﬁdence interval by including
all parameter values that cannot be rejected in the corresponding hypothesis test. Let
us therefore assume that we have chosen a particular k so that we reject the null
hypothesis m = m0 if and only if N+ ≤k or N+ ≥n −k, where N+ is the number
of positive differences Xi −m0. This naturally implies that we accept the parameter
value m0 if and only if k < N+ < n −k. The condition that N+ has to be larger than k
means that at least k + 1 sample points has to be larger than m0 or that m0 < X(n−k),
where X(1) ≤. . . ≤X(n) are the order statistics. By symmetry, we conclude that the
lower limit can be written m0 > X(k+1).
To summarize, we can express a two-sided conﬁdence interval for the median
m as
X(k+1) ≤m ≤X(n−k)
(q)
where
q = 1 −
1
2n−1
k

j=0
n
j

(6.8)

376
STATISTICAL INFERENCE
Note that we switched from strict to weak inequalities, which does not make a dif-
ference in this case since we have assumed a continuous distribution. As for the sign
test, we cannot hope to get exactly the conﬁdence level we want, say 5%, but have
to ﬁnd the value of k that brings us as close as possible. If a one-sided conﬁdence
interval is required, the lower or upper limit can be dropped and the conﬁdence level
adjusted accordingly.
Example 6.50. Consider once more the lab rat data of Example 6.43 and assume that
we want a 95% conﬁdence interval of the median time until exit. The test procedure
in Example 6.43 can be translated directly into the one-sided conﬁdence interval
m ≥X(3) = 43
(≈0.95)
Since the aim of the test was to establish that the median time was larger than 100 s,
it is natural to calculate only a lower bound. If we want a two-sided interval on the
same level, we have to choose k so that (6.8) becomes approximately 95%. In this
example, it is difﬁcult to achieve this, but the value k = 1 gives us q ≈0.98, which
is as close as we can get. Now, our interval becomes
31 ≤m ≤206
(≈0.95)
□
If we can assume that the sample distribution is symmetric, we can use the
Wilcoxon Signed Rank Test to obtain a, hopefully, more precise conﬁdence interval.
However, it is less straightforward to transform critical values of ranks, which this
test is based on, into interval limits.
First, we have to calculate pairwise averages
¯Xij = Xi + Xj
2
1 ≤i ≤j ≤n
based on the sample. Note that we include averages where i = j so that ¯Xii = Xi.
Then we order them as ¯X(1) ≤¯X(2) ≤. . . ≤¯X(n(n+1)/2). In the previous section, the
test statistic W was deﬁned as the sum of the ranks of the positive differences Xi −μ0.
By symmetry, under the assumption that μ = μ0, we can instead consider the sum
of the ranks of the negative differences, which somewhat simpliﬁes the following
argument.
Let us now begin by considering a parameter value μ0 so that μ0 < ¯X(1). This
means that all differences are positive and that W = 0. By increasing μ0 so that
¯X(1) < μ0 < ¯X(2), we obtain one negative difference whose absolute value is smaller
than any other so that W = 1.
The value ¯X(2) has to be the average of the two smallest values in the original
sample (why?), so when μ0 is increased one more step, that is, ¯X(2) < μ0 < ¯X(3),
the difference |X(1) −μ0| becomes larger than |X(2) −μ0| and gets the rank 2 so that
W = 2.

NONPARAMETRIC METHODS
377
In the next step when ¯X(3) < μ0 < ¯X(4), there are two possibilities. Either ¯X(3) is
an average of two distinct values, which means that the difference |X(1) −μ0| gets
rank 3, or it is equal to ¯X(2), which means that we get one more negative difference
with rank 1. In either case, we get W = 3. By following the same kind of argument
we can show that W = k if and only if ¯X(k) < μ0 < ¯X(k+1), where ¯X(0) = −∞and
¯X(n(n+1)/2+1) = ∞.
Since the Wilcoxon Signed Rank Test rejects the parameter value μ0 if W ≤c
or W ≥n(n + 1)/2 −c, where c is the critical value, we can express the conﬁdence
interval
¯X(c+1) ≤μ ≤¯X(n(n+1)/2−c)
(q)
where
q = 1 −2
c

r=0
P(W = r)
Example 6.51. Let us look at the data in Example 6.43 one last time. When we have
a small sample, the pairwise averages can be listed in tabular form (Table 6.3).
If we want a two-sided interval, we get the critical value c = 9 from Table A.8,
which yields
¯X(10) ≤μ ≤¯X(46)
(≈0.95)
or
101 ≤μ ≤195.5
(≈0.95)
It is clear that we get a narrower interval than in Example 6.50. The upper limit
becomes slightly smaller but the lower limit is increased quite substantially. Actually,
this is a bit misleading in this particular example since the major improvement is due
more to the large gap in the data than to the methods used. However, it is possible to
show that the interval based on the Wilcoxon Sign Rank test is always smaller than
TABLE 6.3
All Pairwise Averages
26
31
43
163
171
181
193
199
206
210
26
26
31
28.5
31
43
34.5
37
43
163
94.5
97
103
163
171
98.5
101
107
167
171
181
103.5
106
112
172
176
181
193
109.5
112
118
178
182
187
193
199
112.5
115
121
181
185
190
196
199
206
116
118.5
124.5
184.5
188.5
193.5
199.5
202.5
206
210
118
120.5
126.5
186.5
190.5
195.5
201.5
204.5
208
210

378
STATISTICAL INFERENCE
the interval based on the Sign Test, but the degree of improvement depends on the
particular data set.
□
PROBLEMS
Section 6.2. Point Estimators
1. Let X1, . . . , Xn be a sample with mean μ and variance σ2 and consider the
linear estimator
L =
n

k=1
akXk
where the ak are nonnegative and sum to 1. (a) Show that L is unbiased.
(b) Show that L is consistent. (c) Show that ¯X has the smallest variance among
all linear estimators (compare with Problem 56 in Chapter 1).
2. Let X1, . . . , Xn and Y1, . . . , Ym be two independent samples with means μ1
and μ2 and variances σ2
1 and σ2
2. Suggest an unbiased estimator of the difference
μ2 −μ1 and ﬁnd its standard error.
3. Let p be the unknown probability of an event A. Repeat the experiment n
times and let X be the number of times that A occurred. Show that the relative
frequency p = X/n is an unbiased and consistent estimator of p and ﬁnd its
standard error.
4. Suppose that we want to estimate the proportion p of men with some charac-
teristic that is considered embarrassing and not readily admitted. To deal with
this, each questioned individual is given a fair coin and is asked if he has the
characteristic. He is then instructed to ﬂip the coin out of sight of the inves-
tigator. If it shows heads, he must answer truthfully, and if it shows tails he
must answer “Yes.” Suppose that we get X out of n “Yes” answers. Suggest an
unbiased estimator of p and compute its standard error.
5. Capture/recapture. To estimate the size N of a ﬁsh population in a lake, k ﬁsh
are caught, tagged, and released. Suggest estimators of N and investigate for
unbiasedness if you at a later time (a) catch n ﬁsh and get X tagged, (b) catch
ﬁsh repeatedly with replacement and get the ﬁrst tagged ﬁsh in catch number
X. (c) What assumptions are you making?
6. To estimate the size S of an underground well, one gallon of a dye is poured
into the well and is allowed to mix. Later, a water sample of one gallon is taken
and the dye is found to have concentration C. Suggest an estimator of S and
investigate for unbiasedness. What assumptions are you making?
7. Consider a Poisson process with rate λ. Suppose that X points are observed
in an interval of length t. Suggest an unbiased estimator of λ and compute its
standard error.

PROBLEMS
379
8. Calculate the Cram´er–Rao lower bound for λ in the previous problem and show
that e(λ) = 1.
9. How do ¯X and s2 change if a constant a is added to all observations in the
sample?
10. Show that s2 is a consistent estimator of σ2 if E[X4
i ] < ∞.
11. Show that the sample standard deviation s is a biased estimator of σ. Hint: Since
s is random, Var[s] > 0. Now apply the variance formula from Corollary 2.2.
12. Consider the following sample of size 8 from an unknown distribution. Use the
inequalities from Problem 47, Chapter 2, to get two estimated upper bounds
on the probability P(X ≥5):
1.2, 1.5, 2.2, 3.1, 3.4, 3.7, 4.0, 4.4
13. On the basis of the following data, estimate the coefﬁcient of variation c (see
Problem 46 in Chapter 2). Is it likely that the data are from an exponential
distribution?
9.4, 9.6, 9.8, 10.0, 11.0, 11.2, 11.4, 11.6, 12.9
14. The following is a sample from a normal distribution.
7.6, 9.6, 10.4, 10.7, 11.9, 14.1, 14.6. 18.5
(a) Let X have this normal distribution, and let p = P(X ≥20). If we estimate
p by the relative frequency, we just get 0. Suggest another estimate. (b) Let x
be the 95th percentile, that is, a value such that P(X ≤x) = 0.95. Suggest an
estimate of x.
15. In a sample of size 100 from a normal distribution, it was observed that 23
values were below 80 and 19 above 120. Use this to ﬁnd estimates of μ and σ.
16. Letθ be an estimator of θ. The bias ofθ is deﬁned as B = E[θ] −θ. If B = 0,θ is
unbiased, and if B →0 as n →∞, θ is said to be asymptotically unbiased. (a)
Considertheestimatorofσ2 thatisgiveninExample6.18.Finditsbiasandshow
that it is asymptotically unbiased. (b) Consider the estimator X(n), the maximum
observation, of θ in a unif[0, θ] distribution. Find its bias and show that it is
asymptotically unbiased. (c) Consider a binomial distribution with known n
and unknown p, where X is observed. Let p = X/n and p = (X + 1)/(n + 1).
Find their respective biases and investigate for asymptotic unbiasedness.
Section 6.3. Conﬁdence Intervals
17. Below are two sets of IQ scores from two different universities, A and B. Find
a 95% symmetric conﬁdence interval for the difference between the means if
σ = 15.

380
STATISTICAL INFERENCE
A: 106, 114, 116, 123, 124, 133
B: 99, 113, 114, 121, 126
18. A scale is known to give measurement errors that are normal with mean 0 and
variance 1. A piece of metal is weighed ﬁve times, and the following weights
in grams are observed:
999.4, 999.8, 1000.4, 1000.8, 1001.0
Find an observed symmetric conﬁdence interval for the true weight μ with
conﬁdence level 0.95.
19. Headlines like this from 1999 are typical: “Majority favors U.S. troops in
Kosovo.” This was based on an opinion poll, where 547 out of 1014 said they
favored troops in Kosovo. Find a 95% symmetric conﬁdence interval for the
true proportion that favors troops. Does this support the headline?
20. Here is another headline from Sweden in 1994: “Majority of Swedes support
joining the European Union.” This was based on a poll of 1000 people, where
505 were in favor. In order to consider it signiﬁcant that a majority wanted
to join, what conﬁdence level would be needed for a symmetric conﬁdence
interval?
21. Consider the conﬁdence interval for an unknown probability p. Suppose that
we want conﬁdence level 0.95 and that we want the length of the interval to be
at most 0.1 (margin of error at most ±0.05). How should we choose n if (a) we
know that p is at most 0.2, (b) we do not know anything about p? (c) In the
light of (b), argue why it is reasonable to state the margin of error in an opinion
poll as ±1/√n.
22. To answer the age-old question “Coke or Pepsi?” there are several opinion
polls on the Web where people are encouraged to vote. In one such poll 145
out of 275 people preferred Coke. Should the Coca-Cola company use this
in their commercials to claim that Coke is more popular? From a method-
ological point of view, what problems are there with online opinion polls of
this kind?
23. A September 2004 opinion poll showed support for President Bush in Florida
at 52%, compared to 47% in another poll earlier in the month. If the margin
of error in the last poll is ±3%, can it be argued that the change is signiﬁcant
since the conﬁdence interval from the second poll is [49, 55], which is entirely
above 47?
24. Consider the opinion poll in Example 6.8 where Bush had 47% and Gore 44%.
Is the difference statistically signiﬁcant? Let the size of the sample be n, and
let B and G be the numbers of supporters of Bush and Gore, respectively,
and let pB and pG be the true proportions. We need a conﬁdence interval
for pB −pG, based on the estimators pB and pG, which are not independent.
(a) Show that Cov[pB, pG] = −pBpG/n (recall Problem 124 in Chapter 3).

PROBLEMS
381
(b) State the approximate normal distribution of pB −pG and use this to ﬁnd a
conﬁdence interval for pB −pG by replacing unknown probabilities with their
estimators in suitable places. (c) With the numbers given in Example 6.8, what
is the observed conﬁdence interval? (d) A quick way to decide whether the
difference is signiﬁcant is to see if the individual conﬁdence intervals overlap.
Since Bush had 47 ± 2 and Gore 44 ± 2, which do overlap, we conclude that the
difference is not signiﬁcant. This is equivalent to adding the margins of error,
which gives the difference 0.03 ± 0.04. What is the principal ﬂaw in this? In
practice, what is the difference from the interval in part (c)?
25. Assume that X1, . . . Xn is a sample from an arbitrary distribution with unknown
μ and known σ. Derive an approximate conﬁdence interval with conﬁdence
level q under the assumption that n is large. Hint: Use the central limit theorem.
26. For large normal samples, it can be shown that
s
d≈N

σ, σ2
2n

Use this to derive an approximate conﬁdence interval with conﬁdence level q
for σ.
27. Consider a Poisson process with rate λ. If X points are observed in an interval
of length t, argue that an approximate conﬁdence interval for λ with conﬁdence
level q is given by
λ = X/t ± z
√
X/t
where (z) = (1 + q)/2. Hint: Problem 8, Chapter 4.
28. In a clinical trial for a new drug, patients were divided into two groups, one of
size n = 503 receiving the drug and one of size m = 430 receiving placebo.
One of the side effects studied was headache. In the drug group, 200 experi-
enced headaches and in the placebo group, 156. Find a 95% one-sided conﬁ-
dence interval to investigate whether the drug increases the risk of developing
headaches.
29. Let θ1, θ2, . . . , θn be n parameters, and let I1, I2, . . . , In be their corresponding
conﬁdence intervals, each with conﬁdence level q. The simultaneous conﬁdence
level, qs, is deﬁned as the probability that all intervals contain their respective
parameters. (a) Show that qs = qn if the intervals are independent. (b) Suppose
that a president has approval ratings that are statistically signiﬁcant above 50%
in 10 consecutive polls. If each poll has conﬁdence level 0.95, what is the
simultaneous conﬁdence level? (c) In general, show that qs ≥1 −n(1 −q).
Hint: Problem 13 in Chapter 1. (d) If you want a simultaneous conﬁdence level
of at least 0.95 and have 10 intervals that are not necessarily independent, what
conﬁdence level do you need for each individual interval?
30. Prediction intervals. Suppose that we have observed X1, . . . , Xn in a normal
distribution with known variance σ2 and that we wish to predict the outcome

382
STATISTICAL INFERENCE
of a future observation, say, X (remember Section 3.7.2) that is independent of
the other Xk and with the same distribution. A natural predictor is ¯X, and in
order to measure its accuracy, we need error bounds such that
P( ¯X −R ≤X ≤¯X + R) = q
for a given probability q. The interval [ ¯X −R, ¯X + R] is called a 100q%
prediction interval for X. (a) Show that the prediction interval is given by
X = ¯X ± zs

1 + 1
n
where (z) = (1 + q)/2. (b) Compare this with the 100q% conﬁdence interval
for μ. What is the difference in interpretation? Which interval is longer? (c)
Consider the lightbulb data from Section 6.2. Find a 95% prediction interval
for the next lifetime X. (d) Compare the 95% prediction interval with the 95%
conﬁdence interval for μ. What happens as n →∞? Explain!
Section 6.4. Estimation Methods
31. Let X1, . . . , Xn be a random sample from a gamma distribution with unknown
parameters α and λ. Show that the moment estimators are
λ = ¯X/(n −1)s2
and α = ¯Xλ
32. Consider a Poisson process with unknown rate λ. Suppose that the nth point
arrives at time T. Find the moment estimator of λ.
33. Find the MLE in Example 6.13 assuming that we have observed X 1s in n trials.
34. Let X1, . . . , Xn be a sample from a uniform distribution on (a, b) where the
parameter a is known. Find the MLE and moment estimator of b.
35. In the previous problem, suppose that both a and b are unknown. Find the MLE
and moment estimator of a and b.
36. Let X1, . . . , Xn be a random sample from a uniform distribution on [−θ, θ].
Find the MLE of θ.
37. Let X1, . . . , Xn be a random sample from a distribution with pdf
f(x) = e−(x−θ),
x ≥θ
Find the MLE and moment estimator of θ.
38. Let X1, X2, . . . , Xn be a random sample from a distribution with pdf
fθ(x) = θxθ−1,
0 ≤x ≤1
(a) Find the moment estimator of θ. (b) Find the MLE of θ. (c) Calculate an
approximate conﬁdence interval for θ.
39. Let X1, X2, . . . , Xn be a random sample from a normal distribution with mean
0 and unknown variance θ. Find the MLE and moment estimator of θ.

PROBLEMS
383
40. Let X1, X2, . . . , Xn be a sample from a distribution with pdf
f(x) = ax e−ax2/2,
x ≥0
(a) Find the moment estimator of a. (b) Find the MLE of a. (c) Calculate an
approximate conﬁdence interval for a.
41. Let X1, X2, . . . , Xn be a sample from a uniform distribution [θ −1, θ + 1],
where θ is unknown. (a) Find the moment estimator of θ. (b) Show that any
point between X(n) −1 and X(1) + 1 is an MLE of θ. This shows that MLEs
are not necessarily unique.
42. Let X1, X2, . . . , Xn be a sample from a distribution with pdf
f(x) = 1
2σ e−|x−μ|/σ,
x ∈R
(a) Show that ¯X is the moment estimator of μ. (b) Show that the sample median
X(k) is the MLE of μ for odd n = 2k −1.
Section 6.5. Hypothesis Testing
43. Ann suspects that her coin may be manipulated so that it does not give heads
and tails with equal probability when she ﬂips it. She decides to test this by
ﬂipping the coin eight times and concludes that it is unfair if she gets all heads
or all tails. Formulate hypotheses and calculate the level of signiﬁcance. Find
another critical region so that α ≤0.10.
44. A climate scientist believes that the mean number of hurricanes in the Mexican
Gulf is 5 during a normal year. He wants to test if this is true for the period
2005–2008 or if the mean has increased. Assume that the number of hurricanes
in a year is Poisson distributed with mean λ. (a) Formulate hypothesis in a
statistical test. (b) Determine the largest critical region so that α ≤0.10. (c) In
the period 2005–2008, there were 15, 5, 6, and 8 hurricanes recorded per year.
Is this sufﬁcient evidence to reject the null hypothesis? Hint: Problem 8(b) in
Chapter 4.
45. Consider a sample X1, . . . , Xn from a normal distribution with unknown mean
μ and known variance σ2 (compare with Problem 18). (a) Describe how to test
the null hypothesis H0 : μ = μ0. (b) Use the data in Problem 18 to test on the
5% level if the true weight is 1000 g.
46. Show that Proposition 6.9 holds.
47. Let X1, . . . , Xn be a sample from the exponential distribution with parameter λ.
(a) Use Proposition 6.9 and Example 6.19 to derive a test of H0 : λ = λ0 against
HA : λ /= λ0. (b) Use Proposition 6.10 to derive a test of the same hypotheses.
Which test do you prefer?
48. Here is a headline from the Libertarian Party Web site in 2003: “Thompson
could have doubled vote in Wisconsin race, according to poll.” Wisconsin

384
STATISTICAL INFERENCE
gubernatorial candidate Ed Thompson won 10.5% of the vote in 2002, and
in a poll of 1000 voters shortly after the election, 23% said that they would
have voted for him, had they thought he could win. Does this support the claim
of (at least) doubling his vote? State the appropriate hypotheses, and test on the
5% level.
49. In a poll before the 2004 presidential election, the support for John Kerry was
78% in Washington, DC, and 38% in Texas. Suppose that both polls had sample
size 1000. Can you conclude that the support in DC is at least twice as big as
in Texas? How is this situation different from that in the previous problem.
50. In 2010, there were 266 persons killed in trafﬁc accidents in Sweden compared
to 358 in the previous year. Carry out a hypothesis test to see if this decrease
can be considered statistically signiﬁcant. What assumptions do you need to
make?
51. Use Propositions 6.9 and 6.11 to derive an alternative conﬁdence interval for
the unknown probability p than the one in Proposition 6.6.
Section 6.6. Further Topics in Hypothesis Testing
52. You are asked to decide whether males are less likely than females to call a
particular toll-free number and are presented the following sequence of callers:
FFFFFM. With p as the probability of a male caller, you thus wish to test
H0 : p = 1
2 versus HA : p < 1
2 and decide to compute the P-value. Consider
the following two test methods: (a) the sample size is n = 6, and since the
number of male callers X is bin(6, 1
2) under H0, the P-value is P(X ≥1); (b)
the ﬁrst male caller was in the sixth call, and since the number of trials N
until the ﬁrst male caller is geometric with p = 1
2 under H0, the P-value is
P(N ≥6). Compute the two P-values and show that method (b) rejects on the
5% level, whereas method (a) accepts. What further information would you
need in regard to how the data were collected?
53. Consider a study that compares test results of two groups of students from two
universities, A and B, which are known to be of comparable quality. The null
hypothesis of no difference is therefore tested versus the two-sided alternative
that there is a difference. Suppose that the test statistic is N(0, 1) under H0 and
that we test on the 5% level, which means that H0 is rejected if |T| ≥1.96.
The observed value turned out to be 1.68 so H0 cannot be rejected. However, a
representative from university A notices that positive values of T is in their favor
and that the null hypothesis can be rejected in favor of the alternative “HA : A
is better” since this test rejects on the 5% level if T ≥1.64. How would you
persuade the representative that publishing this would be dubious?
54. If you read a research report that claims that men are better drivers than women
and that this has been conﬁrmed in a study with a given P-value, you should
probably double that P-value. Why? (Compare with the previous problem.)
55. A certain type of disease occurs in a small fraction p of the population and
is known to occur fairly uniformly across the United States. In 2004, each

PROBLEMS
385
state screens for the disease and tests on the 5% level whether it occurs in a
fraction higher than p. A signiﬁcant result is found in California. How would
you persuade the Governor of California that there is no immediate reason to
panic?
56. Suppose that we test and reject ﬁve different null hypotheses, each on the 5%
level. If the tests are independent of each other and k of the null hypotheses are
true, what is the probability of rejecting some true null hypothesis? For which
value of k = 0, 1, . . . , 5 is this probability largest?
57. In July 2004, a special opinion poll was done regarding the upcoming presi-
dential election. In this poll, the outcome in the Electoral College was targeted
and a separate poll was done in each of the 50 U.S. states. If a multiple level of
5% was desired, what would the signiﬁcance level have to be in each state?
58. Consider the two extreme test procedures to always reject the null hypothe-
sis and to never reject the null hypothesis, regardless of data. What are the
signiﬁcance levels and power functions of the two tests?
59. Consider the test of H0 : p = 1
2 versus HA : p /= 1
2 for an unknown probability
p based on n repetitions of the trial. The relative frequency is p and the test
statistic is T = 2√n(p −1
2) which is approximately N(0, 1) under H0 (verify
this). Now consider the two 5% level test procedures: (a) reject if T ≥1.64 and
(b) reject if |T| ≥1.96. Compare the powers of the two tests and argue that (a)
is more powerful than (b) for some values of the true probability p, whereas (b)
is more powerful than (a) for other values. Which test makes more sense?
60. (a) Consider the test of H0 : p = 1
2 versus HA : p > 1
2 that rejects on the 5%
level if 2√n(p −1
2) ≥1.64, and suppose that the true probability is 0.6. Sup-
pose further that we want to be at least 90% certain to detect this with our test.
How large must n be? (b) Generally, suppose that the true probability is p > 0.5
and that we want to have at least probability q to detect this. What equation in
terms of the standard normal cdf  do we need to solve for n?
61. Assume that you are about to carry out two independent tests and you want the
multiple signiﬁcance level to be 0.05. What level of signiﬁcance should you
choose in each individual test? How does the result change for m = 3, 5, 10, 20
independent tests?
62. ShowthattheBonferroni–Holmcorrectionyieldsacorrectmultiplesigniﬁcance
level.
Section 6.7. Goodness of Fit
63. Consider the Texas Lottery data from Example 6.29. On a closer look, it seems
that the number 7 is overrepresented. Let p be the probability to get 7 and test
the hypothesis H0 : p = 0.1 versus HA : p > 0.1 on the 5% level. Compare
with the conclusion of the goodness-of-ﬁt test in the example. Comment!
64. A store owner classiﬁes each day as “good” or “bad,” depending on sales. Each
week (6 workdays) the number of good days are counted. Use the data from 1

386
STATISTICAL INFERENCE
year below to test on the 5% level if good and bad days are equally likely. Hint:
The number of good days in a week has a binomial distribution with n = 6.
Number of good days
0
1
2
3
4
5
6
Number of weeks
1
9
12
13
11
5
1
65. The weekly number of accidents on a particular highway was studied. Use the
data below to test on the 5% level whether the number of accidents is better
described by a Poisson distribution or a geometric distribution including 0.
Number of accidents
0
1
2
3
4
5
6
≥7
Number of weeks
24
14
4
1
4
1
2
0
66. Consider the earthquake data in Example 6.30. Test whether the number of
earthquakes in a given year has a binomial distribution with parameters n = 25
and p = 0.03. After you have done the test, what would you like to ask the
person who suggested the distribution?
67. Sometimes,wewanttorejectalsoforverysmallvaluesofthechi-squarestatistic
in a goodness-of-ﬁt test. The reason is to rule out data snooping and other
manipulation that may render the ﬁt “too good to be true.” Show that such a
test rejects on level α if
χ2 ≤x1
or
χ2 ≥x2
where Fχ2
r−1(x1) = α/2 and Fχ2
r−1(x2) = 1 −α/2.
68. In Gregor Mendel’s famous experiment with peas, the two types “smooth” and
“wrinkled” were identiﬁed. Mendel argued that the smooth seed trait was dom-
inant and the wrinkled was recessive (recall Section 1.6.2) and in a population
of peas there should thus be 75% smooth and 25% wrinkled. Out of a total
of 7324 peas, Mendel got 5474 smooth and 1850 wrinkled. (a) Test the domi-
nant/recessive claim on the 1% level. (b) Do a two-sided test on the 1% level
according to the previous problem. What do you conclude?
69. We might not want to put equal weight on “poor ﬁt” and “too good to be true
ﬁt.” Suppose that we want level 1% in a two-sided test and that we accept a
close ﬁt as long as it is not less probable than 0.1%. Give the critical values x1
and x2 for this test for Mendel’s data and do the test.
70. Metal bars of length 100 cm are manufactured. They are ﬁrst cut crudely,
somewhere between 100 and 101, and then reﬁned to achieve the desired
length. The following is a set of 26 measured deviations from 100 cm. Does
this cutoff waste follow a uniform distribution on [0, 1]? Test on the 5% level.
0.11, 0.18, 0.28, 0.33, 0.42, 0.42, 0.47, 0.48, 0.49, 0.49, 0.51, 0.52, 0.59
0.61, 0.62, 0.63, 0.66, 0.68, 0.74, 0.74, 0.75, 0.76, 0.78, 0.79, 0.81, 0.83

PROBLEMS
387
71. In the previous problem, test if the data come from some uniform distribution.
Hint: The MLEs are the minimum and the maximum.
72. In a study of bats, it was investigated whether a tendency to bite people was
associated with carrying rabies. [Source: Emerging Infectious Diseases 5:433–
437 (1999).] Out of 233 bats who bit people, 69 were found to have rabies,
and out of 4237 that did not bite people, 613 had rabies. Describe the data in a
contingency table and test for independence on the 5% level.
73. In Example 6.32, after we have rejected independence, can we conclude from
the chi-square test that females are less likely to be admitted?
74. Inastudyofvotingbehaviorinthe2000 presidentialelection,itwasinvestigated
how voting was associated with education level. Use the contingency table
below to test on the 5% level whether voting is independent of education level.
No Degree
High School
Some College
College Degree
Voter
26
223
215
387
Nonvoter
168
432
221
211
75. Eight men and 10 women tried a new diet for a month. Five men but only two
women lost more than 10 pounds. Use Fisher’s exact test to test if the diet is
equally effective for men and women.
Section 6.8. Bayesian Statistics
76. Consider Example 6.35 and suppose that p has prior distribution P(p = 1
3) = q,
P(p = 2
3) = 1 −q. Find the posterior distribution and its mean.
77. Consider Example 6.35 where the data are 1, 1, 0, 1 and the prior uniform on
[0, 1]. Compare the mode (recall Section 2.9) in the posterior distribution and
the MLE of p.
78. Consider Example 6.35 where the data are 1, 1, 0, 1 and suppose that p has
prior f(p) = 2p, 0 ≤p ≤1. Find the posterior distribution and the posterior
mean and mode. Compare with the MLE.
79. Microchips are being produced, and there is a certain probability p that a chip is
defective and thus useless. To estimate p, 100 chips are checked and 4 of these
are defective. In the archives you ﬁnd the results of four previous studies, where
the estimated values of p are 0.05, 0.06, 0.08, and 0.10. Suggest a way to use
this information to choose a prior beta distribution and then ﬁnd the posterior
distribution and the Bayes estimate of p. Compare with the frequentist estimate
0.04. From a frequentist point of view, how can the previous estimates be used?
80. When tossing a fair coin repeatedly, it turned up tails two times. The total
number of tosses was, however, unknown and therefore considered as a positive
integer-valued random parameter θ. (a) Use a uniform prior on the integers
1, . . . , 6 and calculate the posterior distribution of θ. (b) Calculate the mean

388
STATISTICAL INFERENCE
and variance of the posterior distribution. (c) Calculate a two-sided credibility
interval for θ with approximate probability 70%.
81. Show that the gamma distribution is conjugate to the Poisson distribution.
82. Show that the gamma distribution is conjugate to the exponential distribution.
83. Assume that X is exponentially distributed with parameter λ and that the prior
of λ is the gamma distribution with parameters α = 2 and β = 10. (a) If we
make the observation X = 5, calculate the posterior mean and variance.
(b) If we only get the information that X > 5, calculate the posterior mean
and variance. Can you explain the difference?
84. Consider a normal distribution with unknown mean μ and known variance σ2
where the prior distribution of μ is N(μ0, σ2
0). Suppose that we have observed
the values x1, . . . , xn. (a) Show that the posterior distribution is normal with
mean and variance
E[μ|D] =
σ2
0σ2
σ2 + nσ2
0

μ0
σ2
0
+ n¯x
σ2

Var[μ|D] =
σ2
0σ2
σ2 + nσ2
0
(b) Express the posterior mean as a weighted average of the prior mean and
the sample mean. What happens as n →∞? What happens to the posterior
variance? (c) How do the weights in (b) depend on the variances σ2 and σ2
0?
Explain this intuitively if we interpret a small prior variance as strong belief
that the prior mean is correct.
85. Calculate Jeffrey’s prior for the Poisson distribution.
86. Calculate Jeffrey’s prior for the exponential distribution.
87. Let X1, . . . , Xn be a sample from the geometric distribution with pmf
p(x) = θ(1 −θ)x−1,
x = 1, 2, . . .
(a) Find the conjugate family of prior distributions. (b) Let us assume that we
have observed the sample
2, 9, 4, 6, 7
Calculate posterior mean and standard deviation for a uniform prior. (c) Calcu-
late posterior mean and standard deviation for Jeffrey’s prior.
Section 6.9. Nonparametric Methods
88. Below is a set of 15 IQ scores. Find parametric (based on the normal
distribution) and nonparametric ≈95% observed conﬁdence intervals for the
median. For the parametric interval, assume that the scores are normal with
σ = 15. Compare the lengths of the intervals and comment.
88, 90, 93, 96, 98, 106, 109, 111, 113, 113, 114, 116, 119, 126, 140

PROBLEMS
389
89. Below is a set of 10 measured service times (milliseconds) for a particular type
of job arriving at a computer.
23.2, 27.3, 41.3, 56.6, 82.8, 83.7, 118.5, 210.8, 263.9, 621.8
Find the nonparametric 95% observed conﬁdence intervals for the median.
90. Consider a sample of size n = 5. Show that the sign test cannot reject H0 :
m = m0 on signiﬁcance level 5% in a two-sided test and not on level 1% in a
one-sided test. What are the smallest possible levels for which the sign test can
do these rejections and what is then required of the test statistic N+?
91. In Problem 89, use a one-sided sign test to test whether the median time is 100
versus the alternative that it is <100.
92. Below is a data set of the annual change in the last reading of the Dow index
each year between 1972 and 2002 (1.06 means that it went up by 6%, 0.84 that
it went down by 16%, and so on). Do a two-sided sign test to investigate if the
“New Year’s Eve Dow” tends to stay constant.
1.06, 0.84, 0.89, 1.30, 0.97, 0.80, 1.10, 1.07, 1.08, 0.89, 1.32, 1.06, 1.12, 1.29
1.34, 0.90, 1.14, 1.13, 1.13, 1.11, 1.30, 1.14, 1.05, 1.38, 1.25, 1.18, 1.14, 1.42
0.94, 0.95, 0.83
93. This problem outlines the proof of Proposition 6.17, where the pmf of the test
statistic W = n
k=1 RkIk is given. First argue that if H0 is true, the distribution
of W is the same as that of U = n
k=1 Uk, where the Uk are independent and
P(Uk = 0) = P(Uk = k) = 1
2. Next, use the fact that the pgf of U, which is the
same as the pgf of W, is the product of the pgf’s of the Uk. Then, argue that
P(W = r) = a(r)/2n, where a(r) is the number of ways in which 0s and 1s can
be assigned to the Ik so that W = r (and under H0, all such ways are equally
likely), and ﬁnally, identify P(W = r) with the appropriate coefﬁcient in the
pgf of W.
94. Use U in the previous problem to ﬁnd the mean and variance of W. It can
be shown that W is asymptotically normal but more general versions of the
central limit theorem than ours are needed. Why does our central limit theorem
(Theorem 4.2) not apply?
95. For W as above, ﬁnd P(W = 3) if n = 5.
96. A company manufactures metal plates. Each plate gives a certain amount of
cutoff waste, and the process needs to be adjusted if this exceeds 100 mg per
plate. Below are 11 measured weights of waste. Do they call for adjustment?
Test on the 5% level.
88, 98, 99, 110, 118, 121, 123, 129, 136, 140, 149
97. We have probably all wondered from time to time whether it rained more in St.
Louis or Minneapolis during the 1970s. Below are the annual total amounts

390
STATISTICAL INFERENCE
(inches) for the two cities, for the years 1970–1979. Decide what type of
two-sample procedure to use (pairwise differences or independent samples)
and test on the 5% level if there is a difference.
Minneapolis: 30.5, 29.4, 23.8, 21.1, 19.1, 35.1, 16.5, 34.9, 30.3, 31.0
St. Louis:
36.2, 33.7, 33.7, 39.8, 36.8, 40.2, 23.5, 43.4, 37.7, 29.5
98. Consider the Wilcoxon rank sum test with m = 2 and n = 5. Find the range of
W and P(W = 7).
99. Execution times for a particular type of numerical computation were measured
using two different algorithms, A and B. The times in milliseconds were
A: 2, 4, 4, 8, 9, 14, 21, 25
B: 7, 13, 25, 43, 47
Use the rank sum test to test on level 5% whether there is a difference between
the algorithms.
100. Use Kolmogorov–Smirnov’s test to examine the difference in the previous
problem.
101. The following data are the number of murders (in thousands) in the United
States during the 1980s (starting 1984) and 1990s (Source: FBI Uniform
Crime Reports, www.fbi.gov) ordered by size. Is there a difference between
the two decades?
1980s: 18.7, 19.0, 20.1, 20.6, 20.7, 21.5
1990s: 15.5, 17.0, 18.2, 19.6, 21.6, 23.3, 23.4, 23.8, 24.5, 24.7
102. Recall Cavendish’s density data from Example 6.45. It is known that 6 of his
29 measurements were taken before he changed his experimental apparatus.
These measurements were
5.42, 5.47, 5.50, 5.53, 5.57, 5.61
Did the change make a difference? Test on the 5% level (use the normal ap-
proximation).

7
LINEAR MODELS
7.1
INTRODUCTION
When the normal distribution was introduced in Section 2.7 and, particularly, when
the central limit theorem was presented in Section 4.3, its importance in statistics
was pointed out. Since the central limit theorem basically says that any quantity that
can be seen as a sum of a large number of independent random contributions can
be considered to be, at least approximately, normally distributed, it was argued that
many quantities that we tend to study in practice satisfy this.
We have already looked at IQ as an example, but this is a somewhat artiﬁcial
measure that is speciﬁcally constructed to be normally distributed. For another, more
relevant example, consider body length of a randomly chosen individual. We can
easily come up with dozens of factors that affect a person’s length like parents’
lengths, intake of various nutrients during childhood, exercise, sleep habits, whether
the mother smoked or consumed alcohol during pregnancy, access to proper medical
care, and so on.1
Therefore, it is quite common to make the assumption that random samples come
from normal distributions with unknown mean and variance and in this chapter we
will present a number of inference methods that are speciﬁcally developed to handle
1Age and sex are also important factors but they inﬂuence body length somewhat differently and cannot as
easily be described as random contributions. For simplicity, let us assume that we consider body lengths
of individuals in the same age group and of the same sex.
Probability, Statistics, and Stochastic Processes, Second Edition. Peter Olofsson and Mikael Andersson.
© 2012 John Wiley & Sons, Inc. Published 2012 by John Wiley & Sons, Inc.
391

392
LINEAR MODELS
this case. Models that include normally distributed variation are usually called linear
models, a term that hopefully will become clearer as we go along.
7.2
SAMPLING DISTRIBUTIONS
Before going into the various inference methods of normally distributed samples, we
need to introduce some new distributions that will be useful in deriving conﬁdence
intervals and hypothesis tests. Since they can be used to describe the properties of
sample means ¯X and sample variances s2, they are usually referred to as sampling
distributions.
The ﬁrst distribution is deﬁned as follows.
Deﬁnition 7.1. If the random variable Y has pdf
f(x) =
1
2r/2(r/2) xr/2−1e−x/2,
x ≥0
then Y is said to have a chi-square distribution with r degrees of freedom, written
Y ∼χ2
r.
The chi-square distribution is related to the normal distribution in the following way.
Proposition 7.1. Let X1, . . . , Xr be i.i.d. random variables that are N(0, 1) and let
Y = r
k=1 X2
k. Then Y ∼χ2
r.
Proof. We begin by deriving the following useful equation
 ∞
0
e−kxxα−1 dx =
 ∞
0
e−t  t
k
α−1 dt
k = (α)
kα
(7.1)
using the variable substitution t = kx and the deﬁnition of the gamma function (α)
from Section 2.8.2. This can now be used to obtain the moment generating function,
introduced in Section 3.11.2, of the chi-square distribution as
MY(t) = E[etY] =
 ∞
0
etx
1
2r/2(r/2) xr/2−1e−x/2 dx
=
1
2r/2(r/2)
 ∞
0
xr/2−1e−(1/2−t)x dx
=
1
2r/2(r/2) ×
(r/2)
( 1
2 −t)r/2 =
1
(1 −2t)r/2

SAMPLING DISTRIBUTIONS
393
The next step is to derive the moment generating function of the X2
k variables as
MX2
k(t) = E[e−tX2
k] =
 ∞
−∞
e−tx2
1
√
2π
e−x2/2 dx
=
1
√1 −2t
 ∞
−∞
1
(1 −2t)−1/2√
2π
e−x2/(2(1−2t)−1) dx =
1
√1 −2t
where the last equality follows from the observation that the integrand is the pdf of a
normal distribution with mean 0 and variance (1 −2t)−1 and therefore integrates to
one. The result now follows from Proposition 3.40 as
MY(t) = MX2
1(t) · · · MX2r (t) =

MX2
k(t)
r
=

1
√1 −2t
r
=
1
(1 −2t)r/2
(7.2)
■
It is clear from the deﬁnition and, particularly, from Proposition 7.1 that a chi-squared
variableisalwaysnonnegative.Sincewemainlywillusethechi-squaredistributionfor
conﬁdence intervals and hypothesis tests, we will not go further into the theoretical
properties of this distribution. Critical values can be calculated numerically using
Deﬁnition 7.1 and some of them are presented in Table A.4.
The second sampling distribution is deﬁned as follows.
Deﬁnition 7.2. If the random variable Z has pdf
f(x) = ((r + s)/2)
(r/2)(s/2)
r
s
r/2
xr/2−1 
1 + rx
s
−(r+s)/2
,
x ≥0
then Z is said to have an F distribution with r and s degrees of freedom, written
Z ∼Fr,s.
The F distribution can in turn be characterized in terms of the chi-square distribution.
Proposition 7.2. Let X ∼χ2
r and Y ∼χ2
s be independent and let
Z = X/r
Y/s
Then Z ∼Fr,s.

394
LINEAR MODELS
Proof. Let fX(x) and fY(y) denote the pdfs of X and Y, respectively. Then we can
use Corollary 3.2 to express the cdf of Z′ = X/Y as
FZ′(z) = P
X
Y ≤z

=
 ∞
0
P(X ≤yz)fY(y) dy =
 ∞
0
FX(yz)fY(y) dy
Taking the derivative with respect to z yields the pdf
fZ′(z) =
 ∞
0
yfX(yz)fY(y) dy
=
 ∞
0
y ×
1
2r/2(r/2) (yz)r/2−1e−yz/2 ×
1
2s/2(s/2) ys/2−1e−y/2 dy
=
zr/2−1
2(r+s)/2(r/2)(s/2)
 ∞
0
y(r+s)/2−1e−(1+z)y/2 dy
=
((r + s)/2)zr/2−1
(r/2)(s/2)(1 + z)(r+s)/2
where the last equality follows from Equation (7.1). Finally, using the methods of
Section 2.3.2 yields the pdf of Z as
fZ(x) = r
sfZ′
r
sx

= ((r + s)/2)
(r/2)(s/2)
r
s
r/2
xr/2−1 
1 + rx
s
−(r+s)/2
■
Again, it is obvious that the ratio of two nonnegative chi-square variables is also
nonnegative. Critical values of the F distribution are given in Table A.5
We have now come to the last sampling distribution.
Deﬁnition 7.3. If the random variable Z has pdf
f(x) = ((r + 1)/2)
√rπ (r/2)

1 + x2
r
−(r+1)/2
,
x ∈R
it is said to have a t distribution with r degrees of freedom, written Z ∼tr.
This can also be characterized in terms of the previous distributions.
Proposition 7.3. Let X ∼N(0, 1) and Y ∼χ2
r be independent and let
Z =
X
√Y/r
Then Z ∼tr.

SINGLE SAMPLE INFERENCE
395
Proof. Since X2 is chi-square distributed with one degree of freedom, we realize that
V = Z2 ∼F1,r and, conversely, that
Z =
⎧
⎪
⎨
⎪
⎩
√
V
with probability 1/2.
−
√
V
with probability 1/2.
because of symmetry of the normal distribution. We can now express the cdf of Z as
FZ(x) = 1
2P(−
√
V ≤x) + 1
2P(
√
V ≤x) = 1
2P(
√
V ≥−x) + 1
2P(
√
V ≤x)
When x < 0, we get
FZ(x) = 1
2P(V ≥x2) + 0 = 1
2(1 −FV (x2))
and if x > 0, we get
FZ(x) = 1
2 + 1
2P(V ≤x2) = 1
2(1 + FV (x2))
Taking the derivative with respect to x yields the pdf
fZ(x) = |x|fV (x2) = |x| ((r + 1)/2)
(1/2)(r/2)
1
r
1/2
(x2)−1/2

1 + x2
r
−(r+1)/2
= ((r + 1)/2)
√rπ (r/2)

1 + x2
r
−(r+1)/2
where we used the property (1/2) = √π.
■
Just like the standard normal distribution, the t distribution is symmetric around 0.
Indeed, it looks very similar to the standard normal distribution; the main difference
is that it has heavier tails (see Figure 7.1). The difference gets smaller the larger the
value of r, and as r →∞, the t distribution converges to the normal distribution.
Critical values of the t distribution can be found in Table A.3.
7.3
SINGLE SAMPLE INFERENCE
In this chapter, we are going to develop inference methods for μ and σ2 based on
a sample X1, . . . , Xn of i.i.d. normally distributed variables with unknown mean μ
and variance σ2. Many of the methods will be similar to those introduced in Chapter
6. What remains to be done is to derive new distributions of relevant statistics based
on the sampling distributions of the previous section.

396
LINEAR MODELS
−4
−2
0
2
4
0
 0.1
0.2
0.3
0.4
FIGURE 7.1
The pdfs of the standard normal distribution (dashed line) and a t distribution
with r = 2 degrees of freedom.
7.3.1
Inference for the Variance
It turns out that it is more logical to start with the variance σ2 in this setting. Let us
go directly to the key result.
Proposition 7.4. Let X1, . . . , Xn be a sample from a N(μ, σ2) distribution. Then
(n −1)s2
σ2
∼χ2
n−1
a chi-square distribution with n −1 degrees of freedom.
Proof. We ﬁrst expand the expression
n

i=1
(Xi −μ)2
=
n

i=1

(Xi −¯X) + ( ¯X −μ)
2
=
n

i=1
(Xi −¯X)2 + n( ¯X −μ)2 +
n

i=1
(Xi ¯X −¯X2 −Xiμ + ¯Xμ)
= (n −1)s2 + n( ¯X −μ)2 + n ¯X2 −n ¯X2 −n ¯Xμ + n ¯Xμ
= (n −1)s2 + n( ¯X −μ)2

SINGLE SAMPLE INFERENCE
397
Dividing this by σ2 yields that
(n −1)s2
σ2
+
 ¯X −μ
σ/√n
2
=
n

i=1
Xi −μ
σ
2
The second term on the left-hand side is the square of a standard normal variable
and, hence, chi-square distributed with one degree of freedom. The expression on the
right-hand side is the sum of the squares of n independent standard normal variables
and, hence, chi-square distributed with n degrees of freedom. It can be shown that
¯X and s2 are independent for normal samples, so Proposition 3.40 and (7.2) together
imply that
M(t) ×
1
√1 −2t =
1
(1 −2t)n/2
where M(t) is the moment generating function of (n −1)s2/σ2. This means that
M(t) =
1
(1 −2t)(n−1)/2
which is the mgf of the chi-square distribution with n −1 degrees of freedom.
■
We can use this result to ﬁnd a conﬁdence interval for σ2. If we want conﬁdence level
q, we need to ﬁnd x1 and x2 such that
P

x1 ≤(n −1)s2
σ2
≤x2

= q
that is
P
(n −1)s2
x2
≤σ2 ≤(n −1)s2
x1

= q
The interval we get is not unique; in fact, there are inﬁnitely many ways to choose x1
and x2 so that the last equation is satisﬁed for a given q. One additional requirement
often is that the interval is symmetric in the sense that we are equally likely to miss
the parameter to the right and to the left. Then we must choose x1 and x2 such that
P
(n −1)s2
σ2
≤x1

= P
(n −1)s2
σ2
≥x2

= 1 −q
2
(see Figure 7.2). Since 1 −(1 −q)/2 = (1 + q)/2, we get the following conﬁdence
interval.

398
LINEAR MODELS
area=q 
area=(1−q)/2 
area=(1−q)/2
x2
x1
FIGURE 7.2
The pdf of a chi-square distribution and how to choose x1 and x2 in order to
obtain a symmetric conﬁdence interval for σ2 with conﬁdence level q.
Proposition 7.5. Let X1, . . . , Xn be a random sample from a N(μ, σ2) distribution
where μ is unknown. A 100q% symmetric conﬁdence interval for σ2 is
(n −1)s2
x2
≤σ2 ≤(n −1)s2
x1
(q)
where Fχ2
n−1(x1) = (1 −q)/2 and Fχ2
n−1(x2) = (1 + q)/2.
Note how this interval is not of the form “estimator ± something,” which is because the
chi-square distribution is not symmetric like the normal distribution or t distribution.
Example 7.1. Find the observed symmetric 95% conﬁdence interval for the standard
deviation σ in the lightbulb example.
From Example 6.5 we have s2 = 9392. With n −1 = 4 and (1 + q)/2 = 0.975, Table
A.4 gives x1 = 0.48 and x2 = 11.14, which gives (n −1)s2/x2 = 4 × 9392/11.14 =
3372 and (n −1)s2/0.48 = 78, 267. These are the bounds for σ2 and in order to get
bounds for σ, take square roots to get the conﬁdence interval
58 ≤σ ≤280 (0.95)
□
We can also use Proposition 7.4 to come up with a test procedure.

SINGLE SAMPLE INFERENCE
399
Proposition 7.6. Suppose that X1, . . . , Xn is a sample from a normal distribution
where we wish to test
H0 : σ = σ0
versus HA : σ /= σ0
The test statistic is
X2 = (n −1)s2
σ2
0
and H0 is rejected on level α if
X2 ≤c1
or X2 ≥c2
where Fχ2
n−1(c1) = α/2 and Fχ2
n−1(c2) = 1 −α/2.
7.3.2
Inference for the Mean
We have already looked at conﬁdence intervals (Example 6.7) and hypothesis tests
(Example 6.23) for μ in the normal distribution when σ is known. It turns out that we
only have to modify these methods by replacing σ with s and the normal distribution
with the t distribution according to the following result.
Proposition 7.7. Let X1, . . . , Xn be i.i.d. N(μ, σ2) and let s2 be the sample vari-
ance. Then
¯X −μ
s/√n ∼tn−1
a t distribution with n −1 degrees of freedom.
Proof. We can rewrite the expression as follows:
¯X −μ
s/√n =
¯X −μ
σ/√n

(n −1)s2
σ2

(n −1)
where the enumerator is N(0, 1) and Proposition 7.4 implies that the denominator is
the square root of χ2
n−1 divided by the degrees of freedom. Again, the fact that ¯X and
s2 are independent for normal samples and Proposition 7.3 completes the proof.
■

400
LINEAR MODELS
We can now ﬁnd a conﬁdence interval for μ. The inequalities
¯X −R ≤μ ≤¯X + R
are equivalent to the inequalities
−
R
s/√n ≤
¯X −μ
s/√n ≤
R
s/√n
where we now know that the quantity in the middle has a t distribution with n −1
degrees of freedom. With t = R√n/s, we get the equation
q = P

−t ≤
¯X −μ
s/√n ≤t

= Ftn−1(t) −Ftn−1(−t) = 2Ftn−1(t) −1
by symmetry of the t distribution. This ﬁnally gives the following proposition.
Proposition 7.8. If X1, . . . , Xn is a sample from a N(μ, σ2) distribution where σ2
is unknown, a 100q% conﬁdence interval for μ is
μ = ¯X ± t s
√n
(q)
where t is such that Ftn−1(t) = (1 + q)/2.
The cdf of the t distribution is easily computed in many of the mathematical and
statistical software packages that are available. For example, in Matlab, the command
“cdf( ’t’, x, r )” gives the value Ftr(x). For your convenience, Table A.3 gives values
of t for various sample sizes and conﬁdence levels. For x values larger than those in
the table, you may use the N(0, 1) distribution as an approximation.
Example 7.2. Consider the lightbulb example and ﬁnd a 95% conﬁdence interval for
μ.
We have n = 5 and, from Example 6.5, s = 96.9. Since (1 + q)/2 = 0.975 and n −
1 = 4, we need to ﬁnd t such that Ft4(t) = 0.975, and from Table A.3 we get t = 2.78.
This gives the conﬁdence interval
μ = 1086 ± 2.78 × 96.9
√
5
= 1086 ± 120 (0.95)
□
By comparing this result with Example 6.7 where we assumed that σ = 100, we
see that we get a considerably wider interval. This is quite typical because using an
estimate for a parameter instead of the exact value increases our uncertainty, which
is reﬂected in the result.

SINGLE SAMPLE INFERENCE
401
The symmetry of the t distribution also makes it possible to design a hypothesis
test.
Proposition 7.9. Suppose that X1, . . . , Xn is a sample from a normal distribution
where we wish to test
H0 : μ = μ0
versus HA : μ /= μ0
The test statistic is
T =
¯X −μ0
s/√n
and H0 is rejected on level α if
| T | ≥c
where Ftn−1(c) = 1 −α/2.
This is called the one-sample t test. If we test against a one-sided alternative, we should
reject H0 only for deviations in one direction of T from 0. Thus, for the alternative
HA : μ > μ0, we reject if T ≥c where Ftn−1(c) = 1 −α, just as in the blood pressure
example. If we instead have HA : μ < μ0, we should reject for large negative values
of T. More speciﬁcally, we reject if T ≤−c where c satisﬁes
α = P(T ≤−c) = Ftn−1(−c) = 1 −Ftn−1(c)
which again gives Ftn−1(c) = 1 −α. We get the following corollary.
Corollary 7.1. In Proposition 7.9, if we test H0 against the one-sided alternative
HA : μ > μ0
(or μ < μ0)
then H0 is rejected on level α if
T ≥c (or T ≤−c)
where Ftn−1(c) = 1 −α.
Note how the c’s in the two-sided and one-sided tests are not the same. In a two-sided
test, we divide the signiﬁcance level equally between the two directions speciﬁed by
HA. In a one-sided test, we put all the signiﬁcance level on one side, which makes it
easier to reject in that particular direction but does not reject at all in the other direction.
For example, with n = 10 and α = 0.05, the two-sided test rejects if | T | ≥2.26 and
the one-sided test if T ≥1.83 (or T ≤−1.83). If we want to do a one-sided test, we
should not “waste signiﬁcance” on the other side. Compare with the comments about
one-sided versus two-sided conﬁdence intervals in Section 6.3.3.

402
LINEAR MODELS
Example 7.3. A generator is supposed to give an output voltage of 220 V. It is mea-
sured once an hour, and at the end of the day a technician decides whether adjustment
is needed. Test on the 5% level if the mean voltage is 220 V, based on the following
data:
213, 223, 225, 232, 232, 233, 237, 238
We assume that measurements are independent and follow a normal distribution. The
hypotheses are
H0 : μ = 220 versus HA : μ /= 220
where we choose a two-sided alternative since we are not asking for a particular
direction of deviation from 220. The sample size is n = 8, and with α = 0.05, Table
A.3 gives c = 2.36 (n −1 = 7, 1 −α/2 = 0.975). We have ¯X = 229.1 and s = 8.3,
which gives the observed test statistic
T = 229.1 −220
8.3/
√
8
= 3.1
and we reject H0 and conclude that adjustment is needed.
□
7.4
COMPARING TWO SAMPLES
A common situation is that we have two samples and are interested in making
comparisons between them. One typical application is in clinical trials, where we
want to determine whether a particular treatment or a new drug is better than some
other standard treatment or no treatment at all. Patients are recruited and randomly as-
signed to two different groups, usually called treatment and control, and then treated
(or not treated) accordingly. After some predetermined period of time, all patients are
examined and health indicators like blood pressure or cholesterol level are measured.
If it is possible to detect a statistically signiﬁcant difference, we can claim that the
new treatment is efﬁcient.
7.4.1
Inference about Means
There are two different situations: one where the samples are independent and one
where the observations come in pairs and are dependent. In the ﬁrst case, we thus
have two independent samples X1, . . . , Xn and Y1, . . . , Ym (the sample sizes are not
necessarily the same). If the Xk have mean μ1 and the Yk have mean μ2, we are
interested in estimating the difference μ1 −μ2. The estimator is ¯X −¯Y and since ¯X
and ¯Y are independent and normally distributed, we can use this to ﬁnd a conﬁdence
interval for μ1 −μ2. If the variances are σ2
1 and σ2
2, respectively, then according to
what we know about linear combinations of normal distributions, we obtain
¯X −¯Y ∼N

μ1 −μ2, σ2
1
n + σ2
2
m


COMPARING TWO SAMPLES
403
where we need to estimate the variances in a way that gives us a known distribution,
something that turns out to present a difﬁcult problem. The situation simpliﬁes if we
can assume that the variances in the two samples are equal2 so that Xk ∼N(μ1, σ2)
and Yk ∼N(μ2, σ2). If we estimate σ2 within each sample by
s2
1 =
1
n −1
n

k=1
(Xk −¯X)2
and
s2
2 =
1
m −1
m

k=1
(Yk −¯Y)2
respectively, we can combine these to get an estimator of σ2, based on both samples.
Deﬁnition 7.4. Let X1, . . . , Xn and Y1, . . . , Ym be two samples, independent of
each other, with means μ1 and μ2, respectively, and the same variance σ2. The
pooled sample variance is then deﬁned as
s2
p = (n −1)s2
1 + (m −1)s2
2
n + m −2
For a proof of the following result and further properties of s2
p, see Problem 31.
Corollary 7.2. The pooled sample variance s2
p is an unbiased and consistent esti-
mator of the variance σ2.
Note how the pooled sample variance is a weighted average of the two sample
variances s2
1 and s2
2, giving larger weight to the one that comes from the larger sam-
ple. Note also that neither the deﬁnition nor the result about unbiasedness assumes
anything about the distributions of the random variables. If we assume normal distri-
butions, the following result helps us with the conﬁdence intervals that we set out to
ﬁnd. We use the obvious notation sp for the square root of s2
p.
Proposition 7.10.
If X1, . . . , Xn and Y1, . . . , Ym are two independent samples
from a N(μ1, σ2) distribution and a N(μ2, σ2) distribution, respectively, and s2
p is
the pooled sample variance, then
¯X −¯Y −(μ1 −μ2)
sp

1
n + 1
m
∼tn+m−2
a t distribution with n + m −2 degrees of freedom.
2This property is called homoscedasticity, a great word to throw around at cocktail parties.

404
LINEAR MODELS
Employingtheusualmethodgivestheconﬁdenceinterval.Weleavethisasanexercise.
Corollary 7.3. Under the assumptions of Proposition 7.10, the conﬁdence interval
for μ1 −μ2 is
μ1 −μ2 = ¯X −¯Y ± tsp

1
n + 1
m
(q)
where Ftn+m−2(t) = (1 + q)/2.
Example 7.4. Suppose that we have the following measured weights (in grams) from
two shrimp farms, one in Louisiana and one in Arizona. (Yes, there are shrimp farms
in Arizona!) Find the observed 95% conﬁdence interval for the difference between
the means:
Louisiana: 15.5, 12.7, 12.1, 14.4, 16.1, 15.0, 16.2
Arizona:
11.9, 13.3, 15.8, 11.6, 10.4, 13.6, 13.8, 12.4, 13.6, 13.0
The sample sizes are n = 7, m = 10; the sample means are ¯X = 14.6 and ¯Y = 12.9;
and the sample variances are s2
1 = 2.6 and s2
2 = 2.2. This gives the pooled sample
variance
s2
p = (n −1)s2
1 + (m −1)s2
2
n + m −2
= 6 × 2.6 + 9 × 2.2
15
= 2.4
With q = 0.95 and n + m −2 = 15, we get t = 2.13 and the observed conﬁdence
interval
μ1 −μ2 = 14.6 −12.9 ± 2.13 ×
√
2.4

1
7 + 1
10
= 1.7 ± 1.6.
This interval [0.1, 3.3] does not contain 0. Thus, the difference μ1 −μ2 is entirely
above 0, which indicates that the Louisiana shrimp are on average bigger. If we had
gotten an interval that included 0, this would have included both the cases μ1 > μ2
and μ1 < μ2, and no difference could have been detected.
□
We can also use Proposition 7.10 to construct hypothesis tests. Since we are usually
interested in determining whether there is a difference between the samples or not,
the most common null hypothesis is
H0 : μ1 = μ2
If we want to test this against a two-sided alternative hypothesis, we get the two-
sample t test.

COMPARING TWO SAMPLES
405
Proposition 7.11. Let X1, . . . , Xn and Y1, . . . , Ym be two independent samples
with means μ1 and μ2, respectively, and the same variance σ2. We wish to test
H0 : μ1 = μ2
versus HA : μ1 /= μ2
The test statistic is
T =
¯X −¯Y
sp

1
n + 1
m
and we reject H0 on level α if
|T| ≥c
where Ftn+m−2(c) = 1 −α/2.
The one-sided tests are obvious, as follows.
Corollary 7.4. In Proposition 7.11, if we test H0 against the one-sided alternative
HA : μ1 > μ2
(or μ1 < μ2)
then H0 is rejected if
T ≥c (or T ≤−c)
where Ftn+m−2(c) = 1 −α.
Example 7.5. To determine whether smoking is associated with elevated blood pres-
sure, a group of people was divided into two categories, smokers and nonsmokers,
and their blood pressures were measured. The systolic pressures for smokers were
128, 131, 137, 138, 139, 141, 150, 156
and for nonsmokers
101, 125, 129, 130, 130, 136, 138, 140, 143, 146
Test on the 5% level whether smokers had higher blood pressure.
We assume that measurements are normal. If the mean for smokers is μ1 and for
nonsmokers μ2, we test
H0 : μ1 = μ2
versus
HA : μ1 > μ2

406
LINEAR MODELS
We have n = 8, m = 10 and with α = 0.01, Table A.3 gives c = 1.75 (n + m −2 =
16, 1 −α = 0.95). The sample means are ¯X = 140 and ¯Y = 132 and the pooled
sample variance
s2
p = 7s2
1 + 9s2
2
16
= 128.5
which gives the observed test statistic
T =
140 −132
√
128.5 ×

1
8 + 1
10
= 1.49
and we cannot reject H0. There is no clear support for the theory that smoking raises
blood pressure. A practical observation is that the observed value of T is fairly close
to the critical value and it might be a good idea to get larger samples to be able to
perhaps draw a more deﬁnite conclusion.
□
If the variances are not equal, the conﬁdence interval and the hypothesis test still work
as approximations if n and m are roughly the same. Otherwise, certain adjustments
can be made to improve the approximation, as described in the following result.
Proposition 7.12.
If X1, . . . , Xn and Y1, . . . , Ym are two independent samples
from a N(μ1, σ2
1) distribution and a N(μ2, σ2
2) distribution, respectively, then
¯X −¯Y −(μ1 −μ2)

s2
1
n + s2
2
m
d≈tν
where
ν =

s2
1
n + s2
2
m
2
s4
1
n2(n −1) +
s4
2
m2(m −1)
.
It should be quite clear how this can be used to modify the previous methods of
inference.3 Note that ν is not necessarily an integer so to be able to use Table A.3, we
have to round it off to the nearest smaller integer (to be on the safe side).
To illustrate the other case, paired observations, suppose instead that we are
interested in the monthly rate of growth of shrimp at one of the farms. To mea-
sure this, we take a sample of shrimp, label and weigh them, and set them aside. After
3The test based on Proposition 7.12 is usually referred to as Welch’s t test.

COMPARING TWO SAMPLES
407
a month, we weigh the same shrimp again and thus have a pair of weights (X, Y) for
each individual shrimp, where X and Y are obviously dependent. We get a sample
(X1, Y1), . . . , (Xn, Yn) of weight pairs and are interested in the difference μ2 −μ1.
By letting Dk = Yk −Xk, we can view this as a sample D1, . . . , Dn, and since Xk
and Yk are normal, so is Dk, and we are back at a one-sample problem. The mean of
Dk is E[Yk] −E[Xk] = μ2 −μ1, and the variance is unknown and estimated by the
sample variance in the D sample. Note that this means that we do not need to assume
that the variances of X and Y are equal.
Example 7.6. Suppose that we have the following weights, before and after a month:
Before: 11.9, 13.3, 15.8, 11.6, 10.4, 13.6, 13.8, 12.4, 13.6, 13.0
After:
20.9, 18.1, 20.9, 13.6, 11.3, 17.2, 20.4, 16.4, 15.5, 21.5
The sample of the differences, Dk = Yk −Xk, “after minus before” is
9.0, 4.8, 5.1, 2.0, 0.9, 3.6, 6.6, 4.0, 1.9, 8.5
which has sample mean ¯D = 4.6 and sample variance s2 = 7.5. With n −1 = 9 and
q = 0.95, we get t = 2.26 and conﬁdence interval
μ2 −μ1 = ¯D ± t s
√n = 4.6 ± 2.0 (0.95)
□
7.4.2
Inference about Variances
Although we are mostly interested in studying changes in the mean values when
comparing different groups or treatments, there are situations where changes in the
variances may be relevant. Let us say that we want to compare two different measuring
devices and want to determine if the measurement error, described by the variance, is
smaller for one of them. Another common problem is whether we can assume equal
variances so that we can use the methods described in Corollary 7.3 and Proposition
7.11.
The key result, which follows directly from Propositions 7.4 and 7.2, for the meth-
ods in this section is the following.
Proposition 7.13.
If X1, . . . , Xn and Y1, . . . , Ym are two independent samples
from a N(μ1, σ2
1) distribution and a N(μ2, σ2
2) distribution, respectively, then
s2
1/σ2
1
s2
2/σ2
2
∼Fn−1,m−1
an F distribution with n −1 och m −1 degrees of freedom.

408
LINEAR MODELS
Since the F distribution, just like the chi-square distribution, is asymmetric, we have
to formulate a conﬁdence interval for σ2
2/σ2
1 as follows.
Corollary 7.5. Under the assumptions of Proposition 7.13, the conﬁdence interval
for σ2
2/σ2
1 is
x1
s2
2
s2
1
≤σ2
2
σ2
1
≤x2
s2
2
s2
1
(q)
where FFn−1,m−1(x1) = (1 −q)/2 and FFn−1,m−1(x2) = (1 + q)/2.
Example 7.7. In Example 7.4, the sample variances were found to be s2
1 = 2.6 and
s2
2 = 2.2.Thisdifferencewasnotconsideredtobetoolargesothatthepooledvariance,
under the assumption of equal variances, was used in the calculations. Let us take a
closer look at this assumption.
The sample sizes were n = 7 and m = 10, which means that we need to use the
F6,9 distribution. If we want a 95% conﬁdence interval for the ratio of variances, Table
A.5 yields the percentiles FF6,9(0.181) = 0.025 and FF6,9(4.32) = 0.975. Hence, we
get the interval
0.181 × 2.2
2.6 ≤σ2
2
σ2
1
≤4.32 × 2.2
2.6
(0.95)
0.15 ≤σ2
2
σ2
1
≤3.6 (0.95)
Since the value one is included in the interval, we cannot exclude the possibility that
the two variances are equal.
□
We can also use Proposition 7.13 to construct a hypothesis test.
Corollary 7.6. Under the assumptions of Proposition 7.13, we wish to test
H0 : σ2
1 = σ2
2
versus HA : σ2
1 /= σ2
2
The test statistic is
F = s2
1
s2
2
and we reject H0 on level α if
F ≤x1
or F ≥x2
where FFn−1,m−1(x1) = (1 −q)/2 and FFn−1,m−1(x2) = (1 + q)/2.

ANALYSIS OF VARIANCE
409
7.5
ANALYSIS OF VARIANCE
In this section, we are going to take things one step further and look at statistical
methods for comparing more than two independent normal samples. Of course, we
can always use the methods of the previous section to carry out pairwise comparisons,
but then we will end up in multiple testing problems as described in Section 6.6.4,
especially if we have several samples to compare. Instead, we are going to use a more
comprehensive approach where we compare the variation within and the variation
between the samples to detect any differences in the means. Since we focus on the
variation through variances, these methods are referred to as Analysis of Variance or
ANOVA.
7.5.1
One-Way Analysis of Variance
Here, we assume that we have k independent samples Xi1, . . . , Xin such that
Xij ∼N(μi, σ2), where i = 1, . . . , k and j = 1, . . . , n. Note that we make two sim-
pliﬁcations in this model, namely, all samples are of equal size n and they have the
same variance σ2. ANOVA is mostly used in experimental design, where individuals
or other experimental units are randomly assigned to different groups and subjected
to a number of different treatments and it is quite common to choose groups of equal
sizes. Therefore, the variance σ2 is interpreted as the natural individual variation,
which should have nothing to do with the treatments and should therefore be the
same in all groups. Actually, the assumption of equal sizes can be relaxed without
much trouble, but we will not consider that case here.
The hypotheses of interest are
H0 : μ1 = . . . = μk
versus HA : μi1 /= μi2 for some i1 and i2
Now, we can obtain k independent estimators of the unknown variance as
s2
i =
1
n −1
n

j=1
(Xij −¯Xi·)2
i = 1, . . . , k
where
¯Xi· = 1
n
n

j=1
Xij
Since they are all based on samples of size n, they can be pooled together as
s2
W = 1
k
k

i=1
s2
i =
1
k(n −1)
k

i=1
n

j=1
(Xij −¯Xi·)2
(7.3)
which is the within-group variance. If the null hypothesis is true, we can regard
the sample means ¯X1·, . . . , ¯Xk· as a normally distributed sample with mean μi and

410
LINEAR MODELS
variance σ2/n. This means that we can get a second estimator of σ2 as
s2
B =
n
k −1
k

i=1
( ¯Xi· −¯X)2 =
1
k −1
k

i=1
n

j=1
( ¯Xi· −¯X)2
(7.4)
where
¯X = 1
k
k

i=1
¯Xi· = 1
nk
k

i=1
n

j=1
Xij
is the total sample mean. This is usually called the between-group variance.
The within-group variance s2
W is always an unbiased estimator of σ2 whereas the
same holds for s2
B only if the null hypothesis is true. If the alternative hypothesis is
true, it is possible to show that E[s2
B] > σ2 (see Problem 37), so we should reject H0
if s2
B is signiﬁcantly larger than s2
W or, equivalently, if the test statistic
F = s2
B
s2
W
is large enough. It turns out that s2
W and s2
B are independent and chi-square distributed
with k −1 and k(n −1) degrees of freedom, respectively, under this model, which
means that F ∼Fk−1,k(n−1) and that critical values can be obtained from Table A.5.
In classical ANOVA notation, the sums in (7.3) and (7.4) and the total variation
are denoted
SSA =
k

i=1
n

j=1
( ¯Xi· −¯X)2
SSE =
k

i=1
n

j=1
(Xij −¯Xi·)2
SST =
k

i=1
n

j=1
(Xij −¯X)2
where it can be shown that
SST = SSA + SSE
The SS in the notation stands for Sum of Squares with T for Total, E for Error, and A
for treatment A.4 The variance estimators above are also referred to as Mean Squares
and denoted MSA and MSE, respectively. The result of an analysis of variance is
4In higher order ANOVA, combinations of several different treatments (usually denoted A, B, C, and so
on) can be studied and corresponding sum of squares computed. Although only one treatment is considered
in one-way ANOVA, it is often called treatment A.

ANALYSIS OF VARIANCE
411
TABLE 7.1
An ANOVA Table for a One-Way Analysis of Variance
Source
DF
Sum of Squares
Mean Square
F-Statistic
Treatment A
k −1
SSA
MSA = SSA
k −1
F = MSA
MSE
Error
k(n −1)
SSE
MSE =
SSE
k(n −1)
Total
kn −1
SST
often summarized in an ANOVA table, whose structure is illustrated, for a one-way
ANOVA, in Table 7.1. Sometimes, the p-value for the F test is also included in the
table.
Example 7.8. In2010,alargefarmingexperimentwascarriedoutinsouthernSweden,
where nine different varieties of canned peas were grown in ﬁve ﬁelds each. After
harvest, the yield in metric tonnes per hectare was measured and the results were the
following.
Variety
Yields
Mean Yield
Variance
A
3.18
3.33
3.87
5.27
5.58
4.25
1.24
B
2.17
4.55
4.60
5.15
5.61
4.42
1.77
C
2.84
3.61
4.57
4.69
5.00
4.14
0.80
D
4.52
4.74
5.74
5.93
6.18
5.42
0.55
E
3.12
3.13
4.38
4.60
4.88
4.02
0.70
F
1.81
2.83
3.11
3.80
4.25
3.16
0.88
G
1.94
2.72
2.80
2.94
3.56
2.79
0.34
H
1.75
2.45
3.10
3.63
3.92
2.97
0.78
I
3.23
3.94
4.01
4.30
4.35
3.97
0.20
We see that the best variety D yields about twice as much as the worst variety G on
average, but we also see that there is a large variation between the ﬁelds probably due
to quality of soil, climatic conditions, drainage, and so on. Let us see if an analysis of
variance can determine whether there is any difference between the varieties of peas.
Since the total mean is ¯X = 3.90, we can use Corollary 6.1 to calculate the variety
sum of squares as
SSA =
9

i=1
5

j=1
( ¯Xi· −¯X)2 = 5 ×
 9

i=1
¯X2
i· −9 ¯X2

= 27.10
and the total sum of squares as
SST =
9

i=1
5

j=1
(Xij −¯X)2 =
9

i=1
5

j=1
X2
ij −45 ¯X2 = 56.13

412
LINEAR MODELS
TABLE 7.2
The ANOVA Table for Example 7.8
Source
DF
Sum of Squares
Mean Square
F-Statistic
P-Value
Variety
8
27.10
3.39
4.20
0.001
Error
36
29.03
0.81
Total
44
56.13
which yields the error sum of squares SSE = 56.13 −27.10 = 29.03.5 Now we get
the mean squares as
MSA = SSA
k −1 = 27.10
8
= 3.39
MSE =
SSE
k(n −1) = 29.03
36
= 0.81
which yields the test statistic
F = MSA
MSE = 3.39
0.81 = 4.20
The 95% percentile of the F distribution with 8 and 36 degrees of freedom is 2.21,
which means that we can reject the null hypothesis on the 5% level and claim that the
nine varieties vary in yield. The ANOVA is summarized in Table 7.2.
□
7.5.2
Multiple Comparisons: Tukey’s Method
Suppose that we have managed to reject the null hypothesis of equal means, as in
Example 7.8, in an ANOVA. The next natural question is then: Which group or groups
differ from the rest and how much? In this section, we will present the most common
method of making pairwise comparisons between groups such that the joint level of
signiﬁcance is correct, the so-called Tukey’s method.6
It is based on the following distribution.
Deﬁnition 7.5. Let X1, . . . , Xn be a normally distributed sample with mean μ and
variance σ2 and let s2 be an estimator of σ2 such that
ms2
σ2 ∼χ2
m
Then
Rn,m = X(n) −X(1)
s
follows the studentized range distribution with n and m degrees of freedom.
5This is the usual order of calculations since SSA and SST are both easier to calculate than SSE.
6Named after the American chemist and mathematician John Tukey (1915–2000).

ANALYSIS OF VARIANCE
413
The cdf can be expressed as an integral in terms of the t distribution and can, unfor-
tunately, be calculated only numerically. Pairwise conﬁdence intervals can now be
obtained as follows.
Proposition 7.14.
Let {Xij : i = 1, . . . , k; j = 1, . . . , n} be independent random
variables such that Xij ∼N(μi, σ2). Then
μi1 −μi2 = ¯Xi1· −¯Xi2· ± r sW
√n
are pairwise conﬁdence intervals for i1 = 1, . . . , k and i2 = 1, . . . , k, where i1 /= i2,
with joint conﬁdence level q, where s2
W is deﬁned in (7.3) and FRk,k(n−1)(r) = q.
Table A.6 gives 95% percentiles of the studentized range distribution.
Example 7.9. In Example 7.8, we had k = 9 and n = 5, which yields the critical value
r = 4.66. Using the within-group variation s2
W = MSE = 0.81 gives us the statistical
error
r sW
√n = 4.66 ×

0.81
5
= 1.87
When we compare all group means, we ﬁnd that only the three intervals
μD −μF = 5.42 −3.16 ± 1.87 = 2.26 ± 1.87
μD −μG = 5.42 −2.79 ± 1.87 = 2.63 ± 1.87
μD −μH = 5.42 −2.97 ± 1.87 = 2.45 ± 1.87
do not contain the value zero. Hence, we can conclude, with 95% conﬁdence, that
variety D has a mean yield larger than varieties F, G, and H.
□
7.5.3
Kruskal–Wallis Test
If the assumption of normally distributed samples with equal variances is not satisﬁed,
there is an alternative approach called Kruskal–Wallis test,7 which is based on ranks
like the Wilcoxon rank sum test introduced in Section 6.9.2 but using the ANOVA
method of comparing sources of variation. The ﬁrst step is to rank the values in all
7Named after the American mathematician William Kruskal (1919–2005) and economist W. Allen Wallis
(1912–1998).

414
LINEAR MODELS
samples combined. If we denote the rank of observation Xij by Rij, the test statistic
is deﬁned as
K = (kn −1)
k

i=1
n

j=1
( ¯Ri· −¯R)2
k

i=1
n

j=1
(Rij −¯R)2
(7.5)
where ¯R is the mean of all ranks and ¯Ri· is the mean rank of group i. Note that the
enumerator and denominator in (7.5) correspond to SSA and SST, respectively, in
the one-way ANOVA. This means that we would expect a larger variation in mean
ranks ¯Ri· if the group means are different and, consequently, should reject the null
hypothesis if the test statistic K is large enough. If there are no ties, it is possible to
simplify (7.5) (see Problem 38) as
K =
12
kn2(kn + 1)
k

i=1
R2
i· −3(kn + 1)
(7.6)
where Ri· = n
j=1 Rij are the group rank sums. In most textbooks on statistics, K
d≈
χ2
k−1 is often used to obtain critical values and p-values for the Kruskal–Wallis test.
However, this approximation is not very accurate for small n, especially if k is large.
The problem is that it is virtually impossible to calculate the exact distribution of K
(except for really small n and k) due to the enormous number of combinations of ranks
that has to be considered. In Table A.11, estimates of 95% percentiles are presented
based on simulation methods like those presented in Section 6.4.3. Therefore, these
values may not all be accurate down to the last decimal, but they at least give better
critical values than the chi-square approximation.
Example 7.10. There were some irregularities like different variances in the data in
Example 7.8 suggesting that the conditions for carrying out an ANOVA may not have
been met completely. Let us therefore apply the Kruskal–Wallis test to the data and
see if we get a similar result. We ﬁrst rank all 45 observations as follows.
Variety
Ranks
Rank Sum
A
15
17
22
40
41
135
B
4
31
33.5
39
42
149.5
C
9
19
32
35
38
133
D
30
36
43
44
45
198
E
13
14
29
33.5
37
126.5
F
2
8
12
21
26
69
G
3
6
7
10
18
44
H
1
5
11
20
23
60
I
16
24
25
27
28
120

LINEAR REGRESSION
415
Note that we have one tie in the value 4.60 that occurs twice in the table and, conse-
quently, gets the midrank 33.5. This means that (7.6) does not give the correct value
of K and that we should use (7.5) instead. In practice, (7.6) is actually used any-
way because as long as there are not too many ties, the error is really negligible. In
this case, (7.5) gives the (correct) value K = 22.196 while (7.6) gives K = 22.194.
The critical value for k = 9 and n = 5 on the 5% level is 14.62 according to Table
A.11, which means that we can still reject the null hypothesis. In fact, the p-value
can be calculated to 0.0009, which is quite similar to the corresponding value in the
traditional ANOVA in Example 7.8.
□
7.6
LINEAR REGRESSION
The world is full of linear relationships. When measurements are taken, observations
seldom lie on a straight line, though, as a result of measurement error and other
random effects. In Section 3.8, we learned how the correlation coefﬁcient can be used
to describe the degree of linearity in a relationship between two random variables,
and in Section 3.9, we saw that if X and Y are bivariate normal, there is a linear
relationship between them in the sense that the conditional expectation of Y given
X is a linear function of X. In this section, we will investigate a similar model but
assume that only Y is random. For ﬁxed x, we assume that
Y = a + bx + ϵ
where a and b are constants and
ϵ ∼N(0, σ2)
This means that deviations from the line y = ax + b are normally distributed random
variables, and an equivalent formulation is
Y ∼N(a + bx, σ2)
We call this the simple linear regression model, and the line y = a + bx is called the
regression line. The x values can be chosen by us or come from observations, but
we think of them as ﬁxed, not random. For each x value, the corresponding Y value
is measured, where we assume that consecutive Y values are independent random
variables. Thus, we have the x values x1, . . . , xn, get a sample Y1, . . . , Yn, where
Yk = a + bxk + ϵk ∼N(a + bxk, σ2)
(7.7)
and our main objective is to estimate the intercept a and slope b. Note that the Yk are
independent but do not have the same distribution. With a slight modiﬁcation of the
maximum-likelihood method, we can still deﬁne the likelihood function as
L(a, b) =
n

k=1
fa,b(Yk)

416
LINEAR MODELS
where
fa,b(Yk) =
1
σ
√
2π
e−(Yk−a−bxk)2/2σ2
and we can maximize over a and b in the usual way by taking logarithms and setting
the partial derivatives to 0. The resulting estimators are stated next, leaving the proof
for the Problems section.
Proposition 7.15. In the linear regression model, the maximum-likelihood estima-
tors of a and b are
b =
n

k=1
(xk −¯x)(Yk −¯Y)
n

k=1
(xk −¯x)2
a = ¯Y −b¯x
The line y = a + bx is the estimated regression line (or simply the regression line if
there is no risk of confusion). There are different ways to rewrite the expression for
b. We introduce one, which is suitable for computations.
Corollary 7.7. Deﬁne the sums
Sxx =
n

k=1
(xk −¯x)2 =
n

k=1
x2
k −1
n
 n

k=1
xk
2
SxY =
n

k=1
(xk −¯x)(Yk −¯Y) =
n

k=1
xkYk −1
n
 n

k=1
xk
  n

k=1
Yk

Then
b = SxY
Sxx
Example 7.11. Let us look at a famous data set, Edwin Hubble’s 1929 investigation of
the relationship between a galaxy’s distance from Earth and its recession velocity (see
also Example 3.44). He got the following 24 pairs of observations, where x values are

LINEAR REGRESSION
417
distances in megaparsecs and Y values are the corresponding velocities in kilometers
per second. Find the estimated regression line.
Distance: 0.032, 0.034, 0.214, 0.263, 0.275, 0.275, 0.45, 0.5, 0.5, 0.63
0.8, 0.9, 0.9, 0.9, 0.9, 1.0, 1.1, 1.1, 1.4, 1.7, 2.0, 2.0, 2.0, 2.0
Velocity: 170, 290, −130, −70, −185, −220, 200, 290, 280, 200, 300 −30
650, 150, 500, 920, 450, 500, 500, 960, 500, 850, 800, 1090
Computation of these sums gives
24

k=1
xk = 21.87,
24

k=1
Yk = 8965,
24

k=1
x2
k = 29.52,
24

k=1
xkYk = 12, 519
and
Sxx = 29.52 −21.872
24
= 9.583
SxY = 12, 519 −21.87 × 8965
24
= 4348
which gives
b = 4348
9.583 = 454
a = 8965
24
−454 × 21.87
24
= −40.0
and the regression line is y = −40.0 + 454x, which is shown together with the data
set in Figure 7.3. Note how the line intersects the y-axis very close to the origin. Why
do you think this is the case?
□
If you are familiar with the method of least squares, you may have noticed that the
estimated regression line is precisely the line that least-squares ﬁtting gives. (Why
is this?) Our assumption of normally distributed errors enables us to further ana-
lyze the estimated regression line. Let us investigate properties of our estimators a
and b. Since the xk are ﬁxed, the only randomness is in the Yk, and since both a
and b are linear combinations of the normally distributed Yk, the estimators them-
selves must be normal. It is straightforward to compute their means and variances
(see Problem 39).

418
LINEAR MODELS
0
0.5
1
1.5
2
−500 
0 
500 
1000 
1500 
FIGURE 7.3
Plot of Hubble’s galaxy data and the estimated regression line. Distance is on
the x-axis and recession velocity on the y-axis.
Corollary 7.8. The estimators a and b have normal distributions with means and
variances
E[a ] = a,
Var[a ] =
σ2
n

k=1
x2
k
nSxx
E[b ] = b,
Var[b ] =
σ2
Sxx
In particular, Corollary 7.8 tells us that both a and b are unbiased estimators and that
a −a

Var[a ]
∼N(0, 1)
and
b −b

Var[b ]
∼N(0, 1)
(7.8)
where the variances depend on σ2, which must thus be estimated. The following
estimator is used.
Proposition 7.16. In the linear regression model, the estimator
s2 =
1
n −2
n

k=1
(Yk −a −bxk )2
is an unbiased estimator of σ2.

LINEAR REGRESSION
419
Note how this resembles the sample variance from Section 6.2, in the sense that it sums
the squares of the observations minus their estimated expected values. Since there are
two estimated parameters, we divide by n −2 instead of n. Another similarity is that
s2 is not the MLE; the MLE is obtained by dividing by n rather than n −2. For
practical calculations, the following result is useful.
Corollary 7.9. Deﬁne the sum
SYY =
n

k=1
(Yk −¯Y)2 =
n

k=1
Y2
k −1
n
 n

k=1
Yk
2
Then
s2 =
1
n −2

SYY −S2
xY
Sxx

For inference about σ2, we need the distribution of s2. In the light of Proposition 7.4,
the following is to be expected.
Proposition 7.17. In the linear regression model,
(n −2)s2
σ2
∼χ2
n−2
a chi-squared distribution with n −2 degrees of freedom.
Note how this follows the by now familiar pattern; the number of degrees of freedom
equals the number of terms in the sum, minus the number of estimated parameters.
Conﬁdence intervals for σ2 can now be derived on the basis of the chi-square distri-
bution (see Problem 50).
As we might expect, if the estimator s replaces σ in the expressions in Equa-
tion (7.8), we get t distributions with n −2 degrees of freedom instead of normal
distributions. Recalling the computational formulas above, we have
Ta = a −a
s

nSxx
n
k=1 x2
k
∼tn−2
Tb =
b −b
s

Sxx ∼tn−2
which gives us the following conﬁdence intervals.

420
LINEAR MODELS
Corollary 7.10. In the linear regression model with unknown variance σ2, conﬁ-
dence intervals for a and b with conﬁdence level q are given by
a = a ± ts
n
k=1 x2
k
nSxx
(q)
b = b ± ts
1
√Sxx
(q)
where Ftn−2(t) = (1 + q)/2.
Example 7.12. Find 95% conﬁdence intervals for a and b in Hubble’s galaxy data.
From Example 7.11, we have a = −40.0, b = 454, 
k x2
k = 29.52, 
k Yk = 8965,
Sxx = 9.583, SxY = 4348, and n = 24. We also need 
k Y2
k = 6, 516, 925 to calcu-
late
SYY = 6, 516, 925 −89652
24
= 3, 168, 124
Now, we get the sample variance as
s2 = 1
22

3, 168, 124 −43482
9.583

= 54, 328
which gives s = 233. With q = 0.95 and n −2 = 22, we get t = 2.07. The conﬁdence
intervals are
a = −40.0 ± 2.07 × 233

29.52
24 × 9.583 = −40.0 ± 173 (0.95)
b = 454 ± 2.07 × 233
1
√
9.583
= 454 ± 156
(0.95)
Note that the intervals are quite wide; in particular, the one for a is all over the place.
Two cautious conclusions we can draw are that b is positive and that we cannot rule
out that a = 0 (which, of course, makes sense).
□
As you know by now, the step from conﬁdence intervals to hypothesis tests is not
big. Since the quantities Ta and Tb given above have known distributions, we can
construct tests of the null hypotheses
H0 : a = a0
and
H0 : b = b0
based on the test statistics Ta and Tb, where we set a = a0 and b = b0. If the alterna-
tives are two-sided, we reject on level α if |Ta| ≥t and |Tb| ≥t, respectively, where

LINEAR REGRESSION
421
Ftn−2(t) = 1 −α/2. For one-sided tests, the usual adjustments are made, using 1 −α
instead of 1 −α/2.
Example 7.13. The Old Faithful geyser (see Problem 111 in Chapter 3) is a rich source
of data. Two quantities that are routinely measured are the times between eruptions
(typically 30–120 min) and the length of eruptions (1–5 min). It is known that these are
positively correlated, and the Yellowstone park rangers use a formula that is roughly
y = 13x + 30 to predict the time y until the next eruption, based on the length x of
the most recent eruption. (Source: The Geyser Observation and Study Association,
www.geyserstudy.org.) Assume a linear regression model and estimate the regression
line based on the following 20 observations, and also test whether the slope 13 is
correct:
Length: 1.7, 1.7, 1.7, 1.8, 2.3, 3.1, 3.4, 3.5, 3.7, 3.9, 3.9, 4.0, 4.0, 4.0, 4.1, 4.3
4.4, 4.6, 4.7, 4.9
Time:
55, 58, 56, 42, 50, 57, 75, 80, 69, 80, 74, 68, 76, 90, 84, 80, 78, 74, 76, 76
To compute the estimators, we need the usual sums 
k xk = 69.7, 
k Yk = 1398,

k x2
k = 264.65, and 
k xkYk = 5083.1, which with n = 20 gives us
Sxx = 264.65 −69.72
20
= 21.75
SxY = 5083.1 −69.7 × 1398
20
= 211.1
Now, we get the estimators
b = 211.1
21.75 = 9.71
a = 1398
20
−9.7169.7
20 = 36.1
which gives the regression line y = 9.71x + 36.1. To test
H0 : b = 13
versus
HA : b /= 13
on level 0.05, we have n −2 = 18 and 1 −0.05/2 = 0.975 and reject if |Tb| ≥2.10,
where b = 13. We ﬁrst need 
k Y2
k = 100, 768 and
SYY = 100, 768 −13982
20
= 3048
to compute
s2 = 1
18

3048 −211.12
21.75

= 55.5

422
LINEAR MODELS
0
2
4
6
20
40
60
80
100
FIGURE 7.4
The Old Faithful data with the regression line (solid) and the rangers’ line
(dashed).
which gives s = 7.45 and test statistic
Tb = 9.71 −13
7.45
√
21.75 = −2.06
and we cannot reject H0, although it is close. The rangers know what they are doing
and, of course, base their estimates on much larger data sets than our 20 observations.
See Figure 7.4 for the data and the two lines.
□
7.6.1
Prediction
In the previous problem, it was mentioned that one variable (length of last eruption) is
used to predict another (time until next eruption). Generally, in the linear regression
model, if we observe or choose x, what can we say about Y? We know that the mean
of Y is E[Y] = a + bx, which we estimate by a + bx, and we can use this estimator
as a predictor of Y (recall Section 3.7.2). How good is it? The difference between the
true value Y and the predicted value a + bx is
D = Y −a −bx = Y −¯Y + b(x −¯x)
Note here that ¯x, ¯Y, and b are computed from the observations (x1, Y1), . . . , (xn, Yn),
x is our new observed x value, and Y the yet unobserved value that we are trying to
predict. Clearly, E[D] = 0, and for the variance, note that Y is independent of ¯Y and
b. It is also easy to show that ¯Y and b are uncorrelated (see Problem 40) and hence
Var[D] = Var[Y] + Var[ ¯Y] + (x −¯x)2Var[b ]
= σ2 + σ2
n + (x −¯x)2σ2
Sxx
.

LINEAR REGRESSION
423
Moreover, since D is a linear combination of normal distributions, it is normal with
mean 0 and the variance given above. Hence, D/√Var[D] ∼N(0, 1), and estimating
σ2 by s2 and using the computational formula for the sum of squares gives
T =
D
s

1 + 1
n + (x −¯x)2
Sxx
∼tn−2
a t distribution with n −2 degrees of freedom. Thus, we can ﬁnd t such that
P(−t ≤T ≤t) = q for our desired q, and since D = Y −a −bx we get the fol-
lowing prediction interval (see also Problem 19).
Corollary 7.11. Consider the linear regression model with estimators a and b. If
x has been observed, a 100q% prediction interval for the corresponding Y value is
given by
Y = a + bx ± ts

1 + 1
n + (x −¯x)2
Sxx
where Ftn−2 = (1 + q)/2.
Note the difference between a prediction interval and a conﬁdence interval. A pre-
diction interval captures the next Y value for a given x value; a conﬁdence interval
captures the long-term average of a large number of Y values for a given x value.
A conﬁdence interval for the expected value of Y for a given x would thus look
somewhat different (see Problem 48).
Note the length of the prediction interval increases with increasing (x −¯x)2, that
is, the farther away the chosen x value is from ¯x. This reﬂects the fact that our
estimated regression line is most reliable near ¯x. Indeed, for an x far outside the range
of our original x1, . . . , xn, the prediction is highly uncertain and should preferably
be avoided.
Example 7.14. Consider the Old Faithful example and suppose that we just observed
an eruption that lasted for 1.5 min. Find the predicted time until the next eruption
and a 95% prediction interval.
The estimated regression line is y = 9.71x + 36.1, so with x = 1.5 we get pre-
dicted y value 9.71 × 1.5 + 36.1 = 50.6. For the prediction interval, we have n = 20,
t = 2.10, s = 7.5, ¯x = 69.7/20 = 3.5, and Sxx = 21.75. We get
Y = 50.6 ± 2.10 × 7.5

1 + 1
20 + (1.5 −3.5)2
21.75
= 50.6 ± 17.5 (0.95)
□

424
LINEAR MODELS
7.6.2
Goodness of Fit
To determine whether the linear regression model is reasonable, it is useful to examine
the difference between the observed Y values and those predicted by the estimated
regression line. The deviations
Ek = Yk −a −bxk, k = 1, . . . , n
are called the residuals. Do not confuse the Ek and the ϵk from above; Ek is the
difference between the observed Y value and the estimated line a + bxk, whereas
ϵk is the difference between the observed Y value and the true line a + bxk, so we
can think of Ek as a predictor of ϵk. If the residuals are plotted against the x values,
they should appear more or less randomly scattered and not display any discernible
patterns, if the model is correct. In Figure 7.5a, the residuals for Hubble’s galaxy data
are plotted, and they look just ﬁne. In contrast, consider plot (b) where the residuals
tend to be below 0 at the ends and above in the middle, indicating a nonlinear relation.
Finally, in (c), the residuals tend to increase in magnitude with increasing x, indicating
that the variance is not constant but depends on x. The plots in (b) and (c) illustrate
the two most common deviations from the linear regression model. Try to ﬁgure out
how the data set together with the estimated regression line would look in these two
cases.
Plotting the residuals provides a quick diagnostic tool to assess whether the as-
sumed linear model is reasonable. For a more detailed analysis, it should be noted that
the residual Ek has mean 0 and a variance that depends on k. If the residuals are divided
by their estimated standard deviations, these are called the standardized residuals. If
the model is correct, the standardized residuals are approximately independent and
N(0, 1), which can be used for further analysis.
The situation with nonconstant variance is common and may be modeled by
weighted linear regression, letting Y = a + bx + ϵ where ϵ ∼N(0, w(x)σ2), where
the w(x) are weights depending on x.
It is also possible to apply the ANOVA method of comparing sources of variation
to quantify the goodness of ﬁt. The residuals deﬁned above can be used to obtain the
0 
0 
0 
(a)
(b)
(c)
FIGURE 7.5
Three residual plots. In (a), the residuals for Hubble’s galaxy data are plotted
and give no reason to suspect that the model is wrong. In (b), the “banana shape” indicates a
nonlinear relationship, and in (c), the residuals indicate a nonconstant variance.

LINEAR REGRESSION
425
error sum of squares as
SSE =
n

k=1
(Yk −a −bxk)2 = SYY −S2
xY
Sxx
and the total sum of squares is deﬁned in a similar way as in Section 7.5 as
SST =
n

k=1
(Yk −¯Y)2 = SYY
The difference between the total variation and the random variation
SSR = SST −SSE = S2
xY
Sxx
denoted regression sum of squares can be interpreted as the amount of variation that
can be explained by the regression model. Hence, the larger the SSR in relation to
the SSE, the better because then the points will lie close to the estimated regression
line and we will be able to predict Y values with high accuracy. The proportion of
variation explained by the model, named coefﬁcient of determination and deﬁned as
R2 = 1 −SSE
SST =
S2
xY
SxxSYY
is the most common way of quantifying the goodness of ﬁt of a regression model.
Example 7.15. The coefﬁcient of determination for the regression model for Hubble’s
data is
R2 =
43482
9.583 × 3, 168, 124 = 0.62
which means that most of the variation, roughly 60%, can be explained by the esti-
mated linear relationship. The Old Faithful analysis yields a coefﬁcient of determi-
nation of
R2 =
211.12
21.75 × 3048 = 0.67
which is even better with two-thirds of the variation explained.
□
7.6.3
The Sample Correlation Coefﬁcient
The simple linear regression model is useful, as we have seen, when we want to
estimate the linear relationship between two measured quantities and make predic-
tions about new observations. Sometimes, we are merely interested in estimating the
strength of the connection between two variables and test whether it exists. This can
be done if we assume that data can be regarded as observations from the sample

426
LINEAR MODELS
of pairs (X1, Y1), . . . , (Xn, Yn) and consider the correlation coefﬁcient ρ, which we
recall is deﬁned as
ρ = E[(X −μ1)(Y −μ2)]
√Var[X]Var[Y]
Note that we regard both variables as random in this context while the x variables
previously were ﬁxed. The difference lies mainly in the assumption of a causal re-
lationship in the simple linear regression model. By making Y random and x ﬁxed,
we are implicitly assuming that the value of x have a direct impact on the value of Y.
Here, we just claim that the two variables are connected and say nothing about the
direction of inﬂuence. It may even be the case that both variables are affected by a
third variable not included in the model and not directly linked at all.
Anyway, the following estimator should make intuitive sense.
Deﬁnition 7.6. If (X1, Y2), . . . , (Xn, Yn) is a sample from a bivariate distribution,
we deﬁne the sample correlation coefﬁcient as
R =
n

k=1
(Xk −¯X)(Yk −¯Y)




n

k=1
(Xk −¯X)2
n

k=1
(Yk −¯Y)2
=
SXY
√SXXSYY
We use the term “sample correlation coefﬁcient” to point out the analogy with sample
mean and sample variance. If you wish to memorize a longer name, the term product
moment correlation coefﬁcient is also used.8 Note that the square of the sample corre-
lation coefﬁcient is actually the same as the coefﬁcient of determination introduced in
Section 7.6.2, which further emphasizes the link between regression and correlation.
Example 7.16. Below is a data set of 10 observations of the daily closing prices
for the two U.S. stock market indices, Dow Jones Industrial Average and Nasdaq
Composite Index, chosen at random from among the years of 1971 and 2003, rounded
to the nearest integer (and listed in chronological order). Estimate the correlation
coefﬁcient of X and Y.
Dow:
887, 833, 821, 961, 1259, 2176, 2820, 3442, 7289, 10715
Nasdaq: 108, 86, 74, 95, 283, 352, 430, 696, 1228, 2028
8Sometimes, it is also preﬁxed with Pearson’s to honor its discoverer, English statistician Karl Pearson
(1857–1936), one of the founders of the theory of statistics.

LINEAR REGRESSION
427
This is merely an exercise in computing the sums needed. Thus, we have
10

k=1
Xk = 31203,
10

k=1
Yk = 5380
10

k=1
X2
k = 1.97 × 108,
10

k=1
Y2
k = 6.53 × 106
and ﬁnally
10

k=1
XkYk = 3.57 × 107
This gives us the sum of squares
SXX = 1.97 × 108 −312032
10
= 9.98 × 107
SYY = 6.53 × 106 −53802
10
= 3.63 × 106
SXY = 3.57 × 107 −31203 × 5380
10
= 1.89 × 107
Inserting these in the expression for R from Deﬁnition 7.6 yields
R =
1.89 × 107

(9.98 × 107) × (3.63 × 106)
= 0.995
which is a very high correlation. For comparison, consider the following 10 pairs of
closing prices, chosen at random from the year 1971 only (the year that the Nasdaq
index was started).
Dow:
941, 947, 889, 874, 850, 908, 888, 798, 829, 873
Nasdaq: 104, 104, 114, 110, 105, 110, 108, 106, 109, 105
This time the estimated correlation is R = −0.14, which is not only much smaller
in magnitude but also negative. The reason for the difference in correlation is the
relatively stable growth of the markets over a long period, such as the 32 years we
ﬁrst sampled from, but less stable behavior over a shorter period, such as a single
year. Since both indices mirror the market as a whole but are compiled from different
sets of stocks, we would expect their correlation to be positive and high for longer
periods of time, but for shorter periods of time, the correlation could be anything. The
two data sets are plotted in Figure 7.6. See also Problem 51.
□

428
LINEAR MODELS
800
850
900
950
100 
105 
110 
115 
120 
0
5000
10000
15000
0 
500 
1000 
1500 
 2000 
2500 
FIGURE 7.6
Plots of Dow (x-axis) versus Nasdaq (y-axis) for 10 randomly sampled days
during 1971–2003 (left) and 1971 (right).
The most common test problem regarding the correlation coefﬁcient is to test if ρ = 0,
if there is an association between the random variables X and Y, and intuitively the
test should be based on how far R is from 0. In general, we cannot ﬁnd the distribution
of R but if our data are from a bivariate normal distribution with ρ = 0, the following
result gives the exact distribution for a particular function of R, which we can use to
construct our test procedure.9
Proposition 7.18. Let (X1, Y1), . . . , (Xn, Yn) be a sample from a bivariate normal
distribution with ρ = 0, and let
T = R

n −2
1 −R2
Then
T ∼tn−2
a t distribution with n −2 degrees of freedom.
The test procedure is now straightforward. If R = 0, then also T = 0, and as R in-
creases from −1 to 1, T increases from −∞to ∞. Thus, we reject H0 if T is too far
from 0. Let us state this formally.
Proposition 7.19. Let (X1, Y1), . . . , (Xn, Yn) be a sample from a bivariate normal
distribution where we wish to test
H0 : ρ = 0 versus HA : ρ /= 0
9The result in Proposition 7.18 actually requires only that Y be normal; in fact, X does not even have to
be random.

LINEAR REGRESSION
429
The test is based on the statistic T above, and we reject H0 on level α if
|T| ≥c
where Ftn−2(c) = 1 −α/2.
If we want to test against a one-sided alternative instead, for example, with the inten-
tion of showing a positive (or negative) correlation, we reject if T ≥c (or T ≤−c),
where Ftn−2(c) = 1 −α. Note that since we assume that X and Y are bivariate normal,
a test of ρ = 0 is in fact a test for independence.
Example 7.17. Use the two data sets from Example 7.16 to test whether the Dow
and Nasdaq indices are correlated. Test on the 5% level.
We test
H0 : ρ = 0 versus HA : ρ /= 0
where we choose a two-sided alternative since we are not testing for any particular
direction of the correlation (although the one-sided alternative ρ > 0 would also make
sense). Let us ﬁrst ﬁnd the critical value. We have n = 10, and with α = 0.05, we get
Ft8(t) = 0.95, which gives t = 2.31 so that H0 is rejected if |T| ≥2.31. In the ﬁrst
data set we have R = 0.995, which gives
T = 0.995

8
1 −0.9952 = 28.1
and we reject H0. In the second data set, we have R = −0.14, which gives
T =
8 × (−0.14)

1 −(−0.14)2 = −0.40
and we cannot reject H0. The negative correlation for the short time period is not
signiﬁcant.
□
If we wish to test ρ = ρ0 for some ρ0 /= 0, we cannot use T. Also, if we wish to ﬁnd
a conﬁdence interval for ρ, we cannot use T, either. The problem with T is that it
does not include the unknown parameter ρ, which would be necessary for both these
tasks. In these cases an approximation can be used, as described in Problem 53.
7.6.4
Spearman’s Correlation Coefﬁcient
If data cannot be assumed to be normal, which is often the case with market data
such as the above, there is an alternative approach called Spearman’s correlation

430
LINEAR MODELS
coefﬁcient10 based on ranks similar to the methods in Section 6.9. The idea is quite
simple as in many nonparametric procedures.
Deﬁnition 7.7. If (X1, Y2), . . . , (Xn, Yn) is a sample from a bivariate distribution,
we deﬁne Spearman’s correlation coefﬁcient as
RS =
n

k=1
(rk −¯r)(sk −¯s)




n

k=1
(rk −¯r)2
n

k=1
(sk −¯s)2
=
Srs
√SrrSss
where rk is the rank of Xk among X1, . . . , Xn and sk is the rank of Yk among
Y1, . . . , Yn.
If there are no ties in the data, the formula in Deﬁnition 7.7 can be simpliﬁed quite
considerably.
Proposition 7.20.
If there are no ties, Spearman’s correlation coefﬁcient can be
expressed as
RS = 1 −
6
n(n2 −1)
n

k=1
(rk −sk)2
Hence, what you do is rank the X and Y observations separately, sum the squared
differences, and use the formula in Proposition 7.20. It also turns out that it is possible
to test the hypothesis H0 : ρ = 0 using the same test statistic and t distribution as
above, only that the result is approximate
T = RS

n −2
1 −R2
S
d≈tn−2
for large n.
Example 7.18. Let us return to Example 7.16 and calculate Spearman’s correlation
coefﬁcient for the two data sets. When ranking the two sets of observations from the
period 1971–2003, we get that
10Named after the English psychologist Charles Spearman (1863–1945).

THE GENERAL LINEAR MODEL
431
Dow:
887
833
821
961
1259
2176
2820
3442
7289
10715
Rank:
3
2
1
4
5
6
7
8
9
10
Nasdaq:
108
86
74
95
283
352
430
696
1228
2028
Rank:
4
2
1
3
5
6
7
8
9
10
Since the ranks only differ in two positions and by only one unit, we get the sum of
squared differences 
k(rk −sk)2 = 2 and the correlation coefﬁcient
RS = 1 −
6
10 × 99 × 2 = 0.988
which is quite close to the previous result.
When looking at the data from 1971, we discover several ties for the Nasdaq data
set and have to use midranks.
Dow:
941
947
889
874
850
908
888
798
829
873
Rank:
9
10
7
5
3
8
6
1
2
4
Nasdaq:
104
104
114
110
105
110
108
106
109
105
Rank:
1.5
1.5
10
8.5
3.5
8.5
6
5
7
3.5
Unfortunately, this means that the formula in Proposition 7.20 does not yield an
accurate value, so here we have to use the more complicated one in Deﬁnition 7.7.
After some standard calculations, we reach the result RS = −0.17, which is also quite
close to the previous estimate.
□
7.7
THE GENERAL LINEAR MODEL
When comparing the one-way ANOVA model of Section 7.5 with the simple linear
regression model of Section 7.6, we notice some common features. In both cases,
observations are assumed to be normally distributed random variables where the
means are described by deterministic parametric linear functions. Any model that
satisﬁes these requirements is called a General Linear Model,11 or GLM for short,
which is really a large class of models with tremendous importance in many statistical
applications. We will not expand this rich ﬁeld here but rather offer a brief outline to
give some feeling of the kind of problems addressed and methods used.
We begin with the formal deﬁnition, which is most conveniently expressed in
matrix notation.
11Not to be confused with the even larger class Generalized Linear Model, usually abbreviated GLIM, also
covering other distributions like the binomial and Poisson distributions.

432
LINEAR MODELS
Deﬁnition 7.8. Let Y be a n × 1 vector of random variables, X a n × k matrix with
known entries, β a k × 1 parameter vector and ϵ ∼Nn(0, 
). The General Linear
Model satisﬁes
Y = Xβ + ϵ
The matrix X is usually called the design matrix because it deﬁnes the design of the
model, that is, how the unknown parameters in β are linked to the observed values in
Y.
Using standard linear algebra, the GLM can also be expressed
Yi =
k−1

j=0
xijβj + ϵi,
i = 1, . . . , n
(7.9)
where Yi, βj, and ϵi are the components of the vectors Y, β, and ϵ, respectively, and
xij are the entries of the matrix X. Note that the vector β and the columns of X are
indexed from 0 to k −1, a common standard that will be motivated below.
In the most general form, the multivariate structure of the random error vector
ϵ makes it possible to have different variances and dependent errors, but it is quite
common to assume that the covariance matrix can be written 
 = σ2In, where In is
the identity matrix with ones in the diagonal and zeros in all other positions. This
will give us a model with independent errors and constant variance. Another common
requirement is that the ﬁrst column of the design matrix X should consist of ones,
that is, xi0 = 1 in (7.9), which is mainly a technical condition that will guarantee
that parameter estimates are unique. The consequence is that all linear models get an
intercept parameter β0.
Example 7.19 (Linear Regression). It is quite easy to see that the simple linear re-
gression model (7.7) of Section 7.6 ﬁts into this framework. Let k = 2 and
X =
⎛
⎜
⎜
⎜
⎜
⎝
1
x1
1
x2
...
...
1
xn
⎞
⎟
⎟
⎟
⎟
⎠
β =

a
b

It is also quite straightforward to generalize this into theMultiple Linear Regression
model
Yi = β0 + β1xi1 + β2xi2 + . . . + βk−1xi,k−1 + ϵi
i = 1, . . . , n

THE GENERAL LINEAR MODEL
433
using
X =
⎛
⎜
⎜
⎜
⎜
⎝
1
x11
x12
· · ·
x1,k−1
1
x21
x22
· · ·
x2,k−1
...
...
...
...
...
1
xn1
xn2
· · ·
xn,k−1
⎞
⎟
⎟
⎟
⎟
⎠
β =
⎛
⎜
⎜
⎜
⎜
⎝
β0
β1
...
βk−1
⎞
⎟
⎟
⎟
⎟
⎠
□
Example 7.20 (One-Way Analysis of Variance). To see that the one-way ANOVA is a
linear model requires a bit more work. Recall from Section 7.5.1 that Xij ∼N(μi, σ2),
which can be expressed
Xij = μi + ϵij,
i = 1, . . . , k,
j = 1, . . . , n
where ϵij ∼N(0, σ2) are independent. This almost ﬁts into the form of (7.9), except
that we have two indices and no intercept term.
First of all, we have to reorganize the observations Xij and the error terms in the
vectors
Y = (X11, X12, . . . , X1n, X21, X22, . . . , X2n, X31, . . . , Xkn)′
ϵ = (ϵ11, ϵ12, . . . , ϵ1n, ϵ21, ϵ22, . . . , ϵ2n, ϵ31, . . . , ϵkn)′
where M′ means the transpose of the matrix M.
Next, we reparameterize the group means μi as
μi = μ + αi i = 1, . . . , k
so that we get an intercept β0 = μ. Unfortunately, this adds another parameter to the
model, so some kind of restriction is necessary. In standard ANOVA, it is common to
require that k
i=1 αi = 0. This means that when α1, . . . , αk−1 have been determined,
αk = −k−1
i=1 αi showing that the number of parameters is still k. Another alternative
is to set one of the αi to zero (most commonly α1 = 0 or αk = 0), which gives an
equivalent model, but we will not consider this case here.
In order to deﬁne the design matrix, we need to introduce the so-called dummy
variables
xi1 = 1,
i = 1, . . . , n
xi2 = 1,
i = n + 1, . . . , 2n
xi,k−1 = 1,
i = (k −2)n + 1, . . . , (k −1)n
xij = −1,
i = (k −1)n + 1, . . . , kn j = 1, . . . , k −1

434
LINEAR MODELS
If we let 0 and 1 denote the n × 1 vectors consisting of zeros and ones, respectively,
we can express the design matrix and parameter vector as
X =
⎛
⎜
⎜
⎜
⎜
⎜
⎜
⎜
⎝
1
1
0
· · ·
0
0
1
0
1
· · ·
0
0
...
...
...
...
...
...
1
0
0
· · ·
0
1
1
−1
−1
· · ·
−1
−1
⎞
⎟
⎟
⎟
⎟
⎟
⎟
⎟
⎠
β =
⎛
⎜
⎜
⎜
⎜
⎜
⎜
⎜
⎝
μ
α1
α2
...
αk−1
⎞
⎟
⎟
⎟
⎟
⎟
⎟
⎟
⎠
□
If k = n we would have a square design matrix X and we could get estimates of β as
the solution to the linear matrix equation
Y = Xβ
(7.10)
which, if the inverse of X exists, can be written β = X−1Y. In practical applications,
it is common to have more observations than unknown parameters (often much more),
that is, k < n. In that case, we can reduce the dimensionality of (7.10) by multiplying
with X′ from the left to get
X′Y = X′Xβ
If the inverse of the k × k-matrix X′X exists, we get the solution β = (X′X)−1X′Y.
In fact, we get the following important result.
Proposition 7.21. Assume that (X′X)−1 exists in a GLM. Then,
β = (X′X)−1X′Y
is a unique MLE of β. It also holds that
β ∼Nk(β, (X′X)−1X′
X(X′X)−1)
(7.11)
If we consider the special case where 
 = σ2In, we can simplify the covariance
matrix in (7.11) as
(X′X)−1X′(σ2In)X(X′X)−1 = σ2(X′X)−1X′X(X′X)−1 = σ2(X′X)−1
Then, it is possible to show that
s2 =
1
n −k||Y −Xβ|| =
1
n −k
n

i=1
⎛
⎝Yi −
k−1

j=0
xijβj
⎞
⎠
2

THE GENERAL LINEAR MODEL
435
is an unbiased estimator of σ2 such that
(n −k)s2
σ2
∼χ2
n−k
As a consequence of this, it follows that
βj −βj
s
σ

Var(βj)
=
βj −βj
s√zjj
∼tn−k,
j = 1, . . . , k
where zjj are the diagonal elements in the matrix Z = (X′X)−1.
Example 7.21 (Two-Way Analysis of Variance). Let us end this section by indicating
how the theory of GLM can be used to handle higher order ANOVA models. We will
consider only the two-way ANOVA here. It should be quite clear how this can be
generalized to higher dimensions.
The two-way ANOVA can be written
Xijk ∼(μij, σ2),
i = 1, . . . , a,
j = 1, . . . , b,
k = 1, . . . , n
or in alternative form
Xijk = μ + αi + βj + γij + ϵijk,
i = 1, . . . , a,
j = 1, . . . , b,
k = 1, . . . , n
where ϵijk ∼N(0, σ2) are independent error terms. The parameters αi and βj are
called main effects and γij are called interaction effects. As before, we need some
additional conditions to reduce the number of parameters
a

i=1
αi = 0
b

j=1
βj = 0
a

i=1
γij = 0
b

j=1
γij = 0
This implies that the parameter vector can be written
β = (μ, α1, . . . , αa−1, β1, . . . , βb−1, γ11, . . . , γ1,b−1, γ21, . . . , γa−1,b−1)′
The design matrix becomes quite messy, so we will not attempt to give a detailed
description of it here. It will be a (abn) × (ab) matrix, which can be built up by
introducing dummy variables much in the same way as in Example 7.20. In this
particular case, it is possible to express the parameter estimators analytically as
μ = ¯X
αi = ¯Xi·· −¯X,
i = 1, . . . , a −1
βj = ¯X·j· −¯X,
j = 1, . . . , b −1
γij = ¯Xij· −¯Xi·· −¯X·j· + ¯X,
i = 1, . . . , a −1,
j = 1, . . . , b −1
where we use the convenient notation introduced in Section 7.5, where the dots indi-
cate for which indices the average is taken.
□

436
LINEAR MODELS
PROBLEMS
Section 7.2. Sampling Distributions
1. Let X ∼χ2
r and Y ∼χ2
s be independent. Show that X + Y ∼χ2
r+s.
2. Let X ∼χ2
r. Show that X ∼( r
2, 1
2).
3. Find the mean and variance in the χ2
r distribution. Also ﬁnd the approximate
distribution for large r. Hint: Use the previous problem and Section 2.8.2.
4. Let X ∼Fr,s. Show that X−1 ∼Fs,r.
5. Find the mean (for s > 2) and variance (for s > 4) in the F distribution. Hint:
Use Proposition 7.2 and (x + 1) = x(x).
6. Find the mean (for r > 1) and variance (for r > 2) in the t distribution.
7. Let X ∼t1. Show that X is Cauchy distributed.
8. Maxwell–Boltzmann distribution. The velocity V of a particle in an ideal gas
can be represented as
V =

V 2x + V 2y + V 2z
where Vx, Vy, and Vz are the velocity components in a three-dimensional co-
ordinate system. They are assumed to be independent and normally distributed
with mean 0 and variance σ2 = kT/m, where T is temperature, m is the mass
of particles, and k is the Boltzmann constant (k = 1.381 × 10−23). Derive the
pdf of V. Hint: Use Proposition 2.8.
Section 7.3. Single Sample Inference
9. Below are seven measurements of the ozone level (in ppm) taken at an envi-
ronmental measuring station. Suppose that these have a normal distribution and
ﬁnd a 95% symmetric conﬁdence interval for the mean μ.
0.06, 0.07, 0.08, 0.11, 0.12, 0.14, 0.21
10. Let X1, . . . , Xn be a sample from a normal distribution with known mean μ
and unknown variance σ2. Use Proposition 7.1 to show that a 100q% symmetric
conﬁdence interval for σ2 can be based on σ2 from Section 6.2.1 and is given
by
nσ2/x2 ≤σ2 ≤nσ2/x1
(q)
where Fχ2n(x1) = (1 −q)/2 and Fχ2n(x2) = 1 −(1 −q)/2.
11. Beloware measurementerrorsfrom anunbiased scale(μ = 0). Use the previous
problem to ﬁnd a 95% symmetric conﬁdence interval for its standard deviation.
−0.08, −0.05, −0.02, 0.01, 0.02, 0.06, 0.07
12. An IQ test is being constructed, and it is desirable that the standard deviation
is 15 (the mean is unknown). To assess this, the test was given to 30 randomly

PROBLEMS
437
selected people and the sample variance came out to be s2 = 340. Find symmet-
ricconﬁdenceintervalsforσ withconﬁdencelevels0.90and0.95.Conclusions?
13. Consider the symmetric conﬁdence interval for μ in the normal distribution,
μ = ¯X ± ts/√n. How should we choose n in order to limit the length of the
conﬁdence interval to ϵσ with probability q or greater? Express in terms of the
cdf of the chi-square distribution.
14. Let s2 be the sample variance and let Y be a random variable that has a
χ2
n−1 distribution. Show that (a) E[s] = σE[
√
Y]/√n −1, and (b) E[s4] =
σ4E[Y2]/(n −1)2. (c) In (b), it can be shown that E[Y2] = (n −1)(n + 1). Use
this to ﬁnd the variance of s2 and show that s2 is consistent (see Deﬁnition 6.4).
15. A company producing soda cans test whether their cans contain the intended
12 ounces. The contents of 100 cans are measured, the sample mean is 12.1,
and the sample variance 0.96. State the relevant hypotheses and test on the 5%
level if the mean is 12.
16. The depth of a lake at a particular point is claimed to be more than 100 m. To
test this, the depth is measured repeatedly, where it is known that measurement
errors have a normal distribution. On the basis of the following measurements,
test on the 5% level whether the depth is more than 100 m:
99, 101, 102, 102, 103, 103, 103
17. An electronic scale is known to give a measurement error, and to test whether
it is unbiased, a 100 g weight was measured repeatedly and the following data
obtained. Test on the 5% level if the scale is unbiased (i.e., if the mean is 0).
−1.05, −0.55, −0.01, 2.55, 3.72
18. An environmental measuring station measures ozone levels in the air. The
level is considered unhealthy if it is over 0.30 (ppm) and to determine so, the
following ﬁve observations were gathered. Assume a normal distribution, state
the appropriate null and alternative hypotheses (one- or two-sided?), and test
on the level 5%:
0.32, 0.35, 0.38, 0.41, 0.48
19. The vendor of a particular herbal supplement claims that it will increase your
IQ. To test the claim, the supplement was given to 10 people. Before, the
sample mean was 100 and after, it was 103. “I told you so!” says the vendor
but test his claim on the 5% level if you are also given the sample variance of
the differences, which was 318.
20. A test facility reports that they have found that a measurement device gives
values that tend to be too large. The measurement errors had a sample mean
of 0.5 and a sample variance of 4. How large must their sample size have been
in order to draw the conclusion in a two-sided test on the 5% level?
21. Let X1, . . . , Xn be a sample from a normal distribution with known mean μ and
unknown variance σ2. Describe how to use estimators of σ2 and the chi-square
distribution to construct tests of the null hypothesis H0 : σ2 = σ2
0 for ﬁxed σ2
0.

438
LINEAR MODELS
22. The following data are from a normal distribution where it is desirable that the
variance is at most 1. Do the following data cause concern that the variance is
too large? Test on the 5% level.
−3.7, −1.5, −0.6, −0.4, −0.3, 1.0, 2.0
23. An electronic scale gives measurement errors that are normal with mean 0. The
scale needs to be adjusted if the standard deviation exceeds one milligram. The
following data are deviations in milligrams obtained by weighing an object of
known weight six times. Do the data warrant an adjustment? Test on the 5%
level.
−0.40, −0.28, −0.27, −0.16, 0.05, 0.22
24. An IQ test is constructed and the desired standard deviation is 15. The
following data are 10 measured IQ scores. Test on the 5% level if the standard
deviation is out of bounds.
75, 76, 87, 90, 97, 104, 106, 107, 111, 127
Section 7.4. Comparing Two Samples
25. Common sea-buckthorn berries are particularly rich in vitamin E. Two genet-
ically different types of plants were evaluated in an experiment where seven
plants of type A and ﬁve plants of type B were cultivated. The vitamin E content
(in g/g dry weight) of the ripe berries was measured.
Type A: 416, 492, 444, 404, 325, 286, 403
Type B: 279, 352, 320, 385, 315
Assume that the samples are normally distributed with equal variances and
carry out a hypothesis test on the 10% level to see if the mean vitamin E content
differs between the two types.
26. To investigate whether caffeine affects cholesterol levels, ﬁve patients had their
cholesterol levels measured before and after taking doses of caffeine. Find a
symmetric 95% conﬁdence interval for the difference in cholesterol level based
on the following data:
Before: 162, 168, 197, 202, 225
After:
179, 170, 196, 188, 210
27. A chemist wants to see how much an industry contributes to pollution in a
nearby river. She collects 10 samples upstream and 15 samples downstream on
25 different and randomly chosen days during a 3-month period and measures
the content of a certain pollutant. The sample mean and standard deviation
were 13.2 and 2.8, respectively, for the upstream samples and 86.1 and 38.7,
respectively,forthedownstream samples. Assumethatthesamplesarenormally
distributed and calculate a 95% conﬁdence interval for the difference in mean
pollution downstream and upstream.

PROBLEMS
439
28. A water laboratory needs new pH meters and considers two different brands.
Therefore, they acquire six meters each from the manufacturers for evaluation
and use them to measure the pH in a neutral solution known to have pH level
7. The sample standard deviations of each brand were 0.078 and 0.029, respec-
tively. Is this evidence enough to claim that one brand has signiﬁcantly lower
measurement error than the other? What assumptions do you need to make?
29. A type of rectangular metal plate has sides X and Y that are normally distributed
with the same variance and means μ1 and μ2, respectively. Find a 95% sym-
metric conﬁdence interval for the circumference 2μ1 + 2μ2 of a plate, based
on the following two independent samples:
X: 87, 90, 97, 102, 108, 110
Y: 133, 147, 148, 154
30. If we have two independent samples of the same size n and with the same
variance, the standard conﬁdence interval for the difference between the means
is based on the estimator ¯Y −¯X of μ2 −μ1. However, we could also pair the
observations, compute the differences D1, . . . , Dn, and base the conﬁdence
interval on ¯D = ¯Y −¯X. Which do you think is better and why?
31. Consider two independent samples X1, . . . , Xn and Y1, . . . , Ym that have the
same unknown variance σ2. Let s2
1 and s2
2 be the respective sample variances. (a)
Prove that the pooled sample variance from Deﬁnition 7.4 is an unbiased estima-
tor of σ2. (b) Prove that any linear combination of the type s2
a = as2
1 + (1 −a)s2
2
where 0 ≤a ≤1 is an unbiased estimator of σ2. (c) Prove that the variance of s2
a
is minimized for a = (n −1)/(n + m −2) and thus that the pooled sample vari-
ance has a smaller variance than does any other linear combination of s2
1 and s2
2.
Hint: By Problem 14 (c), Var[s2
1] = 2σ4/(n −1) and Var[s2
2] = 2σ4/(m −1).
32. In 1908, W. S. Gosset conducted a famous experiment to determine whether
kiln-dried seed would give larger corn yield than would regular seed. Eleven
plots were split in half and planted with regular seed on one side and kiln-dried
seed on the other. (Why is this better than simply planting regular seed in one
big plot and kiln-dried in another?) This gave the following 11 pairs of yields
in pounds per acre:
Regular:
1903, 1935, 1910, 2496, 2108, 1961, 2060, 1444, 1612, 1316, 1511
Kiln-dried: 2009, 1915, 2011, 2463, 2180, 1925, 2122, 1482, 1542, 1443, 1535
We assume these are normally distributed. State the appropriate hypotheses
and test on the 5% level.
33. Let us say that you want to test if the means in two independent and normal
samples are equal and you are uncertain whether the variances are equal. Then,
it may seem like a good idea to ﬁrst carry out a hypothesis test to see if the
variances are equal. If you accept H0, you carry out the test in Proposition 7.11,
and if you reject H0, you use Proposition 7.12 instead. What is the problem
with this procedure?

440
LINEAR MODELS
Section 7.5. Analysis of Variance
34. A biologist wanted to examine the impact of alcohol on sleep patterns. A total
of 20 mice were randomly assigned to four equally large treatment groups and
injected with a certain concentration of ethanol per body weight. The length
of the REM sleep was then measured during a 24 h period. The result was as
follows.
Treatment
REM Sleep
Mean
Variance
0 (control)
89
73
91
68
75
79.2
104.2
1 g/kg
63
54
69
50
72
61.6
89.3
2 g/kg
45
60
40
56
39
48.0
90.5
3 g/kg
31
40
45
25
23
32.8
90.2
(a) Carry out an ANOVA on the 5% level to see if alcohol consumption affects
REM sleep. (b) Calculate pairwise conﬁdence intervals for the difference in
means. What groups are signiﬁcantly different? (c) Carry out a Kruskal–Wallis
test. Does the conclusion differ from (a)?
35. Consider an ANOVA with k = 2 and arbitrary n. Show that this is equivalent
to the two-sample t test with equal variances.
36. Unbalanced ANOVA. Let us assume that the k treatment groups in a one-way
ANOVA are of different sizes n1, . . . , nk. Modify the balanced ANOVA and
derive expressions for the sum of squares, mean squares, degrees of freedom,
and F test.
37. Show that E[s2
B] > σ2 if μi1 /= μi2 for some i1 and i2.
38. Use
n

k=1
k = n(n + 1)
2
and
n

k=1
k2 = n(2n + 1)(n + 1)
6
(7.12)
to derive Equation (7.6) if there are no ties in Kruskal–Wallis test.
Section 7.6. Linear Regression
39. Verify the estimators of a and b in Proposition 7.15 and compute the means and
variances of a and b.
40. Show that ¯Y and b are uncorrelated (Problem 101 in Chapter 3). Are they
independent?
41. Find 95% symmetric conﬁdence intervals for a and b based on the Old Faithful
data in Example 7.13. Compare with the “ranger formula” y = 13x + 30.
42. Test the hypothesis that a = 0 in Hubble’s galaxy data, on signiﬁcance level
0.01.

PROBLEMS
441
43. Consider the linear regression model without the intercept term, that is, Y =
bx + ϵ. (a) Find the MLE b of b and compute its mean and variance. (b) Suggest
an estimator of σ2 and a conﬁdence interval for b. (c) Again consider Hubble’s
galaxy data. Argue why the model Y = bx + ϵ is reasonable there, compute
b, a 95% conﬁdence interval for b, and compare with the estimate obtained in
Examples 7.11 and 7.12.
44. Consider the linear regression model Y = a + bx + ϵ. (a) Suppose that a is
known. Find the MLE of b. (b) Suppose that b is known. Find the MLE of
a. (c) Compute the preceding estimates for the Old Faithful data in Example
7.13 using the rangers’ values of a and b. Compare with the estimates in the
example.
45. A cell culture is growing in such a way that the total mass at time t can be ideally
described by the equation y = a ebt, where a and b are constants. Because of
random ﬂuctuations, the real relationship is Y = a ebtL, where L is a random
variable that has a lognormal distribution with μ = 0 and σ2 = 1 (see Section
2.8.1). Find estimators and 95% conﬁdence intervals for a and b based on the
following data, obtained from ﬁve different cultures, weighed at different times.
Time:
1, 3, 7, 8, 10
Weight: 1.43, 0.51, 4.57, 5.93, 1.73
46. Below are the winning times in men’s 10,000 m track in the Olympic Games
between the years 1952 and 2004. Times are in decimal form, so, for example,
28.4 = 28 min and 24 s. Let the years be the x values and the times the y
values. (a) Find the estimated regression line and the predicted winning time
in the Olympic year 2668. (b) Is it reasonable to assume a linear relationship?
29.3, 28.8, 28.5, 28.4, 29.4, 27.6, 27.7, 27.7, 27.8, 27.4, 27.8, 27.1, 27.3, 27.1
47. Again consider the Old Faithful data in Example 7.13. Compute a 95% predic-
tion interval for the time Y until the next eruption if the most recent eruption
was 10 min. Compare with the interval in Example 7.14. Which is longer and
why?
48. Show that a conﬁdence interval for a + bx, the expected value of Y if x has
been observed, is obtained by removing the “1” under the square root in the
expression for the prediction interval in Corollary 7.11.
49. Consider the following residual plots. What do they suggest about the true
relation between x and Y?
0 
0 
0 
(a)
(b)
(c)

442
LINEAR MODELS
50. Consider the linear regression model. Describe how to ﬁnd a symmetric 100q%
conﬁdence interval for σ based on Proposition 7.17. What does this give for
Hubble’s galaxy data in Example 7.11, if q = 0.95?
51. The following is a data set of 10 closing prices for the Dow and Nasdaq in-
dices, chosen at random from the year 2000. Compute the sample correlation
coefﬁcient R and test if ρ = 0. Look up the behavior of the two indices during
the year 2000 and explain the value of R in the light of this.
Dow:
10, 092, 11, 112, 10, 621, 10, 714, 10, 504, 10, 783, 10, 908
10, 681, 10, 707, 10, 399
Nasdaq: 4321, 4897, 3205, 3400, 3767, 3858, 3842, 3333, 3429, 3200
52. Compute Spearman’s correlation coefﬁcient RS for the data in the previous
problem and test if ρ = 0. Do the results differ?
53. Let ρ be the correlation coefﬁcient and R the sample correlation coefﬁcient in
a sample from a bivariate normal distribution, and let
L = log
1 + R
1 −R

It can be shown that the following approximation holds:
L
d≈N

log
1 + ρ
1 −ρ

,
4
n −3

Use this to ﬁnd an approximate conﬁdence interval for ρ. Apply this to ﬁnd the
observed 95% conﬁdence interval for the stock market data in Problem 51.
54. Consider Gosset’s corn yield data from Problem 32. Use the statistic L in
Problem 53 to test whether the correlation between yields is greater than 0.9.
Test on the 5% level.
55. To test the null hypothesis H0 : ρ = 0 about the correlation coefﬁcient, we can
use either the test statistic T from Proposition 7.18 or the test statistic L from
Problem 53. However, only one of them can be used for power calculations.
Which one and why?
56. Use (7.12) to derive Proposition 7.20 if there are no ties.
Section 7.7. The General Linear Model
57. In the multiple regression model Yi = β0 + β1xi1 + β2xi2 + ϵi for i =
1, . . . , 25, where ϵ1, . . . , ϵ25 are i.i.d. N(0, σ2), we got β0 = 2.71, β1 = 10.20,
β2 = 2.07, s2 = 0.180 and the diagonal elements z11 = 0.4, z22 = 0.5, and
z33 = 0.02. Calculate two-sided symmetric conﬁdence intervals for β0, β1, and
β2. Use Bonferroni correction to get simultaneous conﬁdence level at least 95%.
58. Express the two-sample model in Section 7.4 as a general linear model both for
the case σ2
1 = σ2
2 = σ2 and σ2
1 /= σ2
2.

PROBLEMS
443
59. Use Proposition 7.21 to verify Proposition 7.15. Hint: The inverse of a 2 × 2-
matrix is

a
b
c
d
−1
=
1
ad −bc

d
−b
−c
a

60. Consider the two-way ANOVA in Example 7.21 and derive the sum of squares
SSA and SSB for main effects, SSAB for interaction, SSE for error, and SST
for total. Hint: Use SST = SSA + SSB + SSAB + SSE.
61. It is perfectly ﬁne to mix categorical components, like in an ANOVA, with
linear components, like in a linear regression, into a general linear model. As a
simple example, consider Xij = μ + αi + βxij + ϵij for i = 1, . . . , k and j =
1, . . . , n, where 
i αi = 0 and ϵ11, . . . , ϵkn are i.i.d. N(0, σ2). Outline the
design matrix in this model.

8
STOCHASTIC PROCESSES
8.1
INTRODUCTION
Many real-world applications of probability theory have one particular feature that
data are collected sequentially in time. A few examples are weather data, stock mar-
ket indices, air-pollution data, demographic data, and political tracking polls. These
also have another feature in common that successive observations are typically not
independent. We refer to any such collection of observations as a stochastic process.
Formally, a stochastic process is a collection of random variables that take values in
a set S, the state space. The collection is indexed by another set T, the index set.
The two most common index sets are the natural numbers T = {0, 1, 2, . . .} and the
nonnegative real numbers T = [0, ∞), which usually represent discrete time and con-
tinuoustime,respectively.Theﬁrstindexsetthusgivesasequenceofrandomvariables
{X0, X1, X2, . . .} and the second, a collection of random variables {X(t), t ≥0}, one
random variable for each time t. In general, the index set does not have to describe
time and is also commonly used to describe spatial location. The state space can be
ﬁnite, countably inﬁnite, or uncountable, depending on the application.
In order to be able to analyze a stochastic process, we need to make assumptions
on the dependence between the random variables. In this chapter, we will focus on
the most common dependence structure, the so-called Markov property, and in the
next section we give a deﬁnition and several examples.
Probability, Statistics, and Stochastic Processes, Second Edition. Peter Olofsson and Mikael Andersson.
© 2012 John Wiley & Sons, Inc. Published 2012 by John Wiley & Sons, Inc.
444

DISCRETE -TIME MARKOV CHAINS
445
8.2
DISCRETE -TIME MARKOV CHAINS
You are playing roulette, in each round betting $1 on odd. You start with $10 and
after each round record your new fortune. Suppose that the ﬁrst ﬁve rounds gives the
sequence loss, loss, win, win, win, which gives the sequence of fortunes
9, 8, 9, 10, 11
and that you wish to ﬁnd the distribution of your fortune after the next round, given
this information. Your fortune will be 12 if you win, which has probability 18
38, and 10
if you lose, which has probability 20
38. One thing we realize is that this depends only
on the fact that the current fortune is $11 and not the values prior to that. Generally,
if your fortunes in the ﬁrst n rounds are the random variables X1, . . . , Xn, then the
conditional distribution of Xn+1 given X1, . . . , Xn depends only on Xn. This is a
fundamental property, and we state the following general deﬁnition.
Deﬁnition 8.1. Let X0, X1, X2, . . . be a sequence of discrete random variables,
taking values in some set S and that are such that
P(Xn+1 = j|X0 = i0, . . . , Xn−1 = in−1, Xn = i) = P(Xn+1 = j|Xn = i)
for all i, j, i0, . . . , in−1 in S and all n. The sequence {Xn} is then called a Markov
chain.
We often think of the index n as discrete time and say that Xn is the state of the chain
at time n, where the state space S may be ﬁnite or countably inﬁnite. The deﬁning
property is called the Markov property, which can be stated in words as “conditioned
on the present, the future is independent of the past.”
In general, the probability P(Xn+1 = j|Xn = i) depends on i, j, and n. It is, how-
ever, often the case (as in our roulette example) that there is no dependence on n. We
call such chains time-homogeneous and restrict our attention to these chains. Since
the conditional probability in the deﬁnition thus depends only on i and j, we use the
notation
pij = P(Xn+1 = j|Xn = i), i, j ∈S
and call these the transition probabilities of the Markov chain. Thus, if the chain is
in state i, the probabilities pij describe how the chain chooses which state to jump to
next. Obviously, the transition probabilities have to satisfy the following two criteria:
(a) pij ≥0 for all i, j ∈S,
(b)

j∈S
pij = 1 for all i ∈S
Example 8.1. In the roulette example above, the state space is
S = {0, 1, . . .}

446
STOCHASTIC PROCESSES
and if the chain is in state i ≥1, it can jump to either i −1 or i + 1 according to the
transition probabilities
pi,i−1 = 20
38
and pi,i+1 = 18
38
When i = 0, this means that you are ruined and cannot play anymore. Thus, you
can jump to 0 but not from it. It is customary to describe this by letting p00 = 1,
thus imagining that the chain performs an eternal sequence of jumps from 0 to itself.
The diagram below shows a way to describe a Markov chain as a graph, which we
refer to as the transition graph. The arrows show the possible transitions and their
corresponding probabilities. Note that the sum of the numbers on the arrows going
out from each state is 1. This is criterion (b) above.
18/38
18/38
1
20/38
20/38
20/38
2
0
1
...
□
Example 8.2. A certain gene in a plant has two alleles, A and a (see Section 1.6.2).
Thus, its genotype with respect to this gene can be AA, Aa, or aa. Now suppose that
a plant is crossed with itself and one offspring is selected that is crossed with itself
and so on and so forth. Describe the sequence of genotypes as a Markov chain.
The state space is S = {AA, Aa, aa}, which also shows that states do not have to be
numbers.1 The Markov property is clear since the offspring’s genotype depends only
on the parent plant, not on the grandparent. Clearly, genotypes AA and aa can have
only themselves as offspring and for the type Aa, we recall the Punnett square from
Section 1.6.2 to get the following transition graph:
1/2
1
1
1/4
1/4
Aa
AA
aa
□
It is convenient to summarize the transition probabilities in the transition matrix P,
which has pij as its (i, j)th entry. Depending on the state space, the transition matrix
1The picky probabilist then refers to the Xk as random objects rather than random variables. If we wish,
we can rename the states {1, 2, 3} instead, where the numbers have no role other than serving as labels.

DISCRETE -TIME MARKOV CHAINS
447
may be ﬁnite or inﬁnite. Thus, in the genetics example we have
P =
⎛
⎜
⎝
1
0
0
1/4
1/2
1/4
0
0
1
⎞
⎟
⎠
and in the roulette example the inﬁnite matrix
P =
⎛
⎜
⎜
⎜
⎜
⎝
1
0
0
0
0
. . .
20/38
0
18/38
0
0
. . .
0
20/38
0
18/38
0
. . .
...
...
...
...
...
...
⎞
⎟
⎟
⎟
⎟
⎠
8.2.1
Time Dynamics of a Markov Chain
The most fundamental aspect of a Markov chain in which we are interested is how
it develops over time. The transition matrix provides us with a description of the
stepwise behavior, but suppose that we want to compute the distribution of the chain
two steps ahead. Let
p(2)
ij = P(X2 = j|X0 = i)
and condition on the intermediate step X1. The law of total probability gives
p(2)
ij =

k∈S
P(X2 = j|X0 = i, X1 = k)P(X1 = k|X0 = i)
=

k∈S
P(X2 = j|X1 = k)P(X1 = k|X0 = i) =

k∈S
pikpkj
where we used the Markov property for the second-to-last equality. We switched the
order between the factors in the sum to get the intuitively appealing last expression;
in order to go from i to j in two steps, we need to visit some intermediate step k and
jump from there to j. Now, recall how matrix multiplication works to help us realize
from the expression above that p(2)
ij is the (i, j)th entry in the matrix P2. Thus, in order
to get the two-step transition probabilities, we square the transition matrix. Generally,
deﬁne the n-step transition probabilities as
p(n)
ij = P(Xn = j|X0 = i)
and let P(n) be the n-step transition matrix. Repeating the argument above gives
P(n) = Pn, the nth power of the one-step transition matrix. In particular, this gives
the relation
P(n+m) = P(n)P(m)

448
STOCHASTIC PROCESSES
for all m, n, commonly referred to as the Chapman–Kolmogorov equations. Spelled
out coordinatewise, they become
p(n+m)
ij
=

k∈S
p(n)
ik p(m)
kj
for all m, n and all i, j ∈S. In words, to go from i to j in n + m steps, we need to
visit some intermediate step k after n steps. We let P(0) = I, the identity matrix.
Example 8.3. Find the n-step transition matrix in the genetics example (Example 8.2).
The state space is S = {AA, Aa, aa}, and let us start with n = 2. We get
P(2) =
⎛
⎜
⎝
1
0
0
1/4
1/2
1/4
0
0
1
⎞
⎟
⎠
⎛
⎜
⎝
1
0
0
1/4
1/2
1/4
0
0
1
⎞
⎟
⎠
=
⎛
⎜
⎝
1
0
0
3/8
1/4
3/8
0
0
1
⎞
⎟
⎠
We now realize that 0s and 1s will remain in all powers of P, that the middle entry in
P(n) is p(n)
22 = ( 1
2)n, and that by symmetry p(n)
21 = p(n)
23 . This gives the n-step transition
matrix
P(n) =
⎛
⎜
⎝
1
0
0
(1 −(1/2)n)/2
(1/2)n
(1 −(1/2)n)/2
0
0
1
⎞
⎟
⎠
It is obvious without computations that the 0s and 1s remain unchanged; the types
AA and aa can have offspring only of their own type. Also note how the probability
to ﬁnd the type Aa declines rapidly with n, indicating that eventually this genotype
will disappear. We will return to this aspect of the transition matrix.
□
It should be pointed out that computation of P(n) is seldom this simple and may be
more or less impossible if the state space is large. Even for a small state space, the
computation is not trivial, as the next example shows.
Example 8.4. (ON/OFF System). Consider a system that alternates between the two
states 0 (OFF) and 1 (ON) and that is checked at discrete timepoints. If the system is
OFF at one timepoint, the probability that it has switched to ON at the next timepoint is
p, and if it is ON, the probability that it switches to OFF is q. (a) Describe the system
as a Markov chain. (b) Find the n-step transition matrix. (c) Suppose that p = 3
4 and
q = 1
2. If the system starts being OFF, what is the probability that it is ON at time n = 3?

DISCRETE -TIME MARKOV CHAINS
449
For (a), the transition graph is
1
0
q
p
1 − q
1 − p
and the transition matrix
P =
	
1 −p
p
q
1 −q

and computation of the powers of P needed for (b) is facilitated by diagonalization
techniques from linear algebra. The eigenvalues of P are λ1 = 1 and λ2 = 1 −p −q
and it can be shown that
Pn =
1
p + q
	
q
p
q
p

+
λn
2
p + q
	
p
−p
−q
q

and you may verify that this satisﬁes the relation Pn+1 = PnP. To ﬁnd the answer
to (c), we need p(3)
01 , which is the (0, 1) entry in P(3). Thus, the probability that the
system is ON at time n = 3, given that it starts with being OFF, is
p(3)
01 =
p
p + q + −pλ3
2
p + q = 3/4
5/4 + −3/4 × (−1/4)3
5/4
≈0.61
□
One interesting aspect of a Markov chain is its long-term behavior. As it turns out,
there are simple and elegant asymptotic results for Markov chains that makes this
easy to deal with. Before we get to those results, let us consider asymptotics in some
of our examples.
Example 8.5. Recall the genetics example (Example 8.2). Find the limits of the
transition probabilities as n →∞.
The n-step transition matrix is
P(n) =
⎛
⎜
⎝
1
0
0
(1 −(1/2)n)/2
(1/2)n
(1 −(1/2)n)/2
0
0
1
⎞
⎟
⎠

450
STOCHASTIC PROCESSES
and letting n →∞gives the matrix
lim
n→∞P(n) =
⎛
⎜
⎝
1
0
0
1/2
0
1/2
0
0
1
⎞
⎟
⎠
Thus, if we start in state AA or aa, we stay there, and if we start in state Aa, we
eventually end up in either AA or aa with equal probabilities.
□
Example 8.6. Recall the
ON/OFF system in Example 8.4. Find the limits of the
transition probabilities as n →∞.
The n-step transition matrix is
P(n) =
1
p + q
	
q
p
q
p

+
λn
2
p + q
	
p
−p
−q
q

and since λ2 = 1 −p −q and thus |λ2| < 1 (unless p = q = 0 or p = q = 1), letting
n →∞gives the matrix
lim
n→∞P(n) =
1
p + q
	
q
p
q
p

Note that the rows of this matrix are identical. Thus, at a late timepoint, the prob-
abilities that the system is OFF and ON are approximately q/(p + q) and p/(p + q),
respectively, regardless of the initial state. Note that if q > p, the probability to be
OFF is larger, which makes sense.
□
In the previous example, the asymptotic probabilities do not depend on how the
chain was started, and we call the distribution (q/(p + q), p/(p + q)) on the state
space {0, 1} a limit distribution. Compare with the genetics example where no limit
distribution exists since the asymptotic probabilities depend on the initial state. A
question of general interest is when a Markov chain has a limit distribution. To be
able to answer this, we need to introduce some criteria that enables us to classify
Markov chains.
8.2.2
Classiﬁcation of States
The graphic representation of a Markov chain illustrates in which ways states can
be reached from each other. In the roulette example, state 1 can, for example, reach
state 2 in one step and state 3, in two steps. It can also reach state 3 in four steps,
through the sequence 2, 1, 2, 3, and so on. One important property of state 1 is that
it can reach any other state. Compare this to state 0 that cannot reach any other state.
Whether or not states can reach each other in this way is of fundamental importance
in the study of Markov chains, and we state the following deﬁnition.

DISCRETE -TIME MARKOV CHAINS
451
Deﬁnition 8.2. If p(n)
ij > 0 for some n, we say that state j is accessible from state i,
written i →j. If i →j and j →i, we say that i and j communicate and write this
i ↔j.
If j is accessible from i, this means that it is possible to reach j from i but not that this
necessarily happens. In the roulette example, 1 →2 since p12 > 0, but if the chain
starts in 1, it may jump directly to 0, and thus it will never be able to visit state 2. In
this example, all nonzero states communicate with each other and 0 communicates
only with itself.
In general, if we ﬁx a state i in the state space of a Markov chain, we can ﬁnd all
states that communicate with i and form the communicating class containing i. It is
easy to realize that not only does i communicate with all states in this class but they all
communicate with each other. By convention, every state communicates with itself
(it can “reach itself in 0 steps”) so every state belongs to a class. If you wish to be
more mathematical, the relation “↔” is an equivalence relation and thus divides the
state space into equivalence classes that are precisely the communicating classes. In
the roulette example, there are two classes
C0 = {0}, C1 = {1, 2, . . .}
and in the genetics example, each state forms its own class and we thus have
C1 = {AA}, C2 = {Aa}, C3 = {aa}
In the ON/OFF system, there is only one class, the entire state space S. In this chain, all
states communicate with each other, and it turns out that this is a desirable property.
Deﬁnition 8.3. If all states in S communicate with each other, the Markov chain is
said to be irreducible.
Another important property of Markov chains has to do with returns to a state. For
instance, in the roulette example, if the chain starts in state 1, it may happen that
it never returns. Compare this with the ON/OFF system where the chain eventually
returns to where it started (assuming that p > 0 and q > 0). We next classify states
according to whether return is certain. We introduce the notation Pi for the probability
distribution of the chain when the initial state X0 is i.
Deﬁnition 8.4. Consider a state i ∈S and let τi be the number of steps it takes for
the chain to ﬁrst visit i. Thus
τi = min{n ≥1 : Xn = i}
where τi = ∞if i is never visited. If Pi(τi < ∞) = 1, state i is said to be recurrent
and if Pi(τi < ∞) < 1, it is said to be transient.

452
STOCHASTIC PROCESSES
A recurrent state thus has the property that if the chain starts in it, the time until it
returns is ﬁnite. For a transient state, there is a positive probability that the time until
return is inﬁnite, meaning that the state is never revisited. This means that a recurrent
state is visited over and over but a transient state is eventually never revisited.
Now consider a transient state i and another state j such that i ↔j. We will argue
that j must also be transient. By the Markov property, every visit to j starts a fresh
Markov chain and since i ↔j, there is a positive probability to visit i before coming
back to j. We may think of this as repeated trials to reach i every time the chain is in
j, and since the success probability is positive, eventually there will be a success. If j
were recurrent, the chain would return to j inﬁnitely many times and the trial would
also succeed inﬁnitely many times. But this means that there would be inﬁnitely many
visits to i, which is impossible since i is transient. Hence j must also be transient.
We have argued that transience (and hence also recurrence) is a class property,
a property that is shared by all states in a communicating class. In particular, the
following holds.
Corollary 8.1. In an irreducible Markov chain, either all states are transient or all
states are recurrent.
This is convenient since we can classify the entire Markov chain as transient or
recurrent by checking only one state. In the case of a ﬁnite state space, there is an
easy way to classify the transient and recurrent states.
Corollary 8.2. Suppose that S is ﬁnite. A state i is transient if and only if there is
another state j such that i →j but j /→i.
We omit the proof, referring instead to an intuitive argument. Every time the chain
visits a transient state, there is a chance that it will never return again. In a ﬁnite state
space, the only way in which this can happen is if there is some other state that can
be reached but from where there is no path back. In an inﬁnite state space, however,
there is enough room for states to be transient even if they all communicate with each
other. We also realize that if the state space is ﬁnite, there is not enough room for all
states to be transient.
Corollary 8.3. If a Markov chain has ﬁnite state space, there is at least one recurrent
state.
Example 8.7. Classify the states as recurrent/transient in the
ON/OFF system in
Example 8.4.
To avoid trivialities, we assume that both p and q are strictly positive. Since the state
space is ﬁnite, we can use Corollary 8.2 and note that since i and j communicate,
they must both be recurrent.
□

DISCRETE -TIME MARKOV CHAINS
453
Example 8.8. Classify the states as recurrent/transient in the roulette example
(Example 8.1).
Here we must use the general deﬁnition. Let us start with state 0, which is trivially
recurrent since if we start there, we are stuck there forever, that is, τ0 ≡1. As for state
1, if we start there and the ﬁrst jump is to 0, we never return to 1, and thus τ1 = ∞
in this case. Hence, P(τ1 < ∞) < 1 and state 1 is transient. Since 1 communicates
with the states 2, 3, . . ., they are all transient.
The recurrent state 0 has the additional property that once the chain is there, it can
never leave.2 Such a state is called absorbing.
□
A transient state i is revisited a number of times, which has a geometric distribution
with success probability Pi(τi = ∞) (where “success” means that the state is never
revisited). This means that the expected number of returns is 1/Pi(τi = ∞), which
is ﬁnite since Pi(τi = ∞) > 0. On the other hand, for a recurrent state the expected
number of returns is inﬁnite (since already the actual number is inﬁnite). Now let
In =

1
if Xn = i
0
otherwise
and let
S =
∞

n=1
In
the total number of returns to state i. We get
Ei[S] =
∞

n=1
Ei[In] =
∞

n=1
Pi(Xn = i) =
∞

n=1
p(n)
ii
which gives the following nice characterization of transience/recurrence.3
Proposition 8.1. State i is
transient if
∞

n=1
p(n)
ii < ∞
recurrent if
∞

n=1
p(n)
ii = ∞
2A quote from Hotel California is sometimes given at this point in the presentation, but we resist the
temptation.
3In the calculation, we interchanged summation and expectation, which is not always allowed when the
sum is inﬁnite. However, it can be shown that it is justiﬁed if the summands are nonnegative as in this case.

454
STOCHASTIC PROCESSES
Since we have noted that it is often difﬁcult to compute the p(n)
ii , one may wonder how
useful the last result is. However, we do not need to compute the exact value of the
inﬁnite sum, only determine whether it is convergent, and for this, it will sufﬁce if we
have some idea of how p(n)
ii behaves asymptotically in n. We will later see examples
of this.
8.2.3
Stationary Distributions
Consider the ON/OFF system and suppose that we choose the initial state according to
the probabilities ν0 = P(X0 = 0), ν1 = P(X0 = 1) = 1 −ν0. The distribution ν =
(ν0, ν1) is called an initial distribution and the probability distribution of the ﬁrst
state X1 is computed by conditioning on X0, which gives
P(X1 = j) = p0jν0 + p1jν1,
j = 0, 1
or in matrix notation
(P(X1 = 0), P(X1 = 1)) = νP
Suppose in particular that we take ν0 = q/(p + q), ν1 = p/(p + q), the limit distri-
bution, as initial distribution. We then get
P(X1 = 0) = (1 −p)
q
p + q + q
p
p + q =
q
p + q = ν0
and P(X1 = 1) = ν1. In matrix notation, ν = νP, which means that the distribution
does not change over time. This is an important observation, and we state the following
general deﬁnition.
Deﬁnition 8.5. Let P be the transition matrix of a Markov chain with state space
S. A probability distribution π = (π1, π2, . . .) on S satisfying
πP = π
is called a stationary distribution of the chain.
The entries of π thus satisfy
πj =

i∈S
pijπi for all j ∈S
and together with the condition

i∈S
πi = 1

DISCRETE -TIME MARKOV CHAINS
455
this determines the stationary distribution. The intuition behind the probability πj is
that it describes what proportion of time is spent in state j in the long run. Other terms
are invariant distribution and equilibrium distribution.
There are, however, some caveats: (1) a stationary distribution may not always
exist and (2) there may be more than one. The uniqueness problem goes away if
we make our usual assumption of irreducibility, an observation that we state without
proof.
Proposition 8.2. Consider an irreducible Markov chain. If a stationary distribution
exists, it is unique.
This is helpful, but we can still not guarantee that a stationary distribution exists.
Things simplify if the state space is ﬁnite.
Proposition 8.3. If S is ﬁnite and the Markov chain is irreducible, a unique sta-
tionary distribution π exists.
Rather than giving the proof, we examine our examples to illustrate how to compute
the stationary distribution and what can go wrong if the chain is not irreducible.
Example 8.9. Find the stationary distribution for the ON/OFF system in Example 8.4.
Since the chain is ﬁnite and irreducible, the stationary distribution exists and is unique.
The equation πP = π becomes
(π0 π1)
	
1 −p
p
q
1 −q

= (π0 π1)
from which we take the ﬁrst equation
(1 −p)π0 + qπ1 = π0
which gives
π1 = p
q π0
The second equation is
pπ0 + (1 −q)π1 = π1

456
STOCHASTIC PROCESSES
which also gives π1 = (p/q)π0. To get a solution, we note that π0 + π1 = 1, which
gives
π0

1 + p
q

= 1
which gives stationary distribution
π =

q
p + q,
p
p + q

Note how π0 > π1 if q > p. This makes sense since if the chain is more likely to
jump from 1 to 0 than the other way, in the long run it spends more time in 0.
□
Note how the two equations for π0 and π1 in the example turned out to be the same.
In general, if the state space has r states, the equation πP = π gives at most r −1
linearly independent equations, and in addition to these, we also have the equation

j∈S πj = 1. Recalling results from linear algebra, this means that there always
exists a solution to this system of equations, but unless the chain is irreducible, there
may be more than one solution.
Example 8.10. Find the stationary distribution in the genetics example (Example 8.2).
The chain is not irreducible, but let us still attempt to ﬁnd the stationary distribution.
The states are AA, Aa, and aa, and the equation πP = π becomes
(πAA πAa πaa)
⎛
⎜
⎝
1
0
0
1/4
1/2
1/4
0
0
1
⎞
⎟
⎠= (πAA πAa πaa)
from which we get the ﬁrst equation
πAA + 1
4πAa = πAA
which gives πAa = 0. Knowing this, the second equation gives only 0 = 0, and the
third gives πaa = πaa. Thus, any distribution of the form
π = (α, 0, 1 −α)
where 0 ≤α ≤1 qualiﬁes as a stationary distribution. The evolution of the chain is
simple: we choose either AA or aa, according to π, and whatever state we choose stays
forever. Thus, we get the sequence AA, AA, . . . with probability α and aa, aa, . . .
with probability 1 −α. Perhaps not very exciting, but a good illustration of what can
happen without irreducibility.
□

DISCRETE -TIME MARKOV CHAINS
457
Things are a little more complicated if the state space is inﬁnite. Consider, for example,
the following variant of Example 1.59.
Example 8.11. Recall the gambler’s ruin problem in Example 1.59, where Ann starts
with one dollar and Bob is inﬁnitely wealthy. Also suppose that Ann has an inﬁnitely
wealthy and benevolent uncle who gives her a dollar to bet every time she goes
broke. Describe the Markov chain and ﬁnd the stationary distribution.
The state space of Ann’s possible fortune is S = {0, 1, 2, . . .}. If i ≥1, the possible
transitions are to states i −1 and i + 1 and in state 0, Ann either wins and pays back
her uncle’s dollar or loses her uncle’s dollar, stays in 0, and borrows another dollar.
The transition graph is
1/2
1/2
1/2
1/2
1/2
1/2
1/2
...
2
0
1
and the transition matrix is
P =
⎛
⎜
⎜
⎜
⎜
⎝
1/2
1/2
0
0
0
. . .
1/2
0
1/2
0
0
. . .
0
1/2
0
1/2
0
. . .
...
...
...
...
...
...
⎞
⎟
⎟
⎟
⎟
⎠
The equation πP = π now gives the ﬁrst equation
1
2π0 + 1
2π1 = π0
which gives π1 = π0. The second equation is
1
2π0 + 1
2π2 = π1
which gives π2 = 2π1 −π0 = π0. The remaining equations all look the same:
1
2πn−2 + 1
2πn = πn−1, n ≥3
which gives πn = 2πn−1 −πn−2 = π0. Thus, a stationary distribution must be of the
form
π = (π0, π0, π0, . . .)

458
STOCHASTIC PROCESSES
which is obviously a problem since we cannot sum these probabilities to 1. If π0 = 0,
the sum is 0, and if π0 > 0, the sum is inﬁnite. We conclude that no stationary
distribution exists.
□
The technique used in this example to express all the πn in terms of π0 is the standard
way to try to ﬁnd a stationary distribution. In this case, it turned out to be impossible
since the πn did not sum to one.
Example 8.12. Reconsider the previous problem under the assumption that Bob has
an edge in the game, so that in each round Ann wins with probability p < 1
2.
The transition graph is now
1 − p
1 − p
1 − p
1 − p
p
p
p
...
2
0
1
and the transition matrix
P =
⎛
⎜
⎜
⎜
⎜
⎝
1 −p
p
0
0
0
. . .
1 −p
0
p
0
0
. . .
0
1 −p
0
p
0
. . .
...
...
...
...
...
...
⎞
⎟
⎟
⎟
⎟
⎠
The equation πP = π gives
(1 −p)π0 + (1 −p)π1 = π0
which gives
π1 =
p
1 −pπ0
The next equation is
pπ0 + (1 −p)π2 = π1
which gives
π2 =
1
1 −p(π1 −pπ0) =

p
1 −p
2
π0
The remaining equations are
pπn−2 + (1 −p)πn = πn−1

DISCRETE -TIME MARKOV CHAINS
459
and it is easily veriﬁed that
πn =

p
1 −p
n
π0, n = 0, 1, 2, . . .
satisfy these equations. To ﬁnd π0, we use the condition 
j∈S πj = 1 and get
1 = π0
∞

n=0

p
1 −p
n
= π0
1 −p
1 −2p
which gives stationary distribution
πn = 1 −2p
1 −p

p
1 −p
n
, n = 0, 1, 2, . . .
□
The Markov chains are irreducible and recurrent in both examples; the only difference
is that the probability 1
2 was replaced by p < 1
2 in the second. Why, then, does a
stationary distribution exist in the second but not the ﬁrst chain? We need to introduce
yet another classifying property for Markov chains.
Deﬁnition 8.6. Let i be a recurrent state. If Ei[τi] < ∞, then i is said to be positive
recurrent. If Ei[τi] = ∞, i is said to be null recurrent.
This is a more subtle distinction than between recurrence and transience. Any
recurrent state is revisited inﬁnitely many times, but only a positive recurrent state
is revisited in such a way that the expected time between visits is ﬁnite (recall from
Example 2.23 that a random variable can be ﬁnite and yet have an inﬁnite expectation).
Thus, recurrence/transience is distinguished by the τi themselves and positive/null
recurrence by the expected values Ei[τi]. It can be shown that positive recurrence is
also a class property, and hence we have the following corollary.
Corollary 8.4. For an irreducible Markov chain, there are three possibilities: (a)
all states are positive recurrent, (b) all states are null recurrent, and (c) all states
are transient.
Now consider a ﬁnite state space. There cannot be any null recurrent states, a fact
that we will not prove, but the intuition is that there simply is not enough room for
very long paths of return. Also recall that there must be at least one recurrent state
and hence this state must be positive recurrent. Thus, if a ﬁnite chain is irreducible, it
must also be positive recurrent. If the state space is inﬁnite, this is not true because of
(b) in Corollary 8.4. The following result covers both ﬁnite and inﬁnite state spaces.

460
STOCHASTIC PROCESSES
Proposition 8.4. Consider an irreducible Markov chain {Xn}. Then,
A stationary distribution π exists ⇔{Xn} is positive recurrent
If this is the case, π is unique and has πj > 0 for all j ∈S.
The intuition behind the result is not obvious, but we can look at the last two examples
for a comparison. By Proposition 8.4, all states are positive recurrent when p < 1
2,
something that can also be shown directly. We can think of this as there being a “pull”
toward 0 and the chain settles in toward a stationary distribution. Compare this with
the case p = 1
2 where there is no such pull and the chain wanders around aimlessly
forever. This is reﬂected in how the stationary distribution “tries to be uniform,” but
this is not possible on an inﬁnite state space. In general, think of a positive recurrent
Markov chain as one that makes a deliberate effort to revisit states, in contrast to a
null recurrent chain, which just happens to revisit states without really trying.
Note that Proposition 8.4 goes in both directions. Thus, if we can ﬁnd a stationary
distribution of an irreducible chain, we know two things: (1) the stationary distribution
is unique and (2) the chain is positive recurrent.
8.2.4
Convergence to the Stationary Distribution
In this section, we will state the main limit result for a Markov chain. Although the
proof is not beyond the scope of the text, we will not give it; instead, we will focus on
its interpretation and applications. For a proof, the interested reader may consult, for
example, Grimmett and Stirzaker, Probability and Random Processes [7]. In Example
8.6, we found the limit distribution of the Markov chain, and let us now formally deﬁne
this concept.
Deﬁnition 8.7. Let p(n)
ij be the n-step transition probabilities of a Markov chain. If
there exists a probability distribution q on S such that
p(n)
ij →qj
as n →∞for all i, j ∈S
we call q the limit distribution of the Markov chain.
Note that the limit distribution is the same for every initial state i ∈S. Another way
to express this is that the n-step transition matrix P(n) converges to a limit matrix in
which all rows are equal. The intuition behind the limit distribution is that qj describes
the probability that the chain is in state j at some late timepoint and that at this time,
the chain has “forgotten how it started.” We have seen in the examples that a limit
distribution does not always exist. If it does, however, it also qualiﬁes as a stationary
distribution (see Problem 13).

DISCRETE -TIME MARKOV CHAINS
461
The more interesting question is whether the converse is true: is the stationary
distribution also the limit distribution? This would give a nice computational recipe:
in order to ﬁnd the limit distribution we solve πP = π, which is typically much easier
than computing powers of the transition matrix. The following example shows that
there may be a problem.
Example 8.13. In the ON/OFF system in Example 8.4, suppose that p = q = 1, that is,
that the system always changes. Find the stationary distribution and limit distribution.
The stationary distribution satisﬁes
(π0 π1)
	
0
1
1
0

= (π0 π1)
which gives π0 = π1, so the stationary distribution is π = ( 1
2, 1
2). In this case, it is
easy to ﬁnd the n-step transition probabilities explicitly. For example,
p(n)
00 =

0
if n is even
1
if n is odd
and similarly for the other three n-step transition probabilities. But this means that the
n-step transition probabilities do not converge, and thus there is no limit distribution.
Recall how a limit distribution forgets where the chain started; in this case, if we start
in state 0, we know that the system will be in state 0 at every even timepoint and in
state 1 at every odd timepoint, no matter how late.
□
Thus, stationary distributions and limit distributions are not necessarily the same.
What is the intuition behind these concepts? Suppose that we look at a Markov chain
at some late time n. The stationary distribution then gives the long-term proportions
of time spent in the different states up to time n. The limit distribution, on the other
hand, gives the proportions of time spent in the states at time n (so we have to think of
the Markov chain being run up to time n multiple times). In the previous example, let
n = 1000. The stationary distribution ( 1
2, 1
2) tells us that equal amounts of time have
been spent in both states up to time n = 1000, regardless of the initial state. However,
if we look only at precisely time n = 1000, the chain must be in the same state that
it started in, and if we run the chain up to time n = 1000 from the same initial state,
the proportion of time in the other state is 0. For a theoretical result that motivates the
interpretation of the stationary distribution, see Problem 21.
The existence of a limit distribution is a desirable property of a Markov chain,
since it means that we can get an idea of the distribution over the state space at some
late, arbitrary timepoint. It turns out that the problem in the previous example is that
the chain is periodic, in the sense that returns from a state to itself can occur only in
an even number of steps.

462
STOCHASTIC PROCESSES
Deﬁnition 8.8. The period of state i is deﬁned as
d(i) = gcd{n ≥1 : p(n)
ii > 0}
the greatest common divisor of lengths of cycles through which it is possible to
return to i. If d(i) = 1, state i is said to be aperiodic; otherwise it is called periodic.
The concept of a period may not be immediately clear. Let us look at two examples.
Example 8.14. Find the periods of the states in the ON/OFF system with p = q = 1.
Since p(n)
00 > 0 whenever n is even and 0 otherwise, the set of n such that p(n)
00 > 0 is
{2, 4, 6, . . .} that has greatest common divisor 2. Thus, the period of state 0 is 2, which
means that the only possible return paths to state 0 have lengths that are multiples of
2. The period of state 1 is also 2.
□
Example 8.15. Find the period of the state 1 in the gambler’s ruin example (Example
8.11).
We have p(1)
11 = 0, p(2)
11 > 0, and p(3)
11 > 0, and since the greatest common divisor of
2 and 3 is 1, we do not need to go any further. State 1 is aperiodic, and we note that
this does not mean that it can reach itself in one step. See also Problem 14.
□
If all states are aperiodic, we call the whole Markov chain aperiodic. It can be shown
that periodicity is a class property in the sense that communicating states have the
same period. Thus, if we can show that one state is aperiodic in an irreducible chain,
the whole chain must be aperiodic. Aperiodicity is the last property we need to be
able to say that the stationary distribution and the limit distribution coincide. The
following is the main convergence theorem for Markov chains.
Theorem 8.1. Consider an irreducible, positive recurrent, and aperiodic Markov
chain with stationary distribution π and n-step transition probabilities p(n)
ij . Then
p(n)
ij →πj
as n →∞
for all i, j ∈S.
An irreducible, positive recurrent, and aperiodic Markov chain is called ergodic.
We have seen examples of what can go wrong when any of the three conditions
are removed. Take away irreducibility, and there may be more than one stationary
distribution; take away positive recurrence, and there may be none at all; take away

DISCRETE -TIME MARKOV CHAINS
463
aperiodicity, and there may be a unique stationary distribution that is not the limit
distribution.
We should also point out that positive recurrence is listed as an assumption. Positive
recurrence is an important characteristic of a Markov chain, describing its long-
term behavior, but it is typically not checked since it is easier to ﬁnd the stationary
distribution. The practical way to use the theorem is thus to check irreducibility and
aperiodicity and then go about solving πP = π. If this can be done, π is the limit
distribution, and we get positive recurrence for free.
Example 8.16 (Success Runs). A fair coin is ﬂipped repeatedly, and at time n, we
let Xn be the length of the current run of heads. For example, if we get the sequence
HTHHHT, we have (let X0 ≡0)
X1 = 1, X2 = 0, X3 = 1, X4 = 2, X5 = 3, X6 = 0
DescribethissequenceofsuccessrunsasaMarkovchainandﬁnditslimitdistribution.
The state space is S = {0, 1, 2, . . .}, and from a state i, transitions are possible to
either i + 1 or 0, with equal probabilities, giving the following transition graph:
1/2
1/2
1/2
1/2
1/2
1/2
...
2
0
1
The chain is clearly irreducible, so let us look for the stationary distribution. The
equation πP = π becomes
(π0, π1, . . .)
⎛
⎜
⎜
⎜
⎜
⎜
⎜
⎜
⎝
1/2
1/2
0
0
0
. . .
1/2
0
1/2
0
0
. . .
1/2
0
0
1/2
0
. . .
1/2
0
0
0
1/2
. . .
...
...
...
...
...
...
⎞
⎟
⎟
⎟
⎟
⎟
⎟
⎟
⎠
= (π0, π1, . . .)
and it is easily checked that the solution is
πk =
1
2k+1 , k = 0, 1, 2, . . .
which we recognize from Section 2.5.3 as a geometric distribution including 0, with
success probability p = 1
2. The last question is whether this also qualiﬁes as the limit
distribution and we need to check for aperiodicity. Consider state 0 and note that

464
STOCHASTIC PROCESSES
p00 > 0, which means that state 0 is aperiodic. Thus, by irreducibility, the entire
chain is aperiodic, Theorem 8.1 applies, and π is the limit distribution.
□
In a Markov chain with stationary distribution π, πi is the long-term frequency spent
in state i; thus, state i is revisited on average every 1/πi steps. Now consider another
state j. In any sequence of N steps, it is visited on average Nπj times, and we get the
following nice result, which we state without formal proof. We use the notation Ei
for expected value when the initial state is i.
Proposition 8.5. Consider an ergodic Markov chain with stationary distribution π
and choose two states i and j. Let τi be the return time to state i, and let Nj be the
number of visits to j between consecutive visits to i. Then
Ei[τi] = 1
πi
and
Ei[Nj] = πj
πi
Note that by positive recurrence, all the Ei[τi] are ﬁnite and hence all the πi are strictly
positive. The Ei[τi] are called the mean recurrence times.
Example 8.17. Consider Example 8.12. Suppose that Ann wins with probability
p = 1
3. (a) If Ann just went broke, what is the expected number of rounds until she
is broke again? (b) If Ann reaches a fortune of $5, how many times can she expect
to go broke before reaching that fortune again?
We are asking for E0[τ0] and E5[N0], and by Proposition 8.5, these are
E0[τ0] = 1
π0
=
1
1/2 = 2
and
E5[N0] = π0
π5
= 1/2
1/64 = 32
□
8.3
RANDOM WALKS AND BRANCHING PROCESSES
In this section, we will look at two special cases of Markov chains: random walks and
branching processes. Although they are examples of Markov chains, their properties
are such that the methods we have explored do not reach very far and we instead
analyze them by methods that are suited to their particular nature.
8.3.1
The Simple Random Walk
Many of the examples we looked at in the previous section are similar in nature.
For example, the roulette example and the various versions of gambler’s ruin have in

RANDOM WALKS AND BRANCHING PROCESSES
465
common that the states are integers and the only possible transitions are one step up
or one step down. We now take a more systematic look at such Markov chains, called
simple random walks. A simple random walk can be described as a Markov chain
{Sn} that is such that
Sn =
n

k=1
Xk
where the Xk are i.i.d. such that P(Xk = 1) = p, P(Xk = −1) = 1 −p.
The term “simple” refers to the fact that only unit steps are possible; more generally
we could let the Xk have any distribution on the integers. The initial state S0 is usually
ﬁxed but could also be chosen according to some probability distribution. Unless
otherwise mentioned, we will always have S0 ≡0. If p = 1
2, the walk is said to be
symmetric. It is clear from the construction that the random walk is a Markov chain
with state space S = {. . . , −2, −1, 0, 1, 2, . . .} and transition graph
–1
p
p
p
p
1 − p
1 − p
1 − p
1 − p
...
1
0
...
Note how the transition probabilities pi,i+1 and pi,i−1 do not depend on i, a property
called spatial homogeneity. We can also illustrate the random walk as a function of
time, as was done in Example 1.58. Note that this illustrates one particular outcome
of the sequence S0, S1, S2, . . ., called a sample path, or a realization, of the random
walk.
It is clear that the random walk is irreducible, so it has to be transient, null recurrent,
or positive recurrent, and which one it is may depend on p. The random walk is a
Markov chain where we can compute the n-step transition probabilities explicitly and
apply Proposition 8.1. Consider any state i, and note ﬁrst that
p(2n−1)
ii
= 0, n = 1, 2, . . .
since we cannot make it back to a state in an odd number of steps. To make it back in
2n steps, we must take n steps up and n steps down, which has probability
p(2n)
ii
=
2n
n

pn(1 −p)n = (2n)!
n!n! (p(1 −p))n
(8.1)
and since convergence of the sum of the p(2n)
ii
is not affected by the values of any
ﬁnite number of terms in the beginning, we can use an asymptotic approximation of
n!, Stirling’s formula, which says that
n! ∼nn√n e−n√
2π

466
STOCHASTIC PROCESSES
where “∼” means that the ratio of the two sides goes to 1 as n →∞. The practical
use is that we can substitute one for the other for large n in the sum in Proposition
8.1. Thus,
p(2n)
ii
∼(4p(1 −p))n
√πn
and if p = 1
2, this equals 1/√πn and the sum over n is inﬁnite. If instead p /= 1
2, p(2n)
ii
is of the form xn/√πn where |x| < 1 and the sum over n converges. This shows that
the simple random walk is recurrent if p = 1
2 and transient if p /= 1
2.
The next question is whether the case p = 1
2 is positive recurrent or null recurrent.
Repeating the argument from Example 3.35 shows that regardless of whether the ﬁrst
step is up or down, the expected time until return to 0 is inﬁnite. We summarize as
follows.
Proposition 8.6. The simple random walk is null recurrent if p = 1
2 and transient
if p /= 1
2.
In particular, this means that there is never a stationary distribution, so the theory
for Markov chains does not give us anything further, but there are still interesting
questions regarding the behavior of the random walk. Recall τ1, the time of the ﬁrst
visit to state 1. From Examples 1.59 and 3.35, we know that P0(τ1 < ∞) = 1 and
E0[τ1] = ∞, if p = 1
2. What about other values of p? If p > 1
2, we must still have
P0(τ1 < ∞) = 1 but what if p < 1
2? Let us use recursion and again condition on the
ﬁrst step. With r = P0(τ1 < ∞), we get
r = p + (1 −p)r2
which has solutions r = 1 and r = p/(1 −p). We can exclude r = 1, since if the
probability to reach 1 in ﬁnite time equals 1, the same must be true for −1 (more
likely to go down than up), but then by symmetry, the probability is also 1 that the
walk gets back to 0 again in ﬁnite time, which contradicts transience. We get the
following result.
Corollary 8.5. The probability that the walk ever visits 1 is
P0(τ1 < ∞) =
⎧
⎪
⎪
⎨
⎪
⎪
⎩
1
if p ≥1/2
p
1 −p
if p < 1/2
Thus, if p < 1
2, the probability is p/(1 −p) that the walk never visits the positive
axis. If it does visit the positive axis, how far does it get? According to the following
result, not very far.

RANDOM WALKS AND BRANCHING PROCESSES
467
Corollary 8.6. The simple random walk with p < 1
2 visits only ﬁnitely many states
on the positive axis.
Proof. Let A be the event that the walk visits all positive states and Ar the event that
the walk eventually visits state r. Then
A =
∞

r=1
Ar
where the events Ar are decreasing (must have visited r in order to visit r + 1).
Moreover, in order to visit r, the walk must ﬁrst visit 1, then 2, and so on, and by
Corollary 8.2 and Proposition 1.6, we obtain
P(A) = lim
r→∞P(Ar) = lim
r→∞

p
1 −p
r
= 0
since p < 1
2.
■
We can continue the argument in the proof. Since the walk makes it up only to some
maximum integer, it must eventually leave the positive axis for good. But then it is at
−1, and the same argument says that it must eventually hit −2, never to return to −1
again. Thus, for any number, the random walk will eventually stay below it forever,
and we have argued that the simple random walk with p < 1
2 drifts toward −∞. In
obvious analogy, if p > 1
2, the walk drifts toward ∞. In Problem 27, you are asked
to compute the probability that the transient random walk ever returns to 0 (right now
all we know is that this probability is < 1). In the remaining case, p = 1
2, the walk
must visit all states inﬁnitely many times (why?) and must, like Ahasverus, wander
aimlessly forever.
We next turn to expected values. If the walk starts in 0, what is the expected time
until its ﬁrst visit to 1? If p < 1
2, it must be inﬁnite, since the random variable τ1
itself may be inﬁnite. If p = 1
2, can E0[τ1] be ﬁnite? If it were, then the expected
time to visit −1 would by symmetry also be ﬁnite. But then the expected time back
to 0 again would also be ﬁnite, which contradicts null recurrence. Thus, if p ≤1
2, we
have E0[τ1] = ∞. It remains to investigate what happens when p > 1
2. We will use
a recursive approach, in the spirit of Example 3.35. Let μ = E0[τ1] and condition on
the ﬁrst step to get the equation
μ = p × 1 + (1 −p)(1 + 2μ)
which we solve for μ to get μ = 1/(2p −1). Note, however, that also μ = ∞is a
solution, so we need to argue that this can be ruled out. First note that τ1 = 2n + 1
if the walk is back at 0 at time 2n, without having visited 1, then goes up to 1 in the

468
STOCHASTIC PROCESSES
following step. The probability to be back at 0 at time 2n without any restrictions is
p(2n)
00 , and hence
P0(τ1 = 2n + 1) ≤p × p(2n)
00
∼p(4p(1 −p))n
√πn
and since 4p(1 −p) < 1, E0[τ1] = 
n(2n + 1)P0(τ1 = 2n + 1) must be ﬁnite. We
summarize as follows.
Corollary 8.7. The expected time until the ﬁrst visit to 1 is
E0[τ1] =
⎧
⎪
⎪
⎨
⎪
⎪
⎩
1
2p −1
if p > 1/2
∞
if p ≤1/2
8.3.2
Multidimensional Random Walks
Let us now consider a two-dimensional simple random walk and investigate it with
regard to transience/recurrence. First, how do we deﬁne it? In one dimension, if the
walkisati,itchoosesoneoftheneighboringpointsi −1andi + 1.Intwodimensions,
there are different ways to deﬁne neighboring points. One way is to consider the four
neighbors parallel with the axes; another, to consider the four neighboring corner
points.
Regardless of deﬁnition, we will assume that the walk is symmetric so that each
neighbor is chosen with probability 1
4; otherwise, the walk is transient (why?). Also,
since all we are interested in is transience/recurrence, it does not matter which def-
inition we choose because in each case there are four equally likely neighbors (one
case is just a 45◦rotation of the other). We will go for the second version, choosing
the corners with equal probabilities. The reason for this is that we can then view the
two-dimensional random walk as two independent one-dimensional random walks,
one on each axis. Thus, let
Sn = (S(1)
n , S(2)
n ), n = 0, 1, 2, . . .
where we let S0 = (0, 0). Then Sn = (0, 0) if and only if S(1)
n
= S(2)
n
= 0 and by
independence and Equation (8.1),
P(Sn = (0, 0)) = P(S(1)
n
= 0)P(S(2)
n
= 0) =
2n
n
 1
4n
2
and by Stirling’s formula
P(Sn = (0, 0)) ∼1
πn

RANDOM WALKS AND BRANCHING PROCESSES
469
and since 
n
1
n = ∞, we conclude that the simple random walk in two dimensions is
recurrent(andmustbenullrecurrent).Butlooknowwhathappensinthreedimensions.
By deﬁning
P(Sn = (S(1)
n , S(2)
n , S(3)
n ), n = 0, 1, 2, . . .
where S(1)
n , S(2)
n , and S(3)
n
are independent symmetric random walks and letting S0 =
(0, 0, 0), we get
P(Sn = (0, 0, 0)) ∼
1
(πn)3/2
and since 
n
1
n3/2 < ∞, we conclude that the walk is now transient. This might be
a bit surprising, and there is no immediate intuition for why the walk always returns
to the origin in one and two dimensions but not in three. We know that each of the
three individual walks returns to 0 inﬁnitely many times, but only ﬁnitely many times
will they do so simultaneously. We can deﬁne the random walk in any number of
dimensions and conclude the following.
Corollary 8.8. The symmetric simple random walk in n dimensions is recurrent for
n = 1 and n = 2, and transient for n ≥3.
One thing needs to be pointed out. In two dimensions, we argued that the deﬁnition
of a neighboring point does not matter since there are four neighbors with either
deﬁnition. This is not true in dimensions n ≥3. For example, in three dimensions,
there is a difference in choosing between the eight corner points and the six points
along the axes. We chose the ﬁrst deﬁnition, and the chance of return to the origin
ought to be higher with the second since there are fewer choices in each step. However,
it can be shown that the probability of return is still less than one and also this variant
of the three-dimensional random walk is transient (see Problem 29).
8.3.3
Branching Processes
To steal a line of British humo(u)r from Grimmett and Stirzaker [7]: “Besides gam-
bling, many probabilists have been interested in reproduction.” In this section, we
analyze a simple model for populations that are composed of individuals who re-
produce independent of each other. Suppose that we start from one individual, the
ancestor, who gets a number of children, X, with range {0, 1, 2, . . .} and pmf pX.
We refer to this pmf as the offspring distribution. Each child then reproduces in-
dependently according to the offspring distribution, their children reproduce in the
same way, and so on. The resulting evolving population is an example of a branching
process (see Figure 8.1).4 To describe it mathematically, we let Zn be the number of
4In this simple form, it is usually called a Galton–Watson process, after the previously mentioned Sir
Francis Galton, who worried about extinction of the English nobility, and Henry W. Watson, mathematician,
clergyman, and mountaineer, who advocated the use of generating functions to solve the problems. In les

470
STOCHASTIC PROCESSES
. . .
FIGURE 8.1
A branching process with Z0 = 1, Z1 = 3, and Z2 = 3.
individuals in the nth generation, and let Z0 ≡1. The generation sizes relate to each
other as
Zn =
Zn−1

k=1
Xk, n = 1, 2, . . .
(8.2)
where the Xk are i.i.d. with pmf pX. The formula states that in order to get the number
of individuals in any generation, we go through the individuals in the preceding
generation and sum their numbers of children. Note that in each generation we get a
new set of Xk, which if needed can be indicated by a superscript, X(n−1)
k
, the number
of children of the kth individual in the (n −1)st generation.
We are interested in the behavior of Zn and will focus on two issues: extinction
and population growth. Note that the process {Zn} is a Markov chain but the transition
probabilities are complicated and it is also clear that state 0 is absorbing, so the Markov
chain methods that we know will not be of much help. Let us from now on exclude
the two uninteresting cases pX(0) = 1 and pX(1) = 1. (Why are these uninteresting?)
From Equation (8.2) it is clear that
Zn = 0 ⇒Zn+1 = 0
(8.3)
in which case the population has gone extinct. Now let E be the event that the pop-
ulation goes extinct eventually, that is, the event that some generation size is 0. This
event can be described as
E =
∞

n=1
{Zn = 0}
and to ﬁnd the probability of E, we will use probability generating functions. Thus,
let X have pgf G, and let Zn have pgf Gn. Then G1 = G (why?) and by Equation
pays francophones, the name of Bienaym´e is usually also added, which is only fair since the work of I. J.
Bienaym´e precedes that of Galton and Watson.

RANDOM WALKS AND BRANCHING PROCESSES
471
(8.2) and Proposition 3.39, we get the relation
Gn(s) = Gn−1(G(s)), n = 2, 3, . . .
(8.4)
By Equation (8.3), we realize that the events {Zn = 0} are increasing in n, and Corol-
lary 3.12 and Proposition 1.6 together give
P(E) = lim
n→∞P(Zn = 0) = lim
n→∞Gn(0)
Example 8.18. Consider a population of cells that may either die or reproduce,
according to the following random variable:
X =

0
with probability 1/4
2
with probability 3/4
Find the probability of extinction.
We have
G(s) = 1
4 + 3
4s2
which gives G(0) = 1
4, the probability that extinction occurs already in the ﬁrst gen-
eration. For G2, we use Equation (8.4) and obtain
G2(s) = G(G(s)) = 1
4 + 3
4
1
4 + 3
4s2
2
which gives G2(0) = 19
64. Already here we realize that it will be hard to ﬁnd P(E) in
this way; remember that we need to ﬁnd the limit of Gn(0) as n →∞and a pattern
for the sequence does not readily emerge. We give up.
□
The branching process in this example is about as simple as they come, and yet it is
virtually impossible to ﬁnd the extinction probability as the limit of Gn(0). Luckily,
there is a much quicker way.
Proposition 8.7. Consider a branching process where the offspring distribution has
pgf G, and let E be the event of extinction. Then q = P(E) is the smallest solution
in [0, 1] to the equation s = G(s).
Proof. Let us ﬁrst show that q is a solution and then that it must be smaller than any
other solution. Condition on the number of children, X, of the ancestor and note that if

472
STOCHASTIC PROCESSES
X = k, then there are k independent branching processes that must go extinct, which
has probability qk (true also for k = 0). This gives the following observation:
q =
∞

k=0
P(E|X = k)P(X = k) =
∞

k=0
qkP(X = k) = G(q)
and we see that the extinction probability solves the equation s = G(s).
Suppose that there is another solution r ∈[0, 1]. By Problem 133 in Chapter 3,
G(s) is increasing, and since r ≥0, we get
r = G(r) ≥G(0)
Applying G again gives r = G(r) ≥G(G(0)) = G2(0) and repeating the argument
gives
r ≥Gn(0)
for all n
But since Gn(0) →q, we also get r ≥q, and hence q is the smallest solution to the
equation s = G(s).
■
Example 8.19. In Example 8.18, we get the equation
s = 1
4 + 3
4s2
which has solutions 1
3 and 1. Thus, the probability of extinction is 1
3.
□
Note that any pgf has the property G(1) = 1, and hence s = 1 is always a solution
to the equation s = G(s).5 Let us now turn to the question of population growth.
More speciﬁcally, we will ﬁnd the mean and variance of the nth-generation size Zn.
Equation (8.2) is central, and we can apply Corollary 3.13 to obtain the following
result.
Proposition 8.8.
Consider a branching process where the offspring distribution
has mean μ and variance σ2. Then
E[Zn]
= μn
Var[Zn] =
⎧
⎪
⎪
⎨
⎪
⎪
⎩
nσ2
if μ = 1
σ2(μn −1)μn−1
μ −1
if μ /= 1
5Watson, whose work was published in 1875, found the solution s = 1 but overlooked the fact that there
could be more solutions and erroneously concluded that extinction is always inevitable. It took yet another
half century and Danish ingenuity to completely solve the problem, done by J. F. Steffensen in 1930.

RANDOM WALKS AND BRANCHING PROCESSES
473
Proof. For the mean, repeatedly apply Corollary 3.13 to Equation (8.2) and get
E[Zn] = E[Zn−1]μ = E[Zn−2]μ2 = · · · = μn
since E[Z0] = 1. We leave it as an exercise to verify that the expression for the
variance satisﬁes Corollary 3.13.
■
The proposition thus tells us that
E[Zn]
⎧
⎪
⎨
⎪
⎩
→0
if μ < 1
≡1
if μ = 1
→∞
if μ > 1
and that
Var[Zn]
⎧
⎪
⎨
⎪
⎩
→0
if μ < 1
→∞
if μ = 1
→∞
if μ > 1
This suggests that the population always goes extinct if μ < 1 since the mean and
variance both go to 0 and Zn itself can take on only integer values. It is less clear
what happens in the other two cases, but the following result gives the answer.
Proposition 8.9. Consider a branching process with mean number of children μ.
Then
μ ≤1 ⇒P(E) = 1
μ > 1 ⇒P(E) < 1
Proof. If pX(0) = 0, then μ > 1 and P(E) = 0. Now suppose that pX(0) > 0, and
recall from Section 3.11 that μ = G′(1), the slope at the point s = 1. By Problem
133 in Chapter 3, G(s) is convex and increasing, and since it has to increase from
G(0) = pX(0) > 0 to G(1) = 1, it must intersect the line y = s if μ > 1, and the
intersection is the extinction probability, which is < 1. If instead μ ≤1, there can
be no such intersection, and the extinction probability is 1. See Figure 8.2 for the
two possible cases. Note that this also shows that there can never be more than two
solutions in [0, 1] to the equation s = G(s).
■
This result is quite remarkable. It says that whether extinction occurs for certain
depends only on the mean number of children, and if this is less than or equal to
1, there will be extinction sooner or later. If μ > 1, extinction may be avoided and
the probability of this is found by solving the equation s = G(s). The cases μ > 1,
μ = 1, and μ < 1 are called the supercritical, critical, and subcritical, respectively.
Although extinction is certain in the last two, they exhibit some differences in behavior
that motivates the distinction (see Problem 30).

474
STOCHASTIC PROCESSES
0
0.5
1
0 
 0.2 
0.4 
0.6 
0.8 
1 
0
0.5
1
0 
 0.2 
0.4 
0.6 
0.8 
1 
FIGURE 8.2
Plots of the pgf G(s) of the offspring distribution and the line y = s, in the
cases μ = G′(1) ≤1 (left) and μ = G′(1) > 1 (right).
Example 8.20. An individual with a contagious disease enters a large city. Suppose
that he passes the disease on to a number of people, who in turn pass it on to others,
and so on. Suppose that each individual remains contagious for 1 day and in this day
interacts with a number of people that has a Poisson distribution with mean 10 and
that for each person, the probability of infection is p. (a) For which values of p does
the disease eventually die out? (b) If p = 0.2, what is the probability that the disease
still exists in the population on day 2? (c) For p = 0.2, what is the probability that
the disease eventually disappears?
The number of infected “children” of an individual has a Poisson distribution with
mean 10p, so the disease eventually dies out if p ≤0.1. For part (b), we need to
compute P(Z2 = 0) = G2(0), and since
G(s) = e2(s−1)
we get
P(Z2 = 0) = e2(e−2−1) ≈0.18
so the probability that the disease still exists is 0.82. For (c), we need numerically to
solve the equation
s = e2(s−1)
which gives q ≈0.2. The spread of a disease may be adequately modeled by a branch-
ing process in its early stages but as time goes on, such a model becomes less realistic.
There are several reasons for this, which we leave for the reader to ponder.
□
The ﬁnal question is what happens if there is no extinction. As it turns out, the only
other possibility is for Zn to go to inﬁnity. We will not give a strict proof but refer to an
intuitive argument. Suppose that Zn does not go to inﬁnity. Then there is some integer

CONTINUOUS -TIME MARKOV CHAINS
475
K such that Zn drops below K inﬁnitely many times. But each time it does, there is
a chance that it goes extinct before the next time it drops below K. The probability
of this is at least pX(0)K since the “worst case” is when the population goes extinct
already in the next generation. But this means that the population must become extinct
sooner or later (think geometric trials here), and we have argued that if Zn does not
go to inﬁnity, the population must become extinct. In terms of probabilities
P(Zn /→∞) ≤P(E)
and since the reversed inequality obviously also holds (if there is extinction, the
populations size cannot go to inﬁnity), the probabilities are equal. We have argued
for the following result.
Proposition 8.10. Consider a branching process with extinction probability q. Then
Zn →

0
with probability q
∞
with probability 1 −q
as n →∞.
Note that “Zn →0” is just another way of saying “extinction,” since Zn takes on only
integer values. We can describe this result by saying that the sequence of random vari-
ables Z1, Z2, . . . converges to a random variable Z as n →∞, where Z is either 0 or
∞with probabilities q or 1 −q, respectively. To be perfectly strict, we need to say that
this convergence takes place with probability 1 since we can describe other types of se-
quences. For example, in a population of dividing cells let us say that Z1 = 2. It could
then happen that one divides and the other dies so that Z2 = 2 also. If the same thing
happens again, Z3 = 2, and we can continue to describe a sequence Z1, Z2, . . . where
Zn = 2 for all n. However, it can be shown that this sequence together with all other
sequences that do not converge to 0 or ∞belong to an event that has probability 0. This
is an example of convergence almost surely, mentioned in footnote 1 in Section 4.2.
8.4
CONTINUOUS -TIME MARKOV CHAINS
We have studied Markov chains in discrete time and will now turn to their counterpart
in continuous time. This means that the chains stay in each state a random time that
is a continuous random variable with a distribution that may depend on the state. The
state of the chain at time t is denoted X(t), where t ranges over the nonnegative real
numbers. In addition to having the Markov property for the jumps, we also want the
jumps to be independent of how long a time that is spent in a speciﬁc state, and in
order to achieve this, we recall that there is only one continuous distribution that would
ensure this property: the exponential distribution.6 We state the following deﬁnition.
6We are leaving out some subtle technicalities here that the interested reader may ﬁnd, for example, in
Grimmett and Stirzaker, Probability and Random Processes [7].

476
STOCHASTIC PROCESSES
Deﬁnition 8.9. Let {X(t), t ≥0} be a collection of discrete random variables taking
values in some set S and that evolves in time as follows:
(a) If the current state is i, the time until the state is changed has an exponential
distribution with parameter λ(i).
(b) When state i is left, a new state j /= i is chosen according to the transition
probabilities of a discrete-time Markov chain.
Then {X(t)} is called a continuous-time Markov chain.
Thus, a continuous-time Markov chain {X(t)} is composed of a discrete-time Markov
chain {Xn}, the jump chain, for the transitions and exponential random variables
for the holding times. Recall that the holding times in a discrete Markov chain are
geometric, the discrete counterpart of the exponential (see Section 2.6), so this is
a natural assumption. The λ(i) are called the holding-time parameters. Note that
the state space is still ﬁnite or countably inﬁnite; the discrete/continuous distinction
refers to how time is measured. Let us also mention that sometimes the term Markov
process is used in continuous time. We will not formally state the Markov property
but intuitively it says that conditioned on the current state and time, where and when
the chain jumps next is independent of the complete history of the chain.
Our construction also ensures that the process is time-homogeneous, that is, the
probability P(X(s + t) = j |X(s) = i) depends only on time through the difference
(s + t) −s = t, and we can deﬁne the transition probabilities as
pij(t) = P(X(t) = j |X(0) = i)
the probability that the chain is in state j, t time units after having been in state i. For
each t, we then get a transition matrix P(t) with entries pij(t), i, j ∈S, which has the
following properties.
Proposition 8.11. Let P(t) be the transition matrix for a continuous-time Markov
chain with state space S. Then
(a) P(0) = I, the identity matrix
(b)

j∈S
pij(t) = 1 for all i ∈S and t ≥0
(c) P(s + t) = P(s)P(t)( Chapman–Kolmogorov equations)
When you talk to mathematicians, make sure to refer to the set {P(t), t ≥0} as a
stochastic semigroup.

CONTINUOUS -TIME MARKOV CHAINS
477
Proof. Parts (a) and (b) are obvious. For (c), consider an element pij(s + t) of P(s + t)
and condition on an intermediate state k at time s to obtain
pij(s + t) =

k∈S
Pi(X(s + t) = j |X(s) = k)Pi(X(s) = k|X0 = i)
=

k∈S
pik(s)pkj(t)
which is the (i, j)th entry in the matrix P(s)P(t).
■
One problem is that P(t) is usually difﬁcult or impossible to compute, in the same
way as P(n) may be in the discrete case. In the discrete case, however, we know
that P(n) = Pn, so all the information we need is contained in the one-step transition
matrix P. In the continuous case there is no analog of “one step,” so we need to
proceed differently in search of a more compact description.
Let the jump chain have transition probabilities pij for i /= j and consider the chain
in a state i. The holding time is exp(λ(i)) and when it leaves, the chain jumps to state
j with probability pij. Now, if we consider the chain only when it is in state i and
disregard everything else, we can view the jumps from i as a Poisson process with
rate λ(i). For any other state j, the jumps from i to j is then a thinned Poisson process
with rate λ(i)pij. Thus, for any pair of states i and j, we can deﬁne the transition rate
between i and j as
γij = λ(i)pij
In addition to these, we also let
γii = −

j /= i
γij
and deﬁne the generator as the matrix G whose (i, j)th entry is γij. Note that once
the γij have been inserted, the diagonal elements γii are chosen such that G has row
sums equal to 0. The generator completely describes the Markov chain, since if we
are given G, we can retrieve the holding-time parameters as
λ(i) = −γii,
i ∈S
and the jump probabilities as
pij = −γij
γii
,
j /= i
Note that pii = 0 for all i ∈S since the pij give the probability distribution when the
chain leaves a state and there can be no jumps from a state to itself (see also Problem
36). Let us look at a few examples.
Example 8.21. An ON/OFF system stays OFF for a time that is exp(λ) and ON for a time
exp(μ) (μ does not denote the mean here). Describe the system as a continuous-time
Markov chain.

478
STOCHASTIC PROCESSES
The holding-time parameters are λ and μ, and the only possible jumps are from 0
(OFF) to 1 (ON) and vice versa. Thus, we have
γ01 = λ, γ10 = μ
and after ﬁlling in the diagonal elements, we get generator
G =
	
−λ
λ
μ
−μ

We can also describe the system in a graph as follows:
1
0
λ
μ
This is similar to how we described discrete-time Markov chains but the numbers on
the arrows are now rates, not probabilities. The jump chain has transition matrix
P =
	
0
1
1
0

□
Example 8.22. A continuous-time Markov chain on state space {1, 2, 3} has generator
G =
⎛
⎜
⎝
−6
2
4
1
−2
1
3
1
−4
⎞
⎟
⎠
Suppose that the chain is in state 1. What is the expected time until it leaves, and
what is the probability that it next jumps to state 2?
The holding-time parameter in state 1 is λ(1) = −γ11 = 6, so the expected holding
time is 1
6. The probability to jump to state 2 is
p12 = −γ12
γ11
= −2
−6 = 1
3
□
The generator now plays the role that the transition matrix did in the discrete case,
and a logical question is how G relates to P(t). The following proposition gives the
answer, where P′(t) denotes the matrix of the derivatives p′
ij(t).

CONTINUOUS -TIME MARKOV CHAINS
479
Proposition 8.12. The transition matrix P(t) and generator G satisfy the backward
equations
P′(t) = GP(t), t ≥0
and forward equations
P′(t) = P(t)G, t ≥0
If we spell out the backward equations elementwise, we get
p′
ij(t) =

k∈S
γikpkj(t), i, j ∈S, t ≥0
and the forward equations
p′
ij(t) =

k∈S
pik(t)γkj, i, j ∈S, t ≥0
Proof. We refer to an intuitive argument and leave out the technical details. Consider
the probability pij(t + h) = Pi(X(t + h) = j). TheChapman–Kolmogorov equations
give
pij(t + h) =

k∈S
pik(t)pkj(h)
and if h is small, we have, with Tj denoting the holding time in state j,
pjj(h) = P(X(h) = j|X(0) = j) ≈P(Tj > h) = e−λ(j)h
≈1 −λ(j)h = 1 + γjjh
The intuition behind this is that if h is small and the chain is in state j at times 0 and h,
most likely nothing happened in the interval (0, h). With a similar argument, if there
is a jump in (0, h), we neglect the possibility of more than one jump and obtain
pkj(h) ≈γkjh, k /= j
This gives
pij(t + h) ≈pij(t)(1 + γjjh) +

k /= j
pik(t)γkjh
= pij(t) + h

k∈S
pik(t)γkj

480
STOCHASTIC PROCESSES
which gives
pij(t + h) −pij(t)
h
=

k∈S
pik(t)γkj
and letting h ↓0 gives the forward equations, with a similar type of argument for the
backward equations.
■
It turns out that the forward equations are usually easier to solve but do not always
exist (a fact that is not revealed by our intuitive argument above). In all examples
and applications we consider, they do, however, exist. It is usually difﬁcult to solve
the backward and forward equations and only in simple cases can we easily ﬁnd the
explicit form of P(t). In Problem 34, you are asked to ﬁnd the solution for the simple
ON/OFF system.
Since P(0) = I, the backward and forward equations also suggest a way to obtain
the generator from P(t) according to
G = P′(0)
(8.5)
8.4.1
Stationary Distributions and Limit Distributions
Justasinthediscretecase,weareinterestedinasymptoticbehavior,whichisdescribed
by the limit of P(t) as t →∞and also as in the discrete case, we would like to do
this via stationary distributions instead of direct calculations. A limit distribution in
the continuous case is the obvious analog of the discrete case: a distribution q such
that
pij(t) →qj,
as t →∞for all i, j ∈S
How should we deﬁne a stationary distribution? In the discrete case, it is deﬁned
through the relation π = πP, but in the continuous case there is no P. However, since
a stationary distribution “stays forever,” we also have π = πP(n) for all n, and we can
imitate this in the continuous case.
Deﬁnition 8.10. Consider a continuous-time Markov chain with transition matrix
P(t). A probability distribution π which is such that
πP(t) = π for all t ≥0
is called a stationary distribution of the chain.
The intuition is the same as in the discrete case; the probability πj is the proportion
of time spent in state j in the long run. Since we have pointed out how difﬁcult it

CONTINUOUS -TIME MARKOV CHAINS
481
typically is to ﬁnd P(t), the deﬁnition does not give a computational recipe. Instead,
we ﬁrst differentiate with respect to t on both sides in the deﬁnition to obtain
d
dt (πP(t)) = πP′(t) = d
dt (π) = 0, t ≥0
since π does not depend on t. In particular, with t = 0, Equation (8.5) gives P′(0) = G
and we have shown the following.
Corollary 8.9. The stationary distribution satisﬁes the equation
πG = 0
where 0 is a vector of zeros.
Elementwise, the equations are

i∈S
γijπi = 0, j ∈S
and as in the discrete case, we have the additional condition that the entries in π sum
to 1.
Example 8.23. Consider the ON/OFF system in Example 8.21. Find the stationary
distribution.
The equation πG = 0 is
(π0, π1)
	
−λ
λ
μ
−μ

= (0, 0)
which gives the ﬁrst equation
−π0λ + π1μ = 0
which in turn gives
π1 = λ
μπ0
and the condition π0 + π1 = 1 gives
1 = π0

1 + λ
μ

and we get stationary distribution
(π0, π1) =

μ
μ + λ,
λ
μ + λ


482
STOCHASTIC PROCESSES
Note how π0 > π1 if μ > λ, that is, when the transition rate is higher from 1 to 0
than vice versa. Also note that
(π0, π1) =

1/λ
1/λ + 1/μ,
1/μ
1/λ + 1/μ

which is intuitively appealing since the expected times spent in states 0 and 1 are 1/λ
and 1/μ, respectively. Thus, in the long run, the proportions of time spent in states 0
and 1 are π0 and π1.
Recall that the jump chain has stationary distribution ( 1
2, 1
2), which tells us that the
jump chain on average visits 0 and 1 equally many times but does not take holding
times into account.
□
The existence of a stationary distribution is again closely related to the concepts
of irreducibility and positive recurrence. Irreducibility is only a property of how the
states communicate and has nothing to do with holding times, so we call a continuous-
time Markov chain irreducible if its jump chain is irreducible. As for recurrence and
transience, they are deﬁned in the analogous way, letting
Si = inf{t : X(t) = i}
where Si = ∞if i is never visited. The only difference from the discrete case is that
Si is now a continuous random variable and the following deﬁnition is a direct analog.
Deﬁnition 8.11. If Pi(Si < ∞) = 1, state i is called recurrent and if Pi(Si < ∞) <
1, state i is called transient. If i is recurrent and Ei[Si] < ∞, i is called positive
recurrent; otherwise it is called null recurrent.
We use the notation S for “sum,” since Si is the sum of the holding times in all states
visited before reaching i. We keep the notation τi for the return times in the jump
chain. Thus, if the holding time in state k is Tk, then Si and τi relate as
Si =
τi−1

n=0
TXn
(8.6)
Now suppose that state i is recurrent in the jump chain {Xn}. This means that τi
presented above is ﬁnite, and since also the Tk are ﬁnite, Si must be ﬁnite and i is
recurrent also in {X(t)}. Thus, if the jump chain is recurrent, so is the continuous-time
chain {X(t)}. When it comes to positive recurrence, things are more complicated, as
the following example shows.
Example 8.24. Consider the following continuous-time version of the success run
chain from Example 8.16. The holding time parameters are λ(k) = 1/2k for k =
0, 1, 2 . . ., and the success run chain functions as the jump chain, with the exception
that p01 = 1. Show that the jump chain {Xn} is positive recurrent but {X(t)} is not.

CONTINUOUS -TIME MARKOV CHAINS
483
The state space is S = {0, 1, 2, . . .} and the transition matrix of the jump chain differs
from that of the success run chain only in that it has p01 = 1 instead of p00 = p01 = 1
2.
It is easy to ﬁnd the stationary distribution (see Problem 16) and this shows that {Xn}
is positive recurrent.
Now consider state 0. Equation (8.6) is extra simple since the jump chain increases
by unit steps until it drops back to 0, which gives Xn = n for n < τ0, and we get
S0 =
τ0−1

n=0
Tn
Since the state 0 is recurrent in {Xn}, it is recurrent also in {X(t)}. However, we will
show that state 0 is null recurrent in {X(t)} and thus proceed to compute the expected
value of S0. To do so, we condition on τ0 and note that the range of τ0 is {2, 3, . . .}.
If τ0 = k, S0 is the sum of T1, . . . , Tk−1 and hence
E0[S0|τ0 = k] =
k−1

n=0
E[Tn] =
k−1

n=0
2n = 2k −1
and the distribution of τ0 is
P0(τ0 = k) =
1
2k−1 , k = 2, 3, . . .
since τ0 = k precisely when there are k −1 successes followed by a failure, where k
must be at least 2. We get
E0[S0] =
∞

k=2
E0[S0|τ0 = k]P0(τ0 = k)
=
∞

k=2
(2k −1)
1
2k−1 =
∞

k=2

2 −
1
2k−1

= ∞
which means that state 0 is null recurrent in the continuous-time chain X(t). By
irreducibility, the entire continuous-time chain is null recurrent. The problem is that
even though the jump chain is positive recurrent, the holding times get so long that
the continuous chain becomes null recurrent.
□
If the holding times are instead very short, it is possible that {Xn} is null recurrent but
{X(t)} is positive recurrent (see Problem 38). It is also possible to construct examples
where the jump chain is transient but the continuous-time chain has a stationary
distribution in the sense of a solution to πG = 0. However, in such examples we get
the unpleasant property of inﬁnitely many jumps in ﬁnite time, and to rule out such
anomalies, we always assume that the jump chain is recurrent. The following is the
continuous-time analog of Proposition 8.4.

484
STOCHASTIC PROCESSES
Proposition 8.13. Consider an irreducible continuous-time Markov chain with a
recurrent jump chain. Then
A stationary distribution π exists ⇔{X(t)} is positive recurrent
The stationary distribution is unique and has πj > 0 for all j ∈S.
As in the discrete case, positive recurrence is an important concept for describing the
behavior of the chain, but it is typically not checked directly. Instead, we look for a
solution to πG = 0.
We next turn to the question of convergence to the stationary distribution. In the
discrete case, this was complicated by possible periodicity, but in the continuous case
we have no unit step size, and thus the concept of period does not exist. We can state
the convergence theorem.
Theorem 8.2. Consider an irreducible, continuous-time Markov chain with a re-
current jump chain, stationary distribution π, and transition probabilities pij(t).
Then
pij(t) →πj
as t →∞
for all i, j ∈S.
As in the discrete case, a continuous-time Markov chain that satisﬁes the assumptions
in the theorem is called ergodic. The obvious analog of Proposition 8.5, regarding
mean recurrence times and mean number of visits to intermediate states, holds in the
continuous case as well. Finally, we refer to Problem 38 to see how the stationary
distributions for {X(t)} and its jump chain relate to each other.
Example 8.25. Consider the ON/OFF system from Example 8.23, where the jump chain
has stationary distribution ( 1
2, 1
2) and the continuous-time chain has stationary dis-
tribution (μ/(λ + μ), λ/(λ + μ)). These describe the proportion of jumps and the
proportion of time, respectively, spent in each state in the long run. However, only
the continuous-time chain also has a limit distribution. If the system starts in state 0,
it forgets how it started if we consider it in real time, but not if we count the jumps,
as we saw in Example 8.13.
□
8.4.2
Birth–Death Processes
In this section, we will examine continuous-time analogs of random walks. Thus, we
will consider integer-valued, continuous-time Markov chains that can only step up or
down, so the only generator entries that can be positive (but do not have to be) are
γi,i−1 and γi,i+1. We also restrict the state space to S = {0, 1, 2, . . .}, the nonnegative

CONTINUOUS -TIME MARKOV CHAINS
485
integers. Such Markov chains are called birth–death processes. Let us explain why
in an example.
Example 8.26. Consider a population of cells. Each cell lives for a time that is exp(α)
and then either splits into two new cells with probability p or dies with probability
1 −p, independent of all other cells. Let X(t) be the number of cells at time t and
describe this as a continuous-time Markov chain.
The state space is S = {0, 1, 2, . . .}. If there are i cells, the next change comes after a
time that is the minimum of i lifetimes that are independent and exp(α). By Example
3.50, we thus have holding-time parameters
λ(i) = iα, i = 0, 1, 2, . . .
where λ(0) = 0 means that state 0 is absorbing. This gives the transition rates
γi,i+1 = iαp and γi,i−1 = iα(1 −p), i = 1, 2, . . .
and it is common to deﬁne the birth rate λi = γi,i+1 and death rate μi = γi,i−1 [do
not confuse λi and λ(i)]. Since the birth and death rates are linear in i, this is called a
linear birth–death process. It is also customary to denote λ = αp and μ = α(1 −p),
the individual birth and death rates. The transition graph is then
...
3μ
2μ
μ
2
1
0
2λ
λ
and the generator
G =
⎛
⎜
⎜
⎜
⎜
⎜
⎜
⎜
⎝
0
0
0
0
0
. . .
μ
−(λ + μ)
λ
0
0
. . .
0
2μ
−2(λ + μ)
2λ
0
. . .
0
0
3μ
−3(λ + μ)
3λ
. . .
...
...
...
...
...
...
⎞
⎟
⎟
⎟
⎟
⎟
⎟
⎟
⎠
The jump chain is the simple random walk, which we know is transient if p > 1
2, the
only case in which absorption in 0 can be avoided.
□
Example 8.27. Consider a population where the individual death rate is μ and there
are no births. Instead, there is constant immigration into the population according to a
Poisson process with rate λ. Describe the process, determine when a limit distribution
exists, and ﬁnd what it is.

486
STOCHASTIC PROCESSES
The birth and death rates are
λi = λ, μi = iμ, i = 0, 1, . . .
and we have the following transition graph:
μ
λ
...
3μ
2μ
λ
λ
2
1
0
Thechainisclearlyirreducible,soweneedonlytolookforastationarydistribution,
which, if it exists, is also the limit distribution. The equation πG = 0 becomes
(π0, π1, . . .)
⎛
⎜
⎜
⎜
⎜
⎜
⎜
⎜
⎝
−λ
λ
0
0
0
. . .
μ
−(λ + μ)
λ
0
0
. . .
0
2μ
−(λ + 2μ)
λ
0
. . .
0
0
3μ
−(λ + 3μ)
λ
. . .
...
...
...
...
...
...
⎞
⎟
⎟
⎟
⎟
⎟
⎟
⎟
⎠
= (0, 0, . . .)
which gives the ﬁrst equation
−λπ0 + μπ1 = 0
which gives
π1 = λ
μπ0
The next equation
λπ0 −(λ + μ)π1 + 2μπ2 = 0
gives, after some algebra
π2 = λ2
2μ2 π0
The remaining equations all look the same:
λπn−1 −(λ + nμ)πn + (n + 1)μ πn+1, n = 2, 3, . . .
and it is easy to check that the general solution is
πn = ρn
n! π0, n = 0, 1, 2, . . .

CONTINUOUS -TIME MARKOV CHAINS
487
where ρ = λ/μ. The condition 
n πn = 1 gives
1 = π0
∞

n=0
ρn
n! = π0 eρ
which gives stationary distribution
πn = e−ρ ρn
n! , n = 0, 1, 2, . . .
which we recognize as a Poisson distribution with mean ρ. Note that the stationary
distribution always exists. The intuitive reason for this is that the larger the population
becomes, the more likely that the next event is a death rather than an immigration.
Even if the immigration rate λ is enormous compared to the individual death rate μ,
sooner or later there will be so many individuals that deaths start to compensate for
immigration. The jump chain has transition probabilities
pi,i+1 = −γi,i+1
γii
=
λ
λ + iμ
and pi,i−1 = iμ/(λ + iμ), i = 0, 1, . . . and also note that the larger the population
becomes, the more frequent the events, since the expected holding time in state i is
1/(λ + iμ).
□
Since the structure of the generator is so simple in a birth–death process, it is possible
to ﬁnd a general formula for the stationary distribution. The general form of the
generator is
G =
⎛
⎜
⎜
⎜
⎜
⎜
⎜
⎜
⎝
−λ0
λ0
0
0
0
. . .
μ1
−(λ1 + μ1)
λ1
0
0
. . .
0
μ2
−(λ2 + μ2)
λ2
0
. . .
0
0
μ3
−(λ3 + μ3)
λ3
. . .
...
...
...
...
...
...
⎞
⎟
⎟
⎟
⎟
⎟
⎟
⎟
⎠
from which it is easily seen that the equation πG = 0 gives the ﬁrst equation
−λ0π0 + μ1π1 = 0
which gives
π1 = λ0
μ1
π0
and the remaining equations
λn−2πn−2 −(λn−1 + μn−1)πn−1 + μnπn = 0, n = 2, 3, . . .

488
STOCHASTIC PROCESSES
and it is easy to check that these are satisﬁed by
πn = λ0λ1 · · · λn−1
μ1μ2 · · · μn
π0, n = 1, 2, . . .
(8.7)
Summing over n now yields that a stationary distribution exists if and only if
1 +
∞

n=1
λ0λ1 · · · λn−1
μ1μ2 · · · μn
< ∞
and the stationary distribution is then given by
π0 =
	
1 +
∞

n=1
λ0λ1 · · · λn−1
μ1μ2 · · · μn

−1
and the remaining πn by Equation (8.7). Also see Problem 42 for a nice interpretation
of the equation πG = 0.
8.4.3
Queueing Theory
A particular class of birth–death processes arise in models for certain service systems.
Let us introduce the subject of queueing theory with an example.
Example 8.28 (The M/M/1 queue). Customers arrive according to a Poisson process
with rate λ to a service station with one server. Service times are i.i.d. exponential
with rate μ and independent of the arrivals (note that μ does not denote the mean
here; the mean service time is 1/μ). If the server is busy, incoming customers wait in
line and as soon as a service is completed, the next begins. Describe the system as a
birth–death process, determining when it has a stationary distribution and what it is.
We let the state X(t) be the number of customers in the system (under service and in
line) at time t. Transition rates are given already in the problem: λi = λ for i ≥0 and
μi = μ for i ≥1. The transition graph is
...
μ
μ
μ
λ
λ
λ
2
1
0
and to ﬁnd the stationary distribution, note that
λ0λ1 · · · λn−1
μ1μ2 · · · μn
= λn
μn

CONTINUOUS -TIME MARKOV CHAINS
489
so with ρ = λ/μ we see that a stationary distribution exists if and only if
1 +
∞

n=1
ρn =
∞

n=0
ρn < ∞
which is to say that ρ < 1. Using the formula for the geometric series, it is easy to
see that the stationary distribution in this case is
πn = (1 −ρ)ρn, n = 0, 1, 2 . . .
a geometric distribution including 0. The constant ρ is called the trafﬁc intensity and in
order for a stationary distribution to exist, this must be strictly less than one, meaning
that service rates are higher than arrival rates. Only in this way can the server be
efﬁcient to regularly clear out the system.
The jump chain is the simple random walk where the probability to step up is
p = λ/(λ + μ) = ρ/(1 + ρ), which means that ρ < 1 if and only if p < 1
2.
□
The system in this example is called an M/M/1 queue, where “M” stands for
“Markov,” meaning that both interarrival times (ﬁrst M) and service times (second
M) are exponential, which is the only way in which this system satisﬁes the Markov
property. The “1” indicates that there is one server. Other, non-Markovian, queueing
systems are, for example, M/D/1, where service times are deterministic and G/G/1,
where both interarrival times and service times have some general distribution, not
necessarily exponential. The analysis of such systems require other methods, and we
will stick to the M/M queues and analyze them as continuous time Markov chains.
There are many variants of the M/M/1 queue. In the following three examples, we
examine some of these, leaving others for the Problems section.
Example 8.29 (Finite Waiting Room). Consider the M/M/1 queue, but suppose
that there is only room for r customers in the system (the maximum queue length is
r −1), denoted M/M/1/r.
The transition graph is
μ
r
λ
λ
μ
μ
...
λ
1
0
Again let ρ = λ/μ. We have
r

n=0
ρn =
⎧
⎪
⎪
⎪
⎨
⎪
⎪
⎪
⎩
r + 1
if ρ = 1
1 −ρr+1
1 −ρ
if ρ /= 1

490
STOCHASTIC PROCESSES
which gives stationary distribution
πn =
⎧
⎪
⎪
⎪
⎪
⎨
⎪
⎪
⎪
⎪
⎩
1
r + 1, n = 0, 1, . . . , r
if ρ = 1
(1 −ρ)ρn
1 −ρr+1 , n = 0, 1, . . . , r
if ρ /= 1
Note how the stationary distribution is uniform if ρ = 1 and how the probability πr
approaches 1 as ρ →∞.
□
Example 8.30 (Balking). Consider the M/M/1 queue and suppose that an arriving
customer who ﬁnds the system not empty joins with probability q and leaves
otherwise.
The only difference from the M/M/1 queue is that transitions from i to i + 1 where
i ≥1 now occur according to a thinned Poisson process with rate λq. Thus, we have
the transition graph
μ
μ
μ
...
λq
λq
λ
2
1
0
and we get
λ0λ1 · · · λn−1
μ1μ2 · · · μn
= λnqn−1
μn
where we let ρ = λq/μ to obtain
1 +
∞

n=1
λ0λ1 · · · λn−1
μ1μ2 · · · μn
= 1 + 1
q
∞

n=1
ρn
which is ﬁnite if and only if ρ < 1, which makes intuitive sense. Since
∞

n=1
ρn =
ρ
1 −ρ
the stationary distribution is given by
⎧
⎪
⎪
⎪
⎪
⎪
⎨
⎪
⎪
⎪
⎪
⎪
⎩
π0
=

1 +
ρ
q(1 −ρ)
−1
πn
= ρnπ0
q
, n = 1, 2, . . .

CONTINUOUS -TIME MARKOV CHAINS
491
Note how we redeﬁned the trafﬁc intensity ρ. We did this since we want ρ < 1 to be
the criterion for when the system is efﬁcient, that is, when the server manages to deal
with the arrivals.
□
Example 8.31 (More Than One Server). Consider the M/M/2 queue, which is just
like the M/M/1 queue except that there are two servers instead of one. An arriving
customer can thus get immediate service if the system is empty or if only one server
is busy.
The difference this time is what happens when both servers are busy. The time for a
service to be completed is now the minimum of two exponentials with rate μ and is
thus exp(2μ) (recall Example 3.50). The transition graph is
2μ
2μ
μ
...
λ
λ
λ
2
1
0
This time we get
λ0λ1 · · · λn−1
μ1μ2 · · · μn
=
λn
μ(2μ)n−1 = 2
 λ
2μ
n
which suggests that we deﬁne the trafﬁc intensity as ρ = λ/2μ. We then get
πn = 2ρnπ0, n ≥1
and the stationary distribution exists if and only if ρ < 1. Since
	
1 + 2
∞

n=1
ρn

= 1 + ρ
1 −ρ
the stationary distribution is given by
⎧
⎪
⎪
⎪
⎪
⎨
⎪
⎪
⎪
⎪
⎩
π0 =
1 −ρ
1 + ρ
πn =
2ρn(1 −ρ)
1 + ρ
, n ≥1
□
8.4.4
Further Properties of Queueing Systems
When a queueing system has settled in to have the stationary distribution, we say that
it is in equilibrium. Several different measures can be used to assess the efﬁciency of

492
STOCHASTIC PROCESSES
the system, often called performance measures. Let us examine some of them for the
M/M/1 queue.
Example 8.32. Consider the M/M/1 queue with ρ < 1 in equilibrium. (a) What is
the expected number of customers in the system? (b) What is the expected queue
length? (c) When a customer arrives, what is the probability that she does not have
to wait in line? (d) When a customer arrives, what is her expected waiting time
until service? (e) When a customer arrives, what is her expected total time in the
system?
Let us introduce some random variables. Thus, let
N = the number of customers in the system
Q = the queue length
W = the waiting time until service
T = the total time spent in the system
For (a), we know that N has distribution
πk = (1 −ρ)ρk, k = 0, 1, . . .
the geometric distribution including 0 with success probability 1 −ρ, and from Sec-
tion 2.5.3 we know that
E[N] =
ρ
1 −ρ
which answers (a). For (b), note that
Q =

0
if N = 0 or N = 1
N −1
if N > 1
and hence
P(Q = 0) = π0 + π1
P(Q = k) = πk+1, k ≥1
which gives
E[Q] =
∞

k=0
kP(Q = k) =
∞

k=1
kπk+1
= ρ
∞

k=1
k(1 −ρ)ρk = ρE[N] =
ρ2
1 −ρ
The answer to (c) is simply π0 = 1 −ρ, and for (d), note that W = 0 if the system is
empty and the sum of N i.i.d. exponentials with mean 1/μ if there are N customers

CONTINUOUS -TIME MARKOV CHAINS
493
in the system (keep in mind that μ does not denote the mean but the service rate). By
Corollary 3.13, we get
E[W] = E[N] 1
μ =
ρ
μ(1 −ρ)
Finally, for (e), let S be a service time and note that T = W + S to obtain
E[T] =
ρ
μ(1 −ρ) + 1
μ =
1
μ(1 −ρ)
We summarize as follows. In the M/M/1 system in equilibrium, we have
E[N] =
ρ
1 −ρ,
E[Q] =
ρ2
1 −ρ
E[W] =
ρ
μ(1 −ρ),
E[T] =
1
μ(1 −ρ)
□
There are many interesting relations between these expected values. For example,
E[Q]
E[N] = E[W]
E[T]
which is also equal to the trafﬁc intensity ρ. Also, since μ = ρλ, we obtain
E[N] = λE[T]
(8.8)
formulas that are intuitively reasonable. These relations hold for many queueing
systems, not only the M/M/1. Equation (8.8) is known as Little’s formula. Also note
how all the expectations go to ∞as ρ approaches 1.
If there is ﬁnite waiting room, an obvious performance measure is how likely it is
that the system is full, in which case arriving customers are lost. Thus, the probability
that the system is full is the long-term proportion of arriving customers that are lost.
Let us consider one example.
Example 8.33. Consider the M/M/1/r queue from Example 8.29. What proportion
of customers is lost?
This is the probability that the system is full, πr, which is
πr =
⎧
⎪
⎪
⎪
⎪
⎨
⎪
⎪
⎪
⎪
⎩
1
r + 1
if ρ = 1
(1 −ρ)ρr
1 −ρr+1
if ρ /= 1
where we can note that πr →1 as ρ →∞.
□

494
STOCHASTIC PROCESSES
8.5
MARTINGALES
In this section, we will introduce a class of stochastic processes called martingales7
that is particularly useful in a wide variety of situations where asymptotic properties
are of interest.
Let us go directly to the deﬁnition.
Deﬁnition 8.12. A sequence of random variables Y1, Y2, . . . is called a martingale
in discrete time with respect to the sequence X1, X2, . . . if E[|Yn|] < ∞and
E[Yn+1|X1, . . . , Xn] = Yn
(8.9)
for all n = 1, 2, . . ..
The conditional expectation used in Deﬁnition 8.12 is a generalization of Deﬁnition
3.13, where we interpreted conditional expectation as a random variable. In this
context, (8.9) is a random variable assuming the value E[Yn+1|X1 = x1, . . . , Xn =
xn] whenever the event {X1 = x1, . . . , Xn = xn} occurs.
In many applications, we can actually choose Xk = Yk for all k = 1, 2, . . . so that
(8.9) takes the form
E[Yn+1|Y1, . . . , Yn] = Yn
which better illustrates the fundamental property of a martingale. Basically, it says
that if we have observed the process for n steps, we at least know that the process
in the next step on average will not deviate from the last value Yn. The more general
deﬁnition above is useful in situations where we can write Yn as a function of the
underlying variables X1, . . . , Xn.
Example 8.34. One process we considered earlier that ﬁts nicely into this theory is
the symmetric random walk from Section 8.3.1 where X1, X2, . . . are i.i.d. random
variables where P(Xk = 1) = P(Xk = −1) = 1
2 and
Sn =
n

k=1
Xk
The ﬁrst property in Deﬁnition 8.12 is clearly satisﬁed since E[|Sn|] ≤n < ∞and
E[Sn+1|X1, . . . , Xn] = E[Xn+1 + Sn|X1, . . . , Xn] = E[Xn+1] + Sn = Sn
shows that S1, S2, . . . is a martingale with respect to X1, X2, . . ..
□
7The term originated in France in the seventeenth century as a class of betting strategies to increase the
chances in various games of gambling.

MARTINGALES
495
Example 8.35 (Branching Processes). Another example where martingales are use-
fulisthebranchingprocessintroducedinSection8.3.3.Here,thevariablesX1, X2, . . .
represent the number of offspring of individuals in a generation and
Zn =
Zn−1

k=1
Xk,
n = 1, 2, . . .
where Z0 ≡1, denotes the number of individuals in generation n. If μ = E[Xk] < ∞,
Proposition 8.8 implies that E[|Zn|] = E[Zn] = μn < ∞and
E[Zn+1|Z1, . . . , Zn] = E
 Zn

k=1
Xk
 Z1, . . . , Zn

= Znμ
showing that Z1, Z2, . . . is a martingale with respect to itself, but only if μ = 1.
However, it is actually quite easy to construct a martingale for arbitrary μ by rescaling
Zn with respect to the mean as
Yn = Zn
μn
Clearly, E[|Yn|] = E[Yn] = 1 for all n = 1, 2, . . . and
E[Yn+1|Z1, . . . , Zn] = E

1
μn+1
Zn

k=1
Xk
 Z1, . . . , Zn

=
1
μn+1 Znμ = Yn
showing that Y1, Y2, . . . is a martingale with respect to Z1, Z2, . . ..
□
8.5.1
Martingale Convergence
The main result of this section is the following.
Proposition 8.14 (Martingale Convergence Theorem).
If Y1, Y2, . . . is a mar-
tingale with respect to some sequence X1, X2, . . . and E[Y2
n] < c < ∞for all
n = 1, 2, . . ., then there exists a random variable Y such that
Yn →Y
as n →∞
with probability one.
Note that the convergence is almost surely the stronger mode of convergence men-
tioned in the discussion of the law of large numbers in Section 4.2. This implies that
Yn also converges in probability and in distribution. Proposition 8.14 says that there

496
STOCHASTIC PROCESSES
exists a random variable Y in the limit, but it does not say anything about its properties.
If we want to ﬁnd out its distribution, say, we have to use other methods, for example,
limits of moment generating functions as described in the proof of Theorem 4.2.
Example 8.36 (Strong Law of Large Numbers). As the ﬁrst example, we are going
to demonstrate how to use Proposition 8.14 to strengthen Theorem 4.18, which says
that the sample mean ¯X converges in probability to the mean μ as n →∞.
Let X1, X2, . . . be a sequence of i.i.d. random variables and let
Yn =
n

k=1
Xk −μ
k
Clearly, E[Yn] = 0 and
E[Y2
n] = Var[Yn] =
n

k=1
σ2
k2 < σ2
∞

k=1
1
k2 = σ2π2
6
so as long as σ2 < ∞, the condition in Proposition 8.14 is satisﬁed. To conclude that
Yn is a martingale, we have to show that E[|Yn|] < ∞for all n, which follows from
E[|Yn|] = E[|Yn| | |Yn| ≤1]P(|Yn| ≤1) + E[|Yn| | |Yn| > 1]P(|Yn| > 1)
< 1 × P(|Yn| ≤1) + E[Y2
n] < 1 + σ2π2
6
Proposition 8.14 now says that there exists some Y such that Yn →Y with proba-
bility one. To obtain the strong law of large numbers, we need a mathematical result
called Kronecker’s lemma, which says that if we have a sequence of arbitrary real
numbers x1, x2, . . . and positive constants b1, b2, . . . that increase strictly to inﬁnity,
then
n

k=1
xk
bk
→z implies that
1
bn
n

k=1
xk →0
as n →∞, where |z| < ∞. We have to be a bit cautious since we are dealing with
random variables, but without going into details it turns out that
n

k=1
Xk −μ
k
→Y
implies that
1
n
n

k=1
(Xk −μ) →0
as n →∞with probability 1. Finally, we note that since ¯X −μ →0 it follows that
¯X →μ with probability 1.
□
8Sometimes called the Weak Law of Large Numbers to distinguish it from this case.

MARTINGALES
497
Example 8.37 (Branching Processes). Recall Example 8.35 where we showed that
Yn = Zn/μn for n = 1, 2, . . . is a martingale with respect to Z1, Z2, . . .. Proposition
8.8 implies that
E[Y2
n] = (E[Yn])2 + Var[Yn] = 1 +
1
μ2n × σ2(μn −1)μn−1
μ −1
= 1 + σ2(1 −μ−n)
μ(μ −1)
< 1 +
σ2
μ(μ −1)
ifμ > 1.Hence,Proposition8.14saysthatthereonlyexistsalimitY forthemartingale
Yn in the supercritical case. Luckily, this is the most interesting case because we
know from Proposition 8.9 that subcritical and critical branching processes always go
extinct eventually and it is possible, using other methods, to conclude that Yn →0 for
those cases.
The properties of Y are not that easy to obtain and we are not going to go much
further here. It is possible, though, to show that Y is continuous except for a point mass
at 0 equal to the extinction probability. This means that the event {Y > 0} is equivalent
to nonextinction and if we condition on this event, we can say that Zn ≈Yμn for large
n. Essentially, the branching process grows with a more or less deterministic rate but
from a random level.
□
8.5.2
Stopping Times
Let us assume that we can interpret a martingale as the accumulated fortune of a
gambler playing a fair game. The game is fair in the sense that the expected amount
after each play is equal to the gambler’s fortune before the play. However, if we are
lucky we may win some money or if we are unlucky we may lose some money in
each individual play.
Let us, for simplicity, consider the symmetric random walk as a simple model for
gambling where we bet $1 and win $2 if we get heads and lose our bet if we get tails.
Throughout history, innumerable attempts have been made to beat the odds, to come
up with the perfect foolproof strategy to win money no matter how the dice fall or the
roulette wheel spins. One of the most (in)famous is the so-called doubling strategy,
where you always double your bet if you lose one play.
If it takes n plays to get heads, we have lost 1 + 2 + 4 + · · · + 2n−2 = 2n−1 −1
dollars along the way, but since the winning play brings in 2n−1 dollars, we will gain
$1 altogether. Seems solid, doesn’t it, so, what’s the problem? If we let N denote the
number of plays it takes to get heads, we know that pn = P(N = n) =

1
2
n
. The
expected amount that we will have to bet to gain $1 is then
∞

n=1
(2n−1 −1)pn =
∞

n=1
1
2 −1
2n

= ∞

498
STOCHASTIC PROCESSES
Hence, no matter how big your initial fortune is, you will most likely be ruined before
you stand to win any signiﬁcant amount of money.
This is an example of a strategy using a stopping time, which is a predetermined
rule when to stop playing. The rule has to be formulated so that we know for sure, after
each play, if we will stop or not and that we are not allowed to use future, unobserved
observations. In mathematical terms, it can be deﬁned as follows.
Deﬁnition 8.13. A random variable T that takes values in {1, 2, . . . , ∞} is called a
stopping time for the sequence X1, X2, . . . if
P(T = n|X1 = x1, X2 = x2, . . .) =
P(T = n|X1 = x1, X2 = x2, . . . , Xn = xn) = 0 or 1
This means that if we know exactly what values the stochastic process X1, X2, . . .
has assumed up to and including step n, we will know for sure if the event {T = n}
has occurred or not. Also, note that we allow T to assume an inﬁnite value, which
corresponds to a situation where our rule is never met and we therefore never stop.
A poorly chosen stopping time usually means, as illustrated above, that there is a
clear risk that we may have to wait for a very long time until we stop and that things
may go awry before that. Exactly what conditions a useful stopping time should satisfy
are covered in the following result.
Proposition 8.15. (Optional Stopping Theorem). Let Y1, Y2, . . . be a martingale
and T a stopping time with respect to some sequence X1, X2, . . .. If
(i) P(T < ∞) = 1
(ii) E[|YT |] < ∞
(iii) E[Yn|T > n]P(T > n) →0 as n →∞
then E[YT ] = E[Y1].
There are several versions of the optional stopping theorem giving slightly different
conditions, but those described in Proposition 8.15 are usually easy to verify. This is
bad news for all gamblers since it shows that there is no (reasonable) strategy that
will increase your expected fortune in a fair game.9 The doubling strategy described
above satisﬁes the ﬁrst two conditions in Proposition 8.15 but not the third since
E[Yn|T > n]P(T > n) = −(2n −1) ×
1
2
n
→−1
as n →∞.
9It is actually even worse because casinos and other gambling venues rarely offer any fair games.
The odds are usually stacked in their favor, bringing in a small but steady proﬁt. Processes where
E[Yn+1|X1, X2, . . . , Xn] ≤Yn are called supermartingales (replace ≤with ≥and you get submartin-
gales) and have similar properties.

MARTINGALES
499
Example 8.38 (Gambler’s Ruin). As the ﬁrst example of the optional stopping theo-
rem, let us revisit Example 1.58 where Ann and Bob ﬂipped a coin and Ann paid Bob
one dollar if it turned up heads and Bob paid Ann one dollar if it turned up tails. Ann
started with a dollars and Bob with b dollars and the question was which one would
be ruined ﬁrst.
If we let Xk be 1 if we get heads in the kth ﬂip and −1 otherwise, we can write
Bob’s total gain after n coin ﬂips as
Sn =
n

k=1
Xk
This is clearly a martingale with respect to X1, X2, . . . since
E[Sn+1|X1, . . . , Xn] = (Sn −1) × 1
2 + (Sn + 1) × 1
2 = Sn
The game stops either when Sn = a (Ann is ruined) or Sn = −b (Bob is ruined), so
T = min{n : Sn = a or Sn = −b}
is clearly a stopping time.
We know from Section 8.3.1 that the symmetric random walk is recurrent, which
means that it will hit either a or −b eventually. This implies both that P(T < ∞) = 1,
verifying the ﬁrst condition of Proposition 8.15, and that P(T > n) →0 as n →∞.
We also know that the random variable ST only assumes the values a and −b so that
E[|ST |] ≤max(a, b) < ∞. Finally, we realize that if the event {T > n} occurs, the
martingale has not stopped at time n so that −b < Sn < a and the third condition
follows.
Let p be the probability that Bob wins all the money (and Ann gets ruined) and
note that p = P(ST = a). Proposition 8.15 now implies that
E[ST ] = ap −b(1 −p) = E[S1] = 0
which gives us that
p =
b
a + b
We can also calculate the expected value of T by considering the sequence Yn =
S2
n −n, which also is a martingale with respect to X1, X2, . . . since
E[Yn+1|X1, . . . , Xn] = E[(Sn + Xn+1)2 −(n + 1)|Sn]
= S2
n + 2SnE[Xn+1] + E[X2
n+1] −(n + 1) = S2
n −n = Yn

500
STOCHASTIC PROCESSES
It is not quite as easy to verify that all conditions of Proposition 8.15 are satisﬁed, but
we will skip those details. Hence, we know that
E[YT ] = E[S2
T −T] = E[S2
T ] −E[T] = E[Y1] = E[S2
1 −1] = 0
and, since we know that ST is either equal to a with probability p or equal to −b with
probability 1 −p, we get that
E[T] = E[S2
T ] = a2p + b2(1 −p) = a2b
a + b + b2a
a + b = ab
which would be very difﬁcult to calculate in any other way.
□
Example 8.39 (Ballot Theorem). There has been a ballot between Ann and Bob
where Ann won with a votes whereas Bob got only b votes. If the votes were counted
one by one in random order, what is the probability that Ann was ahead of Bob the
whole time?
Let Xk be equal to 1 if vote number k was a vote for Ann and −1 if the vote was
for Bob. Then Sn = n
k=1 Xk denotes the difference between the number of votes
for Ann and Bob after n votes have been counted. The probability we are looking for
can be expressed as P(Sn > 0; 1 ≤n ≤N), where N = a + b is the total number of
votes.
There are several ways to solve this classic probabilistic problem,10 but we will
use the optional stopping theorem to do it here. It turns out that we can simplify the
problem by going backward in time, creating the so-called backward martingale.
First, we note that after n votes have been counted, Ann have (n + Sn)/2 votes and
Bob have (n −Sn)/2 votes. This implies that
P(Sn = Sn+1 + 1|Sn+1) = (n + 1 −Sn+1)/2
n + 1
P(Sn = Sn+1 −1|Sn+1) = (n + 1 + Sn+1)/2
n + 1
These conditional probabilities consider the events that we take away a vote for Bob
and we take away a vote for Ann, respectively, from n + 1 counted votes.
Now, we deﬁne the sequence Y1, Y2, . . . , YN as
Yn =
SN−n+1
N −n + 1,
n = 1, 2, . . . , N
10Introduced by the French mathematician Joseph Bertrand (1822–1900) in 1887. Martingale theory had
not been developed at the time, so he solved it using combinatorical methods.

MARTINGALES
501
which is a martingale with respect to itself since
E[Yn+1|Y1, . . . , Yn] = E
 SN−n
N −n
 SN, . . . , SN−n+1

=
1
N −n{(SN−n+1 + 1)P(SN−n = SN−n+1 + 1|SN−n+1)
+(SN−n+1 −1)P(SN−n = SN−n+1 −1|SN−n+1)}
=
1
N −n

SN−n+1 + (N −n + 1 −SN−n+1)/2
N −n + 1
−(N −n + 1 + SN−n+1)/2
N −n + 1

= SN−n+1
N −n

1 −
1
N −n + 1

=
SN−n+1
N −n + 1 = Yn
Next, we deﬁne the stopping time T as
T = min{min{n : Yn = 0}, N}
Since we are going backward in time, T denotes the last time the candidates were even
and if this never happens, we let T = N, which corresponds to the ﬁrst vote counted.
This means that if T < N, the candidates were even at T and YT ≡0. On the other
hand, if T = N, Ann was always ahead and YT ≡1. Since both the martingale and
the stopping time are bounded, it is obvious that all conditions in Proposition 8.15
are satisﬁed, so we can conclude that
E[YT ] = E[Y1] = E
SN
N

= a −b
a + b
Finally, since the random variable YT only assumes the values 0 and 1, we get
E[YT ] = 0 × P(YT = 0) + 1 × P(YT = 1)
= 0 × P(T < N) + 1 × P(T = N) = P(T = N)
which yields the probability that Ann was always in the lead as
P(Ann always in the lead) = P(T = N) = a −b
a + b
□

502
STOCHASTIC PROCESSES
8.6
RENEWAL PROCESSES
In Section 3.12, we introduced the Poisson process as a point process with i.i.d.
exponentiallydistributedinterarrivaltimes.Inthissection,wewilloutlinesometheory
of the most obvious generalization of this, namely, to allow the interarrival times to
have any nonnegative distribution.
Let us start with the formal deﬁnition.
Deﬁnition 8.14. Let T1, T2, . . . be i.i.d. nonnegative random variables such that
P(Tk = 0) < 1 and Sn = n
k=1 Tk, then
N(t) = max{n : Sn ≤t}
is a renewal process for t ≥0.
The time points S1, S2, . . . are called the renewals since it is like starting all over
from the beginning every time an interarrival time ends. Since N(t) = n is equivalent
to Sn ≤t < Sn+1, we see that N(t) counts the number of renewals in the interval
[0, t]. The cdf of Tk and Sn will be denoted F(t) = P(Tk ≤t) and Fn(t) = P(Sn ≤t),
respectively, and we let μ and σ2 denote the mean and the variance of Tk.
The exact distribution of N(t) is usually very difﬁcult to derive, except for a few
simple cases, but it can at least theoretically be expressed in the form
P(N(t) = n) = P(Sn ≤t < Sn+1) = P(Sn ≤t) −P(Sn+1 ≤t)
= Fn(t) −Fn+1(t)
for n = 0, 1, 2, . . ., where F0(t) = 1. We can also write the mean m(t) = E[N(t)],
using Proposition 2.9, as
m(t) =
∞

n=1
P(N(t) ≥n) =
∞

n=1
P(Sn ≤t) =
∞

n=1
Fn(t)
The mean m(t) is also called the renewal function and it turns out that it uniquely
determines the renewal process, that is, if we are given an expression for m(t), we can
in principle calculate the distribution F(t) of the interarrival times.
Example 8.40. Let us have a look at the Poisson process expressed as a renewal
process. Since the interarrival times are exponentially distributed, we know that
F(t) = 1 −e−λt

RENEWAL PROCESSES
503
and, by Proposition 3.35 and Section 2.8.2, that
Fn(t) = 1 −e−λt
n−1

k=0
(λt)k
k!
The distribution of N(t) can now be calculated as
P(N(t) = n) =
	
1 −e−λt
n−1

k=0
(λt)k
k!

−
	
1 −e−λt
n

k=0
(λt)k
k!

= e−λt (λt)n
n!
which is the Poisson distribution with mean λt. The renewal function becomes
m(t) =
∞

n=1
	
1 −e−λt
n−1

k=0
(λt)k
k!

=
∞

n=1
	
1 −e−λt
	
eλt −
∞

k=n
(λt)k
k!


= e−λt
∞

n=1
∞

k=n
(λt)k
k!
= e−λt
∞

k=1
k

n=1
(λt)k
k!
= e−λt
∞

k=1
(λt)k
(k −1)!
= e−λtλt
∞

k=1
(λt)k−1
(k −1)! = λt
where we used the Taylor expansion of eλt. This is a very longwinded way to derive
the mean of the Poisson process, but it at least shows that the theory works. What we
have shown is that the Poisson process has a linear renewal function and, since the
renewal function determines the renewal process, it is worth noting that the Poisson
process is the only renewal process with a linear renewal function.
□
For continuous interarrival times, we can use the property that the renewal process
starts over at every renewal Sn to obtain the following result.
Proposition 8.16 (The Renewal Equation). If T1, T2, . . . are continuous interar-
rival times with cdf F(t) and pdf f(t), the renewal function m(t) satisﬁes
m(t) = F(t) +
 t
0
m(t −u)f(u) du
Proof. If we condition on the time of the ﬁrst renewal, Proposition 3.17 says that we
can write the renewal function
m(t) = E[N(t)] =
 ∞
0
E[N(t)|T1 = u]f(u) du
(8.10)
Now, if the ﬁrst renewal occurs after t, that is, u > t holds, clearly E[N(t)|T1 =
u] = 0. On the other hand, if u ≤t, we count the ﬁrst renewal and start the process

504
STOCHASTIC PROCESSES
from the beginning at time u. This means that
E[N(t)|T1 = u] = 1 + E[N(t −u)] = 1 + m(t −u) u ≤t
which means that we can write (8.10) as
m(t) =
 t
0
(1 + m(t −u))f(u) du = F(t) +
 t
0
m(t −u)f(u) du
■
The main advantage of Proposition 8.16 is that we only need to consider the distribu-
tion of the ﬁrst renewal to get the renewal function, but instead we need to solve an
integral equation, which is not that easy in most cases. Still, it gives us a tool to verify
whether a proposed m(t) actually is a renewal function for a given renewal process.
8.6.1
Asymptotic Properties
Since the exact distribution of the renewal process is difﬁcult to obtain in most cases,
it would at least be interesting to see how N(t) behaves as t →∞. The ﬁrst result is
essentially a version of the Law of Large Numbers.
Proposition 8.17. For μ > 0, it holds that
N(t)
t
P→1
μ
as t →∞
Proof. Since SN(t) is the time of the last renewal before t, we note that
SN(t) ≤t < SN(t)+1
which yields that
SN(t)
N(t) ≤
t
N(t) < SN(t)+1
N(t)
(8.11)
for N(t) > 0. Now, it holds that N(t) →∞as t →∞(why is that?), so the Law of
Large Numbers implies that
SN(t)
N(t)
P→μ
as t →∞
Furthermore, using a similar argument yields that
SN(t)+1
N(t)
= SN(t)+1
N(t) + 1 × N(t) + 1
N(t)
P→μ × 1
as t →∞

RENEWAL PROCESSES
505
We have shown that both the upper and the lower bound in (8.11) converge in proba-
bility to μ and since t/N(t) is between these, it has to converge in probability to μ as
well. Taking the reciprocals completes the proof.
■
The ratio 1/μ is called the renewal rate because it denotes the average number of
renewals per time unit in the long run. Note that the result holds also for inﬁnite μ,
in which case we interpret the renewal rate as 0.
In light of Proposition 8.17, the following result seems quite natural.
Proposition 8.18 (Elementary Renewal Theorem). For μ > 0, it holds that
m(t)
t
→1
μ
as t →∞
It would seem that this is a simple consequence of Proposition 8.17, but that is actually
not the case. Proving the elementary renewal theorem turns out to be rather difﬁcult
and requires some asymptotic theory that we have not introduced.
The following result is slightly more general but holds only for continuous inter-
arrival times.
Proposition 8.19 (Renewal Theorem). For continuous F(t) and μ > 0, it holds
that
m(t + s) −m(t) →s
μ
as t →∞
This result says essentially that if we slide a ruler of length s on the time axis, the
expected number of renewals covered by the ruler will be, at least approximately,
proportional to the length of the ruler. For a ﬁxed and large t, Propositions 8.18 and
8.19 can be summarized as
m(t) ≈t
μ
m(t + s) −m(t) ≈s
μ
which illustrates how they are connected. Proposition 8.18 can be regarded as a global
average of renewals while Proposition 8.19 gives a similar local property.
There is also a central limit theorem for renewal processes.
Proposition 8.20. For μ < ∞and σ2 < ∞, it holds that
P
	
N(t) −t/μ
σ

t/μ3
≤x

→
(x)
as t →∞, where 
(x) is the cdf of the standard normal distribution.

506
STOCHASTIC PROCESSES
Proof. For a ﬁxed x, let
t = nμ −xσ√n
(8.12)
and consider the probability
P(N(t) < n) = P
	
N(t) −t/μ
σ

t/μ3
< nμ −t
σ√t/μ

= P
	
N(t) −t/μ
σ

t/μ3
< x
nμ
t

Now, if we let n →∞we see from (8.12) that t →∞and vice versa. Also, (8.12)
implies that √nμ/t →1, which means that
lim
n→∞P(N(t) < n) = lim
t→∞P
	
N(t) −t/μ
σ

t/μ3
< x

Finally, since the events {N(t) < n} and {Sn > t} are equivalent, we get that
P(N(t) < n) = P(Sn > t) = P
Sn −nμ
σ√n
> t −nμ
σ√n

= P
Sn −nμ
σ√n
> −x

→1 −
(−x) = 
(x)
as n →∞by the central limit theorem.
■
Example 8.41. A Geiger–M¨uller counter (or Geiger counter for short) is an electronic
device that detects radioactive particles, usually from beta and gamma radiation. One
problem is that every time a particle is registered, the counter has to be reset before it
can detect new particles. These periods are called dead periods because any particles
that arrive while the counter is reset are lost. Therefore, some appropriate adjustment
needs to be done in order to avoid underestimation of the radioactive intensity.
Let us assume that the radioactive particles arrive according to a Poisson process
with rate λ and that the lengths of the dead periods Y1, Y2, . . . are i.i.d. random
variables. Let X1, X2, . . . denote the times until a reset counter registers a particle and,
from the properties of the Poisson process, these are independent and exponentially
distributed with parameter λ. Furthermore, we assume that the lengths of the dead
periods are independent of the Poisson process.
If we let the interarrival times be Tk = Xk + Yk for k = 1, 2, . . ., we can deﬁne
the renewals as
Sn =
n

k=1
Tk =
n

k=1
(Xk + Yk)

RENEWAL PROCESSES
507
In this case, we get the mean and variance of the interarrival times as
μ = 1
λ + μY
(8.13)
σ2 = 1
λ2 + σ2
Y
Let us say that we have run the counter for a long time t and registered N(t) particle
emissions.11 Proposition 8.17 implies that
N(t) ≈t
μ =
t
1/λ + μY
which gives us the appropriate estimator of λ as
λ =
1
t
N(t) −μY
Having obtained an estimate for λ, we can then use Proposition 8.20 to calculate
a conﬁdence interval. First, we get an interval for 1/μ with approximate conﬁdence
level q as
1
μ ≈N(t)
t
± z
σ

tμ3 ≈N(t)
t
± zσ

N(t)3
t2
where 
(z) = (1 + q)/2. In the second approximation above, we used the fact that
μ ≈t/N(t) and
σ2 = 1
λ2 + σ2
Y
Then, (8.13) can be used to transform the interval for λ.
For a practical example, let us assume that we have detected N(t) = 5630 particles
during 1 s and the dead periods are uniformly distributed between 0 and 200 s. Let
us use 1 ms as a convenient time unit so that λ denotes the average number of particle
emissions per ms. It is clear that μY = 0.1, which yields the point estimate
λ =
1
(1000/5630) −0.1 = 12.9
Now, we get
σ2 =
1
12.92 + 0.22
12 = 0.0094
11If the time point t ends up in a dead period, the number of detected particles is actually N(t) + 1 since
the last particle is registered before t although the corresponding interarrival time ends after t. However, if
t is large, this is negligible.

508
STOCHASTIC PROCESSES
which yields the 95 % interval
1
μ ≈5630
1000 ± 1.96
√
0.0094
√
56303
10002
= 5.63 ± 0.08
Finally, this yields the limits for λ as
1
(1/5.58) −0.1 ≤λ ≤
1
(1/5.71) −0.1
(≈95%)
or
12.5 ≤λ ≤13.3
(≈95%)
□
Example 8.42 (Delayed Renewal Process). There is one variation of the regular re-
newal process that is of particular interest, where the distribution of the initial inter-
arrival time T1 may be different from the subsequent. Such a situation may emerge if
we start the process in between two adjacent renewals rather than at a speciﬁc renewal
time, hence the term delayed renewal process. Since only the ﬁrst interarrival time
differs, all previous limiting results can be shown to hold also for the delayed renewal
process. In fact, it has some interesting theoretical properties that actually can be used
to prove some of these results for the regular renewal process.
Let F(t) denote the cdf of T2, T3, . . . as before and denote the cdf of T1 by  F(t).
Furthermore, let  Sn denote the renewals,  N(t) the delayed renewal process, and  m(t)
the renewal function. Now, we can use the same method as in the proof of Proposition
8.16 to obtain
 m(t) =
 t
0
E[ N(t)|T1 = u] f(u) du =
 t
0
(1 + m(t −u)) f(u) du
=  F(t) +
 t
0
m(t −u) f(u) du
(8.14)
Note that we get the mean m(t −u) in the integral since we get an ordinary renewal
process after conditioning on {T1 = u}. If we apply Proposition 8.16 to m(t −u), we
can write (8.14) as
 F(t) +
 t
0

F(t −u) +
 t−u
0
m(t −u −v)f(v) dv

 f(u) du
=  F(t) +
 t
0
F(t −u) f(u) du +
 t
0
 t−v
0
m(t −v −u) f(u) du

f(v) dv

BROWNIAN MOTION
509
The ﬁrst integral can be transformed, using integration by parts, into
 t
0
F(t −u) f(u) du =
!
F(t −u) F(u)
"t
0 +
 t
0
f(t −u) F(u) du
=
 t
0
 F(t −u)f(u) du
and we can use (8.14) again to rewrite the inner integral as
 t−v
0
m(t −v −u) f(u) du =  m(t −v) − F(t −v)
Together, these results imply that
 m(t) =  F(t) +
 t
0
 F(t −u)f(u) du +
 t
0
( m(t −v) − F(t −v))f(v) dv
=  F(t) +
 t
0
 m(t −v)f(v) dv
(8.15)
which is the renewal equation for the delayed renewal process.
As for the ordinary renewal process, this equation uniquely determines the renewal
function.Ifwelookattheasymptoticpropertiesast →∞,werealizethattheydepend
largely on F(t) and that the initial interarrival time eventually becomes irrelevant.
This means that we may choose whatever  F(t) we like without affecting any limiting
results. Proposition 8.18 says that the scaled renewal function m(t)/t for a regular
renewal process converges toward 1/μ and, as mentioned above, the same can be
shown to hold for  m(t)/t. Let us see if we can choose  F(t) so that
 m(t) = t
μ
for all t ≥0. In that case, (8.15) implies that
 F(t) =  m(t) −
 t
0
 m(t −v)f(v) dv = t
μ −
 t
0
t −v
μ f(v) dv
= t
μ −
t −v
μ F(v)
t
0
−
 t
0
1
μF(v) dv = 1
μ
 t
0
(1 −F(v)) dv
as long as μ < ∞.
□
8.7
BROWNIAN MOTION
The simple random walk presented in Section 8.3.1 describes a discrete process that
at unit time points jumps one unit up or one unit down with ﬁxed probabilities p and
1 −p, respectively, independent of all previous jumps. Let us see if we can construct

510
STOCHASTIC PROCESSES
a continuous version of this that makes inﬁnitesimally small jumps inﬁnitesimally
often. To achieve this, we can consider random walks with jump sizes x and time
intervals of length t and then gradually decrease x and t toward zero. In the
following, we will consider only the symmetric random walk where p = 1 −p = 1
2.
Let X1, X2, . . . be independent random variables such that
Xk =
⎧
⎪
⎨
⎪
⎩
+1
with probability 1/2.
−1
with probability 1/2
(8.16)
Then we can deﬁne the process
Sn(t) = x X1 + x X2 + · · · + x X[t/t] = x
n

i=1
Xi
(8.17)
where n = [t/t] denotes the largest integer less than or equal to the real number
t/t.
Since E[Xk] = 0 and Var[Xk] = 1, we can calculate the mean and variance of
(8.17) as
E[Sn(t)] = x
n

i=1
E[Xk] = 0
Var[Sn(t)] = (x)2
n

i=1
Var[Xk] = (x)2n = (x)2 ! t
t
"
(8.18)
If we let t →0, then n →∞and we can use the central limit theorem to con-
clude that the sum in (8.17), properly standardized, converges to the standard normal
distribution.
To obtain a similar result for Sn(t), we also have to let x →0 in some orderly
fashion. It is clear from (8.18) that x would have to decrease at a slower rate than
t, of the order
√
t, if we are to obtain a positive and ﬁnite variance in the limit.
For simplicity, let x = σ
√
t to obtain the variance limit Var[Sn(t)] →σ2t and let
t →0. Then, the central limit theorem implies that
Sn(t) −E[Sn(t)]
√Var[Sn(t)]
d→N(0, 1)
(8.19)
as n →∞.
Since both E[Sn(t)] and Var[Sn(t)] converge to ﬁnite and, for the variance, positive
limits, we can reformulate (8.19) as
Sn(t)
d→B(t) ∼N(0, σ2t)
(8.20)
Another important property of the limiting process B(t) is that it has independent
increments, that is, the changes B(t3) −B(t2) and B(t2) −B(t1) are independent ran-
dom variables for t1 < t2 < t3, which should be intuitively clear from the random

BROWNIAN MOTION
511
0.0
0.2
0.4
0.6
0.8
1.0
−2
−1
0
1
2
3
4
0.0
0.2
0.4
(a)
(b)
0.6
0.8
1.0
−2
−1
0
1
2
3
4
FIGURE 8.3
Two realizations of Brownian motions in the unit interval for (a) σ = 1 and
(b) σ = 4.
walk deﬁnition above. In fact, these are the two fundamental deﬁning properties of
the process.
Deﬁnition 8.15. The Brownian Motion12B(t) is a real valued stochastic process in
real time t ≥0 that satisﬁes
(i) B(0) = 0
(ii) If t1 < t2 < . . . < tn, then B(t1), B(t2) −B(t1), . . . , B(tn) −B(tn−1) are in-
dependent
(iii) B(t + s) −B(s) ∼N(0, σ2t) for t, s ≥0
Note that part (iii) of Deﬁnition 8.15 is slightly more general than (8.20) since it
says that all increments are also normally distributed. It does behave very erratically,
which is illustrated in Figure 8.3 where two simulated Brownian motions are shown
for σ = 1 and σ = 4.
This is one of the most studied stochastic processes in the mathematical literature
partly because it has a lot of fascinating theoretical properties and because it has been
found to be very useful in quite different areas like physics (quantum mechanics),
electronics (ﬁltering theory), and economics (option pricing). We will not have time
to explore the Brownian motion in detail here except for some of the most fundamental
and useful properties.
12Named after the Scottish botanist Robert Brown (1773–1858) who studied pollen grains submerged in
liquid. To his amazement he observed that particles ejected from the pollen grains moved in a very erratic
random fashion. He was the ﬁrst to observe this phenomenon but he did not manage to explain it. Later,
the American mathematician Norbert Wiener (1894–1964) developed the mathematical theory behind it
and therefore the process B(t) is sometimes also called the Wiener process

512
STOCHASTIC PROCESSES
One interesting feature of B(t) is that it is scale invariant in both time and space.
It is quite easy to see, by checking the conditions in Deﬁnition 8.15, that if B(t) is a
Brownian motion with variance σ2, then B(t)/σ is a Brownian motion with variance
1. This is called the standard Brownian motion and since any Brownian motion can
be standardized in this way, it is common to assume that σ2 = 1. Similarly, it can be
shown that if B(t) is a standard Brownian motion, then B(σ2t) is a Brownian motion
with variance σ2. These scalings can also be combined.
Proposition 8.21 (Self-Similarity). Let B(t) be a standard Brownian motion. Then
the process
 B(t) = B(a2t)
a
is also a standard Brownian motion for any a /= 0.
Essentially, what this says is that if we would “zoom in” on the Brownian motion we
would see a process that would look quite similar to what we started with, that is,
the Brownian motion can be characterized as a random fractal. However, in order for
this to work, we see that the rescaling of the horizontal time axis has to be the square
of the rescaling of the vertical space axis. Also note that the rescaling constants does
not have to be positive. A negative a means that we reverse the vertical axis and, by
symmetry of the normal distribution, we still get a Brownian motion.
8.7.1
Hitting Times
One quantity of interest is the time until the Brownian motion attains some predeter-
mined level. As a practical example, let us say that we buy a share of stock whose
value can be described by a Brownian motion and decide to sell this after its value
has increased by a certain amount. Then, we would like to know how long it takes
until our investment pays off. We start with the following deﬁnition.
Deﬁnition 8.16. The time until the Brownian motion B(t) hits a is called the hitting
time and is deﬁned
Ta = min{t : B(t) = a}
Clearly, Ta is a nonnegative continuous random variable whose distribution is given
below.
Proposition 8.22. The hitting time Ta of a standard Brownian motion has pdf
fTa(t) =
|a|
√
2πt3 e−a2/2t
t > 0
for any a /= 0.

BROWNIAN MOTION
513
Proof. Let us ﬁrst assume that a > 0 and consider the event that the Brownian motion
exceeds a at time t. The law of total probability gives us
P(B(t) ≥a) = P(B(t) ≥a|Ta > t)P(Ta > t)
+P(B(t) ≥a|Ta ≤t)P(Ta ≤t)
(8.21)
The ﬁrst conditional probability above is clearly 0 since the event {Ta > t} means that
the Brownian motion has not hit a at time t and since B(t) is continuous, it cannot be
above a. If we turn to the second conditional probability, the condition says that we
have hit a before t. Then we can split B(t) into two parts
B(t) = B(Ta) + (B(t) −B(Ta)) = a + (B(t) −a)
Now, the increment B(t) −a is normally distributed with mean 0, which means that
P(B(t) ≥a|Ta > t) = P(B(t) −a ≥0) = 1
2
by symmetry. This means that (8.21) can be written as
P(Ta ≤t) = 2P(B(t) ≥a) = 2

1 −
a −0
√t

For a < 0, we consider the event {B(t) ≤a} and, again by symmetry, we get that
P(Ta ≤t) = 2P(B(t) ≤a) = 2
a −0
√t

= 2

1 −

−a
√t

Hence, the cdf can be written
FTa(t) = 2

1 −
 |a|
√t

(8.22)
and taking the derivative with respect to t yields the pdf
fTa(t) = −2φ
 |a|
√t

×

−|a|
2t3/2

=
|a|
√
2πt3 e−a2/2t
■
The properties of this distribution are not that easy to investigate. Even if Ta is ﬁnite
with probability 1, implying that we will hit a eventually, it turns out that the mean is
inﬁnite, in an analogy with Corollary 8.7, suggesting that it might take awhile. The
median, however, turns out to be just 1.67a2, so for small a there is a fair chance that
we will reach a fairly soon.
Example 8.43. Since the Brownian motion can be characterized as the scaled limit
of a symmetric random walk, we can use its properties to say something, at least

514
STOCHASTIC PROCESSES
approximately, about random walks. Therefore, let
Sn =
n

k=1
Xk
where X1, X2, . . . are deﬁned in (8.16), be a symmetric random walk. As an example,
let us consider the probability that the random walk will reach Sn = 100 within 1000
steps.
If we let t = 0.001 and x =
√
t =
√
0.001, by proper scaling, we see that
the event that Sn reaches 100 within 1000 steps is equivalent to Sn(t) deﬁned by (8.17)
reaching 100x =
√
10 in the interval [0, 1]. Since t is comparatively small, we
can use (8.20) to conclude that Sn(t)
d≈B(t), which means that we can express the
event approximately as {T√
10 ≤1} and (8.22) yields
P(
max
0≤n≤1000 Sn ≥100) ≈P(T√
10 ≤1) = 2(1 −
(3.16)) = 0.0016
This is quite unlikely, so let us consider 10,000 steps instead. We could do this by
another rescaling where t = 10−4, but it sufﬁces to use the scaling we have and
instead look at the time t = nt = 10. Then we get that
P(
max
0≤n≤10,000 Sn ≥100) ≈P(T√
10 ≤10) = 2(1 −
(1)) = 0.32
□
Another related quantity of interest is the maximum of a Brownian motion in a
ﬁxed interval. Therefore, we deﬁne the random variable
Mt = max
0≤s≤t B(s)
for the standard Brownian motion B(t). This variable has the following distribution.
Proposition 8.23. The maximum Mt of a standard Brownian motion in the interval
[0, t] has pdf
fMt(x) =
2
√
2πt
e−x2/2t
x > 0
Proof. The cdf of Mt can be written
FMt(x) = P(Mt ≤x) = 1 −P(Mt > x) = 1 −P(Tx < t)
since we have to hit the level x in order to exceed it before the time point t. Now,
Equation (8.22) yields
FMt(x) = 1 −FTx(t) = 1 −2

1 −
 |x|
√t

= 2
 x
√t

+ 1

BROWNIAN MOTION
515
since x > 0, and taking the derivative with respect to x gives us the pdf
fMt(x) = 2φ
 x
√t

× 1
√t =
2
√
2πt
e−x2/2t
■
Since t is ﬁxed and x is variable, this distribution is easier to understand. Essentially, it
consists of the positive part of a normal distribution with mean 0 and variance t, which
among other things means that the mean and variance can be calculated analytically
(see Problem 66).
8.7.2
Variations of the Brownian Motion
The standard Brownian motion B(t) is quite interesting in itself, but it is also used as a
component in other, more realistic processes applied in various ﬁelds. In this section,
we are going to look at some of the most common variations of B(t).
Example 8.44 (Brownian Motion with Drift). Sometimes, it is not enough to look at
a Brownian motion with zero mean but rather a process that has a tendency to drift
in a particular direction. We say that a Brownian motion with drift parameter μ and
variance σ2 is deﬁned as
X(t) = μt + σB(t)
For a ﬁxed t, we get that X(t) is normally distributed with mean μt and variance σ2t.
This means that the mean is increasing (or decreasing for μ < 0) toward inﬁnity, but
if the variance also increases toward inﬁnity, can we really be sure that the process
will have a tendency to drift upward? This is indeed the case, which can be seen by
considering the limit of
P(X(t) > a) = 1 −
a −μt
σ√t

= 1 −
 a
σ
1
√t −μ
σ
√
t

as t →∞. If μ > 0, we see that the argument of 
 above tends to −∞, which means
that P(X(t) > a) →1 for any a showing that X(t) will eventually exceed any ﬁnite
level.
□
Example 8.45 (Geometric Brownian Motion). Let X(t) be Brownian motion with
drift as deﬁned in Example 8.44. Geometric Brownian motion is then deﬁned as
Y(t) = eX(t) = eμt+σB(t)
Since ordinary Brownian motion can be characterized as a sum of independent normal
increments,thisgivesusaprocessthatcanhandleproductsofindependentincrements.
Furthermore, since X(t) is normally distributed for any ﬁxed t, we get that Y(t) follows
a lognormal distribution (see Section 2.8.1). This means that we can get the mean and

516
STOCHASTIC PROCESSES
variance as
E[Y(t)] = eμt+σ2t/2 = e(μ+σ2/2)t
(8.23)
Var[Y(t) = e2μt+σ2t 
eσ2t −1

It is interesting to note that we can have an increasing mean even if μ is negative as
long as μ > −σ2/2. It also holds that we can have an increasing variance if μ > −σ2.
This yields an interesting interval −σ2 < μ < −σ2/2 where we get a process whose
mean decreases exponentially to zero but whose variance increases exponentially to
inﬁnity. Basically, it means that the drift downward is not strong enough to prevent
brief excursions upward and the exponential functions ampliﬁes the effect rather
strongly.
One of the most common applications of the geometric Brownian motion is to use
it as a model for stock prices and even whole stock exchange indices. Since price
ﬂuctuations are relative to the stock, we get a natural situation where increments are
multiplicative rather than additive. In this context, μ is usually called the expected
logarithmic return and σ the volatility of the stock. The risk is usually interpreted as
the probability that the stock will decrease in value over a ﬁxed time period, that is,
P(Y(t) < Y(0) = 1) = P(X(t) < 0) = 
0 −μt
σ√t

= 

−μ
σ
√
t

This shows that in order to minimize the risk, we should choose a stock with high
expected return but low volatility. This is unfortunately not always possible in reality,
stocks with high expected return often suffer from high volatility and vice versa. On
the other hand, a high volatility also means a higher expected value, as shown in
(8.23), so it might still be worth to accept the higher risk. The geometric Brownian
motion has also proved to be a valuable tool in the ﬁeld of option pricing, but we will
not go further into that area here.
□
Example 8.46 (Brownian Bridge). In some situations, we may be interested in the
properties of a Brownian motion that returns to its starting point. Without loss of
generality, we will consider a standard Brownian motion B(t) that returns to 0 at time
t = 1. Brownian bridges with arbitrary variance σ2 and arbitrary time points t can be
obtained by appropriate time and space scaling. One way to do that is to condition on
the event {B(1) = 0}, but an equivalent and more convenient construction is
B◦(t) = B(t) −tB(1)
The Brownian bridge B◦(t) is a linear combination of two normally distributed quan-
tities and, hence, also normally distributed. The mean is clearly 0 and to calculate

PROBLEMS
517
the variance, we ﬁrst note that B(t) and B(1) −B(t) are independent and normally
distributed increments, which yields
Var[B◦(t)] = Var[B(t) −tB(1)] = Var[(1 −t)B(t) −t(B(1) −B(t))]
= (1 −t)2Var[B(t)] + t2Var[B(1) −B(t)]
= (1 −t)2t + t2(1 −t) = t(1 −t)
One of the most important applications of the Brownian bridge is as a large sample
approximation of the empirical distribution function
Fn(x) = 1
n
n

k=1
I{Xk≤x}
introduced in Section 6.9.1. We note that, for a ﬁxed x, the total number Y of events
{Xk ≤x} that occur is binomially distributed with parameters n and p = F(x). Then,
the central limit theorem implies that
Y −np
√np(1 −p)
d→N(0, 1)
as n →∞and, since Fn(x) = Y/n, we get
√n(Fn(x) −F(x))
d→N(0, F(x)(1 −F(x))) d= B◦(F(x))
Now, this result holds pointwise for every ﬁxed x, but can actually be generalized to
hold uniformly over the whole interval and is then usually expressed as
√n(F(·) −F(·))
d→B◦(F(·))
(8.24)
as n →∞.13 To show this requires more elaborate mathematical tools than we have
time to go into here. Sufﬁce it to say that it can be used to derive distributions of more
complex quantities like, for instance, the test statistic Dn = maxx |Fn(x) −F0(x)| for
the one-sample Kolmogorov–Smirnov test introduced in Section 6.9.1. Then (8.24)
implies that
√nDn
d→max
x
|B◦(F0(x))|
which in turn can be used to derive (6.7).
□
PROBLEMS
Section 8.2. Discrete-Time Markov Chains
1. The weather at a coastal resort is classiﬁed each day simply as “sunny” or
“rainy.” A sunny day is followed by another sunny day with probability 0.9,
13This result is usually called Donsker’s Theorem.

518
STOCHASTIC PROCESSES
and a rainy day is followed by another rainy day with probability 0.3. (a)
Describe this as a Markov chain. (b) If Friday is sunny, what is the probability
that Sunday is also sunny? (c) If Friday is sunny, what is the probability that
both Saturday and Sunday are sunny?
2. At another resort, it is known that the probability that any two consecutive days
are both sunny is 0.7 and that the other three combinations are equally likely.
Find the transition probabilities.
3. A machine produces electronic components that may come out defective and
the process is such that defective components tend to come in clusters. A defec-
tive component is followed by another defective component with probability
0.3, whereas a nondefective component is followed by a defective component
with probability 0.01. Describe this as a Markov chain and ﬁnd the long-term
proportion of defective components.
4. An insurance company classiﬁes its auto insurance policyholders in the cate-
gories “high,” “intermediate,” or “low” risk. In any given year, a policyholder
has no accidents with probability 0.6, one accident with probability 0.2, two
accidents with probability 0.1, and more than two accidents with probability
0.1. If you have no accidents, you are moved down one risk category; if you
have one, you stay where you are; if you have two accidents, you move up
one category; and if you have more than two, you always move to high risk.
(a) Describe the sequence of moves between categories of a policyholder as
a Markov chain. (b) If you start as a low-risk customer, how many years can
you expect to stay there? (c) How many years pass on average between two
consecutive visits in the high-risk category?
5. Consider the ON/OFF system from Example 8.4. Let Xn be the state after n steps,
and deﬁne Yn = (Xn, Xn+1). Show that {Yn} is a Markov chain on the state
space {0, 1} × {0, 1}, ﬁnd its transition matrix and stationary distribution.
6. Suppose that state i is transient and that i →j. Can j be recurrent?
7. Consider the state space S = {1, 2, . . . , n}. Describe a Markov chain on S that
has only one recurrent state.
8. Consider an irreducible Markov chain on a ﬁnite state space, such that the
transition matrix is symmetric (pij = pji for all i, j ∈S). Find the stationary
distribution.
9. Markov chains are named for Russian mathematician A. A. Markov, who in the
early twentieth century examined the sequence of vowels and consonants in
the 1833 poem Eugene Onegin by Alexander Pushkin. He empirically veriﬁed
the Markov property and found that a vowel was followed by a consonant
87% of the time and a consonant was followed by a vowel 66% of the time.
(a) Give the transition graph and the transition matrix. (b) If the ﬁrst letter is a
vowel, what is the probability that the third is also a vowel? (c) What are the
proportions of vowels and consonants in the text?
10. A text is such that a vowel is followed by a consonant 80% of the time and a
consonant is followed by a vowel 50% of the time. In the following cases, how

PROBLEMS
519
should you guess in order to maximize your probability to guess correctly: (a)
a letter is chosen at random, (b) a letter is chosen at random and the next letter
in the text is recorded, (c) ﬁve letters are chosen at random with replacement,
and (d) a sequence of ﬁve consecutive letters is chosen at random?
11. Consider a text composed of consonants, vowels, blank spaces, and punctuation
marks. When a letter is followed by another letter, which happens 80% of the
time, the probabilities are as in the previous problem. If a letter is not followed
by a letter, it is followed by a blank space 90% of the time. A punctuation mark
is always followed by a blank space, and a blank space is equally likely to be
followed by a vowel or a consonant. (a) State the transition matrix and ﬁnd the
stationary distribution. (b) If a symbol is chosen at random and turns out to be a
punctuation mark, what is the expected number of blank spaces before the next
punctuation mark? (c) If this is a literary text in English, what in the model do
you ﬁnd unrealistic?
12. Customers arrive at an ATM where there is room for three customers to wait
in line. Customers arrive alone with probability 2
3 and in pairs with probability
1
3 (but only one can be served at a time). If both cannot join, they both leave.
Call a completed service or an arrival an “event” and let the state be the number
of customers in the system (serviced and waiting) immediately after an event.
Suppose that an event is equally likely to be an arrival or a completed service.
(a) State the transition graph and transition matrix and ﬁnd the stationary distri-
bution. (b) If a customer arrives, what is the probability that he ﬁnds the system
empty? Full? (c) If the system is empty, the time until it is empty again is called
a “busy period.” During a busy period, what is the expected number of times
that the system is full?
13. Show that a limit distribution is a stationary distribution. The case of ﬁnite S is
easier, so you may assume this.
14. Consider the Markov chain with the following transition graph:
1
1/2
1
1
1
3
1/2
1
2
0
1
5
4
(a) What is the smallest number of steps (excluding 0) in which a state can reach
itself? (b) What is the period of the chain? (c) Find the stationary distribution.
Is it the limit distribution?
15. Consider the success run chain in Example 8.16. Suppose that the chain has
been running for a while and is in state 10. (a) What is the expected number
of steps until the chain is back at state 10? (b) What is the expected number of
times the chain visits state 9 before it is back at 10?

520
STOCHASTIC PROCESSES
16. Consider a version of the success run chain in Example 8.16 where we disregard
sequences of consecutive tails, in the sense that, for example T, TT, TTT, and
so on, all simply count as T. Describe this as a Markov chain and examine
it in terms of irreducibility, recurrence, and periodicity. Find the stationary
distribution and compare with Example 8.16. Is it the limit distribution?
17. Reversibility. Consider an ergodic Markov chain, observed at a late timepoint n.
If we look at the chain backward, we have the backward transition probability
qij = P(Xn−1 = j|Xn = i). (a) Express qij in terms of the forward transition
probabilities and the stationary distribution π. (b) If the forward and backward
transition probabilities are equal, the chain is called reversible. Show that this
occurs if and only if πipij = πjpji for all states i, j (this identity is usually taken
as the deﬁnition of reversibility). (c) Show that if a probability distribution π
satisﬁes the equation πipij = πjpji for all i, j, then π is stationary.
18. The intuition behind reversibility is that if we are given a sequence of con-
secutive states under stationary conditions, there is no way to decide whether
the states are given in forward or backward time. Consider the ON/OFF system
in Example 8.4, use the deﬁnition in the previous problem to show that it is
reversible, and explain intuitively.
19. For which values of p is the following matrix the transition matrix of a reversible
Markov chain? Explain intuitively.
P =
⎛
⎜
⎝
0
p
1 −p
1 −p
0
p
p
1 −p
0
⎞
⎟
⎠
20. Ehrenfest model of diffusion. Consider two containers containing a total of N
gas molecules, connected by a narrow aperture. Each time unit, one of the N
molecules is chosen at random to pass through the aperture from one container
to the other. Let Xn be the number of molecules in the ﬁrst container. (a) Find
the transition probabilities for the Markov chain {Xn}. (b) Argue intuitively
why the chain is reversible and why the stationary distribution is a certain bino-
mial distribution. Then use Problem 17 to show that it is indeed the stationary
distribution. (c) Is the stationary distribution also the limit distribution?
21. Consider an irreducible and positive recurrent Markov chain with stationary
distribution π and let g : S →R be a real-valued function on the state space. It
can be shown that
1
n
n

k=1
g(Xk) P→

j∈S
g(j)πj
for any initial distribution, where we recall convergence in probability from
Section 4.2. This result is reminiscent of the law of large numbers, but the sum-
mands are not i.i.d. We have mentioned that the interpretation of the stationary
distribution is the long-term proportion of time spent in each state. Show how

PROBLEMS
521
a particular choice of the function g above gives this interpretation (note that
we do not assume aperiodicity).
Section 8.3. Random Walks and Branching Processes
22. Consider the symmetric simple random walk at two timepoints: n and n + m.
Find ρ(Sn, Sn+m). What happens as m →∞for ﬁxed n and as n →∞for
ﬁxed m? Explain intuitively.
23. Consider the simple random walk with p /= 1
2. Use the law of large numbers to
argue that Sn goes to −∞if p < 1
2 and to ∞if p > 1
2.
24. Consider a symmetric simple random walk with reﬂecting barriers 0 and a, in
the sense that p0,0 = p0,1 = 1
2 and pa,a−1 = pa,a = 1
2. (a) Describe this as a
Markov chain and ﬁnd its stationary distribution. Is it the limit distribution? (b)
If the walk starts in 0, what is the expected number of steps until it is back? (c)
Suppose instead that reﬂection is immediate, so that p0,1 = 1 and pa,a−1 = 1,
everything else being the same. Describe the Markov chain, ﬁnd its stationary
distribution π, and compare it with (a). Explain the difference. Is π the limit
distribution?
25. Consider a variant of the simple random walk where the walk takes a step up
with probability p, down with probability q, or stays where it is with probability
r, where p + q + r = 1. Let the walk start in 0, and let τ1 be the time of the
ﬁrst visit to 1. Find P0(τ1 < ∞) and E0[τ1].
26. Consider the simple random walk starting in 0 and let τr be the time of the ﬁrst
visit to state r, where r ≥1. Find the expected value of τr if p > 1
2.
27. Consider the simple random walk with p /= 1
2, starting in 0 and let
τ0 = min{n ≥1 : Sn = 0}
the time of the ﬁrst return to 0. Use Corollary 8.5 to show that P0(τ0 < ∞) =
2 min(p, 1 −p).
28. Consider the simple random walk with p > 1
2 started in state 1. By Corollary 8.5
“reversed,” the probability that the walk ever visits 0 is (1 −p)/p. Now let the
initial state S0 be random, chosen according to a distribution on {0, 1, . . .} that
has pgf G. (a) Show that the probability that 0 is ever visited (which could occur
in step 0 if S0 = 0) is G((1 −p)/p). (b) Now instead consider the probability
that 0 is ever visited at step 1 or later. Show that this equals G((1 −p)/p) −
2p + 1. (c) Let p = 2
3 and S0 ∼Poi(1). Compute the probabilities in (a) and
(b) and also compare with the corresponding probability if S0 ≡1.
29. Consider a three-dimensional random walk Sn where in each step, one of the
six neighbors along the axes is chosen with probability 1
6 each. Let the walk
start in the origin and show that
P(S2n = (0, 0, 0)) =
1
6
2n

i+j+k=n
(2n)!
(i!j!k!)2
and use Stirling’s formula to conclude that the walk is transient.

522
STOCHASTIC PROCESSES
30. Consider a branching process with mean number of offspring μ, letting Yn be
the total number of individuals up to and including the nth generation and letting
Y be the total number of individuals ever born. (a) For what values of μ is Y
ﬁnite? (b) Express Yn in terms of Z0, . . . , Zn and ﬁnd E[Yn]. What happens as
n →∞? In particular, compare the two cases μ = 1 and μ < 1.
31. Consider a branching process where the offspring distribution is given by
P(X = k) = 1
3
2
3
k
, k = 0, 1, 2, . . .
(geometric distribution including 0). Find (a) E[Zn], (b) P(Z2 = 0), and
(c) the extinction probability q.
32. Branching with immigration. Consider a branching process where the offspring
distribution is {p0, p1, . . .}, with pgf G(s) and mean μ. Suppose that in each
generation there is immigration into the population according to a sequence of
i.i.d. random variables Y0, Y1, . . . with range {0, 1, 2, . . .} and the population
is thus started by the ﬁrst nonzero Yk. Let the Yk have distribution {q0, q1, . . .},
pgf H(s), and mean ν, and let Zn be the nth-generation size. (a) Show that
P(Z1 = 0) = q0H(p0). (b) Show that Zn has pgf given by #n
j=0 H(Gn−j(s)),
where Gn−j is the pgf of the (n −j)th generation in a branching process without
immigration. Use this to ﬁnd an expression for E[Zn]. (c) Suppose that the Yk
are Poisson with mean λ and the offspring distribution is p0 = 1 −p, p1 = p.
What is the distribution of Zn?
Section 8.4. Continuous-Time Markov Chains
33. Consider a continuous-time Markov chain where state i is absorbing. How
should the ith row of the generator G be deﬁned?
34. Consider the ON/OFF system in Example 8.21. State the backward and forward
equations and solve the forward equations. (Why are these easier to solve than
the backward equations?) What happens when t →∞?
35. Birds arrive at four bird feeders according to a Poisson process with rate one bird
per minute. If all feeders are occupied, an arriving bird leaves, but otherwise it
occupies a feeder and eats for a time that has an exponential distribution with
mean 1 min. Consider this as a Markov chain where a “state” is the number
of occupied feeders. The rate diagram is given below. (a) Explain the rates in
the diagram. (b) Find the generator G. (c) If three feeders are occupied, what
is the expected time until this changes? (d) If all feeders are occupied, what is
the probability that a bird arrives before a feeder becomes free?
4
3
2
1
1
1
1
1
0
3
1
4
2

PROBLEMS
523
36. Consider a continuous-time Markov chain that allows jumps from states to
themselves, after an exponentially distributed time. Although this sounds
more general than our construction, it is not. Explain! Hint: Problem 147 in
Chapter 3.
37. Consider a continuous-time Markov chain whose jump chain is the simple
random walk with reﬂecting barriers 0 and m from Problem 24(c). Suppose
that the holding times in states 0 and m are exp(a) and in all other states exp(b).
(a) Describe this in a rate diagram and give the generator G. (b) Find the
stationary distribution. For which values of a and b is it uniform? Compare
with the stationary distribution for the jump chain.
38. An invariant measure for a discrete-time Markov chain is a nonnegative vector ν
such that νP = ν. Thus, an invariant measure is more general than a stationary
distribution since its entries need not sum to one. (a) Let ν be invariant and
suppose that 0 < 
j∈S νj < ∞. Show that a stationary distribution exists. (b)
Let {X(t)} be a continuous-time Markov chain with stationary distribution π,
and let its jump chain {Xn} have invariant measure ν. Show that
πk = cνk
λ(k),
k ∈S
where λ(k) is the holding-time parameter in state k and c is a constant (show
that πG = 0 and explain the role of the constant c). Note that this gives an
alternative to solving πG = 0 in order to ﬁnd π. (c) Now let the jump chain
{Xn} be the simple symmetric random walk. Show that ν deﬁned by νk = 1 for
all k is invariant for {Xn}. (d) Let λ(0) = 1 and λ(k) = k2 for k /= 0, and show
that {X(t)} has a stationary distribution but that the jump chain {Xn} does not.
This shows that the jump chain is null recurrent but the continuous-time chain
is positive recurrent.
39. Consider a continuous-time Markov chain {X(t)} whose jump chain is the suc-
cess run chain from Problem 16. Give a condition on the holding time param-
eters λ(k), k = 0, 1, . . . guaranteeing that {X(t)} has a stationary distribution
(remember the previous problem).
40. Consider a linear birth–death process where the individual birth rate is λ =
1, the individual death rate is μ = 3, and there is constant immigration into
the population according to a Poisson process with rate α. (a) State the rate
diagram and the generator. (b) Suppose that there are 10 individuals in the
population. What is the probability that the population size increases to 11
before it decreases to 9? (c) Suppose that α = 1 and that the population just
became extinct. What is the expected time until it becomes extinct again?
41. In the previous problem suppose that an immigrating individual joins the popu-
lation only if it is extinct, and otherwise leaves. Find the rate diagram, generator,
and stationary distribution.
42. Consider state 0 in a birth–death process with stationary distribution π. Under
stationary conditions, we ought to have the balance equation π0λ0 = π1μ1
(“rate in equals rate out”), which is also precisely the ﬁrst equation of πG = 0.

524
STOCHASTIC PROCESSES
(a) Suggest how to formulate balance equations for any three states k −1, k,
and k + 1, and show that these equations are the same as πG = 0. (b) Describe
how the equation πG = 0 has an interpretation as balance equations for any
continuous-time Markov chain, not just birth–death processes.
43. Consider an M/M/1/r queue in equilibrium where r = 5 and the service rate
equals the arrival rate. (a) What is the proportion of lost customers? (b) How
does this change if the service rate is doubled?
44. Consider a queueing system where there is one server and no room to wait in
line (i.e., an M/M/1/1 queue). Further suppose that the arrival rate λ and the
service rate μ are equal. Under stationary conditions, ﬁnd the proportion of
customers who are lost (a) in this system, (b) if the service rate is doubled,
(c) if one customer can wait in line, and (d) if a second server is added.
45. Consider the following queueing system. Customers arrive in pairs according
to a Poisson process with rate λ = 1 customer pair/min. There is one server
and room for two customers to wait in line. Service times are exponential with
mean 30 s. If there is not room for both arriving customers, they both leave.
(a) Describe the system in a rate diagram and ﬁnd the stationary distribution.
(b) Now suppose that pairs may split up. If there is not room for both, then with
probability 1
2 they both leave and with probability 1
2 one stays and the other
leaves. Do (a) again under these assumptions.
46. Customer groups arrive to a service station according to a Poisson process
with rate λ groups/min. With probability p, such a group consists of a single
individual, and with probability 1 −p, it consists of a pair. There is a single
server and room for two to wait in line. Service times are exponential with rate
μ. If a pair arrives and they cannot both join, they both leave. (a) Give the state
space and describe the system in a rate diagram. (b) Suppose λ = μ and p = 1
2.
Find the stationary distribution (π0, π1, π2, π3).
47. Phone calls arrive at a company according to two independent Poisson pro-
cesses, one of female callers with rate 2 and one of male callers with rate 1
(calls/min). There is one server and room for one to wait in line. If the server is
busy, a female caller stays to wait in line with probability 0.8; a male caller, with
probability 0.5. Service times are i.i.d. exponential with mean length 2 min. Let
the state be the number of customers in the system. (a) Describe the system in a
rate diagram and ﬁnd the stationary distribution. (b) What proportion of callers
is lost?
48. Consider an M/M/1 queue with arrival rate λ and service rate μ and where an
arriving customer who ﬁnds k individuals in the system joins with probability
1/(k + 1). When does a stationary distribution exist and what is it?
49. Reneging. Consider an M/M/1 queue with arrival rate λ and service rate μ,
where a customer who is waiting in line reneges and leaves the line after a
time that is exp(ν) (unless service has started), independent of the queue length.
Describe this system in a rate diagram and state the generator.
50. Consider an M/M/1 queue in equilibrium and let W be the waiting time of
an arriving customer. Find the cdf of W. What type of distribution is this?

PROBLEMS
525
Hint: First ﬁnd P(W = 0) and then compute P(W > x) by conditioning on the
number of customers in the system.
51. Consider an M/M/1 queue in equilibrium and let T be the total time an arriving
customer spends in the system. Find the distribution of T (condition on the
number of customers in the system at arrival).
Section 8.5. Martingales
52. Let X1, X2, . . . be positive i.i.d. random variables with mean μ and let Pn =
X1 × . . . × Xn for n = 1, 2, . . .. Find a function g(x) so that Yn = g(Pn) be-
comes a martingale with respect to X1, X2, . . ..
53. Let X1 ≡1 and Xn+1 be uniformly distributed on the interval [0, Xn] for n =
1, 2, . . .. Find a function g(x) so that Yn = g(Xn) becomes a martingale with
respect to X1, X2, . . ..
54. Consider the branching process in Example 8.35. Show that Yn = qZn for n =
1, 2, . . . is a martingale with respect to Z1, Z2, . . ..
55. Polya’s urn model. Let us assume that we have an urn containing one white ball
and one black ball initially. A ball is selected completely at random from the
urn and put back together with a ball of the same color. Repeat this operation
inﬁnitely and let Yn denote the ratio of white balls in the urn after n steps. Show
that Y1, Y2, . . . is a martingale with respect to itself and use Proposition 8.14 to
conclude that Yn →Y with probability 1. What distribution does Y have?
56. Consider a simple random walk with p > 1
2. Show that Yn = Sn −(p −q)n
is a martingale with respect to S1, S2, . . . and use Proposition 8.15 to prove
Corollary 8.7.
Section 8.6. Renewal Processes
57. Consider a renewal process N(t) where T1, T2, . . . are i.i.d. and uniformly dis-
tributed on [0, 1]. Derive the renewal function m(t) for t ≤1.
58. Consider a lamp where the lightbulbs are replaced either when they burn out or
when they have burned for 336 h. The lifelengths of lightbulbs are assumed to
be i.i.d. and exponentially distributed with mean 300 h. (a) How often are the
lightbulbs replaced in the long run? (b) What is the probability that a supply of
50 lightbulbs will last for a year (8760 h)?
59. M/G/1/1.14 Assume that customers arrive to a service station with one server
according to a Poisson process with rate λ. When an arriving customer ﬁnds the
service station empty, he enters and starts being served, whereas if the server
is busy, he leaves and never returns. (a) If we denote the mean service time
μS, at what rate do customers enter the service station? (b) What proportion of
customers is actually served by the service station?
14The G stands for General, denoting that we allow any service time distribution.

526
STOCHASTIC PROCESSES
60. Let us assume that λ = 5 customers per minute in the previous problem and
that the mean and variance of the service times are μS = 0.25 and σ2
S = 0.1,
respectively. What is the probability that at least 120 customers will be served
during 1 h?
61. Find the distribution  F(t) of the initial interarrival time in a delayed renewal
process if the subsequent interarrival times are (a) exponentially distributed
(delayed Poisson process), (b) uniformly distributed on [0, 1], and (c) Gamma
distributed with α = 2
Section 8.7. Brownian Motion
62. Calculate (a) Cov[B(t), B(s)] and (b) Cov[B◦(t), B◦(s)].
63. Derive the distribution of B(t) + B(s) for t /= s.
64. Calculate E[B(t)B(s)].
65. Show that B∗(t) = tB(1/t) is a standard Brownian motion.
66. Calculate the mean and variance of the maximum Mt of a standard Brownian
motion in the interval [0, t].
67. Derive the conditional distribution of B(t) for t1 < t < t2 conditioned on the
event {B(t1) = x1, B(t2) = x2}
68. Consider a Brownian motion with drift parameter μ and variance σ2. Derive
the distribution of B(t) conditioned on the event {B(s) = c} for (a) t > s and
(b) t < s.
69. The discounted value of a share of stock can be described as a geometric Brow-
nian motion with drift parameter μ = 0 and variance σ2 = 0.2. The time unit
is 1 year. Let us assume that we decide to sell the share when it has increased
by 20%. What is the probability that we sell the share within 6 months?
70. Two-dimensional Brownian motion. Let Bx(t) and By(t) be two independent
standard Brownian motion describing the horizontal and vertical location of
a particle moving in two dimensions. Derive the pdf of the distance R(t) =
$
Bx(t)2 + By(t)2 from the origin after t time units.

APPENDIX A
TABLES
TABLE A.1
Values of the cdf (x) of the Standard Normal Distribution [e.g.,
(1.41) = 0.921]
x
0
1
2
3
4
5
6
7
8
9
0.0
0.500
0.504
0.508
0.512
0.516
0.520
0.524
0.528
0.532
0.536
0.1
0.540
0.544
0.548
0.552
0.556
0.560
0.564
0.568
0.571
0.575
0.2
0.579
0.583
0.587
0.591
0.595
0.599
0.603
0.606
0.610
0.614
0.3
0.618
0.622
0.626
0.629
0.633
0.637
0.641
0.644
0.648
0.652
0.4
0.655
0.659
0.663
0.666
0.670
0.674
0.677
0.681
0.684
0.688
0.5
0.692
0.695
0.698
0.702
0.705
0.709
0.712
0.716
0.719
0.722
0.6
0.726
0.729
0.732
0.736
0.739
0.742
0.745
0.749
0.752
0.755
0.7
0.758
0.761
0.764
0.767
0.770
0.773
0.776
0.779
0.782
0.785
0.8
0.788
0.791
0.794
0.797
0.800
0.802
0.805
0.808
0.811
0.813
0.9
0.816
0.819
0.821
0.824
0.826
0.829
0.832
0.834
0.836
0.839
1.0
0.841
0.844
0.846
0.848
0.851
0.853
0.855
0.858
0.860
0.862
1.1
0.864
0.867
0.869
0.871
0.873
0.875
0.877
0.879
0.881
0.883
1.2
0.885
0.887
0.889
0.891
0.892
0.894
0.896
0.898
0.900
0.902
1.3
0.903
0.905
0.907
0.908
0.910
0.912
0.913
0.915
0.916
0.918
1.4
0.919
0.921
0.922
0.924
0.925
0.926
0.928
0.929
0.931
0.932
1.5
0.933
0.934
0.936
0.937
0.938
0.939
0.941
0.942
0.943
0.944
1.6
0.945
0.946
0.947
0.948
0.950
0.951
0.952
0.952
0.9545
0.954
(Continued)
Probability, Statistics, and Stochastic Processes, Second Edition. Peter Olofsson and Mikael Andersson.
© 2012 John Wiley & Sons, Inc. Published 2012 by John Wiley & Sons, Inc.
527

528
APPENDIX A
TABLE A.1
(Continued)
x
0
1
2
3
4
5
6
7
8
9
1.7
0.955
0.956
0.957
0.958
0.959
0.960
0.961
0.962
0.962
0.963
1.8
0.964
0.965
0.966
0.966
0.967
0.968
0.969
0.969
0.970
0.971
1.9
0.971
0.972
0.973
0.973
0.974
0.974
0.975
0.976
0.976
0.977
2.0
0.977
0.978
0.978
0.979
0.979
0.980
0.980
0.981
0.981
0.982
2.1
0.982
0.983
0.983
0.983
0.984
0.984
0.985
0.985
0.985
0.986
2.2
0.986
0.986
0.987
0.987
0.988
0.988
0.988
0.988
0.989
0.989
2.3
0.989
0.990
0.990
0.990
0.990
0.991
0.991
0.991
0.991
0.992
2.4
0.992
0.992
0.992
0.992
0.993
0.993
0.993
0.993
0.993
0.994
2.5
0.994
0.994
0.994
0.994
0.995
0.995
0.995
0.995
0.995
0.995
2.6
0.995
0.996
0.996
0.996
0.996
0.996
0.996
0.996
0.996
0.996
2.7
0.996
0.997
0.997
0.997
0.997
0.997
0.997
0.997
0.997
0.997
2.8
0.997
0.998
0.998
0.998
0.998
0.998
0.998
0.998
0.998
0.998
2.9
0.998
0.998
0.998
0.998
0.998
0.998
0.998
0.998
0.999
0.999
TABLE A.2
Values of (x) Commonly used in Conﬁdence Intervals and Tests, and the
Corresponding x Values
(x)
0.90
0.95
0.975
0.99
0.995
x
1.28
1.64
1.96
2.33
2.58
TABLE A.3
Percentiles of the t Distribution with DF Degrees of Freedom
[e.g., Ft7(1.89) = 0.95]
DF
0.95
0.975
0.99
0.995
DF
0.95
0.975
0.99
0.995
1
6.31
12.71
31.82
63.66
16
1.75
2.12
2.58
2.92
2
2.92
4.30
6.96
9.92
17
1.74
2.11
2.58
2.90
3
2.35
3.18
4,54
5.84
18
1.73
2.10
2.55
2.88
4
2.13
2.78
3.74
4.60
19
1.73
2.09
2.54
2.86
5
2.02
2.57
3.36
4.03
20
1.72
2.09
2.53
2.85
6
1.94
2.45
3.14
3.71
21
1.72
2.08
2.52
2.83
7
1.89
2.36
3.00
3.50
22
1.72
2.07
2.51
2.82
8
1.86
2.31
2.90
3.36
23
1.71
2.07
2.50
2.81
9
1.83
2.26
2.82
3.25
24
1.71
2.06
2.49
2.80
10
1.81
2.23
2.76
3.17
25
1.71
2.06
2.49
2.79
11
1.80
2.20
2.72
3.11
26
1.71
2.06
2.48
2.78
12
1.78
2.18
2.68
3.05
27
1.70
2.05
2.47
2.77
13
1.77
2.16
2.65
3.01
28
1.70
2.05
2.47
2.76
14
1.76
2.14
2.62
2.98
29
1.70
2.05
2.46
2.76
15
1.75
2.13
2.60
2.95
30
1.70
2.04
2.46
2.75

APPENDIX A
529
TABLE A.4
Percentiles of the Chi-square Distribution with DF Degrees of Freedom
[e.g., Fχ2
20(10.85) = 0.05]
DF
0.025
0.05
0.95
0.975
DF
0.025
0.05
0.95
0.975
1
0.001
0.004
3.84
5.02
16
6.91
7.96
26.30
28.84
2
0.05
0.10
5.99
7.38
17
7.56
8.67
27.59
30.19
3
0.22
0.35
7.82
9.34
18
8.23
9.39
28.87
31.53
4
0.48
0.71
9.49
11.14
19
8.91
10.12
30.14
32.85
5
0.83
1.14
11.07
12.83
20
9.59
10.85
31.41
34.17
6
1.24
1.64
12.59
14.45
21
10.28
11.60
32.67
35.48
7
1.69
2.17
14.07
16.01
22
10.98
12.34
33.92
36.78
8
2.18
2.73
15.51
17.54
23
11.69
13.09
35.17
38.08
9
2.70
3.32
19.92
19.02
24
12.40
13.85
36.42
39.36
10
3.25
3.94
18.31
20.48
25
13.12
14.61
37.65
40.65
11
3.82
4.58
19.68
21.92
26
13.84
15.38
38.88
41.92
12
4.40
5.23
21.03
23.34
27
14.57
16.15
40.11
43.19
13
5.01
5.89
22.36
27.74
28
15.31
16.93
41.34
44.46
14
5.63
6.57
23.68
26.12
29
16.05
17.71
42.56
45.72
15
6.26
7.26
25.00
27.49
30
16.79
18.49
43.77
46.98
TABLE A.5
Percentiles of the F Distribution with r and s Degrees of Freedom [e.g.,
FF8,20(2.45) = 0.95]
2.5% percentile
s
r = 2
3
4
5
6
7
8
9
10
2
0.026
0.062
0.094
0.119
0.138
0.153
0.165
0.175
0.183
3
0.026
0.065
0.100
0.129
0.152
0.170
0.185
0.197
0.207
4
0.025
0.066
0.104
0.135
0.161
0.181
0.198
0.212
0.224
5
0.025
0.067
0.107
0.140
0.167
0.189
0.208
0.223
0.236
6
0.025
0.068
0.109
0.143
0.172
0.195
0.215
0.231
0.246
7
0.025
0.068
0.110
0.146
0.176
0.200
0.221
0.238
0.253
8
0.025
0.069
0.111
0.148
0.179
0.204
0.226
0.244
0.259
9
0.025
0.069
0.112
0.150
0.181
0.207
0.230
0.248
0.265
10
0.025
0.069
0.113
0.151
0.183
0.210
0.233
0.252
0.269
12
0.025
0.070
0.114
0.153
0.186
0.214
0.238
0.259
0.276
15
0.025
0.070
0.116
0.156
0.190
0.219
0.244
0.265
0.284
16
0.025
0.070
0.116
0.156
0.191
0.220
0.245
0.267
0.286
18
0.025
0.070
0.116
0.157
0.192
0.222
0.248
0.270
0.290
20
0.025
0.071
0.117
0.158
0.193
0.224
0.250
0.273
0.293
21
0.025
0.071
0.117
0.158
0.194
0.225
0.251
0.274
0.294
24
0.025
0.071
0.117
0.159
0.195
0.227
0.253
0.277
0.297
25
0.025
0.071
0.118
0.160
0.196
0.227
0.254
0.278
0.298
27
0.025
0.071
0.118
0.160
0.197
0.228
0.255
0.279
0.300
28
0.025
0.071
0.118
0.160
0.197
0.228
0.256
0.280
0.301
30
0.025
0.071
0.118
0.161
0.197
0.229
0.257
0.281
0.302
(Continued)

530
APPENDIX A
TABLE A.5
(Continued)
95% percentile
s
r = 2
3
4
5
6
7
8
9
10
2
19.00
19.16
19.25
19.30
19.33
19.35
19.37
19.38
19.40
3
9.55
9.28
9.12
9.01
8.94
8.89
8.85
8.81
8.79
4
6.94
6.59
6.39
6.26
6.16
6.09
6.04
6.00
5.96
5
5.79
5.41
5.19
5.05
4.95
4.88
4.82
4.77
4.74
6
5.14
4.76
4.53
4.39
4.28
4.21
4.15
4.10
4.06
7
4.74
4.35
4.12
3.97
3.87
3.79
3.73
3.68
3.64
8
4.46
4.07
3.84
3.69
3.58
3.50
3.44
3.39
3.35
9
4.26
3.86
3.63
3.48
3.37
3.29
3.23
3.18
3.14
10
4.10
3.71
3.48
3.33
3.22
3.14
3.07
3.02
2.98
12
3.89
3.49
3.26
3.11
3.00
2.91
2.85
2.80
2.75
15
3.68
3.29
3.06
2.90
2.79
2.71
2.64
2.59
2.54
16
3.63
3.24
3.01
2.85
2.74
2.66
2.59
2.54
2.49
18
3.55
3.16
2.93
2.77
2.66
2.58
2.51
2.46
2.41
20
3.49
3.10
2.87
2.71
2.60
2.51
2.45
2.39
2.35
21
3.47
3.07
2.84
2.68
2.57
2.49
2.42
2.37
2.32
24
3.40
3.01
2.78
2.62
2.51
2.42
2.36
2.30
2.25
25
3.39
2.99
2.76
2.60
2.49
2.40
2.34
2.28
2.24
27
3.35
2.96
2.73
2.57
2.46
2.37
2.31
2.25
2.20
28
3.34
2.95
2.71
2.56
2.45
2.36
2.29
2.24
2.19
30
3.32
2.92
2.69
2.53
2.42
2.33
2.27
2.21
2.16
97.5% percentile
s
r = 2
3
4
5
6
7
8
9
10
2
39.00
39.17
39.25
39.30
39.33
39.36
39.37
39.39
39.40
3
16.04
15.44
15.10
14.88
14.73
14.62
14.54
14.47
14.42
4
10.65
9.98
9.60
9.36
9.20
9.07
8.98
8.90
8.84
5
8.43
7.76
7.39
7.15
6.98
6.85
6.76
6.68
6.62
6
7.26
6.60
6.23
5.99
5.82
5.70
5.60
5.52
5.46
7
6.54
5.89
5.52
5.29
5.12
4.99
4.90
4.82
4.76
8
6.06
5.42
5.05
4.82
4.65
4.53
4.43
4.36
4.30
9
5.71
5.08
4.72
4.48
4.32
4.20
4.10
4.03
3.96
10
5.46
4.83
4.47
4.24
4.07
3.95
3.85
3.78
3.72
12
5.10
4.47
4.12
3.89
3.73
3.61
3.51
3.44
3.37
15
4.77
4.15
3.80
3.58
3.41
3.29
3.20
3.12
3.06
16
4.69
4.08
3.73
3.50
3.34
3.22
3.12
3.05
2.99
18
4.56
3.95
3.61
3.38
3.22
3.10
3.01
2.93
2.87
20
4.46
3.86
3.51
3.29
3.13
3.01
2.91
2.84
2.77
21
4.42
3.82
3.48
3.25
3.09
2.97
2.87
2.80
2.73
24
4.32
3.72
3.38
3.15
2.99
2.87
2.78
2.70
2.64
25
4.29
3.69
3.35
3.13
2.97
2.85
2.75
2.68
2.61
27
4.24
3.65
3.31
3.08
2.92
2.80
2.71
2.63
2.57
28
4.22
3.63
3.29
3.06
2.90
2.78
2.69
2.61
2.55
30
4.18
3.59
3.25
3.03
2.87
2.75
2.65
2.57
2.51

APPENDIX A
531
TABLE A.6
95% Percentiles of the Studentized Range Distribution with r and s
Degrees of Freedom [e.g., FR8,20(4.77) = 0.95]
s
r = 3
4
5
6
7
8
9
10
2
8.33
9.80
10.88
11.73
12.43
13.03
13.54
13.99
3
5.91
6.82
7.50
8.04
8.48
8.85
9.18
9.46
4
5.04
5.76
6.29
6.71
7.05
7.35
7.60
7.83
5
4.60
5.22
5.67
6.03
6.33
6.58
6.80
6.99
6
4.34
4.90
5.30
5.63
5.90
6.12
6.32
6.49
7
4.16
4.68
5.06
5.36
5.61
5.82
6.00
6.16
8
4.04
4.53
4.89
5.17
5.40
5.60
5.77
5.92
9
3.95
4.41
4.76
5.02
5.24
5.43
5.59
5.74
10
3.88
4.33
4.65
4.91
5.12
5.30
5.46
5.60
12
3.77
4.20
4.51
4.75
4.95
5.12
5.27
5.39
15
3.67
4.08
4.37
4.59
4.78
4.94
5.08
5.20
16
3.65
4.05
4.33
4.56
4.74
4.90
5.03
5.15
18
3.61
4.00
4.28
4.49
4.67
4.82
4.96
5.07
20
3.58
3.96
4.23
4.45
4.62
4.77
4.90
5.01
21
3.56
3.94
4.21
4.42
4.60
4.74
4.87
4.98
24
3.53
3.90
4.17
4.37
4.54
4.68
4.81
4.92
25
3.52
3.89
4.15
4.36
4.53
4.67
4.79
4.90
27
3.51
3.87
4.13
4.33
4.50
4.64
4.76
4.86
28
3.50
3.86
4.12
4.32
4.49
4.62
4.74
4.85
30
3.49
3.85
4.10
4.30
4.46
4.60
4.72
4.82
TABLE A.7
Critical Values c for the Wilcoxon Signed Rank Test, Where n is
the Sample Size and C = n(n + 1) −c [e.g., if n = 20, then
P(W ≤61) = P(W ≥149) ≈0.05]
n
0.025
0.05
n(n + 1)/2
n
0.025
0.05
n(n + 1)/2
5
0
1
15
18
41
48
171
6
1
3
21
19
47
54
190
7
3
4
28
20
53
61
210
8
4
6
36
21
59
68
231
9
6
9
45
22
67
76
253
10
9
11
55
23
74
84
276
11
11
14
66
24
82
92
300
12
14
18
78
25
90
101
325
13
18
22
91
26
99
111
351
14
22
26
105
27
108
120
378
15
26
31
120
28
117
131
406
16
30
36
136
29
127
141
435
17
35
42
153
30
138
152
465

532
APPENDIX A
TABLE A.8
Critical Values c for the Wilcoxon Rank Sum Test, Where m is the Size of
the Smaller Sample and C = m(m + n + 1) −c [e.g., if m = 4 and n = 8, then
P(W ≤16) = P(W ≥36) ≈0.05]
n
P(W ≤c)
m = 2
3
4
5
6
7
8
9
10
11
2
0.025
3
0.05
3
3
0.025
3
3
0.05
6
7
4
0.025
3
6
11
0.05
3
7
12
5
0.025
3
7
12
18
0.05
4
8
13
20
6
0.025
3
8
13
19
27
0.05
4
9
14
21
29
7
0.025
3
8
14
21
28
37
0.05
4
9
15
22
30
40
8
0.025
4
9
15
22
30
39
50
0.05
5
10
16
24
32
42
52
9
0.025
4
9
15
23
32
41
52
63
0.05
5
11
17
25
34
44
55
67
10
0.025
4
10
16
24
33
43
54
66
79
0.05
5
11
18
27
36
46
57
70
83
11
0.025
5
10
17
25
35
45
56
69
82
97
0.05
5
12
19
28
38
48
60
73
87
101
TABLE A.9
Critical Values c for the One-Sample Kolmogorov–Smirnov Test Where n
is the Sample Size [e.g. FD10(0.409) = 0.95]
n
0.01
0.05
n
0.01
0.05
1
0.995
0.975
16
0.392
0.327
2
0.929
0.842
17
0.381
0.318
3
0.829
0.708
18
0.371
0.309
4
0.734
0.624
19
0.361
0.301
5
0.669
0.563
20
0.352
0.294
6
0.617
0.519
21
0.344
0.287
7
0.576
0.483
22
0.337
0.281
8
0.542
0.454
23
0.330
0.275
9
0.513
0.430
24
0.323
0.269
10
0.489
0.409
25
0.317
0.264
11
0.468
0.391
26
0.311
0.259
12
0.449
0.375
27
0.305
0.254
13
0.432
0.361
28
0.300
0.250
14
0.418
0.349
29
0.295
0.246
15
0.404
0.338
30
0.290
0.242

APPENDIX A
533
TABLE A.10
Critical Values c for the Two-Sample Kolmogorov–Smirnov Test on the
5% Level Where m is the Size of the Smaller Sample [e.g. P(D7,10 ≥0.614) ≈0.05]
n
m = 2
3
4
5
6
7
8
9
10
4
–
–
1
5
–
1
1
1
6
–
1
0.833
0.8
0.833
7
–
1
0.857
0.8
0.714
0.857
8
1
0.875
0.875
0.75
0.708
0.714
0.75
9
1
0.889
0.778
0.778
0.722
0.667
0.639
0.667
10
1
0.9
0.75
0.8
0.667
0.657
0.6
0.589
0.7
11
1
0.909
0.75
0.709
0.652
0.623
0.602
0.596
0.545
12
1
0.833
0.75
0.717
0.667
0.631
0.625
0.583
0.55
13
1
0.846
0.75
0.692
0.667
0.615
0.596
0.556
0.538
14
1
0.857
0.75
0.657
0.643
0.643
0.571
0.556
0.529
15
0.933
0.8
0.733
0.733
0.633
0.590
0.558
0.556
0.567
16
0.938
0.812
0.75
0.675
0.625
0.571
0.625
0.542
0.525
17
0.941
0.824
0.706
0.647
0.608
0.571
0.566
0.536
0.524
18
0.944
0.833
0.694
0.667
0.667
0.571
0.556
0.556
0.511
19
0.947
0.790
0.697
0.642
0.614
0.571
0.540
0.520
0.495
20
0.95
0.8
0.75
0.65
0.6
0.564
0.55
0.517
0.55
n
m = 11
12
13
14
15
16
17
18
19
20
11
0.636
12
0.546
0.583
13
0.524
0.519
0.538
14
0.532
0.512
0.489
0.571
15
0.509
0.517
0.492
0.467
0.533
16
0.506
0.5
0.486
0.473
0.475
0.5
17
0.497
0.490
0.475
0.466
0.455
0.456
0.471
18
0.490
0.5
0.470
0.460
0.456
0.444
0.435
0.5
19
0.488
0.474
0.462
0.455
0.446
0.438
0.436
0.415
0.474
20
0.486
0.483
0.462
0.45
0.45
0.438
0.429
0.422
0.421
0.45

534
APPENDIX A
TABLE A.11
Critical Values c for the Kruskal–Wallis Test on the 5% Level, Where k
is the Number of Groups and n is the Sample Size [e.g., if k = 4 and n = 5, then
P(K ≥7.37) ≈0.05]
n
k = 3
4
5
6
7
8
9
10
2
–
6.00
7.31
8.85
10.17
11.47
12.74
14.03
3
5.42
6.90
8.30
9.75
11.13
12.49
13.83
15.18
4
5.65
7.21
8.73
10.16
11.59
12.98
14.33
15.68
5
5.66
7.37
8.91
10.38
11.84
13.21
14.62
15.95
6
5.72
7.45
9.00
10.49
11.96
13.38
14.77
16.10
7
5.77
7.48
9.09
10.60
12.08
13.47
14.87
16.27
8
5.80
7.53
9.12
10.68
12.10
13.56
14.96
16.34
9
5.85
7.58
9.18
10.71
12.18
13.60
15.02
16.40
10
5.86
7.61
9.22
10.76
12.22
13.66
15.08
16.44
11
5.84
7.59
9.25
10.79
12.26
13.71
15.12
16.51
12
5.88
7.65
9.26
10.80
12.31
13.73
15.12
16.54
13
5.86
7.65
9.27
10.82
12.30
13.77
15.17
16.57
14
5.86
7.63
9.30
10.84
12.34
13.77
15.21
16.58
15
5.91
7.67
9.33
10.86
12.38
13.81
15.22
16.62
16
5.91
7.71
9.29
10.86
12.38
13.82
15.26
16.66
17
5.90
7.70
9.31
10.88
12.40
13.85
15.22
16.65
18
5.91
7.69
9.34
10.92
12.43
13.85
15.25
16.66
19
5.93
7.72
9.35
10.91
12.37
13.89
15.28
16.69
20
5.93
7.72
9.35
10.94
12.40
13.89
15.31
16.69

APPENDIX B
ANSWERS TO SELECTED PROBLEMS
CHAPTER 1
1
(a) {3, 4, . . . , 18} (b) [0, 1] × [0, 1] (c) {M, F} × {0, 1, 2, . . .}
(d) {(i, j) : 1 ≤i < j ≤10} (e) [0, 1].
2
S = {rr, rs, sr, ss}
3
(c) and (e)
4
(a) (A ∩Bc ∩Cc) ∪(Ac ∩B ∩Cc) ∪(Ac ∩Bc ∩C) (b) Ac ∩Bc ∩Cc
(c) A ∪B ∪C
5
(a) B1 (b) Bc
1 ∩B2 ∩B3 (c) B1 ∩B2 ∩B3 ∩B4 (d) (Bc
1 ∩B2 ∩B3 ∩B4 ∩
B5) ∪(B1 ∩Bc
2 ∩B3 ∩B4 ∩B5) ∪(B1 ∩B2 ∩Bc
3 ∩B4 ∩B5)(B1 ∩B2 ∩
B3 ∩Bc
4 ∩B5) (e) B1 ∩B2 ∩B3 ∩Bc
4 ∩Bc
5 ∩Bc
6 ∩Bc
7
6
0.6
7
(a) P(B) = 0.4 (b, c) P(A ∩Bc) = 0.1 (d) P(Ac) = 0.7 (e) P(Bc) = 0.6
(f) P(Ac ∩Bc) = 0.5 (which also equals P((A ∪B)c)).
8
(a) 0.5 −p (b) 1 −2p (c) p
10
(b)
12
(a) 3/8 (b) 1/8 (c) 7/8 (d) 1/8 (e) 3/8
Probability, Statistics, and Stochastic Processes, Second Edition. Peter Olofsson and Mikael Andersson.
© 2012 John Wiley & Sons, Inc. Published 2012 by John Wiley & Sons, Inc.
535

536
APPENDIX B
16
(a) 0.5 + 0.33 + 0.2 −(0.16 + 0.2 + 0.08) + 0.08 = 0.67
(b) P(Ai) + P(Aj) + P(Ak) −(P(Alcm(i,j)) + P(Alcm(i,k))+
P(Alcm(j,k))) + P(Alcm(i,j,k)) (see Example 1.10)
17
(a) (7.1 + 15 −0.75)/143 = 0.149
(b) (7.1 + 15 + 10 −(0.75 + 0.5 + 0) + 0)/143 = 0.216
(c) (71 + 15 + 71 + 1 −(7.5 + 35.5 + 0 + 7.5 + 0 + 0) + (3.75 + 0 + 0 +
0) −0)/143 = 0.778
19
(a)
7
2

× 265 × 102 = 2.5 × 1010 (b)
7
2

× (26)5(10)2 = 1.5 × 1010
20
(a) 23 × 22 × 21/233 = 0.87 (b) 10 × 9 × 8/103 = 0.72 (c) 23/233 = 0.002
(d) 53/103 = 0.125 (e) 23 × 22 × 21 × 10/(233103) = 0.009
21
(a) 5 × 264/2610 = 1.6 × 10−8 (b) 5 × (20)4/(26)10 = 3.0 × 10−8
22
(a) 1/4 (b) 11/24 (c) 10/24
20
(a) 6, 12
25
(a)
8
3

/
64
3

= 1/744 (b)
32
3

/
64
3

= 5/42 (c) 8 ×
8
3

/
64
3

= 1/93
(d) 8 × 2 ×
4
3

/
64
3

= 1/651
26
(a) 1/
n
j

(b) 2/
n
j

(c) (n −j + 1)/
n
j

27
3
2n
k

−
n
k

/
3n
k

28

4 ×
39
13

−6 ×
26
13

+ 4
13
13

/
52
13

= 0.05
29
(a)
5
4
39
1
43
1

/(
44
5
44
1

) = 0.00018 (b)
5
3
39
2
1
1

/(
44
5
44
1

) = 0.00016
30
(a) 4/
52
5

= 1.5 × 10−6 (b) 9 × 4/
52
5

= 0.000014
(c) 13 × 48/
52
5

= 0.00024 (d) 13 × 12 ×
4
3
4
2

/
52
5

= 0.0014
(e) 4(×
13
5

−10)/
52
5

= 0.002 (f) (10 × 45 −40)/
52
5

= 0.0039
(g) 13 ×
12
2

× 43/
52
5

= 0.021 (h)
13
2
4
2
4
2

× 44/
52
5

= 0.0475
(i) 13 ×
4
2
12
3

× 43/
52
5

= 0.4226
31
(a)
6
2

/
10
3

(b)
3
1

/
10
3

(c) (k −j −1)/
n
3

32
m(n)k−1/(n + m)k
34
k−1
n−1

33
false, 0 < P(A) < 1, B = A
35
0.63
36
(a)
n0 = n! n
k=0
(−1)k
k!
(b)
P(j matches) = nj
n! = 1
j!
n−j
k=0
(−1)k
k! ,
j =
0, . . . , n, which is ≈e−1
j! for large n
40
(a) P(A ∪B) = 2
3, P(A ∩B) = 1
6 (b) P(A ∪B) = 5
6, P(A ∩B) = 0
(c) P(A ∪B) = 2
3, P(A ∩B) = 1
6 (d) P(A ∪B) = 1
2, P(A ∩B) = 1
3
41
(a) P(A ∩B) = P(A)P(B|A) = 0.60 · 0.75 = 0.45
(b) P(A ∩Bc) = P(A)P(Bc|A) = 0.60 · 0.25 = 0.15
(c) P(A|B) = P(A ∩B)/P(B) = 0.45/0.50 = 0.90
(d) P(B|Ac) = P(Ac∩B)
P(Ac)
= P(Ac|B)P(B)
P(Ac)

APPENDIX B
537
42
(a) true (b) false (c) true (d) true (if P(A) < 1)
45
p = 0, 1/2, 1
48
No, for any events A and B, P(A ∩B) ≤P(A) and P(A ∩B) ≤P(B)
49
P(B|A) = 1, P(A|B) = 3/5
50
(a) 1
6 (b) 1
2
51
n = 7
52
(a) (0.4 × 0.16)2 = 0.0041 (b) 2 × 0.378 × (1 −0.378) = 0.47
(c) 1 −(1 −0.45 × 0.84)2 = 0.61
(d) 0.96 × 0.84 + 0.96 × 0.84 × 0.16 = 0.94
(e) 0.452 + 0.402 + 0.112 + 0.042 = 0.38 (f) 0.38 × 2 × 0.84 × 0.16 = 0.10
54
No, the probability that you win is ≈0.45 (compare the birthday problem).
55
p2 + (1 −p)2, p = 1/2
56
(a) 365
k=1 p2
k
57
(a) (1/2)5 (b) (5/9)5 (c) (2/3)5
59
(a) P(A ∩B ∩C) = 1/36, P(A) = 1/2, P(B) = 2/3, P(C) = 1/12 (b) No
61
(a) (1 −1/143)3 = 0.98 (b) 0.02 (c) (71/143)3 = 0.1224
(d) 3(10 × 1182 + 10 × 15 × 118)/1433 = 0.161
62
(4/5)3 = 0.512
63
(a) 8/15 (b) ((2n −2)(2n −4) · · · 2)/((2n −1)(2n −3) · · · 1)
64
n/2n−1
65
3((2/3)5 −(1/3)5) = 0.38
67
(1 −(1 −p)2)2, 1 −(1 −p2)2
68
n
j=k
n
j

pj(1 −p)n−j
69
4 rounds, P(win) = 1 −(5/6)4 ≈0.52
70
(a) 1 −(1 −1/1, 000, 000)2,000,000 = 0.86 (b) n ≥693147
71
P(A1) = 6(1/6)n, P(A2) =
6
2

((2/6)n −2(1/6)n)
72
99.4%
73
6
k=1(1/2)k(1/6) = 0.164
74
(a) 2 × 0.40 × 0.11 = 0.09 (b) 0.45(1 −0.45) + (0.40 + 0.11)(0.45 + 0.04)
+0.04(1 −0.04) = 0.54 (c) 1 −0.09 = 0.91 (d) 0.38 [same as 52(e)]
76
(1 × (1/56) + (1/3)(15/56 + 6/56) + (1/6)(34/56)) = 0.24
77
(1 × (1/8) + 3 × (1/2) + 6 × (1/4))/10 = 5/16
78
(10 × 1 + 3 ×
10
2

× 3 + 855 × 6)/10002 = 0.0055
79
4
k
 48
4−k
4
n
 48
k−n

/
52
4
52
k

, n ≤k = 0, 1, . . . , 4
80
(a) 1/2 (b) 1/(1 + 2p)
83
A
84
0.8 × 0.05/0.135 = 0.296
87
(a) 1/3 (b) 1/2
88
376/459 ≈0.82

538
APPENDIX B
89
(a) 0.902 = 0.81 (b) (9/11)(18/19) = 0.775
90
(a) 10/11 (b) 1/2
92
0.99 × 0.001/(0.99 × 0.001 + 0.01 × 0.999) = 0.09
93
1·0.002
1·0.002+0.05·0.998 ≈0.04
94
1/3·1/3
1/3·1/3+2/3·2/3 = 1
5
97
1/(1 + p)
98
(a) p2 + r(1 −p) (b) 1 −(1 −r)(1 −p) (c) (1 −p)p/((1 −p)(p + 1 −r))
99
2p/(1 + p)
100
(a) 1/2 (b) 2/3 (c) 2j/(2j + 2n−j)
101
(a) 2401/2500 = 0.96 (b) 1/2499 = 0.04
102
(a) 0 and 1 (b) 0 and 1/2
103
(a) 1/250, 000 (b) 1/30 (c) N = 4n2
104
(a) (1 −p)/(2 −p) (b) pA/(1 −pB + pApB)
105
pA(1 −pB)/(pA + pB −2pApB)
106
0.47, 0.45, 0.37, and 0.26, respectively.
107
(1 −p)/p
108
(a) P(TH before HH) = 3/4 (b) P(THHH before HHHH) = 15/16
109
244/495 ≈0.49
CHAPTER 2
1
(a) 1/3 (b) 2/3 (c) 0 (d) 2/3
2
(a) P(X = 1) = 1/4 (b) P(X = 2) = 1/2 (c) P(X = 2.5) = 0
(d) P(X ≤2.5) = 3/4
3
(a) p(k) = (13 −2k)/36, k = 1, . . . , 6
(b) p(0) = 6/36, p(k) = (12 −2k)/36, k = 1, . . . , 5
4
(a) c = 1/6 (c) 1/2 (d) 5/6
5
(a) c = 1/2 (b) 1/2 (c) 2/3
6
(a)
p(k) =
5
k

(1/13)k(12/13)5−k, k = 0, . . . , 5
(b)
4
k
 48
5−k

/
52
5

, k =
0, . . . , 4
7
p(−2) = p(2) = 1/4, p(0) = 1/2
8
(a) p(k) = (51/52)k−1(1/52), k = 1, 2, . . . (b) p(k) = 1/52, k = 1, 2, . . . , 52
9
If x = 1/n for some integer n, then FY(x) = (1/2)n−1, for other x ∈(0, 1],
FY(x) = (1/2)[1/x] ([ · ] denotes integer part)
12
No and no.
13
(a) c = 3 (b) F(x) = x3, P(X > 0.5) = 1 −0.53 = 0.875
(c) FY(x) = 6x5, 0 ≤x ≤1
14
(a) F(x) = (1 −x2)/2, −1 ≤x ≤0, F(x) = (1 + x2)/2, 0 ≤x ≤1
(b) not possible
(c) F(x) = x + 1, −1 ≤x ≤0 (d) F(x) = 1 −1/x, x ≥1

APPENDIX B
539
15
b = 1 −a/2, −2 ≤a ≤2
16
(a) a = 1/
√
2 (b) 1/18 (c) x =
√
2
17
(a) a = 1/100 (b) fW(x) = (43 −x)/400, 13 ≤x ≤33
18
(c) Same pdf as X
19
unif (0, 1)
20
(a) fY(x) = 1/x2, x > 1 (b) fY(x) = 2/x3, x > 1 (c) fY(x) = exp(x), x < 0
21
unif [0, 1]
22
fY(x) = 2x exp(−x2), x ≥0
23
No.
24
(a) 91/36 = 2.53 (b) 70/36 = 1.94
25
(a) 1.5 (b) 1
26
3/4
27
E[X] = 101 −100(1 −p)100 ≤100 if p ≤0.045
28
E[X] = −2
38, Var[X] = 398
38 −(−2
38)2 = 10.5
29
(a) $6.20 (b) −3
38 cents
30
7.9 cents
34
$85, $3.75
35
3/4
36
(a) −0.027, 0.9993 (b) −0.027, 34.08
37
E[A] = 55/6, Var[A] = 275/36, E[W] = 64/3, Var[W] = 275/9
38
(a) E[X] = 3/4, Var[X] = 3/80 (b) E[Y] = 6/7, Var[Y] = 3/196
40
E[Y] = ∞, E[Z] = 2, Var[Z] = ∞
41
E[V] = π/3, Var[V] = π2/7
42
E[V] = 2, Var[V] = 36
7
43
(a) E[X] = 2
3 Var[X] = 1
18 (b) 8π
15
44
(a) c = 1
2 (b) F(x) = 1−cos x
2
, 0 ≤x ≤π (c) π
2
45
(a) E[−X] = −μ, Var[−X] = σ2 (b) a = 1
σ , b = −μ
σ
46
(a) c = (b −a)/(
√
3(b + a)) (b) c →0
50
(a) Binomial with n = 10 and p = 0.8. (b) Not binomial as trials are not
independent (one rainy day makes another more likely). (c) Not binomial as p
changes between months. (d) Binomial with n = 10 and p = 0.2.
51
P(X > 0) = 1 −0.910 ≈0.65
52
(a) 0.1615 (b) 0.5155 (c) 0.9303
53
(a) E[X] = 1, E[Y] = 2 (b) P(X > E[X]) = 0.6651, P(Y > E[Y]) = 0.6187
54
(a)
n−1
k−1

(1/2)n−1 (b)
n−1
k

(1/2)n−1 (c)
n
k

(1/2)n/(1 −(1/2)n)
55
(a) 5 −5 (b) somebody wins 6 −4
(c) 0.7734 (P(X ≥3) where X ∼bin(7, 1/2))
(d) 1 −(1/2)5 = 0.9688 (e) (1/2)8 = 0.004

540
APPENDIX B
56
(a) 77/2048 (b) 37/64 (c) 0.596 [distribution is bin(6, 5/8)] (d) p ≈0.8
[distribution is bin(6, (1 + 3p)/4)] (e) (a): 1.5, 1.125 (b): 3.75, 0.5625 (c):
3.75, 1.4062
57
17
58
(b) P(Y ≤n) = P(X ≥1)
59
P(X = 0) = (15/16)n, E[X] = n/16
60
P(D > S) = 1/2, P(D = S) = 1/4, P(D < S) = 1/4
62
(a) (4/5)4(1/5) = 0.08 (b)
9
4

(1/5)5(4/5)5 = 0.01
63
(a) 1 −exp(−2) = 0.86 (b) pY(k) = exp(−2)2k/(k!(1 −exp(−2))),
E[Y] = 2/(1 −exp(−2)) = 2.3 (c) exp(2) −1 = 6.4
64
(a) 0.9 + 0.1 exp(−1) = 0.94 (b) 0.1 exp(−1)/(0.9 + 0.1 exp(−1)) = 0.04
(c) 1 −(0.9/(0.9 + 0.1 exp(−1)))10 = 0.33
66
(a) 0.0107 (exact) 0.0404 (Poisson) (b) 0.8741 (exact) 0.8698 (Poisson)
70
(a) 100 (b) 0.3935 (c) 0.3935 (d) exp(−1) = 0.37
71
No, memoryless property does not seem to hold.
73
(a) 0.70 (b) 0.30 (c) E[X] = 58/ log 2 = 83.7, Var[X] = 7002
76
1/4
77
(a) P(X ≤220) = ((220 −200)/10) = (2) = 0.98
(b) P(X ≤190) = ((190 −200)/10) = (−1) = 1 −(1) = 0.16
(c) P(X > 185) = (1.5) = 0.93
(d) P(X > 205) = 1 −(0.5) = 0.31
(e) P(190 ≤X ≤210) = (1) −(−1) = 0.68
(f) P(180 ≤X ≤210) = (1) −(−2) = 0.81
78
2(c) −1
79
66 and 74
80
Z = c
81
A 24-pound A-ﬁsh (the Z scores are 2 and 1, respectively).
82
180 points
83
2(1.16) −1 = 0.754
84
(a) T ∼N(t + 0.1, 0.01) (b) (−1) = 0.16 (c) (−0.5) −(−1.5) = 0.24
85
(a) ϕ(x), x ∈R (b) 2ϕ(x), x ≥0 (c) ϕ(√x)/√x, x ≥0 (d) ϕ(log x)/x, x > 0
87
(a) g(X) = X if X < 100, g(X) = X −100 if X ≥100.
(b) E[g(X)] = μ −100(1 −((100 −μ)/
√
2)) has minimum for μ = 103.7
88
√π/2
90
9.6 × 10−18
92
Xk is lognormal with parameters (kμ, k2σ2)
94
(a) 0.76 (b) 0.64 (c) 0.31 (d) 1
96
(a) 1/2 + arctan(x)/π, x ∈R
97
F(x) = 0.2 + 0.8x/30, 0 ≤x ≤30
98
(a) F(x) = 1 −(exp(−x) + exp(−2x))/2
(b) P(typeI|X ≥t) = 1/(1 + exp(−t))

APPENDIX B
541
99
(a) ∞, 2, 1 (b) 1.5, any number in [1, 2], any number in [0, 1] ∪[2, 3]
(c) 1/3, 1 −1/
√
2, 0 (d) 0, 0, and −1 or 1 (e) does not exist, 0, 0
101
(a) (i), (iii), (v)
103
(a) 2 (b) 1/
√
λ
105
(a) 3 (b) 9 (c) 1.8 (d) 3 + 1/λ
107
(b) r(k) = 1/(7 −k), k = 1, . . . , 6
109
(a) 2t/(1 −t2) (b) 1/t (c) 2t
110
(a) F(t) = 1 −1/(1 + t) (b) F(t) = 1 −exp(−t2) (c) F(t) = 1 −exp(t4/4)
(d) 1 −exp(exp(−t) −1)
111
c = log 0.4/ log 0.2 = 0.57
112
(a) a = 0.26 (b) 0.096
113
(a) 0.15 (b) f(t) = (1 −t) exp(−t + t2/2), 0 ≤t ≤1, f(t) = (t −1) exp(t −
t2/2 −1), t ≥1, m = 1.6
114
(a) 0.22 (b) 0.54 (c) 0.53 (d) 2 log 2 = 1.39 (e) 1.1 years
115
(a) r(t) = c, 0 ≤t ≤100, r(t) = c2k, 100 + 2k ≤t < 100 + 2(k + 1), k =
0, 1, 2, . . .
(b) c = log 2/162 = 0.043 (c) 0.35
CHAPTER 3
3
(a) 1 (b) 0 (c) 0
4
(a) true (b) false
6
(a) FX(x) = 1 −exp(−x), FY(y) = 1 −exp(−y) (b) FX(x) = x2, FY(y) =
√y
(c) FX(x) = 2x, FY(y) = y (d) FX(x) = (x2 + 2x)/3, FY(y) = (y + 2y2)/3
7
(a) pX(0) = 1/4, pX(1) = 1/2, pX(2) = 1/4, pY(0) = pY(1) = 1/2
(b) p(0, 0) = p(2, 1) = 1/3, p(1, 0) = p(1, 1) = 1/6
9
p(0, 3) = p(3, 0) = 1/8, p(1, 2) = p(2, 1) = 3/8
10
(a) p(j, k) = 1/36, j = 1, . . . , 6, k = j + 1, . . . , j + 6
(b) p(j, 2j) = 1/36, j = 1, . . . , 6,
p(j, k) = 1/18, j = 1, . . . , 6, k = 2j + 1, . . . , j + 6
11
(a) p(j, k) =
13
j
13
k

26
3−j−k

/
52
3

, 0 ≤j + k ≤3
(b) P(H = S) = p(0, 0) + p(1, 1) = 0.32
12
(a) p(0, 0) = 36/52, p(0, 1) = 3/52, p(1, 0) = 12/52, p(1, 1) = 1/52
(b) 40/52
13
(a) 1/4 (b) 3/32 (c) 25/64
15
(c), (d)
16
(a) c = 6 (b) 3/4 (c) 1/4 (d) fX(x) = 3x2, 0 ≤x ≤1, fY(y) = 3y2 −6y +
3, 0 ≤y ≤1
17
f(x, y) = x + y, fX(x) = x + 1/2, fY(y) = y + 1/2

542
APPENDIX B
19
unif [0, 1]
20
(a) c = 2/π (b) d2(2 −d2)
22
0.68
23
exp(−2) = 0.14
28
f(x) = 1/2, 0 ≤x ≤2
29
8x/3, 0.5 ≤x ≤1
31
(a) fY(y|x) = exp(x −y), y ≥x (b) fY(y|x) = x exp(−xy), y ≥0
(c) fY(y|x) = 1/y2, y ≥1 (d) fY(y|x) = 1/(2√y), 0 ≤y ≤1
32
(a) f(x, y) = x, 0 ≤y ≤1/x, 0 ≤x ≤1 (b) fY(y) = 1/2, 0 ≤y ≤1,
fY(y) = 1/(2y2), y ≥1 (c) 1/3
33
pY(k) = 1/(n + 1), k = 0, 1, . . . , n
34
(a) 450/1350 = 1/3 (b) 800/1350 = 0.59
35
(b) λ1/(λ1 + λ2)
36
(a) yes (b) no (c) yes (d) yes (e) yes
38
(π/6)1/3/2 = 0.40
39
1/2 + n/24 for n ≤4 and 1 −2/(3√n) for n ≥4
40
(a) 1/4 (b) 0.53 (c) 1/4
43
(a) F(x) = 1 −(1 −x)2, 0 ≤x ≤1 (b) F(x) = x/(2(1 −x)), 0 ≤x ≤1/2,
F(x) = 1 −(1 −x)/(2x), 1/2 ≤x ≤1
44
fW(x) = −log x, 0 < x ≤1
45
(a) 10/3 min (b) 85/6 min
46
7/12 Ml (E[max(X −Y, 0)])
47
4/9
48
(a) 1/4 (b) ∞(c) −2 (d) 1/3
49
(a) E[A] = a, Var[A] = σ2/2 + τ2/4
50
E ¯X] = μ, Var[X] = σ2/n
51
(a) n(μ2 + σ2) (b) n(nμ2 + σ2)
53
(c) (1 −2p)/√np(1 −p) and 3 + (1 −6p + 6p2)/(np(1 −p))
55
(a) n(1 −(1 −1/n)k)
58
(2N −n)(2N −n −1)/(4N −2) (let Ij be the indicator for the event that the
jth married couple remains and ﬁnd E[Ij])
61
(a) f(X,Z)(x, z) = xf(x, xz)
(b) f(X,Z)(x, z) = x exp(−x(1 + z)), fZ(z) = 1/(1 + z)2
62
f(U,V)(u, v) = u, 0 ≤uv ≤1, 0 ≤u(1 −v) ≤1
63
f(U,V)(u, v) = exp(−(u2 + v2)/4)/(4π) (note that U = X −Y and V = X +
Y are independent; this only holds for the normal distribution)
64
f(X,Y)(x, y) = 1/(2π

x2 + y2), x2 + y2 ≤1
65
f(W,I)(w, i) = 2/i, 0 ≤i ≤1, i2 ≤w ≤i (note the range), fI(i) = 2(1 −
i), 0 ≤i ≤1, fW(w) = −log w, 0 ≤w ≤1

APPENDIX B
543
66
f(U,V)(u, v) = v/2, 0 ≤u ≤2, u/2 ≤v ≤1 + u/2 (note the range)
67
f(U,V )(u, v) = exp(−(u2 + 3v2)/6)/(2π
√
3), u, v ∈R
69
(a) $360 (E[g(X)] where g(X) = X −0.8 if X ≥0.8 and g(X) = 0 otherwise)
(b) $600 (E[X|X > 0.8] −0.8)
70
(a) E[Y|X = k] = k + 3.5
(b) E[Y|X = k] = 52/11, 56/9, 54/7, 46/5, 32/3, 12
for k = 1, 2, . . . , 6
71
(a) E[Y|X = x] = x + 1 (b) E[Y|X = x] = 1/x (c) E[Y|X = x] = ∞
(d) E[Y|X = x] = 1/3
72
(a) 1/6 (b) 1/π (c) ∞(d) 1/2
73
(a) 1/2 (b) 2 (c) ∞
74
(a) ∞(b) n/2
78
2/((1 −p)2 + p2)
79
(2 −p)/(1 −p(1 −p))
81
10 and 20
83
2n+1 −2
84
(a) 36 (b) 258
85
1/36
86
1 [Var[Ij] = (n −1)/n2, Cov[Ij, Ik] = 1/(n2(n −1))]
87
−1/3
95
None are independent (a) correlated (b) uncorrelated (c) uncorrelated (d) un-
correlated
96
√6/7 = 0.93
97
E[X] + E[Y] = 0
98
E[Y|X] = X2/2, l(X) = 2X/3 −1/5
102
a,d,e,g
103
(a) E[C] = 30, E[C|X = x] = 5.2x + 4
(b) E[A] = 50.016, E[A|X = x] = 1.6x2 + 2x
(c) 0.08 (d) 0.02 (e) c ≤0.46
104
0.37
105
(a) 0.08 (b) 0.09 (c) n ≥3
107
U and V are independent with U ∼N(0, 2(1 −ρ)), V ∼N(0, 2(1 + ρ)).
108
(a) fZ(x) = ϕ((x −900)/√181/4)/√181/4
(b) fW(x) = (ϕ((x −1000)/10)/20 + ϕ((x −800)/9)/18
(c) E[Z] = 900, Var[Z] = 181/4 E[W] = 900, Var[W] = 10090.5
109
E[N] = e
110
E[N] = 1/(1 −F(c))
111
32.5 min
114
(a) fM(x) = (x −5)ϕ(x −7) + (x −7)ϕ(x −5) (b) (1)(−1) = 0.13

544
APPENDIX B
117
(a) 1/2 (b) 1/24 (c) 1/8 (d) 1/8
118
100 + 100 × 0.91/4 = 197.40
120
Hint: the lifetime is max(T1, T2) where T1, T2 are i.i.d. exp(2)
121
(exp(t) + 2)/(exp(t) + 1)
122
f(x, y) + f(y, x)
123
0.0001
125
0.38
126
fT (x) = 1 −exp(−x), 0 ≤x ≤1 and fT (x) = exp(−x)(e −1), x ≥1
128
fX+Y(x) = (x −2) exp(2 −x), x ≥2
131
fX+Y(x) = exp(−x)x2/2, x ≥0
134
(a) GX(s) = (s + s2 + · · · s6)/6 (b) GS(s) = GX(s)5
135
(a) ps/(1 −s + ps) (b) (ps/(1 −s + ps))r
137
P(Xk = 0) = 1 −μ/λ, P(Xk = 1) = μ/λ
138
$8.75
139
(a) 0.83 (b) 9 ms
140
(a) GY(s) = exp(s + s2 + s3 + s4 −4)
(b) exp(−4) = 0.02 (c) E[Y] = 10, Var[Y] = 30
142
(b) ≈$95
145
0 and 3
148
Not normal
149
(a) GX(s) = G(s, 1) (b) Cov[X, Y] = Gst(1, 1) −Gs(1, 1)Gt(1, 1)
150
(a) exp(−10/13) = 0.46 (b) exp(−5/13) = 0.68 (c) exp(−1) = 0.37
(d) ((10/13) exp(−10/13))3 = 0.045
151
(a) exp(−2/7) = 0.75 (b) 1 −exp(−8/10) = 0.55 (c) bin(52, exp(−2))
155
(a) exp(−5) × 52/2 = 0.08 (b) 2 exp(−2) × 3 exp(−3) = 0.04 (c) 9/25
(d)
4
2

(1/2)4 = 0.375
156
(a) no (b) 3 exp(−2) = 0.41 (c) P(even number of accidents) = 0.51
CHAPTER 4
3
 1
0 g(x)dx
4
2/3
9
(2) = 0.977
10
1 −(10/
√
200) = 0.24
11
78
12
Exact: 0.67, 1, 1, approximately: 0.50, 0.87, 0.99
13
P(X ≥80) = 1 −P(X ≤79) ≈0.72 (n = 100, p = 13/16)
14
0.44

APPENDIX B
545
15
254
16
(a) 1/2 and 1/2 (exact: 1/2)
(b) 1/4 and 1/3 (exact: 1/3) (c) 1/16 and 3/16 (exact: 1/5)
(d) 1.65 and 1.72 (exact: exp(1) −1 ≈1.72)
(e) 0.61 and 0.63 (exact: 1 −exp(−1) ≈0.63)
(f) 1 and 0.59 (exact: 2/π ≈0.64) (g) 0 and 0 (exact: 0)
17
≈216, 000 times
18
N(2/3, 4/27n)
24
λ = 1, α = 2
25
For example an = n1/3, Weibull with λ = 1, α = 3
CHAPTER 5
3
Let Sn = n
1 Xk, n = 1, 2, . . . and let Y = min{n : Sn > λ} −1.
6
F−1(u) = (b −a)u + a
7
X = U1/3
8
(a) X = tan(π(U −1/2))
9
X = (−log U/λ)1/α
10
X = 1 + [log U/ log p] ([ · ] denotes integer part)
17
X1 = μ1 + σ1X, Y1 = μ2 + ρσ2(X1 −μ1)/σ1 + σ2

1 −ρ2Y
18
X =
√
V sin(2πU), Y =
√
V cos(2πU)
CHAPTER 6
2
¯Y −¯X,
	
σ2
1/n + σ2
2/m
5
(a) 
N = kn/X, not unbiased (b) 
N = kX, unbiased
7

λ = X/t, √λ/t
8
I(λ)−1 = λ/t
12
P(X ≤5) ≤0.59 and 0.06, respectively
13

c = 0.11, no
14
(a) 
p = 0.0113 (b) 
x = 17.8
15

μ = 98.3, 
σ = 24.7
17
A −B = 4.7 ± 17.8
18
μ = ¯X ± 1.96/
√
5 = 1000.3 ± 0.88
19
p = 0.54 ± 0.03
20
≈0.25
21
(a) n ≥246 (b) n ≥385
22
p = 0.53 ± 0.06

546
APPENDIX B
24
pB −pG = 0.03 ± 0.01
25
μ = ¯X ± z σ
√n
(≈q)
26
σ =
s
1±z/
√
2n
(≈q)
28
pd −pp ≥−0.03
30
(c) 1086 ± 215
32

λ = n/T
33

p = X/n
34

b = X(n) (MLE) and 
b = 2 ¯X −a
35

a = X(1),
b = X(n) (MLE’s) and

a = ¯X −

3(
μ2 −¯X2),
b = ¯X +

3(
μ2 −¯X2)
36

θ = max(−X(1), X(n))
37

θ = X(1) (MLE) and 
θ = ¯X −1
38
(a) 
θ = ¯x/(1 −¯X) (b) 
θ = −n/ 
k log Xk (c) θ = 
θ(1 ± z/√n) (≈q)
39

θ = 
k X2
k/n (both)
40
(a) 
a = π/(2 ¯X2) (b) 
a = 2n/ 
k X2
k (c) a = 
a(1 ± z/√n) (≈q)
43
H0 : p = 1
2, HA : p /= 1
2, α = 0.0078, C = {0, 1, 7, 8}
44
H0 : λ = 5, HA : λ > 5, C = {4
k=1 Xk ≥26}, We can reject H0.
45
(a) Base the test on T = ( ¯X −μ0)/(σ/√n) ∼N(0, 1) (b) accept H0
47
(a) T = √n(1 −λ0 ¯X) (b) T = √n(1/(λ0 ¯X) −1) The second test is better.
48
H0 : p = 0.21 vs HA : p > 0.21, accept H0
49
H0 : pW = 2pT vs HA : pW > 2pT , accept H0
50
Assume independent Poisson variables. Test statistic
T = (X2 −X1)/√X1 + X2
d≈N(0, 1).
51
n
p + z2/2
n −z2
±

nz2
p(1 −
p) + z4/4
(n −z2)2
56
1 −0.95k
60
(a) n ≥210 (b) ((p −0.5)√n −1.64/2)/√p(1 −p) = q
63
Reject H0, beware of data-snooping!
64
Accept H0, χ2 = 4.06, lump together into ﬁve classes
65
Geometric: χ2 = 1.31, four classes. Poisson: χ2 = 10.48, four classes
68
Accept H0, χ2 = 0.26, DF=1
70
Reject H0, χ2 = 15.2, ﬁve classes
71
Reject H0, χ2 = 7.1
72
Reject H0, χ2 = 76.6, DF = 1
74
Reject H0, χ2 = 207, DF = 3
75
p-value = 0.14. Do not reject H0.
76
P(p = 1/3|D) = q/(4 −3q), E[p|D] = (8 −7q)/(12 −9q)

APPENDIX B
547
78
P(p|D) = 30p4(1 −p), mean = 5/7, mode = 4/5, MLE = 3/4
80
(a) f(θ|D) = 32θ(θ −1)/(99 · 2θ) θ = 2, . . . , 6 (b) 3.94 and 1.69
(c) 3 ≤θ ≤5
83
(a) 1/5 and 1/75 (b) 2/15 and 2/225
87
(a) Beta(α, β) (b) 0.2 and 0.072 (c) 0.175 and 0.070
88
Parametric: 101.2 ≤μ ≤116.4, nonparametric (sign test): 96 ≤m ≤116,
nonparametric (Wilcoxon test) 101 ≤m ≤116
89
Parametric: 22.3 ≤μ ≤283.6, nonparametric: 27.3 ≤μ ≤263.9
90
0.06 and 0.03, respectively, if N+ is either 0 or 5
91
Accept H0 : m = 100
92
Reject H0 : m = 1 on the 5% level
95
1/16
96
Reject H0 : μ = 100 in favor of HA : μ > 100 (W = 59, C = 66 −14 = 52)
97
Pairwise differences. Reject H0 : μ = 0 in favor of HA : μ /= 0 (W = 54, c =
9, C = 46)
98
W = 3, 4, . . . , 13, P(W = 7) = 1/5
99
Accept H0 : μA = μB (W = 46.5, c = 22, C = 48)
100
Accept H0 : D5,8 = 0.475 (c = 0.8)
101
Accept H0 (W = 43, c = 33, C = 69)
102
Accept H0 (W = 106, W
d≈N(90,
√
345))
CHAPTER 7
8
f(v) = √2/πσ3v2e−v2/(2σ2)
v ≥0
9
μ = 0.11 ± 0.05
11
0.034 ≤σ ≤0.104
12
15.2 ≤σ ≤23.6 (0.90), 14.7 ≤σ ≤24.8 (0.95)
13
Fχ2
n−1(nϵ2/(4t2))
14
2σ4/(n −1)
15
H0 : μ = 12 vs HA : μ /= 12, |T| = (12.1 −12)/(
√
0.96/10) = 1.02 < 1.96,
accept H0
16
H0 : μ = 100 vs HA : μ > 100, T = ( ¯X −100)/(s/
√
7) = 3.1 > 1.94, reject
H0
17
H0 : μ = 0 vs HA : μ /= 0, |T| = ¯X/(s/
√
5) = 1.0 < 2.78, accept H0
18
H0 : μ = 0.30 vs HA : μ > 0.30, reject H0
19
H0 : μ = 0 vs HA : μ > 0, accept H0
20
n ≥62
22
H0 : σ2 = 1 vs HA : σ2 > 1, reject H0

548
APPENDIX B
23
H0 : σ = 1 vs HA : σ > 1, accept H0
24
H0 : σ = 15 vs HA : σ /= 15, accept H0
25
Reject H0 (T = 1.875, t10 = 1.812)
26
d = −2.2 ± 16.3
27
73 ± 22 (95%)
28
Assume normally distributed samples. Test σ1 = σ2. Reject H0 on 5% level.
(F = 7.23, x1 = 0.14, x2 = 7.15)
29
2μ1 + 2μ2 = 489 ± 27
32
H0 : μ = 0 vs HA : μ > 0, accept H0
33
Each t test will be conditioned on the outcome of the ﬁrst test, which means
that the test statistic no longer is t distributed.
34
(a) Reject H0. (F = 20.85, F3,16 = 3.24) (b) ¯Xi1· −¯Xi2· ± 17.5. (c) Reject
H0. (K = 15.16 > 7.37)
41
a = 36 ± 12, b = 9.7 ± 3.4
42
Accept H0 : a = 0 (T = −0.48)
44
(a) 
b = (SxY −aSx)/Sxx (b) 
a = ¯Y −b¯x (c) 
a = 24.6, 
b = 11.3
45

a = 0.85, 0 ≤a ≤25.5,
b = 0.15, b = 0.15 ± 1.12 (consider log Y)
46
(a) y = −0.039x + 105, 57 s
47
Y = 133 ± 27
50
180 ≤σ ≤330
51
H0 : ρ = 0 vs HA : ρ /= 0, R = 0.25, accept H0
52
RS = 0.418, accept H0 (T = 1.30).
53
−0.45 ≤ρ ≤0.76 (≈0.95)
54
H0 : ρ = 0.9 vs HA : ρ > 0.9, L = 4.66, reject H0
57
β0 = 2.71 ± 0.70, β1 = 10.20 ± 0.78, β2 = 2.07 ± 0.16
60
SSA = 
i,j,k( ¯Xi·· −¯X)2, SSB = 
i,j,k( ¯X·j· −¯X)2, SSE = 
i,j,k(Xijk −
¯Xij·)2, SST = 
i,j,k(Xijk −¯X)2, and SSAB = 
i,j,k( ¯Xij· −¯Xi·· −¯X·j· +
¯X)2. (Derive them in this order.)
CHAPTER 8
1
(b) 0.88 (c) 0.81
2
pss = 7/8, prr = 1/2
3
1/71
4
(b) 4 (geom(0.2) including 0) (c) 1/πhigh = 5.8
9
(b) 0.59 (c) 43% vowels
10
(a) c(onsonant) (b) c (c) ccccc (d) cvcvc
11
(b) 10

APPENDIX B
549
12
(a) π = (1/10, 2/10, 4/15, 5/18, 7/45) (Note: p32 = 3/5, p34 = 2/5 and
p43 = 1)
(b) 1/10, 7/45 (c) 14/9
14
(a) 4 (b) 2 (c) π0 = π1 = π2 = π3 = 1/5, π4 = π5 = 1/10, no
15
(a) 2048 (b) 2
16
π0 = π1 = 1/3, πk = (1/3)(1/2)k−1, k ≥2
17
(a) qij = pjiπj/πi
19
p = 1/2
20
(a)
p0,1 = pN,N−1 = 1,
pk,k−1 = k/N, pk,k+1 = 1 −k/N, k = 1, 2, . . . ,
N −1
(b) bin(N, 1/2) (c) no
22
1/√1 + m/n
24
(a) πk = 1/(a + 1), k = 0, 1, . . . a (b) a + 1 (c) π0 = πa = 1/(2a),
πk = 1/a, k = 1, 2, . . . , a −1
25
P0(τ1 < ∞) = p/q if p < q and 1 otherwise. E0[τ1] = 1/(p −q) if p > q
and ∞otherwise
26
r/(p −q)
28
(c) exp(−1/2) = 0.61 in (a), 2 exp(−1)(1 −2/3) + exp(−1/2) −exp(−1) =
0.48 in (b), and 1/2 if S0 ≡1
30
(a) μ < 1 (b) Yn = 1 + Z1 + · · · Zn, E[Yn] = n + 1
if μ = 1 and (1 −μn+1)/(1 −μ) if μ /= 1
31
(a) 2n (b) 3/7 (c) 1/2
32
(b) Note that Zn = Z(0)
n + · · · Z(n)
n
where Z(j)
n
is the number of individuals
in the nth generation stemming from the Yj immigrants in generation j, j =
0, 1, . . . , n. Differentiation of the pgf gives E[Zn] = ν n
k=0 μk (c) Poi(λ(1 −
pn+1)/(1 −p))
34
For example, p00(t) = λ/(λ + μ)e−(λ+μ)t + μ/(λ + μ)
35
(c) 1/4 minute (d) 1/5
37
(b) uniform if b = 2a
40
(b) (10 + α)/(40 + α) (c) 1.5
41
π0 = 1/(1 −log(2/3)), πn = π0/(n3n)
43
(a) 17% (b) 1.6%
44
(a) 50% (b) 33% (c) 33% (d) 20%
45
(a) π0 = 4/10, π1 = 2/10, π2 = 3/10, π3 = 1/10
(b) π0 = 16/43, π1 = 8/43, π2 = 12/43, π3 = 7/43
46
(b) π0 = π1 = 4/19, π2 = 6/19, π3 = 5/19
47
(a) π0 = 0.03, π1 = 0.19, π2 = 0.78
(b) π2 + π1((2/3) × 0.2 + (1/3) × 0.5) = 0.84
48
Poi(λ/μ)
49
λn ≡λ, μn = μ + (n −1)ν, n ≥1

550
APPENDIX B
50
P(W ≤x) = 1 −ρ exp(−x(μ −λ)), x ≥0 (P(W = 0) = 1 −ρ) and condi-
tioned on k ≥1 customers in the system, W ∼(k, μ))
51
T ∼exp(μ(1 −ρ))
52
Yn = Pn/μn
53
Yn = 2nXn
55
Y ∼unif[0, 1]
57
m(t) = et −1,
t ≤1
58
(a) Once in 190 h (b) 0.79
59
(a) λ/(1 + λμS) (b) 1/(1 + λμS)
60
0.918
61
(a) F(t) = 1 −e−λt
(b) F(t) = t(2 −t) 0 ≤t ≤1 (c) F(t) = 1 −e−λt(1 + λt/2)
62
(a) min(s, t) (b) t(1 −s) if t ≤s and s(1 −t) if t ≥s
63
N(0, t + s + 2 min(t, s))
64
min(t, s)
66
E[Mt] = √2t/π, Var[Mt] = t(t −2/π)
67
N
 t2 −t
t2 −t1
x1 + t −t1
t2 −t1
x2, (t2 −t)(t −t1)
t2 −t1

68
(a) N(c + μ(t −s), σ2(t −s)) (b) N(ct/s, σ2t(s −t)/s)
69
0.362
70
f(r) = r
t e−r2/(2t)
r ≥0

FURTHER READING
1. F. Mosteller, Fifty Challenging Problems in Probability with Solutions, Addison-Wesley,
Reading, MA London, 1965 [the classic, and charmingly dated (mentions logarithm
tables!), collection of probability problems].
2. G. Blom, L. Holst, and D. Sandell, Problems and Snapshots from the World of Probabil-
ity, Springer-Verlag, New York, 1994 (the modern, comprehensive, and mathematically
stringent successor of Mosteller. A wealth of interesting problems).
3. J. Haigh, Taking Chances: Winning with Probability, Oxford University Press, 2003
(an entertaining nontechnical book on the probability considerations of everything from
roulette to “Who wants to be a millionaire?”).
4. J. A. Paulos, Innumeracy: Mathematical Illiteracy and Its Consequences, Hill & Wang,
2001 (the bestseller that debunks myths and discusses misunderstandings of mathematics,
probability, and statistics in everyday life).
5. D. Kahneman, P. Slovic, and A. Tversky, Judgment under Uncertainty: Heuristics and
Biases, Cambridge University Press, 1982 (extensive treatment of the psychology of
probability considerations in decision making).
6. R. Meester, A Natural Introduction to Probability Theory, Birkh¨auser Basel, 2003 (a
clear and focused introduction to probability, with an aim to prepare the reader for more
advanced theory).
7. G. Grimmett and D. Stirzaker, Probability and Random Processes, 3rd edition, Oxford
University Press, New York, 2001 (a comprehensive introduction to intermediate proba-
bility theory, Markov chains, and other stochastic processes).
Probability, Statistics, and Stochastic Processes, Second Edition. Peter Olofsson and Mikael Andersson.
© 2012 John Wiley & Sons, Inc. Published 2012 by John Wiley & Sons, Inc.
551

552
FURTHER READING
8. O. H¨aggstr¨om, Finite Markov Chains and Algorithmic Applications, Cambridge Univer-
sity Press, 2002 (an excellent introduction to the theory of Markov chains with ﬁnite state
space, and their use in computer simulation).
9. J. Stoyanov, Counterexamples in Probability, 2nd edition, Wiley, Chichester, UK, 1997
(the book that somebody just had to write, with all those results that ought to be true but
are not; fast-paced on a mostly advanced level).
10. D. Freedman, R. Pisani, and R. Purves, Statistics, 3rd edition, Norton, New York, 1998
(it is hard to believe that a book with this title can be highly entertaining, but it is; the text
is clear and exact without being technical, and contains plenty of interesting real-world
examples).

INDEX
Absorbing state, 464
Alternative hypothesis, 338
one-sided versus two-sided,
338
Analysis of variance, 419
as GLM, 445
conﬁdence intervals, 424
for regression models, 436
multiple comparisons, 423
one-way, 420
two-way, 447
unbalanced, 451
ANOVA, 419
ANOVA table, 421
Aperiodic state, 474
Backward equations, 491
Backwards martingale, 513
Balking, 502
Ballot theorem, 513
Base rate, 51
Bayes estimator, 363
Bayes’ formula, 49
in island problem, 53
in Monty Hall problem, 51–52
Bayesian statistics, 361
Beta distribution, 365
conjugate to binomial, 367
Between-group variance, 421
Bienaym´e, I. J., 482
Binomial distribution, 116
approximation by normal, 279
approximation by Poisson, 125
approximation of hypergeometric,
285
Birthday problem, 21–22, 71–72
Birth–death process, 497
linear, 498
Bivariate normal distribution, 216
Bonferroni correction, 348
Bonferroni-Holm correction, 349
Bootstrap simulation, 334
Borel set, 89
Box–Muller method, 298
Branching processes, 481
as martingale, 507, 510
convergence of, 510
Brownian bridge, 530
Brownian motion, 524
geometric, 529
maximum of, 527
standard, 525
two-dimensional, 539
with drift, 528
Buffon, Count de, 178
Buffon’s needle, 177, 275, 280
C, 459
Cauchy distribution, 140
Cavendish, Henry, 378
Probability, Statistics, and Stochastic Processes, Second Edition. Peter Olofsson and Mikael Andersson.
© 2012 John Wiley & Sons, Inc. Published 2012 by John Wiley & Sons, Inc.
553

554
INDEX
Central limit theorem, 276
for renewal process, 519
Chapman–Kolmogorov equations,
489
Chebyshev’s inequality, 112
one-sided, 154
Chi-square distribution, 402
Chuck-a-luck, 153
Coefﬁcient of determination,
436
Coefﬁcient of variation, 154,
389
Communicating states, 462
Conditional distributions, 169
Conditional expectation, 191
in prediction, 197
Conditional pdf
given an event, 170
jointly continuous case, 171
Conditional probability, 29
as information, 70
Conditional variance, 198
Conﬁdence interval, 314
for difference between means (equal
variances), 414
for ratio of variances, 418
for the mean, 317, 410
for the variance, 408
for unknown probability, 318
nonparametric, 386
one-sided, 321
Conﬁdence level, 314
simultaneous, 391
Conjugate distribution, 367
Consistent estimator, 306
Continuous-time Markov chain,
488
irreducible, 495
jump chain of, 488
limit distribution of, 493
null recurrent, 495
positive recurrent, 495
recurrent, 495
transient, 495
Convergence
almost surely, 273, 488, 508
in distribution, 283, 285
in probability, 272
Convolution, 235
Correlation coefﬁcient, 208
Correspondence theorem, 341
Coupon collecting problem, 186
Covariance, 203
Cram´er-Rao lower bound, 309
Craps, 77
Credibility interval, 372
Critical
region, 338
value, 338
Data snooping, 345
Delayed renewal process, 521
Delta method, 282
De Moivre–Laplace theorem, 279
De Morgan’s Laws, 6
Design matrix, 444
Disjoint events, 8
Distribution function, 84
Distribution function
empirical, 334, 380, 384, 530
Distribution function
properties, 87
Distributive Laws, 6
Donsker’s theorem, 531
Efﬁciency, 309
Ehrenfest model, 533
Elementary renewal theorem, 518
Empirical distribution function, 334, 380,
384, 530
Estimate, 304
Estimator, 304
asymptotically unbiased, 390
bias of, 390
consistent, 306
more efﬁcient, 307
of mean, 304
of variance, 311
unbiased, 305
Eugene Onegin, 532
Euler’s constant, 227
Event, 5
decreasing sequence, 15
increasing sequence, 15
independent events, 35
independent vs. disjoint events, 37
pairwise disjoint events, 8
Expectation, 100

INDEX
555
Expected value, 100
of a function, 106, 181
of a sum, 182, 185
Exponential distribution, 128
in Poisson process, 248
memoryless property of, 130
Exponential family, 367
Extreme values, 285
Failure rate, 131, 145, 231
constant, 131
increasing, decreasing, bathtub-shaped,
146
False-negative rate, 51
False-positive rate, 51
F distribution, 403
Fisher information, 309, 331, 341, 371
Fisher’s exact test, 359
Forward equations, 491
Frequentist statistics, 362
Galton, Sir Francis, 221, 482
Gambler’s ruin, 61–63, 76
Gambler’s ruin, 512
Gamma distribution, 139
in Poisson process, 251
relation to exponential, 238
Gauss, Carl Friedrich, 132
Gaussian distribution, 132
General linear model, 443
Generator, 490
Genetics, 56, 76
Geometric Brownian motion, 529
Geometric distribution, 120
Goodness of ﬁt, 349
for regression models, 435
test for independence, 356
Histogram, 81, 93
Hitting time, 525
Hubble, Edwin, 215, 428
Hypergeometric distribution, 125
approximation by binomial, 285
Hypothesis test, 336
for correlation coefﬁcient, 440
for difference in means (equal variances),
415
for ratio of variances, 419
for the mean, 411
for the variance, 409
for unknown probability, 342
large sample, 341
multiple, 348
I.i.d. random variables, 224
Inclusion–exclusion formula, 14
Independent events, 35
and conditional probability, 36
and disjoint events, 37
conditionally independent, 72
inﬁnite sequence of, 40
pairwise independent, 39
three events, 40
Independent random variables, 174, 187
Indicators, 116, 188
Inter-arrival times, 248, 515
Inverse transformation method, 293
Irreducible Markov chain, 462
Island problem, 53, 153
Jeffrey’s prior, 371
Joint
distribution function, 162
mgf, 268
pdf, 166
pgf, 268
pmf, 163
Kolmogorov-Smirnov test, 379, 384
one-sample, 379
two-sample, 384
Kronecker’s lemma, 509
Kruskal-Wallis test, 424
Kurtosis, 159, 260
Laplace, Pierre-Simon, 1, 364
Laplace’s rule of succession, 364
Law of large numbers, 272, 509
for renewal process, 517
Law of total expectation, 191–193
Law of total probability, 43, 172–173
Law of total variance, 198
Likelihood function, 326
Limit distribution
for continuous-time Markov chain, 493
for discrete-time Markov chain, 461,
472
Linear birth–death process, 498

556
INDEX
Linear regression, 426
as GLM, 444
estimation of slope and intercept, 427
estimation of variance, 430
multiple, 444
prediction interval, 434
residuals, 435
Little’s formula, 506
Location parameter, 108, 142
Log-likelihood function, 326
Lognormal distribution, 137
Luckenbach, Texas, 319
Marginal, 163
Margin of error, 318
Markov, A. A., 532
Markov chain, 456
aperiodic, 474
continuous-time, 488
ergodic, 475
ﬁnite state space, 463
irreducible, 462
limit distribution of, 472
Monte Carlo (MCMC), 367
null recurrent, 471
periodic, 473
positive recurrent, 471
recurrent, 463
stationary distribution of, 466
transient, 463
Markov property, 456
for continuous-time Markov chain, 489
Markov’s inequality, 154
Martingale, 507
backwards, 513
Martingale convergence, 508
Matching problem, 27, 70
Maximum likelihood estimator (MLE),
326
approximate conﬁdence interval, 331
asymptotically efﬁcient, 331
asymptotically normal, 331
asymptotically unbiased, 331
consistent, 331
in linear regression, 427
Maximum likelihood method, 324
Maxwell-Boltzmann distribution, 448
Mean, 100
Mean recurrence time, 476
Median, 92, 131, 142
Mendel, Gregor, 352
Method of moments, 321
Mixed distribution, 141
Mode, 144
Moment estimator, 323
Moment generating function (mgf), 244
Moment of a random variable, 247, 322
Monty Hall problem, 51–52
Multidimensional random vectors, 223
Multinomial distribution, 232
Multiple linear regression, 444
Multivariate normal distribution, 233
Negative binomial distribution, 155
Noninformative prior, 370
Nonparametric methods, 373
Normal distribution, 132
approximation of binomial, 279
bivariate, 216
in central limit theorem, 276
linearity of, 221
standard, 133
Null hypothesis, 338
Null recurrent state, 471, 495
Occupancy problem, 186
Oil rigs, 382
Old Faithful geyser, 265, 432
One-sample t test, 411
One-way analysis of variance, 420
Opinion polls, 318
Optional stopping theorem, 511
Order statistics, 225
Outcome, 3
Pearson, Karl, 438
Penney-ante, 65, 77, 201
Percentile, 136, 389
Period, 474
Periodic state, 474
Poisson distribution, 122
approximation of binomial, 125
in Poisson process, 250
Poisson process, 131, 248, 515
superposition, 255
thinning, 252
Poisson, Sim´eon, 123
Poker, 24, 69

INDEX
557
Polya’s urn model, 538
Pooled sample variance, 413
Positive recurrent state, 471, 495
Posterior distribution, 362
Power function, 347
Prediction interval, 392, 434
Predictor, 197, 391
best linear, 212
in linear regression, 434
Prior distribution, 362
conjugate, 367
Jeffrey’s, 371
noninformative, 370
vague, 370
Probability
as continuous set function, 15
axioms, 8
classical deﬁnition, 17
Probability density function (pdf), 88
interpretation, 92
relation to cdf, 89
Probability generating function (pgf), 238
Probability mass function (pmf), 81
relation to cdf, 86
Probability
measure, 8
objective and subjective, 1
Product moment correlation coefﬁcient,
438
Punnett square, 57
Pushkin, Alexander, 532
P-value, 344
Quantile function, 295
Queueing system, 501
ﬁnite waiting room, 502
M/M/1, 501
multi-server, 503
performance measures, 504
with balking, 502
with reneging, 537
Random experiment, 3
Random number generator, 290
Random sample, 304
Random variable, 79
continuous, 86
discrete, 81
mixed, 142
Random vector, 162
discrete, 163
jointly continuous, 166
Recurrent state, 463, 495
Recursive methods, 58, 199
Regression line, 426
Rejection method, 296
Relative frequency, 1, 273, 317
Reliability, 42, 72, 230
Renewal, 515
Renewal equation, 516
Renewal function, 515
Renewal process, 225, 515
delayed, 521
Renewal rate, 518
Renewal theorem, 518
Residuals, 435
Reversible Markov chain, 533
Roulette, 76, 100, 107, 110, 153
Sample correlation coefﬁcient, 438
Sample mean, 259, 263, 271, 304
Sample moment, 322
Sample space, 3
countably inﬁnite, 4
ﬁnite, 4, 16
uncountable, 4
Sample variance, 311
Sampling distribution, 402
Sensitivity, 51
Signiﬁcance level, 338
multiple, 348
Sign test, 374
Simple random walk, 477, 527
as martingale, 507
in three dimensions, 480
symmetric, 477
Simpson’s paradox, 47
Simulation, 289
bootstrap, 334
Box–Muller method, 298
evaluation of estimators with, 332
of discrete random variables, 292
with inverse transformation method, 293
with rejection method, 296
Size-biased distribution, 120, 153
Skewness, 159, 260
Spearman’s correlation coefﬁcient, 442
Speciﬁcity, 51

558
INDEX
Standard Brownian motion, 525
Standard deviation, 109
Standard error, 310
Stationary distribution, 466
for continuous-time Markov chain, 493
Statistic, 338
Statistical inference, 303
Stochastic semigroup, 489
Stopping time, 511
St Petersburg paradox, 107
Strong law of large numbers, 509
Studentized range distribution, 423
Submartingale, 512
Success runs, 475, 495, 533
Sum of squares, 421
Supermartingale, 512
Survey sampling, 319
Survival analysis, 147
Survival function, 148
Symmetric distribution, 159
T distribution, 404
Test statistic, 338
Texas lottery, 23, 26, 41, 122, 345, 395
Transient state, 463, 495
Transition
matrix, 458
probabilities, 456
rate, 490
Translation model, 382
Tree diagrams, 46
Triangular distribution, 237
t test
one-sample, 411
two-sample, 415
Welch’s, 417
Tukey’s method, 423
Two-sample t test, 415
Two-way analysis of variance, 447
Type I and type II errors, 346
Unbiased estimator, 305
Uniform distribution, 17, 82, 94–95
Variance, 109
of a sum, 183, 187, 204, 206
Venn diagram, 6, 12–13, 67
Waiting time paradox, 224
Watson, Henry W., 482
Weibull distribution, 150
Welch’s t test, 417
Wiener process, 524
Wilcoxon
rank sum test, 382
signed rank test, 377
Within-group variance, 420
Z score, 134

