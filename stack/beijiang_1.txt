Bayesian Joint Modeling of Longitudinal
Trajectories and Health Outcome: A Broad
Evaluation of Mean and Variation Features in Risk
Proﬁles and Model Assessments
by
Bei Jiang
A dissertation submitted in partial fulﬁllment
of the requirements for the degree of
Doctor of Philosophy
(Biostatistics)
in The University of Michigan
2014
Doctoral Committee:
Professor Michael R. Elliott, Co-Chair
Professor Naisyin Wang, Co-Chair
Professor Siobán D. Harlow
Professor Timothy D. Johnson
Assistant Professor Lu Wang

©
Bei Jiang
2014
All Rights Reserved

ACKNOWLEDGEMENTS
I am deeply indebted to my co-chairs, Drs. Naisyin Wang and Michael Elliott for
their patience, guidance and support in countless ways. They inspire me to think crit-
ically, guide my academic development and provide me valuable feedback throughout
the entire process of my dissertation research. Most importantly, their passionate
commitment to research and overwhelming enthusiasm in statistics have greatly
impacted me. It has been a great honor and privilege to work with them.
I would like to thank my dissertation committee members, Dr. Siobán Harlow,
Dr. Timothy Johnson and Dr. Lu Wang for their insightful comments that have
greatly improved this dissertation. Particularly, I am very grateful to Dr. Harlow
for sharing her expertise in women reproductive aging, Dr. Johnson for teaching me
Bayesian statistics and offering me the opportunity to be exposed to brain imaging
research, and Dr. Wang for helpful suggestions on my professional development and
friendship.
I also wish to express my thanks to Dr.
Mary Sammel at the University of
Pennsylvania for providing us the interesting data used in this dissertation, always
promptly and patiently answering our questions about the data, discussing the di-
rections of the modeling approaches and pointing out crucial features in the data.
Finally, thanks to my family. I am forever indebted to them for their endless love
and consistent support throughout my life.
ii

TABLE OF CONTENTS
ACKNOWLEDGEMENTS
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
ii
LIST OF FIGURES . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
v
LIST OF TABLES
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . viii
LIST OF APPENDICES
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
xi
ABSTRACT . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
xii
CHAPTER
I. Introduction
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
1
II. Joint Modeling of Cross-Sectional Health Outcomes and Lon-
gitudinal Predictors via Mixtures of Means and Variances
. . .
7
2.1
Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
7
2.2
Joint models and corresponding approaches . . . . . . . . . . . .
10
2.2.1
Likelihood speciﬁcation . . . . . . . . . . . . . . . . . . .
11
2.2.2
Prior speciﬁcation and posterior computation
. . . . .
11
2.2.3
The choice of the number of classes . . . . . . . . . . . .
13
2.2.4
Goodness of ﬁt evaluation
. . . . . . . . . . . . . . . . .
14
2.3
Simulations
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
15
2.4
Analysis of Penn Ovarian Aging Study data . . . . . . . . . . . .
21
2.4.1
Model Fit and Model Checking
. . . . . . . . . . . . . .
24
2.4.2
Summary . . . . . . . . . . . . . . . . . . . . . . . . . . .
25
2.5
Concluding Remarks . . . . . . . . . . . . . . . . . . . . . . . . . .
26
III. Modeling Short- and Long-Term Characteristics of Follicle Stim-
ulating Hormone as Predictors of Severe Hot Flashes in Penn
Ovarian Aging Study . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
45
3.1
Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
45
iii

3.2
The proposed model
. . . . . . . . . . . . . . . . . . . . . . . . . .
49
3.2.1
Likelihood speciﬁcation . . . . . . . . . . . . . . . . . . .
54
3.2.2
Data augmentation step to impute missing data . . . .
54
3.2.3
Prior speciﬁcation . . . . . . . . . . . . . . . . . . . . . .
55
3.2.4
Posterior computation . . . . . . . . . . . . . . . . . . . .
56
3.2.5
The choice of the number of classes and number of
knots in penalized splines . . . . . . . . . . . . . . . . .
57
3.2.6
Goodness of ﬁt evaluation
. . . . . . . . . . . . . . . . .
58
3.3
Predicting severity of hot ﬂash from longitudinal follicle stimu-
lating hormone data
. . . . . . . . . . . . . . . . . . . . . . . . . .
60
3.4
Conclusions and Discussion . . . . . . . . . . . . . . . . . . . . . .
66
IV. Bayesian Model Assessments in Evaluating Mixtures of Longi-
tudinal Trajectories and Their Associations with Cross-Sectional
Health Outcomes
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
77
4.1
Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
77
4.2
Joint LC and MSRE models . . . . . . . . . . . . . . . . . . . . . .
81
4.2.1
Likelihood speciﬁcation . . . . . . . . . . . . . . . . . . .
82
4.2.2
Prior speciﬁcation and posterior computation
. . . . .
83
4.3
Model selection and assessment criteria . . . . . . . . . . . . . .
84
4.3.1
Model selection criteria . . . . . . . . . . . . . . . . . . .
84
4.3.2
Overall model performance measure . . . . . . . . . . .
87
4.4
Simulation Study . . . . . . . . . . . . . . . . . . . . . . . . . . . .
88
4.4.1
Simulation Setup
. . . . . . . . . . . . . . . . . . . . . .
88
4.4.2
Simulation Results
. . . . . . . . . . . . . . . . . . . . .
91
4.5
Validation of the models selected by different criteria . . . . . .
94
4.6
Penn ovarian aging study revisited
. . . . . . . . . . . . . . . . .
98
4.7
Discussion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 100
V. Discussion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 111
5.1
FSH patterns in relation to Final Menstrual Period (FMP) . . . 112
5.2
Future work . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 115
APPENDICES . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 121
BIBLIOGRAPHY . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 154
iv

LIST OF FIGURES
Figure
2.1
Simulation setup for the mean proﬁles and variance classes: left col-
umn: 95% contour plots of the two components for mean proﬁle class;
right column: density plots of the two components for variance class
(dotted curves are the density curves for the variances).
. . . . . . . .
29
2.2
Two typical ROC’s when the truth is joint MSRE model: (a) and (b)
are from the data set where “artiﬁcial mean clusters” are created by
joint LC model; (c) and (d) are from the data set when an almost
empty mean cluster is created by joint LC model. Note: “assumed”
refers to the ML estimates of LC probit submodel given known class
memberships. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
30
2.3
(a) Estimated population longitudinal trend by lowess; (b) histogram
of detrended log(FSH).
. . . . . . . . . . . . . . . . . . . . . . . . . . . .
31
2.4
Posterior pointwise 95% credible intervals for the mean proﬁle classes
and the histograms of log-variances with KD = 1,KC = 2: (a) and (c):
under joint MSRE model and (b) and (d): under joint LC model.
. . .
32
2.5
Posterior average of the receiver operating characteristic (ROC) curves
under joint MSRE model (average AUC=0.685 with 95% CI (0.632,
0.736)) and joint LC model (average AUC=0.648 with 95% CI (0.590,
0.699)) both with KD1,KC = 2 in the analysis of Penn ovarian aging
data.
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
33
2.6
Posterior predictive p values under joint LC and MSRE models with
KD = 1,KC = 2.
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
34
v

2.7
The individual ﬁts in the analysis of Penn ovarian aging data with
solid line: under joint MSRE model and dashed line: under joint LC
model; top row: 3 randomly selected individual ﬁts with PPD p values
between 0.1 or great than 0.9 and bottom row: individuals with PPD
p values less than 0.1 or great than 0.9. . . . . . . . . . . . . . . . . . .
35
2.8
Scatter plot of detrended log(FSH) versus age with red points not be-
ing covered by subject-speciﬁc 95% posterior predictive intervals with
KD = 1,KC = 2 in models for the analysis of Penn ovarian aging data:
left: joint MSRE models and right: joint LC models.
. . . . . . . . . .
36
3.1
Upper bounds of p values based on PDMs for individual trajectories ﬁt
by our best ﬁtting models with µi(t) i = 1,...,n within the time window
T = [45,55] as a functional predictor in primary outcome submodel. .
70
3.2
Selected individual trajectories ﬁtted by our best-ﬁtting joint models
with µi(t) i = 1,...,n within the time window T = [45,55] as a func-
tional predictor in primary outcome submodel: ﬁrst row: ﬁtted tra-
jectories by all three models have upper bounds of p values less than
0.05; second row: ﬁtted normal trajectories have upper bounds of p
value less than 0.05 but ﬁtted t (df=4) and t (df=7) trajectories have
upper bounds of p value greater than 0.05; third row: ﬁtted normal
and t (df=7) trajectories have upper bounds of p value less than 0.05
but ﬁtted t (df=4) trajectories have upper bounds of p value greater
than 0.05; forth row: ﬁtted trajectories by all three models have upper
bounds of p values greater than 0.05.
. . . . . . . . . . . . . . . . . . .
71
3.3
longitudinal proﬁles from our ﬁnal models with Jµ = 1 and KD =
KC = 2 in longitudinal submodel; µi(t) as functional predictor with
time window T = [45,55] and Jθ0 = 3 in primary outcome submodel
with different assumptions for longitudinal submodel: a) and b) under
normal assumption; c) and d) under t assumption with df=7; e) and f)
under t distribution with df=4.
. . . . . . . . . . . . . . . . . . . . . . .
72
3.4
Functional coefﬁcient function θ0(t) from our best ﬁtting t (df=4),
t(df=7) and normal models with µi(t), i = 1,...,n within the time win-
dow T = [45,55] as a functional predictor in primary outcome sub-
model.
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
73
3.5
Functional coefﬁcient functions θ0(t) and θ1(t) from our best-
ﬁtting model with Jµ = 1 and KD = KC = 2 in longitudinal submodel
with t (df=4) assumption; and Jθ0 = Jθ1 = 3 in primary outcome sub-
model: a) µ′
i(t) as functional predictor with T = [45,55] and b) µ′
i(t) as
functional predictor with ˜T = [50,55].
. . . . . . . . . . . . . . . . . . .
73
vi

3.6
ROC curves from our ﬁnal t model: AUC0 is obtained by using µi(t)
with Jθ0(t) = 3 within the time window T = [45,55] as a functional
predictor in outcome submodel and AUC1 is obtained by using µ′
i(t)
with Jθ1(t) = 3 within the time window T = [45,55] as a functional
predictor with in outcome submodel. . . . . . . . . . . . . . . . . . . . .
74
3.7
Individual trajectories that are assigned to the minor and major mean
proﬁle classes by our best ﬁtting t (df=4) model with µi(t) i = 1,...,n
within the time window T = [45,55] as a functional predictor in pri-
mary outcome submodel. . . . . . . . . . . . . . . . . . . . . . . . . . . .
75
4.1
Simulation setup for the mean and variance proﬁles representing low
versus high levels of separation. Left panels: 95% contour plots of the
two components for the mean proﬁles; right panels: density plots of
the two components for the variance proﬁles. . . . . . . . . . . . . . . . 102
5.1
Estimated population longitudinal trend by lowess: (a) in relation
to years before and after the Final Menstrual Period (FMP) and (b)
according to chronological age.
. . . . . . . . . . . . . . . . . . . . . . . 117
5.2
longitudinal proﬁles: (a) and (b) in relation to years before and af-
ter the Final Menstrual Period (FMP); (c) and (d) according to chrono-
logical age.
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 118
5.3
Individual FSH trajectories that are assigned to the minor and major
mean proﬁle classes when ﬁtting the models using (a) years before
and after the Final Menstrual Period (FMP) and (b) chronological
age, respectively.
The curves of the same colors in (a) and (b) be-
long to the same women. The black points in (b) indicate the ﬁtted
FSH values at the ages of FMP. The red trajectories are the predicted
FSH for women who were in the minor mean classiﬁcation according
to chronological age but in the major mean classiﬁcation in relation
to time to FMP, while the green trajectories are the predicted FSH
for women who were in the major mean classiﬁcation according to
chronological age but in the minor mean classiﬁcation in relation to
time to the FMP. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 119
5.4
Functional coefﬁcient function θ1(t) when µ′
i(t) is functional pre-
dictor with when (a) in relation to years before and after the Final
Menstrual Period (FMP) and time window is [−7,3], and (b) accord-
ing to chronological age and time wondow is [45,55].
. . . . . . . . . . 120
vii

LIST OF TABLES
Table
2.1
Simulation results from 100 datasets of size, n = 200. . . . . . . . . . .
37
2.2
(a) Mean Area under the ROC curves for the prediction of outcome
and (b) misclassiﬁcation rates for mixture membership. Left columns:
data generated from the LC model; right columns: data generated
from the MSRE model. LC-Assumed refers to AUC results obtained
ﬁtting a probit model using the known latent classes as predictors
when the data are generated under the MSRE model, and similarly
MSRE-Assumed refers to AUC results obtained ﬁtting a probit model
using the known random effects and variances as predictors when
the data are generated under the LC model. “Percentile” refers to the
2.5 and 97.5 percentils of the AUC computed under the true parame-
ters across the simulations; “95% CI” refers to mean of the lower and
upper 95% credible intervals across simulations. . . . . . . . . . . . . .
38
2.3
Model comparison statistics from different joint models for the anal-
ysis of Penn ovarian aging data. . . . . . . . . . . . . . . . . . . . . . . .
39
2.4
Posterior estimates of the model parameters under joint MSRE and
LC models with KD = 1,2 and KC = 1,2 for the analysis of Penn ovar-
ian aging data.
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
40
2.5
Simulation results from 100 datasets of size, n = 200, generated from
longitudinal scenario # 1 and the primary probit (a) LC, (b) MSRE
models. Left columns: ﬁtted assuming the LC model; right column:
ﬁtted assuming the MSRE model. . . . . . . . . . . . . . . . . . . . . . .
41
2.6
Simulation results from 100 datasets of size, n = 200, generated from
longitudinal scenario # 2 and the primary probit (a) LC, (b) MSRE
models. Left columns: ﬁtted assuming the LC model; right column:
ﬁtted assuming the MSRE model. . . . . . . . . . . . . . . . . . . . . . .
42
viii

2.7
Simulation results from 100 datasets of size, n = 200, generated from
longitudinal scenario # 3 and the primary probit (a) LC, (b) MSRE
models. Left columns: ﬁtted assuming the LC model; right column:
ﬁtted assuming the MSRE model. . . . . . . . . . . . . . . . . . . . . . .
43
2.8
Simulation results from 100 datasets of size, n = 200, generated from
longitudinal scenario # 4 and the primary probit (a) LC, (b) MSRE
models. Left columns: ﬁtted assuming the LC model; right column:
ﬁtted assuming the MSRE model. . . . . . . . . . . . . . . . . . . . . . .
44
3.1
DIC from different joint models for the analysis of Penn ovarian aging
data, assuming normal, t (df=7) and t (df=4) distribution for the lon-
gitudinal submodel and using µi(t) i = 1,...,n within the time window
T = [45,55] as a functional predictor in primary outcome submodel. .
70
3.2
Estimates of model parameters by our best ﬁtting models with µi(t)
i = 1,...,n within the time window T = [45,55] as a functional predic-
tor in primary outcome submodel. . . . . . . . . . . . . . . . . . . . . . .
76
4.1
Number of times each speciﬁed ﬁtted model are selected by using the
10 criteria given in the ﬁrst column of each sub-table. Observations
are generated as described in Section 4.4.1 under the joint LC model
with KD = KC = 2 and the (TD,TC) mixture structure for the mean
and the variance proﬁles, respectively, where TD,TC ∈{separated,
overlapped}. Scenarios (a)-(d) specify the data-generating mechanism.
The ﬁtted models consist of both LC and MSRE structures with KD =
1,2,3 and KC = 1,2,3. The mixing proportions are 50-50. The cor-
responding values of AUC were reported at the end of the table for
each scenario. The “true AUC” is the AUC obtained when predictions
are generated using the correct outcome model (true parameters and
random effects/latent classes).
. . . . . . . . . . . . . . . . . . . . . . . 103
4.2
As in Table 4.1 but the mixing proportions are 80-20.
. . . . . . . . . 104
4.3
As in Table 4.1 but the observations are generated under the joint
MSER model. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 105
4.4
As in Table 4.2 but the observations are generated under the joint
MSER model. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 106
ix

4.5
Number of times correct association structure identiﬁed by model se-
lection criteria when comparing joint LC versus joint MSRE model
with KD = KC = 2. Observations are generated as described in Sec-
tion 4.4.1 under both the joint LC and MSRE model with KD = KC = 2
and the (TD,TC) mixture structure for the mean and the variance pro-
ﬁles, respectively, where TD,TC ∈{separated, overlapped}. Scenarios
(a)-(d) specify the data-generating mechanism.
. . . . . . . . . . . . . 107
4.6
Number of times each speciﬁed ﬁtted model are selected by using
the 10 criteria given in the ﬁrst column of each sub-table. Obser-
vations are generated as described in Section 4.4.1 under the joint
LC model for scenario (a), and MSRE model for scenario (b), with
KD = KC = 1. The ﬁtted models consist of both LC and MSRE stru-
tures with KD = 1,2, and KC = 1,2. The mixing proportions are 50-50.
The corresponding values of AUC were reported at the end of the ta-
ble for each scenario. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 108
4.7
Values of AUC for independent validation sample ( ˜n = 50) based on
the models selected by DIC, LPML, AIC1, BIC1, ICL1 and WAIC1.
Both the new validation sample and the original sample to build the
models are generated as described in Section 4.4.1 under the the joint
LC model, for scenario (a), and MSRE model, for scenario (b), with
KD = KC = 1.
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 109
4.8
Model comparison statistics from different joint models for the anal-
ysis of Penn ovarian aging data. The ten selection criteria are given
in the ﬁrst column of the table. The top and bottom panels corre-
spond to the scenarios of ﬁtting with the joint LC and MSRE models,
respectively. Best ﬁt model is given by boldface.
. . . . . . . . . . . . . 110
x

LIST OF APPENDICES
Appendix
A.
Computation Details in Chapter II . . . . . . . . . . . . . . . . . . . . . . . 122
B.
Computation Details in Chapter III . . . . . . . . . . . . . . . . . . . . . . 136
C.
Computation Details in Chapter IV . . . . . . . . . . . . . . . . . . . . . . 142
xi

ABSTRACT
Bayesian Joint Modeling of Longitudinal Trajectories and Health Outcome: A Broad
Evaluation of Mean and Variation Features in Risk Proﬁles and Model Assessments
by
Bei Jiang
Co-Chair: Professors Michael R. Elliott and Naisyin Wang
This dissertation consists of methodology developments and applications for joint
modeling of repeated measurements of health risk factors (i.e., longitudinal trajec-
tories) and health outcome data. Joint modeling is a natural choice to link longitu-
dinally observed covariates and disease outcomes: a mixed-effect model postulates
the longitudinal trajectories and features extracted therein serve as predictors in a
primary disease-outcome model. In the ﬁrst chapter, we consider joint models that
incorporate information from both long-term mean trends and short-term variability
in the longitudinal submodel. We then utilize both multiple shared random-effects
(MSRE) and latent class (LC) approaches to predict a binary disease outcome in the
primary model. We develop simulation studies to compare and contrast these two
modeling strategies; in particular, we study in detail the effects of the primary model
misspeciﬁcation. In the second chapter, we develop a joint modeling method that
uses the individual-level longitudinal measurements of follicle stimulating hormone
(FSH) to predict the occurrence of severe hot ﬂashes in a manner that distinguishes
long-term trends of the mean trajectory, cumulative change captured by the deriva-
xii

tive of mean trajectory, and short-term residual variability. Our method allows the
potential effects of longitudinal trajectories on the health risks to vary and accumu-
late over time. We further utilize the proposed methods to narrow down the critical
time windows of increased health risks. The third chapter is a detailed study of
model assessment. We evaluate six Bayesian model assessment criteria in the con-
text of a model that simultaneously considers a set of longitudinal predictors and
a primary outcome, connected through either LC or MSRE predictors. We focus on
two evaluation aspects: goodness-of-ﬁt adjusted for the complexity of the models, and
prediction evaluation based on both training and test samples as well as their con-
trasts. An interesting result is that when the data are generated under an MSRE
mechanism but ﬁt assuming an LC mechanism, a very highly predictive “artifact”
can be generated under certain scenarios. The consequence of this phenomenon is
that an over-optimistic classiﬁcation estimate can be built on such an artifact.
The methods developed in all three papers are applied to data from the Penn
Ovarian Aging Study, a 13-year longitudinal study comprised of a population-based
sample of 436 women aged 35-47 years selected via random-digit dialing in Philadel-
phia, PA during 1996-97 and followed through 2010. The study goal is to explore
the associations between reproductive hormone levels (follicle stimulating hormone
or FSH) and symptoms in the transition to menopause (severe hot ﬂashes).
xiii

CHAPTER I
Introduction
Epidemiology studies or clinical trials often measure both the risk factors and
disease outcome repeated over time in order to seek useful features in these lon-
gitudinal risk proﬁles to predict disease progression. In previous developments of
statistical tools to analyze such data, the focus has often been on a single longitudi-
nal risk process with the goal of using the true underlying longitudinal process (i.e.,
mean proﬁle) to relate to the disease process. It is therefore natural to model both the
observed longitudinal and disease processes jointly to gain more efﬁcient inference,
where a longitudinal submodel is outlined for the observed longitudinal risk proﬁles
Y and a primary disease outcome model is deﬁned to link the true underlying longi-
tudinal process and disease process O together. The common approach is to assume
a latent process u underlying both Y and O such that u account for all correlations
between Y and O, i.e., [Y,O] =
R
[Y,O | u]du =
R
[Y | u][O | u]du. Within this general
joint modeling framework, the longitudinal submodel is usually a mixed effect model
and the latent variable u takes one of the two forms: the random effects, deﬁned to
capture the individual variations from the population mean, and the latent class, de-
ﬁned to capture the heterogeneity in the random effects in the sense of Verbeke and
Lesaffre (1996) such that subjects in a particular latent class have similar shapes in
the longitudinal risk proﬁles and share the same disease risk, possibly conditional on
1

other covariates. Each approach has its own focuses and strengths as we will explore
in later chapters.
Many joint models based on these two approaches have been developed in the
context of cancer research and HIV/AIDS studies, mainly focusing on novel devel-
opments of longitudinal and outcome submodels. Such innovations include the use
of semi- and non-parametric longitudinal models to accommodate more ﬂexible risk
proﬁles and developing outcome submodels to accommodate more complex disease
outcomes, such as zero-inﬂated outcomes, competing events, multiple failure times
and cure fractions. For example, Rizopoulos and Ghosh (2011) linked multiple lon-
gitudinal processes of different types to a time-to-event outcome. Thorough reviews
of the topic are given by Ibrahim et al. (2001), Tsiatis and Davidian (1996), Ibrahim
et al. (2010) and Rizopoulos (2012); and a recent special issue of Lifetime Data Anal-
ysis edited by Chen and Gustafson (2011) was dedicated to various aspects of joint
modeling of longitudinal and time-to-event data. However, these previous joint mod-
eling strategies have focused on using the true underlying longitudinal process (i.e.,
mean proﬁle) to predict a disease outcome while treating the residual variability
(i.e., variance) in the longitudinal proﬁle as a nuisance parameter such that it does
not inﬂuence the disease progression. Recently, Elliott et al. (2012) proposed a new
method focusing on multiple shared random effects (MSRE) with the individual level
variance in the longitudinal proﬁles as another latent variable to link both sources
of data. This new method laid out a new framework of joint modeling of longitudi-
nal data and disease outcome data by linking the features in not only the long term
mean trend but also short term variability in the longitudinal trajectories to predict
a disease outcome.
This dissertation contributes to this fast growing area by developing novel joint
models to combine information from both mean trajectory and residual variability
in longitudinal predictors of key health outcomes. Motivating our work is the Penn
2

Ovarian Aging Study (Freeman et al. 2001; Manson et al. 2001), a longitudinal
study consisting of a population-based sample of 436 women aged 35-47 years se-
lected via random digit dialing in Philadelphia County, PA during 1996-97 and fol-
lowed through 2010. One of the major goals of this study is to explore associations
between reproductive hormone levels and symptoms in the transition to menopause.
Follicle stimulating hormone (FSH) is of particular interest because it is known to
stimulate folliculogenesis, an important factor in ovarian aging. Our aim is to de-
velop ﬂexible modeling tools that allow us to uncover new dynamic features in the
various aspects of the FSH evolution history that predict the menopausal symptoms
of interest (in particular, cross-sectional onset of severe hot ﬂashes and severity of
hot ﬂashes).
We base our developments within the framework of joint models of longitudinal
and disease outcome data. We outline one longitudinal submodel for the longitudi-
nal history of FSH levels, and one primary outcome model for symptoms of inter-
est along with assumptions of how the FSH evolution process relates to subsequent
menopausal symptoms. In particular, the formulation of a longitudinal submodel
for the FSH data takes into account the following data features: 1) the FSH data
are highly unbalanced with available measurements across women taken at differ-
ent ages and ranging from 1 to 26 out of the maximum 26 possible measurements;
2) overall, the FSH evolution pattern is relatively ﬂat between age 35 and 40 and
then has an increasing period later on where there exist both acute and gradual
increase periods; 3) the ﬂuctuations of the FSH levels are highly variably among
these women, reﬂecting low or high short term variabilities around the mean trends.
Motivated by speciﬁc scientiﬁc questions, we consider association structures that go
beyond the common SRE and LC approaches to relate the important features in the
FSH evolution process to menopausal symptoms.
In Chapter II, we start our analysis with the popular shared random effect and
3

latent class approach but built within the new framework proposed by Elliott et al.
(2012) to investigate the interesting features of FSH trajectories that are manifest in
both the mean trends and the short term ﬂuctuations. However, an important limita-
tion of the shared random effects approach is the difﬁculty of interpreting the effects
when the random effects are associated with complex functions of time (for example,
spline representations). To avoid this difﬁculty, we seek features in FSH trajectories
from the perspective of linear deviations from a population trend estimated by the
LOWESS method; the individual level mean trends are therefore assumed to deviate
from the LOWESS estimated population trend in the direction of intercept and slope
while also accounting for different rates of change in FSH levels among women. Fi-
nite mixture lognormal distributions are used to model the individual level residual
variance because evidence suggests that the highly variable short term ﬂuctuations
in the FSH evolution process cluster into low or high categories. Although shared
random effect and latent class approaches have their own focuses, a lack of exist-
ing knowledge about the strengths and weaknesses of each approach motivates us
further to compare and contrast these two approaches with the goal of providing use-
ful insights into interpreting our data analysis results. This investigation reveals
interesting phenomena that are new to the literature.
While there are advantages of using summary measures of the longitudinal tra-
jectories to relate to the disease outcome, as in Chapter II, it is also of clinical interest
to investigate the contribution of the history of the FSH levels over the entire late re-
productive period to the menopausal symptoms by quantifying the cumulative time
varying effects and identifying the critical age range when the elevated FSH lev-
els lead to increased risks of more severe symptoms. To meet this aim, in Chapter
III, we consider alternative association structures to link the FSH evolution process
and menopausal symptoms. In particular, we borrow existing tools from functional
data analysis literature while building our models within the framework proposed
4

by Elliott et al. (2012), with the goal to distinguish between long-term mean trends
and short-term variability. This proposed association structure relates the primary
outcome of interest to an integral of long-term mean trend µ(t) over certain time
windows, i.e.,
R
T µ(t)θ(t)dt, where θ(t) is the functional coefﬁcient function capturing
the cumulative time varying effect due to the longitudinal history. We consider the
Bayesian penalized B spline approach by Lang and Brezger (2004) to achieve smooth
but ﬂexible representation of θ(t). Further, we consider a robust semi-parametric
model to smooth the underlying FSH trajectories by 1) associating random effects
with B spline basis functions in a mixed effect model and using penalty term to
shrink unnecessary ﬂuctuation towards zero; and 2) assuming within-subject resid-
ual errors follow a t distribution rather than a typical normal distribution to avoid
the potential inﬂuence of outlying observations, where a mixture of log normal distri-
butions is assumed to allow for potential over-dispersion of the within-subject scale
parameters. In contrast to the two-step procedure used in Chapter II to simplify the
random effects structure, this formulation of the longitudinal submodel is more ﬂex-
ible and makes the evaluation of an alternative association structure
R
T µ′(t)θ1(t)dt
possible, where µ′(t) = ∂µ(t)/∂t and conceptually captures the cumulative changes in
the long-term mean trends. The implementation of the new proposed joint model-
ing approach in Bayesian paradigm is straightforward. It allows for simultaneous
evaluation of the uncertainty in estimating θ(t) or θ1(t) by providing point-wise cred-
ible intervals and eventually leads to easy identiﬁcation of the critical age range of
increased risks.
In Chapter IV, we focus on the model assessment for the joint models considered
in Chapter II. In practice, such joint models can be used as prognostic tools to predict
prospective event risks for a particular patient, given the patient’s history of longi-
tudinal measurements. However, investigations studying the pros and cons of joint
LC and MSRE models in Chapter II reveal that different numbers of mixture compo-
5

nents as well as the assumed association structure to link the longitudinal submodel
and primary outcome model (either in the form of MSRE or LC for these random
effects) can greatly affect the target individualized predictions. In these settings,
it is relevant to consider how to choose among these candidate models and how to
assess which model best predicts the risk of the health outcome of interest. Moti-
vated by these considerations, in this chapter, we evaluate several Bayesian model
assessment criteria, including a recently proposed one, WAIC by Watanabe (2010).
Some criteria are modiﬁed following the Bayesian principle when necessary to ac-
commodate the joint modeling framework that analyzes longitudinal predictors and
binary health outcome data. We base our evaluation on empirical numerical studies
and focus on two evaluation aspects: goodness-of-ﬁt adjusted for the complexity of
the models, reﬂected by the numbers of latent features in the longitudinal trajecto-
ries that are part of the hierarchical structures in the joint models, and prediction
evaluation based on both training and test samples as well as their contrasts.
Finally, we conclude this dissertation in Chapter V, summarizing our major ﬁnd-
ings, exploring in some depth issues that were set aside in the main chapters, and
discussing limitations and suggestions for future research.
6

CHAPTER II
Joint Modeling of Cross-Sectional Health Outcomes
and Longitudinal Predictors via Mixtures of Means
and Variances
2.1
Introduction
Joint models are a natural choice to link longitudinally observed covariates and
disease outcomes. Many joint models have been developed in the context of cancer
research and HIV/AIDS clinical trials, where a mixed-effect model is outlined for the
longitudinal trajectories and a primary outcome model is deﬁned for the disease out-
come. The two models are usually linked together in one of two ways: (1) shared
random effects (SRE) models, where a functional form of the random effects in the
mixed effect model is a covariate in the outcome model, and (2) latent class (LC) mod-
els, where there exists heterogeneity (precisely, latent classes) in the mean proﬁles
of the longitudinal trajectories, and the subjects in a particular latent class share the
same risk of event, possibly conditional on other covariates. Each approach has its
strengths.
For SRE models, the random effects are assumed to capture the main features
in the longitudinal trajectories that predict the outcomes. The concept of “shared
parameters” was used in Wu and Carroll (1988) to model non-ignorable missing data.
7

Articles by Tsiatis and Davidian (2004) and Ibrahim et al. (2010) and the book by
Ibrahim et al (2001) offer excellent general reviews of these models.
In the LC model literature, growth mixture models (Verbeke and Lesaffre (1996),
Muth ´en and Shedden (1999), Muth ´en et al. (2002)) are often used to classify longi-
tudinal trajectories. Proust-Lima et al (2012) studied the joint LC modeling in detail
and contrasted its use with that of joint SRE models. To the best of our knowledge,
their work was the ﬁrst to investigate and compare the goodness of ﬁt and prediction
accuracy of joint LC versus joint SRE modeling. They illustrate and compare model
performance using data from a prostate cancer study.
In this paper, we use both approaches to investigate the association between
longitudinal hormone levels and menopausal symptoms for a group of middle-aged
women. The Penn Ovarian Aging Study (Freeman et al. 2001; Manson et al. 2001) is
a longitudinal study consisting of a population-based sample of 436 women aged 35-
47 years selected via random digit dialing in Philadelphia County, PA during 1996-
97.
At each annual assessment period, study personnel visited each subject two
times approximately one month apart for an in-person interview and a blood sam-
ple for hormone measurements. One of the major goals of this study is to explore
associations between reproductive hormone levels and symptoms in the transition
to menopause. Changes in hormone levels alter menstrual bleeding patterns prior
to the cessation of menstruation (menopause) marking the end of a woman’s repro-
ductive years. This course of events, which can last 5 or more years, coincides for
a majority of women with the development of hot ﬂashes, sleep disorders, and bone
loss, among other symptoms. While researchers have focused on the associations
between these symptoms and hormone levels, the impact of within woman rate of
change and variability in hormones, such as Follicle Stimulating Hormone (FSH), is
not well understood.
To address such questions, we investigate methods that can model different as-
8

pects of the dynamic process of hormone change and variability and simultaneously
link them with the symptoms of interest. A novel feature of our modeling effort is
to link both longitudinal proﬁles and residual variability of the FSH measures to
risk of experiencing severe hot ﬂashes. While most joint models have treated within-
subject variability as a nuisance parameter, recently a small literature has developed
to evaluate the associations between within-subject variability in longitudinal data
and the primary outcomes (Sammel 2001; Elliott 2007, 2012). Because of biological
considerations that subject-level hormone ﬂuctuation may accentuate menopausal
symptoms (Gracia et al. 2004; Freeman et al. 2006), we develop a joint modeling
approach that simultaneously examines the association between subject-level mean
trajectories and variability of FSH, and the binary indicator of severe hot ﬂashes.
Because of evidence that these trajectories or variabilities are heterogenous and
cluster into possibly clinically relevant groupings, we develop a ﬁrst-stage growth
mixture model for FSH hormone that also includes latent classes for the subject-level
variability. We consider two second-stage outcome models: one based on a “multiple
shared random effects” (MSRE) model that uses the individual level trajectories and
variabilities to predict severe hot ﬂash experience, and the other based on an LC
model that uses the latent classes themselves to predict the experience of severe
hot ﬂashes. Our key focus is not on one second-stage model or the other, but their
contrast. In addition to model ﬁt and model checking efforts, we develop simulation
studies to examine the robustness and predictive accuracy of each approach when the
model may or may not be correctly speciﬁed. While Proust-lima et al.’s work (2012)
mainly focuses on comparing different modeling strategies on a real data example,
our simulation investigation sheds light on the potential impact of model misspeciﬁ-
cation in terms of model estimation and predictive power.
9

2.2
Joint models and corresponding approaches
The joint modelling approach consists of a model for the longitudinal trajectories
and a primary model for the outcomes.
• The longitudinal submodel is a generalized growth mixture model (Muth ´en and
Shedden 1999) with subject-speciﬁc mean trajectories and residual variances:
yi j|bi,σ2
i ∼N{f (bi;ti j),σ2
i }
Di ∼Multinomial(πD
1 ,...,πD
KD)
bi|Di = d ∼N(βd,Σd),d = 1,...,KD
Ci ∼Multinomial(πC
1 ,...,πC
KC)
σ2
i |Ci = c ∼log-N(µc,τ2), c = 1,...,KC
(2.1)
where, yi j denotes the longitudinal covariate for the ith subject at time ti j, j =
1,...,ni, i = 1,...,n, bi are random effects that reﬂect the subject-level trajectory
patterns, and σ2
i is the residual variance. Di and Ci deﬁne the latent classes
for the longitudinal means and individual variance memberships, respectively.
• The primary outcome model is a probit regression model:
Φ−1(P(oi = 1)) = Z′
iη,
(2.2)
where oi denotes the binary indicator of outcome, Zi denotes a vector of the co-
variates in the probit model for subject i, i = 1,··· ,n and Φ(·) is the cumulative
distribution function for the standard normal distribution. For the LC probit
model, Zi contains the latent class membership indicators Di and Ci; while
for the MSRE probit model, Zi contains the speciﬁc shared random effects and
residual variances. Other fully-observed baseline predictors may be included
in Zi as well.
10

2.2.1
Likelihood speciﬁcation
Let φ = (πD
d , βd, Σd, d = 1,...,KD; πC
c , µc, c = 1,...,KC, τ2, η)′, where we as-
sume each parameter in φ has independent prior distribution with the joint prior
distribution denoted by π(φ), and z include all unobserved latent variables, i.e.,
z = (b,σ,C,D)′. The observed data x consists of the longitudinal proﬁles y1,...,yn
and the observed outomes o1,...,on. Then the complete data likelihood of φ based on
the complete data (x,z) is given by
f (x,z|φ) ∝
(
n
Y
i=1
"
Y
d
·
πd(2π)−r
2 |Σd|−1
2 exp
½
−1
2
¡
bi −βd
¢′Σd
¡
bi −βd
¢¾¸I(Di=d)
×
Y
c
·
πc(2πτ2)−1
2 σ−2
i exp
½
−1
2τ2
¡
logσ2
i −µc
¢2¾¸I(Ci=c)
×
ni
Y
j=1
1
q
2πσ2
i
exp
"
−1
2σ2
i
©
yi j −f (bi;ti j)
ª2
#
×Φ(Z′
iη)oi ©
1−Φ(Z′
iη)
ª1−oi
#)
π(φ)
(2.3)
2.2.2
Prior speciﬁcation and posterior computation
We propose a fully Bayesian approach to estimate model parameters. Weakly
informative conjugate priors were used whenever possible. For the mixture normal
distribution of the random effects, we let βd ∼N(0,V), V = n d
Cov( ˆβ) where ˆβ is the
linear regression estimator of y on the design matrix of t deﬁned by f (·;ti j). This
corresponds to a prior “single observation” data-driven inﬂated covariance structure
centered at a null model, and avoids improper posteriors resulting from the possi-
bility that some of the latent classes are not represented in the data (Elliott et al.
2005). For the the variance-covariance matrix for the random effects Σd, we use the
prior proposed by Kass and Natarajan (2006): Σd ∼Inverse-Wishart(df = r,Λ), where
Λ = r
³Pn
i=1 d
Cov( ˜bi)−1/n
´−1
, ˜bi is given by OLS estimator of bi for subject i and r is the
dimension of bi. This prior restrains the eigenvalues of the variance-covariance ma-
11

trices away from 0, avoiding the improper posterior that can result from unbounded
likelihoods when the variance-covariance matrix is unrestricted in normal mixture
models (Day 1969).
For the mixture log normal distribution for the residual variances, we used dif-
fuse priors: µc ∼N(0,v), τ−2 ∼Gamma(a,b) with v = 1000 and a = b = .001. For
the class membership probabilities, we assume conjugate Dirichilet(4,...,4) on both
πC = (πC
1 ,...,πC
KC) and πD = (πD
1 ,...,πD
KD) (Frühwirth-Schnatter 2006); this is equiva-
lent to assuming a priori 4 observations in each class, avoiding the existence of empty
classes. Lastly, we let θ ∼N(0,(9/4)I) in the probit regression, where (9/4)I is chosen
to bound the estimated outcome probabilities to be away from 0 and 1 (Garrett and
Zeger 2000; Elliott et al. 2007, and Neelon et al., 2011).
Gibbs sampling is used to obtain draws from the corresponding posterior distribu-
tions. For (θ | C,D,O) we use the Albert and Chib (1993) data augmentation method
for probit regression models. The draws of (σ2
i |Ci,µc,τ2,bi,oi,{yi j}j) for i = 1,...,n are
obtained the inverse cumulative distribution method. The exact speciﬁcations of all
priors and MCMC sampling procedures are provided in the Appendix A.
Three chains from diverse starting points were run and Gelman-Rubin statistics
(Gelman et al. 2003) were used to assess the convergence of the MCMC chains. For
the well-documented issue of "label switching" in ﬁnite mixture modeling (Redner
and Walker 1984), we applied the post-processing relabeling algorithm (Stephens,
2000) in which all possible permutations of class assignments are considered at each
iteration of the Gibbs sampler. The permutation of the class assignment was chosen
to maximize the posterior probability so that the labeling of classes was consistent
with the previous assignments.
For our models with KD = 2 or KC = 2, there is
little evidence of label switching and Stephens’s relabeling algorithm converged very
rapidly with the class labels from the initial MCMC output. But for models with
more classes (KD = 3 or KC = 3), where label switching happens more frequently, we
12

initialized the class labels prior to running the algorithm by "reordering" the labels
within chains based on visual inspection, since the convergence speed of Stephens’s
algorithm may depend on the quality of initial labels.
2.2.3
The choice of the number of classes
The choice of the number of latent classes is known to be a challenging problem;
see discussions by McLachlan and Peel (2000) and Beunckens et al. (2008). We con-
sidered two criteria: the deviance information criterion (DIC), proposed by Spiegel-
halter et al. (2002), and the logarithm of the pseudomarginal likelihood (LPML)
(Geisser and Eddy 1979). DIC uses the discrepancy between the posterior mean of
the deviance D(φ) = Eφ
©
−2log f (x | φ) | x
ª
and the deviance evaluated at the poste-
rior mean D(φ) = −2log f
©
x | E(φ | x)
ª
to estimate the effective number of degrees of
freedom in the model pD. DIC is then given by the analog of the Akaike Information
Criterion (AIC):
DIC(x) = D(φ)+ pD = 2D(φ)−D(φ) = −4Eφ
©
log f (x | φ) | x
ª
+2log f
©
x | E(φ | x)
ª
.
In our setting, f (x | φ), where x = (y,o)′ consisting of the fully-observed data, is not
available in closed form; instead we use the approach outlined in Celeux et al. (2006)
to obtain
DIC(x) = Ez {DIC(x,z)} = −4Ez,φ
©
log f (x,z | φ) | x
ª
+2Ez
£
log f
©
x,z | Eφ(φ | x,z)
ª
| x
¤
where integration over the latent variables z = (b,σ,C,D)′ is obtained via numercial
methods; detailed are provided in Appendix A.
LPML corresponds to a Bayesian cross-validation measure, deﬁned as LPML =
nX
i=1
log(CPOi), where CPOi = f (yi,oi|y(−i),o(−i)) represents a cross-validated posterior
predictive density for (yi,oi) given the data excluding (yi,oi) (denoted by (y(−i),o(−i))).
13

The model with higher value of LPML provides better ﬁt to the data (Ibrahim et al.,
2001). Details of the LPML computation are also provided in Appendix A.
2.2.4
Goodness of ﬁt evaluation
We assessed the model goodness of ﬁt to the data in two ways. First, we examined
the posterior predictive distributions (PPDs; Gelman et al. 2003), where a PPD p
value close to 0.5 implies a good ﬁt of the model to the data. For the longitudinal
trajectories, we use repeated posterior draws to compute the PPD p values
P
n
Ti(yi;bi,σ2
i ) < Ti(yrep
i
;bi,σ2
i )
o
,
where we consider a χ2-like statistic, Ti(yi;bi,σ2
i ) = P
j
©
yi j −f (bi;ti j)
ª2/σ2
i for sub-
ject i.
For the outcome oi, we compute P
³
Trep < Tobs´
using repeated posterior
draws, where Tobs = n−1 P
i I(oi = 1), and Trep = n−1 P
i orep
i
with orep
i
following a
Bernoulli distribution of the success probability Φ(Z′
iη).
Second, we assessed the discriminatory ability of the model using receiver-operating
characteristic (ROC) curves, in particular the area under the ROC curve (AUC). ROC
curves plot true positive rate (TP) versus false positive rate (FP) for all possible cut-
offs based on predicted P(oi = 1) = Φ(Z′
iη) obtained from (4.3). The ROC curve and
AUC were computed at each MCMC iteration using the ROCR package in R (Sing
et al. 2005). The ROC is computed by ordering the observations (i) = 1,...,n so that
ˆP(o(i) = 1) ≥ˆP(o(i+1) = 1), computing changepoints c = 2,...,nc, nc ≤n where the ob-
servations change from positive to negative (i.e., o(c−1) = 1, o(c) = 0), and plotting
Pc
(i)=1(1 −o(i))/Pn
(i)=1(1 −o(i)) on the x-axis versus Pc
(i)=1 o(i)/Pn
(i)=1 o(i) on the y-axis.
Area under the ROC is then computed using a trapezoidal approximation. The pos-
terior mean AUC is calculated as the average AUC’s across MCMC iterations. To
obtain the posterior mean and the pointwise 95% credible interval of ROC curve,
14

we select 250 points equally spaced along the FP axis and take the vertical average
or 95% quantiles of TP’s at the 250 chosen points. This approach is referred to as
vertical averaging of ROC curves at ﬁxed FP rates by Fawcett (2006).
2.3
Simulations
In this section, we conduct simulation studies to evaluate the inferential proper-
ties of the LC and MSRE approaches when the model is correctly speciﬁed and when
it is not (i.e., the data are generated under the LC model but analyzed using the
MSRE model, and vice versa). We consider four scenarios for the longitudinal model
with different levels of overlap between two mixtures in both mean proﬁles and vari-
ance patterns, crossed with two cross-sectional outcome models. For the longitudinal
observations, we generate data from the following model with two mean proﬁle and
two variance classes,
yi j|bi,σ2
i ∼N(b0i + b1iti j,σ2
i )
bi ∼πdN(β1,Σ1)+(1−πd)N(β2,Σ2)
logσ2
i ∼πcN(µ1,τ2)+(1−πc)N(µ2,τ2)
(2.4)
where i = 1,...,200 and ti j = 0,1,2,...,ni with ni ≡20.
For k = 1,2, we let βk =
(βk1,βk2)′ and
Σk =


ω2
k1
ρkωk1ωk2
ρkωk1ωk2
ω2
k2

.
We let β1 = (0,0)′ and β2 = (2
p
2,2
p
2)′, ρ1 = 0 and ρ2 = −0.6, and µ1 = −2 and
µ2 = −.5 in all scenarios. Thus the mean of the two bivariate normals differs by 4
throughout, while the mean log of the variances are separated by 1.5. Our four lon-
gitudinal model scenarios are deﬁned by (ω2,τ2)′ = (2,.25),(1,.25),(2,.06), and (1,.06),
respectively, where ω = ω11 = ω12 = ω21 = ω22.
15

Figure 2.1 shows the 95% contours for the two components in the mixture mean
proﬁles and the density plots of the mixture log-variance classes in each of the four
scenarios: both mean and variance classes heavily overlapping (scenario # 1, the
most challenging in terms of identiﬁcation), only the variance classes heavily over-
lapping (scenario # 2), only the mean classes heavily overlapping (scenario # 3), nei-
ther the mean nor the variance classes heavily overlapping (scenario # 4, the least
challenging in terms of identiﬁcation). In all scenarios, we let πd = 0.35 and πc = 0.65.
For each of the simulation scenarios proposed for the longitudinal observations,
the following two underlying probit models are considered for health outcome:
1. latent class (LC) probit submodel:
Φ−1 {P(oi = 1)} = θ0 +θ1I(Di = 2)+θ2I(Ci = 2)+θ3I(Di = 2,Ci = 2)
(2.5)
2. multiple shared random effect (MSRE) probit submodel:
Φ−1 {P(oi = 1)} = γ0 +γ1bi0 +γ2bi1 +γ3σ2
i +γ4bi0σ2
i +γ5bi1σ2
i
(2.6)
where Di = 1 corresponds to the mean proﬁle class N((0,0)′,Σ1), and Ci = 1 corre-
sponds to the variance class N(−2,τ2) in the longitudinal submodel (4.8). We replace
η in (4.3) by θ for the LC and by γ for the MSRE probit primary models to simplify
the task of presentation; θ0 and γ0 are chosen for each scenario so that the outcome
prevalence is approximately 50 percent.
To investigate the robustness to model mis-speciﬁcation for each approach, we
generated data from LC and MSRE primary models from equations (4.9) and (4.10)
under each of the four longitudinal mixture scenarios, and then applied the ap-
proaches assuming the LC and MSRE structure to all generated data sets regard-
less of how the data were generated. (For scenarios in which the assumed model is
16

mis-speciﬁed, we generated observations from 10,000 subjects, obtained the corre-
sponding maximum likelihood estimates constructed under the assumed model, and
repeated the process 1000 times to obtain the averages of the estimated parameters.
We then used these average estimates as the “true” parameters for that simulation
scenario. This practice allows us to compare the robustness for the two different
modeling considerations under the same simulation scenario.) For each scenario,
we simulate 100 data sets and report the Monte Carlo bias, standard deviation (SD),
mean squared error (MSE) and 95% credible interval coverage (95% COV) for the cor-
responding parameters under the correctly and incorrectly speciﬁed models. We also
consider the correct classiﬁcation of subjects to latent classes based on the posterior
mean of P(Di = d | y,o) and P(Ci = c | y,o).
Table 2.1 shows the bias, SD, MSE, and nominal coverage for the probit regres-
sion parameters in the primary outcome model; see Tables 2.5-2.8 for the complete
results for all parameters in the model. Results were quite similar for scenarios #1
and #3: the mean parameters are estimated with bias and sometimes less than nom-
inal coverage, even when the model is correctly speciﬁed, due to the difﬁculties in
separating the two with overlapping distributions (the parameters associated with
the ﬁrst mean component tend to be better estimated since they compose a larger
fraction of the sample). Incorrectly specifying the MSRE model has less impact on
longitudinal mean estimation than incorrectly specifying the LC model. Incorrect
speciﬁcation damages the estimation of the mixture proportions for scenarios #1 and
#3; even when correctly speciﬁed, the LC model still yields somewhat biased and
undercovered estimates of the mixture proportions, again due to the difﬁculties in
separating mixture components. In general, both methods performed well in estima-
tion of longitudinal mean components for scenarios #2 and #4, although some bias
and coverage issues remained for the slope of the second component in scenario #2.
The variance components of the longitudinal model were generally well estimated
17

under all scenarios, regardless of model misspeciﬁcation.
For estimation of the primary outcome model, the correctly speciﬁed LC model
has some bias and modest undercoverage for the estimation of the longitudinal mean
effect in scenarios #1 and #3, again resulting from the difﬁculty in separation of the
clusters. The correctly speciﬁed MSRE model generally does well, with some very
modest downward bias in the estimation of the individual residual variance effects.
When incorrectly speciﬁed, the LC model is biased, overestimating the main effects
of the longitudinal mean and variance class but underestimating the interaction ef-
fect between these two classes, which eventually leads to very poor coverage. The
MSRE appears to be more robust, with little bias and good coverage of the implied
target MSRE parameters under LC model. Under scenarios #2 and #4, estimation
of the primary outcome model appears to be approximately correct under both the
LC and MSRE models and largely robust to model misspeciﬁcation, although using
the LC model when the MSRE model is correct under scenario #2 yields some bias
and reduction of coverage due to the imperfect separation of the variances mixtures.
While our ﬁndings appear to suggest the use of MSRE approach over that of LC if the
goal is the estimation of regression parameters in the primary outcome model, such
a conclusion must be tempered by the fact that, if the LC model is actually correct,
the target parameters under the MSRE model may be of less interest.
We next turn our attention to evaluating the correctness of outcome prediction
and mis-classiﬁcation of mixture classes. Again, generating data from the 4 longitu-
dinal scenarios and LC vs MSRE primary models, we evaluate the true area under
the ROC curves (AUC) as well as the corresponding values predicted by assuming the
LC/MSRE models, respectively, in Table 2.2 (a), and compare those with the mean
AUC obtained under the true values of the model. The misclassiﬁcation rates for
the mixture components are given in Table 2.2 (b). We denote ˜Ci = argmaxc ˆπC
ic and
˜Di = argmaxd ˆπD
id, where ˆπC
ic and ˆπD
id are the posterior mean assignment probabilities
18

of class-membership of the mean proﬁle and variance class for subject i, respectively.
We also use “ ˜D = i|D = j” indicate the case of the true D = j while the predicted ˜D = i
and equivalently deﬁne the cases for variable C.
When the model is correctly speciﬁed, the repeated sampling mean of the poste-
rior mean AUC is fairly close to the repeated sampling mean of the AUC obtained us-
ing the true parameter value. When the LC model is correctly speciﬁed, the empirical
95% credible intervals of AUC when the mean mixtures overlap (scenarios #1 and #3)
are wider than the truth, while the empirical 95% credible intervals of AUC when the
mean mixtures are well-separated (scenarios #2 and #4) are of similar length to the
truth, reﬂecting the difﬁculty in separating the mean mixture components in the LC
model and therefore larger variabilities in the predictive power. The empirical 95%
credible intervals of AUC under all 4 scenarios are all very close to the truth when
the MSRE model is correctly speciﬁed, since the main outcome model is a function of
the continuous subject-level mean and variance parameters and hence not affected
by any degree of difﬁculty in separating the mean clusters. When the MSRE model
is used and LC is the truth, it loses a little predictive power only when the mean
mixtures overlap (scenarios #1 and #3); otherwise the results are similar to that of
the correctly speciﬁed LC model. However, when the MSRE model is the truth and
the LC model is used, it is interesting to note that, when it is more difﬁcult to sep-
arate the components within the mean class and there exists considerable potential
for misclassiﬁcation as in scenario #1 and #3, the LC model can achieve either much
higher or lower AUC than the AUC based on ML estimates of probit LC submodel
given known class memberships. Figure 2.2 presents two typical data examples out
of the total 100 data sets that have either very low or very high AUC estimated by the
LC model. In both examples, the AUC’s by the correctly speciﬁed MSRE model are
very close to the truth. However, the much higher AUC by LC compared to the MLE
estimate given known class membership suggests that the LC model has some ability
19

to create "artiﬁcial clusters" of very high predictive performance when MSRE model
is the truth, while the MSRE AUC estimates suffered from imperfect prediction of
the true probabilities of the outcome. On the other hand, when almost all subjects
are being assigned to one mean class by the LC model, prediction of the outcome is
solely dependent on the variance class and consequently the LC model had worse
predictive performance than the ML estimates of probit LC submodel given known
class membership. This phenomenon is an unique artifact of joint LC modeling, and
may be due to the fact that the mixture classiﬁcation is computed given both the
longitudinal data y and the outcome o. When the information from the longitudinal
data is weak, the class membership can be “artiﬁcially” explained by the outcome o.
With the outcome o being binary, classes were artiﬁcially created to match the two
outcome groups of o = 0 and o = 1. These two commonly observed cases presented
in Figure 2.2 illustrate this phenomenon which leads to overly inﬂated variation for
LC estimated AUC (i.e., considerably wide 95% credible intervals of AUC given in
Table 2.2); what is observed in Figure 2.2 (a) and (b) also leads to the high mis-
classiﬁcation rate of class membership. This phenomenon for joint LC modeling also
happens when the data are generated with the LC model, but the effect is much less
prominent. To our knowledge this has not been previously noted in the literature
and could have strong implications for model interpretation.
Finally, in terms of misclassiﬁcation rates of mean class membership, we see con-
sistent patterns with the above discussion. The LC model tends to perform reason-
ably well when correctly speciﬁed; when LC is ﬁt using MSRE data, the misclassi-
ﬁcation rates for the mean classes are high. In addition, the LC approach seems to
perform a bit better than the MSRE when the model is correctly speciﬁed, where the
latter deteriorates for Scenarios # 1 and # 3, regardless of whether the model is cor-
rect or not. This is consistent with what we have observed for the MSRE longitudinal
mean parameters. When the mixture components are well separated, as in scenario
20

#4, both approaches perform well regardless of model speciﬁcation. Variance classes
are generally well estimated; there is some modest reduction in accuracy under Sce-
narios # 1 and # 2, where the separation is less complete, but results are robust to
model misspeciﬁcation.
2.4
Analysis of Penn Ovarian Aging Study data
One goal of the Penn Ovarian Aging Study is to determine to what extent the
longitudinal Follicle Stimulating Hormone (FSH) observations are predictive of se-
vere hot ﬂashes during the follow-up period. After taking into account the population
level non-linear trend of these annual measurements, we seek to evaluate whether
subject-speciﬁc trends in FSH as well as underlying latent class membership de-
termined by these trends are associated with severe hot ﬂashes.
Out of the 436
women in the study, we restrict our analysis to the 245 who a) reported having not
experienced severe hot ﬂash symptoms at baseline and b) had at least 3 follow-up
measurements of FSH levels. Hormone values were treated as missing if a woman
was pregnant, breast feeding or taking exogenous hormones during the 13 years of
follow-up, since these circumstances will dramatically affect FSH levels. A total of
4,244 hormone values were observed during follow-up, with a minimum of 3 and a
maximum of 26 per woman. Of the 245 women without severe hot ﬂash symptoms
at baseline, 118 (48.2%) had experienced severe hot ﬂashes at least once during the
study.
We let yi j denote the mean detrended log(FSH) obtained from the lowess residu-
als (Figure 2.3) and oi denote the severe hot ﬂash indicator: oi = 1 if had experienced
severity score ≥2 at least once during study. Preliminary analysis using standard
linear mixed effects (LME) models indicated that a random intercept and linear slope
model is sufﬁcient to capture the trends in the residual subject-level trajectories. In
particular, orthogonality of design matrices can help improve chain mixing and con-
21

vergence. Thus we let f (bi;ti j) = bi0 + bi1ti j, where ti j is the ﬁrst degree orthogonal
polynomial of subject age, and bi0 and b1i are the subject speciﬁc random intercepts
and slopes, respectively. We then jointly model the FSH mean proﬁle and variance to
predict the onset of severe hot ﬂash using our models in (4.2) and (4.3). We examine
the strategies of using the primary probit LC and MSRE models under the joint mod-
elling framework, as presented in section 2.2. We also adjust for additional baseline
covariates log(BMI) and smoking status in both primary models.
For all the models considered in this section, we ran three MCMC chains of 50,000
iterations, with the ﬁrst 10,000 iterations discarded as burn-in. We retained every
10th draw to reduce autocorrelation. We assessed convergence of the chains using
the Gelman-Rubin statistic ˆR, based on the ratio of the total variance across the
chains to the within-chain variance. The maximum value among all population and
subject-speciﬁc parameters was less than 1.1, indicating convergence.
Given the moderate sample size, we consider the models with a maximum of three
components for both mean proﬁle and variance classes: i.e., we let KD = 1,2,3 and
KC = 1,2,3. As shown in Table 2.3, both the likelihood and LPML measures (note:
log likelihood is computed as the posterior mean of the log likelihood) suggest that
the models with multiple components in both mean proﬁle and variance classes ﬁt
the data much better than models with single-component mean proﬁle and variance
classes under both joint MSRE and LC models. In constrast, DIC favors simpler mod-
els for both joint modeling strategies. The likelihood is essentially ﬂat for the MSRE
model for KD ≥2,KC ≥2; for the LC model, the likelihood continues to decrease as
the number of mean and variance classes increase. Under the DIC, a model with one
class for the mean trajectory and two for the variance ﬁts best for both the MSRE
and LC models, with a two-class model for both the mean and variance a somewhat
close second for both the MSRE and LC models. Accounting for model predictive per-
formance with LPML, the two-class mean and one-class variance provides the best ﬁt
22

for the MSRE model, with the two-class mean and two-class variance a close second;
similar results are obtained for the LC model, with the best (now two-class mean and
variance) and second-best (two-class mean and one-class variance) switched from the
MSRE model. Hence we focus on the KD = 1,KC = 2 class in the remainder of the
analysis, although we report the results for the KD = 2,KC = 2 as well.
Figure 2.4 shows the mean trajectories and the variances for the KD = 1,KC = 2
model (MSRE on the left side, LC on the right side), indicating the bimodal nature
of the posterior means of the individual variances. Table 2.4 reports the results for
both the KD = 1,KC = 2 and KD = KC = 2 MSRE and LC models. There is little
difference between the LC and MSRE model with respect to the estimation of the
longitudinal submodel. The two class mean model separates the mean trajectories
into two approximately equal-sized classes, with one a “null class” with slope and
intercept near zero, the other a “high and rising” class with an slope of .21 under the
MSRE model and .20 under the LC model, and an intercept of .16 under both models.
All models suggest that a little more than one in ﬁve women (23% under MSRE, 21%
under LC) belong to a low residual variance class (centered at .07(MSRE)/.06(LC)),
while the remainder belong to a higher variance class centered at .32(MSRE)/.31(LC).
For the outcome, both the MSRE model and the LC model suggests positive and
highly signiﬁcant association between subject-level variance and risk of hot ﬂash. For
a non-smoking woman at mean BMI of 27.7 with detrended FSH slope and intercept
at the population mean, the probability of experiencing a severe hot ﬂash under the
MSRE model with KD = 1,KC = 2 is 29.7% (19.0%, 41.7%) if her residual variance is
at the Class 1 mean and 45.9% (37.8%, 54.0%) if her residual variance is at the Class
2 mean. The difference is greater under the LC model with KD = 1,KC = 2, where
non-smoking women with mean BMI have a predicted hot ﬂash probability of 17.2%
(4.1%, 32.0%) if they are in the low variance class (Class 1) and 51.6% (43.0%, 60.2%)
if they are in the high variance class (Class 2). The MSRE model also provides some
23

evidence that subjects with higher baseline FSH are at reduced risk of hot ﬂash (95%
credible interval barely excludes 0 under KD = 1,KC = 2 and barely includes 0 under
KD = KC = 2); the LC model with KD = 1,KC = 2 by deﬁnition excludes mean tra-
jectories from inﬂuencing the outcome, but even assuming KD = KC = 2 provides no
evidence that the different mean classes are associated with the hot ﬂash outcomes.
Neither the MSRE or LC models provide any evidence of interaction between the
subject-level residual trajectories and subject-level variances (interactions can only
be estimated for the KD = KC = 2 LC model). All models provided marginal evidence
to support smoking at baseline as contributing to higher risk of severe hot ﬂash; this
evidence was somewhat weaker under the LC model than under the MSRE model
due to somewhat greater uncertainty in the smoking effect. Baseline BMI was not
found to be important to the risk of severe hot ﬂash under any model.
2.4.1
Model Fit and Model Checking
For ﬁnal joint MSRE and LC models with KD = 1,KC = 2, the resulting his-
tograms of the 245 PPD p values shown in Figure 2.3 indicate good ﬁt of the LOWESS
mean detrended log(FSH) values. The PPD p values range from 0.06 to 0.94 with me-
dian 0.53 under MSRE model and range from 0.09 to 0.92 with median 0.53 under
the LC model. The top row in Figure 2.7 shows three randomly selected individual
ﬁts with PPD p values between 0.1 and 0.9, where both MSRE and LC models lead
to almost identical and fairly good ﬁts by visual inspection; the bottom row in Figure
2.7 shows the total three individual ﬁts with PPD p values less than 0.1 or greater
than 0.9 under either model, indicating that the small PPD p values appear to be
driven by the individual outlying points and large p values are caused by the "almost
perfect" ﬁts. Web Figure 2.8 shows that only about 4% of the points are not covered
by the subject-level posterior predictive intervals under both LC and MSRE models,
again indicating good ﬁt of the longitudinal trajectories except a few outlying obser-
24

vations. For the outcome submodel, the PPD p values are 0.519 and 0.533 under
MSRE and LC models respectively, indicating a good ﬁt to the onset of severe hot
ﬂash.
Further, we found that the MSRE model had somewhat greater predictive power
as assessed by ROC curves (posterior mean of AUC=.685) than the LC model (poste-
rior mean of AUC=.648) (Figure 2.5), although a comparison of AUCs suggests that
the difference in the performance was not clearly delineated (∆AUC is .037 (-0.040,
0.114)). Comparing the posterior mean of MSRE (.679) and LC models (.688) when
KD = KC = 2 suggests that the mean trajectories do carry a modest amount of infor-
mation to predict hot ﬂash experience, since information about the trajectories can
only be used in the LC outcome model when KD > 1.
2.4.2
Summary
In our analysis of FSH and severe hot ﬂash data from Penn ovarian aging study,
there appeared to be weak evidence for two types of subject-level FSH residual trajec-
tories (one “null" with slope and intercept near zero, the other with higher intercept
and increasing values over age), and strong evidence for two clearly distinct underly-
ing clusters of subject-level FSH residual variances (one low, one high). There was no
strong evidence in either model that the mean proﬁle was associated with such risks,
although the MSRE model gave some evidence that subjects with higher predicted
baseline (age 35) residual FSH measures were less likely to experience hot ﬂashes.
However, both the MSRE and LC modeling strategies revealed that higher within-
subject variability (which can be interpreted as larger short-term ﬂuctuations) con-
tributes to signiﬁcantly increased risk of severe hot ﬂash while adjusting for baseline
covariates of smoking and BMI. This important message from the data could have
been overlooked if we had treated variability as a nuisance parameter, as is usually
done even in joint longitudinal predictor/cross-sectional outcome settings.
25

In selecting between the LC and MSRE models for the Penn ovarian aging study
data, measures of model ﬁt give some preference to the MSRE model. Although,
with the variances being the only key predictor outside of baseline smoking status,
their clear separation into two components suggests that, per the simulation results,
both the LC and MSRE modeling strategies will behave well regardless of the true
outcome model generation mechanism.
2.5
Concluding Remarks
The joint LC and SRE models were originally proposed to link the important char-
acteristics or features in the longitudinal mean trajectories to the primary health
outcome of interest. While the joint LC model focuses on the clustering of those fea-
tures (mean proﬁle class), the joint SRE model focuses on the feature itself (random
effect itself). In this paper, we consider an extended version of joint LC and SRE mod-
eling by also considering the latent class in the variance structure. Therefore, our
modeling approach allows discovery of predictive longitudinal features that distin-
guish between short-term variability (deﬁned by variance class) and long-term trend
(deﬁned by mean proﬁle class).
Both LC and MSRE models are built upon different assumptions that are gener-
ally difﬁcult to verify without knowing the truth. However, relatively little attention
has been paid to the potential impact of model misspeciﬁcation in the joint modeling
framework. This work provides guidance concerning the potential impact of choos-
ing the wrong model to link both longitudinal and health outcome data under our
extended LC and MSRE modeling strategy. In particular, we conducted simulation
studies to investigate 1) the performance of LC and MSRE models, and 2) their ro-
bustness to model misspeciﬁcation, when assuming two components in each latent
class–mean proﬁle class and variance class. For the longitudinal parameters, the
MSRE model performed poorly when the components of the latent classes were not
26

well separated, and well when they were; these results were consistent whether the
outcome model data were generated under the MSRE model or the LC model. In
contrast, the LC model outperformed the MSRE model when the components of the
latent classes were not well separated, but was more sensitive to model misspeciﬁ-
cation unless components were well-separated. In terms of the parameter estima-
tion and outcome prediction in the primary outcome model, LC and MSRE modeling
strategy performed differently. First, the MSRE approach was not as sensitive to
small separations of latent classes as LC approach because correct class assignment
is more critical to estimating the outcome model parameters under LC modeling
strategy. Second, the MSRE approach was more robust to model misspeciﬁcation:
it enjoyed smaller elevated biases and maintained more sensible coverage than LC
approach under model misspeciﬁcation, while the misspeciﬁed MSRE AUC measure
was almost identical to the truth while LC approach suffered considerable loss of
predictive power when misspeciﬁed. When the LC model is misspeciﬁed, the loss
of predictive power phenomenon can be explained by the potential loss of informa-
tion when replacing a continuous variable by a discretized version in the regression
analysis. On the other hand, even when the information is fully captured by the cat-
egorical variable (i.e., the MSRE model is misspeciﬁed relative to the LC model), the
use of its continuous version can help fully recover the true information. These two
advantages motivate us to recommend MSRE modeling strategy to achieve the goal
of inference in the primary outcome model. However, the interpretation in MSRE
model is not as easy as LC model, where one can relate the outcome risk to distinct
features identiﬁed by the various latent classes.
This work can be extended in a variety of manners. For example, the assumption
of a simple linear or low-order polynomial function for the longitudinal predictors
could be relaxed to allow for a penalized spline or functional regression model. This
may provide a more non-parametric parsing of “short term” and “long term” subject-
27

level variability, if sufﬁcient data are available at the subject level to allow estimation
of such terms. Also, developing methods to compensate for missing data in both the
longitudinal predictors and outcome measures, particularly under non-missing-at-
random mechanisms, will have practical application as well.
28

-4
-2
0
2
4
6
8
-4
-2
0
2
4
6
scenario 1: mean profile
random intercpet
random slope
4
(2.83,2.83)
(0,0)
-4
-3
-2
-1
0
1
0.0
0.2
0.4
0.6
0.8
scenario 1: variance
log(variance)
density
τ2=.25
-4
-2
0
2
4
6
8
-4
-2
0
2
4
6
scenario 2: mean profile
random intercpet
random slope
4
(2.83,2.83)
(0,0)
-4
-3
-2
-1
0
1
0.0
0.2
0.4
0.6
0.8
scenario 2: variance
log(variance)
density
τ2=.25
-4
-2
0
2
4
6
8
-4
-2
0
2
4
6
scenario 3: mean profile
random intercpet
random slope
4
(2.83,2.83)
(0,0)
-4
-3
-2
-1
0
1
0.0
0.5
1.0
1.5
scenario 3: variance
log(variance)
density
τ2=.06
-4
-2
0
2
4
6
8
-4
-2
0
2
4
6
scenario 4: mean profile
random intercpet
random slope
4
(2.83,2.83)
(0,0)
-4
-3
-2
-1
0
1
0.0
0.5
1.0
1.5
scenario 4: variance
log(variance)
density
τ2=.06
Figure 2.1: Simulation setup for the mean proﬁles and variance classes: left column:
95% contour plots of the two components for mean proﬁle class; right
column: density plots of the two components for variance class (dotted
curves are the density curves for the variances).
29

(a)
False positive rate
True positive rate
0.0
0.2
0.4
0.6
0.8
1.0
0.0
0.2
0.4
0.6
0.8
1.0
AUC_truth:0.83
AUC_assumed:0.64
AUC_LC:0.96
AUC_MSRE:0.84
0.0
0.2
0.4
0.6
0.8
1.0
0.0
0.2
0.4
0.6
0.8
1.0
(b)
true Pr(o=1)
predicted Pr(o=1)
assumed
LC
MSRE
(c)
False positive rate
True positive rate
0.0
0.2
0.4
0.6
0.8
1.0
0.0
0.2
0.4
0.6
0.8
1.0
AUC_truth:0.85
AUC_assumed:0.65
AUC_LC:0.61
AUC_MSRE:0.86
0.0
0.2
0.4
0.6
0.8
1.0
0.0
0.2
0.4
0.6
0.8
1.0
(d)
true Pr(o=1)
predicted Pr(o=1)
assumed
LC
MSRE
Figure 2.2: Two typical ROC’s when the truth is joint MSRE model: (a) and (b) are
from the data set where “artiﬁcial mean clusters” are created by joint
LC model; (c) and (d) are from the data set when an almost empty mean
cluster is created by joint LC model. Note: “assumed” refers to the ML
estimates of LC probit submodel given known class memberships.
30

35
40
45
50
55
60
−1
0
1
2
3
4
5
(a)
age
log(fsh)
(b)
detrended log(fsh)
Frequency
−4
−3
−2
−1
0
1
2
3
0
500
1000
1500
Figure 2.3: (a) Estimated population longitudinal trend by lowess; (b) histogram of
detrended log(FSH).
31

35
40
45
50
55
60
−1.5
−0.5
0.5
1.5
(a) Mean Profile
age
detrended log(FSH)
mean=(0.04,0.11)
(b)
log(σ^
i
2)
Density
−3.0
−2.0
−1.0
0.0
0.0
0.4
0.8
1.2
G
G
variance
class 1
(23%)
variance
class 2
(77%)
35
40
45
50
55
60
−1.5
−0.5
0.5
1.5
(c) Mean Profile
age
detrended log(FSH)
mean=(0.04,0.11)
(d)
log(σ^
i
2)
Density
−3.0
−2.0
−1.0
0.0
0.0
0.4
0.8
1.2
G
G
variance
class 1
(21%)
variance
class 2
(79%)
Figure 2.4: Posterior pointwise 95% credible intervals for the mean proﬁle classes
and the histograms of log-variances with KD = 1,KC = 2: (a) and (c): un-
der joint MSRE model and (b) and (d): under joint LC model.
32

0.0
0.2
0.4
0.6
0.8
1.0
0.0
0.2
0.4
0.6
0.8
1.0
False positive rate
True positive rate
joint MSRE
joint LC
Figure 2.5: Posterior average of the receiver operating characteristic (ROC) curves
under joint MSRE model (average AUC=0.685 with 95% CI (0.632,
0.736)) and joint LC model (average AUC=0.648 with 95% CI (0.590,
0.699)) both with KD1,KC = 2 in the analysis of Penn ovarian aging data.
33

joint MSRE
posterior predictive p−values
Frequency
0.0
0.2
0.4
0.6
0.8
1.0
0
10
20
30
40
50
joint LC
posterior predictive p−values
Frequency
0.0
0.2
0.4
0.6
0.8
1.0
0
10
20
30
40
50
Figure 2.6: Posterior predictive p values under joint LC and MSRE models with KD =
1,KC = 2.
34

G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
42
44
46
48
50
52
−1.0
0.0
0.5
1.0
1.5
2.0
age
detrended log(fsh)
G
G
GG
G
G
G
G
GG
G
G
G
G
G
G
36
38
40
42
44
−1.0
0.0
0.5
1.0
1.5
2.0
age
detrended log(fsh)
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
GG
46
48
50
52
−1.0
−0.5
0.0
0.5
1.0
age
detrended log(fsh)
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
GG
38
40
42
44
46
48
−1.0
0.0
0.5
1.0
1.5
2.0
age
detrended log(fsh)
G
G
G
G
G
G
38.0
38.5
39.0
39.5
40.0
−1.0
−0.5
0.0
0.5
1.0
age
detrended log(fsh)
GG
G
G
G
G
G
G
GG
G
G
GG
46
48
50
52
54
56
−3
−2
−1
0
1
age
detrended log(fsh)
G
G
G
G
G
G
G
G
G
G
G
G
GG
G
GG
46
48
50
52
54
56
−4
−3
−2
−1
0
1
age
detrended log(fsh)
Figure 2.7: The individual ﬁts in the analysis of Penn ovarian aging data with solid
line: under joint MSRE model and dashed line: under joint LC model;
top row: 3 randomly selected individual ﬁts with PPD p values between
0.1 or great than 0.9 and bottom row: individuals with PPD p values less
than 0.1 or great than 0.9.
35

35
40
45
50
55
60
−4
−2
0
2
4
joint MSRE: 3.82% not covered by 95% PI
age
detrended log(fsh)
not covered
35
40
45
50
55
60
−4
−2
0
2
4
joint LC: 3.77% not covered by 95% PI
age
not covered
Figure 2.8: Scatter plot of detrended log(FSH) versus age with red points not being
covered by subject-speciﬁc 95% posterior predictive intervals with KD =
1,KC = 2 in models for the analysis of Penn ovarian aging data: left: joint
MSRE models and right: joint LC models.
36

Table 2.1: Simulation results from 100 datasets of size, n = 200.
(a) Generated from longitudinal scenario # 1
True LC structure
True MSRE structure
Assumed
95%
95%
Structure
TRUE
BIAS
SD
RMSE
COV
TRUE
BIAS
SD
RMSE
COV
LC
θ0
−0.80
−0.65
0.50
0.82
0.89
−0.40
−1.00
1.13
1.51
0.35
θ1
1.80
0.61
0.66
0.90
0.88
−0.11
2.40
2.34
3.35
0.35
θ2
−0.20
0.20
0.69
0.72
0.98
0.53
1.64
1.76
2.41
0.36
θ3
−0.30
−0.28
0.82
0.87
0.97
0.16
−3.69
3.73
5.24
0.35
MSRE
γ0
−0.32
0.00
0.21
0.21
0.95
−1.00
0.19
0.24
0.30
0.92
γ1
0.20
0.01
0.11
0.11
0.96
1.00
−0.09
0.16
0.18
0.95
γ2
0.18
−0.01
0.11
0.11
0.96
−1.00
0.04
0.17
0.18
0.96
γ3
−0.22
−0.15
0.60
0.62
0.92
2.00
−0.52
0.58
0.78
0.87
γ4
−0.04
0.01
0.32
0.32
0.93
−2.00
0.29
0.36
0.46
0.90
γ5
−0.04
0.06
0.30
0.30
0.94
2.00
−0.14
0.38
0.41
0.95
(b) Generated from longitudinal scenario # 2
True LC structure
True MSRE structure
Assumed
95%
95%
Structure
TRUE
BIAS
SD
RMSE
COV
TRUE
BIAS
SD
RMSE
COV
LC
θ0
−0.80
−0.06
0.25
0.25
0.98
−0.48
−0.19
0.30
0.36
0.89
θ1
1.80
0.13
0.37
0.39
0.98
0.06
0.03
0.45
0.45
0.92
θ2
−0.20
−0.07
0.52
0.52
0.96
0.65
0.52
0.66
0.84
0.84
θ3
−0.30
−0.05
0.69
0.69
0.96
−0.08
−0.09
0.91
0.92
0.87
MSRE
γ0
−0.66
0.01
0.24
0.24
0.98
−1.00
0.07
0.24
0.25
0.97
γ1
0.28
−0.02
0.12
0.12
0.96
1.00
−0.05
0.17
0.17
0.94
γ2
0.28
0.02
0.11
0.11
0.94
−1.00
0.02
0.17
0.17
0.93
γ3
−0.22
−0.28
0.56
0.62
0.97
2.00
−0.33
0.59
0.68
0.96
γ4
−0.05
0.12
0.33
0.35
0.89
−2.00
0.17
0.37
0.40
0.95
γ5
−0.05
−0.02
0.29
0.30
0.94
2.00
−0.06
0.39
0.39
0.97
(c) Generated from longitudinal scenario # 3
True LC structure
True MSRE structure
Assumed
95%
95%
Structure
TRUE
BIAS
SD
RMSE
COV
TRUE
BIAS
SD
RMSE
COV
LC
θ0
−0.80
−0.60
0.42
0.74
0.87
−0.41
−1.02
1.15
1.54
0.34
θ1
1.80
0.53
0.55
0.77
0.91
−0.12
2.52
2.28
3.40
0.31
θ2
−0.20
0.10
0.62
0.63
1.00
0.57
1.30
1.50
1.98
0.34
θ3
−0.30
−0.11
0.77
0.77
1.00
0.15
−3.42
3.15
4.65
0.36
MSRE
γ0
−0.28
−0.01
0.20
0.20
0.96
−1.00
0.16
0.22
0.28
0.96
γ1
0.19
0.02
0.13
0.13
0.89
1.00
−0.09
0.15
0.18
0.92
γ2
0.20
0.00
0.14
0.14
0.93
−1.00
0.04
0.16
0.17
0.92
γ3
−0.37
−0.12
0.47
0.49
0.98
2.00
−0.42
0.53
0.68
0.94
γ4
−0.07
−0.10
−0.03
0.34
0.92
−2.00
0.25
0.35
0.43
0.94
γ5
−0.07
−0.04
0.04
0.36
0.93
2.00
−0.10
0.35
0.37
0.96
(d) Generated from longitudinal scenario # 4
True LC structure
True MSRE structure
Assumed
95%
95%
Structure
TRUE
BIAS
SD
RMSE
COV
TRUE
BIAS
SD
RMSE
COV
LC
θ0
−0.80
−0.01
0.19
0.19
0.97
−0.50
−0.05
0.24
0.25
0.91
θ1
1.80
0.00
0.25
0.25
0.99
0.06
0.05
0.30
0.30
0.90
θ2
−0.20
−0.08
0.51
0.52
0.95
0.69
0.10
0.38
0.40
0.94
θ3
−0.30
0.09
0.57
0.58
0.95
−0.08
−0.09
0.49
0.49
0.95
MSRE
γ0
−0.62
−0.01
0.23
0.23
0.98
−1.00
0.14
0.25
0.29
0.93
γ1
0.29
−0.01
0.12
0.12
0.97
1.00
−0.08
0.15
0.17
0.90
γ2
0.29
0.03
0.13
0.13
0.94
−1.00
0.05
0.17
0.18
0.93
γ3
−0.36
−0.16
0.69
0.71
0.95
2.00
−0.44
0.58
0.73
0.93
γ4
−0.09
0.07
0.35
0.35
0.95
−2.00
0.22
0.36
0.43
0.90
γ5
−0.08
−0.02
0.30
0.30
0.97
2.00
−0.10
0.42
0.43
0.94
37

Table 2.2: (a) Mean Area under the ROC curves for the prediction of outcome and (b)
misclassiﬁcation rates for mixture membership. Left columns: data gen-
erated from the LC model; right columns: data generated from the MSRE
model. LC-Assumed refers to AUC results obtained ﬁtting a probit model
using the known latent classes as predictors when the data are generated
under the MSRE model, and similarly MSRE-Assumed refers to AUC re-
sults obtained ﬁtting a probit model using the known random effects and
variances as predictors when the data are generated under the LC model.
“Percentile” refers to the 2.5 and 97.5 percentils of the AUC computed un-
der the true parameters across the simulations; “95% CI” refers to mean
of the lower and upper 95% credible intervals across simulations.
(a) Area under the ROC curves
TRUE: joint LC model
TRUE: joint MSRE model
Scenario
Scenario
# 1
# 2
# 3
# 4
# 1
# 2
# 3
# 4
Truth
mean
0.80
0.81
0.81
0.81
0.84
0.85
0.83
0.84
Percentile
(0.75, 0.86)
(0.75, 0.86)
(0.75, 0.87)
(0.75, 0.86)
(0.79, 0.89)
(0.80, 0.90)
(0.77, 0.88)
(0.78, 0.89)
LC
mean
0.80
0.82
0.80
0.81
0.85
0.69
0.83
0.64
95% CI
(0.58, 0.91)
(0.75, 0.88)
(0.63, 0.92)
(0.75, 0.86)
(0.63, 0.97)
(0.58, 0.82)
(0.60, 0.96)
(0.56, 0.72)
LC
Assumed
mean
—
—
—
—
0.64
0.63
0.65
0.64
95% CI
(0.58, 0.70)
(0.56, 0.70)
(0.58, 0.70)
(0.58, 0.72)
MSRE
mean
0.76
0.80
0.77
0.81
0.84
0.85
0.83
0.83
95% CI
(0.69, 0.83)
(0.73, 0.85)
(0.71, 0.85)
(0.74, 0.86)
(0.79, 0.89)
(0.79, 0.90)
(0.76, 0.88)
(0.77, 0.89)
MSRE
Assumed
mean
0.77
0.80
0.78
0.81
—
—
—
—
95% CI
(0.69, 0.83)
(0.74, 0.85)
(0.72, 0.85)
(0.75, 0.87)
(b) Misclassiﬁcation rates (%) for the mixture component membership
TRUE: joint LC model
TRUE: joint MSRE model
˜D=2|D=1
˜D=1|D=2
˜C=2|C=1
˜C=1|C=2
˜D=2|D=1
˜D=1|D=2
˜C=2|C=1
˜C=1|C=2
Scenario #1
LC
10
2
5
6
19
31
4
8
MSRE
33
0
5
5
32
1
5
6
Scenario #2
LC
0
0
5
6
0
1
5
8
MSRE
0
0
5
6
0
0
5
6
Scenario #3
LC
9
2
1
2
18
32
1
2
MSRE
32
2
1
2
32
2
1
2
Scenario #4
LC
0
0
1
2
1
0
1
2
MSRE
1
0
1
2
1
0
1
2
38

Table 2.3: Model comparison statistics from different joint models for the analysis of
Penn ovarian aging data.
Number
Number of Variance Classes
of Mean
LPML
DIC
Classes
1
2
3
1
2
3
(a) Joint MSRE Model
1
-3825.1
-3838.3
-3845.4
7293.3
7240.1
7433.1
2
-3808.9
-3817.8
-3828.6
7294.9
7249.4
7444.7
3
-3820.7
-3835.3
-3834.6
7377.4
7321.3
7516.2
(b) Joint LC Model
1
-3921.4
-3843.4
-3846.6
7289.8
7245.5
7472.2
2
-3830.2
-3828.3
-3832.4
7291.7
7260.0
7495.9
3
-3855.8
-3846.8
-3842.9
7375.7
7347.6
7567.2
39

Table 2.4: Posterior estimates of the model parameters under joint MSRE and LC models with KD = 1,2 and KC = 1,2 for the
analysis of Penn ovarian aging data.
MSRE Model
LC Model
KD = 1,KC = 2
KD = 2,KC = 2
KD = 1,KC = 2
KD = 2,KC = 2
mean
se
95% CI
mean
se
95% CI
mean
se
95% CI
mean
se
95% CI
β11
0.041
0.031
(-0.02, 0.102)
-0.078
0.045
(-0.167, 0.01)
0.039
0.031
(-0.022, 0.101)
-0.075
0.051
(-0.165, 0.019)
β12
0.111
0.025
(0.061, 0.16)
0.006
0.037
(-0.068, 0.079)
0.109
0.025
(0.06, 0.158)
0.009
0.04
(-0.062, 0.084)
β21
0.158
0.071
(0.025, 0.299)
0.156
0.075
(0.006, 0.309)
β22
0.212
0.058
(0.102, 0.329)
0.201
0.061
(0.083, 0.324)
ω2
11
0.2
0.023
(0.158, 0.249)
0.078
0.022
(0.037, 0.125)
0.201
0.023
(0.159, 0.249)
0.08
0.041
(0.039, 0.132)
ω2
12
0.102
0.013
(0.079, 0.13)
0.045
0.018
(0.013, 0.085)
0.103
0.013
(0.08, 0.132)
0.039
0.021
(0.011, 0.081)
ω2
21
0.334
0.067
(0.226, 0.492)
0.335
0.074
(0.215, 0.497)
ω2
22
0.155
0.036
(0.094, 0.237)
0.171
0.04
(0.102, 0.259)
ρ1
0.667
0.056
(0.549, 0.765)
0.935
0.041
(0.831, 0.983)
0.668
0.057
(0.549, 0.769)
0.913
0.08
(0.759, 0.979)
ρ2
0.46
0.125
(0.185, 0.665)
0.473
0.135
(0.189, 0.693)
πD
1
0.524
0.083
(0.352, 0.677)
0.525
0.086
(0.346, 0.687)
µ1
-2.696
0.145
(-2.989, -2.422)
-2.696
0.149
(-2.999, -2.411)
-2.766
0.158
(-3.086, -2.467)
-2.772
0.165
(-3.1, -2.461)
µ2
-1.134
0.051
(-1.239, -1.037)
-1.141
0.053
(-1.249, -1.038)
-1.158
0.055
(-1.269, -1.053)
-1.168
0.06
(-1.271, -1.064)
τ2
0.16
0.037
(0.098, 0.24)
0.161
0.038
(0.098, 0.245)
0.185
0.042
(0.114, 0.278)
0.186
0.041
(0.117, 0.274)
πC
1
0.227
0.039
(0.153, 0.307)
0.226
0.04
(0.152, 0.306)
0.212
0.039
(0.138, 0.291)
0.209
0.04
(0.138, 0.29)
γ0 (intercept)
-0.471
0.945
(-2.331, 1.372)
-0.546
0.937
(-2.368, 1.284)
γ1 (log(BMI))
-0.064
0.282
(-0.611, 0.488)
-0.041
0.279
(-0.59, 0.506)
γ2 (smoking)
0.374
0.189
(0.004, 0.745)
0.377
0.186
(0.011, 0.744)
γ3(bi0)
-0.949
0.492
(-1.946, -0.012)
-0.809
0.47
(-1.75, 0.072)
γ4(bi1)
0.589
0.581
(-0.546, 1.71)
0.523
0.562
(-0.565, 1.656)
γ5(σ2
i )
1.644
0.596
(0.504, 2.857)
1.708
0.605
(0.548, 2.922)
γ6(bi0 ×σ2
i )
0.138
1.17
(-2.104, 2.442)
0.063
1.146
(-2.107, 2.338)
γ7(bi1 ×σ2
i )
0.644
1.329
(-1.925, 3.209)
0.361
1.324
(-2.21, 2.898)
θ0 (intercept)
-0.911
0.829
(-2.518, 0.679)
-1.429
0.999
(-3.548, 0.396)
θ1 (log(BMI))
-0.026
0.239
(-0.487, 0.441)
-0.088
0.204
(-0.485, 0.306)
θ2 (smoking)
0.334
0.184
(-0.022, 0.694)
0.383
0.204
(-0.009, 0.793)
θ3 (D=2)
1.273
1.369
(-1.442, 4.093)
θ4 (C=2)
1.038
0.362
(0.463, 1.805)
1.928
0.941
(0.527, 4.063)
θ5 (D=2,C=2)
-1.618
1.484
(-4.607, 1.341)
40

Table 2.5: Simulation results from 100 datasets of size, n = 200, generated from lon-
gitudinal scenario # 1 and the primary probit (a) LC, (b) MSRE models.
Left columns: ﬁtted assuming the LC model; right column: ﬁtted assum-
ing the MSRE model.
(a) TRUE: joint LC model
Assumed LC structure
Assumed MSRE structure
TRUE
MEAN
BIAS
SD
RMSE
95% COV
MEAN
BIAS
SD
RMSE
95% COV
β11
0.00
−0.19
−0.19
0.34
0.39
0.91
−0.53
−0.53
0.95
1.08
0.87
β12
0.00
−0.04
−0.04
0.22
0.23
0.96
0.06
0.06
0.36
0.37
0.92
β21
2.83
2.39
−0.44
0.23
0.49
0.40
1.79
−1.04
0.18
1.06
0.00
β22
2.83
2.31
−0.52
0.21
0.56
0.18
1.73
−1.10
0.15
1.11
0.00
ω2
11
2.00
1.83
−0.17
0.62
0.64
0.90
0.60
−1.40
0.63
1.54
0.57
ω2
12
2.00
1.90
−0.10
0.67
0.68
0.89
0.44
−1.56
1.03
1.87
0.19
ω2
21
2.00
2.56
0.56
0.48
0.74
0.74
3.66
1.66
0.38
1.71
0.03
ω2
22
2.00
2.65
0.65
0.52
0.83
0.65
3.75
1.75
0.40
1.79
0.04
ρ1
0.00
−0.12
−0.12
0.22
0.26
0.94
−0.72
−0.72
0.20
0.75
0.80
ρ2
0.60
0.66
0.06
0.06
0.09
0.77
0.69
0.09
0.04
0.10
0.44
πd
0.35
0.27
−0.08
0.07
0.11
0.78
0.05
−0.30
0.05
0.30
0.03
µ1
−2.00
−1.95
0.05
0.11
0.12
0.98
−1.98
0.02
0.09
0.09
0.99
µ2
−0.50
−0.61
−0.11
0.22
0.25
0.87
−0.58
−0.08
0.19
0.20
0.90
τ2
0.25
0.33
0.08
0.12
0.14
0.90
0.30
0.05
0.10
0.11
0.95
πc
0.65
0.63
−0.02
0.05
0.06
0.97
0.63
−0.02
0.04
0.05
0.98
θ0
−0.80
−1.45
−0.65
0.50
0.82
0.89
θ1
1.80
2.41
0.61
0.66
0.90
0.88
θ2
−0.20
0.00
0.20
0.69
0.72
0.98
θ3
−0.30
−0.58
−0.28
0.82
0.87
0.97
γ0
−0.32
−0.32
0.00
0.21
0.21
0.95
γ1
0.19
0.20
0.01
0.11
0.11
0.96
γ2
0.18
0.17
−0.01
0.11
0.11
0.96
γ3
−0.22
−0.38
−0.15
0.60
0.62
0.92
γ4
−0.04
−0.02
0.01
0.32
0.32
0.93
γ5
−0.04
0.02
0.06
0.30
0.30
0.94
(b) TRUE: joint MSRE model
Assumed LC structure
Assumed MSRE structure
TRUE
MEAN
BIAS
SD
RMSE
95% COV
MEAN
BIAS
SD
RMSE
95% COV
β11
0.00
0.85
0.85
0.91
1.25
0.33
−0.53
−0.53
1.03
1.16
0.85
β12
0.00
1.27
1.27
0.95
1.59
0.36
0.13
0.13
0.45
0.47
0.87
β21
2.83
2.02
−0.81
0.29
0.86
0.14
1.81
−1.02
0.25
1.05
0.02
β22
2.83
1.05
−1.78
0.57
1.87
0.00
1.69
−1.14
0.33
1.18
0.00
ω2
11
2.00
2.78
0.78
1.69
1.87
0.24
0.70
−1.30
0.87
1.56
0.57
ω2
12
2.00
2.28
0.28
1.43
1.46
0.16
0.49
−1.51
1.08
1.86
0.18
ω2
21
2.00
3.26
1.26
0.58
1.39
0.38
3.60
1.60
0.54
1.69
0.06
ω2
22
2.00
4.07
2.07
0.63
2.16
0.06
3.70
1.70
0.55
1.79
0.06
ρ1
0.00
0.25
0.25
0.71
0.75
0.32
−0.71
−0.71
0.27
0.76
0.74
ρ2
0.60
0.77
0.17
0.08
0.19
0.29
0.68
0.08
0.13
0.15
0.46
πd
0.35
0.46
0.11
0.31
0.33
0.03
0.07
−0.28
0.13
0.31
0.04
µ1
−2.00
−1.93
0.07
0.08
0.10
0.86
−1.97
0.03
0.08
0.09
1.00
µ2
−0.50
−0.47
0.03
0.15
0.16
0.90
−0.56
−0.06
0.18
0.19
0.91
τ2
0.25
0.30
0.05
0.08
0.10
0.93
0.30
0.05
0.09
0.10
0.93
πc
0.65
0.67
0.02
0.04
0.05
0.92
0.63
−0.02
0.04
0.05
0.98
θ0
−0.40
−1.40
−1.00
1.13
1.51
0.35
θ1
−0.11
2.29
2.40
2.34
3.35
0.35
θ2
0.53
2.17
1.64
1.76
2.41
0.36
θ3
0.16
−3.53
−3.69
3.73
5.24
0.35
γ0
−1.00
−0.81
0.19
0.24
0.30
0.92
γ1
1.00
0.91
−0.09
0.16
0.18
0.95
γ2
−1.00
−0.96
0.04
0.17
0.18
0.96
γ3
2.00
1.48
−0.52
0.58
0.78
0.87
γ4
−2.00
−1.71
0.29
0.36
0.46
0.90
γ5
2.00
1.86
−0.14
0.38
0.41
0.95
41

Table 2.6: Simulation results from 100 datasets of size, n = 200, generated from lon-
gitudinal scenario # 2 and the primary probit (a) LC, (b) MSRE models.
Left columns: ﬁtted assuming the LC model; right column: ﬁtted assum-
ing the MSRE model.
(a) TRUE: joint LC model
Assumed LC structure
Assumed MSRE structure
TRUE
MEAN
BIAS
SD
RMSE
95% COV
MEAN
BIAS
SD
RMSE
95% COV
β11
0.00
0.01
0.01
0.13
0.13
0.93
0.01
0.01
0.13
0.13
0.94
β12
0.00
−0.02
−0.02
0.11
0.11
0.98
−0.02
−0.02
0.11
0.11
0.99
β21
2.83
2.91
0.08
0.09
0.12
0.89
2.91
0.08
0.09
0.12
0.89
β22
2.83
2.69
−0.14
0.09
0.17
0.64
2.69
−0.14
0.09
0.17
0.65
ω2
11
1.00
0.99
−0.01
0.16
0.16
0.98
0.99
−0.01
0.16
0.16
0.97
ω2
12
1.00
1.03
0.03
0.19
0.19
0.93
1.03
0.03
0.20
0.20
0.93
ω2
21
1.00
0.99
−0.01
0.14
0.14
0.92
0.99
−0.01
0.15
0.15
0.89
ω2
22
1.00
1.01
0.01
0.12
0.12
0.97
1.01
0.01
0.12
0.12
0.96
ρ1
0.00
0.00
0.00
0.12
0.12
0.98
0.00
0.00
0.12
0.12
0.98
ρ2
−0.60
−0.59
0.01
0.07
0.07
0.93
−0.59
0.01
0.07
0.07
0.93
πd
0.35
0.35
0.00
0.03
0.03
0.94
0.35
0.00
0.03
0.03
0.93
µ1
−2.00
−1.95
0.05
0.11
0.12
0.97
−1.99
0.01
0.08
0.08
0.98
µ2
−0.50
−0.62
−0.12
0.21
0.24
0.93
−0.56
−0.06
0.15
0.17
0.93
τ2
0.25
0.33
0.08
0.13
0.15
0.91
0.29
0.04
0.09
0.10
0.92
πc
0.65
0.63
−0.02
0.05
0.05
0.97
0.63
−0.02
0.05
0.05
0.97
θ0
−0.80
−0.86
−0.06
0.25
0.25
0.98
θ1
1.80
1.93
0.13
0.37
0.39
0.98
θ2
−0.20
−0.27
−0.07
0.52
0.52
0.96
θ3
−0.30
−0.35
−0.05
0.69
0.69
0.96
γ0
−0.66
−0.65
0.01
0.24
0.24
0.98
γ1
0.28
0.26
−0.02
0.12
0.12
0.96
γ2
0.28
0.30
0.02
0.11
0.11
0.94
γ3
−0.22
−0.49
−0.28
0.56
0.62
0.97
γ4
−0.05
0.07
0.12
0.33
0.35
0.89
γ5
−0.05
−0.07
−0.02
0.29
0.30
0.94
(b) TRUE: joint MSRE model
Assumed LC structure
Assumed MSRE structure
TRUE
MEAN
BIAS
SD
RMSE
95% COV
MEAN
BIAS
SD
RMSE
95% COV
β11
0.00
0.02
0.02
0.17
0.17
0.93
0.01
0.01
0.13
0.13
0.94
β12
0.00
−0.01
−0.01
0.18
0.18
0.98
−0.02
−0.02
0.11
0.11
0.99
β21
2.83
2.91
0.08
0.12
0.14
0.88
2.91
0.08
0.09
0.12
0.89
β22
2.83
2.68
−0.14
0.12
0.19
0.65
2.69
−0.14
0.09
0.17
0.65
ω2
11
1.00
1.00
0.00
0.18
0.18
0.96
0.99
−0.01
0.16
0.16
0.97
ω2
12
1.00
1.06
0.06
0.34
0.35
0.91
1.03
0.03
0.20
0.20
0.92
ω2
21
1.00
0.98
−0.02
0.16
0.16
0.89
0.99
−0.01
0.15
0.15
0.91
ω2
22
1.00
1.00
0.00
0.14
0.14
0.94
1.01
0.01
0.12
0.12
0.95
ρ1
0.00
0.01
0.01
0.13
0.13
0.97
0.01
0.01
0.12
0.12
0.97
ρ2
−0.60
−0.59
0.01
0.07
0.07
0.93
−0.59
0.01
0.07
0.07
0.95
πd
0.35
0.36
0.01
0.05
0.05
0.92
0.35
0.00
0.03
0.03
0.93
µ1
−2.00
−1.94
0.06
0.10
0.11
0.95
−1.99
0.01
0.08
0.08
0.97
µ2
−0.50
−0.55
−0.05
0.17
0.18
0.92
−0.54
−0.04
0.15
0.16
0.93
τ2
0.25
0.33
0.08
0.11
0.14
0.87
0.29
0.04
0.09
0.10
0.92
πc
0.65
0.65
0.00
0.05
0.05
0.96
0.63
−0.02
0.05
0.05
0.98
θ0
−0.48
−0.68
−0.19
0.30
0.36
0.89
θ1
0.06
0.09
0.03
0.45
0.45
0.92
θ2
0.65
1.17
0.52
0.66
0.84
0.84
θ3
−0.08
−0.18
−0.09
0.91
0.92
0.87
γ0
−1.00
−0.93
0.07
0.24
0.25
0.97
γ1
1.00
0.95
−0.05
0.17
0.17
0.94
γ2
−1.00
−0.98
0.02
0.17
0.17
0.93
γ3
2.00
1.67
−0.33
0.59
0.68
0.96
γ4
−2.00
−1.83
0.17
0.37
0.40
0.95
γ5
2.00
1.94
−0.06
0.39
0.39
0.97
42

Table 2.7: Simulation results from 100 datasets of size, n = 200, generated from lon-
gitudinal scenario # 3 and the primary probit (a) LC, (b) MSRE models.
Left columns: ﬁtted assuming the LC model; right column: ﬁtted assum-
ing the MSRE model.
(a) TRUE: joint LC model
Assumed LC structure
Assumed MSRE structure
TRUE
MEAN
BIAS
SD
RMSE
95% COV
MEAN
BIAS
SD
RMSE
95% COV
β11
0.00
−0.14
−0.14
0.27
0.31
0.91
−0.49
−0.49
1.11
1.21
0.80
β12
0.00
−0.04
−0.04
0.20
0.20
0.97
0.12
0.12
0.54
0.55
0.81
β21
2.83
2.44
−0.39
0.20
0.44
0.47
1.81
−1.02
0.28
1.06
0.06
β22
2.83
2.34
−0.49
0.19
0.53
0.22
1.66
−1.17
0.43
1.25
0.01
ω2
11
2.00
1.88
−0.12
0.54
0.56
0.96
0.68
−1.32
0.91
1.61
0.48
ω2
12
2.00
1.93
−0.07
0.55
0.55
0.95
0.38
−1.62
0.94
1.87
0.16
ω2
21
2.00
2.49
0.49
0.48
0.68
0.80
3.62
1.62
0.61
1.73
0.08
ω2
22
2.00
2.61
0.61
0.51
0.79
0.71
3.69
1.69
0.68
1.82
0.02
ρ1
0.00
−0.10
−0.10
0.23
0.25
0.93
−0.71
−0.71
0.30
0.77
0.68
ρ2
0.60
0.65
0.05
0.06
0.08
0.86
0.66
0.06
0.20
0.21
0.43
πd
0.35
0.28
−0.07
0.07
0.09
0.76
0.07
−0.28
0.15
0.32
0.02
µ1
−2.00
−2.00
0.00
0.04
0.04
0.95
−2.00
0.00
0.04
0.04
0.96
µ2
−0.50
−0.50
0.00
0.06
0.06
0.95
−0.51
−0.01
0.06
0.06
0.91
τ2
0.06
0.06
0.00
0.02
0.02
0.89
0.06
0.00
0.02
0.02
0.94
πc
0.65
0.65
0.00
0.03
0.03
0.96
0.65
0.00
0.03
0.03
0.97
θ0
−0.80
−1.40
−0.60
0.42
0.74
0.87
θ1
1.80
2.33
0.53
0.55
0.77
0.91
θ2
−0.20
−0.10
0.10
0.62
0.63
1.00
θ3
−0.30
−0.41
−0.11
0.77
0.77
1.00
γ0
−0.28
−0.30
−0.01
0.20
0.20
0.96
γ1
0.19
0.22
0.02
0.13
0.13
0.89
γ2
0.20
0.20
0.00
0.14
0.14
0.93
γ3
−0.37
−0.49
−0.12
0.47
0.49
0.98
γ4
−0.07
−0.10
−0.03
0.34
0.34
0.92
γ5
−0.07
−0.04
0.04
0.36
0.36
0.93
(b) TRUE: joint MSRE model
Assumed LC structure
Assumed MSRE structure
TRUE
MEAN
BIAS
SD
RMSE
95% COV
MEAN
BIAS
SD
RMSE
95% COV
β11
0.00
0.77
0.77
1.15
1.39
0.26
−0.50
−0.50
1.01
1.12
0.79
β12
0.00
1.26
1.26
0.93
1.57
0.30
0.14
0.14
0.52
0.54
0.80
β21
2.83
2.02
−0.80
0.27
0.85
0.13
1.81
−1.02
0.27
1.06
0.04
β22
2.83
1.03
−1.80
0.62
1.90
0.01
1.65
−1.18
0.47
1.27
0.01
ω2
11
2.00
2.85
0.85
1.67
1.88
0.24
0.68
−1.32
0.81
1.55
0.46
ω2
12
2.00
2.39
0.39
1.44
1.49
0.13
0.42
−1.58
1.04
1.89
0.15
ω2
21
2.00
3.14
1.14
0.82
1.40
0.40
3.61
1.61
0.71
1.76
0.08
ω2
22
2.00
3.98
1.98
0.91
2.18
0.12
3.66
1.66
0.77
1.83
0.03
ρ1
0.00
0.31
0.31
0.68
0.75
0.29
−0.70
−0.70
0.30
0.76
0.67
ρ2
0.60
0.73
0.13
0.24
0.27
0.26
0.65
0.05
0.24
0.25
0.41
πd
0.35
0.48
0.13
0.31
0.34
0.05
0.08
−0.27
0.16
0.32
0.02
µ1
−2.00
−1.99
0.01
0.04
0.04
0.96
−2.00
0.00
0.04
0.04
0.95
µ2
−0.50
−0.49
0.01
0.06
0.06
0.95
−0.49
0.01
0.06
0.06
0.93
τ2
0.06
0.06
0.00
0.03
0.03
0.91
0.06
0.00
0.02
0.02
0.90
πc
0.65
0.66
0.01
0.03
0.03
0.96
0.65
0.00
0.03
0.03
0.94
θ0
−0.41
−1.43
−1.02
1.15
1.54
0.34
θ1
−0.12
2.40
2.52
2.28
3.40
0.31
θ2
0.57
1.87
1.30
1.50
1.98
0.34
θ3
0.15
−3.27
−3.42
3.15
4.65
0.36
γ0
−1.00
−0.84
0.16
0.22
0.28
0.96
γ1
1.00
0.91
−0.09
0.15
0.18
0.92
γ2
−1.00
−0.96
0.04
0.16
0.17
0.92
γ3
2.00
1.58
−0.42
0.53
0.68
0.94
γ4
−2.00
−1.75
0.25
0.35
0.43
0.94
γ5
2.00
1.90
−0.10
0.35
0.37
0.96
43

Table 2.8: Simulation results from 100 datasets of size, n = 200, generated from lon-
gitudinal scenario # 4 and the primary probit (a) LC, (b) MSRE models.
Left columns: ﬁtted assuming the LC model; right column: ﬁtted assum-
ing the MSRE model.
(a) TRUE: joint LC model
Assumed LC structure
Assumed MSRE structure
TRUE
MEAN
BIAS
SD
RMSE
95% COV
MEAN
BIAS
SD
RMSE
95% COV
β11
0.00
0.00
0.00
0.12
0.12
0.97
−0.01
−0.01
0.12
0.12
0.98
β12
0.00
0.00
0.00
0.11
0.11
0.98
0.00
0.00
0.11
0.11
0.97
β21
2.83
2.90
0.08
0.09
0.12
0.87
2.90
0.07
0.10
0.12
0.85
β22
2.83
2.67
−0.16
0.09
0.18
0.61
2.67
−0.16
0.09
0.18
0.61
ω2
11
1.00
0.98
−0.02
0.19
0.19
0.94
0.98
−0.02
0.19
0.20
0.92
ω2
12
1.00
0.99
−0.01
0.18
0.18
0.92
0.99
−0.01
0.19
0.19
0.92
ω2
21
1.00
1.00
0.00
0.12
0.12
0.95
1.00
0.00
0.12
0.12
0.94
ω2
22
1.00
1.01
0.01
0.13
0.13
0.95
1.01
0.01
0.13
0.13
0.97
ρ1
0.00
0.00
0.00
0.13
0.13
0.97
0.00
0.00
0.13
0.13
0.96
ρ2
−0.60
−0.59
0.01
0.07
0.07
0.92
−0.59
0.01
0.07
0.07
0.94
πd
0.35
0.36
0.01
0.03
0.04
0.96
0.36
0.01
0.03
0.04
0.96
µ1
−2.00
−2.00
0.00
0.04
0.04
0.96
−2.00
0.00
0.04
0.04
0.96
µ2
−0.50
−0.50
0.00
0.06
0.06
0.93
−0.50
0.00
0.07
0.07
0.91
τ2
0.06
0.06
0.00
0.02
0.02
0.93
0.06
0.00
0.02
0.02
0.91
πc
0.65
0.64
−0.01
0.04
0.04
0.94
0.64
−0.01
0.04
0.04
0.92
θ0
−0.80
−0.81
−0.01
0.19
0.19
0.97
θ1
1.80
1.80
0.00
0.25
0.25
0.99
θ2
−0.20
−0.28
−0.08
0.51
0.52
0.95
θ3
−0.30
−0.21
0.09
0.57
0.58
0.95
γ0
−0.62
−0.64
−0.01
0.23
0.23
0.98
γ1
0.29
0.28
−0.01
0.12
0.12
0.97
γ2
0.29
0.31
0.03
0.13
0.13
0.94
γ3
−0.36
−0.52
−0.16
0.69
0.71
0.95
γ4
−0.09
−0.02
0.07
0.35
0.35
0.95
γ5
−0.08
−0.10
−0.02
0.30
0.30
0.97
(b) TRUE: joint MSRE model
Assumed LC structure
Assumed MSRE structure
TRUE
MEAN
BIAS
SD
RMSE
95% COV
MEAN
BIAS
SD
RMSE
95% COV
β11
0.00
0.00
0.00
0.12
0.12
0.96
−0.01
−0.01
0.12
0.12
0.96
β12
0.00
0.00
0.00
0.11
0.11
0.97
0.00
0.00
0.11
0.11
0.97
β21
2.83
2.90
0.07
0.10
0.12
0.84
2.90
0.07
0.10
0.12
0.85
β22
2.83
2.67
−0.16
0.09
0.18
0.59
2.67
−0.16
0.09
0.18
0.60
ω2
11
1.00
0.98
−0.02
0.20
0.20
0.93
0.98
−0.02
0.19
0.20
0.94
ω2
12
1.00
0.99
−0.01
0.19
0.19
0.92
0.99
−0.01
0.19
0.19
0.92
ω2
21
1.00
1.00
0.00
0.13
0.13
0.95
1.00
0.00
0.12
0.12
0.95
ω2
22
1.00
1.01
0.01
0.13
0.14
0.95
1.01
0.01
0.13
0.13
0.97
ρ1
0.00
0.00
0.00
0.13
0.13
0.98
0.00
0.00
0.13
0.13
0.96
ρ2
−0.60
−0.59
0.01
0.07
0.07
0.94
−0.59
0.01
0.07
0.07
0.94
πd
0.35
0.36
0.01
0.03
0.04
0.96
0.36
0.01
0.03
0.04
0.96
µ1
−2.00
−1.99
0.01
0.04
0.04
0.96
−1.99
0.01
0.04
0.04
0.96
µ2
−0.50
−0.49
0.01
0.06
0.06
0.94
−0.49
0.01
0.06
0.06
0.94
τ2
0.06
0.06
0.00
0.02
0.02
0.94
0.07
0.01
0.02
0.02
0.91
πc
0.65
0.65
0.00
0.04
0.04
0.92
0.65
0.00
0.04
0.04
0.94
θ0
−0.50
−0.55
−0.05
0.24
0.25
0.91
θ1
0.06
0.11
0.05
0.30
0.30
0.90
θ2
0.69
0.79
0.10
0.38
0.40
0.94
θ3
−0.08
−0.16
−0.09
0.49
0.49
0.95
γ0
−1.00
−0.86
0.14
0.25
0.29
0.93
γ1
1.00
0.92
−0.08
0.15
0.17
0.90
γ2
−1.00
−0.95
0.05
0.17
0.18
0.93
γ3
2.00
1.56
−0.44
0.58
0.73
0.93
γ4
−2.00
−1.78
0.22
0.36
0.43
0.90
γ5
2.00
1.90
−0.10
0.42
0.43
0.94
44

CHAPTER III
Modeling Short- and Long-Term Characteristics of
Follicle Stimulating Hormone as Predictors of
Severe Hot Flashes in Penn Ovarian Aging Study
3.1
Introduction
The Penn Ovarian Aging Study (Manson et al., 2001) is a longitudinal study con-
sisting of a population based sample of 436 women aged 35-47 years selected via ran-
dom digit dialing in Philadelphia County, PA during 1996-97. The study goal is to
explore the associations between reproductive hormone levels and symptoms in the
transition to menopause. Follicle stimulating hormone (FSH) is of particular inter-
est because it is known to stimulate folliculogenesis, an important factor in ovarian
aging. Thus there has been interest in using longitudinal FSH information to deﬁne
menopause transition stages as discussed by Sowers et al. (2008). For example, it
is well accepted that increasing FSH is an indicator of ovarian aging. However, the
FSH levels are not consistently elevated throughout the whole period of late repro-
ductive years. Sowers et al. (2008) found both acceleration and deceleration periods
in the gradually increasing FSH levels for a group of women from the late reproduc-
tive years. Exploratory analysis of the FSH data in the Penn Ovarian Aging Study
shows both acute and gradual increase periods of FSH levels of the population level.
45

It is therefore of clinical interest to investigate whether elevated FSH levels signal
risks of severe menopausal symptoms. Moreover, clinicians also want to quantify
the cumulative impact of the FSH histories on the severity of the menopausal symp-
toms (e.g., hot ﬂashes). To meet these aims, we develop a joint modeling method
that accommodates individual contributions of means, time-varying change rates in
the long-term trends, and short-term residual variabilities as predictors of health
outcomes of interest.
Joint models of longitudinal and health outcome data (mostly time-to-event) have
been extensively developed in the literature. The early developments of such joint
models were mainly motivated by HIV/AIDS clinical trials and cancer research (Tsi-
atis et al.,1995; Muth ´en and Shedden, 1999; Wang and Taylor, 2001; Law et al., 2002;
Song et al. 2002; Brown and Ibrahim, 2003a, 2003b; Ibrahim et al., 2004; Yu et al.,
2008, among many others). For example, interest has focused on using the “true”
underlying longitudinal process (i.e., mean proﬁle) of CD4 or viral load trajectories
to relate to the time to progression to AIDS or death. It is therefore natural to model
both the observed longitudinal trajectories and disease outcome jointly to gain more
efﬁcient inference results, where a longitudinal submodel in the form of a mixed
effect model is outlined for the observed longitudinal trajectories and a primary dis-
ease outcome model is deﬁned to link the “true” underlying longitudinal process and
disease outcome together. Most of these developments have focused on using 1) a
summary of important features in the longitudinal proﬁles, such as the random ef-
fects (REs) and the latent classes (LCs); or 2) the last available “true” value (i.e., a
function form of REs) as a time dependent covariate, with the earlier values being
considered irrelevant to the outcome of interest. These early joint modeling strate-
gies were built assuming that the mean proﬁle was the only feature in the “true”
underlying longitudinal process that could predict a disease outcome. The residual
variation in the longitudinal proﬁle was treated as a nuisance parameter and as-
46

sumed not to inﬂuence the disease progression. Thorough reviews of the topic are
given by Ibrahim et al. (2010) and Rizopoulos (2012). For a comparison of using REs
versus LCs, please see Proust-Lima et al. (2012) and Chapter II of this dissertation.
Recently, Elliott et al. (2012) and we in Chapter II proposed new methods to link
the features in not only the mean proﬁles but also residual variation in the longitu-
dinal trajectories to predict a disease outcome. However, these existing methods did
not consider the potential time varying effects of the dynamic process in longitudinal
trajectories.
In this work, we extend these existing approaches by borrowing the idea of relat-
ing scalar response and functional predictors in functional data analysis paradigm.
Here, we treat the mean longitudinal trajectories as functional predictors linked to
the health outcome through a standard functional regression model in the sense of
Ramsay and Dalzell (1991) and James (2002) among many others. This modeling
strategy implicitly allows the effects of FSH histories (i.e., FSH values up to a par-
ticular time point) that are represented by a functional coefﬁcient curve to be time
varying and accumulative over time. To the best of our knowledge, such a modeling
strategy has not been considered in the joint modeling literature. To estimate the
functional coefﬁcient curve, we propose to use a Bayesian penalized spline approach.
The advantage is that it also allows for simultaneous evaluation of the uncertainty of
the estimated functional coefﬁcient curves by providing pointwise Bayesian credible
intervals, which leads to easy identiﬁcation of critical time windows of increased risk
of health outcome of interest, while in standard functional regression, such intervals
are typically obtained by bootstrap methods.
For the longitudinal submodel development, the proposed work also extends that
of Jiang et al. (2013), who focused on using the latent growth curve features de-
rived from each individual’s linear deviation from a population trend as predictors
of a health outcome. A key contribution from that paper is to make contrast of pros
47

and cons of the use of latent classes and multiple shared random effects in joint
mixture modeling under correctly or incorrectly speciﬁed models. Consequently, the
focus differs from this work in terms of exploring model ﬂexibility. Although the
posterior predictive checking from Jiang et al. (2013) indicated adequate ﬁt for the
majority of the individual FSH trajectories, in the current work we explore more
ﬂexible ways of modeling FSH trajectories that can accommodate potentially time
varying rates of change, as well as t- rather than just normal distributions to avoid
the potential inﬂuence of outlying observations. In particular, we consider a robust
semiparametric model using Bayesian penalized B splines, which were developed by
Lang and Brezger (2004) as a Bayesian version of the penalized splines proposed by
Eilers and Marx (1996). In contrast to fully parametric splines, penalized splines
are not as sensitive to the exact number and location of the knots as long as enough
knots are being used, since “unnecessary” knots will be smoothed away by shrinking
random effects toward 0. Recently, the penalized spline approach has gained pop-
ularity in smoothing individual curves by associating random effects with a spline
basis in mixed effect models under a frequentist framework. For example, Durban
et al. (2005) modeled the individual heights of children suffering from acute lym-
phoblastic leukemia from a clinical trial conducted at Dana Farber Cancer Institute;
Chen and Wang (2011) considered modeling longitudinal systolic blood pressure data
from Framingham Heart Study. In our work, we explore the use of penalized splines
to smooth longitudinal trajectories in the joint modeling framework. Finally, we in-
crease modeling ﬂexibility in two ways: allowing t-distributed errors and using mix-
tures in mean proﬁles. These extensions allow us to avoid the potential impact of
outlying observations.
In summary, our work brings together advanced statistical ideas including func-
tional data analysis, robust inference and joint longitudinal and outcome modeling
in novel ways:
48

1. It extends conventional functional data analysis to the framework of joint mod-
eling of both the longitudinal (functional predictor) and outcome data, which
allows us to select different aspects of the features in the dynamics of longitu-
dinal process as functional predictors. In particular, we focus on the the values
or the gradients of the mean trajectories at certain time windows as potential
long term functional predictors while also adjusting for the effect of short term
variability captured by the variance of the residuals.
2. It uses ﬂexible mixed effects models with B spline basis and heterogeneity (pre-
cisely, latent classes) in the ﬁrst stage submodel, which allows longitudinal
trajectories of uneven spacing and unequal length to be used as functional pre-
dictors.
3. It allows the effects of FSH histories (values or gradients) to be time varying
and to accumulate over time. Statistical tests of the functional coefﬁcient func-
tion in the primary outcome submodel can then be used to identify critical time
windows where the true association exists. Using a Bayesian approach allows
easy calculation of pointwise credible intervals for the functional coefﬁcient
functions in comparison to frequentist approaches.
4. It uses a robust model to accommodate outlying observations in the longitudi-
nal data.
3.2
The proposed model
In this section, we present our ﬂexible semiparametric model to use functional
regression models for the longitudinal FSH levels to predict the ordinal outcome,
severity of hot ﬂashes.
49

• Longitudinal submodel:
Yi j|bi = µi(ti j)+ϵi j
ϵi j ∼tv(0,σ2
i )
Di ∼Multinomial(πD
i1,...,πD
iKD)
Ci ∼Multinomial(πC
i1,...,πC
iKC)
µi(ti j) =
L
X
l=1
bilφl(ti j)
bi = (bi1,...,biL)′|Di = d ∼N(βd,Σd)
logσ2
i |Ci = c ∼N(µc,τ2)
(3.1)
where Yi j denotes the observed longitudinal FSH values for subject i, i = 1,...,n
at time ti j, j = 1,...,ni, µi j ≡µi(ti j) denotes the mean of Yi j at time ti j and
the vector µi = (µi1,...,µini)T deﬁnes the mean proﬁle or trajectory for subject
i. Note that µi can be interpreted as the mean long term trend for subject i,
so that the vector of the derivatives µ′
i = (µ′
i1,...,µ′
ini)T with respect to time t
measures the degree of change of the trajectory in a long-term fashion.
To ﬂexibly model the mean proﬁle, we use truncated power splines con-
sists of piecewise polynomials of certain order connected at pre-speciﬁed knot
locations (Ruppert et al., 2003). Given the same order and knot locations, trun-
cated power spline and B spline are equivalent in the sense that there exist
unique one-to-one linear transformations between these two sets of basis func-
tions (Ruppert et al., 2003), leading to the same ﬁtted values from these two
splines in the regression setup. However, the B spline is more numerically sta-
ble than the truncated power spline because the B spline basis functions are
almost orthogonal while the truncated power spline basis functions are not.
Therefore, we use B spline basis functions φl(ti j) ≡φl,d(ti j) , l = 1,...,L of de-
50

gree d = 3, where φl,3(ti j) is obtained by the recursion relation:
φl,d(ti j) = ti j −κl
κl+d −κl
φl,d−1(ti j)+
κl+1+d −ti j
κl+d+1 −κl+1
φl+1,d−1(ti j)
for knots at points κ1,...,κL−d−1, where φl,0(ti j) = I(κl ≤ti j ≤κl+1). The number
of interior knots is denoted by Jµ(t), such that PL
l=1 φl(t) = 1 with L = Jµ(t)+d+1.
We defer discussion of selection of knot points to Section 3.2.5. Following Lang
and Brezger (2004), we use a Gaussian random walk prior on the ﬁxed effect
coefﬁcients βd1,...,βdL to penalize large differences among coefﬁcients of the
adjacent spline basis and therefore control the smoothness of the mean proﬁle
curve to avoid potential overﬁtting. The speciﬁc prior distributions are given
in Section 3.2.3. Thus, the vector of ﬁxed effect coefﬁcients βd = (βd1,··· ,βdL)T
determines the shape and also the smoothness of the mean proﬁle for the dth
latent class, deﬁned as fd(ti j) = PL
l=1 βdlφl(ti j), d = 1,··· ,KD. The random co-
efﬁcients bil, l,··· ,L capture the individual deviations from the class speciﬁc
mean proﬁle.
The residual ϵi j denotes the deviation of Yi j from the subject speciﬁc mean
at ti j and is assumed to follow a Student’s t-distribution with v degrees of free-
dom, assuming mean 0 and scale σ2
i . The value of v is assumed to be known.
Thus the variance of Yi j is equal to
v
v−2σ2
i , which can be interpreted as a mea-
surement of short term variability around the mean proﬁle µi(ti j). In the case
of v = ∞, ϵi j is normally distributed with mean 0 and variance σ2
i . To allow for
over-dispersion of the within-subject scale parameter σ2
i , we assume a mixture
of log normal distributions.
• Outcome submodel is speciﬁed conditional on individual longitudinal mean tra-
51

jectories and variances and has the form:
Wi ∼N(ηW
i ,1), i = 1,...,n.
ηW
i = α0 +xTλ0 +
Z
T
µi(t)θ0(t)dt,
Oi = 0 ⇔Wi < ω0,
Oi = s ⇔ωs−1 < Wi ≤γs,s = 1,...,S −1
Oi = S ⇔Wi > ωS−1
(3.2)
where x is a vector of baseline covariates with associated (constant) parameter
λ0, and the functional coefﬁcient function θ0(t) represents the effect of subject
speciﬁc mean trend µi(t) at time t while adjusting for the mean trends at other
time points within the time window T. The purpose of considering the integral
over the chosen time domain T, i.e.,
R
T µi(t)θ0(t)dt is to identify critical time
windows of elevated outcome risks, which have several advantages over simply
summing up over the observed time points ti j, j = 1,...,n. First, longitudinal
observations often have missing values and can be measured at different time
points (known as unbalanced data) and hence summation over the observed
time points becomes problematic. Second, an integral over a chosen time do-
main implicitly uses the information at inﬁnite time points within time window
T while summation only uses the information at ﬁnitely observed time points.
As in the mean proﬁle trajectories, we let θ0(t) = PK0
k=1 ˜θ0kψ0
k(t) for cubic B-
spline basis functions ψ0
k(t), with ˜θ0k following a random walk prior, given in
Section 3.2.3 to avoid overﬁtting. Given that we express µi(t) by bT
i φ(t) and
θ0(t) by ψ0(t)T ˜θ0, thus
R
T µi(t)θ0(t)dt =
R
TbT
i φ(t)ψ0(t)T ˜θ0dt = bT
i G0
T ˜θ0, where
φ(t) is a vector of L basis functions chosen to express µi(t) in the longitudinal
submodel and φ0(t) is a vector of K0 basis functions; G0
T =
R
T φ(t)ψ0(t)Tdt. We
can calculate or numerically evaluate G0
T for any given spline basis functions
52

and the estimation of unknown parameters in the outcome primary model be-
comes fully parametric. For the multinomial probit model, we use the common
constraint for the cutoffs 0 = γ1 ≤··· ≤γS = ∞.
Alternatively, one may postulate that the cumulative changes of the individual
trajectories are potentially predictive of the outcome of interest. To accommodate
such a possibility, we can consider the ﬁrst derivative of µi(t), i.e., µ′
i(t) = ∂µi(t)/∂t
as a functional predictor by taking advantage of the nice properties of B spline of
continuity and write our alternative outcome submodel as follows:
Wi ∼N(ηW
i ,1), i = 1,...,n.
ηW
i = α1 +xTλ1 +
Z
T
µ′
i(t)θ1(t)dt,
Oi = 0 ⇔Wi < γ0,
Oi = s ⇔γs−1 < Wi ≤γs,s = 1,...,S −1
Oi = S ⇔Wi > γS−1
(3.3)
where similarly as for θ0(t), functional coefﬁcient function θ1(t) has the interpreta-
tion of the effect of derivative of mean trend µ′
i(t) at time t while adjusting for the
derivatives of mean trends at other time points within the time window T. To empha-
size the fact that we can use different spline basis functions to express θ1(t), we ex-
press θ1(t) = PK1
k=1 ˜θ1kψ1
k(t) using a different set of B spline basis ψ1(t) = (ψ1
1(t),...,ψ1
K1(t))′
and the associated coefﬁcient vector ˜θ1 = ( ˜θ11,..., ˜θ1K0)′. A penalized approach was
used by requiring a random walk prior on ˜θ1, i.e., ˜θ1l ∼N( ˜θ1l−1,τ2
θ1), k = 2,...,K1. Sim-
ilarly, we have
R
T µ′
i(t)θ1(t)dt =
R
TbT
i φ′(t)ψ1(t)T ˜θ1dt = bT
i G1
T ˜θ1, where φ′(t) = ∂φ(t)/∂t
given φ(t) is a vector of L basis functions chosen to express µi(t) in the longtitudinal
submodel and φ′(t) is a vector of K1 basis functions; G1
T =
R
T φ′(t)ψ1(t)Tdt.
53

3.2.1
Likelihood speciﬁcation
Let φ = (πD
d ,βd, Σd, d = 1,...,KD; πC
c , µc, c = 1,...,KC, τ2, α0, λ0, ˜θ0,γ), where
we assume each parameter in φ has independent prior distribution with the joint
prior distribution denoted by π(φ), and z include all unobserved latent variables, i.e.,
z = (b,σ,C,D)′. The observed data x consists of the longitudinal proﬁles y1,...,yn and
the observed outomes o1,...,on. Then the complete data likelihood of φ based on the
complete data (x,z) is given by
f (x,z|φ) ∝
n
Y
i=1
(
Y
d
·
πd(2π)−p
2 |Σd|−1
2 exp
½
−1
2(bi −βd)′Σd(bi −βd)
¾¸I(Di=d)
Y
c
"
πc(2πτ2)−1
2 σ−2
i exp
(
−
(logσ2
i −µc)2
2τ2
)#I(Ci=c) ni
Y
j=1
p
©
yi j;v,bi,σ2
i
ª
S
Y
s=0
n
Φ(γs −ηW
i )−Φ(γs−1 −ηW
i )
oI(oi=s)
)
π(φ)
(3.4)
where
p
©
yi j;v,bi,σ2
i
ª
=











1
q
2πσ2
i
exp
½
−
¡
yi j−PL
l=1 bilφl(ti j)
¢2
2σ2
i
¾
if v = ∞;
Γ( v+1
2 )
Γ( v
2)
q
πvσ2
i
½
1+ 1
v
¡
yi j−PL
l=1 bilφl(ti j)
¢2
2σ2
i
¾−v+1
2
if v < ∞.
3.2.2
Data augmentation step to impute missing data
Given the minimum number of available repeatedly measured FSH levels in our
ﬁnal sample (ranging between 6 and 26 per woman), we are limited to the number of
knots when choosing cubic B spline basis functions to express µi(ti j). To maximize
the number of knots we can consider, we ﬁll in those with fewer than 26 observations
based on data augmentation within each iteration of Gibbs sampling (Chapter 10
in Little and Rubin, 2002). When assuming missing completely at random (MCAR)
missing data mechanism, this data augmentation procedure proceeds as follows,
54

• draw Y(t+1)
mis from p(Ymis | Φ)
• draw Φ(t+1) from p(Φ | Xobs,Ymis)
where Φ denotes all unknown variables, Ymis denotes the missing longitudinal ob-
servations of FSH levels, and Xobs denotes all observed data including observed lon-
gitudinal observations and primary outcome of interest. The above simulation leads
to draws from the joint distribution of (Φ,Ymis) given observed data Xobs. There-
fore, this procedure leads to the same inference about Φ as when we only focus on
the marginal distribution of Φ given observed data Xobs. However, this trick allows
us to put in more knots to fully take advantage of the penalized spline approach that
is free from knot location selection given enough number of knots.
3.2.3
Prior speciﬁcation
We propose a fully Bayesian approach to estimate model parameters. For the
mixture normal distribution of the random effects, we assume a ﬁrst-order Gaussian
random walk prior as proposed by as Lang and Brezger (2004): βdl ∼N(βd,l−1,τ2
βd),
l = 2,...,L with diffuse prior βd1 ∼N(0,100) for the initial coefﬁcient, and τ2
βd ∼
IG(1,0.005) to control the smoothness of the ﬁtted curves. We do not impose restric-
tions on the structure of the variance-covariance matrix for the random effects Σd. To
avoid problems with unbounded likelihoods in normal mixture models with unstruc-
tured variance-covariance matrices (Day 1969), we use the prior proposed by Kass
and Natarajan (2006): Σd ∼Inverse-Wishart(df = r,Λ), where Λ = r
³Pn
i=1 d
Cov( ˜bi)−1/n
´−1
,
˜bi is given by OLS estimator of bi for subject i and r is the dimension of bi.
For the mixture log normal distribution for the residual variances, we used diffuse
priors: µc ∼N(0,v), τ2 ∼IG(a,b) with v = 1000 and a = b = .001. For the class mem-
bership probabilities, we assume conjugate Dirichlet(4,...,4) on both πC = (πC
1 ,...,πC
KC)
and πD = (πD
1 ,...,πD
KD) (Frühwirth-Schnatter 2006); this is equivalent to assuming a
priori 4 observations in each class, avoiding the existence of empty classes.
55

Lastly, in the probit submodel we assign independent priors N(0,9/4) for the
α0 and every element of λ0; for the coefﬁcients associated with functional coefﬁ-
cient function θ0(t), ˜θ0 = ( ˜θ01,..., ˜θ0K0)′, similarly we use a ﬁrst-order Gaussian ran-
dom walk prior, i.e., ˜θ0k ∼N( ˜θ0k−1,τ2
θ0), k = 2,...,K0 with ˜θ01 ∼N(0,9/4) and τ2
θ0 ∼
IG(1,0.005), where the prior variance 9/4 is chosen to bound the probabilities of oi = 1
to be away from 0 and 1 (Garrett and Zeger, 2000; Elliott et al., 2007 and Neelon et
al., 2011). We put ﬂat uniform priors on γs for s ∉{0,S}, that is, γs ∼Uniform(−∞,∞).
3.2.4
Posterior computation
Gibbs sampling is used to obtain draws from the corresponding posterior distri-
butions. For (α0,λ0, ˜θ | b,σ,o) we use the Albert and Chib (1993) data augmentation
method for probit regression models. The draws of (σ2
i |Ci,µc,γ2,bi,oi,Wi,{yi j}j) for
i = 1,...,n are obtained by the inverse cumulative distribution method. The exact
speciﬁcation of all priors and MCMC sampling procedures are provided in Appendix
B.
Three chains from diverse starting points were run and Gelman-Rubin statis-
tic
p
ˆR (Gelman et al., 2003) (square root of total variance to within-chain variance
ratio) were used to assess the convergence of the MCMC chains. For the popula-
tion level parameters, the maximum
p
ˆR = 1.030 for models assuming less than 3
classes; and when assuming 3 classes for either mean proﬁle or the variance class,
the maximum
p
ˆR = 1.184. For the well-documented issue of "label switching" in
ﬁnite mixture modeling (Redner and Walker 1984), we applied the post-processing
relabeling algorithm (Stephens, 2000) in which all possible permutations of class as-
signments were considered at each iteration of the Gibbs sampler. The permutation
of the class assignment was chosen to maximize the posterior probability so that the
labeling of classes was consistent with the previous assignments. We post-process
our chains using Stephen’s algorithm to untangle the draws for model parameters.
56

All the calculations were performed by calling stand alone C++ codes in R, de-
veloped using an open source C++ library for statistical computation, the Scythe
statistical library (Pemstein et al., 2007), which is available for free download at
http://scythe.wustl.edu.
3.2.5
The choice of the number of classes and number of knots in penalized
splines
We consider the deviance information criterion (DIC), proposed by Spiegelhalter
et al.
(2002) to select both the number of components for the latent classes and
to choose the number of knots in the penalized splines. DIC uses the discrepancy
between the posterior mean of the deviance D(φ) = Eφ
©
−2log f (x | φ) | x
ª
and the
deviance evaluated at the posterior mean D(φ) = −2log f
©
x | E(φ | x)
ª
to estimate the
effective number of degrees of freedom in the model pD. DIC is then given by the
analog of the Akaike Information Criterion (AIC):
DIC(x) = D(φ)+ pD = 2D(φ)−D(φ) = −4Eφ
©
log f (x | φ) | x
ª
+2log f
©
x | E(φ | x)
ª
.
In our setting, f (x | φ) where x = (yobs,o)′ consisting of the fully-observed data is not
available in closed form; instead we use the approach outlined in Celeux et al. (2006)
to obtain
DIC(x) = Ez {DIC(x,z)} = −4Ez,φ
©
log f (x,z | φ) | x
ª
+2Ez
£
log f
©
x,z | Eφ(φ | x,z)
ª
| x
¤
where integration over the latent variables z = (b,σ,C,D,ymis)′ is obtained via nu-
merical methods.
57

3.2.6
Goodness of ﬁt evaluation
We assessed the model goodness of ﬁt to the data in two ways: pivotal discrep-
ancy measures (PDMs) (Yuan and Johnson 2012), which yield an overall goodness-of-
ﬁt measure for both the longitudinal predictor component and the ordinal outcome
component of the joint model, and area under the receiver-operator characteristic
(ROC) curve (AUC), a goodness-of-ﬁt measure focusing on prediction of the ordinal
outcome of interest.
PDMs generalize the pivotal quantities proposed by Johnson (2007); in contrast
to more general posterior predictive distribution measure of ﬁt (Gelman et al., 1996),
they are deﬁned to depend only on the data and the model parameters with a known
distribution. If the model is correctly speciﬁed, the PDMs evaluated at the true pa-
rameter value and the draws from the posterior distribution should have the same
sampling distribution.
Therefore, model adequacy can be tested by treating the
PDMs as a test statistic to obtain a uniformly distributed p value. However, the
posterior samples of PDMs are not independent as they are all derived from the ob-
served data (Johnson, 2004), thus p-value calculation is difﬁcult. Instead, Yuan and
Johnson (2012) focused on the upper bound of p values and hence the upper bound
of a p value being less than 0.05 provided strong evidence of model inadequacy.
For the longitudinal trajectories, we deﬁne subject level PDMs to examine the ﬁt
of longitudinal trajectories, which are constructed in the following steps:
1. For each subject i, deﬁne the standardized residuals zi j = [yi j −µi(ti j)]/σi, j =
1,...,ni.
2. Partition zi j into K groups according to the values of µi(ti j). We choose K = 2
given that the repeated measurements per subject ranges from 6 to 26.
3. If the assumed longitudinal submodel is correct, then ri j = P−1 ¡
yi j;v,µi(ti j
¢
,σ2
i )
is [0,1] uniformly distributed, where P(·) is the corresponding cumulative dis-
58

tribution (CDF) function for yi j. Let nik denote the total number of residuals
in group k for subject i based on the partition in previous step, k = 1,...,K, and
then paritition the interval [0,1] into L sub-intervals of length pl; we would
then expect nikpl CDF transformed ri j’s would fall into each of the L bins. We
consider L = 3 intervals: (0, 1
3], (1
3, 2
3] and (2
3,1] and hence p1 = p2 = p3 = 1
3.
Let ˜oikl denote the observed ri j, j = 1,...,ni in sub-interval l, l = 1,...,L within
group k, then dik(yi,φ) =
L
X
l=1
µ ˜oikl −nikpl
pnikpl
¶2
is χ2 distributed with degrees of
freedom L −1 given that the assumed model is correct.
4. Sum the deﬁned χ2 statistic for each group k, we deﬁne our PDM for each
subject i as
K
X
k=1
dik(y,φ), which is χ2 distributed with degrees of freedom K(L−1)
when the assumed model is correct for subject i.
For the ordinal outcome of interest, our PDM is deﬁned based on realized latent
continuous residuals as considered by Gelman et al. (2000). That is, we deﬁne the
standardized latent residuals ei = Wi −ηW
i
with ηW
i = α0 −xT
i λ0 −
R
T µi(t)θ0(t)dt and
then partition ei into ˜K groups according to the values of ηW
i , where we let ˜K = 10
given our sample size is 235. Next, for Φ−1(ei), i = 1,...,n we calculated PDM for
outcome data by following steps similar to 2 and 3 above for individual trajectories.
Finally, we use repeated posterior draws to obtain the sampling distribution of
PDMs and compute the upper bounds of the p values based on ordered statistics of
PDMs using the equation given in Yuan and Johnson (2012). If the upper bound of p
value is less than 0.05, it provided strong evidence of inadequate ﬁts.
Second, we assessed the prediction of the outcome using receiver-operator char-
acteristic (ROC) curves, in particular the area under the ROC curve (AUC). ROC
curves plot true positive rate (TP) versus false positive rate (FP) for all possible cut-
offs based on predicted P(oi = s) = Φ(Z′
iη) obtained from (3.2) for s = 0,...,S. The ROC
curve and AUC were computed at each MCMC iteration using the ROCR package in
R (Sing et al. 2005). The ROC is computed by ordering the observations (i) = 1,...,n so
59

that ˆP(o(i) = 1) ≥ˆP(o(i+1) = 1), computing changepoints c = 2,...,nc, nc ≤n where the
observations change from positive to negative (i.e., o(c−1) = 1, o(c) = 0), and plotting
Pc
(i)=1(1 −o(i))/Pn
(i)=1(1 −o(i)) on the x-axis versus Pc
(i)=1 o(i)/Pn
(i)=1 o(i) on the y-axis.
Area under the ROC is then computed using a trapezoidal approximation. The pos-
terior mean AUC is calculated as the average AUC’s across MCMC iterations. To
obtain the posterior mean and the pointwise 95% credible interval of ROC curve, we
choose 250 points equally spaced along the FP axis and take the vertical average
or 95% quantiles of TP’s at the 250 chosen points. This approach is referred to as
vertical averaging of ROC curves at ﬁxed FP rates by Fawcett (2006).
3.3
Predicting severity of hot ﬂash from longitudinal follicle
stimulating hormone data
In the Penn Ovarian Aging Study, participating women had their hormone mea-
sures taken annually during the early follicular phase of a menstrual cycle for 2
sequential menstrual cycles, with up to 13 years of follow-up available at the time of
our analysis. Hormone values were censored if a woman was pregnant, breast feed-
ing or taking exogenous hormones during the follow-up. This led to the number of
FSH levels available for each woman ranging from 1 to 26 out of the maximum 26.
We focus our analysis on the 234 women who 1) had not experienced hot ﬂash symp-
toms at baseline, 2) had baseline measurements of BMI and smoking status (0 or 1)
that are to be included as baseline covariates in the outcome submodel, and 3) had at
least 6 measurements of FSH levels. We let yi j denote the natural log transformed
FSH levels i.e., log(FSH) and oi denote the ordinal outcome of interest, severity of
hot ﬂashes (0, 1, and 2), deﬁned as oi = 0 if never had severe hot ﬂashes (that is,
severity score < 2 throughout the follow up period); oi = 1 if had severe but not more
severe hot ﬂashes (that is, severity score at least once =2 or once =3 that occurred
60

before 40 yrs. old) and oi = 2 if had more severe hot ﬂash (that is, severity score at
least once =3 after 40 yrs old). In our ﬁnal sample, 117 (50%) never experienced any
severe hot ﬂashes during follow-up (severity score=0), 80 (34%) had a severity score
of 1, and 37 (16%) had a severity score of 2. The average number of available FSH
levels per woman is 18.7 (range: 6-26) in our ﬁnal sample. Since it is commonly be-
lieved that most women start to experience menopausal related symptoms between
the age of 45 and 50 and reach menopause by the age 55, we consider T = [45,55] as
a potential risk time window in our analysis for the impact of changes in FSH levels
on risk of severe hot ﬂashes.
We use model 3.1 to describe longitudinal measured FSH and model 3.2 to re-
late long- and short-term FSH characteristics to the occurrence of severe hot ﬂashes.
Preliminary analysis suggested using cubic B spline basis functions with 1 to 3 inner
knots to express µi(ti j) and cubic B spline basis functions with 1 to 5 inner knots
to express the functional coefﬁcient function θ0(t). Thus we consider models with 1,
3 or 5 knots; putting these knots at the equally spaced quantiles of the distinctly
observed ages of these women as recommended by Ruppert et al. (2003). This is
equivalent to assuming piecewise cubic orthogonal polynomials connected at those
chosen knot locations. Next, we consider the number of components for both mean
proﬁle and variance classes. Previous analysis of ﬁtting mixture distributions for
both the random effects and variances (Chapter II) successfully identiﬁed 1 mean
proﬁle class and 2 variance classes under normality assumption for ϵi j. However,
our current approach assumes a t distribution for ϵi j that will potentially impact the
effect of any outliers on estimation of the mean trajectories, which may alter the opti-
mal numbers of components for the mean proﬁle and variance classes. With all these
considerations, we consider KD = 1,2 and 3 and KC = 1,2 and 3 in our analysis. To
deal with outlying observations that cannot be ﬁtted well by normal model, Jeffreys
(1973) (page 65) suggested using t distribution with degrees of freedom within the
61

range of [4,15].
We attempted to estimate the degrees of freedom by treating it as a true param-
eter in our model, but found its estimation unstable without use of an informative
prior. Hence we perform a sensitivity analysis, comparing results from a normal
model (df=∞) with a submodel with df=4 and 7, respectively. We chose these three
scenarios as representative settings to reﬂect the assumptions of presence of extreme
outliers, mild outliers or absence of outliers relative to a normal distribution in the
FSH data.
Table 3.1 presents the DIC statistics for all models considered: 1,2, or 3 latent
classes for the mean proﬁles and variances; normal, t (df=7) and t (df=4) assump-
tions for the errors in longitudinal submodel; and 1,3 or 5 knots for the longitudinal
trajectories or functional varying coefﬁcient function respectively. In general, DIC
suggests that joint models with t (df=4) assumption for the longitudinal submodel
ﬁts the data much better than t (df=7), and much better than the normal model. Un-
der this t assumption, KD = KC = 2 is selected for both df=4 and df=7. Given these
selected number of components for both the mean proﬁle and variance classes for
each model, DIC further suggests that 1 knot (i.e., Jµ(t) = 1) at 46.6 years of age for
the longitudinal trajectories and 3 knots (i.e., Jθ0(t) = 3) at 41.6, 46.6 and 51.5 years
of age for the functional varying coefﬁcient function offers the best balance between
goodness of ﬁt and smoothness under all these three longitudinal submodel assump-
tions. Next, we will only focus on these best ﬁtting models summarized as:
• best ﬁtting normal model: KD = 1, KC = 2 with Jµ(t) = 1 at 46.6 years of age and
Jθ0(t) = 3 at 41.6, 46.6 and 51.5 years of age
• best ﬁtting t (df=7) model: KD = KC = 2 with Jµ(t) = 1 at 46.6 years of age and
Jθ0(t) = 3 at 41.6, 46.6 and 51.5 years of age
• best ﬁtting t (df=4) model: KD = KC = 2 with Jµ(t) = 1 at 46.6 years of age and
62

Jθ0(t) = 3 at 41.6, 46.6 and 51.5 years of age
For these best ﬁtting models, PDMs also conﬁrmed our previous ﬁnding based
on model selection criterion DIC that the t (df=4) model ﬁts the longitudinal FSH
trajectories better than the t (df=7) and normal distribution. Figure 3.1 shows the
upper bounds of the p values based on PDMs for longitudinal trajectories ﬁtted by all
three ﬁnal models. If the upper bound of a p value is less than 0.05, there is strong
evidence of inadequate ﬁt. We see that the normal model ﬁts the large majority of
subjects well, with 40 individual trajectories being considered to have inadequate
ﬁt by PDMs. Out of these 40 individual trajectories, assuming t distribution with 7
degree of freedom improved the ﬁts of 27 individual trajectories, leaving still 13 indi-
vidual trajectories with inadequate ﬁt; among the 13 individual trajectories, further
assumption of even more heavy tailed t distribution with 4 degrees of freedom still
resulted in 8 individual trajectories to have inadequate ﬁt. Further examination of
these 8 (3.4% of total 234 trajectories) individual level observed trajectories indicates
the existence of varying degrees of outlying observations. For example, the ﬁrst row
in Figure 3.2 shows three trajectories that are considered to have inadequate ﬁts
by all three best ﬁtting models based on PDMs (i.e., upper bound of p values are
less than 0.05). The second row in Figure 3.2 shows 3 trajectories that have upper
bounds of p values less than 0.05 by our best ﬁtting normal model but upper bounds
of p values greater than 0.05 by both our best ﬁtting t (df=7) and t (df=4) models,
while the third row shows 3 trajectories that have upper bounds of p values less than
0.05 by our best ﬁtting normal and t (df=7) models but upper bounds of p values
greater than 0.05 by both our best ﬁtting t (df=4) models. Clearly, these plots suggest
that t models with 4 and 7 degrees of freedom show considerably less inﬂuence by
outlying observations than the normal model and they both have almost identical
ﬁts visually. Finally, the last row of Figure 3.2 shows three trajectories that have
upper bounds of p values greater than 0.05 by all three of our best ﬁtting models:
63

the normal and t models with df=4 and df=7 show very similar ﬁts. Therefore, the
inadequate ﬁt of longitudinal FSH trajectories identiﬁed by PDMs is likely due to
these varying degrees of extreme outliers. Although we could consider even smaller
degrees of freedom of t distribution or more heavily tailed distribution for the longi-
tudinal submodel to accommodate these extreme outlying observations, the t model
with either 4 or 7 degrees of freedom already shows almost identical robustness to
them and seems to provide reasonably good ﬁt to the FSH data.
Next, we contrast the estimation results from these models to demonstrate the in-
ﬂuence of not appropriately accommodating outlying observations. Figure 3.3 presents
the mean proﬁle components and two variance components identiﬁed by the three
best ﬁtting models. Consistent with the ﬁnding reported in Chapter II, under the
normal model assumption, a single-component mean proﬁle is favored by DIC. In
contrast, under both the t (df=7) and t (df=4) model assumptions, a two-component
mean proﬁle is favored by DIC: the major mean class (86% of women) whose FSH lev-
els begin increasing in their late 40s and the minor mean class (14% of women) with
increasing FSH levels starting around age 40 capturing a proportion of women who
might transition into menopause at an earlier age. The variance class has different
meanings under t and normal assumptions but in both scenarios measure the short
term variations in FSH levels: according to their magnitudes, both t and normal
models would classify them to either "low" and "high" classes. Based on the posterior
estimates of these component-speciﬁc parameters given in Table 3.2, we can further
see more subtle differences in these estimated mixture components under varying
assumptions.
In general, under all these three model assumptions, we have reached the same
broad conclusions: the high short term variability in the FSH levels is strongly asso-
ciated with increased risks of more severe hot ﬂash; smoking is marginally associated
and there was no association with BMI or the individual mean trajectories between
64

age 45 and 55. The most dramatic difference between the different df models oc-
curs for the estimated functional coefﬁcient θ0(t). Figure 3.4 (a), (b) and (c) show
the estimated functional coefﬁcient θ0(t) by our best ﬁtting normal, t (df=7) and t
(df=4) models, respectively. The estimated θ0(t) under our best ﬁtting normal model
tends to have larger effect size (larger magnitude in θ0(t)) before age 53 and an over-
all wider pointwise 95% credible interval than the estimated θ0(t)’s under our best
ﬁtting t (df=4) and t (df=7) models. All three coefﬁcient curves suggest that, when
adjusting for the whole history of mean FSH levels over the age range of age 45 to
age 55, higher mean FSH levels before age 53 reduce risk of severe hot ﬂashes, while
higher mean FSH levels between age 53 and age 55 increase this risk, but there is no
conclusive evidence of a true association between the FSH trajectory histories and
the risk of more severe hot ﬂash.
Finally, to consider the effect of the derivative of the mean proﬁle µ′
i(t), we focus
on the best-ﬁtting t (df=4) model, for which the lower bound of p value based on PDM,
is 1.0, indicating a good ﬁt to the risks of different severities of hot ﬂash. Figure 3.5(a)
considers the effect of cumulative changes in the mean proﬁles across the age range
˜T = [45,55], while Figure 3.5(b) considers the equivalent effect across the age range
˜T = [50,55], potentially a more clinically relevant age range since the median age of
menopause is 51 and therefore the hormone dynamics in this time window are more
likely to play a role in the menopausal related symptoms. When ﬁt over the wider age
range, higher values of µ′
i(t) decrease risk slightly before age 50 and increase it over
age 50, although the 95% credible intervals include 0 by a wide margin. In contrast,
a more narrowly-focused age range of ˜T = [50,55] suggested signiﬁcantly increased
risk of severe hot ﬂash associated with higher values of µ′
i(t) in the age range of 52.5-
55, with ˆθ1(52.5) = 0.408 (95% CI=0.019, 0.843) and ˆθ1(55) = 0.514 (95% CI=0.003,
1.290).
Figure 3.6 shows the receiver-operator characteristic (ROC) curves for the best-
65

ﬁtting t (df=4) model, comparing the use of the µi(t) and µ′
i(t) between age 45 and
55 to discriminate each of the hot ﬂash severities (0, 1 and 2), along with the other
predictors (residual variance, BMI, and smoking status). These ROCs and their as-
sociated area under the curve (AUCs) suggest that using either functional predictors
led to moderately accurate classiﬁcations of different hot ﬂash severities. Visually,
there is not much differences in these ROC curves; a further comparison of AUCs
also suggests that the predictive performances by using µi(t) and µ′
i(t) have negli-
gible differences (δ AUCs for severity 0, 1, and 2 are -0.012 (-0.097, 0.070), -0.002
(-0.073, 0.071) and -0.020 (-0.131, 0.091) respectively).
3.4
Conclusions and Discussion
In this paper we develop a novel joint modeling approach to answer the scien-
tiﬁcally important research question of how long-term history of FSH values or its
change rates affects the severity of hot ﬂash, a symptom almost every woman ex-
periences during the menopausal transition. While many joint models have been
developed in the context of cancer research and HIV/AIDS clinical trials in the past
decade, most methods focus on the features in the “true” underlying longitudinal
process (i.e., mean proﬁle) that take the forms of random effects or latent classes; or
alternatively the last available “true” underlying value as a time-dependent covari-
ate. Following Elliott et al. (2012) and Chapter II, we seek the useful longitudinal
features in both the mean proﬁles and the short-term variability. Further we allow
the mean of the longitudinal process and the corresponding derivatives to be time
varying, and their effects toward the responses to be accumulative over time. To
summarize, we propose a broadly applicable joint modeling approach that
1. makes efﬁcient use of the available information in the longitudinal data, by
including the short-term and long-term dynamic feature in the mean histories
66

as functional predictors in the second stage primary outcome model while also
adjusting for short-term variability,
2. allows selection of longitudinal features within certain clinically relevant time
windows to predict the health outcome of interest in the second stage primary
outcome submodel, where the effects outside this particular time window are
assumed to be negligible,
3. can handle balanced or unbalanced longitudinal data that are densely or sparsely
measured.
To realize these modeling goals, we use a penalized spline approach to allow the
ﬂexible modeling of longitudinal features and the functional coefﬁcient curve repre-
senting the time varying effect of longitudinal feature, although in principle they can
also be ﬁt by a more restrictive parametric approach. Since the ultimate goal is to
simultaneously model both the mean trajectories and the residual variability but dis-
tinguish between their effects in the outcome submodel, we choose a t distribution
to properly model residual variability to avoid the impact of outlying FSH values.
In particular, we demonstrate the importance of assuming this robust distribution
assumption instead of the typical normal assumption used in most of the joint mod-
eling literature. However, due to the limited number of longitudinal observations for
some women (i.e., ranging from 6 to 26), there is insufﬁcient information in the data
to assume individually varying degrees of freedom in t distribution, we are limited
to assume a global degrees of freedom common to all trajectories. In addition, our
attempts to use the data to estimate even the global degrees of freedom parameter
using the informative exponential distribution proposed by Geweke (1993), the trun-
cated uniform prior on the inverse of the degree of freedom suggested in Lange et
al. (1989) and Gelman and Hill (2007) and the Jefferys prior derived by Fonseca et
al. (2008) all failed: the estimated global degrees of freedom were always close to an
67

prior cutoff value, implying the existence of extreme outliers in the FSH data that
tend to drive the degrees of freedom in t distribution to low values. Given that the
ﬁtted values are only modestly affected by different values of degree of freedom in t
distribution (Lange et al. (1989)), we chose to ﬁx the degrees of freedom parameter
at a small number of ﬁxed values and conduct a sensitivity analysis using DIC to
choose among the models.
The proposed model also allows latent heterogeneities in both the individual level
mean trajectories and the residual variability as in Chapter II. Under our best ﬁtting
t (df=4) model, as shown in Figure 3.3 (e), the mean FSH trajectories can be separated
into two classes, one minor class with 14% of trajectories and the other major one
with 86% of trajectories.
Both classes are reﬂective of three typical FSH change
patterns for women in the transition to menopause (Burger et al., 1999) in that FSH
is relatively ﬂat prior to the menopause transition, has an increasing period during
the menopause transition, and will eventually plateau once women get about 2 years
post menopause; but women in the minor class tend to have an earlier increasing
time frame in the FSH trajectories along with higher FSH values than the women in
the major class. As shown in Figure 3.7, the ﬁtted mean FSH curves for the total 28
women assigned to the minor class and a random sample of 20 women assigned to
the major class based on the posterior mode were plotted. This once again shows the
heterogeneous nature in the mean FSH trajectories that is supported by our model
selection criterion DIC and implies that the women in the minor class tend to reach
menopause at a much earlier age. Also, as shown in Figure 3.3, even with the use of
the t distribution to account for extreme outlying observations, it seemed that there
still exists a true mixture in residual variability.
Generally, the functional coefﬁcient curves θ0(t) and θ1(t) can be ﬁt by any spline
basis with or without penalty. In particular, if the shape of θ0(t) or θ1(t) is known, for
example, θ0(t) is a linear function, then we can let ψ0(t) = (1,t) and assume a regular
68

ﬂat normal prior on the coefﬁcients associated with basis function 1 and t. When the
true shape of θ0(t) or θ1(t) is unknown, we recommend starting the analysis using a
more ﬂexible penalized approach to get some idea of the shape of θ0(t) or θ1(t), which
may be further reduced to simple parametric form to stabilize estimation of model
parameters and reduce the length of pointwise credible or conﬁdence intervals for
θ0(t) or θ1(t).
Finally, we feel that our proposed model lays out an example of efﬁciently using
information in the longitudinal data to predict a primary outcome by borrowing var-
ious existing tools from the literature. Based on this framework, there are several
directions for future work. Most generally, the longitudinal studies often measure
several variables repeatedly, for example, in our case several other hormone proﬁles
are also available. Developing methods to model these potentially correlated longi-
tudinal trajectories simultaneously while also using this information effectively to
predict or relate to the outcome of interest are areas for future research.
69

normal
upper bounds of p values
Frequency
0.0
0.2
0.4
0.6
0.8
1.0
0
10
20
30
40
t, df=7
upper bounds of p values
Frequency
0.0
0.2
0.4
0.6
0.8
1.0
0
10
20
30
40
t, df=4
upper bounds of p values
Frequency
0.0
0.2
0.4
0.6
0.8
1.0
0
10
20
30
40
Figure 3.1: Upper bounds of p values based on PDMs for individual trajectories ﬁt
by our best ﬁtting models with µi(t) i = 1,...,n within the time window
T = [45,55] as a functional predictor in primary outcome submodel.
Table 3.1: DIC from different joint models for the analysis of Penn ovarian aging
data, assuming normal, t (df=7) and t (df=4) distribution for the longitudi-
nal submodel and using µi(t) i = 1,...,n within the time window T = [45,55]
as a functional predictor in primary outcome submodel.
KC = 1
KC = 2
KC = 3
Model
KD = 1
KD = 2
KD = 3
KD = 1
KD = 2
KD = 3
KD = 1
KD = 2
KD = 3
Normal
Jµ(t) =1, Jθ0(t) =1
11439.0
11477.2
11492.9
11333.6
11369.1
11399.3
11511.6
11545.1
11560.7
Jµ(t) =1, Jθ0(t) =3
11437.5
11487.9
11501.8
11327.7
11364.9
11386.7
11506.8
11542.9
11561.5
Jµ(t) =1, Jθ0(t) =5
11435.0
11480.5
11493.3
11330.6
11369.1
11385.7
11500.7
11552.2
11574.9
Jµ(t) =2, Jθ0(t) =1
11923.4
11912.4
11924.6
11809.6
11788.7
11798.9
12000.1
11977.5
11984.4
Jµ(t) =2, Jθ0(t) =3
11923.8
11901.3
11915.5
11807.0
11803.5
11799.8
11995.0
11971.6
11997.1
Jµ(t) =2, Jθ0(t) =5
11924.7
11892.4
11919.2
11799.7
11788.2
11801.4
11993.1
11965.6
11991.5
Jµ(t) =3, Jθ0(t) =1
12419.3
12400.5
12418.6
12319.9
12308.2
12316.5
12506.2
12489.0
12499.3
Jµ(t) =3, Jθ0(t) =3
12421.8
12398.8
12412.5
12317.6
12306.7
12320.6
12506.5
12486.7
12489.2
Jµ(t) =3, Jθ0(t) =5
12416.6
12399.3
12409.5
12317.0
12298.1
12307.5
12504.7
12472.7
12485.0
t, df=4
Jµ(t) =1, Jθ0(t) =1
10335.0
10257.5
10271.0
10303.3
10215.4
10246.8
10425.0
10326.3
10347.2
Jµ(t) =1, Jθ0(t) =3
10333.2
10255.7
10272.5
10308.8
10210.8
10235.5
10419.9
10330.3
10374.1
Jµ(t) =1, Jθ0(t) =5
10331.2
10260.0
10273.9
10298.5
10230.4
10228.3
10432.3
10322.7
10371.9
Jµ(t) =2, Jθ0(t) =1
10831.8
10823.6
10826.4
10803.1
10774.6
10778.2
10947.6
10906.7
10889.1
Jµ(t) =2, Jθ0(t) =3
10830.0
10821.0
10833.2
10821.3
10776.0
10812.1
10929.6
10897.9
10934.2
Jµ(t) =2, Jθ0(t) =5
10828.0
10818.8
10822.3
10818.0
10780.1
10791.6
10936.8
10914.8
10922.0
Jµ(t) =3, Jθ0(t) =1
11280.6
11259.2
11256.8
11287.8
11255.8
11257.5
11406.5
11369.9
11397.4
Jµ(t) =3, Jθ0(t) =3
11275.4
11251.5
11256.8
11276.3
11251.4
11271.0
11393.9
11356.3
11382.0
Jµ(t) =3, Jθ0(t) =5
11278.3
11250.5
11265.0
11298.1
11253.6
11264.5
11409.9
11381.4
11384.1
t, df=7
Jµ(t) =1, Jθ0(t) =1
10626.5
10585.0
10606.3
10566.9
10518.2
10533.3
10679.8
10603.3
10652.2
Jµ(t) =1, Jθ0(t) =3
10624.0
10584.2
10600.6
10567.8
10511.5
10532.0
10694.9
10633.9
10648.5
Jµ(t) =1, Jθ0(t) =5
10622.5
10579.8
10598.3
10558.1
10512.0
10536.6
10670.4
10615.5
10628.7
Jµ(t) =2, Jθ0(t) =1
11127.3
11114.8
11125.2
11065.8
11051.9
11067.9
11214.9
11205.2
11201.2
Jµ(t) =2, Jθ0(t) =3
11123.7
11116.2
11132.3
11074.7
11062.0
11061.8
11210.6
11195.2
11207.4
Jµ(t) =2, Jθ0(t) =5
11126.5
11115.4
11128.0
11069.1
11055.4
11056.6
11225.2
11185.2
11206.9
Jµ(t) =3, Jθ0(t) =1
11604.1
11582.4
11585.9
11570.0
11550.0
11544.7
11652.8
11651.3
11661.6
Jµ(t) =3, Jθ0(t) =3
11601.5
11577.1
11588.5
11572.0
11541.7
11547.4
11687.8
11644.0
11672.1
Jµ(t) =3, Jθ0(t) =5
11600.6
11586.8
11587.9
11569.2
11540.3
11548.9
11672.2
11671.7
11651.9
70

GG
GG
G
G
G
G
GG
G
GG
G
G
G
G
G
G
G
G
G
G
G
G
44
46
48
50
52
54
56
0
1
2
3
4
age
log(fsh)
G
G
GG
G
G G
G
GG
GG
G
G G
G
GG
G
G
G
G
G
G
42
44
46
48
50
52
54
1.5
2.5
3.5
4.5
age
log(fsh)
GG
GG
GGGG
G
G
G
G
G
G
G
G
G
G
G
GG
GG
G
G
38
40
42
44
46
48
50
1.5
2.0
2.5
3.0
3.5
4.0
4.5
age
log(fsh)
G
G
G
G
GG
GG GG
GG
G
G
G
G
G
G
G
GG
G
G
46
48
50
52
54
56
1
2
3
4
age
log(fsh)
GG
G
G G
G
G
G GG
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
44
46
48
50
52
54
56
1
2
3
4
5
age
log(fsh)
G
G
G
G
GG
GG
G
G G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
36
38
40
42
44
46
48
1.0
1.5
2.0
2.5
3.0
3.5
4.0
age
log(fsh)
G
G
GG
GG
GG
G
G
GG
G
GG
G
42
44
46
48
50
52
54
1
2
3
4
5
age
log(fsh)
G
G
G
G
G
G
G
G
G
G GG
G
G
G
G
GG
GG
GG
48
50
52
54
56
58
60
2
3
4
5
age
log(fsh)
G
G
GG
G
G
G
G
G
G
G
G
G
G
G
GG
GG
GG
G
G
GG
44
46
48
50
52
54
56
1
2
3
4
5
age
log(fsh)
GG
G
G G
GG
G
G
G
G
G
G
G
G
G
G
G
G
GG
G
G
38
40
42
44
46
48
50
1.0
2.0
3.0
4.0
age
log(fsh)
normal
t,df=7
t,df=5
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
GG
G
G
G
G
G
38
40
42
44
46
48
50
1
2
3
4
age
log(fsh)
GG
GG
G
G
GG
G
G
G
G
G
G
G
G
G
G
G
G
GG
G
G
44
46
48
50
52
54
56
1
2
3
4
5
age
log(fsh)
Figure 3.2: Selected individual trajectories ﬁtted by our best-ﬁtting joint models with
µi(t) i = 1,...,n within the time window T = [45,55] as a functional pre-
dictor in primary outcome submodel: ﬁrst row: ﬁtted trajectories by all
three models have upper bounds of p values less than 0.05; second row:
ﬁtted normal trajectories have upper bounds of p value less than 0.05
but ﬁtted t (df=4) and t (df=7) trajectories have upper bounds of p value
greater than 0.05; third row: ﬁtted normal and t (df=7) trajectories have
upper bounds of p value less than 0.05 but ﬁtted t (df=4) trajectories have
upper bounds of p value greater than 0.05; forth row: ﬁtted trajectories
by all three models have upper bounds of p values greater than 0.05.
71

35
40
45
50
55
60
−2
0
2
4
6
(a): 2.58% not covered by 95% PI
age
log(fsh)
(b)
log(σ^
i
2)
Density
−3.5
−2.5
−1.5
−0.5
0.0
0.5
1.0
1.5
G
G
variance
class 1
(21%)
variance
class 2
(79%)
35
40
45
50
55
60
−2
0
2
4
6
(c): 2.93% not covered by 95% PI
age
log(fsh)
Major mean class (86%)
Minor mean class (14%)
(d)
log(σ^
i
2)
Density
−3.5
−2.5
−1.5
−0.5
0.0
0.5
1.0
1.5
G
G
variance
class 1
(24%)
variance
class 2
(76%)
35
40
45
50
55
60
−2
0
2
4
6
(e): 2.78% not covered by 95% PI
age
log(fsh)
Major mean class (86%)
Minor mean class (14%)
(f)
log(σ^
i
2)
Density
−3.5
−2.5
−1.5
−0.5
0.0
0.5
1.0
1.5
G
G
variance
class 1
(29%)
variance
class 2
(71%)
Figure 3.3: longitudinal proﬁles from our ﬁnal models with Jµ = 1 and KD = KC =
2 in longitudinal submodel; µi(t) as functional predictor with time win-
dow T = [45,55] and Jθ0 = 3 in primary outcome submodel with different
assumptions for longitudinal submodel: a) and b) under normal assump-
tion; c) and d) under t assumption with df=7; e) and f) under t distribution
with df=4.
72

−0.4
−0.2
0.0
0.2
0.4
(a)  normal, T=[45,55]
age
θ0(t)
45
50
55
−0.4
−0.2
0.0
0.2
0.4
(b)  t (df=7), T=[45,55]
age
θ0(t)
45
50
55
−0.4
−0.2
0.0
0.2
0.4
(c) t (df=4), T=[45,55]
age
θ0(t)
45
50
55
Figure 3.4: Functional coefﬁcient function θ0(t) from our best ﬁtting t (df=4),
t(df=7) and normal models with µi(t), i = 1,...,n within the time window
T = [45,55] as a functional predictor in primary outcome submodel.
−1.0
−0.5
0.0
0.5
1.0
(a) t (df=4), T=[45,55]
age
θ1(t)
45
50
55
−0.5
0.0
0.5
1.0
1.5
(b) t (df=4), T=[50,55]
age
θ1(t)
50
51
52
53
54
55
Figure 3.5: Functional coefﬁcient functions θ0(t) and θ1(t) from our best-ﬁtting
model with Jµ = 1 and KD = KC = 2 in longitudinal submodel with t (df=4)
assumption; and Jθ0 = Jθ1 = 3 in primary outcome submodel: a) µ′
i(t) as
functional predictor with T = [45,55] and b) µ′
i(t) as functional predictor
with ˜T = [50,55].
73

0.0
0.2
0.4
0.6
0.8
1.0
0.0
0.2
0.4
0.6
0.8
1.0
False severity=0 rate
True severity=0 rate
AUC0:0.657(0.606,0.708)
AUC1:0.645(0.581,0.709)
0.0
0.2
0.4
0.6
0.8
1.0
0.0
0.2
0.4
0.6
0.8
1.0
False severity=1 rate
True severity=1 rate
AUC0:0.559(0.512,0.609)
AUC1:0.557(0.505,0.616)
0.0
0.2
0.4
0.6
0.8
1.0
0.0
0.2
0.4
0.6
0.8
1.0
False severity=2 rate
True severity=2 rate
AUC0:0.697(0.627,0.765)
AUC1:0.678(0.589,0.757)
Figure 3.6: ROC curves from our ﬁnal t model: AUC0 is obtained by using µi(t) with
Jθ0(t) = 3 within the time window T = [45,55] as a functional predictor
in outcome submodel and AUC1 is obtained by using µ′
i(t) with Jθ1(t) =
3 within the time window T = [45,55] as a functional predictor with in
outcome submodel.
74

35
40
45
50
55
60
1
2
3
4
5
t, df=4
age
log(fsh)
assigned to the minor mean class
assigned to the major mean class
assigned to the minor mean class
assigned to the major mean class
Figure 3.7: Individual trajectories that are assigned to the minor and major mean
proﬁle classes by our best ﬁtting t (df=4) model with µi(t) i = 1,...,n within
the time window T = [45,55] as a functional predictor in primary outcome
submodel.
75

Table 3.2: Estimates of model parameters by our best ﬁtting models with µi(t) i =
1,...,n within the time window T = [45,55] as a functional predictor in
primary outcome submodel.
normal
t, df=7
t, df=4
p
mean
se
95% CI
mean
se
95% CI
mean
se
95% CI
β11
1.666
0.145
(1.374, 1.95)
1.508
0.152
(1.195, 1.794)
1.475
0.152
(1.166, 1.766)
β12
1.993
0.094
(1.808, 2.177)
2.118
0.094
(1.937, 2.308)
2.142
0.091
(1.963, 2.321)
β13
1.286
0.153
(0.985, 1.585)
0.933
0.147
(0.643, 1.22)
0.889
0.144
(0.608, 1.175)
β14
5.416
0.225
(4.981, 5.862)
5.506
0.24
(5.029, 5.969)
5.586
0.238
(5.115, 6.051)
β15
4.253
0.445
(3.358, 5.114)
4.272
0.418
(3.44, 5.09)
4.122
0.396
(3.345, 4.897)
ω2
11
0.94
0.265
(0.535, 1.556)
2.321
1.86
(0.786, 6.4)
2.357
1.597
(0.811, 6.39)
ω2
12
0.606
0.137
(0.379, 0.915)
2.588
2.556
(0.698, 7.717)
2.838
2.357
(0.808, 8.107)
ω2
13
2.022
0.396
(1.343, 2.887)
3.942
2.215
(1.327, 9.512)
3.644
1.911
(1.291, 8.433)
ω2
14
5.68
0.927
(4.08, 7.692)
4.612
2.91
(1.376, 12.195)
4.232
2.51
(1.306, 10.495)
ω2
15
9.43
3.235
(4.643, 17.328)
23.262
25.851
(3.639, 87.769)
17.166
16.618
(3.364, 61.141)
ρ1,12
-0.763
0.073
(-0.877, -0.592)
-0.633
0.213
(-0.914, -0.096)
-0.653
0.202
(-0.917, -0.133)
ρ1,13
0.661
0.098
(0.436, 0.816)
0.527
0.223
(0.002, 0.862)
0.54
0.214
(0.042, 0.857)
ρ1,14
-0.199
0.146
(-0.468, 0.102)
-0.374
0.257
(-0.786, 0.203)
-0.381
0.249
(-0.783, 0.165)
ρ1,15
-0.017
0.167
(-0.338, 0.31)
0.17
0.308
(-0.462, 0.707)
0.163
0.299
(-0.445, 0.688)
ρ1,23
-0.818
0.047
(-0.894, -0.711)
-0.632
0.19
(-0.902, -0.169)
-0.644
0.182
(-0.903, -0.216)
ρ1,24
0.459
0.103
(0.239, 0.64)
0.378
0.273
(-0.229, 0.808)
0.369
0.268
(-0.219, 0.802)
ρ1,25
-0.172
0.15
(-0.452, 0.133)
-0.076
0.347
(-0.7, 0.589)
-0.061
0.333
(-0.671, 0.581)
ρ1,34
-0.552
0.078
(-0.69, -0.385)
-0.861
0.116
(-0.974, -0.537)
-0.863
0.096
(-0.971, -0.606)
ρ1,35
0.262
0.14
(-0.031, 0.517)
0.563
0.271
(-0.111, 0.909)
0.56
0.251
(-0.055, 0.897)
ρ1,45
-0.744
0.08
(-0.865, -0.554)
-0.733
0.199
(-0.953, -0.198)
-0.722
0.197
(-0.948, -0.192)
β21
2.5
0.527
(1.481, 3.574)
2.599
0.524
(1.612, 3.705)
β22
1.233
0.439
(0.38, 2.118)
1.146
0.432
(0.275, 1.982)
β23
4.129
0.493
(3.13, 5.103)
4.263
0.479
(3.336, 5.233)
β24
5.267
0.544
(4.234, 6.387)
5.211
0.526
(4.196, 6.279)
β25
3.996
1.371
(1.109, 6.594)
4.006
1.316
(1.313, 6.584)
ω2
21
0.895
0.262
(0.507, 1.521)
0.909
0.265
(0.51, 1.535)
ω2
22
0.55
0.125
(0.344, 0.835)
0.552
0.122
(0.347, 0.824)
ω2
23
1.561
0.319
(1.027, 2.275)
1.597
0.323
(1.042, 2.303)
ω2
24
5.367
0.891
(3.815, 7.292)
5.391
0.893
(3.835, 7.324)
ω2
25
6.35
1.948
(3.326, 10.87)
6.017
1.744
(3.278, 10.062)
ρ2,12
-0.769
0.07
(-0.881, -0.608)
-0.773
0.069
(-0.88, -0.613)
ρ2,13
0.65
0.101
(0.421, 0.814)
0.657
0.1
(0.431, 0.818)
ρ2,14
-0.253
0.157
(-0.545, 0.064)
-0.261
0.158
(-0.554, 0.065)
ρ2,15
0.07
0.175
(-0.269, 0.41)
0.077
0.175
(-0.263, 0.417)
ρ2,23
-0.858
0.041
(-0.923, -0.764)
-0.858
0.041
(-0.922, -0.763)
ρ2,24
0.51
0.108
(0.279, 0.699)
0.511
0.106
(0.281, 0.7)
ρ2,25
-0.282
0.151
(-0.557, 0.03)
-0.296
0.148
(-0.57, 0.008)
ρ2,34
-0.686
0.073
(-0.809, -0.525)
-0.686
0.071
(-0.808, -0.529)
ρ2,35
0.398
0.135
(0.112, 0.633)
0.4
0.132
(0.119, 0.637)
ρ2,45
-0.745
0.085
(-0.871, -0.539)
-0.761
0.078
(-0.878, -0.575)
πD
1
0.865
0.035
(0.787, 0.926)
0.861
0.033
(0.788, 0.918)
πD
2
0.135
0.035
(0.074, 0.213)
0.139
0.033
(0.082, 0.212)
µ1
-2.859
0.18
(-3.23, -2.521)
-3.03
0.223
(-3.481, -2.637)
-3.128
0.203
(-3.537, -2.712)
µ2
-1.261
0.059
(-1.378, -1.144)
-1.701
0.078
(-1.859, -1.555)
-1.91
0.092
(-2.102, -1.74)
πC
1
0.205
0.044
(0.126, 0.295)
0.242
0.07
(0.123, 0.384)
0.293
0.08
(0.148, 0.449)
πC
2
0.795
0.044
(0.705, 0.874)
0.758
0.07
(0.616, 0.877)
0.707
0.08
(0.551, 0.852)
τ2
0.208
0.046
(0.133, 0.309)
0.154
0.059
(0.065, 0.29)
0.134
0.072
(0.03, 0.319)
θ0 (intercept)
0.305
0.995
(-1.631, 2.329)
0.279
0.972
(-1.637, 2.268)
0.012
0.985
(-1.886, 1.979)
θ1 (log(BMI))
0.068
0.277
(-0.501, 0.607)
0.039
0.264
(-0.497, 0.573)
0.101
0.273
(-0.449, 0.627)
θ2 (smoking)
0.386
0.17
(0.052, 0.717)
0.37
0.17
(0.039, 0.708)
0.371
0.171
(0.036, 0.708)
θ3 (variance)
1.576
0.565
(0.498, 2.703)
1.887
0.747
(0.451, 3.394)
1.96
0.723
(0.579, 3.403)
˜θ01
-0.144
0.6
(-1.453, 1.125)
-0.104
0.554
(-1.3, 1.096)
-0.098
0.555
(-1.303, 1.138)
˜θ02
-0.158
0.624
(-1.4, 1.055)
-0.113
0.579
(-1.223, 0.945)
-0.11
0.565
(-1.198, 0.981)
˜θ03
-0.175
0.487
(-1.141, 0.624)
-0.117
0.413
(-0.888, 0.644)
-0.113
0.417
(-0.899, 0.642)
˜θ04
-0.139
0.144
(-0.444, 0.069)
-0.1
0.117
(-0.332, 0.086)
-0.101
0.118
(-0.329, 0.088)
˜θ05
0.037
0.187
(-0.268, 0.453)
0.009
0.159
(-0.29, 0.326)
0.007
0.162
(-0.297, 0.321)
˜θ06
0.085
0.317
(-0.542, 0.709)
0.072
0.278
(-0.428, 0.671)
0.078
0.286
(-0.412, 0.697)
˜θ07
0.09
0.668
(-1.185, 1.304)
0.082
0.59
(-0.905, 1.235)
0.08
0.582
(-0.942, 1.219)
76

CHAPTER IV
Bayesian Model Assessments in Evaluating
Mixtures of Longitudinal Trajectories and Their
Associations with Cross-Sectional Health Outcomes
4.1
Introduction
There is a growing body of literature that models information from longitudinal
data to predict risks of health outcome of interest (Taylor et al., 2005; Yu et al., 2008;
Proust-Lima and Taylor, 2009; Rizopoulos, 2011; Proust-Lima et al.,2012; Elliott et
al., 2012; Taylor et al., 2013; Chapter II and III). An attractive feature of such pre-
dictions is that they are individualized. However, when several candidate models are
available, the derived outcomes can be greatly affected by the use of different mod-
els. For example, different numbers of mixture components as well as the assumed
association structure (e.g., multiple shared random effect vs. latent class structures)
to link the longitudinal and primary outcome submodels can affect the target indi-
vidualized predictions, as discussed in Chapter II. In general, researchers also tend
to use the resulting latent classes to interpret the class-speciﬁc association ﬁndings.
Various model selection criteria can be adopted to guide the selection of the proper
number of components and the association structure. However, the performances
of these model selection criteria have not been well studied in the joint modeling
77

framework.
Choosing the number of mixture components in a ﬁnite mixture setting is non-
trivial. The difﬁculty arises mainly because the parameter estimation in ﬁnite mix-
ture models is not a regular problem but a singular problem; hence log-likelihood
function is not well approximated by a quadratic function, and maximum likelihood
estimates are not asymptotically normal. See McLachlan and Peel (2000, section 6),
Frühwirth-Schnatter (2006, section 4), Steele and Raftery (2010) as well as the ref-
erences therein for thorough discussions of parameter estimation in ﬁnite mixture
models.
Here we consider six model selection criteria. They are Akaike information crite-
rion (AIC) (Akaike, 1974), Bayesian information criterion (BIC) (Schwartz, 1978), in-
tegrated classiﬁcation likelihood criterion (ICL) (Biernacki et al., 1998), the deviance
information criterion (DIC) (Spiegelhalter et al., 2002), the logarithm of the pseudo-
marginal likelihood (LPML) (Geisser and Eddy 1979) and the widely applicable infor-
mation criterion (WAIC) (Watanabe, 2010). AIC and BIC are long-standing and most
commonly used information based model selection criteria in general; ICL is closely
related to BIC with focus on the classiﬁcation likelihood and entropy, whereas LPML
has been most widely used in Bayesian model assessment. More details, including
certain necessary modiﬁcations to accommodate the joint modeling framework are
provided in Sections 4.3.1.3 to 4.3.1.5. DIC is often viewed as a Bayesian version of
AIC with prior information on model parameters and is equivalent to AIC for non-
hierarchical models with non-informative or ﬂat priors. Many authors have proposed
alternative versions of DIC. For example, Plummer (2002, 2006 and 2008) and Gel-
man et al. (2003) proposed alternative deﬁnitions of model complexity, while Celeux
et al. (2006) proposed eight variations of DIC for “missing data” problems, including
hierarchical models with latent variables.
WAIC, a recently proposed approach, was derived based on singular learning the-
78

ory (Watanabe, 2009) as an asymptotically unbiased approximation to the out-of-
sample prediction error, and is a generalization of AIC that is applicable for both
regular and singular statistical models. It is straightforward to compute based on
the posterior draws, even for complex hierarchical models. Gelman et al. (2013) dis-
cussed the construction of AIC, DIC and WAIC from a Bayesian perspective using
some simple examples and concluded that WAIC is a “very fast and computationally-
convenient alternative" to their most preferred but often computationally expensive
cross-validation approach to choose among several candidate models. However, its
properties have not been studied in the setting of choosing numbers of components
for ﬁnite mixture distributions.
Model assessment for the joint models consisting of mixture distributions as con-
sidered in Chapter II is even more challenging due to various reasons. First of all,
the variables that are assumed to have mixture distributions are unobserved latent
features of the longitudinal trajectories. AIC, BIC or DIC based on the observed
data likelihood is not available in closed form. Secondly, the evaluation of model
goodness-of-ﬁt has to take into account of the model ﬁts of longitudinal submodel
and the primary outcome model jointly; this can be problematic, as the relatively
larger gain in the ﬁt of the primary outcome model, which contains a larger num-
ber of components, may dominate the overall model ﬁt. This phenomenon could lead
to favoring larger class models. Thirdly, when data are generated from a multiple
shared random effect (MSRE) model, incorrectly assuming a latent class (LC) struc-
ture to link the longitudinal submodel and the primary outcome model has a high
chance of creating an “outcome-informed artifact” as reported previously in Chap-
ter II. When the primary outcome is binary and the information about the mixture
components from the longitudinal data is weak, artiﬁcial mixture-components are
created to match the two outcome groups of 0 or 1 under the assumed LC structure,
which could lead to a false sense of accurate prediction than when the correct model is
79

ﬁt. Despite the artiﬁcial enhancement in the predictive performance, such outcome-
informed mixture-components are completely due to this artifact. Therefore, some
naturally relevant and important questions arise: (i) whether such artifacts due to
the assumed association structure in the primary outcome model would play any role
in the performances of model selection criteria in choosing the numbers of mixture
components; and (ii) whether model selection criteria would favor the assumed LC
structure, which leads to seemingly better prediction over the MSRE structure in the
presence of outcome-informed artifacts.
To address these issues, we conduct numerical studies to compare and contrast
the performances of several commonly used model selection criteria. We consider
WAIC and other modiﬁed criteria based on Bayesian principles in the joint modeling
setting considered in Chapter II. Our main goals include understanding the perfor-
mances of these commonly used criteria under different scenarios, including when
the data-generating scheme differ from the assumed structure; gaining insights on
similarity of selection performances of different criteria; and uncovering the model
predictive performances based on out-of-sample validation, where the performances
of the selected models are further linked with model selection criteria.
The remainder of this article is organized as follows. In Section 4.2, we describe
the joint LC and MSRE models with mixture distributions for the mean and residual
variances proﬁles of the longitudinal trajectories. In Section 4.3.1, we brieﬂy review
the Bayesian model assessment criteria as well as the overall model predictive per-
formance measure to be included in our simulation. In Section 4.4, we describe our
simulation study and report the outcomes. In Section 4.5, we describe the proce-
dures used to validate prediction performances of the selected models by different
criteria using newly generated independent samples. In Section 4.6, we study the
performances of the selection criteria for the joint modeling of the follicle stimulat-
ing hormone trajectories and severity of hot ﬂash for a group of middle-aged women
80

from the Penn ovarian aging study. Concluding remarks are given in Section 4.7.
4.2
Joint LC and MSRE models
Mixture modeling is commonly used to identify unique and distinct feature sub-
groups (i.e., latent classes) in longitudinal trajectories, e.g., the proposal of growth
mixture models (GMMs) in Muth ´en and Shedden (1999).
Chapter II considered
two classes of joint models for normally distributed longitudinal data and a binary
health outcome data. Both models used a generalized GMM for the longitudinal
data. GMMs assume latent classes for the subject-level mean proﬁles. Our extension
in Chapter II considered latent classes for not only the mean proﬁles but also the
residual variabilities of the longitudinal trajectories. Speciﬁcally, the longitudinal
submodel has the form
yi j|bi,σ2
i ∼N{µ(bi;ti j),σ2
i },
(4.1)
where, yi j denotes the longitudinal covariate for the ith subject at time ti j, j =
1,...,ni, i = 1,...,n, bi is the vector of r random effects that reﬂects the subject-level
mean proﬁle/trajectory patterns and σ2
i is the subject-level residual variance. Di and
Ci deﬁne the latent class memberships for the individual mean proﬁle and variance
respectively:
Di ∼Multinomial(πD
1 ,...,πD
KD);
bi|Di = d ∼N(βd,Σd),d = 1,...,KD
Ci ∼Multinomial(πC
1 ,...,πC
KC);
σ2
i |Ci = c ∼log-N(µc,τ2), c = 1,...,KC
(4.2)
We consider two commonly used association structure to link longitudinal trajec-
tory features with the binary outcome of interest: ﬁrst, an MSRE structure, where
the random effects bi, σ2
i and their interactions bi ×σ2
i are included as linear predic-
tors in the primary outcome model and second, an LC structure, where the main and
81

interaction effects of latent classes Di and Ci are included in the primary outcome
model. In both cases, the primary outcome model can be written as
Φ−1(P(oi = 1)) = Z′
iη,
(4.3)
where oi denotes the binary indicator of outcome, Zi denotes a vector of the covari-
ates in the probit model for subject i, i = 1,··· ,n and Φ(·) is the cumulative distri-
bution function for the standard normal distribution. For the LC model, Zi contains
indicators for the latent classes Di and Ci; for the MSRE model, Zi contains the
subject-speciﬁc random effect bi and residual variance σ2
i ; other fully observed base-
line covariates of interest can be included in Zi in either model as well.
4.2.1
Likelihood speciﬁcation
Let φ = ({βd}KD
d=1,{Σd}KD
d=1,{πD
d }KD
d=1, {µc}KC
c=1,{πC
c }KC
c=1, τ2, η)′. We assume each com-
ponent of φ has an independent prior distribution with the joint prior distribution
denoted by π(φ). All unobserved latent variables are denoted by z, z = (b,σ,C,D)′.
The observed data x consists of the longitudinal proﬁles y1,...,yn and the observed
outcomes o1,...,on. Then the complete data likelihood of φ based on the complete
data (x,z) is given by
f (x,z|φ) ∝
(
n
Y
i=1
"
Y
d
·
πd(2π)−r
2 |Σd|−1
2 exp
½
−1
2
¡
bi −βd
¢′Σd
¡
bi −βd
¢¾¸I(Di=d)
×
Y
c
·
πc(2πτ2)−1
2 σ−2
i exp
½
−1
2τ2
¡
logσ2
i −µc
¢2¾¸I(Ci=c)
×
ni
Y
j=1
1
q
2πσ2
i
exp
"
−1
2σ2
i
©
yi j −f (bi;ti j)
ª2
#
×Φ(Z′
iη)oi ©
1−Φ(Z′
iη)
ª1−oi
#)
π(φ).
(4.4)
82

4.2.2
Prior speciﬁcation and posterior computation
We consider the same prior distributions as considered in Chapter II, where cer-
tain empirical data-driven priors were considered for some parameters to avoid ei-
ther improper posterior or existence of empty classes during the iterations of MCMC
sampling. We found that our considered model assessment criteria were not sensitive
to these choices.
For the mixture normal distribution of the random effects, we let βd ∼N(0,V),
V = n d
Cov( ˆβ) where ˆβ is the linear regression estimator of y on the design matrix
of t deﬁned by f (·;ti j). This corresponds to a prior “single observation” data-driven
inﬂated covariance structure centered at a null model, and avoids improper poste-
riors resulting from the possibility that some of the latent classes are not repre-
sented in the data (Elliott et al. 2005). For the the variance-covariance matrix for
the random effects Σd, we use the prior proposed by Kass and Natarajan (2006):
Σd ∼Inverse-Wishart(df = r,Λ), where Λ = r
³Pn
i=1 d
Cov( ˜bi)−1/n
´−1
, ˜bi is given by OLS
estimator of bi for subject i and r is the dimension of bi. This prior restrains the
eigenvalues of the variance-covariance matrices away from 0, avoiding the improper
posterior that can result from unbounded likelihoods when the variance-covariance
matrix is unrestricted in normal mixture models (Day, 1969).
For the mixture log normal distribution for the residual variances, we used dif-
fuse priors: µc ∼N(0,v), τ−2 ∼Gamma(a,b) with v = 1000 and a = b = .001. For
the class membership probabilities, we assume conjugate Dirichilet(4,...,4) on both
πC = (πC
1 ,...,πC
KC) and πD = (πD
1 ,...,πD
KD) (Frühwirth-Schnatter, 2006); this is equiva-
lent to assuming a priori 4 observations in each class, avoiding the existence of empty
classes. Lastly, we let θ ∼N(0,(9/4)I) in the probit regression, where (9/4)I is chosen
to bound the estimated outcome probabilities to be away from 0 and 1 (Garrett and
Zeger, 2000; Elliott et al., 2007, and Neelon et al., 2011).
Gibbs sampling is used to obtain draws from the corresponding posterior distribu-
83

tions. For (η | C,D,O) we use the Albert and Chib (1993) data augmentation method
for probit regression models. The draws of (σ2
i |Ci,µc,τ2,bi,oi,{yi j}j) for i = 1,...,n are
obtained the inverse cumulative distribution method. The detailed MCMC sampling
procedures are provided in the Appendix A.
4.3
Model selection and assessment criteria
4.3.1
Model selection criteria
We consider several commonly used model selection criteria that are both com-
putationally feasible and stable for our joint models. For a comprehensive review of
Bayesian model selection criteria, please refer to Vehtari and Ojanen (2012).
4.3.1.1
Log-pseudo marginal likelihood criterion
The log-pseudo marginal likelihood (LPML) (Geisser and Eddy, 1979) corresponds
to a Bayesian cross-validation measure, deﬁned as LPML =
nX
i=1
log(CPOi), where
CPOi = f (yi,oi|y(−i),o(−i)) represents a cross-validated posterior predictive density
for xi = (yi,oi) given the data excluding (yi,oi) (denoted by (y(−i),o(−i)) = x(−i)). The
model with higher value of LPML provides better ﬁt to the data (Ibrahim et al., 2001).
Details of the LPML computation are provided in the Appendix A.
4.3.1.2
Deviance information criterion
DIC (Spiegelhalter et al., 2002) is a Bayesian analog of the original AIC (Akaike,
1974), but DIC uses the discrepancy between the posterior mean of the deviance
D(φ) = Eφ
©
−2log f (x | φ) | x
ª
and the deviance evaluated at the posterior mean D(φ) =
−2log f
©
x | E(φ | x)
ª
to estimate the effective number of degrees of freedom in the
84

model pD:
DIC(x) = D(φ)+ pD
= 2D(φ)−D(φ)
= D(φ)+2pD
= −4Eφ
©
log f (x | φ) | x
ª
+2log f
©
x | E(φ | x)
ª
(4.5)
In our setting, the observed data likelihood f (x | φ) is not available in closed form,
where x = (y,o)′; instead we use the approach outlined in Celeux et al. (2006) to ob-
tain Ez {DIC(x,z)} = −4Ez,φ
©
log f (x,z | φ) | x
ª
+2Ez
£
log f
©
x,z | Eφ(φ | x,z)
ª
| x
¤
, where
the complete data likelihood f (x,z | φ) has a closed form as speciﬁed in (4.4), and
Eφ(φ | x,z) is obtained via numerical methods. The detail of DIC computation is
provided in the Appendix A.
4.3.1.3
Modiﬁed AIC
Although the original AIC proposed by Akaike (1974) is developed for “regular”
models and hence is not directly deﬁned for Bayesian hierarchical model, we con-
sider AIC modiﬁed based on the complete data likelihood using Bayesian principle.
Speciﬁcally, the modiﬁed AIC is deﬁned using the deviance based on the complete
data likelihood with a penalty term to account for the number of model parameters
as follows:
• AIC1 = D(φ)+2p = −2Ez,φ
©
log f (x,z | φ) | x
ª
+2p
• AIC2 = D(φ)+2p = −2Ez
£
log f
©
x,z | Eφ(φ | x,z)
ª
| x
¤
+2p
where for joint LC model, p = KD + rKD + r2KD + KC + KC + KCKD + 1 and for joint
MSRE model, p = KD + rKD + r(r + 1)KD/2 + KC + KC + 2(r + 1) + 1, where r is the
dimension of random effect bi. For both models, there are KD parameters for πd,
rKD for µd, r(r +1)KD/2 for Σd in the mean proﬁle; there are KC parameters for πc,
KC for µc, 1 for τ2 in the variance proﬁle. For the LC structure, since we consider a
85

saturated model with all possible main and interaction effect between the mean and
the variance proﬁles, there are KCKD parameters in the primary outcome model;
for the MSRE structure, since we consider all possible main and interaction effect
between random effects bi and variances σ2
i , there are 2(r + 1) parameters in the
primary outcome model.
4.3.1.4
Modiﬁed BIC and ICL
Accordingly, we consider the following modiﬁed BIC’s that correspond to the above
deﬁnition of AIC’s:
• BIC1 = D(φ)+ plog(n) = −2Ez,φ
©
log f (x,z | φ) | x
ª
+ plog(n)
• BIC2 = D(φ)+ plog(n) = −2Ez
£
log f
©
x,z | Eφ(φ | x,z)
ª
| x
¤
+ plog(n)
To identify the correct number of components for ﬁnite mixture distributions, Bier-
nacki et al. (1998) also suggested an integrated classiﬁcation likelihood criterion
(ICL), which was shown by McLachlan and Peel (2006, page 216) to be approximately
equal to BIC plus two times the entropy of classiﬁcation probability into assumed
number of clusters. Here, we adopt this approximated version of ICL. Further, given
that we have two mixture distributions for the random effects and the residual vari-
ances, respectively, we have the following two forms of ICL,
• ICL1 = BIC1 +2Ez,φ
©
EN(φ,z) | x
ª
• ICL2 = BIC2 +2Ez
£
EN
©
Eφ(φ | x,z),z
ª
| x
¤
where
EN(φ,z) =−
KD
X
d=1
nX
i=1
P(Di = d | φ,z)logP(Di = d | φ,z)
−
KC
X
c=1
nX
i=1
P(Ci = c | φ,z)logP(Ci = c | φ,z)
(4.6)
where, the expressions of P(Di = d | φ,z) and P(Di = d | φ,z) differ for LC and MSRE
models and are given in the Appendix C.
86

4.3.1.5
WAIC
Following Gelman et al. (2013), we consider the following two forms of WAIC,
deﬁned based on the conditional data likelihood f (xi | z,φ):
WAICi = −2
nX
i=1
log
£
Ez,φ
©
f (xi | z,φ) | x
ª¤
+2pWAICi
(4.7)
• pWAIC1 = 2
nX
i=1
"
log
£
Ez,φ
©
f (xi | z,φ) | x
ª¤
−Ez,φ
£
log f (xi | z,φ) | x
¤
#
• pWAIC2 =
nX
i=1
Varz,φ
"
log f (xi | z,φ) | x
#
where f (xi | z,φ) =
£
oiΦ(ZT
i η)+(1−oi)(1−Φ(ZT
i η))
¤Qni
j=1 φ(yi j|µ(bi;ti j),σ2
i ), and
φ(yi j|µ(bi;ti j),σ2
i ) represents the normal density with mean µ(bi;ti j) and variance
σ2
i evaluated at yi j.
4.3.2
Overall model performance measure
For each model considered, we also summarize its predictive performance to link
with different model selection criteria. There are many choices to quantify the perfor-
mance of a predictive model for binary prediction (Taylor et al., 2008 and Steyerberg
et al., 2010). Here, we consider the widely-used the area under the curve (AUC) based
on the receiver operating characteristic (ROC) curve to assess the overall model dis-
crimination ability averaged across all predictive cutoffs. For out-of-sample predic-
tion validation in Section 4.5, we consider the Brier-score based posterior predictive
mean squared error as an additional performance measurement; details are provided
therein.
Brieﬂy, the ROC curve plots true positive rate (TP) versus false positive rate
(FP) for all possible cutoffs based on predicted P(oi = 1) = Φ(Z′
iη) obtained from
(4.3). The ROC curve and AUC were computed at each MCMC iteration using the
ROCR package in R (Sing et al. 2005). The ROC curve is computed by ordering
87

the observations (i) = 1,...,n so that ˆP(o(i) = 1) ≥ˆP(o(i+1) = 1), computing change-
points c = 2,...,nc, nc ≤n where the observations change from positive to negative
(i.e., o(c−1) = 1, o(c) = 0), and plotting Pc
(i)=1(1−o(i))/Pn
(i)=1(1−o(i)) on the x-axis versus
Pc
(i)=1 o(i)/Pn
(i)=1 o(i) on the y-axis. The AUC is then computed using a trapezoidal ap-
proximation. The reported AUC is calculated as the posterior mean AUC averaged
across all MCMC iterations.
4.4
Simulation Study
In this section, we conduct several simulation studies to evaluate the perfor-
mances of these model selection criteria under both scenarios that the data gen-
erating schemes, LC or MSRE, and the ﬁtted model coincide with each other and
when they do not. In what follows, we refer to the model where the observations are
generated from as the “true model”. Two representative data-generating structures,
KD = KC = 2 and KD = KC = 1, are considered. The former, with different combi-
nations of relative mixture locations, represents a simple but informative mixture
structure; while the latter represents the null model. We report the number of com-
ponents selected by each criterion and under each scenario. We also report the within
and out-of samples prediction performances.
4.4.1
Simulation Setup
We specify a combination of sub-structures for our simulation studies below.
88

4.4.1.1
KD = KC = 2
For the longitudinal observations, we generate data from the following models
with two components within both the mean and the variance proﬁles,
yi j|bi,σ2
i ∼N(b0i + b1iti j,σ2
i ),
bi ∼πN(β1,Σ1)+(1−π)N(β2,Σ2),
logσ2
i ∼πN(µ1,τ2)+(1−π)N(µ2,τ2),
(4.8)
where i = 1,...,200 and ti j = 0,1,2,...,ni with ni ≡20. For k = 1,2, we denote βk =
(βk1,βk2)′ and Σk =


ω2
ρkω2
ρkω2
ω2

.
We let β1 = (0,0)′ and β2 = (2
p
2,2
p
2)′, ρ1 = 0 and ρ2 = −0.6, µ1 = −2 and µ2 = −.5.
Thus the mean of the two bivariate normals differs by 4 throughout, while the
mean log of the variances are separated by 1.5. In our investigation, we consider
the cases of “overlapped” versus “separated” mixture components, crossed with “bal-
anced” 50:50 versus “unbalanced” 20:80 mixing proportions for both the mean and
the variance proﬁles. Besides the separation in mixture components, we anticipate
the mixing proportion of 50:50 to yield more difﬁcult to separate latent classes, since
the populations provide no information about class memberships. Figure 4.1 shows
the corresponding 95% contours and density plots of the two “overlapped” versus
“separated” components for the mean and the variance proﬁle, respectively.
Fi-
nally, our eight longitudinal model scenarios are deﬁned by (ω2,τ2,π) = (2,.25,.5),
(1,.25,.5), (2,.06,.5), (1,.06,.5), (2,.25,.2), (1,.25,.2), (2,.06,.2), and (1,.06,0.2), re-
spectively.
For each scenario, we simulate 100 data sets and report the models (i.e., KD and
KC) selected by each selection criteria. The setups considered include the combina-
tions where the assumed and ﬁtted structures from the choices of LC and MSRE
models match or dis-match each other, with the assumed numbers of components
89

being KD = 1,2,3 and KC = 1,2,3.
For each of the simulation scenarios proposed for the longitudinal observations,
the following two underlying probit models are considered for the health outcome:
1. latent class (LC) probit submodel:
Φ−1 {P(oi = 1)} = θ0 +θ1I(Di = 2)+θ2I(Ci = 2)+θ3I(Di = 2,Ci = 2);
(4.9)
2. multiple shared random effect (MSRE) probit submodel:
Φ−1 {P(oi = 1)} = γ0 +γ1bi0 +γ2bi1 +γ3σ2
i +γ4bi0σ2
i +γ5bi1σ2
i ,
(4.10)
where Di = 1 corresponds to the mean component N((0,0)′,Σ1), and Ci = 1 corre-
sponds to the variance component N(−2,τ2) in the longitudinal submodel (4.8). We
replace η in the general models (4.3) by θ for the LC and by γ for the MSRE probit
primary models to simplify the task of presentation; we let θ = (−0.8,1.8,−.2,−.3)
and γ = (−1,1,−1,2,−2,2)′ for each scenario so that the outcome prevalence is ap-
proximately 50 percent.
4.4.1.2
KD = KC = 1
Further, we consider the null case when there does not exist mixture/latent class
for either the mean or the variance proﬁles by dropping the corresponding second
mixture components where Di = Ci = 0. Consequently, the primary probit models for
the health outcomes are:
1. latent class (LC) probit submodel:
Φ−1 {P(oi = 1)} = θ0;
(4.11)
90

2. multiple shared random effect (MSRE) probit submodel:
Φ−1 {P(oi = 1)} = γ0 +γ1bi0 +γ2bi1 +γ3σ2
i +γ4bi0σ2
i +γ5bi1σ2
i .
(4.12)
For each scenario, we simulate 100 data sets and report the models (i.e., KD and
KC) selected by each selection criteria under variour scenarios, equivalently to those
in Section 4.4.1.1, but only consider the ﬁtted models with KD = 1,2 and KC = 1,2.
4.4.2
Simulation Results
4.4.2.1
KD = KC = 2
Among the 100 simulated data sets, in Tables 4.1 to 4.4, we report the number
of times each model, indicated by particular numbers of mixture components (KD,
KC), is selected by one of the criteria given in the ﬁrst column. Table 4.1 and 4.2
show the results when the true data-generating model has LC structure while Ta-
ble 4.3 and 4.4 reports those under the MSRE structure. In general, separations in
mixture components play an important role in the performances of these criteria in
identifying the correct number of components: when there is a sufﬁciently large de-
gree of separation in either the mean or the variance proﬁles, it is generally easier to
choose the correct number of components. Scenario (a)-(d) represent different levels
of separation of mean (or variance) components, as indicated in the Tables. Mixing
proportion might also play a role in selecting correct numbers of mixture compo-
nents. We use an unbalanced 20% vs. 80% mixing design to create some asymmetry
in the mixture density. In our study, all criteria seem to perform slightly better in
the cases of the unbalanced design. Incorrectly assuming the outcome structure has
some impacts on the performances of these criteria, the degrees of impact depend
on the criteria and hence the goal in model selection, as well as the true association
structure in the outcome model. In particular, the outcome-informed artifacts due to
91

ﬁtting an LC structure to the data generated under a true MSRE model, reported in
Chapter II, also have some connection with the performances of these criteria, which
we re-visit later in this section.
Overall, under the correctly assumed association structure in the primary out-
come model, the modiﬁed AIC, BIC and ICL perform very well in selecting the correct
numbers of components even for the harder to separate mixture scenarios. When the
true structure in the primary outcome model is LC, the modiﬁed AIC, BIC and ICL
still perform equally well regardless of ﬁtting LC or MSRE models. However, when
the true structure is MSRE, ﬁtting an LC structure can affect the performances of
the modiﬁed AIC, BIC and ICL. This phenomenon is most prominent for scenario (a)
in Table 4.3. The reported results corresponding to the two different versions of AIC,
BIC, ICL or WAIC differ sometimes, but not to a noteworthy level, and therefore we
do not differentiate the summary according to the versions used.
In contrast, DIC, LPML and WAIC tend to choose too many components for both
the mean and the variance in all scenarios. In particular, the numbers of mixture
components selected by WAIC and LPML tend to agree regardless of the ﬁtted model
structure used in the primary outcome model. More interestingly to note is that,
when ﬁtting with a joint LC model, both WAIC and LPML tend to always select
the numbers of components that lead to a higher AUC value. When ﬁtting with a
joint MSRE models, WAIC and LPML still tend to select models with more mixture
components for both the mean and the variance, but the model based on such a
selection does not have a higher value of the AUC. In fact, the AUC values vary little
under different ﬁtted models.
As we can see from the AUC values given in Tables 4.1 and 4.2, even correctly
assuming the LC structure can lead to either (i) lower or (ii) higher AUC values
than the AUC values by the true models. We believe that (i) is due to the difﬁculty
to separate the mixture components of the means and, as a consequence, leads to
92

high potential for misclassiﬁcation. An extreme case is when almost all subjects
are assigned to one mixture component and the prediction of the outcome is solely
determined by the variance proﬁle, which results in worse prediction ability than
the true model. On the other hand, (ii) is likely due to the outcome-informed artifact,
where subjects are assigned to spurious mixture components to generate predictions
that are more accurate than those obtained with the true model, as discussed in
Chapter II. Meanwhile, ﬁtting joint MSRE models when LC is the true structure
only leads to slightly loss of the predictive power relative to the true model, when
the mixture components within the mean proﬁle overlap; otherwise the AUC values
obtained by the MSRE model are similar to the true model.
On the other hand, as shown in Tables 4.1 and 4.2, when MSRE is the true data-
generating mechanism, the AUC values obtained by ﬁtting the joint MSRE models
are always close to the AUC values by the true models in all scenarios we consider,
indicating that the predictive ability under such scenarios is not affected much by
any potential misclassiﬁcation due to the overlapping mixture components. How-
ever, when MSRE is the true structure, ﬁtting LC models would lead to either an
increase in predictive power, indicated by extremely high AUC values due to artiﬁ-
cially recognized new components, or loss of predictive power with low AUC values,
originated from replacing a set of continuous variables (i.e., MSRE) by a discretized
version (i.e., LC) in the primary outcome model. Because of these mentioned poten-
tials when ﬁtting joint LC and MSRE models, all criteria suggest that it is difﬁcult
in differentiating the LC and MSRE models under the scenarios with overlapping
components. Table 4.5, focusing on the performances of all criteria in distinguish-
ing between LC and MSRE assumed structure with the true numbers of mixture
components, further illustrates this phenomenon. Each criterion could be in favor
of the structure other than the true data-generating one, notably when the mixture
components overlap. The performances of LPML and WAIC consistently reﬂect such
93

difﬁculties by frequently favoring the models with higher AUC values regardless of
the truth.
4.4.2.2
KD = KC = 1
As shown in Table 4.6, under the true LC model and for all ﬁtting structures, the
modiﬁed AIC, BIC and ICL all perform very well when distinct mixture components
do not exist for both the mean and the variance. The AICs behave slightly different
from BIC and ICL, in favor of more complex structures at times. DIC, LPML and
WAIC have the tendency to select models with too many mixture components, where
LPML and WAIC tend to select the number of components that lead to higher AUC
values. This once again suggests that WAIC and LPML tend to select models with
high prediction accuracy regardless of true association structure.
Under this null structure, we clearly see that the joint LC model has the ability to
create additional outcome-informed components that lead to misleadingly high AUC
values. The highest spurious AUC value is 0.97 as shown in Table 4.6 when the true
model is MSRE, giving the impression of almost perfect prediction when there is no
mixture at all in either the mean or the variance proﬁles. In this case, all criteria
under the assumed LC model tend to choose more numbers of components than that
of the data-generating scheme, reaching a better goodness-of-ﬁt.
4.5
Validation of the models selected by different criteria
It is well known that using the predictive model built on the same data set where
the prediction is conducted would lead to optimistically biased prediction evaluation.
In this section, we conduct evaluations of different model-selection criteria using
newly generated independent samples to obtain a fair assessment of the predictive
performances. With Tables 1 to 4.6 showing that the key over-ﬁtting phenomenon
reﬂected by AUC is preserved in the the simplest data-generation scheme of KD =
94

KC = 1, we focus on this setup and again allow the ﬁtted models to have 1 or 2
components. We choose this particular scenario as an extreme case of completely
overlapped mixture components to amplify the effects of potential outcome-informed
artifacts by ﬁtting LC models, since the true LC model is essentially a null model
with AUC=0.5. For this simplest scenario, we observe that the joint LC models with
KD > 1 or KC > 1 could lead to exceedingly high AUC values relative to the true
AUC, and that such joint LC models are frequently favored by LPML and WAIC.
On the positive side, when the observations are generated from the MSRE model
but ﬁtted with LC ones, the models selected by LPML, WAIC and DIC do result in
better prediction performances on the validation samples. The obtained outcomes
also allow us to see whether such high predictive accuracy is real or an artifact.
For each data set {(y(s)
i ,o(s)
i )}n
i=1, s = 1,··· ,100, generated from the given true joint
LC and MSRE models, we generate an additional new validation data set {(˜y(s)
i , ˜o(s)
i )} ˜n
i=1,
˜n = 50.
We use H(s)
a
to denote the model selected by model selection criteria a ∈
{DIC,LPML,AIC1,BIC1,ICL1,WAIC1} for the data set {(y(s)
i ,o(s)
i )}n
i=1 and then each
H(s)
a has unique values of KD and KC.
When introducing our target prediction, we drop the superscript (s) in the no-
tations for notational simplicity. We also split the model parameter vector φ into
two components: 1) φlong =
³
{βd}KD
d=1,{Σd}KD
d=1,{πD
d }KD
d=1,{µc}KC
c=1,τ2,{πC
c }KC
c=1
´T
, includ-
ing all the population level parameters in the longitudinal submodel, and 2) η, the
vector of coefﬁcients in the primary outcome model. We let ˜z =
¡ ˜D, ˜C, ˜b, ˜σ
¢T include
all individual level latent variables for the new validation sample and, compatibly,
z = (D,C,b,σ)T includes all such latent variables for the original sample set used to
obtain the ﬁtted model. The prediction of the primary outcome for new validation
95

sample is then based on the following quantity,
p(˜o|˜y,y,o,Ha)
=
Z
p
¡
˜o|˜z,η,Ha
¢
p
³
˜z,z,φlong,η|˜y,y,o,Ha
´
dφlongdηd˜zdz
≃1
M
M
X
m=1
p
³
˜o|˜z(m),η(m),Ha
´
(4.13)
where, ˜z(m),z(m),φ(m)
long and η(m), for m = 1,··· ,M are drawn from the posterior dis-
tribution p(˜z,z,φlong,η|˜y,y,o,Ha). Details of the MCMC sampling algorithm are
given in the Appendix.
Further, ˜p(m)
i
:= p( ˜oi = 1|η(m), ˜z(m)
i
) can be obtained from
Φ((η(m))TZ(m)
i
) as described in (4.3).
Then, for each validation data set, we focus on two performance measures: 1)
the posterior predictive mean squared error (PMSE): PMSE = M−1 PM
m=1PMSE(m),
where PMSE(m) = ˜n−1 P ˜n
i=1( ˜opred,(m)
i
−˜oi)2 with ˜opred,(m)
i
as a draw of a Bernoulli
random variable with success probability ˜p(m)
i
; 2) the area under the ROC curve
AUC = M−1 PM
m=1AUC(m) (i.e., test AUC), where AUC(m) is obtained based on ˜p(m)
i
,
i = 1,··· , ˜n, using the approach as described in Section 4.
For each criteria a, we calculate the posterior PMSE and test AUC for the valida-
tion sample {(˜y(s)
i , ˜o(s)
i )} ˜n
i=1 ﬁtted by model H(s)
a , s = 1,··· ,100, and report the posterior
mean PMSE and AUC as well as the 95% credible intervals based on 100 simulations.
As a comparison, we also summarize the training AUC for the sample {(y(s)
i ,o(s)
i )} ˜n
i=1
that are reported in Table 4.6 for each criteria. We then repeat this procedure for the
two simulation scenarios as described in previous section: when the data is generated
from the joint LC and the joint MSRE model, respectively.
Table 4.7 shows the PMSE and test AUC for the new validation test samples,
along with the AUC for the training samples, based on the selected models by DIC,
LPML, modiﬁed AIC1, BIC1 and ICL1, as well as WAIC1, respectively. When the
data is generated from the LC models with KD = KC = 1, the true AUC is always 0.5.
96

Fitting both LC and MSRE models leads to comparable predictive performances on
the test sample, with the values of PMSE and test AUC varying little among different
model selection criteria, and the estimates of training AUC all centering around the
true value. As expected, the values of test AUC are slightly smaller than those of the
training AUC.
When ﬁtting joint MSRE models, the values of PMSE and test AUC vary little
among different model selection criteria, with the 95% credible intervals of training
AUC always covering the true AUC value for the test sample, regardless of the true
structure in the primary outcome model. In particular, when the data are generated
from LC models, ﬁtting MSRE models leads to comparable predictive performances
on the validation sample in comparison to those obtained by LC models. We note
that this is due to choosing the setups of the LC and MSRE models to be compatible
to each other. As expected, the values of test AUC are slightly smaller than those of
the training AUC.
In contrast, when we study LC ﬁtting, the values of training/test AUC and PMSE
differ for different criteria and are affected by the true data generation mechanism.
When ﬁtting the LC generated data, DIC, LPML and WAIC frequently select the
models that better classify the outcome with higher training AUC values than those
chosen by other criteria. However, the values of PMSE and test AUC do not vary
much by different criteria, with the training AUC centering around the true value
0.5, indicating that the better predictive performance of the models selected by LPML
and WAIC is likely due to potential overﬁtting. When the data is generated from the
MSRE models, the LC models selected by DIC, LPML and WAIC lead to a higher
number and potentially outcome-informed mixture components, and consequently to
the optimistically-biased training AUC relative to the test AUC. The joint LC models
chosen by LPML, WAIC and DIC still lead to higher test AUC and lower MPSE, in-
dicating somewhat more accurate prediction for validation sample than the models
97

chosen by other criteria. The modiﬁed AIC1, BIC1 and ICL1, which tend to select
the correct numbers of mixture components frequently, perform as expected for the
training versus test samples, suggesting the validity of the compatibly chosen mod-
els. Since now the data is generated from the MSRE models, ﬁtting LC models causes
inferior predictive performances on the validation sample in comparison to those ob-
tained by MSRE models. However, only focusing on the predictive performance on
the training sample leads to an impression that LC models tend to classify the out-
come much better.
4.6
Penn ovarian aging study revisited
In this section, we use the knowledge obtained from the simulation study to guide
us to identify the plausible models in Penn ovarian aging study with the purpose of
linking the longitudinal trajectory of Follicle Stimulating Hormone (FSH) and the
occurrence of severe hot ﬂashes during the study period. In our analysis, a total of
4,244 FSH values were observed for the ﬁnal sample of 245 women, with a minimum
of 3 and a maximum of 26 observations per woman.
Of the 245 women without
severe hot ﬂash symptoms at baseline, 118 (48.2%) had experienced the outcome of
interest, an indicator variable for experiencing severe hot ﬂashes at least once during
the study. We ﬁt both joint LC and MSRE models, as described in Section 2, to the
FSH trajectories and severe hot ﬂash outcome data, adjusting for baseline log(BMI)
and smoking indicator in the primary outcome model (2).
Table 4.8 reports the model selection statistics for the joint LC and MSRE model
for the analysis of Penn ovarian aging study, with KD and KC ∈{1, 2, 3}, respec-
tively. For both joint LC and MSRE models, DIC, the modiﬁed AIC, BIC and ICL
choose KD = 1 and KC = 2, while LPML and WAIC prefer models with more mix-
ture components. Under the joint MSRE model, the AUC in the primary outcome
model vary little, with the values being likely close to the truth. The AUC for the
98

joint LC model is elevated in models with more latent classes and WAIC and LPML
tend to favor such LC models, likely due to their higher AUC values. This overall
ﬁnding is not surprising and reﬂects some typical behaviors of these criteria as we
have observed in the simulation study. In particular, the outcomes in our simulation
study suggest that the notable difference between the AUC under the joint LC model
chosen by WAIC, with KD = KC = 3, and the AUC under the MSRE model with any
values of KD and KC implies potential over-ﬁtting of the larger model. As the second
best choice for both LC and MSRE models, the model with KD = KC = 2 is favored by
DIC, the modiﬁed AIC and BIC. The true model is likely to be a model of KC = 2 and
KD = 1 or, alternatively, KD = 2 but with the two components closely overlapped with
each other. However, as already indicated by AUC values, assuming KD = 2 instead
of KD = 1 when KC = 2 had very little impact on the predictive power for both joint
LC and MSRE models; Chapter II also reported that the effect of mean proﬁle is
not signiﬁcantly associated with the risk of severe hot ﬂash in the primary outcome
model using both models. Therefore, KD = 1 and KC = 2 is the most parsimonious
choice for both joint LC and MSRE models.
Finally, in terms of choosing between LC and MSRE models assuming KD = 1 and
KC = 2, DIC, the modiﬁed AIC, BIC and ICL do not choose the same model although
these statistics from the two models are very similar, indicating similar ﬁt to the
FSH trajectories and severe hot ﬂash outcome. The LC and MSRE models also share
similar overall prediction performance; with ∆AUC being .04 and the corresponding
credible set covering 0, (−0.04,0.11), as reported in Chapter II. The advantages of
studying this data set using both modeling approaches with different evaluation cri-
teria lie on a higher level of conﬁdence that suitable models are used and that the
results are not heavily determined by the assumed model.
99

4.7
Discussion
In this article, we studied several commonly-used model selection criteria in terms
of choosing the numbers of mixture components in a joint modeling context, when
both correctly and incorrectly assuming the association structure to link the longi-
tudinal submodel and the primary outcome model. These criteria are all built upon
Bayesian principles in the sense that they are evaluated over the entire posterior dis-
tribution rather than conditional on single point estimates. In particular, DIC and
the modiﬁed AIC, BIC, ICL are based on deviance, while LPML is based on leave-
one-out cross validated predictive density, which is shown by Watanabe (2010) to be
asymptotically equivalent to WAIC.
In terms of choosing the numbers of mixture components, the performances of the
modiﬁed AIC, BIC and ICL appear to be more reliable and predictable than other cri-
teria when ﬁtting joint LC and MSRE models with correctly assumed structure in the
primary outcome model in the sense that, when the mixture components are easily
separated, they frequently identify the correct numbers of mixture components while
when the mixture components are fairly overlapped and hence difﬁcult to separate,
they frequently choose one instead of multiple mixture components. On the contrary,
the numbers of mixture components chosen by DIC, LPML and WAIC are often more
than the truth for the purpose of reaching improved prediction. In particular, WAIC
and LPML tend to select the same models with higher AUC values relative to the
models selected by other criteria.
For joint MSRE models, assuming different numbers of mixture components is
not crucial in deciding the predictive performance as assessed by AUC values; how-
ever, for joint LC models, the predictive performance is closely related to the assumed
numbers of mixture components. In particular, when the mixture components are dif-
ﬁcult to separate and the true structure is MSRE, joint LC models tend to have high
chance of artiﬁcially creating spurious mixture components to enhance AUC values
100

for the sample that is used to derive the model, giving the impression of much better
prediction power by LC models than MSRE models. This phenomenon could cause
some of our considered criteria to frequently choose incorrect numbers of mixture
components and favor speciﬁc LC structure.
When this happens, our simulation studies suggest that new independent sam-
ple validation can be helpful to conﬁrm whether the chosen models are suitable for
the desired purposes. We ﬁnd that the test AUC values for the validation sample
based on the models chosen by WAIC and LPML also tend to be higher than the test
AUC values based on the models chosen by other criteria. One needs to be cautious,
though, that the overly optimistic training AUC values relative to the test AUC val-
ues contradicts the validity of the chosen models and therefore suggests that the
seemingly high predictive power of the chosen LC models is unlikely to be the truth.
Based on our experience in the simulation study and the data example, we sug-
gest ﬁtting both LC and MSRE models and comparing the two sets of results with
the same numbers of mixture components. When the outcome-informed artifact is
present, the inference about the mixture components from the two models usually do
not match and the AUC value obtained by LC model is often much higher than that
by MSRE model. Otherwise, the two models assuming the same numbers of mixture
components tend to lead to similar inference results, including similar scientiﬁc in-
terpretation in the primary outcome and similar predictive power assessed by AUC.
In addition to comparing the results by different model selection criteria, these rules
can be helpful to guide us to choose the suitable models the best we can in practice.
101

−5
0
5
−4
0
2
4
6
overlapped: mean profile
random intercpet
random slope
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
GG
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
4
(2.83,2.83)
(0,0)
ω2=2
−4
−3
−2
−1
0
1
2
0.0
0.2
0.4
0.6
overlapped: variance
log(variance)
density
τ2=.4
−5
0
5
−4
0
2
4
6
separated: mean profile
random intercpet
random slope
G
G
G
G G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G G
G
G
G
G
G
G
G
G
G
GG
G
G
GG
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
GG
G
G
G
G
G
G
G
G
G
G
4
(2.83,2.83)
(0,0)
ω2=1
−4
−3
−2
−1
0
1
2
0.0
0.5
1.0
1.5
separated: variance
log(variance)
density
τ2=.06
Figure 4.1: Simulation setup for the mean and variance proﬁles representing low
versus high levels of separation. Left panels: 95% contour plots of the
two components for the mean proﬁles; right panels: density plots of the
two components for the variance proﬁles.
102

Table 4.1: Number of times each speciﬁed ﬁtted model are selected by using the
10 criteria given in the ﬁrst column of each sub-table. Observations are
generated as described in Section 4.4.1 under the joint LC model with
KD = KC = 2 and the (TD,TC) mixture structure for the mean and the vari-
ance proﬁles, respectively, where TD,TC ∈{separated, overlapped}. Sce-
narios (a)-(d) specify the data-generating mechanism. The ﬁtted models
consist of both LC and MSRE structures with KD = 1,2,3 and KC = 1,2,3.
The mixing proportions are 50-50. The corresponding values of AUC were
reported at the end of the table for each scenario. The “true AUC” is the
AUC obtained when predictions are generated using the correct outcome
model (true parameters and random effects/latent classes).
ﬁtting LC model (KD,KC)
ﬁtting MSRE model (KD,KC)
(1,1)
(1,2)
(1,3)
(2,1)
(2,2)
(2,3)
(3,1)
(3,2)
(3,3)
(1,1)
(1,2)
(1,3)
(2,1)
(2,2)
(2,3)
(3,1)
(3,2)
(3,3)
(a) true model=LC; (separated, separated) mixtures; 50:50 proportion
No. of times selected from 100 simulations
DIC
0
0
0
0
26
0
0
73
1
0
0
0
0
36
1
0
62
1
LPML
0
0
0
0
8
47
0
5
40
0
11
11
0
15
33
0
7
23
AIC1
0
0
0
0
90
1
0
9
0
0
0
0
0
90
1
0
8
1
AIC2
0
0
0
0
88
1
0
11
0
0
0
0
0
85
1
0
13
1
BIC1
0
0
0
0
99
1
0
0
0
0
0
0
0
98
1
0
1
0
BIC2
0
0
0
0
99
1
0
0
0
0
0
0
0
97
1
0
2
0
ICL1
0
0
0
1
98
1
0
0
0
0
0
0
0
98
1
0
1
0
ICL2
0
0
0
1
98
1
0
0
0
0
0
0
0
98
1
0
1
0
WAIC1
0
0
0
0
0
49
0
0
51
0
14
51
0
4
26
0
0
5
WAIC2
0
0
0
0
1
68
0
1
30
0
31
24
0
16
22
0
2
5
Area under the ROC curves
true AUC=0.81
0.5
0.54
0.66
0.79
0.81
0.85
0.79
0.82
0.86
0.81
0.81
0.81
0.81
0.81
0.81
0.81
0.81
0.81
(b) true model=LC; (overlapped, overlapped) mixtures; 50:50 proportion
No. of times selected from 100 simulations
DIC
56
0
0
2
0
0
42
0
0
27
0
0
17
0
0
56
0
0
LPML
0
0
1
3
13
38
2
15
28
9
14
22
10
13
12
5
8
7
AIC1
76
0
0
19
0
0
5
0
0
80
0
0
17
0
0
3
0
0
AIC2
70
0
0
21
0
0
9
0
0
72
0
0
23
0
0
5
0
0
BIC1
94
0
0
6
0
0
0
0
0
100
0
0
0
0
0
0
0
0
BIC2
92
0
0
8
0
0
0
0
0
99
0
0
1
0
0
0
0
0
ICL1
100
0
0
0
0
0
0
0
0
100
0
0
0
0
0
0
0
0
ICL2
100
0
0
0
0
0
0
0
0
100
0
0
0
0
0
0
0
0
WAIC1
0
0
0
0
2
60
1
0
37
32
19
27
9
8
1
0
1
3
WAIC2
0
0
2
0
2
65
1
0
30
16
25
36
4
8
5
1
0
5
Area under the ROC curves
true AUC=0.81
0.5
0.63
0.72
0.78
0.85
0.88
0.78
0.85
0.88
0.77
0.77
0.77
0.77
0.77
0.77
0.77
0.77
0.77
(c) true model=LC; (overlapped, separated) mixtures; 50:50 proportion
No. of times selected from 100 simulations
DIC
0
57
0
0
3
2
0
37
1
0
41
1
0
12
1
0
45
0
LPML
0
0
0
0
13
43
0
11
33
0
9
28
0
16
19
0
13
15
AIC1
0
80
0
0
17
1
0
2
0
0
81
1
0
14
1
0
3
0
AIC2
0
72
0
0
24
1
0
3
0
0
76
1
0
19
1
0
3
0
BIC1
0
97
1
0
2
0
0
0
0
0
98
2
0
0
0
0
0
0
BIC2
0
94
0
0
5
1
0
0
0
0
98
2
0
0
0
0
0
0
ICL1
0
99
1
0
0
0
0
0
0
0
99
1
0
0
0
0
0
0
ICL2
0
99
1
0
0
0
0
0
0
0
99
1
0
0
0
0
0
0
WAIC1
0
0
1
0
2
66
0
0
31
0
22
45
0
0
20
0
3
10
WAIC2
0
0
0
0
2
65
0
1
32
0
39
19
0
16
7
0
14
5
Area under the ROC curves
true AUC=0.82
0.5
0.55
0.66
0.80
0.83
0.87
0.80
0.83
0.87
0.78
0.78
0.78
0.78
0.78
0.78
0.78
0.78
0.78
(d) true model=LC; (separated, overlapped) mixtures; 50:50 proportion
No. of times selected from 100 simulations
DIC
0
0
0
11
0
0
88
1
0
1
0
0
16
0
0
82
1
0
LPML
0
0
0
0
17
37
2
11
33
6
8
2
13
14
16
8
16
17
AIC1
0
0
0
85
0
0
15
0
0
1
0
0
77
1
0
21
0
0
AIC2
0
0
0
73
1
0
26
0
0
1
0
0
71
0
0
27
1
0
BIC1
0
0
0
100
0
0
0
0
0
1
0
0
98
0
0
1
0
0
BIC2
0
0
0
100
0
0
0
0
0
1
0
0
98
0
0
1
0
0
ICL1
0
0
0
100
0
0
0
0
0
2
0
0
98
0
0
0
0
0
ICL2
0
0
0
100
0
0
0
0
0
1
0
0
98
0
0
1
0
0
WAIC1
0
0
0
0
0
59
0
0
41
31
16
28
6
7
9
2
1
0
WAIC2
0
0
0
0
0
74
0
0
26
13
17
29
6
10
17
1
2
5
Area under the ROC curves
true AUC=0.82
0.5
0.65
0.73
0.79
0.85
0.88
0.79
0.85
0.88
0.81
0.81
0.81
0.81
0.81
0.81
0.81
0.81
0.81
103

Table 4.2: As in Table 4.1 but the mixing proportions are 80-20.
ﬁtting LC model (KD,KC)
ﬁtting MSRE model (KD,KC)
(1,1)
(1,2)
(1,3)
(2,1)
(2,2)
(2,3)
(3,1)
(3,2)
(3,3)
(1,1)
(1,2)
(1,3)
(2,1)
(2,2)
(2,3)
(3,1)
(3,2)
(3,3)
(a) true model=LC; (separated, separated) mixtures; 20:80 proportion
No. of times selected from 100 simulations
DIC
0
0
0
0
27
0
0
73
0
0
0
0
0
41
0
0
59
0
LPML
0
0
0
0
3
51
0
2
44
0
6
4
0
16
36
0
13
25
AIC1
0
0
0
0
96
0
0
4
0
0
0
0
0
93
0
0
7
0
AIC2
0
0
0
0
95
0
0
5
0
0
0
0
0
83
0
0
17
0
BIC1
0
0
0
0
100
0
0
0
0
0
0
0
0
100
0
0
0
0
BIC2
0
0
0
0
100
0
0
0
0
0
0
0
0
100
0
0
0
0
ICL1
0
0
0
0
100
0
0
0
0
0
0
0
0
100
0
0
0
0
ICL2
0
0
0
0
100
0
0
0
0
0
0
0
0
100
0
0
0
0
WAIC1
0
0
0
0
0
60
0
0
40
0
18
67
0
4
7
0
0
4
WAIC2
0
0
0
0
0
67
0
0
33
0
24
34
0
12
15
0
3
12
Area under the ROC curves
true AUC=0.72
0.5
0.55
0.70
0.68
0.72
0.81
0.69
0.72
0.81
0.73
0.74
0.74
0.73
0.74
0.74
0.73
0.74
0.74
(b) true model=LC; (overlapped, overlapped) mixtures; 20:80 proportion
No. of times selected from 100 simulations
DIC
12
1
0
17
0
0
70
0
0
19
0
0
22
1
1
57
0
0
LPML
0
3
15
1
5
38
1
8
29
18
17
15
13
7
10
12
4
4
AIC1
64
1
0
28
0
0
7
0
0
75
1
1
21
0
0
2
0
0
AIC2
54
1
0
35
0
0
10
0
0
71
1
1
25
0
0
2
0
0
BIC1
95
1
0
4
0
0
0
0
0
97
1
1
1
0
0
0
0
0
BIC2
93
1
0
6
0
0
0
0
0
97
1
1
1
0
0
0
0
0
ICL1
100
0
0
0
0
0
0
0
0
99
0
0
1
0
0
0
0
0
ICL2
100
0
0
0
0
0
0
0
0
99
0
0
1
0
0
0
0
0
WAIC1
0
0
9
0
2
39
0
2
48
11
29
32
3
5
9
1
4
6
WAIC2
0
1
17
0
2
44
0
1
35
7
31
30
6
7
10
1
2
6
Area under the ROC curves
true AUC=0.72
0.5
0.63
0.73
0.59
0.70
0.78
0.60
0.71
0.78
0.69
0.69
0.69
0.69
0.69
0.69
0.69
0.69
0.69
(c) true model=LC; (overlapped, separated) mixtures; 20:80 proportion
No. of times selected from 100 simulations
DIC
0
23
0
0
10
0
0
67
0
0
26
0
0
18
0
0
56
0
LPML
0
0
11
0
5
44
0
4
36
0
12
27
0
10
21
0
12
18
AIC1
0
72
1
0
23
0
0
4
0
0
78
0
0
19
0
0
3
0
AIC2
0
58
1
0
34
0
0
7
0
0
76
0
0
19
0
0
5
0
BIC1
0
94
0
0
6
0
0
0
0
0
98
0
0
2
0
0
0
0
BIC2
0
91
0
0
9
0
0
0
0
0
97
0
0
3
0
0
0
0
ICL1
0
99
0
0
1
0
0
0
0
0
99
0
0
1
0
0
0
0
ICL2
0
99
0
0
1
0
0
0
0
0
99
0
0
1
0
0
0
0
WAIC1
0
0
6
0
0
43
0
0
51
0
16
46
0
3
23
0
4
8
WAIC2
0
0
8
0
2
50
0
0
40
0
30
27
0
13
11
0
12
7
Area under the ROC curves
true AUC=0.72
0.5
0.54
0.70
0.60
0.64
0.76
0.60
0.65
0.77
0.70
0.70
0.70
0.70
0.70
0.70
0.70
0.70
0.70
(d) true model=LC; (separated, overlapped) mixtures; 20:80 proportion
No. of times selected from 100 simulations
DIC
0
0
0
23
0
0
76
1
0
0
0
0
24
0
0
74
2
0
LPML
0
0
0
2
7
40
1
6
44
0
1
2
23
18
18
20
14
4
AIC1
0
0
0
90
1
0
9
0
0
0
0
0
89
0
0
11
0
0
AIC2
0
0
0
87
1
0
12
0
0
0
0
0
85
2
0
13
0
0
BIC1
0
0
0
99
0
0
1
0
0
0
0
0
100
0
0
0
0
0
BIC2
0
0
0
99
0
0
1
0
0
0
0
0
99
0
0
1
0
0
ICL1
0
0
0
99
0
0
1
0
0
0
0
0
100
0
0
0
0
0
ICL2
0
0
0
99
0
0
1
0
0
0
0
0
100
0
0
0
0
0
WAIC1
0
1
0
0
0
56
0
0
43
11
30
34
4
5
13
0
2
1
WAIC2
0
0
0
0
0
68
0
1
31
9
20
24
13
9
17
3
4
1
Area under the ROC curves
true AUC=0.72
0.5
0.63
0.74
0.69
0.77
0.83
0.69
0.77
0.83
0.72
0.72
0.72
0.72
0.72
0.72
0.72
0.72
0.72
104

Table 4.3: As in Table 4.1 but the observations are generated under the joint MSER
model.
ﬁtting LC model (KD,KC)
ﬁtting MSRE model (KD,KC)
(1,1)
(1,2)
(1,3)
(2,1)
(2,2)
(2,3)
(3,1)
(3,2)
(3,3)
(1,1)
(1,2)
(1,3)
(2,1)
(2,2)
(2,3)
(3,1)
(3,2)
(3,3)
(a) true model=MSRE; (separated, separated) mixtures; 50:50 proportion
No. of times selected from 100 simulations
DIC
0
1
0
0
25
4
0
65
5
0
0
0
0
37
1
0
60
2
LPML
0
3
14
0
8
47
0
3
25
0
6
7
0
21
32
0
11
23
AIC1
0
1
0
0
57
5
0
34
3
0
0
0
0
88
3
0
9
0
AIC2
0
1
0
0
55
5
0
36
3
0
0
0
0
81
3
0
16
0
BIC1
0
3
0
0
73
4
0
19
1
0
0
0
0
94
3
0
3
0
BIC2
0
2
0
0
72
4
0
20
2
0
0
0
0
94
3
0
3
0
ICL1
0
5
0
0
74
2
0
19
0
0
1
0
0
97
1
0
1
0
ICL2
0
5
0
0
71
3
0
21
0
0
1
0
0
96
1
0
2
0
WAIC1
0
0
18
0
7
45
0
1
29
0
24
45
0
8
18
0
1
4
WAIC2
0
0
31
0
8
48
0
1
12
0
37
21
0
19
13
0
4
6
Area under the ROC curves
true AUC=0.82
0.5
0.64
0.72
0.52
0.70
0.80
0.54
0.70
0.77
0.81
0.81
0.81
0.81
0.81
0.81
0.81
0.81
0.81
(b) true model=MSRE; (overlapped, overlapped) mixtures; 50:50 proportion
No. of times selected from 100 simulations
DIC
15
0
0
11
3
0
56
13
2
23
0
0
17
0
0
60
0
0
LPML
0
1
2
0
32
30
0
20
15
13
24
17
8
7
11
5
6
9
AIC1
74
0
0
15
8
1
2
0
0
84
0
0
13
0
0
3
0
0
AIC2
63
0
0
18
13
1
5
0
0
73
0
0
21
0
0
6
0
0
BIC1
98
0
0
0
2
0
0
0
0
100
0
0
0
0
0
0
0
0
BIC2
95
0
0
1
4
0
0
0
0
99
0
0
1
0
0
0
0
0
ICL1
99
0
0
0
1
0
0
0
0
100
0
0
0
0
0
0
0
0
ICL2
99
0
0
0
1
0
0
0
0
100
0
0
0
0
0
0
0
0
WAIC1
0
1
3
0
50
18
0
20
8
23
32
26
3
3
8
3
0
2
WAIC2
0
1
4
0
39
27
0
17
12
7
30
38
1
5
14
1
1
3
Area under the ROC curves
true AUC=0.85
0.5
0.74
0.79
0.52
0.91
0.92
0.53
0.92
0.93
0.85
0.85
0.85
0.85
0.85
0.85
0.85
0.85
0.85
(c) true model=MSRE; (overlapped, separated) mixtures; 50:50 proportion
No. of times selected from 100 simulations
DIC
0
65
3
0
3
2
0
18
9
0
38
2
0
16
2
0
42
0
LPML
0
0
3
0
10
44
0
8
35
0
19
31
0
7
21
0
8
14
AIC1
0
83
3
0
7
6
0
0
1
0
81
4
0
10
0
0
5
0
AIC2
0
77
3
0
10
4
0
1
5
0
79
4
0
12
0
0
5
0
BIC1
0
95
2
0
0
3
0
0
0
0
97
3
0
0
0
0
0
0
BIC2
0
94
2
0
0
4
0
0
0
0
96
4
0
0
0
0
0
0
ICL1
0
98
1
0
0
1
0
0
0
0
98
2
0
0
0
0
0
0
ICL2
0
98
1
0
0
1
0
0
0
0
97
3
0
0
0
0
0
0
WAIC1
0
0
0
0
0
54
0
3
43
0
26
54
0
3
9
0
2
6
WAIC2
0
0
0
0
2
55
0
4
39
0
42
27
0
9
10
0
6
6
Area under the ROC curves
true AUC=0.82
0.5
0.63
0.71
0.52
0.83
0.88
0.53
0.84
0.89
0.82
0.82
0.82
0.82
0.82
0.82
0.82
0.82
0.82
(d) true model=MSRE; (separated,overlapped) mixtures; 50:50 proportion
No. of times selected from 100 simulations
DIC
0
0
0
16
0
0
83
1
0
0
0
0
19
1
0
80
0
0
LPML
0
2
8
0
30
32
0
9
19
5
8
10
12
18
21
7
7
12
AIC1
0
0
0
79
0
0
21
0
0
0
0
0
78
1
0
21
0
0
AIC2
0
0
0
71
0
0
29
0
0
0
0
0
68
1
0
31
0
0
BIC1
2
0
0
94
1
0
3
0
0
1
0
0
91
1
0
7
0
0
BIC2
1
0
0
94
1
0
4
0
0
1
0
0
91
1
0
7
0
0
ICL1
2
0
0
95
0
0
3
0
0
2
0
0
91
0
0
7
0
0
ICL2
2
0
0
95
0
0
3
0
0
2
0
0
91
0
0
7
0
0
WAIC1
0
4
10
0
37
22
0
7
20
13
21
41
8
9
5
0
3
0
WAIC2
0
2
19
0
33
23
0
6
17
7
17
36
9
12
14
0
3
2
Area under the ROC curves
true AUC=0.85
0.5
0.75
0.80
0.53
0.85
0.88
0.54
0.81
0.86
0.85
0.85
0.85
0.85
0.85
0.85
0.85
0.85
0.85
105

Table 4.4: As in Table 4.2 but the observations are generated under the joint MSER
model.
ﬁtting LC model (KD,KC)
ﬁtting MSRE model (KD,KC)
(1,1)
(1,2)
(1,3)
(2,1)
(2,2)
(2,3)
(3,1)
(3,2)
(3,3)
(1,1)
(1,2)
(1,3)
(2,1)
(2,2)
(2,3)
(3,1)
(3,2)
(3,3)
(a) true model=MSRE; (separated, separated) mixtures; 20:80 proportion
No. of times selected from 100 simulations
DIC
0
0
0
0
18
0
0
82
0
0
0
0
0
25
0
0
74
1
LPML
0
1
12
0
0
36
0
1
50
0
2
5
0
16
37
0
10
30
AIC1
0
0
0
0
95
0
0
5
0
0
0
0
0
89
1
0
10
0
AIC2
0
0
0
0
86
0
0
14
0
0
0
0
0
87
1
0
12
0
BIC1
0
0
0
0
100
0
0
0
0
0
0
0
0
100
0
0
0
0
BIC2
0
0
0
0
100
0
0
0
0
0
0
0
0
100
0
0
0
0
ICL1
0
0
0
0
100
0
0
0
0
0
0
0
0
100
0
0
0
0
ICL2
0
0
0
0
100
0
0
0
0
0
0
0
0
100
0
0
0
0
WAIC1
0
0
28
0
0
37
0
0
35
0
25
53
0
5
9
0
1
7
WAIC2
0
1
47
0
0
29
0
0
23
0
25
28
0
13
15
0
8
11
Area under the ROC curves
true AUC=0.77
0.5
0.59
0.74
0.52
0.60
0.77
0.52
0.61
0.77
0.76
0.76
0.76
0.76
0.76
0.76
0.76
0.76
0.76
(b) true model=MSRE; (overlapped, overlapped) mixtures; 20:80 proportion
No. of times selected from 100 simulations
DIC
18
1
0
21
0
0
57
3
0
21
0
0
22
0
0
55
2
0
LPML
0
3
17
0
13
23
0
16
28
16
17
7
10
5
13
14
14
4
AIC1
83
2
0
12
1
0
2
0
0
78
2
0
18
0
0
2
0
0
AIC2
82
1
0
12
2
0
3
0
0
76
2
0
20
0
0
2
0
0
BIC1
99
1
0
0
0
0
0
0
0
98
1
0
1
0
0
0
0
0
BIC2
99
1
0
0
0
0
0
0
0
98
1
0
1
0
0
0
0
0
ICL1
100
0
0
0
0
0
0
0
0
99
0
0
1
0
0
0
0
0
ICL2
100
0
0
0
0
0
0
0
0
99
0
0
1
0
0
0
0
0
WAIC1
0
5
12
0
19
21
0
17
26
10
21
41
0
7
14
1
1
5
WAIC2
0
4
22
0
8
29
0
10
27
16
23
33
1
4
10
3
5
5
Area under the ROC curves
true AUC=0.82
0.5
0.77
0.82
0.51
0.81
0.85
0.51
0.82
0.85
0.82
0.82
0.82
0.82
0.82
0.82
0.82
0.82
0.82
(c) true model=MSRE; (overlapped, separated) mixtures; 20:80 proportion
No. of times selected from 100 simulations
DIC
0
19
1
0
28
0
0
51
1
0
27
0
0
23
0
0
50
0
LPML
0
1
39
0
2
27
0
0
31
0
11
35
0
6
22
0
6
20
AIC1
0
85
2
0
9
1
0
3
0
0
80
0
0
15
0
0
5
0
AIC2
0
80
2
0
13
1
0
4
0
0
73
0
0
20
0
0
7
0
BIC1
0
98
2
0
0
0
0
0
0
0
99
0
0
1
0
0
0
0
BIC2
0
98
2
0
0
0
0
0
0
0
97
0
0
3
0
0
0
0
ICL1
0
100
0
0
0
0
0
0
0
0
99
0
0
1
0
0
0
0
ICL2
0
100
0
0
0
0
0
0
0
0
99
0
0
1
0
0
0
0
WAIC1
0
0
27
0
0
30
0
0
43
0
19
51
0
6
13
0
4
7
WAIC2
0
0
38
0
0
30
0
0
32
0
22
36
0
11
16
0
5
10
Area under the ROC curves
true AUC=0.75
0.5
0.59
0.74
0.51
0.61
0.76
0.51
0.62
0.76
0.75
0.74
0.75
0.75
0.74
0.75
0.75
0.74
0.75
(d) true model=MSRE; (separated,overlapped) mixtures; 20:80 proportion
No. of times selected from 100 simulations
DIC
0
0
0
22
0
0
77
1
0
0
0
0
25
0
0
75
0
0
LPML
0
4
12
0
11
38
0
5
30
2
2
1
20
21
20
11
14
9
AIC1
0
0
0
92
1
0
7
0
0
0
0
0
90
0
0
10
0
0
AIC2
0
0
0
92
1
0
7
0
0
0
0
0
84
0
0
16
0
0
BIC1
0
0
0
99
1
0
0
0
0
0
0
0
100
0
0
0
0
0
BIC2
0
0
0
99
1
0
0
0
0
0
0
0
100
0
0
0
0
0
ICL1
0
0
0
100
0
0
0
0
0
0
0
0
100
0
0
0
0
0
ICL2
0
0
0
100
0
0
0
0
0
0
0
0
100
0
0
0
0
0
WAIC1
0
10
48
0
2
16
0
1
23
4
22
42
4
9
13
0
2
4
WAIC2
0
7
53
0
2
24
0
2
12
5
13
24
7
12
23
1
7
8
Area under the ROC curves
true AUC=0.84
0.5
0.74
0.80
0.52
0.75
0.82
0.53
0.76
0.82
0.84
0.84
0.84
0.84
0.84
0.84
0.84
0.84
0.84
106

Table 4.5: Number of times correct association structure identiﬁed by model selec-
tion criteria when comparing joint LC versus joint MSRE model with
KD = KC = 2. Observations are generated as described in Section 4.4.1
under both the joint LC and MSRE model with KD = KC = 2 and the
(TD,TC) mixture structure for the mean and the variance proﬁles, respec-
tively, where TD,TC ∈{separated, overlapped}. Scenarios (a)-(d) specify
the data-generating mechanism.
(a) true model=LC
AUC
No. of times LC model selected from 100 simulations
Truth
LC
MSRE
DIC
LPML
AIC1
AIC2
BIC1
BIC2
ICL1
ICL2
WAIC1
WAIC2
(separated, separated) mixtures; 50:50 proportions
0.81
0.81
0.81
65
81
76
73
94
92
97
96
91
89
(overlapped, overlapped) mixtures; 50:50 proportions
0.81
0.85
0.77
12
90
12
12
15
15
17
19
98
98
(overlapped, separated) mixtures; 50:50 proportions
0.82
0.83
0.78
10
88
12
12
14
14
13
13
96
90
(separated,overlapped) mixtures; 50:50 proportions
0.82
0.85
0.81
64
97
67
66
71
70
77
77
98
96
(separated, separated) mixtures; 20:80 proportions
0.72
0.72
0.74
29
67
40
37
68
68
70
68
90
85
(overlapped, overlapped) mixtures; 20:80 proportions
0.72
0.70
0.69
33
74
39
38
45
47
51
51
81
69
(overlapped, separated) mixtures; 20:80 proportions
0.72
0.64
0.70
2
47
4
4
10
11
9
10
58
52
(separated,overlapped) mixtures; 20:80 proportions
0.72
0.77
0.72
60
92
63
62
74
74
74
72
98
97
(b) true model=MSRE
AUC
No. of times MSRE model selected from 100 simulations
Truth
LC
MSRE
DIC
LPML
AIC1
AIC2
BIC1
BIC2
ICL1
ICL2
WAIC1
WAIC2
(separated, separated) mixtures; 50:50 proportions
0.82
0.70
0.81
100
87
100
100
100
100
100
100
83
90
(overlapped, overlapped) mixtures; 50:50 proportions
0.85
0.91
0.85
39
34
37
34
30
29
13
13
18
30
(overlapped, separated) mixtures; 50:50 proportions
0.82
0.83
0.82
97
46
97
97
93
93
91
92
35
50
(separated,overlapped) mixtures; 50:50 proportions
0.85
0.85
0.85
82
67
80
80
73
73
29
29
60
68
(separated, separated) mixtures; 20:80 proportions
0.77
0.60
0.76
97
99
95
95
93
93
92
93
100
100
(overlapped, overlapped) mixtures; 20:80 proportions
0.82
0.81
0.82
58
86
53
54
51
51
30
30
50
86
(overlapped, separated) mixtures; 20:80 proportions
0.75
0.61
0.74
96
95
96
96
91
93
91
92
98
97
(separated,overlapped) mixtures; 20:80 proportions
0.84
0.75
0.84
81
100
78
79
76
76
50
50
91
100
107

Table 4.6: Number of times each speciﬁed ﬁtted model are selected by using the 10
criteria given in the ﬁrst column of each sub-table. Observations are gen-
erated as described in Section 4.4.1 under the joint LC model for scenario
(a), and MSRE model for scenario (b), with KD = KC = 1. The ﬁtted mod-
els consist of both LC and MSRE strutures with KD = 1,2, and KC = 1,2.
The mixing proportions are 50-50. The corresponding values of AUC were
reported at the end of the table for each scenario.
ﬁtting LC model
ﬁtting MSRE model
(KD,KC)
(KD,KC)
(1,1)
(1,2)
(2,1)
(2,2)
(1,1)
(1,2)
(2,1)
(2,2)
(a) True model=LC
No. of times selected
DIC
9
0
91
0
10
0
90
0
LPML
0
58
0
42
30
23
22
25
AIC1
92
0
8
0
81
0
19
0
AIC2
76
0
24
0
72
0
28
0
BIC1
100
0
0
0
100
0
0
0
BIC2
100
0
0
0
100
0
0
0
ICL1
100
0
0
0
100
0
0
0
ICL2
100
0
0
0
100
0
0
0
WAIC1
0
46
0
54
43
41
9
7
WAIC2
0
56
0
44
27
49
10
14
Area under the ROC curves
true AUC=0.5
0.5
0.68
0.51
0.69
0.57
0.57
0.57
0.57
(b) True model=MSRE
No. of times selected
DIC
7
0
92
1
14
0
86
0
LPML
0
0
50
50
31
28
19
22
AIC1
15
0
84
1
84
0
16
0
AIC2
10
0
89
1
73
0
27
0
BIC1
42
0
58
0
100
0
0
0
BIC2
34
0
66
0
100
0
0
0
ICL1
69
0
31
0
100
0
0
0
ICL2
59
0
41
0
100
0
0
0
WAIC1
0
1
66
33
40
33
11
16
WAIC2
0
1
58
41
35
42
6
17
Area under the ROC curves
true AUC=0.88
0.5
0.69
0.95
0.97
0.88
0.88
0.88
0.88
108

Table 4.7: Values of AUC for independent validation sample ( ˜n = 50) based on the
models selected by DIC, LPML, AIC1, BIC1, ICL1 and WAIC1. Both the
new validation sample and the original sample to build the models are
generated as described in Section 4.4.1 under the the joint LC model, for
scenario (a), and MSRE model, for scenario (b), with KD = KC = 1.
ﬁtting joint LC
ﬁtting joint MSRE
PMSE
test AUC
training AUC
PMSE
test AUC
training AUC
(95% CI)
(95% CI)
(95% CI)
(95% CI)
(95% CI)
(95% CI)
(a) true model=LC (true test AUC=0.50)
DIC
0.50 (0.48,0.51)
0.50 (0.49,0.52)
0.51 (0.50,0.53)
0.50 (0.47,0.52)
0.50 (0.40,0.59)
0.57 (0.52,0.63)
LPML
0.50 (0.48,0.51)
0.50 (0.49,0.52)
0.68 (0.64,0.74)
0.50 (0.47,0.52)
0.50 (0.40,0.59)
0.57 (0.52,0.62)
AIC1
0.50 (0.48,0.51)
0.50 (0.50,0.50)
0.50 (0.50,0.53)
0.50 (0.47,0.52)
0.50 (0.40,0.59)
0.57 (0.52,0.62)
BIC1
0.50 (0.48,0.51)
0.50 (0.50,0.50)
0.50 (0.50,0.50)
0.50 (0.47,0.52)
0.50 (0.40,0.59)
0.57 (0.52,0.63)
ICL1
0.50 (0.48,0.51)
0.50 (0.50,0.50)
0.50 (0.50,0.50)
0.50 (0.47,0.52)
0.50 (0.40,0.59)
0.57 (0.52,0.63)
WAIC1
0.50 (0.48,0.51)
0.50 (0.48,0.52)
0.69 (0.65,0.74)
0.5 (0.47,0.52)
0.50 (0.40,0.59)
0.57 (0.52,0.62)
(b) true model=MSRE (true test AUC=0.88)
DIC
0.31 (0.24,0.44)
0.68 (0.50,0.76)
0.93 (0.50,0.98)
0.28 (0.22,0.35)
0.86 (0.76,0.93)
0.88 (0.85,0.93)
LPML
0.3 (0.24,0.36)
0.70 (0.63,0.76)
0.96 (0.93,0.98)
0.28 (0.22,0.34)
0.86 (0.76,0.93)
0.88 (0.85,0.93)
AIC1
0.32 (0.24,0.47)
0.66 (0.50,0.76)
0.89 (0.50,0.98)
0.28 (0.22,0.35)
0.86 (0.76,0.93)
0.88 (0.85,0.93)
BIC1
0.36 (0.24,0.49)
0.61 (0.50,0.75)
0.77 (0.50,0.98)
0.28 (0.22,0.34)
0.86 (0.76,0.93)
0.88 (0.85,0.93)
ICL1
0.4 (0.25,0.50)
0.56 (0.50,0.75)
0.65 (0.50,0.98)
0.28 (0.22,0.34)
0.86 (0.76,0.93)
0.88 (0.85,0.93)
WAIC1
0.3 (0.24,0.37)
0.69 (0.62,0.76)
0.96 (0.93,0.98)
0.28 (0.22,0.34)
0.86 (0.76,0.93)
0.88 (0.85,0.93)
109

Table 4.8: Model comparison statistics from different joint models for the analysis of
Penn ovarian aging data. The ten selection criteria are given in the ﬁrst
column of the table. The top and bottom panels correspond to the scenarios
of ﬁtting with the joint LC and MSRE models, respectively. Best ﬁt model
is given by boldface.
joint model (KD,KC)
(1,1)
(1,2)
(1,3)
(2,1)
(2,2)
(2,3)
(3,1)
(3,2)
(3,3)
ﬁtting joint LC model
DIC
6930.1
6857.9
7024.4
6924.5
6860.5
7020.9
6973.7
6899.9
7076.3
LPML
−3794.1
−3779.6
−3772.9
−3779.8
−3763.1
−3757.3
−3780.3
−3761.5
−3747.3
AIC1
6941.5
6875.7
7043.6
6943.7
6882.6
7051.2
7001.4
6934.9
7118.5
AIC2
6932.9
6864.9
7030.9
6928.9
6865.3
7031.5
6981.1
6911.9
7092.7
BIC1
6976.5
6921.3
7099.7
7003.3
6956.1
7138.7
7085.4
7036.4
7237.5
BIC2
6967.9
6910.5
7086.9
6988.5
6938.8
7119.0
7065.1
7013.4
7211.8
ICL1
6976.5
6949.5
7261.9
7131.7
7102.3
7392.5
7265.8
7222.4
7546.7
ICL2
6967.9
6938.4
7249.6
7117.3
7084.9
7372.8
7247.0
7200.0
7522.2
WAIC1
7078.8
7025.2
6986.4
7054.3
6997.1
6948.9
7045.9
6964.9
6938.7
WAIC2
7343.8
7305.0
7279.1
7322.6
7287.9
7258.8
7322.0
7268.3
7251.3
AUC
0.55
0.65
0.78
0.59
0.67
0.83
0.69
0.79
0.86
ﬁtting joint MSRE model
DIC
6907.9
6852.9
7044.0
6910.8
6862.9
7060.6
6991.4
6938.4
7128.3
LPML
−3788.2
−3784.0
−3776.9
−3773.2
−3768.8
−3764.4
−3778.3
−3769.9
−3768.3
AIC1
6927.1
6874.2
7067.5
6936.5
6890.3
7090.3
7023.7
6972.4
7164.9
AIC2
6916.3
6861.5
7052.9
6920.2
6871.6
7070.0
7001.9
6948.4
7139.5
BIC1
6979.6
6933.7
7134.0
7010.0
6970.8
7177.8
7118.2
7073.9
7273.4
BIC2
6968.8
6921.0
7119.4
6993.7
6952.2
7157.5
7096.4
7049.9
7248.0
ICL1
6979.6
6964.3
7355.7
7143.2
7135.8
7538.7
7334.1
7318.6
7711.7
ICL2
6968.8
6951.3
7342.0
7127.2
7117.1
7519.9
7314.9
7296.6
7689.6
WAIC1
7062.6
7032.6
7033.7
7043.9
7012.4
7011.6
7046.1
7015.6
7015.8
WAIC2
7328.6
7309.6
7310.5
7309.1
7293.3
7291.5
7314.5
7301.5
7298.9
AUC
0.68
0.69
0.69
0.67
0.68
0.68
0.67
0.68
0.68
110

CHAPTER V
Discussion
In this dissertation, we have extended the joint modeling framework to incor-
porate both mean and variability features from longitudinal data to predict cross-
sectional outcomes. In particular, we focus on studying the association between FSH
trajectories and severity of menopausal hot ﬂashes using the data from the Penn
Ovarian Aging study.
In Chapter II, we use latent growth curve features derived from each individual’s
linear deviation from a population trend as predictors of a binary health outcome,
i.e., occurrence of moderate-to-severe hot ﬂashes. Moderate to severe hot ﬂashes are
deﬁned as those rated 2 or 3 by the participants, when asked whether hot ﬂashes or
night sweats occurred in the past month and the severity, rated as 0 (none), 1 (mild), 2
(moderate), 3 (severe) at each follow-up. A key contribution from this work is to make
contrast of pros and cons of the use of latent classes and multiple shared random ef-
fects in joint mixture modeling when the data-generating mechanism both matches
and differs from the ﬁtting one. In Chapter III, we consider a robust semi-parametric
model that uses Bayesian penalized B splines, mixture distributions and Student
t-error assumptions to improve model ﬂexibility and robustness to potential outly-
ing observations in the FSH hormone trajectories to predict an ordinal menopausal
symptom severity, 0 (if self-rated severity score is < 2 throughout the follow-up), 1
111

(self-rated severity score is once 2 or once 3 but that occurred before age 40) and 2 (if
self-rated severity score is once 3 after age 40).
Although the two proposed methodologies seek trajectory features from two dif-
ferent perspectives, both indicate the heterogeneous nature in the mean and the
residual variability of the FSH trajectories for the women in the study, revealing
four distinct patterns of change in the FSH proﬁles.
Speciﬁcally, the mean FSH
proﬁle has two patterns featuring 1) women who tend to have an earlier increasing
time frame in the FSH trajectories along with higher FSH values in comparison to
2) women who tend to have increasing FSH levels at later ages and hence lower FSH
values; the residual variation in the FSH trajectories can also be clustered into low
versus high categories.
However, since the two mean proﬁle patterns are mainly due to relatively early or
late ages when women experience elevated FSH levels, considering FSH patterns in
relation to the Final Menstrual Period (FMP) might eliminate such differences due to
different timing of FSH change. To further compare and contrast the differences in
the FSH trajectory clustering between the use of years relative to FMP versus that
of chronological age, we reﬁt the model considered in Chapter III for a subgroup of
152 women for whom the FMP was observed, using the FSH levels in relation to both
chronological age and the years prior to or post FMP to predict the ordinal severity
of hot ﬂashes.
5.1
FSH patterns in relation to Final Menstrual Period (FMP)
Figure 5.1 (a) and (b) show the estimated population-mean trends of FSH levels in
relation to the years relative to FMP and chronological age, respectively. Both plots
show similar patterns in the population trend, reﬂecting the typical FSH change
patterns for women in the transition to menopause. FSH is relatively ﬂat prior to
the menopause transition, and then has an increasing period during the menopause
112

transition with acceleration and deceleration patterns (Sowers et al., 2008).
As
shown in Figure 5.2, when clustering the mean FSH trajectories in relation to FMP,
the majority of the subjects (93% of trajectories) follow the typical change pattern in
FSH levels as observed in the population trend, while 7% of trajectories form a sepa-
rate cluster with relatively constant FSH levels over the observation period. That is,
there is a notable reduction on the distinctions between the two clusters of subjects
due to the early versus late ages in experiencing elevated FSH levels. This ﬁnding
is not surprising since all the women included in the analysis experience FMP and
such typical patterns of change in their FSH levels during the transition period are
anticipated. Note that the estimated decreasing trend in the FSH trajectories 5 to
10 years following FMP is likely due to the sparsity of observations. Figure 5.1 (a)
and (b) both show evidence of the existence of subgroups of “low” versus “high” resid-
ual variation; however, the large sampling variability in estimating the means of the
variance class is likely due to the dropping of 35% women without experiencing FMP.
To obtain additional insight into the trajectory patterns in each of the mean pro-
ﬁle class, we look at the individual level ﬁtted FSH curves. Figure 5.3 (a) and (b)
present several chosen ﬁtted FSH trajectories by ﬁtting the models using the FMP
and chronological age, respectively. Note the trajectories of the same colors in both
(a) and (b) belong to the same women and all the class membership assignments
are based on the maximum of the posterior mean assignment probabilities of cluster
membership. In particular, the green curves shown in Figure 5.3 (a) are the total six
curves that are assigned to the minor mean class when ﬁtting the model using the
FMP; they all show relatively constant trends over the years around FMP, in compar-
ison to the curves assigned to the major class that show the typical increasing and
slightly plateau pattern over the years around FMP. In contrast, when using chrono-
logical age, as shown in Figure 5.3 (b), these six green curves are all assigned to
the major class that features increasing FSH period at relatively late ages with rel-
113

atively stable FSH levels during the period when women in the minor class already
experience elevated FSH levels. For the randomly selected curves shown in both
red and blue colors in Figure 5.3 (a), they show typical FSH change patterns in that
their FSH levels started to rise 5 to 10 years prior to the FMP and started to plateau
around 2 years following the FMP; however, when using chronological age, since they
differ in the ages of experiencing elevated FSH levels, they are assigned into the “late
rising” versus “early rising” FSH mean cluster, respectively. Finally, Figure 5.3 (a)
and (b) suggest that although these trajectories are clustered differently because of
different timing of reaching FMP, considering either FMP or chronological age leads
to almost identical trajectory ﬁtting except some horizontal shift in either the axis of
years in relation to FMP or chronological age.
However, when it comes to estimating the time-varying effect of cumulative changes
in the mean proﬁles, θ1(t), considering FSH levels in relation to FMP versus chrono-
logical age leads to different results as shown in Figure 5.4. When focusing on the
time window between 7 years prior to and 3 years following FMP, it suggests that
higher values of change in the mean FSH levels, µ′
i(t), in the window of 1 to 3 years
following FMP seem to be associated with the levels of severity of hot ﬂash; however,
such signal is masked by considering the FSH levels in relation to chronological age
in the range of [45,55]. Nevertheless, since our approaches allow the ﬂexibility in
choosing the study time period, equivalent ﬁndings, as that of using FMP adjusted
age, were identiﬁed in Figure 3.5 (b), when we focus on studying the patterns in re-
lation to chronological age in the range of [50,55]. Obviously, one should consider
FMP adjusted age when the relevant measurements become available. However, the
FMP ages are not always observed and the reasons why they are not available usu-
ally include hysterectomy prior to natural menopause, drop-out and using hormone
therapy for hot ﬂash.
In this sub-study, 35% of the subjects without FMP were tentatively excluded.
114

A more scientiﬁcally sound and meaningful investigation may be conducted when
treating the FMP as a variable with missing observations and considering the unob-
served FMP in women using hormone therapy for hot ﬂash as informative missing
values. The analysis accounting for this feature no doubt will bring in additional
variation. Additional efforts would also need to be made in the future to carefully
classify the reasons behind missing FMP. Based on the currently available informa-
tion, our proposed approaches using chronological age focusing on an alternative age
period suggest the potential that the changing-rate of FSH trajectories in the years
immediately prior to and post menopause could be of interest, at least for a sub-group
of women.
5.2
Future work
There are several directions of future investigation. Since our proposed method-
ologies incorporate both mean and variability features in the longitudinal trajecto-
ries, the extension to model time-to-event outcomes may help improve the accuracy
of predictions that are only based on the mean features. Extending the idea of using
latent features in longitudinal trajectories as functional predictors to predict the risk
for an event may also be desirable. For example, we can relate the latent features g(t)
(g(t) can be µ(t) or µ′(t)) of the longitudinal trajectories to the hazard of an event at
time t through h(t) = h0(t)exp
³
γTz+
R t
0 g(t)θ(t)dt
´
, where z includes baseline covari-
ates. In contrast to the standard Cox models with time-dependent covariates, this
extension allows different “weighting” assigned to all past values of the longitudinal
features and is therefore more desirable because depending on the latent period of
the event of interest, the values within the time window of [0,t] may contribute to the
event risks differently. Given the prevalence of missing data in longitudinal studies,
another direction of future work will be to extend the proposed models to incorpo-
rate not missing at random (NMAR) missing mechanisms and assess their impact on
115

statistical inferences. One approach is to add another hierarchical layer to our joint
models by modeling the probability of missingness to depend on unobserved data.
Further, we can consider modeling the within-subject heteroscedasticity, that is, to
allow subject-speciﬁc residual variances change over time. Extensions to incorpo-
rate time-varying variance structures will have practical applications in certain set-
tings. For example, some scientiﬁc evidence suggests that the residual variabilities
of reproductive hormone trajectories relative to the underlying mean trends closer to
menopause tend to be of higher degree. Developing joint models that simultaneously
consider the time-varying mean and residual variabilities of longitudinal trajectories
would provide tools for our collaborators to address this important research hypoth-
esis. In particular, the time-varying residual variance can also be considered as a
potential functional predictor to relate to an outcome of interest. Finally, it would be
of interests to investigate how to use multiple longitudinal trajectories to relate to
either one or multiple health outcomes of interest in joint modeling settings to bor-
row information from either correlated longitudinal trajectories or correlated multi-
ple health outcomes to eventually improve the prediction accuracy of the outcome of
interest.
116

−15
−10
−5
0
5
10
0
1
2
3
4
5
(a)
Years prior to and following the Final Menstrual Period
log(fsh)
35
40
45
50
55
60
0
1
2
3
4
5
(b)
Age
log(fsh)
Figure 5.1: Estimated population longitudinal trend by lowess: (a) in relation to
years before and after the Final Menstrual Period (FMP) and (b) accord-
ing to chronological age.
117

−15
−10
−5
0
5
10
−2
0
2
4
6
(a)
Years prior to and following the Final Menstrual Period
log(fsh)
Major mean class (93%)
Minor mean class (7%)
(b)
log(σ^
i
2)
Density
−3.0
−2.5
−2.0
−1.5
−1.0
0.0
0.5
1.0
1.5
2.0
G
G
variance
class 1
(32%)
variance
class 2
(68%)
35
40
45
50
55
60
−2
0
2
4
6
(c)
Age
log(fsh)
Major mean class (88%)
Minor mean class (12%)
(d)
log(σ^
i
2)
Density
−3.0
−2.5
−2.0
−1.5
−1.0
0.0
0.5
1.0
1.5
2.0
G
G
variance
class 1
(30%)
variance
class 2
(70%)
Figure 5.2: longitudinal proﬁles: (a) and (b) in relation to years before and after
the Final Menstrual Period (FMP); (c) and (d) according to chronological
age.
118

−15
−10
−5
0
5
10
1
2
3
4
5
(a)
Years prior to and following the Final Menstrual Period (FMP)
log(fsh)
assigned to the major mean class
assigned to the minor mean class
assigned to the major mean class
assigned to the major mean class
assigned to the minor mean class
assigned to the major mean class
assigned to the major mean class
assigned to the minor mean class
assigned to the major mean class
35
40
45
50
55
60
1
2
3
4
5
(b)
Age
log(fsh)
assigned to the major mean class
assigned to the major mean class
assigned to the minor mean class
assigned to the major mean class
assigned to the major mean class
assigned to the minor mean class
assigned to the major mean class
assigned to the major mean class
assigned to the minor mean class
Figure 5.3: Individual FSH trajectories that are assigned to the minor and major
mean proﬁle classes when ﬁtting the models using (a) years before and
after the Final Menstrual Period (FMP) and (b) chronological age, re-
spectively. The curves of the same colors in (a) and (b) belong to the same
women. The black points in (b) indicate the ﬁtted FSH values at the ages
of FMP. The red trajectories are the predicted FSH for women who were
in the minor mean classiﬁcation according to chronological age but in the
major mean classiﬁcation in relation to time to FMP, while the green tra-
jectories are the predicted FSH for women who were in the major mean
classiﬁcation according to chronological age but in the minor mean clas-
siﬁcation in relation to time to the FMP.
119

−1.0
−0.5
0.0
0.5
1.0
1.5
Years prior to and following FMP
θ1(t)
−7
−5
−3
−1
1
3
−1.0
−0.5
0.0
0.5
1.0
1.5
Age
θ1(t)
45
47
49
51
53
55
Figure 5.4: Functional coefﬁcient function θ1(t) when µ′
i(t) is functional predic-
tor with when (a) in relation to years before and after the Final Menstrual
Period (FMP) and time window is [−7,3], and (b) according to chronolog-
ical age and time wondow is [45,55].
120

APPENDICES
121

APPENDIX A
Computation Details in Chapter II
Posterior computations for the joint LC model
(1) update for longitudinal submodel
• update the mean proﬁle class memberships Di, i = 1,...,n: the full conditional
posterior distribution [Di|·] ∼Multinomial( ˜πD
i1,..., ˜πD
iKD), where
˜πD
id = Pr(Di = d|.) =
πD
d |Σd|−1
2 exp
©
−1
2(bi −βd)′Σ−1
d (bi −βd)−1
2(Wi −θCi,d)2ª
KD
X
d=1
πD
d |Σd|−1
2 exp
½
−1
2(bi −βd)′Σ−1
d (bi −βd)−1
2(Wi −θCi,d)2
¾
θCi,d = ZT
i η in the latent class probit submodel given Di = d and Ci as well as
other covariates.
• update the mean proﬁle class parameters:
– update βd: Assuming the prior for βd
ind
∼MVN(ν,V), then the full con-
ditional posterior density for βd for d = 1,...,KD is
£
βd|.
¤
∼MVN
¡
˜νd, ˜Vd
¢
122

where
˜νd =
(
V−1 +Σ−1
d
nX
i=1
I(Di = d)
)−1 (
V−1ν+Σ−1
d
nX
i=1
I(Di = d)bi
)
˜Vd =
(
V−1 +Σ−1
d
nX
i=1
I(Di = d)
)−1
– update Σd: Assuming the prior for Σd
ind
∼Inverse-Wishart(m,Λ), then
the full conditional posterior density is, [Σd|·] ∼Inverse-Wishart
¡
˜md, ˜Λd
¢
where
˜md = m+
nX
i=1
I(Di = d)
˜Λd =
(
Λ−1 +
nX
i=1
I(Di = d)
¡
bi −βd
¢¡
bi −βd
¢′
)−1
• update the mixing proportion {πD
d }d: assuming {πD
d }d ∼Dirichlet(eD
1 ,...., eD
KD)
then the full conditional posterior distribution is
£
{πD
d }d|·
¤
∼Dirichlet({eD
d +
Pn
i=1I(Di = d)}d).
• update the variance class memberships Ci, i = 1,...,n: the full conditional
posterior distribution [Ci|·] ∼Multinomial( ˜πC
i1,..., ˜πC
iKC) where
˜πC
i1 = Pr(Ci = c|.) =
πC
c exp
n
−1
2τ2
¡
logσ2
i −µc
¢2 −1
2(Wi −θc,Di)2o
KC
X
c=1
πC
c exp
½
−1
2τ2
¡
logσ2
i −µc
¢2 −1
2(Wi −θc,Di)2
¾
θc,Di = Ziη in the probit latent class submodel given Ci = c and Di as well as
other covariates.
• update the variance class parameters:
123

– update µc: assuming the prior for µc
ind
∼N(a,b), then the full conditional
posterior distribution is,
£
µc|·
¤
∼N
¡
˜a, ˜b
¢
where
˜a =
nX
i=1
I(Ci = c)logσ2
i /τ2 + a/b
1/b +
nX
i=1
I(Ci = c)/τ2
˜b =
(
1/b +
nX
i=1
I(Ci = c)/τ2
)−1
– update τ2: assuming τ2 ∼Inverse-Gamma(v, e), then the full conditional
posterior distribution is
£
τ2|·
¤
∼Inverse-Gamma
(
v+ n
2 , e +
nX
i=1
KC
X
c=1
1
2I(Ci = c)
¡
logσ2
i −µc
¢2
)
.
• update the mixing proportions {πC
c }c: assuming {πC
c }c ∼Dirichlet(eC
1 ,...., eC
KC)
then the full conditional posterior distribution is
h
{πC
c }c|·
i
∼Dirichlet
Ã
{eC
c +
nX
i=1
I(Ci = c)}c
!
.
• update the random effects bi, i = 1,...,n the full conditional posterior distribu-
tion is bi [bi|.] ∼MVN
¡ ˜βi, ˜Σi
¢
, where
˜βi =
Ã
Σ−1
Di + 1
σ2
i
ni
X
j=1
ti jt′
i j
!−1 Ã
Σ−1
DiβDi + 1
σ2
i
ni
X
j=1
yi jti j
!
˜Σid =
Ã
Σ−1
Di + 1
σ2
i
ni
X
j=1
ti jt′
i j
!−1
ti j is a vector of functional forms of the observation time ti j for the longitudinal
measurement yi j such that yi j ∼N
©
f (bi;ti j),σ2
i
ª
with f (bi;ti j) = bT
i ti j.
124

• update the variances σ2
i , i = 1,...,n
π(σ2
i |.) ∝
KC
Y
c=1
LN
¡
σ2
i ;µc,τ2¢I(Ci=c) ni
Y
j=1
N
©
yi j; f (bi;ti j),σ2
i
ª
∝(σ2
i )−
ni
2 −1exp
"
−
KC
X
c=1
I(Ci = c)
¡
logσ2
i −µc
¢2
2τ2
−
1
2σ2
i
ni
X
j=1
©
yi j −f (bi;ti j)
ª2
#
LN
¡
σ2
i ;µc,τ2¢
represents the density of log normal disribution with mean µc
and variance τ2 evaluated at σ2
i and N
©
yi j; f (bi;ti j),σ2
i
ª
represents the density
of normal distribution with mean f (bi;ti j) and variance σ2
i evaluated at yi j.
Since there is no closed form of the full conditional posterior density, the draws
for σ2
i , i = 1,...,n at each iteration of the Gibbs sampling are obtained using the
inverse cumulative distribution sampling method.
(2) update for LC probit model:
• update Wi, i = 1,...,n
[Wi|oi = 1,·] ∼N(θCi,Di,1)I(0,∞)(·)
[Wi|oi = 0,·] ∼N(θCi,Di,1)I(−∞,0)(·)
where, θCi,Di = ZT
i η in the latent class probit submodel given Ci and Di.
• update η: Assuming the prior for η ∼MVN(νη,Vη), then the full conditional
posterior density for η is
£
η|.
¤
∼MVN
¡
˜νη, ˜Vη
¢
where
˜νη =
Ã
V−1
η +
nX
i=1
ZiZ′
i
!−1 Ã
V−1
η νη +
nX
i=1
WiZi
!
˜Vη =
Ã
V−1
η +
nX
i=1
ZiZ′
i
!−1
Zi is the ith row of the design matrix in the probit submodel given Di and Ci
as well as other covariates.
125

Posterior computations for the joint MSRE model
(1) update for longitudinal submodel
• update the mean proﬁle class memberships Di, i = 1,...,n: the full conditional
posterior distribution [Di|·] ∼Multinomial( ˜πD
i1,..., ˜πD
iKD), where
˜πD
id = Pr(Di = d|.) =
πD
d |Σd|−1
2 exp
©
−1
2(bi −βd)′Σ−1
d (bi −βd)
ª
KD
X
d=1
πD
d |Σd|−1
2 exp
½
−1
2(bi −βd)′Σ−1
d (bi −βd)
¾
• update the mean proﬁle class parameters:
– update βd: Assuming the prior for βd
ind
∼MVN(ν,V), then the full con-
ditional posterior density for βd for d = 1,...,KD is
£
βd|.
¤
∼MVN
¡
˜νd, ˜Vd
¢
where
˜νd =
(
V−1 +Σ−1
d
nX
i=1
I(Di = d)
)−1 (
V−1ν+Σ−1
d
nX
i=1
I(Di = d)bi
)
˜Vd =
(
V−1 +Σ−1
d
nX
i=1
I(Di = d)
)−1
– update Σd: Assuming the prior for Σd
ind
∼Inverse-Wishart(m,Λ), then
the full conditional posterior density is, [Σd|·] ∼Inverse-Wishart
¡
˜md, ˜Λd
¢
where
˜md = m+
nX
i=1
I(Di = d)
˜Λd =
(
Λ−1 +
nX
i=1
I(Di = d)
¡
bi −βd
¢¡
bi −βd
¢′
)−1
• update the mixing proportion {πD
d }d: assuming {πD
d }d ∼Dirichlet(eD
1 ,...., eD
KD)
then the full conditional posterior distribution is
£
{πD
d }d|·
¤
∼Dirichlet({eD
d +
Pn
i=1I(Di = d)}d).
126

• update the variance class memberships Ci, i = 1,...,n: the full conditional
posterior distribution [Ci|·] ∼Multinomial( ˜πC
i1,..., ˜πC
iKC) where
˜πC
i1 = Pr(Ci = c|.) =
πC
c exp
n
−1
2τ2
¡
logσ2
i −µc
¢2o
KC
X
c=1
πC
c exp
½
−1
2τ2
¡
logσ2
i −µc
¢2¾
• update the variance class parameters:
– update µc: assuming the prior for µc
ind
∼N(a,b), then the full conditional
posterior distribution is,
£
µc|·
¤
∼N
¡
˜a, ˜b
¢
where
˜a =
nX
i=1
I(Ci = c)logσ2
i /τ2 + a/b
1/b +
nX
i=1
I(Ci = c)/τ2
˜b =
(
1/b +
nX
i=1
I(Ci = c)/τ2
)−1
– update τ2: assuming τ2 ∼Inverse-Gamma(v, e), then the full conditional
posterior distribution is
£
τ2|·
¤
∼Inverse-Gamma
(
v+ n
2 , e +
nX
i=1
KC
X
c=1
1
2I(Ci = c)
¡
logσ2
i −µc
¢2
)
.
• update the mixing proportions {πC
c }c: assuming {πC
c }c ∼Dirichlet(eC
1 ,...., eC
KC)
then the full conditional posterior distribution is
h
{πC
c }c|·
i
∼Dirichlet
Ã
{eC
c +
nX
i=1
I(Ci = c)}c
!
.
127

• update the random effects bi, i = 1,...,n the full conditional posterior distribu-
tion is bi [bi|.] ∼MVN
¡ ˜βi, ˜Σi
¢
, where
˜βi = ˜Σid
(
Σ−1
DiβDi + 1
σ2
i
ni
X
j=1
yi jti j +(ZT
i η−˜g(η,σ2
i ))g(η,σ2
i )
)
˜Σid =
(
Σ−1
Di + 1
σ2
i
ni
X
j=1
ti jtT
i j +g(η,σ2
i )g(η,σ2
i )T
)−1
ti j is a functional form of the time ti j for the longitudinal measurement yi j such
that yi j ∼N
©
f (bi;ti j),σ2
i
ª
with f (bi;ti j) = bT
i ti j. g(η,σ2
i ) is a vector such that
ZT
i η = g(η,σ2
i )′bi + ˜g(η,σ2
i ) in the shared random effects and variances model.
• update the variances σ2
i , i = 1,...,n
π(σ2
i |.) ∝
KC
Y
c=1
LN
¡
σ2
i ;µc,τ2¢I(Ci=c) ni
Y
j=1
N
©
yi j; f (bi;ti j),σ2
i
ª
N(Wi;ZT
i η,1)
∝(σ2
i )−
ni
2 −1exp
(
−
KC
X
c=1
I(Ci = c)
¡
logσ2
i −µc
¢2
2τ2
)
×exp
"
−1
2σ2
i
ni
X
j=1
©
yi j −f (bi;ti j)
ª2 −1
2(Wi −ZT
i η)2
#
LN
¡
σ2
i ;µc,τ2¢
represents the density of log normal disribution with mean µc
and variance τ2 evaluated at σ2
i ; N
©
yi j; f (bi;ti j),σ2
i
ª
represents the density
of normal distribution with mean f (bi;ti j) and variance σ2
i evaluated at yi j
and similarly N(Wi;ZT
i η,1) represents the density of normal distribution with
mean ZT
i η and variance 1 evaluated at Wi. Since there is no closed form of the
full conditional posterior density, the draws for σ2
i , i = 1,...,n at each iteration
of the Gibbs sampling are obtained using the inverse cumulative distribution
sampling method.
(2) update for MSRE probit model:
128

• update Wi, i = 1,...,m
[Wi|oi = 1,·] ∼N(ZT
i η,1)I(0,∞)(·)
[Wi|oi = 0,·] ∼N(ZT
i η,1)I(−∞,0)(·)
where, Zi is the ith row of the design matrix in the MSRE probit submodel.
• update η: Assuming the prior for η ∼MVN(νη,Vη), then the full conditional
posterior density for η is
£
η|.
¤
∼MVN
¡
˜νη, ˜Vη
¢
where
˜νη =
Ã
V−1
η +
nX
i=1
ZiZ′
i
!−1 Ã
V−1
η νη +
nX
i=1
WiZi
!
˜Vη =
Ã
V−1
η +
nX
i=1
ZiZ′
i
!−1
Zi is the ith row of the design matrix in the MSRE probit submodel.
Computation of DIC
DIC is given by
DIC(x) = −4Eφ
©
log f (x | φ) | x
ª
+2log f
©
x | Eφ(φ | x)
ª
Celeux et al. (2006) suggests that, when the model has missing data or latent vari-
ables, the appropriate DIC measure is obtained by ﬁrst considering the DIC measure
in the “complete data” setting, where x indicates the fully observed data, and z the
unobserved (typically latent) data:
DIC(x,z) = −4Eφ
©
log f (x,z | φ) | x,z
ª
+2log f
©
x,z | Eφ(φ | x,z)
ª
129

Integrating out over the unobserved data yields
DIC(x) = Ez
£
−4Eφ
©
log f (x,z | φ) | x
ª
+2log f
©
x,z | Eφ(φ | x,z)
ª¤
= −4Ez,φ
©
log f (x,z | φ) | x
ª
+2Ez
£
log f
©
x,z | Eφ(φ | x,z)
ª
| x
¤
To obtain DIC for our MSRE model, let φ denote the model parameter and zi the
latent variables (Di,Ci,bi,σ2
i ,Wi)′ for the ith subject. The data x′
i, i = 1,...,n corre-
spond to the longitudinal data (yi1,..., yini)′ and the outcome oi. The complete data
log-likelihood (ignoring normalizing constants) for the latent class model is given by
log f (x,z | φ)
=
nX
i=1
"
X
d
I(Di = d)
½
logπd −1
2 log | Σd | −1
2(bi −βd)′Σ−1
d (bi −βd)
¾
+
X
c
I(Ci = c)
½
logπc −logτ−logσ2
i −1
2τ2 (logσ2
i −µc)2
¾
+
ni
X
j=1
(
logσi −(yi j −f (bi;ti j))2
2σ2
i
)
−1
2(Wi −Z′
iη)2
#
Dividing zi into zi1 = (Di,Ci) and zi2 = (bi,σ2
i ,Wi), we have
Ez,φ
©
log f (x,z | φ) | x
ª
=
Ez2,φ
"
nX
i=1
"
X
d
P(Di = d | x,φ,z2)
©
logπd −1
2 log | Σd | −1
2(bi −βd)′Σ−1
d (bi −βd)
ª
+
X
c
P(Ci = c | x,φ,z2)
½
logπc −logτ−logσ2
i −1
2τ2 (logσ2
i −µc)2
¾
+
ni
X
j=1
(
logσi −(yi j −f (bi;ti j))2
2σ2
i
)
−1
2(Wi −Z′
iη)2
¸
| x
¸
130

where
P(Di = d | x,φ,z2) =
πD
d |Σd|−1
2 exp
£
−1
2(bi −βd)′Σ−1
d (bi −βd)
¤
KD
X
d=1
πD
d |Σd|−1
2 exp
·
−1
2(bi −βd)′Σ−1
d (bi −βd)
¸
P(Ci = c | x,φ,z2) =
πC
c exp
h
−1
2
¡
logσ2
i −µc
¢2/τ2i
KC
X
c=1
πC
c exp
·
−1
2
¡
logσ2
i −µc
¢2/τ2
¸
This expectation can then be approximated from M MCMC draws:
Ez,φ
£©
log f (x | φ) | x,z
ª
| x
¤
=
M−1
M
X
m=1
"
nX
i=1
"
X
d
P(Di = d | x,φ,z2)(m)
½
logπ(m)
d
−1
2 log | Σ(m)
d
|
−1
2(b(m)
i
−β(m)
d )′(Σ−1
d )(m)(b(m)
i
−β(m)
d )
o
+
X
c
P(Ci = c | x,φ,z2)(m)
(
logπ(m)
c
−logτ(m) −log(σ2
i )(m) −
(log(σ2
i )(m) −µ(m)
c
)2
2(τ2)(m)
)
+
ni
X
j=1
(
logσ(m)
i
−
(yi j −(b(m)
i
)′ti j)2
2(σ2
i )(m)
)
−1
2(W(m)
i
−Z′
iη(m))2
##
Obtaining Ez
£
log f
©
x,z | Eφ(φ | x,z)
ª
| x
¤
requires a bit more effort. We can broadly
use the same approach of averaging over the MCMC draws to integrate with respect
to z, but instead of using the draws of the model parameters directly, we need to
obtain their expectation conditional on the current draw of z. So
Ez
£
log f
©
x,z | Eφ(φ | x,z)
ª
| x
¤
= M−1
M
X
m=1
"
nX
i=1
"
X
d
I(Di = d)(m)
½
log ˆπ(m)
d
−1
2 log | ˆΣ(m)
d
| −1
2(b(m)
i
−ˆβ
(m)
d )′( ˆΣ−1
d )(m)(b(m)
i
−ˆβ
(m)
d )
¾
+
X
c
I(Ci = c)(m)
(
log ˆπ(m)
c
−log ˆτ(m) −log(σ2
i )(m) −
(log(σ2
i )(m) −ˆµ(m)
c
)2
2( ˆτ2)(m)
)
+
ni
X
j=1
(
logσ(m)
i
−
(yi j −(b(m)
i
)′ti j)2
2( ˆσ2
i )(m)
)
−1
2(W(m)
i
−−Z′
iη(m))2
##
131

where ˆφ(m) = Eφ(φ | x,z(m)).
Some components of ˆφ(m) have closed form solutions:
ˆπ(m)
d
=
eD
d +Pn
i=1I(Di = d)(m)
P
d eD
d + n
ˆπ(m)
c
=
eC
c +Pn
i=1I(Ci = c)(m)
P
c eCc + n
ˆη(m) =
Ã
V −1
η
+
nX
i=1
Z(m)
i
Z(m)′
i
!−1 Ã
V −1
η νη +
nX
i=1
W(m)
i
Z(m)
i
!
where Z(m)
i
is the ith row of the design matrix in the probit submodel for the mth
MCMC draw and eD
d , eC
c , Vη, and νη are speciﬁed hyperprior values.
The other components of ˆφ(m) will have to be obtaining by running small MCMC
chains for each of the main MCMC interations to get the marginal expectations:
ˆβ
(m)
d
= (M∗)−1 P
m∗β(m,m∗)
d
and ˆΣ(m)
d
= (M∗)−1 P
m∗Σ(m,m∗)
d
, where β(m,m∗)
d
and Σ(m,m∗)
d
are obtained by alternating draws from the following distributions with known hy-
perparameters V, ν, m, and Λ:
β(m,m∗)
d
∼MVN
³
˜ν(m,m∗)
d
, ˜V(m,m∗)
d
´
, where
˜V(m,m∗)
d
=
(
V−1 +(Σ(m,m∗−1)
d
)−1
nX
i=1
I(Di = d)(m)
)−1
˜ν(m,m∗)
d
= ˜V(m,m∗)
d
(
V−1ν+(Σ(m,m∗−1)
d
)−1
nX
i=1
I(Di = d)(m)b(m)
i
)
.
Σ(m,m∗)
d
∼Inverse-Wishart
³
˜m(m)
d , ˜Λ(m,m∗)
d
´
, where
˜m(m)
d
= m+
nX
i=1
I(Di = d)(m)
˜Λ(m,m∗)
d
=
(
Λ−1 +
nX
i=1
I(Di = d)(m) ³
b(m)
i
−β(m,m∗)
d
´³
b(m)
i
−β(m,m∗)
d
´′
)−1
132

Similarly, ˆµ(m)
c
= (M∗)−1 P
m∗µ(m,m∗)
c
and ( ˆτ2)(m) = (M∗)−1 P
m∗(τ2)(m,m∗), where µ(m,m∗)
c
and (τ2)(m,m∗) are obtained by alternating draws from the following distributions with
known hyperparameters a, b, e, and f :
µ(m,m∗)
c
∼N( ˜a(m,m∗), ˜b(m,m∗)), where
˜a(m,m∗) =
nX
i=1
I(Ci = c)(m)log(σ2
i )(m)/(τ2)(m,m∗−1) + a/b
1/b +
nX
i=1
I(Ci = c)(m)/(τ2)(m,m∗−1)
˜b(m,m∗) =
(
1/b +
nX
i=1
I(Ci = c)(m)/(τ2)(m,m∗−1)
)−1
(τ2)(m,m∗) ∼Inverse-Gamma( ˜v, ˜e(m,m∗)), where
˜v = v+ n
2
˜e(m,m∗) = e +
nX
i=1
KC
X
c=1
1
2I(Ci = c)(m) n
log(σ2
i )(m) −µ(m,m∗)
c
o2
Because we are conditioning on z and only need the posterior expectation, a mod-
est number of drawn (here we use M∗= 250) is found to be sufﬁcient to obtain an
accurate approximation.
Similarly, we can obtain DIC for our LC model.
133

Computation of LPML
For our model, we have
CPO−1
i
= f (y(−i),o(−i)|v)
f (y,o|v)
=
Z f (y(−i),o(−i)|C,D,b,σ2,φ,v)f (C,D,b,σ2,φ)
f (y,o|v)
dbdσ2dCdDdφ
=
Z f (y,o|C,D,b,σ2,φ,v)f (C,D,b,σ2,φ)
f (y,o|vi)f (yi,oi|C,D,b,σ2,φ,v)
dbdσ2dCdDdφ
=
Z
1
f (yi,oi|C,D,b,σ2,φ,vi) f (C,D,b,σ2,φ|y,o,v)dbdσ2dCdDdφ
=
Z
f (C,D,b,σ2,φ|y,o,v)
f (yi|bi,σ2
i ,φ,vi)f (oi|Ci,Di,bi,σ2
i ,φ,vi)
dbdσ2dCdDdφ
where φ is the vector of model parameters which does not include the unobserved
random effects and unknown residual variances. v = (v1,...,vn)T include all observed
variables including obervation time ti j, i = 1,...,ni, j = 1,...,ni and baseline covari-
ates of interest.
f (oi|Ci,Di,bi,σ2
i ,φ,vi) can be reduced to f (oi|Ci,Di,φ,vi) in the
case of LC probit submodel and f (oi|bi,σ2
i ,φ,vi) in the case of MSRE probit sub-
model. Using the MCMC posterior draws, we estimate CPO−1
i
by
1
B
B
X
s=1
1
f (yi|bi,σ2
i ,φ(s),vi)f (oi|Ci,Di,bi,σ2
i ,φ(s),vi)
where B is the number of MCMC posterior draws and φ(s) is the vector of the poste-
rior draws of all model parameters at the sth iteration. We have,
f (yi|bi,σ2
i ,φ,vi) =
ni
Y
j=1
1
q
2πσ2
i
exp
"
−
©
yi j −f (bi;ti j)
ª2
2σ2
i
#
f (oi|Ci,Di,φ,vi) = Φ(ZT
i θ)oi
h
1−Φ(ZT
i θ)
i1−oi for LC probit submodel
f (oi|bi,σ2
i ,φ,vi) = Φ(ZT
i γ)oi
h
1−Φ(ZT
i γ)
i1−oi for MSRE probit submodel
134

where, Φ(·) is the cdf for standard normal distribution. Zi denotes the corresponding
ith row in the design matrix for either LC or MSRE probit submodel given vi.
We retain every 5th of the 100,000 posterior draws after the chains converge and
divide these posterior draws into 20 blocks of length 1000 draws. To obtain stable
LPML measures, we calculate the CPO’s and LPML based on each of the 20 blocks
of draws and then report the median LPML. We found this approach would lead to
relatively stable LPML results in our simulations.
135

APPENDIX B
Computation Details in Chapter III
Details of posterior computations when assuming t model for
longitudinal observations
note: in the case of assuming normal model for longitudinal observations, we are
not updating mi j but let mi j be constant 1; and the missing longitudinal observation
yi j is drawn from N
¡
µ(ti j),σ2
i
¢
.
(1) update for longitudinal submodel
• update the mean proﬁle class memberships Di, i = 1,...,n: the full conditional
posterior distribution [Di|·] ∼Multinomial( ˜πD
i1,..., ˜πD
iKD), where
˜πD
id = Pr(Di = d|.) =
πD
d |Σ|−1
2 exp
£
−1
2(bi −βd)′Σ−1
d (bi −βd)
¤
KD
X
d=1
πD
d |Σ|−1
2 exp
·
−1
2(bi −βd)′Σ−1
d (bi −βd)
¸.
• update the mean proﬁle class parameters:
– update βd = (βd1,...,βdL):
Assuming the prior for βd1 ∼N(0,v) and ﬁrst order random walk prior
136

βdl ∼N(βd,l−1,τ2
βd), l = 2,...,L, then the prior for βd can be written as:
π(βd) =
µ
1
p
2πτβd
¶L−1
exp{−1
2βT
dVβd}, where V =


v−1
0
0
0

+ PTP/τ2
βd and
P =


1
−1
1
−1
...
...
1
−1


is the (L−1)×L penalty matrix. Then the full
conditional posterior density for βd for d = 1,...,KD is
£
βd|.
¤
∼MVN
¡
˜νd, ˜Vd
¢
˜νd =
"
V+Σ−1
nX
i=1
I(Di = d)
#−1 "
Σ−1
nX
i=1
I(Di = d)bi
#
˜Vd =
"
V+Σ−1
nX
i=1
I(Di = d)
#−1
.
– update Σ: Assuming the prior for Σ
ind
∼Inverse-Wishart(m,Λ), where m
and Λ are the degrees of freedom and scale matrix, respectively, then
the full conditional posterior density is, [Σ|·] ∼Inverse-Wishart
¡
˜md, ˜Λd
¢
where
˜md = m+ n
˜Λd =
"
Λ+
nX
i=1
¡
bi −βDi
¢¡
bi −βDi
¢′
#
.
– update τ2
βd: assuming τ2
βd ∼Inverse-Gamma(v, e), where v and e are the
shape and rate parameters, then the full conditional posterior distribution
is
h
τ2
βd|·
i
∼Inverse-Gamma
µ
v+ L −1
2
, e + 1
2βT
dPβd
¶
,
where L is the number of B spline basis functions.
• update the mixing proportion {πD
d }d: assuming
£
{πD
d }d
¤
∼Dirichlet(eD
1 ,...., eD
KD)
137

then the full conditional posterior distribution is
[{πD
d }d|·] ∼Dirichlet({eD
d +
nX
i=1
I(Di = d)}d).
• update the variance class memberships Ci, i = 1,...,n: the full conditional
posterior distribution [Ci|·] ∼Multinomial( ˜πC
i1,..., ˜πC
iKC) where
˜πC
ic = Pr(Ci = c|.) =
πC
c exp
h
−1
2
¡
logσ2
i −µc
¢2/τ2i
KC
X
c=1
πC
c exp
·
−1
2
¡
logσ2
i −µc
¢2/τ2
¸.
• update the variance class parameters:
– update µc: assuming the prior for µc
ind
∼N(a,b), then the full conditional
posterior distribution is,
£
µc|·
¤
∼N
¡
˜a, ˜b
¢
where
˜a =
nX
i=1
I(Ci = c)logσ2
i /τ2 + a/b
1/b +
nX
i=1
I(Ci = c)/τ2
˜b =
Ã
1/b +
nX
i=1
I(Ci = c)/τ2
!−1
– update τ2: assuming τ2 ∼Inverse-Gamma(v, e), then the full conditional
posterior distribution is
£
τ2|·
¤
∼Inverse-Gamma
Ã
v+ n
2 , e +
nX
i=1
KC
X
c=1
1
2I(Ci = c)
¡
logσ2
i −µc
¢2
!
.
• update the mixing proportions {πC
c }c: assuming
£
{πC
c }c
¤
∼Dirichlet(eC
1 ,...., eC
KC)
138

then the full conditional posterior distribution is
[{πC
c }c|·] ∼Dirichlet
Ã
{eC
c +
nX
i=1
I(Ci = c)}c
!
.
• update the random effects bi, i = 1,...,n the full conditional posterior distribu-
tion is bi [bi|.] ∼MVN
¡ ˜βi, ˜Σi
¢
, where
˜Σid =
"
Σ−1 + 1
σ2
i
ni
X
j=1
mi jφi jφ′
i j +MbiMT
bi
#−1
˜βi = ˜Σid
"
Σ−1βDi + 1
σ2
i
ni
X
j=1
yi jmi jφi j +(Wi −α1 −xT
i λ1)Mbi
#
,
where, φi j =
¡
φ1(ti j),··· ,φL(ti j)
¢T a vector of B spline basis functions evaluated
at time ti j such that µi(ti j) = b′
iφi j where yi j ∼N
¡
µi(ti j),σ2
i /mi j
¢
and Mbi is
deﬁned such that
R
T µi(t)θ0(t)dt =
R
Tb′
iφ(t)ψ0(t)T ˜θdt = bT
i G0
T ˜θ0 = bT
i Mbi.
• update the variances σ2
i , i = 1,...,n
π(σ2
i |.) ∝(σ2
i )−
ni
2 −1exp
"
−
KC
X
c=1
I(Ci = c)
¡
logσ2
i −µc
¢2
2τ2
−
1
2σ2
i
ni
X
j=1
mi j
¡
yi j −b′
iφi j
¢2
#
×exp

−1
2

Wi −α0 −xT
i λ0 −
Z
T
µi(t)θ0(t)dt


2

where, xi is a vector of baseline covariate including subject speciﬁc residual
variance
vi
vi−2σ2
i . Since there is no closed form of the full conditional posterior
density, the draws for σ2
i , i = 1,...,n at each iteration of the Gibbs sampling are
obtained using the inverse cumulative distribution sampling method.
• update mi j, j = 1,...,ni, given that mi j ∼gamma(v/2,v/2) where v/2 and v/2 are
the shape and rate parameter in gamma distribution, then the full conditional
posterior distribution for mi j is mi j ∼gamma
µ
v+1
2 , 1
2
µ
(yi j−µ(ti j))
2
σ2
i
+ v
¶¶
.
139

• update missing data: missing yi j at time ti j is drawn from t
¡
µ(ti j),σ2
i ,v
¢
.
(2) update for outcome probit submodel:
• update Wi, i = 1,...,m
[Wi|oi = 0,·] ∼N(ηW
i ,1)I(−∞,0)(·)
[Wi|oi = 1,·] ∼N(ηW
i ,1)I(0,γ1)(·)
[Wi|oi = 2,·] ∼N(ηW
i ,1)I(γ1,∞)(·)
where, ηW
i = α0 −xT
i λ0 −
R
T µi(t)θ0(t)dt and γ1 is the cutoff.
• update cutoff γ1: assuming ﬂat prior on γ1, then the full conditional posterior
density for γ1 is Unif(MaxOi=1Wi,MinOi=2Wi).
• update (α,λ)′: Assuming independent prior for (α,λ)′ ∼MVN(ναλ,Vαλ), then
the full conditional posterior density for αλ is [αλ|.] ∼MVN
¡
˜ναλ, ˜Vαλ
¢
where
˜νλ =
"
V−1
αλ +
nX
i=1
ziz′
i
#−1 
V−1
αλναλ +
nX
i=1

Wi −
Z
T
µi(t)θ0(t)dt

zi


˜Vαλ =
"
V−1
αλ +
nX
i=1
ziz′
i
#−1
,
where zi = (1,xi)′ is a vector of constant 1, baseline covariates and residual
variance
v
v−2σ2
i
• update ˜θ0 = ( ˜θ01,..., ˜θ0K)′: Assuming the prior for ˜θ01 ∼N(0,vθ0) and ﬁrst or-
der random walk prior ˜θ0k ∼N( ˜θk−1,τ2
θ0), k = 2,...,K, then the prior for ˜θ0 can
be written as: π( ˜θ) =
µ
1
p
2πτθ0
¶L−1
exp{−1
2 ˜θT
0 Vθ0 ˜θ0}, where Vθ0 =


v−1
θ0
0
0
0

+
140

PT
θ0Pθ0/τ2
θ0 with Pθ0 =


1
−1
1
−1
...
...
1
−1


is the (K −1)×K penalty matrix. Then the full conditional posterior density for
˜θ0 is
£ ˜θ0|.
¤
∼MVN
¡
˜νθ0, ˜Vθ0
¢
where
˜νθ =
"
V−1
θ0 +
nX
i=1
zθiz′
θi
#−1 "
V−1
θ0 νθ0 +
nX
i=1
³
Wi −α0 −xT
i λ0
´
zθi
#
˜Vθ0 =
"
V−1
θ0 +
nX
i=1
zθiz′
θi
#−1
,
where zθi is a vector of K elements deﬁned such that
Z
T
µi(t)θ0(t)dt =
Z
T
b′
iφ(t)ψ0(t)T ˜θ0dt = bT
i G0
T ˜θ0 = ˜θT
0 zθi.
• update τ2
θ0: assuming τ2
θ0 ∼IG(f , g), where f and g are the shape and rate
parameters, then the full conditional posterior distribution is
h
τ2
θ0|·
i
∼IG
µ
f + K −1
2
, g + 1
2
˜θT
0 Pθ0 ˜θ0
¶
,
where K is the number of B spline basis functions to express θ0(t) in the ordinal
probit submodel.
141

APPENDIX C
Computation Details in Chapter IV
Appendix
Exact expressions of P(Di = d | φ,z,x) and P(Ci = c | φ,z,x)
MSRE model
P(Di = d | φ,z) =
πD
d |Σd|−1
2 exp
©
−1
2(bi −βd)′Σ−1
d (bi −βd)
ª
KD
X
d=1
πD
d |Σd|−1
2 exp
½
−1
2(bi −βd)′Σ−1
d (bi −βd)
¾
P(Ci = c | φ,z) =
πC
c exp
n
−1
2τ2
¡
logσ2
i −µc
¢2o
KC
X
c=1
πC
c exp
½
−1
2τ2
¡
logσ2
i −µc
¢2¾
142

LC model
P(Di = d | φ,z) =
πD
d |Σd|−1
2 exp
©
−1
2(bi −βd)′(Σd)−1(bi −βd)−1
2(Wi −θCi,d)2ª
KD
X
d=1
πd|Σd|−1
2 exp
½
−1
2(bi −βd)′(Σd)−1(bi −βd)−1
2(Wi −θCi,d)2
¾
P(Ci = c | φ,z) =
πC
c exp
n
−1
2τ2
¡
logσ2
i −µc
¢2 −1
2(Wi −θc,Di)2o
KC
X
c=1
πC
c exp
½
−1
2τ2
¡
logσ2
i −µc
¢2 −1
2(Wi −θc,Di)2
¾
where, θCi,d = ZT
i η in the probit latent class submodel given Ci and Di = d; θc,Di =
ZT
i η in the probit latent class submodel given Ci = c and Di.
Computation details to predict outcome for new validation sample
In this section, we give the details to draw ˜z(m),z(m),φ(m)
long and η(m) from the
posterior distribution p(˜z,z,φlong,η|˜y,y,o,Ha), m = 1,··· ,M for some large M.
joint LC model:
After initialize the chain, we repeat the following steps (1) to (5) for m = 1,··· ,M:
(1) update individual level latent variables ˜z for validation sample (note:
this is only conditional on the longitudinal trajectories ˜y = {˜yi} ˜n
i=1)
• draw ˜D(m)
i
, i = 1,..., ˜n from Multinomial( ˜πD
i1,..., ˜πD
iKD), where
˜πD
id =
πD(m)
d
|Σ(m)
d |−1
2 exp
n
−1
2( ˜b(m)
i
−β(m)
d )′(Σ(m)
d )−1( ˜b(m)
i
−β(m)
d )
o
KD
X
d=1
πD(m)
d
|Σ(m)
d |−1
2 exp
½
−1
2( ˜b(m)
i
−β(m)
d )′(Σ(m)
d )−1( ˜b(m)
i
−β(m)
d )
¾
143

• draw ˜b(m)
i
, i = 1,..., ˜n from MVN
¡ ˜βi, ˜Σi
¢
, where
˜Σi =
Ã
(Σ(m)
˜D(m)
i
)−1 +
1
(σ(m)
i
)2
˜ni
X
j=1
ti jt′
i j
!−1
˜βi = ˜Σi
"
(Σ(m)
˜D(m)
i
)−1β(m)
˜D(m)
i
+
1
(σ(m)
i
)2
ni
X
j=1
˜yi jti j
#
ti j is a vector of functional forms of the observation time ti j for the longitudinal
measurement ˜yi j such that ˜yi j ∼N
©
f ( ˜bi;ti j),σ2
i
ª
with f ( ˜bi;ti j) = ˜bT
i ti j.
• draw the variance class memberships ˜C(m)
i
, i = 1,..., ˜n from Multinomial( ˜πC
i1,..., ˜πC
iKC),
where
˜πC
ic =
πC(m)
c
exp
½
−
1
2(τ(m))2
³
log( ˜σ(m)
i
)2 −µ(m)
c
´2¾
KC
X
c=1
πC(m)
c
exp
½
−
1
2(τ(m))2
³
log( ˜σ(m)
i
)2 −µ(m)
c
´2¾
• draw the variances ( ˜σ(m)
i
)2, i = 1,..., ˜n from
π(( ˜σ(m)
i
)2|.) ∝
KC
Y
c=1
LN
³
˜σ(m)
i
)2;µ(m)
c
,(τ(m))2´I( ˜C(m)
i
=c) ˜ni
Y
j=1
N
n
yi j; f ( ˜b(m)
i
;ti j),( ˜σ(m)
i
)2o
LN
³
( ˜σ(m)
i
)2;µ(m)
c
,(τ(m))2´
represents the density of log normal disribution with
mean µ(m)
c
and variance (τ(m))2 evaluated at ( ˜σ(m)
i
)2 and N
n
yi j; f ( ˜b(m)
i
;ti j),( ˜σ(m)
i
)2o
represents the density of normal distribution with mean f ( ˜b(m)
i
;ti j) and vari-
ance ( ˜σ(m)
i
)2 evaluated at ˜yi j.
(2) update individual level latent variables z for old sample (note: this
is conditional on both the longitudinal trajectories y = {yi}n
i=1 and the outcome o =
{oi}n
i=1)
144

• draw the mean proﬁle class memberships D(m)
i
, i = 1,...,n: from Multinomial( ˜πD
i1,..., ˜πD
iKD),
where
˜πD
id =
πD(m)
d
|Σ(m)
d
|−1
2 exp
(
−1
2(b(m)
i
−β(m)
d
)′(Σ(m)
d
)−1(b(m)
i
−β(m)
d
)−1
2(W(m)
i
−θ(m)
C(m)
i
,d
)2
)
KD
X
d=1
πD(m)
d
|Σ(m)
d |−1
2 exp
½
−1
2(b(m)
i
−β(m)
d )′(Σ(m)
d )−1(b(m)
i
−β(m)
d )−1
2(W(m)
i
−θ(m)
C(m)
i
,d)2
¾
θ(m)
C(m)
i
,d = (Z(m)
i
)Tη(m) in the latent class probit submodel given D(m)
i
= d and C(m)
i
.
• draw the random effects bi, i = 1,...,n from ∼MVN
¡ ˜βi, ˜Σi
¢
, where
˜Σid =
"
(Σ(m)
Di )−1 +
1
(σ(m)
i
)2
ni
X
j=1
ti jt′
i j
#−1
˜βi = ˜Σid
"
(Σ(m)
Di )−1β(m)
Di +
1
(σ(m)
i
)2
ni
X
j=1
yi jti j
#
ti j is a vector of functional forms of the observation time ti j for the longitudinal
measurement yi j such that yi j ∼N
©
f (bi;ti j),σ2
i
ª
with f (bi;ti j) = bT
i ti j.
• draw the variance class memberships C(m)
i
, i = 1,...,n from Multinomial( ˜πC
i1,..., ˜πC
iKC)
where
˜πC
ic =
πC(m)
c
exp
½
−
1
2(τ(m))2
³
log(σ(m)
i
)2 −µ(m)
c
´2
−1
2(W(m)
i
−θ(m)
c,D(m)
i
)2
¾
KC
X
c=1
πC(m)
c
exp
½
−
1
2(τ(m))2
³
log(σ(m)
i
)2 −µ(m)
c
´2
−1
2(W(m)
i
−θ(m)
c,D(m)
i
)2
¾
θ(m)
c,D(m)
i
= (Z(m)
i
)Tη(m) in the probit latent class submodel given C(m)
i
= c and D(m)
i
.
• update the variances (σ(m)
i
)2, i = 1,...,n
π((σ(m)
i
)2|.) ∝
KC
Y
c=1
LN
³
(σ(m)
i
)2;µ(m)
c
,(τ(m))2´I(C(m)
i
=c) ni
Y
j=1
N
n
yi j; f (b(m)
i
;ti j),(σ(m)
i
)2o
145

LN
³
(σ(m)
i
)2;µ(m)
c
,(τ(m))2´
represents the density of log normal disribution with
mean µ(m)
c
and variance (τ(m))2 evaluated at (σ(m)
i
)2 and N
n
yi j; f (b(m)
i
;ti j),(σ(m)
i
)2o
represents the density of normal distribution with mean f (b(m)
i
;ti j) and vari-
ance (σ(m)
i
)2 evaluated at yi j. Since there is no closed form of the full condi-
tional posterior density, the draws for (σ(m)
i
)2, i = 1,...,n at each iteration of the
Gibbs sampling are obtained using the inverse cumulative distribution sam-
pling method.
• draw Wi, i = 1,...,n from:
[W(m)
i
|oi = 1,·] ∼N(θC(m)
i
,D(m)
i
,1)I(0,∞)(·)
[W(m)
i
|oi = 0,·] ∼N(θC(m)
i
,D(m)
i
,1)I(−∞,0)(·)
where, θC(m)
i
,D(m)
i
= (Z(m)
i
)Tη(m) in the latent class probit submodel given C(m)
i
and D(m)
i
.
(3) update population level parameter φlong in the longitudinal sub-
model
• draw β(m)
d , d = 1,··· ,KD: Assuming the prior for βd
ind
∼MVN(ν,V), then the
full conditional posterior density for βd for d = 1,...,KD is
£
βd|.
¤
∼MVN
¡
˜νd, ˜Vd
¢
where
˜νd = ˜Vd
(
ν+(Σ(m)
d )−1
Ã
nX
i=1
I(D(m)
i
= d)b(m)
i
+
˜nX
i=1
I( ˜D(m)
i
= d) ˜b(m)
i
!)
˜Vd =
(
V−1 +(Σ(m)
d )−1
Ã
nX
i=1
I(D(m)
i
= d)+
˜nX
i=1
I( ˜D(m)
i
= d)
!)−1
• draw Σ(m)
d , d = 1,··· ,KD: Assuming the prior for Σd
ind
∼Inverse-Wishart(m,Λ),
then the full conditional posterior density is, [Σd|·] ∼Inverse-Wishart
¡
˜md, ˜Λd
¢
146

where
˜md = m+
nX
i=1
I(D(m)
i
= d)+
˜nX
i=1
I( ˜D(m)
i
= d)
˜Λd =
(
Λ−1 +
nX
i=1
I(D(m)
i
= d)
³
b(m)
i
−β(m)
d
´³
b(m)
i
−β(m)
d
´′
+
˜nX
i=1
I( ˜D(m)
i
= d)
³
˜b(m)
i
−β(m)
d
´³
˜b(m)
i
−β(m)
d
´′
)−1
• update the mixing proportion {πD(m)
d
}d: assuming {πD
d }d ∼Dirichlet(eD
1 ,...., eD
KD)
then the full conditional posterior distribution is
h
{πD
d }d|·
i
∼Dirichlet({eD
d +
nX
i=1
I(D(m)
i
= d)+
˜nX
i=1
I( ˜D(m)
i
= d)}d).
• update µ(m)
c
: assuming the prior for µc
ind
∼N(a,b), then the full conditional pos-
terior distribution is,
£
µc|·
¤
∼N
¡
˜a, ˜b
¢
where
˜a =
(τ(m))−2
Ã
nX
i=1
I(C(m)
i
= c)logσ2
i +
˜nX
i=1
I( ˜C(m)
i
= c)log ˜σ2
i
!
+ a/b
1/b +(τ(m))−2
Ã
nX
i=1
I(C(m)
i
= c)+
˜nX
i=1
I( ˜C(m)
i
= c)
!
˜b =
(
1/b +(τ(m))−2
Ã
nX
i=1
I(C(m)
i
= c)+
˜nX
i=1
I( ˜C(m)
i
= c)
!)−1
• draw (τ(m))2: assuming τ2 ∼Inverse-Gamma(v, e), then the full conditional
posterior distribution is
£
τ2|·
¤
∼Inverse-Gamma
©
v+ n+ ˜n
2 , ˜e
ª
where ˜e = e+
KC
X
c=1
Ã
nX
i=1
1
2I(C(m)
i
= c)
³
log(σ(m)
i
)2 −µ(m)
c
´2
+
˜nX
i=1
1
2I( ˜C(m)
i
= c)
³
log( ˜σ(m))2
i −µ(m)
c
´2
!
.
147

• update the mixing proportion {πC(m)
c
}c: assuming {πC
c }c ∼Dirichlet(eC
1 ,...., eC
KC)
then the full conditional posterior distribution is
h
{πC
c }c|·
i
∼Dirichlet({eC
c +
nX
i=1
I(C(m)
i
= c)+
˜nX
i=1
I( ˜C(m)
i
= c)}c).
(4) update the parameter η in the primary outcome model
• draw η(m): Assuming the prior for η ∼MVN(νη,Vη), then the full conditional
posterior density for η(m) is
£
η|.
¤
∼MVN
¡
˜νη, ˜Vη
¢
where
˜νη =
Ã
V−1
η +
nX
i=1
Z(m)
i
(Z(m))T
i
!−1 Ã
V−1
η νη +
nX
i=1
W(m)
i
Z(m)
i
!
˜Vη =
Ã
V−1
η +
nX
i=1
Z(m)
i
(Z(m))T
i
!−1
Z(m)
i
is the ith row of the design matrix in the probit submodel given D(m)
i
and
C(m)
i
.
(5) The prediction of outcome for a new validation sample i, i = 1,··· , ˜n
can be based on ˜p(m)
i
= Φ(η(m)T ˜Z(m)
i
), where ˜Z(m)
i
contains ˜D(m)
i
and ˜C(m)
i
for LC
model.
joint MSRE model:
After initialize the chain, we repeat the following steps (1) to (5) for m = 1,··· ,M:
(1) update individual level latent variables ˜z for validation sample (note:
this is only conditional on the longitudinal trajectories ˜y = {˜yi} ˜n
i=1)
• draw ˜D(m)
i
, i = 1,..., ˜n from Multinomial( ˜πD
i1,..., ˜πD
iKD), where
˜πD
i1 =
πD(m)
d
|Σ(m)
d |−1
2 exp
n
−1
2( ˜b(m)
i
−β(m)
d )′(Σ(m)
d )−1( ˜b(m)
i
−β(m)
d )
o
KD
X
d=1
πD(m)
d
|Σ(m)
d |−1
2 exp
½
−1
2( ˜b(m)
i
−β(m)
d )′(Σ(m)
d )−1( ˜b(m)
i
−β(m)
d )
¾
148

• draw ˜b(m)
i
, i = 1,..., ˜n from MVN
¡ ˜βi, ˜Σi
¢
, where
˜Σi =
"
(Σ(m)
˜D(m)
i
)−1 +
1
(σ(m)
i
)2
˜ni
X
j=1
ti jt′
i j
#−1
˜βi = ˜Σi
"
(Σ(m)
˜D(m)
i
)−1β(m)
˜D(m)
i
+
1
(σ(m)
i
)2
ni
X
j=1
˜yi jti j
#
ti j is a vector of functional forms of the observation time ti j for the longitudinal
measurement ˜yi j such that ˜yi j ∼N
©
f ( ˜bi;ti j),σ2
i
ª
with f ( ˜bi;ti j) = ˜bT
i ti j.
• draw the variance class memberships ˜C(m)
i
, i = 1,..., ˜n from Multinomial( ˜πC
i1,..., ˜πC
iKC),
where
˜πC
i1 =
πC(m)
c
exp
½
−
1
2(τ(m))2
³
log( ˜σ(m)
i
)2 −µ(m)
c
´2¾
KC
X
c=1
πC(m)
c
exp
½
−
1
2(τ(m))2
³
log( ˜σ(m)
i
)2 −µ(m)
c
´2¾
• draw the variances ( ˜σ(m)
i
)2, i = 1,..., ˜n from
π(( ˜σ(m)
i
)2|.) ∝
KC
Y
c=1
LN
³
˜σ(m)
i
)2; ˜µ(m)
c
,(τ(m))2´I( ˜C(m)
i
=c) ˜ni
Y
j=1
N
n
yi j; f ( ˜b(m)
i
;ti j),( ˜σ(m)
i
)2o
LN
³
( ˜σ(m)
i
)2;µ(m)
c
,(τ(m))2´
represents the density of log normal disribution with
mean µ(m)
c
and variance (τ(m))2 evaluated at ( ˜σ(m)
i
)2 and N
n
yi j; f ( ˜b(m)
i
;ti j),( ˜σ(m)
i
)2o
represents the density of normal distribution with mean f ( ˜b(m)
i
;ti j) and vari-
ance ( ˜σ(m)
i
)2 evaluated at ˜yi j.
(2) update individual level latent variables z for old sample (note: this
is conditional on both the longitudinal trajectories y = {yi}n
i=1 and the outcome o =
{oi}n
i=1)
149

• draw the mean proﬁle class memberships D(m)
i
from Multinomial( ˜πD
i1,..., ˜πD
iKD),
where
˜πD
i1 =
πD(m)
d
|Σ(m)
d |−1
2 exp
n
−1
2(b(m)
i
−β(m)
d )′(Σ(m)
d )−1(b(m)
i
−β(m)
d )
o
KD
X
d=1
πD(m)
d
|Σ(m)
d |−1
2 exp
½
−1
2(b(m)
i
−β(m)
d )′(Σ(m)
d )−1(b(m)
i
−β(m)
d )
¾
• draw the random effects bi, i = 1,...,n from ∼MVN
¡ ˜βi, ˜Σi
¢
, where
˜Σid =
Ã
(Σ(m)
D(m)
i
)−1 +
1
(σ(m)
i
)2
ni
X
j=1
ti jtT
i j +g(η(m),σ(m)
i
)g(η(m),σ(m)
i
)T
!−1
˜β(m)
i
= ˜Σid
µ
(Σ(m)
Di )−1β(m)
Di +
1
(σ(m)
i
)2
Pni
j=1 yi jti j +(W(m)
i
−˜g(η(m),σ(m)
i
))g(η(m),σ(m)
i
)
¶
where ti j is a vector of functional forms of the observation time ti j for the
longitudinal measurement yi j such that yi j ∼N
©
f (bi;ti j),σ2
i
ª
with f (bi;ti j) =
bT
i ti j. g(η,σi) is a vector such that ZT
i η = g(η,σi)Tbi + ˜g(η,σi) in the MSRE
primary outcome model. Zi is the ith row of the design matrix in the probit
submodel given bi and σi.
• draw the variance class memberships C(m)
i
, i = 1,...,n from Multinomial( ˜πC
i1,..., ˜πC
iKC)
where
˜πC
i1 =
πC(m)
c
exp
½
−
1
2(τ(m))2
³
log(σ(m)
i
)2 −µ(m)
c
´2¾
KC
X
c=1
πC(m)
c
exp
½
−
1
2(τ(m))2
³
log(σ(m)
i
)2 −µ(m)
c
´2¾
• update the variances (σ(m)
i
)2, i = 1,...,n
π((σ(m)
i
)2|.) ∝
KC
Y
c=1
LN
³
(σ(m)
i
)2;µ(m)
c
,(τ(m))2´I(C(m)
i
=c) ni
Y
j=1
N
n
yi j; f (b(m)
i
;ti j),(σ(m)
i
)2o
×N(W(m)
i
;(Z(m)
i
)Tη(m),1)
150

LN
³
(σ(m)
i
)2;µ(m)
c
,(τ(m))2´
represents the density of log normal disribution with
mean µ(m)
c
and variance (τ(m))2 evaluated at (σ(m)
i
)2 and N
n
yi j; f (b(m)
i
;ti j),(σ(m)
i
)2o
represents the density of normal distribution with mean f (b(m)
i
;ti j) and vari-
ance (σ(m)
i
)2 evaluated at yi j and similarly N(W(m)
i
;(Z(m)
i
)Tη(m),1) represents
the density of normal distribution with mean (Z(m)
i
)Tη(m) and variance 1 eval-
uated at W(m)
i
.
• draw Wi, i = 1,...,n for old sample from:
[W(m)
i
|oi = 1,·] ∼N((Z(m)
i
)Tη(m),1)I(0,∞)(·)
[W(m)
i
|oi = 0,·] ∼N((Z(m)
i
)Tη(m),1)I(−∞,0)(·)
where, Z(m)
i
contains b(m)
i
and σ(m)
i
for joint MSRE model.
(3) update population level parameter φlong in the longitudinal sub-
model
• draw β(m)
d , d = 1,··· ,KD: Assuming the prior for βd
ind
∼MVN(ν,V), then the
full conditional posterior density for βd for d = 1,...,KD is
£
βd|.
¤
∼MVN
¡
˜νd, ˜Vd
¢
where
˜νd = ˜Vd
(
ν+(Σ(m)
d )−1
Ã
nX
i=1
I(D(m)
i
= d)b(m)
i
+
˜nX
i=1
I( ˜D(m)
i
= d) ˜b(m)
i
!)
˜Vd =
(
V−1 +(Σ(m)
d )−1
Ã
nX
i=1
I(D(m)
i
= d)+
˜nX
i=1
I( ˜D(m)
i
= d)
!)−1
• draw Σ(m)
d , d = 1,··· ,KD: Assuming the prior for Σd
ind
∼Inverse-Wishart(m,Λ),
then the full conditional posterior density is, [Σd|·] ∼Inverse-Wishart
¡
˜md, ˜Λd
¢
151

where
˜md = m+
nX
i=1
I(D(m)
i
= d)+
˜nX
i=1
I( ˜D(m)
i
= d)
˜Λd =
(
Λ−1 +
nX
i=1
I(D(m)
i
= d)
³
b(m)
i
−β(m)
d
´³
b(m)
i
−β(m)
d
´′
+
˜nX
i=1
I( ˜D(m)
i
= d)
³
˜b(m)
i
−β(m)
d
´³
˜b(m)
i
−β(m)
d
´′
)−1
• update the mixing proportion {πD(m)
d
}d: assuming {πD
d }d ∼Dirichlet(eD
1 ,...., eD
KD)
then the full conditional posterior distribution is
£
{πD
d }d|·
¤
∼Dirichlet({eD
d +
Pn
i=1I(D(m)
i
= d)+P ˜n
i=1I( ˜D(m)
i
= d)}d).
• update µ(m)
c
: assuming the prior for µc
ind
∼N(a,b), then the full conditional pos-
terior distribution is,
£
µc|·
¤
∼N
¡
˜a, ˜b
¢
where
˜a =
(τ(m))−2
Ã
nX
i=1
I(C(m)
i
= c)logσ2
i +
˜nX
i=1
I( ˜C(m)
i
= c)log ˜σ2
i
!
+ a/b
1/b +(τ(m))−2
Ã
nX
i=1
I(C(m)
i
= c)+
˜nX
i=1
I( ˜C(m)
i
= c)
!
˜b =
(
1/b +(τ(m))−2
Ã
nX
i=1
I(C(m)
i
= c)+
˜nX
i=1
I( ˜C(m)
i
= c)
!)−1
• draw (τ(m))2: assuming τ2 ∼Inverse-Gamma(v, e), then the full conditional
posterior distribution is
£
τ2|·
¤
∼Inverse-Gamma
©
v+ n+ ˜n
2 , ˜e
ª
, where ˜e = e+
KC
X
c=1
Ã
nX
i=1
1
2I(C(m)
i
= c)
³
log(σ(m)
i
)2 −µ(m)
c
´2
+
˜nX
i=1
1
2I( ˜C(m)
i
= c)
³
log( ˜σ(m))2
i −µ(m)
c
´2
!
• update the mixing proportion {πC(m)
c
}c: assuming {πC
c }c ∼Dirichlet(eC
1 ,...., eC
KC)
then the full conditional posterior distribution is
h
{πC
c }c|·
i
∼Dirichlet
Ã(
eC
c +
nX
i=1
I(C(m)
i
= c)+
˜nX
i=1
I( ˜C(m)
i
= c)
)
c
!
.
152

(4) update the parameter η in the primary outcome model
• draw η(m): Assuming the prior for η ∼MVN(νη,Vη), then the full conditional
posterior density for η(m) is
£
η|.
¤
∼MVN
¡
˜νη, ˜Vη
¢
where
˜Vη =
"
V−1
η +
nX
i=1
Z(m)
i
(Z(m))T
i
#−1
˜νη = ˜Vη
"
V−1
η νη +
nX
i=1
W(m)
i
Z(m)
i
#
Z(m)
i
is the ith row of the design matrix in the probit submodel and contains
b(m)
i
and σ(m)
i
for MSRE model.
(5) The prediction of outcome for a new validation sample i, i = 1,··· , ˜n
can be based on ˜p(m)
i
= Φ(η(m)T ˜Z(m)
i
), where ˜Z(m)
i
contains ˜b(m)
i
and ˜σ(m)
i
for MSRE
model.
153

BIBLIOGRAPHY
154

BIBLIOGRAPHY
Akaike, H. (1973), Information theory and an extension of the maximum likelihood
principle, in Proceedings of the Second International Symposium on Information
Theory, edited by B. N. Petrov and F. Csaki, pp. 267–281, Budapest: Akademiai
Kiado.
Albert, J. H., and S. Chib (1993), Bayesian analysis of binary and polychotomous
response data, Journal of the American statistical Association, 88(422), 669–679.
Biernacki, C., G. Celeux, and G. Govaert (2000), Assessing a mixture model for clus-
tering with the integrated completed likelihood, Pattern Analysis and Machine
Intelligence, IEEE Transactions on, 22(7), 719–725.
Brown, E. R., and J. G. Ibrahim (2003a), A bayesian semiparametric joint hierarchi-
cal model for longitudinal and survival data, Biometrics, 59(2), 221–228.
Brown, E. R., and J. G. Ibrahim (2003b), Bayesian approaches to joint cure-rate and
longitudinal models with applications to cancer vaccine trials, Biometrics, 59(3),
686–693.
Celeux, G., F. Forbes, C. P. Robert, and D. M. Titterington (2006), Deviance informa-
tion criteria for missing data models, Bayesian Analysis, 1(4), 651–673.
Chen, H., and Y. Wang (2011), A penalized spline approach to functional mixed effects
model analysis, Biometrics, 67(3), 861–870.
Chen, M.-H., and P. Gustafson (2011), editors, Lifetime Data Analysis, 17, special
Issue.
Day, N. E. (1969), Estimating the components of a mixture of normal distributions,
Biometrika, 56(3), 463–474.
Durbán, M., J. Harezlak, M. P. Wand, and R. J. Carroll (2005), Simple ﬁtting of
subject-speciﬁc curves for longitudinal data, Statistics in medicine, 24(8), 1153–
1167.
Eilers, P. H. C., and B. D. Marx (1996), Flexible smoothing with B-splines and penal-
ties, Statistical Science, 11(2), 89–121.
Elliott, M. R. (2007), Identifying latent clusters of variability in longitudinal data,
Biostatistics, 8(4), 756–771.
155

Elliott, M. R., M. D. Sammel, and J. Faul (2012), Associations between variability
of risk factors and health outcomes in longitudinal studies, Statistics in Medicine,
31(23), 2745–2756.
Fawcett, T. (2006), An introduction to ROC analysis, Pattern recognition letters, 27(8),
861–874.
Fonseca, T. C., M. A. Ferreira, and H. S. Migon (2008), Objective Bayesian analysis
for the student-t regression model, Biometrika, 95(2), 325–333.
Freeman, E. W., M. D. Sammel, J. A. Grisso, M. Battistini, B. Garcia-Espagna, and
L. Hollander (2001), Hot ﬂashes in the late reproductive years: risk factors for
African American and Caucasian women, Journal of Women’s Health and Gender-
Based Medicine, 10(1), 67–76.
Freeman, E. W., M. D. Sammel, H. Lin, and D. B. Nelson (2006), Associations of
hormones and menopausal status with depressed mood in women with no history
of depression, Archives of General Psychiatry, 63(4), 375.
Frühwirth-Schnatter, S. (2006), Finite Mixture and Markov Switching Models, New
York: Springer.
Garrett, E. S., and S. L. Zeger (2000), Latent class model diagnosis, Biometrics, 56(4),
1055–1067.
Gelman, A., and J. Hill (2007), Data Analysis using Regression and Multi-
level/Hierarchical Models, New York: Cambridge University Press.
Gelman, A., X.-L. Meng, and H. Stern (1996), Posterior predictive assessment of
model ﬁtness via realized discrepancies, Statistica Sinica, 6(4), 733–760.
Gelman, A., Y. Goegebeur, F. Tuerlinckx, and I. Van Mechelen (2000), Diagnostic
checks for discrete data regression models using posterior predictive simulations,
Journal of the Royal Statistical Society: Series C (Applied Statistics), 49(2), 247–
268.
Gelman, A., J. B. Carlin, H. S. Stern, and D. B. Rubin (2003), Bayesian data analysis,
CRC press.
Gelman, A., J. Hwang, and A. Vehtari (2013), Understanding predictive information
criteria for Bayesian models, Statistics and Computing, dOI: 10.1007/s11222-013-
9416-2.
Geweke, J. (1993), Bayesian treatment of the independent student-t linear model,
Journal of Applied Econometrics, 8(S1), S19–S40.
Ibrahim, J. G., M.-H. Chen, and D. Sinha (2001), Bayesian survival analysis, New
York: Springer-Verlag.
156

Ibrahim, J. G., M.-H. Chen, and D. Sinha (2004), Bayesian methods for joint mod-
eling of longitudinal and survival data with applications to cancer vaccine trials,
Statistica Sinica, 14(3), 863–884.
Ibrahim, J. G., H. Chu, and L. M. Chen (2010), Basic concepts and methods for joint
models of longitudinal and survival data, Journal of Clinical Oncology, 28(16),
2796–2801.
James, G. M. (2002), Generalized linear models with functional predictors, Journal
of the Royal Statistical Society: Series B (Statistical Methodology), 64(3), 411–432.
Jeffreys, H. (1973), Scientiﬁc Inference, third ed., New York: Cambridge University
Press.
Johnson, V. E. (2004), A Bayesian χ2 test for goodness-of-ﬁt, The Annals of Statistics,
32(6), 2361–2384.
Johnson, V. E. (2007), Bayesian model assessment using pivotal quantities, Bayesian
Analysis, 2(4), 719–734.
Kass, R. E., and R. Natarajan (2006), A default conjugate prior for variance com-
ponents in generalized linear mixed models (comment on article by Browne and
Draper), Bayesian Analysis, 1(3), 535–542.
Lang, S., and A. Brezger (2004), Bayesian P-splines, Journal of Computational and
Graphical statistics, 13(1), 183–212.
Lange, K. L., R. J. Little, and J. M. Taylor (1989), Robust statistical modeling using
the t distribution, Journal of the American Statistical Association, 84(408), 881–
896.
Law, N. J., J. M. Taylor, and H. Sandler (2002), The joint modeling of a longitudinal
disease progression marker and the failure time process in the presence of cure,
Biostatistics, 3(4), 547–563.
Little, R. J., and D. B. Rubin (2002), Statistical analysis with missing data, New York:
Wiley.
Manson, J. M., M. D. Sammel, E. W. Freeman, and J. A. Grisso (2001), Racial differ-
ences in sex hormone levels in women approaching the transition to menopause,
Fertility and sterility, 75(2), 297–304.
McLachlan, G., and D. Peel (2000), Finite Mixture Models, New York: Wiley.
Muthén, B., and K. Shedden (1999), Finite mixture modeling with mixture outcomes
using the EM algorithm, Biometrics, 55(2), 463–469.
Neelon, B., A. J. O’Malley, and S.-L. T. Normand (2011), A Bayesian two-part latent
class model for longitudinal medical expenditure data: assessing the impact of
mental health and substance abuse parity, Biometrics, 67(1), 280–289.
157

Pemstein, D., K. M. Quinn, and A. D. Martin (2007), The scythe statistical library:
An open source C++ library for statistical computation., Journal of Statistical Soft-
ware, 1, 29.
Plummer, M. (2002), Discussion of the paper by Spiegelhalter et al., Journal of the
Royal Statistical Society: Statistical Methodology, 4(64), 620.
Plummer, M. (2006), Comment on article by Celeux et al., Bayesian Analysis, 4(1),
681–686.
Plummer, M. (2008), Penalized loss functions for Bayesian model comparison, Bio-
statistics, 9(3), 523–539.
Proust-Lima, C., and J. M. Taylor (2009), Development and validation of a dynamic
prognostic tool for prostate cancer recurrence using repeated measures of post-
treatment psa: a joint modeling approach, Biostatistics, 10(3), 535–549.
Proust-Lima, C., M. Séne, J. M. Taylor, and H. Jacqmin-Gadda (2012), Joint latent
class models for longitudinal and time-to-event data: a review, Statistical Methods
in Medical Research.
Ramsay, J. O., and C. Dalzell (1991), Some tools for functional data analysis, Journal
of the Royal Statistical Society: Series B (Statistical Methodology), pp. 539–572.
Redner, R. A., and H. F. Walker (1984), Mixture densities, maximum likelihood and
the EM algorithm, SIAM review, 26(2), 195–239.
Richardson, S., and P. J. Green (1997), On bayesian analysis of mixtures with an
unknown number of components (with discussion), Journal of the Royal Statistical
Society: series B (statistical methodology), 59(4), 731–792.
Rizopoulos, D. (2011), Dynamic predictions and prospective accuracy in joint models
for longitudinal and time-to-event data, Biometrics, 67(3), 819–829.
Rizopoulos, D. (2012), Joint Models for Longitudinal and Time-to-Event Data: with
Applications in R, CRC Press.
Rizopoulos, D., and P. Ghosh (2011), A Bayesian semiparametric multivariate
joint model for multiple longitudinal outcomes and a time-to-event, Statistics in
medicine, 30(12), 1366–1380.
Robin, X., N. Turck, A. Hainard, N. Tiberti, F. Lisacek, J.-C. Sanchez, and M. Müller
(2011), proc: an open-source package for R and S+ to analyze and compare ROC
curves, BMC bioinformatics, 12(1), 77.
Ruppert, D., M. P. Wand, and R. J. Carroll (2003), Semiparametric Regression, New
York: Cambridge University Press.
Schwarz, G. (1978), Estimating the dimension of a model, The annals of statistics,
6(2), 461–464.
158

Sing, T., O. Sander, N. Beerenwinkel, and T. Lengauer (2005), ROCR: visualizing
classiﬁer performance in R, Bioinformatics, 21(20), 3940–3941.
Song, X., M. Davidian, and A. A. Tsiatis (2002), A semiparametric likelihood ap-
proach to joint modeling of longitudinal and time-to-event data, Biometrics, 58(4),
742–753.
Sowers, M. R., H. Zheng, D. McConnell, B. Nan, S. Harlow, and J. F. Randolph (2008),
Follicle stimulating hormone and its rate of change in deﬁning menopause transi-
tion stages, Journal of Clinical Endocrinology & Metabolism, 93(10), 3958–3964.
Speigelhalter, D., N. Best, B. Carlin, and A. Van der Linde (2003), Bayesian measures
of model complexity and ﬁt (with discussion), Journal of the Royal Statistical So-
ciety, Series B, 64(4), 583–616.
Spiegelhalter, D. J., N. G. Best, B. P. Carlin, and A. Van Der Linde (2002), Measures
of model complexity and ﬁt, Journal of the Royal Statistical Society: Series B (Sta-
tistical Methodology), 64(4), 583–639.
Steel, R. J., and A. E. Raftery (2010), Performance of Bayesian model selection crite-
ria for Gaussian mixture models, in Frontiers of Statistical Decision Making and
Bayesian Analysis: In Honor of James O. Berger, edited by M.-H. Chen, P. Müller,
D. Sun, K. Ye, and D. K. Dey, pp. 113–130, New York: Springer.
Stephens, M. (2000), Dealing with label switching in mixture models, Journal of the
Royal Statistical Society: Series B (Statistical Methodology), 62(4), 795–809.
Steyerberg, E. W., A. J. Vickers, N. R. Cook, T. Gerds, M. Gonen, N. Obuchowski, M. J.
Pencina, and M. W. Kattan (2010), Assessing the performance of prediction models:
a framework for some traditional and novel measures, Epidemiology (Cambridge,
Mass.), 21(1), 128.
Taylor, J. M., M. Yu, and H. M. Sandler (2005), Individualized predictions of disease
progression following radiation therapy for prostate cancer, Journal of clinical on-
cology, 23(4), 816–825.
Taylor, J. M., Y. Park, D. P. Ankerst, C. Proust-Lima, S. Williams, L. Kestin, K. Bae,
T. Pickles, and H. Sandler (2013), Real-time individual predictions of prostate can-
cer recurrence using joint models, Biometrics.
Tsiatis, A., V. Degruttola, and M. Wulfsohn (1995), Modeling the relationship of
survival to longitudinal data measured with error. applications to survival and
cd4 counts in patients with aids, Journal of the American Statistical Association,
90(429), 27–37.
van der Linde, A. (2012), A Bayesian view of model complexity, Statistica Neer-
landica, 66(3), 253–271.
159

Vehtari, A., and J. Ojanen (2012), A survey of Bayesian predictive methods for model
assessment, selection and comparison, Statistics Surveys, 6, 142–228.
Wang, Y., and J. M. G. Taylor (2001), Jointly modeling longitudinal and event time
data with application to acquired immunodeﬁciency syndrome, Journal of the
American Statistical Association, 96(455), 895–905.
Watanabe, S. (2009), Algebraic geometry and statistical learning theory, Cambridge
University Press.
Watanabe, S. (2010), Asymptotic equivalence of Bayes cross validation and widely ap-
plicable information criterion in singular learning theory, The Journal of Machine
Learning Research, 9999, 3571–3594.
Xu, J., and S. L. Zeger (2001), The evaluation of multiple surrogate endpoints, Bio-
metrics, 57(1), 81–87.
Yu, M., J. M. G. Taylor, and H. M. Sandler (2008), Individual prediction in prostate
cancer studies using a joint longitudinal survival–cure model, Journal of the Amer-
ican Statistical Association, 103(481), 178–187.
Yuan, Y., and V. E. Johnson (2012), Goodness-of-ﬁt diagnostics for Bayesian hierar-
chical models, Biometrics, 68(1), 156–164.
160

