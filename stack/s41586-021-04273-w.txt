Nature  |  Vol 601  |  20 January 2022  |  343
Article
Quantum logic with spin qubits crossing the 
surface code threshold
Xiao Xue1,2, Maximilian Russ1,2, Nodar Samkharadze1,3, Brennan Undseth1,2, Amir Sammak1,3, 
Giordano Scappucci1,2 & Lieven M. K. Vandersypen1,2 ✉
High-fidelity control of quantum bits is paramount for the reliable execution of 
quantum algorithms and for achieving fault tolerance—the ability to correct errors 
faster than they occur1. The central requirement for fault tolerance is expressed in 
terms of an error threshold. Whereas the actual threshold depends on many details, a 
common target is the approximately 1% error threshold of the well-known surface 
code2,3. Reaching two-qubit gate fidelities above 99% has been a long-standing major 
goal for semiconductor spin qubits. These qubits are promising for scaling, as they 
can leverage advanced semiconductor technology4. Here we report a spin-based 
quantum processor in silicon with single-qubit and two-qubit gate fidelities, all of 
which are above 99.5%, extracted from gate-set tomography. The average single-qubit 
gate fidelities remain above 99% when including crosstalk and idling errors on the 
neighbouring qubit. Using this high-fidelity gate set, we execute the demanding task 
of calculating molecular ground-state energies using a variational quantum 
eigensolver algorithm5. Having surpassed the 99% barrier for the two-qubit gate 
fidelity, semiconductor qubits are well positioned on the path to fault tolerance and to 
possible applications in the era of noisy intermediate-scale quantum devices.
Quantum computation involves the execution of a large number of 
elementary operations that take a qubit register through the steps of 
a quantum algorithm6. A major challenge is to implement these opera-
tions with sufficient accuracy to arrive at a reliable outcome, even in 
the presence of decoherence and other error sources. The higher the 
accuracy, or fidelity, of the operations, the higher the likelihood that 
near-term applications for quantum computers come within reach7. 
Furthermore, for most presently known algorithms, the number of 
operations that must be concatenated will unavoidably lead to exces-
sive accumulation of errors, and these errors must be removed using 
quantum error correction1. Correcting quantum errors faster than they 
occur is possible when the error probability per operation is below a cer-
tain threshold, known as the fault-tolerance threshold. For the widely 
considered surface code, for instance, the fault-tolerance threshold is 
between 0.6% and 1%, under certain assumptions, albeit at the cost of 
a large redundancy in the number of physical qubits2,3.
Among all the candidate platforms, electron spins in semiconductor 
quantum dots have advantages, such as their long coherence times8, 
small footprint9, the potential for scaling up10 and the compatibility with 
advanced semiconductor manufacturing technology4. Single-qubit opera-
tions of spin qubits in quantum dots achieve fidelities of 99.9% (refs. 11,12) but 
the two-qubit gate fidelities reported vary from 92% to 98% (refs. 13,14). This 
has limited the two-qubit Bell-state fidelities to 94% (ref. 15) and quantum 
algorithms implemented with spin qubits gave only coarsely accurate 
outcomes16,17. Pushing the two-qubit gate fidelity well beyond 99% requires 
not only low charge-noise levels and the elimination of nuclear spins by 
isotopic enrichment but also careful Hamiltonian engineering.
In this paper, using a precisely engineered two-qubit interac-
tion Hamiltonian, we report the demonstration of single-qubit and 
two-qubit gates with fidelities above 99.5%. We use gate-set tomography 
(GST) not only to characterize the gates and to quantify the fidelity but 
also to improve the gate calibration. The high-fidelity gates allow us to 
compute the dissociation energy of molecular hydrogen with a vari-
ational quantum eigensolver (VQE) algorithm, reaching an accuracy for 
the dissociation energy of around 20 mHa, limited by readout errors.
We use a gate-defined double quantum dot in an isotopically enriched 
28Si/SiGe heterostructure17 (Fig. 1a), with each dot occupied by a single elec-
tron (see Methods). The spin states of the electrons serve as qubits. The spin 
states are measured with the help of a sensing quantum dot (SQD), which is 
capacitively coupled to the qubit dots18. A micromagnet on top of the device 
provides a magnetic field gradient enabling electric-dipole spin resonance19 
and separates the resonance frequencies of the qubits in the presence of an 
external magnetic field (~320 mT) to 11.993 GHz (Q1) and 11.890 GHz (Q2). 
Single-qubit X and Y gates are implemented by frequency-multiplexed 
microwave signals applied to gate MW and virtual Z gates are implemented 
by a phase update of the reference frame20. The plunger gates (LP and RP) 
control the chemical potentials of the quantum dots.
The native two-qubit gate for spin qubits uses the exchange interac-
tion21,22, originating from the wave-function overlap of electrons in neigh-
bouring dots. This selectively shifts the energy of the antiparallel spin 
states and, thus, enables an electrically pulsed adiabatic conditional Z 
(CZ) gate8,16,23. The barrier gate (B) controls the tunnel coupling between the 
dots, allowing the precise tuning of the exchange coupling from <100 kHz 
to 20 MHz. To minimize the sensitivity to charge noise, we activate the 
https://doi.org/10.1038/s41586-021-04273-w
Received: 1 July 2021
Accepted: 22 November 2021
Published online: 19 January 2022
Open access
 Check for updates
1QuTech, Delft University of Technology, Delft, The Netherlands. 2Kavli Institute of Nanoscience, Delft University of Technology, Delft, The Netherlands. 3Netherlands Organisation for Applied 
Scientific Research (TNO), Delft, The Netherlands. ✉e-mail: l.m.k.vandersypen@tudelft.nl

344  |  Nature  |  Vol 601  |  20 January 2022
Article
exchange coupling while avoiding a tilt in the double-dot potential24,25 
(Fig. 1a). This symmetric condition can be determined accurately by 
decoupled adiabatic exchange pulses inside a Ramsey sequence (Fig. 1c, 
d). The tunnel barrier is controlled by simultaneously pulsing gate B and 
compensating LP and RP to avoid shifts in the electrochemical potentials24, 
constituting a virtual barrier gate. The detuning between quantum dots is 
controlled by additional offsets to the LP and RP pulses in opposite direc-
tions. As the decoupling pulses remove additional single-qubit phase 
accumulation from electron movement in the magnetic field gradient, 
the spin-up probability of Q1 results in a symmetric chevron pattern, with 
the symmetry point at the centre (Fig. 1d).
Among the various quantum benchmarking techniques, quantum 
process tomography (QPT) is designed to reconstruct all details in a 
target process6. Owing to the susceptibility of QPT to state preparation 
and measurement (SPAM) errors, self-consistent benchmarking tech-
niques such as GST26 and alternative techniques such as randomized 
benchmarking27 have been developed. In contrast to randomized bench-
marking, GST inherits the advantage of QPT in that it reports the detailed 
process, which allows us to isolate Hamiltonian errors from stochastic 
errors and to correct for such errors in the control signals (Extended 
Data Fig. 5). In addition, GST accounts for gate-dependent errors. We 
benchmark the fidelities of a universal gate set using GST26,28 (Fig. 2a). 
The gate set we choose contains an idle gate (I), sequentially operated 
single-qubit π/2 rotations about the xˆ and yˆ axes for each qubit (XQ1, YQ1, 
XQ 2 and YQ 2) and a two-qubit controlled-phase (CZ) gate. A total of 36 
fiducial sequences containing {null, X
, Y
}
n
n
Q
=1,2,3
Q
=1,3
i
j
 on each qubit, 
where null (unlike the idle gate) has no waiting time, are used to tomo-
graphically measure the two-qubit state. These fiducials are interleaved 
by germ sequences and their powers up to a sequence depth of 16. Germs 
are short sequences of gates taken from the universal gate set 
(see Methods). They are repetitively executed to amplify different types 
of gate errors in the gate set, such that SPAM errors can be isolated. GST 
allows using a maximum-likelihood estimator to compute completely 
positive and trace-preserving process matrices for each element of the 
gate set6. The gate fidelity can be calculated by comparing the measured 
process using the Pauli transfer matrix (PTM), Mexp, with the ideal PTM, 
Mideal, F
d
= (Tr(
) +
)/
gate
exp
−1
ideal
M
M
[d(d+1)], where d is the dimension 
of the Hilbert space. These process matrices provide a detailed error 
diagnosis of the gate set, allowing for efficient feedback calibration29 
(Fig. 2a). Analysing the error generator 
= log(
)
exp
ideal
−1
L
M
M
 provides 
easy access to information. For example, coherent Hamiltonian errors 
can be isolated from incoherent stochastic errors and single-qubit errors 
can be isolated from each other and from two-qubit errors30.
Figure 2b, c shows the reduced PTMs of XQ1 and YQ1 operations in the Q1 
subspace and Fig. 2d shows the full PTM of YQ1 in two-qubit space (Y ⊗I
Q
Q 2
1
) 
containing additional errors from decoherence and crosstalk on Q2 while 
operating Q1 (see Extended Data Figs. 1 and 2 for other PTMs) and from 
unintentional entanglement due to a residual exchange interaction. The 
average single-qubit gate fidelity is 99.72% in the single-qubit subspace  
(XQ1: 99.68%; YQ1: 99.73%; XQ 2: 99.61%; YQ 2: 99.87%; see Extended Data  
Fig. 2 for all error bars). A metric that is rarely reported is the single-qubit 
gate fidelity in the full two-qubit space, here 99.16% on average (see Methods 
and Extended Data Fig. 1). These results highlight that single-qubit bench-
marking is not sufficient to identify all errors occurring during single-qubit 
operations. By analysing the error generators, we find that errors from 
uncorrelated dephasing of the idling qubit dominate the drop in single-qubit 
gate fidelity when characterized in the two-qubit space. Coherent, 
microwave-induced phase shifts—the main source of crosstalk errors—have 
been corrected by applying a compensating phase gate to the idling qubit 
(Extended Data Fig. 4). The elimination of idling errors and other crosstalk 
J
J
J
SQD signal (a.u.)
SQD
MW
LP
RP
B
B
RP
MW
LP
SET
XQ2
2
XQ1
XQ1
Micromagnet
Spin-up probability
0.2
0.8
XQ1
2
Total barrier pulse duration (μs)
0
10
20
30
Detuning (mV)
0
6
12
–6
–12
480
500
520
VRP (mV)
VLP (mV)
510
550
530
Detuning axis
(1,1)
(1,0)
(0,0)
(0,1)
Symmetry line
Symmetry line
Pulse
Pulse
a
b
c
d
Fig. 1 | Two-qubit device and symmetry operating point. a, Scanning 
electron microscopy images of a device similar to that used here, showing the 
quantum dot gate pattern and the micromagnet on top (the device used in the 
experiment has an additional screening gate above the fine gates17). The scale 
bar in the left panel denotes 500 nm. The scale bar in the right panel denotes 
100 nm. b, Control paths for determining the symmetry operation point in the 
charge-stability diagram. (M, N) represent the number of electrons in the dots 
underneath the tip of LP and RP, respectively. a.u., arbitrary units. c, Pulse 
sequence schematic of a decoupled controlled-phase operation interleaved in 
a Ramsey interference sequence on Q1. d, Spin-up probability of Q1 after the 
Ramsey sequence in c, as a function of the detuning in the double-dot potential 
and the total duration of the barrier voltage pulses.

Nature  |  Vol 601  |  20 January 2022  |  345
errors from the microwave drive, such as through heating effects, will be a 
crucial step to improve the quality of the single-qubit operations further.
For a high-fidelity adiabatic CZ gate, precise control of the exchange 
coupling, J, between the two qubits is required. Specifically, in order 
to avoid unintended state transitions due to non-adiabatic dynamics, 
we must be able to carefully shape the envelope of  J. We characterize 
J over a wide range using a Ramsey sequence interleaved by a virtual 
barrier pulse with incremental amplitude vB. Figure 3a shows the meas-
ured frequency shift of each qubit as functions of the barrier pulse 
amplitude and the state of the other qubit. The exchange interaction 
is modelled to be exponentially dependent on the barrier pulse ampli-
tude J v
(
) ∝e αv
B
2
B (refs. 31,32). The micromagnet-induced single-qubit 
frequency shifts are approximated by linear functions within the volt-
age window of the CZ gate in the numerical simulations. By fitting the 
measured datasets simultaneously to theoretical models (see Methods), 
J can be extracted very precisely as the difference between the two 
conditional frequencies of each qubit16,33 (Fig. 3b). The barrier pulse 
v
A
t t
∝log(
(1 −cos(2π /
))/2)
v
B
gate
B
 (Fig. 3d) compensates the exponen-
tial dependence such that  J ∝ (1 − cos(2πt/tgate)) follows a cosine window 
function, which ensures good adiabaticity34 (Fig. 3e). In addition, the 
virtual gates are calibrated such that the symmetric operation point 
is maintained for each barrier setting, minimizing the influence of 
charge noise via the double-dot detuning. The most relevant remaining 
noise sources include charge noise, affecting  J through fluctuations 
in the virtual barrier gate δvB, and fluctuating qubit frequencies δfQ1 
and δfQ2 from charge noise entering through artificial spin–orbit cou-
pling from the micromagnet and residual nuclear spin noise coupling 
through the hyperfine interaction. By analysing the decay of the Ram-
sey oscillations at each transition frequency, individual dephasing 
times T 2
 can be extracted and, from there, also δvB, δfQ1 and δfQ2 (Fig. 3c).
Figure 4a shows an example GST pulse sequence that contains twice 
in a row the germ [CZ, X
, Y , CZ, Y , X
]
Q
Q
Q
Q
2
1
2
1 . The PTM of the CZ gate 
obtained from GST is shown in Fig. 4b. Using the detailed information 
from the error generator to fine-tune the calibration parameters, we 
can achieve a CZ fidelity of 99.65 ± 0.15% (Extended Data Figs. 4 and 5). 
Error bars included here and elsewhere are the 2σ ≈ 95% confidence 
intervals computed using the Hessian of the loglikelihood function35. 
The CZ error generator reveals that, at this point, incoherent errors 
dominate. The virtual barrier gate technique used here efficiently sup-
presses crosstalk errors during two-qubit gates. Therefore, we expect 
the CZ fidelity to be mostly affected by dephasing errors of idling qubits 
in a larger space, which can be corrected for using decoupling pulses. 
From the obtained PTMs, we can numerically estimate Bell-state fidel-
ities by multiplications of the PTMs necessary to construct the cor-
responding state, giving an estimate of 97.75%–98.42%, neglecting 
SPAM errors, for the four Bell states (Fig. 4c and Extended Data Fig. 3).
Fidi
N
Fido
Error
diagnosis
Ger
Operator
ﬁdelities
Process
matrices
=
XQ1
YQ1
I
,
,
,
YQ1 ,
XQ1
XQ2
XQ2
YQ2 ,
XQ2
XQ1
YQ2
YQ2
XQ1
YQ1
...
,
XQ2
YQ2
,
,
XQ1 ﬁdelity:
99.68%
YQ1 ﬁdelity:
99.73%
YQ1 ⊗ IQ2 ﬁdelity:
99.41%
ZI
IZ
ZZ
XX
ZX
II
IX IY
XI
XYXZ YI YXYYYZ
ZY
ZI
IZ
ZZ
XX
ZX
II
IX
IY
XI
XY
XZ
YI
YX
YY
YZ
ZY
0
0.5
1.0
0
0.5
1.0
0
0.5
1.0
Z
I
X
Y
Z
I
X
Y
Z
I
X
Y
a
b
c
d
Ger
Input
operator
Tr{PoutΛ(Pin)}
Output
operator
Input
operator
Input
operator
Tr{PoutΛ(Pin)}
Tr{PoutΛ(Pin)}
Output
operator
Z
I
X
Y
Output
operator
Fig. 2 | Gate-set tomography and single-qubit gate. a, Workflow of the GST 
experiment. Coloured blocks show the input and output fiducial sequences 
(Fidi and Fido, orange) and the germ sequences (green). A few examples of 
single-qubit germ sequences are listed. The outcome is used to adjust pulse 
parameters in the next run. b, c, PTMs of XQ1 and YQ1 in the subspace of Q1. The 
red (blue) bars are theoretically +1 (−1) and are measured to be positive 
(negative). The brown (green) bars are theoretically 0 (0) but measured to be 
positive (negative). Pin and Pout are the input and output operators, respectively. 
d, Experimentally measured PTM of Y
⊗I
Q1
Q2 in the complete two-qubit space. 
The colour code is the same as in b, c.
Barrier pulse amplitude (mV)
T2  (μs)
*
Barrier pulse amplitude (mV)
Barrier pulse amplitude (mV)
Barrier pulse amplitude (mV)
J (MHz)
0
60
120
180
240
0
60
120
180
240
0
60
120
180
240
0
60
120
180
240
0
2.5
5.0
7.5
10.0
5
10
15
20
25
5
10
15
20
0
J (MHz)
Frequency detuning (MHz)
10
20
0
–10
50
100
0
50
100
0
Time (ns)
Time (ns)
Q1
Q2
Q1 (Q2 = |0〉)
Q1 (Q2 = |1〉)
Q2 (Q1 = |0〉)
Q2 (Q1 = |1〉)
a
b
c
e
d
Fig. 3 | Hamiltonian engineering of exchange interaction. a, Frequency 
detuning of each qubit conditional on the state of the other qubit as a function of 
barrier pulse amplitude. The horizontal axis shows the real voltage applied to 
gate B. b, Exchange strength as a function of barrier pulse amplitude. The data 
are extracted directly from a. c, T 2
 of each qubit conditional on the state of the 
other qubit as a function of barrier pulse amplitude (same colour code as in a). 
Each data point is averaged for about 8 min. By fitting the T 2
 values to a 
quasistatic noise model (solid lines, see Methods), the low-frequency amplitudes 
of the fluctuations are estimated as δf
= 11 kHz
Q1
, δf
= 24 kHz
Q 2
 and δvB = 0.4 mV.  
d, Shape of the barrier pulse, designed to achieve a high-fidelity CZ gate. e, The 
cosine-shaped J envelope seen by the qubits during the pulse shown in d.

346  |  Nature  |  Vol 601  |  20 January 2022
Article
Next, we use the high-fidelity gate set in the context of an actual appli-
cation, in order to provide a quantitative benchmark for future work 
under realistic conditions. Specifically, we implement a VQE algorithm 
to compute the ground-state energy of molecular hydrogen (H2) (Fig. 5a). 
In a VQE algorithm, a quantum processor is used to implement a classi-
cally inefficient subroutine (see Methods and Extended Data Fig. 6). The 
second quantized H2 Hamiltonian can be mapped onto two qubits under 
the Bravyi–Kitaev (BK) transformation H = h0II + h1ZI + h2IZ + h3ZZ + h4X
X + h5YY. Here I, X, Y and Z are Pauli operators, for example, ZI is shorthand 
for Z ⊗ I, and the coefficients h0–h5 are classically computable functions 
of the internuclear distance, R. Figure 5b shows the schematic of the VQE 
algorithm and its circuit implementation for a H2 molecule. The qubit is 
initialized in |01⟩, which represents double occupation of the lowest 
molecular orbital, corresponding to the Hartree–Fock (HF) ground state. 
A parameterized ansatz state is then prepared by considering single and 
double excitation, which, after the BK transformation, yields 
ψ θ
( ) = e
01
θ
−i XY
, with θ the parameter to variationally optimize. By 
performing partial tomography on the ansatz state with an initial guess 
θ0, the expectation value of the Hamiltonian for |ψ(θ0)⟩ can be calculated. 
A classical computer can efficiently compute the next guess θ1 as the new 
input for the quantum computer. This loop is iterated until the result 
converges. For a H2 molecule, there is only one parameter θ to optimize, 
thus, a scan of the entire parameter range of 2π with finite samples is 
sufficient to interpolate the smoothly changing measured expectation 
values. This emulates a real variational algorithm, where θ can be esti-
mated to arbitrary precision by increasing the number of repetitions to 
suppress statistical fluctuations36. Figure 5c shows the partial tomography 
result after normalization of the visibility window. The data demonstrate 
high-quality phase control in the quantum circuits. The deviations in the 
odd-parity expectation values indicate correlations in the readout of the 
two qubits37. Figure 5d shows the energy curves of the H2 molecule from 
both theory38 and the VQE experiment. We observe a minimum energy 
at around 0.72 Å and an error of approximately 20 mHa at the theoretical 
bond length 0.7414 Å, mainly attributed to slow drift in the readout param-
eters. This accuracy matches the results obtained using superconducting 
and trapped ion qubits with comparable gate fidelities36,39.
The two-qubit gate with fidelity above 99.5% and single-qubit gate fideli-
ties in the two-qubit gate space above 99% on average place semiconduc-
tor spin qubit logic at the error threshold of the surface code. Recently, a 
two-qubit operation between nuclear spin qubits in silicon, mediated by 
an electron spin qubit, has been demonstrated to surpass 99% fidelity as 
well, further highlighting that semiconductor spin qubits offer precise 
two-qubit logic40. Independent studies have shown spin qubit readout with 
a fidelity above 98% in only a few μs (ref. 41), with further improvements 
underway42. Combining high-fidelity initialization, readout and control 
into a demonstration of fault tolerance poses several key challenges to be 
overcome. First, sufficiently large and reliable quantum dot arrays must 
be constructed, with good connectivity between the qubits. Second, the 
fidelities achieved in small-scale systems must be maintained across such 
larger systems, which will require reducing idling and crosstalk errors. The 
same advances will allow us to implement more sophisticated algorithms 
in the noisy intermediate-scale quantum era, such as solving energies 
involving excited states of more complex molecules.
Online content
Any methods, additional references, Nature Research reporting sum-
maries, source data, extended data, supplementary information, 
acknowledgements, peer review information; details of author contri-
butions and competing interests; and statements of data and code avail-
ability are available at https://doi.org/10.1038/s41586-021-04273-w.
1.	
Lidar, D. A. & Brun, T. A. Quantum Error Correction (Cambridge Univ. Press, 2013).
2.	
Raussendorf, R. & Harrington, J. Fault-tolerant quantum computation with high threshold 
in two dimensions. Phys. Rev. Lett. 98, 190504 (2007).
3.	
Fowler, A. G., Mariantoni, M., Martinis, J. M. & Cleland, A. N. Surface codes: towards 
practical large-scale quantum computation. Phys. Rev. A 86, 032324 (2012).
4.	
Zwerver, A. M. J. et al. Qubits made by advanced semiconductor manufacturing. Preprint 
at https://arxiv.org/abs/2101.12650 (2021).
5.	
McArdle, S., Endo, S., Aspuru-Guzik, A., Benjamin, S. C. & Yuan, X. Quantum 
computational chemistry. Rev. Mod. Phys. 92, 015003 (2020).
6.	
Nielsen, M. A. & Chuang, I. Quantum Computation and Quantum Information (Cambridge 
Univ. Press, 2002).
7.	
Preskill, J. Quantum computing in the NISQ era and beyond. Quantum 2, 79 (2018).
8.	
Veldhorst, M. et al. A two-qubit logic gate in silicon. Nature 526, 410–414 (2015).
9.	
Zajac, D. M., Hazard, T. M., Mi, X., Nielsen, E. & Petta, J. R. Scalable gate architecture for a 
one-dimensional array of semiconductor spin qubits. Phys. Rev. Appl. 6, 054013 (2016).
XQ1 XQ1 XQ2 XQ2
XQ2 YQ1
YQ2 XQ1
XQ2 YQ1
YQ2 XQ1 XQ1XQ1
CZ
CZ
CZ
CZ
Germ2 :
Fiducial-in
Fiducial-out
CZ ﬁdelity:
99.65%
Estimated |Ψ+〉 state ﬁdelity: 98.42%
YQ1
YQ2
YQ1
ZI
IZ
ZZ
XX
ZX
II
IX IY
XI
XYXZYI YXYYYZ
ZY
ZI
IZ
ZZ
XX
ZX
II
IX
IY
XI
XY
XZ
YI
YX
YY
YZ
ZY
0
0.5
1.0
0
0.5
11
00 01 10
11
00
01
10
a
b
c
CZ
Input
operator
Tr{PoutΛ(Pin)}
Output
operator
Re(U)
Fig. 4 | High-fidelity two-qubit gate. a, A sequence of pulses generated by the 
arbitrary waveform generators in an example GST sequence. The purple 
waveforms show the in-phase component of X/Y gates. The CZ gate is indicated 
by the orange pulse of gate B and the blue and red compensation pulses of gate LP 
and gate RP. b, Experimentally determined PTM of a CZ gate. The colour code is 
the same as in Fig. 2. c, Left, the quantum circuit used to reconstruct the Bell state 
Ψ
= ( 01 + 10 )/ 2
+
 based on the corresponding PTMs. Right, the real part of 
the reconstructed density matrix of the |Ψ+⟩ state. The colour code is the same as 
in Fig. 2, except that red (blue) bars here are theoretically +0.5 (−0.5).

Nature  |  Vol 601  |  20 January 2022  |  347
10.	
Vandersypen, L. M. K. et al. Interfacing spin qubits in quantum dots and donors–hot, 
dense, and coherent. npj Quantum Inf. 3, 34 (2017).
11.	
Yoneda, J. et al. A quantum-dot spin qubit with coherence limited by charge noise and 
fidelity higher than 99.9%. Nat. Nanotechnol. 13, 102–106 (2018).
12.	
Yang, C. H. et al. Silicon qubit fidelities approaching incoherent noise limits via pulse 
engineering. Nat. Electron. 2, 151–158 (2019).
13.	
Xue, X. et al. Benchmarking gate fidelities in a Si/SiGe two-qubit device. Phys. Rev. X 9, 
021011 (2019).
14.	
Huang, W. et al. Fidelity benchmarks for two-qubit gates in silicon. Nature 569,  
532–536 (2019).
15.	
Takeda, K. et al. Quantum tomography of an entangled three-qubit state in silicon. Nat. 
Nanotechnol. 16, 965–969 (2021).
16.	
Watson, T. F. et al. A programmable two-qubit quantum processor in silicon. Nature 555, 
633–637 (2018).
17.	
Xue, X. et al. CMOS-based cryogenic control of silicon quantum circuits. Nature 593, 
205–210 (2021).
18.	
Elzerman, J. M. et al. Single-shot read-out of an individual electron spin in a quantum dot. 
Nature 430, 431–435 (2004).
19.	
Pioro-Ladrière, M. et al. Electrically driven single-electron spin resonance in a slanting 
Zeeman field. Nat. Phys. 4, 776–779 (2008).
20.	 Vandersypen, L. M. K. & Chuang, I. L. NMR techniques for quantum control and 
computation. Rev. Mod. Phys. 76, 1037 (2005).
21.	
Loss, D. & DiVincenzo, D. P. Quantum computation with quantum dots. Phys. Rev. A 57, 
120 (1998).
22.	 Petta, J. R. et al. Coherent manipulation of coupled electron spins in semiconductor 
quantum dots. Science 309, 2180–2184 (2005).
23.	 Meunier, T., Calado, V. E. & Vandersypen, L. M. K. Efficient controlled-phase gate for 
single-spin qubits in quantum dots. Phys. Rev. B 83, 121403 (2011).
24.	 Martins, F. et al. Noise suppression using symmetric exchange gates in spin qubits.  
Phys. Rev. Lett. 116, 116801 (2016).
25.	 Reed, M. D. et al. Reduced sensitivity to charge noise in semiconductor spin qubits via 
symmetric operation. Phys. Rev. Lett. 116, 110402 (2016).
26.	 Blume-Kohout, R. et al. Demonstration of qubit operations below a rigorous fault 
tolerance threshold with gate set tomography. Nat. Commun. 8, 14485 (2017).
27.	
Magesan, E., Gambetta, J. M. & Emerson, J. Characterizing quantum gates via randomized 
benchmarking. Phys. Rev. A 85, 042311 (2012).
28.	 Dehollain, J. P. et al. Optimization of a solid-state electron spin qubit using gate set 
tomography. New J. Phys. 18, 103018 (2016).
29.	 White, G. A., Hill, C. D. & Hollenberg, L. C. Performance optimization for drift-robust 
fidelity improvement of two-qubit gates. Phys. Rev. Appl. 15, 014023 (2021).
30.	 Blume-Kohout, R. et al. A taxonomy of small Markovian errors. Preprint at https://arxiv.org/
abs/2103.01928 (2021).
31.	
Cerfontaine, P., Otten, R., Wolfe, M. A., Bethke, P. & Bluhm, H. High-fidelity gate set for 
exchange-coupled singlet-triplet qubits. Phys. Rev. B 101, 155311 (2020).
32.	 Pan, A. et al. Resonant exchange operation in triple-quantum-dot qubits for spin–photon 
transduction. Quantum Sci. Technol. 5, 034005 (2020).
33.	 Zajac, D. M. et al. Resonantly driven CNOT gate for electron spins. Science 359, 439–442 
(2017).
34.	 Martinis, J. M. & Geller, M. R. Fast adiabatic qubit gates using only σz control. Phys. Rev. A 
90, 022307 (2014).
35.	 Nielsen, E. et al. Gate set tomography. Quantum 5, 557 (2021).
36.	 Hempel, C. et al. Quantum chemistry calculations on a trapped-ion quantum simulator. 
Phys. Rev. X 8, 031022 (2018).
37.	
Chow, J. M. et al. Detecting highly entangled states with a joint qubit readout. Phys. Rev. A 
81, 062325 (2010).
38.	 McClean, J. R. et al. OpenFermion: the electronic structure package for quantum 
computers. Quantum Sci. Technol. 5, 034014 (2020).
39.	 Ganzhorn, M. et al. Gate-efficient simulation of molecular eigenstates on a quantum 
computer. Phys. Rev. Appl. 11, 044092 (2019).
40.	 Mądzik, M. T. et al. Precision tomography of a three-qubit donor quantum processor in 
silicon. Nature 601, 348–353 (2022).
41.	
Zheng, G. et al. Rapid gate-based spin read-out in silicon using an on-chip resonator.  
Nat. Nanotechnol. 14, 742–746 (2019).
42.	 Schaal, S. et al. Fast gate-based readout of silicon quantum dots using Josephson 
parametric amplification. Phys. Rev. Lett. 124, 067701 (2020).
Publisher’s note Springer Nature remains neutral with regard to jurisdictional claims in 
published maps and institutional affiliations.
Open Access This article is licensed under a Creative Commons Attribution 
4.0 International License, which permits use, sharing, adaptation, distribution 
and reproduction in any medium or format, as long as you give appropriate 
credit to the original author(s) and the source, provide a link to the Creative Commons license, 
and indicate if changes were made. The images or other third party material in this article are 
included in the article’s Creative Commons license, unless indicated otherwise in a credit line 
to the material. If material is not included in the article’s Creative Commons license and your 
intended use is not permitted by statutory regulation or exceeds the permitted use, you will 
need to obtain permission directly from the copyright holder. To view a copy of this license, 
visit http://creativecommons.org/licenses/by/4.0/.
© The Author(s) 2022
1s
H
H
1s
Bonding
Anti-bonding
Atomic
orbitals
Atomic
orbitals
Molecular
orbitals
Partial
tomography
New parameter T
Parameterizing ansatz state
HF state preparation
XQ2
Z(T)Q2
XQ2
2
–XQ2
YQ1
–YQ1
=  h0  +  h1
+  h4
+  h5
+  h2
+  h3
Phase, T (rad)
0
1
2
3
4
5
6
Expectation value
0
0.5
1.0
–0.5
–1.0
Internuclear distance, R (Å)
0.5
1.0
1.5
2.0
2.5
3.0
R (Å)
0.5
1.0
1.5
2.0
Energy (Ha)
0
–0.2
0.2
–0.4
–1.0
–0.6
–0.8
–1.2
20
10
∆E (mHa)
Theory
VQE
d
a
b
c
〈ZZ〉
〈ZZ〉
〈XX〉
〈YY〉
〈IZ〉
〈XX〉
〈YY〉
〈ZI〉
〈H(T)〉
〈ZI〉
〈IZ〉
〈ZZ〉
〈XX〉
〈YY〉
Fig. 5 | Variational quantum eigensolver. a, Lowest two molecular orbitals of a 
H2 molecule, formed by the 1s orbitals of two hydrogen atoms. b, The quantum 
circuit to implement the VQE algorithm for a H2 molecule. The orange block 
prepares the HF initial state by flipping Q2. The circuit in green blocks creates the 
parameterized ansatz state. −XQi and −YQ j include virtual Z gates. CNOT gates are 
compiled as [ −Y , CZ, Y ]
Q
Q
2
2 . To make use of the high-fidelity CZ gate, such 
compilation is preferred instead of using a single controlled-phase gate with 
incremental length for creating the parameterized ansatz state. c, Expectation 
values of the operators in the two-qubit Hamiltonian under BK transformation as 
a function of θ. Black solid lines show the predicted values. The coloured solid lines 
are sinusoidal fits to the data (and a constant fit for the case of ZZ). d, Potential 
energy of the H2 molecule at varying R. The VQE data are normalized to the 
theoretical energy at large R to directly compare the dissociation energy with the 
theoretical value. The inset shows the error in the normalized experimental data.

Article
Methods
Measurement setup
The measurement setup and device are similar to those used in ref. 17. 
We summarize a few key points and all the differences here. The gates 
LP, RP and B are connected to arbitrary waveform generators (AWGs, 
Tektronix 5014C) via coaxial cables. The position in the charge-stability 
diagram of the quantum dots is controlled by voltage pulses applied to 
LP and RP. Linear combinations of the voltage pulses applied to B, LP and 
RP are used to control the exchange coupling between the two qubits at 
the symmetry point. The compensation coefficients are vLP/vB = −0.081 
and vRP/vB = 0.104. A vector signal generator (VSG, Keysight E8267D) is 
connected to gate MW and sends frequency-multiplexed microwave 
bursts (not necessarily time-multiplexed) to implement electric-dipole 
spin resonance (EDSR). The VSG has two I/Q input channels, receiving 
I/Q modulation pulses from two channels of an AWG. I/Q modulation 
is used to control the frequency, phase and length of the microwave 
bursts. The current signal of the sensing quantum dot is converted to 
a voltage signal and recorded by a digitizer card (Spectrum M4i.44), 
and then converted into 0 or 1 by comparing it to a threshold value.
Two differences between the present setup and that in ref. 17 are that 
(1) the programmable mechanical switch is configured such that gate 
MW is always connected to the VSG and not to the cryo-CMOS control 
chip and (2) a second AWG of the same model is connected to gate B, 
with its clock synchronized to the first AWG.
Gate calibration
In the gate set used in this work, {I, X
, Y , X
, Y , CZ}
Q
Q
Q
Q
1
1
2
2
, the duration 
of the I gate and the CZ gate are set to 100 ns, and we calibrate and keep 
the amplitudes of the single-qubit drives fixed and in the linear-response 
regime, where the Rabi frequency is linearly dependent on the driving 
amplitude. The envelopes of the single-qubit gates are shaped follow-
ing a ‘Tukey’ window, as it allows adiabatic single-qubit gates with 
relatively small amplitudes, thus, avoiding the distortion caused by a 
nonlinear response. The general Tukey window of length tp is given by



























W t r
t
t
t
t
t
t
( , ) =
1 −cos
0 ≤≤
1
< <
−
1 −cos
−
≤≤
,
(1)
t
rt
rt
rt
rt
t
t
rt
rt
1
2
2π
2
2
p
2
1
2
2π(
−)
p
2
p
p
p
p
p
p
p
p
where r = 0.5 for our pulses. Apart from these fixed parameters, there 
are 11 free parameters that must be calibrated: single-qubit frequencies 
fQ1 and fQ 2, burst lengths for single-qubit gates tXY1 and tXY2, phase shifts 
caused by single-qubit gates on the addressed qubit itself ϕ11 and ϕ22, 
phase shifts caused by single-qubit gates on the unaddressed ‘victim 
qubit’ ϕ12 and ϕ21 (ϕ12 is the phase shift on Q1 induced by a gate on Q2 
and similar for ϕ21), the peak amplitude of the CZ gate AvB and phase 
shifts caused by the gate voltage pulses used for the CZ gate on the 
qubits θ1 and θ2 (in addition, we absorb into θ1 and θ2 the 90° phase 
shifts needed to transform diag(1, i, i, 1) into diag(1, 1, 1, −1)).
For single-qubit gates, fQ1 and fQ 2 are calibrated by standard Ramsey 
sequences, which are automatically executed every 2 h, at the beginning  
and in the middle (after 100 times the average of each sequence) of the 
GST experiment. The EDSR burst times tXY1 and tXY2 are initially cali-
brated by an AllXY calibration protocol43. The phases ϕ11, ϕ12, ϕ21 and 
ϕ22 are initially calibrated by measuring the phase shift of the victim 
qubit (Q1 for ϕ11 and ϕ21; Q2 for ϕ22 and ϕ12) in a Ramsey sequence inter-
leaved by a pair of [X
, −X
]
Q
Q
i
i  gates on the addressed qubit (Q1 for ϕ11 
and ϕ12; Q2 for ϕ22 and ϕ21) (Extended Data Fig. 4).
The optimal pulse design presented in Fig. 3 gives a rough guidance 
of the pulse amplitude AvB. In a more precise calibration of the CZ gate, 
an optional π-rotation is applied to the control qubit (for example, Q1) 
to prepare it into the |0⟩ or |1⟩ state, followed by a Ramsey sequence on 
the target qubit (Q2) interleaved by an exchange pulse. The amplitude 
is precisely tuned to bring Q2 completely out of phase (by 180°) between 
the two measurements (Extended Data Fig. 4d, e). The phase θ2 is deter-
mined such that the phase of Q2 changes by zero (π) when Q1 is in the 
state |0⟩ (|1⟩), corresponding to CZ = diag(1, 1, 1, −1) in the standard 
basis. The same measurement is then performed again with Q2 as the 
control qubit and Q1 as the target qubit to determine θ1 (ref. 16).
In such a ‘conventional’ calibration procedure of the CZ gate, we 
notice that the two qubits experience different conditional phases 
(Extended Data Fig. 4). We believe that this effect is caused by 
off-resonant driving from the optional π-rotation on the control qubit. 
Similar effects can also affect the calibration of the phase crosstalk 
from single-qubit gates.
This motivates us to use the results from GST as feedback to adjust 
the gate parameters. The error generators not only describe the total 
errors of the gates but also distinguish Hamiltonian errors (coherent 
errors) from stochastic errors (incoherent errors). We use the informa-
tion on seven different Hamiltonian errors (IX, IY, XI, YI, ZI, IZ and ZZ) of 
each gate to correct all 11 gate parameters (Extended Data Fig. 5), except 
fQ1 and fQ 2, for which calibrations using standard Ramsey sequences  
are sufficient. For single-qubit gates, tXY1 and tXY2 are adjusted according 
to the IX, IY, XI and YI errors. The phases ϕ11, ϕ12, ϕ21 and ϕ22 are adjusted 
according to the ZI and IZ errors. For the CZ gate, θ1 and θ2 are adjusted 
according to the ZI and IZ errors, and AvB is adjusted according to the ZZ 
error. The adjusted gates are then used in a new GST experiment.
Theoretical model
In this section, we describe the theoretical model used for the fitting, 
the pulse optimization and the numerical simulations. The dynamics 
of two electron spins in the (1,1) charge configuration can be accurately 
described by an extended Heisenberg model21




H
gµ
gµ
hJ
=
⋅
+
⋅
+
⋅
−1
4 ,
(2)
B
1
1
B
2
2
1
2
B
S
B
S
S
S
with 
X Y Z
= (
,
,
) /2,
j
j
j
j
T
S
 where Xj, Yj and Zj are the single-qubit Pauli  
matrices acting on spin j = 1, 2, μB the Bohr’s magneton, g ≈ 2 the g-factor 
in silicon and h is Planck’s constant. The first and second terms describe 
the interaction of the electron spin in dot 1 and dot 2 with the magnetic 
fields 
B
B
= (
, 0,
)
j
x j
z j
,
,
T
B
 originating from the externally applied field 
and the micromagnet. The transverse components Bx,j induce spin-flips, 
thus, single-qubit gates if modulated resonantly via EDSR. For later 
convenience, we define the resonance frequencies by hf
gμ B
=
Q
z
B
,1
1
 
and hf
gμ B
=
Q
z
B
,2
2
, and the energy difference between the qubits 
ΔEz = gμB(Bz,2 − Bz,1). The last term in the Hamiltonian of equation (2) 
describes the exchange interaction J between the spins in neighbour-
ing dots. The exchange interaction originates from the overlap of the 
wave functions through virtual tunnelling events and is, in general, a 
nonlinear function of the applied barrier voltage vB. We note that vB 
determines the compensation pulses applied to LP and RP for virtual 
barrier control. We model J as an exponential function31,32
J v
J
(
) =
e
,
(3)
αv
B
res
2
B
where Jres ≈ 20–100 kHz is the residual exchange interaction during 
idle and single-qubit operations and α is the lever arm. In general, 
the magnetic fields 
j
B  depend on the exact position of the electron. 
We include this in our model B
B
v
B
β v
→
(
) =
(0) +
,
z j
z j
z j
j
γ
,
,
B
,
B  where βj 
accounts for the impact of the barrier voltage on the resonance fre-
quency of qubit j. The transition energies described in the main text 
are now given by diagonalizing the Hamiltonian from equation (2) 
and computing the energy difference between the eigenstates cor-
responding to the computational basis states {|00⟩, |01⟩, |10⟩, |11⟩} 
(ref. 44). We have

hf
(Q = 0 ) = ( 10 ) −( 00 ),
(4)
Q
2
1
E
E
E
E
hf
(Q = 1 ) = ( 11 ) −( 01 ),
(5)
Q
2
1
E
E
hf
(Q = 0 ) = ( 01 ) −( 00 ),
(6)
Q
1
2
hf
(Q = 1 ) = ( 11 ) −( 10 ),
(7)
Q
1
2
E
E
where 
ξ
(
)
E
 denotes the eigenenergy of eigenstate |ξ ⟩ and |0⟩ = |↓⟩ is 
defined by the magnetic field direction.
In the presence of noise, qubits start to lose information. In silicon, 
charge noise and nuclear noise are the dominating sources of noise. 
In the absence of two-qubit coupling and correlated charge noise, both 
qubits decohere largely independently of each other, giving rise to a 
decoherence time set by the interaction with the nuclear spins and 
charge noise coupling to the qubit via intrinsic and artificial (via the 
inhomogeneous magnetic field) spin–orbit interaction. We describe 
this effect by f
f
δf
→
+
Q
Q
Q
1
1
1 and f
f
δf
→
+
Q
Q
Q
2
2
2, where δfQ1 and δfQ2 are 
the  single-qubit  frequency fluctuations. Charge noise can additionally 
affect both qubits via correlated frequency shifts and the exchange 
interaction through the barrier voltage, which we model as vB → vB + δvB. 
In the presence of finite exchange coupling, one can define four distinct, 
pure dephasing times, each corresponding to the dephasing of a single 
qubit with the other qubit in a specific basis state. In a quasistatic 
approximation, the four dephasing times are then given by
(
)
(
)
(
)
T
δv
δ f
δ f
(Q (Q = 0 ))
=
1
2π
+
+
,
(8)
d hf
dv
d hf
dhf
d hf
dhf
2

1
2
(Q
= 0 ))
2
B
2
(Q
= 0 )
2
Q
2
(Q
= 0 )
2
Q
2
Q1
2
B
Q1
2
Q1
Q1
2
Q2
1
2
























(
)
(
)
(
)
T
δv
δ f
δ f
(Q (Q = 1 ))
=
1
2π
+
+
,
(9)
d hf
dv
d hf
dhf
d hf
dhf
2

1
2
(Q
= 1 ))
2
B
2
(Q
= 1 )
2
Q
2
(Q
= 1 )
2
Q
2
Q1
2
B
Q1
2
Q1
Q1
2
Q2
1
2












(
)
(
)
(
)
T
δv
δ f
δ f
(Q (Q = 0 ))
=
1
2π
+
+
,
(10)
d hf
dv
d hf
dhf
d hf
dhf
2
⁎
2
1
(Q = 0 ))
2
B
2
(Q = 0 )
2
Q
2
(Q = 0 )
2
Q
2
Q2
1
B
Q2
1
Q1
Q2
1
Q2
1
2












(
)
(
)
(
)
T
δv
δ f
δ f
(Q (Q = 1 ))
=
1
2π
+
+
.
(11)
d hf
dv
d hf
dhf
d hf
dhf
2
⁎
2
1
(Q = 1 ))
2
B
2
(Q = 1 )
2
Q
2
(Q = 1 )
2
Q
2
Q2
1
B
Q2
1
Q1
Q2
1
Q2
1
2
Fitting qubit frequencies and dephasing times
The transition energies in equations (4)–(7) are fitted simultaneously 
to the measured results from the Ramsey experiment (see Fig. 3a). 
For the fitting, we use the NonLinearModelFit function from the soft-
ware Mathematica with the least squares method. The best fits yield 
the following parameters: α = 12.1 ± 0.05 V−1, β1 = −2.91 ± 0.11 MHz V−γ, 
β2 = 67.2 ± 0.63 MHz V−γ, γ = 1.20 ± 0.01 and Jres = 58.8 ± 1.8 kHz.
The dephasing times in equations (8)–(11) are fitted simultaneously 
to the measured results from the Ramsey experiment (see Fig. 3c) using 
the same method. The best fits yield the following parameters: 
δvB = 0.40 ± 0.01 mV, δf
= 11±0.1kHz
Q1
 and δf
= 24±0.7kHz
Q2
.
Numerical simulations
For all numerical simulations, we solve the time-dependent Schrödinger 
equation
ħ t
t
H
t
i
d
d ψ( ) =
ψ( )
(12)
and iteratively compute the unitary propagator according to
U t
t
U t
( + Δ ) = e
( ),
ħ H t
t
−i
( +Δ )
where ħ
h
=
/(2π) is the reduced Planck’s constant. Here H(t + Δt) is dis-
cretized into N segments of length Δt such that H(t) is constant in the 
time interval [t, t + Δt]. All simulations are performed in the rotating 
frame of the external magnetic field (Bz,1 + Bz,2)/2 and neglecting the 
counter-rotating terms, making the so-called rotating-wave approxima-
tion. This allows us to choose Δt = 10 ps as a sufficiently small time step.
For the noise simulations, we included classical fluctuations of 
f
f
δf
→
+
Q
Q
Q
1
1
1, f
f
δf
→
+
Q
Q
Q
2
2
2 and vB → vB + δvB. We assume the noise 
coupling to the resonance frequencies δfQ1 and δfQ2 to be quasistatic 
and assume 1/f noise for vB, which we describe by its spectral density 
S
ω
δv
ω
( ) =
/
v
B
B
, where ω is the angular frequency. To compute time 
traces of the fluctuation, we use the approach introduced in refs. 45,46 
to generate time-correlated time traces. The fluctuations are discre-
tized into N segments with time Δt such that δvB(t) is constant in the 
time interval [t, t + Δt), with the same Δt as above. Consequently, fluc-
tuations that are faster than f
=
t
max
1
∆ are truncated.
CZ gate
We realize a universal CZ = diag(1, 1, 1, −1) gate by adiabatically puls-
ing the exchange interaction using a carefully designed pulse shape. 
Starting from equation (2), the full dynamics can be projected on the 
odd-parity space spanned by |01⟩ and |10⟩. The entangling exchange 
gate is reduced in this subspace to a global phase shift, thus, the goal 
is to minimize any dynamics inside the subspace. Introducing a new 
set of Pauli operators in this subspace σx = |01⟩⟨10| + |10⟩⟨01|, σy = −i|01⟩
⟨10| + i|10⟩⟨01| and σz = |01⟩⟨01| − |10⟩⟨10|, we find
H
t
hJ v t
E σ
hJ v t
σ
( ) = 1
2( −
(
( )) + Δ
+
(
( ))
).
(14)
z
z
x
sub
B
B
In order to investigate the adiabatic behaviour, it is convenient to 
switch into the adiabatic frame defined by U
= e
.
σ
ad
−tan
hJ v
t
Ez
y
i
2
−1
( B( ))
Δ




The 
Hamiltonian accordingly transforms as
̇
H
U
t H
t U
t
ħU
t U
t
=
( )
( )
( ) −i
( )
( )
(15)
ad
ad
†
sub
ad
ad
†
ad
hJ v t
ΔE σ
h J
E σ
≈1
2( −
(
( )) +
−2πΔ
),
(16)
z z
z
y
B
2 ̇
where the first term is unaffected and describes the global phase accu-
mulation due to the exchange interaction, the second term describes 

Article
the single-qubit phase accumulations and the last term, 
̇
f t
h J
E
( ) =
/(4πΔ
)
z
2
, describes the diabatic deviation proportional to 
the derivative of the exchange pulse. From equation (15) and equa-
tion (16), we assumed a constant ΔEz(t) ≈ ΔEz and hJ(t) ≪ ΔEz. The tran-
sition probability from state |↑↓⟩ to |↓↑⟩ using a pulse of length tp is 
then given by34
∫
P
f t
t
≈
( )e
d
(17)
t
ħ
E t
↑↓→↓↑
0
−i Δ
2
z
p
S f t
∝
( ( )).
(18)
s
From the first to the second line, we identify the integral by the 
(short-timescale) Fourier transform, allowing us to describe the 
spin-flip error probability by the energy spectral density Ss of the input 
signal f(t). Minimizing such errors is, therefore, identical to minimizing 
the energy spectral density of a pulse, a well-known and solved problem 
from classical signal processing and statistics. Optimal shapes are com-
monly referred to as window functions W(t) due to their property of 
restricting the spectral resolution of signals. A high-fidelity exchange 
pulse is consequently given by J(0) = J(tp) and
∫
tJ v t
d (
( )) = 1/4,
(19)
t
0
B
p
while setting J t
A
W t J
( ) =
( )
v
res
B
 (ref. 34), with a scaling factor AvB that is 
to be determined. In this work, we have chosen the cosine window
W t
t
t
( ) = 1
2 1 −cos 2π
(20)
p














from signal processing, which has a high spectral resolution. The ampli-
tude AvB follows from condition equation (19). For a pulse length of 
tp = 100 ns and a cosine pulse shape, we find A
J
= 10.06 MHz
v
res
B
. As 
explained in the main text, owing to the exponential voltage-exchange 
relation, the target pulse shape for J(t) must be converted to a barrier 
gate pulse, following47
(
)
v t
α
A
W t
( ) = 1
2
log
( ) .
(21)
v
B
B
Our numerical simulations predict an average gate infidelity 
1 − Fgate < 10−6 without noise and 1 − F = 0.22 × 10−3 with the inclusion of 
noise through the fluctuations δfQ1, δfQ2 and δvB, discussed in the previ-
ous section. The measured PTMs reveal much higher rates of incoher-
ent errors, which we attribute to drifts in the barrier voltage on a 
timescale much longer than the timescale on which δfQ1, δfQ2 and δvB 
were determined.
Gate-set tomography analysis
We designed a GST experiment using the gate set {I, X
, Y , X
, Y , CZ},
Q
Q
Q
Q
1
1
2
2
 
where I is a 100-ns idle gate, XQ1 (YQ1) and XQ 2 (YQ 2) are single-qubit π/2 
gates with rotation axis xˆ (yˆ) on Q1 and Q2, with durations of 150 ns 
and 200 ns, respectively, and CZ = diag(1, 1, 1, −1). A classic two-qubit 
GST experiment consists of a set of germs designed to amplify all types 
of error in the gate set when repeated and a set of 36 fiducials com-
posed by the 11 elementary operations {null, X
, X
X
, X
X
X
,
Q
Q
Q
Q
Q
Q
1
1
1
1
1
1  
Y , Y Y Y , X
, X
X
, X
X
X
, Y , Y Y Y }
Q
Q
Q
Q
Q
Q
Q
Q
Q
Q
Q
Q
Q
Q
1
1
1
1
2
2
2
2
2
2
2
2
2
2
required to  
carry out quantum process tomography of the germs48. We use a set 
of 16 germs {I, X
, Y , X
, Y , CZ, X
Y , X
Y , X
X
Y , X
X
Q
Q
Q
Q
Q
Q
Q
Q
Q
Q
Q
Q
Q
1
1
2
2
1
1
2
2
1
1
1
2
2
Y , X
Y CZ, CZX
X
X
, X
X
Y X
Y Y , X
Y X
Y X
X
,
Q
Q
Q
Q
Q
Q
Q
Q
Q
Q
Q
Q
Q
Q
Q
Q
Q
Q
2
2
2
2
1
1
1
2
2
1
2
1
1
2
2
1
2
2  
CZX
Y CZY X
, Y X
Y X
X
X
Y Y }
Q
Q
Q
Q
Q
Q
Q
Q
Q
Q
Q
Q
2
1
2
1
1
1
2
1
2
1
1
2 (ref. 35).   Note  that  the  
null gate is the instruction for doing nothing in zero time, different 
from the idle gate. Simple errors such as errors in the rotation angle 
of a particular gate can be amplified by simply repeating the same 
gate. More complicated errors such as tilts in rotation axes can only 
be amplified by a combination of different gates. The germs and fidu-
cials are then compiled into GST sequences, such that each sequence 
consists of two fiducials interleaved by a single germ or power of 
germs35 (as illustrated in Fig. 2a). The GST sequences are classified by 
their germ powers into lengths L = 1, 2, 4, 8, 16…, where a sequence of 
length n consists of n gates plus the fiducial gates. We note that the 
sequences used in GST are shorter than the sequences involved in 
other methods to self-consistently estimate the gate performance, 
such as randomized benchmarking. As a result, GST suffers less from 
drift in qubit frequencies and readout windows induced by long 
sequences of microwave bursts.
After the execution of all sequences, a maximum-likelihood esti-
mation is performed to estimate the process matrices of each gate 
in the gate set and the SPAM probabilities. We use the open source 
pyGSTi Python package49,50 to perform the maximum-likelihood 
estimation, as well as to design an optimized GST experiment by 
eliminating redundant circuits and to provide statistical error bars 
by computing all involved Hessians. The circuit optimization allows 
us to perform GST with a maximum sequence length Lmax = 16 using 
1,685 different sequences in total. The pyGSTi package quantifies the 
Markovian-model violation of the experimental data, counting the 
number of standard deviations exceeding their expectation values 
under the χ2 hypothesis50. This model violation is internally translated 
into a more accessible goodness ratio from 0 to 5, with 5 being the best49, 
where we obtain a 4 out of 5 rating, indicating remarkably small devia-
tions from expected results. The total number of standard deviations 
exceeding the expected results for each L, as well as the contribution 
of each sequence to this number, can be found in the pyGSTi report, 
along with the supporting data.
From the GST experiment, we have extracted the PTM Mexp describ-
ing each gate in our gate set {
}
I, X
, Y , X
, Y , CZ
Q
Q
Q
Q
1
1
2
2
. The PTM is iso-
morphically related to the conventionally used χ matrix describing a 
quantum process. A completely positive, trace-preserving, two-qubit 
PTM has 240 parameters describing the process. To obtain insight into 
the errors of the gates in the experiment, we first compute the error in 
the PTM given by E =
exp
ideal
−1
M
M
, where we have adapted the conven-
tion to add the error after the ideal gate. The average gate fidelity is 
then conveniently given by
M
M
F
d
d d
=
Tr(
) +
( + 1)
.
(22)
gate
exp
−1
ideal
It is related to the entanglement fidelity via 
(
)
F
F
1 −
=
1 −
d
d
ent
+ 1
gate  
(ref. 51), where d is the dimension of the two-qubit Hilbert space. 
Although the PTM M perfectly describes the errors, it is more intuitive 
to analyse the corresponding error generator L
E
= log( ) of the pro-
cess30. The error generator L relates to the error PTM E in a similar way 
as a Hamiltonian H relates to a unitary operation U = e−iH. The error 
generator can be separated into several blocks. A full discussion about 
the error generator can be found in ref. 30. In this work, we have used 
the error generator to distinguish the dynamics originating from coher-
ent Hamiltonian errors, which can be corrected by adjusting gate 
parameters (see Extended Data Fig. 5), and from noisy/stochastic 
dynamics, which cannot be corrected easily. The coherent errors can 
be extracted by projecting L onto the 4 × 4-dimensional Hamiltonian 
space H. In the Hilbert–Schmidt space, the Hamiltonian projection is 
given by30
L


H
d
P
P
P
P
11
11
= −i Tr (
⊗
⊗
−
⊗
⊗
)
,
(23)
mn
m
n
d
d
m
n
2
T
T
sup
where 
sup
L
 is the error generator in Liouville superoperator form, 
Pm ∈ {I, X, Y, Z} are the extended Pauli matrices with m, n = 0, 1, 2, 3, 1d is 

the d-dimensional identity matrix and d = 4 is the dimension of the 
two-qubit Hilbert space. To improve the calibration of our gate set, we 
use the information of seven different Hamiltonian errors (IX, IY, XI, 
YI, ZI, IZ and ZZ). To estimate coherent Hamiltonian errors and incoher-
ent stochastic errors, two new metrics are considered30: the 
Jamiołkowski probability
ρ
ϵ ( ) = −Tr( ( ) Ψ Ψ )),
(24)
J
J
L
L
which describes the amount of incoherent error in the process, and 
the Jamiołkowski amplitude
θ
ρ
( ) = (1 −Ψ Ψ ) ( ) Ψ
,
(25)
J
J
2
L
L
which approximately describes the amount of coherent Hamiltonian 
errors (Extended Data Table 1). Here 
(
)
ρ
Ψ
( ) =
⊗1
[
Ψ ]
d
J
2
L
L
 is the 
Jamiołkowski state and |Ψ⟩ is a maximally entangling four-qubit state 
that originates from the relation of quantum processes to states in a 
Hilbert space twice the dimension via the Choi–Jamiołkowski isomor-
phism52. For small errors, the average gate infidelity can be approxi-
mated by30


L
L
F
d
d
θ
1 −
=
+ 1 ϵ ( ) +
( )
.
(26)
gate
J
J
2
For a comparison of the performance of the single-qubit gates with 
previous experiments reporting single-qubit gate fidelities, we com-
pute the fidelities projected to the single-qubit space from the PTMs 
or the error generators. In Fig. 2 and Extended Data Fig. 2, single-qubit 
gate fidelities are estimated by projecting the PTMs onto the corre-
sponding subspace. Let 
j
P  be the projector on the subspace of qubit j, 
then the fidelity is given by
F
d
d
d
=
Tr(
) + ( /2)
( /2)(( /2) + 1)
.
(27)
j
j
sub
exp
−1
ideal
P M
P M
Error bars for the fidelity projected to the subspace are computed 
using standard error propagation of the confidence intervals of 
exp
M
 
provided by the pyGSTi package. A more optimistic estimation for the 
fidelities in the single-qubit subspace is given by projecting the error 
generators instead of the PTMs.
Variational quantum eigensolver
We follow the approach of ref. 36 to using the VQE algorithm to com-
pute the ground-state energy of molecular hydrogen, after mapping 
this state onto the state of two qubits. We include this information 
here for completeness. The Hamiltonian of a molecular system in 
atomic units is
R
r
R
R
r
r
R
r
∑
∑
∑
∑
∑
H
M
Q
Q Q
= −
∇
2
−
∇
2 −
−
+
−
+
1
−
,
(28)
i
i
j
i j
i
i
j
i j i
i
j
i
j
i j i
i
j
2
2
,
, >
, >
i
j
where 
i
R , Mi and Qi are the position, mass and charge, respectively, of 
the ith nuclei and rj is the position of the jth electron. The first two sums 
describe the kinetic energies of the nuclei and electrons, respectively. 
The last three sums describe the Coulomb repulsion between nuclei 
and electrons, nuclei and nuclei, and electrons and electrons, respec-
tively. As we are primarily interested in the electronic structure of the 
molecule, and nuclear masses are a few orders of magnitude larger 
than the electron masses, the nuclei are treated as static point charges 
under the Born–Oppenheimer approximation. Consequently, the 
electronic Hamiltonian can be simplified to
R
r
r
r
r
∑
∑
∑
H
Q
= −
∇
2 −
−
+
1
−
.
(29)
i
i j
i
i
j
i j i
i
j
e
2
,
, >
i
Switching into the second-quantization representation, described 
by fermionic creation and annihilation operators, ap
† and aq, acting on 
a finite basis, the Hamiltonian becomes
∑
∑
H
h a a
h
a a a a
=
+
,
(30)
pq
pq
p
q
pqrs
pqrs
p
q
r
s
e
†
†
†
where p, q, r and s label the corresponding basis states. The antisymme-
try under exchange is retained through the anticommutation relation 
of the operators. The weights of the two sums are given by the integrals
∫
∑
h
Q
ψ
=
d ψ ( )
∇
2 −
−
( ),
(31)
pq
p
i
i
i
q
⁎
2
i






σ
σ
R
r
σ
r
∫
h
=
d
d
ψ (
)ψ (
)ψ(
)ψ (
)
−
,
(32)
pqrs
p
q
s
r
1
2
⁎
1
⁎
2
1
2
1
2
σ
σ
σ
σ
σ
σ
r
r
where σ
r s
= ( , )
i
i
i  is a multi-index describing the position ri and the spin 
si of electron i. Such a second-quantized molecular Hamiltonian can 
be mapped onto qubits using the Jordan–Wigner (JW) or the BK trans-
formation5. The JW transformation directly encodes the occupation 
number (0 or 1) of the ith spin orbital into the state (|0⟩ or |1⟩) of the ith 
qubit. The number of qubits required after JW transformation is, thus, 
the same as the number of spin orbitals that are of interest. The BK 
transformation, on the other hand, encodes the information in both 
the occupation number and parities, whether there is an even or odd 
occupation in a subset of spin orbitals.
Taking molecular hydrogen in the HF basis as an example, we are 
interested in investigating the bonding (|O1↑⟩, |O1↓⟩) and the antibond-
ing orbital state (|O2↑⟩, |O2↓⟩). The initial guess of the solution is the 
HF state in which both electrons occupy the |O1⟩ orbital. The JW trans-
formation encodes the HF initial state as |1100⟩, representing 
N
N
N
N
|
O
O
O
O
↓
↑
↓
↑
1
1
2
2
 from left to right, where NO S
i  is the occupation of 
the OiS spin orbital with S = ↑, ↓. The BK transformation encodes the 
HF initial state as |1000⟩, where the first and the third qubits (counting 
from the right) encode the occupation number of the first and third 
spin orbitals (N
= 1
O ↑
1
 and N
= 0
O ↑
2
), the second qubit encodes the par-
ity of the first two spin orbitals ((
)
N
N
+
O
O
↑
↓
1
1
 mod 2 = 0) and the fourth 
qubit encodes the parity of all four spin orbitals 
((
)
N
N
N
N
+
+
+
O
O
O
O
↑
↓
↑
↓
1
1
2
2
 mod 2 = 0). With the standard transforma-
tion rules for fermionic creation and annihilation operators, the system 
Hamiltonian becomes a four-qubit Hamiltonian
H
g
g
g
g
g
g
g
g
g
g
g
g
g
g
g
=
I +
Z +
Z +
Z +
Z
+
Z Z +
Z Z +
Z Z
+
Z Z +
Z Z +
Z Z
+
YX X Y +
YY X X
+
X X Y Y +
X Y Y X ,
(33)
JW
0
1
1
2
2
3
3
4
4
5
1
2
6
1 3
7
1
4
8
2 3
9
2
4
10 3
4
11 1
2
3 4
12 1 2
3
4
13
1
2 3 4
14
1 2 3
4
H
g
g
g
g
g
g
g
g
g
g
g
g
g
g
g
=
I +
Z +
Z +
Z
+
Z Z +
Z Z +
Z Z
+
Z Z Z +
Z Z Z +
Z Z Z
+
Z Z Z Z +
X Z X
+
YZ Y +
X Z X Z +
YZ Y Z .
(34)
BK
0
1
1
2
2
3
3
4
1
2
5
1 3
6
2
4
7
1
2 3
8
1 3
4
9
2 3
4
10
1
2 3
4
11
1
2
3
12 1
2 3
13
1
2
3
4
14 1
2 3
4

Article
The subscripts are used to label the qubits. We see that, owing to the 
symmetry of the represented system in HBK, qubit 2 and qubit 4 are never 
flipped, allowing us to reduce the dimension of the Hamiltonian to
H
h
h
h
h
h
h
h
h
h
h
h
h
=
I +
Z +
Z +
Z Z
+
X X +
YY
+
ZI +
IZ +
ZZ
+
XX +
YY,
(35)
BK
reduced
0
1 1
2
2
3
1
2
4
1
2
5 1 2
0
1
2
3
4
5
where qubit 1 has been relabelled as qubit 2 and qubit 3 has been rela-
belled as qubit 1. The HF initial state is, therefore, reduced to |01⟩ and the 
Hamiltonian is rephrased to be consistent with the partial tomography 
expression in Fig. 5. This reduced representation requires only two qubits 
to simulate the hydrogen molecule. We emphasize that such a reduc-
tion of the BK Hamiltonian is not a special case for the H2 molecule but 
is connected to symmetry considerations to reduce the complexity of 
systems, in a scalable way.
VQE is a method to compute the ground-state energy of the Hamil-
tonian. The total energy can be directly calculated by measuring the 
expectation value of each Hamiltonian term. This can be done easily by 
partial quantum state tomography. All the expectation values are then 
added up with a set of weights (h0 through h5). The weights are only func-
tions of the internuclear separation (R) and can be computed efficiently 
by a classical computer. Here we use the OpenFermion Python package 
to compute these weights38.
The main task of the quantum processor is, then, to encode the molecu-
lar spin-orbital state into the qubits. The starting point is the HF initial state, 
which is believed to largely overlap with the actual ground state. In order 
to find the actual ground state, the initial state needs to be ‘parameterized’ 
into an ansatz to explore a subspace of all possible states. We apply the 
unitary coupled cluster (UCC) theory to the parameterized ansatz state, 
which is used to describe many-body systems and cannot be efficiently 
executed on a classical computer53. The UCC operator has a format
θ
θ
θ
U
( ) = e
,
(36)
∑T
T
UCC
(
( )−
( ))
n
n
n
†
with
θ
θ
∑
T
a a
( ) =
,
(37)
m i
i
m
m
i
1
,
†
θ
θ
∑
T
a a a a
( ) =
(38)
m n i j
i j
m n
m
n
i
j
2
, , ,
,
,
†
†
representing single and double excitation of the electrons. The indices 
i and j label the occupied spin orbitals and m and n are the labels of the 
unoccupied spin orbitals. The vector θ is the set of all parameters to 
optimize. In the case of a H2 molecule, the UCC operator is transformed 
into a qubit operator as
U
( ) = e
,
θ
UCC
BK
−i XY
θ
where θ is a single parameter to variationally optimize.
Data availability
Data supporting this work are available at Zenodo, https://doi.
org/10.5281/zenodo.5044450.
Code availability
The codes used for data acquisition and processing are from the 
open source Python packages QCoDeS (https://github.com/QCoDeS/
Qcodes), QTT (https://github.com/QuTech-Delft/qtt) and PycQED 
(https://github.com/DiCarloLab-Delft/PycQED_py3). The codes used 
for the design and analysis of the gate-set tomography experiment are 
from pyGSTi (https://github.com/pyGSTio/pyGSTi). The codes used 
for the design and analysis of the variational quantum eigensolver 
experiment are from OpenFermion (https://github.com/quantumlib/
OpenFermion).
 
43.	 Reed, M. Entanglement and Quantum Error Correction with Superconducting Qubits. PhD 
thesis, Yale Univ. (2013).
44.	 Russ, M. et al. High-fidelity quantum gates in Si/SiGe double quantum dots. Phys. Rev. B 
97, 085421 (2018).
45.	 Yang, Y.-C., Coppersmith, S. N. & Friesen, M. Achieving high-fidelity single-qubit gates  
in a strongly driven charge qubit with 1/f charge noise. npj Quantum Inf. 5, 12 (2019).
46.	 Koski, J. V. et al. Strong photon coupling to the quadrupole moment of an electron in a 
solid-state qubit. Nat. Phys. 16, 642–646 (2020).
47.	
Russ, M., Philips, S., Xue, X. & Vandersypen, L. M. K. The path to high fidelity multi-qubit 
gates for quantum dot spin qubits. Bull. Am. Phys. Soc. 66, abstr. S29.00002 (2021).
48.	 Greenbaum, D. Introduction to quantum gate set tomography. Preprint at https:// 
arxiv.org/abs/1509.02921 (2015).
49.	 Nielsen, E., Blume-Kohout, R. J., Rudinger, K. M., Proctor, T. J., Saldyt, L. & USDOE, Python 
GST Implementation (PyGSTi) v. 0.9, Tech. Rep. PyGSTi (Sandia National Laboratories,  
2019).
50.	 Nielsen, E. et al. Probing quantum processor performance with pyGSTi. Quantum Sci. 
Technol. 5, 044002 (2020).
51.	
White, A. G. et al. Measuring two-qubit gates. J. Opt. Soc. Am. B 24, 172–183 (2007).
52.	 Jamiolkowski, A. Linear transformations which preserve trace and positive 
semidefiniteness of operators. Rep. Math. Phys. 3, 275–278 (1972).
53.	 Taube, A. G. & Bartlett, R. J. New perspectives on unitary coupled-cluster theory. Int. J. 
Quantum Chem. 106, 3393–3401 (2006).
Acknowledgements We acknowledge discussions with P. Cerfontaine, C. Bureau-Oxton,  
M. T. Madzik, A. Morello, J. Helsen, B. Terhal, M. Veldhorst and all the members of the spin qubit 
team, and technical assistance from O. Benningshof, M. Sarsby, R. Schouten and R. Vermeulen. 
This research was funded by the Dutch Ministry of Economic Affairs through the allowance for Top 
Consortia for Knowledge and Innovation (TKI) and the Army Research Office (ARO) under grant 
number W911NF-17-1-0274. The views and conclusions contained in this document are those of 
the authors and should not be interpreted as representing the official policies, either expressed or 
implied, of the ARO or the US Government. The US Government is authorized to reproduce and 
distribute reprints for government purposes notwithstanding any copyright notation herein.
Author contributions X.X. performed the experiment, with help from N.S. and B.U. M.R. 
developed the theory model and analysed the data with X.X. N.S. fabricated the quantum dot 
device. A.S. and G.S. designed and grew the Si/SiGe heterostructure. X.X. and L.M.K.V. 
conceived the project. L.M.K.V. supervised the project. X.X., M.R. and L.M.K.V. wrote the 
manuscript, with input from all authors.
Competing interests The authors declare no competing interests.
Additional information
Supplementary information The online version contains supplementary material available at 
https://doi.org/10.1038/s41586-021-04273-w.
Correspondence and requests for materials should be addressed to Lieven M. K. 
Vandersypen.
Peer review information Nature thanks the anonymous reviewers for their contribution to the 
peer review of this work. Peer reviewer reports are available.
Reprints and permissions information is available at http://www.nature.com/reprints.

Process
matrix
Error
generator
Gate
inﬁdelity
Gate
YQ1     IQ2
XQ1     IQ2
IQ1     XQ2
IQ1     YQ2
IQ1     IQ2
CZ
Process
matrix
Error
generator
Gate
inﬁdelity
Gate
1.7 ± 1.2 %
0.88 ± 0.23 %
0.59 ± 0.29 %
1.19 ± 0.23 %
0.67 ± 0.23 %
0.35 ± 0.15 %
Extended Data Fig. 1 | Two-qubit processes. Average gate infidelities, process matrices (PTMs) and error generators of the six quantum gates in the chosen gate 
set. These results are analysed by the pyGSTi package using maximum-likelihood estimation.

Article
Process
matrix
Gate
inﬁdelity
Gate
YQ1
XQ1
IQ2
XQ2
IQ1
Process
matrix
Gate
inﬁdelity
Gate
0.75 ± 0.33 %
0.320 ± 0.073 %
0.27 ± 0.57 %
1.11 ± 0.39 %
0.39 ± 0.68 %
0.131 ± 0.025 %
YQ2
Extended Data Fig. 2 | Single-qubit processes. Average gate infidelities and process matrices (PTMs) of the identity gates (idle gates) and single-qubit X/Y gates 
in the subspace of the individual qubits. The individual PTMs are calculated from the PTMs in the two-qubit space (see Methods).

a
b
c
d
YQ1
YQ2
CZ
YQ1
YQ1
YQ2
CZ
ZQ2
YQ1

YQ1
YQ2
CZ
YQ1
ZQ1
YQ1
YQ2
CZ
YQ1
ZQ2
ZQ1
Extended Data Fig. 3 | Bell states predicted from the quantum processes. Top 
panels show the real part of the reconstructed density matrices of the four Bell 
states Ψ
= ( 01 + 10 )/ 2
+
 (a), Ψ
= ( 01 −10 )/ 2
−
 (b), Φ = ( 00 + 11 )/ 2
+
  
(c) and Φ = ( 00 −11 )/ 2
−
 (d). The colour code is the same as in Fig. 4. Bottom 
panels show the quantum circuit used to reconstruct the Bell states. Z i
Q
2  is a 
virtual π-rotation around the zˆ axis on the ith qubit, which is executed by a phase 
update on the microwave reference clock of the qubit and, therefore, is 
error-free. We numerically estimate the state fidelities to be 98.42% for the |Ψ+⟩ 
and |Ψ−⟩ states and 97.75% for the |Φ+⟩ and |Φ−⟩ states.

Article
b
c
d
e
XQ1
XQ1
Z(θ)Q1
XQ2
-XQ2
XQ1
XQ1
Z(θ)Q1
XQ1
-XQ1
XQ2
XQ2
Z(θ)Q2
XQ1
CZ
XQ1
XQ1
XQ2
CZ
Z(θ)Q1
XQ2
Y(Δθ)Q2
XQ2
Z(Δθ)Q2
=
XQ1
Z(Δθ)Q1
=
XQ1
Y(Δθ)Q1
X/YQ2
Z(φ21)Q1
Z(φ22)Q2
=
+
CZ
Z(θ1)Q1
Z(θ2)Q2
=
+
X/YQ1
Z(φ12)Q2
Z(φ11)Q1
=
+
a
Extended Data Fig. 4 | Initial gate calibrations. a, Decomposition of 
single-qubit and two-qubit gates. After each microwave burst for single-qubit 
rotations, a corresponding phase correction is applied to each qubit. The CZ 
gate is implemented by a barrier voltage pulse applied to gate B (orange) and 
negative compensation pulses applied to gates LP (blue) and RP (red), with the 
same shape as the barrier pulse. Single-qubit phase corrections are then 
applied on each qubit to compensate the frequency detuning induced by 
electron movement in the magnetic field gradient. b, c, Calibration of phase 
corrections on Q1 induced by a single-qubit gate applied on Q2 (ϕ21, b) and on Q1 
(ϕ11, c). A relative phase shift, 2ϕ21 (2ϕ11), is determined by interleaving the 
target gate (a π/2 rotation) and its inverse (a −π/2 rotation) on Q2 (Q1) in a 
Ramsey interference sequence. d, e, Calibration of phase corrections on each 
qubit after the CZ gate, using Q1 (d) and Q2 (e) as the control qubits, 
respectively. When the amplitude of the barrier pulse is perfectly calibrated, 
the two curves in each experiment should be out of phase by 180°. However, 
when the barrier pulse amplitude is calibrated such that one of the two 
experiments shows a 180° phase difference (d), the phase difference in the 
other calibration experiment always deviates by a few degrees. One possible 
explanation is that the optional π-rotation applied to the control qubit induces 
a small, off-resonance rotation on the other qubit, causing an additional phase 
on the target qubit to appear in the measurement due to the commutation 
relation of the Pauli operators.

a
f
c
d
e
b
Extended Data Fig. 5 | Pulse optimization. a, b, Full error generators for a CZ 
gate calibrated by conventional Ramsey sequences (a) and after improving the 
calibration using the information extracted from a (b), resulting in fidelities of 
97.86% and 99.65%, respectively. c, d, Seven Hamiltonian errors (IX, IY, XI, YI, IZ, 
ZI and ZZ) extracted from the error generators shown in a (c) and b (d). Owing 
to the crosstalk-induced additional phases shown in Extended Data Fig. 4, 
errors IZ, ZI and ZZ occur systematically in conventional calibrations. Error 
bars indicate the 2σ confidence intervals computed using the Hessian of the 
loglikelihood function. e, f, Shapes of the barrier pulses (e) and their 
corresponding J envelopes (f) for a CZ gate before and after being corrected by 
GST. Since the Hamiltonian to generate a CZ gate is H = (II + IZ + ZI − ZZ)/2, the 
positive ZZ error shown in c is corrected by increasing the amplitude of the 
pulse. The IZ and ZI errors are corrected by decreasing the phase shifts θ1 and θ2 
after the CZ gate. Hamiltonian errors in single-qubit gates are corrected 
similarly. The results presented in b and d are achieved in four loops of 
correction, with each loop correcting the parameters by approximately 70% of 
the measured deviation.

Article
Second
quanzaon
Hartree-Fock
mean-ﬁeld
Molecular
Hamiltonian
Qubit
Hamiltonian
JW or BK
Pamametrized
ansatz state
Hartree-Fock
inial state
Paral
tomography
Energy
expectaon
Adjusted
parameters
JW or BK
Quantum
processor
Classical
opmizer
Classical
processor
UCC
Measurement
Quantum gates
Sum
Opmizaon
Quantum gates
Extended Data Fig. 6 | Workflow of the variational quantum eigensolver 
algorithm. The qubit Hamiltonian is typically transformed from the molecular 
Hamiltonian by JW transformation or BK transformation by a classical 
processor (see Methods). A HF initial state is encoded into the qubit states 
according to JW or BK transformation and then transformed by the quantum 
processor into a parameterized ansatz state by considering single and double 
excitation in the molecule using the UCC theory. The expectation value of each 
individual Hamiltonian term is directly measured by partial state tomography. 
The expectation of the total energy is then calculated by the weighted sum of 
the individual expectations. The result is fed into a classical optimizer, which 
suggests a new parameterized ansatz state for the next run. This process is 
repeated until the expectation of the total energy converges.

Extended Data Table 1 | Gate metrics
Detailed overview of important metrics of the gate set {I, X
, Y , X
, Y
, CZ}
Q1
Q1
Q2
Q2
: the average gate fidelity Fgate (see equation (22)) and the fidelity reduced to the single-qubit subspace Fsub (see 
equation (27)), the Jamiołkowski probability ϵJ (see equation (24)), the Jamiołkowski amplitude θJ (see equation (25)), the trace distance 
M
M
M
M
= 
−

D(
,
)
/2
ideal
exp
ideal
exp 1
 and the diamond 
norm M
M
M
M

 =

⊗
−
⊗

⋄
ρ
ρ
,
max
(
1
)
(
1
)
/2
ρ
d
d
ideal
exp
ideal
2
exp
2
1
.

