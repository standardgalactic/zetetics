Submitted to the Annals of Applied Statistics
RADIOHEAD: RADIOGENOMIC ANALYSIS INCORPORATING TUMOR
HETEROGENEITY IN IMAGING THROUGH DENSITIES
BY SHARIQ MOHAMMED*,†, KARTHIK BHARATH‡, SEBASTIAN KURTEK§, ARVIND
RAO*,†, AND VEERABHADRAN BALADANDAYUTHAPANI *,†
University of Michigan†, University of Nottingham‡ and Ohio State University§
Address of Shariq Mohammed
Department of Biostatistics
Department of Computational Medicine & Bioinformatics
100 Washtenaw Ave
Palmer Commons Building, Room 2035
Ann Arbor, MI 48103, USA.
shariqm@umich.edu
Address of Karthik Bharath
School of Mathematical Sciences
Room C13
University Park
Nottingham, NG7 2RD, UK.
karthik.bharath@nottingham.ac.uk
Address of Sebastian Kurtek
Department of Statistics
404 Cockins Hall
CH 440B
Columbus, OH 43210, USA.
kurtek.1@stat.osu.edu
Address of Arvind Rao
Department of Biostatistics
Department of Computational Medicine & Bioinformatics
100 Washtenaw Ave
Palmer Commons Building, Room 2035
Ann Arbor, MI 48103, USA.
ukarvind@umich.edu
Address of Veerabhadran Baladandayuthapani
Department of Biostatistics
Department of Computational Medicine & Bioinformatics
1415 Washington Heights
School of Public Health I, Room 4622
Ann Arbor, MI 48103, USA.
veerab@umich.edu
Recent technological advancements have enabled detailed investigation
of associations between the molecular architecture and tumor heterogeneity,
through multi-source integration of radiological imaging and genomic (ra-
diogenomic) data. In this paper, we integrate and harness radiogenomic data
in patients with lower grade gliomas (LGG), a type of brain cancer, in order
to develop a regression framework called RADIOHEAD (RADIOgenomic
analysis incorporating tumor HEterogeneity in imAging through Densities)
to identify radiogenomic associations. Imaging data is represented through
voxel intensity probability density functions of tumor sub-regions obtained
from multimodal magnetic resonance imaging, and genomic data through
molecular signatures in the form of pathway enrichment scores corresponding
*Corresponding authors {shariqm,ukarvind,veerab}@umich.edu
Keywords and phrases: Fisher-Rao metric, group spike-and-slab, principal component analysis, radiogenomic
associations.
1
arXiv:2104.00510v2  [stat.ME]  7 Apr 2021

2
S. MOHAMMED ET AL.
to their gene expression proﬁles. Employing a Riemannian-geometric frame-
work for principal component analysis on the set of probability densities
functions, we map each probability density to a vector of principal compo-
nent scores, which are then included as predictors in a Bayesian regression
model with the pathway enrichment scores as the response. Variable selec-
tion compatible with the grouping structure amongst the predictors induced
through the tumor sub-regions is carried out under a group spike-and-slab
prior. A Bayesian false discovery rate mechanism is then used to infer signif-
icant associations based on the posterior distribution of the regression coefﬁ-
cients. Our analyses reveal several pathways relevant to LGG etiology (such
as synaptic transmission, nerve impulse and neurotransmitter pathways), to
have signiﬁcant associations with the corresponding imaging-based predic-
tors.
1. Introduction
Gliomas are a group of tumors occurring in the brain and spinal cord,
further categorized into sub-groups. Lower grade gliomas (LGG) are characterized as World
Health Organization grade II and III tumors, and they come from two different types of
brain cells known as astrocytes and oligodendrocytes. The causes of these types of tumors
are not well understood, and recent studies have examined their molecular characterization
from datasets generated by The Cancer Genome Atlas (TCGA), and have associated disease
prognosis with their underlying molecular architecture (Verhaak et al., 2010). In the con-
text of gliomas, there has been growing interest in exploring the underlying comprehensive
molecular characterization (Noushmehr et al., 2010; Verhaak et al., 2014; Venneti and Huse,
2015; Fishbein et al., 2017). For example, Ceccarelli et al. (2016) studied the complete set of
genes associated with diffuse grade II-III-IV gliomas from TCGA, to identify molecular cor-
relations by comprehensively analyzing the sequencing and array-based molecular proﬁling
data, and to improve disease classiﬁcation and provide insights into the progression of the
tumor from low- to high-grade.
Gliomas usually contain various heterogeneous sub-regions: edema, non-enhancing and
enhancing core, which reﬂect differences in tumor biology, have variable histologic and ge-
nomic phenotypes, and exhibit highly variable clinical prognosis (Bakas et al., 2017a). This
intrinsic heterogeneity in tumor biology is also reﬂected in their radiographic phenotypes
through different intensity proﬁles of the sub-regions in imaging. Such phenotypes can be
obtained from images based on computed tomography (CT), positron emission tomography
(PET) and magnetic resonance imaging (MRI), each of which allows integration with other
data sources (e.g., genomics). Moreover, imaging and genomic data provide complementary
information in terms of tumor heterogeneity and molecular characterization, respectively.
Molecular classiﬁcation of LGGs can be facilitated, and sometimes even validated, through
radiogenomic analyses based on non-invasive medical image-derived features. Imaging fea-
tures have been known to capture physiological and morphological heterogeneity of tumors
as they progress from a single cell (Marusyk, Almendro and Polyak, 2012). Such studies
have an important bearing on the design of personalized therapeutic strategies in cancer, and
potentially guide monitoring of disease development or progression for early stage cancers.
Thus, examination of inter- and intra-tumor heterogeneity through imaging features, and their
potential association with genomic markers, can lead to a better understanding of molecular
signatures of LGGs.
In this work, we focus on the MRI modality as it furnishes a wide range of image con-
trasts at a high resolution, which can be used to exhibit and evaluate the location, growth
and progression of tumors. Moreover, improved resolution of MRIs has facilitated the under-
standing of different aspects of tumor characteristics (Just, 2014). The apparent utility of MRI
in studying heterogeneity of sub-regions of gliomas can be seen in Figures 2 and 3, where

RADIOHEAD: RADIOGENOMIC ANALYSIS THROUGH DENSITIES
3
different intensity proﬁles disseminated across the multimodal MRI scans appear to exhibit
complementary information. Studying heterogeneity in the sub-regions is now feasible due
to the availability of their gold standard labeling (Bakas et al., 2015), which facilitates further
radiomic and radiogenomic analyses.
1.1. Voxel Intensity Densities as an Imaging Feature
Using the raw MRI scans as predic-
tors in the modelling is a challenge as we do not have an underlying atlas structure to compare
between subjects that is commonly available for other imaging modalities such as neuro-
imaging studies (Ombao et al., 2016). Diagnostic image-based features using voxel-level
data have been utilized for modelling purposes (e.g. to visualize the progression/regression
of tumors). However, one of the main drawbacks of existing studies is that only a few chosen
summary statistics/metrics represent entire regions of interest. Some of these summary statis-
tics include percentiles, extreme percentiles (e.g. 5th and 95th), quartiles, skewness, kurtosis,
histographic pattern, range and mode of MRI-based voxel intensity histograms (Baek et al.,
2012; Just, 2011; Song et al., 2013). Although such metrics have clear utility in the assess-
ment of tumor heterogeneity, they generally do not provide a comprehensive representation
due to (a) the subjectivity in the choice of the number and location of summary features, and
(b) the limitation of these features in terms of capturing the entire information in a voxel
intensity distribution. As a result, any statistical analysis based on such an approach is unable
to detect potential small-scale and sensitive changes in the tumor due to treatment effects
(Just, 2014).
As an alternative to summary statistics, associations between genomic variables and tumor
heterogeneity can be examined on different scales of the voxel intensity probability density
function (PDF): while signiﬁcant genomic variation might manifest as markedly distinct as-
pects of a PDF (e.g., number of modes, large changes in location of mean/mode), genomic
variation (relative to the measurement scale) might show up in subtle, small-scale changes
in overall shape of the PDF (e.g. slopes between modes), and sometimes in the tails. Indi-
cations of such a behavior were evident in an unsupervised clustering setting in earlier work
that considered entire voxel intensity PDFs as data objects (Saha et al., 2016). Including such
small-scale changes without summarizing the entire PDF through coarse summary statistics
could result in better correlative and predictive power of models associating genomic vari-
ables to radiographic phenotypes (Yang et al., 2020).
In this article, we propose to examine variations in the genomic signature of a tumor
through changes, both large and subtle, in overall shape1 of the PDF of voxel intensities,
using a Riemannian-geometric framework on the space of PDFs. This space is a nonlinear,
inﬁnite-dimensional manifold, and the lack of a global linear structure brings about non-
trivial challenges in their analyses. Here, we develop a regression framework called RADIO-
HEAD (RADIOgenomic analysis incorporating tumor HEterogeneity in imAging through
Densities) to model associations between genomic variables characterizing the molecular
signature of tumors and voxel intensity PDFs from multimodal MRI scans. In what follows,
we use PDFs and densities interchangeably.
1.2. RADIOHEAD Modelling Outline
We propose an integrated end-to-end method:
from MR images to evaluation of voxel-level density-based radiomic features, gene expres-
sion to associated pathway-level enrichment, and subsequent statistical modelling frame-
work. Figure 1 shows the schematic workﬂow diagram for our method. For each patient,
we generate PDFs corresponding to three heterogeneous tumor sub-regions: (i) necrosis and
1‘shape’ is used in a non-technical sense

4
S. MOHAMMED ET AL.
+
Principal 
Component 
Scores
Principal 
Component 
Scores
Principal 
Component 
Scores
T1
+   T1Gd   +      T2      +  
Gene Expression
GSVA
…              …           
Pathway Score
NCR/NET
ED
ET
+
Principal 
Component 
Scores
Principal 
Component 
Scores
Principal 
Component 
Scores
FLAIR
NCR/NET
ED
ET
NCR/NET: Necrosis and non-enhancing tumor; ED: Edema; ET: Enhancing tumor;
RGF: Remannian-Geometric Framework; GSVA: Gene-Set Variation Analysis.
RGF
RGF
RGF
RGF
RGF
RGF
𝑦
𝑋1
𝑋2
𝑋3
𝑋10
𝑋11
𝑋12
𝑦= σ𝑔=1
12 𝑋𝑔𝛽𝑔+ 𝜖∶Bayesian variable selection on 𝛽𝑔
FIG 1. Schematic representation of the RADIOHEAD modelling approach. Pathway scores are constructed from
gene expression using gene-set variation analysis (GSVA). From each MRI sequence, we construct densities for
each of the three tumor sub-regions and use them to construct principal component scores under a Reimannian-
geometric framework. Pathway scores are used as a response and the principal component scores as predictors
in the downstream analysis.
non-enhancing, (ii) edema, and (iii) enhancing core. The expression/activation of the path-
ways is evaluated by computing pathway enrichment scores through gene-set variation anal-
ysis (GSVA); these scores are subsequently used as a univariate response variable. We apply
the proposed RADIOHEAD approach to the TCGA dataset of LGGs.
Fitting a model by regressing enrichment scores against multiple PDFs (one from each
combination of tumor sub-region and MRI sequence) poses two main challenges:
1. Each PDF is a non-negative function which integrates to one, and hence cannot be treated
as a standard functional predictor;
2. The grouping structure between tumor sub-regions needs to be incorporated while exam-
ining the functional relationship between a pathway score and its corresponding PDFs.
The ﬁrst challenge is addressed by mapping each PDF to a ﬁnite-dimensional vector of princi-
pal component (PC) scores by carrying out Riemannian principal component analysis (PCA)
on the sample of PDFs corresponding to each tumor sub-region. These PC scores correspond-
ing to the multiple PDFs act as imaging meta-features and are incorporated as individual pre-
dictors, which leads to a p ≫n situation wherein the number of radiomic meta-features (p) is
higher than the number of subjects (n). In the presence of uncertainty in the actual effects of
small changes in the PC scores on the enrichment scores, it is natural to employ a Bayesian
model for variable selection. To this end, we address the second challenge by using a group-
structured continuous spike-and-slab prior (Ishwaran and Rao, 2005; Andersen, Winther and
Hansen, 2014) on the total set of PC scores, in an effort to capture information on the biologi-
cal structure in the data, and to provide analyses that are more amenable to interpretation. The
prior formulation also simpliﬁes the computation by allowing for simple (conditional poste-
riors from standard distributions) and fast MCMC sampling (via Gibbs sampling). Other
existing prior formulations incorporating group structure (Zhang et al., 2014; Xu and Ghosh,
2015; Yang and Narisetty, 2018) could also be used. Furthermore, to address the issue of mul-
tiple comparisons, a Bayesian false discovery rate-based approach is used to build inference
based on error rates.

RADIOHEAD: RADIOGENOMIC ANALYSIS THROUGH DENSITIES
5
(a) T1
(b) T1Gd
(c) T2
(d) FLAIR
 NC
 ED
 ET
(e) Segmentation Mask
FIG 2. Figures (a)-(d): Axial slice of a skull-stripped brain MRI for a subject with LGG, shown for the four
sequences T1, T1Gd, T2 and FLAIR, respectively. The segmented tumor region is displayed using a red boundary
overlaid on the images. Figure (e): The corresponding sub-region segmentation mask with the NC, ED and ET
regions marked in different colors.
Section 2 describes the data along with the acquisition process and pre-processing steps.
We describe the algorithm to compute the density-based PC scores in Section 3.1; the com-
putation of GSVA-based enrichment scores is outlined in Section S2 of the supplementary
material. Section 3.2 describes the regression setup with densities as covariates. In Section
3.3, we describe the regression in terms of PC scores and the modelling approach based
on Bayesian variable selection using the group spike-and-slab prior. The estimation and in-
ference strategies follow in Sections 3.4 and 3.5. In Section 4, we present our results and
describe the identiﬁed radiogenomic associations in LGG. We close with a brief discussion
and some directions for future work in Section 5.
2. Dataset Description
We describe the data acquisition and pre-processing steps in-
volved for the imaging and genomic data separately.
2.1. Imaging Data
To conduct our analyses, we use MRI scans that include reliable tu-
mor segmentations along with identiﬁed tumor sub-regions. We consider pre-operative multi-
institutional scans in the TCGA LGG collection, publicly available in The Cancer Imaging
Archive (TCIA - Clark et al. (2013)). We obtain segmentation labels for these MRI scans
using an automated method called GLISTRboost (Bakas et al., 2015, 2017a). Segmentation
labels generate a mask for each subject’s MRI scan, which distinguishes between necrotic
and non-enhancing tumor (NCR/NET or NC), peritumoral edema (ED) and enhancing tumor
(ET).
MRI provides a wide range of imaging contrasts through multimodal images. The pri-
mary MRI sequences include (a) native (T1), (b) post-contrast T1-weighted (T1Gd), (c)
T2-weighted (T2), and (d) T2 ﬂuid attenuated inversion recovery (FLAIR). Each of these
sequences identiﬁes different types of tissue and displays them using varying contrasts based
on the tissue characteristics. We use LGG data for 65 subjects, obtained from Bakas et al.

6
S. MOHAMMED ET AL.
(2017b), which contain (a) MRI scans based on all four sequences (T1, T1Gd, T2 and
FLAIR), and (b) corresponding segmentation masks generated by GLISTRboost.
The structure of the data under study is as follows: each MRI scan is a three-dimensional
array with the third axis representing different axial slices. For each subject, we have four
sequences, as described above, corresponding to four different 3D arrays accompanied by a
unique segmentation mask that has a one-to-one correspondence with the voxels in the MRI
scans. That is, there is a voxel-to-voxel correspondence across all four MRI sequences and
the segmentation mask. An example of a single axial slice from a brain MRI for a subject
with LGG, for the four aforementioned sequences, is shown in the left panel in Figure 2. The
segmented tumor region is indicated by a red boundary overlaid on the images, and is further
classiﬁed into the tumor sub-regions NC, ED and ET, as shown in the right panel in Figure
2. The voxel intensity values of MRI scans are difﬁcult to interpret and compare as they are
sensitive to the conﬁguration of the MRI scanner. These values are not comparable either
between study visits within a single subject or across different subjects, which necessitates
pre-processing of the images in terms of intensity value normalization. We address this issue
through a biologically motivated normalization technique using the R package WhiteStripe
(Shinohara et al., 2014).
2.2. Genomic Data
The genomic data was obtained from LinkedOmics2 (Vasaikar et al.,
2017), which is a publicly available portal that includes multi-omics data for LGG among
many other cancer types. We consider the normalized gene-level RNA sequencing data from
the primary solid tumor tissue using the Illumina HiSeq system (high-throughput sequencing)
with expression values in log2 scale. The entire dataset contains gene expression data for 516
samples and 20086 genes; we consider a subset of 65 matched samples corresponding to
the imaging data described in Section 2.1. We consider the enriched pathways in LGG as
identiﬁed by Ceccarelli et al. (2016), hereafter referred to as C-Pathways.
We obtain the mapping from genes to pathways and use them along with the gene ex-
pression data to obtain pathway scores. These scores are numerical estimates of the relative
enrichment of a pathway of interest across a sample population using a non-parametric, unsu-
pervised method called GSVA. It estimates a value per sample and pathway for the variation
in the activity of a pathway within an entire gene expression set. In other words, it assesses
the relative variability of gene expression in the pathway as compared to expression of genes
not in the pathway. The computation details of the pathway scores can be found in Section
S2 of the supplementary material. For the C-Pathways (such as ion transport and synaptic
transmission) considered in this paper, the genes to pathway mappings are obtained from the
molecular signature database (Liberzon et al., 2011). For each gene-set within the collection,
we construct the pathway score using gene-set variation analysis (Hänzelmann, Castelo and
Guinney, 2013). Of the 22 C-Pathways, we only include 21 of them as the gene membership
for one of the pathways was not available. The pathway scores are computed using the GSVA
package in R obtained from Bioconductor (Gentleman et al., 2004). Summary statistics for
the pathway scores are shown in Table S1 of the supplementary material.
3. Statistical Framework
Our main goal is to identify associations between imaging
meta-features and gene expression-based pathway scores. In this section, we ﬁrst describe the
Riemannian-geometric approach to construct the voxel PDF-based PC scores for each subject
corresponding to a certain tumor sub-region. We also deﬁne a formal regression model based
on the group spike-and-slab prior as well as associated estimation and variable selection
procedures.
2www.linkedomics.org

RADIOHEAD: RADIOGENOMIC ANALYSIS THROUGH DENSITIES
7
3.1. Density-based Principal Component Scores
We use R to index tumor sub-regions
and M for the different MRI sequences. Consider MRI scans for n subjects from four se-
quences with the tumor masks containing the segmented tumor region and indicating the
sub-regions. For a given sequence M, we construct the kernel density estimate fM
i (R), i =
1,...,n for the tumor sub-region R in subject i based on the voxel intensity values in the
MRI scan at the array locations of region R obtained from the segmentation. Hence, for each
subject i and each sequence M, we have PDF estimates denoted by fM
i (NC), fM
i (ET) and
fM
i (ED) corresponding to the necrotic and non-enhancing tumor core (NC), the peritumoral
edema (ED) and the enhancing tumor (ET) sub-regions, respectively. Thus, we consider uni-
variate kernel-density estimates for all tumor sub-regions and all subjects across the four
imaging sequences. The density plots are displayed in Figure 3, where each row corresponds
to a speciﬁc imaging sequence while each column corresponds to a tumor sub-region. We
compute the PC scores for each sequence M separately. For brevity, we shall drop the se-
quence indicator M from the densities and use fiR instead of fM
i (R) for the remainder of
this section.
The kernel density estimates (fiR for all i = 1,...,n and R ∈T = {NC,ET,ED}) are
proper PDFs and belong to the Banach manifold of all PDFs. The following description fo-
cuses on PDFs with domain [0,1]; however, the methods apply to more general domains with
small adjustments. PDFs are elements of the space F =
n
f : [0,1] →R>0

R 1
0 f(x)dx = 1
o
.
To make F a Riemannian manifold, and to facilitate computation on this space, we endow it
with the Fisher-Rao (F-R) Riemannian metric (Rao, 1992; Kass and Vos, 2011; Srivastava,
Jermyn and Joshi, 2007). For brevity, we omit the speciﬁc formula for this metric and simply
mention that it is closely related to the Fisher information matrix and has useful statistical
properties, e.g., invariance to bijective and smooth transformations of the PDF domain (Cen-
cov, 1982). Unfortunately, the F-R metric is difﬁcult to use in practice as the computation of
geodesic paths and distances between PDFs is cumbersome and requires numerical methods
for approximation. Thus, for simpliﬁcation, we further transform the kernel density estimates
using a square-root transformation (Bhattacharyya, 1943; Kurtek and Bharath, 2015). As a
result, the space of PDFs becomes the positive orthant of the unit sphere in L2 := L2([0,1]),
the geometry of which is well-known, and the F-R metric ﬂattens to the standard L2 met-
ric enabling the computation of geodesic paths and distances in analytical form (Kurtek and
Bharath, 2015). Brieﬂy, this result provides simple tools for the statistical tasks of interest
including (a) deﬁnition of a distance between two densities, (b) computation of a Karcher
mean of a sample of densities, and (c) PCA of a sample of densities. We elaborate on these
procedures next.
3.1.0.1. Distances between PDFs and their Karcher Mean.
Let hiR = +√fiR denote the
(positive) square-root densities (SRDs) corresponding to the kernel density estimates fiR for
all i = 1,...,n and R ∈T . Each hiR is an element of H =
n
h : [0,1] →R>0

R 1
0 h2(x)dx =
1
o
, the positive orthant of a unit sphere in L2, i.e., H is the collection of SRDs corre-
sponding to all PDFs in F. Equipped with the standard L2 metric, H becomes a Rie-
mannian manifold (recall that the L2 metric on H corresponds to the F-R metric on F).
Under this setup, the geodesic distance between two densities f1,f2 ∈F, represented by
their SRDs h1,h2 ∈H, is deﬁned as the shortest great circle arc connecting them on H:
d(f1,f2) = d(h1,h2)L2 := cos−1(⟨h1,h2⟩) = cos−1(
R 1
0 h1(x)h2(x)dx) := θ. We can now
compute the mean of a sample of SRDs using a generalized version of a mean on a met-
ric space, called the Karcher mean (Karcher, 1977; Dryden and Mardia, 1998). The sam-
ple Karcher mean ¯h on H is deﬁned as the minimizer of the variance functional H ∋h 7→
Pn
i=1 d(h,hi)2
L2. An algorithm for computing the Karcher mean is given in Section S3 of

8
S. MOHAMMED ET AL.
−50
0
50
100
150
0
10
20
30
40
50
60
T1: NCR.NET
−50
0
50
100
150
0
10
20
30
40
50
60
T1: ED
−50
0
50
100
150
0
10
20
30
40
50
60
T1: ET
−50
0
50
100
150
200
0
10
20
30
40
50
T1GD: NCR.NET
−50
0
50
100
150
200
0
10
20
30
40
50
T1GD: ED
−50
0
50
100
150
200
0
10
20
30
40
50
T1GD: ET
−50
0
50
100
150
200
0
10
20
30
40
50
60
T2: NCR.NET
−50
0
50
100
150
200
0
10
20
30
40
50
60
T2: ED
−50
0
50
100
150
200
0
10
20
30
40
50
60
T2: ET
−50
0
50
100
150
200
0
10
20
30
40
50
60
FLAIR: NCR.NET
−50
0
50
100
150
200
0
10
20
30
40
50
60
FLAIR: ED
−50
0
50
100
150
200
0
10
20
30
40
50
60
FLAIR: ET
FIG 3. Kernel densities fM
i
(R) for all subjects across all four MRI sequences and three tumor sub-regions. For
visual convenience, the y-axes are truncated for each of the subplots. The x-axis shows the voxel-intensity values;
however, we transform them to [0,1] for each imaging sequence to compute the KDEs. Supplementary Figure S1
shows similar plots in color and supplementary Figure S2 shows similar plots without truncation of the y-axis.
the supplementary material; Figure S3 shows the Karcher mean of the densities across all
of the subjects for all tumor sub-regions and imaging sequences, overlaid within each sub-

RADIOHEAD: RADIOGENOMIC ANALYSIS THROUGH DENSITIES
9
plot. The computations require two tools from differential geometry called the exponential
and inverse-exponential maps. Let Th(H) =
n
δh|⟨δh,h⟩= 0
o
denote the tangent space at
h. For h ∈H and δh ∈Th(H), the exponential map at h, exp : Th(H) →H is deﬁned as
exph(δh) = cos(∥δh∥)h+sin(∥δh∥)δh/∥δh∥, where ∥δh∥=
qR 1
0 δh2(x)dx is the L2 norm
(Billioti and Mercuri, 2017). The inverse-exponential map is denoted by exp−1
h : H →Th(H)
and for any h1,h2 ∈H, it is deﬁned as, exp−1
h1 (h2) = θ[h2 −cos(θ)h1]/sin(θ), where
θ = d(h1,h2)L2 as before3.
3.1.0.2. Principal Component Analyses on a Sample of PDFs.
To perform PCA of a sample
of SRDs (equivalently PDFs), we utilize the linear tangent space at the sample Karcher mean
SRD. That is, we ﬁrst project all SRDs onto this tangent space using the inverse-exponential
map. The sample covariance matrix is then computed in the tangent space at the mean SRD,
and PCA is applied through singular value decomposition (SVD) of this matrix. In practice,
the densities and their corresponding SRDs are approximated using m-dimensional vectors,
which specify the functional values at a set of m discrete points on the domain [0,1] resulting
in m × m-dimensional covariance matrices, where m ≫n. We describe the above step-by-
step process in Algorithm 1.
Algorithm 1 PCA on T¯h(H)
1: Compute hiR from fiR (at m discrete points).
2: Compute the Karcher mean of hiR for each tumor sub-region R ∈T as ¯hR (see Section S3 in the supple-
mentary material).
3: Use the inverse-exponential map to compute viR = exp−1
¯hR(hiR) ∈T¯hR(H).
4: Evaluate the sample covariance matrix KR =
1
n−1
Pn
i=1 viRv⊤
iR ∈Rm×m for each R ∈T .
5: Compute the SVD of KR = URΣRU⊤
R .
The ﬁrst L columns of UR, denoted as ˜UR ∈Rm×L, span the L-dimensional principal
subspace of the given sample of densities. We can compute the principal coefﬁcients as
XR = VR ˜UR, where V ⊤
R = [v1R v2R ... vnR] ∈Rm×n for each R ∈T . These principal
coefﬁcients XM
R , referred to as PC scores, act as Euclidean coordinates corresponding to the
kernel density estimates fM
i (R) generated from each MRI sequence M, and will be used
as predictors in our model. This procedure accomplishes two major goals: (1) it estimates
orthogonal directions of variability in a sample of PDFs along with the amount of variability
explained by each direction via the covariance decomposition, and (2) it performs dimen-
sion reduction by effectively exploring variability in the sample of PDFs through the primary
modes of variation in the data.
3.2. Regression with Densities
The PDFs fM
i (R) are representations of the heterogene-
ity in the tumor voxels from the imaging sequence M and the tumore sub-region R for
subject i. To identify radiogenomic associations, we build regression models with PDFs
fM
i (R) ∀M,R as covariates. For ease of exposition, we drop the indices M and R, and
explicate the model for one density fi(t) for t ∈[0,1] for subject i as the covariate. Let hi(t)
3For the unit sphere in L2, strictly speaking, although the exponential map is well-deﬁned on the entire tangent
space (Billioti and Mercuri, 2017), the inverse-exponential map may not be. We eschew handling of this technical
detail since this is not an issue when computing using the map in practice.

10
S. MOHAMMED ET AL.
denote the corresponding SRD. If yi corresponds to the pathway score for subject i, hi can
be related to yi using the data-driven model
(1)
yi = β0 +
Z 1
0
exp−1
¯h
 hi(t)

β(t)dt + ϵi,
i = 1,...,n,
where ¯h ∈H is the Karcher mean of SRDs h1,...,hn ∈H. Here t 7→β(t) is the real-valued
coefﬁcient function, β0 is a real-valued intercept, and ϵi are i.i.d. N(0,σ2). We specify the
model on the tangent space at the data-dependent Karcher mean ¯h. That is, ¯h is the reference
SRD for the inverse-exponential map. While this choice inﬂuences the model speciﬁcation
(as ¯h changes with changing sample composition), it removes the arbitrariness associated
with choosing the reference SRD. Effectively, exp−1
¯h
 hi(t)

is the Riemannian-geometric
equivalent of ‘centering’ the functional covariate hi. The amount of dependence of the model
on ¯h is directly dependent on the variability of the sample h1,...,hn, which can be quantiﬁed
using the geodesic distances between hi and ¯h.
When it exists, the range of H ∋h 7→exp−1
¯h (h) is contained within a linear subspace of
L2, and we can thus express exp−1
¯h
 hi

= P
k αikφk for some sequence (αik, k ≥1) with
P
k |αik|2 < ∞, where {φk, k = 1,2,...} is an orthonormal set of basis functions for L2.
Similarly, we can write β = P
k βkφk for some sequence (βk, k ≥1) with P
k |βk|2 < ∞.
Hence, the model in Equation (1) reduces to
(2)
yi = β0 +
∞
X
k=1
αikβk + ϵi,
since ⟨φi,φj⟩= 1 if i = j, and 0 otherwise. For a given gene-set, we denote the pathway
scores as y = (y1,...,yn)⊤, where yi corresponds to the score for subject i. Having chosen
¯h, we truncate the number of basis functions at some positive integer rn < ∞. The model in
Equation (2) is then further simpliﬁed as
(3)
yn×1 = β01n + Aβ + ϵ,
where 1n ∈Rn is the vector with all entries as 1, row i of A ∈Rn×rn is given as
(αi1,...,αirn)⊤∈Rrn and β = (β1,...,βrn)⊤∈Rrn. Let A⊤A = PDP ⊤, where P ∈
Rrn×rn is an orthogonal matrix of eigenvectors of A⊤A and D is diagonal with λ1 ≥λ2 ≥
···λsn > 0 = λsn+1 = ···λrn. If every λk > 0 ∀k, then y is regressed on the principal com-
ponents of A, which is AP.
The model in Equation (3) depends on the choice of the orthonormal basis {φk} of L2,
or in other words the matrix A and its eigenvectors in P. We use a PC basis for two rea-
sons: (i) it is the optimal empirical orthogonal basis (see e.g., Chapter 6 of Ramsay and
Silverman (2005)) for data on L2, of which T¯h(H) is a linear subspace, and (ii) the map
exp−1
¯h
 hi

7→(αi1,αi2,...) is an isometry, and for a ﬁxed positive integer rn, the corre-
sponding full isometry group is O(rn) (the set of square orthogonal matrices in dimension
rn). From the perspective of (ii), choosing another orthornormal basis and truncating at rn
amounts to an orthogonal transform of the corresponding coefﬁcients. Thus, we are effec-
tively regressing the score yi of the ith subject on the ‘optimal’ rn-dimensional linear repre-
sentation of the SRD hi in the tangent space T¯h(H) of the sample Karcher mean ¯h.
The model in Equation (3) corresponds to one PDF as a covariate for each subject i.
However, from our imaging data, we have twelve PDFs, from four imaging sequences and
three tumor sub-regions, as covariates for each subject. Hence, the model in Equation (1) can
be extended as
(4)
yi = β0 +
X
M
X
R
Z 1
0
exp−1
¯hM
R
 hM
iR(t)

βR
M(t)dt + ϵi,

RADIOHEAD: RADIOGENOMIC ANALYSIS THROUGH DENSITIES
11
where hM
iR(t) is the SRD for the PDF fM
iR(t), and βR
M(t) is the coefﬁcient function corre-
sponding to the tumor sub-region R in imaging sequence M. Here ¯hM
R is the sample Karcher
mean of hM
1R(t),...,hM
nR(t). Each of the integrals in Equation (4) can be reduced to the PC
regression form in Equation (3). In Section 3.3, we directly work with the PC regression form
with the twelve groups of PCs as covariates.
3.3. Regression with PC Scores
The PDFs belong to a function space and they carry rich
information of the voxel density of different tumor sub-regions at different scales. As a con-
sequence, they also result in a large number (greater than the number of subjects) of principal
components across sequences and tumor sub-regions. This p ≫n situation necessitates the
use of variable selection approaches that can induce sparsity as well as regularization. As
the PC scores are surrogates for the entire density, it is natural to model the aspects of the
density not captured through the scores (such as information on the tumor sub-regions) using
a Bayesian approach by appropriately placing a prior on the high-dimensional feature space.
Consequently, this allows us to construct and assess posterior distributions of coefﬁcients for
inference.
Our goal is to identify the density-based principal components across tumor sub-regions
that are signiﬁcantly associated with the expression levels in the gene-set considered. We ad-
dress this problem from a Bayesian perspective and use the continuous spike-and-slab prior
(George and McCulloch, 1997; Ishwaran and Rao, 2005), which has inherent variable selec-
tion properties. We model the pathway scores y using principal component scores obtained
from all of the tumor sub-regions and MRI sequences as the predictors. In other words, we
assume
(5)
y = Xβ + ϵ with ϵ ∼N(0,σ2I),
where
X =
h
XT1
NC XT1
ED XT1
ET XT1Gd
NC
XT1Gd
ED
XT1Gd
ET
XT2
NC XT2
ED XT2
ET XFLAIR
NC
XFLAIR
ED
XFLAIR
ET
i
corresponds to the n × L matrix of predictors containing the principal component scores.
The normality assumption is reasonable here since the pathway scores are unimodal and ap-
proximately normal by construction (Hänzelmann, Castelo and Guinney, 2013). The model
can also be adapted to categorical or survival response types by incorporating latent variable
approaches. Here, L is deﬁned as the total number of principal components considered across
all sequences and tumor sub-regions: L = P
M
P
R LM
R , where LM
R corresponds to the num-
ber of columns in XM
R for R ∈T and M belongs to the four different sequences. We choose
LM
R based on a threshold for the total variation explained by the chosen number of principal
components. In the coefﬁcient vector β ∈RL, each component is the coefﬁcient correspond-
ing to the principal component from each tumor sub-region R and each MRI sequence M;
σ2 is the variance parameter.
3.3.0.1. Group Spike-and-Slab Prior:
Our aim is to identify the tumor sub-regions in a
speciﬁc sequence (through the principal components) inﬂuencing the pathway scores. This
translates to identifying the nonzero coefﬁcients of the model in Equation (5). However, the
PC scores within each XM
R contain rich information about the small-scale variability in the
densities for region R in sequence type M. The number of principal components to include is
dictated by the cumulative amount of variability explained by them. As these densities belong
to a function space, capturing variability requires including a large number of PC scores.
Moreover, each of these principal components captures different aspects of the variability

12
S. MOHAMMED ET AL.
for the same group, i.e., (M,R) pair, and hence they will need to be evaluated as a group.
Incorporating this grouping structure into the modelling framework, we rewrite the model in
Equation (5) as
(6)
y ∼N
 G
X
g=1
Xgβg,σ2In
!
,
where G = 4 × 3, as we have 12 groups arising from four MRI sequences and three tumor
sub-regions. Here, βg = (βg1,...,βgLg)⊤, where Lg is the number of principal components
included for the g-th group of covariates Xg. Note that our covariates have a clear grouping
structure, where each group corresponds to the principal components of a tumor sub-region
within an imaging sequence. We now introduce a group spike-and-slab prior onto the coefﬁ-
cients βg to identify the groups Xg inﬂuencing the pathway scores. Consider the following
prior structure
βgk
ind
∼N(0,σ2ζgν2
gk),
ζg
iid
∼(1 −w)δv0(ζg) + wδ1(ζg),
w ∼U(0,1),
(7)
ν−2
gk
iid
∼Gamma(a1,a2),
σ−2 ∼Gamma(b1,b2),
where ζgν2
gk is the hypervariance of βgk with ζg acting as the group-level indicator variable
taking values 1 or v0 (a small number > 0) with probability w or 1−w, respectively. If ζg = 1,
the hypervariance is dictated by the Inverse-Gamma prior on ν2
gk; if ζg = v0, the prior on βgk
is concentrated at 0 allowing for shrinkage of the coefﬁcient parameter βgk. The choice of
hyperparameters a1 and a2 should be such that we have a continuous bimodal prior on βgk.
Further, w acts as the complexity parameter, indicating the proportion of groups with nonzero
coefﬁcients, and has a continuous uniform prior on (0,1). We consider an Inverse-Gamma
prior on the variance parameter σ2. Note that the group structure is incorporated into the
variable selection through the indicator ζg, which impacts the variance of the parameter βgk.
That is, if a speciﬁc group is not selected, the hypervariance for the coefﬁcients corresponding
to all columns in Xg is small, leading to the prior on βgk being concentrated at zero, and vice-
versa.
3.4. Estimation
For the model in Equation (6), and the group spike-and-slab prior struc-
ture in Equation (7), the full posterior distribution is provided in Section S4 of the supple-
mentary material. Let us deﬁne Γg = diag(γg1,...,γgLg) and Γ = block-diag(Γ1,...,ΓG),
where γgk = ζgν2
gk. The conditional posteriors for all of the parameters arise from standard
distributions, and hence, we can use Markov Chain Monte Carlo (MCMC) sampling proce-
dures such as Gibbs sampling. Details of the Gibbs sampling approach along with the condi-
tional posteriors for the parameters βg,ζg,ν−2
gk ,w and σ−2 are given in Algorithm 2. Since
we are modelling data from each gene-set separately, the estimation can be run in parallel
across all pathways making the analysis computationally feasible.
3.5. False Discovery Rate-based Variable Selection
The MCMC samples explore the
distribution of the coefﬁcients corresponding to the principal components of each of the sub-
groups as guided by the data. There are different ways of summarizing the information from
these MCMC samples. We could use the posterior mode (maximum a-posteriori or MAP

RADIOHEAD: RADIOGENOMIC ANALYSIS THROUGH DENSITIES
13
Algorithm 2 Gibbs Sampling for Estimation
1: for T iterations do
2:
Sample βg from βg|ζg,ν−2
gk ,σ−2 ∼N(ΣX⊤y,σ2Σ), where Σ = (X⊤X + Γ−1)−1.
3:
Sample ζg from ζg|βgk,ν2
gk,w,σ−2 ∼
w1g
w1g+w2g δv0(.) +
w2g
w1g+w2g δ1(.), where
w1g = (1 −w)v−Lg
2
0
exp

−
Lg
X
k=1
β2
gk
2σ2v0ν2
gk

and w2g = w exp

−
Lg
X
k=1
β2
gk
2σ2ν2
gk

.
4:
Sample ν−2
gk from ν−2
gk |βgk,ζg,σ−2 ind
∼Gamma

a1 + 1
2,a2 +
β2
gk
2σ2ζg

.
5:
Sample w from w|ζg ind
∼Beta(1 + #{ζg = 1},1 + #{ζg = v0}).
6:
Sample σ−2 from
σ−2|βg,ζg,ν−2
gk
ind
∼Gamma

b1 +
n + PG
g=1 Lg
2
,b2 + 1
2

(y −Xβ)⊤(y −Xβ) + β⊤Γ−1β

.
estimate) of the coefﬁcients βgk and conduct conditional inference based on these point es-
timates. While this approach provides interpretable point estimates, it does not yield exact
zero values as estimates for the coefﬁcients corresponding to principal components not asso-
ciated with the response; it also does not make use of the complete posterior samples. We use
Bayesian model averaging (Hoeting et al., 1999), which builds inference based on various
conﬁgurations visited by the MCMC sampler. This approach adequately accounts for the un-
certainty in the data, and allows for variable selection through downstream inference based
on error rates. In this paper, we use a multiplicity-adjusted inference for regression on each
pathway separately, since in each of these regressions we are trying to infer from the esti-
mates of βgk if they are zero or not. The variable selection also contributes to the multiplicity
correction by inducing sparsity. In our discussion, we present results of the false discov-
ery rate (FDR)-based variable selection approach using Bayesian model averaging combined
with the MAP estimates.
From the model in Equation (6), for each βgk, we obtain S samples β(1)
gk ,...,β(S)
gk from
the posterior distribution. For any given threshold c > 0, we can empirically compute pgk =
1
S
PS
s=1 I(|β(s)
gk | ≤c), which can be interpreted as the local FDR (Morris et al., 2008); then,
(1−pgk) is the probability that the principal component k from group g signiﬁcantly impacts
the pathway score. Owing to the inherent variable selection property of the group spike-and-
slab prior in Equation (7), for some g and k it is almost certain that the corresponding βgk is
close to zero. The value of pgk for such a βgk is large, and it is almost certain that including
such a nonzero coefﬁcient is an inferential error. We also expect some of the coefﬁcients to
have moderate values for pgk. Furthermore, we expect to have some coefﬁcients βgk such
that the corresponding pgk are close to zero and they almost certainly inﬂuence the pathway
score.
Based on this discussion, we assume that the principal component k from group g will be
included in the estimation as a signiﬁcant coefﬁcient if pgk < φ. Note that pgk is a Bayesian
q-value or an estimate of the local FDR (Storey, 2003). This threshold φ can be determined
based on different criteria such as Bayesian utility considerations (Müller et al., 2004), or by
controlling false-positive/false-negative errors, or the average Bayesian FDR. We determine
a threshold φα, which controls the overall average FDR at some level α, so that we expect
only 100α% of the elements of the set {(g,k)|pgk < φα} to actually be false-positive inclu-
sions in terms of associations with the pathway scores. To compute the threshold φα, we sort
the posterior inclusion probabilities pgk across all principal components k = 1,...,Lg and
groups g = 1,...,G, and denote the sorted probabilities as p(l) for l = 1,...,L = PG
g=1 Lg.

14
S. MOHAMMED ET AL.
We then compute φα = p(u), where u = max{l∗| 1
l∗
Pl∗
l=1 p(l) ≤α}. The set of principal com-
ponents k from group g with pgk < φα, that is, {(g,k)|pgk < φα}, can then be claimed to be
signiﬁcantly associated with the pathway score based on an average Bayesian FDR of α.
In summary, we start with the MRI scans for each patient and identify the three tumor
sub-regions. Based on these sub-regions, we construct imaging-based meta-features through
PCA on the space of voxel intensity PDFs using a Riemannian-geometric framework. The
resulting PC scores are used as predictors in a regression model with the pathway score as
a response. The pathway scores act as genomic markers capturing the enrichment activity in
a gene-set. We then use a group structured spike-and-slab prior, which captures the natural
grouping of the principal components arising from various tumor sub-regions to identify ra-
diogenomic associations. We use Gibbs sampling for estimation and an FDR-based criterion
for variable selection. The complete approach is outlined in Algorithm S1 in Section S1 of
the supplementary material.
4. Radiogenomic Analyses of Lower Grade Gliomas
We consider the imaging and
matched genomic data described in Sections 2.1 and 2.2, respectively, which comprises 65
samples. However, four of the 65 samples do not posses segmentation labels for all three
tumor sub-regions and hence are dropped from the analysis, resulting in a ﬁnal sample size
of 61. For each patient, we have G = 12 groups arising from four MRI sequences (T1, T1Gd,
T2 and FLAIR) and three tumor sub-regions (NC, ED and ET). First, the density estimates
are obtained using the ksdensity function in MATLAB software, which uses an optimal value
for estimating normal densities using Silverman’s rule as the default bandwidth (Silverman,
1986). We present a sensitivity analysis to assess the differences in the density estimates
based on the choice of bandwidth in Section S11 of the supplementary material. The results
indicate reasonable consistency in the computed density estimates. We then compute the PC
scores for these 61 subjects for each of the 12 groups. The number of principal components
included within each group is decided such that the included principal components cumu-
latively explain 99.99% of the total variance. For each of the four imaging sequences, we
display the cumulative percentage of variance explained by the principal components in sup-
plementary Figure S4. Note that this cut-off of 99.99% results in choosing a different number
of principal components across each group g. Although the choice of this cut-off could in-
clude a large number of PCs, any overﬁtting concerns are addressed by regularization via
the spike-and-slab prior that incorporates explicit shrinkage on the regression coefﬁcients
(Morris and Carroll, 2006; Scheipl, Fahrmeir and Kneib, 2012). We include a total of 143
covariates across all of the 12 groups for the LGG data. We discuss results of a sensitivity
analysis to assess the effect of sample composition on the computation of PC bases in Sec-
tion S10 of the supplementary material. We consider only the C-Pathways (Ceccarelli et al.,
2016), and the corresponding pathway scores are computed for the 61 subjects as described in
Section S2 of the supplementary material. We provide an R package, RADIOHEAD4, which
includes all relevant code, including the data under consideration, i.e., the pathway scores
corresponding to C-Pathways and PC scores along with their grouping labels for the 61 LGG
subjects.
4.0.0.1. Prior Elicitation and MCMC Settings:
In our model, we have shape (a1,b1) and
rate (a2,b2) hyper-parameters corresponding to σ2 and ν2
gk in Equation (7). We choose
these hyper-parameters so as to have non-informative/vague priors with a1 = a2 = 0.001
and b1 = b2 = 0.001: the mean is 1 with a large variance. The other hyper-parameter is v0,
one of the two possible values of the indicator ζg. We choose v0 = 0.005 to be close to zero,
4www.github.com/bayesrx/RADIOHEAD

RADIOHEAD: RADIOGENOMIC ANALYSIS THROUGH DENSITIES
15
+
+
+
+
+
+
+
+
−
−
−
−
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
−
−
−
+
−
−
+
−
+
+
+
+
+
+
+
+
+
+
−
−
−
+
+
+
+
+
+
+
+
−
−
−
−
−
−
−
−
−
−
−
−
−
−
−
−
−
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
−
−
−
−
−
−
−
−
−
−
−
−
−
−
−
−
−
−
−
−
−
−
−
−
−
−
−
+
+
+
+
+
+
+
+
+
+
+
−
−
−
−
−
−
−
−
−
−
−
−
−
SYNAPTIC_TRANSMISSION
TRANSMISSION_OF_NERVE_IMPULSE
MONOVALENT_INORGANIC_CATION_TRANSPORT
NEUROLOGICAL_SYSTEM_PROCESS
REGULATION_OF_NEUROTRANSMITTER_LEVELS
POTASSIUM_ION_TRANSPORT
ION_TRANSPORT
CELL_CELL_SIGNALING
SYSTEM_PROCESS
BEHAVIOR
CATION_TRANSPORT
GLUTAMATE_SIGNALING_PATHWAY
GPCR_PROTEIN_SIGNALING_PATHWAY
EXOCYTOSIS
DIGESTION
ANION_TRANSPORT
CNS_DEVELOPMENT
NERVOUS_SYSTEM_DEVELOPMENT
PROTEIN_AUTOPROCESSING
T1_NCR.NET.3
T1_NCR.NET.4
T1_NCR.NET.9
T1_ET.1
T1_ET.2
T1_ET.3
T1_ET.12
T1Gd_ED.1
T1Gd_ED.5
T1Gd_ED.7
T1Gd_ET.4
T1Gd_ET.6
T2_NCR.NET.9
T2_NCR.NET.11
T2_NCR.NET.15
T2_NCR.NET.16
T2_ED.1
T2_ED.6
T2_ET.2
T2_ET.10
FLAIR_NCR.NET.10
FLAIR_ED.12
FLAIR_ED.13
FLAIR_ET.6
FLAIR_ET.9
FLAIR_ET.16
FLAIR_ET.17
0.00
0.05
0.10
0.15
0.20
0.25
value
FIG 4. Posterior estimates of βgk, after FDR-based variable selection, corresponding to different PC scores
across MRI sequences and tumor sub-regions. Each row corresponds to a pathway from the C-Pathways. The
average Bayesian FDR is controlled at the level α = 0.05. Values on the gray-scale indicate the magnitude of
ˆβgk and the overlaid symbol (+/-) indicates its sign. The size of the symbol is proportional to the magnitude of
ˆβgk. Lack of a symbol denotes a zero estimate indicating no signiﬁcant association.
which generates continuous bimodal priors for βgk. We perform a sensitivity analysis based
on different values for v0. These results are included in Section S9 of the supplementary ma-
terial. We run the MCMC chain for 105 iterations and discard the ﬁrst 20,000 samples as
burn-in. The ﬁnal estimates are based on MCMC samples with a thinning of 125 iterations to
reduce auto-correlation. In supplementary Figures S9 and S10, we show the posterior densi-
ties and trace plots corresponding to randomly chosen βgks for the transmission of the nerve
impulse pathway showing good convergence of the parameters. In supplementary Figure S11,
we present boxplots for the potential scale reduction factors (Gelman and Rubin, 1992) com-
puted based on the MCMC samples of βgk from seven different chains. This plot indicates
convergence of the MCMC samples across multiple chains.
The results from the regression of these pathway scores on the imaging predictors through
the corresponding PC scores are shown in Figure 4. We display only the gene-sets that have
at least one signiﬁcantly associated covariate among all of the gene-sets in the C-Pathways.
Hence, any pathway not shown indicates no signiﬁcant association between that pathway
and the imaging predictors. Similarly, any principal components for any of the 12 groups not
listed in this ﬁgure are not signiﬁcantly associated with any of the C-Pathways. Each cell in
Figure 4 represents the magnitude of the estimated (MAP) coefﬁcients ˆβgk and the overlaid
symbol denotes its sign; the signiﬁcantly associated PCs are determined using FDR-based
variable selection on the MCMC samples as described in Section 3.5. For example, we see

16
S. MOHAMMED ET AL.
that the scores of the ﬁrst principal component of enhancing tumor (T1_ET.1) sub-region
have a signiﬁcant association with the transmission of nerve impulse gene-set. The average
Bayesian FDR is controlled at the level α = 0.05; we use a threshold c = 0.001 to compute
the values for pgk across all of the pathway score regressions. The value of c is chosen such
that it is comparable to the bandwidth used to compute the kernel density estimates, which in
turn is essential in computing the MAP estimate from the MCMC chain. Diagnostics for the
linear model in Equation 6 reveal no obvious violations of modelling assumptions (Figures
S5-S8 in the supplementary material).
4.0.0.2. Effect of Sample Composition:
As the computation of the pathway scores can be
sensitive to the samples in the patient cohort, the associations identiﬁed by our model are
dependent on the sample composition. A visual illustration of the distribution of the pathway
scores (using violin plots) is provided in the supplementary Figures S12-S18. To address this
issue, we calibrate the results from our model by computing the pathway scores correspond-
ing to the 61 subjects in three different scenarios. For the calibration, we include genomic
data from TCGA for additional glioma patients (including glioblastoma multiforme (GBM)).
The three scenarios include computing the pathway scores with (a) the 61 LGG subjects, (b)
516 LGG subjects, and (c) 516 LGG and 153 GBM subjects. We build the model in Equa-
tion (6) for all three cases, and carry out the estimation and inference as described in Section
3. The results presented earlier in Figure 4 correspond to the ﬁrst case, where the pathway
scores were computed with the n = 61 LGG subjects only. However, in supplementary Fig-
ures S19-S21, we present plots for the estimated coefﬁcients (rows and columns are matched
in these plots) when the pathway scores are computed as described in cases (a)-(c), respec-
tively. These plots are summarized in Figure 5, with pairwise scatterplots of the estimated
coefﬁcients from the three different cases; e.g., the top-right plot in Figure 5 corresponds
to the scatterplot of estimated coefﬁcients when the pathway scores were computed with 61
LGG subjects versus all 669 glioma subjects (LGG+GBM). The triangles indicate coefﬁ-
cients that are selected as signiﬁcantly associated in both cases, whereas the circles indicate
coefﬁcients that were not selected in one of the two cases. From Figure 5, we see that across
all three pairwise comparisons, we estimate many coefﬁcients to be similar (as indicated by
the solid line y = x).
4.0.0.3. Biological Associations:
We now focus on those pathways and coefﬁcients whose
estimates are consistent across all three cases (within a deviation of ±0.1); these coefﬁcients
are the triangles lying within the dotted lines parallel to y = x in Figure 5. We plot these
estimated coefﬁcients across the three cases in Figure 6. These plots include pathways related
to synaptic transmission, ion transport, glutamate signaling, G protein receptor signaling,
exocytosis, nervous system development and protein autoprocessing. Here, we focus on two
major ﬁndings in terms of the magnitudes of the different associations:
1. The transmission of nerve impulse pathway is associated with the enhancing tumor region
from the T1 and FLAIR imaging sequences. The region enhanced in both of the sequences
could potentially indicate demyelination due to glioma invasion, which could in turn lead
to disruption in transmission of nerve impulses. This association between the metabolic
activity and the inﬁltrating tumor region is identiﬁed by our model. It is also known that
neuronal activity promotes glioma growth (Venkatesh et al., 2015), which is supported
by the associations of the transmission of nerve impulse pathway with these imaging
predictors.
2. The association of glutamate signaling pathway with the enhancing tumor region from the
FLAIR sequence and the necrotic and non-enhancing region from the T1 sequence high-
lights metabolic activity related to the inﬁltration of the tumor. In the mammalian central

RADIOHEAD: RADIOGENOMIC ANALYSIS THROUGH DENSITIES
17
−0.2
−0.1
0.0
0.1
0.2
−0.2
0.0
0.1
0.2
LGG (n=61)
−0.2
−0.1
0.0
0.1
0.2
GGG
GGGGGGG
G
G
G
G
GGGGGG
GGGG
G
GGG
G
GGGGG
G
GGGGG
G
GG
G
GG
GGGG
G
G
GGGG
G
GG
G
GGG
GG
GG
GG
G
G
GGGGGGGGGGG
G
G
G
GG
G
GGGGGGG
G
G
G
G
G
GG
G
G
G
GG
GGG
GG
G
G
GGGGGGG
G
GGGGGGGG
G
G
GGGGGGGGGGGGGGGGGG
G
G
G
GG
G
GGG
G
G
G
G
G
GGG
G
G
GGGGGGGGGGGGGGGG
GG
G
GG
G
G
GGGGGG
G
G
G
GG
GG
G
GGGG
GGG
GGGG
LGG (n=516)
−0.2
−0.1
0.0
0.1
0.2
−0.2
0.0
0.1
0.2
GGGGG
GGGGGGGGG
G
GG
G
G
G
G
GGGGG
G
G
GGGGGG
G
GGGGGGGGGG
G
G
G
GG
G
GG
GGGGG
GG
GG
GG
G
G
GG
G
G
GGGGGGGGGGG
G
G
G
GG
G
GGGGGGG
G
GG
G
G
G
G
GG
G
GGG
G
G
GG
GGG
GG
GG
G
G
GGGGGG
G
GGGGGGGGGGGGG
GGGGGGG
G
GGG
G
GGGG
G
G
G
G
GG
GG
GG
GG
G
GGGGGGGGGGGGGGG
GG
G
GG
G
GGGGG
G
GGGG
G
GGGGGGGGGGG
G
G
G
GG
GG
G
GG
G
GG
GG
GG
GGGGGG
GGGG
G
G
GG
G
G
GGGGGG
−0.2
0.0
0.1
0.2
GGGGGGGG
G
G
G
GGGG
GGG
GG
G
GGG
G
GG
GGGGGG
GGGGGG
G
GGG
G
G
G
GG
GGGG
G
G
GGGG
G
G
GGG
G
G
GG
G
G
G
G
G
G
G
GGGGGGG
GGGGG
GG
G GGGG
GG
GG
GG
G
G
G
G
G
G
GG
G
G
GG
G
G
G
G
GGG
G
G
GG
GG
GG
GG
G
G
GG
G
G
G
GG
G
GG
G
GGGGGGGGGGG
G
GGGG
GGG
G
G
G
GGG
G
GG
G
GG
GG
GG
GGGGGG
GGGG
G
G
G
G
G
G
G
GGGG
−0.2
−0.1
0.0
0.1
0.2
−0.2
0.0
0.1
0.2
LGG+GBM (n=669)
G No strong association in one case
Strong association in both cases
FIG 5. Scatterplots of the estimated coefﬁcients when the pathway scores are constructed using (a) 61 LGG
subjects for which imaging data was available, (b) 516 LGG subjects from TCGA, and (c) 516 LGG and 153
GBM subjects from TCGA.
nervous system (CNS), glutamate is a major excitatory neurotransmitter, and experimen-
tal evidence suggests that glutamate receptor antagonists may limit tumor growth (Brocke
et al., 2010).
The aforementioned associations indicate that a deeper validation of these phenotypes is
essential to better understand tumor etiology, which may illuminate more speciﬁc nuances.
Accordingly, we list some of our other ﬁndings:
1. Ion channels are important regulators in cell proliferation, migration and apoptosis, and
play an important role in the pathology of glioma. Biological processes can be disrupted,
or cancer progression can be inﬂuenced, by malfunction and/or aberrant expression of ion
channels (Wang et al., 2015). Our model identiﬁes these connections via associations of
the imaging predictors with ion transport pathways such as potassium ion transport, cell
signaling, behavior and anion transport.
2. G protein-coupled receptor (GPCR) signaling affects tumor growth, metastasis and angio-
genesis (Cherry and Stella, 2014). Our model identiﬁes this association with the pathway
score for GPCR protein signaling.
3. The inhibition of lysosome exocytosis from glioma cells is known to play an important
modulatory role in their migration and invasion (Liu, Zhou and Zhu, 2012). Such inﬂu-
ences are identiﬁed through the radiogenomic association with the exocytosis pathway.
5. Discussion
In this paper, we propose a statistical framework for integrating multi-
modal data from both radiological images and genomic proﬁles. This model aims to identify
underlying radiogenomic associations, that is, associations between the radiological charac-
teristics extracted from MRI images and molecular underpinnings encoded in gene expres-
sion data. Toward this end, from the transcriptomic proﬁling data, we have constructed path-
way scores corresponding to those pathways that are known to have inﬂuence speciﬁcally in
LGGs; from the radiological imaging data, we have constructed meta-features based on voxel

18
S. MOHAMMED ET AL.
+
+
+
+
+
+
+
−
+
−
+
−
+
−
+
−
+
−
+
+
−
+
+
−
+
+
−
+
−
−
+
−
−
+
−
−
+
+
−
−
+
+
−
−
+
+
−
−
+
+
+
−
+
−
+
+
+
−
+
−
+
+
+
−
+
−
+
+
+
−
+
−
+
+
+
−
+
−
+
+
+
−
+
−
+
+
+
−
+
−
+
+
+
−
+
−
+
+
+
−
+
−
+
+
+
−
−
−
+
+
+
−
−
−
+
+
+
−
−
−
+
−
+
−
+
−
+
+
+
+
+
+
+
+
+
+
+
+
+
−
+
+
−
+
+
−
+
NERVOUS_SYSTEM_DEVELOPMENT
PROTEIN_AUTOPROCESSING
ANION_TRANSPORT
CNS_DEVELOPMENT
EXOCYTOSIS
DIGESTION
GLUTAMATE_SIGNALING_PATHWAY
GPCR_PROTEIN_SIGNALING_PATHWAY
CELL_CELL_SIGNALING
BEHAVIOR
TRANSMISSION_OF_NERVE_IMPULSE
POTASSIUM_ION_TRANSPORT
LGG(n=61)
LGG(n=516) LGG+GBM(n=669)
LGG(n=61)
LGG(n=516) LGG+GBM(n=669)
LGG(n=61)
LGG(n=516) LGG+GBM(n=669)
LGG(n=61)
LGG(n=516) LGG+GBM(n=669)
LGG(n=61)
LGG(n=516) LGG+GBM(n=669)
LGG(n=61)
LGG(n=516) LGG+GBM(n=669)
LGG(n=61)
LGG(n=516) LGG+GBM(n=669)
LGG(n=61)
LGG(n=516) LGG+GBM(n=669)
LGG(n=61)
LGG(n=516) LGG+GBM(n=669)
LGG(n=61)
LGG(n=516) LGG+GBM(n=669)
LGG(n=61)
LGG(n=516) LGG+GBM(n=669)
LGG(n=61)
LGG(n=516) LGG+GBM(n=669)
T1_ET.3
T1_ET.12
FLAIR_ED.12
FLAIR_ET.6
FLAIR_ET.16
FLAIR_ET.17
T1_NCR.NET.3
T1_ET.12
FLAIR_ED.12
FLAIR_ET.6
FLAIR_ET.16
FLAIR_ET.17
T1_ET.1
T1_ET.2
T1_ET.3
T1Gd_ED.7
FLAIR_ET.6
FLAIR_ET.17
T2_ET.10
FLAIR_ET.6
T1_ET.12
T1Gd_ET.6
FLAIR_ED.12
FLAIR_ET.16
T1Gd_ET.6
T2_NCR.NET.16
FLAIR_ET.9
T1_ET.1
FLAIR_ET.16
FLAIR_ED.12
FLAIR_ET.6
FLAIR_ET.16
FLAIR_ET.17
T1_NCR.NET.3
FLAIR_ET.16
FLAIR_ET.17
T1_ET.2
T1Gd_ED.7
FLAIR_ET.6
T1_ET.2
T1_ET.3
FLAIR_ET.6
FLAIR_ET.17
T1_NCR.NET.3
T1_ET.12
FLAIR_ED.12
FLAIR_ET.6
FLAIR_ET.16
FLAIR_ET.17
0.00
0.05
0.10
0.15
0.20
0.25
value
FIG 6. Posterior estimates of βgk, after FDR-based variable selection, corresponding to different PC scores
across MRI sequences and tumor sub-regions. Each panel corresponds to a pathway from the C-Pathways. Each
column within the panel corresponds to the sample composition used for calibration to compute the pathway
scores. The color on the gray-scale indicates the magnitude of ˆβgk and the overlaid symbol (+/-) indicates its
sign. The size of the symbol is proportional to the magnitude of ˆβgk.
intensities of tumor sub-regions through PDF-based approaches, which effectively capture tu-
mor heterogeneity. These meta-features, constructed from multiple MR sequences, are then
used as covariates in a model with pathway scores as responses. We use a Bayesian variable
selection strategy by employing a continuous spike-and-slab prior with a grouping structure,
which accounts for the inherent grouping in the imaging meta-features. This approach identi-
ﬁes many underlying associations between gene pathway activations and image-based tumor
characteristics.

RADIOHEAD: RADIOGENOMIC ANALYSIS THROUGH DENSITIES
19
We note that, although we incorporate the grouping structure in the RADIOHEAD frame-
work, we are not (explicitly) interested in the associations with the entire PDF. That is, our
inference is not based only on groups where ˆβgk ̸= 0 for all k in a given group g. Instead,
our focus is to identify associations with any aspect of the PDFs. The imaging meta-features
(PC scores) facilitate evaluation of any underlying associations of the genomic markers with
various aspects of the PDFs. Furthermore, inference on the group-level indicator is not feasi-
ble in our model setup as ζg is not identiﬁable. Such an inference is inferior in performance
under cases with high within-group sparsity, even under a model which has identiﬁability of
the group-level indicator (Yang and Narisetty, 2018). We demonstrate this using a simulation
study described in Section S8 of the supplementary material.
5.0.0.1. Utility in using densities:
Data integration from multiple modalities comes with
computational and modelling challenges. For the imaging data, MRIs facilitate the charac-
terization of tumor sub-regions and are obtained from four different sequences. The tumor
sub-regions are represented as voxel intensity values, and standard analyses utilize sum-
maries from the histograms of these voxel intensity values. As an improved alternative, we
have used the complete information from the voxel intensities though smoothed histograms
(kernel density estimates). Next, we show the beneﬁts of this more comprehensive repre-
sentation by considering seven different cases as potential predictors: (a) mean, (b) mean,
ﬁrst and third quartiles (Q1 and Q3), (c) ﬁve-number summary, (d) mean, standard devia-
tion, skewness and kurtosis, (e) deciles, (f) 15 equally spaced percentiles, and (g) 20 equally
spaced percentiles. The summary statistics are computed across all of the 12 groups sepa-
rately. In each of these seven cases, we employ the RADIOHEAD pipeline which uses the
group spike-and-slab prior and FDR-based variable selection to identify associations. The
issue of multicollinearity within the predictors is handled by the shrinkage properties of the
spike-and-slab prior. These seven cases include scenarios where the number of predictors
is higher/lower compared to the 143 predictors across groups from the PC scores. The re-
sults based on these seven cases are presented in supplementary Figures S22-S25. We see
that having just the mean or just the mean, Q1 and Q3, does not identify any associations
with the pathway scores. However, adding more summary statistics describing the histogram
aids in identifying associations. But, as we will see next, the PC scores offer more relevant
information about the densities rather than including a larger number of summary statistics
as covariates (cases (f) and (g)). Hence, using the PDF-derived PC scores has a higher util-
ity in terms of understanding the pathway scores. In Figure 7, we show the boxplots of the
Spearman correlations between computed (observed) and ﬁtted (using estimated coefﬁcients
of density-based meta-features/summary statistics from RADIOHEAD) pathway scores, that
is, Spearman correlation between y and X ˆβ, respectively. These correlations are computed
separately by considering cases (a)-(g) and density-based PC scores as predictors.
Additionally, since the computation of the pathway score was dependent on the sample
composition, for the case with density-basd PC scores as predictors we also include boxplots
of Spearman correlations for three different computations of pathway scores as described in
Section 4. The width of these boxplots is proportional to the number of pathways exhibit-
ing signiﬁcant associations with at least one of the imaging meta-features. In supplementary
Figure S25, we also show the Spearman correlations between the computed pathway scores
and the ﬁtted pathway scores. This ﬁgure demonstrates that we are able to better understand
the underlying radiogenomic associations through our modelling approach when the density-
based meta-features are considered as covariates. Furthermore, our model can be used in
other applications (including other cancers and disease systems) involving imaging and ge-
nomic data, as the methodology is readily generalizable to different application domains.

20
S. MOHAMMED ET AL.
−0.2
0.0
0.2
0.4
0.6
Mean
(n=61)
Mean
Q1
Q3
(n=61)
Five
Number
Summary
(n=61)
Mean
SD
Skewness
Kurtosis
(n=61)
Deciles
(n=61)
15 Equally
Spaced
Percentiles
(n=61)
20 Equally
Spaced
Percentiles
(n=61)
Density
LGG
(n=61)
Density
LGG
(n=516)
Density
LGG+GBM
(n=669)
FIG 7. Boxplot of Spearman correlations between computed and ﬁtted pathway scores (X ˆβ) using RADIOHEAD,
while different sets of covariates are considered. The width of the boxplots is proportional to the number of
pathways exhibiting signiﬁcant associations with at least one of the imaging meta-features
5.0.0.2. Future Work:
Although we see promise in the proposed modelling framework to
identify radiogenomic associations in LGG, there are certain directions which can be further
explored. While using density-based features extracted from multimodal MRI scans does
facilitate modelling and provide improved performance, these densities do not explicitly uti-
lize potentially important spatial information in their construction. Incorporating voxel-based
spatial information in addition to intensity values is non-trivial and will be explored in our
future studies. The current model explores linear relationships between the PC scores and
pathway scores only, which could be further extended to investigate non-linear associations
as well. Such analyses will better inform the understanding of the inter- and intra- tumor
heterogeneity in LGG. Other directions could be to (a) extend the framework to incorpo-
rate dependencies between pathways (data-derived or based on canonical topology), or (b)
use gene-level data instead of pathways while incorporating cross-correlations between the
genes. Our framework could also be explored further with other forms of pan-omic data, such
as epigenomic and proteomic data. Furthermore, our ﬁndings could be used to build predic-
tive models for clinical phenotypes (such as survival or progression) that include biologi-
cally relevant information based on radiogenomic associations. This provides a statistically-
informed strategy to incorporate relevant information for the prediction of clinical phenotypes
from complex data.
Acknowledgments
All of the authors acknowledge support by the NCI grant R37-
CA214955. SM was partially supported by Precision Health at The University of Michigan
(U-M). SM and AR were partially supported by U-M institutional research funds. SK and

RADIOHEAD: RADIOGENOMIC ANALYSIS THROUGH DENSITIES
21
KB were partially supported by the NSF grants DMS 1613054 and DMS 2015374. SK was
also partially supported by the NSF grant CCF 1740761. VB was supported by NIH grants
R01-CA160736, R21-CA220299, P30 CA 46592 and NSF grant 1463233 and start-up funds
from the U-M Rogel Cancer Center and School of Public Health. We would like to extend
our gratitude to Kirsten Herold from the Writing Lab at the U-M School of Public Health. We
acknowledge the efforts of the anonymous Associate Editor and referees, whose comments
have strengthened this paper.
REFERENCES
ANDERSEN, M. R., WINTHER, O. and HANSEN, L. K. (2014). Bayesian inference for structured spike and slab
priors. In Advances in Neural Information Processing Systems 1745–1753.
BAEK, H. J., KIM, H. S., KIM, N., CHOI, Y. J. and KIM, Y. J. (2012). Percent change of perfusion skewness
and kurtosis: a potential imaging biomarker for early treatment response in patients with newly diagnosed
glioblastomas. Radiology 264 834–843.
BAKAS, S., ZENG, K., SOTIRAS, A., RATHORE, S., AKBARI, H., GAONKAR, B., ROZYCKI, M., PATI, S.
and DAVATZIKOS, C. (2015). GLISTRboost: combining multimodal MRI segmentation, registration, and bio-
physical tumor growth modeling with gradient boosting machines for glioma segmentation. In International
Workshop on Brainlesion: Glioma, Multiple Sclerosis, Stroke and Traumatic Brain Injuries 144–155. Springer.
BAKAS, S., AKBARI, H., SOTIRAS, A., BILELLO, M., ROZYCKI, M., KIRBY, J. S., FREYMANN, J. B., FARA-
HANI, K. and DAVATZIKOS, C. (2017a). Advancing the cancer genome atlas glioma MRI collections with
expert segmentation labels and radiomic features. Nature Scientiﬁc Data 4 170117.
BAKAS, S., AKBARI, H., SOTIRAS, A., BILELLO, M., ROZYCKI, M., KIRBY, J., FREYMANN, J., FARA-
HANI, K. and DAVATZIKOS, C. (2017b). Segmentation Labels and Radiomic Features for the Pre-operative
Scans of the TCGA-LGG collection. https://doi.org/10.7937/K9/TCIA.2017.GJQ7R0EF.
BHATTACHARYYA, A. (1943). On a measure of divergence between two statistical populations deﬁned by their
probability distributions. Bulletin of the Calcutta Mathematical Society 35 99–109.
BILLIOTI, L. and MERCURI, F. (2017). Riemannian Hilbert manifolds, Hermitian-Grassmannian submanifolds.
In Springer Proc. Math. Stat 261-271.
BROCKE, K. S., STAUFNER, C., LUKSCH, H., GEIGER, K. D., STEPULAK, A., MARZAHN, J., SCHACK-
ERT, G., TEMME, A. and IKONOMIDOU, C. (2010). Glutamate receptors in pediatric tumors of the central
nervous system. Cancer Biology & Therapy 9 455–468.
BROOKS, S. P. and GELMAN, A. (1998). General methods for monitoring convergence of iterative simulations.
Journal of computational and graphical statistics 7 434–455.
CECCARELLI, M., BARTHEL, F. P., MALTA, T. M., SABEDOT, T. S., SALAMA, S. R., MURRAY, B. A., MO-
ROZOVA, O., NEWTON, Y., RADENBAUGH, A. and PAGNOTTA, S. M. (2016). Molecular proﬁling reveals
biologically discrete subsets and pathways of progression in diffuse glioma. Cell 164 550–563.
CENCOV, N. N. (1982). Statistical decision rules and optimal inference. American Mathematical Society.
CHERRY, A. E. and STELLA, N. (2014). G protein-coupled receptors as oncogenic signals in glioma: Emerging
therapeutic avenues. Neuroscience 278 222–236.
CLARK, K., VENDT, B., SMITH, K., FREYMANN, J., KIRBY, J., KOPPEL, P., MOORE, S., PHILLIPS, S., MAF-
FITT, D., PRINGLE, M. et al. (2013). The Cancer Imaging Archive (TCIA): maintaining and operating a public
information repository. Journal of digital imaging 26 1045–1057.
DRYDEN, I. L. and MARDIA, K. V. (1998). Statistical shape analysis.
FISHBEIN, L., LESHCHINER, I., WALTER, V., DANILOVA, L., ROBERTSON, A. G., JOHNSON, A. R., LICHT-
ENBERG, T. M., MURRAY, B. A., GHAYEE, H. K. and ELSE, T. (2017). Comprehensive molecular charac-
terization of pheochromocytoma and paraganglioma. Cancer Cell 31 181–193.
GELMAN, A. and RUBIN, D. B. (1992). Inference from iterative simulation using multiple sequences. Statistical
Science 7 457–472.
GENTLEMAN, R. C., CAREY, V. J., BATES, D. M., BOLSTAD, B., DETTLING, M., DUDOIT, S., ELLIS, B.,
GAUTIER, L., GE, Y. and GENTRY, J. (2004). Bioconductor: open software development for computational
biology and bioinformatics. Genome Biology 5 R80.
GEORGE, E. I. and MCCULLOCH, R. E. (1997). Approaches for Bayesian variable selection. Statistica Sinica
339–373.
HÄNZELMANN, S., CASTELO, R. and GUINNEY, J. (2013). GSVA: gene-set variation analysis for microarray
and RNA-seq data. BMC Bioinformatics 14 7.
HOETING, J. A., MADIGAN, D., RAFTERY, A. E. and VOLINSKY, C. T. (1999). Bayesian model averaging: a
tutorial. Statistical Science 382–401.

22
S. MOHAMMED ET AL.
ISHWARAN, H. and RAO, J. S. (2005). Spike and slab variable selection: frequentist and Bayesian strategies. The
Annals of Statistics 33 730–773.
JUST, N. (2011). Histogram analysis of the microvasculature of intracerebral human and murine glioma
xenografts. Magnetic Resonance in Medicine 65 778–789.
JUST, N. (2014). Improving tumour heterogeneity MRI assessment with histograms. British Journal of Cancer
111 2205.
KARCHER, H. (1977). Riemannian center of mass and molliﬁer smoothing. Communications on Pure and Applied
Mathematics 30 509–541.
KASS, R. E. and VOS, P. W. (2011). Geometrical foundations of asymptotic inference 908. John Wiley & Sons.
KURTEK, S. and BHARATH, K. (2015). Bayesian sensitivity analysis with the Fisher–Rao metric. Biometrika
102 601–616.
LIBERZON,
A.,
SUBRAMANIAN,
A.,
PINCHBACK,
R.,
THORVALDSDÓTTIR,
H.,
TAMAYO,
P.
and
MESIROV, J. P. (2011). Molecular signatures database (MSigDB) 3.0. Bioinformatics 27 1739–1740.
LIU, Y., ZHOU, Y. and ZHU, K. (2012). Inhibition of glioma cell lysosome exocytosis inhibits glioma invasion.
PloS one 7 e45910.
MARUSYK, A., ALMENDRO, V. and POLYAK, K. (2012). Intra-tumour heterogeneity: a looking glass for cancer?
Nature Reviews Cancer 12 323.
MORRIS, J. S. and CARROLL, R. J. (2006). Wavelet-based functional mixed models. Journal of the Royal Sta-
tistical Society: Series B (Statistical Methodology) 68 179–199.
MORRIS, J. S., BROWN, P. J., HERRICK, R. C., BAGGERLY, K. A. and COOMBES, K. R. (2008). Bayesian
analysis of mass spectrometry proteomic data using wavelet-based functional mixed models. Biometrics 64
479–489.
MÜLLER, P., PARMIGIANI, G., ROBERT, C. and ROUSSEAU, J. (2004). Optimal sample size for multiple testing:
the case of gene expression microarrays. Journal of the American Statistical Association 99 990–1001.
NOUSHMEHR, H., WEISENBERGER, D. J., DIEFES, K., PHILLIPS, H. S., PUJARA, K., BERMAN, B. P.,
PAN, F., PELLOSKI, C. E., SULMAN, E. P. and BHAT, K. P. (2010). Identiﬁcation of a CpG island methylator
phenotype that deﬁnes a distinct subgroup of glioma. Cancer Cell 17 510–522.
OMBAO, H., LINDQUIST, M., THOMPSON, W. and ASTON, J. (2016). Handbook of Neuroimaging Data Analy-
sis. CRC Press.
RAMSAY, J. and SILVERMAN, B. (2005). Functional data analysis. Springer (2nd edition).
RAO, C. R. (1992). Information and the accuracy attainable in the estimation of statistical parameters. In Break-
throughs in Statistics 235–247. Springer.
SAHA, A., BANERJEE, S., KURTEK, S., NARANG, S., LEE, J., RAO, G., MARTINEZ, J., BHARATH, K.,
RAO, A. U. and BALADANDAYUTHAPANI, V. (2016). DEMARCATE: Density-based magnetic resonance
image clustering for assessing tumor heterogeneity in cancer. NeuroImage: Clinical 12 132–143.
SCHEIPL, F., FAHRMEIR, L. and KNEIB, T. (2012). Spike-and-slab priors for function selection in structured
additive regression models. Journal of the American Statistical Association 107 1518–1532.
SCOTT, D. W. (1992). Multivariate density estimation: theory, practice, and visualization. John Wiley & Sons.
SHINOHARA, R. T., SWEENEY, E. M., GOLDSMITH, J., SHIEE, N., MATEEN, F. J., CALABRESI, P. A.,
JARSO, S., PHAM, D. L., REICH, D. S. and CRAINICEANU, C. M. (2014). Statistical normalization tech-
niques for magnetic resonance imaging. NeuroImage: Clinical 6 9–19.
SILVERMAN, B. W. (1986). Density estimation for statistics and data analysis 26. CRC press.
SONG, Y. S., CHOI, S. H., PARK, C.-K., YI, K. S., LEE, W. J., YUN, T. J., KIM, T. M., LEE, S.-H., KIM, J.-
H. and SOHN, C.-H. (2013). True progression versus pseudoprogression in the treatment of glioblastomas:
a comparison study of normalized cerebral blood volume and apparent diffusion coefﬁcient by histogram
analysis. Korean Journal of Radiology 14 662–672.
SRIVASTAVA, A., JERMYN, I. H. and JOSHI, S. H. (2007). Riemannian analysis of probability density functions
with applications in vision. In IEEE Conference on Computer Vision and Pattern Recognition 1-8.
STOREY, J. D. (2003). The positive false discovery rate: a Bayesian interpretation and the q-value. The Annals of
Statistics 31 2013–2035.
VASAIKAR, S. V., STRAUB, P., WANG, J. and ZHANG, B. (2017). LinkedOmics: analyzing multi-omics data
within and across 32 cancer types. Nucleic Aids Research 46 D956–D963.
VENKATESH, H. S., JOHUNG, T. B., CARETTI, V., NOLL, A., TANG, Y., NAGARAJA, S., GIBSON, E. M.,
MOUNT, C. W., POLEPALLI, J. and MITRA, S. S. (2015). Neuronal activity promotes glioma growth through
neuroligin-3 secretion. Cell 161 803–816.
VENNETI, S. and HUSE, J. T. (2015). The evolving molecular genetics of low-grade glioma. Advances in
Anatomic Pathology 22 94.
VERHAAK, R. G., HOADLEY, K. A., PURDOM, E., WANG, V., QI, Y., WILKERSON, M. D., MILLER, C. R.,
DING, L., GOLUB, T. and MESIROV, J. P. (2010). Integrated genomic analysis identiﬁes clinically relevant

RADIOHEAD: RADIOGENOMIC ANALYSIS THROUGH DENSITIES
23
subtypes of glioblastoma characterized by abnormalities in PDGFRA, IDH1, EGFR, and NF1. Cancer Cell 17
98–110.
VERHAAK, R. G. W., COOPER, L. A. D., SALAMA, S. S., ALDAPE, K., YUNG, W. K. A. and BRAT, D. J.
(2014). Abstract 936: Comprehensive and integrative genomic characterization of diffuse lower grade gliomas.
Cancer Research 74 936–936.
WANG, R., GURGUIS, C. I., GU, W., KO, E. A., LIM, I., BANG, H., ZHOU, T. and KO, J.-H. (2015). Ion
channel gene expression predicts survival in glioma patients. Scientiﬁc Reports 5 11593.
XU, X. and GHOSH, M. (2015). Bayesian variable selection and estimation for group lasso. Bayesian Analysis
10 909–936.
YANG, X. and NARISETTY, N. N. (2018). Consistent group selection with Bayesian high dimensional modeling.
Bayesian Analysis.
YANG, H., BALADANDAYUTHAPANI, V., RAO, A. U. and MORRIS, J. S. (2020). Quantile function on scalar
regression analysis for distributional data. Journal of the American Statistical Association 115 90–106.
YUAN, M. and LIN, Y. (2006). Model selection and estimation in regression with grouped variables. Journal of
the Royal Statistical Society: Series B (Statistical Methodology) 68 49–67.
ZHANG, Z., KLASSEN, E. and SRIVASTAVA, A. (2019). Robust Comparison of Kernel Densities on Spherical
Domains. Sankhya A 81 144–171.
ZHANG, L., BALADANDAYUTHAPANI, V., MALLICK, B. K., MANYAM, G. C., THOMPSON, P. A.,
BONDY, M. L. and DO, K.-A. (2014). Bayesian hierarchical structured variable selection methods with ap-
plication to molecular inversion probe studies in breast cancer. Journal of the Royal Statistical Society: Series
C (Applied Statistics) 63 595–620.

24
S. MOHAMMED ET AL.
SUPPLEMENT TO “RADIOHEAD: RADIOGENOMIC ANALYSIS
INCORPORATING TUMOR HETEROGENEITY IN IMAGING THROUGH
DENSITIES."
S1. Overall Outline of RADIOHEAD
Here, we describe the algorithm with an outline
of the overall approach of this paper to identify the radiogenomic associations by modelling
the genomic-based pathway scores using the radiomic-based PC scores.
Algorithm S1 Outline of RADIOHEAD
1: for each MRI sequence M = T1, T1Gd, T2, FLAIR do
2:
for each tumor sub-region R = NC, ET, ED do
3:
for each subject i = 1,...,n do Compute the kernel densities fM
i
(R).
4:
Compute the principal component scores XM
R using PCA in Algorithm 1.
5: Consider a pathway of interest and compute pathway scores y = (y1,...,yn)⊤(as described in Section S2)
with the sample i = 1,...,n in the cohort.
6: Bayesian Modelling
a: Model:
y ∼N
 (4×3)
X
g=1
Xgβg,σ2In

; βgk
ind
∼N(0,σ2ζgν2
gk);
ζg iid
∼(1 −w)δv0(ζg) + wδ1(ζg);
w ∼U(0,1);
ν−2
gk
iid
∼Gamma(a1,a2); σ−2 ∼Gamma(b1,b2).
b: Gibbs sampling for the parameters βg,ζg,ν−2
gk ,w,σ−2 as described in Algorithm 2.
c: FDR-based variable selection as described in Section 3.5 to identify non-zero βgk.
S2. Computation of Pathway Scores
Instead of directly including the gene expression
proﬁles in the model, we use the corresponding pathway scores. Pathway-based methods of-
fer a signiﬁcant beneﬁt in terms of interpretability as gene function is exerted collectively
and may vary based on several factors, such as disease state, genetic modiﬁcation or environ-
mental stimuli. As mentioned in Hänzelmann, Castelo and Guinney (2013), using gene-sets
obtained by organizing genes provides an intuitive and stable context for assessing biolog-
ical activity. We compute these gene-set scores using gene-set variation analysis (GSVA)
(Hänzelmann, Castelo and Guinney, 2013), which is a gene-set enrichment method that esti-
mates variation of pathway activity over a sample population in an unsupervised manner. We
provide a brief overview of the GSVA procedure next.
Let Z denote the p × n matrix of normalized gene expression values of p genes for n
samples (p ≫n) and a collection of gene-sets G = {g1,...,gm}. The expression proﬁle
for gene i is deﬁned as zi = (zi1,...,zin) and each gene-set is a subset of genes with its
cardinality being denoted by |gk|. First, GSVA evaluates whether a gene i is highly or lowly
expressed in sample j in the context of the sample population distribution. An expression-
level statistic is computed so that distinct expression proﬁles can be compared on the same
scale. For each zi, a non-parametric kernel estimation of its cumulative density function is
performed using a Gaussian kernel to compute ˆFsi(zij) = 1
n
Pn
r=1 Φ( zij−zir
si
), where si is the
gene-speciﬁc bandwidth parameter controlling the resolution of the kernel estimation. These
statistics ˆFsi(zij) are converted to ranks r(i)j for each sample j and further normalized using

RADIOHEAD: RADIOGENOMIC ANALYSIS THROUGH DENSITIES
25
tij = |p
2 −r(i)j|. We use these tij to compute a Kolmogorov-Smirnov (KS)-type random walk
statistic for l = 1,...,p as
ηjk(l) =
Pl
i=1 |tij|τI(u(i) ∈gk)
Pp
i=1 |tij|τI(u(i) ∈gk) −
Pl
i=1 I(u(i) ∈gk)
p −|gk|
,
where τ is a parameter describing the weight of the tail and I(u(i) ∈gk) is an indicator
taking the value 1 if the gene corresponding to the rank i expression-level statistic belongs
to the gene-set gk. The statistic ηjk(l) produces a distribution over the genes by identifying
whether the genes in a gene-set are more likely to belong to either tail of the rank distribution.
This KS-like statistic is now converted into an enrichment score of the pathway using Sjk =
maxl(0,ηjk(l)) −minl(0,ηjk(l)). Hänzelmann, Castelo and Guinney (2013) note that Sjk
has a clear biological interpretation as it emphasizes genes in pathways that are concordantly
activated in one direction only, i.e., ones that are either over-expressed or under-expressed
relative to the overall population. Low enrichment is shown for pathways containing genes
strongly acting in both directions.
S3. Computation of the Karcher Mean
In this section, we provide a gradient-based
algorithm to compute the Karcher mean on H (Dryden and Mardia, 1998). The algorithm
can be initialized using one of the densities in the sample or an extrinsic average.
Algorithm S2 Sample Karcher mean of densities
1: ¯h0 (initial estimate for the Karcher mean) ←any one of the densities in the sample OR the extrinsic average.
Set j ←0 and ϵ1,ϵ2 > 0 be small.
2: For i = 1,...,n compute ui = exp−1
¯hj (hi).
3: Compute the average direction in the tangent space ¯u = 1
n
Pn
i=1 ui.
4: if ||¯u||L2 < ϵ1 then
5:
return ¯hj as the Karcher mean.
6: else
7:
¯hj+1 = exp¯hj(ϵ2¯u).
8:
Set j ←j + 1.
9:
Return to step 2.
S4. Expression for Joint Posterior Distribution
Here, we provide the joint posterior
distribution for the proposed Bayesian model. The model is given in Equation (3) in the
main manuscript, along with the group spike-and-slab prior structure in Equation (4). The
full posterior distribution is given by:
π(βgk,ζg,ν−2
gk ,w,σ−2|y,X) ∝(σ−2)
n
2 exp

−
1
2σ2 (y −Xβ)⊤(y −Xβ)

×
G
Y
g=1
Lg
Y
k=1
(σ2ζgν2
gk)−1/2 exp

−
β2
gk
2σ2ζgν2
gk

×
G
Y
g=1
h
(1 −w)δv0(ζg) + wδ1(ζg)
i
×1 ×
G
Y
g=1
Lg
Y
k=1
(ν−2
gk )a1−1 exp(−a2ν−2
gk )

26
S. MOHAMMED ET AL.
×(σ−2)b1−1 exp(−b2σ−2).
S5. Supplementary Figures and Tables
Figures S1 and S2 provide the truncated and
full densities for all subjects across all four MRI imaging sequences and all three tumor sub-
regions. For these densities, an overlaid Karcher mean is shown in Figure S3 with a truncated
y-axis for better visualization. Figures S4(a)-S4(d) show the percentage of overall variance
explained by the principal components constructed within each imaging sequence across
all three tumor sub-regions. Table S1 shows the summary statistics for the pathway scores
corresponding to C-pathways. Figures S5-S8 show the normal Q-Q plots for the error terms,
y −X ˆβ, from the RADIOHEAD framework for the C-pathways to validate the normality
assumption of our model. Figures S9 and S10 show diagnostic plots of the MCMC chain for
randomly chosen βgk. Speciﬁcally, Figure S9 shows the posterior densities and trace plots
for six randomly chosen βgk which were selected by the model for the transmission of nerve
impulse pathway, and Figure S10 shows similar plots for six randomly chosen βgk which
were not selected by the model for the same pathway. Figure S11 shows boxplots of the
potential scale reduction factors (PSRF) computed based on the MCMC samples of βgk from
seven different chains for regression with each pathway separately (Gelman and Rubin, 1992;
Brooks and Gelman, 1998).

RADIOHEAD: RADIOGENOMIC ANALYSIS THROUGH DENSITIES
27
−50
0
50
100
150
0
10
20
30
40
50
60
T1: NCR.NET
−50
0
50
100
150
0
10
20
30
40
50
60
T1: ED
−50
0
50
100
150
0
10
20
30
40
50
60
T1: ET
−50
0
50
100
150
200
0
10
20
30
40
50
T1GD: NCR.NET
−50
0
50
100
150
200
0
10
20
30
40
50
T1GD: ED
−50
0
50
100
150
200
0
10
20
30
40
50
T1GD: ET
−50
0
50
100
150
200
0
10
20
30
40
50
60
T2: NCR.NET
−50
0
50
100
150
200
0
10
20
30
40
50
60
T2: ED
−50
0
50
100
150
200
0
10
20
30
40
50
60
T2: ET
−50
0
50
100
150
200
0
10
20
30
40
50
60
FLAIR: NCR.NET
−50
0
50
100
150
200
0
10
20
30
40
50
60
FLAIR: ED
−50
0
50
100
150
200
0
10
20
30
40
50
60
FLAIR: ET
FIG S1. Kernel densities fM
i
(R) for all subjects across all four MRI sequences and three tumor sub-regions.
For visual convenience, the y-axes are truncated for each of the subplots. Similar plots without truncation of the
y-axis are shown in Figure S2. The x-axis shows the voxel-intensity values; however, we transform them to [0,1]
for each imaging sequence to compute the density estimates.

28
S. MOHAMMED ET AL.
−50
0
50
100
150
0
20
40
60
80
100
T1: NCR.NET
−50
0
50
100
150
0
20
40
60
80
100
T1: ED
−50
0
50
100
150
0
20
40
60
80
100
T1: ET
−100
0
50
150
250
0
10
20
30
40
50
T1GD: NCR.NET
−100
0
50
150
250
0
10
20
30
40
50
T1GD: ED
−100
0
50
150
250
0
10
20
30
40
50
T1GD: ET
0
200
400
600
800
0
200
400
600
T2: NCR.NET
0
200
400
600
800
0
200
400
600
T2: ED
0
200
400
600
800
0
200
400
600
T2: ET
−100
0
50
100
200
0
50
150
250
FLAIR: NCR.NET
−100
0
50
100
200
0
50
150
250
FLAIR: ED
−100
0
50
100
200
0
50
150
250
FLAIR: ET
FIG S2. Kernel density estimates fiR for all subjects across all four MRI sequences and all three tumor sub-
regions. Each row corresponds to a speciﬁc imaging sequence and each column corresponds to a tumor sub-
region. The x-axis shows the voxel-intensity values; however, we transform them to [0,1] for each imaging se-
quence to compute the density estimates.

RADIOHEAD: RADIOGENOMIC ANALYSIS THROUGH DENSITIES
29
−50
0
50
100
150
0
10
20
30
40
50
60
T1: NCR.NET
−50
0
50
100
150
0
10
20
30
40
50
60
T1: ED
−50
0
50
100
150
0
10
20
30
40
50
60
T1: ET
−50
0
50
100
150
200
0
10
20
30
40
50
T1GD: NCR.NET
−50
0
50
100
150
200
0
10
20
30
40
50
T1GD: ED
−50
0
50
100
150
200
0
10
20
30
40
50
T1GD: ET
−50
0
50
100
150
200
0
10
20
30
40
50
60
T2: NCR.NET
−50
0
50
100
150
200
0
10
20
30
40
50
60
T2: ED
−50
0
50
100
150
200
0
10
20
30
40
50
60
T2: ET
−50
0
50
100
150
200
0
10
20
30
40
50
60
FLAIR: NCR.NET
−50
0
50
100
150
200
0
10
20
30
40
50
60
FLAIR: ED
−50
0
50
100
150
200
0
10
20
30
40
50
60
FLAIR: ET
FIG S3. Kernel densities fM
i
(R) for all subjects (grey) across all four MRI sequences and three tumor sub-
regions. The solid red curve corresponds to the sample Karcher mean density. The y-axes are truncated for each
subplot similarly to Figure 4 in the main manuscript. The x-axis shows the voxel-intensity values; however, we
transform them to [0,1] for each imaging sequence to compute the density estimates.

30
S. MOHAMMED ET AL.
2
4
6
8
10
12
0.5
0.6
0.7
0.8
0.9
1.0
# of Principal Components
% Variance Explained
NCR
ED
ET
(a) T1
2
4
6
8
0.5
0.6
0.7
0.8
0.9
1.0
# of Principal Components
% Variance Explained
NCR
ED
ET
(b) T1Gd
5
10
15
0.5
0.6
0.7
0.8
0.9
1.0
# of Principal Components
% Variance Explained
NCR
ED
ET
(c) T2
5
10
15
0.5
0.6
0.7
0.8
0.9
1.0
# of Principal Components
% Variance Explained
NCR
ED
ET
(d) FLAIR
FIG S4. Percentage of overall variance explained by the principal components constructed within each imaging
sequence across all three tumor sub-regions. Vertical lines correspond to cutoffs for the number of principal
components used in the model as predictors for each sub-region.

RADIOHEAD: RADIOGENOMIC ANALYSIS THROUGH DENSITIES
31
Min.
1st Qu.
Median
Mean
3rd Qu.
Max.
SYNAPTIC_TRANSMISSION
-0.443
-0.288
-0.098
-0.013
0.277
0.549
TRANSMISSION_OF_NERVE_IMPULSE
-0.437
-0.273
-0.121
-0.011
0.225
0.566
MONOVALENT_INORGANIC_CATION_TRANSPORT
-0.289
-0.150
-0.051
-0.009
0.095
0.356
NEUROLOGICAL_SYSTEM_PROCESS
-0.185
-0.095
-0.014
0.026
0.108
0.386
REGULATION_OF_NEUROTRANSMITTER_LEVELS
-0.437
-0.256
-0.110
-0.018
0.250
0.488
POTASSIUM_ION_TRANSPORT
-0.406
-0.238
-0.115
-0.015
0.179
0.503
METAL_ION_TRANSPORT
-0.277
-0.135
-0.052
-0.013
0.074
0.397
GENERATION_OF_A_SIGNAL_INVOLVED_IN_CELL_CELL_SIGNALING
-0.404
-0.197
-0.062
-0.001
0.190
0.581
ION_TRANSPORT
-0.242
-0.114
-0.047
-0.011
0.074
0.341
CELL_CELL_SIGNALING
-0.332
-0.180
-0.059
-0.007
0.156
0.469
SYSTEM_PROCESS
-0.193
-0.082
-0.013
0.017
0.065
0.357
BEHAVIOR
-0.350
-0.183
-0.048
-0.007
0.151
0.430
CATION_TRANSPORT
-0.253
-0.135
-0.046
-0.012
0.104
0.357
GLUTAMATE_SIGNALING_PATHWAY
-0.586
-0.348
-0.054
-0.016
0.318
0.545
G_PROTEIN_COUPLED_RECEPTOR_PROTEIN_SIGNALING_PATHWAY
-0.344
-0.168
-0.033
0.008
0.143
0.471
EXOCYTOSIS
-0.333
-0.174
0.004
-0.005
0.115
0.385
DIGESTION
-0.232
-0.088
0.004
0.033
0.171
0.354
ANION_TRANSPORT
-0.209
-0.096
-0.033
-0.004
0.096
0.340
CENTRAL_NERVOUS_SYSTEM_DEVELOPMENT
-0.268
-0.100
0.036
-0.003
0.094
0.261
NERVOUS_SYSTEM_DEVELOPMENT
-0.318
-0.165
-0.012
-0.011
0.103
0.357
PROTEIN_AUTOPROCESSING
-0.444
-0.146
-0.005
0.004
0.162
0.409
TABLE S1
Summary statistics for the pathway scores corresponding to C-pathways.

32
S. MOHAMMED ET AL.
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
−2
−1
0
1
2
−0.5
0.0
0.5
Normal Q−Q plot
SYNAPTIC_TRANSMISSION
Theoretical Quantiles
Sample Quantiles
Kolmogorov−Smirnov Test
Compare with N(mu = 0, sigma = 0.327)
p−value: 0.969
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
−2
−1
0
1
2
−1.0
−0.5
0.0
0.5
1.0
Normal Q−Q plot
TRANSMISSION_OF_NERVE_IMPULSE
Theoretical Quantiles
Sample Quantiles
Kolmogorov−Smirnov Test
Compare with N(mu = 0, sigma = 0.385)
p−value: 0.577
GG
G
G
G
G
G
G
G
G
G
G
G
G
G G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
GG
G
G
G
G
G
G
G
G
G
−2
−1
0
1
2
−0.4
−0.2
0.0
0.2
0.4
0.6
Normal Q−Q plot
MONOVALENT_INORGANIC_CATION_TRANSPORT
Theoretical Quantiles
Sample Quantiles
Kolmogorov−Smirnov Test
Compare with N(mu = 0, sigma = 0.218)
p−value: 0.943
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
GG
G
G
G
G
GG
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
GG
G
G
G
−2
−1
0
1
2
−0.2
−0.1
0.0
0.1
0.2
0.3
0.4
Normal Q−Q plot
NEUROLOGICAL_SYSTEM_PROCESS
Theoretical Quantiles
Sample Quantiles
Kolmogorov−Smirnov Test
Compare with N(mu = 0, sigma = 0.165)
p−value: 0.442
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
−2
−1
0
1
2
−0.4
−0.2
0.0
0.2
0.4
Normal Q−Q plot
REGULATION_OF_NEUROTRANSMITTER_LEVELS
Theoretical Quantiles
Sample Quantiles
Kolmogorov−Smirnov Test
Compare with N(mu = 0, sigma = 0.274)
p−value: 0.969
G
G
G G G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
−2
−1
0
1
2
−0.4
−0.2
0.0
0.2
0.4
0.6
Normal Q−Q plot
POTASSIUM_ION_TRANSPORT
Theoretical Quantiles
Sample Quantiles
Kolmogorov−Smirnov Test
Compare with N(mu = 0, sigma = 0.243)
p−value: 0.736
FIG S5. Normal Q-Q plots for the error terms, y −X ˆβ, from the RADIOHEAD framework for different C-
Pathways.

RADIOHEAD: RADIOGENOMIC ANALYSIS THROUGH DENSITIES
33
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
−2
−1
0
1
2
−0.2
0.0
0.2
0.4
Normal Q−Q plot
METAL_ION_TRANSPORT
Theoretical Quantiles
Sample Quantiles
Kolmogorov−Smirnov Test
Compare with N(mu = 0, sigma = 0.192)
p−value: 0.424
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
−2
−1
0
1
2
−0.4
−0.2
0.0
0.2
0.4
0.6
Normal Q−Q plot
GENERATION_OF_A_SIGNAL_INVOLVED_
IN_CELL_CELL_SIGNALING
Theoretical Quantiles
Sample Quantiles
Kolmogorov−Smirnov Test
Compare with N(mu = 0, sigma = 0.266)
p−value: 0.323
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
−2
−1
0
1
2
−0.4
−0.2
0.0
0.2
0.4
Normal Q−Q plot
ION_TRANSPORT
Theoretical Quantiles
Sample Quantiles
Kolmogorov−Smirnov Test
Compare with N(mu = 0, sigma = 0.176)
p−value: 0.655
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
GG
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
−2
−1
0
1
2
−0.4
−0.2
0.0
0.2
0.4
Normal Q−Q plot
CELL_CELL_SIGNALING
Theoretical Quantiles
Sample Quantiles
Kolmogorov−Smirnov Test
Compare with N(mu = 0, sigma = 0.219)
p−value: 0.762
GG
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G G
G
G
G
G
G
G
G
G
−2
−1
0
1
2
−0.2
−0.1
0.0
0.1
0.2
0.3
Normal Q−Q plot
SYSTEM_PROCESS
Theoretical Quantiles
Sample Quantiles
Kolmogorov−Smirnov Test
Compare with N(mu = 0, sigma = 0.135)
p−value: 0.384
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
GG
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
−2
−1
0
1
2
−0.4
−0.2
0.0
0.2
0.4
Normal Q−Q plot
BEHAVIOR
Theoretical Quantiles
Sample Quantiles
Kolmogorov−Smirnov Test
Compare with N(mu = 0, sigma = 0.224)
p−value: 0.78
FIG S6. Normal Q-Q plots for the error terms, y −X ˆβ, from the RADIOHEAD framework for different C-
Pathways.

34
S. MOHAMMED ET AL.
G G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
GG
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
−2
−1
0
1
2
−0.4
−0.2
0.0
0.2
0.4
Normal Q−Q plot
CATION_TRANSPORT
Theoretical Quantiles
Sample Quantiles
Kolmogorov−Smirnov Test
Compare with N(mu = 0, sigma = 0.199)
p−value: 0.319
G
G
G
GG
G
G G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
−2
−1
0
1
2
−0.5
0.0
0.5
Normal Q−Q plot
GLUTAMATE_SIGNALING_PATHWAY
Theoretical Quantiles
Sample Quantiles
Kolmogorov−Smirnov Test
Compare with N(mu = 0, sigma = 0.345)
p−value: 0.719
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
GG
G
G
G
−2
−1
0
1
2
−0.4
−0.2
0.0
0.2
0.4
Normal Q−Q plot
GPCR_PROTEIN_SIGNALING_PATHWAY
Theoretical Quantiles
Sample Quantiles
Kolmogorov−Smirnov Test
Compare with N(mu = 0, sigma = 0.167)
p−value: 0.808
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
GG
G
G
G
G
G
G
G
G
G
G
G
G
G
G
GG
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
−2
−1
0
1
2
−0.4
−0.2
0.0
0.2
0.4
0.6
0.8
Normal Q−Q plot
EXOCYTOSIS
Theoretical Quantiles
Sample Quantiles
Kolmogorov−Smirnov Test
Compare with N(mu = 0, sigma = 0.253)
p−value: 0.108
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
−2
−1
0
1
2
−0.3
−0.2
−0.1
0.0
0.1
0.2
Normal Q−Q plot
DIGESTION
Theoretical Quantiles
Sample Quantiles
Kolmogorov−Smirnov Test
Compare with N(mu = 0, sigma = 0.135)
p−value: 0.669
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
−2
−1
0
1
2
−0.3
−0.2
−0.1
0.0
0.1
0.2
0.3
0.4
Normal Q−Q plot
ANION_TRANSPORT
Theoretical Quantiles
Sample Quantiles
Kolmogorov−Smirnov Test
Compare with N(mu = 0, sigma = 0.155)
p−value: 0.477
FIG S7. Normal Q-Q plots for the error terms, y −X ˆβ, from the RADIOHEAD framework for different C-
Pathways.

RADIOHEAD: RADIOGENOMIC ANALYSIS THROUGH DENSITIES
35
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
−2
−1
0
1
2
−0.2
−0.1
0.0
0.1
0.2
0.3
Normal Q−Q plot
CNS_DEVELOPMENT
Theoretical Quantiles
Sample Quantiles
Kolmogorov−Smirnov Test
Compare with N(mu = 0, sigma = 0.111)
p−value: 0.382
G
G
GG
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
−2
−1
0
1
2
−0.4
−0.2
0.0
0.2
Normal Q−Q plot
NERVOUS_SYSTEM_DEVELOPMENT
Theoretical Quantiles
Sample Quantiles
Kolmogorov−Smirnov Test
Compare with N(mu = 0, sigma = 0.195)
p−value: 0.936
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
GG
G
G
G
G
G
G
G
G
G
G
G
G
G
G
GG
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G G
GG
G
G
G
G
G
−2
−1
0
1
2
−0.4
−0.2
0.0
0.2
0.4
0.6
Normal Q−Q plot
PROTEIN_AUTOPROCESSING
Theoretical Quantiles
Sample Quantiles
Kolmogorov−Smirnov Test
Compare with N(mu = 0, sigma = 0.215)
p−value: 0.633
FIG S8. Normal Q-Q plots for the error terms, y −X ˆβ, from the RADIOHEAD framework for different C-
Pathways.

36
S. MOHAMMED ET AL.
−0.1
0.0
0.1
0.2
0.3
0.4
0.5
0
2
4
T1_ET.1
−0.1
0.0
0.1
0.2
0.3
0
2
4
6
T1_ET.3
0.0
0.1
0.2
0.3
0
2
4
6
8
T1Gd_ED.5
−0.1
0.0
0.1
0.2
0.3
0
2
4
6
8
T2_NCR.NET.11
−0.4
−0.3
−0.2
−0.1
0.0
0.1
0
1
2
3
4
FLAIR_ET.6
0.0
0.1
0.2
0.3
0.4
0
2
4
FLAIR_ET.16
T1_ET.1
0
100
200
300
400
500
600
−0.4
0.0
0.4
T1_ET.3
0
100
200
300
400
500
600
−0.4
0.0
0.4
T1Gd_ED.5
0
100
200
300
400
500
600
−0.4
0.0
0.4
T2_NCR.NET.11
0
100
200
300
400
500
600
−0.4
0.0
0.4
FLAIR_ET.6
0
100
200
300
400
500
600
−0.4
0.0
0.4
FLAIR_ET.16
0
100
200
300
400
500
600
−0.4
0.0
0.4
FIG S9. Posterior densities and trace plots corresponding to βgk which were selected by the model for the
transmission of nerve impulse pathway (pathway score computed with n = 61 LGG subjects).

RADIOHEAD: RADIOGENOMIC ANALYSIS THROUGH DENSITIES
37
−0.20
−0.15
−0.10
−0.05
0.00
0.05
0.10
0
5
10
15
T1_ED.2
−0.10
−0.05
0.00
0.05
0
20
60
T1Gd_ED.7
−0.3
−0.2
−0.1
0.0
0.1
0
20
40
60
T2_ED.5
−0.3
−0.2
−0.1
0.0
0.1
0
20
40
T2_ET.1
−0.1
0.0
0.1
0.2
0.3
0.4
0.5
0
20
60
T2_ET.4
−0.15
−0.10
−0.05
0.00
0.05
0.10
0.15
0
20
40
60
T2_ET.7
T1_ED.2
0
100
200
300
400
500
600
−0.2
0.0
0.2
T1Gd_ED.7
0
100
200
300
400
500
600
−0.2
0.0
0.2
T2_ED.5
0
100
200
300
400
500
600
−0.2
0.0
0.2
T2_ET.1
0
100
200
300
400
500
600
−0.2
0.0
0.2
T2_ET.4
0
100
200
300
400
500
600
−0.2
0.0
0.2
T2_ET.7
0
100
200
300
400
500
600
−0.2
0.0
0.2
FIG S10. Posterior densities and trace plots corresponding to βgk which were not selected by the model for the
transmission of nerve impulse pathway (pathway score computed with n = 61 LGG subjects).

38
S. MOHAMMED ET AL.
G
G
G
G
GG
G
G
G
G
G
G
G
G
G
G
G
G
G
G G
G
G
G
G
G
G
G
G
G
GG
GG
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G G
G
GG
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
GG
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
ANION_TRANSPORT
BEHAVIOR
CATION_TRANSPORT
CELL_CELL_SIGNALING
CENTRAL_NERVOUS_SYSTEM_DEVELOPMENT
DIGESTION
EXOCYTOSIS
G_PROTEIN_COUPLED_RECEPTOR_PROTEIN_SIGNALING_PATHWAY
GENERATION_OF_A_SIGNAL_INVOLVED_IN_CELL_CELL_SIGNALING
GLUTAMATE_SIGNALING_PATHWAY
ION_TRANSPORT
METAL_ION_TRANSPORT
MONOVALENT_INORGANIC_CATION_TRANSPORT
NERVOUS_SYSTEM_DEVELOPMENT
NEUROLOGICAL_SYSTEM_PROCESS
POTASSIUM_ION_TRANSPORT
PROTEIN_AUTOPROCESSING
REGULATION_OF_NEUROTRANSMITTER_LEVELS
SYNAPTIC_TRANSMISSION
SYSTEM_PROCESS
TRANSMISSION_OF_NERVE_IMPULSE
1.000
1.025
1.050
1.075
1.100
Potential Scale Reduction Factor
Pathway
FIG S11. Boxplots of the potential scale reduction factors (PSRF) computed based on the MCMC samples of βgk
from seven different chains. For each pathway, we run a separate regression using the RADIOHEAD pipeline and
the boxplot is constructed using the PSRFs corresponding to all of the coefﬁcients βgk. Values of PSRF close to
1 (or < 1.2) indicate agreement across multiple chains.
S6. Calibration of Pathway Scores
The computation of pathway scores can be sensi-
tive to sample composition. To better understand this in our context, we explore their dis-
tribution when computed using different sample cohorts. We use the genomic data available
for LGG and GBM from TCGA. We have a total of 516 LGG subjects; we use a subset
of 61 subjects with matched imaging data in our model. We also have a total of 153 GBM
subjects. We compute the pathway scores for these patient cohorts for the C-Pathways based
on four different sample compositions: (a) 516 LGG and 153 GBM subjects (Both-669), (b)
153 GBM subjects (UnCal-GBM-153), (c) 516 LGG subjects (UnCal-LGG-516), and (d) 61
LGG subjects with matched imaging data (UnCal-LGG-61). In Figures S12-S18, we show
violin plots corresponding to the distribution of pathway scores for the sample cohorts in
(a)-(d). When the pathway scores are computed for case (a), that is, by pooling subjects from
both LGG and GBM, we plot the individual distributions of pathway scores for the LGG
patients (LGG-516) and GBM patients (GBM-153).
In Figure S19, we plot posterior estimates of βgk corresponding to different principal com-
ponent scores across MRI sequences and tumor sub-regions. The pathway scores for the 61
subjects in our analysis are computed using n = 61 LGG samples (no calibration). Similarly,
in Figures S20 and S21, the pathway scores for the 61 subjects in our analysis are com-
puted using n = 516 LGG samples and n = 669 (516 LGG and 153 GBM subjects) samples
respectively.

RADIOHEAD: RADIOGENOMIC ANALYSIS THROUGH DENSITIES
39
−0.6
−0.4
−0.2
0.0
0.2
0.4
0.6
UnCal−LGG− 61
UnCal−LGG− 516
UnCal−GBM− 153
LGG− 516
GBM− 153
Both− 669
G
G
G
G
G
G
SYNAPTIC_TRANSMISSION
−0.6
−0.4
−0.2
0.0
0.2
0.4
0.6
UnCal−LGG− 61
UnCal−LGG− 516
UnCal−GBM− 153
LGG− 516
GBM− 153
Both− 669
G
G
G
G
G
G
TRANSMISSION_OF_NERVE_IMPULSE
−0.6
−0.4
−0.2
0.0
0.2
0.4
0.6
UnCal−LGG− 61
UnCal−LGG− 516
UnCal−GBM− 153
LGG− 516
GBM− 153
Both− 669
G
G
G
G
G
G
MONOVALENT_INORGANIC_CATION_TRANSPORT
FIG S12. Calibration of pathway scores: Violin plots for the pathway scores (computed by pooling all 669 LGG
and GBM subjects) of (a) 516 LGG and 153 GBM subjects (Both-669), (b) 153 GBM subjects (GBM-153) and
(c) 516 LGG subjects (LGG-516). Violin plots for pathway scores (computed without pooling) of (d) 153 GBM
subjects (UnCal-GBM-153), (e) 153 LGG subjects (UnCal-LGG-516), and (f) 61 LGG subjects for whom the
imaging was available (UnCal-LGG-61).

40
S. MOHAMMED ET AL.
−0.6
−0.4
−0.2
0.0
0.2
0.4
0.6
UnCal−LGG− 61
UnCal−LGG− 516
UnCal−GBM− 153
LGG− 516
GBM− 153
Both− 669
G
G
G
G
G
G
NEUROLOGICAL_SYSTEM_PROCESS
−0.6
−0.4
−0.2
0.0
0.2
0.4
0.6
UnCal−LGG− 61
UnCal−LGG− 516
UnCal−GBM− 153
LGG− 516
GBM− 153
Both− 669
G
G
G
G
G
G
REGULATION_OF_NEUROTRANSMITTER_LEVELS
−0.6
−0.4
−0.2
0.0
0.2
0.4
0.6
UnCal−LGG− 61
UnCal−LGG− 516
UnCal−GBM− 153
LGG− 516
GBM− 153
Both− 669
G
G
G
G
G
G
POTASSIUM_ION_TRANSPORT
FIG S13. Calibration of pathway scores: Violin plots for the pathway scores (computed by pooling all 669 LGG
and GBM subjects) of (a) 516 LGG and 153 GBM subjects (Both-669), (b) 153 GBM subjects (GBM-153) and
(c) 516 LGG subjects (LGG-516). Violin plots for pathway scores (computed without pooling) of (d) 153 GBM
subjects (UnCal-GBM-153), (e) 153 LGG subjects (UnCal-LGG-516), and (f) 61 LGG subjects for whom the
imaging was available (UnCal-LGG-61).

RADIOHEAD: RADIOGENOMIC ANALYSIS THROUGH DENSITIES
41
−0.6
−0.4
−0.2
0.0
0.2
0.4
0.6
UnCal−LGG− 61
UnCal−LGG− 516
UnCal−GBM− 153
LGG− 516
GBM− 153
Both− 669
G
G
G
G
G
G
METAL_ION_TRANSPORT
−0.6
−0.4
−0.2
0.0
0.2
0.4
0.6
UnCal−LGG− 61
UnCal−LGG− 516
UnCal−GBM− 153
LGG− 516
GBM− 153
Both− 669
G
G
G
G
G
G
GENERATION_OF_A_SIGNAL_INVOLVED_IN_CELL_CELL_SIGNALI
−0.6
−0.4
−0.2
0.0
0.2
0.4
0.6
UnCal−LGG− 61
UnCal−LGG− 516
UnCal−GBM− 153
LGG− 516
GBM− 153
Both− 669
G
G
G
G
G
G
ION_TRANSPORT
FIG S14. Calibration of pathway scores: Violin plots for the pathway scores (computed by pooling all 669 LGG
and GBM subjects) of (a) 516 LGG and 153 GBM subjects (Both-669), (b) 153 GBM subjects (GBM-153) and
(c) 516 LGG subjects (LGG-516). Violin plots for pathway scores (computed without pooling) of (d) 153 GBM
subjects (UnCal-GBM-153), (e) 153 LGG subjects (UnCal-LGG-516), and (f) 61 LGG subjects for whom the
imaging was available (UnCal-LGG-61).

42
S. MOHAMMED ET AL.
−0.6
−0.4
−0.2
0.0
0.2
0.4
0.6
UnCal−LGG− 61
UnCal−LGG− 516
UnCal−GBM− 153
LGG− 516
GBM− 153
Both− 669
G
G
G
G
G
G
CELL_CELL_SIGNALING
−0.6
−0.4
−0.2
0.0
0.2
0.4
0.6
UnCal−LGG− 61
UnCal−LGG− 516
UnCal−GBM− 153
LGG− 516
GBM− 153
Both− 669
G
G
G
G
G
G
SYSTEM_PROCESS
−0.6
−0.4
−0.2
0.0
0.2
0.4
0.6
UnCal−LGG− 61
UnCal−LGG− 516
UnCal−GBM− 153
LGG− 516
GBM− 153
Both− 669
G
G
G
G
G
G
BEHAVIOR
FIG S15. Calibration of pathway scores: Violin plots for the pathway scores (computed by pooling all 669 LGG
and GBM subjects) of (a) 516 LGG and 153 GBM subjects (Both-669), (b) 153 GBM subjects (GBM-153) and
(c) 516 LGG subjects (LGG-516). Violin plots for pathway scores (computed without pooling) of (d) 153 GBM
subjects (UnCal-GBM-153), (e) 153 LGG subjects (UnCal-LGG-516), and (f) 61 LGG subjects for whom the
imaging was available (UnCal-LGG-61).

RADIOHEAD: RADIOGENOMIC ANALYSIS THROUGH DENSITIES
43
−0.6
−0.4
−0.2
0.0
0.2
0.4
0.6
UnCal−LGG− 61
UnCal−LGG− 516
UnCal−GBM− 153
LGG− 516
GBM− 153
Both− 669
G
G
G
G
G
G
CATION_TRANSPORT
−0.6
−0.4
−0.2
0.0
0.2
0.4
0.6
UnCal−LGG− 61
UnCal−LGG− 516
UnCal−GBM− 153
LGG− 516
GBM− 153
Both− 669
G
G
G
G
G
G
GLUTAMATE_SIGNALING_PATHWAY
−0.6
−0.4
−0.2
0.0
0.2
0.4
0.6
UnCal−LGG− 61
UnCal−LGG− 516
UnCal−GBM− 153
LGG− 516
GBM− 153
Both− 669
G
G
G
G
G
G
G_PROTEIN_COUPLED_RECEPTOR_PROTEIN_SIGNALING_PATHW
FIG S16. Calibration of pathway scores: Violin plots for the pathway scores (computed by pooling all 669 LGG
and GBM subjects) of (a) 516 LGG and 153 GBM subjects (Both-669), (b) 153 GBM subjects (GBM-153) and
(c) 516 LGG subjects (LGG-516). Violin plots for pathway scores (computed without pooling) of (d) 153 GBM
subjects (UnCal-GBM-153), (e) 153 LGG subjects (UnCal-LGG-516), and (f) 61 LGG subjects for whom the
imaging was available (UnCal-LGG-61).

44
S. MOHAMMED ET AL.
−0.6
−0.4
−0.2
0.0
0.2
0.4
0.6
UnCal−LGG− 61
UnCal−LGG− 516
UnCal−GBM− 153
LGG− 516
GBM− 153
Both− 669
G
G
G
G
G
G
EXOCYTOSIS
−0.6
−0.4
−0.2
0.0
0.2
0.4
0.6
UnCal−LGG− 61
UnCal−LGG− 516
UnCal−GBM− 153
LGG− 516
GBM− 153
Both− 669
G
G
G
G
G
G
DIGESTION
−0.6
−0.4
−0.2
0.0
0.2
0.4
0.6
UnCal−LGG− 61
UnCal−LGG− 516
UnCal−GBM− 153
LGG− 516
GBM− 153
Both− 669
G
G
G
G
G
G
ANION_TRANSPORT
FIG S17. Calibration of pathway scores: Violin plots for the pathway scores (computed by pooling all 669 LGG
and GBM subjects) of (a) 516 LGG and 153 GBM subjects (Both-669), (b) 153 GBM subjects (GBM-153) and
(c) 516 LGG subjects (LGG-516). Violin plots for pathway scores (computed without pooling) of (d) 153 GBM
subjects (UnCal-GBM-153), (e) 153 LGG subjects (UnCal-LGG-516), and (f) 61 LGG subjects for whom the
imaging was available (UnCal-LGG-61).

RADIOHEAD: RADIOGENOMIC ANALYSIS THROUGH DENSITIES
45
−0.6
−0.4
−0.2
0.0
0.2
0.4
0.6
UnCal−LGG− 61
UnCal−LGG− 516
UnCal−GBM− 153
LGG− 516
GBM− 153
Both− 669
G
G
G
G
G
G
CENTRAL_NERVOUS_SYSTEM_DEVELOPMENT
−0.6
−0.4
−0.2
0.0
0.2
0.4
0.6
UnCal−LGG− 61
UnCal−LGG− 516
UnCal−GBM− 153
LGG− 516
GBM− 153
Both− 669
G
G
G
G
G
G
NERVOUS_SYSTEM_DEVELOPMENT
−0.6
−0.4
−0.2
0.0
0.2
0.4
0.6
UnCal−LGG− 61
UnCal−LGG− 516
UnCal−GBM− 153
LGG− 516
GBM− 153
Both− 669
G
G
G
G
G
G
PROTEIN_AUTOPROCESSING
FIG S18. Calibration of pathway scores: Violin plots for the pathway scores (computed by pooling all 669 LGG
and GBM subjects) of (a) 516 LGG and 153 GBM subjects (Both-669), (b) 153 GBM subjects (GBM-153) and
(c) 516 LGG subjects (LGG-516). Violin plots for pathway scores (computed without pooling) of (d) 153 GBM
subjects (UnCal-GBM-153), (e) 153 LGG subjects (UnCal-LGG-516), and (f) 61 LGG subjects for whom the
imaging was available (UnCal-LGG-61).

46
S. MOHAMMED ET AL.
SYNAPTIC_TRANSMISSION
TRANSMISSION_OF_NERVE_IMPULSE
MONOVALENT_INORGANIC_CATION_TRANSPORT
NEUROLOGICAL_SYSTEM_PROCESS
REGULATION_OF_NEUROTRANSMITTER_LEVELS
POTASSIUM_ION_TRANSPORT
METAL_ION_TRANSPORT
ION_TRANSPORT
CELL_CELL_SIGNALING
SYSTEM_PROCESS
BEHAVIOR
CATION_TRANSPORT
GLUTAMATE_SIGNALING_PATHWAY
GPCR_PROTEIN_SIGNALING_PATHWAY
EXOCYTOSIS
DIGESTION
ANION_TRANSPORT
CNS_DEVELOPMENT
NERVOUS_SYSTEM_DEVELOPMENT
PROTEIN_AUTOPROCESSING
T1_NCR.NET.3
T1_NCR.NET.4
T1_NCR.NET.9
T1_ET.1
T1_ET.2
T1_ET.3
T1_ET.4
T1_ET.7
T1_ET.12
T1Gd_NCR.NET.2
T1Gd_NCR.NET.9
T1Gd_ED.1
T1Gd_ED.5
T1Gd_ED.7
T1Gd_ET.1
T1Gd_ET.2
T1Gd_ET.4
T1Gd_ET.6
T2_NCR.NET.8
T2_NCR.NET.9
T2_NCR.NET.11
T2_NCR.NET.15
T2_NCR.NET.16
T2_ED.1
T2_ED.6
T2_ED.10
T2_ET.2
T2_ET.9
T2_ET.10
FLAIR_NCR.NET.10
FLAIR_NCR.NET.17
FLAIR_ED.12
FLAIR_ED.13
FLAIR_ET.6
FLAIR_ET.9
FLAIR_ET.10
FLAIR_ET.13
FLAIR_ET.15
FLAIR_ET.16
FLAIR_ET.17
−0.2
−0.1
0.0
0.1
0.2
value
Estimated Coefficients (Bayesian FDR < 5%)
MODE
Calibrated with LGG (61 subjects)
FIG S19. Posterior estimates of βgk, after FDR-based variable selection at level 0.05, corresponding to different
principal component scores across MRI sequences and tumor sub-regions. Each row corresponds to a pathway
from the C-Pathways. The pathway scores for the 61 subjects in our analysis are computed using n = 61 LGG
samples (no calibration).

RADIOHEAD: RADIOGENOMIC ANALYSIS THROUGH DENSITIES
47
SYNAPTIC_TRANSMISSION
TRANSMISSION_OF_NERVE_IMPULSE
MONOVALENT_INORGANIC_CATION_TRANSPORT
NEUROLOGICAL_SYSTEM_PROCESS
REGULATION_OF_NEUROTRANSMITTER_LEVELS
POTASSIUM_ION_TRANSPORT
METAL_ION_TRANSPORT
ION_TRANSPORT
CELL_CELL_SIGNALING
SYSTEM_PROCESS
BEHAVIOR
CATION_TRANSPORT
GLUTAMATE_SIGNALING_PATHWAY
GPCR_PROTEIN_SIGNALING_PATHWAY
EXOCYTOSIS
DIGESTION
ANION_TRANSPORT
CNS_DEVELOPMENT
NERVOUS_SYSTEM_DEVELOPMENT
PROTEIN_AUTOPROCESSING
T1_NCR.NET.3
T1_NCR.NET.4
T1_NCR.NET.9
T1_ET.1
T1_ET.2
T1_ET.3
T1_ET.4
T1_ET.7
T1_ET.12
T1Gd_NCR.NET.2
T1Gd_NCR.NET.9
T1Gd_ED.1
T1Gd_ED.5
T1Gd_ED.7
T1Gd_ET.1
T1Gd_ET.2
T1Gd_ET.4
T1Gd_ET.6
T2_NCR.NET.8
T2_NCR.NET.9
T2_NCR.NET.11
T2_NCR.NET.15
T2_NCR.NET.16
T2_ED.1
T2_ED.6
T2_ED.10
T2_ET.2
T2_ET.9
T2_ET.10
FLAIR_NCR.NET.10
FLAIR_NCR.NET.17
FLAIR_ED.12
FLAIR_ED.13
FLAIR_ET.6
FLAIR_ET.9
FLAIR_ET.10
FLAIR_ET.13
FLAIR_ET.15
FLAIR_ET.16
FLAIR_ET.17
−0.2
−0.1
0.0
0.1
0.2
value
Estimated Coefficients (Bayesian FDR < 5%)
MODE
Calibrated with LGG (516 subjects)
FIG S20. Posterior estimates of βgk, after FDR-based variable selection at level 0.05, corresponding to different
principal component scores across MRI sequences and tumor sub-regions. Each row corresponds to a pathway
from the C-Pathways. The pathway scores for the 61 subjects in our analysis are computed by calibrating with
n = 516 LGG samples.
S7. Utility of Densities as Predictors
We show results of our model using seven differ-
ent types of potential predictors: (a) mean, (b) mean, ﬁrst and third quartiles (Q1 and Q3),
(c) ﬁve-number summary, (d) mean, standard deviation, skewness and kurtosis, (e) deciles,
(f) 15 equally spaced percentiles, and (g) 20 equally spaced percentiles. The results based
on all of these seven cases are presented in Figures 22(a)-24(b). In Figure S25, we show the
Spearman correlations between the computed (observed) pathway scores and the predicted
(using density-based meta-features and the corresponding estimated coefﬁcients after vari-
able selection) pathway scores.

48
S. MOHAMMED ET AL.
SYNAPTIC_TRANSMISSION
TRANSMISSION_OF_NERVE_IMPULSE
MONOVALENT_INORGANIC_CATION_TRANSPORT
NEUROLOGICAL_SYSTEM_PROCESS
REGULATION_OF_NEUROTRANSMITTER_LEVELS
POTASSIUM_ION_TRANSPORT
METAL_ION_TRANSPORT
ION_TRANSPORT
CELL_CELL_SIGNALING
SYSTEM_PROCESS
BEHAVIOR
CATION_TRANSPORT
GLUTAMATE_SIGNALING_PATHWAY
GPCR_PROTEIN_SIGNALING_PATHWAY
EXOCYTOSIS
DIGESTION
ANION_TRANSPORT
CNS_DEVELOPMENT
NERVOUS_SYSTEM_DEVELOPMENT
PROTEIN_AUTOPROCESSING
T1_NCR.NET.3
T1_NCR.NET.4
T1_NCR.NET.9
T1_ET.1
T1_ET.2
T1_ET.3
T1_ET.4
T1_ET.7
T1_ET.12
T1Gd_NCR.NET.2
T1Gd_NCR.NET.9
T1Gd_ED.1
T1Gd_ED.5
T1Gd_ED.7
T1Gd_ET.1
T1Gd_ET.2
T1Gd_ET.4
T1Gd_ET.6
T2_NCR.NET.8
T2_NCR.NET.9
T2_NCR.NET.11
T2_NCR.NET.15
T2_NCR.NET.16
T2_ED.1
T2_ED.6
T2_ED.10
T2_ET.2
T2_ET.9
T2_ET.10
FLAIR_NCR.NET.10
FLAIR_NCR.NET.17
FLAIR_ED.12
FLAIR_ED.13
FLAIR_ET.6
FLAIR_ET.9
FLAIR_ET.10
FLAIR_ET.13
FLAIR_ET.15
FLAIR_ET.16
FLAIR_ET.17
−0.2
−0.1
0.0
0.1
0.2
value
Estimated Coefficients (Bayesian FDR < 5%)
MODE
Calibrated with LGG+GBM (669 subjects)
FIG S21. Posterior estimates of βgk, after FDR-based variable selection at level 0.05, corresponding to different
principal component scores across MRI sequences and tumor sub-regions. Each row corresponds to a pathway
from the C-Pathways. The pathway scores for the 61 subjects in our analysis are computed by calibrating with
n = 669 (516 LGG and 153 GBM) samples.
0.450
0.475
0.500
0.525
0.550
Threshold = 0.001 (Bayesian FDR < 5%)
(a) Mean
0.450
0.475
0.500
0.525
0.550
Threshold = 0.001 (Bayesian FDR < 5%)
(b) Mean,Q1,Q3
MONOVALENT_INORGANIC_CATION_TRANSPORT
GENERATION_OF_A_SIGNAL_INVOLVED_IN_CELL_CELL_SIGNALING
ION_TRANSPORT
CATION_TRANSPORT
T1_ED_Min
T1_ED_Q1
T1Gd_NCR.NET_Min
0.0
0.1
0.2
value
y
Threshold = 0.001 (Bayesian FDR < 5%)
(c) Five-Number Summary
FIG S22. Estimated coefﬁcients when the predictors are (a) mean, (b) ﬁrst-quartile, mean, and third quartile, (c)
ﬁve-number summary.

RADIOHEAD: RADIOGENOMIC ANALYSIS THROUGH DENSITIES
49
METAL_ION_TRANSPORT
ION_TRANSPORT
CELL_CELL_SIGNALING
SYSTEM_PROCESS
BEHAVIOR
CATION_TRANSPORT
EXOCYTOSIS
DIGESTION
ANION_TRANSPORT
PROTEIN_AUTOPROCESSING
T1_ET_StDev
T1Gd_ED_Skewness
T2_ED_Kurtosis
T2_ET_StDev
FLAIR_NCR.NET_Skewness
FLAIR_ED_Kurtosis
−0.05
0.00
0.05
value
Threshold = 0.001 (Bayesian FDR < 5%)
(a) Mean, SD, Skewness, Kurtosis
SYNAPTIC_TRANSMISSION
TRANSMISSION_OF_NERVE_IMPULSE
MONOVALENT_INORGANIC_CATION_TRANSPORT
NEUROLOGICAL_SYSTEM_PROCESS
REGULATION_OF_NEUROTRANSMITTER_LEVELS
POTASSIUM_ION_TRANSPORT
METAL_ION_TRANSPORT
GENERATION_OF_A_SIGNAL_INVOLVED_IN_CELL_CELL_SIGNALING
ION_TRANSPORT
CELL_CELL_SIGNALING
SYSTEM_PROCESS
BEHAVIOR
CATION_TRANSPORT
GLUTAMATE_SIGNALING_PATHWAY
GPCR_PROTEIN_SIGNALING_PATHWAY
EXOCYTOSIS
DIGESTION
ANION_TRANSPORT
CNS_DEVELOPMENT
NERVOUS_SYSTEM_DEVELOPMENT
PROTEIN_AUTOPROCESSING
T1_NCR.NET_D6
T1_NCR.NET_D10
T1_ED_D0
T1_ED_D1
T1_ED_D2
T1_ED_D3
T1_ED_D4
T1_ED_D5
T1_ED_D6
T1_ED_D7
T1_ED_D8
T1_ED_D9
T1_ED_D10
T1_ET_D0
T1_ET_D1
T1_ET_D4
T1_ET_D5
T1_ET_D6
T1_ET_D7
T1_ET_D8
T1_ET_D9
T1Gd_NCR.NET_D0
T1Gd_NCR.NET_D1
T1Gd_NCR.NET_D4
T1Gd_NCR.NET_D5
T1Gd_NCR.NET_D6
T1Gd_NCR.NET_D7
T1Gd_NCR.NET_D8
T1Gd_NCR.NET_D10
T1Gd_ED_D0
T1Gd_ED_D1
T1Gd_ED_D2
T1Gd_ED_D3
T1Gd_ED_D5
T1Gd_ED_D6
T1Gd_ED_D7
T1Gd_ED_D8
T1Gd_ED_D9
T1Gd_ED_D10
T1Gd_ET_D0
T1Gd_ET_D1
T1Gd_ET_D3
T1Gd_ET_D4
T1Gd_ET_D6
T1Gd_ET_D7
T1Gd_ET_D8
T1Gd_ET_D9
T2_NCR.NET_D0
T2_NCR.NET_D1
T2_NCR.NET_D2
T2_NCR.NET_D3
T2_NCR.NET_D4
T2_NCR.NET_D5
T2_NCR.NET_D6
T2_NCR.NET_D7
T2_NCR.NET_D8
T2_NCR.NET_D10
T2_ED_D0
T2_ED_D1
T2_ED_D2
T2_ED_D3
T2_ED_D4
T2_ED_D5
T2_ED_D6
T2_ED_D7
T2_ED_D8
T2_ED_D9
T2_ET_D0
T2_ET_D3
T2_ET_D4
T2_ET_D6
T2_ET_D7
T2_ET_D8
T2_ET_D9
FLAIR_NCR.NET_D0
FLAIR_NCR.NET_D8
FLAIR_ED_D0
FLAIR_ED_D1
FLAIR_ED_D2
FLAIR_ED_D3
FLAIR_ED_D4
FLAIR_ED_D5
FLAIR_ED_D6
FLAIR_ED_D7
FLAIR_ED_D8
FLAIR_ED_D9
FLAIR_ED_D10
FLAIR_ET_D0
FLAIR_ET_D3
FLAIR_ET_D8
FLAIR_ET_D10
−2.5
0.0
2.5
value
Threshold = 0.001 (Bayesian FDR < 5%)
(b) Deciles
FIG S23. Estimated coefﬁcients when the predictors are (a) mean, standard deviation, skewness, and kurtosis,
and (b) deciles.

50
S. MOHAMMED ET AL.
SYNAPTIC_TRANSMISSION
TRANSMISSION_OF_NERVE_IMPULSE
MONOVALENT_INORGANIC_CATION_TRANSPORT
NEUROLOGICAL_SYSTEM_PROCESS
REGULATION_OF_NEUROTRANSMITTER_LEVELS
POTASSIUM_ION_TRANSPORT
METAL_ION_TRANSPORT
GENERATION_OF_A_SIGNAL_INVOLVED_IN_CELL_CELL_SIGNALING
ION_TRANSPORT
CELL_CELL_SIGNALING
SYSTEM_PROCESS
BEHAVIOR
CATION_TRANSPORT
GLUTAMATE_SIGNALING_PATHWAY
GPCR_PROTEIN_SIGNALING_PATHWAY
EXOCYTOSIS
DIGESTION
ANION_TRANSPORT
NERVOUS_SYSTEM_DEVELOPMENT
PROTEIN_AUTOPROCESSING
T1_NCR.NET_P0
T1_NCR.NET_P50
T1_NCR.NET_P57
T1_ED_P43
T1_ED_P50
T1_ED_P86
T1_ET_P36
T1Gd_NCR.NET_P0
T1Gd_NCR.NET_P50
T1Gd_NCR.NET_P64
T1Gd_ED_P64
T1Gd_ED_P100
T1Gd_ET_P36
T1Gd_ET_P43
T1Gd_ET_P50
T1Gd_ET_P71
T1Gd_ET_P79
T1Gd_ET_P86
T1Gd_ET_P93
T2_NCR.NET_P7
T2_NCR.NET_P14
T2_NCR.NET_P36
T2_NCR.NET_P43
T2_ET_P93
FLAIR_NCR.NET_P36
FLAIR_NCR.NET_P64
FLAIR_NCR.NET_P71
FLAIR_ED_P0
FLAIR_ED_P57
FLAIR_ED_P64
FLAIR_ED_P79
FLAIR_ED_P100
FLAIR_ET_P14
FLAIR_ET_P100
−2
−1
0
1
2
3
value
5 equa y spaced pe ce t es
Threshold = 0.001 (Bayesian FDR < 5%)
(a) 15 Equally Spaced Percentiles
SYNAPTIC_TRANSMISSION
TRANSMISSION_OF_NERVE_IMPULSE
NEUROLOGICAL_SYSTEM_PROCESS
REGULATION_OF_NEUROTRANSMITTER_LEVELS
GENERATION_OF_A_SIGNAL_INVOLVED_IN_CELL_CELL_SIGNALING
CNS_DEVELOPMENT
NERVOUS_SYSTEM_DEVELOPMENT
PROTEIN_AUTOPROCESSING
T1_ED_P42
T1_ED_P63
T1_ET_P47
T1Gd_NCR.NET_P0
T1Gd_ED_P100
T2_ED_P95
FLAIR_ED_P0
FLAIR_ED_P37
FLAIR_ED_P53
FLAIR_ED_P100
−2.5
0.0
2.5
5.0
value
0 equa y spaced pe ce t es
Threshold = 0.001 (Bayesian FDR < 5%)
(b) 20 Equally Spaced Percentiles
FIG S24. Estimated coefﬁcients when the predictors are (a) 15 equally spaced percentiles, and (b) 20 equally
spaced percentiles.

RADIOHEAD: RADIOGENOMIC ANALYSIS THROUGH DENSITIES
51
0.22
0.27
0.16
0.04
0.21
0.28
0.37
0.31
0.35
0.24
0.42
0.38
0.31
0.25
0.1
0.05
−0.09
0.23
−0.06
0.13
−0.04
0.57
0.03
0.32
0.08
0.17
0.19
−0.04
−0.02
0.31
0.41
0.19
0.05
0.05
0.2
0.11
0.12
0.07
−0.08
0.1
0.07
0.15
−0.1
−0.04
−0.15
0.03
−0.03
0.22
0.07
0
0.07
0.08
−0.02
−0.04
−0.01
−0.13
0.11
0
0.12
−0.03
0.05
0.09
−0.11
−0.07
0.22
0.05
0.1
−0.17
−0.03
0.03
−0.04
0.05
0.24
0.12
−0.05
0
0.19
0.29
0.41
0.1
0.27
0.19
0.29
0.32
0.39
0.09
0.39
0.24
0.45
0.56
0.25
0.26
0.29
0.4
0.44
0.48
0.41
0.31
0.24
0.3
0.17
0.36
0.37
0.53
0.43
0.28
0.09
0.14
0.39
0.33
0.41
0.42
0.25
0.31
0.33
0.26
0.35
0.59
0.41
0.28
0.41
0.23
0.22
0.38
0.42
SYNAPTIC_TRANSMISSION
TRANSMISSION_OF_NERVE_IMPULSE
MONOVALENT_INORGANIC_CATION_TRANSPORT
NEUROLOGICAL_SYSTEM_PROCESS
REGULATION_OF_NEUROTRANSMITTER_LEVELS
POTASSIUM_ION_TRANSPORT
METAL_ION_TRANSPORT
GENERATION_OF_A_SIGNAL_INVOLVED_IN_CCS
ION_TRANSPORT
CELL_CELL_SIGNALING (CCS)
SYSTEM_PROCESS
BEHAVIOR
CATION_TRANSPORT
GLUTAMATE_SIGNALING_PATHWAY
GPCR_PROTEIN_SIGNALING_PATHWAY
EXOCYTOSIS
DIGESTION
ANION_TRANSPORT
CNS_DEVELOPMENT
NERVOUS_SYSTEM_DEVELOPMENT
PROTEIN_AUTOPROCESSING
Mean
(n=61)
Mean
Q1
Q3
(n=61)
Five
Number
Summary
(n=61)
Mean
SD
Skewness
Kurtosis
(n=61)
Deciles
(n=61)
15 Equally
Spaced
Percentiles
(n=61)
20 Equally
Spaced
Percentiles
(n=61)
Density
LGG
(n=61)
Density
LGG
(n=516)
Density
LGG+GBM
(n=669)
−1.0
−0.5
0.0
0.5
1.0
value
Spearman correlation between computed and fitted pathway scores
FIG S25. Spearman correlation between observed and predicted pathway scores while various sets of covariates
are used.

52
S. MOHAMMED ET AL.
S8. Inference on Group-Level Indicator
We perform a simulation study to compare
the performance of RADIOHEAD with (a) a Bayesian group selection (BGS) approach de-
veloped for a high-dimensional setting (Yang and Narisetty, 2018), and (b) the group LASSO
(G-LASSO) approach (Yuan and Lin, 2006). BGS is a Bayesian hierarchical model with a
spike-and-slab prior speciﬁcation to perform group selection in high-dimensional linear re-
gression models. The BGS model formulation is similar to RADIOHEAD, except that the
prior on β is a mixture of a point mass at zero, and a normal distribution which deﬁnes the
slab. However, unlike RADIOHEAD, the group-level indicator variable in BGS is identiﬁ-
able, making inference on it feasible. The G-LASSO is devised to select grouped variables
(factors) for accurate prediction in regression.
For simplicity, we consider the PC scores constructed for the T1 imaging sequence from
our LGG data as predictors. This includes three groups of PC scores corresponding to the
NC, ED and ET sub-regions, with 9, 7 and 12 PCs, respectively. Hence we have X ∈R61×28
with 61 subjects and the 28 covariates divided into three groups. We standardize the columns
of X for further analysis. We deﬁne β = [β1 β2 β3] ∈R28 such that
• β1 = (β1,1,...,β1,9) ∈R9, where β1,k is simulated from a double-exponential distribution
with a scale parameter θ = 1,
• β2,1 = 1 and β2,k = 0 for all k = 2,...,7, and
• β3,k = 0 for all k = 1,...,12.
The choice of β is made so that the ﬁrst group of covariates is associated with the response,
only one component of the second group is associated, and the third group is not associated.
We use this β to simulate the response y ∈R61 from a N(Xβ,σ2In) distribution. Here, σ
is the noise and we deﬁne the signal-to-noise ratio (SNR) as θ/σ. With θ = 1, we choose
different values for σ such that the SNR ∈{10,1.5,1,0.8,0.6,0.4,0.25}. The SNR values
chosen here include a value comparable to that of the real data analysis where the SNR was
close to 1. We use the covariates X, their grouping labels and the generated response y,
to identify the estimates of group indicators using BGS, and estimate the coefﬁcients βgk
using G-LASSO and RADIOHEAD. Tuning for the hyperparameters in BGS is performed
as suggested in Yang and Narisetty (2018). For G-LASSO, the tuning parameter is selected
based on minimizing the cross-validated error. We replicate the procedure 50 times under
each setting.
SNR
BGS
G-LASSO
RADIOHEAD
10.00
0.32
1.00
1.00
1.50
0.32
0.96
1.00
1.00
0.26
0.72
1.00
0.80
0.18
0.62
1.00
0.60
0.14
0.38
0.88
0.40
0.16
0.22
0.58
0.25
0.08
0.18
0.50
TABLE S2
The proportion of times both groups were identiﬁed by BGS, G-LASSO and RADIOHEAD algorithms across 50
replications under different choices of SNR.
The results of this comparison are presented in Table S2. The ﬁrst column shows the dif-
ferent choices of SNR. The second column shows the proportion of times BGS selected both
groups 1 and 2 across 50 replications. The third column shows the proportion of times at
least one coefﬁcient from both groups 1 and 2 was estimated to be non-zero. The fourth
column shows the proportion of times RADIOHEAD estimated at least one of ˆβ1,k ̸= 0 for

RADIOHEAD: RADIOGENOMIC ANALYSIS THROUGH DENSITIES
53
k = 1,...,9, and ˆβ2,1 ̸= 0 across 50 replications. Note that the condition to assess the per-
formance of G-LASSO is weaker than that of RADIOHEAD. From these results, we see
that RADIOHEAD identiﬁes the true associations almost always under high values of SNR
(> 0.8) and its performance decreases as SNR decreases. However, the performance of BGS
lacks severely compared to RADIOHEAD in identifying both groups, even under high-values
of SNR. This indicates that, under high within-group sparsity, inference on the group indi-
cator has an inferior performance compared to RADIOHEAD. Similarly, the performance
of G-LASSO is weaker for group-level inference when compared to RADIOHEAD, and de-
creases with increase in SNR.
S9. Sensitivity to v0
Details of the prior elicitation and the hyperparameter settings are
provided in Section 4 of the manuscript. Note that the choice of priors on ν−2 and σ−2
are non-informative ﬂat/vague priors since we chose the mean of the Gamma distribution
to be 1 with an extremely large variance of 0.001/0.0012 = 1000. We present results of
sensitivity analysis to the choice of v0. We run the RADIOHEAD pipeline on the LGG data
for v0 ∈{0.0001,0.0005,0.001,0.005,0.01,0.05,0.1}. For each choice of v0, we obtain the
estimates ˆβgk. Let sgk denote the standard deviation of the estimates of ˆβgk across different
choices of v0. For each pathway, we report
Mean SD =
1
GL
X
g,k
sgk and Max SD = max
g,k sgk,
where G is the number of groups and L is the total number of PCs included across all G
groups. In Table S3, we present the results from this sensitivity analysis. Each row corre-
sponds to a separate regression using RADIOHEAD for the pathway speciﬁed in the ﬁrst
column. The second and third columns show the values for Mean SD and Max SD. We see
that most of these values are very close to zero. All of the remaining components (minimum,
ﬁrst and third quartiles) of the ﬁve-number summary of sgk were zero. This indicates rea-
sonable consistency (across different choices of v0) in the estimated values of ˆβgk, which are
both zero as well as non-zero.
S10. Robustness of PC Basis to Sample Composition
We performed sensitivity anal-
ysis to assess the effect of sample composition on the computation of PCs by using a leave-
one-out approach as follows:
1. Let gM
k (R) be the kth empirical PC basis function for tumor sub-region R from imaging
sequence M, where k = 1,...,LM
R . Here, gM
k (R) is the kth principal component from
PCA.
2. For each i = 1,...,n, compute gM
k,−i(R), which is the kth PC basis function for tumor
sub-region R and imaging sequence M, while leaving out subject i from the computation.
3. For each i = 1,...,n, compute the geodesic distance between gM
k,−i(R) and gM
k (R),
that is, dM,R
k,i
= cos−1⟨gM
k,−i(R),gM
k (R)⟩, where ⟨·,·⟩denotes the dot product. Note that
gM
k,−i(R) and gM
k (R) are unit norm functions. Since they lie on the unit sphere, the arc
length metric is used as the distance.
Note that dM,R
k,i
is the angle between the unit vectors (discretized version of unit norm
functions) gM
k,−i(R) and gM
k (R). These basis functions do not have any speciﬁc interpre-
tation for positive or negative direction. Hence, we re-calibrate the values of dM,R
k,i
such
that dM,R
k,i
∈[0,π/2]. That is, if cos−1⟨gM
k,−i(R),gM
k (R)⟩> π/2, then we set dM,R
k,i
= π −

54
S. MOHAMMED ET AL.
Pathway
Mean SD
Max SD
SYNAPTIC_TRANSMISSION
0.00373
0.08260
TRANSMISSION_OF_NERVE_IMPULSE
0.00428
0.08426
MONOVALENT_INORGANIC_CATION_TRANSPORT
0.00119
0.09903
NEUROLOGICAL_SYSTEM_PROCESS
0.00041
0.03226
REGULATION_OF_NEUROTRANSMITTER_LEVELS
0.00222
0.05841
POTASSIUM_ION_TRANSPORT
0.00246
0.07810
METAL_ION_TRANSPORT
0.00093
0.05012
GENERATION_OF_A_SIGNAL_INVOLVED_IN_CELL_CELL_SIGNALING
0.00171
0.06616
ION_TRANSPORT
0.00132
0.07889
CELL_CELL_SIGNALING
0.00194
0.05357
SYSTEM_PROCESS
0.00030
0.04305
BEHAVIOR
0.00133
0.06125
CATION_TRANSPORT
0.00132
0.07980
GLUTAMATE_SIGNALING_PATHWAY
0.00232
0.08306
G_PROTEIN_COUPLED_RECEPTOR_PROTEIN_SIGNALING_PATHWAY
0.00205
0.07311
EXOCYTOSIS
0.00115
0.07909
DIGESTION
0.00031
0.02433
ANION_TRANSPORT
0.00078
0.03814
CENTRAL_NERVOUS_SYSTEM_DEVELOPMENT
0.00060
0.01872
NERVOUS_SYSTEM_DEVELOPMENT
0.00210
0.05443
PROTEIN_AUTOPROCESSING
0.00146
0.04687
TABLE S3
Sensitivity of the estimates ˆβgk to the choice of v0.
cos−1⟨gM
k,−i(R),gM
k (R)⟩. For each sequence M, each tumor sub-region R, and each princi-
pal direction k, we construct boxplots for the distance between the PC basis vectors (dM,R
k,i
for all i = 1,...,n) when they are computed (a) by pooling all 61 samples together, and (b)
by a leave-one-out approach. These plots are shown in Figure S26. For example, the panel
in the top left corresponds to the necrosis region from the T1 sequence. We see that from the
pooled PC computation we have included nine PCs in the model. The distances dM,R
k,i
for all
i = 1,...,n are extremely close to zero for the ﬁrst seven of the nine PCs, except for a few
outliers. This indicates that the ﬁrst seven basis functions computed either by pooling all 61
samples together, or by a leave-one-out approach, are similar (in direction). In some cases,
we observe large values for distances, which is expected for the PCs with higher value of k.
Some of the large values, which arise as outliers in the boxplot, indicate that those outliers
provide valuable variability in the sample, given the small sample size. These results indicate
reasonable consistency in the estimated PC bases under a leave-one-out approach.
More importantly, in our data analysis results, the transmission of nerve impulse pathway
and glutamate signaling pathway have the highest magnitude estimates of βgk. We see that all
boxplots for the signiﬁcantly associated PCs corresponding to highest magnitude coefﬁcients
(T1_ET.1 and T1_NCR/NET.3) are very close to zero. This indicates that these basis
functions are capturing similar aspects of the PDFs from both, the pooled and the leave-one-
out computation of the PCA basis, and thus demonstrate reasonable robustness to sample
composition.
S11. Sensitivity to the Choice of Bandwidth
There are several optimal bandwidth se-
lection approaches; however, there is no consensus on which approach works best in general
scenarios (Zhang, Klassen and Srivastava, 2019). In our analysis we use Silverman’s ap-
proach which is one of the most commonly used approaches that is optimal for normal den-
sities (Silverman, 1986). We have performed a sensitivity analysis to assess the differences
in the density estimates based on the choice of bandwidth. For comparison we consider two

RADIOHEAD: RADIOGENOMIC ANALYSIS THROUGH DENSITIES
55
G
G
G
GG
G
G
G
GGG
G
G
G
G
G
G
G
G
G
G
G
G
GG
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
GGG
GGG
GG
G
G
GGG
G
G
GG
G
G
G
GG
G
GG
G
G
G
GG
G
GG
G
G
G
G
GG
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
GG
G
G
G
GG
G
G
GG
G
G
GG
GG
G
G
G
G
GGG
G
G
G
G
G
G
GG
G
G
G
G
G
G
G
GG
G
G
G
G
G
G
G
G
GG
G
G
G
G
G
G
G
G
G
G
G
GG
G
G
G
G
G
G
G
G
G
G
G
GG
GG
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
GG
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
GG
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
GGGGG
GGGGG
G
G
G
G
G
G
G
GG
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
GG
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
GG
G
G
G
G
G
G
G
G
G
G
G
G
GG
G
G
G
G
GG
GGGGGG
GGG
GGGG
G
G
G
G
G
GG
G
G
G
GGG
G
G
G
G
GG
GG
G
G
G
G
G
G
GG
G
G
G
G
G
GGGGGG
G
GG
G
G
G
G
G
G
G
GG
G
G
GG
GG
G
G
G
GG
G
G
G
G
GG
G
G
G
G
G
G
G
GG
G
G
G
GGG
GG
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
GG
G
G
G
G
G
G
G
G
G
G
G
G
GGG
GG
G
G
G
GGG
G
G
G
G
G
G
G
GGGG
GG
GG
GG
G
G
GG
GG
G
GGG
G
G
G
G
G
G
G
G
G
G
G
G
GG
G
GG
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
GGG
G
G
G
GG
G
G
G
G
G
G
G
GG
G
GG
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
GG
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
GG
G
G
GGG
G
G
GGG
G
G
G
G
G
G
GG
G
GG
G
GG
GG
G
G
G
G
G
GG
GG
G
G
G
G
G
G
G
G
G
G
G
G
G
G
GG
GG
G
G
G
GG
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
GG
G
GG
G
G
G
G
G
G
G
GG
G
G
G
G
G
G
G
G
GG
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
GGG
GG
G
G
G
GG
G
G
G
G
G
G
G
G
GG
G
G
G
G
G
GG
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
G
GG
G
G
G
G
G
GG
G
G
G
G
G
GG
G
G
G
G
G
G
G
G
G
G
G
GG
G
G
G
G
G
G
G
G
G
G
G
NC
ED
ET
T1
T1GD
T2
FLAIR
1 2 3 4 5 6 7 8 9101112131415161718
1 2 3 4 5 6 7 8 9101112131415161718
1 2 3 4 5 6 7 8 9101112131415161718
0π
0.125π
0.25π
0.375π
0.5π
0π
0.125π
0.25π
0.375π
0.5π
0π
0.125π
0.25π
0.375π
0.5π
0π
0.125π
0.25π
0.375π
0.5π
Principal Components
Distance
FIG S26. Boxplots of the distance between the PC basis functions when they are computed (a) by pooling all 61
samples together, and (b) by a leave-one-out approach. Note that the maximum distance/angle between PC basis
functions is 0.5π.
additional bandwidth selection methods (denoted as Scott and BCV) based on two variations
proposed by Scott (1992). Among the various bandwidth selection approaches, these three
approaches (Silverman, Scott and BCV) provide reasonably similar estimates of density es-
timate for our data as shown next. Let f0
i ,f1
i and f2
i denote the density estimates for subject
i computed with the choice of bandwidth given by Silverman’s, Scott and BCV approaches,
respectively. Let us denote the geodesic distance between (a) f0
i and f1
i as d1
i and (b) f0
i and
f2
i as d2
i . Here d1
i and d2
i quantify the dissimilarity between the density estimates, that is,
Silverman vs Scott and Silverman vs BCV, respectively. Note that these geodesic distances
are bounded above by π/2 ≈1.571. In Table S4 below, we present the mean and standard de-
viations of d1
i and d2
i across all of the subjects for each combination of imaging sequence and
tumor sub-region. The values of average distances close to zero indicate reasonable consis-

56
S. MOHAMMED ET AL.
Sequence
Region
Silverman vs Scott
Silverman vs BCV
T1
NC
0.0069 (0.0100)
0.0131 (0.0183)
T1
ED
0.0034 (0.0036)
0.0073 (0.0103)
T1
ET
0.0110 (0.0218)
0.0260 (0.0522)
T1Gd
NC
0.0069 (0.0148)
0.0133 (0.0209)
T1Gd
ED
0.0029 (0.0066)
0.0093 (0.0164)
T1Gd
ET
0.0149 (0.0186)
0.0437 (0.0493)
T2
NC
0.0584 (0.1993)
0.0641 (0.1870)
T2
ED
0.0317 (0.1179)
0.0283 (0.0728)
T2
ET
0.0315 (0.1054)
0.0491 (0.1298)
FLAIR
NC
0.0971 (0.2136)
0.1018 (0.1859)
FLAIR
ED
0.0693 (0.1470)
0.0891 (0.1788)
FLAIR
ET
0.0990 (0.2119)
0.1269 (0.2211)
TABLE S4
Average distance between the density estimates computed using the Silverman’s optimal bandwidth versus the
Scott’s approach and BCV approach.
tency in the density estimates computed using the three commonly used bandwidth selection
approaches. Hence, inferences will be quite close as well since the PDF is incorporated in the
model through the inverse-exponential map at the Karcher mean, which is deﬁned using the
geodesic path between the Karcher mean and the PDF under question.

