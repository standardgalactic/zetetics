Challenges for Large-Scale Brain-Machine
Interfaces
Farah Laiwalla, Vincent Leung, Lawrence Larson,
and Arto Nurmikko
Contents
1
Introduction. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
420
2
Challenge of Large-Scale Cortical Interfaces (>1000 Nodes). . . . . . . . . . . . . . . . . . . . . .
421
3
Ensembles of Autonomous Microscale Devices for Large-Scale
Cortical Implants. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
423
3.1
System Overview. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
423
3.2
Ultralow Power, Compact Neural Sensing, and Stimulation. . . . . . . . . . . . . . . . . . .
426
3.3
Bidirectional Telecommunication for Ensembles of Neurograins. . . . . . . . . . . . . . .
429
3.4
Hermetic Sealing on Neurograin Chiplets by Ultrathin Dielectrics. . . . . . . . . . . . .
433
3.5
Experimental Validation In Vitro and In Vivo: Recording
and Microstimulation. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
435
4
Summary. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
438
References. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
438
Abstract
The execution of complex, naturalistic neural tasks relies on the coordinated
operation of cortical microcircuits across multiple related functional areas of the
brain. Cortical BCI technologies aimed at accessing these distributed computa-
tions are thus anticipated to require a large number of spatially diverse, implanted
electronic listening posts or nodes, appropriately positioned in physical proxim-
ity to the sources of these neural signals. From a neuroengineering perspective,
key aspects of the speciﬁcations for a next-generation BCI system include con-
F. Laiwalla · L. Larson · A. Nurmikko ()
School of Engineering, Brown University, Providence, RI, USA
e-mail: farah_laiwalla@brown.edu; lawrence_larson@brown.edu; arto_nurmikko@brown.edu
V. Leung
Qualcomm Institute, University of California San Diego, La Jolla, CA, USA
e-mail: vwleung@eng.ucsd.edu
© Springer Nature Singapore Pte Ltd. 2023
N. V. Thakor (ed.), Handbook of Neuroengineering,
https://doi.org/10.1007/978-981-16-5540-1_103
419

420
F. Laiwalla et al.
siderations of the channel counts that may be safely implanted chronically in vivo
subjects, as well as efﬁcient approaches for physical implementations of large
arrays of microscale electronic probes. Data rates for extracting brain signals
at a useful resolution have to be contemplated in the context of designing a
commensurate communication link facilitating low-latency forward transmission
for decoding by external computing platforms. This must of course occur in
concert with the reverse processes, whereby the same implanted probes would
provide a means to “write-in” feedback information into the brain through
injection of electronic signals directly into the cortex. This chapter reviews
contemporary examples and recent accomplishments in the ﬁeld, from the
viewpoint of systems level engineering, and discusses both the challenges and
opportunities ahead to build next generations of brain-computer interfaces.
Keywords
Neural prosthesis · Wireless power transfer · Sub-millimeter implants · ECoG
sensors · Charge-balanced cortical microstimulation · Bidirectional networked
telemetry · Hardware-efﬁcient computation
1
Introduction
The computational behavior of cortical microcircuits engaged in motor and sensory
processing has been exquisitely elucidated through many examples of multichannel,
broadband electrophysiological recordings of neural signals from the cortex of
primates. The ability to decode ensemble activity of neural populations accessed
through implanted microelectrode arrays has spurred the development of sophis-
ticated decoding techniques, utilizing both spike-based and ﬁeld potential-based
signals. Present-day, state-of-the art BCIs use decoding from a handful of channels
(<100) to yield relatively high-precision predictive estimates tracking both planning
and execution in the motor cortical areas of primate and human brains [5, 11].
Similar progress has been demonstrated in the sensory regime, from translating
a sense of touch [2] to the processing of speech in the auditory cortex [10].
Broadly, implanted multichannel probes are making signiﬁcant contributions to
fundamental brain science while advancing brain-computer interfaces (BCI) for
neural prostheses (NP).
The rationale for larger and scalable brain/cortical interfaces, comprising thou-
sands of distributed channels (referred to as “nodes” in this chapter), is rooted
in the premise that high-performance prosthetic applications facilitating execution
of complex tasks would be critically reliant on higher neural information content,
where the latter may only be obtained through denser spatial and temporal sampling
of the cortex (more neural interfacing nodes). Furthermore, these tasks may
be computationally represented in neuronal networks distributed across multiple
and potentially noncontiguous cortical areas, working simultaneously and with
mutual communication, such as in sensory-motor integration. The question of

Challenges for Large-Scale Brain-Machine Interfaces
421
Fig. 1 A schematic conceptualization of the regimes of neural information extracted from a
network of M neurons, as represented by neural dimensionality D, and in the context of varying
neural task complexity, NTC. In regime (i), the number of recorded neurons M but not NTC
restricts dimensionality; in regime (ii), NTC but not M restricts D; and in Regime (iii), D is well
below both M and NTC, suggesting an unexplained cortical circuit constraint beyond smoothness
and task simplicity. *This model is based on data from motor and premotor cortices. (Reprinted
with authors’ permission from Gao [6])
optimal neural sampling is the subject of intense discussion among neuroscientists,
including neural information theorists. One compelling theoretical basis has been
offered by Ganguli and collaborators [6], where the issue is contextualized through
deﬁning a correlation between neural task complexity (NTC) and a desirable
number of neural access nodes (Fig. 1). The analysis draws from a spectrum
of data recorded from motor and other cortical areas in human and nonhuman
primates, and anchors, to well-understood but highly constrained tasks such as
the low-dimensional movement intention of arm/hand associated with the in-plane
motion and clicking of a computer cursor. By contrast, it is yet unclear how one
might extrapolate to the neural information needs for more complex and highly
coordinated movements such as the use of multiple digits (i.e., playing a piano).
2
Challenge of Large-Scale Cortical Interfaces (>1000
Nodes)
The works highlighted in this volume illustrate the gamut of chronic neuroprosthetic
applications relying on multichannel recording of signals, most typically using
planar “Utah” or “Michigan” type monolithic implants [12, 15]. These devices are
microfabricated from conductive single crystal silicon to form 100 μm scale planar
arrays of disc or microneedle electrodes, the latter conﬁgured most commonly
as a 96-channel microelectrode array (MEA) for primate use. Although there are
continued efforts to increase the number of electrodes fabricated on such single solid
material base, it is not clear what the limits for practical extension and deployment
may be, beyond the current approximately 4 × 4 mm2 footprint of the commercial
grade, FDA-approved 96-channel device. While a monolithic, rigid form factor

422
F. Laiwalla et al.
Fig. 2 A hermetically sealed 100-channel wireless implant for neuromotor prostheses; battery
operated, with wireless inductive coupling for recharging; wireless link for broadband neural
data transmission (>100 Mbps, including LFPs and spikes), with distances 1–2 m to wireless
receiver) [3]
enables a fairly straightforward scheme for wiring and data interconnections, any
signiﬁcant increment in implant footprint poses challenges due to anatomical and
physiological considerations (cortical tissue and vasculature damage from increased
tissue displacement). For reference, a single 96 channel MEA displaces up to 15%
of the combined cortical and microvasculature volume at its target implant site.
The Utah-array MEA sensor, offering 100–200 nodes of neural access, has
served as a critical building block for the ﬁrst generation of proof-of-concept
integrated, implantable neurotechnologies, where wireless techniques have been
implemented to achieve communication speeds up to 100 Mbps [32]. Chronic use
of such systems has been validated in freely moving nonhuman primates, with
demonstrated utility as a fully subcutaneous implant ([3], Fig. 2) as well as an
external, head-mounted wireless unit. The latter conﬁguration is currently in part
of the ﬁrst wireless human neuroprosthesis pilot trial ([26, 27], Fig. 3).
The “Michigan- blade” MEA, where disc electrode nodes are fabricated along
1–3 mm long planar shanks for fully 3-D neural access, has similarly inspired
integrated platform technologies. The aspiration here is to tap into the three-
dimensional cortical architecture, with layers at different depths potentially offering
access to computationally distinct cortical columns. The “Neuropixel” device is
one contemporary illustration of this approach, with > 1000 recording nodes
embedded along a single ultrathin ﬂexible silicon blade for collection of extra-
cellular signals across, for example, layers I through VI in the motor cortex of
a rodent or monkey [4]. Meanwhile, researchers at Neuralink, Inc., have recently
demonstrated that robot-assisted, high throughput surgical implantation techniques
could provide a feasible mechanism for large-scale intracortical placement of

Challenges for Large-Scale Brain-Machine Interfaces
423
Fig. 3 ALS patient in his
home with two head-mounted
RF transmitters for broadband
wireless recording [26]
thin, silicon-based blades into animals [24]. A multitude of efforts elsewhere,
including several examples in this book, are focused on developing ﬂexible, large-
scale microelectrode arrays for epicortical [29] or intracortical use. From a system
perspective, development of large-scale neural sensors addresses only one key
part of the neurotechnology puzzle; there are many accompanying engineering
challenges to be considered. The intricacy of interconnect design, particularly in
the case of multiareal implants, is one such example. While the short tethers
connecting intracortical arrays and the wireless readouts described above represent
an improvement over percutaneous tethers, their scalability is still limited by
the “implant burden” associated with traditional monolithic intra- or epicortical
electrode arrays. Furthermore, large numbers of neural access nodes would translate
into increased demands for bandwidth in the aggregate neural data transmission
rates, presenting an additional scalability challenge and calling for consideration of
alternative design approaches.
3
Ensembles of Autonomous Microscale Devices for
Large-Scale Cortical Implants
3.1
System Overview
An entirely different approach to large-scale neural recording and stimulation
capitalizes on the remarkable progress made by microminiaturization of silicon
electronics in the last twenty years. Ever smaller transistors and other components
are available for small-volume custom IC design at semiconductor process nodes
well below the 100 nm mark. For BCI and NP applications, access to such advanced
low-power CMOS technologies offers an opportunity to embed multiple neural
interface functions within a small, integrated electronic footprint.
Figure 4 illustrates a generic concept for a large-scale neural interfacing approach
which breaks the mold of monolithic, multichannel neural sensors by proposing a
spatially distributed wireless network of sub-mm sized nodes. Individual nodes are
implemented as single silicon chiplets integrating the full spectrum of required elec-

424
F. Laiwalla et al.
Fig. 4 Conceptual overview
of a distributed wireless
implant network, comprising
ensembles of microdevices
dispersed widely across
multiple cortical areas, and
providing synchronous
bidirectional neural access for
recording and
microstimulation at each node
tronic functions, including capabilities for wireless power transfer and bidirectional
telecommunication with a central information hub. Ensembles of such microdevices
may be located epi or intracortically across multiple, noncontiguous areas of the
brain, yet providing cohesive neural access through a dynamic, reconﬁgurable
wireless link. We have developed an implementation of the described approach in
our laboratories, whereby the microscale chiplets, termed “neurograins,” may be
implanted on or in the brain cortex, or elsewhere within the body, and establish a
robust, high-speed (>10 Mbps) bidirectional telecommunication link with a body-
wearable external hub through a small, ﬂexible transmitting/receiving “skinpatch”
antenna structure mounted atop the subject’s head, for example.
There are several ongoing research endeavors in the area of wireless implantable
microdevices for neural applications. Researchers at UC Berkeley [25], for example,
have pioneered “neural dust” motes, which rely on ultrasonic energy for power
delivery and communications. Meanwhile, at Johns Hopkins [16], Georgia Tech
[31], and Imperial College London [1] among others, efforts have focused on
adapting and optimizing traditional RF-based approaches to meet the scalable,
distributed, networked neural interface challenge. We discuss below the particular
approach in our laboratories by a team of interdisciplinary scientists. Within this
approach, a number of neuroengineering challenges have been addressed and solved
at proof-of-concept level reﬂecting a system level view which, in our experience,
is imperative for biomedical implant active biomedical implants with realistic
aspirations to eventual human translation.
The concept of an autonomous wireless network of sensor microdevices requires
a priori vision and plans to address the following key questions:
(a) How to integrate the necessary electronic functions in a power and area-efﬁcient
manner on a sub-mm area chiplet?
(b) How to enable and optimize wireless power delivery to microscale nodes in
widespread cortical locations?
(c) How to structure a telecommunication scheme that enables neural data readout
and write-in with a reasonable system latency across large numbers (1000s) of
nodes?
(d) How to develop, beyond the chiplet level, a biocompatible, hermetically pack-
aged microimplant with minimal volume footprint?

Challenges for Large-Scale Brain-Machine Interfaces
425
Looking beyond the speciﬁcations for the implantable neural interface hardware
front-end to the comprehensive aspirations for a practical, next generation closed-
loop BCI system yields an additional set of considerations:
(i) It is important to consider the end-to-end device fabrication pipeline in the
context of compatibility with a uniform, high throughput batch process.
(ii) The energy consumption at a full-network level needs to preferably be adap-
tively optimized through the wearable telecommunications hub, to enable
continual orientation to and alignment with the most active neuronal network
subpopulations.
(iii) It is imperative to incorporate into the system architecture a viable strategy for
neural encoding, such as via programmable patterned cortical microstimula-
tion, deliverable through each microdevice node.
(iv) Finally, the implementation of a neural interface system for use in a human
subject requires real-time neural encoding/decoding for closed loop perfor-
mance. This alludes to the development of a wearable high-performance
neurocomputational processor, and/or wireless telemetry to supporting remote
computational platforms including cloud computing.
In keeping with the speciﬁcations outlined above, our research group has
implemented a wireless system architecture using the microwave energy harvesting
and communication scheme highlighted in Fig. 5. Juxtaposition of the water-
associated absorptive losses in biological tissue (scalp, skull, and brain tissue)
with the electromagnetics in a microscale device has suggested an optimal wireless
frequency near 1 GHz. A near-ﬁeld-inductive coupling approach has been utilized to
design a power and bidirectional data transfer link between implanted neurograins
and the body external “skinpatch” (Fig. 5a). Digitized neural data is communicated
using RF backscattering, and demodulated at the external telemetry hub using
standard RF hardware (ﬁlters, LNAs, circulators, isolators, etc.). Additionally, the
telemetry hub radio demodulator is directly integrated with a high-performance
computational processor, and the latter is anticipated to eventually serve as the site
for in situ signal decoding as well (Fig. 5b).
The ﬁrst generation of neurograin devices developed in our laboratories have
focused on a 500 μm × 500 μm footprint. At the core of each device is
a CMOS microchiplet integrating RF-energy harvesting, synchronized bidirec-
tional networked telecommunication, neural recording, and programmable cortical
microstimulation. Wireless power-transfer strategies in biomedical implants are
strictly governed by the FDA’s stringent Speciﬁc Absorption Rate (SAR) guide-
lines. In the neurograin system, an additional epicortical resonant relay antenna
structure has been introduced in order to increase the RF energy transfer efﬁciency
to the sub-mm scale neurograins (deep subwavelength regime) while being mindful
of SAR limits. The detailed electromagnetic design for the inductive link has
been described in [20], where a relay antenna of 2 cm × 2 cm allows for
concentration of magnetic ﬂux from the external skinpatch transmitter positioned
∼1 cm away for a wireless power transfer efﬁciency between −37 and −32 dB

426
F. Laiwalla et al.
Fig. 5 System architecture for near-ﬁeld RF energy and neural data transfer across the distributed
neurograin microdevice network: (a) a block-level description of the RF communication scheme,
as implemented in individual microdevices as well as the external head-mounted communication
hub (“Skinpatch”); (b) a BCI-platform level view, envisioning integration of implants, external
radios with computational processors, and user interfaces; (c) Neurograin wireless chiplets on a
US penny
(measured in a liquid brain phantom [20]). Figure 6 provides a block-diagram view
of the major electronic components of the neurograin system, here comprising
both implanted and body-external elements. The implantable electronic nodes are
designed to operate within a synchronized, bidirectional RF telecommunication
network, scalable in principle across populations of nodes up to tens of thousands.
The external RF telecommunications hub, envisioned as a wearable module, is
designed to enable wireless coordination and management of the implanted nodes
at a variety of programmable levels for optimized performance. Additionally, it is
expected to embed capabilities for real-time data processing for neural decoding [9]
and eventual encoding for closed loop operation. In the next section, we elaborate
on the critical electronic design components onboard the neurograin ASIC.
3.2
Ultralow Power, Compact Neural Sensing, and Stimulation
Conventional approaches for monolithic neural sensors rely on hardware-sharing
designs where a single large ampliﬁer ASIC implements preampliﬁer arrays with
50–100 channels, and shares other needed on-chip hardware through channel

Challenges for Large-Scale Brain-Machine Interfaces
427
Fig. 6 Neurograin system block diagram, detailing ASIC subblocks (blue, left), as well as the
wireless communication scheme and skinpatch demodulator (green, right)
multiplexing. This includes a shared remote reference among all the channels in the
sensor array. This deviates from the approach for designing neural sensing circuits
for autonomous sub-mm implants in the following ways: First, the electrode contact
separation on each microchiplet is limited to 200–300 μm; the onboard ampliﬁer
thus needs to measure a focal differential neural potential (action potential spikes
or gradients in the ﬁeld potential). Second, the microdevices are physically isolated
and their reference potentials are self-referred, without an explicit, global ground
potential. Third, in the absence of the possibility for any hardware-sharing, the area
constraints for the recording analog front-end (AFE) are very tight, given the bulk
of the device area is reserved for power and data telemetry circuitry.
Our team has implemented an AFE for broadband ECoG recording with a
bandwidth of 500 Hz and a dynamic range up to +/−1 mV [13]. This compact
AFE occupies <0.01 mm2 on a neurograin chiplet, with a footprint highlighted in
Fig. 7a. Ultralow power technique is utilized to constrain maximum AFE current
to 6 μA from a 0.6 V power supply. A DC-coupled, merged amp-ADC topology
implemented with a capacitor-less, mostly digital architecture as illustrated in
Fig. 7b enables an area-scalable design. Furthermore, a high input-impedance
(>500 M) current-mode summing network largely eliminates kT/C noise. The
design is fabricated in 65-nm CMOS and has an overall power dissipation of 3.2 μW
(including 300 nW by the biasing network, 2.4 μW by the voltage-current converter,
360 nW by the current controlled ring-oscillator, and 150 nW by the digital circuits).
The input-referred noise is 2.2 μVrms over 500 Hz of bandwidth. Most importantly,
the design is scalable to smaller process nodes with up to 8× projected power
savings from translation to a 22 nm CMOS process. The DC-coupled architecture
also incorporates a differential electrode offset DEO cancellation circuit, where the
latter has an operating range of up to +/−50 mV.
In order to access high-frequency neural spike data within the bandwidth
constraints of the neurograin system, we have also implemented a low-power spike
detection AFE on the neurograin microchiplets (Laiwalla in preparation). This
design leverages the adaptive voltage thresholding technique outlined in [8] to

428
F. Laiwalla et al.
Fig. 7 (a) Photomicrograph of a neurograin, highlighting the footprint of the Analog Front End
(AFE); (b) Block Diagram of the DC-coupled, merged Amp-ADC architecture of the Neurograin
ECoG-recording AFE
obtain aggregated spike counts over user-selectable time periods, mimicking an
approach that is common in spike-based neural decoding. The on-chip circuitry
includes an AC-coupled preampliﬁer, with a midband gain of 40 dB and a bandwidth
from 10 Hz to 8 kHz. Spike frequencies are subsequently isolated from the
preampliﬁed signal using a Gm-C topology-integrated high-pass ﬁlter with a cutoff

Challenges for Large-Scale Brain-Machine Interfaces
429
Fig. 8 Charge-balanced current-mode microstimulator with wireless programmability. The stim-
ulator occupies a 100 μm × 60 μm and dissipates up to 30 μW of power through biphasic charge
delivery to tissue
at 250 Hz. The standard deviation (σ) of background Gaussian noise in the frequency
band of interest is estimated using a proportional-integral feedback system, and the
spike detection threshold is set to >5σ. Spike counts are stored in an on-chip buffer,
which may be interrogated wirelessly at a custom-deﬁned time integral, nominally
∼50 ms. The fully integrated analog spike detector occupies ∼150 × 150 μm2 area
and draws <10 μA from a 0.7 V supply.
In anticipation of closed-loop prosthetic control, we have also incorporated a
programmable, charge-balanced, current-mode biphasic microstimulation circuit as
part of the neurograin front-end electronics. Based on the voltage-controlled resistor
(VCR) current-steering DAC described in [7], the microstimulator implements a
source-reuse architecture for improved charge balance [17]. Stimulation current,
pulse width, and frequency are wirelessly conﬁgured, with charge delivery capacity
up to 60% of the total microchip power budget (Fig. 8).
3.3
Bidirectional Telecommunication for Ensembles
of Neurograins
The design of a scalable, low-latency wireless telecommunication scheme for a
network of thousands of autonomous microscale implants is a unique challenge,
unprecedented in the traditional implementations of large-scale neural interfaces

430
F. Laiwalla et al.
Fig. 9 Schematic of the TDMA call-and-respond wireless protocol for high-speed, synchronous
bidirectional telecommunication across a spatially distributed neurograin network
(Sect. 2). Although both frequency and time-domain multiplexing approaches are
possible in principle, as have been implemented in cellular networks, the constraints
to link power budgets, device size, available RF bandwidth, and RF transmission
distances through body tissue are in a different ballpark, requiring de novo solutions.
Our team has designed and tested a time-domain multiple access (TDMA)-based
synchronized call-and-respond network [23], with the capacity to scale to thousands
of independent wireless nodes (Fig. 9). We have employed a single-tone RF solution
(at ∼1 GHz), which incorporates both wireless power delivery and bidirectional,
synchronized data communications between neurograin ensembles and the external
skinpatch (the latter serves as both the RF power source and the communications
hub). Neurograin microchiplets have individual free-running oscillators; these are
synchronized through external command by the skinpatch hub, which is able to both
coordinate collision-free transmission and dynamically conﬁgure the transmission
schedules for optimized data recovery.
A conﬁgurable multinode network necessitates on-chip implementation of
unique device identiﬁers. In the neurograin devices, we have accomplished
this through two distinct approaches: (i) hardwired, laser etched fuses, and (ii)
CMOS-integrated Physically Unclonable Functions (PUFs), where the latter are
random-number generator IDs driven by process-dependent variations in transistor
threshold voltages [13, 30]. Fig. 10 shows an implementation of approach (i),
with a photomicrograph showing a ten-bit laser fuse-based elongated address
structure, which has been encoded with a speciﬁc digital code via UV laser ablation
during postprocessing of the chiplet [18]. By contrast, the PUF address from (ii)
is implemented at the CMOS design stage, and recovered via interrogation after
fabrication.
For the initial TDMA system proof-of-concept, we have chosen to implement
a 1000-channel system, with an overall system latency of <100 ms (compatible

Challenges for Large-Scale Brain-Machine Interfaces
431
Fig. 10 Encoding a 10-bit address on chip by laser ablation with one address code displayed by
external readout
with typical neural prosthetic applications). Design speciﬁcations such as uplink
data rate (10 Mbps), downlink data rate (1 Mbps), packet duration (100 μs per
channel), packet periodicity (100 ms data frame), and oscillator frequency (30 MHz)
follow from the assigned overall system latency. We combine a Binary Phase
Shift Keyed (BPSK)-encoded RF backscatter uplink with an Amplitude Shift
Keyed- Pulse Width Modulated (ASK-PWM) downlink for an overall synchronized,
bidirectional TDMA-networking protocol illustrated in Fig. 9. Circuit level details
of our approach are described in [23]. Fig. 11 demonstrates these circuit elements
at a block-diagram level, representing our speciﬁc approach for a bidirectional
wireless communication link as implemented on an RF-compatible, low-power
65 nm CMOS process node (and scalable to smaller nodes). First, a custom-designed
on-chip microcoil, part of a 3-coil relay system described in [20], couples RF
power from the Skinpatch-transmitting antenna to a low-voltage rectiﬁer [28], which
supplies on-chip DC power and initiates a free-running ∼30 MHz chip oscillator
upon start-up. The communication link has been tested through early wireless
prototypes where predeﬁned data comprising a 16-bit PUF ID and a known 32-
bit sequence implemented as a linear feedback shift register (LFSR) is encoded
onto each neurograin chip. These chips, when interrogated by the external telecom

432
F. Laiwalla et al.
Fig. 11 Block diagram of the principal on-chip circuits for bidirectional communication; an LC
tank coupled to a rectiﬁer provides DC power for the neurograin and starts a free-running oscillator.
The power signal is also amplitude and pulse-width modulated (ASK-PWM) to encode downlink
commands (in blue). These instructions can be directly decoded with a digital FSM, which oversees
chip operations, including enabling an RF backscatter modulator for uplink communication
hub, are able to report their ﬁxed uplink 1000-bit data pattern at 10 Mbps. This
uplink data is BPSK-modulated, and wirelessly communicated through a switching
capacitor (C2 in Fig. 11) enabling RF backscatter. This uplink event is scheduled
through receipt of a node-speciﬁc downlink command from the external hub, which
is interpreted on-chip by the ASK-PWM decoder shown in Fig. 11. The downlink
data rate is 1 Mbps; a downlink data packet is 3–16 bits in size, thus occupying
<20% of the communication link bandwidth.
The neurograin communication protocol implicitly assumes a controller-agent
conﬁguration, driven by the skinpatch hub. The networking architecture is time-
domain, with spectral multiplexing not currently compatible with the electronic
implementation of the RF circuitry. The synchronization of a time-domain approach
across nodes with free-running clocks poses a critical challenge for the design
of a high-link-efﬁciency network. In addition, neurograin electronics are self-
referenced (ﬂoating); a global shared reference is lacking, and their operation from
a 0.7 V supply makes it difﬁcult to implement an on-chip reference circuit for bit-
slicing in an amplitude-modulated scheme. We have addressed these challenges by
implementing a dual-modulation scheme combining Amplitude Shift Keying (ASK)
with Pulse Width Modulation (PWM) as described in [23]. In this dual encoding
strategy, each bit is represented by timed intervals of modulated amplitudes. For
example, a logic “1” is represented by a high pulse with long (2T) duration,
followed by a “low” pulse with short (1T) duration. Conversely, logic “0” is a short
high and a long low pulse. Decoding is dependent on the ratio of pulse durations
rather than the absolute length, and the integration interval T is chosen to be a
signiﬁcant multiple of the chip-clock period (∼33 ns) to allow robust operation
across variable chip clock rates. The current neurograin system, with a downlink
data rate of 1 Mbps uses a T of 0.33 μs, which is 10× the nominal clock rate.
A bidirectional wireless communication link across a network of 32 neurograins is
demonstrated in Fig. 12. Each chip is individually “called” through downlinking its

Challenges for Large-Scale Brain-Machine Interfaces
433
Fig. 12 Measured results from a 32 neurograin call-and-respond network: (a) transient baseband
data, and (b) samples of recovered backscattered 1024-bit data packets displayed in 100 μs, in 2D
color map (32-bits × 32 cycles)
16-bit PUF ID, with the ASK-PWM scheme at 1 Mbps, and “responds” by activating
its backscatter modulator to uplink a 1000-bit predeﬁned data packet (comprising its
PUF and LFSR data as described above) at 10 Mbps. The 2-D color maps in Fig. 12
represent 500 bits of recurrent 32-bit LFSR, followed by 500 bits of repeating 16-bit
PUF ID in each uplink data packet. Over this span, each uninterrupted color band
reﬂects error-free transmission. Bit-error-rates (BER) for the neurograin backscatter
link have been experimentally measured to be <1e−5 [22].
3.4
Hermetic Sealing on Neurograin Chiplets by Ultrathin
Dielectrics
Commercial macroscale implantable electronic devices such as pacemakers and
cochlear implants embed their electronics in titanium or ceramic packages. These
approaches do not scale to the microscale realm inhabited by the neurograin devices
discussed here. There is thus a signiﬁcant need for developing methods for robust
hermetic sealing with thin ﬁlms that are both bio- and process-compatible with
CMOS-integrated circuits. Although a number of thin-ﬁlm polymer candidates have
been identiﬁed as suitable for subacute implants (parylene, PDMS, etc.), these are
unlikely to perform acceptably in chronic use.
We have developed an atomic layer deposition (ALD) technique to deposit highly
uniform materials for conformal hermetic sealing of sub-mm-sized active planar
ASIC chiplets [14]. The method provides ready scalability via high throughput par-
allel processing of thousands of neurograins, where each device is fully enclosed by
a very thin (∼100 nm) electromagnetically transparent dielectric ﬁlm (Fig. 13). The

434
F. Laiwalla et al.
Fig. 13 Hermetic sealing by conformal 100 nm thin multilayer stacks of ALD-grown SiO2/HfO2
multilayers [14]
ﬁlms are synthesized using Picosun™R-200 Advanced reactor in thermal ALD-
regime which is conﬁgured to meet the challenges for pinhole-free deposition of,
for example, high-ﬁeld gate oxides for ﬁeld effect transistors at the most advanced
process nodes used by semiconductor industry. For the purpose of neurograin
hermetic encapsulation, we utilize multilayer thin ﬁlms comprising alternating
layers of HfO2 and SiO2 with a total thickness of 100 nm. The deposition is part of
the post fabrication process and occurs at temperatures between 150 ◦C and 300 ◦C,
which are compatible with our semiconductor chiplets. The hermetic seal integrity
and robustness were validated through an accelerated aging test with application
of thermal stress by immersion of encapsulated devices in saline at 87 ◦C. Test
structures enabling quantiﬁcation of water/ionic ingress (leakage currents) as well
as active microelectronic chiplets were evaluated for a prolonged period of time
(equivalent to >10 years under physiologic conditions). Additionally, a subset of
encapsulated chiplets were wirelessly powered through the duration of the test to
observe any possible impact of a persistent electromagnetic ﬁeld (at ∼1 GHz). A
majority of samples continued to operate for >200 days without any measurable
degradation in electronic performance, in spite of the continued presence of an
electromagnetic ﬁeld and the potential consequent heating of the chiplet. Failed
samples were analyzed by scanning electron microscopy (SEM) (Fig. 13) and
did not demonstrate any grossly visible interruptions in the ALD coating. To the
best of our knowledge, the obtained results represent a ﬁrst demonstration where
hermeticity of active electronic microdevices by ultrathin HfO2/SiO2 multilayer
ﬁlm coatings suggests that impermeability in a body ﬂuid-like environment at
physiological temperatures can reach acceptable longevity required of such implants
in chronic use.

Challenges for Large-Scale Brain-Machine Interfaces
435
3.5
Experimental Validation In Vitro and In Vivo: Recording
and Microstimulation
Demonstrating implant performance in a representative biological environment is
a critical benchmark bridging neuroengineering of concepts from benchtop toward
translational relevance. We have validated the neurograin system described in this
chapter in two different conﬁgurations, for (i) ECoG recording and (ii) electrical
microstimulation by ensembles of wireless neurograins, respectively.
(i) Multichannel recording by small ensembles of neurograins. Neurophysiological
validation of recording performance of a neurograin array has been assessed
on mouse brain slices while monitoring epileptic seizure activity. The wireless
three-coil energy-harvesting and telecommunication system was integrated with
a typical in vitro physiological chamber. Seizure activity was induced through a
combination of chemical and electrical stimulation, and the latter was applied
using an external microwire. A tightly packed array of neurograins spanned
across the available area of mouse cortex available of the brain slice, recording
ﬁeld potentials akin to ECoG in this particular geometry [21].
The ex vivo brain slice validation was complemented by acute in vivo
endeavors, whereby a multichannel Neurograin array was surgically implanted
in rat cortex, and utilized to make wireless measurements of spontaneous and
evoked ECoG activity under ketamine anesthesia. The size of a craniotomy
facilitating implantation of this large number of Neurograins was not compatible
with a survival procedure, but ongoing work in the group is targeting approaches
for chronic implantation [19].
Figure 14 highlights the in vitro and in vivo validation endeavors, showing
examples of performance of small ensembles of neurograins, where their numbers
are limited by the available cortical area in small-animal models. A nine-neurograin
ensemble (Fig. 14a) in a brain slice captures ﬁeld potentials with characteristic slow
responses prior to seizure induction (with timed electrical stimulation). Multiple
neurograin nodes record similar ﬁeld potentials after electrical stimulation (350 μA,
100 μs pulses at 40 Hz rate), demonstrating the spatial spread and propagation of
the point microstimulation under physiologic conditions (Fig. 14b). In an alternative
experiment, a toxin (picrotoxin) is applied to lower the excitation bias of brain
tissue, enabling onset of epileptiform activity in the brain slice with the subsequent
delivery of electrical stimulation. Figure 14c shows the seizure activity with pre-ictal
discharges and rhythmic bursts while Fig. 14d shows the development of seizure in
the spectral domain. Figure 14e demonstrates a 56-channel prototype wireless sys-
tem, currently in use for early in vivo validation. These results represent one set of
proof-of-concept validation of the engineering functionality of a multinode wireless
neurograin neural recording network, encompassing the full-system implementation
from the onboard neural ampliﬁers to the multichannel TDMA wireless network
over time periods consistent with a realistic neural prosthetic application.

436
F. Laiwalla et al.
Fig. 14 In vitro and in vivo demonstration of the neurograin system: (a) brain slice recording
setup; (b) spatially distributed ﬁeld response recording from neurograin. The red dots indicate the
timing of 100 μsec pulses of electrical stimulation; (c) and (d) show results of seizure monitoring
over a 10-s period; (e) in vivo implantation of a 56 neurograin array on rat cortex, and wirelessly
recovered data. In the raw multichannel data (subsequently demodulated), the red dots indicate
pulse detection while the blue dots correspond to synchronized 32-bits pulses [21]
(ii) In vivo multichannel electrical microstimulation by neurograins in rats. In
keeping with the ultimate aspiration for adaptive, bidirectional neural access,
we have developed neurograin constructs enabling wireless patterned electrical
stimulation as described in Sect. 3.2 above. Beyond benchtop validation of
a ∼100 microdevice network for space-time-patterned microstimulation, we
have also assessed the capability of these programmable, wireless microstim-
ulating neurograins in vivo rodent experiments. A 48-device ensemble was
implanted into the epicortical space in a rat (limited by the area constraint
for safe surgical access, ∼0.3 cm2). Passive recording electrodes were placed
in conjunction with the wireless microstimulators in order to capture the
induced cortical responses. Implanted microdevices were wireless programmed
(through a TDMA ASK-PWM command) to sequentially deliver a 200 ms

Challenges for Large-Scale Brain-Machine Interfaces
437
Fig. 15 Applying space-time wirelessly controlled electrical microstimulation by an ensemble of 48 neurograins in an in vivo rat model [21]. The neural
response is recorded by standard microwires probes placed both proximally and distal to stimulation sites. The channel numbers refer to the microelectrode
recording

438
F. Laiwalla et al.
long stimulation pulse train with a 100 Hz frequency. This is demonstrated
in Fig. 15, which highlights the downlink and stimulation artifact captured by
recording electrodes, as well as the stimulation-evoked local ﬁeld potentials
(LFP) captured by a distal recording electrode [21]. The clear appearance of
a 100 Hz oscillatory wave in a distal electrode, in absence of a concurrent
stimulation artifact, provides compelling evidence for a triggered network
response, induced due to the stimulation, and having propagated across and
thus detectable in distal parts of the cortex.
4
Summary
The goal of this chapter has been to provide one lens into neuroengineering tools
for accessing brain circuits at high space-and time resolution. Recent developments
in wireless multichannel neural recording and stimulation have been highlighted,
with a particular view toward building large-scale cortical interfaces in the future.
We have not touched on the opportunities in mating the next generations of
neural implants with computational neuroscience, particularly with tools for decod-
ing/encoding neural data from large neural populations through leveraging emerging
machine learning techniques or harnessing the power of cloud computing.
The authors acknowledge with gratitude the many collaborators whose work is
highlighted in this chapter. Regarding research on the implantable microdevices,
we especially thank the following: Jihun Lee, Stefan Sigurdsson, Ah-Hyoung Lee,
and Huy Cu at Brown University; Joonsoo Jeong (formerly at Brown University,
and currently at Pusan National University, S. Korea); Peter Asbeck, Ramesh Rao,
Patrick Mercier, Jason Huang, Siwei Li, Siyuan Yu, Lingxiao Cui, and Sravya Alluri
at University of California San Diego; Steven Shellhammer at Qualcomm. Initial
phases of the research were supported by DARPA.
References
1. Ahmadi, N., Cavuto, M.L., Feng, P., Leene, L.B., Maslik, M., Mazza, F., . . . Jackson, A.:
Towards a distributed, chronically-implantable neural interface. In: 2019 9th International
IEEE/EMBS Conference on Neural Engineering (NER), pp. 719–724. IEEE (2019)
2. Bensmaia, S.J., Miller, L.E.: Restoring sensorimotor function through intracortical interfaces:
progress and looming challenges. Nat. Rev. Neurosci. 15(5), 313–325 (2014)
3. Borton, D.A., Yin, M., Aceros, J., Nurmikko, A.: An implantable wireless neural interface for
recording cortical circuit dynamics in moving primates. J. Neural Eng. 10(2), 026010 (2013)
4. Dutta, B., Andrei, A., Harris, T.D., Lopez, C.M., O’Callahan, J., Putzeys, J., . . . Welken-
huysen, M.: The Neuropixels probe: a CMOS based integrated microsystems platform for
neuroscience and brain-computer interfaces. In: 2019 IEEE International Electron Devices
Meeting (IEDM), pp. 10–11). IEEE. (2019)
5. Flesher, S.N., Collinger, J.L., Foldes, S.T., Weiss, J.M., Downey, J.E., Tyler-Kabara, E.C., . . .
Gaunt, R.A.: Intracortical microstimulation of human somatosensory cortex. Sci. Transl. Med.
8(361), 361ra141–361ra141 (2016)

Challenges for Large-Scale Brain-Machine Interfaces
439
6. Gao, P., Trautmann, E., Byron, M.Y., Santhanam, G., Ryu, S., Shenoy, K., Ganguli, S.: A theory
of multineuronal dimensionality, dynamics and measurement. BioRxiv 214262 (2017)
7. Ghovanloo, M., Najaﬁ, K.: A compact large voltage-compliance high output-impedance
programmable current source for implantable microstimulators. IEEE Trans. Biomed. Eng.
52(1), 97–105 (2004)
8. Harrison, R.R.: A low-power integrated circuit for adaptive detection of action potentials
in noisy signals. In: Proceedings of the 25th Annual International Conference of the IEEE
Engineering in Medicine and Biology Society (IEEE Cat. No. 03CH37439), vol. 4, pp. 3325–
3328. IEEE (2003)
9. Heelan, C., Nurmikko, A.V., Truccolo, W.: FPGA implementation of deep-learning recurrent
neural networks with sub-millisecond real-time latency for BCI-decoding of large-scale neural
sensors (104 nodes). In: Proceedings of the 40th Annual International Conference of the IEEE
Engineering in Medicine and Biology Society (EMBC), pp. 1070–1073. IEEE (2018)
10. Heelan, C., Lee, J., O’Shea, R., Lynch, L., Brandman, D.M., Truccolo, W., Nurmikko, A.V.:
Decoding speech from spike-based neural population recordings in secondary auditory cortex
of non-human primates. Commun. Biol. 2(1), 1–12 (2019)
11. Hochberg, L.R., Bacher, D., Jarosiewicz, B., Masse, N.Y., Simeral, J.D., Vogel, J., . . .
Donoghue, J.P.: Reach and grasp by people with tetraplegia using a neutrally controlled robotic
arm. Nature 485(7398), 372–375 (2012)
12. Hoogerwerf, A.C., Wise, K.D.: A three-dimensional microelectrode array for chronic neural
recording. IEEE Trans. Biomed. Eng. 41(12), 1136–1146 (1994)
13. Huang, J., Laiwalla, F., Lee, J., Cui, L., Leung, V., Nurmikko, A., Mercier, P.P.: A 0.01-mm 2
mostly digital capacitor-less AFE for distributed autonomous neural sensor nodes. IEEE Solid-
State Circ. Lett. 1(7), 162–165 (2018)
14. Jeong, J., Laiwalla, F., Lee, J., Ritasalo, R., Pudas, M., Larson, L., et al.: Conformal
hermetic sealing of wireless microelectronic implantable chiplets by multilayered atomic layer
deposition (ALD). Adv. Funct. Mater. 29(5), 1806440 (2019)
15. Jones, K.E., Campbell, P.K., Normann, R.A.: A glass/silicon composite intracortical electrode
array. Ann. Biomed. Eng. 20(4), 423–437 (1992)
16. Khalifa, A., Karimi, Y., Wang, Q., Garikapati, S., Montlouis, W., Stana´cevi´c, M., . . . Etienne-
Cummings, R.: The microbead: a highly miniaturized wirelessly powered implantable neural
stimulating system. IEEE Trans. Biomed. Circ. Syst. 12(3), 521–531 (2018)
17. Laiwalla, F., Lee, J., Lee, A.H., Mok, E., Leung, V., Shellhammer, S., . . . Nurmikko, A.:
A distributed wireless network of implantable sub-mm cortical microstimulators for brain-
computer interfaces. In: 2019 41st Annual International Conference of the IEEE Engineering
in Medicine and Biology Society (EMBC), pp. 6876–6879. IEEE (2019)
18. Lee, A.-H., Lee, J., Laiwalla, F., Leung, V., Huang, J., Nurmikko, A., Song, Y.-K.: A scalable
and low stress post-CMOS processing technique for implantable neural interfaces. Submitted
to Micromachines (2020)
19. Lee, J., Leung, V., Lee, A.-H., Huang, J., Asbeck, P., Mercier, P.P., Shellhammer, S., Larson,
L., Laiwalla, F., Nurmikko, A.: Neural recording and stimulation using wireless networks of
microimplants. Nat. Electron. 4(8), 604–614 (2021)
20. Lee, J., Laiwalla, F., Jeong, J., Kilfoyle, C., Larson, L., Nurmikko, A., . . . Leung, V.W.:
Wireless power and data link for ensembles of sub-mm scale implantable sensors near 1GHz.
In: 2018 IEEE Biomedical Circuits and Systems Conference (BioCAS), pp. 1–4. IEEE (2018)
21. Lee, J., Mok, E., Huang, J., Cui, L., Lee, A.H., Leung, V., . . . Rao, R.:. An implantable wireless
network of distributed microscale sensors for neural applications. In: 2019 9th International
IEEE/EMBS Conference on Neural Engineering (NER), pp. 871–874. IEEE (2019)
22. Leung, V.W., Lee, J., Li, S., Yu, S., Kilfovle, C., Larson, L., Nurmikko, A., Laiwalla F.:
A CMOS distributed sensor system for high-density wireless neural implants for brain-
machine interfaces. In ESSCIRC 2018-IEEE 44th European Solid State Circuits Conference
(ESSCIRC), pp. 230–233. IEEE (2018)
23. Leung, V.W., Cui, L., Alluri, S., Lee, J., Huang, J., Mok, E., Shellhammer, S.: Distributed
microscale brain implants with wireless power transfer and Mbps bi-directional networked

440
F. Laiwalla et al.
communications. In 2019 IEEE Custom Integrated Circuits Conference (CICC), pp. 1–4. IEEE
(2019)
24. Musk, E.: An integrated brain-machine interface platform with thousands of channels. J. Med.
Internet Res. 21(10), e16194 (2019)
25. Seo, D., Neely, R.M., Shen, K., Singhal, U., Alon, E., Rabaey, J.M., . . . Maharbiz, M.M.:
Wireless recording in the peripheral nervous system with ultrasonic neural dust. Neuron 91(3),
529–539 (2016)
26. Simeral, J.D., Hosman, T., Saab, J., Flesher, S.N., Vilela, M., Franco, B., Kelemen, J.N. et al.:
Home use of a percutaneous wireless intracortical brain-computer interface by individuals with
tetraplegia. IEEE Trans. Biomed. Eng. 68(7) 2313–2325 (2021)
27. Simeral, John D., Thomas Hosman, Jad Saab, Sharlene N. Flesher, Marco Vilela, Brian Franco,
Jessica N. Kelemen et al. Home use of a percutaneous wireless intracortical brain-computer
interface by individuals with tetraplegia. IEEE Transactions on Biomedical Engineering
68(7) 2313–2325 (2021)
28. Theilmann, P.T., Presti, C.D., Kelly, D.J., Asbeck, P.M.: A-W complementary bridge rectiﬁer
with near zero turn-on voltage in SOS CMOS for wireless power supplies. IEEE Trans. Circ.
Syst. Regular Papers. 59(9), 2111–2124 (2012)
29. Tsai, D., Sawyer, D., Bradd, A., Yuste, R., Shepard, K.L.: A very large-scale microelectrode
array for cellular-resolution electrophysiology. Nat. Commun. 8(1), 1–11 (2017)
30. Yang, K., Dong, Q., Blaauw, D., Sylvester, D.: 8.3 A 553F 2 2-transistor ampliﬁer-based Phys-
ically Unclonable Function (PUF) with 1.67% native instability. In: 2017 IEEE International
Solid-State Circuits Conference (ISSCC), pp. 146–147. IEEE (2017)
31. Yeon, P., Bakir, M.S., Ghovanloo, M.: Towards a 1.1 mm 2 free-ﬂoating wireless implantable
neural recording SoC. In: 2018 IEEE Custom Integrated Circuits Conference (CICC), pp. 1–4.
IEEE (2018)
32. Yin, M., Borton, D.A., Aceros, J., Patterson, W.R., Nurmikko, A.V.: A 100-channel hermet-
ically sealed implantable device for chronic wireless neurosensing applications. IEEE Trans.
Biomed. Circ. Syst. 7(2), 115–128 (2013)

