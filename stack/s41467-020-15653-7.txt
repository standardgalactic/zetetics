ARTICLE
Tunable genetic devices through simultaneous
control of transcription and translation
Vittorio Bartoli
1,2, Grace A. Meaker
3, Mario di Bernardo
1,2,4 & Thomas E. Gorochowski
1,5✉
Synthetic genetic circuits allow us to modify the behavior of living cells. However, changes in
environmental conditions and unforeseen interactions with the host cell can cause deviations
from a desired function, resulting in the need for time-consuming reassembly to ﬁx these
issues. Here, we use a regulatory motif that controls transcription and translation to create
genetic devices whose response functions can be dynamically tuned. This allows us, after
construction, to shift the on and off states of a sensor by 4.5- and 28-fold, respectively, and
modify genetic NOT and NOR logic gates to allow their transitions between states to be
varied over a >6-fold range. In all cases, tuning leads to trade-offs in the fold-change and the
ability to distinguish cellular states. This work lays the foundation for adaptive genetic circuits
that can be tuned after their physical assembly to maintain functionality across diverse
environments and design contexts.
https://doi.org/10.1038/s41467-020-15653-7
OPEN
1 BrisSynBio, University of Bristol, Life Sciences Building, Tyndall Avenue, Bristol, UK. 2 Department of Engineering Mathematics, University of Bristol,
Woodland Road, Bristol, UK. 3 School of Biosciences, Cardiff University, Museum Avenue, Cardiff, UK. 4 Department of Electrical Engineering and Information
Technology, University of Naples Federico II, Via Claudio 21, Napoli, Italy. 5 School of Biological Sciences, University of Bristol, Tyndall Avenue, Bristol, UK.
✉email: thomas.gorochowski@bristol.ac.uk
NATURE COMMUNICATIONS |   (2020) 11:2095 | https://doi.org/10.1038/s41467-020-15653-7 | www.nature.com/naturecommunications
1
1234567890():,;

G
enetic regulatory circuits govern when and where genes
are expressed in cells and control core biochemical pro-
cesses such as transcription and translation1,2. The ability
to synthesize DNA encoding engineered genetic circuits offers a
means to expand the capabilities of a cell and reprogram its
behavior1,3. Synthetic genetic circuits have been built to imple-
ment
computational
operations4–10,
diverse
dynamic
behaviors11,12, and even coordinate multicellular actions13–15.
The task of reprograming living cells is simpliﬁed by employing
genetically encoded devices that use common input and output
signals1,2,7,8. This allows the output of one device to be connected
to the input of another to create circuits implementing more
complex functionalities. Signals can take many forms, but one of
the most commonly used is RNA polymerase (RNAP) ﬂux which
can be guided by promoters to speciﬁc points in a circuit’s
DNA7,16. The response function of a genetic device captures how
input signals map to output signals at steady state1,7,16. By
ensuring the response functions of two devices are compatible,
that is, the range of the outputs from the ﬁrst device spans the
necessary range of inputs for the second device, larger circuits
with desired functions can be constructed17. Matching of com-
ponents is vital in circuits where devices exhibit switching
behaviors (e.g., Boolean logic) to ensure input signals are sufﬁ-
ciently separated to trigger required transitions between “on” and
“off ” states as signals propagate through the circuit.
Although the use of characterized genetic devices has enabled
the automated design of large circuits7,18, they are often sensitive
to many factors. Differences in host physiology19–21 and interac-
tions between genetic parts and the host cell22–26 can all affect the
response function of a device and, subsequently, its compatibility
within a circuit. This makes the creation of robust genetic circuits
a challenge. Even when considering controlled lab conditions, a
genetic circuit often needs to be reassembled from scratch multiple
times until a working combination of parts is found. This is time-
consuming and costly, and often has to be repeated if the circuit is
deployed into slightly different conditions or host strains.
In this work, we tackle this problem by developing genetic
devices whose response functions can be dynamically tuned after
circuit assembly to correct for unwanted changes in their beha-
vior. The ability to tune/modify the steady-state input–output
relationship is achieved by employing a simple regulatory motif.
We show how this motif can be connected to small molecule
sensors to characterize its function, and then illustrate its use in
practice by integrating it into genetic NOT and NOR logic gates27
to tune their transition points between “on” and “off ” states.
These capabilities make the devices more broadly compatible with
other components1,7,17, but their use comes at a cost. As we tune
each device, a decrease in the dynamic range is observed and it
becomes more difﬁcult to differentiate cellular states due to
variability in gene expression across a population. Mathematical
modeling is used to help us better understand these limitations
and derive principles to further optimize device designs. This
work is a step towards the synthesis of adaptive genetic circuitry
where individual components tune their response function to
ensure robust system-level behaviors are maintained no matter
the genetic, cellular, or environmental context.
Results
Constructing a tunable expression system. To allow for
the response of a genetic device to be dynamically modiﬁed, we
developed a tunable expression system (TES) based on a simple
regulatory motif where two separate promoters control the tran-
scription and translation rates of a gene of interest (Fig. 1a). By
using promoters as control inputs, it is possible to easily connect a
TES to existing genetic components/circuitry or even endogenous
transcriptional signals within a cell. The TES contains a toehold
switch (THS) that enables the translation initiation rate of the gene
of interest to be varied by the relative concentration of a tuner
small RNA (sRNA)6,28. The main component of the THS is a 92 bp
DNA sequence that encodes a structural region and a ribosome
binding site (RBS) used to drive translation of a downstream
protein coding region. This is expressed from a promoter that acts
as the main input to the TES (Fig. 1a). When transcribed, the
structural region of the THS mRNA folds to form a hairpin loop
secondary structure that hampers ribosome accessibility to the RBS
and reduces its translation initiation rate. This structure is dis-
rupted by a second component, a 65 nt tuner sRNA that is com-
plementary to the ﬁrst 30 nt of the THS28. The tuner sRNA is
expressed from a second promoter, which acts as a tuner input to
the device (Fig. 1a). Complementarity between the tuner sRNA and
a short unstructured region of the THS enables initial binding,
making it thermodynamically favorable for the sRNA to unfold the
secondary structure of the THS through a branch migration pro-
cess. This makes the RBS more accessible to ribosomes, which
increases the translation initiation rate. Relative concentrations of
the THS mRNA and tuner sRNA (controlled by the input and
tuner promoters) enable the rate of translation initiation to be
varied over a 100-fold range for the THS design (variant 20) we
selected28 (“Methods”). However, THS designs exist which allow
for up to a 400-fold change in translation initiation rates6,28. We
selected as main and tuner inputs for the TES the output pro-
moters of two sensors, Ptet and Ptac, that respond to anhydrote-
tracycline
(aTc)
and
isopropyl
β-D-1-thiogalactopyranoside
(IPTG), respectively (Fig. 1b). Yellow ﬂuorescent protein (YFP)
was used as the output (Fig. 1b) to allow us to measure the rate of
protein production in single cells using ﬂow cytometry.
Characterization of the device was performed in Escherichia
coli cells grown in different concentrations of aTc (input) and
IPTG (tuner). Steady-state ﬂuorescence measurements were taken
using ﬂow cytometry and promoter activities of the main and
tuner inputs were measured in relative promoter units (RPUs) to
allow for direct comparisons (“Methods”; Supplementary Fig. 1).
A further advantage of characterizing our devices in RPUs is that
the data become compatible with genetic design automation
software such as Cello7, allowing our parts to be interfaced with a
large library of existing sensors and logic gates27,29.
For a ﬁxed tuner promoter activity, we observed a sigmoidal
increase in output YFP ﬂuorescence as the input promoter
activity increased from 0.002 to 6.6 RPU (Fig. 1c). As the activity
of the tuner promoter increased from 0.002 to 2.6 RPU, the entire
response function shifted upwards to higher YFP ﬂuorescence.
Notably, this shift was not uniform, with larger relative increases
seen for lower input promoter activities; 28-fold versus 4.5-fold
for inputs of 0.002 and 6.6 RPU, respectively (Fig. 1c). Closer
analysis of the ﬂow cytometry data (Fig. 1d) showed that these
changes arose from the distributions of YFP ﬂuorescence for low
and high inputs shifting uniformly together as the tuner promoter
activity was increased. Therefore, even though a similar relative
difference between outputs for low and high inputs (also referred
to as the dynamic range) was observed for all tuner inputs, when
the tuner input was low, the distributions were virtually identical
to the autoﬂuorescence of the cells (Fig. 1d). This led to even
small absolute differences in the median values between low and
high input states resulting in high fold changes.
Flow cytometry data also showed a signiﬁcant overlap in the
output YFP ﬂuorescence distributions for low and high input
promoter activities (Fig. 1d). Many applications require that on
and off states in a system are well separated so that they can be
accurately distinguished. To assess this feature, we calculated the
fractional overlap between the output YFP ﬂuorescence distribu-
tions for low and high input promoter activities (“Methods”). We
ARTICLE
NATURE COMMUNICATIONS | https://doi.org/10.1038/s41467-020-15653-7
2
NATURE COMMUNICATIONS |   (2020) 11:2095 | https://doi.org/10.1038/s41467-020-15653-7 | www.nature.com/naturecommunications

found a constant intersection of ~70% across all tuner promoter
activity levels (Fig. 1e), which resulted from the similar shifts we
saw in output across all input promoter activities (Fig. 1d).
To better understand these effects, we derived a deterministic
ordinary differential equation (ODE) model of the system
(Supplementary Note 1). Simulations using biologically realistic
parameters (Supplementary Table 1) showed similar qualitative
behavior to the experiments; increasing tuner promoter activity
shifted the response curve to higher output protein production
rates (Fig. 1f). However, unlike the experiments, increasing the
tuner promoter activity resulted in a smaller increase in the fold
change in the output between low and high inputs (Fig. 1g,
bottom). The limiting effect that the tuner sRNA can have is a
possible mechanism that could account for the nonlinear
response observed in the experiments, where “on” states did
not increase as quickly as “off ” states as the tuner activity
increased (Fig. 1g, top). Tuner sRNA concentration was ﬁxed for
each response function. Therefore, it could have been higher than
the concentration of THS transcript (i.e., nonlimiting) when the
main input was low, while limiting the output when the main
input was high.
Another potential cause of this nonlinear response could be
retroactivity that occurs when the behavior of components in a
biological circuit changes once they become interconnected30,31.
Such effects break modularity and make it difﬁcult to predict
circuit behavior. To explore this possibility, we coupled our
existing model to another that is able to capture retroactivity-
like effects due to shifts in ribosome allocation between
endogenous genes and synthetic constructs, such as the TES
(Supplementary Note 2)23,30,31. Ribosomes are a key cellular
resource and ﬂuctuations in their availability due to the burden
of a synthetic construct can cause drops in protein synthesis
rates across the cell, affecting upstream components in a
circuit20,22,24,26. Comparisons between the original and coupled
models, showed that retroactivity could have an impact for
biologically realistic parameters, but only when the output
caused signiﬁcant cellular burden and only for the most highly
expressed outputs (Supplementary Fig. 2).
Design and assembly of a tunable genetic NOT gate. Some
genetic devices rely on the expression of proteins such as tran-
scription factors to implement basic logic that can be composed
to carry out more complex decision-making tasks4,7,32. One such
device is a NOT gate, which has a single input and output27. NOT
gates invert their input such that the output is on if the input is
off and vice versa. Such a behavior can be implemented by using
promoters as the input and output, with the input promoter
driving expression of a repressor protein that binds to the DNA
Tuner, Ptac (RPU)
(Concentration)
0
10−1 100 101
100
101
102
103
THS20
Input
yfp
RiboJ
Tuner
Output
YFP
(active)
(inactive)
sRNA20
T2
T1
Input
Tuner
Output
TX
TL
a
Output (protein)
Tuner (RNAP/min)
Input, Ptet (RPU)
Output, YFP (a.u.)
Tuner, Ptac (RPU)
b
Input
(aTc)
Ptet
lacI
Sensor Modules
Ptac
tetR
Tuner
(IPTG)
Input
Output
Output
TX
TL
YFP
Tunable Expression System
Fluorescence (a.u.)
Intersection
101
103
105
Count
10-1
101
0
102
10-2 100 102
Input (RNAP/min)
104
(RNAP/s)
(RNAP/s)
(RNAP/s)
(protein/s)
0.0
0.5
1.0
(RPU, RNAP/min)
Output
Model
Exp.
c
f
d
e
g
10-1
103
105
10-1
Tuner
Fig. 1 Design and characterization of a tunable expression system (TES). a Schematic of the TES (top) and genetic implementation using a THS (variant
20)28 to regulate translation initiation rate of an output protein (bottom, dashed box). Yellow ﬂuorescent protein (YFP) is used as the output and T1 and T2
correspond to the transcriptional terminators L3S3P11 and L3S2P21, respectively65. b Genetic design of the sensor modules used to drive the main and
tuner inputs to the TES. c Experimentally measured response functions for the TES. Points denote the average of three biological replicates and error bars
show ±1 standard deviation. Each line shows a ﬁtted Hill function for a ﬁxed tuner input (color scale light–dark: 0.002, 0.03, 0.15, 0.43, 0.9, 2.6 RPU).
d Flow cytometry distributions of output YFP ﬂuorescence when the tuner promoter activity is low (bottom; 0.002 RPU) and high (top; 2.6 RPU). Black
outlined distributions correspond to a high input promoter activity (6.6 RPU) and the ﬁlled red distributions to a low input promoter activity (0.002 RPU).
Cell autoﬂuorescence is shown by the dashed gray line. e Fraction of intersection between YFP ﬂuorescence distributions for low (0.002 RPU) and high
(6.6 RPU) inputs across varying tuner promoter activities. Points denote the average of three biological replicates and error bars show ±1 standard
deviation. f Response functions from a deterministic model of the TES (Supplementary Note 1). Output shown as the steady-state protein level. Line color
corresponds to the promoter activity of the tuner input (light–dark: 0.0001, 0.06, 0.3, 1.5, 7.6, 38, 190 RNAP/min). g Comparison of the output for high
(ﬁlled circles; 6.6 RPU) and low (unﬁlled circles; 0.002 RPU) inputs across a range of tuner promoter activities (Experiment: 0.002, 0.03, 0.15, 0.43, 0.9,
2.6 RPU; Model: 0.0001, 0.3, 1.5, 7.6, 38, 190 RNAP/min). Source data are available in the Source Data ﬁle.
NATURE COMMUNICATIONS | https://doi.org/10.1038/s41467-020-15653-7
ARTICLE
NATURE COMMUNICATIONS |   (2020) 11:2095 | https://doi.org/10.1038/s41467-020-15653-7 | www.nature.com/naturecommunications
3

of a constitutive output promoter. When the input promoter is
inactive, the repressor is not synthesized and the constitutive
output promoter is in an active/on state. However, once the input
promoter is activated, the repressor is expressed which binds the
output promoter and represses/turns off its activity.
Because the activity range of promoters varies, the transition
point (where sufﬁcient concentrations of repressor are present to
cause strong repression of the output promoter) may make it
impossible to connect other devices and ensure a signal is
correctly propagated. For example, the output promoter of a weak
sensor system acting as input to a NOT gate with a high
transition point may produce insufﬁcient repressor, causing the
output promoter to be continually active. These incompatibilities
can sometimes be corrected by modifying other regulatory
elements in the design. In the case of a repressor-based NOT
gate, while the promoters cannot be easily changed, the
translation initiation rate can be varied in bacteria by altering
the RBS for the repressor gene. Increasing the RBS strength
causes more repressor protein to be produced for the same input
promoter activity, shifting the transition point to a lower
value7,27. While such modiﬁcations can ﬁx issues with device
compatibility, they require reassembly of the entire genetic device.
Given that the TES allows for the rates of both transcription
and translation to be dynamically controlled, we attempted to
create a tunable NOT gate integrating the TES to allow its
response function, and crucially its transition point, to be altered
after physical assembly. We chose an existing NOT gate design27
that uses the PhlF repressor to control the activity of an output
PphlF promoter (Fig. 2a). Expression of PhlF was controlled by the
TES, replacing the YFP reporter protein in the original TES
design (Fig. 1a). Unlike the TES, the tunable NOT gate uses
promoters for both inputs and outputs allowing it to be easily
connected to other devices that use RNAP ﬂux as an input/output
signal7,16 (Fig. 2a).
To enable characterization of the tunable NOT gate, the output
promoter PphlF was used to drive expression of YFP. Measure-
ments were taken using ﬂow cytometry for cells harboring the
device in varying concentrations of aTc and IPTG, and steady-
state response functions were generated (Fig. 2b, c). As expected,
these showed a negative sigmoidal shape with transition points
(corresponding to K values in the Hill function ﬁtting to the
experimental data) that varied over a sevenfold range (Fig. 2b).
We also found that increases in the tuner promoter activity led to
transitions at lower activity levels for the input promoter. The
range of transition points achieved by our device covered a high
proportion (35%) of the largest collection of repressor-based
NOT gates built to date (total of 20 variants; Fig. 2d)7.
These
results
demonstrate
the
ability
for
the
TES
to
dynamically alter a key characteristic of a NOT gate’s response
function and improve its compatibility with other genetic devices.
However, tuning came at a cost; it resulted in a drop in the fold
change between low and high outputs (Fig. 2e) and an increase in
the overlap between output YFP ﬂuorescence distributions,
making on and off states difﬁcult to distinguish (Fig. 2f).
Boosting sRNA levels improves device performance. For the
THS to function correctly, it is essential that the sRNA reaches a
sufﬁciently high concentration relative to the THS transcript to
ensure the associated RBS is in a predominantly exposed state28.
In our design, the tuner promoter Ptac has less than half the
maximum strength of the main input promoter Ptet (Supple-
mentary Fig. 1). Furthermore, although the tuner sRNA contains
a hairpin to improve its stability, sRNAs are generally more
quickly degraded than normal transcripts33,34.
To better understand the role that the THS transcript to tuner
sRNA ratio had on the performance of the TES, we used our
mathematical model of the system (Supplementary Note 1) to
explore how various key parameters (e.g., transcription rates and
0
100
101
2
4
0.0
0.5
1.0
a
K value (RPU)
(active)
(inactive)
THS20
Ptet
phlF
RiboJ
Ptac
PhlF
Input
(aTc)
Tuner
(IPTG)
yfp
PphlF
YFP
Output
sRNA20 T1
T3
Input
Tuner
Output
b
e
d
Tunable NOT gate
Input, Ptet (RPU)
Output (RPU)
Tuner, Ptac (RPU)
Intersection
Fold-change
f
10-3
10-1
101
c
Tuner, Ptac (RPU)
Fluorescence (a.u.)
102 103
105
Count
104
10-1
101
0
10-1
101
0
(RNAP/s)
(RNAP/s)
(RNAP/s)
0.01 0.1
SrpR
QacR
3srA
3hlF
LmrA
LitR
IcaRA
HlyIIR
BetI
B0 3R1
AmtR
AmeR
RiboJ
Tuner, Ptac (RPU)
Fig. 2 Design and characterization of a tunable NOT gate. a Schematic of the tunable NOT gate (top) and genetic implementation embedding the TES
(bottom, dashed box). Yellow ﬂuorescent protein (YFP) expression is driven by the output promoter and T1 and T3 correspond to the transcriptional
terminators L3S3P11 and ECK120033737, respectively65. b Experimentally measured response functions of the tunable NOT gate. Points denote the
average of three biological replicates and error bars show ±1 standard deviation. Each line shows a ﬁtted Hill function for a ﬁxed tuner input (color scale
light–dark: 0.002, 0.03, 0.15, 0.43, 0.9, 2.6 RPU). c Flow cytometry distributions of the output YFP ﬂuorescence from the tunable NOT gate when the tuner
promoter activity is low (bottom; 0.002 RPU) and high (top; 2.6 RPU). Black outlined distributions correspond to a high input promoter activity (1.5 RPU)
and the ﬁlled blue distributions to a low input promoter activity (0.002 RPU). d Comparison of the switching point (K value) for each repressor-based NOT
gate from Cello7 (black circles) to the range achievable by the tunable NOT gate (red crosses and shaded regions). e Fraction of intersection between
output YFP ﬂuorescence distributions for low (0.002 RPU) and high (1.5 RPU) inputs across varying tuner promoter activities. Points denote the average of
three biological replicates and error bars show ±1 standard deviation. f Fold change in the median output YFP ﬂuorescence between low (0.002 RPU) and
high (1.5 RPU) inputs across varying tuner promoter activities. Points denote the average of three biological replicates and error bars show ±1 standard
deviation. Source data are available in the Source Data ﬁle.
ARTICLE
NATURE COMMUNICATIONS | https://doi.org/10.1038/s41467-020-15653-7
4
NATURE COMMUNICATIONS |   (2020) 11:2095 | https://doi.org/10.1038/s41467-020-15653-7 | www.nature.com/naturecommunications

binding afﬁnities) affected the response function of the device.
Using biologically realistic ranges of parameters (Supplementary
Table 1), we found that for lower sRNA transcription rates the
output response function could be shifted to maintain a similar
fold change between low and high output states (Fig. 3a). At these
low THS/sRNA ratios the translation rate from the THS
transcript is limited by the sRNA concentration. However, as
the sRNA transcription rate increased, a transition point was seen
where for low THS transcription rates the sRNA is in excess
the resulting THS transcript concentration limits the output
protein production rate (Fig. 3a). In contrast, at high THS
transcription rates, the sRNAs become limiting again but allow
for a relatively higher output protein production rate causing a
larger fold change in the response function (Fig. 3a). Further
stochastic modeling of the system showed that increasing sRNA
transcription rate also reduced variability in the distribution of
protein production rates across a population and lowered the
fractional intersection between low (off) and high (on) output
states (Fig. 3b).
To experimentally verify the beneﬁt of increasing the sRNA
transcription rate, we built a complementary sRNA booster
plasmid that contained a high-copy pColE1 origin of replication
(50–70 copies per cell)35 and expressed the tuner sRNA from a
strong viral PT7 promoter (Fig. 3c)36. Transcription from PT7
requires T7 RNA polymerase (T7RNAP). This is provided by our
host strain E. coli BL21 Star (DE3), which has the T7RNAP gene
under the control of an IPTG inducible PlacUV5 promoter within
its genome (Fig. 3c)37. Using IPTG, induction of the tuner Ptac
promoter in our devices leads to simultaneous expression of
T7RNAP from the host genome and transcription of additional
tuner sRNA from the booster plasmid (Fig. 3c). As the tunable
devices are encoded on a plasmid with a p15A origin of
replication (~15 copies per cell; Supplementary Fig. 3)38, we
would expect that a ﬁve times higher tuner sRNA concentration is
reached when the sRNA booster is present.
Cells were co-transformed with each tunable genetic device and
sRNA booster plasmid, and their response functions measured
(Fig. 3d, e). As predicted by the modeling, the TES performance
improved with more than a doubling in the fold change across all
tuner promoter activities and a >40% drop in the intersection
between low and high output YFP ﬂuorescence distributions
(Table 1). For the tunable NOT gate only minor differences in
performance were seen with mostly small decreases in fold
change for high tuner promoter activities.
Self-cleaving ribozymes impact toehold switch function. In our
initial designs, a RiboJ self-cleaving ribozyme was included in the
TES and NOT gate to insulate the translation of the yfp or phlF
genes, respectively, from different 5′ untranslated region (UTR)
sequences that might be generated when using different pro-
moters as an input (Figs. 1a and 2a)39. Any variable UTR
sequences would be cleaved at the RiboJ site to produce a stan-
dardized mRNA with more consistent degradation and transla-
tion rates. Unfortunately, because RiboJ contains a number of
strong secondary RNA structures39,40, it is possible that the 23 nt
hairpin at the 3′-end impacts the ability for the sRNA to interact
with the THS, reducing the hybridization rate (Fig. 4a).
0
100
101
10−2
101
10−5
10−2
101
104
10−2
101
101
102
10
10
10
Output (protein)
a
mRNA/sRNA
PlacUV5
T7RNAP
PT7
sRNA20
sRNA Booster
Output (sRNA)
lacI
BL21 Star (DE3)
Genome
Tuner (IPTG)
pColE1
c
aadA
TT7
d
e
0
10−1 100 101
100
101
102
103
Input, Ptet (RPU)
Output, YFP (a.u.)
Tuner, Ptac (RPU)
Input, Ptet (RPU)
Output (RPU)
10–3 10–1
101
Tuner, Ptac (RPU)
E. coli
Fluorescence (a.u.)
101
103
105
Count
Fluorescence (a.u.)
102 103
105
Count
104
b
Input (RNAP/min)
Input (RNAP/min)
Tuner (RNAP/min)
Count
Output, YFP (protein)
102
103
Tuner (RNAP/min)
Fig. 3 Increasing tuner sRNA transcription rate to improve device performance. a Results of deterministic simulations of the TES model (Supplementary
Note 1) showing steady-state protein output and THS mRNA to tuner sRNA ratio for a range of input and tuner promoter activities. Tuner promoter
activities are shown in bands between (light–dark) 0.0001, 0.0005, 0.0024, 0.012, 0.056, 0.27, 1.3, 6.4, 31, 150, and 730 RNAP/min, respectively.
b Stochastic simulation of the TES model (n = 4000) for low (1 RNAP/min; gray) and high (1.5 RNAP/min; green) input promoter activity. Top and bottom
panels correspond to low (1.5 RNAP/min) and high (5 RNAP/min) tuner promoter activities, respectively. c Genetic design of the sRNA booster. The
T7RNAP gene is encoded in the host genome and an additional plasmid contains a tuner sRNA expression unit. d Experimentally measured response
functions (left) and ﬂow cytometry distributions of the YFP ﬂuorescence output (right) for the TES with the sRNA booster present. e Experimentally
measured response functions (left) and ﬂow cytometry distributions of the YFP ﬂuorescence output (right) for the tunable NOT gate with the sRNA
booster present. Points in all response functions denote the average of three biological replicates and error bars show ±1 standard deviation. Each line
shows a ﬁtted Hill function for a ﬁxed tuner input (color scale light–dark: 0.002, 0.03, 0.15, 0.43, 0.9, 2.6 RPU). All ﬂow cytometry distributions are shown
for low (bottom; 0.002 RPU) and high (top; 2.6 RPU) tuner promoter activity. Black outlined distributions correspond to a high input promoter activity (6.6
RPU for the TES and 1.5 RPU for the NOT gate) and ﬁlled red/blue distributions to a low input promoter activity (0.002 RPU). Cell autoﬂuorescence is
shown by the dashed gray line. Source data are available in the Source Data ﬁle.
NATURE COMMUNICATIONS | https://doi.org/10.1038/s41467-020-15653-7
ARTICLE
NATURE COMMUNICATIONS |   (2020) 11:2095 | https://doi.org/10.1038/s41467-020-15653-7 | www.nature.com/naturecommunications
5

To assess whether the RiboJ insulator might affect the stability of
secondary structures that are crucial to the TES’s function, we
performed thermodynamic modeling of the binding between the
THS mRNA and the tuner sRNA for variants of the TES design
with and without RiboJ present (“Methods”). Simulations predicted
a 40% drop in Gibbs free energy of the reactants when RiboJ was
removed (−40.5 kcal/mol with versus −65 kcal/mol without RiboJ;
Fig. 4b). This suggests that binding between sRNAs and the THS
may be hampered by interactions with the RiboJ insulator, lowering
the effective translation initiation rate of the RBS controlled by the
THS and subsequently the performance of the devices.
To experimentally test these predictions, noninsulated variants
of the TES and tunable NOT gate were constructed in which
RiboJ was removed. Characterization of these devices showed
Table 1 Performance summary of TES and tunable NOT gate.
Device
Design
Dynamic range (a.u.)
Fold change
Intersection
K range (RPU)
Low
High
Low
High
Low
High
TES
Original
333 ± 53
877 ± 695
14 ± 1.7
2.4 ± 1.2
0.78 ± 0.06
0.69 ± 0.16
–
sRNA booster
538 ± 51
2064 ± 1070
227 ± 297
5.7 ± 1.8
0.46 ± 0.04
0.35 ± 0.15
–
Noninsulated
882 ± 134
2149 ± 409
445 ± 412
31 ± 16
0.26 ± 0.07
0.27 ± 0.06
–
Combined
1550 ± 209
1712 ± 584
1236 ± 613
66 ± 54
0.15 ± 0.04
0.22 ± 0.04
–
NOT gate
Original
17280 ± 1273
3512 ± 286
6.0 ± 0.1
1.5 ± 0.1
0.19 ± 0.04
0.84 ± 0.02
0.01–0.07
sRNA booster
22040 ± 1601
2170 ± 654
5.8 ± 0.3
0.9 ± 0.3
0.13 ± 0.07
0.85 ± 0.02
0.01–0.06
Noninsulated
17466 ± 1926
4061 ± 827
6.8 ± 0.3
2.6 ± 0.4
0.11 ± 0.03
0.56 ± 0.08
0.02–0.04
Combined
27751 ± 3104
2383 ± 165
6.0 ± 0.6
0.9 ± 0.1
0.08 ± 0.05
0.90 ± 0.03
0.003–0.02
Average values are shown ±1 standard deviation calculated from ﬂow cytometry data for three biological replicates. The low and high columns correspond to experiments when the tuner promoter
activity is 0.002 RPU and 2.61 RPU, respectively. Dynamic range is calculated as the absolute difference in YFP ﬂuorescence between on and off inputs states. The on and off input states correspond to
input promoter activities of 6.6 RPU and 0.002 RPU for the TES, and 1.5 RPU and 0.002 RPU for the NOT gate, respectively. Fold change is calculated for YFP ﬂuorescence between on and off input
states. Intersection is calculated as the fractional overlap between distributions for on and off input states. The K range gives the span of K values from Hill functions ﬁtted to experimental data. The
designs are as follows: original designs are the initial constructs (Figs. 1a and 2a), sRNA booster designs include the additional sRNA booster plasmid (Fig. 3c), the noninsulated designs have the RiboJ
element removed (Fig. 4), and the combined designs have both RiboJ removed and the sRNA booster plasmid present.
0
100
101
0
10−1 100 101
100
101
102
103
Potential
interference
yfp
Transcription
Self-clevage
yfp
Transcription
sRNA
Insulated design
Non-insulated design
sRNA
a
RiboJ
Translation
Translation
c
d
Input, Ptet (RPU)
Output (RPU)
10–3 10–1
101
Tuner, Ptac (RPU)
Input, Ptet (RPU)
Output, YFP (a.u.)
T uner, Ptac (RPU)
Fluorescence (a.u.)
101
103
105
Count
Fluorescence (a.u.)
102 103
105
Count
104
Toehold
sRNA
RBS
b
Non-insulated design
Insulated design
RiboJ
Toehold
sRNA
RBS
Fig. 4 Self-cleaving ribozyme insulators affect tunable device performance. a Original designs of both the TES and tunable NOT gate include a RiboJ
insulating element, which can potentially interfere with binding of the tuner sRNA to the THS. b RNA secondary structure predictions for THS mRNA alone
and with a complimentary tuner sRNA bound. Separate structures shown when the RiboJ insulating element is present (left) and absent (right).
c Experimentally measured response functions (left) and ﬂow cytometry distributions of the output YFP ﬂuorescence (right) for the TES with the RiboJ
insulator removed. d Experimentally measured response functions (left) and ﬂow cytometry distributions of the YFP ﬂuorescence output (right) for the
tunable NOT gate with the RiboJ insulator removed. Points in all response functions denote the average of three biological replicates and error bars show
±1 standard deviation. Each line shows a ﬁtted Hill function for a ﬁxed tuner input (color scale light–dark: 0.002, 0.03, 0.15, 0.43, 0.9, 2.6 RPU). All ﬂow
cytometry distributions are shown for low (bottom; 0.002 RPU) and high (top; 2.6 RPU) tuner promoter activity. Black outlined distributions correspond to
a high input promoter activity (6.6 RPU for the TES and 1.5 RPU for the NOT gate) and ﬁlled red/blue distributions to a low input promoter activity (0.002
RPU). Cell autoﬂuorescence is shown by the dashed gray line. Source data are available in the Source Data ﬁle.
ARTICLE
NATURE COMMUNICATIONS | https://doi.org/10.1038/s41467-020-15653-7
6
NATURE COMMUNICATIONS |   (2020) 11:2095 | https://doi.org/10.1038/s41467-020-15653-7 | www.nature.com/naturecommunications

major improvements in overall performance (Fig. 4c, d). The TES
saw more than a doubling in the dynamic range and a tenfold
increase in the fold change between “on” and “off ” states across
low and high tuner activity levels (Table 1). In addition, the
fraction of intersection of the output YFP ﬂuorescence distribu-
tions dropped by >50%. The tunable NOT gate saw more modest
improvements with a 73% increase in the fold change at high
tuner activity levels, but an overall drop of 66% in the range of
transition points (K values) that could be achieved (Table 1).
These results highlight an important consideration often ignored.
When
using
RNA-based
devices
that
require
the
proper
formation of secondary structures, care must be taken to ensure
multiple parts do not interfere with each other, leading to cryptic
failure modes.
Another
counterintuitive
change
in
the
TES’s
response
function after RiboJ removal was the large drop in output YFP
ﬂuorescence from 26 to 3 arbitrary units (a.u.) when no input or
tuner was present (Fig. 4c). Similar drops of between 4- and 11-
fold were also seen for higher tuner promoter activities. Given
that binding of a tuner sRNA to the THS mRNA should be less
hampered when RiboJ is absent, an increase rather than a
decrease in output protein production would be expected. A
possible explanation is that the stability of the THS mRNA
decreased after RiboJ was removed. This is supported by recent
results that have shown the RiboJ insulator both stabilizes its
mRNA and also boosts the translation initiation rate of a nearby
downstream RBS41. The precise mechanisms for this are not well
understood but it is thought that the structural aspect of the RiboJ
at the 5′-end of an mRNA inhibits degradation by exonucleases,
whilst the hairpin at the 3′-end exposes the nearby RBS by
reducing
the
chance
of
unwanted
secondary
structure
formation39,40.
Finally, we combined the noninsulated designs with the sRNA
booster plasmid to see whether further improvements could be
made (Table 1). For the TES, we found that the dynamic range
had plateaued, with only moderate increases at low tuner
promoter activities. In contrast, the fold change between low
and high outputs more than doubled across tuner promoter
activities when compared to the noninsulated design, and a
further drop of >18% was seen in the fractional intersection
between the YFP ﬂuorescence distributions for these output
states. The tunable NOT gate showed minor decreases in
performance for many of the measures (Table 1). However, the
inclusion of the sRNA booster likely increased overall PhlF
concentrations as the transition points from an “on” to an “off ”
state shifted far below what had been seen for all other designs.
This would make this speciﬁc design of value for uses where a
weak
input
signal
needs
to
be
inverted
and
ampliﬁed
simultaneously.
Towards complex tunable logic. To create larger genetic circuits
that implement complex logic, it is vital that a sufﬁciently diverse set
of logic gates are available for use. Because a NOT gate alone has
limited capabilities, we further modiﬁed its design to create a tunable
two-input NOR gate7,27. The output of a NOR gate is on only when
both inputs are off (Fig. 5b) and crucially this type of gate is func-
tionally complete (i.e., any combinatorial logic function can be
implemented using NOR gates alone). In our new device, we added
a further inducible input promoter, PBAD, directly before the existing
Ptet input promoter, and included the associated sensor system
(araC gene) to allow activity of the PBAD promoter to be controlled
by the concentration of L-Arabinose (Ara) (Fig. 5a). Our modiﬁca-
tions were made to the original NOT gate design that included the
RiboJ insulator because this produced the largest tunable range for
the “on” to “off ” transition point.
To assess the function of the tunable NOR gate, the activities of
both input promoters PBAD and Ptet, and the tuner promoter Ptac
were varied by culturing cells harboring the device in different
concentrations of Ara, aTc and IPTG, respectively (“Methods”).
The two-dimensional response functions (Fig. 5c) showed that
NOR logic was successfully implemented and that the transition
point from low to high output for both inputs was simultaneously
shifted to lower input promoter activities when the tuner
promoter was highly active (Fig. 5c, right panel). Considering
each input promoter separately, the transition point between “on”
and “off ” states shifted by 16- and 6-fold for PBAD and Ptet,
respectively.
Unlike the NOT gate, even at high tuner promoter activities,
the dynamic range was better maintained, dropping at most 35%,
and the fold change between “on” and “off ” states remained
above 4-fold and 8-fold for low and high tuner promoter
activities, respectively (Supplementary Table 3). Furthermore, the
improved separation of these states led to smaller intersections in
the output YFP distributions compared to the NOT gate. This
was especially evident when comparing NOR gate states where
both input promoters were simultaneously on or off with only a
~5% intersection observed (Supplementary Table 3).
The cause of this improvement is not clear but may relate to
the PBAD promoter insulating expression of the phlF gene from
transcriptional read-through originating from the tuner sRNA
transcriptional unit that is located directly upstream in the DNA
(Supplementary Fig. 3). Without this insulating effect, read-
through would cause elevated expression of PhlF, even when the
input promoters are off, and potentially lead to a partial switch in
the output when the tuner promoter is active (as seen for the
original NOT gate, Fig. 2b). Such a mechanism could also account
for the elevated output levels for the TES when the input
promoter was off and the tuner promoter activity increased
(Fig. 1c).
Discussion
In this work, we developed a class of genetic device whose
response function can be dynamically tuned. This was achieved
by constructing a TES to separately control the transcription and
translation rate of a gene. We demonstrate how the TES can be
used to shift the “on” and “off ” output states of a sensor by 4.5-
and 28-fold, respectively (Fig. 1) and incorporated into NOT and
NOR gates to alter their transition point between on and off
output states over a greater than 6-fold range (Fig. 2). Unfortu-
nately, the performance of the tunable devices varied for differing
tuner inputs, leading to a trade-off between performance and the
level of tuning required. Mathematical modeling revealed (1) the
importance of ensuring sufﬁcient tuner sRNA is present to fully
activate the THS (Fig. 3) and (2) the presence of possible detri-
mental interactions between a self-cleaving ribosome and the
THS (Fig. 4). Modiﬁed designs addressing these concerns showed
improved performance for the TES, but only minor improve-
ments in the fold change of the tunable NOT gate when the self-
cleaving ribozyme was removed (Table 1). In contrast, the NOR
gate behaved more consistently across tuner activity levels and
displayed better separation between “on” and “off ” states. To the
best of our knowledge the simultaneous control of transcription
and translation to tune the response function of a genetic device is
original, making this work a valuable resource for others to build
on. Furthermore, unlike other attempts at tuning the response of
devices through mutation of protein components to alter catalytic
rates42, our method allows for dynamic changes to a response
function using simple to control transcriptional signals.
A difﬁculty when using THSs to regulate gene expression is
that high concentrations of sRNA are required to achieve a strong
NATURE COMMUNICATIONS | https://doi.org/10.1038/s41467-020-15653-7
ARTICLE
NATURE COMMUNICATIONS |   (2020) 11:2095 | https://doi.org/10.1038/s41467-020-15653-7 | www.nature.com/naturecommunications
7

enough activation of mRNA translation. This stems from the
regulatory mechanism which relies on base-pairing of the sRNA
to THS, placing limits on the binding afﬁnity that can be
achieved. A possible means of increasing the afﬁnity between
these species would be to exploit RNA chaperones such as
Hfq43,44. In prokaryotes, sRNAs that associate with Hfq play a
variety of roles from inhibiting and activating translation, to
affecting the stability of a target mRNA45–47. In some cases, these
effects are signiﬁcant; it has been shown in vitro that Hfq
increases by 30- to 50-fold the binding afﬁnity of the DsrA sRNA
to the leader of the rpoS mRNA48. Designing de novo sRNAs that
bind to Hfq to increase their afﬁnity to a target mRNA has been
shown for both activation43 and inhibition44 of translation
initiation. In both cases, Hfq binds a scaffold from an endogenous
gene (e.g., micC) which is fused with a targeting sequence (e.g.,
that found on the sRNA). This approach could be employed in
future TES designs. In fact, previous work that used Hfq asso-
ciated sRNAs to implement a metabolically cheap negative
feedback control loop created a useful repressive tuning element
that could be directly used in our system44. By combining the
ﬁndings from that study with ours and incorporating recent
improvements in THS design6, it should be possible to make
further strides towards high-performance tunable genetic devices.
An interesting future direction opened up by the adaptive
nature of our devices is the possibility to incorporate many of
them into larger circuits. This would allow multiple parts of a
circuit to be tuned simultaneously to maximize component
compatibility and optimize system behavior. Unlike a typical
design–build–test cycle that requires the reassembly of a genetic
circuit if malfunctions are detected, this work supports a
design–build–test–tune cycle where costly reassembly can be
avoided. Rather than reassembling a circuit, parts can instead be
dynamically tuned until they work correctly in unison. In this
context, applying sensitivity analysis during circuit design would
allow us to identify speciﬁc components where even small
deviations in behavior would adversely impact the overall circuit
function49. These would be ideal candidates to be encoded using
tunable devices to allow for tweaking at these critical points.
The additional tuner inputs in our devices raise some practical
challenges. Systems composed of numerous tunable devices will
require a large number of tuner inputs to be controlled simul-
taneously. If external signals are to be used then a unique sensor
is required for each tuner input, as well as the capability to be able
to control the environment to provide the correct set of input
signals over time. Although the range of small molecule29 and
light based42,50 sensing systems has grown over recent years, the
ability to control many environmental factors (e.g., small mole-
cule concentrations) simultaneously remains difﬁcult. However,
external control is not the only way to tune the behavior of these
devices. The use of promoters as inputs allows them to be
a
THS20
phlF
RiboJ
Ptac
yfp
PphlF
YFP
Output
sRNA20 T1
T3
Input B
Tuner
Output
Tunable NOR gate
(RNAP/s)
(RNAP/s)
RiboJ
(Concentration)
b
Input B
(aTc)
Ptet
lacI
Sensor Modules
tetR
Tuner
(IPTG)
Input
Output
(RNAP/s)
araC
PBAD
Input A
Input A Input B
Tuner
Input A
(Ara)
PhlF
c
Input A, PBAD (RPU)
Input B, Ptet (RPU)
Tuner, Ptac = 0.002 RPU
NOR gate
Input A
Input B
1
0
1
0
0
1
Tuner, Ptac = 2.6 RPU
Output (RPU)
0.1
2.6
Output
Count
d
Fluorescence (a.u.)
101 102
104
103
–/–
–/+
+/–
+/+
Ara/aTc
Input A, PBAD (RPU)
Fig. 5 Design and characterization of a tunable NOR gate. a Schematic of all the sensor systems used (top, left), the tunable NOR gate (top, right), and
their genetic implementation (bottom, dashed boxes). Yellow ﬂuorescent protein (YFP) expression is driven by the output promoter and T1 and T3
correspond to the transcriptional terminators L3S3P11 and ECK120033737, respectively65. b Function of a two-input NOR gate. c Heatmaps showing the
output of the tunable NOR gate for varying input promoter activities (Input A–PBAD: 0.008, 0.003, 0.15, 0.5, 2.5, 3.1 RPU; Input B–Ptet: 0.05, 0.5, 1.6, 3.1, 6.4,
7.5 RPU) and for low (left) and high (right) tuner promoter activities. Output promoter activities shown are average values calculated from ﬂow cytometry
data for three biological replicates. White dashed line shows an output of 1.2 RPU and denotes the transition point from a high to low output. d Flow
cytometry distributions of the output YFP ﬂuorescence for tuner promoter activities of 0.002 RPU (bottom) and 2.6 RPU (top). The four distributions
correspond to combinations of the absence and presence of L-Arabinose (10 mM) and aTc (50 ng/mL). Source data are available in the Source Data ﬁle.
ARTICLE
NATURE COMMUNICATIONS | https://doi.org/10.1038/s41467-020-15653-7
8
NATURE COMMUNICATIONS |   (2020) 11:2095 | https://doi.org/10.1038/s41467-020-15653-7 | www.nature.com/naturecommunications

controlled by connecting them directly to the many transcrip-
tional signals used natively in a cell. This offers the advantage of
tapping into the cells innate capacity to sense and respond to its
environment. Alternatively, if an adaptive circuit is not required,
sensors controlling the tuning inputs could be replaced once a
working conﬁguration is found with constitutive promoters of an
identical strength. This would reduce the reassembly required to a
single step once the correct combination of tuning inputs
is found.
When designing our tunable devices, we observed deviations
between the experimental and modeled responses. This may be
due to retroactivity30,31, where expression of the output reporter
protein places a signiﬁcant burden on the host cell (Supplemen-
tary Note 2). Recently, there has been increased interest in the
role of burden51 and attempts made to mitigate its effect52. One
approach has been to implement resource allocation schemes
based on split exogenous RNAPs53. This limits the maximum
burden a circuit can impose by providing ﬁxed size pools of
transcriptional resources that are orthogonal to the endogenous
ones. Because our devices can have their responses dynamically
tuned, they could be used to boost the expression of downstream
components to mitigate retroactivity effects or even be used to
cap the maximum levels of resource that can be used by a circuit.
For synthetic biology to have a broad impact outside of the
carefully controlled conditions of a lab, it is vital that we are able
to build adaptive genetic circuits that can continue to maintain
their functionality when exposed to unexpected environmental
changes or shifts in host cell physiology54. By combining
advances in biological control engineering52,54–58 with the tun-
able genetic devices developed in this work, bioengineers have a
complementary set of tools capable of taking steps towards
this goal.
Methods
Strains and media. Cloning was performed using E. coli strain DH5-α (F– endA1
glnV44 thi-1 recA1 relA1 gyrA96 deoR nupG purB20 φ80dlacZΔM15 Δ(lacZYA–
argF)U169, hsdR17(rK–mK+), λ–) (New England Biolabs, C2987I). Device char-
acterization was performed using BL21 Star (DE3) (F– ompT hsdSB (rB–, mB–) gal
dcm rne-131 [DE3]) (Thermo Fisher Scientiﬁc, C601003). For cloning, cells were
grown in LB Miller broth (Sigma-Aldrich, L3522). For device characterization, cells
were grown in M9 minimal media supplemented with glucose containing M9 salts
(6.78 g/L Na2HPO4, 3 g/L KH2PO4, 1 g/L NH4Cl, 0.5 g/L NaCl) (Sigma-Aldrich,
M6030), 0.34 g/L thiamine hydrochloride (Sigma T4625), 0.4% D-glucose (Sigma-
Aldrich, G7528), 0.2% casamino acids (Acros, AC61204-5000), 2 mM MgSO4
(Acros, 213115000), and 0.1 mM CaCl2 (Sigma-Aldrich, C8106). Antibiotic
selection was performed using 50 μg/mL kanamycin (Sigma-Aldrich, K1637) or
50 mg/mL spectinomycin (Santa Cruz Biotechnology, sc-203279). Induction of
sensor systems was performed using aTc (Sigma-Aldrich, 37919), IPTG (Sigma-
Aldrich, I6758), and L-Arabinose (Ara) (Sigma-Aldrich, A3256).
Genetic device synthesis and assembly. Plasmids containing the TES (pVB001)
and tunable NOT gate devices (pVB002) were constructed by a combination of
gene synthesis (GeneArt, Thermo Fisher Scientiﬁc) and PCR of existing plasmids
to generate linear fragments with regions of homology between subsequent parts.
Gibson assembly (New England Biolabs, E2611S) was then used to assemble these
into the ﬁnal plasmids. Supplementary Table 4 provides details of the synthesized
DNA fragments (TES-P1 and TES-P2), and Supplementary Table 5 provides details
of the primers and their templates used to generate all linear fragments for each
plasmid design. Removal of RiboJ from the TES (pVB001) and NOT gate (pVB002)
was achieved by PCR of the relevant design using primers F_RiboJ_Rem and
R_RiboJ_Rem (Supplementary Table 5) and subsequent circularization by standard
Golden Gate assembly (New England Biolabs, E1601S) to create the plasmids
pVB003 and pVB004, respectively. The plasmid used to boost tuner sRNA
levels (pVB005) was fully synthesized (GeneArt, Thermo Fisher Scientiﬁc). The
plasmid containing the tunable NOR gate device (pVB006) was constructed by ﬁrst
PCR ampliﬁcation of the pAN1720 plasmid (without the lacZα region normally
used for blue/white screening) using primers containing an EcoRI restriction site at
the 5′-end and an NotI restriction site at the 3′-end (F_pAN1720_EcoRI and
R_pAN1720_NotI; Supplementary Table 5). The tunable NOR gate DNA insert
was synthesized in three parts, NOR-P1, NOR-P2, and NOR-P3 (Integrated DNA
Technologies), which were then assembled using a standard Golden Gate assembly
method (New England Biolabs, E1601S) to create a full-length linear insert.
This was designed to contain complementary EcoRI and NotI restriction sites to
the ampliﬁed pAN1720 fragment. Both linear DNA fragments were ﬁnally used in
a standard restriction digest using EcoRI (New England Biolabs, R3101) and NotI
(New England Biolabs, R3189), and then a ligation reaction (New England Biolabs,
M0202S) used to assemble the complete pVB006 plasmid. All plasmids were
sequence veriﬁed by Sanger sequencing (Euroﬁns Genomics). Annotated plasmid
maps of all devices are provided in Supplementary Fig. 3 and Supplementary
Data 2.
Genetic device characterization. Single colonies of cells transformed with the
appropriate genetic constructs were inoculated in 200 μL M9 media supplemented
with glucose and necessary antibiotics for selection in a 96-well microtiter plate
(Thermo Fisher Scientiﬁc, 249952) and grown for 16 h in a shaking incubator
(Stuart, S1505) at 37 °C and 1250 rpm. Following this, cultures were diluted 9:1600
(15 μL into 185 μL, with 15 μL of this dilution loaded into 185 μL) in glucose
supplemented M9 media with necessary antibiotics for selection and grown for 3 h
at the same conditions. Next, the cultures were diluted 1:45 (10 μL into 140 μL) into
supplemented M9 media with necessary antibiotics for selection and any required
inducers in a new 96-well microtiter plate (Thermo Fisher Scientiﬁc, 249952) and
grown at 37 °C and 1250 rpm for 5 h. Finally, the cells were diluted 1:10 (10 μL into
90 μL) in phosphate-buffered saline (Gibco,18912-014) containing 2 mg/mL
kanamycin to halt protein translation and incubated at room temperature for 1 h to
allow for maturation of the YFP before performing ﬂow cytometry.
Flow cytometry. YFP ﬂuorescence of individual cells was measured using an Acea
Biosciences NovoCyte 3000 ﬂow cytometer equipped with a NovoSampler to allow
for automated collection from 96-well microtiter plates. Data were collected using
the NovoExpress software. Cells were excited using a 488 nm laser and measure-
ments were taken using a 530 nm detector. A ﬂow rate of 40 μL/min was used to
collect at least 105 cells for all measured conditions. Automated gating of events
using the forward (FSC-A) and side scatter (SSC-A) channels was performed for all
data using the FlowCal Python package version 1.259 and the density2d function
with parameters: channels = [“FSC-A”, “SSC-A”], bins = 1024, gate_fraction = 0.5,
xscale = “logicle”, yscale = “logicle”, and sigma = 10.0. A demonstration of this
automated approach is shown in Supplementary Fig. 4.
Autoﬂuorescence correction. To measure YFP ﬂuorescence from our constructs
it was necessary to correct for the autoﬂuorescence of cells. An autoﬂuorescence
control strain containing the pAN1201 plasmid7, which does not express YFP but
contains the same backbone as our genetic devices, was measured using ﬂow
cytometry under the same culturing conditions as for characterization. Measure-
ments were taken from three biological replicates and an average of the medians of
the gated distributions was subtracted from the gated YFP ﬂuorescence ﬂow
cytometry data of the characterized devices, as in previous work7.
Characterization of sensor systems. To allow for inputs to our devices to be
controlled in standardized RPUs7,60, calibration curves for the two sensor systems
were generated to enable a conversion between a chemical inducer concentration
and the relative promoter activity of each sensors’ output promoter (Ptac and Ptet).
Cells transformed with plasmids pAN1718 and pAN1719 for Ptac and Ptet,
respectively, and the pAN1717 RPU standard7, were cultured in the same way as
the characterization experiments. Flow cytometry was used to measure YFP
ﬂuorescence which was further corrected for cell autoﬂuorescence. RPU values
were then calculated by dividing the YFP output from the sensor by the YFP output
from the RPU standard and a Hill function ﬁtted to the resultant data (Supple-
mentary Fig. 1).
Quantifying histogram intersections. The fraction of intersection H between two
histograms (e.g., ﬂow cytometry ﬂuorescence distributions), x and y, was calculated
using,
H x; y
ð
Þ ¼
X
n
i¼1
minðxi; yiÞ
xi
;
ð1Þ
Here histograms x and y are divided into n bins that correspond to identical
ranges of values for each, with xi and yi denoting the value of bin i for histogram x
and y, respectively.
Predicting RNA binding and secondary structure. To predict the binding and
secondary structure of the THS and tuner sRNA (Fig. 3), thermodynamic modeling
was performed using the NUPACK web application61. All simulations were run
using the parameters: nucleic acid = RNA, temperature = 37 °C and the con-
centration of THS mRNA was set to 5 × 10−4 μM. The switch sequence mRNA and
the switch sequence mRNA with an upstream cleaved RiboJ were simulated inde-
pendently with additional parameters strand species = 1 and a maximum complex
size = 1. The THS mRNA with and without an upstream RiboJ sequence were also
simulated in the presence of trigger sRNA set to a concentration of 7 × 10−5 μM
with additional parameters: strand species = 1 and a maximum complex size = 1.
Full sequences are given in Supplementary Table 2.
NATURE COMMUNICATIONS | https://doi.org/10.1038/s41467-020-15653-7
ARTICLE
NATURE COMMUNICATIONS |   (2020) 11:2095 | https://doi.org/10.1038/s41467-020-15653-7 | www.nature.com/naturecommunications
9

Computational analyses and data ﬁtting. All general computational analyses and
plotting were performed using Python version 3.6.6, NumPy version 1.16, Pandas
version 0.24, and matplotlib version 3.1. Response functions for the TES designs
were generated by ﬁtting median values of YFP ﬂuorescence from ﬂow cytometry
data to a Hill function of the form
y ¼ ymin þ ymax  ymin
ð
Þ
xn
Kn þ xn ;
ð2Þ
where y is the output YFP ﬂuorescence (in a.u.), ymin and ymax are the minimum
and maximum output YFP ﬂuorescence (in a.u.), respectively, K is the input
promoter activity (in RPU units) at which the output is halfway between its
minimum and maximum, n is the Hill coefﬁcient, and x is the input promoter
activity (in RPU units). Response functions for the tunable NOT gates were gen-
erated in a similar way using a Hill function of the form
y ¼ ymin þ ymax  ymin
ð
Þ
Kn
Kn þ xn :
ð3Þ
Fitting of data was performed using nonlinear least squares and the curve_ﬁt
function from the SciPy.integrate Python package version 1.1.
Numerical simulation. The deterministic ODE model (Supplementary Note 1) was
simulated using the odeint function of the SciPy.integrate Python package version
1.1 with default parameters. The delay differential equations (Supplementary
Note 2) were simulated using the DifferentialEquations module version 6.10 using
the Bogacki–Shampine 3/2 method running in Julia version 1.3. Stochastic simu-
lations of the biochemical model (Supplementary Note 1) were performed using
the tau-leap method in COPASI version 4.24 with the following settings: number of
iterations (simulations) = 4000, duration = 100 min, interval size = 1 min, number
of intervals = 100, and the starting in steady-state option selected. Initial steady-
state conditions for the simulation are calculated automatically by COPASI using a
damped Newton method.
Visualization of genetic designs. All genetic diagrams are shown using Synthetic
Biology Open Language Visual (SBOL Visual) notation62. SBOL Visual diagrams
were generated using the DNAplotlib Python package63,64 version 1.0 which were
then annotated and composed with OmniGrafﬂe version 7.9.2.
Reporting summary. Further information on research design is available in
the Nature Research Reporting Summary linked to this article.
Data availability
Systems Biology Markup Language (SBML) ﬁle implementing a model of the TES can be
found in Supplementary Data 1. Annotated sequence ﬁles in GenBank format for all
plasmids are available in Supplementary Data 2. All plasmids are available from Addgene
(#127185–127189, 140327). Flow cytometry data are available at the Open Science
Framework https://osf.io/dw4fp/ (DOI: https://doi.org/10.17605/OSF.IO/DW4FP). All
other relevant data are available from the authors upon request. Source data for the main
and supplementary ﬁgures and tables are available in the Source Data ﬁle.
Received: 24 July 2019; Accepted: 20 March 2020;
References
1.
Brophy, J. A. N. & Voigt, C. A. Principles of genetic circuit design. Nat.
Methods 11, 508 (2014).
2.
Greco, F. V., Tarnowski, M. J. & Gorochowski, T. E. Living computers
powered by biochemistry. Biochemist 41, 14–18 (2019).
3.
Slomovic, S., Pardee, K. & Collins, J. J. Synthetic biology devices for in vitro
and in vivo diagnostics. Proc. Natl Acad. Sci. USA 112, 14429 (2015).
4.
Andrews, L. B., Nielsen, A. A. K. & Voigt, C. A. Cellular checkpoint control
using programmable sequential logic. Science 361, eaap8987 (2018).
5.
Bashor, C. J. et al. Complex signal processing in synthetic gene circuits using
cooperative regulatory assemblies. Science 364, 593 (2019).
6.
Green, A. A. et al. Complex cellular logic computation using ribocomputing
devices. Nature 548, 117 (2017).
7.
Nielsen, A. A. K. et al. Genetic circuit design automation. Science 352, aac7341
(2016).
8.
Gao, X. J., Chong, L. S., Kim, M. S. & Elowitz, M. B. Programmable protein
circuits in living cells. Science 361, 1252 (2018).
9.
Daniel, R., Rubens, J. R., Sarpeshkar, R. & Lu, T. K. Synthetic analog
computation in living cells. Nature 497, 619 (2013).
10. Fernandez-Rodriguez, J., Yang, L., Gorochowski, T. E., Gordon, D. B. & Voigt,
C. A. Memory and combinatorial logic based on DNA inversions: dynamics
and evolutionary stability. ACS Synth. Biol. 4, 1361–1372 (2015).
11. Elowitz, M. B. & Leibler, S. A synthetic oscillatory network of transcriptional
regulators. Nature 403, 335–338 (2000).
12. Niederholtmeyer, H. et al. Rapid cell-free forward engineering of novel genetic
ring oscillators. eLife 4, e09771 (2015).
13. Kong, W., Meldgin, D. R., Collins, J. J. & Lu, T. Designing microbial consortia
with deﬁned social interactions. Nat. Chem. Biol. 14, 821–829 (2018).
14. Karig, D. et al. Stochastic turing patterns in a synthetic bacterial population.
Proc. Natl Acad. Sci. USA 115, 6572–6577 (2018).
15. Cao, Y. et al. Programmable assembly of pressure sensors using pattern-
forming bacteria. Nat. Biotechnol. 35, 1087–1093 (2017).
16. Canton, B., Labno, A. & Endy, D. Reﬁnement and standardization of synthetic
biological parts and devices. Nat. Biotechnol. 26, 787 (2008).
17. Vaidyanathan, P. et al. A framework for genetic logic synthesis. Proc. IEEE
103, 2196–2207 (2015).
18. Weinberg, B. H. et al. Large-scale design of robust genetic circuits with
multiple inputs and outputs for mammalian cells. Nat. Biotechnol. 35, 453
(2017).
19. Moser, F. et al. Genetic circuit performance under conditions relevant for
industrial bioreactors. ACS Synth. Biol. 1, 555–564 (2012).
20. Gorochowski, T. E., van den Berg, E., Kerkman, R., Roubos, J. A. & Bovenberg,
R. A. L. Using synthetic biological parts and microbioreactors to explore the
protein expression characteristics of Escherichia coli. ACS Synth. Biol. 3,
129–139 (2014).
21. Cardinale, S. & Arkin, A. P. Contextualizing context for synthetic biology—
identifying causes of failure of synthetic biological systems. Biotechnol. J. 7,
856–866 (2012).
22. Gyorgy, A. et al. Isocost lines describe the cellular economy of genetic circuits.
Biophys. J. 109, 639–646 (2015).
23. Gorochowski, T. E., Avcilar-Kucukgoze, I., Bovenberg, R. A. L., Roubos, J. A.
& Ignatova, Z. A minimal model of ribosome allocation dynamics captures
trade-offs in expression between endogenous and synthetic genes. ACS Synth.
Biol. 5, 710–720 (2016).
24. Qian, Y., Huang, H.-H., Jiménez, J. I. & Del Vecchio, D. Resource
competition shapes the response of genetic circuits. ACS Synth. Biol. 6,
1263–1272 (2017).
25. Gorochowski, T. E. et al. Genetic circuit characterization and debugging using
RNA‐seq. Mol. Syst. Biol. 13, 952 (2017).
26. Gorochowski, T. E. et al. Absolute quantiﬁcation of translational regulation
and burden using combined sequencing approaches. Mol. Syst. Biol. 15, e8719
(2019).
27. Stanton, B. C. et al. Genomic mining of prokaryotic repressors for orthogonal
logic gates. Nat. Chem. Biol. 10, 99–105 (2014).
28. Green, A. A., Silver, P. A., Collins, J. J. & Yin, P. Toehold switches: de-novo-
designed regulators of gene expression. Cell 159, 925–939 (2014).
29. Meyer, A. J., Segall-Shapiro, T. H., Glassey, E., Zhang, J. & Voigt, C. A.
Escherichia coli “Marionette” strains with 12 highly optimized small-molecule
sensors. Nat. Chem. Biol. 15, 196–204 (2019).
30. Del Vecchio, D., Ninfa, A. J. & Sontag, E. D. Modular cell biology: retroactivity
and insulation. Mol. Syst. Biol. 4, 161 (2008).
31. Vecchio Del D. & Sontag, E. D. Engineering principles in bio-molecular
systems: from retroactivity to modularity. in 2009 European Control
Conference (ECC). 658–664. https://doi.org/10.23919/ECC.2009.7074478
(2009).
32. Moon, T. S., Lou, C., Tamsir, A., Stanton, B. C. & Voigt, C. A. Genetic
programs constructed from layered logic gates in single cells. Nature 491, 249
(2012).
33. Chen, H., Shiroguchi, K., Ge, H. & Xie, X. S. Genome-wide study of mRNA
degradation and transcript elongation in Escherichia coli. Mol. Syst. Biol. 11,
781 (2015).
34. Busi, F., Arluison, V. & Régnier, P. Absolute regulatory small noncoding RNA
concentration and decay rates measurements in Escherichia coli. in Bacterial
Regulatory RNA: Methods and Protocols (eds Arluison, V. & Valverde, C.)
231–248 (Springer, New York, 2018). https://doi.org/10.1007/978-1-4939-
7634-8_14.
35. Lutz, R. & Bujard, H. Independent and tight regulation of transcriptional units
in Escherichia coli via the LacR/O, the TetR/O and AraC/I1-I2 regulatory
elements. Nucleic Acids Res. 25, 1203–1210 (1997).
36. Dunn, J. J., Studier, F. W. & Gottesman, M. Complete nucleotide sequence of
bacteriophage T7 DNA and the locations of T7 genetic elements. J. Mol. Biol.
166, 477–535 (1983).
37. Studier, F. W. & Moffatt, B. A. Use of bacteriophage T7 RNA polymerase to
direct selective high-level expression of cloned genes. J. Mol. Biol. 189,
113–130 (1986).
38. Hiszczyńska-Sawicka, E. & Kur, J. Effect of Escherichia coli IHF mutations on
plasmid p15A copy number. Plasmid 38, 174–179 (1997).
39. Lou, C., Stanton, B., Chen, Y.-J., Munsky, B. & Voigt, C. A. Ribozyme-based
insulator parts buffer synthetic circuits from genetic context. Nat. Biotechnol.
30, 1137 (2012).
ARTICLE
NATURE COMMUNICATIONS | https://doi.org/10.1038/s41467-020-15653-7
10
NATURE COMMUNICATIONS |   (2020) 11:2095 | https://doi.org/10.1038/s41467-020-15653-7 | www.nature.com/naturecommunications

40. Carrier, T. A. & Keasling, J. D. Engineering mRNA stability in E. coli by the
addition of synthetic hairpins using a 5′ cassette system. Biotechnol. Bioeng.
55, 577–580 (1997).
41. Clifton, K. P. et al. The genetic insulator RiboJ increases expression of
insulated genes. J. Biol. Eng. 12, 23 (2018).
42. Landry, B. P., Palanki, R., Dyulgyarov, N., Hartsough, L. A. & Tabor, J. J.
Phosphatase activity tunes two-component system sensor detection threshold.
Nat. Commun. 9, 1433 (2018).
43. Soper, T., Mandin, P., Majdalani, N., Gottesman, S. & Woodson, S. A. Positive
regulation by small RNAs and the role of Hfq. Proc. Natl Acad. Sci. USA 107,
9602 (2010).
44. Kelly, C. L. et al. Synthetic negative feedback circuits using engineered small
RNAs. Nucleic Acids Res. 46, 9875–9889 (2018).
45. Waters, L. S. & Storz, G. Regulatory RNAs in Bacteria. Cell 136, 615–628 (2009).
46. Storz, G., Opdyke, J. A. & Zhang, A. Controlling mRNA stability and translation
with small, noncoding RNAs. Curr. Opin. Microbiol. 7, 140–144 (2004).
47. Gottesman, S. Micros for microbes: non-coding regulatory RNAs in bacteria.
Trends Genet. 21, 399–404 (2005).
48. Soper, T. J. & Woodson, S. A. The rpoS mRNA leader recruits Hfq to facilitate
annealing with DsrA sRNA. RNA 14, 1907–1917 (2008).
49. Feng, X. et al. Optimizing genetic circuits by global sensitivity analysis.
Biophys. J. 87, 2195–2202 (2004).
50. Baumschlager, A., Aoki, S. K. & Khammash, M. Dynamic blue light-inducible
T7 RNA polymerases (Opto-T7RNAPs) for precise spatiotemporal gene
expression control. ACS Synth. Biol. 6, 2157–2167 (2017).
51. Ceroni, F., Algar, R., Stan, G.-B. & Ellis, T. Quantifying cellular capacity
identiﬁes gene expression designs with reduced burden. Nat. Methods 12,
415–418 (2015).
52. Ceroni, F. et al. Burden-driven feedback control of gene expression. Nat.
Methods 15, 387–393 (2018).
53. Segall-Shapiro, T. H., Meyer, A. J., Ellington, A. D., Sontag, E. D. & Voigt,
C. A. A ‘resource allocator’ for transcription based on a highly fragmented T7
RNA polymerase. Mol. Syst. Biol. 10, 742 (2014).
54. Segall-Shapiro, T. H., Sontag, E. D. & Voigt, C. A. Engineered promoters
enable constant gene expression at any copy number in bacteria. Nat.
Biotechnol. 36, 352 (2018).
55. Aoki, S. K. et al. A universal biomolecular integral feedback controller for
robust perfect adaptation. Nature 570, 533–537 (2019).
56. Fiore, D., Guarino, A. & di Bernardo, M. Analysis and control of genetic toggle
switches subject to periodic multi-input stimulation. IEEE Control Syst. Lett. 3,
278–283 (2019).
57. Mishra, D., Rivera, P. M., Lin, A., Del Vecchio, D. & Weiss, R. A load driver
device for engineering modularity in biological networks. Nat. Biotechnol. 32,
1268 (2014).
58. Del Vecchio, D., Abdallah, H., Qian, Y. & Collins, J. J. A blueprint for a
synthetic genetic feedback controller to reprogram cell fate. Cell Syst. 4,
109–120.e11 (2017).
59. Castillo-Hair, S. M. et al. FlowCal: a user-friendly, open source software tool
for automatically converting ﬂow cytometry data from arbitrary to calibrated
units. ACS Synth. Biol. 5, 774–780 (2016).
60. Kelly, J. R. et al. Measuring the activity of BioBrick promoters using an in vivo
reference standard. J. Biol. Eng. 3, 4 (2009).
61. Zadeh, J. N. et al. NUPACK: analysis and design of nucleic acid systems. J.
Comput. Chem. 32, 170–173 (2011).
62. Curtis, M. et al. Synthetic Biology Open Language Visual (SBOL Visual) Version
2.1. J. Integr. Bioinforma. https://doi.org/10.1515/jib-2018-0101 (2019).
63. Der, B. S. et al. DNAplotlib: programmable visualization of genetic designs
and associated data. ACS Synth. Biol. 6, 1115–1119 (2017).
64. Bartoli, V., Dixon, D. O. R. & Gorochowski, T. E. Automated visualization of
genetic designs using DNAplotlib. in Synthetic Biology: Methods and Protocols
(ed. Braman, J. C.) 399–409 (Springer, New York, 2018). https://doi.org/
10.1007/978-1-4939-7795-6_22.
65. Chen, Y.-J. et al. Characterization of 582 natural and synthetic
terminators and quantiﬁcation of their design constraints. Nat. Methods
10, 659 (2013).
Acknowledgements
The authors wish to acknowledge the assistance of Dr Andrew Herman and Dr Lorena
Sueiro Ballesteros of the University of Bristol Faculty of Biomedical Sciences Flow
Cytometry Facility, and Bettina Frank of the Anderson Lab. This work was supported
by BrisSynBio, a BBSRC/EPSRC Synthetic Biology Research Centre grant BB/
L01386X/1 (M.d.B., T.E.G.), EPSRC/BBSRC Centre for Doctoral Training in Synthetic
Biology grant EP/L016494/1 (V.B.), the EU Horizon 2020 research project COSY-BIO
grant 766840 (M.d.B), and a Royal Society University Research Fellowship grant
UF160357 (T.E.G.)
Author contributions
T.E.G. conceived of the study. V.B., T.E.G., and G.A.M. performed the experiments. V.B.,
M.d.B., and T.E.G. developed the mathematical models. V.B. analyzed the data. T.E.G.,
V.B., M.d.B., and G.A.M. wrote the manuscript.
Competing interests
The authors declare no competing interests.
Additional information
Supplementary information is available for this paper at https://doi.org/10.1038/s41467-
020-15653-7.
Correspondence and requests for materials should be addressed to T.E.G.
Peer review information Nature Communications thanks the anonymous reviewer(s) for
their contribution to the peer review of this work. Peer reviewer reports are available.
Reprints and permission information is available at http://www.nature.com/reprints
Publisher’s note Springer Nature remains neutral with regard to jurisdictional claims in
published maps and institutional afﬁliations.
Open Access This article is licensed under a Creative Commons
Attribution 4.0 International License, which permits use, sharing,
adaptation, distribution and reproduction in any medium or format, as long as you give
appropriate credit to the original author(s) and the source, provide a link to the Creative
Commons license, and indicate if changes were made. The images or other third party
material in this article are included in the article’s Creative Commons license, unless
indicated otherwise in a credit line to the material. If material is not included in the
article’s Creative Commons license and your intended use is not permitted by statutory
regulation or exceeds the permitted use, you will need to obtain permission directly from
the copyright holder. To view a copy of this license, visit http://creativecommons.org/
licenses/by/4.0/.
© The Author(s) 2020
NATURE COMMUNICATIONS | https://doi.org/10.1038/s41467-020-15653-7
ARTICLE
NATURE COMMUNICATIONS |   (2020) 11:2095 | https://doi.org/10.1038/s41467-020-15653-7 | www.nature.com/naturecommunications
11

