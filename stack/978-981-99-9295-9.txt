CPSS Power Electronics Series
Xinbo Ruan
Lihong Xie
Qing Ji
Xibo Yuan
Conducted 
Electromagnetic 
Interference in 
Power Converters: 
Modeling, Prediction 
and Reduction

CPSS Power Electronics Series 
Series Editors 
Wei Chen, Fuzhou University, Fuzhou, Fujian, China 
Yongzheng Chen, Liaoning University of Technology, Jinzhou, Liaoning, China 
Xiangning He, Zhejiang University, Hangzhou, Zhejiang, China 
Yongdong Li, Tsinghua University, Beijing, China 
Jingjun Liu, Xi’an Jiaotong University, Xi’an, Shaanxi, China 
An Luo, Hunan University, Changsha, Hunan, China 
Xikui Ma, Xi’an Jiaotong University, Xi’an, Shaanxi, China 
Xinbo Ruan, Nanjing University of Aeronautics and Astronautics, Nanjing Shi, 
Jiangsu, China 
Kuang Shen, Zhejiang University, Hangzhou, Zhejiang, China 
Dianguo Xu, Harbin Institute of Technology, Haerbin Shi, Heilongjiang, China 
Jianping Xu, Xinan Jiaotong University, Chengdu, Sichuan, China 
Mark Dehong Xu, Zhejiang University, Hangzhou, Zhejiang, China 
Xiaoming Zha, Wuhan University, Wuhan, Hubei, China 
Bo Zhang, South China University of Technology, Guangzhou Shi, Guangdong, 
China 
Lei Zhang, China Power Supply Society, Tianjin, China 
Xin Zhang, Hefei University of Technology, Heifei Shi, Anhui, China 
Zhengming Zhao, Tsinghua University, Haidian Qu, Beijing, China 
Qionglin Zheng, Beijing Jiaotong University, Haidian, Beijing, China 
Luowei Zhou, Chongqing University, Chongqing, Sichuan, China

This series comprises advanced textbooks, research monographs, professional 
books, and reference works covering different aspects of power electronics, such 
as Variable Frequency Power Supply, DC Power Supply, Magnetic Technology, 
New Energy Power Conversion, Electromagnetic Compatibility as well as Wireless 
Power Transfer Technology and Equipment. The series features leading Chinese 
scholars and researchers and publishes authored books as well as edited 
compilations. It aims to provide critical reviews of important subjects in the ﬁeld, 
publish new discoveries and signiﬁcant progress that has been made in develop-
ment of applications and the advancement of principles, theories and designs, and 
report cutting-edge research and relevant technologies. The CPSS Power 
Electronics series has an editorial board with members from the China Power 
Supply Society and a consulting editor from Springer. 
Readership: Research scientists in universities, research institutions and the industry, 
graduate students, and senior undergraduates.

Xinbo Ruan · Lihong Xie · Qing Ji · Xibo Yuan 
Conducted Electromagnetic 
Interference in Power 
Converters: Modeling, 
Prediction and Reduction

Xinbo Ruan 
College of Automation Engineering 
Nanjing University of Aeronautics 
and Astronautics 
Nanjing, China 
Qing Ji 
College of Mechanical and Electrical 
Engineering 
Soochow University 
Suzhou, China 
Lihong Xie 
College of Automation Engineering 
Nanjing University of Aeronautics 
and Astronautics 
Nanjing, China 
Xibo Yuan 
School of Electrical Engineering 
China University of Mining and Technology 
Xuzhou, China 
ISSN 2520-8853
ISSN 2520-8861 (electronic) 
CPSS Power Electronics Series 
ISBN 978-981-99-9294-2
ISBN 978-981-99-9295-9 (eBook) 
https://doi.org/10.1007/978-981-99-9295-9 
© The Editor(s) (if applicable) and The Author(s), under exclusive license to Springer Nature 
Singapore Pte Ltd. 2024 
This work is subject to copyright. All rights are solely and exclusively licensed by the Publisher, whether 
the whole or part of the material is concerned, speciﬁcally the rights of translation, reprinting, reuse 
of illustrations, recitation, broadcasting, reproduction on microﬁlms or in any other physical way, and 
transmission or information storage and retrieval, electronic adaptation, computer software, or by similar 
or dissimilar methodology now known or hereafter developed. 
The use of general descriptive names, registered names, trademarks, service marks, etc. in this publication 
does not imply, even in the absence of a speciﬁc statement, that such names are exempt from the relevant 
protective laws and regulations and therefore free for general use. 
The publisher, the authors, and the editors are safe to assume that the advice and information in this book 
are believed to be true and accurate at the date of publication. Neither the publisher nor the authors or 
the editors give a warranty, expressed or implied, with respect to the material contained herein or for any 
errors or omissions that may have been made. The publisher remains neutral with regard to jurisdictional 
claims in published maps and institutional afﬁliations. 
This Springer imprint is published by the registered company Springer Nature Singapore Pte Ltd. 
The registered company address is: 152 Beach Road, #21-01/04 Gateway East, Singapore 189721, 
Singapore 
Paper in this product is recyclable.

Preface 
With the development of power electronics technology, power converters have been 
widely used in various ﬁelds such as general industry, power system, electriﬁed 
transportation, information technology, aerospace and home appliance and have also 
become increasingly essential in leading areas such as renewable energy genera-
tion, ﬂexible AC/DC power transmission, electric vehicles, energy saving and envi-
ronmental protection. However, the switching actions of power devices in power 
converters result in high changing rates in voltage (dv/dt) and current (di/dt), and 
the conducted emissions are generated. These emissions not only pollute the grid, 
but also affect the operation of nearby equipment, leading to the conducted electro-
magnetic interference (EMI) issues. With the applications of wide-band gap power 
devices and the increased power density, the electromagnetic compatibility (EMC) 
issue becomes more urgent to be solved. 
This book aims to present the modeling, prediction and reduction of the conducted 
EMI in power converters, including the AC-DC rectiﬁers, DC-DC converters and 
DC-AC inverters. The detailed theoretical analysis with design examples and 
experimental validations is covered. 
This book contains 11 chapters. 
In Chap. 1, the basic concepts of EMC and EMI are brieﬂy introduced. The gener-
ation of common-mode (CM) and differential-mode (DM) EMI in power converters 
is presented. Then, the research status and key issues for the conducted EMI in the 
power converters are reviewed, including the AC-DC rectiﬁers, DC-DC converters 
and DC-AC inverters. 
In Chap. 2, the main instruments for measuring the conducted EMI are introduced, 
and their operation principles are explained in detail. This chapter also presents the 
design of EMI ﬁlters. 
Chapters 3–5 focus speciﬁcally on the conducted EMI of boost power factor 
correction (PFC) converters.
v

vi
Preface
In Chap. 3, the propagation paths for the CM and DM noises of the PFC converter 
is analyzed, and the DM capacitors are added at the AC and DC sides of the rectiﬁer 
bridge to suppress the mixed-mode noise. After that, the CM and DM noise equivalent 
circuits are derived, which provide the basis for predicting the CM and DM noise 
spectra of boost PFC converter with different control schemes. The design of EMI 
ﬁlters for the boost PFC converter is also presented. 
In Chap. 4, the operation modes of average-current-controlled boost PFC converter 
are analyzed. The drain-to-source voltage for the power switch is treated as the noise 
voltage source that creates the conducted EMI, and its spectrum characteristics are 
discussed. Then, the CM and DM noise spectra under different input voltage and 
load are predicted, and the worst conducted EMI spectrum is ﬁgured out. Based on 
the worst conducted EMI spectrum, the EMI ﬁlter design is developed. 
Chapter 5 focuses on the modeling and prediction for the conducted EMI in 
critical conduction mode (CRM) boost PFC converter. The spectrum characteristics 
of the drain-to-source voltage for the power switch are analyzed, and the CM and 
DM noise spectra are investigated. Based on the model of EMI receiver, the peak, 
quasi-peak and average values of the CM and DM noises are analyzed. By deriving 
the maximum boundaries for the CM and DM noise, the design guidelines for the 
EMI ﬁlter of CRM boost PFC converters are presented. 
Chapters 6–10 present the modeling and reduction of the CM noise in DC-DC 
converters. 
In Chap. 6, a generalized lumped capacitance model of the transformer is derived, 
and then the CM noise model of isolated DC-DC converters. Based on the CM noise 
model, the equivalent noise source (ENS) concept is proposed to analyze the CM 
noise characteristics of basic isolated power converters. The topologies that have 
the capability of CM noise cancelation (CMNC) are identiﬁed, and the effects of 
transformer winding structure as well as the circuit conﬁguration on the CM noise 
are discussed. 
Chapter 7 focuses on the shielding-based approach for reducing the CM noise 
in isolated DC-DC converters. The shielding-winding method and the combined 
shielding and balancing-winding method are proposed to mitigate the displacement 
current ﬂowing through the transformer inter-winding capacitance. Furthermore, 
the hybrid passive cancelation (HPC) method is developed to further cancel the 
displacement current ﬂowing through the parasitic capacitance between the high dv/ 
dt nodes in the primary circuit and the protective earth (PE). 
In Chap. 8, the CM noise reduction for phase-shifted full-bridge (PSFB) converter 
is specially discussed, as this topology does not have the CMNC capability. The 
electric potentials of two phase-leg midpoints and the voltage across the resonant 
inductor are identiﬁed as the noise voltage sources that generate the CM noise, and 
then a combined method of symmetry circuit and passive cancelation is proposed to 
eliminate the impact of these noise source voltages on the CM noise effectively, and 
thus reduce the CM noise.

Preface
vii
Chapter 9 explores the CM voltage cancelation (CMVC) method in DC-DC 
converters. This method introduces a CM voltage compensation branch connected 
in series with the input of power converter to cancel the CM voltage of the converter. 
The applications of the CMVC method in both non-isolated and isolated DC-DC 
converters are presented. 
Chapter 10 focuses on the CM currents reduction at both the input and output sides 
of non-isolated DC-DC converters. The split-winding (SW) method is proposed, 
where the original inductor winding is split and redistributed into the input, ground 
and output sides for canceling the CM currents. 
Chapter 11 is dedicated to the CM currents reduction at both the input and output 
sides of DC-AC inverters. The CMVC method is proposed, where two CM trans-
formers are inserted at the input and output sides of the inverter for canceling the 
CM voltage of the inverter. 
This book is essential and valuable reference for graduate students and academics 
majoring in power electronics. It is also beneﬁcial for engineers involved in 
addressing EMC issues in aerospace power supply, server power supply, charger 
and drive systems in electrical vehicles, and renewable energy generation systems. 
Senior undergraduate students majoring in electrical engineering and automation 
engineering would also ﬁnd this book useful. 
Nanjing, China 
Nanjing, China 
Suzhou, China 
Xuzhou, China 
Xinbo Ruan 
Lihong Xie 
Qing Ji 
Xibo Yuan

Acknowledgements 
This research monograph summarizes the research work on the conducted electro-
magnetic interference (EMI) of power converters since 2009. 
The work in this book was partially supported by the Lite-On Technology 
Corporation. We would like to express our sincere gratitude to this support. 
GPT-3.5 was used to reﬁne the English language in this research monograph. 
It has been a great pleasure to work with the colleagues of Springer, Science 
Press, China, and China Power Supply Society (CPSS). The support and help from 
Mr. Wayne Hu (the Project Editor) and Vidyaa Shri Krishna Kumar are greatly 
appreciated. 
July 2023
ix

About This Book 
In power converters, the switching actions of power devices generate high changing 
rates in voltage (dv/dt) and current (di/dt), leading to the conducted emissions. These 
emissions not only pollute the grid, but also affect the operation of nearby equipment, 
resulting in the conducted electromagnetic interference (EMI) issues. This book 
focuses on the modeling, prediction and reduction of the conducted EMI in power 
converters, including the AC-DC rectiﬁers, DC-DC converters and DC-AC inverters. 
The detailed theoretical analysis with design examples and experimental validations 
is covered. This monograph is not only a reference book for master students, Ph.D. 
students and teachers majoring in power electronics, but also a handbook for the 
electrical engineers working on EMC issues in aerospace power supply, server power 
supply, charger and drive systems in electrical vehicles, renewable energy generation 
systems, etc.
xi

Contents 
1
Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
1 
1.1
A Brief Introduction to the EMC and EMI . . . . . . . . . . . . . . . . . . .
1 
1.1.1
The Concept of EMC . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
1 
1.1.2
The Concept of Conducted and Radiated EMI
. . . . . . . .
2 
1.2
Conducted EMI in Power Converters . . . . . . . . . . . . . . . . . . . . . . . .
4 
1.3
Modeling and Prediction of the CM and DM EMI 
in AC-DC Rectiﬁers . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
7 
1.3.1
Operating Modes and Control Schemes for Boost 
PFC Converter . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
8 
1.3.2
Modeling and Prediction of the CM and DM EMI 
in Boost PFC Converter . . . . . . . . . . . . . . . . . . . . . . . . . . . .
10 
1.4
Modeling and Reduction of the CM EMI in DC-DC 
Converters . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
11 
1.4.1
Modeling of the CM EMI in DC-DC Converters . . . . . . .
11 
1.4.2
Reduction of the CM EMI in DC-DC Converters . . . . . .
13 
1.5
Modeling and Reduction of the CM EMI in DC-AC 
Inverters . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
19 
1.6
Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
21 
References . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
21 
2
Measurement of Conducted Electro-magnetic Interference 
(EMI) and Design of EMI Filter . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
25 
2.1
Measurement of Conducted Electromagnetic Interference 
(EMI) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
25 
2.1.1
Test Setup for Measuring the Conducted EMI . . . . . . . . .
25 
2.1.2
Line Impedance Stabilization Network . . . . . . . . . . . . . . .
25 
2.1.3
Separation of the CM and DM Noises . . . . . . . . . . . . . . .
27 
2.1.4
EMI Receiver . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
28
xiii

xiv
Contents
2.2
Design of EMI Filter for Power Converters . . . . . . . . . . . . . . . . . . .
34 
2.2.1
Topology and Attenuation Performance of EMI 
Filter . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
34 
2.2.2
Design of EMI Filter . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
36 
2.3
Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
37 
References . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
38 
3
Common-Mode and Differential-Mode Noise Equivalent 
Circuits for Boost Power Factor Correction Converter . . . . . . . . . . . .
39 
3.1
Common-Mode and Differential-Mode Noises in Boost 
PFC Converter . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
39 
3.1.1
Noise Propagation Path and Mixed-Mode Noise 
Reduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
39 
3.1.2
CM and DM Noise Equivalent Circuits of Boost 
PFC Converter . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
44 
3.2
Design of the EMI Filter for Boost PFC Converters . . . . . . . . . . .
46 
3.2.1
EMI Filter for Boost PFC Converters . . . . . . . . . . . . . . . .
46 
3.2.2
Design of the EMI Filter for the Boost PFC 
Converter . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
46 
3.3
Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
48 
References . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
48 
4
Prediction of the Conducted Electro-magnetic Interference 
for Average-Current-Controlled Boost Power Factor 
Correction Converter . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
51 
4.1
Operation Modes of Average-Current-Controlled Boost 
PFC Converters . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
51 
4.2
The Voltage Across the Power Switch Under Different 
Operation Modes . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
54 
4.2.1
The Waveforms of vDS in CCM and DCM Within 
a Switching Cycle . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
56 
4.2.2
The Waveforms of Duty Cycle and vDS in a Half 
Line Cycle . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
58 
4.3
Prediction of the Conducted EMI for the Boost PFC 
Converter . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
60 
4.3.1
The Harmonic Amplitude of vDS . . . . . . . . . . . . . . . . . . . .
60 
4.3.2
Characteristics of the Conducted EMI of the Boost 
PFC Converter . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
61 
4.4
EMI Filter Design for Average-Current-Controlled Boost 
PFC Converter . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
66 
4.5
Experimental Results . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
68 
4.5.1
Speciﬁcations of the Prototype . . . . . . . . . . . . . . . . . . . . . .
68 
4.5.2
Experimental Results . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
68 
4.6
Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
72 
References . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
74

Contents
xv
5
Prediction of the Conducted Electro-magnetic Interference 
for Critical Conduction Mode Boost Power Factor Correction 
Converter . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
77 
5.1
Operation Principle of the CRM Boost PFC Converter . . . . . . . . .
77 
5.2
Conducted EMI Spectra of the CRM Boost PFC Converter . . . . .
79 
5.2.1
Harmonic Spectrum of vDS . . . . . . . . . . . . . . . . . . . . . . . . .
79 
5.2.2
Harmonic Spectra of the CM and DM Noise 
Voltages . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
81 
5.2.3
Peak, Quasi-peak, and Average Spectra 
of the Conducted EMI . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
82 
5.3
Prediction of the Conducted EMI of the CRM Boost PFC 
Converter . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
85 
5.4
EMI Filter Design for the CRM Boost PFC Converter . . . . . . . . .
88 
5.5
Experimental Results . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
91 
5.5.1
Speciﬁcations of the Prototype . . . . . . . . . . . . . . . . . . . . . .
91 
5.5.2
Experimental Results . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
91 
5.6
Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
93 
References . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
95 
6
Modeling of the Common-Mode Noise for Isolated DC-DC 
Converters . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
97 
6.1
The CM Noise Propagation Paths of Isolated DC-DC 
Converters . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
97 
6.2
A Generalized Lumped Capacitance Model . . . . . . . . . . . . . . . . . .
97 
6.2.1
Characteristics of Inter-winding Capacitance 
of the Transformer . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
97 
6.2.2
The Displacement Current Flowing Through 
Inter-winding Capacitances . . . . . . . . . . . . . . . . . . . . . . . .
98 
6.2.3
The General Lumped Capacitance Model 
of the Transformer . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
102 
6.3
The CM Noise Model of Basic Isolated DC-DC Converters
. . . .
103 
6.3.1
Derivation for the CM Noise Model of Flyback 
Converter . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
103 
6.3.2
The CM Noise Model of Other Basic Isolated 
DC-DC Converters . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
106 
6.4
The CMNC Capability of Isolated DC-DC Converters . . . . . . . . .
111 
6.5
Experimental Veriﬁcation and Discussions . . . . . . . . . . . . . . . . . . .
113 
6.5.1
The Veriﬁcation of the Lumped Capacitance Model . . . .
113 
6.5.2
The Veriﬁcation of the CM Noise Model . . . . . . . . . . . . .
115 
6.6
Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
120 
References . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
120 
7
Shielding-Based Common-Mode Noise Cancellation 
Techniques for Isolated DC-DC Converters . . . . . . . . . . . . . . . . . . . . . .
121 
7.1
Shielding Techniques . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
121 
7.1.1
Single-Shielding Technique . . . . . . . . . . . . . . . . . . . . . . . .
121

xvi
Contents
7.1.2
Double-Shielding Technique . . . . . . . . . . . . . . . . . . . . . . .
122 
7.2
Condition and Solutions to Achieve the CM Noise 
Cancellation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
123 
7.2.1
Condition to Achieve the CM Noise Cancellation . . . . . .
123 
7.2.2
The AEP of Secondary-Winding Layers 
and Shielding Layers . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
123 
7.2.3
Solutions to Achieve the CMNC Capability . . . . . . . . . . .
126 
7.3
Applications of the Shielding Winding Method . . . . . . . . . . . . . . .
128 
7.3.1
Combination of the Shielding Winding 
and Secondary Winding . . . . . . . . . . . . . . . . . . . . . . . . . . .
128 
7.3.2
Applications of the Shielding Winding Method . . . . . . . .
129 
7.4
Application of the Combined Shielding 
and Balancing-Winding Method . . . . . . . . . . . . . . . . . . . . . . . . . . . .
134 
7.4.1
The Secondary Rectiﬁer and Filters for Applying 
the Combined Shielding and Balancing-Winding 
Method . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
134 
7.4.2
Calculating the Turns of Balancing Winding 
and the Angle θ 0 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
134 
7.5
Hybrid Passive Cancellation Method . . . . . . . . . . . . . . . . . . . . . . . .
135 
7.5.1
Principle of the HPC Method . . . . . . . . . . . . . . . . . . . . . . .
135 
7.5.2
Applications of the HPC Method . . . . . . . . . . . . . . . . . . . .
137 
7.6
Experimental Veriﬁcation and Discussion . . . . . . . . . . . . . . . . . . . .
139 
7.6.1
Veriﬁcation of the Shielding Winding Method . . . . . . . . .
139 
7.6.2
Veriﬁcation of the Combined Shielding 
and Balancing-Winding Method . . . . . . . . . . . . . . . . . . . .
141 
7.6.3
Veriﬁcation of the HPC Method . . . . . . . . . . . . . . . . . . . . .
143 
7.7
Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
144 
References . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
145 
8
Reducing the Common-Mode Noise in Phase-Shifted 
Full-Bridge Converter . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
147 
8.1
The Common-Mode (CM) Noise Model 
of the Phase-Shifted Full-Bridge (PSFB) Converter
. . . . . . . . . . .
147 
8.1.1
The PSFB Converter and Its CM Noise Model . . . . . . . .
147 
8.1.2
The Derivation of the Two Capacitor Cae and Cbe . . . . . .
149 
8.1.3
The Simpliﬁcation of the CM Noise Model . . . . . . . . . . .
150 
8.2
Applying Symmetry Circuit to Eliminate the Impact 
of Resonant Inductor Voltage on the CM Noise . . . . . . . . . . . . . . .
151 
8.2.1
Adoption of Symmetrical Resonant Inductor . . . . . . . . . .
151 
8.2.2
Adoption of Symmetrical Transformer . . . . . . . . . . . . . . .
152 
8.3
Applying Passive Cancellation to Eliminate the Impact 
of Midpoint Voltages on the CM Noise . . . . . . . . . . . . . . . . . . . . . .
154 
8.3.1
Implementation I . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
156 
8.3.2
Implementation II . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
156 
8.4
The Necessity of Combining Two Methods . . . . . . . . . . . . . . . . . .
157

Contents
xvii
8.4.1
Solution with Only Symmetrical Resonant 
Inductor . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
159 
8.4.2
Solution with Only Passive Cancellation Circuit . . . . . . .
159 
8.5
Experimental Veriﬁcation
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
160 
8.5.1
Descriptions of the Prototype . . . . . . . . . . . . . . . . . . . . . . .
160 
8.5.2
Measurement and Comparison of the CM Noise . . . . . . .
162 
8.6
Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
164 
References . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
165 
9
Reducing the Common-Mode (CM) Noise in DC-DC 
Converters by the CM Voltage Cancellation Method . . . . . . . . . . . . . .
167 
9.1
The Common-Mode Voltage Cancellation Method . . . . . . . . . . . .
167 
9.2
Application of the CMVC Method in Non-isolated DC-DC 
Converters . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
169 
9.3
Application of the CMVC Method in Isolated DC-DC 
Converters . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
171 
9.4
Practical Considerations for the CMVC Method . . . . . . . . . . . . . .
176 
9.4.1
Restriction of the Input Current . . . . . . . . . . . . . . . . . . . . .
176 
9.4.2
Inﬂuence of the Reﬂected CM Currents . . . . . . . . . . . . . .
176 
9.4.3
Balancing Capacitor for Achieving the CMVC . . . . . . . .
176 
9.4.4
Capacitive Coupling Effect . . . . . . . . . . . . . . . . . . . . . . . . .
178 
9.4.5
Effect of Leakage Inductance . . . . . . . . . . . . . . . . . . . . . . .
179 
9.5
Experimental Veriﬁcation
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
179 
9.5.1
Buck Converter . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
180 
9.5.2
Half-Bridge LLC Resonant Converter . . . . . . . . . . . . . . . .
183 
9.6
Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
186 
References . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
186 
10 
Reducing the Common-Mode Currents at the Input 
and Output Sides in Non-isolated DC-DC Conveters . . . . . . . . . . . . . .
187 
10.1 
The Common-Mode (CM) Noise Model of Buck Converter 
Considering the CM Impedances at the Input and Output 
Sides . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
187 
10.2 
The CM Current Reduction of Both Sides in Buck 
Converters . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
189 
10.2.1 
Derivation of the CM Noise Cancellation Method . . . . .
189 
10.2.2 
Comparison of the Total Cross-Sectional Area 
of Windings . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
190 
10.3 
The Balance Condition Considering Imperfect Coupling . . . . . . .
192 
10.4 
Applications in Other Non-isolated DC-DC Converters . . . . . . . .
194 
10.5 
Experimental Veriﬁcation
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
195 
10.6 
Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
199 
References . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
199

xviii
Contents
11 
Reducing the Common-Mode Currents at the Input 
and Output Sides in DC-AC Inverter Systems . . . . . . . . . . . . . . . . . . . .
201 
11.1 
A Generalized CM Noise Model of Inverter Systems . . . . . . . . . .
201 
11.2 
Derivation and Realization of the CM Voltage Cancellation 
Method . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
203 
11.2.1 
Derivation of the CM Voltage Cancellation Method . . . .
203 
11.2.2 
Realization of the CM Voltage Cancellation 
Method . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
204 
11.3 
Practical Considerations for the CMVC Method in Inverter 
Systems . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
205 
11.3.1 
Restriction of Input and Output Currents . . . . . . . . . . . . .
205 
11.3.2 
Balancing Capacitor . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
205 
11.3.3 
The Inﬂuence of Parasitics in the CMT . . . . . . . . . . . . . . .
206 
11.3.4 
Comparison with Other Methods . . . . . . . . . . . . . . . . . . . .
206 
11.4 
Experimental Veriﬁcation
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
208 
11.4.1 
Speciﬁcations of the Prototype . . . . . . . . . . . . . . . . . . . . . .
208 
11.4.2 
The Veriﬁcation of the CMVC Method . . . . . . . . . . . . . . .
210 
11.5 
Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
213 
References . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
213

About the Authors 
Xinbo Ruan received the B.S. and Ph.D. degrees in electrical engineering from 
Nanjing University of Aeronautics and Astronautics (NUAA), Nanjing, China, in 
1991 and 1996, respectively. 
In 1996, he joined the Faculty of Electrical Engineering Teaching and Research 
Division, NUAA, where he became a Professor in the College of Automation Engi-
neering in 2002 and has been engaged in teaching and research in the ﬁeld of power 
electronics. From August to October 2007, he was a Research Fellow in the Depart-
ment of Electronic and Information Engineering, Hong Kong Polytechnic Univer-
sity, Hong Kong, China. From March 2008 to August 2011, he was also with the 
School of Electrical and Electronic Engineering, Huazhong University of Science 
and Technology, China. He is the author or co-author of 13 books and more than 300 
technical papers published in journals and conferences. His main research interests 
include resonant and soft-switching power converters, power converter topologies 
and control, grid-connected converters and system for renewable energy, modeling 
and stability of power converters, and envelop tracking power supply. 
Prof. Ruan was a recipient of Sustainable Energy Systems Technical Achieve-
ment Award from IEEE Power Electronics Society in 2022, the Delta Scholarship 
by the Delta Environment and Education Fund in 2003 and was a recipient of the 
Special Appointed Professor of the Chang Jiang Scholars Program by the Ministry 
of Education, China, in 2007. From 2005 to 2013, and since 2017 again, he serves as 
Vice President of the China Power Supply Society (CPSS). From 2014 to 2016, he 
served as a Vice Chair of the Technical Committee on Renewable Energy Systems 
within the IEEE Industrial Electronics Society. Currently, he serves as an Editor for 
IEEE Journal of Emerging and Selected Topics on Power Electronics and an Asso-
ciate Editor for IEEE Transactions on Industrial Electronics, IEEE Transactions 
on Power Electronics, IEEE Transactions on Circuits and Systems–II. He was  the  
General Chair of IPEMC-ECCE Asia 2020 and the General Secretary of IPEMC-
ECCE Asia 2009, a Technical Program Committee Chair of the IEEE 7th Annual 
Energy Conversion Congress and Exposition, and a Tutorial Committee Chair of the 
IEEE 12th Annual Energy Conversion Congress and Exposition.
xix

xx
About the Authors
Lihong Xie received the B.S. and Ph.D. degrees in electrical engineering from 
Nanjing University of Aeronautics and Astronautics (NUAA), Nanjing, China, in 
2012 and 2018, respectively. 
From November 2018 to August 2022, he worked as a research associate in the 
Electrical Energy Management Group (EEMG) at the University of Bristol as part of 
its work with the EPSRC Centre for Power Electronics. Since October 2022, he joined 
the College of Automation in NUAA as a Research Fellow. His current research 
interests include transformer modeling, conducted EMI and virtual prototyping of 
power converters. 
Qing Ji received the B.S. and Ph.D. degrees in electrical engineering from Nanjing 
University of Aeronautics and Astronautics (NUAA), Nanjing, China, in 2006 and 
2014, respectively. 
Since December 2014, he joined the College of Mechanical and Electrical Engi-
neering in Soochow University, and he is currently an Associate Professor. His 
research interests include power electronics and the mitigation of conducted EMI 
in power converters. 
Xibo Yuan received the B.S. degree from the China University of Mining and Tech-
nology, Xuzhou, China, and the Ph.D. degree from Tsinghua University, Beijing, 
China, in 2005 and 2010, respectively, both in electrical engineering. 
He has been a Professor since 2017 in the Electrical Energy Management Group, 
Department of Electrical and Electronic Engineering, University of Bristol, Bristol, 
UK. He also holds the Royal Academy of Engineering/Safran Chair in Advanced 
Aircraft Power Generation Systems. He is the Director of the UK National Centre for 
Power Electronics and an executive committee member of the IET Power Electronics, 
Machines and Drives (PEMD) network. 
His research interests include power electronics and motor drives, wind power 
generation, multilevel converters, application of wide-bandgap devices, electric vehi-
cles and more electric aircraft technologies. Professor Yuan is an Associate Editor 
of IEEE Transactions on Industry Applications and IEEE Journal of Emerging and 
Selected Topics in Power Electronics. He is a Fellow of IET and received The Isao 
Takahashi Power Electronics Award in 2018.

Chapter 1 
Introduction 
1.1 
A Brief Introduction to the EMC and EMI 
1.1.1 
The Concept of EMC 
Over the past few decades, there has been rapid development in microelectronics and 
power electronics technologies, signiﬁcantly enhancing the quality of life and work 
for human society. Figure 1.1 illustrates the diverse applications of electrical and 
electronic equipments, including their use in electriﬁed transportation, renewable 
energy generation, aerospace, information technology (IT), home appliance, and 
more.
However, the operation of these equipments produces electromagnetic emissions 
as a byproduct, which can propagate through conduction or radiation. These emis-
sions have the potential to disrupt the normal operation of the power grid, degrade 
the performance of other equipments, interfere with telecommunications and data 
transfer, or even pose a threat to human safety by affecting navigation system. As 
the electromagnetic environment becomes increasingly complex, ensuring electro-
magnetic compatibility (EMC) of electrical and electronic equipments has become 
paramount. This is crucial to guarantee the smooth operation of equipment and 
prevent electromagnetic pollution in the environment. 
EMC refers to the condition in which the electrical and electronic equipment 
can operate normally within its environment, and does not introduce electromag-
netic emission that other nearby equipment can not tolerate [1, 2]. Consequently, 
EMC encompasses two aspects: electromagnetic interference (EMI) and electro-
magnetic susceptibility (EMS). EMI refers to the occurance where electromagnetic 
emissions interfere with the proper functioning of other equipments. On the other 
hand, EMS characterizes the ability of equipment to endure or resist the impact of 
electromagnetic emissions without experiencing malfunction.
© The Author(s), under exclusive license to Springer Nature Singapore Pte Ltd. 2024 
X. Ruan et al., Conducted Electromagnetic Interference in Power Converters: Modeling, 
Prediction and Reduction, CPSS Power Electronics Series, 
https://doi.org/10.1007/978-981-99-9295-9_1 
1

2
1
Introduction
Conducted 
emission 
Radiated 
emission 
Thunder 
Grid 
Renewable energy 
generation 
Home appliance 
Base station 
Railway 
Transportation 
Data center 
Aerospace 
Fig. 1.1 The complex electromagnetic environment for electrical and electronic equipments
To address emerging EMI issues, the International Electrotechnical Commis-
sion (IEC) recommended the establishment of the “Comité International Spécial 
des Perturbations Radioélectriques” (CISPR) in Paris back in 1933. Since its incep-
tion, CISPR has played a pivotal role in developing various standards regarding the 
measurement and limits of EMI. For instance, CISPR 16 [3] delineates the equipment 
and procedure for EMI testing, while CISPR 22 [4] governs the measurement and 
limits for EMI from IT equipments. Today, the EMI standards established by CISPR 
have gained acceptance in most countries. In addition to CISPR, other organiza-
tions such as the Federal Communications Commission (FCC) and the Commission 
Européenne de Normalisation Électrotechnique (CENELEC) are actively involved 
in specifying related EMC standards. Examples include FCC Part 18 (for industrial, 
scientiﬁc and medical equipments) and EN 55025 (for boats and internal combustion 
engines). It is worth noting that EN 55022 [5] is functionally equivalent to CISPR 
22. 
1.1.2 
The Concept of Conducted and Radiated EMI 
Any EMI phenomenon comprises three essential elements, as shown in Fig. 1.2: 
noise source, coupling path and victim (or receiver). The noise source originates 
from natural phenomena or electrical and electronic equipments. When their elec-
tromagnetic emissions reach a certain level of strength, they create electromagnetic 
hazards. These hazards can lead to reduced performance, failures in other equip-
ments, or even pose risks to the well-being of humans and other living organisms. 
The victim is the equipment that is susceptible to degradation or failure when exposed

1.1 A Brief Introduction to the EMC and EMI
3
Noise source 
Radiation 
Conduction 
Coupling path 
Victim 
(Receiver) 
Fig. 1.2 Three elements of EMI 
to electromagnetic emissions. The coupling path serves as a connection between the 
noise source and the victim, and it has two typical mechanisms: conduction and 
radiation. The conduction coupling path is created by a physical wire that connects 
the noise source and the victim, and the radiation coupling path extends through the 
surrounding space via electromagnetic radiation. Both conducted EMI and radiated 
EMI represent instances where electromagnetic emissions interfere with other equip-
ment or even causes damage, and their coupling paths are conduction and radiation, 
respectively. 
Figure 1.3a, b illustrate typical conduction coupling paths. The direct conduction 
coupling occurs when two circuits are physically connected by wires. The common-
impedance coupling happens when the currents of two circuits share a common 
impedance. This is commonly observed in power distribution and grounding systems. 
Figure 1.3c–e show the radiation coupling paths, which can be classiﬁed into near-
ﬁeld and far-ﬁeld coupling. The electric coupling and magnetic coupling belong to 
near-ﬁeld coupling, which can be analyzed by a circuit-based approach. The far-ﬁeld 
coupling is usually analyzed by a ﬁeld-based approach, as it is the electromagnetic 
wave propagation between two circuits.
Conducted emission generated by the equipment can enter the power grid via 
direct conduction coupling. Consequently, conducted EMI standards normally stip-
ulate limits for conducted emissions through the input power cord of the equipment. 
For example, the CISPR 22 standard deﬁnes Quasi Peak (QP) and Average (AV) 
limits for IT equipments in Class A and Class B, as shown in Fig. 1.4. Equipments in 
Class A are intended for use in commercial and industrial environment, while Class 
B equipments are designed for residential use.
When initially formulating EMC standards, CISPR’s primary goal was to prevent 
interference with radio communication and broadcast signals. In civil applications, 
long-distance communication and broadcasting typically occur within the frequency 
range of [150 kHz, 1 GHz], since the electromagnetic waves below 150 kHz cannot 
propagate through the Earth’s ionosphere. Besides, conducted currents above 30 MHz 
experience signiﬁcantly attenuation, owing to the impedance and associated para-
sitic inductance of the power cord. Therefore, CISPR’s stipulated frequency range 
for conducted EMI is [150 kHz, 30 MHz]. Further details on the measurement 
of conducted EMI and the principle of the related instruments will be provided 
in Sect. 2.1 of Chap. 2.

4
1
Introduction
Circuit 1
Circuit 2
i1 
(grounding) 
Circuit 1
Circuit 2 
Grounding 
potential
i2 
(grounding) 
Common 
impedance 
Grounding 
potential 
(a) Direct conduction coupling
(b) Common-impedance coupling 
Conductor in 
circuit 1 
C12 
C1G 
V1 
C2G
R 
Conductor in 
circuit 2 
Loop in 
circuit 1 
R1 
V1
R 
Loop in 
circuit 2 
R2 
M 
Circuit 1
Circuit 2 
(c) Electric coupling
(d) Magnetic coupling
(e) Far-field radiation coupling 
Fig. 1.3 Typical coupling paths of conduction and radiation
Fig. 1.4 Conducted EMI 
limits of EN 55022 for 
equipments in Class A and B
Conducted EMI (dBμV) 
66 
56 
46 
QP limit 
AV limit 
150k
500k
5M
30M 
f (Hz) 
60 
50 
73 
79 
QP limit 
AV limit 
Class B 
Class A
1.2 
Conducted EMI in Power Converters 
With the rapid advancement of power electronics technologies, power converters have 
found widespread applications across various sectors, including general industry, 
power system, electriﬁed transportation, IT technology, aerospace, home appliance 
[6], and etc. Power devices in power converters are operated in high-frequency 
switching mannar, resulting in high rates of change in voltage (dv/dt) and current 
(di/dt) in the circuit. As a result, conducted emissions are generated in the input 
power cord, either through the input wire or near-ﬁeld coupling. This emission not 
only pollutes the grid, but also disrupts the operation of surrounding equipment, 
presenting signiﬁcant challenges related to conducted EMI [7–9].

1.2 Conducted EMI in Power Converters
5
Essentially, the conducted EMI appears as the noise currents in the input power 
cord, which can be separated into common-mode (CM) and differential-mode (DM) 
ones. Figure 1.5 shows the propagation path for the CM and DM currents in a power 
converter with an AC input. The CM noise current iCM is the component that has 
the same magnitude and direction in the input currents, which propagates through 
both the input cords and returns to the protective earth (PE). The DM noise current 
iDM is the component that has the same magnitude but opposite direction in the input 
currents, and it propagates within the input power cords and forms a closed circuit 
via the input source. 
In general, the DM noise in a power converter is associated with the input current 
caused by switching actions, while the CM noise is generated by the displacement 
current ﬂowing through parasitic capacitance between high dv/dt nodes in the circuit 
and the PE [10–15]. For non-isolated dc-dc converters, consider the boost converter 
shown in Fig. 1.6a as an example. During switching actions, the electric potential 
of the drain of switch Qb undergoes abrupt changes, leading to the generation of 
displacement current. This displacement current ﬂows through the parasitic capaci-
tance Cp, untimately entering the PE and causing CM noise. Cp primarily consists 
of the parasitic capacitance between the drain of Qb and the PE via the heatsink as 
shown in Fig. 1.6b, along with the stray capacitance between the trace of printed 
circuit board (PCB) and the PE. 
PE 
iCM 
iDM 
L 
N 
Power converter
to grid 
Fig. 1.5 The propagation path for the CM and DM currents 
Qb 
Vin
Co
RLd 
Lb
Db 
Cp 
PE
Power 
Switch 
Heatsink 
Insulation 
(a) Boost converter               (b) The origin of parasiric capacitance Cp 
Fig. 1.6 The CM noise propagation path of boost converter

6
1
Introduction
In high-power applications, safety considerations often lead to the heatsink 
connected to the PE. In such cases, the dominant propagation path for the CM noise 
is through the parasitic capacitance Cp between the drain of the power switch and the 
heatsink [16]. Cp is associated with the thickness and permittivity of the insulation 
as well as the relative area of the power switch and the heatsink. Typically, Cp falls 
within the range of tens of picofarads. 
Conversely, in low-power applications with plastic enclosure, the heatsink is 
often connected to the primary ground (PG). Consequently, the displacement current 
between the power switch and the heatsink remains within the circuit, which does 
not contribute to the CM noise. In this case, the dominant CM noise propagation path 
becomes the stray capacitance between the PCB trace and the PE. However, the CM 
noise is relatively low due to the small value of stray capacitance. 
Figure 1.7 shows the CM noise propagation path in an isolated power converter 
with AC input. The isolated power converter generally consists of input rectiﬁer 
bridge, primary circuit, transformer, and secondary rectiﬁer and ﬁlter. PG denotes 
the primary ground, and SG represents the secondary ground. In this converter, Cp 
represents the parasitic capacitance between the high dv/dt nodes in the primary 
circuit and the PE, Cs stands for the parasitic capacitance between the high dv/dt 
nodes in the secondary rectiﬁer and ﬁlter and the PE, and Cps is the inter-winding 
capacitance of the transformer. In cases where a three-wire input is used, SG is 
usually connected to PE for safety reasons. 
In Fig. 1.7, the CM noise propagation path is drawn with the dashed line, including 
Cp and Cps. According to the cutset between the transformer inter-winding capac-
itance and the PE, the displacement current that ﬂows through Cps is equal to iCps. 
Applying KCL for node J, we have  
2 i S ubscri pt CM 
Baseline equals i Subscript upper C p Baseline plus i Subscript upper C ps
where, 2iCM is the current ﬂowing through PE, and iCp is the current ﬂowing through 
Cp.
2iCM 
*
*
Vo 
Secondary 
rectifier 
and filter 
Primary 
circuit 
PG 
SG 
Cp
Cs 
Cps 
iCp
iCs 
iCps 
Cutset 
J 
PE 
L 
N 
to grid 
iCM 
Fig. 1.7 The CM noise propagation path of a general isolated dc-dc converter 

1.3 Modeling and Prediction of the CM and DM EMI in AC-DC Rectiﬁers
7
As noted in (1.1), both iCp and iCps contribute to the CM noise current iCM. 
Therefore, Cp and Cps are the critical components for propagating the CM noise in 
isolated power converters [17]. Note that, when SG is connected to PE, the displace-
ment current iCs does not contribute to the CM noise since it does not ﬂow back to 
the input side. 
In power converters, the CM and DM noise each have distinct origins, and conse-
quently, require different noise reduction methods. Therefore, separating the CM and 
DM noises is essential for several purposes, including diagnosing the conducted EMI 
spectrum, selecting the conducted EMI reduction methods, and designing the EMI 
ﬁlter. In Sect. 2.2 of Chap. 2, the separation of CM and DM noises and the design 
of EMI ﬁlter will be presented. The remainder of this book will cover the modeling, 
prediction and reduction of the conducted EMI in ac-dc rectiﬁers, dc-dc converters, 
and dc-ac inverters. As the ac-ac cycloconverter is relatively infrequently applied, its 
conducted EMI is not addressed in this monograph. 
1.3 
Modeling and Prediction of the CM and DM EMI 
in AC-DC Rectiﬁers 
The ac-dc rectiﬁer serves to transform an ac voltage into a dc voltage, and power 
factor correction (PFC) is usually incorporated for realizing unity power factor (PF). 
The PFC converter shapes the input current to a sinusoidal waveform that is in-phase 
with the input voltage, and also regulates the output voltage. 
There are various topologies for PFC converters, with the boost PFC converter 
being the most widely used, as shown in Fig. 1.8. This popularity is attributed to its 
relatively low ripple in the input current due to the presence of the input inductor Lb, 
a high PF, and a simple circuit conﬁguration. 
Co
Qb 
Lb
Db 
vg 
+ 
– 
L 
N 
vin
Vo 
+ 
– 
iLb 
RLd 
Fig. 1.8 The topology of boost PFC converter

8
1
Introduction
1.3.1 
Operating Modes and Control Schemes for Boost PFC 
Converter 
The boost PFC converter has three typical operating modes, i.e., continuous conduc-
tion mode (CCM), critical conduction mode (CRM) and discontinuous conduction 
mode (DCM). Figure 1.9 shows the waveform of the boost inductor current iLb in 
these operating modes. 
Under CCM, the inductor current ripple is very small, and high PF can be achieved. 
As a result, CCM is preferred for medium-to-high power applications. Figure 1.10 
illustrates the average-current-control diagram for the CCM boost PFC converter 
[18]. In this diagram, the converter operates using pulse-width modulated, and the 
switching frequency is constant. The output voltage is sensed and compared with the 
voltage reference V o_ref, The error signal in this comparison is sent into the voltage 
regulator Gv(s). The output of Gv(s) and the sensed input rectiﬁed voltage (referred 
to as “waveform input”) are multiplied, serving as the current reference iLb_ref for the 
inner current loop. The sensed inductor current is then compared with iLb_ref, and the 
error signal is sent into the current regulator Gi(s). The output of Gi(s) is compared 
with a sawtooth carrier signal, resulting in the generation of the driving signals for 
the switch Qb.
Under CRM, the boost diode is naturally turned off without experiencing reverse 
recovery, the power switch realizes zero-current-switching (ZCS), and high PF is 
achieved. Therefore, CRM is preferred in low-to-medium power conversions [19– 
21]. Figure 1.11 shows the control diagram of CRM boost PFC converter. In this 
diagram, the output of the voltage regulator Gv(s) and the sensed input rectiﬁed 
voltage are multiplied, serving as the peak reference for the inductor current, denoted 
as iLb. When iLb drops to zero, the zero-crossing detector (ZCD) is triggered, turning 
on the switch Qb. When iLb touches the peak reference, Qb is turned off. Under CRM,
0 
0
Tline/2
Tline/4 
t 
iLb iLb_avg 
0 
0
Tline/2
Tline/4 
t 
iLb_peak
iLb iLb_avg 
(a) CCM
                    (b) CRM 
0
Tline/2
Tline/4 
0
t 
iLb_peak
iLb
iLb_avg 
0
Tline/2
Tline/4 
0
t 
iLb 
iLb_avg 
(c) DCM (fixed duty-cycle control)                  (d) DCM (variable duty-cycle control) 
Fig. 1.9 Operation modes of boost PFC converter 

1.3 Modeling and Prediction of the CM and DM EMI in AC-DC Rectiﬁers
9
Co
Qb 
Lb
Db 
vg 
+ 
– 
L 
N 
vin
Vo 
+ 
– 
iLb 
Hv2 
Gv(s) 
Hi
Hv1 
Gi(s)
iLb_ref 
+ 
– 
+ 
– 
Driver 
RLd 
Vo_ref 
Fig. 1.10 The CCM boost PFC with average current control
iLb follows a triangular waveform within a switching cycle, with its average value 
being half of the peak current. As the peak reference for iLb tracks a sinusoidal pattern, 
the average value of iLb also becomes sinusoidal, leading to the realization of PFC. 
Under CRM, the switching frequency varies in a half-line cycle, and it is inﬂuenced 
by the input voltage and load. As a result, the conducted EMI characteristic of CRM 
boost PFC converter is quite complex. 
The DCM boost PFC converter offers certain advantages such as ZCS for the 
power switch and no reverse recovery for the diode. There are two primary control 
schemes for DCM boost PFC converters: ﬁxed duty-cycle control [22] and variable 
duty-cycle control [23], as shown in Fig. 1.12a, b, respectively.
Co 
Qb 
Lb
Db 
+ 
– 
L 
N 
vin
Vo 
+ 
– 
iLb 
R 
S
Q 
RLd 
vg 
Hv2 
Gv(s) 
Hv1 
+ 
– 
Hi
ZCD 
+ 
– 
A 
Driver 
Vo_ref 
Fig. 1.11 The CRM boost PFC converter 

10
1
Introduction
Co 
Qb 
Lb
Db 
vg 
+ 
– 
L 
N 
vin 
Vo 
+ 
– 
iLb 
RLd 
Gv(s) 
Hv1 
Vo_ref 
+ 
– 
Driver 
Co 
Qb 
Lb
Db 
RLd 
+ 
– 
L 
N 
vin 
Vo 
+ 
– 
iL b 
vg 
Hv 2
Gv(s) 
Hv1 
Vo_ref 
+ 
– 
Feedforward 
Fitting 
Driver 
(a) Fixed duty-cycle control                              (b) Variable duty-cycle control 
Fig. 1.12 The DCM boost PFC converter 
As shown in Fig. 1.12a, the control circuit of the DCM boost PFC converter 
with the ﬁxed duty-cycle control is relatively simple. However, the average value 
of the inductor current, as depicted in Fig. 1.9c, is not a sine wave in a half-line 
cycle, leading to a low PF. To achieve a high PF, the variable duty-cycle control is 
employed, as shown in Fig. 1.12b. The variable duty-cycle control is achieved by 
calculating the duty cycle of the converter that leads to unity PF, then utilizing input 
voltage feedforward control and ﬁtting algorithms to generate the desired duty cycle. 
In fact, the CCM boost PFC converter will partially operate in DCM under light 
load condition, and DCM will occur in half-line cycle as the load becomes lighter. 
1.3.2 
Modeling and Prediction of the CM and DM EMI 
in Boost PFC Converter 
The conducted EMI of boost PFC converter is inﬂuenced not only by the operating 
modes and control strategy, but also by the input voltage and load. For assisting the 
EMI ﬁlter design, it is necessary to predict the CM and DM EMI spectra of boost 
PFC converter under different input voltage and load condition. 
Simulation and numerical calculation methods are usually employed to predict the 
CM and DM EMI of power converters. In [24–28], the prediction of the CM and DM 
EMI in boost PFC converter by simulation is presented. In the simulation, practical 
models of the power switch and diode are incorporated, and a high-frequency model 
of inductors and capacitors that takes into account parasitics are adopted. Further-
more, the simulation integrates the impedance of PCB traces. Simulation method 
proves effective in accurately predicting the CM and DM EMI spectra. However, to 
determine the worst-case CM and DM EMI spectra for the EMI ﬁlter design, it is

1.4 Modeling and Reduction of the CM EMI in DC-DC Converters
11
necessary to simulate and compare CM (DM) EMI under various input voltage and 
load conditions, which is quite time-intensive. Moreover, the distinct CM and DM 
EMI spectra characteristics of the power converter under different input voltage and 
load condition remain unclear. 
The numerical calculation method begins by identifying the CM and DM noise 
propagation paths of the converter. Subsequently, and the CM and DM noise equiva-
lent circuits are established, respectively. Then, calculations are performed to deter-
mine the spectrum of the noise source, CM noise and DM noise. Finally, the CM 
and DM EMI spectra of the converter are predicted based on the operation princi-
ples of the EMI receiver. This method mainly considers the main circuit parameters 
and the dominant CM parasitic capacitance, making it suitable for predicting the 
CM and DM EMI at low frequencies. In [29], the numerical calculation method is 
employed to predict the CM and DM EMI in a CRM boost PFC converter. This 
approach successfully identiﬁes the worst-case CM and DM EMI spectra to assist 
the EMI ﬁlter design. However, this method does not provide a detailed analytical 
understanding of the CM and DM EMI of the converter. 
In Chap. 3, the CM and DM noise equivalent circuit of boost PFC converter will 
be ﬁrstly derived. Then, the inﬂuence of the main circuit parameters on the EMI ﬁlter 
performance will be discussed, and the EMI ﬁlter topology suitable for boost PFC 
converter will be presented. Based on the CM and DM noise equivalent circuits, the 
conducted EMI spectra characteristics of boost PFC converter with different control 
schemes will be further analyzed in Chaps. 4 and 5. In Chap. 4, the conducted 
EMI of average-current-controlled boost PFC converter will be studied, and the 
relationship between the operation modes and the input voltage and load conditions 
will be revealed. With the analysis of the CM and DM noise spectra of the converter 
under different operation modes, the worst case of the CM and DM EMI spectra 
are predicted, and the EMI ﬁlter design is given. In Chap. 5, the conducted EMI of 
CRM boost PFC converter is investigated. By analyzing the conducted EMI spectra 
characteristics under different input voltage and load conditions, the worst-case CM 
and DM EMI spectra are predicted to assist the EMI ﬁlter design. 
1.4 
Modeling and Reduction of the CM EMI in DC-DC 
Converters 
1.4.1 
Modeling of the CM EMI in DC-DC Converters 
DC-DC converters are used to generate a regulated DC voltage from an input DC 
voltage, which can be categorized into non-isolated and isolated ones. The DM 
EMI of DC-DC converters is relatively easy to be analyzed and reduced, since its 
propagation path is between the input power cords. Comparatively, managing the 
CM noise is challenging, owing to its complicated propagation path.

12
1
Introduction
In non-isolated DC-DC converters, the dominant CM noise propagation path is 
the parasitic capacitance between the high dv/dt nodes and the PE. Deriving its 
CM noise equivalent circuit is relatively straightforward. However, in isolated DC-
DC converters, the inter-winding capacitance of the high-frequency transformer is 
another critical propagation path for the CM noise. To achieve high efﬁciency, trans-
former windings are tightly wound to reduce the leakage inductance and AC resis-
tance of the windings, leading to a substantial inter-winding capacitance between 
the primary and secondary windings. In wire-wound transformers, the inter-winding 
capacitance usually ranges from tens of pF to hundreds of pF. For planar trans-
formers, due to their large relative area and small distance between the windings, 
the inter-winding capacitance is even larger, ranging from hundreds of pF to poten-
tially thousands of pF. The displacement current ﬂowing through the inter-winding 
capacitance is related to not only the capacitance, but also the electric potential distri-
bution within the transformer windings. Consequently, the CM noise issue in isolated 
DC-DC converters is more complex than that in non-isolated ones. 
Since the inter-winding capacitance presents complexities and inconvenient for 
circuit analysis, it is usually equivalently converted into lumped capacitances by 
keeping the displacement current unchanged. In [30], the inter-winding capacitance 
of the transformer in a ﬂyback converter is represented by two lumped capacitances, 
Cac and Cbd, as shown in Fig. 1.13a. In [31], the transformer inter-winding capac-
itance in a dual-switch forward converter is replaced by two lumped capacitances, 
Cac and Cbc, as shown in Fig. 1.13b. 
Basically, in the existing literatures, the lumped capacitances are determine by 
calculating the displacement current for a speciﬁc transformer winding structure, 
and the derived lumped capacitance may not be feasible for other topologies. As a 
solution to this issue, Chap. 6 will present a generalized lumped capacitance model 
for modeling the CM noise of a general isolated DC-DC converter with general 
transformer winding structure. Based on this model, the equivalent noise source 
(ENS) will be proposed for analyzing the CM noise of isolated DC-DC converters.
Vin
b 
* 
Q 
* 
CpB 
PE 
Co
RLd 
SG 
Cac 
PG 
Cbd 
a 
d 
c Do 
B 
Vi n  
a 
b 
* 
D1 
Q1 
Q2 
D2 
* 
DR 1  
DF W  
Lf 
Cp B
Cp A  
PE 
Co
RL d 
SG 
Ca c  
PG 
Cb c  
c 
d 
A 
B 
(a) Flyback converter
(b) Dual-switch forward converter 
Fig. 1.13 The lumped capacitance model in ﬂyback and dual-switch forward converters 

1.4 Modeling and Reduction of the CM EMI in DC-DC Converters
13
0
t 
τr
τf 
τw 
At 
At 
2 
Ts 
vnoise 
0 
f
1 
πτr 
0dB/dec 
−20dB/dec 
−40dB/dec 
1 
πτw 
Ts 
2Atτw 
Maximum 
Boundary 
Envelope 
(a) Time-domain waveform
(b) Frequency-domain spectrum 
Fig. 1.14 The noise voltage with typical trapezoidal waveform in the time-domain and the envelope, 
maximum boundary in the frequency-domain 
1.4.2 
Reduction of the CM EMI in DC-DC Converters 
For DC-DC converters, the CM EMI ﬁlters usually occupy signiﬁcant volume and 
weight, leading to reduced power density and efﬁciency of the converter. Therefore, 
it is necessary to suppress the original CM noise of DC-DC converters, in order to 
reduce the EMI ﬁlter size. Various techniques have been proposed to reduce the CM 
noise for DC-DC converters, such as the suppression methods at the source side, 
shielding technique and winding cancellation method in the transformer, symmetry 
circuits, the passive cancellation methods, and etc. 
1. Conducted EMI Reduction at the Source Side 
In general, the voltage across the main switches in DC-DC converters can be treated 
as the noise source that generates the conducted EMI. Figure 1.14a shows a typical 
noise voltage vnoise with a trapezoidal waveform, where, At is the amplitude, T s is 
the switching period, τ w is the duration when the voltage is rising and falling at At / 
2, τ r and τ f are the rising and falling time, respectively. Here, τ r and τ f is assumed 
to be the same. 
The harmonic amplitude of a trapezoidal waveform can be expressed as [32] 
upper V Subs cript nois
e normal bar amp Baseline left parenthesis k f Subscript s Baseline right parenthesis equals 2 upper A Subscript t Baseline StartFraction tau Subscript w Baseline Over upper T Subscript s Baseline EndFraction dot StartAbsoluteValue StartFraction sine left parenthesis pi tau Subscript w Baseline k f Subscript s Baseline right parenthesis Over pi tau Subscript w Baseline k f Subscript s Baseline EndFraction EndAbsoluteValue dot StartAbsoluteValue StartFraction sine left parenthesis pi tau Subscript r Baseline k f Subscript s Baseline right parenthesis Over pi tau Subscript r Baseline k f Subscript s Baseline EndFraction EndAbsoluteValue
up
e
r V 
Subscrip t noise normal bar amp Baseline left parenthesis k f Subscript s Baseline right parenthesis equals 2 upper A Subscript t Baseline StartFraction tau Subscript w Baseline Over upper T Subscript s Baseline EndFraction dot StartAbsoluteValue StartFraction sine left parenthesis pi tau Subscript w Baseline k f Subscript s Baseline right parenthesis Over pi tau Subscript w Baseline k f Subscript s Baseline EndFraction EndAbsoluteValue dot StartAbsoluteValue StartFraction sine left parenthesis pi tau Subscript r Baseline k f Subscript s Baseline right parenthesis Over pi tau Subscript r Baseline k f Subscript s Baseline EndFraction EndAbsoluteValue
uppe r 
V Su b
scri
pt noise  normal bar amp Baseline left parenthesis k f Subscript s Baseline right parenthesis equals 2 upper A Subscript t Baseline StartFraction tau Subscript w Baseline Over upper T Subscript s Baseline EndFraction dot StartAbsoluteValue StartFraction sine left parenthesis pi tau Subscript w Baseline k f Subscript s Baseline right parenthesis Over pi tau Subscript w Baseline k f Subscript s Baseline EndFraction EndAbsoluteValue dot StartAbsoluteValue StartFraction sine left parenthesis pi tau Subscript r Baseline k f Subscript s Baseline right parenthesis Over pi tau Subscript r Baseline k f Subscript s Baseline EndFraction EndAbsoluteValue
uppe r 
V Su
bscript noise normal bar amp Baseline left parenthesis k f Subscript s Baseline right parenthesis equals 2 upper A Subscript t Baseline StartFraction tau Subscript w Baseline Over upper T Subscript s Baseline EndFraction dot StartAbsoluteValue StartFraction sine left parenthesis pi tau Subscript w Baseline k f Subscript s Baseline right parenthesis Over pi tau Subscript w Baseline k f Subscript s Baseline EndFraction EndAbsoluteValue dot StartAbsoluteValue StartFraction sine left parenthesis pi tau Subscript r Baseline k f Subscript s Baseline right parenthesis Over pi tau Subscript r Baseline k f Subscript s Baseline EndFraction EndAbsoluteValue
where, k is the harmonic order, and f s is the switching frequency. 
In (1.2), the harmonic amplitude only appears at discrete frequencies kf s. To  
better show the distribution of harmonic amplitude, the envelope can be obtained 
by replacing kf s in (1.2) with a continuous frequency f . As a result, the envelope 
V noise_env( f ) of the spectrum of a trapezoidal waveform is derived as 
upper V Subscr ipt nois
e normal bar env Baseline left parenthesis f right parenthesis equals 2 upper A Subscript t Baseline StartFraction tau Subscript w Baseline Over upper T Subscript s Baseline EndFraction dot StartAbsoluteValue StartFraction sine left parenthesis pi tau Subscript w Baseline f right parenthesis Over pi tau Subscript w Baseline f EndFraction EndAbsoluteValue dot StartAbsoluteValue StartFraction sine left parenthesis pi tau Subscript r Baseline f right parenthesis Over pi tau Subscript r Baseline f EndFraction EndAbsoluteValue
up
e
r V 
Subscrip t noise normal bar env Baseline left parenthesis f right parenthesis equals 2 upper A Subscript t Baseline StartFraction tau Subscript w Baseline Over upper T Subscript s Baseline EndFraction dot StartAbsoluteValue StartFraction sine left parenthesis pi tau Subscript w Baseline f right parenthesis Over pi tau Subscript w Baseline f EndFraction EndAbsoluteValue dot StartAbsoluteValue StartFraction sine left parenthesis pi tau Subscript r Baseline f right parenthesis Over pi tau Subscript r Baseline f EndFraction EndAbsoluteValue
uppe r
 V S u
bscr
ipt nois e normal bar env Baseline left parenthesis f right parenthesis equals 2 upper A Subscript t Baseline StartFraction tau Subscript w Baseline Over upper T Subscript s Baseline EndFraction dot StartAbsoluteValue StartFraction sine left parenthesis pi tau Subscript w Baseline f right parenthesis Over pi tau Subscript w Baseline f EndFraction EndAbsoluteValue dot StartAbsoluteValue StartFraction sine left parenthesis pi tau Subscript r Baseline f right parenthesis Over pi tau Subscript r Baseline f EndFraction EndAbsoluteValue
uppe r
 V S
ubscript noise normal bar env Baseline left parenthesis f right parenthesis equals 2 upper A Subscript t Baseline StartFraction tau Subscript w Baseline Over upper T Subscript s Baseline EndFraction dot StartAbsoluteValue StartFraction sine left parenthesis pi tau Subscript w Baseline f right parenthesis Over pi tau Subscript w Baseline f EndFraction EndAbsoluteValue dot StartAbsoluteValue StartFraction sine left parenthesis pi tau Subscript r Baseline f right parenthesis Over pi tau Subscript r Baseline f EndFraction EndAbsoluteValue

14
1
Introduction
Since |sin(x)| ≤ 1, according to (1.3), the maximum boundary for the envelope is 
given by 
upper V Subsc ript noi
se normal bar mb Baseline left parenthesis f right parenthesis equals 2 upper A Subscript t Baseline StartFraction tau Subscript w Baseline Over upper T Subscript s Baseline EndFraction dot left parenthesis StartFraction 1 Over pi tau Subscript w Baseline f EndFraction right parenthesis dot left parenthesis StartFraction 1 Over pi tau Subscript r Baseline f EndFraction right parenthesis
up
e
r
 V Subscript noise normal bar mb Baseline left parenthesis f right parenthesis equals 2 upper A Subscript t Baseline StartFraction tau Subscript w Baseline Over upper T Subscript s Baseline EndFraction dot left parenthesis StartFraction 1 Over pi tau Subscript w Baseline f EndFraction right parenthesis dot left parenthesis StartFraction 1 Over pi tau Subscript r Baseline f EndFraction right parenthesis
uppe r
 
V
 
Subscript noise normal bar mb Baseline left parenthesis f right parenthesis equals 2 upper A Subscript t Baseline StartFraction tau Subscript w Baseline Over upper T Subscript s Baseline EndFraction dot left parenthesis StartFraction 1 Over pi tau Subscript w Baseline f EndFraction right parenthesis dot left parenthesis StartFraction 1 Over pi tau Subscript r Baseline f EndFraction right parenthesis
uppe r
 
V Subscript noise normal bar mb Baseline left parenthesis f right parenthesis equals 2 upper A Subscript t Baseline StartFraction tau Subscript w Baseline Over upper T Subscript s Baseline EndFraction dot left parenthesis StartFraction 1 Over pi tau Subscript w Baseline f EndFraction right parenthesis dot left parenthesis StartFraction 1 Over pi tau Subscript r Baseline f EndFraction right parenthesis
According to (1.3) and (1.4), the envelope and maximum boundary of the trape-
zoidal waveform are depicted, as shown in Fig. 1.14b. As seen, the maximum 
boundary has a slope of 0 dB/dec at the frequencies below 1/(πτ w), − 20 dB/dec 
at the frequencies within [1/(πτ w), 1/(πτ r)], and − 40 dB/dec at the frequencies 
above 1/(πτ r). By increasing τ r, the maximum boundary of the spectrum will be 
reduced for the frequencies above 1/(πτ r). Soft-switching technique helps reduce 
the conducted EMI at high frequencies since the rising/falling time τ r is increased 
at the switching transients [33–35]. 
2. Shielding Technique in Transformers 
The transformer shielding technique can be single- and double-shielding. 
Figure 1.15a shows the single-shielding technique, where the shielding layer SP1 
is inserted between the primary winding WP1 and secondary windings WS1, and it is 
connected to the PG of the converter [36]. Although the electric coupling between 
WP1 and WS1 is blocked, the electric coupling between SP1 and its adjacent windings 
emerges. This coupling gives rises to the displacement current and consequently lead 
to the generation of the CM noise.
Figure 1.15b shows the double-shielding technique, where two shielding layers 
that have the same winding direction between the primary and secondary winding are 
inserted. The one close to the primary winding is connected to the PG and the other 
one close to the secondary winding is connected to the SG. With such arrangement, 
the two shielding layers have identical electric potential distribution, and thus there 
is no displacement current between them [37]. However, for the interleaved winding 
structure, each pair of double shielding layers should be inserted between every two 
adjacent primary and secondary windings, which will occupy large window area and 
increase the complexity of manufacture. 
3. Winding Cancellation Method in Transformers 
The winding cancellation method is designed to effectively eliminate the displace-
ment current between the adjacent primary and secondary windings in a transformer. 
Figure 1.16 shows the CM noise circuit of the ﬂyback converter and its transformer 
structure that adopts the winding cancellation method [38]. In this transformer, the 
WP1, WP2 and WP3 layers of the primary winding use enameled wire, while the WP4 
layer of the primary winding uses copper foil with proper height to cover the whole 
window height. With this setup, the electric coupling between WP3 and the secondary 
winding WS1 is blocked. Besides, the electric coupling between WP3 and WS1 can 
also be neglected, since it is blocked by the tightly wound layers WP2 and WP4. 
Importantly, the turns of WP4 is the same as that of WS1, and the dotted terminals B 
and C on the primary and secondary sides are equi-potential in the conducted EMI

1.4 Modeling and Reduction of the CM EMI in DC-DC Converters
15
Primary 
Secondary 
Core 
Shielding 
PG 
SP1 WP1
WS1
Bottom view 
Insulation 
PG 
(a) The transformer with single shielding layer 
Primary 
Secondary 
Core 
Shielding 
G
S
G
P 
SP1 WP1
WS1 SS1
Bottom view 
SG 
Insulation
PG 
(b) The transformer with double shielding layers 
Fig. 1.15 The transformer with shielding layers
frequency range. As a result, WP4 and WS1 have the same electric potential distribu-
tion [38], leading to the elimination of the displacement current between WP4 and 
WS1, and thus the CM noise is reduced. 
WS1
WP4 
C
B
A 
D 
B
D 
A
C
* 
* 
M 
WP3
WP2
WP1 
Q 
Do 
PG 
Vin 
Co
RLd 
PE 
Fig. 1.16 The ﬂyback converter and the transformer with winding cancellation

16
1
Introduction
However, as shown in Fig. 1.16, there still exists electric coupling between WS1 
and WP1 via the core, which generates displacement current and contributes to the 
CM noise. 
In Chap. 7, the shielding-based approach will be introduced to mitigate the CM 
noise in isolated dc-dc converters. The single-shielding technique will be further 
analyzed to explore ways to enhance CM noise reduction, and the shielding-winding 
method and the combined shielding and balancing-winding method will be proposed. 
Furthermore, a shielding-based hybrid passive cancellation (HPC) approach will be 
proposed, which not only cancels the displacement current ﬂowing through trans-
former inter-winding capacitance, but also nulliﬁes the displacement current ﬂowing 
through the parasitic capacitance between the high dv/dt nodes in the primary circuit 
and the PE. 
4. Symmetry Circuit 
Figure 1.17 shows both the asymmetrical and symmetrical buck converters [39] along 
with their CM parasitic capacitances. As shown in Fig. 1.17a, in the asymmetrical 
buck converter, the high dv/dt switching node A generates displacement current that 
ﬂows through the parasitic capacitance CpA, resulting in the CM noise. On the other 
hand, in the symmetrical buck converter shown in Fig. 1.17b, the electric potential 
waveforms with respect to the negative terminal O of the input voltage are given in 
Fig. 1.18. When switches Q1 and Q2 are conducting, the electric potentials of nodes 
A and B are vAO = V in and vBO = 0, and the voltage applied across inductors Lf1 and 
Lf2 is both (V in – V o)/2. Consequently, the electric potentials of the nodes C and D 
are
Start Layout  Enlarg ed left  brace 1
st R ow v S ubscr iptVCO Baseline
 equals v Subscript AO Baseline minus v Subscript upper L f 1 Baseline equals left parenthesis upper V Subscript in Baseline plus upper V Subscript o Baseline right parenthesis divided by 2 2nd Row v Subscript DO Baseline equals v Subscript CO Baseline minus upper V Subscript o Baseline equals left parenthesis upper V Subscript in Baseline minus upper V Subscript o Baseline right parenthesis divided by 2 EndLayout
When Q1 and Q2 are turned off, the freewheeling diode DFW is conducting. Thus, 
Q1 and Q2 sustain a voltage of V in/2, and vAO = vBO = V in/2. As the voltage across 
the inductor Lf1 is –0.5V o, we have  vCO = (V in + V o)/2 and vDO = (V in – V o)/2.
CpB
CpD 
CpA
CpC 
Q1 
Vin
DFW
Co
RLd 
Lf1 
O 
A 
B 
C 
D 
Cp B
Cp D  
Q1 
Vi n  
* 
Q2 
DF W
Co
RL d  
Lf 1  
Lf 2  
* 
A 
B 
C 
D 
O 
+
‒ 
+
‒ 
Cp A
Cp C  
(a) Asymmetrical buck converter                  (b) Symmetrical buck converter 
Fig. 1.17 The asymmetrical and symmetrical buck converter

1.4 Modeling and Reduction of the CM EMI in DC-DC Converters
17
Fig. 1.18 The electric 
potential waveforms of the 
symmetrical buck converter
Q1, Q2 
vBO 
t
0 
Vin/2 
Ts 
t 
vAO 
Vin 
0 
t 
t 
t 
vDO 
vCO 
(Vin+Vo)/2 
(Vin‒Vo)/2 
0 
0 
DyTs 
Vin/2 
Obviously, vCO and vDO only have dc component, and there is no displacement current 
ﬂowing through CpC and CpD. Besides, vAO and vBO have high dv/dt characteristics 
and are complementary to each other. When CpA = CpB, the displacement current 
ﬂowing through CpA and CpB can be effectively cancelled. 
Compared to the asymmetrical circuit, the symmetrical circuit requires more 
components, leading to higher cost and power losses. However, for the circuit that 
is inherently symmetrical, the CM noise can be reduced with appropriate control 
scheme. For example, the primary circuit of dual-switch forward converter shown in 
Fig. 1.13b is already symmetrical. Since Q1 and Q2 are switched simultaneously, the 
electric potential of nodes A and B are complementary. By equalizing the capacitance 
CpA and CpB, the resultant displacement current can be cancelled by each other. It is 
worth noting that the secondary rectiﬁer and ﬁlter are not symmetrical, and the ratio 
of the lumped capacitances Cac and Cbc should satisfy a certain value determined by 
the transformer turns ratio. Thus, the CM noise can be eliminated [31]. 
Figure 1.19 shows the full-bridge converter, which is inherently a symmetrical 
topology. However, when phase-shift control is implemented, the electric poten-
tials of the two phase-leg midpoints change at different time, and the generated 
displacement current ﬂowing through the associated parasitic capacitance, including 
the parasitic capacitance between the phase-leg midpoints and the PE, as well as the 
transformer inter-winding capacitance can not be cancelled by each other [40, 41]. 
Furthermore, the voltage across the resonant inductor affects the electric potentials 
of the transformer primary winding terminals, which also generates the CM noise. 
In Chap. 8, the CM noise of the phase-shifted full-bridge (PSFB) converter will be 
investigated, and the CM noise reduction method will be proposed.
5. Passive Cancellation Method 
The passive cancellation method is implemented by introducing a compensation 
branch that generates a compensation current aimed at cancelling the CM noise 
current. In non-isolated (isolated) DC-DC converters, the voltage across the inductor 
(transformer winding) usually contains the same ac component as the drain-to-source

18
1
Introduction
Vin 
A 
B(b) 
* 
Q3 
Q1 
Q4 
Q2 
* 
* 
DR1 
DR2 
Lf 
c 
d 
CpB
CpA 
Lr 
PE 
Co
RLd 
SG 
a 
Cps 
PG 
vLr 
iLr 
1:n:n 
e 
Fig. 1.19 The PSFB converter and its CM noise propagation path
voltage of the switches. Therefore, a compensation winding can be coupled with the 
inductor (transformer) to induce a compensation voltage that is out-of-phase with 
the dv/dt in the main circuit. By properly selecting the compensation capacitance, 
the compensation current will cancel the CM noise current effectively. 
Figure 1.20 shows the applications of passive cancellation method in buck 
converter and ﬂyback converter [42]. As seen, the compensation voltage across the 
compensation winding is out-of-phase with respect to the high dv/dt node in the 
circuit, as long as the coupling coefﬁcient is close to unity. 
However, it is important to note that the performance of CM noise cancellation at 
high frequencies may be compromised or deteriorate, owing to the parasitics of the 
cancellation branch. For instance, the AC resistance of the compensation winding 
will restrict the magnitude of compensation current at high frequencies, leading to 
degradation in the CM noise reduction performance [42]. Additionally, due to the 
presence of leakage inductance and the parasitic capacitance of the compensation 
winding, the compensation voltage and the node with high dv/dt in the converter are 
no longer out-of-phase at high frequencies, ultimately resulting in poorer CM noise 
[42].
Q 
Vin 
* 
Df
Co
RLd 
Lf * 
Cp
Ccom 
Q 
Vi n  
Co
RL d 
Do 
* 
Cc o m  
Cp 
*
* 
(a) Buck converter
(b) Flyback converter 
Fig. 1.20 The Buck and ﬂyback converter adopting passive cancellation method 

1.5 Modeling and Reduction of the CM EMI in DC-AC Inverters
19
From the description above, it becomes evident that the underlying principles of 
CM noise reduction by symmetry circuit and passive cancellation method are essen-
tially the same. Both methods aim to eliminate the CM noise current by introducing 
a cancellation branch in parallel with the converter for providing the compensation 
current. In Chap. 9, instead of cancelling the CM current, the CM voltage cancella-
tion (CMVC) method will be explored, which introduces a compensation voltage in 
series with the converter to reduce the CM voltage. In Chap. 10, based on the CMVC 
method, the split-winding (SW) conﬁguration for non-isolated DC-DC converters 
will be introduced, allowing for simultaneous cancellation of the CM currents at the 
input and output sides. 
1.5 
Modeling and Reduction of the CM EMI in DC-AC 
Inverters 
The DC-AC inverter is employed to convert a DC voltage to an AC voltage, and is 
widely applied in the applications such as motor drive, induction heating, uninter-
ruptable power supply and renewable energy generation. Normally, the input and 
output of the inverter do not share the same ground, giving rise to the CM voltage 
and subsequent CM current. This CM current ﬂows between the CM impedance at 
the input and output sides, leading to the conducted EMI and leakage current in the 
DC-AC inverter systems. 
In photovoltaic (PV) inverter systems, non-isolated inverters are usually adopted 
to achieve high efﬁciency and small volume/weight. However, due to the presence of 
the parasitic capacitance CPV between the PV panel and the PE, the CM voltage of the 
inverter will generate the CM current through CPV, the parasitic capacitance between 
the inverter and the PE, the output ﬁlter, line impedance Zline and the grounding 
impedance Zg, as shown in Fig. 1.21a [43, 44]. The CM current at the output side 
will ﬂow into the grid and cause conducted EMI, while the CM current at the input 
side may cause safety hazard.
In motor drive systems [45], as shown in Fig. 1.21b, the input CM current goes 
to the DC source and may introduce the conducted EMI. Meanwhile, the output CM 
current, often referred to as leakage current, will ﬂow into the motor bearings and 
potentially cause bearing failures. When the fast-switching silicon-carbide (SiC) and 
gallium-nitride (GaN) devices are incorporated, the dv/dt in the circuit is signiﬁcantly 
higher than that in silicon device-based circuits, exacerbating the CM noise issues. 
Therefore, reducing the CM current at the input and output sides in inverter systems 
is a critical concern [46–49]. 
Methods of mitigating the CM EMI and leakage current in inverter systems fall 
into three main categories: the ﬁlter approach [50–53], the CM voltage reduction 
methods, and the CM noise cancellation methods. Passive ﬁlters attenuate the CM 
noise by incorporating the CM inductors along the CM noise propagation path to 
increase the impedance, and by adding Y capacitors to bypass the noise into the PE.

20
1
Introduction
PE
Heatsink+chasis 
Inverter
PV 
panel 
Output side 
CPV 
Zline 
Zline 
Grid 
Zg
PG 
Input side 
Output 
filter 
(a) The CM currents in the input and output of the PV inverter system 
Cable 
shielding
Frame 
Heatsink+chasis 
Motor
Inverter 
PG 
Output side
PE 
DC 
source 
Cp 
Input side 
(b) The CM currents in the input and output of motor drive system 
Fig. 1.21 Two typical inverter systems
It is important to note that, as the ﬁlter design for both sides is coupled due to the CM 
loop, the attenuation of CM noise at one side could make the CM noise at the other 
side even worse, since the Y capacitors alter the impedance of the CM loop [53]. 
To address this issue, a ﬂoating EMI ﬁlter is proposed in [53], which connects the 
AC-side Y capacitors to the midpoint of the DC-link, allowing for independent ﬁlter 
design on each side. On the other hand, active ﬁlters employ active devices to sense 
and compensate the CM noise [45]. When designing the passive or active ﬁlter, the 
CM impedance of the source and the load must be considered, since they affect the 
CM noise attenuation of the ﬁlter. 
Basically, the CM voltage of the inverter can be reduced either by modifying the 
inverter topology or by applying advanced modulation strategy, and thus the CM noise 
can be suppressed. It is revealed that the inverter topology with constant CM voltage 
does not generate the CM noise. For the PV inverter systems, various topologies 
with constant CM voltage have been proposed [54–56]. For motor drive systems, 
relevant topologies can be found in [57–59]. However, the increased hardware cost 
of these topologies should be concerned in practical applications. Alternatively, the 
advanced modulation strategy aims to modify the CM voltage spectra and reduce 
its harmonic amplitude, hence attenuating the CM noise [60–63]. It is important 
to recognize that reducing the CM noise reduction through advanced modulation 
may involve trade-offs with other factors, such as switching losses, output voltage 
harmonics and neutral point voltage balance [64]. 
To effectively cancel the CM noise, the CM transformer (CMT) is normally incor-
porated to cancel the CM voltage of DC-AC inverters. The CMT consists of tightly 
coupled sensing winding and injecting windings, where, the sensing winding captures

References
21
the CM voltage of the inverter, while the injecting windings induce the compensation 
voltage and injects it into the output of the inverter [65–69]. Thus, the CM voltage 
of the inverter is cancelled, and the CM current at the output side is attenuated as a 
result. However, addressing CM noise reduction at the input side remains a challenge. 
In Chap. 11, a comprehensive CM noise model of inverter systems will be 
presented, which takes into account the input and output CM impedance. Based 
on the CMVC method in Chap. 9, the cancellation method will be proposed. This 
method involves inserting two CMTs into the inverter input and output sides, in order 
to reduce the CM current at the input and output sides of the inverter simultaneously. 
The inﬂuence of the parasitics in the CMT will be investigated as they limit the 
bandwidth for CM noise cancellation. 
1.6 
Summary 
With the widespread use of power electronics technology, the issues posed by 
conducted EMI in power converters have grown increasingly signiﬁcant. In this 
chapter, the basic concept of the EMC and conducted EMI is brieﬂy introduced, 
and the generation of the CM and DM EMI in power converters is explained. The 
research status and key issues for the conducted EMI in power converters are elab-
orated, including the modeling, prediction and reduction of the conducted EMI in 
AC-DC rectiﬁers, DC-DC converters, and DC-AC inverters. 
References 
1. D. Weston, Electromagnetic Compatibility: Principles and Applications, 2nd edn. (Marcel 
Dekker Inc., New York, 2001) 
2. F. Costa, C. Gautier, E. Laboure, B. Revol, Electromagnetic Compatibility in Power Electronics 
(ISTE Ltd., London, 2014) 
3. CISPR 16-1-2, Speciﬁcation for Radio Disturbance and Immunity Measuring Apparatus and 
Methods—Part 1–2 (British Standards, 2009) 
4. CISPR 22, Information Technology Equipment Radio Disturbance Characteristics Limits and 
Methods of Measurement (International Electrotechnical Commission, 2005) 
5. EN 55022, Limits and Methods of Measurement of Radio Disturbance Characteristics of 
Information Technology Equipment (European Norm Standard, 2006) 
6. X. Ruan, Power Electronics (China Machine Press, Beijing, 2021) (in Chinese) 
7. W. Ma, L. Zhang, J. Meng, EMC in the Independent Power Systems and the Power Electronics 
Equipments (Science Press, Beijing, 2007) (in Chinese) 
8. W.O. Henry, Electromagnetic Compatibility Engineering (Wiley, New York, 2009) 
9. K. Mainali, R. Oruganti, Conducted EMI mitigation techniques for switch-mode power 
converters: a survey. IEEE Trans. Power Electron. 25(9), 2344–2356 (2010) 
10. X. Wu, N.-.K Poon, C.-M. Lee, B.M.-H. Pong, Z.-M. Qian, A study of common mode 
noise in switching power supply from a current balancing viewpoint, in Proceedings of IEEE 
International Conference on Power Electronics and Driving Systems (1999), pp. 621–625

22
1
Introduction
11. P. Kong, S. Wang, F.C. Lee, Improving balance technique for high frequency common mode 
noise reduction in boost PFC converters, in Proceedings of IEEE Power Electronics Specialists 
Conference (PESC) (2008), pp. 2941–2947 
12. P. Kong, S. Wang, F.C. Lee, Common mode EMI noise suppression for bridgeless PFC 
converters. IEEE Trans. Power Electron. 23(1), 291–297 (2008) 
13. Z. Lu, W. Chen, Common mode EMI noise reduction technique by noise path conﬁguration 
of high frequency power transformer, in Proceedings of IEEE International Power Electronics 
and Motion Control Conference (IPEMC-ECCE Asia) (2009), pp. 954–956 
14. P. Kong, Y. Jiang, F.C. Lee, Common mode EMI noise characteristics of low-power ac–dc 
converters. IEEE Trans. Power Electron. 27(2), 731–738 (2012) 
15. M. Pahlevaninezhad, D. Hamza, P.K. Jain, An improved layout strategy for common-mode EMI 
suppression applicable to high-frequency planar transformers in high-power dc/dc converters 
used for electric vehicles. IEEE Trans. Power Electron. 29(3), 1211–1228 (2014) 
16. S. Wang, P. Kong, F.C. Lee, Common mode noise reduction for boost converters using general 
balance technique. IEEE Trans. Power Electron. 22(4), 1410–1416 (2007) 
17. Y. Chu, S. Wang, A generalized common mode current cancellation approach for power 
converters. IEEE Trans. Industr. Electron. 62(7), 4130–4140 (2015) 
18. C. Silva, UC3854 Controlled Power Factor Correction Circuit Design. Unitrode Corp, 
Application Note U-134 (1999) 
19. J.-S. Lai, D. Chen, Design consideration for power factor correction boost converter oper-
ating at the boundary of continuous conduction mode and discontinuous conduction mode, in 
Proceedings of IEEE Applied Power Electronics Conference and Exposition (APEC) (1993), 
pp. 267–273 
20. J. Zhang, J. Shao, P. Xu, F.C. Lee, M.M. Jovanovic, Evaluation of input current in the critical 
mode boost PFC converter for distributed power systems, in Proceedings of IEEE Applied 
Power Electronics Conference and Exposition (APEC) (2001), pp. 130–136 
21. M. Marvi, A. Fotowat-Ahmady, A fully ZVS critical conduction mode boost PFC. IEEE Trans. 
Power Electron. 27(4), 1958–1965 (2012) 
22. K. Liu, Y. Lin, Current waveform distortion in power factor correction circuits employing 
discontinuous-mode boost converters, in Proceedings of IEEE Power Electronics Specialists 
Conference (PESC) (1989), pp. 825–829 
23. K. Yao, X. Ruan, X. Mao, Z. Ye, Variable-duty-cycle control to achieve high input power factor 
for DCM boost PFC converter. IEEE Trans. Industr. Electron. 58(5), 1856–1865 (2011) 
24. L. Rossetto, S. Buso, G. Spiazzi, Conducted EMI issue in a 600-W single-phase boost PFC 
design. IEEE Trans. Ind. Appl. 36(2), 578–585 (2000) 
25. E. Hertz, Thermal and EMI modeling and analysis of a boost PFC circuit designed using a 
genetic-based optimization algorithm. Master dissertation, Virginia Polytechnic Institute and 
State University, Blacksburg, USA, 2001 
26. L. Yang, Modeling and characterization of a PFC converter in the medium and high frequency 
ranges for predicting the conducted EMI. Master dissertation, Virginia Polytechnic Institute 
and State University, Blacksburg, USA, 2003 
27. L. Yang, B. Lu, W. Dong, Z. Lu, M. Xu, F.C. Lee, W.G. Odendaal, Modeling and characteri-
zation of a 1 kW CCM PFC converter for conducted EMI prediction, in Proceedings of IEEE 
Applied Power Electronics Conference and Exposition (APEC) (2004), pp. 763–769 
28. F. Giezendanner, J. Biela, J.W. Kolar, S. Zudrell-Koch, EMI noise prediction for electronic 
ballasts. IEEE Trans. Power Electron. 25(8), 2133–2141 (2010) 
29. Z. Wang, S. Wang, P. Kong, F.C. Lee, DM EMI noise prediction for constant on-time, crit-
ical mode power factor correction converters. IEEE Trans. Power Electron. 27(7), 3150–3157 
(2012) 
30. J. He, W. Chen, J. Jiang, Model and analysis on common-mode conducted EMI of a switched 
mode power supply, in Proceedings of the Chinese Society for Electrical Engineering (CSEE), 
vol. 25, no. 8 (2005), pp. 50–55 (in Chinese) 
31. P. Kong, S. Wang, F.C. Lee, Reducing common-mode noise in two-switch forward converter. 
IEEE Trans. Power Electron. 26(5), 1522–1533 (2011)

References
23
32. C.R. Paul, Introduction to Electromagnetic Compatibility, 2nd edn. (Wiley, New York, 2006) 
33. P. Caldeira, R. Liu, D. Dalal, W. Gu, Comparison of EMI performance of PWM and resonant 
power converters, in Proceedings of IEEE Power Electronics Specialists Conference (PESC) 
(1993), pp. 134–140 
34. M. Joshi, V. Agarwal, Design optimization of ZVS and ZCS quasi-resonant converters for 
EMI reduction, in Proceedings of International Conference on Electromagnetic Interference 
and Compatibility (ICEIC) (1997), pp. 407–413 
35. H. Chung, S.-Y. Hui, K.-K. Tse, Reduction of power converter EMI emission using soft-
switching technique. IEEE Trans. Electromagn. Compat. 40(3), 282–287 (1998) 
36. Y. Yang, D. Huang, F.C. Lee, Q. Li, Analysis and reduction of common mode EMI noise 
for resonant converters, in Proceedings of IEEE Applied Power Electronics Conference and 
Exposition (APEC) (2014), pp. 566–571 
37. Y. Yang, D. Huang, F.C. Lee, Q. Li, Transformer shielding technique for common mode noise 
reduction in isolated converters, in Proceedings of IEEE Energy Conversion Congress and 
Exposition (ECCE) (2013), pp. 4149–4153 
38. P. Kong, F.C. Lee, Transformer structure and its effects on common mode EMI noise in 
isolated power converters, in Proceedings of IEEE Applied Power Electronics Conference 
and Exposition (APEC) (2010), pp. 1424–1429 
39. M. Shoyama, G. Li, T. Ninomiya, Balanced switching converter to reduce common-mode 
conducted noise. IEEE Trans. Industr. Electron. 50(6), 1095–1099 (2003) 
40. P. Kong, Common mode EMI noise reduction techniques in switch mode power supplies. Ph.D. 
Dissertation, Virginia Polytechnic Institute and State University, Blacksburg, USA, 2009 
41. I.A. Makda, M. Nymand, Common-mode noise analysis, modeling and ﬁlter design for a 
phase-shifted full-bridge forward converter, in Proceedings of IEEE International Conference 
on Power Electronics and Drive Systems (PEDS) (2015), pp. 1100–1105 
42. D. Cochrane, D. Chen, D. Boroyevic, Passive cancellation of common-mode noise in power 
electronic circuits. IEEE Trans. Power Electron. 18(3), 756–763 (2003) 
43. W. Li, Y. Gu, H. Luo, W. Cui, X. He, C. Xia, Topology review and derivation methodology 
of single-phase transformerless photovoltaic inverters for leakage current suppression. IEEE 
Trans. Industr. Electron. 62(7), 4537–4551 (2015) 
44. H. Xiao, S. Xie, Leakage current analytical model and application in single-phase transformer-
less photovoltaic grid-connected inverter. IEEE Trans. Electromagn. Compat. 52(4), 902–913 
(2010) 
45. S. Wang, Y.Y. Maillet, F. Wang, D. Broyevich, R. Burgos, Investigation of hybrid EMI ﬁlters 
for common-mode EMI suppression in a motor drive system. IEEE Trans. Power Electron. 
25(4), 1034–1045 (2010) 
46. S. Chen, T.A. Lipo, D. Fitzgerald, Modeling of motor bearing currents in PWM inverter drives. 
IEEE Trans. Ind. Appl. 32(4), 1365–1370 (1996) 
47. N. Mutoh, M. Nakanishi, M. Kanesaki, J. Nakashima, EMI noise control methods suitable for 
electric vehicle drive systems. IEEE Trans. Electromagn. Compat. 47(4), 930–937 (2005) 
48. F. Wang, Motor shaft voltages and bearing currents and their reduction in multilevel medium-
voltage PWM voltage-source-inverter drive applications. IEEE Trans. Ind. Appl. 36(5), 1336– 
1341 (2000) 
49. J. Adabi, F. Zare, G. Leawich, A. Ghosh, Leakage current and common mode voltage issues 
in modern AC drive systems, in Proceedings of Australaisian University Power Engineering 
Conference (2007), pp. 1–6 
50. H. Akagi, T. Shimizu, Attenuation of conducted EMI emissions from an inverter-driven motor. 
IEEE Trans. Power Electron. 23(1), 282–290 (2008) 
51. D. Xu, Q. Gao, W. Wang, Design of a passive ﬁlter to reduce common-mode and differential-
mode voltage generated by voltage-source PWM inverter, in Proceedings of Annual Conference 
of IEEE Industrial Electronics Society (IECON) (2006), pp. 2483–2487 
52. D. Dong, X. Zhang, F. Luo, D. Boroyevich, P. Mattavelli, Common-mode EMI noise reduction 
for grid-interface converter in low-voltage dc distribution system, in Proceedings of IEEE 
Applied Power Electronics Conference and Exposition (APEC) (2012), pp. 451–457

24
1
Introduction
53. Y. Liu, Z. Mei, S. Jiang, W. Liang, Conducted common-mode electromagnetic interference 
suppression in the AC and DC sides of a grid-connected inverter. IET Power Electron. 13(13), 
2926–2934 (2020) 
54. D. Han, C.T. Morris, B. Sarlioglu, Common-mode voltage cancellation in PWM motor drives 
with balanced inverter topology. IEEE Trans. Industr. Electron. 64(4), 2683–2688 (2017) 
55. C.T. Morris, D. Han, B. Sarlioglu, Reduction of common mode voltage and conducted EMI 
through three-phase inverter topology. IEEE Trans. Power Electon. 32(3), 1720–1724 (2017) 
56. S. Heribert, S. Christoph, K. Jurgen, Inverter for transforming a dc voltage into an ac current 
or an ac voltage. Europe Patent 1 369 985 (A2) (2003) 
57. R. Gonzalez, J. Lopez, P. Sanchis, L. Marroyo, Transformerless inverter for single-phase 
photovoltaic systems. IEEE Trans. Power Electron. 22(2), 693–697 (2007) 
58. B. Yang, W. Li, Y. Gu, W. Cui, X. He, Improved transformerless inverter with common-mode 
leakage current elimination for a photovoltaic grid-connected power system. IEEE Trans. Power 
Electron. 27(2), 752–762 (2012) 
59. M. Victor, F. Greizer, S. Bremicker, U. Hubler, Method of converting a direct current voltage 
from a source of direct current voltage, more speciﬁcally from a photovoltaic source of direct 
current voltage, into a alternating current voltage. U.S. Patent 7 411 802 B2 (2008) 
60. X. Yuan, J. Yon, P. Mellor, Common-mode voltage reduction in three-level neutral-point-
clamped converters with neutral point voltage balance. in Proceedings of IEEE International 
Symposium on Industrial Electronics (2013), pp. 1–6 
61. Y. Han, H. Lu, Y. Li, J. Chai, Analysis and suppression of shaft voltage in SiC-based inverter 
for electric vehicle applications. IEEE Trans. Power Electron. 34(7), 6276–6285 (2019) 
62. H. Zhang, A.V. Jouanne, S. Dai, A.K. Wallace, F. Wang, Multilevel inverter modulation schemes 
to eliminate common-mode voltages. IEEE Trans. Ind. Appl. 36(6), 1645–1653 (2000) 
63. M. Cacciato, A. Consoli, G. Scarcella, A. Testa, Reduction of common-mode currents in PWM 
inverter motor drives. IEEE Trans. Ind. Appl. 35(2), 469–476 (1999) 
64. D.  Jiang,  Z.  Shen, Q. Li,  J.  Chen, Z. Liu,  Advanced Pulse-Width-Modulation: With Freedom 
to Optimize Power Electronics Converters (Springer, 2021) 
65. S. Ogasawara, H. Ayano, H. Akagi, An active circuit for cancellation of common-mode voltage 
generated by a PWM inverter. IEEE Trans. Power Electron. 13(5), 835–841 (1998) 
66. M.M. Swamy, K. Yamada, T. Kume, Common mode current attenuation techniques for use 
with PWM drives. IEEE Trans. Power Electron. 16(2), 248–255 (2001) 
67. Y. Murai, T. Kubota, Y. Kawase, Leakage current reduction for a high-frequency carrier inverter 
feeding an induction motor. IEEE Trans. Ind. Appl. 28(4), 858–863 (1992) 
68. M.C.D. Piazza, M. Luna, G. Vitale, EMI reduction in dc-fed electric drives by active common-
mode compensator. IEEE Trans. Electromagn. Compat. 56(5), 1067–1076 (2014) 
69. Y. Jiang, D. Xu, X. Chen, A novel inverter output dv/dt suppression ﬁlter, in Proceedings of 
Annual Conference of IEEE Industrial Electronics Society (IECON) (2003), pp. 2901–2905

Chapter 2 
Measurement of Conducted 
Electro-magnetic Interference (EMI) 
and Design of EMI Filter 
2.1 
Measurement of Conducted Electromagnetic 
Interference (EMI) 
2.1.1 
Test Setup for Measuring the Conducted EMI 
Figure 2.1 shows the test setup for measuring the conducted EMI within the frequency 
range [150 kHz, 30 MHz], where, a line impedance stabilization network (LISN) is 
added between the equipment under test (EUT) and the input source. The LISN 
provides a speciﬁc impedance to ensure the repeatability of the test results, and 
converts the noise current generated by the EUT into the noise voltage for the conve-
nience of measurement. The noise voltage from the LISN is sent into the EMI receiver 
for acquiring the conducted EMI spectrum of the EUT.
Figure 2.2 shows the arrangement of the instruments for measuring the conducted 
EMI stipulated in CISPR 22. The EUT is placed on a wooden table with a height of 
0.8 m, and keeps a horizontal distance of 0.4 m from the vertical reference plane. 
The LISN is tightly grounded to the horizontal reference plane, and keeps a hori-
zontal distance of 0.8 m from the EUT. The minimal dimension for the vertical and 
horizontal reference planes is 2 m × 2 m.
2.1.2 
Line Impedance Stabilization Network 
As seen from Fig. 2.1, the LISN is a multiport passive network composed of capaci-
tors, inductors and resistors, and it has the selective properties for signals at different 
frequencies. According to CISPR-16-1 [1], when measuring the conducted EMI, the 
parameters in the LISN are: C1 = 1 μF, L1 = 50 μH, C2 = 0.1 μF, R1 = 1 kΩ. 
At the line frequency, e.g., 50 Hz, the impedance of inductor L1 is very small and
© The Author(s), under exclusive license to Springer Nature Singapore Pte Ltd. 2024 
X. Ruan et al., Conducted Electromagnetic Interference in Power Converters: Modeling, 
Prediction and Reduction, CPSS Power Electronics Series, 
https://doi.org/10.1007/978-981-99-9295-9_2 
25

26
2
Measurement of Conducted Electro-magnetic Interference (EMI) …
L 
vin 
C1 
N 
EUT 
LISN 
EMI 
Receiver 
C1 
C2
C2 
RLN 
PE 
L1 
L1 
vL 
vN 
R1
R1 
50Ω 
iL 
iN 
1 
2 
SW 
Fig. 2.1 The test setup for measuring the conducted EMI
EMI Receiver 
0.4m 
0.8m 
0.8m 
Horizontal 
reference plane 
Vertical 
reference plane 
AC input 
LISN 
EUT 
Fig. 2.2 The arrangement of the instruments for measuring the conducted EMI
has negilible effect on power delivery. At the conducted EMI frequency range from 
150 kHz to 30 MHz, the impedance of C1 is very small, and the noise at the input 
side is bypassed by C1 without affecting the test results. The noise currents iL and 
iN generated by the EUT mainly ﬂow through the branch consisted of capacitor C2, 
test resistor RLN (with RLN = 50 Ω, signiﬁcantly smaller than R1), and the input side 
of the EMI receiver (which also has 50-Ω input resistance [1]). As a result, the noise 
voltages, vL and vN, are generated [2]. When measuring vL from the Live line, switch 
SW is placed at position 1, and the test terminal of vN in the LISN is connected to 
RLN. When measuring vN from the Neutral line, switch SW is placed at position 2, 
and the test terminal of vL in the LISN is connected to RLN. Additionally, when the 
LISN is disconnected from the power lines, R1 acts as the bleeding resistors for the 
capacitors in the LISN to prevent electric shock.

2.1 Measurement of Conducted Electromagnetic Interference (EMI)
27
2.1.3 
Separation of the CM and DM Noises 
The common-mode (CM) and differential-mode (DM) EMI have distinct origins, 
and their respective suppression methods are different. Therefore, separation of the 
conducted EMI into CM and DM noises is convenient for diagnosing the conducted 
EMI spectrum, assisting the selection of suppression methods, and designing the 
EMI ﬁlters. 
Figure 2.3 shows the block diagram of CM and DM noise separation. The noise 
separator [3] is designed with 50-Ω input impedance, so that the impedance from 
the LISN side for the conducted EMI is unchanged. 
In Fig. 2.3, iL and iN are the noise currents from the L line and N line, respectively, 
and iCM and iDM are the CM and DM noise currents, respectively. So, we have
Star tLayou t Enla
rge d left  brace
 1st Row i Subscript upper L Baseline equals i Subscript CM Baseline plus i Subscript DM Baseline 2nd Row i Subscript upper N Baseline equals i Subscript CM Baseline minus i Subscript DM Baseline EndLayout
According to (2.1), iCM and iDM can be calculated as
Start La yout Enlarged left brace 1st Row i Subscript CM Baseline equals one half left parenthesis i Subscript upper L Baseline plus i Subscript upper N Baseline right parenthesis 2nd Row i Subscript DM Baseline equals one half left parenthesis i Subscript upper L Baseline minus i Subscript upper N Baseline right parenthesis EndLayout
StartL ayout 
Enla rg ed left brace 1st Row i Subscript CM Baseline equals one half left parenthesis i Subscript upper L Baseline plus i Subscript upper N Baseline right parenthesis 2nd Row i Subscript DM Baseline equals one half left parenthesis i Subscript upper L Baseline minus i Subscript upper N Baseline right parenthesis EndLayout
StartL ayout 
Enlarged left brace 1st Row i Subscript CM Baseline equals one half left parenthesis i Subscript upper L Baseline plus i Subscript upper N Baseline right parenthesis 2nd Row i Subscript DM Baseline equals one half left parenthesis i Subscript upper L Baseline minus i Subscript upper N Baseline right parenthesis EndLayout
In Fig. 2.3, vL and vN are the test voltages across the equivalent 50-Ω resistor 
generated by iL and iN, respectively, and we have vL = 50iL, vN = 50iN. The noise 
separator receives vL and vN as the input, and outputs the CM or DM voltages, vCM 
or vDM, expressed as
L 
vin 
C1 
N 
LISN 
EMI 
Receiver 
C1 
C2
C2 
PE 
L1 
L1 
vL 
vN 
R1
R1 
Noise 
separator 
iCM 
iDM 
vCM 
or vDM 
iL 
iN 
EUT 
– 
+ 
50Ω 
50Ω 
Fig. 2.3 The block diagram of CM and DM noise separation 

28
2
Measurement of Conducted Electro-magnetic Interference (EMI) …
Start La yout Enlarged left brace 1st Row v Subscript CM Baseline equals one half left parenthesis v Subscript upper L Baseline plus v Subscript upper N Baseline right parenthesis equals one half times 50 dot left parenthesis i Subscript upper L Baseline plus i Subscript upper N Baseline right parenthesis 2nd Row v Subscript DM Baseline equals one half left parenthesis v Subscript upper L Baseline minus v Subscript upper N Baseline right parenthesis equals one half times 50 dot left parenthesis i Subscript upper L Baseline minus i Subscript upper N Baseline right parenthesis EndLayout
StartL ayout En larged left brace 1st Row v Subscript CM Baseline equals one half left parenthesis v Subscript upper L Baseline plus v Subscript upper N Baseline right parenthesis equals one half times 50 dot left parenthesis i Subscript upper L Baseline plus i Subscript upper N Baseline right parenthesis 2nd Row v Subscript DM Baseline equals one half left parenthesis v Subscript upper L Baseline minus v Subscript upper N Baseline right parenthesis equals one half times 50 dot left parenthesis i Subscript upper L Baseline minus i Subscript upper N Baseline right parenthesis EndLayout
St artLa yout E nlarge
d le ft  brace 1st Row v Subscript CM Baseline equals one half left parenthesis v Subscript upper L Baseline plus v Subscript upper N Baseline right parenthesis equals one half times 50 dot left parenthesis i Subscript upper L Baseline plus i Subscript upper N Baseline right parenthesis 2nd Row v Subscript DM Baseline equals one half left parenthesis v Subscript upper L Baseline minus v Subscript upper N Baseline right parenthesis equals one half times 50 dot left parenthesis i Subscript upper L Baseline minus i Subscript upper N Baseline right parenthesis EndLayout
StartL ayout En larged left brace 1st Row v Subscript CM Baseline equals one half left parenthesis v Subscript upper L Baseline plus v Subscript upper N Baseline right parenthesis equals one half times 50 dot left parenthesis i Subscript upper L Baseline plus i Subscript upper N Baseline right parenthesis 2nd Row v Subscript DM Baseline equals one half left parenthesis v Subscript upper L Baseline minus v Subscript upper N Baseline right parenthesis equals one half times 50 dot left parenthesis i Subscript upper L Baseline minus i Subscript upper N Baseline right parenthesis EndLayout
St artLa yout E nlarge
d left brace 1st Row v Subscript CM Baseline equals one half left parenthesis v Subscript upper L Baseline plus v Subscript upper N Baseline right parenthesis equals one half times 50 dot left parenthesis i Subscript upper L Baseline plus i Subscript upper N Baseline right parenthesis 2nd Row v Subscript DM Baseline equals one half left parenthesis v Subscript upper L Baseline minus v Subscript upper N Baseline right parenthesis equals one half times 50 dot left parenthesis i Subscript upper L Baseline minus i Subscript upper N Baseline right parenthesis EndLayout
According to (2.2) and (2.3), we have
Start Layout E
nlar ged left
 brace 1st Row v Subscript CM Baseline equals 50 i Subscript CM Baseline 2nd Row v Subscript DM Baseline equals 50 i Subscript DM Baseline EndLayout
As seen from (2.4), vCM and vDM are equivalently the voltages across the 50-Ω
test resistor that carries iCM and iDM, respectively. In this sense, the noise separation 
is accomplished. 
2.1.4 
EMI Receiver 
Figure 2.4 shows the basic structure of the EMI receiver [2], including the input 
attenuator, radio-frequency (RF) ampliﬁer, frequency controller, mixer, oscillator, 
intermediate-frequency (IF) ﬁlter, envelope detector, and the detectors for acquiring 
Peak (PK), Quasi-Peak (QP) and Average (AV) values. The EMI signal can be either 
the noise voltages vL and vN according to the conducted EMI standard, or the CM and 
DM voltages vCM and vDM when noise separation is required. As shown in Fig. 2.4, 
the EMI signal is processed with three major steps, namely, pre-processing, mixing 
and ﬁltering, and detection. 
1. Pre-processing 
In Fig. 2.4, the input attenuator provides 50-Ω input impedance for the EMI receiver, 
and attenuates the input EMI signal to protect the RF ampliﬁer. The RF ampliﬁer is 
used to magnify the attenuated EMI signal at the conducted EMI frequency range, 
and maintain the signal integrity as well. 
2. Mixing and Filtering
IF filter 
Envelope 
detector 
EMI 
signal 
Detectors 
PK 
QP 
AV 
Mixer 
Oscillator 
B
D 
f0 
C 
Frequency 
controller 
Display 
Input 
attenuator 
RF 
amplifier 
vos 
vn
vmix 
Pre-processing
Mixing and filtering
Detection 
A 
venv 
50Ω 
Fig. 2.4 The basic structure of the EMI receiver 

2.1 Measurement of Conducted Electromagnetic Interference (EMI)
29
Figure 2.5 gives the signal ﬂow in the mixing and ﬁltering step. Firstly, the mixer 
multiplies the EMI signal vn with the signal vos generated by the oscillator. vos is a 
sine wave with the frequency of f os, amplitude of 1 and initial phase angle of ϕos, 
expressed as 
v Su bscript os Bas eline 
equals sine left parenthesis 2 pi f Subscript os Baseline t plus phi Subscript os Baseline right parenthesis
For the convenience of illustration, vn is  also  assumed to be a sine wave with a ﬁxed  
frequency of f e ( f e ≪f os), amplitude of Ae and initial phase angle of ϕe, expressed 
as 
v S ubscr ipt n Basel ine e
quals upper A Subscript e Baseline sine left parenthesis 2 pi f Subscript e Baseline t plus phi Subscript e Baseline right parenthesis
The output signal of the mixer, vmix, is the product of vn and vos. According to 
(2.5) and (2.6), we have
t 
t 
t 
t 
t 
A 
B 
D 
t
t
C 
(6dB correction) 
f=fe 
Ae
Ae 
0.5Ae 
0.5Ae 
Ae 
Zoom in 
Ae 
t 
Ae 
With f=fos+fe=f0 
With f=fos–fe and fos+fe 
Via 
mixer 
Via 
IF filter 
Envelope 
detector 
Ae 
Fig. 2.5 The signal ﬂow and processing steps in the EMI receiver 

30
2
Measurement of Conducted Electro-magnetic Interference (EMI) …
Fig. 2.6 The function of the 
mixer 
f 
f 
fe
fos 
fos+fe 
Conducted 
EMI signal
Oscillator 
Via the mixer 
f0 
IF filter
Ae 
0.5Ae 
fos–fe 
v Sub script m ix Base
l
ine equals v Su bscri pt os B aseline
 v Subscript n Ba selin e equal s 0.5 
u
pper A Subscript e Baseline Start 2 By 2 Matrix 1st Row 1st Column Blank 2nd Column cosine left bracket 2 pi left parenthesis f Subscript os Baseline minus f Subscript e Baseline right parenthesis t plus left parenthesis phi Subscript os Baseline minus phi Subscript e Baseline right parenthesis right bracket 2nd Row 1st Column Blank 2nd Column plus cosine left bracket 2 pi left parenthesis f Subscript os Baseline plus f Subscript e Baseline right parenthesis t plus left parenthesis phi Subscript os Baseline plus phi Subscript e Baseline right parenthesis right bracket EndMatrix
As seen from (2.7), the mixer shifts the EMI signal with the frequency of f e into 
the mixed signal with the frequency of ( f os + f e) and ( f os − f e), and the amplitude 
is halved, as shown in Fig. 2.6. 
Subsequently, vmix is sent into the IF ﬁlter. The IF ﬁlter is a band-pass ﬁlter centered 
at a ﬁxed frequency of f 0, and it allows the signal within its resolution bandwidth 
(RBW) to pass through. When measuring the conducted EMI from 150 kHz to 
30 MHz, the RBW of the IF ﬁlter is 9 kHz. By adjusting f os to make ( f os + f e) 
equal to f 0, only the signal with the frequency of ( f os + f e) passes the IF ﬁlter, 
and its amplitude is still 0.5Ae. As the amplitude of the original EMI signal is Ae, a  
correction of 6 dB should be made to achieve accurate measurement. 
3. Detection 
Finally, the envelope detector outputs the envelope of the signal from the IF ﬁlter, 
whose amplitude is Ae after correction, and the PK, QP, AV detectors acquires the 
corresponding PK, QP and AV values. 
According to Fig. 2.6, the EMI signal is shifted and ﬁltered in the frequency-
domain by the frequency controller, oscillator, mixer and the IF ﬁlter. Therefore, these 
blocks can be equivalently combined into an IF ﬁlter with tunable center frequency, 
and the EMI receiver in Fig. 2.4 can be simpliﬁed as shown in Fig. 2.7, where, f IF is 
the center frequency of the equivalent IF ﬁlter. When measuring the conducted EMI, 
f IF is swept from 150 kHz to 30 MHz. In this process, the frequency step is smaller 
than the RBW of the IF ﬁlter.
The EMI receiver is able to provide the PK, QP and AV values of the envelope 
signal. According to Fig. 2.4, the detectors are constructed by resistors and capacitors 
with different time constants for charging and discharging processes, and the main 
features are:
(1) For the PK detector, the time constant for charing is zero, and the time constant 
for discharging is inﬁnite. Therefore, the output capacitor voltage rises very

2.1 Measurement of Conducted Electromagnetic Interference (EMI)
31
Envelope 
detector 
0 
0.5 
1 
fIF 
RBW 
Detector 
IF filter with 
tunnable fIF 
EMI spectrum 
(PK, QP, AV)
EMI signal 
Fig. 2.7 The simpliﬁed structure of EMI receiver
quickly to follow the peak value of the envelope signal, and keeps unchanged 
when the envelope signal is decreasing. The capacitor voltage is the PK value 
of the envelope signal.
(2) The detection of QP value is a special requirement in the conducted EMI 
measurement. The initial purpose of regulating the conducted EMI from CISPR 
is to guarantee the normal operation of telecommunication and broadcasting. 
The inﬂuence of the conducted EMI on telecommunication and broadcasting 
is mainly judged by the listening experiences of the audiences. An accidental, 
high-amplitude impulse may not affect the audience, while a repetitive signal 
with certain amplitude and pulsewidth may disrupt the telecommunication and 
broadcasting signals. Therefore, the QP detector is designed to gauge the inten-
sity of a repetitive signal with certain magnitude and pulsewidth, and its output 
is closely correlated to the reaction of audience for audio signals. For the QP 
detector, the charging time constant τ c is 1 ms and the discharging time constant 
τ d is 160 ms. Obviously, τ c is far shorter than τ d [1]. When the charging and 
discharging is balanced, the QP value is acquired. Figure 2.8 shows the measured 
PK and QP values for the envelope signals with different repetitive period. Obvi-
ously, the PK value of these envelope signals is identical, and the QP value is 
related to the repetitive period of the envelope signals. The longer the repetitive 
period is, the lower the QP value will be. For the accidental signal, the resultant 
QP value is very small. 
Fig. 2.8 The difference of 
detecting the PK and QP 
values
t 
t 
t 
PK 
QP 
PK 
QP 
PK 
QP 
Repetitive signal 
(short interval) 
Repetitive signal 
(long interval) 
Accidental signal 

32
2
Measurement of Conducted Electro-magnetic Interference (EMI) …
(3) The time constants for charging and discharing process of the AV detector are 
the same, and the AV detector outputs the average value of the envelope signal. 
In EN 55022, the conducted EMI is only speciﬁed with the QP and AV values. 
However, the measurement of PK value is still essential, owing to the following 
reasons: 
(1) Speed and Efﬁciency: The QP value is available until the charging and 
discharging process is balanced, so it takes long time to acquire the QP values. 
Comparatively, the PK detection is much faster, and the PK value is relatively 
close to the QP value. Therefore, the PK detection can be adopted to estimate 
the upper boundary of the QP value. 
(2) Streamlined Testing: If the PK value is lower than the limit in the standard, the 
QP detection can be skipped for saving time because the QP value is lower than 
the PK value. 
(3) Military Applications: In military applications, the standard normally speciﬁes 
the PK value of the conducted EMI. This is due to the potential for a single pulse 
with sufﬁcient amplitude to disrupt or even damage the sensitive instruments. 
Figure 2.9 shows the PK, QP and AV values for various conducted EMI signals 
within the time interval [t0, t1]. It is important to note that the time interval, [t0, t1], 
is chosen to be long enough to ensure that the charging and discharging processes of 
the detectors is balanced, enabling the accurate measurement of the PK, QP and AV 
values.
In Fig. 2.9a, b, the conducted EMI signal is sine wave with a ﬁxed frequency of f e. 
When f e equals to the test frequency f IF of the IF ﬁlter, the signal experiences a gain 
of 1, and it passes through the IF ﬁlter without attenuation. Therefore, the output of 
the envelope detector, venv, tracks the amplitude Ae of its input exactly. In Fig. 2.9a, if 
the amplitude is ﬁxed, the measured PK, QP and AV values are the same. In Fig. 2.9b, 
if the amplitude varies, the measured PK, QP and AV values satisfy the inequality 
PK > QP > AV. The difference between the PK, QP and AV values depends on the 
variation of the amplitude in the time-domain. The lower the amplitude variation is, 
the closer these detected values will be. 
Figure 2.9c, d show the detected PK, QP and AV values of the conducted EMI 
signal when the frequency ( f e) varies. As seen, when f e equals to the test frequency 
f IF at te1 and te2, the gain of the IF ﬁlter is 1, and the output of the IF ﬁlter follows 
its input exactly, indicating that the envelope signal venv has the amplitude of Ae at 
te1 and te2. When f e is not equal to f IF, the gain of the IF ﬁlter is far smaller than 1, 
and the amplitude of venv is much lower than Ae. Apparently, when the amplitude Ae 
is ﬁxed, the PK value is Ae at f IF, as shown in Fig. 2.9c. If the amplitude Ae varies, 
the PK value has the maximum amplitude when f e coincides with f IF, as shown  in  
Fig. 2.9d. The difference among the PK, QP and AV values are associated with the 
time-domain characteristics of f e and Ae. If the variation range of f e is much smaller 
than the RBW of the IF ﬁlter, the IF ﬁlter passes the conducted EMI signal with 
negilible attenuation, and the resultant PK, QP and AV values are similar to that in 
Fig. 2.9a, b. In contrast, if the variation range of f e is much larger than the RBW of

2.1 Measurement of Conducted Electromagnetic Interference (EMI)
33
t
t 
PK 
AV 
QP 
fe=fIF
t0
t1 
t0
t1 
(a) The signal with constant amplitude and constant frequency 
t
t 
PK 
AV 
QP 
fe=fIF
t0
t1 
t0
t1 
venv 
(b) The signal with variable amplitude and constant frequency 
t 
t 
t 
fe 
fIF 
te1 
PK 
AV 
QP 
te2
t0
t1 
t0
t1 
venv 
(c) The signal with constant amplitude and variable frequency 
t 
t 
t 
fIF 
te1 
PK 
AV 
QP 
te2 
fe 
t0
t1 
t0
t1 
venv 
(d) The signal with variable amplitude and variable frequency 
Fig. 2.9 The measured PK, QP and AV for various types of conducted EMI signals
the IF ﬁlter, venv generally has low amplitude, and the AV value is much lower than 
the PK and QP values, as shown in Fig. 2.9c, d.

34
2
Measurement of Conducted Electro-magnetic Interference (EMI) …
2.2 
Design of EMI Filter for Power Converters 
2.2.1 
Topology and Attenuation Performance of EMI Filter 
In order to comply with the conducted EMI standards, an EMI ﬁlter is usually inserted 
between the input power source and input side of the power converter. Taking the 
AC input as an example, Fig. 2.10 shows a typical EMI ﬁlter, where, LCM is the CM 
inductor, LDM is the DM inductor which utilizes the leakage inductance Llk of the 
CM inductor, Cy is the CM capacitor, and Cx1 and Cx2 are the DM capacitors. 
Referring to Fig. 2.10, since the CM noise propagates through both the input power 
cords with the same direction and amplitude, the DM capacitors have no effect on 
the CM noise, and the two CM capacitors are essentially in parallel. Besides, the 
leakage inductance of the CM inductor is far lower than the CM inductance. With 
these considerations, the CM ﬁlter can be extracted from Fig. 2.10, as shown  in  
Fig. 2.11a. For the DM noise, the ﬂux generated by the DM current in the CM 
inductors is cancelled by each other, so the CM inductor has no attenuation on the 
DM noise. Besides, the CM capacitance is much smaller than the DM capacitance 
due to the limit of the maximum leakage current. Thus, the DM ﬁlter can be extracted 
from Fig. 2.10, as shown in Fig. 2.11b. 
The insert voltage gain (IVG) is usually adopted to describe the attenuation perfor-
mance of the EMI ﬁlter, which is deﬁned as the ratio of the original CM (DM) noise 
vCM_ori (vDM_ori) and the attenuated CM (DM) noise vCM_att (vDM_att) with the CM 
(DM) ﬁlter, expressed as
Fig. 2.10 A typical EMI 
ﬁlter 
LCM 
Cx2 
LDM (Llk) 
Cx1 
Cy 
Cy 
L 
N 
LDM (Llk) 
iCM 
iDM 
iCM 
PE 
Fig. 2.11 The CM and DM 
EMI ﬁlters extracted from 
the EMI ﬁlter in Fig. 2.10 
LCM 
2Cy 
L(N) 
Cx1
Cx2 
2LDM 
L 
N 
(a) CM EMI filter
(b) DM EMI filter 

2.2 Design of EMI Filter for Power Converters
35
LCM 
2Cy
RLN/2 
vCM_att 
– 
+
   vENS
   ZS 
Fig. 2.12 The EMI ﬁlter with the CM noise equivalent circuit of the converter and the CM 
impedance from the LISN side 
StartAbs o
lute
Value IVG EndAbsoluteValue Subscript CM Baseline equals StartAbsoluteValue StartFraction v Subscript CM normal bar ori Baseline Over v Subscript CM normal bar att Baseline EndFraction EndAbsoluteValue comma StartAbsoluteValue IVG EndAbsoluteValue Subscript DM Baseline equals StartAbsoluteValue StartFraction v Subscript DM normal bar ori Baseline Over v Subscript DM normal bar att Baseline EndFraction EndAbsoluteValue
StartAb
solute Value IV G
 End
AbsoluteValue Subscript CM Baseline equals StartAbsoluteValue StartFraction v Subscript CM normal bar ori Baseline Over v Subscript CM normal bar att Baseline EndFraction EndAbsoluteValue comma StartAbsoluteValue IVG EndAbsoluteValue Subscript DM Baseline equals StartAbsoluteValue StartFraction v Subscript DM normal bar ori Baseline Over v Subscript DM normal bar att Baseline EndFraction EndAbsoluteValue
StartAb
solu
teValue IVG EndAbsoluteValue Subscript CM Baseline equals StartAbsoluteValue StartFraction v Subscript CM normal bar ori Baseline Over v Subscript CM normal bar att Baseline EndFraction EndAbsoluteValue comma StartAbsoluteValue IVG EndAbsoluteValue Subscript DM Baseline equals StartAbsoluteValue StartFraction v Subscript DM normal bar ori Baseline Over v Subscript DM normal bar att Baseline EndFraction EndAbsoluteValue
Based on Fig.  2.11a, the CM ﬁlter with the CM impedance at the LISN side and the 
CM noise equivalent circuit of the power converter is provided in Fig. 2.12. The  CM  
impedance at the LISN side is RLN/2 since the test resistors of the L line and N line 
are essentially in parallel when measuring the CM noise. For the power converter, the 
CM noise equivalent circuit can be simpliﬁed as a Thevenin’s equivalent circuit [4], 
which is represented by an equivalent noise source (ENS) vENS and a CM impedance 
ZS connected in series. 
According to Fig. 2.12, the original CM noise vCM_ori without the EMI ﬁlter is 
given by 
v Subscr i
pt CM normal bar ori Baseline equals StartFraction upper R Subscript LN Baseline divided by 2 Over upper Z Subscript upper S Baseline plus upper R Subscript LN Baseline divided by 2 EndFraction v Subscript ENS Baseline equals StartFraction upper R Subscript LN Baseline Over 2 upper Z Subscript upper S Baseline plus upper R Subscript LN Baseline EndFraction v Subscript ENS
v S ubscript CM n o
rmal bar ori Baseline equals StartFraction upper R Subscript LN Baseline divided by 2 Over upper Z Subscript upper S Baseline plus upper R Subscript LN Baseline divided by 2 EndFraction v Subscript ENS Baseline equals StartFraction upper R Subscript LN Baseline Over 2 upper Z Subscript upper S Baseline plus upper R Subscript LN Baseline EndFraction v Subscript ENS
v Su bscrip
t CM
 normal bar ori Baseline equals StartFraction upper R Subscript LN Baseline divided by 2 Over upper Z Subscript upper S Baseline plus upper R Subscript LN Baseline divided by 2 EndFraction v Subscript ENS Baseline equals StartFraction upper R Subscript LN Baseline Over 2 upper Z Subscript upper S Baseline plus upper R Subscript LN Baseline EndFraction v Subscript ENS
With the EMI ﬁlter, the attenuated CM noise vCM_att is calculated as 
StartLay o
ut 1st Row 1st Column v Subscript CM normal bar att 2nd Column equals StartFraction upper R Subscript LN Baseline divided by 2 Over s upper L Subscript CM Baseline plus upper R Subscript LN Baseline divided by 2 EndFraction StartStartFraction left parenthesis s upper L Subscript CM Baseline plus upper R Subscript LN Baseline divided by 2 right parenthesis slash slash StartFraction 1 Over 2 s upper C Subscript y Baseline EndFraction OverOver upper Z Subscript upper S Baseline plus left parenthesis s upper L Subscript CM Baseline plus upper R Subscript LN Baseline divided by 2 right parenthesis slash slash StartFraction 1 Over 2 s upper C Subscript y Baseline EndFraction EndEndFraction v Subscript ENS Baseline 2nd Row 1st Column Blank 2nd Column equals StartFraction upper R Subscript LN Baseline Over 4 upper L Subscript CM Baseline upper C Subscript y Baseline upper Z Subscript upper S Baseline s squared plus 2 left parenthesis upper L Subscript CM Baseline plus upper C Subscript y Baseline upper Z Subscript upper S Baseline upper R Subscript LN Baseline right parenthesis s plus 2 upper Z Subscript upper S Baseline plus upper R Subscript LN Baseline EndFraction v Subscript ENS EndLayout
Start Layout 1
st Row  1st Column  v Subscript CM normal bar att 2nd Column equals StartFraction upper R Subscript LN Baseline divided by 2 Over s upper L Subscript CM Baseline plus upper R Subscript LN Baseline divided by 2 EndFraction StartStartFraction left parenthesis s upper L Subscript CM Baseline plus upper R Subscript LN Baseline divided by 2 right parenthesis slash slash StartFraction 1 Over 2 s upper C Subscript y Baseline EndFraction OverOver upper Z Subscript upper S Baseline plus left parenthesis s upper L Subscript CM Baseline plus upper R Subscript LN Baseline divided by 2 right parenthesis slash slash StartFraction 1 Over 2 s upper C Subscript y Baseline EndFraction EndEndFraction v Subscript ENS Baseline 2nd Row 1st Column Blank 2nd Column equals StartFraction upper R Subscript LN Baseline Over 4 upper L Subscript CM Baseline upper C Subscript y Baseline upper Z Subscript upper S Baseline s squared plus 2 left parenthesis upper L Subscript CM Baseline plus upper C Subscript y Baseline upper Z Subscript upper S Baseline upper R Subscript LN Baseline right parenthesis s plus 2 upper Z Subscript upper S Baseline plus upper R Subscript LN Baseline EndFraction v Subscript ENS EndLayout
StartLayout 1st Row 1st Column v Subscript CM normal bar att 2nd Column equals StartFraction upper R Subscript LN Baseline divided by 2 Over s upper L Subscript CM Baseline plus upper R Subscript LN Baseline divided by 2 EndFraction StartStartFraction left parenthesis s upper L Subscript CM Baseline plus upper R Subscript LN Baseline divided by 2 right parenthesis slash slash StartFraction 1 Over 2 s upper C Subscript y Baseline EndFraction OverOver upper Z Subscript upper S Baseline plus left parenthesis s upper L Subscript CM Baseline plus upper R Subscript LN Baseline divided by 2 right parenthesis slash slash StartFraction 1 Over 2 s upper C Subscript y Baseline EndFraction EndEndFraction v Subscript ENS Baseline 2nd Row 1st Column Blank 2nd Column equals StartFraction upper R Subscript LN Baseline Over 4 upper L Subscript CM Baseline upper C Subscript y Baseline upper Z Subscript upper S Baseline s squared plus 2 left parenthesis upper L Subscript CM Baseline plus upper C Subscript y Baseline upper Z Subscript upper S Baseline upper R Subscript LN Baseline right parenthesis s plus 2 upper Z Subscript upper S Baseline plus upper R Subscript LN Baseline EndFraction v Subscript ENS EndLayout
Sta rtLayout  1st Row 1s t Column v Subscript CM normal bar att 2nd Column equals StartFraction upper R Subscript LN Baseline divided by 2 Over s upper L Subscript CM Baseline plus upper R Subscript LN Baseline divided by 2 EndFraction StartStartFraction left parenthesis s upper L Subscript CM Baseline plus upper R Subscript LN Baseline divided by 2 right parenthesis slash slash StartFraction 1 Over 2 s upper C Subscript y Baseline EndFraction OverOver upper Z Subscript upper S Baseline plus left parenthesis s upper L Subscript CM Baseline plus upper R Subscript LN Baseline divided by 2 right parenthesis slash slash StartFraction 1 Over 2 s upper C Subscript y Baseline EndFraction EndEndFraction v Subscript ENS Baseline 2nd Row 1st Column Blank 2nd Column equals StartFraction upper R Subscript LN Baseline Over 4 upper L Subscript CM Baseline upper C Subscript y Baseline upper Z Subscript upper S Baseline s squared plus 2 left parenthesis upper L Subscript CM Baseline plus upper C Subscript y Baseline upper Z Subscript upper S Baseline upper R Subscript LN Baseline right parenthesis s plus 2 upper Z Subscript upper S Baseline plus upper R Subscript LN Baseline EndFraction v Subscript ENS EndLayout
Start
Layou
t
 1st Row 1st Column v Subscript CM normal bar att 2nd Column equals StartFraction upper R Subscript LN Baseline divided by 2 Over s upper L Subscript CM Baseline plus upper R Subscript LN Baseline divided by 2 EndFraction StartStartFraction left parenthesis s upper L Subscript CM Baseline plus upper R Subscript LN Baseline divided by 2 right parenthesis slash slash StartFraction 1 Over 2 s upper C Subscript y Baseline EndFraction OverOver upper Z Subscript upper S Baseline plus left parenthesis s upper L Subscript CM Baseline plus upper R Subscript LN Baseline divided by 2 right parenthesis slash slash StartFraction 1 Over 2 s upper C Subscript y Baseline EndFraction EndEndFraction v Subscript ENS Baseline 2nd Row 1st Column Blank 2nd Column equals StartFraction upper R Subscript LN Baseline Over 4 upper L Subscript CM Baseline upper C Subscript y Baseline upper Z Subscript upper S Baseline s squared plus 2 left parenthesis upper L Subscript CM Baseline plus upper C Subscript y Baseline upper Z Subscript upper S Baseline upper R Subscript LN Baseline right parenthesis s plus 2 upper Z Subscript upper S Baseline plus upper R Subscript LN Baseline EndFraction v Subscript ENS EndLayout
StartLayout 1st
 
Row 1st Column 
v
 S ubscri pt CM 
norm
al bar att 2nd Column equals StartFraction upper R Subscript LN Baseline divided by 2 Over s upper L Subscript CM Baseline plus upper R Subscript LN Baseline divided by 2 EndFraction StartStartFraction left parenthesis s upper L Subscript CM Baseline plus upper R Subscript LN Baseline divided by 2 right parenthesis slash slash StartFraction 1 Over 2 s upper C Subscript y Baseline EndFraction OverOver upper Z Subscript upper S Baseline plus left parenthesis s upper L Subscript CM Baseline plus upper R Subscript LN Baseline divided by 2 right parenthesis slash slash StartFraction 1 Over 2 s upper C Subscript y Baseline EndFraction EndEndFraction v Subscript ENS Baseline 2nd Row 1st Column Blank 2nd Column equals StartFraction upper R Subscript LN Baseline Over 4 upper L Subscript CM Baseline upper C Subscript y Baseline upper Z Subscript upper S Baseline s squared plus 2 left parenthesis upper L Subscript CM Baseline plus upper C Subscript y Baseline upper Z Subscript upper S Baseline upper R Subscript LN Baseline right parenthesis s plus 2 upper Z Subscript upper S Baseline plus upper R Subscript LN Baseline EndFraction v Subscript ENS EndLayout
By combining (2.8)–(2.10), the IVG of the CM ﬁlter is derived as 
StartAbs o
luteV
alue IVG End Abs
o
lute Value Subsc
r
ip t CM B aseline equals StartAbsoluteValue StartFraction 4 upper L Subscript CM Baseline upper C Subscript y Baseline upper Z Subscript upper S Baseline s squared plus 2 left parenthesis upper L Subscript CM Baseline plus upper C Subscript y Baseline upper Z Subscript upper S Baseline upper R Subscript LN Baseline right parenthesis s plus 2 upper Z Subscript upper S Baseline plus upper R Subscript LN Baseline Over 2 upper Z Subscript upper S Baseline plus upper R Subscript LN Baseline EndFraction EndAbsoluteValue
Star tAbso
luteV
alue IVG EndAbsoluteValue Subscript CM Baseline equals StartAbsoluteValue StartFraction 4 upper L Subscript CM Baseline upper C Subscript y Baseline upper Z Subscript upper S Baseline s squared plus 2 left parenthesis upper L Subscript CM Baseline plus upper C Subscript y Baseline upper Z Subscript upper S Baseline upper R Subscript LN Baseline right parenthesis s plus 2 upper Z Subscript upper S Baseline plus upper R Subscript LN Baseline Over 2 upper Z Subscript upper S Baseline plus upper R Subscript LN Baseline EndFraction EndAbsoluteValue
The IVG of the DM ﬁlter can be derived in a similar way, and it is not given here.

36
2
Measurement of Conducted Electro-magnetic Interference (EMI) …
2.2.2 
Design of EMI Filter 
Figure 2.13 outlines a general procedure of EMI ﬁlter design [4]. To begin, the original 
CM or DM noises of the power converter are determined, either through prediction 
or measurement. The attenuation requirements for the CM and DM ﬁlters are then 
established by substracting the conducted EMI limits from the CM or DM noises, and 
an appropriate margin is also considered. It should be noted that, the conduced EMI 
spectra of the power converter can be quite different at various working conditions. 
Therefore, the attenuation requirement should be calculated based on the worst-case 
conducted EMI spectrum. 
The worst-case conducted EMI spectrum is characterized by the lowest corner 
frequency of the EMI ﬁlter, which corresponds to the largest volume/weight of the 
EMI ﬁlter [5]. As shown in Fig. 2.14, the corner frequency of the EMI ﬁlter for Case 
II is lower than that of the EMI ﬁlter for Case I. Consequently, the conducted EMI 
spectrum for Case II is worse.
Secondly, the EMI ﬁlter topology can be selected by considering the CM and DM 
impedances of the converter and the LISN side [6]. According to the attenuation 
requirement, the parameters of the ﬁlter can be calculated.
Compare with the limit, 
and calculate the 
attenuation requirement 
Determine the topology 
and parameters of the filter 
The noise is 
below the limit ? 
End 
Reduce the corner 
frequency 
Reduce the self and 
mutual parasitics of 
filter components 
The noise is 
below the limit 
at low freq. ? 
N 
Acquire the CM and DM 
noise of the converter by 
prediction or measurement 
Start 
Y
N 
Y 
Fig. 2.13 The basic procedure for the EMI ﬁlter design 

2.3 Summary
37
Limit 
f 
Conducted EMI 
f 
Attenuation 
The IVG for the 
EMI filter
Corner frequency 
Conducted EMI spectrum 
Attenuation 
requirement 
Limit 
f 
Conducted EMI 
f 
Attenuation 
The IVG for the 
EMI filter 
Corner frequency 
Conducted EMI spectrum 
Attenuation 
requirement 
(a) Case I                                            (b) Case II 
Fig. 2.14 The conducted EMI spectrum and its attenuation requirement for different case
Finally, the attenuated conducted EMI of the converter can be measured by 
inserting the designed CM and DM EMI ﬁlters. In cases where the conducted 
EMI levels are still higher than the limits at low frequencies, the attenuation can 
be enhanced by increasing the ﬁlter inductance and capacitance. However, as the 
inductance or capacitance goes larger, the parasitics will be ampliﬁed. For example, 
multi-turn and multi-layer inductors often exhibit substantial parasitic capacitance 
[7–9], which can compromise ﬁlter performance at higher frequencies, making the 
noise level unexpectedly higher. In order to improve the attenuation performance of 
EMI ﬁlter at higher frequencies, efforts should be put into the minimization or elim-
ination of the self and mutual parasitics of the components. This can be achieved 
through strategic winding arrangements for inductors, adjustment in the relative 
position of components, or the incorporation of impedance cancellation techniques 
[10–18]. 
2.3 
Summary 
In this chapter, the main instruments for measuring the conducted EMI are introduced. 
The LISN is used to provide speciﬁc impedance within the conducted EMI frequency 
range, ensuring repeatability in measuring the conducted EMI. The EMI receiver 
picks up the EMI signal from the LISN, and outputs the corresponding PK, QP, 
and AV spectra. Additionally, the noise separator can be adopted to separate the 
conducted EMI into CM and DM noises, which greatly facilitates the diagnosis of 
the conducted EMI spectrum and aids in the design of EMI ﬁlters. 
This chapter also presents the design of EMI ﬁlter. The attenuation requirement is 
calculated by substracting the conducted EMI limits from the original conducted EMI 
spectrum of power converters. The parameters of the components are then calculated 
according to the attenuation requirement and the IVG of the EMI ﬁlter.

38
2
Measurement of Conducted Electro-magnetic Interference (EMI) …
References 
1. CISPR 16-1-2, Speciﬁcation for Radio Disturbance and Immunity Measuring Apparatus and 
Methods—Part 1–2 (British Standards, British, 2009) 
2. W. Schaefer, Signiﬁcance of EMI receiver speciﬁcations for commercial EMI compli-
ance testing, in Proceedings of International Symposium on Electromagnetic Compatibility 
(APEMC) (2004), pp. 741–746 
3. S. Wang, F.C. Lee, W.G. Odendaal, Characterization, evaluation, and design of noise separator 
for conducted EMI noise diagnosis. IEEE Trans. Power Electron. 20(4), 974–982 (2005) 
4. F.Y. Shih, D. Chen, Y. Wu, Y. Chen, A procedure for designing EMI ﬁlters for ac line 
applications. IEEE Trans. Power Electron. 11(1), 170–181 (1996) 
5. K. Mainali, R. Oruganti, K. Viswanathan, A metric for evaluating the EMI spectra of power 
converters. IEEE Trans. Power Electron. 23(4), 2075–2081 (2008) 
6. S. Wang, Characterization and cancellation of high-frequency parasitics for EMI ﬁlters and 
noise separators in power electronics applications. PhD Dissertation, Virginia Polytechnic 
Institute and State University, Blacksburg, USA, 2005 
7. A. Nagel, R.W. De Doncker, Systematic design of EMI-ﬁlters for power converters, in 
Proceedings of Annual Conference of IEEE Industry Applications Society (IAS) (2000), 
pp. 2523–2525 
8. M. Kumar, V. Agarwal, Power line ﬁlter design for conducted electromagnetic interference 
using time-domain measurements. IEEE Trans. Electromagn. Compat. 48(1), 178–186 (2006) 
9. Y.-S. Lai, P.S. Chen, New EMI ﬁlter design method for single phase power converter using 
software-based noise separation method, in Proceedings of Annual Conference of IEEE Industry 
Applications Society (IAS) (2007), pp. 2282–2288 
10. S. Wang, F.C. Lee, D. Chen, Effects of parasitic parameters on EMI ﬁlter performance. IEEE 
Trans. Power Electron. 19(3), 869–877 (2004) 
11. S. Wang, R. Chen, J.D. Van Wyk, Developing parasitic cancellation technologies to improve 
EMI ﬁlter performance for switching mode power supplies. IEEE Trans. Electromagn. Compat. 
48(4), 921–929 (2005) 
12. S. Wang, F.C. Lee, W.G. Odendaal, Improvement of EMI ﬁlter performance with parasitic 
coupling cancellation. IEEE Trans. Power Electron. 20(5), 1221–1228 (2005) 
13. S. Wang, F.C. Lee, W.G. Odendaal, Characterization and parasitic extraction of EMI ﬁlters 
using scattering parameters. IEEE Trans. Power Electron. 20(2), 502–510 (2005) 
14. S. Wang, F.C. Lee, W.G. Odendaal, Cancellation of capacitor parasitic parameters for noise 
reduction application. IEEE Trans. Power Electron. 21(4), 1125–1132 (2006) 
15. S. Wang, F.C. Lee, J.D. Van Wyk, Design of inductor winding capacitance cancellation for 
EMI suppression. IEEE Trans. Power Electron. 21(6), 1825–1832 (2006) 
16. S. Wang, F.C. Lee, J.D. Van Wyk, Inductor winding capacitance cancellation using mutual 
capacitance concept for noise reduction application. IEEE Trans. Electromagn. Compat. 48(2), 
311–318 (2006) 
17. S. Wang, F.C. Lee, J.D. Van Wyk, A study of integration of parasitic cancellation techniques for 
EMI ﬁlter design with discrete components. IEEE Trans. Power Electron. 23(6), 3094–3102 
(2008) 
18. S. Wang, F.C. Lee, Analysis and applications of parasitic capacitance cancellation techniques 
for EMI suppression. IEEE Trans. Industr. Electron. 57(9), 3109–3117 (2010)

Chapter 3 
Common-Mode and Differential-Mode 
Noise Equivalent Circuits for Boost 
Power Factor Correction Converter 
3.1 
Common-Mode and Differential-Mode Noises in Boost 
PFC Converter 
3.1.1 
Noise Propagation Path and Mixed-Mode Noise 
Reduction 
In this section, the propatation paths of the boost power factor correction (PFC) 
converter are ﬁrst investigated, in order to analyze its conducted electromagnetic 
interference (EMI). Figure 3.1 shows the measurement of conducted EMI for boost 
PFC converters, where, D1 ~ D4 constitute the rectiﬁer bridge, and boost inductor 
Lb, power switch Qb, diode Db and output ﬁlter capacitor Co constitute the boost 
converter. Cp is the parasitic capacitance between the drain of Qb and the protec-
tive earth (PE). The line impedance stabilization network (LISN) is placed between 
the AC input voltage source and the boost PFC converter, which provides speciﬁc 
impedance for the conducted EMI within [150 kHz, 30 MHz]. For the convenience 
of illustration, the LISN is simpliﬁed as a 50-Ω resistor RLN in the following.
The conducted EMI propagation path of boost PFC converter is illustrated in 
Fig. 3.2, where, the drain-to-source voltage of power switch Qb, referred to as vDS, 
is treated as the noise voltage source. iLb is boost inductor current, and iCp is the 
current ﬂowing through Cp. As seen in Fig. 3.2a, during the positive half line cycle, 
both D1 and D4 are conducting, iLb ﬂows through the two test resistors RLN in the 
LISN, while iCp only ﬂows through RLN in the N line and returns to vDS through D4.
© The Author(s), under exclusive license to Springer Nature Singapore Pte Ltd. 2024 
X. Ruan et al., Conducted Electromagnetic Interference in Power Converters: Modeling, 
Prediction and Reduction, CPSS Power Electronics Series, 
https://doi.org/10.1007/978-981-99-9295-9_3 
39

40
3
Common-Mode and Differential-Mode Noise Equivalent Circuits …
L 
vin 
C1 
N 
LISN 
C1 
C2
C2 
PE 
L1 
L1 
RLN
RLN 
Co
Qb 
Lb
Db 
RLd 
– 
+ 
vDS 
Cp 
D1
D2 
D3
D4 
vg 
+ 
– 
Fig. 3.1 Conducted EMI measurement for boost PFC converter
Co
Qb 
Lb
Db 
– 
+ 
vDS 
iLb 
Cp 
L 
N 
vin 
PE 
RLN 
iCp 
D1
D2 
D3
D4 
vL 
– 
+ 
– 
+ 
RLN 
vN 
vg 
+ 
– 
RLd 
(a) D1 and D4 are conducting (positive half line cycle) 
Co 
Qb 
Lb
Db 
– 
+ 
vDS 
iLb 
Cp 
PE 
D1
D2 
D3
D4 
vg 
+ 
– 
RLd 
L 
N 
vin 
RLN 
vL 
– 
+ 
– 
+ 
RLN 
vN 
iCp 
(b) D2 and D3 are conducting (negative half line cycle) 
Fig. 3.2 The conducted EMI propagation path of boost PFC converter 
According to Fig. 3.2a, the noise voltages across the test resistors of the L line 
and N lines are expressed as
Star t Layout 
Enl arge
d
 lef t bra
c
e 1st  Row
 v Subscript upper L Baseline equals minus 50 i Subscript upper L b Baseline 2nd Row v Subscript upper N Baseline equals 50 left parenthesis i Subscript upper L b Baseline minus i Subscript upper C p Baseline right parenthesis EndLayout left parenthesis v Subscript in Baseline greater than or equals 0 right parenthesis
According to (3.1), the common-mode (CM) and differential mode (DM) voltages 
are
S tart Layout En larged left b
race  1st Row v Subscrip
t
 CM B aseli
n
e equ als 
0.5 left parenthesis v Subscript upper L Baseline plus v Subscript upper N Baseline right parenthesis equals 25 i Subscript p Baseline 2nd Row v Subscript DM Baseline equals 0.5 left parenthesis v Subscript upper L Baseline minus v Subscript upper N Baseline right parenthesis equals 25 left parenthesis 2 i Subscript upper L b Baseline minus i Subscript upper C p Baseline right parenthesis EndLayout left parenthesis v Subscript in Baseline greater than or equals 0 right parenthesis

3.1 Common-Mode and Differential-Mode Noises in Boost PFC Converter
41
As shown in Fig. 3.2b, during the negative half line cycle, both D2 and D3 are 
conducting, while iCp only ﬂows through RLN in the L line and returns to vDS through 
D3. The noise voltages in the L line and N lines are expressed as
Star t Lay
o
ut E nlarg
e
d l eft brac
e 1st  Row
 v Subscript upper L Baseline equals minus 50 left parenthesis i Subscript upper L b Baseline plus i Subscript upper C p Baseline right parenthesis 2nd Row v Subscript upper N Baseline equals 50 i Subscript upper L b Baseline EndLayout left parenthesis v Subscript in Baseline less than 0 right parenthesis
According to (3.3), the corresponding CM and DM voltages can be derived as
Start Layout En larged left br
ace 1st Row v  Subscript
 
CM Ba selin
e
 equa ls 0
.5 left parenthesis v Subscript upper L Baseline plus v Subscript upper N Baseline right parenthesis equals 25 i Subscript upper C p Baseline 2nd Row v Subscript DM Baseline equals 0.5 left parenthesis v Subscript upper L Baseline minus v Subscript upper N Baseline right parenthesis equals 25 left parenthesis 2 i Subscript upper L b Baseline plus i Subscript upper C p Baseline right parenthesis EndLayout left parenthesis v Subscript in Baseline less than 0 right parenthesis
Referring to (3.2) and (3.4), it is observed that vCM is only related to iCp, so  iCp 
is regarded as the CM noise current. However, vDM is related to iLb and iCp, and 
it changes with the polarity of the input voltage. Therefore, the DM noise is partly 
contributed by the CM noise current, leading to the mixed-mode noise. Besides, when 
the inductor current becomes discontinuous, the resonance between boost inductor 
Lb and the parasitic capacitance of Qb and D1 ~ D4 will occur, causing voltage spike 
in the input rectiﬁed voltage vg. Such voltage spike will not only damage the rectiﬁer 
diode, but also introduce extra CM noise [1]. 
1. Introducting the DM Capacitor Cxdc 
To eliminate the voltage spikes in vg, a DM capacitor Cxdc can be added at the DC 
side of the rectiﬁer bridge, as shown in Fig. 3.3. Cxdc is usually much larger than the 
capacitance of Qb and D1 ~ D4, so the voltage of Cxdc is almost unchanged when the 
inductor current becomes discontinuous. When the rectiﬁer bridge is in the on-state, 
Cxdc offers a low impedance path between the L line and N line. Thus, iCp is able 
to ﬂow through RLN in both lines, avoiding the conversion of the CM noise into the 
DM noise. Therefore, Cxdc also reduces the mixed-mode noise during the on-state 
of the rectiﬁer bridge.
During the zero-crossing of the AC input voltage, the input power of the converter 
is mainly supplied by Cxdc, as shown in Fig. 3.4 with the shaded area, and the rectiﬁer 
bridge is turned off. This will lead to distortion in the input current [2, 3]. Therefore, 
Cxdc cannot be too large, and it is selected to make its impedance be far lower than 
50 Ω at the frequencies above 150 kHz. For instance, a 0.2-μF Cxdc is enough since 
its impedance is 5 Ω at 150 kHz.
2. Introducing the DM Capacitor Cxac 
Figure 3.5 shows the CM current path during the off-state of the rectiﬁer bridge. 
During the positive half line cycle, when Cp is charged, iCp ﬂows through D1 and 
generates the noise voltage across RLN in the L line; when Cp is discharged, iCp ﬂows 
through RLN in the N line and D4. During the negative half line cycle, when Cp is 
charged, iCp ﬂows through RLN in the N line and D2; when Cp is discharged, iCp 
ﬂows through RLN in the L line and D3.

42
3
Common-Mode and Differential-Mode Noise Equivalent Circuits …
Co 
Qb 
Lb
Db 
– 
+ 
vDS 
Cp 
D1
D2 
D3
D4 
vg 
+ 
– 
Cxdc 
RLd 
L 
N 
vin 
RLN 
vL 
– 
+ 
– 
+ 
RLN 
vN 
PE 
iCp 
(a) D1 and D4 are conducting (positive half line cycle) 
Co 
Qb 
Lb
Db 
– 
+ 
vDS 
Cp 
PE 
D1
D2 
D3
D4 
Cxdc 
vg 
+ 
– 
RLd 
L 
N 
vin 
RLN 
vL 
– 
+ 
– 
+ 
RLN 
vN 
iCp 
(b) D2 and D3 are conducting (negative half line cycle) 
Fig. 3.3 The inﬂuence of Cxdc on the CM current path
Fig. 3.4 The off-state of 
rectiﬁer bridge with Cxdc
vg 
Tline 
t
0 
Tline/2 
vin 
Positive half line cycle 
tg1
tg2 
Negative half line cycle
As seen in Fig. 3.5, since iCp does not ﬂow through the RLN in both lines, the 
DM noise is created, which is the mixed-mode noise during the off-state of the 
rectiﬁer bridge [4–6]. Although the duration of off-state is quite short, the mixed-
mode noise appears during every zero-crossing of the input voltage, and it is a signal 
with long repetitive period that generates high peak (PK) and quasi-peak (QP) values. 
To address this issue, a DM capacitor Cxac is added at the AC side of the rectiﬁer 
bridge, providing a low impedance path for both lines, as shown in Fig. 3.6. In this  
way, iCp can ﬂow through the RLN in both lines.
In summary, by adding the DM capacitors to both the AC and DC sides of the 
rectiﬁer bridge, the mixed-mode noise of boost PFC converters can be suppressed.

3.1 Common-Mode and Differential-Mode Noises in Boost PFC Converter
43
Co 
Qb 
Lb
Db 
– 
+ 
vDS 
Cp 
PE 
D1
D2 
D3
D4 
Cxdc 
Cp is charged iCp: + 
Positive half line cycle 
vg 
+ 
– 
RLd 
L 
N 
vin 
RLN 
vL 
– 
+ 
– 
+ 
RLN 
vN 
iCp 
(a) Cp is charged (iCp is positive) with D1 turned on 
– 
+ 
PE 
D1
D2 
D3
D4 
Positive half line cycle 
Cp is discharged iCp: – 
Co 
Qb 
Lb
Db 
vDS 
Cp 
Cxdc 
vg 
+ 
– 
RLd 
L 
N 
vin 
RLN 
vL 
– 
+ 
– 
+ 
RLN 
vN 
iCp 
(b) Cp is discharged (iCp is negative) with D1 turned on 
Fig. 3.5 The CM current path during the off-state of rectiﬁer bridge with Cxdc
– 
+ 
PE 
D1
D2 
D3
D4 
+ 
– 
Cxac 
Co 
Qb 
Lb
Db 
vDS 
Cp 
vg 
Cxdc 
RLd 
Positive half line cycle 
Cp is charged iCp: 
L 
N 
vin 
RLN 
vL 
– 
+ 
– 
+ 
RLN 
vN 
iCp 
(a) Cp is charged (iCp is positive) 
– 
+ 
PE 
D1
D2 
D3
D4 
+ 
– 
Positive half line cycle 
Co 
Qb 
Lb
Db 
vDS 
Cp 
vg
RLd 
Cp is discharged iCp: – 
Cxac 
Cxdc 
L 
N 
vin 
RLN 
vL 
– 
+ 
– 
+ 
RLN 
vN 
iCp 
(b) Cp is discharged (iCp is negative) 
Fig. 3.6 The CM current path during the off-state of rectiﬁer bridge with Cxdc and Cxac

44
3
Common-Mode and Differential-Mode Noise Equivalent Circuits …
3.1.2 
CM and DM Noise Equivalent Circuits of Boost PFC 
Converter 
Figure 3.7 gives the CM and DM noise propagation paths of boost PFC converter with 
the DM capacitors Cxdc and Cxac. By extracting the associated branches in the CM 
and DM propagation paths, the resultant circuits are shown in Fig. 3.8, where, Cxdc 
and Cxac are in parallel, and they are combined and denoted as Cx1 in the following 
discussion. 
At the frequencies higher than 150 kHz, the impedance of Cx1 is far lower than 
RLN (50 Ω), and Cx1 can be treated as a short circuit in the CM noise equivalent 
circuit. Thus, the circuit shown in Fig. 3.8a can be simpliﬁed, as shown in Fig. 3.9a.
– 
+ 
PE 
D1
D2 
D3
D4 
iLb 
Co
Qb 
Lb
Db 
vDS 
Cp 
RLd
Cxac
Cxdc 
L 
N 
vin 
RLN 
vL 
– 
+ 
– 
+ 
RLN 
vN 
iCp 
(a) D1 and D4 are conducting (positive half line cycle) 
– 
+ 
PE 
D1
D2 
D3
D4 
iLb 
Co
Qb 
Lb
Db 
vDS 
Cp 
RLd
Cxac
Cxdc 
L 
N 
vin 
RLN 
vL 
– 
+ 
– 
+ 
RLN 
vN 
iCp 
(b) D2 and D3 are conducting (negative half line cycle) 
Fig. 3.7 CM and DM noise paths during the on-state of rectiﬁer bridge with Cxdc and Cxac 
RLN
RLN 
Cxac
Cxdc 
– 
+ 
vDS
Cp 
RLN
RLN 
Cxac 
Cxdc 
– 
+ 
vDS 
Lb 
(a) CM noise related branches                   (b) DM noise related branches 
Fig. 3.8 The CM and DM noise related branches in boost PFC converter 

3.1 Common-Mode and Differential-Mode Noises in Boost PFC Converter
45
               
RLN
Cp 
vDS 
–
+ 
1 
2 
–
vCM 
– 
+ 
2RLN 
Lb 
Cx1
vDS 
– 
+ 
2vDM 
– 
+ 
(a) CM noise equivalent circuit                (b) DM noise equivalent circuit 
Fig. 3.9 CM and DM noise equivalent circuit of boost PFC converter 
Likewise, the circuit shown in Fig. 3.8b can also be simpliﬁed, as shown in Fig. 3.9b. 
Note that the voltage across RLN/2 is vCM, and the voltage across 2RLN is 2vDM.
Denoting the harmonic amplitude of vDS as V DS_k (k is the harmonic order), the 
harmonic amplitude of the CM and DM noises, referred to as V CM_k and V DM_k, are  
expressed as
S tartLa yout Enla rged left bra
ce 1st  Row uppe r V Subscript
 CM normal bar k Baseline equals StartAbsoluteValue CMTG left parenthesis k f Subscript s Baseline right parenthesis EndAbsoluteValue dot upper V Subscript DS normal bar k Baseline 2nd Row upper V Subscript DM normal bar k Baseline equals StartAbsoluteValue DMTG left parenthesis k f Subscript s Baseline right parenthesis EndAbsoluteValue dot upper V Subscript DS normal bar k Baseline EndLayout
where, |CMTG( f )| and |DMTG( f )| are the CM and DM voltage transfer gain, 
respectively. According to Fig. 3.9, |CMTG( f )| and |DMTG( f )| are given by 
StartAbso lute
Val ue CMTG left parenthesis f right parenthesis EndAbsoluteValue equals StartFraction pi f upper C Subscript p Baseline upper R Subscript LN Baseline Over StartRoot left parenthesis pi f upper C Subscript p Baseline upper R Subscript LN Baseline right parenthesis squared plus 1 EndRoot EndFraction
/S
tar tAbsol
ute Valu
e CMTG left parenthesis f right parenthesis EndAbsoluteValue equals StartFraction pi f upper C Subscript p Baseline upper R Subscript LN Baseline Over StartRoot left parenthesis pi f upper C Subscript p Baseline upper R Subscript LN Baseline right parenthesis squared plus 1 EndRoot EndFraction
StartAbso lute
Value DMTG left parenthesis f right parenthesis EndAbsoluteValue equals StartFraction upper R Subscript LN Baseline Over 2 StartRoot upper R Subscript LN Superscript 2 Baseline left parenthesis 4 pi squared f squared upper L Subscript b Baseline upper C Subscript x 1 Baseline minus 1 right parenthesis squared plus left parenthesis 4 pi f upper L Subscript b Baseline right parenthesis squared EndRoot EndFraction
StartAbsoluteValue DMTG left parenthesis f right parenthesis EndAbsoluteValue equals StartFraction upper R Subscript LN Baseline Over 2 StartRoot upper R Subscript LN Superscript 2 Baseline left parenthesis 4 pi squared f squared upper L Subscript b Baseline upper C Subscript x 1 Baseline minus 1 right parenthesis squared plus left parenthesis 4 pi f upper L Subscript b Baseline right parenthesis squared EndRoot EndFraction
/
Sta
rt
A
bsolu te Value D MTG
 le ft pare nthes
is f right parenthesis EndAbsoluteValue equals StartFraction upper R Subscript LN Baseline Over 2 StartRoot upper R Subscript LN Superscript 2 Baseline left parenthesis 4 pi squared f squared upper L Subscript b Baseline upper C Subscript x 1 Baseline minus 1 right parenthesis squared plus left parenthesis 4 pi f upper L Subscript b Baseline right parenthesis squared EndRoot EndFraction
Since Cp is small, πfCpRLN is far smaller than 1, and (3.6) can be approximated 
as 
StartAbso luteValu e CMTG
 left parenthesis f right parenthesis EndAbsoluteValue equals pi f upper C Subscript p Baseline upper R Subscript LN
Obviously, |CMTG( f )| increases with the increase of frequency, and the slope is 
20 dB/dec. 
For the DM ﬁlter, at the frequencies higher than 150 kHz, 4π2f 2LbCx1 is usually 
much larger than 1, and 4π2f 2LbCx1RLN is far larger than πfLb. Therefore, (3.7) can 
be approximated as 
StartAbso lute
Value DMTG left parenthesis f right parenthesis EndAbsoluteValue equals StartFraction 1 Over 8 pi squared f squared upper L Subscript b Baseline upper C Subscript x 1 Baseline EndFraction
Start Ab soluteV
alue DMTG left parenthesis f right parenthesis EndAbsoluteValue equals StartFraction 1 Over 8 pi squared f squared upper L Subscript b Baseline upper C Subscript x 1 Baseline EndFraction
Based on (3.9), |DMTG( f )| decreases with the increase of frequency, and the 
slope is − 40 dB/dec.

46
3
Common-Mode and Differential-Mode Noise Equivalent Circuits …
LCM 
Cx2 
LDM 
Cx1 
Cy 
Cy 
L 
N 
to 
AC input 
to 
boost PFC 
converter 
LDM 
PE 
Fig. 3.10 The EMI ﬁlter for boost PFC converter 
RLN
Cp 
vDS 
–
+ 
1 
2 
–
vCM 
– 
+ 
2Cy 
LCM 
′
2RLN 
Lb 
Cx1
vDS 
– 
+ 
2vDM 
– 
+ 
Cx2 
2LDM 
′ 
(a) CM EMI filter                                 (b) DM EMI filter 
Fig. 3.11 The boost PFC converter with the CM and DM EMI ﬁlters 
3.2 
Design of the EMI Filter for Boost PFC Converters 
3.2.1 
EMI Filter for Boost PFC Converters 
The EMI ﬁlter suitable for boost PFC converters is shown in Fig. 3.10 [7], where, 
the CM ﬁlter is realized by the CM inductor LCM and the CM capacitor Cy, while 
the DM ﬁlter is consisted of the DM inductor LDM and the DM capacitors Cx1 and 
Cx2. The CM and DM ﬁlters extracted from Fig. 3.10 are given in Fig. 2.11. 
With the CM and DM ﬁlters in Fig. 2.11, as well as the CM and DM noise 
equivalent circuits in Fig. 3.9, Fig.  3.11a, b show the boost PFC converter with the 
CM and DM ﬁlters, respectively. 
3.2.2 
Design of the EMI Filter for the Boost PFC Converter 
According to the attenuation requirement and the insert voltage gain (IVG) curve for 
the CM and DM noises, the corner frequency f c of the IVG curve and the tagency 
point of these two curves can be found, as shown in Fig. 3.12. According to Fig. 3.11, 
both the CM and DM EMI ﬁlters are second order ones, so their IVG curves above 
f c are both 40 dB/dec.
In Fig. 3.12, the frequency at the tagency point is denoted as f req, and the atten-
uation requirement of the tagency point is referred to as Areq. According to the 
highlighted triangle, we have

3.2 Design of the EMI Filter for Boost PFC Converters
47
40 dB/dec 
Areq 
freq
fc
f (Hz) 
Attenuation (dB) 
IVG of the filter 
Curve for the 
Attenuation 
requirement 
0 
Point of 
tangency 
Fig. 3.12 The attenuation requirement and the IVG of EMI ﬁlter for conducted EMI
upper  A S
u
bsc ript req B as
e
line equals 40 left parenthesis log base 10 f Subscript req Baseline minus log base 10 f Subscript c Baseline right parenthesis
According to (3.10), f c is solved as 
f S ub scrip t c Ba
seline equals f Subscript req Baseline dot 10 Superscript minus StartFraction upper A Super Subscript req Superscript Over 40 EndFraction
f 
Subscript c Baseline equals f Subscript req Baseline dot 10 Superscript minus StartFraction upper A Super Subscript req Superscript Over 40 EndFraction
To determine the component parameters for the CM ﬁlter shown in Fig. 3.11a, 
the CM capacitance is ﬁrst calculated by considering the leakage current limit [8]. 
The corner frequency f c_CM is expressed as 
f Subs c
ript c Baseline normal bar CM equals StartFraction 1 Over 2 pi StartRoot upper L Subscript CM Baseline left parenthesis 2 upper C Subscript y Baseline right parenthesis EndRoot EndFraction
f Subscript c Baseline normal bar CM equals StartFraction 1 Over 2 pi StartRoot upper L Subscript CM Baseline left parenthesis 2 upper C Subscript y Baseline right parenthesis EndRoot EndFraction
/
f S
u
bsc
r
ipt c Baseline normal bar CM equals StartFraction 1 Over 2 pi StartRoot upper L Subscript CM Baseline left parenthesis 2 upper C Subscript y Baseline right parenthesis EndRoot EndFraction
Thus, the CM inductance can be derived as 
uppe r
 L Subscript CM Baseline equals StartFraction 1 Over 2 upper C Subscript y Baseline left parenthesis 2 pi f Subscript c normal bar CM Baseline right parenthesis squared EndFraction
upp
e
r L  Subs
cr
ipt CM Baseline equals StartFraction 1 Over 2 upper C Subscript y Baseline left parenthesis 2 pi f Subscript c normal bar CM Baseline right parenthesis squared EndFraction
When designing the DM ﬁlter for boost PFC converters, the DM capacitors Cxdc 
and Cxac are ﬁrst added at the DC and AC sides of the rectiﬁer bridge for suppressing 
the mixed-mode noise. As discussed earlier, Cxdc and Cxac should be larger than 0.2 
μF, and Cx1, which equals to Cxdc + Cxac, can be preselected as 0.4 μF. Referring 
to Fig. 3.11b, the corner frequency f c_DM of the DM ﬁlter is calculated as 
f Subs c
ript c normal bar DM Baseline equals StartFraction 1 Over 2 pi StartRoot 2 upper L Subscript DM Baseline upper C Subscript x 2 Baseline EndRoot EndFraction
f Subscript c normal bar DM Baseline equals StartFraction 1 Over 2 pi StartRoot 2 upper L Subscript DM Baseline upper C Subscript x 2 Baseline EndRoot EndFraction√f Subscr
ipt c normal bar DM Baseline equals StartFraction 1 Over 2 pi StartRoot 2 upper L Subscript DM Baseline upper C Subscript x 2 Baseline EndRoot EndFraction

48
3
Common-Mode and Differential-Mode Noise Equivalent Circuits …
The DM inductance LDM is usually implemented by the leakage inductance Llk of 
the CM inductor LCM, which can be measured when the CM inductor is fabricated. 
Thus, according to (3.14), Cx2 is solved as 
uppe r
 C Subscript x 2 Baseline equals StartFraction 1 Over 2 upper L Subscript DM Baseline left parenthesis 2 pi f Subscript c normal bar DM Baseline right parenthesis squared EndFraction
uppe
r
 C Subsc
ri
pt x 2 Baseline equals StartFraction 1 Over 2 upper L Subscript DM Baseline left parenthesis 2 pi f Subscript c normal bar DM Baseline right parenthesis squared EndFraction
According to (3.15), if Cx2 is smaller than Cx1 (0.4 μF), the DM ﬁlter design is 
ﬁnished. Otherwise, Cx1 can be increased to reduce Cx2. Normally, the overall DM 
capacitance (Cx1 + Cx2) will be the smallest when Cx1 = Cx2 [9], resulting in the 
smallest overall volume for the DM capacitors. 
3.3 
Summary 
In this chapter, the propagation paths for the CM and DM noises of boost PFC 
converters are analyzed. It is pointed out that the CM and DM noises affect each 
other, leading to the mixed-mode noise. To suppress the mixed-mode noise, the DM 
capacitors are added at the DC and AC sides of the rectiﬁer bridge, eliminating the 
mixed-mode noise during the on-state and off-state of the rectiﬁer bridge, respec-
tively. After that, the CM and DM noise equivalent circuits of boost PFC converters 
are derived, and the design of EMI ﬁlters is given. With the derived CM and DM 
noise equivalent circuits in this chapter, the conducted EMI spectra for boost PFC 
converters will be explored in Chaps. 4 and 5, specially investigating their behavior 
under different control schemes. 
References 
1. P. Kong, Y. Jiang, F.C. Lee, Common mode EMI noise characteristics of low-power ac-dc 
converters. IEEE Trans. Power Electron. 27(2), 731–738 (2012) 
2. J. Sun, On the zero-crossing distortion in single-phase PFC converters. IEEE Trans. Power 
Electron. 9(3), 685–692 (2004) 
3. W. Levron, H. Kim, R.W. Erickson, Design of EMI ﬁlters having low harmonic distortion in 
high-power-factor converters. IEEE Trans. Power Electron. 29(7), 3403–3413 (2014) 
4. J. Meng, W. Ma, A new technique for modeling and analysis of mixed-mode conducted 
EMI noise, in Proceedings of IEEE Power Electronics Specialists Conference (PESC) (2004), 
pp. 1034–1042 
5. H.-I. Hsieh, D.-Y. Chen, EMI ﬁlter design method incorporating mix-mode conducted noise 
for off-line applications, in Proceedings of Vehicle Power and Propulsion Conference (VPPC) 
(2008), pp. 1617–1622 
6. H.-I. Hsieh, Effects of mix-mode noise emissions on the design method of power factor correction 
boost rectiﬁer EMI ﬁlters, in Proceedings of International Power Electronics Conference (IPEC) 
(2010), pp. 2438–2443

References
49
7. S. Wang, Characterization and cancellation of high-frequency parasitics for EMI ﬁlters and noise 
separators in power electronics applications. Ph.D. Dissertation, Virginia Polytechnic Institute 
and State University, Blacksburg, USA, 2005 
8. IEC 60990, Methods of Measurement of Touch Current and Protective Conductor Current 
(British Standard, British, 1999) 
9. Q. Ji, Research on conducted EMI of boost PFC converter. Ph.D Dissertation, Nanjing University 
of Aeronautics and Astronautics, Nanjing, 2014

Chapter 4 
Prediction of the Conducted 
Electro-magnetic Interference 
for Average-Current-Controlled Boost 
Power Factor Correction Converter 
4.1 
Operation Modes of Average-Current-Controlled Boost 
PFC Converters 
Figure 4.1 shows the boost power factor correction (PFC) converter with average-
current-control, where, D1 ~ D4 constitute the input bridge rectiﬁer; boost inductor 
Lb, power switch Qb, diode Db, and output capacitor Co constitute the boost converter; 
and RLd is the load resistor, and Cxac and Cxdc are the capacitors for suppressing the 
mixed-mode noise.
The control scheme includes the output voltage closed-loop and the inductor 
current closed-loop. The output voltage V o is sensed and compared with the reference 
signal V o_ref, and the error signal is sent into the voltage regulator Gv(s). The output 
of the voltage regulator is multiplied with the sensed rectiﬁed input voltage, which 
serves as the current reference signal iLb_ref. The inductor current iLb is sensed and 
compared with iLb_ref, and the error signal is sent to the current regulator Gi(s). The 
output of Gi(s) is compared with the sawtooth carrier, generating the driving signals 
for power switch Qb. 
Under different input voltage and load conditions, the boost PFC converter will be 
operated either in continuous conduction mode (CCM) or discontinuous conduction 
mode (DCM) in a switching cycle. Thus, the boost PFC converter may operate in 
all-CCM, part-CCM/DCM and all-DCM [1–4]. Figure 4.2 shows the waveforms of 
boost inductor current in different operation modes, where, T line is the line period.
The rectiﬁed input voltage of boost PFC converter can be expressed as 
v Subscript g Baseline left parenthesis t right parenthesis equals StartAbsoluteValue v Subscript in Baseline left parenthesis t right parenthesis EndAbsoluteValue equals StartRoot 2 EndRoot upper V Subscript in Baseline StartAbsoluteValue sine omega Subscript in Baseline t EndAbsoluteValue
√
vVSubscri pt g 
Baseline left parenthesis t right parenthesis equals StartAbsoluteValue v Subscript in Baseline left parenthesis t right parenthesis EndAbsoluteValue equals StartRoot 2 EndRoot upper V Subscript in Baseline StartAbsoluteValue sine omega Subscript in Baseline t EndAbsoluteValue
where, vin is the input voltage, V in is the root-mean-square (rms) value of the input 
voltage, and ωin is the angular frequency of the input voltage.
© The Author(s), under exclusive license to Springer Nature Singapore Pte Ltd. 2024 
X. Ruan et al., Conducted Electromagnetic Interference in Power Converters: Modeling, 
Prediction and Reduction, CPSS Power Electronics Series, 
https://doi.org/10.1007/978-981-99-9295-9_4 
51

52
4
Prediction of the Conducted Electro-magnetic Interference …
Co
Qb 
Lb
Db 
vg 
+ 
– 
L 
N 
vin
Vo 
+ 
– 
iLb 
Hv2 
Gv(s) 
Hi
Hv1 
Gi(s)
iLb_ref 
+ 
– 
+ 
– 
Driver 
RLd 
Vo_ref 
D1 D2 
D3 D4 
Cxac 
Cxdc 
Fig. 4.1 Average-current-controlled boost PFC converter
0 
0
Tline/2
Tline/4 
t 
0 
0 
t 
t 
iLb 
All-CCM 
All-DCM 
iLb_avg 
Part-CCM/DCM
iLb 
iLb 
iLb_avg 
iLb_avg 
Fig. 4.2 Boost inductor current waveforms under different operation modes
When operated in CCM, the duty cycle Dy_CCM and the inductor current ripple
Δi are respectively expressed as 
upper D Subscr ipt y normal bar CCM Baseline left parenthesis t right parenthesis equals 1 minus StartFraction v Subscript g Baseline left parenthesis t right parenthesis Over upper V Subscript o Baseline EndFraction
upp
er D Subscript y normal bar CCM Baseline left parenthesis t right parenthesis equals 1 minus StartFraction v Subscript g Baseline left parenthesis t right parenthesis Over upper V Subscript o Baseline EndFraction
normal upper Delta i left parenthesis t right parenthesis equals StartFraction v Subscript g Baseline left parenthesis t right parenthesis upper D Subscript y normal bar CCM Baseline left parenthesis t right parenthesis Over upper L Subscript b Baseline f Subscript s Baseline EndFraction equals StartFraction v Subscript g Baseline left parenthesis t right parenthesis Over upper L Subscript b Baseline f Subscript s Baseline EndFraction left parenthesis 1 minus StartFraction v Subscript g Baseline left parenthesis t right parenthesis Over upper V Subscript o Baseline EndFraction right parenthesis
nor mal
 upper Delta i left parenthesis t right parenthesis equals StartFraction v Subscript g Baseline left parenthesis t right parenthesis upper D Subscript y normal bar CCM Baseline left parenthesis t right parenthesis Over upper L Subscript b Baseline f Subscript s Baseline EndFraction equals StartFraction v Subscript g Baseline left parenthesis t right parenthesis Over upper L Subscript b Baseline f Subscript s Baseline EndFraction left parenthesis 1 minus StartFraction v Subscript g Baseline left parenthesis t right parenthesis Over upper V Subscript o Baseline EndFraction right parenthesis
nor ma
l
 u pper Delta i left parenthesis t right parenthesis equals StartFraction v Subscript g Baseline left parenthesis t right parenthesis upper D Subscript y normal bar CCM Baseline left parenthesis t right parenthesis Over upper L Subscript b Baseline f Subscript s Baseline EndFraction equals StartFraction v Subscript g Baseline left parenthesis t right parenthesis Over upper L Subscript b Baseline f Subscript s Baseline EndFraction left parenthesis 1 minus StartFraction v Subscript g Baseline left parenthesis t right parenthesis Over upper V Subscript o Baseline EndFraction right parenthesis
no
r
mal upper Delta i left parenthesis t right parenthesis equals StartFraction v Subscript g Baseline left parenthesis t right parenthesis upper D Subscript y normal bar CCM Baseline left parenthesis t right parenthesis Over upper L Subscript b Baseline f Subscript s Baseline EndFraction equals StartFraction v Subscript g Baseline left parenthesis t right parenthesis Over upper L Subscript b Baseline f Subscript s Baseline EndFraction left parenthesis 1 minus StartFraction v Subscript g Baseline left parenthesis t right parenthesis Over upper V Subscript o Baseline EndFraction right parenthesis
where, V o is the output voltage, and f s is the switching frequency. 
Assuming that the efﬁciency is 100%, to ensure that the converter operates in 
CCM under the output power of Po, the average value of the inductor current, iLb_avg, 
should satisfy

4.1 Operation Modes of Average-Current-Controlled Boost PFC Converters
53
i Subscript upper L b normal bar avg Baseline left parenthesis t right parenthesis equals StartFraction StartRoot 2 EndRoot upper P Subscript o Baseline Over upper V Subscript in Baseline EndFraction StartAbsoluteValue sine omega Subscript in Baseline t EndAbsoluteValue greater than or equals one half normal upper Delta i left parenthesis t right parenthesis
√
i Subscript upper L b normal bar avg Baseline left parenthesis t right parenthesis equals StartFraction StartRoot 2 EndRoot upper P Subscript o Baseline Over upper V Subscript in Baseline EndFraction StartAbsoluteValue sine omega Subscript in Baseline t EndAbsoluteValue greater than or equals one half normal upper Delta i left parenthesis t right parenthesis
i Su
bscri pt upper L b normal bar avg Baseline left parenthesis t right parenthesis equals StartFraction StartRoot 2 EndRoot upper P Subscript o Baseline Over upper V Subscript in Baseline EndFraction StartAbsoluteValue sine omega Subscript in Baseline t EndAbsoluteValue greater than or equals one half normal upper Delta i left parenthesis t right parenthesis
i Subsc
ript upper L b normal bar avg Baseline left parenthesis t right parenthesis equals StartFraction StartRoot 2 EndRoot upper P Subscript o Baseline Over upper V Subscript in Baseline EndFraction StartAbsoluteValue sine omega Subscript in Baseline t EndAbsoluteValue greater than or equals one half normal upper Delta i left parenthesis t right parenthesis
Substituting (4.1) into (4.3) and then combining with (4.4), we have 
1 minus StartFraction StartRoot 2 EndRoot upper V Subscript in Baseline Over upper V Subscript o Baseline EndFraction StartAbsoluteValue sine omega Subscript in Baseline t EndAbsoluteValue less than or equals StartFraction 2 upper P Subscript o Baseline upper L Subscript b Baseline f Subscript s Baseline Over upper V Subscript in Superscript 2 Baseline EndFraction
√
1Vminus StartFraction StartRoot 2 EndRoot upper V Subscript in Baseline Over upper V Subscript o Baseline EndFraction StartAbsoluteValue sine omega Subscript in Baseline t EndAbsoluteValue less than or equals StartFraction 2 upper P Subscript o Baseline upper L Subscript b Baseline f Subscript s Baseline Over upper V Subscript in Superscript 2 Baseline EndFraction
1 m
inus StartFraction StartRoot 2 EndRoot upper V Subscript in Baseline Over upper V Subscript o Baseline EndFraction StartAbsoluteValue sine omega Subscript in Baseline t EndAbsoluteValue less than or equals StartFraction 2 upper P Subscript o Baseline upper L Subscript b Baseline f Subscript s Baseline Over upper V Subscript in Superscript 2 Baseline EndFraction
1 mi
nus
 StartFraction StartRoot 2 EndRoot upper V Subscript in Baseline Over upper V Subscript o Baseline EndFraction StartAbsoluteValue sine omega Subscript in Baseline t EndAbsoluteValue less than or equals StartFraction 2 upper P Subscript o Baseline upper L Subscript b Baseline f Subscript s Baseline Over upper V Subscript in Superscript 2 Baseline EndFraction
As seen in (4.5), when |sinωint| = 0, the left side has the maximum value. Thus, 
the output power in all-CCM is 
upper P Sub s
cr ip
t o normal bar all hyphen CCM Baseline greater than or equals StartFraction upper V Subscript in Superscript 2 Baseline Over 2 upper L Subscript b Baseline f Subscript s Baseline EndFraction
uppe r P
 Subscript o normal bar all hyphen CCM Baseline greater than or equals StartFraction upper V Subscript in Superscript 2 Baseline Over 2 upper L Subscript b Baseline f Subscript s Baseline EndFraction
If the inequality (4.5) is not satisﬁed, the converter will be operated in DCM in a 
certain period in a half line cycle. Furthermore, if (4.5) is not satisﬁed at T line/4, where 
|sinωint| = 1, the converter will be always operated in DCM. Hence, substituting 
|sinωint| = 1 into (4.5), the output power in all-DCM can be derived as 
upper P Sub sc
ri pt
 o
 
nor mal bar all hyphen DCM Baseline less than StartFraction upper V Subscript in Superscript 2 Baseline left parenthesis upper V Subscript o Baseline minus StartRoot 2 EndRoot upper V Subscript in Baseline right parenthesis Over 2 upper L Subscript b Baseline f Subscript s Baseline upper V Subscript o Baseline EndFraction
√
uppe
r P Subscript o normal bar all hyphen DCM Baseline less than StartFraction upper V Subscript in Superscript 2 Baseline left parenthesis upper V Subscript o Baseline minus StartRoot 2 EndRoot upper V Subscript in Baseline right parenthesis Over 2 upper L Subscript b Baseline f Subscript s Baseline upper V Subscript o Baseline EndFraction
uppe r P S
ubscript o normal bar all hyphen DCM Baseline less than StartFraction upper V Subscript in Superscript 2 Baseline left parenthesis upper V Subscript o Baseline minus StartRoot 2 EndRoot upper V Subscript in Baseline right parenthesis Over 2 upper L Subscript b Baseline f Subscript s Baseline upper V Subscript o Baseline EndFraction
The boost inductance Lb is usually designed according to λi, which is the ratio 
of the inductor current ripple Δi and the average inductor current iLb_avg under the 
minimum input voltage V in_min and full-load Po_max at T line/4 [5]. According to (4.3) 
and (4.4), λi is derived as 
lam d
a Subscript i Baseline equals StartFraction normal upper Delta i Over i Subscript upper L b normal bar avg Baseline EndFraction equals StartFraction upper V Subscript in normal bar min Superscript 2 Baseline Over upper L Subscript b Baseline upper P Subscript o normal bar max Baseline f Subscript s Baseline EndFraction dot left parenthesis 1 minus StartFraction StartRoot 2 EndRoot upper V Subscript in normal bar min Baseline Over upper V Subscript o Baseline EndFraction right parenthesis
lamda Su
bs
cr ip
t i Baseline equals StartFraction normal upper Delta i Over i Subscript upper L b normal bar avg Baseline EndFraction equals StartFraction upper V Subscript in normal bar min Superscript 2 Baseline Over upper L Subscript b Baseline upper P Subscript o normal bar max Baseline f Subscript s Baseline EndFraction dot left parenthesis 1 minus StartFraction StartRoot 2 EndRoot upper V Subscript in normal bar min Baseline Over upper V Subscript o Baseline EndFraction right parenthesis
lamda Subs cri
p
t
 i  Baseline equals StartFraction normal upper Delta i Over i Subscript upper L b normal bar avg Baseline EndFraction equals StartFraction upper V Subscript in normal bar min Superscript 2 Baseline Over upper L Subscript b Baseline upper P Subscript o normal bar max Baseline f Subscript s Baseline EndFraction dot left parenthesis 1 minus StartFraction StartRoot 2 EndRoot upper V Subscript in normal bar min Baseline Over upper V Subscript o Baseline EndFraction right parenthesis
√
lamda Subscript i Baseline equals StartFraction normal upper Delta i Over i Subscript upper L b normal bar avg Baseline EndFraction equals StartFraction upper V Subscript in normal bar min Superscript 2 Baseline Over upper L Subscript b Baseline upper P Subscript o normal bar max Baseline f Subscript s Baseline EndFraction dot left parenthesis 1 minus StartFraction StartRoot 2 EndRoot upper V Subscript in normal bar min Baseline Over upper V Subscript o Baseline EndFraction right parenthesis
la
m
da Subscript i Baseline equals StartFraction normal upper Delta i Over i Subscript upper L b normal bar avg Baseline EndFraction equals StartFraction upper V Subscript in normal bar min Superscript 2 Baseline Over upper L Subscript b Baseline upper P Subscript o normal bar max Baseline f Subscript s Baseline EndFraction dot left parenthesis 1 minus StartFraction StartRoot 2 EndRoot upper V Subscript in normal bar min Baseline Over upper V Subscript o Baseline EndFraction right parenthesis
According to (4.8), the boost inductance Lb is given by 
up e
r L 
Subscript b Baseline equals StartFraction upper V Subscript in normal bar min Superscript 2 Baseline Over lamda Subscript i Baseline upper P Subscript o normal bar max Baseline f Subscript s Baseline EndFraction left parenthesis 1 minus StartFraction StartRoot 2 EndRoot upper V Subscript in normal bar min Baseline Over upper V Subscript o Baseline EndFraction right parenthesis
up er L Su bs
c
ri pt b Baseline equals StartFraction upper V Subscript in normal bar min Superscript 2 Baseline Over lamda Subscript i Baseline upper P Subscript o normal bar max Baseline f Subscript s Baseline EndFraction left parenthesis 1 minus StartFraction StartRoot 2 EndRoot upper V Subscript in normal bar min Baseline Over upper V Subscript o Baseline EndFraction right parenthesis
√
upper L Subscript b Baseline equals StartFraction upper V Subscript in normal bar min Superscript 2 Baseline Over lamda Subscript i Baseline upper P Subscript o normal bar max Baseline f Subscript s Baseline EndFraction left parenthesis 1 minus StartFraction StartRoot 2 EndRoot upper V Subscript in normal bar min Baseline Over upper V Subscript o Baseline EndFraction right parenthesis
up
p
er L Subscript b Baseline equals StartFraction upper V Subscript in normal bar min Superscript 2 Baseline Over lamda Subscript i Baseline upper P Subscript o normal bar max Baseline f Subscript s Baseline EndFraction left parenthesis 1 minus StartFraction StartRoot 2 EndRoot upper V Subscript in normal bar min Baseline Over upper V Subscript o Baseline EndFraction right parenthesis
Substituting (4.9) into (4.6) and (4.7), respectively, with the base of the rated 
output power, the normalized output power in all-CCM and all-DCM can be derived 
as 
upp
er P Subsc ri pt o normal bar all hyphen CCM Superscript asterisk Baseline equals StartFraction upper P Subscript o normal bar all hyphen CCM Baseline Over upper P Subscript o normal bar max Baseline EndFraction greater than or equals StartFraction lamda Subscript i Baseline upper V Subscript in Superscript 2 Baseline upper V Subscript o Baseline Over 2 upper V Subscript in normal bar min Superscript 2 Baseline left parenthesis upper V Subscript o Baseline minus StartRoot 2 EndRoot upper V Subscript in normal bar min Baseline right parenthesis EndFraction
upper P
 
Subsc ri
ptVo normal bar all hyphen CCM Superscript asterisk Baseline equals StartFraction upper P Subscript o normal bar all hyphen CCM Baseline Over upper P Subscript o normal bar max Baseline EndFraction greater than or equals StartFraction lamda Subscript i Baseline upper V Subscript in Superscript 2 Baseline upper V Subscript o Baseline Over 2 upper V Subscript in normal bar min Superscript 2 Baseline left parenthesis upper V Subscript o Baseline minus StartRoot 2 EndRoot upper V Subscript in normal bar min Baseline right parenthesis EndFraction
up er
 P Sub
s
cri pt o normal bar all hyphen CCM Superscript asterisk Baseline equals StartFraction upper P Subscript o normal bar all hyphen CCM Baseline Over upper P Subscript o normal bar max Baseline EndFraction greater than or equals StartFraction lamda Subscript i Baseline upper V Subscript in Superscript 2 Baseline upper V Subscript o Baseline Over 2 upper V Subscript in normal bar min Superscript 2 Baseline left parenthesis upper V Subscript o Baseline minus StartRoot 2 EndRoot upper V Subscript in normal bar min Baseline right parenthesis EndFraction
√
upper P 
S
ubscript o normal bar all hyphen CCM Superscript asterisk Baseline equals StartFraction upper P Subscript o normal bar all hyphen CCM Baseline Over upper P Subscript o normal bar max Baseline EndFraction greater than or equals StartFraction lamda Subscript i Baseline upper V Subscript in Superscript 2 Baseline upper V Subscript o Baseline Over 2 upper V Subscript in normal bar min Superscript 2 Baseline left parenthesis upper V Subscript o Baseline minus StartRoot 2 EndRoot upper V Subscript in normal bar min Baseline right parenthesis EndFraction

54
4
Prediction of the Conducted Electro-magnetic Interference …
Fig. 4.3 The regions for the 
all-CCM, part-CCM/DCM, 
and all-DCM 
90
150
210
264 
Vin (V) 
0 
0.50 
0.75 
1.00 
0.25 
Po 
Po_max 
Po_all-CCM 
* 
Po_all-DCM 
* 
VCCM_max
All-CCM 
Part-CCM/DCM 
All-DCM
3 
1 
2 
upp
er P Subsc ri pt o normal bar all hyphen DCM Superscript asterisk Baseline equals StartFraction upper P Subscript o normal bar all hyphen DCM Baseline Over upper P Subscript o normal bar max Baseline EndFraction less than StartFraction lamda Subscript i Baseline upper V Subscript in Superscript 2 Baseline left parenthesis upper V Subscript o Baseline minus StartRoot 2 EndRoot upper V Subscript in Baseline right parenthesis Over 2 upper V Subscript in normal bar min Superscript 2 Baseline left parenthesis upper V Subscript o Baseline minus StartRoot 2 EndRoot upper V Subscript in normal bar min Baseline right parenthesis EndFraction
upper P
 S
ubscr ip
t 
o
Vno rmal bar all hyphen DCM Superscript asterisk Baseline equals StartFraction upper P Subscript o normal bar all hyphen DCM Baseline Over upper P Subscript o normal bar max Baseline EndFraction less than StartFraction lamda Subscript i Baseline upper V Subscript in Superscript 2 Baseline left parenthesis upper V Subscript o Baseline minus StartRoot 2 EndRoot upper V Subscript in Baseline right parenthesis Over 2 upper V Subscript in normal bar min Superscript 2 Baseline left parenthesis upper V Subscript o Baseline minus StartRoot 2 EndRoot upper V Subscript in normal bar min Baseline right parenthesis EndFraction
√
uppe
r P Subscript o normal bar all hyphen DCM Superscript asterisk Baseline equals StartFraction upper P Subscript o normal bar all hyphen DCM Baseline Over upper P Subscript o normal bar max Baseline EndFraction less than StartFraction lamda Subscript i Baseline upper V Subscript in Superscript 2 Baseline left parenthesis upper V Subscript o Baseline minus StartRoot 2 EndRoot upper V Subscript in Baseline right parenthesis Over 2 upper V Subscript in normal bar min Superscript 2 Baseline left parenthesis upper V Subscript o Baseline minus StartRoot 2 EndRoot upper V Subscript in normal bar min Baseline right parenthesis EndFraction
up er
 P Sub
s
cri pt o normal bar all hyphen DCM Superscript asterisk Baseline equals StartFraction upper P Subscript o normal bar all hyphen DCM Baseline Over upper P Subscript o normal bar max Baseline EndFraction less than StartFraction lamda Subscript i Baseline upper V Subscript in Superscript 2 Baseline left parenthesis upper V Subscript o Baseline minus StartRoot 2 EndRoot upper V Subscript in Baseline right parenthesis Over 2 upper V Subscript in normal bar min Superscript 2 Baseline left parenthesis upper V Subscript o Baseline minus StartRoot 2 EndRoot upper V Subscript in normal bar min Baseline right parenthesis EndFraction
√
upper P 
S
ubscript o normal bar all hyphen DCM Superscript asterisk Baseline equals StartFraction upper P Subscript o normal bar all hyphen DCM Baseline Over upper P Subscript o normal bar max Baseline EndFraction less than StartFraction lamda Subscript i Baseline upper V Subscript in Superscript 2 Baseline left parenthesis upper V Subscript o Baseline minus StartRoot 2 EndRoot upper V Subscript in Baseline right parenthesis Over 2 upper V Subscript in normal bar min Superscript 2 Baseline left parenthesis upper V Subscript o Baseline minus StartRoot 2 EndRoot upper V Subscript in normal bar min Baseline right parenthesis EndFraction
According to (4.10) and (4.11), the regions of the input voltage and load condition 
for all-CCM, part-CCM/DCM and all-DCM are depicted in Fig. 4.3, where, V in = 
90~264 V, V o = 385 V, λi = 20%, and V all-CCM_max is the maximum input voltage 
for all-CCM under full-load. Based on (4.10), V all-CCM_max is calculated by letting 
Po_all-CCM equal to Po_max, yields 
upper V S ubscript CCM normal bar max Baseline equals NestedStartRoot StartFraction 2 upper V Subscript in normal bar min Superscript 2 Baseline left parenthesis upper V Subscript o Baseline minus StartRoot 2 EndRoot upper V Subscript in normal bar min Baseline right parenthesis Over lamda Subscript i Baseline upper V Subscript o Baseline EndFraction NestedEndRoot
[
|
|
|up er
 V Sub
s
cri pt CCM normal bar max Baseline equals NestedStartRoot StartFraction 2 upper V Subscript in normal bar min Superscript 2 Baseline left parenthesis upper V Subscript o Baseline minus StartRoot 2 EndRoot upper V Subscript in normal bar min Baseline right parenthesis Over lamda Subscript i Baseline upper V Subscript o Baseline EndFraction NestedEndRoot
√
upper V 
Subscript CCM normal bar max Baseline equals NestedStartRoot StartFraction 2 upper V Subscript in normal bar min Superscript 2 Baseline left parenthesis upper V Subscript o Baseline minus StartRoot 2 EndRoot upper V Subscript in normal bar min Baseline right parenthesis Over lamda Subscript i Baseline upper V Subscript o Baseline EndFraction NestedEndRoot
uper 
V Subscript CCM normal bar max Baseline equals NestedStartRoot StartFraction 2 upper V Subscript in normal bar min Superscript 2 Baseline left parenthesis upper V Subscript o Baseline minus StartRoot 2 EndRoot upper V Subscript in normal bar min Baseline right parenthesis Over lamda Subscript i Baseline upper V Subscript o Baseline EndFraction NestedEndRoot
As seen in Fig. 4.3, under the same input voltage V in, when upper P Su bs
cr
ipt o Baseline divided by upper P Subscript o normal bar max Baseline greater than upper P Subscript o normal bar all hyphen CCM Superscript asterisk, the converter operates in all-CCM; when up
per P Subs cr ipt o norm al
 b
ar all hyphen DCM Superscript asterisk Baseline less than or equals upper P Subscript o Baseline divided by upper P Subscript o normal bar max Baseline less than or equals upper P Subscript o normal bar all hyphen CCM Superscript asterisk, the converter operates in part-CCM/DCM; when upper P Su bscr
ipt o Baseline divided by upper P Subscript o normal bar max Baseline less than upper P Subscript o normal bar all hyphen DCM Superscript asterisk, 
the converter operates in all-DCM. 
4.2 
The Voltage Across the Power Switch Under Different 
Operation Modes 
Take the positive half line cycle as an example, the switching modes of the boost 
PFC converter under three operating modes are illustrated in Fig. 4.4.

4.2 The Voltage Across the Power Switch Under Different Operation Modes
55
Co 
Qb 
Lb
Db 
RLd
Cxdc
– 
+ 
vDS
vg 
+ 
– 
Vo 
+ 
– 
iLb 
L 
N 
vin
Cxac 
D1 
D2 
D3 
D4 
(a) Qb is conducting 
Co 
Qb 
Lb
Db 
RLd
– 
+ 
vDS
vg 
+ 
– 
Vo 
+ 
– 
iLb 
L 
N 
vin 
D1 
D2 
D3 
D4 
Cxdc
Cxac 
(b) Qb is turned off 
Co 
Qb 
Lb
Db 
RLd
– 
+ 
vDS
vg 
+ 
– 
Vo 
+ 
– 
iLb 
L 
N 
vin 
D1 
D2 
D3 
D4 
Cxdc
Cxac 
(c) Resonance between Lb and the capacitance of Qb 
Co 
Qb 
Lb
Db 
RLd
– 
+ 
vDS
vg 
+ 
– 
Vo 
+ 
– 
iLb 
L 
N 
vin 
D1 
D2 
D3 
D4 
Cxdc
Cxac 
(d) The body diode of Qb is conducting 
Fig. 4.4 The switching modes of boost PFC converter operated in CCM and DCM

56
4
Prediction of the Conducted Electro-magnetic Interference …
4.2.1 
The Waveforms of vDS in CCM and DCM Within 
a Switching Cycle 
In CCM, when Qb is conducting, its drain-to-source voltage vDS is zero, and the 
inductor current iLb rises linearly, as shown in Fig. 4.4a. When Qb is turned off, 
vDS equals to V o, and iLb decays linearly, as shown in Fig. 4.4b. Figure 4.5 gives 
the waveforms of vDS and iLb for the boost PFC converter in CCM, and vDS can be 
expressed as 
v Subscript D
S n
orm a
l
 bar CCM Ba
s
eli ne l
e
ft parenthes
i
s t Subscript s Baseline right parenthesis equals StartLayout Enlarged left brace 1st Row 1st Column 0 2nd Column t Subscript s Baseline element of left bracket 0 comma upper D Subscript y normal bar CCM Baseline upper T Subscript s Baseline right bracket 2nd Row 1st Column upper V Subscript o Baseline 2nd Column t Subscript s Baseline element of left parenthesis upper D Subscript y normal bar CCM Baseline upper T Subscript s Baseline comma upper T Subscript s Baseline right bracket EndLayout
In DCM, the possible waveforms of iLb and vDS in a switching cycle is shown in 
Fig. 4.6, and the duty cycle is deﬁned as Dy_DCM. In [0,  Dy_DCMT s], Qb is conducting, 
and the switching mode is shown in Fig. 4.5a. In [Dy_DCMT s, td], Qb is turned off, 
and the switching mode is shown in Fig. 4.5b. At the time instant td, iLb decays to 
zero, and Lb resonates with the junction capacitor CDS of Qb (assuming that CDS is 
far larger than the junction capacitor of diode Db), as shown in Fig. 4.5c. If 2vg ≥ V o, 
the waveforms of iLb and vDS are given in Fig. 4.6a, where the resonance between 
Lb and CDS continues until Qb is turned on, and the minimal value of vDS is 2vg − 
V o. If 2vg < V o, the waveforms of iLb and vDS are shown in Fig. 4.6b, where, vDS 
drops to 0 at t1, and the body diode of Qb is conducting, as shown in Fig. 4.5d. As 
the voltage across Lb is vg, iLb rises linearly. When iLb rises to zero at t2, Lb and CDS 
resonate again, and the switching mode is the same as Fig. 4.5c until Qb is turned 
on. During [t2, T s], the maximum of vDS is 2vg.
According to Fig. 4.6, vDS can be expressed as 
v Subscript DS n
o
rm
al
 
bar  
D
CM normal b
a
r 
a B a
s
eline left p
a
ren t
h
esi s t 
S
ubsc ript s  Baseline  right pare
nthesis equals StartLayout Enlarged left brace 1st Row 1st Column 0 2nd Column t Subscript s Baseline element of left bracket 0 comma upper D Subscript y normal bar DCM Baseline upper T Subscript s Baseline right bracket 2nd Row 1st Column upper V Subscript o Baseline 2nd Column t Subscript s Baseline element of left parenthesis upper D Subscript y normal bar DCM Baseline upper T Subscript s Baseline comma t Subscript d Baseline right bracket 3rd Row 1st Column v Subscript g Baseline plus left parenthesis upper V Subscript o Baseline minus v Subscript g Baseline right parenthesis cosine omega Subscript r Baseline left parenthesis t Subscript s Baseline minus t Subscript d Baseline right parenthesis 2nd Column t Subscript s Baseline element of left parenthesis t Subscript d Baseline comma upper T Subscript s Baseline right bracket EndLayout
Fig. 4.5 Waveforms of iLb 
and vDS in a switching cycle 
in CCM 
Ts 
iLb 
vDS 
0 
0 
Vo 
Dy_CCMTs 
ts 
ts 
0 
Δi 

4.2 The Voltage Across the Power Switch Under Different Operation Modes
57
iLb 
vDS 
0 
0 
Vo 
2vg – Vo 
Dy_DCMTs
Ts
td 
ts 
ts 
0 
Δi
         
ts 
ts 
Vo 
2vg 
Dy_DCMTs
Ts
t2
t1
td 
vDS 
iLb 
0 
0 
0 
Δi 
(a) 2vg ≥ Vo                                                (b) 2vg < Vo 
Fig. 4.6 Waveforms of iLb and vDS in a switching cycle in DCM
v Subscript DS n
o
rmal 
bar D
C
M n o
r
mal bar b B
a
seli ne left parent
he
sis  
t
 Subscript s
 
Bas e
l
ine  rig
h
t pa renthe sis equal s StartLayo
ut Enlar ged left b race 1
st Row 1st Col
umn 0 2nd Column t Subscript s Baseline element of left bracket 0 comma upper D Subscript y normal bar DCM Baseline upper T Subscript s Baseline right bracket and t Subscript s Baseline element of left parenthesis t 1 comma t 2 right bracket 2nd Row 1st Column upper V Subscript o Baseline 2nd Column t Subscript s Baseline element of left parenthesis upper D Subscript y normal bar DCM Baseline upper T Subscript s Baseline comma t Subscript d Baseline right bracket 3rd Row 1st Column v Subscript g Baseline plus left parenthesis upper V Subscript o Baseline minus v Subscript g Baseline right parenthesis cosine omega Subscript r Baseline left parenthesis t Subscript s Baseline minus t Subscript d Baseline right parenthesis 2nd Column t Subscript s Baseline element of left parenthesis t Subscript d Baseline comma t 1 right bracket 4th Row 1st Column v Subscript g Baseline minus v Subscript g Baseline cosine omega Subscript r Baseline left parenthesis t Subscript s Baseline minus t Subscript o 2 Baseline right parenthesis 2nd Column t Subscript s Baseline element of left parenthesis t 2 comma upper T Subscript s Baseline right bracket EndLayout
where, ωr is the resonant angular frequency of Lb and CDS, and ωr, td, t1, and t2 are 
given by 
ome ga Subscript r Baseline equals 1 divided by StartRoot upper L Subscript b Baseline upper C Subscript DS Baseline EndRoot
√
omega
 Subscript r Baseline equals 1 divided by StartRoot upper L Subscript b Baseline upper C Subscript DS Baseline EndRoot
t S u
bscript d Baseline equals StartFraction upper V Subscript o Baseline Over upper V Subscript o Baseline minus v Subscript g Baseline EndFraction upper D Subscript y normal bar DCM Baseline upper T Subscript s
t S ubscr
ipt d Ba
seline equals StartFraction upper V Subscript o Baseline Over upper V Subscript o Baseline minus v Subscript g Baseline EndFraction upper D Subscript y normal bar DCM Baseline upper T Subscript s
t 1  equa ls  t Subscript d Baseline plus StartFraction 1 Over omega Subscript r Baseline EndFraction arc cosine left parenthesis StartFraction v Subscript g Baseline Over v Subscript g Baseline minus upper V Subscript o Baseline EndFraction right parenthesis
t 1
 equal
s
 t Subscript d Baseline plus StartFraction 1 Over omega Subscript r Baseline EndFraction arc cosine left parenthesis StartFraction v Subscript g Baseline Over v Subscript g Baseline minus upper V Subscript o Baseline EndFraction right parenthesis
t 1  equ
a
ls t Subscript d Baseline plus StartFraction 1 Over omega Subscript r Baseline EndFraction arc cosine left parenthesis StartFraction v Subscript g Baseline Over v Subscript g Baseline minus upper V Subscript o Baseline EndFraction right parenthesis
t 2  equa ls  t 1 plus StartFraction 1 Over omega Subscript r Baseline v Subscript g Baseline EndFraction StartRoot left parenthesis upper V Subscript o Baseline minus v Subscript g Baseline right parenthesis squared minus v Subscript g Superscript 2 Baseline EndRoot
t 2 equals t 1 plus StartFraction 1 Over omega Subscript r Baseline v Subscript g Baseline EndFraction StartRoot left parenthesis upper V Subscript o Baseline minus v Subscript g Baseline right parenthesis squared minus v Subscript g Superscript 2 Baseline EndRoot
/t
V2 equa
ls t 1 pl
us StartFraction 1 Over omega Subscript r Baseline v Subscript g Baseline EndFraction StartRoot left parenthesis upper V Subscript o Baseline minus v Subscript g Baseline right parenthesis squared minus v Subscript g Superscript 2 Baseline EndRoot
In DCM, the peak value of the inductor current in a switching cycle is given by 
i Subscript peak normal bar DCM Baseline left parenthesis t right parenthesis equals StartFraction v Subscript g Baseline left parenthesis t right parenthesis upper D Subscript y normal bar DCM Baseline left parenthesis t right parenthesis Over upper L Subscript b Baseline f Subscript s Baseline EndFraction
i S ubs
cript peak normal bar DCM Baseline left parenthesis t right parenthesis equals StartFraction v Subscript g Baseline left parenthesis t right parenthesis upper D Subscript y normal bar DCM Baseline left parenthesis t right parenthesis Over upper L Subscript b Baseline f Subscript s Baseline EndFraction
Assuming that the resonance has negligible impact on the average inductor current, 
then the average inductor current can be obtained according to (4.17) and (4.20), 
expressed as 
i Subscript av g normal bar DCM Baseline left parenthesis t right parenthesis equals StartFraction t Subscript d Baseline Over 2 upper T Subscript s Baseline EndFraction i Subscript peak normal bar DCM Baseline left parenthesis t right parenthesis equals one half StartFraction upper V Subscript o Baseline Over upper V Subscript o Baseline minus v Subscript g Baseline left parenthesis t right parenthesis EndFraction StartFraction v Subscript g Baseline left parenthesis t right parenthesis Over upper L Subscript b Baseline f Subscript s Baseline EndFraction upper D Subscript y normal bar DCM Superscript 2 Baseline left parenthesis t right parenthesis
i Su
bscript avg normal bar DCM Baseline left parenthesis t right parenthesis equals StartFraction t Subscript d Baseline Over 2 upper T Subscript s Baseline EndFraction i Subscript peak normal bar DCM Baseline left parenthesis t right parenthesis equals one half StartFraction upper V Subscript o Baseline Over upper V Subscript o Baseline minus v Subscript g Baseline left parenthesis t right parenthesis EndFraction StartFraction v Subscript g Baseline left parenthesis t right parenthesis Over upper L Subscript b Baseline f Subscript s Baseline EndFraction upper D Subscript y normal bar DCM Superscript 2 Baseline left parenthesis t right parenthesis
i 
Subscript avg normal bar DCM Baseline left parenthesis t right parenthesis equals StartFraction t Subscript d Baseline Over 2 upper T Subscript s Baseline EndFraction i Subscript peak normal bar DCM Baseline left parenthesis t right parenthesis equals one half StartFraction upper V Subscript o Baseline Over upper V Subscript o Baseline minus v Subscript g Baseline left parenthesis t right parenthesis EndFraction StartFraction v Subscript g Baseline left parenthesis t right parenthesis Over upper L Subscript b Baseline f Subscript s Baseline EndFraction upper D Subscript y normal bar DCM Superscript 2 Baseline left parenthesis t right parenthesis
i S ubscript
 avg normal bar DCM Baseline left parenthesis t right parenthesis equals StartFraction t Subscript d Baseline Over 2 upper T Subscript s Baseline EndFraction i Subscript peak normal bar DCM Baseline left parenthesis t right parenthesis equals one half StartFraction upper V Subscript o Baseline Over upper V Subscript o Baseline minus v Subscript g Baseline left parenthesis t right parenthesis EndFraction StartFraction v Subscript g Baseline left parenthesis t right parenthesis Over upper L Subscript b Baseline f Subscript s Baseline EndFraction upper D Subscript y normal bar DCM Superscript 2 Baseline left parenthesis t right parenthesis
i S ubs
cri
pt avg n
ormal bar DCM Baseline left parenthesis t right parenthesis equals StartFraction t Subscript d Baseline Over 2 upper T Subscript s Baseline EndFraction i Subscript peak normal bar DCM Baseline left parenthesis t right parenthesis equals one half StartFraction upper V Subscript o Baseline Over upper V Subscript o Baseline minus v Subscript g Baseline left parenthesis t right parenthesis EndFraction StartFraction v Subscript g Baseline left parenthesis t right parenthesis Over upper L Subscript b Baseline f Subscript s Baseline EndFraction upper D Subscript y normal bar DCM Superscript 2 Baseline left parenthesis t right parenthesis
With the average-current control, the average input current is given by

58
4
Prediction of the Conducted Electro-magnetic Interference …
i Subscript avg normal bar DCM Baseline left parenthesis t right parenthesis equals StartFraction StartRoot 2 EndRoot upper P Subscript o Baseline Over upper V Subscript in Baseline EndFraction StartAbsoluteValue sine omega Subscript in Baseline t EndAbsoluteValue equals StartFraction upper P Subscript o Baseline Over upper V Subscript in Superscript 2 Baseline EndFraction v Subscript g Baseline left parenthesis t right parenthesis
√
i Subscript avg normal bar DCM Baseline left parenthesis t right parenthesis equals StartFraction StartRoot 2 EndRoot upper P Subscript o Baseline Over upper V Subscript in Baseline EndFraction StartAbsoluteValue sine omega Subscript in Baseline t EndAbsoluteValue equals StartFraction upper P Subscript o Baseline Over upper V Subscript in Superscript 2 Baseline EndFraction v Subscript g Baseline left parenthesis t right parenthesis
i Su
bscri pt avg n ormal bar DCM Baseline left parenthesis t right parenthesis equals StartFraction StartRoot 2 EndRoot upper P Subscript o Baseline Over upper V Subscript in Baseline EndFraction StartAbsoluteValue sine omega Subscript in Baseline t EndAbsoluteValue equals StartFraction upper P Subscript o Baseline Over upper V Subscript in Superscript 2 Baseline EndFraction v Subscript g Baseline left parenthesis t right parenthesis
i Su
bsc
ript 
avg normal bar DCM Baseline left parenthesis t right parenthesis equals StartFraction StartRoot 2 EndRoot upper P Subscript o Baseline Over upper V Subscript in Baseline EndFraction StartAbsoluteValue sine omega Subscript in Baseline t EndAbsoluteValue equals StartFraction upper P Subscript o Baseline Over upper V Subscript in Superscript 2 Baseline EndFraction v Subscript g Baseline left parenthesis t right parenthesis
According to (4.21) and (4.22), Dy_DCM is derived as 
upper D Subscript y normal bar DCM Baseline left parenthesis t right parenthesis equals StartRoot StartFraction 2 upper P Subscript o Baseline upper L Subscript b Baseline f Subscript s Baseline left parenthesis upper V Subscript o Baseline minus v Subscript g Baseline left parenthesis t right parenthesis right parenthesis Over upper V Subscript in Superscript 2 Baseline upper V Subscript o Baseline EndFraction EndRoot
/
upper D 
S
ubs cript y
 normal bar DCM Baseline left parenthesis t right parenthesis equals StartRoot StartFraction 2 upper P Subscript o Baseline upper L Subscript b Baseline f Subscript s Baseline left parenthesis upper V Subscript o Baseline minus v Subscript g Baseline left parenthesis t right parenthesis right parenthesis Over upper V Subscript in Superscript 2 Baseline upper V Subscript o Baseline EndFraction EndRoot
up pe
r D S
ubscript y normal bar DCM Baseline left parenthesis t right parenthesis equals StartRoot StartFraction 2 upper P Subscript o Baseline upper L Subscript b Baseline f Subscript s Baseline left parenthesis upper V Subscript o Baseline minus v Subscript g Baseline left parenthesis t right parenthesis right parenthesis Over upper V Subscript in Superscript 2 Baseline upper V Subscript o Baseline EndFraction EndRoot
In part-CCM/DCM, the boost PFC converter will transit from DCM to CCM 
within [0, T line/4], and the time instant of transition is deﬁned as tb. According to 
(4.5), tb is derived as 
t S ub script b Baseline equals StartFraction 1 Over omega Subscript in Baseline EndFraction arc sine left parenthesis StartFraction upper V Subscript o Baseline Over StartRoot 2 EndRoot upper V Subscript in Baseline EndFraction minus StartFraction StartRoot 2 EndRoot upper P Subscript o Baseline upper V Subscript o Baseline upper L Subscript b Baseline f Subscript s Baseline Over upper V Subscript in Superscript 3 Baseline EndFraction right parenthesis comma t Subscript b Baseline element of left bracket 0 comma upper T Subscript line Baseline divided by 4 right bracket
t Su
bscrip
t
Vb Baseline equals StartFraction 1 Over omega Subscript in Baseline EndFraction arc sine left parenthesis StartFraction upper V Subscript o Baseline Over StartRoot 2 EndRoot upper V Subscript in Baseline EndFraction minus StartFraction StartRoot 2 EndRoot upper P Subscript o Baseline upper V Subscript o Baseline upper L Subscript b Baseline f Subscript s Baseline Over upper V Subscript in Superscript 3 Baseline EndFraction right parenthesis comma t Subscript b Baseline element of left bracket 0 comma upper T Subscript line Baseline divided by 4 right bracket
√
tVSub
script b Baseline equals StartFraction 1 Over omega Subscript in Baseline EndFraction arc sine left parenthesis StartFraction upper V Subscript o Baseline Over StartRoot 2 EndRoot upper V Subscript in Baseline EndFraction minus StartFraction StartRoot 2 EndRoot upper P Subscript o Baseline upper V Subscript o Baseline upper L Subscript b Baseline f Subscript s Baseline Over upper V Subscript in Superscript 3 Baseline EndFraction right parenthesis comma t Subscript b Baseline element of left bracket 0 comma upper T Subscript line Baseline divided by 4 right bracket
√
t Subscr ipt b Baseline equals StartFraction 1 Over omega Subscript in Baseline EndFraction arc sine left parenthesis StartFraction upper V Subscript o Baseline Over StartRoot 2 EndRoot upper V Subscript in Baseline EndFraction minus StartFraction StartRoot 2 EndRoot upper P Subscript o Baseline upper V Subscript o Baseline upper L Subscript b Baseline f Subscript s Baseline Over upper V Subscript in Superscript 3 Baseline EndFraction right parenthesis comma t Subscript b Baseline element of left bracket 0 comma upper T Subscript line Baseline divided by 4 right bracket
t Su
bs
c
ri pt b  Baseline eq
uals StartFraction 1 Over omega Subscript in Baseline EndFraction arc sine left parenthesis StartFraction upper V Subscript o Baseline Over StartRoot 2 EndRoot upper V Subscript in Baseline EndFraction minus StartFraction StartRoot 2 EndRoot upper P Subscript o Baseline upper V Subscript o Baseline upper L Subscript b Baseline f Subscript s Baseline Over upper V Subscript in Superscript 3 Baseline EndFraction right parenthesis comma t Subscript b Baseline element of left bracket 0 comma upper T Subscript line Baseline divided by 4 right bracket
4.2.2 
The Waveforms of Duty Cycle and vDS in a Half Line 
Cycle 
Referring to (4.2), (4.23) and (4.24), the duty cycle in a half line cycle for all-CCM, 
part-CCM/DCM and all-DCM under the same input voltage is given in Fig. 4.7. 
Where, in all-CCM and all-DCM, the duty cycle within [0, T line/4] is Dy_CCM and 
Dy_DCM, respectively; in part-CCM/DCM, the duty cycle within [0, tb] and [tb, T line/ 
4] is Dy_DCM and Dy_CCM, respectively. According to (4.2) and (4.23), Dy_DCM is 
always less than Dy_CCM in a half line cycle under the same input rectiﬁed voltage. 
The lighter the load is, the less the duty cycle Dy_DCM will be. 
Referring to Fig. 4.6, iLb and vDS have two patterns under DCM, so t2vg=Vo is 
deﬁned as the time instant when 2vg = V o within [0, T line/4]. Figure 4.8 shows the 
waveforms of vg and vDS under different operation modes. As seen, these curves are 
symmetrical to T line/4.
0
Tline/2
Tline/4 
1 
0 
Dy 
t 
All-CCM 
All-DCM 
tb 
Part-CCM/DCM 
vg 
t 
Vo 
2 
0.5 
Fig. 4.7 The curves of the duty cycle under different operation modes 

4.2 The Voltage Across the Power Switch Under Different Operation Modes
59
0
Tline/2
Tline/4 
0
t 
vg 
vDS_all-CCM 
Vo 
1 
2 
– 
vDS_CCM 
(a) Waveforms of vg and vDS in all-CCM 
0
Tline/2
Tline/4 
0
t 
vg 
Vo 
1 
2 
– 
vDS_CCM
vDS_DCM_b
vDS_DCM_b 
vDS_DCM_a
vDS_DCM_a 
t2vg=Vo
tb 
vDS_part-CCM-DCM 
(a) Waveforms of vg and vDS in part-CCM/DCM 
0
Tline/2
Tline/4 
0
t 
vg 
Vo 
1 
2 
– 
vDS_DCM_b
vDS_DCM_b
vDS_DCM_a
vDS_DCM_a 
t2vg=Vo 
vDS_all-DCM 
(c) Waveforms of vg and vDS in all-DCM 
Fig. 4.8 Waveforms of vg and vDS in all operation modes 
In all-CCM, Fig. 4.8a shows  vDS_all-CCM in a half line cycle. As seen, vDS_all-CCM 
is vDS_ CCM for each switching cycle, and its duty cycle varies in a half line cycle, 
yields 
v Subscript DS norma
l b
ar a
l
l hyphen CCM B
a
sel ine  
l
eft parenthesis
 
t c omma  t Subscri
pt s Baseline right parenthesis equals StartLayout Enlarged left brace 1st Row 1st Column 0 2nd Column t Subscript s Baseline element of left bracket 0 comma upper D Subscript y normal bar CCM Baseline left parenthesis t right parenthesis upper T Subscript s Baseline right bracket 2nd Row 1st Column upper V Subscript o Baseline 2nd Column t Subscript s Baseline element of left parenthesis upper D Subscript y normal bar CCM Baseline left parenthesis t right parenthesis upper T Subscript s Baseline comma upper T Subscript s Baseline right bracket EndLayout left parenthesis 0 less than or equals t less than or equals upper T Subscript line Baseline divided by 2 right parenthesis

60
4
Prediction of the Conducted Electro-magnetic Interference …
In part-CCM/DCM, Fig. 4.8b shows  vDS_part-CCM/DCM in a half line cycle when tb ≥ 
t2vg=Vo. Within [0, t2vg=Vo], [t2vg=Vo, tb] and [tb, T line/4], vDS_part-CCM/DCM is vDS_DCM_b 
, vDS_DCM_a and vDS_CCM for each switching cycle, respectively, and the duty cycle is 
Dy_DCM and Dy_CCM within [0, tb] and [tb, T line/4], respectively. For the case when tb 
< t2vg=Vo, vDS_part-CCM/DCM is vDS_DCM_b within [0, tb], and vDS_DCM_a will not appear. 
The expressions for vDS_part-CCM/DCM is 
v Subscript DS normal bar
 part hyph
en CCM slash 
D
CM  Bas eline lef
t
 parenthesis 
t
 comma t  Sub scri
p
t s Baselin
e ri ght parenthesi s equa
ls vertical b
a
r StartL ayout  1st  Row 1st C olumn v S
u
bscript DS no
r
mal bar DCM normal  bar  b laseli
n
e left parenthesis t Subscript s Baseline right parenthesis 2nd Column left parenthesis 0 less than or equals t less than or equals t Subscript 2 vg equals Vo Baseline right parenthesis 2nd Row 1st Column v Subscript DS normal bar DCM normal bar a Baseline left parenthesis t Subscript s Baseline right parenthesis 2nd Column left parenthesis t Subscript 2 vg equals Vo Baseline less than or equals t less than or equals t Subscript b Baseline right parenthesis 3rd Row 1st Column v Subscript DS normal bar CCM Baseline left parenthesis t Subscript s Baseline right parenthesis 2nd Column left parenthesis t Subscript b Baseline less than or equals t less than or equals upper T Subscript line Baseline divided by 2 minus t Subscript b Baseline right parenthesis 4th Row 1st Column v Subscript DS normal bar DCM normal bar a Baseline left parenthesis t Subscript s Baseline right parenthesis 2nd Column left parenthesis upper T Subscript line Baseline divided by 2 minus t Subscript b Baseline less than or equals t less than or equals upper T Subscript line Baseline divided by 2 minus t Subscript 2 vg equals Vo Baseline right parenthesis 5th Row 1st Column v Subscript DS normal bar DCM normal bar b Baseline left parenthesis t Subscript s Baseline right parenthesis 2nd Column left parenthesis upper T Subscript line Baseline divided by 2 minus t Subscript 2 vg equals Vo Baseline less than or equals t less than or equals upper T Subscript line Baseline divided by 2 right parenthesis EndLayout
In all-DCM, Fig. 4.8c shows  vDS_all-DCM in a half line cycle. Within [0, t2vg=Vo] 
and [t2vg=Vo, T line/4], vDS_all-DCM is vDS_DCM_b and vDS_DCM_a for each switching cycle, 
respectively, and the duty cycle is Dy_DCM within [0, T line/4], yields 
v Subscript DS norma
l bar 
all hyphen DC
M
 B asel ine left 
p
arenthesis t 
c
omma t S ubsc ript s Bas eline rig
h
t parenthesis
 
equals v ertical ba r St artLayout
 
1st Row 1st Column v Subscript DS normal bar DCM normal bar b Baseline left parenthesis t Subscript s Baseline right parenthesis 2nd Column left parenthesis 0 less than or equals t less than or equals t Subscript 2 vg equals Vo Baseline right parenthesis 2nd Row 1st Column v Subscript DS normal bar DCM normal bar a Baseline left parenthesis t Subscript s Baseline right parenthesis 2nd Column left parenthesis t Subscript 2 vg equals Vo Baseline less than or equals t less than or equals upper T Subscript line Baseline divided by 2 minus t Subscript 2 vg equals Vo Baseline right parenthesis 3rd Row 1st Column v Subscript DS normal bar DCM normal bar b Baseline left parenthesis t Subscript s Baseline right parenthesis 2nd Column left parenthesis upper T Subscript line Baseline divided by 2 minus t Subscript 2 vg equals Vo Baseline less than or equals t less than or equals upper T Subscript line Baseline divided by 2 right parenthesis EndLayout
4.3 
Prediction of the Conducted EMI for the Boost PFC 
Converter 
4.3.1 
The Harmonic Amplitude of vDS 
In boost PFC converters, vDS can be treated as the voltage source that generates the 
conducted EMI, and the short-time Fourier transform (STFT) is adopted to calculate 
the harmonic amplitude of vDS in a half line cycle [6]. By treating the waveform in a 
switching period as the window for calculation, the harmonic amplitudes of vDS are 
expressed as 
upper V Sub script DS normal bar k Baseline left parenthesis t right parenthesis equals StartFraction 2 Over upper T Subscript s Baseline EndFraction StartAbsoluteValue integral Subscript 0 Superscript upper T Subscript s Baseline Baseline v Subscript DS Baseline left parenthesis t comma t Subscript s Baseline right parenthesis dot e Superscript minus j Baseline 2 k pi f Super Subscript s Superscript t Super Subscript s Superscript Baseline d t Subscript s Baseline EndAbsoluteValue
up
per V 
Su
b
sc
ript DS normal bar k Baselin
e left
 parenthesis t right parenthesis equals StartFraction 2 Over upper T Subscript s Baseline EndFraction StartAbsoluteValue integral Subscript 0 Superscript upper T Subscript s Baseline Baseline v Subscript DS Baseline left parenthesis t comma t Subscript s Baseline right parenthesis dot e Superscript minus j Baseline 2 k pi f Super Subscript s Superscript t Super Subscript s Superscript Baseline d t Subscript s Baseline EndAbsoluteValue

4.3 Prediction of the Conducted EMI for the Boost PFC Converter
61
where, k is the harmonic order. Since the switching frequency of average-current-
controlled boost PFC converter is constant, the conducted electromagnetic interfer-
ence (EMI) is mainly distributed at the multiples of the switching frequency in the 
spectrum. 
In all-CCM, vDS is vDS_all-CCM within [0, T line/4]. By substituting (4.25) into (4.28), 
the harmonic amplitude of vDS_all-CCM in all-CCM is 
upper V Subs cript DS normal bar k Baseline left parenthesis t right parenthesis equals StartFraction 2 Over upper T Subscript s Baseline EndFraction StartAbsoluteValue integral Subscript 0 Superscript upper T Subscript s Baseline Baseline v Subscript DS normal bar all hyphen CCM Baseline left parenthesis t comma t Subscript s Baseline right parenthesis dot e Superscript minus j Baseline 2 k pi f Super Subscript s Superscript t Super Subscript s Superscript Baseline d t Subscript s Baseline EndAbsoluteValue equals StartFraction 2 upper V Subscript o Baseline Over k pi EndFraction StartAbsoluteValue sine left parenthesis k pi StartFraction v Subscript g Baseline left parenthesis t right parenthesis Over upper V Subscript o Baseline EndFraction right parenthesis EndAbsoluteValue comma left parenthesis all hyphen CCM right parenthesis
up
per V S
ub
s
cr
ipt DS normal bar k Baseline left par
enthesi
s tVright parenthesis equals StartFraction 2 Over upper T Subscript s Baseline EndFraction StartAbsoluteValue integral Subscript 0 Superscript upper T Subscript s Baseline Baseline v Subscript DS normal bar all hyphen CCM Baseline left parenthesis t comma t Subscript s Baseline right parenthesis dot e Superscript minus j Baseline 2 k pi f Super Subscript s Superscript t Super Subscript s Superscript Baseline d t Subscript s Baseline EndAbsoluteValue equals StartFraction 2 upper V Subscript o Baseline Over k pi EndFraction StartAbsoluteValue sine left parenthesis k pi StartFraction v Subscript g Baseline left parenthesis t right parenthesis Over upper V Subscript o Baseline EndFraction right parenthesis EndAbsoluteValue comma left parenthesis all hyphen CCM right parenthesis
up
per V S
u
bscript DS normal bar k Baseline left parenthesis t right parenthesis equals StartFraction 2 Over upper T Subscript s Baseline EndFraction StartAbsoluteValue integral Subscript 0 Superscript upper T Subscript s Baseline Baseline v Subscript DS normal bar all hyphen CCM Baseline left parenthesis t comma t Subscript s Baseline right parenthesis dot e Superscript minus j Baseline 2 k pi f Super Subscript s Superscript t Super Subscript s Superscript Baseline d t Subscript s Baseline EndAbsoluteValue equals StartFraction 2 upper V Subscript o Baseline Over k pi EndFraction StartAbsoluteValue sine left parenthesis k pi StartFraction v Subscript g Baseline left parenthesis t right parenthesis Over upper V Subscript o Baseline EndFraction right parenthesis EndAbsoluteValue comma left parenthesis all hyphen CCM right parenthesis
up
per V 
Subscript DS normal bar k Baseline left parenthesis t right parenthesis equals StartFraction 2 Over upper T Subscript s Baseline EndFraction StartAbsoluteValue integral Subscript 0 Superscript upper T Subscript s Baseline Baseline v Subscript DS normal bar all hyphen CCM Baseline left parenthesis t comma t Subscript s Baseline right parenthesis dot e Superscript minus j Baseline 2 k pi f Super Subscript s Superscript t Super Subscript s Superscript Baseline d t Subscript s Baseline EndAbsoluteValue equals StartFraction 2 upper V Subscript o Baseline Over k pi EndFraction StartAbsoluteValue sine left parenthesis k pi StartFraction v Subscript g Baseline left parenthesis t right parenthesis Over upper V Subscript o Baseline EndFraction right parenthesis EndAbsoluteValue comma left parenthesis all hyphen CCM right parenthesis
Referring to (4.29), in all-CCM, the harmonic amplitude of vDS is only related to 
the input voltage vg and V o, and is irrelevant to the load condition. 
In part-CCM/DCM and all-DCM, the oscillation caused by the boost inductor and 
the power switch junction capacitor affects harmonic amplitude of vDS in a half line 
cycle. Substituting (4.26) and (4.27) into (4.28), the harmonic amplitudes of vDS in 
part-CCM/DCM and all-DCM can be calculated, which are expressed as 
upper V Sub script DS normal bar k Baseline left parenthesis t right parenthesis equals StartFraction 2 Over upper T Subscript s Baseline EndFraction StartAbsoluteValue integral Subscript 0 Superscript upper T Subscript s Baseline Baseline v Subscript DS normal bar part hyphen CCM slash DCM Baseline left parenthesis t comma t Subscript s Baseline right parenthesis dot e Superscript minus j Baseline 2 k pi f Super Subscript s Superscript t Super Subscript s Superscript Baseline d t Subscript s Baseline EndAbsoluteValue comma left parenthesis part hyphen CCM slash DCM right parenthesis
up
per V 
Su
b
sc
ript DS normal bar k Baselin e left parent
hesis 
t
 right parenthe
sis equals StartFraction 2 Over upper T Subscript s Baseline EndFraction StartAbsoluteValue integral Subscript 0 Superscript upper T Subscript s Baseline Baseline v Subscript DS normal bar part hyphen CCM slash DCM Baseline left parenthesis t comma t Subscript s Baseline right parenthesis dot e Superscript minus j Baseline 2 k pi f Super Subscript s Superscript t Super Subscript s Superscript Baseline d t Subscript s Baseline EndAbsoluteValue comma left parenthesis part hyphen CCM slash DCM right parenthesis
upper V Sub script DS normal bar k Baseline left parenthesis t right parenthesis equals StartFraction 2 Over upper T Subscript s Baseline EndFraction StartAbsoluteValue integral Subscript 0 Superscript upper T Subscript s Baseline Baseline v Subscript DS normal bar all hyphen DCM Baseline left parenthesis t comma t Subscript s Baseline right parenthesis dot e Superscript minus j Baseline 2 k pi f Super Subscript s Superscript t Super Subscript s Superscript Baseline d t Subscript s Baseline EndAbsoluteValue comma left parenthesis all hyphen DCM right parenthesis
up
per V 
Su
b
sc
ript DS normal bar k Baseline left pa
renthe
s
is t righ
t parenthesis equals StartFraction 2 Over upper T Subscript s Baseline EndFraction StartAbsoluteValue integral Subscript 0 Superscript upper T Subscript s Baseline Baseline v Subscript DS normal bar all hyphen DCM Baseline left parenthesis t comma t Subscript s Baseline right parenthesis dot e Superscript minus j Baseline 2 k pi f Super Subscript s Superscript t Super Subscript s Superscript Baseline d t Subscript s Baseline EndAbsoluteValue comma left parenthesis all hyphen DCM right parenthesis
In part-CCM/DCM and all-DCM, since Dy_DCM(t) is related to vg, V o and Po, the  
harmonic amplitude of vDS is also related to vg, V o and Po. 
4.3.2 
Characteristics of the Conducted EMI of the Boost 
PFC Converter 
In Chap. 3, it is pointed out that the common-mode (CM) and differential-mode (DM) 
noises V CM_k and V DM_k of the boost PFC converter is related to the spectrum of 
vDS. According to (3.8) and (3.9), V CM_k and V DM_k can be calculated by multiplying 
V DS_k with the CM and DM noise voltage gains |CMTG(kf s)| and |DMTG(kf s)| of 
the boost PFC converter, respectively, expressed as
S
tartLa yout Enla rged left bra ce 1 st Row up per V Su
bscrip t CM norm al bar k Base l
ine equals StartAbsoluteValue CMTG left parenthesis k f Subscript s Baseline right parenthesis EndAbsoluteValue dot upper V Subscript DS normal bar k Baseline equals pi k f Subscript s Baseline upper C Subscript p Baseline upper R Subscript LN Baseline dot upper V Subscript DS normal bar k Baseline 2nd Row upper V Subscript DM normal bar k Baseline equals StartAbsoluteValue DMTG left parenthesis k f Subscript s Baseline right parenthesis EndAbsoluteValue dot upper V Subscript DS normal bar k Baseline equals StartFraction 1 Over 8 pi squared left parenthesis k f Subscript s Baseline right parenthesis squared upper L Subscript b Baseline upper C Subscript x 1 Baseline EndFraction dot upper V Subscript DS normal bar k Baseline EndLayout
StartL ayout Enlar ged left
 brace 1st Row upper V Subscript CM normal bar k Baseline equals StartAbsoluteValue CMTG left parenthesis k f Subscript s Baseline right parenthesis EndAbsoluteValue dot upper V Subscript DS normal bar k Baseline equals pi k f Subscript s Baseline upper C Subscript p Baseline upper R Subscript LN Baseline dot upper V Subscript DS normal bar k Baseline 2nd Row upper V Subscript DM normal bar k Baseline equals StartAbsoluteValue DMTG left parenthesis k f Subscript s Baseline right parenthesis EndAbsoluteValue dot upper V Subscript DS normal bar k Baseline equals StartFraction 1 Over 8 pi squared left parenthesis k f Subscript s Baseline right parenthesis squared upper L Subscript b Baseline upper C Subscript x 1 Baseline EndFraction dot upper V Subscript DS normal bar k Baseline EndLayout

62
4
Prediction of the Conducted Electro-magnetic Interference …
Based on the principle of EMI receiver in Fig. 2.7, the CM and DM noises 
of the boost PFC converter are sent to the equivalent intermediate-frequency (IF) 
ﬁlter. When the center frequency f IF equals to kf s, the IF ﬁlter has unity gain to the 
harmonic, and the envelope signal V CM_k_env (V DM_k_env) equals to V CM_k (V DM_k) 
exactly. Therefore, the peak (PK), quasi-peak (QP) and average (AV) values of the 
CM and DM noise spectrum are related to the time-domain characteristics of V CM_k 
and V DM_k, respectively. According to (4.32), when the main circuit parameters are 
determined, |CMTG(kf s)| and |DMTG(kf s)| do not change over time. Therefore, the 
PK, QP and AV values of the CM and DM noise are expressed as
S
tartLayout Enla rged left brac e 1st Row  upper V 
Subscript CM no r
mal bar k normal bar PK slash QP slash AV Baseline equals pi k f Subscript s Baseline upper C Subscript p Baseline upper R Subscript LN Baseline dot upper V Subscript DS normal bar k bar PK slash QP slash AV Baseline 2nd Row upper V Subscript DM normal bar k normal bar PK slash QP slash AV Baseline equals StartFraction 1 Over 8 pi squared left parenthesis k f Subscript s Baseline right parenthesis squared upper L Subscript b Baseline upper C Subscript x 1 Baseline EndFraction dot upper V Subscript DS normal bar k bar PK slash QP slash AV Baseline EndLayout
StartL ayout Enlar ged left brace 1st
 Row upper V Subscript CM normal bar k normal bar PK slash QP slash AV Baseline equals pi k f Subscript s Baseline upper C Subscript p Baseline upper R Subscript LN Baseline dot upper V Subscript DS normal bar k bar PK slash QP slash AV Baseline 2nd Row upper V Subscript DM normal bar k normal bar PK slash QP slash AV Baseline equals StartFraction 1 Over 8 pi squared left parenthesis k f Subscript s Baseline right parenthesis squared upper L Subscript b Baseline upper C Subscript x 1 Baseline EndFraction dot upper V Subscript DS normal bar k bar PK slash QP slash AV Baseline EndLayout
where, V DS_k_PK/QP/AV is the PK, QP and AV values of V DS_k in a half line cycle. 
V DS_k_PK and V DS_k_AV are given by 
upper V S ubscr
i
pt DS no
r
ma l bar k normal
 bar PK Baseline equals max left brace upper V Subscript DS normal bar k Baseline left parenthesis t right parenthesis right brace t element of left bracket 0 comma upper T Subscript line Baseline divided by 2 right bracket
upper V S ub script DS normal bar k normal bar AV Baseline equals StartFraction 2 Over upper T Subscript line Baseline EndFraction integral Subscript 0 Superscript StartFraction upper T Subscript line Baseline Over 2 EndFraction Baseline upper V Subscript DS normal bar k Baseline left parenthesis t right parenthesis d t
upper 
V Subscript DS normal bar k normal bar AV Baseline equals StartFraction 2 Over upper T Subscript line Baseline EndFraction integral Subscript 0 Superscript StartFraction upper T Subscript line Baseline Over 2 EndFraction Baseline upper V Subscript DS normal bar k Baseline left parenthesis t right parenthesis d t
u
p
pe
r V Subscri
pt DS normal bar k normal bar AV Baseline equals StartFraction 2 Over upper T Subscript line Baseline EndFraction integral Subscript 0 Superscript StartFraction upper T Subscript line Baseline Over 2 EndFraction Baseline upper V Subscript DS normal bar k Baseline left parenthesis t right parenthesis d t
The QP value  V DS_k_QP is usually calculated by numerical method [7], and there 
is no explicit expression for V DS_k_QP. Furthermore, the QP value is quite close to 
the PK value, so the QP value can be approximated by the PK value and it is not 
shown here. 
Based on (4.30), the characteristic of the CM and DM noises of the boost 
PFC converter are related to V DS_k_PK/AV. Since vDS has different waveforms under 
different input voltage and load conditions, the characteristic of V DS_k_PK/AV will be 
analyzed in all-CCM, part-CCM/DCM and all-DCM to predict the conducted EMI 
spectrum of boost PFC converter. 
1. Characteristics of V DS_k_PK/AV in All-CCM 
Based on the harmonic amplitude of vDS in all-CCM in (4.29), V DS_k_CCM reaches 
its maximum when kπvg(t)/V o = π/2. Referring to (4.1), when V in < V o/left parenthesis 2 StartRoot 2 EndRoot right parenthesis
√
left parenthesis 2 StartRoot 2 EndRoot right parenthesis, 
πvg(t)/V o is always less than π/2, so the PK value of the fundamental harmonic 
V DS_1_PK_CCM is always less than 2V o/π; when V o/left parenthesis 2 StartRoot 2 EndRoot right parenthesis
√
left parenthesis 2 StartRoot 2 EndRoot right parenthesis≤ V in ≤ V CCM_max, πvg(t)/ 
V o = π/2 at certain time instant in a half line cycle, and V DS_1_PK_CCM equals to 2V o/ 
π. When k ≥ 2, there always exist kπvg(t)/V o = π/2 at a certain instant in a half line 
cycle, this means

4.3 Prediction of the Conducted EMI for the Boost PFC Converter
63
S
tart
Layo
ut Enlarged l e
ft bra
ce 1st Row upper V Subscript DS normal bar 1 normal bar PK normal bar CCM Baseline equals vertical bar StartLayout 1st Row StartFraction 2 upper V Subscript o Baseline Over pi EndFraction sine left parenthesis pi StartFraction StartRoot 2 EndRoot upper V Subscript in Baseline Over upper V Subscript o Baseline EndFraction right parenthesis comma left parenthesis upper V Subscript in Baseline less than upper V Subscript o Baseline divided by 2 StartRoot 2 EndRoot right parenthesis 2nd Row StartFraction 2 upper V Subscript o Baseline Over pi EndFraction comma left parenthesis upper V Subscript o Baseline divided by 2 StartRoot 2 EndRoot less than or equals upper V Subscript in Baseline less than or equals upper V Subscript CCM normal bar max Baseline right parenthesis EndLayout 2nd Row upper V Subscript DS normal bar k normal bar PK normal bar CCM Baseline equals StartFraction 2 upper V Subscript o Baseline Over k pi EndFraction comma left parenthesis k greater than or equals 2 comma upper V Subscript in Baseline less than or equals upper V Subscript CCM normal bar max Baseline right parenthesis EndLayout
St art
L
ayout Enlarged left brace 1st Row upper V Subscript DS normal bar 1 normal bar PK normal bar CCM Baseline equals vertical bar StartLayout 1st Row StartFraction 2 upper V Subscript o Baseline Over pi EndFraction sine left parenthesis pi StartFraction StartRoot 2 EndRoot upper V Subscript in Baseline Over upper V Subscript o Baseline EndFraction right parenthesis comma left parenthesis upper V Subscript in Baseline less than upper V Subscript o Baseline divided by 2 StartRoot 2 EndRoot right parenthesis 2nd Row StartFraction 2 upper V Subscript o Baseline Over pi EndFraction comma left parenthesis upper V Subscript o Baseline divided by 2 StartRoot 2 EndRoot less than or equals upper V Subscript in Baseline less than or equals upper V Subscript CCM normal bar max Baseline right parenthesis EndLayout 2nd Row upper V Subscript DS normal bar k normal bar PK normal bar CCM Baseline equals StartFraction 2 upper V Subscript o Baseline Over k pi EndFraction comma left parenthesis k greater than or equals 2 comma upper V Subscript in Baseline less than or equals upper V Subscript CCM normal bar max Baseline right parenthesis EndLayout
√
StartLayout Enlarged left brace 1st Row upper V Subscript DS normal bar 1 normal bar PK normal bar CCM Baseline equals vertical bar StartLayout 1st Row StartFraction 2 upper V Subscript o Baseline Over pi EndFraction sine left parenthesis pi StartFraction StartRoot 2 EndRoot upper V Subscript in Baseline Over upper V Subscript o Baseline EndFraction right parenthesis comma left parenthesis upper V Subscript in Baseline less than upper V Subscript o Baseline divided by 2 StartRoot 2 EndRoot right parenthesis 2nd Row StartFraction 2 upper V Subscript o Baseline Over pi EndFraction comma left parenthesis upper V Subscript o Baseline divided by 2 StartRoot 2 EndRoot less than or equals upper V Subscript in Baseline less than or equals upper V Subscript CCM normal bar max Baseline right parenthesis EndLayout 2nd Row upper V Subscript DS normal bar k normal bar PK normal bar CCM Baseline equals StartFraction 2 upper V Subscript o Baseline Over k pi EndFraction comma left parenthesis k greater than or equals 2 comma upper V Subscript in Baseline less than or equals upper V Subscript CCM normal bar max Baseline right parenthesis EndLayout
St
a
r
t
Layo utVonlarged left brace 1st Row upper V Subscript DS normal bar 1 normal bar PK normal bar CCM Baseline equals vertical bar StartLayout 1st Row StartFraction 2 upper V Subscript o Baseline Over pi EndFraction sine left parenthesis pi StartFraction StartRoot 2 EndRoot upper V Subscript in Baseline Over upper V Subscript o Baseline EndFraction right parenthesis comma left parenthesis upper V Subscript in Baseline less than upper V Subscript o Baseline divided by 2 StartRoot 2 EndRoot right parenthesis 2nd Row StartFraction 2 upper V Subscript o Baseline Over pi EndFraction comma left parenthesis upper V Subscript o Baseline divided by 2 StartRoot 2 EndRoot less than or equals upper V Subscript in Baseline less than or equals upper V Subscript CCM normal bar max Baseline right parenthesis EndLayout 2nd Row upper V Subscript DS normal bar k normal bar PK normal bar CCM Baseline equals StartFraction 2 upper V Subscript o Baseline Over k pi EndFraction comma left parenthesis k greater than or equals 2 comma upper V Subscript in Baseline less than or equals upper V Subscript CCM normal bar max Baseline right parenthesis EndLayout
√
S
t
artLayout Enlarged left brace 1st Row upper V Subscript DS normal bar 1 normal bar PK normal bar CCM Baseline equals vertical bar StartLayout 1st Row StartFraction 2 upper V Subscript o Baseline Over pi EndFraction sine left parenthesis pi StartFraction StartRoot 2 EndRoot upper V Subscript in Baseline Over upper V Subscript o Baseline EndFraction right parenthesis comma left parenthesis upper V Subscript in Baseline less than upper V Subscript o Baseline divided by 2 StartRoot 2 EndRoot right parenthesis 2nd Row StartFraction 2 upper V Subscript o Baseline Over pi EndFraction comma left parenthesis upper V Subscript o Baseline divided by 2 StartRoot 2 EndRoot less than or equals upper V Subscript in Baseline less than or equals upper V Subscript CCM normal bar max Baseline right parenthesis EndLayout 2nd Row upper V Subscript DS normal bar k normal bar PK normal bar CCM Baseline equals StartFraction 2 upper V Subscript o Baseline Over k pi EndFraction comma left parenthesis k greater than or equals 2 comma upper V Subscript in Baseline less than or equals upper V Subscript CCM normal bar max Baseline right parenthesis EndLayout
St a
r
tLayout Enlarged left brace 1st Row upper V Subscript DS normal bar 1 normal bar PK normal bar CCM Baseline equals vertical bar StartLayout 1st Row StartFraction 2 upper V Subscript o Baseline Over pi EndFraction sine left parenthesis pi StartFraction StartRoot 2 EndRoot upper V Subscript in Baseline Over upper V Subscript o Baseline EndFraction right parenthesis comma left parenthesis upper V Subscript in Baseline less than upper V Subscript o Baseline divided by 2 StartRoot 2 EndRoot right parenthesis 2nd Row StartFraction 2 upper V Subscript o Baseline Over pi EndFraction comma left parenthesis upper V Subscript o Baseline divided by 2 StartRoot 2 EndRoot less than or equals upper V Subscript in Baseline less than or equals upper V Subscript CCM normal bar max Baseline right parenthesis EndLayout 2nd Row upper V Subscript DS normal bar k normal bar PK normal bar CCM Baseline equals StartFraction 2 upper V Subscript o Baseline Over k pi EndFraction comma left parenthesis k greater than or equals 2 comma upper V Subscript in Baseline less than or equals upper V Subscript CCM normal bar max Baseline right parenthesis EndLayout
√
St artLay out Enlarg
e
d left brace 1s tVRow upper V Subscript DS normal bar 1 normal bar PK normal bar CCM Baseline equals vertical bar StartLayout 1st Row StartFraction 2 upper V Subscript o Baseline Over pi EndFraction sine left parenthesis pi StartFraction StartRoot 2 EndRoot upper V Subscript in Baseline Over upper V Subscript o Baseline EndFraction right parenthesis comma left parenthesis upper V Subscript in Baseline less than upper V Subscript o Baseline divided by 2 StartRoot 2 EndRoot right parenthesis 2nd Row StartFraction 2 upper V Subscript o Baseline Over pi EndFraction comma left parenthesis upper V Subscript o Baseline divided by 2 StartRoot 2 EndRoot less than or equals upper V Subscript in Baseline less than or equals upper V Subscript CCM normal bar max Baseline right parenthesis EndLayout 2nd Row upper V Subscript DS normal bar k normal bar PK normal bar CCM Baseline equals StartFraction 2 upper V Subscript o Baseline Over k pi EndFraction comma left parenthesis k greater than or equals 2 comma upper V Subscript in Baseline less than or equals upper V Subscript CCM normal bar max Baseline right parenthesis EndLayout
Star
t
La yout Enla rged left 
b
race 1st Row upper V Subscript DS normal bar 1 normal bar PK normal bar CCM Baseline equals vertical bar StartLayout 1st Row StartFraction 2 upper V Subscript o Baseline Over pi EndFraction sine left parenthesis pi StartFraction StartRoot 2 EndRoot upper V Subscript in Baseline Over upper V Subscript o Baseline EndFraction right parenthesis comma left parenthesis upper V Subscript in Baseline less than upper V Subscript o Baseline divided by 2 StartRoot 2 EndRoot right parenthesis 2nd Row StartFraction 2 upper V Subscript o Baseline Over pi EndFraction comma left parenthesis upper V Subscript o Baseline divided by 2 StartRoot 2 EndRoot less than or equals upper V Subscript in Baseline less than or equals upper V Subscript CCM normal bar max Baseline right parenthesis EndLayout 2nd Row upper V Subscript DS normal bar k normal bar PK normal bar CCM Baseline equals StartFraction 2 upper V Subscript o Baseline Over k pi EndFraction comma left parenthesis k greater than or equals 2 comma upper V Subscript in Baseline less than or equals upper V Subscript CCM normal bar max Baseline right parenthesis EndLayout
As seen, the maximum of PK values for the kth harmonic amplitude of vDS 
in all-CCM is 2V o/(kπ), and it decays with a slope of − 20 dB/dec against the 
frequency because 2V o/(kπ) is inversely proportional to k. As described in Sect. 3.1.2, 
|CMTG(kf s)| increases with a slope of 20 dB/dec, whereas |DMTG(kf s)| decays with 
a slope of − 40 dB/dec. According to (4.33), in all-CCM, the attenuation slopes 
of the largest PK values of the CM and DM noise are 0 dB/dec and − 60 dB/dec, 
respectively. 
Substituting (4.1) and (4.29) into (4.36), the AV value of the harmonic amplitude 
for vDS in all-CCM are expressed as 
upper V Subsc ri pt DS normal bar k normal bar AV normal bar CCM Baseline equals StartFraction 2 upper V Subscript o Baseline Over k pi squared EndFraction integral Subscript 0 Superscript pi Baseline StartAbsoluteValue sine left parenthesis StartRoot 2 EndRoot pi StartFraction k upper V Subscript in Baseline Over upper V Subscript o Baseline EndFraction sine omega Subscript in Baseline t right parenthesis EndAbsoluteValue d omega Subscript in Baseline t equals StartFraction 2 upper V Subscript o Baseline Over k pi EndFraction upper F Subscript AV Baseline left parenthesis k upper V Subscript in Baseline divided by upper V Subscript o Baseline right parenthesis
upper
 
V
 
Subscri
pt DS normal bar k normal bar AV normal bar CCM Baseline equals StartFraction 2 upper V Subscript o Baseline Over k pi squared EndFraction integral Subscript 0 Superscript pi Baseline StartAbsoluteValue sine left parenthesis StartRoot 2 EndRoot pi StartFraction k upper V Subscript in Baseline Over upper V Subscript o Baseline EndFraction sine omega Subscript in Baseline t right parenthesis EndAbsoluteValue d omega Subscript in Baseline t equals StartFraction 2 upper V Subscript o Baseline Over k pi EndFraction upper F Subscript AV Baseline left parenthesis k upper V Subscript in Baseline divided by upper V Subscript o Baseline right parenthesis√
upper V Subscript DS normal bar k normal bar AV normal bar CCM Baseline equals StartFraction 2 upper V Subscript o Baseline Over k pi squared EndFraction integral Subscript 0 Superscript pi Baseline StartAbsoluteValue sine left parenthesis StartRoot 2 EndRoot pi StartFraction k upper V Subscript in Baseline Over upper V Subscript o Baseline EndFraction sine omega Subscript in Baseline t right parenthesis EndAbsoluteValue d omega Subscript in Baseline t equals StartFraction 2 upper V Subscript o Baseline Over k pi EndFraction upper F Subscript AV Baseline left parenthesis k upper V Subscript in Baseline divided by upper V Subscript o Baseline right parenthesis
up
er V  Sub
scrip t DS n ormal bar k normal bar AV normal bar CCM Baseline equals StartFraction 2 upper V Subscript o Baseline Over k pi squared EndFraction integral Subscript 0 Superscript pi Baseline StartAbsoluteValue sine left parenthesis StartRoot 2 EndRoot pi StartFraction k upper V Subscript in Baseline Over upper V Subscript o Baseline EndFraction sine omega Subscript in Baseline t right parenthesis EndAbsoluteValue d omega Subscript in Baseline t equals StartFraction 2 upper V Subscript o Baseline Over k pi EndFraction upper F Subscript AV Baseline left parenthesis k upper V Subscript in Baseline divided by upper V Subscript o Baseline right parenthesis
upp er V Subscrip
t DS normal bar k normal bar AV normal bar CCM Baseline equals StartFraction 2 upper V Subscript o Baseline Over k pi squared EndFraction integral Subscript 0 Superscript pi Baseline StartAbsoluteValue sine left parenthesis StartRoot 2 EndRoot pi StartFraction k upper V Subscript in Baseline Over upper V Subscript o Baseline EndFraction sine omega Subscript in Baseline t right parenthesis EndAbsoluteValue d omega Subscript in Baseline t equals StartFraction 2 upper V Subscript o Baseline Over k pi EndFraction upper F Subscript AV Baseline left parenthesis k upper V Subscript in Baseline divided by upper V Subscript o Baseline right parenthesis
where, FAV(kV in/V o) is the characteristic function for calculating the AV value, 
expressed as 
upper F Subscri pt AV Baseline left parenthesis k upper V Subscript in Baseline divided by upper V Subscript o Baseline right parenthesis equals StartFraction 1 Over pi EndFraction integral Subscript 0 Superscript pi Baseline StartAbsoluteValue sine left parenthesis StartRoot 2 EndRoot pi StartFraction k upper V Subscript in Baseline Over upper V Subscript o Baseline EndFraction sine omega Subscript in Baseline t right parenthesis EndAbsoluteValue d omega Subscript in Baseline t
up
p
e
r
 F Subs
cript AV Baseline left parenthesis k upper V Subscript in Baseline divided by upper V Subscript o Baseline right parenthesis equals StartFraction 1 Over pi EndFraction integral Subscript 0 Superscript pi Baseline StartAbsoluteValue sine left parenthesis StartRoot 2 EndRoot pi StartFraction k upper V Subscript in Baseline Over upper V Subscript o Baseline EndFraction sine omega Subscript in Baseline t right parenthesis EndAbsoluteValue d omega Subscript in Baseline t√
upper F Subscript AV Baseline left parenthesis k upper V Subscript in Baseline divided by upper V Subscript o Baseline right parenthesis equals StartFraction 1 Over pi EndFraction integral Subscript 0 Superscript pi Baseline StartAbsoluteValue sine left parenthesis StartRoot 2 EndRoot pi StartFraction k upper V Subscript in Baseline Over upper V Subscript o Baseline EndFraction sine omega Subscript in Baseline t right parenthesis EndAbsoluteValue d omega Subscript in Baseline t
up
er F  Sub
scrip t AV 
Baseline left parenthesis k upper V Subscript in Baseline divided by upper V Subscript o Baseline right parenthesis equals StartFraction 1 Over pi EndFraction integral Subscript 0 Superscript pi Baseline StartAbsoluteValue sine left parenthesis StartRoot 2 EndRoot pi StartFraction k upper V Subscript in Baseline Over upper V Subscript o Baseline EndFraction sine omega Subscript in Baseline t right parenthesis EndAbsoluteValue d omega Subscript in Baseline t
According to (4.38), FAV(kV in/V o) is plotted in Fig. 4.9. Table 4.1 lists the local 
maximum of FAV(kV in/V o), and kV in/V o lies in [kV in_min/V o, kV CCM_max/V o]. For the 
kth harmonic, the input voltage for achieving the largest AV value can be found by 
comparing FAV(kV in/V o) at  kV in_min/V o, kV CCM_max/V o and the local maximum in 
[kV in_min/V o, kV CCM_max/V o]. For example, with V in = 90~264 V, V o = 385 V and 
λi = 0.18 in the experiment, V CCM_max is calculated as 245.5 V according to (4.12). 
When k = 1, based on Fig. 4.9 and Table 4.1, V in/V o is within [0.234, 0.637]. When 
kV in/V o = 0.45 (V in = 173 V), FAV(kV in/V o) reaches the local maximum, which is 
the largest AV value for fundamental harmonic of vDS.
According to (4.37), the AV values for each harmonic of vDS under different input 
voltage in all-CCM are depicted in Fig. 4.10. By comparing Figs. 4.9 and 4.10, 
the variation of AV value for the kth harmonic with respect to the input voltage 
V in is identical to the characteristics of the function FAV(kV in/V o) in [kV in_min/V o, 
kV CCM_max/V o]. Furthermore, the largest AV values of the second harmonic appear 
at V in_min = 90 V and that of the third harmonic appear at 3V in/V o = 1.17, i.e., V in 
= 150 V, and so on.
Referring to Fig. 4.9, it is worth noting that the value of FAV(kV in/V o) after  V in_min/ 
V o is always larger than 0.49 (−6.2 dB). Therefore, according to (4.33) and (4.34),

64
4
Prediction of the Conducted Electro-magnetic Interference …
Fig. 4.9 Numerical 
calculated curve of the 
function FAV(kVin/Vo) 
0 
0.3 
0.9 
0.6 
0
4
kVin/Vo 
FAV(kVin/Vo) 
1
2
 3
 
k = 1 
0.49 
Vin_min/Vo 
VCCM_max/Vo 
Table 4.1 Local Maximum of the Function FAV(kVin/Vo) 
kVin/Vo
0.45
1.17
1.87
2.58
3.28
… 
FAV (kVin/Vo)
0.79
0.73
0.71
0.70
0.69
…
Fig. 4.10 Average values of 
|vDS_k(t)| in all-CCM
Vin (V) 
90
150
210
264 
0 
50 
150 
200 
100 
|VDS_k|AV_CCM (V) 
k = 2 
k = 3 
k = 4 
k = 1 
VCCM_max 
the PK values are higher than the AV values by less than 6.2 dB. Recalling that 
in the EN 55022 standard, the QP limit is 10 dB higher than the AV limit for the 
equipments in Class B. As a consequence, the AV values of the boost PFC converter 
under all-CCM are critical for the EMI ﬁlter design, which will be further elaborated 
in Sect. 4.4. 
2. Characteristics of V DS_k_AV in Part-CCM/DCM and All-DCM 
According to (4.30) and (4.31), the expressions of V DS_k_part-CCM/DCM and 
V DS_k_all-DCM are quite complex to be analyzed. Therefore, the numerical method 
is adopted to reveal the characteristics of the conducted EMI in part-CCM/DCM and 
all-DCM.

4.3 Prediction of the Conducted EMI for the Boost PFC Converter
65
According to (4.29), (4.30) and (4.31), the AV values of the fundamental, second, 
and third harmonic amplitudes of vDS are shown in Fig. 4.11, where, the operation 
modes are divided by the dashed lines. The output voltage V o is 385 V, and the 
resonant frequency f r is 4.2f s, which is measured in the experiment. 
In Fig. 4.11a, the AV value for the fundamental harmonic is independent of the 
load condition in all-CCM, and it is the largest when V in/V o = 0.45. Moreover, the 
AV value of V DS_1 in part-CCM/DCM under V in/V o = 0.45 is the largest under all 
working conditions. In all-DCM, V DS_1 is very low under the maximum input voltage 
and the lightest load. Here, 10% load is taken as the lightest load for consideration, 
since the converter may operate in bang-bang mode at light load and its conducted 
EMI can be even lower. As shown in Fig. 4.11b, for the second harmonic, the worst 
case may appear under high V in and low Po in part-CCM/DCM or all-DCM. For the 
third harmonic, the worst case also appears under high V in and low Po in part-CCM/ 
DCM or all-DCM, as shown in Fig. 4.11c.
90
150
210
264 
Vin (V) 
10% 
50% 
75% 
100% 
25% 
190 
170 
196 
Po 
* 
Po_CCM 
* 
Po_DCM 
* 
Vin/Vo = 0.45 
Contour：|VDS_1|AV (V) 
170
110
80
140
200 
90
150
210
264 
Vin (V) 
10% 
50% 
75% 
100% 
25% 
Po 
* 
65 
80 
95 
95 
Po_CCM 
* 
Po_DCM 
* 
Contour：|VDS_2|AV (V) 
70
90
100
80
60 
(a) Fundamental harmonic                                    (b) Second harmonic 
90
150
210
264 
Vin (V) 
10% 
50% 
75% 
100% 
25% 
Po 
* 
60 
50 
70 
Po_DCM 
* 
Po_CCM 
* 
Contour |VDS_3|AV (V) 
52.5
67.5
75
60
45 
(c) Third harmonic 
Fig. 4.11 Average value of |vDS_k| 

66
4
Prediction of the Conducted Electro-magnetic Interference …
Fig. 4.12 Effect of the 
oscillation frequency on the 
conducted EMI 
2
3
4
5
6
7
 
|VDS_k|AV_max (dBμV) 
150 
155 
160 
165 
170 
fr/fs 
k=1 
k=2 
k=3 
k=5 
k=4 
According to (4.29), (4.30), (4.31) and (4.37), the maximum AV value of each 
harmonic amplitude of vDS in a half line cycle can be calculated with different 
resonant frequency f r, as shown in Fig. 4.12. As seen, in the part-CCM/DCM and 
all-DCM, the values around the oscillation frequencies are signiﬁcantly larger than 
that in all-CCM. The fundamental harmonic increases with the decrease of f r, which 
means that the worst case for the fundamental harmonic is that f r is the closest to the 
switching frequency f s. When f r is far higher than f s, the fundamental harmonic is 
scarcely inﬂuenced by the oscillation, but the other harmonics whose frequency is 
close to f r are signiﬁcantly affected. 
In conclusion, for the fundamental harmonic of vDS, the worst case distinctly 
appears in part-CCM/DCM, and largest AV values appear under V in/V o = 0.45 in 
the part-CCM/DCM. For other harmonics, the worst cases are most likely to appear 
in part-CCM/DCM and all-DCM under high input voltage and light-load conditions. 
4.4 
EMI Filter Design for Average-Current-Controlled 
Boost PFC Converter 
The EMI standard such as EN55022 Class B deﬁnes the limit for the QP and AV 
values of the conducted EMI within [150 kHz, 30 MHz]. The AV limit deﬁned in 
EN55022 Class B is 10 dB lower than the QP limit. As discussed in Sect. 4.3.2, the PK 
values of the conducted EMI for average-current-controlled boost PFC converters, 
which are treated as the approximation of the QP values, are higher than AV values 
by no more than 10 dB. As a result, the EMI ﬁlter should be designed based on the 
largest AV values. 
The attenuation requirement for the EMI ﬁlter is equal to the original CM and DM 
noises substracted by the limit, where, the original CM and DM noises are related 
to |CMTG(kf s)|, |DMTG(kf s) and the spectrum of vDS. Referring to Sect. 4.3.2, the

4.4 EMI Filter Design for Average-Current-Controlled Boost PFC Converter
67
Fig. 4.13 Critical harmonics 
for EMI ﬁlter design 
Attenuation requirement (dB) 
fDM
500k
fCM 
<40dB/dec 
IVG of DM filter 
40dB/dec 
fIF 
<–20dB/dec 
Areq_CM 
Areq_DM
IVG of CM filter 
<20dB/dec 
<–40dB/dec 
150k 
Key 
harmonic 
slopes of |CMTG(kf s)| and |DMTG(kf s)| are 20 dB/dec and − 40 dB/dec, respec-
tively. According to (4.32), considering that the harmonics of vDS attenuates with 
the frequency, the attenuation slopes of the CM and DM noise are lower than 20 dB/ 
dec and − 40 dB/dec. Besides, the slopes of the limit within [150 kHz, 500 kHz] 
and [500 kHz, 1 MHz] are − 20 dB/dec and 0 dB/dec, respectively. As a result, the 
slope of the insert voltage gain (IVG) of the CM and DM ﬁlter in Fig. 3.11, which is 
40 dB/dec, is larger than that of the attenuation requirement, as shown in Fig. 4.13. 
Therefore, the ﬁrst harmonic after 150 kHz is the critical harmonic for the EMI ﬁlter 
design. When f s is higher than 150 kHz, the fundamental harmonic is the critical 
harmonic; when f s is within [75 kHz, 150 kHz], the second harmonic is the critical 
harmonic; and so on. 
In addition, as revealed in Sect. 4.3.2, when the oscillation frequency is far higher 
than the switching frequency, the harmonic at the oscillation frequency in the part-
CCM/DCM and all-DCM is signiﬁcantly larger than that in the all-CCM. Considering 
the nonideality of the ﬁlter components at high frequencies, care must be taken 
with the harmonic at the oscillation frequency under light-load condition, when the 
designed ﬁlter is inserted. If it is necessary to suppress the EMI around oscillation 
frequency, methods of canceling the parasitic parameters in the EMI ﬁlter can be 
applied. 
The EMI ﬁlter design for the average-current-controlled boost PFC converter can 
be summarized as follows. 
(1) Predict the largest AV values of the ﬁrst harmonic of the CM and DM noise 
after 150 kHz. If the critical harmonic is the fundamental harmonic, the largest 
AV values can be found in part-CCM/DCM under the condition V in/V o = 0.45. 
If the critical harmonic is the second or third harmonic, the largest AV values 
of the harmonic can be found in part-CCM/DCM or all-DCM under high input 
voltage and light-load conditions. 
(2) Calculate the attenuation requirements for the critical harmonic of the CM and 
DM noise, and design the parameters of the ﬁlter components. 
(3) If the oscillation frequency of boost inductor and the junction capacitor is far 
higher than the switching frequency, it is necessary to check the harmonics 
around the oscillation frequency under light-load condition.

68
4
Prediction of the Conducted Electro-magnetic Interference …
Fig. 4.14 Photograph of the 300-W prototype of the boost PFC converter 
4.5 
Experimental Results 
4.5.1 
Speciﬁcations of the Prototype 
In order to verify the input voltage and load conditions for the worst spectrum of the 
conducted EMI, and design the EMI ﬁlter for the average-current-controlled boost 
PFC converter, a 300-W boost PFC converter prototype, as shown in Fig. 4.14, has 
been fabricated with the following speciﬁcations: 
• Input voltage V in: 90~264 V/50 Hz; 
• Output voltage V o: 385 V; 
• Switching frequency f s: 175 kHz (In order to acquire the fundamental harmonic 
in the conducted EMI, the switching frequency is intentionally designed to be 
higher than 150 kHz); 
• Boost inductor Lb: 580 μH (Lb is designed according to (4.9), where λi = 0.18); 
• Control IC: UC3854 (Unitrode). 
4.5.2 
Experimental Results 
Figure 4.15 gives the waveforms for the input rectiﬁed voltage, inductor current and 
the drain-to-source voltage of the power switch under 220-V input voltage. As seen, 
in a half line cycle, the boost PFC converter is operated in all-CCM, part-CCM/DCM 
and all-DCM under full-load, 20% load and 10% load condition, respectively.
Figure 4.16 shows the waveforms of the inductor current iLb and drain-to-source 
voltage vDS of the power switch at different time intervals under 220-V input voltage 
and 20% load condition. As shown in Fig. 4.16a, when operated in CCM, iLb

4.5 Experimental Results
69
Time: [2ms/div]
vg: [200V/div] 
vDS: [200V/div] 
iLb: [0.5A/div] 
(a) All-CCM (full-load)                      (b) Part-CCM/DCM (20% load) 
(c) All-DCM (10% load) 
Fig. 4.15 Three operating modes of the boost PFC converter with 220-V input voltage
increases and decreases linearly with the power switch turned on and off, respec-
tively. Figure 4.16b gives the waveforms of iLb and vDS in DCM when vg > V o/2. 
As seen, iLb drops linearly with the power switch turned off, and the resonance in 
vDS can be observed when iLb < 0. Furthermore, vDS is always above zero during the 
resonance until the power switch is turned on. Figure 4.16c shows the waveforms of 
iLb and vDS in DCM when vg < V o/2. As seen, there is a certain interval for vDS being 
zero when the power switch is turned off, which veriﬁes the previous analysis.
Figure 4.17 gives the AV values for the original CM and DM noises at 175 kHz 
(the fundamental harmonic), which are both measured under different input and 
load conditions, respectively. In addition, the dashed lines are adopted to divide the 
operation modes. Figure 4.18 shows the PK and AV values of the original CM and 
DM noise measured at 175 kHz. According to Figs. 4.17 and 4.18, the measured 
conducted EMI in all-CCM is independent of load and only related with the input 
voltage, as it is revealed in Sect. 4.2.2. The largest AV values of the CM and DM 
noise at 175 kHz appears in the part-CCM/DCM under 170 and 180 V, which are 
close to V in/V o = 0.45, thus verifying the theoretical analysis.

70
4
Prediction of the Conducted Electro-magnetic Interference …
  
Time: [2μs/div]
vg: [200V/div] 
vDS: [200V/div] 
iLb: [0.5A/div] 
(a) Waveform of vDS_CCM in CCM               (b) Waveform of vDS_DCM_a in DCM 
(c) Related waveform of vDS_DCM_b in DCM 
Fig. 4.16 The related waveforms in part-CCM/DCM
90
150
210
264 
Vin (V) 
10% 
50% 
75% 
100% 
25% 
Po 
* 
Contour |VCM_1|AV (V) 
73.5
76.5
78.0
75.0
72.0 
90
150
210
264 
Vin (V) 
10% 
50% 
75% 
100% 
25% 
Po 
* 
Contour |VDM_1|AV (V) 
98.875
102.225 
103.9
100.550
97.2 
(a) CM noise in AV @175kHz (dBμV)              (b) DM noise in AV @175kHz (dBμV) 
Fig. 4.17 Measured CM and DM values in AV at the fundamental harmonic
Figure 4.19 shows the measured PK and AV values of the original CM and DM 
noises at 350 kHz (the second harmonic). It also shows that the conducted EMI of 
the converter is independent of load and only related with the input voltage in the 
all-CCM, and the worst case of the harmonic appear under the high input voltage and 
light load conditions, which are well in agreement with the analysis in Sects. 4.3.2.

4.5 Experimental Results
71
10%
Vin(V)
90
150
210 
264 
100% 
50% 
75 
80 
CM noise@175kHz (dBμV) 
PK 
AV 
Pin/Pmax
10%
Vin(V)
90
150
210 
264 
100% 
50% 
100 
105 
DM noise@175 kHz (dBμV) 
PK 
AV 
Pin/Pmax 
(a) CM noise                                                      (b) DM noise 
Fig. 4.18 Measured PK and AV values of the fundamental harmonic
10% 
Vin(V)
90
150
210 
264 
100% 
50% 
75 
80 
CM noise@350kHz (dBμV) 
PK 
AV 
Pin/Pmax
10% 
Vin(V)
90
150
210 
264 
100% 
50% 
85 
90 
DM noise@350 kHz (dBμV) 
PK 
AV 
Pin/Pmax 
(a) CM noise                                                       (b) DM noise 
Fig. 4.19 Measured PK and AV values of the second harmonic 
Tables 4.2 and 4.3 give the measured largest PK and AV values for the harmonics 
of CM and DM noise from 150 kHz to 1 MHz and their working conditions. As 
seen, the difference between the PK and AV values is lower than 10 dB. In addition, 
the worst case for the CM and DM noise occurs with the input voltage V in = 170 V 
and load Po = 60 W, and the converter is operated in part-CCM/DCM. Therefore, 
the input voltage condition in the experiment is quite close to satisfy V in/V o = 0.45. 
More speciﬁcally, the maximum AV values for the CM and DM noise at 175 kHz 
are measured as 78.1 dBμV and 103.9 dBμV, respectively. 
Table 4.2 The largest PK and AV of the CM noise harmonics 
Harmonic order k
1
2
3
4
5 
PK
Max. (dBμV)
83.3
83.3
83.6
83.3
82.0 
Vin (V)
160
264
264
264
250 
Pin (W)
60
30
30
30
60 
AV
Max. (dBμV)
78.1
79
78.9
78.4
78.1 
Vin (V)
170
230
240
240
90 
Pin (W)
60
30
30
30
75

72
4
Prediction of the Conducted Electro-magnetic Interference …
Table 4.3 The largest PK and AV of the DM noise harmonics 
Harmonic order k
1
2
3
4
5 
PK
Max. (dBμV)
106.4
91.2
81.3
74.9
69.7 
Vin (V)
170
264
264
220
220 
Pin (W)
195
30
30
45
45 
AV
Max. (dBμV)
103.9
85.9
74.4
66.2
60.8 
Vin (V)
170
230
240
240
90 
Pin (W)
60
30
30
30
60 
In EN55022 standard, the AV limit at 175 kHz is 54.7 dBμV. When calculating 
the attenuation requirement for the EMI ﬁlter, by considering the 6 dB margin, the 
CM and DM noise are required to be attenuated by 29.4 dB and 55.2 dB, respectively. 
An EMI ﬁlter, as shown on the left in Fig. 4.14, is designed based on the attenuation 
requirement of the AV values for the CM and DM noise at 175 kHz. The EMI ﬁlter 
topology is given in Fig. 3.10, where, LCM = 5.6 mH, Cy = 2200 pF, Cx1 = Cx2 = 
2 μF, LDM = 50 μH. 
Figure 4.20 shows the measured CM and DM noise spectra with and without the 
designed EMI ﬁlter under V in = 170 V and Po = 60 W. As seen, their margins are 
6.1 dB and 6.3 dB, respectively.
Figure 4.21 shows the measured CM and DM noise spectra with and without the 
designed EMI ﬁlter under V in = 220 V and full-load working conditions. As seen, 
the calculated AV values are in well agreement with the measured values. The margin 
of the CM and DM noises in Fig. 4.21 is larger than that in Fig. 4.20, which veriﬁes 
that the CM and DM noise spectra measured under V in = 170 V and Po = 60 W are 
the worst spectra.
Referring to the experimental results, if the EMI ﬁlter is designed under the typical 
220-V input voltage and full-load condition, the conducted EMI under V in = 170 
V and Po = 60 W will not satisfy the standard. Therefore, it can be concluded that 
the CM and DM noise spectra under V in = 170 V and Po = 60 W are the worst for 
average-current-controlled boost PFC converter, which concides with the analysis in 
Sect. 4.4.3. 
4.6 
Summary 
In this chapter, the input voltage and load condition for the average-current-controlled 
boost PFC converter operating in all-CCM, part-CCM/DCM, and all-DCM are ﬁrstly 
derived. Based on the STFT and the principle of the EMI receiver, the spectrum of 
the drain-to-source voltage vDS across power switch is predicted for these operation 
modes. The worst case for the fundamental harmonic of vDS appears in part-CCM/ 
DCM under V in/V o = 0.45. For the other harmonics, the worst case is more likely to 
appear in part-CCM/DCM and all-DCM under high input voltage and light-load

4.6 Summary
73
100k
100M 
–30 
30 
90 
CM noise in AV values (dBμV) 
Frequency (Hz) 
1M
10M 
0 
60 
w/o filter
Margin 6.1 dB 
w/ filter 
QPLimit 
AVLimit 
(a) CM noise 
100k
100M 
0 
30 
90 
120 
DM noise in AV values (dBμV) 
Frequency (Hz) 
1M
10M 
–30 
60 
w/ filter 
Margin 6.3 dB 
w/o filter 
QPLimit 
AVLimit 
(b) DM noise 
Fig. 4.20 Measured largest AV spectra at Vin = 170 V and Po = 60 W
conditions. By designing the EMI ﬁlter according to the worst case of the ﬁrst 
harmonic after 150 kHz, the conducted EMI of average-current-controlled boost 
PFC converter can satisfy the limit under all working conditions. Furthermore, the 
approach in this chapter can be also applied for the boost PFC converter operating 
in DCM.

74
4
Prediction of the Conducted Electro-magnetic Interference …
100k
100M 
–30 
30 
90 
Frequency (Hz) 
1M
10M 
0 
60 
CM noise in AV values (dBμV) 
w/o filter
Margin 7.1 dB 
w/ filter 
QPLimit 
AVLimit 
(a) CM noise 
100k
100M 
0 
30 
90 
120 
Frequency (Hz) 
1M
10M
–30 
60 
DM noise in AV values (dBμV) 
w/ filter 
Margin 7 dB 
w/o filter 
QPLimit 
AVLimit 
(b) DM noise 
Fig. 4.21 Measured largest AV spectra under full-load with Vin = 220 V
References 
1. R. Tripathi, S. Das, G. Dubey, Mixed-mode operation of boost switch-mode rectiﬁer for wide 
range of load variations. IEEE Trans. Power Electron. 17(6), 999–1009 (2002) 
2. J.-W. Shin, B.-H. Cho, Digitally implemented average current-mode control in discontinuous 
conduction mode PFC rectiﬁer. IEEE Trans. Power Electron. 27(7), 3363–3373 (2012) 
3. C. Clark, F. Musavi, W. Eberle, Digital DCM detection and mixed conduction mode control for 
boost PFC converters. IEEE Trans. Power Electron. 29(1), 347–355 (2014) 
4. V. Lopez, F. Azcondo, A. Castro, R. Zane, Universal digital controller for boost CCM power 
factor correction stages based on current rebuilding concept. IEEE Trans. Power Electron. 29(7), 
3818–3829 (2014) 
5. C. Silva, UC3854 controlled power factor correction circuit design. Unitrode Corp., Application 
Note U-134 (1999)

References
75
6. J. Allen, Short term spectral analysis, synthesis, and modiﬁcation by discrete Fourier transform. 
IEEE Trans. Acoust. Speech Signal Process. 25(3), 235–238 (1977) 
7. Z. Wang, S. Wang, P. Kong, F.C. Lee, DM EMI noise prediction for constant on-time, critical 
mode power factor correction converters. IEEE Trans. Power Electron. 27(7), 3150–3157 (2012)

Chapter 5 
Prediction of the Conducted 
Electro-magnetic Interference 
for Critical Conduction Mode Boost 
Power Factor Correction Converter 
5.1 
Operation Principle of the CRM Boost PFC Converter 
For the boost power factor correction (PFC) converter operated in critical conduction 
mode (CRM), the switching frequency varies in a half line cycle, and the conducted 
electromagnetic interference (EMI) spectra are quite complicated, resulting in 
difﬁculties for the EMI ﬁlter design. In this chapter, the conducted EMI spectra 
characteristics and EMI ﬁlter design for the CRM boost PFC converter will be 
investigated. 
Figure 5.1 shows the main circuit and control diagram for the CRM boost PFC 
converter, where, D1 ~ D4 constitute the input bridge rectiﬁer; boost inductor Lb, 
power switch Qb, diode Db, and output capacitor Co constitute the boost converter; 
RLd is the load resistor, Cxac and Cxdc are the differential-mode (DM) capacitors for 
eliminating the mixed-mode noise. Similar to the average current control, the CRM 
boost converter includes the output voltage closed-loop and the inductor current 
closed-loop. The output voltage V o is sensed and compared to the reference signal 
V o_ref, and the error signal is sent into the voltage regulator Gv(s). The output of Gv(s) 
is multiplied with the sensed rectiﬁed input voltage, which serves as the peak current 
reference signal. When the inductor current touches the peak current reference, Qb 
is turned off; and when the inductor current drops to zero, the zero-crossing detector 
(ZCD) outputs a high level to turn on Qb.
Figure 5.2 depicts the waveforms of inductor current iLb and the drain-to-source 
voltage of Qb, vDS, in a half line cycle. Obviously, iLb is a triangular waveform in a 
switching period, whose average value is half of its peak value. By keeping the peak 
value of iLb sinusoidal, the average current follows a sinusoidal pattern naturally, and 
the PFC is achieved.
© The Author(s), under exclusive license to Springer Nature Singapore Pte Ltd. 2024 
X. Ruan et al., Conducted Electromagnetic Interference in Power Converters: Modeling, 
Prediction and Reduction, CPSS Power Electronics Series, 
https://doi.org/10.1007/978-981-99-9295-9_5 
77

78
5
Prediction of the Conducted Electro-magnetic Interference for Critical …
Co 
Qb 
Lb
Db 
+ 
– 
L 
N 
vin
Vo 
+ 
– 
iLb 
R 
S
Q 
RLd 
vg 
Hv2 
Gv(s) 
Hv1 
+ 
– 
Hi
ZCD 
+ 
– 
A 
Driver 
Vo_ref 
D1 D2 
D3 D4 
Cxdc 
Cxac 
Fig. 5.1 The CRM boost PFC converter
t
0 
iLb 
0 
vDS 
t 
iLb_peak 
iLb_avg 
Tline/2
Tline/4 
Fig. 5.2 The waveform of inductor current iLb and the drain-to-source voltage vDS 
The rectiﬁed input voltage of the boost PFC converter can be expressed as 
v Subscript g Baseline left parenthesis t right parenthesis equals StartAbsoluteValue v Subscript in Baseline left parenthesis t right parenthesis EndAbsoluteValue equals StartRoot 2 EndRoot upper V Subscript in Baseline StartAbsoluteValue sine omega Subscript in Baseline t EndAbsoluteValue
√
vVSubscri pt g 
Baseline left parenthesis t right parenthesis equals StartAbsoluteValue v Subscript in Baseline left parenthesis t right parenthesis EndAbsoluteValue equals StartRoot 2 EndRoot upper V Subscript in Baseline StartAbsoluteValue sine omega Subscript in Baseline t EndAbsoluteValue
where, vin is the input voltage, V in is the root-mean-square value of the input voltage, 
and ωin is the angular frequency of the input voltage. 
Under CRM, the duty cycle Dy of the power switch is given by 
upper D Su bscript y Baseline left parenthesis t right parenthesis equals 1 minus StartFraction v Subscript g Baseline left parenthesis t right parenthesis Over upper V Subscript o Baseline EndFraction equals 1 minus StartFraction StartRoot 2 EndRoot upper V Subscript in Baseline StartAbsoluteValue sine omega Subscript in Baseline t EndAbsoluteValue Over upper V Subscript o Baseline EndFraction
up
er D  Subscript y Baseline left parenthesis t right parenthesis equals 1 minus StartFraction v Subscript g Baseline left parenthesis t right parenthesis Over upper V Subscript o Baseline EndFraction equals 1 minus StartFraction StartRoot 2 EndRoot upper V Subscript in Baseline StartAbsoluteValue sine omega Subscript in Baseline t EndAbsoluteValue Over upper V Subscript o Baseline EndFraction
√
upper D S ubscript y Baseline left parenthesis t right parenthesis equals 1 minus StartFraction v Subscript g Baseline left parenthesis t right parenthesis Over upper V Subscript o Baseline EndFraction equals 1 minus StartFraction StartRoot 2 EndRoot upper V Subscript in Baseline StartAbsoluteValue sine omega Subscript in Baseline t EndAbsoluteValue Over upper V Subscript o Baseline EndFraction
up
er D Subscript y Baseline left parenthesis t right parenthesis equals 1 minus StartFraction v Subscript g Baseline left parenthesis t right parenthesis Over upper V Subscript o Baseline EndFraction equals 1 minus StartFraction StartRoot 2 EndRoot upper V Subscript in Baseline StartAbsoluteValue sine omega Subscript in Baseline t EndAbsoluteValue Over upper V Subscript o Baseline EndFraction
When Qb is conducting, vg is applied on the inductor, forcing iLb to increase 
linearly, and the peak value of iLb is

5.2 Conducted EMI Spectra of the CRM Boost PFC Converter
79
i Subscript upper L b normal bar peak Baseline left parenthesis t right parenthesis equals StartFraction v Subscript g Baseline left parenthesis t right parenthesis Over upper L Subscript b Baseline EndFraction upper D Subscript y Baseline left parenthesis t right parenthesis upper T Subscript s Baseline left parenthesis t right parenthesis equals StartFraction v Subscript g Baseline left parenthesis t right parenthesis upper D Subscript y Baseline left parenthesis t right parenthesis Over upper L Subscript b Baseline f Subscript s Baseline left parenthesis t right parenthesis EndFraction
i S
ubscript upper L b normal bar peak Baseline left parenthesis t right parenthesis equals StartFraction v Subscript g Baseline left parenthesis t right parenthesis Over upper L Subscript b Baseline EndFraction upper D Subscript y Baseline left parenthesis t right parenthesis upper T Subscript s Baseline left parenthesis t right parenthesis equals StartFraction v Subscript g Baseline left parenthesis t right parenthesis upper D Subscript y Baseline left parenthesis t right parenthesis Over upper L Subscript b Baseline f Subscript s Baseline left parenthesis t right parenthesis EndFraction
i S ubscri
pt upper L b normal bar peak Baseline left parenthesis t right parenthesis equals StartFraction v Subscript g Baseline left parenthesis t right parenthesis Over upper L Subscript b Baseline EndFraction upper D Subscript y Baseline left parenthesis t right parenthesis upper T Subscript s Baseline left parenthesis t right parenthesis equals StartFraction v Subscript g Baseline left parenthesis t right parenthesis upper D Subscript y Baseline left parenthesis t right parenthesis Over upper L Subscript b Baseline f Subscript s Baseline left parenthesis t right parenthesis EndFraction
where, T s is the switching period, and f s is the switching frequency. 
According to (5.3), the average inductor current in a switching cycle is 
i Subscript uper L b normal bar avg Baseline left parenthesis t right parenthesis equals one half i Subscript upper L b normal bar peak Baseline left parenthesis t right parenthesis equals StartFraction v Subscript g Baseline left parenthesis t right parenthesis upper D Subscript y Baseline left parenthesis t right parenthesis Over 2 upper L Subscript b Baseline f Subscript s Baseline left parenthesis t right parenthesis EndFraction
i Subscript upper L b normal bar avg Baseline left parenthesis t right parenthesis equals one half i Subscript upper L b normal bar peak Baseline left parenthesis t right parenthesis equals StartFraction v Subscript g Baseline left parenthesis t right parenthesis upper D Subscript y Baseline left parenthesis t right parenthesis Over 2 upper L Subscript b Baseline f Subscript s Baseline left parenthesis t right parenthesis EndFraction
i Su bscrip
t upper L b normal bar avg Baseline left parenthesis t right parenthesis equals one half i Subscript upper L b normal bar peak Baseline left parenthesis t right parenthesis equals StartFraction v Subscript g Baseline left parenthesis t right parenthesis upper D Subscript y Baseline left parenthesis t right parenthesis Over 2 upper L Subscript b Baseline f Subscript s Baseline left parenthesis t right parenthesis EndFraction
Since the power factor (PF) equals to 1, iLb_avg(t) can be also expressed as 
i Subscript upper L b normal bar avg Baseline left parenthesis t right parenthesis equals StartRoot 2 EndRoot StartFraction upper P Subscript o Baseline Over upper V Subscript in Baseline EndFraction StartAbsoluteValue sine omega Subscript in Baseline t EndAbsoluteValue equals StartFraction upper P Subscript o Baseline Over upper V Subscript in Superscript 2 Baseline EndFraction v Subscript g Baseline left parenthesis t right parenthesis
√
i Subscript upper L b normal bar avg Baseline left parenthesis t right parenthesis equals StartRoot 2 EndRoot StartFraction upper P Subscript o Baseline Over upper V Subscript in Baseline EndFraction StartAbsoluteValue sine omega Subscript in Baseline t EndAbsoluteValue equals StartFraction upper P Subscript o Baseline Over upper V Subscript in Superscript 2 Baseline EndFraction v Subscript g Baseline left parenthesis t right parenthesis
i Su
bscri pt upper  L b normal bar avg Baseline left parenthesis t right parenthesis equals StartRoot 2 EndRoot StartFraction upper P Subscript o Baseline Over upper V Subscript in Baseline EndFraction StartAbsoluteValue sine omega Subscript in Baseline t EndAbsoluteValue equals StartFraction upper P Subscript o Baseline Over upper V Subscript in Superscript 2 Baseline EndFraction v Subscript g Baseline left parenthesis t right parenthesis
i Su
bsc
ript 
upper L b normal bar avg Baseline left parenthesis t right parenthesis equals StartRoot 2 EndRoot StartFraction upper P Subscript o Baseline Over upper V Subscript in Baseline EndFraction StartAbsoluteValue sine omega Subscript in Baseline t EndAbsoluteValue equals StartFraction upper P Subscript o Baseline Over upper V Subscript in Superscript 2 Baseline EndFraction v Subscript g Baseline left parenthesis t right parenthesis
where, Po is the output power. 
According to (5.1), (5.2), (5.4) and (5.5), the switching frequency f s for the CRM 
boost PFC converter is derived as 
f Subscript s Baseline left parenthesis t right parenthesis equals one half StartFraction upper V Subscript in Superscript 2 Baseline Over upper P Subscript o Baseline upper L Subscript b Baseline EndFraction upper D Subscript y Baseline left parenthesis t right parenthesis equals one half StartFraction upper V Subscript in Superscript 2 Baseline Over upper P Subscript o Baseline upper L Subscript b Baseline EndFraction left parenthesis 1 minus StartFraction StartRoot 2 EndRoot upper V Subscript in Baseline StartAbsoluteValue sine omega Subscript in Baseline t EndAbsoluteValue Over upper V Subscript o Baseline EndFraction right parenthesis
f 
Su bs
cript s Baseline left parenthesis t right parenthesis equals one half StartFraction upper V Subscript in Superscript 2 Baseline Over upper P Subscript o Baseline upper L Subscript b Baseline EndFraction upper D Subscript y Baseline left parenthesis t right parenthesis equals one half StartFraction upper V Subscript in Superscript 2 Baseline Over upper P Subscript o Baseline upper L Subscript b Baseline EndFraction left parenthesis 1 minus StartFraction StartRoot 2 EndRoot upper V Subscript in Baseline StartAbsoluteValue sine omega Subscript in Baseline t EndAbsoluteValue Over upper V Subscript o Baseline EndFraction right parenthesis
f Sub
script s Baseline left parenthesis t right parenthesis equals one half StartFraction upper V Subscript in Superscript 2 Baseline Over upper P Subscript o Baseline upper L Subscript b Baseline EndFraction upper D Subscript y Baseline left parenthesis t right parenthesis equals one half StartFraction upper V Subscript in Superscript 2 Baseline Over upper P Subscript o Baseline upper L Subscript b Baseline EndFraction left parenthesis 1 minus StartFraction StartRoot 2 EndRoot upper V Subscript in Baseline StartAbsoluteValue sine omega Subscript in Baseline t EndAbsoluteValue Over upper V Subscript o Baseline EndFraction right parenthesis
f 
Su bs
cript s Baseline left parenthesis t right parenthesis equals one half StartFraction upper V Subscript in Superscript 2 Baseline Over upper P Subscript o Baseline upper L Subscript b Baseline EndFraction upper D Subscript y Baseline left parenthesis t right parenthesis equals one half StartFraction upper V Subscript in Superscript 2 Baseline Over upper P Subscript o Baseline upper L Subscript b Baseline EndFraction left parenthesis 1 minus StartFraction StartRoot 2 EndRoot upper V Subscript in Baseline StartAbsoluteValue sine omega Subscript in Baseline t EndAbsoluteValue Over upper V Subscript o Baseline EndFraction right parenthesis
f Su
b
sc ript s Baseline left parenthesis t right parenthesis equals one half StartFraction upper V Subscript in Superscript 2 Baseline Over upper P Subscript o Baseline upper L Subscript b Baseline EndFraction upper D Subscript y Baseline left parenthesis t right parenthesis equals one half StartFraction upper V Subscript in Superscript 2 Baseline Over upper P Subscript o Baseline upper L Subscript b Baseline EndFraction left parenthesis 1 minus StartFraction StartRoot 2 EndRoot upper V Subscript in Baseline StartAbsoluteValue sine omega Subscript in Baseline t EndAbsoluteValue Over upper V Subscript o Baseline EndFraction right parenthesis
√
fVSubscri pt s Baseline left parenthesis t right parenthesis equals one half StartFraction upper V Subscript in Superscript 2 Baseline Over upper P Subscript o Baseline upper L Subscript b Baseline EndFraction upper D Subscript y Baseline left parenthesis t right parenthesis equals one half StartFraction upper V Subscript in Superscript 2 Baseline Over upper P Subscript o Baseline upper L Subscript b Baseline EndFraction left parenthesis 1 minus StartFraction StartRoot 2 EndRoot upper V Subscript in Baseline StartAbsoluteValue sine omega Subscript in Baseline t EndAbsoluteValue Over upper V Subscript o Baseline EndFraction right parenthesis
f 
S
ubscript s Baseline left parenthesis t right parenthesis equals one half StartFraction upper V Subscript in Superscript 2 Baseline Over upper P Subscript o Baseline upper L Subscript b Baseline EndFraction upper D Subscript y Baseline left parenthesis t right parenthesis equals one half StartFraction upper V Subscript in Superscript 2 Baseline Over upper P Subscript o Baseline upper L Subscript b Baseline EndFraction left parenthesis 1 minus StartFraction StartRoot 2 EndRoot upper V Subscript in Baseline StartAbsoluteValue sine omega Subscript in Baseline t EndAbsoluteValue Over upper V Subscript o Baseline EndFraction right parenthesis
According to (5.6), the minimum and maximum switching frequencies in a half 
line cycle appear when |sinωint| equals to 1 and 0, respectively, expressed as 
f Subsc ript s normal bar min Baseline equals one half StartFraction upper V Subscript in Superscript 2 Baseline Over upper P Subscript o Baseline upper L Subscript b Baseline EndFraction left parenthesis 1 minus StartFraction StartRoot 2 EndRoot upper V Subscript in Baseline Over upper V Subscript o Baseline EndFraction right parenthesis
f 
Su bs
cript s normal bar min Baseline equals one half StartFraction upper V Subscript in Superscript 2 Baseline Over upper P Subscript o Baseline upper L Subscript b Baseline EndFraction left parenthesis 1 minus StartFraction StartRoot 2 EndRoot upper V Subscript in Baseline Over upper V Subscript o Baseline EndFraction right parenthesis
f Su
b
sc ript s normal bar min Baseline equals one half StartFraction upper V Subscript in Superscript 2 Baseline Over upper P Subscript o Baseline upper L Subscript b Baseline EndFraction left parenthesis 1 minus StartFraction StartRoot 2 EndRoot upper V Subscript in Baseline Over upper V Subscript o Baseline EndFraction right parenthesis
√
fVSubscript s normal bar min Baseline equals one half StartFraction upper V Subscript in Superscript 2 Baseline Over upper P Subscript o Baseline upper L Subscript b Baseline EndFraction left parenthesis 1 minus StartFraction StartRoot 2 EndRoot upper V Subscript in Baseline Over upper V Subscript o Baseline EndFraction right parenthesis
f 
S
ubscript s normal bar min Baseline equals one half StartFraction upper V Subscript in Superscript 2 Baseline Over upper P Subscript o Baseline upper L Subscript b Baseline EndFraction left parenthesis 1 minus StartFraction StartRoot 2 EndRoot upper V Subscript in Baseline Over upper V Subscript o Baseline EndFraction right parenthesis
f Subsc ript s normal bar max Baseline equals one half StartFraction upper V Subscript in Superscript 2 Baseline Over upper P Subscript o Baseline upper L Subscript b Baseline EndFraction
f 
Su bs
cript s normal bar max Baseline equals one half StartFraction upper V Subscript in Superscript 2 Baseline Over upper P Subscript o Baseline upper L Subscript b Baseline EndFraction
f Sub
script s normal bar max Baseline equals one half StartFraction upper V Subscript in Superscript 2 Baseline Over upper P Subscript o Baseline upper L Subscript b Baseline EndFraction
5.2 
Conducted EMI Spectra of the CRM Boost PFC 
Converter 
5.2.1 
Harmonic Spectrum of vDS 
The drain-to-source voltage of Qb, vDS, can be treated as the noise voltage source 
of the conducted EMI in boost PFC converter. As both Dy and f s change in a half 
line cycle [1–4], the short-time Fourier transform (STFT) is adopted to analyze the 
spectrum of vDS.

80
5
Prediction of the Conducted Electro-magnetic Interference for Critical …
By applying the STFT to vDS in a switching period, the magnitude for the kth (k 
= 1, 2, 3, …) harmonic with the fundamental frequency of f s(t), denoted as V DS_k(t), 
is expressed as 
upper V Su
bscript
 DS normal bar k Baseline left parenthesis t right parenthesis equals StartAbsoluteValue StartFraction 1 Over upper T Subscript s Baseline EndFraction integral Subscript upper D Subscript y Baseline left parenthesis t right parenthesis upper T Subscript s Baseline Superscript upper T Subscript s Baseline Baseline upper V Subscript o Baseline e Superscript minus j Baseline 2 k pi StartFraction t Super Subscript s Superscript Over upper T Super Subscript s Superscript EndFraction Baseline d t Subscript s Baseline EndAbsoluteValue equals StartFraction 2 upper V Subscript o Baseline Over k pi EndFraction StartAbsoluteValue sine left parenthesis k pi upper D Subscript y Baseline left parenthesis t right parenthesis right parenthesis EndAbsoluteValue comma left parenthesis 0 less than or equals t less than or equals StartFraction upper T Subscript line Baseline Over 2 EndFraction right parenthesis
up
er
 
V Subscr
ipt DS normal bar k Baseline left parenthesis t right parenthesis equals StartAbsoluteValue StartFraction 1 Over upper T Subscript s Baseline EndFraction integral Subscript upper D Subscript y Baseline left parenthesis t right parenthesis upper T Subscript s Baseline Superscript upper T Subscript s Baseline Baseline upper V Subscript o Baseline e Superscript minus j Baseline 2 k pi StartFraction t Super Subscript s Superscript Over upper T Super Subscript s Superscript EndFraction Baseline d t Subscript s Baseline EndAbsoluteValue equals StartFraction 2 upper V Subscript o Baseline Over k pi EndFraction StartAbsoluteValue sine left parenthesis k pi upper D Subscript y Baseline left parenthesis t right parenthesis right parenthesis EndAbsoluteValue comma left parenthesis 0 less than or equals t less than or equals StartFraction upper T Subscript line Baseline Over 2 EndFraction right parenthesis
up er 
V Subsc
ript DS normal bar k Baseline left parenthesis t right parenthesis equals StartAbsoluteValue StartFraction 1 Over upper T Subscript s Baseline EndFraction integral Subscript upper D Subscript y Baseline left parenthesis t right parenthesis upper T Subscript s Baseline Superscript upper T Subscript s Baseline Baseline upper V Subscript o Baseline e Superscript minus j Baseline 2 k pi StartFraction t Super Subscript s Superscript Over upper T Super Subscript s Superscript EndFraction Baseline d t Subscript s Baseline EndAbsoluteValue equals StartFraction 2 upper V Subscript o Baseline Over k pi EndFraction StartAbsoluteValue sine left parenthesis k pi upper D Subscript y Baseline left parenthesis t right parenthesis right parenthesis EndAbsoluteValue comma left parenthesis 0 less than or equals t less than or equals StartFraction upper T Subscript line Baseline Over 2 EndFraction right parenthesis
up
per V
 
Subscrip
t DS
 
no rmal  bar k Baseline left parenthesis t right parenthesis equals StartAbsoluteValue StartFraction 1 Over upper T Subscript s Baseline EndFraction integral Subscript upper D Subscript y Baseline left parenthesis t right parenthesis upper T Subscript s Baseline Superscript upper T Subscript s Baseline Baseline upper V Subscript o Baseline e Superscript minus j Baseline 2 k pi StartFraction t Super Subscript s Superscript Over upper T Super Subscript s Superscript EndFraction Baseline d t Subscript s Baseline EndAbsoluteValue equals StartFraction 2 upper V Subscript o Baseline Over k pi EndFraction StartAbsoluteValue sine left parenthesis k pi upper D Subscript y Baseline left parenthesis t right parenthesis right parenthesis EndAbsoluteValue comma left parenthesis 0 less than or equals t less than or equals StartFraction upper T Subscript line Baseline Over 2 EndFraction right parenthesis
u
p
per V Subscript DS normal bar k Baseline left parenthesis t right parenthesis equals StartAbsoluteValue StartFraction 1 Over upper T Subscript s Baseline EndFraction integral Subscript upper D Subscript y Baseline left parenthesis t right parenthesis upper T Subscript s Baseline Superscript upper T Subscript s Baseline Baseline upper V Subscript o Baseline e Superscript minus j Baseline 2 k pi StartFraction t Super Subscript s Superscript Over upper T Super Subscript s Superscript EndFraction Baseline d t Subscript s Baseline EndAbsoluteValue equals StartFraction 2 upper V Subscript o Baseline Over k pi EndFraction StartAbsoluteValue sine left parenthesis k pi upper D Subscript y Baseline left parenthesis t right parenthesis right parenthesis EndAbsoluteValue comma left parenthesis 0 less than or equals t less than or equals StartFraction upper T Subscript line Baseline Over 2 EndFraction right parenthesis
According to (5.6) and (5.8), we have Dy(t) = f s/f s_max. By substituting it into 
(5.9), the harmonic spectrum V DS_k(kf s) of  vDS at the harmonic frequency of kf s is 
derived as 
upper V  Subscript DS normal bar k Baseline left parenthesis k f Subscript s Baseline right parenthesis equals StartFraction 2 upper V Subscript o Baseline Over k pi EndFraction StartAbsoluteValue sine left parenthesis k pi StartFraction f Subscript s Baseline Over f Subscript s normal bar max Baseline EndFraction right parenthesis EndAbsoluteValue
up
per V S
u
bsc
ript DS normal bar k Baseline left parenthesis k f Subscript s Baseline right parenthesis equals StartFraction 2 upper V Subscript o Baseline Over k pi EndFraction StartAbsoluteValue sine left parenthesis k pi StartFraction f Subscript s Baseline Over f Subscript s normal bar max Baseline EndFraction right parenthesis EndAbsoluteValue
upper 
V Sub
script DS normal bar k Baseline left parenthesis k f Subscript s Baseline right parenthesis equals StartFraction 2 upper V Subscript o Baseline Over k pi EndFraction StartAbsoluteValue sine left parenthesis k pi StartFraction f Subscript s Baseline Over f Subscript s normal bar max Baseline EndFraction right parenthesis EndAbsoluteValue
According to (5.9), V DS_k(t) within [0, T line/2] is shown in Fig. 5.3a. As seen, all 
these curves are symmetrical to T line/4. According to (5.10), V DS_k(kf s) is depicted, 
as shown in Fig. 5.3b. The spectrum characteristics of vDS are summarized below: 
(1) For each harmonic, V DS_k(kf s) is distributed within [kf s_min, kf s_max], and 
V DS_k(kf s_max) is always equal to zero. 
(2) Within [ f s_min, f s_max], the amplitude of the fundamental harmonic is larger 
than that of other harmonics, as highlighted in Fig. 5.3b; Within [(k − 1)f s_max, 
kf s_max] (k ≥ 2), the amplitude of the kth harmonic is the largest.
1st 
2nd 
3rd 
kth 
t
0 
Tline/2
Tline/4 
VDS_k(t) 
0 
20logVD S _k(kfs) 
fs_min 
fs_max 
2fs_max 
kfs_max 
kfs
2fs_min 
3fs_min 
3fs_max 
kfs_min 
kt h  
1s t  
2n d  
3r d  
(a) The harmonic amplitude of VDS_k(t)                             (b) The spectrum of VDS_k(kfs) 
Fig. 5.3 The harmonic amplitude of VDS_k(t) and the spectrum of VDS_k(kf s) 

5.2 Conducted EMI Spectra of the CRM Boost PFC Converter
81
5.2.2 
Harmonic Spectra of the CM and DM Noise Voltages 
As described in Chap. 3, the harmonic spectra of the common-mode (CM) and DM 
noise, V CM_k and V DM_k, equal to the harmonic spectrum V DS_k(kf s) of  vDS multiplied 
by the CM and DM voltage transfer gain |CMTG(kf s)| and |DMTG(kf s)|, respectively, 
i.e.,
S
tartLa yout Enla rged left brac e 1st Ro w uper V  Subscrip t CM
Vnorma l bar k B aselineVequals  Star
tAbsoluteValue CMTG left parenthesis k f Subscript s Baseline right parenthesis EndAbsoluteValue dot upper V Subscript DS normal bar k Baseline left parenthesis k f Subscript s Baseline right parenthesis equals pi k f Subscript s Baseline upper C Subscript p Baseline upper R Subscript LN Baseline dot upper V Subscript DS normal bar k Baseline left parenthesis k f Subscript s Baseline right parenthesis 2nd Row upper V Subscript DM normal bar k Baseline equals StartAbsoluteValue DMTG left parenthesis k f Subscript s Baseline right parenthesis EndAbsoluteValue dot upper V Subscript DS normal bar k Baseline left parenthesis k f Subscript s Baseline right parenthesis equals StartFraction 1 Over 8 pi squared left parenthesis k f Subscript s Baseline right parenthesis squared upper L Subscript b Baseline upper C Subscript x 1 Baseline EndFraction dot upper V Subscript DS normal bar k Baseline left parenthesis k f Subscript s Baseline right parenthesis EndLayout
StartL ayout Enlar ged left brac
e 1st Row upper V Subscript CM normal bar k Baseline equals StartAbsoluteValue CMTG left parenthesis k f Subscript s Baseline right parenthesis EndAbsoluteValue dot upper V Subscript DS normal bar k Baseline left parenthesis k f Subscript s Baseline right parenthesis equals pi k f Subscript s Baseline upper C Subscript p Baseline upper R Subscript LN Baseline dot upper V Subscript DS normal bar k Baseline left parenthesis k f Subscript s Baseline right parenthesis 2nd Row upper V Subscript DM normal bar k Baseline equals StartAbsoluteValue DMTG left parenthesis k f Subscript s Baseline right parenthesis EndAbsoluteValue dot upper V Subscript DS normal bar k Baseline left parenthesis k f Subscript s Baseline right parenthesis equals StartFraction 1 Over 8 pi squared left parenthesis k f Subscript s Baseline right parenthesis squared upper L Subscript b Baseline upper C Subscript x 1 Baseline EndFraction dot upper V Subscript DS normal bar k Baseline left parenthesis k f Subscript s Baseline right parenthesis EndLayout
Substituting (5.10) into (5.11), leads to 
S
ta
rt
Layout  Enlar ged left
 brace
 
1s
t Row upper V Subscript CM normal bar k Baseline equals 2 upper V Subscript o Baseline f Subscript s Baseline upper C Subscript p Baseline upper R Subscript LN Baseline StartAbsoluteValue sine left parenthesis k pi StartFraction f Subscript s Baseline Over f Subscript s normal bar max Baseline EndFraction right parenthesis EndAbsoluteValue 2nd Row upper V Subscript DM normal bar k Baseline equals StartFraction upper V Subscript o Baseline Over 4 k cubed pi cubed f Subscript s Superscript 2 Baseline upper L Subscript b Baseline upper C Subscript x 1 Baseline EndFraction StartAbsoluteValue sine left parenthesis k pi StartFraction f Subscript s Baseline Over f Subscript s normal bar max Baseline EndFraction right parenthesis EndAbsoluteValue EndLayout
StartL
ayou
t Enla r
ged left brace 1st Row upper V Subscript CM normal bar k Baseline equals 2 upper V Subscript o Baseline f Subscript s Baseline upper C Subscript p Baseline upper R Subscript LN Baseline StartAbsoluteValue sine left parenthesis k pi StartFraction f Subscript s Baseline Over f Subscript s normal bar max Baseline EndFraction right parenthesis EndAbsoluteValue 2nd Row upper V Subscript DM normal bar k Baseline equals StartFraction upper V Subscript o Baseline Over 4 k cubed pi cubed f Subscript s Superscript 2 Baseline upper L Subscript b Baseline upper C Subscript x 1 Baseline EndFraction StartAbsoluteValue sine left parenthesis k pi StartFraction f Subscript s Baseline Over f Subscript s normal bar max Baseline EndFraction right parenthesis EndAbsoluteValue EndLayout
StartLa yo ut E nlarg
ed lef
t
 b
race 1st Row upper V Subscript CM normal bar k Baseline equals 2 upper V Subscript o Baseline f Subscript s Baseline upper C Subscript p Baseline upper R Subscript LN Baseline StartAbsoluteValue sine left parenthesis k pi StartFraction f Subscript s Baseline Over f Subscript s normal bar max Baseline EndFraction right parenthesis EndAbsoluteValue 2nd Row upper V Subscript DM normal bar k Baseline equals StartFraction upper V Subscript o Baseline Over 4 k cubed pi cubed f Subscript s Superscript 2 Baseline upper L Subscript b Baseline upper C Subscript x 1 Baseline EndFraction StartAbsoluteValue sine left parenthesis k pi StartFraction f Subscript s Baseline Over f Subscript s normal bar max Baseline EndFraction right parenthesis EndAbsoluteValue EndLayout
Star tLa
yout
 Enlarged left brace 1st Row upper V Subscript CM normal bar k Baseline equals 2 upper V Subscript o Baseline f Subscript s Baseline upper C Subscript p Baseline upper R Subscript LN Baseline StartAbsoluteValue sine left parenthesis k pi StartFraction f Subscript s Baseline Over f Subscript s normal bar max Baseline EndFraction right parenthesis EndAbsoluteValue 2nd Row upper V Subscript DM normal bar k Baseline equals StartFraction upper V Subscript o Baseline Over 4 k cubed pi cubed f Subscript s Superscript 2 Baseline upper L Subscript b Baseline upper C Subscript x 1 Baseline EndFraction StartAbsoluteValue sine left parenthesis k pi StartFraction f Subscript s Baseline Over f Subscript s normal bar max Baseline EndFraction right parenthesis EndAbsoluteValue EndLayout
According to (5.12), the harmonic spectra of V CM_k and V DM_k can be depicted 
in logarithmic scale, as shown in Fig. 5.4. Similar to the spectrum characteristics of 
vDS, V CM_k(kf s_max) and V DM_k(kf s_max) are equal to 0; within [ f s_min, f s_max], V CM_1 
and V DM_1 are larger than the amplitudes of the other harmonics; and within [(k − 
1)f s_max, kf s_max] (k ≥ 2), V CM_k and V DM_k are the largest. 
fs_min 
fs_max 
2fs_max 
kfs_max 
kfs 
2fs_min 
3fs_min 
3fs_max 
kfs_min 
kth 
1st 
2nd 
3rd 
0 
20logVCM_k(kfs) 
fs_min 
fs_max 
2fs_max 
kfs_max 
kfs 
2fs_min 
3fs_min 
3fs_max 
kfs_min 
1s t  
2n d  
kt h  
3r d  
0 
20logVCM_k(kfs) 
(a) CM noise                                              (b) DM noise 
Fig. 5.4 The spectrum of each harmonic for the CM and DM noise

82
5
Prediction of the Conducted Electro-magnetic Interference for Critical …
5.2.3 
Peak, Quasi-peak, and Average Spectra 
of the Conducted EMI 
Based on the principle of EMI receiver in Fig. 2.7, the CM and DM noises of the 
CRM boost PFC converter are sent to the equivalent intermediate-frequency (IF) 
ﬁlter. As a result, the kth harmonic amplitudes of the CM and DM noises ﬁltered by 
the equivalent intermediate frequency (IF) ﬁlter are
S t a
rtLay out Enla rged left bra
c e
 1st Row uppe r V prime Sub
script CM normal bar k Baseline equals StartAbsoluteValue upper G Subscript IF Baseline left parenthesis k f Subscript s Baseline right parenthesis EndAbsoluteValue dot upper V Subscript CM normal bar k Baseline 2nd Row upper V prime Subscript DM normal bar k Baseline equals StartAbsoluteValue upper G Subscript IF Baseline left parenthesis k f Subscript s Baseline right parenthesis EndAbsoluteValue dot upper V Subscript DM normal bar k EndLayout
where, GIF is the gain of the IF ﬁlter. 
The outputs of the envelope detector, V CM_env and V DM_env, are expressed as
S tartLayo ut En
l
a r
ged lef t
 brac e  1 s tV R
ow u
p
per V Su bscri
p
t  
CM norm a
l bar  e n v  B a
seli
n
e equals max left brace upper V prime Subscript CM normal bar 1 Baseline comma upper V prime Subscript CM normal bar 2 Baseline comma ellipsis comma upper V prime Subscript CM normal bar k right brace 2nd Row upper V Subscript DM normal bar env Baseline equals max left brace upper V prime Subscript DM normal bar 1 Baseline comma upper V prime Subscript DM normal bar 2 Baseline comma ellipsis comma upper V prime Subscript DM normal bar k right brace EndLayout
According to (5.6), (5.12) and (5.14), Fig. 5.5 depicts the switching frequency 
f s and its multiples, the harmonic spectrum of the CM or DM noise voltages, the 
envelope signals (V CM_env and V DM_env in logarithmic scale) at a certain frequency 
f IF ( f IF ∈ [ f s_min, f s_max]), and the peak (PK) values, where tkfs=IF denotes the time 
instant when kf s = f IF within [0, T line/4]. As seen, V CM_env and V DM_env are nearly 
zero at most of the time within [0, T line/2], except at those time instants tkfs=IF. 
t
0 
20logVCM_k 
20logVCM_env 
t 
VCM_PK
1st 
2nd 3rd 
1st 
2nd 
3rd 
3fs 
2fs 
fs 
fIF 
Tline/2
Tline/4 
20logVDM_k 
t
tfs=IF
t2fs=IF t3fs=IF 
1st 
2nd 
3rd 
1st 
2nd 
3rd 
fs_min
fs_max 
20logVDM_env 
VDM_PK 
Fig. 5.5 Envelope signal and PK values of the CM and DM noises

5.2 Conducted EMI Spectra of the CRM Boost PFC Converter
83
Recalling that the gain of the IF ﬁlter for the kth harmonic of the CM and DM 
noises is unity at tkfs=IF, i.e., |GIF[kf s(tkfs=IF)]| = 1, and other harmonics outside 
the resolution bandwidth (RBW) of the IF ﬁlter are greatly attenuated. Therefore, at 
tfs=IF, according to (5.13) and (5.14), V CM_env and V DM_env are equal to the amplitudes 
of the fundamental harmonics of the CM and DM noise voltages, respectively, i.e., 
V CM_env = V CM_1 and V DM_env = V DM_1. At  tkfs=IF, V CM_env = V CM_k and V DM_env 
= V DM_k, as shown in Fig. 5.5. 
1. PK Spectrum 
As mentioned in Sect. 5.2.2, within [ f s_min, f s_max], the fundamental harmonic of the 
CM and DM noise voltages are larger than other harmonics. Since the PK detector 
outputs the maximum value of the envelope signal within [0, T line/2], when f IF ∈ 
[ f s_min, f s_max], the PK values of the CM and DM noises, V CM_PK and V DM_PK, are  
equal to V CM_1 and V DM_1, respectively. Likewise, referring to Fig. 5.5, when f IF ∈ 
[(k − 1)f s_max, kf s_max] (k ≥ 2), V CM_PK = V CM_k and V DM_PK = V DM_k. 
2. QP and AV Spectrum 
Figure 5.6 shows the switching frequency f s, the envelope signal V CM_env (V DM_env) 
in a half line cycle and the detection of the PK, QP, and average (AV) values, where, 
T BW is the duration when the switching frequency falls into the 9 kHz RBW of the 
IF ﬁlter. The PK detection is irrelevant to T BW, while the charging process of the 
QP detector occurs within T BW. With the increase of T BW, the QP value will also be 
increased to approach the PK value. Therefore, the longer the T BW is, the closer the 
QP value and the PK value will be. As the RBW of the IF ﬁlter is ﬁxed, T BW increases 
with the decrease of |df s(t)/dt| at  tfs=IF. When f IF = f s_min, T BW is the longest over a 
half line cycle. As a result, the QP value is the closest to the PK value, as shown in 
Fig. 5.6b.
The AV values of the CM and DM noises are the average value of V CM_env and 
V DM_env in a half line cycle, respectively, which can be expressed as 
S
tartLa
yout E
nlarged  l eft brace 1st Row upper V Subscript CM normal bar AV Baseline equals StartFraction 2 Over upper T Subscript line Baseline EndFraction integral Subscript 0 Superscript StartFraction upper T Subscript line Baseline Over 2 EndFraction Baseline upper V Subscript CM normal bar env Baseline left parenthesis t right parenthesis d t 2nd Row upper V Subscript DM normal bar AV Baseline equals StartFraction 2 Over upper T Subscript line Baseline EndFraction integral Subscript 0 Superscript StartFraction upper T Subscript line Baseline Over 2 EndFraction Baseline upper V Subscript DM normal bar env Baseline left parenthesis t right parenthesis d t EndLayout
StartL
ayout Enlarged left brace 1st Row upper V Subscript CM normal bar AV Baseline equals StartFraction 2 Over upper T Subscript line Baseline EndFraction integral Subscript 0 Superscript StartFraction upper T Subscript line Baseline Over 2 EndFraction Baseline upper V Subscript CM normal bar env Baseline left parenthesis t right parenthesis d t 2nd Row upper V Subscript DM normal bar AV Baseline equals StartFraction 2 Over upper T Subscript line Baseline EndFraction integral Subscript 0 Superscript StartFraction upper T Subscript line Baseline Over 2 EndFraction Baseline upper V Subscript DM normal bar env Baseline left parenthesis t right parenthesis d t EndLayout
St
ar
tLayout Enlarg
ed left  b race 1st Row upper V Subscript CM normal bar AV Baseline equals StartFraction 2 Over upper T Subscript line Baseline EndFraction integral Subscript 0 Superscript StartFraction upper T Subscript line Baseline Over 2 EndFraction Baseline upper V Subscript CM normal bar env Baseline left parenthesis t right parenthesis d t 2nd Row upper V Subscript DM normal bar AV Baseline equals StartFraction 2 Over upper T Subscript line Baseline EndFraction integral Subscript 0 Superscript StartFraction upper T Subscript line Baseline Over 2 EndFraction Baseline upper V Subscript DM normal bar env Baseline left parenthesis t right parenthesis d t EndLayout
StartL
ayout Enlarged left brace 1st Row upper V Subscript CM normal bar AV Baseline equals StartFraction 2 Over upper T Subscript line Baseline EndFraction integral Subscript 0 Superscript StartFraction upper T Subscript line Baseline Over 2 EndFraction Baseline upper V Subscript CM normal bar env Baseline left parenthesis t right parenthesis d t 2nd Row upper V Subscript DM normal bar AV Baseline equals StartFraction 2 Over upper T Subscript line Baseline EndFraction integral Subscript 0 Superscript StartFraction upper T Subscript line Baseline Over 2 EndFraction Baseline upper V Subscript DM normal bar env Baseline left parenthesis t right parenthesis d t EndLayout
St
ar
tLayout Enlarg
ed left brace 1st Row upper V Subscript CM normal bar AV Baseline equals StartFraction 2 Over upper T Subscript line Baseline EndFraction integral Subscript 0 Superscript StartFraction upper T Subscript line Baseline Over 2 EndFraction Baseline upper V Subscript CM normal bar env Baseline left parenthesis t right parenthesis d t 2nd Row upper V Subscript DM normal bar AV Baseline equals StartFraction 2 Over upper T Subscript line Baseline EndFraction integral Subscript 0 Superscript StartFraction upper T Subscript line Baseline Over 2 EndFraction Baseline upper V Subscript DM normal bar env Baseline left parenthesis t right parenthesis d t EndLayout
Figure 5.7 shows the harmonic amplitudes of the CM and DM noise voltages in 
solid line and the PK, QP, and AV spectra of the CM and DM noises in dashed line, 
where, the QP values are calculated using the numerical method [5], and the AV 
values are calculated using (5.15). As seen, the curves of the PK values coincide 
with the fundamental harmonics within [ f s_min, f s_max], and they are also identical 
to the kth harmonics within [(k − 1)f s_max, kf s_max] (k ≥ 2). Note that the harmonic 
amplitudes are zero at the frequencies lower than f s_min, but the PK, QP, and AV 
values are not zero (i.e., −∞ dBμV) when f IF is lower than f s_min. This is due to 
the band-pass effect of the IF ﬁlter, whose gain cannot achieve −∞ dB outsides its

84
5
Prediction of the Conducted Electro-magnetic Interference for Critical …
t
0 
t
0 
fIF
9 kHz  
TBW
TBW 
0
Tline/2
Tline/4 
fs_max 
fs_min 
VCM_env or 
VDM_env 
1st 
2nd 
PK 
QP 
AV 
3fs 
2fs 
fs 
(a) fIF ≠ fs_min 
t
0 
t
0 
fIF = fs_min
9 kHz  
Maximum TBW 
0
Tline/2
Tline/4 
fs_max 
VCM_env or 
VDM_env 
1st 
PK 
QP 
AV 
3fs 
2fs 
fs 
(b) fIF = fs_min 
Fig. 5.6 The switching frequency, envelope signal, PK, QP and AV values of the conducted EMI
RBW. Similarly, the PK, QP, and AV values are slightly higher than the amplitudes 
of the harmonics at the vicinity of kf s_max, owing to the band-pass effect of the IF 
ﬁlter.
Referring to Fig. 5.6, all the harmonics appearing in the envelope signal contribute 
to the AV values, and with the increase of f IF, the  kth harmonic starts to appear in 
the envelope signal at kf s_min, so there are bulges on the curves of the AV values at 
the vicinity of kf s_min, as shown in Fig. 5.7. In addition, the switching frequency of 
the CRM boost PFC converter varies in a wide range, which is far wider than the 
RBW of the IF ﬁlter, so V CM_env and V DM_env are nearly zero at most time within [0, 
T line/2], and the AV values of the conducted EMI of the CRM boost PFC converter 
are far lower than the QP and PK values (usually more than 10 dB) [5]. Since the

5.3 Prediction of the Conducted EMI of the CRM Boost PFC Converter
85
fIF 
CM noise (dBμV) 
fs_max
fs_min
2fs_max
2fs_min 3fs_min 
Around fs_max 
1st 
2nd 
3rd 
QP 
AV 
PK 
3fs_max 
PK
QP 
AV 
1st
2nd 
3rd 
Harmonic amplitude 
Detected values 
(a) CM noise spectrum 
fIF 
DM noise (dBμV) 
1st 
2nd 
3rd 
QP 
AV 
PK 
fs_max
fs_min
2fs_max
2fs_min 3fs_min
3fs_max 
Around fs_max 
PK
QP 
AV 
1st
2nd 
3rd 
Harmonic amplitude 
Detected values 
(b) DM noise spectrum 
Fig. 5.7 Harmonic amplitudes and the PK, QP, AV values of the conducted EMI
QP limit deﬁned in EN55022 Class B is 10 dB higher than the AV limit, the EMI 
ﬁlters required for suppressing the QP spectra are larger than that for suppressing the 
AV spectra. So, further discussion will be focused on the worst QP spectra, which 
require the lowest corner frequencies for the CM and DM ﬁlters. 
5.3 
Prediction of the Conducted EMI of the CRM Boost 
PFC Converter 
As discussed in Sect. 5.2.3, when f IF ∈ [ f s_min, f s_max], V CM_PK equals to V CM_1 and 
V DM_PK equals to V DM_1. Substituting k = 1 and f s = f IF into (5.12), the PK values 
measured within [ f s_min, f s_max] can be expressed as 
l
ef
t 
brace S tartLa yout 1st 
Row up
p
e
r V Subscript CM normal bar PK Baseline equals 2 upper V Subscript o Baseline f Subscript IF Baseline upper C Subscript p Baseline upper R Subscript LN Baseline StartAbsoluteValue sine left parenthesis pi StartFraction f Subscript IF Baseline Over f Subscript s normal bar max Baseline EndFraction right parenthesis EndAbsoluteValue 2nd Row upper V Subscript DM normal bar PK Baseline equals StartFraction upper V Subscript o Baseline Over 4 pi cubed f Subscript IF Superscript 2 Baseline upper L Subscript b Baseline upper C Subscript x 1 Baseline EndFraction StartAbsoluteValue sine left parenthesis pi StartFraction f Subscript IF Baseline Over f Subscript s normal bar max Baseline EndFraction right parenthesis EndAbsoluteValue EndLayout f Subscript IF Baseline element of left bracket f Subscript s normal bar min Baseline comma f Subscript s normal bar max Baseline right bracket
left b
race
VStartL a
yout 1st Row upper V Subscript CM normal bar PK Baseline equals 2 upper V Subscript o Baseline f Subscript IF Baseline upper C Subscript p Baseline upper R Subscript LN Baseline StartAbsoluteValue sine left parenthesis pi StartFraction f Subscript IF Baseline Over f Subscript s normal bar max Baseline EndFraction right parenthesis EndAbsoluteValue 2nd Row upper V Subscript DM normal bar PK Baseline equals StartFraction upper V Subscript o Baseline Over 4 pi cubed f Subscript IF Superscript 2 Baseline upper L Subscript b Baseline upper C Subscript x 1 Baseline EndFraction StartAbsoluteValue sine left parenthesis pi StartFraction f Subscript IF Baseline Over f Subscript s normal bar max Baseline EndFraction right parenthesis EndAbsoluteValue EndLayout f Subscript IF Baseline element of left bracket f Subscript s normal bar min Baseline comma f Subscript s normal bar max Baseline right bracket
left br ac
e StartL
ayout 
1
s
t Row upper V Subscript CM normal bar PK Baseline equals 2 upper V Subscript o Baseline f Subscript IF Baseline upper C Subscript p Baseline upper R Subscript LN Baseline StartAbsoluteValue sine left parenthesis pi StartFraction f Subscript IF Baseline Over f Subscript s normal bar max Baseline EndFraction right parenthesis EndAbsoluteValue 2nd Row upper V Subscript DM normal bar PK Baseline equals StartFraction upper V Subscript o Baseline Over 4 pi cubed f Subscript IF Superscript 2 Baseline upper L Subscript b Baseline upper C Subscript x 1 Baseline EndFraction StartAbsoluteValue sine left parenthesis pi StartFraction f Subscript IF Baseline Over f Subscript s normal bar max Baseline EndFraction right parenthesis EndAbsoluteValue EndLayout f Subscript IF Baseline element of left bracket f Subscript s normal bar min Baseline comma f Subscript s normal bar max Baseline right bracket
left b
race
 Sta r
t
Layout 1st Row
 
upper V Subscript CM normal bar PK Baseline equals 2 upper V Subscript o Baseline f Subscript IF Baseline upper C Subscript p Baseline upper R Subscript LN Baseline StartAbsoluteValue sine left parenthesis pi StartFraction f Subscript IF Baseline Over f Subscript s normal bar max Baseline EndFraction right parenthesis EndAbsoluteValue 2nd Row upper V Subscript DM normal bar PK Baseline equals StartFraction upper V Subscript o Baseline Over 4 pi cubed f Subscript IF Superscript 2 Baseline upper L Subscript b Baseline upper C Subscript x 1 Baseline EndFraction StartAbsoluteValue sine left parenthesis pi StartFraction f Subscript IF Baseline Over f Subscript s normal bar max Baseline EndFraction right parenthesis EndAbsoluteValue EndLayout f Subscript IF Baseline element of left bracket f Subscript s normal bar min Baseline comma f Subscript s normal bar max Baseline right bracket
Since |sin(πf IF/f s_max)| ≤ 1, according to (5.16), we have

86
5
Prediction of the Conducted Electro-magnetic Interference for Critical …
fIF 
PK value of CM noise (dBμV) 
20dB/dec 
VCM_mb 
in
o (2 2)
V
V
2 
in
o (2 2)
V
V
3
in
o (2 2)
V
V
1 
1 
2 
3 
fIF 
PK value of DM noise (dBμV) 
–40dB/dec 
VDM_mb 
1 
2 
3 
in
o (2 2)
V
V
2 
in
o (2 2)
V
V
3 
in
o (2 2)
V
V
1 
(a) CM noise                                                   (b) DM noise 
Fig. 5.8 PK value of CM and DM noise spectrum and the maximum boundary
S
tartLay outVon larged le f t brace
V1st Ro w
Vupper V Subscript CM normal bar PK Baseline less than or equals 2 upper V Subscript o Baseline f Subscript IF Baseline upper C Subscript p Baseline upper R Subscript LN Baseline delta equals upper V Subscript CM normal bar mb Baseline 2nd Row upper V Subscript DM normal bar PK Baseline less than or equals StartFraction upper V Subscript o Baseline Over 4 pi cubed f Subscript IF Superscript 2 Baseline upper L Subscript b Baseline upper C Subscript x 1 Baseline EndFraction delta equals upper V Subscript DM normal bar mb EndLayout
Start La yo
ut Enlar g ed left
 brace 1st Row upper V Subscript CM normal bar PK Baseline less than or equals 2 upper V Subscript o Baseline f Subscript IF Baseline upper C Subscript p Baseline upper R Subscript LN Baseline delta equals upper V Subscript CM normal bar mb Baseline 2nd Row upper V Subscript DM normal bar PK Baseline less than or equals StartFraction upper V Subscript o Baseline Over 4 pi cubed f Subscript IF Superscript 2 Baseline upper L Subscript b Baseline upper C Subscript x 1 Baseline EndFraction delta equals upper V Subscript DM normal bar mb EndLayout
where, V CM_mb and V DM_mb are the maximum boundaries of the CM and DM noises. 
Based on (5.16), when f IF = f s_max/2, V CM_PK and V DM_PK equals to V CM_mb and 
V DM_mb, respectively. 
According to (5.16), the PK and QP spectra for the CM and DM noise calculated 
under the same load and different input voltage conditions are depicted in Fig. 5.8. 
According to (5.7) and (5.8), it can be known that: 
(1) When V in < V o/
l
eft parenthesis 2 StartRoot 2 EndRoot right parenthesis
√
l
eft parenthesis 2 StartRoot 2 EndRoot right parenthesis
, we have  f s_max/2 < f s_min, i.e., f s_max/2 does not stay 
within [ f s_min, f s_max]. Therefore, according to (5.16), the PK values for the CM 
and DM noises are lower than V CM_mb and V DM_mb, respectively; 
(2) When V in = V o/
l
eft parenthesis 2 StartRoot 2 EndRoot right parenthesis
√
l
eft parenthesis 2 StartRoot 2 EndRoot right parenthesis
, we have  f s_min = f s_max/2, and the PK values for the 
CM and DM noise at f s_min are equal to V CM_mb and V DM_mb, respectively; 
(3) When V in ≥ V o/
l
eft parenthesis 2 StartRoot 2 EndRoot right parenthesis
√
l
eft parenthesis 2 StartRoot 2 EndRoot right parenthesis
, the PK values of CM and DM noises are equal 
to V CM_mb and V DM_mb at f IF = f s_max/2, respectively. Furthermore, f s_max/2 
increases with the increase of V in and decrease of Po. 
Therefore, V CM_mb and V DM_mb can be regarded as the maximum boundaries for 
the PK spectra, as shown in Fig. 5.8. According to (5.17), V CM_mb increases with a 
slope of 20 dB/dec, and V DM_mb decreases with a slope of – 40 dB/dec. According 
to (5.8), the frequencies at which the PK values equal to the maximum boundaries 
can be derived as 
f Subsc ript PK equals mb Baseline equals one half f Subscript s normal bar max Baseline equals one fourth StartFraction upper V Subscript in Superscript 2 Baseline Over upper P Subscript o Baseline upper L Subscript b Baseline EndFraction left parenthesis upper V Subscript in Baseline greater than or equals StartFraction upper V Subscript o Baseline Over 2 StartRoot 2 EndRoot EndFraction right parenthesis
f Subscri pt PK equals mb Baseline equals one half f Subscript s normal bar max Baseline equals one fourth StartFraction upper V Subscript in Superscript 2 Baseline Over upper P Subscript o Baseline upper L Subscript b Baseline EndFraction left parenthesis upper V Subscript in Baseline greater than or equals StartFraction upper V Subscript o Baseline Over 2 StartRoot 2 EndRoot EndFraction right parenthesis
f 
Su bs
cript PK equals mb Baseline equals one half f Subscript s normal bar max Baseline equals one fourth StartFraction upper V Subscript in Superscript 2 Baseline Over upper P Subscript o Baseline upper L Subscript b Baseline EndFraction left parenthesis upper V Subscript in Baseline greater than or equals StartFraction upper V Subscript o Baseline Over 2 StartRoot 2 EndRoot EndFraction right parenthesis
f Su
b
scri pt VPK equals mb Baseline equals one half f Subscript s normal bar max Baseline equals one fourth StartFraction upper V Subscript in Superscript 2 Baseline Over upper P Subscript o Baseline upper L Subscript b Baseline EndFraction left parenthesis upper V Subscript in Baseline greater than or equals StartFraction upper V Subscript o Baseline Over 2 StartRoot 2 EndRoot EndFraction right parenthesis
f Subscript PK equals mb Baseline equals one half f Subscript s normal bar max Baseline equals one fourth StartFraction upper V Subscript in Superscript 2 Baseline Over upper P Subscript o Baseline upper L Subscript b Baseline EndFraction left parenthesis upper V Subscript in Baseline greater than or equals StartFraction upper V Subscript o Baseline Over 2 StartRoot 2 EndRoot EndFraction right parenthesis
√
f
 
Subscript PK equals mb Baseline equals one half f Subscript s normal bar max Baseline equals one fourth StartFraction upper V Subscript in Superscript 2 Baseline Over upper P Subscript o Baseline upper L Subscript b Baseline EndFraction left parenthesis upper V Subscript in Baseline greater than or equals StartFraction upper V Subscript o Baseline Over 2 StartRoot 2 EndRoot EndFraction right parenthesis

5.3 Prediction of the Conducted EMI of the CRM Boost PFC Converter
87
fIF 
QP value of CM noise (dBμV) 
20dB/dec 
VCM_mb 
2 
1 
3 
in
o (2 2)
V
V
2 
in
o (2 2)
V
V
3
in
o (2 2)
V
V
1 
fIF 
QP value of DM noise (dBμV) 
–40dB/dec 
VDM_mb 
2 
1 
3 
in
o (2 2)
V
V
2 
in
o (2 2)
V
V
3 
in
o (2 2)
V
V
1 
(a) CM noise                                                     (b) DM noise 
Fig. 5.9 QP value of CM and DM noise spectrum and the maximum boundary 
With numerical calculation, the QP values of the CM and DM noises under 
different input voltage and load conditions are shown in Fig. 5.9. The QP values 
are calculated by an iterative algorithm to ﬁnd the equilibrium output when the 
charging and discharging process of the QP detector is balanced. When V in = V o/
l
eft parenthesis 2 StartRoot 2 EndRoot right parenthesis
√
l
eft parenthesis 2 StartRoot 2 EndRoot right parenthesis
, we have  f s_min = f s_max/2. At the minimum switching frequencies, the PK 
values of the CM and DM noises are equal to V CM_mb and V DM_mb, respectively. As 
discussed in Sect. 5.2.3, when f IF = f s_min, the QP values are the closest to the PK 
values. As seen in Fig. 5.9, when V in < V o/
l
eft parenthesis 2 StartRoot 2 EndRoot right parenthesis
√
l
eft parenthesis 2 StartRoot 2 EndRoot right parenthesis
or V in > V o/
l
eft parenthesis 2 StartRoot 2 EndRoot right parenthesis
√
l
eft parenthesis 2 StartRoot 2 EndRoot right parenthesis
, the QP values 
for the CM and DM noises are lower than V CM_mb and V DM_mb, respectively. 
Substituting V in = V o/
l
eft parenthesis 2 StartRoot 2 EndRoot right parenthesis
√
l
eft parenthesis 2 StartRoot 2 EndRoot right parenthesis
into (5.18), the frequency at which the QP values 
are the closest to the maximum boundaries V CM_mb and V DM_mb can be derived as 
f Subsc ript QP equals mb Baseline equals one fourth StartFraction upper V Subscript in Superscript 2 Baseline Over upper P Subscript o Baseline upper L Subscript b Baseline EndFraction equals one thirty second StartFraction upper V Subscript o Superscript 2 Baseline Over upper P Subscript o Baseline upper L Subscript b Baseline EndFraction
f 
Su bs
cript QP equals mb Baseline equals one fourth StartFraction upper V Subscript in Superscript 2 Baseline Over upper P Subscript o Baseline upper L Subscript b Baseline EndFraction equals one thirty second StartFraction upper V Subscript o Superscript 2 Baseline Over upper P Subscript o Baseline upper L Subscript b Baseline EndFraction
f Sub
sc ript QP equals mb Baseline equals one fourth StartFraction upper V Subscript in Superscript 2 Baseline Over upper P Subscript o Baseline upper L Subscript b Baseline EndFraction equals one thirty second StartFraction upper V Subscript o Superscript 2 Baseline Over upper P Subscript o Baseline upper L Subscript b Baseline EndFraction
f S
ub sc
ript QP equals mb Baseline equals one fourth StartFraction upper V Subscript in Superscript 2 Baseline Over upper P Subscript o Baseline upper L Subscript b Baseline EndFraction equals one thirty second StartFraction upper V Subscript o Superscript 2 Baseline Over upper P Subscript o Baseline upper L Subscript b Baseline EndFraction
f Sub
script QP equals mb Baseline equals one fourth StartFraction upper V Subscript in Superscript 2 Baseline Over upper P Subscript o Baseline upper L Subscript b Baseline EndFraction equals one thirty second StartFraction upper V Subscript o Superscript 2 Baseline Over upper P Subscript o Baseline upper L Subscript b Baseline EndFraction
According to (5.19), f QP=mb increases with the decrease of Po. So, the minimum 
value of f QP=mb_min is expressed as 
f Subscript  Q P equals mb normal bar min Baseline equals one thirty second StartFraction upper V Subscript o Superscript 2 Baseline Over upper P Subscript o normal bar max Baseline upper L Subscript b Baseline EndFraction
f S
ub sc
ript QP equals mb normal bar min Baseline equals one thirty second StartFraction upper V Subscript o Superscript 2 Baseline Over upper P Subscript o normal bar max Baseline upper L Subscript b Baseline EndFraction
f Subscri
pt QP equals mb normal bar min Baseline equals one thirty second StartFraction upper V Subscript o Superscript 2 Baseline Over upper P Subscript o normal bar max Baseline upper L Subscript b Baseline EndFraction
For the CRM boost PFC converter, the theoretical calculated switching frequency 
of the CRM boost PFC converter may be very high at extremely light load, and it is 
usually limited by the control IC. For the frequencies higher than the maximum of 
f QP=mb, the maximum boundaries for the second and third harmonics of the CM and 
DM noises can be derived in a similar way. Obviously, these boundaries are always 
lower than the extension line of V CM_mb and V DM_mb, respectively. According to 
(5.16), the QP spectrum with different output power Po with V in = V o/
l
eft parenthesis 2 StartRoot 2 EndRoot right parenthesis
√
l
eft parenthesis 2 StartRoot 2 EndRoot right parenthesis
can 
be illustrated, as shown in Fig. 5.10.

88
5
Prediction of the Conducted Electro-magnetic Interference for Critical …
fIF 
CM noise in QP (dBμV) 
20 dB/dec 
Vin = Vo/2 2 
Po decreases 
VCM_mb 
fQP=mb_min
fIF 
DM noise in QP (dBμV) 
–40 dB/dec 
Vin = Vo/2 2 
VDM_mb 
fQP=mb_min 
Po decreases 
(a) CM noise                                                   (b) DM noise 
Fig. 5.10 The QP spectrum and the maximum boundary under different load condition 
In conclusion, for the frequencies f IF < f QP=mb_min, the QP values measured at f IF 
are lower than V CM_mb and V DM_mb under all working conditions, as highlighted in the 
left shadow in Fig. 5.10; and for the frequencies f IF ≥ f QP=mb_min, the QP values are 
the closest to V CM_mb and V DM_mb at f QP=mb when V in = V o/
l
eft parenthesis 2 StartRoot 2 EndRoot right parenthesis
√
l
eft parenthesis 2 StartRoot 2 EndRoot right parenthesis
. Thus, V CM_mb 
and V DM_mb can also be approximately regarded as the maximum boundaries for the 
QP spectra of the conducted EMI of the CRM boost PFC converter under all working 
conditions. 
5.4 
EMI Filter Design for the CRM Boost PFC Converter 
When designing the CM and DM ﬁlters for CRM boost PFC converters, the attenua-
tion requirements for the CM and DM noises are essential. The maximum boundaries 
of the QP spectra will be incorporated to derive the attenuation requirement of EMI 
ﬁlters. 
Figure 5.11a shows the QP limit in EN55022 Class B [6] and the maximum 
boundaries of the QP spectra for the CM and DM noises when f QP=mb_min ≤ 150 kHz, 
where, V CM_mb and V DM_mb are the precise maximum boundaries of the CM and 
DM noises. As seen, the limit decreases in a slope of – 20 dB/dec within [150 kHz, 
500 kHz], and V CM_mb increases with a slope of 20 dB/dec and V DM_mb decreases 
with a slope of – 40 dB/dec, respectively.
By subtracting the QP limit from V CM_mb and V DM_mb, the attenuation require-
ments for the CM and DM noises, Areq_CM and Areq_DM, are calculated, respectively, 
as shown in Fig. 5.11b. It is observed that Areq_CM increases with a slope of 40 dB/ 
dec, and Areq_DM decreases with a slope of – 20 dB/dec. 
With typical CM and DM ﬁlters given in Fig. 3.10, the attenuation for the CM and 
DM noises with a slope of 40 dB/dec can be achieved. According to Fig. 5.11, the  
attenuation requirement of the CM noise within [150 kHz, 500 kHz] indicates the 
same lowest corner frequencies of the CM ﬁlter, and the lowest corner frequencies 
of the DM ﬁlter are determined by the attenuation requirement of the DM noise at

5.4 EMI Filter Design for the CRM Boost PFC Converter
89
Conducted EMI (dBμV) 
150k 
QP limit 
500k 
–20dB/dec 
20dB/dec
VDM_mb 
VCM_mb 
fQP=mb_min
fIF 
66 
56 
–40dB/dec 
Attenuation (dB)  
150k
fDM
500k
fCM 
40dB/dec 
DM filter 
40dB/dec 
fIF 
–20dB/dec 
Areq_CM 
Areq_DM 
CM filter 
(a) Maximum boundary of the QP spectra and the QP limit
(b) Attenuation requirement 
Fig. 5.11 CM and DM ﬁlter design with f QP=mb_min ≤ 150 kHz
150 kHz. Thus, the largest QP values of the CM noises within [150 kHz, 500 kHz] 
and the largest QP value of the DM noise at 150 kHz indicate the worst CM and DM 
noise spectra, respectively. According to (5.19), the input voltage and load condition 
for the worst CM and DM spectra are derived as 
upper V Su bscript in n or mal bar ws Baseline normal bar CM equals upper V Subscript in normal bar ws Baseline normal bar DM equals StartFraction upper V Subscript o Baseline Over 2 StartRoot 2 EndRoot EndFraction
upper V Subscript in normal bar ws Baseline normal bar CM equals upper V Subscript in normal bar ws Baseline normal bar DM equals StartFraction upper V Subscript o Baseline Over 2 StartRoot 2 EndRoot EndFraction
√
up
per V Subscript in normal bar ws Baseline normal bar CM equals upper V Subscript in normal bar ws Baseline normal bar DM equals StartFraction upper V Subscript o Baseline Over 2 StartRoot 2 EndRoot EndFraction
St ar
tFraction upper V Subscript o Superscript 2 Baseline Over 32 upper L Subscript b Baseline dot 500 kHz EndFraction less than or equals upper P Subscript o normal bar ws Baseline normal bar CM less than or equals StartFraction upper V Subscript o Superscript 2 Baseline Over 32 upper L Subscript b Baseline dot 150 kHz EndFraction
Start Fracti on u pper V Subs c
ri pt
 o Superscript 2 Baseline Over 32 upper L Subscript b Baseline dot 500 kHz EndFraction less than or equals upper P Subscript o normal bar ws Baseline normal bar CM less than or equals StartFraction upper V Subscript o Superscript 2 Baseline Over 32 upper L Subscript b Baseline dot 150 kHz EndFraction
Start Fracti on u
pper V Subscript o Superscript 2 Baseline Over 32 upper L Subscript b Baseline dot 500 kHz EndFraction less than or equals upper P Subscript o normal bar ws Baseline normal bar CM less than or equals StartFraction upper V Subscript o Superscript 2 Baseline Over 32 upper L Subscript b Baseline dot 150 kHz EndFraction
upper P S u
bs cr
ipt o normal bar ws Baseline normal bar DM equals StartFraction upper V Subscript o Superscript 2 Baseline Over 32 upper L Subscript b Baseline dot 150 kHz EndFraction
upper  P Sub scri
pt o normal bar ws Baseline normal bar DM equals StartFraction upper V Subscript o Superscript 2 Baseline Over 32 upper L Subscript b Baseline dot 150 kHz EndFraction
When 150 kHz ≤ f QP=mb_min ≤ 500 kHz, the maximum boundaries of the CM 
and DM noises and the EMI ﬁlter design are shown in Fig. 5.12, where, u p
per V prime Subscript CM normal bar mb and 
u p
per V prime Subscript DM normal bar mb are the actual boundaries of the CM and DM noises for the frequencies below 
f QP=mb_min, respectively. Based on (5.16) and (5.17), it is clear that these boundaries 
are lower than the extension lines of V CM_mb and V DM_mb, respectively. 
66 
56 
Conducted EMI (dBμV) 
150k 
QP limit 
500k 
20dB/dec
VCM_mb 
VDM_mb 
fQP=mb_min
fIF 
VDM_mb 
' 
'
VCM_mb 
–40dB/dec 
–20dB/dec
Attenuation (dB) 
150k
fDM
500k
fCM 
40dB/dec 
40dB/dec 
fIF
fQP=mb_min 
DM filter 
CM filter 
–20dB/dec 
Areq_CM 
Areq_DM 
Areq_CM 
' 
Areq_DM 
' 
(a) Maximum boundary of the QP spectra and the QP limit
(b) Attenuation requirement 
Fig. 5.12 CM and DM ﬁlter design with 150 kHz ≤ f QP=mb_min ≤ 500 kHz

90
5
Prediction of the Conducted Electro-magnetic Interference for Critical …
As seen in Fig. 5.12b, the corner frequency of the CM ﬁlter is determined by 
V CM_mb within [ f QP=mb_min, 500 kHz], and that of the DM ﬁlter is determined by 
u p
per V prime Subscript DM normal bar mb at 150 kHz. Thus, the input voltage and load conditions for the worst CM 
noise spectra are: V in_ws_CM = V o/
l
eft parenthesis 2 StartRoot 2 EndRoot right parenthesis
√
l
eft parenthesis 2 StartRoot 2 EndRoot right parenthesis
with the output power that ensuring f QP=mb 
≤ 500 kHz. For the DM noise, by substituting f IF = f s_min = 150 kHz and V DM_QP 
= V DM_PK along with (5.7) and (5.8) into (5.12), we have 
upper V Sub scri pt DM normal bar QP normal bar 150 kHz Baseline equals StartFraction 2 upper V Subscript o Baseline Over pi EndFraction StartAbsoluteValue sine left bracket pi left parenthesis 1 minus StartFraction StartRoot 2 EndRoot upper V Subscript in Baseline Over upper V Subscript o Baseline EndFraction right parenthesis right bracket EndAbsoluteValue dot StartFraction 1 Over 8 pi squared upper L Subscript b Baseline upper C Subscript x 1 Baseline left parenthesis 150 kHz right parenthesis squared EndFraction
u
pper V S
u
b
s
cr ipt DM normal bar QP normal bar 150 kHz Baseline equals StartFraction 2 upper V Subscript o Baseline Over pi EndFraction StartAbsoluteValue sine left bracket pi left parenthesis 1 minus StartFraction StartRoot 2 EndRoot upper V Subscript in Baseline Over upper V Subscript o Baseline EndFraction right parenthesis right bracket EndAbsoluteValue dot StartFraction 1 Over 8 pi squared upper L Subscript b Baseline upper C Subscript x 1 Baseline left parenthesis 150 kHz right parenthesis squared EndFraction
√
upper V Subscript DM normal bar QP normal bar 150 kHz Baseline equals StartFraction 2 upper V Subscript o Baseline Over pi EndFraction StartAbsoluteValue sine left bracket pi left parenthesis 1 minus StartFraction StartRoot 2 EndRoot upper V Subscript in Baseline Over upper V Subscript o Baseline EndFraction right parenthesis right bracket EndAbsoluteValue dot StartFraction 1 Over 8 pi squared upper L Subscript b Baseline upper C Subscript x 1 Baseline left parenthesis 150 kHz right parenthesis squared EndFraction
up
per V S u
bscript DM normal bar QP normal bar 150 kHz Baseline equals StartFraction 2 upper V Subscript o Baseline Over pi EndFraction StartAbsoluteValue sine left bracket pi left parenthesis 1 minus StartFraction StartRoot 2 EndRoot upper V Subscript in Baseline Over upper V Subscript o Baseline EndFraction right parenthesis right bracket EndAbsoluteValue dot StartFraction 1 Over 8 pi squared upper L Subscript b Baseline upper C Subscript x 1 Baseline left parenthesis 150 kHz right parenthesis squared EndFraction
upper V Subscr ipt D
M normal bar QP normal bar 150 kHz Baseline equals StartFraction 2 upper V Subscript o Baseline Over pi EndFraction StartAbsoluteValue sine left bracket pi left parenthesis 1 minus StartFraction StartRoot 2 EndRoot upper V Subscript in Baseline Over upper V Subscript o Baseline EndFraction right parenthesis right bracket EndAbsoluteValue dot StartFraction 1 Over 8 pi squared upper L Subscript b Baseline upper C Subscript x 1 Baseline left parenthesis 150 kHz right parenthesis squared EndFraction
where, V in < V o/
l
eft parenthesis 2 StartRoot 2 EndRoot right parenthesis
√
l
eft parenthesis 2 StartRoot 2 EndRoot right parenthesis
. With the increase of V in, 1  −
√
StartRoot 2 EndRoot V in/V o gets closer to 0.5.  
So V DM_QP_150kHz increases with the increase of V in. 
According to (5.7), when f s_min = 150 kHz and V in < V o/
l
eft parenthesis 2 StartRoot 2 EndRoot right parenthesis
√
l
eft parenthesis 2 StartRoot 2 EndRoot right parenthesis
, V in is the largest 
at full load Po_max. So, the working condition for the largest DM noise at 150 kHz is 
the output power up
per P prime Subscript o normal bar ws normal bar DM = Po_max and the input voltage u p
per V prime Subscript in normal bar ws normal bar DM satisfying the 
equation 
one half StartFraction left parenthesis upper V prime Subscript in normal bar ws normal bar DM right parenthesis squared Over upper P Subscript o normal bar max Baseline upper L Subscript b Baseline EndFraction left parenthesis 1 minus StartFraction StartRoot 2 EndRoot upper V prime Subscript in normal bar ws normal bar DM Over upper V Subscript o Baseline EndFraction right parenthesis equals 150 kHz
o
n
e  
half Sta
rtFraction left parenthesis upper V prime Subscript in normal bar ws normal bar DM right parenthesis squared Over upper P Subscript o normal bar max Baseline upper L Subscript b Baseline EndFraction left parenthesis 1 minus StartFraction StartRoot 2 EndRoot upper V prime Subscript in normal bar ws normal bar DM Over upper V Subscript o Baseline EndFraction right parenthesis equals 150 kHz
one half 
S
ta rtFraction left parenthesis upper V prime Subscript in normal bar ws normal bar DM right parenthesis squared Over upper P Subscript o normal bar max Baseline upper L Subscript b Baseline EndFraction left parenthesis 1 minus StartFraction StartRoot 2 EndRoot upper V prime Subscript in normal bar ws normal bar DM Over upper V Subscript o Baseline EndFraction right parenthesis equals 150 kHz
√
on e
 half StartFraction left parenthesis upper V prime Subscript in normal bar ws normal bar DM right parenthesis squared Over upper P Subscript o normal bar max Baseline upper L Subscript b Baseline EndFraction left parenthesis 1 minus StartFraction StartRoot 2 EndRoot upper V prime Subscript in normal bar ws normal bar DM Over upper V Subscript o Baseline EndFraction right parenthesis equals 150 kHz
on
e
 half Sta
rtFraction left parenthesis upper V prime Subscript in normal bar ws normal bar DM right parenthesis squared Over upper P Subscript o normal bar max Baseline upper L Subscript b Baseline EndFraction left parenthesis 1 minus StartFraction StartRoot 2 EndRoot upper V prime Subscript in normal bar ws normal bar DM Over upper V Subscript o Baseline EndFraction right parenthesis equals 150 kHz
When f QP=mb_min > 500 kHz, the analysis is similar, and it is not discussed here. 
The EMI ﬁlter design for CRM boost PFC converters can be summarized as 
follows. 
(1) Measure or predict the worst QP values of the CM and DM noises at f req_CM and 
f req_DM. When f QP=mb_min ≤ 150 kHz, we have f req_CM = f req_DM = 150 kHz; 
and when 150 kHz ≤ f QP=mb_min ≤ 500 kHz, we have f req_CM = f QP=mb_min and 
f req_DM = 150 kHz; 
(2) Subtract the QP limit from the QP values of the CM and DM noises, so as to 
obtain the attenuation requirement for CM and DM noises. 
(3) Referring to the EMI ﬁlter design in Chap. 3, the parameters of the ﬁlter 
components can be calculated. 
By following this design approach, the conducted EMI of the CRM boost PFC 
converter with the designed EMI ﬁlter can comply with the standard under all working 
conditions.

5.5 Experimental Results
91
EMI filter 
CRM Boost PFC converter 
Fig. 5.13 The CRM boost PFC converter prototype 
5.5 
Experimental Results 
5.5.1 
Speciﬁcations of the Prototype 
In order to verify the conducted EMI spectra characteristics of the CRM boost PFC 
converter, a 90-W CRM boost PFC converter prototype has been fabricated in the 
lab, as shown in Fig. 5.13. 
The speciﬁcations of the converter are as follows: 
• Input voltage V in: 90~264 V/50 Hz; 
• Output voltage V o: 380 V; 
• Rated power Po_max: 90 W;  
• Boost inductor Lb: 800 μH (Based on (5.8), the boost inductor is designed to 
ensure that the minimal switching frequency is above 20 kHz); 
• Control IC: L6561 (ST Microelectronics). 
5.5.2 
Experimental Results 
According to (5.20), f QP_mb_min is calculated as 62.7 kHz, which is lower than 
150 kHz. Therefore, based on (5.21), (5.22) and (5.23), the calculated conditions 
for the largest QP values of the CM and DM noises at 150 kHz are 134.4 V and 
36.1 W, where, the efﬁciency is 96%. Figure 5.14 show the measured QP values of 
the CM and DM noises at 150 kHz under different input voltage and load conditions, 
respectively.

92
5
Prediction of the Conducted Electro-magnetic Interference for Critical …
90
150
210
265 
Vin (V) 
10% 
50% 
75% 
100% 
25% 
Po 
* 
46.1
77.1
92.6
61.6
30.6 
Contour |VCM|QP (dBμV) 
90
150
210
265 
Vin (V) 
10% 
50% 
75% 
100% 
25% 
Po 
* 
55.15
91.45
109.6
73.3
37.0 
Contour |VDM|QP (dBμV) 
(a) CM noise in QP values at 150 kHz
(b) DM noise in QP values at 150 kHz 
Fig. 5.14 The measured QP values for the CM and DM noise at 150 kHz 
As seen in Fig. 5.14, the measured maximum CM and DM noises are 92.6 and 
109.6 dBμV, respectively, both of which occurs at V in = 140 V and Po = 30 W, 
as highlighted in Fig. 5.14. Obviously, the calculated and measured results are quite 
close, and the difference between the calculated and measured working conditions 
for the largest QP value at 150 kHz is attributed by the deviation of the duty cycle 
caused by the voltage drop in the circuit and the delay of the turn-on signal caused 
by the ZCD of the control IC L6561. 
Figure 5.15 gives the measured QP spectra of the CM and DM noises within 
[150 kHz, 1 MHz], under V in = 140 V with Po = 15, 20 and 30 W. As seen, the 
maximum boundary of the CM noise increases with a slope of 20 dB/dec, and that 
of the DM noise decreases with a slope of − 40 dB/dec, which agrees well with the 
analysis in Sect. 5.3. 
100 
70 
150k
1M 
80 
90 
Vin=140 V 
30W 
20W 
15W 
20dB/dec 
QP value of CM noise (dBμV) 
Frequency (Hz) 
CM max. boundary 
120 
60 
50 
150k 
80 
100 
Vin=140 V 
–40dB/dec
30W 
20W 
15W 
1M 
QP value of DM noise (dBμV) 
Frequency (Hz) 
DM max. boundary 
(a) CM noise
(b) DM noise 
Fig. 5.15 The measured conducted EMI under Vin = 140 V, Po = 15, 20 and 30 W

5.6 Summary
93
45 
5 
150k
1M 
15 
35 
Vin=140V
40dB/dec 
25 
30W 
20W 
15W 
Attenuation to CM noise (dB) 
Frequency (Hz) 
CM filter 
55 
5 
150k
1M 
15 
35 
Vin=140V 
40dB/dec 
25 
45 
30W 
20W 
15W 
Attenuation to DM noise (dB) 
Frequency (Hz) 
DM filter 
(a) CM noise
(b) DM noise 
Fig. 5.16 Attenuation requirement for the CM and DM noise 
Figure 5.16 gives the calculated attenuation requirements of the spectra in 
Fig. 5.15. It shows that when the CM and DM ﬁlters provide 40-dB/dec attenuation, 
the attenuation requirement of the CM noise spectra indicate the same corner frequen-
cies of the CM ﬁlter, and the corner frequencies of the DM ﬁlter are determined by 
the largest DM noise at 150 kHz, which veriﬁes the theoretical analysis. 
As the EN5022 Class B standard is 66 dBμV at 150 kHz, by considering 6 dB 
margin, 60 dBμV is subtracted from the largest QP values of the CM and DM noises 
in Fig. 5.14a, b, respectively. As a result, the attenuation requirement of the CM and 
DM noises at 150 kHz can be calculated as 32.6 and 49.6 dB, respectively. A typical 
EMI ﬁlter topology shown in Fig. 3.10 is adopted to attenuate the conducted EMI, 
and the components in the ﬁlter are designed as follows: LCM = 11 mH, Cy = 2200 
pF, LDM = 55.7 μH, Cx1 = Cx2 = 1.47 μF. The prototype of the EMI ﬁlter is given, 
as shown in the left side of Fig. 5.13. 
Figure 5.17 shows the measured CM and DM noise spectra without and with the 
EMI ﬁlter, where the test condition is V in = 140 V and Po = 30 W. The measured 
QP values of the CM and DM noises at 150 kHz are 59.7 and 59.9 dBμV, and the 
margins of the CM and DM noises are 6.3 and 6.1 dB, respectively.
Figure 5.18 shows the measured CM and DM noise spectra with the EMI ﬁlter 
under V in = 110 V and 220 V at full-load, and the margins of the spectra are larger 
than the spectra of Fig. 5.17. Therefore, it is veriﬁed that the EMI spectra of the 
prototype under V in = 140 V and Po = 30 W are worse than that under typical input 
and full-load conditions.
5.6 
Summary 
In this chapter, the prediction of the conducted EMI for the CRM boost PFC converter 
is presented. The harmonic spectra of vDS across the power switch is analyzed, and 
the characteristics of the CM and DM noises are predicted. It is revealed that the

94
5
Prediction of the Conducted Electro-magnetic Interference for Critical …
100k
100M 
0 
40 
60 
100 
CM noise (dBμV) 
Frequency (Hz) 
1M
10M 
20 
80 
w/o filter 
w/ filter 
Margin 6.3dB 
QP
AV 
QPLimit 
AVLimit 
QP 
AV 
(a) CM noise 
100k
100M 
15 
50 
85 
120 
DM noise (dBμV) 
Frequency (Hz) 
1M
10M 
–20 
AV
w/o filter 
w/ filter 
Margin 6.1dB 
AV 
QP 
QP 
QPLimit 
AVLimit 
(b) DM noise 
Fig. 5.17 The measured conducted EMI under Vin = 140 V and Po = 30 W
EMI ﬁlter for the CRM boost PFC converter should be designed to suppress the QP 
spectra, and the maximum boundaries of the QP spectra under all working conditions 
are derived. The worst-case conducted EMI spectra of the CRM boost PFC converter 
is the CM and DM noise spectra with the largest QP values at 150 kHz, when the 
frequency range of the maximum boundary covers 150 kHz. By designing the EMI 
ﬁlter according to the worst case, the conducted EMI of CRM boost PFC converter 
can satisfy the limit under all working conditions.

References
95
Fig. 5.18 The measured 
conducted EMI under 
full-load with Vin = 110 V 
and 220 V
100k
100M 
0 
40 
CM noise (dBμV) 
Frequency (Hz) 
1M
10M 
20 
60 
80 
100 
220V 
110V 
Margin 10.2dB @110 V 
9.8dB @220 V 
AV 
QP 
QPLimit 
AVLimit 
(a) CM noise 
15 
50 
85 
120 
–20 
100k
100M 
DM noise (dBμV) 
Frequency (Hz) 
1M
10M 
220V 
110V 
Margin 15.4 dB @110 V
                  8.1 dB @220 V 
AV 
QP 
QPLimit 
AVLimit 
(b) DM noise 
References 
1. J.-S. Lai, D. Chen, Design consideration for power factor correction boost converter oper-
ating at the boundary of continuous conduction mode and discontinuous conduction mode, in 
Proceedings of IEEE Applied Power Electronics Conference and Exposition (APEC) (1993), 
pp. 267–273 
2. J. Zhang, J. Shao, P. Xu, F.C. Lee, M.M. Jovanovic, Evaluation of input current in the critical 
mode boost PFC converter for distributed power systems, in Proceedings of IEEE Applied Power 
Electronics Conference and Exposition (APEC) (2001), pp. 130–136 
3. M. Marvi, A. Fotowat-Ahmady, A fully ZVS critical conduction mode boost PFC. IEEE Trans. 
Power Electron. 27(4), 1958–1965 (2012) 
4. K. Liu, Y. Lin, Current waveform distortion in power factor correction circuits employing 
discontinuous-mode boost converters, in Proceedings of IEEE Power Electronics Specialists 
Conference (PESC) (1989), pp. 825–829 
5. Z. Wang, S. Wang, P. Kong, F.C. Lee, DM EMI noise prediction for constant on-time, critical 
mode power factor correction converters. IEEE Trans. Power Electron. 27(7), 3150–3157 (2012) 
6. EN 55022, Limits and Methods of Measurement of Radio Disturbance Characteristics of 
Information Technology Equipment. European Norm Standard, European (2006)

Chapter 6 
Modeling of the Common-Mode Noise 
for Isolated DC-DC Converters 
6.1 
The CM Noise Propagation Paths of Isolated DC-DC 
Converters 
In order to analyze and reduce the common-mode (CM) noise in isolated DC-DC 
converters, the CM noise model should be established. Figure 6.1 shows an isolated 
DC-DC converter, which is composed of the primary circuit, transformer, and the 
secondary rectiﬁer and ﬁlter. The 25-Ω resistor is the equivalent impedance for the 
CM noise at the line impedance stabilization network (LISN) side, Cp1 is the parasitic 
capacitance between the high dv/dt node and the protective earth (PE), Cps is the inter-
winding capacitance of the transformer, and PG and SG represents the primary and 
secondary grounds, respectively.
6.2 
A Generalized Lumped Capacitance Model 
According to Fig. 6.1, the CM noise is related to the displacement currents ﬂowing 
through Cp1 and Cps. Since the inter-winding capacitance Cps is complex, it is usually 
converted into lumped capacitance. 
6.2.1 
Characteristics of Inter-winding Capacitance 
of the Transformer 
Figure 6.2 shows a typical transformer winding structure, which are tightly wound. 
There are layer-to-layer parasitic capacitances between WP1 and WS1, WS1 and WS2, 
and WS2 and WP2, and the displacement current can ﬂow between these adjacent
© The Author(s), under exclusive license to Springer Nature Singapore Pte Ltd. 2024 
X. Ruan et al., Conducted Electromagnetic Interference in Power Converters: Modeling, 
Prediction and Reduction, CPSS Power Electronics Series, 
https://doi.org/10.1007/978-981-99-9295-9_6 
97

98
6
Modeling of the Common-Mode Noise for Isolated DC-DC Converters
Fig. 6.1 The CM noise 
propagation path of isolated 
DC-DC converter
PE 
2iCM 
25Ω 
*
*
Primary 
circuit 
PG
SG 
Cp1 
Cps 
iCp1 
iCps 
vCM 
N 
A 
B 
C 
D 
Secondary 
rectifier 
and filter 
Fig. 6.2 A typical 
transformer winding 
structure 
WP1 WS1
WP2
WS2 
Primary
Secondary 
Axis of symmetry 
A
D
C
B
 
layers [1]. Besides, there are also winding-to-core capacitances, including WP1-to-
core capacitance and WP2-to-core capacitance. Since the impedance of the core is 
quite small compared to that of the winding-to-core capacitance, the WP1-to-core 
and WP2-to-core capacitances are connected in series, and they constitute the layer-
to-layer parasitic capacitance between WP1 and WP2. Therefore, the outmost layer 
WP1 and innermost layer WP2 can be treated as adjacent layers via the core, and there 
is displacement current between them [2]. 
Among these displacement currents, only the ones that ﬂow through the primary 
and secondary winding layers contribute to the CM noise. In Fig. 6.2, the displace-
ment currents ﬂowing through the inter-winding capacitance between WP1 and WS1 
as well as WP2 and WS2 generate the CM noise, and the displacement currents ﬂowing 
through the intra-winding capacitance between WS1 and WS2 as well as WP1 and WP2 
do not cause the CM noise. 
6.2.2 
The Displacement Current Flowing Through 
Inter-winding Capacitances 
When calculating the displacement current ﬂowing through the inter-winding capac-
itances, the current ﬂowing between every pair of adjacent primary- and secondary-
winding layers can be calculated ﬁrst and then added together. Suppose that the inter-
winding capacitance exists between M pairs of layers in the primary and secondary 
windings, and take the ith pair (1 ≤ i ≤ M) of winding layers WPi and WSi as an

6.2 A Generalized Lumped Capacitance Model
99
Fig. 6.3 The ith pair of the 
adjacent primary- and 
secondary-winding layers 
h 
WPi WSi 
Primary winding 
Secondary winding 
Insulation tape 
Graphic symbol: 
bi 
ai 
core 
…
… 
Pi2
Si2 
Pi1 
Si1 
example. As shown in Fig. 6.3, the displacement current ﬂowing between WPi and 
WSi is related to the inter-winding capacitance and the electric potential distribution 
along the windings. 
The inter-winding capacitance is associated with the dimensions of the winding 
layers and the medium between the layers. In Fig. 6.3, h is the height of the winding, bi 
is the distance between WPi and the axis of symmetry, and ai is the distance between 
WSi and the axis of symmetry. In this conﬁguration, a cylindrical capacitor between 
WPi and WSi is formed, which is commonly named as the structural capacitance 
between layers. When b S ubsc ri pt i Baseline minus a Subscript i Baseline much less than h, the structural capacitance C0i between these two 
layers is approximately given by [3] 
uppe r C Subscript 0 i Baseline equals StartFraction 2 normal pi epsilon 0 epsilon Subscript r Baseline h Over ln left parenthesis b Subscript i Baseline divided by a Subscript i Baseline right parenthesis EndFraction
upper C Subs
cript 0 i Baseline equals StartFraction 2 normal pi epsilon 0 epsilon Subscript r Baseline h Over ln left parenthesis b Subscript i Baseline divided by a Subscript i Baseline right parenthesis EndFraction
where, ε0 is the permittivity in the vacuum, and εr is the relative permittivity of the 
dielectric between the windings. 
Figure 6.4a shows the primary-winding layer WPi, where, Pi1 is the origin terminal, 
Pi2 is the end terminal, E is a point in the winding. By neglecting the leakage magnetic 
ﬂux and AC resistance caused by the skin effect and proximity effect, the electric 
potential varies linearly along the windings, as shown in Fig. 6.4b, where, vPi1 and 
vPi2 are the electric potential of Pi1 and Pi2 with respect to the PE, respectively, lWPi 
is the winding length from Pi1 to Pi2, and lE is the length from E to Pi2 along the 
winding.
According to Fig. 6.4b, the electric potential of point E can be expressed as 
v S ubscrip t upper E Baseline equals StartFraction v Subscript upper P i Baseline 1 Baseline minus v Subscript upper P i Baseline 2 Baseline Over l Subscript WP i Baseline EndFraction l Subscript upper E Baseline plus v Subscript upper P i Baseline 2
v Sub
scr ipt up
per E Baseline equals StartFraction v Subscript upper P i Baseline 1 Baseline minus v Subscript upper P i Baseline 2 Baseline Over l Subscript WP i Baseline EndFraction l Subscript upper E Baseline plus v Subscript upper P i Baseline 2
For the secondary-winding layer WSi, Si1 is the origin terminal, Si2 is the end terminal, 
and F is a point in the winding. The length from F to Si2 along the winding is denoted 
by lF, and the whole winding length from Si1 to Si2 is denoted by lWSi. Likewise, the 
electric potential of point F is given by

100
6
Modeling of the Common-Mode Noise for Isolated DC-DC Converters
lE
E 
Pi2 
Pi1 
0 
vPi1 
vPi2 
lWPi
lE 
vE 
(a) Winding structure
 (b) The electric potential along the
 windings. 
Fig. 6.4 The structure and electric potential distribution of the transformer winding
v S ubscrip t upper F Baseline equals StartFraction v Subscript upper S i Baseline 1 Baseline minus v Subscript upper S i Baseline 2 Baseline Over l Subscript WS i Baseline EndFraction l Subscript upper F Baseline plus v Subscript upper S i Baseline 2
v Sub
scr ipt up
per F Baseline equals StartFraction v Subscript upper S i Baseline 1 Baseline minus v Subscript upper S i Baseline 2 Baseline Over l Subscript WS i Baseline EndFraction l Subscript upper F Baseline plus v Subscript upper S i Baseline 2
The displacement current idis_i that ﬂows through WPi and WSi can be calculated 
with the superposition theory [4]. Firstly, the voltage of WSi is set to zero, and 
the displacement current ipri_i generated by WPi can be calculated. Secondly, the 
voltage of WPi is set to zero, and the displacement current isec_i caused by WSi can 
be obtained. Finally, the total displacement current idis_i can be obtained by adding 
ipri_i and isec_i together. Suppose that the inter-winding capacitance distributes evenly 
along the transformer windings, the capacitance between WPi with a unit length and 
WSi equals to C0i/lWPi, and the capacitance between WSi with a unit length and WPi 
equals to C0i/lWSi. Therefore, idis_i can be derived as 
i Subsc ript dis normal ba r 
i Ba
s
el
ine equals i Subscript pri normal bar i Baseline plus i Subscript secant normal bar i Baseline equals integral Subscript 0 Superscript l Subscript WP i Baseline Baseline StartFraction upper C Subscript 0 i Baseline Over l Subscript WP i Baseline EndFraction StartFraction d Over d t EndFraction left parenthesis v Subscript upper E Baseline minus 0 right parenthesis d l Subscript upper E Baseline plus integral Subscript 0 Superscript l Subscript WS i Baseline Baseline StartFraction upper C Subscript 0 i Baseline Over l Subscript WS i Baseline EndFraction StartFraction d Over d t EndFraction left parenthesis 0 minus v Subscript upper F Baseline right parenthesis d l Subscript upper F Baseline
i Sub
script dis normal bar i Baseline equals i Subscript pri normal bar i Baseline plus i Subscript secant normal bar i Baseline equals integral Subscript 0 Superscript l Subscript WP i Baseline Baseline StartFraction upper C Subscript 0 i Baseline Over l Subscript WP i Baseline EndFraction StartFraction d Over d t EndFraction left parenthesis v Subscript upper E Baseline minus 0 right parenthesis d l Subscript upper E Baseline plus integral Subscript 0 Superscript l Subscript WS i Baseline Baseline StartFraction upper C Subscript 0 i Baseline Over l Subscript WS i Baseline EndFraction StartFraction d Over d t EndFraction left parenthesis 0 minus v Subscript upper F Baseline right parenthesis d l Subscript upper F Baseline
i Subsc ript dis  n
orma
l
 b
ar i Baseline equals i Subscript pri normal bar i Baseline plus i Subscript secant normal bar i Baseline equals integral Subscript 0 Superscript l Subscript WP i Baseline Baseline StartFraction upper C Subscript 0 i Baseline Over l Subscript WP i Baseline EndFraction StartFraction d Over d t EndFraction left parenthesis v Subscript upper E Baseline minus 0 right parenthesis d l Subscript upper E Baseline plus integral Subscript 0 Superscript l Subscript WS i Baseline Baseline StartFraction upper C Subscript 0 i Baseline Over l Subscript WS i Baseline EndFraction StartFraction d Over d t EndFraction left parenthesis 0 minus v Subscript upper F Baseline right parenthesis d l Subscript upper F Baseline
i Sub
script dis normal bar i Baseline equals i Subscript pri normal bar i Baseline plus i Subscript secant normal bar i Baseline equals integral Subscript 0 Superscript l Subscript WP i Baseline Baseline StartFraction upper C Subscript 0 i Baseline Over l Subscript WP i Baseline EndFraction StartFraction d Over d t EndFraction left parenthesis v Subscript upper E Baseline minus 0 right parenthesis d l Subscript upper E Baseline plus integral Subscript 0 Superscript l Subscript WS i Baseline Baseline StartFraction upper C Subscript 0 i Baseline Over l Subscript WS i Baseline EndFraction StartFraction d Over d t EndFraction left parenthesis 0 minus v Subscript upper F Baseline right parenthesis d l Subscript upper F Baseline
i Subs cript di
s normal bar i Baseline equals i Subscript pri normal bar i Baseline plus i Subscript secant normal bar i Baseline equals integral Subscript 0 Superscript l Subscript WP i Baseline Baseline StartFraction upper C Subscript 0 i Baseline Over l Subscript WP i Baseline EndFraction StartFraction d Over d t EndFraction left parenthesis v Subscript upper E Baseline minus 0 right parenthesis d l Subscript upper E Baseline plus integral Subscript 0 Superscript l Subscript WS i Baseline Baseline StartFraction upper C Subscript 0 i Baseline Over l Subscript WS i Baseline EndFraction StartFraction d Over d t EndFraction left parenthesis 0 minus v Subscript upper F Baseline right parenthesis d l Subscript upper F Baseline
Substitution of (6.2) and (6.3) into (6.4), yields 
i Subsc ript d
is normal bar i Baseline equals upper C Subscript 0 i Baseline StartFraction d Over d t EndFraction left parenthesis StartFraction v Subscript upper P i Baseline 1 Baseline plus v Subscript upper P i Baseline 2 Baseline Over 2 EndFraction minus StartFraction v Subscript upper S i Baseline 1 Baseline plus v Subscript upper S i Baseline 2 Baseline Over 2 EndFraction right parenthesis equals upper C Subscript 0 i Baseline StartFraction d Over d t EndFraction left parenthesis ModifyingAbove v With quotation dash Subscript WP i Baseline minus ModifyingAbove v With quotation dash Subscript WS i Baseline right parenthesis
i 
Subscr ipt dis normal bar i Baseline equals upper C Subscript 0 i Baseline StartFraction d Over d t EndFraction left parenthesis StartFraction v Subscript upper P i Baseline 1 Baseline plus v Subscript upper P i Baseline 2 Baseline Over 2 EndFraction minus StartFraction v Subscript upper S i Baseline 1 Baseline plus v Subscript upper S i Baseline 2 Baseline Over 2 EndFraction right parenthesis equals upper C Subscript 0 i Baseline StartFraction d Over d t EndFraction left parenthesis ModifyingAbove v With quotation dash Subscript WP i Baseline minus ModifyingAbove v With quotation dash Subscript WS i Baseline right parenthesis
i
 Subscr ipt dis normal bar i Baseline equals upper C Subscript 0 i Baseline StartFraction d Over d t EndFraction left parenthesis StartFraction v Subscript upper P i Baseline 1 Baseline plus v Subscript upper P i Baseline 2 Baseline Over 2 EndFraction minus StartFraction v Subscript upper S i Baseline 1 Baseline plus v Subscript upper S i Baseline 2 Baseline Over 2 EndFraction right parenthesis equals upper C Subscript 0 i Baseline StartFraction d Over d t EndFraction left parenthesis ModifyingAbove v With quotation dash Subscript WP i Baseline minus ModifyingAbove v With quotation dash Subscript WS i Baseline right parenthesis
i
 
Subscr
ipt dis normal bar i Baseline equals upper C Subscript 0 i Baseline StartFraction d Over d t EndFraction left parenthesis StartFraction v Subscript upper P i Baseline 1 Baseline plus v Subscript upper P i Baseline 2 Baseline Over 2 EndFraction minus StartFraction v Subscript upper S i Baseline 1 Baseline plus v Subscript upper S i Baseline 2 Baseline Over 2 EndFraction right parenthesis equals upper C Subscript 0 i Baseline StartFraction d Over d t EndFraction left parenthesis ModifyingAbove v With quotation dash Subscript WP i Baseline minus ModifyingAbove v With quotation dash Subscript WS i Baseline right parenthesis
i Subscript dis normal bar i Baseline equals upper C Subscript 0 i Baseline StartFraction d Over d t EndFraction left parenthesis StartFraction v Subscript upper P i Baseline 1 Baseline plus v Subscript upper P i Baseline 2 Baseline Over 2 EndFraction minus StartFraction v Subscript upper S i Baseline 1 Baseline plus v Subscript upper S i Baseline 2 Baseline Over 2 EndFraction right parenthesis equals upper C Subscript 0 i Baseline StartFraction d Over d t EndFraction left parenthesis ModifyingAbove v With quotation dash Subscript WP i Baseline minus ModifyingAbove v With quotation dash Subscript WS i Baseline right parenthesisi Sub script dis normal bar i Baseline equals upper C Subscript 0 i Baseline StartFraction d Over d t EndFraction left parenthesis StartFraction v Subscript upper P i Baseline 1 Baseline plus v Subscript upper P i Baseline 2 Baseline Over 2 EndFraction minus StartFraction v Subscript upper S i Baseline 1 Baseline plus v Subscript upper S i Baseline 2 Baseline Over 2 EndFraction right parenthesis equals upper C Subscript 0 i Baseline StartFraction d Over d t EndFraction left parenthesis ModifyingAbove v With quotation dash Subscript WP i Baseline minus ModifyingAbove v With quotation dash Subscript WS i Baseline right parenthesisi Subs
cript dis normal bar i Baseline equals upper C Subscript 0 i Baseline StartFraction d Over d t EndFraction left parenthesis StartFraction v Subscript upper P i Baseline 1 Baseline plus v Subscript upper P i Baseline 2 Baseline Over 2 EndFraction minus StartFraction v Subscript upper S i Baseline 1 Baseline plus v Subscript upper S i Baseline 2 Baseline Over 2 EndFraction right parenthesis equals upper C Subscript 0 i Baseline StartFraction d Over d t EndFraction left parenthesis ModifyingAbove v With quotation dash Subscript WP i Baseline minus ModifyingAbove v With quotation dash Subscript WS i Baseline right parenthesis
where, ModifyingAbove v With quotation dash Subscript WP i = (vPi1 + vPi2)/2, ModifyingAbove v With quotation dash Subscript WS i = (vSi1 + vSi2)/2, and they represent the averaged 
electric potential (AEP) of winding layers WPi and WSi, respectively. 
Based on (6.5), the total displacement current idis ﬂowing through M pairs of 
adjacent primary- and secondary-winding layers are obtained as 
i Sub sc
r
i
pt d
is Base li
n
e
 equ
als 
sigma summation Underscript i equals 1 Overscript upper M Endscripts i Subscript dis normal bar i Baseline equals sigma summation Underscript i equals 1 Overscript upper M Endscripts upper C Subscript 0 i Baseline StartFraction d Over d t EndFraction left parenthesis ModifyingAbove v With quotation dash Subscript WP i Baseline minus ModifyingAbove v With quotation dash Subscript WS i Baseline right parenthesis
i Subscript dis Baseline equals sigma summation Underscript i equals 1 Overscript upper M Endscripts i Subscript dis normal bar i Baseline equals sigma summation Underscript i equals 1 Overscript upper M Endscripts upper C Subscript 0 i Baseline StartFraction d Over d t EndFraction left parenthesis ModifyingAbove v With quotation dash Subscript WP i Baseline minus ModifyingAbove v With quotation dash Subscript WS i Baseline right parenthesisi Sub script dis Baseline equals sigma summation Underscript i equals 1 Overscript upper M Endscripts i Subscript dis normal bar i Baseline equals sigma summation Underscript i equals 1 Overscript upper M Endscripts upper C Subscript 0 i Baseline StartFraction d Over d t EndFraction left parenthesis ModifyingAbove v With quotation dash Subscript WP i Baseline minus ModifyingAbove v With quotation dash Subscript WS i Baseline right parenthesisi Subs
cript dis Baseline equals sigma summation Underscript i equals 1 Overscript upper M Endscripts i Subscript dis normal bar i Baseline equals sigma summation Underscript i equals 1 Overscript upper M Endscripts upper C Subscript 0 i Baseline StartFraction d Over d t EndFraction left parenthesis ModifyingAbove v With quotation dash Subscript WP i Baseline minus ModifyingAbove v With quotation dash Subscript WS i Baseline right parenthesis
For the primary winding, A and B denote the origin- and end-terminals, respectively, 
and the turns from points Pi1, Pi2 to terminal B are represented by NPi1 and NPi2.

6.2 A Generalized Lumped Capacitance Model
101
Likewise, for the secondary winding, C and D denote the origin- and end-terminals, 
respectively, and the turns from points Si1, Si2 to terminal D are represented by NSi1 
and NSi2. According to linear variation of the electric potential along the length of 
windings, the voltage drop of each turn of the windings is the same. Hence, we have
S
tartL ay out Enlarged left brace 1st Row v Subscript upper P i Baseline 1 Baseline equals StartFraction v Subscript upper A Baseline minus v Subscript upper B Baseline Over upper N Subscript upper P Baseline EndFraction upper N Subscript upper P i Baseline 1 Baseline plus v Subscript upper B Baseline comma v Subscript upper P i Baseline 2 Baseline equals StartFraction v Subscript upper A Baseline minus v Subscript upper B Baseline Over upper N Subscript upper P Baseline EndFraction upper N Subscript upper P i Baseline 2 Baseline plus v Subscript upper B Baseline 2nd Row v Subscript upper S i Baseline 1 Baseline equals StartFraction v Subscript upper C Baseline minus v Subscript upper D Baseline Over upper N Subscript upper S Baseline EndFraction upper N Subscript upper S i Baseline 1 Baseline plus v Subscript upper D Baseline comma v Subscript upper S i Baseline 2 Baseline equals StartFraction v Subscript upper C Baseline minus v Subscript upper D Baseline Over upper N Subscript upper S Baseline EndFraction upper N Subscript upper S i Baseline 2 Baseline plus v Subscript upper D Baseline EndLayout
Sta
rtLay out Enlarg ed  left brace 1st Row v Subscript upper P i Baseline 1 Baseline equals StartFraction v Subscript upper A Baseline minus v Subscript upper B Baseline Over upper N Subscript upper P Baseline EndFraction upper N Subscript upper P i Baseline 1 Baseline plus v Subscript upper B Baseline comma v Subscript upper P i Baseline 2 Baseline equals StartFraction v Subscript upper A Baseline minus v Subscript upper B Baseline Over upper N Subscript upper P Baseline EndFraction upper N Subscript upper P i Baseline 2 Baseline plus v Subscript upper B Baseline 2nd Row v Subscript upper S i Baseline 1 Baseline equals StartFraction v Subscript upper C Baseline minus v Subscript upper D Baseline Over upper N Subscript upper S Baseline EndFraction upper N Subscript upper S i Baseline 1 Baseline plus v Subscript upper D Baseline comma v Subscript upper S i Baseline 2 Baseline equals StartFraction v Subscript upper C Baseline minus v Subscript upper D Baseline Over upper N Subscript upper S Baseline EndFraction upper N Subscript upper S i Baseline 2 Baseline plus v Subscript upper D Baseline EndLayout
Sta
rtLay out E
nlarg ed  left brace 1st Row v Subscript upper P i Baseline 1 Baseline equals StartFraction v Subscript upper A Baseline minus v Subscript upper B Baseline Over upper N Subscript upper P Baseline EndFraction upper N Subscript upper P i Baseline 1 Baseline plus v Subscript upper B Baseline comma v Subscript upper P i Baseline 2 Baseline equals StartFraction v Subscript upper A Baseline minus v Subscript upper B Baseline Over upper N Subscript upper P Baseline EndFraction upper N Subscript upper P i Baseline 2 Baseline plus v Subscript upper B Baseline 2nd Row v Subscript upper S i Baseline 1 Baseline equals StartFraction v Subscript upper C Baseline minus v Subscript upper D Baseline Over upper N Subscript upper S Baseline EndFraction upper N Subscript upper S i Baseline 1 Baseline plus v Subscript upper D Baseline comma v Subscript upper S i Baseline 2 Baseline equals StartFraction v Subscript upper C Baseline minus v Subscript upper D Baseline Over upper N Subscript upper S Baseline EndFraction upper N Subscript upper S i Baseline 2 Baseline plus v Subscript upper D Baseline EndLayout
Sta
rtLay out Enlarg ed  left brace 1st Row v Subscript upper P i Baseline 1 Baseline equals StartFraction v Subscript upper A Baseline minus v Subscript upper B Baseline Over upper N Subscript upper P Baseline EndFraction upper N Subscript upper P i Baseline 1 Baseline plus v Subscript upper B Baseline comma v Subscript upper P i Baseline 2 Baseline equals StartFraction v Subscript upper A Baseline minus v Subscript upper B Baseline Over upper N Subscript upper P Baseline EndFraction upper N Subscript upper P i Baseline 2 Baseline plus v Subscript upper B Baseline 2nd Row v Subscript upper S i Baseline 1 Baseline equals StartFraction v Subscript upper C Baseline minus v Subscript upper D Baseline Over upper N Subscript upper S Baseline EndFraction upper N Subscript upper S i Baseline 1 Baseline plus v Subscript upper D Baseline comma v Subscript upper S i Baseline 2 Baseline equals StartFraction v Subscript upper C Baseline minus v Subscript upper D Baseline Over upper N Subscript upper S Baseline EndFraction upper N Subscript upper S i Baseline 2 Baseline plus v Subscript upper D Baseline EndLayout
Sta
rtLay out E
nlarged left brace 1st Row v Subscript upper P i Baseline 1 Baseline equals StartFraction v Subscript upper A Baseline minus v Subscript upper B Baseline Over upper N Subscript upper P Baseline EndFraction upper N Subscript upper P i Baseline 1 Baseline plus v Subscript upper B Baseline comma v Subscript upper P i Baseline 2 Baseline equals StartFraction v Subscript upper A Baseline minus v Subscript upper B Baseline Over upper N Subscript upper P Baseline EndFraction upper N Subscript upper P i Baseline 2 Baseline plus v Subscript upper B Baseline 2nd Row v Subscript upper S i Baseline 1 Baseline equals StartFraction v Subscript upper C Baseline minus v Subscript upper D Baseline Over upper N Subscript upper S Baseline EndFraction upper N Subscript upper S i Baseline 1 Baseline plus v Subscript upper D Baseline comma v Subscript upper S i Baseline 2 Baseline equals StartFraction v Subscript upper C Baseline minus v Subscript upper D Baseline Over upper N Subscript upper S Baseline EndFraction upper N Subscript upper S i Baseline 2 Baseline plus v Subscript upper D Baseline EndLayout
where, NP and NS are the total turns number of the primary and secondary windings, 
respectively, and vB and vD are the electric potential of the terminals B and D, 
respectively. 
According to (6.7), we have
StartLayout Enlarged left brace 1st Row ModifyingAbove v With quotation dash Subscript WP i Baseline equals left parenthesis v Subscript upper P i normal bar 1 Baseline plus v Subscript upper P i normal bar 2 Baseline right parenthesis divided by 2 equals lamda Subscript upper P i Baseline v Subscript upper A Baseline plus left parenthesis 1 minus lamda Subscript upper P i Baseline right parenthesis v Subscript upper B Baseline 2nd Row ModifyingAbove v With quotation dash Subscript WS i Baseline equals left parenthesis v Subscript upper S i normal bar 1 Baseline plus v Subscript upper S i normal bar 2 Baseline right parenthesis divided by 2 equals lamda Subscript upper S i Baseline v Subscript upper C Baseline plus left parenthesis 1 minus lamda Subscript upper S i Baseline right parenthesis v Subscript upper D EndLayoutStart L
a
yout E nlarged
 
lef t brace 1 st Ro w ModifyingAbove v With quotation dash Subscript WP i Baseline equals left parenthesis v Subscript upper P i normal bar 1 Baseline plus v Subscript upper P i normal bar 2 Baseline right parenthesis divided by 2 equals lamda Subscript upper P i Baseline v Subscript upper A Baseline plus left parenthesis 1 minus lamda Subscript upper P i Baseline right parenthesis v Subscript upper B Baseline 2nd Row ModifyingAbove v With quotation dash Subscript WS i Baseline equals left parenthesis v Subscript upper S i normal bar 1 Baseline plus v Subscript upper S i normal bar 2 Baseline right parenthesis divided by 2 equals lamda Subscript upper S i Baseline v Subscript upper C Baseline plus left parenthesis 1 minus lamda Subscript upper S i Baseline right parenthesis v Subscript upper D EndLayout
Start L
a
yout E nlarged
 
lef t brace 1 st Ro w Modifyin
gAbove v With quotation dash Subscript WP i Baseline equals left parenthesis v Subscript upper P i normal bar 1 Baseline plus v Subscript upper P i normal bar 2 Baseline right parenthesis divided by 2 equals lamda Subscript upper P i Baseline v Subscript upper A Baseline plus left parenthesis 1 minus lamda Subscript upper P i Baseline right parenthesis v Subscript upper B Baseline 2nd Row ModifyingAbove v With quotation dash Subscript WS i Baseline equals left parenthesis v Subscript upper S i normal bar 1 Baseline plus v Subscript upper S i normal bar 2 Baseline right parenthesis divided by 2 equals lamda Subscript upper S i Baseline v Subscript upper C Baseline plus left parenthesis 1 minus lamda Subscript upper S i Baseline right parenthesis v Subscript upper D EndLayout
where, the coefﬁcient λPi and λSi are expressed as
S
tart La yout Enlarged left brace 1st Row lamda Subscript upper P i Baseline equals StartFraction upper N Subscript upper P i Baseline 1 Baseline plus upper N Subscript upper P i Baseline 2 Baseline Over 2 upper N Subscript upper P Baseline EndFraction 2nd Row lamda Subscript upper S i Baseline equals StartFraction upper N Subscript upper S i Baseline 1 Baseline plus upper N Subscript upper S i Baseline 2 Baseline Over 2 upper N Subscript upper S Baseline EndFraction EndLayout
Star
tLay ou t Enlarged left brace 1st Row lamda Subscript upper P i Baseline equals StartFraction upper N Subscript upper P i Baseline 1 Baseline plus upper N Subscript upper P i Baseline 2 Baseline Over 2 upper N Subscript upper P Baseline EndFraction 2nd Row lamda Subscript upper S i Baseline equals StartFraction upper N Subscript upper S i Baseline 1 Baseline plus upper N Subscript upper S i Baseline 2 Baseline Over 2 upper N Subscript upper S Baseline EndFraction EndLayout
Star
tLayout Enlarged left brace 1st Row lamda Subscript upper P i Baseline equals StartFraction upper N Subscript upper P i Baseline 1 Baseline plus upper N Subscript upper P i Baseline 2 Baseline Over 2 upper N Subscript upper P Baseline EndFraction 2nd Row lamda Subscript upper S i Baseline equals StartFraction upper N Subscript upper S i Baseline 1 Baseline plus upper N Subscript upper S i Baseline 2 Baseline Over 2 upper N Subscript upper S Baseline EndFraction EndLayout
According to (6.9), it is obvious that 0 < λPi < 1 and 0 < λSi < 1.  
Substituting (6.8) into (6.6), yields 
i Sub scrip
t dis Baseline equals upper C 0 StartFraction d Over d t EndFraction left bracket lamda Subscript upper P Baseline v Subscript upper A Baseline plus left parenthesis 1 minus lamda Subscript upper P Baseline right parenthesis v Subscript upper B Baseline right bracket minus upper C 0 StartFraction d Over d t EndFraction left bracket lamda Subscript upper S Baseline v Subscript upper C Baseline plus left parenthesis 1 minus lamda Subscript upper S Baseline right parenthesis v Subscript upper D Baseline right bracket
i Subscri pt di s Baselin e equ
als upper C 0 StartFraction d Over d t EndFraction left bracket lamda Subscript upper P Baseline v Subscript upper A Baseline plus left parenthesis 1 minus lamda Subscript upper P Baseline right parenthesis v Subscript upper B Baseline right bracket minus upper C 0 StartFraction d Over d t EndFraction left bracket lamda Subscript upper S Baseline v Subscript upper C Baseline plus left parenthesis 1 minus lamda Subscript upper S Baseline right parenthesis v Subscript upper D Baseline right bracket
i Subscri pt di s Baseli
ne equals upper C 0 StartFraction d Over d t EndFraction left bracket lamda Subscript upper P Baseline v Subscript upper A Baseline plus left parenthesis 1 minus lamda Subscript upper P Baseline right parenthesis v Subscript upper B Baseline right bracket minus upper C 0 StartFraction d Over d t EndFraction left bracket lamda Subscript upper S Baseline v Subscript upper C Baseline plus left parenthesis 1 minus lamda Subscript upper S Baseline right parenthesis v Subscript upper D Baseline right bracket
where, C0, λA and λC are given by 
S
tartLayo
ut Enlar
ged  l
e
f
t br
ace 
1st  R ow upper C 0 equals sigma summation Underscript i equals 1 Overscript upper M Endscripts upper C Subscript 0 i Baseline 2nd Row lamda Subscript upper P Baseline equals StartFraction 1 Over upper C 0 EndFraction sigma summation Underscript i equals 1 Overscript upper M Endscripts lamda Subscript upper P i Baseline upper C Subscript 0 i Baseline 3rd Row lamda Subscript upper S Baseline equals StartFraction 1 Over upper C 0 EndFraction sigma summation Underscript i equals 1 Overscript upper M Endscripts lamda Subscript upper S i Baseline upper C Subscript 0 i Baseline EndLayout
Sta
r
t
Layo
ut Enla
rge d left brace 1st Row upper C 0 equals sigma summation Underscript i equals 1 Overscript upper M Endscripts upper C Subscript 0 i Baseline 2nd Row lamda Subscript upper P Baseline equals StartFraction 1 Over upper C 0 EndFraction sigma summation Underscript i equals 1 Overscript upper M Endscripts lamda Subscript upper P i Baseline upper C Subscript 0 i Baseline 3rd Row lamda Subscript upper S Baseline equals StartFraction 1 Over upper C 0 EndFraction sigma summation Underscript i equals 1 Overscript upper M Endscripts lamda Subscript upper S i Baseline upper C Subscript 0 i Baseline EndLayout
Sta
r
t
Layo
ut Enla
rged left brace 1st Row upper C 0 equals sigma summation Underscript i equals 1 Overscript upper M Endscripts upper C Subscript 0 i Baseline 2nd Row lamda Subscript upper P Baseline equals StartFraction 1 Over upper C 0 EndFraction sigma summation Underscript i equals 1 Overscript upper M Endscripts lamda Subscript upper P i Baseline upper C Subscript 0 i Baseline 3rd Row lamda Subscript upper S Baseline equals StartFraction 1 Over upper C 0 EndFraction sigma summation Underscript i equals 1 Overscript upper M Endscripts lamda Subscript upper S i Baseline upper C Subscript 0 i Baseline EndLayout
According to (6.11), C0 is the structural capacitance of the transformer, which 
equals to the sum of C0i; λP and λS are deﬁned as the winding structural parameters, 
which are related to the winding structure. According to (6.9) and (6.11), λP and λS 
are in the range of (0, 1).

102
6
Modeling of the Common-Mode Noise for Isolated DC-DC Converters
6.2.3 
The General Lumped Capacitance Model 
of the Transformer 
Owing to the complexity of inter-winding capacitance, the lumped capacitance 
model, as shown in Fig. 6.5, is usually adopted for circuit analysis, which includes 
six lumped capacitances between every two terminals in the transformer. Since the 
displacement currents ﬂowing through CAB and CCD do not generate CM noise, 
CAB and CCD are neglected in the following analysis. In this section, the relation-
ship between the parameters in (6.11) for the inter-winding capacitance and the four 
lumped capacitance will be established. 
In Fig. 6.5, the total displacement current that ﬂows through CAC, CAD, CBC and 
CBD can be derived as 
Start Layout
 1st Row 1st Column i Subscript dis 2nd Column equals upper C Subscript AC Baseline StartFraction d Over d t EndFraction left parenthesis v Subscript upper A Baseline minus v Subscript upper C Baseline right parenthesis plus upper C Subscript AD Baseline StartFraction d Over d t EndFraction left parenthesis v Subscript upper A Baseline minus v Subscript upper D Baseline right parenthesis plus upper C Subscript BC Baseline StartFraction d Over d t EndFraction left parenthesis v Subscript upper B Baseline minus v Subscript upper C Baseline right parenthesis plus upper C Subscript BD Baseline StartFraction d Over d t EndFraction left parenthesis v Subscript upper B Baseline minus v Subscript upper D Baseline right parenthesis 2nd Row 1st Column Blank 2nd Column equals left parenthesis upper C Subscript AC Baseline plus upper C Subscript AD Baseline right parenthesis StartFraction d v Subscript upper A Baseline Over d t EndFraction plus left parenthesis upper C Subscript BC Baseline plus upper C Subscript BD Baseline right parenthesis StartFraction d v Subscript upper B Baseline Over d t EndFraction minus left parenthesis upper C Subscript AC Baseline plus upper C Subscript BC Baseline right parenthesis StartFraction d v Subscript upper C Baseline Over d t EndFraction minus left parenthesis upper C Subscript AD Baseline plus upper C Subscript BD Baseline right parenthesis StartFraction d v Subscript upper D Baseline Over d t EndFraction EndLayout
Sta rtLa yout 1st Row
 1st Column i Subscript dis 2nd Column equals upper C Subscript AC Baseline StartFraction d Over d t EndFraction left parenthesis v Subscript upper A Baseline minus v Subscript upper C Baseline right parenthesis plus upper C Subscript AD Baseline StartFraction d Over d t EndFraction left parenthesis v Subscript upper A Baseline minus v Subscript upper D Baseline right parenthesis plus upper C Subscript BC Baseline StartFraction d Over d t EndFraction left parenthesis v Subscript upper B Baseline minus v Subscript upper C Baseline right parenthesis plus upper C Subscript BD Baseline StartFraction d Over d t EndFraction left parenthesis v Subscript upper B Baseline minus v Subscript upper D Baseline right parenthesis 2nd Row 1st Column Blank 2nd Column equals left parenthesis upper C Subscript AC Baseline plus upper C Subscript AD Baseline right parenthesis StartFraction d v Subscript upper A Baseline Over d t EndFraction plus left parenthesis upper C Subscript BC Baseline plus upper C Subscript BD Baseline right parenthesis StartFraction d v Subscript upper B Baseline Over d t EndFraction minus left parenthesis upper C Subscript AC Baseline plus upper C Subscript BC Baseline right parenthesis StartFraction d v Subscript upper C Baseline Over d t EndFraction minus left parenthesis upper C Subscript AD Baseline plus upper C Subscript BD Baseline right parenthesis StartFraction d v Subscript upper D Baseline Over d t EndFraction EndLayout
Sta rtLa yout 1st Row
 1st Column i Subscript dis 2nd Column equals upper C Subscript AC Baseline StartFraction d Over d t EndFraction left parenthesis v Subscript upper A Baseline minus v Subscript upper C Baseline right parenthesis plus upper C Subscript AD Baseline StartFraction d Over d t EndFraction left parenthesis v Subscript upper A Baseline minus v Subscript upper D Baseline right parenthesis plus upper C Subscript BC Baseline StartFraction d Over d t EndFraction left parenthesis v Subscript upper B Baseline minus v Subscript upper C Baseline right parenthesis plus upper C Subscript BD Baseline StartFraction d Over d t EndFraction left parenthesis v Subscript upper B Baseline minus v Subscript upper D Baseline right parenthesis 2nd Row 1st Column Blank 2nd Column equals left parenthesis upper C Subscript AC Baseline plus upper C Subscript AD Baseline right parenthesis StartFraction d v Subscript upper A Baseline Over d t EndFraction plus left parenthesis upper C Subscript BC Baseline plus upper C Subscript BD Baseline right parenthesis StartFraction d v Subscript upper B Baseline Over d t EndFraction minus left parenthesis upper C Subscript AC Baseline plus upper C Subscript BC Baseline right parenthesis StartFraction d v Subscript upper C Baseline Over d t EndFraction minus left parenthesis upper C Subscript AD Baseline plus upper C Subscript BD Baseline right parenthesis StartFraction d v Subscript upper D Baseline Over d t EndFraction EndLayout
Sta rtLa yout 1st Row
 1st Column i Subscript dis 2nd Column equals upper C Subscript AC Baseline StartFraction d Over d t EndFraction left parenthesis v Subscript upper A Baseline minus v Subscript upper C Baseline right parenthesis plus upper C Subscript AD Baseline StartFraction d Over d t EndFraction left parenthesis v Subscript upper A Baseline minus v Subscript upper D Baseline right parenthesis plus upper C Subscript BC Baseline StartFraction d Over d t EndFraction left parenthesis v Subscript upper B Baseline minus v Subscript upper C Baseline right parenthesis plus upper C Subscript BD Baseline StartFraction d Over d t EndFraction left parenthesis v Subscript upper B Baseline minus v Subscript upper D Baseline right parenthesis 2nd Row 1st Column Blank 2nd Column equals left parenthesis upper C Subscript AC Baseline plus upper C Subscript AD Baseline right parenthesis StartFraction d v Subscript upper A Baseline Over d t EndFraction plus left parenthesis upper C Subscript BC Baseline plus upper C Subscript BD Baseline right parenthesis StartFraction d v Subscript upper B Baseline Over d t EndFraction minus left parenthesis upper C Subscript AC Baseline plus upper C Subscript BC Baseline right parenthesis StartFraction d v Subscript upper C Baseline Over d t EndFraction minus left parenthesis upper C Subscript AD Baseline plus upper C Subscript BD Baseline right parenthesis StartFraction d v Subscript upper D Baseline Over d t EndFraction EndLayout
Sta rtLa yout 1
st Row 1st Column i Subscript dis 2nd Column equals upper C Subscript AC Baseline StartFraction d Over d t EndFraction left parenthesis v Subscript upper A Baseline minus v Subscript upper C Baseline right parenthesis plus upper C Subscript AD Baseline StartFraction d Over d t EndFraction left parenthesis v Subscript upper A Baseline minus v Subscript upper D Baseline right parenthesis plus upper C Subscript BC Baseline StartFraction d Over d t EndFraction left parenthesis v Subscript upper B Baseline minus v Subscript upper C Baseline right parenthesis plus upper C Subscript BD Baseline StartFraction d Over d t EndFraction left parenthesis v Subscript upper B Baseline minus v Subscript upper D Baseline right parenthesis 2nd Row 1st Column Blank 2nd Column equals left parenthesis upper C Subscript AC Baseline plus upper C Subscript AD Baseline right parenthesis StartFraction d v Subscript upper A Baseline Over d t EndFraction plus left parenthesis upper C Subscript BC Baseline plus upper C Subscript BD Baseline right parenthesis StartFraction d v Subscript upper B Baseline Over d t EndFraction minus left parenthesis upper C Subscript AC Baseline plus upper C Subscript BC Baseline right parenthesis StartFraction d v Subscript upper C Baseline Over d t EndFraction minus left parenthesis upper C Subscript AD Baseline plus upper C Subscript BD Baseline right parenthesis StartFraction d v Subscript upper D Baseline Over d t EndFraction EndLayout
Sta rtLayou t 1st Row 1st Column i Subscript dis 2nd Column equals upper C Subscript AC Baseline StartFraction d Over d t EndFraction left parenthesis v Subscript upper A Baseline minus v Subscript upper C Baseline right parenthesis plus upper C Subscript AD Baseline StartFraction d Over d t EndFraction left parenthesis v Subscript upper A Baseline minus v Subscript upper D Baseline right parenthesis plus upper C Subscript BC Baseline StartFraction d Over d t EndFraction left parenthesis v Subscript upper B Baseline minus v Subscript upper C Baseline right parenthesis plus upper C Subscript BD Baseline StartFraction d Over d t EndFraction left parenthesis v Subscript upper B Baseline minus v Subscript upper D Baseline right parenthesis 2nd Row 1st Column Blank 2nd Column equals left parenthesis upper C Subscript AC Baseline plus upper C Subscript AD Baseline right parenthesis StartFraction d v Subscript upper A Baseline Over d t EndFraction plus left parenthesis upper C Subscript BC Baseline plus upper C Subscript BD Baseline right parenthesis StartFraction d v Subscript upper B Baseline Over d t EndFraction minus left parenthesis upper C Subscript AC Baseline plus upper C Subscript BC Baseline right parenthesis StartFraction d v Subscript upper C Baseline Over d t EndFraction minus left parenthesis upper C Subscript AD Baseline plus upper C Subscript BD Baseline right parenthesis StartFraction d v Subscript upper D Baseline Over d t EndFraction EndLayout
Sta rtLayou t 1st Row 1st Column i Subscript dis 2nd Column equals upper C Subscript AC Baseline StartFraction d Over d t EndFraction left parenthesis v Subscript upper A Baseline minus v Subscript upper C Baseline right parenthesis plus upper C Subscript AD Baseline StartFraction d Over d t EndFraction left parenthesis v Subscript upper A Baseline minus v Subscript upper D Baseline right parenthesis plus upper C Subscript BC Baseline StartFraction d Over d t EndFraction left parenthesis v Subscript upper B Baseline minus v Subscript upper C Baseline right parenthesis plus upper C Subscript BD Baseline StartFraction d Over d t EndFraction left parenthesis v Subscript upper B Baseline minus v Subscript upper D Baseline right parenthesis 2nd Row 1st Column Blank 2nd Column equals left parenthesis upper C Subscript AC Baseline plus upper C Subscript AD Baseline right parenthesis StartFraction d v Subscript upper A Baseline Over d t EndFraction plus left parenthesis upper C Subscript BC Baseline plus upper C Subscript BD Baseline right parenthesis StartFraction d v Subscript upper B Baseline Over d t EndFraction minus left parenthesis upper C Subscript AC Baseline plus upper C Subscript BC Baseline right parenthesis StartFraction d v Subscript upper C Baseline Over d t EndFraction minus left parenthesis upper C Subscript AD Baseline plus upper C Subscript BD Baseline right parenthesis StartFraction d v Subscript upper D Baseline Over d t EndFraction EndLayout
Sta rtLayou t 1st Row 1st Column i Subscript dis 2nd Column equals upper C Subscript AC Baseline StartFraction d Over d t EndFraction left parenthesis v Subscript upper A Baseline minus v Subscript upper C Baseline right parenthesis plus upper C Subscript AD Baseline StartFraction d Over d t EndFraction left parenthesis v Subscript upper A Baseline minus v Subscript upper D Baseline right parenthesis plus upper C Subscript BC Baseline StartFraction d Over d t EndFraction left parenthesis v Subscript upper B Baseline minus v Subscript upper C Baseline right parenthesis plus upper C Subscript BD Baseline StartFraction d Over d t EndFraction left parenthesis v Subscript upper B Baseline minus v Subscript upper D Baseline right parenthesis 2nd Row 1st Column Blank 2nd Column equals left parenthesis upper C Subscript AC Baseline plus upper C Subscript AD Baseline right parenthesis StartFraction d v Subscript upper A Baseline Over d t EndFraction plus left parenthesis upper C Subscript BC Baseline plus upper C Subscript BD Baseline right parenthesis StartFraction d v Subscript upper B Baseline Over d t EndFraction minus left parenthesis upper C Subscript AC Baseline plus upper C Subscript BC Baseline right parenthesis StartFraction d v Subscript upper C Baseline Over d t EndFraction minus left parenthesis upper C Subscript AD Baseline plus upper C Subscript BD Baseline right parenthesis StartFraction d v Subscript upper D Baseline Over d t EndFraction EndLayout
Sta
rtLayout 1st Row 1st Column i Subscript dis 2nd Column equals upper C Subscript AC Baseline StartFraction d Over d t EndFraction left parenthesis v Subscript upper A Baseline minus v Subscript upper C Baseline right parenthesis plus upper C Subscript AD Baseline StartFraction d Over d t EndFraction left parenthesis v Subscript upper A Baseline minus v Subscript upper D Baseline right parenthesis plus upper C Subscript BC Baseline StartFraction d Over d t EndFraction left parenthesis v Subscript upper B Baseline minus v Subscript upper C Baseline right parenthesis plus upper C Subscript BD Baseline StartFraction d Over d t EndFraction left parenthesis v Subscript upper B Baseline minus v Subscript upper D Baseline right parenthesis 2nd Row 1st Column Blank 2nd Column equals left parenthesis upper C Subscript AC Baseline plus upper C Subscript AD Baseline right parenthesis StartFraction d v Subscript upper A Baseline Over d t EndFraction plus left parenthesis upper C Subscript BC Baseline plus upper C Subscript BD Baseline right parenthesis StartFraction d v Subscript upper B Baseline Over d t EndFraction minus left parenthesis upper C Subscript AC Baseline plus upper C Subscript BC Baseline right parenthesis StartFraction d v Subscript upper C Baseline Over d t EndFraction minus left parenthesis upper C Subscript AD Baseline plus upper C Subscript BD Baseline right parenthesis StartFraction d v Subscript upper D Baseline Over d t EndFraction EndLayout
where, vA, vB, vC and vD are the electric potentials of the transformer winding 
terminals with respect to the PE. 
Based on the displacement current consistency, a set of linear algebraic equations 
can be obtained by equalizing (6.10) and (6.12), i.e., 
Mo
dify
i n g B e
l o w  S
t a rt  4
 B y 4  
Ma
tri
x 1st Row 1st Column 1 2nd Column 1 3rd Column 0 4th Column 0 2nd Row 1st Column 0 2nd Column 0 3rd Column 1 4th Column 1 3rd Row 1st Column 1 2nd Column 0 3rd Column 1 4th Column 0 4th Row 1st Column 0 2nd Column 1 3rd Column 0 4th Column 1 EndMatrix With bottom brace Underscript bold italic upper A Subscript upper N Baseline Endscripts Start 4 By 1 Matrix 1st Row upper C Subscript AC Baseline 2nd Row upper C Subscript AD Baseline 3rd Row upper C Subscript BC Baseline 4th Row upper C Subscript BD Baseline EndMatrix equals ModifyingBelow Start 4 By 1 Matrix 1st Row lamda Subscript upper P Baseline upper C 0 2nd Row left parenthesis 1 minus lamda Subscript upper P Baseline right parenthesis upper C 0 3rd Row lamda Subscript upper S Baseline upper C 0 4th Row left parenthesis 1 minus lamda Subscript upper S Baseline right parenthesis upper C 0 EndMatrix With bottom brace Underscript bold italic upper D left parenthesis upper C 0 right parenthesis Endscripts
ModifyingBelow Start 4 By 4 Matrix 1st Row 1st Column 1 2nd Column 1 3rd Column 0 4th Column 0 2nd Row 1st Column 0 2nd Column 0 3rd Column 1 4th Column 1 3rd Row 1st Column 1 2nd Column 0 3rd Column 1 4th Column 0 4th Row 1st Column 0 2nd Column 1 3rd Column 0 4th Column 1 EndMatrix With bottom brace Underscript bold italic upper A Subscript upper N Baseline Endscripts Start 4 By 1 Matrix 1st Row upper C Subscript AC Baseline 2nd Row upper C Subscript AD Baseline 3rd Row upper C Subscript BC Baseline 4th Row upper C Subscript BD Baseline EndMatrix equals ModifyingBelow Start 4 By 1 Matrix 1st Row lamda Subscript upper P Baseline upper C 0 2nd Row left parenthesis 1 minus lamda Subscript upper P Baseline right parenthesis upper C 0 3rd Row lamda Subscript upper S Baseline upper C 0 4th Row left parenthesis 1 minus lamda Subscript upper S Baseline right parenthesis upper C 0 EndMatrix With bottom brace Underscript bold italic upper D left parenthesis upper C 0 right parenthesis Endscripts
M
odi
fy
ingB
elow
 Sta
rt 4
 By 
4 
Matrix
 1
st R
ow 1s
t C olumn 1 
2nd C
olu mn 1 3rd
 C
olu
mn 0 4th Column 0 2nd Row 1st Column 0 2nd Column 0 3rd Column 1 4th Column 1 3rd Row 1st Column 1 2nd Column 0 3rd Column 1 4th Column 0 4th Row 1st Column 0 2nd Column 1 3rd Column 0 4th Column 1 EndMatrix With bottom brace Underscript bold italic upper A Subscript upper N Baseline Endscripts Start 4 By 1 Matrix 1st Row upper C Subscript AC Baseline 2nd Row upper C Subscript AD Baseline 3rd Row upper C Subscript BC Baseline 4th Row upper C Subscript BD Baseline EndMatrix equals ModifyingBelow Start 4 By 1 Matrix 1st Row lamda Subscript upper P Baseline upper C 0 2nd Row left parenthesis 1 minus lamda Subscript upper P Baseline right parenthesis upper C 0 3rd Row lamda Subscript upper S Baseline upper C 0 4th Row left parenthesis 1 minus lamda Subscript upper S Baseline right parenthesis upper C 0 EndMatrix With bottom brace Underscript bold italic upper D left parenthesis upper C 0 right parenthesis Endscripts
ModifyingBelow Start 4 By 4 Matrix 1st Row 1st Column 1 2nd Column 1 3rd Column 0 4th Column 0 2nd Row 1st Column 0 2nd Column 0 3rd Column 1 4th Column 1 3rd Row 1st Column 1 2nd Column 0 3rd Column 1 4th Column 0 4th Row 1st Column 0 2nd Column 1 3rd Column 0 4th Column 1 EndMatrix With bottom brace Underscript bold italic upper A Subscript upper N Baseline Endscripts Start 4 By 1 Matrix 1st Row upper C Subscript AC Baseline 2nd Row upper C Subscript AD Baseline 3rd Row upper C Subscript BC Baseline 4th Row upper C Subscript BD Baseline EndMatrix equals ModifyingBelow Start 4 By 1 Matrix 1st Row lamda Subscript upper P Baseline upper C 0 2nd Row left parenthesis 1 minus lamda Subscript upper P Baseline right parenthesis upper C 0 3rd Row lamda Subscript upper S Baseline upper C 0 4th Row left parenthesis 1 minus lamda Subscript upper S Baseline right parenthesis upper C 0 EndMatrix With bottom brace Underscript bold italic upper D left parenthesis upper C 0 right parenthesis Endscripts
M
odifyi
ngBelow Start 4 By 4 Matrix 1st Row 1st Column 1 2nd Column 1 3rd Column 0 4th Column 0 2nd Row 1st Column 0 2nd Column 0 3rd Column 1 4th Column 1 3rd Row 1st Column 1 2nd Column 0 3rd Column 1 4th Column 0 4th Row 1st Column 0 2nd Column 1 3rd Column 0 4th Column 1 EndMatrix With bottom brace Underscript bold italic upper A Subscript upper N Baseline Endscripts Start 4 By 1 Matrix 1st Row upper C Subscript AC Baseline 2nd Row upper C Subscript AD Baseline 3rd Row upper C Subscript BC Baseline 4th Row upper C Subscript BD Baseline EndMatrix equals ModifyingBelow Start 4 By 1 Matrix 1st Row lamda Subscript upper P Baseline upper C 0 2nd Row left parenthesis 1 minus lamda Subscript upper P Baseline right parenthesis upper C 0 3rd Row lamda Subscript upper S Baseline upper C 0 4th Row left parenthesis 1 minus lamda Subscript upper S Baseline right parenthesis upper C 0 EndMatrix With bottom brace Underscript bold italic upper D left parenthesis upper C 0 right parenthesis Endscripts
where, AN is the coefﬁcient matrix, D(C0) is the vector of the given equations. 
According to (6.13), the rank of AN and the rank of the augmented matrix 
bol
d italic upper A Subscript upper N Baseline vertical ellipsis bold italic upper D left parenthesis upper C 0 right parenthesisare both equal to 3, and they are less than 4, which is the number of 
unknown quantities. Therefore, the solution of (6.13) for the lumped capacitance is
Fig. 6.5 Lumped 
capacitance of the 
transformer 
*
* 
CAC 
CBD 
CAD 
CBC 
A 
B 
C 
D 
CAB
CCD 

6.3 The CM Noise Model of Basic Isolated DC-DC Converters
103
not unique, and are given by 
St
art 
4 By
 1 M
atri
x 1s
t 
Row up
pe
r C 
Su
bscri pt A
C Bas elin
e 2 nd Ro w upper C Su
bs
cri
pt AD Baseline 3rd Row upper C Subscript BC Baseline 4th Row upper C Subscript BD Baseline EndMatrix equals Start 4 By 1 Matrix 1st Row upper C 2nd Row lamda Subscript upper P Baseline upper C 0 minus upper C 3rd Row lamda Subscript upper S Baseline upper C 0 minus upper C 4th Row left parenthesis 1 minus lamda Subscript upper P Baseline minus lamda Subscript upper S Baseline right parenthesis upper C 0 plus upper C EndMatrix
where, C is a free variable. 
6.3 
The CM Noise Model of Basic Isolated DC-DC 
Converters 
With the lumped capacitance model of the transformer, the CM noise model of basic 
isolated dc-dc converters, including ﬂyback, forward, push–pull, half-bridge and 
full-bridge converters will be derived and discussed in this section. 
6.3.1 
Derivation for the CM Noise Model of Flyback 
Converter 
Figure 6.6a, b show the ﬂyback converters with output rectiﬁer diode Do at the high 
side and low side, respectively. The parasitic capacitance CpB is between the drain 
of the main switch Q and the PE, and Lm is the magnetizing inductance. ip is the 
primary current, is is the secondary current, iLm is the magnetizing current, and ip 
equals to –nis + iLm, where, n is the secondary-to-primary winding turns ratio. 
The substitution theorem is adopted to derive the CM noise model by replacing 
the switches and diodes with voltage source or current source. Note that, in the
* 
PG 
A 
B 
* 
Q 
SG 
D 
C Do 
1:n 
CpB 
PE 
Co 
RLd 
is 
ip
nis 
Lm 
iLm 
* 
PG 
A 
B 
* 
Q 
SG 
D 
C 
Do
1:n 
CpB 
PE 
Co
RLd 
is 
ip
nis 
Lm 
iLm 
(a) Do is at the high side 
   (b) Do is at the low side 
Fig. 6.6 The ﬂyback converter with different conﬁgurations 

104
6
Modeling of the Common-Mode Noise for Isolated DC-DC Converters
A 
B 
C 
D
SG 
vQ 
PE 
nvAB 
is 
nis 
CAC 
CAD 
CBC 
CBD 
vAB 
iDo 
PG 
vCM 
2iCM 
25Ω 
CpB 
Lm 
A 
B 
C 
D
SG 
vQ 
PE 
CpB 
nvAB 
is 
nis 
CAC 
CAD 
CBC 
CBD 
iDo 
PG
2iCM 
25Ω 
CM
v 
vAB 
Lm 
(a) Do is at the high side                                    (b) Do is at the low side 
Fig. 6.7 The CM noise models of ﬂyback converter 
substitution, voltage loops or current nodes in the circuit should be avoided. In 
addition, the lumped capacitance model is adopted to represent the transformer inter-
winding capacitance. 
Firstly, switch Q is substituted with voltage source vQ, which is the AC compo-
nent of the drain-to-source voltage of switch Q since the DC component does not 
contribute to the CM noise. Then, the transformer windings are represented by a pair 
of controlled sources. To avoid voltage loops, the rectiﬁer diode Do is substituted 
with current source iDo, which is the AC component of the current through Do. As  
the dv/dt of the output voltage is far lower than that of vQ, the output ﬁlter capac-
itor and load, which are connected in parallel, is treated as short-circuit. Finally, by 
replacing the inter-winding capacitance with its equivalent lumped capacitance, and 
considering the 25-Ω equivalent impedance for the CM noise at the LISN side, the 
CM noise model can be derived, as shown in Fig. 6.7. 
The CM noise model in Fig. 6.7 can be further simpliﬁed. Taking the CM noise 
model shown in Fig. 6.7a as an example, superposition theorem is adopted to inves-
tigate the effect of voltage and current sources individually. Firstly, to investigate 
the impact of current source, the voltage source is shorted, thus vAB = 0. Accord-
ingly, the current source iDo is essentially shorted, and it does not contribute to the 
CM noise. Secondly, the current source iDo is opened, and the subcircuit excited by 
voltage source is shown in Fig. 6.8a.
The circuit in Fig. 6.8a is further simpliﬁed into Thevenin’s equivalent circuit, 
which is composed of the source impedance Csum and the equivalent noise source 
(ENS) vENS, as shown in Fig. 6.8b. 
Firstly, the source impedance Csum is calculated. Referring to Fig. 6.8a, by letting 
vQ = 0, we have vAB = 0, and terminals C and D are shorted. As a result, the four 
lumped capacitances and CpB are connected in parallel between the PG and SG. 
According to (6.14), the sum of four lumped capacitance is C0, so  Csum equals to C0 
+ CpB.

6.3 The CM Noise Model of Basic Isolated DC-DC Converters
105
A 
B 
C 
D
SG 
vQ 
PE 
CpB 
nvAB 
is 
nis 
CAC 
CAD 
CBC 
CBD 
iDo 
PG 
vCM 
2iCM 
25Ω 
vAB 
Cut set 
Lm 
vCM 
25Ω 
Csum
   vENS 
PE 
PG 
SG 
(a) The subcircuit excited by voltage 
source 
(b) The simplified model 
Fig. 6.8 The simpliﬁcation of the CM noise model of ﬂyback converter
Secondly, the equivalent noise source vENS, which is the open-circuit voltage for 
the network at the right side of the 25-Ω resistor, is calculated. Referring to Fig. 6.8a, 
by opening the network at the right-hand side of the 25-Ω resistor, the current 2iCM 
ﬂowing from the PE is 0. In Fig. 6.8a, a cut set is drawn from the lumped capacitance 
to the PE. According to the continuity of current, we have 
uppe
r C Subscript AC Baseline StartFraction d Over d t EndFraction left parenthesis v Subscript upper A Baseline minus v Subscript upper C Baseline right parenthesis plus upper C Subscript AD Baseline StartFraction d Over d t EndFraction left parenthesis v Subscript upper A Baseline minus v Subscript upper D Baseline right parenthesis plus upper C Subscript BC Baseline StartFraction d Over d t EndFraction left parenthesis v Subscript upper B Baseline minus v Subscript upper C Baseline right parenthesis plus left parenthesis upper C Subscript BD Baseline plus upper C Subscript pB Baseline right parenthesis StartFraction d Over d t EndFraction left parenthesis v Subscript upper B Baseline minus v Subscript upper D Baseline right parenthesis equals 0
upp er C  Subscript A
C Baseline StartFraction d Over d t EndFraction left parenthesis v Subscript upper A Baseline minus v Subscript upper C Baseline right parenthesis plus upper C Subscript AD Baseline StartFraction d Over d t EndFraction left parenthesis v Subscript upper A Baseline minus v Subscript upper D Baseline right parenthesis plus upper C Subscript BC Baseline StartFraction d Over d t EndFraction left parenthesis v Subscript upper B Baseline minus v Subscript upper C Baseline right parenthesis plus left parenthesis upper C Subscript BD Baseline plus upper C Subscript pB Baseline right parenthesis StartFraction d Over d t EndFraction left parenthesis v Subscript upper B Baseline minus v Subscript upper D Baseline right parenthesis equals 0
upp er C  Subscript A
C Baseline StartFraction d Over d t EndFraction left parenthesis v Subscript upper A Baseline minus v Subscript upper C Baseline right parenthesis plus upper C Subscript AD Baseline StartFraction d Over d t EndFraction left parenthesis v Subscript upper A Baseline minus v Subscript upper D Baseline right parenthesis plus upper C Subscript BC Baseline StartFraction d Over d t EndFraction left parenthesis v Subscript upper B Baseline minus v Subscript upper C Baseline right parenthesis plus left parenthesis upper C Subscript BD Baseline plus upper C Subscript pB Baseline right parenthesis StartFraction d Over d t EndFraction left parenthesis v Subscript upper B Baseline minus v Subscript upper D Baseline right parenthesis equals 0
upp er C  Subscr
i
pt A C Bas
e line StartFraction d Over d t EndFraction left parenthesis v Subscript upper A Baseline minus v Subscript upper C Baseline right parenthesis plus upper C Subscript AD Baseline StartFraction d Over d t EndFraction left parenthesis v Subscript upper A Baseline minus v Subscript upper D Baseline right parenthesis plus upper C Subscript BC Baseline StartFraction d Over d t EndFraction left parenthesis v Subscript upper B Baseline minus v Subscript upper C Baseline right parenthesis plus left parenthesis upper C Subscript BD Baseline plus upper C Subscript pB Baseline right parenthesis StartFraction d Over d t EndFraction left parenthesis v Subscript upper B Baseline minus v Subscript upper D Baseline right parenthesis equals 0
upp er C  Subscript
 AC Baseline StartFraction d Over d t EndFraction left parenthesis v Subscript upper A Baseline minus v Subscript upper C Baseline right parenthesis plus upper C Subscript AD Baseline StartFraction d Over d t EndFraction left parenthesis v Subscript upper A Baseline minus v Subscript upper D Baseline right parenthesis plus upper C Subscript BC Baseline StartFraction d Over d t EndFraction left parenthesis v Subscript upper B Baseline minus v Subscript upper C Baseline right parenthesis plus left parenthesis upper C Subscript BD Baseline plus upper C Subscript pB Baseline right parenthesis StartFraction d Over d t EndFraction left parenthesis v Subscript upper B Baseline minus v Subscript upper D Baseline right parenthesis equals 0
where, vA, vB, vC and vD is the electric potential of the transformer terminals, 
respectively. 
According to Fig. 6.8a, we have
Star tLayo ut En
lar ged l eft bra ce 1s t Row 
v Subscript upper B Baseline equals v Subscript upper Q Baseline plus v Subscript upper A Baseline 2nd Row v Subscript upper C Baseline equals v Subscript upper D Baseline minus n v Subscript AB Baseline equals v Subscript upper D Baseline plus n v Subscript upper Q Baseline EndLayout
By substituting (6.16) into (6.15), vENS is derived as 
v Sub scrip t ENS  
B
asel ine eq uals 
v
 Subscri pt upper D Baseline minus v Subscript upper A Baseline equals StartFraction left parenthesis upper C Subscript BC Baseline plus upper C Subscript BD Baseline plus upper C Subscript pB Baseline right parenthesis minus n left parenthesis upper C Subscript AC Baseline plus upper C Subscript BC Baseline right parenthesis Over upper C Subscript AC Baseline plus upper C Subscript AD Baseline plus upper C Subscript BC Baseline plus upper C Subscript BD Baseline plus upper C Subscript pB Baseline EndFraction v Subscript upper Q
v Su bscrip t ENS Baseli ne equ
al
s v Subscript upper D Baseline minus v Subscript upper A Baseline equals StartFraction left parenthesis upper C Subscript BC Baseline plus upper C Subscript BD Baseline plus upper C Subscript pB Baseline right parenthesis minus n left parenthesis upper C Subscript AC Baseline plus upper C Subscript BC Baseline right parenthesis Over upper C Subscript AC Baseline plus upper C Subscript AD Baseline plus upper C Subscript BC Baseline plus upper C Subscript BD Baseline plus upper C Subscript pB Baseline EndFraction v Subscript upper Q
Substituting (6.14) into (6.17), leads to 
v Sub scrip t ENS  Baseline  equals StartFraction left parenthesis 1 minus lamda Subscript upper P Baseline minus n lamda Subscript upper S Baseline right parenthesis upper C 0 plus upper C Subscript pB Baseline Over upper C 0 plus upper C Subscript pB Baseline EndFraction v Subscript upper Q
v S ubscri
pt
 ENS Baseline equals StartFraction left parenthesis 1 minus lamda Subscript upper P Baseline minus n lamda Subscript upper S Baseline right parenthesis upper C 0 plus upper C Subscript pB Baseline Over upper C 0 plus upper C Subscript pB Baseline EndFraction v Subscript upper Q

106
6
Modeling of the Common-Mode Noise for Isolated DC-DC Converters
In low power applications with plastic enclosure, the heat sinks are connected to 
the PG, so the parasitic capacitance CpB is far smaller than C0. According to (6.18), 
we have 
v Sub scrip t ENS  Baselin
e almost equals left parenthesis 1 minus lamda Subscript upper P Baseline minus n lamda Subscript upper S Baseline right parenthesis v Subscript upper Q
According to (6.19), if (1 − λP − nλS) = 0, then vENS = 0, implying the CM 
noise is zero, and the converter has the ability of CM noise cancellation (CMNC). 
In Sect. 6.4, the CMNC capability of the basic isolated DC-DC converters will be 
discussed. 
6.3.2 
The CM Noise Model of Other Basic Isolated DC-DC 
Converters 
Following the derivation of the CM noise model of ﬂyback converter, this section 
gives the derivation of the CM noise model of other basic isolated DC-DC converters. 
1. Forward Converter 
Figure 6.9a, b show the forward converters with the output rectiﬁer diode DR1 and 
ﬁlter inductor Lf at the high side and low side, respectively. The current ﬂowing 
through the primary and secondary winding is equal to ip and is, respectively. By 
neglecting the magnetizing current, ip equals to nis, where n is the secondary-to-
primary winding turns ratio. 
To derive the CM noise models, switch Q is substituted with voltage source vQ, 
which is the AC component of the drain-to-source voltage of switch Q, and the 
transformer windings are represented by a pair of controlled sources. Then, in order 
to avoid voltage loops, the reset circuit is replaced by current source iRESET, the  
rectiﬁer diode DR1 is substituted with current source iDR1, and the branch with ﬁlter 
inductor, ﬁlter capacitor and load is replaced by ac current source iLf. These current 
sources are the AC component of the current through the corresponding branches,
* 
PG 
A 
B 
* 
Q 
SG 
D 
C
Reset 
circuit 
DR1 
DFW 
Lf 
1:n
n
CpB 
PE 
Co 
RLd 
is
ip 
* 
PG 
A 
B 
* 
Q1 
SG 
D 
C
Reset 
DR1 
DFW 
Lf 
1: 
CpB 
PE 
Co 
RLd 
is
ip 
(a) DR1 and Lf are at the high side                 (b) DR1 and Lf are at the low side 
circuit 
Fig. 6.9 The forward converter with different conﬁgurations 

6.3 The CM Noise Model of Basic Isolated DC-DC Converters
107
A 
B 
C 
D
SG 
vQ 
PE 
CpB 
nvAB 
is 
nis 
CAC 
CAD 
CBC 
CBD 
vAB
iDR1 
PG 
vCM 
2iCM 
25Ω 
vDFW 
iLf 
iRESET 
A 
B 
C 
D 
SG 
vQ 
PE 
CpB 
nvAB 
is 
nis 
CAC 
CAD 
CBC 
CBD 
+
vAB 
iDR1 
PG 
vCM 
25Ω 
vDFW 
iLf 
iRESET 
(a) DR1 and Lf are at the high side                  (b) DR1 and Lf are at the low side 
Fig. 6.10 The CM noise models of forward converters 
respectively. To avoid current nodes, the freewheeling diode DFW is substituted with 
voltage source vDFW, which is the AC component of the voltage across DFW. Finally, 
the inter-winding capacitance is replaced with its equivalent lumped capacitance, the 
CM noise models are derived, as shown in Fig. 6.10. 
2. Push–Pull Converter 
Figure 6.11 shows the push–pull converter with different conﬁgurations of the 
secondary rectiﬁer and ﬁlter, where, the parasitic capacitances CpA and CpB are 
between the drain of the main switches Q1, Q2 and the PE, respectively. The currents 
ﬂowing through the primary and secondary windings are ip1, ip2, is1 and is2, respec-
tively. By neglecting the magnetizing current, ip1 = nis1, and ip2 = nis2, where, n is 
the secondary-to-primary winding turns ratio. 
To derive the CM noise models, switches Q1 and Q2 are substituted with voltage 
sources vQ1 and vQ2, which are the AC component of the drain-to-source voltage of 
switches Q1 and Q2, respectively. The transformer windings are represented by a 
pair of controlled sources. Then, in order to avoid voltage loops, the rectiﬁer diodes 
DR1 and DR2 are substituted with current sources iDR1 and iDR2, which are the AC
PG 
* 
Q2 
* 
*
SG 
Q1 
* 
A 
B 
C 
Vin 
DR1 
Co 
Lf 
CpA 
CpB 
PE 
PE 
D 
DR2 
RLd 
is1 
is2 
ip1 
ip2 
PG 
* 
Q2 
* 
* 
SG 
Q1 
* 
A 
B 
C 
Vin 
DR1 
Co 
Lf 
CpA 
CpB 
PE 
PE 
D 
DR2 
RLd 
is1 
is2 
ip1 
ip2 
(a) Configuration I                                         (b) Configuration II 
Fig. 6.11 The push–pull converter with different conﬁgurations 

108
6
Modeling of the Common-Mode Noise for Isolated DC-DC Converters
component of the current through DR1 and DR2, respectively. To avoid current nodes, 
the branch with ﬁlter inductor, ﬁlter capacitor and load is replaced by voltage source 
vrect. Finally, by replacing the inter-winding capacitance with its equivalent lumped 
capacitance, the CM noise models are derived, as shown in Fig. 6.12. 
3. Half-Bridge Converter 
Figure 6.13 shows the half-bridge converter with different conﬁgurations of the 
secondary rectiﬁer and ﬁlter, where, the parasitic capacitance CpB is between the 
drain of the main switch Q2 and the PE. ip is the primary winding current, and is1 and 
is2 are the two secondary windings currents. By neglecting the magnetizing current, 
ip = n(is1 − is2). 
To derive the CM noise models, the switch Q2 is substituted with voltage source 
vQ2, which is the AC component of the drain-to-source voltage of Q2. The transformer 
windings are represented by a pair of controlled sources. Then, in order to avoid 
voltage loops, the switch Q1 is substituted with current source iQ1, and the rectiﬁer 
diodes DR1 and DR2 are substituted with current sources iDR1 and iDR2. These current
A 
B 
C 
D 
SG 
vQ1 
PE 
CpB 
nvAM 
is1 
CAC 
CAD 
CBC 
CBD 
vAM
iDR1 
PG 
vCM 
2iCM 
25Ω 
vrect 
vQ2 
is2 
CpA 
M 
nvAM 
nis1 
nis2 
A 
B 
C 
D 
SG 
vQ1 
PE 
CpB 
nvAM 
is1 
CAC 
CAD 
CBC 
CBD 
vAM
iDR1 
PG 
vCM 
2iCM 
25Ω
vrect 
vQ2 
is2 
CpA 
M 
nvAM 
iDR2 
nis1 
nis2 
(a) Configuration I           
(b) Configuration II 
Fig. 6.12 The CM noise models of push–pull converters 
PG 
*
* 
*
SG
B 
A 
Q2 
Q1 
C2 
C1 
Vin 
Co 
Lf 
CpB 
D 
C 
DR1 
DR2 
RLd 
is1 
is2 
ip 
PG 
* 
B 
A 
Q2 
Q1 
C2 
C1 
Vin 
CpB 
* 
* 
SG 
C 
DR1 
Co 
Lf 
D 
DR2 
RLd 
is1 
is2 
ip 
(a) Configuration I                                         (b) Configuration II 
Fig. 6.13 The half-bridge converter with different conﬁgurations 

6.3 The CM Noise Model of Basic Isolated DC-DC Converters
109
sources are the AC component of the current through the corresponding branches, 
respectively. To avoid current nodes, the branch with ﬁlter inductor, ﬁlter capacitor 
and load is replaced by voltage source vrect. Since the dv/dt of the voltage across 
C1 and C2 is far lower than that of vQ2, these two capacitors can be treated as short 
circuit. Finally, by replacing the inter-winding capacitance with its equivalent lumped 
capacitance, the CM noise models are derived, as shown in Fig. 6.14. 
4. Full-Bridge Converter 
Figure 6.15 shows the full-bridge converter with different conﬁgurations of the 
secondary rectiﬁer and ﬁlter, where, the parasitic capacitances CpA and CpB are 
between the drain of the main switches Q3, Q4 and the PE, respectively. ip is the 
primary winding current, is1 and is2 are the two secondary windings currents, and ip 
= n(is1 − is2). 
To derive the CM noise models, the switches Q3 and Q4 are substituteded with 
voltage sources vQ3 and vQ4, which are the AC component of the drain-to-source 
voltage of Q3 and Q4, respectively. The transformer windings are represented by a 
pair of controlled sources. Then, in order to avoid voltage loops, the switches Q1 
and Q2 are replaced by current source iQ1 and iQ2, and the rectiﬁer diodes DR1 and
A 
B 
C 
D
SG
vQ2 
PE 
CpB 
nvAB 
is1 
CAC 
CAD 
CBC 
CBD 
vAB
iDR1 
PG 
vCM 
2iCM 
25Ω 
vrect 
iQ1 
iDR2 
nvAB 
is2 
n(is1‒is2) 
A 
B 
C 
D 
SG
vQ2 
PE 
CpB 
nvAB 
is1 
CAC 
CAD 
CBC 
CBD 
vAB
iDR1 
PG 
vCM 
2iCM 
25Ω 
vrect 
iQ1 
iDR2 
nvAB 
is2 
n(is1‒is2) 
(a) Configuration I                                         (b) Configuration II 
Fig. 6.14 The CM noise models of half-bridge converters 
A 
B 
PG 
* 
Q3 
Q1 
Q4 
Q2 
* 
*
SG 
a 
b 
Vin 
DR1 
Co 
Lf 
PE 
CpB 
CpA 
DR2 
c 
e 
d 
RLd 
is1 
is2 
ip 
A 
B 
PG 
* 
Q3 
Q1 
Q4 
Q2 
* 
* 
SG 
a 
b 
Vin 
DR1 
Co 
Lf 
PE 
CpB 
CpA 
DR2 
c 
e 
d
RLd 
is1 
is2 
ip 
(a) Configuration I                                       (b) Configuration II 
Fig. 6.15 The full-bridge converter with different conﬁgurations 

110
6
Modeling of the Common-Mode Noise for Isolated DC-DC Converters
Fig. 6.16 The CM noise models of full-bridge converters 
DR2 are substituted with current sources iDR1 and iDR2. These current sources are 
the AC component of the current through the corresponding branches, respectively. 
To avoid current nodes, the branch with ﬁlter inductor, ﬁlter capacitor and load is 
replaced by voltage source vrect. Finally, by replacing the inter-winding capacitance 
with its equivalent lumped capacitance, the CM noise models are derived, as shown 
in Fig. 6.16. 
5. Simpliﬁed CM Noise Models 
Similar to the simpliﬁcation of the CM noise model of ﬂyback converter, the CM 
noise model of the forward, push–pull, half-bridge and full-bridge converters can be 
acquired, which is the same as Fig. 6.8b. Table 6.1 summarizes the source impedance 
and the ENS of these circuits. As seen, under different circuit conﬁgurations, the 
ENS of ﬂyback and forward converters is different, while the ENS of push–pull, 
half-bridge and full-bridge converters are the same. The explanations are given below.
For the ﬂyback converter in Fig. 6.6, the voltage across the secondary winding 
equals to vCD regardless of the position of Do. Take the PE as the reference ground, 
referring to Fig. 6.6a, when Do is at the high side, the electric potential of terminals C 
and D is vCD and 0, respectively. Referring to Fig. 6.6b, when Do is at the low side, the 
electric potential of terminals C and D is shifted into 0 and –vCD, respectively. As the 
electric potentials of winding terminals are changed, the displacement current ﬂowing 
through transformer inter-winding capacitance is inﬂuenced, leading to different ENS 
for these circuit conﬁgurations. For the forward converter, the analysis is similar. 
For the push–pull converter in Fig. 6.11, the AC electric potential of the center tap 
is zero under two circuit conﬁgurations due to symmetry. As the voltage across the 
secondary winding is the same, the electric potentials of secondary winding terminals 
are not changed, and the ENS for these two circuit conﬁgurations is the same. This 
scenario can be also found in half-bridge and full-bridge converter.

6.4 The CMNC Capability of Isolated DC-DC Converters
111
Table 6.1 The source impedance and ENS of basic isolated DC-DC converters 
Topology
Conﬁgurations 
Source 
impedance 
The ENS formulas 
Flyback
Do is at high 
side 
(Fig. 6.6a) 
up er C 0 plus upper C Subscript pB
v Subscrip t ENS normal bar FLY 1 Baseline equals StartFraction left parenthesis 1 minus lamda Subscript upper P Baseline minus n lamda Subscript upper S Baseline right parenthesis upper C 0 plus upper C Subscript pB Baseline Over upper C 0 plus upper C Subscript pB Baseline EndFraction v Subscript upper Q
v Subsc
ript ENS normal bar FLY 1 Baseline equals StartFraction left parenthesis 1 minus lamda Subscript upper P Baseline minus n lamda Subscript upper S Baseline right parenthesis upper C 0 plus upper C Subscript pB Baseline Over upper C 0 plus upper C Subscript pB Baseline EndFraction v Subscript upper Q
Do is at low 
side 
(Fig. 6.6b) 
v Subscrip t ENS normal bar FLY 2 Baseline equals StartFraction left bracket 1 minus lamda Subscript upper P Baseline plus n left parenthesis 1 minus lamda Subscript upper S Baseline right parenthesis right bracket upper C 0 plus upper C Subscript pB Baseline Over upper C 0 plus upper C Subscript pB Baseline EndFraction v Subscript upper Q
v Subsc
ript ENS normal bar FLY 2 Baseline equals StartFraction left bracket 1 minus lamda Subscript upper P Baseline plus n left parenthesis 1 minus lamda Subscript upper S Baseline right parenthesis right bracket upper C 0 plus upper C Subscript pB Baseline Over upper C 0 plus upper C Subscript pB Baseline EndFraction v Subscript upper Q
Forward
DR1 and Lf are 
at high side 
(Fig. 6.9a) 
up er C 0 plus upper C Subscript pB
v Subscrip t ENS normal bar FWD 1 Baseline equals StartFraction left parenthesis 1 minus lamda Subscript upper P Baseline plus n lamda Subscript upper S Baseline right parenthesis upper C 0 plus upper C Subscript pB Baseline Over upper C 0 plus upper C Subscript pB Baseline EndFraction v Subscript upper Q
v Subsc
ript ENS normal bar FWD 1 Baseline equals StartFraction left parenthesis 1 minus lamda Subscript upper P Baseline plus n lamda Subscript upper S Baseline right parenthesis upper C 0 plus upper C Subscript pB Baseline Over upper C 0 plus upper C Subscript pB Baseline EndFraction v Subscript upper Q
DR1 and Lf are 
at low side 
(Fig. 6.9b) 
v Subscrip t ENS normal bar FWD 2 Baseline equals StartFraction left bracket 1 minus lamda Subscript upper P Baseline minus n left parenthesis 1 minus lamda Subscript upper S Baseline right parenthesis right bracket upper C 0 plus upper C Subscript pB Baseline Over upper C 0 plus upper C Subscript pB Baseline EndFraction v Subscript upper Q
v Subsc
ript ENS normal bar FWD 2 Baseline equals StartFraction left bracket 1 minus lamda Subscript upper P Baseline minus n left parenthesis 1 minus lamda Subscript upper S Baseline right parenthesis right bracket upper C 0 plus upper C Subscript pB Baseline Over upper C 0 plus upper C Subscript pB Baseline EndFraction v Subscript upper Q
Push–pull
Conﬁguration 
I 
(Fig. 6.11a) 
up er
 C 0  plus upper C Subscript pA Baseline plus upper C Subscript pB
v Subscr ip t ENS normal bar PP Baseline equals StartFraction left bracket 2 lamda Subscript upper P Baseline minus 1 plus n left parenthesis 2 lamda Subscript upper S Baseline minus 1 right parenthesis right bracket upper C 0 plus upper C Subscript pA Baseline minus upper C Subscript pB Baseline Over upper C 0 plus upper C Subscript pA Baseline plus upper C Subscript pB Baseline EndFraction v Subscript upper Q 1n
v Subscript
 ENS normal bar PP Baseline equals StartFraction left bracket 2 lamda Subscript upper P Baseline minus 1 plus n left parenthesis 2 lamda Subscript upper S Baseline minus 1 right parenthesis right bracket upper C 0 plus upper C Subscript pA Baseline minus upper C Subscript pB Baseline Over upper C 0 plus upper C Subscript pA Baseline plus upper C Subscript pB Baseline EndFraction v Subscript upper Q 1
Conﬁguration 
II 
(Fig. 6.11b) 
Half-bridge Conﬁguration 
I 
(Fig. 6.13a) 
up er C 0 plus upper C Subscript pB
v Subscr ip t ENS normal bar HB Baseline equals StartFraction left bracket 1 minus lamda Subscript upper P Baseline plus n left parenthesis 2 lamda Subscript upper S Baseline minus 1 right parenthesis right bracket upper C 0 plus upper C Subscript pB Baseline Over upper C 0 plus upper C Subscript pB Baseline EndFraction v Subscript upper Q 2
v Subsc
ript ENS normal bar HB Baseline equals StartFraction left bracket 1 minus lamda Subscript upper P Baseline plus n left parenthesis 2 lamda Subscript upper S Baseline minus 1 right parenthesis right bracket upper C 0 plus upper C Subscript pB Baseline Over upper C 0 plus upper C Subscript pB Baseline EndFraction v Subscript upper Q 2
Conﬁguration 
II 
(Fig. 6.13b) 
Full-bridge 
Conﬁguration 
I 
(Fig. 6.15a) 
up er
 C 0  plus upper C Subscript pA Baseline plus upper C Subscript pB
StartLay out 1s t Row 1st Column  v Subscript ENS normal bar FB 2nd Column equals StartFraction left bracket lamda Subscript upper P Baseline plus n left parenthesis 1 minus 2 lamda Subscript upper S Baseline right parenthesis right bracket upper C 0 plus upper C Subscript pA Baseline Over upper C 0 plus upper C Subscript pA Baseline plus upper C Subscript pB Baseline EndFraction v Subscript upper Q 3 Baseline 2nd Row 1st Column Blank 2nd Column plus StartFraction left brace 1 minus left bracket lamda Subscript upper P Baseline plus n left parenthesis 1 minus 2 lamda Subscript upper S Baseline right parenthesis right bracket right brace upper C 0 plus upper C Subscript pB Baseline Over upper C 0 plus upper C Subscript pA Baseline plus upper C Subscript pB Baseline EndFraction v Subscript upper Q 4 Baseline EndLayout
Sta rtLayo ut 1st
 Row
 1st Column  v Sub script ENS normal bar FB 2nd Column equals StartFraction left bracket lamda Subscript upper P Baseline plus n left parenthesis 1 minus 2 lamda Subscript upper S Baseline right parenthesis right bracket upper C 0 plus upper C Subscript pA Baseline Over upper C 0 plus upper C Subscript pA Baseline plus upper C Subscript pB Baseline EndFraction v Subscript upper Q 3 Baseline 2nd Row 1st Column Blank 2nd Column plus StartFraction left brace 1 minus left bracket lamda Subscript upper P Baseline plus n left parenthesis 1 minus 2 lamda Subscript upper S Baseline right parenthesis right bracket right brace upper C 0 plus upper C Subscript pB Baseline Over upper C 0 plus upper C Subscript pA Baseline plus upper C Subscript pB Baseline EndFraction v Subscript upper Q 4 Baseline EndLayout
Sta rtLayo ut 1st
 Row 1st Column v Subscript ENS normal bar FB 2nd Column equals StartFraction left bracket lamda Subscript upper P Baseline plus n left parenthesis 1 minus 2 lamda Subscript upper S Baseline right parenthesis right bracket upper C 0 plus upper C Subscript pA Baseline Over upper C 0 plus upper C Subscript pA Baseline plus upper C Subscript pB Baseline EndFraction v Subscript upper Q 3 Baseline 2nd Row 1st Column Blank 2nd Column plus StartFraction left brace 1 minus left bracket lamda Subscript upper P Baseline plus n left parenthesis 1 minus 2 lamda Subscript upper S Baseline right parenthesis right bracket right brace upper C 0 plus upper C Subscript pB Baseline Over upper C 0 plus upper C Subscript pA Baseline plus upper C Subscript pB Baseline EndFraction v Subscript upper Q 4 Baseline EndLayout
Conﬁguration 
II 
(Fig. 6.15b)
6.4 
The CMNC Capability of Isolated DC-DC Converters 
If the CM noise in a converter can be cancelled by optimizing the transformer winding 
structure, it means this converter has the ability of CMNC. In Sect. 6.3.1, the ﬂyback 
with Do at the high side is proved to have the CMNC capability. In this Section, the 
CMNC capability of the basic isolated dc-dc converters will be investigated. 
For the ﬂyback converter with Do at the high side, according to Table 6.1, the  
coefﬁcient before vQ in the ENS is [(1 – λP – nλS)C0 + CpB]/(C0 + CpB). Since λP 
and λS are in the range of (0, 1), this coefﬁcient is between (–nC0 + CpB)/(C0 + CpB) 
and 1. Similarly, the range of the coefﬁcients for the ﬂyback converter with Do at the 
low side, forward and half-bridge converters can be calculated, and they are listed

112
6
Modeling of the Common-Mode Noise for Isolated DC-DC Converters
in Table 6.2. For the push–pull converter, Q1 and Q2 are usually mounted on the 
same heat sink, and the insulation in the middle adopts the same material with equal 
thickness, so CpA and CpB are almost equal, and the range for the coefﬁcient in the 
ENS is calculated. Likewise, for the full-bridge converter, CpA and CpB can also be 
regarded as equal. When the pulse width modulation (PWM) control is adopted, the 
diagonal switches are turned on/off simultaneously, so vQ3 = –vQ4. Accordingly, the 
range of the coefﬁcient in the ENS can be calculated, and is also listed in Table 6.2. 
According to Table 6.2, for the ﬂyback converter with Do at the low side, the 
coefﬁcient before vQ in the ENS is always positive, and the CM noise is impossible 
to be cancelled. Similarily, the forward converter with DR1 and Lf at the high side 
has no CMNC capability. 
For the ﬂyback converter with Do at the high side, the coefﬁcient before vQ in the 
ENS is between (–nC0 + CpB)/(C0 + CpB) and 1. Normally, C0 is far larger than 
CpB, so the term (–nC0 + CpB)/(C0 + CpB) is a negative number. As the coefﬁcient 
before vQ is a continuous function regarding λP and λS, there exists a solution with 
λP and λS that makes the coefﬁcient be zero, indicating that the ﬂyback converter 
with Do at the high side has the CMNC capability. Similarily, the forward converter 
with DR1 and Lf at the low side, push–pull, half-bridge and full-bridge converters 
also have the CMNC capability. 
When the full-bridge converter adopts phase-shift control, a resonant inductor 
Lr is usually added to assist soft-switching. With phase-shift control, vQ3 and vQ4 
are no longer complementary, and the CM noise can not be cancelled by each other. 
Moreover, the CM noise is affected by the voltage across Lr. In Chap. 8, the reduction 
of the CM noise in the phase-shifted full-bridge (PSFB) converter will be investigated.
Table 6.2 The range of the ENS of basic isolated dc-dc converters 
Topology
Conﬁgurations
The range of the coefﬁcient 
before the voltage source in the 
ENS 
CMNC capability 
Flyback
Do is at high side 
(Fig. 6.7a)
l eft parenthesis StartFraction minus n upper C 0 plus upper C Subscript pB Baseline Over upper C 0 plus upper C Subscript pB Baseline EndFraction comma 1 right parenthesis
left pa ren
thesis StartFraction minus n upper C 0 plus upper C Subscript pB Baseline Over upper C 0 plus upper C Subscript pB Baseline EndFraction comma 1 right parenthesis
Yes 
Do is at low side 
(Fig. 6.7b)
l
eft parenthesis StartFraction upper C Subscript pB Baseline Over upper C 0 plus upper C Subscript pB Baseline EndFraction comma 1 plus StartFraction n upper C 0 Over upper C 0 plus upper C Subscript pB Baseline EndFraction right parenthesis
left pa renth esis StartFraction upper C Subscript pB Baseline Over upper C 0 plus upper C Subscript pB Baseline EndFraction comma 1 plus StartFraction n upper C 0 Over upper C 0 plus upper C Subscript pB Baseline EndFraction right parenthesis
left p
arenthesis StartFraction upper C Subscript pB Baseline Over upper C 0 plus upper C Subscript pB Baseline EndFraction comma 1 plus StartFraction n upper C 0 Over upper C 0 plus upper C Subscript pB Baseline EndFraction right parenthesis
No 
Forward
DR1 and Lf are at high side 
(Fig. 6.9a)
l
eft parenthesis StartFraction upper C Subscript pB Baseline Over upper C 0 plus upper C Subscript pB Baseline EndFraction comma 1 plus StartFraction n upper C 0 Over upper C 0 plus upper C Subscript pB Baseline EndFraction right parenthesis
left pa renth esis StartFraction upper C Subscript pB Baseline Over upper C 0 plus upper C Subscript pB Baseline EndFraction comma 1 plus StartFraction n upper C 0 Over upper C 0 plus upper C Subscript pB Baseline EndFraction right parenthesis
left p
arenthesis StartFraction upper C Subscript pB Baseline Over upper C 0 plus upper C Subscript pB Baseline EndFraction comma 1 plus StartFraction n upper C 0 Over upper C 0 plus upper C Subscript pB Baseline EndFraction right parenthesis
No 
DR1 and Lf are at low side 
(Fig. 6.9b)
l eft parenthesis StartFraction minus n upper C 0 plus upper C Subscript pB Baseline Over upper C 0 plus upper C Subscript pB Baseline EndFraction comma 1 right parenthesis
left pa ren
thesis StartFraction minus n upper C 0 plus upper C Subscript pB Baseline Over upper C 0 plus upper C Subscript pB Baseline EndFraction comma 1 right parenthesis
Yes 
Push–pull
Conﬁgurations in Fig. 6.11
l
ef
t parenthesis minus StartFraction left parenthesis 1 plus n right parenthesis upper C 0 Over upper C 0 plus upper C Subscript pA Baseline plus upper C Subscript pB Baseline EndFraction comma StartFraction left parenthesis 1 plus n right parenthesis upper C 0 Over upper C 0 plus upper C Subscript pA Baseline plus upper C Subscript pB Baseline EndFraction right parenthesis
left parent he
sis minus StartFraction left parenthesis 1 plus n right parenthesis upper C 0 Over upper C 0 plus upper C Subscript pA Baseline plus upper C Subscript pB Baseline EndFraction comma StartFraction left parenthesis 1 plus n right parenthesis upper C 0 Over upper C 0 plus upper C Subscript pA Baseline plus upper C Subscript pB Baseline EndFraction right parenthesis
left paren
thesis minus StartFraction left parenthesis 1 plus n right parenthesis upper C 0 Over upper C 0 plus upper C Subscript pA Baseline plus upper C Subscript pB Baseline EndFraction comma StartFraction left parenthesis 1 plus n right parenthesis upper C 0 Over upper C 0 plus upper C Subscript pA Baseline plus upper C Subscript pB Baseline EndFraction right parenthesis
Yes 
Half-bridge 
Conﬁgurations in Fig. 6.13
l eft parenthesis StartFraction minus n upper C 0 plus upper C Subscript pB Baseline Over upper C 0 plus upper C Subscript pB Baseline EndFraction comma 1 plus StartFraction n upper C 0 Over upper C 0 plus upper C Subscript pB Baseline EndFraction right parenthesis
left pa renth esis StartFraction minus n upper C 0 plus upper C Subscript pB Baseline Over upper C 0 plus upper C Subscript pB Baseline EndFraction comma 1 plus StartFraction n upper C 0 Over upper C 0 plus upper C Subscript pB Baseline EndFraction right parenthesis
left p
arenthesis StartFraction minus n upper C 0 plus upper C Subscript pB Baseline Over upper C 0 plus upper C Subscript pB Baseline EndFraction comma 1 plus StartFraction n upper C 0 Over upper C 0 plus upper C Subscript pB Baseline EndFraction right parenthesis
Yes 
Full-bridge
Conﬁgurations in Fig. 6.15
l
ef
t parenthesis minus StartFraction 2 n upper C 0 Over upper C 0 plus upper C Subscript pA Baseline plus upper C Subscript pB Baseline EndFraction comma StartFraction left parenthesis 1 plus 2 n right parenthesis upper C 0 Over upper C 0 plus upper C Subscript pA Baseline plus upper C Subscript pB Baseline EndFraction right parenthesis
left parent he
sis minus StartFraction 2 n upper C 0 Over upper C 0 plus upper C Subscript pA Baseline plus upper C Subscript pB Baseline EndFraction comma StartFraction left parenthesis 1 plus 2 n right parenthesis upper C 0 Over upper C 0 plus upper C Subscript pA Baseline plus upper C Subscript pB Baseline EndFraction right parenthesis
left paren
thesis minus StartFraction 2 n upper C 0 Over upper C 0 plus upper C Subscript pA Baseline plus upper C Subscript pB Baseline EndFraction comma StartFraction left parenthesis 1 plus 2 n right parenthesis upper C 0 Over upper C 0 plus upper C Subscript pA Baseline plus upper C Subscript pB Baseline EndFraction right parenthesis
Yes 

6.5 Experimental Veriﬁcation and Discussions
113
6.5 
Experimental Veriﬁcation and Discussions 
In this section, the lumped capacitance model and the CM noise model will be veriﬁed 
by the experimental results, respectively. 
6.5.1 
The Veriﬁcation of the Lumped Capacitance Model 
Figure 6.17a, b shows the test setup for verifying the lumped capacitance model 
of the transformer and the corresponding test circuit [5]. The excitation port of the 
network analyzer provides an excitation source vac with an internal 50-Ω resistor, 
which is applied on the primary winding of the transformer. The secondary winding 
of the transformer is left to be open. A 10-kΩ resistor R is connected across the 
primary-winding terminal B and secondary-winding terminal D for measuring the 
displacement current ﬂowing through the transformer inter-winding capacitance. The 
voltage across R, vDB, is measured by the probe and sent into the response port of the 
network analyzer. Note that the input impedance of the probe is 10-MΩ resistance 
and 8-pF capacitance in parallel.
As seen from Fig. 6.17b, due to the continuity of current, the displacement current 
idis ﬂowing through the inter-winding capacitance is equal to the current i ﬂowing 
through the resistor R and the input impedance of the probe, which are connected in 
parallel. Thus, the generated voltage vDB forms an indirect observation for idis. The  
network analyzer adopts Agilent E5061B, which measures the magnitude and phase 
of the transfer function from vAB to vDB within [150 kHz, 30 MHz] conducted EMI 
frequency range. 
Figure 6.17c shows the transformer under test. The core uses RM 10. The primary 
winding adopts single strand enameled wire with 0.3 mm, and its turns number NP 
= 29; The secondary winding uses single strand enameled wire with 0.8 mm, and 
its turns number NS = 11. The structural capacitance C0 is measured by LCR meter 
at 100 kHz. In the measurement, the primary winding and secondary winding are 
shorted, respectively, and the capacitance between the shorted two windings is C0. 
The measured C0 at 100 kHz is 38.23 pF. Owing to the single-layer structure, the 
winding structural parameter λP = λS = 0.5. By substituting them into (6.14), the 
equivalent lumped capacitances are expressed as 
uppe r C Su bscri pt A C Base line equals upper C Subscript BD Baseline equals upper C comma upper C Subscript AD Baseline equals upper C Subscript BC Baseline equals StartFraction upper C 0 Over 2 EndFraction minus upper C
up per
 C Subscript AC Baseline equals upper C Subscript BD Baseline equals upper C comma upper C Subscript AD Baseline equals upper C Subscript BC Baseline equals StartFraction upper C 0 Over 2 EndFraction minus upper C
Assuming the leakage inductance of the transformer is so small that can be 
neglected, Fig. 6.18 shows the equivalent circuit of that shown in Fig. 6.17b, where 
the transformer secondary winding is substituted with a controlled voltage source

114
6
Modeling of the Common-Mode Noise for Isolated DC-DC Converters
A 
B 
10kΩ resistor 
D 
C 
Response port 
Agilent E5061B 
Excitation port 
50Ω 
vac 
R (10kΩ) 
vDB
Excitation 
port 
Open 
vAB 
A
C
 
B
D
 
* 
* 
1 : n 
idis 
i 
10MΩ 
8pF 
Response 
port 
(a) Test setup                                                     (b) The circuit for testing 
D
B
 
A 
Core 
C 
Primary winding 
Secondary winding 
Graphic symbol: 
Insulation tape 
(c) The winding structure of the transformers under test 
Fig. 6.17 The principle of measuring the lumped capacitor of the transformer
nvAB, and n = NS/NP is the secondary-to-primary winding turns ratio. For simpli-
fying the calculation, the C in (6.20) is set  to  C0/2. Thus, we have CAC = CBD = C0/ 
2, and CAD = CBC = 0, which are accordingly not shown in Fig. 6.18. In addition, 
since the 10-MΩ resistance in the input impedance of the probe is far larger than the 
10-kΩ resistance, it can be neglected.
According to Fig. 6.18, the transfer function from vAB to vDB can be derived as 
upper G Subscript TR Baseline left parenthesis s right parenthesis equals StartFraction v Subscript DB Baseline left parenthesis s right parenthesis Over v Subscript AB Baseline left parenthesis s right parenthesis EndFraction equals StartFraction 1 plus n Over 2 EndFraction StartFraction s upper R upper C 0 Over s upper R left parenthesis upper C 0 plus upper C Subscript probe Baseline right parenthesis plus 1 EndFraction
upper G Sub script TR Baseline left parenthesis s right parenthesis equals StartFraction v Subscript DB Baseline left parenthesis s right parenthesis Over v Subscript AB Baseline left parenthesis s right parenthesis EndFraction equals StartFraction 1 plus n Over 2 EndFraction StartFraction s upper R upper C 0 Over s upper R left parenthesis upper C 0 plus upper C Subscript probe Baseline right parenthesis plus 1 EndFraction
up
per G Subscript TR Baseline left parenthesis s right parenthesis equals StartFraction v Subscript DB Baseline left parenthesis s right parenthesis Over v Subscript AB Baseline left parenthesis s right parenthesis EndFraction equals StartFraction 1 plus n Over 2 EndFraction StartFraction s upper R upper C 0 Over s upper R left parenthesis upper C 0 plus upper C Subscript probe Baseline right parenthesis plus 1 EndFraction
up
p
er G Subscr
i
pt T
R Baseline left parenthesis s right parenthesis equals StartFraction v Subscript DB Baseline left parenthesis s right parenthesis Over v Subscript AB Baseline left parenthesis s right parenthesis EndFraction equals StartFraction 1 plus n Over 2 EndFraction StartFraction s upper R upper C 0 Over s upper R left parenthesis upper C 0 plus upper C Subscript probe Baseline right parenthesis plus 1 EndFraction
Figure 6.19 shows the measured and theoretical curves of GTR(s). As seen, the 
theoretical and measured curves match well from 150 kHz to 30 MHz, verifying the 
effectiveness of the lumped capacitance model for the transformer.

6.5 Experimental Veriﬁcation and Discussions
115
Fig. 6.18 The theoretical 
model for calculating the 
transfer function G(s)
Fig. 6.19 The measured and 
theoretical transfer function 
GTR(s) for the transformer 
6.5.2 
The Veriﬁcation of the CM Noise Model 
1. The Speciﬁcations of the Prototype 
A ﬂyback converter prototype is built to verify the ENS for the CM noise, as shown 
in Fig. 6.20a. Figure 6.20b illustrates the the main circuit. The speciﬁcations of the 
prototype are: input voltage vac = 90~264 V, output voltage V o = 19.5 V, output 
power Po = 40 W. The switching frequency is 66.5 kHz, and the components used 
in the prototype are listed in Table 6.3.

116
6
Modeling of the Common-Mode Noise for Isolated DC-DC Converters
Heatsink 
Do 
Q 
Cx
T1 
Co 
Cin 
A
C 
B
D 
E
F
To auxiliary 
supply 
Vo 
vac 
* 
* 
* 
Q 
Co 
Do 
Cin 
Cx 
High side 
Low side 
PE 
Cp1 
R1
C1 
D1 
Llk_p 
R2 C2 
SG 
PG 
core 
PG 
Cp2 
Cp3 
(a) Photo of the prototype                         (b) The main circuit of flyback converter 
Fig. 6.20 The photo and the main circuit of ﬂyback converter 
Table 6.3 The key parameters of the prototype and the measured parasitic capacitance 
Main circuit
Snubber circuit
Parasitic capacitance 
Cx
0.22 μF
R1
94 kΩ
Cp1
11.00 pF 
Cin
68 μF
C1
2200 pF
Cp2
5.5 pF 
Co
680 μF
D1
S1PM-E3/84A
Cp3
14.67 pF 
Q
AOTF10N60 
(10 A/600 V) 
R2
47 Ω
Do
STPS20120CT 
(20 A/120 V) 
C2
220 pF 
In Fig. 6.20b, a 0.22-μF differential-mode (DM) capacitor Cx is added in front 
of the rectiﬁer bridge for eliminating the mixed-mode noise [6]. In addition, the 
transformer core is wrapped by copper foil, and the foil is connected to the PG for 
blocking the electric coupling between the primary winding and the PE via the core. 
The parasitic capacitances Cp1 (drain-to-PE), Cp2 (from the core to the cathode of 
Do via the heat sink for Do) and Cp3 (core-to-SG) are measured by LCR meter at 
100-kHz test frequency, and they are also listed in Table 6.3. 
Figure 6.21 shows the transformer winding structure. RM 8 core is employed, and 
single strand of enameled wire is adopted for these windings. The winding dimension 
and measured parameters are listed in Table 6.4, where, the primary winding turns 
number NP = 54, and the secondary winding turns number NS = 10.
The measured parameters of the transformer are listed in Table 6.5, where, Lmp 
is the magnetizing inductance and Llk_p is the primary leakage inductance. The 
secondary leakage inductance is very small and can be neglected. Besides, C01 is the 
structural capacitance between WP1 and WS, and C02 is the structural capacitance 
between WP2 and WS, they are measured step-by-step during the manufacturing of 
the transformer. When WP1 and WS winding layers have been wound, the measured 
structural capacitance of the transformer is C01. After that, when WP2 has been 
wound, the measured structural capacitance is C01 + C02, which is increased by C02, 
so C02 can be calculated accordingly.

6.5 Experimental Veriﬁcation and Discussions
117
Fig. 6.21 The winding structure of the transformer 
Table 6.4 The turns number and winding dimension of the transformer 
Turns number
Winding dimension (mm) 
Primary winding AB
NP1 = 23 (WP1)
0.3 
NP2 = 23 (WP2) 
NP3 = 8 (WP3) 
Secondary winding CD
NS = 10 (WS)
0.5 
Auxiliary winding EF
NA = 11 (WA)
0.2
Table 6.5 The measured parameters of the transformer 
Magnetizing inductance Lmp
715 μH
Structural capacitance C01
25.50 pF 
Leakage inductance Llk_p
6.17 μH
Structural capacitance C02
25.70 pF 
Referring to (6.9) and (6.11), λP, λS and C0 for the transformer in Fig. 6.21 are 
given by 
S
tart
Layo
ut Enlarg ed lef t brac e 1
st Ro w upper C 0 equals upper C 01 plus upper C 02 equals 51.2 pF 2nd Row lamda Subscript upper P Baseline equals StartFraction 1 Over upper C 0 EndFraction left parenthesis StartFraction 2 upper N Subscript upper P Baseline minus upper N Subscript upper P 1 Baseline Over 2 upper N Subscript upper P Baseline EndFraction upper C 01 plus StartFraction 2 upper N Subscript upper P Baseline minus 3 upper N Subscript upper P 1 Baseline Over 2 upper N Subscript upper P Baseline EndFraction upper C 02 right parenthesis equals 0.573 3rd Row lamda Subscript upper S Baseline equals StartFraction 1 Over upper C 0 EndFraction left parenthesis StartFraction upper N Subscript upper S Baseline plus 0 Over 2 upper N Subscript upper S Baseline EndFraction upper C 01 plus StartFraction 0 plus upper N Subscript upper S Baseline Over 2 upper N Subscript upper S Baseline EndFraction upper C 02 right parenthesis equals 0.5 EndLayout
St
a
rtLayout Enlarged left brace 1st Row upper C 0 equals upper C 01 plus upper C 02 equals 51.2 pF 2nd Row lamda Subscript upper P Baseline equals StartFraction 1 Over upper C 0 EndFraction left parenthesis StartFraction 2 upper N Subscript upper P Baseline minus upper N Subscript upper P 1 Baseline Over 2 upper N Subscript upper P Baseline EndFraction upper C 01 plus StartFraction 2 upper N Subscript upper P Baseline minus 3 upper N Subscript upper P 1 Baseline Over 2 upper N Subscript upper P Baseline EndFraction upper C 02 right parenthesis equals 0.573 3rd Row lamda Subscript upper S Baseline equals StartFraction 1 Over upper C 0 EndFraction left parenthesis StartFraction upper N Subscript upper S Baseline plus 0 Over 2 upper N Subscript upper S Baseline EndFraction upper C 01 plus StartFraction 0 plus upper N Subscript upper S Baseline Over 2 upper N Subscript upper S Baseline EndFraction upper C 02 right parenthesis equals 0.5 EndLayout
Star
tLay out Enlarged left brace 1st Row upper C 0 equals upper C 01 plus upper C 02 equals 51.2 pF 2nd Row lamda Subscript upper P Baseline equals StartFraction 1 Over upper C 0 EndFraction left parenthesis StartFraction 2 upper N Subscript upper P Baseline minus upper N Subscript upper P 1 Baseline Over 2 upper N Subscript upper P Baseline EndFraction upper C 01 plus StartFraction 2 upper N Subscript upper P Baseline minus 3 upper N Subscript upper P 1 Baseline Over 2 upper N Subscript upper P Baseline EndFraction upper C 02 right parenthesis equals 0.573 3rd Row lamda Subscript upper S Baseline equals StartFraction 1 Over upper C 0 EndFraction left parenthesis StartFraction upper N Subscript upper S Baseline plus 0 Over 2 upper N Subscript upper S Baseline EndFraction upper C 01 plus StartFraction 0 plus upper N Subscript upper S Baseline Over 2 upper N Subscript upper S Baseline EndFraction upper C 02 right parenthesis equals 0.5 EndLayout
Star
tLa
y
out Enla
rge d left brace 1st Row upper C 0 equals upper C 01 plus upper C 02 equals 51.2 pF 2nd Row lamda Subscript upper P Baseline equals StartFraction 1 Over upper C 0 EndFraction left parenthesis StartFraction 2 upper N Subscript upper P Baseline minus upper N Subscript upper P 1 Baseline Over 2 upper N Subscript upper P Baseline EndFraction upper C 01 plus StartFraction 2 upper N Subscript upper P Baseline minus 3 upper N Subscript upper P 1 Baseline Over 2 upper N Subscript upper P Baseline EndFraction upper C 02 right parenthesis equals 0.573 3rd Row lamda Subscript upper S Baseline equals StartFraction 1 Over upper C 0 EndFraction left parenthesis StartFraction upper N Subscript upper S Baseline plus 0 Over 2 upper N Subscript upper S Baseline EndFraction upper C 01 plus StartFraction 0 plus upper N Subscript upper S Baseline Over 2 upper N Subscript upper S Baseline EndFraction upper C 02 right parenthesis equals 0.5 EndLayout
St
a
rtLayout Enlarged left brace 1st Row upper C 0 equals upper C 01 plus upper C 02 equals 51.2 pF 2nd Row lamda Subscript upper P Baseline equals StartFraction 1 Over upper C 0 EndFraction left parenthesis StartFraction 2 upper N Subscript upper P Baseline minus upper N Subscript upper P 1 Baseline Over 2 upper N Subscript upper P Baseline EndFraction upper C 01 plus StartFraction 2 upper N Subscript upper P Baseline minus 3 upper N Subscript upper P 1 Baseline Over 2 upper N Subscript upper P Baseline EndFraction upper C 02 right parenthesis equals 0.573 3rd Row lamda Subscript upper S Baseline equals StartFraction 1 Over upper C 0 EndFraction left parenthesis StartFraction upper N Subscript upper S Baseline plus 0 Over 2 upper N Subscript upper S Baseline EndFraction upper C 01 plus StartFraction 0 plus upper N Subscript upper S Baseline Over 2 upper N Subscript upper S Baseline EndFraction upper C 02 right parenthesis equals 0.5 EndLayout
Star tLay out Enlarged left brace 1st Row upper C 0 equals upper C 01 plus upper C 02 equals 51.2 pF 2nd Row lamda Subscript upper P Baseline equals StartFraction 1 Over upper C 0 EndFraction left parenthesis StartFraction 2 upper N Subscript upper P Baseline minus upper N Subscript upper P 1 Baseline Over 2 upper N Subscript upper P Baseline EndFraction upper C 01 plus StartFraction 2 upper N Subscript upper P Baseline minus 3 upper N Subscript upper P 1 Baseline Over 2 upper N Subscript upper P Baseline EndFraction upper C 02 right parenthesis equals 0.573 3rd Row lamda Subscript upper S Baseline equals StartFraction 1 Over upper C 0 EndFraction left parenthesis StartFraction upper N Subscript upper S Baseline plus 0 Over 2 upper N Subscript upper S Baseline EndFraction upper C 01 plus StartFraction 0 plus upper N Subscript upper S Baseline Over 2 upper N Subscript upper S Baseline EndFraction upper C 02 right parenthesis equals 0.5 EndLayout
Star tLa
y
out En
larged left brace 1st Row upper C 0 equals upper C 01 plus upper C 02 equals 51.2 pF 2nd Row lamda Subscript upper P Baseline equals StartFraction 1 Over upper C 0 EndFraction left parenthesis StartFraction 2 upper N Subscript upper P Baseline minus upper N Subscript upper P 1 Baseline Over 2 upper N Subscript upper P Baseline EndFraction upper C 01 plus StartFraction 2 upper N Subscript upper P Baseline minus 3 upper N Subscript upper P 1 Baseline Over 2 upper N Subscript upper P Baseline EndFraction upper C 02 right parenthesis equals 0.573 3rd Row lamda Subscript upper S Baseline equals StartFraction 1 Over upper C 0 EndFraction left parenthesis StartFraction upper N Subscript upper S Baseline plus 0 Over 2 upper N Subscript upper S Baseline EndFraction upper C 01 plus StartFraction 0 plus upper N Subscript upper S Baseline Over 2 upper N Subscript upper S Baseline EndFraction upper C 02 right parenthesis equals 0.5 EndLayout
2. The Experimental Results 
The conducted EMI of the ﬂyback converter is measured in the electromagnetic 
shielding chamber. In the test, the LISN employees R&S ENV216, the noise separator

118
6
Modeling of the Common-Mode Noise for Isolated DC-DC Converters
adopts Mini-Circuit ZSC-2-2 (Common Mode), and the EMI receiver uses Schaffner 
SCR3502. The test conditions are 220-V input rms voltage and full-load. Besides, 
the SG and the heat sink are connected to the PE in the measurement. 
To verify the validity of the CM noise model, the simulated and measured CM 
noise spectra are compared. The main circuit for simulation is shown in Fig. 6.20b, 
and the leakage inductance and lumped capacitance are shown in Fig. 6.22. As  
seen, the solution of the lumped capacitance goes with (CAC, CAD, CBC, CBD) = (0, 
λPC0, λSC0, (1 –  λP – λS)C0). In addition, the snubber circuit, leakage inductance, 
the calculated lumped capacitance and Cp1, Cp2 and Cp3 are also included in the 
simulation. 
Figure 6.23 shows the comparison between the simulated envelope (every two 
adjacent noise peaks are connected with a straight line) and measured spectrum 
of the CM EMI (peak value) from the ﬂyback converter. As can be observed, the 
simulated envelope and measured spectrum are almost matched below 2 MHz. 
Referring to Sect. 6.3, by including the lumped capacitance of the transformer 
and the parasitic capacitance Cp1, Cp2 and Cp3, the  ENS  vENS_FLY1 and vENS_FLY2 of 
the ﬂyback converter when the rectiﬁer diode is at the high side and low side are 
respectively given by
Fig. 6.22 The transformer 
parasitics in the simulation 
*
*
Lmp 
(1–λP–λS)C0 
λSC0 
λPC0 
A 
B 
C 
D 
Llk_p 
Ideal 
transformer 
Fig. 6.23 The comparison between the measured spectrum and simulated envelope (peak) 

6.5 Experimental Veriﬁcation and Discussions
119
v Subscrip t ENS  norm al bar FL Y 1 Baseline equals StartFraction left parenthesis 1 minus lamda Subscript upper P Baseline minus n lamda Subscript upper S Baseline right parenthesis upper C 0 plus upper C Subscript p 1 Baseline Over upper C 0 plus upper C Subscript p 1 Baseline plus upper C Subscript p 2 Baseline plus upper C Subscript p 3 Baseline EndFraction v Subscript upper Q
v S ubscri pt ENS  norma
l 
bar FLY 1 Baseline equals StartFraction left parenthesis 1 minus lamda Subscript upper P Baseline minus n lamda Subscript upper S Baseline right parenthesis upper C 0 plus upper C Subscript p 1 Baseline Over upper C 0 plus upper C Subscript p 1 Baseline plus upper C Subscript p 2 Baseline plus upper C Subscript p 3 Baseline EndFraction v Subscript upper Q
v Subscrip t ENS  norm al bar  FLY 2 Ba seline  equals StartFraction left bracket 1 minus lamda Subscript upper P Baseline plus n left parenthesis 1 minus lamda Subscript upper S Baseline right parenthesis right bracket upper C 0 plus upper C Subscript p 1 Baseline plus n upper C Subscript p 2 Baseline Over upper C 0 plus upper C Subscript p 1 Baseline plus upper C Subscript p 2 Baseline plus upper C Subscript p 3 Baseline EndFraction v Subscript upper Q
v S ubscri pt ENS  norma
l 
bar FLY 2 Baseline equals StartFraction left bracket 1 minus lamda Subscript upper P Baseline plus n left parenthesis 1 minus lamda Subscript upper S Baseline right parenthesis right bracket upper C 0 plus upper C Subscript p 1 Baseline plus n upper C Subscript p 2 Baseline Over upper C 0 plus upper C Subscript p 1 Baseline plus upper C Subscript p 2 Baseline plus upper C Subscript p 3 Baseline EndFraction v Subscript upper Q
According to the CM noise model in Fig. 6.8b, the CM noise vCM is related 
to the source impedance and the ENS of the converter. Under these two circuit 
conﬁgurations, the source impedance is the same, and the ENS is proportional to vQ, 
so the CM noise spectrum is proportional to the coefﬁcient before vQ in the ENS. 
According to (6.23) and (6.24), the spectrum difference ΔFLY is calculated, and it is 
expressed in decibles, i.e.,
norma l upp er
 Del
ta Subscript FLY Baseline equals 20 log base 10 StartAbsoluteValue StartFraction v Subscript ENS normal bar FLY 1 Baseline Over v Subscript ENS normal bar FLY 2 Baseline EndFraction EndAbsoluteValue equals 20 log base 10 StartAbsoluteValue StartFraction left parenthesis 1 minus lamda Subscript upper P Baseline minus n lamda Subscript upper S Baseline right parenthesis upper C 0 plus upper C Subscript p 1 Baseline Over left bracket 1 minus lamda Subscript upper P Baseline plus n left parenthesis 1 minus lamda Subscript upper S Baseline right parenthesis right bracket upper C 0 plus upper C Subscript p 1 Baseline plus n upper C Subscript p 2 Baseline EndFraction EndAbsoluteValue left parenthesis dB right parenthesis
normal up
per Delta  S
ubsc
rip t FLY  Baseline  equals 20 log base 10 StartAbsoluteValue StartFraction v Subscript ENS normal bar FLY 1 Baseline Over v Subscript ENS normal bar FLY 2 Baseline EndFraction EndAbsoluteValue equals 20 log base 10 StartAbsoluteValue StartFraction left parenthesis 1 minus lamda Subscript upper P Baseline minus n lamda Subscript upper S Baseline right parenthesis upper C 0 plus upper C Subscript p 1 Baseline Over left bracket 1 minus lamda Subscript upper P Baseline plus n left parenthesis 1 minus lamda Subscript upper S Baseline right parenthesis right bracket upper C 0 plus upper C Subscript p 1 Baseline plus n upper C Subscript p 2 Baseline EndFraction EndAbsoluteValue left parenthesis dB right parenthesis
nor mal u pper D elta Subs cript FLY Ba
seli ne eq
uals 20 log base 10 StartAbsoluteValue StartFraction v Subscript ENS normal bar FLY 1 Baseline Over v Subscript ENS normal bar FLY 2 Baseline EndFraction EndAbsoluteValue equals 20 log base 10 StartAbsoluteValue StartFraction left parenthesis 1 minus lamda Subscript upper P Baseline minus n lamda Subscript upper S Baseline right parenthesis upper C 0 plus upper C Subscript p 1 Baseline Over left bracket 1 minus lamda Subscript upper P Baseline plus n left parenthesis 1 minus lamda Subscript upper S Baseline right parenthesis right bracket upper C 0 plus upper C Subscript p 1 Baseline plus n upper C Subscript p 2 Baseline EndFraction EndAbsoluteValue left parenthesis dB right parenthesis
By substituting λP, λS, C0, Cp1, Cp2, Cp3 and n into (6.25), ΔFLY is equal to − 
2.75 dB. This means the CM noise spectrum of the ﬂyback converter with rectiﬁer 
diode at the high side is 2.75 dB lower than that with the rectiﬁer diode at the low 
side. 
The measured CM EMI spectra with different diode positions are provided in 
Fig. 6.24a. As can be seen, their CM noise spectra have similar pattern. Besides, 
the CM noise when the rectiﬁer diode is at the high side is 2–3 dB lower than that 
when the rectiﬁer diode is at the low side. As shown in Fig. 6.24b, by moving up 
the CM noise spectra when the rectiﬁer diode is at the high side by 2.75 dB, the 
measured results are almost overlapped in the low frequency range from 150 kHz to 
1 MHz. Therefore, the effectiveness of the ENS method in the low frequency range 
is veriﬁed. 
60 
CM Noise (dBμV) 
120 
100 
80 
40 
1M
10M
30M
150k 
f (Hz) 
Low side 
High side 
60 
CM Noise (dBμV) 
120 
100 
80 
40 
1M
10M
30M
150k 
f (Hz) 
Low side 
High side (+2.75dB) 
(a) Original case 
(b) Moving up the CM noise spectra 
(high side) by 2.75 dB 
Fig. 6.24 The comparison of the measured spectrum with different position of Do (peak)

120
6
Modeling of the Common-Mode Noise for Isolated DC-DC Converters
6.6 
Summary 
In this chapter, a generalized lumped capacitance model for the transformer is 
proposed, which equivalently represents the inter-winding capacitance of the trans-
former with a general winding structure. With this model, the CM noise models of 
the basic isolated DC-DC converters, which consist of the source impedance and 
the equivalent noise source (ENS) voltage connected in series, are established for 
analyzing the CM noise. The source impedance equals to the transformer structural 
capacitance puls the CM parasitic capacitance between the high dv/dt nodes in the 
primary circuit and the PE. The ENS is related to the transformer winding struc-
ture and the circuit conﬁguration. By analyzing the characteristics of the ENS, it 
is revealed that some topologies have the CMNC capability, including the ﬂyback 
converter with output rectiﬁer diode at the high side, the forward converter with 
rectiﬁer diode and output ﬁlter inductor at the low side, as well as push–pull and 
half-bridge converters. For the full-bridge converter, it exhibits CMNC capability 
with PWM control, but lacks CMNC capability with phase-shift control. Finally, 
the lumped capacitance model for the transformer and the CM noise model of the 
isolated DC-DC converter are veriﬁed by the experimental results, respectively. 
References 
1. Y. Chu, S. Wang, A generalized common mode current cancellation approach for power 
converters. IEEE Trans. Industr. Electron. 62(7), 4130–4140 (2015) 
2. P. Kong, F.C. Lee, Transformer structure and its effects on common mode EMI noise in isolated 
power converters, in Proceedings of IEEE Applied Power Electronics Conference and Exposition 
(APEC) (2010), pp. 1424–1429 
3. J. Collins, An accurate method for modeling transformer winding capacitance, in Proceedings 
of Annual Conference of IEEE Industrial Electronics Society (IECON) (1900), pp. 1094–1099 
4. P. Meng, J. Zhang, H. Chen, Z. Qian, Y. Shen, Characterizing noise source and coupling path in 
ﬂyback converter for common-mode noise prediction, in Proceedings of IEEE Applied Power 
Electronics Conference and Exposition (APEC) (2011), pp. 1704–1709 
5. Q. Chen, W. Chen, An evaluation method of transformer behaviors on the suppression of 
common-mode conduction noise in switch mode power supply, in Proceedings of the Chinese 
Society for Electrical Engineering (CSEE), vol. 32, no. 18 (2012), pp. 73–79 (in Chinese) 
6. H.-I. Hsieh, D.-Y. Chen, EMI ﬁlter design method incorporating mix-mode conducted noise for 
off-line applications, in Proceedings of IEEE Vehicle Power and Propulsion Conference (VPPC) 
(2008), pp. 1617–1622

Chapter 7 
Shielding-Based Common-Mode Noise 
Cancellation Techniques for Isolated 
DC-DC Converters 
7.1 
Shielding Techniques 
In isolated DC-DC converters, the transformer inter-winding capacitance between 
the primary and secondary windings is a critical propagation path for common-mode 
(CM) noise. To block the displacement current ﬂowing through this propagation path 
for reducing the CM noise, shielding layer is usually added between the primary and 
secondary windings. In this section, the performance of single- and double-shielding 
techniques will be reviewed. 
7.1.1 
Single-Shielding Technique 
Figure 7.1a shows the single-shielding technique in wire-wound transformers, where, 
a shielding layer SP is inserted between the primary-winding layer WP2 and the 
secondary-winding layer WS, and it is connected to the primary ground (PG). With 
this shielding layer, the displacement current between WP2 and WS is eliminated. 
However, two displacement currents are generated, which ﬂow between SP and WP2, 
and between SP and WS, respectively. Figure 7.1b shows the propagation path for 
these two displacement currents in isolated DC-DC converters, where, the isolated 
DC-DC converters consist of the primary circuit, transformer, and the secondary 
rectiﬁer and ﬁlter. The 25-Ω resistor is the equivalent impedance for the CM noise 
at the line impedance stabilization network (LISN) side.
According to Fig. 7.1b, the displacement current ﬂowing between SP and WP2 
returns to the PG via the grounded wire of SP and does not cause CM noise, while 
the current idis that ﬂows between SP and WS returns to the PE and still causes the 
CM noise.
© The Author(s), under exclusive license to Springer Nature Singapore Pte Ltd. 2024 
X. Ruan et al., Conducted Electromagnetic Interference in Power Converters: Modeling, 
Prediction and Reduction, CPSS Power Electronics Series, 
https://doi.org/10.1007/978-981-99-9295-9_7 
121

122
7
Shielding-Based Common-Mode Noise Cancellation Techniques …
Primary 
Secondary 
Core 
Shielding 
SP
WP2
WS
WP1 
PG 
D 
C 
B
A
PE 
25 Ω 
*
*
Secondary 
rectifier 
and filter 
Primary 
Circuit 
PG 
SG 
idis 
vCM 
SP 
(a) The transformer with single 
shielding 
(b) The CM noise propagation path 
Fig. 7.1 The Transformer with single shielding and its CM noise propagation path
In Fig. 7.1, if  SP is connected to the secondary ground (SG), the displacement 
current ﬂowing between SP and WS returns to the SG and does not cause CM noise, 
while the current that ﬂows between SP and WP2 returns to the PE and still causes 
the CM noise. 
7.1.2 
Double-Shielding Technique 
In order to eliminate the displacement current ﬂowing between SP and WS and 
enhance the CM noise reduction, another shielding layer SS can be added between 
SP and WS, and it is connected to the SG, as shown in Fig. 7.2a. The technique with 
two shielding layers is referred to as the double-shielding technique [1]. 
Figure 7.2b shows the CM noise propagation path with the double-shielding tech-
nique. According to the cut set from the inter-winding capacitance between SP and 
SS to the PE, the displacement current ﬂowing through SP and SS equals to idis that 
returns to the 25-Ω resistor. Since SP and SS have the same winding direction, the
PG SG 
SP
WP2
WP1
WS
SS 
Primary 
Secondary 
Core 
Shielding 
D 
C 
B
A
PE 
25Ω 
*
*
Secondary 
rectifier 
and filter 
Primary 
circuit 
PG
SG 
idis 
vCM 
SP SS 
Cut set 
Cps 
(a) The transformer with double 
shielding 
(b) The CM noise propagation path 
Fig. 7.2 The transformer with double-shielding and its CM noise propagation path 

7.2 Condition and Solutions to Achieve the CM Noise Cancellation
123
voltage across the inter-winding capacitance Cps between SP and SS equals to the 
voltage across the PG and SG. Thus, the SP and SS have the same electric poten-
tial distribution, and the CM noise is reduced. However, for the transformer with 
interleaved winding structure, two shielding layers should be added between every 
adjacent primary- and secondary-winding layers. As a result, these shielding layers 
will occupy large window and increase the complexity of manufacture. 
7.2 
Condition and Solutions to Achieve the CM Noise 
Cancellation 
7.2.1 
Condition to Achieve the CM Noise Cancellation 
For the single-shielding technique, in order to achieve the common-mode noise 
cancellation (CMNC) capability, the displacement current ﬂowing between the 
shielding layer and its adjacent secondary winding should be eliminated. 
According to Sect. 6.2.2 in Chap. 6, the displacement current idis ﬂowing between 
SP and WS in Fig. 7.1a is given by 
i Sub scrip
t dis Baseline equals upper C 0 StartFraction d Over d t EndFraction left parenthesis ModifyingAbove v With quotation dash Subscript SP Baseline minus ModifyingAbove v With quotation dash Subscript WS Baseline right parenthesis
i S ubscript dis Baseline equals upper C 0 StartFraction d Over d t EndFraction left parenthesis ModifyingAbove v With quotation dash Subscript SP Baseline minus ModifyingAbove v With quotation dash Subscript WS Baseline right parenthesisi Su bscript dis Baseline equals upper C 0 StartFraction d Over d t EndFraction left parenthesis ModifyingAbove v With quotation dash Subscript SP Baseline minus ModifyingAbove v With quotation dash Subscript WS Baseline right parenthesisi Su
bscript dis Baseline equals upper C 0 StartFraction d Over d t EndFraction left parenthesis ModifyingAbove v With quotation dash Subscript SP Baseline minus ModifyingAbove v With quotation dash Subscript WS Baseline right parenthesis
where, C0 is the structural capacitance between SP and WS, and ModifyingAbove v With quotation dash Subscript SP and ModifyingAbove v With quotation dash Subscript WS are the 
averaged electric potential (AEP) of SP and WS with respect to the PE, respectively. 
According to (7.1), the condition for idis = 0 is  
Modi fyingAbove v With quotation dash Subscript SP Baseline equals ModifyingAbove v With quotation dash Subscript WSMod
ifyingAbove v With quotation dash Subscript SP Baseline equals ModifyingAbove v With quotation dash Subscript WS
Referring to Fig. 7.1b, idis = 0 indicates vCM = 0, so the PG, PE and SG are equi-
potential in the conducted electromagnetic interference (EMI) frequency range. In 
this case, the AEP of SP with respect to the PG is equal to that of WS with respect 
to the SG. For the convenience of illustration, the reference ground for the shielding 
layer and secondary-winding layer is reselected as the PG and SG, respectively. 
7.2.2 
The AEP of Secondary-Winding Layers and Shielding 
Layers 
1. A General Expression for the AEP of Secondary-Winding Layers 
Figure 7.3a, b shows the typical structure of secondary-winding layer WS with NS 
turns in the wire-wound transformer and planar transformer, respectively. The electric

124
7
Shielding-Based Common-Mode Noise Cancellation Techniques …
Fig. 7.3 The winding in 
wire-wound and planar 
transformer 
C 
D 
C
r1 
r2
D 
(a) Wire-wound winding
  (b) Planar winding 
potential of terminals C and D with respect to the SG are denoted by vC and vD, 
respectively. 
According to Sect. 6.2.2 in Chap. 6, the AEP for a wire-wound winding is 
Modi fyingAbov e v Wi th qu o tation
 dash Subscript WS Baseline equals 0.5 left parenthesis v Subscript upper C Baseline plus v Subscript upper D Baseline right parenthesis left parenthesis wire hyphen wound right parenthesis
The AEP of a planar winding is given by [2] 
Modi fyingAb ove v  With qu
otation 
dash Subscript WS Baseline equals lamda 1 v Subscript upper C Baseline plus left parenthesis 1 minus lamda 1 right parenthesis v Subscript upper D Baseline left parenthesis planar right parenthesis
where, λ1 is expressed as 
lam da
 1 equals StartStartFraction two thirds r 1 plus one third r 2 plus StartFraction r 2 minus r 1 Over 6 upper N Subscript upper S Superscript 2 Baseline EndFraction OverOver r 1 plus r 2 EndEndFraction
lamd a 1 equals StartStartFraction two thirds r 1 plus one third r 2 plus StartFraction r 2 minus r 1 Over 6 upper N Subscript upper S Superscript 2 Baseline EndFraction OverOver r 1 plus r 2 EndEndFraction
lamd a 1 equals StartStartFraction two thirds r 1 plus one third r 2 plus StartFraction r 2 minus r 1 Over 6 upper N Subscript upper S Superscript 2 Baseline EndFraction OverOver r 1 plus r 2 EndEndFraction
la md
a 1 equals StartStartFraction two thirds r 1 plus one third r 2 plus StartFraction r 2 minus r 1 Over 6 upper N Subscript upper S Superscript 2 Baseline EndFraction OverOver r 1 plus r 2 EndEndFraction
lam da 1 
equals StartStartFraction two thirds r 1 plus one third r 2 plus StartFraction r 2 minus r 1 Over 6 upper N Subscript upper S Superscript 2 Baseline EndFraction OverOver r 1 plus r 2 EndEndFraction
where, r1 is the inner radius, and r2 is the outer radius. 
Denoting the voltage across a single-turn winding as vst, the electric potential of 
C is  
v S ubscript  upp
er C Baseline equals upper N Subscript upper S Baseline v Subscript st Baseline plus v Subscript upper D
Substitution of (7.6) into (7.3) and (7.4), respectively, yields
StartLayout Enlarged left brace 1st Row ModifyingAbove v With quotation dash Subscript WS Baseline equals 0.5 upper N Subscript upper S Baseline v Subscript st Baseline plus v Subscript upper D Baseline left parenthesis wire hyphen wound right parenthesis 2nd Row ModifyingAbove v With quotation dash Subscript WS Baseline equals lamda 1 upper N Subscript upper S Baseline v Subscript st Baseline plus v Subscript upper D Baseline left parenthesis planar right parenthesis EndLayoutStar tLayout Enl arged
 left brace 1st Row ModifyingAbove v With quotation dash Subscript WS Baseline equals 0.5 upper N Subscript upper S Baseline v Subscript st Baseline plus v Subscript upper D Baseline left parenthesis wire hyphen wound right parenthesis 2nd Row ModifyingAbove v With quotation dash Subscript WS Baseline equals lamda 1 upper N Subscript upper S Baseline v Subscript st Baseline plus v Subscript upper D Baseline left parenthesis planar right parenthesis EndLayout
Star tLayout Enl arged
 left bra
ce 1st Row ModifyingAbove v With quotation dash Subscript WS Baseline equals 0.5 upper N Subscript upper S Baseline v Subscript st Baseline plus v Subscript upper D Baseline left parenthesis wire hyphen wound right parenthesis 2nd Row ModifyingAbove v With quotation dash Subscript WS Baseline equals lamda 1 upper N Subscript upper S Baseline v Subscript st Baseline plus v Subscript upper D Baseline left parenthesis planar right parenthesis EndLayout
2. General Expression for the AEP of Shielding Layers 
In a wire-wound transformer, the shielding layer takes the cylindrical shape with one 
turn and covers the window, and its cross section is shown in Fig. 7.4a. In a planar 
transformer, the shielding layer is shown in Fig. 7.4b. Usually, the shielding layer 
is connected to the primary circuit via terminal G. The angle from terminal H to 
terminal G is denoted by θ 0 (0 ≤ θ 0 ≤ 2π), and the electric potential of terminal G

7.2 Condition and Solutions to Achieve the CM Noise Cancellation
125
Fig. 7.4 The top view of 
shielding layer in 
wire-wound and planar 
transformer 
SP 
F H 
θ0 
M (θ=π) 
G 
SP 
F
H
 
θ0 
M (θ=π) 
G 
(a) Wire-wound 
transformer   
(b) Planar 
transformer 
with respect to the PG is denoted by vG. Assuming that the electric potential of the 
shielding layer rises linearly from terminal H to terminal F, the electric potentials of 
terminals F and H are expressed as. 
v S ubscr ipt upper F Baseline equals v Subscript upper G Baseline plus StartFraction 2 normal pi minus theta 0 Over 2 normal pi EndFraction v Subscript st
v S
ubs
cript upper F Baseline equals v Subscript upper G Baseline plus StartFraction 2 normal pi minus theta 0 Over 2 normal pi EndFraction v Subscript st
v S ubscr ip t upper H Baseline equals v Subscript upper G Baseline minus StartFraction theta 0 Over 2 normal pi EndFraction v Subscript st
v Subs
cript upper H Baseline equals v Subscript upper G Baseline minus StartFraction theta 0 Over 2 normal pi EndFraction v Subscript st
According to (7.8) and (7.9), the AEP of shielding layers is expressed as 
Modi fyingAbov e v With quotation dash Subscript SP Baseline equals 0.5 left parenthesis v Subscript upper F Baseline plus v Subscript upper H Baseline right parenthesis equals StartFraction pi minus theta 0 Over 2 pi EndFraction v Subscript st Baseline plus v Subscript upper G
Mod ifyi ngAb
ove v With quotation dash Subscript SP Baseline equals 0.5 left parenthesis v Subscript upper F Baseline plus v Subscript upper H Baseline right parenthesis equals StartFraction pi minus theta 0 Over 2 pi EndFraction v Subscript st Baseline plus v Subscript upper G
Since θ 0 ∈ [0, 2π ], we have 
Modi fyingAbove v With quotat ionGd
ash Subscript SP Baseline element of left bracket minus 0.5 v Subscript st Baseline plus v Subscript upper G Baseline comma 0.5 v Subscript st Baseline plus v Subscript upper G Baseline right bracket
Normally, terminal G in the shielding layer is connected to the PG, so we have 
vG = 0. Substituting vG = 0 into (7.11), yields 
Modi fyingAbove v With q
uotation dash Subscript SP Baseline element of left bracket minus 0.5 v Subscript st Baseline comma 0.5 v Subscript st Baseline right bracket
As seen, the AEP of shielding layers is within [–0.5vst, 0.5vst]. According to (7.7), 
the AEP of secondary windings will exceed [–0.5vst, 0.5vst] if the secondary winding 
has multiple turns and vD = 0. In this case, the AEP of secondary-winding layer and 
shielding layer is never equal, and the CMNC capability of shielding technique can 
not be achieved.

126
7
Shielding-Based Common-Mode Noise Cancellation Techniques …
7.2.3 
Solutions to Achieve the CMNC Capability 
According to (7.7), the AEP of secondary-winding layers depends on NS and vD, 
while according to (7.8) and (7.11), the AEP of shielding layers is only related to θ 0 
when vG = 0. In order to make the two AEP equal for cancelling the displacement 
current, the turns of shielding layers and vG can be adjusted as follows. 
1. Adjusting the Turns of Shielding Layers 
When the secondary-winding layer WS has turns of NS, the shielding layer can be 
adjusted into a shielding winding with turns of NSP. Take the wire-wound transformer 
as an example, the adjustement of shielding layer into shielding winding is shown 
in the left side in Fig. 7.5, where, the terminals of shielding winding is F and H, 
terminal G is connected to the PG, and vG = 0. 
Suppose the electric potential of SP increases linearly from vH, for wire-wound 
transformer and planar transformer, the AEP of SP is given by
StartLayout Enlarged left brace 1st Row ModifyingAbove v With quotation dash Subscript SP Baseline equals 0.5 left parenthesis v Subscript upper F Baseline plus v Subscript upper H Baseline right parenthesis equals 0.5 left bracket left parenthesis v Subscript upper H Baseline plus upper N Subscript SP Baseline v Subscript st Baseline right parenthesis plus v Subscript upper H Baseline right bracket equals 0.5 upper N Subscript SP Baseline v Subscript st Baseline plus v Subscript upper H Baseline left parenthesis wire hyphen wound right parenthesis 2nd Row ModifyingAbove v With quotation dash Subscript SP Baseline equals lamda 1 v Subscript upper F Baseline plus left parenthesis 1 minus lamda 1 right parenthesis v Subscript upper H Baseline equals lamda 1 left parenthesis upper N Subscript SP Baseline v Subscript st Baseline plus v Subscript upper H Baseline right parenthesis plus left parenthesis 1 minus lamda 1 right parenthesis v Subscript upper H Baseline equals lamda 1 upper N Subscript SP Baseline v Subscript st Baseline plus v Subscript upper H Baseline left parenthesis planar right parenthesis EndLayout
Star tLayout E nlarged left bra ce 1st Row Modif yingAbove v With 
quotation dash Subscript SP Baseline equals 0.5 left parenthesis v Subscript upper F Baseline plus v Subscript upper H Baseline right parenthesis equals 0.5 left bracket left parenthesis v Subscript upper H Baseline plus upper N Subscript SP Baseline v Subscript st Baseline right parenthesis plus v Subscript upper H Baseline right bracket equals 0.5 upper N Subscript SP Baseline v Subscript st Baseline plus v Subscript upper H Baseline left parenthesis wire hyphen wound right parenthesis 2nd Row ModifyingAbove v With quotation dash Subscript SP Baseline equals lamda 1 v Subscript upper F Baseline plus left parenthesis 1 minus lamda 1 right parenthesis v Subscript upper H Baseline equals lamda 1 left parenthesis upper N Subscript SP Baseline v Subscript st Baseline plus v Subscript upper H Baseline right parenthesis plus left parenthesis 1 minus lamda 1 right parenthesis v Subscript upper H Baseline equals lamda 1 upper N Subscript SP Baseline v Subscript st Baseline plus v Subscript upper H Baseline left parenthesis planar right parenthesis EndLayout
Star tLayout  Enla rged left brace 1s t Row Modif yingAbove v With q uotat
ion dash 
Subscript SP Baseline equals 0.5 left parenthesis v Subscript upper F Baseline plus v Subscript upper H Baseline right parenthesis equals 0.5 left bracket left parenthesis v Subscript upper H Baseline plus upper N Subscript SP Baseline v Subscript st Baseline right parenthesis plus v Subscript upper H Baseline right bracket equals 0.5 upper N Subscript SP Baseline v Subscript st Baseline plus v Subscript upper H Baseline left parenthesis wire hyphen wound right parenthesis 2nd Row ModifyingAbove v With quotation dash Subscript SP Baseline equals lamda 1 v Subscript upper F Baseline plus left parenthesis 1 minus lamda 1 right parenthesis v Subscript upper H Baseline equals lamda 1 left parenthesis upper N Subscript SP Baseline v Subscript st Baseline plus v Subscript upper H Baseline right parenthesis plus left parenthesis 1 minus lamda 1 right parenthesis v Subscript upper H Baseline equals lamda 1 upper N Subscript SP Baseline v Subscript st Baseline plus v Subscript upper H Baseline left parenthesis planar right parenthesis EndLayout
Substituting (7.7) and (7.13) into (7.1), idis for the wire-wound and planar 
transformers are
StartL ayout  Enlarged left brace 1st Row i Subscript dis Baseline equals upper C 0 StartFraction d Over d t EndFraction left bracket 0.5 v Subscript st Baseline left parenthesis upper N Subscript SP Baseline minus upper N Subscript upper S Baseline right parenthesis plus left parenthesis v Subscript upper H Baseline minus v Subscript upper D Baseline right parenthesis right bracket left parenthesis wire hyphen wound right parenthesis 2nd Row i Subscript dis Baseline equals upper C 0 StartFraction d Over d t EndFraction left bracket lamda 1 v Subscript st Baseline left parenthesis upper N Subscript SP Baseline minus upper N Subscript upper S Baseline right parenthesis plus left parenthesis v Subscript upper H Baseline minus v Subscript upper D Baseline right parenthesis right bracket left parenthesis planar right parenthesis EndLayout
Sta rtLayout Enl arged left b race 1s t Row i Subsc
ript dis B aseline equals upper C 0 StartFraction d Over d t EndFraction left bracket 0.5 v Subscript st Baseline left parenthesis upper N Subscript SP Baseline minus upper N Subscript upper S Baseline right parenthesis plus left parenthesis v Subscript upper H Baseline minus v Subscript upper D Baseline right parenthesis right bracket left parenthesis wire hyphen wound right parenthesis 2nd Row i Subscript dis Baseline equals upper C 0 StartFraction d Over d t EndFraction left bracket lamda 1 v Subscript st Baseline left parenthesis upper N Subscript SP Baseline minus upper N Subscript upper S Baseline right parenthesis plus left parenthesis v Subscript upper H Baseline minus v Subscript upper D Baseline right parenthesis right bracket left parenthesis planar right parenthesis EndLayout
Sta rtLayout En larged left brace 1 st Row i 
Subscript dis Baseline equals upper C 0 StartFraction d Over d t EndFraction left bracket 0.5 v Subscript st Baseline left parenthesis upper N Subscript SP Baseline minus upper N Subscript upper S Baseline right parenthesis plus left parenthesis v Subscript upper H Baseline minus v Subscript upper D Baseline right parenthesis right bracket left parenthesis wire hyphen wound right parenthesis 2nd Row i Subscript dis Baseline equals upper C 0 StartFraction d Over d t EndFraction left bracket lamda 1 v Subscript st Baseline left parenthesis upper N Subscript SP Baseline minus upper N Subscript upper S Baseline right parenthesis plus left parenthesis v Subscript upper H Baseline minus v Subscript upper D Baseline right parenthesis right bracket left parenthesis planar right parenthesis EndLayout
According to (7.14), in order to eliminate idis, NSP = NS and vH = vD should 
be satisﬁed. This means the SP and WS should have the same winding direction and 
turns, and terminals H and D at the same side should be equi-potential. As a result, the 
SP and WS have the same electric potential distribution. This method for cancelling 
the CM noise is called the shielding winding method. Since vG in SP is zero, there
Primary
Secondary
Core
Shielding 
SP
WP2
WS
WP1 
H 
SP
WP2
WS
WP1 
PG 
D 
C 
B
A
D 
C 
B
A 
WP2
WS
WP1 
D 
C 
B
A 
WP
W 2
WS
W
WP
W 1
D
C
B
A
PG 
Adjusting the turns 
G 
Balancing 
WB 
F 
G 
Adjusting vG 
SP 
Fig. 7.5 Solutions to equalize the AEP of secondary-winding layer and shielding layer 

7.2 Condition and Solutions to Achieve the CM Noise Cancellation
127
exists a point in WS whose electric potential is also zero. Based on this condition, 
the application of the shielding winding method in isolated DC-DC converters will 
be discussed in Sect. 7.3. 
2. Adjusting vG of Shielding Layers 
vG can be adjusted by connecting terminal G to an additional balancing winding WB, 
as shown in the right side of Fig. 7.5, and the other terminal of WB is connected to 
the PG. Note that WB is placed between WP2 and SP for avoiding the displacement 
current ﬂowing through WB and WS. With WB, vG is changed as 
vGS u bscrip
t upper G Baseline equals plus or minus upper N Subscript b Baseline v Subscript st
where, Nb is the turns number of the balancing winding, and the sign ahead is 
determined by the relative direction of the balancing winding. 
By substituting (7.15) into (7.10), the AEP of shielding layer with WB is 
Modi f
yingAbove v With quotation dash Subscript SP Baseline equals left parenthesis StartFraction pi minus theta 0 Over 2 pi EndFraction plus or minus upper N Subscript b Baseline right parenthesis v Subscript st
Mod
ifyi
n
gAb
ove v With quotation dash Subscript SP Baseline equals left parenthesis StartFraction pi minus theta 0 Over 2 pi EndFraction plus or minus upper N Subscript b Baseline right parenthesis v Subscript st
For a wire-wound transformer, in order to make the AEP of SP and WS equal, the 
condition is derived by combining (7.2), (7.7) and (7.16), i.e., 
0.5 upper  N Su b
script upper S Baseline v Subscript st Baseline plus v Subscript upper D Baseline equals left parenthesis StartFraction pi minus theta 0 Over 2 pi EndFraction plus or minus upper N Subscript b Baseline right parenthesis v Subscript st Baseline left parenthesis wire hyphen wound right parenthesis
0.5
 upp
e
r N 
Subscript up
per S Baseline v Subscript st Baseline plus v Subscript upper D Baseline equals left parenthesis StartFraction pi minus theta 0 Over 2 pi EndFraction plus or minus upper N Subscript b Baseline right parenthesis v Subscript st Baseline left parenthesis wire hyphen wound right parenthesis
According to (7.17), vD is derived as 
v S u
bscript upper D Baseline equals left parenthesis StartFraction pi minus theta 0 Over 2 pi EndFraction plus or minus upper N Subscript b Baseline minus 0.5 upper N Subscript upper S Baseline right parenthesis v Subscript st Baseline left parenthesis wire hyphen wound right parenthesis
v S
ubscr ipt upp
e
r D 
Baseline equ
als left parenthesis StartFraction pi minus theta 0 Over 2 pi EndFraction plus or minus upper N Subscript b Baseline minus 0.5 upper N Subscript upper S Baseline right parenthesis v Subscript st Baseline left parenthesis wire hyphen wound right parenthesis
Similarly, for a planar transformer, by combining (7.2), (7.7) and (7.16), we have 
lamda 1 u pper N
 Subscript upper S Baseline v Subscript st Baseline plus v Subscript upper D Baseline equals left parenthesis StartFraction pi minus theta 0 Over 2 pi EndFraction plus or minus upper N Subscript b Baseline right parenthesis v Subscript st Baseline left parenthesis planar right parenthesis
lam
da 1
 
uppe
r N Subs
cript upper S Baseline v Subscript st Baseline plus v Subscript upper D Baseline equals left parenthesis StartFraction pi minus theta 0 Over 2 pi EndFraction plus or minus upper N Subscript b Baseline right parenthesis v Subscript st Baseline left parenthesis planar right parenthesis
According to (7.19), vD is derived as 
v S u
bscript upper D Baseline equals left parenthesis StartFraction pi minus theta 0 Over 2 pi EndFraction plus or minus upper N Subscript b Baseline minus lamda 1 upper N Subscript upper S Baseline right parenthesis v Subscript st Baseline left parenthesis planar right parenthesis
v S
ubscr ipt upp
e
r D 
Baseline
 equals left parenthesis StartFraction pi minus theta 0 Over 2 pi EndFraction plus or minus upper N Subscript b Baseline minus lamda 1 upper N Subscript upper S Baseline right parenthesis v Subscript st Baseline left parenthesis planar right parenthesis
As seen from (7.18) and (7.20), if vD is proportional to vst, the balancing winding 
can be used to equalize the AEP of SP and WS. This method is called the combined 
shielding and balancing-winding method, and its applications in isolated DC-DC 
converters will be presented in Sect. 7.4.

128
7
Shielding-Based Common-Mode Noise Cancellation Techniques …
7.3 
Applications of the Shielding Winding Method 
7.3.1 
Combination of the Shielding Winding and Secondary 
Winding 
The transformer usually adopts interleaved winding structure, so as to reduce the 
leakage inductance and AC resistance of the windings. In this case, the shielding 
winding should be inserted between every adjacent primary- and secondary-winding 
layers, as shown in Fig. 7.6a. Apparently, this will lead to complexity in manufacture. 
Noticed that SP1, WS and SP2 have the same turns and winding direction, these layers 
can be properly transformed and combined, as shown in Fig. 7.6b. The combined 
wire is deﬁned as the shielding-secondary winding (SSW), as shown in Fig. 7.6c. 
The corresponding transformer structure implemented with the SSW is illustrated in 
Fig. 7.6d. 
Based on the geometric structure of the SSW, the shielding layer can block the 
electric coupling between the center wire (secondary winding) and the other windings 
in the transformer. Since the shielding layer and the center wire have the same electric 
potential distribution, the displacement current between them is naturally eliminated 
regardless of the capacitance. Therefore, the SSW is quite easy and convenient. In 
practical applications, there are still some drawbacks and challenges when using
F 
B
D 
Primary 
Secondary 
Insulation 
Core
A 
C 
Shielding 
F 
WS
SP1
WP2
WP1
SP2 
H
H 
Combine 
Extend 
Simplify 
(a) With shielding winding
(b) Transformation of the SSW 
Shielding 
layer 
Center 
wire 
Insulation 
layer 
Insulation 
tube 
F
B
A 
C 
D 
Primary 
Core 
SSW 
H 
(c) Structure of the SSW  
(d) The transformer adopting the SSW 
Fig. 7.6 The transformation and derivation of the SSW 

7.3 Applications of the Shielding Winding Method
129
the SSW: (1) The SSW occupies more window height than the enameled wire with 
the same diameter of the center wire; (2) The SSW will introduce larger leakage 
inductance of the transformer windings than the transformer without shielding layers; 
and (3) Since the center wire conducts relatively large current, the generated heat 
should be carefully handled. 
7.3.2 
Applications of the Shielding Winding Method 
As mentioned in Sect. 7.2.3, when applying the shielding winding method, there 
should exist a point in WS whose electric potential is zero. Such point is deﬁned as the 
static-electric-potential (SEP) point, since the electric potential of these points with 
respect to the SG is not inﬂuenced by the switching action, such as the positive and 
negative terminals of the output voltage. In this Section, to investigate the application 
of the shielding winding method in basic isolated DC-DC converters, the existence 
of SEP point in secondary windings will be examined. 
1. Condition for the Existence of SEP Point in Secondry Windings 
There are two cases for the seconday winding with the SEP point. One is that the 
winding terminal is connected to the SEP point such as the positive or negative 
terminal of the output voltage, and the other is that the SEP point is inside the 
windings. In order to check the existence of SEP point inside the windings, the 
electric potential distribution along the secondary winding should be calculated ﬁrst. 
For a speciﬁc isolated converter and the corresponding operating mode, the electric 
potential of the secondary-winding terminals can be obtained. By neglecting the 
leakage magnetic ﬂux and AC resistance caused by the skin effect and proximity 
effect, the electric potential varies linearly along the windings [2]. Figure 7.7a shows  
the transformer winding structure, where C and D are the origin and end terminals, 
respectively, and E is a point in the winding. The length from E to D along the 
winding is denoted by lED, and the whole winding length from C to D is denoted by 
lCD. Based on the linear variation of the electric potential along the windings, the 
electric potential of E is given by. 
v S ubscr ipt u pper E Baseline equals v Subscript upper D Baseline plus StartFraction v Subscript upper C Baseline minus v Subscript upper D Baseline Over l Subscript CD Baseline EndFraction l Subscript ED Baseline equals StartFraction l Subscript ED Baseline Over l Subscript CD Baseline EndFraction v Subscript upper C Baseline plus left parenthesis 1 minus StartFraction l Subscript ED Baseline Over l Subscript CD Baseline EndFraction right parenthesis v Subscript upper D
v Su
bscr ipt upper E Baseline equals v Subscript upper D Baseline plus StartFraction v Subscript upper C Baseline minus v Subscript upper D Baseline Over l Subscript CD Baseline EndFraction l Subscript ED Baseline equals StartFraction l Subscript ED Baseline Over l Subscript CD Baseline EndFraction v Subscript upper C Baseline plus left parenthesis 1 minus StartFraction l Subscript ED Baseline Over l Subscript CD Baseline EndFraction right parenthesis v Subscript upper D
v Su
bsc r
i
pt  upper E Baseline equals v Subscript upper D Baseline plus StartFraction v Subscript upper C Baseline minus v Subscript upper D Baseline Over l Subscript CD Baseline EndFraction l Subscript ED Baseline equals StartFraction l Subscript ED Baseline Over l Subscript CD Baseline EndFraction v Subscript upper C Baseline plus left parenthesis 1 minus StartFraction l Subscript ED Baseline Over l Subscript CD Baseline EndFraction right parenthesis v Subscript upper D
v S
u
bs
cript upper E Baseline equals v Subscript upper D Baseline plus StartFraction v Subscript upper C Baseline minus v Subscript upper D Baseline Over l Subscript CD Baseline EndFraction l Subscript ED Baseline equals StartFraction l Subscript ED Baseline Over l Subscript CD Baseline EndFraction v Subscript upper C Baseline plus left parenthesis 1 minus StartFraction l Subscript ED Baseline Over l Subscript CD Baseline EndFraction right parenthesis v Subscript upper D
According to (7.21), Fig. 7.7b depicts the curve of vE. 
Taking the derivative of (7.21) with respect to t, yields 
StartFraction partial differential v Subscript upper E Baseline Over partial differential t EndFraction equals StartFraction l Subscript ED Baseline Over l Subscript CD Baseline EndFraction StartFraction partial differential v Subscript upper C Baseline Over partial differential t EndFraction plus left parenthesis 1 minus StartFraction l Subscript ED Baseline Over l Subscript CD Baseline EndFraction right parenthesis StartFraction partial differential v Subscript upper D Baseline Over partial differential t EndFraction
Sta rtFraction partial differential v Subscript upper E Baseline Over partial differential t EndFraction equals StartFraction l Subscript ED Baseline Over l Subscript CD Baseline EndFraction StartFraction partial differential v Subscript upper C Baseline Over partial differential t EndFraction plus left parenthesis 1 minus StartFraction l Subscript ED Baseline Over l Subscript CD Baseline EndFraction right parenthesis StartFraction partial differential v Subscript upper D Baseline Over partial differential t EndFraction
Star
tFraction partial differential v Subscript upper E Baseline Over partial differential t EndFraction equals StartFraction l Subscript ED Baseline Over l Subscript CD Baseline EndFraction StartFraction partial differential v Subscript upper C Baseline Over partial differential t EndFraction plus left parenthesis 1 minus StartFraction l Subscript ED Baseline Over l Subscript CD Baseline EndFraction right parenthesis StartFraction partial differential v Subscript upper D Baseline Over partial differential t EndFraction
Sta r
t
Fr action partial differential v Subscript upper E Baseline Over partial differential t EndFraction equals StartFraction l Subscript ED Baseline Over l Subscript CD Baseline EndFraction StartFraction partial differential v Subscript upper C Baseline Over partial differential t EndFraction plus left parenthesis 1 minus StartFraction l Subscript ED Baseline Over l Subscript CD Baseline EndFraction right parenthesis StartFraction partial differential v Subscript upper D Baseline Over partial differential t EndFraction
Sta
rtFraction partial differential v Subscript upper E Baseline Over partial differential t EndFraction equals StartFraction l Subscript ED Baseline Over l Subscript CD Baseline EndFraction StartFraction partial differential v Subscript upper C Baseline Over partial differential t EndFraction plus left parenthesis 1 minus StartFraction l Subscript ED Baseline Over l Subscript CD Baseline EndFraction right parenthesis StartFraction partial differential v Subscript upper D Baseline Over partial differential t EndFraction
Sta
rtFraction partial differential v Subscript upper E Baseline Over partial differential t EndFraction equals StartFraction l Subscript ED Baseline Over l Subscript CD Baseline EndFraction StartFraction partial differential v Subscript upper C Baseline Over partial differential t EndFraction plus left parenthesis 1 minus StartFraction l Subscript ED Baseline Over l Subscript CD Baseline EndFraction right parenthesis StartFraction partial differential v Subscript upper D Baseline Over partial differential t EndFraction

130
7
Shielding-Based Common-Mode Noise Cancellation Techniques …
D 
C 
lED
E 
vD 
vE 
vC 
lED
0
lCD 
(a) Winding structure in 
space 
(b) Electric potential distribution 
along the winding 
Fig. 7.7 The structure and electric potential distribution of the secondary winding
If point E is an SEP point, we have partial  differential v Subscript upper E Baseline divided by partial differential t equals 0. According to (7.22), the condition 
for the existence of SEP point can be derived as 
StartFraction partial differential v Subscript upper C Baseline Over partial differential t EndFraction equals StartFraction l Subscript ED Baseline minus l Subscript CD Baseline Over l Subscript ED Baseline EndFraction StartFraction partial differential v Subscript upper D Baseline Over partial differential t EndFraction
Sta
rtFrac tion partial differential v Subscript upper C Baseline Over partial differential t EndFraction equals StartFraction l Subscript ED Baseline minus l Subscript CD Baseline Over l Subscript ED Baseline EndFraction StartFraction partial differential v Subscript upper D Baseline Over partial differential t EndFraction
Star
tFraction partial differential v Subscript upper C Baseline Over partial differential t EndFraction equals StartFraction l Subscript ED Baseline minus l Subscript CD Baseline Over l Subscript ED Baseline EndFraction StartFraction partial differential v Subscript upper D Baseline Over partial differential t EndFraction
Sta
rtFraction partial differential v Subscript upper C Baseline Over partial differential t EndFraction equals StartFraction l Subscript ED Baseline minus l Subscript CD Baseline Over l Subscript ED Baseline EndFraction StartFraction partial differential v Subscript upper D Baseline Over partial differential t EndFraction
According to (7.23), lED can be solved to locate the position of point E. 
l Su bs
cript ED Baseline equals StartStartFraction StartFraction partial differential v Subscript upper D Baseline Over partial differential t EndFraction OverOver StartFraction partial differential v Subscript upper D Baseline Over partial differential t EndFraction minus StartFraction partial differential v Subscript upper C Baseline Over partial differential t EndFraction EndEndFraction l Subscript CD
l Subscript ED Baseline equals StartStartFraction StartFraction partial differential v Subscript upper D Baseline Over partial differential t EndFraction OverOver StartFraction partial differential v Subscript upper D Baseline Over partial differential t EndFraction minus StartFraction partial differential v Subscript upper C Baseline Over partial differential t EndFraction EndEndFraction l Subscript CD
l Subscript ED Baseline equals StartStartFraction StartFraction partial differential v Subscript upper D Baseline Over partial differential t EndFraction OverOver StartFraction partial differential v Subscript upper D Baseline Over partial differential t EndFraction minus StartFraction partial differential v Subscript upper C Baseline Over partial differential t EndFraction EndEndFraction l Subscript CD
l S ubscript ED Baseline equals StartStartFraction StartFraction partial differential v Subscript upper D Baseline Over partial differential t EndFraction OverOver StartFraction partial differential v Subscript upper D Baseline Over partial differential t EndFraction minus StartFraction partial differential v Subscript upper C Baseline Over partial differential t EndFraction EndEndFraction l Subscript CD
l S
ubs
cript ED Baseline equals StartStartFraction StartFraction partial differential v Subscript upper D Baseline Over partial differential t EndFraction OverOver StartFraction partial differential v Subscript upper D Baseline Over partial differential t EndFraction minus StartFraction partial differential v Subscript upper C Baseline Over partial differential t EndFraction EndEndFraction l Subscript CD
2. Applications of the Shielding Winding Method in Basic Isolated DC-DC 
Converters 
Figure 7.8a shows the ﬂyback converter. As seen, terminal D is connected to the SG, 
and it is the SEP point in the secondary winding. Therefore, the shielding winding 
can be used, where, the center wire is connected to terminals C and D, and the dotted 
terminal in the shielding winding is connected to the PG. Similar situations can be 
found in forward, push–pull and half-bridge converters, as shown in Figs. 7.8b–d.
Figure 7.9a shows the buck-type full-bridge converter with a full-wave rectiﬁer. 
The secondary rectiﬁer can also be the full-bridge and current-doubler rectiﬁers, as 
shown in Fig. 7.9b, c, respectively. For the full-wave rectiﬁer shown in Fig. 7.9a, the 
center tap of the secondary windings is connected to the SG, and it is an SEP point, 
so the shielding winding method can be adopted.
Figure 7.10a shows the electric potential of terminals C and D of the secondary 
winding in the full-bridge rectiﬁer. According to the waveforms of vC and vD, no SEP  
point exists in the secondary windings. Figure 7.10b shows the electric potential and 
its variation of the terminals in current-doubler rectiﬁer. By comparing the electric 
potential variation of vC and vD with respect to t, there is no SEP point in the secondary 
winding. So, the shielding winding method can not be applied in the full-bridge 
rectiﬁer and current-doubler rectiﬁer.

7.3 Applications of the Shielding Winding Method
131
* 
* 
PG 
* 
Q 
A 
B 
SG 
Vin 
Do 
Co 
C 
D 
RLd 
SSW 
* 
PG 
A 
B 
* 
Q 
* 
D 
SG 
C 
* 
Vin 
Co 
Lf
DR1 
DFW
RLd 
SSW 
C 
D 
(a) Flyback converter                           (b) Forward converter 
PG 
* 
Q2 
* 
*
SG 
Q1 
* 
A 
B 
* 
* 
Vin 
Co 
Lf
DR1 
DR2 
RLd 
SSW 
*
* 
*
SG 
* 
* 
Co 
Lf
DR1 
DR2 
RLd 
SSW
PG 
B 
A 
Q2 
Q1 
C2 
C1 
Vin 
(c) Push-pull converter                           (d) Half-bridge converter 
Fig. 7.8 The isolated DC-DC converter adopting the SSW method
A 
B 
PG 
* 
Q3 
Q1 
Q4 
Q2 
a 
Lr 
b 
Vin 
* 
*
SG 
Co 
Lf
DR1 
DR2 
C 
D 
* 
* 
RLd 
SSW 
(a) Full-bridge converter 
*
C 
D 
Lf 
Co 
SG 
DR1
DR2 
DR3
DR4 
RLd 
SG 
* C 
D 
Lf1 
Lf2 
Co
DR1 
DR2 
RLd 
(b) Full-bridge rectifier
(c) Current-doubler rectifier 
Fig. 7.9 The buck-type full-bridge converter and its secondary rectiﬁer and ﬁlter

132
7
Shielding-Based Common-Mode Noise Cancellation Techniques …
0
t 
vC(t) 
t 
vD(t) 
0 
0
t 
Ts 
t
0 
( )
Cv
t
 
t 
∂ 
∂ 
( )
D
v
t
 
t 
∂ 
∂ 
t
0 
vCD(t) 
–Vsecδ(t) 
Vsecδ(t) 
Vsecδ(t) 
–Vsecδ(t) 
Vsec 
Vsec 
Vsec 
Vsec
0
t 
vC(t) 
t 
vD(t) 
0 
0
t 
Ts 
t
0 
( )
C
v
t
 
t 
∂ 
∂ 
( )
D
v
t
 
t 
∂ 
∂ 
t
0 
vCD(t) 
–Vsecδ(t) 
Vsecδ(t) 
Vsecδ(t) 
–Vsecδ(t) 
Vsec 
Vsec 
Vsec 
Vsec 
(a) The full-bridge rectifier
(b) The current-doubler rectifier 
Fig. 7.10 The electric potential and its variation of the terminals in the rectiﬁers 
Figure 7.11 shows the boost-type full-bridge converter with a full-wave rectiﬁer. 
Likewise, the secondary rectiﬁer can also be the full-bridge and voltage-doubler 
rectiﬁers, as shown in Fig. 7.11b, c, respectively. For the full-wave and voltage-
doubler rectiﬁers, as shown in Fig. 7.11a, b, it is obvious that there is an SEP point 
in the secondary winding, and the shielding winding method can be adopted. 
A 
B 
PG 
* 
Q3 
Q1 
Q4 
Q2 
a 
Lb 
b 
Vin 
* 
*
SG 
Co
C 
D 
* 
* 
DR1 
DR2 
RLd 
SSW 
(a) Boost-type full-bridge converter 
SG 
* 
C1 
C 
D 
C2 
* 
PG 
DR1 
DR2 
RLd 
SSW 
SG 
* 
C 
D 
Co
* 
* 
PG 
DR1
DR2 
DR3
DR4 
RLd 
SSW 
(b) Voltage-doubler rectifier
(c) Full-bridge rectifier 
Fig. 7.11 The boost-type full-bridge converter and its secondary rectiﬁer and ﬁlters

7.3 Applications of the Shielding Winding Method
133
For the full-bridge rectiﬁer shown in Fig. 7.11c, the electric potential and its 
variation are given in Fig. 7.12. As seen, par
t
ial  diff
e
rential v Subscript upper C Baseline divided by partial differential t equals minus partial differential v Subscript upper D Baseline divided by partial differential t is satisﬁed. According 
to (7.23), it can be obtained that there is an SEP point in the secondary winding. By 
substituting partial  differential v Subscript upper C Baseline divided by partial differential t equals minus partial differential v Subscript upper D Baseline divided by partial differential t into (7.24), we have lED = lCD/2, which means the 
middle of the secondary winding is the SEP point. As shown in Fig. 7.11c, the center 
wire of the SSW is connected to the rectiﬁer, and the middle of the shielding layer 
is connected to the PG. 
Table 7.1 summarizes the existence of the SEP point in the transformer secondary 
windings in the basic isolated DC-DC converters. If there is an SEP point in the 
secondary winding, the shielding winding method can be applied to suppress the 
CM noise. 
Fig. 7.12 The electric 
potential and its variation of 
the terminals in full-bridge 
rectiﬁer 
Voδ(t) 
Vo 
0
t 
t
0 
–Voδ(t)
0
t 
Ts 
t
0 
t
0 
Voδ(t) 
–Voδ(t) 
Vo 
Vo 
Vo 
vC(t) 
vD(t) 
vCD(t) 
( )
Cv
t
 
t 
∂ 
∂ 
( )
D
v
t
 
t 
∂ 
∂ 
Table 7.1 Existence of SEP Point along the windings in basic isolated DC-DC converters 
Topology
Existence of the SEP Point in the secondary 
winding and its connection 
Flyback
Yes, the SEP point is connected to the SG 
Forward
Yes, the SEP point is connected to the SG 
Push–pull
Yes, the SEP point is connected to the center-tap 
Half-bridge
Yes, the SEP point is connected to the center-tap 
Buck-type full-bridge
Full-wave
Yes, the SEP point is connected to the center-tap of 
the secondary winding 
Full-bridge
No 
Current-doubler 
Boost-type full-bridge
Full-wave
Yes, the SEP point is connected to the SG 
Full-bridge
Yes, the SEP point is connected to the mid-point of 
the secondary winding 
Voltage-doubler
Yes, the SEP point is connected to the SG

134
7
Shielding-Based Common-Mode Noise Cancellation Techniques …
7.4 
Application of the Combined Shielding 
and Balancing-Winding Method 
7.4.1 
The Secondary Rectiﬁer and Filters for Applying 
the Combined Shielding and Balancing-Winding 
Method 
In Sect. 7.2.3, the condition for applying the combined shielding and balancing-
winding method is that vD is proportional to vst. It is worth noting that, if there is an 
SEP point E in the secondary winding, we have 
v S ubscri pt up p er D Ba
seline equals v Subscript DE Baseline plus v Subscript upper E Baseline equals plus or minus upper N Subscript DE Baseline v Subscript st
where, vE = 0, NDE is the turns from terminal D to point E, and the sign is related to 
the winding direction. 
According to (7.25), when there is an SEP point in the secondary winding, vD will 
be proportional to vst, and the combined shielding and balancing-winding method 
can be adopted. When the secondary winding does not have the SEP point, such as 
the full-bridge and current-doubler rectiﬁers in Fig. 7.9b, c, the applicable condition 
for the combined shielding and balancing-winding method will be exaimed. 
As seen from Fig. 7.10, vCD has three voltage levels, so vst also has three voltage 
levels. However, vD only has two voltage levels, so vD is never proportional to vst, 
and the combined shielding and balancing-winding method can not applied. 
According to the discussions above, the converters suitable for applying the 
shielding winding and the combined shielding and balancing-winding methods to 
reduce the CM noise are identical. Therefore, Table 7.1 can also be adopted to look up 
the applications of the combined shielding and balancing-winding method in basic 
isolated DC-DC converters. 
7.4.2 
Calculating the Turns of Balancing Winding 
and the Angle θ 0 
By substituting (7.25) into (7.18) and (7.20), respectively, the requirement for 
eqalizing the AEP of the secondary winding and shielding layer is 
StartFraction pi minus theta 0 Over 2 pi EndFraction plus or minus upper N Subscript b Baseline equals 0.5 upper N Subscript upper S Baseline plus or minus upper N Subscript DE Baseline left parenthesis wire hyphen wound right parenthesis
Sta
rtFra ction pi  minu
s theta 0 Ov
er 2 pi EndFraction plus or minus upper N Subscript b Baseline equals 0.5 upper N Subscript upper S Baseline plus or minus upper N Subscript DE Baseline left parenthesis wire hyphen wound right parenthesis
StartFraction pi minus theta 0 Over 2 pi EndFraction plus or minus upper N Subscript b Baseline equals lamda 1 upper N Subscript upper S Baseline plus or minus upper N Subscript DE Baseline left parenthesis planar right parenthesis
Sta
rtFra ction pi  minu
s theta 
0 Over 2 pi EndFraction plus or minus upper N Subscript b Baseline equals lamda 1 upper N Subscript upper S Baseline plus or minus upper N Subscript DE Baseline left parenthesis planar right parenthesis

7.5 Hybrid Passive Cancellation Method
135
Noting that (π–θ 0)/(2π) ∈ [–0.5, 0.5] and Nb is an integer, therefore Nb and 
(π–θ 0)/2π are supposed to be equal to the integral and decimal part, respectively.
S tar tLayout Enlarg ed left 
bra ce 1st Row upper  N Sub script  b Baseline 
equals floor left parenthesis StartAbsoluteValue 0.5 upper N Subscript upper S Baseline plus or minus upper N Subscript DE Baseline EndAbsoluteValue right parenthesis 2nd Row theta 0 equals pi minus 2 pi left parenthesis 0.5 upper N Subscript upper S Baseline plus or minus upper N Subscript DE Baseline plus or minus upper N Subscript b Baseline right parenthesis EndLayout left parenthesis wire hyphen wound right parenthesis
S tar tLayout Enlarg ed left 
bra ce 1st Row upper  N Sub script  b Basel
ine equals floor left parenthesis StartAbsoluteValue lamda 1 upper N Subscript upper S Baseline plus or minus upper N Subscript DE Baseline EndAbsoluteValue right parenthesis 2nd Row theta 0 equals pi minus 2 pi left parenthesis lamda 1 upper N Subscript upper S Baseline plus or minus upper N Subscript DE Baseline plus or minus upper N Subscript b Baseline right parenthesis EndLayout left parenthesis planar right parenthesis
where, ﬂoor(x) is the function which outputs the greatest integer less than or equal 
to x. 
According to (7.28), for a wire-wound transformer, if the turns number NS of 
a secondary winding is an even number, then Nb = |0.5NS ± NDE|, and θ 0 = π; 
Otherwise, Nb = |0.5(NS–1) ± NDE|, and θ 0 = 0. For a planar transformer, when NS 
= 1, then λ1 = 0.5 according to (7.5).  Based on (7.29), Nb = NDE, and θ 0 = 0. If 
terminal D is an SEP point, then Nb = NDE = 0, which is the shielding technique 
proposed in [3]. 
7.5 
Hybrid Passive Cancellation Method 
For isolated dc-dc converters with a symmetrical conﬁguration, such as two-switch 
ﬂyback, two-switch forward, push–pull, full-bridge and full-bridge LLC resonant 
converters, when a proper control scheme is adopted, complementary dv/dt nodes 
appear in their primary circuits, and the displacement current ﬂowing through the 
related parasitic capacitances can be cancelled by each other. In this case, the inter-
winding capacitance is the dominant propagation path for the CM noise, and both 
the shielding winding method and the combined shielding and balancing-winding 
method can reduce the CM noise effectively. 
However, for asymmetrical isolated DC-DC converters, such as ﬂyback, forward 
and half-bridge converters, the parasitic capacitance between the high dv/dt node in 
the primary circuit and the PE is another propagation path for the CM noise. In this 
section, the combined shielding and balancing-winding method is further combined 
with the passive cancellation method [4], which is called hybrid passive cancellation 
(HPC) method, will be investigated for cancelling the displacement current ﬂowing 
through two propagation paths for the CM noise simultaneously. 
7.5.1 
Principle of the HPC Method 
To cancel the displacement current ﬂowing through the parasitic capacitance between 
the high dv/dt node in the primary circuit and the PE, the passive cancellation method 
was proposed by adding a compensation voltage source and a compensation capacitor

136
7
Shielding-Based Common-Mode Noise Cancellation Techniques …
Fig. 7.13 The principle of 
the HPC method 
PE 
25Ω 
*
*
Secondary 
rectifier 
and filter 
Primary 
circuit 
PG 
SG 
vCM 
SP 
*
Ccom
CpB iCpB
iCcom 
G 
B 
[4], where, the compensation voltage source is realized by a compensation winding. 
For the combined shielding and balancing-winding method, node G in the shielding 
layer is a high dv/dt node. If the dv/dt of node G and the node in the primary circuit are 
out-of-phase, the balancing winding can be reused as the compensation winding, and 
the HPC method is proposed, as shown in Fig. 7.13, where, Ccom is the compensation 
capacitor, node B is a high dv/dt node in the primary circuit, and CpB is the parasitic 
capacitance between node B and the PE. 
In Fig. 7.13, for canceling the displacement current iCpB ﬂowing through CpB, the  
compensation current iCcom should be equal to − iCpB, i.e., 
uppe
r C Subscript pB Baseline StartFraction d v Subscript upper B Baseline Over d t EndFraction plus upper C Subscript com Baseline StartFraction d v Subscript upper G Baseline Over d t EndFraction equals 0
up er C Su
bscript pB Baseline StartFraction d v Subscript upper B Baseline Over d t EndFraction plus upper C Subscript com Baseline StartFraction d v Subscript upper G Baseline Over d t EndFraction equals 0
up
er 
C Subscript pB Baseline StartFraction d v Subscript upper B Baseline Over d t EndFraction plus upper C Subscript com Baseline StartFraction d v Subscript upper G Baseline Over d t EndFraction equals 0
As seen, the applicable condition for the HPC method can be summarized as 
follows: 
(1) The electric potential of node D in the secondary winding is proportional to vst, 
so that the combined shielding and balancing-winding method can be adopted 
to cancel the displacement current ﬂowing between the shielding layer and the 
secondary-winding layer. 
(2) The dv/dt of the primary node and node G of the balancing winding are out-
of-phase, so that the balancing winding can be reused as the compensation 
winding. 
In practical applications, a transformer may have several shielding layers. To 
equalize the AEP of shielding layers and their adjacent secondary windings, several 
balancing windings should be added, and thus several nodes between the shielding 
layers and balancing windings exist. The compensation capacitor can be connected 
to the node whose dv/dt is complementary with the node in the primary circuit. In 
addition, the combination of the shielding winding method and the passive cancella-
tion method is also possible for reducing the CM noise, which reuses the shielding 
winding as the compensation winding, and it is not discussed here.

7.5 Hybrid Passive Cancellation Method
137
7.5.2 
Applications of the HPC Method 
1. Flyback Converter 
Figure 7.14 shows the applications of the HPC method in ﬂyback, forward, half-
bridge and half-bridge LLC resonant converters. For the ﬂyback converter in 
Fig. 7.14a, the AEP of secondary winding is linearly correlated with the electric 
potential of node C since vD = 0. To eqaulize the AEP of the secondary winding and 
shielding layer, the dotted terminal of the balancing winding is connected to the PG. 
As a result, the electric potential of nodes G and C are in-phase. Since the electric 
potential of the drain of switch Q and node G in the shielding layer are in-phase, 
the balancing winding can not be reused as the compensation winding, and the HPC 
method is not applicable here.
For the ﬂyback converter in Fig. 7.14b, the AEP of the secondary winding is 
linearly correlated with the electric potential of node D since vC = 0. To equalize 
the AEP of the secondary winding and shielding layer, the dotted terminal of the 
balancing winding is connected to the shielding layer. Noting that the electric poten-
tial of the drain of switch Q and node G in the shielding layer are out-of-phase, the 
balancing winding can be reused as the compensation winding, and the HPC method 
can be applied. By neglecting the leakage inductance of the transformer, the electric 
potential of vB and vG satisﬁes 
StartFraction d v Subscript upper B Baseline Over d t EndFraction equals minus StartFraction upper N Subscript upper P Baseline Over upper N Subscript b Baseline EndFraction dot StartFraction d v Subscript upper G Baseline Over d t EndFraction
Sta
r t Fraction d v Subscript upper B Baseline Over d t EndFraction equals minus StartFraction upper N Subscript upper P Baseline Over upper N Subscript b Baseline EndFraction dot StartFraction d v Subscript upper G Baseline Over d t EndFraction
Sta
rtFraction d v Subscript upper B Baseline Over d t EndFraction equals minus StartFraction upper N Subscript upper P Baseline Over upper N Subscript b Baseline EndFraction dot StartFraction d v Subscript upper G Baseline Over d t EndFraction
Sta
rtFraction d v Subscript upper B Baseline Over d t EndFraction equals minus StartFraction upper N Subscript upper P Baseline Over upper N Subscript b Baseline EndFraction dot StartFraction d v Subscript upper G Baseline Over d t EndFraction
where, NP is the turns of the primary winding. 
Substitution of (7.31) into (7.30), leads to 
upper  C  Subscript com Baseline equals StartFraction upper N Subscript upper P Baseline Over upper N Subscript b Baseline EndFraction dot upper C Subscript pB
up
er C 
Subscript com Baseline equals StartFraction upper N Subscript upper P Baseline Over upper N Subscript b Baseline EndFraction dot upper C Subscript pB
2. Forward Converter 
Figure 7.14c, d show the forward (FWD) converter, and the output rectiﬁer diode DR1 
and ﬁlter inductor Lf can be located at the high side or the low side. For the circuit 
shown in Fig.  7.14a, node G in the balancing winding and node C in the secondary 
winding are dotted terminals, so that the AEP of shielding layer and secondary 
winding can be equal. In addition, the electric potential of node G and the drain of 
switch Q are out-of-phase, and the HPC method is applicable. The corresponding 
Ccom is the same as (7.32). 
In Fig. 7.14b, to equalize the AEP of the shielding layer and secondary winding, 
node G in the balancing winding and node D in the secondary winding are dotted 
terminals. However, since the electric potential of the drain of switch Q and node G 
are in-phase, the balancing winding can not be reused as compensation winding, and 
the HPC method is not applicable.

138
7
Shielding-Based Common-Mode Noise Cancellation Techniques …
* 
PG 
* 
Q 
A 
B 
SG 
Vin 
CpB 
* 
G 
C 
D 
PE 
Do 
Co 
RLd 
* 
PG 
* 
Q 
A 
B 
SG 
Vin 
CpB 
* 
G 
C 
D 
PE 
Ccom 
PE 
Do 
Co 
RLd 
(a) Flyback converter (Do is at the high side) (b) Flyback converter (Do is at the low side) 
* 
PG 
A 
B 
* 
Q 
SG 
Vin 
CpB
Ccom 
* 
G 
PE 
Reset 
circuit 
C 
D 
Lf
DR1 
Co
DFW 
RLd 
* 
PG 
A 
B 
* 
Q 
SG 
Vin 
CpB 
* 
G 
PE 
C 
D 
Lf
DR1 
Reset 
circuit
Co 
DFW 
RLd 
(c) FWD converter (DR1, Lf are at the high side) (d) FWD converter (DR1, Lf at the low side) 
PG 
*
* 
*
SG
B 
A 
Q2 
Q1 
C2 
C1 
Vin 
CpB 
D 
C 
* 
G 
Ccom 
Lf
DR1 
Co RLd 
DR2 
PG 
*
* 
*
SG 
M 
Q2 
Q1 
Vin
CpB 
D 
C 
* 
G 
Lr
Cr 
Ccom 
DR1 
Co RLd 
DR2 
(e) Half-bridge converter
(f) Half-bridge LLC resonant converter 
Fig. 7.14 The applications of the HPC method in ﬂyback, forward, half-bridge and half-bridge 
LLC resonant converters
3. Half-Bridge Converter 
Figure 7.14e shows the half-bridge (HB) converter using the HPC method. Node G 
in the balancing winding and node C in the secondary winding are dotted terminals, 
so that the AEP of the shielding layer and the secondary winding between node C 
and SG are equal. As a result, the electric potential of node G and the drain of switch 
Q2 are out-of-phase, and the HPC method can be applied. The required Ccom is the 
same as (7.32). 
4. Half-Bridge LLC Resonant Converter 
Figure 7.14f shows  the HB  LLC resonant converter adopting the HPC method. When 
the switching frequency and resonant frequency are close, the impedance of Lr and 
Cr in series is quite lower than that of the magnetizing inductance of the transformer.

7.6 Experimental Veriﬁcation and Discussion
139
Therefore, the voltage across the primary winding is approximately equal to the 
voltage between the phase-leg mid-point M and the PG. Therefore, the balancing 
winding can be reused as the compensation winding just like the HB converter, and 
Ccom is the same as (7.32). 
7.6 
Experimental Veriﬁcation and Discussion 
In this section, the shielding winding method, the combined shielding and balancing-
winding method, and the HPC method are veriﬁed by the experimental results, 
respectively. 
7.6.1 
Veriﬁcation of the Shielding Winding Method 
In order to verify the effectiveness of the shielding winding method, a 60-W prototype 
of the ﬂyback converter has been built in the lab. Figure 7.15 shows the topology of 
the ﬂyback converter. The input voltage vac is 90~264 V, and the output voltage V o 
is 19.5 V. The devices used in the prototype are: main switch Q adopts AOTF10N65 
(10A/650V), output rectiﬁer diode Do adopts V30120C (30 A/120 V), input ﬁlter 
capacitor employs 100-μF electrolytic capacitor, and the output ﬁlter capacitance is 
1000 μF. A 0.47-μF X cap is inserted in front of the rectiﬁer bridge, which ﬁlters the 
high frequency pulsating input current and eliminates the mixed-mode noise [5]. The 
converter is controlled by FAN6754MRMY with jitter frequency function to reduce 
the spectra of the noise source. 
As the heatsink accommodating switch Q is connected to the PG, the dominant 
CM noise propagation path is the transformer inter-winding capacitance. To verify 
the effectiveness of the shielding winding method, three transformers are designed: 
T 1-1 without shielding layers, T 1-2 with single-shielding layers, and T 1-3 implemented 
with the SSW wires, as shown in Fig. 7.16.
Table 7.2 lists the winding dimension of these transformers. For the secondary 
winding in T 1-3, the diameter of the coaxial cable is 2.4 mm; the external and inner 
diameter of the shielding layer is 2.00 mm and 1.4 mm, respectively, and the diameter
Fig. 7.15 The ﬂyback 
converter and the connection 
of transformer 
A
C 
B
D 
a 
b 
To auxiliary 
power supply 
Vo
vin
* 
* 
*
Q 
Co 
Do 
Cin
Cx 
PG 
SG 
PE 

140
7
Shielding-Based Common-Mode Noise Cancellation Techniques …
D
A
B
 
C 
a 
b 
Shielding 
B
A
D
 
C 
a 
b 
F
F
 
Primary 
Secondary 
Auxiliary 
B
A 
C 
a 
b 
SSW 
Graphic symbol: 
Insulation
F D  
T1-1
T1-2
T1-3 
Fig. 7.16 The winding structure of three transformers
of the center wire is 0.45 mm. The transformers adopt PQ 32/30 ferrite core, and the 
magnetizing inductance of the primary winding is 460 μH. 
Since the center wire of the coaxial cable is very thin, the test condition is 220-V 
input voltage and 20-W load for the converter with these transformers. For a fair 
comparison, the inter-winding capacitances of these transformers are kept very close 
by adjusting the insulation layers of each transformer. Table 7.3 lists the measured 
structural capacitances. 
The conducted EMI of the ﬂyback converter is measured in the electromag-
netic shielding chamber. The LISN employes R&S ENV216, the EMI receiver uses 
Schaffner SCR3502, and the noise separator adopts Mini-Circuit ZSC-2-2 (Common 
Mode). The SG of the converter is connected to the PE. Besides, each core of these 
transformers is wrapped by copper foil which is connected to the PG, for blocking 
the electric coupling between the primary winding and the PE via the core. The 
measured CM noise of the converter using three different transformers is illustrated 
in Fig. 7.17. As seen, the quasi-peak (QP) CM noise of the converter with T 1-3,
Table 7.2 The winding dimension of three transformers 
Primary winding
Secondary 
winding 
Auxiliary winding 
Shielding layer 
T1-1 
0.25 mm enameled 
wire with 2 strands, and 
each layer has 18 turns 
0.45 mm enameled 
wire with 7 
strands, and has 7 
turns 
0.3 mm enameled 
wire with 1 strand, 
and has 7 turns 
T1-2
Copper foil with a 
width of 15.5 mm and 
thickness of 0.1 mm 
T1-3
Coaxial cable 
Table 7.3 The measured structural capacitance of three transformer 
Transformer
T1-1
T1-2
T1-3 
Capacitance (pF)
43.03
49.71
48.83 

7.6 Experimental Veriﬁcation and Discussion
141
Fig. 7.17 The measured CM 
noise of the converter with 
three different transformers 
1M
10M 
30M
150k 
f (Hz) 
90 
80 
70 
60 
50 
40 
30 
20 
T1-1 
T1-3 
CM noise in QP (dBμV) 
T1-2 
QP limit 
which utilizes the SSW wire, is nearly 30 dB and 15 dB lower than T 1-1 than T 1-2, 
respectively. Therefore, the effectiveness of the shielding winding method is veriﬁed. 
7.6.2 
Veriﬁcation of the Combined Shielding 
and Balancing-Winding Method 
To verify the effectiveness of the combined shielding and balancing-winding method, 
the transformer without shielding layer, the transformer with shielding layer and 
the transformer with shielding layer and balancing winding are fabricated, and the 
displacement current ﬂowing through the inter-winding capacitance is measured and 
compared [6]. 
Figure 7.18a shows the connection of the transformer under test. In order to 
establish the electric potential distribution of the windings, the primary winding is 
connected to the excitation port, which is an internal frequency-sweeping source 
in the network analyzer. A 10-kΩ resistor R is connected between terminal C and 
PG [6]. The voltage vAB across the primary winding and vR across R are sensed by 
the probes that connect the sensing ports of the network analyzer, and the transfer 
function GTR(s) from vAB to vR is measured as 
upper G S ubscript TR Baseline left parenthesis s right parenthesis equals StartFraction upper V Subscript upper R Baseline left parenthesis s right parenthesis Over upper V Subscript AB Baseline left parenthesis s right parenthesis EndFraction
upper G
 Subscript TR Baseline left parenthesis s right parenthesis equals StartFraction upper V Subscript upper R Baseline left parenthesis s right parenthesis Over upper V Subscript AB Baseline left parenthesis s right parenthesis EndFraction
Figure 7.18b shows the equivalent circuit of the transformer under test. As seen, 
the current ishs ﬂowing from the shielding layer to the secondary winding is equal to 
the current i returning to the PG. Since vR is proportional to the amplitude of i, the  
magnitude of GTR(s) can be used to evaluate the displacement current ﬂowing from 
the shielding layer to the adjacent secondary winding. 
Figure 7.19 shows the winding structure of three planar transformers, including 
T 2-1 without shielding layer, T 2-2 with shielding layer, and T 2-3 with shielding layer 
and balancing winding. For the combined shielding and balancing-winding method 
in T 2-3, SP1 and SP2 are specially given at the bottom of Fig. 7.19. Table 7.4 lists

142
7
Shielding-Based Common-Mode Noise Cancellation Techniques …
50Ω 
vac
R
vR 
Excitation 
open 
vAB 
A 
C 
B 
D 
*
* 
i 
Zprobe 
Response 
Transformer 
* 
G2 
* G1 
* 
open 
SG 
ishs 
(a) The connection of the transformer 
under test              
(b) The equivalent circuit 
Fig. 7.18 The test of the transformer and the corresponding equivalent circuit
the winding dimension of these transformers. PQI 50/33 ferrite core is used for 
these planar transformers, and the magnetizing inductance is 98 μH for  the primary  
winding. The measured structural capacitances between Pri1 and Sec1, Pri2 and Sec 
4 in  T 2-1 are 19 pF and 23 pF, respectively, and the measured structural capacitance 
between SP1 and Sec1, SP2 and Sec 4 in T 2-2 and T 2-3 are 37 pF and 34 pF, respectively. 
Figure 7.20 shows curves of the magnitude of GTR(s) for these transformers. As 
seen, 15-dB reduction is achieved after inserting the shielding layer, and 5-dB reduc-
tion is further achieved by adding the balancing winding. Therefore, the displacement 
current ﬂowing through the shielding layer and secondary winding is reduced.
B 
SG 
C 
D 
A
Pri1 
Pri2 
Sec2 
Sec4 
B 
A 
SP1 
SP2 
B 
SG 
C 
D 
A
Pri1 
Pri2 
Sec2 
Sec4 
B 
A 
T2-1
T2-3
T2-2 
B 
SG 
C 
D 
A
Pri1 
Pri2 
Sec1 
Sec3 
Sec1 
Sec3 
Sec1 
Sec3 
Sec2 
Sec4 
B 
A 
SP1 
SP2 
PG 
G1 
SP1
Primary
Secondary 
Shielding
Balancing 
G1
PG 
PG
G2 
PG 
SP2 
G2 
Fig. 7.19 The planar transformer under test and the corresponding winding structure

7.6 Experimental Veriﬁcation and Discussion
143
Table 7.4 The winding dimensions of planar transformer 
Wire type
Dimension
Turns 
Primary
Litz wire
0.1 mm × 80
WP1: 8  
WP2: 8  
Secondary
PCB winding
4 oz, 9.75 mm
4 
Shielding
Copper foil
0.1 mm 
Balancing
Single strand enameled wire
0.25 mm
1
Fig. 7.20 The measured 
magnitude curves of three 
planar transformers 
20log|GTR(s)| (dB) 
0 
–10 
–20 
–40 
1M
10M
30M
150k 
f (Hz) 
–30 
T2-1 
T2-2 
T2-3 
7.6.3 
Veriﬁcation of the HPC Method 
To verify the effectiveness of the HPC method, a HB LLC resonant converter is 
built, as shown in Fig. 7.21. The related parameters are listed in Table 7.5, and the 
transformer uses the planar transformer shown in Fig. 7.19. In addition, the resonant 
inductor uses 150 × 0.1 mm litz wire with 10 turns in a PQ 26/20 core. 
The measured parasitic capacitance Cp1 and Cp2 between the drain of Q1, Q2 
and the heat sink is 17 pF. When measuring the CM EMI, the heat sink and SG is 
connected to the PE. The LISN uses 21115-50-TS-100-N from Solar Electronics,
Fig. 7.21 Photo of the 
prototype

144
7
Shielding-Based Common-Mode Noise Cancellation Techniques …
Table 7.5 The speciﬁcations of the prototype 
Input voltage Vin
385 V
Resonant inductance Lr
13.5 μH 
Output voltage Vo
48 V
Resonant capacitance Cr
57 nF 
Output power Po
1 kW
Magnetizing inductance Lm
98 μH 
Resonant frequency f r
180 kHz
Input capacitance Cin
2.5 μF 
Turns ratio n
1/4
Output capacitance Co
600 μF
noise separator adopts ZSC-2-2 from Mini-Circuit and EMI receiver uses ESRP3 
from Rohde & Schwarz. 
Figure 7.22 shows the measured CM noise of the converter under full-load condi-
tion with different solutions. As shown in Fig. 7.22a, 10-dB reduction is achieved 
when the shielding layer (using T 2-2) is added. In Fig. 7.22b, 5-dB reduction is 
achieved when the balancing winding (using T 2-3) is added, verifying the effec-
tiveness of the combined shielding and balancing-winding method. When applying 
the HPC method, the compensation capacitor is connected between the PE and the 
node G2 in SP2, as shown in Fig. 7.19. Because the turns of the primary winding 
is 4 times of the compensation winding (shielding layer + balancing winding), the 
required compensation capacitance is 4Cp2, which is 68 pF. In Fig. 7.22c, by adding 
a 62-pF capacitor to achieve the best reduction, the CM noise is further reduced by 
10 dB. Figure 7.22d compares the original CM noise and the CM noise with the HPC 
method, the total CM noise reduction is 25 dB, veriﬁng the effectiveness of the HPC 
method.
7.7 
Summary 
In isolated DC-DC converters, shielding layer is usually added between the primary-
and secondary-winding layers to block the displacement current and reduce the CM 
noise. In this chapter, it is pointed out that the displacement current ﬂowing between 
the shielding layer and the adjacent secondary-winding layer still contributes to the 
CM noise. To eliminate this displacement current, it is necessary to equalize the AEP 
of shielding layer and the adjacent secondary-winding layer. To achieve equal AEP, 
two methods are proposed, including the shielding winding method and the combined 
shielding and balancing-winding method. The shielding winding method adjusts the 
turns of shielding layer, and the combined shielding and balancing-winding method 
adds a balancing winding to adjust vG. Both of these methods can be applied in 
ﬂyback, forward, push–pull, half-bridge, boost-type full-bridge converters and buck-
type full-bridge converters with full-wave rectiﬁers. However, for the buck-type 
full-bridge converter with full-bridge rectiﬁers and current-doubler rectiﬁers, these 
methods can not be applied. To further eliminate the displacement current ﬂowing

References
145
40 
120 
60 
20 
1M
10M
30M
150k 
100 
80 
original 
w/ shielding 
CM noise (dBμV) 
f (Hz) 
40
CM noise (dBμV) 
120 
60 
20 
1M
10M
30M
150k 
f (Hz) 
100 
80 
w/ +shielding + balancing winding 
w/ shielding 
(a) Original case and with shielding
(b) With shielding and w/ shielding 
+ balancing winding 
40 
120 
60 
20 
1M
10M
30M
150k 
100 
80 
HPC method 
CM noise (dBμV) 
f (Hz) 
w/ +shielding + balancing winding 
40 
120 
60 
20 
1M
10M
30M
150k 
100 
80 
CM noise (dBμV) 
f (Hz) 
(c) With shielding + balancing winding 
and HPC method 
(d) Original case and HPC method 
Fig. 7.22 Comparison of the CM noise in the half-bridge LLC resonant converter
through the high dv/dt node in the primary circuit and the PE, the HPC method is 
proposed. This method synthesizes the combined shielding and balancing-winding 
method and passive cancellation method, where the balancing winding is reused as 
a compensation winding. The shielding winding method, combined shielding and 
balancing-winding method and the HPC method are veriﬁed by the experimental 
results, respectively. 
References 
1. D.F. Knurek, Reducing EMI in switch mode power supplies, in Proceedings of Telecommuni-
cation Energy Conference (1988), pp. 411–420 
2. P. Kong, S. Wang, F.C. Lee, Z. Wang, Reducing common-mode noise in two-switch forward 
converter. IEEE Trans. Power Electron. 26(5), 1522–1533 (2011) 
3. Y. Yang, D. Huang, F. C. Lee, Q. Li, Transformer shielding technique for common mode noise 
reduction in isolated converters, in Proceedings of IEEE Energy Conversion Congress and 
Exposition (ECCE) (2013), pp. 4149–4153 
4. D. Cochrane, D. Chen, D. Boroyevic, Passive cancellation of common-mode noise in power 
electronic circuits. IEEE Trans. Power Electron. 18(3), 756–763 (2003)

146
7
Shielding-Based Common-Mode Noise Cancellation Techniques …
5. S. Qu, D. Chen, Mixed-mode EMI noise and its implications to ﬁlter design in ofﬂine switching 
power supplies. IEEE Trans. Power Electron. 17(4), 502–507 (2002) 
6. Q. Chen, W. Chen, Q. Song, Y. Zhu, An evaluation method of transformer behaviors on common-
mode conduction noise in SMPS, in Proceedings of IEEE Power Electronics and Drive Systems 
(PEDS) (2011), pp. 782–786s

Chapter 8 
Reducing the Common-Mode Noise 
in Phase-Shifted Full-Bridge Converter 
8.1 
The Common-Mode (CM) Noise Model 
of the Phase-Shifted Full-Bridge (PSFB) Converter 
8.1.1 
The PSFB Converter and Its CM Noise Model 
As mentioned in Chaps. 6 and 7, the phase-shifted full-bridge (PSFB) converter does 
not have the common-mode (CM) noise cancellation capability, and the shielding-
based methods can not reduce its CM noise. In this chapter, the CM noise reduction 
in the PSFB converter will be investigated. 
Figure 8.1a shows the main propagation paths of the CM noise in the PSFB 
converter, where, Q1 ~ Q4 are the power switches, Lr is the resonant inductor, T r is 
the isolation transformer with turns ratio of n, DR1 and DR2 are the output rectiﬁer 
diodes, Lf is the output ﬁlter inductor, Cf is the output ﬁlter capacitor, and RLd is the 
load resistor. In addition, Cps is the transformer inter-winding capacitance, CpA and 
CpB are the parasitic capacitance between the phase-leg midpoints A and B to the 
PE, respectively. When measuring the conducted EMI, the secondary ground (SG) is 
connected to the protective earth (PE), and the line impedance stabilization network 
(LISN) provides speciﬁed impedance in the conducted EMI frequency range from 
150 kHz to 30 MHz.
Figure 8.1b illustrates the key waveforms of the PSFB converter, where, vA and 
vB are the voltages of the phase-leg midpoints with respect to the primary ground 
(PG), vLr is the voltage across the resonant inductor. During [0, t1] and [t3, t4], DR1 
and DR2 are both conducting, and the input voltage V in is fully applied on Lr; during 
the other time intervals, the voltage applied on Lr is the difference between V in and 
the secondary side voltage reﬂected to the primary, which is nearly zero.
© The Author(s), under exclusive license to Springer Nature Singapore Pte Ltd. 2024 
X. Ruan et al., Conducted Electromagnetic Interference in Power Converters: Modeling, 
Prediction and Reduction, CPSS Power Electronics Series, 
https://doi.org/10.1007/978-981-99-9295-9_8 
147

148
8
Reducing the Common-Mode Noise in Phase-Shifted Full-Bridge …
Vin 
A 
B(b) 
* 
Q3 
Q1 
Q4 
Q2 
* 
* 
DR1 
DR2 
Lf 
c 
d 
CpB
CpA 
Lr 
PE 
LISN 
Cin 
Co
RLd 
SG 
a 
Cps 
PG 
Tr 
vLr 
50μH 
50μH 
1μF 
0.1μF 
50Ω 
1μF 
50Ω 
iCM 
iCM 
iLr 
1:n:n 
iCpA 
e 
0.1μF
iCpB
iCps 
(a) CM noise propagation path 
Q1
Q1 
0 
vA 
t 
vB (vb) 
0
Vin 
Ts 
t 
t 
vAB 
Vin 
Vin 
0 
t 
t
Q3 
Q2
Q4
Q4 
Vin 
φ 
t 
iLr 
vLr
Vin 
0 
t1
t2
t3 t4
t5
0 
Vin 
2Vin 
t 
vA+vB 
0 
(b) Key waveforms with phase-shift control 
Fig. 8.1 The CM noise propagation path and key waveforms of the PSFB converter
In Fig. 8.1a, the CM noise propagation paths are plotted with dashed lines. The 
displacement currents that ﬂow through CpA and CpB are determined by the electric 
potentials of midpoints A and B, respectively; while the current ﬂowing through 
Cps is related to the electric potentials of the transformer winding terminals. As the 
resonant inductor voltage affects the electric potential of the transformer primary 
winding terminals, it also affects the CM noise. So, vA, vB and vLr are regarded as 
the voltage sources that generate the CM noise. 
The substitution theorem is used for deriving the CM noise model of the full-
bridge converter. The rule of substitution is to acquire a CM noise circuit that is easy 
to be analyzed, while avoiding voltage loops and current nodes [1]. Firstly, Q3, Q4 and 
Lr are replaced by the voltage sources with their own waveforms. In the frequency 
range from 150 kHz to 30 MHz, the impedance of the LISN for the CM noise is 
25 Ω. Besides, the input capacitor Cin can be treated as short circuit owning to its 
relatively lower dv/dt compared with vA, vB or vLr. By neglecting the transformer 
leakage inductance, a controlled voltage/current source can be used to replace the 
transformer windings. To avoid voltage loops, Q1, Q2, DR1, DR2 are replaced by

8.1 The Common-Mode (CM) Noise Model of the Phase-Shifted …
149
Fig. 8.2 The CM noise 
model of full-bridge 
converter with substituted 
sources 
PG 
vA 
PE 
CpB
CpA 
vB 
iQ1
iQ2 
25 Ω 
vCM 
iDR2 
iDR1
vrect 
vab 
nvab 
nvab 
is1 
is2 
c 
d 
B 
A
a 
b 
vLr 
e 
Cae 
Cbe 
n(is1‒is2) 
the current sources with their own current waveforms. Then, the branch consisted 
of the output ﬁlter (ﬁlter inductor and ﬁlter capacitor) and the load is replaced by 
a voltage source, in order to avoid current nodes. By applying the two-capacitor 
model proposed in [2], the transformer inter-winding capacitance is replaced by 
two capacitors Cae and Cbe, which will be derived in Sect. 8.1.2 by calculating the 
displacement. Finally, the CM noise model of the full-bridge converter is obtained, 
as shown in Fig. 8.2. 
8.1.2 
The Derivation of the Two Capacitor Cae and Cbe 
Figure 8.3 shows the inter-winding capacitance model and the two-capacitor model 
of the transformer. As derived in Chap. 6, a general formula for the displacement 
current ﬂowing through the inter-winding capacitance is given by 
i Sub scrip
t dis Baseline equals upper C 0 StartFraction d Over d t EndFraction left brace lamda Subscript upper P Baseline v Subscript a Baseline plus left parenthesis 1 minus lamda Subscript upper P Baseline right parenthesis v Subscript b Baseline minus left bracket lamda Subscript upper S Baseline v Subscript c Baseline plus left parenthesis 1 minus lamda Subscript upper S Baseline right parenthesis v Subscript d Baseline right bracket right brace
i S ubscri pt di s Baseli ne equal s up er C 0 St
artFraction d Over d t EndFraction left brace lamda Subscript upper P Baseline v Subscript a Baseline plus left parenthesis 1 minus lamda Subscript upper P Baseline right parenthesis v Subscript b Baseline minus left bracket lamda Subscript upper S Baseline v Subscript c Baseline plus left parenthesis 1 minus lamda Subscript upper S Baseline right parenthesis v Subscript d Baseline right bracket right brace
where, C0 is the transformer structural capacitance, λP and λS are transformer 
winding structural parameters. 
Referring to Fig. 8.3b, the total displacement current that ﬂows through Cae and 
Cbe is expressed as
*
* 
* 
c 
d 
a 
b 
e 
1:n:n 
idis 
*
* 
* 
Cae 
Cbe
ibe 
iae 
a 
b 
c 
d 
e 
(a) Inter-winding capacitance model             (b) Two-capacitor model 
Fig. 8.3 The inter-winding capacitance and two-capacitor model of the transformer 

150
8
Reducing the Common-Mode Noise in Phase-Shifted Full-Bridge …
i Su bscrip t ae B
aseline plus i Subscript be Baseline equals upper C Subscript ae Baseline StartFraction d Over d t EndFraction left parenthesis v Subscript a Baseline minus v Subscript e Baseline right parenthesis plus upper C Subscript be Baseline StartFraction d Over d t EndFraction left parenthesis v Subscript b Baseline minus v Subscript e Baseline right parenthesis
i S ubsc ript ae Base
line plus i Subscript be Baseline equals upper C Subscript ae Baseline StartFraction d Over d t EndFraction left parenthesis v Subscript a Baseline minus v Subscript e Baseline right parenthesis plus upper C Subscript be Baseline StartFraction d Over d t EndFraction left parenthesis v Subscript b Baseline minus v Subscript e Baseline right parenthesis
i S ubsc ript 
ae Baseline plus i Subscript be Baseline equals upper C Subscript ae Baseline StartFraction d Over d t EndFraction left parenthesis v Subscript a Baseline minus v Subscript e Baseline right parenthesis plus upper C Subscript be Baseline StartFraction d Over d t EndFraction left parenthesis v Subscript b Baseline minus v Subscript e Baseline right parenthesis
By neglecting the transformer leakage inductance, the electric potential of the 
secondary winding terminals c and d are
Star tLayout  Enlarged l
eft  brace 1st Row v S
ubscript c Baseline equals n left parenthesis v Subscript a Baseline minus v Subscript b Baseline right parenthesis plus v Subscript e Baseline 2nd Row v Subscript d Baseline equals minus n left parenthesis v Subscript a Baseline minus v Subscript b Baseline right parenthesis plus v Subscript e Baseline EndLayout
Substituting (8.3) into (8.1), yields 
i Sub scrip
t dis Baseline equals upper C 0 StartFraction d Over d t EndFraction left bracket m v Subscript a Baseline plus left parenthesis 1 minus m right parenthesis v Subscript b Baseline minus v Subscript e Baseline right bracket
i S ubscr ipt d is Base line 
equals upper C 0 StartFraction d Over d t EndFraction left bracket m v Subscript a Baseline plus left parenthesis 1 minus m right parenthesis v Subscript b Baseline minus v Subscript e Baseline right bracket
where, the coefﬁcient m is expressed as 
m equal s la mda  Subsc
ript upper P Baseline plus n left parenthesis 1 minus 2 lamda Subscript upper S Baseline right parenthesis
Reorganizing (8.4) to approach the form of (8.1), yields 
i Sub scrip
t dis Baseline equals upper C 0 StartFraction d Over d t EndFraction left bracket m v Subscript a Baseline minus m v Subscript e Baseline plus left parenthesis 1 minus m right parenthesis v Subscript b Baseline minus left parenthesis 1 minus m right parenthesis v Subscript e Baseline right bracket equals m upper C 0 StartFraction d Over d t EndFraction v Subscript ae Baseline plus left parenthesis 1 minus m right parenthesis upper C 0 StartFraction d Over d t EndFraction v Subscript be
i S ubscr ipt di s Bas eline e quals  upper C  0 Sta
rtFraction d Over d t EndFraction left bracket m v Subscript a Baseline minus m v Subscript e Baseline plus left parenthesis 1 minus m right parenthesis v Subscript b Baseline minus left parenthesis 1 minus m right parenthesis v Subscript e Baseline right bracket equals m upper C 0 StartFraction d Over d t EndFraction v Subscript ae Baseline plus left parenthesis 1 minus m right parenthesis upper C 0 StartFraction d Over d t EndFraction v Subscript be
i S ubsc ript dis Bas
eline equals upper C 0 StartFraction d Over d t EndFraction left bracket m v Subscript a Baseline minus m v Subscript e Baseline plus left parenthesis 1 minus m right parenthesis v Subscript b Baseline minus left parenthesis 1 minus m right parenthesis v Subscript e Baseline right bracket equals m upper C 0 StartFraction d Over d t EndFraction v Subscript ae Baseline plus left parenthesis 1 minus m right parenthesis upper C 0 StartFraction d Over d t EndFraction v Subscript be
i S ubs
cript dis Baseline equals upper C 0 StartFraction d Over d t EndFraction left bracket m v Subscript a Baseline minus m v Subscript e Baseline plus left parenthesis 1 minus m right parenthesis v Subscript b Baseline minus left parenthesis 1 minus m right parenthesis v Subscript e Baseline right bracket equals m upper C 0 StartFraction d Over d t EndFraction v Subscript ae Baseline plus left parenthesis 1 minus m right parenthesis upper C 0 StartFraction d Over d t EndFraction v Subscript be
The condition for these two models to be equivalent is that the total displacement 
current ﬂowing through the inter-winding capacitance is equal to that ﬂowing through 
the two capacitors. By comparing the coefﬁcient before vae and vbe in (8.6) and (8.2), 
we have
Start Layout
 Enl arged  left b
race 1st Row upper C Subscript ae Baseline equals m upper C 0 2nd Row upper C Subscript be Baseline equals left parenthesis 1 minus m right parenthesis upper C 0 EndLayout
Substituting (8.5) into (8.7), yields
Start Layout  Enl arg ed left br
ace 1st R ow up er C  Su bscript ae 
Baseline equals left bracket lamda Subscript upper P Baseline plus n left parenthesis 1 minus 2 lamda Subscript upper S Baseline right parenthesis right bracket upper C 0 2nd Row upper C Subscript be Baseline equals left brace 1 minus left bracket lamda Subscript upper P Baseline plus n left parenthesis 1 minus 2 lamda Subscript upper S Baseline right parenthesis right bracket right brace upper C 0 EndLayout
8.1.3 
The Simpliﬁcation of the CM Noise Model 
Superposition theorem is adopted to simplify the CM noise model in Fig. 8.2. Firstly, 
only the excitation of current sources is considered, and all the voltage sources are 
shorted. The resultant sub-circuit is shown in Fig. 8.4a. As seen, all the current 
sources are essentially shorted, implying that current sources have no impact on the 
CM noise. Secondly, only the excitation of voltage sources is considered and all the

8.2 Applying Symmetry Circuit to Eliminate the Impact of Resonant …
151
PG 
vA 
PE 
CpB
CpA 
vB 
iQ1
iQ2 
25 Ω 
vCM 
vrect 
nvab 
nvab 
is1 
is2 
c 
d 
B 
A
a 
b 
vLr 
e 
Cae 
Cbe 
iDR2 
iDR1 
vab 
n(is1‒is2) 
PG 
vA 
PE 
CpB
CpA 
vB 
iQ1
iQ2 
25 Ω 
vCM 
vrect 
nvab 
nvab 
is1 
is2 
c 
d 
B 
A
a 
b 
vLr 
e 
Cae 
Cbe 
iDR2 
iDR1 
vab 
n(is1‒is2) 
(a) Excited only by current sources               (b) Excited only by voltage sources 
Fig. 8.4 Simpliﬁcation of CM noise model of full-bridge converter 
Fig. 8.5 CM noise model of 
full-bridge converter
vA
vB 
vLr 
A 
CpA 
Cae 
CpB 
Cbe 
25 Ω 
vCM 
PE 
a
b 
B 
current sources are opened, and the resultant sub-circuit is shown in Fig. 8.4b. As 
seen, the transformer secondary winding currents, is1 and is2, are both zero. Therefore, 
the controlled current source across the primary winding is essentially zero. Finally, 
the circuit in Fig. 8.4b is reorganized and simpliﬁed, and the CM noise model is 
ﬁnally obtained, as shown in Fig. 8.5. As seen, in order to reduce the CM noise in 
the PSFB converter, the displacement currents generated by vLr, vA and vB via the 
corresponding parasitic capacitance should be eliminated, which will be discussed 
in Sects. 8.2 and 8.3, respectively. 
8.2 
Applying Symmetry Circuit to Eliminate the Impact 
of Resonant Inductor Voltage on the CM Noise 
8.2.1 
Adoption of Symmetrical Resonant Inductor 
As seen from Fig. 8.5a, Cae is the only propagation path for vLr. In order to eliminate 
the effect of vLr, a compensation voltage source v'Lr can be added and connected 
in series with Cbe, as shown in Fig. 8.6a. Noted that v'Lr should be complementary 
with vLr, and Cbe should be equal to Cae. By properly designing the transformer 
winding structure, the condition of Cbe = Cae can be achieved. In addition, v'Lr can

152
8
Reducing the Common-Mode Noise in Phase-Shifted Full-Bridge …
 
vA
vB 
A 
CpA 
Cae 
CpB 
Cbe 
25 Ω 
vCM 
PE 
a
b 
B 
vLr
vLr' 
A 
B 
PG 
* 
Q3 
Q1 
Q4 
Q2 
* 
* 
DR1 
DR2 
Lf 
c 
d 
Lr1 
CpA
CpB 
PE 
Vin 
RLd
Co 
vLr1 
vLr2 
iLr 
a 
b
SG 
e 
Cae 
Cbe 
Lr2 
(a) The CM noise model with v′Lr               (b) The realization with symmetrical inductor 
Fig. 8.6 CM noise model with compensation voltage source v'Lr 
be realized by equally dividing the resonant inductor winding into two ones, which 
are the coupled inductors Lr1 and Lr2, as shown in Fig. 8.6b.
8.2.2 
Adoption of Symmetrical Transformer 
With Cae = Cbe, the propagation path of the transformer for the CM noise is symmet-
rical. Here, planar transformer is adopted to reduce the proﬁle, as shown in Fig. 8.7. 
Spiral winding and PCB winding are used for the primary and secondary windings, 
respectively. The primary windings Pri1 and Pri2 are connected in series, and each 
winding has NP turns. The secondary windings Sec1-1, Sec1-2, Sec2-1 and Sec2-
2 are connected in series one by one, and each winding has one turn. Due to the 
non-evenly distributed inter-winding capacitance between the spiral windings, the 
terminal connection of the windings may inﬂuence the displacement current ﬂowing 
through inter-winding capacitances [3]. Here, two kinds of terminal connection for 
the primary winding are investigated, as shown in Fig. 8.7.
Provided that Pri1 and Pri2 are tightly wound layers, there is displacement current 
ﬂowing between Pri1 and Sec1-1, and between Pri2 and Sec2-2. The structural capac-
itance between Pri1 and Sec1-1 is denoted by C01, and the structural capacitance 
between Pri2 and Sec2-2 is C02. According to the displacement current formula 
given in [4], for terminal connection I, the displacement current idis1 ﬂowing from 
Pri1 to Sec1-1 and idis2 ﬂowing from Pri2 to Sec2-2 are expressed by
StartLa yout E nlarged left brace 1st Row i Subscript dis 1 Baseline equals upper C 01 StartFraction d Over d t EndFraction left bracket lamda 1 v Subscript a Baseline plus left parenthesis 1 minus lamda 1 right parenthesis v Subscript upper M Baseline minus left parenthesis seven eighths v Subscript c Baseline plus one eighth v Subscript d Baseline right parenthesis right bracket 2nd Row i Subscript dis 2 Baseline equals upper C 02 StartFraction d Over d t EndFraction left bracket lamda 1 v Subscript upper M Baseline plus left parenthesis 1 minus lamda 1 right parenthesis v Subscript b Baseline minus left parenthesis one eighth v Subscript c Baseline plus seven eighths v Subscript d Baseline right parenthesis right bracket EndLayout
St
a
rtLay out E nlarged l
e ft brace 1st Row i Subscript dis 1 Baseline equals upper C 01 StartFraction d Over d t EndFraction left bracket lamda 1 v Subscript a Baseline plus left parenthesis 1 minus lamda 1 right parenthesis v Subscript upper M Baseline minus left parenthesis seven eighths v Subscript c Baseline plus one eighth v Subscript d Baseline right parenthesis right bracket 2nd Row i Subscript dis 2 Baseline equals upper C 02 StartFraction d Over d t EndFraction left bracket lamda 1 v Subscript upper M Baseline plus left parenthesis 1 minus lamda 1 right parenthesis v Subscript b Baseline minus left parenthesis one eighth v Subscript c Baseline plus seven eighths v Subscript d Baseline right parenthesis right bracket EndLayout
Start Layout Enlarged left brace 1st Row i Subscript dis 1 Baseline equals upper C 01 StartFraction d Over d t EndFraction left bracket lamda 1 v Subscript a Baseline plus left parenthesis 1 minus lamda 1 right parenthesis v Subscript upper M Baseline minus left parenthesis seven eighths v Subscript c Baseline plus one eighth v Subscript d Baseline right parenthesis right bracket 2nd Row i Subscript dis 2 Baseline equals upper C 02 StartFraction d Over d t EndFraction left bracket lamda 1 v Subscript upper M Baseline plus left parenthesis 1 minus lamda 1 right parenthesis v Subscript b Baseline minus left parenthesis one eighth v Subscript c Baseline plus seven eighths v Subscript d Baseline right parenthesis right bracket EndLayout
Star
tL
ayout Enlarg ed left brace 1st Row i Subscript dis 1 Baseline equals upper C 01 StartFraction d Over d t EndFraction left bracket lamda 1 v Subscript a Baseline plus left parenthesis 1 minus lamda 1 right parenthesis v Subscript upper M Baseline minus left parenthesis seven eighths v Subscript c Baseline plus one eighth v Subscript d Baseline right parenthesis right bracket 2nd Row i Subscript dis 2 Baseline equals upper C 02 StartFraction d Over d t EndFraction left bracket lamda 1 v Subscript upper M Baseline plus left parenthesis 1 minus lamda 1 right parenthesis v Subscript b Baseline minus left parenthesis one eighth v Subscript c Baseline plus seven eighths v Subscript d Baseline right parenthesis right bracket EndLayout
St
a
rtLay out E nlarged l
e ft brace 1st Row i Subscript dis 1 Baseline equals upper C 01 StartFraction d Over d t EndFraction left bracket lamda 1 v Subscript a Baseline plus left parenthesis 1 minus lamda 1 right parenthesis v Subscript upper M Baseline minus left parenthesis seven eighths v Subscript c Baseline plus one eighth v Subscript d Baseline right parenthesis right bracket 2nd Row i Subscript dis 2 Baseline equals upper C 02 StartFraction d Over d t EndFraction left bracket lamda 1 v Subscript upper M Baseline plus left parenthesis 1 minus lamda 1 right parenthesis v Subscript b Baseline minus left parenthesis one eighth v Subscript c Baseline plus seven eighths v Subscript d Baseline right parenthesis right bracket EndLayout
Start Layout Enlarged left brace 1st Row i Subscript dis 1 Baseline equals upper C 01 StartFraction d Over d t EndFraction left bracket lamda 1 v Subscript a Baseline plus left parenthesis 1 minus lamda 1 right parenthesis v Subscript upper M Baseline minus left parenthesis seven eighths v Subscript c Baseline plus one eighth v Subscript d Baseline right parenthesis right bracket 2nd Row i Subscript dis 2 Baseline equals upper C 02 StartFraction d Over d t EndFraction left bracket lamda 1 v Subscript upper M Baseline plus left parenthesis 1 minus lamda 1 right parenthesis v Subscript b Baseline minus left parenthesis one eighth v Subscript c Baseline plus seven eighths v Subscript d Baseline right parenthesis right bracket EndLayout
Star
tL
ayout Enlarged left brace 1st Row i Subscript dis 1 Baseline equals upper C 01 StartFraction d Over d t EndFraction left bracket lamda 1 v Subscript a Baseline plus left parenthesis 1 minus lamda 1 right parenthesis v Subscript upper M Baseline minus left parenthesis seven eighths v Subscript c Baseline plus one eighth v Subscript d Baseline right parenthesis right bracket 2nd Row i Subscript dis 2 Baseline equals upper C 02 StartFraction d Over d t EndFraction left bracket lamda 1 v Subscript upper M Baseline plus left parenthesis 1 minus lamda 1 right parenthesis v Subscript b Baseline minus left parenthesis one eighth v Subscript c Baseline plus seven eighths v Subscript d Baseline right parenthesis right bracket EndLayout
where, va, vb, vM, vc and vd are the electric potentials of the corresponding transformer 
terminals, and λ1 is a parameter depending on the winding dimension, which is given 
by

8.2 Applying Symmetry Circuit to Eliminate the Impact of Resonant …
153
Pri1 
Pri2 
Sec1-1 
Sec1-2 
Sec2-1 
Sec2-2 
a 
b 
e 
c 
d 
M 
r1 
r2 
c 
d 
e 
a 
b 
M 
3D view 
C01 
C02 
2D view 
(a) Terminal connection I 
Pri1 
Pri2 
Sec1-1 
Sec1-2 
Sec2-1 
Sec2-2 
a 
b 
e 
c 
d 
M 
r1 
r2 
c 
d 
e 
a 
b 
M 
C01 
C02 
3D view
2D view 
(b) Terminal connection II 
Fig. 8.7 Planaer transformer with different terminal connection of primary winding
lam da
 1 equals StartStartFraction two thirds r 1 plus one third r 2 plus StartFraction r 2 minus r 1 Over 6 upper N Subscript upper P Superscript 2 Baseline EndFraction OverOver r 1 plus r 2 EndEndFraction
lamd a 1 equals StartStartFraction two thirds r 1 plus one third r 2 plus StartFraction r 2 minus r 1 Over 6 upper N Subscript upper P Superscript 2 Baseline EndFraction OverOver r 1 plus r 2 EndEndFraction
lamd a 1 equals StartStartFraction two thirds r 1 plus one third r 2 plus StartFraction r 2 minus r 1 Over 6 upper N Subscript upper P Superscript 2 Baseline EndFraction OverOver r 1 plus r 2 EndEndFraction
la md
a 1 equals StartStartFraction two thirds r 1 plus one third r 2 plus StartFraction r 2 minus r 1 Over 6 upper N Subscript upper P Superscript 2 Baseline EndFraction OverOver r 1 plus r 2 EndEndFraction
lam da 1 
equals StartStartFraction two thirds r 1 plus one third r 2 plus StartFraction r 2 minus r 1 Over 6 upper N Subscript upper P Superscript 2 Baseline EndFraction OverOver r 1 plus r 2 EndEndFraction
where, r1 and r2 denotes the inner and outer radius of windings. 
Supposing that the electric potential varies linearly along windings, the electric 
potential of the midpoint M from the primary winding equals to 
v S ubscri pt uppe
r M Baseline equals left parenthesis v Subscript a Baseline plus v Subscript b Baseline right parenthesis divided by 2
By substituting (8.11) into (8.9), the total displacement current idis is derived as 
Start Layout 1 st Row 1 st Colu mn i Subscript dis 2nd Column equals i Subscript dis 1 Baseline plus i Subscript dis 2 Baseline equals left parenthesis upper C 01 plus upper C 02 right parenthesis StartFraction d Over d t EndFraction left bracket lamda Subscript upper P Baseline v Subscript a Baseline plus left parenthesis 1 minus lamda Subscript upper P Baseline right parenthesis v Subscript b Baseline minus lamda Subscript upper S Baseline v Subscript c Baseline minus left parenthesis 1 minus lamda Subscript upper S Baseline right parenthesis v Subscript d Baseline right bracket 2nd Row 1st Column Blank 2nd Column equals upper C 0 StartFraction d Over d t EndFraction left bracket lamda Subscript upper P Baseline v Subscript a Baseline plus left parenthesis 1 minus lamda Subscript upper P Baseline right parenthesis v Subscript b Baseline minus lamda Subscript upper S Baseline v Subscript c Baseline minus left parenthesis 1 minus lamda Subscript upper S Baseline right parenthesis v Subscript d Baseline right bracket EndLayout
Sta rtLayo ut 1s t Row 1s t Colum n i S ubscript 
dis 2
nd Column equals i Subscript dis 1 Baseline plus i Subscript dis 2 Baseline equals left parenthesis upper C 01 plus upper C 02 right parenthesis StartFraction d Over d t EndFraction left bracket lamda Subscript upper P Baseline v Subscript a Baseline plus left parenthesis 1 minus lamda Subscript upper P Baseline right parenthesis v Subscript b Baseline minus lamda Subscript upper S Baseline v Subscript c Baseline minus left parenthesis 1 minus lamda Subscript upper S Baseline right parenthesis v Subscript d Baseline right bracket 2nd Row 1st Column Blank 2nd Column equals upper C 0 StartFraction d Over d t EndFraction left bracket lamda Subscript upper P Baseline v Subscript a Baseline plus left parenthesis 1 minus lamda Subscript upper P Baseline right parenthesis v Subscript b Baseline minus lamda Subscript upper S Baseline v Subscript c Baseline minus left parenthesis 1 minus lamda Subscript upper S Baseline right parenthesis v Subscript d Baseline right bracket EndLayout
Sta rtLayo ut 1s t Row 1s t Colum n i S ubscript
 dis 2nd Column equals i Subscript dis 1 Baseline plus i Subscript dis 2 Baseline equals left parenthesis upper C 01 plus upper C 02 right parenthesis StartFraction d Over d t EndFraction left bracket lamda Subscript upper P Baseline v Subscript a Baseline plus left parenthesis 1 minus lamda Subscript upper P Baseline right parenthesis v Subscript b Baseline minus lamda Subscript upper S Baseline v Subscript c Baseline minus left parenthesis 1 minus lamda Subscript upper S Baseline right parenthesis v Subscript d Baseline right bracket 2nd Row 1st Column Blank 2nd Column equals upper C 0 StartFraction d Over d t EndFraction left bracket lamda Subscript upper P Baseline v Subscript a Baseline plus left parenthesis 1 minus lamda Subscript upper P Baseline right parenthesis v Subscript b Baseline minus lamda Subscript upper S Baseline v Subscript c Baseline minus left parenthesis 1 minus lamda Subscript upper S Baseline right parenthesis v Subscript d Baseline right bracket EndLayout
where, the transformer structural capacitance C0 = C01 + C02, and λP and λS are 
given by
S
tar tL ayout Enlarged left brace 1st Row lamda Subscript upper P Baseline equals StartFraction left parenthesis 1 plus lamda 1 right parenthesis upper C 01 plus lamda 1 upper C 02 Over 2 left parenthesis upper C 01 plus upper C 02 right parenthesis EndFraction 2nd Row lamda Subscript upper S Baseline equals StartFraction 7 upper C 01 plus upper C 02 Over 8 left parenthesis upper C 01 plus upper C 02 right parenthesis EndFraction EndLayout
StartLayout
 En la rged left brace 1st Row lamda Subscript upper P Baseline equals StartFraction left parenthesis 1 plus lamda 1 right parenthesis upper C 01 plus lamda 1 upper C 02 Over 2 left parenthesis upper C 01 plus upper C 02 right parenthesis EndFraction 2nd Row lamda Subscript upper S Baseline equals StartFraction 7 upper C 01 plus upper C 02 Over 8 left parenthesis upper C 01 plus upper C 02 right parenthesis EndFraction EndLayout
StartLayout
 Enlarged left brace 1st Row lamda Subscript upper P Baseline equals StartFraction left parenthesis 1 plus lamda 1 right parenthesis upper C 01 plus lamda 1 upper C 02 Over 2 left parenthesis upper C 01 plus upper C 02 right parenthesis EndFraction 2nd Row lamda Subscript upper S Baseline equals StartFraction 7 upper C 01 plus upper C 02 Over 8 left parenthesis upper C 01 plus upper C 02 right parenthesis EndFraction EndLayout

154
8
Reducing the Common-Mode Noise in Phase-Shifted Full-Bridge …
Likewise, the total displacement current idis ﬂowing through the inter-winding 
capacitance of the transformer with terminal connection II can be also derived, which 
is the same as (8.12). The corresponding λP and λS for this transformer are expressed 
as
S
tar tL ayout Enlarged left brace 1st Row lamda Subscript upper P Baseline equals StartFraction left parenthesis 1 plus lamda 1 right parenthesis upper C 01 plus left parenthesis 1 minus lamda 1 right parenthesis upper C 02 Over 2 left parenthesis upper C 01 plus upper C 02 right parenthesis EndFraction 2nd Row lamda Subscript upper S Baseline equals StartFraction 7 upper C 01 plus upper C 02 Over 8 left parenthesis upper C 01 plus upper C 02 right parenthesis EndFraction EndLayout
StartLayout
 En la rged left brace 1st Row lamda Subscript upper P Baseline equals StartFraction left parenthesis 1 plus lamda 1 right parenthesis upper C 01 plus left parenthesis 1 minus lamda 1 right parenthesis upper C 02 Over 2 left parenthesis upper C 01 plus upper C 02 right parenthesis EndFraction 2nd Row lamda Subscript upper S Baseline equals StartFraction 7 upper C 01 plus upper C 02 Over 8 left parenthesis upper C 01 plus upper C 02 right parenthesis EndFraction EndLayout
StartLayout
 Enlarged left brace 1st Row lamda Subscript upper P Baseline equals StartFraction left parenthesis 1 plus lamda 1 right parenthesis upper C 01 plus left parenthesis 1 minus lamda 1 right parenthesis upper C 02 Over 2 left parenthesis upper C 01 plus upper C 02 right parenthesis EndFraction 2nd Row lamda Subscript upper S Baseline equals StartFraction 7 upper C 01 plus upper C 02 Over 8 left parenthesis upper C 01 plus upper C 02 right parenthesis EndFraction EndLayout
For a symmetrical transformer, Cae = Cbe is expected. Substituting Cae = Cbe into 
(8.8), yields 
lam da Sub script upper
 P Baseline plus n left parenthesis 1 minus 2 lamda Subscript upper S Baseline right parenthesis equals 0.5
By substituting (8.13) into (8.15), the condition for making the transformer with 
terminal connection I be symmetrical is 
StartFraction upper C 01 Over upper C 02 EndFraction equals StartFraction 2 minus 2 lamda 1 minus 3 n Over 2 lamda 1 minus 3 n EndFraction
Star
tFra ction upper C 01 Over upper C 02 EndFraction equals StartFraction 2 minus 2 lamda 1 minus 3 n Over 2 lamda 1 minus 3 n EndFraction
Star tFrac
tion upper C 01 Over upper C 02 EndFraction equals StartFraction 2 minus 2 lamda 1 minus 3 n Over 2 lamda 1 minus 3 n EndFraction
Likewise, by substituting (8.14) into (8.15), the condition for making the 
transformer with terminal connection II be symmetrical is 
2 la mda 1  mi nu s 3 n  equa
ls 0 or upper C 01 equals upper C 02
To satisfy (8.16), C01 and C02 should be tuned, which is practically complex. 
While C01 = C02 can be easily achieved to satisfy (8.17) by adopting the same 
type of insulation material with equal thickness. Therefore, terminal connection II is 
preferred. 
From the above discussion, the symmetrical resonant inductor and symmetrical 
transformer conﬁguration can be easily realized by adjusting the resonant inductor 
conﬁguration and properly designing the transformer winding structure, which does 
not require additional cost. 
8.3 
Applying Passive Cancellation to Eliminate the Impact 
of Midpoint Voltages on the CM Noise 
Usually, the same type of insulation material with the same thickness is inserted 
between Q1 ~ Q4 and the heat sink. So, CpA and CpB are nearly the same, i.e., 
uppe r C Su bscr
ipt pA Baseline equals upper C Subscript pB Baseline equals upper C Subscript p

8.3 Applying Passive Cancellation to Eliminate the Impact of Midpoint …
155
vA
vB 
A 
Cp 
0.5C0 
Cp 
0.5C0 
25 Ω 
vCM 
PE 
B 
(vA+vB) 
C0+2Cp 
25 Ω 
vCM 
PE 
1 
2 
(a) Equivalent circuit
(b) Simplified equivalent circuit 
Fig. 8.8 CM noise model of full-bridge converter with symmetrical circuit 
For a symmetrical transformer, the constraint of winding structural parameters is 
given in (8.15). By substituting (8.15) into (8.8), Cae and Cbe is derived as 
uppe r C Su bscrip
t ae Baseline equals upper C Subscript be Baseline equals upper C 0 divided by 2
With the symmetrical resonant inductor and symmetrical transformer, the effect 
of the resonant inductor voltage on the CM noise is nulliﬁed. Therefore, by shorting 
vLr and v'Lr in Fig. 8.6a and considering the related capacitances given in (8.18) 
and (8.19), the CM noise model shown in Fig. 8.6a can be simpliﬁed, as shown in 
Fig. 8.8a. 
Figure 8.8a can be further simpliﬁed as Fig. 8.8b with Thevenin’s theorem. As 
seen, for cancelling the CM noise, a compensation branch consisting of a compen-
sation voltage source vcom and a capacitor Ccom can be added, as shown in Fig. 8.9. 
Moreover, vcom should be out-of-phase with (vA + vB), and the condition for 
cancelling the CM noise is 
upper
 C Subscript com Baseline StartFraction d Over d t EndFraction v Subscript com Baseline plus left parenthesis upper C 0 plus 2 upper C Subscript p Baseline right parenthesis StartFraction d Over d t EndFraction left parenthesis StartFraction v Subscript upper A Baseline plus v Subscript upper B Baseline Over 2 EndFraction right parenthesis equals 0
up er C S
u
bsc ript 
c om Baseline StartFraction d Over d t EndFraction v Subscript com Baseline plus left parenthesis upper C 0 plus 2 upper C Subscript p Baseline right parenthesis StartFraction d Over d t EndFraction left parenthesis StartFraction v Subscript upper A Baseline plus v Subscript upper B Baseline Over 2 EndFraction right parenthesis equals 0
up
per C Subscript com Baseline StartFraction d Over d t EndFraction v Subscript com Baseline plus left parenthesis upper C 0 plus 2 upper C Subscript p Baseline right parenthesis StartFraction d Over d t EndFraction left parenthesis StartFraction v Subscript upper A Baseline plus v Subscript upper B Baseline Over 2 EndFraction right parenthesis equals 0
u
p
per
 C Subscript com Baseline StartFraction d Over d t EndFraction v Subscript com Baseline plus left parenthesis upper C 0 plus 2 upper C Subscript p Baseline right parenthesis StartFraction d Over d t EndFraction left parenthesis StartFraction v Subscript upper A Baseline plus v Subscript upper B Baseline Over 2 EndFraction right parenthesis equals 0
According to (8.20), two implementations for realizing vcom will be presented as 
follows. 
Fig. 8.9 CM noise model of 
full-bridge converter with 
cancellation branch
vcom 
Ccom
C0+2Cp 
25 Ω 
vCM 
PE 
(vA+vB)
1 
2 

156
8
Reducing the Common-Mode Noise in Phase-Shifted Full-Bridge …
Fig. 8.10 Implementation I 
for constructing the 
cancellation circuit
A 
B 
PG 
* 
Q3 
Q1 
Q4 
Q2 
* 
* 
DR1 
DR2 
Lf 
c 
d 
Lr 
CpA
CpB 
PE 
Ccom 
C 
Cb1 
Cb2 
Tc1 
Tc2 
SG 
RLd
Co
a 
b 
vLr1 
vLr2 
iLr 
nc1:1 
nc1:1 
e
Vin 
8.3.1 
Implementation I 
To obtain the compensation voltage vcom, which is out-of-phase with (vA + vB), it 
is straightforward to sense vA and vB [5], and then invert them and add together, as 
shown in Fig. 8.10, where, Cb1 and Cb2 are the dc blocking capacitors for removing 
the DC component in vA and vB, which are nearly equal to V in/2. The AC components 
of vA and vB are sensed by transformer T c1 and T c2, respectively. The secondary sides 
of T c1 and T c2, which output the corresponding inverted voltage, are connected in 
series for summing up the sensed voltages. The resultant compensation voltage vcom 
is 
v Sub s cript co m Bas eline 
equals minus n Subscript c 1 Baseline left parenthesis v Subscript upper A Baseline plus v Subscript upper B Baseline minus upper V Subscript in Baseline right parenthesis
where, nc1 is the turns ratio of T c1 and T c2. 
By substituting (8.21) into (8.20), the required compensation capacitance Ccom is 
derived as 
upper  C Su bscript com Baseline equals StartFraction upper C 0 plus 2 upper C Subscript p Baseline Over 2 n Subscript c 1 Baseline EndFraction
upper
 C Subscript com Baseline equals StartFraction upper C 0 plus 2 upper C Subscript p Baseline Over 2 n Subscript c 1 Baseline EndFraction
8.3.2 
Implementation II 
Another way of realizing the compensation voltage is to pick up the voltage in the 
circuit which is proportional to (vA + vB), and then invert the sensed voltage by a 
transformer, as shown in Fig. 8.11. With symmetrical resonant inductor, we have 
S
ta
rt
Lay out E nlarged
 le ft br ace 1st
 Row v Subsc
ript a Baseline equals v Subscript upper A Baseline minus v Subscript Lr 1 Baseline 2nd Row v Subscript b Baseline equals v Subscript upper B Baseline plus v Subscript Lr 2 Baseline 3rd Row v Subscript Lr 1 Baseline equals v Subscript Lr 2 Baseline EndLayout

8.4 The Necessity of Combining Two Methods
157
Fig. 8.11 Implementation II 
for constructing the 
cancellation circuit 
A 
B 
PG 
* 
Q3 
Q1 
Q4 
Q2 
* 
* 
Lf 
c 
d 
Lr 
CpA
CpB
Ccom 
PE 
Cb 
M 
Tc 
RLd
Co 
SG 
a 
b 
vLr1 
vLr2 
iLr 
1:nc 
C 
DR1 
DR2 
e
Vin 
Substituting (8.23) into (8.11), yields 
v S ubscri pt uppe
r M Baseline equals left parenthesis v Subscript upper A Baseline plus v Subscript upper B Baseline right parenthesis divided by 2
As shown in Fig. 8.11, the voltage across point M and the PG is sensed by trans-
former T c. Cb is the dc blocking capacitor for removing the DC component in vM, 
which is V in/2. The secondary winding of T c outputs a compensation voltage which 
is out-of-phase with (vA + vB). The resultant compensation voltage vcom is 
v Sub s cri
pt c om Baseline equals minus n Subscript c Baseline left parenthesis StartFraction v Subscript upper A Baseline plus v Subscript upper B Baseline Over 2 EndFraction minus StartFraction upper V Subscript in Baseline Over 2 EndFraction right parenthesis
v
 Subscript com Baseline equals minus n Subscript c Baseline left parenthesis StartFraction v Subscript upper A Baseline plus v Subscript upper B Baseline Over 2 EndFraction minus StartFraction upper V Subscript in Baseline Over 2 EndFraction right parenthesis
v
 
Subscript com Baseline equals minus n Subscript c Baseline left parenthesis StartFraction v Subscript upper A Baseline plus v Subscript upper B Baseline Over 2 EndFraction minus StartFraction upper V Subscript in Baseline Over 2 EndFraction right parenthesis
where, nc is the turns ratio of T c. 
By substituting (8.25) into (8.20), the required compensation capacitance for 
implementation II is obtained as 
upper  C Su bscript com Baseline equals StartFraction upper C 0 plus 2 upper C Subscript p Baseline Over n Subscript c Baseline EndFraction
up
er C Subscript com Baseline equals StartFraction upper C 0 plus 2 upper C Subscript p Baseline Over n Subscript c Baseline EndFraction
Compared with implementation I, only one transformer and one DC blocking 
capacitor are required in implementation II. Moreover, the size of T c may be smaller 
than T c1 (T c2), since the volt-second applied to the primary winding of T c is smaller. 
Note that, the leakage inductance of T c should be small enough to make vcom be 
proportional to (vA + vB) as desired. 
8.4 
The Necessity of Combining Two Methods 
In this Section, the necessity of combining symmetry circuit and passive cancellation 
circuit for reducing the CM noise is discussed. The deﬁnitions of various solutions 
are listed in Table 8.1 for the convenience of illustration. Particularly, S_00 is the 
original case without symmetrical resonant inductor and passive cancellation circuit,

158
8
Reducing the Common-Mode Noise in Phase-Shifted Full-Bridge …
and S_11 is the combined solution with both the symmetrical resonant inductor and 
passive cancellation circuit. Please note that the symmetrical transformer is always 
used in all solutions. 
To compare the CM noise with different solutions, the equivalent noise source 
(ENS) in Chap. 6 is adopted. Figure 8.12 shows the simpliﬁed CM noise model, 
where, vS is the ENS and CS is the total capacitance, as listed in Table 8.2. For S_ 
00, by substituting (8.18) and (8.19) into Fig.  8.5 and simplifying the circuit, vS_00 
and CS_00 can be derived; for S_10, vS_10 and CS_10 are obtained from the simpliﬁed 
circuit shown in Fig. 8.8b; for S_01, the circuit is similar with Fig. 8.11, while 
asymmetrical resonant inductor is used and vLr2 = 0. The compensation capacitor 
Ccom is given as (8.26) to cancel the effect of vA and vB; and for S_11, vS_11 and 
CS_11 can be calculated according to Fig. 8.9. 
According to Fig. 8.12, the CM voltage vCM in the frequency-domain is calculated 
as
Table 8.1 Deﬁnitions of various solutions 
Solutions
Deﬁnitions 
Symmetrical transformer
Asymmetrical resonant 
inductor 
w/o passive cancellation 
circuit 
S_00 
w/ passive cancellation 
circuit 
S_01 
Symmetrical resonant 
inductor 
w/o passive cancellation 
circuit 
S_10 
w/ passive cancellation 
circuit 
S_11 
Fig. 8.12 Simpliﬁed CM 
noise model for the PSFB 
converter 
vS 
CS 
25 Ω
vCM 
PE 
Table 8.2 The ENS and total 
capacitance for different 
solutions 
S_ij
vS_ij
CS_ij 
S_00
one half left parenthesis v Subscript upper A Baseline plus v Subscript upper B Baseline right parenthesis minus one half StartFraction upper C 0 Over upper C 0 plus 2 upper C Subscript p Baseline EndFraction v Subscript upper L r
one ha lf left parenthesis v Subscript upper A Baseline plus v Subscript upper B Baseline right parenthesis minus one half StartFraction upper C 0 Over upper C 0 plus 2 upper C Subscript p Baseline EndFraction v Subscript upper L r
on
e half left parenthesis v Subscript upper A Baseline plus v Subscript upper B Baseline right parenthesis minus one half StartFraction upper C 0 Over upper C 0 plus 2 upper C Subscript p Baseline EndFraction v Subscript upper L r
one hal f left parenthesis v Subscript upper A Baseline plus v Subscript upper B Baseline right parenthesis minus one half StartFraction upper C 0 Over upper C 0 plus 2 upper C Subscript p Baseline EndFraction v Subscript upper L r
up er C 0 plus 2 upper C Subscript p
S_10
one half left parenthesis v Subscript upper A Baseline plus v Subscript upper B Baseline right parenthesis
one ha lf left parenthesis v Subscript upper A Baseline plus v Subscript upper B Baseline right parenthesis
up er C 0 plus 2 upper C Subscript p
S_01
StartFraction n Subscript c Baseline Over n Subscript c Baseline plus 1 EndFraction StartFraction 2 upper C Subscript p Baseline Over upper C 0 plus 2 upper C Subscript p Baseline EndFraction one half v Subscript upper L r
Start
Fraction n Subscript c Baseline Over n Subscript c Baseline plus 1 EndFraction StartFraction 2 upper C Subscript p Baseline Over upper C 0 plus 2 upper C Subscript p Baseline EndFraction one half v Subscript upper L r
Startpr
action n Subscript c Baseline Over n Subscript c Baseline plus 1 EndFraction StartFraction 2 upper C Subscript p Baseline Over upper C 0 plus 2 upper C Subscript p Baseline EndFraction one half v Subscript upper L r
StartFraction n Subscript c Baseline Over n Subscript c Baseline plus 1 EndFraction StartFraction 2 upper C Subscript p Baseline Over upper C 0 plus 2 upper C Subscript p Baseline EndFraction one half v Subscript upper L r
StartFraction n Subscript c Baseline plus 1 Over n Subscript c Baseline EndFraction left parenthesis upper C 0 plus 2 upper C Subscript p Baseline right parenthesis
St
a
rtF racti
on n Subscript c Baseline plus 1 Over n Subscript c Baseline EndFraction left parenthesis upper C 0 plus 2 upper C Subscript p Baseline right parenthesis
S_11
0
StartFraction n Subscript c Baseline plus 1 Over n Subscript c Baseline EndFraction left parenthesis upper C 0 plus 2 upper C Subscript p Baseline right parenthesis
St
a
rtF racti
on n Subscript c Baseline plus 1 Over n Subscript c Baseline EndFraction left parenthesis upper C 0 plus 2 upper C Subscript p Baseline right parenthesis

8.4 The Necessity of Combining Two Methods
159
St artAbsol u
te V
alue
 Modif yingA bove upper V With dot Subscript CM Baseline left parenthesis f right parenthesis EndAbsoluteValue equals StartAbsoluteValue StartFraction j Baseline 2 normal pi f dot 25 dot upper C Subscript upper S Baseline Over j Baseline 2 normal pi f dot 25 dot upper C Subscript upper S Baseline plus 1 EndFraction EndAbsoluteValue dot StartAbsoluteValue ModifyingAbove upper V With dot Subscript upper S Baseline left parenthesis f right parenthesis EndAbsoluteValue
StartA bsolu teVal ue 
Modi f
yi ngAbove  
up
per V With dot Subscript CM Baseline left parenthesis f right parenthesis EndAbsoluteValue equals StartAbsoluteValue StartFraction j Baseline 2 normal pi f dot 25 dot upper C Subscript upper S Baseline Over j Baseline 2 normal pi f dot 25 dot upper C Subscript upper S Baseline plus 1 EndFraction EndAbsoluteValue dot StartAbsoluteValue ModifyingAbove upper V With dot Subscript upper S Baseline left parenthesis f right parenthesis EndAbsoluteValue
In Fig. 8.12, the 25-Ω resistor and CS form a high-pass ﬁlter with corner frequency 
f c of 1/(2π · 25 ·  CS). Generally, CS is around hundreds of pF, and thus f c is around 
tens of MHz. Therefore, at the frequencies below tens of MHz, (2πf · 25 ·  CS) ≪1, 
and thus (8.27) can be approximated as
St artAbsol u
te Value Mo difyi ngAbove
 u pper V W
it
h dot Subscript CM Baseline left parenthesis f right parenthesis EndAbsoluteValue almost equals StartAbsoluteValue 2 pi f dot 25 dot upper C Subscript upper S Baseline EndAbsoluteValue dot StartAbsoluteValue ModifyingAbove upper V With dot Subscript upper S Baseline left parenthesis f right parenthesis EndAbsoluteValue
8.4.1 
Solution with Only Symmetrical Resonant Inductor 
As seen in Table 8.2, for the solutions S_00 and S_10, CS_00 and CS_10 are equal, so 
the difference of the CM noises depends on the spectra difference between vS_00 and 
vS_10, and the spectra of (vA + vB) and vLr are studied. The waveforms of (vA + vB) 
and vLr are plotted in Fig. 8.1b. By expanding (vA + vB) and vLr within [0, T s] into  
Fourier Series, we have 
S
ta
rt
Lay out E nlarge d  le
ft brace 1s
tVRow v Subscript upper A Baseline plus v Subscript upper B Baseline equals upper V Subscript in Baseline plus sigma summation Underscript k equals 1 comma 3 comma 5 ellipsis Overscript normal infinity Endscripts StartFraction 4 upper V Subscript in Baseline Over k pi EndFraction sine left parenthesis StartFraction k phi Over 2 EndFraction right parenthesis cosine left parenthesis k omega Subscript s Baseline t plus StartFraction k phi Over 2 EndFraction right parenthesis 2nd Row v Subscript upper L r Baseline equals sigma summation Underscript k equals 1 comma 3 comma 5 ellipsis Overscript normal infinity Endscripts StartFraction 4 upper V Subscript in Baseline Over k pi EndFraction sine left parenthesis StartFraction k psi Over 2 EndFraction right parenthesis cosine left parenthesis k omega Subscript s Baseline t minus StartFraction k psi Over 2 EndFraction right parenthesis EndLayout
Sta rtL
a
yout Enlarged left brace 1st Row v Subscript upper A Baseline plus v Subscript upper B Baseline equals upper V Subscript in Baseline plus sigma summation Underscript k equals 1 comma 3 comma 5 ellipsis Overscript normal infinity Endscripts StartFraction 4 upper V Subscript in Baseline Over k pi EndFraction sine left parenthesis StartFraction k phi Over 2 EndFraction right parenthesis cosine left parenthesis k omega Subscript s Baseline t plus StartFraction k phi Over 2 EndFraction right parenthesis 2nd Row v Subscript upper L r Baseline equals sigma summation Underscript k equals 1 comma 3 comma 5 ellipsis Overscript normal infinity Endscripts StartFraction 4 upper V Subscript in Baseline Over k pi EndFraction sine left parenthesis StartFraction k psi Over 2 EndFraction right parenthesis cosine left parenthesis k omega Subscript s Baseline t minus StartFraction k psi Over 2 EndFraction right parenthesis EndLayout
S
t
art
L
ayout  Enlarged left brace 1st Row v Subscript upper A Baseline plus v Subscript upper B Baseline equals upper V Subscript in Baseline plus sigma summation Underscript k equals 1 comma 3 comma 5 ellipsis Overscript normal infinity Endscripts StartFraction 4 upper V Subscript in Baseline Over k pi EndFraction sine left parenthesis StartFraction k phi Over 2 EndFraction right parenthesis cosine left parenthesis k omega Subscript s Baseline t plus StartFraction k phi Over 2 EndFraction right parenthesis 2nd Row v Subscript upper L r Baseline equals sigma summation Underscript k equals 1 comma 3 comma 5 ellipsis Overscript normal infinity Endscripts StartFraction 4 upper V Subscript in Baseline Over k pi EndFraction sine left parenthesis StartFraction k psi Over 2 EndFraction right parenthesis cosine left parenthesis k omega Subscript s Baseline t minus StartFraction k psi Over 2 EndFraction right parenthesis EndLayout
S
t
artL a you
t Enlarged 
left brace 1st Row v Subscript upper A Baseline plus v Subscript upper B Baseline equals upper V Subscript in Baseline plus sigma summation Underscript k equals 1 comma 3 comma 5 ellipsis Overscript normal infinity Endscripts StartFraction 4 upper V Subscript in Baseline Over k pi EndFraction sine left parenthesis StartFraction k phi Over 2 EndFraction right parenthesis cosine left parenthesis k omega Subscript s Baseline t plus StartFraction k phi Over 2 EndFraction right parenthesis 2nd Row v Subscript upper L r Baseline equals sigma summation Underscript k equals 1 comma 3 comma 5 ellipsis Overscript normal infinity Endscripts StartFraction 4 upper V Subscript in Baseline Over k pi EndFraction sine left parenthesis StartFraction k psi Over 2 EndFraction right parenthesis cosine left parenthesis k omega Subscript s Baseline t minus StartFraction k psi Over 2 EndFraction right parenthesis EndLayout
Sta rtL
a
yout Enlarged left brace 1st Row v Subscript upper A Baseline plus v Subscript upper B Baseline equals upper V Subscript in Baseline plus sigma summation Underscript k equals 1 comma 3 comma 5 ellipsis Overscript normal infinity Endscripts StartFraction 4 upper V Subscript in Baseline Over k pi EndFraction sine left parenthesis StartFraction k phi Over 2 EndFraction right parenthesis cosine left parenthesis k omega Subscript s Baseline t plus StartFraction k phi Over 2 EndFraction right parenthesis 2nd Row v Subscript upper L r Baseline equals sigma summation Underscript k equals 1 comma 3 comma 5 ellipsis Overscript normal infinity Endscripts StartFraction 4 upper V Subscript in Baseline Over k pi EndFraction sine left parenthesis StartFraction k psi Over 2 EndFraction right parenthesis cosine left parenthesis k omega Subscript s Baseline t minus StartFraction k psi Over 2 EndFraction right parenthesis EndLayout
S
t
art
L
ayout  Enlarged left brace 1st Row v Subscript upper A Baseline plus v Subscript upper B Baseline equals upper V Subscript in Baseline plus sigma summation Underscript k equals 1 comma 3 comma 5 ellipsis Overscript normal infinity Endscripts StartFraction 4 upper V Subscript in Baseline Over k pi EndFraction sine left parenthesis StartFraction k phi Over 2 EndFraction right parenthesis cosine left parenthesis k omega Subscript s Baseline t plus StartFraction k phi Over 2 EndFraction right parenthesis 2nd Row v Subscript upper L r Baseline equals sigma summation Underscript k equals 1 comma 3 comma 5 ellipsis Overscript normal infinity Endscripts StartFraction 4 upper V Subscript in Baseline Over k pi EndFraction sine left parenthesis StartFraction k psi Over 2 EndFraction right parenthesis cosine left parenthesis k omega Subscript s Baseline t minus StartFraction k psi Over 2 EndFraction right parenthesis EndLayout
S
t
artLayout Enlarged left brace 1st Row v Subscript upper A Baseline plus v Subscript upper B Baseline equals upper V Subscript in Baseline plus sigma summation Underscript k equals 1 comma 3 comma 5 ellipsis Overscript normal infinity Endscripts StartFraction 4 upper V Subscript in Baseline Over k pi EndFraction sine left parenthesis StartFraction k phi Over 2 EndFraction right parenthesis cosine left parenthesis k omega Subscript s Baseline t plus StartFraction k phi Over 2 EndFraction right parenthesis 2nd Row v Subscript upper L r Baseline equals sigma summation Underscript k equals 1 comma 3 comma 5 ellipsis Overscript normal infinity Endscripts StartFraction 4 upper V Subscript in Baseline Over k pi EndFraction sine left parenthesis StartFraction k psi Over 2 EndFraction right parenthesis cosine left parenthesis k omega Subscript s Baseline t minus StartFraction k psi Over 2 EndFraction right parenthesis EndLayout
where, k is the harmonic order, ϕ and ψ are deﬁned as 
phi equals 2 pi lef
t parenthesis t 3 minus t 2 right parenthesis divided by upper T Subscript s
psi equals 2 pi lef
t parenthesis t 4 minus t 3 right parenthesis divided by upper T Subscript s
To analyze the inﬂuence of vLr on the CM noise, Fig. 8.13 gives the phasor 
diagrams of the ENS with solutions S_00 and S_10, where the angle θ = k(ϕ + ψ)/ 
2 according to (8.29). As seen in Fig. 8.13a, when θ is an obtuse angle, eliminating 
vLr leads to the reduction of the CM noise, while as seen in Fig. 8.13b, when θ is an 
acute angle, eliminating vLr may lead to the increase of CM noise. This implies that 
the solution with only the symmetry circuit is not effective to reduce the CM noise.
8.4.2 
Solution with Only Passive Cancellation Circuit 
For the solutions S_00 and S_01, substitution of CS_00, CS_01, vS_00 and vS_01 in Table 
II into (8.28), yields

160
8
Reducing the Common-Mode Noise in Phase-Shifted Full-Bridge …
θ 
0 
VS_10 
VS_00 
θ 
VLr 
p 
0
p
 
2
1 
2
2
 
C 
C
C
+ 
VLr 
0 
0
p
 
1 
2
2
 
C 
C
C
+ 
θ
0
VS_10 
VS_00 
θ 
VLr 
p 
0
p
 
2
1 
2
2
 
C 
C
C
+
VLr 
0 
0
p
 
1 
2
2
 
C 
C
C
+ 
(a) θ is an obtuse angle                  (b) θ is an acute angle 
Fig. 8.13 Phasor diagrams of the ENS with solutions S_00, S_10 and S_01
St artFraction  
StartAbsoluteValue ModifyingAbove upper V With dot Subscript CM normal bar 01 Baseline left parenthesis f right parenthesis EndAbsoluteValue Over StartAbsoluteValue ModifyingAbove upper V With dot Subscript CM normal bar 00 Baseline left parenthesis f right parenthesis EndAbsoluteValue EndFraction equals StartStartFraction StartAbsoluteValue one half StartFraction 2 upper C Subscript p Baseline Over upper C 0 plus 2 upper C Subscript p Baseline EndFraction ModifyingAbove upper V With dot Subscript upper L r Baseline left parenthesis f right parenthesis EndAbsoluteValue OverOver StartAbsoluteValue ModifyingAbove upper V With dot Subscript upper S normal bar 00 Baseline left parenthesis f right parenthesis EndAbsoluteValue EndEndFraction
St artFraction  
St a
rtA bsoluteValue ModifyingAbove upper V With dot Subscript CM normal bar 01 Baseline left parenthesis f right parenthesis EndAbsoluteValue Over StartAbsoluteValue ModifyingAbove upper V With dot Subscript CM normal bar 00 Baseline left parenthesis f right parenthesis EndAbsoluteValue EndFraction equals StartStartFraction StartAbsoluteValue one half StartFraction 2 upper C Subscript p Baseline Over upper C 0 plus 2 upper C Subscript p Baseline EndFraction ModifyingAbove upper V With dot Subscript upper L r Baseline left parenthesis f right parenthesis EndAbsoluteValue OverOver StartAbsoluteValue ModifyingAbove upper V With dot Subscript upper S normal bar 00 Baseline left parenthesis f right parenthesis EndAbsoluteValue EndEndFraction
St
artFraction StartAbsoluteValue ModifyingAbove upper V With dot Subscript CM normal bar 01 Baseline left parenthesis f right parenthesis EndAbsoluteValue Over StartAbsoluteValue ModifyingAbove upper V With dot Subscript CM normal bar 00 Baseline left parenthesis f right parenthesis EndAbsoluteValue EndFraction equals StartStartFraction StartAbsoluteValue one half StartFraction 2 upper C Subscript p Baseline Over upper C 0 plus 2 upper C Subscript p Baseline EndFraction ModifyingAbove upper V With dot Subscript upper L r Baseline left parenthesis f right parenthesis EndAbsoluteValue OverOver StartAbsoluteValue ModifyingAbove upper V With dot Subscript upper S normal bar 00 Baseline left parenthesis f right parenthesis EndAbsoluteValue EndEndFraction
Startpr action S t
artAbsoluteValue ModifyingAbove upper V With dot Subscript CM normal bar 01 Baseline left parenthesis f right parenthesis EndAbsoluteValue Over StartAbsoluteValue ModifyingAbove upper V With dot Subscript CM normal bar 00 Baseline left parenthesis f right parenthesis EndAbsoluteValue EndFraction equals StartStartFraction StartAbsoluteValue one half StartFraction 2 upper C Subscript p Baseline Over upper C 0 plus 2 upper C Subscript p Baseline EndFraction ModifyingAbove upper V With dot Subscript upper L r Baseline left parenthesis f right parenthesis EndAbsoluteValue OverOver StartAbsoluteValue ModifyingAbove upper V With dot Subscript upper S normal bar 00 Baseline left parenthesis f right parenthesis EndAbsoluteValue EndEndFraction
St artFractio n
 S
tartAbsoluteValue ModifyingAbove upper V With dot Subscript CM normal bar 01 Baseline left parenthesis f right parenthesis EndAbsoluteValue Over StartAbsoluteValue ModifyingAbove upper V With dot Subscript CM normal bar 00 Baseline left parenthesis f right parenthesis EndAbsoluteValue EndFraction equals StartStartFraction StartAbsoluteValue one half StartFraction 2 upper C Subscript p Baseline Over upper C 0 plus 2 upper C Subscript p Baseline EndFraction ModifyingAbove upper V With dot Subscript upper L r Baseline left parenthesis f right parenthesis EndAbsoluteValue OverOver StartAbsoluteValue ModifyingAbove upper V With dot Subscript upper S normal bar 00 Baseline left parenthesis f right parenthesis EndAbsoluteValue EndEndFraction
The phasor of one half StartFraction 2 upper C Subscript p Baseline Over upper C 0 plus 2 upper C Subscript p Baseline EndFraction ModifyingAbove upper V With dot Subscript upper L r
on
e half StartFraction 2 upper C Subscript p Baseline Over upper C 0 plus 2 upper C Subscript p Baseline EndFraction ModifyingAbove upper V With dot Subscript upper L r
one hal fVStartFraction 2 upper C Subscript p Baseline Over upper C 0 plus 2 upper C Subscript p Baseline EndFraction ModifyingAbove upper V With dot Subscript upper L r is also given in Fig. 8.13. Note that a planar transformer 
has large inter-winding capacitance, so C0 is usually much larger than Cp, and the 
magnitude of phasor one half StartFraction 2 upper C Subscript p Baseline Over upper C 0 plus 2 upper C Subscript p Baseline EndFraction ModifyingAbove upper V With dot Subscript upper L r
on
e half StartFraction 2 upper C Subscript p Baseline Over upper C 0 plus 2 upper C Subscript p Baseline EndFraction ModifyingAbove upper V With dot Subscript upper L r
one hal fVStartFraction 2 upper C Subscript p Baseline Over upper C 0 plus 2 upper C Subscript p Baseline EndFraction ModifyingAbove upper V With dot Subscript upper L r will be relatively small than that of one half StartFraction upper C 0 Over upper C 0 plus 2 upper C Subscript p Baseline EndFraction ModifyingAbove upper V With dot Subscript upper L r
on
e half StartFraction upper C 0 Over upper C 0 plus 2 upper C Subscript p Baseline EndFraction ModifyingAbove upper V With dot Subscript upper L r
one hal fVStartFraction upper C 0 Over upper C 0 plus 2 upper C Subscript p Baseline EndFraction ModifyingAbove upper V With dot Subscript upper L r. 
So, with only the passive cancellation circuit, the CM noise can be reduced. 
According to the above discussion, it can be concluded that the solution with only 
the symmetry circuit will not be effective to reduce the CM noise, while the solution 
with only passive cancellation circuit can reduce the CM noise. Furthermore, when 
the symmetry circuit and the passive cancellation circuit are combined, the CM noise 
of the PSFB can be effectively reduced. 
8.5 
Experimental Veriﬁcation 
8.5.1 
Descriptions of the Prototype 
In order to verify the proposed methods for cancelling the CM noise, a PSFB converter 
prototype is fabricated and tested in the lab, as shown in Fig. 8.14. The main circuit 
parameters are listed in Table 8.3. A 2.5-μF DC blocking capacitor Cblock is connected 
in series with the primary winding to avoid the saturation of transformer, which can 
be treated as short circuit owing to its far smaller dv/dt than vA, vB and vLr.
The power transformer uses PQI 50/33 ferrite core. The transformer winding 
structure has been shown in Fig. 8.7b, and the corresponding parameters are listed 
in Table 8.4. The primary windings Pri1 and Pri2 are both tightly wound layers with 
the same turns. The same type of insulation materials with the same thickness are 
inserted between Pri1 and Sec1-1 and between Pri2 and Sec2-2, and thus C01 and 
C02 are nearly the same. As seen in Fig. 8.7b, the power transformer is a symmet-
rical transformer, and it is used throughout the experiments. Besides, the parasitic

8.5 Experimental Veriﬁcation
161
Fig. 8.14 Photograph of the 
prototype 
Co 
Tc 
Tr
Lr 
Q1~Q4
Lf
DR1, DR2 
Control 
circuit 
Main 
circuit 
Table 8.3 Main circuit parameters of the PSFB converter 
Input voltage Vin
380 V
Resonant inductance Lr
30 μH 
Output voltage Vo
48 V
Input capacitance Cin
2.5 μF 
Output power Po
1 kW
Output ﬁlter inductor Lf
13 μH 
Switching frequency f s
100 kHz
Output ﬁlter capacitor Co
2400 μF 
Transformer turns ratio n
1/6
DC blocking capacitor Cblock
2.5 μF
capacitances between two phase-leg midpoints and the heat sink are nearly the same. 
The measured capacitances are: C01 = C02 = 50 pF; Cp = CpA = CpB = 36 pF 
(the parasitic capacitance from the phase-leg midpoints to the heat sink is 24 pF, and 
the inter-winding capacitance of the driving transformer which connects the main 
switches and the SG is 12 pF). 
PQ 26/20 ferrite core and 0.1 mm × 140 Litz wire are adopted for both the asym-
metrical and symmetrical resonant inductor. The asymmetrical resonant inductor 
uses one winding with 8 turns, while the symmetrical resonant inductor uses two 
windings, and each winding has 4 turns. The implementation II shown in Fig. 8.11 
is used for realizing the passive cancellation circuit. For the transformer T c, single 
strand enameled wire is adopted for the windings. The primary and secondary wind-
ings are wound side by side in each layer to reduce the leakage inductance. The 
parameters of T c are listed in Table 8.5. The DC blocking capacitor Cb is 2 μF, and 
the compensation capacitance Ccom is 176 pF.
Table 8.4 Parameters of the power transformer 
Wire
Winding dimension
Turns 
Primary winding ab
Litz wire
0.1 mm × 140
Pri1: 6 
Pri2: 6 
Secondary winding cd
PCB winding
4 oz, 9.75 mm
4 

162
8
Reducing the Common-Mode Noise in Phase-Shifted Full-Bridge …
Table 8.5 Parameters of the sensing transformer Tc 
Implementation
Measured parameters 
Core
EP 13
Magnetizing inductance
3.9 mH 
Winding dimension
0.25 mm
Leakage inductance
0.38 μH 
Turns ratio
52:52
Structural capacitance
198 pF 
Time: [2µs/div] 
vAB: [400V/div] 
iLr: [5A/div] 
vM: [200V/div] 
vcom: [200V/div] 
Time: [2µs/div] 
vAB: [400V/div] 
iLr: [5A/div] 
vM: [200V/div] 
vcom: [200V/div] 
(a) With symmetrical resonant inductor 
(b) With asymmetrical resonant inductor 
Fig. 8.15 Voltage waveforms of nodes M and C with respect to the PG 
8.5.2 
Measurement and Comparison of the CM Noise 
Figure 8.15 shows the measured waveforms of the PSFB converter at full load with 
the passive cancellation circuit. It can be observed that vM and vcom are out-of-phase. 
In Fig. 8.15a, vM equals to (vA + vB)/2 when using the symmetrical resonant inductor. 
In Fig. 8.15b, vM equals to (vA + vB – vLr)/2 when adopting the asymmetrical resonant 
inductor. 
Figure 8.16 shows the key experimental waveforms of the PSFB converter with 
the solutions listed in Table 8.1. The CM noise voltage vCM is measured with an 
oscilloscope which uses 50-Ω input impedances.
As seen in Fig. 8.16, an impulse is presented in vCM when the voltages of the 
midpoints A and B have step change at t1 and t2, respectively. When the reso-
nant inductor voltage has step change at t3, an impulse occurs in vCM, as shown  in  
Fig. 8.16a, c, while no impulse is observed in vCM, as shown in Fig. 8.16b, d. This 
implies that when the symmetrical resonant inductor and symmetrical transformer 
are both adopted, the inﬂuence of the resonant inductor voltage on CM noise is 
eliminated. 
Figure 8.17 shows the simulated and measured spectra for the CM noise of the 
PSFB converter at full load with different solutions. Here, the simulated spectra 
for the CM noise is represented by the CM noise envelope, which is obtained by 
connecting every two adjacent noise peaks in the simulated spectra with a straight 
line, for the purpose of avoiding the overlap between the simulated and measured 
results and offering a clear comparison. As seen, from 150 kHz to 1 MHz, the 
measured and simulated results are well matched; while at higher frequencies,

8.5 Experimental Veriﬁcation
163
vAB: [400V/div] 
vCM: [5V/div] 
vLr: [400V/div] 
iLr :[5A/div] 
Time: [2µs/div]
t1 t2 t3 
vAB: [400V/div] 
vCM: [5V/div] 
vLr: [400V/div] 
iLr: [5A/div] 
Time: [2µs/div]
t1 t2 t3 
(a) With solution S_00
(b) With solution S_10 
vAB: [400V/div] 
vCM: [5V/div] 
vLr: [400V/div] 
iLr: [5A/div] 
Time: [2µs/div]
t1 t2 t3 
vAB: [400V/div] 
vCM: [5V/div] 
vLr: [400V/div] 
iLr: [5A/div] 
Time: [2µs/div]
t1 t2 t3 
(c) With solution S_01
(d) With solution S_11 
Fig. 8.16 Key waveforms of PSFB converter and the measured CM noise voltage
there are differences between these spectra, due to some parasitic elements that 
are neglected in the model. It should be noted that the simulated result is lower than 
the measured spectra in Fig. 8.17d, because the related parasitic capacitances are not 
exactly matched in the experiment, degrading the practical CM noise reduction.
Figure 8.18 shows the comparison of the measured CM noises with different 
solutions. In Fig. 8.18a, the CM noise of the solution S_10, which only uses the 
symmetrical resonant inductor, is given and compared with the original CM noise (S_ 
00). As seen, the spectra difference varies with the frequency. Although the resonant 
inductor voltage is eliminated by the symmetrical resonant inductor, the CM noise 
is lower than the original one at some frequencies, and it is even higher than the 
original one at other frequencies. This means the solution with only the symmetrical 
resonant inductor can not effectively reduce the CM noise, which is in agreement 
with the analysis in Sect. 8.4.
In Fig. 8.18b, the CM noise of the solution S_01, which only adopts the passive 
cancellation circuit, is given together with the original one. As seen, with only the 
passive cancellation circuit, the CM noise is reduced by several dB at the frequencies 
below 1 MHz, which is in agreement with the analysis in Sect. 8.4. 
Figure 8.18c illustrates the measured CM noise of the solution S_11, which is the 
combined solution with both the symmetrical resonant inductor and passive cancel-
lation circuit. Meanwhile, the original CM noise is also given for comparison. As

164
8
Reducing the Common-Mode Noise in Phase-Shifted Full-Bridge …
80 
130 
100 
40 
1M
10M
30M
150k 
120 
60
Simulation 
Measurement 
S_00 
f (Hz) 
CM noise (dBμV) 
80 
130 
100 
40 
1M
10M
30M
150k 
120 
60 
S_10 
Simulation 
Measurement 
f (Hz) 
CM noise (dBμV) 
(a) With solution S_00            
(b) With solution S_10 
80 
130 
100 
40 
1M
10M
30M
150k 
120 
60 
S_01 
Simulation 
Measurement 
f (Hz) 
CM noise (dBμV) 
80 
130 
100 
40 
1M
10M
30M
150k 
120 
60 
S_11 
Simulation 
Measurement 
f (Hz) 
CM noise (dBμV) 
(c) With solution 
(d) With solution S_11 
Fig. 8.17 Comparison of the simulated and measured CM noise of PSFB converter
seen, the CM noise is signiﬁcantly reduced by the combined method. From 150 kHz 
to 3 MHz, the CM noise is reduced by 20 dB; from 3 to 10 MHz, the amount of noise 
reduction decreases with the increasing of frequency; from 10 to 30 MHz, the noise 
reduction is not so effective. This is due to the increased winding resistance of T c at 
high frequency, which limits the compensation current and reduces the effectiveness 
of cancellation. 
Figure 8.18d gives the measured CM noises of the solutions S_10, S_01 and S_11. 
As seen, the combined solution achieves the best CM noise reduction. This veriﬁes 
the necessity of combining the symmetry circuit and passive cancellation circuit in 
Sect. 8.4. 
8.6 
Summary 
In this chapter, the CM noise model for the PSFB converter is derived, where, the 
noise voltage sources include the voltages between two phase-leg midpoints and the 
PG, and the resonant inductor voltage. To reduce the CM noise, the symmetrical 
resonant inductor and symmetrical transformer is proposed, which eliminates the 
effect of resonant inductor voltage on the CM noise. Then, a passive cancellation

References
165
80 
130 
100 
40 
1M
10M 30M
150k 
120 
60
S_00 
S_10 
f (Hz) 
CM noise (dBµV) 
80 
130 
100 
40 
1M
10M 30M
150k 
120 
60
S_00 
S_01 
f (Hz) 
CM noise (dBµV) 
(a) S_00 and S_10
(b) S_00 and S_01 
80 
130 
100 
40 
1M
10M
30M
150k 
120 
60
S_00 
S_11 
f (Hz) 
CM noise (dBµV) 
80 
130 
100 
40 
1M
10M 30M
150k 
120 
60 
S_10 
S_01 
S_11 
f (Hz) 
CM noise (dBµV) 
(c) S_00 and S_11
(d) S_10, S_01 and S_11 
Fig. 8.18 The comparison of measured CM noises of the PSFB converter
circuit consisting of a compensation voltage source and a compensation capacitor 
is introduced, which eliminates the effect of the voltages between the two phase-leg 
midpoints and the PG. A 1-kW prototype of the PSFB converter is fabricated in 
the lab, and the CM noise reduction by the symmetrical circuit, passive cancellation 
circuit and the combined solution are examined, respectively. The measured CM 
noise demonstrates that both the symmetrical circuit and passive cancellation are 
necessary for achieving signiﬁcant CM noise reduction. 
References 
1. Y. Chu, S. Wang, A generalized common mode current cancellation approach for power 
converters. IEEE Trans. Industr. Electron. 62(7), 4130–4140 (2015) 
2. H. Zhang, S. Wang, Y. Li, Q. Wang, D. Fu, Two-capacitor transformer winding capacitance 
models for common-mode EMI noise analysis in isolated dc−dc converters. IEEE Trans. Power 
Electron. 32(11), 8458–8469 (2017) 
3. J. He, W. Chen, and J. Jiang, Model and analysis on common-mode conducted EMI of a switched 
mode power supply, in Proceedings of the Chinese Society for Electrical Engineering (CSEE), 
vol. 25, no. 8, pp. 50–55, 2005 (in Chinese)

166
8
Reducing the Common-Mode Noise in Phase-Shifted Full-Bridge …
4. P. Kong, S. Wang, F.C. Lee, Reducing common-mode noise in two-switch forward converter. 
IEEE Trans. Power Electron. 26(5), 1522–1533 (2011) 
5. D. Cochrane, D.-Y. Chen, D. Boroyevic, Passive cancellation of common-mode noise in power 
electronic circuits. IEEE Trans. Power Electron. 18(3), 756–763 (2003)

Chapter 9 
Reducing the Common-Mode (CM) 
Noise in DC-DC Converters by the CM 
Voltage Cancellation Method 
9.1 
The Common-Mode Voltage Cancellation Method 
In Chap. 6, the common-mode (CM) noise equivalent circuit of DC-DC converters is 
derived, as shown in Fig. 9.1a, where vENS is the equivalent noise source (ENS), Csum 
is the total parasitic capacitance, and the 25-Ω resistor is the equivalent impedance 
for the CM noise at the line impedance stabilization network (LISN) side [1]. For the 
passive cancellation method [2], the cancellation branch consisting of a compensation 
voltage vcom and a compensation capacitor Ccom is in parallel with the converter, as 
shown in Fig. 9.1b, which cancels the current that generates the CM noise in the 
converter.
According to the duality, a compensation voltage vcom can be inserted and 
connected in series with vENS, as shown in Fig. 9.1c. If vcom = vENS, then vCM is zero, 
and the CM noise is eliminated. This method reduces the CM noise by cancelling the 
CM voltage of DC-DC converters, and it is identiﬁed as the CM voltage cancellation 
(CMVC) method. The CMVC method is similar with the CM transformer approach 
that eliminates the leakage current in motor drive systems [3]. 
For implementing the CMVC method, the key is how to obtain the CM voltage. 
In a DC-DC converter, vENS is generally expressed as [1] 
v Sub sc ript
 ENS Baseline equals k Subscript upper C Baseline v Subscript upper Q
where, kC is the ratio related with the parasitic capacitances that affects the CM 
noise, and vQ is the noise voltage source, which is the drain-to-source voltage of 
power switch. 
In general, the voltage vmag across the magnetic component have the same AC 
component as vQ [2], i.e., 
v S ub scri
pt upper Q Baseline equals v Subscript mag
© The Author(s), under exclusive license to Springer Nature Singapore Pte Ltd. 2024 
X. Ruan et al., Conducted Electromagnetic Interference in Power Converters: Modeling, 
Prediction and Reduction, CPSS Power Electronics Series, 
https://doi.org/10.1007/978-981-99-9295-9_9 
167

168
9
Reducing the Common-Mode (CM) Noise in DC-DC Converters …
25Ω 
vCM 
in 
Csum 
vENS 
25Ω 
vCM 
Csum 
vENS 
Ccom 
vcom 
icom
in 
25Ω 
vCM 
Csum 
vENS 
vcom
in 
(a) CM noise equivalent circuit  (b) CM current cancellation (c) CM voltage cancellation 
Fig. 9.1 Principles of the CM noise cancellation method
As seen from Fig. 9.1c, for achieving the CMVC, the compensation voltage source 
vcom is required to be equal to vENS. Referring to (9.1) and (9.2), we have 
v Sub sc ript c
om Baseline equals k Subscript upper C Baseline v Subscript mag
According to (9.3), vcom can be obtained by adding auxiliary windings into the 
magnetic component (it could be an inductor or a transformer), as shown in Fig. 9.2a. 
Based on Fig.  9.2a, the compensation voltage kvmag are added into both the input 
power cords in a DC-DC converter, as shown in Fig. 9.2b, where, the windings AB 
and CD are the CMVC windings, and their turns NAB and NCD are both equal to 
kCNPQ, and NPQ is the turns of the winding with voltage of vmag. By neglecting 
the leakage inductance between AB and CD, vAB is equal to vCD. Obviously, the 
added CMVC windings do not affect the normal operation of the power converter. In 
addition, by placing the input ﬁltering capacitor Cin between the CMVC windings 
and the power converter, the current ﬂowing through the CMVC winding is almost 
a DC current, minimizing the size and losses of the CMVC windings.
25Ω 
vCM 
Cp 
kCvmag
Converter 
vmag 
vcom 
Vin 
Cp 
PE 
LISN 
50μH 
50μH 
1μF 
0.1μF 
50Ω 
1μF 
50Ω 
0.1μF 
kCvmag 
Converter 
vmag 
C
D
 
A
B
 
Cin
kCvmag 
P
Q
 
NAB=NCD=kNPQ 
(a) Principle of the CMVC method            (b) Realization of the CMVC method 
Fig. 9.2 Principle and realization of the CMVC method 

9.2 Application of the CMVC Method in Non-isolated DC-DC Converters
169
9.2 
Application of the CMVC Method in Non-isolated 
DC-DC Converters 
In this Section, the application of the CMVC method in buck converter is ﬁrst studied. 
Figure 9.3a shows the buck converter with the CM parasitic capacitances, where, Cp1 
is the parasitic capacitance between the switching node and the PE, Cp2, Cp3 and Cp4 
are the parasitic capacitances between the positive terminal of the output voltage, 
power ground, drain of power switch Q and the PE, respectively. 
The equivalent CM noise circuit is derived with the substitution theorem. Note 
that, when applying the substitution theorem, voltage loops or current nodes should 
be avoided. Firstly, the freewheeling diode DFW is replaced by the voltage source 
vDFW with its own waveform, owing to the high dv/dt node M that causes the CM 
noise. Then, the output capacitor is treated as short circuit because its dv/dt is far 
lower than that of vDFW. To avoid voltage loops, power switch Q and the output ﬁlter 
inductor Lf are substituted by current sources with their own waveform, respectively. 
Finally, by considering the 25-Ω equivalent resistor from the LISN side, the CM 
noise equivalent circuit is derived, as shown in Fig. 9.3b. 
To derive the ENS, the equivalent circuit shown in Fig. 9.3b is further simpliﬁed 
with the superposition theorem. Firstly, the voltage source vDFW is shorted to solely 
analyze the effect of the current sources. Because all the current sources are essen-
tially shorted, they have no effect on the CM noise. Secondly, by opening all current 
sources, the excitation of vDFW is individually applied to the circuit. By adopting the 
Thevenin’s equivalent circuit method, the simpliﬁed CM noise circuit is derived, as 
shown in Fig. 9.3c, where 
upper  C  Sub sc ript  s um B as eli
ne equals upper C Subscript p 1 Baseline plus upper C Subscript p 2 Baseline plus upper C Subscript p 3 Baseline plus upper C Subscript p 4
k Subs c
ript buck Baseline equals StartFraction upper C Subscript p 1 Baseline Over upper C Subscript p 1 Baseline plus upper C Subscript p 2 Baseline plus upper C Subscript p 3 Baseline plus upper C Subscript p 4 Baseline EndFraction equals StartFraction upper C Subscript p 1 Baseline Over upper C Subscript sum Baseline EndFraction
k Su bs crip t buck  B asel
in e equals StartFraction upper C Subscript p 1 Baseline Over upper C Subscript p 1 Baseline plus upper C Subscript p 2 Baseline plus upper C Subscript p 3 Baseline plus upper C Subscript p 4 Baseline EndFraction equals StartFraction upper C Subscript p 1 Baseline Over upper C Subscript sum Baseline EndFraction
k Sub
script buck Baseline equals StartFraction upper C Subscript p 1 Baseline Over upper C Subscript p 1 Baseline plus upper C Subscript p 2 Baseline plus upper C Subscript p 3 Baseline plus upper C Subscript p 4 Baseline EndFraction equals StartFraction upper C Subscript p 1 Baseline Over upper C Subscript sum Baseline EndFraction
Referring to Fig. 9.3a, vDFW and vLf have the same AC components, so the ENS 
can be also expressed as kbuckvLf. Referring to Figs. 9.2b and 9.4 shows the buck
Q 
Df
Vin
Co 
Lf
Cp1
Cp2 
Cp3 
M 
vDFW 
vLf 
Cp4 
Vo 
PE 
RLd 
iQ 
vDFW 
iLf 
25Ω 
Cp1
Cp2 
Cp3 
Cp4 
PE 
kbuckvDFW 
Csum 
25Ω 
PE 
(a) Buck converter
(b) CM noise model
 (c) Simplified circuit 
Fig. 9.3 Buck converter and its CM noise model 

170
9
Reducing the Common-Mode (CM) Noise in DC-DC Converters …
Q 
DFW 
Vin
Co 
Lf 
B
A 
D
C 
NAB=NCD=kbuckNLf 
Cp1
Cp2 
Cp3 
Cp4 
PE 
RLd 
Fig. 9.4 Buck converter with the CMVC method 
converter adopting the CMVC method. The turns of the CMVC windings AB and 
CD are both equal to kbuckNLf, where NLf is the turns of the winding for Lf. 
Following the procedure for applying the CMVC method in buck converter, 
Fig. 9.5a shows the boost converter with the CMVC method. The ENS of boost 
converter is kbstvQ, where kbst = Cp1/(Cp1 + Cp2 + Cp3), vQ is the drain-source 
voltage of Q. The turns of the CMVC winding AB and CD are equal to kbstNLb, 
where NLb is the turns of Lb. 
As seen from Fig. 9.5a, the right-side node of Lb and node A of winding AB are 
dotted terminals, so the windings of Lb and AB can be combined into one winding 
with total turns of (1–kbst)NLb, as shown in Fig. 9.5b. This circuit has been proposed in 
[4] by adopting the CM noise balancing. The upside and downside coupled inductors 
are essentially in series, and their total turns is equal to the turns of the original 
inductor Lb, implying that this method does not increase the size of boost inductor. 
Figure 9.6 gives the applications of CMVC method in other basic non-isolated 
DC-DC converters. For the buck-boost converter, the turns ratio kbb of the CMVC 
winding and the winding of Lf is Cp1/(Cp + Cp2 + Cp3 + Cp4); for the Cuk and 
SEPIC converter, the corresponding turns ratio kCuk and kSEPIC are equal to (Cp1 + 
Cp2)/(Cp1 + Cp2 + Cp3 + Cp4); and for Zeta converter, the turns ratio kZeta is equal 
to (Cp1 + Cp2)/(Cp1 + Cp2 + Cp3 + Cp4 + Cp5).
Q 
Db 
Vin
Co 
Lb 
NAB=NCD=kbstNLb 
Cp1 
Cp3 
Cp2 
PE 
RLd
Q 
Db 
Vi n
Co 
A 
B
A 
D
C 
D
C 
(1–kb s t)NL b 
kb s tNL b 
Cp 1
Cp 2  
Cp 3  
PE 
RL d  
(a) Original case                                          (b) The simplified scheme 
Fig. 9.5 Boost converter with the CMVC method 

9.3 Application of the CMVC Method in Isolated DC-DC Converters
171
Q
Db 
Vin 
Co 
Lb
B
A 
D
C 
NAB=NCD=kbbNLb 
Cp1
Cp2 
Cp3 
Cp4 
PE 
RLd
Q
D 
Vi n  
Co 
A 
D
C 
(1–kC u k)NL 1
C1 
L2 
kC u kNL 1 
Cp 1
Cp 3  
Cp 4  
Cp 2  
PE 
RL d  
(a) Buck-boost converter                        (b) Cuk converter 
Q 
Db 
Vin 
Co 
A 
D
C 
(1–kSEPIC)NL1 
L2 
C1 
kSEPICNL1 
Cp1
Cp3 
Cp4 
Cp2 
PE 
RLd 
Q
C1 
Vin 
Co 
L1
B
A 
D
C 
L2 
D 
NAB=NCD=kZetaNL1 
Cp1
Cp3 
Cp4 
Cp2
Cp5 
PE 
RLd 
(c) SEPIC converter                                 (d) Zeta converter 
Fig. 9.6 Other basic non-isolated DC-DC converters with the CMVC method 
According to the above discussions, it is concluded that for non-isolated DC-
DC converters, without input side inductor (buck, buck-boost and Zeta), the CMVC 
windings at the input side is required; while for the ones with input side inductor 
(boost, Cuk and SEPIC), the CMVC method can be achieved by splitting the input 
side inductor into coupled inductors. 
9.3 
Application of the CMVC Method in Isolated DC-DC 
Converters 
In non-isolated DC-DC converters, the CMVC windings are coupled with inductor 
winding to nullify the CM voltage. While in isolated DC-DC converters, the CMVC 
windings are considered to be coupled with transformer windings. 
The CM noise circuit of isolated DC-DC converters can be derived by replacing the 
inter-winding capacitance of the transformer with two-capacitor model [5] and substi-
tuting the switches with voltage or current sources. Figure 9.7a shows the ﬂyback 
converter adopting the CMVC method, where, PG and SG represent the primary and 
secondary ground, respectively, and vQ denotes the drain-to-source voltage of power 
switch Q. The two-capacitor model for the transformer is given in Fig. 9.7b [5]. By 
substituting Q with the voltage source and the rectiﬁer diode Do with the current 
source, and simplifying the resultant circuit, the ENS is given by 
v Subscri pt  ENS n
ormal bar FLY Baseline equals k Subscript FLY Baseline v Subscript upper Q

172
9
Reducing the Common-Mode (CM) Noise in DC-DC Converters …
ENS_FLY
FLY Q
v
k
 
v
= 
* 
PG 
a 
b 
Q 
1:n 
Cp1 
PE 
B
A 
D
C 
* 
* 
* 
SG 
d 
c Do
Co 
kFLYNP 
+ 
‒ 
vQ 
NP
RLd 
* 
a 
b 
*d 
c 
Cbd 
Cad 
(a) Circuit with the CMVC method           (b) Corresponding two-capacitor model 
Fig. 9.7 The ﬂyback converter with the CMVC method 
where, kFLY is expressed as 
k Sub s
crip t FLY Baseline equals StartFraction upper C Subscript bd Baseline plus upper C Subscript p 1 Baseline Over upper C Subscript ad Baseline plus upper C Subscript bd Baseline plus upper C Subscript p 1 Baseline EndFraction
k Su bs crip t FLY 
Baseline equals StartFraction upper C Subscript bd Baseline plus upper C Subscript p 1 Baseline Over upper C Subscript ad Baseline plus upper C Subscript bd Baseline plus upper C Subscript p 1 Baseline EndFraction
Since the voltage vab across the primary winding ab and vQ have the same AC 
component, the turns of the CMVC winding AB and CD should be both equal to 
kFLYNP to cancel the CM voltage, as shown in Fig. 9.7a. Where, NP is the turns of 
the primary winding. 
Since the CMVC windings are located at the primary-side circuit in isolated 
DC-DC converters, the electric ﬁeld coupling between the CMVC and secondary 
windings should be prevented, so the primary winding is intentionally placed between 
them. Such arrangement has the merit that the magnetic coupling of the primary and 
secondary windings is not affected. Figure 9.8 shows an example of the transformer 
with the above winding arrangement, where Pri1 ~ Pri4 are the primary-winding 
layers connected in series, and Sec is the secondary-winding layer, and CM1 and 
CM2 are the CMVC windings. 
Fig. 9.8 The transformer 
winding structure of ﬂyback 
converter with the CMVC 
method
Pri1 
Pri3 
Sec 
CM2 
b 
c
d
a 
Pri2 
CM1
B
A 
C
D 
Pri4 

9.3 Application of the CMVC Method in Isolated DC-DC Converters
173
* 
PG 
A 
b 
* 
Q 
SG 
d 
c Do 
1:n 
Cp1 
PE 
Co 
D
C 
(1–kFLY)NP 
* 
kFLYNP 
Vin 
Cad 
Cbd 
RLd 
Pri3 
Sec 
CM2 
b 
c
d
Pri2
A 
C
D 
Pri4 
(a) Flyback converter                                 (b) Transformer winding structure 
Fig. 9.9 The simpliﬁed ﬂyback converter with the CMVC method 
Referring to Fig. 9.7a, the CMVC winding AB and the transformer primary 
winding ab are connected in series at the dotted terminals. So, they can be combined, 
as shown in Fig. 9.9a, where the turns of the primary winding is changed to (1 − 
kFLY)Np. As a result, for the transformer shown in Fig. 9.8, the CM1 and Pri1 winding 
layer can be removed (the turns of CM1 and Pri1 are assumed to be equal for better 
illustration), as shown in Fig. 9.9b. The Pri2, Pri3, Pri4 and CM2 are essentially 
connected in series, which has equal turns as the original winding ab. Therefore, 
the transformer size would not be increased when adopting the CMVC method. 
The circuit conﬁguration in Fig. 9.9a has been proposed in [6], which is derived 
by combining symmetry circuit and winding cancellation method to reduce the CM 
noise. 
The applications of the CMVC method in other isolated DC-DC converters 
are given in Fig. 9.10. In terms of the forward, push–pull, and half-bridge (HB) 
converters, the turns ratios of the CMVC windings and the primary winding are 
expressed as 
k Sub s
crip t FWD Baseline equals StartFraction upper C Subscript bd Baseline plus upper C Subscript p 1 Baseline Over upper C Subscript ad Baseline plus upper C Subscript bd Baseline plus upper C Subscript p 1 Baseline EndFraction
k Su bs crip t FWD 
Baseline equals StartFraction upper C Subscript bd Baseline plus upper C Subscript p 1 Baseline Over upper C Subscript ad Baseline plus upper C Subscript bd Baseline plus upper C Subscript p 1 Baseline EndFraction
k Su bs crip t PP B as elin e equals StartFraction upper C Subscript ae Baseline minus upper C Subscript be Baseline plus upper C Subscript p 1 Baseline minus upper C Subscript p 2 Baseline Over upper C Subscript ae Baseline plus upper C Subscript be Baseline plus upper C Subscript p 1 Baseline plus upper C Subscript p 2 Baseline EndFraction
k Su bs crip t PP B as elin
e equals StartFraction upper C Subscript ae Baseline minus upper C Subscript be Baseline plus upper C Subscript p 1 Baseline minus upper C Subscript p 2 Baseline Over upper C Subscript ae Baseline plus upper C Subscript be Baseline plus upper C Subscript p 1 Baseline plus upper C Subscript p 2 Baseline EndFraction
k Su b
scri pt  HB Baseline equals StartFraction upper C Subscript ae Baseline plus upper C Subscript p 2 Baseline Over upper C Subscript ae Baseline plus upper C Subscript be Baseline plus upper C Subscript p 1 Baseline plus upper C Subscript p 2 Baseline EndFraction
k Su bs crip t HB B as elin
e equals StartFraction upper C Subscript ae Baseline plus upper C Subscript p 2 Baseline Over upper C Subscript ae Baseline plus upper C Subscript be Baseline plus upper C Subscript p 1 Baseline plus upper C Subscript p 2 Baseline EndFraction
For the the HB LLC resonant converter, as shown in Fig. 9.10d, Cp1 and Cp2 are the 
parasitic capacitances between the drain of Q1, Q2 and the PE through the heatsink. 
As the switching frequency is close to the resonant frequency, the voltage across the 
Lr and Cr branch can be neglected since its impedance is far less than that of the 
magnetizing inductance. Therefore, the CM noise model of the HB LLC resonant 
converter and the HB converter is similar, and the turns ratio kHB_LLC is given by 
k Subscr i
pt H B normal bar LLC Baseline equals StartFraction upper C Subscript ae Baseline plus upper C Subscript p 2 Baseline Over upper C Subscript ae Baseline plus upper C Subscript be Baseline plus upper C Subscript p 1 Baseline plus upper C Subscript p 2 Baseline EndFraction
k Su bs crip t HB n or mal 
bar LLC Baseline equals StartFraction upper C Subscript ae Baseline plus upper C Subscript p 2 Baseline Over upper C Subscript ae Baseline plus upper C Subscript be Baseline plus upper C Subscript p 1 Baseline plus upper C Subscript p 2 Baseline EndFraction

174
9
Reducing the Common-Mode (CM) Noise in DC-DC Converters …
* 
PG 
A 
b 
* 
Q 
SG 
d 
c 
1:n 
Cp1 
PE 
Co 
kFWDNP 
(1–kFWD)NP 
* 
Lf 
Reset 
Circuit 
Vin 
Cad 
Cbd 
RLd 
DR1 DFW 
(a) Forward converter 
* 
PG 
a 
b 
* 
Q1 
SG 
d 
c 
DR1 
1:n:n 
Co 
* 
DR2 
Lf 
Q2 
* 
Cp2 PE 
NP 
* 
kPPNP
Vin 
e 
* 
NP 
Cp1
PE 
Cae 
Cbe 
RLd 
(b) Push-pull converter 
* 
PG 
a 
b 
* 
Q1 
SG 
d 
c 
Cp2 
PE 
Co
kHBNP 
D
C 
D
C 
D
C
NP 
* 
Lf 
Q2 
Cb 
* 
B
A 
B
A 
* 
Cp1 
PE 
C0 
Vin 
e 
Cbe 
Cae
RLd 
DR1 
DR2 
1:n:n 
(c) Half-bridge converter 
Fig. 9.10 The CMVC method for basic isolated DC-DC converters
Figure 9.10e shows the full-bridge converter, where Cp1 ~ CD4 are the parasitic 
capacitance between the drain of Q1 ~ Q4 to the PE through the heatsink. The ENS 
is given by [6] 
v Subscr i
p
t EN S nor
m
al b
a
r FB  B ase
l
ine  e quals StartFraction left parenthesis upper C Subscript ae Baseline plus upper C Subscript p 2 Baseline right parenthesis v Subscript upper A Baseline plus left parenthesis upper C Subscript be Baseline plus upper C Subscript p 4 Baseline right parenthesis v Subscript upper B Baseline minus upper C Subscript ae Baseline v Subscript upper L r Baseline Over upper C Subscript ae Baseline plus upper C Subscript be Baseline plus upper C Subscript p 1 Baseline plus upper C Subscript p 2 Baseline plus upper C Subscript p 3 Baseline plus upper C Subscript p 4 Baseline EndFraction
v Su bs crip t ENS no rmal  b ar F B Base
line equals StartFraction left parenthesis upper C Subscript ae Baseline plus upper C Subscript p 2 Baseline right parenthesis v Subscript upper A Baseline plus left parenthesis upper C Subscript be Baseline plus upper C Subscript p 4 Baseline right parenthesis v Subscript upper B Baseline minus upper C Subscript ae Baseline v Subscript upper L r Baseline Over upper C Subscript ae Baseline plus upper C Subscript be Baseline plus upper C Subscript p 1 Baseline plus upper C Subscript p 2 Baseline plus upper C Subscript p 3 Baseline plus upper C Subscript p 4 Baseline EndFraction

9.3 Application of the CMVC Method in Isolated DC-DC Converters
175
Q1 
Q2 
Vin 
* 
PG 
Lr 
Cr 
M 
* 
*
SG 
DR1 
DR2 
c 
d 
e
a 
b 
Co 
* 
* 
A
B 
C
D 
NAB=NCD=kHB_LLCNP 
Cbe 
Cae 
NP 
Cp2 
Cp1 
PE 
RLd 
1:n:n 
(d) Half-bridge LLC resonant converter 
* 
PG 
a 
b 
* 
Q1 
SG 
d 
c 
Cp2 
PE 
Co 
Lf 
Q2 
Cp4 
PE 
* 
Q3 
Q4 
A 
B 
Lr 
+ vLr 
Cp1
Cp3 
Vin 
Cbe 
Cae
RLd 
DR1 
DR2 
1:n:n 
(e) Full-bridge converter 
* 
PG 
a 
b 
* 
Q1 
SG 
d 
c 
Cp2 
PE 
Co 
Lf 
Q2 
Cp4 
PE 
* 
Q3 
Q4 
A 
B 
Lr 
Cp1
Cp3 
Vin 
Cbe 
Cae 
Cr 
RLd 
DR1 
DR2 
1:n:n 
(f) Full-bridge LLC resonant converter 
Fig. 9.10 (continued)
As seen from Fig. 9.10e, the primary voltage of the transformer, vab, equals to 
vA–vB–vLr. By comparing (9.12) and vab, it can be found that the ENS and vab, are  
not proportional. Thus, the CMVC method can not be applied in the full-bridge 
converter. 
Figure 9.10f shows the full-bridge LLC resonant converter. When the switching 
frequency is close to the resonant frequency, the voltage across the resonant branch 
(Lr and Cr in series) can be neglected, and the ENS is given by

176
9
Reducing the Common-Mode (CM) Noise in DC-DC Converters …
v Subscript E
N
S no rm al 
b
ar F
B
 nor ma l b
a
r LLC Baseline equals StartFraction left parenthesis upper C Subscript ae Baseline plus upper C Subscript p 2 Baseline right parenthesis v Subscript upper A Baseline plus left parenthesis upper C Subscript be Baseline plus upper C Subscript p 4 Baseline right parenthesis v Subscript upper B Baseline Over upper C Subscript ae Baseline plus upper C Subscript be Baseline plus upper C Subscript p 1 Baseline plus upper C Subscript p 2 Baseline plus upper C Subscript p 3 Baseline plus upper C Subscript p 4 Baseline EndFraction
v Su bs crip t ENS no rmal  b ar F B norm
al bar LLC Baseline equals StartFraction left parenthesis upper C Subscript ae Baseline plus upper C Subscript p 2 Baseline right parenthesis v Subscript upper A Baseline plus left parenthesis upper C Subscript be Baseline plus upper C Subscript p 4 Baseline right parenthesis v Subscript upper B Baseline Over upper C Subscript ae Baseline plus upper C Subscript be Baseline plus upper C Subscript p 1 Baseline plus upper C Subscript p 2 Baseline plus upper C Subscript p 3 Baseline plus upper C Subscript p 4 Baseline EndFraction
With the frequency control, Q1 and Q4, and Q2 and Q3 are switched simultane-
ously, respectively, and vA = − vB. Thus, vab is approximately equal to 2vA. Then, 
the ENS in (9.13) can be simpliﬁed as 
v Subscript E
NS no rm al bar
 
FB n or mal
 bar LLC Baseline equals StartFraction left parenthesis upper C Subscript ae Baseline minus upper C Subscript be Baseline right parenthesis plus left parenthesis upper C Subscript p 2 Baseline minus upper C Subscript p 4 Baseline right parenthesis Over upper C Subscript ae Baseline plus upper C Subscript be Baseline plus upper C Subscript p 1 Baseline plus upper C Subscript p 2 Baseline plus upper C Subscript p 3 Baseline plus upper C Subscript p 4 Baseline EndFraction v Subscript upper A
v Su bs crip t ENS no rmal  b ar F B norm
al
 bar LLC Baseline equals StartFraction left parenthesis upper C Subscript ae Baseline minus upper C Subscript be Baseline right parenthesis plus left parenthesis upper C Subscript p 2 Baseline minus upper C Subscript p 4 Baseline right parenthesis Over upper C Subscript ae Baseline plus upper C Subscript be Baseline plus upper C Subscript p 1 Baseline plus upper C Subscript p 2 Baseline plus upper C Subscript p 3 Baseline plus upper C Subscript p 4 Baseline EndFraction v Subscript upper A
Therefore, the CMVC method can be applied in the FB LLC resonant converter. 
9.4 
Practical Considerations for the CMVC Method 
In this section, the practical considerations for the CMVC method will be presented. 
9.4.1 
Restriction of the Input Current 
Since the input current fully passes through the CMVC windings, the CMVC method 
is recommended to be applied in the converter with low input current, where the 
copper loss and dimension of the CMVC windings are acceptable. 
9.4.2 
Inﬂuence of the Reﬂected CM Currents 
As the CMVC windings are coupled with the inductor or transformer, the CM current 
ﬂowing through the CMVC windings will be reﬂected to the inductor/transformer 
side. In general, the amplitude of the CM current is very small compared with that of 
the current ﬂowing through the inductor/transformer winding, and the CM current 
is further attenuated by the CMVC method. As a result, the effect of reﬂected CM 
current can be neglected. 
9.4.3 
Balancing Capacitor for Achieving the CMVC 
Practically, the parasitic capacitances in the circuit take arbitrary value within reason-
able range, so the turns ratio of the CMVC windings and their coupled winding will 
not be exactly equal to the capacitance ratio under all conditions. To solve this issue,

9.4 Practical Considerations for the CMVC Method
177
balancing capacitor can be introduced and connected in parallel with some parasitic 
capacitance, in order to adjust the capacitance ratio for achieving the CMVC. 
Taking the CMVC method in buck converter in Fig. 9.4 as an example, by adding 
a balancing capacitor CB in parallel with Cp3, the condition of achieving CMVC is 
k Subs cr ipt buck Baseline equals StartFraction upper N Subscript AB Baseline Over upper N Subscript Lf Baseline EndFraction equals StartFraction upper C Subscript p 1 Baseline Over upper C Subscript p 1 Baseline plus upper C Subscript p 2 Baseline plus left parenthesis upper C Subscript p 3 Baseline plus upper C Subscript upper B Baseline right parenthesis plus upper C Subscript p 4 Baseline EndFraction
k Su
b
script buck Baseline equals StartFraction upper N Subscript AB Baseline Over upper N Subscript Lf Baseline EndFraction equals StartFraction upper C Subscript p 1 Baseline Over upper C Subscript p 1 Baseline plus upper C Subscript p 2 Baseline plus left parenthesis upper C Subscript p 3 Baseline plus upper C Subscript upper B Baseline right parenthesis plus upper C Subscript p 4 Baseline EndFraction
k Su bs crip t
 
buck  B as
e
li ne e
quals StartFraction upper N Subscript AB Baseline Over upper N Subscript Lf Baseline EndFraction equals StartFraction upper C Subscript p 1 Baseline Over upper C Subscript p 1 Baseline plus upper C Subscript p 2 Baseline plus left parenthesis upper C Subscript p 3 Baseline plus upper C Subscript upper B Baseline right parenthesis plus upper C Subscript p 4 Baseline EndFraction
By adjusting the capacitance of CB, the capacitance ratio at the right side will be 
modiﬁed so that its value is equal to the turns ratio at the left side. In fact, CB can 
be in parallel with any parasitic capacitance, as long as the capacitance ratio and the 
turns ratio are equal. 
In some converters, the CMVC can be achieved without adding a balancing capac-
itor. For push–pull converter in Fig. 9.10b, when the insulation between Q1, Q2 and the 
heatsink has the same thickness, Cp1 = Cp2 can be assumed. Meanwhile, by adopting 
symmetry transformer [7], Cae = Cbe can be obtained. According to (9.9), kPP = 0, 
which means no CM noise. This is also true for the FB LLC resonant converter: when 
Cae = Cbe and Cp1 = Cp2, the CM noise can be eliminated according to (9.14). 
For the HB converter and HB LLC resonant converter, by using the insulation 
with the same thickness between Q1, Q2 and the heatsink, and adopting symmetry 
transformer, Cp1 = Cp2 and Cae = Cbe can be realized. According to (9.10) and 
(9.11), kHB and kHB_LLC are both equal to 0.5. 
Taking the transformer winding structure shown in Fig. 9.11 as an example, the 
condition for achieving Cae = Cbe will be derived. In Fig. 9.11, the primary winding 
ab is contributed by two planar windings Pri1 and Pri2 connected in parallel, the 
secondary winding cd is implemented by printed circuit board (PCB) winding with 
the center-tap terminal e. The CMVC windings, AB and CD, are placed at the top side. 
The parasitic capacitance between Pri1 and Sec1-1, Pri2 and Sec2-2 are denoted by 
C01 and C02, respectively. The displacement current ﬂowing through Pri1 and Sec1-1, 
Pri2 and Sec2-2 are expressed as
StartLa yo ut E nlarged left brace 1st Row i Subscript dis 1 Baseline equals upper C 01 StartFraction d Over d t EndFraction left bracket lamda 1 v Subscript a Baseline plus left parenthesis 1 minus lamda 1 right parenthesis v Subscript b Baseline minus left parenthesis seven eighths v Subscript c Baseline plus one eighth v Subscript d Baseline right parenthesis right bracket 2nd Row i Subscript dis 2 Baseline equals upper C 02 StartFraction d Over d t EndFraction left bracket left parenthesis 1 minus lamda 1 right parenthesis v Subscript a Baseline plus lamda 1 v Subscript b Baseline minus left parenthesis one eighth v Subscript c Baseline plus seven eighths v Subscript d Baseline right parenthesis right bracket EndLayout
St
a
rtLay ou t E nl arged l
e ft brace 1st Row i Subscript dis 1 Baseline equals upper C 01 StartFraction d Over d t EndFraction left bracket lamda 1 v Subscript a Baseline plus left parenthesis 1 minus lamda 1 right parenthesis v Subscript b Baseline minus left parenthesis seven eighths v Subscript c Baseline plus one eighth v Subscript d Baseline right parenthesis right bracket 2nd Row i Subscript dis 2 Baseline equals upper C 02 StartFraction d Over d t EndFraction left bracket left parenthesis 1 minus lamda 1 right parenthesis v Subscript a Baseline plus lamda 1 v Subscript b Baseline minus left parenthesis one eighth v Subscript c Baseline plus seven eighths v Subscript d Baseline right parenthesis right bracket EndLayout
Start La yout Enlarged left brace 1st Row i Subscript dis 1 Baseline equals upper C 01 StartFraction d Over d t EndFraction left bracket lamda 1 v Subscript a Baseline plus left parenthesis 1 minus lamda 1 right parenthesis v Subscript b Baseline minus left parenthesis seven eighths v Subscript c Baseline plus one eighth v Subscript d Baseline right parenthesis right bracket 2nd Row i Subscript dis 2 Baseline equals upper C 02 StartFraction d Over d t EndFraction left bracket left parenthesis 1 minus lamda 1 right parenthesis v Subscript a Baseline plus lamda 1 v Subscript b Baseline minus left parenthesis one eighth v Subscript c Baseline plus seven eighths v Subscript d Baseline right parenthesis right bracket EndLayout
Star
tL
ayout En larg ed left brace 1st Row i Subscript dis 1 Baseline equals upper C 01 StartFraction d Over d t EndFraction left bracket lamda 1 v Subscript a Baseline plus left parenthesis 1 minus lamda 1 right parenthesis v Subscript b Baseline minus left parenthesis seven eighths v Subscript c Baseline plus one eighth v Subscript d Baseline right parenthesis right bracket 2nd Row i Subscript dis 2 Baseline equals upper C 02 StartFraction d Over d t EndFraction left bracket left parenthesis 1 minus lamda 1 right parenthesis v Subscript a Baseline plus lamda 1 v Subscript b Baseline minus left parenthesis one eighth v Subscript c Baseline plus seven eighths v Subscript d Baseline right parenthesis right bracket EndLayout
St
a
rtL ay out En la rged l
e ft brace 1st Row i Subscript dis 1 Baseline equals upper C 01 StartFraction d Over d t EndFraction left bracket lamda 1 v Subscript a Baseline plus left parenthesis 1 minus lamda 1 right parenthesis v Subscript b Baseline minus left parenthesis seven eighths v Subscript c Baseline plus one eighth v Subscript d Baseline right parenthesis right bracket 2nd Row i Subscript dis 2 Baseline equals upper C 02 StartFraction d Over d t EndFraction left bracket left parenthesis 1 minus lamda 1 right parenthesis v Subscript a Baseline plus lamda 1 v Subscript b Baseline minus left parenthesis one eighth v Subscript c Baseline plus seven eighths v Subscript d Baseline right parenthesis right bracket EndLayout
Start La yout Enlarged left brace 1st Row i Subscript dis 1 Baseline equals upper C 01 StartFraction d Over d t EndFraction left bracket lamda 1 v Subscript a Baseline plus left parenthesis 1 minus lamda 1 right parenthesis v Subscript b Baseline minus left parenthesis seven eighths v Subscript c Baseline plus one eighth v Subscript d Baseline right parenthesis right bracket 2nd Row i Subscript dis 2 Baseline equals upper C 02 StartFraction d Over d t EndFraction left bracket left parenthesis 1 minus lamda 1 right parenthesis v Subscript a Baseline plus lamda 1 v Subscript b Baseline minus left parenthesis one eighth v Subscript c Baseline plus seven eighths v Subscript d Baseline right parenthesis right bracket EndLayout
Star
tL
ayout Enlarged left brace 1st Row i Subscript dis 1 Baseline equals upper C 01 StartFraction d Over d t EndFraction left bracket lamda 1 v Subscript a Baseline plus left parenthesis 1 minus lamda 1 right parenthesis v Subscript b Baseline minus left parenthesis seven eighths v Subscript c Baseline plus one eighth v Subscript d Baseline right parenthesis right bracket 2nd Row i Subscript dis 2 Baseline equals upper C 02 StartFraction d Over d t EndFraction left bracket left parenthesis 1 minus lamda 1 right parenthesis v Subscript a Baseline plus lamda 1 v Subscript b Baseline minus left parenthesis one eighth v Subscript c Baseline plus seven eighths v Subscript d Baseline right parenthesis right bracket EndLayout
where, λ1 is given by 
lam da
 1 equals StartStartFraction two thirds r 1 plus one third r 2 plus StartFraction r 2 minus r 1 Over 6 upper N Subscript upper P Superscript 2 Baseline EndFraction OverOver r 1 plus r 2 EndEndFraction
lamd a 1 equals StartStartFraction two thirds r 1 plus one third r 2 plus StartFraction r 2 minus r 1 Over 6 upper N Subscript upper P Superscript 2 Baseline EndFraction OverOver r 1 plus r 2 EndEndFraction
lamd a 1 equals StartStartFraction two thirds r 1 plus one third r 2 plus StartFraction r 2 minus r 1 Over 6 upper N Subscript upper P Superscript 2 Baseline EndFraction OverOver r 1 plus r 2 EndEndFraction
la md
a 1 equals StartStartFraction two thirds r 1 plus one third r 2 plus StartFraction r 2 minus r 1 Over 6 upper N Subscript upper P Superscript 2 Baseline EndFraction OverOver r 1 plus r 2 EndEndFraction
lam da  1 
equals StartStartFraction two thirds r 1 plus one third r 2 plus StartFraction r 2 minus r 1 Over 6 upper N Subscript upper P Superscript 2 Baseline EndFraction OverOver r 1 plus r 2 EndEndFraction
where, r1 and r2 are the inner and outer radius of the primary winding, NP is the 
turns number of the primary winding [8]. 
Because one insulation with the same thickness is used between Pri1 and Sec1-1, 
as well as Pri2 and Sec2-2, C01 = C02 = 0.5C0 is ensured. According to (9.16), and 
considering C01 = C02 = 0.5C0, we have

178
9
Reducing the Common-Mode (CM) Noise in DC-DC Converters …
c 
d 
e 
a 
b 
A 
B 
C 
D 
b 
SG 
c 
d 
a
Pri1 
Pri2 
Sec1-1 
Sec1-2 
Sec2-1 
Sec2-2 
b 
a 
C01 
C02 
A 
C 
B 
D 
(a) 3D view                                      (b) 2D view 
Fig. 9.11 Winding structure of the transformer
i Sub sc ript d is  Basel in e e
quals i Subscript dis 1 Baseline plus i Subscript dis 2 Baseline equals upper C 0 StartFraction d Over d t EndFraction left bracket one half v Subscript a Baseline plus one half v Subscript b Baseline minus left parenthesis one half v Subscript c Baseline plus one half v Subscript d Baseline right parenthesis right bracket
i 
Subscript dis Baseline equals i Subscript dis 1 Baseline plus i Subscript dis 2 Baseline equals upper C 0 StartFraction d Over d t EndFraction left bracket one half v Subscript a Baseline plus one half v Subscript b Baseline minus left parenthesis one half v Subscript c Baseline plus one half v Subscript d Baseline right parenthesis right bracket
i Sub sc ript dis Baseline equals i Subscript dis 1 Baseline plus i Subscript dis 2 Baseline equals upper C 0 StartFraction d Over d t EndFraction left bracket one half v Subscript a Baseline plus one half v Subscript b Baseline minus left parenthesis one half v Subscript c Baseline plus one half v Subscript d Baseline right parenthesis right bracket
i Sub s
cript dis Baseline equals i Subscript dis 1 Baseline plus i Subscript dis 2 Baseline equals upper C 0 StartFraction d Over d t EndFraction left bracket one half v Subscript a Baseline plus one half v Subscript b Baseline minus left parenthesis one half v Subscript c Baseline plus one half v Subscript d Baseline right parenthesis right bracket
i Sub sc ript dis Baseline equals i Subscript dis 1 Baseline plus i Subscript dis 2 Baseline equals upper C 0 StartFraction d Over d t EndFraction left bracket one half v Subscript a Baseline plus one half v Subscript b Baseline minus left parenthesis one half v Subscript c Baseline plus one half v Subscript d Baseline right parenthesis right bracket
i Su
bs
cript dis Baseline equals i Subscript dis 1 Baseline plus i Subscript dis 2 Baseline equals upper C 0 StartFraction d Over d t EndFraction left bracket one half v Subscript a Baseline plus one half v Subscript b Baseline minus left parenthesis one half v Subscript c Baseline plus one half v Subscript d Baseline right parenthesis right bracket
The general formula for the total displacement current ﬂowing through trans-
former inter-winding capacitance has been derived in Chap. 6, expressed as 
i Sub sc rip
t dis Baseline equals upper C 0 StartFraction d Over d t EndFraction left brace lamda Subscript upper P Baseline v Subscript a Baseline plus left parenthesis 1 minus lamda Subscript upper P Baseline right parenthesis v Subscript b Baseline minus left bracket lamda Subscript upper S Baseline v Subscript c Baseline plus left parenthesis 1 minus lamda Subscript upper S Baseline right parenthesis v Subscript d Baseline right bracket right brace
i S ubscri pt  di s Baseli ne  equal s up er  C 0 St
artFraction d Over d t EndFraction left brace lamda Subscript upper P Baseline v Subscript a Baseline plus left parenthesis 1 minus lamda Subscript upper P Baseline right parenthesis v Subscript b Baseline minus left bracket lamda Subscript upper S Baseline v Subscript c Baseline plus left parenthesis 1 minus lamda Subscript upper S Baseline right parenthesis v Subscript d Baseline right bracket right brace
By comparing (9.18) and (9.19), the winding structural parameter λP and λS 
are both equal to 0.5. Referring to the two-capacitor expressions in (8.8) for  the  
transformer with a center-tap, Cae and Cbe are given by
Start La yout  E nlar ge d left b
race  1 st Ro w up pe r C Su bscript a
e Baseline equals left bracket lamda Subscript upper P Baseline plus n left parenthesis 1 minus 2 lamda Subscript upper S Baseline right parenthesis right bracket upper C 0 2nd Row upper C Subscript be Baseline equals left brace 1 minus left bracket lamda Subscript upper P Baseline plus n left parenthesis 1 minus 2 lamda Subscript upper S Baseline right parenthesis right bracket right brace upper C 0 EndLayout
By substituting λP = λS = 0.5 into (9.20), yields 
uppe r C Su bs cript
 ae Baseline equals upper C Subscript be Baseline equals 0.5 upper C 0
As seen, when C01 = C02 = 0.5C0, Cae is equal to Cbe. Furthermore, by substi-
tuting (9.21) and Cp1 = Cp2 into (9.11), kHB_LLC is calculated as 0.5, so the turns 
number of the CMVC windings is half of the primary winding turns. 
9.4.4 
Capacitive Coupling Effect 
As the CMVC windings are closely placed with the inductor/transformer winding, 
the capacitive effect must be considered. Because the capacitive coupling is conﬁned 
within the circuit and the PE is not involved, this coupling does not create addi-
tional CM noise path. However, the circuit operation can be affected if the parasitic

9.5 Experimental Veriﬁcation
179
capacitance between the CMVC windings and their coupled windings is signiﬁcantly 
large. To address this issue, the parasitic capacitance should be kept small, which 
can be achieved by enlarging the distance between these windings. Consequently, the 
leakage inductance between the CMVC windings and their coupled windings will 
be increased. The method for dealing with this leakage inductance will be discussed 
below. 
9.4.5 
Effect of Leakage Inductance 
In this sub-section, the effect of the leakage inductance of the CMVC winding is 
discussed. The buck converter with the CMVC method is taken as an example, as 
shown in Fig. 9.12a, where the leakage inductance and magnetizing inductance are 
included. It is assumed that two CMVC windings are perfectly coupled, and they 
have equal leakage inductance Llk_p with respect to the ﬁltering winding. Following 
the previous procedure of deriving the CM noise circuit, the CM noise circuit with 
substituted sources is given in Fig. 9.12b. By simplifying the circuit at the right side 
of 25-Ω resistor, the Thevenin equivalent circuit is derived in Fig. 9.14c, where 
v Sub s
c
ript ENS Baseline equals left parenthesis StartFraction upper L Subscript f Baseline Over upper L Subscript f Baseline plus upper L Subscript lk normal bar p Baseline EndFraction dot k Subscript buck Baseline minus StartFraction upper C Subscript p 1 Baseline Over upper C Subscript p 1 Baseline plus upper C Subscript p 2 Baseline plus upper C Subscript p 3 Baseline plus upper C Subscript upper B Baseline plus upper C Subscript p 4 Baseline EndFraction right parenthesis v Subscript DFW
v S ub script
 E NS Bas e
line equals left parenthesis StartFraction upper L Subscript f Baseline Over upper L Subscript f Baseline plus upper L Subscript lk normal bar p Baseline EndFraction dot k Subscript buck Baseline minus StartFraction upper C Subscript p 1 Baseline Over upper C Subscript p 1 Baseline plus upper C Subscript p 2 Baseline plus upper C Subscript p 3 Baseline plus upper C Subscript upper B Baseline plus upper C Subscript p 4 Baseline EndFraction right parenthesis v Subscript DFW
v Su bs crip t ENS Ba sel in e e
q
uals
 left parenthesis StartFraction upper L Subscript f Baseline Over upper L Subscript f Baseline plus upper L Subscript lk normal bar p Baseline EndFraction dot k Subscript buck Baseline minus StartFraction upper C Subscript p 1 Baseline Over upper C Subscript p 1 Baseline plus upper C Subscript p 2 Baseline plus upper C Subscript p 3 Baseline plus upper C Subscript upper B Baseline plus upper C Subscript p 4 Baseline EndFraction right parenthesis v Subscript DFW
Referring to Fig. 9.12c and (9.22), the leakage inductance has affect on the equiv-
alent noise source vENS and the CM noise source impedance. In order to reduce the 
CM noise, the coefﬁcient before vDFW in (9.22) should be zero, yields 
k Subs c
r
ip t buck Baseline equals left parenthesis 1 plus StartFraction upper L Subscript lk normal bar p Baseline Over upper L Subscript f Baseline EndFraction right parenthesis dot StartFraction upper C Subscript p 1 Baseline Over upper C Subscript p 1 Baseline plus upper C Subscript p 2 Baseline plus upper C Subscript p 3 Baseline plus upper C Subscript upper B Baseline plus upper C Subscript p 4 Baseline EndFraction
k 
S
u
bscript buck Baseline equals left parenthesis 1 plus StartFraction upper L Subscript lk normal bar p Baseline Over upper L Subscript f Baseline EndFraction right parenthesis dot StartFraction upper C Subscript p 1 Baseline Over upper C Subscript p 1 Baseline plus upper C Subscript p 2 Baseline plus upper C Subscript p 3 Baseline plus upper C Subscript upper B Baseline plus upper C Subscript p 4 Baseline EndFraction
k Su bs crip t buck  B ase li ne e
quals left parenthesis 1 plus StartFraction upper L Subscript lk normal bar p Baseline Over upper L Subscript f Baseline EndFraction right parenthesis dot StartFraction upper C Subscript p 1 Baseline Over upper C Subscript p 1 Baseline plus upper C Subscript p 2 Baseline plus upper C Subscript p 3 Baseline plus upper C Subscript upper B Baseline plus upper C Subscript p 4 Baseline EndFraction
According to Fig. 9.12a, the leakage inductance and the magnetizing inductance 
form a voltage divider, and the induced voltages across the CMVC windings are 
actually smaller. To counteract the effect of the leakage inductance, kbuck is increased 
accordingly by comparing (9.23) and (9.15). 
9.5 
Experimental Veriﬁcation 
In this Section, the prototypes of one non-isolated DC-DC converter (buck converter) 
and one isolated DC-DC converter (half-bridge LLC resonant converter) are built 
and tested in the lab, for verifying the effectiveness of the CMVC method. The CM 
parasitic capacitance is measured by a LCR meter (Chroma 3302) at 200-kHz test 
frequency.

180
9
Reducing the Common-Mode (CM) Noise in DC-DC Converters …
Leq
Ceq 
0.5Llk_s 
25Ω 
Cp1+Cp2+Cp3+Cp4+CB
kbuck(Llk_p//Lf)
2 
vENS 
Q 
DFW 
Vin
Co 
Lf 
B
A 
D
C 
NAB=NCD=kbuckNLf 
Cp1
Cp2 
Cp3+CB 
Cp4 
Llk_s 
Llk_s 
Llk_p 
Cin 
RLd 
(a) The circuit with leakage inductance 
Lf 
B
A 
D
C 
NAB=NCD=kbuckNLf 
Cp1
Cp2
Cp4 
Llk_s 
Llk_s 
Llk_p 
vDFW 
iQ 
25Ω 
Cp3+CB 
(b) The CM noise circuit with substituted sources 
(c) The simplified circuit 
Fig. 9.12 Buck converter with the CMVC method considering leakage inductance
9.5.1 
Buck Converter 
The buck converter with synchronous rectiﬁcation (see Fig. 9.4) is operated at 
200 kHz. Table 9.1 lists the main parameters. Because the upper and bottom switches 
are both mounted on a heatsink which is connected to the PE, the dominant parasitic 
capacitance between the circuit nodes and PE are Cp1 and Cp4 (37 pF), and Cp2 and 
Cp3 are neglected. The output ﬁlter inductor adopts PQ 26/25 core, and all the wind-
ings use single strand enameled wire. The diameter for the inductor and the CMVC 
winding are 1.5 mm and 0.7 mm, respectively.
For realizing the CMVC method, kbuck is chosen as 0.5. Therefore, the CMVC 
winding takes 7 turns, which is half of the inductor winding turns. The measured 
parasitic capacitance between the CMVC windings and inductor winding is 23 pF, 
which is negligible for the buck converter operating at 200 kHz. Figure 9.13 shows

9.5 Experimental Veriﬁcation
181
Table 9.1 Related parameters of the buck converter 
Input voltage Vin
48 V
Filter inductance Lf
28 µH 
Output voltage Vo
12 V
Output capacitance Cf
20 µF 
Output power Po
100 W
Capacitance Cp1
37 pF 
Input capacitance Cin
10 µF
Capacitance Cp4
37 pF
Time: [2μs/div] 
vQ2: [20V/div] 
iL: [2A/div] 
vAB: [20V/div] 
vCD: [20V/div] 
Fig. 9.13 Experimental waveforms of buck converter adopting the CMVC method
the measured waveforms at full-load. As seen, the buck converter works normally 
and the voltage across the CMVC winding is half of the drain-to-source voltage vQ2 
of the bottom switch. In addition, the reﬂected CM current in the inductor current is 
too small to be noticed. 
Figure 9.14 shows the comparison of the CM EMI spectra of the buck converter 
without CM noise reduction, with CM inductor and with the CMVC method. In 
Fig. 9.14a, the original CM noise of the buck converter is compared with the buck 
converter using a CM inductor of 6.3 µH, which is close to the magnetizing induc-
tance of the CMVC windings. At low frequencies, since the impedance of this CM 
inductor is very small compared with the impedance of the CM parasitic capacitance, 
the CM noise reduction is not obvious. However, at high frequencies, the impedance 
of this CM inductor exceeds the impedance of parasitic capacitance, and signiﬁcant 
reduction can be observed. 
Figure 9.14b shows the comparison of the CM noise of the buck converter with 
the CMVC method and with the CM inductor for fair comparison. Referring to 
Fig. 9.12a, by adding the CMVC windings, Lf = 28 µH, Llk_p = 1.44 µH, and Llk_s 
= 0.60 µH. Because Llk_p is far smaller than Lf, the compensation voltage is close 
to the ENS, and 12-dB reduction can be observed in Fig. 9.14b when the CMVC 
method is applied. By substituting the related parameters into (9.23), the balancing

182
9
Reducing the Common-Mode (CM) Noise in DC-DC Converters …
40
CM noise (dBμV) 
120 
60 
20 
1M
10M
30M
150k 
f (Hz) 
100 
80 
CM Ind.
Original 
40 
120 
60 
20 
1M
10M
30M
150k 
100 
80 
CMVC+CB
CM Ind.
CMVC 
Llk_p=1.44 μH 
CM noise (dBμV) 
f (Hz) 
(a) Original case and with CM inductor                (b) With small leakage inductance 
40 
120 
60 
20 
1M
10M
30M
150k 
100 
80 
CMVC+CB
CM Ind.
CMVC 
Llk_p=14.74 μH 
CM noise (dBμV) 
f (Hz) 
(c) With large leakage inductance 
Fig. 9.14 Comparison of the CM noise under various conditions
capacitor CB is calculated as 3.8 pF. After adding this balancing capacitor to be 
connected between the power ground and PE, the CM noise is further reduced by 
5 dB, which validates the analysis in Sect. 9.4.5. 
In order to further validate the analysis of the case with large leakage inductance, 
an external inductor (13.30 µH) is added to be in series with the inductor winding, 
and a CM inductor (2.90 µH) is added in series with the CMVC winding. Although 
the effective ﬁlter inductance is increased, the duty cycle stays the same since the 
buck converter operates in continuous conduction mode (CCM), and the spectra of 
vQ2 are not changed. As seen in Fig. 9.14c, there is no obvious reduction at low 
frequencies when the CMVC method is applied, because the compensation voltage 
becomes lower in this case, which does not match the ENS of the buck converter. 
By substituting the related parameters into (9.23), CB is calculated as 39.0 pF. By 
adding this balancing capacitor connected between the power ground and the PE, the 
resultant CM noise is signiﬁcantly reduced at low frequencies. The noise reduction 
at high frequencies is still not known, which requires more detailed modeling with 
other parasitic components in the circuit.

9.5 Experimental Veriﬁcation
183
9.5.2 
Half-Bridge LLC Resonant Converter 
Figure 9.15 shows the HB LLC resonant converter prototype and the transformer. The 
auxiliary winding is one turn and is connected in the primary circuit for powering the 
driving and control circuit. Because the primary winding acts as shielding between 
the auxiliary winding and secondary winding, the auxiliary winding does not affect 
the CM noise. 
Table 9.2 lists the related parameters. The circuit with the CMVC method is given 
in Fig. 9.10d. The CMVC winding uses single strand enameled wire, because most 
of the AC components from the input current are ﬁltered by the input capacitor. The 
resonant inductor uses 0.1 mm × 150 litz wire, and has 10 turns in a PQ 26/20 core. 
Lr
T
Cr 
Q1
Q2 
DR1 
DR2 
Co 
Top
Bottom 
CMVC 
winding 
Primary 
winding
c 
e 
d 
a 
b 
c 
e 
d 
Primary 
winding 
Secondary 
winding 
Auxiliary 
winding 
A, C 
B, D 
Fig. 9.15 Photo of the HB LLC resonant converter protptype 
Table 9.2 Main circuit parameters of the HB LLC resonant converter 
Input voltage Vin
385 V
Resonant inductance Lr
13.5 µH 
Output voltage Vo
48 V
Resonant capacitance Cr
57 nF 
Output power Po
1 kW
Magnetizing inductance Lm
86 µH 
Resonant frequency f r
180 kHz
Input capacitance Cin
2.5 µF 
Turns ratio n
1/4
Output capacitance Co
600 µF

184
9
Reducing the Common-Mode (CM) Noise in DC-DC Converters …
The transformer winding structure is shown in Fig. 9.11, and the winding dimen-
sions are listed in Table 9.3. Since the same type of insulation material with equal 
thickness is used between Pri1 and Sec1-1, as well as Pri2 and Sec2-2, C01 and C02 
are nearly the same, and they are measured as 53 pF. Likewise, Cp1 and Cp2 are 
also equal, and their measured values are both 20 pF. According to the analysis in 
Sect. 9.4.3, the  turns  NAB (NCD) of the CMVC windings are half of the primary 
winding turns, which is 4. Besides, the measured parasitic capacitance between the 
CMVC windings and the primary winding is 26 pF, which is negligible for the LLC 
resonant converter operating around 170.35 kHz. 
Figure 9.16 shows the experimental waveforms of the LLC resonant converter at 
full-load, including the primary winding voltage vab, the resonant inductor current 
iLr, and the voltage vres across the resonant branch consisted of Lr and Cr. As seen, 
the switching frequency is around 170.35 kHz. In addition, vres presents impulse 
scheme, because the slope of the resonant inductor current has sudden change around 
the intersection of two-component resonance and three-component resonance, as 
highlighted in Fig. 9.16. Since the pulse width of vres is quite small, the harmonic 
amplitude of vres is far lower than the harmonic amplitude of vab at low frequencies. 
Therefore, the effect of vres on the CM noise at low frequencies can be neglected. In 
addition, the reﬂected CM current in iLr is too small to be noticed. 
Table 9.3 Parameters of 
power transformer
Winding
Dimension
Turns 
Primary winding ab
Litz wire
0.1 mm × 80
Pri1: 8 
Pri2: 8 
Secondary winding cd 
PCB winding 
4 oz, 9.75 mm 
4 
Time: [2μs/div] 
iLr: [10A/div] 
vres: [400V/div] 
vab: [200V/div] 
Fig. 9.16 Measured voltage across the primary winding and the resonant branch

9.5 Experimental Veriﬁcation
185
Figure 9.17 shows the experimental waveforms of the LLC resonant converter 
with the CMVC method, including the primary winding voltage vab and the voltage 
vAB, vCD across the CMVC windings. As seen, these voltage waveforms are similar, 
and vab is twice the amplitude of vAB and vCD. 
Figure 9.18 compares the measured CM noise of the HB LLC resonant converter 
with and without the CMVC method, as well as the CM EMI of the converter with 
CM inductor. The CM inductance is 22.30 µH, which is close to the magnetizing 
inductance of the CMVC windings. As seen, when the CM inductor is inserted, the 
CM noise does not change at low frequencies and is reduced at high frequencies, 
which is similar with the results of buck converter. By applying the CMVC method, 
the CM EMI is reduced by nearly 20 dB, which validates the effectiveness of the 
proposed method. 
vab: [200V/div] 
vAB: [200V/div] 
vCD: [200V/div] 
Time: [2μs/div] 
Fig. 9.17 Measured voltage across the primary winding of the transformer and the winding for the 
CM noise reduction 
Fig. 9.18 Comparison of the original CM noise, the CM noise with CM inductor and the CM noise 
with CMVC method at full-load

186
9
Reducing the Common-Mode (CM) Noise in DC-DC Converters …
9.6 
Summary 
In this chapter, the CMVC method is proposed to reduce the CM noise of DC-DC 
converters. By adding two windings connected between the input voltage source 
and the converter input side, and coupling them with the inductor or transformer 
winding, a compensation voltage is generated for cancelling the CM noise of DC-DC 
converters. The CMVC method can be implemented in both non-isolated and isolated 
DC-DC converters. Speciﬁcally, for boost, Cuk and SEPIC converters, the CMVC 
method can be achieved by dividing the input inductor winding into two coupled 
windings placed at the input positive line and the input return line; and for ﬂyback 
and forward converters, the primary winding can be split into two coupled windings in 
series with the main switch, respectively. The CMVC method is recommended to be 
applied in the converter with low input current, and the effect of leakage inductance 
on the CM noise reduction can be managed by using a balancing capacitor. The 
prototypes of a 100-W buck converter and a 1-kW HB LLC resonant converter are 
built and tested in the lab, and the effectiveness of the CMVC method is veriﬁed by 
the experimental results, respectively. 
References 
1. L. Xie, X. Ruan, Z. Ye, Equivalent noise source: an effective method for analyzing common mode 
noise in isolated power converters. IEEE Trans. Industr. Electron. 63(5), 2913–2924 (2016) 
2. D. Cochrane, D. Chen, D. Boroyevic, Passive cancellation of common-mode noise in power 
electronic circuits. IEEE Trans. Power Electron. 18(3), 756–763 (2003) 
3. S. Ogasawara, H. Ayano, H. Akagi, An active circuit for cancellation of common mode voltage 
generated by a PWM inverter. IEEE Trans. Power Electron. 13(5), 835–841 (1998) 
4. S. Wang, P. Kong, F.C. Lee, Common mode noise reduction for boost converters using general 
balance technique. IEEE Trans. Power Electron. 22(4), 1410–1416 (2007) 
5. H. Zhang, S. Wang, Y. Li, Q. Wang, D. Fu, Two-capacitor transformer winding capacitance 
models for common- mode EMI noise analysis in isolated dc−dc converters. IEEE Trans. Power 
Electron. 32(11), 8458–8469 (2017) 
6. L. Xie, X. Ruan, and Z. Ye, Modeling of common mode noise in phase-shift full-bridge converter, 
in Proceedings of IEEE Annual Conference of Industrial Electronics Society (IECON) (2016), 
pp. 1371–1375 
7. L. Xie, X. Ruan, Z. Ye, Reducing common mode noise in phase-shift full-bridge converter. IEEE 
Trans. Industr. Electron. 65(10), 7866–7877 (2018) 
8. P. Kong, S. Wang, F.C. Lee, Z. Wang, Reducing common-mode noise in two-switch forward 
converter. IEEE Trans. Power Electron. 26(5), 1522–1533 (2011)

Chapter 10 
Reducing the Common-Mode Currents 
at the Input and Output Sides 
in Non-isolated DC-DC Conveters 
10.1 
The Common-Mode (CM) Noise Model of Buck 
Converter Considering the CM Impedances 
at the Input and Output Sides 
In non-isolated DC-DC converters, there are high dv/dt nodes and parasitic capaci-
tances between these nodes and the protective earth (PE). The displacement currents 
ﬂowing through these parasitic capacitances are generated, leading to the common-
mode (CM) noise. The CM noise not only appears at the input side, but also prop-
agates into the output side, affecting the operation of loads. In this section, the CM 
noise model of buck converter will be derived with the consideration of the CM 
impedances at both the input and output sides. 
Figure 10.1 shows the buck converter and its CM noise propagation path, where, 
Q is the power switch, DFW is the freewheeling diode, Lf is the ﬁlter inductor, Co is 
the output ﬁlter capacitor, and RLd is the load. CpA, CpB, CpC, Cp1 and Cp2 are the 
CM parasitic capacitaces. The line impedance stabilization network (LISN) is placed 
between the input voltage source and the input side of the converter for providing 
speciﬁc impedance for the CM noise current [1].
The derivation of the CM noise circuit of the buck converter is illustrated as 
follows. Owing to the high dv/dt characteristics of node B, DFW is replaced with a 
voltage source that replicates its waveform. The capacitors Cin and Co are treated 
as short circuit because their dv/dt are much smaller than that of the voltage across 
DFW. For avoiding voltage loops, switch Q and inductor Lf are replaced with current 
sources that replicate their waveforms [2]. Finally, the CM impedance at the LISN 
side can be simpliﬁed as a 25-Ω resistor, and the CM impedance at the output side is 
essentially the parallel connection of Cp1 and Cp2. The resultant CM noise equivalent 
circuit with substituted sources is given in Fig. 10.2.
© The Author(s), under exclusive license to Springer Nature Singapore Pte Ltd. 2024 
X. Ruan et al., Conducted Electromagnetic Interference in Power Converters: Modeling, 
Prediction and Reduction, CPSS Power Electronics Series, 
https://doi.org/10.1007/978-981-99-9295-9_10 
187

188
10
Reducing the Common-Mode Currents at the Input and Output Sides …
Q 
DFW Co 
RLd 
Lf 
CpC
Cp2 
CpB
Cp1 
A 
C 
CpA 
Cin 
PE 
Vin 
PE 
LISN 
50μH 
50μH 
1μF 
0.1μF 
50Ω
1μF
50Ω 
0.1μF 
iCM_in
iCM_out 
B 
Fig. 10.1 Buck converter and the CM noise propagation paths
Fig. 10.2 The CM noise 
equivalent circuit with 
substituted sources 
CpC 
Cp1+Cp2 
CpB 
A 
C 
CpA 
iQ 
vDFW 
iLf 
25Ω 
PE 
B 
Superposition theorem is adopted to simplify the equivalent circuit in Fig. 10.2. 
Firstly, the voltage source vDFW is shorted to only consider the excitation of current 
sources iQ and iLf. Since iQ and iLf are essentially shorted, they do not cause CM 
noise. Secondly, by opening the current sources iQ and iLf, the resultant CM noise 
model is given in Fig. 10.3a. 
By using Thevenin’s theorem, the CM noise model in Fig. 10.3a can be simpliﬁed 
as Fig. 10.3b, where, vENS is the equivalent noise source (ENS) [3], and Csum is the 
total parasitic capacitance. vENS, Csum and CRL are expressed as 
v Sub sc ript ENS 
Baseline equals k Subscript buck Baseline v Subscript DFW
Cp1+Cp2 
CpB 
vDFW 
25Ω 
CpA+CpC 
PE 
Csum 
vENS 
iCM_out 
CRL 
iCM_in 
25Ω 
PE 
(a) The CM noise model with vDFW               (b) The CM noise model with vENS 
Fig. 10.3 Simpliﬁcation of the CM noise equivalent circuit 

10.2 The CM Current Reduction of Both Sides in Buck Converters
189
upper  C  Sub sc ript  s um 
Baseline equals upper C Subscript pA Baseline plus upper C Subscript pB Baseline plus upper C Subscript pC
uppe r C Su bs cri
pt RL Baseline equals upper C Subscript p 1 Baseline plus upper C Subscript p 2
where, the coefﬁcient kbuck is given by 
k Subs cr ipt buck
 Baseline equals upper C Subscript pB Baseline divided by upper C Subscript sum
As the voltages of DFW and Lf have the same AC component [4], the ENS of the 
buck converter can also be written as 
v Sub sc ript ENS
 Baseline equals k Subscript buck Baseline v Subscript upper L f
10.2 
The CM Current Reduction of Both Sides in Buck 
Converters 
10.2.1 
Derivation of the CM Noise Cancellation Method 
According to Fig. 10.3b, to eliminate the CM currents iCM_in and iCM_out, two voltage 
sources vCM1 and vCM2 are added, as shown in Fig. 10.4a. When vCM1 = vCM2 = 
vENS, the positive terminals of these voltage sources are equi-potential, so they can 
be shorted, and the circuit shown in Fig. 10.4a can be equivalently transformed into 
Fig. 10.4b. As seen, no excitation exists, and thus the CM currents iCM_in and iCM_out 
are both eliminated. 
Referring to Chap. 9, vCM1 and vCM2 can be are implemented by the CM windings 
coupled with the inductor Lf, as shown in Fig. 10.5. Since the added CM windings do 
not affect input and output voltages, the operation of the buck converter with coupled 
windings is identical to the original buck converter.
vCM1 
Csum 
vENS 
CRL 
25Ω 
PE 
vCM2 
Csum 
iCM_out 
CRL 
iCM_in 
25Ω 
PE 
(a) Adding two compensation voltage source       (b) The circuit with cancelled source 
Fig. 10.4 The principle of CM voltage reduction at both sides 

190
10
Reducing the Common-Mode Currents at the Input and Output Sides …
Q 
Vin
DFW 
Lf 
CpC
Cp2 
CpB
Cp1
CpA 
Cin 
*
* 
* 
* 
* 
WCM1
WCM2 
PE 
Co 
RLd 
Fig. 10.5 The realization of CM noise reduction at both sides 
Referring to Fig. 10.4a, the turns NCM of each winding in WCM1 and WCM2 are 
the same, which is equal to 
uppe r N Subscri
pt CM Baseline equals k Subscript buck Baseline upper N Subscript upper L f
where, NLf is the turns of inductor winding Lf. 
When the leakage inductance of the windings in WCM2 is negilible, the voltage of 
Co equals to the voltage of RLd. So, Co can be moved to be connected in parallel with 
RLd, as shown in Fig. 10.6a. Then, the inductor winding of Lf and the upside winding 
in WCM2 can be combined into a single one with (1–kbuck)NLf turns, as shown in 
Fig. 10.6b.
Furthermore, since the downside windings in Fig. 10.6b have the same turns, the 
dotted terminals in these two windings have the same electric potential, and thus these 
two dotted terminals can be connected together. By paralleling these two windings, 
one set of winding can be saved, and the simpliﬁed circuit is given in Fig. 10.6c. 
10.2.2 
Comparison of the Total Cross-Sectional Area 
of Windings 
For the original buck converter, by assuming that the current ripple of the ﬁlter 
inductor is small compared to its DC component Iout (the nominal load current), the 
root mean square (rms) value of the inductor current is very close to its DC value 
[5]. Therefore, the total cross-sectional area of the winding in Lf, which occupies the 
core window, can be expressed as 
upper A Subscript upper W normal bar upper L f Baseline equals upper N Subscript upper L f Baseline upper I Subscript out Baseline divided by upper Jt
where, J is the current density. As seen, AW_Lf is proportional to the ampere-turns of 
Lf.

10.2 The CM Current Reduction of Both Sides in Buck Converters
191
Q 
Vin 
Co 
Lf 
Cp2 
Cp1 
Cin 
*
* 
* 
* 
* 
WCM1
WCM2 
PE 
RLd
DFW 
CpC 
CpB
CpA 
Q 
Vin 
Co 
Lf 
Cp2 
Cp1 
Cin 
*
* 
*
* 
WCM1 
PE 
WCM2 
RLd
DFW 
CpC 
CpB
CpA 
(a) Moving Co to the right side                             (b) Merging two winding at high side 
Cin 
B 
Q 
Cp2 
CpB
Cp1 
*
* 
* 
CpA 
Co
CpC 
PE 
A 
C 
iout 
iin 
ignd 
Win 
Wgnd 
Wout 
PG 
Vin
RLd 
DFW 
(c) The buck converter with coupled windings 
Fig. 10.6 The simpliﬁcation of Fig. 10.5
For the buck converter with coupled windings in Fig. 10.6c, the total cross-
sectional area (AWin, AWgnd and AWout) of each winding (Win, Wgnd and Wout) is  
also proportional to each ampere-turns, yields 
upper  A  Subscript Win 
Baseline equals k Subscript buck Baseline upper N Subscript upper L f Baseline upper I Subscript in Baseline divided by upper J
upper A Subscript Wgnd Ba seline
 equals k Subscript buck Baseline upper N Subscript upper L f Baseline left parenthesis upper I Subscript out Baseline minus upper I Subscript in Baseline right parenthesis divided by upper J
upper A Sub sc ript Wout Baseline equals left parenthesis 1 minus k Subscript buck Baseline right parenthesis upper N Subscript upper L f Baseline upper I Subscript out Baseline divided by upper Jt
where, Iin is the input DC current of the converter. 
According to (10.8)–(10.10), since the total ampere-turns of the coupled windings 
are equal to that of Lf, the total cross-sectional area of windings keeps the same. 
For a better understanding, Fig. 10.7 shows an intuitive demonstration for the 
relationship between the buck converter and the buck converter with coupled 
windings.
Firstly, the inductor winding in Fig. 10.7a is split into two coupled windings 
by dividing the turns, as shown in Fig. 10.7b, where, the ampere-turns of Wout 
and Wig are (1–kbuck)NLfIout and kbuckNLfIout, respectively. Secondly, Wig is split 
into two paralleled windings Win and Wgnd by dividing the cross-sectional area, as 
shown in Fig. 10.7c, where, the ampere-turns of Win and Wgnd are kbuckNLfIin and 
kbuckNLf(Iout − Iin), respectively.

192
10
Reducing the Common-Mode Currents at the Input and Output Sides …
Cin 
Q 
Co 
Lf 
PG 
Vin
RLd
DFW 
Cin 
Q 
Co 
PG 
Vin
RLd
DFW 
* Wout 
* 
Wig 
(a) Buck converter                             (b) Spliting the inductor winding 
Cin 
Q 
* 
* 
* 
Co 
Win 
Wgnd 
Wout 
PG 
Vin 
RLd 
DFW 
iDFW 
Cin 
Q 
* 
* 
* 
Co 
Win 
Wgnd 
Wout 
PG 
Vin 
RLd 
DFW 
(c) Spliting the downside winding              (d) Removing the wire between Cin and Win 
Fig. 10.7 The demonstration of the buck converter with coupled windings
Referring to Fig. 10.7c, since Win and Wgnd have the same voltage, either the wire 
between Cin and Win or the wire between Cin and Wgnd can be open. Since iDFW is a 
pulsating current, the coupled winding should not be connected in series with DFW 
due to the leakage inductance of Wgnd. Therefore, the wire between Cin and Win can 
be open, as shown in Fig. 10.7d. Finally, to make the input and output share the same 
ground, Win can be moved to the positive terminal of V in, which is the buck converter 
with coupled windings in Fig. 10.6c. As seen in Fig. 10.7, the ampere-turns of the 
inductor winding of buck converter is essentially split, so this method is named as the 
split-winding (SW) method, and the converter is the SW buck converter. 
10.3 
The Balance Condition Considering Imperfect 
Coupling 
For the SW buck converter in Fig. 10.6c, three windings are coupled and their 
coupling would not be perfect in practical applications. As a result, the CM noise 
reduction can be inﬂuenced. In this section, the effect of imperfect coupling is 
discussed. 
To derive the CM noise model for Fig. 10.6c, the circuit with substituted sources 
is given in Fig. 10.8a. By simplifying the circuit in Fig. 10.8a, the resultant circuit 
is given in Fig. 10.8b, where, Wig is the parallel of Win and Wgnd. As long as the 
bridge in the middle is balanced, the CM currents at the input and output sides are 
zero accordingly.

10.3 The Balance Condition Considering Imperfect Coupling
193
B 
*
* 
* 
A 
C 
iout
iin 
ignd 
Win 
Wgnd 
Wout 
PG 
PE 
CRL 
iQ 
vDFW 
25Ω 
PE 
CpC 
CpB
CpA 
B 
* 
*
A 
Wig
Wout 
Win//Wgnd 
CpB
CpA+CpC 
CRL
25Ω 
PE 
iCM_in
iCM_out
Mig-o 
vDFW 
(a) The equivalent circuit with substituted sources                      (b) The simplified circuit 
B
A 
CD1
CpA+CpC 
CRL
25Ω 
PE 
iCM_in
iCM_out 
Lig
Lout 
Mig-o 
‒Mig-o 
Mig-o 
vDFW 
(c) The decoupled CM noise model 
Fig. 10.8 Split-winding buck converter considering practical coupling 
To derive the balance condition for the circuit in Fig. 10.8b, the windings Wig and 
Wout are decoupled, and the circuit is given in Fig. 10.8c. The balance condition is 
StartFraction upper C Subscript pB Baseline Over upper C Subscript pA Baseline plus upper C Subscript pC Baseline EndFraction equals StartFraction upper L Subscript ig Baseline plus upper M Subscript ig hyphen o Baseline Over upper L Subscript out Baseline plus upper M Subscript ig hyphen o Baseline EndFraction
Star tF ract
io n up pe r C Subscript pB Baseline Over upper C Subscript pA Baseline plus upper C Subscript pC Baseline EndFraction equals StartFraction upper L Subscript ig Baseline plus upper M Subscript ig hyphen o Baseline Over upper L Subscript out Baseline plus upper M Subscript ig hyphen o Baseline EndFraction
Start Fr action
 upper C Subscript pB Baseline Over upper C Subscript pA Baseline plus upper C Subscript pC Baseline EndFraction equals StartFraction upper L Subscript ig Baseline plus upper M Subscript ig hyphen o Baseline Over upper L Subscript out Baseline plus upper M Subscript ig hyphen o Baseline EndFraction
where, Lig and Lout are the self inductance of Wig and Wout, respectively, and Mig-o 
is the mutual inductance between Wig and Wout. 
In practical applications, CpA and CpB are formed between the switches and the 
heatsink, and they are typically larger than CpC, so  CpA and CpB are dominant and CpC 
is treated as 0. In addition, the same type of insulation material with equal thickness 
is normally used between the switches and the heatsink, so CpA and CpB are nearly 
equal. According to (10.4), when CpA = CpB, the coefﬁcient kbuck is equal to 0.5, 
and the turns of Win, Wgnd and Wout are equal. 
For a compact design of magnetic component in the SW buck converter, Win, 
Wgnd and Wout should be wound in the same core to achieve tight coupling. As a 
result, the self inductance Lig and Lout and the mutual inductance Mig-o are nearly 
the same. By substituting CpA = CpB, CpC = 0 and Lig = Lout = Mig-o into (10.11), 
the balance condition for reducing the CM noise is satisﬁed, so extra capacitors are 
not required to achieve balance.

194
10
Reducing the Common-Mode Currents at the Input and Output Sides …
10.4 
Applications in Other Non-isolated DC-DC Converters 
In this section, the application of the SW method in other non-isolated DC-DC 
converters is given below. The SW boost converter can be directly derived from 
the SW buck converter, since their power ﬂow direction is reversed to each other. 
Figure 10.9a shows the SW boost converter, where, the winding turns of Win, Wgnd 
and Wout are listed in Table 10.1, NLb is the turns of original boost inductor winding, 
and the coefﬁcient kbst is the same as (10.4). 
For other non-isolated DC-DC converters, the circuit using the SW method are 
listed in Fig. 10.9b–e, and the winding turns of Win, Wgnd and Wout are listed in 
Table 10.1. 
For the SW buck-boost converter shown in Fig. 10.9b, the added CM windings 
cannot be combined with the winding of Lb. As a result, the total ampere-turns of 
the coupled windings are increased, and the total cross-sectional area of the coupled 
windings is larger than that of Lb in the original buck-boost converter.
Co 
B 
Q 
Db 
RLd 
CpB 
*
* 
* 
CpA 
CpC 
PE 
A 
C 
PG 
Vin 
iout
iin 
ignd 
Win 
Wgnd 
Wout 
Cin 
Q 
Db 
RLd 
CpB 
* 
* 
* 
CpA 
Co 
CpC 
PE 
PG 
* 
Lb 
Vin 
iout
iin 
ignd 
Win 
Wgnd 
Wout 
(a) Boost converter                                    (b) Buck/Boost converter 
Q 
RLd 
CpA 
* 
* 
Co
CpC 
PE 
PG 
* 
D 
L2 
C1 
CpB
CpD 
Vin 
iout 
iin 
ignd 
Win 
Wgnd 
Wout 
Q 
RLd 
* 
* 
Co 
PE 
PG 
* 
D 
L2 
C1 
Vin 
iout 
iin 
ignd 
Win 
Wgnd 
Wout
CpA 
CpC 
CpB
CpD 
(c) Cuk converter                                            (d) SEPIC converter 
Cin 
Q 
RLd 
CpB 
* 
* 
CpD 
Co 
CpC 
PE 
PG 
* 
L1 
C1 
D 
CpA 
Vin 
iout
iin 
ignd 
Win 
Wgnd 
Wout 
(e) Zeta converter 
Fig. 10.9 Application of the SW conﬁguration in basic non-isolated DC-DC converters

10.5 Experimental Veriﬁcation
195
Table 10.1 Winding turns in basic non-isolated DC-DC converters and their SW ones 
Topology
Inductor 
and its 
winding 
turns 
The SW converter 
Win
Wgnd
Wout
Coefﬁcient 
Buck
Lf: NLf
kbuckNLf
kbuckNLf
(1–kbuck)NLf 
StartLayout 1st R
o
w k Subscript buck Baseline comma k Subscript bst Baseline comma k Subscript bb Baseline 2nd Row equals StartFraction upper C Subscript pB Baseline Over upper C Subscript pA Baseline plus upper C Subscript pB Baseline plus upper C Subscript pC Baseline EndFraction EndLayout
Star tL ayou t 1st Row k Subscript buck Baseline comma k Subscript bst Baseline comma k Subscript bb Baseline 2nd Row equals StartFraction upper C Subscript pB Baseline Over upper C Subscript pA Baseline plus upper C Subscript pB Baseline plus upper C Subscript pC Baseline EndFraction EndLayout
Boost
Lb: NLb 
(1–kbst)NLb
kbstNLb
kbstNLb 
Buck-boost Lb: NLb
kbbNLb
kbbNLb
kbbNLb 
Cuk
L1: NL1 
(1–kCuk)NL1
kCukNL1
kCukNL1
StartLayout 1st Row 
k
 Sub sc ript Cuk Baseline comma k Subscript SEPIC Baseline comma k Subscript Zeta Baseline 2nd Row equals StartFraction upper C Subscript pA Baseline plus upper C Subscript pB Baseline Over upper C Subscript pA Baseline plus upper C Subscript pB Baseline plus upper C Subscript pC Baseline plus upper C Subscript pD Baseline EndFraction EndLayout
Star tL ayou t 1st Ro w k Subscript Cuk Baseline comma k Subscript SEPIC Baseline comma k Subscript Zeta Baseline 2nd Row equals StartFraction upper C Subscript pA Baseline plus upper C Subscript pB Baseline Over upper C Subscript pA Baseline plus upper C Subscript pB Baseline plus upper C Subscript pC Baseline plus upper C Subscript pD Baseline EndFraction EndLayout
SEPIC
L1: NL1 
(1–kSEPIC)NL1 
kSEPICNL1 
kSEPICNL1 
Zeta
L1: NL2
kZetaNL2
kZetaNL2
(1–kZeta)NL2
For the SW Cuk converter shown in Fig. 10.9c, since the average current in Wgnd 
is larger than the input current, the total ampere-turns of the coupled windings are 
increased, and the total cross-sectional area of the coupled winding is also larger 
than that of L1 in the original Cuk converter. 
For the SW SEPIC converter shown in Fig. 10.9d, the winding of inductor L1 
near the input voltage source is split into coupled windings Win, Wgnd and Wout. 
When the SW SEPIC converter operates in voltage step-up mode, we have Iin > Iout. 
Therefore, the total ampere-turns of the coupled windings are equal to that of L1, 
and the total cross-sectional area of the coupled windings is the same as that of L1 in 
the original SEPIC converter. However, when the SW SEPIC converter operates in 
voltage step-down mode, Iin < Iout, the total ampere-turns of the coupled windings 
are increased, and so does the total cross-sectional areas. 
For the Zeta converter, since its power ﬂow direction is reverse to that in the SEPIC 
converter, the SW Zeta converter is directly obtained by reversing the SW SEPIC 
converter, as shown in Fig. 10.9e. As the duality, for the SW Zeta converter working in 
voltage step-down mode, the total cross-sectional area of the coupled windings is the 
same as that of L2 in the original Zeta converter. For the SW Zeta converter working 
in voltage step-up mode, the total cross-sectional area of the coupled windings is 
increased. 
10.5 
Experimental Veriﬁcation 
To verify the effectiveness of the SW method, a buck converter and a SW buck 
converter are built, and the CM currents at the input and output sides are measured 
and compared. 
Figure 10.10a shows the SW buck converter prototype, and Fig. 10.10b, c show the 
inductor in the SW buck converter and the inductor in the buck converter, respectively. 
For a fair comparison, the buck converter and the SW buck converter use the printed

196
10
Reducing the Common-Mode Currents at the Input and Output Sides …
Cin 
Q1
Q2 
Co 
Win+Wgnd+Wout 
Win
Wgnd
Wout 
Lf 
(a) Buck converter prototype
 (b) SW inductor
(c) Original inductor 
Fig. 10.10 Photo of the prototype 
circuit board (PCB) with the same dimension. In these converters, synchronous recti-
ﬁcation is adopted to reduce the conduction loss, and the upper and bottom switches 
are Q1 and Q2, respectively. The switching frequency is 200 kHz. 
Table 10.2 lists the main circuit parameters and the parasitic capacitances of 
the buck converter, where, CpA and CpB are measured by the impedance analyzer 
(WAYNE KERR 6500B) at the test frequency of 100 kHz, and the switches are 
disconnected from the circuit during the measurement. 
For the magnetic component in the buck and SW buck converter, Table 10.3 lists 
the winding dimension and measured parameters. Single strand enameled wire is 
used for the windings in these inductors. The detailed arrangement and connection 
of the windings are shown in Fig. 10.11. The winding Win is connected between 
Cin(+) and V in(+), which are the positive terminals of Cin and V in, respectively. The 
winding Wgnd is placed between Cin(–) and V in(–), which are the negative terminals 
of Cin and V in, respectively. The winding Wout interconnects the source of Q1 and 
the positive terminal of Co, whose connection is the same as the inductor winding in 
the buck converter.
Figure 10.12 shows the operation waveforms of the SW buck converter, including 
the electric potential of the source of switch Q1, Q2 with respect to the power ground, 
and the current ﬂowing through the coupled windings. As seen in Fig. 10.13a, the 
current ﬂowing through Wout is identical to the inductor current in the buck converter. 
Moreover, the electric potential of the observed nodes are complementary, which 
enables the CM noise cancellation for the SW method.
Table 10.2 Main circuit parameters and parasitic capacitances of the buck converter 
Input voltage Vin
48 V
Input capacitance Cin
180 µF
Capacitance CpA
27 pF 
Output voltage Vo
12 V
Filter inductance Lf
25 µH
Capacitance CpB
27 pF 
Load resistance RL
1.5 Ω
Output capacitance Co
180 µF
Capacitance CpC
0 

10.5 Experimental Veriﬁcation
197
Table 10.3 Winding dimension and measured parameters of the inductors 
Original inductor
Split-winding inductor 
Win
Wgnd
Wout 
Turns
14
7
7
7 
Dimension (mm)
1.5
0.7
1.3
1.5 
Self inductance
25.16 µH
Paralleled (Wig): 6.54 µH 
6.52 µH 
Mutual inductance
Wig and Wout: 6.05  µH 
Weight
45 g
44 g 
Volume
27.3 × 19.3 × 21.6 mm (PQ 26/20 core) 
Wout
Wgnd 
Win 
Co (+) 
Q1 (source) 
Cin (‒) 
Cin (+) 
Vin (+) 
Vin (‒)
Co (+)
Q1 (source) 
(a) Split-winding inductor
(b) Single-winding inductor 
Fig. 10.11 The winding structures of split-winding and single-winding inductor
Time: 2μs/div 
iout: [5A/div] 
vQ1_S: [20V/div] 
vQ2_S: [20V/div] 
vQ1_S 
vQ2_S 
iout 
Fig. 10.12 The experimental waveforms of the SW buck converter

198
10
Reducing the Common-Mode Currents at the Input and Output Sides …
150k
1M
10M
30M 
Frequency (Hz) 
0 
40 
60 
80 
100 
CM noise  (dBμV) 
20 
Buck
SW buck 
Input side 
150k
1M
10M
30M 
Frequency (Hz) 
‒20 
0 
20 
40 
60 
CM noise (dBμA) 
Buck
SW buck 
Output side 
(a) CM noise spectra at the input side         (b) CM noise spectra at the output side 
Fig. 10.13 Comparison of the CM noise spectra for the buck and the SW buck converters 
In terms of the balance condition, according to the measured parasitic capaci-
tances in Table 10.2, the left term in (10.11) equals to 1. According to the measured 
inductances in Table 10.3, the right term in (10.11) is 1.0016. Therefore, the balance 
condition is nearly achieved, and extra capacitor for achieving balance is not required. 
Table 10.4 shows the measured ripple current, DC resistance, the total weight and 
the efﬁciency of two converters at full-load, as well as the calculated winding losses 
of each winding. The DC resistance is measured by a DC milliohm meter (RS PRO 
RM-805), and the winding losses are calculated based on the DC resistance and the 
DC current of each winding. The other losses for these two converters such as core 
loss, power semiconductor losses are the same, and it is not compared here. As seen, 
the total winding losses in the SW buck converter is around 0.1 W higher than that 
in the buck converter, so its efﬁciency is slightly lower than the buck converter. 
When measuring the CM currents, the heatsink is connected to the PE, LISN 
(EMCO 3825/2) is inserted in the input power cord, and two 50-Ω resistors are 
connected to the radio frequency (RF) output of the LISN for providing the speciﬁc 
impedance. In addition, two capacitors Cp1 and Cp2 (both equal to 20 pF) are 
connected between the positive terminal of the load and the PE, the negative terminal 
of the load and the PE, respectively. The input and output CM currents iCM_in and 
iCM_out are measured by high bandwidth current probes (Agilent 1147A), and their 
data are collected by a digital oscilloscope (Agilent MSO-X 3054A). The CM noise
Table 10.4 The measured current ripple, winding DC resistance and efﬁciency at full-load as well 
as the calculated winding loss 
Single-winding inductor
Split-winding inductor 
Win
Wgnd
Wout 
Current ripple (A)
2.00
1.30
0.70
2.00 
DC resistance (mΩ)
6.81
24.70
5.88
3.15 
Copper loss (mW)
406.92
106.86
197.80
191.65 
Efﬁciency (%)
92.57
92.37 

References
199
spectra are then calculated by fast Fourier transformation (FFT) algorithm. During 
the FFT calculation, a rectangular window with a time length of 100 µs is adopted. 
Figure 10.13 compares the CM noise spectrum of these two buck converters. The 
input side CM current iCM_in is converted into noise voltage spectrum [6, 7] in dBμV 
by taking into account the voltage across the 50-Ω equivalent resistance at the LISN 
side. 
As seen in Fig. 10.13a, when adopting the SW method, 10- to 20-dB reduction for 
the input side CM noise is achieved, so it is clear to help reduce the EMI ﬁlter size. In 
Fig. 10.13b, for the output side CM current, 10-dB reduction can be observed when 
adopting the SW method. Therefore, the effectiveness of the proposed SW method 
is veriﬁed. 
10.6 
Summary 
In this chapter, a split-winding (SW) method is proposed to reduce the common-mode 
(CM) currents in non-isolated DC-DC converters at both the input and output sides 
simultaneously. The SW method involves splitting and redistributing the inductor 
windings at the input, ground and output sides of the converter, in order to cancel 
the CM noise. Speciﬁcally, for the SW buck converter, SW boost converter, SW 
SEPIC converter operating in voltage step-up mode and SW Zeta converter operating 
in voltage step-down mode, the total cross-sectional areas of the windings remain 
the same as their original circuit. Considering imperfect coupling between the split 
windings, the balance condition is derived. The proposed SW method is veriﬁed by 
a 100-W buck converter, where 10- to 20-dB reduction for the CM noise at the input 
side is achieved, and 10-dB reduction for the CM noise at the output side is realized, 
demonstrating the effectiveness of the SW method. 
References 
1. EN 55022, Limits and methods of measurement of radio disturbance characteristics of 
information technology equipment, European: European Norm Standard (2006) 
2. S. Wang, P. Kong, F.C. Lee, Common mode noise reduction for boost converters using general 
balance technique. IEEE Trans. Power Electron. 22(4), 1410–1416 (2007) 
3. L. Xie, X. Ruan, Z. Ye, Equivalent noise source: An effective method for analyzing common 
mode noise in isolated power converters. IEEE Trans. Ind. Electron. 63(5), 2913–2924 (2016) 
4. D. Cochrane, D. Chen, D. Boroyevic, Passive cancellation of common-mode noise in power 
electronic circuits. IEEE Trans. Power Electron. 18(3), 756–763 (2003) 
5. R.W. Erickson, D. Maksimovi´c, Fundamentals of Power Electronics (Kluwer Academic, 
Norwell, Mass, 2001), pp. 107 and 806 
6. K. Oberdieck, J. Gossmann, A. Bubert, R.W. De Doncker, Common- and differential-mode 
separators including the FM-broadcasting band. PCIM Europe (2018) pp. 1–8 
7. J. Stahl, D. Kuebrich, A. Bucher, T. Duerbaum, Characterization of a modiﬁed LISN for effective 
separated measurements of common mode and differential mode EMI noise, in 2010 IEEE 
Energy Conversion Congress and Exposition (ECCE), Atlanta, GA, USA (2010), pp. 935–941

Chapter 11 
Reducing the Common-Mode Currents 
at the Input and Output Sides in DC-AC 
Inverter Systems 
11.1 
A Generalized CM Noise Model of Inverter Systems 
DC-AC inverters are widely applied in renewable energy generation, motor drive, 
and etc. Normally, the input and output of DC-AC inverters do not share the same 
ground, and the common-mode (CM) voltage of inverters causes the CM current. 
The CM current ﬂows between the CM impedance at the input and output sides, 
leading to the conducted electromagnetic interference (EMI) and leakage current in 
inverter systems. 
Figure 11.1 shows a single-phase photovoltanic (PV) inverter system with 
common-mode (CM) parasitic capacitances, where, Cin1 and Cin2 is the DC-link 
capacitors, Q1 ~ Q4 are the power switches, Lf is the output ﬁlter inductor, Cf is the 
output ﬁlter capacitor, Zline is the line impedance, vg is the grid voltage, and Zg is 
the grounding impedance. Besides, CPV is the parasitic capacitance between the PV 
panel and the protective earth (PE), Cp1 ~ Cp4 are the parasitic capacitance between 
the drain of Q1 ~ Q4 and the PE via the heatsink, respectively, Cp5 is the parasitic 
capacitance between the input voltage negative terminal and the PE. As the inverter 
generates CM voltage, the CM currents iCM_in and iCM_out at the input and output 
sides are created through the CM impedance, leading to the CM EMI.
Figure 11.2 shows a typical three-phase motor drive system with the CM parasitic 
capacitances, where, Cin1 and Cin2 are the DC-link capacitors, Q1 ~ Q6 are the power 
switches of the inverter, Cp is the parasitic capacitance between the input source 
and the PE. Besides, Cp1 ~ Cp6 are the parasitic capacitance between the drain of 
Q1 ~ Q6 and the PE via the heatsink, Cp7 is the parasitic capacitance between the 
input voltage negative terminal and the PE. Likewise, the inverter generates the CM 
voltage, and CM currents iCM_in and iCM_out at the input and output sides are created 
through the CM impedance, leading to the CM EMI.
© The Author(s), under exclusive license to Springer Nature Singapore Pte Ltd. 2024 
X. Ruan et al., Conducted Electromagnetic Interference in Power Converters: Modeling, 
Prediction and Reduction, CPSS Power Electronics Series, 
https://doi.org/10.1007/978-981-99-9295-9_11 
201

202
11
Reducing the Common-Mode Currents at the Input and Output Sides …
A
Cin1 
B 
Heatsink + chasis 
Q4 
Q2 
Q3 
Q1 
Cp3 
Cp1
Cp2 
Cp4
Cp5 
Lf
Zline 
Zline 
vg 
Zg 
PE 
CPV 
PV 
panel 
iCM_out 
iCM_in 
Cf
M 
Cin2 
Fig. 11.1 PV inverter system with CM parasitic capacitances
Cable 
Shield
Frame 
Motor 
Cp 
iCM_in 
U 
V 
W 
Heatsink + chasis 
Q6 
Q3 
Q2 
Q5 
Q4 
Q1 
Cp4 
Cp1 
Cp6 
Cp3 
Cp2 
Cp5 
Input 
source 
Cp7 
PE 
M 
Cin2 
Cin1 
iCM_out 
Fig. 11.2 Motor drive system with CM parasitic capacitances 
By summarizing the CM noise models in PV inverter [1] and motor drive [2] 
systems, a generalized CM noise model is developed [2], as given in Fig. 11.3, 
where, ZCM_in and ZCM_out are the equivalent CM impedance of the input and output 
side, respectively. The voltage source is the CM voltage vCM of the inverter that equals 
to the arithmetic average of the voltage across each phase-leg and the power ground. 
The capacitances Cp_in and Cp_out are related with the CM parasitic capacitances of 
the inverter. These parameters are given by 
St
ar
tL
ayou t Enla rg ed lef
t brac e 1st Ro w v Su bscr
ipt CM Ba seli ne  equ
als l eft parenthes
is v Subscript upper A Baseline plus v Subscript upper B Baseline right parenthesis divided by 2 2nd Row upper C Subscript p normal bar in Baseline equals upper C Subscript p 1 Baseline plus upper C Subscript p 2 Baseline plus upper C Subscript p 5 Baseline 3rd Row upper C Subscript p normal bar out Baseline equals upper C Subscript p 3 Baseline plus upper C Subscript p 4 Baseline EndLayout left parenthesis for single hyphen phase right parenthesis
St
ar
tL
ayou t Enla rg ed le ft bra
ce 1st  R ow v  S ubsc ri pt C M Base
line eq ua ls l ef t pa re nthe
sis v  Subscript u
pper U Baseline plus v Subscript upper V Baseline plus v Subscript upper W Baseline right parenthesis divided by 3 2nd Row upper C Subscript p normal bar in Baseline equals upper C Subscript p 1 Baseline plus upper C Subscript p 3 Baseline plus upper C Subscript p 5 Baseline plus upper C Subscript p 7 Baseline 3rd Row upper C Subscript p normal bar out Baseline equals upper C Subscript p 2 Baseline plus upper C Subscript p 4 Baseline plus upper C Subscript p 6 Baseline EndLayout left parenthesis for three hyphen phase right parenthesis
where, vA, vB, vU, vV and vW are the voltages between each midpoint and the negative 
terminal of the input voltage, respectively.

11.2 Derivation and Realization of the CM Voltage Cancellation Method
203
PE 
vCM 
ZCM_in 
Cp_in
Cp_out 
iCM_out
iCM_in 
ZCM_out 
Fig. 11.3 Generalized CM noise model for single-phase and three-phase inverter systems
11.2 
Derivation and Realization of the CM Voltage 
Cancellation Method 
11.2.1 
Derivation of the CM Voltage Cancellation Method 
Referring to Fig. 11.3, the network consisted of vCM, Cp_in and Cp_out with Δ-
connection can be equivalently transformed into Y-connection [3] by applying the 
generalized Thevenin’s theorem, as shown in Fig. 11.4a, where, Csum and kinv are 
expressed as 
upper  C  Subsc ri pt sum
 Baseline equals upper C Subscript p normal bar in Baseline plus upper C Subscript p normal bar out
k Sub sc ript inv Ba
seline equals upper C Subscript p normal bar out Baseline divided by upper C Subscript sum
As seen in (11.3) and (11.4), kinv is within (0, 1). 
According to Fig. 11.4a, for counteracting the effect of two voltage sources, two 
cancellation voltage sources vcom1 and vcom2 can be introduced, as shown in Fig. 11.4b. 
When iCM_in = iCM_out = 0, vcom1 and vcom2 are expected to be 
v Subs cr ipt com
 1 Baseline equals k Subscript inv Baseline v Subscript CM
v Subs cr ipt  c om 2 Bas
eline equals left parenthesis 1 minus k Subscript inv Baseline right parenthesis v Subscript CM
PE 
kinvvCM 
Csum 
iCM_out 
(1‒kinv)vCM 
iCM_in 
ZCM_in
ZCM_out 
iCM_in 
vcom1
vcom2 
PE 
Csum 
kinvvCM (1‒kinv)vCM 
iCM_out 
ZCM_in
ZCM_out 
(a)  The transformed equivalent circuit
(b)  The cancellation principle 
Fig. 11.4 The equivalent CM noise circuit and the principle of cancellation 

204
11
Reducing the Common-Mode Currents at the Input and Output Sides …
11.2.2 
Realization of the CM Voltage Cancellation Method 
According to (11.5) and (11.6), vcom1 and vcom2 are proportional to vCM. So, it is 
necessary to sense vCM, and inject vcom1 and vcom2 into the input and output sides of 
the inverter. Referring to Fig. 11.4b, Fig. 11.5 shows the principle of realizing the CM 
voltage cancellation (CMVC) method in inverter systems, where, the CM voltage 
sensing circuit senses vCM, and the compensation voltage injection circuit generates 
vcom1 and vcom2 and injected them into the input and output sides, respectively. 
Take the single-phase inverter system as an example, according to (11.1), the 
CM voltage vCM is equal to (vA + vB)/2. In order to obtain (vA + vB)/2, the ﬁlter 
inductor Lf is implemented with a symmetrical coupled inductor with equal turns, 
and the two coupled windings are placed at the upper and lower sides, respectively. 
The ﬁlter capacitor Cf is divided into two capacitors Cf1 and Cf2, and Cf1 = Cf2 = 
2Cf, as shown in Fig. 11.6. Thus, we have  vLf1 = vLf2 and vCf1 = vCf2. Owing to the 
symmetry, vMN is expressed as 
v Su bs cript MN Baseline equals StartFraction upper V Subscript in Baseline Over 2 EndFraction minus StartFraction left parenthesis v Subscript upper A Baseline plus v Subscript upper L f Baseline minus v Subscript upper C f 1 Baseline right parenthesis plus left parenthesis v Subscript upper B Baseline minus v Subscript upper L f Baseline plus v Subscript upper C f 2 Baseline right parenthesis Over 2 EndFraction equals StartFraction upper V Subscript in Baseline Over 2 EndFraction minus v Subscript CM
v Su bscr ip t MN  B aseline equa ls  Sta rt Fraction upper V Subscript in Baseline Over 2 EndFraction minus StartFraction left parenthesis v Subscript upper A Baseline plus v Subscript upper L f Baseline minus v Subscript upper C f 1 Baseline right parenthesis plus left parenthesis v Subscript upper B Baseline minus v Subscript upper L f Baseline plus v Subscript upper C f 2 Baseline right parenthesis Over 2 EndFraction equals StartFraction upper V Subscript in Baseline Over 2 EndFraction minus v Subscript CM
v
 S ubscript MN Baseline equals StartFraction upper V Subscript in Baseline Over 2 EndFraction minus StartFraction left parenthesis v Subscript upper A Baseline plus v Subscript upper L f Baseline minus v Subscript upper C f 1 Baseline right parenthesis plus left parenthesis v Subscript upper B Baseline minus v Subscript upper L f Baseline plus v Subscript upper C f 2 Baseline right parenthesis Over 2 EndFraction equals StartFraction upper V Subscript in Baseline Over 2 EndFraction minus v Subscript CM
v Su bsc
ript MN Baseline equals StartFraction upper V Subscript in Baseline Over 2 EndFraction minus StartFraction left parenthesis v Subscript upper A Baseline plus v Subscript upper L f Baseline minus v Subscript upper C f 1 Baseline right parenthesis plus left parenthesis v Subscript upper B Baseline minus v Subscript upper L f Baseline plus v Subscript upper C f 2 Baseline right parenthesis Over 2 EndFraction equals StartFraction upper V Subscript in Baseline Over 2 EndFraction minus v Subscript CM
where, V in is the input DC voltage. As seen, the AC component in vMN is –vCM, so  
vMN can be adopted to provide the CM voltage of the inverter. 
Figure 11.7 highlights the circuit realization which adopts the CM transformer 
(CMT) for injecting the compensation voltage [4–6]. The sensed voltage vMN is 
applied across the sensing windings ab of the CM transformer (CMT) T CM1 and
CM Voltage 
sensing circuit 
vCM 
Inverter
Input 
side 
Output 
side 
CVIC 
(vcom1) 
Compensation 
voltage injection 
circuit 2 (vcom2) 
Compensation 
voltage injection 
circuit 1 (vcom1) 
Fig. 11.5 The principle of realizing the CMVC method 
Fig. 11.6 The CM voltage 
sensing circuit for 
single-phase inverters 
vMN
+
‒ 
A
Cin1 
B 
Q4 
Q2 
Q3 
Q1 
Lf
M 
Cin2 
Cf1 
Cf2 
N 
vLf1 +
‒ 
+
‒ 
+ 
+vCf1 
vLf2 
‒ 
vA 
vB
_ 
‒ 
vCf2 

11.3 Practical Considerations for the CMVC Method in Inverter Systems
205
PE
Heatsink + chasis 
PV 
panel 
PG 
CPV 
Zline 
Zline 
Grid 
Zg 
2:1: … 1 
a
b
‒ 
VPV 
+ 
‒ 
a
b
 
vMN 
N0 
kinvN0 
TCM1 
+
‒ 
… 
+
vMN 
TCM2 
N0 
(1‒kinv)N0 
Lf 
Cf1 
Cf2 
Cin1 
Cin2 M
N
Inverter 
Fig. 11.7 The PV inverter system with CMT at both sides for CM current reduction 
T CM2, and the compensation voltage is induced across the injecting windings of T CM1 
and T CM2. Denoting the winding turns of ab in T CM1 and T CM2 as N0, according to 
(11.5) and (11.6), the turns of the injecting windings in T CM1 and T CM2 should be 
kinvN0 and (1–kinv)N0, respectively. For three-phase inverter systems, the realization 
of the CMVC method is similar, and it is not discussed here. 
11.3 
Practical Considerations for the CMVC Method 
in Inverter Systems 
In this Section, the practical considerations for the CMVC method are discussed. 
11.3.1 
Restriction of Input and Output Currents 
Since the injecting windings are inserted into the DC and AC sides, the proposed 
method is preferred in low-current applications. 
11.3.2 
Balancing Capacitor 
In (11.4), kinv is determined by the capacitance ratio. However, the parasitic capac-
itances take arbitrary value within a reasonable range. For making the turns kinvNab 
and (1 – kinv)Nab of two CMTs be an integer, a balancing capacitor could be added 
and connected in parallel with one of the parasitic capacitance. 
When power switches adopts discrete MOSFETs, the dominant CM parasitic 
capacitances are the ones between the drain of each MOSFET and the heatsink. 
As long as the same insulation material with equal thickness is inserted between 
each MOSFET and the heatsink, these parasitic capacitances are equal. According

206
11
Reducing the Common-Mode Currents at the Input and Output Sides …
Fig. 11.8 The parasitics of 
the CMT TCM1 
b
N0 
kinvN0 
Llk_s1 
Llk_s1 
Llk_p1 
a 
Lm1 
Cpri1 
to (11.1), (11.3) and (11.4), kinv is 0.5 regardless of the capacitance. When the CM 
voltage sensing winding ab takes even turns, the turns of injecting windings will be 
an integer, and balancing capacitor is not required. 
11.3.3 
The Inﬂuence of Parasitics in the CMT 
The CMT is a critical component for sensing and injecting the CM voltage, and its 
parasitics affect the CM current reduction at high frequencies. Figure 11.8 shows 
T CM1 with parasitics, where Lm1 is the magnetizing inductance, Cpri1 is the parasitic 
capacitance of the sensing winding, Llk_p1 and Llk_s1 are the leakage inductance of 
the sensing winding and the injecting windings, respectively. The leakage inductance 
between the injecting windings is neglected as they are tightly coupled. 
At high frequencies, the inﬂuence of Cpri1 and Llk_p1 is dominant, and the induced 
voltages of the injecting windings are no longer exactly proportional to vCM. In order 
to achieve a wide frequency range for reducing the CM currents, Cpri1 and Llk_p1 
should be kept small, and sandwiched winding structure is preferred to realize the 
CMT. 
11.3.4 
Comparison with Other Methods 
The passive ﬁlter, ﬂoating ﬁlter [7], active cancellation method [4] and the CMVC 
method in this chapter are compared in terms of their used components, bandwidth 
and noise attenuation, as shown in Table 11.1. The implementations for these existing 
methods are shown in Fig. 11.9. In Fig.  11.9a, for the passive ﬁlter approach, LCM1 
and LCM2 are the CM inductors at the input and output sides, Cy1 and Cy2 are the 
CM capacitors at the input and output sides respectively. For the ﬂoating ﬁlter in 
Fig. 11.9b, the CM capacitors Cy1 and Cy2 are connected to the midpoint of the 
DC-link capacitors, which aims to decouple the input and output CM current [7]. 
Figure 11.9c shows the implementation of active cancellation method, where, the CM 
voltage of the inverter is sensed and sent into a power ampliﬁer, and the compensation 
voltage, which equals to vCM, is injected into the output through a CMT to counteract 
the effect of the CM voltage of the inverter.

11.3 Practical Considerations for the CMVC Method in Inverter Systems
207
Table 11.1 Comparison between passive ﬁlter, ﬂoating ﬁlter, active cancellation and the CMVC 
methods 
Passive ﬁlter
Floating ﬁlter
Active 
cancellation 
CMVC method 
Components 
Active
0
0
2 power  
transistors 
0 
Passive 
2 CM  
inductors, 4 
CM capacitors 
2 CM  
inductors, 4 
CM capacitors 
1 CMT
2 CMTs  
Bandwidth
f L
f L is designed to be far lower than the switching frequency f s 
f H
f H is limited by the EPC of CM 
inductors and the ESL of CM 
capacitors 
f H is limited by the leakage 
inductance and parasitic capacitance 
of the CMT 
Noise 
attenuation 
ac side
If ZS and ZL are far lower than 
the impedance of CM inductors 
in Fig. 11.9a, b, strong 
attenuation of CM current can 
be achieved. Otherwise, the 
attenuation is not signiﬁcant 
Yes, strong
Yes, strong (40 dB for 
the experiment in this 
chapter) 
dc side
Yes, 
Medium (20 
dB in [4]) 
Inverter
Input 
side 
Output 
side 
PE 
LCM1
LCM2 
Cy1
Cy1 
PE 
Cy2
Cy2 
Inverter
Input 
side 
Output 
side 
LCM1
LCM2 
Cy1
Cy1 
Cy2
Cy2 
Cin1 
Cin2 
(a) Passive filter                                               (b) Floating filter 
vCM 
Inverter
Input 
side 
Output 
side 
CMT 
Power 
amplifier 
CM Voltage 
Sensing Circuit 
(c) Active cancellation 
Fig. 11.9 The implementations for the existing methods 
For these four methods, the effective frequency range is denoted as [ f L, f H]. 
The lower cut-off frequency f L for these methods is required to be much lower 
than the switching frequency, which can be realized by choosing proper parameters. 
The higher cut-off frequency f H of passive ﬁlter and ﬂoating ﬁlter is limited by the 
equivalent parallel capacitance (EPC) of the CM inductors and the equivalent series

208
11
Reducing the Common-Mode Currents at the Input and Output Sides …
inductance (ESL) of the CM capacitors. For the active and the CMVC method, f H is 
limited by the leakage inductance and parasitic capacitance of the CMT. 
Based on the experimental results in [4] and this chapter, the AC-side CM current 
is signiﬁcantly reduced by both methods. For the DC-side CM current, the active 
cancellation gives a reduction of 20 dB, and the CMVC method reaches a reduction 
of 40 dB. Because two CMTs are used in the CMVC method, the volume of passive 
components is larger than that in the active method. However, as the power transistors 
in the active cancellation method need cooling parts, the volumetric density for the 
inverter system with these two methods depends on the applications. 
For a fair comparison of the noise attenuation among the passive ﬁlter, ﬂoating 
ﬁlter and the CMVC method, the component volume of the CM inductors or CM 
transformers, which take up most of the volume in these methods, are kept the same. 
Therefore, the CM inductances of LCM1 and LCM2 in Fig. 11.9a,  b are  assumed to be  
equal to the magnetizing inductance of the CMT in Fig. 11.9c at the input and output 
side in the CMVC method, respectively. Because the noise attenuation of passive 
ﬁlter and ﬂoating ﬁlter is affected by the CM impedance of the source and the load, 
the noise attenuation of these methods varies with the situations: 
(1) If ZCM_in and ZCM_out are far lower than the impedance of LCM1 and LCM2, LCM1 
and LCM2 will sustain most of the CM voltage of the inverter, and the attenuation 
of passive ﬁlter or ﬂoating ﬁlter can be stronger than the CMVC method. 
(2) If ZCM_in and ZCM_out are close to or even larger than the impedance of LCM1 
and LCM2, the effect of LCM1 and LCM2 is not signiﬁcant, and the insertion loss 
of the passive ﬁlter or ﬂoating ﬁlter would be lower than the CMVC method. 
As a conclusion, compared to the passive ﬁlter, ﬂoating ﬁlter and active cancella-
tion, the CMVC method reduces the CM noise at both sides simultaneously regardless 
of the CM impedance of the source or the load. 
11.4 
Experimental Veriﬁcation 
To verify the CMVC method, a single-phase inverter with silicon-carbide (SiC) 
devides is built, and the CM currents at the DC and AC sides are measured and 
compared. 
11.4.1 
Speciﬁcations of the Prototype 
Figure 11.10 shows the single-phase inverter prototype and the output ﬁlter. The 
power switches Q1 ~ Q4 adopt SiC MOSFETs (CREE: C2M0040120D), and the 
output ﬁlter capacitor uses Cf1 and Cf2 in series. Figure 11.11 shows the measurement 
setup for the CM current. As seen, two capacitors C1 (C2) are connected between

11.4 Experimental Veriﬁcation
209
Fig. 11.10 Photo of the SiC 
inverter prototype 
M
N
 
DC-link 
capacitors 
DC input 
Driving 
signals 
Lf 
Cf1 
Cf2 
B 
A 
Heatsink 
AC output 
Fig. 11.11 Measurement 
setup for the CM current
iCM_in 
Heatsink + chasis
...
Inverter
TCM1 
a
b
 
a
b
 
C1
C2 
PE 
A 
B 
Lf 
Cf1 
Cf2 
M
N 
iCM_out 
TCM2 
the input power cords (loads) and the PE, serving as the CM impedances at the DC 
and AC sides. 
Table 11.2 lists the parameters and the CM parasitic capacitances of the inverter. 
The parasitic capacitance Cp between the drain of each MOSFET and the heatsink 
is measured by an impedance analyzer (WAYNE KERR 6500B) with MOSFETs 
disconnected from the inverter, and the test frequency is 100 kHz. 
Figure 11.12 shows the photo and winding structure of T CM1 and T CM2. Sand-
wiched winding structure is adopted to reduce the leakage inductance and equiva-
lent parasitic capacitance in parallel with the sensing winding of T CM1 and T CM2. 
Table 11.3 lists the parameters of the magnetic component Lf, T CM1 and T CM2. Since
Table 11.2 The main circuit parameters and the CM parasitic capacitances 
DC input voltage
400 V
DC-link capacitance
220 µF 
Load resistance
50 Ω
Filter inductance Lf
520 µH 
Nominal power
1 kW
Filter capacitance Cb
6.8 µF 
Output frequency
50 Hz
Parasitic capacitance Cp
38 pF 
Switching frequency
80 kHz
Input side capacitance C1
0.1 µF 
Modulation
Unipolar SPWM
Output side capacitance C2
1 nF  

210
11
Reducing the Common-Mode Currents at the Input and Output Sides …
Fig. 11.12 The CMT and its 
winding structure 
Sensing
Injecting 
Core
Insulation 
b
a 
… 
… 
…
… 
… 
… 
… 
… 
b a 
TCM1 
to DC source 
TCM2 
to load 
to inverter DC input 
to inverter output filter 
(a) Photo of the CMT
(b) Winding structure 
Table 11.3 The parameters of the magnetic components 
Lf
TCM1
TCM2 
Core
PQ 50/50
PQ 40/40 
Turns
22: 22
30: 15: 15 
Magnetizing ind
130 µH, 130 µH
3.13 mH
3.32 mH 
Primary leakage ind. Llk_p
1.30 µH
1.36 µH 
Secondary leakage ind. Llk_s
0.48 µH
0.46 µH 
Parasitic capacitance Cpri
27.4 pF
28.1 pF 
discrete MOSFFETs are used, the equivalent parasitic capacitance Cp_in and Cp_out 
are both equal to 2Cp (38 pF), and the turns ratio of T CM1 and T CM2 are both 2:1:1 
(kinv = 0.5) according to (11.4). 
To extract the leakage inductance and the parasitic capacitance of the CMT, the 
impedance curve of each winding in the CMT are measured. Based on the impedance 
curve, the calculated parameters are also listed in Table 11.3. The resonant frequency 
between Llk_p and Cpri of T CM1 and T CM2 is 26.67 MHz and 25.75 MHz, respectively. 
11.4.2 
The Veriﬁcation of the CMVC Method 
Figure 11.13 shows the measured voltages for the circuit in Fig. 11.11 at full-load, 
where, vCM is the measured CM voltage across points M and N, and the injected volt-
ages vTCM1 and vTCM2 are measured across the injection windings of T CM1 and T CM2, 
respectively. As seen, their waveforms are generally similar, and have amplitude ratio 
of 2:1:1 as expected.

11.4 Experimental Veriﬁcation
211
Fig. 11.13 The CM voltage 
of the inverter and the 
injected voltage from the 
CMT 
vCM: [200V/div] 
vTCM1: [100V/div] 
vTCM2: [100V/div] 
Time: [5μs/div] 
To verify the effectiveness of the CMVC method, iCM_in and iCM_out in Fig. 11.11 
are measured with high-bandwidth current probes (Agilent 1147A) under three cases, 
described as follows. 
Case I: The original case without T CM1 and T CM2; 
Case II: T CM1 and T CM2 are inserted with leaving their sensing windings ab open 
(T CM1 and T CM2 act as CM inductors); 
Case III: T CM1 and T CM2 are inserted with the connection according to Fig. 11.11 
(T CM1 and T CM2 act as the CMT in this case). 
Figure 11.14 shows the time-domain waveforms of the currents iCM_in and iCM_out 
under the aforementioned three cases. It is observed that the original case without 
the CM inductors or the CMVC method has the highest amplitude.
As show in Fig. 11.14a, for Case I, iCM_in and iCM_out are similar. According to 
the CM noise model in Fig. 11.3, ZCM_in and ZCM_out, which equal to the impedance 
of 2C1 and 2C2 in the experiment, are far smaller than the impedance of Cp_in and 
Cp_out. Therefore, Cp_in and Cp_out can be treated as open-circuit, and the simpliﬁed 
circuit indicates iCM_in = iCM_out. 
As shown in Fig. 11.14b, for Case II, where the CM inductors are inserted, the 
amplitude of iCM_in and iCM_out is signiﬁcantly reduced. However, the harmonic ampli-
tude in iCM_in and iCM_out at the switching frequency can still be observed, as high-
lighted in Fig. 11.14b. This is because the impedance of the CM inductors is small at 
the switching frequency, and the attenuation of iCM_in and iCM_out is not signiﬁcant. 
Figure 11.14c shows the measured results for Case III. As seen, iCM_in and iCM_out 
are further reduced with the CMVC method. Note that there are little spikes in iCM_in 
and iCM_out, because the parasitic capacitance between Q1 ~ Q4 and the PE is not 
exactly the same, and the CM noise cancellation is not perfect as expected. 
Figure 11.15 compares the CM current spectra of iCM_in and iCM_out under the three 
cases. The CM current data is collected by a digital oscilloscope (Agilent MSO-X 
3054A), and then sent to MATLAB for calculating the CM current spectra using fast 
Fourier transform (FFT) with rectangular window. Normally, the time length for the

212
11
Reducing the Common-Mode Currents at the Input and Output Sides …
Time: [5μs/div] 
vAB: [500V/div] 
iCM_in: [10A/div] 
iCM_out: [10A/div] 
Time: [5μs/div] 
vAB: [500V/div] 
iCM_in: [500mA/div] 
iCM_out: [500mA/div] 
(a) Original case
(b) With the CM inductors at both sides 
Time: [5μs/div] 
vAB: [500V/div] 
iCM_in: [200mA/div] 
iCM_out: [200mA/div] 
(c) With the CMT at both sides 
Fig. 11.14 Comparison of CM currents at the DC and AC sides in the time-domain
FFT should be 20 ms for covering a complete line cycle, but the calculated spectrum 
only ranges from 0 to 1.56 MHz due to limited sampling points of the oscilloscope. 
To observe the high frequency components, a 50-µs time length is adopted for the 
FFT to extend the higher frequency range, and the CM current data are recorded 
when the output voltage is crossing zero. 
20k
100k
1M
10M 30M 
f (Hz) 
‒120 
‒100 
‒80 
‒60 
‒40 
‒20 
20 
CM current spectrum (dBA) 
Original
w/ CM ind.
w/ CMT 
0 
20k
100k
1M
10M 30M 
‒120 
‒100 
‒80 
‒60 
‒40 
‒20 
20 
0 
f (Hz) 
CM current spectrum (dBA) 
Original
w/ CM ind.
w/ CMT 
(a) The CM current spectrum at the DC side
(b) The CM current spectrum at the AC side 
Fig. 11.15 Comparison of CM current spectra at DC and AC sides with a 50-µs time length

References
213
As seen in Fig. 11.15, the harmonic spectra of iCM_in and iCM_out for the original 
case (Case I) are the highest, and there are clear spikes at the switching harmonics. 
After inserting the CM inductors (Case II), the harmonic amplitude of iCM_in and 
iCM_out see a reduction at high frequencies. However, the harmonic amplitude around 
the switching frequency is still high, because the impedance of CM inductors is not 
sufﬁciently larger than that of C1 and C2. Finally, by applying the CMVC method 
(Case III), the spectra of iCM_in and iCM_out are further reduced. Compared to the 
original results, nearly 40-dB reduction from 20 kHz to 10 MHz is achieved by 
adopting the CMVC method. The higher cut-off frequency for effective cancellation 
is 10 MHz, which is nearly 1/3 of the resonant frequency between Llk_p and Cpri of 
T CM1 and T CM2. Thus, the proposed CMVC method is veriﬁed. 
11.5 
Summary 
In this chapter, the CMVC method for inverter systems is investigated, which reduces 
the CM currents at both the input and output side. The CMVC method for inverter 
system consists of the CM voltage sensing and injection circuits. For a single-phase 
inverter, the CMVC method requires a differentially coupled ﬁlter inductor and two 
capacitors for sensing the CM voltage, and two CM transformers for injecting the 
compensation voltage. A single-phase inverter prototype with silicon-carbide (SiC) 
devices is built in the lab, and the measured upper frequency for the CM current 
reduction is 10 MHz. By implementing the CMVC method, 40-dB reduction for 
the CM current spectra at both the input and output sides is achieved, verifying the 
effectiveness of the CMVC method in inverter systems. 
References 
1. H. Xiao, S. Xie, Leakage current analytical model and application in single-phase transformerless 
photovoltaic grid-connected inverter. IEEE Trans. Electromagn. Compat. 52(4), 902–913 (2010) 
2. S. Wang, Y.Y. Maillet, F. Wang, D. Broyevich, R. Burgos, Investigation of hybrid EMI ﬁlters for 
common-mode EMI suppression in a motor drive system. IEEE Trans. Power Electron. 25(4), 
1034–1045 (2010) 
3. M.F. Moad, Two-port networks with independent sources. Proc. IEEE 54(7), 1008–1009 (1966) 
4. S. Ogasawara, H. Ayano, H. Akagi, An active circuit for cancellation of common-mode voltage 
generated by a PWM inverter. IEEE Trans. Power Electron. 13(5), 835–841 (1998) 
5. M.M. Swamy, K. Yamada, T. Kume, Common mode current attenuation techniques for use with 
PWM drives. IEEE Trans. Power Electron. 16(2), 248–255 (2001) 
6. Y. Murai, T. Kubota, Y. Kawase, Leakage current reduction for a high-frequency carrier inverter 
feeding an induction motor. IEEE Trans. Ind. Appl. 28(4), 858–863 (1992) 
7. Y. Liu, Z. Mei, S. Jiang, W. Liang, Conducted common-mode electromagnetic interference 
suppression in the AC and DC sides of a grid-connected inverter. IET Power Electron. 13(13), 
2926–2934 (2020)

