MNRAS 431, 1528–1540 (2013)
doi:10.1093/mnras/stt260
Advance Access publication 2013 March 12
Bayesian approach to gravitational lens model selection: constraining H0
with a selected sample of strong lenses
I. Balm`es‹ and P. S. Corasaniti
CNRS, Laboratoire Univers et Th´eories (LUTh), UMR 8102 CNRS, Observatoire de Paris, Universit´e Paris Diderot, 5 Place Jules Janssen, F-92190 Meudon,
France
Accepted 2013 February 11. Received 2013 February 9; in original form 2012 June 25
ABSTRACT
Bayesian model selection methods provide a self-consistent probabilistic framework to test
the validity of competing scenarios given a set of data. We present a case study application
to strong gravitational lens parametric models. Our goal is to select a homogeneous lens
subsample suitable for cosmological parameter inference. To this end we apply a Bayes factor
analysis to a synthetic catalogue of 500 lenses with power-law potential and external shear.
For simplicity, we focus on double-image lenses (the largest fraction of lens in the simulated
sample) and select a subsample for which astrometry and time-delays provide strong evidence
for a simple power-law model description. Through a likelihood analysis we recover the input
value of the Hubble constant to within 3σ statistical uncertainty. We apply this methodology
to a sample of double-image-lensed quasars. In the case of B1600+434, SBS 1520+530 and
SDSS J1650+4251 the Bayes’ factor analysis favours a simple power-law model description
with high statistical signiﬁcance. Assuming a ﬂat  cold dark matter cosmology, the combined
likelihood data analysis of such systems gives the Hubble constant H0 = 76+15
−5 km s−1 Mpc−1
having marginalized over the lens model parameters, the cosmic matter density and consistently
propagated the observational errors on the angular position of the images. The next generation
of cosmic structure surveys will provide larger lens data sets and the method described here
can be particularly useful to select homogeneous lens subsamples adapted to perform unbiased
cosmological parameter inference.
Key words: gravitational lensing: strong – methods: statistical – cosmology: observations –
cosmology: theory.
1 INTRODUCTION
Strong gravitational lenses are powerful cosmological probes. The
distorted images of lensed background sources carry information
on the distribution of invisible matter in cosmic structures. Fur-
thermore, as light-rays from distant variable sources propagate
along differently distorted paths, time-delays between luminosity
variations of the source images test the underlying cosmological
expansion (for exhaustive review see Schneider, Ehlers & Falco
1991; Petters, Levine & Wambsganss 2001; Schneider, Kochanek
& Wambsganss 2006).
The use of lens time-delays as cosmic standard rulers was ini-
tially proposed by Refsdal (1964, 1966). To date time-delays have
been measured only in 21 lensed quasars out of the few hundreds
known strong lens systems. Despite the scarcity of observations,
lots of effort has been devoted to using these data to infer the value
of the Hubble constant, H0. This is because time-delays, differ-
ently from other standard cosmological tests, do not rely on local
calibration measurements, such as the distance ladder method (for
⋆E-mail: irene.balmes@obspm.fr
an alternative method see Chavez et al. 2012). In the next decade,
additional lens time-delay data will become available thanks to ob-
servational programmes such as the COSmological MOnitoring of
GRAvItational Lenses (COSMOGRAIL)1 project collaboration, as
well as the International Liquid Mirror Telescope (ILMT) project.2
Furthermore, the next generation of cosmic structure surveys such
as the Dark Energy Survey (DES), the Large Synoptic Telescope
(LSST) or the Euclid satellite mission will detect large sample of
strong lens systems for which time-delays can be accurately mea-
sured through follow-up observations. Time-delays from such data
sets will be particularly useful to infer cosmological constraints that
are complementary to those obtained from other cosmic probes (see
e.g. Coe & Moustakas 2009; Dobke et al. 2009; Paraﬁcz & Hjorth
2009; Oguri & Marshall 2010; Linder 2011).
Time-delay measurements are particularly challenging because
they require an intense monitoring of the lens system. However,
the main limitation to fully exploit the cosmological information
encoded in such data arises from the uncertainty on the lens mass
1 http://www.cosmograil.org
2 http://www.aeos.ulg.ac.be/LMT/index.php
C⃝2013 The Authors
Published by Oxford University Press on behalf of the Royal Astronomical Society
Downloaded from https://academic.oup.com/mnras/article/431/2/1528/1453433 by guest on 12 June 2023

Bayesian lens parametric model selection
1529
distribution as well as the presence of perturbing masses along the
line of sight. Because of this, several analyses have focused on
‘golden lenses’ (Press 1996; Williams & Schechter 1997). These
are systems for which there are a sufﬁcient number of observational
features (e.g. presence of arcs, multiple point-like images, ﬂux-ratio
measurements) such as to constrain the lens potential independently
of time-delays. For example, Wucknitz, Biggs & Browne (2004)
have studied the lens system B0218+357 and inferred H0 = 78 ±
6 km s−1 Mpc−1 for a ﬂat cold dark matter (CDM) model with cos-
mological constant (CDM) with mean matter density m = 0.3.
Suyu et al. (2010) have analysed the lens B1608+656 and for the
same cosmology they have obtained H0 = 70.6 ± 3.1 km s−1 Mpc−1.
Alternatively one can infer cosmological parameter constraints
using a statistical sample of lens time-delay measurements (see
e.g. Saha et al. 2006; Oguri 2007). Such an approach still requires
modelling the gravitational potential of each lens in the sample.
Nevertheless, one can hope that systematics due to individual mass
model uncertainties are averaged out. In such a case sample selection
effects can be the main source of error (Oguri, Keeton & Dalal
2005b; Oguri 2006).
Modelling the lens mass distribution can be distinguished in para-
metric (e.g. see Oguri et al. 2002; Keeton, Gaudi & Petters 2003;
Oguri 2007) and non-parametric (e.g. see Kochanek 1991; Saha &
Williams 1997; Warren & Dye 2003; Koopmans 2005; Suyu et al.
2009; Vegetti & Koopmans 2009) methods. The latter uses linear
inversion algorithms to constrain the lens potential directly from the
intensity images of the lens system, while the former uses the mea-
sured properties of the lens to constrain a parametrized form of the
lens potential. A third approach by Alard (2007, 2008) reconstructs
the lens potential as a perturbative expansion around the Einstein
ring of the lens system.
Non-parametric methods have been extensively used in a vast lit-
erature. As an example a non-parametric reconstruction algorithm
is implemented in Pixelens3 (Williams & Saha 2000), a numeri-
cal code commonly used for lens studies. Using this code Saha
et al. (2006) have found H0 = 72+8
−11 km s−1 Mpc−1 from a sample
of 10 time-delay lenses for a ﬂat CDM with m = 0.3. Recently
Paraﬁcz & Hjorth (2010) have performed the same analysis on an ex-
tended sample of 18 lenses and obtained H0 = 66+6
−4 km s−1 Mpc−1.
A statistical analysis of a sample of lensed quasars using a para-
metric approach has been performed by a number of authors. For
instance, assuming an isothermal lens potential Giovi & Amendola
(2001) have inferred limits on H0 for different cosmological models.
The analysis by Oguri (2007) has propagated the uncertainties in the
lens model parameters and found H0 = 70 ± 6 km s−1 Mpc−1 from
a sample of 16 lenses for a ﬂat CDM with m = 0.26. Whether
using non-parametric lens reconstruction algorithms or a paramet-
ric model a key aspect of these analyses is the assessment of what
constitutes a good description of the lens potential given the data.
Independently of the approach used, distinguishing between the
potentially inﬁnite number of possibilities has been mostly based
on χ2-statistics. However, parameter ﬁtting only establishes how
well a model reproduces the data for a given set of model parameter
values. Deciding whether one model is preferable over another is
a question of model selection rather than quality of parameter ﬁt.
In other words, which model has a higher probability of being the
correct model description of the observations? Do the data justify a
more complex description of the system (additional parameters)?
In the Bayesian statistical framework these questions are ad-
dressed by the analysis of the Bayesian evidence and the evalua-
3 www.qgd.uzh.ch/projects/pixelens/
tion of Bayes factor (Jeffreys 1961; MacKay 2003; Gregory 2005).
Bayesian model selection methods have already been applied to a
variety of problems in cosmology and astrophysics (e.g. see Jaffe
1996; Marshall, Hobson & Slosar 2003; Saini, Weller & Bridle
2004; Mukherjee, Parkinson & Liddle 2006a; Mukherjee et al.
2006b; Ford & Gregory 2007; Trotta 2007; Bassett, Corasaniti &
Kunz 2008; Cornish & Littenberg 2007; Gregory & Fischer 2010).
In the literature, the analysis of Bayes factors has been applied to
non-parametric lens reconstruction techniques (Suyu et al. 2006;
Vegetti & Koopmans 2009) as well as selecting complicated para-
metric lens models of galaxy clusters (Jullo 2007).
Here, we present a case study of the use of Bayes factors to con-
struct a homogeneous sample of double-lensed quasars to derive
bounds on H0. By homogeneous we mean a sample consisting of
lenses whose data, astrometry and time-delays of the images pro-
vide evidence for the same lens model description at the same level
of statistical signiﬁcance. Differently from previous statistical ap-
proaches we consistently propagate all observational uncertainties
on the posterior probabilities, including errors on the angular posi-
tion of the images, as well as marginalizing over nuisance model
parameters rather than assuming hard priors. The possibility of
selecting homogeneous lens data to infer cosmological parameter
constraints will become particularly important for future survey
programs which will detect a large number of strong gravitational
lenses. We argue that the use of Bayes factors provides a self-
consistent probabilistic method to build subsample of data which
are not dominated by astrophysical selection effects.
The paper is organized as follows. In Section 2 we review the
lens equations and the modelling of the gravitational lens potential,
while in Section 3 we discuss the Bayesian model selection. We
present the results of the lens model selection analysis on simulated
data in Section 4 and on real data in Section 5. In Section 6 we
describe the results of the cosmological parameter inference and
present our conclusions in Section 7.
2 GRAVITATIONAL LENSES
2.1 Lens equations
Here, we brieﬂy review the basic equations describing the formation
of images in strong gravitational lenses. We assume that the source
is lensed by an object that can be treated as a single-lens plane.
Let us consider an angular coordinate system centred on a lens
at redshift zl and a source with angular position β at redshift zs.
According to Fermat’s principle light-rays from the source follow
paths that extremize the arrival-time. Let t(θ, β) be the arrival-time
of rays observed at an angle θ. We can estimate this function by
considering the geodesics of photons connecting the source-lens
and the lens-observer planes, respectively. Two effects contribute to
the arrival-time, a geometrical term which accounts for the different
length of the lensed paths and a gravitational term due to the Shapiro
effect (for a detailed derivation e.g. see Blandford & Narayan 1986).
The geometrical contribution reads as
tgeom(θ, β) = 1 + zl
2
DlDs
cDls
(θ −β)2,
(1)
where c is the speed of light, while Dl, Ds and Dls are the angular
diameter distances between observer and lens, observer and source,
and lens and source, respectively; in the following, we note θ and
β the norms of θ and β. The gravitational term is given by
tgrav (θ, β) = −8π 1 + zl
c3
	(θ)
(2)
Downloaded from https://academic.oup.com/mnras/article/431/2/1528/1453433 by guest on 12 June 2023

1530
I. Balm`es and P. S. Corasaniti
where 	(θ) is a 2D gravitational potential generated by the pro-
jected surface mass density on the lens plane at the angular position
of the source, 
(θ), as given by the Poisson-like equation
▽2 	(θ) = G
(θ),
(3)
where G is the Newton gravitational constant. It is useful to in-
troduce the critical density 
c =
c2
4πG
Ds
D1Dls , the convergence κ =

/
c and the reduced potential ψ = 2	/(G
c) to write the total
arrival-time as
t(θ, β) = (1 + zl)DlDs
cDls
1
2(θ −β)2 −ψ(θ)

,
(4)
from which we can derive all relevant equations describing the
properties of the images.
Lens equation. Let us assume the source to be ﬁxed at the angular
location β, the arrival-time only depends on θ and images will form
at extrema of the arrival time corresponding to ▽t = 0. Using
equation (4) we obtain the lens equation
β = θ −▽ψ(θ).
(5)
Magniﬁcation. Gravitational lensing deforms the images of a
lensed source and since the luminosity per surface area is conserved,
images can appear magniﬁed or demagniﬁed. The amplitude of the
effect can be quantiﬁed by considering the relation between the
coordinates on the source plane and the lens one. Let
A ≡▽β = 1 −▽▽ψ
(6)
be the Jacobian matrix of the angular coordinate transformation;
this relation implies that a solid-angle element δβ2 of the source is
mapped to a solid-angle element of the image δθ2 by the inverse of
the determinant of ▽β. Hence, the magniﬁcation is given by
μ ≡δθ2
δβ2 =
1
detA.
(7)
Time-delay. Let us consider a double-image lensed source char-
acterized by a time-variable luminosity, the time-delay in the ap-
pearance of the luminosity variation between two images A and B
is given by
tAB = t(θA, β) −t(θB, β) = (1 + zl)DlDs
cDls
×
1
2(θA −β)2 −ψ(θA) −1
2(θB −β)2 + ψ(θB)

(8)
The position of the images, their relative ﬂux-ratios and time-
delays are the main observable features of a strong lens systems.
2.2 Lens models
Our goal is to select a homogeneous sample of simple lens systems
that can be easily observed in large sky surveys. For this reason we
focus on individual galaxies which lens distant quasar sources.
2.2.1 Power-law density proﬁle
The mass distribution of lens spiral and elliptical galaxies is well ap-
proximated by power-law density proﬁles (e.g. see Rusin, Kochanek
& Keeton 2003) for which the lens potential assumes the form
ψ(θ) =
b2
3 −n
 θ
b
3−n
,
(9)
where b is a deﬂection scale. The singular isothermal sphere (SIS)
model (Binney & Tremaine 1987) corresponds to n = 2, for which
b = 4πDlsσ 2/Ds, where σ is the velocity dispersion of the galaxy.
Measurements of galaxy density proﬁles indicate that the slope
parameter n is generally close to the isothermal value, though some
systems have revealed shallow proﬁles with n < 1 (e.g. see Salucci
et al. 2007). By computing the second derivative of equation (9)
with respect to θ we obtain the convergence:
κ(θ) = 2 −n
2
 θ
b
1−n
.
(10)
In the case of a double-image lens with point-like images located at
θA and θB, the deﬂection scale can be written as
b =

θA + θB
θ2−n
A
+ θ2−n
B

1
n−1
,
(11)
where we have used equation (5). For such a system the time-delay
between the two images is given by (Kochanek 2002)
tAB = (1 + zl)DlDs
cDls
×

(1 −⟨κ⟩)
1
2

θ2
B −θ2
A

+ θAθB log
 θA
θB

+
−2
	 θB
θA
[κ(θ) −⟨κ⟩] log
 θ
θB

θ dθ

(12)
where
⟨κ⟩=
2
θ2
B −θ2
A
	 θB
θA
κ(θ) θdθ
(13)
is the mean surface mass density in the ring between θA and θB.
The above formulae can be rewritten using equation (10):
tAB = (1 + zl)DlDs
cDls
 1
2 −⟨κ⟩2 −n
3 −n
 
θ2
B −θ2
A

+

bn−1 θ3−n
A
θ2
B −θ3−n
B
θ2
A
θ2
B −θ2
A
−(1 −⟨κ⟩)θAθB

ln θA
θB

(14)
and
⟨κ⟩= bn−1 θ3−n
B
−θ3−n
A
θ2
B + θ2
A
,
(15)
which explicitly depend on the lens model parameters.
Similarly we can write the ﬂux-ratios between images A and B in
terms of their angular positions and the parameters of the power-law
potential using equation (7). The ﬂux-ratio is given by
rAB ≡FA
FB
,
(16)
where
1
Fi
=


1 −
 θi
b
1−n 
1 −(2 −n)
 θi
b
1−n ,
(17)
with i = A, B. This accounts only for luminosity differences between
images due to lensing magniﬁcation. From equation (17) we can
see that ﬂux-ratio measurements can strongly constrain the lens
model parameters, thus in combination with time-delays such data
can reduce or break the mass-sheet degeneracy and lead to tighter
bounds on cosmological parameters.
Several sources of systematic errors currently limit the use of
ﬂux-ratio measurements. In fact, these can be affected by inhomo-
geneous dust extinction across the angular size of the lens system,
Downloaded from https://academic.oup.com/mnras/article/431/2/1528/1453433 by guest on 12 June 2023

Bayesian lens parametric model selection
1531
thus altering the contribution of the lens magniﬁcation encoded in
the ﬂux-ratio measurements. In principle dust effects can be taken
into account through colour analysis. On the other hand, rapidly
varying lensing effects can be a more important source of system-
atic uncertainty that remains hard to model. As shown by Schild
& Smith (1991) in the case of the double-image lens Q0957+561
ﬂux-ratios can vary over time. Fine variations on short time-scales
can be caused by microlensing of the structure of the lensed quasar,
while trends over longer periods are more indicative of the mass
spectrum of the lens galaxy.
Radio measurements of ﬂux-ratios are primarily affected by milli-
lensing events, while in the optical both milli-lensing and micro-
lensing cause ﬂux anomalies. In the latter case ﬂux-ratio estimates
from spectroscopic measurements may alleviate the systematic ef-
fect due to micro-lensing as recently pointed out by Sluse et al.
(2012).
Henceforth, it is not surprising that ﬂux-ratios can be an effective
probe of the lens mass distribution (e.g. see Goicoechea, Gil-Merino
& Ull´an 2005), but at the same time if unmodelled, ﬂux anomalies
introduce dominant systematic errors in the cosmological param-
eter inference. Overcoming these limitations requires a systematic
monitoring of the lens systems phased on the lens time-delay as well
as an accurate modelling of the lens inner structure. Such detailed
analyses are yet to be performed and are beyond the scope of our
work. Because of this cosmological constraints inferred in combi-
nation with ﬂux-ratio measurements should be taken with a grain
of salt. In Section 5.3 we will show results obtained by combining
time-delays with ﬂux-ratios only for illustrative purposes.
2.2.2 External shear
The presence of mass perturbators outside the lens system can di-
rectly alter the lens potential and introduce uncertainties in the
modelling of the lens potential. This is especially the case if a
single-lens galaxy is not isolated, rather is part of a group or a
cluster of galaxies where an external shear ﬁeld can deform the
monopole potential (equation 9). Such deformation can be mod-
elled by adding a quadrupole term and in polar angular coordinates
θ = (θ, φ) this reads as
ψshear(θ) = −1
2γ θ2 cos 2(φ −φγ ),
(18)
where γ is an amplitude parameter which measures the strength of
the external shear and φγ its direction. Observational constraints
on the external shear have been mainly inferred from the study of
multiple image lenses. As an example, a number of studies of indi-
vidual quadruple lens systems have shown that the shear amplitude
is rather large, γ ≈0.1–0.3 (Fischer, Schade & Barrientos 1998;
Kneib, Cohen & Hjorth 2000). In contrast, earlier expectations were
in the range ∼0.02–0.05 (Keeton, Kochanek & Seljak 1997). Using
results from N-body simulations in combination with semi-analytic
models of galaxy formation Holder & Schechter (2003) have shown
that the distribution of values of γ is nearly-Gaussian with a peak
at γ ≈0.1 and a rapid decay for γ > 0.2. On the other hand Wong
et al. (2011) have performed an accurate study of nine lens systems
in galaxy groups and clusters which indicates that on average γ =
0.08, with a distribution ranging from 0.02 to 0.17.
Accounting for the effect of external shear as described by equa-
tion (18) adds two parameters to the lens model. Consequently,
equations (14)–(17) are modiﬁed by terms which explicitly depend
on the external shear parameters. Such terms can be computed ana-
lytically using equation (18); their derivation is quite cumbersome
and we leave it to Appendix A. An important aspect of the pres-
ence of external shear concerns the geometrical conﬁguration of the
images. In particular the angular separation of the images AB =
φB −φA, the asymmetry RAB ≡|(θB −θA)/(θB + θA)| and the
deviation from collinearity ϵ = |AB −180|/180 are indicators of
perturbations about a monopole-like lens potential. As an example,
Schneider et al. (2006) have shown that the time-delays have little
sensitivity to the quadrupole term if the images are opposite to each
other with respect to the lens position. Similarly, Oguri (2007) has
shown that for image pairs with an asymmetry parameter RAB >
0.2 the time-delay is not signiﬁcantly inﬂuenced by an external
shear, a third-order external perturbation or the presence of dark
matter subhaloes. In contrast, for such systems the time-delay is
more sensitive to the radial slope of the potential (which quantiﬁes
the deviation from isothermality), which appears to be the case es-
pecially for image pairs with a wide angular separation. This offers
a ﬁrst empirical criterion to select a homogeneous lens sample.
In addition to external shear, a non-spherical lens mass distri-
bution can lead to a non-trivial angular dependence of the lens
potential that contributes to the time-delay. If unmodelled this also
introduces a systematic error altering the cosmological parameter
inference. In the case of lenses with images lying opposite to each
other the contribution from this internal shear appears only as a
second-order correction to the time-delay (Kochanek 2002). This
suggests that in general the presence of internal shear should not be
neglected.
3 BAYESIAN STATISTICAL ANALYSIS
Our goal is to use Bayesian model selection to construct a statis-
tically homogeneous sample of gravitational lenses from which to
infer cosmological constraints using time-delays. More speciﬁcally,
we aim to select lenses for which data provide strong evidence in
favour of a simple power-law model description and exclude with
high statistical signiﬁcance the presence of external shear which
might contribute to sample selection effects in single-lens galaxies.
Here we review the basic elements of Bayesian statistical analysis.
3.1 Model parameter estimation and error propagation
Let us consider a set of observations of a double-image lens D,
consisting of the angular position of the images θi (i = A, B), the
time-delay tAB (and eventually ﬂux-ratio rAB). We want to con-
strain a lens model M speciﬁed by a set of model parameters α. For
the time being let us assume hard priors on the cosmological pa-
rameters which determine the cosmic angular distances in equation
(8). The ﬁrst step of the data model comparison consists of inferring
the best-ﬁtting values of the lens model parameters as well as their
uncertainties expressed in terms of ‘credible intervals’. To this end
we promote the model parameters to random variables and use the
Bayes theorem to infer their posterior probability distribution of the
parameters given the data and the model M:
P(α | D, M) =
˜L(D | α, M)P(α | M)
P(D | M)
,
(19)
where ˜L(D | α, M) is the likelihood function, P(α | M) is the
prior parameter model probability and P(D | M) is the Bayesian
‘evidence’. Notice that the likelihood is not a probability distribution
in the parameters α, since it gives the probability of the data D for a
given value of the model parameters. In contrast, the evidence is the
probability of the observed data within the assumed model M and
appears as an overall normalization constant of the posterior. Hence,
Downloaded from https://academic.oup.com/mnras/article/431/2/1528/1453433 by guest on 12 June 2023

1532
I. Balm`es and P. S. Corasaniti
for parameter estimation purposes the evidence can be neglected
since we are interested in ﬁnding the maximum of the posterior
and the dispersion around it. This can be done by computing the
likelihood function, which for a set of independent data reads as
˜L(D | α, M) ≡e−χ2
2 = exp

−

i
[Di −Di
th(α)]2
2 σ 2
i

,
(20)
where σ i are the observational uncertainties and Di
th(α) are the
model predictions. However, notice that in our case, the position of
the images, θA and θB, plays the role of independent variables in
tAB and rAB, respectively. Since the measured angles are known
up to observational errors, it is important to propagate the angular
uncertainties as well. This can be consistently done in the Bayesian
framework. For a detailed discussion on the subject we refer to the
exhaustive article by D’Agostini (D’Agostini 2005).
Let us assume that the observed image positions, θA and θB, are
determined with Gaussian uncertainties σ A and σ B, respectively.
Let us indicate with A and B the true location of the images.
Then, we can propagate the uncertainty on the independent variables
by marginalizing the likelihood over the angular error distribution.
Assuming Gaussian errors this gives (for conciseness we drop the
dependence on M):
L(D | α) =
		
f (A, B) ˜L(D | A, B, α) dAdB,
(21)
with
f (A, B) = exp

−

A,B
(θi −i)2
2σ 2
i

,
(22)
where in the integrand we have explicated the dependence of the
likelihood ˜L on the position of the images. If the angles are precisely
measured, then equation (22) tends to a δ-Dirac and we recover the
standard likelihood expression (equation 20).
3.2 Bayesian model selection
Parameter estimation only provides us with information on the qual-
ity of ﬁt of a given model against the data. How do we choose
between competing models characterized by different model pa-
rameters? Preference solely based on the goodness of ﬁt as mea-
sured by the χ2 for the best-ﬁtting model parameter values leaves
us with partial information which is not consistently quantiﬁable
in a probabilistic manner. Even then, how do we discount for the
level of predictiveness of different models? More precisely, how
do we decide whether data justify the choice of a more complex
model M1 over one with a smaller number of free parameters M0,
while accounting for the extended prior parameter space of M1?
As stressed in Liddle et al. (2007), such a question is related to the
predictiveness of models rather than ‘simplicity/complexity’, since
the former is not necessarily related to the number of free parame-
ters. Parameter estimation does not address these questions, which
require a further step already built in the Bayesian approach.
Central object of the Bayesian model selection is the evidence,
P(D | M) =
	
dα L(D | α, M)P(α | M),
(23)
which gives the probability of the data given the model M. Using
the Bayes theorem we then have the probability of the model M
given the data,
P(M | D) ∝P(D | M)P(M),
(24)
where P(M) is the prior belief on the model. Thus, given two
competing models, M0 and M1, we can base our preference on the
ratio of the model probabilities given the same set of data
P(M0 | D)
P(M1 | D) = P(D | M0)
P(D | M1)
P(M0)
P(M1),
(25)
where the ratio
B01 = P(D | M0)
P(D | M1)
(26)
is the so-called ‘Bayes factor’ of M0 to M1. Supposing we have
the same prior belief on the two models, then the Bayes factor gives
us an estimate of the ratio of the model probabilities given the data.
Since the evidence sets up a tension between the quality of ﬁt of a
given model and its prior predictiveness, the Bayes factor accounts
for the different size of the prior parameter space of the competing
models.
Bayes factors provide us with a self-consistent probabilistic mea-
sure to select a sample of lenses for which the observational data
provide strong evidence in favour of a given model description.
For instance, a simple lens model is the isothermal sphere which
has no free parameters, M0 = {n = 2}. Using the Bayes factor
we can compare it to a more complex description such as the
power-law model with one free parameter M1 = {n}. In such a
case we say that M0 is nested in M1. Similarly, we can compare
the power-law model with one free parameter M0 = {n} to the case
in which a shear ﬁeld is included with two additional free parame-
ters M1 = {n, γ, φγ }. The additional presence of internal shear can
be included in a third nested model M2 and confronted against M0
and M1. For simplicity, we limit our current analysis to the latter
models only.
In order to assess the strength of evidence in favour of a model
M0, against a more complex one, M1, we use the Jeffreys scale
(Jeffreys 1961) as reported in Trotta (2007). To be as conservative
as possible, we select lenses for which ln B01 > 5 and exclude
those which provide strong evidence in favour of external shear,
i.e. ln B10 > 5. We also exclude lenses for which we consider the
model comparison to be inconclusive −5 < ln B01 < 5. Notice that
ln B01 = 5 corresponds to odds of 1 in about 150 in favour of M0.
The arrival of new data updates these odds, further improving our
knowledge of the lens system.
4 TESTING BAYESIAN MODEL SELECTION
In this section we perform a detailed analysis on a synthetic lens
catalogue to quantify the level of bias on the value of H0 inferred
from a Bayes factor selected subsample of simulated lenses. To be
as conservative as possible we consider lenses in the presence of
external shear. This allows us to test to which extent Bayes factors
can select those systems for which a simple power-law potential is
sufﬁcient to describe the simulated data and consequently evaluate
the systematic bias on the inferred value of H0.
4.1 Synthetic lens catalogue
We assume a ﬂat CDM model with m = 0.3 and a reduced
Hubble constant h = 0.72. Using the publicly available software
GRAVLENS (Keeton 2011) we generate a sample of 500 gravitational
lenses at zl = 0.5 with sources at zs = 1.8. A more realistic sim-
ulation would be to distribute lenses and sources over a range of
redshifts compatible with observations. However, this choice is not
Downloaded from https://academic.oup.com/mnras/article/431/2/1528/1453433 by guest on 12 June 2023

Bayesian lens parametric model selection
1533
relevant to the purpose of this analysis and for simplicity we assume
them to be at the same redshifts.
The synthetic catalogue is built by Monte Carlo generating a
distribution of values of n and γ drawn from Gaussian distributions
with n ∼N(2, 0.3) and γ ∼N(0.2, 0.1) consistently with current
observational constraints discussed in Section 2.2. The position of
sources is drawn from a uniform distribution in a Cartesian angular
map with coordinates −1 < x, y < 1. For simplicity we ﬁx b = 1.
For each simulated lens, GRAVLENS computes the number, position
and time-delay of the images. Out of 500 simulated lenses only
312 have more than one image. In particular, 280 lenses with two
or three images (double lenses) and 32 with four or ﬁve images
(quad lenses). For simplicity we limit our analysis to the double-
lens subsample, since quad lenses require an accurate modelling of
the lens angular structure which is essential to explain the formation
of four images. We assume a 10 per cent error on the time-delay,
rather higher than the current mean error, and neglect angular errors
on the image positions.
4.2 Model selection and systematic bias
Using the data in the reduced catalogue, we compute the likeli-
hood function ˜L over the prior lens parameter space of a sim-
ple power-law model M0 = {n} and one including external shear
M1 = {n, γ, φγ }, respectively. We assume uniform priors with n ∈
(1, 3) and γ ∈(0, 0.2). Then, we perform a numerical integration
to evaluate the Bayesian evidence of each model and compute the
Bayes factor, assuming a ﬁxed cosmology with h = 0.7. Given the
limited number of parameters we do not perform a Monte Carlo
sampling of the likelihood, rather we compute it on a ﬁne multi-
dimensional grid.
We select all lenses with ln B01 > 2.5. This gives us a sub-
sample, S0, consisting of 111 lenses for which image astrome-
try and time-delay provide strong evidence in favour of a simple
power-law model description. We deﬁne the remaining lenses as the
subsample S1.
In Fig. 1 is shown the distribution of value of γ (left-hand panel)
and n (right-hand panel) for S0 (solid red line) and the remaining
data set S1 (green dash line). As we can see the two subsamples
cover the same range of values, thus indicating that Bayes factors
are not systematically selecting lenses with particular slope proﬁles
or small external shear amplitude. This might seem at odd with
using the selected subsample S0 to perform an unbiased parameter
estimation using the simpler model M0. However, as extensively
discussed in related literature (e.g. see Mukherjee et al. 2006b),
what the Bayes factors do is to put a tension between the capacity
of the extended model M1 to better ﬁt the data and its larger prior
parameter volume relative to the simpler model. Hence, even though
the selected sample of lenses has non-vanishing shear, the data
(image astrometry and time-delay) do not justify the more complex
model because the gain in ﬁtting with external shear parameters is
minimal compared to the size of the enlarged prior parameter space.
The Bayes factors simply tell us that the simpler model M0 has to
be preferred as it does a better job at describing the data with a
smaller prior parameter space. By construction all simulated lenses
have external shear and not surprising more than half of them are
indeed discarded by the Bayes factor either as inconclusive or as
favouring model M1.
In Fig. 2 we plot the histogram of the values of RAB and ϵ for
S0 and S1, respectively. We may notice that in S0 the distribution
of values of RAB has a smaller scatter than for S1 with RAB >
0.35. Similarly, the distribution of values of ϵ for the subsample
S0 is narrower than S1 and limited to values with ϵ < 0.2. This
clearly indicates that the Bayes factor analysis has selected lenses
for which the angular conﬁguration of the images is characteris-
tics of double-lens system whose astrometry and time-delays are
less sensitive to external shear effect (e.g. see Oguri 2007), hence
successfully described by a simple model. Thus, the Bayes factors
automatically perform an empirical model selection based on the
structural properties of the lens systems.
We are now in a position to quantify the bias on the inferred
value of H0 from the selected lens subsample. Assuming model
M0 we run a likelihood analysis on S0, S1 and their combination
S0 + S1. The marginalized likelihoods on H0 are shown in Fig. 3.
From S0 we ﬁnd H0 = 75.94+1.5
−1.4 km s−1 Mpc−1, quite remarkably
this recovers the ﬁducial value H0 = 72 km s−1 Mpc−1 to within
3σ statistical uncertainty of the best-ﬁtting value, thus indicating a
systematic bias of ∼5 per cent. In contrast, the analysis of S1 gives
a highly biased value with H0 = 90.45+2.4
−2.1 km s−1 Mpc−1, while
the combined analysis gives H0 = 78.39 ± 1.5 km s−1 Mpc−1. In
principle, the residual ∼5 per cent systematic bias in S0 can be
reduced or possibly removed using additional lens measurements.
Figure 1. Histogram showing the distribution of simulated values of γ (left-hand panel) and n (right-hand panel) for the selected subsample S0 (solid red line)
and the remaining data set S1 (green dash line).
Downloaded from https://academic.oup.com/mnras/article/431/2/1528/1453433 by guest on 12 June 2023

1534
I. Balm`es and P. S. Corasaniti
Figure 2. Histogram showing the distribution of values of RAB (left-hand panel) and ϵ (right-hand panel) for the selected subsample S0 (solid red line) and
the rejected data set S1 (green dash line).
Figure 3. Marginalized likelihoods on H0 from the analysis of S0 (solid
red line), S1 (green dot line) and the entire sample S0 + S1 (dark blue dash
line), all with model M0. The dash–dotted light-blue line is obtained by
analysing the entire sample with model M1. This model is underconstrained
by time-delay and astrometry data only, hence it is not surprising that due
to the unbounded parameter degeneracies the inferred value of H0 strongly
differs from the ﬁducial one.
Here, we have limited to use time-delay and astrometry data only
to perform a proof of concept assuming simple lens toy models.
However, in a real setup, the availability of the stellar kinematic
measurements of the lens galaxy as well as high-resolution imaging
of the Einstein ring may provide additional constraints on the lens
mass distribution, thus reducing the internal lens model parameter
degeneracy, which can lead to a more accurate lens model selection
and consequently less biased results. In fact, the former provides
an independent estimate of the lens mass at a radius different from
that of the Einstein ring (Treu & Koopmans 2002; Treu et al. 2006),
while the thickness of the Einstein ring is a sensitive probe of the
density proﬁles (e.g. see Suyu et al. 2009). This is to say that the
residual systematic bias we have found from the analysis of the
simulated lenses is not inevitable in strong lens cosmography.
One may wonder whether analysing the entire data set using
model M1 may lead to less biased results given that the data have
been generated using such a model. However, we should remind
that model M1 is underconstrained using double lenses. This can
introduce very large parameter degeneracies and eventually strongly
bias the cosmological parameter inference. To this purpose we have
run a likelihood analysis of the whole sample S0 + S1 assuming
model M1. The marginalized likelihood on H0 is plotted in Fig.
3 (dash–dotted light-blue line) from which we obtain H0 = 44 ±
1.5 km s−1 Mpc−1. This shows how subtle the parameter inference
can be. In a real data set we will not know a priori whether external
shear is indeed present or not. Thus, given a set of data which we aim
to use to extract cosmological parameter information we are better
guided by Bayesian model selection than blindly adding parame-
ters to model the complexity behind the data. However, as already
stressed above we should not despair since additional constraints
from independent mass proxies may help reduce or break internal
model parameter degeneracies and consequently the robustness of
the lens model selection.
5 APPLICATION TO REAL LENS DATA
5.1 Data sample
Gravitational time-delays have been measured in 21 strong lens
systems. Out of this sample we only consider double-image lenses
in which a far distant quasar is lensed into two images by a fore-
ground galaxy. This reduces our initial data set to 12 lenses, whose
characteristics are quoted in Table 1. The object responsible for the
lensing has been unambiguously detected in all listed lenses. How-
ever, current observations do not provide clear indications whether
the lensing galaxies are part of a group/cluster or whether pertur-
bators are present along the line of sight. Thus, the presence of
external shear cannot be a priori excluded, potentially leading to
bias selection effects.
For each lens in the sample we compute the asymmetry RAB,
the angular separation AB and the deviation from collinearity ϵ
as indicators of perturbations about a monopole-like lens potential.
These are also given in Table 1, while in Table B1 in Appendix B
we report the astrometry.
5.2 Model parameter priors
We want to test whether the data listed in Table 1 provide
strong evidence for or against a simple power-law model, M0 =
{n}, or one which includes external shear, M1 = {n, γ, φγ }.
Downloaded from https://academic.oup.com/mnras/article/431/2/1528/1453433 by guest on 12 June 2023

Bayesian lens parametric model selection
1535
Table 1. Double-image lenses. zl and zs are the lens and source redshifts, respectively, θi are the angular position of the images relative to the lens
position in arcsec, t is the time-delay (in d) and Fi/Fj the ﬂux-ratios. Observational uncertainties are 1 σ errors. We also quote the derived values of the
asymmetry RAB, angular separation AB and deviation from collinearity ϵ.
Lens
Pair (i,j)
zl
zs
θi (arcsec)
θj (arcsec)
t = ti −tj
Fi
Fj
RAB
AB
ϵ
B0218+357a
BA
0.685
0.944
0.057 ± 0.004
0.280 ± 0.008
+10.5 ± 0.2
0.26 ± 0.005
0.66
205.6
0.14
B1600+434b
AB
0.414
1.589
1.14 ± 0.075
0.25 ± 0.074
−51.0 ± 2.0
1.75 ± 0.34
0.45
200.2
0.11
FBQ 0951+2635c
AB
0.260
1.246
0.886 ± 0.004
0.228 ± 0.008
−16.0 ± 2.0
3.15 ± 0.05
0.59
201.2
0.12
HE 1104−1805d
AB
0.729
2.319
1.099 ± 0.004
2.095 ± 0.008
+152.2 ± 3.0
2.84 ± 0.06
0.32
175.9
0.02
HE 2149−2745e
AB
0.603
2.033
1.354 ± 0.008
0.344 ± 0.012
−103.0 ± 12.0
4.0 ± 0.5
0.59
178.9
0.006
PKS 1830−211f
AB
0.89
2.507
0.67 ± 0.08
0.32 ± 0.08
−26 ± 5
1.03 ± 0.02
0.36
199.5
0.11
Q0142−100g
AB
0.49
2.719
1.855 ± 0.002
0.383 ± 0.005
−89 ± 11
6.3 ± 0.1
0.66
167.8
0.07
Q0957+561h
AB
0.36
1.413
5.220 ± 0.006
1.036 ± 0.11
−417.09 ± 0.07
1.35 ± 0.04
0.67
154.5
0.14
SBS 0909+532i
AB
0.830
1.377
0.415 ± 0.126
0.756 ± 0.152
+45.0 ± 5.5
0.32 ± 0.03
0.29
220.3
0.22
SBS 1520+530j
AB
0.717
1.855
1.207 ± 0.004
0.386 ± 0.008
−130.0 ± 3.0
2.9 ± 0.4
0.52
202.6
0.13
SDSS J1206+4332k
AB
0.748
1.789
1.870 ± 0.088
1.278 ± 0.097
−116 ± 5
0.74 ± 0.2
0.19
132.9
0.26
SDSS J1650+4251l
AB
0.577
1.547
0.872 ± 0.027
0.357 ± 0.042
−49.5 ± 1.9
6.2 ± 0.31
0.42
145.8
0.19
a Image positions from Leh´ar et al. (2000) computed relative to the lens centre as measured by York et al. (2005), lens and source redshifts from Browne
et al. (1993) and Cohen, Lawrence & Blandford (2003), respectively, time-delay from Biggs et al. (1999) and ﬂux-ratio from Wucknitz et al. (2004).
b Image positions and redshifts from Koopmans, de Bruyn & Jackson (1998), time-delay from Burud et al. (2000) and ﬂux-ratio from Dai & Kochanek
(2005).
c Image positions and redshifts as listed in Kochanek et al. (2008), time-delay from Jakobsson et al. (2005) and ﬂux-ratio from Shalyapin et al. (2009).
d Image positions and redshifts from Leh´ar et al. (2000), and time-delay and ﬂux-ratio from Poindexter et al. (2007).
e Image positions and redshifts as listed in Kochanek et al. (2008), and time-delay and ﬂux-ratio from Burud et al. (2002a).
f Image positions and redshifts from Meylan et al. (2005), time-delay from Lovell et al. (1998) and ﬂux-ratio from Courbin et al. (1998).
g Image positions and redshifts as listed in Kochanek et al. (2008), time-delay and ﬂux-ratio from Koptelova et al. (2012).
h Image positions and redshifts as listed in Kochanek et al. (2008), time-delay from Colley et al. (2003) and ﬂux-ratio from Haarsma et al. (1999).
i Image positions and redshifts as listed in Kochanek et al. (2008), time-delay from Ull´an et al. (2006) and ﬂux-ratio from Dai & Kochanek (2009).
j Image positions and redshifts as listed in Kochanek et al. (2008), time-delay from Burud et al. (2002b) and ﬂux-ratio from Auger et al. (2008).
k Image positions and redshifts as listed in Oguri et al. (2005a), and time-delay and ﬂux-ratio from Paraﬁcz, Hjorth & El´ıasd´ottir (2009).
l Image positions and redshifts as listed in Kochanek et al. (2008), and time-delay and ﬂux-ratio from Vuissoz et al. (2007).
Uninformative data cause the Bayes factors to depend on the size
of the assumed prior parameter space. To test for such dependence
we distinguish two different sets of priors for each lens model pa-
rameter.
To be as conservative as possible we assume a uniform ‘large
prior’ on the radial slope of the potential, n ∈(0, 3) and a uniform
‘small prior’ corresponding to n ∈(1, 3). The former includes shal-
low galaxy proﬁles (n < 1) such as those found in e.g. Salucci et al.
(2007), while the latter is limited to the cuspy proﬁles, including
the isothermal sphere, which are typical of CDM haloes. Similarly,
we assume ﬂat priors on γ and consider two prior intervals, γ ∈(0,
0.1) and γ ∈(0, 0.2), while the external shear orientation angle is
assumed φγ ∈(0, π).
In the evaluation of the Bayes factors we consider a ﬂat concor-
dance CDM model and assume for simplicity a value compati-
ble with 7-year Wilkinson Microwave Anisotropy Probe (WMAP)
(Larson et al. 2011) on the matter density, m = 0.27. In order
to test the dependence of the Bayes factors on the value of the
Hubble constant we assume three prior values: H0 = 65, 70.2 and
75 km s−1 Mpc−1, respectively.
5.3 Bayes factor analysis
The results of the numerical computation of the Bayes factors ob-
tained from the analysis of time-delays and image astrometry are
summarized in Fig. 4, while in Fig. 5 we show the results obtained
including ﬂux-ratio measurements. For each lens in the sample we
mark the value of log10B01 under different lens model parameter
priors and for values of the Hubble constant H0 = 65 (left-hand
panel), 70.2 (middle panel) and 75 km s−1Mpc−1 (right-hand panel),
respectively. The hatched areas correspond to values of the Bayes
factors for which the data provide strong evidence in favour of the
simple power-law description (ln B01 > 5), the presence of exter-
nal shear (ln B10 > 5). We assume the Bayes model comparison
to be inconclusive in the region −5 < ln B01 < 5 which is a very
conservative cut.
Let us focus on Fig. 4. First we can see that Bayes factors show no
variation for the large and small priors on n, except for Q0957+561.
On the other hand, most lenses exhibit prior dependence on γ ,
which can vary in strength with the cosmology. FBQ 0951+2635,
HE 2149−2745 and Q0957+561 are the only ones for which the
prior on γ seems to have no inﬂuence whatsoever. We may also
notice a weak dependence of the Bayes factors on the value of h. In
particular, B1600+434 and SDSS J1650+4251 have Bayes factor
which are clearly above our conservative cut for h = 0.702 and
h = 0.75, while these shift in the upper bound on the inconclusive
interval for h = 0.65. However, since the value of B01 is still rather
high, these lenses would pass a slightly less conservative cut even
in the worst case scenario of h = 0.65.
All lenses except HE 1104−1805 and Q0957+561 have Bayes
factors favouring M0, though they may lie in the inconclusive area.
Q0957+561 is the only lens clearly favouring model M1 in some
case. One ﬁnal remark concerns SBS 1520+530. Our analysis indi-
cates that the image position and the time-delay of this lens strongly
favour a simple power-law lens model without external shear. This
is not in contrast with observations of the lens properties by Auger
et al. (2008) who have shown the presence of galaxy groups at
nearby redshifts on the lens line of sight. It is plausible that mass
potential is centred on the lens (as suggested by the galaxy-groups
position relative to the lens) thus implying a negligible quadrupole
contribution. Hence, as discussed in Section 4 the extra parame-
ters from modelling the external shear may provide a minimal gain
Downloaded from https://academic.oup.com/mnras/article/431/2/1528/1453433 by guest on 12 June 2023

1536
I. Balm`es and P. S. Corasaniti
Figure 4. Bayes factors for the sample of lenses listed in Table 1 and obtained from the analysis of the image positions and time-delays for different lens
model parameter priors and assuming a hard prior on the reduced Hubble parameter with h = 0.65 (left-hand panel), h = 0.702 (middle panel) and h = 0.75
(right-hand panel).
Figure 5. As in Fig. 4 including information from ﬂux-ratio measurements.
in ﬁtting the data and in such a case the Bayes factor favours the
simpler model description. Furthermore, Auger et al. (2008) ﬁnd
that the system can be well ﬁtted by a nearly isothermal density
proﬁle.
In Fig. 5, we plot the Bayes factors obtained from time-delays and
ﬂux-ratio measurements. As we can see including ﬂux-ratios shifts
the Bayes factors of several lens systems in the range which strongly
favours the presence of external shear. However, it is possible that
the extra parameters of model M1 ﬁt unmodelled systematics af-
fecting the ﬂux-ratios rather than the effects of an external shear
ﬁeld. As already mentioned in Section 2.2, current observations
already indicate that dust extinction as well as microlensing and
substructure alter the ﬂux-ratios. Since we are far from being able
to quantitatively account for such contaminations, it is premature to
infer any conclusion based on these data.
In the light of the analysis of Bayes factors inferred from po-
sition of the lens images and time-delays we select B1600+434,
SBS 1520+530 and SDSS J1650+4251 out of the initial lens sam-
ple. These are the only lenses which pass our selection criterion
independently of the model parameter priors with the power-law
model strongly favoured over that including external shear with
odds of more than 150 to 1. In the next section we will present
the constraints on H0 obtained from the likelihood analysis of these
lenses.
Downloaded from https://academic.oup.com/mnras/article/431/2/1528/1453433 by guest on 12 June 2023

Bayesian lens parametric model selection
1537
6 COSMOLOGICAL PARAMETER INFERENCE
Using the image positions and time-delays of B1600+434, SBS
1520+530 and SDSS J1650+4251, we perform a likelihood anal-
ysis to infer constraints on H0 after marginalizing over the angular
errors of the image locations, the slope of the power-law model of
each lens ni and the matter density m. We assume ﬂat priors on
1 < n < 3 and 30 < H0 (km s−1 Mpc−1) < 150. For each lens we
compute the likelihood function L(ni, m, H0) as given by equation
(21). We illustrate the parameter degeneracies for B1600+434; in
Figs 6 and 7 we plot the 1σ and 2σ marginalized contours in the
planes m −n and H0 −n, respectively. We can see that there is
no correlation between n and m for such data set, while a more
pronounced degeneracy is present between n and H0, as was already
pointed in Suyu (2012). Introducing a prior on m does not change
the likelihood contour signiﬁcantly, as there is little degeneracy
between m and either n or H0.
In Fig. 8 we plot the 1D marginalized likelihoods in the prior
interval of n for each of the lenses obtained assuming a Gaussian
prior on m = 0.266 ± 0.029 consistent with 7-year WMAP results
(Larson et al. 2011). We can see that data can only provide a lower
limit on the value of the slope of the lens potential, n ≳1.5. Similarly,
in Fig. 9 we plot the marginalized likelihoods of H0 for each lens.
We may notice that the likelihoods peak around nearly the same
value of H0 and have a large dispersion around the maximum value.
The combined constraints on H0 are inferred by computing the
total likelihood sample:
L(m, H0) =

i
	
L(ni, m, H0) P(ni) dni,
(27)
Figure 6. Marginalized 1σ and 2σ contours in the m −n plane without
WMAP prior for B1600−434.
Figure 7. As in Fig. 6 for the H0 −n plane without WMAP prior.
Figure 8. L(n | m, H0)/Lmax for each of the selected lenses.
Figure 9. L(H0 | m, n)/Lmax for each of the selected lenses.
where the sum is over the likelihood of each lens weighted by
P(ni) the uniform prior in the interval 1 < ni < 3. Hence, we do
not assume a hard prior on n at the best-ﬁtting value of each lens,
rather we impose the model and propagate its parameter uncertain-
ties by marginalizing the likelihood over them. In Fig. 10 we plot
the 1σ and 2σ contours in the m −H0 plane (left-hand panel)
and the 1D marginalized likelihood for H0 (right-hand panel) with
and without 7-year WMAP prior. As we can see, time-delays are
mostly insensitive to m. The average and standard deviation val-
ues are H0 = 76+15
−5 km s−1 Mpc−1 and H0 = 78+15
−5 km s−1 Mpc−1
without and with 7-year WMAP prior, respectively. Notice that the
marginalized likelihood is non-Gaussian and strongly skewed to-
wards small values of H0. Thus, the average values differ from
the maximum ones which are at H0 = 85 km s−1 Mpc−1 and H0 =
88 km s−1 Mpc−1 without and with 7-year WMAP prior, respec-
tively.
It is worth highlighting that, while on the observational sample,
about a quarter (three out of 12) of the lenses are selected through
our analysis, in the simulated sample this ratio is higher than a
third (111 out of 280), which seems to indicate that observational
samples are more contaminated than our simulated sample, leading
to possibly higher bias if the whole sample is used to measure H0.
7 CONCLUSIONS
In this study we have used Bayesian model selection techniques to
determine the lens mass model which given the data has the highest
probability to describe a strong gravitational lens system. Rather
than modelling a lens in all its complexity, our goal is to focus
on selecting a model whose parameters can signiﬁcantly inﬂuence
the time-delay such as to infer unbiased cosmological constraints
when averaging individual mass model parameter uncertainties on
Downloaded from https://academic.oup.com/mnras/article/431/2/1528/1453433 by guest on 12 June 2023

1538
I. Balm`es and P. S. Corasaniti
Figure 10. Top panel: 1σ and 2σ contours m −H0 plane from the com-
bined analysis of the selected lens sample. Bottom panel: L(H0)/Lmax for
the same sample.
a homogeneous lens sample. To this end we have focused on double
lenses and used Bayes factor statistics to select a sample of lenses
that can be described by a power-law model without external shear.
We have tested this approach on a simulated sample of 500 lenses.
The likelihood analysis of the selected subsample assuming no
external shear recovers the ﬁducial value of the Hubble constant
with 3σ statistical uncertainty, thus a systematic selection bias is no
greater than ∼5 per cent. On the other hand, since the more complex
model including external shear parameter is underconstrained using
double lenses, the likelihood analysis results in strongly biased
results due to the marginalized effects of large lens model parameter
degeneracies. Therefore, a given set of data should not be brute force
analysed assuming the model capable of accounting for the maximal
complexity. Rather, performing a Bayes factor analysis may provide
a more effective guide to data model selection.
The application to a sample of observed lenses indicates that out
of the initial data set, nine have Bayes factors favouring a simple
power-law lens model, though six of them lie in the ‘inconclusive’
interval and do not pass our conservative cut. These are B0218+357,
FBQ 0951+2635, HE 2149−2745, PKS 1830−211, Q0142−100
and SBS 0909+532. It is possible that more accurate time-delay
measurements will update their Bayes factor value and give us a
better knowledge of the appropriate lens model description. We
have performed the same analysis including information from lens
ﬂux-ratio measurements. In such a case, the Bayes factors indicate
that external shear must be taken into account for most of the lenses.
However, several sources of astrophysical systematic errors may af-
fect the ﬂux-ratios such as dust extinction and microlensing events
that do not reﬂect the lensing magniﬁcation caused by the lens mass
distribution responsible for the images and time-delays. Indeed,
uncontaminated ﬂux-ratios will provide interesting additional con-
straint on the lens model. Nevertheless, it is worth reminding that
time-delays are less sensitive to substructure than ﬂux-ratios and
require a less complex modelling.
Here, we have restricted the analysis to double-lens systems.
Such systems have fewer constraints than quads; nevertheless the
advantage is that they can be described in terms of simpler models
with fewer parameters. This is not the case for quad lenses in which
the quadrupole structure induces an internal shear that needs to be
taken into account to correctly describe the lens time-delay. The
lens reconstruction technique described in Alard (2007, 2008) and
adapted in Habara & Yamamoto (2011) could be particularly useful
in this case especially in combination with the Bayesian selection
approach described here to determine the order of the perturbative
lens reconstruction. Though such technique may present difﬁculties
since in most cases we do not see arcs but only point-like images.
The number of known lensed quasars which are potentially good
targets for time-delay measurements is currently of the order of
100. In the future such data set will increase thanks to numerous
survey programs. The use of the Bayesian model selection we have
discussed can provide large homogeneous subsample of lenses that
are suitable for unbiased cosmological parameter inference. In par-
ticular, along the line of Parkinson & Liddle (2010), using Markov
Monte Carlo Chain techniques one could perform a Bayesian model
averaging of cosmological parameters over homogeneous subsam-
ples of lenses each described by a class of lens models.
ACKNOWLEDGEMENTS
We thank A.R. Liddle, D. Sluse, J. Wambsganss, C.R. Keeton and
S.H. Suyu for their valuable comments and the anonymous referee
who has helped us to improve and enrich the content of this paper.
IB is supported by a scholarship of the ‘Minist`ere de l’´Education
Nationale, de la Recherche et de la Technologie’ (MENRT). The
research leading to these results has received funding from the
European Research Council under the European Community’s Sev-
enth Framework Programme (FP7/2007-2013 Grant Agreement no.
279954).
REFERENCES
Alard C., 2007, MNRAS, 382, L58
Alard C., 2008, MNRAS, 388, 375
Auger M. W., Fassnacht C. D., Wong K. C., Thompson D., Matthews K.,
Soifer B. T., 2008, ApJ, 673, 778
Bassett B. A., Corasaniti P. S., Kunz M., 2004, ApJ, 617, L1
Biggs A. D., Browne I. W. A., Helbig P., Koopmans L. V. E., Wilkinson
P. N., Perley R. A., 1999, MNRAS, 304, 349
Binney J., Tremaine S., 1987, Galactic Dynamics. Princeton Univ. Press,
Princeton, NJ
Blandford R., Narayan R., 1986, ApJ, 310, 568
Browne I. W. A., Patnaik A. R., Walsh D., Wilkinson P. N., 1993, MNRAS,
263, L32
Burud I. et al., 2000, ApJ, 544, 117
Burud I. et al., 2002a, A&A, 383, 71
Burud I. et al., 2002b, A&A, 391, 481
Chavez R., Terlevich E., Terlevich R., Plionis M., Bresolin F., Basilakos S.,
Melnick J., 2012, MNRAS, 425, L56
Coe D., Moustakas L. A., 2009, ApJ, 706, 45
Cohen J. G., Lawrence C. R., Blandford R. D., 2003, ApJ, 583, 67
Colley W. N. et al., 2003, ApJ, 587, 71
Cornish N. J., Littenberg T. B., 2007, Phys. Rev. D, 76, 083006
Courbin F., Lidman C., Frye B. L., Magain P., Broadhurst T. J., Pahre
M. A., Djorgovski S. G., 1998, ApJ, 499, L119
D’Agostini G., 2005, preprint (arXiv:0511182)
Dai X., Kochanek C. S., 2005, ApJ, 625, 633
Dai X., Kochanek C. S., 2009, ApJ, 692, 677
Downloaded from https://academic.oup.com/mnras/article/431/2/1528/1453433 by guest on 12 June 2023

Bayesian lens parametric model selection
1539
Dobke B. M., King L. J., Fassnacht C. D., Auger M. W., 2009, MNRAS,
397, 311
Fischer P., Schade D., Barrientos L. F., 1998, ApJ, 503, L127
Ford E. B., Gregory P. C., 2007, in Babu J. G., Feigelson E. D., eds, ASP
Conf. Ser. Vol. 371, Statistical Challenges in Modern Astronomy IV.
Astron. Soc. Pac., San Francisco, p. 189
Giovi F., Amendola L., 2001, MNRAS, 325, 1097
Goicoechea L. J., Gil-Merino R., Ull´an A., 2005, MNRAS, 360, L60
Gregory P., 2005, Bayesian Logical Data Analysis for the Physical Sciences.
Cambridge Univ. Press, Cambridge
Gregory P. C., Fischer D. A., 2010, MNRAS, 403, 731
Haarsma D. B., Hewitt J. N., Lehar J., Burke B. F., 1999, ApJ, 510, 64
Habara Y., Yamamoto K., 2011, Int. J. Modern Phys. D, 20, 371
Holder G. P., Schechter P. L., 2003, ApJ, 589, 688
Jaffe A., 1996, ApJ, 471, 24
Jakobsson P., Hjorth J., Burud I., Letawe G., Lidman C., Courbin F., 2005,
A&A, 431, 103
Jeffreys H., 1961, Theory of Probability, 3rd edn. Oxford Univ. Press, Oxford
Jullo E., 2007, New J. Phys., 9, 447
Keeton C. R., 2011, Astrophysics Source Code Library 2003
Keeton C. R., Kochanek C. S., Seljak U., 1997, ApJ, 482, 604
Keeton C. R., Gaudi B. S., Petters A. O., 2003, ApJ, 598, 138
Kneib J., Cohen J. G., Hjorth J., 2000, ApJ, 544, L35
Kochanek C. S., 1991, ApJ, 373, 354
Kochanek C. S., 2002, ApJ, 578, 25
Kochanek C. S., Falco E. E., Impey C., Lehar J., McLeod B., Rix H.-W.,
2008, available at: http://www.cfa.harvard.edu/castles/
Koopmans L. V. E., 2005, MNRAS, 363, 1136
Koopmans L. V. E., de Bruyn A. G., Jackson N., 1998, MNRAS, 295, 534
Koptelova E. et al., 2012, A&A, 544, A51
Larson D. et al., 2011, ApJS, 192, 16
Leh´ar J. et al., 2000, ApJ, 536, 584
Liddle A. R., Corasaniti P. S., Kunz M., Mukherjee P., Parkinson D., Trotta
R., 2007, preprint (astro-ph/0703285)
Linder E., 2011, Phys. Rev. D, 84, 123529
Lovell J. E. J., Jauncey D. L., Reynolds J. E., Wieringa M. H., King E. A.,
Tzioumis A. K., McCulloch P. M., Edwards P. G., 1998, ApJ, 508, L51
MacKay D. J., 2003, Information Theory, Inference and Learning Algo-
rithms. Cambridge Univ. Press, Cambridge
Marshall P. J., Hobson M. P., Slosar A., 2003, MNRAS, 346, 489
Meylan G., Courbin F., Lidman C., Kneib J.-P., Tacconi-Garman L. E., 2005,
A&A, 438, 37
Mukherjee P., Parkinson D., Liddle A. R., 2006a, ApJ, 638, L51
Mukherjee P., Parkinson D., Corasaniti P. S., Liddle A. R., Kunz M., 2006b,
MNRAS, 369, 1725
Oguri M., 2006, MNRAS, 367, 1241
Oguri M., 2007, ApJ, 660, 1
Oguri M., Marshall P. J., 2010, MNRAS, 405, 2579
Oguri M., Taruya A., Suto Y., Turner E. L., 2002, ApJ, 568, 488
Oguri M. et al., 2005a, ApJ, 622, 106
Oguri M., Keeton C. R., Dalal N., 2005b, MNRAS, 364, 1451
Paraﬁcz D., Hjort J., 2009, A&A, 507, L49
Paraﬁcz D., Hjort J., 2010, ApJ, 712, 1378
Paraﬁcz D., Hjorth J., El´ıasd´ottir ´A., 2009, A&A, 449, 395
Parkinson D., Liddle A. R., 2011, Phys. Rev. D, 82, 103533
Petters A. O., Levine H., Wambsganss J., 2001, Singularity Theory and
Gravitational Lensing, Birkh¨auser, Boston
Poindexter S., Morgan N., Kochanek C. S., Falco E. E., 2007, ApJ, 660, 146
Press W. H., 1996, IAU Symp. 173: Astrophysical Applications of Gravita-
tional Lensing, Vol. 173, p. 407
Refsdal S., 1964, MNRAS, 128, 307
Refsdal S., 1966, MNRAS, 132, 101
Rusin D., Kochanek C. S., Keeton C. R., 2003, ApJ, 595, 29
Saha P., Williams L. L. R., 1997, MNRAS, 292, 148
Saha P., Coles J., Macci`o A. V., Williams L. L. R., 2006, ApJ, 650, L17
Saini T. D., Weller J., Bridle S. L., 2004, MNRAS, 348, 603
Salucci P., Lapi A., Tonini C., Gentile G., Yegorova I., Klein U., 2007,
MNRAS, 378, 41
Schild R. E., Smith R. C., 1991, AJ, 191, 813
Schneider P., Ehlers J., Falco E. E., 1991, Gravitational Lenses. Springer,
Berlin
Schneider P., Kochanek C., Wambsgnass J., 2006, in Meylan G., Jetzer P.,
North P., eds, Gravitational Lensing: Strong, Weak and Micro: Saas-Fee
Advanced Course. Springer, Berlin
Shalyapin V. N. et al., 2009, MNRAS, 397, 1982
Sluse D., Hutsem´ekers D., Courbin F., Meylan G., Wambsganss J., 2012,
A&A, 544, A62
Suyu S. H., 2012, MNRAS, 426, 868
Suyu S. H., Marshall P. J., Hobson M. P., Blandford R. D., 2006, MNRAS,
371, 983
Suyu S. H., Marshall P. J., Blandford R. D., Fassnacht C. D., Koopmans
L. V. E., McKean J. P., Treu T., 2009, ApJ, 691, 277S
Suyu S. H., Marshall P. J., Auger M. W., Hilbert S., Blandford R. D.,
Koopmans L. V. E., Fassnacht C. D., Treu T., 2010, ApJ, 711, 201
Treu T., Koopmans L. V. E., 2002, MNRAS, 337, L6
Treu T., Koopmans L. V. E., Bolton A. S., Burles S., Moustakas L. A., 2006,
ApJ, 640, 662
Trotta R., 2007, MNRAS, 378, 72
Ull´an A., Goicoechea L. J., Zheleznyak A. P., Koptelova E., Bruevich V. V.,
Akhunov T., Burkhonov O., 2006, A&A, 452, 25
Vegetti S., Koopmans L. V. E., 2009, MNRAS, 392, 945
Vuissoz C. et al., 2007, A&A, 464, 845
Warren S., Dye S., 2003, ApJ, 590, 673
Williams L. L. R., Saha P., 2000, ApJ, 119, 439
Williams L. L. R., Schechter P. L., 1997, Astron. Geophys., 38, 10
Wong K. C., Keeton C. R., Williams K. A., Momcheva I. G., Zabludoff
A. I., 2011, ApJ, 726, 84
Wucknitz O., Biggs A. D., Browne I. W. A., 2004, MNRAS, 349, 14
York T., Jackson N., Browne I. W. A., Wucknitz O., Skelton J. E., 2005,
MNRAS, 357, 124
APPENDIX A: MODEL WITH EXTERNAL
SHEAR
In this Appendix we present a derivation of the time-delay and
magniﬁcation equations, respectively, in the case of a power-law
potential with external shear. The latter reads as
ψ(θ) =
b2
3 −n
 θ
b
3−n
−γ θ2
2 cos 2(φ −φγ ).
(A1)
We can relate one of the model parameters to the remaining ones
using the lens equation, since both images are formed by the same
source at position β. This gives us the following equation:
|β(θA)|2 = |β(θB)|2
(A2)
which can be rewritten, using the lens equation β = θ −▽ψ(θ), as
a second-order equation in X = bn −1:
UX2 + 2V X + W = 0
(A3)
with
U = θ2(2−n)
A
−θ2(2−n)
B
(A4)
V = θ3−n
B
(1 + γ CB) −θ3−n
A
(1 + γ CA)
(A5)
W = θ2
A(1 + 2γ CA + γ 2) −θ2
B(1 + 2γ CB + γ 2)
(A6)
where CA, B = cos 2(φA, B −φγ ). Assuming that θA ≥θB and n > 1,
and using the usual notation  = V2 −UW we have the following
solutions: for  > 0
bn−1 = −V +
√

U
;
(A7)
Downloaded from https://academic.oup.com/mnras/article/431/2/1528/1453433 by guest on 12 June 2023

1540
I. Balm`es and P. S. Corasaniti
Table B1. Astrometry for all lenses used in the data analysis.
Lens
Object
α
δ
B0218+357
L
≡0
≡0
A
−0.250 ± 0.005
−0.125 ± 0.007
B
0.057 ± 0.006
0.001 ± 0.008
B1600+434
L
≡0 ± 0.05
≡0 ± 0.05
A
−0.33 ± 0.01
1.09 ± 0.01
B
0.07 ± 0.01
−0.24 ± 0.01
FBQ 0951+2635
L
0.760 ± 0.003
−0.455 ± 0.003
A
≡0
≡0
B
0.900 ± 0.003
−0.635 ± 0.003
HE 1104−1805
L
0.974 ± 0.003
−0.510 ± 0.004
A
≡0
≡0
B
2.901 ± 0.003
−1.332 ± 0.003
HE 2149−2745
L
0.714 ± 0.007
1.150 ± 0.005
A
≡0
≡0
B
0.890 ± 0.003
1.446 ± 0.003
PKS 1830−211
L
0.498 ± 0.004
−0.456 ± 0.004
A
≡0
≡0
B
0.649 ± 0.001
−0.724 ± 0.001
Q0142−100
L
1.764 ± 0.003
−0.574 ± 0.003
A
≡0
≡0
B
2.145 ± 0.003
−0.613 ± 0.003
Q0957+561
L
1.406 ± 0.006
−5.027 ± 0.005
A
≡0
≡0
B
1.229 ± 0.005
−6.048 ± 0.004
SBS 0909+532
L
0.415 ± 0.125
−0.004 ± 0.081
A
≡0
≡0
B
0.987 ± 0.003
−0.498 ± 0.003
SBS 1520+530
L
1.141 ± 0.003
−0.395 ± 0.003
A
≡0
≡0
B
1.429 ± 0.003
−0.652 ± 0.003
SDSS J1206+4332
L
−0.664 ± 0.137
1.748 ± 0.028
A
≡0 ± 0.011
≡0 ± 0.010
B
−0.098 ± 0.006
2.894 ± 0.009
SDSS J1650+4251
L
0.017 ± 0.032
−0.872 ± 0.026
A
≡0
≡0
B
0.223 ± 0.002
−1.163 ± 0.001
the solution bn−1 = −V −
√

U
is eliminated since it does not reduce to
the right value for γ = 0 (note however that it would be the correct
solution if n < 1). Note also that for n = 1, there is no parameter b
and this equation has no meaning; for  = 0, the solution is simply
bn−1 = −W
2V ,
(A8)
while for  < 0, there are no real solutions and the lens cannot be
described for this combination of n, γ and φγ . Having reduced the
number of lens model parameters the time delay between images A
and B can be computed using the value of tA and tB:
ti = (1 + zl)DlDs
Dls
1
2 | ▽ψ |2 +ψ(θi)

,
(A9)
where we have used the lens equation β −θi = −▽ψ(θi). In the
case of the magniﬁcation we have for each image:
μ−1
i
=

1 −
 θi
b
1−n 
1 −(2 −n)
 θi
b
1−n
(A10)
+ (1 −n)γ Ci
 θi
b
1−n
−γ 2,
(A11)
and the ﬂux-ratio is simply given by FAB = μA/μB.
APPENDIX B: LENS DATA ASTROMETRY
In Table B1 we report the astrometric data of the positions of images
(A, B) and lens (L) for all lenses used in the lens data analysis. The
references to the data are listed in Table 1.
This paper has been typeset from a TEX/LATEX ﬁle prepared by the author.
Downloaded from https://academic.oup.com/mnras/article/431/2/1528/1453433 by guest on 12 June 2023

