SPARSE CODING AND AN APPLICATION
TO TOPIC MODELS
By Ryan Wang‚àó
Sparse coding represents data as sparse linear combinations of
basis vectors from a learned dictionary. Algorithms for sparse coding
generally alternate between a coding step, which involves a regular-
ized least squares problem, and a dictionary learning step, which in-
volves a matrix factorization problem. In this paper we review some
recent theoretical work on the performance of procedures used for
solving these problems, such as the LASSO. We then present an appli-
cation to topic modeling, a set of techniques for analyzing collections
of text documents, and discuss some possible extensions that incor-
porate structured sparsity. Finally, we discuss experimental results
from applying a sparse coding topic model to a collection of papers
from the Neural Information Processing Systems (NIPS) conference.
1. Introduction.
Sparse coding provides a set of methods for repre-
senting data in terms of a set of basis vectors called a dictionary. In many
cases it is useful to have sparse representations in terms of the dictionary,
so that only a few elements from the dictionary make up any one represen-
tation. For example, sparse representations have been useful in applications
to high-dimensional data and signal processing. In sparse coding the dictio-
nary is simultaneously learned, in contrast to methods that use predeÔ¨Åned
dictionaries such as wavelet bases. In this paper we review some recent work
on aspects of sparse coding and present an application to topic modeling, a
widely used procedure for text analysis.
The general setup is as follows. A response vector yi ‚ààRm is represented
as a linear combination of basis vectors b1, ..., bp ‚ààRm with code vector
Œ∏i = (Œ∏1, ..., Œ∏n)T ‚ààRp, so that ÀÜyi = Pp
j=1 Œ∏ijbj. The problem is then to
minimize reconstruction error with some kind of sparsity inducing penalty.
For observations y1, ..., yn:
(1.1)
min{bj}p
j=1,{Œ∏i}n
i=1
1
2
n
X
i=1
||yi ‚àí
p
X
j=1
Œ∏ijbj||2
2 + œâ
n
X
i=1
œÜ(Œ∏i)
where the function œÜ(¬∑) induces sparsity in the coeÔ¨Écient vectors. The ‚Ñì0
pseudo-norm,
||Œ∏i||0 ‚âú#{j s.t. Œ∏ij Ã∏= 0}
‚àórywang@galton.uchicago.edu
1

2
and its convex relaxation the ‚Ñì1 norm,
||Œ∏i||1 ‚âú
p
X
j=1
|Œ∏ij|
are most common. We will focus on the ‚Ñì1 norm since it admits widely used
procedures for convex optimization.
The optimization problem in (1.1) also has a matrix representation, which
can be useful for applying matrix factorization methods. Let Y ‚ààRm√ón be
the matrix of stacked observation vectors, B ‚ààRm√óp the matrix of stacked
basis vectors, and Œò ‚ààRp√ón the matrix of stacked codes. Then the problem
becomes:
(1.2)
minB,Œò
1
2||Y ‚àíBŒò||2
F + œâ
n
X
j=1
œÜ(Œò¬∑j)
where || ¬∑ ||F denotes the Frobenius norm for matrices. It is typical to con-
strain the size of the columns of B in order to prevent the codes from be-
coming arbitrarily small. This constraint set often takes the form
C = {B ‚ààRm√óp : bT
j bj ‚â§1 for all j = 1, ..., p}.
In general (1.2) does not yield a jointly convex problem, even under an ‚Ñì1
penalty. However, it is convex with respect to B when Œò is Ô¨Åxed, and vice
versa, under an ‚Ñì1 penalty. Thus, the classical approach is to alternately
optimize with respect to each variable holding the other Ô¨Åxed. There has
not been much theoretical study on the properties of this procedure, though
we will brieÔ¨Çy discuss some results for each component.
The rest of the paper is organized as follows. Section 2 reviews some rel-
evant theoretical work on sparse estimation procedures. Section 3 describes
an original application of sparse coding to topic modeling. Section 4 presents
numerical experiments. Section 5 discusses some possible extensions.
2. Some Theoretical Results.
Results on the performance of sparse
estimation procedures often take the form of oracle inequalities. An oracle
inequality provides guarantees on the statistical performance of an estimator
in terms of its risk relative to an oracle estimator. The oracle represents
the best model within a given family of models and can be viewed as the
inÔ¨Ånite data estimator. Thus if an estimator has risk close to the oracle risk,
then the estimator performs well up to the error incurred from specifying
a particular family of models. We Ô¨Årst discuss oracle inequalities for an ‚Ñì1-
penalized sparse density estimator. In the case of regression, an equivalent

3
estimator for solving the ‚Ñì1-penalized least squares problem is known as
the least absolute shrinkage and selection operator (LASSO). This work
is relevant because the coding step directly corresponds to solving such a
problem.
2.1. SPADES.
Consider the following density estimation setup from [4].
Let X1, ..., Xn ‚ààRm be independent and identically distributed with density
f. Let {f1, ..., fp} be a given Ô¨Ånite set of functions with fj ‚ààL2(Rm) called
a dictionary. The unknown density f is modeled by linear combinations of
elements of the dictionary
(2.1)
fŒ∏(x) =
p
X
j=1
Œ∏jfj(x)
with coeÔ¨Écient vector Œ∏ = (Œ∏1, ..., Œ∏p) ‚ààRp. To induce sparsity in the coeÔ¨É-
cients, an ‚Ñì1-penalized criterion is minimized.
The SPADES (SPArse Density EStimation) estimator minimizes an em-
pirical counterpart of the squared loss. Noting that the inner product of
f, g ‚ààL2(Rm) corresponds to an expectation under f, the squared loss be-
comes
(2.2) ||f ‚àífŒ∏||2 = ||f||2 +||fŒ∏||2 ‚àí2 < f, fŒ∏ >= ||f||2 +||fŒ∏||2 ‚àí2E (fŒ∏(X)) .
Minimizing (2.2) with respect to Œ∏ corresponds to minimizing
(2.3)
Œ≥(Œ∏) = ‚àí2E (fŒ∏(X)) + ||fŒ∏||2.
Replacing the expectation by its empirical counterpart, 1
n
Pn
i=1 fŒ∏(Xi), and
adding an ‚Ñì1-penalty, œÜ(Œ∏) = œâ Pp
j=1 |Œ∏j|, the SPADES estimator is then
deÔ¨Åned by
ÀÜfSPADES = fÀÜŒ∏
where
(2.4)
ÀÜŒ∏ = argmin
Œ∏‚ààRp
Ô£±
Ô£≤
Ô£≥‚àí2
n
n
X
i=1
fŒ∏(Xi) + ||fŒ∏||2 + œâ
p
X
j=1
|Œ∏j|
Ô£º
Ô£Ω
Ô£æ.
2.1.1. General Oracle Inequality.
DeÔ¨Åne the noise level by
r(Œ¥) = r(p, n, Œ¥) =
r
log(p/Œ¥)
n

4
where 0 < Œ¥ < 1 is speciÔ¨Åed. Finally, deÔ¨Åne the intra-dictionary correlations
œÅ(i, j) = < fi, fj >
||fi||||fj||
for i, j = 1, ..., p. Under a condition on the ‚Äúmaximal local coherence‚Äù
œÅ(Œ∏) = max
i‚ààI(Œ∏)max
jÃ∏=i |œÅ(i, j)|,
namely that Œ∏ ‚ààRp satisfy 16CœÅ(Œ∏) ‚â§1, Bunea et al (2010) show that for a
simple choice of regularization parameter
(2.5)
œâ ‚àùr(Œ¥/2)
the following inequality holds with probability at least 1 ‚àíŒ¥
(2.6)
||fÀÜŒ∏ ‚àíf||2 + C2œâ
p
X
j=1
|ÀÜŒ∏j ‚àíŒ∏j| ‚â§C3||fŒ∏ ‚àíf||2 + C4r2(Œ¥/2)g(Œ∏)
where the C‚Äôs are constants. This result suggests that when the mixture
representation is a good approximation of the function, that is the approx-
imation error ||fŒ∏ ‚àíf||2 is small, then simultaneously the SPADES coeÔ¨É-
cients will be close to the oracle coeÔ¨Écients and the SPADES estimator will
be close to the true density. A similar result holds under a condition on the
‚Äúcumulative local coherence‚Äù deÔ¨Åned by
œÅ(Œ∏) =
X
i‚ààI(Œ∏)
X
j>i
|œÅM(i, j)|.
The proofs rely on an application of Bernstein‚Äôs inequality, which describes
the concentration of random variables around their mean.
For the purposes of sparse coding, the coherence conditions suggests that
we should consider the correlations between dictionary elements if we are
interested in predictive performance. In particular we do not want the ele-
ments to be highly correlated. This makes intuitive sense as there would be a
problem of identiÔ¨Åcation in such a case. The cumulative condition is weaker
than the maximal condition in that it admits cases where the correlations
may be relatively large for only a few pairs of dictionary elements. Note also
that the oracle inequality is non-asymptotic and does not depend on M or
n.

5
2.1.2. Mixture Models.
In the mixture modeling context, we assume that
f = fŒ∏‚àóhas a true mixture representation that is sparse. Denote by I‚àó‚äÜ
{1, .., p} the set of indices corresponding to the non-zero components of Œ∏‚àó.
The goal is then to Ô¨Ånd a good estimate ÀÜŒ∏ of Œ∏‚àóand identify I‚àówith high
probability, formally p(IÀÜŒ∏ = I‚àó) ‚Üí1 as n ‚Üí‚àû. This is often referred to as
model selection consistency, although the result from [4] is non-asymptotic,
as before.
In this setting the coherence condition can be restated as
(2.7)
œÅ‚àó‚â§
1
16k‚àó
where œÅ‚àó= œÅ(Œ∏‚àó) and k‚àó= |I‚àó|. Intuitively, the condition implies that
stricter conditions on the correlations are required as the number of true
non-zero coeÔ¨Écients, k‚àó, increases. Put another way, the model selection
problem becomes more diÔ¨Écult when the true coeÔ¨Écient vector is less sparse.
A second condition for correct model selection is
(2.8)
min
j‚ààI‚àó|Œ∏‚àó
j| > 4C
r
log(2p2/Œ¥)
n
where the p2 term replaces the p term from above because the regularization
required for model selection is larger than for good prediction. Intuitively,
this condition implies that mixture weights must be above the noise level
given by the square root term. Under these conditions, the result states
(2.9)
p(IÀÜŒ∏ = I‚àó) ‚â•1 ‚àí2Œ¥(1 + 1
p).
Note that the true coeÔ¨Écient vector and its cardinality are unknown so that
these conditions are generally untestable in practice. The proof of this result
also relies on the application of a concentration inequality.
2.2. Generalization Error of Dictionary Learning.
Some theoretical work
has studied the generalization error of dictionary learning. We brieÔ¨Çy discuss
some results from [10] who derive generalization bounds for both ‚Ñì1 and ‚Ñì0
penalization for arbitrary loss functions. Denote the approximation error of
y ‚ààRm by
hA,B(y) = min
Œ∏‚ààA ||y ‚àíBŒ∏||.
We focus on the case where A deÔ¨Ånes an ‚Ñì1-constraint
A = {Œ∏ ‚ààRp : ||Œ∏||1 ‚â§œâ}.

6
Note that this representation is equivalent to the one where the ‚Ñì1-penalty
appears directly in the loss function to be minimized. In general the dictio-
nary learning problem can be seen as minimizing
(2.10)
E(B) = E [hA,B(y)]
where the expectation is taken with respect to the unknown density y ‚àºf.
If a dictionary is learned from n observations y1, ..., yn, then the goal is to
bound the generalization error, œµ, that arises from learning a dictionary with
a Ô¨Ånite sample
(2.11)
E(B) ‚â§(1 + Œ∑)En(B) + œµ
where Œ∑ ‚â•0. Using a covering number argument for hA,B, a bound for œµ
on the order of O(
p
mplog(nœâ)/n) is derived. The result implies that the
generalization error shrinks with the sample size and has only a logarithmic
dependence on the ‚Ñì1-norm of the coeÔ¨Écient vector.
3. Application to Topic Modeling.
Topic modeling is a technique
for text analysis that reduces a large collection of documents into groups of
words with relatively distinct meanings. Such a procedure can be useful in
text analysis for exploring the structure of a corpus or as a preliminary step
to higher-level classiÔ¨Åcation procedures. Latent Dirichlet allocation (LDA)
[3] is perhaps the most widely studied model and the basis for many ex-
tensions. The basic LDA model can be described as a mixed-membership
model. In particular the collection of documents is modeled by a shared col-
lection of topics, represented by multinomial distributions over words, and
each document exhibits topics with diÔ¨Äerent proportions.
Sparsity is a key feature of topic models. It captures the intuitive notion
that a given document should exhibit only a few of the corpus-wide topics
that emerge. LDA is a Bayesian hierarchical model and achieves sparsity
in topic proportions by introducing a sparse Dirichlet prior. An alterna-
tive way to achieve sparsity might utilize explicit ‚Ñì1-penalization using the
sparse coding framework. As discussed above, this is useful because the the-
oretical literature has produced general results on the performance of sparse
estimation procedures.
3.1. Terminology.
The following terminology is widely used in the topic
modeling literature and will be useful for our discussion. We will try to
remain consistent with the notation used in the previous sections:
‚Ä¢ A vocabulary is represented by a one-to-one mapping from the set
of indices {1, ..., m} to a set of words in the colloquial sense. Here

7
m represents the number of words in the vocabulary. Recall that m
previously corresponded to the dimension of the observed data.
‚Ä¢ A document is represented by a collection of word counts for each
word, w = (w1, ..., wm), where wi indicates the number of occurrences
of word i. This is referred to as a bag-of-words representation.
‚Ä¢ A corpus is represented by a collection of documents, D = (w1, ..., wn).
Here n represents the number of documents in the corpus. Recall that
n previously corresponded to the number of observations.
‚Ä¢ A topic is represented by a multinomial distribution Œ≤i over the vo-
cabulary, alternatively a vector in the m-dimensional simplex. We will
specify the number of topics, p, to be Ô¨Åt. The topics will be stored as
an m √ó p matrix, Œ≤ = [Œ≤1, ..., Œ≤p].
3.2. Latent Dirichlet Allocation.
The basic LDA model is a Bayesian
hierarchical model. In this discussion let w = (w1, .., wN) be a sequential
representation so that each wi corresponds to a word in the vocabulary,
where N represents the number of words in the document. Consider the
following generative process for a given document:
1. Choose the number of words N ‚àºPoisson(Œæ).
2. Choose topic proportions Œ∏ ‚àºDirichlet(Œ±).
3. For each word wi,
(a) Choose a topic zi ‚àºMultinomial(Œ∏).
(b) Choose a word wi ‚àºp(wi|Œ≤zi).
Here Œ∏, z and the Œ≤‚Äôs are latent variables to be estimated. Since N is in-
dependent of these variables, we ignore it for the purposes of this discus-
sion. The parameter Œ± for the Dirichlet prior will need to be speciÔ¨Åed. Note
that there is an implicit assumption of exchangeability for words, called the
‚Äúbag-of-words‚Äù assumption, since the speciÔ¨Åc sequence of words is ignored.
Topics and documents are also assumed to be exchangeable, although these
assumptions can be relaxed.
Fix the topics for now. To conduct inference for Œ∏ and z, we require their
posterior distribution
(3.1)
p(Œ∏, z|w, Œ±, Œ≤) = p(Œ∏, z, w|Œ±, Œ≤)
p(w|Œ±, Œ≤)
.
The generative process formulates the joint probability in the numerator as
(3.2)
p(Œ∏, z, w) = p(Œ∏|Œ±)
N
Y
i=1
p(zi|Œ∏)p(wi|zi, Œ≤).

8
Marginalizing over the latent variables gives
p(w|Œ±, Œ≤)
=
Z
‚ñ≥
p(Œ∏|Œ±)
 N
Y
i=1
m
X
zi=1
p(zi|Œ∏)p(wi|zi, Œ≤)
!
dŒ∏
=
Œì(P
j Œ±j)
Q
j Œì(Œ±j)
Z
‚ñ≥
Ô£´
Ô£≠
p
Y
j=1
Œ∏Œ±j‚àí1
j
Ô£∂
Ô£∏
Ô£´
Ô£≠
N
Y
i=1
p
X
j=1
m
Y
k=1
(Œ∏jŒ≤jk)1(wi=k)
Ô£∂
Ô£∏dŒ∏
where the integral is taken over the (p ‚àí1) simplex, ‚ñ≥= {Œ∏ : Pp
j=1 Œ∏j = 1}.
This is computationally intractable since there is a coupling between Œ∏ and
Œ≤, so approximate methods such as Markov chain Monte Carlo or variational
approximation must be used.
Variational approximation involves an iterative expectation-maximization
(EM) algorithm. In the E-step, a lower bound for the log likelihood of a
document is derived using Jensen‚Äôs inequality to deal with the intractability
of the likelihood. In particular, a computationally convenient variational
distribution
(3.3)
q(Œ∏, z|Œ≥, œÜ) = q(Œ∏|Œ≥)
N
Y
i=1
q(zn|œÜn)
is used to approximate p(Œ∏, z|w, Œ±, Œ≤). Optimizing over the variational pa-
rameters gives
(3.4)
(Œ≥‚àó, œÜ‚àó) = argmin
(Œ≥,œÜ)
D(q(Œ∏, z|Œ≥, œÜ) || p(Œ∏, z|w, Œ±, Œ≤))
where D(f || g) denotes the Kullback-Leibler divergence. In the M-step, the
resulting lower bound is maximized with respect to the parameters Œ± and
Œ≤.
3.3. Sparse Coding Approach.
The sparse coding framework discussed in
Sections 1 and 2.1 seems to provide a natural alternative to the Bayesian
formulation of LDA. In particular the set of topics corresponds to a dic-
tionary and document-level topic proportions correspond to codes. Thus,
we can adapt a sparse coding formulation to specify an alternative sparse
coding topic model (SCTM). Using the standard ‚Ñì1-penalty, we solve the
following sparse coding problem:
(3.5)
min
{Œ∏(i)}n
i=1,{bj}p
j=1
n
X
i=1
Ô£´
Ô£≠1
2||x(i) ‚àí
p
X
j=1
Œ∏(i)
j bj||2
2 + œâ||Œ∏(i)||1
Ô£∂
Ô£∏

9
such that
(3.6)
Œ∏(i) ‚™∞0 for all i and bj ‚™∞0,
X
k
bjk = 1 for all j
where x(i), i = 1, ..., n represents the observed word frequencies for the ith
document. The Œ∏‚Äôs correspond to document-speciÔ¨Åc topic proportions and
are constrained to be non-negative for interpretative purposes. We cannot
constrain them to have unit sum due to the ‚Ñì1-penalty, so these topic pro-
portions are not mixture coeÔ¨Écients as they were in LDA. Note that the
theoretical work in [4], as discussed previously, requires no such constraints
for predictive performance or model selection consistency in the coding step.
The b‚Äôs represent the dictionary elements to be learned and correspond to
topics. To be interpreted as multinomial distributions over words, each topic
is constrained to be nonnegative and have unit sum. As a result our model
approximates the distribution over words for a document as a mixture. The
probability for the ith word is given by
(3.7)
f(wi) =
p
X
j=1
Œ∏jfj(wi)
where fj(wi) ‚â°bji the ith entry in the vector bj. We use an iterative pro-
cedure to Ô¨Åt the model, solving for document-level coeÔ¨Écients Œ∏(i) while
holding the corpus-level topics [b1, ..., bp] Ô¨Åxed, and vice versa.
3.3.1. Solving for CoeÔ¨Écients.
The objective in (3.5) becomes separable
in i when maximizing with respect to coeÔ¨Écients so we can consider a single
document at a time. For a given document this requires the solution of a
LASSO problem with nonnegative constraints on the coeÔ¨Écients when the
topics are held Ô¨Åxed. The numerical solution of such problems has been well-
studied and algorithms such as coordinate descent and least angle regression
(LARS) work well for the standard LASSO.
We adopt a coordinate descent algorithm with soft thresholding. Denote
the objective by L(Œ∏) = g(Œ∏)+œâ||Œ∏||1. Let gk(Œ∏) denote the partial derivative
of g with respect to Œ∏k and let Œ∏(0)
‚àík = Œ∏ ‚àíŒ∏kek denote the vector Œ∏ with kth
coordinate set to 0. For a given regularization parameter, Œ∏, the algorithm
takes the form:
1. Choose a direction k ‚àà{1, .., p}.
2. If |gk(Œ∏(0)
‚àík)| < œâ then set Œ∏ = Œ∏(0)
‚àík. Otherwise obtain Œ∏ by a one-
dimensional line search along the kth coordinate.
3. Iterate until convergence.

10
We handle the nonnegativity constraint by limiting the line search to non-
negative coordinates. LARS can also be adapted to handle the nonnegativity
constraint as described in [6].
3.3.2. Solving for Topics.
We now consider maximizing (3.5) with re-
spect to topics. Here it will be helpful to adopt a matrix representation. Let
B = [b1, ..., bp] ‚ààRm√óp be the dictionary formed by stacking the topics into
a matrix. Form X = [x1, .., xn] ‚ààRm√ón and Œ∏ = [Œ∏1, ..., Œ∏n] ‚ààRp√ón. Holding
Œ∏‚Äôs Ô¨Åxed, the problem becomes
(3.8)
ÀÜB = argmin
B
1
2||X ‚àíBŒò||2
F
such that
(3.9)
d
X
i=1
Bij = 1 for all j = 1, ..., p and B ‚™∞0.
This is a quadratic program with the columns of B constrained to lie in the
d-dimensional simplex and can be solved with a projected gradient descent
algorithm. This approach is easily extendable to an online setting as in [8].
We iterate over columns since the simplex constraint is separable with
respect to the columns. In particular we take a step along the gradient with
respect to one column at a time and project to the simplex, which can be
done using a linear-time algorithm proposed by [5]. This gives an update
equation of the form
(3.10)
bj = Œ†‚ñ≥

bj ‚àíŒ∑ ‚àÇL
‚àÇbj

where Œ†‚ñ≥(¬∑) denotes a projection onto the simplex. The gradient is given
by
(3.11)
‚àÇL
‚àÇbj
= Bcj ‚àídj
where C = [c1, ..., cp] = Œ∏Œ∏T and D = [d1, ..., dp] = XŒ∏T . Finally, the step
size can be tuned using a backtracking line search procedure or simply by
taking the inverse of the Hessian given by
(3.12)
‚àÇL2
‚àÇbj‚àÇbj
= CjjI.
Note that taking steps one column at a time, as opposed to to the whole
matrix at once, seems to help with convergence. To summarize, our projected
gradient descent algorithm is as follows:

11
1. Calculate C = Œ∏Œ∏T and D = XŒ∏T .
2. For each topic, perform the following update:
(a) uj ‚Üêbj ‚àí
1
Cjj (Bcj ‚àídj)
(b) bj ‚ÜêŒ†‚ñ≥(uj)
3. Iterate until convergence.
3.3.3. Other Considerations.
A number of other practical considerations
must be addressed in Ô¨Åtting the model. First, the proportions and topics
must be initialized. One diÔ¨Éculty is that we may approach a local minimi-
mum when some of the topics become equal or nearly equal to each other.
Indeed, we have found experimentally that a good initialization is important
for learning useful topics. One reason for this may be that the simplex con-
straint on the dictionary can be very unforgiving, since the projection onto
the simplex induces sparsity. Thus early steps can result in words that have
zero probability in many topics. We follow [3] in selecting a small number of
seed documents for each topic and smoothing across the entire vocabulary.
The smoothing is done by drawing from a Dirichlet distribution with the
seeded counts as parameters.
Second, we must choose an appropriate regularization parameter, which
directly aÔ¨Äects the sparsity of the topic proportions. This can be done via
cross-validation and adapted to the speciÔ¨Åc task for which the topics will
be used. Topic models are often evaluated based on held-out log likelihood
or held-out perplexity, a likelihood-based measure of model Ô¨Åt. Note that
we could choose a separate regularization parameter for each document,
although we do not do so due to speed considerations. A simple heuristic
is to run a coding update for a single document using the initialized topics
and pick a regularization parameter which produces a suitable number of
nonzero coeÔ¨Écients.
Third, we must choose the number of topics to be Ô¨Åt. Again, the most
straightforward procedure is to use some kind of cross-validation procedure.
Bayesian nonparametric extensions of LDA are able to deal with this issue
more naturally using, for example, hierarchical Dirichlet processes. We do
not explore analogous approaches in this paper.
3.4. Comparison to LDA.
Qualitatively, one might view the sparse cod-
ing approach to topic modeling as a frequentist analogue to LDA. As a
result we expect that both methods should output relatively similar top-
ics, depending on the choice of parameters. Connections between LDA and
non-probabilistic approaches to topic modeling involving matrix decompo-

12
sitions were noted in [3]. We also expect that sparse coding should allow for
a potentially large number of topics.
Note that the SCTM does not contain a notion of topic assignment as
in LDA. However, we can see the equivalence by marginalizing over topic
assignments z to get
p(wi|Œ∏, Œ≤) =
X
j
Œ∏jŒ≤ij
where Œ≤ij denotes the probability of the ith word in the jth topic.
4. Numerical Results.
We apply the SCTM described above to to
a pre-processed collection of 1,500 full papers from the Neural Informa-
tion Processing Systems (NIPS) Conference.1 Papers come from Ô¨Åelds such
as computational neuroscience, machine learning and statistics. The pre-
processing consisted of removal of stopwords, tokenization, and truncation
of the vocabulary to words that occurred more than ten times. Nonetheless
the original dataset contains some spurious words such as ‚Äúa2i‚Äù or ‚Äúaaa‚Äù,
so we further truncate the vocabulary to words that ocurred more than
twenty-Ô¨Åve times. The resulting dataset contains 6,727 unique words.
4.1. Sample Output.
The output of the topic model includes topic pro-
portions for each document and a set of topics for the entire corpus. With
these, we can replicate some of the exploratory aspects of topic models illus-
trated for LDA [3, 1]. First, we can visualize topics by examining the most
probable words. See Figure 4.1 for Ô¨Åfteen topics, visualized by their top Ô¨Åve
most probable words, from applying a SCTM with p = 50 topics and regular-
ization parameter œâ = 2‚àí12 to the NIPS dataset. This parameter value was
chosen using the simple heuristic previously discussed. Qualitatively, top-
ics identify semantically related sets of words and the most probable words
in a topic seem to correspond to keywords. For example the {node, nodes,
network, tree, graph} topic seems to contain keywords used to describe net-
work analysis. The {bound, number, result, threshold, theorem} topic seems
to contain keywords that more generally capture theoretical concepts. This
topic representation can be useful in itself as a dimensionality reduction tool
for browsing a corpus.
We can use the topic proportions to examine the top documents that ex-
hibit a given topic. Recall that topic proportions from the SCTM are not con-
strained in their sum due to the ‚Ñì1-penalty. To make direct comparisons we
normalize them to have unit sum. For example, the top documents associated
1Newman, D. (2010). UCI Machine Learning Repository [http://archive.ics.uci.
edu/ml/datasets/Bag+of+Words].

13
1
2
3
4
5
neuron
node
map
motion
distribution
synaptic
nodes
space
direction
gaussian
activity
network
feature
velocity
probability
synapses
tree
representation
moving
density
potential
graph
mapping
stage
mean
6
7
8
9
10
algorithm
signal
word
model
bound
gradient
noise
recognition
parameter
number
step
Ô¨Ålter
speech
prediction
result
convergence
processing
character
modeling
threshold
update
component
speaker
structure
theorem
11
12
13
14
15
circuit
spike
training
neural
action
chip
information
error
network
policy
analog
rate
generalization
net
optimal
current
Ô¨Åring
test
recurrent
states
voltage
noise
performance
computation
step
Fig 1. Fifteen topics from a sparse coding model applied to NIPS dataset with p = 50 total
topics and regularization parameter œâ = 2‚àí12. Topics are visualized by their top Ô¨Åve most
probable words.
with the {distribution,gaussian,probability} topic are ‚ÄúThe RectiÔ¨Åed Gaus-
sian Distribution‚Äù and ‚ÄúApproximating Posterior Distributions in Belief
Networks Using Mixtures‚Äù. The top documents in the {word,recognition,speech}
topic are ‚ÄúComparison of Human and Machine Word Recognition‚Äù and ‚ÄúPer-
formance Through Consistency: MS-TDNN‚Äôs for Large Vocabulary Contin-
uous Speech Recognition‚Äù.
We can also look at similar documents based on the distance between
their topic proportion vectors. This can be useful, for example, in document
search or recommendation. Starting with the document ‚ÄúPolynomial Uni-
form Convergence of Relative Frequencies to Probabilities‚Äù, the most similar
documents based on Hellinger distance are ‚ÄúOn the Distribution of Local
Minima of a Random Function on a Graph‚Äù and ‚ÄúMixture Density Estima-
tion‚Äù. All these papers contain a mix of theory and probability as captured
by the {bound, number, result} and {distribution, gaussian, probability} top-
ics.
4.2. Generalization Performance.
We assess generalization performance
relative to LDA by comparing held-out likelihood on a test set. In particular

14
we compute the perplexity score for a document, w ‚ààRm given by
perplexity(w) = exp

‚àílog p(w)
N

where N indicates the number of words in the document. Perplexity is com-
monly used in language modeling and can be interpreted as a per-word
measure of likelihood. Lower perplexity indicates better generalization per-
formance. For LDA, we use the topicmodels package in R which provides a
wrapper for the C implementation of variational EM from [3]. We implement
the SCTM in R. For SCTM the cross-validation involves learning topics from
the training set, Ô¨Åtting topic proportions for test documents using LASSO,
and Ô¨Ånally computing the Ô¨Åtted probabilities for each word. The likelihood
is calculated as
log p(w) =
m
X
i=1
niÀÜp(wi)
where ni indicates the number of times the ith word appeared in the test
document and ÀÜp(wi) = Pp
j=1 ÀÜŒ∏jbij.
Each model has input parameters other than the number of topics. To
make a fair comparison, we run the models for multiple values of the pa-
rameters and select the best for each model. For LDA, the hyperparameter
Œ± speciÔ¨Åes a symmetric Dirichlet prior for the topic proportions. We test for
Œ± ‚àà{1√ó10‚àí2, 5√ó10‚àí2, 1√ó10‚àí1, 5√ó10‚àí1}. Note that choosing Œ± < 1 encour-
ages sparsity in the posterior topic proportions. For the SCTM, we choose
the regularization parameter œâ ‚àà{5 √ó 10‚àí5, 1 √ó 10‚àí4, 5 √ó 10‚àí4, 1 √ó 10‚àí3}.
Strangely, we Ô¨Ånd that for certain documents both models report very
high perplexities (very low likelihoods). While LDA only reports very high
perplexities and never inÔ¨Ånite perplexities (zero likelihoods), SCTM occas-
sionally does assign zero probability to words. This happens because we have
induced sparsity in both the topic proportions and the topics themselves.
In particular it is possible that an unlucky linear combination to lead to a
zero Ô¨Åtted probability. In practice it may be necessary to smooth the topics
so that all words in the vocabulary have positive probability. In LDA this
can be implemented naturally by specifying a Dirichlet prior on the top-
ics, introducing a second Dirichlet hyperparameter. In SCTM there is no
such natural implementation, since the simplex constraint on the dictionary
imposes sparsity, so the topics would have to be post-processed in some
manner. For the purposes of this paper, we proceed by plotting the median
and interquartile range.
See Figure 2 for results from a 10-fold cross-validation experiment. In
this experiment we consider a randomly selected 500-document subset of

15
the NIPS corpus for speed purposes. The plot compares median held-out
perplexities over the folds for LDA (Œ± = 0.01) and SCTM (œâ = 5 √ó 10‚àí5).
The results suggest that SCTM can be quite noisy for a small number of
topics but that it performs better than LDA as the number of topics is
increased. However, we should keep in mind that SCTM occassionally assigns
zero probability to a word, leading to inÔ¨Ånite perplexity. A simple Ô¨Åx is to
lower the penalization when Ô¨Åtting the topic proportions for test documents
in which words receive zero Ô¨Åtted probability. Future work should resolve this
issue in a more natural way by exploring methods for smoothing the resulting
topics or altering the model speciÔ¨Åcation to eliminate this possibility.
It is interesting to note that while the median perplexity of LDA seems to
level oÔ¨Äas the number of topics increases, the perplexity of SCTM seems to
continue falling. One possible reason is that sparse coding has been used to
deal with overcomplete dictionaries, where p > n, and thus supports a much
larger number of topics. Indeed the sparsity constraints may lead to very
specialized topics which are more easily recombined for prediction purposes.
Due to slow run times, we have not Ô¨Åt the model with more than 150 topics,
though part of this is due to implementation and can easily be resolved in
a performance-oriented language such as C. It would be interesting to see
at what number of topics the held-out perplexity levels oÔ¨Ä. It would also be
interesting to study the tradeoÔ¨Ä, if there exists any, between interpretability
of the topics and generalization performance.
Note that the choice of LDA hyperparameter does not aÔ¨Äect the gener-
alization performance much, perhaps because the posterior dominates the
prior even with a training set of 450 documents. On the other hand the
choice of SCTM regularization parameter can have a large eÔ¨Äect for a small
number of topics. In particular too much regularization can lead to too much
sparseness, aggravating the zero likelihood issue. There is less diÔ¨Äerence for
a large number of topics. See Figure 3 for an illustration.
5. Extensions.
Various work has extended the basic LDA model to
incorporate topical structure such as correlated topics [1] and dynamic topics
[2]. Similar extensions can be made to the sparse coding approach by altering
the penalization. Previous literature on structured sparsity has produced
methods for inducing speciÔ¨Åc patterns of sparsity. We focus on extending
the model to incorporate correlated topics.
The correlated topic model of [1] replaces the Dirichlet prior on the topic
proportions with a logistic normal prior. In particular a multivariate normal

16
G
G
G
G
G
500
1000
1500
2000
2500
Number of Topics
Held‚àíOut Perplexity
G
G
G
G
G
10
25
50
100
150
Generalization Performance of LDA vs. SCTM
LDA
SCTM
Fig 2. Results from a 10-fold cross-validation experiment comparing held-out perplexities
for LDA with Œ± = 0.01 and SCTM with œâ = 5 √ó 10‚àí5. Note that points represent medians
and error bars represent interquartile ranges.
G
G
G
G
G
500
1000
1500
2000
2500
Number of Topics
Held‚àíOut Perplexity
G
G
G
10
25
50
100
150
Generalization Performance of SCTM with Different Regularization
œâ=0.00005
œâ=0.0001
Fig 3. A comparison of generalization for SCTM with diÔ¨Äerent regularization parameters.
For a small number of topics, too much penalization aggravates the zero likelihood issue.

17
variable Œ∑ ‚àºN(¬µ, Œ£) is mapped to the simplex by
(5.1)
Œ∏ = f(Œ∑) =
exp{Œ∑}
P
j exp{Œ∑j}.
Correlation between topics is captured by the covariance matrix Œ£. The
graph can be visualized using a variant of the graphical lasso procedure [7].
The graphical lasso produces a sparse estimate of ‚Ñ¶= Œ£‚àí1 and positive
entries indicate the existence of an edge.
To implement a similar extension for sparse coding, we would like to anal-
ogously introduce a covariance matrix Œ£ governing the correlation between
topics Œ∏. To keep this covariance matrix sparse, we could also use graphical
lasso to maximize a term of the form
(5.2)
log det(‚Ñ¶) ‚àítr(S‚Ñ¶) ‚àíœÅ||‚Ñ¶||1
where S indicates the empircal covariance matrix given by S = 1
n
Pn
i=1 Œ∏iŒ∏T
i .
Note that this corresponds to a log-likelihood, partially maximized with
respect to the mean, that arises from directly assuming Œ∏ is normal.
The objective becomes
(5.3)
min
{Œ∏i}n
i=1,B,‚Ñ¶
n
X
i=1
L(B, Œ∏i) + Œ∏T ‚Ñ¶Œ∏ ‚àílog det(‚Ñ¶) + œÅ||‚Ñ¶||1
where
L(B, Œ∏i) = 1
2||yi ‚àíBŒ∏i||2
2 + œâ||Œ∏i||1.
This could be solved via coordinate descent, optimizing with respect to Œ∏i‚Äôs,
B and ‚Ñ¶separately. Optimizing with respect to B would remain the same as
before. Optimizing with respect to ‚Ñ¶can be done using the graphical lasso
procedure from [7]. Finally optimizing with respect to Œ∏i‚Äôs can be done by
rewriting the term involving ‚Ñ¶to get
(5.4)
L(B, Œ∏i) + Œ∏T
i ‚Ñ¶Œ∏i = || [ yi
0 ] ‚àí
 B
LT

Œ∏i||2
2 + œâ||Œ∏i||1
where ‚Ñ¶= LLT is a Cholesky decomposition of the inverse covariance ma-
trix. This now becomes a standard LASSO problem that can be solved as
before. Unfortunately, we have not been able to implement this procedure so
that it converges. In particular there may be a diÔ¨Éculty because it implicitly
assigns a normal prior to the Œ∏i‚Äôs rather than an intermediate variable which
is then normalized to the simplex.

18
6. Conclusion.
In this paper, we have reviewed the technique of sparse
coding and some theoretical issues surrounding both the coding step and
the dictionary learning step. Theoretical work on the joint procedure is
somewhat limited, though some recent results [9] have addressed the noise-
less case. We have also reviewed the technique of topic modeling and pre-
sented an application of sparse coding to topic modeling. The sparse coding
topic model (SCTM) can be seen as a frequentist analogue to the standard
Bayesian model, Latent Dirichlet allocation (LDA). SCTM provides compa-
rable performance to LDA and seems to support a larger number of topics.
The algorithm also can be extended to an online setting as in [8]. Lastly, the
model can be extended using norms for structured sparsity to, for example,
replicate the correlated topic model of [1].
Acknowledgements.
I thank Professor John LaÔ¨Äerty for his guidance
throughout the writing of this paper. I also thank Andy Dahl for helpful
discussions.
References.
[1] Blei, D. and Lafferty, J. (2007). A Correlated Topic Model of Science. Annals of
Applied Statistics 1(1): 17 ‚Äì 35.
[2] Blei, D. and Lafferty, J. (2006). Dynamic Topic Models. In Proceedings of the
International Conference on Machine Learning.
[3] Blei, D., Ng, A., and Jordan, M. (2003). Latent Dirichlet Allocation. Journal of
Machine Learning Research 3: 993‚Äì1022.
[4] Bunea, F., Tsybakov, A., Wegkamp, M., and Barbu, A. (2010). SPADES and
Mixture Models. Annals of Statistics 38(5): 2525‚Äì2558.
[5] Duchi, J., Shalev-Shwartz, S., Singer, Y., and Chandra, T. (2008). EÔ¨Écient
Projections Onto the ‚Ñì1-ball for Learning in High Dimensions. In Proceedings of the
International Conference on Machine Learning.
[6] Efron, B., Hastie, T., Johnstone, I., and Tibshirani, R. (2004). Least Angle
Regression. Annals of Statistics 32(2): 407‚Äì499.
[7] Friedman, J., Hastie, T., and Tibshirani, R. (2008). Sparse Covariance Estimation
with the Graphical Lasso. Biostatistics 9: 432‚Äì441.
[8] Mairal, J., Bach, F., Ponce, J., and Sapiro, G. (2010). Online Learning for
Matrix Factorization and Sparse Coding. Journal of Machine Learning Research 11:
19‚Äì60.
[9] Spielman, D., Wang, H., and Wright, J. (2012). Exact Recovery of Sparsely-Used
Dictionaries. In Proceedings of the 25th Annual Conference on Learning Theory.
[10] Vainsencher, D., Mannor, S., and Bruckstein, A. (2011). The Sample Com-
plexity of Dictionary Learning. Journal of Machine Learning Research 12: 3259‚Äì3281.

