Statistical Modelling 2022; 22(4): 273‚Äì296
Block models for generalized multipartite networks:
Applications in ecology and ethnobiology
Avner Bar-Hen1, Pierre Barbillon2, and Sophie Donnet2
1CNAM, 75003 Paris, France.
2Universit¬¥e Paris-Saclay, AgroParisTech, INRAE, UMR MIA-Paris, 75005, Paris, France.
Abstract:
Generalized multipartite networks consist in the joint observation of several networks
implying some common pre-speciÔ¨Åed groups of individuals. Such complex networks arise commonly
in social sciences, biology, ecology, etc. We propose a Ô¨Çexible probabilistic model named Multipartite
Block Model (MBM) able to unravel the topology of multipartite networks by identifying clusters
(blocks) of nodes sharing the same patterns of connectivity across the collection of networks they are
involved in. The model parameters are estimated through a variational version of the Expectation‚Äì
Maximization algorithm. The numbers of blocks are chosen using an Integrated Completed Likelihood
criterion speciÔ¨Åcally designed for our model. A simulation study illustrates the robustness of the
inference strategy. Finally, two datasets respectively issued from ecology and ethnobiology are analyzed
with the MBM in order to illustrate its Ô¨Çexibility and its relevance for the analysis of real datasets.
The inference procedure is implemented in an R-package GREMLIN, available on Github
(https://github.com/Demiperimetre/GREMLIN).
Key words: networks, latent block models, stochastic block models, variational EM, model selection,
ecology
Received February 2020; revised July 2020; accepted August 2020
1 Introduction
Networks have become fundamental tools in various Ô¨Åelds, such as biology, ecological
theory or sociology to name but a few. The statistical analysis aims to study the
structure of these networks by, for example, unravelling clusters or communities of
individuals (nodes) that shape the observed interactions (see Kolaczyk, 2009, for a
review).
The recent years have witnessed a growing interest for multilayer networks which
is a classic but a wide terminology for a set of related networks (see Kivel¬®a et al. (2014)
or Pilosof et al. (2017) for a review of multilayer networks in ecology for instance).
Among others, multilayer networks encompass dynamic networks, that is, networks
evolving with time (see Kim et al., 2018, for a review), multiplex networks when
Address for correspondence: Avner Bar-Hen, CNAM, 75003 Paris, France.
E-mail: avner@cnam.fr
¬© 2020 The Author(s)
10.1177/1471082X20963254

274‚ÄÉ Bar-Hen et al.
Statistical Modelling 2022; 22(4): 273‚Äì296
Figure 1 Illustrations of bipartite (left), multipartite (centre) and generalized multipartite networks (right)
several types of relations are simultaneously studied on a common set of individuals
(see K¬¥eÔ¨Ået al., 2016; Barbillon et al., 2017, for instance) and multipartite networks.
Multipartite networks are a generalization of bipartite networks. In a bipartite
network, the nodes (representing the interacting entities) are partitioned into two
disjoint sets and an edge links a node from one set to a node from the other set
(see Figure 1, left). In a multipartite network, the nodes are divided into more than
two sets and edges link entities from different sets (see Figure 1, middle). In what
follows, these pre-speciÔ¨Åed sets of nodes will be referred to as functional groups.
Such multipartite networks arise in ecology when studying the interactions between
several groups of species such as the interactions between plants and pollinators,
plants and ants, etc. (Pocock et al., 2012; D¬¥attilo et al., 2016) or in biology when
analyzing networks issued from multi-omics datasets involving proteins, etc. (see
Pavlopoulos et al., 2018, for instance).
Generalized multipartite networks are an extension of multipartite networks:
the nodes are still partitioned into functional groups, but the interactions may
occur not only between different functional groups but also within some of the
functional groups. Ethnobiology (which is the scientiÔ¨Åc study of the relations between
environment and people) provides such generalized multipartite networks. One
of the problems of ethnobiology is to understand how social relations between
individuals (seed circulation in our example) may structure and guarantee biodiversity
in the cultivated crop species (see Thomas and Caillon, 2016, for example). As
a consequence, the network of interest has two types of nodes‚Äînamely farmers
and crop species‚Äîand we observe interactions between farmers and crop species
(who grows what) and inside the group of farmers (seed exchange). Marketing also
provides generalized multipartite networks when individuals are connected through
social networks and also interact with goods through their online purchases. Note
that the term ‚Äòheterogeneous networks‚Äô is also used in the literature to refer to
networks in which the nodes are of multiple types (see Huang et al., 2018, and
references there in).
Many statistical tools have been proposed to analyze simple or bipartite networks.
However, when individuals or biological entities are involved in several networks,

Block models for generalized multipartite networks‚ÄÉ 275
Statistical Modelling 2022; 22(4): 273‚Äì296
there is a strong need to propose statistical tools handling these networks jointly.
Moreover, each context leads to a particular complex network, involving bipartite
and/or simple networks, oriented and/or non-oriented networks, weighted and/or
binary interations. As a consequence, the statistical method must be Ô¨Çexible enough
to be able to take into account the wide variety of existing heterogeneous networks.
These tools are an essential step towards a better understanding of the global
interaction systems at stake. The aim of this article is to propose a probabilistic
model suited for generalized multipartite networks.
A central issue in network analysis is to be able to cluster nodes sharing the
same connectivity patterns. To do so, two approaches are possible, either relying
on classical metrics detecting nestedness (Almeida-Neto et al., 2008), modularity
(Barber, 2007), etc., or adopting a probabilistic mixture strategy. Since the original
article by Snijders and Nowicki (1997), probabilistic mixture models‚Äîclassically
referred to as stochastic block models (SBM)‚Äîhave proven their efÔ¨Åciency when
aiming to cluster similar nodes based on their connectivity patterns without any
prior assumption on the patterns to be found (e.g., modularity, centrality, hierarchy).
Latent block models (LBM; Govaert and Nadif, 2003) are the extension of SBM for
bipartite networks, resulting in a bi-clustering of the nodes.
In this article, we propose a new probabilistic mixture model adapted to
generalized multipartite networks that we call Multipartite Block Model (MBM).
This model assumes that each functional group is partitioned into clusters gathering
nodes sharing the same connection behaviour in all the networks they are involved
in. The clusters are given by latent variables on nodes. This results is a mixture model
on dyads (pair of nodes).
Inferring the parameters of such a model with latent variables is a complex
task, since the likelihood cannot be computed in a closed form. We resort to a
Variational Expectation‚ÄìMaximization (VEM) algorithm to estimate the parameters
and to provide the multi-clustering of the nodes. The crucial task of estimating the
numbers of clusters in each functional group is tackled through a model selection
procedure based on an adapted penalized likelihood criterion, namely Integrated
Completed Likelihood (ICL).
Related works Some extensions of standard descriptive tools‚Äîsuch as community
detection‚Äîto more complex networks have been proposed in the literature (see for
instance Yang and Leskovec, 2012; Gask¬¥o et al., 2017). These metrics or descriptive
tools have the drawback of only searching for speciÔ¨Åc types of structures, contrary
to clustering methods based on probabilistic mixture models. LBM do exist for other
kind of multilayer networks. When the network is multiplex (i.e., when several types
of interactions are studied on the same set of nodes), the SBM has been extended
in K¬¥eÔ¨Ået al. (2016) and Barbillon et al. (2017)by assuming a multivariate Bernoulli
distribution to model the set of multiple edges between two individuals. Arroyo
et al. (2019) also deal with multiplex network and propose a common framework
for different kind of latent space including the latent block structure. Extending the
SBM to a dynamic context where several snapshots of the networks at different time
points are available was proposed in numerous articles. The main difference between
these articles is whether the evolution is considered as discrete (Xu and Hero, 2014;

276‚ÄÉ Bar-Hen et al.
Statistical Modelling 2022; 22(4): 273‚Äì296
Matias and Miele, 2017) or continuous (DuBois et al., 2013; Xin et al., 2017) in
time.
Sengupta and Chen (2015), Huang et al. (2018) and Wang et al. (2019) propose
latent space models for what they call heterogeneous networks which involve several
types of nodes. Sengupta and Chen (2015) and Huang et al. (2018) consider extension
of LBM to heterogeneous networks. Sengupta and Chen (2015) consider extensions
of the classical SBM and of the degree-corrected SBM, while Huang et al. (2018)
considers the mixed-membership SBM (Airoldi et al., 2008). Wang et al. (2019)
consider a continuous latent space such as the latent space model (Hoff et al., 2002)
for such networks. However, their heterogeneous networks correspond to a less
general structure than our generalized multipartite network since it assumes that any
pairs of nodes of any types may interact. Indeed, in our multipartite blockmodel a
type of nodes corresponds to what we call a functional group and we are able to
deal with datasets where not all the functional groups interact or where interactions
between some functional groups are not observed. Furthermore, the articles which
propose a clustering method impose the same number of clusters for each type of
nodes. Sun et al. (2009) consider another multilayer structure with a star network
schema which casts to our multipartite structure. The ecological dataset we consider
actually has this star network schema. On top of the more general class of multilayer
networks we can handle, we provide the MBM for a general class of distributions on
dyads and we allow the number of blocks to vary between functional groups. In order
to select the numbers of blocks, we propose an adapted model selection criterion and
a practical model selection algorithm that has satisfactory performances. These are
new contributions to this Ô¨Åeld.
Outline of the article Section 2 is dedicated to the introduction of notations
supplying a Ô¨Çexible tool to describe generalized multipartite networks. We also
provide a description of the two datasets of interest and illustrate the notations
on these speciÔ¨Åc cases. The block model for multipartite networks is described in
Section 3. In Section 4, the variational inference and the model selection procedure
are presented including the practical implementation of the algorithm. Numerical
illustrations of the robustness of the inference method are provided in Section 5.
Finally, the statistical analyses of the two datasets with discussion are presented in
Section 6. Perspectives are discussed in the last section. Note that this document is
accompanied with a Supplementary Material document divided into four parts: in
the two Ô¨Årst sections, the derivations of the update formulas for the VEM algorithm
and of the ICL criterion are provided; detailed estimates on the two datasets are given
in the third section and additional simulations are provided in the last section.
2 Notations and data
A generalized multipartite network can be seen as a collection of networks involving
Q functional groups: each network may be simple, that is, describing the relations
within a given functional group or bipartite, that is, describing the relations between
individuals belonging to two different functional groups. Moreover, each network

Block models for generalized multipartite networks‚ÄÉ 277
Statistical Modelling 2022; 22(4): 273‚Äì296
may be binary or weighted. We develop a general framework able to handle any type
of multipartite network.
Let nq be the number of individuals in the qth functional group (q = 1, . . . , Q).
We index the collection of networks by pairs of functional groups (q, q‚Ä≤) (q and q‚Ä≤ in
{1, . . . , Q}). E denotes the list of pairs of functional groups for which we observe an
interaction network.
For any (q, q‚Ä≤) ‚ààE, the interaction network is encoded in a matrix Xqq‚Ä≤ such that
Xqq‚Ä≤
ii‚Ä≤ Ã∏= 0 if there is an edge from unit i of functional group q to unit i‚Ä≤ of functional
group q‚Ä≤, 0 otherwise. Each network may be binary (Xqq‚Ä≤
ii‚Ä≤ ‚àà{0, 1}) or valued (Xqq‚Ä≤
ii‚Ä≤ ‚ààN
or R). Xqq may be symmetric if the relation is non-oriented, non-symmetric otherwise.
X =

Xqq‚Ä≤
(q,q‚Ä≤)‚ààE denotes the generalized multipartite network.
For
each
network,
Sqq‚Ä≤
is
an
additional
notation
which
refers
to
the
collection
of
all
the
observed
dyads.
As
an
example,
if
Xqq
represents a completely observed undirected network without self-loop then
Sqq =

(i, j) ‚àà{1, . . . , nq}2, i < j

;
if
Xqq‚Ä≤
is
a
completely
observed
bipartite
network then Sqq‚Ä≤ =

(i, j) ‚àà{1, . . . , nq} √ó {1, . . . , nq‚Ä≤}

. If some dyads are not
observed
(i.e.,
missing),
then
we
set
Xqq‚Ä≤
ii‚Ä≤ = NA
and Sqq‚Ä≤
is
a
subset
of

(i, j) ‚àà{1, . . . , nq} √ó {1, . . . , nq‚Ä≤}

. In what follows, any matrix Xqq‚Ä≤ may contain
missing entries. The inference remains valid in spite of the missing data provided that
they are missing at random. In this case, the whole inference is only based on the
likelihood corresponding to the observed dyads (Rubin, 1976; Tabouy et al., 2020).
Illustration ‚Ä¢ The dataset 1 is issued from D¬¥attilo et al. (2016). This ecological
network gathers mutualistic relations between plants and pollinators, plants and ants,
and plants and frugivorous birds, resulting in Q = 4 functional groups, namely plants
(q = 1), pollinators (q = 2), ants (q = 3) and birds (q = 4 and E = {(1, 2), (1, 3), (1, 4)}.
X1q‚Ä≤
ii‚Ä≤ = 1 if the plant species i has been observed at least once in a mutualistic
interaction with the animal species i‚Ä≤ of functional group q‚Ä≤ during the observation
period, 0 otherwise. Dataset is available online.
‚Ä¢ The dataset 2 comes from Thomas and Caillon (2016) and Thomas et al. (2015).
They collected the oriented network of seed circulation between farmers‚Äîresulting
in a non-symmetric adjacency matrix‚Äîand the crop species grown by the farmers,
resulting in an incidence matrix. Noting q = 1 for the farmers and q = 2 for crop
species, we get E = {(1, 1), (1, 2)}. X11
ii‚Ä≤ = 1 if farmer i gives seeds to farmer i‚Ä≤ (oriented
relation), 0 otherwise and X12
ij = 1 if farmer i cultivates crop species j, 0 otherwise.
3 A block model for generalized multipartite networks
We propose a global stochastic model for the multipartite network accounting for
heterogeneity of connection. To do so, we resort to a mixture model explicitly
describing the way edges connect nodes in the various networks.

278‚ÄÉ Bar-Hen et al.
Statistical Modelling 2022; 22(4): 273‚Äì296
Clustering
The heterogeneity is introduced through blocks: We assume that each
functional group q is divided into Kq blocks (or equivalently clusters). ‚àÄq ‚àà{1, . . . , Q}
and ‚àÄi ‚àà{1, . . . , nq}, let Zq
i be the latent random variable such that Zq
i = k if individual
i of functional group q belongs to cluster k. The random variables Zq
i ‚Äôs are assumed
to be independent and such that: ‚àÄk ‚àà{1, . . . , Kq}, ‚àÄq ‚àà{1, . . . , Q}, ‚àÄi ‚àà{1, . . . , nq}:
P(Zq
i = k) = œÄq
k,
(3.1)
with œÄq
k ‚àà[0, 1], ‚àÄk = 1, . . . , Kq and Kq
k=1 œÄq
k = 1, ‚àÄq ‚àà{1, . . . , Q}. We set Zq =

Zq
i

i‚àà{1,...,nq}, Z =

Zq
q‚àà{1,...,Q} and œÄ =

œÄq
k

k‚àà{1,...,Kq},q‚àà{1,...,Q}.
Connection
Conditionally to the blocks they belong to, the nodes connect as follows:
‚àÄ(q, q‚Ä≤) ‚ààE, ‚àÄ(i, i‚Ä≤) ‚ààSqq‚Ä≤,
Xqq‚Ä≤
ii‚Ä≤ |{Zq
i = k, Zq‚Ä≤
i‚Ä≤ = k‚Ä≤} ‚àºind Fqq‚Ä≤(Œ±qq‚Ä≤
kk‚Ä≤).
(3.2)
The so-called connection distribution Fqq‚Ä≤ must be adapted to the relation represented
in Xqq‚Ä≤. For any (q, q‚Ä≤), Fqq‚Ä≤ may be either:
‚Ä¢ the Bernoulli distribution of parameter ¬µqq‚Ä≤
kk‚Ä≤ if the relation in Xqq‚Ä≤ is binary (and
so Œ±qq‚Ä≤
kk‚Ä≤ = ¬µqq‚Ä≤
kk‚Ä≤ is the probability of connection),
‚Ä¢ or the Poisson distribution with mean Œ±qq‚Ä≤
kk‚Ä≤ = ¬µqq‚Ä≤
kk‚Ä≤ if Xqq‚Ä≤ is a counting weighted
network,
‚Ä¢ or
the
Gaussian
distribution‚Äîwith
Œ±qq‚Ä≤
kk‚Ä≤ = (¬µqq‚Ä≤
kk‚Ä≤, œÉqq‚Ä≤
kk‚Ä≤)‚Äîif
Xqq‚Ä≤
encodes
a
continuous strength of interaction,
‚Ä¢ or Ô¨Ånally the Zero InÔ¨Çated (ZI) Gaussian distribution if Xqq‚Ä≤ encodes a continuous
strength of interaction with possibly null interactions (the density function of
which is: f(x) = 1{0}(x)p + 1R‚àó(x)(1 ‚àíp)œÜ(x; ¬µ, œÉ) with œÜ the Gaussian density).
In this case, Œ±qq‚Ä≤
kk‚Ä≤ = (¬µqq‚Ä≤
kk‚Ä≤, œÉqq‚Ä≤
kk‚Ä≤, pqq‚Ä≤
kk‚Ä≤).
For any (k, k‚Ä≤, q, q‚Ä≤), dqq‚Ä≤ = dim(Œ±qq‚Ä≤
kk‚Ä≤). We refer to Œ± = (Œ±qq‚Ä≤
kk‚Ä≤)(k,k‚Ä≤),(q,q‚Ä≤)‚ààE as the
connection parameters. Œ±qq‚Ä≤
kk‚Ä≤ drives the interaction of any entity belonging to cluster
k in functional group q with any entity belonging to cluster k‚Ä≤ in functional
group q‚Ä≤. Note that for a bipartite or an oriented network Xqq‚Ä≤, (k, k‚Ä≤) ‚ààAqq‚Ä≤ with
Aqq‚Ä≤ = {1, . . . , Kq} √ó {1, . . . , Kq‚Ä≤}. If the interaction encoded in Xqq is non-oriented,
then Œ±qq‚Ä≤
kk‚Ä≤ = Œ±qq‚Ä≤
k‚Ä≤k and so (k, k‚Ä≤) ‚ààAqq =

(k, k‚Ä≤) ‚àà{1, . . . , Kq}| k ‚â§k‚Ä≤2.
Equations (3.1) and (3.2) deÔ¨Åne the so-called MBM.

Block models for generalized multipartite networks‚ÄÉ 279
Statistical Modelling 2022; 22(4): 273‚Äì296
Remark 3.1.
Our model is a generalization of the SBM and the LBM. Indeed,
Equations (3.1)‚Äì(3.2) reduce to the SBM if E = {(1, 1)} and to the LBM if E = {(1, 2)}.
Our extension assumes that the latent structures Z are shared among the Xqq‚Ä≤,that is, if
a functional group q is at stake in several Xqq‚Ä≤, the same Zq impacts the distributions of
the corresponding interaction matrices. In other words, the clusters gather individuals
sharing the same properties of connection in the collection of networks. Obviously,
if each functional group appears in only one element of E, the MBM reduces to
independent SBMs or LBMs.
In terms of probabilistic dependence, conditionally on Z, the

Xqq‚Ä≤
ii‚Ä≤

are
independent. However, Z being latent, their marginalization introduces dependence
not only between the Xqq‚Ä≤
ii‚Ä≤
but also between the matrices

Xqq‚Ä≤
(q,q‚Ä≤)‚ààE. As a
consequence, the clustering variables (Zq
i )q‚àà{1,...,Q},i ‚àà{1,...,nq} are dependent once
conditioned by X.
For a given vector of numbers of blocks K = (K1, . . . , KQ), let Œ∏K = (Œ±, œÄ) be the
unknown parameters of the MBM. We have to perform two inference tasks: Ô¨Årst, for
a given K, estimating Œ∏K and Z, second, selecting the adequate number of blocks in
each functional group K.
4 Parameter inference and model selection
Let p(X, Z; Œ∏K) denote the complete likelihood of the observations X and the latent
variables Z for parameter Œ∏K. Equations (3.1) and (3.2) lead to:
log p(X, Z; Œ∏K) = Q
q=1
nq
i=1
Kq
k=1 1{Zq
i =k} log(œÄq
k)
+

(q,q‚Ä≤)‚ààE

(i,i‚Ä≤)‚ààSqq‚Ä≤

(k,k‚Ä≤)‚ààAqq‚Ä≤
1{Zq
i =k,Zq‚Ä≤
i‚Ä≤ =k‚Ä≤}f qq‚Ä≤(Xqq‚Ä≤
ii‚Ä≤ , Œ±qq‚Ä≤
kk‚Ä≤),
(4.1)
where f qq‚Ä≤ is the log-density of Fqq‚Ä≤. The likelihood p(X; Œ∏K) is obtained by integrating
p(X, Z; Œ∏K) over all the possible values of Z denoted Z = {(zq
i )i‚àà{1,...,nq},q‚àà{1,...,Q}|zq
i ‚àà
{1, . . . , Kq}}:
log p(X; Œ∏K) = log

Z‚ààZ
p(X, Z; Œ∏K).
(4.2)
The summation over Z in Equation (4.2) becomes quickly computationally
intractable when Kq‚Äôs and/or the nq‚Äôs increase. Moreover, we are interested in inferring
the clusterings Z.

280‚ÄÉ Bar-Hen et al.
Statistical Modelling 2022; 22(4): 273‚Äì296
4.1 Variational EM algorithm
In such models with latent variables, the EM algorithm (Dempster et al., 1977)
is a standard tool to maximize the likelihood, taking advantage of the simple
form of log p(X, Z; Œ∏K). However, when conditioned by the observations X, the
(Zq
i ) are not independent (see Remark 3.1). As a consequence, the E step of
the EM algorithm‚Äîwhich consists in the integration of log p(X, Z; Œ∏K) against
p(Z|X; Œ∏‚Ä≤
K)‚Äîbecomes quickly intractable. The VEM algorithm has proved to be a
powerful tool for maximum likelihood inference (see Govaert and Nadif, 2008;
Daudin et al., 2008) for the SBM and the LBM. The VEM replaces p(Z|X; Œ∏‚Ä≤
K) by
an approximation RX,œÑ sought among distributions enforcing independence between
the Zq
i ‚Äôs:
RX,œÑ(Z) =
Q

q=1
nq

i=1
(œÑq
ik)
1Zq
i =k,
where
œÑq
ik = PRX,œÑ(Zq
i = k).
At
the
VE
step,
œÑ
is
chosen
such
that
the
Kullback‚ÄìLeibler
divergence
KL[RœÑ,X, p(¬∑|X; Œ∏K)]
is
minimized.
The
M
step
is
:
Œ∏K =
arg maxŒ∏K ERœÑ,X

log p(X, Z; Œ∏K)

.
Iterating
steps
(VE)
and
(M)
leads
to
the
maximization of a lower bound of the likelihood:
IŒ∏K(RœÑ,X) = log p(X; Œ∏K) ‚àíKL[RœÑ,X, p(¬∑|X; Œ∏K)].
(4.3)
For the MBM, at iteration (t), the algorithm VEM is as follows:
VEM for MBM
‚Ä¢ VE step Find (œÑq
ik)i,k,q solving
œÑq
ik ‚àùexp

log œÄq
k +
Ô£Æ
Ô£∞
q‚Ä≤‚ààEq
nq‚Ä≤

i‚Ä≤=1
K‚Ä≤
q

k‚Ä≤=1
f qq‚Ä≤(Xqq‚Ä≤
ii‚Ä≤ , Œ±qq‚Ä≤
kk‚Ä≤)œÑq‚Ä≤
i‚Ä≤k‚Ä≤
Ô£π
Ô£ª
+1(q,q)‚ààE

j|(i,j)‚ààSqq
Kq

k‚Ä≤=1
f qq(Xqq
ij , Œ±qq
kk‚Ä≤)œÑq
jk‚Ä≤ + 1(q,q)‚ààE1(i,i)‚ààSqqf qq(Xqq
ii , Œ±qq
kk)

.

Block models for generalized multipartite networks‚ÄÉ 281
Statistical Modelling 2022; 22(4): 273‚Äì296
‚Ä¢ M step Update of the parameters:
œÄq
k
= 1
nq
nq
i=1 œÑq
ik
¬µqq‚Ä≤
kk‚Ä≤
=

(i,i‚Ä≤)‚ààSqq‚Ä≤ Xqq‚Ä≤
ii‚Ä≤ œÑq
ikœÑq‚Ä≤
i‚Ä≤k‚Ä≤

(i,i‚Ä≤)‚ààSqq‚Ä≤ œÑq
ikœÑq‚Ä≤
i‚Ä≤k‚Ä≤
(œÉqq‚Ä≤
kk‚Ä≤)2 =

(i,i‚Ä≤)‚ààSqq‚Ä≤ (Xqq‚Ä≤
ii‚Ä≤ )2œÑq
ikœÑq‚Ä≤
i‚Ä≤k‚Ä≤

(i,i‚Ä≤)‚ààSqq‚Ä≤ œÑq
ikœÑq‚Ä≤
i‚Ä≤k‚Ä≤
‚àí(¬µqq‚Ä≤
kk‚Ä≤)2 for a Gaussian or ZI Gaussian distribution,
pqq‚Ä≤
kk‚Ä≤
=

(i,i‚Ä≤)‚ààSqq‚Ä≤ 1{0}(Xqq‚Ä≤
ii‚Ä≤ )œÑq
ikœÑq‚Ä≤
i‚Ä≤k‚Ä≤

(i,i‚Ä≤)‚ààSqq‚Ä≤ œÑq
ikœÑq‚Ä≤
i‚Ä≤k‚Ä≤
for a ZI Gaussian distribution.
The details of the VEM algorithm are provided in the supplementary material
(Section A1). As for any EM-type algorithm, its initialization is critical and will be
discussed later. (ÀÜŒ∏K, ÀÜœÑ) denotes the VEM estimates. A by-product of this algorithm
is an approximation of the conditional distribution p(Z|X; ÀÜŒ∏K) by RX,ÀÜœÑ. Z is thus
estimated by:
ÀÜZq
i = arg max
k‚àà{1,...,Kq}
ÀÜœÑq
ik.
(4.4)
The consistency of the VEM estimates has been established for the SBM by Bickel
et al. (2013) and the LBM by Brault et al. (2017), while Mariadassou and Matias
(2015) study the behaviour of p(Z|X; ÀÜŒ∏K) for the same models.
4.2 Selecting the number of blocks
In practice, the number of clusters K = (K1, . . . , KQ) is unknown and its inference is
challenging. We propose to adopt a model selection strategy. To do so, we Ô¨Årst develop
a penalized likelihood criterion, extending the Integrated Completed Likelihood (ICL)
originally proposed by Biernacki et al. (2000)‚Äîand applied to blocks models by
Daudin et al. (2008), Keribin et al. (2014) and Mariadassou et al. (2010)‚Äîto the
MBM. We then propose a strategy to explore the set of the possible models.
4.2.1
A penalized likelihood criterion
The ICL criterion derives from an asymptotic approximation of the marginal
complete likelihood log m(X, Z) = log

Œ∏K p(X, Z; Œ∏K)p(dŒ∏K) where p(dŒ∏K) is a prior
distribution on Œ∏K.
Proposition 1.
Assume that X and Z are observed. Let p(Œ∏K) be a prior distribution
on Œ∏K. Then
log m(X, Z) ‚âànqq‚Ä≤‚Üí‚àûmax
Œ∏K
log p(X, Z; Œ∏K) ‚àípen(MK)

282‚ÄÉ Bar-Hen et al.
Statistical Modelling 2022; 22(4): 273‚Äì296
where
pen(MK) = 1
2
Ô£±
Ô£≤
Ô£≥
Q

q=1
(Kq ‚àí1) log(nq) +

(q,q‚Ä≤)‚ààE
dqq‚Ä≤|Aqq‚Ä≤| log |Sqq‚Ä≤|
Ô£º
Ô£Ω
Ô£æ
(4.5)
with |U| the cardinal of U.
Proposition 1 is proven in Section A2 of the supplementary material.
In the context of blocks models, the latent variables Z are not observed. Biernacki
et al. (2000) propose to input its Maximum a posteriori (MAP) estimation ÀÜZ =
arg maxZ p(Z|X, ÀÜŒ∏K), resulting in the following penalized likelihood criterion:
ICL(MK) = log p(X, ÀÜZ; ÀÜŒ∏K) ‚àípen(MK).
(4.6)
Finally, the best model is chosen as ÀÜK = arg maxK ICL(MK).
Note that the penalty term pen(MK) (Equation 4.5) is made up of two parts.
Q
q=1(Kq ‚àí1) log(nq) corresponds to the clustering distribution and involves the
number of nodes, while the other term depends on the number of unknown
connection parameters |Aqq‚Ä≤| and the number of observed dyads |Sqq‚Ä≤|.
Link with BIC and behaviour of the ICL
Mariadassou and Matias (2015) prove that in
the standard SBM, the posterior distribution p(Z|X; ÀÜŒ∏K) asymptotically concentrates
on the MAP ÀÜZ. As a consequence,
log p(X, ÀÜZ; ÀÜŒ∏K) ‚âàEp(Z|X,ÀÜŒ∏K)

log p(X, Z; ÀÜŒ∏K)

= log p(X; ÀÜŒ∏K) ‚àíH(p(Z|X, ÀÜŒ∏K)),
where H is the Shannon entropy. Thus, ICL(MK) can be reformulated as: ICL(MK) =
log p(X; ÀÜŒ∏K) ‚àíH(p(Z|X, ÀÜŒ∏K)) ‚àípen(MK) where the quantity log p(X; ÀÜŒ∏K) ‚àípen(MK)
is similar to a BIC criterion. Thus, ICL can be seen as a penalized maximum
likelihood, where the penalty includes not only the complexity of the model pen(MK)
but also the entropy.
Consequently, ICL will automatically favour clustering conÔ¨Ågurations with well
separated groups. In practice, ICL has proven its capacity to outline the clustering
structure in networks in Daudin et al. (2008) for simple networks, Keribin et al.
(2014) for bipartite networks, Mariadassou et al. (2010) for valued networks and
Barbillon et al. (2017) for multiplex networks. Its success comes from the fact
that when traditional model selection criteria essentially involve a trade-off between
goodness of Ô¨Åt and model complexity, the ICL values not only goodness of Ô¨Åt but
also clustering sharpness.

Block models for generalized multipartite networks‚ÄÉ 283
Statistical Modelling 2022; 22(4): 273‚Äì296
4.2.2
Model selection algorithm
Using this criterion, one should be able to compare all the possible models, that
is, Q
q=1 K‚ãÜ
q models if assuming that Kq ‚àà{1, . . . , K‚ãÜ
q}. However, in practice, the ICL
relies on the VEM which requires several clever initializations to avoid local maxima.
In order to tackle these two issues, we propose to adopt a stepwise procedure.
More precisely, at iteration (m) of the procedure, given a number of blocks K(m) and
its corresponding clustering ÀÜZ
(m), we propose to estimate the parameters of all the
models with one more and one less block. For the models with one additional block,
the VEM is run from several initial points obtained by splitting one of the previous
blocks (given by ÀÜZ
(m)). For the models with one less block, the VEM is initialized on
several clusterings derived from ÀÜZ
(m) by merging pairs of blocks. At each iteration, the
models are compared through their ICL and the best deÔ¨Ånes K(m+1). The procedure
stops when the ICL does not increase anymore.
Model selection strategy for MBM
Given a current model M(m) = M(K(m)
1 , . . . , K(m)
Q ) and its corresponding ÀÜZ
(m), the
mth iteration of the procedure is written as follows.
‚Ä¢ Split proposals For any q such that K(m)
q
< K‚ãÜ
q, consider the model
M(m+1)q
+
= M(K(m)
1 , . . . , K(m)
q
+ 1, . . . , K(m)
Q ).
¬∑ Propose K(m)
q
initializations by splitting any of the K(m)
q
current clusters given by
ÀÜZ
q(m) into two clusters (the two clusters are obtained by a hierarchical clustering).
¬∑ From each of the K(m)
q
initialization points, run the VEM algorithm and keep the
better variational estimate ÀÜŒ∏M(m+1)q
+
, that is, the one which maximizes the lower
bound of the likelihood (4.3).
¬∑ Compute the corresponding ICL(M(m+1)q
+
) from formulas (4.6) and (4.5).
‚Ä¢ Merge proposals For any q such that K(m)
q
> 1, consider the model
M(m+1)q
‚àí
= M(K(m)
1 , . . . , K(m)
q
‚àí1, . . . , K(m)
Q ).
¬∑ Propose K(m)
q (K(m)
q
‚àí1)/2 initializations by merging any pairs of clusters among
the K(m)
q
clusters.
¬∑ From each initialization point, run the VEM algorithm and keep the better
variational estimate ÀÜŒ∏M(m+1)q
‚àí

284‚ÄÉ Bar-Hen et al.
Statistical Modelling 2022; 22(4): 273‚Äì296
¬∑ Compute the corresponding ICL(M(m+1)q
‚àí
).
‚Ä¢
Set
M(m+1) = arg max
M(m)
ICL(M)
where
M(m) = {M(m)} ‚à™
q‚àà{1,...Q}{M(m+1)q
+
} ‚à™
{M(m+1)q
‚àí
}.
If M(m+1) Ã∏= M(m) iterate, otherwise stop.
Like any stepwise procedure, our algorithm is clearly suboptimal in terms of model
space exploration. However, it reveals to be efÔ¨Åcient in practice. Indeed, initializing
the VEM from the clusters obtained on a smaller or larger model is much more
efÔ¨Åcient than other strategies such as random initialization or spectral clustering.
The (possibly local) maximum is reached in a few iterations, resulting in a reasonable
computational time. Moreover, the tasks at each iteration can be parallelized resulting
in an additional saving of time. In addition, the model selection algorithm may be
initialized on several starting models M(0) like M(0) = (1, . . . , 1) or the clusterings
obtained by inferring the structure of the networks Xqq‚Ä≤ separately.
The complete inference procedure including the model selection algorithm is
implemented in the R package GREMLIN.
5 Illustration on simulated datasets
We illustrate the robustness of our inference procedure on simulated data. The
simulations are implemented as a vignette of the R package (GREMLIN) available
on Github in order to ensure reproducibility of the results.
Simulation parameters We generate datasets mimicking the two real datasets
studied in Section 6, that is, we generate 100 datasets under the following two
scenarios.
‚Ä¢
Scenario
1:
We
set
Q = 4
functional
groups
of
respective
sizes
n = (141, 173, 46, 30), E = {(1, 2), (1, 3), (1, 4)} and K = (7, 2, 2, 1). The simulation
parameters
are
the
following:
œÄ1 = (0.3651, 0.1270, 0.1190, 0.1460, 0.0842,
0.0794, 0.0794), œÄ2 = (0.1, 0.9), œÄ3 = (0.1, 0.9),
Œ±12 =
Ô£´
Ô£¨Ô£¨Ô£¨Ô£¨Ô£¨Ô£¨Ô£¨Ô£¨Ô£¨Ô£¨Ô£¨Ô£≠
0.0957 0.0075
0.0100
0
0
0.0003
0.1652 0.0343
0.2018 0.1380
0
0
0
0
Ô£∂
Ô£∑Ô£∑Ô£∑Ô£∑Ô£∑Ô£∑Ô£∑Ô£∑Ô£∑Ô£∑Ô£∑Ô£∏
,
Œ±13 =
Ô£´
Ô£¨Ô£¨Ô£¨Ô£¨Ô£¨Ô£¨Ô£¨Ô£¨Ô£¨Ô£¨Ô£¨Ô£≠
0
0.0006
0.5431 0.0589
0
0
0.6620 0.1542
0
0
0
0
0.8492 0.3565
Ô£∂
Ô£∑Ô£∑Ô£∑Ô£∑Ô£∑Ô£∑Ô£∑Ô£∑Ô£∑Ô£∑Ô£∑Ô£∏
,
Œ±14 =
Ô£´
Ô£¨Ô£¨Ô£¨Ô£¨Ô£¨Ô£¨Ô£¨Ô£¨Ô£¨Ô£¨Ô£¨Ô£≠
0.0013
0
0.0753
0
0.0163
0.5108
0
Ô£∂
Ô£∑Ô£∑Ô£∑Ô£∑Ô£∑Ô£∑Ô£∑Ô£∑Ô£∑Ô£∑Ô£∑Ô£∏
.
(5.1)
‚Ä¢ Scenario 2: Mimicking our second dataset, we set Q = 2 functional groups such
that n1 = 30, n2 = 37, E = {(1, 1), (1, 2)} and K = (3, 2). The simulation parameters

Block models for generalized multipartite networks‚ÄÉ 285
Statistical Modelling 2022; 22(4): 273‚Äì296
Table 1 Results for Scenario 1: Estimated numbers of clusters ( ÀÜK1, ÀÜK2, ÀÜK3, ÀÜK4). The simulated number of
clusters is equal to (7, 2, 2, 1)
ÀÜK
ÀÜK1
ÀÜK2
ÀÜK3
ÀÜK4
Nb of simulations
7
2
2
1
73
7
2
1
1
6
7
1
2
1
3
6
2
2
1
18
Table 2 Simulation scenario 1: Bias and RMSE for Œ±qq‚Ä≤
kk‚Ä≤
Œ±12
Œ±13
Œ±13
Œ±12
k1
Œ±12
k2
Œ±13
k1
Œ±12
k2
Œ±14
k1
Bias
RMSE
Bias
RMSE
Bias
RMSE
Bias
RMSE
Bias
RMSE
‚àí9e‚àí04
0.0102
0
0.0011
0
4e‚àí04
1e‚àí04
6e‚àí04
‚àí1e‚àí04
9e‚àí04
8e‚àí04
0.0064
1e‚àí04
2e‚àí04
‚àí0.0036
0.0557
0.0013
0.0085
0
0
1e‚àí04
7e‚àí04
‚àí1e‚àí04
4e‚àí04
0
0
0
2e‚àí04
0.0026
0.0155
2e‚àí04
0.0194
4e‚àí04
0.0038
0.0038
0.0515
‚àí6e‚àí04
0.0119
0
0
0.0024
0.0281
‚àí0.0023
0.0099
0
0
0
0
‚àí0.0012
0.0077
0
0
0
0
0
0
0
0
‚àí0.0081
0.0323
0
0
0
0
0.002
0.0553
‚àí0.0039
0.0212
0
0
are as follows: œÄ1 = (0.31, 0.42, 0.27), œÄ2 = (0.65, 0.35).
Œ±11 =
Ô£´
Ô£¨Ô£≠
0.025 0.123 0.053
0.159
0.3
0.07
0.374 0.585 0.357
Ô£∂
Ô£∑Ô£∏
Œ±12 =
Ô£´
Ô£¨Ô£≠
0.186 0.653
0.559 0.905
0.390 0.696
Ô£∂
Ô£∑Ô£∏.
On each simulated dataset, we run the algorithm described in Section 4.2.2 with
K‚ãÜ
q = 10, for all q. We start the stepwise algorithm on Kq = 1 and on the clusterings
obtained by inferring the LBM separately on each matrix Xqq‚Ä≤. For each dataset, it
takes a few minutes for the algorithm to converge.
Results for Scenario 1
Among the 100 simulated datasets, the true numbers of clusters are exactly
recovered for 73 datasets as can be seen in Table 1. Three other estimated
conÔ¨Ågurations are observed as detailed in Table 1, each of them corresponding to
ÀÜKq = Kq ‚àí1. A scrutiny shows that cases where K3 is estimated to 1 instead of 2
correspond to datasets where one simulated cluster (meaning the simulated Z3) is
reduced to 1 or 2 individuals.
We measure the ability of the procedure to recover the clusters by computing
the Adjusted Rand Index (ARI by Hubert and Arabie, 1985) between ÀÜZ
1 and the
simulated Z1. ARI compares two clusterings with a correction for chance. It is close

286‚ÄÉ Bar-Hen et al.
Statistical Modelling 2022; 22(4): 273‚Äì296
Figure 2 (a): Simulation scenario 1: Distribution of the ARI for q = 1 when ÀÜK1 = 6 (under-estimation) on left
and ÀÜK1 = 7 (exact estimation) on right. (b) Simulation scenario 2: Boxplots of the ARI for ÀÜZ
1 (on left) and ÀÜZ
2
(on right) with ÀÜK1 = 2 (circle) and ÀÜK1 = 3 (triangle)
to 0 when the two clusterings are independent and equals to 1 when the clusterings
are identical (up to label switching). The boxplots of the ARI‚Äôs are plotted in Figure
2a. All the ARI are high (> 0.7), even when ÀÜK1 = 6, which means that the clusters
are always globally recovered and the structure of the multipartite network is well
discovered.
We also investigate the quality of the parameters estimation. For the 73 datasets
such that ÀÜK = (7, 2, 2, 1), we compare the estimated parameters ÀÜŒ± to the simulation
parameters (after a relabelling of the clusters to match the true clustering, if required).
The results in terms of bias and Root Mean Square Error (RMSE) are reported in
Table 2. We observe that the parameters are estimated without noticeable biases and
with small RMSE. In particular, the null Œ±qq‚Ä≤
kk‚Ä≤‚Äôs are always recovered.
Results for Scenario 2 The same analysis is done for Scenario 2. ÀÜK = K = (3, 2)
for 82 simulated datasets over 100. The unique alternative observed conÔ¨Åguration is
ÀÜK = (2, 2).
Here again, in order to assess the ability of the method to recover the clusters, we
compute the ARI for Z1 and Z2. These quantities are reported in Figure ?? for the
two functional groups (left and right) and for ÀÜK1 = 3 (triangles) and ÀÜK2 = 2 (circles).
As can be noticed, the clusterings are well recovered when the number of clusters
are exactly recovered (triangle), with a noticeable number of cases where the clusters
are exactly recovered (ARI = 1). As expected, we observe a lower ARI when ÀÜK1 = 2
(circle), but with globally high values.

Block models for generalized multipartite networks‚ÄÉ 287
Statistical Modelling 2022; 22(4): 273‚Äì296
Table 3 Simulation scenario 2 : Bias and RMSE for Œ±qq‚Ä≤
kk‚Ä≤
Œ±11
Œ±12
Œ±11
k1
Œ±11
k2
Œ±11
k3
Œ±12
k1
Œ±12
k2
Bias
RMSE
Bias
RMSE
Bias
RMSE
Bias
RMSE
Bias
RMSE
‚àí0.0039
0.0211
‚àí1e‚àí04
0.0299
‚àí5e‚àí04
0.0271
‚àí0.0043
0.0263
‚àí0.0192
0.0552
0.0021
0.0342
‚àí0.0014
0.045
6e‚àí04
0.0264
‚àí0.007
0.0348
‚àí0.026
0.0378
‚àí0.0041
0.0636
‚àí0.0032
0.0479
0.003
0.0826
‚àí0.0179
0.0377
‚àí0.0202
0.0534
We also pay attention to the estimation of the parameters of connection Œ±qq‚Ä≤
kk‚Ä≤. Bias
and RMSE are reported in Table 3. Once again, the bias and RMSE are small.
Additional simulations
Additional simulations, available in supplementary material, were run for our
two scenarios to see how the clustering improves depending on the networks we take
into account. The improvement is especially noteworthy for the functional groups
which are involved in several networks (plants in scenario 1, farmers in scenario 2).
This was expected since some parts of the block structure are more related to some
interactions with speciÔ¨Åc functional groups.
6 Applications
6.1 Ecology: Interactions plants/animals
Dataset The dataset‚Äîcompiled and conducted by D¬¥attilo et al. (2016) at Centro de
Investigaciones Costeras La Mancha (CICOLMA), located in Mexico‚Äîinvolves three
general types of plant‚Äìanimal mutualistic interaction: pollination, seed dispersal by
frugivorous birds, and protective mutualisms between ants and plants with extraÔ¨Çoral
nectaries. The dataset includes n1 = 141 plant species, n2 = 173 pollinator species
(Ô¨Çower visitors), n3 = 46 frugivorous bird species and n4 = 30 ant species, inducing
753 observed interactions of which 55% are plant‚Äìpollinator interactions, 17% are
plant‚Äìbirds interactions and 28% are plant‚Äìant interactions.
Inference We run the procedure described in subsection 4.2.2. The computational
time on an Intel Xeon(R) CPU E5-1650 v3 3.50GHz x12 using 6 cores is less than
10 minutes. The ICL criterion selects 7 clusters of plants, 2 clusters of pollinators,
1 cluster of birds and 2 clusters of ants. The estimated parameters are reported in
Tables A1 and A2 in the supplementary material. The resulting mesoscopic view of
the multipartite network is plotted in Figure 3.
Discussion From Figure 3, we conclude that plants of Clusters P7 and P1 only
interact with ants (plants of Cluster P7 attract more ant species belonging to Cluster
A1). The plants of Clusters P3 and P6 are only in interaction with birds, the difference
between the two clusters being due to the strength of the connection. The difference
between the two clusters of Ô¨Çower visitors (pollinators) F1 and F2 derives from the
existence of Cluster P5 of plants.

288‚ÄÉ Bar-Hen et al.
Statistical Modelling 2022; 22(4): 273‚Äì296
Figure 3 Mesoscopic view of the interconnected network. The size of the nodes is proportional to the size
of the clusters and the width of the edges are proportional to the probability of connection between/within
clusters. Edges corresponding to probabilities of connection lower than 0.01 are not plotted. The letter in
the cluster name corresponds to the Ô¨Årst letter of the name of the functional group
In order to illustrate the contribution of our method, we also analyze each bipartite
network separately (using an LBM) and compare the results in terms of clustering.
The clusterings are compared through the ARIs, provided in Table 4.
Using standard LBM, we obtain 2 clusters of ants, 1 cluster of birds and 3 clusters
of pollinators. The clusterings of ants and birds are not modiÔ¨Åed by the ecosystemic
approach (ARI = 1). The clustering of the pollinators is slightly modiÔ¨Åed, going
from 3 clusters to 2 clusters, but the additional block only contains few individuals,
thus leading to a high ARI. Since the plants functional group is involved in the
three bipartite networks, we obtain three clusterings when analyzing them separately.
These three clusterings are‚Äîas expected‚Äîvery different from our MBM clustering
(the ARIs being respectively equal to 0.118, 0.415 and 0.163, see Table 4). When
aiming at proposing a clustering taking into account the three bipartite networks,

Block models for generalized multipartite networks‚ÄÉ 289
Statistical Modelling 2022; 22(4): 273‚Äì296
Table 4 Comparison of clusterings when the networks are jointly modelled by the MBM (denoted Full)
and when the networks are considered apart as bipartite networks. Inter denotes the clustering obtained by
intersecting the three clusterings on plants for each bipartite network. The selected number of clusters (in
parenthesis) and the ARIs are provided.
Full/Flovis
Full/Ants
Full/Birds
Full/Inter
Plants
(7/3)
(7/3)
(7/3)
(7/12)
0.118
0.415
0.163
0.617
Flovis
(2/3)
0.997
Ants
(2/2)
1.000
Birds
(1/1)
1.000
one may adopt a naive strategy by combining (by intersection) these three clusterings.
We then obtain 12 blocks of plants and the ARI with the MBM clustering is 0.617.
However, this number of clusters (12) is too large with respect to the model selection
criterion. Our MBM clustering is a parsimonious trade-off.
Finally, Figure 3 highlights the central role played by the pollinators in the
complete network also involving ants and seed dispersal birds. Our ecosystemic
approach unables us to unravel such a central position of pollinators in general with
respect to ants and seed dispersal birds, which would have been impossible when
performing separate analysis.
6.2 Seed circulation and crop species inventory
Dataset Seed circulation among farmers is a key process that shapes crop diversity
(Coomes et al., 2015; Pautasso et al., 2013). Data on seed circulation within a
community of Ô¨Årst-generation migrants (30 farmers) were collected by a Ô¨Åeld survey
in the island of Vanua Lava in the South PaciÔ¨Åc archipelago nation of Vanuatu. A
farmer is considered as a giver for another farmer if he/she has given at least one crop
since they arrived in the new settlement site in Vanua Lava. It results in a connected
and directed network of seed circulation. Besides the circulation network, inventory
data for each farmer were also collected. They consist in the list of crop landraces
they grow. This was aggregated at the species level, leading to 37 crop species. These
inventory data can be seen as a bipartite network. The seed circulation data were
analyzed in Thomas and Caillon (2016) and the inventory data were analyzed in
a meta-analysis in Thomas et al. (2015). On the basis on the joint modelling we
propose in this article, we aim to provide a clustering on farmers and crop species
on the basis of the seed circulation network and the inventory bipartite network.
Inference Three clusters of farmers and two clusters of crop species were selected.
The inferred parameters are given in Table A3 in supplementary material and a
mesoscopic view is displayed in Figure 4. The clusters were renumbered to make
them correspond to the probability of connection: the larger cluster number, the
larger marginal probability of connection for the members of the cluster.

290‚ÄÉ Bar-Hen et al.
Statistical Modelling 2022; 22(4): 273‚Äì296
Discussion The discovered clusters are straightforwardly interpretable: Cluster
F3 gathers farmers who circulate seeds within the cluster and give to the two other
clusters, Cluster F2 circulates seeds within the cluster contrary to Cluster F1 who
only receives from Cluster F3; the two clusters of crop species are Cluster S2 with
more common crop species and Cluster S1 with other species. Clusters F3 and F2 of
farmers grow crop species from Clusters S1 and S2, whereas Cluster F1 of farmers
grows mainly crop species from Cluster S2. It turns out that Cluster F3 gathers mainly
the Ô¨Årst migrants and Cluster F1 the last migrants. The pattern of connection is then
explained by the fact that Ô¨Årst migrants helped the others to settle by providing seeds.
Moreover, the Ô¨Årst migrants had more time to collect more crop species to grow. In
order to compare the clusterings obtained by the MBM and the ones obtained from
the circulation network (clustering on farmers from SBM) and the inventory network
(clusterings of farmers and plants with an LBM), we compute the ARI. The clusterings
on crop species remain quite close since their ARI is equal to 0.891. However, the
clusterings on farmers are quite different (ARI smaller than 0.3), indeed the MBM
shall make a trade-off between the circulation and the inventory for farmers. To
ease the comparison between clusterings on farmers, the same renumbering rule was
applied for all the different clusterings so that the larger cluster numbers correspond
to larger marginal probability of connection. Figure 5 is an alluvial plot which
compares the three obtained clusterings of farmers. It shows how the trade-off is
made between the two stand-alone clusterings in the MBM clustering. It appears
quite obvious that Cluster F1 given by the MBM gathers only farmers from Cluster
1 in the seed circulation network and from Clusters 1 and 2 from the inventory data
since this cluster aggregates farmers with fewer connections and who grow less crop
species than the others. The same kind of observation can be made for Cluster F3
given by the MBM which aggregates farmers who were in the cluster of the most
connected farmers and in the two clusters of farmers who grow more seed.
6.3 MBM validation on the two datasets
In order to validate the model on the real datasets, we resort to a cross-validation
strategy. We compare the prediction accuracy of missing values outputted by our
MBM with the one outputted by SBMs or LBMS Ô¨Åtted separately on the networks.
Since in most cases we achieve better prediction performance (measured through the
area under the ROC curve) with our MBM, this shows that the block structures
between the different networks are intertwined and then our MBM leverages it to
better recover the underlying structure. More details on this validation and detailed
results are available in the supplementary material.
7 Discussion
In this article, we proposed an extension of LBM and SBM which can handle
multipartite networks, resulting in the so-called MBM. Multipartite networks

Block models for generalized multipartite networks‚ÄÉ 291
Statistical Modelling 2022; 22(4): 273‚Äì296
Figure 4 Summarized network provided by the MBM. Nodes correspond to the clusters detected by the
MBM: Clusters of farmers are in red and clusters of crop species are in green. Size of a node is proportional
to the number of farmers or crop species belonging to the considered cluster. The width of the edges is
proportional to the probability of connection between/within clusters. The probability of connection below
0.2 are not plotted. The letter in the cluster name corresponds to the Ô¨Årst letter of the name of the
functional group
encompass a lot of various situations such as the two examples dealt with in the
article. Besides, MBM can be also useful for many other contexts with different
multipartite structures. The main limiting factor of the parameter inference and
model selection methods we propose is the size of networks. Indeed, the inference
algorithm is suitable for networks up to 1 000 nodes in order to keep computational
time reasonable. If willing at studying larger networks, one should develop adapted
inference algorithms.
Several extensions can be thought of with no additional signiÔ¨Åcant difÔ¨Åculty. For
instance, covariates can be taken into account by writing P(Xqq‚Ä≤
ii‚Ä≤ = 1|Zq
i = k, Zq‚Ä≤
i‚Ä≤ =
k‚Ä≤) = œÜ

Œ±qq‚Ä≤
kk‚Ä≤ + yqq‚Ä≤
ii‚Ä≤ Œ≤

where yqq‚Ä≤
ii‚Ä≤
are the covariates describing the pair of individuals
(i, i‚Ä≤). A more challenging extension could be to include extra parameters in the model

292‚ÄÉ Bar-Hen et al.
Statistical Modelling 2022; 22(4): 273‚Äì296
Figure 5 Alluvial plot comparing the clustering on farmers obtained from an SBM on the circulation
network (Circ.Net), an LBM on the inventory network (Inv.Net) and the MBM (MBM) on both networks. The
cluster numbers are related with the probability of connection; the larger cluster number, the larger
marginal probability of connection (between farmers for Circ.Net, between farmers and crop species for
Inv.Net)
to account for degree heterogeneity in the vein of the degree-corrected SBM (Karrer
and Newman, 2011). However, this should lead to cluster individuals independently
of their degrees which is not always desirable. For instance in the seed circulation
example, the in-degrees and out-degrees of farmers are key factors to explain their
social structure. In the interaction networks in ecology, distinguishing generalist (high
degree) from specialist (low degree) species is a part of the expected outcomes of the
clusterings. More recent works (Zhu et al., 2014) propose to use node degrees and
edge orientations to help the clustering while tolerating heavy-tailed distribution of
degrees. Incorporating these variants may be of interest in the MBM framework and
could lead to further developments.

Block models for generalized multipartite networks‚ÄÉ 293
Statistical Modelling 2022; 22(4): 273‚Äì296
In a more general perspective, the study of ecological or sociological interactions
supplies a wide variety of complex networks such as multilevel networks or multilayer
networks (Pilosof et al., 2017; Lazega and Snijders, 2015). Some of them can be
treated as multipartite networks and then by an MBM (possibly by incorporating
some extensions discussed above). The others require the development of suited
models which might also rely on a latent variable modelling. They will be the subject
of future works.
Supplementary materials
Supplementary materials for this article including R codes and data are available at
http://www.statmod.org/smij/archive.html.
Acknowledgements
We thank Sophie Caillon (CEFE) for sharing the seed circulation and inventory data,
Sophie Caillon and Mathieu Thomas (CIRAD) for related discussion concerning the
analysis. Support of the ongoing research collaboration through the MIRES network
was provided by the Institut National de Recherche pour l‚ÄôAgriculture, l‚ÄôAlimentation
et l‚ÄôEnvironnement (INRAE).
Declaration of conÔ¨Çicting interests
The authors declared no potential conÔ¨Çicts of interest with respect to the research,
authorship and/or publication of this article.
Funding
The authors disclosed receipt of the following Ô¨Ånancial support for the research,
authorship and/or publication of this article: P. Barbillon and S. Donnet are funded
by the ‚ÄôEcoNet‚Äô project, ANR-18-CE02-0010.
References
Airoldi EM, Blei DM, Fienberg SE and Xing
EP (2008) Mixed membership stochastic
blockmodels. Journal of Machine Learning
Research, 9, 1981‚Äì2014.
Almeida-Neto M, Guimaraes P, Guimaraes PR
Jr, Loyola RD and Ulrich W (2008) A
consistent metric for nestedness analysis in
ecological systems: Reconciling concept and
measurement. Oikos, 117, 1227‚Äì39.
Arroyo J, Athreya A, Cape J, Chen G, Priebe
CE and Vogelstein JT (2019) Inference for
multiple heterogeneous networks with a
common invariant subspace. arXiv preprint
arXiv:1906.10026.

294‚ÄÉ Bar-Hen et al.
Statistical Modelling 2022; 22(4): 273‚Äì296
Barber MJ (2007) Modularity and community
detection in bipartite networks. Physical
Review E, 76, 066102.
Barbillon P, Donnet S, Lazega E and Bar-Hen
A
(2017)
Stochastic
block
models
for
multiplex networks: An application to a
multilevel network of researchers. Journal
of the Royal Statistical Society: Series A
(Statistics in Society), 180, 295‚Äì314. doi:
10.1111/rssa.12193. URL https://rss.online
library.wiley.com/doi/abs/10.1111/rssa.
12193 (last accessed 26 October 2020).
Bickel
P,
Choi
D,
Chang
X
and
Zhang
H
(2013)
Asymptotic
normality
of
maximum likelihood and its variational
approximation for stochastic blockmodels.
Annals of Statistics, 41, 1922‚Äì43.
Biernacki C, Celeux G and Govaert G (2000)
Assessing a mixture model for clustering
with the integrated completed likelihood.
IEEE Transactions on Pattern Analysis and
Machine Intelligence, 22, 719‚Äì25.
Brault V, Keribin C and Mariadassou M (2017)
Consistency and asymptotic normality of
latent blocks model estimators (Working
paper
or
preprint). URL
https://hal.arc
hives-ouvertes.fr/hal-01511960
(last
accessed 26 October 2020).
Coomes OT, McGuire SJ, Garine E, Caillon
S,
McKey
D,
Demeulenaere
E,
Jarvis
D, Aistara G, Barnaud A, Clouvel P,
Emperaire L, LouaÔ¨ÅS, Martin P, Massol
F, Pautasso M, Violon C and Wenc‚Äìlius
J (2015) Farmer seed networks make a
limited contribution to agriculture? Four
common misconceptions. Food Policy, 56,
41‚Äì50.
D¬¥attilo
W,
Lara-Rodr¬¥ƒ±guez
N,
Jordano
P,
GuimarÀúaes PR, Thompson JN, Marquis
RJ,
Medeiros
LP,
Ortiz-Pulido
R,
Marcos-Garc¬¥ƒ±a
MA
and
Rico-Gray
V
(2016)
Unravelling
Darwin‚Äôs
entangled
bank:
Architecture
and
robustness
of
mutualistic
networks
with
multiple
interaction
types.
Proceedings
of
the
Royal Society of London B: Biological
Sciences,
283.
URL
https://royalsociety
publishing.org/doi/full/10.1098/rspb.2016.
1564 (last accessed 26 October 2020).
Daudin JJ, Picard F and Robin S (2008) A mixture
model for random graphs. Statistics and
Computing, 18, 173‚Äì83.
Dempster A, Laird N and Rubin D (1977)
Maximum likelihood from incomplete data
via the EM algorithm. Journal of Royal
Statistical Society: Series B, 39, 1‚Äì38.
DuBois
C,
Butts
C
and
Smyth
P
(2013).
Stochastic
blockmodeling
of
relational
event dynamics. In Proceedings of the
Sixteenth
International
Conference
on
ArtiÔ¨Åcial Intelligence and Statistics, pages
238‚Äì246. Scottsdale, AZ: AISTATS.
Gasko
N,
Bota
F,
Suciu
M
and
Lung
RI
(2017)
Community
structure
detection
in multipartite networks: A new Ô¨Åtness
measure. In Proceedings of the Genetic and
Evolutionary
Computation
Conference,
GECCO ‚Äô17, pages 259‚Äì265. New York,
NY: ACM.
Govaert G and Nadif M (2003) Clustering with
block mixture models. Pattern Recognition,
36, 463‚Äì73.
‚Äî‚Äî‚Äî (2008) Block clustering with Bernoulli
mixture models: Comparison of different
approaches. Computational Statistics and
Data Analysis, 52, 3233‚Äì45.
Hoff PD, Raftery AE and Handcock MS (2002)
Latent space approaches to social network
analysis. Journal of the American Statistical
Association, 97, 1090‚Äì98.
Huang W, Liu Y and Chen Y (2018) Mixed
membership
stochastic
blockmodels
for
heterogeneous networks. Bayesian Analysis,
15, 711‚Äì36.
Hubert L and Arabie P (1985) Comparing
partitions.
Journal
of
ClassiÔ¨Åcation,
2,
193‚Äì218. doi: 10.1007/BF01908075.
Karrer B and Newman ME (2011) Stochastic
blockmodels
and
community
structure
in
networks.
Physical
Review
E,
83,
016107.
K¬¥eÔ¨ÅS, Miele V, Wieters EA, Navarrete SA
and Berlow EL (2016) How structured
is the entangled bank? The surprisingly
simple organization of multiplex ecological
networks leads to increased persistence
and
resilience.
PLOS
Biology,
14,
1‚Äì21.

Block models for generalized multipartite networks‚ÄÉ 295
Statistical Modelling 2022; 22(4): 273‚Äì296
Keribin C, Brault V, Celeux G and Govaert G
(2014) Estimation and selection for the
latent block model on categorical data.
Statistics and Computing, 25, 1201‚Äì16.
Kim B, Lee KH, Xue L and Niu X (2018)
A review of dynamic network models
with latent variables. Statistics Surveys, 12,
105‚Äì35.
Kivel¬®a M, Arenas A, Barthelemy M, Gleeson
JP, Moreno Y and Porter MA (2014)
Multilayer networks. Journal of Complex
Networks, 2, 203‚Äì71.
Kolaczyk
ED
(2009)
Statistical
Analysis
of
Network Data: Methods and Models, 1st
edition. New York, NY: Springer Publishing
Company.
Lazega E and Snijders TAB (2015) Multilevel
Network Analysis for the Social Sciences:
Theory,
Methods
and
Applications‚Äì
Methodos Series. New York, NY: Springer
International Publishing.
Mariadassou
M
and
Matias
C
(2015)
Convergence
of
the
groups
posterior
distribution in latent or stochastic block
models. Bernoulli, 21, 537‚Äì73.
Mariadassou M, Robin S and Vacher C (2010)
Uncovering
latent
structure
in
valued
graphs: A variational approach. The Annals
of Applied Statistics, 4, 715‚Äì42.
Matias C and Miele V (2017) Statistical clustering
of temporal networks through a dynamic
stochastic block model. Journal of the
Royal Statistical Society: Series B (Statistical
Methodology), 79, 1119‚Äì41.
Pautasso M, Aistara G, Barnaud A, Caillon
S, Clouvel P, Coomes OT, Del‚Äìtre M,
Demeulenaere E, De Santis P, D‚Äìring T,
Eloy L, Emperaire L, Garine E, Goldringer
I, Jarvis D, Joly HI, Leclerc C and LouaÔ¨Å
S
(2013)
Seed
exchange
networks
for
agrobiodiversity conservation: A review.
Agronomy for Sustainable Development,
33, 151‚Äì75.
Pavlopoulos GA, Kontou PI, Pavlopoulou A,
Bouyioukos
C,
Markou
E
and
Bagos
PG (2018) Bipartite graphs in systems
biology
and
medicine:
A
survey
of
methods
and
applications.
GigaScience,
7. doi: 10.1093/gigascience/giy014. URL
https://doi.org/10.1093/gigascience/giy014.
giy014 (last accessed 26 October 2020).
Pilosof S, Porter MA, Pascual M and K‚ÄìÔ¨ÅS
(2017) The multilayer nature of ecological
networks. Nature Ecology & Evolution, 1,
0101.
Pocock MJ, Evans DM and Memmott J (2012)
The
robustness
and
restoration
of
a
network of ecological networks. Science,
335, 973‚Äì77.
Rubin DB (1976) Inference and missing data.
Biometrika, 63, 581‚Äì92.
Sengupta
S
and
Chen
Y
(2015)
Spectral
clustering
in
heterogeneous
networks.
Statistica Sinica, 25, 1081‚Äì1106.
Snijders TAB and Nowicki K (1997) Estimation
and prediction for stochastic blockmodels
for graphs with latent block structure.
Journal of ClassiÔ¨Åcation, 14, 75‚Äì100.
Sun Y, Yu Y and Han J (2009) Ranking-based
clustering of heterogeneous information
networks with star network schema. In
Proceedings of the 15th ACM SIGKDD
International Conference on Knowledge
Discovery
and
Data
Mining,
pages
797‚Äì806. URRL https://doi.org/10.1145/
1557019.1557107
(last
accessed
26
October 2020).
Tabouy T, Barbillon P and Chiquet J (2020)
Variational inference for stochastic block
models from sampled data. Journal of
the American Statistical Association, 115,
455‚Äì66.
Thomas M and Caillon S (2016) Effects of farmer
social status and plant biocultural value
on seed circulation networks in Vanuatu.
Ecology and Society, 21, 13.
Thomas M, Verzelen N, Barbillon P, Coomes
OT, Caillon S, McKey D, Elias M, Garine
E,
Raimond
C,
Dounias
E,
Jarvis
D,
Wencelius J, Leclerc C, Labeyrie V, Cuong
PH, Hue NTN, Sthapit B, Rana RB,
Barnaud A, Violon C, Reyes LMA, Moreno
LL, De Santis P, Massol F (2015) A
network-based method to detect patterns
of local crop biodiversity: Validation at the
species and infra-species levels. In Advances
in Ecological Research, volume 53, pages
259‚Äì320. Amsterdam: Elsevier.

296‚ÄÉ Bar-Hen et al.
Statistical Modelling 2022; 22(4): 273‚Äì296
Wang SS, Paul S, Logan J and De Boeck P (2019)
Joint analysis of social and item response
networks with latent space models. arXiv
preprint arXiv:1910.12128.
Xin L, Zhu M, Chipman H, et al. (2017). A
continuous-time stochastic block model for
basketball networks. The Annals of Applied
Statistics, 11, 553‚Äì97.
Xu
KS
and
Hero
AO
(2014)
Dynamic
stochastic blockmodels for time-evolving
social networks. IEEE Journal of Selected
Topics in Signal Processing, 8, 552‚Äì62.
Yang J and Leskovec J (2012). Community-
aliation
graph
model
for
overlapping
network community detection. In 2012
IEEE 12th International Conference on
Data Mining (ICDM), pages 1170‚Äì1175.
Piscataway, NJ: IEEE.
Zhu Y, Yan X and Moore C (2014) Oriented
and
degree-generated
block
models:
Generating and inferring communities with
inhomogeneous
degree
distributions.
Journal
of
Complex
Networks,
2,
1‚Äì18. doi: 10.1093/comnet/cnt011. URL
http://dx.doi.org/10.1093/comnet/cnt011
(last accessed 26 October 2020).

