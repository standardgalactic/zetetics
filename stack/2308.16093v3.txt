Linking discrete and continuous models of cell birth and migration
W. Duncan Martinson1, Alexandria Volkening2, Markus Schmidtchen3, Chandrasekhar
Venkataraman4, and Jos´e A. Carrillo1
1Mathematical Institute, University of Oxford, Oxford, UK
2Department of Mathematics, Purdue University, West Lafayette, Indiana, USA
3Institute of Scientific Computing, Technische Universit¨at Dresden, Dresden, Germany
4Department of Mathematics, University of Sussex, Brighton, UK
May 8, 2024
Abstract
Self-organisation of individuals within large collectives occurs throughout biology. Mathematical mod-
els can help elucidate the individual-level mechanisms behind these dynamics, but analytical tractability
often comes at the cost of biological intuition. Discrete models provide straightforward interpretations by
tracking each individual yet can be computationally expensive. Alternatively, continuous models supply a
large-scale perspective by representing the “effective” dynamics of infinite agents, but their results are often
difficult to translate into experimentally relevant insights. We address this challenge by quantitatively linking
spatio-temporal dynamics of continuous models and individual-based data in settings with biologically real-
istic, time-varying cell numbers. Specifically, we introduce and fit scaling parameters in continuous models
to account for discrepancies that can arise from low cell numbers and localised interactions. We illustrate
our approach on an example motivated by zebrafish-skin pattern formation, in which we create a continuous
framework describing the movement and proliferation of a single cell population by upscaling rules from a
discrete model. Our resulting continuous models accurately depict ensemble average agent-based solutions
when migration or proliferation act alone. Interestingly, the same parameters are not optimal when both
processes act simultaneously, highlighting a rich difference in how combining migration and proliferation
affects discrete and continuous dynamics.
Key Words: non-local interactions; zebrafish; self-organisation; aggregation equations
1
Introduction
Self-organisation of individual agents is a key feature of life. It occurs ubiquitously throughout the natural
world, from the macroscopic example of bird flocking [1–4] to the microscopic phenomenon of cell sorting
during development [5–9]. The degree to which members of a group coordinate their movement, proliferation,
and competition accounts for pattern diversity across biological scales. Alongside experimental approaches,
mathematical models can help identify the underlying behaviours that give rise to specific collective dynamics.
However, a trade-off often exists between tractability and detail when building models of pattern formation,
due in part to the multiscale nature of biological systems. Consequently, better quantitative characterisation
of the relationship between analytically tractable models and more biologically representative approaches will
improve our understanding of self-organisation throughout nature.
Here, we help address this open challenge using pigment cell dynamics in zebrafish patterns as a motivation.
The zebrafish (Danio rerio) is a popular model organism for studying pattern formation, as dark stripes and
gold interstripes emerge in its skin during development [10–13]. As we show in Fig. 1, these stripes result from
1
arXiv:2308.16093v3  [q-bio.CB]  7 May 2024

(a)
(c)
melanophore
dense xanthophore
<
l
a
t
e
x
i
t
 
s
h
a
1
_
b
a
s
e
6
4
=
"
Q
o
R
u
7
G
r
P
k
G
R
v
Z
U
t
Q
l
j
L
v
V
p
y
0
S
i
8
=
"
>
A
A
A
C
A
X
i
c
b
V
A
9
S
w
N
B
E
N
2
L
3
/
E
r
a
i
P
Y
L
A
b
B
K
t
x
F
U
c
u
A
j
a
W
C
M
Y
E
k
h
L
3
N
J
F
m
y
t
3
v
s
z
k
n
C
E
R
v
/
i
o
2
F
I
r
b
+
C
z
v
/
j
Z
t
4
h
S
Y
+
G
H
i
8
N
8
P
M
v
D
C
W
w
q
L
v
f
3
m
5
h
c
W
l
5
Z
X
V
t
f
z
6
x
u
b
W
d
m
F
n
9
8
7
q
x
H
C
o
c
i
2
1
q
Y
f
M
g
h
Q
K
q
i
h
Q
Q
j
0
2
w
K
J
Q
Q
i
0
c
X
E
7
8
2
j
0
Y
K
7
S
6
x
V
E
M
r
Y
j
1
l
O
g
K
z
t
B
J
7
c
J
+
E
2
G
I
a
Q
e
U
B
T
p
k
C
v
s
6
7
m
s
D
4
3
a
h
6
J
f
8
K
e
g
8
C
T
J
S
J
B
m
u
2
4
X
P
Z
k
f
z
J
A
K
F
X
D
J
r
G
4
E
f
Y
y
t
l
B
g
W
X
M
M
4
3
E
w
s
x
4
w
P
W
g
4
a
j
i
k
V
g
W
+
n
0
g
z
E
9
c
k
q
H
d
r
V
x
p
Z
B
O
1
d
8
T
K
Y
u
s
H
U
W
h
6
4
w
Y
9
u
2
s
N
x
H
/
8
x
o
J
d
i
9
a
q
V
B
x
g
q
D
4
z
6
J
u
I
i
l
q
O
o
m
D
d
o
Q
B
j
n
L
k
C
O
N
G
u
F
s
p
7
z
P
D
O
L
r
Q
8
i
6
E
Y
P
b
l
e
X
J
X
L
g
U
n
p
f
L
N
a
b
F
y
l
s
W
x
S
g
7
I
I
T
k
m
A
T
k
n
F
X
J
F
r
k
m
V
c
P
J
A
n
s
g
L
e
f
U
e
v
W
f
v
z
X
v
/
a
c
1
5
2
c
w
e
+
Q
P
v
4
x
u
I
C
p
e
L
<
/
l
a
t
e
x
i
t
>
(b)
⌦loc
0.0
0.2
0.4
0.6
0.8
1.0
1.2
potential
0.0
0.1
<
l
a
t
e
x
i
t
 
s
h
a
1
_
b
a
s
e
6
4
=
"
a
n
5
I
y
f
0
i
t
4
F
d
a
Y
F
r
0
x
Y
K
8
a
x
V
h
P
4
=
"
>
A
A
A
B
6
n
i
c
b
V
B
N
S
8
N
A
E
J
3
U
r
1
q
/
q
h
6
9
L
B
b
B
U
0
i
q
q
M
e
C
F
4
8
V
7
Q
e
0
o
W
y
2
m
3
b
p
Z
h
N
2
J
0
I
p
/
Q
l
e
P
C
j
i
1
V
/
k
z
X
/
j
t
s
1
B
W
x
8
M
P
N
6
b
Y
W
Z
e
m
E
p
h
0
P
O
+
n
c
L
a
+
s
b
m
V
n
G
7
t
L
O
7
t
3
9
Q
P
j
x
q
m
i
T
T
j
D
d
Y
I
h
P
d
D
q
n
h
U
i
j
e
Q
I
G
S
t
1
P
N
a
R
x
K
3
g
p
H
t
z
O
/
9
c
S
1
E
Y
l
6
x
H
H
K
g
5
g
O
l
I
g
E
o
2
i
l
B
8
/
1
e
+
W
K
5
3
p
z
k
F
X
i
5
6
Q
C
O
e
q
9
8
l
e
3
n
7
A
s
5
g
q
Z
p
M
Z
0
f
C
/
F
Y
E
I
1
C
i
b
5
t
N
T
N
D
E
8
p
G
9
E
B
7
1
i
q
a
M
x
N
M
J
m
f
O
i
V
n
V
u
m
T
K
N
G
2
F
J
K
5
+
n
t
i
Q
m
N
j
x
n
F
o
O
2
O
K
Q
7
P
s
z
c
T
/
v
E
6
G
0
U
0
w
E
S
r
N
k
C
u
2
W
B
R
l
k
m
B
C
Z
n
+
T
v
t
C
c
o
R
x
b
Q
p
k
W
9
l
b
C
h
l
R
T
h
j
a
d
k
g
3
B
X
3
5
5
l
T
S
r
r
n
/
h
V
u
8
v
K
7
W
r
P
I
4
i
n
M
A
p
n
I
M
P
1
1
C
D
O
6
h
D
A
x
g
M
4
B
l
e
4
c
2
R
z
o
v
z
7
n
w
s
W
g
t
O
P
n
M
M
f
+
B
8
/
g
B
R
L
o
0
f
<
/
l
a
t
e
x
i
t
>
⇥10−3
WMM(r)
WXX(r)
(d)
r
0.2
<
l
a
t
e
x
i
t
 
s
h
a
1
_
b
a
s
e
6
4
=
"
I
R
n
t
5
i
A
3
r
K
I
p
7
4
D
8
W
h
8
y
E
W
z
0
B
F
g
=
"
>
A
A
A
B
6
n
i
c
b
V
B
N
S
8
N
A
E
J
3
U
r
1
q
/
q
h
6
9
L
B
b
B
U
0
i
q
q
M
e
C
F
4
8
V
7
Q
e
0
o
W
y
2
m
3
b
p
Z
h
N
2
J
0
I
p
/
Q
l
e
P
C
j
i
1
V
/
k
z
X
/
j
t
s
1
B
W
x
8
M
P
N
6
b
Y
W
Z
e
m
E
p
h
0
P
O
+
n
c
L
a
+
s
b
m
V
n
G
7
t
L
O
7
t
3
9
Q
P
j
x
q
m
i
T
T
j
D
d
Y
I
h
P
d
D
q
n
h
U
i
j
e
Q
I
G
S
t
1
P
N
a
R
x
K
3
g
p
H
t
z
O
/
9
c
S
1
E
Y
l
6
x
H
H
K
g
5
g
O
l
I
g
E
o
2
i
l
B
8
+
t
9
s
o
V
z
/
X
m
I
K
v
E
z
0
k
F
c
t
R
7
5
a
9
u
P
2
F
Z
z
B
U
y
S
Y
3
p
+
F
6
K
w
Y
R
q
F
E
z
y
a
a
m
b
G
Z
5
S
N
q
I
D
3
r
F
U
0
Z
i
b
Y
D
I
/
d
U
r
O
r
N
I
n
U
a
J
t
K
S
R
z
9
f
f
E
h
M
b
G
j
O
P
Q
d
s
Y
U
h
2
b
Z
m
4
n
/
e
Z
0
M
o
5
t
g
I
l
S
a
I
V
d
s
s
S
j
K
J
M
G
E
z
P
4
m
f
a
E
5
Q
z
m
2
h
D
I
t
7
K
2
E
D
a
m
m
D
G
0
6
J
R
u
C
v
/
z
y
K
m
l
W
X
f
/
C
r
d
5
f
V
m
p
X
e
R
x
F
O
I
F
T
O
A
c
f
r
q
E
G
d
1
C
H
B
j
A
Y
w
D
O
8
w
p
s
j
n
R
f
n
3
f
l
Y
t
B
a
c
f
O
Y
Y
/
s
D
5
/
A
F
S
s
o
0
g
<
/
l
a
t
e
x
i
t
>
0.3
simpliﬁed agent-based model
precursor
di↵erentiation:
movement:
dMi
dt
velocity:
Mj(t)
Xi(t)
Mi(t)
position:
Figure 1: Motivating biological example and model. (a) Wild-type zebrafish feature stripe patterns in their
skin. These patterns consist of several types of brightly coloured pigment cells. (b) Over the course of a few
months, these cells organise sequentially into stripes and interstripes from the centre of the fish body outward
[10]. (c) For the purposes of this manuscript, we focus on a single population of black melanophores or gold
dense xanthophores, using a simplified version of the model from [21]. The agent-based model (ABM) [21]
that motivates our work describes how patterns arise through cell differentiation, competition, and movement.
In our simplified version of the ABM [21], we assume new cells appear at randomly selected locations based
on short-range activation; this models cell differentiation from uniformly distributed precursors (red position)
[21], and we also refer to this as “proliferation” or “birth” in this paper. (We describe the cell-differentiation
rules in the full model [21] in more detail in Supplementary Fig. 1.) In both our work and the ABM [21],
cell movement is deterministic and governed by ordinary differential equations (ODEs). (d) These ODEs ac-
count for cell–cell repulsion through potential functions, which describe melanophore–melanophore (WMM)
and xanthophore–xanthophore (WXX) interactions as a function of their pairwise distance r. Red scale bar
is 250 micrometres (µm) in (b). Image (a) adapted from Fadeev et al. [22] and licensed under CC-BY 4.0
(https://creativecommons.org/licenses/by/4.0/). Image (b) adapted from Frohnh¨ofer et al. [10]
and licensed under CC-BY 3.0 (https://creativecommons.org/licenses/by/3.0/); published by The
Company of Biologists Ltd.
the coordination of interactions among several types of cells, including black melanophores and gold (dense)
xanthophores [10, 14–18]. Experiments that perturb stripes—i.e., by laser ablation [14, 19]—demonstrate how
cell–cell signalling and external cues contribute to the creation of alternative motifs such as spots or labyrinths.
A rich diversity of mutant patterns, including widened or curvy stripes, also emerge when cell interactions are
altered due to genetic mutations [17, 20].
Data-driven mathematical models can help uncover the drivers of zebrafish pattern formation and other bio-
logical phenomena exhibiting self-organisation by identifying important phase transitions, isolating the effects
of specific processes such as cell division, and providing hypotheses that can guide the design of in vivo exper-
iments [23–26]. Different modelling frameworks yield insight at the population or individual level, depending
on how they represent members of a group. One modelling approach involves tracking how the position of each
individual changes in time. These so-called “discrete” systems include centre-based models [27, 28], cellular
automata [29, 30], cellular Potts models [31, 32], and vertex models [33, 34]. Within the setting of zebrafish
patterning, agent-based models (ABMs) have been developed that restrict cells to occupy certain locations “on-
lattice” [35–37] or allow them to roam freely, “off-lattice”, in the domain [21, 38–40]. Due to their ability to
work on the same length scales as empirical data, ABMs provide an intuitive connection to experiments and
allow for detailed predictions about how interactions between agents drive group behaviours. However, ABMs
can be prohibitive to simulate when the number of individuals is large, and understanding their long-time be-
haviour under alternative rules and parameters relies on extensive computation [41].
A second modelling approach uses continuous functions to represent the “average” density of agents in a
collective, with their dynamics governed by a partial differential equation (PDE) in space and time. Continu-
ous models, including reaction-diffusion equations, Boltzmann-like kinetic equations, and integro-differential
2

equations (IDEs), typically cannot resolve individuals and, instead, track the ensemble average (EA) behaviour
of a population. However, these models are more amenable to mathematical analysis and more readily provide
insight into long-term behaviour than discrete frameworks do [42, 43]. For example, changes in patterning
may arise because of Turing-like instabilities [44–46] or due to alterations in physically-based interactions
such as cell–cell adhesion [7, 38, 47–50]. In the case of zebrafish patterns, researchers have applied a wide
swath of continuous models—including reaction-diffusion equations [14, 19, 35, 51, 52] and non-local PDEs
[7, 53–55]—to better understand cell dynamics.
Despite the differences between discrete and continuous approaches, it is possible to establish a math-
ematical link between these representations in the limit of infinite individuals. This procedure, known as
“coarse-graining”, derives differential equations from a given discrete model and yields information about its
EA behaviour [56–62]. For example, the authors in [63–65] derive logistic IDEs from stochastic processes
that describe the birth and death of individuals undergoing Darwinian evolution in the limit of large numbers.
Coarse-grained descriptions become inaccurate when relatively few individuals are present, however, as is the
case in many biological contexts such as pattern formation in zebrafish. Many approaches also neglect poten-
tially important spatial correlations between cells—caused, for instance, by division or competition—that may
play a critical role in pattern dynamics [52, 66–71]. While it is possible to go beyond this “mean-field” setting
by deriving continuous models that respect higher-order correlations [72–76] and hard-core interactions [77],
these methods still rely on simplifying assumptions that introduce errors between the discrete and continuous
frameworks. Controlling these errors in a biological setting is an important objective.
We help tackle this problem by developing a pipeline to minimise spatio-temporal discrepancies between
continuous models and individual-based data in settings with biologically relevant, dynamic cell numbers. The
method relies on fitting parameters that effectively dilate the time variable of continuous-model solutions. Our
approach can be used to describe biological self-organisation in systems whose macroscopic description can be
derived or inferred. We apply our approach to a case study motivated by stripe formation in zebrafish skin, as
this allows us to illustrate its utility and interpretablity for experimentally measurable quantities with biologi-
cally meaningful spatial and temporal units. In §2, we describe the ABM that we simulate to generate synthetic
individual-based data associated with self-organising phenomena. In its full form, the ABM motivating our
work [21] admits pattern formation via non-local rules for cell birth, death, and movement that are inspired by
the underlying biology of zebrafish-skin patterns (Fig. 1) [21, 40]. To focus on the presentation of our pipeline,
however, we simplify some biological complexity by reducing this model [21] to focus on a single cell type—
melanophores or dense xanthophores, respectively. (We plan to extend this pipeline to multiple cell types in
future work.) We then detail the corresponding continuous descriptions and our method for matching their
solutions to EA ABM data even in scenarios with finite and time-dynamic cell numbers. We present our results
for black melanophores in §3, and—as a means of demonstrating the generality of our methodology—apply
the same approach to dense xanthophores in the Supplementary Information (SI)-§6.
2
Mathematical models and methods
In §2.1, we develop our ABM for cell migration and derive its continuous counterpart. Subsequently, in §2.2,
we introduce our discrete model for cell birth and develop a corresponding continuous IDE model. We present
our full models of migration and proliferation in §2.3. Lastly, we present our approach to estimating scaling
parameters in our continuous models from EA ABM data in §2.4. Following previous ABMs [21, 40] of pattern
formation in zebrafish, we assume (1) migration is governed by conservative forces between pigment cells and
(2) non-local interactions inform cell birth in a two-dimensional (2D) plane [21, 39, 40]. Throughout this paper,
3

we refer to:
Ω⊂R2 = domain of the simulation with spatial units of millimetres (mm),
R2 ∋Mi(t) = coordinates of the centre of the ith melanophore at t days in our discrete models,
N ∋NM(t) = total number of melanophores present at time t days, and
R≥0 ∋M(x, t) = density of melanophores at position x and time t in cells/mm2,
with the exception of Fig. 7 where we consider a one-dimensional (1D) domain; there M(x, t) is the num-
ber density of melanophores in cells/mm. Because it appears several times, we define the indicator function
1{condition} here, as:
1{condition}(x) =

1,
if x satisfies the rule specified by “condition”,
0,
otherwise,
(1)
where “condition” depends on the model rule and cell interaction, as we discuss next.
2.1
Models of migration
Our ABM for cell movement tracks the position, Mi(t), of each cell, indexed by i ∈{1, . . . , NM(t)}, at time t ≥0.
The movement of each melanophore depends on its interactions with surrounding melanophores, following an
overdamped version of Newton’s second law. The forces are assumed to be conservative, i.e., they may be
written as the gradient of a potential. This leads to the following system:
dMi
dt
≈F(i)
int = −
NM(t)
X
j=1,j,i
∇Wc
MM(Mi −M j).
(2)
Here, F(i)
int is the net force arising from all cell–cell interactions according to the potential WMM(r), where r is the
inter-particle displacement. The potential can encode cell–cell repulsion and adhesion, depending on the sign
of its gradient along the direction between two cell centres. Many choices for WMM(r) are possible, including
harmonic, power-law, Morse, and Lennard-Jones potentials, among others. Here we use exponential potentials
given by:
WMM(r) = RMMe−|r|/ωMM −AMMe−|r|/aMM,
(3)
in accordance with prior ABMs of pattern formation in zebrafish [21, 40]; see Fig. 1(c) and Table 1 for param-
eter values and their biological interpretations. To model cells communicating through cellular extensions or
dendrites [17, 18], secreted signals [78], or cell–cell contact [79], we assume forces on cells are zero beyond
some cut-off distance dmax. We represent this using the notation ∇Wc
MM(r) = ∇WMM(r) 1{|r| < dmax}(r), and set
NM(t) = NM when there is no cell birth. We remark that the model given by Eqn. (2) is deterministic in the
sense that it does not include Brownian motion.
The associated continuous model describes the melanophore density, M(x, t). Integrating M(x, t) over a
bounded region yields the total number of melanophores within that area at time t. Following the coarse-
graining procedure in [60, 80, 81], an outline of which is found in the SI-§1.1, we obtain the PDE below:
∂M
∂t = αMM∇·

M∇Wc
MM ⋆M

,
(4)
where the force ∇Wc
MM is the same as in Eqn. (2) and ⋆is the convolution operator [21, 40]. The parameter
αMM in Eqn. (4) is not inherent to the coarse-graining procedure; rather, it accounts for possible differences
between the discrete and continuous models. Indeed, simulating Eqn. (4) with the parameter values listed in
4

⇡250 µm
PDE
example ABM
(a)
(b)
ABM
(c)
(cells/mm2)
density
µ
Figure 2: The PDE for cell migration does not accurately describe the EA ABM result when its scaling param-
eter αMM is set to unity. (a) To compute our EA ABM result, we solve Eqn. (2) using an initial condition of
400 melanophores placed uniformly at random in a 1 mm × 1 mm square, group cell positions in a 240 × 240
histogram, and average such data over 104 ABM realisations. (b) We compute the corresponding PDE solution
by simulating Eqn. (4) with αMM = 1 from a uniform density of 400 cells/mm2 in the same square region. The
ABM and PDE solutions use the same potential (given by Eqn. (3) with parameters in Table 1). We overlay an
example ABM realisation for comparison; the results demonstrate that the support of the PDE is larger than that
of the ABM by about 200 to 250 µm. Because melanophore–melanophore distances have been measured to be
roughly 50 µm in vivo [82] and stripes are only about 7–12 cells wide [14], this is a large difference. (c) The
distribution of nearest-neighbor distances across 100 ABM realisations demonstrates that cell–cell separation
ranges from roughly 60 to 100 µm. Based on visual inspection of the graphs, nearest-neighbor distances appear
inversely proportional to the EA cell density. In (a)–(c), we show results at t = 150 days.
Table 1 and αMM = 1 (the value expected from the mean-field approximation) does not always capture the
ABM dynamics; see Fig. 2. The individual and EA ABM results demonstrate that cells disperse until they are
about 55–115 µm apart at t = 150 days. The PDE with αMM = 1, however, predicts that cells travel about 250
µm further in the same time period. Additionally, the PDE cell density is lower than the EA ABM density near
the centre of the domain, implying that cells are more separated there. The continuous solution at earlier times
more closely resembles the EA ABM result at t = 150 days, however, which suggests that PDE solutions evolve
at a faster time scale than that of the discrete model. The parameter αMM effectively dilates the time variable,
such that solutions travel αMM times more quickly. Thus, a non-unitary value of αMM is likely to produce a
better match between the discrete and continuous solutions. To our knowledge, the value of αMM cannot be
derived a priori. Instead, we develop an approach for estimating its value based on ABM data in §2.4, and will
pursue an analytic derivation for this parameter in future work.
2.2
Models of cell birth
Our ABM for cell birth consists of stochastic, discrete-time rules which we adapt and simplify from [21] (moti-
vation for these rules may be found in the SI-§1.2). Specifically, at each time step (i.e., day) in a simulation we
select Nbir ∈N locations uniformly at random from Ωand evaluate them synchronously for possible cell birth.
Each selected location, z, represents the position of a precursor cell that may differentiate into a melanophore
based on the signals that it receives. The conditions for melanophore birth in the ABM [21] depend on both
neighboring melanophores and dense xanthophores, as we show in Supplementary Fig. 1. Since we restrict to
one population in this manuscript, we simplify the rules from [21]; see SI-§1.2 for details. In particular, a new
5

melanophore emerges at position z according to the rule:
NM
X
i=1
1{Mi ∈Ωz
loc}(Mi) ≥1
|                        {z                        }
short-range activation
and
NM
X
i=1
1{Mi ∈Ωz
loc}(Mi) < c+
ABM
|                              {z                              }
overcrowding prevention
−→melanophore appears at z,
(5)
where c+
ABM ∈N, and
Ωz
loc = disk centred at z with radius dloc.
(6)
According to Eqn. (5), new cells appear near existing melanophores until the maximum number of cells—
namely, c+
ABM—in Ωz
loc, the interaction region between cells, is reached, see Table 1 for parameter values.
While Eqn. (5) is deterministic, stochasticity enters our ABM through our Nbir randomly selected positions {z}.
Similar stochastic rules can also be used to model cell death, as in [21, 40], although we do not consider them
here.
We do not know of existing methods for rigorously deriving continuous models of cell birth from off-lattice
ABMs with this noise structure. We therefore adopt a phenomenological modelling approach, in which we
create a phenomenological continuous model whose governing equations mimic the stochastic interaction rules.
We reason that the number density of cells in a continuous model must increase at a constant rate (proportional
to Nbir) when continuous versions of the overcrowding and short-range activation restrictions are met, since this
occurs at the individual level in the ABM. Furthermore, we represent the density restrictions with an indicator
function using the integral of the number density over Ωloc as an argument, since the latter quantity yields the
total number of cells within that region. This leads to the continuous model below:
∂M
∂t (x, t) = γNbir1(
1≤
R
Ωx
loc
M(y,t) dy < c+
)(x, t),
(7)
where c+ is the continuous equivalent of the density-limiting parameter c+
ABM in Eqn. (5); Nbir has the same
value as in our corresponding; and γ ∈R+ is a parameter that effectively dilates the time variable in a similar
way as αMM in the cell-movement model. The units of γ must be inversely proportional to those of the domain
size in order to make the dimensions of Eqn. (7) consistent. Its value is unknown, however we can employ a
phenomenological argument to determine an expected value by integrating Eqn. (7) over the whole domain.
This yields an upper bound on the number of cells born per unit time of γNbir|Ω|, hence one expects γ ≈|Ω|−1
to maintain a maximum rate of Nbir cells born per day as in our ABM. We note, however, that this argument
does not take into account possible clustering or other spatial correlations that can occur in the ABM, which
may change the values of γ and c+ from their expected values. While we could address this by allowing both
parameters to depend on the proportion of the domain in which the birth conditions are fulfilled, we leave this
extension for a future study and simply estimate uniform values for γ and c+ by fitting to EA ABM data, as we
do for αMM in the movement-only model. We overview our approach for estimating the values of c+ and γ in
§2.4.
2.3
Full models of cell movement and birth
We combine our descriptions of cell movement and proliferation to form our full discrete and continuous
models. For our full ABM, we move cells according to Eqn. (2) and then introduce new agents based on
Eqn. (5) at each simulated day; see the SI-§2 for details. For our continuous model, we combine the terms
related to movement and birth, such that the cell density evolves according to:
∂M
∂t (x, t) = αMM∇·

M∇Wc
MM ⋆M

+ γNbir1(
1 ≤
R
Ωx
loc
M(y,t) dy < c+
)(x, t),
(8)
6

Parameter
Value
Description and motivation
RMM
0.00124 mm2/day
Strength of melanophore repulsion potential in Eqn. (3); based on [21, 39]
AMM
0 mm2/day
Strength of melanophore adhesion potential in Eqn. (3); based on [21, 39]
ωMM
0.02 mm
Melanophore repulsion interaction range in Eqn. (3); based on [21, 39]
aMM
0.012 mm
Melanophore adhesion interaction range in Eqn. (3); based on [21, 39]
dmax
0.2 mm
Maximum cell interaction distance in Eqn. (2); based on [21, 39]
dloc
0.075 mm
Maximum interaction range for cell birth in Eqn. (6); based on [21] and
chosen slightly larger than measurements of cell–cell distances [82, 83]
Nbir
Varies
Number of positions selected uniformly at random per day for possible
cell proliferation (e.g., differentiation from precursors) in Eqns. (5) and
(7)
c−
1 cell
Lower bound for the number of cells in a short-range neighborhood for
cell proliferation in Eqns. (5) and (7)
c+
6 cells
Upper bound for the number of cells in a short-range neighborhood for
birth in Eqns. (5) and (7); based on estimations of data [14, 82] in [21]
tfinal
150 or 2, 000 days
Simulation end time (150 days in 2D and 2, 000 days in 1D)
∆tmove
0.01 or 0.1 days
Time step for numerical implementation of Eqns. (2) and (S3)
∆tbir
1 day
Time step for numerical implementation of cell birth in Eqns. (5) and (7)
∆tPDE
0.05 days
Time step for numerical implementation of Eqns. (4), (8), and (S6)
∆trecord
1 day
Time step for recording data from model simulations
Nsim
Varies
Number of ABM realisations for computing EA cell densities
Nbin
Varies
Spatial discretisation step for solving our continuous models
Nhist
Nbin or 30 voxels
Spatial discretisation step for binning simulations results for comparison
Table 1:
Model and simulation parameters used throughout the paper.
We note that Nbir
∈
{10, 25, 50, 100, 150, 200, 250} realisations for 2D simulations and Nbir ∈{1, 2, 3, 4, 5, 6, 7, 8, 9, 10} realisations
for 1D simulations. As we discuss in the SI-§2, Nsim = 5 × 103 realisations for most EA ABM solutions of
the cell-movement model and Nsim = 103 for all EA ABM results of the cell birth and combined models. We
set Nhist = 30 voxels for EA ABM solutions of the cell birth and combined models, and Nhist = Nbin for the
cell-movement model. (See figure captions for our Nbin values.) The value of RMM (and RXX, see the SI-§1.3)
were reported as repulsion strengths (i.e., RMM/ωMM) in [39].
where the parameters αMM, γ, Nbir, and c+ have the same interpretations as in §2.1 and §2.2. Importantly, by
assuming that these parameters have the same interpretations, we are assuming that migration and proliferation
are additive, so that combining them has no extra influence. Our fitting approach for these parameters, discussed
below, allows us to evaluate this choice and better understand the interplay of these two mechanisms in discrete
and continuous settings.
2.4
Parameter estimation procedure
We identify the values of the parameters—αMM in Eqn. (4) and {γ, c+} in Eqn. (7)—by minimising the sum
of squared differences (hereafter referred to as the “L2 error”) between the continuous and EA discrete solu-
7

Step 1:
Step 2:
Step 3:
Step 4:
Step 5:
<
l
a
t
e
x
i
t
 
s
h
a
1
_
b
a
s
e
6
4
=
"
4
V
C
H
j
6
y
5
p
o
q
a
s
Y
B
1
B
Q
H
s
A
o
1
Q
G
d
M
=
"
>
A
A
A
B
7
n
i
c
b
V
D
L
S
g
N
B
E
J
z
1
G
e
M
r
6
t
H
L
Y
B
A
8
h
d
2
I
D
z
w
F
v
H
i
M
a
B
6
Q
L
G
F
2
0
p
s
M
m
d
0
d
Z
n
q
F
s
O
Q
j
v
H
h
Q
x
K
v
f
4
8
2
/
c
Z
L
s
Q
R
M
L
G
o
q
q
b
r
q
7
A
i
W
F
Q
d
f
9
d
l
Z
W
1
9
Y
3
N
g
t
b
x
e
2
d
3
b
3
9
0
s
F
h
0
y
S
p
5
t
D
g
i
U
x
0
O
2
A
G
p
I
i
h
g
Q
I
l
t
J
U
G
F
g
U
S
W
s
H
o
d
u
q
3
n
k
A
b
k
c
S
P
O
F
b
g
R
2
w
Q
i
1
B
w
h
l
Z
q
P
S
A
o
e
n
H
T
K
5
X
d
i
j
s
D
X
S
Z
e
T
s
o
k
R
7
1
X
+
u
r
2
E
5
5
G
E
C
O
X
z
J
i
O
5
y
r
0
M
6
Z
R
c
A
m
T
Y
j
c
1
o
B
g
f
s
Q
F
0
L
I
1
Z
B
M
b
P
Z
u
d
O
6
K
l
V
+
j
R
M
t
K
0
Y
6
U
z
9
P
Z
G
x
y
J
h
x
F
N
j
O
i
O
H
Q
L
H
p
T
8
T
+
v
k
2
J
4
7
W
c
i
V
i
l
C
z
O
e
L
w
l
R
S
T
O
j
0
d
9
o
X
G
j
j
K
s
S
W
M
a
2
F
v
p
X
z
I
N
O
N
o
E
y
r
a
E
L
z
F
l
5
d
J
s
1
r
x
z
i
v
V
+
2
q
5
d
p
n
H
U
S
D
H
5
I
S
c
E
Y
9
c
k
R
q
5
I
3
X
S
I
J
y
M
y
D
N
5
J
W
+
O
c
l
6
c
d
+
d
j
3
r
r
i
5
D
N
H
5
A
+
c
z
x
9
b
2
I
7
h
<
/
l
a
t
e
x
i
t
>
(ODEs for cell–cell repulsion only)
(cells di↵erentiate at randomly selected
positions due to local activation)
Simplify ABM to one cell type
Simplify ABM to one cell type
continuum model for movement
continuum model for birth
Combine continuum models for movement and proliferation to form our full
PDE model and compare its dynamics to the full ABM ensemble average
Find {c+, γ} by minimising the di↵erence
between the proliferation-only ABM ensemble
average and IDE in time and space
Find ↵MM by minimising the di↵erence
between the movement-only ABM ensemble
average and PDE in time and space
Average ABM realisations and bin in
IDE-like mesh
<
l
a
t
e
x
i
t
 
s
h
a
1
_
b
a
s
e
6
4
=
"
C
J
p
V
y
0
s
i
G
R
o
I
/
4
S
4
5
Y
P
v
a
L
e
4
w
H
4
=
"
>
A
A
A
C
J
3
i
c
b
V
B
N
S
w
M
x
E
M
3
W
r
7
p
+
V
T
1
6
C
R
b
B
i
2
W
3
H
v
Q
k
b
V
X
Q
g
1
D
B
1
k
J
3
K
d
l
0
2
o
Z
m
s
0
u
S
F
U
r
p
v
/
H
i
X
/
E
i
q
I
g
e
/
S
e
m
2
x
6
0
d
S
D
w
e
P
M
m
b
+
Y
F
M
W
d
K
O
8
6
X
l
V
l
Y
X
F
p
e
y
a
7
a
a
+
s
b
m
1
u
5
7
Z
2
6
i
h
J
J
o
U
Y
j
H
s
l
G
Q
B
R
w
J
q
C
m
m
e
b
Q
i
C
W
Q
M
O
B
w
H
/
T
P
x
/
3
7
B
5
C
K
R
e
J
O
D
2
L
w
Q
9
I
V
r
M
M
o
0
Y
Z
q
5
c
4
8
C
k
K
D
Z
K
J
r
l
4
2
Q
d
A
G
X
K
z
f
Y
/
G
H
c
U
5
H
C
R
L
R
x
w
A
R
m
w
v
P
s
6
4
v
L
I
8
7
6
g
E
N
Q
v
V
Y
u
7
x
S
c
t
P
A
8
c
K
c
g
j
6
Z
V
b
e
V
e
v
X
Z
E
k
9
C
Y
U
k
6
U
a
r
p
O
r
P
0
h
k
Z
p
R
D
i
P
b
S
x
T
E
h
P
b
N
H
k
0
D
B
T
E
u
/
j
C
9
c
4
Q
P
D
N
P
G
n
U
i
a
J
z
R
O
2
d
8
T
Q
x
I
q
N
Q
g
D
o
w
y
J
7
q
n
Z
3
p
j
8
r
9
d
M
d
O
f
U
H
z
I
R
J
x
o
E
n
R
h
1
E
o
5
1
h
M
e
h
4
T
a
T
Q
D
U
f
G
E
C
o
Z
G
Z
X
T
H
t
E
E
m
q
S
U
7
Y
J
w
Z
0
9
e
R
7
U
i
w
X
3
u
F
C
8
L
e
Z
L
l
W
k
c
W
b
S
H
9
t
E
h
c
t
E
J
K
q
E
r
V
E
U
1
R
N
E
j
e
k
Z
v
6
N
1
6
s
l
6
s
D
+
t
z
I
s
1
Y
0
5
l
d
9
K
e
s
7
x
9
G
m
6
T
t
<
/
l
a
t
e
x
i
t
>
Average ABM realisations and bin in
PDE-like mesh
<
l
a
t
e
x
i
t
 
s
h
a
1
_
b
a
s
e
6
4
=
"
I
m
C
a
8
k
c
5
7
m
R
N
K
u
g
b
q
X
h
v
d
/
W
y
c
l
0
=
"
>
A
A
A
C
J
3
i
c
b
V
D
L
S
g
M
x
F
M
3
U
V
x
1
f
V
Z
d
u
g
k
V
w
Y
5
m
p
C
1
1
J
W
x
X
c
C
B
X
s
A
z
p
D
y
a
S
3
b
W
g
m
M
y
Q
Z
o
Q
z
9
G
z
f
+
i
h
t
B
R
X
T
p
n
5
g
+
F
t
p
6
I
X
A
4
9
9
y
c
e
0
8
Q
c
6
a
0
4
3
x
Z
m
a
X
l
l
d
W
1
7
L
q
9
s
b
m
1
v
Z
P
b
3
a
u
r
K
J
E
U
a
j
T
i
k
W
w
G
R
A
F
n
A
m
q
a
a
Q
7
N
W
A
I
J
A
w
6
N
Y
H
A
5
7
j
c
e
Q
C
o
W
i
X
s
9
j
M
E
P
S
U
+
w
L
q
N
E
G
6
q
d
u
/
A
o
C
A
2
S
i
Z
5
d
N
k
L
S
A
1
y
u
3
G
L
z
h
3
G
f
i
B
Q
m
o
o
M
D
J
j
A
T
n
m
d
X
r
6
5
P
O
B
s
A
D
k
H
1
2
7
m
8
U
3
A
m
h
R
e
B
O
w
N
5
N
K
t
q
O
/
f
q
d
S
K
a
h
M
a
U
c
q
J
U
y
3
V
i
7
a
d
E
a
k
Y
5
j
G
w
v
U
R
A
T
O
j
B
7
t
A
w
U
x
L
j
4
6
e
T
O
E
T
4
y
T
A
d
3
I
2
m
e
0
H
j
C
/
p
5
I
S
a
j
U
M
A
y
M
M
i
S
6
r
+
Z
7
Y
/
K
/
X
i
v
R
3
X
M
/
Z
S
J
O
N
A
g
6
N
e
o
m
H
O
s
I
j
0
P
D
H
S
a
B
a
j
4
0
g
F
D
J
z
K
6
Y
9
o
k
k
1
C
S
n
b
B
O
C
O
3
/
y
I
q
g
X
C
+
5
p
o
X
h
X
z
J
c
q
s
z
i
y
6
A
A
d
o
m
P
k
o
j
N
U
Q
j
e
o
i
m
q
I
o
k
f
0
j
N
7
Q
u
/
V
k
v
V
g
f
1
u
d
U
m
r
F
m
M
/
v
o
T
1
n
f
P
1
G
L
p
P
Q
=
<
/
l
a
t
e
x
i
t
>
Generate many ABM realisations with cell
birth only
Generate many ABM realisations with cell
movement only
Figure 3: Our modular pipeline for matching the solutions of continuous and discrete models and identifying
how cell movement and birth interact in both settings. We first isolate the discrete-model terms from [21]
corresponding to movement (left column) and birth (right column) and simplify them to consider only one
cell type. We then produce multiple realisations of our ABMs, sorting the cell locations into a grid of Nhist ×
Nhist voxels to yield the EA discrete model results. We simulate our continuous model for cell movement
(respectively cell birth) and compare it on the same spatial mesh, with values of αMM (respectively c+ and γ)
obtained from a least squares optimisation approach; see the SI-§2 for details. Finally, we combine the fitted
movement and birth models to produce our full continuous model. While an extension of this pipeline to fit all
three parameters simultaneously is straightforward, fitting separately allows us to better understand the effects
of cell movement and birth in discrete and continuous frameworks.
tions over time and space. Because we are able to model the isolated processes of cell birth and movement
separately, or consider them acting simultaneously, there are two ways of estimating parameters: by fitting all
three parameters simultaneously to data from the combined model, or by fitting them in a modular fashion by
considering cell movement and birth in isolation from each other. For the remainder of this paper, we adopt
a modular approach because it allows us to probe the particular effects of cell movement and birth in detail
(Fig. 3 for an overview), and we present a study of simultaneous estimation in the SI-§3. In particular, by
using our modular parameter values in the combined PDE model, we can investigate their interplay and better
understand the additive effects of individual-level mechanisms on the accuracy of continuous models. As we
discuss in the SI-§3, our modular approach may also supply additional information that can improve parameter
estimation. For example, we show in the SI-§3 that αMM and γ are not uniquely identifiable if they are fit only
to the combined EA ABM data, whereas Fig. 4(b) and Fig. 7(f) suggest we can uniquely identify them with a
modular approach. We overview our method for parameter estimation below; for parameter values, see Table 1.
We refer to the SI-§2–§3 for further details about our implementation of the pipeline in addition to alternative
choices that could be taken in parameter estimation (such as fitting to earlier times, less refined spatial data,
etc.).
We consider biologically meaningful time scales (i.e., days), length scales (i.e., mm), and cell densities and
stress empirical units throughout our results. This choice supports future studies that may treat pattern formation
with multiple cell types. Throughout our simulations, we consider a domain of size 3 mm × 3 mm (with one 1D
exception in Fig. 7). We implement four initial conditions to extract common features of cell interactions from
different geometric scenarios. The first involves a square region of melanophores in the centre of the domain
8

(“Box”), which mimics the symmetry of the domain. For the second initial condition, we place a single stripe of
melanophores (“Stripe”), which is motivated by the typical patterning observed in wild-type zebrafish. For the
third initial condition, we consider two rectangular regions of melanophores (“Offset rectangles”), which take
into account non-standard geometries and the meeting of two disjoint melanophore populations. Finally, the last
initial condition we consider involves two melanophore stripes (“Two stripes”), which explores the interactions
between two disjoint melanophore populations with biologically realistic sharp fronts. (See Supplementary
Fig. 6 for a summary of these initial conditions.) We initialise individual ABM simulations by sampling cell
positions uniformly in these regions for each respective initial condition, and initialise our continuous models
by setting the cell density uniformly equal to the estimated biological density of 400 cells/mm2 [21].
In Step 2 of our pipeline in Fig. 3, we solve our discrete models with an explicit approach. Specifically,
we solve Eqn. (2) with an explicit forward Euler scheme. To model differentiation from uniformly distributed
precursor cells [21], we solve the birth-only ABM by selecting Nbir sites in the domain uniformly at random at a
fixed time step (here, 1 day) and placing a new cell at each position that meets the conditions given by Eqn. (5).
(Following the approach in [21, 39, 40], we evaluate all Nbir locations for potential cell proliferation at the same
time. This synchronous evaluation means that it is possible, though uncommon, for more than c+
ABM cells to be
present in a local neighborhood, and the choice of parameters in our model, based on the ABMs [21, 39, 40],
accounts for this possibility.) We solve our ABM combining migration and birth by simulating Eqn. 2 and then
implementing cell birth as above, with migration evaluated using a shorter time step than the time step for birth
events.
To compare ABM results directly with the cell density from our continuous models, we obtain an EA
distribution by simulating many ABM realisations (here, between 103 and 104 simulations), sorting all the cell
locations into a histogram of Nhist × Nhist voxels (or Nhist × 1 voxels in 1D), and normalising by the number
of simulations and the voxel area for each day simulated; see Step 3 of our pipeline in Fig. 3. Other ways
of relating ABM and PDE results are also possible, for example by introducing Gaussian kernels at each cell
location [84]. However, as far as the construction of the histogram is concerned, we expect comparable results
for particles and localised Gaussian kernels. Furthermore, we show in the SI-§3 that histogram voxel size used
to bin EA ABM data and the final time used to fit the continuous equations only play a minor role in affecting
the parameter values we obtain, at least for the cell-movement model.
As part of Step 4 of our pipeline in Fig. 3, we need to solve our continuous models, and we do so with
explicit approaches. Specifically, we apply a first-order finite volume scheme for the migration model (Eqn. (4)),
a forward Euler method for the continuous cell birth model (Eqn. (7)), and a combined finite volume/forward
Euler scheme for the full continuous framework (Eqn. (8)). (More details about the particular time steps used
to simulate the discrete and continuous models are in the SI-§2.) We simulate the continuous models on an Nbin
× Nbin mesh and, to match with EA ABM solutions, record the average cell density at each day on a (possibly
coarser) grid of Nhist × Nhist voxels.
We compute continuous model parameters by minimising either the L2 error between the continuous and EA
ABM results across time. Notably, this nonlinear least-squares problem is equivalent to maximum likelihood
parameter estimation when the densities produced from the ABM simulations are independent, identically
distributed normal random variables with constant variance and mean equal to the continuous solution. The L2
error that we minimise is given by:
e2
L2 = ∥Mcts −MABM∥2
L2 =
Z t=tfinal
t=0
Z
Ω
 Mcts(x, t) −MABM(x, t)2 dxdt
≈∆trecord∆x∆y
NT
X
n=0
Nhist
X
i=1
Nhist
X
j=1
(M(n)
cts,i,j −M(n)
ABM,i,j)2,
(9)
where ∆trecord denotes the time steps at which data are collected; ∆x and ∆y are the spatial step sizes of the
histogram used to compare the EA ABM and PDE data; M(n)
cts,i,j is the continuous-model solution at time tn and
position (xi, yj); and M(n)
ABM,i,j is the corresponding EA ABM result. For the birth-only model we consider fitting
9

to either the L2 error as above or simply the difference in the total cell count of the two data sets (we verify in
the SI-§2 (Supplementary Table 4) that fitting to the L2 error produces similar parameter estimates). When we
consider cell birth, we simulate our models with different values of Nbir and estimate parameters by minimising
the sum of the errors across these Nbir values. We fit parameters related to cell proliferation sequentially—that
is, we determine the optimal value for c+ before γ. We verify in 1D that sequential and simultaneous estimation
does not lead to significant difference in parameter values; see the SI-§3.
3
Results
We now present our results linking discrete and continuous models of cell migration (§2.1), birth (§2.2), and
migration and birth (§2.3). We first isolate each interaction process, separately identifying the values of αMM in
Eqn. (4) and {γ, c+} in Eqn. (7). As we note in §2.4, this choice allows us to extract the distinct effects of each
mechanism. We then determine how this simplification affects the ability of the full continuous framework,
given by Eqn. (8), to approximate EA ABM solutions. By considering different initial conditions (we discuss
the details and motivations for these in the SI-§4), we demonstrate the robustness of our fitting procedure.
Our results show how the time scales of proliferation and movement in our continuous model may depend on
numerical implementation and the frequency of stochastic cell birth controlled by Nbir. Moreover, our modular
fitting approach highlights important considerations to account for in more general systems where agents are
moving and changing in number.
3.1
Cell migration
We estimate αMM, the scaling parameter that controls the dynamics of melanophore movement. Fig. 4(a)
presents the values of αMM that minimise the squared L2 error between the continuous solution of Eqn. (4) and
EA ABM results for our four initial conditions (see §2.4 and the SI-§2–4). In each case, the optimal value
of αMM is positively correlated with our PDE mesh resolution, i.e., greater values of αMM are associated with
larger Nbin = Nhist values. This unitless parameter appears to converge to around 0.60 to 0.66 as the mesh
resolution increases. There is at most a 2.5% relative difference between the values of αMM that we find when
Nbin = 240 versus when Nbin = 480 for our Box initial condition. These results suggest that αMM is independent
of the mesh resolution when the latter contains at least 240 × 240 voxels, corresponding to a mesh spacing of
12.5 µm. As we show in Fig. 2(c), melanophores tend to separate by between 60–100 µm in our ABM results,
so this mesh spacing is less than one quarter of the typical distance between agents.
At each mesh resolution in Fig. 4(a), the estimated optimal value of αMM does not appear to depend greatly
on the initial condition. For example, in the case of a mesh with Nbin = Nhist = 240, the maximum relative
difference between the four parameter values is at most 6.5%. This similarity suggests that there is an inher-
ent time scale at which migratory melanophore–melanophore interactions occur. Fig. 4(b), which presents the
log L2 error for Nbin = 240 as a function of αMM, further supports this conclusion. Although the errors associ-
ated with different initial conditions can vary by an order of magnitude, the minimum value of each (roughly
convex) curve appears nearly identical and is located near the values shown in Fig. 4(a).
Fig. 5 presents snapshots of the EA ABM results across 104 realisations of Eqn. (2) and the optimised
PDE solution associated with the Box initial condition. The first row shows the expansion in time of the EA
ABM support, i.e., the area occupied by the cells, due to melanophore–melanophore repulsion. For more
intuition, we superimpose the cell positions from one ABM realisation on our number-density results in this
figure and throughout the manuscript. In all cases, we crop out approximately the upper half of cell positions.
Visual inspection of cell positions in Fig. 5 suggests that melanophore–melanophore distances increase near
the edge of the collective. Similarly, the speed at which the support expands appears to slow down for the EA
ABM result, consistent with melanophores experiencing weaker forces from comparatively distant cells in this
region.
10

↵MM (unitless)
(a)
(b)
↵MM (unitless)
2: Stripe
1: Box
3: O↵set rectangles
4: Two stripes
Initial condition
480
360
240
120
0
Nbin
50 µm
25 µm12.5 µm
6.25 µm
Figure 4: The optimal PDE scaling parameter for movement depends on the mesh resolution but appears to
converge. (a) A scatter plot of the numerically optimised value of αMM from Eqn. (4) as a function of the mesh
resolution, Nbin, demonstrates that this scaling parameter is correlated with the mesh resolution, but appears
to converge at sufficiently high (i.e., Nbin ≥240) detail. (We omit 95% confidence intervals because these are
so narrow that they are difficult to see.) (b) Plotting the log L2 error, given by Eqn. (9), as a function of αMM
with Nbin = 240 for each initial condition suggests that the values in (a) are optimal. As we show in Fig. 2(c),
melanophores are typically separated by more than 60 µm in our movement-only ABM simulations—over four
times the voxel width in a grid with Nbin = 240. See §2.4 and the SI-§2 for numerical details.
We also observe in Fig. 5(a)–(d) that a band of high cell density emerges around the edge of the support
which surrounds a ring-like region of low density. These bands may result from the combined effects of cell–
cell repulsion and the fine mesh resolution that we use to sort agent positions in the EA solution. Repulsion
causes cells at the edge of the collective to travel towards empty regions, while more centrally located agents
move more slowly due to the balance of forces from their neighbours. When repulsion separates cells by
distances greater than the mesh resolution, we expect regions of low density within the solution support to
appear. These oscillatory bands should become less evident when the repulsive potentials in Fig. 1(d) exhibit
shallower gradients, as this permits cells to cluster more closely, or when coarser histograms with fewer bins are
used to visualise the EA ABM data. As we discuss in the SI-§6, the forces acting on xanthophores are about an
order of magnitude smaller than those for melanophores, and we indeed observe less pronounced bands there.
Notably, fitting to EA ABM data on coarser histograms lead to similar parameter estimates; see the SI-§3 for
details.
We present snapshots of the continuous model, Eqn. (4), under our estimated value of αMM in Fig. 5(e)–(h).
This PDE solution captures the dynamics of our example ABM realisation significantly better than the case
in Fig. 2(b), when αMM = 1. However, unlike the EA ABM result, the PDE does not exhibit bands of high
and low cell density. This discrepancy can be further appreciated in Fig. 5(i)–(k), which presents snapshots
of the pointwise difference between the PDE and EA ABM solutions. Here positive values indicate that the
discrete solution is larger than the continuous one. The lack of bands in the PDE setting is likely because the
mean-field assumption used to derive the continuous system is invalid where density is low. We do not expect
this discrepancy to be as pronounced in models that include cell birth, as this mechanism increases density; see
§3.3. Moreover, the PDE support expands more quickly than that of the ABM. This result is likely due to our
choice of error function to fit αMM. Specifically, this parameter is biased towards values that produce accurate
approximations in the bulk as these regions have a larger contribution to the L2 norm. Since we have already
determined the assumptions underlying the continuous model break down in low density regions, however, we
choose to fit to the bulk of the cell density and focus on the L2 difference.
To demonstrate that our observations for the Box case are consistent across initial conditions, we compare
the EA ABM and PDE dynamics for the Stripe and Two stripes initial conditions in Fig. 6; Supplementary
Fig. 7 presents results for the Offset rectangles initial condition. In Fig. 6(a)–(d), the column-averaged PDE
11

(a)
(b)
(c)
(d)
(e)
(f)
(g)
(h)
(k)
(j)
error
(cells/mm2)
(i)
(cells/mm2)
density
example ABM
ABM
PDE
ABM −PDE
Figure 5: Melanophore movement models with our Box initial condition. We present (a)–(d) snapshots of the
EA cell density (cells/mm2) across 104 ABM realisations, (e)–(h) the corresponding PDE results using the
optimal value of αMM for a mesh resolution of Nbin = 240, and (i)–(k) the error between the PDE and EA ABM
densities. We overlay cell positions for one example ABM simulation (black points) as a visual guide; we show
roughly half of the region occupied by these cells. A difference in cell density of 150 cells/mm2 in a given
voxel corresponds to about 0.0234 cells for this choice of mesh resolution. We find that the average pointwise
errors (over voxels where at least one of the EA ABM or PDE solutions is non-zero) are about 28 cells/mm2,
17 cells/mm2, 17 cells/mm2, and 17 cells/mm2 at t = 0, 50, 100, and 150 days, respectively. (These values
correspond, respectively, to roughly 7%, 4%, 4%, and 4% of the maximum cell density of 400 cells/mm2).
solution, i.e., the solution average over the x variable, has a larger support than that of the EA ABM and does
not exhibit oscillatory bands. (Comparing column averages is justified because both results are nearly uniform
along the x-axis.) Nevertheless, the continuous solution closely approximates the EA ABM density, particularly
in regions where the latter is high. For example, we find that the average pointwise error (over voxels where
at least one of the EA ABM or PDE solution is non-zero) is equal to about 40 cells/mm2 at t = 0 days, 24
cells/mm2 at t = 50 days, 23 cells/mm2 at t = 100 days, and 23 cells/mm2 at t = 150 days (these correspond
to roughly 10%, 6%, 6%, and 6% of the maximum cell density of 400 cells/mm2, respectively). Both solutions
invade empty space in time, and the speed of this travelling wavefront appears to slow as cells become more
diffuse. For the Two stripes initial condition in Fig. 6(e)–(h), the ABM and PDE predict that cells move into
12

(a)
(b)
(c)
(d)
(e)
(f)
(g)
(h)
ABM
PDE
Figure 6: Melanophore movement models with our Stripe and Two stripes initial conditions. (a)–(d) We present
snapshots of the column-averaged cell density (cells/mm2, black solid line), generated from 103 ABM realisa-
tions for the Stripe case, alongside the corresponding PDE solution (dashed red line) under a mesh resolution
of Nbin = 240 and our optimised value of αMM. (e)–(f) Similarly, we show snapshots of the column-averaged
density, generated from 103 ABM realisations for the Two stripes case, and the corresponding PDE solution.
The 2D solutions are nearly uniform in the x-direction (data not shown).
the initially empty space between stripes to approach a characteristic profile also observed in the one-stripe
case. The EA ABM model does not appear to form oscillatory bands in the interstripe region, corroborating
our hypothesis that these bands are more likely to arise near the edge of the solution support. In this case, the
average pointwise error between the continuous and discrete data is roughly 18%, 11%, 11% and 11% of the
maximum cell density at t = 0, 50, 100, and 150 days, respectively.
3.2
Cell birth
We identify the density-limiting parameter c+ and growth rate γ in our IDE model, Eqn. (7), by comparing with
agent-based data from Eqn. (5). Importantly, the dynamics of discrete-model proliferation, unlike cell migra-
tion, involve stochasticity beyond the initial condition. To gain intuition, we thus start with 1D simulations:
for each value of Nbir ∈{1, 2, . . . , 10}, we compute the EA of 103 ABM realisations from an initial condition
in which a single melanophore is placed at the origin in a 1D domain. In Fig. 7(a) we show the EA result
for Nbir = 1 and the corresponding IDE model solution with the optimal values of γ and c+ in Fig. 7(b). The
continuous solution appears to have a smaller radius of support than the EA ABM result at every time point; see
Fig. 7(c). This result holds across all Nbir values in Fig. 7(d). While the IDE predicts a piecewise linear growth
of the total number of cells, the corresponding EA ABM result increases linearly before slowly saturating as
the domain fills, as we depict in Fig. 7(e). This behaviour likely arises from our overcrowding condition that
prevents cell densities from exceeding c+. As the domain fills with cells, it becomes less likely to select a lo-
cation z that satisfies the overcrowding condition in the ABM. This reduces the population growth rate at later
13

(a)
(b)
(c)
error (cells/mm2)
density (cells/mm2)
ABM
ABM −IDE
IDE
(e)
(f)
(d)
number of cells
time (days)
IDE
ABM
1
2
3
4
5
6
7
8
9
10
Nbir
time (days)
radius of support (mm)
⇥106
0.5
1.5
2.5
3.5
4
6
8
10
0.15
0.25
0.35
γ (mm−1)
Figure 7: Melanophore birth models with a baseline initial condition of one cell at y = 0 in a 1D domain. Results
in (a)–(c) are for Nbir = 1 position/day. (a) We compute the EA ABM result by simulating 103 realisations of
our ABM birth model, Eqn. (5), and binning cell positions in a histogram with 0.1 mm-wide voxels (i.e.,
Nhist = 30). (b) We use a finer mesh resolution to solve our corresponding IDE model (Eqn. (7)) before
transferring results to the same histogram in (a) to perform parameter estimation. Here we show our IDE
solution produced with optimal parameter values c+ = 7.592 cells and γ = 0.2822. (c) The difference between
our discrete and continuous results highlights that the ABM support is wider than the PDE support. (d) This
is also visible by comparing their mean radii of support in time. To compute the mean radius of support for
the ABM at a given time, we find the most distant melanophore from y = 0 for each simulation and average
across these values. (e) Cell mass grows linearly in both models at first, but stochastic effects coupled with our
overcrowding condition drive down the growth rate of the ABM as the domain fills with cells. (f) Plotting the
squared L2 space-time difference between the discrete and continuous densities, summed over all Nbir values
considered (namely Nbir = 1, ..., 10), as a function of the density-limiting parameter c+ and birth-rate scaling
parameter γ highlights its convex shape in c+ and lesser sensitivity to γ. We compute this L2 difference using
a time step of 10 days here, and our results are based on 103 simulations for each Nbir value; see the SI-§3 for
parameter values under alternative choices in our estimation process.
times. In contrast, the IDE model specifies that the support increases by the same amount at each time step until
it reaches the domain boundaries. As we discuss in §4, capturing discrete model behaviour more accurately at
higher cell numbers may require replacing γ in our IDE with a density-dependent function.
Our 1D simulations provide a baseline case to test our estimation process. As we note in §2.4, we employ
a sequential procedure, first fitting c+ with γ = |Ω|−1 and then estimating γ with c+ fixed. In the 1D case, this
leads to optimal values c+ = 7.592 cells and γ = 0.2822. If we instead estimate both parameters simultaneously,
we find c+ = 7.430 cells and γ = 0.2902. This is a difference of about 2.1% in c+ and 2.8% in γ, suggesting
that sequential estimation reduces computational complexity without strongly affecting parameter values. To
understand if a coarser discrepancy measure based only on cell numbers at each time is sufficient, we also fit c+
and γ by minimising the squared difference in the total cell numbers over time ; see the SI-§2, Supplementary
Table 4 for the resulting parameter values. The corresponding parameter estimates differ from the density-based
14

(a)
(b)
(c)
(d)
(e)
(f)
(g)
(h)
(i)
Nbir
10
25
50
100
150
200
250
(l)
(j)
(k)
example ABM
(cells/mm2)
density
error
(cells/mm2)
ABM
ABM −IDE
IDE
IDE
ABM
Figure 8: Melanophore proliferation models with our Box initial condition. Results in (a)–(h) and (j)–(l) are
for Nbir = 150 positions/day. We compute (a)–(d) the EA ABM result across 103 simulations, and (e)–(h) the
solution of our IDE model with optimal parameters c+ = 8.564 and γ = 0.1274. (i) Our continuous model
captures the mean number of cells in our ABM simulations for different Nbir values well across time. (j)–(l)
As in the 1D case in Fig. 7, the difference between the IDE and EA ABM results demonstrates that the ABM
support extends beyond the IDE support. To provide more intuition, we overlay roughly half of the cell positions
from an example ABM simulation in (a)–(h) and (j)–(l). See Supplementary Fig. 8 and Supplementary Table 4
for corresponding simulations using our Offset rectangles initial condition.
case by approximately 1.2% for and c+ and γ, suggesting both error measures are reasonable. Both approaches
also appear to exhibit similar sensitivity as parameters are varied (compare Figs.7(f) and Supplementary Fig. 2).
Fig. 8 and Supplementary Fig. 8, respectively, show that proliferation in 2D broadens the solution support
from the Box and Offset rectangles initial conditions over time, and the IDE model accurately captures the total
cell mass of the ABM system for all Nbir values considered. Our estimated optimal values of c+ and γ for these
two initial conditions differ by about 2.5% and 0.31%, respectively, suggesting that our estimation procedure
is robust to the initial condition. We also highlight that a region of higher density forms at the edge of the
initial condition’s support for both the ABM and IDE in Fig. 8(a)–(h). Indeed, if z is near the support boundary,
15

(a)
ABM
PDE, theoretical c+
PDE, estimated c+
(cells/mm2)
density
(b)
(c)
example ABM
c+ = 400 cells/mm2 ⇥|⌦loc|
600
ABM: birth
requires less
than c+
ABM cells
Figure 9: A modular approach to fitting parameters for cell movement and birth does not account for the inter-
play between these two mechanisms. We show results in (a)–(c) at t = 100 days for Nbir = 150 positions/day.
(a) The solution of our full PDE model (Eqn. (8)) with the values of αMM and {c+, γ} that we fit based on ABM
simulations of cell movement and birth, respectively, captures the support of the ABM EA result, but not its
density. (b) In comparison, the density for the full discrete model is roughly 400 cells/mm2. (c) By integrating
this density, which is based on empirical estimates of melanophore–melanophore distances [21, 82], over an
Ωloc-region, we find that c+ ≈7.0686 cells. With this value of c+, alongside the values of αMM and γ that we
estimated for migration and birth individually, our PDE produces cell densities that more accurately represent
the ABM dynamics.
Ωz
loc covers only a fraction of the occupied domain, thereby meeting both conditions for birth. Conversely, the
cell density at the centre of the domain is comparatively low throughout time because the total number of cells
contained within disks of size |Ωloc| is already close to the threshold c+. Interestingly, as in the 1D case with
only proliferation, the ABM EA support is larger than that of the IDE solution, the reverse of the behaviour that
we observed for cell migration in Fig. 5.
3.3
Cell movement and proliferation
To obtain a full continuous model, we may substitute our estimated values of the migration scaling parameter
αMM, density-limiting parameter c+, and birth-rate scaling parameter γ into Eqn. (8). However, comparing
this model to the dynamics of our full ABM shows that migration and proliferation have interwoven effects.
To illustrate this phenomenon, we present a PDE solution with our optimal values of αMM, c+, and γ from
§3.1 and 3.2 at t = 70 days in Fig. 9(a). We observe that this PDE model produces a significantly higher cell
density than its discrete counterpart in Fig. 9(b). This discrepancy occurs regardless of the value of Nbir, which
influences the speed of cell birth. Related to this, we notice that the long-time cell density in our ABM results is
much lower when both mechanisms operate simultaneously than it is when only birth occurs; compare Fig. 8(d)
and Fig. 9(b). On the other hand, the inclusion of movement does not influence the long-time density of the
continuous model solution; see the colourbar in Fig. 8(h) in comparison to the one in Fig. 9. Although we do
not furnish these observations with an analytical explanation here, they demonstrate an interesting difference in
how “adding” mechanisms or terms impact PDE and ABM dynamics.
One approach to addressing these discrepancies is to refit all three scaling parameters (αMM, γ, and c+)
simultaneously, and we present the results of this approach in the SI-§3. (Indeed, we show there that the errors
produced with a simultaneous estimation approach can be relatively small, although the model parameters may
not all be identifiable.) Because we are interested in understanding the interplay of individual-based mecha-
nisms of proliferation and movement in continuous models, however, we instead take a simpler theoretical ap-
proach. Namely, we notice that the parameter c+ is largely responsible for controlling the maximum cell density
over long time periods. (We determine this by integrating Eqn. (8) over space and identifying the steady-state
16

dynamics; this analysis reveals that equilibrium is reached when the density within any neighborhood Ωx
loc is
below c+.) In order to limit the maximum density to our estimated empirical value of 400 cells/mm2 [21, 82],
we let c+ = 400|Ωloc| ≈7.0686 cells. As we show in Fig. 9(c), using this value of c+, alongside our previously
fit values of αMM and γ, produces PDE densities that are much closer to the corresponding ABM results. We
thus fix c+ = 7.0686 cells for the remainder of this manuscript, which allows us to highlight the time dynamics
of our full PDE model in comparison to the EA ABM result with Box and Offset rectangles initial conditions in
Fig. 10 and 11, respectively.
Fig. 10(j), which depicts the time evolution of the estimated radius of support for the PDE and EA ABM
results, shows that a reasonably accurate continuous description of the combined model can be obtained by
using the scaling parameters obtained from a modular approach. The supports of the ABM and PDE solutions
both increase at roughly the same rate, although the degree to which the solutions agree can be affected by
Nbir: when this parameter is small, the PDE solution travels at a faster rate than the ABM solution, whereas
the opposite occurs when this value is large (greater than Nbir = 50 positions/day). At intermediate values
of Nbir (i.e., Nbir = 50 positions/day), however, the ABM and PDE solution curves are almost identical. Fig.
10(i), which presents the number of cells over time, yields similar observations: the ABM and PDE solutions
exhibit similar dynamics over the time period investigated here and there are certain values of Nbir for which the
solution curves are nearly identical. Fig. 11 further demonstrates that these observations do not depend on the
specific choice of initial condition. Figs. 10 and 11 demonstrate that combining movement with proliferation
also dissipates the oscillatory bands that we observed for movement alone in Fig. 5. This is likely because the
stochastic addition of cells in the birth model disrupts the regular cell spacing created by the movement model.
Furthermore, the EA ABM and PDE solutions exhibit similar characteristic profiles without regions of high cell
density around the edge of the initial condition support, in contrast to the birth-only model (Fig. 8).
4
Discussion
We presented a procedure for constructing experimentally interpretable continuous models of cell migration and
birth in biologically relevant settings of low numbers of individuals and localised interactions which may lie
outside the validity of the mean-field regime. Specifically, we introduced and estimated scaling parameters in
continuous models to account for realistic—i.e., relatively small and changing—numbers of cells with localised
interactions. We applied this methodology to an illustrative, simplified example inspired by zebrafish pattern
formation, in which we used a reduced ABM to generate individual-level data with biologically meaningful
spatial and temporal units. Non-local rules for cell birth and migration, based on the ABM [21], informed our
discrete and continuous descriptions and allowed us to transfer biological length scales and units to the macro-
scopic setting. Throughout our work, we stressed matching the spatio-temporal behaviour of our continuous
and discrete models. We adopted a modular approach by estimating parameters in cases with either movement
or birth before considering both mechanisms simultaneously. This allowed us to examine the specific contribu-
tions of each mechanism to self-organisation and provided insight into their interplay in discrete and continuous
settings.
We observed that the solutions of our continuous models expand at a different rate than EA ABM results
and feature smoother profiles. Indeed, inaccuracies in mean-field descriptions for “intermediate” numbers
of individuals appear to be common in other biological phenomena described by simpler dynamics such as
Fisher-KPP-type equations, cf. [85, 86]. In fact, both references analytically derive corrections to the wave
speed, a procedure we cannot adopt due to our use of off-lattice models. However, this substantiates our
introduction of scaling parameters to handle the discrepancy. By introducing and estimating parameters that
rescale the time variable, we produced more accurate descriptions of agent-based movement or birth. However,
when we used the same parameter values in a continuous model of both cell migration and birth in §3.3,
the PDE did not produce close estimates of the full ABM. Specifically, our full continuous model yielded
larger long-time densities than the EA ABM results, motivating us to re-estimate the threshold value c+ with a
17

(a)
(b)
(c)
(d)
(e)
(f)
(g)
(h)
ABM
PDE
(i)
(l)
(j)
(k)
example ABM
(cells/mm2)
density
error
(cells/mm2)
ABM −PDE
10
25
50
100
150
Nbir
ABM
PDE
Figure 10: Melanophore movement and birth models with our Box initial condition. Results in (a)–(h) and (j)–
(l) are for Nbir = 150 positions/day. We (a)–(d) compute the EA ABM result using 103 simulations, and (e)–(h)
generate the PDE solution of Eqn. (8) with c+ = 7.0686 cells and the values of αMM and γ that we estimated
in §3.1 and §3.2, respectively. (i) The time evolution of the PDE cell mass agrees well with the mean number
of cells for the ABM under different Nbir values. (j) Depending on the time scales of migration and birth, the
approximate PDE radius of support overtakes or trails the corresponding EA ABM result. We compute the
radius of support for each ABM realisation by finding the most distant cell from the origin at each time step;
we then average these values across our simulations. In the PDE case, we find the furthest voxel with non-zero
density from the origin based on the L∞distance, after setting the density to zero if it is below single-digit
precision of 10−7. (k)–(l) We show the difference between the PDE and EA ABM solutions from (a)–(h) at two
sample times. We overlay cell positions form one ABM simulation to illustrate how the continuous and discrete
solutions are related. In (i) and (j), shaded regions denote plus or minus one standard deviation of the EA ABM
solution.
theoretical approach. This generated a more faithful continuous description and highlighted that the effects of
movement and proliferation are not simply additive. We thus stress that parameters must be fit to data in which
all mechanisms of interest act simultaneously, in order to capture their interplay. This is particularly crucial for
18

(a)
(b)
(c)
(d)
(e)
(f)
(g)
(h)
(i)
(l)
(j)
(k)
ABM
PDE
ABM −PDE
example ABM
(cells/mm2)
density
<
l
a
t
e
x
i
t
 
s
h
a
1
_
b
a
s
e
6
4
=
"
3
I
l
q
w
S
G
K
I
g
1
1
i
M
+
I
G
D
V
1
C
q
D
a
0
Q
w
=
"
>
A
A
A
C
E
3
i
c
b
Z
A
9
S
w
N
B
E
I
b
3
4
n
f
8
i
l
r
a
L
A
Y
h
W
s
S
7
K
G
g
p
2
l
g
q
G
A
0
k
M
e
x
t
J
s
n
i
7
t
6
x
O
y
e
G
4
/
6
D
j
X
/
F
x
k
I
R
W
x
s
7
/
4
2
b
j
0
K
j
L
y
w
8
v
D
P
D
7
L
x
h
L
I
V
F
3
/
/
y
c
l
P
T
M
7
N
z
8
w
v
5
x
a
X
l
l
d
X
C
2
v
q
V
j
R
L
D
o
c
o
j
G
Z
l
a
y
C
x
I
o
a
G
K
A
i
X
U
Y
g
N
M
h
R
K
u
w
9
v
T
Q
f
3
6
D
o
w
V
k
b
7
E
f
g
x
N
x
b
p
a
d
A
R
n
6
K
x
W
Y
b
e
B
c
I
9
p
G
7
Q
V
2
K
c
l
D
l
L
a
b
G
/
k
K
p
X
d
V
O
i
I
d
7
J
W
o
e
i
X
/
a
H
o
X
w
j
G
U
C
R
j
n
b
c
K
n
4
1
2
x
B
M
F
G
r
l
k
1
t
Y
D
P
8
Z
m
y
g
w
K
L
i
H
L
N
x
I
L
M
e
O
3
r
A
t
1
h
5
o
p
s
M
1
0
e
F
N
G
t
5
3
T
p
p
3
I
u
K
e
R
D
t
2
f
E
y
l
T
1
v
Z
V
6
D
o
V
w
5
6
d
r
A
3
M
/
2
r
1
B
D
t
H
z
V
T
o
O
E
H
Q
f
L
S
o
k
0
i
K
E
R
0
E
R
N
v
C
A
E
f
Z
d
8
C
4
E
e
6
v
l
P
e
Y
Y
R
x
d
j
H
k
X
Q
j
B
5
8
l
+
4
q
p
S
D
/
X
L
l
4
q
B
4
f
D
K
O
Y
5
5
s
k
i
1
S
I
g
E
5
J
M
f
k
j
J
y
T
K
u
H
k
g
T
y
R
F
/
L
q
P
X
r
P
3
p
v
3
P
m
r
N
e
e
O
Z
D
f
J
L
3
s
c
3
A
2
K
e
2
w
=
=
<
/
l
a
t
e
x
i
t
>
error
(cells/mm2)
10
25
50
100
150
<
l
a
t
e
x
i
t
 
s
h
a
1
_
b
a
s
e
6
4
=
"
j
2
H
g
N
L
z
o
V
l
B
C
J
G
H
c
8
0
9
v
l
X
p
6
S
i
8
=
"
>
A
A
A
B
6
n
i
c
b
V
B
N
S
8
N
A
E
J
3
4
W
e
t
X
1
a
O
X
x
S
J
4
K
k
m
1
6
L
H
g
x
W
N
F
+
w
F
t
K
J
v
t
p
l
2
6
2
Y
T
d
i
V
B
C
f
4
I
X
D
4
p
4
9
R
d
5
8
9
+
4
b
X
P
Q
1
g
c
D
j
/
d
m
m
J
k
X
J
F
I
Y
d
N
1
v
Z
2
1
9
Y
3
N
r
u
7
B
T
3
N
3
b
P
z
g
s
H
R
2
3
T
J
x
q
x
p
s
s
l
r
H
u
B
N
R
w
K
R
R
v
o
k
D
J
O
4
n
m
N
A
o
k
b
w
f
j
2
5
n
f
f
u
L
a
i
F
g
9
4
i
T
h
f
k
S
H
S
o
S
C
U
b
T
S
g
1
d
z
+
6
W
y
W
3
H
n
I
K
v
E
y
0
k
Z
c
j
T
6
p
a
/
e
I
G
Z
p
x
B
U
y
S
Y
3
p
e
m
6
C
f
k
Y
1
C
i
b
5
t
N
h
L
D
U
8
o
G
9
M
h
7
1
q
q
a
M
S
N
n
8
1
P
n
Z
J
z
q
w
x
I
G
G
t
b
C
s
l
c
/
T
2
R
0
c
i
Y
S
R
T
Y
z
o
j
i
y
C
x
7
M
/
E
/
r
5
t
i
e
O
N
n
Q
i
U
p
c
s
U
W
i
8
J
U
E
o
z
J
7
G
8
y
E
J
o
z
l
B
N
L
K
N
P
C
3
k
r
Y
i
G
r
K
0
K
Z
T
t
C
F
4
y
y
+
v
k
l
a
1
4
l
1
W
q
v
d
X
5
X
o
t
j
6
M
A
p
3
A
G
F
+
D
B
N
d
T
h
D
h
r
Q
B
A
Z
D
e
I
Z
X
e
H
O
k
8
+
K
8
O
x
+
L
1
j
U
n
n
z
m
B
P
3
A
+
f
w
B
b
h
o
0
l
<
/
l
a
t
e
x
i
t
>
Nbir
ABM
<
l
a
t
e
x
i
t
 
s
h
a
1
_
b
a
s
e
6
4
=
"
q
q
S
t
Z
J
9
0
1
3
a
5
A
z
j
V
S
e
T
t
7
e
5
k
y
r
s
=
"
>
A
A
A
B
8
X
i
c
b
V
B
N
S
8
N
A
E
J
3
U
r
1
q
/
q
h
6
9
B
I
v
g
q
S
R
V
0
W
P
V
i
x
e
h
g
v
3
A
N
p
T
N
d
t
M
u
3
W
z
C
7
k
Q
s
o
f
/
C
i
w
d
F
v
P
p
v
v
P
l
v
3
L
Y
5
a
O
u
D
g
c
d
7
M
8
z
M
8
2
P
B
N
T
r
O
t
5
V
b
W
l
5
Z
X
c
u
v
F
z
Y
2
t
7
Z
3
i
r
t
7
D
R
0
l
i
r
I
6
j
U
S
k
W
j
7
R
T
H
D
J
6
s
h
R
s
F
a
s
G
A
l
9
w
Z
r
+
8
H
r
i
N
x
+
Z
0
j
y
S
9
z
i
K
m
R
e
S
v
u
Q
B
p
w
S
N
9
N
B
B
9
o
T
p
5
d
X
t
u
F
s
s
O
W
V
n
C
n
u
R
u
B
k
p
Q
Y
Z
a
t
/
j
V
6
U
U
0
C
Z
l
E
K
o
j
W
b
d
e
J
0
U
u
J
Q
k
4
F
G
x
c
6
i
W
Y
x
o
U
P
S
Z
2
1
D
J
Q
m
Z
9
t
L
p
x
W
P
7
y
C
g
9
O
4
i
U
K
Y
n
2
V
P
0
9
k
Z
J
Q
6
1
H
o
m
8
6
Q
4
E
D
P
e
x
P
x
P
6
+
d
Y
H
D
h
p
V
z
G
C
T
J
J
Z
4
u
C
R
N
g
Y
2
Z
P
3
7
R
5
X
j
K
I
Y
G
U
K
o
4
u
Z
W
m
w
6
I
I
h
R
N
S
A
U
T
g
j
v
/
8
i
J
p
V
M
r
u
S
b
l
y
d
1
q
q
n
m
V
x
5
O
E
A
D
u
E
Y
X
D
i
H
K
t
x
A
D
e
p
A
Q
c
I
z
v
M
K
b
p
a
0
X
6
9
3
6
m
L
X
m
r
G
x
m
H
/
7
A
+
v
w
B
e
c
q
Q
v
g
=
=
<
/
l
a
t
e
x
i
t
>
PDE
<
l
a
t
e
x
i
t
 
s
h
a
1
_
b
a
s
e
6
4
=
"
v
h
g
g
L
W
f
4
+
h
F
a
+
h
Z
B
X
R
m
3
C
L
3
j
l
z
w
=
"
>
A
A
A
B
8
X
i
c
b
V
D
L
S
g
N
B
E
O
z
1
G
e
M
r
6
t
H
L
Y
B
A
8
h
d
0
o
6
j
G
g
g
s
c
I
5
o
H
J
E
m
Y
n
k
2
T
I
7
O
w
y
0
y
u
G
J
X
/
h
x
Y
M
i
X
v
0
b
b
/
6
N
k
2
Q
P
m
l
j
Q
U
F
R
1
0
9
0
V
x
F
I
Y
d
N
1
v
Z
2
l
5
Z
X
V
t
P
b
e
R
3
9
z
a
3
t
k
t
7
O
3
X
T
Z
R
o
x
m
s
s
k
p
F
u
B
t
R
w
K
R
S
v
o
U
D
J
m
7
H
m
N
A
w
k
b
w
T
D
q
4
n
f
e
O
T
a
i
E
j
d
4
y
j
m
f
k
j
7
S
v
Q
E
o
2
i
l
h
z
b
y
J
0
y
r
1
z
f
j
T
q
H
o
l
t
w
p
y
C
L
x
M
l
K
E
D
N
V
O
4
a
v
d
j
V
g
S
c
o
V
M
U
m
N
a
n
h
u
j
n
1
K
N
g
k
k
+
z
r
c
T
w
2
P
K
h
r
T
P
W
5
Y
q
G
n
L
j
p
9
O
L
x
+
T
Y
K
l
3
S
i
7
Q
t
h
W
S
q
/
p
5
I
a
W
j
M
K
A
x
s
Z
0
h
x
Y
O
a
9
i
f
i
f
1
0
q
w
d
+
m
n
Q
s
U
J
c
s
V
m
i
3
q
J
J
B
i
R
y
f
u
k
K
z
R
n
K
E
e
W
U
K
a
F
v
Z
W
w
A
d
W
U
o
Q
0
p
b
0
P
w
5
l
9
e
J
P
V
y
y
T
s
t
l
e
/
O
i
p
X
z
L
I
4
c
H
M
I
R
n
I
A
H
F
1
C
B
W
6
h
C
D
R
g
o
e
I
Z
X
e
H
O
M
8
+
K
8
O
x
+
z
1
i
U
n
m
z
m
A
P
3
A
+
f
w
C
H
5
J
D
I
<
/
l
a
t
e
x
i
t
>
Figure 11: Melanophore movement and birth models with our Offset rectangles initial condition to verify
that our fitting procedure is robust in non-standard geometries. Results in (a)–(h) and (j)–(l) are for Nbir =
150 positions/day. As in Fig. 10, we show (a)–(d) the EA ABM result across 103 simulations; (e)–(h) the
corresponding PDE solution with c+ = 7.0686 cells and the values of αMM and γ that we estimated in §3.1
and §3.2, respectively; (i) the PDE cell mass in time compared to the mean number of cells across 103 ABM
simulations for different Nbir values; and (j)–(l) the difference between the PDE and EA ABM solutions from
(a)–(h). To provide more intuition, we overlay some cell positions from one ABM simulation.
contexts such as cancer biology, where cell migration, proliferation, and death are known to play critical roles
in tumour progression and immune response [87].
Our results highlight how choices in numerical implementation affect parameter estimates and suggest
several directions for future work that may improve our approach. For example, the optimal value of our
parameter controlling the timescale of cell migration (αMM) appears to be independent of the initial condition
and the mesh resolution that we used to construct PDE solutions, provided the latter is sufficiently refined.
One drawback of our current approach, however, is that we may need to estimate αMM and γ for each new
choice of discrete rules governing migration and cell birth, respectively, because these rules perturb the short-
range interactions between relatively small numbers of cells. This naturally leads to the question of whether
19

an analytic expression can be derived for these parameters. Several coarse-graining techniques that take into
account higher-order correlations between cells in on- or off-lattice models may produce scaling factors similar
to those introduced in this manuscript, but these may only apply to certain classes of ABMs [88]. Alternatively,
it may be possible to estimate scaling parameters of continuous models by investigating the convergence of EA
ABM results to features of their solutions such as the speed of solution propagation, as in [85, 86] for on-lattice
models; by accounting for the dynamics of the two-particle distribution, as in [73, 74]; or by exploring scaling
relationships as in [89]. Adapting these approaches to our setting is an interesting avenue for future work.
Additionally, our continuous models more accurately represent ABM results within the bulk of the solution
support because the L2 norm more strongly penalises discrepancies there. In the future, other norms, such as the
L∞error, could be used to match the solution supports given by our discrete and continuous models. Replacing
our birth-rate scaling parameter γ with a density-dependent function—either through rigorous derivation or an
equation-learning approach [90]—is another exciting future direction. In particular, because cell proliferation in
the ABM involves selecting positions uniformly at random from the domain each day, the chance that we select
a location z that permits birth appears to depend in a nonlinear way on the solution support. More generally, our
computational study does not provide theoretical explanations for our parameter values, and we plan to build
on the intuition that we established here to develop these arguments in the future.
To simplify our initial study, we considered the dynamics of one cell population (i.e., melanophores in the
main text and xanthophores in the SI-§6), but pattern formation in zebrafish skin involves multiple cell types
and longer-range interactions, as we highlight in Supplementary Fig. 1. Future work may extend our pipeline
to construct more realistic continuous models with multiple cell types and interaction neighborhoods. Related
to this, the initial conditions that we designed allowed us to make one-to-one comparisons between discrete-
and continuous-model densities, but this may not always be possible. More realistic zebrafish models (i.e.,
[21, 37, 39, 40]) produce patterns that are more complicated than our box and stripe motifs. This means that
ensemble-averaging stochastic ABM realisations may not retain information about the length scales inherent in
patterns. For such cases, fitting parameters based on summary statistics (e.g., pair-correlation functions [91],
pattern-simplicity scores [92], or persistent-homology approaches [93]) may be more useful, and we plan to
address this in future work. These and other directions move us toward constructing interpretable, analytically
tractable continuous models of self-organisation, increasing our understanding of biological pattern formation
more broadly.
Code availability
Our model and parameter-fitting code is publicly available on GitHub [94]. Supplementary figures and videos
are available on Figshare at https://figshare.com/projects/Linking_discrete_and_continuous_
models_of_cell_birth_and_migration_in_one_population/171234. Data used to generate figures
are given in Dryad https://doi.org/10.5061/dryad.s4mw6m9cb.
Acknowledgements
JAC and WDM were supported by the Advanced Grant Nonlocal-CPD (Nonlocal PDEs for Complex Parti-
cle Dynamics: Phase Transitions, Patterns and Synchronization) of the European Research Council Executive
Agency (ERC) under the European Union’s Horizon 2020 research and innovation programme (grant agreement
No. 883363). WDM, JAC, and AV would also like to thank the Isaac Newton Institute for Mathematical Sci-
ences, Cambridge, for support and hospitality during the programme Mathematics of Movement, where work
on this paper was undertaken. This work was supported by EPSRC grant no EP/R014604/1. CV acknowl-
edges support from the Dr Perry James (Jim) Browne Research Centre on Mathematics and its Applications
(University of Sussex). We are grateful to Shigeru Kondo for helpful discussions during an early stage of this
research.
20

References
[1] Mogilner A, Edelstein-Keshet L. A non-local model for a swarm. J Math Biol. 1999;38(6):534-70.
[2] D’Orsogna MR, Chuang YL, Bertozzi AL, Chayes LS. Self-propelled particles with soft-core interactions:
patterns, stability, and collapse. Phys Rev Lett. 2006;96(10):104302.
[3] Cucker F, Smale S. Emergent behavior in flocks. IEEE Trans Autom Control. 2007;52(5):852-62.
[4] Carrillo JA, Fornasier M, Toscani G, Vecil F. Particle, kinetic, and hydrodynamic models of swarming.
In: Mathematical modeling of collective behavior in socio-economic and life sciences. Springer; 2010. p.
297-336.
[5] Amack JD, Manning ML. Knowing the boundaries: Extending the differential adhesion hypothesis in
embryonic cell sorting. Science. 2012;338:212-5.
[6] Burger M, Francesco MD, Fagioli S, Stevens A. Sorting phenomena in a mathematical model for two
mutually attracting/repelling species. SIAM J Math Anal. 2018;50(3):3210-50.
[7] Carrillo JA, Murakawa H, Sato M, Togashi H, Trush O. A population dynamics model of cell-cell adhesion
incorporating population pressure and density saturation. J Theor Biol. 2019;474:14-24.
[8] Buttensch¨on A, Edelstein-Keshet L. Bridging from single to collective cell migration: A review of models
and links to experiments. PLOS Comput Biol. 2020;16(12).
[9] Tsai TYC, Garner RM, Megason SG. Adhesion-Based Self-Organization in Tissue Patterning. Annu Rev
Cell Dev Biol. 2022;38:349-74.
[10] Frohnh¨ofer HG, Krauss J, Maischein HM, N¨usslein-Volhard C. Iridophores and their interactions with
other chromatophores are required for stripe formation in zebrafish. Development. 2013;140(14):2997-
3007.
[11] Irion U, N¨usslein-Volhard C. The identification of genes involved in the evolution of color patterns in fish.
Curr Opin Genet Dev. 2019;57:31-8.
[12] Parichy DM. Evolution of pigment cells and patterns: recent insights from teleost fishes. Curr Opin Genet
Dev. 2021;69:88-96.
[13] Kondo S, Watanabe M, Miyazawa S. Studies of Turing pattern formation in zebrafish skin. Philos Trans
R Soc A. 2021;379(2213):20200274.
[14] Nakamasu A, Takahashi G, Kanbe A, Kondo S. Interactions between zebrafish pigment cells responsible
for the generation of Turing patterns. Proc Natl Acad Sci USA. 2009;106(21):8429-34.
[15] Singh AP, Schach U, N¨usslein-Volhard C. Proliferation, dispersal and patterned aggregation of iridophores
in the skin prefigure striped colouration of zebrafish. Nat Cell Biol. 2014;16(6):604-11.
[16] Gur D, Bain EJ, Johnson KR, Aman AJ, Amalia Pasolli H, Flynn JD, et al. In situ differentiation of
iridophore crystallotypes underlies zebrafish stripe patterning. Nat Commun. 2020;11(1):6391.
[17] Hamada H, Watanabe M, Lau HE, Nishida T, Hasegawa T, Parichy DM, Kondo S.
Involvement of
Delta/Notch signaling in zebrafish adult pigment stripe patterning. Development. 2014;141(2):318-24.
[18] Inaba M, Yamanaka H, Kondo S. Pigment pattern formation by contact-dependent depolarization. Sci-
ence. 2012;335(6069):677-7.
21

[19] Yamaguchi M, Yoshimoto E, Kondo S. Pattern regulation in the stripe of zebrafish suggests an underlying
dynamic and autonomous mechanism. Proc Natl Acad Sci USA. 2007;104(12):4790–4793.
[20] Kroll F, Powell GT, Ghosh M, Gestri G, Antinucci P, Hearn TJ, et al. A simple and effective F0 knockout
method for rapid screening of behaviour and other complex phenotypes. eLife. 2021;10:e59683.
[21] Volkening A, Sandstede B. Modelling stripe formation in zebrafish: an agent-based approach. J R Soc
Interface. 2015;12(112):20150812.
[22] Fadeev A, Krauss J, Frohnh¨ofer HG, Irion U, N¨usslein-Volhard C. Tight Junction Protein 1a regulates
pigment cell organisation during zebrafish colour patterning. eLife. 2015;4:e06545.
[23] Byrne HM. Dissecting cancer through mathematics: From the cell to the animal model. Nat Rev Cancer.
2010;10:221-30.
[24] Gompper G, Winkler RG, Speck T, Solon A, Nardini C, Peruani F, et al. The 2020 motile active matter
roadmap. J Phys Condens Matter. 2020;32:193001.
[25] Stillman NR, Mayor R. Generative models of morphogenesis in developmental biology. Semin Cell Dev
Biol. 2023;147:83-90.
[26] Volkening A. Linking genotype, cell behavior, and phenotype: multidisciplinary perspectives with a basis
in zebrafish patterns. Curr Opin Genet Dev. 2020;63:78-85.
[27] Alert R, Trepat X.
Physical models of collective cell migration.
Annu Rev Condens Matter Phys.
2020;11:77-101.
[28] Metzcar J, Wang Y, Heiland R, Macklin P. A review of cell-based computational modeling in cancer
biology. JCO Clin Cancer Inform. 2019;2:1-13.
[29] Deutsch A. Cellular automaton models for collective cell behaviour. In: Cellular Automata and Discrete
Complex Systems. AUTOMATA 2015. Lecture Notes in Computer Science. Springer; 2015. p. 1-10.
[30] Deutsch A, Dormann S. Cellular Automaton Modeling of Biological Pattern Formation, Characterization,
Examples, and Analysis. Springer; 2017.
[31] Hirashima T, Rens EG, Merks RMH. Cellular Potts modeling of complex multicellular behaviors in tissue
morphogenesis. Dev Growth Differ. 2017;59(5):329-39.
[32] Rens EG, Edelstein-Keshet L. From energy to cellular forces in the Cellular Potts Model: An algorithmic
approach. PLOS Comput Biol. 2019;15(12):1-23.
[33] Alt S, Ganguly P, Salbreux G. Vertex models: from cell mechanics to tissue morphogenesis. Philos Trans
R Soc B. 2017;372(1720):20150520.
[34] Fletcher A, Osterfield M, Baker R, Shvartsman S. Vertex Models of Epithelial Morphogenesis. Biophys
J. 2014;106(11):2291-304.
[35] Bullara D, De Decker Y. Pigment cell movement is not required for generation of Turing patterns in
zebrafish skin. Nat Commun. 2015;6(6971).
[36] Moreira J, Deutsch A. Pigment pattern formation in zebrafish during late larval stages: A model based on
local interactions. Dev Dyn. 2005;232(1):33-42.
[37] Owen JP, Kelsh RN, Yates CA. A quantitative modelling approach to zebrafish pigment pattern formation.
eLife. 2020;9:e52998.
22

[38] Caicedo-Carvajal CE, Shinbrot T. In silico zebrafish pattern formation. Dev Biol. 2008;315(2):397-403.
[39] Volkening A, Abbott MR, Chandra N, Dubois B, Lim F, Sexton D, Sandstede B. Modeling stripe formation
on growing zebrafish tailfins. Bull Math Biol. 2020;82(56).
[40] Volkening A, Sandstede B. Iridophores as a source of robustness in zebrafish stripes and variability in
Danio patterns. Nat Commun. 2018;9(3231).
[41] Osborne JM, Fletcher AG, Pitt-Francis JM, Maini PK, Gavaghan DJ.
Comparing individual-
based approaches to modelling the self-organization of multicellular tissues.
PLOS Comput Biol.
2017;13:e1005387.
[42] Murray JD. Mathematical biology: I. An introduction. Springer; 2002.
[43] Perthame B. Transport equations in biology. Springer Science & Business Media; 2006.
[44] Turing AM. The chemical basis of morphogenesis. Philos Trans R Soc Lond B. 1952;237(641):37-72.
[45] Maini P, Painter K, Chau HP. Spatial pattern formation in chemical and biological systems. J Chem Soc.
1997;93(20):3601-10.
[46] Marciniak-Czochra A, Karch G, Suzuki K. Instability of Turing patterns in reaction-diffusion-ODE sys-
tems. J Math Biol. 2017;74:583-618.
[47] Armstrong NJ, Painter KJ, Sherratt JA. A continuum approach to modelling cell–cell adhesion. J Theor
Biol. 2006;243(1):98-113.
[48] Murakawa H, Togashi H. Continuous models for cell–cell adhesion. J Theor Biol. 2015;374:1-12.
[49] Carrillo JA, Huang Y, Schmidtchen M. Zoology of a nonlocal cross-diffusion model for two species.
SIAM J Appl Math. 2018;78(2):1078-104.
[50] Carrillo JA, Colombi A, Scianna M. Adhesion and volume constraints via nonlocal interactions determine
cell organisation and migration profiles. J Theor Biol. 2018;445:75-91.
[51] Gaffney EA, Seirin Lee S. The sensitivity of Turing self-organization to biological feedback delays: 2D
models of fish pigmentation. Math Med Biol. 2015;32:57-79.
[52] Konow C, Li Z, Shepherd S, Bullara D, Epstein IR. Influence of survival, promotion, and growth on
pattern formation in zebrafish skin. Sci Rep. 2021;11(9864).
[53] Bloomfield JM, Painter KJ, Sherratt JA. How does cellular contact affect differentiation mediated pattern
formation? Bull Math Biol. 2011;73(7):1529-58.
[54] Kondo S.
An updated kernel-based Turing model for studying the mechanisms of biological pattern
formation. J Theor Biol. 2017;414:120-7.
[55] Painter KJ, Bloomfield JM, Sherratt JA, Gerisch A. A nonlocal model for contact attraction and repulsion
in heterogeneous cell populations. Bull Math Biol. 2015;77(6):1132-65.
[56] Giacomin G, Lebowitz JL. Phase segregation dynamics in particle systems with long range interactions.
I. Macroscopic limits. J Stat Phys. 1997;87:37-61.
[57] Painter KJ, Hillen T. Volume-filling and quorum-sensing in models for chemosensitive movement. Can
Appl Math Quart. 2002;10(4):501-43.
23

[58] Penington CJ, Hughes BD, Landman KA. Building macroscale models from microscale probabilistic
models: a general probabilistic approach for nonlinear diffusion and multispecies phenomena. Physical
Review E. 2011;84(4):041120.
[59] Hillen T, Painter KJ. Transport and anisotropic diffusion models for movement in oriented habitats. Lect
Notes Math. 2013;2071:177-222.
[60] Carrillo JA, Choi YP, Hauray M. The derivation of swarming models: Mean-field limit and Wasserstein
distances. In: Muntean A, Toschi F, editors. Collective Dynamics from Bacteria to Crowds: An Excur-
sion Through Modeling, Analysis and Simulation. CISM International Centre for Mechanical Sciences.
Vienna: Springer Vienna; 2014. p. 1-46.
[61] Chen Y, Kolokolnikov T.
A minimal model of predator–swarm interactions.
J R Soc Interface.
2014;11:20131208.
[62] Bruna M, Burger M, Pietschmann JF, Wolfram MT. Active crowds. In: Active particles, Vol. 3. Model.
Simul. Sci. Eng. Technol.. Birkh¨auser/Springer, Cham; 2022. p. 35-73.
[63] Champagnat N, Ferri`ere R, M´el´eard S. Unifying evolutionary dynamics: from individual stochastic pro-
cesses to macroscopic models. Theor Popul Biol. 2006;69(3):297-321.
[64] Champagnat N, Ferri`ere R, M´el´eard S. Individual-based probabilistic models of adaptive evolution and
various scaling approximations. Prog Probab. 2008;59:75.
[65] Champagnat N, Ferri`ere R, M´el´eard S. From individual stochastic processes to macroscopic models in
adaptive evolution. Stoch Models. 2008;24:2-44.
[66] Hansen JP, McDonald IR. Theory of Simple Liquids. London: Academic Press; 2006.
[67] Lushnikov PM, Chen N, Alber M. Macroscopic dynamics of biological cells interacting via chemotaxis
and direct contact. Phys Rev E. 2008;78:061904.
[68] Simpson MJ, Landman KA, Hughes BD. Multi-species simple exclusion processes. Phys A: Stat Mech.
2009;388:399-406.
[69] Simpson MJ, Baker RE. Corrected mean-field models for spatially dependent advection-diffusion-reaction
phenomena. Phys Rev E. 2011;83:51922.
[70] Markham DC, Simpson MJ, Baker RE. Simplified method for including spatial correlations in mean-field
approximations. Phys Rev E. 2013;87:62702.
[71] Wieczorek R. Hydrodynamic limit of a stochastic model of proliferating cells with chemotaxis. Kinet
Relat Models. 2023;16:373-93.
[72] Binny RN, Plank MJ, James A. Spatial moment dynamics for collective cell movement incorporating a
neighbour-dependent directional bias. Journal of the Royal Society Interface. 2015;12(106):20150228.
[73] Binny RN, James A, Plank MJ. Collective cell behaviour with neighbour-dependent proliferation, death
and directional bias. Bulletin of Mathematical Biology. 2016;78:2277-301.
[74] Middleton AM, Fleck C, Grima R. A continuum approximation to an off-lattice individual-cell based
model of cell migration and adhesion. Journal of theoretical biology. 2014;359:220-32.
[75] Bruna M, Chapman SJ, Robinson M. Diffusion of particles with short-range interactions. SIAM Journal
on Applied Mathematics. 2017;77(6):2294-316.
24

[76] Johnston ST, Baker RE, Simpson MJ. A new and accurate continuum description of moving fronts. New
Journal of Physics. 2017;19(3):033010.
[77] Bruna M, Chapman SJ. Excluded-volume effects in the diffusion of hard spheres. Physical Review E.
2012;85(1):011103.
[78] Patterson LB, Bain EJ, Parichy DM. Pigment cell interactions and differential xanthophore recruitment
underlying zebrafish stripe reiteration and Danio pattern evolution. Nat Commun. 2014;5(5299).
[79] Walderich B, Singh AP, Mahalwar P, N¨usslein-Volhard C. Homotypic cell competition regulates prolifera-
tion and tiling of zebrafish pigment cells during colour pattern formation. Nat Commun. 2016;7(1):11462.
[80] Golse F. The mean-field limit for the dynamics of large particle systems. Journ´ees ´Equations aux d´eriv´ees
Partielles. 2003.
[81] Di Francesco M, Fagioli S. Measure solutions for non-local interaction PDEs with two species. Nonlin-
earity. 2013;26(10):2777.
[82] Takahashi G, Kondo S. Melanophores in the stripes of adult zebrafish do not have the nature to gather, but
disperse when they have the space to move. Pigment Cell Melanoma Res. 2008;21(6):677-86.
[83] Parichy DM, Turner JM. Zebrafish puma mutant decouples pigment pattern and somatic metamorphosis.
Dev Biol. 2003;256(2):242-57.
[84] Chiari G, Delitala ME, Morselli D, Scianna M. A hybrid modeling environment to describe aggregates of
cells heterogeneous for genotype and behavior with possible phenotypic transitions. International Journal
of Non-Linear Mechanics. 2022;144:104063.
[85] Brunet E, Derrida B. Shift in the velocity of a front due to a cutoff. Phys Rev E. 1997;56:2597-604.
[86] Sontag A, Rogers T, Yates CA. Stochastic drift in discrete waves of nonlocally interacting particles. Phys
Rev E. 2023;107:014128.
[87] Bull JA, Byrne HM. The hallmarks of mathematical oncology. Proc IEEE. 2022;110(5):523-40.
[88] Bruna M, Chapman SJ, Robinson M. Diffusion of Particles with Short-Range Interactions. SIAM J Appl
Math. 2017;77(6):2294-316. Available from: https://doi.org/10.1137/17M1118543.
[89] Franke F, Aland S, B¨ohme HJ, Voss-B¨ohme A, Lange S. Is cell segregation like oil and water: asymptotic
versus transitory regime. PLoS Comput Biol. 2022;18(9):e1010460.
[90] Nardini JT, Baker RE, Simpson MJ, Flores KB. Learning differential equation models from stochastic
agent-based model simulations. J Roy Soc Interface. 2021;18:20200987.
[91] Bull JA, Byrne HM. Quantification of spatial and phenotypic heterogeneity in an agent-based model of
tumour-macrophage interactions. PLOS Comput Biol. 2023;19(3):e1010994.
[92] Miyazawa S. Pattern blending enriches the diversity of animal colorations. Sci Adv. 2020;6(49).
[93] McGuirl MR, Volkening A, Sandstede B. Topological data analysis of zebrafish patterns. Proc Natl Acad
Sci USA. 2020;117(10):5113-24.
[94] Martinson WD, Schmitchen M, Volkening A, Venkataraman C, Carrillo JA. GitHub repository for “Link-
ing discrete and continuous models of cell birth and migration”. GitHub; 2023. https://github.com/
wdmartinson/Self-Organization-One-Species.
25

