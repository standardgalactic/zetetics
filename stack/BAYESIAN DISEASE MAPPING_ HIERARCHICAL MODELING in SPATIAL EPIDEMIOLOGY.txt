
BAYESIAN DISEASE  
MAPPING
HIERARCHICAL MODELING  
in SPATIAL EPIDEMIOLOGY

CHAPMAN & HALL/CRC 
I n t e r d i s c i p l i n a r y  S t a t i s t i c s  S e r i e s
Series editors:  N. Keiding, B.J.T. Morgan, C.K. Wikle, P. van der Heijden
Published titles
AN INVARIANT APPROACH TO 
 
S. Lele and J. Richtsmeier 
STATISTICAL ANALYSIS OF SHAPES
ASTROSTATISTICS 
 
 
 
G. Babu and E. Feigelson
BAYESIAN DISEASE MAPPING: 
 
Andrew B. Lawson  
HIERARCHICAL MODELING IN SPATIAL
EPIDEMIOLOGY
BIOEQUIVALENCE AND  
 
 
S. Patterson and
STATISTICS IN CLINICAL  
 
 
B. Jones
PHARMACOLOGY 
 
CLINICAL TRIALS IN ONCOLOGY 
 
J. Crowley, S. Green, 
SECOND EDITION 
 
 
 
and J. Benedetti
CORRESPONDENCE ANALYSIS 
 
M. Greenacre 
IN PRACTICE, SECOND EDITION 
DESIGN AND ANALYSIS OF 
 
 
D.L. Fairclough 
QUALITY OF LIFE STUDIES
IN CLINICAL TRIALS
DYNAMICAL SEARCH  
 
 
L. Pronzato, H. Wynn,  
 
 
 
 
 
 
and A. Zhigljavsky 
GENERALIZED LATENT VARIABLE 
 
A. Skrondal and
MODELING: MULTILEVEL, 
 
 
S. Rabe-Hesketh
LONGITUDINAL, AND STRUCTURAL
EQUATION MODELS
GRAPHICAL ANALYSIS OF 
 
 
K. Basford and J. Tukey 
MULTI-RESPONSE DATA
INTRODUCTION TO 
 
 
 
M. Waterman 
COMPUTATIONAL BIOLOGY: 
MAPS, SEQUENCES,  AND GENOMES
MARKOV CHAIN MONTE CARLO 
 
W. Gilks, S. Richardson, 
IN PRACTICE   
 
 
 
and D. Spiegelhalter
MEASUREMENT ERROR AND  
 
P. Gustafson 
 
MISCLASSIFICATION IN STATISTICS 
AND EPIDEMIOLOGY: IMPACTS AND 
BAYESIAN ADJUSTMENTS

META-ANALYSIS OF BINARY DATA 
 
D. Böhning, R. Kuhnert, 
USING PROFILE LIKELIHOOD   
 
and S. Rattanasiri
STATISTICAL ANALYSIS OF GENE 
 
T. Speed 
EXPRESSION MICROARRAY DATA
STATISTICAL AND COMPUTATIONAL  
R. Wu and M. Lin 
PHARMACOGENOMICS
STATISTICS IN MUSICOLOGY  
 
J. Beran
STATISTICAL CONCEPTS  
 
 
J. Aitchison,  J.W. Kay,
AND APPLICATIONS IN  
 
 
and I.J. Lauder
CLINICAL MEDICINE  
STATISTICAL AND PROBABILISTIC  
 
P.J. Boland 
METHODS IN ACTUARIAL SCIENCE 
STATISTICS FOR ENVIRONMENTAL 
 
A. Bailer and W. Piegorsch 
BIOLOGY AND TOXICOLOGY
STATISTICS FOR FISSION  
 
 
R.F. Galbraith 
TRACK ANALYSIS
Published titles

Interdisciplinar y Statistics
BAYESIAN DISEASE  
MAPPING
HIERARCHICAL MODELING  
in SPATIAL EPIDEMIOLOGY
Andrew B. Lawson
Medical University of South Carolina (MUSC)
Charleston, U.S.A.

Chapman & Hall/CRC
Taylor & Francis Group
6000 Broken Sound Parkway NW, Suite 300
Boca Raton, FL 33487-2742
© 2009 by Taylor & Francis Group, LLC 
Chapman & Hall/CRC is an imprint of Taylor & Francis Group, an Informa business
No claim to original U.S. Government works
Printed in the United States of America on acid-free paper
10 9 8 7 6 5 4 3 2 1
International Standard Book Number-13: 978-1-58488-840-6 (Hardcover)
This book contains information obtained from authentic and highly regarded sources. Reasonable 
efforts have been made to publish reliable data and information, but the author and publisher can-
not assume responsibility for the validity of all materials or the consequences of their use. The 
authors and publishers have attempted to trace the copyright holders of all material reproduced 
in this publication and apologize to copyright holders if permission to publish in this form has not 
been obtained. If any copyright material has not been acknowledged please write and let us know so 
we may rectify in any future reprint.
Except as permitted under U.S. Copyright Law, no part of this book may be reprinted, reproduced, 
transmitted, or utilized in any form by any electronic, mechanical, or other means, now known or 
hereafter invented, including photocopying, microfilming, and recording, or in any information 
storage or retrieval system, without written permission from the publishers.
For permission to photocopy or use material electronically from this work, please access www.copy-
right.com (http://www.copyright.com/) or contact the Copyright Clearance Center, Inc. (CCC), 222 
Rosewood Drive, Danvers, MA 01923, 978-750-8400. CCC is a not-for-profit organization that pro-
vides licenses and registration for a variety of users. For organizations that have been granted a 
photocopy license by the CCC, a separate system of payment has been arranged.
Trademark Notice: Product or corporate names may be trademarks or registered trademarks, and 
are used only for identification and explanation without intent to infringe.
Library of Congress Cataloging-in-Publication Data
Lawson, Andrew (Andrew B.)
Bayesian disease mapping : hierarchical modeling in spatial epidemiology / 
Andrew B. Lawson.
p. ; cm. -- (Chapman & Hall/CRC interdisciplinary statistics series)
Includes bibliographical references and index.
ISBN 978-1-58488-840-6 (hardcover : alk. paper)
1. Medical mapping. 2. Epidemiology--Statistical methods. 3. Bayesian 
statistical decision theory. I. Title. II. Series: Interdisciplinary statistics. 
[DNLM: 1. Epidemiologic Methods. 2. Bayes Theorem. 3. Statistics as Topic. 4. 
Topography, Medical--methods. WA 950 L425b 2008]
RA792.5.L387 2008
614.4’2--dc22 
2008022718
Visit the Taylor & Francis Web site at
http://www.taylorandfrancis.com
and the CRC Press Web site at
http://www.crcpress.com

Contents
List of Tables
xiii
Preface
xv
Author
xvii
I
Background
1
1
Introduction
3
1.1
Datasets
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
5
2
Bayesian Inference and Modeling
19
2.1
Likelihood Models
. . . . . . . . . . . . . . . . . . . . . . . .
19
2.1.1
Spatial Correlation . . . . . . . . . . . . . . . . . . . .
20
2.2
Prior Distributions
. . . . . . . . . . . . . . . . . . . . . . . .
22
2.2.1
Propriety
. . . . . . . . . . . . . . . . . . . . . . . . .
22
2.2.2
Noninformative Priors . . . . . . . . . . . . . . . . . .
22
2.3
Posterior Distributions
. . . . . . . . . . . . . . . . . . . . . .
24
2.3.1
Conjugacy . . . . . . . . . . . . . . . . . . . . . . . . .
25
2.3.2
Prior Choice . . . . . . . . . . . . . . . . . . . . . . . .
25
2.4
Predictive Distributions
. . . . . . . . . . . . . . . . . . . . .
26
2.4.1
Poisson–Gamma Example . . . . . . . . . . . . . . . .
26
2.5
Bayesian Hierarchical Modeling
. . . . . . . . . . . . . . . . .
27
2.6
Hierarchical Models . . . . . . . . . . . . . . . . . . . . . . . .
27
2.7
Posterior Inference
. . . . . . . . . . . . . . . . . . . . . . . .
28
2.7.1
A Bernoulli and Binomial Example . . . . . . . . . . .
30
2.8
Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
34
3
Computational Issues
35
3.1
Posterior Sampling
. . . . . . . . . . . . . . . . . . . . . . . .
35
3.2
Markov Chain Monte Carlo Methods
. . . . . . . . . . . . . .
36
3.3
Metropolis and Metropolis–Hastings Algorithms . . . . . . . .
37
3.3.1
Metropolis Updates . . . . . . . . . . . . . . . . . . . .
38
3.3.2
Metropolis–Hastings Updates . . . . . . . . . . . . . .
38
3.3.3
Gibbs Updates
. . . . . . . . . . . . . . . . . . . . . .
38
3.3.4
M–H versus Gibbs Algorithms . . . . . . . . . . . . . .
39
3.3.5
Special Methods
. . . . . . . . . . . . . . . . . . . . .
40
vii

viii
Contents
3.3.6
Convergence . . . . . . . . . . . . . . . . . . . . . . . .
40
3.3.7
Subsampling and Thinning
. . . . . . . . . . . . . . .
45
3.4
Perfect Sampling
. . . . . . . . . . . . . . . . . . . . . . . . .
47
3.5
Posterior and Likelihood Approximations
. . . . . . . . . . .
48
3.5.1
Pseudolikelihood and Other Forms . . . . . . . . . . .
48
3.5.2
Asymptotic Approximations . . . . . . . . . . . . . . .
50
3.6
Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
53
4
Residuals and Goodness-of-Fit
55
4.1
Model GOF Measures
. . . . . . . . . . . . . . . . . . . . . .
55
4.1.1
Deviance Information Criterion . . . . . . . . . . . . .
56
4.1.2
Posterior Predictive Loss . . . . . . . . . . . . . . . . .
57
4.2
General Residuals . . . . . . . . . . . . . . . . . . . . . . . . .
59
4.3
Bayesian Residuals
. . . . . . . . . . . . . . . . . . . . . . . .
61
4.4
Predictive Residuals and the Bootstrap . . . . . . . . . . . . .
62
4.4.1
Conditional Predictive Ordinates . . . . . . . . . . . .
63
4.5
Interpretation of Residuals in a Bayesian Setting
. . . . . . .
64
4.6
Exceedence Probabilities . . . . . . . . . . . . . . . . . . . . .
64
4.7
Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
67
II
Themes
71
5
Disease Map Reconstruction and Relative Risk Estimation
73
5.1
Introduction to Case Event and Count Likelihoods
. . . . . .
73
5.1.1
Poisson Process Model . . . . . . . . . . . . . . . . . .
73
5.1.2
Conditional Logistic Model
. . . . . . . . . . . . . . .
75
5.1.3
Binomial Model for Count Data . . . . . . . . . . . . .
76
5.1.4
Poisson Model for Count Data
. . . . . . . . . . . . .
76
5.2
Speciﬁcation of the Predictor in Case Event and Count Models
77
5.2.1
Bayesian Linear Model . . . . . . . . . . . . . . . . . .
79
5.3
Simple Case and Count Data Models with Uncorrelated
Random Eﬀects . . . . . . . . . . . . . . . . . . . . . . . . . .
80
5.3.1
Gamma and Beta Models . . . . . . . . . . . . . . . .
82
5.3.2
Log-Normal/Logistic-Normal Models . . . . . . . . . .
84
5.4
Correlated Heterogeneity Models
. . . . . . . . . . . . . . . .
84
5.4.1
Conditional Autoregressive (CAR) Models . . . . . . .
86
5.4.2
Fully-Speciﬁed Covariance Models
. . . . . . . . . . .
90
5.5
Convolution Models
. . . . . . . . . . . . . . . . . . . . . . .
91
5.6
Model Comparison and Goodness-of-Fit Diagnostics
. . . . .
92
5.6.1
Residual Spatial Autocorrelation . . . . . . . . . . . .
94
5.7
Alternative Risk Models
. . . . . . . . . . . . . . . . . . . . .
96
5.7.1
Autologistic Models
. . . . . . . . . . . . . . . . . . .
96
5.7.2
Spline-Based Models . . . . . . . . . . . . . . . . . . . 101
5.7.3
Zip Regression Models . . . . . . . . . . . . . . . . . . 102
5.7.4
Ordered and Unordered Multicategory Data . . . . . . 107

Contents
ix
5.7.5
Latent Structure Models . . . . . . . . . . . . . . . . . 108
5.8
Edge Eﬀects . . . . . . . . . . . . . . . . . . . . . . . . . . . . 111
5.8.1
Edge Weighting Schemes and McMC Methods
. . . . 113
5.8.2
Discussion and Extension to Space–Time
. . . . . . . 115
5.9
Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 116
5.9.1
Maximum Likelihood . . . . . . . . . . . . . . . . . . . 116
5.9.2
Poisson–Gamma Model: Posterior and Predictive
Inference . . . . . . . . . . . . . . . . . . . . . . . . . . 117
5.9.3
Poisson-Gamma Model: Empirical Bayes . . . . . . . . 117
6
Disease Cluster Detection
119
6.1
Cluster Deﬁnitions
. . . . . . . . . . . . . . . . . . . . . . . . 119
6.1.1
Hot Spot Clustering
. . . . . . . . . . . . . . . . . . . 121
6.1.2
Clusters as Objects or Groupings . . . . . . . . . . . . 121
6.1.3
Clusters Deﬁned as Residuals . . . . . . . . . . . . . . 121
6.2
Cluster Detection using Residuals . . . . . . . . . . . . . . . . 122
6.2.1
Case Event Data . . . . . . . . . . . . . . . . . . . . . 122
6.2.2
Count Data . . . . . . . . . . . . . . . . . . . . . . . . 126
6.3
Cluster Detection Using Posterior Measures
. . . . . . . . . . 130
6.4
Cluster Models
. . . . . . . . . . . . . . . . . . . . . . . . . . 133
6.4.1
Case Event Data . . . . . . . . . . . . . . . . . . . . . 133
6.4.2
Count Data . . . . . . . . . . . . . . . . . . . . . . . . 143
6.4.3
Markov Connected Component Field (MCCF) Models 148
6.5
Edge Detection and Wombling
. . . . . . . . . . . . . . . . . 149
7
Ecological Analysis
151
7.1
General Case of Regression
. . . . . . . . . . . . . . . . . . . 151
7.2
Biases and Misclassiﬁcation Error . . . . . . . . . . . . . . . . 158
7.2.1
Ecological Biases . . . . . . . . . . . . . . . . . . . . . 158
7.3
Putative Hazard Models
. . . . . . . . . . . . . . . . . . . . . 165
7.3.1
Case Event Data . . . . . . . . . . . . . . . . . . . . . 166
7.3.2
Aggregated Count Data . . . . . . . . . . . . . . . . . 172
7.3.3
Spatiotemporal Eﬀects . . . . . . . . . . . . . . . . . . 176
8
Multiple Scale Analysis
185
8.1
Modiﬁable Areal Unit Problem (MAUP)
. . . . . . . . . . . . 185
8.1.1
Scaling Up
. . . . . . . . . . . . . . . . . . . . . . . . 185
8.1.2
Scaling Down . . . . . . . . . . . . . . . . . . . . . . . 187
8.1.3
Multiscale Analysis . . . . . . . . . . . . . . . . . . . . 187
8.2
Misaligned Data Problem(MIDP) . . . . . . . . . . . . . . . . 190
8.2.1
Predictor Misalignment
. . . . . . . . . . . . . . . . . 191
8.2.2
Outcome Misalignment . . . . . . . . . . . . . . . . . . 198
8.2.3
Misalignment and Edge Eﬀects . . . . . . . . . . . . . 200

x
Contents
9
Multivariate Disease Analysis
201
9.1
Notation for Multivariate Analysis
. . . . . . . . . . . . . . . 201
9.1.1
Case Event Data . . . . . . . . . . . . . . . . . . . . . 201
9.1.2
Count Data . . . . . . . . . . . . . . . . . . . . . . . . 202
9.2
Two Diseases
. . . . . . . . . . . . . . . . . . . . . . . . . . . 202
9.2.1
Case Event Data . . . . . . . . . . . . . . . . . . . . . 202
9.2.2
Count Data . . . . . . . . . . . . . . . . . . . . . . . . 204
9.2.3
Georgia County Level Example (3 Diseases) . . . . . . 206
9.3
Multiple Diseases
. . . . . . . . . . . . . . . . . . . . . . . . . 207
9.3.1
Case Event Data . . . . . . . . . . . . . . . . . . . . . 209
9.3.2
Count Data . . . . . . . . . . . . . . . . . . . . . . . . 216
9.3.3
Multivariate Spatial Correlation and MCAR Models . 219
9.3.4
Georgia Chronic Ambulatory Care-Sensitive
Example . . . . . . . . . . . . . . . . . . . . . . . . . . 222
10 Spatial Survival and Longitudinal Analysis
227
10.1
General Issues . . . . . . . . . . . . . . . . . . . . . . . . . . . 227
10.2
Spatial Survival Analysis . . . . . . . . . . . . . . . . . . . . . 228
10.2.1
Endpoint Distributions . . . . . . . . . . . . . . . . . . 228
10.2.2
Censoring . . . . . . . . . . . . . . . . . . . . . . . . . 229
10.2.3
Random Eﬀect Speciﬁcation . . . . . . . . . . . . . . . 230
10.2.4
General Hazard Model . . . . . . . . . . . . . . . . . . 232
10.2.5
Cox Model
. . . . . . . . . . . . . . . . . . . . . . . . 232
10.2.6
Extensions . . . . . . . . . . . . . . . . . . . . . . . . . 233
10.3
Spatial Longitudinal Analysis
. . . . . . . . . . . . . . . . . . 234
10.3.1
General Model
. . . . . . . . . . . . . . . . . . . . . . 237
10.3.2
Seizure Data Example . . . . . . . . . . . . . . . . . . 237
10.3.3
Missing Data . . . . . . . . . . . . . . . . . . . . . . . 241
10.4
Extensions to Repeated Events
. . . . . . . . . . . . . . . . . 243
10.4.1
Simple Repeated Events . . . . . . . . . . . . . . . . . 243
10.4.2
More Complex Repeated Events
. . . . . . . . . . . . 244
10.4.3
Fixed Time Periods
. . . . . . . . . . . . . . . . . . . 247
11 Spatiotemporal Disease Mapping
255
11.1
Case Event Data
. . . . . . . . . . . . . . . . . . . . . . . . . 255
11.2
Count Data
. . . . . . . . . . . . . . . . . . . . . . . . . . . . 257
11.2.1
Georgia Low Birth Weight Example
. . . . . . . . . . 262
11.3
Alternative Models
. . . . . . . . . . . . . . . . . . . . . . . . 266
11.3.1
Autologistic Models
. . . . . . . . . . . . . . . . . . . 266
11.3.2
Latent Structure ST Models . . . . . . . . . . . . . . . 268
11.4
Infectious Diseases
. . . . . . . . . . . . . . . . . . . . . . . . 271
11.4.1
Case Event Data . . . . . . . . . . . . . . . . . . . . . 272
11.4.2
Count Data . . . . . . . . . . . . . . . . . . . . . . . . 273
11.4.3
Special Case: Veterinary Disease Mapping . . . . . . . 276

Contents
xi
A Basic R and WinBUGS
283
A.1
Basic R Usage . . . . . . . . . . . . . . . . . . . . . . . . . . . 283
A.1.1
Data . . . . . . . . . . . . . . . . . . . . . . . . . . . . 283
A.1.2
Graphics . . . . . . . . . . . . . . . . . . . . . . . . . . 284
A.2
Use of R in Bayesian Modeling
. . . . . . . . . . . . . . . . . 287
A.3
WinBUGS . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 290
A.3.1
Simulation . . . . . . . . . . . . . . . . . . . . . . . . . 291
A.3.2
Model Code . . . . . . . . . . . . . . . . . . . . . . . . 291
A.4
R2WinBUGS Function . . . . . . . . . . . . . . . . . . . . . . 298
A.5
BRugs
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 302
A.6
Maps on R and GeoBUGS . . . . . . . . . . . . . . . . . . . . 305
B Selected WinBUGS Code
307
B.1
Code for the Convolution Model (Chapter 5)
. . . . . . . . . 307
B.2
Code for Spatial Spline Model (Chapter 5) . . . . . . . . . . . 308
B.3
Code for the Spatial Autologistic Model (Chapter 6)
. . . . . 308
B.4
Code for Logistic Spatial Case Control Model (Chapter 6)
. . 309
B.5
Code for PP Residual Model (Chapter 6)
. . . . . . . . . . . 309
B.5.1
Same Model with Uncorrelated Random Eﬀect . . . . . . 310
B.6
Code for the Logistic Spatial Case-Control Model (Chapter 6) 310
B.7
Code for Poisson Residual Clustering Example (Chapter 6)
. 312
B.8
Code for the Proper CAR Model (Chapter 7)
. . . . . . . . . . 312
B.9
Code for the Multiscale Model for PH and County Level Data
(Chapter 8)
. . . . . . . . . . . . . . . . . . . . . . . . . . . . 313
B.10 Code for the Shared Component Model for Georgia Asthma
and COPD (Chapter 9)
. . . . . . . . . . . . . . . . . . . . . 314
B.11 Code for the Seizure Example with Spatial Eﬀect (Chapter 10) 315
B.12 Code for the Knorr-Held Model for Space–Time Relative Risk
Estimation (Chapter 11) . . . . . . . . . . . . . . . . . . . . . 316
B.13 Code for the Space–Time Autologistic Model (Chapter 11) . . 316
C R Code for Thematic Mapping
319
References
321
Index
339


List of Tables
5.1
Comparison of convolution and uncorrelataed heterogeneity
models for the Georgia oral cancer dataset . . . . . . . . . . . .
93
5.2
DICs for three models: autologistic with no randon eﬀects; aut-
logistic with UH component; convolution model with UH and
CH . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
98
7.1
Model ﬁtting results for a variety of models for the South Car-
olina congenital mortality data, (See text for details).
. . . . . 154
7.2
Results for a variety of models ﬁtted to 1988 respiratory cancer
incident counts for counties of Ohio . . . . . . . . . . . . . . . . 175
7.3
Ohio respiratory cancer (1979–1988): putative source model ﬁts 181
8.1
Goodness of ﬁt results for separate and joint models for Georgia
oral cancer PH-county level data . . . . . . . . . . . . . . . . . 190
8.2
Model ﬁt results for the point misalignment example . . . . . . 197
9.1
Model comparisons for the three disease examples: joint, com-
mon, and shared
. . . . . . . . . . . . . . . . . . . . . . . . . . 207
9.2
Correlation of spatial random eﬀects under the MCAR model
for the Georgia chronic disease example: upper triangle: corre-
lation of the spatially structured eﬀects; lower triangle: corre-
lation of the relative risks . . . . . . . . . . . . . . . . . . . . . 225
10.1 Comparison of four models for the seizure data: basic and Mod-
els 1–3 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 239
10.2 Posterior average estimates of the model parameters under the
four diﬀerent seizure models . . . . . . . . . . . . . . . . . . . . 240
10.3 Parameter estimates for the basic model compared to the best
ﬁtting model (Model 1)
. . . . . . . . . . . . . . . . . . . . . . 240
11.1 Space–time models for the Georgia oral cancer dataset; models
are explained in text. . . . . . . . . . . . . . . . . . . . . . . . . 264
11.2 Autologistic space–time models: models 1–4; convolution model
(Model 5) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 267
xiii


Preface
Bayesian approaches to biostatistical problems have become commonplace
in epidemiological, medical, and public health applications. Indeed the use of
Bayesian methodology has seen great advances since the introduction of, ﬁrst,
BUGS, and then WinBUGS. WinBUGS is a free software package that allows
the development and ﬁtting of relatively complex hierarchical Bayesian mod-
els. The introduction of fast algorithms for sampling posterior distributions
in the 1990s has meant that relatively complex Bayesian models can be ﬁtted
in a straightforward manner. This has led to a great increase in the use of
Bayesian approaches not only to medical research problems but also in the ﬁeld
of public heath. One area of important practical concern is the analysis of the
geographical distribution of health data found commonly in both public health
databases and in clinical settings. Often population level data are available via
government data sources such as online community health systems (e.g., for
the US state of South Carolina this is http://scangis.dhec.sc.gov/scan/, while
in the US state of Georgia it is http://oasis.state.ga.us/) or via centrally orga-
nized data registries where individual patient records are held. Cancer registry
data (such as SEER in the United States) usually include individual diagnosis
type and date as well as demographic information and so is at a ﬁner level of
resolution.
Most government sources hold publicly accessible aggregated health data
due to conﬁdentiality requirements. The resulting count data, usually avail-
able at county or postal/census region level, can yield important insights into
the general spatial variation of disease in terms of incidence or prevalence. It
can also be analyzed with respect to health inequalities or disparities related
to health service provision. While this form of data and its analysis are rel-
atively well documented, there are other areas of novel application of spatial
methodology that are less well recognized currently. For example, one source of
individual level data are disease registries where notiﬁcation of a disease case
leads to registering the individual and their demographic details. In addition,
some diagnostic information is usually held. This is typically found on cancer
registries, but other diseases have similar registration processes. In clinical
trials, or community-based behavioral intervention trials, individual patient
information is often held and disease progression is noted over the duration
of the trial. In two ways, it may be important or relevant to consider spatial
information in such applications. First, the recruitment or dropout process
for trials may have a spatial component. Second, there may be unobserved
confounding variables that have a spatial expression over the course of the
xv

xvi
Preface
trial. These issues may lead to the consideration of longitudinal or survival
analyses where geo-referencing is admitted as a confounding factor. In general,
the focus area of this work is, in eﬀect, spatial biostatistics, as the inclusion
of clinical and registry-level analysis, as well as population level analyses, lies
within the range of applications for the methods covered.
In this work I have tried to provide an overview of the main areas of Bayesian
hierarchical modeling in its application to geographical analysis of disease. I
have tried to orient the coverage to both deal with population level analyses
and also individual level analyses resulting from cancer registry data and
also the possibility of the use of data on health service utilization (disease
progression via health practitioner visits, etc.), and designed studies (clinical
or otherwise). To this end, as well as including chapters on more conventional
topics such as relative risk estimation and clustering, I have included coverage
of spatial survival and longitudinal analysis, with a section on repeated event
analysis.
There are many people that have helped in the production of this work. In
particular, I would like to recognize sources of encouragement from Andrew
Cliﬀ, Sudipto Banerjee, Emmanuel Lesaﬀre, Peter Rogerson, and Allan Clark.
In addition, I have to thank a range of postdoctoral fellows and graduate stu-
dents who have provided help at various times: Hae-Ryoung Song, Ji-in Kim,
Huafeng Zhou, Kun Huang, Junlong Wu, Yuan Liu, and Bo Ma. I must also
thank those at CRC press for great help in ﬁnalizing the work. In particular,
Rob Calver for general production support and Shashi Kumar for Latex help.
Finally I would like to acknowledge the continual and patient support of
my family, and, in particular, Pat for her understanding during the sometimes
fraught activity of book writing.
Andrew Lawson
Charleston, United States
2008

Author
Andrew B. Lawson is professor of biostatistics in the Department of Bio-
statistics, Bioinformatics, and Epidemiology, Medical University of South
Carolina. Previously, he was professor of biostatistics in the Department of
Epidemiology and Biostatistics, University of South Carolina. Prior to USC,
he was reader in statistics in the Mathematical Sciences Department, Univer-
sity of Aberdeen, United Kingdom. He received a PhD in spatial statistics
from the University of St Andrews, United Kingdom. He has over 70 journal
papers on the subject of spatial epidemiology, spatial statistics, and related
areas. In addition to a number of book chapters, he is the author of 7 books in
areas related to spatial epidemiology. In addition to associate editorships on
a variety of journals, he is an advisor in disease mapping and risk assessment
for the World Health Organization (WHO).
Dr. Lawson’s research interests currently focus on analysis of clustered
disease maps and in the broad area of spatial and spatiotemporal disease
surveillance. He is currently involved in several National Institutes of Health
(NIH) funded projects in the area of surveillance and missing data and clus-
ter method evaluation. He also works in the area of nutritional measurement
error and Bayesian modeling.
xvii



Part I
Background


1
Introduction
Some basic ideas and history concerning Bayesian
methods
Bayesian methods have become commonplace in modern statistical applica-
tions. The acceptance of these methods is a relatively recent phenomenon
however. This acceptance has been facilitated in large measure by the de-
velopment of fast computational algorithms that were simply not commonly
available or accessible as recently as the late 1980s.The widespread adoption
of Markov chain Monte Carlo (McMC) methods for posterior distribution
sampling has led to a large increase in Bayesian applications. Most recently
Bayesian methods have become commonplace in epidemiology, and the phar-
maceutical industry, and they are becoming more widely accepted in Pub-
lic Health practice. As early as 1993, review articles appeared extolling the
virtues of McMC in medical applications (Gilks et al., 1993). This increase
in use has been facilitated by the implementation of software which provides
a platform for the posterior distribution sampling which is necessary when
relatively complex Bayesian models are employed. The development of the
package BUGS (Bayesian inference Using Gibbs Sampling) and its Windows
incarnation WinBUGS (Spiegelhalter et al., 2007) have had a huge eﬀect on
the dissemination and acceptance of these methods. To quote Cowles (2004):
“A brief search for recently published papers referencing WinBUGS turned
up applications in food safety, forestry, mental health policy, AIDS clinical
trials, population genetics, pharmacokinetics, pediatric neurology, and other
diverse ﬁelds, indicating that Bayesian methods with WinBUGS indeed are
ﬁnding widespread use.”
Basic ideas in Bayesian modeling stem from the extension of the likelihood
paradigm to allow parameters within the likelihood model to have distribu-
tions. These distributions are called prior distributions. Thus parameters are
allowed to be stochastic. By making this allowance, in turn, parameters in the
prior distributions of the likelihood parameters can also be stochastic. Hence
a natural parameter hierarchy is established. These hierarchical models form
the basis of inference under the Bayesian paradigm. By combining the like-
lihood (data) model with suitable prior distributions for the parameters, a
so-called posterior distribution is formed which describes the behavior of the
3

4
Bayesian Disease Mapping
parameters after having seen the data. There is a natural sequence underly-
ing this approach that allows it to well describe the progression of scientiﬁc
advance. The prior distribution is the current idea about the variation in the
parameter set, data is collected (and modeled within the likelihood) and this
updates our understanding of the parameter set variation via a posterior dis-
tribution. This posterior distribution can become the prior distribution for
the parameter set before the next data experiment.
Various reviews of the diﬀerent aspects of the Bayesian paradigm and mod-
eling are now available. Among these a seminal work on Bayesian Theory
has been provided by Bernardo and Smith (1994). Recent general reviews of
Bayesian methods appear in Leonard and Hsu (1999), Carlin and Louis (2000),
and Gelman et al. (2004). Overviews of Bayesian modeling are also provided
in Congdon (2003), Congdon (2005), Gelman and Hill (2007), and Congdon
(2007). For overview of McMC methods, Gamerman and Lopes (2006) and
Marin and Robert (2007) are useful starting points. For fuller coverage then
Gilks et al. (1996) and Robert and Casella (2005) are useful resources.
Some basic ideas and history concerning disease mapping
Disease mapping goes under a variety of names, some of which are: spatial
epidemiology, environmental epidemiology, disease mapping, small area health
studies. However at the center of these diﬀerent names are two characteristics.
First a spatial or geographical distribution is the focus and so the relative loca-
tion of events is important. This brings the world of geographical information
systems into play, while also including spatial statistics as a key component.
The second ingredient is that of disease and it is the spatial distribution of dis-
ease that is the focus. Hence the fundamental issue is how to analyze disease
incidence or prevalence when we have geographical information. Sometimes
this is called geo-referenced disease data, specifying the labeling of outcomes
with spatial tags.
It is apparent that none of the names listed above include the term “statis-
tics.” This is unfortunate as it is often the case that statistical methodology
(especially methodology from spatial statistics) is involved in the analysis of
maps of disease. A more appropriate description of the area of focus of this
work is Spatial Biostatistics as this emphasizes the broad nature of the focus.
In later chapters, I focus on both population level analysis and analysis of
clinical studies where longitudinal and survival data arise and so more con-
ventional biostatistical applications are also stressed here.
The area of disease mapping has had a long but checkered history. Some
of the ﬁrst epidemiological studies were geographic in nature. For example,
the study of the spatial distribution of cholera victims around the Broad

Introduction
5
Street pump by John Snow (Snow, 1854) was one of the earliest epidemio-
logical studies and it was innately geographical. The use of geo-referenced
data in observational studies was overtaken and subordinated to more rigor-
ous clinical studies in medicine and often the geo-referencing is assumed to
be irrelevant. In more recent decades, the development of fast computational
platforms and with them geographical information system (GIS) capabilities
has allowed a much greater sophistication in the handling of geo-referenced
data. This coupled with advances in computational algorithms has allowed
many spatial problems to be addressed eﬀectively with accessible software.
The recent rise on open source (free) software has provided wide access to
students and professionals. The existence of free software, such as GRASS, R,
and WinBUGS, enhances this access.
Within the area of spatial biostatistics the major advances have been rela-
tively recent. In the area of risk estimation and modeling the development of
Bayesian models with random eﬀects ﬁtted via McMC was ﬁrst proposed by
Besag et al. (1991). Since that time there has been a large increase in the use
of such methods. The use of scanning methods for disease cluster detection
was also developed quite recently by Kulldorﬀand Nagarwalla (1995). There is
now widespread use of scanning methods in cluster detection and surveillance.
The widespread use of Bayesian methods in most areas of disease mapping is
now well established and there is a need to review and summarize these dis-
parate strands in one place. The focus of this is on the use of Bayesian models
and computational methods in application to studies in spatial biostatistics.
Recent reviews of the general area of application of statistics in disease
mapping can be found in Lawson et al. (1999), Elliott et al. (2000), Waller
and Gotway (2004), Lawson (2006b), and Lawson and Banerjee (2008). For a
more epidemiologic slant, the edited work by Elliott et al. (1992) is useful. For
a GIS slant on health both human and veterinary see for example Maheswaran
and Craglia (2004), Durr and Gatrell (2004), or Pfeiﬀer et al. (2008).
1.1
Datasets
In the following chapters, a range of data sets are analyzed. Most of these are
available publicly and can be downloaded from public domain web sites. In
a few cases the data are conﬁdential and cannot be accessed widely without
approval. These latter datasets are not made available here. All other datasets
are available (along with a selection of relevant programs) at the Web site
http://www.sph.sc.edu/alawson/default.htm.
The datasets listed here are in order of appearance in the book, and are
those where it is possible to make available the data. Some datasets are well

6
Bayesian Disease Mapping
Standardized mortality ratio: congenital deaths
4 to 4 
(1)
2 to 4 
(8)
1 to 2 (27)
0 to 1 (10)
FIGURE 1.1
South Carolina congenital deaths by county 1990: standardized mortality ra-
tio.
known and are not displayed as they are viewable elsewhere.
1. South Carolina (SC) county level congenital anomaly deaths 1990. This
dataset consists of counts of deaths from congenital anomalies within
the year 1990 in 46 counties of South Carolina, United States, along
with expected death rates computed from the statewide rate, with-
out age–gender standardization, and applied to the county total pop-
ulation. The data is available from the SCAN system at South Car-
olina Department of Health and Environmental Control (SCDHEC):
(http://scangis.dhec.sc.gov/scan/). Both maps and tabulations of this
data are available online from that source. Figure 1.1 displays the stan-
dardized mortality ratios for this example computed as the ratio of the
count of disease to the expected rate within each county. The expected
rate is calculated from the standardized rate from the SC statewide
incidence rate of the condition.
2. Georgia oral cancer mortality 2004. This dataset consists of counts of
oral cancer deaths within the 159 counties of the state of Georgia, United
States. It also includes expected rates computed from the statewide
overall rate for 2004, and applied to the total county population. The
data is available from the OASIS online system of the Georgia DHR
Division of Public Health (http://oasis.state.ga.us/). Both maps and
tabulations of this data are available online from that source. Figure 1.2
displays the standardized mortality ratios for this example computed as
the ratio of the count of disease to the expected rate within each county.
Expected rates are computed from the statewide incidence rate.

Introduction
7
FIGURE 1.2
Georgia, United States, oral cancer standardized mortality ratio by county for
2004, using statewide rate.
3. Ohio respiratory cancer mortality count data set. The full dataset
covers 1968–1988 and consists of count data broken by age, gender,
and race for the state of Ohio, United States.
This is available from
http://www.stat.uni-muenchen.de/service/datenarchiv/ohio/ohio e.html.
This full data set has been analyzed many times (see e.g., Knorr-Held
and Besag, 1998; Carlin and Louis, 2000). Subsets of the data set us-
ing total counts in counties, or functions of counts, are used here: for
example 1968, 1979 in Chapter 5 and 1979–1988 in Chapter 7. The
data are accompanied by expected rates computed for each county from
the statewide rate stratiﬁed by age–gender groups and applied to these
groups in the county population and summed.
4. Ohio county data for the autologistic model: counts of ﬁrst order and
second order neighbors of each county and their totalled binary outcome
after thresholding by exceedence for the state of Ohio, United States.
These data are used in autologistic modeling when binary outcomes are
observed.
5. Georgia asthma mortality 2000. This dataset consists of counts of
asthma deaths within the 159 counties of the state of Georgia, USA.
It also includes expected rates computed from the statewide overall rate
for 2000, and applied to the total county population. The data is avail-
able from the OASIS online system of the Georgia Department of Human

8
Bayesian Disease Mapping
FIGURE 1.3
Georgia county level asthma mortality for year 2000: standardized mortality
ratios based on the statewide standard population rate.
Resources (DHR) Division of Public Health (http://oasis.state.ga.us/).
Both maps and tabulations of this data are available online from that
source. Figure
1.3 displays the standardized mortality ratios for this
example computed as the ratio of the count of deaths to the expected
death rate within each county. Expected rates are computed from the
statewide incidence rate.
6. Larynx cancer incidence, Lancashire NW England (1973–1984). This
dataset was made available by Peter Diggle. Variants of the dataset
have appeared at diﬀerent times. The dataset consists of the residen-
tial addresses of cases of larynx cancer (58) reported for the period
1973–1984 in the Charnock Richards area of Lancashire NW England,
United Kingdom. Within the map area is an incinerator (location: east-
ing 35450, northing 41400) and the data was originally collected to help
in the analysis of larynx cancer incidence around this location. Besides
the case address locations there are 978 control disease addresses (res-
piratory cancer incident cases) within the same study region.
7. South Carolina congenital anomaly deaths 1990: additional covariate
information. For each county, the percentage poverty listed under the
US census of 1990 and also the average household income for the same
census is given.

Introduction
9
8. Georgia oral cancer 2004 multi-level data: This dataset consists of counts
of oral cancer and expected rates for the 159 counties of Georgia as well
as the counts and expected rates for the 18 public health districts of
Georgia for the same period. The public health districts are groupings
of counties and are an aggregation of the county level data. The expected
rates are computed from statewide rates and applied to the local unit
population (district or county). Figure 1.4 displays the geographies for
the 18 public health districts and 159 counties of Georgia, United States.
In Chapter 8 these geographies are used with associated count data to
examine multiple scale models.
9. Anonymized binary outcome (misalignment example): this dataset con-
sists of 140 binary indicators (0: control, 1: case) and their address lo-
cations and the measured soil chemical concentration of arsenic (As)
found in a network of 119 sampling sites. The soil chemical values must
be interpolated to the sites of the binary outcome variable.
10. Georgia chronic multiple disease example. For the state of Georgia,
United States, for the year of 2005, this dataset consists of 3 ambulatory
care sensitive chronic diseases: asthma, chronic obstructive pulmonary
disease (COPD), and angina. These diseases could be aﬀected by poor
air quality and so could have common patterning or correlation. The
speciﬁc data used was counts of disease at county level in Georgia for
the year 2005 for all age and gender groups. This data is publicly avail-
able from the OASIS online system of the Georgia DHR Division of
Public Health (http://oasis.state.ga.us/). Both maps and tabulations of
this data are available online from that source. Figure 1.5 displays the
standardized incidence ratios for the three diseases. The expected rates
are computed from the statewide rate for each disease.
11. UK industrial town multiple disease example. The data set consists of
residential locations of death certiﬁcates for respiratory disease (bronchi-
tis) and air-way cancers (respiratory, gastric, and oesophageal) for the
period 1966–1976. These diseases were chosen as a set of diseases po-
tentially related to adverse air pollution. A control disease (lower body
cancers composite control) was also obtained. Another control (coronary
heart disease) was available, but it has a confounding with smoking).
The data consist of 630 coordinates of the residential locations of the
composite control and the three other diseases. As an example of the
data that is available in this study, Figure 1.6 displays three plots of
the spatial distribution of the case diseases of interest: gastric and oe-
sophageal cancer, respiratory cancer, and bronchitis.
12. Seizure data example. This dataset consists of seizure counts on 59 par-
ticipants in a clinical trial of an anti-convulsive therapy for epilepsy.

10
Bayesian Disease Mapping
FIGURE 1.4
Georgia, United States, public health district geographies (top panel) and
county geographies (bottom panel).

Introduction
11
(1) < 0.0
N
(66) 0.0-1.0
(67) 1.0-2.0
(21) 2.0-3.0
(4) > = 3.0
(18) < 0.0
(101) 0.0-2.5
(22) 2.5-5.0
(13) 5.0-7.5
(2) 7.5-10.0
(2) 10.0-12.5
(1) > = 12.5
N
N
(1) < 0.0
(45) 0.0-1.0
(75) 1.0-2.0
(27) 2.0-3.0
(9) 3.0-4.0
(1) 4.0-5.0
(9) > = 5.0
FIGURE 1.5
Georgia, United States, county level standardized incidence ratios for three
diseases: asthma (top left), COPD (bottom), angina (top right).

12
Bayesian Disease Mapping
Each participant has available: a group indicator (0/1: control, treat-
ment), seizure count at four time points, baseline seizure count, and age
in years. The dataset has been analyzed before by Breslow and Clayton
(1993), and is discussed in detail by Diggle et al. (2002). I have added a
randomly assigned spatial county indicator for South Carolina. The full
data set, for each individual, consists of variables: seizure count, county
indicator, baseline count, age, and group.
13. Burkitt’s lymphoma dataset: This dataset appears in the splancs package
in R. It consists of locations of Burkitt’s lymphoma cases in the Western
Nile district of Uganda for the period 1960–1975. In the dataset the
location of cases and a diagnosis date (days from January 1st 1960) are
given as well as the age of the case. There is no background population
information in this example. There are a total of 188 cases.
14. Georgia’s very low birthweight ST example: this dataset consists of
counts of very low birthweight births for the counties of Georgia, United
States for the sequence of 11 years 1994–2004. The total birth count for
the same period and county is also available. The data is available from
the OASIS online system of the Georgia DHR Division of Public Health
(http://oasis.state.ga.us/). Both maps and tabulations of this data are
available online from that source. Figure 1.7 displays the rate ratios for
the 11 years of very low birth weight births in relation to the county
birth rate over the 11 years over all counties.
15. Ohio respiratory cancer dataset 21 years: This dataset is, as for dataset
4, except that it is for 21 years (1968–1988) with a binary outcome
created by threshold exceedence. Both a one time unit lag and a 1st and
2nd order spatial neighborhood are available as covariates.
16. Georgia asthma ST dataset: this dataset is from Georgia, United States
and consists of ambulatory sensitive asthma case counts at county level
for 8 years for <1 year age group (1999–2006). Expected rates are also
available calculated from the statewide rate over the eight year period.
The data is available from the OASIS online system of the Georgia
DHR Division of Public Health (http://oasis.state.ga.us/). Both maps
and tabulations of this data are available online from that source. The
expected rates were computed from the overall rate (= total rate/total
population <1year) times the local population count <1 year. Figures
1.8 and 1.9 display the standardized incidence ratios for the ambulatory
asthma dataset for 1999–2004 and 2005–2006, respectively.
17. South Carolina ﬂu season C+ notiﬁcations data: this consists of count
data for laboratory C+ notiﬁcations for the 46 counties of South Car-
olina, United States by 13 time periods (biweekly recording) for the
2004–2005 ﬂu season. This data is publicly available from the SCAN
system at South Carolina Department of Health and Environmental
Control (SCDHEC): (http://scangis.dhec.sc.gov/scan/). Both maps and

Introduction
13
tabulations of this data are available online from that source. Figure 1.10
displays the count of notiﬁcations for four selected counties of South
Carolina for the ﬂu season over 13 bi-weekly periods.
18. Foot and Mouth dataset: this dataset consists of parish level counts of
foot and mouth disease (FMD) in Cumbria, NW England during the
FMD outbreak in the year 2001. The time period is biweekly, starting
February 2nd and ending June 1st (8 biweekly periods). This dataset
was made available by Dr. Mark Stevenson, Massey University, New
Zealand. Figure 1.11 displays the standardized incidence ratios for FMD
by parish.
0
10
20
30
40
50
60
70
80
90
x distance (km tenths)
0
20
40
60
80
100
120
140
y distance (km tenths)
0
10 20 30 40 50 60 70 80 90 100
x distance (km tenths)
0
20
40
60
80
100
120
140
y distance (km tenths)
0
10
20
30
40
50
60
70
80
90
100
x distance (km tenths)
-10
10
30
50
70
90
110
130
y distance (km tenths)
FIGURE 1.6
UK industrial town mortality study: gastric and oesophageal cancer (top);
respiratory cancer (middle); bronchitis (bottom).

14
Bayesian Disease Mapping
(42) < 0.01
(61) 0.01-0.02
(34) 0.02-0.03
(10) 0.03-0.04
(4) 0.04-0.05
(8) > = 0.05
N
(36) < 0.01
(73) 0.01-0.02
(29) 0.02-0.03
(15) 0.03-0.04
(2) 0.04-0.05
(4) > = 0.05
N
N
(44) < 0.01
(66) 0.01-0.02
(36) 0.02-0.03
(10) 0.03-0.04
(2) 0.04-0.05
(1) > = 0.05
N
(36) < 0.01
(76) 0.01-0.02
(31) 0.02-0.03
(10) 0.03-0.04
(1) 0.04-0.05
(5) > = 0.05
(32) < 0.01
(72) 0.01-0.02
(40) 0.02-0.03
(7) 0.03-0.04
(7) 0.04-0.05
(1) > = 0.05
N
N
(39) < 0.01
(65) 0.01-0.02
(48) 0.02-0.03
(5) 0.03-0.04
(0) 0.04-0.05
(2) > = 0.05
N
(34) < 0.01
(62) 0.01-0.02
(47) 0.02-0.03
(13) 0.03-0.04
(3) 0.04-0.05
(0) > = 0.05
N
(33) < 0.01
(68) 0.01-0.02
(39) 0.02-0.03
(12) 0.03-0.04
(1) 0.04-0.05
(6) > = 0.05
N
(39) < 0.01
(67) 0.01-0.02
(35) 0.02-0.03
(11) 0.03-0.04
(3) 0.04-0.05
(4) > = 0.05
N
(31) < 0.01
(71) 0.01-0.02
(41) 0.02-0.03
(9) 0.03-0.04
(3) 0.04-0.05
(4) > = 0.05
N
(28) < 0.01
(66) 0.01-0.02
(42) 0.02-0.03
(13) 0.03-0.04
(6) 0.04-0.05
(4) > = 0.05
FIGURE 1.7
Georgia county level very low birth weight (VLBW) risk ratios

Introduction
15
(87) < 1.0
(25) 1.0-2.0
(15) 2.0-3.0
(15) 3.0-5.0
(15) 5.0-10.0
(2) > = 10.0
N
(81) < 1.0
(31) 1.0-2.0
(19) 2.0-3.0
(11) 3.0-5.0
(12) 5.0-10.0
(5) > = 10.0
N
(67) < 1.0
(29) 1.0-2.0
(22) 2.0-3.0
(20) 3.0-5.0
(15) 5.0-10.0
(6) > = 10.0
N
(78) < 1.0
(25) 1.0-2.0
(15) 2.0-3.0
(20) 3.0-5.0
(16) 5.0-10.0
(5) > = 10.0
N
(91) < 1.0
(30) 1.0-2.0
(13) 2.0-3.0
(13) 3.0-5.0
(8) 5.0-10.0
(4) > = 10.0
N
(100) < 1.0
(33) 1.0-2.0
(6) 2.0-3.0
(12) 3.0-5.0
(6) 5.0-10.0
(2) > = 10.0
N
FIGURE 1.8
Standardized incidence ratios for Georgia ambulatory asthma for 1999–2000.
(108) < 1.0
(21) 1.0-2.0
(11) 2.0-3.0
(12) 3.0-5.0
(5) 5.0-10.0
(2) > = 10.0
(106) < 1.0
(26) 1.0-2.0
(10) 2.0-3.0
(10) 3.0-5.0
(3) 5.0-10.0
(4) > = 10.0
N
N
FIGURE 1.9
Standarized incidence ratios for Georgia ambulatory asthma for 2005–2006.

16
Bayesian Disease Mapping
FIGURE 1.10
South Carolina inﬂuenza C+ notiﬁcations for the 2004–2005 ﬂu season: counts
for 13 biweekly time periods.

Introduction
17
N
S
SIR
0-0.500
0.501-1.000
1.001-1.500
1.501-2.000
2.001-2.500
> 2.500
E
W
N
S
SIR
0-0.500
0.501-1.000
1.001-1.500
1.501-2.000
2.001-2.500
> 2.500
E
W
N
S
SIR
0-0.500
0.501-1.000
1.001-1.500
1.501-2.000
2.001-2.500
> 2.500
E
W
N
S
SIR
0-0.500
0.501-1.000
1.001-1.500
1.501-2.000
2.001-2.500
> 2.500
E
W
N
S
SIR
0-0.500
0.501-1.000
1.001-1.500
1.501-2.000
2.001-2.500
> 2.500
E
W
N
S
SIR
0-0.500
0.501-1.000
1.001-1.500
1.501-2.000
2.001-2.500
> 2.500
E
W
N
S
SIR
0-0.500
0.501-1.000
1.001-1.500
1.501-2.000
2.001-2.500
> 2.500
E
W
N
S
SIR
0-0.500
0.501-1.000
1.001-1.500
1.501-2.000
2.001-2.500
> 2.500
E
W
FIGURE 1.11
Northwest England Foot-and-Mouth disease (FMD) during the 2001 epidemic:
parish level standardized incidence ratios for 8 biweekly periods.


2
Bayesian Inference and Modeling
The development of Bayesian inference has as its kernel the data likelihood.
The likelihood is the joint distribution of the data evaluated at the sample
values. It can also be regarded as a function describing the dependence of a
parameter or parameters on sample values. Hence there can be two interpre-
tations of this function. In Bayesian inference it is this latter interpretation
that is of prime importance. In fact, the likelihood principle, by which obser-
vations come into play through the likelihood function, and only through the
likelihood function, is a fundamental part of the Bayesian paradigm (Bernardo
and Smith (1994) Section 5.1.4). This implies that the information content
of the data is entirely expressed by the likelihood function. Furthermore, the
likelihood principle implies that any event that did not happen has no eﬀect
on an inference, since if an unrealized event does aﬀect an inference then there
is some information not contained in the likelihood function.
2.1
Likelihood Models
The likelihood for data {yi}, i = 1, ..., m , is deﬁned as
L(y|θ) =
m

i=1
f(yi|θ)
(2.1)
where θ is a p length vector θ : {θ1, θ2, ..., θp} and f(.|.) is a probability density
(or mass) function. The assumption is made here that the ‘sample’ values of
y given the parameters are independent, and hence it is possible to take the
product of individual contributions in (2.1). Hence the data are assumed to
be conditionally independent. Note that in many spatial applications the data
would not be unconditionally independent and would in fact be correlated.
This conditional independence is an important assumption fundamental to
many disease mapping applications. The logarithm of the likelihood is also
useful in model development and is deﬁned as
l(y|θ) =
m

i=1
log f(yi|θ).
(2.2)
19

20
Bayesian Disease Mapping
2.1.1
Spatial Correlation
Within spatial applications it is often found that correlation will exist be-
tween spatial units. This correlation is geographical and relates to the basic
idea that locations close together in space often have similar values of outcome
variables while locations far apart are often diﬀerent. This spatial correlation
(or autocorrelation as it’s sometimes called) must be allowed for in spatial
analyses. This may have an impact on the structure and form of likelihood
models that are assumed for spatial data. The assumption made in the con-
struction of conventional likelihoods is that the individual contribution to the
likelihood is independent and this independence allows the likelihood to be
derived as a product of probabilities. However, if this independence criterion
is not met, then a diﬀerent approach would be required.
2.1.1.1
Conditional independence
In some circumstances it is possible to consider conditional independence of
the data given parameters at a higher level of the hierarchy. For instance
in count data examples yi from the i th area might be thought to be inde-
pendent of other outcomes given knowledge of the model parameters. In the
simple case, of dependence on a parameter vector θ, then conditioning on
the parameters can allow [ yi|θ] to be assumed to be an independent contri-
bution. This simply states that dependence only exists unconditionally (i.e.,
unobserved eﬀects can induce dependence). This is often true in disease map-
ping examples where confounders that have spatial expression may or may
not be measured in a study and their exclusion may leave residual correla-
tion in the data. Note that this approach to correlation does not completely
account for spatial eﬀects as there can be residual correlation eﬀects after in-
clusion of confounders. These eﬀects could be due to unobserved or unknown
confounders. Alternatively they could be due to intrinsic correlation in the
process. Hence the assumption of conditional independence may only be valid
if correlation is accounted for somewhere within the model.
The idea of inclusion of spatial correlation at a hierarchical level above the
likelihood is a fundamental assumption often made in Bayesian small area
health modeling. This means that the correlation appears in prior distribu-
tions rather than in the likelihood itself. Often parameters are given such
priors and it is assumed that conditional independence applies in the likeli-
hood. This is valid for many situations and will be the focus of most of this
book.
2.1.1.2
Joint densities with correlation
Situations exist where spatial correlation can be incorporated within a joint
distribution of the data. For example if a continuous spatial process is observed
at measurement sites (such as air pollutants, soil chemical concentration, wa-
ter quality) then often a spatial Gaussian process (SGP) will be assumed

Bayesian Inference and Modeling
21
(Ripley, 1981). This process assumes that any realisation of the process is
multivariate normal with spatially-deﬁned covariance, within its speciﬁcation.
Hence, if these data were observed outcome data, then the joint density would
include spatial correlation (see Section 5.4.2).
Alternatively, it is possible to consider discrete outcome data where corre-
lation is explicitly modeled. The autologistic and auto-Poisson models were
developed for lattice data with spatial correlation included via dependence
on a spatial neighborhood (Besag and Tantrum, 2003). In this approach, the
normalization of the likelihood is computationally prohibitive and resort is
often made to likelihood approximation (see Section 2.1.1.3).
2.1.1.3
Pseudolikelihood approximation
Pseudolikelihood has been proposed as an option to exact likelihood anal-
ysis when correlation exists. It has a number of variants (composite, local,
pairwise: Lindsay (1988), Tibshirani and Hastie (1987), Kauermann and Op-
somer (2003), Nott and Ryd´en (1999), Varin et al. (2005)). Pseudolikelihood
has been used for autologistic models both in space and time (most recently
by Besag and Tantrum (2003)). In space, the likelihood is given by
Lp(y|θ) =
m

i=1
f(yi|yj̸=i, θ).
For the autologistic model, with binary outcome yi, a simple version could be
f(yi|yj̸=i) =
exp[m(β, {yj}j∈δi)]
1 + exp[m(β, {yj}j∈δi)]
where δi is a neighbourhood set of the i th location/area, and m(.) is a spec-
iﬁed function (such as mean or median) and β is a parameter controlling
the spatial smoothing or degree of correlation. For nonlattice data the neigh-
borhood can be deﬁned by adjacency (for count data this could be adjacent
regions and for case event data this could be tesselation neighbours).
It is
known that pseudolikelihood is least biased when relatively low spatial corre-
lation exists (see e.g., Diggle et al., 1994). While the autologistic model has
seen some application, the auto-Poisson model is limited by its awkward neg-
ative correlation structure. An autobinomial model is also available for the
situation where yi is a count of disease out of a ﬁnite local population ni (see
e.g., Cressie (1993), 431).

22
Bayesian Disease Mapping
2.2
Prior Distributions
All parameters within Bayesian models are stochastic and are assigned appro-
priate probability distributions. Hence a single parameter value is simply one
possible realization of the possible values of the parameter, the probability of
which is deﬁned by the prior distribution. The prior distribution is a distri-
bution assigned to the parameter before seeing the data. Note also that one
interpretation of prior distributions are that they provide additional ‘data’ for
a problem and so they can be used to improve estimation or identiﬁcation of
parameters. For a single parameter, θ, the prior distribution can be denoted
g(θ), while for a parameter vector, θ, the joint prior distribution is g(θ).
2.2.1
Propriety
It is possible that a prior distribution can be improper. Inpropriety is deﬁned as
the condition that integration of the prior distribution of the random variable
θ over its range (Ω) is not ﬁnite:

Ω
g(θ)dθ = ∞.
A prior distribution is improper if its normalizing constant is inﬁnite. While
impropriety is a limitation of any prior distribution, it is not necessarily the
case that an improper prior will lead to impropriety in the posterior distribu-
tion. The posterior distribution can often be proper even with an improper
prior speciﬁcation.
2.2.2
Noninformative Priors
Often prior distributions are assumed that do not make strong preferences over
values of the variables. These are sometimes known as vague, or reference or
ﬂat or noninformative prior distributions. Usually, they have a relatively ﬂat
form yielding close-to-uniform preference for diﬀerent values of the variables.
This tends to mean that in any posterior analysis (see Section 2.3) that the
prior distribution(s) will have little impact compared to the likelihood of the
data. Jeﬀrey’s priors were developed in an attempt to ﬁnd such reference pri-
ors for given distributions. They are based on the Fisher information matrix.
For example, for the binomial data likelihood with common parameter p, then
the Jeﬀrey’s prior distribution is p ∼Beta(0.5, 0.5). This is a proper prior dis-
tribution. However it is not completely noninformative as it has asymptotes
close to 0 and 1. Jeﬀrey’s prior for the Poisson data likelihood with common
mean θ is given by g(θ) ∝θ−1
2 which is improper. This also is not particu-
larly noninformative. The Jeﬀrey’s prior is locally uniform, but can often be
improper.

Bayesian Inference and Modeling
23
Choice of noninformative priors can often be made with some general un-
derstanding of the range and behavior of the variable. For example, variance
parameters must have prior distributions on the positive real line. Noninfor-
mative distributions in this range are often in the gamma, inverse gamma,
or uniform families. For example, τ ∼G(0.001, 0.001) will have a small mean
(1) but a very large variance (1000) and hence will be relatively ﬂat over
a large range. Another speciﬁcation chosen is τ ∼G(0.1, 0.1) with variance
10 for a more restricted range. On the other hand, a uniform distribution
on a large range has been advocated for the standard deviation (Gelman,
2006), √τ ∼U(0, 1000). For parameters on an inﬁnite range, such as regres-
sion parameters, then a distribution centered on zero with a large variance
will usually suﬃce. The zero-mean Gaussian or Laplace distribution could be
assumed. For example,
β ∼N(0, τβ)
τ β = 100000.
is typically assumed in applications. The Laplace distribution is favoured
in large scale Bayesian regression to encourage removal of covariates
(Balakrishnan and Madigan (2006)).
Of course sometimes it is important to be informative with prior distribu-
tions. Identiﬁability is an issue relating to the ability to distinguish between
parameters within a parametric model (see e.g., Bernardo and Smith (1994,
239). In particular, if a restricted range must be assumed to allow a number
of variables to be identiﬁed, then it may be important to specify distributions
that will provide such support. Ultimately, if the likelihood has little or no in-
formation about the separation of parameters then separation or identiﬁcation
can only come from prior speciﬁcation. In general, if proper prior distributions
are assumed for parameters then they are identiﬁed in the posterior distribu-
tion. However, how far they are identiﬁed may depend on the assumed vari-
ability. An example of identiﬁcation which arises in disease mapping is where
a linear predictor is deﬁned to have two random eﬀect components:
log θi = vi + ui,
and the components have diﬀerent normal prior distributions with variances
(say, τ v, τ u). These variances can have gamma prior distributions such as:
τ v ∼G(0.001, 0.001)
τ u ∼G(0.1, 0.1).
The diﬀerence in the variability of the second prior distribution allows there
to be some degree of identiﬁcation. Note that this means that a priori τv will
be allowed greater variability in the variance of vi than that found in ui.

24
Bayesian Disease Mapping
2.3
Posterior Distributions
Prior distributions and likelihood provide two sources of information about
any problem. The likelihood informs about the parameter via the data, while
the prior distributions inform via prior beliefs or assumptions. When there
are large amounts of data, i.e., the sample size is large, the likelihood will
contribute more to the relative risk estimation. When the example is data
poor, then the prior distributions will dominate the analysis.
The product of the likelihood and the prior distributions is called the pos-
terior distribution. This distribution describes the behavior of the parameters
after the data are observed and prior assumptions are made. The posterior
distribution is deﬁned as
p(θ|y) = L(y|θ)g(θ)/C
(2.3)
where C =

p
L(y|θ)g(θ)dθ.
where g(θ) is the joint distribution of the θ vector. Alternatively this distri-
bution can be speciﬁed as a proportionality: p(θ|y) ∝L(y|θ)g(θ).
A simple example of this type of model in disease mapping is where the
data likelihood is Poisson and there is a common relative risk parameter with
a single gamma prior distribution:
p(θ|y) ∝L(y|θ)g(θ)
where g(θ) is a gamma distribution with parameters α, β i.e., G(α, β), and
L(y|θ) = m
i=1{(eiθ)yi exp(−eiθ)} bar a constant only dependent in the data.
A compact notation for this model is
yi|θ ∼Pois(eiθ)
θ ∼G(α, β).
This leads to a posterior distribution for ﬁxed α, β of:
[θ|{yi}, α, β] = L(y|θ, α, β).p(θ)/C
where C =

L(y|θ, α, β).p(θ)dθ.
In this case the constant C can be calculated directly and it leads to another
gamma distribution:
[θ|y, α, β] = β∗α∗
Γ(α∗)θα∗−1 exp(−θβ∗) where α∗=

yi + α, β∗=

ei + β.

Bayesian Inference and Modeling
25
2.3.1
Conjugacy
Certain combinations of prior distributions and likelihoods lead to the same
distribution family in the posterior as for the prior distribution. This can lead
to advantages in inference as the posterior form will follow from the prior
speciﬁcation. For instance, for the Poisson likelihood with mean parameter θ
then with a gamma prior distribution for θ, the posterior distribution of θ is
also gamma. Similar results hold for binomial likelihood and beta prior distri-
bution and for a normal data likelihood with a normal prior distribution for
the mean. The table below gives a small selection of results of this conjugacy.
Conjugacy can often be found by examining the kernel of the prior-likelihood
product. The unnormalized kernel should have a recognizable form related to
the conjugate distribution. For example, a beta form has unnormalised kernel
θα−1(1 −θ)β−1. Conjugacy always guarantees a proper posterior distribution.
Note that conjugacy may not be possible within a large parameter hierarchy
but conditional conjugacy could be useful to exploit when examining model
adequacy. It is also the case that for the sophisticated hierarchical models
found in disease mapping, simple conjugacy is less likely to be available.
Likelihood
Prior
Posterior
y ∼Poisson(θ)
θ ∼G(α, β)
θ|y ∼G(

yi + α, m + β)
y ∼binomial(p,1)
p ∼Beta(α1, α2)
p|y ∼Beta(

yi + α1, m
−

yi + α2)
y ∼normal( μ, τ),
μ ∼N(α0, τ 0)
μ|y ∼N(
τ 0

yi+α0τ
mτ 0+τ
,
τ 0τ
mτ 0+τ )
τ ﬁxed
y ∼gamma (1, β)
β ∼G(α0, β0)
β|y ∼G(1 + α0, β0 +

yi)
2.3.2
Prior Choice
Choice of prior distributions is very important as it can be the case that the
prior distributions of parameters can aﬀect the posterior signiﬁcantly. The
balance between prior and posterior evidence is related to the dominance of
the likelihood and is a sample size issue. For example, with large samples the
likelihood usually dominates the prior distributions. This eﬀectively means
that current data are given priority in their weight of evidence. Prior distri-
butions that dominate the likelihood are informative, but have less inﬂuence
as simple size increases. Hence, with additional data, the data speak more. Of
course when parameters are not identiﬁed within a likelihood then additional
data are unlikely to change the importance of informative priors in identiﬁca-

26
Bayesian Disease Mapping
tion. Propriety of posterior distributions is important as only under propriety
can the absolute statements about probability of posterior parameter values
be made.
2.4
Predictive Distributions
The posterior distribution summarizes our understanding about the parame-
ters given observed data and plays a fundamental role in Bayesian modeling.
However we can also examine other related distributions that are often useful
when prediction of new data (or future data) is required. Deﬁne a new obser-
vation of y as y∗. We can determine the predictive distribution of y∗in two
ways. In general the predictive distribution is deﬁned as
p(y∗|y) =

L(y∗|θ)p(θ|y)dθ.
(2.4)
Here the prediction is based on marginalizing over the parameters in the
likelihood of the new data (L(y∗|θ)) using the posterior distribution p(θ|y) to
deﬁne the contribution of the observed data to the prediction. This is termed
the posterior predictive distribution. A variant of this deﬁnition uses the prior
distribution instead of the posterior distribution:
p(y∗|y) =

L(y∗|θ)p(θ)dθ.
(2.5)
This emphasizes the prediction based only on the prior distribution (before
seeing any data). Note that this distribution (2.5) is just the marginal distri-
bution of y∗.
2.4.1
Poisson–Gamma Example
A classic example of a predictive distribution that arises in disease mapping is
the negative binomial distribution. Let yi, i = 1, ..., n be counts of disease in
arbitrary small areas (e.g., census tracts, zip codes, districts). Also deﬁne, for
the same areas, expected rates {ei} and relative risks {θi}. We assume that
independently yi ∼Poisson(eiθi) given θi. Assume that θi = θ ∀i and that
the prior distribution of θ, p(θ), is θ ∼Gamma(α, β) where E(θ) = α/β, and
var(θ) = α/β2. The posterior distribution of θ is
[θ|y, α, β] = β∗α∗
Γ(α∗)θα∗−1 exp(−θβ∗) where α∗=

yi + α, β∗=

ei + β.

Bayesian Inference and Modeling
27
It follows that the (prior) predictive distribution is
[y∗|y,a, b] =

f(y∗|θ)f(θ|a, b)dθ
(2.6)
=
m

i=1
 ba
Γ(a)
Γ(y∗
i + a)
(ei + b)(y∗
i +a)

.
2.5
Bayesian Hierarchical Modeling
In Bayesian modeling the parameters have distributions. These distributions
control the form of the parameters and are speciﬁed by the investigator based,
usually, on their prior belief concerning their behavior. These distributions are
prior distributions and I will denote such a distribution by g(θ). In the disease
mapping context a commonly assumed prior distribution for θ in a Poisson
likelihood model is the gamma distribution and the resulting model is the
Poisson–gamma model.
2.6
Hierarchical Models
A simple example of a hierarchical model that is commonly found in disease
mapping is where the data likelihood is Poisson and there is a common relative
risk parameter with a single gamma prior distribution:
p(θ|y) ∝L(y|θ)g(θ)
where g(θ) is a gamma distribution with parameters α, β i.e., G(α, β),and
L(y|θ) = m
i=1{(eiθ)yi exp(eiθ)} bar a constant only dependent in the data.
A compact notation for this model is:
yi|θ ∼Pois(eiθ)
θ ∼G(α, β).
In the previous section a simple example of a likelihood and prior distri-
bution was given. In that example the prior distribution for the parameter
also had parameters controlling its form. These parameters (α, β) can have
assumed values, but more usually an investigator will not have a strong belief
in the prior parameters values. The investigator may want to estimate these
parameters from the data. Alternatively and more formally, as parameters
within models are regarded as stochastic (and thereby have probability dis-
tributions governing their behavior), then these parameters must also have

28
Bayesian Disease Mapping
distributions. These distributions are known as hyperprior distributions, and
the parameters are known as hyperparameters.
The idea that the values of parameters could arise from distributions is a
fundamental feature of Bayesian methodology and leads naturally to the use
of models where parameters arise within hierarchies. In the Poisson–gamma
example there is a two level hierarchy: θ has a G(α, β) distribution at the ﬁrst
level of the hierarchy and α will have a hyperprior distribution (hα) as will β
(hβ), at the second level of the hierarchy. This can be written as:
yi|θ ∼Pois(eiθ)
θ|α, β ∼G(α, β)
α|ν ∼hα(ν)
β|ρ ∼hβ(ρ).
For these types of models it is also possible to use a graphical tool to display
the linkages in the hierarchy. This is known as a directed acyclic graph or
DAG for short. On such a graph lines connect the levels of the hierarchy
and parameters are nodes at the ends of the lines. Clearly it is important
to terminate a hierarchy at an appropriate place, otherwise one could always
assume an inﬁnite hierarchy of parameters. Usually the cutoﬀpoint is chosen
to lie where further variation in parameters will not aﬀect the lowest level
model. At this point the parameters are assumed to be ﬁxed. For example, in
the Poisson–gamma model if you assume α and β were ﬁxed then the Gamma
prior would be ﬁxed and the choice of α and β would be uninformed. The data
would not inform about the distribution at all. However by allowing a higher
level of variation i.e., hyperpriors for α, β, then we can ﬁx the values of ν and
ρ without heavily inﬂuencing the lower level variation. Figure 2.1 displays the
DAG for the simple two level Poisson–gamma model just described.
2.7
Posterior Inference
When a simple likelihood model is employed, often maximum likelihood is
used to provide a point estimate and associated variability for parameters.
This is true for simple disease mapping models. For example, in the model
yi|θ ∼Pois(eiθ) the maximum likelihood estimate of θ is the the overall
rate for the study region i.e.,  yi/  ei.On the other hand, the SMR is the
maximum likelihood estimate for the model yi|θi ∼Pois(eiθi).
When a Bayesian hierarchical model is employed it is no longer possible to
provide a simple point estimate for any of the θis.This is because the parame-
ter is no longer assumed to be ﬁxed but to arise from a distribution of possible
values. Given the observed data, the parameter or parameters of interest will

Bayesian Inference and Modeling
29
FIGURE 2.1
Directed acyclic graph for the Possion–gamma hiararchical model.
be described by the posterior distribution, and hence this distribution must
be found and examined. It is possible to examine the expected value (mean)
or the mode of the posterior distribution to give a point estimate for a pa-
rameter or parameters: e.g., for a single parameter θ, say, then E(θ|y) =
	
θ
p(θ|y)dθ, and arg max
θ
p(θ|y). Just as the maximum likelihood estimate is the
mode of the likelihood, then the maximum a posteriori estimate is that value
of the parameter or parameters at the mode of the posterior distribution.
More commonly the expected value of the parameter or parameters is used.
This is known as the posterior mean (or Bayes estimate). For simple unimodal
symmetrical distributions, the modal and mean estimates coincide.
For some simple posterior distributions it is possible to ﬁnd the exact form
of the posterior distribution and to ﬁnd explicit forms for the posterior mean or
mode. However, it is commonly the case that for reasonably realistic models
within disease mapping, it is not possible to obtain a closed form for the
posterior distribution. Hence it is often not possible to derive simple estimators
for parameters such as the relative risk. In this situation resort must be made
to posterior sampling i.e., using simulation methods to obtain samples from
the posterior distribution which then can be summarized to yield estimates
of relevant quantities. In the next section we discuss the use of sampling
algorithms for this purpose.

30
Bayesian Disease Mapping
Falkirk by smr
1.26 to 2.04 (6)
1.06 to 1.26 (3)
0.8 to1.06 (6)
0.61 to 0.8 (5)
0.3 to 0.61 (6)
Falkirk: EB relative risks
1.24 to 1.88 (5)
1.03 to 1.24 (4)
0.83 to 1.03 (4)
0.66 to 0.83 (6)
0.39 to 0.66 (7)
FIGURE 2.2
26 census enumeration districts (tracts) in Falkirk, Scotland: respirartory can-
cer mortality counts 1978–1983. Left panel is the standardised mortality ratio
map using external age × sex standardised expected rates and the right panel
is the Poisson–gamma estimates of relative risk using the empirical Bayes
approach of Clayton and Kaldor (1987).
An exception to this situation where a closed form posterior distribution
can be obtained is the Poisson–gamma model where α, β are ﬁxed. In that
case, the relative risks have posterior distribution given by:
θi|yi, ei, α, β ∼G(yi + α, ei + β)
and the posterior expectation of θi is (yi +α)/(ei +β). The posterior variance
is also available: (yi + α)/(ei + β)2, as is the modal value which is
arg max
θ p(θ|y) =

[(yi + α) −1]/(ei + β) if (yi + α) ≥1
0 if (yi + α) < 1
Of course, if α and β are not ﬁxed and have hyperprior distributions then
the posterior distribution is more complex. Clayton and Kaldor (1987) use
an approximation procedure to obtain estimates of α and β from a marginal
likelihood apparently on the assumption that α and β had uniform hyperprior
distributions. These estimates are those displayed in Figure 2.2. Note that
these are not the full posterior expected estimates of the parameters from
within a two level model hierarchy.
2.7.1
A Bernoulli and Binomial Example
Another example of a model hierarchy that arises commonly is the small area
health data where a ﬁnite population exists within an area and within that
population binary outcomes are observed. A fuller discussion of these models

Bayesian Inference and Modeling
31
is given in Section 5.1.3. In the case event example, deﬁne the case events
as si : i = 1, ..., m and the control events as si : i = m + 1, ...., N where
N = m + n the total number of events in the study area. Associated with
each location is a binary variable (yi) which labels the event either as a case
(yi = 1) or a control (yi = 0). A conditional Bernoulli model is assumed for
the binary outcome where pi is the probability of an individual being a case,
given the location of the individual. Hence we can specify that yi ∼Bern(pi).
Here the probability will usually have either a prior distribution associated
with it, or will be linked to other parameters and covariate or random eﬀects,
possibly via a linear predictor. Assume that a logistic link is appropriate for
the probability and that two covariates are available for the individual: x1 :
age, x2 : exposure level (of a health hazard). Hence,
pi =
exp(α0 + α1x1i + α2x2i)
1 + exp(α0 + α1x1i + α2x2i)
is a valid logistic model for this data with three parameters (α0, α1, α2). As-
sume that the regression parameters will have independent zero-mean Gaus-
sian prior distributions. The hierarchical model is speciﬁed in this case as:
yi|pi ∼Bern(pi)
logit(pi) = x′
iα
αj|τ j ∼N(0, τj)
τ j ∼G(ψ1, ψ2).
In this case, x′
i is the i th row of the design matrix (including an intercept
term), α is the (3 × 1) parameter vector, τj is the variance for the j th
parameter, and ψ1 and ψ2 are ﬁxed scale and shape parameters. Figure 2.3
displays the hierarchy for this model.
In the binomial case we would have a collection of small areas within which
we observe events. Deﬁne the number of small areas as m and the total pop-
ulation as ni. Within the population of each area individuals have a binary
label which denotes the case status of the individual. The number of cases are
denoted as yi and it is often assumed that the cases follow an independent
binomial distribution, conditional on the probability that an individual is a
case, deﬁned as pi: yi ∼Bin(pi, ni).
The likelihood is given by L(yi|pi, ni) =
m

i=1
ni
yi

pyi
i (1 −pi)(ni−yi). Here the
probability will usually have either a prior distribution associated with it, or
will be linked to other parameters and covariate or random eﬀects, possibly via
a linear predictor such as logit(pi) = x′
iα + z′
iγ. In this general case, the z′
i are
a vector of individual level random eﬀects and the γ is a unit vector. Assume
that a logistic link is appropriate for the probability and that a random eﬀect

32
Bayesian Disease Mapping
FIGURE 2.3
The Bernoulli hierarchical model where the logit link to a linear predication
is assumed to a linear predictor. There are three parameters for intercept and
two covariates. These parameters’ distributions have variances with a gamma
hyperprior with ﬁxed and common parameters.
at the individual level is to be included: vi. Hence,
pi =
exp(α0 + vi)
1 + exp(α0 + vi)
would represent a basic model with intercept to capture the overall rate and
prior distribution for the intercept and the random eﬀect could be assumed
to be α0 ∼N(0, τα0), and vi ∼N(0, τ v). The hyperprior distribution for the
variance parameters could be a distribution on the positive real line such as
the gamma, inverse gamma, or uniform. The uniform distribution has been
proposed for the standard deviation (√τ ∗) by Gelman (2006). Here for illus-
tration, I deﬁne a gamma distribution:
yi ∼Bin(pi, ni)
logit(pi) = α0 + vi
α0 ∼N(0, τ α0)
vi ∼N(0, τ v)
τ α0 ∼G(ψ1, ψ2)
τ v ∼G(φ1, φ2)

Bayesian Inference and Modeling
33
FIGURE 2.4
The hierarchical model for the binomial example with a logit link to a single
intercept term and an individual level random eﬀect. It is assumed that the
hyperparameters ψ∗and φ∗are ﬁxed and that the total population ni is also
ﬁxed.
The hierarchy for this case would be as displayed in Figure 2.4.
An alternative approach to the Bernoulli or binomial distribution at the
second level of the hierarchy is to assume a distribution directly for the case
probability pi. This might be appropriate when limited information about pi
is available. This is akin to the assumption of a gamma distribution as prior
distribution for the Poisson relative risk parameter. Here one choice for the
prior distribution could be a beta distribution:
pi ∼Beta(α1, α2).
In general, the parameters α1 and α2 could be assigned hyperprior distribu-
tions on the positive real line, such as gamma or exponential. However if a
uniform prior distribution for pi is favored then α1 = α2 = 1 can be chosen.
The hierarchy for this last situation with a Bernoulli model is displayed in
Figure 2.5.

34
Bayesian Disease Mapping
FIGURE 2.5
The hierarchical model for the beta Bernoulli hierarchy with ﬁxed α1, α2
parameters.
2.8
Exercises
1) Derive the posterior distribution for θ where L(y|θ) = m
i=1{(eiθ)yi
exp(−eiθ)} and the prior distribution for θ is Exp(β),where Exp(β) denotes
an exponential distribution with mean β.
2) For the Poisson–gamma distribution in Section 2.4.1 derive the prior
predictive distribution (negative binomial).
3) Show that the posterior predictive distribution is also negative binomial
(hint: use gamma-gamma conjugacy).
4) Observed data is given as counts of birth abnormalities in m small areas:
{yi} i = 1, ..., m. The total births within the same areas are {ni} and are
assumed ﬁxed. The probability of an abnormal birth in the i th area is ψi.
For the following hierarchical model deﬁne the directed acyclic graph (DAG)
assuming that τ α0, τ α1are ﬁxed:
[{yi}|ni, ψi] ∼Bin(ni, ψi)
log it(ψi) = α0 + α1i
α0 ∼N(0, τ α0)
α1i ∼N(0, τ α1),
where N(0, τ) denotes a Gaussian distribution with zero mean and variance
τ.

3
Computational Issues
3.1
Posterior Sampling
Once a posterior distribution has been derived, from the product of likelihood
and prior distributions, it is important to assess how the form of the posterior
distribution is to be evaluated. If single summary measures are needed then it
is sometimes possible to obtain these directly from the posterior distribution
either by direct maximization (mode: maximum a posteriori estimation) or
analytically in simple cases (mean or variance for example)(see Section 2.3).
If a variety of features of the posterior distribution are to be examined then
often it will be important to be able to access the distribution via posterior
sampling. Posterior sampling is a fundamental tool for exploration of posterior
distributions and can provide a wide range of information about their form.
Deﬁne a posterior distribution for data y and parameter vector θ as p(θ|y).
We wish to represent features of this distribution by taking a sample from
p(θ|y). The sample can be used to estimate a variety of posterior quantities
of interest. Deﬁne the sample size as mp. For analytically tractable posterior
distributions may be available to directly simulate the distribution. For ex-
ample the Poisson–gamma model with α, β known, in Section 2.7, leads to
the gamma posterior distribution: θi ∼G(yi + α, ei + β). This can either be
simulated directly (on R: rgamma) or sample estimation can be avoided by
direct computation from known formulas. For example, in this instance, the
moments of a gamma distribution are known: E(θi) = (yi + α)/(ei + β) etc.
Deﬁne the sample values generated as: θ∗
ij, j = 1, ..., mp. As long as
a sample of reasonable size has been taken then it is possible to ap-
proximate the various functionals of the posterior distribution from these
sample values. For example, an estimate of the posterior mean would be
E(θi) = θi =
mp

j=1
θ∗
ij/mp, while the posterior variance could be estimated
as 
var(θi) =
1
mp−1
mp

j=1
(θ∗
ij −θi)2, the sample variance. In general, any real
function of the j th parameter γj = t(θj) can also be estimated in this way.
35

36
Bayesian Disease Mapping
For example, the mean of γj is given by E(γj) = γj =
mp

j=1
t(θ∗
ij)/mp. Note
that credibility intervals can also be found for parameters by estimating the
respective sample quantiles. For example if mp = 1000 then 25th and 975th
largest values would yield an equal tail 95% credible interval for γj. The
median is also available as the 50th percentile of the sample, as are other
percentiles.
The empirical distribution of the sample values can also provide an esti-
mate of the marginal posterior density of θi. Denote this density as π(θi).
A smoothed estimate of this marginal density can be obtained from the his-
togram of sample values of θi. Improved estimators can be obtained by using
conditional distributions. A Monte Carlo estimator of π(θi) is given by
π(θi) = 1
n
n

j=1
π(θi|θj,−i)
where the θj,−i j = 1, ..., n are a sample from the marginal distribution π(θ−i).
Often mp is chosen to be ≥500, more often 1000 or 10, 000. If computation is
not expensive then large samples such as these are easily obtained. The larger
the sample size the closer the posterior sample estimate of the functional will
be.
Generally, the complete sample output from the distribution is used to esti-
mate functionals. This is certainly true in the case when independent sample
values are available (such as when the distribution is analytically tractable
and can be sampled from directly, such as in the Poisson–gamma case). In
other cases, where iterative sampling must be used, it is sometimes necessary
to sub-sample the output sample. In the next section, this is discussed more
fully.
3.2
Markov Chain Monte Carlo Methods
Often in disease mapping, realistic models for maps have two or more levels
and the resulting complexity of the posterior distribution of the parameters
requires the use of sampling algorithms. In addition, the ﬂexible modeling of
disease could require switching between a variety of relatively complex mod-
els. In this case, it is convenient to have an eﬃcient and ﬂexible posterior
sampling method which could be applied across a variety of models. Eﬃcient
algorithms for this purpose were developed within the ﬁelds of physics and
image processing to handle large scale problems in estimation. In the late
1980s and early 1990s these methods were developed further particularly for
dealing with Bayesian posterior sampling for more general classes of problems

Computational Issues
37
(Gilks et al., 1993; Gilks et al., 1996). Now posterior sampling is commonplace
and a variety of packages (including WinBUGS, MlwiN, R) have incorporated
these methods. For general reviews of this area the reader is referred to Cas-
sella and George (1992), Robert and Casella (2005). Markov chain Monte
Carlo (McMC) methods are a set of methods which use iterative simulation
of parameter values within a Markov chain. The convergence of this chain to
a stationary distribution, which is assumed to be the posterior distribution,
must be assessed.
Prior distributions for the p components of θ are deﬁned as gi(θi) for
i = 1, ..., p. The posterior distribution of θ and y is deﬁned as
P(θ|y) ∝L(y|θ)

i
gi(θi).
(3.1)
The aim is to generate a sample from the posterior distribution P(θ|y).
Suppose we can construct a Markov chain with state space θc, where θ ∈θc ⊂
ℜk. The chain is constructed so that the equilibrium distribution is P(θ|y),
and the chain should be easy to simulate from. If the chain is run over a
long period, then it should be possible to reconstruct features of P(θ|y) from
the realized chain values. This forms the basis of the McMC method, and
algorithms are required for the construction of such chains. A selection of
recent literature on this area is found in Ripley (1987), Gelman and Rubin
(1992), Smith and Roberts (1993), Besag and Green (1993), Cressie (1993),
Smith and Gelfand (1992), Tanner (1996), Robert and Casella (2005).
The basic algorithms used for this construction are
1. The Metropolis and its extension Metropolis–Hastings algorithm
2. The Gibbs Sampler algorithm
3.3
Metropolis and Metropolis–Hastings Algorithms
In all McMC algorithms, it is important to be able to construct the correct
transition probabilities for a chain which has P(θ|y) as its equilibrium distri-
bution. A Markov chain consisting of θ1, θ2, ...........θt with state space Θ and
equilibrium distribution P(θ|y) has transitions deﬁned as follows.
Deﬁne q(θ, θ′) as a transition probability function, such that, if θt = θ,
the vector θt drawn from q(θ, θ′) is regarded as a proposed possible value for
θt+1.

38
Bayesian Disease Mapping
3.3.1
Metropolis Updates
In this case choose a symmetric proposal q(θ, θ′) and deﬁne the transition
probability as
p(θ, θ′) =

 α(θ, θ′)q(θ, θ′)
if θ′ ̸= θ
1 −
θ′′ q(θ, θ′′)α(θ, θ′′)
if θ′ = θ.
where α(θ, θ′) = min

1, P (θ′|y)
P (θ|y)

.
In this algorithm a proposal is generated from q(θ, θ′) and is accepted
with probability α(θ, θ′). The acceptance probability is a simple function
of the ratio of posterior distributions as a function of the ratio of posterior
distributions as a function of θ values. The proposal function q(θ, θ′) can be
deﬁned to have a variety of forms but must be an irreducible and aperiodic
transition function. Speciﬁc choices of q(θ, θ′) lead to speciﬁc algorithms.
3.3.2
Metropolis–Hastings Updates
In this extension to the Metropolis algorithm the proposal function is not
conﬁned to symmetry and
α(θ, θ′) = min

1, P(θ′|y)q(θ′, θ)
P(θ|y)q(θ, θ′)

.
Some special cases of chains are found when q(θ, θ′) has special forms. For
example, if q(θ, θ′) = q(θ′, θ) then the original Metropolis method arises and
further, with q(θ, θ′) = q(θ′), (i.e., when no dependence on the previous value
is assumed) then
α(θ, θ′) = min

1, w(θ′)
w(θ)

where w(θ) = P(θ|y)/q(θ) and w(.) are importance weights. One simple ex-
ample of the method is q(θ′) ∼Uniform(θa, θb) and gi(θi) ∼Uniform(θia, θib)
∀i, this leads to an acceptance criterion based on a likelihood ratio. Hence the
original Metropolis algorithm with uniform proposals and prior distributions
leads to a stochastic exploration of a likelihood surface. This, in eﬀect, leads
to the use of prior distributions as proposals. However, in general, when the
gi(θi) are not uniform this leads to ineﬃcient sampling. The deﬁnition of
q(θ, θ′) can be quite general in this algorithm and, in addition, the posterior
distribution only appears within a ratio as a function of θ and θ′. Hence, the
distribution is only required to be known up to proportionality.
3.3.3
Gibbs Updates
The Gibbs Sampler has gained considerable popularity, particularly in appli-
cations in medicine, where hierarchical Bayesian models are commonly applied

Computational Issues
39
(see, e.g., Gilks et al., 1993). This popularity is mirrored in the availability of
software which allows its application in a variety of problems (e.g., WinBUGS,
MLwiN, BACC). This sampler is a special case of the Metropolis–Hastings
algorithm where the proposal is generated from the conditional distribution
of θi given all other θ’s, and the resulting proposal value is accepted with
probability 1.
More formally, deﬁne
q(θj, θ′
j) =

p(θ∗
j|θt−1
−j )
if θ∗
−j = θt−1
−j
0
otherwise
where p(θ∗
j|θt−1
−j ) is the conditional distribution of θj given all other θ values
(θ−j) at time t −1. Using this deﬁnition it is straightforward to show that
q(θ, θ′)
q(θ′, θ) = P(θ′|y)
P(θ|y)
and hence α(θ, θ′) = 1.
3.3.4
M–H versus Gibbs Algorithms
There are advantages and disadvantages to M–H and Gibbs methods. The
Gibbs Sampler provides a single new value for each θ at each iteration, but
requires the evaluation of a conditional distribution. On the other hand the
M–H step does not require evaluation of a conditional distribution but does
not guarantee the acceptance of a new value. In addition, block updates of
parameters are available in M–H, but not usually in Gibbs steps (unless joint
conditional distributions are available). If conditional distributions are diﬃcult
to obtain or computationally expensive, then M–H can be used and is usually
available.
In summary, the Gibbs Sampler may provide faster convergence of the chain
if the computation of the conditional distributions at each iteration are not
time consuming. The M–H step will usually be faster at each iteration, but will
not necessarily guarantee exploration. In straightforward hierarchical models
where conditional distributions are easily obtained and simulated from, then
the Gibbs Sampler is likely to be favoured. In more complex problems, such
as many arising in spatial statistics, resort may be required to the M–H algo-
rithm.
A simple M–H example: Assume that for m regions, the count ni i =
1, ...., m is observed. In addition, the expected count in the i th region, ei is
also observed. Assume also that the counts are independently distributed and
have a Poisson distribution with E(ni) = θ.ei, where θ is a constant param-
eter describing the relative risk over the whole study window. The likelihood
in this case, bar a constant, is given by
L(θ) = exp(−θ
m

i=1
ei).
m

i=1
(θei)ni.
(3.2)

40
Bayesian Disease Mapping
Assuming a ﬂat prior distribution for θ, then the M–H sampler for this prob-
lem reduces to a stochastic exploration of the likelihood surface. Hence the
following sampler criterion is found for the θ parameter in this case:
L(θ′)
L(θ) = exp{se(θ −θ′)}.
θ′
θ
sn
where se =
m

i=1
ei and sn =
m

i=1
ni.
3.3.5
Special Methods
Alternative methods exist for posterior sampling when the basic Gibbs or
M–H updates are not feasible or appropriate. For example, if the range of
the parameters are restricted then slice sampling can be used (Robert and
Casella, 2005, Ch. 7; Neal, 2003). When exact conditional distributions are
not available but the posterior is log-concave then adaptive rejection sampling
algorithms can be used. The most general of these algorithms (ARS algorithm;
Robert and Casella, 2005, 57–59) has wide applicability for continuous dis-
tributions, although may not be eﬃcient for speciﬁc cases. Block updating
can also be used to eﬀect in some situations. When generalized linear model
components are included then block updating of the covariate parameters can
be eﬀected via multivariate updating.
3.3.6
Convergence
McMC methods require the use of diagnostics to assess whether the iterative
simulations have reached the equilibrium distribution of the Markov chain.
Sampled chains require to be run for an initial burn-in period until they
can be assumed to provide approximately correct samples from the posterior
distribution of interest. This burn-in period can vary considerably between
diﬀerent problems. In addition, it is important to ensure that the chain man-
ages to explore the parameter space properly so that the sampler does not
‘stick’ in local maxima of the surface of the distribution. Hence, it is crucial to
ensure that a burn-in period is adequate for the problem considered. Judging
convergence has been the subject of much debate and can still be regarded
as art rather than science: a qualitative judgement has to be made at some
stage as to whether the burn-in period is long enough.
There are a wide variety of methods now available to assess convergence
of chains within McMC. Robert and Casella (2005) and Liu (2001) provide
recent reviews. The available methods are largely based on checking the dis-
tributional properties of samples from the chains. In general deﬁne an output
stream for a parameter vector θ as

θ1, θ2, ....θm, θm+1....θm+mp
. Here the
m th value is the end of the burn-in period and a (converged) sample of size mp
is taken. Hence the converged sample is

θm+1....θm+mp
. Deﬁne a function
of the output stream as γ = t(θ) so that γ1 = t(θ1).

Computational Issues
41
3.3.6.1
Single chain methods
First, global methods for assessing convergence have been proposed which
involve monitoring functions of the posterior output at each iteration. Glob-
ally this output could be the log posterior value (log p(θ|y) where θ are
the estimated parameters at a given iteration), or the deviance of the model
(−2[l(y|θ)−l(y|θref)] where θref is a saturated or other reference model esti-
mate). (In WinBUGS the deviance is assumed to be −2l(y|θ)). These methods
look for stabilization of the probability value. This value forms a time series,
and special cusum methods have been proposed (Yu and Mykland (1998)).
This approach emphasizes the overall convergence of the chain rather than in-
dividual parameter convergence. Two basic statistical tools that can be used
to check sequences of output, have been proposed by Geweke (1992) and Yu
and Mykland (1998). For the Geweke statistic, the sequence of output is bro-
ken up into two segments following a burn-in of m length. The ﬁrst and last
segments of length nb and na respectively are deﬁned. Averages of the ﬁrst
and last segments of output are obtained:
γb = 1
nb
m+nb

j=m+1
γj
γa = 1
na
m+mp

j=m+mp−na+1
γj.
As mp gets large then the statistic
G =
γa −γb


var(γa) + 
var(γb)
→N(0, 1) in distribution,
where 
var(γa), 
var(γb) are empirical variance estimates. Usually it is assumed
that nb = 0.1n and na = 0.5n. Note that we can set γj = −2l(y|θj) or γj =
log p(θj|y)and so the deviance or log posterior can be monitored as an overall
measure. This test is available on R in the CODA package (geweke.diag). The
second test for single sequences was proposed by Yu and Mykland (1998) and
later modiﬁed by Brooks (1998). For a post-convergence sequence of length
mp an average is computed
μ =
1
mp
m+mp

j=m+1
γj.
This average is used within a cusum calculation by deﬁning a cusum of the
sequence:
St =
t

j=m+1
[γj −μ]
for t = m + 1, .., m + mp.

42
Bayesian Disease Mapping
FIGURE 3.1
Cusum plot of St against t for 1000 length converged sample of Gamma(1, 1)
posterior output.
In the original proposal, a plot of St against t was proposed. The interpre-
tation of the plot relies on the identiﬁcation of the hairiness or spikeyness
of the cusum: a smooth cusum suggesting under-exploration of the posterior
distribution, while a spikey plot represents rapid mixing. Figure 3.1 displays
this plot for a 1000 length output sample from a Gamma(1,1) posterior distri-
bution. Brooks (1998) further quantiﬁed this approach by deriving a statistic
that measures the spikeyness of St.
Deﬁne
di =
⎧
⎨
⎩
1
if
Si−1 > Si and Si < Si+1
or Si−1 < Si and Si > Si+1,
0
else
for all i = m + 1, ....., m + mp −1. Further deﬁne
Dt =
1
t −m −1
t−1

i=m+1
di
m + 2 ≤t ≤m + mp.
This statistic can be used in a number of ways. For an i.i.d sequence symmetric
about the mean then the expected value of di would be 1/2. Further, Dt can
be treated as a binomial variate with E(Dt) = 1/2 and var(Dt) =
1
4(t−m−1)
and Dt will be approximately Gaussian with 100(1 −α/2)% bounds
1
2 ± Zα/2

1
4(t −m −1).
These bounds can be used as a formal tool to detect convergence. Figure 3.2
displays an example of this form of plot for the gamma output sample. This

Computational Issues
43
FIGURE 3.2
Plot of Dt for a single sample of 1000 from the Gamma(1, 1) posterior sample
after a burn-in of 10000. The dotted lines are the asymptotic upper and lower
binomial bounds.
sample deviates from the bounds somewhat and of course some assumptions
about this diagnostic could be violated by output from a sampler (if it is
asymmetric or approaches symmetry and independence slowly). Note that for
“sticky” samplers, where values may stay for long periods (such as is possi-
ble with Metropolis–Hastings samplers), then the di can be modiﬁed to allow
for such static behavior (see e.g., Brooks, 1998 for details and Section 3.3.7.1
below).
Second, graphical methods have been proposed which allow the comparison
of the whole distribution of successive samples. Quantile-quantile plots of
successive lengths of single variable output from the sampler can be used
for this purpose. Figure 3.3 displays an example of such a plot. On R, with
vectors out1 and out2 this can be created via commands:
>plot(sort(out1),sort(out2),xlab=”output stream 1”,ylab=”output stream 2”)
>lines(x,y)
> cor(sort(out1),sort(out2))
Further assessment of the degree of equality can be made via use of a corre-
lation test. The Pearson correlation coeﬃcient between the sorted sequences
can be examined and compared to special tables of critical values. This adds
some formality to the relatively arbitrary nature of visual inspection.

44
Bayesian Disease Mapping
FIGURE 3.3
Quantile-quantile plot of two sequences of 1000 length of converged sample
output from a gamma posterior distribution with parameters α = 1, β = 1.
Th equality line is marked.
3.3.6.2
Multi-chain methods
Single chain methods can, of course, be applied to each of a multiple of chains.
In addition, there are methods that can only be used for multiple chains.
The Gelman-Rubin statistic was proposed as a method for assessing the con-
vergence of multiple chains via the comparison of summary measures across
chains (Gelman and Rubin, 1992; Brooks and Gelman, 1998; Robert and
Casella, 2005, Ch. 8).
This statistic is based on between and within chain variances. For the uni-
variate case we have p chains and a sample of size n and a sample value of
γj
i
j = 1, ..., n; i = 1, ..., p. Denote the average over the sample for the i th
chain as γi = 1
n
n
j=1 γj
i and the overall average as γ. = 1
p
p
i=1 γi and the
variance of the i th chain is τ 2
i =
1
n−1
n
j=1(γj
i −γi)2. Then the between- and
within-sequence variances are
B =
n
p −1
p

i=1
(γi −γ.)2
W = 1
p
p

i=1
τ 2
i .
The marginal posterior variance of the γ is estimated as n−1
n W + 1
nB and this
is unbiased asymptotically( n →∞). Monitoring the statistic
R =

n −1
n
+ 1
n
B
W

Computational Issues
45
for convergence to 1 is recommended. If the R for all parameters and functions
of parameters is between 1.0 and 1.1 (Gelman et al., 2004) this is acceptable
for most studies. Note that this depends on the sample size taken and closeness
will be more easily achieved for large mp. Brooks and Gelman (1998) extended
this diagnostic to a multiparameter situation. On R the statistic is available in
the CODA package as gelman.diag. On WinBUGS the Brooks–Gelman–Rubin
(BGR) statistic is available in the Sample Monitor Tool. On WinBUGS, the
width of the central 80% interval of the pooled runs and the average width
of the 80% intervals within the individual runs are color-coded (green, blue),
and their ratio R is red—for plotting purposes the pooled and within interval
widths are normalized to have an overall maximum of one. On WinBUGS the
statistics are calculated in bins of length 50. R would generally be expected to
be greater than 1 if the starting values are suitably over-dispersed. Brooks and
Gelman (1998) emphasize that one should be concerned both with convergence
of R to 1, and with convergence of both the pooled and within interval widths
to stability. One caveat should be mentioned concerning the use of between
and within chain diagnostics. If the posterior distribution being approximated
were to be highly multimodal, which could be the case in many mixture and
spatial problems then the variability across chains could be large even when
close to the posterior distribution and it could be that very large bins would
need to be used for computation.
There is some debate about whether it is useful to run one long chain
as opposed to multiple chains with diﬀerent start points. The advantage of
multiple chains is that they provide evidence for the robustness of convergence
across diﬀerent subspaces. However, as long as a single chain samples the
parameter space adequately, then these have beneﬁts. The reader is referred to
Robert and Casella (2005), Chapter 8 for a thorough discussion of diagnostics
and their use.
3.3.7
Subsampling and Thinning
McMC samplers often produce correlated samples of parameters. That is, a
parameter value γj
i is likely to be similar to γj−1
i
. This is likely to be true if
successful proposals are based on proposal distributions with small variances,
or where acceptances are localized to small areas of the posterior surface. In
the former case, it may be that only small subsections of the posterior surface
are being explored and so the sampler will not reach equilibrium for some
time. Hence there may be an issue of lack of convergence when this occurs. The
latter case could arise when a very spikey likelihood dominates. In themselves
these correlated samples do not create problems for subsequent use of output
streams, unless the sample size is very small (mp small), or convergence has not
been reached. Summary statistics could be aﬀected by such autocorrelation.
While measures of central tendency may not be much aﬀected, the variance
and other spread measures could be downward biased due to the (positive)
autocorrelation in the stream. One possible remedy for this correlation is to

46
Bayesian Disease Mapping
take subsamples of the output. The simplest approach to this is to thin the
stream by taking systematic samples at every k th iteration. By lengthening
the gap between sampled units, then the more likely the correlation will be
reduced or eliminated.
3.3.7.1
Monitoring Metropolis-like samplers
Samplers that don’t necessarily accept a new value at each iteration cannot
be monitored as easily as those that do produce new values (such as the Gibbs
Sampler). With, for example, a Metropolis–Hastings algorithm the acceptance
rate of new proposals is an important measure of the performance of the algo-
rithm. The acceptance rate is deﬁned as the number of iterations where new
values are accepted out of a batch of iterations. Let’s assume we have a batch
size of nl = 100 iterations and during that period we observe ml accepted
proposals. We assume that the number of parameters is small (p << nl) so
that there are potentially many transitions that could be made within nl. The
acceptance rate is just Ar = ml
nl . This rate could be a useful indicator of the
behavior of the sampler. For example if the sampler is not mixing well then
it may stick in various places failing to ﬁnd acceptable proposals. This would
lead to a low acceptance rate. However, on the other hand, a high accep-
tance rate may signify good proposals but could also mean that the sampler
is “stuck” in the vicinity of a peak in the posterior surface and not searching
the space in general. In both cases, the proposals may either be too small or
too large to adequately search the space. Usually as a guide to a reasonable
acceptance rate, for a M–H algorithm with small dimension (1 to 2 param-
eters) then Ar ≈0.5 would be reasonable (Robert and Casella, 2005). For
higher dimensions (p > 2) then Ar ≈0.25 is reasonable. Hence for reversible
jump algorithms (which are based on M–H steps with high dimension) then
Ar ≈0.25 might be expected. For Metropolis–Langevin or Langevin–Hastings
algorithms (such as used in the R package geoRglm) that incorporate gradient
terms then higher rates are optimal (Ar ≈0.6). It should be borne in mind
that in itself achievement of an optimal Ar does not necessarily imply con-
vergence to a stationary distribution, although poor Ar could be due to lack
of mixing and hence lack of convergence. It is also possible for chains to have
high acceptance and very low convergence (Gamerman and Lopes, 2006). On
WinBUGS when a Metropolis update is used then the acceptance rate can be
set using the Monitor Met button in the Model Menu. This generates a plot
of the acceptance rate over iteration for batches of nl =100 iterations. For
user deﬁned likelihood models using the zeroes or ones trick then Ar is always
available.

Computational Issues
47
The Dt statistic of Brooks (1998) can be modiﬁed for application to M–H
algorithms where extended periods of “stickiness” arise:
di =
⎧
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎨
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎩
1
if Si−1 > Si and Si < Si+1
or Si−1 < Si and Si > Si+1
or Si−1 < Si, Si+k < Si and
Si = Si+1 = ..... = Si+k,
or Si−1 > Si , Si+k > Si and
Si = Si+1 = ..... = Si+k
1
2
if Si−1 = Si = Si+1
0
else
for all i = m + 1, ....., m + n −1.
In addition, for complex reversible jump samplers there may be need for
forms of stratiﬁed convergence checking. For example, the dimension of the
parameter set may lead to stratifying the number of parameters and this
can lead to χ2 tests and Kolmogorov-Smirnov statistics comparing a number
of chains by their cumulative distribution functions (Brooks et al., 2003).
Monitoring of dimension-changing algorithms is still a controversial issue.
3.4
Perfect Sampling
The idea of McMC is that simulation from a posterior distribution can be
achieved over time and iterations are followed until convergence to the equi-
librium is found. Propp and Wilson (1996) proposed a diﬀerent approach
whereby instead of iteration toward this equilibrium, a search is made to
ﬁnd a path from the past which will lead to coalescence at the current time.
In essence a stopping time for the chain is found which corresponds to the
equilibrium distribution. This is known as coupling from the past (CFTP). Ex-
amples of the application of such exact sampling have been made to point pro-
cesses and Ising models (van Lieshout and Baddeley, 2002; M´oller and Waag-
petersen, 2004), case event data cluster modeling (McKeague and Loiseaux,
2002) where special McMC (reversible jump birth-death sampling) must be
used, and to autologistic models for spatial and space-time data (Besag and
Tantrum, 2003).
However, CFTP is not guaranteed to work for McMC transitional kernels
that are not uniformly ergodic (Robert and Casella, 2005). However, perfect
slice sampling may help toward a general algorithm that has general appeal
(Mira et al., 2001).
Currently, the main problem with perfect sampling is that it is not possible
to provide a general algorithm from which modeling of particular situations
is immediately available. In fact, for most applications, the algorithm has to
be specially designed and it is often therefore relatively diﬃcult to adapt to

48
Bayesian Disease Mapping
changes of model form: for example, inclusion or exclusion of covariates may
not be possible without signiﬁcant alteration to the algorithm.
3.5
Posterior and Likelihood Approximations
From the point of view of computation it is now straightforward to examine
a range of posterior distributional forms. This is certainly true for most ap-
plications of disease mapping where relative risk is estimated. However there
are situations where it may be easier or more convenient to use a form of
approximation to the posterior distribution or to the likelihood itself. Some
approximations have been derived originally when posterior sampling was not
possible and where the only way to obtain fully Bayesian estimates was to ap-
proximate (Bernardo and Smith, 1994). However other approximations arise
due to the intractability of spatial integrals (for example in point process
models).
3.5.1
Pseudolikelihood and Other Forms
In Section 2.1.1.3 I brieﬂy introduced the idea of pseudolikelihood. I extend
this idea here. In certain spatial problems, found in imaging and elsewhere,
normalizing constants arise that are highly multidimensional. A simple exam-
ple is the case of a Markov point process. Deﬁne the realization of m events
within a window T as {s1,......sm}. Under a Markov process assumption the
normalized probability density of a realization is
fθ(s) =
1
c(θ)hθ(s)
where c(θ) =
∞

k=0
1
k!

T k hθ(s)λk(ds).
Conditioning on the number of events (m), then the normalization of fm(s) ∝
hm(s) then the normalization is over the m-dimensional window:
c(θ) =

T
.....

T
hm({s1,......sm})ds1,......dsm.
For a conditional Strauss process then fm(s) ∝γnR(s)and nR(s) is the number
of R-close pairs of points to s.
It is also true that a range of lattice models developed for image processing
applications also have awkward normalization constants (auto-Poisson and
autologistic models and Gaussian Markov random ﬁeld models Besag and
Tantrum, 2003; Rue and Held, 2005).

Computational Issues
49
This has led to the use of approximate likelihood models in many cases.
For example, for Markov point processes it is possible to specify a con-
ditional intensity (Papangelou) which is independent of the normalization.
This conditional intensity
λ∗(ξ, s|θ) = h(ξ ∪s)/h(ξ) can be used within a
pseudo-likelihood function. In the case of the above Strauss process this is
just λ∗(ξ, s|θ) = λ∗(s|θ) = γnR(s) and the pseudolikelihood is:
Lp({s1,......sm}|θ) =
m

i=1
λ∗(si|θ) exp(−

T
λ∗(u|θ)du).
As this likelihood has the form of an inhomogeneous Poisson process likeli-
hood, then this is relatively straightforward to evaluate. The only issue is the
integral of the intensity over the window T . This can be handled via special nu-
merical integration schemes (Berman and Turner, 1992; Lawson 1992a, 1992b;
and Section 5.1.1). Bayesian extensions are generally straightforward. Note
that once a likelihood contribution can be speciﬁed then this can be incor-
porated within a posterior sampling algorithm such as Metropolis–Hastings.
This can be implemented on WinBUGS via a zeroes trick if the Berman-
Turner weighting is used. For example the model with the i th likelihood
component: li = log λ∗(si|θ) −wiλ∗(si|θ) can be ﬁtted using this method,
where the weight wi is based on the Dirichlet tile area of the i th point or
a function of the Delauney triangulation around the point (see Berman and
Turner, 1992, Baddeley and Turner, 2000, and Appendix C.5.3 of Lawson,
2006b).
In application to lattice models Besag and Tantrum (2003) give the ex-
ample of a Markov random ﬁeld of m dimension where the pseudolikelihood
Lp =
m

i=1
p(y0
i |y0
−i; θ) is the product of the full conditional distributions. In
the (auto)logistic binary case
p(y0
i |y0
−i; θ) =
exp(f(α0, {y0
−i}∈∂i, θ)
1 + exp(f(α0, {y0
−i}∈∂i, θ)
where ∂i denotes the adjacency set of the i th site.
Other variants of these likelihoods have been proposed. Local likelihood
(Tibshirani and Hastie, 1987) is a variant where a contribution to likelihood
is deﬁned within a local domain of the parameter space. In spatial problems
this could be a spatial area. This has been used in a Bayesian disease mapping
setting by Hossain and Lawson, 2005. Pairwise likelihood (Nott and Ryd´en,
1999; Heagerty and Lele, 1998) has been proposed for image restoration and
for general spatial mixed models (Varin et al., 2005). All these variants of
full likelihoods will lead to models that are approximately valid for real appli-
cations. It should be borne in mind however that they ignore aspects of the
spatial correlation and if these are not absorbed in some part of the model
hierarchy then this may aﬀect the appropriateness of the model.

50
Bayesian Disease Mapping
3.5.2
Asymptotic Approximations
It is possible to approximate a posterior distribution with a simpler distribu-
tion which is found asymptotically. The use of approximations lies in their of-
ten common form and also the ease with which parameters may be estimated
under the approximation. Often the asymptotic approximating distribution
will be a normal distribution. Here two possible approaches are examined:
the asymptotic quadratic form approximation and integral approximation via
Laplace’s method.
3.5.2.1
Asymptotic Quadratic Form
Large sample convergence in form of the likelihood or posterior distribution is
considered here. In many cases the limiting form of a likelihood or posterior
distribution in large samples can be used as an approximation. The Taylor
series expansion of the function f(.) around vector a is
f(a) + U(a)T (x −a) + 1
2(x −a)T H(a)(x −a). + R.
where U(a) is the score vector evaluated at a, R is a remainder, and H(a) is the
Hessian matrix of second derivatives of f(.) evaluated at a. For an arbitrary
log likelihood with p length vector of parameters θ, then an expansion around
a point is required. Usually the mode of the distribution is chosen. Deﬁne the
modal vector as θm and l(y|θ) ≡l(θ) for brevity. The expansion is deﬁned
as:
l(θ) = l(y|θm) + U(θm)(θ −θm) −1
2(θ −θm)T H(θm)(θ −θm).
Here U(θm) = 0 as we have expanded around the maxima and so this reduces
to
l(θ) = l(y|θm) −1
2(θ −θm)T H(θm)(θ −θm).
(3.3)
Note that H(θm) describes the local curvature of the likelihood at the maxima
and is deﬁned by
H(θm) =

−∂2l(θ)
∂θi∂θj

θ=θm .
This approximation, given θm, consists of a constant and a quadratic form
around the maxima. In a likelihood analysis the θm might be replaced by
maximum likelihood estimates θ
m.
For a posterior distribution, it is possible to also approximate the prior dis-
tribution with a Taylor expansion. In which case a full posterior approximation
would be obtained. Assume a joint prior distribution, deﬁned by p(θ|Γ) where
Γ is a parameter vector or matrix. Assuming that Γ is ﬁxed, then the approx-

Computational Issues
51
imation around the modal vector θp, again assuming the score vector is zero
at the maxima, is given by
log p(θ|Γ) = log p(θp|Γ)−1
2(θ −θp)T Hp(θp)(θ −θp) + R0
where, R0 is the remainder term and
Hp(θp) =

−∂2 log p(θ|Γ)
∂θi∂θj

θ=θp .
Again given θp, this is simply a quadratic form around the maxima. There
are then two posterior approximations that might be considered:
i) Likelihood approximation only:
p(θ|y) ∝p(θ|Γ) exp

−1
2(θ −θm)T H(θm)(θ −θm)

or
ii) full posterior approximation:
p(θ|y) ∝exp

−1
2(θ −θp)T Hp(θp)(θ −θp) −1
2(θ −θm)T H(θm)(θ −θm)

∝exp

−1
2(θ −mn)T Hn(θ −mn)

where Hn = Hp(θp) + H(θm) and mn = H−1
n (Hp(θp)θp + H(θm)θm). Note
that H(θm) is the observed information matrix. As the sample size increases
this quadratic form approximation improves in its accuracy and two important
results follow:
i) the posterior distribution tends toward a normal distribution, i.e.,
as m →∞then p(θ|y) →Np(θ|mn, Hn)
ii) the information matrix tends toward the Fisher (expected) information
matrix in the sense that H(θm) →mI(θm) where the ijth element is
I(θ)ij =

p(y|θ)

−∂2l(θ)
∂θi∂θj

dy.
This means that it is possible to consider further asymptotic distributional
forms. For instance if the variability in the prior distribution is negligible
compared to the likelihood then
p(θ|y) →Np(θ|θm, H(θm))
or
p(θ|y) →Np(θ|θm, mI(θm)).

52
Bayesian Disease Mapping
Often the maximum likelihood (ML) estimates would be substituted for θm.
If θm are given or estimated via ML the posterior distribution will be multi-
variate normal in large samples.
Hence a normal approximation to the posterior distribution is justiﬁed at
least asymptotically (as m →∞). This approximation should be reasonably
good for continuous likelihood models and may be reasonable for discrete
models when the rate parameter (Poisson) is large or the binomial probabil-
ity is not close to 0 or 1. Of course this is likely not to hold when there is
sparseness in the count data, as can arise when rare diseases
are studied.
Further discussion of diﬀerent asymptotic results can be found in Bernardo
and Smith (1994).
An example of such a likelihood approximation would be where a bi-
nomial likelihood has been assumed and yi|pi ∼Bin(pi, ni) with pi ∼
Beta(2, 2). In this case, assume p(θ|y)
∼
Np(θ|mn, Hn) and mn
=
bpi(1−b
pi)
ni

ni
bpi(1−b
pi) pi

= pi, Hn = 0 +
ni
bpi(1−b
pi) where pi = yi
ni and so the dis-
tribution is Nm(pi|pi, diag{
ni
bpi(1−b
pi)}). Hence the approximate distribution is
centered around the saturated maximum likelihood estimator. In this case the
prior distribution has little eﬀect on the mean or the variance of the resulting
Gaussian distribution. If, on the other hand, an asymmetric prior distribution
favouring low rates of disease were assumed such as pi ∼Beta(1.5, 5), then the
approximation is given by mn = (Hp(θp) +
ni
bpi(1−b
pi))−1 [Hp(θp)θp +
ni b
pi
bpi(1−b
pi)]
and Hn = Hp(θp) +
ni
bpi(1−b
pi) where Hp(θp) = 81.383 and θp = 0.11. Here the
mean and variance are inﬂuenced considerably.
Note that it is also possible to approximate posterior distributions with
mixtures of normal distributions and this could lead to closer approximation
to complex (multi-modal) distributions. Hierarchies with more than 2 levels
have not been discussed here. However in principle, if a normal approximation
can be made to each prior in turn (perhaps via mixtures of normals) then a
quadratic form would result with a more complex form.
3.5.2.2
Laplace integral approximation
In some situations ratios of integrals must be evaluated and it is possible
to employ an integral approximation method suggested by Laplace (Tierney
and Kadane, 1986). For example the posterior expectation of a real valued
function g(θ) is given by
E(g(θ)|y) =

g(θ)p(θ|y)dθ.
This can be considered as a ratio of integrals, given the normalization of the
posterior distribution. The approximation is given by
E(g(θ)|y) ≈
σ∗
σ

exp{−m[h∗(θ∗) −h(θ)]}

Computational Issues
53
where −mh(θ) = log p(θ)+l(y|θ) and −mh∗(θ) = log g(θ) + logp(θ)+l(y|θ)
and
−h(θ) = max
θ {−h(θ)}, −h∗(θ∗) = max
θ {−h∗(θ)},
σ = |m∇2h(θ)|−1/2 and σ = |m∇2h∗(θ∗)|−1/2 where
[∇2h(θ)]ij = ∂2h(θ)
∂θi∂θj

θ=bθ
.
3.6
Exercises
1) Assume a generalized linear model with Poisson likelihood: [yi|θi] ∼
Poiss(eiθi) with log link to linear predictor log θi = ηi = x′
iβ where x′
i
is a row covariate vector of p length and β is a p length parameter vector.
The parameter vector is assumed to have a Gaussian prior distribution with 0
mean vector and the parameters are assumed independent hence β ∼Np(0, Γ)
where Γ = diag{τ1....., τ p}. Show that a normal approximation to the pos-
terior distribution of this model, given the maximum likelihood estimates
β, is given by Np(θ|mn, Hn) where Hn = Hp(θp) + H(θm) and mn =
H−1
n
[Hp(θp)θp + H(θm)θm] and θp = 0, Hp(θp) = diag{τ−1/2
β1
....τ −1/2
βp
}
where σβ∗is the standard deviation in the Gaussian prior distribution for
β∗
H(θm)jk =
m

i=1
[Ajk + Bjk]
where
Ajk = yixjixki
ηi(ln ηi)2 , Bjk = eixjixki exp{ηi}
and ηi = x′
iβ.


4
Residuals and Goodness-of-Fit
Attainment of convergence of McMC algorithms does not necessarily yield
good models. If a model is misspeciﬁed then it will be of limited use. There
are many issues relating to model goodness-of-ﬁt that should be of concern
when evaluating models for geo-referenced disease data. In this section, I treat
general issues related to the use of goodness-of-ﬁt (GOF) measures, residual
diagnostics and the use of posterior output to yield risk exceedence probabil-
ities.
4.1
Model GOF Measures
Goodness-of-ﬁt criteria vary depending on the properties of the criteria and
the nature of the model. In conventional generalized linear modeling with
ﬁxed eﬀects, the deviance is an important measure (McCullagh and Nelder,
1989). Usually this measure of model adequacy compares a ﬁtted model to a
saturated model. It is based on the diﬀerence between the log likelihood of
the data under either model:
D = −2[l(y|θfit) −l(y|θsat)].
The saturated model has a single parameter per observation. Often a rela-
tive measure of ﬁt is used so that deviances are compared and the change in
deviance between model 1 and model 2 is used:
ΔD = −2[l(y|θ1) −l(y|θ2)].
Hence the saturated likelihood cancels in this relative comparison. The de-
viance is used in goodness-of-ﬁt measures in Bayesian modeling, but usually
without reference to a saturated model.
One disadvantage of using the deviance directly is that it does not allow
for the degree of parameterization in the model: a model can be made to
more closely approximate data by increasing the number of parameters. Hence
attempts have been made to penalize model complexity. One example of this
is the Akaike information criterion (AIC). This is deﬁned as
AIC = −2l(y|θfit) + 2p
55

56
Bayesian Disease Mapping
where p is the number of parameters. The second term acts as a penalty for
over parameterization of the model. The idea being that as more parameters
are added then the closer the model will approximate the data. To balance
this, the penalty (2p) is assumed. Hence the ﬁt is penalized with a linear
function of number of parameters. Model parsimony should result in the use
of such a penalized form. This is widely used for ﬁxed eﬀect models and is the
basis of the deviance information criterion discussed below.
Another variant that is commonly used as a model choice criterion is the
Bayesian information criterion (BIC). This is widely used in Bayesian and hi-
erarchical models. It asymptotically approximates a Bayes factor. It is deﬁned
as
−2l(y|θfit) + p ln m.
In a model with log-likelihood l(θ) the AIC or BIC value can be estimated
from the output of an McMC algorithm by
AIC = −2ˆl(θ) + 2p
BIC = −2ˆl(θ) + p ln m,
where p is the number of parameters, m is the number of data points and
ˆl(θ) = 1
G
G

g=1
l(y|θg),
the averaged log-likelihood over G posterior samples of θ. Alternatively a
posterior estimate of θ (such as posterior expectation) must be ﬁrst computed
and then substituted into the AIC or BIC. Leonard and Hsu (1999) provide
comparisons of these measures in a variety of examples. One disadvantage
of the AIC or BIC is that in models with random eﬀects, it is diﬃcult to
decide how many parameters are included within the model. For example,
a unit level eﬀect could be speciﬁed as vi ∼N(0, τ). In this case there is
one variance parameter, but there is also a separate value of v for each item.
Hence, we have potentially super-saturation of the parameter space (p > m)
if we count the m vis as well as τ. Should the parameterization be 1 or m+1 or
somewhere between these values? This quandary does not arise with random
coeﬃcient models where, for example, in a regression context we may have
a p length vector of parameters, β say, who may have in the simplest case p
variances.
4.1.1
Deviance Information Criterion
The Deviance information criterion (DIC)
(Spiegelhalter et al., 2002) has
been proposed by Spiegelhalter et al. (2002) and is widely used in Bayesian
modeling. This is deﬁned as
DIC = 2Eθ|y(D) −D[Eθ|y(θ)],

Residuals and Goodness-of-Fit
57
where D(.) is the deviance of the model and y is the observed data. Note
that the DIC is based on a comparison of the average deviance (D =
−2 G
g=1 l(y|θg)/G) and the deviance of the posterior expected parameter
estimates, θ say: ( D(θ) = −2l(y|θ)). For any sample parameter value θg the
deviance is just D(θg) = −2l(y|θg). The eﬀective number of parameters (pD)
is estimated as  
pD = D −D(θ) and then DIC = D +  
pD = 2D −D(θ).
Unfortunately in some situations the  
pD can be negative (as it can happen
that D(θ) > D). Instability in pD can lead to problems in the use of this DIC.
For example, mixture models, or more simply, models with multiple modes
can ‘trick’ the pD estimate because the overdispersion in such models (when
the components are not correctly estimated) leads to D(θ) > D. However
it is also true that inappropriate choice of hyper-parameters for variances of
parameters in hierarchical models can lead to inﬂation also, as can nonlinear
transformations (such as changing from a Gaussian model to a log normal
model). In such cases it is sometimes safer to compute the eﬀective number of
parameters from the posterior variance of the deviance. Gelman et al. (2004,
182) propose the estimator !
pD = 1
2
1
G−1
G

g=1
( D(θg) −D)2. This value can also
be computed from sample output from a chain. (It is also available directly
in R2WinBUGS.) An alternative estimator of the variance is direct available
from output 
var(D) =
1
G−1
G

g=1
( D(θg) −D)2 = 2 !
pD. Hence a DIC based on
this last variance estimate is just DIC = D + 
var(D). Note that the expected
predictive deviance (EPD: Dpr) is an alternative measure of model adequacy
and it is based on the out-of-sample predictive ability of the ﬁtted model. The
quantity can also be approximately estimated as Dpr = 2D −D(θ).
4.1.2
Posterior Predictive Loss
Gelfand and Ghosh (1998) proposed a loss function based approach to model
adequacy which employs the predictive distribution. The approach essentially
compares the observed data to predicted data from the ﬁtted model. Deﬁne
the i th predictive data item as ypr
i . Note that the predictive data can easily
be obtained from a converged posterior sample. Given the current parameters
at iteration j : θ(j) say, then
p(ypr
i |y) =

p(ypr
i |θ(j))p(θ(j)|y)dθ(j).
Hence the j th iteration can yield ypr
ij from p(ypr
i |θ(j)). The resulting predictive
values has marginal distribution p(ypr
i |y). For a Poisson distribution, this
simply requires generation of counts as ypr
ij ←Pois(eiθ(j)
i ).

58
Bayesian Disease Mapping
A loss function is assumed where L0(y, ypr) = f(y, ypr). A convenient choice
of loss could be the squared error loss whereby we deﬁne the loss as:
L0(y, ypr) = (y −ypr)2.
Alternative loss functions could be proposed such as absolute error loss
or more complex (Quantile) forms. An overall crude measure of loss across
the data is aﬀorded by the average loss across all items: the mean squared
predictive error (MSPE) is simply an average of the item-wise squared error
loss:
MSPEj =

i
(yi −ypr
ij )2/m
and
MSPE =

i

j
(yi −ypr
ij )2/(G × m),
where m is the number of observations and G is the sampler sample size. An
alternative could be to specify an absolute error:
MAPEj =

i
|yi −ypr
ij |/m
and
MAPE =

i

j
|yi −ypr
ij |/(G × m).
Gelfand and Ghosh (1998) proposed a more sophisticated form:
Dk =
k
k + 1A + B
=
k
k + 1
m

i=1
(yi −ypr
i )2 + 1
mp
m

i=1
mp

j=1
(ypr
ij −ypr
i )2
where ypr
i
=
mp

j=1
ypr
ij /mp
and mp is the prediction sample size (usually G = mp). Here, the k can be
chosen to weight the diﬀerent components. For k = ∞, then Dk = A+B. The
choice of k does not usually aﬀect the ordering of model ﬁt. Each component
measures a diﬀerent feature of the ﬁt: A represents lack of ﬁt and B degree
of smoothness. The model with lowest Dk (or MSPE or MAPE) would be
preferred.
Note that predictive data can be easily obtained from model fomulas in
WinBUGS: in the Poisson case with observed data y[] and predicted data
ypred[], we have for the i th item:
y[i]˜dpois(mu[i])
ypred[i]˜dpois(mu[i])

Residuals and Goodness-of-Fit
59
As the predicted values are missing they would have to be initialized.
In addition, it is possible to consider prediction-based measures as conver-
gence diagnostics. The measures D(θ(j)) or MSPEj could be monitored using
the single or multi-chain diagnostics discussed above (Section 3.3.6). Note that
for any model for which a unit likelihood contribution is available, it is pos-
sible to compute a deviance-based measure such as D(θ(j)). Hence for point
process (case event), as well as count-based likelihoods, deviance measures are
available whereas a residual based measure (such as MSPE) is more diﬃcult
to deﬁne for a spatial event domain.
4.2
General Residuals
The analysis of residuals and summary functions of residuals forms a funda-
mental part of the assessment of model goodness of ﬁt in any area of statisti-
cal application. In the case of disease mapping there is no exception, although
full residual analysis is seldom presented in published work in the area. Often
goodness-of-ﬁt measures are aggregate functions of piecewise residuals, while
measures relating to individual residuals are also available. A variety of meth-
ods are available when full residual analysis is to be undertaken. We deﬁne a
piecewise residual as the standardized diﬀerence between the observed value
and the ﬁtted model value. Usually the standardization will be based on a
measure of the variability of the diﬀerence between the two values.
It is common practice to specify a residual as
ri = yi −yi
(4.1)
or
rs
i = ri/

 
var(ri)
where yi is a ﬁtted value under a given model. When complex spatial models
are considered, it is often easier to examine residuals, such as {ri} using Monte
Carlo methods. In fact it is straightforward to implement a parametric boot-
strap (PB) approach to residual diagnostics for likelihood models (Davison
and Hinkley, 1997). The simplest case, is that of tract count data, where for
each tract an observed count can be compared to a ﬁtted count. In general,
when Poisson likelihood models are assumed with yi ∼Pois{ei.θi} then it
is straightforward to employ a PB by generating a set of simulated counts
{y∗
ij} j = 1, ...., J, from a Poisson distribution with mean ei.θi. In this way, a
tract-wise ranking, and hence p-value, can be computed by assessing the rank
of the residual within the pooled set of J + 1 residuals:
{yi −ei.θi;{y∗
ij −ei.θi},j = 1, ..., J}.

60
Bayesian Disease Mapping
Denote the observed standardized residual as rs
i , and the simulated as rs
ij.
Note that it is now possible to compare functions of the residuals as well
as making direct comparisons. For example, in a spatial context, it may be
appropriate to examine the spatial autocorrelation of the observed residuals.
This may provide evidence of lack of model ﬁt. Hence, a Monte Carlo as-
sessment of degree of residual autocorrelation could be made by comparing
Moran’s I statistic for the observed residuals, say, M({rs
i }), to that found
for the simulated count residuals M({rs
ij}), where M({u}) =
uT Wu
uT u
where
ui = ri/

var(ri) and ri = (yi −ei.θi) and W is an adjacency matrix. Note
that E[M({u})] may not be zero and so it would be important to allow for
this fact in any assessment of residual autocorrelation (see Section 5.6.1).
In the above discussion the residual deﬁnition relies on an observed de-
pendent variable (usually a count or other discrete outcome) and a model-
based ﬁtted variable value. In the situation where case event data is mod-
eled via point process models then the domain of interest is spatial and it
is more problematic to deﬁne a residual. Note that this does not apply to
conditional logistic models for case event data, as a binary outcome is mod-
eled (see Section 5.1.2). For a spatial domain it is convenient to consider
a local measure of the case density and to compare it to a model ﬁtted
density. A deviance residual was proposed by Lawson (1993a), which com-
pared a saturated density estimate with a modeled estimate. Extension to
other processes has also been made (see Baddeley et al., 2005 and discus-
sion).
The measure D(θ) = −2l(y|θ) is available for any likelihood model
and so a relative comparison is possible between models with
diﬀerent es-
timated θ. Hence, rdi = Di(θs) −Di where Di = −2 G
g=1 l(yi|θg)/G and
θs is a saturated estimate of the parameters, or an averaged version such as
rdi = 1
G
G

g=1
[ Di(θs) −Di(θg)] are available. If θs is ﬁxed then these residuals
are the same. A simple saturated estimate of density is
1
Ai where Ai is the area
of the i th Voronoi (Dirichlet) tile. This is not a consistent estimator. Deﬁne
a neighborhood set of the i th location as δi and the number in the set as nδi.
This set consists of all the areas that are regarded as neighbors of that point.
In a tesselation the ﬁrst order neighbors are usually those locations that share
a common boundary with the point of interest. Hence, further averaging over
tile neighbors might be useful to improve this ‘local’ estimate. An example
could be λsi =
nδi+1
Ai+P
j∈δi Aj . In the case event situation, for a realization of
cases at locations {si}, i = 1, ..., m, the likelihood would be a function of the
intensity of the process at these locations λi. Hence, Di = −2 G
g=1 l(si|λg
i )/G
and Di(θs) = −2l(si|A−1
i
) for the simple case or Di(θs) = −2l(si|λsi) where
λsi =
nδi +1
Ai+P
j∈δi Aj for the consistent case. Hence a deviance residual can be

Residuals and Goodness-of-Fit
61
set up for a simple non-stationary Poisson point process by computing
rdi = −2[l(si|A−1
i ) +
G

g=1
l(si|λg
i )/G].
This does not make allowance for modulation of the process however. Usually
the intensity of the case event process is modulated by the ‘at risk’ population
distribution, and the intensity of the modulated process is λi ≡λ(si) =
λ0(si).λ1(si; θ) where λ0(si) represents this population eﬀect and λ1(si; θ) is
the excess risk density suitably parameterized with θ. Deﬁne λ0i = λ0(si),
and λ1i = λ1(si; θ). Assuming that λ0i is known, then the simple saturated
estimate of λ(si) is λi = A−1
i
(as the estimate subsumes both population and
excess risk eﬀects). Hence the residual becomes
rdi = −2[l(si|A−1
i ) +
G

g=1
l(si|λ0iλg
1i)/G].
The estimation of λ0i may be an issue in any application, if it is not known,
and this is discussed further in Section 5.1.1.
4.3
Bayesian Residuals
In a Bayesian setting it is natural to consider the appropriate version of (4.1).
Carlin and Louis (2000) describe a Bayesian residual as
ri = yi −1
G
G

g=1
E(yi|θ(g)
i
)
(4.2)
where E(yi|θi) is the expected value from the posterior predictive distribution,
and (in the context of McMC sampling) {θ(g)
i
} is a set of parameter values
sampled from the posterior distribution.
In the tract count modeling case, with a Poisson likelihood and expectation
eiθi, this residual can be approximated, when a constant tract rate is assumed,
by:
ri = yi −1
G
G

g=1
eiθ(g)
i
.
(4.3)
This residual averages over the posterior sample. An alternative compu-
tational possibility is to average the {θ(g)
i
} sample, θi = 1
G
G
g=1 θ(g)
i
say, to
yield a posterior expected value of yi, say yi = eiθi, and to form ri = yi−yi. A

62
Bayesian Disease Mapping
further possibility is to simply form ri at each iteration of a posterior sampler
and to average these over the converged sample (Spiegelhalter et al., 1996).
These residuals can provide pointwise goodness-of-ﬁt (gof ) measures as well as
global gof measures, (such as mean squared error (MSE):
1
m
m

i=1
r2
i ) and can
be assessed using Monte Carlo methods. For exploratory purposes it might be
useful to standardize the residuals before examination, although this is not
essential for Monte Carlo assessment. To provide for a Monte Carlo assess-
ment of individual unit residual behavior a repeated Monte Carlo simulation
of independent samples from the predictive distribution would be needed. This
can be achieved by taking J samples from the converged McMC stream with
gaps of length p, where p is large enough to ensure independence. Ranking of
the residuals in the pooled set (J + 1) can then be used to provide a Monte
Carlo p-value for each unit.
4.4
Predictive Residuals and the Bootstrap
It is possible to disaggregate the MSPE to yield individual level residuals based
on the predictive distribution. Deﬁne ypr
i ˜fpr(ypr|y; θ) where fpr(ypr|y; θ) =
	
f(ypr|θ)p(θ|y)dθ and f(ypr|θ) is the likelihood of ypr given θ. This can
be approximated within a converged sample by a draw from f(ypr|θ). For
a Poisson likelihood, at the g th iteration, with expectation eiθ(g)
i
, a single
value ypr(g)
i
is generated from Pois(eiθ(g)
i
). Hence a predictive residual can be
formed from rpr
i
= yi−ypr
i . This must be averaged over the sample. This can be
done in a variety of ways. For example, we could take rpr
i
=
G

g=1
{yi−ypr(g)
i
}/G.
Other possibilities could be explored.
To further assess the distribution of residuals, it would be advantageous to
be able to apply the equivalent of PB in the Bayesian setting. With conver-
gence of a McMC sampler, it is possible to make subsamples of the converged
output. If these samples are separated by a distance (h) which will guarantee
approximate independence (Robert and Casella, 2005), then a set of J such
samples could be used to generate {ypr
i } j = 1, ...., J, with, ypr
i
←Pois(eiθij),
and the residual computed from the data ri can be compared to the set of
J residuals computed from ypr
i
−yi. In turn, these residuals can be used to
assess functions of the residuals and gof measures. The choice of J will usually
be 99 or 999 depending on the level of accuracy required.

Residuals and Goodness-of-Fit
63
4.4.1
Conditional Predictive Ordinates
It is possible to consider a diﬀerent approach to inference whereby individual
observations are compared to the predictive distribution with observations
removed. This conditional approach has a cross-validation ﬂavour i.e., the
value in the unit is predicted from the remaining data and compared to the
observed data in the unit. The derived residual is deﬁned as
rCP O
i
= yi −yrep
i,−i
where yrep
i,−i is the predicted value of y based on the data with the i th unit
removed (Stern and Cressie, 2000). The value of yrep
i,−i is obtained from the
cross-validated posterior predictive distribution:
p(yrep
i,−i|Y−i) =

p(yrep
i,−i|θ)p(θ|Y−i)dθ
where θ is a vector of model parameters. For a Poisson data likelihood,
p(yrep
i,−i|Y−i) is just a Poisson distribution with mean e∗
i θi where e∗
i is adjusted
for the removal of the i th unit and θi is estimated under the cross-validated
posterior distribution p(θ|Y−i).
As noted by Spiegelhalter et al. (1996), it is possible to make inference about
such residuals within a conventional McMC sampler via the construction of
weights. Assume draws g = 1, ..., G are available and deﬁne the importance
weight w−i(θg) =
1
p(yi|eiθg
i ). This is just the reciprocal of the Poisson probabil-
ity with mean eiθg
i . It is then possible to compute a Monte Carlo probability
for the residual via:
p(yrep
i,−i ≤yi|Y−i) = p(yrep
i,−i < yi|Y−i) + 1
2p(yrep
i,−i = yi|Y−i)
≈
yi−1

l=0
" G

g=1
p(yrep
i,−i = g|θg)w−i(θg)
#
/wT
i
+1
2
" G

g=1
p(yrep
i,−i = yi|θg)w−i(θg)
#
/wT
i
where wT
i = G
g=1
1
p(yi|eiθg
i ). In general, a simple approach to computation of
the CPO without recourse to reﬁtting is to note that the conditional predictive
ordinate for the i, the unit can be obtained from
CPO−1
i
= G−1
G

g=1
p(yi|θg)−1
where p(yi|θg) is the data density given the current parameters.

64
Bayesian Disease Mapping
4.5
Interpretation of Residuals in a Bayesian Setting
Diagnostics based on residuals will be indicative of a variety of model features.
What should be expected from residuals from an adequate model? In general,
when a model ﬁts well, one would expect the residuals from that model to have
a number of features. First they should usually be symmetric and centered
around zero. Clearly variance standardization should yield a closer approx-
imation to this, but in general this can only be approximate. Second they
should not show any particular structure and should appear to be reason-
ably random. However, as to distribution, it is not clear that residuals should
have a zero mean Gaussian form (as suggested by the use of normal quantile
plots in e.g., Carlin and Louis, 2000). In the following example, I examine a
dataset for congenital anomaly mortality counts for the 46 counties of South
Carolina for the year 1990. The standardized mortality ratio for these data
using the statewide standard population rate is shown in Section 1.1. Figure
4.1 displays Bayesian residuals from a converged Poisson–gamma model ﬁt-
ted to congenital anomaly mortality for South Carolina counties 1990. These
residuals seem to have some structure although their QQ plot is relatively
straight. Figure 4.2 displays the corresponding image and contour map of the
smoothed residual surface. It is noticeable that the high positive residuals are
grouped in relatively rural areas.
4.6
Exceedence Probabilities
Exceedence probabilities are important when assessing the localized spatial
behavior of the model and the assessment of unusual clustering or aggregation
of disease. The simplest case of an exceedence probability is qc
i = Pr(θi > c).
The probability is an estimate of how frequently the relative risk exceeds the
null risk value (θi = 1) and can be regarded as an indicator of ‘how unusual’
the risk is in that unit. As will be discussed in Chapter 6, this leads to as-
sessment of ‘hot spot’ clusters: areas of elevated risk found independently of
any cluster grouping criteria. Note that under posterior sampling, a converged
sample of

θm+1, ...., θm+mp
can yield posterior expected estimates of these
probabilities as qc
i = m+mp
g=m+1 I(θ(g)
i
> c)/G where G = mp. It is straightfor-
ward on WinBUGS, for example, to compute these values. If theta[i] is set to
store the current θi then
prexc[i]<-step(theta[i]-1)
will store the indicator of exceedence and this variable can be monitored.
The posterior average of the variable will yield the posterior estimate of the

Residuals and Goodness-of-Fit
65
FIGURE 4.1
Residual plots of Bayesian residuals for 46 counties of South Carolina for
congenital abnormality mortality data 1990. Poisson–gamma model ﬁt with
top: standardised residual versus ﬁtted value; bottom: QQ plot of standardised
residual versus standard normal quantile.
probability. Large values of qc
i would be suggestive of unusual areas of risk.
In fact this measure has been proposed as a method for detecting clusters
(Richardson et al., 2004). While it certainly can be used to examine maps
for individual hot spots of risk, the measure itself does not directly measure
clustering of risk in terms of spatial aggregation. In fact, the measure can be
applied to any underlying model when a relative risk parameter is estimated
and hence may be model dependent. This is discussed more fully in the chapter
on disease cluster modeling (Chapter 6).
As a comparison, the predictive residuals have also been computed for this
example. Figure 4.3 displays a comparison of the density estimates of the
diﬀerent residuals. These appear quite similar in this example, with the pre-
dictive residual having a longer right hand tail. The associated map of the
predictive residuals shows a rural-urban diﬀerence also.
There are a number of issues associated with the evaluation of qc
i . First the
value of c must be speciﬁed. Second the level of probability that is regarded
‘unusual’ (a say) must also be ﬁxed. However there is a trade-oﬀbetween
these measures. Not only will there be diﬀerent features found if you change

66
Bayesian Disease Mapping
FIGURE 4.2
Bayes residual map for the South Carolina congenital anomaly mortality data.
The county centroids are marked as ⋄.
the threshold (c), but there will be diﬀerent interpretations if threshold is
changed from say a1 = 0.95 to a2 = 0.99 or lowered to a0 = 0.90. Hence a
simple rule such as, classify as unusual any region where q1
i > a1, might be
equivalent to q2
i > a0. Whereas the null level of risk may be c = 1 there is
not reason to assume as a threshold q1
i > 0.95. Of course usually either a or
c is ﬁxed. It should be noted that qc
i is a function of a model and so is not
necessarily going to yield the same information as, say a residual ri. While
both depend on model elements, a residual usually also contains extra (at
least) uncorrelated noise and should, if the model ﬁts well, not contain any
further structure. On the other hand, posterior estimates of relative risk will
include modeled components of risk (such as trend or correlation) and should
be relatively free of extra noise.
In the example of the South Carolina congenital anomaly mortality for
1990, the standardized residuals and the q1
i seem to reﬂect areas of relatively
unusual risk. Both reﬂect rural areas where incidence is marked. The q1
i map
displayed in Figure 4.4 shows these areas well. None of the areas exceed 0.95
in this case. A comparison with Figure 4.2 suggests that even though the
model does reﬂect the elevated risk areas, in these areas there is excess risk
unaccounted for.

Residuals and Goodness-of-Fit
67
FIGURE 4.3
Residual plots using density estimation: Bayes residuals and predictive resid-
uals for the same example: South Carolina county-level congenital anomaly
mortality example.
4.7
Exercises
1) The Bernoulli model with outcome yi is assumed for the binary label for
a set of
m case and n control events: S : { s1, ...., sm, sm+1, ....., sm+n}. For
short, denote the outcome as yi ≡y(si). The probability, conditional on a
site si, of being a case, is pi ≡p(si). Assume a logistic link to a covariate
model: logit pi = ηi = xT
i β with an intercept and single covariate x1i. The
parameter vector is β : [β0, β1]′. The parameters have zero mean Gaussian
prior distributions: β ∼N2(0, Γ) where Γ = diag(τ0, τ1) and N2 denotes a
bivariate normal distribution. Hence, each β∗∼N(0, τ∗).
a) Show that the DIC for this model is given by DIC = −2 1
G
G

g=1
m+n

i=1
log [pg
i ]+
1
2
1
G−1
G

g=1
$
2( 1
G
G

g=1
m+n

i=1
log [pg
i ] −
m+n

i=1
log [pg
i ])
%2

68
Bayesian Disease Mapping
FIGURE 4.4
Exceedance probability map for C = 1. Bayes residuals and predictive resid-
uals for the same example: South Carolina county-level congenetial anomaly
mortality example.
where pg
i = [exp(βg
0+βg
1x1i)]yi
1+exp(βg
0+βg
1x1i) .
b) Show that the conditional predictive ordinate (CPO) is given by CPOi =
"
1
G
G

g=1

[exp(βg
0+βg
1x1i)]yi
1+exp(βg
0+βg
1x1i)
−1
#−1
c) A Bayesian residual can be computed from yi −
exp(bβ0+bβ1x1i)
1+exp(bβ0+bβ1x1i), where
β0, β1 are posterior mean estimates. Why is this residual diﬃcult to inter-
pret? What remedy could be suggested to allow a more meaningful residual
analysis?
2) A case event realization within a window of area T is deﬁned as {si},
i = 1, ..., m. A modulated Poisson process model is assumed with ﬁrst order in-
tensity, conditional on a parameter vector θ, governed by λ(s) = λ0(s).λ1(s|θ).
Assume that λ1(s|θ) = 1 + α exp{−β||s −s0||} where s0 is a ﬁxed spatial

Residuals and Goodness-of-Fit
69
location. Assume also that λ0(s) is ﬁxed and known. The prior distributions
for the parameters are αt = log α ∼N(0, τα) and β ∼N(0, τβ). The log
likelihood is given by
l(s|α, β) =
m

i=1
ln(1 + α exp{−βdi}) −Λ(α, β)
where di = ||si −s0|| and Λ(α, β) =

T
λ0(u).[1 + α exp{−β||u −s0||}]du.
i) Show that, for this model under McMC iterative sampling with a con-
verged sample of size G, the DIC = D +  
pD where D = −2 G
g=1[
m

i=1
ln(1 +
αg exp{−βgdi}) −Λ(αg, βg)]/G
and
 
pD = 1
2
1
G−1
G

g=1
([−2
m

i=1
ln(1 + αg exp{−βgdi}) −Λ(αg, βg)] −D)2.
ii) Show that a deviance residual can be computed from
rdi = −2[l(si|A−1
i
) + G
g=1[ln(1 + αg exp{−βgdi}) −Λ∗(αg, βg)])/G]
where Λ∗
i (αg, βg) = wiλ0(si).[1 + α exp{−β||si −s0||}] and wi is a Berman-
Turner integration weight (see Chapter 5) for thei the unit.
iii) Suggest a total model discrepancy measure based on this residual.
3) For the model in 2) above consider an exceedence probability for the
resulting estimated intensity function. The focus of interest is the relative
risk λ1(s|θ). Under posterior sampling the estimated risk is λ1(s|θ) = [1 +
αg exp{−βgdi}]. However usually it is assumed that α > 0, and usually, but
not necessarily, β > 0 (as the estimated risk could increase with distance from
the ﬁxed point). Hence we cannot have λ1(s|θ) < 1, as will be seen later in
Chapter 7.3. This risk is a natural form for the function of distance. However
a simpler form that is often assumed is a purely multiplicative one:
λ1(s|θ) = ρ. exp{−βdi}
where ρ = exp(α). Show that an exceedence probability (gi) can be computed
from:
gi =  
Pr(λ1(si|θ) > 1) =
G

g=1
I(exp{αg −βgdi}/G).


Part II
Themes


5
Disease Map Reconstruction and Relative
Risk Estimation
5.1
Introduction to Case Event and Count Likelihoods
5.1.1
Poisson Process Model
Deﬁne a study area as T and within that area m event of disease occur.
These events are usually address locations of the cases. The case could be an
incident or prevalent case or could be a death certiﬁcate address. We assume at
present that the cases are geo-coded down to a point (with respect to the scale
of the total study region). Hence they form a point process in space. Deﬁne
{si}, i = 1, ..., m as the set of all cases within T. This is called a realization of
the disease process, in that we assume that all cases within the study area are
recorded. This is a common form of data available from government agencies.
Sub-samples of the spatial domain, where incomplete realizations are taken
are not considered at this point.
The basic point process model assumed for such data within disease map-
ping is the heterogeneous Poisson process with ﬁrst-order intensity λ(s). The
basic assumptions of this model are that points (case events) are indepen-
dently spatially-distributed and governed by the ﬁrst order intensity. Due to
the independence assumption, we can derive a likelihood for a realization of a
set of events within a spatial region. For the study region deﬁned above, the
unconditional likelihood of m events is just
L({s}|ψ) = 1
m!
m

i=1
λ(si|ψ) exp{−ΛT}
(5.1)
where ΛT =

T
λ(u|ψ)du.
The function ΛT is the integral of the intensity over the study region, ψ is a
parameter vector, and λ(si|ψ) is the ﬁrst order intensity evaluated at the case
event location si. Denote this likelihood as PP[{s}|ψ]. This likelihood can be
maximized with respect to the parameters in ψ and likelihood-based inference
could be pursued. The only diﬃculty in its evaluation is the estimation of the
spatial integral. However, a variety of approaches can be used to numerical
73

74
Bayesian Disease Mapping
integration of this function and with suitable weighting schemes this likelihood
can be evaluated even with conventional linear modeling functions within
software packages (such as glm in R or S-Plus) (see e.g., Berman and Turner,
1992, Lawson, 2006b, App. C). An example of such a weighted log-likelihood
approximation is:
l({s}|ψ) =
m

i=1
ln λ(si|ψ) −ΛT ,
(5.2)
where ΛT ≈
m

i=1
wiλ(si|ψ) and wi is an integration weight. This scheme per
se is not accurate and more weights are needed. In the more general scheme
of Berman & Turner a set of additional mesh points (of size maug) are added
to the data. The augmented set (N = m + maug) is used in the likelihood
with a indicator function, Ik:
l({s}|ψ) =
N

k=1
wk{ Ik
wk
ln λ(sk|ψ) −λ(sk|ψ)},
where

T
λ(u|ψ)du =
N

k=1
wkλ(sk|ψ).
This has the form of a weighted Poisson likelihood, with Ik = 1 for a case and
0 otherwise. Diggle (1990) gives an example of the use of a likelihood such as
(5.1) in a spatial health data problem.
In disease mapping applications, it is usual to parameterize λ(s|ψ) as a
function of two components. The ﬁrst component makes allowance for the un-
derlying population in the study region, and the second component is usually
speciﬁed with the modelled components (i.e., those components describing the
‘excess’ risk within the study area).
A typical speciﬁcation would be
λ(s|ψ) = λ0(s|ψ0).λ1(s|ψ1).
(5.3)
Here it is assumed that λ0(s|ψ0) is a spatially-varying function of the pop-
ulation ‘at risk’ of the disease in question. It is parameterized by ψ0. The
second function, λ1(s|ψ1), is parameterized by ψ1 and includes any linear
or non-linear predictors involving covariates or other descriptive modeling
terms, thought appropriate in the application. Often we assume, for positiv-
ity, that λ1(si|ψ1) = exp{ηi} where ηi is a parameterized linear predictor
allowing a link to covariates measured at the individual level. The covariates
could include spatially-referenced functions as well as case-speciﬁc measures.
Note that ψ : {ψ0, ψ1}. The function λ0(s|ψ0) is a nuisance function which
must be allowed for but which is not usually of interest from a modeling
perspective.

Disease Map Reconstruction and Relative Risk Estimation
75
5.1.2
Conditional Logistic Model
When a bivariate realization of cases and controls are available it is possible
to make conditional inference on this joint realization. Deﬁne the case events
as si : i = 1, ..., m and the control events as si : i = m + 1, ...., N where
N = m + n the total number of events. Associated with each location is a
binary variable (yi) which labels the event either as a case (yi = 1) or a control
(yi = 0). Assume also that the point process models governing each event type
(case or control) is a heterogeneous Poisson process with intensity λ(s|ψ)
for cases and λ0(s|ψ0) for controls. The superposition of the two processes
is also a heterogeneous Poisson process with intensity λ0(s|ψ0) + λ(s|ψ) =
λ0(s|ψ0)[1+λ1(s|ψ1)]. Conditioning on the joint realization of these processes,
then it is straightforward to derive the conditional probability of a case at any
location as
Pr(yi = 1) =
λ0(si|ψ0).λ1(si|ψ1)
λ0(si|ψ0)[1 + λ1(si|ψ1)]
=
λ1(si|ψ1)
1 + λ1(si|ψ1) = pi
(5.4)
and
Pr(yi = 0) =
1
1 + λ1(si|ψ1) = 1 −pi.
(5.5)
The important implication of this result is that the background nuisance func-
tion λ0(si|ψ0) drops out of the formulation and, further, this formulation
leads to a standard logistic regression if a linear predictor is assumed within
λ1(si|ψ1). For example, a log linear formulation for λ1(si|ψ1) leads to a logit
link to pi, i.e.,
pi =
exp(ηi)
1 + exp(ηi),
where ηi = x′
iβ and x′
i is the i th row of the design matrix of covariates and
β is the corresponding p-length parameter vector. Note that slightly diﬀerent
formulations can lead to non-standard forms (see e.g., Diggle and Rowlingson,
1994). In some applications, non-linear links to certain covariates may be
appropriate (see Section 7.3).
Further, if the probability model in (5.4) applies, then the likelihood of the
realization of cases and controls is simply
L(ψ1|s) =

i∈cases
pi

i∈controls
1 −pi
=
N

i=1
{exp(ηi)}yi
1 + exp(ηi)

.
(5.6)
Hence, in this case, the analysis reduces to that of a logistic likelihood, and
this has the advantage that the ‘at risk’ population nuisance function does

76
Bayesian Disease Mapping
not have to be estimated. This model is ideally suited to situations where it
is natural to have a control and case realization, where conditioning on the
spatial pattern is reasonable.
5.1.3
Binomial Model for Count Data
In the case where we examine arbitrary small areas (such as census tracts,
counties, postal zones, municipalities, health districts), usually a count of
disease is observed within each spatial unit. Deﬁne this count as yi and assume
that there are m small areas. We also consider that there is a ﬁnite population
within each small area out of which the count of disease has arisen. Denote
this as ni ∀i. In this situation, we can consider a binomial model for the
count data conditional on the observed population in the areas. Hence we
can assume that given the probability of a case is pi, then yi is distributed
independently as
yi ∼bin(pi, ni)
and that the likelihood is given by
L(yi|pi, ni) =
m

i=1
ni
yi

pyi
i (1 −pi)(ni−yi).
(5.7)
It is usual for a suitable link function for the probability pi to a linear
predictor to be chosen. The commonest would be a logit link so that
pi =
exp(ηi)
1 + exp(ηi).
Here, we envisage the model speciﬁcation within ηi, to include spatial and non-
spatial components. Two applications which are well suited to this approach
are the analysis of sex ratios of births, and the analysis of birth outcomes
(e.g., birth abnormalities) compared to total births. Sex ratios are often de-
rived from the number of female (or male) births compared to the total birth
population count in an area. A ratio is often formed, though this is not neces-
sary in our modeling context. In this case the pi will often be close to 0.5 and
spatially-localized deviations in pi may suggest adverse environmental risk
(Williams et al., 1992). The count of abnormal births (these could include
any abnormality found at birth) can be related to total births in an area.
Variations in abnormal birth count could relate to environmental as well as
health service variability (over time and space)(Morgan et al., 2004).
5.1.4
Poisson Model for Count Data
Perhaps the most commonly encountered model for small area count data
is the Poisson model. This model is appropriate when there is a relatively
low count of disease and the population is relatively large in each small area.

Disease Map Reconstruction and Relative Risk Estimation
77
Often the disease count yi is assumed to have a mean μi and is independently
distributed as
yi ∼Poisson(μi).
(5.8)
The likelihood is given by
L(y|μ) =
m

i=1
μyi
i exp(−μi)/yi!.
(5.9)
The mean function is usually considered to consist of two components: i) a
component representing the background population eﬀect, and ii) a compo-
nent representing the excess risk within an area. This second component is
often termed the relative risk. The ﬁrst component is commonly estimated or
computed by comparison to rates of the disease in a standard population and
a local expected rate is obtained. This is often termed standardization (Inskip
et al. (1983)). Hence, we would usually assume that the data is independently
distributed with expectation
E(yi) = μi = eiθi
where ei is the expected rate for the i th area and θi is the relative risk for
the i th area. As we will be developing Bayesian hierarchical models we will
consider {yi} to be conditionally independent given knowledge of {θi}. The
expected rate is usually assumed to be ﬁxed for the time period considered in
the spatial example, although there is a literature on the estimation of small
area rates that suggests this may be naive (Ghosh and Rao, 1994; Rao, 2003).
Usually the focus of interest will be the modeling of the relative risk. The
commonest approach to this is to assume a logarithmic link to a linear pre-
dictor model:
log θi = ηi.
This form of model has seen widespread use in the analysis of small area count
data in a range of applications (see e.g., Stevenson et al., 2005; Waller and
Gotway, 2004, Chapter 9)
5.2
Speciﬁcation of the Predictor in Case Event and
Count Models
In all the above models a predictor function (ηi) was speciﬁed to relate to the
mean of the random outcome variable, via a suitable link function. Often the
predictor function is assumed to be linear and a function of ﬁxed covariates

78
Bayesian Disease Mapping
and also possibly random eﬀects. We deﬁne this in a general form, for p
covariates, here as
ηi = x′
iβ + z′
iξ,
= β1x1i........βpxpi + ξ1z1i......ξqzqi
where x′
i is the i th row of a covariate design matrix x of dimension m × p, β
is a (p × 1) vector of regression parameters, ξ is a (q × 1) unit vector and z′
i
is a row vector of individual level random eﬀects, of which there are q. In this
formulation the unknown parameters are β and z the (m×q) matrix of random
eﬀects for each unit. Note that in any given application it is possible to specify
subsets of these covariates or random eﬀects. Covariates for case event data
could include diﬀerent types of speciﬁc level measures such as an individual’s
age, gender, smoking status, health provider, etc., or could be environmental
covariates which may have been interpolated to the address location of the
individual (such as soil chemical measures or air pollution levels). For count
data in small areas, it is likely that covariates will be obtained at the small
area level. For example, for census tracts, there is likely to be socioeconomic
variables such as poverty (percentage population below an income level), car
ownership, median income level, available from the census. In addition, some
variates could be included as supra-area variables such as health district in
which the tract lies. Environmental covariates could also be interpolated to
be used at the census tract level. For example air pollution measures could be
averaged over the tract.
In some special applications non-linear link functions are used, and in oth-
ers, mixtures of link functions are used. One special application area where
this is found is the analysis of putative hazards (see Section 7.3), where speciﬁc
distance- and/or direction-based covariates are used to assess evidence for a
relation between disease risk and a ﬁxed (putative) source of health hazard.
For example, one simple example of this is the conditional logistic modeling
of disease cases around a ﬁxed source. Let distance and direction from the
source to the i th location be di and φi, respectively, then a mixed linear and
non-linear link model is commonly assumed where
ηi = {1 + β1 exp(−β2di)}. exp{β0 + β3 cos(φi) + β4 sin(φi)}.
Here the distance eﬀect link is nonlinear, while the overall rate (β0) and
directional components are log-linear. The explanation and justiﬁcation for
this formulation is deferred to Chapter 7.
Fixed covariate models can be used to make simple descriptions of disease
variation. In particular it is possible to use the spatial coordinates of case
events (or in the case of count data, centroids of small areas) as covariates.
These can be used to model the long range variation of risk: spatial trend.
For example, let’s assume that the i th unit x-y coordinates are (xsi, ysi). We
could deﬁne a polynomial trend model such as:

Disease Map Reconstruction and Relative Risk Estimation
79
ηi = β0 +
L

l=1
βxlxl
si +
L

l=1
βylyl
si +
K

k=1
L

l=1
βlkxl
siyk
si.
This form of model can describe a range of smoothly varying non-linear surface
forms. However, except for very simple models, these forms are not parsimo-
nious and also cannot capture the extra random variation that often exists in
disease incidence data.
5.2.1
Bayesian Linear Model
In the Bayesian paradigm all parameters are stochastic and are therefore
assumed to have prior distributions. Hence in the covariate model
ηi = x′
iβ,
the β parameters are assumed to have prior distributions. Hence this can be
formulated as
P(β, τ β|data) ∝L(data|β, τ β)f(β|τ β)
where f(β|τ β) is the joint distribution of the covariate parameters condi-
tional on the hyperparameter vector τ β. Often we regard these parameters as
independent and so
f(β|τ β) =
p

j=1
fj(βj|τ βj).
More generally it is commonly assumed that the covariate parameters can be
described by a Gaussian distribution and if the parameters are allowed to be
correlated then we could have the multivariate Gaussian speciﬁcation:
f(β|τ β) = Np(0, Σβ),
where under this prior assumption, E(β|τ β) = 0 and Σβ is the conditional
covariance of the parameters. The commonest speciﬁcation assumes prior in-
dependence and is:
f(β|τ β) =
p

j=1
N(0, τ βj),
where N(0, τβj) is a zero-mean single variable Gaussian distribution with vari-
ance τ βj. At this point an assumption about variation in the hyperparameters
is usually made. At the next level of the hierarchy hyperprior distributions
are assumed for τ β. The deﬁnition of these distributions could be important
in deﬁning the model behavior. For example if a vague hyperprior is assumed
for τ βj this may lead to extra variation being present when limited learning is
available from the data. This can aﬀect computation of DIC and convergence
diagnostics. While uniform hyperpriors (on a large positive range) can lead to

80
Bayesian Disease Mapping
improper posterior distributions, it has been found that a uniform distribution
for the standard deviation can be useful (Gelman, 2006) i.e., √τ βj ∼U(0, A)
where A has a large positive value.
Alternative suggestions are usually in the form of gamma or inverse gamma
distributions with large variances. For example, Kelsall and Wakeﬁeld (2002)
proposed the use of gamma (0.2, 0.0001) with expectation 2000 and variance
20,000,000, whereas Banerjee et al. (2004) examine various alternative speci-
ﬁcations including gamma (0.001, 0.001). One common speciﬁcation (Thomas
et al., 2004) is gamma (0.5, 0.0005) that has expectation 1000 and variance
2,000,000.
While these prior speciﬁcations lead to relative uninformativeness, their use
has been criticized by Gelman (2006) (see also Lambert et al., 2005), in favour
of uniform prior distributions on the standard deviation.
To summarize the hierarchy for such covariate models, Figure 5.1 displays a
directed acyclic graph for a simple Bayesian hierarchical covariate model with
two covariates (x1, x2) and relative risk deﬁned as θi = exp(β0+β1x1i+β2x2i)
for data {yi, ei} for m regions. The regression parameters are assumed to have
independent zero mean Gaussian prior distributions. Figure 5.2 displays the
corresponding WinBUGS code.
5.3
Simple Case and Count Data Models
with Uncorrelated Random Eﬀects
In the previous section, some simple models were developed. These consisted
of functions of ﬁxed observed covariates. In a Bayesian model formulation
all parameters are stochastic and so the extension to the addition of random
eﬀects is relatively straightforward. In fact the term ‘mixed’ model (linear
mixed model: LMM, normal linear mixed model: NLMM, or generalized linear
mixed model: GLMM) is strictly inappropriate as there are no ﬁxed eﬀects in
a Bayesian model.
The simple regression models described above often do not capture the ex-
tent of variation present in count data. Overdispersion or spatial correlation
due to unobserved confounders will usually not be captured by simple co-
variate models and often it is appropriate to include some additional term or
terms in a model which can capture such eﬀects.
Initially, overdispersion or extra-variation can be accommodated by either
a) inclusion of a prior distribution for the relative risk, (such as a Poisson
-gamma model) or b) by extension of the linear or non-linear predictor term
to include an extra random eﬀect (log-normal model).

Disease Map Reconstruction and Relative Risk Estimation
81
FIGURE 5.1
A directed acylic graph (in WinBUGS Doodle format) for a simple Poisson
Bayesian regression with log linear relative risk and two covariates.
FIGURE 5.2
WinBUGS odc (code) for the DAG in Figure 5.1.

82
Bayesian Disease Mapping
5.3.1
Gamma and Beta Models
5.3.1.1
Gamma models
The simplest extension to the likelihood model that accommodates extra vari-
ation is one in which the parameter of interest in the likelihood is given a prior
distribution. One case event example would be where the intensity is speciﬁed
at the
i th location as, λ0(si|ψ0).λ1(s|ψ1) ≡λ0i.λ1i, suppressing the pa-
rameter dependence, for simplicity. Note that λ1i plays the role of a relative
risk parameter. This parameter can be assigned a prior distribution, such as
a gamma distribution to model extra-variation. For most applications where
count data are commonly found a Poisson likelihood is assumed. We will focus
on these models in the remainder of this section. The Poisson parameter θi
could be assigned a gamma(a, b) prior distribution. In this case, the prior ex-
pectation and variance would be respectively a/b and a/b2. This could allow
for extra variation or overdispersion. Here we assume that parameters a, b are
ﬁxed and known. This formulation is attractive as it leads to a closed form
for the posterior distribution of {θi}, i.e.,
[θi|yi, ei,a, b] ∼gamma(a∗, b∗)
(5.10)
where a∗= yi + a, b∗= ei + b.
Hence, conjugacy leads to a gamma posterior distribution with posterior mean
and variance given by
yi+a
ei+b and
yi+a
(ei+b)2 respectively. Note that a variety
of θi estimates are found depending on the values of a and b. Lawson and
Williams (2001, 78–79) demonstrate the eﬀect of diﬀerent values of a and b
on relative risk maps. Samples from this posterior distribution are straightfor-
wardly obtained (e.g., using the rgamma function on R). The prior predictive
distribution of y∗is also relevant in this case as it leads to a distribution often
used for overdispersed count data: the negative binomial. Here we have the
joint distribution as:
[y∗|y,a, b] =

f(y∗|θ)f(θ|a, b)dθ
(5.11)
=
m

i=1
 ba
Γ(a)
Γ(y∗
i + a)
(ei + b)(y∗
i +a)

5.3.1.1.1
Hyperprior distributions
One extension to the above model
is to consider a set of hyperprior distributions for the parameters of the gamma
prior (a and b). Often these are assumed to also have prior distributions on
the positive real line such as gamma (a′, b′) with a′ > 0, b′ = 1 or b′ > 1.
5.3.1.1.2
Linear
parameterization
One approach to incorporating
more sophisticated model components into the relative risk model is to model
the parameters of the gamma prior distribution. For example, gamma linear
models can be speciﬁed where

Disease Map Reconstruction and Relative Risk Estimation
83
[θi|yi, ei,a, bi] ∼gamma(a, bi)
where bi = a/μi and
μi = ηi.
In this formulation the prior expectation is μi and the prior variance is μ2
i /a.
While this formulation could be used for modeling, often the direct linkage
between the variance and mean could be seen as a disadvantage. As will be
seen later, a log normal parameterization is often favoured for such models.
5.3.1.2
Beta models
When Bernoulli or binomial likelihood models are assumed (such as 5.6 or
5.7) then one may need to consider prior distributions for the probability
parameter pi. Commonly a beta prior distribution is assumed for this:
[pi|α, β] ∼Beta(α, β).
Here the prior expectation and variance would be
α
α+β and
αβ
(α+β)2(α+β+1).
This distribution can ﬂexibly specify a range of forms of distribution from
peaked (α = β, β > 1) to uniform (α = β = 1) and U-shaped (α = β = 0.5)
to skewed or either monotonically decreasing or increasing. In the case of the
binomial distribution this prior distribution, with α, β ﬁxed, leads to a beta
posterior distribution i.e.,
[p|y, n, α, β] = B(α, β)−m
m

i=1
[
ni
yi

pyi
i (1 −pi)(ni−yi).pα−1
i
(1 −pi)β−1]
= B(α, β)−m
m

i=1
[
ni
yi

pyi+α−1
i
(1 −pi‘)(ni−yi+β−1).
This is the product of m independent beta distributions with parameters
yi +α, ni −yi+β. Hence the beta posterior distribution for pi has expectation
yi+α
ni+β+αand variance
(yi+α)(ni−yi+β)
(ni+β+α)2(ni+β+α+1).
5.3.1.2.1
Hyperprior
distributions
The parameters α and β are
strictly positive and these could also have hyperprior distributions. However,
unless these parameters are restricted to the unit interval, then distributions
such as the gamma, exponential or inverse gamma or exponential would have
to be assumed as hyperprior distributions.
5.3.1.2.2
Linear
Parameterization
An alternative speciﬁcation for
modeling covariate eﬀects is to specify a linear or non-linear predictor with
a link to a parameter or parameters. For example, it is possible to consider

84
Bayesian Disease Mapping
a parameterization such as αi = exp(ηi) and βi = ψαi where ψ is a linkage
parameter with prior mean given by
1
1+ψ. When ψ = 1, then the distribu-
tion is symmetric. The disadvantage with this formulation is that a single
parameter is assigned to the linear predictor and a dependence is speciﬁed
between αi and βi. One possible alternative is to model the prior mean as
logit(
αi
αi+βi ) = ηi. However this also forces a dependence between αi and βi.
5.3.2
Log-Normal/Logistic-Normal Models
One simple device that is very popular in disease mapping applications is
to assume a direct linkage between a linear or non-linear predictor (ηi) and
the parameter of interest (such as θi or pi). This oﬀers a convenient method
of introducing a range of covariate eﬀects and unobserved random eﬀects
within a simple formulation. The general structure of this formulation is ηi =
x′
iβ + z′
iγ.The simplest form involving uncorrelated heterogeneity would be
ηi = z1i
where z1i is an uncorrelated random eﬀect.
An example of the application of this model is given in Figure 5.3 where the
WinBUGS code is presented and in Figure 5.4 where the posterior expected
relative risk estimates under the Poisson-log-normal model are displayed. In
this example, the counties of the State of Georgia, USA are modelled and
the outcome of interest is the count of oral cancer deaths in these counties
for a given year (2004). In this example the county-wise expected rate was
computed from the state-wide oral cancer rate for 2004. The likelihood model
assumed for this example is Poisson with yi ∼Poisson(eiθi) and ηi = α0+z1i.
Here the extra-variation is modeled as uncorrelated heterogeneity (UH)
with a zero mean Gaussian prior distribution i.e., z1i ∼N(0, τz1).
5.4
Correlated Heterogeneity Models
Uncorrelated heterogeneity models with gamma or beta prior distributions for
the relative risk are useful but have a number of drawbacks. First, as noted
above, a gamma distribution does not easily provide for extensions into co-
variate adjustment or modeling, and, second, there is no simple and adaptable
generalization of the gamma distribution with spatially correlated parameters.
Wolpert and Ickstadt (1998) provided an example of using correlated gamma
ﬁeld models, but these models have been shown to have poor performance un-
der simulated evaluation (Best et al., 2005). The advantages of incorporating a
Gaussian speciﬁcation are many. First, a random eﬀect which is log-Gaussian
behaves in a similar way to a gamma variate, but the Gaussian model can

Disease Map Reconstruction and Relative Risk Estimation
85
FIGURE 5.3
Poisson-log-normal model for the Georgia county-level oral cancer mortality
data. The model assumes a zero mean Gaussian prior distribution for the UH
random eﬀect . The posterior expected exceedence probability ( 
Pr(θ > 1)) is
computed as PP[].
include a correlation structure. Hence, for the case where it is suspected that
random eﬀects are correlated, then it is simpler to specify a log Gaussian form
for any extra variation present. The simplest extension is to consider additive
components describing diﬀerent aspects of the variation thought to exist in
the data.
For a spatial Gaussian process Ripley (1981, 10) any ﬁnite realization has a
multivariate normal distribution with mean and covariance inherited from the
process itself, i.e., x ∼MVN(μ, K), where μ is an m length mean vector and
K is an m × m positive deﬁnite covariance matrix. Note that this is not the
only possible speciﬁcation of a prior structure to model CH (see also Møller
et al., 1998).
There are many ways of incorporating such heterogeneity in models, and
some of these are reviewed here. First, it is often important to include a va-
riety of random eﬀects in a model. For example, both CH and UH might
be included (see below: 5.5). One ﬂexible method for the inclusion of such
terms is to include a log-linear term with additive random eﬀects. Besag
et al. (1991) ﬁrst suggested, for tract count eﬀects, a rate parametrization of
the form,
exp{x′
iβ + ui + vi},
where x′
iβ is a trend or ﬁxed covariate component, ui and vi are correlated
and uncorrelated heterogeneity, respectively. These components then have sep-
arate prior distributions. Often the speciﬁcation of the correlated component

86
Bayesian Disease Mapping
(68) <0.0
(80) 0.0-5.0
(8) 5.0-10.0
(2) 10.0-15.0
(0) 15.0-20.0
(1) >=20.0
N
(136) <2.5
(12) 2.5-5.0
(3) 5.0-7.5
(5) 7.5-10.0
(1) 10.0-12.5
(2) >=12.5
N
(96) <0.5
(45) 0.5-0.9
(8) 0.9-0.95
(6) 0.95-0.99
(4) >=0.99
N
FIGURE 5.4
Georgia county level mortality counts: Oral cancer 2004. UH random eﬀect
model. County-wise expected rate computed from the state-wide oral can-
cer rate 2004: row-wise from top left: standardised mortality ratio; posterior
expected relative risk estimates; posterior expected exceedence probability
( 
Pr(θi > 1)).
is considered to have either an intrinsic Gaussian (CAR) prior distribution or
a fully speciﬁed Multivariate normal prior distribution.
5.4.1
Conditional Autoregressive (CAR) Models
5.4.1.1
Improper CAR (ICAR) models
The intrinsic autoregressions improper diﬀerence prior distribution, developed
from the lattice models of Kunsch (1987), uses the deﬁnition of spatial dis-
tribution in terms of diﬀerences and allows the use of a singular normal joint
distribution. This was ﬁrst proposed by Besag et al. (1991). Hence, the prior

Disease Map Reconstruction and Relative Risk Estimation
87
for {u} is deﬁned as
p(u|r) ∝
1
rm/2 exp
⎧
⎨
⎩−1
2r

i

j∈δi
(ui −uj)2
⎫
⎬
⎭,
(5.12)
where δi is a neighborhood of the i th tract. The neighborhood δi was assumed
to be deﬁned for the ﬁrst neighbor only. Hence, this is an example of a Markov
random ﬁeld model (see e.g., Rue and Held, 2005). More general weighting
schemes could be used. For example neighborhoods could consist of ﬁrst and
second neighbors (deﬁned by common boundary) or by a distance cut-oﬀ(for
example, a region is a neighbor if the centroid is within a certain distance of the
region in question). The uncorrelated heterogeneity (vi) was deﬁned by Besag
et al. (1991) to have a conventional zero-mean Gaussian prior distribution:
p(v) ∝σ−m/2 exp
"
−1
2σ
m

i=1
v2
i
#
.
(5.13)
Both r and σ were assumed by Besag et al. (1991) to have improper inverse
exponential hyperpriors:
prior(r, σ) ∝e−ϵ/2re−ϵ/2σ,
σ, r > 0,
(5.14)
where ϵ was taken as 0.001. These prior distributions penalize the absorbing
state at zero, but provide considerable indiﬀerence over a large range. Alter-
native hyperpriors for these parameters which are now commonly used are in
the gamma and inverse gamma family, which can be deﬁned to penalize at
zero but yield considerable uniformity over a wide range. In addition, these
types of hyperpriors can also provide peaked distributions if required.
The full posterior distribution for the original formulation where a Poisson
likelihood is assumed for the tract counts is given by
P(u, v, r, σ|yi) =
m

i=1
{exp(−eiθi)(eiθi)yi/yi!}
×
1
rm/2 exp
⎧
⎨
⎩−1
2r

i

j∈δi
(ui −uj)2
⎫
⎬
⎭
×σ−m/2 exp
"
−1
2σ
m

i=1
v2
i
#
× prior(r, σ).
This posterior distribution can be sampled using McMC algorithms such
as the Gibbs or Metropolis–Hastings samplers. A Gibbs sampler was used
in the original example, as conditional distributions for the parameters were
available in that formulation.

88
Bayesian Disease Mapping
An advantage of the intrinsic Gaussian formulation is that the conditional
moments are deﬁned as simple functions of the neighboring values and number
of neighbors (nδi).
E(ui| . . .) = ui and
var(ui| . . .) = r/nδi,
and the conditional distribution is deﬁned as:
[ui| . . .] ∼N(ui, r/nδi),
where ui =

j∈δi
uj/nδi, the average over the neighborhood of the i th region.
5.4.1.2
Proper CAR (PCAR) models
While the intrinsic CAR model introduced above is useful in deﬁning a cor-
related heterogeneity prior distribution, this is not the only speciﬁcation of a
Gaussian Markov random ﬁeld (GMRF) model available. In fact, the improper
CAR is a special case of a more general formulation where neighborhood de-
pendence is admitted but which allows an additional correlation parameter
(Stern and Cressie, 1999). Deﬁne the spatially-referenced vector of interest as
{ui}. One speciﬁcation of the proper CAR formulation yields:
[ui| . . .] ∼N(μi, r/nδi)
(5.15)
μi = ti + φ

j∈δi
(uj −tj)/nδi
(5.16)
where ti
is the trend (= x′
iβ), r is the variance, and φ is a correlation pa-
rameter. It can be shown that to ensure deﬁniteness of the covariance ma-
trix, φ must lie on a predeﬁned range which is a function of the eigenvalues
of a matrix. In detail, the range is the maximum and minimum eigenvalues
(φmin < φ < φmax) of diag{n1/2
δi }.C.diag{n−1/2
δi
} where Cij = cij and
cij =

1
nδi if i ∼j
0 otherwise .
Of course, φmin and φmax can be precomputed before using the proper CAR
as a prior distribution. It could simply be assumed that a (hyper) prior dis-
tribution for φ is U(φmin, φmax). As noted by Stern and Cressie (1999) this
speciﬁcation does lead to a weak form for the partial correlation between dif-
ferent sites. Note that in the simple case of no trend (ti = 0) then the model
reduces to
[ui| . . .] ∼N(μi, r/nδi)
(5.17)
μi = φui.
(5.18)

Disease Map Reconstruction and Relative Risk Estimation
89
The main advantages of this model formulation are that it more closely mimics
fully speciﬁed Gaussian covariance models, as it has a variance and correla-
tion parameter speciﬁed, does not require matrix inversion within sampling
algorithms, and can also be used as a data likelihood.
5.4.1.3
Case event models
For case event data, where a point process model is appropriate, it is still
possible to consider a form of log Gaussian Cox process where the intensity of
the process is governed by a Spatial Gaussian process and conditional on the
intensity the case distribution is a Poisson process. As an approximation to
the Gaussian process a CAR prior distribution can be proposed. For example,
deﬁne the ﬁrst order intensity of the case events as
λ(s) = λ0(s) exp{β + S(s)}
where S(s) is the Gaussian process component. At a given case location, si,
this will yield a likelihood contribution
λ(si) = λ0(si) exp{β + S(si)}.
By considering an intrinsic Gaussian speciﬁcation for S(si) we can proceed by
assuming that the prior distribution for {S(si)} is a conditional autoregressive
speciﬁcation i.e., for short, deﬁne Si ≡S(si), and hence
[Si| . . .] ∼N(Sδi, r/nδi).
where Sδi is the mean of the S values in the neighborhood of Si. Deﬁning
the neighborhood can be handled by using a Voronoi/Dirichlet tesselation
to deﬁne ﬁrst (or greater) order neighbors (on R the package deldir can be
modiﬁed for this task). Hence a hierarchical model can be speciﬁed with the
i th likelihood contribution λ(si) = λ0(si) exp{ηi + vi + Si} where ηi = x′
iβ a
linear predictor with ﬁxed covariate vector x′
i, and
[Si| . . .] ∼N(Sδi, r/nδi)
vi ∼N(0, κv)
β ∼N(0, Γβ).
Of course, in this formulation, then both λ0(si) must be estimated, and also
the integral of the intensity must be computed. A Berman-Turner approxima-
tion scheme (Berman and Turner (1992)) could be used for this purpose. An
example of this type of analysis is given in Hossain and Lawson (2008). The
conditional logistic likelihood model (5.6) can be ﬁtted if a control disease is
available, and this obviates the necessity of estimating λ0(si) (see e.g., Lawson
2006b, ch. 8.4, App. C). However the speciﬁcation of the spatial structure is
diﬀerent as the joint distribution of cases and controls is considered under the
conditional model.

90
Bayesian Disease Mapping
5.4.2
Fully-Speciﬁed Covariance Models
An alternative speciﬁcation involves only one random eﬀect for both CH and
UH. This can be achieved by specifying a prior distribution having two param-
eters governing these eﬀects. For example, the covariance matrix of a MVN
prior distribution can be parametrically modeled with such terms (Diggle
et al., 1998; Wikle, 2002). This approach is akin to universal Kriging (Wack-
ernagel, 2003; Cressie, 1993), which employs covariance models including vari-
ance and covariance range parameters. It has been dubbed ‘generalized linear
spatial modelling.’ A software library is available in R (geoRglm). Usually,
these parameters deﬁne a multiplicative relation between CH and UH. The
full Bayesian analysis for this model requires the use of posterior sampling
algorithms.
In the parametric approach of Diggle et al. (1998), which was originally
speciﬁed for point process models, the ﬁrst-order intensity of the process was
speciﬁed as
λ(s) = λ0(s) exp{β + S(s)},
where β is a non-zero mean level of the process, and S(s) is a zero mean
Gaussian process with, for example, a powered exponential correlation func-
tion deﬁned for the distance dij between the i th and j th locations as
ρ(dij) = exp{−(dij/φ)κ} and variance σ2. Other forms of covariance func-
tion can be speciﬁed. One popular example is the Mat´ern class deﬁned for the
distance (dij) as
ρ(dij) = (dij/φ)κKκ(dij/φ)/[2κ−1Γ(κ)]
(5.19)
where Kκ(.) is a modiﬁed Bessel function of the third kind. In this case, the
parameter vector θ = (β, σ, φ, κ) is updated via a Metropolis–Hastings-like
(Langevin–Hastings) step, followed by pointwise updating of the S surface.
Conditional simulation of S surface values at arbitrary spatial locations (non-
data locations) can be achieved by inclusion of an additional step once the
sampler has converged. Covariates can be included in this formulation in a
variety of ways. For count data, the equivalent Poisson mean speciﬁcation
could be
μi = ei exp{β + Si},
where S ∼MVN(0, Γ) and Γ is a spatial covariance matrix (Kelsall and
Wakeﬁeld, 2002). In comparisons of CAR and fully-speciﬁed covariance mod-
els there appears to be diﬀerent conclusions about which are more useful in
recovering relative risk in disease maps (Best et al., 2005; Henderson et al.,
2002).

Disease Map Reconstruction and Relative Risk Estimation
91
FIGURE 5.5
Code for a convolution model with both UH and CH components. CAR model
used for the CH component. The posterior expected exceedence probability
( 
Pr(θ > 1)) is computed in PP[]. An approximation ot the SMR is also com-
puted.
5.5
Convolution Models
Often it is important to employ both CH and UH random eﬀects within the
speciﬁcation of ηi. The rationale for this lies in the basic assumption that
unobserved eﬀects within a study area could take on a variety of forms. It is
always prudent to include a UH eﬀect to allow for uncorrelated extra variation.
However, without prior knowledge of the unobserved confounding, there is no
reason to exclude either eﬀect from the analysis and it is simple to include both
eﬀects within an additive model formulation such as ηi = vi + ui. In general,
these two random eﬀects are not identiﬁed, but given that we are usually
interested in the total eﬀect of unobserved confounding then the sum of the
eﬀects is the important component and that is well identiﬁed. Discussion of
these identiﬁability issues is given in Eberley and Carlin (2000). Occasionally,
the computation of the relative variance contribution (intraclass correlation)
can be useful. If the variance of the UH and CH component are, respectively,
κv and κu, then this is just given by
κv
κv+κu . Of course if these components are

92
Bayesian Disease Mapping
(136) < 2.5
(12)   2.5-5.0
(3)     5.0-7.5
(5)     7.5-10.0
(1)     10.0-12.5
(2)     >=1 2.5
(68) <0.0
(80) 0.0-5.0
(8)   5.0-10.0
(2)   10.0-15.0
(0)   15.0-20.0
(1)   >=20.0
N
(1)   < –5.0
(11) –5.0-–2.5
(61) –2.5-0.0
(79) 0.0-2.5
(7)   >= 2.5
(98) < 0.5
(49) 0.5-0.9
(5)   0.9-0.95
(5)   0.95-0.99
(2)   >=0.99
N
N
N
FIGURE 5.6
Georgia county level mortality counts: oral cancer 2004. Convolution model
with UH and CH eﬀects. County-wise expected rate computed from the state-
wide oral cancer rate 2004: row-wise from top left: standardized mortality
ratio; posterior expected relative risk estimates; correlated random eﬀect (CH)
ui ; posterior expected exceedence probability ( 
Pr(θi > 1)).
not identiﬁed then this computation will not be useful. In Figures 5.5 and 5.6,
the ODC and some selected output from a convolution model for the Georgia
oral cancer data are presented.
Convolution models with CAR CH random eﬀects have been shown to
be robust under simulation to a wide range of underlying true risk models
(Lawson et al., 2000) and so are widely used for the analysis of relative risk
in disease mapping.
5.6
Model Comparison and Goodness-of-Fit Diagnostics
Relative goodness-of-ﬁt (gof) measures such as DIC or PPL can be applied to
compare diﬀerent models for the Georgia Oral Cancer dataset. Here I focus
on the use of DIC and MSPE measures previously deﬁned in Section 4.1.
in relation to WinBUGS use. Within WinBUGS the DIC is available directly.

Disease Map Reconstruction and Relative Risk Estimation
93
TABLE 5.1
Comparison of convolution and uncorrelataed heterogeneity
models for the Georgia oral cancer dataset
Measure
Convolution model
UH model
DIC
422.68
383.30
pD
97.2
77.6
MAPE
0.9
0.818
MSPE
5.557
2.763
For posterior predictive loss it is possible to compute a measure based on
values generated from the predictive distribution {ypred
i
} and compare these
to the observed data via a suitable loss function. For binary data an absolute
value loss is useful as it measures the proportionate misclassiﬁcation under
the model. For positive outcomes (such as Poisson or binomial data) often a
squared error loss is used, although the absolute value loss may also be useful.
In general the computation involves the averaging of the loss (f) over the data
and posterior sample (of size G):
MSPE =

j
m

i
f(yi −ypred
ij
)/(m × G).
(5.20)
In the case of a Poisson likelihood, the following lines in an ODC, which
produce squared error loss for each observation, compute a point-wise PPL:
ypred[i] ∼dpois(mu[i])
PPL[i] < −pow(ypred[i] −y[i], 2).
Both the individual values of
PPLi =

j
f(yi −ypred
ij
)/G
(5.21)
and the average over all the data (5.20) can be useful in diagnosing local and
global lack-of-ﬁt. As a comparison between the convolution and UH models we
have computed the DIC, MAPE (absolute error) and MSPE (squared error)
for both models. Table 5.1 below displays the results. Overall the UH model
seems to yield lower DIC and is lower on both the absolute and squared
error loss. Note that the DIC criterion measures how well the model ﬁts the
observed data, allowing for parameterization, while the PPL criteria compare
the predictive ability of the models.
Figure 5.7 displays the point-wise PPL for squared error and absolute error
loss for the Georgia Oral cancer mortality dataset under the convolution and
UH models. The maps suggest a marked concentration of loss in a few regions
in the northwest of the state (Fulton, Cobb, Dekalb, and Gwinett). Fulton

94
Bayesian Disease Mapping
county contains the largest urban area in the state (Atlanta), and shows the
highest PPL under both squared error and absolute error. Note that under
the better-ﬁtting UH model the loss in most areas is lower than under the
convolution model.
5.6.1
Residual Spatial Autocorrelation
While models for disease maps can be assessed for global ﬁt and also at the
individual unit level via residual diagnostics, there remains the question of
whether any residual spatial structure has been left within the data after a
model ﬁt. One approach to this is to consider that a good model ﬁt should
leave residuals from the ﬁt with little or no spatial correlation. Hence a test
for spatial correlation in the residuals from a model ﬁt would be a useful
guide to whether the model has managed to account for the spatial variation
adequately. It is possible within a posterior sampling algorithm to compute
a measure of spatial autocorrelation and to average this in the ﬁnal sample.
This will provide an estimate of the correlation and the sample will also pro-
vide a credible interval or standard deviation of the estimate. In this way it is
possible to avoid the need to consider the sampling distribution of the com-
puted statistic, by using functionals of the posterior distribution via posterior
sampling.
Various statistics could be used to measure autocorrelation but probably
the commonest spatial autocorrelation statistic is Moran’s I (see e.g., Cliﬀ
and Ord, 1981; Cressie, 1993, Section 6.7). This is usually deﬁned as a ratio
of quadratic forms:
I = e′We/e′e
where e = {ei, ...., em} and ei = (yi −yi)/

var(yi) and W is the 0/1 m × m
adjacency matrix for the regions with elements wij. For a Poisson data model
this residual could be deﬁned as ei = (yi −μi)/

μi. Congdon et al. (2007)
following Fotheringham et al. (2002), noted that given {ei} and a set of 0/1
adjacencies {wij} then a regression of ei on e∗
i where e∗
i = 
j wijej will yield
a slope parameter that is an estimate of I. That is, ﬁtting the linear model
ei = a0 +ρe∗
i +ϵi will yield the posterior average of ρ as an estimate of I. The
WinBUGS code for this is given below. In this code the cumulative number
of neighbors up to the ith data point is deﬁned as cum[] with the convention
that cum[1] = 0. Values of cum[] are used as an index to select neighboring
residuals. In the following, y[] is the outcome and mu[] is the mean (assuming a
Poisson data model), e[] is the residual and estar[] is the sum of the neighboring
residuals, adj[] is the adjacency list for the regions, and sumNN is the sum of
the number of neighbors:
for (i in 1:m){
.
y[i]˜dpois(mu[i])
.
e[i]<-(y[i]-mu[i])/sqrt(mu[i])

Disease Map Reconstruction and Relative Risk Estimation
95
(154) <
25.0
(4)
25.0 -
50.0
(0)
50.0 -
75.0
(0)
75.0 -
100.0
(0)
100.0 -
125.0
(1) >= 125.0
N
(144) <
2.0
(13)
2.0 -
4.0
(1)
4.0 -
6.0
(1) >=
6.0
N
(151) <
10.0
(4)
10.0 -
20.0
(3)
20.0 -
30.0
(0)
30.0 -
40.0
(1) >=
40.0
N
(144) <
2.0
(14)
2.0 -
4.0
(0)
4.0 -
5.0
(1) >=
5.0
N
FIGURE 5.7
Georgia county-level oral cancer mortality 2004. Top row: CH model, bottom
row: UH model. Point-wise posterior predictive loss for squared error loss (left
panel) and absolute error loss (right panel), averaged over a converged sample
of size 10000.

96
Bayesian Disease Mapping
estar[i]<-sum(we[cum[i]+1:cum[i+1]])
de[i]<-e[i]-mean(e[])
d.estar[i]<-estar[i]-mean(estar[])
dt[i]<-de[i]*d.estar[i]
db[i]<-pow(d.estar[i],2)}
.
for (j in 1: sumNN) {we[j,i]<-e[adj[i]]}
.
rho<-sum(dt[])/sum(db[])
For the 2004 Georgia oral cancer mortality data with a ﬁtted convolution
model in Section 5.5 (see e.g., Figure 5.6), I have computed the posterior
average Moran’s I. In this case, the result is ρ = 0.0018 (sd: 0.0334) with
95% credible interval: (-0.0692, 0.0613), which suggests that there is limited
autocorrelation left after ﬁtting the convolution model.
5.7
Alternative Risk Models
In Sections 5.4 and 5.4.2 models for risk variation were discussed which are
most commonly found in applications. However there are a number of alter-
native modeling approaches that are less commonly applied but which might
be of considerable use in certain applications. The ﬁrst of these utilizes a like-
lihood approximation (pseudolikelihood) that was ﬁrst suggested by Besag
(1975). The second is a relaxation of the parametric assumptions inherent in
the 2nd level prior speciﬁcations for the covariance and convolution models.
5.7.1
Autologistic Models
Besag (1975) ﬁrst suggested the possibility of modeling spatially-distributed
continuous variables via a conditioning on neighborhoods. Instead of consider-
ing the full conditional distributions within a likelihood function, a likelihood
was proposed that is simply a product of the local conditioning within a
neighborhood. Hence, for a count data example with {yi} observed within m
arbitrary small areas we examine the Pr(yi|{yj}j∈δi|θ) where j ̸= i and δi is
a neighborhood of the i th small area. The pseudolikelihood is then simply
assumed to be given by
Lp({yi}|θ) =
m

i=1
Pr(yi|{yj}j∈δi|θ).

Disease Map Reconstruction and Relative Risk Estimation
97
This likelihood can take a range of simple forms when speciﬁc parameteri-
zations are assumed for Pr(yi|{yj}j∈δi|θ). For example, the commonest and,
possibly, most widely used example, is where the outcome in the small areas
is binary, so that yi takes the value 1/0. In this case,
Pr(yi|{yj}j∈δi|θ) = θyi
i (1 −θi)1−yi
and θi =
exp{αi + λSδi}
1 + exp{αi + λSδi}
and Sδi =

j∈δi
yj.
Hence the likelihood is simply:
Lp({yi}|θ) =
m

i=1

 [exp{αi + λSδi}]yi
1 + exp{αi + λSδi}

.
Notice that this form simply conditions on the sum of neighboring val-
ues and as this sum can be precomputed before analysis, this model could
be ﬁtted using conventional logistic regression software. One simple exten-
sion to this model is to include covariates via a linear predictor. Hence,
θ =
exp{λSδi+x′
iβ}
1+exp{λSδi+x′
iβ} could be speciﬁed, where x′
iβ is a linear predictor with
row vector of i th covariate values x′
i and parameter vector β. Alternatively,
covariate representation which is centered could be advantageous (Caragea
and Kaiser, 2006). Similarly the model could be extended to include random
eﬀects. For example, we could include uncorrelated unit level random eﬀects
(νi) within the logit term:
θi =
exp{λSδi + x′
iβ + νi}
1 + exp{λSδi + x′
iβ + vi}.
(5.22)
In the Bayesian context, logit θi = λSδi + x′
iβ + νi can be treated as other
spatial models in that both covariates and random eﬀects can be present. Both
the parameter vector β, λ and random eﬀect νi (in example 5.22) will have
prior distributions at the second level of the hierarchy. Further hyperprior
speciﬁcations would also be available.
Note that this likelihood includes spatial correlation at the ﬁrst level of the
hierarchy. Hence it does not require the inclusion of any spatially-structured
random eﬀect at the second level of the hierarchy. Modiﬁcations to the model
where further spatial components describing 2nd or higher order dependence
could be made. For example, Sδi = ω

j∈δi
yj +(1−ω)

l∈δ2i
yl where δ2i is a 2nd
order neighborhood (such as neighbors of ﬁrst order neighbors, once counted)
and ω is a weighting parameter with 0 < ω < 1. This would allow for some
measure of distance-related dependence in the model. Note that Sδi cannot
be precomputed unless ω is ﬁxed, but the sums:

j∈δi
yj, and

l∈δ2i
yl, can be.

98
Bayesian Disease Mapping
TABLE 5.2
DICs for three models: autologistic with no randon eﬀects; autlogistic
with UH component; convolution model with UH and CH
Model
pD
DIC
MSPE
Autologistic
1.97
112.18
0.4268(0.0503)
Autologistic+UH
25.16
109.04
0.3142 (0.0525)
Convolution (UH+CH)
27.69
103.98
0.2844 (0.0515)
An example of the application of an autologistic model and comparison
with a conventional random eﬀect model is demonstrated in Figure 5.8 and
5.9. Here, the Ohio county level respiratory cancer mortality data set (1968) is
examined. The expected rates were computed from the statewide age-gender
stratiﬁed rate applied to count population strata and summed. The county
level standardized mortality ratios (smri) of respiratory cancer for the year
1968 are available in the form of an exceedence indicator. The standardization
was performed using the state-wide rate for 18 age-gender groups for that year.
The data was made available as a dichotomized variate via the criteria:
yi =

1 if smri > 2
0 otherwise .
Interest focusses on the analysis of high risk status and hence on this binary
outcome at the county level. Of course, the arbitrary dichotomization may
lead to concerns about use of artiﬁcial screening levels, and this indeed should
be a consideration in any analysis where thresholding has taken place. Of
course, when data is only available dichotomized then it is appropriate to
seek to model it directly. In Figure 5.8, the contrast between the posterior
expected estimates under the simple autologistic model (top row), which are
relatively uniform, and the probability of risk exceedence and UH component
(vi) (bottom row) demonstrate that there are 4 regions of elevated risk. When
the convolution model with UH and CH components is ﬁtted, as shown in
Figure 5.9, it is clear that the areas of elevated risk are further highlighted
and indeed the CH component seems to isolate the south eastern corner of
the state as a particularly elevated region.
The diﬀerence in DIC is less marked between the diﬀerent models in this
case. Table 5.2 displays the DIC results for the diﬀerent models. In this case,
both the autologistic model with UH and the standard convolution model
appear to yield better models than the simple autologistic. Interestingly, the
convolution model yields a lower DIC than both autologistic models. However,
the autologistic model with uncorrelated heterogeneity, is much closer to the
DIC of the convolution model and is more parsimonious.

Disease Map Reconstruction and Relative Risk Estimation
99
(27) < 0.2
N
(1)   >= 0.7
(18) 0.2-0.3
(13) 0.3-0.4
(9)   0.4-0.5
(9)   0.6-0.7
(11) 0.5-0.6
(1)   < –1.0
(16) >= 1.0
(24) –1.0- –0.5
(33) –0.5-0.0
(0)   0.0-0.5
(14) 0.5-1.0
N
N
(0)   < 0.2
(0)   >= 0.7
(43) 0.2-0.3
(18) 0.3-0.4
(17) 0.4-0.5
(7)   0.5-0.6
(3)   0.6-0.7
FIGURE 5.8
Autologistic model with a single binary covariate and a ﬁrst order dependence
on the sum of neigboring values. Top row: posterior expected probability of
smr exceedence (>2); bottom row: same model but with a county level het-
erogenity random eﬀect (vi): UH. left: posterior expected probability of smr
exceedence and, right: posterior expected UH component.
For this example, models with both ﬁrst order and second order neighbor-
hoods were examined, but overall the best model remained the ﬁrst order
neighborhood based on DIC.
Note that the diﬀerence between the autologistic model and convolution
model lies mainly in the fact that the spatial correlation is at diﬀerent lev-
els of the hierarchy and that the likelihood used for the autologistic model
is a pseudolikelihood. Pseudolikelihoods are known to be reasonable approx-
imations where spatial correlation is not strong. In space-time, autologistic
models can also be considered (see Chapter 11).

100
Bayesian Disease Mapping
(0)   < –1.0 
(7)   >= 1.0 
(19) –1.0-–0.5 
(39) –0.5-0.0
(0)   0.0-0.5
(23) 0.5-1.0
(3) < –1.0 
(12) >= 1.0 
(26) –1.0-–0.5 
(19) –0.5-0.0
(12) 0.0-0.5
(16) 0.5-1.0
(29) < 0.2
(16) 0.6-0.7
(0)   >= 0.7
(21) 0.2-0.3 
(8)   0.3-0.4
(7)   0.4-0.5
(7)   0.5-0.6
N
N
N
FIGURE 5.9
Standard binary convolution model with a UH and CH CAR componenent.
Top row: posterior expected probability of smr exceedence; bottom row: left:
UH component; right: CH component.
5.7.1.1
Other auto models
Besides the autologistic model, it is possible to consider other auto models
based on Poisson, binomial, negative binomial, or other exponential family dis-
tributions. Usually pseudolikelihood must be used for estimation as normaliz-
ing constants are intractable. In addition, in some cases, the parameterization
of the model must be constrained. In the auto-Poisson model, the most general
form of the intensity is deﬁned, for the i th region, as λi = exp(αi +
m

j=1
ηijyj)
and so constraints must be put on the ηijs to ensure negativity. In the case of
the autobinomial, the logit of the probability of a case in the i th area is an un-
normalized function of the surrounding case totals (rather than proportions):

Disease Map Reconstruction and Relative Risk Estimation
101
logit pi = αi +
m

j=1
ηijyj. Of the range of auto models available it is clear
that the autologistic is the most popular in applications and likely to be the
simplest to implement and interpret.
5.7.2
Spline-Based Models
As an alternative to strictly parametric models, it is possible to assume a semi-
parametric approach to the modeling of the spatially-structured component
of a disease risk model. The use of spline models is of course not limited to
employment in spatial smoothing, but I will concentrate on that aspect here.
The basic idea behind a semi-parametric representation of a spatial model
is the assumption of a smoothing operator to represent the mean structure
of the process. In the case event situation, assuming that a control disease
realization is available, we could specify a conditional logistic model with
pi =
exp(ηi)
1 + exp(ηi)
with ηi = x′
iβ + S(si)
where x′
iβ is a linear predictor, and S(si) is a smoothing operator at the geo-
reference si (location) of the i th observation. Kelsall and Diggle (1998) give
an example of using this generalized additive model (GAM) methodology to a
cancer mortality example. Here, focus will be given to the count data situation
although many of the issues found there also apply to case vent data.
In the count data situation, make the usual assumption of observed data
{yi}, i = 1, ..., m and yi ∼Poisson(μi). Further deﬁne the geo-reference for
i th observation as si : (xi1, xi2). This could be a centroid of the small area or
other associated point reference. Here it is assumed that logμi = S(si) where
S(.) will be deﬁned as smoothing operator. A variety of choices are available
for S(.). Here, I focus on spline models which are attractive in applications
and have strong links to Gaussian process models (see e.g., French and Wand,
2004). Deﬁne the mean level as
log μi = α0 +
2

j=1
αjxij +
nκ

j=1
ψjC{||si −κj||}
= x′
iα + z′
iψ,
where {κj}, j
= 1, ..., nκ is a set of knots (ﬁxed locations in space),
{ψj} is a Gaussian random eﬀect, z′
i = {z1,....., znκ} and z = [C{||si −
κj||/ρ}]1≤i≤m, 1≤j≤nκ, the covariance function deﬁned here as
C{a} = (1 + |a|)e−|a|.
Deﬁne the square matrix
ω = [C{||κi −κj||/ρ}]1≤i,j≤nκ

102
Bayesian Disease Mapping
and the joint random eﬀect prior distribution as
ψ ∼N(0,τω−1).
A reparameterization of z∗= zω−1/2, ψ∗= ω1/2ψ yields a linear mixed
model with with cov(ψ∗) = τI, and then log μi = x′
iα + z∗iψ∗. In French and
Wand (2004), the value of ρ is ﬁxed in advance. This allows the precomputing
of the covariance matrix and reparameterization so that standard software can
be used. This type of spline modeling is termed low rank Kriging. In general, it
would be useful to estimate ρ as this controls the degree of smoothing. Figures
5.10 and 5.11 display the resulting posterior expected (PE) estimate maps for
the two models. In Figure 5.11 the PE relative risk and CH component are
shown. The model ﬁtted to the log relative risk included a planar trend in
the x, y centroids as well as additive UH and CH components. For the spline
model for comparability, the log relative risk was also a function of planar
trend in centroid locations but an additive spline term was also included. The
covariance was assumed to be deﬁned by ω = [C{||κi −κj||/ρ}]1≤i,j≤nκ where
ρ was ﬁxed at ρ = max(||si −sj||) ∀i,j. This tends to produce a very smooth
surface eﬀect as can be seen in the Figure 5.11 where the top panel shows the
PE relative risk with a much reduced range. The bottom panel displays the
spline eﬀect which include both spatial and non-spatial eﬀects (beyond the
trend component). Overall, the relative risk pattern is mostly similar between
the two models. However, in this case the spline model did not provide a good
model based on DIC. The DIC for the spline model was 761.52. Whereas for
the convolution model it was 623.15. Of course, if ρ were to be estimated
then it is possible that a much improved ﬁt could be achieved. Alternative
spline-based approaches have been proposed by Zhang et al. (2006) to spa-
tiotemporal multivariate modeling, and by Macnab (2007) in a comparison of
spline methods for temporal components of spatial maps.
5.7.3
Zip Regression Models
If a disease is rare, then there will be considerable sparsity in the data. The
implication of this is that few cases are observed within the study area, or,
for small areas, zero counts are common. In this case, the spatial distribution
of cases will often form isolated clusters. A good example of this is childhood
leukemia which is a rare disease but is known to cluster. The major question
that is posed by this situation is whether the standard models for disease
mapping hold when such sparsity of data arises. A priori the conventional log
relative risk model where the log of the risk is modeled with Gaussian eﬀects
may be simply inadequate to deal with a situation where the rate is close
to the boundary of its space (i.e., λ0(s) ≃0, or the expected rate ei ≃0).
Singular information methods may be useful here (see e.g., Bottai et al., 2007).
Two alternatives can be immediately envisioned. First it may be possible to
directly model the locations of the disease clusters via object models (Lawson

Disease Map Reconstruction and Relative Risk Estimation
103
(6) < 0.5
(53) 0.5-1.0
(26) 1.0-1.5
(3) >= 1.5
(10) < –0.01
(31) –0.01-0.0
(38) 0.0-0.01
(9) >= 0.01
N
N
FIGURE 5.10
CAR model ﬁt for Ohio county level respiratry cancer mortality 1979. Model
includes a planar trend in centriods and both a UH and CH (CAR) component.
Top row: posterior expected relative risk; bottom row: CH component.

104
Bayesian Disease Mapping
FIGURE 5.11
Spline model ﬁt based on the low rank Kriging model as a linear mixed model
with a ﬁxed covariance parameter ρ (ρ = max(||xi −xj||) ∀ij) where xi is the
i th centroid.

Disease Map Reconstruction and Relative Risk Estimation
105
and Denison, 2002). These models do not make simple global assumptions
about surface form, but rather seek to estimate locations of objects (in this
case clusters). As it turns out these models can recover risk surfaces reasonably
well. Examples of this are found in Lawson (2006b), Section 6.5. An alternative
is to consider the marginal distribution of the concentration of cases. In the
sense that any arbitrary area or mesh area will yield a local concentration of
cases, it might be noted that under sparsity, many areas will have zero cases
and a few will have small positive numbers. For count data in arbitrary regions
this could lead to an overdispersed distribution and even multi modality in
the marginal distribution. Note that this eﬀect in count data may not be
adequately modeled by an overdispersed distribution such as the negative
binomial.
One solution is to consider a mixture of processes so that the low intensity
is separately modeled from the peaks. For case event data we could assume
λ(s) = λ0(s)[w(s) + (1 −w(s))λ1(s)]
where w(s) is spatially dependent weight which controls which process is domi-
nant locally. This can lead to a logistic model when a control disease realization
is present in that, the probability of a given location si being a case is:
w(si) + (1 −w(si))λ1(si)
1 + w(si) + (1 −w(si))λ1(si)
Hence it may be interesting to include covariates or other eﬀects within
both w(si) and λ1(si). I do not pursue this approach here. Instead I will focus
on the area of small area count data.
There is much literature on mixture modeling for sparse counts (Lambert
(1992), Boehning et al. (1999), Agarwal et al. (2002), Ghosh et al. (2006)
amongst others). When a mixture of Poisson distributions is considered the
simplest case is a two component mixture where zero counts have a component
1 −p + p exp(−μ)
where μ is the Poisson mean and non-zero counts have
component p exp(−μ).μy/y!. In general the distribution is given by
f(y; p|μ) = (1 −p)P0(y, 0) + pP0(y, μ)
where P0(y, μ) is the Poisson distribution with mean μ. The inclusion of co-
variates can proceed as usual via link to the mean (e.g., μ = exp(x′β)). In
addition, covariates can be included in the mixture weight (p). For example
we could have
p =
exp(w′γ)
1 + exp(w′γ).
where w′γ is a predictor with additional covariates and eﬀects. In general,
for observed data {yi}, i = 1, ..., m and expected counts {ei} the model is
speciﬁed
[yi|ei, θi] ∼(1 −p)Pois(0) + pPois(ei.θi).
(5.23)

106
Bayesian Disease Mapping
(157) < 10.0
(1) 10.0  -  20.0
(0) 20.0  -  30.0
(1) >=   30.0
(12) < 1.0
(144) 1.0  -  1.5
(2) 1.5  -  2.0
(1) >=   2.0
(2) < –0.2
(111) –1.0  -  0.0
(2) 0.0  -  0.2
(8) >=   0.2
(1) < 0.875
(3) 0.875  -  0.9
(4) 0.9  -  0.925
(39) 0.925  -  0.95
(55) 0.95  -  0.975
(57) >=  0.975
N
N
N
N
FIGURE 5.12
ZIP Bayesian model with two components applied to the Georgia asthma
mortality data for 2000. Row-wise from top left: posterior expected Poisson
mean, relative risk, component probability, and uncorrelated heterogeneity
(UH).
A further modiﬁcation clariﬁes the role of the components. For example,
we might consider that this problem is one where an unobserved classiﬁcation
variable treats the zeroes as structural (z = 1) or usual Poisson (z = 0). In
this case z is unobserved and must be estimated. This can be done within a
data augmentation loop. In that case, the incomplete data likelihood is
[yi|ei, θi, zi = 0] ∼Pois(ei.θi)
(5.24)
[yi|ei, θi, zi = 1] ∼Pois(ei.θ∗
i ).
Then the second stage would be to generate the allocation variables from
[zi|yi, ei, {θi, θ∗
i }]. Usually [zi|yi, ei, {θi, θ∗
i }] ∼Bern(pi) for two components.
The complete data likelihood (Marin and Robert (2007)) used to estimate the
parameters would be
L({yi}, z) =
m

i=1
pziPois(yi;ei.θzi).
Figure 5.12 displays a ZIP regression analysis for the Georgia county level
asthma mortality counts for the year 2000. The posterior average relative risk

Disease Map Reconstruction and Relative Risk Estimation
107
estimates for high and low risk counties 1 and 144 (crude SMR = 3.85, 0.0)
and the posterior average relative risk estimates is, 1.322, and 0.573 under
a converged convolution model, whereas under a two component ZIP model
(5.23), with no spatially-correlated component, the posterior expected esti-
mates of relative risk were 1.818, 1.094. Although these estimates seem to
have similar ranges, the latter model has shifted both estimates away from
zero. Interestingly, in both models the Atlanta area appears to yield a very
high posterior average relative risk estimate, and also a high probability of
membership in the full Poisson model. The ZIP model did not include a CH
component unlike the convolution model. Some residual structure remains as
evidenced by the posterior expected UH map.
Finally, it should be apparent that the idea of mixtures of components can
be generalized to a wide variety of situations. The primary area of application
may be the incorporation of (unobserved) multiple scales of aggregation within
one analysis when it is believed that diﬀerent components represent these
diﬀerent scales. This is discussed more extensively in Chapter 8.
5.7.4
Ordered and Unordered Multicategory Data
A special case arises when the outcome of interest is in the form of a multiple
category. I previously discussed binary data as a special case of binomial data
and in autologistic models (Sections 5.1.3 and 5.7.1). Extending this criteria
to categorical outcomes where the levels of outcome can be > 2, there now
arises the possibility of ordinal or nominal analysis. When the categories are
ordered, such as disease stages, then ordinal (logistic) regression models can
be assumed. If ordering is not apparent then nominal (logistic) models could
be applied. Many of the concerns and issues cited in previous sections apply
here with respect to use of random eﬀects and prior distributional speciﬁca-
tion. One added issue with multi-category outcome data is whether diﬀerent
structures could be allowed at diﬀerent levels of the category. For example,
commonly available within cancer registry data is the stage at diagnosis of the
cancer. This staging of the cancer is usually an ordered category. This would
lead to consideration of an ordinal model. However, unstaged cancers are in-
determinate in terms of stage, and so it is unclear at what level they would
be best considered. This might lead one to either assume a nominal model for
all the staged data or to exclude the unstaged from an ordinal analysis. Zhou
et al. (2007) demonstrate the application of ordinal models: baseline category
logits, proportional odds and adjacent category logits, to cancer registry data
in South Carolina. They found that baseline category logits model ﬁtted best
in terms of DIC, and that a model with a spatially-correlated random eﬀect
for the regional-stage and an uncorrelated random eﬀect for the distant stage
of the cancer was best ﬁtting in this case.

108
Bayesian Disease Mapping
5.7.5
Latent Structure Models
An alternative to conventional modeling of the mean level of risk is to consider
that the risk is composed of a combination of unobserved risk levels. These
risk levels are latent and so there is no directly observed data concerning their
form. These types of models really fall between areas. On the one hand, they
are used to provide overall eastimates of relative risk (and so are relative risk
models). On the other hand, they are also used to isolate underlying patterns
of risk and so the latent risk levels may be of importance. Some of the models
discussed in the Chapter 6 could be regarded as latent structure models also.
For example, the hidden process/object models can be used to provide relative
risk estimates, besides estimates of cluster locations (see e.g., Lawson, 2006b,
Section 6.5.3). The hidden Markov models of Green and Richardson (2002)
provide estimates of relative risk as do the mixture component models of
Fernandez and Green (2002). Partition-based models can also be considered
in this way. Here we provide a brief summary of spatial component models
both latent and known. In Section 11.3.2, a brief review of space-time latent
models is given.
5.7.5.1
Mixture models
A number of examples of mixture-based models have been proposed for rela-
tive risk estimation. Often these have been applied to count data and so the
following discussion focusses on that data form. First of all, ﬁxed component
mixtures have been proposed. A simple example of these would in fact be
ZIP regression. More generally, in a Bayesian context, one can consider ﬁxed
component models that consist of sums of random terms within the mean
predictor. These models could be termed mean mixture models. The convo-
lution model of Section 5.5 is a mean mixture with 2 ﬁxed components. An
extension of this type of model was proposed by Lawson and Clark (2002)
where a mean mixture of a CAR component and an L1 norm component was
used to preserve discontinuities and boundary eﬀects (see also Congdon, 2005,
Ch. 8). The mixing parameter was allowed to vary spatially and so a posterior
expected mixing ﬁeld was estimated. The basic model speciﬁcation was
[yi|eiθi] ∼Poiss(eiθi)
log(θi) = vi + wiu1,i + (1 −wi)u2,i
wi ∼beta(α, α)
and u1,i and u2,i are CAR and L1 norm spatial prior distributions respectively
and vi ∼N(0, τv). The mixing parameter {wi} was allowed to vary spatially,
albeit with a common exchangeable distribution, and so a posterior expected
mixing ﬁeld could be estimated. Figure 5.13 displays the posterior expected
components of the three-component mixture ﬁtted to North Carolina sudden
infant death syndrome (SIDS) data. The L1 norm ﬁeld appears quite diﬀerent
from the CAR component ﬁeld (which seems to display a west–east trend).

Disease Map Reconstruction and Relative Risk Estimation
109
FIGURE 5.13
Three- component mixture model for SIDS in North Carolina (as reported in
Lawson & Clark, 2002). Rowwise from top left: u1,i component, vi component,
u2,i component, and wi component. Posterior averages reported.
Each ﬁeld provides unique information concerning the diﬀerent components
of the model supported in the data.
In general an extended mixture of ﬁxed random components could be imag-
ined each with diﬀerent prior assumptions.
An early example of hidden mixture modeling, albeit in an empirical Bayes
context, was proposed by Schlattman and B¨ohning (1993). Their approach
assumed that the distribution governing the observed data is a mixture of
Poisson distributions:
f(yi|p, ei, θ) =
K

k=1
pkPois(yi|eiθk)
(5.25)
with mixing probabilities {pk} and

k
pk = 1. Both p and θ are unknown.
Suitable prior distributions for the components have to be speciﬁed. Besides
estimation of p and θ, it is possible to estimate the risk in each area from
posterior sampling based on
θi = 1
G
G

g=1
K

k=1
θg
kpg
kPois(yi|eiθg
k)/
K

k=1
pg
kPois(yi|eiθg
k)
(5.26)
for the case of ﬁxed K where a posterior sample of size G is taken. When K
is not ﬁxed then a prior distribution would have to be speciﬁed for K. For

110
Bayesian Disease Mapping
that case, (5.26) could be used with K replaced by Kg. The choice of prior
speciﬁcation under could be various. Clearly for the probabilities one could
use a Dirichlet distribution:
p ∼Dir(α)
where {αk}, k = 1, ...,K, while for the {αk} gamma prior distributions could
be speciﬁed. In addition, prior speciﬁcation for the {θk} could be based on
gamma distributions . For example,
θk ∼Ga(cka, a)
would yield a prior mean of ck. Suitable hyperprior distributions can be as-
sumed for the positive parameters ck.
An ordering constraint on the components may be required if K is not ﬁxed
if the components are to be identiﬁed. Posterior sampling for the ﬁxed K case
is straightforward. For the non-ﬁxed case, then a prior distribution must be
assumed for K. This is often a Poisson with ﬁxed rate, i.e., K ∼Poiss(d), or
a uniform distribution up to a ﬁxed maximum: K ∼U(1, Kmax).
When spatial dependence is to be included, one approach has been to as-
sume that, instead of a Dirichlet distribution for the weights, the weights have
a spatial dependence structure. Fernandez and Green (2002) suggest a variety
of models. One proposal, the logistic normal model, speciﬁes that
f(yi|p, ei, θ) =
K

k=1
pikPois(yi|eiθk)
pik = ηik(φ)/
L

l=1
ηil(φ)
where ηik(φ) = exp{xik/φ}
where {xik} is a set of spatially-correlated random ﬁeld components indexed
by the i th area, and φ is a spatial correlation parameter. The ﬁelds are given
proper CAR prior distributions to ensure propriety. The relative risk estimates
from posterior sampling are obtained via allocation of components.
A major alternative to these mixture type models are those that posit fac-
torial decomposition of the risk in each area. For multiple diseases only, where
yij is the observed count in the i th area and the j th disease, Wang and Wall
(2003) ﬁrst proposed a model where a spatial factor underlay the risk:
yij ∼Poiss(eijθij)
log(θij) = log(eij) + λjfi
where λjfi = log (θij/eij) and fi is the spatially-referenced common risk fac-
tor. It is further assumed that
f ∼N(0, Σ)

Disease Map Reconstruction and Relative Risk Estimation
111
with unit variance, Σij = exp(−dij/φ), and  fi = 0 for indentiﬁability. Sub-
sequently, Liu et al. (2005) extended the proposal to structural equation mod-
els. Of course, these approaches are not univariate, and there are a wide range
of dimension reduction possibilities when multivariate outcomes or multiple
predictors are included within models. I do not pursue this here. In Section
11.3.2, I examine the possibility of space-time latent modeling.
Another potentially useful development is the use of Dirichlet process (DP)
mixing models to provide more ﬂexible spatial structures (Ishwaran and
James, 2002, 2001; Gelfand et al., 2005; Griﬃn and Steel, 2006; Kim et al.,
2006; Duan et al., 2007; Cai and Dunson, 2008). In addition, there is a possibil-
ity that DP mixtures could provide a ﬂexible approach to variable dimension
modeling within clustering or variable selection scenarios.
5.8
Edge Eﬀects
The importance of the assessment of edge eﬀects in any spatial statistical ap-
plication cannot be underestimated. Edge eﬀects play a larger role in spatial
problems than in, say, time-series. Speciﬁcally, we deﬁne edge eﬀects as “any
eﬀect upon the analysis of the observed data brought about by the proximity
of the study area boundary.” The eﬀect of the edges of a study area are largely
the result of the eﬀects of spatial censoring. That is, the fact that observa-
tions outside the window are not observed and therefore cannot contribute
to analysis within the window. This mirrors the eﬀects of temporal censoring
in say, survival analysis, where, for example, the outcome for some subjects
may not be observed because the observation period has stopped prior to the
outcome appearing.
Of course, all censoring depends on the idea that observations are depen-
dent in some way. That is, the occurrence of observations outside the window
of observation relies on observations within the window. In the spatial case,
it is easily possible for individual disease response to relate to ‘missing’ ob-
servations outside the window. For example, it may be that an environmental
health hazard is located outside or, in the case of viral etiology, an infected
person or carrier is located outside. For diseases which have uncertain etiology,
it could be possible that factors underlying the incidence of the disease have
a spatial distribution that is spatially dependent and hence the disease inci-
dence reﬂects this structure even when individual responses are independent.
If, in addition, some unknown genetic etiology underpinned the disease inci-
dence, then if this has spatial expression, the incidence of disease could relate
to unobserved genetically linked subjects outwith the observation region.
In addition, such spatial censoring can aﬀect estimation procedures, even
when no explicit spatial dependence is proposed. For example, spatial

112
Bayesian Disease Mapping
smoothing methods, including geostatistical methods (Kriging), splines, or
convolution random eﬀect models, use data from diﬀerent regions of the ob-
served window in the estimation of risk at a location. Hence, if no correction
is pursued for this eﬀect at the edges, then some edge distortion will result. In
other cases parametric estimation may require the computation of averages of
values in neighborhoods of a chosen point. Hence, close to edges there could
be considerable distortion induced by missing neighbors. This edge problem
cannot only induce bias in estimation, but also tends to lead to considerable
increases in estimator variance at such locations, and hence to low reliability
of estimation. An example of the eﬀect can be seen immediately when a CAR
distribution is assumed. In that model, the conditional variance for the i th
area is deﬁned, in the notation of (5.18), as r/nδi. This dependence on the
number of neighbors (nδi) implies that, for a given r, a reduction of neighbor
number will increase the variance.
A number of methods have been proposed to deal with such edge eﬀects.
These methods have been in part developed within stochastic geometry, where
it is often assumed that the process under study is ﬁrst- and second-order sta-
tionary and isotropic (Ripley, 1988). These methods vary from (1) correction
methods applied to smoothers or other estimators, for example, using weights
relating to the proximity of the external boundary, (2) employing guard ar-
eas to provide external information to allow better boundary area estima-
tion within the window, (3) simulation of missing data outside the window
and iterative re-estimation or model ﬁtting. (The use of toroidal correction is
not usually appropriate in the analysis of disease incidence data, as it is not
usually appropriate to make the appropriate stationarity assumptions.) This
ﬁnal method has signiﬁcant advantages if used within iterative simulation
methods such as data augmentation Gilks et al., 1996; Tanner, 1996; Robert
and Casella, 2005; or general McMC algorithms, as the external data can be
treated as parameters in the estimation sequence.
An example of the degree to which edge eﬀects could aﬀect the application
of convolution models was examined under simulation by Vidal-Rodiero and
Lawson (2005). In that study, counties within a large multi-state region of the
US was examined and external county hulls were peeled from the observation
window to examine the eﬀect of diﬀerent neighborhood ‘depths’ on estimation.
Figure 5.14 displays the eﬀect of stripping out a sequence of hulls of small areas
around a central area. In the simulation study a large number if states within
central United States were amalgamated and the counties gathered into one
study area. Successive hulls of counties were then stripped and the eﬀect of
this stripping was noted.
The eﬀect of stripping on four diﬀerent models
(convolution (BYM), Poisson-gamma (PG), Poisson log normal (PLN), and
ﬁxed SMR (C)) was assessed. The six sets (6–11) are sets of internal regions
at diﬀerent depths where the relative risk was estimated. The outer sets of
counties (sets 1–5) were successively stripped. Four models were ﬁtted and
the diﬀerent set results are given in Figure 5.14. It is clear that sets close to
the sets close to the boundary (e.g., set 6 and 7) that is stripped show bigger
diﬀerences in average relative risk.

Disease Map Reconstruction and Relative Risk Estimation
113
0.020
0.018
0.016
0.014
0.012
0.010
0.008
0.006
0.004
0.002
0.000
1-0
2-0
3-0
4-0
5-0
Dfferences between steps
0.020
0.018
0.016
0.014
0.012
0.010
0.008
0.006
0.004
0.002
0.000
1-0
2-0
3-0
4-0
5-0
Dfferences between steps
0.020
0.018
0.016
0.014
0.012
0.010
0.008
0.006
0.004
0.002
0.000
1-0
2-0
3-0
4-0
5-0
Dfferences between steps
0.020
0.018
0.016
0.014
0.012
0.010
0.008
0.006
0.004
0.002
0.000
1-0
2-0
3-0
4-0
5-0
Dfferences between steps
0.020
0.018
0.016
0.014
0.012
0.010
0.008
0.006
0.004
0.002
0.000
1-0
2-0
3-0
4-0
5-0
Dfferences between steps
0.020
0.018
0.016
0.014
0.012
0.010
0.008
0.006
0.004
0.002
0.000
1-0
2-0
3-0
4-0
5-0
Dfferences between steps
C
PG
PLN
BYM
C
PG
PLN
BYM
C
PG
PLN
BYM
Set 6
Set 7
Set 8
Set 9
Set 10
Set 11
FIGURE 5.14
Model eﬀects of hull stripping: size sets of internal regions (sets 6–11)) with
four diﬀerent models (convolution (BYM), Poisson-gamma (PG), Poisson log
normal (PLN), and ﬁxed SMR (C)).
5.8.1
Edge Weighting Schemes and McMC Methods
The two basic methods of dealing with edge eﬀects are (1) the use of weight-
ing/correction systems, which usually apply diﬀerent weights to observations
depending on their proximity to the study boundary, and (2) the use of guard
areas, which are areas outwith the region which we analyze as our study region.
5.8.1.1
Weighting systems
Usually, it is appropriate to set up weights which relate the position of
the event or tract to the external boundary. These weights, {wi} say, can
be included in subsequent estimation and inference. Often the form will be
wi = f(di) where di is the distance to the boundary, from a ﬁxed point in a

114
Bayesian Disease Mapping
small area or in the case event situation from the case event itself. Another
alternative for small area data would be to use the length of boundary of the
small area in common with the study area boundary. In that case, one could
propose wi = f(li) where li is the common boundary length. For example, the
proportion of the total boundary length of the small area common with the
study boundary might be a useful measure. The weight for an observation is
usually intended to act as a surrogate for the degree of missing information at
that location and so may diﬀer depending on the nature and purpose of the
analysis. Some sensitivity to the speciﬁcation of these weights will inevitably
occur and should be assessed in any case study. More detail on suitable weights
can be found in Lawson (2006b, Ch. 5).
Deﬁning an indicator for closeness to the boundary for each area, when
in the tract count case, some external standardized rates are available, it is
possible to structure an expectation-dependent weight for a particular tract,
e.g., based on the ratio of the sum of all adjacent area expectations to the
sum of all such expectations within the study window. Other suitable weight-
ing schemes could be based on the proportion of the number of observed
neighbors.
Guard areas
An alternative approach is to employ guard areas. These
areas are external to the main study window of interest. These areas could be
boundary tracts of the study window itself or could be added to the window to
provide a guard area, in the case of tract counts. In the case of event situation,
the guard area could be some ﬁxed distance from the external boundary, Rip-
ley, 1988. The areas are used in the estimation process but they are excluded
from the reporting stage, as they will be prone to edge eﬀects themselves. If
boundary tracts are used for this, then some loss of information must result.
External guard areas have many advantages. First, they can be used with or
without their related data to provide a guard area. Second, they can be used
within data augmentation schemes in a Bayesian setting. These methods re-
gard the external areas as a missing data problem (see e.g., Little and Rubin,
2002, Ch 10).
5.8.1.2
McMC and other computational methods
It is usually straightforward to adapt conventional estimation methods to
accommodate edge-weighted data. In addition, if guard areas are selected and
observations are available within the guard area, then it is possible to proceed
with inference by using the whole data but selectively reporting those areas
not within the guard area. Note that this is not the same as setting wi = 0
for all guard area observations in a weighting system.
When external guard areas are available but no data are observed, resort
must usually be made to missing data methods. An intermediate situation
arises when in the tract count case some external standardized rates are avail-
able. In that case it is possible to structure an expectation-dependent weight

Disease Map Reconstruction and Relative Risk Estimation
115
for a particular tract, e.g., based on the ratio of the sum of all adjacent area
expectations to the sum of all such expectations within the study window.
This can be used as an edge-weight within such a weighting system. An ex-
ample of a study of diﬀerent edge remedies for count data can be found in
Lawson et al. (1999).
5.8.2
Discussion and Extension to Space–Time
In the situation where case events are studied, then if censoring is present and
could be important (i.e., when there is clustering or other correlated hetero-
geneity), it is advisable to use an internal guard area, or an external guard area
with augmentation via McMC. In cases where only a small proportion of the
study window is close to the boundaries and only general (overall) parameter
estimation is concerned, then it may suﬃce to use edge weighting schemes. If
residuals are to be weighted, then it may suﬃce to label the residuals only for
exploratory purposes.
In the situation where counts are examined, then it is also advisable to
use an internal guard area or external area with augmentation via McMC. In
some cases, an external guard area of real data may also be available. This
may often be the case when routinely collected data are being examined. In
this case, analysis can proceed using the external area only to correct internal
estimates. Edge weighting can be used also, and the simplest approach would
be to use the proportion of the region not on the external boundary. Residuals
can be labelled for exploratory purposes. The assumptions underlined in any
correction method are that the model be correctly speciﬁed and that it could
be extended to the areas not observed. In particular, it is questionable if
an adjustment can really be obtained when ignoring the information on the
outer areas. Edge-eﬀect bias should be less prominent when an unstructured
exchangeable model is chosen. Since each area relative risk would be regressed
toward a grand mean, the information lacking for the unobserved external
areas is very small compared to those from the observed areas. Of course,
such a simple model where common expectation is found is highly unlikely to
be a good model in this area.
Extending the edge-eﬀect problem to consideration of space-time data, the
situation is more complex as spatial edge eﬀects can interact with temporal
edge eﬀects. The use of sequential weighting, based on distance from time
and space boundaries, may be appropriate (Lawson and Viel, 1995). For tract
counts observed in distinct time periods only, the most appropriate method
is likely to be based on distance from time and space boundaries, although
it may be possible to provide an external spatial and/or temporal guard area
either with real data or via augmentation and McMC methods.
The use of augmentation methods can also be fruitfully employed in this
context. If the external areas are known, but information concerning the dis-
ease of interest is not available in these external areas, then it is possible
to regard such missing/censored data as parameters which can be estimated

116
Bayesian Disease Mapping
within an iterative sampling algorithm, such as an McMC algorithm. In ad-
dition, if partial information were known (for example the standardized rates
in the external areas), then we could condition these missing data count esti-
mates on the known information.
5.9
Exercises
5.9.1
Maximum Likelihood
To provide a back drop for the Bayesian analysis we present some basic results
for likelihoods from simple mapping models.
1) A state in the United States has m counties. Within these counties, births
and births with abnormalities are observed. The births with abnormalities
(Ba) are a subset of all births.
The probability that a birth in the i th region is a Ba is θi. Each birth has
an independent risk of being Ba. We observe {yi}, i = 1, ..., m Ba events in
the m counties and the total births in the m counties is {ni}.
a) A likelihood model for these data could be a binomial with probability
θi, as in (5.7) above. Explain why this is appropriate.
b) If we assume there is a common probability across all regions, show that
the maximum likelihood estimator of θi is given by, θ =
m

i=1
yi/
m

i=1
ni.
c) A logistic linear model results if we assume a logistic link between θi and
a linear predictor. For the model: θi = exp(β0)/{1 + exp(β0)}, show that the
maximum likelihood estimator of β0 , either directly or by invariance, is given
by
β0 = log

 Sy
Sn
/

1 −Sy
Sn

,
where Sy =
m

i=1
yi, Sn =
m

i=1
ni.
d) Show that the large sample standard error of β0 is given by
se(β0) =

Sy −S2
y/Sn
−1
2 .
2) Case event data is observed within a study area W . There are m events
in W and their locations are denoted by {si}, i = 1, ..., m. A realization of
control events is also available in the same window: {sj}, j = m+1, ...., m+n.
The conditional log-likelihood for these data can be written as:
l =
m+n

i=1
yiηi −
m+n

i=1
log[1 + exp(ηi)],

Disease Map Reconstruction and Relative Risk Estimation
117
where yi is now an indicator variable taking the value 1 for a case and 0 for a
control (see 5.6 above), and exp(ηi) = ρf(si; α) = exp(α0 −αdi) where di is
the distance from a ﬁxed point to the i th location and f(si; α) = exp(−αdi).
Assume we want to test for a distance eﬀect between the cases locations and
a ﬁxed point.
a) Show that under the null hypothesis H0 : α = 0 then the maximum
likelihood estimator of ρ is just m/n.
b) If you substitute this estimator into the likelihood above, a possible test
statistic to ﬁnd if distance is signiﬁcant is based on the ﬁrst derivative of the
likelihood WRT α. This is known as a score test statistic.
Show that under H0 : α = 0, the test statistic is given by:
m
m + n
⎡
⎣
m

i=1
di +
m+n

j=m+1
dj
⎤
⎦−
m

i=1
di
5.9.2
Poisson–Gamma Model: Posterior and Predictive
Inference
A random sample of size m from a Poisson distribution with parameter θ is
denoted x1, ....., xm. The parameter has a prior distribution:
g(θ) =

 λe−λθ
λ > 0
0
elsewhere
The posterior distribution of θ is given by:
P(θ|{xi}) =
βs+1
Γ(s + 1)θse−θβ
where β = m + λ, and Γ() is the gamma function and s =  xi, assuming λ
is ﬁxed.
Derive the prior predictive distribution Pr(x|x1, ....., xm) and hence ﬁnd
Pr(x > 2|x1, ....., xm) when λ = 2.
5.9.3
Poisson-Gamma Model: Empirical Bayes
For the Poisson likelihood model with gamma prior distribution deﬁned in
(5.10), the unconditional distribution of yi given a, b is negative binomial. This
is also the prior predictive distribution of yi. The marginalized log-likelihood
is given by
L(a, b) =

i

log Γ(yi + a)
Γ(a)
+ b log(a) −(yi + a) log(ei + a)

.

118
Bayesian Disease Mapping
This likelihood is free of {θi} and can be maximized to yield empirical Bayes
estimates of a, and b (Clayton and Kaldor, 1987). Show that this leads to
normal equations, which can be solved for a, and b:
bb
ba = 1
m

i
(yi+ba)
(ei+bb)
m

i
yi−1

j=0
1
ba+j + m log(b) −
m

i
log(ei + b) = 0.

6
Disease Cluster Detection
In the study of disease spatial distribution it is often appropriate to ask ques-
tions related to the local properties of the relative risk surface rather than
models of relative risk per se. Local properties of the surface could include
peaks of risk, sharp boundaries between areas of risk, or local heterogeneities
in risk. These diﬀerent features relate to surface properties but not directly to
a value at a speciﬁc location. Relative risk estimation (AKA disease mapping;
Chapter 5) concerns the ‘global’ smoothing of risk and estimation of true
underlying risk level (height of the risk surface), whereas cluster detection is
focussed on local features of the risk surface where elevations of risk or depres-
sions of risk occur. Hence it is clear that cluster detection is fundamentally
diﬀerent from relative risk estimation in its focus. However the diﬀerence can
become blurred, as methods that are used for risk estimation can be extended
to allow certain types of cluster detection. This will be discussed more fully
in later sections.
6.1
Cluster Deﬁnitions
Before discussing cluster detection/estimation methods it is important to de-
ﬁne the nature of the clusters and/or clustering to be studied.
There are a variety of deﬁnitions of clusters and clustering. Diﬀerent deﬁni-
tions of clusters or clustering will lead to diﬀerences in the ability of detection
methods. First it should be noted that sometimes the correlated heterogeneity
term in relative risk models is called a clustering term (see e.g., Clayton and
Bernardinelli, 1992). This implies that the term captures aggregation in the
risk and indeed this does lead to an eﬀect where neighboring areas having
similar risk levels. This is a global feature of the risk however, and also in-
duces a smoothing of risk. This begs the question of how we deﬁne clusters or
clustering: should it be a global feature or should it be local in nature?
Global clustering basically assumes that the risk surface is clustered or has
areas of like elevated (reduced) risk. An uncorrelated surface, on the other
hand, should display random changes in risk with changes in location and so
should both be much more variable in risk level and have few contiguous areas
of like risk. Figure 6.1 displays a comparison between an uncorrelated and
119

120
Bayesian Disease Mapping
FIGURE 6.1
Simulated examples of correlated (A) and uncorrelated surfaces. Simulation
using the R function GaussRF with mean 1.0.
correlated risk surface. In Figure 6.1 A: there are areas of elevated risk that
may qualify as clusters (by some deﬁnition). However, modeling the overall
clustering does not address their locations speciﬁcally. Hence this form of
clustering does not address localized behavior or the location of clusters per
se. This is often termed general clustering (Besag and Newell (1991)).
A general deﬁnition of a (spatial) cluster is: “Any spatially-bounded area
of signiﬁcantly elevated (reduced) risk.”
This is clearly very general and requires further deﬁnition. By ‘spatially-
bounded’ I mean that the cluster must have some spatial integrity. This could
be a neighborhood criterion such as “areas must be adjoining” or “at least
two adjoining areas must meet a criterion,” or could be deﬁned to have a cer-
tain type of external boundary (e.g., risk diﬀerences around the cluster must
meet a criterion). A simple criterion that is often assumed is that known as
hot-spot clustering. In hot spot clustering, any area or region can be regarded
as a cluster. This is due to the assumption of a zero neighborhood criterion,
i.e., no insistence on adjacency of regions within clusters. This is a convenient
and simple criterion and is often assumed to be the only criterion. It is com-
monly used in epidemiology (see e.g., Richardson et al., 2004). Without prior
knowledge of the behavior of the disease then this criterion is appealing. It
could be useful for preliminary screening of data, for example.
However, this hot spot deﬁnition ignores any contiguity that may be thought
to be inherent in relevant clusters. For example, it might be important that
clusters of a given threshold size be investigated. This threshold size could
be deﬁned as a minimum number of contiguous areas. Hence, only groups of

Disease Cluster Detection
121
contiguous regions of ‘unusual’ risk could qualify as clusters. On the other
hand, in the case of infectious diseases, it may be that a certain shape and
size of cluster are important in understanding disease spread.
In this chapter I will mainly consider three diﬀerent scenarios for clustering:
i.
Single region hot spot relative risk detection
ii.
Clusters as objects or groupings
iii.
Clusters deﬁned as residuals.
6.1.1
Hot Spot Clustering
Hot spot clustering is often the most intuitive form of clustering and may be
the that which most public health professionals consider as their deﬁnition.
In hot spot clustering, any area or region can be regarded as a cluster. This is
due to the assumption of a zero neighborhood criterion, i.e., no insistence on
adjacency of regions within clusters. Simply, any area displaying “excess” or
“unusual” risk, by some criterion, is a hot spot. This is a relatively nonpara-
metric deﬁnition.
6.1.2
Clusters as Objects or Groupings
Clustering might be considered to be apparent in a data set when a speciﬁc
form of grouping is apparent. This grouping would usually be predeﬁned.
Usually the criterion would also have a neighborhood or proximity condition.
That is, only neighboring or proximal areas (which meet other criteria) can
be considered to be “in a cluster.” Hence some parametric conditions must be
met under this deﬁntion.
6.1.3
Clusters Deﬁned as Residuals
Often it is convenient to consider clusters as a residual feature of data. For
example, lets assume that yi is the count of disease within the i th census tract
within a study area. Let’s also assume that our basic model for the average
count μi (i.e., E(yi) = μi) is
log μi = ai + ei.
Here ai could consist of a linear or non-linear predictor as a function of co-
variates and could also consist of random eﬀects of diﬀerent kinds. To simplify
the idea we assume that ai is the “smooth” part of the model and ei is the
rough or residual part. The basic idea is that if we model ai to include all
relevant non-clustering confounder eﬀects then the residual component must
contain residual clustering information. Hence if we examine the estimated
value of ei then this will contain information about any clusters unaccounted
for in ai. Of course, this does not account for any pure noise that might also
be found in ei. This means, of course, that an estimate of ei could have at

122
Bayesian Disease Mapping
least two components: clustered and unclustered (or frailty). There could, of
course, be additional components depending on whether the confounding in
ai was adequately speciﬁed or estimated.
There are a number of approaches to isolating the residual clustering. First,
it is possible to include a pure noise term within ai and to consider ei as a
cluster term. For example we could assume that ai = f(vi; covariates) where
f(.) is a function of a uncorrelated noise at the observation level (vi: frailty or
random eﬀect term) and a function of covariates. Second, a smoothed version
of ei, s(ei) say, could be examined in the hope that the pure noise is smoothed
out. Of course this begs the question of which component should include the
clustering: should it be a model component or a residual component? If the
clustering is likely to be irregular and we can be assured that no clustering
confounding eﬀects are to be found in the model component, then a residual
or smoothed residual might be useful. On the other hand, if there is any prior
knowledge of the form of clustering to be expected, then it may be more
important to include some of that information within the model itself. The
real underlying issue is the ability of models and estimation procedures to
diﬀerentiate spatial scales of clustering.
6.2
Cluster Detection using Residuals
First of all, assume that we observe disease outcome data within a spatial
window.
6.2.1
Case Event Data
6.2.1.1
Unconditional analysis
For the case event scenario we have {si}, i = 1, ..., m events observed within
the window T . Modeling here focusses on the ﬁrst order intensity and its
parametrization. Assume that λ(s|ψ) = λ0(s|ψ0).λ1(s|ψ1) as deﬁned in Chap-
ter 5. We focus ﬁrst on the speciﬁcation of a residual for a point process gov-
erned by λ(s|ψ). First, in the spirit of classical residual analysis, it is clear
that we can assume that we want to compare ﬁtted values to observed values.
This is not simple as we have locations as observed data. One way to circum-
vent this problem is to consider a function of the observed data which can
be compared with an intensity estimate at location si, λ(si|ψ) say. One such
function could be a saturated or nonparametric intensity estimate (λloc(si),
say, where loc denotes a local estimator). Essentially this gives a slight ag-
gregation of the data, but it allows for a direct comparison of model to data.

Disease Cluster Detection
123
Hence we can deﬁne a residual as
rloc
i
= λloc(si) −λ(si|ψ)
or in the case of a saturated estimate (Lawson, 1993a)
rsat
i
= λsat(si) −λ(si|ψ).
Baddeley et al. (2005) discuss more general cases applied to a range of pro-
cesses. An example of a local estimate of intensity could be derived from a
suitably edge-weighted density estimate(Diggle, 1985). An example of the use
of the saturated estimator is as follows:
First assume that an estimator is available for the background intensity
λ0(si|ψ0), λ0(si|ψ0) ≡λ0i say. Also assume that it can be used as a plug-
in estimator within λ(s|ψ). If this is the case, then we can compute rsat
i
=
λ0i[ 
λ1sat(si) −λ1(si|ψ)]. For a simple heterogeneous Poisson process model
with intensity λ0(s|ψ0).λ1(s|ψ1) and using an integral weighting scheme (as
described in Chapter 5), then the saturate estimate of the intensity at si is
1/(wiλ0i). A simple weight (which provided a crude estimator of the local
intensity) is wi = Ai where Ai is the Dirichlet tile area surrounding si, based
on a tesselation of the case events. Hence a simple residual could be based on
rsat
i
= λ0i[(wiλ0i)−1 −λ1(si|ψ)]
= w−1
i
−λ0iλ1(si|ψ).
The use of such tile areas must be carefully considered as edge eﬀect distor-
tion can occur with tesselation and so boundary regions of the study window
should be treated with caution. Of course both the error in estimation of the
background intensity is ignored here and a crude approximation to the sat-
urated intensity is assumed. Note that rsat
i
or rloc
i
can be computed within
a posterior sampler and so a posterior expectation of the residuals can be
estimated.
Figure 6.2 displays an example of the use of posterior expectation of rsat
i
for
a model, for the well known larynx cancer data set from Lancashire, United
Kingdom 1974–1983. This dataset has been analyzed many times and con-
sists of the residential address locations of cases of larynx cancer with the
residential addresses of cases of respiratory cancer as a control disease (see
e.g., Diggle, 1990; Lawson, 2006b, Ch. 1), with distance decline component
(variable di) around the ﬁxed point (3.545, 4.140), an incinerator. The moti-
vation for this type of analysis relates to assessment of health hazards around
putative sources (putative source analysis). This is discussed more fully in
Chapter 7.
The model for the ﬁrst order intensity is deﬁned to depend on
this distance: λ1(si|θ) = β0[1 + exp(−β1di)]. Appendix B contains the Win-
BUGS code for this example. The map displays the contours for the posterior
sample estimate of Pr(rsat
i
> 0), the residual exceedence probability.

124
Bayesian Disease Mapping
× 10–4
× 10–4
FIGURE 6.2
Map of Lancashire larynx cancer case distribution with, superimposed, a con-
tour map of exceedence probability (0.7,0.8,0.9) for the residual (rsat
i
) from
a Bayesian model assuming Berman–Turner Dirichlet tile integration weights
and non-parametric density estimate of background risk computed from the
respiratory cancer control distribution.
To allow for extra unobserved variation in this map an uncorrelated ran-
dom eﬀect term can also be included in the model. Appendix B displays
the code used for this model. Figure 6.3 displays the resulting posterior av-
erage residual exceedence probability map for the model with λ1(si|θ) =
β0[1 + exp(−β1di)] exp(vi) where vi ∼N(0, τv) and β∗∼N(0, τ β∗).The hy-
perparameter speciﬁcations are given in the Appendix.
Both ﬁgures suggest
that there is slight evidence for an excess of aggregation in the north of the
study region (where there is a large area where Pr(rsat
i
> 0) > 0.9). There is
also weaker evidence of an excess in the area to the west of the putative source
(3.545,4.140), where Pr(rsat
i
> 0) > 0.8 on average. There is also marked edge
eﬀects close to the study region corners due to the distortion of the tesselation
suspension algorithm. Figure 6.3 displays a similar picture even after removal
of extra noise.

Disease Cluster Detection
125
× 10–4
× 10–4
FIGURE 6.3
As per Figure 6.2 but where the model has included a random uncorre-
lated eﬀect (vi) to allow for extra variation in the risk: λ1(si|θ) = β0[1 +
exp(−β1di)] exp(vi).
6.2.1.2
Conditional logistic analysis
An alternative approach to the analysis of case event data is to consider the
joint realization of cases and controls and to model the conditional probability
of a case given an event has occurred at a location. This approach was dis-
cussed in Chapter 5 and has the advantage that the background eﬀect factors
out of the likelihood. Deﬁne the joint realization of m cases and n controls
as si : i = 1, ..., N with N = m + n. Also deﬁne a binary label variable {yi}
which labels the event either as a case (yi = 1) or a control (yi = 0). The
resulting conditional likelihood has a logistic form:
L(ψ1|s) =

i∈cases
pi

i∈controls
1 −pi
=
N

i=1
{exp(ηi)}yi
1 + exp(ηi)

.

126
Bayesian Disease Mapping
where pi =
exp(ηi)
1+exp(ηi) and ηi = x′
iβ and x′
i is the i th row of the design
matrix of covariates and β is the corresponding p-length parameter vector.
Hence in this form a Bernoulli likelihood can be assumed for the data and
a hierarchical model can be established for the linear predictor ηi = x′
iβ.
In general, it is straightforward to extend this formulation to the inclu-
sion of random eﬀects in a generalized linear mixed form. Bayesian resid-
uals such as ri = yi −pi/ se(yi −pi)
(or directly standardized version:
ri = (yi −pi)/

pi(1 −pi)) are available, where pi is the average value of pi
from the posterior sample. Residuals from binary data models are often diﬃ-
cult to interpret due to the limited variation in the dependent variable (0/1),
and the usual recommendation for their examination is to group or aggregate
the results. A wide variety of aggregation methods could be used. Spatial ag-
gregation methods might be considered here. Figure 6.4 displays the mapped
surface of the standardized Bayesian residual using ri = (yi −pi)/

pi(1 −pi)
where pi is computed from the converged posterior sample via R2winBUGS.
Appendix B displays the code for this model. The model assumed for this
example also has an additive distance eﬀect and is speciﬁed by
pi =
λi
1 + λi
λi = exp{α0 + vi}.{1 + exp(−α1di)}.
Figure 6.5 displays the thresholded mapped surface of the Pr(ri > 2) for
values (0.05,0.1,0.2). This suggests some evidence of clustering or unusual
aggregation in the north and also in the vicinity of the putative location in
the south.
Note that all of these models assume that there is negligible clustering
under the
model and that any residual eﬀects will include the clustering.
These models do not explicitly model clustering, but only model long range
and uncorrelated variation. Hence we make the tacit assumption that any
remaining aggregation of cases will be found in the residual component. Of
course other eﬀects which were excluded from the model could be present in
the residuals.
6.2.2
Count Data
For count data, it is assumed that either a Poisson data likelihood or a bi-
nomial likelihood is relevant. Note that an autologistic model could also be
speciﬁed.
6.2.2.1
Poisson likelihood
In the case of a Poisson likelihood, assume that yi, i = 1, ..., m are counts of
cases of disease and ei i = 1, ..., m are expected rates of the disease in m small
areas, and so yi ∼Poiss(eiθi) given θi. The log relative risk is usually mod-
elled and so log θi is the modelling focus. Bayesian residuals for this likelihood

Disease Cluster Detection
127
× 10–4
× 10–4
FIGURE 6.4
Contour map of the standardised Bayesian residual for the logistic case-control
spatial model applied to the larynx cancer data from Lancashire UK. The
display shows the posterior average residual for a sample of 5000 after burn-
in.
are easily computed in standardized form as ri = (yi −eiθi)/
-
eiθi where θi
is the average value of the θi obtained from the converged posterior sample.
In this case, the Georgia oral cancer data was examined with a Poisson data
likelihood and model log θi = α0 + vi where
α0 ∼U(a, b)
vi ∼N(0, τv)
with τ v set large and (a, b) a large negative to positive range. Appendix B has
details of the WB code used. No correlated random eﬀect is included here as
it is assumed that clustering is to be found in residuals. Figure 6.6 displays
the results from a converged sampler based on 10,000 burn-in and sample size
of 2000. The display shows the average estimate of Pr(ri >2) and Pr(ri >3)
for ri given above. The most extreme region appears to be in the far west of
Georgia. It should be noted that there is considerable noise in these residuals,
particularly for Pr(ri>2).

128
Bayesian Disease Mapping
Easting × 10–4
3.48
4.15
4.20
0.05
0.05
0.05
0.05
0.05
0.05
0.05
0.1
4.25
3.50
3.52
3.54
3.56
3.58
3.60
Northing  × 10–4
FIGURE 6.5
Map of the contoured surface of Pr(ri > 2)
estimated from the converged
posterior sample for the standardised Bayesian residual in Figure 6.4.
6.2.2.2
Binomial likelihood
In the case of a binomial likelihood assume m small areas, and that in the i
th area there is a ﬁnite population ni out of which yi disease cases occur. The
probability of a case is pi. The data model is thus yi ∼bin(pi, ni) given pi,
and the usual assumption is made that logit(pi) = f(ηi), where ηi is a linear
or non-linear predictor. Of course, various ingredients can be speciﬁed for
f(ηi), including the addition of random eﬀects to yield a binomial GLMM.
A Bayesian residual for this model is given in standardized form as ri =
(yi −nipi)/

nipi(1 −pi) where pi is the average of pi values found in the
converged posterior sample.
While the above discussion has focussed on simple residual diagnostics, al-
beit from posterior samples, there is also the possibility of examining predictive
residuals for any given model. A predictive residual can be computed for each
observation unit as
rpr
i
= yi −ypr
i

Disease Cluster Detection
129
(76) < 0.0
(4) 0.0-0.05
(31) 0.05-0.1
(21) 0.1-0.15
(27) >= 0.15
N
(0) <–1.38778E-17
(94) –1.38778E-17-0.025
(25) 0.025-0.05
(8) 0.05-0.075
(19) 0.075-0.1
(12) 0.1-0.125
(1) >= 0.125
N
FIGURE 6.6
Georgia county maps of Bayesian residuals from a converged posterior sampler
with a uncorrelated random eﬀect term. From left to right: Pr(ri > 2) and
Pr(ri > 3).
where ypr
i
=
1
G
G

g=1
f(yi|θg), and f(yi|θg) is the likelihood given the current
value of θg. Of course this will usually be small compared to the standard
Bayesian residual. Note that for a given data model, ypred
i
can be easily gen-
erated on WinBUGS. For the binomial example above the code could be:
y[i]˜dbin(p[i],n[i])
ypred[i]˜dbin(p[i],n[i])
rpred[i]<-y[i]-ypred[i]
An alternative approach to residual analysis could be based in the construc-
tion of a residual envelope, based on the comparison of the Bayesian residual:

130
Bayesian Disease Mapping
ri = yi −yi with r∗
i = ypred
i
−yi. Unusual residuals could be assessed by as-
sessing the ranking of ri among the a series of B simulated {r∗
ib} b = 1, ..., B,
as discussed in Section 4.4. Further, a p-value surface can be computed from
a tally of exceedences:
Pvi = Pr(|ri| > |r∗
i |) = 1
B
B

b=1
I(|ri| > |r∗
ib|).
The mapped surface of Pvi could be examined for areas of unusually elevated
values and hence provide a tool for hot spot detection.
6.3
Cluster Detection Using Posterior Measures
Another approach to cluster detection is to consider measures of quantities
monitored in the posterior that may contain clustering information. One such
measure is related to estimates of ﬁrst order intensity (case event data) or
relative risk (Poisson count data) or case probability (binomial count data).
If we have captured the clustering tendency within our estimate of any of these
quantities then we could examine their posterior sample behavior. Perhaps the
most commonly used example of this is the use of exceedence probability in
relation to relative risk estimates for individual areas for count data (see e.g.,
Richardson et al., 2004). Deﬁne the exceedence probability as the probability
that the relative risk θ exceeds some threshold level (c): Pr(θ > c). This is
often estimated from posterior sample values {θg
i }g=1,...,G via
 
Pr(θi > c) =
G

g=1
I(θg
i > c)/G
where I(a) =

 1 if a true
0 otherwise .
Of course, there are two choices that must be made when evaluating  
Pr(θi >
c). First, the value of c must be chosen. Second, the threshold for the proba-
bility must also be chosen, i.e.,  
Pr(θi > c) > b where b might be set to some
conventional level such as 0.95, 0.975, 0.99, etc. In fact, there is a trade oﬀ
between these two quantities and usually one must be ﬁxed before considering
the value of the other. Figure 6.7 displays the posterior expected exceedence
probability maps:  
Pr(θi > c) for c = 2, and c = 3 for the Georgia oral cancer
data when a relative risk model with a UH component was ﬁtted (see Section
5.3.2).
One major concern with the use of exceedence probability for single re-
gions is that it is designed only to detect hot spot clusters (i.e., single regions

Disease Cluster Detection
131
(76) < 0.0
(4) 0.0-0.05
(31) 0.05-0.1
(21) 0.1-0.15
(27) >= 0.15
N
(0) <–1.38778E-17
(94) –1.38778E-17-0.025
(25) 0.025-0.05
(8) 0.05-0.075
(19) 0.075-0.1
(12) 0.1-0.125
(1) >= 0.125
N
FIGURE 6.7
Georgia oral cancer: maps of  
Pr(θ > c) for c = 2 and c = 3 for a model with
a uncorrelated random eﬀect (UH).
signalling) and does not consider any other information concerning possible
forms of cluster or even neighborhood information. Some attempt has been
made to enhance this post hoc measure by inclusion of neighborhoods by Hos-
sain and Lawson (2006). For the neighborhood of the i th area deﬁned as δi
and the number of neighbors as ni, then
qi =
ni

j=0
qij/(ni + 1)
where qij = Pr(θj > c) ∀j ∈δi
and qi0 = Pr(θi > c).

132
Bayesian Disease Mapping
N
N
(5) < 0.4
(9) < 0.4
(10) 0.4-0.5
(16) 0.5-0.6
(6) 0.6-0.7
(3) 0.7-0.8
(2) > = 0.8
(11) > = 0.8
(15) 0.4-0.6
(15) 0.6-0.8
FIGURE 6.8
Display of exceedence probabilities for two models. Left panel: simple ﬁrst
order trend; right panel: convolution model with UH and CH only and no
trend for the same data set: South Carolina county level congenital mortality
1990.
This measures qi and qi0 can be used to detect diﬀerent forms of clustering.
Other more sophisticated measures have also been proposed (see e.g., Hossain
and Lawson, 2006, for details).
A second concern with the use of exceedence probabilities is of course that
the usefulness of the measure depends on the model that has been ﬁtted to
the data. It is conceivable that a poorly ﬁtting model will not demonstrate
any exceedences relate to clustering and may leave the clustering of interest
in the residual noise. An extreme example of this is displayed in Figure 6.8.
In that ﬁgure the same data set is examined with completely diﬀerent mod-
els. The data set is South Carolina county level congenital anomaly deaths
for 1990 (see also Lawson et al., 2003, Ch. 8). The expected rates were com-
puted for an 8 year period. In the left panel a Poisson log linear trend model
was assumed and in the right panel a convolution model. The trend model
was log θi = α0 + α1xi + α2yi, where xy is the centroid location, with zero
mean Gaussian prior distributions for the regression parameters whereas the
right panel was log θi = α0 + ui + vi where the ui, vi are correlated and
uncorrelated heterogeneity terms with the usual CAR and zero mean Gaus-
sian prior distributions. Without examination of the goodness-of-ﬁt of these
models it is clear that there could be considerable latitude for misinterpre-
tation if exceedence probabilities are used in isolation to assess (hot spot)
clustering.
As in the count data situation we can also examine exceedences for other
data types and models. For example, in the case event example, inten-
sity exceedence could be examined as: Pr(λ1(si) > 1), whereas for the bi-
nary or binomial data the exceedence of the case probability could be used:
Pr(pi > 0.5). These can also be mapped of course. However the rider con-
cerning the goodness-of-ﬁt of the model as highlighted by Figure 6.8 also
applies here.

Disease Cluster Detection
133
6.4
Cluster Models
It is also possible to design models which explicitly describe the clustering
behavior of the data. In this way parameters and functions can be deﬁned
that summarize this behavior. It should be noted that clustering behavior is
often regarded as a second order feature of the data. By second order I mean,
‘relating to the mutual covariation of the data.’ Hence it is often assumed
that covariance modeling will capture clustering in data. This is often termed
general clustering. However, as noted in Section 6.1, while general covariance
modeling can capture the overall mutual covariation (as in Figure 6.1 A) it
does not lead to identiﬁcation or detection of clusters per se. In the following
I focus on the detection of clusters, rather than general clustering.
6.4.1
Case Event Data
In the analysis of point processes (PPs) there is a set of models designed to
describe clustering. For an introductory overview, which focusses mainly on
general cluster testing, see Diggle (2003), ch 9. Basic models often assumed
for PPs, which allow clustering, are the Poisson cluster process and the Cox
process. In the Poisson (Neyman-Scott) cluster process (PcP) an underlying
process of parents (unobserved cluster centers) is assumed and oﬀspring (ob-
served points) are generated randomly in number and location. This genera-
tion is controlled by distributions. Clearly this formulation is most appropriate
in examples where parent generation occurs such as seed dispersal in ecology.
An alternative to a PcP is found in the Cox process where a non-negative
stochastic process (Λ(s)) governs the intensity of a heterogeneous Poisson
Process (hPP). Conditional on the realization of the stochastic process the
events follow a hPP. In this case
λ(s) = E[Λ(s)]
where the expectation is with respect to the process. Note that this formu-
lation allows the inclusion of spatial correlation via a speciﬁcation such as
Λ(s) = exp{S(s)} where S(s) is a spatial Gaussian process. This is sometimes
known as a log-Gaussian Cox process (LGCP) (see e.g., Møller et al., 1998).
Instead, note also that an intensity process of the form
Λ(s) = μ
∞

j=1
h(s −cj)
(6.1)
can be assumed, where h(s −cj) is a bivariate pdf, and cj are cluster centers.
If the centers are assumed to have a homogeneous PP then this is also a PcP.
Of course these models were derived mainly for ecological examples and not

134
Bayesian Disease Mapping
for disease case events. However we can take as a starting point a model for
case events that includes population modulation in the ﬁrst order intensity,
and that also allows clustering via an unobserved process of centers.
6.4.1.1
Object models
Deﬁne the ﬁrst order intensity as
λ(s|ψ) = λ0(s|ψ0).λ1(s|ψ1).
Assume that the case events form a hPP conditional on parameters in ψ1.
In the basic hPP likelihood, dependence on ψ0 would also have to be consid-
ered. Often λ0(s|ψ0) is estimated nonparametrically and a proﬁle likelihood
is assumed. Alternatively ψ0 could be estimated within a posterior sampler.
Here focus is made on the speciﬁcation of λ1(s|ψ1). Following from the basic
deﬁnitions of PcPs and Cox processes it is possible to formulate a Bayesian
cluster model that relies on underlying unobserved cluster center locations,
but is not restricted to the restrictive assumptions of the classical PcP. Deﬁne
the excess intensity at si as
λ1(si|ψ1) = μ0
K

j=1
h(si −cj; τ)
(6.2)
where a ﬁnite number of centers is considered inside (or close to) the study
window. For practical purposes, K is assumed to be relatively small (usually
in the range of 1−20). The parameter τ controls the scale of the distribution.
Note that in this formulation we do not insist that {cj} follow a homoge-
nous PP, nor is the cluster distribution function h(si −cj; τ) restricted to a
pdf, although it must be non-negative. A simple extension of this allows for
individual level covariates within a predictor (ηi):
λ1(si|ψ1) = exp(ρ0 + ηi).
K

j=1
h(si −cj; τ).
(6.3)
where μ0 = exp(ρ0).
In the following, intensity (6.2) will be examined. In general, intensity (6.2)
can be regarded as a mixture intensity with unknown number of components
and component values (cluster center locations). A general Bayesian model
formulation can be
[{si}|ψ0, μ0, τ, K, c] ∼
m

i=1
λ(si|ψ). exp
⎧
⎨
⎩−

T
λ(u|ψ)du
⎫
⎬
⎭

Disease Cluster Detection
135
where ψ ≡{ψ0, μ0, K, c}, with ψ1 ≡{ρ0, τ, K, c}
λ(si|ψ1) = λ0(si|ψ0)λ1(si|ψ1)
λ1(si|ψ1) = exp(ρ0).
K

j=1
h(si −cj; τ)
ρ0 ∼Ga(a, b)
K ∼Pois(γ)
{cj} ∼U(AT )
τ ∼Ga(c, d).
Here, the prior distributions reﬂect our beliefs concerning the nature of the
parameter variation. As ρ0 is the case event rate we assume a positive dis-
tribution (in this case a gamma distribution). The parameter γ essentially
controls the parent rate (center rate) and in this case the prior for the num-
ber of centers (K) is Poisson with rate γ. Other alternatives can be assumed
for this distribution. A uniform distribution on a small positive range would
be possible. Another possibility is to assume that the centers are mutually
inhibited and to assume a distribution that will provide this inhibition. Such
a distribution could be a Markov process form such as a Strauss distribution
(M´oller and Waagpetersen, 2004, Ch. 6). The τ parameter is assumed to ap-
pear as a precision term in the cluster distribution function: h(si −cj; τ). A
typical symmetric speciﬁcation for this distribution is distance based:
h(si −cj; τ) = τ
2π exp

−τd2
ij/2

where dij = ∥si −cj∥.
Other forms are of course possible including allowing the precision to vary
with location and asymmetry of the directional form. Many examples ex-
ist where variants of these speciﬁcations have been applied to cluster detec-
tion problems (e.g., Lawson, 1995; Lawson and Clark, 1999b; Lawson, 2000;
Cressie and Lawson, 2000; Clark and Lawson, 2002). One variant that has
been assumed commonly is to change the link between the cluster term and
the background risk. For example, there is some justiﬁcation to assume that
areas of maps could be little aﬀected by clustering if far from a parent lo-
cation. In these areas the background rate (λ0(si|ψ0)) should remain. The
multiplicative link, assumed in λ1(si|ψ1), may be improved by assuming an
additive-multiplicative link as well as the introduction of linkage parameters
(a, b):
λ1(si|ψ1) = exp(ρ0).
⎧
⎨
⎩a + b
K

j=1
h(si −cj; τ)
⎫
⎬
⎭.
(6.4)

136
Bayesian Disease Mapping
6.4.1.2
Estimation issues
The full posterior distribution for this model is proportional to
[{si}|ψ0, μ0, a, b, τ, K, c].P1(ψ0, μ0, a, b, τ).P2(K, c)
where P∗(.) denotes the joint prior distribution. Given the mixture form of the
likelihood, it is not straightforward to develop a simple posterior sampling al-
gorithm. Both the number of centers (K) and their locations (c) are unknown.
Hence it is not possible to use straightforward Gibbs sampling. In addition we
don’t require there to be assignment of data to centers and so no allocation
variables are used, unlike other mixture problems (Marin and Robert, 2007,
ch 6). One simple approximate approach is to evaluate a range of ﬁxed com-
ponent models with diﬀerent ﬁxed K. The model with the highest marginal
posterior probability is chosen (K∗) and the sampler is rerun with ﬁxed K∗.
This two stage method is not eﬃcient however. Another alternative would
be to use the ﬁxed dimension Metropolized Carlin–Chib algorithm (Godsill,
2001; Kuo and Mallick, 1998). Instead, for variable dimension problems such
as this, resort can be made to reversible jump McMC (Green, 1995). A special
form of this algorithm can be used called a spatial birth-death McMC. In this
algorithm centers, at diﬀerent iterations, are added, deleted or moved based
on proposal and acceptance criteria. In this way the location and the number
of centers can be sampled jointly. Detail of these algorithms are given in van
Lieshout and Baddeley, 2002 and Lawson, 2001, Appendix C.
Figure 6.9 displays one part of the posterior output from a birth-death
McMC sampler run on the Lancashire larynx cancer example. For this case
the prior distributions assumed were Strauss for the joint distribution of
centers and number of centers (with ﬁxed inhibition parameter), additive-
multiplicative link was used with a = 1, b = 1, a symmetric Gaussian cluster
distribution was used with precision parameter κ−1. The population back-
ground was estimated via a density estimation but the smoothing parameter
was sampled in the posterior distribution. It was given an InvGa(1, 100) prior
distribution. Additional random eﬀect terms were also included in this model.
For further details of this example see Lawson, 2000). Both the number of cen-
ters and location vary over iterations in this example. Hence summarization of
the posterior output is not straightforward: diﬀerent distributions of parame-
ters will be associated with diﬀerent numbers of centers. One gross summary
of the cluster center distribution is available whereby the density estimate
surface of the centers overlain from diﬀerent realizations is presented. This
is simply an average over diﬀerent K values. Of course this can be criticized
as it ignores the possibility that markedly diﬀerent spatial realizations could
occur with diﬀerent K values. In fact this is a general problem with mixture
models. It is interesting to note that an area of elevated probability density
appears close to a putative source (incinerator: location: 35450,41400).
How do these models perform and are they realistic for disease cluster de-
tection? In general, the simplistic assumptions made by point process models

Disease Cluster Detection
137
34800
35000
35200
35400
35600
35800
36000
42500
42000
41500
0.2
0.4
0.4
0.4
0.4
0.4
0.6
0.6
0.6
0.6
0.6
0.6
0.8
0.8
0.8
0.8 0.8
0.8
0.8
0.8
FIGURE 6.9
Lancashire larynx cancer: birth-death McMC output. The posterior expected
probability density surface of the cluster center locations obtained by overlay
of center realisations from diﬀerent K values.
are really inadequate to describe clustering in spatial disease data. First, clus-
tering tends to occur not as a common spatial ﬁeld but often as isolated areas.
Even when multiple clusters occur it is unlikely they will be of similar size or
shape. In addition, clusters do not form regular shapes and any spatial time
cross-section may show diﬀerent stages of cluster development. For instance,
there may be an infectious agent which diﬀerentially aﬀects diﬀerent areas at
diﬀerent times. A time-slice spatial map will then show diﬀerent cluster forms
in diﬀerent areas. Another factor is that scales of clustering can appear on
spatial maps. This is not considered in simple cluster PP models.
Given the possibility that unobserved confounders are present then the re-
sulting clustering will be: a) unlikely to be summarized by a common model
with global clustering components; b) cluster distribution functions with reg-
ular forms may not ﬁt the irregular variation found.
The use of birth-death McMC with cluster models is not as limited as it may
at ﬁrst seem however. The disadvantages of this form of modeling are a) tuning
of reversible jump McMC is often needed and so the method is not readily
available, b) interpretation of output is more diﬃcult due to the sampling over

138
Bayesian Disease Mapping
a joint distribution of centers and number of centers, and c) possible rigidity
of the model speciﬁcation.
However there are a number of advantages. First, it can easily be modiﬁed
to include variants such as spatially dependent cluster variances (thereby al-
lowing diﬀerent sizes of clusters in diﬀerent areas) and even a semiparametric
deﬁnition of h(si −cj; τ) which would allow some adaptation to local condi-
tions. Second, it is also important to realize that by posterior sampling and
averaging over posterior samples it is possible to gain ﬂexibility: even with
a rigid symmetric form such as
τ
2π exp

−τd2
ij/2

it is easy to see that the
resulting cluster density map does not reﬂect a common global form (Fig-
ure 6.9) and indeed highlights the irregularity in the data. This of course is
quite unlike the rigidity found in commonly-used cluster testing methods like
SatScan (http://www.satscan.org/). In addition there is a wealth of infor-
mation provided from a posterior sampler that can even include additional
clustering information. For instance, the posterior marginal distribution of
number of centers can yield information about multiple scales of cluster-
ing (even when these are not included in the model speciﬁcation). Figure
6.10 displays a histogram of the posterior marginal center rate parameter
for a diﬀerent data example. In that example there appears to be a ma-
jor peak at 6–7 centers whereas subsidiary peaks appear at 10–11 and also
at 13. This may suggest diﬀerent scales of processes operating in the study
window.
0
5
10
15
0
5
10
15
20
25
30
35
40
45
50
Center Rate
Frequency
FIGURE 6.10
Posterior expected distribution of number of centers from a converged sampler.

Disease Cluster Detection
139
Finally, it is also possible to increase the ﬂexibility of the model by intro-
duction of extra noise in the cluster sum. For example, the introduction of a
random eﬀect parameter for each of the centers:
K

j=1
exp(ψj).h(si −cj; τ) with
ψj ∼N(0, τψ), can lead to improved estimation of the overall intensity of the
process. Another option that could be exploited which allows the sampling of
mixtures more nonparametrically is the use of Dirichlet process prior distri-
butions for mixtures (Ishwaran and James, 2002; Ishwaran and James, 2001;
Kim et al., 2006). This has so far not been explored.
6.4.1.3
Data dependent models
Another possible approach to modeling is to consider models that do not as-
sume a hidden process of centers but model the data interdependence directly.
Such data-dependent models have various forms depending on assumptions.
6.4.1.3.1
Partition models and regression trees
Partition models at-
tempt to divide up the space of the point process into segments or partitions.
Each partition has a parameter or parameters associated with it. The parti-
tions are usually disjoint and provide complete coverage of the study domain
(T ). An example of disjoint partition (or tiling) is the Dirichlet tesselation
which is constructed around each point of the process. Each tile consists of al-
locations closer to the associated point than to any other. Figure 6.11 displays
such a tesselation of the Lancashire larynx cancer data set. It is clear from
the display that small tiles (small tile area) are associated with aggregations
of cases. The area in the south of the study region is particularly marked.
The formal statistical properties of such a tesselation are known (Barndorﬀ-
Nielsen et al., 1999) for most processes (such as the marginal distribution of
tile areas).
However in partition modeling, the tesselation is used in a diﬀerent manner.
Byers and Raftery (2002) describe an approach where a Dirichlet Tesselation
is used to group events together. Hence a tiling consisting of K tiles with
areas ak is superimposed on the points and the number of events within a tile
(nk) are recorded. The ﬁrst order intensity of the process is discretized to be
constant within tiles (λk). The tile centers are deﬁned to be {ck}. Based on
this deﬁnition a posterior distribution can be deﬁned where
L(n|λ) ∝
K

k=1
λnk
k exp{−λkak}
K ∼Poiss(ν)
{λk}, k = 1, ..., K|K iid Ga(a, b)
{ck}, k = 1, ..., K|K iid U(T ).

140
Bayesian Disease Mapping
× 10–4
× 10–4
FIGURE 6.11
Lancashire larynx cancer data: Dirichlet tesselation produced with 4 external
dummy points using the DELDIR package on R.
In this deﬁnition, the centers and areas are not given any stochastic depen-
dency, whereas the areas are really dependent on the center locations. In ad-
dition, the number of centers is not ﬁxed in general. This lead to a posterior
distribution, within the general case, which does not have ﬁxed dimension,
but assuming ν, a, b ﬁxed, is proportional to
νK
K!
K

k=1
λ(nk+a−1)
k
exp{−λk(ak + b)}.
In general, a reversible jump McMC algorithm or Metropolized Carlin–Chib
algorithm must be used to sample from this posterior distribution unless K is
ﬁxed. The focus of this work was the estimation of λk. Of course, in general,
λk will vary over iterations of a converged posterior sample and won’t be allo-
cated to the same areas. Hence, any summarization of the output would have
to overlay the realizations of λk for a predeﬁned grid mesh of sites (possibly
the data points), at which the average intensity would be estimated. Hence a
smoothly varying estimate of the intensity would result. In addition to simple

Disease Cluster Detection
141
intensity estimation, the authors also include a binary inclusion variable (dk),
which has a Bernoulli prior, and catergorizes the tile as being in a high inten-
sity area (dk = 1) or not. This allows a form of crude intensity segmentation
(between areas of high and low intensity). In that sense the method provides
a clustering algorithm, albeit where only two states of intensity delineate the
“clusters.” Mixing over the posterior allows for gradation of risk in the con-
verged posterior sample (see, for example, Figure 6.3 b) of Byers and Raftery,
2002).
Note that in their application, Byers and Raftery (2002) have no background
(population) eﬀect which would be needed in an epidemiological example. In
application to disease cases it may be possible to estimate a background eﬀect
using a control disease and to use this as a plug-in estimate (i.e., replace λk
by λ0kλk in the likelihood, where λ0k is a background rate estimate in the k
th tile). Alternatively, if counts of the control disease are available within tiles
then it would be possible to construct a joint model for both counts. Hegarty
and Barry (2008) have also introduced a variant where product partitions are
used to model risk.
6.4.1.3.2
Local likelihood
An alternative view, considers the use of a
grouping variable which relates to a sampling window. The sampling window
is a subset of the study window. For example, a sampling window (lasso) is
deﬁned to be controlled by a parameter (δ). This parameter controls the size
of the window. Usually, (but not necessarily) the window is circular so that
δ is a radius. First consider cases of disease collected within a window of size
δ, and denote these as nδ. Second, denote cases of a control disease as eδ
within the lasso. Now assume that the case disease and control disease are
observed at a set of locations and denote these as {xi}, i = 1, ..., n and {xi},
i = n+1, ...., n+m. The joint set of {xi} can be described jointly by a Bernoulli
distribution with case probability p(xi) = λ(xi)/(λ0(xi) + λ(xi)), conditional
on λ0(xi), λ(xi) and their parameters. Further, assume that within the lasso
there is a risk parameter θδi and that λ(xi) = ρθδi ∀xi ∈δi.
Now assume
that within the lasso the probability of a case or control is constant. In that
case we can write down a local likelihood of the form
n+m

i=1

ρθδi
1 + ρθδi
nδi 
1
1 + ρθδi
eδi
.
Note that the lasso depends on δi, deﬁned at the i th location, and diﬀerent
assumptions about these can be made. Attention focusses on the estimation
of θδi, rather than δi, which can yield information about clustering behavior.
Based on this local likelihood (Kauermann and Opsomer, 2003), it is possible
to consider a posterior distribution with suitable prior distribution for pa-
rameters. For example, the δ can have a correlated prior distribution (either
a fully speciﬁed Gaussian covariance model or a CAR model). Alternatively it
has been found that assuming an exchangeable gamma prior appears to work

142
Bayesian Disease Mapping
reasonably well. In addition the dependence of θδi on δi across a range of δis
should be weak a priori and so we assume a uniform distribution. Assuming
a CAR speciﬁcation, the prior distributions are then:
[θδi|δi] ∼U(a, b) ∀i
(6.5)
ρ ∼IGa(3, 0.01)
[δi|δ−i; τ] ∼N(δΔi, τ/nΔi)
τ ∼IGa(3, 0.01)
where Δi is a neighborhood of the i th point, δΔi is the mean of the neighbor-
hood δs and nΔi is the number of neighbors, N(, ) is an (improper) Gaussian
distribution, τ is a variance parameter, and ρ is a rate both with reasonably
vague inverse gamma (IGa) distributions. An advantage of this approach is
that a ﬁxed dimension posterior distribution can be speciﬁed, albeit with a
local likelihood. Figure 6.12 displays a smoothed version of the posterior aver-
3.48
4.15
4.20
4.25
Northing × 10e–4
3.50
3.52
3.54
Easting × 10e–4
3.56
3.58
3.60
FIGURE 6.12
Lancashire Larynx cancer data: exceedence probability map. Shown is the
smoothed posterior average value, from a convreged sampler, of 1 − 
Pr(θδi
> 1) for the case data only. The smoothing was done using the MBA (R)
package.

Disease Cluster Detection
143
age value of the exceedence value of θδi: the function shown is 1− 
Pr(θδi > 1)
for the converged sampler with the prior speciﬁcation shown (6.5). The case
only map is shown with only the convex hull of the case distribution con-
toured. Further details of this model are given in Lawson (2006a). Note that
it is clear that the southern area in the vicinity of (3.55×10e-4, 4.15×10e-4)
demonstrates a very high exceedence probability (<0.01).
The main advantage of this approach is in the simplicity of programming
(compared to birth-death McMC methods) and the ease with which inter-
pretation of output can be made. The disadvantage is that in one sense the
methods do not directly model clustering, and may be regarded as smooth-
ing methods, although their cluster detection performance in simulations is
impressive (see e.g., Hossain and Lawson, 2006)
6.4.2
Count Data
6.4.2.1
Hidden process/object models
As in the situation where case events are analyzed, it is possible to specify
object models for count data. Essentially these assume a hidden process exists
and this must be estimated. The hidden process could take a variety of forms.
In the earliest examples, these forms followed those for case events where
a hidden process of cluster centers was posited. The aggregation eﬀects of
accumulating case events into small areas (census tracts, zip codes, etc.) leads
to integrals of the ﬁrst order case intensity in the expectation of the count.
Hence, denoting the count of disease in the i th area (within area ai) as ni,
then
E(ni) =

ai
λ(u)du.
and an ‘exact’ hidden process model (HPM) would be deﬁned as
ni ∼Pois(

ai
λ(u)du)
(6.6)
λ(u) = λ0(u|ψ0)λ1(u|ψ1)
λ1(u|ψ1) =
K

j=1
exp(φj).h(u −cj; τ h)
φj ∼N(0, τ ψ).
Here, h(u−cj; τ h) is a cluster distribution function as before and {cj} is a set
of hidden cluster centers and the background population function λ0(u|ψ0)
must be estimated as before (Lawson and Clark, 1999a). Often, a simpliﬁed
(approximate) version of (6.6) is assumed where the expectation is simply a

144
Bayesian Disease Mapping
function of an expected rate (ei) and relative risk parameter (θi):
ni ∼Pois(eiθi),
log θi = α0 + α1
K

j=1
φjh(Ci −cj; τh),
where {Ci} is a set of centroids of the small areas, α0 is an intercept and
α1 is a linking parameter. The {φj} play the same role as before as random
eﬀects and the {cj} is hidden centers to be estimated. The expected rates are
usually calculated based on an external standard population. An example of a
variant of this model is given in Lawson (2006b), ch 6, where θi = exp(φj).[1+
K

j=1
h(Ci −cj; τh)] with φj ∼N(0, τ ψ). Another variant of this model was
speciﬁed by Gangnon (2006) where the log relative risk in
a small area is
assumed to be speciﬁed by log θi = α0 + Γi + ei, where
Γi =
K

j=1
φjh(Ci −cj; τ h)
(6.7)
and φj is now a relative risk component associated with the j th cluster
and h(.) is a cluster membership function assumed to be uniform on a disc.
The intercept term is α0, while the ei term is a random eﬀect with zero
mean Gaussian prior distribution. The function h(.) associates small areas to
centers. The cluster centers are assumed to be centroids of the small areas
(to avoid empty clusters which could arise due to the membership function
deﬁnition). The main diﬀerence between these two variants is the inclusion of
relative risk components in the latter model (6.7).
6.4.2.2
Data dependent models
As in case event applications, it is possible for count data to be modelled
without recourse to HP models. Two alternatives to such modeling are the use
of partition models and splitting methods, and the local likelihood. A common
feature of these methods is that spatial membership must be computed within
an area. In either case the methods require computation of distances within
the spatial conﬁguration of the data. Within McMC algorithms these distances
have to be recomputed as parameters are sampled.
6.4.2.2.1
Partition models and regression trees
One of the ﬁrst ex-
amples of applying partition modeling to small area count data was proposed
by Knorr-Held and Rasser (2000). In their modeling approach, at the ﬁrst
level of the hierarchy, the small area count yi is assumed to be conditionally
independent Poisson with expectation eihj where ei is the usual standardized
expected rate. The relative risk for a given area is chosen from a discrete set

Disease Cluster Detection
145
of risk levels (which are called ‘clusters’ by the authors). These ‘clusters’ are
a set of contiguous regions {Cj} j = 1, ..., n, which have associated constant
risk {hj}. The relative risk assigned to the i th area is just
hj if i ∈Cj.
Hence, yi ∼Pois(eihj). The number of clusters (k) is treated as unknown:
k ∈{1, ..., n}. Hence this method seeks a non-overlapping partition of the
map into areas of like risk. In this deﬁnition of clustering, clusters are ar-
eas of constant risk and of course this is a diﬀerent deﬁnition of clustering
from the more usual deﬁnitions using “elevated risk.” The essential diﬀerence
is that the clusters are discrete partitions in this case. However, as in other
cases, posterior averaging can lead to a more continuous relative risk esti-
mate. Computational issues related to sampling partitions led the authors to
consider reversible jump McMC. In the examples cited the number of parti-
tions were quite large (40-45) in the posterior realizations for male oral cavity
cancer in 544 districts in Germany.
Partition models have since been extended (Denison and Holmes, 2001;
Denison et al., 2002; Ferreira et al., 2002). In application to count data in small
areas, the usual Poisson assumption is made at ﬁrst level: yi ∼Pois(eiε(Ci)).
The partition is deﬁned to be ε(Ci) = μr(i) the relative risk level as-
sociated with a region of a tesselation that the centroid Ci of the small
area lies in. In this approach a discrete tesselation is used as a partition.
The prior distribution of the levels is assumed to be independent gamma:
[μj|γ1, γ2] ∼Ga(γ1, γ2), j = 1, ..., k. A prior model is also assumed for the
location of tile centers:
p(c) = 1
K
1
{Area(T )}k ,
where K is the maximum number of centers/tiles and k is the current number.
The marginal likelihood of the data given the centers is
constant +
k

j=1
{log Γ(γ1 + njyj) −(γ1 + njyj) log(γ2 + njNj)}
where nj is the number of points in the j th region and yj is the mean of the
observations in that tile and N j is the mean expected rate in the j th tile.
An inclusion rule must be speciﬁed for the small areas being included within
any given tile. The usual rule is to include if the centroid falls within the tile.
Unlike the Knorr–Held–Rasser model this allows there to be diﬀerent parti-
tion shapes. Computation for the tesselation model is based on a birth-death
McMC algorithm where the centers are added, deleted, or moved sequentially.
Of course, there are considerable edge eﬀect issues with partition models
and these apply to all partition models that use tesselations (rather than
groupings): at the external study region boundary tesselations will inevitably
be distorted due to censoring adjacent regions outside the study window.
Grouping algorithms (such as proposed by Knorr-Held and Rasser, 2000) could

146
Bayesian Disease Mapping
also be aﬀected as no information outside the boundaries have been reported
and this could distort the edge region allocations. These seem to be largely
ignored in the literature on partition modeling.
Extensions to tree models could be imagined (Denison et al., 2002). For
example, all the “clustering” partition models proposed assume a ﬂat level
of partitioning. However we could conceive of a form of splitting where a
tree-based hierarchical cluster formation is conceived. It could be possible
to construct a multi-level partition by allocation of higher levels of partition
based on residuals from lower levels. This could be conceived as a multivariate
partition function with L levels and Kl partitions at the l th level. There could
be ordering constraints on the diﬀerent levels. This could provide an approach
to multiscale feature identiﬁcation in the data.
Connections between partition models and mixture models for relative risk
are also evident. For example, the model of Green and Richardson (2002)
assumes that there are a small number of risk components {θj, j = 1, 2, ..., k}
and the small areas are allocated one of these levels via the allocation variables
{zi, i = 1, ..., n}. Hence yi ∼Pois(eiθzi) where θzi is the allocated risk level
for the i th area. Unlike other approaches, the allocation variables are given a
spatially-structured Potts prior distribution. This allows grouping at a higher
level in the hierarchy. In contrast, Fernandez and Green (2002) describe a
mixture model where the count is assumed to be governed by a weighted sum
of Poisson distributions and the weights have spatial structure.
One general question concerning these methods is whether they really can
be considered ‘clustering’ methods or not. While all these methods could yield
a variety of posterior information concerning risk, and some part of that infor-
mation could be employed to detect clusters, they do not directly address the
detection of clusters; rather they seek to ﬁnd underlying discrete risk levels
that characterize the map. Often, the authors regard their methods as com-
petitors with disease map smoothing models such as the convolution model
of Besag et al. (1991) (see for example discussions in Knorr-Held and Rasser,
2000, Ferreira et al., 2002, or Fernandez and Green, 2002) and they have been
compared in simulations as such (Best et al., 2005). Essentially, mixture mod-
els are closely identiﬁed with latent structure models and these are discussed
more fully in Sections 5.7.5 and 11.3.2.
6.4.2.2.2
Local likelihood
As in the case event situation (6.4.1.3.2), lo-
cal likelihood models could also be applied. For small area counts, then within
a lasso, centered at the centroid of the area, of dimension δi, with a Poisson
assumption, then the probability of yδi counts with expected rate eδi, is just:
f(yδi|eδi, θδi; δi) = [eδiθδi]yδi exp(−eδiθδi)/yδi!.
This can be employed within a local likelihood as:
L(θ|y) =
m

i=1
f(yδi|eδi, θδi, δi).

Disease Cluster Detection
147
Note that, in this case, the factorial term (yδi!) must be included in the
likelihood as it varies with δi. In this case the data and expected rate are
accumulated within the lasso. A rule must be assumed for the inclusion of
small areas. Centroids falling within the lasso is a common assumption. Then
yδi =

i∈δi
yi, and eδi =

i∈δi
ei. In this deﬁnition the counts and expected
rates within neighboring lassos can overlap and hence they can be correlated.
Usually, the focus is on the estimation of θδi rather than δi. The linkage
between the risk and the lasso is speciﬁed via:
log θδi = δi + εi
where εi ∼N(0, τ ϵ) an unstructured component and δi is assumed to have a
spatially-structured prior distribution. In examples, a CAR prior distribution
has been assumed for this purpose i.e.,
[δi|δ−i; βδ] ∼N(δi, βδ/di)
where di =
m

j
I(j ∈δi), and δi =

j∈δi
δj/di. This allows the correlation
inherent in the local likelihood to be modeled at a higher level of the hierarchy.
Covariates can also be added to this formulation if required (see Hossain
and Lawson, 2005 for discussion). Figure 6.13 displays an example of the
True relative risk
3.5 to 4     (3)
3 to 3.5     (4)
2.5 to 3     (5)
2 to 2.5     (6)
1.5 to 2     (8)
1 to 1.5     (193)
2 to 2.5        (1)
1.5 to 2      (15)
1 to 1.5      (99)
0.5 to 1    (104)
Local likelihood
model
FIGURE 6.13
East German lip cancer mortality (1980-1989) data. Simulated “true” risk
map (left panel) and local likelihood posterior expected relative risk estimates
(right panel).

148
Bayesian Disease Mapping
FIGURE 6.14
Comparison of true and posterior estimated relative risks for the simulated
data for the East Germany district geographies. Left panel: BYM model; right
panel: local likelihood model.
application of the local likelihood model to a simulated realization where
clusters of risk are introduced into the district geographies of the former East
Germany. The counts are generated from a Poisson model with mean ei.
θtrue
i
where the θtrue
i
are the true risks. The left-hand panel depicts the true
risks and the right-hand panel depicts the estimated risks under the local
likelihood model with CAR prior distribution for the lasso parameters and
inverse gamma distributions for the precision parameters (τ). A comparison
of the estimation ability of a random eﬀect convolution model compared to
the local likelihood model is also made in Figure 6.14. It is noticeable that
the local likelihood model produces a greater shrinkage than the convolution
model. In full simulation comparisons based on operating characteristic curves
the LL model performs well in recovering true risk as well as some features of
clusters (see e.g., Hossain and Lawson, 2006).
6.4.3
Markov Connected Component Field (MCCF) Models
A number of alternative approaches to count data clustering have been pro-
posed and should be mentioned as they relate to methods previously discussed.
First a cluster modelling approach based on Markov connected component
ﬁelds has been proposed (Gangnon and Clayton, 2000). This approach also
seeks to ﬁnd a grouping of small areas into “clusters.” The cluster set k clus-
ters has associated a risk level λj, j = 1, .., k. The membership of the clusters
is deﬁned for each of the N small areas (i = 1, ..., N), via a membership
(allocation) variable: z = (z1, ..., zN). Hence the counts in the N areas have

Disease Cluster Detection
149
distribution, conditional on the cluster assignment (z):
yi ∼Pois(eiλzi)
where λzi is the disease risk for the cluster associated with the i th area.
Clusters are assumed to be aggregations of the basic small areas, and so
the allocation assigns diﬀerent disease risks to each area depending on prior
distributional constraints. This setup was later used by Green and Richardson
(2002) but they assumed a spatially-structured prior distribution for the z.
Here, the disease risks are assumed to have a Ga(α, β) prior distribution
given the z, where Ga(α, β) has mean α/β. However the z are assumed to have
a Markov connected component ﬁeld prior governing their form (M´oller and
Waagepetersen, 1998). This construction allows there to be various cluster
form speciﬁcations included in the prior structure. This construction allows a
potential function to describe the clustering:
p(z) ∝exp{−
k

j=1
Sj}
where the Sj is a score function for the j th cluster. The authors use properties
of the clusters such as circularity (shape) and size to yield a composite score:
Sj = α+Sj1(size)+Sj2(shape). Once speciﬁed the authors use a randomized
model search criteria to evaluate diﬀerent models. In a similar development,
but diﬀerent application, M´oller and Skare (2001) further apply these priors
to imaging problems.
Note that this MCCF approach has many advantages over purely spatially-
structured distributions for component assignment. It also allows the models
to address speciﬁc features of the clusters that are not considered by other
partitioning approaches.
6.5
Edge Detection and Wombling
A closely related area of concern to disease clustering is the idea that discon-
tinuities in maps are the focus. These could be the edge of some uniform risk
area or the edge of a variable risk cluster of some kind. In cluster modeling
usually there is some criteria deﬁning the cluster and its boundary. In edge
detection the boundary is usually deﬁned by a jump or discontinuity in risk,
and so this in a sense takes the approach whereby the focus is the diﬀerences
in risk rather than ﬁnding the area of elevated risk.
Wombling, is closely related to the edge eﬀect problem of Section 5.8, in that
the focus is on boundaries of regions. There is a growing interest in the ability
to locate boundaries within a spatial domain. This has been developing within

150
Bayesian Disease Mapping
Geography for some time (see e.g., Oden et al., 1993 amongst others). These
boundaries often have some natural context, such as catchments of health
providers (Ma et al., 2006) or areas which vote predominantly for one party
in elections (O’Loughlin, 2002). Basically these methods are edge detection
methods, and many such methods are commonly found in the image processing
literature (see e.g., the Canny operator, Mars-Hilldreth, Gaussian derivative
kernels; Bankman, 2007). Often they are intended for object recognition and
use derivative-based methods for locating discontinuities.
The discovery of discontinuities in disease maps may be of interest in de-
tection of natural boundaries for health provision (recent Bayesian examples
are Ma et al., 2006, Lu and Carlin, 2005). One simple approach to this prob-
lem can be examined within a Bayesian hierarchical model. Assume for small
areas with observed tract counts yi and yi ∼Poiss(eiθi).
Within a posterior sampling algorithm, θg
i is the estimate of θi at the g th
iteration. It is possible to estimate the posterior expected value of the absolute
diﬀerence between relative risks, Δθij, by simply computing:
Δθij =

g∈d
|θg
i −θg
j|/n(d),
where d denotes the converged sample set and n(d) is the number in that set.
Hence this estimator is available for all region boundaries. The parameters
{Δθij} really detect discontinuities between regions and there is no infor-
mation in this approach that informs the edge detection beyond the average
diﬀerence between modelled estimates of adjoining area risks. Hence cluster
or object information that could ‘tie’ the areas together is not used. Pre-
smoothing the estimates of risk (e.g., via a convolution model) may lead to
reduction in discontinuity, of course, and so the choice of model for the θ
could be crucially important. More sophisticated approaches have also been
proposed (see e.g., Ma et al., 2006).
It is not clear how discontinuities are to be modeled for applications in
disease incidence studies. Underlying most models of risk is the assumption
of continuity of risk over space. The convolution smoothing models assume
this as do most other risk models. The ﬁxed mixture model of Lawson and
Clark (2002) and also the mixture models of Green and Richardson (2002)
do attempt to honor discontinuities within a general framework of smooth
risk and allows the smoothness to be selected diﬀerentially over space. It is
a matter of debate whether pure discontinuity models have advantages in
incidence studies.

7
Ecological Analysis
The term, ecological analysis, is used loosely here to denote a situation where
an aggregated disease outcome variable is geo-referenced and is to be related
to predictors/covariates. These predictors can be observed at diﬀerent levels
of spatial aggregation. In what follows, I do not discuss misaligned (MIDP)
or modiﬁable areal unit problems (MAUP) directly as these are discussed in
Chapter 8.
7.1
General Case of Regression
The setting to be discussed here, in the simplest case, assumes a dependent
variable (outcome) for a small area as yi and this is to be related to predic-
tors. The predictors can be geo-referenced, or not, depending on context. For
example, we might measure a disease rate within a census tract and want to
relate it to the level of poverty in the tract. Hence both the dependent vari-
able is an aggregate count of disease (yi) and the covariate is an aggregate
measure (percentage) of numbers of family units or people who fall below the
deﬁned poverty level in the small area (x1i). This is an example of ecologi-
cal regression: the disease count is thought to relate to poverty but we have
no direct measure at a lower level of aggregation (e.g., the individual level)
whether poverty is associated with the disease outcome.
A typical mean model would be of the form
yi ∼f(μi)
where
E(yi) = μi
with
g(μi) = S(x1i)
where g(μi) is a link function and S(x1i) is a linear or non-linear function of
the covariate. In a simple case, with a Poisson data model and μi = eiθi, with
151

152
Bayesian Disease Mapping
Standardized mortality ratio: congenital deaths
4 to 4 
(1)
2 to 4 
(8)
1 to 2 (27)
0 to 1 (10)
FIGURE 7.1
South Carolina congenital death standardized mortality ratio 1990. Standard-
isation based on statewide rate for same year.
a log-linear setup, with expected rate as oﬀset, we would have
yi ∼Pois(μi)
μi = eiθi
= ei exp{α0 + α1x1i}.
In this formulation, exp{α0} acts as an overall scaling parameter, and
exp{α1x1i} adds the modulation of the covariate. Inference would focus on
the parameters α0 and α1. This is just a log-linear Poisson regression model
and in a Bayesian context we would assign prior distributions for α0 and α1
to complete the speciﬁcation. As the focus is only on regression parameter
inference rather than on estimation of the relative risk per se, then it may be
tempting to ﬁt this log-linear model as deﬁned, in the belief that, for example,
unobserved confounding would have little eﬀect on such parameter estimates.
County level counts of congenital deaths for the US state of South Carolina
are available for a number of years. Here I focus on one year: 1990. Figure 7.1
displays the standardized mortality ratio (smr) for the congenital anomaly
counts for the counties of South Carolina in 1990.
The expected rate was computed using the age × sex standardized rate for
South Carolina. Also available for this example, from the 1990 US census, is
the percentage of family units living in poverty. This is determined by com-
parison to a threshold income level. It is reasonable to suppose that some
relationship might hold between congenital deaths and poverty or deprivation
in a population. Of course this is an ecological relation as individual poverty
and disease outcome is not measured directly. Figure 7.2 displays the rela-

Ecological Analysis
153
FIGURE 7.2
Scatterplot of the standardized mortality ratio for congenital abnormality
outcome for the counties of South Carolina versus percentage poverty from
the US census 1990. A loess line ﬁt has been added.
tionship found. While there is some evidence for a positive relation at higher
poverty levels, there is considerable noise in the relation and at lower levels
there may appear to be an inverse relation. This form of relation may be
apparent for a number of reasons. First, many areas in South Carolina are
largely rural and these may display a positive relation between the smr and
poverty given they may be predominantly areas of low income. However some
urban fringe areas have high concentrations of high income units mixed with
rural poor populations. In these fringe areas the smr may be relatively high
but the income will average out to be relatively high also. Second, in areas
with a small percentage of poverty units it may be that health “bootstrap-
ping” can take place in the sense that in predominantly high income areas the
health experience of low income units may be improved so that there could
be a reduction in the positive relation. A negative relation might even arise.
This is termed “ecological inversion.” There is some evidence for ecological
inversion in this display.
An appropriate model for these data might include a spline ﬁt to mimic
the relation. However as a ﬁrst model, I will assume a basic log-linear Poisson
regression model with diﬀuse Gaussian prior distributions for the regression
parameters and uniform prior distributions for the associated standard devia-
tions (Gelman, 2006). Model results are found in Table 7.1. The models ﬁtted
were as follows. Model 1 is a simple Poisson log-linear regression, model 2 is

154
Bayesian Disease Mapping
TABLE 7.1
Model ﬁtting results for a variety of models for the South Carolina congenital
mortality data, (See text for details).
Model 1
Model 2
Model 3
Model 4
α0
0.0859(0.248)
0.0236(0.191)
0.068(0.243)
0.192(0.209)
α1
-0.0034(0.016)
0.0002(0.0119)
-0.0032(0.0155)
0.044(0.1198)
α2
-
-
-
-
τ 0
43.87(393.2)
325.2(4159)
107.6(1338)
3425.(63910)
τ 1
35100.0(4.6E+4)
15210.0(3.5E+5)
48510.0(8.0E+5)
2611(49710)
τ v
-
242.8(321.5)
68.43(143.9)
4.845(9.03)
τ u
-
-
525.3(678.1)
-
DIC
171.17
171.01
173.16
167.95
the same but with an added uncorrelated zero mean Gaussian random eﬀect
(with precision τ v) and model 3 is the same as model 2 but with an added
correlated random eﬀect with a CAR prior distribution and precision τ u. Note
that for the simple regression none of the parameters are well estimated and
even when conventional random eﬀects are added the model is not improved
signiﬁcantly. In fact, the addition of the correlated eﬀect increases the DIC.
Overall the random eﬀects do not appear to improve the model ﬁt to any
signiﬁcant degree. Instead, noting that a non-linear model seems to be more
appropriate as a description of the relation, I consider a low rank spline model
ﬁtted to the predictor:
log θi = α0 + α1x1i + ...... + αpxp
1i + S(x1i)
(7.1)
S(x1i) =
K

k=1
ψk(x1i −ck)p
+
where {ck}, k = 1, ..., K is a set of knots and {ψk} ∼N(0, τψ)
Model 4 is a simpliﬁed version of (7.1) which is simply log θi = α0 +
α1
K

k=1
ψk(x1i −ck)+ . Further model ﬁts using spline only and a full sec-
ond degree polynomial with added second degree spline (p = 2) gave DICs
of 169.8 and 173.8 respectively. This supports the contention that Model 4
provides the best ﬁt in this case, for the models considered.
It is also interesting to note that when a convolution model was ﬁtted
to the data with a linear predictor (Model 3), a large outlier appeared in
the estimated θi . This was for Berkeley county on the urban-rural fringe of
Charleston (see Figure 7.3), where the exceedence probability ( 
Pr(θi > 1))
is 0.903. This is considerably higher than any other county. For the best
ﬁtting spline model none of the counties have excessive θis nor  
Pr(θi > 1)
exceeding 0.7.
To further highlight this eﬀect, a simulation has been carried out, where,
at the individual level, there is a strong positive relation between a binary

Ecological Analysis
155
FIGURE 7.3
South Carolina congenital deaths and percentage of poverty by county 1990:
probability of exceedence of the posterior expected relative risk.
disease outcome and socioeconomic status (income below or above poverty
threshold). It is assumed that there were 100 individuals within 100 areas. An
income distribution was assumed for each region and based on that individ-
uals were categorized as below or above poverty level ($30,000). Conditional
on this given binary variable (xij: poor or not) the probability of disease was
simulated via a logistic transform with added binomial noise. This transform
allows the speciﬁcation of the individual relation between poverty and out-
come: ys
ij < −bin(1, pij)
where logit pij = α0 + α1xij. For the simulation
shown the relation was logit pij = 0.2 + 1.5xij, a reasonably strong positive
relation between outcome and poverty state. Counts of disease were then ag-
gregated across the individuals within areas (j = 1, ..., 100), as was the number
of poor (to yield percentage of poverty). To demonstrate the ability of such
aggregation to yield a relatively complex relationship between outcome and
poverty, Figure 7.4 displays the simulated aggregate relation between aver-
age income and disease count and poverty proportion and disease count. It
is noticeable that while a general increase in poverty seems to relate to an
increase in disease count, this relation does not hold strongly. For some levels
of poverty the relation is not strong and also apparently reversed. The noise
in the relation is quite high of course.
In further simulations, uncorrelated heterogeneity (zero mean Gaussian
noise) was introduced to the linear predictor, and further variation in income
distribution. These changes lead to greater noise in the relation and changes in
the overall gradient or linear form of the relation. Certainly from this output it

156
Bayesian Disease Mapping
45000
55000
65000
0
20
40
60
80
100
average income
aggregate count
0.1
0.2
0.3
0.4
0
20
40
60
80
100
poverty proportion
aggregate count
FIGURE 7.4
Simulation-based aggregate relation between total disease count and percent-
age of poverty for 100 areas with 100 individuals in each area. The loess ﬁt is
shown at the aggregate level. Left panel: count versus average income, right
panel: count versus poverty proportion.
would appear that there is no strong indication of a non-linear positive relation
at the individual level. However, if the focus is the estimation of the aggregate
level relation then it is clear that the overall relation at the aggregate level is
weakly positive (or weakly negative with average income). It is also clear that
a simple log linear model may not represent the variation well. The addition
of extra variation in a model in the form of random eﬀects may help to reduce
the noise but this does not necessarily improve the estimation of the covariate
relation. If the covariate relation is mis-speciﬁed then addition of modeled
heterogeneity may not lead to a better model. This was demonstrated in the
data example above where a spline model, without random eﬀects, yielded
a better empirical model ﬁt, based on DIC, than a convolution model with
log linear predictor. Some authors (e.g., Clayton et al., 1993) have advocated
the inclusion of spatially-structured(CH) random eﬀects to make allowance for
biases induced by the ecological nature of the analysis. In some cases this may
be important, especially when making inferences at a diﬀerent aggregation
level. However, the above example demonstrates that the use of convolution
models (which include CH and UH eﬀects), can yield poor empirical ﬁts when
the aggregate relation is mis-speciﬁed.
In addition to this warning, there is now some evidence that convolution
models, particularly those which have an (improper) CAR model speciﬁca-
tion for the CH eﬀect, can lead to very poor estimation of certain covariate
eﬀects (Ma. et al., 2007). In fact, the use of CAR random eﬀects in lin-
ear combination with linear predictors with spatially-referenced covariates

Ecological Analysis
157
Model A
Model B
Model C
0
1
2
3
4
β
0.0
0.2
0.6
0.4
0.8
1.0
Empirical power (%)
Model A
Model B
Model C
0
1
2
3
4
β
0.0
0.2
0.6
0.4
0.8
1.0
Empirical power (%)
FIGURE 7.5
Empirical power curves estimated from credible intervals for the β parame-
ter from
a distance covariate model which includes additive random eﬀect
terms: Model A covariate model only; Model B as model A with UH term
added; Model C as model B with CH term added. Left panel: no background
heterogeneity; right panel: log Gaussian Cox process with a spatial Gaussian
generating process.
(trend surface components), can yield very poor estimates of the linear pa-
rameters even under a strong linear relation. Figure 7.5 displays two ex-
amples of the empirical power within a simulation of the estimation of a
distance covariate parameter. Case event data were simulated under a va-
riety of models and then a ﬁne grid mesh was used to bin the events to
form counts. The count in the i th bin (yi) was assumed to have a Pois-
son distribution with expectation eiθi. Various models were assumed for θi.
In the display below, Model A is log θi = α + log(1 + exp(−βdi)) where di
is the distance from a ﬁxed location to the centroid of the i th bin; model
B is log θi = α + log(1 + exp(−βdi)) + vi where vi ∼N(0, τv) a UH com-
ponent; and model C is log θi = α + log(1 + exp(−βdi)) + vi + ui where
ui|u−i ∼N(uδi, τ/nδi), a CAR prior distribution. This latter model is a con-
volution model with added covariate term. The simulations were carried out
under a variety of scenarios. Two of these involved variant forms of back-
ground heterogeneity in risk. The left panel in Figure 7.5 has no additional
heterogeneity while the right panel is under a binned log Gaussian Cox model
with a generating process that is a spatial Gaussian process with exponential
covariance: σ exp{−dij/ω} with σ = 0.1 and ω = 0.5 where dij is the distance
between i, j th points. It is noticeable the convolution model appears to have
poor performance under either scenarios in the estimation of the distance ef-
fect compared to either a simple log linear model or an UH component model.
(This performance is also found when a Poisson simulation is made directly
into the bins, and also when a multiplicative log link is deﬁned.) Hence, it is
also important to consider carefully the use of CAR-based convolution mod-
els when covariates are to be estimated. While convolution models are robust

158
Bayesian Disease Mapping
against misspeciﬁcation and are useful for general relative risk estimation (see
e.g., Lawson et al. 2000; Best et al. 2005), there can be considerable aliasing
of long-range spatial eﬀects. Of course, covariates that are not directly spatial
in form but are aliased with such spatial eﬀects (which can be mimicked by
CAR models) may also be aﬀected.
7.2
Biases and Misclassiﬁcation Error
Besides the considerations discussed above, it remains important to consider
aggregate ecological analysis simply to provide a description of aggregate level
relations. Often the biases apparent when aggregate inference is to be pur-
sued are much reduced (see e.g., Greenland 1992; Greenland and Robins 1994).
When inference at diﬀerent aggregation levels is to be considered, however,
additional problems arise. The “gold standard” for inference in medical stud-
ies is often the individual level, in that it is often the aim to be able to
infer an outcome from individual level data. This is true for clinical or in-
tervention trials where individual responses are used as the basis of group
(aggregate/population) summarization or inference. A distinction should be
drawn here between inference to be applied to an individual and inference
made from individual data. The former can be attempted from various levels
of data aggregation (with varying levels of success), whereas inference from
individual level data can be used to make inferences about individuals and
also aggregated levels in the population.
On the other hand, with aggregated data (such as county-level disease count
data) is it possible to make individual inference? This is a much more diﬃcult
undertaking.
7.2.1
Ecological Biases
When inference is made from an aggregated study to a lower level of aggrega-
tion then bias can occur. This bias can have a number of component biases. A
good example of the extent of such bias is given (for a non-medical example).
In the simplest example, assume a linear regression relation with j = 1, ..., ni
individuals in i = 1, ..., m units (areas). Assume ﬁrst that at the individual
level for the j th individual in the i th unit the response model is
yij = a + bxij + eij
= f(a, b, xij) + eij
where E(eij) = 0

Ecological Analysis
159
If we aggregate over the ni individuals then with yi =

j
yij and xi =

j
xij and ei =

j
eij. In this case, a linear model might be
yi = a∗+ b∗xi + e∗
i .
= f ∗(a∗, b∗, xi) + e∗
i .
Now the question essentially is, can we make inferences from a∗, b∗, {e∗
i } at
the disaggregated individual level. In one view, this can be interpreted as an
example of the modiﬁable areal unit problem (see Section 8.1). However, here
inference at a lower level of aggregation is the sole focus.
In general, it is important to consider the model
E(yi) = E(f ∗(a∗, b∗, xi))
(7.2)
where expectation is with respect to y. Here it is often assumed naively that
E(yi) = f(xi) = a + bxi. However if the within-area distribution of xij is
heterogeneous then this will not hold. This also assumes that the individual
relationship has the same form (as well as parameter values) as the aggre-
gate relationship. This is the naive ecological model of Salway and Wakeﬁeld
(2005). We are interested in how (a∗, b∗) relates to (a, b), in particular how
the slope parameter b∗relates to b. Under a logistic model when the response
is binary then b would be the odds ratio for the exposure. In general the eco-
logical bias is the diﬀerence between the estimated b∗, say b∗, and the true
individual parameter b. If the individuals did not vary with their exposures
i.e., xij = xi then there is no bias.
Biases can arise from a variety of sources:
1)
Bias due to confounding: either variables missing on individuals or
group/area level
2) Bias due to eﬀect modiﬁcation: exposure eﬀect varying between
groups/areas
3) Contextual eﬀects: areal/group level variables which are unmeasured
(Greenland and Robins, 1994)
4) Measurement error: there may be error in the classiﬁcation of discrete
exposures or measured confounders, as well as error in continuous covariates
Within area variation in exposure/confounders is a major contributor to
ecological biases. Other sources of bias are of course not unique to ecologi-
cal studies (measurement error and unobserved confounding). These will be
discussed later.
7.2.1.1
Within-area exposure distribution
If its possible to specify the within-area (group) exposure distribution then
it is possible to try to assess the bias of this source. The aggregated model

160
Bayesian Disease Mapping
that corresponds with the basic individual level model integrates over the
distribution of x (assuming the exposures are independent) i.e.,
f ∗(a∗, b∗, xi) = Ex{Ey(yij)} =

f(a, b, xij)p(x)dx
(7.3)
where p(x) is the distribution of the exposure. Salway and Wakeﬁeld (2005)
cite a range of approximations to within-area distributions when there is in-
dependence or no spatial correlation in the data. Of course, in spatial applica-
tions exposures could easily be correlated and we would instead be interested
in aggregation of events from (say) a point process to a count process with
small areas. It has been shown that for a log Gaussian Cox process with sta-
tionary covariance and log linear model for covariates (in this case assume
that the intensity is exp(x(s)β) where x(s) is a spatially-referenced covariate
value at s), then the spatial moments of the within-area distribution can be
computed if the within-area distribution of the covariate is known, i.e.,
EA = 1
|A|

A
exp(x(s)β)ds =
∞

−∞
exp(xβ)dF A(x)
where F A(x) = 1
|A|

A
I(x(s) ≤x)ds
(−∞< x < ∞)
the spatial cdf of x(s) (Cressie et al., 2004). This implies that partial knowl-
edge of F A (e.g., bounds, mean, variance) could be used to characterize the
within-area distribution. For a single binary covariate (xij), and the area av-
erage xi (xi ≈xi/ni) then the expected count for the i th area is
EA = 1 + xi(eβ −1).
More complex situations could arise (with, for example, continuous spatial
ﬁelds). Assume the case of a bivariate continuous covariate with exp(x1(s)β1+
x2(s)β2), and separate spatial means and sample variances are available from
surveys (x1, x2, S2
1, S2
2) with the spatial covariance given by:
C12(A) = 1
|A|

A
(x1(s) −x1)(x2(s) −x2)ds.
The approximation to EA is then
EA
0 = exp(xβ + 1
2βT Γβ)
where x = {x1, x2}, β = {β1 + β2}, and
Γ =

S2
1
C12(A)
C12(A)
S2
2

.

Ecological Analysis
161
Hence as long as the means, variances, and covariances are known, then it is
possible to improve on exp(xβ) by addition of covariation information.
Can adjustments be made in these cases? If the within-area distribution is
known or can be approximated to a reasonable level then the ecological model
can be used directly with these ingredients. For highly skewed distributions
then numerical integration may be required (see e. g. Salway and Wakeﬁeld,
2005). For spatial dependence then the maximum entropy approach appears
to work well.
Another approach to dealing with a range of ecological problems is to try
to include individual level data within the model so that the linkage between
the aggregated and disaggregated data is modeled.
An example of the use of the spatial approximation was applied to the
percentage poverty variable (which is an average of the binary covariate at
the individual level) and the total count of abnormalities by county. For this
situation, we assumed a Poisson data likelihood for the county anomaly count
with expectation eiθi with log θi = β0 + log(1 + xi(eβ1 −1)) where xi is the
percentage of poverty and β1 is the slope parameter. This model was ﬁtted
with prior distributions as follows:
β0 ∼N(0, τ0)
β1 ∼Ga(1, 1)
τ 0 = 1/σ2
0
σ0 ∼U(0, 100)
with the restriction placed on the distribution of β1 due to the possible sam-
pling singularity when xi(eβ1 −1) < −1. This model yielded a DIC of 165.68
which is lower than the spline model already cited. Of course, this does not
necessarily imply that this is the best model for these data. The addition of
a term for uncorrelated heterogeneity (UH), however, yields a higher DIC:
172.54, and in this case does not improve the model ﬁt.
7.2.1.2
Measurement error (ME)
Clearly another source of considerable error in regression models is the pos-
sibility that predictors/covariates/exposures are measured with error. In the
case of a discrete covariate this is called misclassiﬁcation error (Gustafson,
2004). For example, if the data on disease outcome is related to individual
income (as in the example above) with income dichotomized into below or
above poverty level then we have a binary covariate. If someone was wrongly
categorized as poor: (1) when they should be “not poor” (0) then this would
be a misclassiﬁcation. Of course if the outcome is also binary (disease or no
disease) then misclassiﬁcation could occur if diagnosis was prone to false pos-
itives or false negatives. A number of methods are available for such discrete
error problems within a Bayesian paradigm and they are discussed in detail
in Gustafson (2004). For continuous variables it is usual to assume diﬀerent

162
Bayesian Disease Mapping
types of error depending on the form of error appropriate in context. In a sim-
ple binomial formulation assume that and individual has distribution given by
yij ∼bin(1, pij) and logit(pij) = α0 + α1xij. Assume that exposure variable
xij is observed with error. In our example, assume that in this case xij is
the self-reported income for the individual. In a self-report context error may
creep in due to various psycho-social (contextual) eﬀects. Under-reporting of
income may happen when someone does not want to appear “too well-oﬀ,” on
the other hand someone else may want to brag and exaggerate their income.
We might assume this error is additive as a ﬁrst assumption. Hence, a model
for the observed income xij could be
xij = xT
ij + ej
where xT
ij is the true income and also note that the error (ej) has a person-
speciﬁc component. This is regarded as the classical ME speciﬁcation. Now
the relationship with the outcome yij is via a logit link to the covariate.
However we would usually assume that the outcome is related to the true
covariate (and not the error corrupted version. Hence we would want a model
such as
yij ∼bin(1, pij)
(7.4)
logit(pij) = α0 + α1xT
ij.
(7.5)
Now ME could be included in this model in a number of ways. First we could
assume a reverse model for error where xT
ij = xij + ej, which assumes that
by adding noise to the observed variable the true value will be obtained.
Substituting this into (7.5) we have
logit(pij) = α0 + α1(xij + ej).
(7.6a)
This is known as Berkson error (see e.g., Carroll et al., 2006). A suitable
distributional assumption for the random eﬀect ej would be ej ∼N(0, τe).
Two other alternatives can be considered for this error. One is a general
random eﬀect model which decouples the random eﬀect from the covariate to
yield a simple frailty model:
logit(pij) = α0 + α1xij + ej.
While this model has less justiﬁcation than the Berkson model with respect to
ME, it does appear to often demonstrate better goodness-of-ﬁt, presumably
because there is much noise within the model ﬁt in general between yij and
xij, compared to the noise in xij itself. The ﬁnal option is to jointly model
the covariate and the outcome in the sense that both the disease outcome and
the observed covariate depend on the unobserved true value of the covariate.
For example, if the disease outcome were binary and a binomial likelihood

Ecological Analysis
163
model was assumed with logit link then, if the observed data are regarded as
having classic ME, a reasonable model would be
yij ∼bin(1, pij)
logit(pij) = α0 + α1xT
ij,
xij ∼N(xT
ij, τx),
where τ x is a variance term. In this case we now have a latent variable xT
ij
underlying both likelihoods and this can be regarded as an example of a
latent variable or structural equation model (SEM). Hence, a Bayesian SE
model (Stern and Jeon, 2004) could be deﬁned once prior distributions for
the parameters {α0, α1, τx} were deﬁned. Further hyperprior distributions
could be assumed for parameters in the prior distributions deﬁned.
7.2.1.3
Unobserved confounding and contextual eﬀects
Clearly, one major source of error in any regression study, let alone ecologi-
cal study is the possibility of unobserved confounding. Confounding variables
could be those that create diﬀerent responses in the outcome and so, if not
accounted for, may inﬂuence the result. For example, environmental insults
(such as air pollution) could aﬀect asthma outcomes. In addition, smoking
could aﬀect this outcome. Hence a study which did not look at smoking or
other respiratory-challenging lifestyle variables but simply looked at the re-
lation between air pollution and asthma might draw erroneous conclusions.
Such confounders could act to elevate the risk of the disease outcome, pos-
sibly in tandem with the exposure of interest (air pollution). There are two
situations that should be considered.
First of all, direct correlation with the exposure variable may serve to alter
the relation observed. For example, the combination of an observed enhanced
exposure (e.g., air pollution) and (say) low socioeconomic status (via unob-
served average income or an unobserved smoking indicator) could lead to
spurious disease elevation due to the combination of eﬀects (one of which is
unmeasured). This often happens when, for example, industrial sites are stud-
ied and in the vicinity of these sites elevated disease risk is found. However the
vicinity is often also a low socioeconomic status area. This of course supports
the use of deprivation indices (Diggle and Elliott, 1995) or other indices of
risk to make allowance for such eﬀects in environmental epidemiology studies.
Second, it is quite common for unobserved confounders to leave a degree
of variation in risk unexplained in the resulting model ﬁt. It may be that a
confounder present in an area leads to higher disease risk, but the exposure
is low in that area. For instance, areas with high numbers of smokers could
yield high asthma mortality but could be far from air pollution sources. If
smoking status was not measured these areas would appear as large residuals
or outliers. To combat these unobserved confounder problems it has been
suggested that random eﬀects should be introduced into the analysis to “soak

164
Bayesian Disease Mapping
up” this extra variation (see e.g., Lawson, 1996). In general, this supports the
use of generalized linear mixed models (GLMMs) in these analyses, and these
are quite commonly applied now.
Third, unobserved confounders could induce spatially-correlated eﬀects in
the risk variation (Clayton et al., 1993) and so the extension to spatially
correlated (CH) random eﬀects has been recommended. In general, the rec-
ommendation would be that both UH and CH eﬀects should be added in any
study, to allow for diﬀerent possible forms of extra variation. It has also been
emphasized that forms of ecological bias can be, to a degree, accommodated
by the inclusion of CH eﬀects (Clayton et al., 1993). Hence for a Poisson data
likelihood model for a small area disease count we would have
yi ∼Pois(eiθi)
log(θi) = β0 + x′
iβ + ui + vi
where ui, vi are the CH and UH random eﬀects, respectively. While this is
now a general panacea, the caution must be given that a) CH and UH terms
may not improve overall model ﬁt; b) can lead to highly biased estimates
of covariate terms (depending on the prior model assumptions), especially if
aliased with the long range spatial variation; and c) ecological within area
distributional considerations can lead to better aggregate models (which can
ﬁt better than random eﬀect models).
Finally, contextual eﬀects (Goldstein and Leyland, 2001; Voss, 2004; Chaix
et al., 2006) are considered to be variables that specify the socio-environmental
context of an individual are a special case of confounding. Contextual eﬀects
are deﬁned as “aspects of the social and economic milieux of an area which
engender an area outcome eﬀect.” Often these are found at an aggregate level.
For instance, an individuals’s outcome on a clinical trial might be related to
the area they live in. Hence, for example, the county of residence might be a
contextual variable for that individual. Another important example would be
the ecological inversion example. If a person of poor socioeconomic (se) status
lives in a high se area, that can lead to reduced health risk to that individual.
Hence the person’s outcome may be pulled toward the area level expected
outcome. Hence the se status of the area of residence could be an important
variable in explaining health outcome at the individual level and may explain
ecological inversion. A typical model for an individual binary outcome for the
i th individual, yi, might be modeled via a logit link to a probability such as
logit(pi) = β0 + β1x1i + β2xcj
i∈j
where x1i is the individual se status and xcj
i∈j
is the se status of the jth small
area to which the i th person belongs. Of course a range of such eﬀects could
be envisaged where hierarchies of regional or other clustering eﬀects could be
added to an individual level model.

Ecological Analysis
165
7.3
Putative Hazard Models
In this section, I focus on the analysis of a speciﬁc application area: the mod-
eling of disease risk around a known location or locations. This focus is a
particular example of a regression application which can have ecological ele-
ments. Some of the discussion will focus on case event level modeling, which
is not at an aggregated level. However, many of the issues discussed above
are relevant to aspects of this modeling and so for completeness it is included
here.
In putative source analysis, the location(s) of potential (putative) source(s)
of health hazard (pollution or other insult) are known, and it is the task
of the analysis to attempt to ﬁnd out if the source or sources aﬀect health
risk in their vicinity. Hence the term putative is used to mean ‘suspected’
in this case. Many examples come from environmental epidemiology where a
location is the focus of the risk assessment (Lawson, 2002). Putative sources
are related to exposure pathways. For example, if the air pollution is thought
to be important then locations of sources of air pollutants would be the focus
(e.g., incinerators, chimneys, road networks). If the exposure pathway were
water ingestion then the focus might be water sources or supply networks
(e.g., groundwater wells, rivers). Usually the risk is assumed to be related to
location of residence of the population. This is termed residential exposure or
risk, and measures of the relation between the source location and residence
is used in the analysis.
Analyses will be formulated depending on whether a disease is of interest
or whether a source is of potential interest. For instance, if we are interested
in acute asthma risk, then we might monitor emergency room admissions for
asthma in the vicinity of an air pollution putative source (Anto and Sunyer,
1990). On the other hand, if a public report of a general (non-speciﬁc) fear of
an elevation of disease risk in the vicinity of a putative source is made, then
focus may be on the source characteristics and diseases that may be aﬀected.
Hence multiple diseases may ﬁnally be analyzed in this case. For example,
the Sellarﬁeld nuclear reprocessing plant in NW England, United Kingdom,
was the focus of studies in late 1980s. This lead to a variety of radiation-
related disease studies (mainly for radiation-related outcomes e.g., childhood
leukemia) (see e.g., Gardner, 1989). However, risk from such a site may be
from a variety of sources (water pollution, air pollution, occupational radi-
ation risk etc.) besides simply residential air pollution exposure. Hence it is
not always clear what the main eﬀects are that should be modeled. In a study
in NW England of larynx cancer around a putative source (incinerator), evi-
dence for residential exposure was assessed via a distance covariate measured
from residential address of death certiﬁcate and putative source (Diggle, 1990;
Diggle and Rowlingson, 1994). In Figure 7.6, the left panel displays the resi-
dential locations of incident cases of larynx cancer for the period 1974–1983.

166
Bayesian Disease Mapping
FIGURE 7.6
Larynx cancer and lung cancer incident cases in the vicinity of an incinerator
in NW England for the period 1974–1983. The incinerator is marked with
“+.”
The right panel displays the distribution of lung cancer cases for the same pe-
riod. At location (35450, 41400) is an incinerator which is the putative focus
in this case. It could be considered that an incinerator could elevate disease
risk around it and respiratory disease could be a target. The evidence for
the eﬀect of the incinerator could be manifold. The primary eﬀect might be
elevated incidence near the site of the putative source. Hence one might be
tempted to consider a distance decline eﬀect around the source. This would
be a primary form of evidence for a linkage. Of course, confounding due to
correlation between deprivation and distance would need to be considered if
such information were available. For a variety of source type and exposure
pathways distance decline is a fundamental piece of evidence. A secondary
form of evidence is the directional in nature. With air pollution as the pri-
mary putative exposure the eﬀect of wind direction and strength should be
considered. There are many examples where directional eﬀects can be impor-
tant. Often within putative health studies a retrospective analysis of incident
cases or mortality events is carried out. This is often needed as the existence
of a putative source is often only noted after some exposure period has taken
place.
7.3.1
Case Event Data
Diggle (1990) used larynx cancer case residential addresses as the outcome of
interest in a post hoc study of that disease around a putative source (incin-
erator). The study is “post hoc” as elevated incidence of larynx cancer was
registered as a concern by the local residents in the vicinity of the incinerator.

Ecological Analysis
167
This concern motivated the study. The impact of the ”post hoc” nature of the
study is largely a design issue and is discussed more fully in Lawson (2006b,
Ch. 7). The original data used in that study is shown in Figure 7.6. The cases
of larynx cancer (58) within a rectangular study window for the period of
1974–1983 are shown in the left panel. As part of the study, case residential
addresses of respiratory cancer for the same study period were collected. These
were to be used as a type of control disease that could allow for the spatial
distribution of the background “at risk” population. This essentially acts as
a geographical control at a ﬁne resolution level. Any areas where there are
lots of at risk people are more likely to yield cases and so we must adjust for
this eﬀect. The right hand panel of the Figure 7.6 displays the map of these
978 control cases. Some discussion has focused on whether respiratory cancer
is a valid control disease for larynx cancer in a putative air pollution study.
Here we assume that the control is valid, but in general the issue of choice of
control disease is important in any particular application.
Assume we observe within a study region (W), a set of m cases, with resi-
dential addresses given as {si}, i = 1, ..., m. Here the random variable is the
spatial location, and so we must employ models that can describe the dis-
tribution of locations. Often the natural likelihood model for such data is a
heterogeneous Poisson Process (PP). In this model, the distribution of the
cases (points) is governed by a ﬁrst order intensity function. This function,
λ(s) say, describes the variation across space of the intensity (density) of cases.
This function is the basis for modeling the spatial distribution of cases. Denote
this model as
s ∼PP(λ(s)).
The unconditional likelihood associated with this model is given, bar a con-
stant, by:
L =
m

i=1
λ(si) exp{−

W
λ(u)du}
where λ(si) is the ﬁrst order intensity evaluated at the sample locations {si}.
This likelihood involves an integral of λ(u) over the study region.
The deﬁnition of the intensity of cases must make allowance for the eﬀect
of the background at risk population. Often the intensity is speciﬁed with a
multiplicative link between these components:
λ(s) = λ0(s)λ1(s|θ)
Here the at risk background is represented by λ0(s) while the modeled
excess risk of the disease is deﬁned to be λ1(s|θ), where θ is a vector of
parameters. In putative source modeling we usually specify a parametric form
for λ1(s|θ) and treat λ0(s) as a nuisance eﬀect that must be included. Usu-
ally some external data is used to estimate λ0(s) nonparametrically (leading
to proﬁle likelihood). In the larynx cancer example, the respiratory cancer
distribution would be used to estimate λ0(s).

168
Bayesian Disease Mapping
It is possible to reformulate this problem by viewing the joint realization of
cases and controls and, conditional on that realization, examining the prob-
ability that the binary label on a point is either (1: case) or (0: control). If
this approach is taken the background nuisance function disappears from the
problem (Diggle and Rowlingson, 1994). This depends implicitly on a control
disease being available and relevant (i.e., matched well) to the problem.
Assume the problem can be reformulated as a binary logistic regression
where λ0(s) drops out of the likelihood. Denote the control disease locations
as {sj}, j = m+1, ..., m+n, and with N = n+m, a binary indicator function
can be deﬁned:
yi =

 1 if i ∈1, .., m
0 otherwise
∀i, i = 1, ..., N
and the resulting likelihood is just given by
L(s|θ) =
N

i=1
[λ1(si)]yi
1 + λ1(si).
By conditioning on the joint set of cases and controls the resulting logistic
likelihood does not require the evaluation a spatial integral nor the estimation
of a background population function. The deﬁnition of the form of λ1(si) will
be important in inference concerning putative sources of hazard.
Parametric Forms
Often we can deﬁne a suitable model for excess risk within λ1(s). In the case
where we want to relate the excess risk to a known location (e.g., a putative
source of pollution) then a distance-based deﬁnition might be considered, ﬁrst
of all. For example,
λ1(s) = ρ exp{F(s)α + γds}
(7.7)
where ρ is an overall rate parameter, ds is a distance measured from s to a
ﬁxed location (source) and γ is a regression parameter, F(s) is a design vector
with columns representing spatially-varying covariates, and α is a parameter
vector. The variables in F(s) could be site-speciﬁc or could be measures on
the individual (age, gender, etc.). In addition this deﬁnition could be extended
to include other eﬀects. For example, we could have
λ1(s) = ρ exp{F(s)α + ηv(s) + γds}
(7.8)
where v(s) is a spatial process, and η is a parameter. This process can be
regarded as a random component and can include within its speciﬁcation
spatial correlation between sites. One common assumption concerning v(s) is
that it is a random ﬁeld deﬁned to be a spatial Gaussian process.

Ecological Analysis
169
An example of the kind of speciﬁcation typical in a putative source ex-
ample would involve a range of variables or functions of variables thought
to be indicative of risk association with the source. The variables included
depend on the context. In retrospective studies where no information or di-
rect measures of emission patterns are available then resource must be made
to exposure surrogates (i.e., variables that may show a retrospective linkage
with the source). Distance from source is a prime example of a variable that
might yield such information. Direction from source to residence may also be
indicative of wind-related eﬀects (particularly in air pollution studies). For
prospective studies, direct measures of pollutant outfall (such as soil-sampled
or air-sampled chemical or particulate concentrations) could be monitored
over time. Without these direct measurements, surrogates would be required
and often these would have to represent historical time-averaged eﬀects in
retrospective studies.
What form would a relevant exposure model take?
The deﬁnition for
λ1(s|θ) often assumed is as follows (see Diggle, 1990; Diggle and Rowling-
son, 1994; Lawson, 1995; Diggle et al., 2000; Wakeﬁeld and Morris, 2001,
Lawson, 2006b for variants):
λ1(si|θ) = exp{A1i}. exp{A2i}.A3i
(7.9)
A1i = x′
iβ + z′
iγ
A2i = ρ1 cos(φi) + ρ2 sin(φi)
A3i = [1 + α0e−α1di]
θ = {β, γ, α, ρ}, α = {α0, α1}, ρ = {ρ1, ρ2}. Here the distance variable is de-
ﬁned as di = ||si, c|| where c is the putative source location and the angle to
the source is deﬁned as φi. A generalization allows there to be multiple sources
and we can include these in one model by adding further distance or direction
variables with parameters. This is not pursued here. The rationale for each of
the terms (A1,A2, A3) is as follows. All terms are exponentiated to ensure posi-
tivity, although term A3i has a link parameter (α0) which requires a constraint
so that α0e−α1di < 1. The term A1i consists of covariates and random eﬀects.
The row vector of covariates (x′
i) can consist of personal covariates (although
within a logistic likelihood model these would have to be available for the
control as well as case disease. The corresponding regression parameters are
the vector β. The covariates can include functions of cartesian coordinates for
trend estimation and these are available for all locations. The individual level
random eﬀects can be included via the row vector z′
i with the corresponding
unit vector γ. These eﬀects could include individual frailty terms (with, for ex-
ample, zero mean Gaussian prior distributions) or correlated eﬀects where the
prior distribution includes some form of spatial correlation. The general spec-
iﬁcation above in (7.7) and (7.8) demonstrates a variant of this speciﬁcation.
The term A2i speciﬁes the directional dependence in the outcome. By includ-
ing functions of the trigonometric functions (cos, sin) it is possible to recover
the mean angle of the exposure. In this case only linear functions are assumed.

170
Bayesian Disease Mapping
More complex variants are possible (see e.g., Lawson, 1993b) that allow for
angular-distance correlation or peaked distance eﬀects. An alternative speciﬁ-
cation for the distance eﬀect could be A2i = ρ1 cos(φi −μ0). Here the ρ1 plays
the role of an angular concentration parameter and the angle is measured rel-
ative to an overall mean (μ0). If a predominant time-averaged wind direction
is found to aﬀect a source then the estimation of μ0 might be important in
determining a link to a source. Finally, the term A3i deﬁnes the distance eﬀect.
The rationale for the hybrid-additive form, [1+α0e−α1di], is the idea that risk
at distance from the source should not aﬀect the background disease risk. If
a multiplicative model were assumed (such as A3i = e−α1di) this would lead
to a reduction in risk at great distances which is not appropriate. It should
be mentioned however that often it is much more diﬃcult to estimate α0, α1
under the hybrid-additive model as the parameters are not well identiﬁed and
constraints must be placed on α0e−α1di (see also Ma. et al., 2007).
More
details of possible model variants are given in Lawson (2006b, Ch. 7). Step
function forms have been proposed by Diggle et al. (1997), but the underlying
rationale for these, that there could be a zone of constant risk around a source,
is not bourne out by dispersal models or empirical studies of source disper-
sion. On the other hand, peak-decline models are supported by time-averaged
dispersal models (see e.g., Arya, 1998). A simple example of this general ap-
proach is given in Wakeﬁeld and Morris (2001), albeit for an aggregated small
area application. In that work the A2i = 0 with no assumed directional ef-
fects, and A1i = β0 +β1x1i +ui +vi a single deprivation index covariate (x1i)
and two random eﬀects (one correlated ui and one uncorrelated vi). The third
term is deﬁned as A3i = [1 + α0e−(di/α1)2] which gives a Gaussian distance
eﬀect rather than exponential. However the comments above also apply to this
model form.
A general speciﬁcation for the logistic example applied to the larynx cancer
data has been speciﬁed in 6.2.1.2. In that section the focus was on cluster
detection. However the underlying model used there is also relevant here. The
model assumed for the case probability was
pi =
λ(si|θ)
1 + λ(si|θ)
λ(si|θ) = exp{β0 + vi}.{1 + exp(−α1di)}
where di is distance from the incinerator, β0 was an intercept term, and
vi ∼N(0, τv) an uncorrelated random eﬀect, and zero mean Gaussian prior
distributions for the β0 and α1 parameters. There is no directional term. In
this case this is justiﬁed given the choice of study area: a rectangle with the
putative source close to one region boundary. This means that much of the
directional data are censored (outside the boundary of the region). Hence
there is limited use in including a directional model here. A correlated ran-
dom eﬀect could also be included within this model, though this is not re-

Ecological Analysis
171
ported here. For case-control data this is possible either by assuming a full
multivariate Gaussian process prior distribution for the correlation (with co-
variance speciﬁed as a function of inter-point distances). It is also possible
to specify neighborhoods via the construction of a Dirichlet tesselation of the
complete realization and the derivation of tile neighbors. Care must be taken
in this latter case to avoid edge eﬀects, although these should not be great for
the deﬁnition of neighborhoods (rather than distances). In our example the
posterior expected estimates of β0 and α1 (with sds in brackets) were -6.35
(0.831) and 0.695 (3.054). Hence, in this example the overall rate was well
estimated whereas the distance eﬀect is not. The posterior expected estimate
of the precision of the uncorrelated random eﬀect was 0.1229 (0.07413) in the
model where vi ∼N(0, τv) and τ v = 1/a2 where a ∼U(0, 100) following the
suggestion of Gelman (2006).
Some comments concerning analyses of putative source data should be made
in light of the general discussion above concerning ecological bias, confound-
ing, contextual eﬀects and measurement error. While some of these comments
are most appropriate to the aggregated data situation, we discuss many issues
here which are common to both.
First of all, it is important to critique the model components included above.
Should correlated random eﬀects be included? Would they absorb the eﬀects
of unobserved confounders? In general it may be important to include both un-
correlated and correlated eﬀects, from the standpoint that confounders could
induce noise eﬀects of both kinds. However it should be borne in mind that
confounders correlated with the distance or directional eﬀects are not likely
to be removed by random eﬀect inclusion. The inclusion of variables in the
analysis that inform about context could also be important. For example de-
privation indices available at a level aggregated above residence (such as at
census tract or zip code) could help to inform about regional excess risk. Of
course deprivation might be correlated with distance or direction. In Wakeﬁeld
and Morris (2001) this was certainly true. In the same work, less smoothers
of the distance eﬀect suggests that an irregular decline occurs and it may
be more appropriate to consider spline models for the distance and or di-
rection. In fact a 2-D spline model for the distance and directional eﬀect
could be a useful inferential tool. Of course splines may not yield unequiv-
ocal evidence for a risk gradient. The possibility that ecological bias exists
in aggregate data will be discussed in the next section. The possibility that
measurement error (ME) exists in outcome or covariates can also be impor-
tant. For example misdiagnosis could occur where a control could in fact be
a case or vice-versa. This would be more likely if the two diseases were linked
by progression. For example, early stage breast cancer could be used as a
control for late stage breast cancer. Clearly the staging could be subject to
misclassiﬁcation. ME could exist in any covariates whether its the location
of an address or the socioeconomic status of an individual or the deprivation
status of a region. One solution for covariates is to either assume Berkson

172
Bayesian Disease Mapping
error and a model such as
β1(x1i + εi)
εi ∼N(0, τε)
where x1i is a covariate or to utilize the SEM approach and to specify a joint
model for the covariate and the outcome.
7.3.2
Aggregated Count Data
It is often relevant or feasible to consider the analysis of count data within
aggregated spatial units (small areas). These units will usually be arbitrary
political administrative units (e.g., census tracts, zip codes, counties, munici-
palities, postal zones etc.). The deﬁnition of these units should have little or
no impact on the health outcome observed.
Assume we observe counts {yi}, i = 1, ..., m in m small areas and, we
also observe expected rates {ei}, i = 1, ..., m. While we usually assume the
expected rates to be ﬁxed for our purposes, it could be useful to consider
them to be random quantities also (see e.g., Best and Wakeﬁeld, 1999). Here
we mainly focus on ﬁxed expected rates.
A typical model at the data level is often
yi ∼Pois(μi)
μi = eiθi
and the focus is on the modeling of the relative risks {θi}. Usually the log
relative risk is the focus and we often formulate a model akin to that in (7.9)
where the i th small area is ‘located’ at its centroid. Of course this assumes
an average eﬀect over the small area rather than direct modeling of the risk
aggregated from the point process model. Direct aggregation from a Poisson
process would give yi ∼Pois(

ai
λ(u|θ)du), where ai is the physical extent
of the i th small area. Now if both λ0(s) and λ1(s|θ) were constant over the
area (a strong assumption) then this would result in λ0i.λ1i.|ai| (where here
|.| denotes ‘area of’) which is almost the same as eiθi bar the area eﬀect.
The expected rate is usually standardized over the population rather than
area. However if you make the (strong) assumption that the population is
uniform of course then if the ei is speciﬁed for the local population then the
assumption is that λ0i|ai| ≈e∗
i ni = ei where e∗
i is the externally standardized
unit population rate. This decoupling approximation as it’s called is often
made as the starting point of an analysis. It is not usually unreasonable when
non-spatial region-speciﬁc covariates are included but it can be important
when spatially-dependent covariates (such as interpolated pollution measures)
are involved.

Ecological Analysis
173
Making the simple assumption of μi = eiθi, then we can specify the general
model as
θi = exp{A1i + A2i + log(A3i)}
A1i = x′
iβ + z′
iγ
A2i = ρ1 cos(φi) + ρ2 sin(φi)
A3i = [1 + α0e−α1di]
where the i th small area is located at the centroid or other suitable associated
point, di is the distance from the centroid to the source location, φi is the
angle from the centroid to the source location. Often it is assumed that A1i =
β0+ui+vi where the typical convolution model with a CAR prior distribution
of Chapter 5 is assumed:
ui|u−i ∼N(uδi, τu/nδi)
vi ∼N(0, τv)
With small area data and neighborhoods deﬁned then a CAR is a convenient
and reasonable assumption. An alternative speciﬁcation could be of the form
of a full multivariate Gaussian with a covariance matrix, thus
u ∼N(0, σ2Γ)
where the i, j th element of the covariance matrix is γi,j = exp(−dij/φ).
This has the advantage of directly modeling distance eﬀects, has a distance-
dependent covariance and also has a zero mean vector, and so models a sta-
tionary process.
The CAR speciﬁcation is not stationary and can suﬀer from aliasing with
long range spatial eﬀects (see e.g., Ma. et al., 2007). One option is to use a
proper CAR with trend speciﬁcation. Unfortunately, the full MVN speciﬁca-
tion requires inversion of an m × m covariance matrix whenever new parame-
ters are evaluated, e.g., within a posterior sampling algorithm. This could be
a major computational disadvantage.
In the example below, respiratory cancer incidence for the year 1988 in
the counties of Ohio was examined. The U.S. Department of Energy Fernald
Materials Processing Center is located in southwest Ohio (Hamilton County).
The Fernald facility recycles depleted uranium fuel from U.S. Department of
Energy and Department of Defense nuclear facilities. The facility is located 25
miles northwest of Cincinatti. The recycling process can create a large amount
of uranium dust which is radioactive. The period of greatest emission activity
was between 1951 and the early 1960s and during that period some dust may
have been accidentally released into air. Respiratory cancer is of interest in
relation to a potential environmental health hazard. Exposure to radioactive
contaminated air in the vicinity of the facility could, over a period of years,
lead to increased risk for a variety of diseases. Exposure risk can be considered

174
Bayesian Disease Mapping
to be increased if residence were proximal to the facility during the highest
activity years or in subsequent decades.
One disease of concern to evaluate would be respiratory cancer as it is the
most prevalent form of cancer potentially associated with this exposure. An
exposure pathway via inhalation would be considered. Available is data for
Ohio counties for the period 1988 for counts of respiratory cancer. This period
is suﬃciently lagged from the peak emission time that the cancer lag time (20–
25 years) should have passed. The expected rates used for standardization here
are the Ohio state standardized for age, gender breakdowns of each county.
Two covariates at the county level are also available. The ﬁrst covariate is
the percentage of poverty for each county from the 1990 census. The 1990
census is used as it is the nearest to the year in question and the level should
remain reasonably stable over two years. This covariate would be useful in
allowing for deprivation eﬀects that could confound the respiratory cancer
outcome. This may include general health outcomes but also behavioral eﬀects
such as smoking or use of alcohol in lifestyle. The second covariate is the
simplest exposure surrogate variable: distance from the site. This distance
was computed to the centroids of the counties.
A sequence of models was ﬁtted to these data with diﬀerent assumptions.
First of all a basic model with a convolution prior distribution for spatial
eﬀects, and measurement error for both covariates was considered with the
form:
yi˜Pois(ei.θi)
θi = exp{α0 + α1(x1i + ϵ1i) + α2 log(fi) + ui + vi}
fi = 1 + exp{−α3(di + ϵ2i)}.
The random eﬀects ϵ1i, ϵ2i have zero mean Gaussian prior distributions with
standard deviations with uniform distributions on the range (0,10) (Gelman,
2006). These represent Berkson error in the covariates. We also considered
diﬀerent prior distributional assumptions for the random eﬀects in the convo-
lution component. The ﬁrst option (Model 1 in Table 7.2) was with ﬁxed but
very small precisions (0.0001) for the uncorrelated random eﬀects (vi, ϵ1i, ϵ2i)
and second with variance hyperprior distributions (τ ∗= 1/σ2
∗; σ ∼U(0, 10)).
Also considered was a variant of the CH eﬀect: a proper CAR model (Sec-
tion 5) with cij =
1
nδi if i ∼j and cij = 0 if i ≁j. This model with no
measurement error yielded γ = 0.729(0.142), τ pc = 8902.0(26010.0) with a
DIC of 557.03 for model with ﬁxed precision on the UH eﬀect (0.0001). Over-
all, diﬀerent precision speciﬁcations seem to aﬀect the model ﬁts considerably
in that Model 2 is much superior to Model 1. The inclusion of ME appears also
to be important as is the distance eﬀect, even when it is not well estimated
(Model 4). Interestingly, and as a caution, model 1 yields a signiﬁcant distance
eﬀect ( 
α1 , 
α2) and supports the idea of a possible source eﬀect. However out
of the models ﬁtted, the lowest DIC is for the model with a CAR component

Ecological Analysis
175
TABLE 7.2
Results for a variety of models ﬁtted to 1988 respiratory cancer incident counts for counties
of Ohio
Model
DIC
α0
α1
α2
α3
1 (ﬁxed precisions)
656.23
-0.506(0.275)
0.111(0.002)
-2.043(0.065)
2.296(0.063)
2 (variance H-priors)
520.49
-0.362(0.108)
0.030(0.009)
-0.242(0.279)
4.993(5.252)
3 (no ME)
616.75
-0.935(0.350)
0.034(0.006)
0.526 (0.400)
-0.156(0.180)
4 (no distance)
619.35
-0.490(0.074)
0.034(0.006)
-
-
5 Proper CAR
557.03
-0.817(0.059)
0.061(0.006)
0.024(0.004)
-6.204(1.072)

176
Bayesian Disease Mapping
and precision hyper-prior distributions, with measurement error, where the
distance eﬀect is not signiﬁcant.
Other analyses of these data, especially in the more general space–time
context, are found in Zia et al. (1997), Waller et al. (1997), Carlin and Louis
(2000), Knorr-Held and Besag (1998), Knorr-Held (2000). Measurement error
was considered by Zia et al. (1997) in a space–time context.
7.3.3
Spatiotemporal Eﬀects
When data are observed with a time label then it is possible to extend mod-
eling by considering spatiotemporal eﬀects. Perhaps the most convenient way
to do this is to consider a breakdown of eﬀects between main eﬀects of space
and time separately and the interaction between space and time.
In Section 11 a more general review of disease mapping models is made.
Here we brieﬂy consider how space–time data can be modeled with putative
sources of hazard as the main focus. The extension of methods for spatial
applications to where we have data observed in space and time is immediate.
7.3.3.1
Case event data
Assume we observe within a study region (W) and a time period (T ), a set of
m cases, with residential addresses given as {si}, i = 1, ..., m, and also time
labels {ti}, i = 1, ..., m. Here the random variables are the spatial location
and the time of occurrence, and so we must employ models that can describe
the distribution of locations and times. A recent review of a wide range of
approaches to space–time point process data appears in Diggle (2007). Time
here could be a diagnosis date, date of death or cure. The heterogeneous
Poisson process (hPP) model assumed for spatial data can be extended to
space–time readily. In this model, the distribution of the cases (points and
times) is governed by a ﬁrst order intensity function. This function, λ(s, t),
describes the variation across space and time of the intensity of cases. This
function is the basis for modeling the spatiotemporal distribution of cases.
Denote this model as
PP(λ(s, t)).
As in spatial applications, the unconditional likelihood associated with this
model is given, bar a constant, by:
L =
m

i=1
λ(si, ti) exp{−

W

T
λ(u, v)dudv}
where λ(si, ti) is the ﬁrst order intensity evaluated at the sample locations
{si, ti}. This likelihood involves an integral of λ(u, v) over the study region
and time period.
The deﬁnition of the intensity of cases must make allowance for the eﬀect
of the background at risk population, which in this case will be time-varying.

Ecological Analysis
177
Often the intensity is speciﬁed with a multiplicative link between these com-
ponents:
λ(s, t) = λ0(s, t)λ1(s, t|θ).
Here the at risk background is represented by λ0(s, t) while the modeled
excess risk of the disease is deﬁned to be λ1(s, t|θ), where θ is a vector of
parameters. As before a likelihood model can be derived from this likelihood
and Bayesian methods could be based on this form. An example of using this
form in cluster detection was given by Clark and Lawson (2002). The disad-
vantage of using this form is the need to integrate the intensity over space
and time. This can be avoided if a control disease were available within the
study region over the same time period. Once again the conditional logistic
model could be derived. Assume that a control disease is governed by intensity
λ0(s, t). The joint realization of case and control diseases for a Poisson pro-
cess with intensity λ0(s, t)[1 + λ1(s, t|θ)]. Then by conditioning on the joint
realization, the binary labeling of the points will be governed by the case
probability
pi =
λ1(si, ti|θ)
[1 + λ1(si, ti|θ)]
Then given the set of locations, the point labels (yi) can be considered at
the data level to be independently distributed with a binomial distribution:
yi ∼bin(1, pi).
This is, again, just a logistic model for the binary outcome, where the prob-
ability is a function of space and time. Interest will focus on the deﬁnition of
the excess or relative risk function λ1(si, ti|θ). The speciﬁcation of λ1(si, ti|θ)
will depend on the context and will be important to include covariates, ide-
ally time-varying, as well as random eﬀects. Variates that pertain to evidence
for a link to a putative source of hazard could be various. First a general
formulation could be as follows:
λ1(si, ti|θ) = exp{A1i + A2i + A3i}
A1i = x′
iβ + z′
i(t)γ
A2i = f(di, φi, ti)
A3i = Σi + ξi + ψi.
Within A1i are terms depending on ﬁxed constant covariates (x′
i) and their
parameters β, and also terms depending on time-varying covariates z′
i(t) and
their parameters γ. Time varying covariates could be very important in these
studies. For example in a prospective study, if pollutant concentration were
available at diﬀerent times then these would be time-varying. For term A2i
functions of distance to source (di) and angle to source could be important
(as in the spatial case). However, because a source may vary its output over
time, the resulting spatial risk ﬁeld would vary over time, and so time varying

178
Bayesian Disease Mapping
eﬀects should be included in A2i. The ﬁnal term includes random eﬀects that
can allow for spatial (χi), temporal (ξi), and spatiotemporal interaction (ψi).
Note that in all analyses, covariates would have to be available for all case
and control locations. Special methods would have to be developed when this
was not the case.
An example of a possible model for a time-vary emission source (air pollu-
tant) could be, for data given with polar coordinates (φi, di):
λ1(si, ti|θ) = exp{β0 + β1x1i + β2x2i + fi(t) + χi}
where x1i is the age of the person, x2i is the socioeconomic status of the
person, and
fi(ti) = log(1 + α0(ti) exp{−α1(ti)di}) + κ(ti) cos(φi −μ(ti)}
α0(ti) ∼Gamma(c0μ(ti), c0)
α1(ti) ∼N(α1(ti−1)/Δ(ti, ti−1), τ α1)
where μ(ti) could be deﬁned as a time-varying risk function for example, and
α1(ti) is a form of Gaussian process and Δ(ti, ti−1) is the time diﬀerence
between the i th and the previous case/control. Note also that the directional
component with precision κ(ti), and mean angle μ(ti) will also in general vary
with time. Essentially the time-averaging that is assumed for a static spatial
model must be dropped here in favour of a parsimonious dynamic model.
While of course a convolution of Gaussian distributions could be employed
for a directional component around a source (see e.g., Esman and Marsh,
1996; Arya, 1998), this is not parsimonious compared to a Von Mises-type
formulation such as exp{κ(ti) cos(φi −μ(ti)}. The ﬁnal component of the risk
function could consist of spatial and temporal random eﬀects and interaction
eﬀects. Care should be taken in the choice of such eﬀects as the ability to detect
exposure eﬀects may depend on the speciﬁcation of the random components.
First we could consider a separate spatial component, such as χi where spatial
dependence (ﬁxed in time) could be speciﬁed either via a Gaussian process
speciﬁcation with a distance-based spatial covariance (i.e., χ ∼MVN(0, Γ)
where Γij = σ2 exp{−αdij}. Further CAR alternatives could be considered
if a suitable neighborhood structure were assumed. Second temporal eﬀects
could be assumed whereby a conditional autoregressive Gaussian dependence
is deﬁned on the time lag between events:
ξi ∼N(f(ξi−1), τξ)
f(ξi−1) = αξi−1/Δ(ti, ti−1).
Finally, a space-time interaction could be assumed. Various speciﬁcations
could be imagined for this ranging from nonseparable dependence structures
(see e.g., Knorr-Held, 2000; Gneiting et al., 2007) to independent eﬀects. The
simplest and most parsimonious form might be
ψi ∼N(0, τψ).

Ecological Analysis
179
This would at least reassure that aliasing between covariate eﬀects varying
over time would be minimized.
Finally it should be noted that often the binary outcome in space–time is
an ‘end-point’ event, say, for example, in an infectious disease situation where
infection spreads within a ﬁnite population. In that case, special survival-
based methods can be used to examine the progression of the disease (Lawson
and Leimich, 2000; Lawson and Zhou, 2005). Examples of space–time analysis
around sources of pollution are few and this area is one that could be much
further developed.
7.3.3.2
Count data
In the situation where small area counts are recorded within ﬁxed time periods
in a sequence, the modeling approach is a relatively straightforward extension
of the spatial case. Deﬁne the counts of disease within i = 1, ..., m spatial
small areas and j = 1, ..., J disjoint and adjacent time periods as {yij}. The
corresponding expected rates with these space–time units are {eij}. Also as-
sume relative risk parameters for each unit: {θij}. The basic data model is
often again Poisson with
yij ∼Pois(eij.θij).
Inference focuses on terms within the speciﬁcation of θij. Also assume that the
distance and direction (angle) from a source is known and can be computed
as (di, φi). Assume a log linear form:
θij = exp{A1i + A2j + A3ij}.
Here the terms have an explicit spatial (i), temporal (j), and interaction (ij)
label. An example of a typical speciﬁcation could be:
A1i = f(x′
iβ)+ui + vi
(7.10)
A2j = ξj + g(αjdi) + κj cos(φi −μφj)
(7.11)
A3ij = ψij.
Here, the ﬁrst term includes ﬁxed covariates within small areas (including
distance and direction), and so f(x′
iβ) could include functions of ﬁxed areal
covariates (poverty, SEs, distance, direction) whereas ui, vi could be the usual
CH and UH random eﬀects (see e.g., Heisterkamp et al., 2000 for an early
example). The second term has the temporally dependent components. The
random eﬀect (ξj) often has an autoregressive dependence. The term g(αjdi)
would be a function of the time dependent parameter αj which relates to
distance. Again an autoregressive dependence could be assumed for this. The
directional parameters κj and μφj also can have dependence on previous times.
Time variation of output from sources can possibly be modeled in this way.

180
Bayesian Disease Mapping
Finally the interaction can have prior independence or can have prior non-
separable structure (Knorr-Held, 2000).
In the example that follows I have applied a quite general model to the vari-
ation over 10 years (1979–1988) of respiratory cancer in Ohio. I have assumed
a general model of the form:
yij ∼Pois(eij.θij)
θij = exp{A1i + A2j + A3ij}.
Here, we assume no directional eﬀect as the spatial scale of the county level
data is quite large and it is unlikely that a directional eﬀect could be manifest
at this scale. We also assume that a distance eﬀect could still remain even via
occupational exposure and so we model this here:
A1i = α0 + α1 log[1 + α2 exp{−α3di}] + ui + vi
A2j = ξj
A3ij = 0
with
ui|u−i ∼N(uδi, τ u)
vi ∼N(0, τv)
ξj ∼N(ξj−1, τξ).
The variance parameter (τ ∗) distributions are assumed to be deﬁned with
√τ ∗∼U(0, 10). The regression parameters are all assumed to have zero mean
Gaussian distributions with large variances (1/0.00001).
Alternative models have been considered. First the addition of A3ij = ψij
with ψij ∼N(0, τψ) was examined (Model 2). Finally, temporal dependence
in the regression parameters was considered. Speciﬁcally, an auto-regressive
prior distribution was assumed for α3. of the form α3j ∼N(α3j, τ3) which
leads to the
A1ij = α0 + α1 log[1 + α2 exp{−α3jdi}] + ui + vi.
Table 7.3 displays the results of the ﬁtting process. The model displaying the
best ﬁt overall is Model 3 with no space–time interaction with ﬁxed α1, α2
but with temporally dependent α3j.
Figure 7.7 displays the estimated temporal random eﬀect (ξj) and 95% cred-
ible interval for model 1. Figure 7.8 displayed the results for the same eﬀect
but under Model 2 with zero-mean Gaussian space–time interaction. Figure
7.9 displays the posterior averaged temporally dependent distance regression
eﬀect for Model 3. Figure 7.10 displays the corresponding posterior averaged
time dependent random eﬀect for all years for Model 3. Note that in Model
3 it was necessary to ﬁx α1 = α2 = 1, due to the identiﬁability issues when

Ecological Analysis
181
TABLE 7.3
Ohio respiratory cancer (1979–1988): putative source model ﬁts
Model DIC
α0
α1
α2
α3
1
5762.6 -0.393(0.082) 129.8(22.8)
0.003(3.69E-4) 0.047(0.072)
2
5759.8 27.16(0.086)
-362.4(3.14) 0.101(4.36E-4) 0.089(9.35E-4)
3
5739.9 -0.625(0.063) 1
1
-
time dependence is allowed for these parameters. It is clear out of the limited
number of models that have been ﬁtted here, that a time-varying regression
on a simple model of distance is considerably better (in terms of DIC) than
constant parameters. The time dependent distance eﬀect, α3j, remains well
estimated under this model whereas the temporal random eﬀect is negligible.
Model 3 did not include an interaction term and it would also be interesting to
examine the eﬀect of inclusion of such a term, though this is not pursued here.
Note also that for many applications it would also be important to include a
directional eﬀect (possible time-varying) in the model (such as in 7.11). Fi-
nally, we have not presented the mapped output for the posterior averaged
spatially-expressed random eﬀects in this model (CH and UH). These may be
of interest for the examination of unusual aggregations of risk as they appear
or disappear over time. Of course, Bayesian residuals, predictive residuals, or
even exceedence probabilities can be computed for space-time models in the
form: qij =  
Pr(θij > 1) =
K

k=1
I(θk
ij > 1)/K where {θk
ij}, k = 1, ..., K is the
posterior sampled values of the relative risk for each region and time period.
Residual maps or maps of qij could also be very informative. Of course, as
noted earlier, the reliability of qij heavily depends on the correctness of the
model.
The main emphasis in this section has been in demonstrating the mod-
eling of spatiotemporal eﬀects when time is included. Other issues that are
not addressed here, but which could be important are measurement error in
covariates or outcomes, ecological bias when making inference at lower aggre-
gation levels from space-time data, and contextual or confounder eﬀects.

182
Bayesian Disease Mapping
1980
1982
1984
1986
1988
−0.04
0.00
0.04
year
log(time RE)
FIGURE 7.7
Ohio respiratory cancer: 1979–1988; estimated temporal random eﬀect with
95% credible interval for Model 1.
1980
1982
1984
1986
1988
−0.04
−0.02
0.00
0.02
0.04
0.06
year
log(time RE)
FIGURE 7.8
Ohio respiratory cancer 1979–1988: posterior average temporal random eﬀect
with 95% credible interval under Model 2 with zero-mean Gaussian interac-
tion.

Ecological Analysis
183
1980
1982
1984
1986
1988
0.0
0.5
1.0
1.5
2.0
2.5
3.0
year
α3j
FIGURE 7.9
Ohio respiratory cancer 1979–1988: space–time model with time-dependent
diance eﬀects. Plot of posterior average distance eﬀect over years with 95%
credible interval
1980
1982
1984
1986
1988
−0.6
−0.5
−0.4
−0.3
−0.2
−0.1
0.0
year
ξj
FIGURE 7.10
Ohio respiratory cancer 1979–1988: posterior average time random eﬀect (ξj)
with 95% credible interval.


8
Multiple Scale Analysis
The spatial analysis of single diseases is often suﬃcient. However, in some
applications there is a need to consider diﬀerent scales of aggregation within
an analysis.
One such situation arises when it is of interest to consider a relationship
at diﬀerent aggregation levels. For example, if the relation of an outcome
at county level to a covariate is examined, will the relationship hold true
at lower aggregation levels (e.g., census tract) or at higher levels (e.g., state
or country)? In general, it is unlikely that this would be the case as, if it
were, there would be little need to consider diﬀerent levels of analysis. In fact
ecological bias would not occur. Scale change issues are often known as the
modiﬁable areal unit problem (MAUP), whereby modiﬁcation of the areal
units could lead to diﬀerent inferences. In geostatistics, this is known as the
change of support problem (Cressie, 1996; Banerjee et al., 2004).
8.1
Modiﬁable Areal Unit Problem (MAUP)
The MAUP can be considered to have a variety of special cases. One of these
is that of ecological bias (seen in Chapter 7) where the issue is whether in-
ference can be made at a lower level of aggregation (individual level usually)
from aggregate data. For example, can we make inferences from county or
region level analysis to the individual level? We saw in that case there are
various aspects of this problem. These include measurement error, knowledge
of the within area distribution of exposures, contextual eﬀects, and unobserved
confounding.
8.1.1
Scaling Up
By scaling up, I mean trying to make inferences at a higher aggregation level
than that used in the analysis. In general, aggregation leads to smoothing
or averaging of data. For example, a spatial process is present at location
s, z(s) say, and when observed over a larger area A, the process will be a
smoothed version i.e., z(A) =

A
z(u)du. The integration is with respect to
185

186
Bayesian Disease Mapping
the extent of A. Note that the mean of the process in A can be deﬁned as
μ(A) =

A
z(u)du/|A|,where |A| =

A
du. This can be regarded as an average
over the area. Note that this integration leads to a reduction in variability,
and so at the aggregate level we would expect there to be less variability.
Cressie (1993, Section 5.2), noted this aspect in a geostatistical context. In an
analogy with GIS operations, this is equivalent to zooming out in a map oper-
ation. One problem that this leads to is that processes operating at diﬀerent
aggregation levels may appear, or become important, at diﬀerent scales. The
possibility that the process observed at diﬀerent scales will behave diﬀerently
is clear. This suggest that ‘scale labeling’ is useful when dealing with changes
in support or aggregation. By scale labeling, I mean the allocation of a scale
of operation of a process. Methods for incorporation of scale eﬀects within a
Bayesian analysis of small area health data are various.
First, it is clear that it is possible to consider aggregated variables as con-
founders within an analysis. Multilevel modeling (Leyland and Goldstein,
2001) often addresses the issue of multiple levels within an analysis and these
can include spatially-aggregated covariates. This of course includes contextual
eﬀects as a primary example (see Section 7.2.1.3; also Goldstein and Leyland,
2001). In general, the scaling up of health outcomes has been described for
individual (point process) to small area (count) in previous chapters. Denote
a scale level (integer) variable: lk, k = 1, ..., K where K is the number of lev-
els. It is assumed here that aggregation levels can be discretized into such
levels. Hence, an aggregation involves an outcome model indexed by the level:
fk(yik; μik, lk). Here, yik i = 1, ..., m is the outcome variable for m units. (As-
sume here that this could be binary or a count or less often continuous.) Note
that at diﬀerent levels there could be diﬀerent models and so subscripted fk
is appropriate. We need to establish the relation between levels of the scaling.
Given a set of levels it is tempting to consider a general model formulation
which links levels in the analysis. Assume that all units are aligned and that
k is ranked from lowest to highest aggregation level. Deﬁne the set alignment
as follows: there are mk regions at the k th level and for k = 2, .., K there are
mk−1regions at the lower aggregation. The allocation of the regions at mk−1
to the mk regions is deﬁned by Si,k which is the set of regions at the k−1 level
uniquely within the i th region at the k th level. For count data this would
mean that yik =

l∈Si,k
yl, yik−1 =

l∈Si,k−1
yl, ...for k = 2, ..., K. For example,
we could specify a vector model of the form
y =
⎧
⎪
⎪
⎪
⎪
⎪
⎪
⎨
⎪
⎪
⎪
⎪
⎪
⎪
⎩
{yi1}, i = 1, ..., m1
{yi2}, i = 1, ..., m2
{yi3}, i = 1, ..., m3
.
.
{yiK}, i = 1, ..., mK
⎫
⎪
⎪
⎪
⎪
⎪
⎪
⎬
⎪
⎪
⎪
⎪
⎪
⎪
⎭
∼
⎧
⎪
⎪
⎪
⎪
⎨
⎪
⎪
⎪
⎪
⎩
f1(μ1, l1)
f2(μ2, l2)
.
.
fK(μK, lK)
.

Multiple Scale Analysis
187
Often the distribution at each level is the same and so yk∼f(μk, lk). An
example of this approach is given in Section 8.1.3. Often the nesting of the
data leads not only to a single distribution but also to a single likelihood. For
example with nested Poisson counts then
L(μk|yk) =

1
f(y1; μ1)....

K
f(yK; μK).
Linkage between the scales can be achieved by dependence between μ1....μK.
Of course for functions of counts with aggregation then the rates should sum
across units within each cell and so μK =

l∈Si,k−1
μl. Louie and Kolaczyk
(2006) give an example of multiple scale analysis for disease data.
8.1.2
Scaling Down
By scaling down, I mean trying to make inferences at a lower aggregation
level than that used in the analysis. The classic situation where ecological
bias arises, is an example of this scaling down: trying to make inference at the
individual level from aggregate level analysis. Disaggregation is the reverse
operation from aggregation and the parallel with the mathematical operation
of integration carries over, so disaggregation is equivalent to diﬀerentiation.
Hence the opposite of smoothing would be to add noise to an existing ﬁeld.
Plummer and Clayton (1996) essentially assume the knowledge of a distribu-
tion of noise at the lower level in an ecological application. In general, knowl-
edge of the variation between the lower aggregation level units is important
if attempting to make inference at a lower aggregation level.
8.1.3
Multiscale Analysis
By multiscale analysis, I mean where data is available at multiple resolution
levels. For example, the focus of the analysis might be to include all data at
levels of aggregation in an analysis of all the levels. This could be a joint anal-
ysis or could be separately carried out in the null case. Louie and Kolaczyk
(2006) give an example of multiple scale analysis for disease data. More con-
cretely, assume that we observe public health district data (in the US) and
county level data. Figure 8.1 displays the public health districts (18) and
counties (159) of the state of Georgia in the USA.
The county set is a unique subdivision of the district set i.e., each county
falls uniquely within one PH district. Public health districts are administrative
units within which certain health services are provided. It is therefore possible
that some grouping eﬀect based on health district could be found for counties
that lie within a given district. For example, Dalton PH district includes the 6
counties of Whitﬁeld, Murray, Fannin, Gilmer, Pickens, and Cherokee. These
counties lie completely within Dalton and no other district. Hence in this case

188
Bayesian Disease Mapping
FIGURE 8.1
State of Georgia, United States: public health district boundary map (thick
line) and county boundary map (thin line).
there is multiscale information which is completely aligned in the sense that
the lower level county units fall completely and uniquely within the higher
aggregation level units (districts).
In this particular case we could imagine the data deﬁned with K = 2, with
yi1 i = 1, ...., 159 where l1 is the county level and yj2 j = 1, ..., 18 and l2 is
the district level. We could further assume a model of the form
yi1 ∼f1(μi1; l1)
yj2 ∼f2(μj2; l2).
Hence, under a null (separate) model we might have μi1 = exp{α10 + ui1},
and μj2 = exp{α20 + uj2} where α10 and α20 intercepts and ui1and uj2 are
eﬀects at level 1 and 2. These can be random eﬀects or functions of measured
predictors. Clearly to ensure linkage between levels and so to model the joint
behavior μi1 and μj2 may be linked. One natural way to do this is to consider
the contextual eﬀect of district on county and so we could have:
μi1 = exp{α10 + ui1 + uj2
i∈j
}
μj2 = exp{α20 + uj2}.
In eﬀect, because there is dependence between the mean levels then joint
estimation of the latent factors (ui1, uj2) must be considered. Additionally, it
might be considered that the district level should have a contribution from
eﬀects at the county level and so a further possibility could be to consider
μj2 = exp{α20 +uj2 +

i∈j
μi1}. In the latter formulation it would be useful to

Multiple Scale Analysis
189
(141) < 2.5
N
(15) 2.5-5.0
(2) 5.0-7.5
(2) > = 7.5
(5) < 0.75
N
(7) 0.75 - 1.0
(3) 1.0 - 1.25
(2) 1.25 - 1.5
(0) 1.5 - 1.75
(1) > = 1.75
(3) < –0.05
N
(19) –0.05 - –0.025
(60) –0.025 - 6.93889E-18
(52) 6.93889E-18 - 0.025
(24) 0.025 - 0.05
(1) > = 0.05
(1) < –10.0
N
(1) –10.0 - –5.0
(5) –5.0 - 0.0
(9) 0.0 - 5.0
(2) > = 5.0
(1) < –5.0
N
(8) –5.0 - 0.0
(7) 0.0 - 5.0
(1) 5.0 - 10.0
(1) > = 10.0
(18) < –75.0
N
(36) –75.0 - –50.0
(0) –50.0 - –25.0
(0) –25.0 - 0.0
(104) > = 0.0
FIGURE 8.2
Multiscale model for the Georgia oral cancer data: posterior average eﬀects:
top row (left to right) county level θ, ui, vi,; bottom row (left to right) PH
level θ, ui, vi.
keep the separate eﬀect of level (uj2). Further extensions or variants of these
linkages are possible.
8.1.3.1
Georgia oral cancer 2004 example
As an example of analysis at multiple scales, I examine the Georgia PH district
and county example. In this case, mortality counts from oral cancer were con-
sidered for the year 2004 in the US state of Georgia. The state-wide expected
rate for oral cancer was obtained and applied to the local county populations.
The count of oral cancer mortality within public health (PH) districts is also
available for the same period (as a sum of constituent county counts). Ex-
pected rates can also be summed from counties or directly calculated from
the district population. We have applied the diﬀerent two level models to the
Georgia PH-county data. A seprate model was ﬁtted to each level as well as
a joint model with contextual eﬀect. Table 8.1 displays the results in terms of
DIC and pD for the diﬀerent ﬁtted models. Figure 8.2 displays the posterior
average maps for the joint model with Poisson data model the relative risks
are deﬁned as:
θi1 = exp{α10 + vi1 + ui1 + vj2
i∈j
+ uj2
i∈j
}
θj2 = exp{α20 + vj2 + uj2}
where each v∗1 + u∗1 is a convolution of a UH and CH random eﬀect.

190
Bayesian Disease Mapping
TABLE 8.1
Goodness of ﬁt results for separate and joint models for
Georgia oral cancer PH-county level data
Model
pD
DIC
County
97.68
507.01
PH district
18.72
124.96
Joint model: County
100.5
513.38
Joint model: PH district
18.07
123.77
(127) < 2.0
(26)   2.0-4.0
(4)     4.0-6.0
(2)     >= 6.0
(6)   <–0.2
(82) –2.0-0.0
(55) 0.0-0.2
(16) >= 0.2
(31)   <–75.0
(23)   –75.0-50.0
(0)     –50.0-25.0
(10)   –25.0-00
(105) >= 0.0
N
N
FIGURE 8.3
Georgia oral cancer model when a simple convolution model at county level
is ﬁtted: posterior average maps of (left to right) θ, ui, vi.
Figures 8.3 and 8.4 display the posterior avergaed maps for the θ, and ui, vi
eﬀects obtained when separate models are ﬁtted to county level and PH level.
Overall it appears that the joint model mainly beneﬁts the PH analysis as the
DIC is marginally lower under the joint model.
8.2
Misaligned Data Problem(MIDP)
While multiscale analysis can concern spatial units that are completely
matched when aggregated there is also a situation where units are not matched
and are termed misaligned. This often occurs when sampling at diﬀerent spa-
tial scales are not linked. A classic example of this scenario is where residential
address of disease cases are to be related to measurements of environmental
pollution obtained from a network of sites. The locations of the cases do not
match the pollution measurement sites. Another example of misalignment is
where data on disease is available in diﬀerent administrative units that are
not matched spatially. For example, census tracts, are not matched to, e.g.,
postal codes in the United Kingdom or zip codes in the United States. Thus in
both cases some mechanism must be used to provide data on the same spatial

Multiple Scale Analysis
191
(4) < 0.75
(6) < –1.0
(5) –1.0-0.0
(4) 0.0-1.0
(3) >=1.0
(8) 0.75-1.0
(3) 1.0-1.25
(2) 1.25-1.5
(1) >= 1.5
(2) < –1.0
(4) –1.0-–0.5
(1) –0.5-0.0
(4) 0.0-0.5
(6) 0.5-1.0
(1) >= 1.0
FIGURE 8.4
Georgia oral cancer PH district model only: posterior average maps of (left to
right) θ, ui, vi.
scale within or at the same spatial region or location. In the ﬁrst example, it
is usually the case that interpolation of pollution measurements to residential
locations would be required. In the second case, it may be that disease out-
come data (counts) need to be available in the same spatial units. The ﬁrst
situation is one where a predictor is misaligned, whereas in the second case,
diﬀerent spatial data observation levels are misaligned.
8.2.1
Predictor Misalignment
Predictor misalignment can take various forms. Here I will discuss two basic
situations: misalignment which requires interpolation to a point location and
misalignment where interpolation must be made over an area. In both cases,
interpolation or measurement error is involved. Deﬁne si i = 1, ..., N
to be
the locations of cases and controls, where N = m + n with m cases and n
controls and yi is the corresponding binary case/control label. Also deﬁne the
measured level of a predictor at a set of sites as z(sl), l = 1, ..., L and zl ≡
z(sl) for short. Usually we would assume that the predictor data is noisy and
so even at sl we would want a smoothed value. In addition, however, we would
usually want to have z(si), at the residential locations and this also involves

192
Bayesian Disease Mapping
interpolation. One approach to this situation is to assume a spatial Gaussian
process for the measured predictor and to make a conditional prediction of
the level of the predictor.
Deﬁne a Gaussian process model for the sets of sites, and deﬁne also the
parameter vector θ = (τ, ψ)T , and let zT
s = (z(s1), ..., z(sL)):
zs|α, θ ∼N(μs, Γ)
where μsl = μ(sl, α), a predictor at the l th site, and Γ is a spatial co-
variance matrix. Often μs will consist of trend surface components and
Γll′ = τρ(sl −sl′; ψ) where τ is a variance and ρ(.) is a correlation function
measuring the relation between values of z at separation distance sl −sl′.
Choices of ρ(sl −sl′; ψ) are many, (see e.g., Cressie, 1993, Diggle and
Ribeiro Jr., 2007) and a simple choice could be an exponential form such
as ρ(sl −sl′; ψ) = exp{−ψ||sl −sl′||}. More generally the powered exponential
family deﬁned by ρ(sl −sl′; ψ) = exp{−(ψ||sl −sl′||)k}can be assumed with
0 < k < 2, the extra parameter allowing for a slower distance decline at short
separation for k > 1, when ψ << 1.
For predicting a new set of locations (z(si), i = 1, ..., N) the predictive
distribution is
f(z(si)|z(sl)) =

f(z(si)|z(sl), α, θ)f(α, θ|z(sl))dαdθ.
Under a Gaussian process assumption, and denoting the set of original sites
as s and the interpolant sites as s′ then this distribution is just
N(μs′ + ΓT
s,s′Γ−1
s (zs −μs), Γ∗)
(8.1)
Γ∗= τ[Γs′ −ΓT
s,s′Γ−1
s Γs,s′].
This distribution can be sampled from directly assuming that the inverse Γ−1
s
can be calculated. It is therefore possible to assume a joint model for the
binary outcome yi and the interpolated (latent) predictor z(si):
yi ∼Bern(pi) i = 1, ..., N
(8.2)
log itpi = β0 + β1z(si)
 zs
zs′

∼N
 μs
μs′

, τ
 Γs Γs,s′
ΓT
s,s′ Γs′

).
Essentially, z(si) is a latent variable and must be estimated via the joint
model. One issue that remains is whether z(si) should be estimated in the
same model as pi or should be estimated from zs separately. Note that if a
joint model is assumed then both β1 and z(si) are unknown and so there is
likely to be some diﬀerence in the estimated z(si) compared to an estimate
simply obtained by Bayesian Kriging. There is some support for the idea that
Bayesian Kriging via (8.1) should be used separately, as there seems a priori

Multiple Scale Analysis
193
little reason to assume that the disease outcome should inﬂuence the estimate
of the latent predictor.
Predictor misalignment can also occur where a value of the predictor is
needed over an area rather than at a point location. For example, count out-
come data are commonly available for small areas and we might want to
interpolate measured covariates over small areas. This process is equivalent
to block Kriging in Geostatistics and can be speciﬁed as follows. Deﬁne the
counts in m small areas as yi, i = 1, ..., m. We assume the usual Poisson rel-
ative risk model with yi ∼Pois(eiθi)
∀i. Also assume a log linear model
relating the relative risk to a block level covariate: log(θi) = β0 + β1zi. Here
zi denotes the value of z averaged over the i th small area. Assume a set of
measurement site values as before: zT
s = (z(sl), ..., z(sL)) and also a set of
small area average values: zT
A = (z1, ..., zm) for areas A1, ...Am. We need the
predictive distribution, which is now
f(zA|zs) =

f(zA|zs; α, θ)f(α, θ|zs)dαdθ.
As in the point location case, there is a conditional distribution for these
averages of the form:
N(μA + ΓT
s,AΓ−1
s (zs −μs), Γ∗
A)
(8.3)
Γ∗
A = τ[ΓA −ΓT
s,AΓ−1
s Γs,A]
where Γ−1
s
is the inverse of the site covariance and
(Γs,A)li = |Ai|−1

Ai
ρ(sl −u; ψ)du
(8.4)
(ΓA)ii′ = |Ai|−1|Ai′|−1

Ai

Ai′
ρ(v −u; ψ)dudv
(μA)i = |Ai|−1

Ai
μ(s)ds.
The integrals in (8.4) must be evaluated. Banerjee et al. (2004) suggest a
Monte Carlo integration where the random locations are generated and the
integrals replaced by sums. Finally the joint model could be speciﬁed as
y ∼Pois(μ(zA))
(8.5)

zs
zA

∼N

μs
μA

, τ
 Γs Γs,A
ΓT
s,A ΓA

.
(8.6)
Here, it could be assumed that μ(zA) is simply a linear function of the latent
interpolated predictor, assuming no confounders are present. Hence it is often
assumed that μ(zA)i = ei exp(β0 + β1zi).

194
Bayesian Disease Mapping
Note that, in general, integrating the ﬁrst order intensity we get μ(zA)i =

Ai
λ0(u)λ1(u)du where, if we assume λ0(u) to be constant over Ai, so
λ0(u) ≡ei. Denote the exposure of the j th individual within the i th area
as zj(i), and an individual has an exposure λ1(u)i = exp(β0 + β1zj(i)). Hence,
μ(zA)i
=
ei

Ai
exp(β0 + β1zj(i))ds
=
ei exp(β0)

Ai
exp(β1zj(i))ds
≈
eieβ0 
exp(β1zj(i)), where the sum is over the whole at-risk population
within the small area.
Now usually individual level exposure is unavailable and indeed without
knowledge of locations, this is not possible to directly estimate. However it is
possible to use the region average (zi) with some further assumptions to allow
a closer approximation. For example we could assume that zj(i) ∼N(zi, f(zi))
where the variance is assumed to be a function of the mean level. Wakeﬁeld
and Shaddick (2006) suggest a function such as f(zi) = a + bzi. Hence it may
be possible to consider a model whereby (8.3) could be used to predict block
eﬀects but within the Poisson model the individual eﬀects could be used via
μ(zA)i = eieβ0 
exp(β1zj(i))
zj(i) ∼N(zi, a + bzi).
Other alternatives could be considered where point interpolation could be
made to random points within each small area, instead of block Kriging.
It can be important to consider how individuals within areas are related to
exposures, at least from the view of making inference at the individual level.
If individual inference is to be made from aggregate data then ecological bias
should be considered. Of course, it is still remains valid to make inference at
aggregate levels from aggregate level models.
Some simple alternatives are often suggested to the above when using inter-
polated predictors. One simple approach is to use plug-in estimates zi directly
within the ﬁrst level aggregated data model. For example,
yi ∼Pois(eiθi) ∀i,
log θi = β0 + β1zi,
can be assumed where zi is estimated separately via a Bayesian Kriging model.
However in such a model, the error in the interpolated value is ignored. As
discussed in Chapter 7, it is possible to make allowance for some biases by
inclusion of random eﬀects in models for example: log θi = β0 + β1zi + ϵi
where ϵi is assumed to be unstructured with distribution ϵi ∼N(0, τϵ). In
eﬀect we are assuming that error in the interpolation is simply random noise.
While this will indeed make some allowance for the interpolation error, it is
unlikely to properly correct for any correlated error and will also be associated
with the error in the relation between yi and zi. Alternatives involving forms

Multiple Scale Analysis
195
of Berkson measurement error, such as log θi = β0 + β1[zi + ϵi], could be
envisaged where either unstructured error with distribution ϵi ∼N(0, τϵ), or
spatially-structured error could be assumed. Given that zi has already been
Kriged it is less justiﬁed to assume spatially-correlated error here.
Another alternative would be to employ a simpliﬁed model for the Gaussian
ﬁeld that is to be interpolated. For example, it would be possible to assume
a proper CAR model for the variation in the zT
s so that at a location j, say,
where zj is observed, then assume
zj ∼N(z∗
j , τ)
z∗
j |z∗
−j ∼N(zj∗, τ ∗/nδj)
zj∗= tj + φ

l∈δj
(z∗
l −tl)/nδj,
where tj is a trend component. The neighborhood (δj) deﬁned for this exam-
ple could be obtained as Dirichlet tesselation neighbors of the set of sample
sites and outcome locations (if point-to-point interpolation is needed). The
interpolated values are treated simply as missing. However this ignores some
parts of the variation in the ﬁeld due to the Markov neighborhood dependence
that is assumed by the model.
Another simplifying assumption, in the case of point-to-block interpolation,
is to consider the centroids of small areas as sampling points which augment
the measurement at the sampling sites. In this case, the small area centroids
could be considered to have missing data. More speciﬁcally, assume an aug-
mented set zs′ : (zA, zs) where the zA are missing:
yi ∼Pois(eiθi)
log = β0 + β1zi
zs′ ∼N(μs′, τΛ)
where (μs′)i =

i∈δi
zi/nδi and (Λ)ii = n−1
δi . This CAR-Voronoi model was pro-
posed by Greco et al. (2005) in an application to interpolation of groundwater
uranium to the centroids of zip codes in South Carolina.
8.2.1.1
A binary logistic spatial example
In a study of a birth-defect disease outcome the residential addresses of births
and births with defects were recorded within a US state. For an anonymized
study area of 2 x 2 kms the locations of this binary outcome were recorded
(see Figure 8.5). Soil chemical measurements were also made on a range of
chemicals. In this example, I examine just one of these: Arsenic (As). Arsenic
in soil is commonly found in agricultural areas where heavy pesticide use has
occurred over many years. It is important to consider whether exposure to
As (via a possible groundwater exposure pathway) during pregnancy could

196
Bayesian Disease Mapping
lead to adverse birth defect outcomes. Many residents of certain rural areas
in the US have a groundwater domestic supply. In this example we know
the residential location of outcomes (births with or without defects) during
a particular month of pregnancy, but have a mismatched set of soil chemical
sampling sites. Figure 8.5 displays the distribution of the sites (left panel) and
the distribution of the births with their binary marks (right panel). The ex-
ample displays a point-to-point misalignment problem. It is appropriate here
to interpolate the soil chemical values from the measurement sites to the res-
idential locations so as to provide a local exposure estimate. Of course, issues
relating to appropriateness of the residential location as exposure “location”
do arise, but here we assume that this location is the most relevant for the
given month of exposure. The ﬁrst model assumed is closely related to that
given in (8.2) except that the model is not jointly estimated. Instead, the
interpolation is carried out separately via
Bayesian Kriging and a plug-in
estimator is used (zKB). The model assumed for this estimator is a Gaussian
spatial process with an overall mean parameter (βz) and a power exponential
correlation function so that the covariance matrix is given by
σ2Σij = σ2 exp{−(dij/φ)κ}
(8.7)
with smoothing parameter κ = 1 which is equivalent to a Mat´ern covariance
with exponential form. The prior distribution for βz is assumed to zero-mean
Gaussian with variance 3.0, whereas the inverse variance prior distribution is
assumed for σ2. A discrete prior distribution on a ﬁxed range (0, 2∗max(dij))
is used for φ. The parameters within the Kriging model were estimated using
krige.bayes in the R package geoR. The posterior expected estimates under
this model were βz = 1.9903, σ2 = 5.00629, and φ = 0.0001. This suggests a
very small covariance distance eﬀect. The overall logistic model used was
yi ∼Bern(pi)
log = β0 + β1zKB
with β∗∼N(0, τ∗), τ−1/2
∗
∼U(0, 100). This is a simple Bayesian logistic
regression model with zero-mean Gaussian prior distributions for the regres-
sion parameters. This is referred to as Model 1 in Table 8.2. Models 2 and
3 are variants of this model which are intended to account for the measure-
ment error in using the Bayesian Kriged values in the model (rather than a
joint model). Model 2 assumes an additive unit level uncorrelated error (UH)
which has zero-mean Gaussian prior distribution. Model 3 assumes that in-
stead of a UH term it assumes that the classical measurement error model
is reversed and that the Kriged estimate is the true value observed with er-
ror. This is termed Berkson error. The ﬁnal models utilize the original data
and model the spatial covariation of that data directly. Model 4 assumes
that the constant mean estimated from the As data has an additive uncorre-
lated error term (vi ∼N(0, τv), τ −1/2
∗
∼U(0, 100)) and an additive spatially-
correlated error including the term W ∼MVN(0,σ2Σ) with covariance term

Multiple Scale Analysis
197
TABLE 8.2
Model ﬁt results for the point misalignment example
Model
Components
DIC
1
β0 + β1zKBi, β∗∼N(0, τ∗), τ −1/2
∗
∼U(0, 100)
178.33
2
β0 + β1zKBi + vi, vi ∼N(0, τv), τ −1/2
∗
∼U(0, 100)
116.22
3
Berkson error: β0 + β1(zKBi + vi), priors as in (2)
155.47
4
β0 + β1(As + Wi) + vi, W ∼MV N(0,σ2Σ)
177.50
5
as in (4) but β0 + β1(As + Wi) only
176.10
6
β0 + β1zi
140.90
Σij = exp{−(dij/φ)}, with prior distributions σ2 ∼Exp(0.1), φ ∼Exp(0.1)
which are reasonably overdispersed while favoring small values. Finally, model
6 consists of a joint model for the birth outcome and arsenic levels where the
true arsenic level is a latent variable (zi) interpolated via the point to point
Bayesian model in (8.2). Again a power exponential covariance was assumed
with κ = 1 as in (8.7).
The assumed prior distributions were σ2 ∼Exp(0.1),
φ ∼Exp(0.1) as in the previous model, and a random level βz was assumed
to have a zero-mean Gaussian prior distribution with variance 3.0. The result-
ing goodness-of-ﬁt DIC measures for these models were computed and they
are reported on Table 8.2. While these are only a subset of overall potential
models and prior distribution choices which could be made, they represent a
range of approaches often advocated for this type of modeling exercise. It is
notable that the general random eﬀect model (Model 2) provides the lowest
DIC among the plug-in ME models and by this measure performs better than
the potentially more plausible Berkson model. Among models making direct
use of the data, the joint model (Model 6) yields the lowest DIC (140.90)
and, with the exception of Model 2, this yields the lowest DIC. However for
this particular example the overall best model judging by DIC alone is the
Model 2. This might suggest that there is overall more noise in the relation
between the outcome and the covariate than within the covariate itself. There
are of course various criticisms that can be leveled at such models. First,
approximate models, such as those using plug-in estimators do not have a
priori justiﬁcation based on Gaussian model or process theory. However from
a pragmatic viewpoint, if a parsimonious description is achieved by such a
model in a regression context then it is supported. The model is less justiﬁed
when treating out-of-data prediction on a priori grounds. However joint mod-
eling of the latent spatial eﬀect could also be challenged in the sense that the
true value of the spatial covariate is forced to depend on the outcome model
parameters. This may also seem to be a criticism of that model. Of course
prior distributional assumptions can be challenged for all models ﬁtted and
this also can impact model selection.
For the lowest DIC model the posterior mean estimates of the parame-
ters β0, β1, τ0, τ1, τ v are available after a burn-in of 60000 and a sample of

198
Bayesian Disease Mapping
FIGURE 8.5
Spatial distribution of sampling sites (+) and multivariate B-spline smooth of
Arsenic (image and contourplot from R package MBA) for the synthetic data
example (left panel); spatial distribution of births with binary mark (1: birth
defect, 0: otherwise) in same window.
10000 taken. This yielded estimates of mean (sd) of
β0 = −1.715(3.832),
β1
=
−0.6846(1.951), τ0
=
106.1(4233.0), τ 1
=
76.16(3419.0), τ v
=
0.05634(0.1135). The overall conclusion of this analysis is that the Arsenic
does not have a signiﬁcant (linear) relationship with birth defect under a logit
model. Further model variants could be conceived where changes to both the
linear model and also to the interpolation model could be considered. Often
environmental predictors have non-linear relations with health outcomes and
so polynomial or spline models could provide better ﬁts. In our experience,
with other soil chemicals it is indeed the case that a nonlinear model yields a
signiﬁcant ﬁt when a linear model does not. Further alternative interpolants
such as spline models could be considered (see e.g., French and Wand, 2004).
Finally, Zhu et al. (2003) describe the analysis of misaligned data when
spatiotemporal analysis is to be considered. They also consider (log) linear
relations between outcome and predictor within a small area setting (zip code
units).
8.2.2
Outcome Misalignment
Outcome misalignment occurs when spatial outcome units are not matched.
One basic and commonly occurring form is where counts are observed within
small areas but expected rates are only available in other misaligned areas. For
example, in the US, zip codes don’t align with counties but are a smaller-sized

Multiple Scale Analysis
199
spatial (postal) unit; in the UK postcodes don’t align with census enumeration
districts. When comparing diseases within study areas it can be the case that
diﬀerent aggregation units are found and matching must take place. When
multiple diseases are concerned then multivariate misalignment could occur.
This latter is not considered in this volume, but could be of considerable
practical importance when multiple disease analysis is considered. Multiple
disease analysis is discussed in Chapter 9.
Outcome misalignment leads to the consideration of the overlay of diﬀerent
spatial aggregations to yield mismatched outcomes. In cases where data are
needed to be matched on their spatial units then some form of allocation
model must be considered. Banerjee et al. (2004), Ch 6, discuss in detail the
issues related to interpolation of Gaussian processes to point locations and
to areas. Note that in general, outcome misalignment can be treated as a
problem in block to block interpolation in that areas of diﬀerent sizes are to
be matched, at least in terms of parameter estimation.
A common assignment rule is simply to use proportional allocation. Deﬁne
a simple misalignment with a single large region (A) and a set of misaligned
smaller regions that overlap A : (B : {b1, ..., bp}). Parts of the smaller regions
overlap areas of A. It is possible to consider the problem ﬁrst of the aggregation
of count data from smaller to larger regions. Deﬁne M larger scale regions with
counts {yAi}, i = 1, ..., M and P smaller region counts {ybl}, l = 1, ..., P; also
the corresponding expected rates: {eAi}, {ebl}, and area proportions {pbli},
where pbli is the proportion of region bl within the i th region.
First for aggregation to larger region counts, it is simple to assume propor-
tional allocation and to derive the larger region counts from smaller regions:
yi =

l
pbliybl.
(8.8)
One consequence of proportionate allocation is that the resulting larger re-
gion yi could be non-integer. Special rules could be devised to make sure
the allocation resulted in integer allocation, but these can lead to edge ef-
fect problems. Note that many packages allow noninteger Poisson data (e.g.,
WinBUGS). Given two levels of count data a consideration might be given to
employing a joint model for the diﬀerent levels where :
yi ∼Pois(μi); μi =

l
pblieblθbl.
(8.9)
ybl ∼Pois(μbl); μbl = ebliθbl.
Occasionally aggregation is required only for expected rates. The situation
envisaged is where expected rates are available in smaller regions only and
must be aggregated to match the counts in larger regions. For example, if a

200
Bayesian Disease Mapping
Poison model for the larger region counts were assumed then
yi ∼Pois(ei.θi)
(8.10)
ei =

l
pbliebl.
In consideration of disaggregation then smaller regions can be allocated counts
by proportionate allocation downwards. For example, assuming the same com-
plete misalignment as above, then the derived count in a smaller region ybl
could be derived via ybl = 
i pilyi where the proportion of the larger region
overlapping the smaller region is denoted by pil.
8.2.3
Misalignment and Edge Eﬀects
In Section 5.8, various issues were discussed relating to the importance of
edge eﬀects in disease mapping studies. These can be even more important in
consideration of misaligned data at diﬀerent aggregation levels. For example
assume a simple proportionate aggregation as in (8.8) above. Close to the
study area boundary, the neighborhoods of regions are censored. Assume that
smaller regions misalign to a study area where the hull of the larger regions
forms the outer boundary of the study area. This implies that the smaller
regions can overlap the study boundary. To estimate the proportionate allo-
cation the area of these smaller regions must be known as well as the counts
within the regions. Hence, knowledge of an area larger than the study area
is important. Further when modeling small area counts where aggregation
to larger regions has been assumed, then the eﬀects of local neighborhoods
on the spatially structured risk could be considerable. In Model (8.9) above,
any spatially-structured risk involving adjacencies will depend on knowledge
of both the neighbors of the larger regions and the neighbors of the smaller
regions. In Model 8.10 the relative risk in larger regions is not a direct ag-
gregation of the lower level risk as in (8.9). In (8.9) the smaller regions could
have neighborhood eﬀects and these aggregate to the larger level. In (8.10)
only the expected rate is aggregated. The eﬀect of neighborhood censoring
within CAR random eﬀect models has been highlighted by Vidal-Rodiero and
Lawson (2005).
If the study area does not correspond to the hull of the larger regions then
some regions will overlap the boundary. This could also cause edge eﬀect
problems due to the need to assign data from the larger region to the area
within the study area. Clearly misalignment can have signiﬁcant implications
for inference about areas at or close to the edge of study boundaries.

9
Multivariate Disease Analysis
Often it is appropriate to consider the analysis of the geo-referenced distribu-
tion of more than one disease. For example, the focus may be on a group of
diseases with similar etiology in an epidemiological study. Another example,
in the context of public health, could be the examination of the general health
status of a region (possibly following a cluster alarm signal). In the latter case
a range of disease types might be considered to ﬁnd out if any show signs of
unusual risk variation. In some cases, the focus is on the spatial distribution
of the vector of diseases (for example relative risk estimation for the vector).
In other cases the diseases are to be contrasted or correlation between their
spatial distributions are to be considered. In this chapter the focus will be
on relative risk estimation and modeling of risk both in terms of correlation
between diseases and in terms of comparison. The simplest situation where
such analysis can be considered is where two diseases are to be examined.
9.1
Notation for Multivariate Analysis
Both case event and count data will be considered in this chapter.
9.1.1
Case Event Data
Assume there are L diseases. Assume a ﬁxed study area T common to all
diseases. Misaligned study areas are not considered here. Assume that the
residential addresses of each disease type are known and given by {sli}, l =
1, ...., L and i = 1, ..., ml. It is assumed that there are ml cases of the l th
type within the study region. In addition, there may be observed a control
realization for each of the diseases. The number of these are denoted by mcl
and the total number of cases and controls for a l th disease is Nl = ml +mcl.
Hence the controls will be denoted {sli}, l = 1, ...., L and i = ml + 1, ..., Nl.
Often a common control for all diseases is used but this can be discussed later.
201

202
Bayesian Disease Mapping
9.1.2
Count Data
Here, the simplest situation is considered where ﬁxed spatial units (small
areas) have a range of L disease counts observed in a ﬁxed time period. Deﬁne
these counts as {yli}, l = 1, ..., L, i = 1, ..., m. hence, within each spatial unit
there are L counts of disease. The corresponding expected rates and relative
risks are deﬁned as {yli}, {θli}.
9.2
Two Diseases
Often the simplest situation arises where two diseases are to be modeled where
L = 2.
9.2.1
Case Event Data
For case events the observed data is now {sli}, l = 1, 2 and i = 1, ..., Nl.
Analysis will depend on the object of the study. If the object is to locally
(in space) compare the probability of getting disease 1 or disease 2, then a
competing risk
formulation might be useful. This might condition on the
observed total of cases, NT = m1 + m2. On the other hand it might be
important to jointly model each disease (perhaps with linking parameters)
without conditioning.
First deﬁne the ﬁrst order intensity for the l th disease as λl(s|ψl) =
λl0(s|ψl0).λl1(s|ψl1), l = 1, 2.
If the competing risk scenario is important
then it is possible to simply consider the joint realization of the cases condi-
tional on NT . Assume that the diseases can be considered to be independent
heterogeneous Poisson processes (PPs) governed by λ1(s|ψ1), and λ2(s|ψ2).
This independence assumption would be at least conditional given parame-
ters (ψl0, ψl1, l = 1, 2). Hence we can assume that the joint realization is a
PP and so conditioning on the joint realization it is possible to consider the
probability that given a case at s it is of type 1 or 2. This is given by
Pr(l(s) = 1|case(s)) =
λ1(s|ψ1)
λ1(s|ψ1) + λ2(s|ψ2).
(9.1)
where l(s) is the type label of the location and case(s) means case at s. Note
that the locations are now conditioned on and it is now possible to make
inference about the labeling of the points. Substituting the full intensities
into (9.1), gives
λ10(s|ψ10).λ11(s|ψ11)
λ10(s|ψ10).λ11(s|ψ11) + λ20(s|ψ10).λ21(s|ψ11).

Multivariate Disease Analysis
203
Note that in this case it is not possible to remove the background intensities
(λl0) as these are diﬀerent for each disease and the conditioning is on the case
distribution. If it can be assumed that λ10(s|ψ10) = λ20(s|ψ10) then these
cancel in (9.1) and so the type probability is just λ11(s|ψ11)/(λ11(s|ψ11) +
λ21(s|ψ11)). Hence there is some advantage in seeking a common control re-
alization. Note that other conditional probabilities can be derived (such as
Pr(case(s)) given the joint case-control realization). Suitable likelihoods can
be constructed from these probabilities and inference can proceed as usual.
Lawson and Williams (2000) provide an early likelihood-based analysis of a
competing risk scenario. As far as this author is aware, there are no published
examples of the application of Bayesian approaches to these spatial competing
risk scenarios.
If an unconditional analysis is to be considered, albeit conditional in the
case-control realizations, then a joint likelihood could be derived for the joint
realization. Deﬁne the binary case-control label as
yli =

 1 if the event is a case
0
otherwise
and the joint likelihood as
L(s|ψ0, ψ1) =
2

l=1
Nl

i=1
p
yli
li (1 −pli)(1−yli)
pli =
λl(sli|ψl)
λl0(sli|ψl0) + λl(sli|ψl)
=
λl1(sli|ψl1)
1 + λl1(sli|ψl1).
9.2.1.1
Speciﬁcation of λl1
The speciﬁcation of λl1 l = 1, 2 can now be designed to model the relation
between the two diseases. For example, simple functional dependence between
the two could be modeled by a relation such as λ11(s|ψ11) = ρλ21(s|ψ21). Of-
ten a log-linear speciﬁcation is assumed for the intensity so that λl1(sli|ψl1) =
exp{f(sli, ψl1)}. For descriptive models, often the linear component will con-
sist of covariate terms and/or random eﬀect terms. For example
f(s1i, ψ11) = β0 + x′
iβ1+v1i
f(s2i, ψ21) = β0 + x′
iβ2+v2i,
could be assumed, where x′
iβ∗is a covariate predictor with common covari-
ates and separate parameters, and v1i, v2i are random eﬀects for each disease.
Often these random eﬀects would be uncorrelated, but more complex struc-
turing could be assumed. A common random eﬀect could be added to this

204
Bayesian Disease Mapping
model so that
f(s1i, ψ11) = β0 + x′
iβ1+v1i + δwi
(9.2)
f(s2i, ψ21) = β0 + x′
iβ2+v2i + wi/δ
and then a common random component is included. This could be spatially-
structured (as a zero-mean Gaussian process) or could be uncorrelated. A
linked component model where a common component has been included for
two diseases (for count data) has been
proposed by Knorr-Held and Best
(2001) and further, Held et al. (2005) suggested a more general model. The
components suggested were included to mimic an ecological regression on an
unobserved component. While this was proposed for count data there is no
reason why this idea could not be applied with case event data. Of course other
forms of common parameterization can be considered and what is described
here in (9.2) is a very basic proposal.
An alternative possibility is to consider that a bivariate eﬀect is included in
the models so that a deﬁned correlation parameter is included. For example,
the joint model
f(s1i, ψ11) = β10 + x′
iβ1+W1i
f(s2i, ψ21) = β20 + x′
iβ2+W2i
W1i
W2i

∼N (0, Γ)
with Γ =

κ1
√κ1√κ2ρW
√κ1√κ2ρW
κ2

with no spatial correlation could be considered, where ρW is a correlation
parameter and κ1, and κ2 are variances. Further extension to cross-correlated
spatially-structured prior distributions could also be considered.
9.2.2
Count Data
For counts the observed data is now {yli}, l = 1, 2 and i = 1, ..., m. Analysis
will depend on the object of the study. If the object is to locally (in space)
compare the risk of getting disease 1 or disease 2, then a competing risk for-
mulation might be useful. This might condition on the observed total of cases
within spatial units Ni = y1i + y2i. On the other hand it might be impor-
tant to jointly model each disease (perhaps with linking parameters) without
conditioning.
In the simple case where we condition on a small area total then condi-
tioning on the sum of two (conditionally independent) Poisson variates leads
straightforwardly to a binomial model for either type count. For example we
could model the disease 1 count as
y1i ∼bin(p1i, Ni);

Multivariate Disease Analysis
205
this has sometimes been called the proportional mortality model (see e.g.,
Dabney and Wakeﬁeld, 2005).
In this formulation the probability can be
formulated to deﬁne the relation between the two diseases. For example the
logit of the probability can be modeled with diﬀerences in risk terms:
log it(p1i) = log(e1i
e2i
) + β0 + W ∗
i
W ∗
i = (W1i −W2i)
where W ∗
i = (W1i −W2i) is the diﬀerence between the random eﬀects for
the two diseases. These could have UH and CH components also. In this
formulation the relative expectation of the two diseases is also included and
the random eﬀect W ∗
i (which is a diﬀerence) can be directly modeled with
prior distributions for its components.
As mentioned above it is possible to consider
1. A joint model for the two diseases with common components:
y1i ∼Pois(μ1i)
(9.3)
y2i ∼Pois(μ2i)
μ1i = e1i. exp{β10 + x′
iβ1+W1i}
μ2i = e2i. exp{β20 + x′
iβ2+W1i}
where x′
iβ1, x′
iβ2 is the covariate predictor for disease 1 and 2 respectively,
and W1i is a common component. As before this component is a composite
random eﬀect term and could consist of UH and CH components. Instead, as
in the case event scenario, separate random eﬀects could be assumed which
have a prior correlation so that
μ1i = e1i. exp{β10 + x′
iβ1+W1i}
μ2i = e2i. exp{β20 + x′
iβ2+W2i}
W1i
W2i

∼N (0, Γ)
with Γ =

κ1
√κ1√κ2ρW
√κ1√κ2ρW
κ2

where κ1, and κ2 are the prior variances of the two eﬀects and as before the
ρW is the prior correlation.
2. A shared component model which mimics an ecological regression on
the unobserved shared component. In the example of Knorr-Held and
Best (2001) this takes the form of

206
Bayesian Disease Mapping
μ1i = e1i. exp{β10+u2i + δu1i}
(9.4)
μ2i = e2i. exp{β20+u1i/δ},
where u2i is a separate random component for the ﬁrst disease and u1i is the
shared component and δ is a scaling component that is necessary because of
identiﬁability. Usually δ has the prior distribution log(δ) ∼N(0, κδ) with a
small ﬁxed variance of κδ = 0.17 in Knorr-Held and Best (2001). In Knorr-
Held and Best (2001), both the shared term u1i and u2i were assumed to have
a CAR prior distribution with
p(u|κ) ∝κ(m−1)/2 exp
⎧
⎨
⎩−κ
2

i∼j
(ui −uj)2
⎫
⎬
⎭
Dabney and Wakeﬁeld (2005) give examples of comparison of the propor-
tional mortality/incidence model with shared component models in a partic-
ular application.
9.2.3
Georgia County Level Example (3 Diseases)
As an example of the application of the above models, we have examined
a group of diseases which could a priori be considered to display the same
or similar distributional features. These are ambulatory care-sensitive condi-
tions and counts of these conditions were recorded. These are chronic diseases
which are to some measure exacerbated by adverse environmental air pol-
lution: asthma, chronic obstructive pulmonary disease (COPD), and angina.
While both asthma and COPD are respiratory in nature, whereas angina is
a coronary outcome, all the diseases could be aﬀected by poor environmen-
tal air quality. Therefore, in some part, there may be some evidence of this
feature in the spatial distribution. A common component could emerge from
a joint analysis or at least some evidence of correlation between the spatial
distributions could be apparent. In the following, a range of models have been
ﬁtted to parts of these data. A full multivariate analysis is examined in a later
section (9.3). The models demonstrated here are the individual convolution
models for each disease (Model 1), the joint model with common CAR com-
ponent with separate UH components (Model 2) and the shared component
model (Model 3). The diseases compared in Models 2) and 3) are asthma
and COPD. Figure 9.1 displays the results for separate analysis of the three
diseases (Model 1). Table 9.1 displays the results for these models in terms
of DIC. It is clear that a common component as in Model 2 leads to a im-
proved goodness-of-ﬁt as judged by lower DIC. The improvement seems to be
mostly to the asthma (DIC from 1144.7 to 1137.3). The form of the common
component an be seen in Figure 9.3 and it appears that there is a consid-
erable positive concentration of common risk in the southeastern portion of

Multivariate Disease Analysis
207
TABLE 9.1
Model comparisons for the three disease examples: joint, common, and
shared
model
DIC
pD
1 (COPD, angina, asthma)
1239.8, 840.9,1144.7
145.9, 121.1, 127.8
1 overall
3225.46
394.8
2 common (COPD, asthma)
1238.3, 1137.3
144.6, 121.5
3 shared (COPD, asthma)
1244.9, 1131.97
141.7, 119.0
the state. The separate posterior mean uncorrelated components appear to
be quite diﬀerent in distribution (Figure 9.2). Of course it should be borne
in mind that there is some lack of identiﬁability in these components and so
more reliance should be placed on the shared component model (Model 3 as in
(9.4)). The results of the shared component model (Model 3 in Table 9.1) with
prior distribution log(δ) ∼N(0, κδ) with κδ = 0.17, seems to suggest that the
shared component does reduce the DIC close to that of the common com-
ponent model (overall DIC: 2375.6 and 2376.9 for common and shared com-
ponent, respectively). However the shared component model yields a lower
pD, as there is only one separate component, instead of two components.
The posterior expected estimate (sd) of the δ parameter is 0.6855 (0.03712).
The model ﬁtted was
μASi = eASi. exp{β10+u2i + δu1i}
μCOP Di = eCOP Di. exp{β20+u1i/δ}
with both u2i and u1i having CAR prior distributions with τ −1/2
u∗
∼U(0, 100).
It is debatable whether there is an advantage in ﬁtting the shared component
model here as there is no separate component for COPD.
In Figure 9.4 the left panel displays the separate CAR component for
asthma while the common shared component is displayed in the right panel.
These components are remarkably similar in spatial distribution although the
shared component had a
greater concentration of common risk in the far
south of the state. This is slightly diﬀerent in distribution from the common
component in Model 2.
9.3
Multiple Diseases
Many of the considerations that apply to two diseases extend straightfor-
wardly to more than two diseases. It is often the case that a range of diseases
might be of interest in both public health applications and in epidemiological

208
Bayesian Disease Mapping
(5)   < 0.5
(59) 0.5-1.0
(59) 1.0-1.5
(22) 1.5-2.0
(13) 2.0-2.5
(6)   2.5-3.0
(2)   >= 3.0
N
(43) < 1.0
(78) 1.0-2.0
(28) 2.0-3.0
(9)   3.0-4.0
(0)   4.0-5.0
(1)   >= 5.0
(120) < 2.5
(21)   2.5-5.0
(14)   5.0-7.5
(3)     7.5-10.0
(0)     10.0-12.5
(1)     >= 12.5
N
N
FIGURE 9.1
Georgia county level data, 2005: asthma, angina, and COPD (all ages stan-
dardised by the state rate).

Multivariate Disease Analysis
209
(3)   <–0.2
(26) –0.2-–0.1
(56) –0.1-2.77556E-17
(48) 2.77556E-17-0.1
(21) 0.1-0.2
(5)   >= 0.2
N
(1)   <–1.5
(4)   –1.5-–1.0
(10) –1.0-–0.5
(56) –0.5-0.0
(71) 0.0-0.5
(17) >=0.5
N
FIGURE 9.2
Georgia county level three diseases: posterior expected UH components for
asthma (left) and COPD (right) when ﬁtted with a common CAR component.
studies. However there are also more diﬃculties, as the possible comparisons
increase with L. Multivariate disease modeling is now the focus.
9.3.1
Case Event Data
Assume that there are L diseases with {sli}, l = 1, ...., L and i = 1, ..., Nl
where L > 2. Here Nl = ml +mcl so that there are ml cases and mcl controls
for the l th disease. Here I will only consider models that are conditional on the
realization of the case and control events. Hence the assumption is made that
ml, mcl
and the locations of these cases and controls {sli}, l = 1, ...., L are
ﬁxed at the likelihood level. Often groups of disease are the focus. For example,
it might be that a range of respiratory (asthma and COPD) and other chronic
diseases (angina) are to be examined in relation to an air pollution source or to
general pollution levels measured at sites. We are now interested in the case
event intensities λl(s|ψl) = λl0(s|ψl0).λl1(s|ψl1), l = 1, .., L. Consideration
similar to Section (9.2.1) lead to diﬀerent forms of conditioning. First it is
clear that conditional on an event at s, the probability it is of disease type k is
a normalization: λk(s|ψl)/
L

l=1
λl(s|ψl). Other normalizations can be derived.
It is important to focus on particular forms of inference. For example, if we are
interested in competing risks of one disease over another and want to make
inference about the distribution of case types then
Pr(l(s) = k and case(s)) = [λk(s|ψl)/
L

l=1
λl(s|ψl)]. Pr(case(s))
where Pr(case(s)) =

l
λl(s|ψl)/[

l
λl(s|ψl) +

l
λl0(s|ψl0)].

210
Bayesian Disease Mapping
(1) <
-1.0
(15)
-1.0 -
-0.5
(70)
-0.5 -
0.0
(52)
0.0 -
0.5
(21) >=
0.5
N
FIGURE 9.3
Georgia county level three diseases. Analysis with common component: pos-
terior expectation of the common CAR component (Model 2).
In general, it is possible to deﬁne a likelihood for particular situations. Law-
son and Williams (2000) proposed conditional independence likelihoods for a
putative hazard example.
As far as this author is aware, there are few published examples of Bayesian
analysis of multitype spatial disease realizations. A multivariate analysis of
the residential locations of death certiﬁcates for respiratory disease (bronchi-
tis) and air-way cancers (respiratory, gastric, and oesophageal) was proposed
by Lawson and Williams (2000). Data were obtained for the years 1966–1976
for a small industrial town in the United Kingdom. These diseases were cho-
sen as a set of diseases potentially related to adverse air pollution. Control
diseases examined were coronary heart disease mortality (which is age-related
but not usually aﬀected directly by air pollution), and a composite control of
lowerbody cancers (prostate, penis, testes, breast, cervix, uterus, colon, and
rectum). These latter cancers were useful as they are less aﬀected by respira-
tory inhalation insult and so can be regarded as a reasonable control which
is matched on age to the risk proﬁle of the case diseases. Figures 9.5 and 9.6
display the location maps of the residences. It is notable how the composite

Multivariate Disease Analysis
211
(1)   <–1.0
(10) –1.0-–0.5
(74) –0.5-0.0
(58) 0.0-0.5
(15) 0.5-1.0
(1)   >= 1.0
N
(1)   <–1.0
(17) –1.0- –0.5
(57) –0.5-0.0
(66) 0.0-0.5
(18) >= 0.5
N
FIGURE 9.4
Georgia county level asthma and COPD: posterior expected estimates of the
asthma CH component (left) and the shared component (right).
control follows closely the CHD spatial distribution. In the example of Lawson
and Williams (2000), the ﬁrst order intensity was related to a ﬁxed putative
pollution source via a distance measure, so that λl1(s|ψl1) = 1 + fl(s|ψl1)
and for each disease the link was deﬁned as fl(s|ψl1) = α1l exp[−α2ld(s) +
α3l log d(s)] where d(s) is the distance from the location s to a ﬁxed point
(putative source). A joint likelihood was derived and estimation of parame-
ters proceeded via McMC applied to the posterior distribution with uniform
prior distributions for all parameters. The likelihood used conditional prob-
abilities for diﬀerent case types and a common control disease. Further, ex-
ploration of the possibility of weighting of diﬀerent diseases was considered
via the total intensity speciﬁcation: λ(s|ψ) =

l
wlλl(s|ψl). Subsequent de-
velopment of a weighted likelihood was considered in the context of prior ex-
pert opinion about what weight each disease should have in deﬁning evidence
for an eﬀect.
Further non-Bayesian analysis of multiple diseases has been developed
within a non-parametric smoothing approach by Diggle et al. (2005), where
estimation of the conditional disease probability:
p(s) = λk(s|ψl)/
L

l=1
λl(s|ψl)
is carried out non-parametrically to produce surfaces of these probabilities.
The basic likelihood derived for the multitype situation can be seen as a
special case of an ordinal logistic formulation where a probability of a disease
type is to be modeled. Diﬀerent formulations of ordinal logistic regression can
be considered, but the commonest for nominal categories is the multinomial
logit model. If a single common control is assumed it would be very convenient

212
Bayesian Disease Mapping
0
20
40
60
80
100
120
140
X distance (km tenths)
X distance (km tenths)
y distance (km tenths)
y distance (km tenths)
0
20
40
60
80
100
120
140
10
0
20 30 40 50 60 70 80 90 100
10
0
20 30 40 50 60 70 80 90 100
110
FIGURE 9.5
Arbroath mortality study: control disease realisations: composite cancer con-
trol (left panel); CHD control (right panel).
to consider that as a baseline category in the comparison. This is denoted as
L + 1 below. Hence, a possible multinomial logit model would be
log
 pk(ski)
pL+1(ski)

= αk + fl(ski|ψl1)
where pk(ski) = λk(ski|ψk)/
L+1

l=1
λl(ski|ψl).
Again it would be straightforward to deﬁne a Bayesian hierarchical model
around this formulation. For example, log
.
pk(ski )
pL+1(ski )
/
= αk+fl(ski|ψl1) where
fl(ski|ψl1) = wli + vli where wli, vli are spatially-correlated and uncorrelated
random eﬀects. This would allow separate random eﬀects for each disease.
Zhou et al. (2007) gives an example of Bayesian formulation where spatial
correlated eﬀects are modeled with categorical ordinal outcomes, and these
models could be modiﬁed for the simpler nominal case.
As an example of the application of this multinomial logit model, the Ar-
broath case event data has been examined. Only one control is assumed and
it is regarded as the comparison group here. In the following, the composite
lower body cancer is the control disease (label 1), followed by gastric and oe-
sophageal cancer (label 2), respiratory cancer (label 3), and bronchitis (label
4). The multinomial logit model was ﬁtted assuming a simple random eﬀect
model with yil denoting a sparse indicator variable of dimension NT × L,

Multivariate Disease Analysis
213
0
10
20
30
40
50
60
70
80
90
x distance (km tenths)
0
20
40
60
80
100
120
140
y distance (km tenths)
0
10 20 30 40 50 60 70 80 90 100
x distance (km tenths)
0
20
40
60
80
100
120
140
y distance (km tenths)
0
10
20
30
40
50
60
70
80
90
100
x distance (km tenths)
-10
10
30
50
70
90
110
130
y distance (km tenths)
FIGURE 9.6
Arbroath mortality study: gastric and oesophageal cancer (top); respiratory
cancer (middle); bronchitis (bottom).

214
Bayesian Disease Mapping
where NT = 
l Nl, which takes values as follows
yil =

 1 if l = 1
0 otherwisei = 1, 250, l = 1, .., L
.
.
yil =

L if l = L
0 otherwisei = 437, 630, l = 1, .., L
In the Arbroath example, L = 4, and NT = 630 with 250 control cases, 90
gastric and oesophageal cancer, 97 respiratory cancer, and 193 bronchitis case
events. Assume that
yi ∼Mult(pi, 1)
where
Pr(yil = 1) = pil = λl(sli|ψl)/{1 +
L

k=2
λk(sli|ψk)} l > 1
Pr(yi1 = 1) = pi1 = 1/{1 +
L

k=2
λk(sli|ψk)}
with λl(sli|ψl) = exp(αl + wil) where
αl ∼N(0, τl)
wil ∼N(0, τwl)
with a separate intercept and a simple uncorrelated eﬀect for each disease.
Suitably dispersed prior distributions were assumed for the variance param-
eters. More complex random eﬀect structures could be envisaged of course.
However this formulation serves to demonstrate the modeling approach. Fol-
lowing convergence the DIC for this model was 3054.97 with pD = 579.14.
The model provides relative estimates of disease probabilities as well as scalar
parameters. The posterior expected estimates of αl, l = 2, 3, 4 with sd in
brackets: -2.455(0.2331), -2.078(0.2208), -0.234(0.1921). It appears from this
that gastric and oesophageal cancer and respiratory cancer have signiﬁcantly
diﬀerent overall levels compared to the combined control whereas the bronchi-
tis level is not signiﬁcant. Figures 9.7 and 9.8 display the posterior expected
estimates for the pil for the control (l = 1), gastric and oesophageal cancer
(l = 2), respiratory cancer (l = 3), and bronchitis (l = 4). It is noticeable that
the control has a highly variable distribution, while, in relation to control,
the gastric and oesophageal cancer appears with peaks in markedly diﬀerent
locations (the respiratory cancer has a similar patterning). The bronchitis dis-
tribution also diﬀers from control but seems to have larger areas of elevated
risk.
It is of course possible to extend this approach to models with more sophis-
ticated random components (such as CH components based on full MVN prior

Multivariate Disease Analysis
215
FIGURE 9.7
Arbroath study: posterior expected probability surface (pil) for the composite
control (left), and gastric and oesophageal cancer (right).
FIGURE 9.8
Arbroath study: posterior expected probability surface (pil) for the respiratory
cancer (left), and bronchitis (right).

216
Bayesian Disease Mapping
speciﬁcation or approximate MRF models based on Voronoi neighborhoods).
Indeed models including correlation between diseases, with for example share
components or cross-correlation could be speciﬁed. This is largely unexplored
in this application area.
9.3.2
Count Data
In the case of count data various possibilities exist. Assume that there are
{yil}, l = 1, .., L and i = 1, ..., m, with L > 2. Hence in each area there is a
vector of counts representing the L diﬀerent diseases. Various approaches can
be adopted depending on the focus. First, by conditioning on the total count
within the small area: yTi =
L

l=1
yil, it is possible to consider the multinomial
distribution for the count probability vector yi. On the other hand, it is also
possible to examine the unconditional distribution of the counts assuming
conditional independence and a Poisson count distribution. In the ﬁrst case,
assume that
yi ∼Mult(pi, yTi)
and, because of the constraint, the probability vector is deﬁned to be 0 <
pil < 1, and
L

l=1
pil = 1 ∀i.The log-likelihood is then considered to be
l(y|p) =
m

i=1
L

l=1
yil log pil.
To model the probabilities, it is useful to assume that they arise from a nor-
malization such as:
pil =
λil

k
λik
where the constant term in the rate (λil) cancels out. Here it would also
be convenient to assume that rate terms consist of a log linear function of
covariates or random eﬀects. A typical general example could be λil = eilθil
where θil = exp{αl + x′
iβ + uil + wil} where αl is a disease speciﬁc intercept,
x′
iβ a linear predictor, and ul, and wl are disease speciﬁc random eﬀects.
Other forms are possible in speciﬁc applications. Clearly by normalization, the
conditioning on the total disease count in each area yields relative inference
concerning the disease distribution. An example of the application of such a
model was made to the chronic three-disease example for county-level data
for Georgia. In this case a description of the three diseases is sought and no
covariates are included. Hence the form θil = exp{αl + uil + wil} is assumed
where uil has a CAR prior distribution speciﬁcation for each disease and wil
has a zero-mean Gaussian speciﬁcation. In that analysis the converged sampler

Multivariate Disease Analysis
217
FIGURE 9.9
Georgia county level three chronic diseases 2005: asthma: spatially-correlated
random eﬀect (u1).
yielded a DIC of 1879.9 with pD = 240.112. The resulting spatially-correlated
random eﬀects for the three diseases are shown in Figures 9.9, 9.10, 9.11. It is
clear that under this multinomial model the spatially-structured risk is quite
diﬀerent for each of the three cases. In fact the distribution of high risk areas
of COPD seems to be inversely related spatially to those of angina.
Alternative formulations of multivariate risk can be envisaged. In fact the
shared component models discussed in Section 9.2.2 have been extended to
multiple diseases by Held et al. (2005). In their formulation a Poisson likeli-
hood is assumed:
yil ∼Poisson(eil exp[ηil])
and
ηil ∼N(αl +

k
δk,luki, τl)
and
nk

l=1
δk,l = 0
and the terms log δk,1, ....., log δk,nk have multivariate normal distribution with
mean zero and given marginal variance. Once more than two diseases are
examined however the interpretation of a shared component is more diﬃcult.

218
Bayesian Disease Mapping
FIGURE 9.10
Georgia county level three chronic diseases 2005: COPD: spatially-correlated
random eﬀect (u2).
FIGURE 9.11
Georgia county level three chronic diseases 2005: angina: spatially-correlated
random eﬀect (u3).

Multivariate Disease Analysis
219
9.3.3
Multivariate Spatial Correlation and MCAR Models
9.3.3.1
Multivariate Gaussian models
In general, once multiple diseases are admitted into an analysis there is a
need to consider relations between the diseases. This can be done in a variety
of ways. A basic approach to this is to consider cross-correlation between
the diseases. There is considerable literature on the speciﬁcation of cross-
correlation models for Gaussian processes (see e.g., Banerjee et al., 2004). In
general, deﬁne an L-dimensional vector Yi i = 1, ..., m observed at a set of
sites. For a multivariate Gaussian process, a common assumption would be
that
Y ∼MVNmL(μ, AY)
where μ is m×L and AY has dimension mL×mL. It is convenient to consider
a block representation of AY which stresses the covariance in cross-covariance
form:
AY =
⎧
⎪
⎪
⎨
⎪
⎪
⎩
A11 A12 . A1L
A21 A22 .
.
.
.
.
.
AL1
ALL
⎫
⎪
⎪
⎬
⎪
⎪
⎭
.
Here each of the diagonal block matrices are internal covariances within the
given ﬁeld whereas the oﬀ-diagonal block matrices deﬁne the cross-correlations
between components. The dimension of the block matrices is m × m if all the
ﬁelds are observed at the same m locations (sites), whereas if the diﬀerent
ﬁelds are measured at diﬀerent numbers of sites then each diagonal matrix
will be square and will have diﬀerent dimension and the oﬀ-diagonals will not
necessarily be square either.
Various models can be assumed for the overall covariance structure of a set
of Gaussian ﬁelds. Often simple assumptions are made to allow for compu-
tation. Banerjee et al. (2004) discuss various examples of separable models
and asymmetric cases (mainly for simple situations where each ﬁeld is mea-
sured on the same grid). They also extend the analysis by considering the
linear model for coregionalization (LMC) which speciﬁed that a multivariate
process is a linear function of iid spatial processes with zero mean, variance
1 and spatial covariance function ρ(h) for distance h. More generally sepa-
rate covariance functions ρl(h) can be assumed so that the cross-covariance
is deﬁned as All′ = L
j=1 ρj(s −s′)Tj for locations s and s′, where Tj is the
covariance matrix for the j th component. An alternative, computationally
attractive, conditional speciﬁcation was also proposed by Royle and Berliner
(1999).
While in general full multivariate cross-correlation models could be em-
ployed for modeling continuous multivariate spatial processes, their imple-
mentation is not straightforward and in particular their computational de-
mands often force the consideration of simpler formulations. Note that within
a disease mapping context these models could form joint prior distributions

220
Bayesian Disease Mapping
for spatial random eﬀects (rather than models for observed Gaussian ﬁelds),
especially for case event models where continuous spatial eﬀects are naturally
favored. Hence for the i th case event we might be interested in the vector of
intensities:
λ(si|ψ) = exp (Δi+Yi)
where Δ includes ﬁxed and uncorrelated random eﬀects and Y is a multivari-
ate spatial Gaussian process. For count data this might take the form, for the
i th small area with area denoted as ai:
θi = exp(Δi+μi)
μi =

ai
Y(u)du
Often for count data and approximately for case event data a Markov random
ﬁeld (MRF) speciﬁcation is adopted at least for simplicity of implementation.
In the next section these multivariate CAR models are discussed.
9.3.3.2
MVCAR models
The MVCAR model of Gelfand and Vounatsou (2003) speciﬁes that the m×L
matrix of random eﬀects φ in the model
yil ∼Poisson(eil exp[x′
ilβl + φil])
is deﬁned with a constraint that the spatial eﬀects separate into non-spatial
and spatially structured eﬀects:
φ ∼NmL(0, H1)
where H1= [Λ ⊗(D−αW)]−1 with ⊗denoting Kronecker product, and D is
a m × m diagonal matrix with elements which are the number of neighbors
of the i th region and W is an adjacency matrix where Wii = 0 and Wij = 1
if the areas i, j are adjacent (i.e., i ∼j) and 0 otherwise. Here Λ is a L × L
positive deﬁnite matrix of non-spatial precisions, deﬁning the relation between
diseases and α is a common spatial autocorrelation parameter. This is denoted
as the MCAR (α, Λ) model. This model can be extended to allow for separate
autocorrelation (smoothing) for each disease:
φ ∼NmL(0, H2)
where H2 = [Q(Λ⊗Im×m)Q′]−1 and Q = diag(R1, ..., RL) and Rl = chol(D−
αlW), l = 1, ..., L, where chol() denotes the cholesky decomposition. This has
been termed the MCAR(α, Λ). Extensions and variants to these models have
been proposed by Kim et al. (2001) and Jin et al. (2005). Restriction to the
conditional ordering of the eﬀects in the GMCAR model of Jin et al. (2005),
have led to a diﬀerent approach.

Multivariate Disease Analysis
221
9.3.3.3
Linear model of coregionalization
A classic approach to modeling cross-correlation between spatial ﬁelds is to
adopt a simple model for the relation between selected ﬁelds. Within Geo-
statistics, the linear model of coregionalization (LMC) is commonly assumed
for this purpose Wackernagel, 2003. In that model a set of random spatial
functions {zl(s); l = 1, ..., L} are modeled via a linear combination of uncor-
related factors (Y l
u(s)) and u = 1, .., S components:
zl(s) =
S

u=0
L

l=1
al
uY l
u(s).
This idea has been used by Jin et al. (2008) in extending the multivariate
models for disease mapping to allow order-free modeling. In their formulation
the model at the likelihood level is
yil ∼Poisson(eil exp[x′
ilβl + φil])
where φil are random eﬀects for each unit and disease. The joint distribution
of φ is deﬁned to be
φ ∼NmL(0, G)
where G = (A ⊗Im×m)(IL×L ⊗D −B ⊗W)−1(A⊗Im×m)′ with ⊗denot-
ing Kronecker product and B includes smoothing parameters in the cross-
covariances of the ﬁeld, D is a m × m diagonal matrix with elements which
are the number of neighbors of the i th region, and W is an adjacency matrix
where Wii = 0 and Wij = 1 if the areas i, j are adjacent (i.e., i ∼j) and 0
otherwise.
This is deﬁned as a MCAR(B,Σ) distribution, where the diagonal elements
of B are a correlation within a spatial process and the oﬀ-diagonals are the
cross-correlations between any two processes. These are scalar quantities. Es-
sentially, the diﬀerence with the MCAR(α, Λ) lies in the the elements of B:
if the bjl = 0 and bjj = αj then the MCAR(α, Λ) results. Special prior dis-
tribution constructions must be examined to ensure that the eigenvalues of B
lie in the correct range. Jin et al. (2008) give examples of its use and compare
diﬀerent formulations.
9.3.3.4
Model ﬁtting on WinBUGS
Currently, only the intrinsic (improper) version of the MCAR (α, Λ) model is
available automatically on WinBUGS. This version forces the value of α = 1,
and this implies that this can be used as a prior distribution only, assuming
that propriety of the posterior distribution can be assured. The command in
WinBUGS for this is the mv.car distribution. It is also possible to ﬁt a proper
MCAR (α, Λ) if it is assumed, via the LMC, that
φ = (A ⊗Im×m)u

222
Bayesian Disease Mapping
where ul l = 1, ..., L are assumed to have proper univariate CAR prior dis-
tributions (on WinBUGS: car.proper distribution) with common smoothing
parameter α. This ﬁxes A as it is the Cholesky decomposition of Λ although
it may be preferred to allow a separate prior speciﬁcation for Λ. Again by
the LMC it is possible to extend this idea to ﬁtting MCAR(α, Λ) models.
In that case, as before assign proper univariate CAR prior distributions to ul
l = 1, ..., L but with separate smoothing parameters: αl, l = 1, ..., L. Assuming
an inverse Wishart prior distribution for Λ determines A.
9.3.4
Georgia Chronic Ambulatory Care-Sensitive
Example
In the example above concerning chronic ambulatory care sensitive diseases,
three diseases were examined: asthma, COPD, and angina. These were ex-
amined as counts for the year 2005 in Georgia counties. In Section (9.2.3),
the analysis of these diseases was limited to two diseases only. Here all three
are considered together in a multivariate framework. Here, it is assumed that
each disease has a log-linear link to a linear predictor which consists of ran-
dom eﬀect components. In particular it is assumed that two additive random
eﬀects are included in the form
log(μli) = log(eli) + αl + Wli + Uli
where
Uli ∼MV N(0, Σ)
Wli ∼MCAR(1, Ω).
The ﬁrst eﬀect is an uncorrelated eﬀect with zero mean and diagonal covari-
ance matrix where Σ = diag(τ1, ..., τL). For the second term an intrinsic CAR
model was assumed using the mv.car distribution. The 3 × 3 precision matrix
has assigned to it a Wishart prior distribution with parameter matrix R,
and the covariance matrix deﬁned as Ω−1. Additional assumptions about the
model components were made. These include a Wishart prior distribution of
the precisions of the uncorrelated eﬀects (Σ−1). Flat (uniform) priors for the
intercept terms (αl). The following code was used to specify the covariance
priors and resulting standard deviations:
omega[1:3, 1:3] ˜dwish(R[ , ], 3)
sigma2[1:3, 1:3] <- inverse(omega[ , ])
sigma[1] <- sqrt(sigma2[1, 1])
sigma[2] <- sqrt(sigma2[2, 2])
sigma[3]<-sqrt(sigma2[3,3])
The sigma[1:3] terms are conditional standard deviations of the disease
components (1: asthma, 2: COPD, 3: angina). It is also possible to compute

Multivariate Disease Analysis
223
the correlations between spatial components in this formulation:
corr12<-sigma2[1,2]/(sigma[1]*sigma[2])
# asthma and COPD
corr13<-sigma2[1,3]/(sigma[1]*sigma[3])
# asthma and angina
corr23<-sigma2[2,3]/(sigma[2]*sigma[3])
# COPD and angina
The above analysis allows the computation of the correlations between the
spatial random eﬀects for each disease. This is useful but it is sometimes useful
to also consider the correlation of the relative risks directly. To compute the
correlation between the relative risks it is possible to examine functionals of
the posterior distribution. This can be easily implemented in WinBUGS with
the commands below. RR1, RR2, RR3 are the relative risk for the asthma,
COPD and angina where within a for() loop with index i they are assigned
as
RR1[i] <- exp(alpha[1] + S[1,i]+U[i,1])
RR2[i] <- exp(alpha[2] + S[2,i]+U[i,2])
RR3[i] <- exp(alpha[3] + S[3,i]+U[i,3])
where S is the MCAR and U is the (spatially) uncorrelated random eﬀects.
Then the empirical posterior correlation can be computed as
mu1<-mean(RR1[])
mu2<-mean(RR2[])
mu3<-mean(RR3[])
sd1<-sd(RR1[])
sd2<-sd(RR2[])
sd3<-sd(RR3[])
mu12<-inprod(RR1[],RR2[])/N
mu13<-inprod(RR1[],RR3[])/N
mu23<-inprod(RR2[],RR3[])/N
CRR12<-(mu12-mu1*mu2)/(sd1*sd2)
CRR13<-(mu13-mu1*mu3)/(sd1*sd3)
CRR23<-(mu23-mu2*mu3)/(sd2*sd3)
The results of ﬁtting this model to the 3 diseases yielded the following
results. After convergence, the DIC was 3226.61 with pD as 392.92. This is
slightly higher than the DIC for the separate analyses (DIC = 3225.5 and pD =
394.8). However this is not a large diﬀerence and so there appears to be little
diﬀerentiating the models except that the MCAR model provided estimates
of correlation and a lower pD of 392.9.
From the point of view of parsimony
then this might be preferred. The correlation estimates are given in Table 9.2.
In that table the top right hand triangle is the posterior expected correlation
estimates from the posterior distribution for the spatially-structured random
eﬀects, while the lower triangle has the empirical correlations calculated from
the posterior sample for the estimated relative risks. It is interesting to note

224
Bayesian Disease Mapping
(7) <
0.5
(54)
0.5 -
1.0
(56)
1.0 -
1.5
(20)
1.5 -
2.0
(14)
2.0 -
2.5
(5)
2.5 -
3.0
(3) >=
3.0
N
(44) <
1.0
(78)
1.0 -
2.0
(26)
2.0 -
3.0
(10)
3.0 -
4.0
(0)
4.0 -
5.0
(1) >=
5.0
N
(119) <
2.5
(23)
2.5 -
5.0
(13)
5.0 -
7.5
(3)
7.5 -
10.0
(0)
10.0 -
12.5
(1) >=
12.5
N
FIGURE 9.12
Georgia county level three disease analysis 2005: posterior expected relative
risks under an additive UH and MVCAR model: top left: asthma, right:
COPD, bottom left: angina.

Multivariate Disease Analysis
225
TABLE 9.2
Correlation of spatial random eﬀects under the MCAR model for the
Georgia chronic disease example: upper triangle: correlation of the
spatially structured eﬀects; lower triangle: correlation of the relative
risks
Disease
Asthma
COPD
Angina
asthma
0.6617(0.128)
0.7536(0.105)
COPD
0.6004(0.033)
0.7825(0.099)
angina
0.5417(0.044)
0.516(0.042)
that the correlations between the spatially-structured eﬀects are higher for
angina versus COPD and asthma than those correlations for the relative risks.
This eﬀect might suggest that there is more uncorrelated noise in the angina
relation than in the asthma versus COPD relation, which remains relatively
stable. In general, there does appear to be a strong correlation between the
risk for these chronic diseases.


10
Spatial Survival and Longitudinal Analysis
10.1
General Issues
In many biostatistical applications there is a need to consider temporal varia-
tion. The commonest examples are often found in clinical or behavioral inter-
vention trials where a state can be reached by a patient. The time at which
the state is reached could be of primary interest. The end point could be a
vital outcome (death) or disease remission, cure or cessation of a behavior.
In all cases the time of the event is the important random variable. This is
the typical scenario where survival analysis is employed. On the other hand,
in some clinical or intervention studies, the variation of response over time is
to be monitored. For example, cholesterol concentrations in blood might be
monitored under diﬀerent treatments, and the eﬀect of these treatments over
time is to be examined. In an intervention trial for diet change, food intake
might be repeatedly measured via self-report questionnaire. In these cases,
the time of measurement is usually ﬁxed and the measurement itself is the
random variable.
In clinical trial applications there is not often a need, or interest, in exam-
ining the residential address of the patient or the even the neighborhood or
county of residence. As clinical trials are designed experiments, and usually
randomized, then there should be less need to consider location of residence
or area of residence as a factor aﬀecting outcome. Two factors should be con-
sidered, however, that could impact a decision to ignore spatial eﬀects. First,
at the design stage there could be a geographical bias in the areas displaying
risk for the disease. This bias could manifest itself by diﬀerential recruitment.
Any strong geographical diﬀerences might need to be represented in the study
design if the study is to be representative of the population concerned. Even
after design, in the analysis phase, there could be strong reasons to examine
spatial eﬀects. First, it could be important to know if there were any spatial
eﬀects such as confounding between space and intervention groups, in rela-
tion to outcome. Second, all studies whether designed or observational, have
confounders which could be unknown or known but not included in the study.
Hence if the researcher wants a) to explore factors aﬀecting the study and
b) to make sure that confounding is allowed for in the analysis, then the use
of spatial information can help with both these tasks. Clayton et al. (1993)
227

228
Bayesian Disease Mapping
have stressed the usefulness of including spatial correlation terms in models
to make allowance for confounder and ecological biases and so there is reason-
ably strong arguments for always including contextual terms that have spatial
structure.
10.2
Spatial Survival Analysis
In survival analysis the time to endpoint (T ) is the random variable. Assume
that a sample of individuals have associated endpoint times. Denote this sam-
ple of times as {ti} i = 1, ...., m. For now assume these are all observed
exactly. In addition to an endpoint time a geo-reference is also available. The
geo-reference could be an address location, in which case it is denoted as si,
or a contextual spatial eﬀect, denoted as wi. The contextual eﬀect is sim-
ply a factor that may have spatial correlation so that areas close together
have similar risk. In addition to these ingredients, each observation unit can
have covariates associated and, for the i th unit/person these are denoted by
the vector xi. These covariates could be individual or contextual/ecological
(see e.g., Chapter 7). Reviews of Bayesian survival methods can be found
in Gustafson (1998) and Ibrahaim et al. (2000). For Bayesian proportional
hazard modeling see Carlin and Hodges (1999).
10.2.1
Endpoint Distributions
Often a failure time or endpoint distribution is speciﬁed for the time to end-
point and this is often chosen from distributions on the R+ line. Common
choices are among the Weibull or extreme value, lognormal, or gamma fami-
lies.
Hence for a parametric survival model, at the 1st level of the hierarchy, the
data model consists of an endpoint distribution. For ﬂexibility, we will assume
a Weibull distribution in what follows. The probability of an endpoint at time
ti under a Weibull distribution is speciﬁed by
fT (ti) ≡f(ti) = ρμtρ−1
i
exp(−μtρ
i ).
(10.1)
The survival and hazard functions derived from this speciﬁcation are
S(ti) = 1 −
ti
0
f(u)du = exp(−μtρ
i )
h(ti) = f(ti)/S(ti) = ρμtρ−1
i
.
The parameterization emphasizes the modeling of a function of the mean of
the distribution via μ. Note that this allows a straightforward interpretation of

Spatial Survival and Longitudinal Analysis
229
the model component for this distribution: covariates and contextual eﬀects
can be included within μ and the parameter ρ provides the shape of the
distribution. Often modeling proceeds via the hazard function, rather than
the density, and for the Weibull this decomposes into two components:
h(ti) = h0(ti).h1(ti) = ρtρ−1
i
.μi.
Here h0(ti) is regarded as a baseline hazard, while h1(ti) is a non-baseline
component which is usually the focus of modeling. Usually it is assumed that a
predictor term is linked to the parameter μi and each unit will have a diﬀerent
μi depending on covariates. A log-linear speciﬁcation is often assumed. A non-
spatial example could be
log(μi) = x′
iβ + vi
(10.2)
where x′
i is a row vector of ﬁxed covariates, β the corresponding parameter
vector, and vi is an uncorrelated random eﬀect. For the Weibull distribution,
Carlin and Hodges (1999) suggested the formulation (10.2) in a non-spatial
setting. This can be extended easily to include a spatial contextual eﬀect. For
example, we could specify
log(μi) = x′
iβ + Ωi
(10.3)
Ωi = wi + vi
where Ωi contains the unit speciﬁc random eﬀect terms. These eﬀects could
be individual unit level or they could be contextual.
While the Weibull is a ﬂexible distribution there are many alternatives, some
of which do not impose the constraints of proportionality of hazard. A wider
class of models is the accelerated failure time (AFT) models. These models re-
place the t within the survival and hazard functions with a modulated function
of covariates: t exp{x′β}. This leads to a covariate acceleration/deceleration
of risk. The Weibull is a special case of this general class. This lead to a linear
model in the log of time:
log T = α + x′β + ϵ
where ϵ is an error term independent of x (not necessarily zero centered) and
α is an intercept. This model could also be extended with addition of random
eﬀects which are individual or contextual in the form of
log T = α + x′β + Ω + ϵ
where Ω is a random eﬀect term (as in (10.3) above).
10.2.2
Censoring
Censoring is always an important issue in survival analysis as it is often the
case that times are not observed exactly. For parametric models this can be

230
Bayesian Disease Mapping
treated via a survival function term product in the likelihood. For example
for right censoring we can assume
L =

u
f(tu)

c
S(tc)
where u denotes uncensored and c denotes right censored. Note that this
likelihood simpliﬁes if you assume a censoring indicator γ which takes 0 for
censored and 1 for uncensored, as
L =

all t
h(t)γS(t).
Other likelihood forms can similarly be derived for alternative censoring mech-
anisms.
10.2.3
Random Eﬀect Speciﬁcation
As most survival data is observed at the individual unit level there could be
either individual covariates or random eﬀects or contextual eﬀects relating
to the individual. For example, the age of an individual could be a personal
covariate and the location coordinates of the individual’s address could be
regarded as personal covariates also. In addition, there could be an individual
level random eﬀect which allows for frailty among individuals. This could be
correlated spatially or uncorrelated. If the residential address of the individual
(unit) were known then this could be used directly. An uncorrelated frailty
can easily be speciﬁed for each individual via
vi
iid
∼N(0, τv)
For a spatially correlated term, wi could be speciﬁed to have a full multi-
variate normal prior distribution with spatial correlation included within the
covariance matrix, i.e.,
w ∼N(0, Σ)
(10.4)
where the elements of the covariance are a function of distance between lo-
cations: Σij = f(dij) where dij is the distance between the i th and j th
location. Essentially this is a zero-mean spatial Gaussian process prior distri-
bution. Note that it would also be possible to specify an intrinsic Gaussian
prior distribution for w as long as a suitable neighborhood structure could be
speciﬁed. A distance-threshold or Dirichlet tesselation neighborhood metric
could be used to deﬁne neighbors. While it is commonplace to model uncor-
related frailty at the individual level, it is less common to ﬁnd modeling of
spatially correlated eﬀects at this level.
As contextual eﬀects, it is relatively straightforward to include spatial ef-
fects. For example, with cancer registry data, often individual outcomes have
associated county, postal district, or zip code of residence. They often don’t

Spatial Survival and Longitudinal Analysis
231
have address location for conﬁdentiality reasons. Hence contextual spatial in-
formation is often available for these data. This consists of aggregated spatial
groupings or factors. For instance, in
Ωi = wi + vi
the two eﬀects could be speciﬁed as spatially-contextual. For example, assume
there are j = 1, ..., J counties within which individuals can live. The county
of residence for the i th individual is denoted cj
i∈j
so that
wi = w( cj
i∈j
)
Hence, the eﬀect for the i th person is assigned from the j th county that
they live in. This also applies to any other contextual aggregate eﬀects: for
example, uncorrelated eﬀects could also be deﬁned in this way:
vi = v( cj
i∈j
).
Henderson et al. (2002) modeled individual level frailty but resorted to model-
ing the spatial structure of leukemia survival data using district level (contex-
tual) eﬀects. In that work the covariance function f(.) between the i th and
j th district was modeled via the power exponential and Mat´ern covariance
functions (as in Section 5.4.2). At this level of aggregation, it is natural to
consider a CAR speciﬁcation of the spatial eﬀect at individual level:
wi|w−i ∼N(wδi, τw/nδi)
where wi = w( cj
i∈j
). Henderson et al. (2002) also compared their contextual
models with fully speciﬁed covariance and CAR components and found that
a Mat´ern covariance, speciﬁed with correlation function (ρij = Σij/τ):
ρij = (dij/φ)κKκ(dij/φ)/[2κ−1Γ(κ)]
(10.5)
where Kκ(.) is a modiﬁed Bessel function of the third kind with κ = 2, gave
the best ﬁtting model based on the DIC goodness-of-ﬁt criterion. Hence, in
this case, the geostatistical model yielded a more appropriate model than the
CAR model for district eﬀects. This was not found to be the case in other
comparisons of Gaussian prior distributions (e.g., see Best et al., 2005).
Banerjee et al. (2003) ﬁrst reported the use of spatially-correlated frailty in
application to linked birth-death individual level infant mortality data for the
US state of Minnesota. In their formulation a Weibull parametric model was
assumed and the hazard was assumed to be
h(tij|x) = ρtρ−1
ij
exp{x′
ijβ+wi}

232
Bayesian Disease Mapping
where i th subject in the j th stratum (i = 1, .., nj) and x′
ij is a row vector of
covariate values and β the corresponding parameter vector. The random eﬀect
wi was assumed to have either a CAR prior speciﬁcation, an uncorrelated
zero-mean Gaussian prior distribution, or a fully-speciﬁed multivariate normal
prior speciﬁcation as in Henderson et al. (2002). In fact, the fully speciﬁed
model yielded the lowest DIC in model comparison in this case also.
10.2.4
General Hazard Model
Banerjee and Carlin (2003) proposed a relaxation of the Weibull model to
allow a semiparametric formulation whereby, with subject j, (j = 1, ..., ni) in
the i th county:
h(tij|xij) = h0i(tij) exp{x′
ijβ + wi}
where h0i denotes the county-speciﬁc baseline hazard. For an individual with
censoring indicator γij (0 if alive, and 1 if dead) the likelihood contribution
is then
h(tij; xij)γij exp{−H0i(tij) exp{x′
ijβ + wi}}
where H0i(tij) =
	 tij
0
h0i(u)du a county-speciﬁc cumulative baseline hazard,
and the covariates are assumed to be not time-dependent. The baseline hazard
appears in this likelihood and so this must be estimated. Diﬀerent approaches
have been proposed for estimation of this baseline. One approach assumes a
Gamma process which is a function of a parametric cumulative hazard (see
e.g., Ibrahaim et al., 2000). Another is the use of Beta mixtures (Banerjee and
Carlin, 2003). A related spatial model was developed by Bastos and Gamer-
man (2006) whereby they allowed time-dependent covariates which are ﬁxed
within small time periods and a CAR spatial frailty. They assume no separate
baseline risk however.
10.2.5
Cox Model
The Cox proportional hazards model has been applied in a spatial context
by Henderson et al. (2002). In the context of leukemia survival, the authors
posited that the partial likelihood could be used without recourse to the es-
timation of the baseline. For ordered uncensored times {t(1), ......, t(m)}, then
the partial likelihood is given by

i
[exp{x′
(i)β}/

j∈Ri
exp{x′
jβ}]
where Ri is the set of those individuals at risk just before the i th event time.
This can be used for the estimation of regression parameters. This is less para-
metric than models that include baseline components. Note that spatial eﬀects
can be included again as contextual eﬀects by extending the speciﬁcation of

Spatial Survival and Longitudinal Analysis
233
the intensity term exp{x′
(i)β} to include random eﬀects:
exp{x′
(i)β+wi + vi}
(10.6)
where wi, vi are random contextual eﬀects which could be at an aggregate
level such as district or county. In addition these eﬀects could also be purely
individual (in the sense of frailty rather than context).
10.2.6
Extensions
Extensions of the above approaches have been proposed into a variety of
more complex applications. For example, spatial cure rate modeling has been
proposed by Cooner et al. (2006) and joint spatial survival modeling of date
of diagnosis and vital outcome from cancer registry data has been examined
by Zhou et al. (2008). In that approach, prostate cancer registry data was
available for the US state of South Carolina for the years 1997–2001. The
endpoints are deﬁned as T1ij and T2ij and their joint distribution is deﬁned
by conditioning
as fT2(t2ij|t1ij) and fT1(t1ij). In this formulation, ﬂexible
Weibull parametric models were assumed for both fT2(t2ij|t1ij) and fT1(t1ij) :
fT1(t1ij) ∼Weib(γ1, λ1ij)
fT2(t2ij|t1ij) ∼Weib(γ2, λ2ij|t1ij)
with log linear models for the scale parameters:
log λ1ij = α1 + x′
1ijβ1 + W1ij
log λ2ij = α2 + x′
2ijβ2 + β2tt1ij + W2ij.
In the second model, dependence on the the ﬁrst endpoint is simply via a lin-
ear function dependent on t1ij. Diﬀerent forms of random eﬀect combination
were speciﬁed within a selection of models for W1ij and W2ij. Figure 10.1 dis-
plays the empirical Kaplan-Meyer curves for the date of diagnosis (left panel)
and vital outcome (right panel) endpoints. The data-based K-M curves are
shown in solid line. The posterior predicted survival is shown on these curves
(as dashed lines) and seems to approximate well the empirical behavior at
least for ages less than 80. A range of eight models were ﬁtted with diﬀerent
combinations of separate and common random eﬀect structures. Of the eight
models, a model with an uncorrelated eﬀect (UH) for age and separate corre-
lated eﬀect (CH) for survival time had the lowest DIC (DIC = 115722, pD =
57.0). The second lowest DIC was for a model with separate UH eﬀects only
in each component (DIC = 115725, pD = 55.7). These models were denoted
Model 6 and Model 3, respectively. Figure 10.2 displays various posterior av-
erage random eﬀect maps for diﬀerent ﬁtted models for these data. The top
row displays results for the best-ﬁtting model: Model 6. The left panel is the
UH map for age-at-diagnosis while the right panel is the CH map for survival

234
Bayesian Disease Mapping
FIGURE 10.1
Nonparametric (Kaplan-Meier) survival curves compared to posterior predic-
tive survival from the best ﬁtting model based on DIC: left) age at diagnosis,
b) survival time after diagnosis. Solid line is data-based while the dashed
line (with 95% credible limits) is the posterior predictive survival under the
best-ﬁtting model.
time. It is noticeable that the lowered survival appears in the coastal and up-
state areas of SC whereas the UH map seems to display a relatively random
pattern. The bottom panel highlights the similarity of the UH eﬀect map for
other models ﬁtted for survival after diagnosis. It would appear that the CH
component is absorbed by a single UH component under these models and so
the result is similar to the CH map for the best ﬁtting model.
10.3
Spatial Longitudinal Analysis
There are many situations when variation in an individual response is time-
dependent, and the focus is the monitoring over time of the associated out-
come. The areas of application for these methods are manifold and in par-
ticular they are commonly applied in clinical trials and community-based
behavioral intervention trials.
In many clinical settings, it is possible to conduct trials of new treatments.
These trials are essentially designed experiments where patient outcomes are
compared between treatment groups. Often these are monitored over time
to establish whether a treatment has been eﬀective or not. In the simplest
case, when only two time points are employed, this leads to simple compar-
isons. However if more that two time points are monitored then considerable
complication can arise. In what follows, I will emphasize a general framework
for longitudinal analysis which incorporates spatial referencing. Recent gen-

Spatial Survival and Longitudinal Analysis
235
N
W
E
S
N
W
E
S
N
W
E
S
–0.168   -   –0.056
–0.056   -   –0.016
–0.016   -   –0.017
0.017     -    0.056
0.056     -    0.196
–0.130   -    –0.039
–0.039   -     0.002
0.002     -     0.014
0.014     -     0.025
0.025     -     0.070
50
0
50 Miles
50
0
50 Miles
50
0
50 Miles
50
0
50 Miles
N
W
E
S
–0.190   -    –0.051
–0.051   -    –0.008
0.008      -     0.029
0.029     -     0.048
0.048      -     0.090
–0.127   -    –0.039
–0.039   -     0.003
0.003     -     0.014
0.014     -      0.037
0.037     -      0.071
FIGURE 10.2
Posterior average maps of the random eﬀects. top left: UH eﬀect for age -at-
diagnosis for best model, top right: CH eﬀect for survival after diagnosis for
the best model, bottom left: UH eﬀect joint Model 3 and bottom right: UH
eﬀect joint Model 5, both for survival after diagnosis.
eral references to this area are Diggle et al. (2002), Verbeke and Molenberghs
(2000), and Molenberghs and Verbeke (2005).
Deﬁne an outcome for the i th individual at a given time j as yij. Usually
in designed studies the time period is ﬁxed and measurements are made at
these ﬁxed times. Hence, the time label denotes a ﬁxed time period. Further
deﬁne there to be i = 1, ..., m individuals or individual observation units and
j = 1, ..., J time periods. The periods could be units of time, such as min-
utes, hours, days, weeks, years, etc. depending on the study design. Usually
recruitment to the study will be randomized in a clinical or intervention trial
setting. However in observational studies, where such control is not possible,
it is likely that there will be considerable extra variation and potential for im-
balance. Hence there are strong reasons for inclusion of confounder or random
eﬀects when observational designs are used.
A simple general approach is to consider a linear model formulation whereby
the outcome of interest is assumed to depend on underlying parameters, and

236
Bayesian Disease Mapping
these parameters can be time-dependent. For example, serum cholesterol (ldl)
levels could be measured in patients on a trial for a new cholesterol drug at
two time points (baseline and 6 weeks). There are two groups: old drug, ﬁxed
dose (ODFD), and new drug, ﬁxed dose (NDFD). These groups are labeled
l = 1, 2, respectively. The outcome of interest is yilj at given times j = 1, 2,
and groups l = 1, 2. A statistical model for this situation will depend on
the nature of the outcome. If the outcome is continuous then a Gaussian or
gamma error model might be assumed. In the cholesterol trial, a continuous
Gaussian variate could be assumed, as a ﬁrst model, and so
yilj ∼N(μilj, τ y)
where μilj is the mean for the i th person at time j in group l, and the τ y is
a variance.
The mean parameter would then be speciﬁed as a function of available
covariates and random eﬀects. For example, it might be important to allow
for age of the individual. Deﬁne this as x1i. One simple regression model might
be
μilj = αl + β1x1i + β2tj
where tj is the time of the j th period. Here each group has a separate
intercept. The regression parameters would be commonly assumed to have
zero-mean Gaussian prior distributions with small precisions. In this model
a group eﬀect is speciﬁed, with a covariate eﬀect and constant linear eﬀect
over time. There is assumed to be no correlation in the error. More complex
models could of course be envisaged. Addition of random eﬀects can include
frailty terms and a temporal dependence term (which can substitute for the
regression on tj):
μilj = αl + β1x1i + vi + ηj
with, possibly, a random walk prior dependence:
ηj ∼N(ηj−1, τ η), j > 1,
and a zero-mean Gaussian prior distribution with for the individual level
frailty:
vi ∼N(0, τv).
If inference about spatial eﬀects are important then a variety of possibilities
exist. First, if individual level information is available then there are two
approaches to the inclusion of space. First it may be possible to estimate an
individual level; eﬀect directly for residential location data. Denote a spatially-
structured eﬀect as wi. Also assume that wi ≡w(si) where si is the i th
residential address. A model could be assumed of the form
μilj = αl + β1x1i + wi + ηj

Spatial Survival and Longitudinal Analysis
237
where wi can be assumed to have a fully-speciﬁed multivariate Gaussian prior
distribution and so
w ∼N(0, Γ)
where the elements of Γ are deﬁned as Γij = τ wρ(dij) and dij = ||si −sj||.
Suitable forms of the correlation function ρ(.) have been discussed elsewhere
(Sections 5.4.2, 10.2). Among these the power exponential or Mat´ern are com-
mon choices.
10.3.1
General Model
A general linear mixed model for a continuous outcome can be speciﬁed where
the vector y: {y1, ...., ym} where yi = (yi1,...., yiJ) is a realization of a random
vector from a multivariate normal distribution of form:
yi = x′
iβ + z′
iγ + ei
(10.7)
where x′
iβ is a linear predictor (which can include a group indicator), zi is a
vector of g random eﬀects for the i th individual, γ is a g × J unit matrix
and the model for ei is e ∼N(0,τΣ) where N = mJ, x′ is an N ×p matrix of
covariates, β is a parameter vector, τ is a variance and Σ is a block diagonal
matrix with J × J blocks each representing the variance matrix of the vector
measurements on a single subject. Various assumptions about the structure
of the covariance can be made depending on the focus of the study. I do not
pursue this here.
An extension of the approach can be easily made to generalized linear mixed
models (GLMM) whereby (10.7) is modiﬁed to allow diﬀerent distributional
assumptions at the data level and a link function is introduced to connect the
mean to the linear predictor:
yi ∼f(μi)
where E(yi) = μi
and g(μi) = ηi = x′
iβ + z′
iγ.
Suitable models for f(μi) could be the Poisson, binomial, gamma, and others
in the standard exponential family.
10.3.2
Seizure Data Example
As an example of the eﬀect of spatial structure on the analysis of longitudinal
data I have taken a famous data set which was examined by Breslow and
Clayton (1993): the epileptic seizure data (see also Diggle et al., 2002). This
consists of a randomized clinical trial of anticonvulsive therapy to inhibit
seizures in epilepsy. The trial consists of data from 59 patients, treated in two
groups (0,1: control, treatment) and the seizure count at four time points was

238
Bayesian Disease Mapping
monitored. There are three covariates: baseline seizure count (x1i), treatment
(x2i), and age (x3i) in years.
In Bayesian hierarchical modeling of longitudinal data there is no need to
consider marginal models (Verbeke and Molenberghs, 2000) as a model for the
full hierarchy is assumed and ﬁtted. Hence our model will explicitly assume
a full hierarchical model with random eﬀects. The basic model is a GLMM
with
yij ∼Poiss(μij)
(10.8)
log μij = α0 + log(x1i) + α1x2i + α2x3i + γj.
(10.9)
Here the baseline count is treated as a log(oﬀset) with no estimable parameter
while the treatment group is associated with parameter α1. Age is also treated
linearly with parameter α2, while an overall intercept is also ﬁtted. Finally
the temporal eﬀect in this model is deﬁned by a time dependence. There is
no regression on time but a random walk prior speciﬁcation is used to model
the variation. Hence the following is speciﬁed in the prior distributions:
α0 ∼U(−1000, 1000)
α1 ∼N(0, τα1); α2 ∼N(0, τα2)
γ1 ∼N(0, τγ)
γj ∼N(γj−1, τγ)
j > 1.
Regression parameters are given dispersed zero-mean Gaussian prior distri-
butions with τ α1, τα2, τ γ ∼Ga(0.001, 0.001). Table 10.1, line 1 displays the
overall goodness-of-ﬁt results for the basic model with no spatial random ef-
fects. Under this model, the DIC was found to be 1775.4, with pD = 5.311. To
demonstrate the eﬀect of spatial referencing on a clinical trial data set, I have
made a random allocation of patients to the 46 counties of South Carolina.
While this single realization does not represent the possible spatial variation
across counties, it does represent the type of variation one might expect if
there were a set of contextual regions (of any size) within which the patients
resided. While this initial assumption is crude in that it does not allow for
population variation, it should demonstrate less spatial structure than a typ-
ically signiﬁcant spatial confounder. I would then expect that there would be
little or no advantage found in adding a spatial contextual eﬀect at the county
level. However, as will be seen below, this is in fact not the case, even for a
blanket randomization such as this.
To examine the eﬀects of spatial context I have ﬁtted a sequence of simple
spatial context random eﬀect models with diﬀerent combinations of UH eﬀects
(vi) and CH eﬀects (wi). These are contextual eﬀects and so they are deﬁned
as
wi = w( cj
i∈j
)
vi = v( cj
i∈j
).

Spatial Survival and Longitudinal Analysis
239
TABLE 10.1
Comparison of four models for the seizure
data: basic and Models 1–3
Model
pD
DIC
basic model
5.311
1775.4
model 1
33.93
1485.7
model 2
38.24
1494.2
model 3
36.0
1488.9
They are deﬁned as a conventional zero-mean Gaussian prior distribution for
the {vi} and an improper CAR prior distribution for the {wi}. The models
ﬁtted were as follows:
Model 1 is as (10.9) but with vi added, Model 2 is as (10.9) but with
wi added, and ﬁnally the Model 3 is a convolution model with vi and wi
added to the basic model. The variance parameters for these distributions
were assumed to have their distributions deﬁned via standard deviations with
U(0, 100) distributions (Gelman, 2006). The results of ﬁtting these diﬀerent
models is found on Table 10.1. It is interesting to note that all models includ-
ing spatially-referenced random eﬀects (Models 1, 2, 3) have a considerably
lower DIC than the basic model. The best ﬁtting model by the DIC criterion
is Model 1 with only the uncorrelated eﬀect. Although the convolution model
yields a slightly higher DIC, it has lower DIC and pD than a model with only
the correlated spatial eﬀect. It is reassuring that the uncorrelated noise model
has best ﬁt as we did not present any overt spatial structure in the data.
However the fact that any spatially-referenced model (whether correlated or
not) leads to much reduced DIC is an important consideration. The reason
for the closeness of the Model 1 and 2 is largely because the CH eﬀect (wi)
will often mimic small scale variation found. Figure 10.3 displays the results
of these diﬀerent models. It is perhaps surprising how clustered even the UH
component appears. Of course one has to be careful of over-interpreting these
results as they are based on a single realization of synthetic contextual label-
ing. On the other hand, it is commonly the case that a single geo-referenced
sample would be available if the true spatial referencing were known. Finally
it is interesting to consider how the parameter estimates for the non-spatial
parameters performed under the diﬀerent models. Table 10.2 displays the esti-
mates for the ﬁnal converged sample for the basic model and the “best” model
(Model 1). It is notable that under the random eﬀect model the coeﬃcient
for the group eﬀect (α1) becomes signiﬁcant while under the basic model it is
not well estimated. It seems therefore that by reducing the noise in the model
the group eﬀect becomes more clearly apparent.
It is also interesting to compare standardized residuals for these models.
I have computed the average standardized residual for each individual ri =
1
4

j(yij −μij)/μij where μij is the posterior averaged value of μij. Figures
10.4 and 10.5 display these residuals for the basic model and Model 1. There is

240
Bayesian Disease Mapping
(1) < –1.0
N
(2) –1.0 - –0.5
(24) –0.5 - 0.0
(14) 0.0 - 0.5
(4) 0.5 - 1.0
(1) > = 1.0
N
(1) < –1.0
(4) –1.0 - –0.5
(18) –0.5 - 0.0
(18) 0.0 - 0.5
(4) 0.5 - 1.0
(1) > = 1.0
N
(2) < –0.5
(19) –0.5 - 0.0
(22) 0.0 - 0.5
(3) > = 0.5
N
(2) < –0.2
(22) –0.2 - 0.0
(20) 0.0 - 0.2
(3) > = 0.2
FIGURE 10.3
Seizure example: posterior average eﬀect maps: correlated (wi) and uncorre-
lated (vi) random eﬀects. Top left model 1 (vi), top right model 2 (wi); bottom
row Model 3: Left vi an right wi.
TABLE 10.2
Posterior average estimates of the model parameters under
the four diﬀerent seizure models
Model
α0
α1
α2
basic model
-6.188(0.623)
-0.079(0.046)
0.0101(0.003)
model 1
-2.368(0.751)
-0.5028(0.074)
0.0207(0.006)
TABLE 10.3
Parameter estimates for the basic model compared to the best ﬁtting model
(Model 1)
Model
γ1
γ2
γ3
γ4
basic model
4.681(0.614) 4.636(0.614) 4.619(0.616) 4.530(0.615)
best model (model 1) 0.607 (0.724) 0.559 (0.724) 0.543 (0.725) 0.455 (0.726)

Spatial Survival and Longitudinal Analysis
241
FIGURE 10.4
Standardized average residuals for the 59 individuals for the seziure data under
the basic model.
a noticeable reduction in variation in the residuals and a much better ﬁt with
Model 1. Patients 16, 38, and 52 remain with large residuals but 10, 49, and 19
have been accommodated under Model 1. Finally it is clear that random eﬀect
models are important here, and of course it would be useful in this modeling
to consider individual frailty
(besides contextual UH eﬀects). Indeed this
would often be the ﬁrst step of extending a model, before considering any
spatial eﬀects. In this example in fact, an uncorrelated frailty term (constant
over time) with vi ∼N(0, τ) i = 1, ..., 59 leads to a substantial reduction in
DIC (DIC =1277.180, pD =59.8) and also a signiﬁcant group eﬀect is found.
Overall, in the ‘pretend’ spatial data set it is clear that extra variation is
present. Assuming the spatial referencing were correct, then spatial contextual
eﬀects appear to be important. It is also clear that individual frailty could be
even more important to consider in the context longitudinal data analysis.
10.3.3
Missing Data
Missing data is a very important aspect of longitudinal studies. Apart from
general forms of missing data found in all studies, missingness can often arise
in longitudinal studies due to individuals failing to remain in the study. This
dropout, as it is known, is common in clinical or intervention trials and often
by the end of a study 20%–30% of the participants may have left. There are
diﬀerent forms of missingness mechanisms. Verbeke and Molenberghs (2000)

242
Bayesian Disease Mapping
FIGURE 10.5
Standardised average residuals for the 59 individuals for the seziure data under
the Model 1 with spatial contextual random eﬀect.
deﬁne three basic forms. While it may be important in given applications to
consider which if these apply, here I will focus simply on the implications of
geo-referencing on missingness. In particular the eﬀect of geo-referencing on
dropout will be discussed. Usually a geographical delimitation of a study area
is made in the design of a trial. During the course of a trial it is possible for
participants to move their residence. This is more likely to occur when longer
term studies, such as behavioral intervention trials are considered. These tri-
als can last up to 2–3 years. Ultimately, the mobility of participants could
lead to a move outside the study area. If there is a geographical limit on the
study in terms of recruitment then those who remove from the study area
would be regarded as dropout. With intention-to-treat approaches to trials
(Lachin, 2000) it may be important to use all data for those entered into the
trial and so it may be important to consider this geographical dropout. De-
note the outcome for the i th participant at time j as yij. Consider residential
history deﬁned as si(t) where t is continuous and s denotes a spatial loca-
tion (residence address). A study lasts for j = 1, ..., J time points. Outcome
measurements are made at the J time points. Often the residential history
will be discretized into the study time periods so that sij may be censored
between time points. Besides location shifts, it would be useful to deﬁne a
dropout indicator R whereby rij denotes presence (1) or absence (0) at the j
measurement. While rij could be 0 for a range of reasons one such could be
related to sij. Hence it might be important to consider (yij, rij, sij) jointly in
modeling a given outcome. This area appears to have been little explored.

Spatial Survival and Longitudinal Analysis
243
10.4
Extensions to Repeated Events
There are many other application areas where spatial context can be fruitfully
introduced or allowed for. One such area that is closely related to longitudinal
analysis is the analysis of repeated events. This is sometimes called repeated
event analysis or event history analysis. For a recent review see, for example,
Cook and Lawless (2007). This is an extension of longitudinal and survival
analysis where instead of making one measurement at diﬀerent times or ob-
serving a single time-to-endpoint, the time period is ﬁxed and within that
period a sequence of events are observed on an individual. In the simplest
case, the sequence could consist of just a single type of event and its repeated
occurrence is observed. Hence for a single person this is a point process in
time, assuming the event does not have ﬁnite duration. An example of a sim-
ple sequence would be a sequence of doctor’s visits where the time of visit
is recorded. If we are only concerned about the times of the visits (and not
their nature or duration) then this can be considered to be point process at
the unit (patient) level.
At this point it is worth noting that there is an immediate connection
between the linear or generalized linear modeling approach of longitudinal
analysis and the time-based analysis for survival data. With repeated events,
time is important but when ﬁxed time periods are used and observations are
collected within these time periods then the resulting counts of events can be
considered within the framework of the conventional hierarchical model. For
example for simple doctor visits the count of visits in time periods might be
treated at the ﬁrst level of hierarchy as a Poisson random variable whereas if
the times are recorded directly then a (heterogeneous) Poisson process model
might be appropriate. This, of course, mirrors the duality of the point process
and count model when binning of events takes place in a spatial context.
10.4.1
Simple Repeated Events
Assume ﬁrst that a patient resides at an address and makes repeated doctor
visits. Denote the address as si and the sequence of visits as {ti,1, ...., ti,ni}
where t denotes visit time within a study period (t0, tT ) and ni is the number
of visits. If some basic assumptions are made concerning conditional indepen-
dence (given knowledge of all confounding and event history) independence
of the events might be a reasonable starting model. If a modulated (het-
erogeneous) Poisson process (PP) were assumed for the event times then a
conditional PP likelihood could be assumed whereby the ﬁrst order intensity
for the i th individual could be deﬁned as
λi(t) = λi0(t) exp(x′
iβ + gi(t)).

244
Bayesian Disease Mapping
Note that here the covariates are included via the ﬁxed vector x′
i and the gi(t)
function could be a smooth function of time. The baseline function λi0(t) is
also unit speciﬁc. The associated unconditional likelihood is given by
m

i=1
ni

j=1
λi(tij) exp{Λi}
(10.10)
where Λi =
tT
t0
λi(u)du.
(10.11)
For ﬁxed covariates, then Λi = exp(x′
iβ)
tT
t0
λi0(u) exp(gi(u))du. Various meth-
ods can be used to include time-varying eﬀects. Discretizing to allow piecewise
linear terms in the baseline and gi(t) are possible, while semiparametric mod-
els could also be assumed. Of course gamma or Dirichlet processes could also
be used (Ibrahaim et al., 2000). Cook and Lawless (2007, Ch. 3), discuss
various possibilities for Poisson process models.
10.4.2
More Complex Repeated Events
Two generalizations are immediate from the simple event case. First, multiple
types of events could occur. Second, a feature associated with the event could
be important and could vary with time or type of event. An example of the ﬁrst
situation could easily arise with the progression of a disease. Visits to doctors
could be interspersed with hospital visits, or nurse visits. In fact, complex
patterns of repeated events are more usual when making observational studies
on disease progression, than in clinical settings. The observed data could then
be of the form {ts
i,1, ...., ts
i,ni} where s denotes the event type. For a ﬁxed
number of event types (L) then s could be deﬁned as s = 1, ..., L. The second
situation arises when the event has attached a mark. For instance, a severity
score or biomarker might be measured at a given visit. Alternatively the visit
itself could have a duration. In the ﬁrst case, the mark or measurement could
be jointly modeled with the event time and the correlation between the mark
and time could be directly modeled. In this case the observed data for the
i th individual would be {ti,1, xi,1...., ti,ni, xi,ni}, where x is the mark value.
When duration is associated with event time, there can be a complication, as
this type of mark directly aﬀects the subsequent event times (as duration is
time-based). In this case the observed data would be {ti,1, di,1...., ti,ni, di,ni}
where d is the event duration. This might be appropriate where hospital visits
involve stays of diﬀerent lengths.
Ultimately we might have a mixture of these situations where multi-type
events also have marks or durations and so, for the mark case, we would
observe {ts
i,1, xi,1...., ts
i,ni, xi,ni}.

Spatial Survival and Longitudinal Analysis
245
Modeling approaches for these diﬀerent situations depends on the observed
data and also the study purpose. For example, if known times are observed it
is often convenient to conditionally model the marks given the times so that
we have the joint model
[x, t] = [x|t][t].
(10.12)
In this case, we consider the times to be governed by point process model.
In addition, the model for the marks could be a simple Gaussian distribu-
tion: [x|t]˜N(μ(t), τ). Here dependence on time could be made explicit in the
mean parameterization (μ(t)). This mean function could be speciﬁed to in-
clude covariates (individual or contextual) as well as time dependence: e.g.,
μ(t) = x′β +γ(t). Note that the point process model could also have covariate
dependence and so it is debatable whether there should be multiple entry of
the same covariate in each model. For example, patient age could aﬀect both
the mark (e.g., blood pressure) and doctor visit times.
On the other hand, if we do not observe directly the visit time but simply
the number of visits within a ﬁxed time period, then usually the mark would
not be any longer associated directly with the individual (as the information
has been averaged). Either the mark would be based on the time period, or
is an average mark for all events within the period. As the exact times have
been lost the resulting data would consist of counts of visits and an average
mark or the value of (say) a contextual variable pertaining to the time period.
In this case the observed data would be yij where there are j = 1, ..., J time
periods. We might be interested in the joint distribution [x, y] = [x|y][y]. In
eﬀect, the model for the mark is conditioned on the count and a separate
count model is speciﬁed. If the focus were on the counts per se then the
alternative formulation of [x, y] = [y|x][x] could be considered and often the
visit frequency is modeled conditionally, i.e., via [y|x] treating the mark as a
covariate.
These formulations do not include any explicit spatial dependence. In the
next section some proposals for how this dependence could be incorporated
are proposed. As in Sections 10.2 and 10.3 the spatial eﬀects can be regarded
as contextual.
10.4.2.1
Known times
10.4.2.1.1
Single events
As a ﬁrst pass we could assume that the times
follow a heterogeneous Poisson process (hPP) so that
f(t) = λ(t) exp(−
 tT
t0
λ(u)du

246
Bayesian Disease Mapping
and conditional on ni, then the likelihood element for the i th individual
would be
m

i=1
ni

j=1
λi(tij) exp{−Λi},
(10.13)
where Λi =
tT
t0
λi(u)du.
and λi(t) = λi0(t) exp(x′
iβ + gi(t)). Note that it is possible to include within
a Bayesian hierarchy the spatial eﬀect, especially if it is not time-dependent.
For example, a contextual eﬀect at the individual level could be included
as Λi = exp(x′
iβ+wi)
tT
t0
λi0(u) exp(gi(u))du where wi = w( cj
i∈j
) as deﬁned
in Section 10.2.3. More generally, the spatial location of the individual (si)
could be incorporated in the PP model and a space-time formulation could
be considered directly:
λi(s, t) = λi0(s, t) exp(x′
iβ + gi(t) + hi(s))
and the resulting likelihood would be
m

i=1
ni

j=1
λi(si, tij) exp{−Λi}
where Λi =
tT
t0

W
λi(v, u)dvdu
and W is the study region area. In addition, variants of the speciﬁcation
could allow for nonparametric speciﬁcation of the gi(t), hi(s) functions with a
simple alternative being piecewise discretization in time and space. For space
it may be possible to deﬁne a common surface, h(s) say, and to form piecewise
constant components from a tiling of the distribution of individuals. However
if the spatial component is zero-centered then further approximations may
be available (see e.g., Chapter 7). Of course integral approximations such as
proposed by Berman and Turner (1992), could also be considered.
10.4.2.1.2
Multiple event types
Alternatively, simpler intensity based
methods can be pursued. Denote the intensity of the i th individual and j th
type as λij(t|Hi(t)), where Hi(t) is the event history. A diﬀerent period of
observation is allowed for each individual: [0, τi]. Denote the history of the
i th subject as Hi(t) = {Ni(s), 0 < s < t} where Nij(t) is the number of
event of j th type occurring on the i th individual in the interval [0, t] and

Spatial Survival and Longitudinal Analysis
247
Ni(t) = {Ni1(t), ...., NiJ(t)}′. Hence the history of the process concerns the
preceding count accumulation. The resulting likelihood is given for the times
tijk , k = 1, .., Nij(t) so that
J

j=1
⎧
⎨
⎩
nij

k=1
λij(tijk|Hi(tijk)) exp(−
τ i

0
λij(u|Hi(u))du)
⎫
⎬
⎭.
(10.14)
This of course assumes that the distribution of events are functionally in-
dependent. In many situations this would of course not be reasonable. For
example, a doctor’s visit might precipitate a hospital visit. When multiple
events can arise with dependence over time then it is often useful to consider
transition models for the occurrence of events of diﬀerent types. These types
of models specify the probability that an event of a given type will occur in an
interval of time given the preceding event. Hence, they are naturally speciﬁed
conditioning on the preceding event, its type and time, or type of preced-
ing events and their times. Alternatively a competing risk approach could be
envisaged. I do not consider these further here.
Incorporation of random eﬀects can be eﬀected via redeﬁnition of (10.14):
λij(tijk|Hi(tijk), Rij) = λij(tijk|Hi(tijk), exp{Wij}) where Wij would repre-
sent the individual random eﬀect for the j th event type. This could be de-
composed into a number of individual speciﬁc or contextual random eﬀects.
For example, it would be possible to consider a set of L counties labeled cl,
l = 1, ..., L. Then we could consider as a ﬁrst example, the hierarchical random
eﬀect model: Wij = (uij + vi + wi) where wi = w( cl
i∈l) and vi = v( cl
i∈l) and
these are spatial contextual eﬀects and uij = u1i + u2j where u1i is a general
individual frailty and u2j is a type speciﬁc eﬀect. The prior distributions for
the eﬀects could be overdispersed zero-mean Gaussian for u1i, u2j, vi while
for wi a CAR formulation would be possible. A variety of other formulations
would be possible of course. As before it would be possible to consider the
intensity as a function of both time and space and hence to include a speciﬁc
spatial component in its deﬁnition. However it is probably simpler and more
convenient to consider conditioning on the spatial component deﬁned at a
higher level of the hierarchy via a random eﬀect.
10.4.3
Fixed Time Periods
When ﬁxed time periods are observed, it is usual to collect events within the
time periods into counts of events. Of course when this is done information
about the time sequence of events is lost within the time period. Hence even
if the residential location of individuals is known and hence known at a ﬁne
spatial resolution level, the resolution level in time is aggregated. In general,
we denote the count within the j th time period as yijl, where i denotes the
individual and j = 1, ..., J denotes the time periods, and l denotes the event
type (l = 1, ..., L).

248
Bayesian Disease Mapping
10.4.3.1
Single events
In the case of a single outcome then we observe {yij} for a sequence of J times
and i = 1, ..., m. The simplest modeling approach is to assume a generalized
linear model for the counts with some form of time dependence. For example
it could be assumed that yij ∼Pois(μij) and a log linear model could be
assumed for the mean:
log μij = x′
iβ + vi + γj
(10.15)
where x′
i is a vector of individual ﬁxed covariates and β is the corresponding
parameter vector, and vi is an individual frailty and γj is a common temporal
eﬀect. The temporal eﬀect could have a variety of speciﬁcations :
1. An uncorrelated prior distribution (for example, γj ∼N(0, τγ))
2. A correlated prior distribution (for example, a random walk: γ1 ∼
N(0, τγ), γj ∼N(γj−1, τ γ) j > 1)
3. Trend regression on time γj = βtj (or a higher order polynomial) where
tj is the time of the j th period (start or end or middle by convention)
If the focus is on a parsimonious description of the overall behavior then
option 2 may be favored as it is relatively non-parametric. However if a spe-
ciﬁc linear or polynomial estimate of trend is required, then option 3 may be
preferred. The individual frailty would usually be assumed to have an uncor-
related zero-mean Gaussian distribution:
vi ∼N(0, τv).
Incorporation of spatial contextual eﬀects can follows as before by extending
the model in (10.15) to include an individual contextual component:
log(μij) = x′
iβ + vi + wi + γj
(10.16)
where wi = w( cl
i∈l
) and w(cl)|w(c−l) ∼N(w(cδl), τ w/nδl) where w(cl) is the
value of w for the l th county and w(cδl) is the average value of w for the
neighborhood (δl) of cl. The number of counties in this neighborhood is given
by nδl. Note that vi is an individual frailty eﬀect here. An alternative speciﬁca-
tion could also assume an uncorrelated county eﬀect, as for wi except without
correlation. Steele et al. (2004) describe essentially the model in (10.15) albeit
with multiple events.
10.4.3.2
Multiple event types
In the case of multiple event types assume a count of the form yijl where l
denotes the event type. Steele et al. (2004) describe a competing risk model
where a multinomial form is assumed for the vector of events within a time

Spatial Survival and Longitudinal Analysis
249
period. The multinomial probability ratio (relative to the zero event case)
was assumed to be deﬁned by a logit link to a linear predictor with covari-
ate random eﬀect and trend components similar to (10.16) but without the
spatial dependence. In general, one approach to these problems assumes that
conditionally on Nij = 
l yijl,
yij ∼Mult(pij, Nij).
If it is important to consider the relative preference for visit types then this
might be useful. Otherwise without conditioning it would be possible to con-
sider
yijl ∼Pois(μijl).
A log linear link could be assumed whereby
log(μijl) = x′
iβ+vi + wi + uil + γjl
(10.17)
where vi, wi are contextual eﬀects, as before, uil is an individual level eﬀect
speciﬁc to the event type and γjl is a temporal eﬀect speciﬁc to the event
type. As before the contextual random eﬀects can be deﬁned to depend on
small area level geographies, while the temporal eﬀects could be regression
based or random walk based. In the multinomial model of Steele et al. (2004)
the temporal component γjl was assumed to be deﬁned by a quadratic re-
gression in time and the individual random eﬀect uil was assumed to have a
multivariate normal distribution (between event types only).
10.4.3.2.1
Asthma-comorbidity Medicaid example
Sutton (2005)
provides an example of the analysis of individual level outcomes with ﬁxed
time periods in a Bayesian setting. This work was based on Medicaid data on
asthma (ICD-9 493) and CHF (ICD-9 428, 402, 518.4), comorbidities for re-
cipients between age 50–64 in South Carolina for the period 1997–1999. Three
groups were identiﬁed: asthma only, CHF only, and asthma and CHF. Of the
1857 individuals, 223 were in the comorbidity group. Recorded for each recip-
ient were number of days between multiple dates of medical service; type of
visit (inpatient, ER, outpatient, doctor’s oﬃce), and recipients demographic
information (age at ﬁrst visit, gender, race, county of residence). As a brief
guide, Figure 10.6 displays the event proﬁles summarized by time to second
visit, for the asthma and CHF individuals separately.
An analysis was performed with the SC Medicaid data mentioned above
where asthma and CHD were analyzed together. Here I only display the co-
morbidity group analysis. The analysis was carried out for 21 time periods (of
50 days each).
A model of the form
yijl ∼Poiss(μijl)
log(μijl) = x′
iβ + vi + wi + γjl

250
Bayesian Disease Mapping
FIGURE 10.6
Distribution of number of days between ﬁrst and second visit for recipients
with: top panel: asthma, bottom panel: CHF.

Spatial Survival and Longitudinal Analysis
251
was ﬁtted to the data for the comorbidity group. Individual frailty was not
required in this example, based on a variable selection criterion. Here the
ﬁxed covariates were β0 (common intercept), β1(age), factors for race and
gender, and two spatial contextual eﬀects at county level: vi = v( cl
i∈l
) with
vi ∼N(0, τv) and wi = w( cl
i∈l
) and w(cl)|w(c−l) ∼N(w(cδl), τ w/nδl) where
w(cl) is the value of w for the l th county and w(cδl) is the average value of w
for the neighborhood (δl) of cl. All regression parameters had over-dispersed
zero-mean Gaussian prior distributions while variances were assumed to have
Ga(0.05, 0.0005) distributions. The temporal eﬀects for each type were as-
sumed to have independent random walk prior distributions
γjl ∼N(γj−1,l, τ γ) ∀l.
The converged model ﬁt yields the following results:
1. The posterior expected estimates (sds) of β0, β1 respectively were -4.6
(0.9982) and -0.008553 (0.01118).
2. The posterior expected estimates (sds) of the race and gender eﬀects
were not signiﬁcant for gender but showed a signiﬁcance for the white
versus african-american racial groups
3. The temporal eﬀects were estimated and are shown in Figure 10.7. The
sequence of visit types are l = 1, l = 2, l = 3, l = 4—inpatient, ER,
outpatient, doctor’s oﬃce.
Finally the posterior average maps of the county speciﬁc random contextual
eﬀects are shown in Figure 10.8. It is clear that there is some spatial eﬀect
(w map) displayed in the NE of the state within largely rural areas, whereas
the UH eﬀect (v map) seems to be largely random. It should be noted here
however that analysis of discrete time events lacks a considerable amount of
information due to the grouping within time periods and information about
sequencing is lost, hence there is an inevitable limitation to this form of anal-
ysis.

252
Bayesian Disease Mapping
FIGURE 10.7
Posterior average temporal proﬁles for the eﬀect γjl, for l = 1, .., 4. Mean
proﬁles and 95% credible interval shown. Top left l = 1, top right l = 2,
bottom left l = 3, bottom right l = 4.

Spatial Survival and Longitudinal Analysis
253
FIGURE 10.8
Posterior average maps of the county-level random eﬀects (wi, vi) form the
multiple event model for the Medicaid data.


11
Spatiotemporal Disease Mapping
As in other application areas, it is possible to consider the analysis of disease
maps which have an associated temporal dimension. The two most common
formats for observations are
(1) Geo-referenced case events which have associated a time of diagnosis or
registration or onset, i.e., we observe within a ﬁxed time period J and
ﬁxed spatial window W, m cases at locations {si, ti}, i = 1, . . . , m;
(2) Counts of cases of disease within tracts are available for a sequence of
J time periods, i.e., we observe a binning of case events within m × J
space-time units: yij, i = 1, . . . , m, j = 1, . . . , J.
The analysis found for spatial data (see Chapters 5 and 6) can be ex-
tended into the time domain without signiﬁcant diﬃculty.
11.1
Case Event Data
In the case event situation, few examples exist of mapping analysis. However,
it is possible to specify a model to describe the ﬁrst-order intensity of the
space-time process (as in the spatial case). The intensity at time t can be
speciﬁed as:
λ(s, t) = ρg(s, t).f1(s; θx).f2(t; θt).f3(s, t; θxt),
(11.1)
where ρ is a constant background rate (in space × time units), g(s, t) is a
modulation function describing the spatiotemporal ‘at-risk’ population back-
ground in the study region, fk are appropriately deﬁned functions of space,
time and space-time, and θx, θt, θxt are parameter vectors relating to the spa-
tial, temporal, and spatiotemporal components of the model.
Here each component of the fk can represent a full model for the component,
i.e., f1 can include spatial trend, covariate and covariance terms, and f2 can
contain similar terms for the temporal eﬀects, while f3 can contain interaction
terms between the components in space and time. Note that this ﬁnal term
can include separate spatial structures relating to interactions which are not
included in f1 or f2. The exact speciﬁcation of each of these components will
255

256
Bayesian Disease Mapping
depend on the application, but the separation of these three components is
helpful in the formulation of components.
The above intensity speciﬁcation can be used as a basis for the development
of Bayesian models for case events. If it can be assumed that the events form
a modulated Poisson process in space-time, then a likelihood can be speciﬁed,
as in the spatial case. For example, a parsimonious model could be proposed
where a regression component and a random eﬀect component are assumed:
λ(s, t) = ρg(s, t) exp{P(s, t)
′β + T (s, t)}
(11.2)
where P(s, t) is a covariate vector, β a regression parameter vector, and T (s, t)
is a random component representing extra variation in risk. The term T (s, t)
could be decomposed in a number of ways. For example, it could represent a
spatiotemporal Gaussian process (Brix and Diggle, 2001). However, a simpler
approach might be to consider: T (s, t) = a(s)+b(t)+c(s, t) where a discretized
version of the random ﬁelds could be envisaged so that any realization of the
ﬁeld {si, ti} has separable correlation structure and
a(s) ∼MV N(0, Ka(τ x, φ)),
b(t) ∼N(f(Δt), τ b),
and c(s, t) ∼N(0,τcI),
(11.3)
where Ka(τ x, φ) is a parameterized spatial covariance matrix and I is an
identity matrix, with variances τ b, and τ c, and Δt is a distance measures in
space and time. In this approach the likelihood remains that of a conditionally
modulated Poisson process.
This type of model can be included within a likelihood speciﬁcation and a
full Bayesian analysis can proceed using extensions to the analysis for purely
spatial data. In these extensions either the integrated intensity of the process
Λ(θ) =

W
J
0
λ(u, v)dvdu
where θ = (β,τ x, φ, τ b, τ c) is the parameter vector, must be estimated or the
background is concentrated out of the model by conditioning. In Lawson
(2006b), an example of application of this model to a well known space-time
case event dataset was given (Burkitt’s Lymphoma in the Western Nile district
of Uganda for the period 1960–1975). In that dataset the location of cases and
a diagnosis date (days from January 1st 1960) are known as well as the age
of the case. There is no background population information in this example.
While it might be possible to consider an approach where a population eﬀect
in g(s, t) were estimated from the case event data, this is particularly assump-
tion dependent and this was not pursued. The following analysis essentially
assumes that the population is homogeneously distributed over space. This is
of course a strong assumption.

Spatiotemporal Disease Mapping
257
The estimation of the Λ(θ) was adopted in this case. The intensity was
integrated over space-time using Dirichlet tile approximations (Berman and
Turner, 1992). The model details were as follows. The basic form of the model
assumed was
λ(si, ti) = exp{β0}. exp{a(si) + b(ti) + c(si, ti)},
where the prior distributions are deﬁned as in (11.3) for the main com-
ponents (a(si), b(ti), c(si, ti)). A zero-mean spatial Gaussian process was
assumed for the spatial component with exponential covariance function
τ x exp(−φd), where d is the distance between any two locations and with
variance τ x and covariance range φ.The temporal component is deﬁned by
b(ti) ∼N(atb(ti−1), τ b) where at could take a variety of forms. This parame-
ter could be constant or could be dependent on time diﬀerences, for example,
at = 1/Δti where Δti = ti −ti−1. The space-time component is a residual
eﬀect, namely c(si, ti) ∼N(0, τ c). The parameter prior distributions were
assumed to be
exp{β0} ∼N(0, 0.001−1)
τ x ∼Ga(0.1, 0.1)
φ ∼U(0, 2)
τ b ∼Ga(0.1, 0.1)
τ c ∼Ga(0.1, 0.1).
For the converged sample (after 20,000 iterations based on two dispersed
chains), the posterior estimate of
φ was 0.0024 (sd: 0.0025 ) while that of
exp{β0}, τ x, τb, τ c were 11.77 (sd: 0.164), 8.481 (sd: 6.789), 22.68 (sd: 8.916),
and 7.064 (sd: 5.087), respectively. All these parameters had positive lower
and upper 95% credible limits. The Figure 11.1 suggests that there is a peak
in the spatial component in the north and temporal variations with marked
changes in the west of the area. However, the parameter estimates suggest
that the overall rate and space-time component are well estimated but the
spatial and temporal eﬀects are not important in this example. Alternative
formulations don’t yield results of any great diﬀerence from this model. For
example, a model including a covariate (age) was examined but the parameter
for this covariate was found to have a credible interval crossing zero and so
we have not reported this model here.
11.2
Count Data
Note that the above case event intensity speciﬁcation can be applied in the
space-time case where small-area counts are observed within ﬁxed time periods

258
Bayesian Disease Mapping
FIGURE 11.1
Burkitt’s lymphoma: two displays of the components of a Bayesian model with
a spatial Gaussian random ﬁeld component, a temporal correlation compo-
nent, and an uncorrelated space–time component. The spatial and temporal
components are displayed here.
{lj}, j = 1, . . . , J, by noting that
E{yij} =

lj

ai
λ(u, v) du dv,
where yij is the count in the i −j th unit, under the usual assumption of
Poisson process regionalization. In addition, the counts are independent con-
ditional on the intensity given, and this expectation can be used within a
likelihood modeling framework or within Bayesian model extensions. In pre-
vious published work in this area, cited above, the expected count is assumed
to have constant risk within a given small-area/time unit, which is an approxi-
mation to the continuous intensity deﬁned for the underlying case events. The
appropriateness of such an approximation should be considered in any given

Spatiotemporal Disease Mapping
259
application (see also Chapter 5). If such an approximation is valid, then it
is straightforward to derive the minimal and maximal relative risk estimates
under the Poisson likelihood model assuming E{yij} = λij = eijθij, where
eij is the expected rate in the required region/period. The maximal model
estimate is θij = yij/eij, the space-time equivalent of the SMR, while the
minimal model estimate is
θ =

i

j
yij

i

j
eij
.
Smooth space-time maps, e.g., empirical Bayes or full Bayes relative risk esti-
mates, will usually lie between these two extremes. If the full integral intensity
is used, then these estimates have the sums in their denominators replaced by
integrals over space-time units.
Development of count data modeling based on tract/period data has seen
considerable development. In the context of a typical Poisson likelihood model
where yij ∼Pois(eijθij), then the log relative risk (log(θij)) is usually the
focus of modeling. The ﬁrst example of such modeling was by Bernardinelli
et al. (1995). In their approach, they assumed a model for the log relative risk
of the form
log(θij) = μ + φi + βtj + δitj,
(11.4)
where μ is an intercept (overall rate), φi is an area (tract) random eﬀect, βtj
is a linear trend term in time tj, δi an interaction random eﬀect between area
and time. Suitable prior distributions were assumed for the parameters in this
model and posterior sampling of the relevant parameters was performed via
Gibbs Sampling. Note in this formulation there is no spatial trend, only a
simple linear time trend and no temporal random eﬀect. The model in (11.4)
above consists of spatial, temporal, and interaction terms. These could be
extended in a number of ways. In general, we could consider three groups of
components for log(θij): log(θij) = μ0 + Ai + Bj + Cij where Ai is the spatial
group, Bj is the temporal group, and Cij is the space-time interaction group.
In (11.4) above, Ai = φi, Bj = βtj, and Cij = δitj.
Waller et al. (1997) and Xia and Carlin (1998) (see also Carlin and Louis,
2000) subsequently proposed a diﬀerent model where the log relative risk is
parameterized as
log(θijkl) = φ(j)
i
+ δ(j)
i
+ ﬁxed covariate terms (kl),
where φ(j)
i
and δ(j)
i
are uncorrelated and correlated heterogeneity terms which
can vary in time. This model was further developed and simpliﬁed by Xia and
Carlin (1998), who also examined a smoking covariate which has associated
sampling error and spatial correlation. Their model was deﬁned as
log(θijkl) = μ + ζtj + φij + ρpi + ﬁxed covariate terms (kl),

260
Bayesian Disease Mapping
where an intercept term μ is included with a spatial random eﬀect nested
within time {φij},
a linear time trend ζtj, and pi is a smoking variable
measured within the tract unit. In these model formulations no spatial trend
is admitted and all time-based random eﬀects are assumed to be subsumed
within the φij terms. In this formulation, Ai = ρpi, Bj = ζtj, and Cij = φij,
and other covariate eﬀects.
To allow for the possibility of time-dependent eﬀects in the covariates in-
cluded (race and age), Knorr-Held and Besag (1998) formulated a diﬀerent
model for the same data set (88 county Ohio lung cancer mortality, 1968–
1988). Employing a binomial likelihood for the number at risk {nijkl} with
probability πijkl, for the counts, and using a logit link to the linear predictor,
they proposed
ηijkl = ln{πijkl/(1 −πijkl)},
where
ηijkl = αj + βkj + γlj + δzi + θi + φi.
(11.5)
The terms deﬁned are αj, a time-based random intercept; βkj, a k th age
group eﬀect at time j; γlj, a gender × race eﬀect for combination l at the
jth time; a ﬁxed covariate eﬀect term δzi, where the zi is an urbanization
index; and θi, φi are correlated and uncorrelated heterogeneity terms which
are not time-dependent. No time trend or spatial trend terms are used, and
these eﬀects will (partly) be subsumed within the heterogeneity terms and the
αj +βkj +γlj terms. In this formulation, Ai = δzi+θi+φi, Bj = αj +γlj +βkj,
including the covariate-time interactions and Cij = 0.
More recent examples of spatiotemporal modeling include extensions of mix-
ture models (Boehning et al., 2000), which examine time periods separately
without interaction, and the use of a variant of a full multivariate normal
spatial prior distribution for the spatial random eﬀects (Sun et al., 2000), and
the extension of the Knorr–Held and Besag model to include diﬀerent forms
of random interaction terms (Knorr-Held, 2000). Although the more complex
interaction terms proposed in the latter work did not ﬁt the data example
well, the simpler formulations seem to provide a parsimonious representation
of space-time behavior in risk. For example, a log relative risk can be deﬁned
purely in terms of random eﬀects via:
log θij = β0 + ui + vi + τ j + ψij
where the correlated and uncorrelated spatial components (CH, UH) are de-
ﬁned to be constant in time (ui, vi). In addition, there is a separate temporal
random eﬀect (τ j), and ﬁnally a space-time interaction term (ψij). In this case,
Ai = ui + vi, Bj = τ j, Cij = ψij. Often an autoregressive prior distribution
can be used for τ j: τ j ∼N(γτ j−1,κτ). This allows for a type of non-parametric
temporal eﬀect (random walk when γ = 1). The prior distribution for the in-
teraction term can be simply zero mean normal (i.e., ψij ∼N(0, τψ)), but
more complex prior distributions could be used. This model has also been

Spatiotemporal Disease Mapping
261
applied recently within a surveillance context (Lawson, 2004). Extensions to
non-separable space-time interaction can be made by diﬀerent prior distribu-
tion speciﬁcations for ψij. Denote ψ as the matrix of interaction terms {ψij}.
For example, Type II random walk interaction (Knorr-Held, 2000) is deﬁned
by the prior distribution
[ψ|τ ψ] ∝exp(−τ ψ
2
m

i=1
J

j=2
(ψij −ψi,j−1)2),
whereas Type III interaction consists of time-averaged spatial correlation
where
[ψ|τ ψ] ∝exp(−τ ψ
2
J

j=1

i∼l
(ψij −ψlj)2),
and ﬁnally Type IV interaction is fully space-time dependent and is deﬁned
as
[ψ|τ ψ] ∝exp(−τ ψ
2
J

j=2

i∼l
(ψij −ψlj −ψi,j−1 + ψl,j−1)2).
These diﬀerent prior distributions were ﬁtted by Knorr-Held (2000) to the
21 year Ohio respiratory cancer dataset (for white male counts only) but
he found that Type II interaction was favored with Type I also oﬀering a
lower deviance than Type III or IV. However given that the interaction term
could be regarded as a form of residual (made up of unobserved confounding
unaccounted for by the main eﬀects) and also the fact that identiﬁability of
highly structured interaction (as in Type III and IV) from main eﬀects may be
doubtful, there may be a need to consider less structured priors in applications.
While it is certainly true that in other spatial statistical applications non-
separable space-time interaction could be important in making a parsimonious
description of the variation (Gneiting et al., 2007), it may be the case that for
epidemiological data where expected rates and covariates are often available
that parsimonious description is possible without such assumptions.
In other developments for space-time count data, Zhu and Carlin (2000)
have examined the use of covariates at diﬀerent levels of aggregation within
misaligned spatial regions. Misalignment is discussed in Section 8.2. In addi-
tion, there has been development of both descriptive and mechanistic models
for space-time infectious disease modeling (Cressie and Mugglin, 2000; Knorr-
Held and Richardson, 2003).
Overall, there are a variety of forms which can be adopted for spatiotempo-
ral parametrization of the log relative risk, and it is not clear as yet which of
the models so far proposed will be most generally useful. Many of the above
examples exclude spatial and/or temporal trend modeling, although some ex-
amples absorb these eﬀects within more general random eﬀects. Allowing for
temporal trend via random walk intercept prior distributions provides a rel-
atively non-parametric approach to temporal shifting, while it is clear that

262
Bayesian Disease Mapping
covariate interactions with time should also be incorporated. Interactions be-
tween purely spatial and temporal components of the models have not been
examined to any extent, and this may provide a fruitful avenue for further de-
velopments. If the goal of the analysis of spatiotemporal disease variation is to
provide a parsimonious description of the relative risk variation, then it would
seem to be reasonable to include spatial and temporal trend components in
any analysis (besides those deﬁned via random eﬀects).
Finally, it is relevant to note that there are many possible variants of the
two basic data formats which may arise, partly due to mixtures of spatial
aggregation levels, but also to changes in the temporal measurement units.
For example, it may be possible that the spatial distribution of case event data
is only available within ﬁxed time periods, and so a hybrid form of analysis
may be required where the evolution of case event maps is to be modeled.
Equally, it may be the case that repeated measurements are made on case
events over time so that attached to each case location is a covariate (possibly
time-dependent) which is available over diﬀerent time periods.
11.2.1
Georgia Low Birth Weight Example
An example of the application of a variety of space-time models to very low
birth weight count data for the counties of Georgia for the years 1994–2004
are available. In this example the observed data is the count of births with
very low birth weight (<1500 grams) in counties of Georgia, United States for
each year during 1994–2004. The total birth count for the same period and
county is also available. These data are publicly available from the Georgia
Department of Health OASIS Web site (http://oasis.state.ga.us/). Figure 11.2
displays the crude rate ratios for this example. It is clear that some areas in
rural Georgia have particularly high crude rates (>>0.0175).
In an analysis of very low birth weight, it may be important to provide
a parsimonious description of the relative risk variation in space and time,
and also to examine the data for possible risk anomalies. To this end I have
examined a set of seven models that a priori may provide a parsimonious
model. The choice is from a range of those discussed above and the mod-
els have been chosen to represent the diﬀerent modeling approaches and also
demonstrate features of the modeling process. This is in no way a compre-
hensive model ﬁtting exercise, and alternative models could be hypothesized.
The basic likelihood is assumed to be yij ∼bin(pij, nij) and the logit of the
probability of very low birth weight is directly modeled. The overall crude
rate ratio (  yij/   nij) for the counties of Georgia for this 11-year pe-
riod is 0.0175. The ﬁrst three models are simple separable models with no
ST interaction: a model with a random UH spatial and temporal term and
an autoregressive temporal eﬀect (gj) (Model 1); a model with no temporal

Spatiotemporal Disease Mapping
263
(42) < 0.01
(61) 0.01-0.02
(34) 0.02-0.03
(10) 0.03-0.04
(4) 0.04-0.05
(8) > = 0.05
N
(36) < 0.01
(73) 0.01-0.02
(29) 0.02-0.03
(15) 0.03-0.04
(2) 0.04-0.05
(4) > = 0.05
N
N
(44) < 0.01
(66) 0.01-0.02
(36) 0.02-0.03
(10) 0.03-0.04
(2) 0.04-0.05
(1) > = 0.05
N
(36) < 0.01
(76) 0.01-0.02
(31) 0.02-0.03
(10) 0.03-0.04
(1) 0.04-0.05
(5) > = 0.05
(32) < 0.01
(72) 0.01-0.02
(40) 0.02-0.03
(7) 0.03-0.04
(7) 0.04-0.05
(1) > = 0.05
N
N
(39) < 0.01
(65) 0.01-0.02
(48) 0.02-0.03
(5) 0.03-0.04
(0) 0.04-0.05
(2) > = 0.05
N
(34) < 0.01
(62) 0.01-0.02
(47) 0.02-0.03
(13) 0.03-0.04
(3) 0.04-0.05
(0) > = 0.05
N
(33) < 0.01
(68) 0.01-0.02
(39) 0.02-0.03
(12) 0.03-0.04
(1) 0.04-0.05
(6) > = 0.05
N
(39) < 0.01
(67) 0.01-0.02
(35) 0.02-0.03
(11) 0.03-0.04
(3) 0.04-0.05
(4) > = 0.05
N
(31) < 0.01
(71) 0.01-0.02
(41) 0.02-0.03
(9) 0.03-0.04
(3) 0.04-0.05
(4) > = 0.05
N
(28) < 0.01
(66) 0.01-0.02
(42) 0.02-0.03
(13) 0.03-0.04
(6) 0.04-0.05
(4) > = 0.05
FIGURE 11.2
Georgia county level crude rate ratios for very low birth weight in relation to births 1994–2004: row-wise from 1994 to 2004.

264
Bayesian Disease Mapping
dependence (Model 2); and a model with only temporal trend and spatial UH.
1) log it(pij) = α0 + a1j + vi + gj
with α0 ∼N(0, 0.0001), vi ∼N(0, τ v)
a1j ∼N(0, τa1)
gj ∼N(gj−1, τg)
2) log it(pij) = α0 + a1j + vi
with a1j ∼N(0, τa1), vi ∼N(0, τv)
3) log it(pij) = α0 + a1tj + vi
with vi ∼N(0, τv), a1 ∼N(0, τa1)
Table 11.1 displays the DIC results for Models 1–7. It is clear that model
1–3, while parsimonious, is far from the best model. The product interaction
Models (4,5) are more parsimonious, and the lowest among these is the original
Bernardinelli et al model with an added spatial UH component (Model 5). It
is also clear, however, that amongst the models ﬁtted, the models proposed by
Knorr-Held yield the lowest DIC model. This is Model 6 which is the model
with Type I ST interaction and spatial CH and UH and temporal dependence.
This model is lower than the Type II interaction (Model 7), although it is less
parsimonious. Of course these results depend on prior speciﬁcations and in any
particular applications sensitivity to prior speciﬁcation should be examined.
For the model with lowest DIC, various posterior summaries are available.
Figure 11.3 displays the sequence of 11 years of exceedence probabilities for
the lowest DIC model ﬁtted to these data (Model 6). These probabilities were
estimated from  
Pr(pij > 0.0175) =
G

g=1
I(pg
ij > 0.0175)/G, where pg
ij is the
sampled value of pij from a posterior sample of size G. Given the caveats
mentioned in Chapter 6 concerning the use of exceedence probabilities with
inappropriate models, with the current ‘best’ model we would expect there
to be reasonable reliability and stability in these estimates. It is notable that
TABLE 11.1
Space–time models for the Georgia oral cancer
dataset; models are explained in text.
Model
D
pD
DIC
1
8162.8
168.67
8331.68
2
8162.2
168.25
8330.43
3
8161.5
159.13
8320.64
4
8122.12
127.02
8249.14
5
8112.63
128.08
8240.71
6
7966.9
252.33
8219.23
7
8072.8
162.57
8235.37

Spatiotemporal Disease Mapping
265
(125) < 0.9
(12) 0.9-0.95
(12) 0.95-0.99
(10) > = 0.99
(131) < 0.9
(6) 0.9-0.95
(13) 0.95-0.99
(9) > = 0.99
N
(131) < 0.9
(6) 0.9-0.95
(10) 0.95-0.99
(12) > = 0.99
(131) < 0.9
(9) 0.9-0.95
(10) 0.95-0.99
(9) > = 0.99
N
N
N
(126) < 0.9
(8) 0.9-0.95
(11) 0.95-0.99
(14) > = 0.99
(126) < 0.9
(10) 0.9-0.95
(10) 0.95-0.99
(13) > = 0.99
(125) < 0.9
(11) 0.9-0.95
(12) 0.95-0.99
(11) > = 0.99
(125) < 0.9
(10) 0.9-0.95
(12) 0.95-0.99
(12) > = 0.99
N
N
N
N
(124) < 0.9
(12) 0.9-0.95
(11) 0.95-0.99
(12) > = 0.99
(121) < 0.9
(10) 0.9-0.95
(13) 0.95-0.99
(15) > = 0.99
(116) < 0.9
(13) 0.9-0.95
(12) 0.95-0.99
(18) > = 0.99
N
N
N
FIGURE 11.3
Georgia county level exceedence probability from a ST interaction model with Type I interaction: Pr(pij > 0.0175) is
estimated as an average of posterior sample values of I(pij > 0.0175). Row-wise 1994 to 2004.

266
Bayesian Disease Mapping
most counties where high exceedences are found are rural counties (Dougherty,
Terrell, Marion, Baldwin, Handcock, Richmond, and Burke) although Rich-
mond county includes Augusta. Periodically the counties within Atlanta also
signal (DeKalb and Fulton). In general there appears to be a stable patterning
of the very low birth weight in that the spatial clusters seem to persist over
time, whereas space-time clusters appear periodically in Atlanta.
11.3
Alternative Models
As in the case of spatial disease modeling, there are a wide variety of model
variants available in the space–time extension. For example, semi-parametric
models may be favored and it is straightforward to extend the spatial spline
models discussed in 5.7.2, to the spatiotemporal situation. A recent example
of a form of ST semi-parametric modeling is found in Cai and Lawson (2008).
This is not pursued here.
11.3.1
Autologistic Models
Another important variant that was examined in the spatial case, in Chapter
5, was the autologistic model. For binary data this is an attractive likelihood
variant. In Chapter 5, the ability of this model to capture some of the spatial
correlation eﬀects was noted (see Section 5.7.1). Besag and Tantrum (2003)
proposed the use of autologistic models in a spatiotemporal setting. The use of
pseudolikelihood allows conditioning on the neighborhood counts which are
now time labeled. Deﬁne the binary outcome variable yij and assume that
yij ∼Bern(pij). A model for pij could be constructed as
exp(yij.Aij))
1 + exp(Aij)
where Aij is a function of the sum of neighboring areas and also a sum of
neighboring areas at previous times. For example, deﬁne the current sum
as Sδi,j =

l∈δi
ylj, the sum over the neighborhood at a previous time as
Sδi,j−1 =

l∈δi
yl,j−1. we can then consider a variety of models where space-
time dependence can be captured by diﬀerent forms of Sδi,j and Sδi,j−1.Table
11.2 displays the results of ﬁtting a range of autologistic models to the 21-year
Ohio respiratory cancer county level dataset. In Chapter 5, an analysis of one
year (1968) of this data was described. Here we examine the 21-year sequence
of data from 1968–1988. Once again, for the sake of exposition, we threshold

Spatiotemporal Disease Mapping
267
TABLE 11.2
Autologistic space–time models: models 1–4; convolution model
(Model 5)
Model
DIC
pD
MSPE
DIC (added vi, ψij)
MSPE
1
2488.49
42.78
0.4582
1833.71 (pD: 559.9)
0.2151
2
2386.66
61.5
0.4544
1765.17 (pD:548.6)
0.2266
3
2511.94
64.6
0.4534
1824.39 (pD: 565.5)
0.2107
4
2542.65
105.29
0.4407
2539.82 (pD: 129.3)
0.4348
5
1936.00
90.34
0.3344
-
-
the i −j th value at 2:
yij =

1 if smrij > 2
0 otherwise .
Then we consider yij ∼Bern(pij) with
pij = exp(yij.Aij))
1 + exp(Aij)
with Aij parameterized with a variety of covariates based on neighborhood
sums. We deﬁne two sets of neighbors. The simplest model is deﬁned to be a
function of the sum of ﬁrst order spatial neighbors, i.e., the neighbors deﬁned
as the adjacent small areas (in this case, I deﬁne adjacency as having a com-
mon boundary). I also examined an extended neighborhood (2nd order) where
counties adjacent to the neighbors (excluding those already in the 1 st order
neighborhood) are included. Hence the current sum of 1st order neighbors is
Sδ1i,j =

l∈δ1i
ylj, while the second order is Sδ2i,j =

l∈δ2i
ylj. the sums at previ-
ous times are Sδ1i,j−1 and Sδ2i,j−1. The main autologistic models considered
here are deﬁned for the predictor Aij:
1) Aij = α1j + α2jSδ1i,j
2) Aij = α1j + α2jSδ1i,j + α3jSδ1i,j−1
3) Aij = α1j + α2jSδ1i,j + α3jSδ2i,j
4) Aij = α1j + α2jSδ1i,j + α3jSδ1i,j−1 + α4jSδ2i,j + α5jSδ2i,j−1.
Note that the regression parameters can be allowed to vary with time: there
are no other random components in the model. For these models, α1j, α2j,
α3j, α4j, α5j have been assumed to vary with time but there is no prior
dependence, i.e., α∗j ∼N(0, τα∗) Here we also compare a conventional con-
volution model with components Aij = α0 + α1j + ui + vi + ψij and type I
interaction (Model 5) with α0 ∼U(−a, a) with a large, α1j ∼N(α1j−1, τ α1),
ui|u−i ∼N(uδ1i, τu/nδ1i), vi ∼N(0, τv), ψij ∼N(0, τψ).

268
Bayesian Disease Mapping
In this case, the random eﬀect convolution model with Type I interaction
appears to yield a relatively good model, based on DIC, compared to the
autologistic model using a ﬁrst order neighborhood and a single ﬁrst order
lagged neighborhood. To compare models with additional random eﬀects it is
reasonable to extend the autologistic models to include uncorrelated eﬀects (vi
and ψij where the same prior distributions are assumed as in the convolution
model). For the four autologistic models this was carried out, and the resulting
DICs are listed in the ﬁfth column of Table 11.2. It is clear that the DICs are
considerably lower than the convolution model for the ﬁrst three autologistic
models. While it is diﬃcult to generalize from one data example, this result
does suggest that autologistic models could be useful when modeling binary
space-time health data, especially when added random eﬀects are included.
The added random eﬀects included here are uncorrelated (vi, ψij Type I) and
so are relatively simple to implement. Note that other GOF measures can
be examined, such as MSPE (see Section 4.1) and these may be useful when
other features of the model are important such as predictive capabilities. The
MSPE for each model was also calculated and in Table 11.2 they are shown
in columns four and six. While the convolution model yields the lowest DIC
compared to simple autologistic models, the autologistic models with added
random eﬀects yield lower MSPEs and DICs for most models. However, the
models with lowest DIC is not the lowest MSPE model. In this case, Model 2,
with a lagged neighborhood eﬀect has lowest DIC, whereas Model 3 has the
lowest MSPE.
11.3.2
Latent Structure ST Models
In Chapter 5 some approaches to spatial latent structure modeling were ex-
amined. Space-time data often provides a greater latitude for the examination
of latent features, as inherently there is likely to be more possibility of com-
plexity when dealing with three dimensions instead of two. Again count data
is the focus although many of the proposals here could be applied
in the
case event situation. As in the spatial case, it is possible to extend the ﬁxed
convolution model to include a random mixture of eﬀects. For example, one
could propose a log-linear model where
log(θij) = α0 +
K

k=1
wijλjk
where K is ﬁxed and K
k=1 λjk = 1,

i
wij = 1 and wij > 0 ∀i, j, with α0
as overall intercept. In this formulation there is a weight for each space-time
unit, which is normalized as a probability over space for a given time, while
for identiﬁability a sum to unity constraint is placed on the temporal proﬁles.
The weights here could be regarded as loadings but are not assigned to a

Spatiotemporal Disease Mapping
269
particular component. The temporal proﬁles are labeled by component. An
extension to this idea could be made where the number of components are
allowed to be random and then the joint posterior distribution of (K, {λk})
would have to be sampled. This could be done via reversible jump McMC
(Green, 1995) or via variable selection approaches (Kuo and Mallick, 1998;
Dellaportas et al., 2002).
Alternative formulations are possible and two of these are mentioned here.
First it may be possible to use a principal component decomposition in this
context. Bishop (2006) discusses how a special prior speciﬁcation on the load-
ing matrix W in a Gaussian latent variable formulation leads to parsimonious
description. The columns of the loading matrix W span a linear subspace
within the data space that corresponds to the principal subspace. Of course
it might also be useful to consider time-dependence in the speciﬁcation of the
component model. Extending the proposal of Wang and Wall (2003) it would
be possible to consider a form such as
log θij = α0 + log(eij) + λjfi
where fi is the spatially-referenced risk factor, with 
i fi = 0 and λj is
the temporally referenced loading. Further it might be useful to consider an
autoregressive prior distribution for the loading vector so that
λj ∼N(λj−1, τ).
Further extension could be imagined.
An alternative to these approaches is to consider a mixture model extension
of the spatial mixture models of Section (5.7.5.1). In this case the log of the
relative risk is modeled via mixture product of separable components:
log θij = α0 +
K

k=1
wi,kχk,j.
Here both wi,k and χk,j are unobserved but each are separate functions of
space and time. Identiﬁcation is supported by the separation of the spatial
loading weights and temporal proﬁles, although further conditions can be
speciﬁed. There are K components, and constraints given by 
i wi,k = 1
∀k, 0 < wi,k < 1 ∀i, k. In disease mapping studies it is reasonable to assume
that underlying groupings of temporal risk proﬁles occur and these are region-
based. Hence, we could easily be interested in ﬁnding spatial groupings of risk
which are associated with speciﬁc temporal proﬁles.

270
Bayesian Disease Mapping
1999
2001
2003
2005
0
5
10
15
20
time
SIR
counties 1:80
1999
2001
2003
2005
0
5
10
15
20
time
SIR
counties 81:159
FIGURE 11.4
Georgia, United States, county level asthma ambulatory incidence for <1
year for the period of 1999–2006. Standardized incidence ratios with expected
rates computed from the total period area rate adjusted for county × year
population.
Suitable prior distributions depend on the application. Some prescriptions
are
wi,k = w∗
i,k/

l
w∗
l,k
(11.6)
w∗
i,k ∼lN(αi,k,τw), ∀i, k
α ∼MCAR(1, Λ)
χj ∼N(χj−1, Σ)
Σ = τ ′
χI0
where τ χ = {τ χ1, ..., τχK}, Λ ∼Wish(Φ, K), and ﬁxed Φ. In the following, I
have examined asthma ambulatory sensitive cases reported per year for <1
year age group in counties of Georgia over an 8-year period (1999–2006).
These data are publicly available from the state of Georgia Department of
Health OASIS online health data system. The expected rates were computed
from the overall rate (= total rate/total population <1year) times the local
population count <1 year. Figure 11.4 displays the SIR proﬁles for the 159
counties for the 8-year period. These incidence rates displayed considerable
diﬀerences in their temporal behavior. It is of interest to examine whether
there is any spatial clustering or aggregation in the temporal variation.
Figures 11.5 and 11.6 display the posterior averaged temporal proﬁles and
weight maps for a converged run of Model (11.6)(500,000 burn-in and 2000
sample size). It is quite notable that component 1 and 3 are quite well deﬁned
(and have decreasing and increasing trend, respectively) while component 2

Spatiotemporal Disease Mapping
271
FIGURE 11.5
Space-time latent component mixture model with four ﬁxed temporal compo-
nents: row-wise from top left posterior expected temporal component proﬁles
(χj,l): components l = 1, 2, 3, 4.
and 4 are negligible. This is borne out by the probability weightings for the
component 1 and 3 compared to 2 and 4.
Finally, it is worth noting that the Dirichlet process (DP) mentioned brieﬂy
in Section (5.7.5), can also be applied in space-time. Kottas et al. (2007)
present an approach to disease modeling in space-time using Dirichlet process
extensions.
11.4
Infectious Diseases
Often space-time health data concern infectious disease and its spread. This
is a special case where consideration of the spread and how to model that
eﬀect could be important. Purely descriptive models can be deﬁned of course
that seek to mimic the behavior of the spread and such have been proposed
by Mugglin et al. (2002) for ﬂu epidemics, and Knorr-Held and Richardson
(2003) for meningococcal disease.

272
Bayesian Disease Mapping
(63) < 0.2
N
(78) 0.2-0.4
(16) 0.4-0.6
(2) > = 0.6
N
(12) < 0.1
(30) 0.1- 0.2
(53) 0.2-0.3
(57) 0.3-0.4
(7) > = 0.4
N
(99) < 0.25
(45) 0.25-0.5
(13) 0.5-0.75
(2) > = 0.75
N
(13) < 0.1
(34) 0.1-0.2
(50) 0.2-0.3
(50) 0.3-0.4
(12) > = 0.4
FIGURE 11.6
Space-time latent component mixture model: posterior expected weight maps
for the four temporal components. Row-wise from top left component 1, 2,
3, 4.
11.4.1
Case Event Data
In general it is possible to model the space-time labeling of infectious disease
cases as in the non-infectious case. However, there are advantages to consid-
ering infectious disease case event modeling from a survival perspective.
11.4.1.1
Partial likelihood formulation in space–time
An alternative approach is to assume that the observed process has only a
time-dependent baseline i.e., λ0(s, t) ≡λ0(t). This may be reasonable where
the temporal progression of a disease is the main focus (such as in survival
analysis). The set of observed space and time coordinates {si, ti} are condi-
tioned upon, and a risk set (Ri) can be considered at any given time ti. In

Spatiotemporal Disease Mapping
273
the absence of censoring then Ri = { i, ..., n}. Then the probability that an
event at (si, ti) out of the current risk set is a case is just
Pi = λ(si, ti)/

k∈Ri
λ(sk, ti).
This is just an extension to the Cox proportional hazard model. Importantly
in this formulation, when λ0(s, t) ≡λ0(t) the background hazard cancels from
the model and the partial likelihood is given as
L =
n

i=1
[log λ(si, ti) −log

k∈Ri
λ(sk, ti)].
Hence, this form enables relatively simple modeling of space-time progres-
sion of events. Lawson and Zhou (2005) use this approach to modeling progres-
sion of a foot-and-mouth epidemic, while it has also been used for a measles
epidemic in a non-Bayesian context by Lawson and Leimich (2000) (see also
Neal and Roberts, 2004, for another measles modeling approach; and Diggle,
2005).
11.4.2
Count Data
Often a descriptive approach would be considered ﬁrst in the modeling of
infection spread. By descriptive I mean using model elements to mimic the
spread (without directly modeling the infection process). Mugglin et al. (2002)
suggested a descriptive approach to ﬂu space-time modeling in Scotland. In
their case they applied the model to weekly ER admissions for inﬂuenza in
Scottish local government districts for the period 1989–1990. The model pro-
posed for ER admission count yij in the ith district and jth time period was
of the form
yij ∼Poisson(eij exp(zij)
where eij is the number of cases expected under non-epidemic conditions, and
zij is the log relative risk. Here zij is modeled as
zij = d
′
iα + sij
where d
′
iα is a linear predictor including site dependent covariates, with d
′
i
the ith row of the n × p covariate design matrix and α a p-length parameter
vector, and sij is deﬁned by a vector autoregressive model (sj : (s1j, ...smj)
′)
sj = Hsj−1 + ϵj.
Here, H is an m × m autoregressive coeﬃcient matrix and ϵj is an epidemic
forcing term. Spatial structure appears in both H and ϵj. The form of the
epidemic curve is modeled by the Gaussian Markov random ﬁeld prior distri-
bution for ϵj :
ϵj ∼MV N(βρ(j)1, Σ)

274
Bayesian Disease Mapping
where β determines the type of behavior, ρ(j) indicates the stage of the dis-
ease, and Σ is a variance-covariance matrix. The model was completed with
prior distributions speciﬁed for all parameters within a Bayesian model hier-
archy. An alternative but somewhat simpler approach to descriptive modeling
has been proposed by Knorr-Held and Richardson (2003). In their example,
monthly counts of meningococcal disease cases in the departments of France
were examined for 1985–1997. The model assumes the same likelihood as
Mugglin et al. (2002) such that
yij ∼Poisson(eij exp(zij)).
At the second level they assume for the endemic disease process
zij = rj + sj + ui
where rj denotes temporal trend, sj denotes a seasonal eﬀect of period 12
months and a CAR prior distribution for u. They assume no space-time in-
teraction for the endemic disease. For the epidemic period an extra term is
included:
zij = rj + sj + ui + xijrT
ijβ
where xij is an unobserved temporal indicator (0/1) which is dependent in
time (but not in space) and rij is a p × 1 vector (a function of the vector of
observed number of cases in period j −1) and β is a p−dimensional parameter
vector. The authors propose six diﬀerent models to describe the epidemic
period depending on the speciﬁcation of rT
ijβ. Whether an epidemic period is
present completely depends on the value of xij. In this formulation the xij
are essentially unobserved binary time series, one for each small area. Unlike
the Mugglin et al. (2002) formulation, these have to be estimated.
Both these approaches seem to have been successful in describing the ret-
rospective epidemic data examined. It will be instructive to see whether these
diﬀerent approaches will be successful in the prospective surveillance of infec-
tious disease.
Mechanistic count models that address the infection mechanism have been
proposed for the temporal spread of measles (Morton and Finkenst¨adt, 2005).
These were based on susceptible-infected-removed (SIR) models where ac-
count is made of the numbers at each time point in each class. They also
account for underascertainment in their model. For daily measles case report-
ing in London, Morton and Finkenst¨adt (2005) deﬁned the true infective count
for period j as Ij and the reported count as yj linked by a binomial distribu-
tion to allow for underascertainment: yj ∼bin(ρ, Ij) where ρ is a reporting
probability. The susceptible population at the j + 1 th period is Sj+1 while
removal is Dj and additions Bj+1. In that model infectives and susceptibles
are modeled as
Ij+1 ∼f1(rjIα
j Sj, Kj+1)
Sj+1 ∼f2(Sj + Bj+1 −Ij+1 −vDj+1)

Spatiotemporal Disease Mapping
275
where Kj+1 is some underlying latent series of events, and f1 and f2 are suit-
able distributions. The distribution f1 is called the transmission distribution.
The term rj is a proportionality constant that modulates the interaction term
Iα
j Sj and can be regarded as an infection rate. The α term can also be es-
timated. For populations where the susceptible population is large compared
to the infectives at each time period then the eﬀect of Bj+1 −Ij+1 −vDj+1
may be small and so simpler models could be conceived where Sj+1 ∼f2(Sj).
Of course, for ﬁnite small populations this could be a bad approximation.
Extending this to the spatial situation within a Bayesian Hierarchical mod-
eling framework is straightforward (see Lawson, 2006b, Ch. 10). A space–time
infection model could be proposed where there are i = 1, ..., m small areas
and j = 1, .., J time periods. A simple form could be
yij ∼bin(ρ, Iij)
(11.7)
Iij ∼Pois(μij)
Sij+1 = Sij −Iij −Rij
Rij = βIij
where μij = SijIij−1 exp{β0 + bi}. The term exp{β0} describes the overall
rate of the infection process while a spatially correlated term bi is included
and it is assumed to have a CAR prior distribution. The susceptible model
is deterministic and with a ﬁxed β the removal proportion is ﬁxed. Many
variants of these speciﬁcations could be considered. For example, we could
specify μij = Sijf∗(Iij−1, {I}δij−1, exp{ψij}) where dependence in f∗is on
the previous count Iij−1, on the counts in a predeﬁned neighborhood δij−1,
{I}δij−1 say, and a linear predictor including both covariates and random
eﬀects which could be spatially or temporally correlated.
An example of the application of this model to publicly available ﬂu culture
positives (C+) from the 2004–2005 ﬂu season reported for bi-weekly periods
for the counties of the state of South Carolina in the United States is given
in Lawson (2006b, Ch. 10), for the model speciﬁed in (11.7). In that case it
was assumed that β = 0.001. Figure 11.7∗displays the ﬂu season count vari-
ations for a selection of four counties in South Carolina (Beaufort, Richland,
Charleston and Horry). Beaufort and Horry both have high older age group
populations, while the main urban centers in the state are in Richland (city
of Columbia) and Charleston (city of Charleston). Figure 11.8 displays the
thematic maps of the counts for a selection of three time periods during the
season.
Figure 11.9† displays the posterior average infection rates (μij) for a se-
lection of four counties in the state, along with their 95% credible intervals.
Interestingly, Horry county peaks much earlier than other areas (time period
∗Wiley permission Figure 1.25 ch 1 of Lawson 2006
†Wiley permission Figure 10.3 Lawson 2006

276
Bayesian Disease Mapping
FIGURE 11.7
South Carolina inﬂuenza conﬁrmed C positive notiﬁcations: count proﬁles for
the period December 18, 2004–April 10, 2005 for a selection of four counties.
4–6) while Beaufort seems to display lag eﬀects into period 10–12. In fact
there appears to be considerable spatial and temporal variation in the mean
infection level.
11.4.3
Special Case: Veterinary Disease Mapping
While most work in disease mapping has been targeted towards human health,
there is a growing literature now in the application of disease mapping to
veterinary health. Veterinary health covers the analysis managed animal pop-
ulations, but may also cover wild populations, in particular where zoonosis
is possible (disease transmission between species). This has arisen partly be-
cause of recent outbreaks of BSE in cattle, foot and mouth disease among
sheep and cattle (FMD) and the spread of
Sars or avian ﬂu and its po-
tential for evolution within the human population. Often in these examples,
space-time variation is the most important feature to be modeled and so it is
justiﬁed to include discussion of this topic here.
The basic descriptive disease mapping techniques, such as the commonly
used convolution models (Chapter 5) can of course be applied to veterinary

Spatiotemporal Disease Mapping
277
Influenza C+ 12 February 2005
7 to 15
( 4)
3 to
7
(1)
2 to
3
(3)
1 to
2
(6)
0 to
1 (32)
Influenza C+ 15 January 2005
3 to 3
(2)
1 to 3
(3)
0 to 1 (41)
influenza C + 22nd January 2005
4 to 4
(1)
3 to 4
(1)
2 to 3
(1)
1 to 2
(2)
0 to 1 (41)
FIGURE 11.8
South Carolina inﬂuenza conﬁrmed positive notiﬁcations: count thematic
maps for a selection of three time periods in the 2004–2005 season.

278
Bayesian Disease Mapping
2
4
6
8
10
12
0
2
4
6
time period
posterior mean infection rate
Beaufort
2
4
6
8
10
12
0
5
10
15
time period
posterior mean infection rate
Charleston
2
4
6
8
10
12
0
5
10
15
time period
posterior mean infection rate
Richland
2
4
6
8
10
12
0
1
2
3
4
5
6
time period
posterior mean infection rate
Horry
FIGURE 11.9
South Carolina inﬂuenza conﬁrmed positive notiﬁcations: posterior mean in-
fection rate estimates for 13 time periods with credible 95% intervals for a
selection of four urban counties: Beaufort, Charleston, Richland, and Horry.
data and there are now various examples of this in the literature (e.g., Steven-
son et al. 2000, 2001, 2005; Durr et al., 2005). Competing risk multivariate
analysis has also been proposed (Diggle et al., 2005). An overview of GIS-
based applications is found in Durr and Gatrell (2004).
Often the data that arises in veterinary applications is akin to human health
data. It is usually discrete and could be in the form of a marked point process
in space and time (animal locations and their disease state and a date of
observation), could be counts of animals with a disease (such as within farms)
or counts of infected farms within parishes or counties. Within smaller spatial
units (such as farm buildings) it is also possible to model individual animal
outcomes over time.
Figure 11.10‡ displays the bi-weekly standardized incidence ratios for FMD
over parishes within northwest England (Cumbria), United Kingdom during
2001. The space-time spread of the disease is clearly shown. The denominators
for the SIR were calculated from the overall rate for the whole space-time
window. In a retrospective analysis it is reasonable to standardize within
such an overall rate. However in a surveillance context this would not be
possible. In that case one option would be to use a historical rate. The spread
of infection can be described via models that attempt to summarize the spatial
and temporal eﬀects. For example, the count of FMD premises (farms) within
the i th parish at a given time period (j) in Cumbria (yij) could be modeled
‡Preventive vet med permission Lawson and Zhou (2005) Figure 4.

Spatiotemporal Disease Mapping
279
as a binomial random variable with various hierarchical elements. Deﬁne the
number of farms within the i th parish as ni, then assume
yij ∼bin(pij, ni)
log it(pij) = Ai + vi + ξj
where Ai = β0 + β1xi + β2yi + β3xiyi.
The term Ai is purely a trend component in the spatial coordinates (xi, yi)
of the parish, while vi, ξj are random eﬀects that are meant to capture the
spatial and temporal random variation. This is the descriptive model reported
by Lawson and Zhou (2005). The random terms are assumed to have prior
distributions given by:
vi ∼N(0, τv)
ξj ∼N(ξj−1, τξ).
Hence temporal dependence is assumed to be modeled by an autoregressive
term in the logit link. Suitable parameter prior distributions were assumed
for β,τv, τξ. There is no spatial correlation term, as it was felt that the dy-
namic nature of the risk would be better described via uncorrelated spatial
risk and correlated temporal risk. This descriptive model was only partially
successful in describing the variation. In this model the spatial trend com-
ponent is ﬁxed in time. Not considered by the authors was the possibility of
making the regression parameters in the trend component time-dependent.
This might be an attractive option in some cases as it would allow the spatial
model to have a dynamic element. For example, it could be assumed that
βj∼MVN(βj−1, τ βIn), where In is a unit matrix where n = 4.
11.4.3.1
Infection modeling
Infectious disease spread is particularly important in veterinary applications.
There are few examples of mechanistic Bayesian modeling of such spread.
H¨ohle et al. (2005) gives an example where swine fever within pig units is
modeled spatially via a survival model where the hazard function is a func-
tion of the count of infected animals within the unit and also the count in
neighboring units. Bayesian models for the UK FMD outbreak at farm level
were also proposed where a survival model was assumed at the farm level
(Weibull in this case) for the risk of infection and then a count model for the
number infected conditional on the infection of the farm (Lawson and Zhou,
2005). This also had spatial dependence included. These models are adequate
where a relatively slow epidemic is apparent, but are likely to be inadequate
when a full epidemic curve with peaking and recession is to be modeled.
11.4.3.2
Some complicating factors
There are a number of complicating factors that appear in veterinary ex-
amples that should be highlighted. First of all, it is often the case, that for

280
Bayesian Disease Mapping
N
S
SIR
0-0.500
0.501-1.000
1.001-1.500
1.501-2.000
2.001-2.500
> 2.500
E
W
N
S
SIR
0-0.500
0.501-1.000
1.001-1.500
1.501-2.000
2.001-2.500
> 2.500
E
W
N
S
SIR
0-0.500
0.501-1.000
1.001-1.500
1.501-2.000
2.001-2.500
> 2.500
E
W
N
S
SIR
0-0.500
0.501-1.000
1.001-1.500
1.501-2.000
2.001-2.500
> 2.500
E
W
N
S
SIR
0-0.500
0.501-1.000
1.001-1.500
1.501-2.000
2.001-2.500
> 2.500
E
W
N
S
SIR
0-0.500
0.501-1.000
1.001-1.500
1.501-2.000
2.001-2.500
> 2.500
E
W
N
S
SIR
0-0.500
0.501-1.000
1.001-1.500
1.501-2.000
2.001-2.500
> 2.500
E
W
N
S
SIR
0-0.500
0.501-1.000
1.001-1.500
1.501-2.000
2.001-2.500
> 2.500
E
W
FIGURE 11.10
Foot and mouth disease (FMD) epidemic northwest England, United Kingdom
2001: bi-weekly maps of standardised incidence ratios for February 2nd two-
week period until June 1st two-week period (row-wise).

Spatiotemporal Disease Mapping
281
important infection epidemics, intervention by veterinary agencies will dra-
matically alter the progression of the disease (and also the ability to observe
the progression). In the FMD outbreak in the United Kingdom on 2001, ring
culling was introduced. This entailed slaughtering all farm animals within a
ﬁxed radius of a newly found case of FMD. This culling is an attempt to
intervene in the spread of the disease. The eﬀect of this is to introduce a
particular form of spatiotemporal censoring during the epidemic and this can
lead to considerable missing information that could aﬀect model predictions.
This also leads to the other important aspect of modeling veterinary disease
and that is the surveillance or predictive capability of models. In the FMD
outbreak in the United Kingdom in 2001, statistical models were used on a
daily basis to predict the progression of the disease. The online surveillance of
disease spread is very important and predictive capability is of course an im-
portant and natural ingredient of Bayesian modeling with recursive Bayesian
updating an essential ingredient.
Finally, it is also important to note that there can be a major diﬀerence in
data acquisition within veterinary health compared to human health. Animals
usually do not report disease to vets! Hence they have to be sampled, and,
unless registries of disease are set up with mandatory reporting, there is the
possibility that under-reporting or underascertainment of cases could become
a major problem. While this is less important for managed herds (such as on
farms), it could be very important for wild populations.
For wild populations, animals are free to move and their mobility can make
sampling very problematic. For wild populations, access to animals and the
fact that they move around in space-time leads to extra complications. Dis-
tance sampling (Buckland et al., 2001) is one approach to assessing mobile
population density. Remote sensing could be used for density estimation also.
However this does not usually allow the health of animals to be assessed.
Hunter surveys and special culling have been used for deer population health
(chronic wasting disease: Farnsworth et al., 2006). However these data are of-
ten prone to considerable biases due to the nature of hunting (choice of area,
choice of animal, time of day, date of hunting) and it is not clear how rep-
resentative these data are of the true population health. Faecal surveys may
also be used.
Even with managed herds, the animals must be continually checked to ﬁnd
out if they are diseased, and this means that unless there is continual mon-
itoring of uninfected animals over space and time then underascertainment
is highly likely. Of course some modeling strategies are possible to deal with
this issue as noted above (Section 11.4.2).


A
Basic R and WinBUGS
It is useful to be able to manipulate data, design models, and analyze output
from posterior sampling with suitable tools. The package R, which is freely
available (www.r-project.org), is a very useful tool for pre- and post-analysis of
Bayesian models. Not only is R readily available, it also includes state-of-the-
art procedures for manipulating/analyzing data and has very sophisticated
graphics capabilities. It also has functionality for interacting with McMC pro-
grams and in particular has functions that can process McMC output (CODA,
BOA).
A.1
Basic R Usage
R is an object-oriented language which is platform-independent and command-
driven. This latter feature seems regressive given the common use of graphical
user interfaces (such as in S-Plus). On the other hand, this allows wide avail-
ability across platforms. There is no doubt that this feature does frustrate the
occasional user, particularly when data input must be command-based.
Review of basic R features is found in Maindonald and Braun (2003) and
more extensive use in modeling is covered by Faraway (2006). We assume
some basic familiarity with R.
A.1.1
Data
Most often data can be processed as vectors or matrices within R. For the
South Carolina congenital anomaly mortality example, the data, consisting of
county-based observed counts and expected rates, are read into a dataframe
adat:
adat<-list(m=46,
y=c(0,7,1,5,1,1,5,16,0,17,4,0,0,1,1,7,1,3,0,0,8,2,13,7,0,8,0,3,2,4,1,
11,0,1,2,3,3,8,6,14,3,11,6,0,1,5),
e=c(1.129778827,6.667008775,0.650279674,6.988864371,0.95571406,
1.123210345,5.908349156,8.539026017,0.601016062,18.92051111,
2.272694617,1.73736337,2.019808077,1.688099759,1.747216093,
3.221840201,1.835890594,5.221942834,0.978703751,1.254579976,
283

284
Bayesian Disease Mapping
6.407553754,2.676656232,16.57884744,3.077333607,1.087083697,
7.606301637,1.018114641,2.15774619,2.844152512,2.955816698,
0.985272233,9.22871658,0.38097193,1.855596038,1.579719813,
1.579719813,2.647098065,4.791707292,4.144711859,15.70852363,
0.765228101,11.32077795,6.256478678,1.500898035,2.085492893,7.297583004)).
The expected rates are computed from state-wide age-gender stratiﬁed rates
and applied to county age-gender group populations and then summed.
Summarization of the basic data can be achieved via various commands,
one of which is displayed here.
smr<-adat$y/adat$e
summary(smr)
This produces a numerical summary of the vector smr:
Min. 1st Qu. Median Mean 3rd Qu. Max.
0.0000 0.5404 0.8908 0.9282 1.2620 3.9200
A.1.2
Graphics
For non-spatial data a variety of summarization graphics are available. For
example, histogram or density estimates are available. The commands
par(mfrow=c(1,2))
hist(adat$y,breaks=50,xlab=”count”,main = ””)
plot(density(adat$y),main=””)
produced the Figure A.1. We can also easily get crude relative risk estimates
by computation of the standardized mortality ratio for the data which is just
given by
plot(density(smr),main=””)
Figure A.2 displays the density estimate for the SMR for this count data.
Another display demonstrates some further range of measures available
par(mfrow=c(2,2))
hist(adat$y,xlab=”count”,main=””)
hist(smr,xlab=”standaridised incidence ratio”,main=””)
plot(adat$y,adat$e,xlab=”expected”,ylab=”count”,main=””)
boxplot(smr,xlab=”standaridised incidence ratio”)
These commands lead to the display in Figure A.3.
A variety of functions are available for graphical representation of spatial
data on R. A common practice with spatial data is to display a pixellated
image of a smoothed (estimated) surface. In addition, contouring is useful and
can be added easily to such a plot. Although perspective plotting is possible
and visually attractive, these plots are not particularly informative and are
not discussed here. Until recently, the AKIMA and SM packages provided the
simplest functionality for such surface interpolation and plotting. In AKIMA,

Basic R and WinBUGS
285
FIGURE A.1
Histogram and density estimate of the 46 county level counts for the South
Carolina congenital anomaly mortality example.
the interp function provides a mathematical interpolator which allows the
input of unordered x,y,z vectors:
library(akima)
asd1<-interp(xcen, ycen, smr).
The output is a list with 3 elements which are x,y grid points and associated
interpolated values (z), These can be displayed via image or contour functions:
image(asd1,col=gray(20:0/20),xlab=”x coordinate”,ylab=”y coordinate”)
contour(asd1,add=T)
Figure A.4 displays the results of using interp for the smr data with county
centroids (xcen,ycen).
The above commands yield a grey scale pixellated image map with a con-
tour map overlain with default contour levels. An alternative package that
can be used for such surface interpolation and plotting is the SM package.
This package was developed to provide nonparametric density and regression
estimation capability. The function sm.regression provides a nonparametric
regression estimator for x,y,z data, based on the work described in Bowman
and Azzalini (1997):

286
Bayesian Disease Mapping
FIGURE A.2
Density estimate of the SMR for the SC anomaly mortality data.
xyMAT1<-cbind(xcen,ycen)
asd2<-sm.regression(xyMAT1,smr,h=c(3000,3000),display=”image”)
will display a contour surface for the interpolated smr with a ﬁxed smoothing
(speciﬁed by h). An evaluation grid can be speciﬁed also as well as diﬀerent
smoothing procedures.
More recently a more sophisticated smoothing and interpolation package
has been developed. This package is called MBA and implements multilevel B
spline surface interpolation. The main function is mba.surf and relies on a Mul-
tilevel B-spline Approximation (MBA) algorithm. The R implementation of
the code was developed by Andrew Finley and Sudipto Banerjee at University
of Minnesota. It is available in zip form from http://blue.fr.umn.edu/MBA/.
The mba.surf function has considerable ﬂexibility in the speciﬁcation of the
local smoothness and ﬂexibility of the surface. An example of its application
follows where we examine the smr surface for the SC congenital anomaly data:
xyMat2 <-cbind(xcen,ycen,smr)
asd2<-mba.surf(xyMat2,50,50)$xyz.est
image(asd2,col=gray(20:0/20),xlab=”x coordinate”,ylab=”y coordinate”)
contour(asd2,add=T)
points(xcen,ycen)

Basic R and WinBUGS
287
FIGURE A.3
Display of four basic plots of the observed data. Clockwise from top left:
histogram of the observed counts; histogram of the SIR; boxplot of the SIR;
scatterplot of observed versus expected count.
Figure A.5 displays the image and contour map for the smr example using
the multilevel B spline code function mba.surf.
A.2
Use of R in Bayesian Modeling
R is a useful package for data manipulation and post McMC process-
ing as it can a) pass information to WinBUGS and b) run WinBUGS.
In addition to this speciﬁc purpose it can be useful in simpler scenarios
also. R is used extensively in Bayesian course teaching (see for example
www.mrc-bsu.cam.ac.uk/bugs/weblinks/webresource.shtml for extensive ex-

288
Bayesian Disease Mapping
FIGURE A.4
Image and contour map of the interpolated SMR for the SC congenital
anomaly mortality data example using interp.
amples). The simulation facilities in R allow a wide range of simple Bayesian
modeling to take place. With simpler Bayesian models there could be two
approaches to posterior inference. First, the exact form of the posterior distri-
bution could be a known distribution and so summarization of the posterior
information can made directly from the distribution. For instance, the beta
posterior distribution that arises from the binomial likelihood and beta prior
distribution can be viewed via the use of dbeta function (the distribution
function for the beta distribution)
theta<-seq(0.3,0.6,0.001)
w=1;alpha=1;beta=1;
plot(theta,dbeta(theta,436,543),type=”l”,xlab=”theta”,
ylab=””,xaxs=”i”,yaxs=”i”,yaxt=”n”,bty=”n”,cex=2)
# likelihood of θ
lines(theta,dbeta(theta,alpha,beta),lty=2)
# prior distribution
lines(theta,dbeta(theta,437+alpha,543+beta),lty=2)
# posterior distribu-
tion
This sequence of commands plots the likelihood, Beta (1,1) prior dis-
tribution (dotted line) and the posterior distribution, and results in the
Figure A.6.

Basic R and WinBUGS
289
FIGURE A.5
The SMR image and contour map for thr SC congential anomaly mortality
example using the MBA package
Second, we may know the posterior distribution but may ﬁnd it easier to
sample from the posterior distribution. On R it is possible to simulate from
a wide range of distributions and so if the form of the posterior distribution
is known then we can take a posterior sample. For example a sample of 1000
values from a beta distribution with parameters 437+alpha,543+beta could
be obtained in the vector samp by
samp<-rbeta(1000,437+alpha,543+beta)
summary(samp)
The ﬁnal statement provides a summary of the sample values in samp.
Alternatively, sometimes within simulation studies, we would be interested
in generating synthetic data from given parameter values for parametric distri-
butions. For example, it is commonly assumed that incident counts of disease
(yi) within small areas (census tracts, counties, zip codes, etc.) follow a Pois-
son distribution with mean eiθi where ei is a known expected rate and θi is a
relative risk. Under simulation it would be usual to assume a particular form
for the risk, and then to simulate form the given Poisson distribution. Hence
if for example θi = exp(α+vi) where α = −.2 and vi ∼N(0, 1) then we could

290
Bayesian Disease Mapping
FIGURE A.6
The binomial likelihood, (ﬂat) beta(1,1) prior distribution and the posterior
distribution from R commands.
simulate this straightforwardly within R. For a sample size of m, the following
code will leave a vector of m counts in ysim:
v<-rnorm(m,0,1)
theta<-exp(-.2+v)
mu<-e*theta
ysim<-rpois(m,mu).
A.3
WinBUGS
While it is not the intention to provide a detailed review of WinBUGS us-
age in disease mapping, some basic features of the package should be high-
lighted here to motivate further use. More advanced features will be intro-
duced when they arise in later chapters. The reader is directed to Law-
son et al. (2003) for a more detailed introduction to a selection of topics
in this area. Example code for examples in that work are available from

Basic R and WinBUGS
291
http://sph.sc.edu/alawson/default.htm. The WinBUGS online help facilities
include a range of examples that are also very useful to follow. The exam-
ples can be executed within the package and so can be seen in operation. The
MRC Biostatistics WinBUGS Web site (http://www.mrc-bsu.cam.ac.uk/bugs)
is also a very useful resource.
A.3.1
Simulation
It is possible to use WinBUGS for simulation as it is a feature of the package
that simulation-based methods are a kernel of the methodology. WinBUGS
is based on the idea that Bayesian models can be represented as hierarchies
with parameter nodes. Each parameter in the model can be represented as
a stochastic node (in which case it has a distribution), a constant, in which
case its ﬁxed, or a logical node, in which case it is the result of an assign-
ment operation based on an expression. Given below is an example of simple
simulation code for a Poisson distributed variable y (y) with mean μ = eθ
(mu < −exp ∗theta)
where a gamma distribution is assumed for θ at the
next level of the hierarchy.
model;
{
y ˜dpois(mu)
mu <- exp * theta
theta ˜dgamma(0.05,0.05)
}
In this example, θ ∼Gamma(0.05, 0.05), the expected rate (e = 1) is loaded
as data
list(exp=1)
while all stochastic nodes are initialized before the simulation starts:
list(theta=0.5,y=2).
Following the initialization, the number of values of y simulated is set in
the sample monitor. Figure A.7 displays the series of counts obtained with
10000 iterations with the above model.
More sophisticated simulation is possible within WinBUGS of course, but it
is often more convenient to exploit the interactive capabilities of R in simula-
tion of data.
A.3.2
Model Code
The previous example demonstrated some features of WinBUGS model code,
albeit in a simple simulation. When data is included within a model then a
data likelihood must be speciﬁed. WinBUGS does not distinguish between a
parameter node that has associated data as opposed to simply a stochastic
node. The only diﬀerence is when data are loaded and a stochastic node with

292
Bayesian Disease Mapping
FIGURE A.7
Time series of simulated counts from WinBUGS under a simple Poisson–
gamma model
data is not simulated. Hence, both data and parameters are treated alike.
WinBUGS assumes that if data are not assigned to any stochastic node then
the node must be initialized and updated. The model code below is an example
where data are included. In this case, again we use the simple example of count
data within small areas. Assume that there are m regions, the count in the i th
region is yi , the expected rate for the same region is ei and the relative risk is
θi. Assume also that [yi|ei, θi] ∼Poisson(μi), and μi = eiθi. At the next level
of the hierarchy assume that θi ∼Gamma(a, b). Hence this model assumes
that the relative risks are an exchangeable sample from a Gamma distribution.
Finally, at the next level of the hierarchy, the gamma parameters: a, b, both
have exponential distributions with ﬁxed parameters λ = 1/mean = 0.1. This
leads to a large variance and mean of 10. With these hyper-prior distributions
the expected value of θi is 1 but with a relatively small variance. For this
model the WinBUGS code is given below.
model{for (i in 1:m)
{
# Poisson likelihood for observed counts
y[i]˜dpois(mu[i])
mu[i]<-e[i]*theta[i]
# Relative Risk
theta[i]˜dgamma(a,b)}
# Prior distributions for ”population” parameters
a˜dexp(0.1)
b˜dexp(0.1)
# Population mean and population variance
mean<-a/b
var<-a/pow(b,2)}

Basic R and WinBUGS
293
In the above speciﬁcation the for loop extends over all subscripted variables
(y[],mu[],e[],theta[]). Note that the for speciﬁcation has the same loop format
as that found in R or S-Plus. The prior distributions are speciﬁed outside
the main loop for parameters which are not subscripted. Note that theta[i] is
subscripted and so its distribution must be speciﬁed inside a for loop.
A variant of this model deﬁnes a log linear model for the relative risk:
model{for (i in 1:m)
{
# Poisson likelihood for observed counts
y[i]˜dpois(mu[i])
mu[i]<-e[i]*theta[i]
# Relative Risk
log(theta[i])<-a+v[i]
v[i]˜dnorm(0,precv)}
# Prior distributions for ”population” parameters
a˜dnorm(0,preca)
siga<-1/preca
sigv<-1/precv
preca˜dgamma(0.5,0.0005)
precv˜dgamma(0.5,0.0005)}
This model can be run with the data from the adat list (m,y,e) and initial-
isation of the stochastic parameters (preca,precv,a,v) can be made using:
list(preca=0.1,precv=0.1,a=0.1,
v=c(0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0)).
The Metropolis rate monitor from this program on WinBUGS for a sin-
gle chain of 20,000 iterations is shown in Figure A.8. Metropolis–Hastings
updating was chosen by WinBUGS in this case. This monitor checks for a rea-
sonable acceptance rate. In general, the rate should lie between 0.25 and 0.5
(see Section 3.3.7.1). Hence, in this case the sampler seems to have reasonable
acceptance rate.
The sample Monitor on WinBUGS also provides a wealth of information
concerning parameters that have been monitored, the choice of monitored
parameters being left to the user. In Figure A.9, the sample monitor has
been set to record the parameters a,preca,precv,siga,sigv and the display shows
part of the stats option on the Sample Monitor. Displayed are the posterior
summaries for each parameter for the chosen sample size (mean, sd, MC error,
2.5% and 97.5% percentiles and the median). These are the default summaries,
but can be altered to produced e.g., alternative percentiles. All parameters
can be monitored and summarized in this way. For those that are indexed by
region (such as theta[], mu[], v[]), then a complete list of summaries for each
region is produced.

294
Bayesian Disease Mapping
FIGURE A.8
Display of the acceptance rate monitor for the Metropolis-Hastings sampler
adopted by WinBUGS, for the Poisson log linear frailty relative risk model
for 20,000 iterations.
FIGURE A.9
Display of summary of posterior parameter estimates as provided by
WinBUGS for a sample of 2000 after a burn-in of 20,000 iterations for the log
linear Poisson relative risk model with simple frailty random eﬀect.
Figure A.10 displays the thematic map of the posterior expected spatial
distribution of the theta[] parameter (relative risk) for the Poisson log linear
model. This map is easily obtained from the GeoBUGS menu option within
WinBUGS. The region geographies (in this case county boundaries) must be
available as a GIS-format ﬁle (ArcView, Epimap, Splus, ArcInfo) and this can
be imported to WinBUGS for use with GeoBUGS. Once the map geographies
are input, any parameter indexed by the region index can be plotted via the
Map Tool. The order of regions must be the same as the parameter vectors
in the model of course. In the Poisson log linear model above, there are three
parameter vectors that can be plotted: theta[], mu[],
and v[]. Figure A.11
displays the map for the posterior mean uncorrelated frailty term v[].
Alternative models can be speciﬁed for diﬀerent data formats of course. The
above example assumed a Poisson likelihood for count data within counties.
Another situation commonly found in spatial analysis of disease risk is that
a ﬁnite population is measured within an area and within that population
a binary variable is recorded on each unit. For example, an example would
be total brain cancer cases recorded within counties and the number of male
cases. Here we examine another South Carolina example where we have the

Basic R and WinBUGS
295
FIGURE A.10
Display of the GeoBUGS posterior expected relative risk map (theta[]) for the
46 counties of South Carolina for a 2000 sample size and the Poisson log linear
frailty model.
total case count for 1996–2000 of brain cancer by county in SC. The male
count is also known. The sex diﬀerence may have a spatial expression. The
model code below can be applied to this case and is similar to the previous
Poisson model except we have a binomial likelihood for the male count data
(malc[i]) out of a total count (totc[i])
model{for (i in 1:m)
{
# binomial likelihood for observed counts
malc[i]˜dbin(p[i],totc[i])
logit(p[i])<-a+v[i]
v[i]˜dnorm(0,precv)}
# Prior distributions for ”population” parameters
a˜dnorm(0,preca)
preca<-1/siga
precv<-1/sigv
siga˜dgamma(0.001,0.001)
sigv˜dgamma(0.001,0.001)}
The mapped results of this analysis after 10,000 iterations are displayed for
a sample size of 2000, in the Figures A.12 and A.13. It is clear that there is
considerable spatial structure in this data, as the probability map has clear
peaks of male over female incidence in the northern coastal regions of the
state. The uncorrelated frailty term also shows this tendency which suggests
that considerable spatial structure remains in the data.

296
Bayesian Disease Mapping
FIGURE A.11
Display of the posterior mean uncorrelated frailty term, v[], for a sample of size
2000, for the Poisson log linear relative risk model with uncorrelated frailty
term.
A case event Bernoulli model can be speciﬁed, as a special case of the bi-
nomial model above , where y[i] is a binary vector and a Bernoulli likelihood
is assumed. This is appropriate where you have individual level data, and is
commonly found in putative pollution hazard studies but is by no means un-
common elsewhere. A logistic linear link can also be assumed here and the
code below displays this as a WinBUGS model, similar to the binomial frailty
model. The only diﬀerence lies in the outcome data and likelihood. For case-
control event data, the binary outcome would be the case/control status and
all other variables (such as individual covariates or functions of the x, y lo-
cational coordinates of the cases and controls) can be included as covariates.
In the example code below, two covariates are read in (X1[],X2[]) and they
have regression parameters B1 and B2 with zero-mean Gaussian prior distri-
butions. The precision parameters have diﬀuse Gamma prior distributions.
This a binary random eﬀect logistic linear model.
model{for (i in 1:m)
{
# Bernoulli likelihood for observed counts
y[i]˜dbern(p[i])
logit(p[i])<-a+v[i]+B1*X1+B2*X2
v[i]˜dnorm(0,precv)}
# Prior distributions for ”population” parameters
B1˜dnorm(0,precB1)
B2˜dnorm(0,precB2)

Basic R and WinBUGS
297
FIGURE A.12
Display of of the posterior mean probability of a male cancer by county in SC
for the ﬁve year brain cancer case example (1996–2000).
FIGURE A.13
Display of the posterior mean uncorrelated frailty (v[]) for the logistic linear
model by county in SC for the ﬁve year brain cancer case example (1996–
2000).

298
Bayesian Disease Mapping
FIGURE A.14
Display of Brooks–Gelman–Rubin plots for the deviance and parameter a for
the SC county-based brain cancer logistic linear frailty model for 1996–2000.
The plots are closely linear and parallel which suggests close convergence by
2000 iterations.
a˜dnorm(0,preca)
preca<-˜dgamma(0.001,0.001)
precv˜dgamma(0.001,0.001)
precB1˜dgamma(0.001,0.001)
precB2˜dgamma(0.001,0.001)
}
Convergence of McMC samplers is an important issue, as noted in Sec-
tion 3.3.6. In all the examples above the samplers were monitored using a
variety of diagnostics. The main diagnostic used on WinBUGS is the Brooks-
Gelman-Rubin (BGR) diagnostic which examines the between and within
sample variances for output streams. Figure A.14 displays the BGR diagnos-
tic for two components of the logistic linear model for the SC brain cancer
example: the deviance and parameter a. The display suggests that the models
have converged early at least for these parameters.
A.4
R2WinBUGS Function
This function is very useful for executing WinBUGS programs from R. For
an overview see Sturtz et al. (2005). The main advantage of this lies in the
ability to further manipulate data within R before and after execution of

Basic R and WinBUGS
299
WinBUGS code. In addition, R2WinBUGS provides added facilities (such as
a diﬀerent DIC calculation, and graphical summaries). The main advantage
of this functionality is found in simulation. When multiple datasets must be
repeatedly analyzed then the ability to pass these to WinBUGS from R and
to continue processing of further simulation datasets within a loop is a major
advantage.
The main function call, once R2WinBUGS is loaded, is to a function called
bugs which activates WinBUGS and passes the relevant information for pro-
cessing:
bugs(data, inits, parameters.to.save, model.ﬁle = ”model.txt”,
n.chains = 3, n.iter = 2000, n.burnin = ﬂoor(n.iter/2),
n.thin = max(1, ﬂoor(n.chains * (n.iter - n.burnin)/1000)),
bin = (n.iter - n.burnin) / n.thin,
digits = 5, codaPkg = FALSE,
bugs.directory = ”c:/Program Files/WinBUGS14/”)
The main parameters for the function call are summarized below:
data: either a named list (corresponding to the names used in the model)
OR a vector or list of the names of objects OR a name of a ﬁle containing the
data.
inits: a list with n.chains elements, each element being a list of starting
values, OR a function that creates these values.
parameters.to.save: a character vector of the names of parameters to be
saved
model.ﬁle:
ﬁle containing the WinBUGS code
n.chains: number of chains (defaults to 3)
n.iter: number of iterations (including burn-in)
n.burnin:
number of burn-in iterations (default to half length of chain:
n.iter/2).
Other parameters can be set to control e.g., thinning rate (n.thin), DIC
calculation (DIC).
A simple example of a call is as follows. The Poisson–gamma model where
the relative risk is assumed to have mean eiθi is considered below for the South
Carolina congenital anomaly mortality data. This data was ﬁrst examined in
Chapter 4. It consists of incident counts in 46 counties of South Carolina for
one year. The expected rates associated with these counts are also available,
computed from the statewide reference population. For purposes of data input
to R2WinBUGS we need to set up a data structure which includes the outcome
variable, the expected rate, and number of regions (y,e,m). The structure adat
deﬁned below is such a list structure:
adat<-list(m=46,
y=c(0,7,1,5,1,1,5,16,0,17,4,0,0,1,1,7,1,3,0,0,8,2,13,7,0,8,0,3,2,4,1,
11,0,1,2,3,3,8,6,14,3,11,6,0,1,5),

300
Bayesian Disease Mapping
e=c(1.129778827,6.667008775,0.650279674,6.988864371,0.95571406,
1.123210345,5.908349156,8.539026017,0.601016062,18.92051111,
2.272694617,1.73736337,2.019808077,1.688099759,1.747216093,
3.221840201,1.835890594,5.221942834,0.978703751,1.254579976,
6.407553754,2.676656232,16.57884744,3.077333607,1.087083697,
7.606301637,1.018114641,2.15774619,2.844152512,2.955816698,
0.985272233,9.22871658,0.38097193,1.855596038,1.579719813,
1.579719813,2.647098065,4.791707292,4.144711859,15.70852363,
0.765228101,11.32077795,6.256478678,1.500898035,2.085492893,
7.297583004))
For initial values a list structure can be deﬁned for this example that con-
tains 3 initializations of the relevant parameters. The parameters to initialize
are the predicted outcome values. To run R2WinBUGS the default is 3 chains.
In this example, we can specify initial values for 3 chains as a list of lists with
a,b,theta,ypred within each of 3 list elements (ab,ac,ad) which in turn, form
the 3 component list ainits:
ab<-list(a=0.1,b=0.1,theta=c(1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1),
ypred=c(0,7,1,5,1,1,5,16,0,15,4,0,0,1,1,7,1,3,0,0,8,2,13,7,0,
8,0,3,2,4,1,11,0,1,2,3,3,8,6,14,3,11,6,0,1,5))
ac<-list(a=0.12,b=0.12,theta=c(1.2,1,1,1,1,1,1,1,1,1.2,1,1,1,1,1,1,1,1,1,1,
1,1,1,1,1,1,1,1.2,1,1,1,1,1,1,1,1,1,1,1.5,1,1,1.6,1,1,1,1),
ypred=c(0,7,1,5,1,1,5,16,0,15,4,0,0,0,0,6,1,2,0,0,8,2,13,7,0,
8,0,3,2,4,1,11,0,1,2,3,3,8,6,14,3,11,6,0,1,5))
ad<-list(a=0.15,b=0.17,theta=c(1.4,1,1,1,1,1,1,1,1.8,1,1,1,1,1,1,1,1,1,1,1,
1,1,1,1,1,1,1,1.2,1,1,1,1,1,2.1,1,1,1,1,1,1,1,1,1,1.1,1,1),
ypred=c(0,7,1,5,0,0,0,0,0,0,4,0,0,1,1,7,1,3,0,0,8,2,13,7,0,8,0,
3,2,4,1,11,0,1,2,3,3,8,6,14,3,11,6,0,1,5))
ainits<-list(ab,ac,ad)
In the example, the parameters to monitor are the mean, residual, and pre-
dictive residual ( ”mu”,”r”,”rpred”), the data are in the object adat, the num-
ber of chains defaults to 3, the inits for the 3 chains are in ainits, the number of
iterations is 4000 and the model is found in text ﬁle ”map modelWB pred.txt”:
parameters<-c(”mu”,”r”,”rpred”)
map.sim<-bugs(adat,inits = ainits,
parameters,n.iter=4000,
model.ﬁle =”map modelWB pred.txt”)
The model ﬁle: ‘map modelWB pred.txt’ contains the following model code:
model
{for (i in 1:m)
{# Poisson likelihood for observed counts
y[i]˜dpois(mu[i])

Basic R and WinBUGS
301
ypred[i]˜dpois(mu[i])
mu[i]<-e[i]*theta[i]
probexc[i]<-step(theta[i]-1)
# Relative Risk
theta[i]˜dgamma(a,b)
r[i]<-y[i]-mu[i]
rpred[i]<-y[i]-ypred[i]}
# Prior distributions for ”population” parameters
a˜dexp(10)
b˜dexp(10)
# Population mean and population variance
mean<-a/b
var<-a/pow(b,2)
}
Submitting the command map.sim<-bugs(....) in R calls WinBUGS with the
parameters speciﬁed, and stores the results of the call in object map.sim. Upon
return from WinBUGS, map.sim contains a range of information. For example,
some useful components and summaries are as follows:
map.sim $mean yields the posterior mean estimate
map.sim$sd yields the posterior standard deviations
map.sim$mean$rpred
yields the separate posterior mean for component
rpred
map.sim$median
yields the posterior sample median
map.sim$summary[,3] yields the 2.5 posterior sample percentile
map.sim$summary[,7] yields the 97.5 posterior sample percentile
map.sim$sims.matrix yields the complete output matrix
Diagnostic plots of the output are available via use of the plot command
applied to the bugs object. For example, the caterpillar and box plots available
on WinBUGS can be produced with the command plot(map.sim) (see Figure
A.15). Alternatively simple plotting commands applied to elements of the
output can be used. For example,
plot(density(map.sim$summary[1:46,1]),main=””)
will produce a density estimate of the mean posterior distribution of parameter
mu (see Figure A.16), whereas the commands
smat<-map.sim$sims.matrix
dfsmat<-data.frame(smat[,47:92])
boxplot(dfsmat)
will produce a multiple boxplot of the residuals in R for each unit (see Figure
A.17).

302
Bayesian Disease Mapping
FIGURE A.15
Display of the plot command applied to the output object from the bugs(..)
command. The output consists of caterpillar and box plots for the nominated
output.
A.5
BRugs
The BRugs package is an implementation of OpenBUGS on R. This is a col-
lection of R functions allowing users to analyze graphical models via McMC
techniques. Most of the R functions provide a link to the BRugs dynamic link
library (shared object ﬁle). Essentially this allows users considerable freedom
to build graphical models from scratch, but it also requires that each step in
the modeling process is a separate call to a BRugs function. Hence compilation,
model checking, monitor setting, etc. are all separate calls to R functions. The
advantage of BRugs over R2WinBUGS is that WinBUGS is not called and con-
straints of that windows-implemented package are not imposed. This means
that relatively large datasets can be handled and there is no need to run under
Windows.

Basic R and WinBUGS
303
FIGURE A.16
Display of the density estimate for the posterior mean for parameter mu from
the bugs output object map.sim.
For a BUGS model ﬁle stored in “log-linear-Poisson-model2.txt”:
model{for (i in 1:m)
{ # Poisson likelihood for observed counts
y[i]˜dpois(mu[i])
mu[i]<-e[i]*theta[i]
# Relative Risk log(theta[i])<-a+v[i]
v[i]˜dnorm(0,precv)}
# Prior distributions for ”population” parameters
a˜dnorm(0,preca)
preca<-pow(sda,-2)
precv<-pow(sdv,-2)
sda˜dunif(0,100)
sdv˜dunif(0,100)}
data stored in list format in ”adat.txt”:
list(m=46,
y=c(0,7,1,5,1,1,5,16,0,17,4,0,0,1,1,7,1,3,0,0,8,2,13,7,0,8,0,3,2,4,1,
11,0,1,2,3,3,8,6,14,3,11,6,0,1,5),

304
Bayesian Disease Mapping
FIGURE A.17
Display of multiple boxplots of posterior mean residuals in r as output by
R2WinBUGS.
e=c(1.129778827,6.667008775,0.650279674,6.988864371,0.95571406,
1.123210345,5.908349156,8.539026017,0.601016062,18.92051111,
2.272694617,1.73736337,2.019808077,1.688099759,1.747216093,
3.221840201,1.835890594,5.221942834,0.978703751,1.254579976,
6.407553754,2.676656232,16.57884744,3.077333607,1.087083697,
7.606301637,1.018114641,2.15774619,2.844152512,2.955816698,
0.985272233,9.22871658,0.38097193,1.855596038,1.579719813,
1.579719813,2.647098065,4.791707292,4.144711859,15.70852363,
0.765228101,11.32077795,6.256478678,1.500898035,2.085492893,
7.297583004))
and initialisation values in ”inits.txt”:
list(a=0.1,sda=0.1,sdv=0.1)
The following command sequence will ﬁt the BUGS code model on R, with a
burn-in of 10000 iterations with 2 chains monitored:

Basic R and WinBUGS
305
library(BRugs)
modelCheck(”log-linear-Poisson-model2.txt”)
modelData(”adat.txt”)
modelCompile(numChains=2)
modelInits(rep(”inits.txt”,2))
modelGenInits
#......random eﬀect initialisation
modelUpdate(10000)
samplesSet(c(”theta”,”v”,”deviance”))
modelUpdate(2000)
samplesStats(”*”)
Note that output can be stored in a dataframe for later inspection:
asd<-samplesStats(”*”).
These functions can be built into a purpose built R function itself. Within
the BRugs package there is a command already speciﬁed:
BRugsFit( ”log-linear-Poisson-model2.txt”, data=”adat.txt”, numChains=2,
parametersToSave=c(”deviance”,”a”),nBurnin = 5000, nIter = 2000, nThin =
1)
This
command
will
ﬁt
the
model
speciﬁed
in
”log-linear-Poisson-
model2.txt” with a burn-in of 5000 and a sample of size 2000, and will display
the deviance and estimate for parameter ”a”, as well as the DIC.
Note also that convergence checking can be done via the usual BGR statis-
tic:
plotBgr(”deviance”,col=gray(0:3/3))
This command gives the BGR plot for the above model ﬁt as in Figure A.18.
The dark line is the ratio of between and within chain variance estimates.
A.6
Maps on R and GeoBUGS
Both on R and WinBUGS it is possible to handle mapped data.
On R the libraries maps and maptools provide facilities for the handling
of polygon-based maps. In particular, maps allows the visualizing of polygo-
nal data and with further programing allows the creation of thematic maps.
The maptools package allows the importation of ArcView shape ﬁles to R
(readShapePoly function) and also the export of maps to WinBUGS format
via the function sp2WB.
Both spatstat and splancs have functionality for
mapping point process data.

306
Bayesian Disease Mapping
FIGURE A.18
BGR statistic plot for the Poisson log linear relative risk model applied to a
46 region dataset, from BRugs
A direct conversion process to GeoBUGS format is useful and the Win-
dows program maps2WinBUGS is very useful in this regard. This pro-
gram can be downloaded free from www.sourceforge.net. The program al-
lows the import of both MapInfo MIF or TAB ﬁles as well as ArcView
shapeﬁles and exports GeoBUGS format map ﬁles. Other R code facilties
can be found on the Resource page of the WINBUGS site (http://193.60.
86.19/bugs/weblinks/webresource.shtml). The GeoBUGS manual has conver-
sion format recommendations for diﬀerent GIS conversions to GeoBUGS for-
mat.

B
Selected WinBUGS Code
A selection of WinBUGS models are presented here to provide a sam-
ple of how code can be speciﬁed for the model discussed. ODC ﬁles for
all the ﬁtted models within the book are available for download from
http://www.sph.sc.edu/alawson/default.htm.
B.1
Code for the Convolution Model
(Chapter 5)
model
{
for( i in 1 : m ) {
y[i] ˜dpois(mu[i])
mu[i] <- e[i] * rr[i]
smr[i]<-(y[i]+eps2)/(e[i]+eps2)
rr[i] <- exp(al0 +v[i]+u[i])
v[i]˜dnorm(0,1.0E-6)
PP[i]<-step(rr[i]-1+eps)
ypred[i] ˜dpois(mu[i])
PPL[i] <- pow(ypred[i]-y[i],2)
PPL2[i] <- abs(ypred[i]-y[i])
}
mape <- mean(PPL2[])
mspe <- mean(PPL[])
# car normal
u[1:m]˜car.normal(adj[],weights[],num[],tau.u)
for(k in 1:sumNumNeigh)
{
weights[k]<-1
}
al0 ˜dﬂat()
eps<-1.0E-6
eps2˜dnorm(0,1000)
307

308
Bayesian Disease Mapping
tau.u˜dgamma(0.005,0.005)
}
B.2
Code for Spatial Spline Model (Chapter 5)
This ﬁts the model outlined in section 5.7.2 for count data:
model{
for (i in 1 : 100){
ME[i]<-0}
a
for (i in 1:100){
for (j in 1:100){
SOM[i,j]<-tauS*OM[i,j]
}}
for (i in 1 : m){
y[i]˜dpois(mu[i])
mu[i]<-e[i]*theta[i]
ssum[i]<-inprod(gam[],CDZ[i,])
log(theta[i])<-a0+a1*xc[i]+a2*yc[i]+ssum[i]}
gam[1:100]˜dmnorm(ME[],SOM[,])
a0˜dﬂat()
a1˜dnorm(0,0.0001)
a2˜dnorm(0,0.0001)
tauS<-1/(sigmaS*sigmaS)
sigmaS˜dunif(0,10)}
B.3
Code for the Spatial Autologistic Model
(Chapter 6)
This model was speciﬁed as a simple regression model on the neighbor sums:
model
{
for (i in 1:m)
{
yb[i]˜dbern(p[i])
logit(p[i])<-alpha0+alpha*x[i]+beta*ysum[i]}
alpha0˜dﬂat()
alpha˜dnorm(0.0,0.1)
beta˜dnorm(0.0,0.1)}

Selected WinBUGS Code
309
B.4
Code
for
Logistic
Spatial
Case
Control
Model
(Chapter 6)
Logistic spatial case control model with a fully speciﬁed spatial covariance
model
model {
for (i in 1:N){
ind[i]˜dbern(p[i])
logit(p[i])<-f[i]
f[i]<-gam1*dis[i]+gam0+v[i]+W[i]
v[i]˜dnorm(0,0.001)
res[i]<-(ind[i]-p[i])/sqrt(p[i]*(1-p[i]))
prexR2[i]<-step(res[i]-2)}
gam0˜dﬂat()
gam1˜dnorm(0,0.01)
for(i in 1:N){ mu[i]<-0}
W[1:N] ˜spatial.exp(mu[], x[], y[], tau, phi,1)
tau˜dexp(0.1)
phi˜dexp(0.1)
}
B.5
Code for PP Residual Model (Chapter 6)
This ﬁts a heterogeneous Poisson process Bayesian model using the Dirichlet
tesselation weights. The background risk is estimated externally (e.g., in R)
and appears evaluated at the case event locations in the variable den[]
#w[] Dirichlet weights
# d[] dist from putative source
#I[] indicator variable denoting ‘real’ data point or ‘dummy’ data point
# x,y,w,den,I and d must be read in
model{
C <- 10000
for (i in 1:N) {
f[i]<-1.+exp(bet1*d[i])
zeros[i] <- 0
log(lam[i])<-bet0+log(f[i])
log(L[i])<-I[i]*log(lam[i])-w[i]*den[i]*lam[i]
phi[i] <- -log(L[i]) + C

310
Bayesian Disease Mapping
zeros[i] ˜dpois(phi[i])
res[i]<-((1/w[i])-den[i]*lam[i])
x1[i]<-x[i]
y1[i]<-y[i]
probexR[i]<-step(res[i]-0)}
bet0˜dnorm(0,0.001)
bet1˜dnorm(0,0.001)}
B.5.1
Same Model with Uncorrelated Random Eﬀect
model{
C <- 10000
for (i in 1:N) {
f[i]<-1.+exp(bet1*d[i])
zeros[i] <- 0
log(lam[i])<-bet0+log(f[i])
log(L[i])<-I[i]*(log(lam[i])+v[i])-w[i]*den[i]*lam[i]*exp(v[i])
phi[i] <- -log(L[i]) + C
zeros[i] ˜dpois(phi[i])
res[i]<-((1/w[i])-den[i]*lam[i])
x1[i]<-x[i]
y1[i]<-y[i]
probexR[i]<-step(res[i]-0)
v[i]˜dnorm(0,tauv)
}
bet0˜dnorm(0,0.001)
bet1˜dnorm(0,0.001)
tauv<-0.1
}
B.6
Code for the Logistic Spatial Case-Control Model
(Chapter 6)
The speciﬁcation is as for use with the R2winBUGS function
# x,y and ind as inputs.
# dis is distance
model
{
C <- 10000
for (i in 1:N){

Selected WinBUGS Code
311
f[i]<-(1+exp(-gam1*dis[i]))*exp(gam0+v[i])
zeros[i] <- 0
log(lam[i])<-log(f[i])
log(L[i])<-ind[i]*log(lam[i])-log(1.+lam[i])
phi[i] <- -log(L[i]) + C
zeros[i] ˜dpois(phi[i])
mu[i]<-0
p[i]<-lam[i]/(1+lam[i])
x1[i]<-x[i]
y1[i]<-y[i]
v[i]˜dnorm(0,0.1)
res[i]<-(ind[i]-p[i])/sqrt(p[i]*(1-p[i]))
prexR2[i]<-step(res[i]-2)
}
gam0˜dnorm(0,0.1)
gam1˜dnorm(0,0.1)
}
in ﬁle ”logistic case control P2.txt”
datalist elements: N, x, y, dis, ind
initial values: gam0, gam1, v
parameters: v, res, p, prexR2
B.6.0.1
R2WinBUGS commands:
The following commands set up the parameter vectors to report and the map-
ping tools. Use is made of the multivariate B spline package (MBA) for con-
touring:
>parameters<-c(”res”,”v”,”prexR2”,”p”)
>reslogist2<-bugs(data,inits,parameters,model.ﬁle=”logistic case control P2.txt”,
n.iter=10000)
The following R code will plot the mapped surface of Pr(ri > 2)
>plot(data$x[data$ind==1],data$y[data$ind==1],xlab=”easting”,ylab=
”northing”)
>zedprexR2<-cbind(data$x,data$y,reslogist2$mean$prexR2)
>ressurfprex<-mba.surf(zedprexR2,20,20)$xyz.est
>contour(ressurfprex,levels=c(0.05,0.1,0.2),add=T)

312
Bayesian Disease Mapping
B.7
Code
for
Poisson
Residual
Clustering
Example
(Chapter 6)
This is a standard Poisson risk model for count data with a UH eﬀect and
residual and exceedences computed
model
{
for( i in 1 : m ) {
y[i] ˜dpois(mu[i])
mu[i] <- e[i] * rr[i]
log(rr[i]) <- al0 +v[i]
v[i]˜dnorm(0,0.001)
PP[i]<-step(rr[i]-1+eps)
res[i]<-(y[i]-mu[i])/sqrt(mu[i])
prexR1[i]<-step(res[i]-1)
prexR2[i]<-step(res[i]-2)
}
al0˜dﬂat()
eps<-1.0E-6
}
B.8
Code for the Proper CAR Model (Chapter 7)
This is a proper CAR model for Ohio respiratory cancer 1988
model{
for(i in 1 : 88) {
m[i] <- 1/num[i]
}
cumsum[1] <- 0
for(i in 2:(88+1)) {
cumsum[i] <- sum(num[1:(i-1)])
}
for(k in 1 : sumNumNeigh) {
for(i in 1:88) {
pick[k,i] <- step(k - cumsum[i] - epsilon) * step(cumsum[i+1] - k) }
C[k] <- 1 / inprod(num[], pick[k,]) # weight for each pair of neighbours

Selected WinBUGS Code
313
}
epsilon <- 0.0001
for (i in 1 : 88) {
y[i] ˜dpois(mu[i])
log(mu[i])<-log(e[i])+a0+a1*(pov[i]+ep1[i])+S[i]+v[i]
RR[i] <- exp(a0+a1*(pov[i]+ep1[i])+S[i]+v[i]
theta[i] <- a0+a1*(pov[i]+ep1[i])+S[i]+v[i]
v[i]˜dnorm(0,0.0001)
ep1[i]˜dnorm(0,0.0001)
dis1[i]<-dist[i]}
# Proper CAR prior distribution for spatial random eﬀects:
S[1:88] ˜car.proper(theta[], C[], adj[], num[], m[], prec, gamma)
# Other priors:
prec <-1/pow(sdS,2)
# prior on precision
sdS˜dunif(0,100)
# uniform sd prior
sigma <- sqrt(1 / prec)
# standard deviation
gamma.min <- min.bound(C[], adj[], num[], m[])
gamma.max <- max.bound(C[], adj[], num[], m[])
gamma ˜dunif(0.5, gamma.max)
a0˜dﬂat()
a1˜dnorm(0,0.0001)
#tau.v<-1/pow(sdv,2)
#sdv˜dunif(0,10)
#tau.p1<-1/pow(sdp1,2)
#sdp1˜dunif(0,10)
}
B.9
Code for the Multiscale Model for PH and County Level
Data (Chapter 8)
The multiscale model for PH districts and counties in Georgia where u and v
for districts are included in county eﬀects
model{
for( i in 1:18){
yph[i]˜dpois(muph[i])
log(muph[i])<-log(eph[i])+log(thph[i])
thph[i]<-exp(aph0+uph[i]+vph[i])
vph[i]˜dnorm(0,0.0001)
}
for( j in 1:159){
yc[j]˜dpois(muc[j])

314
Bayesian Disease Mapping
log(muc[j])<-log(ec[j])+log(thc[j])
thc[j]<-exp(ac0+uc[j]+vc[j]+uph[phc[j]]+vph[phc[j]])
vc[j]˜dnorm(0,0.0001)
}
for (k in 1 :nsumph){weiph[k]<-1}
uph[1:18]˜car.normal(adj[],weiph[],num[],tauph)
#tau.vph<-1/pow(sdvph,2)
tauph<-1/pow(sdph,2)
aph0˜dﬂat()
#sdvph˜dunif(0,100)
sdph˜dunif(0,100)
for (o in 1 :nsumc){weic[o]<-1}
uc[1:159]˜car.normal(adj2[],weic[],num2[],tauc)
#tau.vc<-1/pow(sdvc,2)
tauc<-1/pow(sdc,2)
ac0˜dﬂat()
#sdvc˜dunif(0,100)
sdc˜dunif(0,100) }
B.10
Code for the Shared Component Model for Geor-
gia Asthma and COPD (Chapter 9)
The joint shared component model for asthma and COPD in Georgia counties
MODEL{
for(i in 1:N){
asthma[i]˜dpois(Muas[i])
log(Muas[i])<-log(Easthma[i])+log(thetAS[i])
log(thetAS[i])<-b0+Was[i]+Wcom[i]*delta
COPD[i]˜dpois(MuC[i])
log(MuC[i])<-log(ECOPD[i])+log(thetCOPD[i])
log(thetCOPD[i])<-b1+Wcom[i]/delta
angina1[i]<-angina[i]
Eangina1[i]<-Eangina[i]
}
delta<-exp(sdf)
sdf˜dnorm(0,5.88)
for( i in 1:sumNumNeigh){weights[i]<-1}
Wcom[1:N]˜car.normal(adj[],weights[],num[],tWcom)
Was[1:N]˜car.normal(adj[],weights[],num[],tWas)
b0˜dﬂat()
b1˜dﬂat()

Selected WinBUGS Code
315
tWcom<-pow(sdWcom,-2)
sdWcom˜dunif(0,100)
tWas<-pow(sdWas,-2)
sdWas˜dunif(0,100) }
B.11
Code for the Seizure Example with Spatial Eﬀect
(Chapter 10)
The seizure longitudinal example with a spatial contextual eﬀect w
model{
for(i in 1:59){
y[i,1]<-t1[i]
y[i,2]<-t2[i]
y[i,3]<-t3[i]
y[i,4]<-t4[i]
}
ep[1]˜dnorm(0,0.0001)
for (i in 1:59){
for (k in 1:4){
y[i,k]˜dpois(mu[i,k])
log(mu[i,k])<-log(baseC[i])+alp0+alp1*group[i]+alp2*age[i]+ep[k]+w[ind[i]]
}}
for (k in 2:4){
ep[k]˜dnorm(ep[k-1],alp3)}
alp0˜dﬂat()
alp1˜dnorm(0,0.0001)
alp2˜dnorm(0,0.0001)
alp3˜dgamma(0.001,0.001)
w[1:46]˜car.normal(adj[],weights[],num[],tauW)
for (i in 1:sumNumNeigh){weights[i]<-1}
tauW<-pow(sdW,-2)
sdW˜dunif(0,100)}}

316
Bayesian Disease Mapping
B.12
Code for the Knorr-Held Model for Space–Time
Relative Risk Estimation (Chapter 11)
This is a space-time model for the VLBW example from Georgia with a time
dependent temporal eﬀect and time dependent interaction term.
model{
for (i in 1:159){
for (j in 1: 11){
vlbw[i,j]˜dbin(p[i,j],birth[i,j])
logit(p[i,j])<-a0+v[i]+u[i]+g[j]+psi[i,j]
}
psi[i,1]˜dnorm(0,taupsi)
for (j in 2:11){
psi[i,j]˜dnorm(psi[i,j-1],taupsi)}
v[i]˜dnorm(0,tauv)
}
u[1:159]˜car.normal(adj[], weights[], num[], tauu)
for(k in 1:sumNumNeigh) {
weights[k] <- 1}
g[1]˜dnorm(0,0.0001)
time1[1]<-time[1]-1993
for (j in 2: 11){
g[j]˜dnorm(g[j-1],tau.g)
time1[j]<-time[j]-1993}
taupsi<-1/pow(sdpsi,2)
sdpsi˜dunif(0,100)
tau.g<-1/pow(sdg,2)
sdg˜dunif(0,100)
tauu<-1/pow(sdu,2)
sdu˜dunif(0,100)
tauv<-1/pow(sdv,2)
sdv˜dunif(0,100)
a0˜dﬂat()}
B.13
Code
for
the
Space–Time
Autologistic
Model
(Chapter 11)
This is the ST autologistic model with temporally dependent intercept and
slope parameters for the neighbor sum terms

Selected WinBUGS Code
317
model
{
for (i in 1:m)
{
logit(p[i,1])<-a[1]+b[1]*ys1[i,1]
ypred[i,1]˜dbern(p[i,1])
diﬀ[i,1]<-pow(y[i,1]-ypred[i,1],2)
for (k in 2:T)
{
y[i,k]˜dbern(p[i,k])
logit(p[i,k])<-a[k]+b[k]*ys1[i,k]+c[k]*ys1[i,(k-1)]
ypred[i,k]˜dbern(p[i,k])
diﬀ[i,k]<-pow(y[i,k]-ypred[i,k],2)
}
}
for (k in 1:T){
a[k] ˜dnorm(0,0.01)
b[k] ˜dnorm(0,0.01)
c[k] ˜dnorm(0,0.01)
}
mspe<-mean(diﬀ[,])
}


C
R Code for Thematic Mapping
The following R code was developed by Bo Cai and can be used to produce
thematic maps from ArcView shapeﬁles on R. The function is called ﬁllmap
and must be called with a complete set of ArcView .shp, .sbn, .dbf, .shx ﬁles
resident in the active work directory.
ﬁllmap<-function(map, ﬁgtitle, y , n.col, bk=”e”, cuts,legendtxt=””, legend-
pos=c(466000,4330000), titlepos=c(350000,4650000)){
polylist<- Map2poly(map)
if(bk==”q”){p <- seq(0,1, length=n.col+1)
br <- round(quantile(y, probs=p),2)}
if(bk==”e”){br <- round(seq(min(y), max(y), length=n.col+1),2)}
if(bk==”c”){if (length(cuts)!= (n.col+1)) {cat(”Cut oﬀand color categories
do not match. ”, ”\n”)
break} else {br <- cuts} }
# 0: dark 1: light light Current shading ranges from darkest to light gray white
(to distinguish with lakes).
shading<-gray((n.col-1):0/(n.col-1))
y.grp<-ﬁndInterval(y, vec=br, rightmost.closed = TRUE, all.inside = TRUE)
y.shad<-shading[y.grp]
plot.polylist(polylist,col=y.shad,axes=F)
br<-round(br, 2)
if (legendtxt==””)
{
cn<-length(y[y>=br[n.col]]) # number of regions in this intervals
leg.txt<-paste(”[”,br[n.col],”,”,br[n.col+1],”]”,”(”,cn,”)”,sep=””)
for(i in (n.col-1):1){
cn<-length(y[(y>=br[i])&(y<=br[i+1])])
leg.txt<-append(leg.txt,paste(”[”,br[i],”,”,br[i+1],”)”,”(”,cn,”)”,sep=””)) }
leg.txt<-rev(leg.txt)
} else {leg.txt<-legendtxt}
legend(legendpos[1],legendpos[2],legend=leg.txt,ﬁll=shading,cex=0.7,ncol=1,bty=”n”)
text(titlepos[1],titlepos[2], ﬁgtitle, cex=1.2)}
319

320
Bayesian Disease Mapping
Calling the function
1) Load libraries: foreign, maptools, and sp
>library(foreign)
>library(sp)
>library(maptools)
2) To call the routine for the Georgia shapeﬁle with 159 counties with values
generated from a Gaussian distribution with mean 1 and standard deviation
0.1:
>x<-read.shape(”Georgia.shp”)
>y<-rnorm(159,1,.1)
>maintitle<-paste(””)
>ﬁllmap(x,maintitle,y,n.col=5)
This produced the ﬁgure below:

References
Agarwal, D., A. Gelfand, and S. Citron-Pousty (2002). Zero-inﬂated mod-
els with application to spatial count data. Environmental and Ecological
Statistics 9, 341–355.
Anto, J. and J. Sunyer (1990). Epidemiological studies of asthma epidemics
in Barcelona. Chest 98, 185–190.
Arya, S. P. (1998). Air Pollution Metereology and Dispersion. New York:
Oxford University Press.
Baddeley, A. and R. Turner (2000). Practical maximum pseudolikelihood for
spatial point patterns. Australia and New Zealand Journal of Statistics 42,
283–322.
Baddeley, A., R. Turner, J. Møller, and M. Hazelton (2005). Residual analysis
for spatial point processes. Journal of the Royal Statistical Society B 67,
617–666, with discussion.
Balakrishnan, S. and D. Madigan (2006). Algorithms for sparse linear classi-
ﬁers in the massive data setting. Journal of Machine Learning Research 1.
Banerjee, S. and B. P. Carlin (2003). Semiparametric spatio-temporal frailty
modeling. Environmetrics 14, 523–535.
Banerjee, S., B. P. Carlin, and A. E. Gelfand (2004). Hierarchical Modeling
and Analysis for Spatial Data. London: Chapman and Hall/CRC Press.
Banerjee, S., M. M. Wall, and B. P. Carlin (2003).
Frailty modeling for
spatially correlated survival data, with application to infant mortality in
Minnesota. Biostatistics 4, 123–142.
Bankman, I. (Ed.) (2007). Handbook of Medical Image Processing and Analysis
(2nd ed.), Volume 1. New York: Academic Press.
Barndorﬀ-Nielsen, O. E., W. S. Kendall, and M. N. M. van Lieshout
(1999). Stochastic Geometry: Likelihood and Computation. Boca Raton,
FL: Chapman & Hall.
Bastos, L. and D. Gamerman (2006). Dynamical survival models with spatial
frailty. Lifetime Data Analysis 12, 441–460.
321

322
References
Berman, M. and T. R. Turner (1992). Approximating point process likelihoods
with GLIM. Applied Statistics 41, 31–38.
Bernardinelli, L., D. G. Clayton, C. Pascutto, C. Montomoli, M. Ghislandi,
and M. Songini (1995). Bayesian analysis of space-time variation in disease
risk. Statistics in Medicine 14, 2433–2443.
Bernardo, J. M. and A. F. M. Smith (1994). Bayesian Theory. New York:
Wiley.
Besag, J. (1975). Statistical analysis of non-lattice data. The Statistician 24,
179–195.
Besag, J. and P. J. Green (1993). Spatial statistics and Bayesian computation.
Journal of the Royal Statistical Society, Series B 55, 25–37.
Besag, J. and J. Newell (1991). The detection of clusters in rare diseases.
Journal of the Royal Statistical Society, Series A 154, 143–155.
Besag, J. and J. Tantrum (2003). Likelihood analysis of binary data in space
and time. In P. Green, N. Hjort, and S. Richardson (Eds.), Highly Structured
Stochastic Systems, Chapter 9A, 289–295. New York: Oxford University
Press.
Besag, J., J. York, and A. Molli´e (1991). Bayesian image restoration with
two applications in spatial statistics. Annals of the Institute of Statistical
Mathematics 43, 1–59.
Best, N., S. Richardson, and A. Thomson (2005). A comparison of Bayesian
spatial models for disease mapping.
Statistical Methods in Medical Re-
search 14, 35–59.
Best, N. G. and J. C. Wakeﬁeld (1999). Accounting for inaccuracies in pop-
ulation counts and case registration in cancer mapping studies. Journal of
the Royal Statistical Society A 162, 363–382.
Bishop, C. (2006). Pattern Recognition and Machine Learning. New York:
Springer.
Boehning, D., E. Dietz, and P. Schlattmann (2000). Space-time mixture mod-
elling of public health data. Statistics in Medicine 19, 2333–2344.
Boehning, D., E. Dietz, P. Schlattmann, L. Mendonca, and U. Kirchner (1999).
The zero-inﬂated poisson model and the decayed, missing and ﬁlled teeth
index in dental epidemiology. Journal of the Royal Statistical Society A 162,
195–209.
Bottai, M., M. Geraci, and A. Lawson (2007). Testing for unusual aggrega-
tion of health risk in semiparametric models. Statistics in Medicine. DoI:
10/1002/sim.3126.

References
323
Bowman, A. and A. Azzalini (1997). Applied Smoothing Techniques for Data
Analysis: the Kernel Approach with S-Plus Illustrations. New York: Oxford
University Press.
Breslow, N. and D. G. Clayton (1993). Approximate inference in generalised
linear mixed models. Journal of the American Statistical Association 88,
9–25.
Brix, A. and P. Diggle (2001). Spatio-temporal prediction for log-gaussian
cox processes. Journal of the Royal Statistical Society B 63, 823–841.
Brooks, S. and A. E. Gelman (1998). General methods for monitoring con-
vergence of iterative simulations. Journal of Computational and Graphical
Statistics 7, 434–455.
Brooks, S., P. Guidici, and A. Philippe (2003). Nonparamteric convergence
assessment for mcmc model selection. Journal of Computational and Graph-
ical Statistics 12, 1–22.
Brooks, S. P. (1998). Quantitative convergence assessment for MCMC via
Cusums. Statistics and Computing 8, 267–274.
Buckland, S. T., D. R. Anderson, K. P. Burnham, J. L. Laake, D. L. Borchers,
and L. Thomas (2001).
Introduction to Distance Sampling.
New York:
Oxford University Press.
Byers, S. and A. Raftery (2002). Bayesian estimation and segmentation of spa-
tial point processes using voronoi tilings. In A. B. Lawson and D. Denison
(Eds.), Spatial Cluster Modelling, Chapter 6. New York: CRC Press.
Cai, B. and D. Dunson (2008). Bayesian variable selection in nonparametric
random eﬀects models. submitted.
Cai, B. and A. B. Lawson (2008). Space-time latent structure models with
gam-like covariate linkage. submitted.
Caragea, P. and M. Kaiser (2006). Covariates and time in the autologistic
model. Technical Report 2006-19, Iowa State University, Department of
Statistics.
Carlin, B. P. and J. Hodges (1999). Hierarchical proportional hazards regres-
sion models for highly stratiﬁed data. Biometrics 55, 1162–1170.
Carlin, B. P. and T. Louis (2000). Bayes and Empirical Bayes Methods for
Data Analysis (2nd ed.). New York: Chapman & Hall/CRC Press.
Carroll, R., D. Ruppert, L. Stefanski, and C. Crainiceanu (2006). Measure-
ment Error in Nonlinear Models (2nd ed.). New York: Chapman & Hall.
Cassella, G. and E. I. George (1992). Explaining the Gibbs Sampler. The
American Statistician 46, 167–174.

324
References
Chaix, B., M. Rosvall, J. Lynch, and J. Merlo (2006). Disentangling contextual
eﬀects on cause speciﬁc mortality in a longitudinal 23-year follow-up study:
impact of population density or socio-economic environment? International
Journal of Epidemiology 35, 633–643.
Clark, A. B. and A. B. Lawson (2002). Spatio-temporal cluster modelling of
small area health data. In A. B. Lawson and D. Denison (Eds.), Spatial
Cluster Modelling, Chapter 14, 235–258. New York: CRC Press.
Clayton, D. G. and L. Bernardinelli (1992). Bayesian methods for mapping
disease risk. In P. Elliott, J. Cuzick, D. English, and R. Stern (Eds.), Geo-
graphical and Environmental Epidemiology: Methods for Small-Area Stud-
ies. Oxford: Oxford University Press.
Clayton, D. G., L. Bernardinelli, and C. Montomoli (1993). Spatial correlation
in ecological analysis. International Journal of Epidemiology 22, 1193–1202.
Clayton, D. G. and J. Kaldor (1987).
Empirical Bayes estimates of age-
standardised relative risks for use in disease mapping. Biometrics 43, 671–
691.
Cliﬀ, A. D. and J. K. Ord (1981). Spatial Processes: Models and Applications.
London: Pion.
Congdon, P. (2003). Applied Bayesian Modelling. New York: Wiley.
Congdon, P. (2005). Bayesian Models for Categorical Data. New York: Wiley.
Congdon, P. (2007). Bayesian Statistical Modelling (2nd ed.). New York:
Wiley.
Congdon, P., M. Almog, S. Curtis, and R. Ellerman (2007). A spatial struc-
tural equation modelling framework for health count responses. Statistics
in Medicine 26, 5267–5284.
Cook, R. and J. Lawless (2007). The Statistical Analysis of Recurrent Events.
New York: Springer.
Cooner, F., S. Banerjee, and M. McBean (2006). Modelling geographically
referenced survival data with a cure fraction. Statistical Methods in Medical
Research 15(4), 307–324.
Cowles, M. K. (2004). Review of WinBUGS 1.4. The American Statistician
58, 330–336.
Cressie, N., S. Richardson, and I. Jaussent (2004).
Ecological bias: use
of maximum-entropy approximations. Australia New Zealand Journal of
Statistics 46, 233–255.
Cressie, N. A. C. (1993). Statistics for Spatial Data (revised ed.). New York:
Wiley.

References
325
Cressie, N. A. C. (1996). Change of support and the modiﬁable areal unit
problem. Geographical Systems 2, 83–101.
Cressie, N. A. C. and A. Mugglin (2000). Spatio-temporal hierarchical mod-
elling of an infectious disease from (simulated) count data. In J. Bethle-
hem and P. van der Heijden (Eds.), Compstat 2000. Heidelberg: Physica
verlag.
Cressie, N. C. and A. Lawson (2000). Hierarchical probability models and
Bayesian analysis of mine locations. Advances in Applied Probability 32(2),
315–330.
Dabney, A. and J. Wakeﬁeld (2005). Issues in the mapping of two diseases.
Statistical Methods in Medical Research 14, 83–112.
Davison, A. C. and D. V. Hinkley (1997). Bootstrap Methods and their Ap-
plication. London: Cambridge University Press.
Dellaportas, P., J. Forster, and I. Ntzoufras (2002). On Bayesian model and
variable selection using mcmc. Statistics and Computing 12, 27–36.
Denison, D., N. Adams, C. Holmes, and D. Hand (2002). Bayesian partition
modelling. Computational Statistics and Data Analysis 38, 475–485.
Denison, D. and C. Holmes (2001). Bayesian partitioning for estimating dis-
ease risk. Biometrics 57, 143–149.
Denison, D., C. Holmes, B. Mallick, and A. Smith (2002). Bayesian Methods
for nonlinear Classiﬁcation and Regression. New York: Wiley.
Diggle, P. (2007). Spatio-temporal point processes: Methods and applications.
In B. Finkenst¨adt, L. Held, and V. Isham (Eds.), Statistical Methods for
Spatio-Temporal Systems, Chapter 1, 1–45. London: CRC Press.
Diggle, P. and P. Elliott (1995). Statistical issues in the analysis of disease risk
near point sources using individual or spatially aggregated data. Journal
of Epidemiology and Community Health 49, s20–s27.
Diggle, P., T. Fiksel, Y. Ogata, D. Stoyan, and M. Tanemura (1994). On
parameter estimation for pairwise interaction processes. International Sta-
tistical Review 62, 99–117.
Diggle, P., P. Heagerty, K.-Y. Liang, and S. Zeger (2002). Analysis of Longi-
tudinal Data (2 ed.). New York: Oxford University Press.
Diggle, P., S. Morris, P. Elliott, and G. Shaddick (1997). Regression modelling
of disease risk in relation to point sources. Journal of the Royal Statistical
Society, A 160, 491–505.
Diggle, P. and P. Ribeiro Jr. (2007). Model-based Geostatistics. New York:
Springer.

326
References
Diggle, P. and B. Rowlingson (1994). A conditional approach to point process
modelling of elevated risk. Journal of the Royal Statistical Society A 157,
433–440.
Diggle, P., P. Zheng, and P. Durr (2005). Nonparametric estimation of spatial
segregation in a multivariate point process: bovine tuberculosis in cornwall,
UK. Journal of the Royal Statistical Society C 54, 645–658.
Diggle, P. J. (1985).
A kernel method for smoothing point process data.
Journal of the Royal Statistical Society C 34, 138–147.
Diggle, P. J. (1990). A point process modelling approach to raised incidence
of a rare phenomenon in the vicinity of a prespeciﬁed point. Jour. Royal
Statist. Soc. A 153, 349–362.
Diggle, P. J. (2003). Statistical Analysis of Spatial Point Patterns (2nd ed.).
London: Arnold.
Diggle, P. J. (2005). Spatio-temporal point processes, partial likelihood, foot
and mouth disease. Statistical Methods in Medical Research 15, 325–336.
Diggle, P. J., S. Morris, and J. C. Wakeﬁeld (2000). Point-source modelling
using matched case-control data. Biostatistics 1, 1–17.
Diggle, P. J., J. Tawn, and R. Moyeed (1998). Model-based Geostatistics.
Journal of the Royal Statistical Society C 47, 299–350.
Duan, J., M. Guidani, and A. Gelfand (2007). Generalized spatial dirichlet
process models. Biometrika 94, 809–825.
Durr, P. and A. Gatrell (Eds.) (2004). GIS and Spatial Analysis in Veterinary
Science. London: Cabi.
Durr, P., N. Tait, and A. B. Lawson (2005). Bayesian hierarchical modelling to
enhance the epidemiological value of abattoir surveys for bovine fasciolosis.
Preventive Veterinary Medicine 71, 157–172.
Eberley, L. and B. P. Carlin (2000). Identiﬁability and convergence issues
for Markov chain Monte Carlo ﬁtting of spatial models.
Statistics in
Medicine 19, 2279–2294.
Elliott, P., J. Cuzick, D. English, and R. Stern (Eds.) (1992). Geographical
and Environmental Epidemiology:Methods for Small-Area Studies. Oxford
University Press.
Elliott, P., J. C. Wakeﬁeld, N. G. Best, and D. J. Briggs (Eds.) (2000). Spatial
Epidemiology: Methods and Applications. London: Oxford University Press.
Esman, N. A. and G. M. Marsh (1996). Applications and limitations of air
dispersion modeling in environmental epidemiology. Journal of Exposure
Analysis and Environmental Epidemiology 6, 339–353.

References
327
Faraway, J. (2006). Extending the Linear Model with R. New York: Chapman
& Hall/CRC.
Farnsworth, M., J. Hoeting, N. Hobbs, and M. Miller (2006). Linking chronic
wasting disease to mule deer movement: a hiererchical Bayesian approach.
Ecological Applications 16, 1026–1036.
Fernandez, C. and P. Green (2002). Modelling spatially correlated data via
mixtures: a Bayesian approach.
Journal of the Royal Statitsical Society
B 64, 805–826.
Ferreira, J., D. Denison, and C. Holmes (2002). Partition modelling. In A. B.
Lawson and D. Denison (Eds.), Spatial Cluster Modelling, Chapter 7, 125–
145. New York: CRC Press.
Fotheringham, A. S., C. Brunsdon, and M. Charlton (2002). Geographically
Weighted Regression : The Analysis of Spatially Varying Relationships. New
York: Wiley.
French, J. and M. Wand (2004). Generalized additive models for cancer map-
ping with incomplete covariates. Biostatistics 5, 177–191.
Gamerman, D. and H. Lopes (2006). Markov Chain Monte Carlo: Stochastic
Simulation for Bayesian Inference. New York: CRC Press.
Gangnon, R. (2006). Impact of prior choice on local Bayes factors for cluster
detection. Statistics in Medicine 25, 883–895.
Gangnon, R. and M. Clayton (2000). Bayesian detection and modeling of
spatial disease clustering. Biometrics 56, 922–935.
Gardner, M. J. (1989). Review of reported increases of childhood cancer rates
in the vicinity of nuclear installations in the UK.
Journal of the Royal
Statistical Society 152, 307–325.
Gelfand, A. and S. Ghosh (1998). Model choice: A minimum posterior pre-
dictive loss approach. Biometrika 85, 1–11.
Gelfand, A., A. Kottas, and S. MacEachern (2005). Bayesian nonparametric
spatial modeling with dirichlet process mixing. Journal of the American
Statistical Association 100, 1021–1035.
Gelfand, A. and P. Vounatsou (2003). Proper multivariate conditional autore-
gressive models for spatial data. Biostatistics 4, 11–25.
Gelman, A. (2006). Prior distributions for variance parameters in hierarchical
models. Bayesian Analysis 1, 515–533.
Gelman, A., J. B. Carlin, H. S. Stern, and D. Rubin (2004). Bayesian Data
Analysis. London: Chapman & Hall/CRC press.
Gelman, A. and J. Hill (2007). Data Analysis Using Regression and Multilevel-
Hierarchical Models. New York: Cambridge University Press.

328
References
Gelman, A. E. and D. Rubin (1992). Inference from iterative simulation using
multiple sequences (with discussion). Statistical Science 7, 457–511.
Geweke, J. (1992). Evaluating the accuracy of sampling -based approaches to
the calculation of posterior moments. In J. Bernardo, J. Berger, A. Dawid,
and A. Smith (Eds.), Bayesian Statistics 4. New York: Oxford University
Press.
Ghosh, M. and J. N. K. Rao (1994). Small area estimation: an appraisal.
Statistical Science 9, 55–93.
Ghosh, S., P. Mukhopadhyay, and J.-C. Lu (2006).
Bayesian analysis of
zero-inﬂated regression models.
Journal of Statistical Planning and In-
ference 136, 1360–1375.
Gilks, W. R., D. G. Clayton, D. J. Spiegelhalter, N. G. Best, A. J. McNeil,
L. D. Sharples, and A. J. Kirby (1993). Modelling complexity: Applications
of Gibbs Sampling in medicine.
Journal of the Royal Statistical Society
B 55, 39–52.
Gilks, W. R., S. Richardson, and D. J. Spiegelhalter (Eds.) (1996). Markov
Chain Monte Carlo in Practice. London: Chapman & Hall.
Gneiting, T., M. Genton, and P. Guttorp (2007). Geostatistical space-time
models, stationarity, separability, and full symmetry. In B. Finkenst¨adt,
L. Held, and V. Isham (Eds.), Statistical Methods for Spatio-Temporal Sys-
tems, Chapter 4, pp. 151–175. London: CRC Press.
Godsill, S. (2001). On the relationship between Markov chain Monte Carlo
methods for model uncertainty. Journal of Computational and Graphical
Statistics 10, 230–248.
Goldstein, H. and A. Leyland (2001). Further topics in multilevel modelling:
Context and composition. In A. Leyland and H. Goldstein (Eds.), Multilevel
Modelling of Health Statistics, Chapter 12.4, 181–186. New York: Wiley.
Greco, F., A. B. Lawson, D. Cocchi, and T. Temples (2005). Voronoi tesse-
lation and other methods for misaligned small area health data. Environ-
mental and Ecological Statistics 12, 379–395.
Green, P. J. (1995). Reversible jump MCMC computation and Bayesian model
determination. Biometrika 82, 711–732.
Green, P. J. and S. Richardson (2002). Hidden Markov models and disease
mapping. Journal of the American Statitsical Association 97, 1055–1070.
Greenland, S. (1992). Divergent biases in ecologic and individual-level studies.
Statistics in Medicine 11, 1209–1223.
Greenland, S. and J. Robins (1994). Ecologic studies—biases, misconceptions
and counterexamples. American Journal of Sociology 139, 747–759.

References
329
Griﬃn, J. and M. Steel (2006). Order-based dependent Dirichlet processes.
Journal of the American Statistical Asociation 101, 179–194.
Gustafson, P. (1998). Flexible Bayesian modelling for survival data. Lifetime
Data Analysis 4, 281–299.
Gustafson, P. (2004). Measurement Error and Misclassiﬁcation in Statistics
and Epidemiology. London: Chapman & Hall.
Heagerty, P. and S. Lele (1998). A composite likelihood approach to binary
spatial data. Journal of the American Statistical Association 93, 1099–1111.
Hegarty, A. and D. Barry (2008). Bayesian disease mapping using product
partition models. Statistics in Medicine (to appear).
Heisterkamp, S., G. Doornbos, and N. Nagelkerke (2000). Assessing health im-
pact of environmental pollution sources using space-time models. Statistics
in Medicine 19, 2569–2578.
Held, L., I. Natario, S. Fenton, H. Rue, and N. Becker (2005). Towards joint
disease mapping. Statistical Methods in Medical Research 14, 61–82.
Henderson, R., S. Shimakura, and D. Gorst (2002). Modeling spatial varia-
tion in leukemia survival data. Journal of the American Statistical Associ-
ation 97, 965–972.
H¨ohle, M., E. Jorgensen, and P. O’Neill (2005). Inference in disease transmis-
sion experiments by using stochastic epidemic models. Journal of the Royal
Statistical Society C 54, 349–366.
Hossain, M. and A. Lawson (2008). Approximate methods in Bayesian point
process spatial models. submitted.
Hossain, M. and A. B. Lawson (2005). Local likelihood disease clustering:
Development and evaluation. Environmental and Ecological Statistics 12,
259–273.
Hossain, M. and A. B. Lawson (2006). Cluster detection diagnostics for small
area health data: with reference to evaluation of local likelihood models.
Statistics in Medicine 25, 771–786.
Ibrahaim, J., M. Chen, and D. Sinha (2000). Bayesian Survival Analysis. New
York: Springer.
Inskip, H., V. Beral, P. Fraser, and P. Haskey (1983).
Methods for age-
adjustment of rates. Statistics in Medicine 2, 483–493.
Ishwaran, H. and L. James (2001). Gibbs sampling methods for stick-breaking
priors. Journal of the American Statistical Association 96, 161–173.
Ishwaran, H. and L. James (2002). Approximate Dirichlet process computing
in ﬁnite normal mixtures: Smoothing and prior information. Journal of
Computational and Graphical Statistics 11, 1–26.

330
References
Jin, X., S. Banerjee, and B. Carlin (2008). Order-free coregionalized areal
data models with application to multiple disease mapping. Journal of the
Royal Statistical Society B. (to appear).
Jin, X., B. Carlin, and S. Banerjee (2005). Generalized hierarchical multivari-
ate car models for areal data. Biometrics 61, 950–961.
Kauermann, G. and J. D. Opsomer (2003). Local likelihood estimation in
generalized additive models. Scandinavian Journal of Statistics 30, 317–
337.
Kelsall, J. and P. Diggle (1998). Spatial variation in risk of disease: a non-
parametric binary regression approach. Applied Statistics 47, 559–573.
Kelsall, J. and J. Wakeﬁeld (2002).
Modelling spatial variation in disease
risk: A geostatistical approach. Journal of the American Statitsical Associ-
ation 97, 692–701.
Kim, H., D. Sun, and T. R (2001). A bivariate bayes method for improving the
estimates of mortiality rates with a twofold autoregressive model. Journal
of the American Statistical Association 96, 1506–1521.
Kim, S., M. Tadesse, and M. Vanucci (2006). Variable selection in clustering
via Dirichlet process mixture models. Biometrika 93, 877–893.
Knorr-Held, L. (2000). Bayesian modelling of inseparable space-time variation
in disease risk. Statistics in Medicine 19, 2555–2567.
Knorr-Held, L. and J. Besag (1998). Modelling risk from a disease in time
and space. Statistics in Medicine 17, 2045–2060.
Knorr-Held, L. and N. G. Best (2001). A shared component model for de-
tecting joint and selective clustering of two diseases. Journal of the Royal
Statistical Society 164, 73–85.
Knorr-Held, L. and G. Rasser (2000).
Bayesian detection of clusters and
discontinuities in disease maps. Biometrics 56, 13–21.
Knorr-Held, L. and S. Richardson (2003). A hierarchical model for space-time
surveillance data on meningococcal disease incidence. Journal of the Royal
Statistical Society 52, 169–183.
Kottas, A., J. Duan, and A. Gelfand (2007). Modelling disease incidence data
with spatial and spatio-temporal dirichlet process mixtures. Biometrical
Journal 49(5), 1–14.
Kulldorﬀ, M. and N. Nagarwalla (1995). Spatial disease clusters: detection
and inference. Statistics in Medicine 14, 799–810.
Kunsch, H. (1987). Intrinsic autoregressions and related models on the two-
dimensional lattice. Biometrika 74, 517–524.

References
331
Kuo, L. and B. Mallick (1998).
Variable selection for regression models.
Sankhya 60, 65–81.
Lachin, J. L. (2000). Statistical considerations in the intent-to-treat principle.
Controlled Clinical Trials 21, 167–189.
Lambert, D. (1992). Zero-inﬂated poisson regression, with application to de-
fects in manufacturing. Technometrics 34, 1–14.
Lambert, P., A. Sutton, P. Burton, K. Abrams, and P. Jones (2005). How
vague is vague? A simulation study of the impact of the use of vague prior
distributions in mcmc using winbugs. Statistics in Medicine 24, 2401–2428.
Lawson, A. B. (1992a). GLIM and normalising constant models in spatial and
directional data analysis. Computational Statistics and Data Analysis 13,
331–348.
Lawson, A. B. (1992b). On ﬁtting non-stationary markov point processes on
glim. In Y. Dodge and J. Whittacker (Eds.), Computational Statistics I.
Physica Verlag.
Lawson, A. B. (1993a). A deviance residual for heterogeneous spatial Poisson
processes. Biometrics 49, 889–897.
Lawson, A. B. (1993b). On the analysis of mortality events around a prespec-
iﬁed ﬁxed point. Journal of the Royal Statistical Society A 156, 363–377.
Lawson, A. B. (1995).
Markov chain Monte Carlo methods for putative
pollution source problems in environmental epidemiology.
Statistics in
Medicine 14, 2473–2486.
Lawson, A. B. (1996). Use of deprivation indices in small area studies: letter.
Journal of Epidemiology and Community Health 50, 689–690.
Lawson, A. B. (2000).
Cluster modelling of disease incidence via rjmcmc
methods: a comparative evaluation. Statistics in Medicine 19, 2361–2376.
Lawson, A. B. (2001). Statistical Methods in Spatial Epidemiology. New York:
Wiley.
Lawson, A. B. (2002). The analysis of putative sources of health hazard. In
D. Zimmerman (Ed.), Encyclopedia of Life Support Systems. UNESCO.
Lawson, A. B. (2004). Some issues in the spatio-temporal analysis of public
health surveillance data. In R. Brookmeyer and D. Stroup (Eds.), Monitor-
ing the Health of Populations: Statistical Principles and Methods for Public
Health Surveillance, Chapter 11, pp. 289–314. New York: Oxford University
Press.
Lawson, A. B. (2006a). Disease cluster detection: a critique and a Bayesian
proposal. Statistics in Medicine 25, 897–916.

332
References
Lawson, A. B. (2006b). Statistical Methods in Spatial Epidemiology (2nd ed.).
New York: Wiley.
Lawson, A. B. and S. Banerjee (2008). Bayesian spatial analysis. In S. Fother-
ingham and P. Rogerson (Eds.), Handbook of Spatial Analysis, Chapter 9.
New York: Sage.
Lawson, A. B., A. Biggeri, D. Boehning, E. Lesaﬀre, J.-F. Viel, A. Clark,
P. Schlattmann, and F. Divino (2000). Disease mapping models: An empir-
ical evaluation. Statistics in Medicine 19, 2217–2242. special issue: Disease
Mapping with emphasis on evaluation of methods.
Lawson, A. B., A. Biggeri, and E. Dreassi (1999). Edge eﬀects in disease
mapping. In A. B. Lawson, D. B´’ohning, E. Lesaﬀre, A. Biggeri, J.-F. Viel,
and R. Bertollini (Eds.), Disease Mapping and Risk assessment for Public
Health, Chapter 6, 85–97. New York: Wiley.
Lawson, A. B., D. B¨ohning, E. Lessafre, A. Biggeri, J. F. Viel, and R. Bertollini
(Eds.) (1999). Disease Mapping and Risk Assessment for Public Health.
Chichester: Wiley.
Lawson, A. B., W. J. Browne, and C. L. Vidal-Rodiero (2003). Disease Map-
ping with WinBUGS and MLwiN. New York: Wiley.
Lawson, A. B. and A. Clark (1999a). Markov chain Monte Carlo methods for
clustering in case event and count data in spatial epidemiology. In M. E.
Halloran and D. Berry (Eds.), Statistics and Epidemiology: Environment
and Clinical Trials, pp. 193–218. New York: Springer Verlag.
Lawson, A. B. and A. Clark (1999b). Markov chain Monte Carlo methods
for putative sources of hazard and general clustering. In A. B. Lawson,
D. B¨ohning, E. Lesaﬀre, A. Biggeri, J.-F. Viel, and R. Bertollini (Eds.),
Disease Mapping and Risk Assessment for Public Health, Chapter 9, 119–
141. Wiley.
Lawson, A. B. and A. Clark (2002).
Spatial mixture relative risk models
applied to disease mapping. Statitsics in Medicine 21, 359–370.
Lawson, A. B. and D. Denison (2002). Spatial cluster modelling: an overview.
In A. B. Lawson and D. Denison (Eds.), Spatial Cluster Modelling, Chap-
ter 1, pp. 1–19. New York: CRC press.
Lawson, A. B. and P. Leimich (2000). Approaches to space-time modelling
of infectious disease behaviour.
IMA journal of Mathematics applied to
Medicine and Biology 17, 1–13.
Lawson, A. B. and J.-F. Viel (1995). Tests for directional space-time interac-
tion in epidemiological data. Statistics in Medicine 14, 2383–2392.
Lawson, A. B. and F. Williams (2000).
Spatial competing risk models in
disease mapping. Statistics in Medicine 19, 2451–2468.

References
333
Lawson, A. B. and F. L. R. Williams (2001). An Introductory Guide to Disease
Mapping. New York: Wiley.
Lawson, A. B. and H. Zhou (2005). Spatial statistical modeling of disease
outbreaks: with particular reference to the UK FMD epidemic of 2001.
Preventive Veterinary Medicine 71, 141–156.
Leonard, T. and H. Hsu (1999).
Bayesian Methods.
London: Cambridge
University Press.
Leyland, A. and H. Goldstein (Eds.) (2001). Multilevel Modelling in Health
Statistics. London: Wiley.
Lindsay, B. G. (1988). Composite likelihood methods. Contemporary Mathe-
matics 80, 221–238.
Little, R. and D. Rubin (2002). Statistical Analysis with Missing Data. New
York: Wiley.
Liu, J. S. (2001). Monte Carlo Strategies in Scientiﬁc Computing. New York:
Springer.
Liu, X., M. Wall, and J. Hodges (2005). Generalised spatial structural equa-
tion models. Biostatistics 6, 539–557.
Louie, M. M. and E. D. Kolaczyk (2006). Multiscale detction of localised
anomalous structure in aggregate disease incidence data.
Statistics in
Medicine 25, 787–810.
Lu, H. and B. Carlin (2005). Bayesian areal wombling for geographical bound-
ary analysis. Geographical Analysis 37, 265–285.
Ma., B., A. B. Lawson, and Y. Liu (2007). Evaluation of Bayesian models for
focused clustering in health data. Environmetrics 18, 1–16.
Ma, H., B. Carlin, and S. Banerjee (2006). Hierarchical and joint site edge
methods for medicare hospice service region boudary analysis. submitted.
Macnab, Y. (2007). Spline smoothing in Bayesian disease mapping. Environ-
metrics 18, 727–744.
Maheswaran, R. and M. Craglia (Eds.) (2004). GIS in Public Health Practice.
New York: CRC press.
Maindonald, J. and J. Braun (2003). Data Analysis and Graphics Using R.
New York: Cambridge University Press.
Marin, J.-M. and C. Robert (2007). Bayesian Core: A Practical Approach to
Computational Bayesian Statistics. New York: Springer.
McCullagh, P. and J. Nelder (1989). Generalised Linear Models (2nd ed.).
London: Chapman & Hall.

334
References
McKeague, I. and M. Loiseaux (2002). Perfect sampling for point process
cluster modelling. In A. B. Lawson and D. Denison (Eds.), Spatial Cluster
Modelling, Chapter 5. New York: CRC Press.
Mira, A., J. Moller, and G. Roberts (2001). Perfect slice samplers. Journal
of the Royal Statistical Society B 63, 583–606.
Molenberghs, G. and G. Verbeke (2005). Models for Discrete Longitudinal
Data. New York: Springer.
M´oller, J. and O. Skare (2001). Coloured voronoi tesselations for Bayesian
image analysis and reservoir modelling. Statistical Modelling 1, 213–232.
Møller, J., A. Syversveen, and R. P. Waagepetersen (1998). Log Gaussian Cox
processes. Scandinavian Journal of Statistics 25, 451–482.
M´oller, J. and R. Waagepetersen (1998). Markov connected component ﬁelds.
Advances in Applied Probability 30, 1–35.
M´oller, J. and R. Waagpetersen (2004). Statistical Inference and Simulation
for Spatial Point Processes. New York: CRC Press.
Morgan, O., M. Vreiheid, and H. Dolk (2004). Risk of low birth weight near
eurohazcon hazardous waste landﬁll sites in england. Archives of Environ-
mental Health 59, 149–151.
Morton, A. and B. Finkenst¨adt (2005). Discrete time modelling of disease
incidence time series by using Markov chain Monte Carlo methods. Journal
of the Royal Statistical Society C 54, 575–594.
Mugglin, A., N. Cressie, and I. Gemmel (2002). Hierarchical statistical mod-
elling of inﬂuenza epidemic dynamics in space and time.
Statitsics in
Medicine 21, 2703–2721.
Neal, P. and G. Roberts (2004). Statistical inference and model selection for
the 1861 hagelloch measles epidemic. Biostatistics 5, 249–261.
Neal, R. M. (2003). Slice sampling. Annals of Statistics 31, 1–34.
Nott, D. J. and T. Ryd´en (1999). Pairwise likelihood methods for inference
in image models. Biometrika 86, 661–676.
Oden, N., R. Sokal, M. Fortin, and H. Goebl (1993). Categorical wombling:
Detecting regions of signiﬁcant change in spatially located categorical vari-
ables. Geographical Analysis 25(4).
O’Loughlin, J. (2002). The Electoral Geography of Weimar Germany: Ex-
ploratory Spatial Data Analyses (ESDA) of Protestant Support for the
Nazi Party. Political Analysis 10(3), 217–243.
Pfeiﬀer, D. U., T. P. Robinson, M. Stevenson, K. B. Stevens, D. J. Rogers,
and A. C. A. Clements (Eds.) (2008). Spatial Analysis in Epidemiology.
New York: Springer.

References
335
Plummer, M. and D. G. Clayton (1996). Estimation of population exposure
in ecological studies. Journal of the Royal Statistical Society B 58, 113–126.
Propp, J. and D. Wilson (1996). Exact sampling with coupled markov chains.
Random Structures and Algortithms 9, 223–252.
Rao, J. K. N. (2003). Small Area Estimation. New York: Wiley.
Richardson, S., A. Thomson, N. Best, and P. Elliott (2004).
Interpreting
posterior relative risk estimates in disease mapping studies. Environmental
Health Perspectives 112, 1016–1025.
Ripley, B. D. (1981). Spatial Statistics. New York: Wiley.
Ripley, B. D. (1987). Stochastic Simulation. New York: Wiley.
Ripley, B. D. (1988). Statistical Inference for Spatial Processes. New York:
Cambridge University Press.
Robert, C. and G. Casella (2005). Monte Carlo Statistical Methods (2nd ed.).
New York: Springer.
Royle, A. and M. Berliner (1999). A hierarchical approach to multivariate
spatial modeling and prediction.
Journal of Agricultural, Biological and
Environmental Statistics 4, 29–56.
Rue, H. and L. Held (2005). Gaussian Markov Random Fields: Theory and
Applications. New York: Chapman & Hall/CRC.
Salway, R. and J. Wakeﬁeld (2005). Sources of bias in ecological studies of
non-rare events. Environmental and Ecological Statistics 12, 321–347.
Schlattman, P. and D. B¨ohning (1993). Mixture models and disease mapping.
Statistics in Medicine 12, 1943–1950.
Smith, A. F. M. and A. E. Gelfand (1992). Bayesian statistics without tears:
A sampling-resampling perspective. American Statistician 46, 84–88.
Smith, A. F. M. and G. Roberts (1993). Bayesian computation via the Gibbs
Sampler and related Markov chain Monte Carlo methods. Journal of the
Royal Statistical Society B 55, 3–23.
Snow, J. (1854). On the Mode of Communication of Cholera (2nd ed.). Lon-
don: Churchill Livingstone.
Spiegelhalter, D., A. Thomas, N. Best, and D. Lunn (2007). WinBUGS man-
ual. Cambridge,UK: MRC Biostatistics Unit. version 1.4.3.
Spiegelhalter, D. J., N. G. Best, B. P. Carlin, and A. van der Linde (2002).
Bayesian deviance, the eﬀective number of parameters and the comparison
of arbitrarily complex models. Journal of the Royal Statistical Society B 64,
583–640.

336
References
Spiegelhalter, D. J., N. G. Best, W. R. Gilks, and H. Inskip (1996). Hepatitis
B: a case study in MCMC methods. In W. R. Gilks, S. Richardson, and
D. J. Spiegelhalter (Eds.), Markov Chain Monte Carlo in Practice. London:
Chapman & Hall.
Steele, F., H. Goldstein, and W. Browne (2004). A general multilevel multi-
state competing risks model for event history data, with an application to
a study of contraceptive use dynamics. Statistical Modelling 4, 145–159.
Stern, H. and Y. Jeon (2004). Applying structural equation models with in-
complete data. In A. Gelman and X.-L. Meng (Eds.), Applied Bayesain
Modeling and Causal Inference from Incomplete-Data Perspectives, Chap-
ter 30, 331–342. London: Wiley.
Stern, H. S. and N. A. C. Cressie (1999). Inference for extremes in disease
mapping. In A. B. Lawson, A. Biggeri, D. Boehning, E. Lesaﬀre, J. F. Viel,
and R. Bertollini (Eds.), Disease Mapping and Risk Assessment for Public
Health, Chapter 5. New York: Wiley.
Stern, H. S. and N. A. C. Cressie (2000). Posterior predictive model checks
for disease mapping models. Statistics in Medicine 19, 2377–2397.
Stevenson, M., R. Morris, A. B. Lawson, J. Wilesmith, J. M. Ryan, and
R. Jackson (2005). Area level risks for BSE in British cattle before and
after the July 1988 meat and bone meal feed ban. Preventive Veterinary
Medicine 69, 129–144.
Stevenson, M. A., R. S. Morris, A. B. Lawson, J. W. Wilesmith, J. B. M.
Ryan, and R. A. Jackson (2001). Spatial regression analysis of the bovine
spongiform encephalopathy epidemic in Great Britain. In A. C. Gatrell
and P. Durr (Eds.), The GISVET conference- Application of Geographical
Information Systems and Spatil Analysis to Veterinary Science, Lancaster.
Stevenson, M. A., J. W. Wilesmith, J. B. M. Ryan, R. S. Morris, A. B. Law-
son, D. U. Pfeiﬀer, and D. Lin (2000). Descriptive spatial analysis of the
epidemic of bovine spongiform encephalopathy in Great Britain to June
1997. Veterinary Record 147, 379–384.
Sturtz, S., U. Ligges, and A. Gelman (2005). R2WinBUGS: A package for
running WinBUGS from R. Journal of Statistical Software 12, 1–16.
Sun, D., R. Tsutakawa, H. Kim, and Z. He (2000). Spatio-temporal interaction
with disease mapping. Statistics in Medicine 19, 2015–2035.
Sutton, S. (2005). The modeling of spatially-referenced recurrent event data
in a South Carolina Population. PhD thesis, University of South Carolina.
Tanner, M. A. (1996). Tools for Statistical Inference (3rd ed.). New York:
Springer Verlag.

References
337
Thomas, A., N. Best, D. Lunn, R. Arnold, and D. Spiegelhalter (2004).
Geobugs user manual v 1.2. www.mrc-bsu.cam.ac.uk/bugs.
Tibshirani, R. and T. Hastie (1987). Local likelihood estimation. Journal of
the American Statistical Association 82, 559–568.
Tierney, L. and J. Kadane (1986).
Accurate approximations for posterior
moments and marginal densities. Journal of the American Statistical As-
sociation 81, 82–86.
van Lieshout, M. and A. Baddeley (2002). Extrapolating and interpolating
spatial patterns. In A. B. Lawson and D. Denison (Eds.), Spatial Cluster
Modelling, Chapter 4, 61–86. New York: CRC Press.
Varin, C., G. Høst, and Ø. Skare (2005). Pairwise likelihood infernce in spa-
tial generalized linear mixed models. Computational Statistics and Data
Analysis 49, 1173–1191.
Verbeke, G. and G. Molenberghs (2000). Linear Mixed Models for Longitudinal
Data. New York: Springer.
Vidal-Rodiero, C. L. and A. B. Lawson (2005). An evaluation of edge eﬀects
in disease mapping. Computational Statistics and Data Analysis 49, 45–62.
Voss, D. (2004). Using ecological inference for contextual research. In G. King,
O. Rosen, and M. Tanner (Eds.), Ecological Inference: New Methodological
Strategies, Chapter 3. New York: Cambridge University Press.
Wackernagel, H. (2003).
Multivariate Geostatistics (3rd ed.).
New York:
Springer.
Wakeﬁeld, J. and G. Shaddick (2006).
Health-exposure modeling and the
ecological fallacy. Biostatistics 7, 438–455.
Wakeﬁeld, J. C. and S. Morris (2001). The Bayesian modeling of disease risk
in relation to a point source. Journal of the American Statistical Associa-
tion 96, 77–91.
Waller, L. and C. Gotway (2004). Applied Spatial Statistics for Public Health
Data. New York: Wiley.
Waller, L. A., B. P. Carlin, H. Xia, and A. E. Gelfand (1997). Hierarchical
spatio-temporal mapping of disease rates. Journal of the American Statis-
tical Association 92, 607–617.
Wang, F. and M. Wall (2003). Generalized common spatial factor model.
Biostatitsics 4, 569–582.
Wikle, C. K. (2002). Spatial modelling of count data: A case study in mod-
elling breeding bird survey data on large spatial domains. In A. B. Lawson
and D. G. T. Denison (Eds.), Spatial Cluster Modelling, Chapter 11. Lon-
don: CRC Press.

338
References
Williams, F., A. Lawson, and O. Lloyd (1992). Low sex ratios of births in areas
at risk from air pollution from incinerators, as shown by geographical anal-
ysis and 3-dimensional mapping. International Journal of Epidemiology 21,
311–319.
Wolpert, R. L. and K. Ickstadt (1998). Poisson/gamma random ﬁeld models
for spatial statistics. Biometrika 85, 251–267.
Xia, H. and B. P. Carlin (1998). Spatio-temporal models with errors in co-
variates: Mapping Ohio lung cancer mortality. Statistics in Medicine 17,
2025–2043.
Yu, B. and P. Mykland (1998). Looking at Markov samplers through cusum
path plots: A simple diagnostic idea. Statistics and Computing 8, 275–286.
Zhang, S., D. Sun, C. He, and M. Schootman (2006).
A Bayesian semi-
parametric model for colorectal cancer incidences. Statistics in Medicine 25,
285–309.
Zhou, H., A. B. Lawson, J. Hebert, E. Slate, and E. Hill (2007). A Bayesian
hierarchical modeling approach for studying the factors aﬀecting the stage
at diagnosis of prostate cancer.
Statistics in Medicine 27(9).
DOI
10.1002/sim:3024.
Zhou, H., A. B. Lawson, J. Hebert, E. Slate, and E. Hill (2008). Joint spa-
tial survival modelling for the date of diagnosis and the vital outcome for
prostate cancer. Statistics in Medicine. to appear.
Zhu, L., B. Carlin, and A. Gelfand (2003). Hierarchical regression with mis-
aligned spatial data: relating ambient ozone and pediatric asthma er visits
in Atlanta. Environmetrics 14, 537–557.
Zhu, L. and B. P. Carlin (2000).
Comparing hierarchical models for
spatio-temporally misaligned data using the DIC criterion.
Statistics in
Medicine 19, 2265–2278.
Zia, H., B. P. Carlin, and L. A. Waller (1997). Hierarchical models for mapping
Ohio lung cancer rates. Environmetrics 8, 107–120.

Index
accelerated failure time models
AFT, 229
adaptive rejection sampling
ARS, 40
adjacent category logits model, 107
air pollution source, 165
Akaike information criterion
AIC, 55, 56
Auto models
binomial, 100
Logistic
space–time, 266
logistic, 21, 96, 126
Poisson, 21
autocorrelation
residual, 60
spatial, 20, 94
avian inﬂuenza, 276
baseline category logits model, 107
Bayes estimate, 29
Bayes Factor, 56
Bayesian information criterion
BIC, 56
Bayesian linear model, 79
Bayesian structural equation model,
163
Berkson error, 162, 174, 195–197
Berman-Turner integration scheme,
74, 89
Bernoulli model, 266
Beta mixtures, 232
bias
confounding, 159
contextual eﬀect, 159
eﬀect modiﬁcation, 159
measurement error, 159
binomial distribution, 274, 279
binomial model, 128, 260, 262
block eﬀects, 194
block updating, 40
Brooks-Gelman-Rubin statistic
BGR, 45, 298, 305
BRugs, 302
BSE epidemic, 276
CAR-Voronoi model, 195
censoring, 229
right, 230
center rate
parameter, 135
posterior marginal, 138
cholesky decomposition, 220
cluster centers, 133
cluster detection, 119, 130
cluster models, 133
Bayesian, 134
cluster process
Cox, 133
Neyman-Scott, 133
Poisson, 133
clustering
general, 133
hot spot, 120, 130
residual, 121
CODA package, 41, 283
comorbidity, 251
competing risk
model, 202, 248, 278
Conditional autoregressive models
improper
ICAR, 86, 108, 200
proper
PCAR, 88
339

340
Index
conditional logistic model, 75, 125,
177
conditional mark models, 245
conditional
predictive
ordinates,
63, 68
confounder eﬀect, 171, 181
conjugacy, 25, 82
conditional, 25
gamma-gamma, 34
contextual eﬀects, 162–164, 181,
186, 231, 248, 249
control disease, 167, 168, 211
convergence, 40
monitoring Metropolis-like sam-
plers, 46
multi-chain methods, 44
single chain methods, 41
convex hull, 143
convolution models, 91, 96, 146,
156, 157, 206, 239, 267,
276
correlation
cross-, 204, 216, 219
multivariate, 219
spatial, 20, 80
correlation function
exponential, 192
Mat´ern, 90, 231
power exponential, 90, 196,
231
separable, 256
count accumulation, 247
Covariance models
fully speciﬁed, 90
covariate acceleration, 229
credible interval, 36
cross-covariances, 219, 221
cusum plot, 42
data augmentation, 106
decoupling approximation, 172
Delauney triangulation, 49
dependence
nonseparable, 178, 180
deprivation indices, 163, 171
deviance, 41, 55
Deviance information criterion
DIC, 56, 57, 67, 92, 98
directed acyclic graph
DAG, 28, 33, 34
directional covariates, 78
directional eﬀect, 166, 170, 178,
180
Dirichlet distribution, 110
Dirichlet process, 244
Dirichlet process mixture models
DP, 111, 139, 271
Dirichlet tesselation, 49, 60, 89,
123, 139, 171, 195, 230,
257
dispersal models, 170
distance covariates , 78
distance eﬀect, 166, 180
Distance sampling, 281
dropout, 241
ecological analysis, 151
ecological bias, 158, 181, 185, 187,
194
edge detection, 149
derivative-based methods, 150
edge eﬀects
guard areas, 114
misalignment, 200
partition models, 145
space-time, 115
spatial, 111, 124, 171
edge weighting, 113
empirical Bayes method, 117
endpoint distribution
extreme value, 228
gamma, 228
log-normal, 228
Weibull, 228, 231, 279
epidemic curve, 279
epidemic period, 274
event history analysis, 243
exceedence probability, 55, 64, 69,
123, 130, 181, 264
expected predictive deviance

Index
341
EPD, 57
exposure model, 169
putative hazard, 169
Fernald example, 173
foot-and-mouth epidemic, 276
FMD, 273
frailty
correlated, 230–232
individual, 241, 248, 251
uncorrelated, 230, 236
Gamma process, 232, 244
Gaussian convolution, 178
Gaussian process
Model, 101, 192
multivariate, 219, 220
Spatial, 20, 85, 89, 133, 157,
168, 178, 192, 196, 204,
220, 230
spatio-temporal, 256
zero mean, 90
general linear mixed model, 237
generalised
linear
spatial
mod-
elling, 90
GeoBUGS, 294
geoR, 196
geoRglm, 46, 90
Geweke statistic, 41
Gibbs Sampler, 37, 136, 259
Gibbs sampler, 87
Gibbs updates, 38
goodness-of-ﬁt
diagnostics, 55, 92
measures, 55, 62
hazard
baseline, 232
cumulative, 232
hazard function, 228
hidden process models, 143
hierarchical model, 27
hull peeling, 112
hybrid-additive model, 170
hyperprior distribution, 28, 82, 83
identiﬁability, 23, 180, 207, 268,
269
independence
conditional, 20
infectious disease models, 261
inﬂuenza models, 273, 275
intention-to-treat
ITT, 242
interaction eﬀect
nonseparable, 261
random walk Type II, 261, 264
space-time, 178, 180, 255, 259
Type III, 261
Type IV, 261
interpolation, 191
intervention, 281
intraclass correlation, 91
Kaplan-Meyer curves, 233
Kriging
Bayesian, 192, 194, 196
block, 193, 194
L1 norm model, 108
Laplace approximation, 50, 52
larynx cancer, 165
Latent structure models, 108, 268
likelihood
approximation, 48
function, 19
local, 141, 146
marginal, 30
maximum, 52
models, 19
pairwise, 49
partial, 272
linear model of coregionalisation,
219, 221
linked component model, 204
log Gaussian Cox process, 133,
157, 160
LGCP, 89
log-normal model, 80, 84
logistic-normal model, 84
marked process, 244

342
Index
Markov chain Monte Carlo, 56
McMC, 36
spatial birth-death, 136
subsampling and thinning, 45
Markov connected component mod-
els, 148
Markov process, 135
Markov random ﬁeld model, 220
Gaussian, 273
MRF, 87
maximum entropy approach, 161
MCAR(B, Σ), 221
mean square predictive error
MSPE, 58, 268
measurement error, 161, 171, 174,
181, 196
Metropolis algorithm, 37
Metropolis updates, 38
Metropolis–Hastings algorithm, 37,
39, 43, 46
Metropolis–Hastings updates, 38
Metropolis–Langevin sampler, 46,
90
Metropolized
Carlin–Chib
algo-
rithm, 136, 140
misaligned data problem
MIDP, 190
misalignment
outcome, 198
predictor, 191
space-time, 198, 261
misclassiﬁcation error, 158, 161,
171
missing data, 241
mixture intensity, 134
mixture models, 108, 110, 146, 269
MLwiN, 37
modiﬁable areal unit problem
MAUP, 159, 185
Monte Carlo estimator, 36
Monte Carlo integration, 193
Moran’s I statistic, 60, 94
Multilevel modeling, 186
multinomial distribution, 216, 217,
249
multinomial logit model, 211, 212
multiple category data
nominal, 107
ordinal, 107
multiple event types, 244
Multiscale analysis, 185, 187
multivariate CAR models
MCAR(B, Σ), 220
MVCAR, 220
Multivariate normal distribution,
21, 79, 85, 173, 249
Multivariate
spatial
correlation,
219
mv.car, 221
negative binomial distribution, 26,
82
noninteger Poisson data, 199
normal approximation, 52, 53
overdispersion, 80
parametric bootstrap, 59
partition models, 139, 144
Pearson correlation coeﬃcient, 43
perfect sampling, 47
point process
marked, 278
Poisson process model
heterogeneous, 73, 75, 123,
176, 202, 243, 245
Poisson–gamma model, 27, 35, 117
Poisson-gamma model, 26, 80
Poisson-log-normal model, 84
posterior
appproximation, 48
density
marginal, 36
functional, 36
mean, 35
posterior
variance, 35
posterior distribution, 24
proper, 25
posterior expected mixing ﬁeld,
108

Index
343
posterior predicted survival, 233
Posterior predictive loss, 57, 92
posterior sampling, 35
predictive capability, 281
predictive distribution, 26, 62, 82
posterior, 26, 34
prior, 26, 27
principal component decomposi-
tion, 269
Prior distribution
auto-regressive, 180
Bernoulli, 141
beta, 33
Gamma, 80
gamma, 23
improper, 22
Inverse gamma, 80
inverse gamma, 23
inverse Wishart, 222
Jeﬀrey’s, 22
Laplace, 23
multivariate normal
MVN, 230, 232, 260
multivariate normal
MVN, 90
noninformative, 22
Potts, 146
proper, 22
random walk, 236, 238, 248,
251, 260–262, 269, 279
vague, 22
Wishart, 222, 270
zero-mean Gaussian, 23, 31,
34, 79, 87, 132, 154, 169,
170, 196, 216, 232, 236,
238, 248, 251, 260
prior distribution
zero-mean Gaussian, 80
process mixture, 105
proportional hazard models, 228
Cox, 273
proportional mortality model, 205
proportional odds model, 107
proportionality of hazard, 229
propriety, 22
proprotional hazard models
Cox, 232
pseudolikelihood, 48, 96, 100, 266
putative hazard models, 165, 210
putative health hazards, 78, 123,
136
spatio-temporal, 176
putative source analysis, 165
quantile-quantile plots, 43
R, 37, 283
R2WinBUGS, 57
R2WinBUGS, 126, 298
random eﬀect
correlated
CH, 84, 164, 171, 200, 260
uncorrelated
UH, 80, 97, 154, 171, 260
random ﬁeld
Gaussian, 195, 256
recursive Bayesian updating, 281
relative risk, 77
relative risk map, 82
repeated event analysis, 243
residual
Bayesian, 61, 126, 128, 181
deviance, 60, 69
predictive, 62, 128, 181
residuals, 55, 59
reversible jump samplers, 47, 136,
140
rgamma, 35, 82
SatScan, 138
scale labeling, 186
sex ratios of births, 76
shared component model, 205, 207
singular information methods, 102
space–time infection model, 275
spatial factor analysis, 110
spatial trend, 78
spatially-contextual, 231
spatiotemporal interaction, 178
Spline models, 101, 171, 198

344
Index
low rank, 154
low rank Kriging, 102
standardisation, 77
stickieness, 47
sticky sampler, 43
Strauss distribution, 135, 136
structural equation models , 111
survival function, 228
susceptible-infected-removed mod-
els
SIR, 274
swine fever, 279
temporally weighted regression, 279
time to endpoint, 228
transmission distribution, 275
trend component, 279
underascertainment, 274, 281
unobserved confounding, 163
variable selection, 269
vector autoregressive model, 273
Von Mises distribution, 178
WinBUGS, 37, 290
within area exposure distribution,
159
Wombling, 149
Zip regression model, 102, 107
zoonosis, 276

