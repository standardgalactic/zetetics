arXiv:2101.00635v4  [math.AG]  27 Apr 2022
QUANTITATIVE SHEAF THEORY
WILL SAWIN, MIS EN FORME PAR A. FOREY, J. FRES´AN AND E. KOWALSKI
Abstract. We introduce a notion of complexity of a complex of ℓ-adic sheaves on a
quasi-projective variety and prove that the six operations are “continuous”, in the sense
that the complexity of the output sheaves is bounded solely in terms of the complexity of
the input sheaves. A key feature of complexity is that it provides bounds for the sum of
Betti numbers that, in many interesting cases, can be made uniform in the characteristic
of the base ﬁeld. As an illustration, we discuss a few simple applications to horizontal
equidistribution results for exponential sums over ﬁnite ﬁelds.
Contents
1.
Introduction
1
2.
Characteristic cycles
7
3.
Complexity and generic linear maps
11
4.
Test sheaves
18
5.
Complexity of a tensor product
22
6.
Quantitative sheaf theory on quasi-projective varieties
28
7.
Examples and applications
52
8.
Eﬀective bounds
66
References
68
1. Introduction
Since its invention, and especially since Deligne’s proof [7] of the strongest form of
the Riemann Hypothesis over ﬁnite ﬁelds, ´etale cohomology has exerted a considerable
inﬂuence on analytic number theory. Its applications very often rely on estimates for
the dimension of various ´etale cohomology spaces, which appear in “implicit constants”
arising from the Grothendieck–Lefschetz trace formula combined with the Riemann Hy-
pothesis and depend on the characteristic p of the ﬁnite ﬁelds under consideration. This
characteristic is typically itself a variable going to inﬁnity, and getting uniform estimates
in terms of p turns out to be the crucial diﬃculty. Except for very simple cases, uni-
formity of such estimates is not a formal feature of ´etale cohomology (for examples and
further discussion, see [25, 11.11]).
In recent years, this issue has been particularly visible in a series of works by Fouvry,
Kowalski and Michel (see, e.g., [14] and [15]) that make extensive use of very general
sheaves on curves in various problems of analytic number theory. Due to the simpler
nature of curves (essentially, the Euler–Poincar´e characteristic controls the sum of Betti
Key words and phrases. ℓ-adic cohomology, Betti numbers, characteristic cycles, Riemann hypothesis,
equidistribution of exponential sums.
W. S. was supported by Dr. Max R¨ossler, the Walter Haefner Foundation and the ETH Z¨urich Foun-
dation and by by NSF grant DMS-2101491. A. F. and E. K. are supported by the DFG-SNF lead agency
program grant 200020L 175755. A. F. is supported by SNF Ambizione grant PZ00P2 193354. J. F. is
partially supported by the grant ANR-18-CE40-0017 of the Agence Nationale de la Recherche.
1

numbers, and has an expression in terms of “simple” local invariants), they obtained a
satisfactory theory, phrased in terms of a “complexity” invariant of an ℓ-adic sheaf on a
curve over a ﬁnite ﬁeld, which they called the “(analytic) conductor”. The key feature of
this theory is that most natural operations on sheaves and the analytic resulting estimates
depend on the “input” sheaves only through their conductor (see, e.g., [14, Th. 1.5]).
Another application of a suitable version of complexity for ℓ-adic sheaves on curves is
the proof by Deligne [8] of the theorem that, for a lisse Qℓ-adic Weil sheaf on a normal
connected scheme of ﬁnite type over a ﬁnite ﬁeld such that the traces of Frobenius at all
closed points are algebraic numbers, the ﬁeld generated by these traces is a number ﬁeld.
The complexity that we introduce here could also be used in Deligne’s argument.
In this paper, we develop a similar theory for higher-dimensional quasi-projective al-
gebraic varieties over any ﬁeld. (Being a geometric invariant, the complexity is deﬁned
by base change to an algebraically closure of the base ﬁeld, so most of this paper will
only deal with algebraically closed ﬁelds.) This leads to very general estimates that solve
most of the known problems of estimating Betti numbers in analytic number theory.
We now state somewhat informally the deﬁnition of complexity and some of the key
statements, focusing for simplicity on sheaves on aﬃne space An. Let k be an algebraically
closed ﬁeld and ℓa prime number diﬀerent from the characteristic of k. We will deﬁne:
• A non-negative integer c(A) for any object A of the bounded derived category
of constructible sheaves Db
c(An, Qℓ) (Deﬁnitions 3.2 and 6.3). Letting u denote
the open immersion of An in Pn, the integer c(A) is deﬁned as the maximum
over integers 0 ⩽m ⩽n of the sum of the Betti numbers of the pullback of the
extension by zero u!A to a “generic” linear subspace of dimension m of Pn.
• A non-negative integer c(f) for any morphism f : An →Am (Deﬁnition 6.6). In
general, this is also deﬁned in terms of sums of Betti numbers, but admits in the
case at hand a completely explicit bound that only involves n, m and the degrees
of the polynomials deﬁning f (Proposition 6.21).
We will then prove the following result (Theorems 6.8 and 6.17). In the statement,
D(A) denotes the Verdier dual of A and all functors and operations are considered in the
derived sense (so, e.g., we write f∗instead of Rf∗).
Theorem 1.1. For any f : An →Am, for any objects A and B of Db
c(An, Qℓ), and any
object C of Db
c(Am, Qℓ), the following estimates hold:
c(D(A)) ≪c(A),
c(A ⊗B) ≪c(A)c(B),
c(H om(A, B)) ≪c(A)c(B),
c(f ∗C) ≪c(f)c(C),
c(f !C) ≪c(f)c(C),
c(f!A) ≪c(f)c(A),
c(f∗A) ≪c(f)c(A).
In all these estimates, the implied constants depend only on (n, m) and are eﬀective.
Moreover, let S be the spectrum of a strictly Henselian discrete valuation ring with
special point σ and generic point η, and let Ψ and Φ denote the nearby and vanishing
cycle functors from Db
c(An
S, Qℓ) to Db
c(An
σ, Qℓ). For any object A of Db
c(An
S, Qℓ), the
following estimates hold:
c(Ψ(A)) ≪c(Aη),
c(Φ(A)) ≪c(Aη) + c(Aσ).
Over ﬁnite ﬁelds, the conjunction of the Riemann Hypothesis and the theory of com-
plexity yields the following “quasi-orthogonality” statement (Theorem 7.13):
2

Theorem 1.2. Suppose that k is the algebraic closure of a ﬁnite ﬁeld F, and let A and B
be irreducible perverse sheaves on An deﬁned over F that are pure of weight zero, with
trace functions tA and tB respectively. Then the estimate
X
x∈Fn
|tA(x)|2 = 1 + O(c(A)2|F|−1/2)
holds, and the estimate
X
x∈Fn
tA(x)tB(x) ≪c(A)c(B)|F|−1/2
holds if A and B are not geometrically isomorphic. In both estimates, the implied con-
stants depend only on n and are eﬀective.
Remark 1.3. Readers from analytic number theory who are unfamiliar with perverse
sheaves may be surprised by the lack of the averaging factor 1/|Fn| in the writing of these
sums, in comparison with statements like those in [14]. This is due to the normalization
inherent to the deﬁnition of weights in this setting: for instance, for a perverse sheaf M
on A1 that is a single lisse sheaf sitting in degree −1, being pure of weight zero means
that the eigenvalues of Frobenius at all points have modulus |F|−1/2 (and not 1, as is the
case for a lisse sheaf that is pointwise pure of weight zero).
We highlight one ﬁrst rather simple application (see part (1) of Corollary 7.23), which
gives a positive answer to a question of Katz [29, p. 8 and 12.6.6].
Theorem 1.4. Let n ⩾1 and d ⩾1 be integers. Let D(n, d) be the space of Deligne
polynomials of degree d in n variables, i.e. those whose homogeneous part of degree d
deﬁnes a non-singular hypersurface in Pn−1. For each f ∈D(n, d)(Fp), set
S(f; p) =
1
pn/2
X
x∈Fnp
e
f(x)
p

,
where e(z) = exp(2iπz) for z ∈C. The families (S(f, p))f∈D(n,d)(Fp) become equidis-
tributed as p →+∞with respect to the image under the trace of the probability Haar
measure on the unitary group U(d−1)n(C).
We now comment on the approach that we use. Previous Betti number bounds, such as
those of Bombieri [4], Adolphson–Sperber [1] and Katz [28], focused primarily on bound-
ing cohomology groups involving certain very explicit sheaves, namely Artin–Schreier and
Kummer sheaves. It is possible to apply these bounds to a sheaf cohomology problem in-
volving, say, higher-rank Kloosterman sheaves, but only after unraveling their deﬁnition
to recast the problem entirely in terms of Artin–Schreier sheaves. When more compli-
cated operations are performed (for example, additive or multiplicative convolution, or
Fourier transform), this process of re-interpretation becomes exceedingly cumbersome.
Our approach is instead built around the six functors formalism of ´etale cohomology,
and is closely related to the characteristic classes constructed by T. Saito [39]. We de-
ﬁne the “complexity” of an arbitrary bounded complex of constructible ℓ-adic sheaves
on a quasi-projective variety, and prove that it satisﬁes essentially all desired properties
suggested by the case of curves and the requirements of applications to analytic number
theory. In particular, the complexity of common sheaves such as Artin-Schreier, Kum-
mer and Kloosterman sheaves can be easily calculated, and it turns out to be bounded
independently of the characteristic of the underlying ﬁeld, which is the key uniformity
property that we seek.
3

Remark 1.5. In fact, the complexity of a sheaf on an algebraic variety will also depend
on a chosen quasi-projective embedding of the variety; this seems unavoidable to have a
theory with good properties, as we explain in Example 6.1.
Remark 1.6. The deﬁnition of complexity and the arguments of this paper apply, almost
without modiﬁcation, to the derived category of sheaves with coeﬃcients in Fℓinstead
of Qℓ. Neither version is stronger. Although the Betti numbers of a Qℓ-sheaf are bounded
by the Betti numbers of the reduction mod ℓof an integral model of it, this inequality
does not help us transfer statements of the form “a bound for the Betti numbers of this
sheaf implies a bound for the Betti numbers of that sheaf” in either direction. We have
stated and worked out in detail the Qℓ-version as it is the most directly relevant for
applications to analytic number theory, but the Fℓ-version may also be useful for other
purposes.
We believe that this framework has a number of good properties, among which:
(1) Since the deeper aspects of ´etale cohomology are built primarily around the six
functors perspective, rather than the cohomology of varieties with coeﬃcients in
some simple explicit sheaves, this framework behaves much better in arguments
where sophisticated techniques of ´etale cohomology are used.
(2) Many applications of exponential sum bounds from ´etale cohomology revolve
around exponential sums that are produced from simpler ones by applying analytic
tools like changes of variables, summation over some variables, Fourier transform,
etc. Through the “function-sheaf dictionary”, each of these usually corresponds
to an operation on the sheaf side, which is constructed by means of the six func-
tors (e.g., summation corresponds to direct image with compact support, etc).
Since we control the growth of the complexity under the six functors, we obtain
automatically a good control of the estimates in such operations.
As we will see, almost all of the bounds for the complexity of the output sheaf of some
cohomology operation are linear in the complexity of the input sheaf. This is not always
needed for applications, but shows that the theory has good structural properties.
An interpretation. As suggested by Fouvry, Kowalski and Michel in the special case
of curves, the “quantitative sheaf theory” that is developed in this paper can be thought
of as deﬁning the complexity of ℓ-adic sheaves in such a way that most (if not all)
usual operations in ´etale cohomology are “continuous”, in the sense that applying the
operation to a sheaf with a given complexity will lead to another one with complexity
bounded only in terms of the initial one. Thus, we think of the complexity as being
similar to a (semi)-norm on a topological vector space, with functors on categories of
sheaves playing the role of (often linear) maps between vector spaces. For instance, the
“continuity” of Deligne’s ℓ-adic Fourier transform (which was ﬁrst observed in dimension
one in [15, Prop. 8.2]) turns out to be one of the most essential features of applications
of ´etale cohomology to analytic number theory.
Outline of the paper. Although the complexity is deﬁned in terms of sums of Betti
numbers, the proof of its main properties deeply relies on T. Saito’s construction [39] of
the characteristic cycle of ℓ-adic complexes. We survey what we require from this theory
in Section 2, and prove a small complement on characteristic cycles of tensor products
(Theorem 2.2).
In Section 3, we formally deﬁne the complexity on projective space,
we establish a few simple lemmas concerning “generic” injective linear maps, and most
importantly we connect this approach with the characteristic cycle (Proposition 3.17).
Section 4 is of technical nature: we deﬁne and prove the existence of certain objects called
4

“test sheaves” that will ultimately lead to a comparison of the complexity with a norm
of the characteristic cycle. Section 5 uses these tools to establish the ﬁrst fundamental
result, namely a bilinear bound for the complexity of the tensor product (Theorem 5.1).
Then Section 6 can rather quickly exploit the formalism of ´etale cohomology to establish
the general version of Theorem 1.1, namely Theorems 6.8 and 6.17; later subsections
derive various other “continuity” properties. Finally, Section 7 gives some fundamen-
tal examples (such as Artin–Schreier and Kummer sheaves) and summarizes a few direct
applications (including forms of the Riemann Hypothesis, such as Theorem 1.2, the ﬁnite-
ness statement of Corollary 7.15, and a form of Deligne’s equidistribution theorem, from
which Theorem 1.4 folllows). In the concluding Section 8, we explain how all the basic
estimates can be stated with explicit constants.
Notation and conventions.
Algebraic geometry. We ﬁx throughout a prime number ℓand we denote by k a ﬁeld,
algebraically closed unless otherwise speciﬁed, in which ℓis invertible.
By an algebraic variety over a (not necessarily algebraically closed) ﬁeld k, we mean a
reduced and separated scheme of ﬁnite type over the spectrum of k.
By a geometric generic point of an irreducible variety X over a separably closed ﬁeld k′,
we mean, as is customary in the theory of ´etale cohomology, a map Spec k′ →X such
that the image of the underlying set-theoretic map consists of the generic point of X.
Let X be a scheme of ﬁnite type over k. We denote by Db
c(X) the bounded derived
category of constructible complexes of Qℓ-sheaves on X (see, e.g., [32, II.5]). We will
usually write distinguished triangles in this category simply as
A −→B −→C.
For any object K of Db
c(X) and any integer i ∈Z, we denote by Hi(X, K) and Hi
c(X, K)
the ´etale cohomology and the ´etale cohomology with compact support groups of X with
coeﬃcients in K, and we write
hi(X, K) = dim Hi(X, K),
hi
c(X, K) = dim Hi
c(X, K)
for the corresponding Betti numbers.
When applied to objects of Db
c(X), the symbols f! and f∗always refer to the derived
functors; the tensor product and the hom functor of objects of Db
c(X) are also always
derived functors. We denote by D(A) the Verdier dual of an object A of Db
c(X).
Given an algebraic variety X over k and objects A and B of Db
c(X), the shriek tensor
product of A and B is the object
A ⊗! B = ∆!(A ⊠B)
of Db
c(X), where ∆: X →X × X denotes the diagonal embedding. It is related to the
usual tensor product by the duality
D(A ⊗! B) = D(A) ⊗D(B).
We often use the projection formula in the derived category: for a morphism f : X →Y
of algebraic varieties over k, and for objects A of Db
c(X) and B of Db
c(Y ), there is a
canonical isomorphism
f!(A ⊗f ∗B) ≃f!A ⊗B
in the category Db
c(Y ) (see, e.g., [18, Th. 7.4.7 (i)]).
5

We also recall the excision triangle: let i: Z →X be a closed immersion and j : U →X
the complementary open immersion, all varieties being deﬁned over k. For any object A
of Db
c(X) and any morphism f : X →Y over k, there is a distinguished triangle
(f ◦j)!j∗A −→f!A −→(f ◦i)!i∗A
in the category Db
c(Y ) (see, e.g., [18, Th. 7.4.4 (iii)]).
Finite ﬁelds. In some sections (e.g., Sections 6.10 and 7.6), we will work over ﬁnite ﬁelds.
We usually denote by F such a ﬁeld, which is always assumed to have characteristic
diﬀerent from ℓ. For integers n ⩾1, we then denote by Fn the extension of F of degree n
inside some ﬁxed algebraic closure of F (which often will be the ﬁeld k).
Let X be an algebraic variety over F.
For any object A of Db
c(X) and any ﬁnite
extension Fn of F, we denote by
tA(·; Fn): X(Fn) −→Qℓ
the trace function of A on Fn. We refer the reader to [38, §1] for the basic formalism of
trace functions in this generality. We will also write tA(x) = tA(x; F) for x ∈X(F).
In all arguments involving the formalism of weights (in the sense of Deligne), we will
ﬁx an isomorphism ι: Qℓ→C and use it to identify both ﬁelds, viewing in particular the
trace functions as taking complex values. Weights are then considered to be deﬁned only
with respect to ι, e.g. we write “pure of weight zero” instead of “ι-pure of weight zero”.
For a real number w and an element |F|−w in Qℓcorresponding to a choice of |F|−w in C
through the isomorphism ι, we denote by Qℓ(w) the pullback to X of the rank-one ℓ-adic
sheaf on Spec(F) on which Frobenius acts through multiplication by |F|−w. This allows
one to deﬁne twists A(w) = A ⊗Qℓ(w) for any object A of Db
c(X), and hence to reduce
questions about pure sheaves of some weight to those of weight zero.
The Euler–Poincar´e characteristic. We recall the Euler–Poincar´e characteristic formula
for a perverse sheaf on a smooth curve (see, e.g., [38, Th. 2.2.1.2] for the projective case,
from which the general case below follows by considering the extension by zero to the
compactiﬁcation). Let k be an algebraically closed ﬁeld of characteristic p > 0, let C be
a smooth curve over k, and denote by C the smooth projective compactiﬁcation of C.
Given a perverse sheaf A on C, we denote by
rank(A) = dim H −1(A)η
the generic rank of A and, for a closed point x of C, we write
dropx(A) = rank(A) −dim H −1(A)x
jumpx(A) = dim H 0(A)x.
For a closed point x of C, we denote by swanx(A) the Swan conductor at x of the
cohomology sheaf H −1(A). We further set
loc(A) =
X
x∈C
(dropx(A) + jumpx(A) + swanx(A)) +
X
x∈C−C
swanx(A),
where both sums run over closed points.
With the above notation, the Grothendieck–Ogg–Shafarevitch formula for the Eu-
ler–Poincar´e characteristic with compact support of A takes the form
χc(C, A) = rank(A)χc(C, Qℓ[1]) −loc(A).
The same result holds for the usual Euler–Poincar´e characteristic χ(C, A) since both are
in fact equal for any constructible sheaf on any variety by a theorem of Laumon [37].
6

If F is a middle-extension sheaf on C (by which we mean that there exists a non-empty
open subset j : U ֒→C such that F is lisse on U and the adjunction morphism is an
isomorphism F ≃j∗j∗F), then A = F[1] is a perverse sheaf on C satisfying H −1(A) =
F. We use the notation rank(F), dropx(F), swanx(F) and loc(F) accordingly; note
that in this case jumpx(A) = 0 holds for all x.
Asymptotic notation. For complex-valued functions f and g deﬁned on a set (or on objects
of a category, in which case the values of f and g are assumed to only depend on their
isomorphism classes), the notation f ≪g and f = O(g) are synonymous; they mean that
there exists a real number c ⩾0 such that, for all x in the relevant set (or all objects
in the category), the inequality |f(x)| ⩽cg(x) holds. We call a value of c an “implied
constant”, and we may point out its (in)dependency on some additional parameters. We
also write f ≍g whenever both f ≪g and g ≪f hold.
Remarks on the text. All the important ideas of this paper are solely due to W. Sawin,
and were worked out in 2015 and 2016 while he was an ETH–ITS Junior Fellow. The
current text was written by A. Forey, J. Fres´an and E. Kowalski, based on the original
draft by W. Sawin, in view of the applications to equidistribution results for exponential
sums on commutative algebraic groups in their work [11]. The quantitative form of the
generic base change theorem is due to A. Forey.
Acknowledgements. We warmly thank the anonymous referees for their thorough and
friendly reading of a ﬁrst version of this paper. Their many suggestions greatly helped
us improve the presentation and remove a number of inaccuracies.
2. Characteristic cycles
In this section, we recall some properties of the characteristic cycles and the character-
istic classes of complexes of ´etale sheaves as deﬁned by Beilinson [2] and T. Saito [39]. We
also prove a small complement (Theorem 2.2) regarding the compatibility of characteristic
cycles with tensor products.
Let X be a smooth scheme over a perfect ﬁeld k. In [39], characteristic cycles are
deﬁned for complexes of sheaves of Λ-modules on X, where Λ is a ﬁnite local ring whose
residue characteristic ℓis invertible in k (e.g., Λ = Z/ℓnZ). It was observed by Umezaki,
Yang and Zhao [42, Section 5] that the whole theory can be readily adapted to the case
of Qℓ-coeﬃcients. In what follows, we implicitly rely on [42] in order to apply Saito’s
results to Λ = Qℓ.
Assume X has pure dimension n.
The characteristic cycle CC(A) of an object A
of Db
c(X) is an algebraic cycle on the cotangent bundle T ∗X of X of the form
CC(A) =
X
i
miCi,
where mi is an integer and Ci is a closed conical (i.e. stable under the natural action
of Gm) subset of T ∗X of dimension n. We refer the reader to [39, Def. 5.10] for the
deﬁnition of the multiplicities mi, and simply indicate some of the relevant properties of
the characteristic cycle.
Another invariant of A is its singular support SS(A), which is a closed conical subset
of T ∗X of dimension n, containing the support of the characteristic cycle, previously de-
ﬁned by Beilinson in [2]. Unlike what happens for the characteristic cycle, two Zℓ-sheaves
that are isomorphic after tensoring with Qℓmay have distinct singular supports, so before
7

stating results involving the singular support we will choose a Zℓ-structure A¯Zℓ(though
the particular choice will matter little), and set
SS(A) = SS(A¯Zℓ⊗¯Fℓ).
If the object A is perverse, then CC(A) is eﬀective (i.e., we have mi ⩾0 for every i)
by [39, Prop. 5.14].
The main property of the characteristic cycle is an index formula ([39, Th. 7.13]) ac-
cording to which, if X is a smooth projective variety over an algebraically closed ﬁeld k,
the Euler–Poincar´e characteristic of A is given by the intersection number
χ(X, A) = CC(A) · [T ∗
XX].
In this formula, T ∗
XX denotes the zero section of T ∗X, and the intersection is well-deﬁned
since the support of CC(A) has pure dimension n.
Example 2.1. Let X be a smooth projective curve and F a lisse sheaf on a dense open
subset j : U →X. The characteristic cycle of the perverse sheaf A = j!F[1] is given by
CC(A) = rank F · [T ∗
XX] +
X
x∈X\U
(rank F + swanx A)[T ∗
xX],
where T ∗
xX stands for the conormal bundle of x in T ∗X. In this situation, the index
formula amounts to the Grothendieck–Ogg–Shafarevich formula.
Another deep result is the compatibility of the characteristic cycle with pullbacks.
Let h: W →X be a morphism between smooth schemes of pure dimensions m and n
respectively and C ⊂T ∗X a closed conical subset. Let
h∗C = W ×X C ⊂W ×X T ∗X
be the pullback of C, and denote by K ⊂W ×X T ∗X the preimage of the zero sec-
tion T ∗
WW by the map dh: W ×X T ∗X →T ∗W. Following [39, Def. 3.3 and 7.1], we
say that the map h is properly C-transversal if the intersection h∗C ∩K is a subset
of W ×X T ∗
XX and each irreducible component of h∗C has dimension m.
This im-
plies in particular that the restriction of dh to h∗C is ﬁnite (by [2, Lem. 1.2. (ii)] or
[39, Lem. 3.1]). Hence, given a cycle Z supported on the irreducible components of C, we
can deﬁne its pullback h!Z ⊂T ∗W as (−1)m−n times the push-forward along the ﬁnite
map h∗C →T ∗W of the preimage of Z in W ×X T ∗X (see [39, Def. 7.1]).
The main theorem of Beilinson and Saito [39, Th. 7.6] regarding pullbacks says that,
if A is an object of Db
c(X, Zℓ) and h: W →X is a properly SS(A)-transversal morphism,
then the following equality holds:
CC(h∗A) = h! CC(A).
For example, smooth morphisms are properly SS(A)-transversal by [39, Lem. 3.4], and in
that case the theorem essentially amounts to the statement that, for smooth varieties X
and Y and objects A of Db
c(X) and B of Db
c(Y ), the equality
CC(A ⊠B) = CC(A) × CC(B),
holds in T ∗(X × Y ) = T ∗X × T ∗Y , see [40, Th. 2.2] for details.
In what follows, vector bundles on schemes are viewed as schemes in the usual way. A
sum of vector bundles V + W is isomorphic to their ﬁber product over the base, whereas
the product V × W is their product as schemes, and hence is a vector bundle on the
product of the bases. As for T ∗X, a closed subset of a vector bundle is said to be conical
if it is invariant under the scaling action of Gm. Given a vector bundle V on a variety X,
8

we denote by V = P(V + OX) the projective bundle compactifying V , which admits a
decomposition V = V ∪P(V ).
The main result of this section is the following theorem concerning characteristic cycles
of tensor products of sheaves.
Theorem 2.2. Let X be a smooth variety over k of pure dimension n. Let A and B be
objects of Db
c(X, Zℓ). Consider the summation and the inclusion maps
s: T ∗X + T ∗X →T ∗X,
i: T ∗X + T ∗X →T ∗X × T ∗X.
Assume that SS(A) ∩SS(B) is supported on the zero section and that each irreducible
component of SS(A) ×X SS(B) has dimension at most n. Then:
(1) Each irreducible component of SS(A) ×X SS(B) has dimension equal to n.
(2) The equality i∗(SS(A) × SS(B)) = SS(A) ×X SS(B) holds.
(3) The restriction of s to SS(A) ×X SS(B) is a ﬁnite map to T ∗X.
(4) The following equality holds
CC(A ⊗B) = (−1)ns∗i∗(CC(A) × CC(B)) ,
where the pullback and the pushforward are taken in the sense of intersection
theory. (By (1) and (2), the inverse image i∗(SS(A) × SS(B)) has the expected
dimension, so the intersection-theoretic pullback is well-deﬁned.)
(5) Assume that X is projective. Let CC(A) and CC(B) be the closures of CC(A)
and CC(B) inside the projective bundle T ∗X. Then the equality
χ(X, A ⊗B) = (−1)n CC(A) · CC(B) = (−1)nCC(A) · CC(B)
holds, where the dots denote intersection numbers of algebraic cycles.
Note that proving properties (1), (2) and (3) amounts to checking that the diagonal
map is properly SS(A) × SS(B)-transversal.
The proof of the theorem relies on the
following lemma:
Lemma 2.3. Let X be a variety over k and let V be a vector bundle on X. Let C1, C2 ⊂V
be conical subsets and C1 and C2 their closures inside the projective bundle V .
The
following two conditions are equivalent:
(1) C1 ∩C2 is contained in the zero section of V .
(2) C1 ∩C2 does not intersect P(V ) inside V .
Proof. The intersection C1 ∩C2 is proper, as a closed subset of V . Taking the decom-
position V = V ∪P(V ) into account, if condition (2) holds, then C1 ∩C2 is also aﬃne,
being a closed subset of V . Therefore, C1 ∩C2 is a ﬁnite conical subset of V , and is hence
contained in the zero section. Conversely, (1) implies (2) because if x is a point of C1 ∩C2
that lies in P(V ), then the line in V corresponding to x is contained in C1 ∩C2, which
therefore is not just the zero section.
□
Proof of Theorem 2.2. We ﬁrst prove statement (1). Since SS(A) ×X SS(B) is the inter-
section of the inverse images of SS(A) and SS(B) inside T ∗X +T ∗X (i.e. the intersection
of two 2n-dimensional schemes inside a smooth variety of dimension 3n), each of its
irreducible components has dimension at least n, and hence equal to n by assumption.
Statement (2) follows from the fact that pullback by the map i identiﬁes the sum
T ∗X + T ∗X with T ∗X ×X T ∗X seen as a closed subset of T ∗X × T ∗X. In the rest of the
proof, we will make this identiﬁcation.
To prove (3), observe that s: T ∗X + T ∗X →T ∗X is a map of vector bundles on X.
Since SS(A) and SS(B) are conical and SS(A)∩SS(B) is a subset of the zero section T ∗
XX
9

of T ∗X, the intersection of SS(A)×X SS(B) and the pullback along s of T ∗
XX is contained
in the zero section of T ∗X + T ∗X. Hence, the restriction of s to SS(A) ×X SS(B) is ﬁnite
by [39, Lem. 3.1].
We now turn to (4). Recall that the characteristic cycle of the external product A ⊠B
is equal to CC(A) × CC(B) and that the tensor product A ⊗B is given by ∆∗(A ⊠B),
where ∆: X →X × X denotes the diagonal map. We will compute CC(A ⊗B) using
the compatibility of characteristic cycles with pullbacks, as recalled above. For this, we
need to show that ∆is a properly SS(A) × SS(B)-transversal morphism.
From part (2), we know that every irreducible component of ∆∗(CC(A) × CC(B)) has
dimension n. For the transversality condition, we need to consider the maps
T ∗X
s
←−T ∗X + T ∗X
i
−→T ∗(X × X)
deﬁned by the diagonal ∆, and check that the intersection of i∗(SS(A) × SS(B)) with
the preimage of the zero section T ∗
XX by the map s is contained in the zero section of
T ∗X + T ∗X. But this is precisely the condition we checked in the proof of (3), and is
in fact equivalent to (3) by [39, Lem. 3.1]. Hence, [39, Th. 7.6] applies to ∆and A ⊠B,
which yields the equality
CC(∆∗(A ⊠B)) = ∆! CC(A ⊠B).
Combining this with the ﬁrst part of the proof and the deﬁnition of ∆!, we get
CC(A ⊗B) = CC(∆∗(A ⊠B)) = ∆! CC(A ⊠B) = (−1)ns∗i∗(CC(A) × CC(B)).
Let us ﬁnally prove (5). By the index formula [39, Th. 7.13], the Euler–Poincar´e char-
acteristic of A⊗B is the intersection number of CC(A⊗B) with the zero section [T ∗
XX].
Using part (4), it is hence given by
(−1)n[T ∗
XX] · s∗i∗(CC(A) × CC(B)).
By the projection formula in intersection theory (see, e.g., [20, Prop. 8.3 (c)]), the equality
[T ∗
XX] · s∗i∗(CC(A) × CC(B)) = s∗[T ∗
XX] · i∗(CC(A) × CC(B))
holds, as long as the restriction of s to the support of i∗(CC(A)×CC(B)) is a proper map.
Taking into account that the support of i∗(CC(A) × CC(B)) is SS(A) ×X SS(B), this is
indeed the case by part (3). Now, s∗[T ∗
XX] is the closed subset in T ∗X + T ∗X consisting
of those elements with zero sum. Being conical, CC(B) is in particular invariant under
multiplication by −1, hence the equality
s∗[T ∗
XX] · i∗(CC(A) × CC(B)) = d∗[T ∗X] · i∗(CC(A) × CC(B)),
where d: T ∗X →T ∗X + T ∗X is the diagonal map. Since d is a closed immersion, the
projection formula yields
d∗[T ∗X] · i∗(CC(A) × CC(B)) = [T ∗X] · d∗i∗(CC(A) × CC(B)).
Furthermore, i ◦d is the diagonal map δ: T ∗X →T ∗X × T ∗X, so the equality
[T ∗X] · d∗i∗(CC(A) × CC(B)) = [T ∗X] · δ∗(CC(A) × CC(B))
= CC(A) · CC(B)
holds. Combining all these identities we get the ﬁrst equality of (5). Finally,
SS(A) ∩SS(B) = SS(A) ∩SS(B)
follows from Lemma 2.3, and this implies the equality of intersection numbers
CC(A) · CC(B) = CC(A) · CC(B),
10

which completes the proof.
□
The following deﬁnition is taken from Saito [39, Def. 6.7] and relies on the isomorphism
CH∗(Pn) −→CHn
 T ∗Pn
,
(ai) 7−→
X
i
p∗aihi,
where p: T ∗Pn →Pn is the projection and h is the ﬁrst Chern class of the dual of the
universal sub line bundle of T ∗Pn ×Pn (T ∗Pn + OPn) (see [39, (6.12)]).
Deﬁnition 2.4 (Characteristic class). The characteristic class cc(A) ∈CH∗(Pn) of an
object A of Db
c(Pn) is the image of CC(A) ∈CHn
 T ∗Pn
under the inverse of the above
isomorphism.
The total Chow group CH∗(Pn) is isomorphic to Zn+1, with generators the classes
of linear subspaces of dimension 0 to n. Using this, we will view cc(A) as an element
of Zn+1. The lattice Zn+1 inherits the intersection pairing of CHn
 T ∗Pn
, and this pairing
is independent of the base ﬁeld k.
Lemma 2.5. Let 0 ⩽m ⩽n be an integer, and let Km denote the constant Qℓ-sheaf on
an m-dimensional linear subspace of Pn, extended by zero and placed in degree −m. Then
the characteristic cycle CC(Km) is the conormal bundle of that m-dimensional subspace,
and the characteristic classes cc(K0), . . . , cc(Kn) form a basis of CH∗(Pn). In particular,
cc(K0), . . . , cc(Kn) form a basis of Zn+1 independent of k and ℓ.
Proof. The ﬁrst statement follows from [39, Lem. 5.11(1) and 5.13(2)]. Recall that CH∗(Pn)
has rank n+1, so to show that the characteristic classes cc(K0), . . . , cc(Kn) form a basis,
it suﬃces to prove that they are linearly independent. We will do this by proving that
the matrix of intersection numbers cc(Ki) · cc(Kj) is invertible. If i + j < n, then generic
subspaces of dimensions i and j do not intersect, so neither do their conormal bundles,
and hence the intersection number is 0. If i + j = n, then a generic i-dimensional sub-
space and a generic j-dimensional subspace intersect transversely at a single point, so
their conormal bundles intersect transversely at a single point as well, and hence have
intersection number 1. The intersection matrix is thus invertible. The last sentence is
just a restatement of this, except for the independence of k and ℓ, which follows from
observing that the isomorphism [39, (6.12)], applied to the closure of the conormal bun-
dle of an m-dimensional subspace, can be deﬁned integrally and so is independent of the
characteristic.
□
3. Complexity and generic linear maps
In this section, we deﬁne the complexity of a complex of sheaves on projective space
and we establish a few results about generic linear maps between projective spaces and
their relationship with characteristic cycles.
Deﬁnition 3.1. Let k be a ﬁeld. Let 0 ⩽m ⩽n be integers. Let Mn+1,m+1
k
be the
variety of (n + 1) × (m + 1) matrices of maximal rank, so that in particular Mn+1,n+1
k
is
equal to GLn+1,k. Given an extension k′ of k and a k′-point a ∈Mn+1,m+1(k′), we denote
by la : Pm
k′ →Pn
k′ the associated linear map.
In the case m = n, in which a is an invertible matrix and la is an automorphism, we
may also use la to refer to the induced map on any scheme depending functorially on Pn
(e.g., its cotangent bundle).
Here is the key deﬁnition of this article. Although it is closely related to characteristic
cycles, as we will see, we have chosen to deﬁne it rather in terms of Betti numbers, so it
can be used more directly in situations where some Betti numbers can be computed.
11

Deﬁnition 3.2 (Complexity of a complex of sheaves on projective space). Let k be a
ﬁeld and let n ⩾0 be an integer. For each 0 ⩽m ⩽n, let am be a geometric generic
point of Mn+1,m+1
k
deﬁned over an algebraically closed ﬁeld k′. The complexity c(A) of
an object A of Db
c(Pn
k) is the non-negative integer
c(A) = max
0⩽m⩽n
X
i∈Z
hi(Pm
k′, l∗
amA).
When working with this deﬁnition, we will often use the projection formula to write
hi(Pm
k′, l∗
amA) = hi(Pn
k′, A ⊗lam∗Qℓ),
which gives a slightly diﬀerent expression for the complexity. Since ´etale cohomology is
invariant under base change of algebraically closed ﬁelds, the value of c(A) is independent
of the choice of the ﬁeld of deﬁnition k′, and we will often drop it from the notation.
Instead of considering geometric generic points of Mn+1,m+1 in the deﬁnition of com-
plexity, one can alternatively consider closed points in a suitable dense open subset
of Mn+1,m+1, as the following lemma shows.
Lemma 3.3. Let k be a ﬁeld and ¯k an algebraic closure of k. Let 0 ⩽m ⩽n be an
integer, and let A be a complex on Pn
k. There exists a dense open subset U ⊂Mn+1,m+1
k
such that the equality
hi(Pm
k′, l∗
aA) = hi(Pm
¯k , l∗
bA)
holds for any geometric generic point a of Mn+1,m+1 deﬁned over an algebraically closed
ﬁeld k′ and for every b ∈U(¯k) and i ∈Z.
Proof. For b ∈Mm+1,n+1(¯k), we view the linear map lb as the composition of the map x 7→
(x, b) from Pm to Pm × Mm+1,n+1 with the matrix multiplication map
mult: Pm × Mm+1,n+1 →Pn.
Let p: Pm × Mm+1,n+1 →Mm+1,n+1 be the projection. Let U ⊂Mn+1,m+1
k
be a dense
open set such that the complex p∗mult∗A has lisse cohomology sheaves on U. It follows
from the proper base change theorem that the equality
hi(Pm
k′, l∗
aA) = hi(Pm
¯k , l∗
bA)
holds for every b ∈U(¯k).
□
We also note for later use the inequality c(l∗
bA) ⩽c(A) for all b ∈U(¯k), which is a
straightforward consequence of the previous lemma and the deﬁnition of complexity.
Proposition 3.4. Let A be an object of Db
c(Pn
k). The complexity c(A) vanishes if and
only if A = 0. More precisely, let dj be the dimension of the support of the cohomology
sheaf H j(A) and let rj be the maximum of the generic ranks of the restrictions of H j(A)
to the irreducible components of maximal dimension of its support. Setting d = maxj∈Z dj
and r = P
j∈Z
dj=d rj, the inequality c(A) ⩾r holds.
Proof. Set m = n −d and let am be a geometric generic point of Mn+1,m+1
k
deﬁned
over an algebraically closed ﬁeld k′.
The cohomology sheaf H j(l∗
amA) = l∗
amH j(A)
vanishes in degrees j such that dj < d, whereas it has ﬁnite support Sj for all j such
that dj = d. Therefore, the Betti number hi(Pn
k′, H j(l∗
amA)) vanishes for i ̸= 0 and is
equal to the sum of the dimensions of the stalks of H j(l∗
amA) at points of Sj for i = 0.
By deﬁnition, there is a point of Sj at which the stalk has dimension rj, and hence the
inequality hi(Pn
k′, H 0(l∗
amA)) ⩾rj holds for all j such that dj = d.
12

It follows from the vanishing of cohomology in non-zero degrees that the spectral se-
quence
Hi(Pn
k′, H j(l∗
amA)) =⇒Hi+j(Pn
k′, l∗
amA)
degenerates at the ﬁrst page, hence an isomorphism
Hj(Pn
k′, l∗
amA) ∼= H0(Pn
k′, H j(l∗
amA)).
By deﬁnition of complexity, we then get
c(A) ⩾
X
j∈Z
hj(Pn
k′, l∗
amA) =
X
j∈Z
h0(Pn
k′, H j(l∗
amA)) ⩾
X
j∈Z
dj=d
rj = r,
which concludes the proof, since r = 0 if and only if A = 0.
□
We will make several arguments involving generic points on diﬀerent spaces of linear
maps. The next two lemmas describe all the properties we will need about relationships
between diﬀerent generic points.
Lemma 3.5. Let X and Y be geometrically irreducible aﬃne varieties over a ﬁeld k.
Let x ∈X(k′) and y ∈Y (k′) be points deﬁned over a ﬁeld extension k′ of k. Let k(x)
and k(y) be the ﬁelds generated by the coordinates of x and y respectively. If x is a
geometric generic point of Xk and y is a geometric generic point of Yk(x), then x is a
geometric generic point of Xk(y).
Proof. Letting ξ and η denote the generic points of X and Y respectively, the result
follows from the observation that if we identify X × η and ξ × Y with (irreducible)
subschemes of X × Y , then the generic points of X × η and ξ × Y are the same as the
generic point of X × Y .
□
Lemma 3.6. Let a be an element of Mn+1,m+1(k) and let g be a geometric generic point
of GLn+1,k. Then ga is a geometric generic point of Mn+1,m+1
k
.
Proof. Because GLn+1,k acts transitively on Mn+1,m+1
k
, the map g 7→ga from GLn+1,k
to Mn+1,m+1
k
is surjective, and hence dominant, so the image of g under this map is a
geometric generic point of Mn+1,m+1
k
.
□
Lemma 3.7. Let k be a ﬁeld and let 0 ⩽m ⩽n be integers. Let a, g, and h be points
of Mn+1,m+1
k
, GLn+1,k, and GLm+1,k respectively, all deﬁned over an algebraically closed
ﬁeld k′. Let b = gah−1. Let k(a) be the subﬁeld of k′ generated by the coordinates
of a, and similarly for k(g), k(a, g), and so on. Assume that g is a geometric generic
point of GLn+1,k(a) and that h is a geometric generic point of GLm+1,k(a,g). Then b is a
geometric generic point of Mn+1,m+1
k(a,h)
and h is a geometric generic point of GLm+1,k(a,b).
Proof. By Lemma 3.5, because g is generic over k(a) and h is generic over k(a, g), g is
a geometric generic point of GLn+1,k(a,h).
Because GLn+1,k acts transitively on Mn+1,m+1
k
by left multiplication, applying a geo-
metric generic point g of GLn+1,k(a,h) to a point ah−1 of Mn+1,m+1
k(a,h)
produces a geometric
generic point b = gah−1 of Mn+1,m+1
k(a,h)
.
By Lemma 3.5, because h is geometric generic over k(a) and b is geometric generic
over k(a, h), it follows that h is geometric generic over k(a, b).
□
Deﬁnition 3.8. For λ1, . . . , λn+1 in k×, let Diag(λ1, . . . , λn+1) be the diagonal matrix
in GLn+1(k) whose diagonal entries are λ1, . . . , λn+1.
13

Lemma 3.9. Let k be a ﬁeld and let n ⩾0 be an integer. Let g be a geometric generic
point of GLn+1,k, and let λ1, . . . , λn+1 be independent transcendentals over the ﬁeld k(g)
generated by the matrix coeﬃcients of g. Then:
(1) g Diag(λ1, . . . , λn+1)g−1 is a geometric generic point of GLn+1,k.
(2) g Diag(1, . . . , 1, λm+1, . . . , λn+1) is a geometric generic point of GLn+1,k for all
0 ⩽m ⩽n + 1.
Proof. Because (g, λ1, . . . , λn+1) is a geometric generic point of GLn+1,k ×Gn+1
m,k , to check
that an element of GLn+1,k(g,λ1,...,λn+1), expressed as a function of the tuple (g, λ1, . . . , λn+1)
is a geometric generic point of GLn+1,k, it suﬃces to check that the function in question
is a dominant map from GLn+1,k ×Gn+1
m,k to GLn+1,k. For g Diag(1, . . . , 1, λm+1, . . . , λn+1),
dominance is simply the fact that GLn+1,k acts transitively on itself by left multiplication
and for g Diag(λ1, . . . , λn+1)g−1 dominance is the well-known fact that generic matrices
are diagonalizable.
□
Lemma 3.10. Let k be a ﬁeld and let m and m′ be integers such that 0 ⩽m, m′ ⩽n and
0 ⩽m + m′ −n. Let a and a′ be independent geometric generic points of Mn+1,m+1
k
and
Mn+1,m′+1
k
deﬁned over a ﬁeld k′ (i.e. such that a′ is a geometric generic of Mn+1,m′+1
k(a)
).
Then there exists a geometric generic point b of Mn+1,m+m′−n+1
k
such that the image of
lb is the intersection of the images of la and la′ and such that la∗Qℓ⊗la′∗Qℓ= lb∗Qℓ.
Proof. View a and a′ as matrices of elements deﬁned over k′, and la(x)−la′(y) as a linear
map from k′m+1+m′+1 to k′n+1. Because a and a′ are generic and m + m′ −n ⩾0, this
map is surjective, with kernel of dimension m + m′ + 1 −n. We can choose a basis for
this kernel by row reduction, and then let the columns of b be a (equivalently a′) applied
to the vectors in this basis.
We can check that the point b is generic by restricting to the special case where the
ﬁrst m + m′ + 1 −n columns of a agree with the ﬁrst m + m′ + 1 −n columns of a′, and
the other columns are generic. In this case, b will consist of exactly these columns. Since
some specialization of generic matrices maps to a generic matrix, generic matrices also
map to a generic matrix.
The last claim, on pushforwards, follows from the deﬁnition and the calculation of the
intersection of the image.
□
Lemma 3.11. Let A and B be perverse sheaves on Pn
k. For a geometric generic point
g ∈GLn+1(k′), the object A ⊗l∗
gB[−n] is perverse.
Proof. The external product A ⊠B is perverse, and the sheaf A ⊗l∗
gB on Pn × GLn+1
is the pullback of A ⊠B by a smooth morphism of relative dimension (n + 1)2 −n, so
by [3, 4.2.5] is perverse after shifting by (n + 1)2 −n. We then take the pullback to the
ﬁber over a geometric generic point of GLn+1, which preserves perversity after shifting
by −(n + 1)2 by deﬁnition of perversity.
□
Lemma 3.12. Let a be a geometric generic point of Mn+1,m+1
k
.
Let A be an object
of Db
c(Pn
k). Then D(l∗
aA) = l∗
a D(A)[2(m −n)], and if A is perverse, then l∗
aA[m −n] is
perverse.
Proof. We view the linear map la as the composition of the map x 7→(x, a) from Pm to
Pm × Mm+1,n+1 with the matrix multiplication map Pm×Mm+1,n+1 →Pn. Observe that
matrix multiplication is a smooth morphism of relative dimension (m + 1)(n + 1) + m −n
and the pullback to the geometric generic point is an inverse limit of open immersions.
As in the previous lemma, the former preserve perversity after shifting by (m + 1)(n +
14

1) + m −n, and the latter after shifting by −(m + 1)(n + 1). The statements for duals
follow from the equality f ! = f ∗(d)[2d] for a smooth morphism f of relative dimension
d.
□
Lemma 3.13. Let 0 ⩽m ⩽n −1 be an integer, and let A be a perverse sheaf on Pn
k.
There exists a dense open subset U ⊂Mn+1,m+1
k
such that, for any geometric generic
point a of Mn+1,m+1
k
deﬁned over an algebraically closed ﬁeld k′ and for any b ∈U(¯k),
the complex l∗
bA[m −n] is perverse and satisﬁes
hi(Pm
k′, l∗
aA) = hi(Pm
¯k , l∗
bA)
for every i ∈Z.
Proof. Similarly to the proof of Lemma 3.12, we view the linear map lb as the composi-
tion of the map x 7→(x, b) from Pm to Pm × Mm+1,n+1 with the matrix multiplication
map mult: Pm × Mm+1,n+1 →Pn. Since mult is smooth, the pullback of A along it is
perverse up to shift by (m + 1)(n + 1) −(n −m), so it remains to show that, for any
perverse Qℓ-sheaf mult∗A[(m+1)(n+1)−(n−m)] on Pm×Mm+1,n+1, for b in some dense
open subset U, the pullback to the ﬁber over b is perverse up to shift by (m + 1)(n + 1).
To do this, we choose a Zℓ-structure on mult∗A[(m + 1)(n + 1) −(n −m)], obtaining
a perverse Zℓ-sheaf K, and we let U be an open set over which K ⊗¯Fℓis locally acyclic.
For any point b ∈U(¯k), after passing to a further open subset we may assume the closure
of b is smooth. Then, by [39, Cor. 8.10], the immersion x 7→(x, b) is K-transversal and
thus the pullback along this immersion is a shifted perverse sheaf, as desired.
The second property is granted by Lemma 3.3.
□
We need the following corollary of Theorem 2.2.
Corollary 3.14. Let A and B be objects of Db
c(Pn
k). For each geometric generic point g
of GLn+1,k over an algebraically closed ﬁeld k′, the following equality holds:
χ(Pn
k′, A ⊗l∗
gB) = (−1)nCC(A) · CC(B).
Proof. We will prove the statement for objects A and B of Db
c(Pn
k, Zℓ); the result then
follows for A and B in Db
c(Pn
k, Qℓ) by choosing an integral structure and noting that both
the Euler characteristic and the characteristic cycle are preserved by inverting ℓ.
We will check that the singular supports of A and l∗
gB fulﬁl the conditions of Theo-
rem 2.2. From (5) of loc. cit., we will then get the equality
χ(Pn
k′, A ⊗l∗
gB) = (−1)nCC(A) · CC(l∗gB) = (−1)nCC(A) · CC(B),
where the second identity follows from deformation-invariance of intersection numbers,
on noting that the algebraic cycles CC(B) and CC(l∗
gB) = l∗
gCC(B) lie in a family
parameterized by GLn+1,k.
The ﬁrst condition is that SS(A) ∩SS(l∗
gB) is contained in the zero section. In view of
Lemma 2.3, this amounts to showing that SS(A) ∩SS(l∗
gB) does not intersect P(T ∗Pn)
inside T ∗Pn. Note the equality SS(l∗gB) = l∗
gSS(B). The space of triples (x, y, g) such
that
x ∈SS(A) ∩P(T ∗Pn),
y ∈SS(B) ∩P(T ∗Pn),
g ∈GLn+1
and
lg(y) = x
is a bundle over SS(A) ∩P(T ∗Pn) × SS(B) ∩P(T ∗Pn). Since GLn+1 acts transitively
on P(T ∗Pn), all its ﬁbers have dimension (n + 1)2 −(2n −1), and hence the space itself
15

has dimension at most
dim

SS(A) ∩P(T ∗Pn)

+ dim

SS(B) ∩P(T ∗Pn)

+ (n + 1)2 −(2n −1)
= (n −1) + (n −1) + (n + 1)2 −(2n −1) = (n + 1)2 −1.
This dimension being less than (n + 1)2 = dim GLn+1, the ﬁber over generic g is empty,
which means that SS(A) ∩SS(l∗gB) does not intersect P(T ∗Pn).
The second condition is that every irreducible component of
SS(A) ×Pn SS(l∗
gB) = SS(A) ×Pn l∗
g SS(B)
has dimension at most n. It is suﬃcient to prove that every irreducible component of
the scheme over GLn+1 whose ﬁber over a point h is SS(A) ×Pn l∗
h SS(B) has dimension
at most (n + 1)2 + n, because then the generic ﬁber has dimension at most n. This
scheme maps to SS(A) × SS(B), which has dimension 2n, and the ﬁber over any point
consists of all elements of GLn+1 that send one point in Pn to another, so the ﬁber has
dimension (n + 1)2 −n and the total space has dimension (n + 1)2 + n, as desired.
□
Lemma 3.15. There exists a unique linear map fn : Zn+1 →Zn such that, for any
perverse sheaf A on Pn
k and any geometric generic point b of Mn+1,n
k
, the equality
cc(l∗
bA) = fn (cc(A))
holds. This linear map does not depend on k and ℓ.
Proof. Let Km be the perverse sheaf on Pn−1 described in Lemma 2.5.
It does not matter what geometric generic point b of Mn+1,n
k
we take, because any pair
of geometric generic points deﬁned over two diﬀerent ﬁelds are isomorphic after a suitable
extension of both ﬁelds. Let a be a geometric generic point of Mn+1,n
k
, g a geometric
generic point of GLn+1,k(a), and h a geometric generic point of GLn,k(a,g). Let b = gah−1.
Then Lemma 3.7 guarantees that b is a geometric generic point of Mn+1,n
k
and so we may
work with b.
Furthermore, h is a geometric generic point of GLn,k(b) by Lemma 3.7, and hence
Corollary 3.14 yields the equality
cc(l∗
bA) · cc(Km) = χ
 Pn−1
k′
, l∗
bA ⊗l∗
h−1Km

.
Furthermore, since h is generic, the right-hand side is equal to
χ
 Pn−1
k′
, l∗
hl∗
bA ⊗Km

= χ
 Pn−1
k′ , l∗
al∗
gA ⊗Km

= χ
 Pn
k′, l∗
gA ⊗la∗Km

= cc(A) · cc(la∗Km)
by the projection formula and Corollary 3.14, along with the fact that g is a geometric
generic point of GLn+1,k(a). Thus, cc(l∗
bA) · cc(Km) is a linear function of cc(A).
Because the cc(Km) form a basis, by Lemma 2.5, the pairings cc(l∗
bA)·cc(Km) of cc(l∗
bA)
with that basis can be used as coordinates of cc(l∗
bA). Because these pairings are linear
functions of cc(A), the class cc(l∗
bA) is a linear function of A.
By Lemma 2.5, the characteristic classes cc(Km) and cc(la∗Km) (which is just cc(Km)
in a diﬀerent projective space) are independent of ℓand k, and so the linear map is
independent of ℓand k.
□
Deﬁnition 3.16. For n ⩾0, let fn : Zn+1 →Zn be the linear map uniquely determined
in Lemma 3.15. We deﬁne inductively a bilinear form
bn : Zn+1 × Zn+1 →Z
16

by setting b0(x, y) = xy for (x, y) ∈Z × Z and
bn(x, y) = x · y + 4bn−1(fn(x), fn(y))
for n ⩾1 and (x, y) ∈Zn+1 × Zn+1, where x · y is the scalar product on Zn+1.
Proposition 3.17. For any perverse sheaves A and B in Db
c(Pn
k), and for any geometric
generic point g of GLn+1,k deﬁned over k′, the following holds:
X
i∈Z
hi(Pn
k′, A ⊗l∗
gB) ⩽bn (cc(A), cc(B)) .
Proof. We prove this proposition by induction on n. The case n = 0 is trivial, as then A
and B are simply vector spaces, their characteristic classes are their dimensions, and the
sum of Betti numbers is the product of the dimensions.
Assume the inequality holds in dimension n −1 and let A and B be perverse sheaves
in Db
c(Pn). By Lemma 3.11, the object A ⊗l∗
gB[−n] is perverse. Set
σ =
X
i∈Z
hi(Pn
k′, A ⊗l∗
gB),
which is the quantity we want to estimate.
By the deﬁnition of the Euler–Poincar´e
characteristic, we have
h−n(Pn
k′, A ⊗l∗
gB) = (−1)nχ(Pn
k′, A ⊗l∗
gB) +
X
i̸=−n
(−1)i+n+1hi(Pn
k′, A ⊗l∗
gB)
⩽(−1)nχ(Pn
k′, A ⊗l∗
gB) +
X
i̸=−n
hi(Pn
k′, A ⊗l∗
gB),
hence the inequality
σ =
X
i<−n
hi(Pn
k′, A ⊗l∗
gB) + h−n(Pn
k′, A ⊗l∗
gB) +
X
i>−n
hi(Pn
k′, A ⊗l∗
gB)
⩽2
X
i<−n
hi(Pn
k′, A ⊗l∗
gB) + (−1)nχ(Pn
k′, A ⊗l∗
gB) + 2
X
i>−n
hi(Pn−1
k′
, A ⊗l∗
gB).
Let now a ∈Mn+1,n(k′) be a geometric generic point of Mn+1,n
k(g)
deﬁned over an alge-
braically closed ﬁeld k′. By excision and the t-exactness of aﬃne morphisms, the canonical
map
Hi(Pn
k′, A ⊗l∗
gB) →Hi(Pn−1
k′
, l∗
a(A ⊗l∗
gB))
is an isomorphism in degrees less than −n. Because duality exchanges l∗
a and l!
a, and
because the dual of A ⊗l∗
gB[−n] is also perverse, the canonical map
Hi(Pn−1
k′ , l!
a(A ⊗l∗
gB)) →Hi(Pn
k′, A ⊗l∗
gB)
is an isomorphism in degrees greater than −n. We thus obtain
σ ⩽2
X
i∈Z
hi(Pn−1
k′
, l∗
a(A ⊗l∗
gB)) + (−1)nχ(Pn
k′, A ⊗l∗
gB) + 2
X
i∈Z
hi(Pn−1
k′ , l!
a(A ⊗l∗
gB)).
For a geometric generic point a, the functor l!
a coincides with l∗
a, up to a shift and Tate
twist, and hence
σ ⩽4
X
i∈Z
hi(Pn−1
k′
, l∗
a(A ⊗l∗
gB)) + (−1)nχ(Pn
k′, A ⊗l∗
gB).
17

Now we observe that l∗
a(A ⊗l∗
gB) = l∗
aA ⊗l∗
al∗
gB. Take h to be a geometric generic
point of GLn,k(a,g) and b = gah−1 . Then l∗
al∗
gB = l∗
hl∗
bB. By Lemma 3.7, h is generic
over k(a, b). Together with the induction hypothesis and Lemma 3.15, we deduce that
X
i∈Z
hi(Pn−1
k′
, l∗
aA ⊗l∗
hl∗
bB) ⩽bn−1(cc(l∗
aA), cc(l∗
bB)) = bn−1(fn(cc(A)), fn(cc(B))).
Finally, in view of the equality
(−1)nχ(Pn
k′, A ⊗l∗
gB) = cc(A) · cc(B)
given by Lemma 3.14, we obtain σ ⩽bn(cc(A), cc(B)) by deﬁnition of bn.
□
4. Test sheaves
The main result of this section is the construction, achieved in Corollary 4.13, of a
speciﬁc basis of the group CH(Pn
k), which will play an essential role in controlling the
complexity of a tensor product in the next section.
Deﬁnition 4.1 (Test sheaf). A test sheaf on Pn
k is a perverse sheaf A on Pn
k such that,
for any ﬁeld extension k′ of k, any perverse sheaf B on Pn
k′, and any generic point g
of GLn+1,k′ deﬁned over an algebraically closed ﬁeld extension k
′′ of k′, the cohomology
group Hi(Pn
k′, A ⊗l∗
gB) vanishes in all degrees i ̸= −n.
For example, a skyscraper sheaf A on Pn
k is a test sheaf, since the object A ⊗l∗
gB is a
skyscraper sheaf sitting in degree −n in that case.
Remark 4.2. The key properties of a test sheaf A are the following:
(1) the functor deﬁned on perverse sheaves by B 7→H−n(Pn
k′, A ⊗l∗
gB) is exact,
(2) the cohomology groups Hi(Pn
k′, A ⊗l∗
gB) and H−n(Pn
k′, A ⊗pH i(B)) agree, up to
renumbering, for all objects B of Db
c(Pn
k).
Test sheaves are most useful when they are of the form highlighted in the next deﬁnition:
Deﬁnition 4.3 (Strong test sheaf). Let d ⩾1 be an integer. A strong test sheaf of
depth d on Pn
k is a test sheaf A that admits a ﬁltration
0 = F0 ⊂F1 · · · ⊂Fd = A
such that, for each 1 ⩽j ⩽d, the quotient Fj/Fj−1 is isomorphic to a perverse sheaf (see
Lemma 3.12) of the form laj∗Qℓ[mj] for some 0 ⩽mj ⩽n and some aj ∈Mn+1,mj+1(k).
Strong test sheaves have the following crucial property:
Proposition 4.4. Let A be a strong test sheaf of depth d on Pn
k. The inequality
X
i∈Z
cc(A) · cc(pH i(B))
 ⩽dc(B)
holds for any ﬁeld extension k′ of k and any object B of Db
c(Pn
k′).
Proof. Denote by (Fj)1⩽j⩽d the terms of the ﬁltration from Deﬁnition 4.3.
Let g be a generic point of GLn+1,k′. By Corollary 3.14, we have:
X
i∈Z
cc(A) · cc(pH i(B))
 =
X
i∈Z
|χ(Pn
k′, A ⊗l∗
g
pH i(B))|
⩽
X
i∈Z
X
j∈Z
hj(Pn
k′, A ⊗l∗
g
pH i(B)).
18

Since A is a test sheaf, the vanishing Hj(Pn
k′, A ⊗l∗
g
pH i(B)) = 0 holds for all j ̸= −n,
and hence the spectral sequence computing Hi(Pn
k′, A ⊗l∗
gB) via the perverse ﬁltration
on B degenerates at the ﬁrst page. It follows that
X
i∈Z
X
j∈Z
hj(Pn
k′, A ⊗l∗
g
pH i(B)) =
X
i∈Z
hi(Pn
k′, A ⊗l∗
gB).
On the other hand, the spectral sequence associated to the ﬁltration (Fj) of A yields
the inequality of sums of Betti numbers
X
i∈Z
hi(Pn
k′, A ⊗l∗
gB) ⩽
d
X
j=1
X
i∈Z
hi(Pn
k′, (Fj/Fj−1) ⊗l∗
gB).
By assumption, there exist isomorphisms Fj/Fj−1 = laj∗Qℓ[mj] for some integer 0 ⩽mj ⩽n
and k-point aj of Mn+1,mj+1, so that the following equalities hold:
d
X
j=1
X
i∈Z
hi(Pn
k′, (Fj/Fj−1) ⊗l∗
gB) =
d
X
j=1
X
i∈Z
hi(Pn
k′, laj∗Qℓ⊗l∗
gB)
=
d
X
j=1
X
i∈Z
hi(P
mj
k′ , l∗
ajl∗
gB).
Since g is generic over k′, the product gaj is a generic point of Mn+1,m+1
k′
, and therefore
the deﬁnition of c(B) implies the inequality
d
X
j=1
X
i∈Z
hi(P
mj
k′ , l∗
ajl∗
gB) ⩽
d
X
j=1
c(B) = dc(B),
which concludes the proof.
□
We will now construct strong test sheaves forming a basis of CH(Pn
k).
Lemma 4.5. Let A and B be objects of Db
c(Pn
k). Let g be a generic point of GLn,k. Then
there is a canonical isomorphism
A ⊗l∗
gB ∼= (A ⊗! l∗
gB)[−2n].
Proof. Let l: Pn × GLn+1 →Pn × GLn+1 be the universal morphism given by
l(x, h) = (h · x, h)
and let π: Pn × GLn+1 →Pn be the projection. Then A ⊗l∗
gB and A ⊗! l∗
gB are the
generic ﬁbers of π∗A ⊗l∗π∗B and (π∗A ⊗! l∗π∗B)[−2(n + 1)2] respectively, so it suﬃces
to prove that the objects π∗A ⊗l∗π∗B and π∗A ⊗! l∗π∗B are isomorphic up to shift.
For this, consider the morphism (π, π ◦l): Pn × GLn+1 →Pn × Pn, which is smooth
because GLn+1 acts transitively on Pn. Since ⊗commutes with smooth pullbacks and ⊗!
commutes with smooth pullbacks up to shifting by twice the relative dimension, we obtain
isomorphisms
π∗A ⊗l∗π∗B = (π, π ◦l)∗(pr∗
1A ⊗pr∗
2B) ,
π∗A ⊗! l∗π∗B = (π, π ◦l)∗(pr∗
1A ⊗! pr∗
2B) [2(n + 1)2 −2n].
19

It is then enough to prove that pr∗
1A⊗pr∗
2B and pr∗
1A⊗! pr∗
2B are isomorphic up to shift.
This follows from the computation
pr∗
1A ⊗! pr∗
2B = D(D(pr∗
1A) ⊗D(pr∗
2B))
= D(pr∗
1 D(A)[2n] ⊗pr∗
2 D(B)[2n])
= pr∗
1 D(D(A)[2n]) ⊗pr∗
2 D(D(B)[2n])
= (pr∗
1A ⊗pr∗
2B)[−4n],
which uses the standard properties of Verdier duality and pr!
i = pr∗
i [2n].
□
Lemma 4.6. Let n ⩾0 be an integer. Let H1 and H2 be hyperplanes in Pn
k that intersect
transversely, and consider the commutative diagram
Pn
k −H1
Pn
k
Pn
k −(H1 ∪H2)
Pn
k −H2.
a
b
d
c
The object a∗b!Qℓ[n] is isomorphic to c!d∗Qℓ[n] and is a test sheaf.
Proof. By adjunction, there is a natural morphism c!d∗Qℓ→a∗b!Qℓextending the identity
on Pn
k −(H1∪H2), and it suﬃces to prove that this map is an isomorphism on stalks at all
geometric points of H1 ∪H2. This is obvious save for points of the intersection H1 ∪H2.
For those, we argue as follows: since H1 and H2 intersect transversely, ´etale locally around
each such point the diagram looks like
An−2
k
× (A1
k −{0}) × A1
k
An
k
An−2
k
× (A1
k −{0}) × (A1
k −{0})
An−2
k
× A1 × (A1
k −{0}).
a
b
d
c
Expressing the constant sheaf on the down left corner as an external product and let-
ting j : A1 −{0} ֒→A1 denote the inclusion, the K¨unneth formula then implies that the
map c!d∗Qℓ→a∗b!Qℓis locally given by the identity on Qℓ⊠j∗Qℓ⊠j!Qℓ.
We now proceed to the proof that a∗b!Qℓ[n] ≃c!d∗Qℓ[n] is a test sheaf.
First of
all, we check that a∗b!Qℓ[n] is perverse.
Indeed, all maps in the diagram are aﬃne
open immersions, and the direct image and exceptional direct image by those preserve
perversity. Next, let B be a perverse sheaf on Pn
k and let i ∈Z. Using the projection
formula, we get the equalities
Hi(Pn
k′, c!d∗Qℓ[n] ⊗l∗
gB) = Hi+n(Pn
k′, c!(d∗Qℓ⊗c∗l∗
gB))
= Hi+n
c
(Pn
k′ −H2, d∗Qℓ⊗c∗l∗
gB)
= Hi+n
c
(Pn
k′ −H2, c∗(c!d∗Qℓ⊗l∗
gB)).
The object c!d∗Qℓ⊗l∗
gB is perverse by Lemma 3.11. Since pullbacks by open immer-
sions preserve perversity, the object c∗(c!d∗Qℓ⊗c∗l∗
gB) is a perverse sheaf on the aﬃne
variety Pn
k′ −H2, and hence its compactly supported cohomology vanishes when i+n < 0
by Artin’s vanishing theorem.
20

Dually, using Lemma 4.5, we get
Hi(Pn
k′, a∗b!Qℓ[n] ⊗l∗
gB) = Hi−n(Pn
k′, a∗b!Qℓ⊗! l∗
gB)
= Hi−n(Pn
k′, a∗(b!Qℓ⊗! a∗l∗
gB))
= Hi−n(Pn
k′ −H1, b!Qℓ⊗! a∗l∗
gB)
= Hi+n(Pn
k′ −H1, a∗(a∗b!Qℓ⊗! l∗
gB)[−2n]).
Arguing as above using Lemma 4.5, we see that a∗(a∗b!Qℓ⊗! l∗
gB)[−2n] is a perverse
sheaf on the aﬃne variety Pn
k′ −H1, so that its cohomology vanishes for i + n > 0 by
Artin’s vanishing theorem. This completes the proof.
□
Lemma 4.7. Let a ∈Mn+1,m+1
k
(k). If A is a test sheaf on Pm
k , then la∗A is a test sheaf
on Pn
k.
Proof. Let B be a perverse sheaf on Pn
k′ and let g be a generic point in GLn+1,k′. By the
projection formula, we have
Hi(Pn
k′, la∗A ⊗l∗
gB) = Hi(Pm
k′, A ⊗l∗
al∗
gB).
Let h be a generic point of GLm+1,k′(a,g). Set b = gah−1 and k′′ = k′(a, g, h). By
Lemma 3.7, the point b is a generic linear embedding and h is generic over the ﬁeld of
deﬁnition of k′(b), so that
Hi(Pm
k′′, A ⊗l∗
al∗
gB) = Hi(Pm
k′′, A ⊗l∗
hl∗
bB) = Hi+n−m(Pm
k′′, A ⊗l∗
hl∗
bB[m −n]).
Because b is generic, the object l∗
bB[m−n] is perverse by Lemma 3.12, and therefore this
cohomology group vanishes for i + n −m ̸= −m, i.e., for i ̸= −n.
□
Deﬁnition 4.8 (Standard test sheaf). For each integer 0 ⩽m ⩽n, pick a point am ∈
Mn+1,m+1(k) and pick transversal hyperplanes H1 and H2 in Pm
k . As in Lemma 4.6, let
c: Pm
k −H2 →Pm
k and d: Pn
k −(H1 ∪H2) →Pm
k −H2 be the corresponding immersions.
Deﬁne the m-th standard test sheaf Am as
Am = lam∗c!d∗Qℓ[m].
Remark 4.9. In the case m = 0, choosing a0 amounts to choosing a k-point of Pn
k, the
only possible choices for H1 and H2 are the empty hyperplanes in P0
k = Spec k, and A0
is a skyscraper sheaf supported at the chosen point.
Corollary 4.10. For each 0 ⩽m ⩽n, the object Am is a strong test sheaf on Pn
k of
depth at most 4.
Proof. The fact that Am is a test sheaf follows from applying Lemma 4.6 and Lemma 4.7.
Because la∗preserves constant sheaves on linear subspaces, it preserves any ﬁltration into
constant sheaves on linear subspaces of the type required for a strong test sheaf, and thus
it suﬃces to ﬁnd such a ﬁltration for c!d∗Qℓ.
We use the notation of Lemma 4.6. Let h be the closed immersion of H2 into Pm
k .
Since c is an open immersion, there is a base change isomorphism d∗Qℓ= c∗a∗Qℓ. By ad-
junction, there is hence a morphism c!d∗Qℓ= c!c∗a∗Qℓ→a∗Qℓ, which is an isomorphism
away from H2. Because c!d∗Qℓvanishes on H2, the morphism c!d∗Qℓ→a∗Qℓhas map-
ping cone h∗a∗Qℓ. The complex a∗Qℓhas a ﬁltration whose associated quotients are the
constant sheaf and a shift of the constant sheaf on H1, so h∗a∗Qℓhas a ﬁltration whose
associated quotients are the constant sheaf on H2 and a shift of the constant sheaf on the
intersection H1∩H2. The mapping cone triangle gives the desired ﬁltration of c!d∗Qℓ.
□
21

Remark 4.11. (1) One can also give a proof “by pure thought” of this proposition, based
on the fact that Am is equivariant for the subgroup of PGLm+1 acting on Pm
k and pre-
serving the hyperplanes H1 and H2. Because this group action has ﬁnitely many orbits,
and its stabilizers are connected, one can show that the only irreducible elements of the
category of perverse sheaves invariant under this group are the intersection cohomology
complexes of the closures of the orbits, which in this case are simply the constant sheaves
on Pm, H1, H2, and H1 ∩H2. An analogous method is used in the theory of the geomet-
ric Satake isomorphism to classify perverse sheaves on the aﬃne Grassmanian that are
equivariant for the left action of the formal arc group (see, e.g., [21, proof of Prop. 1]).
(2) The standard test sheaves depend on the choices in Deﬁnition 4.8; whenever we
use them, we assume implicitly these choices have been made for all m, and that they
are the same in the remainder of the arguments.
Lemma 4.12. Let (Aj)0⩽j⩽n be standard test sheaves. The following holds:
cc(Am1) · cc(Am2) =
(
0
if m1 + m2 < n,
1
if m1 + m2 = n.
Proof. This is a straightforward consequence of Corollary 3.14, which identiﬁes the inter-
section number cc(Am1) · cc(Am2) with (−1)nχ(Pn
k′, Am1 ⊗l∗
gAm2). Indeed, the support
of Am is of dimension m. If m1 + m2 < n, it follows that the support of Am1 does not
intersect that of Am2 after generic translation, and consequently their tensor product
vanishes, from which cc(Am1) · cc(Am2) = 0 follows. Similarly, if m1 + m2 = n, the sup-
port of of Am1 intersects that of Am2 after generic translation at a single point. At this
point, both sheaves have stalk Qℓ, so their tensor product is a skyscraper sheaf and has
Euler–Poincar´e characteristic 1.
□
Corollary 4.13. Let (Aj)0⩽j⩽n be standard test sheaves on Pn
k. Then the characteristic
classes (cc(Aj))0⩽j⩽n form a basis of CH(Pn
k) ≃Zn+1.
Proof. Indeed, by Lemma 4.12, the matrix of intersection pairings between the charac-
teristic classes cc(Ai) is invertible.
□
5. Complexity of a tensor product
In this section, we prove the crucial theorem showing that the complexity controls the
sum of Betti numbers of a tensor product of complexes of ℓ-adic sheaves, namely:
Theorem 5.1. Let A and B be objects of Db
c(Pn
k). Then the estimate
X
i∈Z
hi(Pn
k, A ⊗B) ≪c(A)c(B)
holds, with an implied constant that only depends on n.
Remark 5.2. In Theorem 8.1, we state and sketch a proof of a version of this result with
an explicit constant.
Before starting the proof, we show how this implies an important corollary.
Corollary 5.3. Let A and B be objects of Db
c(Pn
k). Then the estimate
c(A ⊗B) ≪c(A)c(B)
holds, with an implied constant that only depends on n.
22

Proof. Let g be a geometric generic point of GLn+1,k. For 0 ⩽m ⩽n, let am be a
geometric generic point of Mn+1,m+1
k
. From the deﬁnition of complexity and Theorem 5.1,
we get the estimate
c(A ⊗B) = sup
0⩽m⩽n
X
i∈Z
hi(Pn
k, A ⊗B ⊗lam∗Qℓ)
≪c(A)
sup
0⩽m⩽n
c(B ⊗lam∗Qℓ).
For 0 ⩽m′ ⩽n, let a′
m′ be a geometric generic point of Mn+1,m′+1
k(am)
. Again by deﬁnition,
the complexity above is given by
c(B ⊗lam∗Qℓ) =
sup
0⩽m′⩽n
X
i∈Z
hi(Pn
k, B ⊗lam∗Qℓ⊗la′
m′∗Qℓ)
for any m ⩽n. By Lemma 3.10, the equality lam∗Qℓ⊗la′
m′∗Qℓ= lb∗Qℓholds for a
geometric generic point b of Mn+1,m+m′−n+1
k
. This implies the inequality
X
i∈Z
hi(Pn
k, B ⊗lam∗Qℓ⊗la′
m′∗Qℓ) ⩽c(B)
for any m and m′, from which the result follows.
□
The strategy for proving Theorem 5.1 consists in ﬁrst establishing a “generic” version
of it, and then deducing from this the precise statement. In what follows, we denote
by (Am)0⩽m⩽n the family of standard test sheaves from Deﬁnition 4.8. For x ∈Rn+1 =
CH∗(Pn) ⊗R, we set
∥x∥=
n
X
m=0
|x · cc(Am)|
Because (cc(Am))0⩽m⩽n is a basis of CH∗(Pn), by Corollary 4.13, and the intersection
form is non-degenerate, this is simply the ℓ1-norm in the dual basis, and in particular
deﬁnes a norm on Rn+1.
Proposition 5.4. For any object B of Db
c(Pn
k), the following inequality holds:
X
i∈Z
∥cc(pH i(B))∥⩽4(n + 1)c(B).
Proof. Let 0 ⩽m ⩽n. Because Am is a strong test sheaf of depth at most 4, Proposi-
tion 4.4 yields the inequality
X
p∈Z
|cc(pH p(B)) · cc(Am)| ⩽4c(B).
Thus, we have
X
p∈Z
∥cc(pH p(B))∥=
n
X
m=0
X
p∈Z
|cc(pH p(B) · cc(Am)| ⩽4(n + 1)c(B).
□
The second part of the next corollary shows that the complexity of a complex of sheaves
is, up to constants, the sum of the norms of the characteristic cycles of its perverse
cohomology sheaves.
Corollary 5.5. Let A and B be objects of Db
c(Pn
k).
23

(1) For a generic point g of GLn+1,k deﬁned over k′, the estimate
X
i∈Z
hi(Pn
k′, A ⊗l∗
gB) ≪c(A)c(B)
holds, with an implied constant that only depends on n.
(2) We have
c(B) ≍
X
i∈Z
∥cc(pH i(B))∥,
where the implied constants depend only on n.
Proof. For the proof of (1), we apply the spectral sequences associated to the perverse
ﬁltrations of A and B to get
X
i∈Z
hi(Pn
k′, A ⊗l∗
gB) ⩽
X
p∈Z
X
q∈Z
X
i∈Z
hi(Pn
k′, pH p(A) ⊗l∗
g
pH q(B)).
Applying Proposition 3.17, and denoting by Mn the norm of the bilinear form bn, so that
the inequality bn(α, β) ⩽Mn∥α∥∥β∥holds for any α and β, we get
X
i∈Z
hi(Pn
k′, A ⊗l∗
gB) ⩽Mn
X
p∈Z
X
q∈Z
∥cc(pH p(A))∥∥cc(pH q(B))∥,
which is at most 16(n + 1)2Mnc(A)c(B) by Proposition 5.4.
For (2), one bound follows from Proposition 5.4. In the other direction, we begin as
above (with the same g) until we reach the bound
X
i∈Z
hi(Pn
k′, A ⊗l∗
gB) ≪
X
p∈Z
∥cc(pH p(A))∥
X
q∈Z
∥cc(pH q(B))∥.
Taking A = lam∗Qℓ, where am is an arbitrary element of Mn+1,m+1(k), this gives
X
i∈Z
hi(Pm
k′, l∗
aml∗
gB) ≪
X
q∈Z
∥cc(pH q(B))∥
for 0 ⩽m ⩽n. This implies the desired bound, since gam is a generic point of Mn+1,m+1
k
by Lemma 3.6.
□
Our main theorem in this section is the same as Corollary 5.5, but without the generic
pullback l∗
g. To remove it, we will use a double induction strategy. We view a generic
point g of GLn+1 as a generic diagonal matrix conjugated by a generic invertible matrix.
We will show that the theorem remains true if some of the entries of the diagonal matrix
are set to 1, by induction on the number of entries. Once all the diagonal entries are set
to 1, any conjugate is the identity matrix, and so we obtain our desired statement.
At each step, we have a family of cohomology groups parameterized by Gm, i.e. a
complex of sheaves on Gm, and we want to bound the stalk at the identity using the
stalk at the generic point. In general, the stalk at the generic point could be very small
and the stalk at the identity could still be very large. However, we will now show that this
cannot happen as long as we also control the cohomology. In our case, it turns out that
controling the cohomology corresponds to a lower-dimensional version of the problem,
and we may use induction on the dimension to achieve our goal.
Lemma 5.6. For each object A of Db
c(Gm,k), the inequality
(1)
X
i∈Z
dim H i(A)1 ⩽
X
i∈Z
dim H i(A)η +
X
i∈Z
hi
c(Gm,k, A)
holds, where η denotes the generic point of Gm,k.
24

Proof. We ﬁrst reduce the proof to the case when A is perverse. On the one hand, the
spectral sequence associated to the perverse ﬁltration of A gives the inequality
X
i∈Z
dim H i(A)1 ⩽
X
j∈Z
X
i∈Z
dim H i(pH j(A))1.
On the other hand, because perverse sheaves are supported in a single degree at the
generic point, we have
X
i∈Z
dim H i(A)η =
X
j∈Z
X
i∈Z
dim H i(pH j(A))η.
Because the compactly supported cohomology of an aﬃne curve with coeﬃcients in a
perverse sheaf is concentrated in degrees 0 and 1, the spectral sequence for the perverse
ﬁltration of A degenerates and
X
i∈Z
hi
c(Gm,k, A) =
X
j∈Z
X
i∈Z
hi
c(Gm,k, pH j(A)).
Therefore, it is suﬃcient to prove the inequality (1) when A is a perverse sheaf.
If A is perverse, most of the terms in the sums in (1) vanish. Removing all the terms
that are known to vanish, the desired inequality can be stated as
dim H 0(A)1 + dim H −1(A)1 ⩽dim H −1(A)η + h0
c(Gm,k, A) + h1
c(Gm,k, A).
Since dim H −1(A)1 ⩽dim H −1(Aη), it suﬃces to show the inequality
dim H 0(A)1 ⩽h0
c(Gm,k, A) + h1
c(Gm,k, A),
or even
χc(Gm,k, A) ⩾dim H 0(A)1.
This follows from the Euler–Poincar´e characteristic formula for perverse sheaves on
smooth curves, where the local term at the point 1 is at least dim H 0(A)1, all other
local terms are non-negative, and the global term is a multiple of the Euler–Poincar´e
characteristic of Gm and hence vanishes.
□
Let n ⩾1 be an integer. For each point g of GLn+1,k valued in an algebraically closed
ﬁeld, the ﬁxed points of the linear map lg are the projectivizations of the eigenspaces
of g. In particular, for any λ ̸= 1, the ﬁxed points of lDiag(λ,1,...,1) on Pn consist of the
isolated point x0 = [1 : 0 : · · · : 0] and the hyperplane H0 = {[0 : a1 : · · · : an]}. We
identify H0 with Pn−1.
In the next two lemmas, we will denote by U ⊆Pn the complement of {x0} ∪H0,
by j : U →Pn the corresponding open immersion, and by π: U →H0 ≃Pn−1 the
projection map from U to the hyperplane H0. We also denote by p: {x0} →Pn the
closed immersion of the isolated ﬁxed point and by h: H0 = Pn−1 →Pn the closed
immersion of the hyperplane.
Lemma 5.7. Let n ⩾1 be an integer. Let A and B be objects of Db
c(Pn
k). Let λ be a
geometric generic point of Gm,k deﬁned over an algebraically closed ﬁeld k′. With notation
25

as above, the following inequality holds:
X
i∈Z
hi(Pn
k, A ⊗B) ⩽
X
i∈Z
hi(Pn
k′, A ⊗l∗
Diag(λ,1,...,1)B)
+ 2
X
i∈Z
hi(Spec(k), p∗A ⊗p∗B) + 2
X
i∈Z
hi(Pn−1
k
, h∗A ⊗h∗B)
+
X
i∈Z
hi(Pn−1
k
, π!j∗A ⊗π!j∗B).
Proof. Let K be the pushforward of A ⊗l∗
Diag(µ,1,...,1)B from Pn × Gm to Gm, where Gm
has coordinate µ. Proper base change yields the equalities
X
i∈Z
dim H i(K)1 =
X
i∈Z
hi(Pn
k, A ⊗B),
X
i∈Z
H i(K)η =
X
i∈Z
hi(Pn
k′, A ⊗l∗
Diag(λ,1,...,1)B).
Hence, by Lemma 5.6, it suﬃces to prove the inequality
X
i∈Z
hi
c(Gm,k, K) ⩽2
X
i∈Z
hi(Spec(k), p∗A ⊗p∗B)
+ 2
X
i∈Z
hi(Pn−1
k
, h∗A ⊗h∗B) +
X
i∈Z
hi(Pn−1
k
, (π!j∗A) ⊗(π!j∗B)).
By the Leray spectral sequence, the equality
(2)
X
i∈Z
hi
c(Gm,k, K) =
X
i∈Z
hi
c
 Pn × Gm, A ⊗l∗
Diag(µ,1,...,1)B

.
holds. To compute the right-hand side, we partition Pn × Gm = X0 ∪X1 ∪X2 as
X0 = {x0} × Gm,
X1 = H0 × Gm,
X2 = U × Gm.
Note that X0 and X1 are closed, and X2 is open. By excision, the right-hand side of (2)
is bounded by
2
X
j=0
X
i∈Z
hi
c(Xj, A ⊗l∗
Diag(µ,1,...,1)B).
Since X0 and X1 are ﬁxed points of l∗
Diag(λ,1,...,1) for all λ, the restriction of the complex
A ⊗l∗
Diag(λ,1,...,1)B to either of them is the same as that of A ⊗B. The K¨unneth formula
gives
H∗
c(X0, A ⊗B) ≃H∗({x0}, A ⊗B) ⊗H∗
c(Gm, Qℓ)
H∗
c(X1, A ⊗B) ≃H∗(H0, A ⊗B) ⊗H∗
c(Gm, Qℓ),
and hence (since the sum of Betti numbers of Gm is equal to 2) we get
X
i∈Z
hi
c(X0, A ⊗B) = 2
X
i∈Z
hi({x0}, A ⊗B) = 2
X
i∈Z
hi(Spec(k), p∗A ⊗p∗B)
X
i∈Z
hi
c(X1, A ⊗B) = 2
X
i∈Z
hi(H0, A ⊗B) = 2
X
i∈Z
hi(Pn−1, h∗A ⊗h∗B).
Finally, note that the Gm-action on U is free, so that there is an isomorphism between
X2 and the space of pairs of points (x, y) in U ×U such that x and y lie in the same orbit
of the Gm-action, which identiﬁes the projection to U and the pullback along lDiag(λ,1,...,1)
with the ﬁrst and the second projections.
The space of such pairs is isomorphic to
26

the ﬁber product of U with itself over the quotient U/Gm. There is an isomorphism
U/Gm ≃H0 ≃Pn−1 induced by π, hence the equality
X
i∈Z
hi
c(X2, A ⊗l∗
Diag(λ,1,...,1)B) =
X
i∈Z
hi
c(U ×Pn−1 U, j∗A ⊠j∗B).
By the K¨unneth formula (or the projection formula applied twice), the right-hand side is
also equal to
X
i∈Z
hi
c(U, A ⊗π!j∗B) =
X
i∈Z
hi(Pn−1
k
, π!j∗A ⊗π!j∗B).
Gathering all these computations, we obtain the result.
□
Lemma 5.8. Let n ⩾1. Let A be an object of Db
c(Pn
k) and let g be a geometric generic
point of GLn+1,k deﬁned over an algebraically closed ﬁeld k′. Then the following inequal-
ities hold:
c(h∗l∗
gA) ⩽c(A),
c(π!j∗l∗
gA) ⩽3c(A),
X
i∈Z
hi(Spec(k′), p∗l∗
gA) ⩽c(A).
Proof. For each 0 ⩽m ⩽n −1, let am be a geometric generic point of Mn,m+1
k(g)
. By
deﬁnition,
c(h∗l∗
gA) = sup
m
X
i∈Z
hi(Pm, l∗
amh∗l∗
gA).
The composition lg ◦h◦lam is a generic linear embedding from Pm to Pn, and hence this
quantity is ⩽c(A) by deﬁnition.
For any i ∈Z, by proper base change, there is an isomorphism
(3)
Hi(Pm, l∗
amπ!j∗l∗
gA) = Hi(π−1lam(Pm), l∗
gA).
The inverse image π−1lam(Pm) is of the form
L −{x0} −(H0 ∩L),
where L is a general (m + 1)-dimensional subspace of Pn that contains x0. By excision,
the sum of the Betti numbers of (3) is at most
X
i∈Z
hi(L, l∗
gA) +
X
i∈Z
hi({x0}, l∗
gA) +
X
i∈Z
hi(H0 ∩L, l∗
gA).
Each of these is bounded by c(A) (since am and lg are generic, see Lemmas 3.5 and 3.6),
hence c(π!j∗l∗
gA) ⩽3c(A).
Finally, lg ◦p is the inclusion map of a generic point, so the inequality
X
i∈Z
hi(Spec(k′), p∗l∗
gA) ⩽c(A)
holds by the deﬁnition of c(A).
□
We are ﬁnally ready to prove the main theorem of this section.
Proof of Theorem 5.1. We prove the theorem by induction on n ⩾0. The theorem holds
for n = 0, because A and B are then simply complexes of vector spaces so
c(A) =
X
i∈Z
hi(P0, A),
27

and hence
X
i∈Z
hi(P0, A ⊗B) =
X
i∈Z
hi(P0, A)
X
i∈Z
hi(P0, B).
Now assume that n ⩾1 and that Theorem 5.1 holds for Pn−1.
Let g be a generic point of GLn+1,k and let λ1, . . . , λn+1 be independent transcendentals
over k(g). Let k′ be an algebraically closed extension of k(g) containing λ1, . . . , λn+1.
For 1 ⩽m ⩽n + 1, we denote
δm = Diag(1, . . . , 1, λm, . . . , λn+1).
Then
X
i∈Z
hi(Pn
k, A ⊗B) =
X
i∈Z
hi(Pn
k′, l∗
gA ⊗l∗
gB) =
X
i∈Z
hi(Pn
k′, l∗
Diag(1,...,1)l∗
gA ⊗l∗
gB).
On the other hand, we have
X
i∈Z
hi(Pn
k′, l∗
δn+1l∗
gA ⊗l∗
gB) =
X
i∈Z
hi(Pn
k′, A ⊗l∗
gδn+1g−1B)
≪c(A)c(B)
by Corollary 5.5 (1) and Lemma 3.9 (1).
Therefore, using a telescoping sum, we get
X
i∈Z
hi(Pn
k, A ⊗B)
=
n+1
X
m=1
X
i∈Z
hi(Pn
k′, l∗
gA ⊗l∗
δm+1l∗
gB) −
X
i∈Z
hi(Pn
k′, l∗
gA ⊗l∗
δml∗
gB)

+ O(c(A)c(B)).
By Lemma 5.7, for a ﬁxed m, the term between parentheses is
⩽2
X
i∈Z
hi(Spec k′, p∗l∗
gA ⊗p∗l∗
δm+1l∗
gB)
+ 2
X
i∈Z
hi(Pn−1
k′
, h∗l∗
gA ⊗h∗l∗
δm+1l∗
gB)
+
X
i∈Z
hi(Pn−1
k′
, (π!j∗l∗
gA) ⊗(π!j∗l∗
δm+1l∗
gB)).
Applying the induction hypothesis, this is
≪2c(p∗l∗
gA)c(p∗l∗
δm+1l∗
gB) + 2c(h∗l∗
gA)c(h∗l∗
δm+1l∗
gB) + c(π!j∗l∗
gA)c(π!j∗l∗
δm+1l∗
gB)
and ﬁnally, applying Lemma 5.8 and Lemma 3.9 (2), this is
⩽2c(A)c(B) + 2c(A)c(B) + 9c(A)c(B) = 13c(A)c(B).
This concludes the proof.
□
6. Quantitative sheaf theory on quasi-projective varieties
The goal of this section is to deﬁne the complexity of objects of the derived category
for any quasi-projective algebraic variety over a ﬁeld, or rather the pair consisting of such
a variety and a given quasi-projective embedding.
28

6.1. Deﬁnition of complexity and continuity of the six operations. It turns out
that it is not really possible to deﬁne a complexity invariant of sheaves on an algebraic
variety, with its expected properties, that only depends on the algebraic variety. We give
two examples, related to two desirable properties of a complexity function (the second
was suggested by an anonymous referee).
Example 6.1. (1) A hypothetical canonical complexity invariant c(A) for objects A of
Db
c(X) should of course be invariant under automorphisms of X. Another basic require-
ment for applications of a complexity invariant should be that, if F is a ﬁnite ﬁeld and k
an algebraic closure of F, then there should be, up to isomorphism over k, only ﬁnitely
many irreducible perverse sheaves of bounded complexity (see Corollary 7.15). However,
there are examples of algebraic varieties X over F with inﬁnitely many F-automorphisms
and perverse sheaves A on X such that there are inﬁnitely many pairwise non-isomorphic
perverse sheaves among the σ∗A for such automorphisms σ (e.g., let X be the aﬃne plane,
and let A be a suitable shift of the constant sheaf Qℓon an irreducible plane curve).
(2) Consider X = A2, with coordinates (x, y). For any polynomial f ∈k[x, y], the
map uf : (x, y) 7→(x, y −f(x)) is an automorphism of X.
Let i: A1 →X be the
closed immersion x 7→(x, 0). For any complexity function c on Db
c(X) that satisﬁes
the “bilinearity” property of Corollary 5.3 and is invariant under automorphisms, the
following estimate would hold:
c(i∗Qℓ[1] ⊗u∗
f(i∗Qℓ[1])) ≪1.
This is impossible since the support of i∗Qℓ[1] ⊗u∗
f(i∗Qℓ[1]) is the intersection of the
line y = 0 and its image under uf, which can be an arbitrarily large ﬁnite set. A similar
projective example arises from X = E × E for an elliptic curve E, with the immersion
E ≃E × {0} →E × E and the automorphisms (x, y) 7→(x, y + nx) for n ∈Z.
We will work instead with pairs (X, u) consisting of an algebraic variety X over k and
a locally closed immersion u: X →Pn
k for some integer n ⩾0, called the embedding
dimension of (X, u).
Remark 6.2. (1) Recall that a locally closed immersion u is a morphism that can be
factored as u = i ◦j, where j is an open immersion and i is a closed immersion.
(2) We will often simply denote by X the pair (X, u), when no confusion is possible,
and call this simply a quasi-projective variety. We will also sometimes do this over a more
general base S than the spectrum of a ﬁeld.
Deﬁnition 6.3 (Complexity of a complex of sheaves on a quasi-projective variety).
Let (X, u) be a quasi-projective variety over an algebraically closed ﬁeld k. The complex-
ity relative to u of an object A of Db
c(X) is the non-negative integer
cu(A) = c(u!A).
When the embedding is clearly understood, we will simply speak of the complexity of A.
Remark 6.4. The complexity cu(A) vanishes if and only if A = 0 (Proposition 3.4).
The ﬁrst main objective is to prove that the complexity is under control when perform-
ing all usual operations, starting with Grothendieck’s six functors (i.e., in the language
used in the introduction, these functors are “continuous”). For this purpose, we will also
deﬁne a complexity invariant for morphisms.
Deﬁnition 6.5 (Complexity of a locally closed immersion). Let (X, u) be a quasi-
projective variety over k. We deﬁne the complexity of u to be
c(u) = cu(Qℓ) = c(u!Qℓ).
29

Deﬁnition 6.6 (Complexity of a morphism). Let f : (X, u) →(Y, v) be a morphism of
quasi-projective varieties over k. Let m and n be the embedding dimension of X and Y
respectively. For integers 0 ⩽p ⩽m and 0 ⩽q ⩽n, let ap and bq be geometric generic
points of Mm+1,p+1
k
and Mn+1,q+1
k
respectively, all deﬁned over a common algebraically
closed ﬁeld k′.
The complexity of the morphism f relative to (u, v) is deﬁned as
cu,v(f) = max
0⩽p⩽m max
0⩽q⩽n
X
i∈Z
hi
c(Xk′, u∗lap∗Qℓ⊗f ∗v∗lbq∗Qℓ).
In the vein of Lemma 3.3, the deﬁnition of cu,v(f) can be phrased in terms of closed
points over a dense open subset W ⊂Mm+1,p+1
k
×Mn+1,q+1
k
rather than geometric generic
points. Namely, letting Γ ⊂Pm × Pn denote the graph of f relative to the locally closed
immersions u and v, there exist such W with the property that the above Betti numbers
are equal to
hj
c(Γ ∩(ker(lap) × ker(lbq)), Qℓ)
for all points (ap, bq) ∈W(¯k).
Remark 6.7. These deﬁnitions are compatible in the sense that, for a locally closed
immersion u: X →Pn, using Lemma 3.10, we have cu,Id(u) = c(u).
In a similar vein, if i: X →Y is an immersion of quasi-projective varieties (X, u)
and (Y, v), such that u = v ◦i, then cu,v(i) = c(u), which can be seen readily from the
deﬁnition, the projection formula and Lemma 3.10.
The fundamental result is the following:
Theorem 6.8 (Continuity of the six operations). Let (X, u) and (Y, v) be quasi-projective
varieties over k, and let f : X →Y be a morphism. For objects A and B of Db
c(X) and C
of Db
c(Y ), the following estimates hold:
cu(D(A)) ≪c(u)cu(A)
(4)
cu(A ⊗B) ≪cu(A)cu(B)
(5)
cu(A ⊗! B) ≪c(u)3cu(A)cu(B)
(6)
cu(H om(A, B)) ≪c(u)cu(A)cu(B)
(7)
cu(f ∗C) ≪cu,v(f)cv(C)
(8)
cv(f!A) ≪cu,v(f)cu(A)
(9)
cu(f !C) ≪c(u)c(v)cu,v(f)cv(C)
(10)
cv(f∗A) ≪c(u)c(v)cu,v(f)cu(A).
(11)
In all these estimates, the implied constants only depend on the embedding dimensions
of (X, u) and (Y, v).
In the next subsection, we will prove Theorem 6.8. In later subsections, we will then
handle similarly a number of additional operations, e.g., decomposing a complex into
irreducible perverse sheaves.
Remark 6.9. Let k0 be a ﬁeld of characteristic coprime to ℓ. For any quasi-projective
variety (X0, u0) over k0 and any object A0 of Db
c(X0), we set
cu0(A0) = cu(A),
30

where (X, u) is the base change of (X0, u0) to an algebraically closed ﬁeld extension k
of k0 and A is the base change of A0. Similarly, we deﬁne the complexity of a morphism
f0 : (X0, u0) →(Y0, v0) as
cu0,v0(f0) = cu,v(f),
where f is the base change of f0 to an algebraically closed ﬁeld. Since the complexity
is independent of the chosen algebraically closed ﬁeld, Theorem 6.8 also holds for the
complexity over non-algebraically closed ﬁelds.
Remark 6.10. Theorem 1.1 from the introduction follows from Theorem 6.8 applied
to X = An and Y = Am with u and v the standard open immersions to Pn and Pm
respectively.
6.2. Proof of the continuity of the six functors. We begin with a lemma concerning
complexes on projective space.
Lemma 6.11. For each object A of Db
c(Pn
k), the equality c(A) = c(D(A)) holds.
Proof. Let a be a geometric generic point of of Mn+1,m+1
k
. Using Verdier duality and
Lemma 3.12, the computation
X
i∈Z
hi(Pm, l∗
aA) =
X
i∈Z
hi(Pm, D(l∗
aA)) =
X
i∈Z
hi(Pm, l∗
a D(A))
yields c(A) = c(D(A)) by deﬁnition of complexity.
□
Proof of (4). The equalities
cu(D(A)) = c(u! D(A)) = c(u∗D(A) ⊗u!Qℓ)
hold by deﬁnition, and hence we get the estimate
cu(D(A)) = c(D(u!A) ⊗u!Qℓ) ≪c(D(u!A))c(u!Qℓ) = c(u!A)c(u!Qℓ) = cu(A)c(u)
by combining Corollary 5.3 and Lemma 6.11.
□
Proof of (5) and (6). By deﬁnition, we have
cu(A ⊗B) = c(u!(A ⊗B)).
Then by Corollary 5.3, we obtain
cu(A ⊗B) = c(u!(A ⊗B)) = c(u!A ⊗u!B) ≪c(u!A)c(u!B) = cu(A)cu(B).
Combining this with (4), we obtain (6).
□
Proof of (7). We have by deﬁnition of internal Hom
cu(H om(A, B)) = cu(D(A) ⊗B) ≪cu(D(A))cu(B) ≪c(u)cu(A)cu(B),
where the estimates follow by applying (5) and (4).
□
Proof of (8) and (9). Let m be the embedding dimension of X and n that of Y . By
deﬁnition, we have
cu(f ∗C) = c(u!f ∗C) = max
0⩽p⩽m
X
i∈Z
hi(Pp
k′, l∗
apu!f ∗C).
Applying three times the projection formula, we have for any p and i ∈Z
hi(Pp
k′, l∗
apu!f ∗C) = hi
c(Yk′, f!u∗lap!Qℓ⊗C).
31

Applying the Leray spectral sequence for ´etale cohomology with compact support to the
morphism v: Y →Pn, we derive
X
i∈Z
hi
c(Yk′, f!u∗lap!Qℓ⊗C) =
X
i∈Z
hi(Pn
k′, v!f!u∗lap!Qℓ⊗v!C).
Then, by Theorem 5.1 and the deﬁnition, we get
X
i∈Z
hi(Pn
k′, v!f!u∗lap!Qℓ⊗v!C) ≪cv(f!u∗lap!Qℓ)cv(C).
Thus,
cu(f ∗C) ≪cv(C) max
0⩽p⩽m cv(f!u∗lap!Qℓ).
Applying again the deﬁnition and the projection formula three times, we have
cv(f!u∗lap!Qℓ) = max
0⩽q⩽n
X
i∈Z
hi(Pq, l∗
bqv!f!u∗lap!Qℓ)
= max
0⩽q⩽n
X
i∈Z
hi
c(Xk′, f ∗v∗lbq!Qℓ⊗u∗lap!Qℓ)
for any p. This concludes the proof of (8) by deﬁnition of cu,v(f), and the proof of (9) is
similar.
□
Proof of (10) and (11). From f !C = D(f ∗D(C)) we get the estimates
cu(f !C) ≪c(u)cu(f ∗D(C)) ≪c(u)cu,v(f)cv(D(C)) ≪c(u)c(v)cu,v(f)cv(C)
by (4) and (8).
This establishes (10), and (11) is proved similarly using (9) instead
of (8).
□
We can also bound the complexity, with respect to the Segre embedding, of the external
product of complexes.
Proposition 6.12. Let (X, u) and (Y, v) be quasi-projective algebraic varieties over k
with embedding dimensions n and m respectively, and consider their product (X×Y, u⊠v),
where u ⊠v = s ◦(u × v) is the composition of u × v with the Segre embedding
s: Pn × Pm →P(n+1)(m+1)−1.
Let p1 : X × Y →X and p2: X × Y →Y denote the projections. Then the estimate
cu⊠v(A ⊠B) ≪cu⊠v,u(p1)cu⊠v,v(p2)cu(A)cv(B)
holds for all objects A of Db
c(X) and B of Db
c(Y ), with an implied constant that only
depends on (n, m).
Proof. The estimate
cu⊠v(A ⊠B) ≪cu⊠v(p∗
1A)cu⊠v(p∗
2B)
holds by (5). Since the ﬁrst factor on the right-hand side satisﬁes
cu⊠v(p∗
1A) ≪cu⊠v,u(p1)cu(A)
by (8), and similarly for cu⊠v(p∗
2B), the result follows.
□
Remark 6.13. It should be possible to estimate the complexities cu⊠v,u(p1) and cu⊠v,v(p2)
in terms of c(u) and c(v). Indeed, this amounts to estimating the cohomology of u!Qℓ⊠
v!Qℓon Pn × Pm restricted to the intersection of a general linear subspace with the
inverse image of a general linear subspace under the Segre embedding. One can bound
this by
cs(u!Qℓ⊠v!Qℓ)cs(F),
32

where F is the constant sheaf on the intersection of a general linear subspace with the
inverse image of a general linear subspace under the Segre embedding, and then attempt
to estimate the two factors separately.
6.3. Linear operations.
Proposition 6.14. Let (X, u) be a quasi-projective variety over k.
(1) For any distinguished triangle A1 →A2 →A3 in Db
c(X), the following holds:
cu(A2) ⩽cu(A1) + cu(A3),
cu(A1) ⩽cu(A2) + cu(A3),
cu(A3) ⩽cu(A1) + cu(A2).
(2) For any objects A and B of Db
c(X), the following equality holds:
cu(A ⊕B) = cu(A) + cu(B).
(3) Let A be an object of Db
c(X). For any h ∈Z, the following equality holds:
cu(A[h]) = cu(A).
Proof. The ﬁrst bound in (1), as well as the equalities in (2) and (3), follow immediately
from the deﬁnition cu(A) = c(u!A) and the expression of the complexity in terms of Betti
numbers. The second and third inequalities are then deduced from the ﬁrst (and from (3))
using the distinguished triangles A2 →A3 →A1[1] and A3[−1] →A1 →A2.
□
In general, it is not obvious how sharp the ﬁrst inequality c(A2) ⩽c(A1) + c(A3) is.
However, in the important special case of the decomposition of a perverse sheaf into its
irreducible constituents, there is a more satisfactory estimate.
Theorem 6.15. Let (X, u) be a quasi-projective variety over k.
Let A be an object
of Db
c(X). For any i ∈Z, let ni be the length of pH i(A) in the abelian category of
perverse sheaves and let (Ai,j)1⩽j⩽ni be the family of its Jordan-H¨older factors, repeated
with multiplicity. Then the estimates
cu(A) ⩽
X
i∈Z
ni
X
j=1
cu(Ai,j) ≪c(u)cu(A)
hold, with an implied constant that only depends on the embedding dimension of (X, u).
Proof. The ﬁrst inequality follows immediately from the previous proposition. We prove
the second one.
For i ∈Z, let mi be the length of pH i(u!A) in the category of perverse sheaves on the
projective space target of u, and let (Bi,j)1⩽j⩽mi be the Jordan-H¨older factors (repeated
with multiplicity) of these perverse sheaves.
Let X be the closure of the image of u. The Bi,j are irreducible perverse sheaves with
support contained in X, and hence each u∗Bi,j is either zero or is an irreducible perverse
sheaf on X.
Because u!A is supported on X, its perverse ﬁltration is stable under pullback to X.
The perverse ﬁltration is always stable under open immersions; since u is a locally closed
immersion, it follows that it is stable under u∗.
Therefore, we have pH i(A) = pH i(u∗u!A) = u∗pH i(u!A). This perverse sheaf is an it-
erated extension of u∗Bi,j, . . . , u∗Bi,mi; by the uniqueness of the Jordan-H¨older factors, the
perverse sheaves u∗Bi,1, . . . , u∗Bi,mi that do not vanish coincide with the Ai,1, . . . , Ai,ni,
33

including multiplicity. We may therefore assume that the equality u∗Bi,j = Ai,j holds
for 1 ⩽j ⩽ni and u∗Bi,j = 0 for j > ni.
Then we have
X
i∈Z
ni
X
j=1
cu(Ai,j) =
X
i∈Z
ni
X
j=1
cu(u∗Bi,j) ≪c(u)
X
i∈Z
mi
X
j=1
c(Bi,j)
≪c(u)
X
i∈Z
mi
X
j=1
∥cc(Bi,j)∥,
by using (8) and Corollary 5.5 (2).
On the other hand, we have
cc(pH i(u!A)) =
mj
X
j=1
cc(Bi,j).
Since the Bi,j are perverse sheaves, their characteristic cycles are eﬀective. The norm
on Rn+1 is additive on the cone of eﬀective cycles, hence the equality
∥cc(pH i(u!A))∥=
mi
X
j=1
∥cc(Bi,j)∥.
The estimate
X
i∈Z
ni
X
j=1
cu(Ai,j) ≪c(u)
X
i∈Z
∥cc(pH i(u!A))∥≪c(u)c(u!A) = c(u)cu(A)
then follows by Proposition 5.4.
□
Corollary 6.16. Let (X, u) be a quasi-projective variety over k and w: W →X the
embedding of a locally closed subvariety. For each perverse sheaf A on W, the middle
extension perverse sheaf w!∗A on X satisﬁes
cu◦w(A) ≪c(u ◦w)cu(w!∗A),
cu(w!∗A) ≪(c(u)c(u ◦w))2cu◦w(A),
where the implied constants only depend on the embedding dimension of (X, u).
Proof. We recall that w!∗A is the image of the canonical morphism
pH 0(w!A) →pH 0(w∗A)
of perverse sheaves. It satisﬁes A = w∗w!∗A, and hence the estimates
cu◦w(A) = cu◦w(w∗w!∗A) ≪cu◦w,u(w)cu(w!∗A) = c(u ◦w)cu(w!∗A)
follow from (8) and Remark 6.7. Conversely, Proposition 6.14 gives the bound
cu(w!∗A) ⩽cu(pH 0(w!A)) + cu(pH 0(w∗A)).
Then Theorem 6.15, combined with (9) and (11) and Remark 6.7 again, gives the estimate
cu(w!∗A) ≪c(u)(cu(w!A) + cu(w∗A)) ≪c(u)(c(u ◦w) + c(u ◦w)2c(u))cu◦w(A),
as we wanted to show.
□
34

6.4. Nearby and vanishing cycles. In this section, we prove the continuity of the
functors of nearby and vanishing cycles. Let S be the spectrum of a strictly Henselian
discrete valuation ring, with special point σ and generic point η. Let ¯η be a geometric
generic point above η. Let f : X →S be a quasi-projective morphism and u: X →Pn
S
a locally closed embedding.
We denote by Xσ and Xη the ﬁbers of f over σ and η
respectively. We also consider the induced embeddings uσ : Xσ →Pn and uη : Xη →Pn.
For an object A of Db
c(X), we denote by Aσ and Aη the restrictions of A to Xσ and Xη
respectively. We denote by Ψf (resp. Φf) the functor of nearby cycles (resp. of vanishing
cycles) from Db
c(X) to Db
c(Xσ).
Theorem 6.17. Let X, S and f be as above. For each object A ∈Db
c(X), the following
estimates hold:
cuσ(Ψf(A)) ≪c(uσ)cuη(Aη),
cuσ(Φf(A)) ≪c(uσ)cuη(Aη) + cuσ(Aσ).
Before starting the proof, recall the following compatibilities of the nearby cycle functor
with pushforwards and pullbacks. Let h : X′ →X be an S-morphism, and f ′ = f ◦h.
Recall from [10, Exp. XIII (2.1.7.1)] that, if h is proper, there is a canonical isomorphism
(12)
Ψfh∗→h∗Ψf′
by proper base change. Moreover, if h is smooth then by [10, Exp. XIII (2.1.7.2)], there
is a canonical isomorphism
(13)
h∗Ψf →Ψf′h∗.
Proof. By deﬁnition of the vanishing cycles, there is a distinguished triangle
Aσ →Ψf(A) →Φf(A),
and hence the inequality cuσ(Φf(A)) ⩽cuσ(Aσ) + cuσ(Ψf(A)) holds by Proposition 6.14.
It is thus enough to prove the ﬁrst inequality.
We ﬁrst assume that f is proper, so that u is a closed immersion. Using (12) with
h = u, we can replace X by Pm
S and A by u!(A).
From (12), for every i ∈Z we get the equality
(14)
hi(X¯η, A¯η) = hi(Xσ, Ψf(A)).
By deﬁnition, we have
cuσ(Ψf(A)) = max
0⩽m⩽n
X
i∈Z
hi(Pn
k′, l∗
am(Aη)),
where am is a geometric generic point of Mn+1,m+1
k(σ)
deﬁned over an algebraically closed
ﬁeld k′, and similarly for cuη(Aη). As in the proof of Lemma 3.12, we view lam as the
composition of the map s: x 7→(x, am) from Pm to Pm × Mm+1,n+1 with the matrix
multiplication map p: Pm × Mm+1,n+1 →Pn. We still denote by p the smooth map
Pm
S ×S Mm+1,n+1
S
→Pn
S. By (13), there is an isomorphism
(15)
p∗Ψf →Ψfp∗,
where we still denote by f the natural morphism Pm
S ×S Mm+1,n+1
S
→S.
Let S′ denote the strict localization of Mm+1,n+1
S
at the point am and let s: S′ →Mm+1,n+1
S
be the localization map.
The scheme S′ is the spectrum of a strictly Henselian dis-
crete valuation ring, with special point σ′ and generic point η′, which are mapped to
σ and η respectively by the canonical morphism s′ : S′ →S. The situation is similar
35

to the discussion preceding [6, Lem. 3.3]. Set ˜k = k(¯η) ×k(η) k(η′), which is the frac-
tion ﬁeld of the strict localization of Mm+1,n+1
¯S
, where ¯S is the normalization of S in ¯η.
Then Gal(¯η/η) = Gal(˜k/η′) holds. Let ¯η′ the spectrum of an algebraic closure of ˜k and
P = Gal(¯η′/˜k), which is a pro-p group for p the characteristic exponent of k.
Let f ′: Pn
S′ →S′ be the strict localization at am of the morphism
Pm
S ×S Mm+1,n+1
S
−→Mm+1,n+1
S
.
We have the following cartesian diagram:
Pn
S′
S′
Pn
S ×S Mm+1,n+1
S
Mm+1,n+1
S
S.
f′
s
s
s′
f
As recalled in (13), there is an isomorphism
(16)
s∗Ψf →Ψs′◦f′s∗.
By [6, Th. Finitude, Lem. 3.3], for every object B of Db
c(Pn
S′) and i ∈Z, the equality
(17)
Ψs′◦f′(B) = Ψf′(B)P
holds. Since P is a pro-p group, taking the P-ﬁxed part is an exact functor, hence the
inequality
(18)
hi(Pn
k′, Ψf′(B)P) ⩽hi(Pn
k′, Ψf′(B)).
Combining equations (15), (16) and (17), we ﬁnd
(19)
l∗
amΨf(A) = s∗p∗Ψf(A) = s∗Ψf(p∗A) = Ψs′◦f′(s∗p∗A) = Ψf′(l∗
amA)P.
Hence, by (18) applied to B = s∗p∗A, we get
(20)
hi(Pn
k′, l∗
amΨf(A)) ⩽hi(Pn
k′, Ψf′(l∗
amA)).
By (14) applied to f ′, we have
(21)
hi(Pn
k′, Ψf′(l∗
amA)) = hi(Pn
¯η′, (l∗
amA)η) = hi(Pn
¯η′, l∗
am(A¯η′)).
Combining (20) and (21), we ﬁnd the sought-after inequality
cuσ(Ψf(A)) ⩽cuη(Aη).
We now come back to the general case, i.e. we do not assume that f is proper. We
factor the immersion u: X →Pn
S as i ◦j, where i is a closed immersion and j is an open
immersion.
By the ﬁrst step, applied to j!A and the morphism ¯f given by the composition of i and
the projection Pn
S →S, we get ciη(j!(A)η) ⩽ciσ(Ψ ¯fj!A). By (13), the object j∗
σΨ ¯fj!A is
isomorphic to Ψf(A), and hence we get
cuσ(Ψf(A)) ≪cuσ,iσ(jσ)ciσ(Ψ ¯fj!A)
⩽cuσ,iσ(jσ)ciη((j!A)η)
= cuσ,iσ(jσ)cuη(Aη) = c(uσ)cuη(Aη)
by (8) and Remark 6.7. This ﬁnishes the proof.
□
36

Corollary 6.18. Let k be an algebraically closed ﬁeld, f : (X, u) →(S, v) a ﬂat morphism
of quasi-projective varieties over k, with S smooth and irreducible of dimension 1. Let σ
be a closed point of S. Let S(σ) be the strict localization of S at σ. Denote by Ψf and Φf
the nearby and vanishing cycles functors of the base change of f to S(σ), which we view
as functors from Db
c(X) to Db
c(Xσ). For any A ∈Db
c(X), the following estimates hold:
cuσ(Ψf(A)) ≪cu,v(f)2cu(A),
cuσ(Φf(A)) ≪cu,v(f)2cu(A).
Proof. Let Γ ⊂X ×k S be the graph of f.
We denote by h: X →Γ the canonical
S-morphism, and by f ′: Γ →S the projection. Abusively, we will also write u: Γ →Pn
S
for the canonical embedding induced by u: X →Pn
k.
Since h is an isomorphism, the base change morphism Ψf′hη∗→hσ∗Ψf is an iso-
morphism as well. Moreover, hη and hσ are isomorphisms and the equality cuσ(B) =
cuσ(hσ∗B) holds for any object B of Db
c(Xσ). By Theorem 6.17 applied to the strict
localization at σ of f ′ : Γ →S and h∗A, the following estimates hold:
cuσ(Ψf′(h∗A)) ≪c(uσ)cuη(h∗Aη),
cuσ(Φf′(h∗A)) ≪c(uσ)cuη(h∗Aη) + cuσ(h∗Aσ).
Using the base change isomorphism previously quoted, this implies that
cuσ(Ψf(A)) ≪c(uσ)cuη(Aη),
cuσ(Φf(A)) ≪c(uσ)cuη(Aη) + cuσ(Aσ).
We will now prove the estimates
cuσ(Aσ) ≪cu,v(f)cu(A),
c(uσ) ≪cu,v(f),
cuη(Aη) ≪cu,v(f)cu(A),
which will conclude the proof.
First, let δσ ∈Db
c(S) be the rank-one skyscraper sheaf supported at σ ∈S. We have
cv(δσ) = 1 and f ∗δσ is the constant sheaf supported on Xσ, so that by Theorem 6.8, we
obtain cu(f ∗δσ) ≪cu,v(f)cv(δσ). Hence, the estimate
c(uσ) = cu(f ∗δσ) ≪cu,v(f)
holds. This proves the second inequality.
Moreover, we have Aσ = A ⊗Qℓ|Xσ, and hence the estimate
cuσ(Aσ) ≪cu(A)c(uσ)
holds by Theorem 6.8. Combined with the second inequality, this yields the ﬁrst one.
For the third inequality, let b be a geometric generic point of MnS,nS+1 such that the
intersection of v(S) and the image of lb in PnS
k′ is ﬁnite. This intersection consists of
ﬁnitely many geometric generic points ¯η1, . . . , ¯ηn of S. The complex f ∗v∗lb∗Qℓis then the
constant sheaf supported on f −1({¯η1, . . . , ¯ηn}), hence the estimate
cuη(Aη) ⩽cu(A ⊗f ∗v∗lb∗Qℓ).
From Theorem 6.8 and the deﬁnition of cu,v(f), we deduce
cu(A ⊗f ∗v∗lb∗Qℓ) ≪cu(A)cu(f ∗v∗lb∗Qℓ) ⩽cu(A)cu,v(f),
which ends the proof.
□
37

6.5. Uniformity in families. In Theorem 6.8, the factors c(u) or cu,v(f) appear. The
next proposition ensures that these are bounded in algebraic families; for all practical
purposes, they will thus behave as constants in applications.
Proposition 6.19. Let S be a noetherian scheme in which ℓis invertible. Let X be a
scheme of ﬁnite type over S, and let u: X →Pn
S be a locally closed immersion of schemes
over S, so that for each geometric points s of S, the pair (Xs, us) is a quasi-projective
variety over the algebraically closed ﬁeld k(s). Then:
(1) There exists a constant M1, depending only on (X, S, u), such that the inequal-
ity c(us) ⩽M1 holds for all s.
(2) For any object A of Db
c(X), there exists a constant M2, depending only on (X, S, u, A),
such that the inequality cus(As) ⩽M2 holds for all s.
(3) Let Y be a scheme over S and let v: Y →Pn′
S be a locally closed immersion of
schemes over S. Let f : X →Y be a morphism of schemes over S. Then there
exists a constant M3, depending only on (X, S, u, Y, v, f) such that the inequal-
ity cus,vs(fs) ⩽M3 holds for all s.
Proof. By deﬁnition of c(us), part (1) will follow from (2) applied to A = Qℓ.
We now prove (2). Let 0 ⩽m ⩽n be an integer. Let r: Mn+1,m+1
S
×S Pm
S →Pn
S be
the morphism deﬁned by r(a, x) = la(x). Consider the diagram
X
u
/ Pn
S
Mn+1,m+1
S
×S Pm
S
r
o
pr1

Mn+1,m+1
S
.
Let s be a geometric point of S. Let am be a geometric generic point of the ﬁber
of Mn+1,m+1
S
over s. Let i ∈Z. By the proper base change theorem, the equality
X
i∈Z
hi(Pm
k′, l∗
amus!As) =
X
i∈Z
dim H i(pr1∗r∗u!A)am
holds. Since u is a locally closed immersion and r and pr1 are morphisms of ﬁnite type,
the complex pr1∗r∗u!A is an object of Db
c(Mn+1,m+1
S
), so by constructibility, the sum above
is bounded as s varies.
For (3), we argue in a similar way with Mn+1,m+1
S
×S Mn′+1,m′+1
S
.
□
Remark 6.20. For instance, if f : An →Am is a morphism given by m polynomials in
n variables of degree at most d, then using the universal family of such polynomials it
follows that there exists a constant b(n, m, d) such that the inequality cu,v(f) ⩽b(n, m, d)
holds for all f (with the standard embeddings u: An →Pn and v: Am →Pm). We can
in fact make some cases fully explicit by appealing to results of Katz [28]. Since this can
be useful in some applications, we spell out one such case in the next proposition.
For non-negative integers N, r and d, set
B(N, r, d) = 6 · 2r · (3 + rd)N+1.
Proposition 6.21. Let r, d, n1 and n2 be non-negative integers. Let X be a closed
subvariety of An1 over k deﬁned by r equations of degree at most d.
Let Y be any
subvariety of An2
k . Let u and v be the natural immersions of An1 and An2 in Pn1 and Pn2
respectively. For any morphism f : X →Y deﬁned by n2 polynomials of degree at most d,
the following inequality holds:
cu,v(f) ⩽B(n1, n2 + r, d).
38

Proof. By deﬁnition, the complexity cu,v(f) is the maximum over all integers m1 ⩽n1
and m2 ⩽n2 of the sum of the compactly supported Betti numbers (with Qℓ-coeﬃcients)
of the intersection of X with a generic linear subspace of dimension m1 in Pn1 and with
the pullback by f of a generic linear subspace of dimension m2 in Pn2. The intersection
of the ﬁrst linear subspace with An1 is an aﬃne space of dimension n1. Its intersection
with X is deﬁned by r equations of degree at most d, and the pullback of a linear subspace
is deﬁned by n2 −m2 linear combinations of the polynomials deﬁning f, which are hence
also of degree at most d. Thanks to [28, Cor. of Th. 1, p. 34], we deduce the inequalities
X
i∈Z
hi
c(X, u∗l∗
am1Qℓ⊗f ∗v∗l∗
bm2Qℓ) ⩽B(m1, n2 −m2 + r, d) ⩽B(n1, n2 + r, d)
(with notation as in Deﬁnition 6.6) for all m1 and m2, and the result follows.
□
Remark 6.22. In some cases, Katz’s remark in [28, p. 43] leads to better estimates.
6.6. The open set of lissity of a complex. Another invariant governed by the com-
plexity is the degree of the complement of a dense open set where an object of the derived
category is lisse (i.e., where all its cohomology sheaves are lisse). Below, by degree of a
subvariety Z of projective space, we mean the sum of the degrees of its irreducible com-
ponents (which may have diﬀerent dimensions).
Theorem 6.23. Let (X, u) be an irreducible quasi-projective variety over k. Let A be an
object of Db
c(X). Let Z be the complement of the maximal open subset where X is smooth
and A is lisse. Then the estimate
deg(u(Z)) ≪(3 + s)c(u)cu(A)
holds, where the degrees are computed in the projective space target of u, and s is the
degree of the codimension 1 part of the singular locus of X.
Proof. We ﬁrst assume that A is an irreducible perverse object. Let n be the embedding
dimension of (X, u). Let S be the support of A.
If S has codimension m ⩾1, then A is lisse (being zero) outside S; we will show that
the inequality cu(A) ⩾deg(u(S)) holds. Indeed, let am be a geometric generic point
of Mm+1,n+1
k
, so that lam : Pm →Pn is a generic linear embedding that intersects S in
deg(u(S)) general points. The complex l∗
amu!A is then supported on deg(u(S)) points
and non-zero on each of them, so the sum of its Betti numbers is ⩾deg(u(S)), which
gives the stated bound.
Now assume that S is equal to X. In case A is lisse on the non-singular locus of X,
the subset Z is the singular locus of X, and the statement trivially holds since the left-
hand side of the estimate is independent of A. Otherwise, Z has codimension 1 in X.
Indeed, were its codimension bigger, A would be lisse on the non-singular locus of X by
purity of the branching locus [22, Exp. X, Cor. 3.3]. Let d be the degree of u(Z). Set
m = 1 + codim(u(X)), and let am be a geometric generic point of Mm+1,n+1
k
, so that
lam : Pm →Pn is a generic linear embedding that intersects the support of A in a curve
C, of which d points lie in the singular locus Z. Let j be the embedding of C in X.
Moreover, let ˜C be the normalization of C and let π: ˜C →C be the canonical morphism.
We can view the pullback j∗A of A to C as obtained ﬁrst by pullback along a smooth
morphism Mm+1,n+1 × Pm →Pn, followed by pullback to the geometric generic ﬁber.
Thus any property of A that is preserved by smooth pullback and by restriction to the
geometric generic ﬁber will be preserved by pullback to C. In particular, by Lemma 3.12
a shift of j∗A is perverse on C, and because an irreducible perverse sheaf on a curve
is a shift of a middle-extension sheaf, the pullback j∗A is a shift of a middle extension
39

sheaf F. In addition, F is not lisse on at least d points, since neither smooth pullback
nor restriction to the geometric generic ﬁber can make a singular point disappear.
Let
˜
F be the middle extension of π∗F from the maximal open set where it is lisse;
then F is canonically isomorphic to π∗˜
F, since both are middle-extension sheaves on C
that are isomorphic on a dense open set. Let d′ be the number of points where F is not
lisse and that are not contained in the singular support of C. We have d ⩽d′ + s and
˜
F
is not lisse in at least d′ points.
From the equalities
X
i∈Z
hi(Pn, l∗
amu!A) =
X
i∈Z
hi
c(C, j∗A) =
X
i∈Z
hi
c(C, F) =
X
i∈Z
hi
c( ˜C, ˜
F),
we get
−χc( ˜C, ˜
F) ⩽
X
i∈Z
hi
c(Pn, l∗
amu!A) ⩽cu(A).
Let r be the “generic rank of A” in the sense of Proposition 3.4. By Proposition 3.4, the
inequality r ⩽cu(A) holds. Since lam is a generic linear embedding, r is also the “generic
rank of j∗A” in the sense of Proposition 3.4. Since j∗A is a shifted middle-extension
sheaf F, r is also the generic rank of F, i.e. the rank of a lisse sheaf of which F is the
middle extension. Since
˜
F be the middle extension of π∗F from the maximal open set
where it is lisse, r is also the generic rank of ˜
F. Using the Grothendieck-Ogg-Shafarevich
formula, we get χc( ˜C, ˜
F) ⩽d′ −2r . From this we derive the inequalities
d′ ⩽2r + cu(A) ⩽3cu(A).
We ﬁnally get
d ⩽d′ + s ⩽(3 + s)cu(A),
since cu(A) ⩾1.
Now consider the general case.
For i ∈Z, let ni be the length of pH u(A) and
let (Ai,j)1⩽j⩽ni be the Jordan–H¨older factors of pH i(A), repeated with multiplicity. The
object A is lisse on the intersection over i and j of the maximal open sets Ui,j where Ai,j
is lisse. (Note that all the irreducible perverse factors of a lisse sheaf are lisse, so that
if Ai,j is not lisse at a point, then neither is A).
By the case of perverse sheaves, the complement of Ui,j is the union of subvarieties
with total degree ⩽(3 + s)cu(Ai,j). Thus, we obtain subvarieties Zi with
m
X
i=1
deg(Zi) ⩽(3 + s)
X
i∈Z
ni
X
j=1
cu(Ai,j) ≪(3 + s)c(u)cu(A)
by Theorem 6.15.
□
6.7. Complexity of the cohomology sheaves of a complex. In this section, we con-
sider an analogue of Theorem 6.15 where the Jordan–H¨older components of the perverse
cohomology sheaves are replaced by the ordinary cohomology sheaves. This is a case
where we will only be able to prove “continuity” abstractly, without explicit estimates.
Precisely, we have:
Proposition 6.24. The exist a function N : R+×R+ →R+ with the following property:
for any quasi-projective algebraic variety (X, u) over k with embedding dimension n, and
for any object A of Db
c(X), the following inequality holds:
X
i∈Z
cu(H i(A)) ⩽N(n, cu(A)).
40

We begin with two lemmas.
Lemma 6.25. For any non-negative integers d and n, there exists C(d, n) ⩾0 such
that, for any algebraically closed ﬁeld k, for any prime ℓinvertible in k, and for any
closed immersion u: X →Pn whose image is a union of irreducible subvarieties of total
degree d, the inequalities
c(u) ⩽C(d, n)
deg(Xs) ⩽C(d, n)
hold, where Xs is the singular locus of X.
Proof. The theory of Chow varieties (see, e.g., [33]) provides a quasi-projective scheme Chowd,n
over k whose points “are” the closed immersions i: X →Pn whose image is a union of
irreducible subvarieties of total degree d. The ﬁrst inequality then follows from Propo-
sition 6.19 (1), and the second is a consequence of the constructibility of the function
that maps a point of Chowd,n to the degree of the singular locus of the corresponding
quasi-projective variety.
□
Lemma 6.26. For any non-negative integers d and n, there exists C(d, n) ⩾0 with the
following property: for any algebraically closed ﬁeld k, for any prime ℓinvertible in k,
for any quasi-projective variety (X, u) over k with embedding dimension n, and for any
object A of Db
c(X) with cu(A) ⩽d, there exists a stratiﬁcation
Xn+1 ⊆Xn ⊆Xn−1 ⊆. . . X1 ⊆X
of X such that
• The subvariety X1 is the support of A.
• For all i, the subvariety Xi −Xi−1 is smooth.
• For all i, the object A is lisse on Xi −Xi−1.
• For all i, the subvariety Xi is a union of at most C(d, n) subvarieties of de-
gree ⩽C(d, n).
• For all i, the inequality c(ui) ⩽C(d, n) holds, where ui: Xi −Xi+1 →Pn is the
natural immersion.
Proof. The equality cu(A) = c(u!A) holds by deﬁnition, so we may replace X with the
projective space Pn (and u with the identity), and A with u!A, provided we describe the
subvarieties Xi as forming a stratiﬁcation of the support of A.
Indeed, we deﬁne X1 to be the support of A, and then inductively Xi+1 to be the
complement in Xi of the maximal smooth open subset of Xi on which A is lisse. On
noting the inequality dim(Xi+1) < dim(Xi), this provides a stratiﬁcation of the support
of A with at most n+1 non-empty subvarieties. We denote by vi the immersion Xi →Pn.
We now prove by induction on i with 1 ⩽i ⩽n + 1 that Xi is a union of varieties
whose total degree is bounded only in terms of (d, n), and that c(vi) is bounded only in
terms of (d, n).
Since X1 is the support of A, either X1 is equal to Pn or it is the complement of the
maximum open subset on which A is lisse (in fact, zero). In the second case, Lemma 6.23
shows that that X1 is a union of varieties of degree at most 3cu(A). In the ﬁrst case,
the same inequality holds trivially.
Then by the ﬁrst inequality in Lemma 6.25, the
complexity c(v1) has a bound in terms of cu(A) and n, and hence in terms of (d, n). This
establishes the base case of the induction.
Assume that the induction assumption holds for some i with 1 ⩽i ⩽n.
Then,
by (8), we obtain cvi(v∗
i A) ⩽cvi,Id(vi)c(A) = c(vi)c(A). By the deﬁnition of Xi+1, ap-
plying Lemma 6.23 and the second inequality of Lemma 6.25, we deduce that Xi+1 is a
41

union of varieties of total degree bounded only in terms of (d, n). The ﬁrst inequality
of Lemma 6.25 applied once more shows that c(vi+1) is bounded only in terms of (d, n).
This completes the induction.
It only remains to bound the complexity of the immersions ui. The excision triangle
gives
ui!Qℓ−→vi!Qℓ−→v(i+1)!Qℓ
in Db
c(Pn), and hence the inequality
c(ui) = c(ui!Qℓ) ⩽c(vi!Qℓ) + c(v(i+1)!Qℓ) = c(vi) + c(vi+1)
follows by Proposition 6.14 (1).
□
Proof of Proposition 6.24. We apply the previous lemma with d = cu(A), and we let
C(d, n) ⩾0 denote the corresponding number and
Xn+1 ⊆Xn ⊆Xn−1 ⊆. . . X1 ⊆X
a stratiﬁcation of X with the properties of the lemma.
Applying excision repeatedly and Proposition 6.14 (1), we get
X
i∈Z
cu(H j(A)) =
X
i∈Z
c(u!H j(A))
⩽
X
i∈Z
n+1
X
j=1
c(uj!u∗
ju!H i(A)) =
n+1
X
j=1
X
i∈Z
c(uj!u∗
ju!H i(A)).
Applying (9) to f = uj viewed as a morphism from (Xj −Xj+1, uj) to (Pn, Id), we have
c(uj!u∗
ju!H i(A)) ≪cuj,Id(uj)cuj(u∗
ju!H i(A)) = c(uj)cuj(u∗
ju!H i(A))
for all i and j. By construction, u∗
juj!H i(A) is lisse on the smooth scheme Xj −Xj+1;
since the perverse homology sheaves and the usual homology sheaves of a lisse sheaf on
a smooth scheme agree, the estimates
X
i∈Z
c(uj!u∗
ju!H i(A)) ≪c(uj)
X
i∈Z
cuj(pH i(u∗
ju!A)) ≪c(uj)2cuj(u∗
ju!A)
hold by Theorem 6.15. Applying (8), we get
cuj(u∗
ju!A) ≪c(uj)c(u!A) = c(uj)cu(A),
and therefore
X
i∈Z
cu(H j(A)) ≪cu(A)
n+1
X
j=1
c(uj)3
is bounded only in terms of (n, d), since c(uj) ⩽C(d, n) for all j.
□
6.8. Generic base change. We now prove an eﬀective version of Deligne’s generic base
change theorem [6, Th. ﬁnitude, 1.9]. This argument is due to A. Forey.
Theorem 6.27. Let (X, u), (Y, v) and (S, w) be quasi-projective algebraic varieties over k.
Let f : X →Y and g : Y →S be morphisms.
For any object A of Db
c(X), there exists an integer N ⩾0, depending only on cu(A)
and (f, g, u, v, w), and a dense open set U ⊂S such that
(i) The image of the complement of U has degree ⩽N.
(ii) The object f∗A is of formation compatible with any base change S′ →U ⊂S.
42

Remark 6.28. The original generic base change theorem is stated for a constructible
sheaf of R-modules, where R is a Noetherian ring satisfying nR = 0 for some integer n
that is invertible in S, and S is not supposed to be deﬁned over a ﬁeld k. An additional
statement of the theorem is the constructibility of f∗A on YU.
In the setting of the
above statement, it is already known that f∗A is constructible, precisely by applying
[6, Th. ﬁnitude, 1.9] to f : X →Y over k. However, in order to understand the complexity
of the complement of the open set U over which f∗A is of formation compatible with base
change, we would need to redo the whole proof, following closely Deligne’s argument (see
also [18, Th. 9.3.1]).
In this section, we will often write simply c(X) for the complexity c(u), where (X, u) is
a quasi-projective variety. Recall also from Remark 6.7 that if i: Z →X is an immersion,
then cu◦i,u(i) = c(Z).
Before starting the proof, we state a useful lemma.
Lemma 6.29. Let (X, u) be a quasi-projective variety over k of embedding dimension n.
There exists a ﬁnite open cover (Ui) of X into at most dim(X) + 1 aﬃne subvarieties
with open immersions ui : Ui →X such that cu◦ui,u(ui) = c(Ui) is bounded in terms
of c(u) = c(X) and n.
Proof. The image of u in Pn can be written as Z −W, where Z and W are closed
subvarieties of Pn. As in the proof of Lemma 6.26, by Theorem 6.23 the degrees of Z
and W are bounded in terms of c(u) and n. Let H be a hypersurface of Pn such that
W ⊂H but Z /∈W. One can choose W of degree at most the degree of W. Then
set U1 = Z −H, which is an aﬃne open subset of Z −W, of complexity bounded by
the degrees of Z and H. Since dim(Z ∩H) < dim(Z), one can conclude by induction:
the aﬃne open subsets of Z ∩H that are obtained are restrictions of aﬃne open subsets
of Pn, and hence their restrictions to Z produce aﬃne open subsets of Z −W, which,
together with U1, cover Z −W.
□
During the proof of Theorem 6.27, we will repeatedly consider subschemes of X, Y
and S. These will always implicitly be considered with the locally closed embedding
inherited from X, Y or S.
All complexities will be computed with respect to those
implicit embeddings, and hence we will simplify the notation by dropping the embeding
from the complexity. Moreover, whenever we say that we can shrink S, we mean that we
can replace S by a dense open subset whose complement has bounded degree in terms
of c(A).
Proof of Theorem 6.27. Working successively with each irreducible component of S, there
is no loss of generality in assuming, as we do from now on, that S is irreducible.
Step 1. We ﬁrst consider the particular case where S = Y , the variety X is smooth
of pure relative dimension d over S, and A is a lisse sheaf such that Rif!A′ is lisse for
each i ∈Z. Here, A′ denotes the “naive” dual A′ = H om(A, Qℓ), i.e. non-derived sheaf
homomorphisms. Then Deligne [6, Th. ﬁnitude, 2.1] proves the result with U = S (this
is essentially a consequence of the proper base change theorem and Poincar´e duality).
Step 2. We now assume that S = Y , X is smooth over S of pure relative dimension d,
and that A is a lisse sheaf. Let again A′ = H om(A, Qℓ); by (9) and Theorem 6.23, there
exists an open set U ⊂S whose complement has degree bounded in terms of c(A′), and
hence in terms of c(A), such that f!A′ is lisse on U. Over the dense open set U, we are
in the situation of Step 1, and hence the result holds in this case too.
Step 3. We now perform some reductions for the proof of the general case. We ﬁrst
observe that the problem is local on Y , so that we may assume that Y aﬃne. Using a
43

ﬁnite aﬃne cover of X and excision, we may also assume that X is aﬃne. Note that the
complexity of the restriction of A to those aﬃne open subsets is bounded in terms of c(A)
by (8).
Up to shrinking X again, we can now factor f into an open immersion followed by a
proper morphism g (this is a form of Nagata’s compactiﬁcation theorem).
By proper base change, the result holds for the morphism g with U = S, and hence it
is enough to prove the result when f is an open immersion with dense image. We will
then prove the result by induction on the relative dimension n ⩾0 of X over S.
For n = 0, since X and Y are of dimension 0 over S, up to shrinking S to a dense open
subset (whose complement is of degree bounded in terms of X and Y ), we have X = Y .
Hence the result holds.
We now consider n ⩾1, and assume that the result holds for relative dimension up
to n −1.
We will prove below the following sublemma:
Lemma 6.30. With notation and assumption as before, up to shrinking S, there exists a
dense open subset Y ′ ⊂Y such that the result holds over Y ′ and such that the complement
of Y ′ in Y is ﬁnite of bounded degree over S.
Step 4. Under the conditions of Step 3, we further assume that X is smooth over S
and that A is a lisse sheaf. We can replace Y by its closure in the image of v, and hence
assume that Y is projective over S. Using Lemma 6.30, we can assume that there exists
Y ′ ⊂Y such that the result holds for Y ′ and that Y −Y ′ is ﬁnite over S of bounded
degree. We then have the following commutative diagram:
Y ′
X
Y
Y −Y ′
S
j
f
a
b
i
c
By Step 2, up to shrinking S, the object a∗A is of formation compatible with any base
change. By the choice of Y ′ (after again shrinking S) the object j∗f∗A is of formation
compatible with any base change. By the proper base change theorem, the same holds
for b∗j!j∗f∗A. Now we have a distinguished triangle
j!j∗f∗A −→f∗A −→i∗i∗f∗A
Applying b∗to it, we get the distinguished triangle
b∗j!j∗f∗A −→a∗A −→c∗i∗f∗A
Since the ﬁrst two complexes in this triangle are of formation compatible with any base
change, the same holds for the third one, namely c∗i∗f∗A. Since c is ﬁnite, this implies
that i∗f∗A also has the same property. Hence in the ﬁrst triangle, the ﬁrst and third
complexes are of formation compatible with any base change, and hence the middle one,
namely f∗A, also has this property. This ﬁnishes the proof in this case.
Step 5. We now show how to reduce the situation (after the reduction in Step 3) to
that of Step 4. We will also prove below the following additional sublemma:
Lemma 6.31. Up to shrinking S, and performing a base change along a ﬁnite surjec-
tive radicial morphism and reducing X, in an eﬀective way, we can ﬁnd an open dense
subset V of X that is smooth over S and has complement of bounded degree.
44

By Proposition 6.24, the complexity of the cohomology sheaves of A are bounded in
terms of c(A); hence, up to replacing A by each of its cohomology sheaves in turn, we
reduce to the case where A is a sheaf. If the support of A is not dense in X, then the
support has relative dimension ⩽n −1, and we are done by induction. If the support
of A is dense in X, then by Theorem 6.23, up to shrinking V , we may assume that the
restriction of A to V is a lisse sheaf. Applying induction to the restriction of A to X −V
and excision, we can assume that A is a lisse sheaf supported on V .
Let j be the open immersion V →X. By Step 4, the result holds for j, and hence up to
shrinking S, we may assume that j∗j∗A is of formation compatible with any base change.
Choose a cone C of the canonical adjunction morphism A →j∗j∗A. By deﬁnition, we
have a distinguished triangle
A −→j∗j∗A −→C
and the cohomology of C is supported on Z = X −V . Since the ﬁrst two complexes are
of formation compatible with any base change, the same is true for C. By Theorem 6.8
and Proposition 6.14, the complexity of the restriction of C to Z is bounded in terms of
the complexity of A. Since the relative dimension of Z is < n, the induction hypothesis
applies to the closed immersion Z →X and to the restriction of C to Z. Hence, up to
shrinking S, we can assume that f∗C is of formation compatible with any base change.
We then apply f∗to the previous distinguished triangle and obtain
f∗A →(fj)∗j∗A →f∗C
By Step 4 again, the result holds for the open immersion fj : V →Y , so that after
shrinking S, the objet (fj)∗j∗A is of formation compatible with any base change. Since
we have seen that this also holds for f∗C, we deduce that f∗A is of formation compatible
with any base change, as desired.
□
We now prove the sublemmas above.
Proof of Lemma 6.30. The problem is local on Y , so by Lemma 6.29, we can also assume
that Y is aﬃne over S. We hence assume that Y ⊂Ar
S, where the choice of coordinates
is induced by v.
For 1 ⩽i ⩽r, consider the i-th coordinate projection pi : Y →A1
S.
We view X
and Y as A1
S-schemes using pi as structure morphism. The generic relative dimensions
of X and Y are then ⩽n −1, and hence we can apply the induction hypothesis to this
situation. We ﬁnd a dense open subset Ui ⊂A1
S such that the complement of Ui in A1
S is
of degree bounded in terms of c(A), and such that f∗A is of formation compatible with
any base change S′ →Ui ⊂A1
S. Deﬁne
Y ′ =
[
1⩽i⩽r
p−1
r (Ui).
Since the complexity of the Ui is bounded in terms of c(A), the same holds for Y ′. From
the deﬁnition of Ui, the result holds for the restriction of f to X′ = f −1(Y ′). Since the
morphism
Y −Y ′ = (A1
S −U1) ×S · · · ×S (A1
S −Ur) −→S
is generically ﬁnite, there exists a dense open S′ ⊂S over which this morphism is ﬁnite.
The degree of S −S′ is bounded in terms of the degrees of A1
S −Ui, for i = 1, . . . , r, and
hence is itself bounded in terms of c(A), which ends the proof of the sublemma.
□
Proof of Lemma 6.31. Recall that X is assumed to be aﬃne, with a ﬁxed closed embed-
ding into Ar
S for some integer r ⩾0. By the eﬀective version of generic ﬂatness, see, e.g.,
[43, Th. 2.45], we ﬁnd a dense open subset S′ of S over which X is ﬂat and such that
45

the complement of S′ in S is of bounded degree. We may therefore assume that X is ﬂat
over S. To obtain smoothness, we use the Jacobian criterion. We want to deﬁne U to
be the complement in X of the vanishing locus of the Jacobian ideal, which is indeed of
bounded degree. However, for this to deﬁne a dense open subset of X, we need to perform
ﬁrst a base change along a ﬁnite surjective radicial morphism S′ →S (which does not
change ´etale cohomology), then replace X and Y by their reductions. The degree of the
ﬁnite surjective radicial morphism is determined by the degrees (according to the aﬃne
embedding of S) of the coeﬃcients of the polynomials deﬁning X in Ar
S, and hence is
bounded. Once the result is known for XS′ over S′, we conclude the proof by considering
the image U of the dense open subset of S′ by the morphism S′ →S, since the degree of
the complement of U is still bounded.
□
6.9. Tannakian operations. Let (X, u) be a connected quasi-projective algebraic va-
riety over k, and let F be a lisse ℓ-adic sheaf on X. We shall view F as a continuous
representation π of the ´etale fundamental group of X on a ﬁnite-dimensional Qℓ-vector
space. The monodromy group of F is then deﬁned as the Zariski closure of its image,
which is an algebraic group G over Qℓequipped with a distinguished faithful representa-
tion. Given a further algebraic representation ρ: G →GLN(Qℓ), we denote by ρ(F) the
lisse ℓ-adic sheaf corresponding to the representation ρ ◦π.
The following lemma is very useful in deriving properties of ρ(F) from those of F.
By a reductive group over a ﬁeld of characteristic zero, we mean a group G all whose
ﬁnite-dimensional representations are completely reducible (that is, G is not assumed to
be connected).
Lemma 6.32. Let G ⊂GLN be a reductive group over an algebraically closed ﬁeld
of characteristic zero and denote by Std its tautological N-dimensional representation.
For any algebraic irreducible representation ρ: G →GL(V ), there exist non-negative
integers (a, b) such that ρ is a subrepresentation of Std⊗a ⊗D(Std)⊗b. If the determinant
of Std has ﬁnite order, there exists such a pair with b = 0.
Proof. For the ﬁrst part of the statement, see, e.g., [5, Th. III.4.4] in the case of compact
Lie groups, and use the equivalence of categories between reductive groups and compact
Lie groups.
When the determinant has ﬁnite order, it suﬃces to prove that the contragredient of
the tautological representation is a subrepresentation of a tensor power of the standard
representation. But, using brackets to denote multiplicity, we have
⟨D(Std), Std⊗a⟩= ⟨1, Std⊗(a+1)⟩
for all a ⩾0, and if det(Std)m = 1 for some m ⩾1, we have ⟨1, Std⊗mN⟩⩾1. Indeed,
as the determinant is the highest exterior power, there is an inclusion det ⊂Std⊗N, and
this induces 1 = det⊗m ⊂Std⊗mN.
□
Proposition 6.33. With notation as above, assume that the group G is reductive with
ﬁnite center. There exists an integer a ⩾0, depending only on ρ, such that
cu(ρ(F)) ≪cu(F)a,
where the implied constant depends only on the embedding dimension of u.
Proof. Let Std denote the standard faithful representation of G corresponding to the
sheaf F. The identity component G0 of G is reductive, so the restriction of the one-
dimensional character det(Std) of G to G0 is non-trivial if and only if its restriction to
the central torus of G0 is non-trivial. The central torus of G0 is a torus with an action
46

of the (ﬁnite) component group of G by conjugation which does not ﬁx any non-trivial
cocharacter. Hence, it does not ﬁx any non-trivial character, so the restriction of det(Std)
to G0 is trivial, and thus det(Std) has ﬁnite order. By Lemma 6.32, there exists a non-
negative integer a such that ρ is a direct summand of Std⊗a. Thus, the estimates
cu(ρ(F)) ⩽cu(F ⊗a) ≪cu(F)a
hold by Proposition 6.14 (2) and parts (4) and (5) of Theorem 6.8.
□
Remark 6.34. If X is a curve, the estimate can be strengthened considerably to
cu(ρ(F)) ≪dim(ρ)cu(F)
by using the “local” formula of Theorem 7.3 below (see [26, Ch. 3] for arguments of this
kind). It would be very interesting to know whether such a strong bound holds in higher
dimension.
In some applications, it is natural to try to improve on this bound by estimating a
eﬀectively, or in other words, to make Lemma 6.32 eﬀective. We record here one such
estimate, since this might be of interest for other applications.
Let N ⩾1 be an integer and let G ⊂GLN be a reductive algebraic group over an alge-
braically closed ﬁeld of characteristic zero. As above, we denote by Std the tautological
faithful representation of G in GLN.
Deﬁnition 6.35. For any irreducible algebraic representation ρ of G, we deﬁne
w(ρ) = min

a + b | ρ is a subrepresentation of Std⊗a ⊗D(Std)⊗b	
.
Lemma 6.32 means that w(ρ) is ﬁnite for all irreducible algebraic representations ρ
of G.
Proposition 6.36. Let Λ be the weight lattice of the identity component G0 of G. Fix a
norm ∥·∥on Λ. There exist real numbers α, β ⩾0 such that, for any irreducible algebraic
representation ρ of G, the inequality
w(ρ) ⩽α max
i
∥λi∥+ β
holds, where the λi are the highest weights of the irreducible components of the restriction
of ρ to G0.
Proof. In this proof, we will say that a pair (a, b) is a spot for a representation ρ of G if ρ
appears as a subrepresentation of Std⊗a ⊗D(Std)⊗b.
Let n be the semi-simple rank of G. For a positive dominant weight λ in Λ, we denote
by πλ the irreducible representation of G0 with highest weight λ.
We ﬁrst assume that G is a connected semisimple group. In this case, the represen-
tation ρ is associated to a single highest weight λ. Moreover, we can choose a basis (ei)
of the root lattice tensored with R such that a Weyl chamber can be identiﬁed with the
cone of vectors with coordinates ⩾0.
For integers i with 1 ⩽i ⩽n, we denote by λi the weight in the line spanned by ei
with minimal i-th coordinate, and we write λi = xiei for some integer xi ⩾1. Further,
for each i, we ﬁx spots (ai, bi) of πλi (which exist by Lemma 6.32).
We denote by A the ﬁnite set of positive dominant weights µ such that each coordinate
of µ is ⩽xi for all i. For each µ ∈A, we ﬁx spots (aµ, bµ) of πµ.
By subtracting from a weight λ of G suitable multiples of λ1, . . . , λn, until all coordi-
nates are ⩽xi, we see that we may write
λ = µ +
r
X
i=1
niλi
47

where µ ∈A and 0 ⩽ni ⩽ℓi(λ) for some linear maps ℓi : Λ →Z.
From highest weight theory, the representation ρ with highest weight λ is a summand
of
πµ ⊗
O
1⩽i⩽r
π⊗ni
λi .
Hence, by deﬁnition, the pair (a, b) given by
a = aµ +
r
X
i=1
niai,
b = bµ +
r
X
i=1
nibi,
is a spot of ρ. We have then
w(ρ) ⩽a + b ⩽α + β∥λ|
where
α = max
µ∈A (aµ + bµ),
β = max
1⩽i⩽r ∥ℓi∥×
r
X
i=1
(ai + bi)
(with the usual norm for linear maps Λ →R with respect to the given norm on Λ).
Assume now that G is a connected reductive group. We construct the weights λi and A
of the derived group of G as before, then lift them (keeping the notation) to the whole
group. Let further (γj)1⩽j⩽k be a basis of the subspace of the weights whose associated
representations are trivial on the derived group.
For any highest weight λ of G = G0, the representation πλ can then be expressed as a
summand of a representation of the form
πµ ⊗
O
1⩽i⩽r
π⊗ni
λi
⊗
O
1⩽j⩽k
π⊗mj
γj
where, as before, the ni and mj are bounded by linear functions of λ. This leads to a
bound of the desired type as in the semisimple case.
Finally, we consider the general case. Let Std0 be the tautological representation of G0.
Note that for any non-negative integers (a, b), the representation
(22)
IndG
G0(Std⊗a
0
⊗D(Std0)⊗b)
contains Std⊗a ⊗D(Std)⊗b as a subrepresentation. Moreover, by Frobenius reciprocity,
the multiplicity of ρ in (22) is the dimension of the space of G0-morphisms from the
restriction ρ0 of ρ to G0 to Std⊗a
0
⊗D(Std0)⊗b. For an irreducible component ρ′ of ρ0,
this space is non-zero for some (a, b) with a + b = w(ρ′). The bound then follows from
the case of connected groups established in the ﬁrst part.
□
6.10. Independence of ℓ. In this section and the next one, we work over a ﬁnite ﬁeld F
and k is an algebraic closure of F. We use the notation for trace functions from the
introduction.
We ﬁrst prove that the complexities of a compatible system of ℓ-adic
sheaves are largely independent of ℓ, following ideas from Katz [28].
We ﬁx a quasi-projective variety (X, u) over F and a ﬁeld K of characteristic zero. In
order to vary the prime ℓ, we make the following deﬁnitions. Let Λ be a non-empty set
and let S be a family (ℓλ, ιλ)λ∈Λ of pairs where each ℓλ is a prime number invertible in F
and ιλ is a ﬁeld embedding of the given ﬁeld K in Qℓλ.
Deﬁnition 6.37. An S -compatible system of complexes on X is a family (Aλ)λ∈Λ con-
sisting of objects Aλ of Db
c(X, Qℓλ) such that the following conditions hold:
• for any λ ∈Λ, any ﬁnite extension Fn of F, and any x ∈X(Fn), the trace
tAλ(x; Fn) takes values in the subﬁeld ιλ(K) of Qℓλ;
48

• for any λ, µ in Λ, any ﬁnite extension Fn of F, and any x ∈X(Fn), we have
ι−1
λ tAλ(x; Fn) = ι−1
µ tAµ(x; Fn).
Lemma 6.38. Let (Aλ)λ∈Λ be an S -compatible system on X. The Euler–Poincar´e char-
acteristic χc(X × k, Aλ) of Aλ is independent of λ.
Proof. For any λ, it follows from the deﬁnition of S -compatible system that the L-
function of Aλ is independent of λ. From the expression for this L-function given by
the Grothendieck–Lefschetz formula, we know that χc(X × k, Aλ) is the degree of this
rational function (degree of the numerator minus degree of the denominator), and hence
is independent of λ.
□
We then have the following result:
Theorem 6.39. Let S be as above.
(1) Let n ⩾0 be an integer and let (Aλ)λ be an S -compatible system of perverse sheaves
on Pn
F. Then for λ and µ in Λ, we have
c(Aλ) ≍c(Aµ),
where the implied constants only depend on n.
(2) Let (X, u) be a smooth quasi-projective variety over F and let (Fλ)λ be an S -compatible
system of lisse sheaves on X. Then for all λ and µ in Λ, we have
cu(Fλ) ≍cu(Fµ),
where the implied constants only depend on the embedding dimension of (X, u).
Proof. (1) We argue by induction on n, following the strategy of Katz [28, Th. 7]. It is
enough to prove the estimate
c(A1) ≪c(A2)
for two compatible perverse sheaves A1 in Db
c(Pn, Qℓ1) and A2 in Db
c(Pn, Qℓ2), with an
implied constant that only depends on n.
If n = 0, then A1 and A2 are vector spaces of the same dimension and their complexity
c(A1) = c(A2) is this common dimension.
We now ﬁx n ⩾1 and assume that the result holds on Pm for all 0 ⩽m ⩽n −1.
For each 0 ⩽m ⩽n −1, we pick a geometric generic point am ∈Mn+1,m+1(k′) for some
algebraically closed ﬁeld k′.
Let 0 ⩽m ⩽n −1. By applying Lemma 3.13 to A1 and A2, we ﬁnd open dense
subsets Um,1 and Um,2 of Mn+1,m+1
k
satisfying the properties of Lemma 3.13.
Up to
replacing F by a ﬁnite extension, which we may do, we can assume that (Um,1 ∩Um,2)(F)
is non-empty for all m, and we then pick bm ∈(Um,1 ∩Um,2)(F), again for all m. The
complexes l∗
bmA1[m−n] and l∗
bmA2[m−n] on Pm over F are perverse and form a compatible
system; hence, by the induction hypothesis, the equivalence
(23)
c(l∗
bmA1) ≍c(l∗
bmA2)
holds, with implied constants that only depend on n. We have
max
0⩽m⩽n−1
X
i∈Z
hi(Pm
k′, l∗
amA1) =
max
0⩽m⩽n−1
X
i∈Z
hi(Pm
k′, l∗
bmA1),
again by Lemma 3.13. Hence
(24)
max
0⩽m⩽n−1
X
i∈Z
hi(Pm
k′, l∗
amA1) = c(l∗
bmA1),
by the deﬁnition of the complexity and Lemma 3.7.
49

Together with (23), it follows that
c(A1) = max
0⩽m⩽n
X
i∈Z
hi(Pm
k′, l∗
amA1)
⩽
max
0⩽m⩽n−1
X
i∈Z
hi(Pm
k′, l∗
amA1) +
X
i∈Z
hi(Pn
k′, l∗
anA1)
≪c(l∗
bmA2) +
X
i∈Z
hi(Pn
k′, l∗
anA1)
≪c(A2) +
X
i∈Z
hi(Pn
k′, l∗
anA1).
Since the geometric generic point an ∈Mn+1,n+1
k′
induces an isomorphism lan of Pn
k′,
it is enough to prove the estimate
σ1 =
X
i∈Z
hi(Pn
k′, A1) ≪c(A2)
Arguing as in the proof of Proposition 3.17, we have
h0(Pn
k′, A1) = χ(Pn
k′, A1) +
X
i<0
(−1)i+1hi(Pn
k′, A1) +
X
i>0
(−1)i+1hi(Pn
k′, A1),
and therefore
σ1 =
X
i<0
hi(Pn
k′, A1) + h0(Pn
k′, A1) +
X
i>0
hi(Pn
k′, A1)
⩽2
X
i<0
hi(Pn
k′, A1) + χ(Pn
k′, A1) + 2
X
i>0
hi(Pn
k′, A1).
By excision and Artin’s vanishing theorem for aﬃne varieties, and the fact that A1 is
perverse, the canonical map
Hi(Pn
k′, A1) −→Hi(Pn−1
k′
, l∗
an−1A1)
is an isomorphism for i < 0. Similarly, because the dual of a perverse sheaf is perverse
and duality exchanges l∗
an−1 and l!
an−1, the canonical map
Hi(Pn−1
k′
, l!
an−1A1) −→Hi(Pn
k′, A1)
is an isomorphism for i > 0. Since lan−1 is a closed immersion, the functors l∗
an−1 and l!
an−1
are equal up to a shift and a Tate twist. Hence,
σ1 = 2
X
i<0
hi(Pn
k′, l∗
an−1A1) + χ(Pn
k′, A1) + 2
X
i>0
hi(Pn
k′, l!
an−1A1)
⩽4
X
i∈Z
hi(Pn−1, l∗
an−1A1) + χ(Pn
k′, A2)
using Lemma 6.38. Hence,
σ1 ≪c(A2) + χ(Pn
k′, A2) ≪c(A2),
by (23) and (24), and the elementary Proposition 7.1 below.
(2) The proof is similar, using the obvious adaptation of Lemma 3.13 to lisse sheaves,
and the fact that the dual of a lisse sheaf on a smooth scheme is lisse. Alternatively, but at
the cost of adding a dependency of the implied constants on c(u), we may use [19, Th. 3]
to reduce to (1); indeed, this shows that the middle extensions u!∗Aλ of the components
of a compatible system of lisse sheaves is a compatible system of perverse sheaves on the
50

projective space target of u, and one can apply Corollary 6.16 to bound the complexity
of the middle extensions.
□
6.11. Complex conjugation. We keep working over a ﬁnite ﬁeld F with algebraic clo-
sure k. In applications to analytic number theory, taking the complex conjugate of the
trace function tA is a natural operation, but this has no canonical counterpart at the level
of Db
c(X). Nevertheless, we have the following result:
Proposition 6.40. Let (X, u) be a quasi-projective algebraic variety over F. Given any
mixed object A of Db
c(X), there exists a mixed object A′ of Db
c(X) such that
tA′(·; Fn) = tA(·; Fn)
for any n
and
cu(A′) ≪c(u)cu(A),
where the implied constant depends only on the embedding dimension of (X, u).
Proof. For each n ⩾1, the trace function tA(·; Fn) is the restriction to the set X(Fn)
of Fn-rational points of X of the trace function of the complex u!A on Pn, which is again
mixed if so is A. Assume that we have found a mixed object eA of Db
c(Pn) that “works”
for u!A, then A′ = u∗eA works for A, and
cu(A′) ≪c(u)c( eA) ≪c(u)c(u!A) = c(u)cu(A),
where the ﬁrst bound is part (8) of Theorem 6.8. Thus, we may assume X = Pn (with
the identity embedding).
We ﬁrst assume that A is a perverse sheaf. If A is pure of weight zero, then A is
geometrically semisimple by [3, 5.3.8]. As explained in [29, Lem. 1.8.1. (1)], a result of
Gabber on the independence of ℓof traces of intermediate extensions [19, Th. 3] then
implies that we can take A′ = D(A). The perverse sheaf A′ is also pure of weight zero
and has complexity c(A′) = c(A) by Lemma 6.11. If A is pure of weight w, then we can
simply take A′ = D(A(w))(−w), which is pure of weight w.
Suppose now that A is a mixed perverse sheaf.
Let (Fj) be the canonical weight
ﬁltration on A, with quotients Fj+1/Fj pure of weight wj (see [3, Th. 5.3.5]). We ﬁrst
claim that the estimate
X
j
c(Fj+1/Fj) ≪c(A)
holds. Indeed, since the quotients are perverse sheaves, we have
X
j
c(Fj+1/Fj) ≪
X
j
∥cc(Fj+1/Fj)∥=

X
j
cc(Fj+1/Fj)
 = ∥cc(A)∥≪c(A)
by Corollary 5.5 and the fact that the characteristic cycles of perverse sheaves are eﬀective
(compare with the end of the proof of Theorem 6.15). In view of the equality
tA(·; Fn) =
X
j
tFj+1/Fj(·; Fn)
for all n ⩾1, we can take
A′ =
M
j
D((Fj+1/Fj)(wi))(−wi),
which is a mixed perverse sheaf with complexity
c(A′) =
X
j
c(D(Fj+1/Fj)) =
X
j
c(Fj+1/Fj) ≪c(A),
by Lemma 6.11 and the above.
51

Finally, in the general case, if A is a mixed complex of weights ⩽w, then its perverse
cohomology sheaves pH i(A) are mixed of weights ⩽w + i for all ∈Z by [3, Th. 5.4.1]
and we have
tA(·; Fn) =
X
i∈Z
(−1)itpH i(A)(·; Fn)
for all n ⩾1. For all i, let A′
i be a mixed perverse sheaf satisfying the conditions of the
proposition for pH i(A). We can deﬁne
A′ =
M
i∈Z
A′
i,
which satisﬁes
c(A′) =
X
i∈Z
c(A′
i) ≪
X
i∈Z
c(pH i(A)) ≪c(A)
by the previous case.
□
Remark 6.41. In practice, the conjugate of the trace functions that occur in concrete
applications are often clearly trace functions with essentially the same complexity (e.g.,
the conjugate of the trace function of an Artin–Schreier sheaf Lψ(f) is simply Lψ(−f)).
Nevertheless, Proposition 6.40 might be useful for certain theoretical arguments.
Remark 6.42. In fact, the assumption that A is a mixed object is always satisﬁed thanks
to the deep theorem of L. Laﬀorgue that an irreducible lisse sheaf with determinant of
ﬁnite order on a normal variety X is pure of weight zero (see [36, Prop. VII.7 (i)]). We
brieﬂy sketch how to deduce from this that A is mixed. By deﬁnition, it suﬃces to treat
the case where A is a constructible sheaf and, by induction on the dimension of X, we
can even suppose that A is lisse. The successive quotients of a Jordan–H¨older ﬁltration
of A are then irreducible lisse sheaves; up to a twist by some Qℓ(w), their determinant is
of ﬁnite order by geometric class ﬁeld theory (see [7, (1.3.6)]), and hence they are pure
thanks to Laﬀorgue’s theorem.
7. Examples and applications
7.1. Sums of Betti numbers. One of the most useful properties of the complexity is
that it controls Betti numbers, as the following proposition shows.
Proposition 7.1. Let (X, u) be a quasi-projective variety over k. For any A in Db
c(X),
the following holds:
|χc(X, A)| ⩽
X
i∈Z
hi
c(X, A) ⩽cu(A),
|χ(X, A)| ⩽
X
i∈Z
hi(X, A) ≪c(u)cu(A).
Moreover, the implied constant in the second estimate only depends on the embedding
dimension of (X, u).
Proof. Let n be the embedding dimension of (X, u). For each object A of Db
c(X), the
equality hi
c(X, A) = hi(Pn
¯k, u!A) holds. Since ´etale cohomology is invariant under ex-
tension of scalars to an algebraically closed ﬁeld k′ and lan : Pn
k′ →Pn
k′ is an isomor-
phism, the ﬁrst bound is a straightforward consequence of the deﬁnition of the complex-
ity cu(A). On noting that Verdier duality implies the equality of sums of Betti numbers
P
i∈Z hi(X, A) = P
i∈Z hi
c(X, D(A)), the second estimate then follows from the ﬁrst one
and the estimate cu(D(A)) ≪c(u)cu(A) from (4), with an implied constant that only
depends on n.
□
52

Remark 7.2. The converse estimate
cu(A) ≪
X
i∈Z
hi
c(X, A)
does not hold in general, since the right-hand side is independent of u, whereas we have
seen in Example 6.1 that there is no reasonable intrinsic notion of complexity of an object
of Db
c(X). This can also be seen concretely, e.g. in the case of curves.
7.2. Complexity of sheaves on curves. In the case of curves, we can write down an
explicit formula for the complexity.
Theorem 7.3. Let (C, u) be a smooth connected quasi-projective curve over k. Let C be
the smooth compactiﬁcation of C, and denote by g the genus of C, by n the number of
points of C −C, and by d the degree of u(C).
(1) The complexity of an object A of Db
c(C) is given by
(25)
cu(A) = max

d
X
i∈Z
dim H i(A)η,
X
i∈Z
hi
c(C, A)

,
where η stands for the generic point of C.
(2) If A is a perverse sheaf on C, the following inequalities hold:
max(d, 2g + n −2) rank(A) + loc(A) ⩽cu(A) ⩽max(d, 2g + n + 2) rank(A) + loc(A).
(3) If F is a middle-extension sheaf on C, the following inequalities hold:
max(d, 2g + n −2) rank(F) + loc(F) ⩽cu(F) ⩽max(d, 2g + n + 2) rank(F) + loc(F).
Proof. Part (1) is simply a translation of the deﬁnition of cu(A).
To deduce (2), we ﬁrst note that a perverse sheaf A satisﬁes
X
i∈Z
dim H i(A)η = dim H −1(A) = rank(A).
Writing the sum of Betti numbers as
X
i∈Z
hi
c(C, A) = −χc(C, A) + 2h0(C, A) + 2h−2(C, A),
we then have
−χc(C, A) ⩽
X
i∈Z
hi
c(C, A) ⩽−χc(C, A) + 4 rank(A).
Taking the equality χc(C, Qℓ[1]) = 2g −2 + n into account, the statement then follows
from the Grothendieck–Ogg–Shafarevitch formula.
Finally, (3) is a special case of (2), for the perverse sheaf A = F[1].
□
As a corollary, we can now compare the complexity deﬁned in this paper with the
“analytic conductor” of Fouvry, Kowalski and Michel for the aﬃne line over the algebraic
closure of a ﬁnite ﬁeld. Precisely, for a middle-extension sheaf F on A1 over such a ﬁeld,
the latter is deﬁned in [15, Def. 1.13] as
cfkm(F) = rank(F) + locfkm(F)
locfkm(F) = (number of singular points of F in P1) +
X
x∈P1
swanx(F).
Corollary 7.4. For a middle-extension sheaf F on A1 over a ﬁnite ﬁeld, the inequalities
cfkm(F) ⩽cu(F) ⩽3c2
fkm(F)
hold, with u the obvious embedding A1 →P1 of degree 1.
53

Proof. We apply Theorem 7.3 with g = 0, n = 1, and d = 1. On noting the inequal-
ity dropx(F) ⩽rank(F), the upper-bound in (3) leads to
cu(F) ⩽3 rank(F) + loc(F) ⩽3 rank(F) + rank(F) locfkm(F)
⩽3 rank(F)cfkm(F) ⩽3cfkm(F)2.
In addition, the inequality locfkm(F) ⩽loc(F) holds, hence the inequalities
cfkm(F) ⩽rank(F) + loc(F) ⩽cu(F)
by the lower-bound in loc. cit.
□
7.3. Artin–Schreier and Kummer sheaves. In this section, k is the algebraic closure
of a ﬁnite ﬁeld F.
Given an ℓ-adic additive character ψ: F →Qℓ
× (resp. an ℓ-adic
multiplicative character χ: F× →Qℓ
×), we denote by Lψ (resp. Lχ) the corresponding
Artin–Schreier sheaf on A1 over F (resp. the Kummer sheaf on Gm over F), as deﬁned,
e.g., in [6, Sommes exp.]. These are lisse sheaves of rank one; the Artin–Schreier sheaf
is wildly ramiﬁed at ∞if ψ is non-trivial, whereas the Kummer sheaf is tamely ramiﬁed
at 0 and ∞. We also denote by Lψ and Lχ the middle extensions of these sheaves to P1.
Proposition 7.5. Let C = P1 over k and u = Id.
(1) For any non-trivial additive character ψ of F, we have cu(Lψ) = 1.
(2) For any non-trivial multiplicative character χ of F×, we have cu(Lχ) = 1.
Proof. These follow from Theorem 7.3 (1) by the standard knowledge of the relevant Betti
numbers.
□
We can now easily estimate the complexity of more general Artin–Schreier and Kummer
sheaves, which are building blocks of many of the sheaves used in applications to analytic
number theory.
Deﬁnition 7.6. Let X be a scheme over F and U a dense open subset of X. Let j be the
open immersion U →X. For each morphism f : U →A1, we deﬁne the Artin–Schreier
sheaf Lψ(f) on X as Lψ(f) = j!f ∗Lψ. For each morphism g : U →Gm, we deﬁne the
Kummer sheaf Lχ(g) on X as Lχ(g) = j!g∗Lχ.
Let (X, u) be a quasi-projective variety over k, and let v: A1 →P1 be the obvious
embedding (or its restriction to Gm). Combined with (8) and (9), Proposition 7.5 gives
the estimates
cu(Lψ(f)) ≪cu◦j,u(j)cu◦j,v(f)
cu(Lχ(g)) ≪cu◦j,u(j)cu◦j,v(g),
(with the same notation as above, and when ψ and χ are non-trivial), where the implied
constants only depend on the embedding dimension of u. According to Remark 6.20,
these quantities are uniformly bounded if f or g varies among morphisms with “bounded
degree”. One can sometimes be more explicit, using tools like Proposition 6.21. Here is
a simple example:
Corollary 7.7. Let f1 and f2 be polynomials in n variables with coeﬃcients in k, with f2
non-zero. Let U ⊂An be the open set where f2 does not vanish. Set f = f1/f2 : U →A1.
Then the following estimate holds:
cu(Lψ(f)) ≪(4 + deg(f1) + deg(f2))n+2
where u: An →Pn is the standard embedding and the implied constant only depends
on n.
54

Proof. Apply the bound above combined with Proposition 6.21, viewing U as the sub-
scheme of An+1 deﬁned by the equation f2(x)y = 1, and f : U →A1 as the morphism
(x, y) 7→f1(x)y.
□
7.4. Further examples. We collect here a few more examples of “standard” sheaves
whose complexity is easily estimated. Again, k is the algebraic closure of a ﬁnite ﬁeld F.
Proposition 7.8.
(1) Let K be any hypergeometric sheaf on Gm in the sense of Katz1. We have
cu(K ) ≪rank(K )
where the implied constant is absolute and u: Gm →P1 is the standard embedding.
(2) Let (E, u) be an elliptic curve over F embedded in P2 as a cubic curve. Let θ be
a non-trivial character E(F) →Qℓ
×, and let Lθ be the associated character sheaf
deﬁned by the Lang isogeny. Then cu(Lθ) = 3.
(3) Let {x1, . . . , x4} be four distinct points in P1(F). Let F be an irreducible mid-
dle-extension sheaf of rank 2 on P1 over F with unipotent local monodromy at
those four points.2 Then c(F) = 2.
Proof. All these statements follow straightforwardly from calculating Betti numbers and
Theorem 7.3 (1).
In the case of a hypergeometric sheaf, the cohomology is one-dimensional.
In case (2), we apply (25) with (n, g, d) = (0, 1, 3). The rank of Lθ is 1, so the ﬁrst
term in the maximum is equal to 3. The second term is 0, since hi(E, Lθ) = 0 for all i
by the assumption that θ is non-trivial.
In case (3), we apply the formula with (n, g, d) = (0, 0, 1).
The ﬁrst term in the
maximum is 2 since the rank of F is 2. In the second term, we have
h0(P1, F) = h2(P1, F) = 0,
since F is an irreducible middle-extension sheaf of rank 2.
Thus, the sum of Betti
numbers is equal to −χ(P1, F). The Euler–Poincar´e characteristic formula for F gives
χ(P1, F) = 2χ(P1, Qℓ) −4 × 1 = 0
Hence, the sum of the Betti numbers vanishes and c(F) = 2.
□
7.5. Tame ramiﬁcation. When a sheaf naturally appears in higher dimension without
being obtained from simpler sheaves by means of Grothendieck’s six functors, one may
still be able to estimate its complexity, using either the direct deﬁnition of complexity,
or sometimes the uniformity statement of Proposition 6.19. We illustrate this here with
some results involving tame ramiﬁcation.
Proposition 7.9. Let X be a smooth scheme over k, and let j : X →X be an embedding
into a smooth scheme X such that the complement D = X \ X is a divisor with normal
crossings. Let i: X →Pn
k be a closed immersion, and let F be a lisse sheaf on X that is
tamely ramiﬁed along D. Then the following holds:
ci◦j(F) ≪rank(F)c(i ◦j).
1See [27, § 8.2] for the deﬁnition and properties of hypergeometric sheaves.
2 Deligne and Flicker [9, Prop. 7.1] have proved that there are |F| such sheaves up to isomorphism
and F-twisting.
55

Proof. Set d = dim(X). The object F[d] is perverse since F is a lisse sheaf on a smooth
scheme of dimension d. Since j is an aﬃne open immersion, the object j!F[d] is perverse
on X, and since i is a closed immersion, the object A = i!j!F[d] is also perverse (see [3,
Cor. 4.1.3]). Since A is perverse, Corollary 5.5 (2) and Lemma 2.5 yield
ci◦j(F) = c(A) ≪∥CC(A)∥≪sup
0⩽m⩽n | CC(A) · CC(Km)|,
where Km is the constant sheaf on a generic m-dimensional subspace of Pn.
By Theorem 2.2, | CC(A) · CC(Km)| is the absolute value of the Euler–Poincar´e char-
acteristic of the pullback of A to a generic m-dimensional subspace, or equivalently the
Euler–Poincar´e characteristic of the restriction of F to the intersection of a generic
m-dimensional subspace with X.
For a generic m-dimensional subspace H, the intersection H ∩X is smooth, the in-
tersection with D has normal crossings, and the restriction of F has tame ramiﬁcation
around the intersection with D. This implies the equality
χ(X ∩H, F) = rank(F)χ(X ∩H),
and since the linear subspace H is generic, the Euler–Poincar´e characteristic of X ∩H is
bounded by c(i ◦j).
□
Corollary 7.10. Let (X, u) and (Y, v) be quasi-projective algebraic varieties over k, and
let π: Y →X be a ﬁnite ´etale covering. Assume that v is the composition of an embedding
into a smooth normal crossings compactiﬁcation Y with a closed immersion. Let F be a
lisse sheaf on X such that π∗F is tamely ramiﬁed along Y −Y . Then the estimate
cu(F) ≪rank(F)cv,u(π)c(v)
holds, with an implied constant that only depends on the embedding dimensions of (X, u)
and (Y, v).
Proof. The composition of the adjunction maps
F →π∗π∗F = π!π∗F →F
is the multiplication by the degree of π. The sheaf F is hence a direct factor of π!π∗F,
and the estimates
cu(F) ⩽cu(π!π∗F) ≪cv,u(π)cv(π∗F) ≪rank(F)cv,u(π)c(v),
hold by Proposition 6.14, part (9) of Theorem 6.8, and Proposition 7.9 applied to π∗F
on Y .
□
7.6. The Riemann Hypothesis. In this section, we record the general “quasi-ortho-
gonality” version of the Riemann Hypothesis over ﬁnite ﬁelds arising from Deligne’s work
and the theory of complexity developed here.
We work over a ﬁnite ﬁeld F, and assume that k is an algebraic closure of F. We ﬁx
an isomorphism ι from Qℓto C to deﬁne weights, as explained in the notation section.
The notation for trace functions is also recalled there.
We ﬁrst explain the type of bounds for values of trace functions of perverse sheaves
that can be obtained using the complexity.
Proposition 7.11. Let (X, u) be a quasi-projective variety over F of pure dimension d.
Let M be a perverse sheaf on X that is pure of weight zero.
(1) For any x ∈X(F), the estimate tM(x) ≪cu(M) holds.
56

(2) If d ⩾1 and M is geometrically irreducible with support equal to X, then the
following estimate holds:
tM(x) ≪cu(M)|F|−1/2.
(3) There exists a stratiﬁcation of X, deﬁned over F, into locally closed strata Sj that
are irreducible and smooth of pure dimension dj such that the degree of u(Sj) is
bounded in terms of cu(M) and the estimate
tM(x) ≪cu(M)|F|
max{−d,−dj−1}
2
holds for all j and all x ∈Sj(F).
In all these estimates, the implied constants only depend on the embedding dimension of (X, u).
Proof. (1) The perversity of M implies the vanishing of the cohomology sheaves H i(M)
in all degrees i > 0 and i < −d. By the deﬁnition of weights for perverse sheaves, if M
is pure of weight zero, then H i(M) is pointwise mixed of weight ⩽i, which means that
the eigenvalues of Frobenius acting on the stalks H i(M)x all have modulus ⩽|F|i/2 ⩽1.
Therefore, the inequality
|tM(x)| ⩽
X
−d⩽i⩽0
|tH i(M)(x)| ⩽
X
−d⩽i⩽0
dim H i(M)x
holds, and it suﬃces to estimate the dimensions of the stalks of H i(M). From (8) applied
to the morphism x: Spec(F) →X, we derive the estimates
(26)
dim H i(M)x ⩽cu◦x(x∗M) ≪cu◦x,u(x)cu(M) = c(u ◦x)cu(M) = cu(M),
and hence the estimate tM(x) ≪cu(M) as claimed.
(2) If we assume, moreover, that M is a geometrically irreducible perverse sheaf with
support X, by [3, Th. 4.3.1 (ii)] there exists a dense open subset j : U →X and a lisse
sheaf F on U such that M is the middle extension j!∗F[d]. Then H 0(M) vanishes
by [3, Prop. 2.2.4], so that the eigenvalues of Frobenius have modulus ⩽|F|−1/2 and the
same argument as in (1) yields the stronger estimate
|tM(x)| ≪cu(M)|F|−1/2.
(3) By Theorem 6.23, there exists a stratiﬁcation of X, deﬁned over F, into locally
closed strata Sj such that the restriction of H i(M) to each Sj is lisse and the de-
gree of u(Sj) is bounded in terms of cu(M). By [3, Prop. 2.2.4], there is an inequality
dim Supp(H i(M)) < −i −1 for all −i < d. Since H i(M) restricts to a lisse sheaf on Sj,
we must have dj < −i whenever H i(M) is non-zero and dj ̸= d.
□
Remark 7.12. The following example shows that the estimates in Proposition 7.11 are
best possible in general. Assume that the ﬁnite ﬁeld satisﬁes |F| ≡1 (mod 3). Let χ
be a non-trivial multiplicative character of order three of F and let Lχ be the associated
Kummer sheaf on Gm. Denote by j : U →An the inclusion of the complement of the
hypersurface F ⊂An given by the equation
x3
1 + · · · + x3
n = 0.
Let F be the lisse sheaf Lχ(x3
1+···+x3n)(−n/2) on U and let M = j!∗(F[n]) be its middle
extension to An, shifted to make it perverse.
Then M is a geometrically irreducible
perverse sheaf of weight zero and the equality |tM(x)| = |F|−n/2 holds for all x ∈U(F).
We claim that, at the origin, the trace function of M satisﬁes
|tM(0)| = |F|−1/2.
57

To see this, let h: X′ →An denote the blow-up of An at the origin, E ≃Pn−1 the ex-
ceptional divisor, F ′ the strict transform of F, and j′ : U′ →X′ the inclusion of the inverse
image U′ = h−1(U) of U. We deﬁne F ′ = h∗F and M′ = j′
!∗(F ′[n]). Since χ is a charac-
ter of order three, a local computation shows that F ′ extends to a lisse sheaf outside F ′
(for example, in the aﬃne chart given by y1 = 1 and yi = xi/x1 for i = 2, . . . , n, this
follows from the equality Lχ(x3
1+···+x3n) = Lχ(x3
1(1+y3
2+···+y3n)) = Lχ(1+y3
2+···+y3n)). Since F ′ is
a smooth divisor, the perverse sheaf M′ is the extension by zero of the shift of this lisse
sheaf to X′. Hence, its trace function at a point y = [y1 : · · · : yn] ∈E(F) equals
tM′(y) =
(
χ(y3
1 + · · · + y3
n)
if y3
1 + · · · + y3
n ̸= 0,
0
otherwise.
By the decomposition theorem [3], the perverse sheaf M is a direct factor of h!(M′), and
since h is an isomorphism outside the origin, the other irreducible components of h!(M′)
are skyscraper sheaves supported at zero. By the Grothendieck–Lefschetz trace formula,
the trace function of M at 0 is equal to
1
|F|n/2
X
[y1:···:yn]∈Pn−1(F)
y3
1+···+y3n̸=0
χ(y3
1 + · · · + y3
n),
which up to the normalizing factor |F|−n/2 is a sum of Jacobi sums of weight n −1 by
a classical computation (see [24, Ch. 8, Th. 5]). Weyl’s equidistribution theorem implies
that this sum does not cancel, at least for some extensions of any given ﬁnite ﬁeld.
Theorem 7.13 (Quasi-orthogonality). Let F be a ﬁnite ﬁeld of characteristic diﬀerent
from ℓ.
Let (X, u) be a geometrically irreducible quasi-projective algebraic variety of
dimension d over F.
(1) Assume that X is smooth. Let A and B be ℓ-adic constructible sheaves on X.
Suppose that A and B are mixed of weights ⩽0 and that there exists a dense open
subset U of X on which A and B are lisse sheaves, pure of weight zero, and geometrically
irreducible. Then there exists a complex number α of modulus 1 such that the estimate
 1
|F|d
X
x∈X(F)
tA(x)tB(x) −αδ(A, B)
 ≪c(u)cu(A)cu(B)|F|−1/2
+ c(u)(cu(A) + cu(B))|F|−1
holds, with δ(A, B) = 1 if A and B are geometrically isomorphic over U and δ(A, B) = 0
otherwise.
(2) Let A and B be geometrically irreducible ℓ-adic perverse sheaves on X. Suppose
that A and B are pure of weight zero. Then there exists a complex number α of modulus 1
such that the estimate

X
x∈X(F)
tA(x)tB(x) −αδ(A, B)
 ≪c(u)cu(A)cu(B)|F|−1/2
holds, with δ(A, B) = 1 if A and B are geometrically isomorphic and δ(A, B) = 0.
In both estimates, the implied constant only depends on the embedding dimension
of (X, u).
Proof. We start with (1). Since B restricts (up to a shift and a Tate twist) to a perverse
sheaf of weight zero on U, the proof of Proposition 6.40 shows that tB coincides with
the trace function of D(B) on U(F). Since A and B are geometrically irreducible, the
object A ⊗D(B) has non-trivial cohomology with compact support in top degree 2d if
58

and only if A and B are geometrically isomorphic, and in that case this cohomology is
one-dimensional. By [29, Lem. 1.8.1], if A and B are geometrically isomorphic, there is an
isomorphism B ≃A ⊗αdeg for a unique α ∈Qℓ, which has modulus 1 when viewed as a
complex number. Arguing as in the proof of Katz’s orthogonality theorem [29, Th. 1.7.2],
the combination of the Grothendieck–Lefschetz trace formula and Deligne’s Riemann
Hypothesis thus gives the estimate
 1
|F|d
X
x∈U(F)
tA(x)tB(x) −αδ(A, B)
 ⩽σ|F|−1/2,
where σ denotes the sum of Betti numbers
σ =
X
i∈Z
hi
c(UF, A ⊗D(B)).
By Proposition 7.1 and (5), this quantity is bounded by
σ ≪c(A ⊗D(B)) ≪cu(A)cu(D(B)) ≪c(u)cu(A)cu(B).
On the other hand, on the complement X −U, the functions tA and tB are bounded by
the generic rank of A and B respectively, which are in turn bounded by their complexity
taking (26) into account. This gives the estimate
 1
|F|d
X
x∈(X−U)(F)
tA(x)tB(x)
 ≪cu(A)cu(B)|(X −U)(F)||F|−d.
We then note that U is contained in the intersection of the maximal open set U1 where A
is lisse and the maximal open set U2 where B is lisse, and hence the estimates
deg(X −U) ≪deg(X −U1) + deg(X −U2) ≪c(u)(cu(A) + cu(B))
hold by Theorem 6.23 (recall that X is assumed to be smooth). We conclude using the
classical bound |(X −U)(F)| ⩽deg(X −U)|F|dim(X−U).
The proof of (2) is the same, except that the term |F|−d does not appear due to the
normalization of weights for perverse sheaves (see Remark 1.3) and that we do not need
to treat the sum over points of X −U.
□
Taking X = An, the second statement immediately implies Theorem 1.2.
Remark 7.14. In the setting of part (2) of Theorem 7.13, suppose that one knows that
there is β ⩾0 such that
Hi
c(XF, A ⊗D(B)) = 0
for i ⩾−β (the case β = 0 corresponds to the assumption that A and B are not
geometrically isomorphic). Then by the same argument and the Riemann Hypothesis,
we obtain the stronger estimate
X
x∈X(F)
tA(x)tB(x) ≪c(u)cu(A)cu(B)|F|−(β+1)/2.
The case where β = dim(X) −1 corresponds to full square-root cancellation for the sum
over X(F).
A basic ﬁniteness statement follows from this result:
Corollary 7.15. Let F be a ﬁnite ﬁeld of characteristic diﬀerent from ℓ. Let (X, u) be a
geometrically irreducible quasi-projective algebraic variety over F.
59

For any c ⩾1, there are, up to geometric isomorphism, only ﬁnitely many ℓ-adic
perverse sheaves A on X of complexity cu(A) ⩽c that are geometrically irreducible and
pure of weight zero.
Proof. By Theorem 7.13, applied to ﬁnite extensions of F, we ﬁrst see that there exists
a ﬁnite extension Fn of F (depending on c) such that the equality of trace functions
tA(·; Fn) = tB(·; Fn) implies that A and B are geometrically isomorphic, for irreducible
perverse sheaves A and B of weight zero on X with cu(A) ⩽c and cu(B) ⩽c. Moreover,
we can also ensure that X(Fn) is not empty and that tA(·; Fn) ̸= 0 when cu(A) ⩽c.
Replacing F by Fn, it is then enough to prove that there are only ﬁnitely many func-
tions tA for irreducible perverse sheaves of weight zero with cu(A) ⩽c, up to geomet-
ric isomorphism.
Let C(X(Fn)) be the ﬁnite-dimensional Hilbert space of functions
X(Fn) →C with norm
∥f∥=
X
x∈X(Fn)
|f(x)|2.
Theorem 7.13 again implies that for A not geometrically isomorphic to B with cu(A) ⩽c
and cu(B) ⩽c, the functions tA/∥tA∥and tB/∥tB∥, viewed as elements of the unit sphere
of C(X(Fn)), make an angle ⩾θ for some θ > 0 independent of A and B. It is well-known
that there can only be ﬁnitely many such vectors.
□
Remark 7.16. This argument can be made quantitative, although it is probably far
from sharp; see [12] for the case of curves.
7.7. Examples. We collect here for ease of reference some immediate corollaries of the
formalism of Section 6. These contain and generalize all the basic “continuity” estimates
of Fouvry, Kowalski and Michel in the case of curves.
Example 7.17 (Fourier Transform). Let F be a ﬁnite ﬁeld. Let n ⩾1 be an integer and
let X = An viewed as a commutative algebraic group over F, with the obvious embedding
in Pn to deﬁne the complexity. Let ψ be a ﬁxed non-trivial ℓ-adic additive character of F
and consider the Artin–Schreier sheaf L = Lψ(x·y) of rank 1 on An × An, where x · y
is the standard scalar product. Deligne deﬁned the ℓ-adic Fourier transform FTψ as the
functor Db
c(An) →Db
c(An) given by
FTψ(A) = p2,!(p∗
1A ⊗L ) = p2,∗(p∗
1A ⊗L )
(see [38, 1.2.1.1]; the equality of the two expressions is a highly non-trivial fact, often
referred to as “the miracle of the Fourier transform”).
From the results of Section 6 and Corollary 7.7, we therefore deduce:
Proposition 7.18. There exists an integer N ⩾0, depending only on n, such that
c(FTψ(A)) ⩽Nc(A)
holds for any object A of Db
c(An).
The results of Section 8, together with Propositions 6.21 and 7.5, lead to explicit
estimates for N. These are growing at least as fast as n!, and it might be interesting to
have a better estimate for this “norm” of the ℓ-adic Fourier transform.
For n = 1, Fouvry, Kowalski and Michel proved the inequality
cfkm(FTψ(A)) ⩽10cfkm(A)2
(for middle-extension Fourier sheaves) in [15, Prop. 8.2]; this estimate plays an essential
role in many analytic applications, and one can expect a similar use of Proposition 7.18.
60

Example 7.19 (Other cohomological transforms). Let (X, u) and (Y, v) be quasi-pro-
jective varieties over k and K an object of Db
c(X × Y ). Let TK : Db
c(X) →Db
c(Y ) denote
the “cohomological transform with kernel K”, i.e., the functor such that
TK(A) = p2,!(p∗
1A ⊗K),
where p1: X × Y →X and p2 : X × Y →Y are the projections.
Applying again the formalism, there exists a constant NK, depending on K, such that
the inequality
cv(TK(A)) ⩽NKcu(A)
holds for any object A of Db
c(X). Precisely, this holds with
NK = cu⊠v,v(p2)cu⊠v,v(p1)cu⊠v(K)
(where u ⊠v is used to denote the composition of u × v with the Segre embedding of the
product of the projective spaces target of u and v; as in the case of the Fourier transform,
other embeddings of X × Y might be possible).
In the very special case where X = Y = A1 (over ﬁnite ﬁelds) and K is a rank 1 Artin–
Schreier or Kummer sheaf on A2, we can apply Corollary 7.7 to estimate the complexity of
the kernel sheaf; a weaker form of the resulting estimate was proved by Fouvry, Kowalski
and Michel [16, Th. 2.3].
Other special cases that have been already considered (when n = 1) for the varieties
X = Y = A1 or X = Y = Gm are additive convolution and multiplicative convolution.
More generally, let G be a commutative quasi-projective algebraic group over k, with
a given locally closed embedding u. Let σ: G × G →G be the addition morphism. We
have two convolution functors
∗: Db
c(G) × Db
c(G) →Db
c(G),
∗!: Db
c(G) × Db
c(G) →Db
c(G)
deﬁned by
A ∗B = σ∗(A ⊠B),
A ∗! B = σ!(A ⊠B).
Use the composition of the Segre embedding with u × u to embed G × G in projective
space.3 Then by (11) and (9) and Proposition 6.12, there exists an integer N such that
the inequalities
cu(A ∗B) ⩽Ncu(A)cu(B),
cu(A ∗! B) ⩽Ncu(A)cu(B)
hold for all objects A and B of Db
c(G).
Example 7.20 (Gowers uniformity sheaves). Let (G, u) be a commutative quasi-pro-
jective algebraic group over a ﬁeld k0, with the group law written additively. For each
integer d ⩾1, we denote by πd : Gd+1 →G the projection (x, h1, . . . , hd) 7→x. Given a
complex A of Db
c(G), we deﬁne the uniformity object Ud(A) as
Ud(A) = πd,!
O
I
D◦|I|(σ∗
IA)

,
where the tensor product runs over all subsets I ⊂{1, . . . , d}. For each of them, D◦|I|
denotes the Verdier duality functor if |I| is odd and the identity functor if |I| is even, and
the morphism σI : Gd+1 →G is given by
σI(x, h1, . . . , hd) = x +
X
i∈I
hi.
3 For certain groups, such as aﬃne groups, one can also use other embeddings.
61

The point of this construction is that, in the case where k0 is a ﬁnite ﬁeld F and A is
a perverse sheaf pure of weight zero, the trace function of Ud(A) satisﬁes
X
x∈F
tUd(A)(x) = ∥tA∥2d
Ud,
where ∥·∥Ud is the d-Gowers norm for a complex-valued function on the ﬁnite group G(F),
see [41, Def. 11.2]. For G = Ga, this construction is implicitly used in [13] to obtain an
“inverse theorem” for Gowers norms of one-variable trace functions, and various results
from loc. cit. can actually be interpreted as bounds for the complexity of Ud(A) in terms
of that of A. Thanks to Theorem 6.8, we can generalize them to any group: there exists
an integer Nd ⩾0 such that the inequality
cu(Ud(A)) ⩽Ndcu(A)2d
holds for all objects A of Db
c(G).
Example 7.21 (Sum-product sheaves). In [34] and [35], special cases of the following
construction are applied to Kloosterman sheaves: given an input object A in Db
c(A1) and
an integer l ⩾1, one constructs a “sum-product” object
Bl =
O
1⩽i⩽l
f ∗
i A ⊗f ∗
i+l D(A)
on A2+2l, with coordinates (r, s, b), by means of the functions fi(r, s, b) = r(s + bi). It
follows from the general formalism that, performing this construction with any input
object A in Db
c(A1), we have
cv(Bl) ⩽Nlcu(A)2l
for some constant Nl depending only on l (the embeddings are the standard embeddings
u: A1 →P1 and v: A2l+1 →P2l+1).
7.8. Equidistribution. Using the theory of complexity developed in this paper, the
“horizontal” version of Deligne’s Equidistribution Theorem formulated by Katz in the case
of curves [26, Ch. 3] admits a straightforward extension to higher-dimensional varieties.
As before, we ﬁx an isomorphism ι: Qℓ→C through which both ﬁelds are identiﬁed.
Theorem 7.22. Let N ⩾1 be an integer and let (X, u) be a smooth and connected
quasi-projective scheme over Spec(Z[1/N]) with geometrically irreducible generic ﬁber.
For each prime p not dividing N, let (XFp, up) denote the reduction of (X, u) modulo p.
Let P be an inﬁnite set of primes not dividing Nℓ, and assume that we are given, for
each p ∈P, a lisse ℓ-adic sheaf Fp on XFp that is pure of weight zero and whose
complexity satisﬁes cup(Fp) ≪1.
Assume that, for each p ∈P, the geometric and arithmetic monodromy groups of Fp
coincide and are isomorphic to a ﬁxed semisimple (i.e., the connected component of the
identity is semisimple) algebraic group G. Let K be a maximal compact subgroup of G(C).
For p ∈P and x ∈X(Fp), let θp(x) be the unique conjugacy class in K that intersects
the conjugacy class of the semisimpliﬁcation of the image in G of the Frobenius at x
relative to Fp, so that the equality
Tr(θp(x)) = tFp(x)
holds. Then the families (θp(x))x∈X(Fp) become equidistributed as p →+∞in the space
of conjugacy classes of K, with respect to the Haar probability measure.
62

Proof. Let d be the relative dimension of X over Spec(Z[1/N]). Shrinking P and X if
necessary, we may assume that XFp is a smooth and geometrically connected variety of
dimension d and that X(Fp) is not empty for all primes p in P. In fact, the number
of Fp-points behaves asymptotically like |X(Fp)| ∼pd as p →+∞by the Lang–Weil
estimate.
Each lisse ℓ-adic sheaf Fp corresponds to a representation of the fundamental group π1(XFp)
of XFp. According to the Weyl Criterion, equidistribution follows from the vanishing
(27)
lim
p→+∞
1
|X(Fp)|
X
x∈X(Fp)
Tr(ρ(θp(x))) = 0
for any non-trivial irreducible representation ρ of K. By the correspondance between
semisimple algebraic groups and compact Lie groups, such a representation ρ corresponds
uniquely to an algebraic irreducible representation of the algebraic group G, which is still
denoted by ρ. The lisse sheaf ρ(Fp) on XFp (see Section 6.9) satisﬁes
Tr(ρ(θp(x))) = tρ(Fp)(x)
for all x ∈X(Fp). Moreover, this sheaf is of weight zero (the group G being semisimple,
it is a subsheaf of some tensor power F ⊗a by Lemma 6.32), geometrically irreducible
(since its arithmetic and geometric monodromy group are equal), and non-trivial. By the
Riemann Hypothesis (Theorem 7.13 (1)), applied with B = Qℓ, the estimate
1
pd
X
x∈X(Fp)
Tr(ρ(θp(x))) ≪cup(ρ(Fp))p−1/2
holds for all p ∈P. By Proposition 6.33, there exists an integer a ⩾0, depending only
on ρ, such that
cup(ρ(Fp)) ≪cup(F)a.
Since we assumed that cup(Fp) is bounded, this estimate implies (27).
□
In practice, some multi-variable cases of this theorem could be proved by applying the
Deligne–Katz equidistribution theorems to families of curves covering X.
Katz–Sarnak [31, §9.6] and Katz [29, Ch. 12] have proved earlier statements of the same
kind, but assuming that Fp is the base change to Fp of a “common” sheaf or perverse
sheaf on X over Z[1/N].
In fact, we now show that Theorem 7.22 gives a positive answer to the question of
Katz [29, p. 8 and 12.6.6] concerning equidistribution of certain higher-dimensional fam-
ilies of additive character sums. This illustrates that the theory of complexity can, to a
certain extent, obviate the lack of a theory of exponential sums over Z (the second part
implies Theorem 1.4 from the introduction).
Let n ⩾1 and d ⩾1 be integers. Let P(n, d) be the space of polynomials of degree d
in n variables, and P(n, d, odd) ⊂P(n, d) the subspace consisting of odd polynomials,
by which we mean that only monomials of odd degree have non-zero coeﬃcients. For a
prime number p and f ∈P(n, d)(Fp), set
S(f; p) =
1
pw(f)/2
X
x∈Fnp
e
f(x)
p

,
where w(f) is the smallest integer such that the vanishing
Hi
c(An
Fp, Lψ(f)) = 0
holds for all i > w(f), and we recall the notation e(z) = exp(2iπz).
63

For an even integer N, we denote by
USpN(C) = UN(C) ∩SpN(C)
the group of unitary symplectic matrices of size N, which is a maximal compact subgroup
of the symplectic group SpN(C).
Corollary 7.23. Let n ⩾1 and d ⩾1 be integers. Set Kn = U(d−1)n(C) and, for odd d,
Kn,odd =
(
USp(d−1)n(C)
if n is odd,
O(d−1)n(C)
if n is even.
(1) The families (S(f; p))f∈P (n,d)(Fp) become equidistributed as p →+∞with respect
to the measure which is the image under the trace of the probability Haar measure
on Kn.
(2) Suppose that d is odd. The families (S(f; p))f∈P (n,d,odd)(Fp) become equidistributed
as p →+∞with respect to the measure which is the image under the trace of the
probability Haar measure on Kn,odd.
Proof. Note that P(n, d) is a dense open subset of the aﬃne space of polynomials of
degree ⩽d in n variables. Let D(n, d) ⊂P(n, d) denote the dense open subset of Deligne
polynomials (namely, those for which the homogeneous part of highest degree deﬁnes a
smooth hypersurface in Pn−1) and let D(n, d, odd) ⊂P(n, d, odd) be the subset of odd
Deligne polynomials. Both D(n, d) and D(n, d, odd) are smooth schemes over Z.
Because (by the Riemann Hypothesis) the estimate
|S(f; p)| ⩽
X
i⩽w(f)
hi
c(An
Fp, Lψ(f)) ≪c(Lψ(f)) ≪1
holds for all p and f ∈P(n, d)(Fp), it is enough to prove the equidistribution of the
sums S(f; p) for f ∈D(n, d)(Fp) (resp. f ∈D(n, d, odd)(Fp)).
We ﬁrst handle separately the cases d = 1 and d = 2. If d = 1, the sum S(f; p) vanishes
for any non-zero linear polynomial f. Since K0 = U0(C) is the trivial group, whose only
element has trace zero, the equidistribution holds in that case.
If d = 2, then K2 = U1(C) is the unit circle. Write a polynomial f ∈D(n, 2)(Fp) as
f(x) = Q(x) + λ(x) + µ,
where Q is a non-degenerate quadratic form, λ a linear form and µ a constant. For each
prime p ⩾3, it is an elementary consequence of the fact that normalized Gauss sums
have modulus one that |S(f; p)| = 1. Let h ⩾1 be an integer. Then
X
f∈D(n,2)(Fp)
S(f; p)h =
1
pnh/2
X
x1,...,xh∈Fnp
X
Q,λ
e
1
p
X
i
(Q(xi) + λ(xi)
 X
µ∈Fp
e
hµ
p

.
This vanishes as soon as p > h. If h ⩽−1, we obtain the same conclusion after noting
that S(f; p)−1 = S(f; p) = S(−f; p). Thus,
lim
p→+∞
1
|D(n, 2)(Fp)|
X
f∈D(n,2)(Fp)
S(f; p)h = 0
for any non-zero integer h, which proves equidistribution in U1(C) = K2.
We now assume that d ⩾3. For a prime p, let ψ be an ℓ-adic character with trace
function x 7→e(x/p), under the identiﬁcation of Qℓand C. On An × D(n, d) over Fp
with coordinates (x, f) we have the Kummer sheaf Lψ(f(x)). Deﬁne
Dp = p2,!Lψ(f(x))[n](n/2),
64

where p2: An × D(n, d) →D(n, d) denotes the projection to the second factor, so that
the equality
S(f; p) = (−1)ntDp(f)
holds by the trace formula. This is a priori an object of the derived category of D(n, d)
over Fp, but Deligne has shown (see [29, Cor. 3.5.11, Cor. 3.5.12]) that Dp is in fact a lisse
sheaf of rank N = (d −1)n and pure of weight zero for each prime p not dividing d.
We ﬁrst prove (2), which ﬁts exactly the statement of Theorem 7.22. The relevant
monodromy groups have been computed by Katz [29, Th. 12.6.3]: if p ⩾7 and p ∤d, the
geometric and arithmetic monodromy groups of the restriction Fp of Dp to D(n, d, odd)
coincide and are equal to SpN if n is odd and to ON if n is even (precisely, these references
show that the geometric monodromy group is as stated, but by [29, Th. 3.10.6], these
sheaves are arithmetically self-dual, so their arithmetic monodromy groups cannot be
bigger).
Hence, Kn,odd is a maximal compact subgroup of the complex points of the
geometric monodromy group for any p. Moreover, denoting by i the closed immersion
D(n, d, odd) →D(n, d), the estimate
c(Fp) = c(i∗p2,!L (ψ(f(x)))) ≪c(i)c(p2)c(Lψ(f(x)))
holds by (8) and (9) for any prime p, where the complexities are computed using the
embeddings of An, D(n, d) and their product and subschemes are induced by the natural
embeddings of aﬃne spaces in the projective space of the same dimension.
By the bound in Section 7.3 and by Theorem 6.19, we deduce that c(Fp) ≪1 for all p,
where the implied constant depends only on (d, n). Thus, the equidistribution in (2)
follows from Theorem 7.22.
We now come back to (1). Here we note that, as above, we have c(Dp) ≪1 for all p, but
the setting is not exactly that of Theorem 7.22. Indeed, Katz proved in [29, Th. 6.8.34]
that the geometric monodromy group of Dp, for p ⩾7 that does not divide d(d −1), is
the group
G2p = {g ∈GLN | det(g)2p = 1},
which depends on p. We argue then by repeating the use of the Weyl Criterion in the
proof of Theorem 7.22.
For f ∈D(n, d)(Fp), we denote by θp(f) the conjugacy class in G2p corresponding to
the Frobenius at f, whose trace is equal to S(f; p). Let ρ be a non-trivial irreducible
representation of UN(C), which can also be viewed as a representation of GLN. The lisse
sheaf ρ(Dp) satisﬁes c(ρ(Dp)) ≪1 for all p (as in loc. cit.). The restriction of ρ to G2p is a
direct sum of a bounded number of irreducible representations. We claim that if p is large
enough, depending on ρ, then this restriction does not contain the trivial representation
of G2p. Indeed, by Frobenius reciprocity, the multiplicity of the trivial representation is
equal to the sum over h ∈Z of the multiplicity of the character det(·)2ph in ρ, i.e., it
is equal to one if ρ = det(·)2ph for some non-zero h (because ρ is non-trivial), and zero
otherwise. The ﬁrst case cannot occur if p is large enough, hence the claim.
Now applying the Riemann Hypothesis as above to each irreducible subrepresentation
of ρ(Dp), we obtain
1
|D(n, d)(Fp)|
X
f∈D(n,d)(Fp)
Tr(ρ(θp(f))) ≪p−1/2
for all p, where the implied constant depends only on (n, d, ρ). This implies the equidis-
tribution in (2).
□
65

In [11], the three last-named authors use the theory of complexity, among other tools,
to study the equidistribution of families of exponential sums arising as discrete Fourier–
Mellin transforms of trace functions on commutative algebraic groups, generalizing the
equidistribution theorems of Deligne [7] (for powers of Ga, through the Fourier transform)
and Katz [30] (for Gm), see [17] for a survey. Among other things, this has applications,
also discussed in [11], to the study of the variance of arithmetic functions over func-
tion ﬁelds in arithmetic progressions, improving results of Hall, Keating and Roddity-
Gershon [23].
We state here (a form of) the basic result, in the “vertical” direction
(see [11, Th. 2]).
Theorem 7.24. Let (G, u) be a connected commutative algebraic group over a ﬁnite
ﬁeld F with a given quasi-projective embedding. Denote by Fn the extension of F of
degree n in an algebraic closure of F and by bG(Fn) the group of characters of G(Fn).
Let A be a geometrically irreducible perverse sheaf on G which is pure of weight zero.
There exists a complex reductive algebraic group GA with a maximal compact subgroup KA
such that the sums
S(M, χ) =
X
x∈G(Fn)
χ(x)tA(x; Fn),
deﬁned for χ ∈bG(Fn), become equidistributed on average in C with respect to the image
under the trace map of the Haar probability measure µ on KA, i.e. the equality
lim
N→+∞
1
N
X
1⩽n⩽N
1
|G(Fn)|
X
χ∈b
G(Fn)
f(S(M, χ)) =
Z
KA
f(Tr(g))dµ(g)
holds for any continuous and bounded function f : C →C.
8. Effective bounds
It is clear that the implied constants in our bounds for all of Grothendieck’s six func-
tors can be made eﬀective as long as that for the Betti numbers of a tensor product of
complexes in Theorem 5.1 can be made eﬀective. We state here such an eﬀective bound
and sketch the proof.
Theorem 8.1. For all objects A and B of Db
c(Pn
k), the following estimate holds:
X
i∈Z
hi(Pn
k, A ⊗B) ⩽216
34 e4/1313n(n + 2)! c(A)c(B).
Sketch of proof. The primary issue is to control the bilinear form of Corollary 5.5. It is
convenient to calculate with this bilinear form in a basis generated by constant sheaves
(identical to that of Lemma 2.5 up to a sign). Let em be the class of CC(Km) for Km
the constant sheaf on an m-dimensional subspace, so that e0, . . . , en form a basis of the
vector space CHn
 T ∗Pn
⊗Q. By Theorem 2.2, the intersection pairing
em1 · em2 = CC(Km1) · CC(Km2)
is equal to (−1)n times the Euler–Poincar´e characteristic of the intersection of a general
m1-dimensional subspace and a general m2-dimensional subspace. This intersection is a
projective space of dimension m1 + m2 −n, and hence has Euler–Poincar´e characteristic
min(m1+m2+1−n, 0), so the intersection number is equal to (−1)n min(m1+m2+1−n, 0).
By construction, the function of Lemma 3.15 is easy to calculate with respect to
this basis: it sends em to em−1.
Therefore, the bilinear form of Lemma 5.5 satisﬁes
66

f(em1, em2) = g(m1 + m2 + 1 −n) with
g(x) =
x
X
k=0
4k(x −k) = 4x+2 −3x −4
9
for x ⩾0 and g(x) = 0 for x ⩽0. For simplicity, we will upper-bound it by the simpler
bilinear form f such that f(em1, em2) = 4m1+m2+3−n/9.
Set e′
i = P
j⩽i 2i−jej. Then e′
0, . . . , e′
n also form a basis. Fix a norm ∥· ∥on the vector
space CHn
 T ∗Pn
⊗R which is the ℓ∞norm in this basis. This basis is convenient because
the intersection of e′
i with the characteristic cycle of a test sheaf supported on Pm is 1
if m + i = n and 0 otherwise. To check this, it suﬃces to check that the intersection
number of ei with the characteristic cycle of a test sheaf supported on Pm is equal to 1
if i + m = n, to −2 if i + m −n = 1, and to 0 otherwise. This follows from the fact that
the tensor product of Ki with the test sheaf supported on Pm is the test sheaf supported
on Pi+m−n, which has Euler–Poincar´e characteristic equal to 1 if i + 2 −n = 0, to −2
if i + m −n = 1, and to 0 otherwise.
Because the intersection number of e′
i with the characteristic cycle of a test sheaf is
equal to 1 on Pm if m + i = n and to 0 otherwise, Proposition 5.4 then shows that for a
perverse sheaf A, the norm ∥CC(A)∥is bounded by 4(n + 1)c(A).
Rewriting the bilinear form f in the basis e′
i gives
f(e′
i1, e′
i2) =
X
j1⩽i1
X
j2⩽i2
2i1−j12i2−j24j1+j2+3−n
9
= 2i1+i243−n
9
 X
j1⩽i1
2j1 X
j2⩽i2
2j2
⩽2i1+i244−n
9
2i1+12i2+1 = 4i1+i2+4−n
9
.
Hence, the total norm of the bilinear form is at most
n
X
i1=0
n
X
i2=0
4i1+i24−n
9
= 44−n
9
 n
X
i=0
4in
= 44−n
9
4n+1
3
2
= 46+n
34
and the constant of Corollary 5.5 involves an extra factor of 16(n + 1)2 coming from the
constant of Proposition 5.4, for a total of (n + 1)248+n/34.
Let bn be the constant in Theorem 5.1 in dimension n. Then we can see from the
induction argument that there are n terms (it may appear to be n + 1, but we may
set λ1 = 1 at the start by scaling the whole matrix, which does not aﬀect the automor-
phism of Pm), each of size 13bn−1c(A)c(B), plus one term coming from Corollary 5.5 of
size 48+n(n + 1)2c(A)c(B)/34, so we obtain:
bn = 13nbn−1 + 48+n
34 (n + 1)2 =
n
X
k=0
13n−kn!
k!
48+k(k + 1)2
34
= n!13n
n
X
k=0
48+k(k + 1)2
3413kk!
⩽(n + 1)2n!13n216
34 e4/13 ⩽(n + 2)!13n216
34 e4/13,
as we wanted to show.
□
Remark 8.2. Being more careful in the numerical arguments would lead to a signiﬁcantly
improved constant (the dominant terms in the sum deﬁning bn are those for small k,
and for such values our bounds could see signiﬁcant improvement, e.g. we could use the
67

constant 1 in Corollary 5.5 for k = 0 instead of 216/34), and some minor adjustments
to the algebraic geometry can lower the base of the exponent 13n, but we do not know
how to improve on the factorial growth, except in characteristic zero where a completely
diﬀerent argument oﬀers exponential growth.
From this statement, it is completely straightforward to make explicit the inequalities
of Section 6, because all the implicit constants in those inequalities come from repeated
applications of Theorem 5.1, which can be replaced with this eﬀective version.
References
1. A. Adolphson and S. Sperber, On the degree of the L-function associated with an exponential sum,
Compositio Math. 68 (1988), no. 2, 125–159.
2. A. Beilinson, Constructible sheaves are holonomic, Selecta Math. (N.S.) 22 (2016), no. 4, 1797–1819.
3. A. A. Be˘ılinson, J. Bernstein, P. Deligne, and O. Gabber, Faisceaux pervers, Analysis and topology
on singular spaces, I (Luminy, 1981), Ast´erisque, vol. 100, Soc. Math. France, Paris, 1982, pp. 5–171.
4. E. Bombieri, On exponential sums in ﬁnite ﬁelds. II, Invent. math. 47 (1978), no. 1, 29–39.
5. T. Br¨ocker and T. tom Dieck, Representations of compact Lie groups, Graduate Texts in Mathemat-
ics, vol. 98, Springer-Verlag, New York, 1995.
6. P. Deligne, Cohomologie ´etale, Lecture Notes in Mathematics, vol. 569, Springer-Verlag, Berlin, 1977,
S´eminaire de g´eom´etrie alg´ebrique du Bois-Marie SGA 4 1
2.
7.
, La conjecture de Weil. II, Publ. math. IHES (1980), no. 52, 137–252.
8.
, Finitude de l’extension de Q engendr´ee par des traces de Frobenius, en caract´eristique ﬁnie,
Mosc. Math. J. 12 (2012), no. 3, 497–514, 668.
9. P. Deligne and Y. Z. Flicker, Counting local systems with principal unipotent local monodromy, Ann.
of Math. 178 (2013), no. 3, 921–982.
10. P. Deligne and N. M. Katz (eds.), Groupes de monodromie en g´eom´etrie alg´ebrique. II, Lecture
Notes in Mathematics, vol. 340, Berlin-New York, Springer-Verlag, 1973, S´eminaire de G´eom´etrie
Alg´ebrique du Bois-Marie 1967–1969 (SGA 7 II).
11. A. Forey, J. Fres´an, and E. Kowalski, Arithmetic Fourier transforms over ﬁnite ﬁelds: generic
vanishing, convolution, and equidistribution, https://arxiv.org/abs/2109.11961.
12. ´E. Fouvry, E. Kowalski, and Ph. Michel, Counting sheaves using spherical codes, Math. Res. Lett.
20 (2013), no. 2, 305–323.
13.
, An inverse theorem for Gowers norms of trace functions over Fp, Math. Proc. Cambridge
Philos. Soc. 155 (2013), no. 2, 277–295.
14.
, Algebraic trace functions over the primes, Duke Math. J. 163 (2014), no. 9, 1683–1736.
15.
, Algebraic twists of modular forms and Hecke orbits, Geom. Funct. Anal. 25 (2015), no. 2,
580–657.
16.
, On the conductor of cohomological transforms, Ann. Fac. Sci. Toulouse Math. (6) 30 (2020),
no. 1, 203–254.
17. J. Fres´an,
´Equir´epartition de sommes exponentielles [travaux de Katz], S´eminaire Bourbaki,
Ast´erisque, vol. 414, Soc. Math. France, Paris, 2019, Exp. no. 1141, pp. 205–250.
18. L. Fu, ´Etale cohomology theory, revised ed., Nankai Tracts in Mathematics, vol. 14, World Scientiﬁc
Publishing Co. Pte. Ltd., Hackensack, NJ, 2015.
19. K. Fujiwara, Independence of ℓfor intersection cohomology (after Gabber), Algebraic geometry 2000,
Azumino (Hotaka), Adv. Stud. Pure Math., vol. 36, Math. Soc. Japan, Tokyo, 2002, pp. 145–151.
20. W. Fulton, Intersection theory, second ed., Ergebnisse der Mathematik und ihrer Grenzgebiete. 3.
Folge., vol. 2, Springer-Verlag, Berlin, 1998.
21. D. Gaitsgory, Construction of central elements in the aﬃne Hecke algebra via nearby cycles, Invent.
math. 144 (2001), no. 2, 253–280.
22. A.
Grothendieck
(ed.),
Revˆetements
´etales
et
groupe
fondamental
(SGA
1),
Documents
Math´ematiques, vol. 3, Soci´et´e Math´ematique de France, Paris, 2003, S´eminaire de g´eom´etrie
alg´ebrique du Bois Marie 1960–61.
23. C. Hall, J. P. Keating, and E. Roditty-Gershon, Variance of arithmetic sums and L-functions in
Fq[t], Algebra Number Theory 13 (2019), no. 1, 19–92.
24. K. Ireland and M. Rosen, A Classical Introduction to Modern Number Theory, 2nd ed., Graduate
Texts in Mathematics, vol. 84, Springer-Verlag, 1990.
68

25. H. Iwaniec and E. Kowalski, Analytic number theory, American Mathematical Society Colloquium
Publications, vol. 53, American Mathematical Society, Providence, RI, 2004.
26. N. M. Katz, Gauss sums, Kloosterman sums, and monodromy groups, Annals of Mathematics Stud-
ies, vol. 116, Princeton University Press, Princeton, NJ, 1988.
27.
, Exponential sums and diﬀerential equations, Annals of Mathematics Studies, vol. 124,
Princeton University Press, Princeton, NJ, 1990. MR 1081536
28.
, Sums of Betti numbers in arbitrary characteristic, Finite Fields Appl. 7 (2001), no. 1, 29–44.
29.
, Moments, monodromy, and perversity: a Diophantine perspective, Annals of Mathematics
Studies, vol. 159, Princeton University Press, Princeton, NJ, 2005.
30.
, Convolution and equidistribution. sato-tate theorems for ﬁnite-ﬁeld mellin transforms, An-
nals of Mathematics Studies, vol. 180, Princeton University Press, Princeton, NJ, 2012.
31. N. M. Katz and P. Sarnak, Random matrices, Frobenius eigenvalues, and monodromy, American
Mathematical Society Colloquium Publications, vol. 45, American Mathematical Society, Providence,
RI, 1999.
32. R. Kiehl and R. Weissauer, Weil conjectures, perverse sheaves and ℓ-adic Fourier transform, Ergeb-
nisse der Mathematik und ihrer Grenzgebiete. 3. Folge., vol. 42, Springer-Verlag, Berlin, 2001.
33. J. Koll´ar, Rational curves on algebraic varieties, Ergebnisse der Mathematik und ihrer Grenzgebiete.
3. Folge., vol. 32, Springer-Verlag, Berlin, 1996.
34. E. Kowalski, Ph. Michel, and W. Sawin, Bilinear forms with Kloosterman sums and applications,
Ann. of Math. 186 (2017), no. 2, 413–500.
35.
, Stratiﬁcation and averaging for exponential sums: bilinear forms with generalized Klooster-
man sums, Ann. Sc. Norm. Super. Pisa Cl. Sci. (5) 21 (2020), 1453–1530.
36. L. Laﬀorgue, Chtoucas de Drinfeld et correspondance de Langlands, Invent. math. 147 (2002), no. 1,
1–241.
37. G. Laumon, Comparaison de caract´eristiques d’Euler-Poincar´e en cohomologie ℓ-adique, C. R. Acad.
Sci. Paris S´er. I Math. 292 (1981), no. 3, 209–212.
38.
, Transformation de Fourier, constantes d’´equations fonctionnelles et conjecture de Weil,
Publ. math. IHES (1987), no. 65, 131–210.
39. T. Saito, The characteristic cycle and the singular support of a constructible sheaf, Invent. math.
207 (2017), no. 2, 597–695.
40.
, Characteristic cycle of the external product of constructible sheaves, manuscripta math. 154
(2017), no. 1-2, 1–12.
41. T. Tao and V. Vu, Additive combinatorics, Cambridge Studies in Advanced Mathematics, vol. 105,
Cambridge University Press, 2006.
42. N. Umezaki, E. Yang, and Y. Zhao, Characteristic class and the ε-factor of an ´etale sheaf, Trans.
Amer. Math. Soc. 373 (2020), no. 10, 6887–6927.
43. W. V. Vasconcelos, Computational methods in commutative algebra and algebraic geometry, Algo-
rithms and Computation in Mathematics, vol. 2, Springer-Verlag, Berlin, 1998.
(W. Sawin) Columbia University, 2990 Broadway, New York, NY, USA 10027
Email address: sawin@math.columbia.edu
(A. Forey) EPFL/SB/TAN, Station 8, CH-1015 Lausanne, Switzerland
Email address: arthur.forey@epfl.ch
(J. Fres´an) CMLS, ´Ecole polytechnique, F-91128 Palaiseau cedex, France
Email address: javier.fresan@polytechnique.edu
(E. Kowalski) D-MATH, ETH Z¨urich, R¨amistrasse 101, CH-8092 Z¨urich, Switzerland
Email address: kowalski@math.ethz.ch
69

