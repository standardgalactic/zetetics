CAN YOU HEAR YOUR LOCATION ON A MANIFOLD?
EMMETT L. WYMAN AND YAKUN XI
In memory of Steve Zelditch
Abstract. We introduce a variation on Kac’s question, “Can one hear the
shape of a drum?” Instead of trying to identify a compact manifold and its
metric via its Laplace–Beltrami spectrum, we ask if it is possible to uniquely
identify a point x on the manifold, up to symmetry, from its pointwise counting
function
Nx(λ) =
X
λj≤λ
|ej(x)|2,
where here ∆gej = −λ2
jej and ej form an orthonormal basis for L2(M). This
problem has a physical interpretation. You are placed at an arbitrary location
in a familiar room with your eyes closed. Can you identify your location in
the room by clapping your hands once and listening to the resulting echos and
reverberations?
The main result of this paper provides an aﬃrmative answer to this question
for a generic class of metrics. We also probe the problem with a variety of
simple examples, highlighting along the way helpful geometric invariants that
can be pulled out of the pointwise counting function Nx.
1. Introduction
Let (M, g) be a compact Riemannian manifold with or without a boundary. We
consider an orthonormal basis of Laplace–Beltrami eigenfunctions ej for j = 1, 2, . . .
satisfying
∆gej = −λ2
jej,
and Dirichlet (or Neumann) boundary condition if ∂M ̸= ∅. The Weyl counting
function
N(λ) = #{j : λj ≤λ}
counts the number of Laplace–Beltrami eigenvalues (with multiplicity) up to some
threshold λ. It is possible to deduce a signiﬁcant amount of geometric information
about M from the counting function. The main term of the Weyl law
N(λ) = (2π)−n(vol M)(vol Bn)λn + O(λn−1)
identiﬁes both the dimension n of M and its volume. The asymptotics of the heat
trace,
Z ∞
−∞
e−tλ2 dN(λ)
reveals these quantities too, but also the measure of the boundary (if there is one)
and the Euler characteristic. The singularities of the wave trace,
Z ∞
−∞
e−itλ dN(λ),
1
arXiv:2304.04659v1  [math.AP]  10 Apr 2023

2
EMMETT L. WYMAN AND YAKUN XI
mark the closed geodesics’ lengths, order, and Maslov indices.
One might ask if these geometric quantities are enough to distinguish one man-
ifold from another via their spectra. Indeed, this is the essence of Kac’s famous
question, “Can one hear the shape of a drum?” [Kac66]. The answer to this question
is complicated and depends very much on the precise setting of the problem.
On the one hand, we now know of a number of examples of pairs of non-isometric
manifolds that are isospectral. Milnor [Mil64] showed that there exists a pair of
16-dimensional ﬂat tori, which have the same Laplace–Beltrami eigenvalues but
diﬀerent shapes. In 1992, Gordon, Webb, and Wolpert [GWW92] constructed a
pair of isospectral concave polygons in the plane with diﬀerent shapes. In fact,
this result settled Kac’s original conjecture, which was formulated in terms of pla-
nar domains. Their method was later generalized by Buser, Conway, Doyle, and
Semmler [BCDS94] to construct numerous similar examples.
On the other hand, there are some situations where one can distinguish a mani-
fold from others in some restricted class. For instance, by the isoperimetric inequal-
ity, one can quickly identify a disk via its Dirichlet (or Neumann) spectrum amongst
other planar regions with smooth boundaries. Nonetheless, it is challenging to prove
any positive result for smooth domains other than the disk. There are several par-
tial positive results [DSKW17,HZ12,PT03,PT12,PT16,Vig21,Zel04,Zel09], which
often require additional assumptions on the class of smooth domains. Very recently,
by applying a local version of the Birkhoﬀconjecture [ADSK16,KS18], Hezari and
Zelditch [HZ22] proved that an ellipse of small eccentricity is spectrally unique
among all domains with smooth boundaries.
We consider a variation on the “can one hear the shape of a drum” problem.
Suppose we know everything there is to know about the manifold M, but now ﬁx
some unknown point x in the interior of M. At our disposal is complete information
about the pointwise Weyl counting function
(1.1)
Nx(λ) =
X
λj≤λ
|ej(x)|2.
Can we deduce the position of x? As before, various transforms of the derivative
dNx(λ) reveal geometric quantities related to M and the location of x within it.
Taking the cosine transform, in particular, reveals a natural physical interpretation
of the problem. Observe:
(1.2)
Z
R
cos(tλ) dNx(λ) =
X
j
cos(tλj)|ej(x)|2 = cos(t
p
−∆g)δx(x).
Here, cos(t
p
−∆g)f is the solution operator to the wave equation
(∂2
t −∆g)u = 0
with
(
u(0) = f
˙u(0) = 0.
Noting that (1.2) and (1.1) determine one another, we can use the rightmost
side of (1.2) to interpret our problem as such: You stand on a manifold, make a
single sharp “snap” sound, and then listen intently to its reverberations. If you
have perfect hearing and perfect knowledge of the shape of the manifold, can you
deduce your location within it?
A symmetric manifold certainly defeats us, so instead, we propose:

CAN YOU HEAR YOUR LOCATION ON A MANIFOLD?
3
Question 1.1. Let M be a compact Riemannian manifold with or without boundary
and ﬁx points x and y in the interior of M for which Nx = Ny identically. Must
there be an isometry on M that maps x to y?
Remark 1.2. To illustrate how this kind of “echolocation” is plausible, consider a
point x in the interior of the unit disk D in R2 whose Laplace operator ∆comes
equipped with Dirichlet boundary conditions.
By the arguments in [Ivr80], the
lengths of billiard trajectories which depart and arrive at x have lengths at singu-
larities t of the distribution
Z ∞
−∞
eitλ dNx(λ) =
X
j
eitλj|ej(x)|2 = eit√
−∆g(x, x).
The ﬁrst positive time t at which eit√−∆(x, x) is singular is 2d(x, ∂D), the length
of the shortest such trajectory. The distance d(x, ∂D) determines x uniquely up to
rotation about the center of D. See Figure 1 for an illustration of “echolocation”
in a general planar domain.
Figure 1. “Echolocation” in a planar domain.
Our main result shows that the answer to Question 1.1 is aﬃrmative for generic
manifolds without boundaries. Recall, a subset of a Baire topological space (e.g.
complete metric space) is said to be residual if it is the complement of a meager
set, or equivalently the countable intersection of open dense subsets.
Theorem 1.3. Let M be a compact smooth manifold without boundary, dim M ≥
2. Then, there exists a residual class of metrics in the C∞topology such that if
Nx = Ny for some x, y ∈M, then x = y.

4
EMMETT L. WYMAN AND YAKUN XI
Remark 1.4. It is not unusual to prove generic statements regarding eigenfunctions
and eigenvalues of the Laplacian on a manifold. For instance, Uhlenbeck [Uhl76]
showed that, generically, the eigenspaces are all simple.
Indeed, this result of
Uhlenbeck further connects our Question 1.1 to the original hearing the shape of a
drum problem. For a manifold with simple eigenspaces, one should be able to hear
all the eigenvalues of the Laplacian from Nx, as long as ej(x) ̸= 0 for all j ≥1, and
hence recover the Weyl counting function N(λ) from Nx for a generic choice of x.
1.1. Structure of the paper. Section 2 houses a number of simple examples of
manifolds on which echolocation is possible. In some of these examples, we use the
pointwise counting function Nx directly. In others, we pull geometric invariants out
of the pointwise counting function and use those.
Sections 3, 4, and 5 are dedicated to the proof of our main result, Theorem
1.3. In Section 3, we develop a somewhat general criterion for showing injections
are generic in the topological sense. In Section 4, we use this criterion to reduce
Theorem 1.3 to the construction of a special set of perturbations of the Riemannian
metric. Section 5 contains the key stationary phase argument needed to complete
the construction.
Finally, we discuss further directions of research in Section 6.
Acknowledgements. Xi was supported by the National Key Research and De-
velopment Program of China No.
2022YFA1007200 and NSF China Grant No.
12171424. Wyman was partially supported by NSF grant DMS-2204397 and by
the AMS-Simons Travel Grants. The authors would like to thank Allan Greenleaf,
Hadmid Hezari, Alex Iosevich, Steven Kleene, Jonathan Pakianathan, Chris Sogge,
Chengbo Wang, and Meng Wang for helpful conversations.
2. Examples and audible quantities
For the sake of precision, we deﬁne an audible quantity to be any function on
M which is measurable with respect to the σ-algebra generated by the functions
x 7→Nx(λ) for each λ ∈R. An audible quantity is then completely determined by
the pointwise counting functions Nx.
Example 2.1 (A string with ﬁxed ends). Our ﬁrst example should be a simple
string M = [0, a] equipped with Dirichlet boundary conditions.
Here, the ﬁrst
eigenfunction reads
e1(x) =
r
2
a sin(πx/a),
and we note that the audible quantity
Nx(π/a) = |e1(x)|2 = 2
a sin2(πx/a)
alone is enough to deduce the location of x up to a reﬂection about the midpoint
of the string.
Example 2.2 (A rectangular plate). We see an immediate jump in complexity—
much of it number-theoretic—when we go up to the two-dimensional plate M =
[0, a] × [0, b] with Dirichlet boundary conditions. We will assume that a and b are

CAN YOU HEAR YOUR LOCATION ON A MANIFOLD?
5
algebraically independent to avoid these troubles. A complete orthonormal basis
of eigenfunctions can be written down as
en,m(x, y) =
2
√
ab
sin(πnx/a) sin(πmy/b),
n, m = 1, 2, . . .
with respective eigenvalues
λn,m = π
r
n2
a2 + m2
b2 .
Since a and b are algebraically independent, each eigenvalue λn,m is realized by
exactly one pair (n, m) ∈N × N. Taking b to be the larger of the two lengths, we
consider the audible quantity
N(x,y)(λ1,2) −N(x,y)(λ1,1)
N(x,y)(λ1,1)
= sin2(πx/a) sin2(2πy/b)
sin2(πx/a) sin2(πy/b) = 2 cos2(πy/b),
which is enough to identify the y-coordinate up to symmetry. To ﬁnd x, we need to
be a bit more careful. Since we know y, pick m such that sin2(πmy/b) > 0. Then,
for ϵ > 0 small enough, we consider one more audible quantity
N(x,y)(λ1,m) −N(x,y)(λ1,m −ϵ) = 4
ab sin2(πx/a) sin2(πmy/b),
which is enough to determine x up to symmetry.
We now try to extract what we can from the heat kernel, though we do not
venture past the ﬁrst two terms. We have for each t > 0
Z ∞
−∞
e−tλ2dNx(λ) =
X
j
e−tλ2
jej(x)ej(x) = et∆g(x, x).
It is well-known (e.g., [HPMS67]) that for manifolds without boundary, the heat
kernel has a local asymptotic expansion
(4πt)n/2et∆g(x, x) = 1 + t
3K(x) + O(t2),
0 < t ≪1,
where K(x) denotes the scalar curvature of M at x. We conclude:
Proposition 2.3. The scalar curvature at x is an audible quantity.
This audible quantity is enough, for example, to show that echolocation is pos-
sible on an ellipsoid of revolution.
Example 2.4 (An ellipsoid of revolution.). Let M be a non-spherical ellipsoid of
revolution, e.g., the surface
x2 + y2 + z2
a2 = 1
in R3 with 0 < a ̸= 1. Recall that the Gaussian curvature of a surface embedded
in R3 coincides with the sectional and also the scalar curvature. It is a routine yet
somewhat tedious calculation to verify the Gaussian curvature of this ellipsoid is
given by
K(x, y, z) =
a2
(z2(1 −a−2) + a2)2 .
This audible quantity is enough to determine the z-coordinate of a point up to sign,
which in turn determines a point up to symmetry.

6
EMMETT L. WYMAN AND YAKUN XI
Next, we extract what we can from the wave equation. We present here a brief
wavefront set calculation that arises in some form or another in most results about
pointwise asymptotics. For examples of this kind of calculation, see [DG75,Sog17,
Sog14, SZ02].
For background on the calculus of wavefront sets and microlocal
analysis, we refer the reader to [Dui96,H¨or71,Sog17].
Recall the identity
Z ∞
−∞
eitλ dNx(λ) = eit√
−∆g(x, x).
We interpret the right side as the distribution in t given by the composition U ◦
(δx⊗δx) where U is an operator with distribution kernel U(t, x, y) = eit√
−∆g(x, y).
By the results in [H¨or94, Chapter 29], the wavefront relation of U is given by
WF′(U) = {(t, p(x, ξ); x, −ξ, Gt(x, ξ)) : t ∈R, (x, ξ) ∈˙T ∗M}
where
p(x, ξ) = |ξ|g(x) =


n
X
i,j=1
gij(x)ξiξj


1
2
is the principal symbol of the Laplace–Beltrami operator and Gt is the time-t
homogeneous geodesic ﬂow on ˙T ∗M. For an introduction to wavefront sets and
their calculus, see [Dui96] and [H¨or71]. The wavefront set of δx⊗δx is, conveniently,
the twofold product of the wavefront set of δx, i.e.
WF(δx ⊗δx) = {(x, ξ, x, η) : ξ, η ∈˙T ∗
xM}.
The composition then satisﬁes
WF(U ◦(δx ⊗δx)) ⊂WF′(U) ◦WF(δx ⊗δx)
= {(t, τ) : τ > 0, ∃ξ, η ∈˙T ∗
xM with Gt(x, ξ) = (x, η)}.
In other words, the t-singular support of eit√
−∆g(x, x) can only occur at times
equal to the length of a looping geodesic, a unit-speed geodesic on M which departs
x and arrives back at x after time t. We will call such times the looping times at x.
Proposition 2.5. The t-singular support of eit√
−∆g(x, x) is audible and contained
in the set of looping times at x.
We remark that in most examples, the looping times set will be completely
determined by the t-singular support of eit√
−∆g(x, x) and hence audible. Only
when speciﬁc well-arranged destructive interference occurs will some looping times
disappear from the t-singular support of eit√
−∆g(x, x).
If M has a smooth boundary and the eigenfunctions satisfy Dirichlet or Von-
Neumann boundary conditions, then Proposition 2.5 still holds, except here we call
the trajectories billiard trajectories, and they reﬂect oﬀof the boundary in the
expected way. Moreover, in certain cases, even partial knowledge of the looping
times at x is enough to determine x up to symmetry. For instance, as we have
shown in Remark 1.2, the shortest looping time at a point x in the circular disk
D equals twice the distance the point is from the boundary, which is enough to
determine x up to rotation.
In this case, echolocation can also be achieved by
examining the ﬁrst eigenfunction directly.

CAN YOU HEAR YOUR LOCATION ON A MANIFOLD?
7
3. Generic injections
Let G be a second countable Baire topological space and X a ﬁnite-dimensional
C1 manifold (always assumed to be Hausdorﬀand second countable).
Given a
closed subset H ⊂G × X, we seek to ﬁnd suﬃcient conditions under which the
image of H through the projection G × X →G is meager.
To see how this can help us show a class of maps is injective, let M be a smooth n-
dimensional compact manifold, let ∆denote the diagonal in M × M, and consider
the case where G = C∞(M, R2n+1), where X = (M × M) \ ∆, and where H =
{(f, x, y) : f(x) = f(y)}. The projection of H onto G is then
{f ∈C∞(M, R2n+1) : f(x) = f(y) for some x ̸= y}.
If we can show this set is meager, then its complement, the set of smooth injective
maps M →R2n+1, is residual in C∞(M, R2n+1). Once we have established our
tools, we will prove generic versions of the Whitney immersion theorem and weak
Whitney embedding theorem for compact manifolds as illustrative examples.
3.1. The main tool.
Deﬁnition 3.1. Take G, X, and H as above. Fix (g0, x0) ∈H and let n be a
positive integer. Let U be some neighborhood of the origin in Rn and let V be a
neighborhood of x0 in X. Suppose:
(1) ρ : U →G is a continuous map with ρ(0) = g0.
(2) π : ρ(U) × V →Rn is a continuous map with π(H) = {0}.
(3) The map Φ : U × V →Rn given by
Φ(s, x) = π(ρ(s), x)
is C1 on U × V .
(4) We have
det dsΦ(0, x0) ̸= 0.
Then, we say the map Φ is an n-dimensional slice across H at (g0, x0).
Theorem 3.2. Let G be a second countable Baire topological space, let X be a
ﬁnite-dimensional C1 manifold, and let H ⊂G × X be a closed subset. If there
exists an n-dimensional slice across H at each (g0, x0) ∈H with n > dim X, then
{g ∈G : (g, x) ∈H for some x ∈X}
is meager in G. If X is compact, then this set is closed and nowhere dense.
Proof. We claim we can cover H by open neighborhoods W × V such that the
projection of H ∩(W × V ) onto G has nowhere dense closure. Since both G and X
are second countable, we may select a countable subcover. Taking the countable
union of these meager sets in G yields another meager set, and the ﬁrst part of the
theorem will have been proved. If X is compact, then the projection of H onto G
is closed, from which the second part of the theorem follows.
To prove the claim, ﬁx (g0, x0) ∈H and ﬁx an open neighborhood W about
g0. By assumption, there exists an n-dimensional slice Φ : U × V →Rn across H
at (g0, x0). After perhaps shrinking U, we ensure the image of ρ : U →G as in
Deﬁnition 3.1 is contained in W.

8
EMMETT L. WYMAN AND YAKUN XI
Using parts (2) and (3) of Deﬁnition 3.1, and after perhaps shrinking both U
and V further, the implicit function theorem allows us to write
Φ−1(0) = {(s(x), x) : x ∈V }
where s(x) is a C1 function of x. By Sard’s theorem, the image of s : V →U
is measure zero in U. If we allow ourselves to shrink V even more, we can take
the closure of the image of s : V →U to be compact.
Pushing this compact
nowhere dense set through ρ : U →W yields a compact nowhere dense subset
of G. Furthermore, this set contains the projection of H ∩(W × V ) onto G by
construction. This concludes the proof of the claim and of the theorem.
□
3.2. Generic immersions and embeddings. We now use the tools above to
prove a generic variant on Whitney’s weak embedding theorem for compact man-
ifolds. The purpose is illustrative. These quick arguments model how we will use
these tools in our main result.
We start by proving a generic version of Whitney’s immersion theorem.
Proposition 3.3 (Generic Whitney immersion for compact manifolds). Let M be a
smooth, compact, ﬁnite-dimensional manifold. Then, the immersions in C∞(M, Rn)
with n > 2 dim M −1 form an open dense set.
Proof. Fix any Riemannian metric on M and let SM denote the unit sphere bundle.
Let
H = {(f, x, v) ∈C∞(M, Rn) × SM : df(x)v = 0}.
We claim we can produce an n-dimensional slice across H at any point, after which
we are done by Theorem 3.2.
Fix (f0, x0, v0). Take π : C∞(M, Rn) × SM →Rn to be given by π(f, x, v) =
df(x)v. Let β ∈C∞(M, R) be a smooth function with β(x0) = 0 and dβ(x0)v0 = 1.
Then, take ρ : Rn →Rn with
ρ(s) = f0 +
n
X
i=1
siβei
and note
Φ(s, x, v) = π(ρ(s), x, v) = df0(x)v +
n
X
i=1
si(dβ(x)v)ei
and hence
Φ(s, x0, v0) = df0(x0)v0 +
n
X
i=1
siei
and
dsΦ(0, x0, v0) = I.
We are done after we restrict to suitable neighborhoods U and V in Rn and SM,
respectively.
□
Proposition 3.4 (Generic weak Whitney embedding for compact manifolds). Let
M be a smooth, compact, ﬁnite-dimensional manifold. Then, the embeddings in
C∞(M, Rn) for n > 2 dim M form an open, dense set.
Proof. We will produce suitable slices across the set
H = {(f, x, y) ∈C∞(M, Rn) × (M × M) \ ∆: f(x) = f(y)}
and show by Theorem 3.2 that the set of injections in C∞(M, Rn) is residual. We
ﬁrst establish π(f, x, y) = f(x) −f(y). Then, we ﬁx (f0, x0, y0) ∈H and let β

CAN YOU HEAR YOUR LOCATION ON A MANIFOLD?
9
be a bump function on M for which β(x0) = 1 and β(y0) = 0. Take ρ : Rn →
C∞(M, Rn) with
ρ(s) = f0 +
n
X
i=1
siβei.
Then,
Φ(s, x, y) = π(ρ(s), x, y) = f0(x) −f0(y) +
n
X
i=1
si(β(x) −β(y))ei
and
Φ(s, x0, y0) = s
and
dsΦ(s, x0, y0) = I.
We are done after selecting appropriate neighborhoods U and V in Rn and M ×
M \ ∆, respectively.
We have just shown that the set of smooth injections in C∞(M, Rn) is residual.
Hence, the set of injective immersions is residual in C∞(M, Rn) by the previous
proposition.
This is precisely the set of embeddings since M is compact.
One
quickly veriﬁes the set of embeddings in C∞(M, Rn) is open, and the proposition
follows.
□
4. Proof of Theorem 1.3
4.1. The audible objects. Before proceeding, we will take a moment to establish
a very clear connection between the solution operator cos(t
p
−∆g) for the wave
equation on (M, g) and the “audible” object
Z ∞
−∞
cos(tλ) dNx(λ) =
X
j
cos(tλj)|ej(x)|2
as a distribution in t. The diﬃculty lies in the distinction between smooth functions
and smooth densities on M. We must be careful in this regard since we will be
varying the metric and hence the natural volume density on M.
We observe that, given smooth initial data f on M, the function
u(t, x) =
X
j
cos(tλj)
Z
M
f(y)ej(y) dVg(y)

ej(x)
solves the initial value problem
∂2
t u −∆gu = 0
with
(
u(0, x) = f(x)
∂tu(0, x) = 0
,
and hence we write
u(t, x) = cos(t
p
−∆g)f(x).
The kernel of the solution operator can then be written in local coordinates as
cos(t
p
−∆g)(x, y) =
X
j
cos(tλj)ej(x)ej(y)|g(y)|1/2.
Restricting to the diagonal and interpreting the result as a distribution in t, we ﬁnd
that
(4.1)
ϕ(g, t, x) :=
X
j
cos(tλj)|ej(x)|2 = |g(x)|−1/2 cos(t
p
−∆g)(x, x)

10
EMMETT L. WYMAN AND YAKUN XI
is the relevant audible quantity. Note the renormalization by the volume element.
We observe that, since Nx is identically 0 on the negative real line and real-valued
otherwise, we may recover Nx from its cosine transform, namely from ϕ(g, t, x).
We conclude:
Proposition 4.1. For ﬁxed metric g and for x, y ∈M, we have Nx ≡Ny if and
only if
ϕ(g, t, x) = ϕ(g, t, y)
for all t ∈R,
where equality is understood in the sense of distributions in t.
Our main tool for establishing genericity of metrics for which Theorem 1.3 holds
is Theorem 3.2.
To this end, we need to understand the partial derivative of
ϕ(g, t, x) with respect to some variation of g.
4.2. A directional derivative formula. Let G denote the set of Riemannian
metrics on a compact manifold M. It is well-known that G is a manifold modeled
on a Fr´echet space (see, e.g., [Bla00, Section 1.1]). In fact since M is compact, G
is separable and hence second countable. Fix a metric g ∈G and a smooth, real-
valued function h on M. We identify h with a vector in TgG to act on C1 functions
by
Dhf(g, x) = d
ds

s=0
f(eshg, x).
Our objective now is to ﬁnd a workable formula for Dhϕ with ϕ as in (4.1). This
requires that we study a slightly diﬀerent object. Fix a smooth function f on M,
which will be speciﬁed later, and take
u(g, t, x) = cos(t
p
−∆g)f(x) =
Z
M
cos(t
p
−∆g)(x, y)f(y) dVg(y),
the solution operator of the wave equation
(4.2)
∂2
t u −∆gu = 0
with
(
u(g, 0, x) = f(x)
∂tu(g, 0, x) = 0
.
We suppose for a moment that u(g, t, x) is suﬃciently diﬀerentiable in all vari-
ables. (We will address this assumption in Lemma 4.3 below.) Applying the direc-
tional derivative to the homogeneous wave equation above, we see Dhu solves the
nonhomogeneous wave equation
(4.3)
∂2
t v −∆gv = [Dh, ∆g]u
with
(
v = 0
∂tv = 0
.
In order to extract useful information about Dhu from this equation, we require
the following identity.
Lemma 4.2.
[Dh, ∆g] = −h∆g +
n
2 −1

∇gh.

CAN YOU HEAR YOUR LOCATION ON A MANIFOLD?
11
Proof. First, we write
∆eshg = |eshg|−1/2 X
i,j
∂i(|eshg|1/2e−shgij∂j)
= e−n
2 sh|g|−1/2 X
i,j
∂i(e( n
2 −1)sh|g|1/2gij∂j)
= e−sh|g|−1/2 X
i,j
∂i(|g|1/2gij∂j) +
n
2 −1

se−sh X
i,j
gij∂ih∂j
= e−sh∆g +
n
2 −1

se−sh∇gh.
It follows that, if f is a smooth function on G × M,
Dh∆gf(g, x) = d
ds

s=0
∆eshgf(eshg, x)
= d
ds

s=0

e−sh∆gf(eshg, x) +
n
2 −1

se−sh(∇gh)f(eshg, x)

= ∆gDhf(g, x) −h∆gf(g, x) +
n
2 −1

(∇gh)f(g, x).
The lemma follows.
□
Lemma 4.2 will be used in many ways. However, its present use comes from the
miraculous fact that [Dh, ∆g] is a second-order diﬀerential operator acting in the
spacial variable only. We use this to exploit the fact that u(g, t, x) is smooth in
the x variable. In particular, the forcing term [Dh, ∆g]u in (4.3) is, for ﬁxed g, a
smooth function of t and x. Hence any solution to (4.3) is also smooth in t and x.
Let us rephrase what we have found so far. We have just shown that u(eshg, t, x),
as a function in (s, t, x), has a distributional derivative ∂su which satisﬁes (4.3),
and hence is also a function which is smooth in t and x. We will show that both u
and its distributional derivative ∂su are continuous functions in s. This will force
u to be a C1 function in s.
Lemma 4.3. u(eshg, t, x) from (4.2) is a C1 function on (s, t, x) ∈R × R × M,
and
∂su(eshg, t, x) = Dhu(g, t, x)
at s = 0
and solves (4.3).
Proof. First, we show that for ﬁxed (t, x), u(eshg, t, x) is continuous in s. It suﬃces
to show, without loss of generality, that u(eshg, t, x) is continuous at s = 0 for each
ﬁxed t and x. For the sake of clarity, we will set w(s, t, x) = u(eshg, t, x) and take
v(s, t, x) = w(s, t, x) −w(0, t, x).
Note that v satisﬁes the nonhomogeneous wave equation
∂2
t v −∆gv = F(s, t, x)
with
(
v(s, 0, x) = 0
∂tv(s, 0, x) = 0.
Here
(4.4)
F(s, t, x) := (∆eshg −∆g)u(s, t, x) = ((e−sh −1)∆g + (n
2 −1)se−sh∇gh)u(s, t, x)

12
EMMETT L. WYMAN AND YAKUN XI
is a smooth function in (t, x). Its C∞semi-norms in (t, x) have limit 0 as s →0.
This is due to the fact that h is ﬁxed, and the (t, x)-derivatives of u are bounded
uniformly in a compact neighborhood of s = 0. We conclude from the standard
regularity estimates (e.g., [Eva10, §7.2, Theorem 6]) and Sobolev embedding that
lims→0 v(s, t, x) = 0, and so u(eshg, t, x) is a continuous function in s.
The only thing left to show is that the distributional derivative ∂su(eshg, t, x) is
continuous in the s variable. The argument is similar. Without loss of generality,
we show that ∂su(eshg, t, x) is continuous at s = 0 for each ﬁxed t and x. We take
v1(s, t, x) = ∂sw(s, t, x) −∂sw(0, t, x).
Now we must show lims→0 v1(s, t, x) = 0. Note, v1 satisﬁes the nonhomogeneous
wave equation
∂2
t v1 −∆gv1 = F1(s, t, x)
with
(
v1(s, 0, x) = 0
∂tv1(s, 0, x) = 0.
Here
F1(s, t, x) : = [Dh, ∆g]w(s, t, x) −[Dh, ∆eshg]w(0, t, x) + (∆eshg −∆g)(∂sw(s, t, x))
= [Dh, ∆g]w(s, t, x) −[Dh, ∆eshg]w(0, t, x)
+

(e−sh −1)∆g +
n
2 −1

se−sh∇gh

(∂sw(s, t, x))
is again a smooth function in (t, x), and has vanishing (t, x)-C∞semi-norms as
s →0. We conclude that lims→0 v = 0, which indicate that ∂su is continuous in
s.
□
By Duhamel’s principle and (4.3), we have
(4.5)
Dhu(g, t, x) =
Z t
0
sin((t −s)
p
−∆g)
p
−∆g
[Dh, ∆g]u(g, s, x) ds
for t > 0. We consider an oﬀ-diagonal version of ϕ,
(4.6)
ψ(g, t, x, y) =
X
j
cos(tλj)ej(x)ej(y) = |g(y)|−1/2 cos(t
p
−∆g)(x, y).
We make a couple of observations:
(1) Since we are free to select a real eigenbasis, we must have ψ(g, t, x, y) =
ψ(g, t, y, x) for all x and y in M.
(2) ϕ(g, t, x) = ψ(g, t, x, x) as distributions in t.
We recognize
Dh(|g(y)|1/2ψ(g, t, x, y))
as the distribution kernel of the solution operator for the nonhomogeneous Cauchy
problem (4.3) above. Again, we must verify that ψ(eshg, t, x, y) is C1. In what
follows, inj(M, g) denotes the injectivity radius of the manifold M with metric g.
Lemma 4.4. For a ﬁxed metric g, ψ(eshg, t, x, y) is C1 at each point in the set
{(s, t, x, y) : 0 < t < inj(M, eshg), deshg(x, y) < t}.

CAN YOU HEAR YOUR LOCATION ON A MANIFOLD?
13
Furthermore for dg(x, y) < t < inj(M, g), we have
Dh(|g(y)|1/2ψ(g, t, x, y))
=
Z t
0
sin((t −s)
p
−∆g)
p
−∆g
[Dh, ∆g] cos(s
p
−∆g)(x, y) ds.
Proof. The lemma follows if we examine the Hadamard’s parametrix of the wave
equation closely. Indeed, by [H¨or94, (17.4.6)”], the main term of the parametrix
satisﬁes the lemma since its dependence on the metric is explicit. The remainder
solves the inhomogeneous wave equation with an increasingly smooth forcing term.
The time and spatial derivatives of the forcing term can be seen to be bounded
uniformly in s. The lemma then follows from Lemma 4.3.
□
It follows by Lemma 4.4 that
Dhψ(g, t, x, y) = −n
2 h(y)ψ(g, t, x, y)
+ |g(y)|−1/2
Z t
0
sin((t −s)
p
−∆g)
p
−∆g
[Dh, ∆g] cos(s
p
−∆g)(x, y) ds.
Recalling ϕ(g, t, x) = ψ(g, t, x, x), we obtain
(4.7)
Dhϕ(g, t, x) = −n
2 h(x)ϕ(g, t, x)
+ |g(x)|−1/2
Z t
0
sin((t −s)
p
−∆g)
p
−∆g
(x, z)[Dh, ∆g] cos(s
p
−∆g)(z, x) dz ds,
where [Dh, ∆g] acts in the ﬁrst variable.
By Lemma 4.2, [Dh, ∆g] is supported on supp h. The next proposition describes
the support of Dhϕ in x and t.
Proposition 4.5. For ﬁxed g, then as a distribution in x and t,
supp Dhϕ ⊂{(t, x) : 2dg(x, supp h) ≤|t|}.
Proof. We assume t > 0. The proposition is proved for negative times in a similar
way. By Huygens’ principle and that supp [Dh, ∆g] ⊂supp h, we have
[Dh, ∆g] cos(s
p
−∆g)(z, y)
is supported for dg(z, y) ≤|s| with z ∈supp h. Also by Huygens’ principle,
sin((t −s)
p
−∆g)
p
−∆g
(x, z)
is supported for dg(x, z) ≤|t −s|. Hence,
Z t
0
sin((t −s)
p
−∆g)
p
−∆g
[Dh, ∆g] cos(s
p
−∆g)(x, y) ds
is supported for (x, y) for which there exists z ∈supp h and s ∈[0, t] with dg(x, z) ≤
t −s and dg(z, y) ≤s. If x = y, this condition reads as
dg(x, z) ≤min(t −s, s)
for some s in [0, t].
The proposition follows after maximizing the right side by taking s = t/2.
□

14
EMMETT L. WYMAN AND YAKUN XI
The proof of the proposition has a nice physical interpretation.
Suppose we
make a small conformal perturbation of the metric g along eshg. The quantity
Dhϕ(g, t, x) tells us the degree to which we can “hear” the perturbation if we stand
at x, clap our hands at time 0, and listen to the reverberation at time t. In order to
“hear” the change in the metric, the sound must travel from x to the region supp h
at which the metric was perturbed, and then it will have to travel back to x.
In order to use the tools in Section 3, we will need to construct nice perturbations
h which satisfy some desirable properties. The following lemma does precisely this.
Its proof is rather involved and so deferred to Section 5.
Lemma 4.6. Suppose dim M = n ≥2.
Fix x ∈M and t > 0 less than the
injectivity radius of (M, g).
There exists a smooth function h supported in the
annulus

z ∈M : t
3 < dg(x, z) < 2t
3

for which
Dhϕ(g, t, x) ̸= 0.
A standard wavefront set calculation tells us the wavefront set of Dhϕ(g, t, x), as
a distribution in t, is supported for |t| outside the injectivity radius of (M, g). Hence,
Dhϕ(g, t, x) is smooth for |t| less than the injectivity radius, and the conclusion of
the lemma makes sense.
With all our tools in hand, we are ready to prove Theorem 1.3.
4.3. Proof of Theorem 1.3. We may express G as the countable union
G =
∞
[
j=0
Gj
where Gj is the set of those metrics whose injectivity radius is larger than 2−j. It
suﬃces then to show Theorem 1.3 holds for Gj for each j, which follows from the
case j = 0 by rescaling.
Let ∆denote the diagonal in M × M, and let H denote the set of all triples
(g, x, y) ∈G0 × (M × M \ ∆) for which the counting functions Nx and Ny are
identical. If we can satisfy the hypotheses of Theorem 3.2, it yields a residual set
of metrics in G0, for which
Nx ̸= Ny whenever x ̸= y for each x, y ∈M,
as desired. So, we must construct (2n+1)-dimensional slices across H at each point
in (g0, x0, y0) ∈G0 × M × M, x0 ̸= y0.
Take a sequence of times t0, t1, . . . such that, for all (g, x, y) in a neighborhood
of (g0, x0, y0),
t0 < 1
2 min(dg(x, y), 1)
and
tk = 1
2tk−1 for k = 1, 2, . . ..
Then, take π in Deﬁnition 3.1 to be the map from this neighborhood to R2n+1 given
by
π(g, x, y) =


ϕ(g, t0, x) −ϕ(g, t0, y)
...
ϕ(g, t2n, x) −ϕ(g, t2n, y)

.
Note, (g, x, y) ∈H implies π(g, x, y) = 0 by Proposition 4.1.

CAN YOU HEAR YOUR LOCATION ON A MANIFOLD?
15
We construct ρ of Deﬁnition 3.1 by taking smooth functions h0, . . . , h2n on M
and setting
ρ(s) = es·hg0,
where here we have written
s · h = s0h0 + · + s2nh2n
as shorthand. Shrinking the domain of ρ as necessary to a small enough neighbor-
hood of the origin, we set
Φ(s, x, y) = π(ρ(s), x, y) =


ϕ(es·hg0, t0, x) −ϕ(es·hg0, t0, y)
...
ϕ(es·hg0, t2n, x) −ϕ(es·hg0, t2n, y)

.
Lemma 4.4 guarantees Φ is C1.
Finally, to verify Φ is a slice, we must select
h0, . . . , h2n cleverly enough so that
dsΦ(g0, x0, y0) =
Dhjϕ(g0, tk, x0) −Dhjϕ(g0, tk, y0)2n
k,j=0
is nonsingular. Lemma 4.6 allows us to select 2n+1 smooth functions h0, h1, . . . , h2n
for which
Dhkϕ(g, 2−k, x) = 1
and
supp hk ⊂

z ∈M : 1
32−k < dg(x, z) < 2
32−k

.
By construction and Proposition 4.5, we also have
Dhkϕ(g, 2−k, y) = 0
for k ∈{k0, . . . , k0 + 2n}.
Hence,
dsΦ(g0, x0, y0) =


1
∗
∗
· · ·
∗
0
1
∗
· · ·
∗
0
0
1
· · ·
∗
...
...
...
...
...
0
0
0
· · ·
1


,
which is nonsingular as desired.
To summarize, we have produced a (2n + 1)-dimensional slice across H at each
point {(g0, x0, y0) ∈G0 × M × M : x0 ̸= y0}. Theorem 3.2 then yields a residual
class of metrics in G0 for which Nx = Ny only when x = y. Theorem 1.3 follows.
5. Proof of Lemma 4.6
At ﬁrst glance, it seems absurd that the conclusion of Lemma 4.6 could possibly
fail to hold. We have the freedom to take any perturbation we like from the inﬁnite-
dimensional space of options we have for h as long as it has the required support,
and so surely we can hear at least one of these perturbations at x, if not most.
However, when we consider the n = 1 case, we run into a conceptual obstruction.
There are no local geometric invariants on a one-dimensional Riemannian manifold,
and in particular, we expect no perturbation to be audible for small times. This
means that, at least when n = 1, there is a complete cancellation between the
contribution of the two terms of [Dh, ∆g], which forces Dhϕ(g, t, x) = 0. We must
show that this can be avoided for n ≥2. This is consistent with the fact that sharp
Huygens’ principle always holds in dimension one, but gets more complicated in
higher dimensions. See, e.g., [G¨un88].

16
EMMETT L. WYMAN AND YAKUN XI
To this end, we will choose a convenient perturbation h and then carefully es-
timate Dhϕ(g, t, x) to ensure it is nonzero. For this, we select h to be a rapidly
oscillating function with the desired support. In eﬀect, this allows us to use oscil-
latory testing to extract main- and remainder-term asymptotics for Dhϕ(g, t, x) as
the frequency of h tends to inﬁnity.
The main result of this section is:
Lemma 5.1. Fix geodesic normal coordinates (z1, . . . , zn) ∈Rn about x, and take
h(z) = a(z) cos(λz1 + θ)
where θ ∈R and a is a smooth function supported in {z : |z −t/2| < t/6} with
a(t/2, 0, . . . , 0) = 1. Then,
Dhϕ(g, t, x) = (2π)−n−1
2 n −1
16 λ
n+1
2 t−n−1
2
cos(π(n −3)/4 + t/2 + θ) + O(λ
n−1
2 )
as λ →∞.
To see how Lemma 4.6 follows, we ﬁrst take θ = −π(n −3)/4 −t/2 to ensure
the main term is nonzero. Then, we ensure the left side is nonzero by selecting a
large enough λ so that the main term is strictly greater than the remainder.
5.1. A quick rephrasing. As an operator taking functions to functions (rather
than densities to functions, half-densities to half-densities, etc.), the kernel of the
sine wave operator satisﬁes
sin(r
p
−∆g)
p
−∆g
(x, z) = sin(r
p
−∆g)
p
−∆g
(z, x)|g(z)|1/2|g(x)|−1/2.
Hence by (4.7),
Dhϕ(g, t, x) = |g(x)|−1
Z t
0
Z
M
sin((t −s)
p
−∆g)
p
−∆g
(z, x)
· [Dh, ∆g] cos(s
p
−∆g)(z, x)|g(z)|1/2 dz ds,
where here [Dh, ∆g] acts in the z variable of cos(s
p
−∆g)(z, x). Using geodesic
normal coordinates z = (z1, . . . , zn) about x = (0, . . . , 0) as in the statement of the
lemma, we obtain
Dhϕ(g, t, x) =
Z t
0
Z
Rn
sin((t −s)
p
−∆g)
p
−∆g
(z, 0)
· [Dh, ∆g] cos(s
p
−∆g)(z, 0)|g(z)|1/2 dz ds.
At this point, it will be convenient to introduce some shorthand. We let
S(s, z) := sin(s
p
−∆g)
p
−∆g
(z, 0)
and
C(s, z) := cos(s
p
−∆g)(z, 0).

CAN YOU HEAR YOUR LOCATION ON A MANIFOLD?
17
We consider the contribution of the second term of [Dh, ∆g] in Lemma 4.2. In
particular, by a distributional integration by parts, we have
n
2 −1
 Z
Rn S(t −s, z)∇gh(z) · ∇gC(s, z)|g(z)|1/2 dz
= −
n
2 −1
 Z
Rn h(z)∇gS(t −s, z) · ∇gC(s, z)|g(z)|1/2 dz
−
n
2 −1
 Z
Rn h(z)S(t −s, z) · ∆gC(s, z)|g(z)|1/2 dz.
Hence in total,
Dhϕ(g, t, x) =
−
Z
Rn
Z t
0
n
2 S(t −s, z)∆gC(s, z) +
n
2 −1

∇gS(t −s, z) · ∇gC(s, z) ds

· h(z)|g(z)|1/2 dz ds
We recall
h(z) = a(z) cos(λz1 + θ) = Re

a(z)e−i(λz1+θ)
and note that, since both the left side and the integral in parentheses are real-valued,
we may write
Dhϕ(g, t, x) = Re(e−iθbu(0, λe1))
where u is the distribution on R1+n given by
u(s, z) = −a(z)|g(z)|1/21[0,t](s)
·
n
2 S(t −s, z)∆gC(s, z) +
n
2 −1

∇gS(t −s, z) · ∇gC(s, z)

and bu denotes the Fourier transform on R1+n.
We have an opportunity now to smooth out the indicator function 1[0,t]. To do
this, consider a smooth cutoﬀγ with γ(s) = 1 for |s −t/2| ≤t/6 and γ(s) = 0 for
|s −t/2| ≥t/4. We claim that (1 −γ(s))u(s, z) is smooth in both variables, and
hence
bu(0, λe1) = c
γu(0, λe1) + O(λ−∞).
To see this, we only need to note that S(t −s, z) is smooth for |t −s| ̸= |z| and
C(s, z) is smooth for |s| ̸= |z|. Now if (s, z) is in the support of (1 −γ(s))u(s, z),
then
(1) |s −t/2| ≥t/6, and
(2) z ∈supp a, and hence |z −t
2e1| < t/6, and hence ||z| −t/2| < t/6.
Hence, if (s, z) lies in the support of (1 −γ(s))a(z) and 0 ≤s ≤t, then (1 −
γ(s))u(s, t) is smooth on a neighborhood of (s, z).
We now set
v(s, z) = γ(s)u(s, z) = −a(z)|g(z)|1/2γ(s)
·
n
2 S(t −s, z)∆gC(s, z) +
n
2 −1

∇gS(t −s, z) · ∇gC(s, z)

and note
(5.1)
Dhϕ(g, t, x) = Re(e−iθbv(0, λe1)) + O(λ−∞).

18
EMMETT L. WYMAN AND YAKUN XI
5.2. Hadamard’s parametrix. A symbol of order m on Rn × RN is a smooth
function a on Rn × RN satisfying bounds
|∂β
θ ∂α
x a(x, θ)| ≤Cα,β(1 + |θ|)m−|β|
for multiindices α and β (see e.g. [Sog17, Sog14, Dui96, H¨or85]). The set of such
symbols is denoted Sm(Rn×RN). We typically consider x ∈Rn the spatial variables
and θ ∈RN the frequency variables.
Hadamard’s parametrix allows us to write the distribution kernels of the sine and
cosine wave operators as oscillatory integrals. We will rephrase the characterization
of Hadamard’s parametrix as it appears in [Sog14, Chapter 2].
First, consider
z = (z1, . . . , zn) in geodesic normal coordinates about x as in Lemma 5.1. Then,
there exist symbols b±(s, z, ξ) in S0(R1+n × Rn) with
b±(s, z, ξ) −1
2 ∈S−2(R1+n × Rn)
and
(5.2)
C(s, z) = (2π)−n|g(z)|−1/4 X
±
Z
Rn ei(⟨z,ξ⟩±s|ξ|)b±(s, z, ξ) dξ + R1(s, z)
where R1 is a smooth discrepancy. Furthermore, at the expense of absorbing a
smooth error into R1, we may take b to be supported for |ξ| ≥1. Similarly, there
exist symbols c±(s, z, ξ) of order −1 with
c±(s, z, ξ) −
1
±2i|ξ| ∈S−3(R1+n × Rn)
and support in |ξ| ≥1 such that
(5.3)
S(s, z) = (2π)−n|g(z)|−1/4 X
±
Z
Rn ei(⟨z,ξ⟩±s|ξ|)c±(s, z, ξ) dξ + R2(s, z),
where R2 is again a smooth discrepancy.
5.3. Reduction to an oscillatory integral. To make our task easier, we start
by breaking v into two terms,
v = v1 + v2
where
v1(s, z) = −a(z)|g(z)|1/2γ(s)n
2 S(t −s, z)∆gC(s, z)
and
v2(s, z) = −a(z)|g(z)|1/2γ(s)
n
2 −1

∇gS(t −s, z) · ∇gC(s, z).
We ﬁrst examine v1. Note,
∆gC(s, z) = ∂2
sC(s, z)
= (2π)−n|g(z)|−1/4 X
±
Z
Rn ei(⟨z,ξ⟩±s|ξ|)(−|ξ|2)b±(s, z, ξ) dξ + ∂2
sR1(s, z)
where in the second line the lower-order parts of the symbol b± have changed. One
quickly sees this by showing
e−i(⟨z,ξ⟩±s|ξ|)∂2
s

ei(⟨z,ξ⟩±s|ξ|)b±(s, z, ξ)

+ |ξ|2b±(s, z, ξ) ∈S1(R1+n × Rn).

CAN YOU HEAR YOUR LOCATION ON A MANIFOLD?
19
Then,
v1(s, z)
= (2π)−2n n
2
X
±,±′
ZZ
ei(⟨z,η+ξ⟩±′(t−s)|η|±s|ξ|)γ(s)a(z)c±′(t−s, z, η)b±(s, z, ξ)|ξ|2 dη dξ
−(2π)−n n
2 |g(z)|1/4 X
±′
Z
ei(⟨z,η⟩±′(t−s)|η|)γ(s)a(z)c±′(t −s, z, η)∂2
sR1(s, z) dη
+ (2π)−n n
2 |g(z)|1/4 X
±
Z
ei(⟨z,ξ⟩±s|ξ|)|ξ|2γ(s)a(z)b±(s, z, η)R2(t −s, z) dξ
−n
2 a(z)|g(z)|1/2γ(s)R2(t −s, z)∂2
sR1(s, z),
where b± and c±′ are as they appear in (5.2) and (5.3) except perhaps up to lower-
order symbols. Now, the fourth term on the right is smooth in all variables, so it
contributes a negligible term to bv(0, λe1). We can see that the second and third
terms also yield a rapidly-vanishing contribution by multiplying by integrating in
s, and then using integration by parts in s to obtain an arbitrarily smooth function
of z. Hence, we are left with having to contend with the ﬁrst term.
We may repeat the process for v2, except we ﬁx indices i, j ∈{1, . . . , n} and
replace S with ∂ziS and ∆gC with ∂zjC. Tracing through the steps above, we
obtain a main term of
n
2 −1
 X
i,j
gij(z)
X
i,j
X
±,±′
ZZ
ei(⟨z,η+ξ⟩±′(t−s)|η|±s|ξ|)
· a(z)c±′(t −s, z, η)b±(s, z, ξ)ηiξj dη dξ
Combining the main terms of v1 and v2 and taking a Fourier transform yields:
Lemma 5.2. We have
bv(0, λe1) = (2π)−2n X
±,±′
ZZZZ
ei(⟨z,η+ξ−λe1⟩±′(t−s)|η|±s|ξ|)
·
n
2 |ξ|2 +
n
2 −1

⟨η, ξ⟩g(z)

γ(s)a(z)c±′(t −s, z, η)b±(s, z, ξ) ds dz dξ dη
+ O(λ−∞)
where b± and c±′ are as they appear in (5.2) and (5.3), respectively, up to addition
by a lower-order symbol.
5.4. Preparation for the method of stationary phase. We perform a change
of variables (η, ξ) 7→(λη, λξ) in the integral in the above lemma and obtain an
oscillatory integral
(2π)−2nλ2n X
±,±′
ZZZZ
eiλφ±,±′(s,z,η,ξ)α±,±′(s, z, λη, λξ) dξ dη dz ds
with phase function
φ±,±′(s, z, η, ξ) = ⟨z, η + ξ −e1⟩±′ (t −s)|η| ± s|ξ|

20
EMMETT L. WYMAN AND YAKUN XI
and where α±,±′ ∈S1(R1+n × R2n) with
(5.4)
α±,±′(s, z, η, ξ)
=
n
2 |ξ|2 +
n
2 −1

⟨η, ξ⟩g(z)

γ(s)a(z)c±′(t −s, z, η)b±(s, z, ξ).
We now make some cuts.
First, we let β be a smooth function with β(ξ) = 1 for |ξ| ≤1/8 and β(ξ) = 0
for |ξ| ≥1/4. We cut the integral into β(ξ)β(η) and 1 −β(ξ)β(η) parts. For the
former part, we integrate by parts in z with the operator
L =
η + ξ −e1
iλ|η + ξ −e1|2 · ∇z
plenty of times to obtain something which vanishes to arbitrary order as λ →∞.
We are then left with the latter part. We now have an amplitude supported in the
set where |ξ| ≥1/8 or |η| ≥1/8. To save our notation from becoming cluttered, we
will simply absorb the 1 −β(ξ)β(η) into the amplitude α±,±′ and free up the letter
β to be some other cutoﬀ.
Next, we argue that we obtain rapid decay for the terms where the signs ± and
±′ disagree. We integrate by parts in s with the operator
L =
1
iλ(|ξ| + |η|)∂s.
Note that the denominator of the operator is bounded away from 0 since |ξ| and |η|
cannot both be small (less than 1/8) simultaneously on the support of the integrand.
Doing so plenty of times yields an L1 integrand and plenty of decay in λ. Hence
from here on out, we will only consider the case ±′ = ±.
Next, we exclude a neighborhood of the axes ξ = 0 or η = 0.
For this, let
β(η) = 1 for |η| ≤1/20 and β(η) = 0 for |η| ≥1/10. We cut the integrand into
β(η) and 1−β(η) parts. On the support former part, we necessarily have |ξ| ≥1/8,
and hence ||ξ| −|η|| ≥1/40. Integrating by parts plenty of times using operator
L =
1
iλ||ξ| −|η||∂s
then yields an amplitude which is compactly-supported in η and L1 in ξ, and
also as much decay in λ as desired. Hence, we are left with the 1 −β(η) part of
the integral.
We repeat the argument similarly to ensure the amplitude is also
supported for |ξ| ≥1/20.
Next, we eliminate the term ± = ±′ = +. This is done by noting that the phase
function has no critical points on the support of the amplitude and integrating by
parts with the operator
L =
1
iλ|∇φ|2 ∇φ · ∇
where the gradients are in all four variables s, z, ξ, and η. It suﬃces to consider the
one term with ± = ±′ = −.
Finally, we compactify the support of the amplitude. In particular, take β(ξ, η) =
1 for |ξ| ≤1 and |η| ≤1 and β(ξ, η) = 0 for |ξ| ≥2 or |η| ≥2. We make one last
cut into β(ξ, η) and 1 −β(ξ, η) parts and claim the latter is negligible. Note that if
(s, z, ξ, η) is a critical point of the phase function, we necessarily have
|ξ| = |η|,
η + ξ = e1,
and
z = sξ/|ξ| = (t −s)η/|η|,

CAN YOU HEAR YOUR LOCATION ON A MANIFOLD?
21
which has a unique critical point at
(s, z, η, ξ) =
 t
2, t
2e1, 1
2e1, 1
2e1

,
which is certainly not included in the support of this cut of the amplitude. We then
integrate by parts using the same operator as above.
Before recording our progress, we make one ﬁnal observation. From (5.4), we
have
α−,−(s, z, λη, λξ)
= λ2 n
2 |ξ|2 +
n
2 −1

⟨η, ξ⟩g(z)

γ(s)a(z)c−(t −s, z, λη)b−(s, z, λξ).
Since we are in geodesic normal coordinates, we have
g(z) =

1
0
0
∗

at z = t
2e1,
and hence
⟨η, ξ⟩g(z) = η1ξ1
at z = t
2e1.
It follows that at the critical point,
α−,−
 t
2, t
2e1, λ1
2e1, λ1
2e1

= i
8(n −1)λ + O(1).
To summarize, we have shown:
Lemma 5.3. The integral in Lemma 5.2 is equal to
(2π)−2nλ2n
ZZZZ
eiλφ(s,z,η,ξ)α(λ; s, z, η, ξ) dz dξ dη ds + O(λ−∞)
with phase function
φ(s, z, η, ξ) = ⟨z, η + ξ −e1⟩−(t −s)|η| −s|ξ|
and where the amplitude α is a symbol of order 1 in λ with
α

λ; t
2, t
2e1, 1
2e1, 1
2e1

= i
8(n −1)λ + O(1),
and with support on (s, z, η, ξ) satisfying

t
2 −s
 ≤t
6,
z −t
2e1
 ≤t
6,
1
20 ≤|ξ| ≤2,
and
1
20 ≤|η| ≤2.
5.5. The application of stationary phase. Finally, we apply the method of
stationary phase to obtain asymptotics for the expression in Lemma 5.3. At the
unique critical point, the Hessian of the phase function reads as
∇2φ =


0
0
et
1
−et
1
0
0
I
I
e1
I
t(e1et
1 −I)
0
−e1
I
0
t(e1et
1 −I)

.
We compute the determinant and signature of the matrix by using some row and
column operations. By taking the (2n + 2)-th row and moving it up to occupy row

22
EMMETT L. WYMAN AND YAKUN XI
n + 2, and similarly for the columns, we ﬁnd the Hessian matrix above is conjugate
to


1
−1
1
1
In−1
In−1
1
1
−1
1
In−1
−tIn−1
In−1
−tIn−1


.
After further conjugating by elementary determinant-1 row operations, we obtain


−1
1
1
1
In−1
−1
1
1
1
In−1
−tIn−1


from which it is relatively straightforward to ﬁnd both the determinant and the
signature σ. In particular, we have
| det ∇2φ| = 4tn−1
and
σ = −n + 1.
We use the method of stationary phase (e.g. [H¨or90, Theorem 7.7.5] or [Dui96,
Proposition 1.2.4]) in all 3n + 1 variables to obtain
bv(0, λe1) = (2π)−n−1
2
1
16λ
n+1
2 t−n−1
2 e−i( π
4 (n−3)+ t
2) + O(λ
n−1
2 ).
(The t/2 in the exponential is due to the phase function taking the value −t/2 at
the critical point.) At last, we obtain Lemma 5.1 after feeding this asymptotics
into (5.1).
6. Further directions
The purpose of this paper is to introduce the echolocation question (Question
1.1) and to resolve it generically. Speciﬁc special cases should be addressed next.
6.1. Speciﬁc examples. The examples provided in Section 2 are only the very
start of an exploration of Question 1.1. We list a few more here which we believe
are tractable.
The ﬁrst is the example of the rectangle with Dirichlet boundary conditions,
which was explored in the one- and two-dimensional cases in Section 2, and in the
two-dimensional case, we assume the side lengths are algebraically independent.
What happens when there are eigenspaces of higher multiplicity, and what happens
in higher dimensions?
There are other obvious choices of Euclidean domains that should be explored,
such as ellipses and triangles, both with Dirichlet (or Neumann) boundary condi-
tions.
Another interesting example to study is a Zoll manifold. The paper of Zelditch
[Zel97] provides ﬁne estimates of the local (pointwise) Weyl counting function Nx(λ)
(1.1). It would be interesting to see if these estimates can be used to establish

CAN YOU HEAR YOUR LOCATION ON A MANIFOLD?
23
“echolocation” on such a manifold. We plan to work on this problem in the near
future.
6.2. Hearing the shape of a submanifold through its Kuznecov sum. Let
H be a compact boundaryless smooth connected submanifold embedded in M.
Consider the Kuznecov sum
(6.1)
NH(λ) =
X
λj≤λ

Z
H
ej(x) dVH(x)

2
.
The local Weyl counting function Nx(λ) (1.1) can be seen as a special case of
(6.1) when H is a single point {x}. General Weyl-type asymptotics for (6.1) were
established by Zelditch [Zel92].
Similar to the Weyl counting function, one can also “hear” the volume of H
by looking at the top term of the Kuznecov sum. Furthermore, a recent work of
the authors [WX23] shows that one can obtain a signiﬁcant amount of geometric
knowledge of H from just the ﬁrst two terms of (6.1). It is then natural to ask the
following question.
Question 6.1 (Hearing the shape of a submanifold). Can one determine the em-
bedding H ,→M up to isometry, given the complete knowledge of M and the sum
(6.1)?
Question 6.1 is more complicated than Question 1.1. To determine the embed-
ding, one needs to determine both the shape and the location of H in M. Even
though we do not have a deﬁnite answer to this question, we believe that, at the
very least, some special kind of submanifolds could be uniquely determined by their
Kuznecov sum (6.1).
There is a natural Euclidean counterpart to this question. Suppose that S is
a smooth compact manifold embedded in Rd. Let dσ be the induced Lebesgue
measure on S. Consider the quantity
(6.2)
NS(λ) =
Z
|ξ|≤λ
|c
dσ|2(ξ) dξ.
Question 6.2 (Euclidean version). Can one determine the shape of S given the
complete knowledge of (6.2)?
To further expand on Question 6.1, we may also consider the case when H is
disconnected. The simplest such case is when H is the set of two distinct points
{x, y} on M. Then the corresponding Kuznecov sum is
(6.3)
Nx,y(λ) =
X
λj≤λ
|ej(x) + ej(y)|2.
Question 6.3 (Simultaneous echolocation). Can one determine the locations of
both x and y up to isometry, given the complete knowledge of M and the sum
(6.3)?
We wish to address all three questions in future works.

24
EMMETT L. WYMAN AND YAKUN XI
6.3. Echolocation on graphs. It is known that there are many examples of
cospectral graphs (see, e.g., [BG10]). These are diﬀerent graphs that have the same
multiset of Laplacian eigenvalues. It is interesting to know whether “echolocation”
can hold on a given graph. More precisely, let G be a graph with n nodes {vi}n−1
i=0
and Laplacian matrix L. Suppose that L has eigenvalues 0 = λ0 ≤λ1 ≤· · · ≤λn−1
and a corresponding orthonormal eigenbasis {ej}n−1
j=0 . Consider
(6.4)
Nvi(λ) =
X
λj≤λ
|eji|2.
Question 6.4 (Echolocation on graphs). Can one determine a vertex up to auto-
morphism, given the complete knowledge of the graph G and the sum (6.4) at the
vertex?
6.4. Echolocation with incomplete knowledge. As discussed in remark 1.4, for
certain generic cases, it is possible to hear the Weyl counting function at a single
point on the manifold. Thus, in some special cases, one should be able to hear the
shape of the manifold and simultaneously infer one’s location on the manifold.
To illustrate this, consider a string M = [0, a] with Dirichlet boundary condi-
tions. In section 2, we showed that “echolocation” holds on M. The ﬁrst eigen-
function on M is of the form
e1(x) =
r
2
a sin(πx/a).
Then for any x ∈(0, π), e1(x) ̸= 0. So one can recover the ﬁrst non-zero eigenvalue
λ1 = π/a from Nx(λ) at any x in the interior of the string. The length of the string
is then determined by a = π/λ1. It would be interesting to ﬁnd more examples like
this.
For a general manifold, it seems diﬃcult to determine its shape from Nx(λ) at a
point x alone. Nevertheless, animals in the real world with functioning echolocation
systems usually do not know the geometry of their environment in advance. They
often have two ears with which they can perceive not only the volume and frequency
of echoes but also the directions from which the echoes come. It is a somewhat
vague but exciting question whether one can hear the shape of a manifold and
one’s location in it at the same time if one can hear the directional vectors of all
the echoes in addition to Nx(λ).
6.5. Echolocation with ﬁnitely many audible quantities. In the proof of
Theorem 1.3, we need to use inﬁnitely many audible quantities, namely ϕ(g, tk, x)
deﬁned in (4.1) for k = 0, 1, 2, . . .. We show that for a generic class of smooth
metrics, there is an injective map M →RN whose coordinates are all audible
quantities. This may be more information than needed, so we can ask a stronger
version of Question 1.1.
Question 6.5. Let M be a compact Riemannian manifold with or without bound-
ary and let Isom(M)\M denote the quotient of M by the action of its isometry
group Isom(M). What is the smallest integer k such that there exist smooth audible
quantities ϕ1, . . . , ϕk for which the map
x 7→(ϕ1(x), . . . , ϕk(x))
induces a continuous embedding Isom(M)\M →Rk?

CAN YOU HEAR YOUR LOCATION ON A MANIFOLD?
25
In analogy with the numerology of other generic embedding results, such as the
weak Whitney embedding theorem and Takens’ theorem [Tak81], it is reasonable
to expect k ≤2 dim M + 1 for a generic class of metrics. We hope to prove this in
the sequel.
References
[ADSK16]
Artur Avila, Jacopo De Simoi, and Vadim Kaloshin. An integrable deformation of an
ellipse of small eccentricity is an ellipse. Annals of Mathematics, pages 527–558, 2016.
[BCDS94]
Peter Buser, John Conway, Peter Doyle, and Klaus-Dieter Semmler. Some planar
isospectral domains. International Mathematics Research Notices, 1994(9):391–400,
1994.
[BG10]
Steve Butler and Jason Grout. A construction of cospectral graphs for the normalized
laplacian. arXiv preprint arXiv:1008.3646, 2010.
[Bla00]
David E Blair. Spaces of metrics and curvature functionals. In Handbook of diﬀerential
geometry, volume 1, pages 153–185. Elsevier, 2000.
[DG75]
J. J. Duistermaat and V. W. Guillemin. The spectrum of positive elliptic operators
and periodic bicharacteristics. Invent. Math., 29(1):39–79, 1975.
[DSKW17] Jacopo De Simoi, Vadim Kaloshin, and Qiaoling Wei. Dynamical spectral rigidity
among z2-symmetric strictly convex domains close to a circle. Ann. of Math.(2),
186(1):277–314, 2017.
[Dui96]
J. J. Duistermaat. Fourier Integral Operators. Birkh¨auser Boston, 1996.
[Eva10]
Lawrence C. Evans. Partial diﬀerential equations, volume 19 of Graduate Studies in
Mathematics. American Mathematical Society, Providence, RI, second edition, 2010.
[G¨un88]
Paul G¨unther. Huygens’ principle and hyperbolic equations. Boston, MA etc.: Aca-
demic Press, Inc., 1988.
[GWW92]
Carolyn Gordon, David Webb, and Scott Wolpert. Isospectral plane domains and
surfaces via riemannian orbifolds. Inventiones mathematicae, 110(1):1–22, 1992.
[H¨or71]
Lars H¨ormander. Fourier integral operators. I. Acta Math., 127:79–183, 1971.
[H¨or85]
L. H¨ormander. The analysis of linear partial diﬀerential operators. III, volume 274 of
Grundlehren der Mathematischen Wissenschaften [Fundamental Principles of Math-
ematical Sciences]. Springer-Verlag, Berlin, 1985. Pseudodiﬀerential operators.
[H¨or90]
Lars H¨ormander. The analysis of linear partial diﬀerential operators. I. Springer-
Verlag, 2nd edition, 1990.
[H¨or94]
Lars H¨ormander. The Analysis of Linear Partial Diﬀerential Operators IV. Springer-
Verlag Berlin Heidelberg, 1994.
[HPMS67] Jr. H. P. McKean and I. M. Singer. Curvature and the eigenvalues of the Laplacian.
Journal of Diﬀerential Geometry, 1(1-2):43 – 69, 1967.
[HZ12]
Hamid Hezari and Steve Zelditch. C∞spectral rigidity of the ellipse. Anal. PDE,
5(5):1105–1132, 2012.
[HZ22]
Hamid Hezari and Steve Zelditch. One can hear the shape of ellipses of small eccen-
tricity. Annals of Mathematics, 196(3):1083 – 1134, 2022.
[Ivr80]
V. Ja. Ivri˘ı. The second term of the spectral asymptotics for a Laplace-Beltrami oper-
ator on manifolds with boundary. Funktsional. Anal. i Prilozhen., 14(2):25–34, 1980.
[Kac66]
Mark Kac. Can one hear the shape of a drum?
Amer. Math. Monthly, 73(4, part
II):1–23, 1966.
[KS18]
Vadim Kaloshin and Alfonso Sorrentino. On the local birkhoﬀconjecture for convex
billiards. Annals of Mathematics, 188(1):315–380, 2018.
[Mil64]
John Milnor. Eigenvalues of the laplace operator on certain manifolds. Proceedings of
the National Academy of Sciences, 51(4):542–542, 1964.
[PT03]
G Popov and P Topalov. Liouville billiard tables and an inverse spectral result. Ergodic
theory and Dynamical systems, 23(1):225–248, 2003.
[PT12]
Georgi Popov and Peter Topalov. Invariants of isospectral deformations and spectral
rigidity. Communications in Partial Diﬀerential Equations, 37(3):369–446, 2012.
[PT16]
G Popov and P Topalov. From kam tori to isospectral invariants and spectral rigidity
of billiard tables. arXiv preprint arXiv:1602.03155, 2016.
[Sog14]
C. D. Sogge. Hangzhou lectures on eigenfunctions of the Laplacian, volume 188 of
Annals of Mathematics Studies. Princeton University Press, Princeton, NJ, 2014.

26
EMMETT L. WYMAN AND YAKUN XI
[Sog17]
C. D. Sogge. Fourier integrals in classical analysis, volume 210 of Cambridge Tracts
in Mathematics. Cambridge University Press, Cambridge, 2nd edition, 2017.
[SZ02]
C. D. Sogge and S. Zelditch. Riemannian manifolds with maximal eigenfunction
growth. Duke Math. J., 114(3):387–437, 2002.
[Tak81]
Floris Takens. Detecting strange attractors in turbulence. In David Rand and Lai-Sang
Young, editors, Dynamical Systems and Turbulence, Warwick 1980, pages 366–381,
Berlin, Heidelberg, 1981. Springer Berlin Heidelberg.
[Uhl76]
Karen Uhlenbeck. Generic properties of eigenfunctions. American Journal of Mathe-
matics, 98(4):1059–1078, 1976.
[Vig21]
Amir Vig. Robin spectral rigidity of the ellipse. The Journal of Geometric Analysis,
31(3):2238–2295, 2021.
[WX23]
Emmett L Wyman and Yakun Xi. A two term kuznecov sum formula. Communications
in Mathematical Physcis, 2023. In press.
[Zel92]
Steven Zelditch. Kuznecov sum formulae and szeg¨o limit formulae on manifolds. Com-
munications in partial diﬀerential equations, 17(1-2):221–260, 1992.
[Zel97]
Steve Zelditch. Fine structure of zoll spectra. Journal of Functional Analysis,
143(2):415–460, 1997.
[Zel04]
Steve Zelditch. Inverse spectral problem for analytic domains I: Balian-bloch trace
formula. Communications in mathematical physics, 248(2):357–407, 2004.
[Zel09]
Steve Zelditch. Inverse spectral problem for analytic domains, II: Z2-symmetric do-
mains. Annals of mathematics, pages 205–269, 2009.
Department of Mathematics, University of Rochester, Rochester NY
Email address: emmett.wyman@rochester.edu
School of Mathematical Sciences, Zhejiang University, Hangzhou 310027, PR China
Email address: yakunxi@zju.edu.cn

