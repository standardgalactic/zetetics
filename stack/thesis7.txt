Quantum Bayesian networks with application to games displaying Parrondoâ€™s
paradox
by
Michael Pejic
A dissertation submitted in partial satisfaction of the
requirements for the degree of
Doctor of Philosophy
in
Mathematics
in the
Graduate Division
of the
University of California, Berkeley
Committee in charge:
Professor F. Alberto GrÂ¨unbaum, Chair
Professor Nicolai Reshetikhin
Professor Umesh Vazirani
Fall 2014

Quantum Bayesian networks with application to games displaying Parrondoâ€™s
paradox
Copyright 2014
by
Michael Pejic

1
Abstract
Quantum Bayesian networks with application to games displaying Parrondoâ€™s paradox
by
Michael Pejic
Doctor of Philosophy in Mathematics
University of California, Berkeley
Professor F. Alberto GrÂ¨unbaum, Chair
Bayesian networks and their accompanying graphical models are widely used for prediction
and analysis across many disciplines. We will reformulate these in terms of linear maps. This
reformulation will suggest a natural extension, which we will show is equivalent to standard
textbook quantum mechanics. Therefore, this extension will be termed quantum. However,
the term quantum should not be taken to imply this extension is necessarily only of utility in
situations traditionally thought of as in the domain of quantum mechanics. In principle, it
may be employed in any modeling situation, say forecasting the weather or the stock marketâ€“
it is up to experiment to determine if this extension is useful in practice. Even restricting
to the domain of quantum mechanics, with this new formulation the advantages of Bayesian
networks can be maintained for models incorporating quantum and mixed classical-quantum
behavior. The use of these will be illustrated by various basic examples.
Parrondoâ€™s paradox refers to the situation where two, multi-round games with a ï¬xed
winning criteria, both with probability greater than one-half for one player to win, are
combined. Using a possibly biased coin to determine the rule to employ for each round,
paradoxically, the previously losing player now wins the combined game with probability
greater than one-half. Using the extended Bayesian networks, we will formulate and analyze
classical observed, classical hidden, and quantum versions of a game that displays this para-
dox, ï¬nding bounds for the discrepancy from naive expectations for the occurrence of the
paradox. A quantum paradox inspired by Parrondoâ€™s paradox will also be analyzed. We will
prove a bound for the discrepancy from naive expectations for this paradox as well. Games
involving quantum walks that achieve this bound will be presented.

i
To my parents.

ii
Contents
Contents
ii
List of Figures
iv
1
Introduction
1
I
Quantum Bayesian networks
5
2
Bayesian networks-graphical models
6
2.1
Graphical models as the form in which information is presented . . . . . . . . .
6
2.2
Transition probability functions . . . . . . . . . . . . . . . . . . . . . . . . . . . .
10
2.3
Graphical models as constraints . . . . . . . . . . . . . . . . . . . . . . . . . . . .
12
2.4
Directed graphical models as tensor networks . . . . . . . . . . . . . . . . . . . .
14
2.5
The Copy map and restriction maps . . . . . . . . . . . . . . . . . . . . . . . . .
15
2.6
Determinism
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
15
3
Hidden classic and quantum nodes
17
3.1
Principles of linearity and potential universality . . . . . . . . . . . . . . . . . .
17
3.2
Options I and II . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
20
3.3
Quantum nodes . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
24
3.4
No quantum copying . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
26
3.5
Embedding quantum models into classical ones . . . . . . . . . . . . . . . . . . .
30
3.6
Embedding classical models into quantum ones . . . . . . . . . . . . . . . . . . .
36
3.7
Classical physics . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
37
3.8
Additional structures for Bayesian networks? . . . . . . . . . . . . . . . . . . . .
38
4
Constructing the networks
40
4.1
Graphical constructs and rules . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
40
4.2
Data for the structures using Option Iâ€™ . . . . . . . . . . . . . . . . . . . . . . . .
41
4.3
Data for the structures using Option II
. . . . . . . . . . . . . . . . . . . . . . .
42
4.4
Example-double-slit experiment . . . . . . . . . . . . . . . . . . . . . . . . . . . .
43
4.5
Quantum model
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
44

iii
4.6
The Bayesian network approach versus the standard textbook approach . . . .
46
4.7
Classical hidden model
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
47
4.8
What is a quantum system? . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
49
5
Relation to textbook quantum mechanics
50
5.1
Textbook rules for quantum mechanics . . . . . . . . . . . . . . . . . . . . . . . .
50
5.2
Weak measurements . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
53
5.3
Comparison of Bayesian networks to quantum circuits and tensor networks . .
56
6
Further examples
58
6.1
No-cloningâ€“classical and quantum . . . . . . . . . . . . . . . . . . . . . . . . . . .
58
6.2
Teleportation-classical and quantum . . . . . . . . . . . . . . . . . . . . . . . . .
59
6.3
Bellâ€™s inequality for Bayesian networks without metaphysical limitations
. . .
62
II Parrondoâ€™s paradox and a Parrondo-like paradox
66
7
Parrondoâ€™s paradox
67
7.1
Deï¬ning the paradox
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
67
7.2
Classical observed Markov chain game . . . . . . . . . . . . . . . . . . . . . . . .
68
7.3
Classical hidden-Markov chain game . . . . . . . . . . . . . . . . . . . . . . . . .
72
7.4
Deï¬ning a quantum analogue of the Markov model . . . . . . . . . . . . . . . .
77
7.5
Parrondoâ€™s paradox for the quantum game
. . . . . . . . . . . . . . . . . . . . .
82
7.6
Summary of results
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
85
8
A Parrondo-like paradox for an one-round game
88
8.1
Deï¬ning the game . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
88
8.2
Deï¬ning geodesics on the space of wavefunctions . . . . . . . . . . . . . . . . . .
89
8.3
Bounds on the extent of the Parrondo-like paradox . . . . . . . . . . . . . . . .
91
8.4
Conditions for the occurrence of the Parrondo-like paradox
. . . . . . . . . . .
94
9
Quantum walks and the Parrondo-like paradox
97
9.1
Classical random and classical hidden walks . . . . . . . . . . . . . . . . . . . . .
97
9.2
Quantum walks . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 101
9.3
The Parrondo-like paradox for quantum walks . . . . . . . . . . . . . . . . . . . 106
Bibliography
111
A General propositions
118
A.1 Banach space propositions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 118
A.2 Hilbert space propositions
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 119
A.3 Transition function propositions . . . . . . . . . . . . . . . . . . . . . . . . . . . . 120

iv
B Propositions for option I
131
B.1 Measures . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 131
B.2 Maps on subspaces of the space of measures . . . . . . . . . . . . . . . . . . . . . 135
B.3 L1-spaces
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 142
B.4 Density-matrix-valued L1-spaces . . . . . . . . . . . . . . . . . . . . . . . . . . . . 142
B.5 Maps on density-matrix-valued L1-spaces . . . . . . . . . . . . . . . . . . . . . . 144
B.6 Vector measures
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 163
C Propositions for option II
164
C.1 Real-valued, continuous functions . . . . . . . . . . . . . . . . . . . . . . . . . . . 164
C.2 Maps on real-valued, continuous functions . . . . . . . . . . . . . . . . . . . . . . 165
C.3 Compact-operator-valued, continuous functions . . . . . . . . . . . . . . . . . . . 170
C.4 Operator inequalities
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 171
C.5 Maps on compact-operator-valued, continuous functions . . . . . . . . . . . . . 174
List of Figures
1.1
Traditional conception of the relation of physics to Bayesian networks. . . . . . . .
3
1.2
Proposed relation of physics to Bayesian networks. . . . . . . . . . . . . . . . . . . .
3
7.1
Minimum achievable values of P comb
A
for p = 0.5 for the two-state, classical hidden
game. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
86
7.2
Minimum achievable values of P comb
A
for p = 0.1 for the two-state, classical hidden
game. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
86
7.3
Minimum achievable values of P comb
A
for p = 0.5 for the two-dimensional, quantum
game. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
87
7.4
Minimum achievable values of P comb
A
for p = 0.1 for the two-dimensional, quantum
game. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
87

v
Acknowledgments
Michael Pejic acknowledges support from the Applied Math. Sciences subprogram of the
Oï¬ƒce of Energy Research, US Department of Energy, under Contract DE-AC03-76SF00098,
and from AFOSR grant FA95501210087 through a subcontract to Carnegie Mellon Univer-
sity.

1
Chapter 1
Introduction
Outline of the work
Bayesian networks and graphical models are useful for classical systems because they are
much more intuitive than a list of conditional dependencies. It is also sometimes useful to
introduce additional, hypothesized nodes to break complicated dependencies into simpler,
potentially universal modules.
Usually these are treated just as observable nodes which
are always hidden; however, this imposes constraints that are metaphysical in origin and
raises diï¬ƒculties of interpretation. We will give an alternate approach using linear maps
on measures, with additional constructions to those generally utilized in graphical models,
that resolves those issues. While, in certain situations, this introduces additional maps, not
previously available, these new maps are not only in and of themselves of limited interest,
but also introduce undesired complications. However, what is extremely fruitful is simply the
conceptual leap. Thinking in terms of linear maps on spaces of measures immediately raises
the question of looking at linear maps on other spaces. This approach leads to a natural ex-
tension, which we will prove is equivalent to standard, textbook quantum mechanics (which
is infamous for its apparently unmotivated and incomprehensible formulation). Therefore,
this extension will be termed quantum. To avoid being swept away by a ï¬‚ood of details,
propositions of a more general nature, together with their proofs, needed to show the sensi-
bility and consistency of the extension and its equivalence to quantum mechanics are placed
in appendices.
However, the term quantum should not be taken to imply this extension is necessarily
only of utility in situations traditionally thought of as in the domain of quantum mechanics.
In principle, it may be employed in any modeling situation, say forecasting weather or
stock pricesâ€“it is up to experiment to determine if this extension is useful in practice. In
particular, there is no reason for Ì·h to necessarily enter into these models if they are outside
the realm of physics. Even restricting to the traditional domain of quantum mechanics, with
this new formulation the advantages of Bayesian networks can be maintained for models
incorporating quantum and mixed classical-quantum behavior.
The use of these will be
illustrated by various examples.
In particular, we will show that some of the supposed

CHAPTER 1. INTRODUCTION
2
hallmarks of quantum mechanics, no-cloning and teleportation, apply for classical hidden
systems as well.
In the second part, we will utilize these extended Bayesian networks in the study of
various games displaying Parrondoâ€™s paradoxâ€“the phenomenon of two games each winning
for one player with probability greater than one-half, yet their convex combination (in a
sense to be speciï¬ed) paradoxically winning for the previously losing player with probability
greater than one-half. We will prove bounds for the discrepancy from naive expectations for
classical versions of a game; those bounds will then be shown to be broken by a quantum
analogue of the game. [31]
A quantum paradox inspired by Parrondoâ€™s paradox will also be analyzed. We will prove
a bound for the discrepancy from naive expectations for this paradox. Games involving
quantum walks that achieve this bound will be presented.
Philosophical interludeâ€“rejection of metaphysics
For a man will attain unto nothing more perfect than to be found to be most
learned in the ignorance which is distinctly his. The more he knows that he is
unknowing, the more learned he will be.â€“Nicholas of Cusa [33]
Natural scientists may adopt whatever attitude they please; they are still under
the domination of philosophy.â€“F. Engels [24]
Physicists generally pretend to ignore philosophy, but since physics (unlike mathematics)
deals with knowledge of external reality, it is not possible to avoid epistemology. A commonly
expressed (although often unacknowledged) philosophy is that of naive realism: While other
sciences have to deal with human-created concepts, physics is a â€œgodâ€™s-eye viewâ€ of reality as
it really is. This is presented pictorially in Figure 1.1. However, there are several problems
with this: (i) it does not agree with what physicists actually do in practice [12] [11]; (ii)
it needlessly encumbers physics with many questions that are metaphysical in natureâ€“the
direction of time, the reason for existence of nature, the collapse of the wavefunction, and
so on; and, most importantly for our work in this dissertation, (iii) it makes it seem as if
quantum is a kind of physics with no connection to modeling.
The philosophy we employ in this work is one with a long-standing pedigree [123]: We
know nothing about reality as it really is; hence, external truths are necessarily tentative
and model-dependent. This is presented pictorially in Figure 1.2. This credo was widely
disseminated by Pragmatists in the late nineteenth century who were inï¬‚uenced by the
methodology of science [122] [60] [67] [34] [35], and it has continued to be advocated by
philosophers of science in the century since [46] [36] [68] [32] [71] [45] [3] [4]. The beneï¬t
of this philosophy is that not only does it resolve the ï¬rst two questions raised above, but,
most pertinent to this present work, it shows quantum is actually a sort of model. Quantum
mechanics is then the overlap of physics with this class of models.

CHAPTER 1. INTRODUCTION
3
Bayesian
networks
physics
classical
quantum
science apart
from physics
Figure 1.1: Traditional conception of the relation of physics to Bayesian networks.
Bayesian networks
physics
science
traditional
non-traditional
classical
quantum
novel?
Figure 1.2: Proposed relation of physics to Bayesian networks.

CHAPTER 1. INTRODUCTION
4
There is no reason to believe reality is doing calculations at all similar to the ones we
employ in our hypothesized models1 or even that it is doing calculations at all. In particular
there is the issue of contextualityâ€“we want to employ potentially universal modules in our
models since only they have predictive ability in novel situations, but perhaps reality is
fundamentally contextual2.
Constraints imposed on our models
In keeping with the expressed philosophy, no metaphysical constraints arising from claims
to know what is â€œreally going onâ€ will be placed upon the mathematical operations and
constructs that can be employed in the models. Rather, there are only three rules that will
be enforced. Firstly, the quantities calculated by the mathematical models must be inter-
pretable as probabilities; in particular, they must be positive3. Secondly, the mathematical
models must be composed of linear maps (which we will show is the weakening of a principle
already in wide use, if not always acknowledged). Thirdly, the mathematical models must
be composed of potentially universal modules (in a manner that we will precisely deï¬ne).
Of course, the particular model employed in a particular situation may fail to be universal
when actually employed in a diï¬€erent context; the point is that this failure should be as a
result of experiment and not be preordained as result of our choice of mathematics employed
in modeling.
These constraints are extremely restrictive. For maps to be linear, they must clearly
live on linear spaces. Furthermore, the constraints also impose strong restrictions on the
linear spaces these maps live on.
Thus far, we are only aware of three classes of linear
spaces that meet the imposed restrictions: (i) certain subspaces of measures; (ii) density
matrices on complex Hilbert spaces ; and (iii) tensor products of these. The former gives
what is traditionally thought of as classical behavior and we will prove the latter two give
behavior that has traditionally been taken the domain of quantum mechanics. However,
since we do not start from quantum mechanics, but instead only from the above principles,
models involving maps on density matrices may be found to be of utility in situations not
traditionally thought of as related to quantum mechanics.
1Human mathematics is an abstraction from our experiences as embodied beings [45]â€“perhaps reality
uses a form of mathematics that cannot be conceived of in this manner.
2Gravityâ€“a long-range force that cannot be screenedâ€“is a clue that this may indeed be the case. Isolated
subsystems are only possible since gravity is so weak it can be generally ignored.
3To aid readability, positive is used instead of nonnegative throughout. Wherever strict positivity is
required, the word strict will be added.

5
Part I
Quantum Bayesian networks

6
Chapter 2
Bayesian networks-graphical models
2.1
Graphical models as the form in which
information is presented
There are many ways to present joint probability in terms of other quantities and mathe-
matical constructs. Graphical models [37] are a useful way to sort through what otherwise
can seem hopelessly complicated in the usual notation. For instance, suppose we are given
a probability space (â„¦,E,Ï€), with â„¦a set, E a Ïƒ-algebra 1 of subsets of â„¦, and Ï€ âˆ¶E â†’R
a probability measure.
Furthermore suppose we have two generalized random variables,
X âˆ¶â„¦â†’X and Y âˆ¶â„¦â†’Y for sets X and Y. Then, for any A âˆˆX(E) and B âˆˆY (E),
the joint probability Prob(X âˆˆA and Y âˆˆB) is Ï€ (Xâˆ’1(A) âˆ©Y âˆ’1(B)). The graphical model
corresponding to presenting the joint probability in this mannerâ€“namely by giving (â„¦, E, Ï€,
X, X, Y, Y )â€“is
m
m
m
X
â„¦
Y



/




S
S
SSw
S
S
SS
(2.1)
where the double arrows stand for deterministic causation.
The resulting joint probability determines a probability space (X Ã— Y,F,Ï) with the
probability measure Ï given on rectangular subsets by Ï(A Ã— B) = Ï€ (Xâˆ’1(A) âˆªY âˆ’1(B)),
which can be readily extended to a probability measure for the Ïƒ-algebra F = (X Ã— Y)(E).
The graphical model corresponding to presenting the joint probability in this mannerâ€“namely
1A Ïƒ-algebra is a collection of subsets of a set X, including both âˆ…and X, that is closed under relative
complementation and countable unions.

CHAPTER 2. BAYESIAN NETWORKS-GRAPHICAL MODELS
7
by giving (X Ã— Y, F, Ï)â€“is
m
m
X
Y
(2.2)
For each B âˆˆY (E), the probability for X determines a probability space (X,G,ÂµB)
with Ïƒ-algebra G = X(E) and with probability measure ÂµB given by ÂµB(A) = Ï(A Ã— B) =
Ï€(Xâˆ’1(A) âˆªY âˆ’1(B)) = Prob(X âˆˆA and Y âˆˆB). The marginal probability for X is then
given by Âµ = ÂµY. Let G Ã— Y signify the Ïƒ-algebra of all rectangular sets of the form A Ã— Y
for A âˆˆG. Since Âµ is a ï¬nite measure (hence, Ïƒ-ï¬nite2) and ÂµB is absolutely continuous3
with respect to Âµ, by the Radon-NikodÂ´ym theorem [72], the measures {ÂµB} determine the
conditional probability (shown in two common notations) Ï„(Bâˆ£G Ã— Y)(x) or Ï„(Bâˆ£x) as the
Radon-NikodÂ´ym derivative dÂµB
dÂµ (x).
The Radon-NikodÂ´ym derivative dÂµB
dÂµ (x) is actually an equivalence class of functions4. Let
L0(X;Âµ) denote the space of equivalence classes of Âµ-measurable functions5 that diï¬€er on Âµ-
null subsets. As usual, for p âˆˆ[0,âˆ), let Lp(X;Âµ) be the space of â€œfunctionsâ€ f in L0(X;Âµ)
such that âˆ«X âˆ£fâˆ£p dÂµ is ï¬nite (the value of the integral is independent of the representative
function in the equivalence class). For p âˆˆ[1,âˆ), these are Banach spaces for the usual norm
âˆ¥fâˆ¥=
p
âˆš
âˆ«X âˆ£fâˆ£p dÂµ
(2.3)
Furthermore, let Lâˆ(X;Âµ) be the space of â€œfunctionsâ€ f in L0(X;Âµ) that are essentially
bounded6 in magnitude. This is a Banach space with the norm âˆ¥fâˆ¥being the least essential
bound on âˆ£fâˆ£. Then dÂµB
dÂµ = Ï„(Bâˆ£x) is actually a â€œfunctionâ€ in L1(X;Âµ) âˆ©Lâˆ(X;Âµ). This
space is clearly isometrically isomorphic to L1(X Ã— Y;Ïâˆ£GÃ—Y) âˆ©Lâˆ(X Ã— Y;Ïâˆ£GÃ—Y), which is
emphasized by the notation Ï„(Bâˆ£G Ã— Y)(x).
Let H be the Ïƒ-algebra Y (E). For any disjoint, countable collection {Bj} âŠ‚H,
Âµâ‹ƒj Bj = Ï(â‹…Ã— â‹ƒ
j
Bj) = âˆ‘
j
Ï(â‹…Ã— Bj) = âˆ‘
j
ÂµBj
(2.4)
2A measure Âµ on set X is Ïƒ-ï¬nite if there are a countable collection of Âµ-measurable subsets {Bj} such
that â‹ƒj Bj = X with each Âµ(Bj) ï¬nite.
3For measure spaces (X,E,mu) and (X,E,nu), Î½ is absolutely continuous with respect to Âµ if Âµ(A) = 0
implies Î½(A) = 0 for all subsets A âˆˆE.
4By abuse of nomenclature it is by convention termed a â€œfunctionâ€â€“we will maintain the quotes for this
latter case since we need to maintain the distinction.
5For a given measure space (X,E,Âµ), let E0 be the Ïƒ-algebra given by the completion of E with respect to
Âµ (see [73]). The extension of Âµ to E0 will still be denoted Âµ. Then we will say Âµ is a F-measure if F is a sub-
Ïƒ-algebra of E0. An element of E0 will be termed Âµ-measurable. A function f âˆ¶X â†’R âˆª{âˆ,âˆ’âˆ,undeï¬ned}
is Âµ-measurable if it takes the later three values only on a Âµ-null subset and is elsewhere measurable with
respect to E0 in the usual sense.
6Bounded on all but a Âµ-null subset

CHAPTER 2. BAYESIAN NETWORKS-GRAPHICAL MODELS
8
with convergence in norm. Since âˆ¥dÂµB
dÂµ âˆ¥
L1(X;Âµ)
= âˆ¥ÂµBâˆ¥,
Ï„ (â‹ƒ
j
Bjâˆ£â‹…) = âˆ‘
j
Ï„ (Bjâˆ£â‹…)
(2.5)
with convergence in L1(X;Âµ)-norm. Hence, the conditional probability Ï„(â‹…âˆ£â‹…) is a L1(X;Âµ)-
valued vector measure7 on Y.
Then the joint probability Prob(X âˆˆA and Y âˆˆB) is given by
âˆ«xâˆˆA Ï„(Bâˆ£x)dÂµ(x)
(2.6)
The directed graphical model corresponding to presenting the joint probability in this mannerâ€“
namely by giving (X, G, Y, H,Âµ, Ï„(â‹…âˆ£â‹…))â€“is
m
m
X
Y
-
(2.7)
Let Î½ be the marginal probability for Y, Î½(B) = Ï(X Ã— B). Then Ï„(â‹…âˆ£â‹…) is absolutely
continuous with respect to Î½ in the sense that Ï„(Bâˆ£â‹…) is the zero â€œfunctionâ€ for every B such
that Î½(B) = 0. However, unless we are in the common case where the Ïƒ-algebra on X is
generated by a countable collection of atoms8, L1(X;Âµ) does not have the Radon-NikodÂ´ym
property9 [107] (the example given above demonstrates this); hence, there is in general no
f âˆˆL1(Y;Î½;L1(X;Âµ)) (which by Fubiniâ€™s theorem [74] is the same as L1(X Ã— Y;Âµ Ã— Î½) for
the product measure10 ÂµÃ—Î½) such that the joint probability Prob(X âˆˆA and Y âˆˆB) is given
by âˆ«(x,y)âˆˆAÃ—B f(x,y)d(Âµ Ã— Î½)(x,y).
Lastly, deï¬ning Î¶(â‹…âˆ£â‹…) symmetrically to Ï„(â‹…âˆ£â‹…), the directed graphical model corresponding
to presenting the joint probability
Prob(X âˆˆA and Y âˆˆB) = âˆ«yâˆˆB Î¶(Aâˆ£y)dÎ½(y)
(2.8)
by giving the marginal probability Î½ and the conditional probability Î¶(â‹…âˆ£â‹…) is
m
m
X
Y

(2.9)
7A vector measure is a countably-additive set function with values in a Banach space where the conver-
gence for the countably-additivity is in norm.
8A set in a set algebra is an atom if it is indivisible in the set algebra.
9A Banach space B has the Radon-NikodÂ´ym property if, for any B-valued vector measure Î½ on a set X
which is absolutely continuous with respect to some Ïƒ-ï¬nite measure Âµ on X, there is a Bochner integrable,
B-valued â€œfunctionâ€, dÎ½
dÂµ, such that Î½(A) = âˆ«A
dÎ½
dÂµ dÂµ for any Î½-measurable A.
10Unfortunately, by convention the tensor product of measures is called the product measure and written
using Ã— instead of the more appropriate âŠ—(however, see [111] for a use of the latter notation).

CHAPTER 2. BAYESIAN NETWORKS-GRAPHICAL MODELS
9
As an example, consider calculating the conditional probability
Prob(Y âˆˆBâˆ£X âˆˆA) = Prob(Y âˆˆB and X âˆˆA)
Prob(X âˆˆA)
(2.10)
(for Prob(X âˆˆA) â‰ 0â€“otherwise the joint probability does not determine the conditional
probability) using the information presented in the manner corresponding to each of the
four graphical models (the ï¬lled circle indicates which node is being conditioned on):
}
m
m
X âˆˆA
â„¦
Y



/




S
S
SSw
S
S
SS
Ï€ (Xâˆ’1(A) âˆ©Y âˆ’1(B))
Ï€ (Xâˆ’1(A))
(2.11)
}
m
X âˆˆA
Y
Ï(A Ã— B)
Ï(A Ã— Y)
(2.12)
}
m
X âˆˆA
Y
-
âˆ«xâˆˆA Ï„(Bâˆ£x)dÂµ(x)
Âµ(A)
(2.13)
}
m
X âˆˆA
Y

âˆ«yâˆˆB Î¶(Aâˆ£y)dÎ½(y)
âˆ«yâˆˆY Î¶(Aâˆ£y)dÎ½(y)
(2.14)
For instance, Bayesâ€™ theorem is simply the calculation corresponding to the presentation of
information by the last graphical model.
A similar situation holds for any ï¬nite number of random variables [69], with a graphical
model with deterministic causation emanating from a fundamental, hidden probability space,
a graphical model with a clique of all the nodes for the random variables, and various directed
models with probabilistic causation. For the common case where the various Ïƒ-algebras are
generated by ï¬nitely many atoms, the various measures become vectors, the conditional
probabilities become stochastic matrices11 or tensors, and the integrations become sums.
11A matrix is stochastic if all entries are either positive or zero and all column sums are one.

CHAPTER 2. BAYESIAN NETWORKS-GRAPHICAL MODELS
10
2.2
Transition probability functions
Depending on how the information for the calculation of the joint probability is presented,
we may imagine diï¬€erent ways of varying it. For (2.1), it is most natural to imagine indepen-
dently varying the maps X and Y. For (2.2), there is nothing to independently vary other
than the joint probability itself. For (2.7), we would like to imagine varying the marginal
probability Âµ and the conditional probability Ï„(â‹…âˆ£â‹…) independently. This is a problem because
the space Ï„(â‹…âˆ£â‹…) lives inâ€“the L1(X;Âµ)-valued vector measuresâ€“depends on Âµ. This problem
will exist even in the commonly occurring case where the Ïƒ-algebra G is generated by a
countable collection of atoms if Âµ is zero on some atom (other than the empty set), since
then the conditional probability when conditioning on that atom is not well-deï¬ned.
One solution to this problem, following [69], is provided by introducing the following
notion:
Deï¬nition 2.2.1
For Ïƒ-algebras G on X and H on Y, a function Ï„(â‹…âˆ£â‹…) âˆ¶H Ã— X â†’R is a
transition probability function if: (i) for each x âˆˆX, Ï„(â‹…âˆ£x) is a probability measure on Y
with event Ïƒ-algebra H; and (ii) for each B âˆˆH, Ï„(Bâˆ£â‹…) is a bounded, G-measurable function
on X.
By taking Ï„(â‹…âˆ£â‹…) to be a transition probability function rather than a conditional probability,
it is now possible to vary Âµ and Ï„(â‹…âˆ£â‹…) independently.
Following [69], one interpretation of the transition probability function is a function on X
with values in the probability measures on Y; naively, one is tempted to imagine Ï„(â‹…âˆ£x) is the
probability given X = x, although this is meaningless unless the marginal probability Âµ has
a strictly positive mass atom at x. Note the function is not generally Bochner integrable12
unless the Ïƒ-algebra H on Y is generated by a countable collection of atoms. For example,
if X = Y and the random variables X and Y are the same, then Ï„(Bâˆ£x) = 1B(x) = Î´x(B),
where the second interpretation as Ï„(â‹…âˆ£x) = Î´x is not Bochner integrable unless the Ïƒ-algebra
on X is generated by a countable collection of atoms.
Also note that the interpretation as a function-valued measure is potentially problematic
since the result is not generally a vector measure because convergence for countable additivity
is generally pointwise rather than in norm (using the supremum norm which is natural for
functions); for instance, consider the preceding example. By the Dominated Convergence
theorem, however, this pointwise convergence is adequate for integration. [75]
We now raise the question of whether it is always possible to upgrade a conditional
probability to a transition probability function. Under rather broad conditions, this is indeed
possible. Firstly, to make things precise we have the following deï¬nition:
12For any Banach space B, a B-valued function on a set X with a measure Âµ is Bochner integrable if there
is a sequence of simple functions (functions taking only ï¬nitely many values with each value achieved on a
set with ï¬nite Âµ-measure) converging to it, both pointwise in B-norm almost everywhere and in L1(X;Âµ;B)-
norm.

CHAPTER 2. BAYESIAN NETWORKS-GRAPHICAL MODELS
11
Deï¬nition 2.2.2
A transition probability function Ï„(â‹…âˆ£â‹…) is a lift of a conditional probability
Î½(â‹…âˆ£â‹…) if Ï„(Bâˆ£â‹…) âˆˆÎ½(Bâˆ£â‹…) for every subset B in the Ïƒ-algebra.
Then, by A3.7, for any conditional probability there is a lift to a transition probability
function (not unique in general) given either of the following suï¬ƒcient conditions (which are
generally met in practice): (i) the Ïƒ-algebra H on Y is generated by countably many atoms;
(ii) Y is an uncountable, complete, separable, metric space with H the Borel Ïƒ-algebra; or
(iii) the Ïƒ-algebra G on X is generated by countably many atoms. See A3.10 for additional
suï¬ƒcient conditions.
Removing metaphysical constraints
Imagining one can vary Âµ and keep the transition probability function Ï„(â‹…âˆ£â‹…) ï¬xed, there is an
intuitive interpretation of Ï„(â‹…âˆ£â‹…) as an idealized conditional probability13, with Ï„(Bâˆ£x) being
the probability to observe B given the event {x}, even if the latter has probability zero or
is not even in the event Ïƒ-algebra (although in this latter case it is constant within any
atom). This leads to a metaphysical notion of the actual existence of a variable taking an
actual value with probability reï¬‚ecting our ignorance of its value. This may be of value for
nodes in a graphical model which are observable; however, it is common to add hypothesized,
hidden nodes to a directed graphical model in order to (hopefully) break it up into smaller,
more manageable pieces [38]. For these, there is no justiï¬cation to necessarily limit oneself
to transition probability functions. Furthermore, the probabilities and conditional proba-
bilities involving the hidden nodes lack any meaning in either the Bayesian or frequentist
interpretationsâ€“the word probability then only means positive and norm-one.
For a ï¬xed choice of Ï„(â‹…âˆ£â‹…), there is a convex linear map L from probability measures on
X to probability measures on Y given by
(LÂµ)(B) = âˆ«xâˆˆX Ï„(Bâˆ£x)dÂµ(x)
(2.15)
The map L extends to a linear map on more general measures and signed measures. Hence,
another solution (among many others) to the above posed problem is therefore to take the
independently varied objects to be the marginal probability Âµ and the linear map L. Not
all linear maps that take probability measures to probability measures are necessarily in-
duced by some transition probability function as in (2.15) (however, they are all induced by
some pseudo-transition â€œfunctionâ€â€“see B2.7, B2.8, and B2.9), so this generally introduces
additional maps. These additional maps, involving operations such as Lebesgue decompo-
sition [76], are not in and of themselves of great interest; in fact the raise rather undesired
complications (see Â§3.2). Furthermore, in the common case where the Ïƒ-algebras are gen-
erated by countably many atoms, any linear map is induced by some transition probability
function, so there are no additional maps. However, what is fruitful is the conceptual shift;
as will be explored in the following chapter, once we are thinking in terms of linear maps,
13As noted in [69].

CHAPTER 2. BAYESIAN NETWORKS-GRAPHICAL MODELS
12
we are immediately drawn to consider the question of looking at linear maps between spaces
other than spaces of measures.
2.3
Graphical models as constraints
In addition to showing the form in which information is presented, graphical models can
also show constraints on the information in a far simpler form than the usual notation. For
instance, consider the Markov chain with three random variables X,Y,Z. For the graphical
model
m
m
m
m
X
â„¦
Y
Z



/




?
S
S
SSw
S
S
SS
(2.16)
with the joint probability Prob(X âˆˆA and Y âˆˆB and Z âˆˆC) given by Ï€ (Xâˆ’1(A)âˆ©Y âˆ’1(B)âˆ©
Zâˆ’1(C)), it is necessary to explicitly add the constraint that for every C âˆˆZ(E), the con-
ditional probability Ï„(Câˆ£x,y) = dÂµC
dÂµ , for ÂµC(A Ã— B) = Ï€ (Xâˆ’1(A) âˆ©Y âˆ’1(B) âˆ©Zâˆ’1(C)) and
Âµ = ÂµZ, is independent of x (in the almost-everywhere, probabilistic sense). If, as above, we
imagine varying the maps X and Y, it is not at all clear how to do this while maintaining
the constraint.
Similarly, for the graphical model
m
m
m
X
Y
Z




S
S
SS
(2.17)
with the joint probability Prob(X âˆˆA and Y âˆˆB and Z âˆˆC) given by Ï(A Ã— B Ã— C), it
is necessary to explicitly add the constraint that for every C âˆˆI = Z(E), the conditional
probability Ï„(Câˆ£x,y) = dÂµC
dÂµ , for ÂµC(A Ã— B) = Ï(A Ã— B Ã— C) and Âµ = ÂµZ, is independent of x
(in the almost-everywhere, probabilistic sense). If, as above, we imagine varying the joint
probability Ï, it is not at all clear how to do this while maintaining the constraint.
However, consider the directed graphical model:
m
m
m
X
Y
Z
-
-
(2.18)

CHAPTER 2. BAYESIAN NETWORKS-GRAPHICAL MODELS
13
which corresponds to presenting the information to calculate the joint probability as Ï†, Î·(â‹…âˆ£â‹…),
and Ï„(â‹…âˆ£â‹…) where
Prob(X âˆˆA,Y âˆˆB, and Z âˆˆC) = âˆ«(x,y)âˆˆAÃ—B Ï„(Câˆ£y)dÂµ(x,y) = âˆ«yâˆˆB Ï„(Câˆ£y)dÎ¾(y)
(2.19)
for the marginal probabilities Âµ on X Ã— Y and Î¾ on Y given by
Âµ(A Ã— B) = âˆ«xâˆˆA Î·(Bâˆ£x)dÏ†(x),Î¾(B) = Âµ(X Ã— B) = âˆ«xâˆˆX Î·(Bâˆ£x)dÏ†(x)
(2.20)
The restriction is that the conditional probability Ï„(â‹…âˆ£â‹…) is independent of x (in the almost-
everywhere, probabilistic sense). It is not necessary to give this constraint explicitly since it
is indicated by the graphical model through the lack of an arrow directly from X to Z. If,
as above, we take Î·(â‹…âˆ£â‹…) and Ï„(â‹…âˆ£â‹…) as transition probability functions instead of conditional
probabilities, it is now easy to see how to vary Ï†, Î·(â‹…âˆ£â‹…), and Ï„(â‹…âˆ£â‹…) while maintaining the
constraintâ€“namely, by only allowing Ï„(â‹…âˆ£â‹…) that are independent of x.
Note if the wrong directed model is chosen, the constraint can be masked. For instance,
for the graphical model
m
m
m
X
Y
Z



/
S
S
S
So

(2.21)
which corresponds to presenting the information to calculate the joint probability as Î½, Î¸(â‹…âˆ£â‹…),
and Î¶(â‹…âˆ£â‹…) where
Prob(X âˆˆA,Y âˆˆB, and Z âˆˆC) = âˆ«(y,z)âˆˆBÃ—C Î¶(Aâˆ£y,z)dÎº(y,z)
(2.22)
for the marginal probability Îº on Y Ã— Z given by
Îº(B Ã— C) = âˆ«zâˆˆCÃ— Î¸(Bâˆ£z)dÎ½(z)
(2.23)
Once again, it is necessary to explicitly add the constraint that for every C âˆˆI, the condi-
tional probability Ï„(Câˆ£x,y) = dÂµC
dÂµ , for ÂµC(AÃ—B) = âˆ«(y,z)âˆˆBÃ—C Î¶(Aâˆ£y,z)dÎº(y,z) and Âµ = ÂµZ, is
independent of x (in the almost-everywhere, probabilistic sense).
This can be readily generalized to more complicated graphical modelsâ€“any graph that is
not simply a clique14 of all the nodes implies constraints on the allowed joint probabilities.
In this manner the various dependencies are displayed in a far more intuitive manner than
through a long list of opaque constraints. Of course, it is always possible to impose additional
constraints explicitly.
14A clique is a group of nodes that are all connected to one another.

CHAPTER 2. BAYESIAN NETWORKS-GRAPHICAL MODELS
14
2.4
Directed graphical models as tensor networks
Tensor networks are a commonly employed, diagrammatic device for contracting tensors and
vectors. For the common case where the various Ïƒ-algebras are generated by ï¬nitely many
atoms, a directed graphical model together with all its information corresponds to a tensor
network or, if conditioning is present, the ratio of tensor networks. If the conditioning is only
on nodes without parents, the denominator is necessarily one, so these can also be considered
tensor networks. Each node in the graphical model with either no children or only one child
becomes one node in the tensor network. For nodes in the graphical model with multiple
children, it is best to replace them with two nodes, one of which takes in all the inputs and
has a single connection to the other, which is a copying or diagonal node that is zero unless
all its connections are the same, when it has the value one, which branches out to all the
outputs.
For example, consider the graphical model:
m
m
m
m
}
X
Y
V
Z
W

1
PPPPPP
q

1
PPPPPP
q
(2.24)
with corresponding information Prob(X = x), Prob(Y = y), Prob(V = vâˆ£X = x,Y = y),
Prob(Z = zâˆ£V = v), and Prob(W = wâˆ£V = v), so the conditional probability Prob(X = x,Y =
y,Z = zâˆ£W = w) is
âˆ‘vâˆˆV (Prob(X = x)Prob(Y = y)Prob(V = vâˆ£X = x,Y = y)
Prob(Z = zâˆ£V = v)Prob(W = wâˆ£V = v))
âˆ‘xâ€²âˆˆX,yâ€²âˆˆY,vâ€²âˆˆV (Prob(X = xâ€²)Prob(Y = yâ€²)Prob(V = vâ€²âˆ£X = xâ€²,Y = yâ€²)
Prob(W = wâˆ£V = vâ€²))
(2.25)
The corresponding tensor network for the numerator is:
v
v
v
v
x
y
A
C
B
Copy
z
w

PPPPPPP

HHHHH
(2.26)
where Axyv = Prob(X = x)Prob(Y = y)Prob(V = vâˆ£X = x,Y = y), which is equal to Prob(V =
v,X = x,Y = y), the Copy tensor is zero unless all its subscript are equal, in which case it
has value one, Bvw = Prob(W = wâˆ£V = v) and Cvz = Prob(Z = zâˆ£V = v). The value for the
tensor network is then
âˆ‘
v,vâ€²,vâ€²â€²âˆˆV
AxyvCopyvvâ€²vâ€²â€²Bvâ€²wCvâ€²â€²z = âˆ‘
vâˆˆV
AxyvBvwCvz
(2.27)

CHAPTER 2. BAYESIAN NETWORKS-GRAPHICAL MODELS
15
which equals the numerator. For the denominator, the tensor network in this case is simply
v
w
D
(2.28)
where
Dw =
âˆ‘
xâˆˆX,yâˆˆY,vâˆˆV
Prob(X = x)Prob(Y = y)Prob(V = vâˆ£X = x,Y = y)Prob(W = wâˆ£V = v)
(2.29)
which is equal to Prob(W = w).
As this example illustrates, the advantages of the Bayesian network over the tensor net-
work are that: (i) it is possible to show which nodes are being observed, marginalized, or
conditioned on; and (ii) the nodes in the Bayesian network have a more intuitive interpre-
tation. On the other hand, the tensor network does highlight the importance of copying for
there to be multiple child nodes, which will be important later for incorporating quantum
nodes (see Â§3.2, Â§3.4, and Â§4.1).
2.5
The Copy map and restriction maps
Going along with the linear maps on measures induced by transition probability function
(see (2.15)), we have the following additional useful linear maps for the evaluation of the
joint probability for a directed graphical model. For a set X with Ïƒ-algebra E, there is
a Copy map from E-measures on X to F-measures on X Ã— X, where F is the Ïƒ-algebra
generated by the rectangular sets E Ã— E. It is given by, for any set A âˆˆF and E-measure
Âµ, Copy(Âµ)(A) = Âµ({x âˆˆXâˆ£(x,x) âˆˆA}). It is induced by the transition probability function
Ï„(â‹…âˆ£â‹…) given by
Ï„(Aâˆ£x) =
â§âªâªâ¨âªâªâ©
1
if (x,x) âˆˆA
0
otherwise
(2.30)
This can clearly be generalized for creating any ï¬nite number of copies.
For each A âˆˆE, there is a restriction map, which is an idempotent, sending E-measures
on X to E-measures15 on X, Âµ â†’1AÂµ = Âµ(A âˆ©â‹…). It is induced by the transition probability
function Ï„(â‹…âˆ£â‹…) given by Ï„(Aâˆ£x) = 1A(x).
2.6
Determinism
An additional restriction that can be placed on the directed graphical models is one of
determinism, which we will interpret to mean that each node with a parent is associated to
15We adopt the convention that a function (or â€œfunctionâ€) before a measure, fÂµ, is the signed measure
fÂµ(A) = âˆ«A f dÂµ.

CHAPTER 2. BAYESIAN NETWORKS-GRAPHICAL MODELS
16
a transition probability function (rather than merely a conditional probability) and that all
transition probability functions take values only zero or one. In that way, all uncertainty is
due to the input probability measures coming from parentless nodes, which can be interpreted
as arising from our uncertainty on initial values which are imagined to actually have speciï¬c,
unknown values. For rather broad conditions (speciï¬ed in the following), it is always possible
to replace a directed graphical model with one that is deterministic and gives identical
results for the joint probability. For each transition probability function, we add an auxiliary
measure space, namely [0,1] with the standard topology, the Borel Ïƒ-algebra, and Lebesgue
measure as its marginal probability. We then constrict a deterministic transition probability
function involving this additional space such that when the auxiliary space is marginalized,
we recover the original transition probability function. Graphically, this means making the
replacement for each node with a parent
m
m
m

>
ZZZ
~

>
ZZZ
~

>
ZZZ
~

>
ZZZ
~
?

ZZZ
Y
Y
Ã”â‡’
(2.31)
where the double arrows are used to indicate the associated transition probability function
is deterministic.
By A3.8, suï¬ƒcient conditions for this are given by similar suï¬ƒcient conditions (which
are generally met in practice) for the existence of a lift in Â§2.2, so either: (i) the Ïƒ-algebra
H on Y is generated by countably many atoms; or (ii) Y is an uncountable, complete,
separable, metric space with H the Borel Ïƒ-algebra. Then for any transition probability
function Ï„(â‹…âˆ£â‹…) âˆ¶H Ã— X â†’[0,1] there is a deterministic transition probability function Î¾(â‹…âˆ£â‹…) âˆ¶
F Ã— X Ã— [0,1] â†’{0,1} such that
Ï„(Bâˆ£x) = âˆ«sâˆˆ[0,1] Î¾(Bâˆ£x,s) dÎ»(s)
where Î» is Lebesgue measure on R. By A3.9, deterministic transition probability functions
are induced by point transformations, which is another common interpretation of determin-
ism.
Of course, just because we can restrict to working with deterministic models does not
mean we must or that we shouldâ€“there are many arbitrary choices made in the construction
of Î¾(â‹…âˆ£â‹…) and it is more straightforward in general to simply work directly with Ï„(â‹…âˆ£â‹…). Hence,
we will discard the restriction of determinism. (Similarly, in Â§5.1, we will show commonly
employed restrictions for quantum models, such as unitarity, are equally without merit.)

17
Chapter 3
Hidden classic and quantum nodes
3.1
Principles of linearity and potential universality
The traditional approach to using Bayesian networks with directed graphical models gives
a marginal probability measure for each input1 node and a transition probability function
for each of the remaining nodes. Then the following principle [47] is utilized, which is so
reasonable it almost always goes unmentioned, but is just implicitly assumed:
Principle 3.1.1â€“Measurement independence
The input marginal probabilities can be
varied independently of each other and the transition probability functions.2
As an example of both the utility and reasonableness of this principle, consider a box with
a horn and a switch. Suppose we know the horn buzzes with 0.9 probability if the switch
is in the left position, and buzzes with 0.3 probability if the switch is in the right position.
The graphical model for this is:
}
m
switch
horn
box
-
(3.1)
Now suppose we have a balanced stick that falls with equal probability to the left or the
right when we release it. Now suppose we arrange it so it activates the switch when it falls.
The graphical model now is:
m
m
m
stick
switch
horn
box
-
-
(3.2)
1All nodes without parents.
2Also known as the free choice or free will principle.

CHAPTER 3. HIDDEN CLASSIC AND QUANTUM NODES
18
The initial probability measure here is 0.5 to fall to the right and 0.5 to fall to the left. The
action of the stick on the switch is deterministic, as is indicated by the double arrow. Once
the switch has been activated, which we observe, the incoming probability measure will be
either 1 for the switch to be right, 0 to be left or 0 for the switch to be right, 1 to be left,
so we can reuse the transition probability function from above. Then, marginalizing the
observations of which way the stick fell and the resulting position of the switch, there is a
0.5 â‹…0.9 + 0.5 â‹…0.3 = 0.6 marginal probability the horn will sound.
Now consider placing a screen that blocks our view of which way the stick falls, but still
allows us to hear the horn if it sounds. The graphical model is
m
m
m
stick
switch
horn
box
-
-
(3.3)
If we wish to predict the marginal probability the horn will sound, we have a problem. We
are given the behavior of the box for incoming probability measures either: 1 for the switch
to be right, 0 to be left; or 0 for the switch to be right, 1 to be leftâ€“but not for 0.5 for the
switch to be right, 0.5 to be left. This is where we must appeal to the preceding principle,
which gives that there is still 0.5 â‹…0.9 + 0.5 â‹…0.3 = 0.6 probability the horn will sound.
From the metaphysical viewpoint this principle makes perfect sense. If there are actually
existing variables that take actual values (such as the position of the switch), observed
outcomes depend only these and not on probability measures, which are only a reï¬‚ection of
our ignorance. As has already been commented on, this justiï¬cation fails for hidden nodes,
which are hypothetical constructs we introduce. Without this metaphysical backing, the
principle is actually far stronger than what is required in that it assumes the existence of
transition probability functions.
If the principle is assumed to hold, then, from (2.15), the calculation of the joint prob-
ability reduces to some combination of composition and tensor product of of linear maps,
involving both those induced by the given transition probability functions, restriction maps,
and possibly the Copy map (the last two of which are also induced by certain transition
probability functionsâ€“see Â§2.5). By A3.2 and A3.3, this calculation is well-deï¬ned. For
instance, the calculation of the joint probability for (2.21), with Î¸(â‹…âˆ£â‹…) and Î¶(â‹…âˆ£â‹…) as transition
probability functions, can be given as3,4
(RA â—‹K â—‹((RB â—‹L) âŠ—I) â—‹Copy â—‹RCÎ½)(X)
(3.4)
3We adopt the usual mathematical convention of maps acting on the left. The opposite convention of
maps acting on the right is also commonly employed in the literature for the classical observed case [62].
4We will follow the convention that the tensor product of vector spaces consists of all ï¬nite linear
combinations (the algebraic tensor product) except if both are Hilbert spaces, in which case it is the Hilbert
space given by the completion using the standard induced inner-product. The tensor product K âŠ—L of linear
maps L âˆ¶A â†’C and K âˆ¶B â†’D is, for closed, linear spaces E âŠ‚A âŠ—B and F âŠ‚C âŠ—F, the set of all linear maps
M âˆ¶E â†’F which, when restricted to A âŠ—B, agree with K âŠ—L. If this set consists of a single map, K âŠ—L is
termed well-deï¬ned.

CHAPTER 3. HIDDEN CLASSIC AND QUANTUM NODES
19
for L the map induced by Î¸(â‹…âˆ£â‹…), K the map induced by Î¶(â‹…âˆ£â‹…), I the identity map on measures,
and RA, RB, RC restriction maps. By introducing an initializing map, Li, on the trivial
measure space5, which is isomorphic to R, with constant value Âµ and a terminal map, Lt,
which evaluates the measure on X (hence, is a map to the trivial measure space), this can
be written purely in terms of maps:
Lt â—‹RA â—‹K â—‹((RB â—‹L) âŠ—I) â—‹Copy â—‹RC â—‹Li
(3.5)
Later, we will introduce hidden nodes of a special form to account for initializing or termi-
nating maps (see Â§4.1).
Therefore, the joint probability is a multilinear functional on the input marginal prob-
abilities. Furthermore, by a convergence theorem for sequences of measures [77], it is not
just linear for ï¬nite linear combinations in each marginal measure, but absolutely convergent
countable linear combinations as well. Hence, for any one input node, if Î¦ is the functional
(with all the marginal probability measures for other nodes ï¬xed) and âŸ¨ÂµjâŸ©is a sequence of
marginal probability measures for that node with âˆ‘j âˆ¥Âµjâˆ¥ï¬nite, then Î¦(âˆ‘j Âµj) = âˆ‘j Î¦Âµj. It
is obvious that it would still be possible to make the calculation for the above example with
the box based simply on this linearity property, which is weaker than the above principle.
As we have already mentioned, we will consider hidden nodes associated to maps on
spaces other than the space of measures. Therefore, we introduce the following weaker and
more general version of the above principle:
Principle 3.1.2â€“Linearity
The maps for a Bayesian network are linear and bounded
(hence, continuous).
Moreover, we want the maps for graph fragments to be universal in the sense that the
modules (such as the box in the preceding example) can be used to make predictions in novel
situations. While this may fail in practice, this should be as a result of experiment and not
be preordained by the mathematical models employed. We insist, therefore, on potential
universality in the sense that any possible tensor product (not just those for a particular
network) of the linear maps employed should always be well-deï¬ned.
Principle 3.1.3â€“Potential universality
The space of linear maps employed must be
such that any tensor product of maps in the space is well-deï¬ned.
The repercussions of the latter two principles will be studied in the following.
5A measure on a set X is trivial if the only subsets in its Ïƒ-algebra are {âˆ…,X}.

CHAPTER 3. HIDDEN CLASSIC AND QUANTUM NODES
20
3.2
Options I and II
A problem arising from potential universality
Generalizing from maps induced by transition probability functions to more general linear
maps, composition is not an issue. However, the principle of potential universality does not
hold in general for maps on measures on speciï¬ed sets for speciï¬ed Ïƒ-algebras of events. One
problem is the lack of uniqueness. Suppose one has the identity map I on Borel6 measures
on the interval [0,1] with the usual topology. Deï¬ne I âŠ—I to be the set of all bounded, linear
maps L on the Borel measures on [0,1] Ã— [0,1], with the usual product topology, such that,
restricted to product measures, Âµ Ã— Î½, L(Âµ Ã— Î½) = (IÂµ) Ã— (IÎ½) = Âµ Ã— Î½. One obvious member
of I âŠ—I is simply the identity map on the Borel measures on [0,1] Ã— [0,1]. This is the only
weak*-continuous7 map in the set. Another map in the set is given by K âˆ¶Ï â†’â‹(Ï âˆ¥(ÂµÃ—Î½)),
where the supremum is taken over all product, ï¬nite, Borel measures and Ï âˆ¥(Âµ Ã— Î½) is the
part of Ï absolutely continuous with respect to Âµ Ã— Î½ using Lebesgue decomposition [76].
This is a well-deï¬ned map by B2.1 that diï¬€ers from the identity map. For instance, let Ï
be the diagonal Lebesgue measure,
Ï(A) = Î»({a âˆˆ[0,1]âˆ£(a,a) âˆˆA})
(3.6)
Then the identity map sends Ï to itself, whereas KÏ = 0 (see B1.8 for details).
Another possible problem is the lack of existence. Not every linear map can be extended.
For example, the space of sequences with limit zero, c0, is a norm-closed8, weak*-dense9
subset of the bounded sequences, â„“âˆ. However, there is no extension of the identity map
c0 â†’c0 to a projection â„“âˆâ†’c0. [5] [124] However, it is not clear whether there is a similar
problem with extending the tensor product of linear maps.
Resolving the problemâ€“two options
There are various ways to resolve this dilemma. One is to revert to only considering linear
maps induced by transition probability functions, which works by A3.3. We will not pursue
this approach since it has no ready generalization to linear maps on spaces other than those
of measures. Instead, we will consider two approaches which do. The ï¬rst, which will be
termed option I, is to limit the space of measures so as to eliminate measures such as Ï
6The Borel Ïƒ-algebra on a topological space is that generated by the open subsets.
7Using the Riesz theorem [78] which states that Radon (deï¬ned in the following) measures on a compact
set are dual to the continuous functions on that set. A measure on a topological space is inner regular if
the measure of any set is approximated by the measure of compact sets it contains. It is outer regular if the
measure of any set is approximated by the open sets that contain it. A measure is Radon if it is Borel and
inner regular. If the space is compact and Hausdorï¬€, and the measure is ï¬nite, then it is also necessarily
outer regular. If the space is compact, Hausdorï¬€, metric, and separable, then Borel measures are necessarily
Radon [79].
8Using the supremum norm.
9Using the duality of â„“1 and â„“âˆ.

CHAPTER 3. HIDDEN CLASSIC AND QUANTUM NODES
21
above. The alternative, which will be termed option II, is to impose additional structure on
the sets and then to limit the space of maps, so as to eliminate maps such as K above.
To implement option I, a basic property that we want for our subsets of measures is
deï¬ned by:
Deï¬nition 3.2.1
A subset A of measures is absolutely-continuous-complete if, for any Âµ
in A, all measures absolutely continuous with respect to Âµ are also in A.
By the Radon-NikodÂ´ym theorem and the density of simple functions10 in L1-spaces, a subset
of ï¬nite measures A will have this property if, given any measure Âµ âˆˆA, all the restrictions Âµâˆ£E
over Âµ-measurable subsets E are also in A. Hence, this property is the minimal requirement
to show that a map is indeed positive. Then from A1.2, A1.3, B1.3, B1.4, and B2.5, the
necessary and suï¬ƒcient condition to implement option I is that the tensor product of the
subsets of measures for each set is norm-dense11 in the subset of measures for the product
set.
A suï¬ƒcient method, termed option Iâ€™, to insure this is met is for each set to have an
associated base measure. The base measure need not be ï¬nite, but it must be Ïƒ-ï¬nite. Then
the associated subset of measures is the set of all ï¬nite measures absolutely continuous with
respect to the base measure, which by the Radon-NikodÂ´ym theorem is equivalent to the space
of L1-functions with respect to the base measure. The base measure for the direct product
of sets must be the product of the base measures for the individual sets. The suï¬ƒciency of
this prescription is given by B3.1.
Another suï¬ƒcient method is to instead use the space of atomic measures12. If there are
uncountably many atoms in the Ïƒ-algebra, this is distinct from option Iâ€™; otherwise, the
counting measure that assigns one to each atom is a base measure. The suï¬ƒciency of this
prescription is given by B6.1 and B6.2. It is also possible to combine these two suï¬ƒcient
approaches, say by using the atomic, L1(X;Âµ)-valued vector E-measures on Y.
This is
suï¬ƒcient by B3.1, B6.1, and B6.2.
The implementation of option II is more straightforward. Each set has a topological
structure that makes it a compact, Hausdorï¬€space. By Tychonoï¬€â€™s theorem [53] [80], the
direct product of compact spaces with the product topology is necessarily compact. All the
Ïƒ-algebras are required to be the Borel Ïƒ-algebra. The linear maps are restricted to those
that are weak* continuous; in other words, those maps that are the adjoints to linear maps
on continuous functions going in the opposite direction. In practice, rather that working with
the adjoint maps, one works with the linear maps in the opposite direction. The propositions
A1.3, C1.1, and C2.4 gives the suï¬ƒciency of this prescription.
10A simple function takes on only ï¬nitely many values.
11Using the total-variation norm.
12A measure is atomic if there is a union of countably many atoms in the Ïƒ-algebra such that the
complement of the union has measure zero.

CHAPTER 3. HIDDEN CLASSIC AND QUANTUM NODES
22
Comments on the two options
For option Iâ€™, the need for base measures is not generally a troublesome issue. For Ïƒ-algebras
generated by a countable number of atomic subsets13, the counting measure that assigns one
to each atom is a base measure for any ï¬nite measure. For classical physics, with conï¬gura-
tion space X and phase-space given by the cotangent bundle T âˆ—X, the symplectic phase-space
volume-form14 â„¦provides a natural base measure, since by Heisenbergâ€™s uncertainty princi-
ple, not even all measures absolutely-continuous with respect to â„¦are accessible, let alone
more singular measures.
Note that allowing the base measure to be a Ïƒ-ï¬nite measure is only for purposes of
convenience in allowing the commonly employed Lebesgue measure on unbounded subsets
of Rn, as the following theorem shows:
Theorem 3.2.2
Given any Ïƒ-ï¬nite measure Âµ on a set X, there is a ï¬nite measure Î½ such
that L1(X;Âµ) is isometric to L1(X;Î½), where the isomorphism is a pointwise scaling.
Proof
If Âµ is ï¬nite, there is nothing to show, so assume it is not. Since Âµ is Ïƒ-ï¬nite, there is
a countable collection of disjoint subsets {Bj} of X such that Âµ(Bj) is ï¬nite and nonzero for
each j âˆˆ{1,2,...} and â‹ƒâˆ
j=1 Bj = X. Then let the ï¬nite measure Î½ be given by Î½âˆ£Bj =
Âµâˆ£Bj
2jÂµ(Bj).
â—»
However, there are two complaints with option Iâ€™. One is that for base measures with an
inï¬nitely-divisible15 part (see B1.7), there is no Copy map (by the same argument as in the
proof of B1.8); hence, except for this (eï¬€ectively discrete) case, hidden nodes either have
only one child node or are terminated. The second complaint is that passing a continuously
variable parameter to a hidden node as a simple number is not permitted (unless that
particular value corresponds to an atom in the base measure); instead, one must use a
sharply peaked measure.
This adds signiï¬cant complexity for little gain in cases where
one is not especially interested in modeling uncertainty in the inputs (see Â§4.5 and Â§8.2 for
instances).
For option II, the restriction to topological spaces and Borel Ïƒ-algebras is also not trou-
blesome, since these are typically used in any case. The limitation of using compact spaces
appears severe, but locally compact spaces16 can also be used with the restriction that the
13A subset in a Ïƒ-algebra is atomic if it is indivisible in the Ïƒ-algebra.
14As a measure, locally â„¦is simply Lebesgue measure with respect to any canonical choice of local position
and momentum coordinates.
15A Ïƒ-ï¬nite measure Âµ for a measure space (X,E,Âµ) is inï¬nitely-divisible if for any Îµ > 0, there is a
countable (ï¬nite if Âµ is ï¬nite) partition of X, {Bj}, with each Âµ(Bj) < Îµ.
16A space is locally compact if it can be compactiï¬ed by the addition of one point, the point-at-
inï¬nity. [54]. [81]

CHAPTER 3. HIDDEN CLASSIC AND QUANTUM NODES
23
maps take continuous functions vanishing at inï¬nity to continuous functions vanishing at
inï¬nity, so the adjoint maps on measures do not â€œleak awayâ€ measure at inï¬nity.
In addition, for option II, the ï¬rst complaint above does not occur since the Copy map is
adjoint to the map Copyâˆ—that takes continuous functions on X Ã— X to continuous functions
on X by (Copyâˆ—f)(x) = f(x,x) (which can obviously be generalized to make any ï¬nite
number of copies). The second complaint does not occur either since the evaluation map is
well-deï¬ned for continuous functions. However, there is now the opposite problem in that we
wish to calculate probabilities on sets, so we need maps on characteristic functions, not just
continuous ones. One solution is to extend each map to one from bounded, Borel measurable
functions to bounded, Borel measurable functions; by C2.9 this can always be done in a
unique manner. Another solution is to use the results on continuous functions to get the
result for characteristic functions of open sets as in the proof of the Riesz theorem [78]; then
outer regularity gives the result on any characteristic function of a Borel set.
Note that for option Iâ€™, the considered linear map L âˆ¶L1(X;Âµ) â†’L1(Y;Î½) is always
induced by a conditional probability Î¾(â‹…âˆ£â‹…) which is given by, for Î½-measurable sets B,
Î¾(Bâˆ£â‹…) = Lâˆ—1B (which is of course actually an equivalence class of functions that agree almost
everywhere with respect to Âµ) with the adjoint map Lâˆ—âˆ¶Lâˆ(Y;Î½) â†’Lâˆ(X;Âµ):
âˆ«yâˆˆB(Lf)(y)dÎ½(y) = âˆ«yâˆˆY 1B(Lf)(y)dÎ½(y) = âˆ«xâˆˆX f(x)(Lâˆ—1B)(x)dÂµ(x)
(3.7)
= âˆ«xâˆˆX f(x)Î¾(Bâˆ£x)dÂµ(x)
for any f âˆˆL1(X;Âµ). By A3.7, if either: (i) the Ïƒ-algebra for Y is generated by countably
many atoms; or (ii) Y is an uncountable, complete, separable, metric space with the Borel Ïƒ-
algebraâ€“then a transition probability function Ï„(â‹…âˆ£â‹…) does exist that is a lift of Î¾(â‹…âˆ£â‹…). Similarly,
if we use option I with the measures limited to the atomic measures, the considered linear
map L âˆ¶A(X;E) â†’A(Y;F) is always induced by an object Ï„(â‹…âˆ£â‹…) which is given by, for sets
B âˆˆF, Ï„(Bâˆ£x) = (LÎ´A)(B) for x in the atomic set A âˆˆE:
(LÂµ)(B) = âˆ«xâˆˆX Ï„(Bâˆ£x)dÂµ(x)
(3.8)
for any atomic measure Âµ âˆˆA(X;E). However, in general Ï„(â‹…âˆ£â‹…) will not be a transition
probability function since there is no reason for Ï„(Bâˆ£â‹…) to necessarily be E-measurable. Also,
for option II, if Y is metric, by C2.8, for the considered linear map L âˆ¶C(Y) â†’C(X), the
adjoint map Lâˆ—âˆ¶M(X) â†’M(Y) is induced by the transition probability function Ï„(â‹…âˆ£â‹…)
given by Ï„(Bâˆ£x) = (LÎ´x)(B) for any x âˆˆX and Borel subset B âŠ‚Y:
(Lâˆ—Âµ)(B) = âˆ«xâˆˆX Ï„(Bâˆ£x)dÂµ(x)
(3.9)
for any Radon measure Âµ âˆˆM(X). However, despite the existence of transition probability
functions (or similar objects) in most encountered cases, it is still more fruitful to consider
the linear maps themselves as the primary objects of interest rather than the transition

CHAPTER 3. HIDDEN CLASSIC AND QUANTUM NODES
24
probability functions (or similar objects). As is shown in the following section, the linear
maps can be generalized to linear maps on structures other than measures, whereas the
transition probability functions or similar objects do not generalize.
3.3
Quantum nodes
Expanding the space of considered maps
As an alternative to linear maps on measures, consider linear maps on density matrices17,18
or, more generally, density matrix-valued vector measures. We will show below that, with
some restrictions on the maps, this can be made to work consistently with the propositions
given in Â§3.1. We will show in Â§5.1 that this gives rise to models that are consistent with
the usual, textbook quantum mechanics; therefore, nodes whose linear maps involve density
matrices will be termed quantum. However, the term quantum should not be taken to imply
these maps are necessarily only of utility in situations traditionally thought of as in the
domain of quantum mechanicsâ€“in principle, any hidden node in any forecasting situation,
say forecasting weather or stock prices, could be a quantum node. It is up to experiment to
determine if these are of utility. Thus far, we are unaware of any structures besides measures
and density matrices that have the requisite properties to be employed in modelling. The
question of whether or not there are such additional structures will be further explored in
Â§3.8 below.
Following our work in the preceding section, for option I, instead of linear maps on subsets
of real-valued measures, we have linear maps on subsets of the D(H)+-valued vector measures.
For option Iâ€™, we will require the vector measures to be absolutely continuous with respect
to a base measure. Since D(H) has the Radon-NikodÂ´ym property [18], this is equivalent to
having D(H)+-valued, Bochner-integrable functions. The constraint of potential universality
mandates having well-deï¬ned tensor product of maps; this is maintained by A1.3 and B4.1
if the tensor product is bounded.
Similarly to the classical case, another suï¬ƒcient approach to implementing option I is to
take the atomic, D(H)+-valued vector measures, as is shown by B6.1 and B6.2. It is also
possible to combine these two suï¬ƒcient approaches, say by using the atomic, L1(X;Âµ;D(H))-
valued vector E-measures on Y. This is suï¬ƒcient by B4.1, B6.1, and B6.2.
17A Hilbert space will be taken to be any complete, sesquilinear inner-product space, without regard to
cardinality of dimension or separability. The density matrices D(H)+ will be taken to be the self-adjoint,
positive operators on a given Hilbert space H.
18A linear map from D(H) to D(J) is commonly referred to as a superoperator in the literature. We choose
not to employ this terminology for the following reasons: (i) linear maps is already standard mathematical
terminology and is in common use in the analogous classical situation, for instance Markov maps; (ii)
superoperator seems to imply a map on all bounded operators, B(H), when in general it is not possible to
extend the domain of the map beyond the trace-class operators, S1(H); and (iii) the use of super- risks
confusion with the unrelated supersymmetry and superstrings.

CHAPTER 3. HIDDEN CLASSIC AND QUANTUM NODES
25
For option II, instead of maps on real-valued, positive, continuous functions, one has maps
on continuous functions that take values in the self-adjoint, positive, compact19 operators on
a Hilbert space H, K(H)+. Self-adjoint, compact operators are used since they are the predual
to the self-adjoint trace-class operators. [65] Once again, potential universality mandates
having well-deï¬ned tensor products of maps; as before, this is maintained if the tensor
product is bounded, now by A1.3 and C3.1.
Problem arising from positivity and potential universality
Of course, everything is not really that simple. The tensor product of bounded maps may
not be bounded. Also, even if both maps are positive, their tensor product need not be.
To illustrate these problems, take a separable, inï¬nite-dimensional Hilbert space H, ï¬x some
orthonormal basis {ej}, and consider the transpose map T relative to that basis:
T â›
ââˆ‘
j,k
ajkej âŠ—eâˆ—
k
â
â = âˆ‘
j,k
akjej âŠ—eâˆ—
k
(3.10)
where eâˆ—
k is the functional âŸ¨â‹…,ekâŸ©. This is well-deï¬ned on the space of density-matrices on
H, D(H)+, since, by the spectral theorem for compact operators [21], any such operator
can be written in the form of an inï¬nite matrix with ï¬nite rank operators corresponding
to truncated matrices converging in trace norm. (Of course, since density-matrices are self-
adjoint, T could also be termed the conjugate map relative to the basis). This map is clearly
positive and has operator norm one.
However, consider the tensor product map T âŠ—IMn acting on density matrices D(HâŠ—Cn)+,
where IMn is the identity map acting on n Ã— n-matrices. For the rank-one operator Ïˆ âŠ—Ïˆâˆ—
with
Ïˆ =
nâˆ’1
âˆ‘
j=0
e(n+1)j+1
(3.11)
we have (T âŠ—IMn)(Ïˆ âŠ—Ïˆâˆ—) = S.
Truncating S to the span of {e1,...,en2} (it is zero
elsewhere), it is the matrix form of the transpose map acting on Mn written in vector form
using the Vec operation20. Therefore, S clearly has eigenvalue one with multiplicity n(n+1)
2
and eigenvalue minus one with multiplicity n(nâˆ’1)
2
. Hence, T âŠ—IMn is not positive, and
âˆ¥T âŠ—IMnâˆ¥op â‰¥
1
âˆ¥Ïˆâˆ¥2 (n(n + 1)
2
âˆ£1âˆ£+ n(n âˆ’1)
2
âˆ£âˆ’1âˆ£) = n2
n = n
(3.12)
By [23], âˆ¥T âŠ—IMnâˆ¥op = n and this example is maximal. This is clearly unbounded as n â†’âˆ.
19An operator is compact if the image of any bounded sequence has a convergent subsequence.
20Vec takes a n Ã— n-matrix to a column vector of height n2 by stacking columns.

CHAPTER 3. HIDDEN CLASSIC AND QUANTUM NODES
26
Solution to the problem
The solution to both the positivity and the boundedness problem is to require complete-
positivity for the maps. This has several deï¬nitions (see B2.6, B5.6, C2.1) that are equiv-
alent (see B5.8, C5.6); the basic notion is that all tensor products with various identity
maps should be positive. Since the composition of positive maps is positive, this immediately
implies that complete-positivity is preserved under both composition and tensor products.
Furthermore, from B2.5, B2.5, C2.4, and C5.3, the operator norm is a cross-norm21 for
completely-positive maps, so this resolves the boundedness problem as well. The completely-
positive maps clearly form a convex cone within the space of all maps; this cone is closed in
the norm topology and in various weaker topologies by B5.12, B5.14, and C5.10; however,
unlike the cone of positive maps, in inï¬nite dimensions it has no interior in any of these
topologies, which raises issues for approximation in numerical calculation.
3.4
No quantum copying
It is commonly stated that cloning is something that is possible classically, but is impossible
in quantum mechanics. This is based on false analogy. The correct situation is that there
are two diï¬€erent notions, that of copying and that of cloning, that are being confused. Once
these two have been separated, we have the following situation:
classical
quantum
copying
Exists
and
implementable
since linear.
Does not exist.
cloning
Exists
but
not
imple-
mentable
since
neither
linear nor the ratio of linear
maps.
Exists
but
not
imple-
mentable
since
neither
linear nor the ratio of linear
maps.
The confusion is comparing the upper left and lower right entries instead of correctly going
across. Cloning is possible for neither classical nor quantum Bayesian networks (as will be
shown below in Â§6.1) for exactly the same reason, so it does not diï¬€erentiate the two. On the
other hand, copying is possible classically (except for issues arising from potential universality
considered above in Â§3.2), but cannot even be deï¬ned as a mathematical operation on density
matrices.
21A norm is a cross-norm if âˆ¥a âŠ—bâˆ¥â‰¤âˆ¥aâˆ¥âˆ¥bâˆ¥. Note the property of being a cross-norm depends on the
choice of norms for the individual spaces as well as for the larger space containing the tensor products.

CHAPTER 3. HIDDEN CLASSIC AND QUANTUM NODES
27
Classical copying
As has already been mentioned (see Â§2.5), there is a Copy map from measures on a set X
to measures on X Ã— X. When X is a compact set, this map is weak*-continuous, being the
adjoint of the previously discussed map (Copyâˆ—f)(x) = f(x,x). The Clone map is given by
Âµ â†’ÂµÃ—Âµ. For the single atom measure for atom C, where for any measurable subset A âŠ‚X,
Î´C(A) =
â§âªâªâ¨âªâªâ©
1
if A âŠƒC
0
otherwise
(3.13)
we have
Copy Î´C = Î´C Ã— Î´C = Clone Î´C
(3.14)
This is likely the source of confusion between the Copy and Clone maps for the classical
case.
Instead of using this explicit form for Copy, an approach that will prove useful in the
quantum case is to start with some basic properties, then ï¬nd the implications. One property
of what is commonly accepted as the notion of a copy is that the probability for both copies
to have a speciï¬ed property is equal to that for each copy to have it, which is equal to that
of the original having it, so for any unit-norm measure Âµ on X and any Âµ-measurable set
A âŠ‚X,
Property C
Copy Âµ(A Ã— A) = Copy Âµ(A Ã— X) = Copy Âµ(X Ã— A) = Âµ(A)
Note this property implies Copy Âµ(A Ã— (X âˆ–A))) = Copy Âµ((X âˆ–A) Ã— A) = 0. Now given
a Ïƒ-algebra E of subsets of X, let F be the Ïƒ-algebra generated by the rectangular subsets
E Ã— E. Then we have the following:
Theorem 3.4.1
Any map L from unit-norm E-measures on X to unit-norm F-measures
on X Ã— X obeying property C is linear for convex linear combinations.
Comment
Since any ï¬nite measure can be scaled to have unit-norm, this implies the
map can be extended to all ï¬nite measures, with the extended map being positively linear.
By the generating property of measures among signed measures as a result of Jordan de-
composition [82], this implies the map can further be extended to a linear map on signed
measures.
Proof
Let L be such a map and Âµ an unit-norm E-measure on X. For any subsets A,B âˆˆE,
by the properties of measures,
(LÂµ)(A Ã— B) =(LÂµ)((A âˆ©B) Ã— (A âˆ©B)) + (LÂµ)((A âˆ©B) Ã— (B âˆ–(A âˆ©B)))
(3.15)
+ (LÂµ)((A âˆ–B) Ã— B)

CHAPTER 3. HIDDEN CLASSIC AND QUANTUM NODES
28
However, (A âˆ©B) Ã— (B âˆ–(A âˆ©B)) âŠ‚(A âˆ©B) Ã— (X âˆ–(A âˆ©B)) and (A âˆ–B) Ã— B âŠ‚(X âˆ–B) Ã— B,
so, by property C and its implication,
(LÂµ)(A Ã— B) = (LÂµ)((A âˆ©B) Ã— (A âˆ©B)) = Âµ(A âˆ©B) = (LÂµ)(B Ã— A)
(3.16)
Let Ï be another unit-norm E-measure on X. Then for any t âˆˆ[0,1], (1 âˆ’t)Ï + tÂµ will be
a unit-norm E-measure on X. Consider the signed measure on X Ã— X given by
Î½t = L((1 âˆ’t)Ï + tÂµ) âˆ’(1 âˆ’t)LÏ âˆ’tLÂµ
(3.17)
Take any A âˆˆE. Then, by property C, Î½t(A Ã— A) = 0. However, by the above symmetry
property of L,
Î½t(A Ã— B) = 1
2 (Î½t(A Ã— B) + Î½t(B Ã— A))
(3.18)
which is equal to
1
2 (Î½t((A âˆªB) Ã— (A âˆªB)) âˆ’Î½t((A âˆ–B) Ã— (A âˆ–B))
(3.19)
âˆ’Î½t((B âˆ–A) Ã— (B âˆ–A)) + Î½t((A âˆ©B) Ã— (A âˆ©B)))
which is zero by the preceding property of Î½t. Since A,B were arbitrary, Î½t must be the zero
measure. â—»
Quantum Copying
The Clone map taking a density matrix on the Hilbert space H to one on H âŠ—H is deï¬ned
as Ï â†’Ï âŠ—Ï. How to deï¬ne a Copy map is not obvious. By analogy to the classical case, it
should have the following properties for any unit-trace density matrix Ï and any projector
E:
Property Q
tr (E âŠ—E) Copy Ï = tr (E âŠ—IH) Copy Ï = tr (IH âŠ—E) Copy Ï = tr EÏ
Note this implies tr (E âŠ—(IH âˆ’E)) Copy Ï = tr ((IH âˆ’E) âŠ—E) Copy Ï = 0. Then we have
the following:
Theorem 3.4.2
Any map L from unit-trace density matrices on H to unit-trace density
matrices on H âŠ—H obeying property Q is linear for convex linear combinations.
Comment
Since any density matrix can be scaled to have trace one, this implies the map
can be extended to all density matrices with the extended map being positively linear. By
the generating property of density matrices among signed density matrices as a result of the
spectral theorem for compact operators, this implies the map can further be extended to a
linear map.

CHAPTER 3. HIDDEN CLASSIC AND QUANTUM NODES
29
Proof
Let L be such a map and Ï an unit-trace density matrix on H. For any commuting
projectors E, F,
tr (E âŠ—F)(LÏ) =tr (EF âŠ—EF)(LÏ)
(3.20)
+ tr (EF âŠ—(F âˆ’EF))(LÏ) + tr ((E âˆ’EF) âŠ—F)(LÏ)
However, by positivity and the implication of Q,
0 â‰¤tr (EF âŠ—(F âˆ’EF))(LÏ) â‰¤tr (EF âŠ—(IH âˆ’EF))(LÏ) = 0
(3.21)
and
0 â‰¤tr ((E âˆ’EF) âŠ—F)(LÏ) â‰¤tr ((IH âˆ’F) âŠ—F)(LÏ) = 0
(3.22)
so, using Q,
tr (E âŠ—F)(LÏ) = tr (EF âŠ—EF)(LÏ) = tr EFÏ = tr (F âŠ—E)(LÏ)
(3.23)
Let Ï„ be another unit-trace density matrix on H. Then for any t âˆˆ[0,1], (1 âˆ’t)Ï + tÏ„ will
be a unit-trace density matrix on H. Consider the signed density matrix on H âŠ—H given by
Î½t = L((1 âˆ’t)Ï + tÏ„) âˆ’(1 âˆ’t)LÏ âˆ’tLÏ„
(3.24)
Take any projector E. Then, by property Q, tr (E âŠ—E)Î½t = 0.
However, by the above
symmetry property of L, for any commuting projectors E, F,
tr (E âŠ—F)Î½t = 1
2 (tr (E âŠ—F)Î½t + tr (F âŠ—E)Î½t)
(3.25)
which is equal to
1
2 (tr ((E + F âˆ’EF) âŠ—(E + F âˆ’EF))Î½t âˆ’tr ((E âˆ’EF) âŠ—(E âˆ’EF))Î½t
(3.26)
âˆ’tr ((F âˆ’EF) âŠ—(F âˆ’EF))Î½t + tr (EF âŠ—EF)Î½t)
which is zero by the preceding property of Î½t. Since E,F were arbitrary, Î½t must be the zero
operator. â—»
We then have the following theorem, based on the argument of Wooters and Zurek [126] that
density matrices of rank greater than one can be expressed in more than one way (inï¬nitely
many ways actually) to create a contradiction.
Theorem 3.4.3
There is no quantum Copy map for non-trivial22 H.
22A trivial Hilbert space has dimension one.

CHAPTER 3. HIDDEN CLASSIC AND QUANTUM NODES
30
Proof
Take any orthonormal {u,v} âŠ‚H with corresponding adjoint operators uâˆ—= âŸ¨â‹…,uâŸ©H
and vâˆ—= âŸ¨â‹…,vâŸ©H. Consider Ï = 1
2 (u âŠ—uâˆ—+ v âŠ—vâˆ—). By linearity,
Copy Ï = 1
2 ( Copy (u âŠ—uâˆ—) + Copy (v âŠ—vâˆ—))
(3.27)
By property Q, for rank one density matrices Copy must be the same as Clone, so Copy Ï
is uniquely given as
1
2 (u âŠ—u âŠ—uâˆ—âŠ—uâˆ—+ v âŠ—v âŠ—vâˆ—âŠ—vâˆ—)
(3.28)
However, it is also possible to write Ï as
1
4 ((u + v) âŠ—(u + v)âˆ—+ (u âˆ’v) âŠ—(u âˆ’v)âˆ—)
(3.29)
Then Copy Ï is uniquely given as
1
8 ((u + v) âŠ—(u + v) âŠ—(u + v)âˆ—âŠ—(u + v)âˆ—
(3.30)
+(u âˆ’v) âŠ—(u âˆ’v) âŠ—(u âˆ’v)âˆ—âŠ—(u âˆ’v)âˆ—)
= 1
4 (u âŠ—u âŠ—uâˆ—âŠ—uâˆ—+ u âŠ—u âŠ—vâˆ—âŠ—vâˆ—+ u âŠ—v âŠ—uâˆ—âŠ—vâˆ—
+ u âŠ—v âŠ—vâˆ—âŠ—uâˆ—+ v âŠ—u âŠ—uâˆ—âŠ—vâˆ—+ v âŠ—u âŠ—vâˆ—âŠ—uâˆ—+
+v âŠ—v âŠ—uâˆ—âŠ—uâˆ—+ v âŠ—v âŠ—vâˆ—âŠ—vâˆ—)
(3.31)
Clearly, (3.28) and (3.31) are unequal, which is a contradiction. â—»
3.5
Embedding quantum models into classical ones
A construction for option Iâ€™ using atomic measures
For option Iâ€™, there is a way to embed quantum behavior into a purely classical, but contex-
tual, model. For any Hilbert space H, let SH be the closed unit ball within H. Let SH/ âˆ¼be
the quotient set formed from SH by the equivalence relation Ïˆ âˆ¼Î¾ if there is a phase23 w such
that Ïˆ = wÎ¾. Clearly SH/ âˆ¼is in one-to-one correspondence to rank-one projectors on H. Let
E be any Ïƒ-algebra on SH/ âˆ¼such that all points are atoms (such as the Borel Ïƒ-algebra).
For any set X and base measure Âµ denote the space of atomic, ï¬nite-norm, L1(X;Âµ)-valued
vector E-measures on SH/ âˆ¼by A(SH/ âˆ¼;E;L1(X;Âµ)). This is a Banach space by B6.1.
Given Ï„ âˆˆA(SH/ âˆ¼;E;L1(X;Âµ)), for any Âµ-measurable subset B âŠ‚X, deï¬ne Ï„B to be the
atomic, signed E-measure on SH/ âˆ¼deï¬ned by Ï„B(A) = âˆ«B Ï„(A)dÂµ for any A âˆˆE. Let âˆ¼â€² be
23Elements of C with magnitude one.

CHAPTER 3. HIDDEN CLASSIC AND QUANTUM NODES
31
the equivalence relation on A(SH/ âˆ¼;E;L1(X;Âµ)) given by Ï„ âˆ¼â€² Ï‡ if, for any Âµ-measurable
subset B âŠ‚X,
âˆ«sâˆˆSH/âˆ¼ssâˆ—dÏ„B(s) = âˆ«sâˆˆSH/âˆ¼ssâˆ—dÏ‡B(s)
(3.32)
Since the equivalence class using âˆ¼â€² of zero is a closed, linear subspace, the quotient space
A(SH/ âˆ¼;E;L1(X;Âµ))/ âˆ¼â€² is a Banach space using the standard norm for quotient spaces,
âˆ¥[Ï„]âˆ¥= infÏ‡âˆˆ[Ï„] âˆ¥Ï‡âˆ¥. Deï¬ne the positive cone on the quotient space to be those equivalence
classes with a positive member, using the obvious notion of positivity on A(SH/ âˆ¼;E;L1(X;Âµ)).
Then we have the following theorem:
Theorem 3.5.1
There is a positive, linear, isometric isomorphism,
L1 (X;Âµ;D(H)) â‰…A(SH/ âˆ¼;E;L1(X;Âµ))/ âˆ¼â€²
Proof
If the measure Âµ is trivial, then L1 (X;Âµ;D(H)) â‰…D(H).
Deï¬ne the map Î¨ âˆ¶
L1 (X;Âµ;D(H)) â†’A(SH/ âˆ¼;E;L1(X;Âµ))/ âˆ¼â€² by Î¨(Ï) being the equivalence class of âˆ‘j ajÎ´[Ïˆj]
for Ï = âˆ‘j ajÏˆjÏˆâˆ—
j with countable collections {Ïˆj} âˆˆSH and {aj} âŠ‚R, which is always possible
by the spectral theorem for compact operators.
For more general measures on X, ï¬rst start with the observation that, given any Ï âˆˆ
L1 (X;Âµ;D(H)), each Ï(x) lives in the same separable subspace of H for almost every x with
respect to Âµ, namely the subspace G that the operator âˆ«xâˆˆX âˆ£Ï(x)âˆ£dÂµ âˆˆD(H) lives in. Let {ej}
be an orthonormal basis for G. For each j âˆˆ{1,2,...}, let Pj be the orthogonal projector
onto the span of {e1,e2,...,ej}.
Since simple functions (more properly, the â€œfunctionsâ€
which are equivalence classes containing simple functions) are norm-dense in L1 (X;Âµ;D(H)),
the sequence âŸ¨PjÏPjâŸ©is a Cauchy sequence by C4.3; hence, it converges in norm by the
completeness of the Banach space L1 (X;Âµ;D(H)). It is readily seen that the limit point
is Ï. Now deï¬ne the map Î¨ âˆ¶L1 (X;Âµ;D(H)) â†’A(SH/ âˆ¼;E;L1(X;Âµ))/ âˆ¼â€² by ï¬rst deï¬ning
Î¨(ÏˆÏˆâˆ—f), for Ïˆ âˆˆH and f âˆˆL1(X;Âµ) to be the equivalence class of the vector measure
f âŠ—Î´[Ïˆ]. Since the linear space D(PmH) is spanned by the m2 operators
{ejeâˆ—
j}jâˆˆ{1,...,m} âˆª{(ej + ek)(ej + ek)âˆ—,(ej + Ä±ek)(ej + Ä±ek)âˆ—}j,kâˆˆ{1,...,m},j<k
(3.33)
the map Î¨ can be extended by linearity to all Ï with the property that Ï(x) lives on the
same ï¬nite-dimensional subspace of H for almost every x with respect to Âµ.
Now take any Ï with this property which is also a simple function. Then, applying the
(ï¬nite-dimensional) spectral theorem to each of the ï¬nitely many values Ï takes, Î¨ is readily
seen to be a positive isometry. Since simple functions are norm-dense, by A1.2, Î¨ is a
positive isometry on all Ï with the property that Ï(x) lives on the same ï¬nite-dimensional
subspace of H for almost every x with respect to Âµ. However, by an above argument, such Ï
are norm-dense in L1 (X;Âµ;D(H)). Hence, using A1.3 to extend Î¨ to all of L1 (X;Âµ;D(H)),
Î¨ is a positive isometry. It remains to show it is surjective, but that is easily seen, with
Î¨âˆ’1 ([âˆ‘
j
fj âŠ—Î´[Ïˆj]]) = âˆ‘
j
fjÏˆjÏˆâˆ—
j
(3.34)

CHAPTER 3. HIDDEN CLASSIC AND QUANTUM NODES
32
for any âˆ‘j fj âŠ—Î´[Ïˆj] âˆˆA(SH/ âˆ¼;E;L1(X;Âµ)). â—»
Comment
Since SHÃ—SJ â‰‡SHâŠ—J if neither H nor J are trivial, this construction is necessarily
contextual. Therefore, it does not violate Bellsâ€™ inequality (see Â§6.3 below).
The nonexistence of the corresponding construction using a base
measure
The corresponding construction using a base measure Î½ would be for there to be a positive
isometry from L1(X;Âµ;D(H)) to a quotient space of some L1(Y;Î½). This is impossible, as
the following theorem shows:
Theorem 3.5.2
If the Hilbert space H is non-trivial, there are no: (i) set Y; (ii) Ïƒ-ï¬nite
measure Î½; and (iii) equivalence relation âˆ¼induced by a closed, linear subspace B âŠ‚L1(Y;Î½)â€“
such that there is a positive, linear isomorphism, Î¨ âˆ¶L1 (X;Âµ;D(H)) â†’L1(Y;Î½)/ âˆ¼, which
is also an isometry on the positive cone.
Proof
Suppose otherwise. Then there is a L1 (X;Âµ;D(H))-valued vector measure Ï„ on Y
provided by Ï„(A) = Î¨âˆ’1 ([1A]) for any Î½-measurable subset A âŠ‚Y. The spaces L1(Y;Î½)âˆ—â‰…
Lâˆ(Y;Î½) by Rieszâ€™s theorem [83]. The dual to L1(Y;Î½)/ âˆ¼is provided by the annihilator BâŠ¥:
the closed, linear subspace of Lâˆ(Y;Î½) that annihilates B. (Note, in particular that since Î¨
is an isometry on the positive cone, the constant â€œfunctionâ€ [1Y] âˆˆBâŠ¥.) Therefore, there is
an adjoint map Î¨âˆ—âˆ¶BâŠ¥â†’L1 (X;Âµ;D(H))âˆ—given by
âˆ«Y f Î¨ÏdÎ½ = (Î¨âˆ—f)Ï
(3.35)
for any f âˆˆBâŠ¥and Ï âˆˆL1 (X;Âµ;D(H)). By the basic properties of Banach spaces, (Î¨âˆ—)âˆ’1 =
(Î¨âˆ’1)âˆ—, Î¨âˆ—is positive, and Î¨âˆ—is an isometry on the positive cone.
Then,
âˆ«A Î¨âˆ—âˆ’1Î¦dÎ½ = Î¦(Ï„(A))
(3.36)
for any linear functional Î¦ âˆˆL1 (X;Âµ;D(H))âˆ—and Î½-measurable subset A âŠ‚Y. For IH the
identity operator, Î¨âˆ—âˆ’1 (IH1X) is the element of BâŠ¥that agrees with the norm when integrated
with any positive â€œfunctionâ€ in L1(Y;Î½)/ âˆ¼; hence, it must be 1Y. Therefore,
âˆ«X tr Ï„(A)dÂµ = âˆ«A Î¨âˆ—âˆ’1 (IH1X) dÎ½ = Î½(A)
(3.37)
However, this gives rise to a contradiction. Fix some subset B âŠ‚X with 0 < Âµ(B) < âˆ.
Take any unit norm Ïˆ âˆˆH. Since Î¨ is positive, by deï¬nition, the equivalence class Î¨(ÏˆÏˆâˆ—1B)
has a positive member, call it gÏˆ. There must be some Ïˆ â‰ Î¾ such that A = {gÏˆ > 0}âˆ©{gÎ¾ > 0}
has strictly positive Î½-measure; otherwise, there would be an uncountable collection {gÏˆ > 0}

CHAPTER 3. HIDDEN CLASSIC AND QUANTUM NODES
33
indexed by unit norm Ïˆ âˆˆH of subsets of Y, each with strictly positive Î½ measure, but whose
pairwise intersections all have Î½-measure zero.
The existence of such a collection would
contradict Î½ being Ïƒ-ï¬nite by B1.6. Since Î¨ is an isometry on the positive cone,
âˆ«Y gÏˆ dÎ½ = Âµ(B)tr IÏˆÏˆâˆ—= Âµ(B) = Âµ(B)tr ÏˆÏˆâˆ—ÏˆÏˆâˆ—= âˆ«yâˆˆY gÏˆ(y)dâŸ¨Ï„Ïˆ,ÏˆâŸ©(y)
(3.38)
Hence, âŸ¨Ï„Ïˆ,ÏˆâŸ©â‰¤tr Ï„ = Î½ must be equal to Î½ when restricted to {gÏˆ > 0} âŠƒA. By a similar
argument, âŸ¨Ï„Î¾,Î¾âŸ©must must be equal to Î½ when restricted to {gÎ¾ > 0} âŠƒA. These conditions
are impossible to satisfy. â—»
The special case of two-dimensional Hilbert spaces
It is possible to circumvent the conclusion of the preceding theorem if the positive isomor-
phism is with a closed, linear subspace of L1(Y;Î½)/ âˆ¼. Specialize to Y = X Ã—Z and Î½ = ÂµÃ—Î· and
let C be the closed, linear subspace of L1(X Ã—Z;ÂµÃ—Î·)/ âˆ¼. Using the notation of the preceding
proof, let âˆ¼â€² be the equivalence relation on the annihilator BâŠ¥âŠ‚Lâˆ(X Ã—Z;ÂµÃ—Î·) induced by
the annihilator CâŠ¥âŠ‚Lâˆ(X Ã— Z;Âµ Ã— Î·), so f âˆ¼â€² g if âˆ«XÃ—Z[h]f d(Âµ Ã— Î·) = âˆ«XÃ—Z[h]g d(Âµ Ã— Î·) for
all [h] âˆˆL1(X Ã— Z;Âµ Ã— Î·)/ âˆ¼. From the proof of the preceding theorem, it is then necessary
that Î¨âˆ—âˆ’1(IH1X) = [1XÃ—Z]. A suï¬ƒcient way to accomplish this would be for there to be a
positive map (not necessarily linear in ÏˆÏˆâˆ—) Î› âˆ¶SH/ âˆ¼phaseâ†’Lâˆ(Z;Î·), where âˆ¼phase is the
equivalence relation on SH given above, such that
Î¨âˆ—âˆ’1(ÏˆÏˆâˆ—1X) = [1X âŠ—Î›(Ïˆ)] for all Ïˆ âˆˆSH/ âˆ¼phase
(3.39)
and, for almost every z âˆˆZ with respect to Î·, the map Ïˆ â†’Î›(Ïˆ)(z) is a frame function with
weight one24.
For H of dimension two, we then have the following based on a construction by Kochen
and Specker [39]. Let Ï‰ be the usual measure on the sphere S2 âŠ‚R3, so, with Cartesian
coordinates (x1,x2,x3) for R3,
Ï‰(A) = âˆ«(x1,x2,x3)âˆˆA = (x1 dx2 âˆ§dx3 âˆ’x2 dx1 âˆ§dx3 + x3 dx1 âˆ§dx2)
(3.40)
for any Borel subset A âŠ‚S2. Let âˆ¼be the equivalence relation on L1(X Ã— S2;Âµ Ã— Ï‰) given
by f âˆ¼g if âˆ«BÃ—H f d(Âµ Ã— Ï‰) = âˆ«BÃ—H g d(Âµ Ã— Ï‰) for all Âµ-measurable subsets B âŠ‚X and all
hemispheres H âŠ‚S2 (whether the hemispheres are taken open or closed is irrelevant). Equip
the quotient space L1(X Ã— S2;Âµ Ã— Ï‰)/ âˆ¼with a norm in the usual way via âˆ¥[f]âˆ¥= infgâˆˆ[f] âˆ¥gâˆ¥.
Deï¬ne the positive cone on L1(X Ã— S2;Âµ Ã— Ï‰)/ âˆ¼by those equivalence classes that contain a
positive element of L1(X Ã— S2;Âµ Ã— Ï‰).
Theorem 3.5.3
There is a positive, linear isometry, Î¨ âˆ¶L1 (X;Âµ;D(H)) â†’L1(X Ã— S2;Âµ Ã—
Ï‰)/ âˆ¼with an associated map Î› âˆ¶SH/ âˆ¼phaseâ†’Lâˆ(S2;Ï‰) with the above properties.
24A function f âˆ¶SH/ âˆ¼phaseâ†’R is a frame function with weight w if it is zero except for a separable
subspace of H and âˆ‘j f(ej) = w for any orthonormal basis {ej} of that subspace.

CHAPTER 3. HIDDEN CLASSIC AND QUANTUM NODES
34
Proof
Take any orthonormal basis {e1,e2} for H â‰…C2. Let Î¨ âˆ¶L1 (X;Âµ;D(H)) â†’L1(X Ã—
S2;Âµ Ã— Ï‰)/ âˆ¼be given by ï¬rst taking Î¨ on elements of the form ÏˆÏˆâˆ—f for Ïˆ âˆˆSH and
f âˆˆL1(X;Âµ) to be the equivalence class of the positive â€œfunctionâ€
f â‹…
â§âªâªâªâ¨âªâªâªâ©
1
Ï€ys
if ys > 0
0
otherwise
(3.41)
for y = [ âˆ£Ïˆ1âˆ£2 âˆ’âˆ£Ïˆ2âˆ£2
R2Ïˆ1Ïˆ2
I2Ïˆ1Ïˆ2 ] and s =
â¡â¢â¢â¢â¢â¢â£
s1
s2
s3
â¤â¥â¥â¥â¥â¥â¦
S2 âˆˆ
where Ïˆj = âŸ¨Ïˆ,ejâŸ©.
Since H is two-dimensional, D(H) is four-dimensional, with basis
{e1eâˆ—
1,e2eâˆ—
2,(e1+e2)(e1+e2)âˆ—,(e1+Ä±e2)(e1+Ä±e2)âˆ—}. Therefore, Î¨ can be extended by linearity
to all of L1 (X;Âµ;D(H)).
For Ï a simple function, by using the spectral theorem for the each of the ï¬nite num-
ber of values Ï attains, the map Î¨ is readily seen to be positive and an isometry. Since
simple functions (more properly, the â€œfunctionsâ€ containing simple functions) are dense in
L1 (X;Âµ;D(H)), by A1.2, Î¨ is a positive isometry for all of L1 (X;Âµ;D(H)).
For this Î¨, an associated Î› does exist. It is given by ï¬rst deï¬ning
zT = [ âˆ£Î¾1âˆ£2 âˆ’âˆ£Î¾2âˆ£2
R2Î¾1Î¾2
I2Î¾1Î¾2 ] â‡”Î¾ âˆ
âˆš
1 + z1
2
e1 +
z2 + Ä±z3
âˆš
2(1 + z1)
e2
(3.42)
where the proportionality for Î¾ is up to an irrelevant phase.
Then Î›(Î¾) = 1Hz, where
Hz is the hemisphere centered at z.
This has the required properties since (i) for any
orthonormal {Î¾,Î¶}, Î›(Î¾) + Î›(Î¶) = 1Hz + 1Hâˆ’z = 1S2, with equality in the Lâˆ(S2;Ï‰)-sense of
almost everywhere with respect to Ï‰ and (ii) for any Î¾,Ïˆ âˆˆSH and f âˆˆL1(X;Âµ),
âˆ«XÃ—S2 (1X âŠ—Î›(Î¾))Î¨(ÏˆÏˆâˆ—f)d(Âµ Ã— Ï‰) = 1
2(1 + yz)(âˆ«X f dÂµ) = âˆ£âŸ¨Î¾,ÏˆâŸ©âˆ£2 (âˆ«X f dÂµ)
â—»
However, for Hilbert space H of dimension greater than two, there is no construction of this
form because Gleason proved [29] that all frame functions on Hilbert spaces of dimension
greater than two are regular25.
Theorem 3.5.4
There are no: (i) set Z; (ii) Ïƒ-ï¬nite measure Î·; and (iii) equivalence
relation âˆ¼induced by a closed, linear subspace B âŠ‚L1(X Ã— Z;Âµ Ã— Î·)â€“such that there is a
positive, linear isometry, Î¨ âˆ¶L1 (X;Âµ;D(H)) â†’L1(X Ã— Z;Âµ Ã— Î·)/ âˆ¼, which has an associated
map Î› âˆ¶SH/ âˆ¼phaseâ†’Lâˆ(Z;Î·) with the properties given above.
25A frame function is regular if it is given by Ïˆ â†’âŸ¨TÏˆ,ÏˆâŸ©for some trace-class, self-adjoint operator T.

CHAPTER 3. HIDDEN CLASSIC AND QUANTUM NODES
35
Proof
Suppose otherwise. By Gleasonâ€™s result, there is a T âˆˆL1(Z;Î·;D(H)+) such that
T(z) has trace one for almost every z âˆˆZ with respect to Î· and
âˆ«XÃ—Z (1X âŠ—âŸ¨TÎ¾,Î¾âŸ©)Î¨(ÏˆÏˆâˆ—1B)d(Âµ Ã— Î·) = âˆ£âŸ¨Î¾,ÏˆâŸ©âˆ£2Âµ(B)
(3.43)
for all Ïˆ,Î¾ âˆˆSH/ âˆ¼phase and Âµ-measurable B âŠ‚X. However, then following the argument of
theorem 3.5.2, there is a contradiction. Fix some subset B âŠ‚X with 0 < Âµ(B) < âˆ. Take
any unit norm Ïˆ âˆˆH. Since Î¨ is positive, by deï¬nition, the equivalence class Î¨(ÏˆÏˆâˆ—[1B]) has
a positive member, call it gÏˆ. There must be some Ïˆ â‰ Î¾ such that A = {gÏˆ > 0}âˆ©{gÎ¾ > 0} has
strictly positive Î½-measure (Since gÏˆ,gÎ¾ are â€œfunctionsâ€, A is actually an equivalence class
of sets that diï¬€er by sets of Î½-measure zero). Since Î¨ is an isometry on the positive cone,
âˆ«XÃ—Z gÏˆ d(Âµ Ã— Î·) = Âµ(B)tr IÏˆÏˆâˆ—= Âµ(B) = Âµ(B)tr ÏˆÏˆâˆ—ÏˆÏˆâˆ—
(3.44)
= âˆ«XÃ—Z (1X âŠ—âŸ¨TÏˆ,ÏˆâŸ©)gÏˆ d(Âµ Ã— Î·)
Hence, âŸ¨TÏˆ,ÏˆâŸ©â‰¤tr T = 1 must be equal to one almost everywhere with respect to Î· when
restricted to {gÏˆ > 0} âŠƒA (once again, this is actually an equivalence class of sets that
diï¬€er by sets of Î½-measure zero). By a similar argument, âŸ¨TÎ¾,Î¾âŸ©â‰¤tr T = 1 must be equal
to one almost everywhere with respect to Î· when restricted to {gÎ¾ > 0} âŠƒA (also actually
an equivalence class of sets that diï¬€er by sets of Î½-measure zero). These conditions are
impossible to satisfy. â—»
A construction for option II
For option II, there is also a way to embed quantum behavior into a purely classical, but
contextual, model. For any Hilbert space H, let BH be the closed unit ball within H. Equip
BH with the weak topology; denote the resulting space by Bweak
H
. Since Hilbert spaces are
reï¬‚exive, with Hâˆ—â‰…H by Rieszâ€™s theorem [84], then this is the same as the weak* topology, so
by Alaogluâ€™s theorem [85], Bweak
H
is a compact space. Furthermore, it is Hausdorï¬€since, given
any distinct points b0,b1, there are separating weak neighborhoods N (b0;b1 âˆ’b0; 1
2âˆ¥b0 âˆ’b1âˆ¥2)
and N (b1;b1 âˆ’b0; 1
2âˆ¥b0 âˆ’b1âˆ¥2).
Then, for any compact, Hausdorï¬€space X, we have the following theorem:
Theorem 3.5.5
There is a positive, isometric isomorphism between C (X;K(H)) and a
closed, linear subspace of C (X Ã— Bweak
H
).
Proof
Consider the map Î¨ âˆ¶C (X;K(H)) â†’C (X Ã— Bweak
H
) given by
(Î¨Ï•)(x,b) = âŸ¨Ï•(x)b,bâŸ©
(3.45)
The map Î¨ is clearly both positive and an isometry. From the latter property, its image is
a closed, linear subspace. The functions in the image of the map are also clearly continuous

CHAPTER 3. HIDDEN CLASSIC AND QUANTUM NODES
36
in x; the following lemma shows that they are continuous in b, so, as claimed above, they
are indeed continuous functions. â—»
Lemma 3.5.6
For any compact operator Ï† âˆˆK(H), the map Î¦ âˆ¶Bweak
H
â†’R given by
Î¦(b) = âŸ¨Ï†b,bâŸ©is continuous.
Proof
First take the case of Ï† positive and rank one, so Ï† = ÏˆÏˆâˆ—for some Ïˆ âˆˆH. Then,
given any b0 âˆˆBH and Îµ > 0, there is a weak neighborhood N (b0;Ïˆ;
âˆš
âˆ£âŸ¨Ïˆ,b0âŸ©âˆ£2 + Îµ âˆ’âˆ£âŸ¨Ïˆ,b0âŸ©âˆ£)
such that for every b in the neighborhood, using the triangle inequality repeatedly,
âˆ£Î¦(b) âˆ’Î¦(b0)âˆ£= âˆ£âˆ£âŸ¨Ïˆ,bâŸ©âˆ£2 âˆ’âˆ£âŸ¨Ïˆ,bâŸ©âˆ£2âˆ£â‰¤(âˆ£âŸ¨Ïˆ,bâŸ©âˆ£+ âˆ£âŸ¨Ïˆ,b0âŸ©âˆ£)âˆ£âŸ¨Ïˆ,bâŸ©âˆ’âŸ¨Ïˆ,b0âŸ©âˆ£
(3.46)
< (âˆ£âŸ¨Ïˆ,bâŸ©âˆ£+ âˆ£âŸ¨Ïˆ,b0âŸ©âˆ£)(
âˆš
âˆ£âŸ¨Ïˆ,b0âŸ©âˆ£2 + Îµ âˆ’âˆ£âŸ¨Ïˆ,b0âŸ©âˆ£)
< (2âˆ£âŸ¨Ïˆ,b0âŸ©âˆ£+
âˆš
âˆ£âŸ¨Ïˆ,b0âŸ©âˆ£2 + Îµ âˆ’âˆ£âŸ¨Ïˆ,b0âŸ©âˆ£)(
âˆš
âˆ£âŸ¨Ïˆ,b0âŸ©âˆ£2 + Îµ âˆ’âˆ£âŸ¨Ïˆ,b0âŸ©âˆ£)
which is equal to Îµ.
Since ï¬nite rank operators are norm-dense in K(H), for any Ï† âˆˆK(H) and Îµ > 0 there
is are ï¬nite collections {Ïˆj} âŠ‚SH (for SH the unit sphere in H) and {aj} âŠ‚R such that
âˆ¥Ï† âˆ’âˆ‘n
j=1 ajÏˆjÏˆâˆ—
j âˆ¥op â‰¤1
2Îµ. Then, by the triangle equality and the above result, for every b in
the neighborhood
n
â‹‚
j=1
N â›
âb0;Ïˆj;
âˆš
âˆ£ajâˆ£âˆ£âŸ¨Ïˆj,b0âŸ©âˆ£2 + 1
2nÎµ âˆ’
âˆš
âˆ£ajâˆ£âˆ£âŸ¨Ïˆ,b0âŸ©âˆ£â
â 
(3.47)
we have âˆ£Î¦(b) âˆ’Î¦(b0)âˆ£< Îµ. â—»
Comment
Since BHÃ—BJ â‰‡BHâŠ—J if neither H nor J are trivial, this construction is necessarily
contextual. Therefore, it does not violate Bellsâ€™ inequality (see Â§6.3 below). Also, for H ï¬nite-
dimensional, it is possible to use SH instead of BH and the norm topology (which is equivalent
to the weak topology in ï¬nite dimensions). In this case, it is also possible to further reduce
the space by the equivalence relation on SH used in the preceding construction for option I.
3.6
Embedding classical models into quantum ones
For Ïƒ-algebras generated by a countable collection of atoms, using option Iâ€™ it is always
possible to duplicate classical behavior using quantum nodes; one simply embeds L1(X;Âµ)
as the diagonal operators in D(L2(X;Âµ))+. Similarly, using option II, if X is a ï¬nite set
of points with the discrete topology, C(X) can be embedded as the diagonal operators in
K(L2(X;counting measure))+.
By 5.28, this is the only way to linearly embed L1(X;Âµ)+ in D(L2(X;Âµ))+ if we want
to take advantage of the one-to-one correspondence between functions 1B in Lâˆ(X;Âµ) â‰…

CHAPTER 3. HIDDEN CLASSIC AND QUANTUM NODES
37
L1(X;Âµ)âˆ—and the orthogonal projectors PB âˆˆB(L2(X;Âµ)) to the subspace of â€œfunctionsâ€
zero almost everywhere outside B provided by the the map diag* deï¬ned in the comment
following B5.19. However, if the measure has an inï¬nitely-divisible part, then unless f âˆˆ
L1(X;Âµ)+ is zero on this part, by B4.3 there is no corresponding diagonal operator in
D(L2(X;Âµ))+.
One alternative is the map diagâˆ’1 into equivalence classes of trace-class
operators with common diagonals deï¬ned in B5.17 and used in Â§5.1 below.
3.7
Classical physics
Classical mechanics
Another approach, which is that of classical mechanics, is to not completely duplicate quan-
tum behavior, but instead approximate it. The key is to recognize that L1(T âˆ—X;â„¦)+ inter-
sects the Hilbert space L2(T âˆ—X;â„¦). Similarly, D(L2(X;Âµ))+ intersects the Hilbert space26
S2(L2(X;Âµ)), which is isomorphic to L2(X Ã— X;Âµ Ã— Âµ). Therefore, if we have an isomor-
phism Î¨ between L2(T âˆ—X;â„¦) and L2(X Ã— X;Âµ Ã— Âµ), we can associate some of the elements
of L1(T âˆ—X;â„¦)+ with those in D(L2(X;Âµ))+.
For X = Rn and Âµ mutually absolutely continuous with respect to Lebesgue measure Î»,
this is indeed possible, with f(q,p) = (Î¨Ï)(q,p) given by
1
(Ï€Ì·h)n âˆ«uâˆˆRn exp(âˆ’2Ä±p â—u
Ì·h
)Ï(q + u,q âˆ’u)
âˆš
dÂµ
dÎ»(q + u)
âˆš
dÂµ
dÎ»(q + u)dÎ»(u)
(3.48)
and inverse Ï(x,xâ€²) = (Î¨âˆ’1f)(x,xâ€²) = (Ï€Ì·h)n(Î¨âˆ—f)(x,xâ€²) given by
âˆš
dÎ»
dÂµ(x)
âˆš
dÎ»
dÂµ(xâ€²)âˆ«pâˆˆRn exp(Ä±p â—(x âˆ’xâ€²)
Ì·h
)f (x + xâ€²
2
,p) dÎ»(p)
(3.49)
Intuitively, f âˆˆL1(T âˆ—X;â„¦)+ will be paired with some Ï âˆˆD(L2(X;Âµ))+ if Ï is very close
to being diagonal and varies slowly along the diagonal whereas f obeys a local version of
Heisenbergâ€™s uncertainty relation, with sharp features in q being spread out in p and vice
versa. Also, these pairs exist for the ground state of the harmonic oscillators, despite Ï
not being very close to being diagonal. Note that when these pairs exist, as a map from
D(L2(X;Âµ))+ to L1(T âˆ—X;â„¦)+, Î¨ is actually an isometry.
Two observations arise from this.
Firstly, if we believe that a quantum description
gives better predictions and that a formulation in terms of classical physics is merely an
approximation, then the classical predictions are completely untrustworthy for non-integrable
classical systems where f rapidly develops ï¬ne tendrils under time evolution. Evolving the
quantum analogue of the system and then using Î¨ would give very diï¬€erent behavior. Either
the ï¬ne tendrils would not form or the correlation would break down, with f = Î¨Ï no longer
26S2 denotes the Hilbert-Schmidt operators.

CHAPTER 3. HIDDEN CLASSIC AND QUANTUM NODES
38
being positive. Secondly, classical physics is simpler than quantum mechanics only because
the time evolution for a Hamiltonian system is so simple, being merely a point transformation
on a ï¬nite dimensional space, T âˆ—X â†’T âˆ—X. Working with full stochastic generality using
non-Hamiltonian systems in classical physics, the analogous quantum description is no more
complicated.
The preceding is evidently dependent on the existence of Lebesgue measure. Since there
is no inï¬nite-dimensional analogue of Lebesgue measure [63], it cannot be extended directly
to ï¬eld theories. Instead, some measure which itself depends on Ì·h must be utilized.
Distinguishable versus indistinguishable particles
It is usually said that there are no indistinguishable particles classically because it is possible
to follow trajectories, which are the time-evolution point transformations T âˆ—X â†’T âˆ—X. The
above analysis gives a diï¬€erent interpretation that is valid in the more general case where
there are no trajectories: if indistinguishability is important in a model, so the density matrix
Ï is taken symmetric (or anti-symmetric) under interchange,
Ï(x1,x2,xâ€²
1,xâ€²
2) = Â±Ï(x2,x1,xâ€²
1,xâ€²
2) = Â±Ï(x1,x2,xâ€²
2,xâ€²
1) = Ï(x2,x1,xâ€²
2,xâ€²
1)
(3.50)
then it is necessarily far from being diagonal, so there is likely no partner in L1(T âˆ—X;â„¦)+
to Ï and a classical model is invalid.
A similar situation holds for the case of Ïƒ-algebras generated by a countable collection
of atoms. If there is classical indistinguishability (such as dollars in a bank account), the
measures assigned to certain atoms by any allowed measure must be the same. No issues
are raised by embedding the measure as the diagonal in D(L2(X;Âµ))+. However, trying to
recast this as quantum indistinguishability then creates oï¬€-diagonal entries without classical
interpretation.
3.8
Additional structures for Bayesian networks?
It may be possible that additional mathematical structures besides measures and density
matrices could be used as the base and target spaces of linear maps to calculate probabilities
using Bayesian networks. To avoid topological complications, only the ï¬nite-dimensional case
will be sought. Looking through the properties of measures and density matrices that are
essential, we have the following properties required for an additional mathematical structure,
given by a collection A of ï¬nite-dimensional, normed vector spaces: (i)for any vector spaces
A,B âˆˆA, the vector space A âŠ—B is also in A; (ii) each B âˆˆA has a positive cone, B+ that
is generating27; (iii) each B âˆˆA has the quasi-AL-property that âˆ¥xâˆ¥+ âˆ¥yâˆ¥= âˆ¥x + yâˆ¥for any
x,y âˆˆB+; and (iv) for any x âˆˆA+, y âˆˆB+, x âŠ—y is in (A âŠ—B)+ with âˆ¥x âŠ—yâˆ¥= âˆ¥xâˆ¥âˆ¥yâˆ¥.
In addition, (v) it is required that there be some nontrivial (other than the identity) maps
27Any x in each B âˆˆA can be written as y âˆ’z for some y,z âˆˆB.

CHAPTER 3. HIDDEN CLASSIC AND QUANTUM NODES
39
between these vector spaces that are simultaneously both completely positive and completely
bounded.
Evidently, for measures A is a collection of n-dimensional vector spaces for n a natural
number, {1,2,3,...}. For density matrices it is a collection of n-dimensional vector spaces
for n a square number, {1,4,9,...}. The question, which is open, is whether there are a
collection of vector spaces A satisfying the preceding properties other than spaces isomorphic
to measures, density matrices, or various tensor products of measures and density matrices.
Obviously, this question is of vital interestâ€“if the answer is negative, then we are limited to
linear maps on measures, density matrices, and their tensor products in formulating Bayesian
networks; if the answer is aï¬ƒrmative, then there is the immediate additional question of
whether or not the additional structure is of practical utility in making predictions.

40
Chapter 4
Constructing the networks
4.1
Graphical constructs and rules
Recall the graphical model simply gives the form for the needed information and illustrates
constraints. The actual needed data is given in an accompanying table. In the following,
ï¬rst the rules for the graphical model are given, then what accompanying data needs to be
supplied depending on which option, Iâ€™ or II, is chosen.
Nodes and terminators
Nodes that are observable, with the traditional emphasis on the transition probability func-
tion, will be indicated in black. Hidden classical nodes, where the linear map on measures is
taken to be fundamental, will be red. Quantum nodes, whose linear maps involve non-trivial
spaces of density matrices, will be blue. Arrows share the color of their parent. Observable
nodes that are being incorporated into the calculation of probability will be crossed. Those
that are being marginalized will be left open. Those that are being conditioned on will be
ï¬lled. Hidden (classical or quantum) nodes will always be left open. To make it visually
clear whether or not a graph is complete and represents the calculation of a number (the
probability) or is just a graph fragment with unresolved maps, terminal nodes which are
either maps from the trivial space (giving initialization) or to the trivial space (giving the
evaluation map) will be indicated by half-circle-half-box shapes, with the half-box being the
terminating end.

	
-


-
(4.1)

CHAPTER 4. CONSTRUCTING THE NETWORKS
41
Splitters
As has been pointed out (see Â§2.4), the usual Bayesian network construction depends heavily
on the ability to copy, with each child node receiving a copy. Without this ability (see Â§3.2
and Â§3.4), an additional graphical structure is required, the splitter. This is an oval with
one or more arrows coming in and more than one arrow coming outâ€“if only one arrow comes
out, the splitter can be dispensed with and all the incoming arrows can be redirected to the
following node.


 
-
HHHH
j
-

*
(4.2)
Pince-nez
There is a certain construction that occurs so often for joining hidden nodes to observable
ones that it is replaced by its own structure, the pince-nez. As the name suggests, this is
two circles, one an observable node, the other a hidden one, joined by a bar.
m
1
Ã”â‡’
m
1
HHH
j

1
@@
R m


 
mPPPP
q
-
- HHH
j
-
(4.3)
The neutral term pince-nez is employed since the concept of â€œmeasurementâ€1 applied to
hidden nodes is so fraught with metaphysical connotations.
4.2
Data for the structures using Option Iâ€™
Using option Iâ€™, for each hidden node, the most general data is
(I,Âµ,H;O,Î½,J;L)
where I is the input set, Âµ the accompanying base measure, H the input Hilbert space,
O the output set, Î½ the accompanying base measure, J the output Hilbert space, and L a
completely-positive, norm-preserving (on the positive cone) map in B(L1(I;Âµ;D(H)),L1(O;
Î½;D(J))). If either Hilbert spaces are the trivial space C, it can be left oï¬€the list. Similarly,
if either base measure is trivial, for instance, if Âµ(âˆ…) = 0, Âµ(I) = 1 with no other sets
measurable, then it and its set can be left out as well.
1We will always place â€œmeasurementâ€ in quotation marks to emphasize its problematic nature.

CHAPTER 4. CONSTRUCTING THE NETWORKS
42
For each splitter, the most general data is
(I,Âµ,H;O1,Î½1,J1,...,Om,Î½m,Jm;Î¨)
where I â‰…O1 Ã—â‹¯Ã—Om, Âµ â‰…Î½1 Ã—â‹¯Ã—Î½m, and H â‰…J1 âŠ—â‹¯âŠ—Jm, with Î¨ giving the isomorphisms,
which should be trivial except for possible permutations to make sure everything goes to the
correct place, with more complicated behavior placed in separate nodes. Once again, trivial
entries can be left out.
For each pince-nez, the most general data is
(I,Âµ,H;R,Ï„;O,Î½,J;L)
where I is the input set, Âµ the accompanying base measure, H the input Hilbert space, R
the observable set, Ï„ the accompanying base measure, O the output set, Î½ the accompanying
base measure, J the output Hilbert space, and L a completely-positive, norm-preserving (on
the positive cone) map in B (L1(I;Âµ;D(H)),L1(R Ã— O;Ï„ Ã— Î½;D(J))). Again, trivial entries
can be left out (however, if Ï„ is trivial, then the pince-nez is actually just a node).
4.3
Data for the structures using Option II
Using option II, for each hidden node, the most general data is
(I,H;O,J;L)
where I is the input compact space, H the input Hilbert space, O the output compact
space, J the output Hilbert space, and L a completely-positive, norm-preserving (on the
positive cone) map in B (C(O;K(J)),C(I;K(H))). As previously noted, the spaces can be
locally-compact if L is further restricted. Trivial entries can be left oï¬€the list.
For each splitter, the most general data is
(I,H;O1,J1,...,Om,Jm;Î¨)
where I â‰…O1 Ã— â‹¯Ã— Om with the product topologies agreeing as well, and H â‰…J1 âŠ—â‹¯âŠ—Jm,
with Î¨ giving the isomorphisms, which should be trivial except for possible permutations to
make sure everything goes to the correct place, with more complicated behavior placed in
separate nodes. Once again, trivial entries can be left out.
For each pince-nez, the most general data is
(I,H;R;O,J;L)
where I is the input compact space, H the input Hilbert space, R the observable compact
space, O the output compact space, J the output Hilbert space, and L a completely-positive,
norm-preserving (on the positive cone) map in B (C(R Ã— O;K(J)),C(I;K(H))). As previ-
ously noted (see Â§3.2), the spaces can be locally-compact if L is further restricted. Again,
trivial entries can be left out (however, if R is trivial in the sense of being the one-point set,
then the pince-nez is actually just a node).

CHAPTER 4. CONSTRUCTING THE NETWORKS
43
4.4
Example-double-slit experiment
So far, the exposition has been quite abstract. To make things more concrete and demon-
strate how to use Bayesian networks with linear maps (both classical and quantum) in
practice, consider the following example. There is a black-box with a dial which can be set
to any position Î¸ on a circle, a switch with two settings, and four lights, with lights one and
two forming one pair and lights three and four forming another. After study, it is determined
to have the following properties: if the switch is oï¬€, periodically one of the second pair of
lights ï¬‚ashes while the ï¬rst pair never ï¬‚ashes, whereas, if the switch is on, one of each pair
ï¬‚ashes. After more study, it is determined the behavior of each round is independent and,
if the switch is oï¬€, with probability cos2 Î¸ the third light alone ï¬‚ashes and with probability
sin2 Î¸ the fourth light alone ï¬‚ashes. If the switch is on, the joint probabilities are as follows:
ï¬rst on, third on, others oï¬€
1
4
ï¬rst on, fourth on, others oï¬€
1
4
second on, third on, others oï¬€
1
4
second on, fourth on, others oï¬€
1
4
(4.4)
with the other probabilities being zero. Presenting the information in the manner of the
preceding joint probabilities corresponds to the following graphical model:
m
m
}
}
dial
switch
ï¬rst pair of lights
second pair of lights
HHHHHHH







(4.5)
Suppose the box is now opened and is found to be composed of ï¬ve modules. A cable
runs from the ï¬rst module to the second. Two cables come from the second module, one
each running to a pair of seemingly identical modules, each of which has one of the ï¬rst pair
of lights. The switch activates switches on the pair in unison. These modules have cables
running to the last, which has the dial as a control. If possible, given the joint probabilities,
we should conï¬ne ourselves to models which are consistent with the constraints implied by
these observations because we would like to be able to predict what would happen if these
modules were rewired or taken out and placed in a diï¬€erent context.

CHAPTER 4. CONSTRUCTING THE NETWORKS
44
4.5
Quantum model
Consider ï¬rst a quantum model with graphical model:

	
-
1
m
2
-


 
3

*
HHHHHHHH
j m
5
m
4

*
PPPPPPPPPP
q

6
m
m
m
second light
ï¬rst light
third and fourth
light
}
}
Î˜
S
J
J
JJ^





-
(4.6)
The blue 1,2,3,4,5,6 are for reference. The information presented in the form indicated by
the graphical model is as follows:
node 1
(;C2;L1), where L1 is the constant map with value [
1
âˆš
2
1
âˆš
2
][
1
âˆš
2
1
âˆš
2 ] = [
1
2
1
2
1
2
1
2
].
node 2
(C2;C4;L2), where L2(Ï) is
â¡â¢â¢â¢â¢â¢â¢â¢â£
0
0
0
0
0
0
Ï
0
0
0
0
0
0
â¤â¥â¥â¥â¥â¥â¥â¥â¦
(4.7)
splitter 3
(C4;C2,C2)
pince-nez 4
â›
âœâœâœ
â
{ switch on,
switch oï¬€}, counting
measure ,C2;
â§âªâªâªâªâªâ¨âªâªâªâªâªâ©
light one on and switch on,
light one on and switch oï¬€,
light one oï¬€and switch on,
light one oï¬€and switch oï¬€,
â«âªâªâªâªâªâ¬âªâªâªâªâªâ­
, counting
measure ;C2;L4
â
âŸâŸâŸ
â 
(4.8)

CHAPTER 4. CONSTRUCTING THE NETWORKS
45
where L4(Ï„) is
â§âªâªâªâªâªâªâªâªâªâªâªâªâªâªâ¨âªâªâªâªâªâªâªâªâªâªâªâªâªâªâ©
Ï„âˆ£switch oï¬€
if light one oï¬€and switch oï¬€
0
if light one on and switch oï¬€
â¡â¢â¢â¢â¢â£
1
0
0
0
â¤â¥â¥â¥â¥â¦
Ï„âˆ£switch on
â¡â¢â¢â¢â¢â£
1
0
0
0
â¤â¥â¥â¥â¥â¦
if ï¬rst on and switch on
â¡â¢â¢â¢â¢â£
0
0
0
1
â¤â¥â¥â¥â¥â¦
Ï„âˆ£switch on
â¡â¢â¢â¢â¢â£
0
0
0
1
â¤â¥â¥â¥â¥â¦
if ï¬rst oï¬€and switch on
(4.9)
pince-nez 5
Same as for pince-nez 4 except the second light replaces the ï¬rst light.
pince-nez 6
â›
âœâœâœ
â
[0,2Ï€), Lebesgue
measure
,C4;
â§âªâªâªâªâªâ¨âªâªâªâªâªâ©
third and fourth on,
third on,
fourth on,
third and fourth oï¬€
â«âªâªâªâªâªâ¬âªâªâªâªâªâ­
, counting
measure ;;L6
â
âŸâŸâŸ
â 
where L6(Ï„) is
âˆ«
2Ï€
0
[ 1
0
0
0 ]Ï„(Î¸)
â¡â¢â¢â¢â¢â¢â¢â¢â£
1
0
0
0
â¤â¥â¥â¥â¥â¥â¥â¥â¦
dÎ¸ if both third and fourth on
(4.10)
âˆ«
2Ï€
0
[ 0
1
âˆš
2eÄ±Î¸
1
âˆš
2eâˆ’Ä±Î¸
0 ]Ï„(Î¸)
â¡â¢â¢â¢â¢â¢â¢â¢â¢â£
0
1
âˆš
2eâˆ’Ä±Î¸
1
âˆš
2eÄ±Î¸
0
â¤â¥â¥â¥â¥â¥â¥â¥â¥â¦
dÎ¸ if third on
âˆ«
2Ï€
0
[ 0
1
âˆš
2eÄ±Î¸
âˆ’1
âˆš
2eâˆ’Ä±Î¸
0 ]Ï„(Î¸)
â¡â¢â¢â¢â¢â¢â¢â¢â¢â£
0
1
âˆš
2eâˆ’Ä±Î¸
âˆ’1
âˆš
2eÄ±Î¸
0
â¤â¥â¥â¥â¥â¥â¥â¥â¥â¦
dÎ¸ if fourth on
âˆ«
2Ï€
0
[ 0
0
0
1 ]Ï„(Î¸)
â¡â¢â¢â¢â¢â¢â¢â¢â£
0
0
0
1
â¤â¥â¥â¥â¥â¥â¥â¥â¦
dÎ¸ if both third and fourth oï¬€
Using this information, the joint probability, given that the switch is oï¬€and the dial is set

CHAPTER 4. CONSTRUCTING THE NETWORKS
46
to Î¸, for both the ï¬rst pair being oï¬€, the third light being on, and the fourth light being oï¬€,
is then given by, for positive, unit-norm g âˆˆL1([0,2Ï€),Lebesgue),
L6
â›
â(L4 âŠ—L5)(L2 (L1)1switch oï¬€)âˆ£ï¬rst pair is oï¬€,
switch is oï¬€
gâ
â 
RRRRRRRRRRRR third is on,
fourth is oï¬€
(4.11)
= âˆ«
2Ï€
0
RRRRRRRRRRRRRRRRRRR
[ 0
1
âˆš
2eÄ±Î¸â€²
1
âˆš
2eâˆ’Ä±Î¸â€²
0 ]
â¡â¢â¢â¢â¢â¢â¢â¢â¢â£
0
1
âˆš
2
1
âˆš
2
0
â¤â¥â¥â¥â¥â¥â¥â¥â¥â¦
RRRRRRRRRRRRRRRRRRR
2
g(Î¸â€²)dÎ¸â€² = âˆ«
2Ï€
0
cos2 Î¸â€² g(Î¸â€²)dÎ¸â€²
(4.12)
For g suï¬ƒciently peaked about Î¸, the result is approximately cos2 Î¸.
Similarly, the joint probability, given that the switch is on and the dial is set to Î¸, for
both the ï¬rst and the third light being on, with the second and fourth being oï¬€, is then
given by
L6
â›
âœâœâœ
â
(L4 âŠ—L5)(L2 (L1)1switch on)âˆ£ï¬rst is on,
second is oï¬€
switch is on
g
â
âŸâŸâŸ
â 
RRRRRRRRRRRRRRRRRR third is on,
fourth is oï¬€
(4.13)
= âˆ«
2Ï€
0
RRRRRRRRRRRRRRRRRRR
[ 0
1
âˆš
2eÄ±Î¸â€²
1
âˆš
2eâˆ’Ä±Î¸â€²
0 ]
â¡â¢â¢â¢â¢â¢â¢â¢â£
0
1
âˆš
2
0
0
â¤â¥â¥â¥â¥â¥â¥â¥â¦
RRRRRRRRRRRRRRRRRRR
2
g(Î¸â€²)dÎ¸â€² = 1
4
(4.14)
The other joint probabilities can be calculated similarly and agree with the joint probabilities
originally determined for the black box.
Comments on the use of option Iâ€™
Note the use of option Iâ€™ leads to extra complexity concerning the dial position Î˜, forcing
the introduction of a function g peaked at Î¸, although in this example we are not concerned
about modelling the uncertainty of that value. In this case, using option II would have
been slightly simpler. Then, instead of using counting measure as the base measure on the
discrete sets, the discrete topology would be used to make the discrete sets into compact
spaces.
4.6
The Bayesian network approach versus the
standard textbook approach
Interpreting the switch as controlling the operation of a position â€œmeasurementâ€ at two
slits and the dial as selecting a point on a backing screen for another position â€œmeasure-

CHAPTER 4. CONSTRUCTING THE NETWORKS
47
mentâ€, there is a well-known standard textbook approach using wavefunctions, projectors,
and Bohmâ€™s postulate that replicates the outcome. By comparison, the Bayesian network
for this particular problem may appear cumbersome; however, that is largely a result of
familiarity with the ï¬rmer. With the network approach, there are none of the seemingly ad
hoc rules for dealing with quantum systems; instead, only the simple conditions of positivity,
linearity and potential universality. Also, the graphical model is highly intuitive and guides
the writing of the correct expression (4.13). This is of great importance in dealing with more
complicated systems.
In addition, as will be illustrated by more complicated examples to follow (see Â§7.4), the
network approach is far more ï¬‚exible. Of particular interest, in some special cases it allows
the needed Hilbert spaces to be kept to reasonable sizes in the course of the calculation
instead of ballooning exponentially. To be more explicit, for a Hilbert space of dimension n,
the space of operators has dimension of order n2, and the space of maps on these operators
has dimension of order n4, which is why it appears cumbersome. However, if, by utilizing
the ï¬‚exibility of the network approach, one is able to avoid dealing with Hilbert spaces of
dimension nN and operator spaces of dimension n2N, where N is the number of particles,
the potential savings is tremendous (as will be seen in Â§7.4).
4.7
Classical hidden model
For the same black box, now consider a classical hidden model with the same graphical model
(4.6) (except now the hidden nodes and connecting arrows will be red).
For simplicity,
functions on discrete spaces indexed by numbers will be given as column vectors.
The
information presented in the form indicated by the graphical model is as follows:
node 1
(;{1,2}, counting
measure ;L1), where L1 is the constant map with value [
1
21
2
].
node 2
({1,2}, counting
measure ;{(1,1),(1,2),...,(4,4)}, counting
measure ;L2), where L2(Ï) is
[ 0
0
0
0
0
0
Ï1
0
0
0
0
0
Ï2
0
0
0 ]
T
(4.15)
splitter 3
({(1,1),(1,2),...,(4,4)};{1,2,3,4},{1,2,3,4}) with the obvious identiï¬cation.

CHAPTER 4. CONSTRUCTING THE NETWORKS
48
pince-nez 4
({ switch on,
switch oï¬€} Ã— {1,2,3,4}, counting
measure ;
(4.16)
â§âªâªâªâªâªâ¨âªâªâªâªâªâ©
light one on and switch on,
light one on and switch oï¬€,
light one oï¬€and switch on,
light one oï¬€and switch oï¬€,
â«âªâªâªâªâªâ¬âªâªâªâªâªâ­
, counting
measure ;{1,2,3,4}, counting
measure ;L4
â
âŸâŸâŸ
â 
where L4(Ï„) is
â§âªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâ¨âªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâªâ©
Ï„âˆ£switch oï¬€
if light one oï¬€and switch oï¬€
0
if light one on and switch oï¬€
â¡â¢â¢â¢â¢â¢â¢â¢â¢â¢â£
0
0
0
0
1
1
0
0
0
0
0
0
0
0
0
0
â¤â¥â¥â¥â¥â¥â¥â¥â¥â¥â¦
Ï„âˆ£switch on
if ï¬rst on and switch on
â¡â¢â¢â¢â¢â¢â¢â¢â¢â¢â£
0
0
0
0
0
0
0
0
0
0
0
0
0
0
1
1
â¤â¥â¥â¥â¥â¥â¥â¥â¥â¥â¦
Ï„âˆ£switch on
if ï¬rst oï¬€and switch on
(4.17)
pince-nez 5
Same as for pince-nez 4 except the second light replaces the ï¬rst light.
pince-nez 6
({(1,1),(1,2),...,(4,4)} Ã— [0,2Ï€), counting
measure Ã— Lebesgue
measure
;
(4.18)
â§âªâªâªâªâªâ¨âªâªâªâªâªâ©
third and fourth on,
third on,
fourth on,
third and fourth oï¬€
â«âªâªâªâªâªâ¬âªâªâªâªâªâ­
, counting
measure ;;L6
â
âŸâŸâŸ
â 
where L6(Ï„) is
âˆ«
2Ï€
0
[ 1
1
1
1
1
1
0
0
0
0
0
0
0
0
0
0 ]Ï„(Î¸)dÎ¸
(4.19)
if both third and fourth lights are on,
âˆ«
2Ï€
0
[ 0
0
0
0
0
0
cos2 Î¸
1
2
0
0
0
0
cos2 Î¸
1
2
0
0 ]Ï„(Î¸)dÎ¸
(4.20)

CHAPTER 4. CONSTRUCTING THE NETWORKS
49
if the third light is on and the fourth is oï¬€,
âˆ«
2Ï€
0
[ 0
0
0
0
0
0
sin2 Î¸
1
2
0
0
0
0
sin2 Î¸
1
2
0
0 ]Ï„(Î¸)dÎ¸
(4.21)
if the fourth light is on and the third is oï¬€, and
âˆ«
2Ï€
0
[ 0
0
0
0
0
0
0
0
1
1
1
1
0
0
1
1 ]Ï„(Î¸)dÎ¸
(4.22)
if both third and fourth lights are oï¬€.
Using this information, the joint probability, given that the switch is oï¬€and the dial is set
to Î¸, for both the ï¬rst pair being oï¬€, the third light being on, and the fourth light being oï¬€,
is then given by (4.11), which is âˆ«
2Ï€
0
cos2 Î¸â€² g(Î¸â€²)dÎ¸â€² â‰ˆcos2 Î¸. Similarly, the joint probability,
given that the switch is on and the dial is set to Î¸, for both the ï¬rst and the third light being
on, with the second and fourth being oï¬€, is then given by (4.13), which is âˆ«
2Ï€
0
1
4g(Î¸â€²)dÎ¸â€² = 1
4.
The other joint probabilities can be calculated similarly and agree with the joint probabilities
originally given for the black box.
4.8
What is a quantum system?
For the two-slit experiment, which only required ï¬nite-dimensional linear algebra in the
quantum model (apart from the already commented on problem of inputting the dial setting
Î˜), a classical model with the same behavior also only required ï¬nite-dimensional linear
algebra. This is atypical. As we have seen in Â§3.5, a classical model that duplicates the
behavior of a quantum model is generally far more complicated. Also, these classical models
are generally inherently contextual.
A reason why the name â€œquantum systemâ€ could still be applied to this example is
universality: while both models have been constructed to be potentially universal, testing
will reveal if they fail in this regard. If the black boxes were opened to reveal a laser, beam-
splitters, photon detectors, and so on, from experience we would have a lot of conï¬dence
that the modules in the quantum model are universal, whereas we would have very little
conï¬dence for the modules in the classic model to have that property. Conversely, if the
boxes were opened to reveal regular computer circuits, the situation would be reversed.

50
Chapter 5
Relation to textbook quantum
mechanics
5.1
Textbook rules for quantum mechanics
The quantum Bayesian network structure developed so far has constraints only arising from
the requirements of positivity, linearity, and potential universality. It is not obvious that it
has any connection necessarily to what is usually thought of as quantum mechanics. Using
option Iâ€™, that is not the situation, as is shown below.
However, while the following justiï¬es the usage of the name quantum for the extended
Bayesian networks, it should not be taken as a justiï¬cation of themâ€“quite the opposite. The
Bayesian network approach is predicated on a very reasonable basis. The textbook approach
to quantum mechanics is only comfortable due to familiarity; on its own merits its rules are
incomprehensible and unmotivated. Hence, the following is better taken as a justiï¬cation
of the textbook approach. In other words, if quantum behavior had ï¬rst been discovered
as forecasting arising from a reasonable extension of Bayesian networks, and the usual list
of textbook rules were later discovered picking out a certain subset of networks that were
suï¬ƒcient to model any situation, no one would take those rules as primary.
Rule one
Textbook quantum mechanics imposes an additional rule: only networks in the form of
chains are permitted and all the Hilbert spaces along a chain must be the same (apart for
terminating trivial spaces). (This rule may arise from imagining that we have some sort
of universal, initial-value, dynamical system). Mathematically, this rule puts no additional
constraints on the network formulation; it is always possible to obey this by working in a
suï¬ƒciently large Hilbert space and waiting until the end of the calculation to perform the
reduced traces arising from terminal nodes. However, doing this in practice is unnecessarily
diï¬ƒcultâ€“the whole point of Bayesian networks is to try to ï¬nd a model made of simple and

CHAPTER 5. RELATION TO TEXTBOOK QUANTUM MECHANICS
51
(hopefully) universal parts where the calculations can be done in a manageable manner.
Therefore, similarly our treatment of determinism in Â§2.6, we will discard this rule.
Rule two
Another rule from textbook quantum mechanics is: the linear map for a quantum node can
only be of the form LÏ = UÏU âˆ—, where U is unitary. As we prove in theorem 5.1.1 below,
this is no limitation at all mathematically if option Iâ€™ is employed. If option II is used,
the theorem still holds if H is separable and if there is some strictly positive1, ï¬nite Radon
measure on X. For any node with data (I,Âµ,H;O,Î½,J;L), the map L can be represented
as the sequence of three operations, using some auxiliary Hilbert space M: (i) injecting
Ï âˆˆL1(I;Âµ;D(H)) as a density matrix on a Hilbert space K âŠ—L2(O;Î½) âŠ—J utilizing a partial
isometry; (ii) taking a reduced trace of the density matrix over K; (iii) mapping the resulting
density matrix on L2(O;Î½)âŠ—J into L1(O;Î½;D(J)). By introducing an auxiliary Hilbert space
L with
L2(X;Âµ) âŠ—H âŠ—L = L2(O;Î½) âŠ—J âŠ—M
(5.1)
and some ï¬xed template density-matrix on L, the partial isometry can be upgraded to an
unitary operator. In terms of the graphical model, this means replacing a node with the
graph fragment:
m

	




 
m
m
unitary
- 
1
PPP
q
PP
P
q
I,Âµ,H
L
M
O,Î½,J
-
  
-
(5.2)
Of course, just because we can do this does not mean we must, or that we should. To obey
this rule, a great deal of extra computation and irrelevant, arbitrary choices must be made
to no practical beneï¬t. Therefore, this rule will also be discarded.
Rule three
Yet another rule from textbook quantum mechanics is: the linear map for a terminal pince-
nez (a destructive â€œmeasurementâ€) can only be of the form âˆ«B LÏdÎ½ = tr EBÏ, where {EB}BâˆˆE
are a complete set of mutually commuting, orthogonal projectors2. For the other pince-nez,
1Every open set gets measure greater than zero.
2{EB}BâˆˆE is a complete set of mutually commuting, orthogonal projectors for a Ïƒ-algebra E of subsets of
a set X if they are all mutually commuting, orthogonal projectors with Eâˆ…= 0, EX = I, and Eâ‹ƒj Bj = âˆ‘j EBj
for all countable, disjoint collections {Bj} âŠ‚E, with convergence of the sum in the weak* topology induced
on B (H) by its being dual to the trace-class operators S1 (H). In this case, convergence in the ultrastrong-
operator, strong-operator, ultraweak-operator (same as weak*), and weak-operator topologies on B (H) are
all equivalent (see A2.1).

CHAPTER 5. RELATION TO TEXTBOOK QUANTUM MECHANICS
52
only Ïƒ-algebras generated by a countable set of atoms are allowed, and the map must be of
the form
âˆ«B LÏdÎ½ = âˆ‘
j
EAjÏEAj for {Aj} a partition of B
(5.3)
This rule can also be stated in the form that every â€œmeasurementâ€ has an associated op-
erator, which are the coordinates r (taking values as coordinates in the discrete case) for
R acting on L2(R;Ï„) in this formulation. An even stronger formulation requires the result
of any â€œmeasurementâ€ to be an eigenvalue of the associated operator [19]. This implicitly
assumes any results accrued to unions of atoms is due to post-â€œmeasurementâ€ garbling and
not inherent in the â€œmeasurementâ€. Furthermore, if the eigenspace corresponding to any
eigenvalue has dimension greater than one, this formulation fails to distinguish among the
myriad of possible complete sets of mutually commuting, orthogonal projectors consistent
with its prescription, giving rise to the â€œthree-box paradoxâ€ [2] if there is post-conditioning.
Again employing option Iâ€™, as we prove in theorem 5.1.1 below, this third textbook
rule also imposes no mathematical limitation. Using option II, the theorem still holds with
the same limitations given before.
For any pince-nez with data (I,Âµ,H;R,Ï„;O,Î½,J;L),
the map L can be represented as the sequence of four operations, using some auxiliary
Hilbert space M: (i) injecting Ï âˆˆL1(I;Âµ;D(H)) as a density matrix on a Hilbert space
L2(RÃ—O;Ï„ Ã—Î½)âŠ—JâŠ—M utilizing a partial isometry; (ii) making a projective â€œmeasurementâ€
on the L2(R;Ï„) portion; (iii) taking a reduced trace of the density matrix over L; and (iv)
mapping the resulting density matrix on L2(O;Î½) âŠ—J into L1(O;Î½;D(J)). By introducing
an auxiliary Hilbert space L with
L2(X;Âµ) âŠ—H âŠ—L = L2(R Ã— O;Ï„ Ã— Î½) âŠ—J âŠ—M
(5.4)
and some ï¬xed template density-matrix on L, the partial isometry can be upgraded to an
unitary operator. In terms of the graphical model, this means replacing a pince-nez with the
graph fragment:
m
m

	




 
m
m


unitary
projective
-
-
PPP
q



7
PPP
q
I,Âµ,H
L
M
O,Î½,J
L2(R;Ï„)
-
  
-
(5.5)
Once again, just because we can do this does not mean we must, or that we should. To obey
this rule, a great deal of extra computation and irrelevant, arbitrary choices must be made
to no beneï¬t. Therefore, this rule will also be discarded.
The main theorem
The statement of the aforementioned theorem is:

CHAPTER 5. RELATION TO TEXTBOOK QUANTUM MECHANICS
53
Theorem 5.1.1
Any completely-positive map L âˆˆCP(L1(I;Âµ;D(H)),L1(RÃ—O;Ï„Ã—Î½;D(J)))
that is an isometry on the positive cone can be expressed as
LÏ = (diagL2(R;Ï„) âŠ—(diagL2(O;Î½) âŠ—IB(J)) âŠ—tr M)V ((diagL2(I;Âµ) âŠ—IB(H))âˆ’1Ï)V âˆ—
for some Hilbert space M and some partial isometry V âˆˆB(L2 (I;Âµ) âŠ—H,L2 (R Ã— O;Ï„ Ã— Î½) âŠ—
JâŠ—M). If all the Hilbert spaces L2 (I;Âµ), H, L2 (R;Î½), L2 (O;Î½), and J have ï¬nite dimension,
then M can be taken to be J âŠ—dimL2 (I;Âµ) âŠ—H.
Proof
Apply B5.27. â—»
Comments
The full proof is quite lengthy, occupying from B5.17 to B5.27 in the ap-
pendix.
The following is an outline: First a diagonal extraction map diag is deï¬ned in
B5.17. Using this, we ï¬nd that the dual space to density-matrix-valued, L1-â€œfunctionsâ€
is a von Neumann algebra3. Then one theorem by Stinespring [118] on completely-positive
maps on Câˆ—-algebras and another by Sakai [109] on representations of von Neumann algebras
complete the proof.
For the inverse map in the statement of the theorem, (diagL2(I;Âµ)âŠ—IB(H))âˆ’1, any particular
choice in the preimage can be takenâ€“the ï¬nal result is the same regardless of which choice is
made. Also, as claimed, introducing an auxiliary Hilbert space L satisfying (5.4), the partial
isometry can be certainly be upgraded (although not in a unique fashion) to an unitary
operator U satisfying, for some ï¬xed template density-matrix Ï‡ âˆˆD(L),
V ((diagL2(I;Âµ) âŠ—IB(H))âˆ’1Ï)V âˆ—= U(((diagL2(I;Âµ) âŠ—IB(H))âˆ’1Ï) âŠ—Ï‡)U âˆ—
(5.6)
for all Ï âˆˆL1(I;Âµ;D(H)). In addition, the statement of the theorem does indeed indicate
a projective â€œmeasurementâ€. Let B be any Ï„-measurable subset of R. Then, for any Ï• âˆˆ
D(L2(R;Ï„)), 1B as an element of Lâˆ(R;Ï„) â‰…L1(R;Ï„)âˆ—acting on diagL2(R;Ï„)Ï• is
âˆ«B diagL2(R;Ï„)Ï• dÏ„ = tr PBÏ•
(5.7)
where PB = diagâˆ—
L2(R;Ï„)1B is the orthogonal projector to the subspace of â€œfunctionsâ€ in
L2(R;Ï„) that are zero almost everywhere outside B.
5.2
Weak measurements
Reproducibility as a criteria
One motivation for the restriction to projective maps, emphasized by Dirac [20], is repro-
ducibility: if two successive pince-nez have the same data (and the incoming and outgoing
3A Banach algebra is a Banach space equipped with an associative, distributive product satisfying âˆ¥abâˆ¥â‰¤
âˆ¥aâˆ¥âˆ¥bâˆ¥. A *-algebra is a Banach algebra with an antilinear involution. A C*-algebra is a *-algebra where
âˆ¥aâˆ—aâˆ¥= âˆ¥aâˆ¥2. A von Neumann algebra (also termed a W*-algebra) is a C*-algebra which, as a Banach space,
is a dual space.

CHAPTER 5. RELATION TO TEXTBOOK QUANTUM MECHANICS
54
data are compatible), then conditioning on the observation for the ï¬rst being in some mea-
surable subset B âŠ‚R, the probability measure for the second observation has the property
that on measurable sets that do not intersect B, it gives zero, whereas on measurable sets
that contain B, it gives one. The Bayesian network for this set-up is:
}
m
m
m

	


-
-
-
1
1
(5.8)
where the repeated â€˜1â€™s indicate the data for the two pince-nez are the same.
While this criteria looks superï¬cially attractiveâ€“as is implied in the saw â€œmeasure twice,
cut onceâ€â€“its ï¬‚aw is readily apparent. Suppose I were asked to see whether or not a light
in another room were oï¬€. If I see the light is oï¬€, I return and report it being oï¬€. If I see
it is on, I turn it oï¬€, then return and also report it being oï¬€. This is repeatable, but does
not correspond to what we generally mean by the measurement of the state of the light.
While this example may seem obtuse, the point is that mathematically projective maps in
quantum mechanics act in this mannerâ€“they have a signiï¬cant eï¬€ect even if the results are
ignored.
Weak versus strong maps for pince-nez
Building from the preceding example, if the incoming and outgoing data for a pince-nez are
compatible, then the map L is termed strong if, when marginalizing over the observation, the
result (using option Iâ€™), âˆ«R L(Ï)dÏ„, is far from Ï for all but a small subset of Ïâ€™s. Conversely,
the map L is termed weak if âˆ«R L(Ï)dÏ„ is close to Ï for a large subset of Ïâ€™s. Obviously, there
is a continuum of possibilities; the strength could be varied depending on an input parameter.
For instance, in the double-slit example previously considered, the switch control could be
replaced by a continuous slider that would slowly vary the joint probabilities of the output.
Now we can easily understand the misconception leading to the repeatability criteria; in
the classic case, restriction maps (using diagonal projectors) are both repeatable and the
weakest possible, having no eï¬€ect if their observations are ignored. In the quantum case,
however, while projective maps (using orthogonal projectors) are still repeatable, they can
also be very strong.
Information as a criteria
Another misconception is that the result of any pince-nez map can be duplicated by a
projective map followed by a garbling of the observation data4. If this were the case, then,
by convexity, the information5 using a projective map would always be higher than for any
4For instance, Dirac seemed to believe â€œmeasurementsâ€ were always inherently projective. [20]
5Information in the sense of the Shannon deï¬nition [115] for the probability measure on the observation
set R.

CHAPTER 5. RELATION TO TEXTBOOK QUANTUM MECHANICS
55
other map in every situation. Consequently, the claim by Kochen and Specker that projective
â€œmeasurementsâ€ give maximal knowledge [40] would be correct. However, it is easy to see
this is false. For instance, the matrices
Ï†1 = [
2
3
0
0
1
3
],Ï†2 = [
1
6
1
5
1
5
1
3
],Ï†3 = [
1
6
âˆ’1
5
âˆ’1
5
1
3
]
(5.9)
are all positive, sum to the identity, and do not mutually commute. The map L âˆ¶D(C2) â†’R3
given by L(Ï) = (tr Ï†1Ï,tr Ï†2Ï,tr Ï†3Ï) is completely-positive and norm-preserving (on the
positive cone), yet cannot be duplicated by any garbling of a projective map, âˆ‘2
k=1 gjktr EkÏ,
for stochastic matrix G = [gjk] and commuting, complete, orthogonal projectors {E1,E2}
on C2 since the matrices {g11E1 + g12E2,g21E1 + g22E2,g31E1 + g32E2} necessarily mutually
commute.
Also, even if it were possible to duplicate the behavior of a particular pince-nez map by
an projective map followed by a garbling of the observation data when the module is used in
isolation, if the module is then inserted into a larger Bayesian network where conditioning
is taking place, the diï¬€erence in behavior between the particular pince-nez map and the
projective map followed by a garbling may become quite large. In particular, for so-called
â€œweak-measurementsâ€ [2], which employ both strong and weak pince-nez maps together with
both pre- and post-conditioning, the information can be very large. The typical Bayesian
network for one of these has the form:
}
}
}
m
}
}
}

	

	
...

	
m


 




...


-
-
-
HHHHHH
j
      
-

3
QQQQQQQ
s
(5.10)
There is both pre- and post-conditioning; those pince-nez have projective maps. The central
pince-nez has a map that uses â€œfuzzyâ€ projectors with spread of order
âˆš
N for N particles.
Hence, the relative standard deviation in the values assigned to the observation set is only of
order
1
âˆš
N , so the information is high; furthermore, the center of the peak of the distribution
can be in unexpected ranges of the observation set, as has been well-publicized recently [13].

CHAPTER 5. RELATION TO TEXTBOOK QUANTUM MECHANICS
56
5.3
Comparison of Bayesian networks to quantum
circuits and tensor networks
A commonly-used, alternative graphical approach for quantum systems is quantum cir-
cuits [51]. For example consider the following quantum circuit:


 


 


 


 
Ïˆi
U
V
Ïˆf
K
J
H
(5.11)
Then for Hilbert spaces H, J, and K, termed the quantum channels, and initial state Ïˆi âˆˆ
H âŠ—J âŠ—K, the ï¬nal state Ïˆf is given by (IH âŠ—V )(U âŠ—IK)Ïˆi for some unitary U âˆ¶H âŠ—J â†’
H âŠ—J and V âˆ¶J âŠ—K â†’J âŠ—K. Quantum circuits are obviously directly related to the usual
textbook quantum mechanics working with wavefunctions. Following the ï¬rst textbook rule
from above, there is a single overall Hilbert space, the tensor product of all the Hilbert
spaces for each quantum channel, that is used throughout. Only unitary operators can be
accommodated, following the second textbook rule above.
It is possible to incorporate projective â€œmeasurementsâ€ into the quantum circuit, giving
a tensor network, but this requires doubling the graphâ€“clearly not an eï¬ƒcient approach
graphically. For instance, suppose the initial state is a product state, Ïˆi = Ïˆ1 âŠ—Ïˆ2 âŠ—Ïˆ3
and that a projective â€œmeasurementâ€ is made on the ï¬nal state, where the projector is of
the form IH âŠ—P. Then the calculation of the probability âˆ¥IH âŠ—PÏˆfâˆ¥2 = âŸ¨IH âŠ—PÏˆf,ÏˆfâŸ©is
represented by the tensor network
f
f
f


 


 


 


 


 
f
f
f
U
V
P
V *
U *
Ïˆ3
Ïˆ2
Ïˆ1
Ïˆâˆ—
3
Ïˆâˆ—
2
Ïˆâˆ—
1
(5.12)
The tensor network has some of the advantages of the Baysian network in that once it is set
up, it is possible to look for computational shortcuts.
On the other hand, the Bayesian network has many advantages. It does not depend
on the incomprehensible and unmotivated textbook rules, but instead stands on its own
reasonable basis. It is graphically more eï¬ƒcient in not having to duplicate itself to include
observations. It is also potentially more eï¬ƒcient in allowing non-unitary nodes and non-
projective pince-nez, hence avoiding the need to introduce auxiliary spaces, and in having the
splitter construction, so it is not necessary to maintain all the quantum circuits throughout

CHAPTER 5. RELATION TO TEXTBOOK QUANTUM MECHANICS
57
the diagram. The Bayesian network indicates which observable nodes are being marginalized
or conditioned on and works seamlessly with the usual observable Bayesian networks that
are already in common use, so it easily allows models with information coming from previous
observations or random factors (such as coin ï¬‚ips). For instance, a tensor network coming
from a quantum circuit for the â€œweak measurementâ€ example (5.10) would be far more
complicated, with the need for auxiliary spaces, yet would still not be able to indicate the
post-conditioning graphically (the pre-conditioning could be incorporated into the initial
values for the wavefunction).

58
Chapter 6
Further examples
6.1
No-cloningâ€“classical and quantum
No-cloning is taken as a hallmark of quantum mechanics.
However, it is a property of
Bayesian networks more generally, holding even if all the Hilbert spaces are trivial. The
non-linear map Clone sends the density matrix-valued vector measure Ï to Ï âŠ—Ï.
This
cannot be implemented by any device that can be modelled by a Bayesian network since
such a network, no matter how complicated, altogether gives rise to a linear map on Ï by
the principle of linearity.
One may still consider something a cloning device if it does not always clone, but only
clones conditioned on a observation; for instance, suppose there is a green light for success
and a red light for failure. However, to be a cloning device, it must have a ï¬nite probability
of success for at least two distinct inputs, Âµ and Î½. By the principle of linearity, then every
convex combination tÂµ+(1âˆ’t)Î½ of the two has a ï¬nite probability for success. Now consider
the following graphical model:

	
-
-
cloning
device
testing
device
mlight
(6.1)
For the device to be cloning, then conditioning on the light being green, the joint probability
for the observations on the testing device must be the same as those for the graphical model

CHAPTER 6. FURTHER EXAMPLES
59
with the Clone map

	
-
-
Clone
testing
device
(6.2)
with the same corresponding data for the testing device for each model. For every possibility
of what is put in the dashed boxes and what the corresponding information is, there are some
linear maps L from D(H)-valued vector measures on X to D(H âŠ—H)-valued vector measures
on X Ã—X and K, M from the latter space to [0,1] such that the joint probability (conditioning
on the light being green) using the purported cloning device is (K â—‹L)Ï
(M â—‹L)Ï, whereas the joint
probability using the mathematical Clone map is KClone(Ï) = K(Ï Ã— Ï). With the above
assumption, (M â—‹L)(tÂµ + (1 âˆ’t)Î½)) â‰ 0; however, then we must have
(M â—‹L)(tÂµ + (1 âˆ’t)Î½)K((tÂµ + (1 âˆ’t)Î½) Ã— (tÂµ + (1 âˆ’t)Î½)) = (K â—‹L)(tÂµ + (1 âˆ’t)Î½)
(6.3)
for all t âˆˆ[0,1], which is impossible.
6.2
Teleportation-classical and quantum
Teleportation is also generally taken as a hallmark of quantum mechanics. However, as will
be shown, teleportation is also possible in classical hidden models.
A device is a teleportation device if, when modelled by a Bayesian network, for a ï¬xed set
X, base measure Âµ, Hilbert space H, and template density-matrix-valued function Ïƒ âˆˆL1(X Ã—
X;ÂµÃ—Âµ;D(HâŠ—H)+), it takes the product function ÏâŠ—Ïƒ âˆˆL1(X Ã—X Ã—X;ÂµÃ—ÂµÃ—Âµ;D(HâŠ—HâŠ—H)+)
back to Ï for any Ï âˆˆL1(X;Âµ;D(H)+) and where a splitter is used so only Alice gets the
(X,Âµ,H) that Ï lives on, Bob gets the ï¬nal Ï, and there are no hidden connections between
Alice and Bob, but only classic, observable information. Note that because the ï¬rst textbook
rule that the overall Hilbert space is the same throughout is unnecessary for the Bayesian
network formulation, there is no need to have another output from Alice (whose value is
irrelevant in the context of being a teleportation device)â€“this leads to simpliï¬cation in the
required calculations.
There is a Bayesian network for such a device using quantum nodes (based on, but
extending, the calculations of Bennett, Brassard, CrÂ´epeau, Josza, Peres, and Wootters [7])
if X = {1,2,...,m}, Âµ is the counting measure, H is Cn, and Ïƒ is the density-matrix-valued
function (written as a column vector with m2 entries, each a n2 Ã— n2-matrix) 1
m Vec Im âŠ—
(1
n Vec In ( Vec In)T). Note Ïƒ is the Kronecker product of Copy applied to the uniform

CHAPTER 6. FURTHER EXAMPLES
60
distribution with the usual maximally-entangled state. The graphical model is:

	

	

:
XXXXXX
z


 


m
   
QQQQQQQQQQQ
s

*
1
2
4
5
3
m
m
@
@
@
@
@
@@
R
@
@
@
@
@
@
@
?
Alice
Bob
teleportation
device
(6.4)
The double arrow indicates Bobâ€™s observations are identical to Aliceâ€™s (perfect communica-
tion). The information presented in the form according to the graphical model is:
node 1
(;{1,2,...,m}, counting
measure ,Cn;L1) where L1 is the constant map with value Ï.
node 2
(;{1,2,...,m} Ã— {1,2,...,m}, counting
measure ,Cn âŠ—Cn;L2) where L2 is the constant
map with value Ïƒ.
splitter 3
({1,2,...,m}Ã—3, counting
measure ,Cn3;
{1,2,...,m} Ã— {1,2,...,m}, counting
measure ,Cn âŠ—Cn,{1,2,...,m}, counting
measure ,Cn)
pince-nez 4
({1,2,...,m} Ã— {1,2,...,m}, counting
measure ,Cn âŠ—Cn;
{1,2,...,m} Ã— {1,2,...,n} Ã— {1,2,...,n}, counting
measure ;;L4)
Let â„¦be the n Ã— n-matrix with the nth roots of unity along its diagonal, S be the n Ã— n-
shift-matrix with a one in the upper-right corner and ones on the subdiagonal, and Q be
the m Ã— m-shift-matrix with a one in the upper-right corner and ones on the subdiagonal.
For k,l âˆˆ{1,2,...,n}, let wkl be the column vector (In âŠ—(â„¦lâˆ’1Skâˆ’1)) Vec In.
Then for
(j,k,l) âˆˆ{1,2,...,m} Ã— {1,2,...,n} Ã— {1,2,...,n}, L4(Ï„)jkl is given by
( Vec Qjâˆ’1)
T ((Im2 âŠ—wâˆ—
kl)Ï„(Im2 âŠ—wkl))
(6.5)

CHAPTER 6. FURTHER EXAMPLES
61
node 5
({1,2,...,m} Ã— {1,2,...,m} Ã— {1,2,...,n} Ã— {1,2,...,n}, counting
measure ,Cn;
{1,2,...,m}, counting
measure, Cn;L5)
The incoming density-matrix-valued function Ï„ will be considered as a mÃ—nÃ—n-array, indexed
by j,k,l, of column vectors of m entries each, where each entry is a n Ã— n-matrix. With this
convention, L5(Ï„) is given by
m
âˆ‘
j=1
n
âˆ‘
k,l=1
((Qjâˆ’1)T âŠ—In)((Im âŠ—(â„¦lâˆ’1(Skâˆ’1)T))Ï„jkl(Im âŠ—(Skâˆ’1â„¦
lâˆ’1))
(6.6)
Then, for any following testing device, the incoming density-matrix-valued function from
Bob if Alice observes (j,k,l) âˆˆ{1,2,...,m} Ã— {1,2,...,n} Ã— {1,2,...,n} is
L5 (((L4 âŠ—IB(L1(X;Âµ;H))))(L1 âŠ—L2))âˆ£j,k,l 1{(j,k,l)})
(6.7)
This apparently complicated expression is just Ï, regardless of which particular values of
j,k,l were observed by Alice and sent to Bob.
The classical case
Note the preceding is meaningful for the case of trivial Hilbert space, n = 1, so teleportation
is not a quantum phenomenon. Another way to achieve the same output in this purely-
classical case is to not have a template shared by Alice and Bob, but rather to have the
pince-nez for Alice have simply the identity for its map (so the hidden node is not really
hidden, but is actually observable). Then Alice sends her information to Bob, who makes
a copy using the information. Finally, Alice and Bob forget what the information was (so
their nodes are marginalized). The result is that the incoming probability distribution to
Alice is the same as that outgoing from Bob.
However, this second approach is not teleportation because of the forgetting step. Also,
for the classical case of the teleportation given above, an eavesdropper to the information
sent from Alice to Bob without access to the template cannot replicate the probability
distribution, whereas in the second, non-teleportation approach, the eavesdropper could not
only replicate the probability distribution by making his own copy, then forgetting, but by
not forgetting, would actually have more information.
Does a teleportation device really teleport?
Note the graphical model for the teleportation device is simply a graph fragment since the
output from Bob is not terminated. One may hope its behavior is universal, but is always

CHAPTER 6. FURTHER EXAMPLES
62
possible that additional testing will reveal it is not.
For instance, before the discovery
of quantum mechanics, it may have been believed that the classical teleportation discussed
above was â€œtrueâ€ teleportation. It is possible that additional mathematical structures besides
measures and density matrices (see Â§3.8 above) can be used to calculate probabilities in
Bayesian networks and that these are found to be useful in practiceâ€“then the current belief
that quantum telportation is â€œtrueâ€ teleportation will also be shown false.
6.3
Bellâ€™s inequality for Bayesian networks without
metaphysical limitations
Introduction
The standard proofs of Bellâ€™s inequality [6] make assumptions based on assuming the un-
derlying reality of hidden variables, which in our language is equivalent to the existence of
transition probability function. As we explored in Â§2.2, this is a metaphysical notion for
hidden nodes. For our Bayesian networks, no such limitation is placed, which enlarges the
space of possible maps that can be employed. Although, as we already mentioned in Â§2.2,
these additional maps are not necessarily of great interest, we would like to show that Bellâ€™s
inequality still necessarily holds.
Set-up
Following Clauser, Horne, Shimony, and Holt [15], consider the case of two observers, Alice
and Bob, who are at distant locations. Each has a box, connected by a long cable to the
other, with a dial and two lights, marked zero and one, which light periodically.
They
record their observations, then come together later to compare notes. They ï¬nd that the
ï¬‚ashes are independent in time and depend on the settings of the dial, Î± for Alice and Î² for
Bob, but for each round the lights they each saw were not independent of each other, but
had a joint probability distribution given by the four functions of Î±,Î²: Prob((0,0)âˆ£Î±,Î²),
Prob((0,1)âˆ£Î±,Î²), Prob((1,0)âˆ£Î±,Î²), and Prob((1,1)âˆ£Î±,Î²). Presenting the information in
this manner corresponds to the graphical model:
m
B
B
B
B
B
BBm
}
}
hh
h
e
e
e
e
e
ee








Alice
Bob
Î±
Î²
(6.8)

CHAPTER 6. FURTHER EXAMPLES
63
There are the additional no-signalling constraints on the probabilities arising from relativity:
Prob((0,0)âˆ£Î±,Î²) + Prob((0,1)âˆ£Î±,Î²) is independent of Î²
(6.9)
Prob((1,0)âˆ£Î±,Î²) + Prob((1,1)âˆ£Î±,Î²) is independent of Î²
Prob((0,0)âˆ£Î±,Î²) + Prob((1,0)âˆ£Î±,Î²) is independent of Î±
Prob((0,1)âˆ£Î±,Î²) + Prob((1,1)âˆ£Î±,Î²) is independent of Î±
If these constraints were not met, then Alice and Bob could use their dial settings to trans-
mit information superluminally. However, relativity places no additional constraint on the
bounds for the value of, for Î±,Î±â€² two settings of Aliceâ€™s dial and Î²,Î²â€² two settings of Bobâ€™s
dial,
Prob((0,0)âˆ£Î±,Î²) + Prob((1,1)âˆ£Î±,Î²) âˆ’Prob((0,1)âˆ£Î±,Î²) âˆ’Prob((1,0)âˆ£Î±,Î²)
(6.10)
+Prob((0,0)âˆ£Î±â€²,Î²) + Prob((1,1)âˆ£Î±â€²,Î²) âˆ’Prob((0,1)âˆ£Î±â€²,Î²) âˆ’Prob((1,0)âˆ£Î±â€²,Î²)
+Prob((0,0)âˆ£Î±,Î²â€²) + Prob((1,1)âˆ£Î±,Î²â€²) âˆ’Prob((0,1)âˆ£Î±,Î²â€²) âˆ’Prob((1,0)âˆ£Î±,Î²â€²)
âˆ’Prob((0,0)âˆ£Î±â€²,Î²) âˆ’Prob((1,1)âˆ£Î±â€²,Î²) + Prob((0,1)âˆ£Î±â€²,Î²) + Prob((1,0)âˆ£Î±â€²,Î²)
which can still achieve its bound in magnitude arising from the rules of probability, namely
four.
The standard hidden variable approach
A suï¬ƒcient way to insure the restrictions from relativity are met is to restrict the possible
graphical model to the local model:
m

1
XXXXXXXXXXX
z
m
m
}
}
-

:
Alice
Bob
Î±
Î²
(6.11)
Then, if the space of values for the marginalized node is X and its probability measure is Ï,
the joint probability both Alice and Bob get 1 is
âˆ«xâˆˆX Prob(1 for Aliceâˆ£Î±,x)Prob(1 for Bobâˆ£Î²,x) dÏ(x)
(6.12)
with the other joint probabilities given similarly. Using the standard approach for Bellâ€™s
inequality [15], it can be shown that for the combination of probabilities in (6.10), the
bound on its magnitude has now been reduced to two.

CHAPTER 6. FURTHER EXAMPLES
64
Using classical hidden nodes
A suï¬ƒcient way to insure the restrictions from relativity are met using classical hidden nodes
is to restrict the possible graphical model to to the local model:

	






 
- 

3
PPPPPPPP
q
1
4
2
3
m
m
}
}
XX
X
z

:
Alice
Bob
Î±
Î²
(6.13)
The boxes are drawn around the two separate locations to indicate these are potentially
universal modules.
Theorem 6.3.1
Employing either option I or II, Bellâ€™s inequality still holds.
Proof
Using option II, by the Riesz theorem [78], each Prob((j,k)âˆ£Î±,Î²) is necessarily of
the form
âˆ«YÃ—Z fj(y;Î±)gk(z;Î±) dÂµ(y,z)
(6.14)
for some positive, continuous functions f1,f2,g1,g2 with f1 + f2 = 1YÃ—[0,2Ï€), g1 + g2 = 1ZÃ—[0,2Ï€)
and some unit-norm, Radon measure Âµ on Y Ã— Z. This is mathematically the same form
as (6.12), if lacking the interpretation in terms of conditional probabilities and probability
measures, so the standard argument [15] still applies with bound two for (6.10).
Using option I, each Prob((j,k)âˆ£Î±,Î²) is necessarily of the form
(L2 âŠ—L3)(Âµ Ã— Ï Ã— Î½)({(j,k)})
(6.15)
where Âµ is some unit-norm measure on [0,2Ï€) concentrated about Î± from a collection of
measures M5, Î½ is some unit-norm measure on [0,2Ï€) concentrated about Î² from the same
collection of measures, Ï is some unit-norm measure on YÃ—Z from some collection of measures
M4, L2 is a norm-preserving (on the positive cone) map from measures on [0,2Ï€) Ã— Y
in some collection of measures M2 to measures on {0,1} with set algebra the power set
{âˆ…,{0},{1},{0,1}}, and L3 is a norm-preserving (on the positive cone) map from measures
on Z Ã— [0,2Ï€) in some collection of measures M3 to measures on {0,1} with set algebra the
power set {âˆ…,{0},{1},{0,1}}. From the rules for option I, all the collections of measures are
absolutely-continuous-complete and are such that L2âŠ—L3 is well-deï¬ned. However, by A1.2,

CHAPTER 6. FURTHER EXAMPLES
65
A1.3, B1.3, B1.4, and B2.5, this implies the bound can be established just be considering
Prob((j,k)âˆ£Î±,Î²) of the form
(L2 âŠ—L3)(âˆ‘
l
Ï„l Ã— Ïƒl)({(j,k)})
(6.16)
where âˆ‘l Ï„l Ã— Ïƒl is a unit-norm, ï¬nite-tensor-rank measure in M2 âŠ—M3. Using this form for
Prob((j,k)âˆ£Î±,Î²), the usual bound of two readily follows for (6.10). â—»
Comments
Using the well-known quantum model of Clauser, Horne, Shimony, and Holt [15] (which
reuses some of the modules from the double-slit experiment (see Â§4.5) in a diï¬€erent arrangementâ€“
an example of universality), it is possible to violate Bellâ€™s inequality and the combination of
probabilities in (6.10) can even achieve Tsirelsonâ€™s bound of 2
âˆš
2 [14]. Any classical hidden
model duplicating these results must be nonlocal; hence, contextualâ€“certainly the modules
we used for the classical hidden model for the double slit experiment (see Â§4.7) would be of
no use.
We then have the question of whether Tsirelsonâ€™s bound can be broken.
This may
be possible if there are additional mathematical structures besides measures and density
matrices that can be utilized in Bayesian networks while respecting the principles of positivity
and potential universality (see Â§3.8 above).

66
Part II
Parrondoâ€™s paradox and a
Parrondo-like paradox

67
Chapter 7
Parrondoâ€™s paradox
7.1
Deï¬ning the paradox
Suppose a two-player (or one-player versus the house) repeated game wins with probability
greater than one-half for one player as does a second repeated game. Naively, it may seem
that the convex combination of the two games using a (possibly biased) coin to determine
which rule to employ for each round must also win for that player. However, it is possible
that this combined game actually wins with probability greater than one-half for the second
player. This paradoxical result is termed Parrondoâ€™s paradox [64].
Criteria for winning
While this paradox is displayed for several diï¬€erent winning criteria (see [28] for instance),
here the following very simple criteria will be employed for all the following games: in total,
n rounds of a game with observation set R are played. Let E be the Ïƒ-algebra of observable
events for each round. For a ï¬xed set A âˆˆE, if the state is in A at the nth round, the ï¬rst
player (call her Alice) wins; otherwise, the second player (call him Bob) winsâ€“regardless of
what was observed at the preceding rounds. (For one traditional formulation of Parrondoâ€™s
paradox, X = Z, E is its power set, and A = Z+. [64]) It is easy to see the applicability of this
criterion for many diï¬€erent real-life situationsâ€“for instance, the diï¬€erence of scores in sports
games or stock options in ï¬nance.

CHAPTER 7. PARRONDOâ€™S PARADOX
68
7.2
Classical observed Markov chain game
Deï¬ning the game
Following the traditional method for Bayesian networks, the graphical model for the Markov
chain game is:
k
k
k
1
2
3
-
-
- â‹¯â‹¯
- k
n
(7.1)
Let Âµ be the initial marginal probability measure. For the subsequent nodes, take all the
transition probability functions to be the same Ï„(â‹…âˆ£â‹…). The joint probability to observe out-
comes (x1,x2,...,xn) âˆˆA1 Ã— A2 Ã— â‹¯Ã— An, for any A1,A2,...,An âˆˆE, is then
(RAn â—‹L â—‹â‹¯â—‹RA2 â—‹L â—‹RA1Âµ)(X)
(7.2)
for L the map induced by Ï„(â‹…âˆ£â‹…) (see 2.15) and RA the restriction map (see Â§2.5). Then the
probability to observe the system has state in A at the nth round (so Alice wins), denoted
PA,n, is given by
(RA â—‹L â—‹â‹¯â—‹L
Â´Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¸Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¶
nâˆ’1
Âµ)(X)
(7.3)
In the common case where the events E are generated by a ï¬nite number of sets, the transition
probability functions are stochastic transition matrices, the initial measure is a stochastic
column vector, and the maps are given by having the matrices act on the vector in the usual
matrix product.
Combining two games
Now suppose we have a second game with the same structure, but a diï¬€erent transition
probability function for each round, Ï„ â€²(â‹…âˆ£â‹…) (there can also be a diï¬€erent initial marginal
probability, but that will be of no consequence for the limit we will take). The probability
to observe the system has its state in A at the nth round is denoted P â€²
A,n. The two games
can be combined by ï¬‚ipping a (possibly biased) coin at each round, playing according to the
ï¬rst game if the coin is heads, which occurs with probability p, and according to the second
if the coin is tails, which occurs with probability 1âˆ’p. The graphical model for the combined
game is:
k
k
k
1
2
3
-
-
- â‹¯â‹¯
- k
n
k
k
k
B
B
BBN
B
B
BBN
B
B
BBN
heads,tails heads,tails
heads,tails
(7.4)

CHAPTER 7. PARRONDOâ€™S PARADOX
69
For the combined game, the transition probability function for each round is
Ï„(â‹…âˆ£â‹…,c) =
â§âªâªâ¨âªâªâ©
Ï„(â‹…âˆ£â‹…)
if c = heads
Ï„ â€²(â‹…âˆ£â‹…)
if c = tails
(7.5)
Let Mc be the map induced by Ï„(â‹…âˆ£â‹…,c). The marginal probability to then observe the system
is in A for the nth round, denoted P comb
A,n , is then
âˆ‘
c2âˆˆ{ heads
tails
}
â‹¯
âˆ‘
cnâˆˆ{ heads
tails
}
(
n
âˆ
k=1
Prob(ck))(RAâ—‹Mcn â—‹â‹¯â—‹Mc2Âµ)(X) = (RAâ—‹Lâ€²â€² â—‹â‹¯â—‹Lâ€²â€²
Â´Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¸Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¶
nâˆ’1
Âµ)(X) (7.6)
for Lâ€²â€² the map induced by Ï„ â€²â€²(â‹…âˆ£â‹…) = pÏ„(â‹…âˆ£â‹…) + (1 âˆ’p)Ï„ â€²(â‹…âˆ£â‹…).
Note that we have a convex
combination of maps, Lâ€²â€² = pL + (1 âˆ’p)Lâ€².
Bounds on the extent of the paradox
Let p be the probability for the coin to give heads. Then, for p âˆˆ(0,1), one may expect the
probability for Alice to win the combined game would necessarily be between the probabilities
for the individual games, with
min{PA,n,P â€²
A,n} < P comb
A,n
< max{PA,n,P â€²
A,n}
(7.7)
if PA,n â‰ P â€²
A,n and P comb
A,n
= PA,n = P â€²
A,n if PA,n = P â€²
A,n. Parrondoâ€™s paradox is that not only is
that expectation false, but it is possible for Alice to have probability greater than one-half
of winning each of the individual games, yet less than one-half for the combined game.
In the common case where the events E are generated by a ï¬nite number of sets, the
Perron-Frobenius theorem [114] [61] gives the conditions on L for there to be a stochastic
vector Î½, termed the Perron-Frobenius eigenvector1, such that the sequence âŸ¨LjÎ½0âŸ©converges
in norm to Î½ regardless of the initial stochastic vector Î½0. By generalization, we introduce
the following deï¬nition:
Deï¬nition 7.2.1
A linear map L from F-measures on X to F-measures on a set X has the
Perron-Frobenius property, PF(X,E), if there is a measure Î½, termed the Perron-Frobenius
eigenvector, such that the sequence âŸ¨LjÎ½0âŸ©converges in total-variation norm to Î½ regardless
of the initial unit-norm measure Î½0.
Now assume the transition probability functions Ï„ and Ï„ â€² are such that induced maps L and
Lâ€² each are in PF(X;E), as well is their convex combination, pL + (1 âˆ’p)Lâ€². Then let PA,
P â€²
A, and P comb
A
be the limits as n â†’âˆof PA,n, P â€²
A,n and P comb
A,n
respectively. We then have
the question of what values of (PA,P â€²
A,P comb
A
) âˆˆ[0,1]Ã—3 occur.
1Also termed the invariant probability distribution [25], the steady-state probability vector [50], or the
invariant measure [62] in the literature.

CHAPTER 7. PARRONDOâ€™S PARADOX
70
Deï¬nition 7.2.2
The classically allowed region, denoted C(A,X,E,p), is the set of all
(PA,P â€²
A,P comb
A
) âˆˆ[0,1]Ã—3 that occur, for ï¬xed A, X, E, and p, over all possible transition
probability functions Ï„ and Ï„ â€².
The existence of the paradox is then determined by the intersection of C with the cube
( 1
2,1] Ã— ( 1
2,1] Ã— [0, 1
2). For p = 1, P comb
A
= PA and for p = 0, P comb
A
= P â€²
A; clearly no paradox
is possible. We have the following theorems for p âˆˆ(0,1), which indicate that there are
basically only two possibilities, depending on whether we have eï¬€ectively a two-state system
or one with more than two states, as determined by the event Ïƒ-algebra E.
Theorem 7.2.3
For p âˆˆ(0,1), if there are nonempty, disjoint subsets A,B,C âˆˆE with
A âˆªB âˆªC = X, then C âŠƒ(0,1)Ã—3.
Proof
Fix any PA,P â€²
A âˆˆ(0,1). Then take any Îµ > 0 suï¬ƒciently small such that both the
matrices
T =
â¡â¢â¢â¢â¢â¢â¢â£
1 âˆ’(1 âˆ’s)Îµ âˆ’( 1
PA âˆ’1 âˆ’Îµ)Îµ2
Îµ2
1 âˆ’s
( 1
PA âˆ’1 âˆ’Îµ)Îµ2
1 âˆ’
PAsÎµ
1âˆ’(1+Îµ)PA âˆ’Îµ2
s
(1 âˆ’s)Îµ
PAsÎµ
1âˆ’(1+Îµ)PA
0
â¤â¥â¥â¥â¥â¥â¥â¦
(7.8)
Tâ€² =
â¡â¢â¢â¢â¢â¢â¢â£
1 âˆ’
1âˆ’P â€²
A
P â€²
A Îµ2
Îµ2
1
2
1âˆ’P â€²
A
P â€²
A Îµ2
1 âˆ’Îµ2
1
2
0
0
0
â¤â¥â¥â¥â¥â¥â¥â¦
are stochastic matrices for all values of s âˆˆ[0,1]. Take the transition probability functions
to be
â¡â¢â¢â¢â¢â¢â£
Ï„(Aâˆ£x âˆˆA)
Ï„(Aâˆ£x âˆˆB)
Ï„(Aâˆ£x âˆˆC)
Ï„(Bâˆ£x âˆˆA)
Ï„(Bâˆ£x âˆˆB)
Ï„(Bâˆ£x âˆˆC)
Ï„(Câˆ£x âˆˆA)
Ï„(Câˆ£x âˆˆB)
Ï„(Câˆ£x âˆˆC)
â¤â¥â¥â¥â¥â¥â¦
= T
(7.9)
â¡â¢â¢â¢â¢â¢â£
Ï„ â€²(Aâˆ£x âˆˆA)
Ï„ â€²(Aâˆ£x âˆˆB)
Ï„ â€²(Aâˆ£x âˆˆC)
Ï„ â€²(Bâˆ£x âˆˆA)
Ï„ â€²(Bâˆ£x âˆˆB)
Ï„ â€²(Bâˆ£x âˆˆC)
Ï„ â€²(Câˆ£x âˆˆA)
Ï„ â€²(Câˆ£x âˆˆB)
Ï„ â€²(Câˆ£x âˆˆC)
â¤â¥â¥â¥â¥â¥â¦
= Tâ€²
Then the required calculations reduce to matrix products. Since the maps are assumed to
have the Perron-Frobenius property, the initial probabilities chosen for A, B, and C are
irrelevant.
By the deliberate construction of T and Tâ€², the ï¬rst entry of the Perron-Frobenius
eigenvector of T is indeed PA for every s âˆˆ[0,1] and the ï¬rst entry of the Perron-Frobenius
eigenvector of Tâ€² is indeed P â€²
A. The ï¬rst entry of the Perron-Frobenius eigenvector of pT +

CHAPTER 7. PARRONDOâ€™S PARADOX
71
(1 âˆ’p)Tâ€², which gives P comb
A
, varies continuously2 from
Îµ
p(1âˆ’p)
2
+ Îµ( p
PA + 1âˆ’p
P â€²
A )
= O(Îµ)
(7.10)
to
1
1 +
2Îµ( 1
PA âˆ’1 âˆ’Îµ + Îµp)( p
PA + 1âˆ’p
P â€²
A âˆ’1 âˆ’Îµp)
p(1 âˆ’p) + 2Îµ( 1
PA âˆ’1 âˆ’Îµ)
= 1 âˆ’O(Îµ)
(7.11)
as s goes from zero to one. Since Îµ may be taken arbitrarily small, every value for P comb
A
âˆˆ
(0,1) is in the allowed region for the ï¬xed values of PA and P â€²
A. â—»
Theorem 7.2.4
If E = {âˆ…,A, ËœA,X}, then C is given by (7.7), so the paradox cannot occur.
Proof
Deï¬ne the stochastic matrix S by
S = [ Ï„(Aâˆ£x âˆˆA)
Ï„(Aâˆ£x âˆˆËœA)
Ï„( ËœAâˆ£x âˆˆA)
Ï„( ËœAâˆ£x âˆˆËœA) ]
(7.12)
and the stochastic matrix Sâ€² by
Sâ€² = [ Ï„ â€²(Aâˆ£x âˆˆA)
Ï„ â€²(Aâˆ£x âˆˆËœA)
Ï„ â€²( ËœAâˆ£x âˆˆA)
Ï„ â€²( ËœAâˆ£x âˆˆËœA) ]
(7.13)
For ï¬xed PA,P â€²
A âˆˆ(0,1], express S and Sâ€² as
S = [ 1 âˆ’( 1
PA âˆ’1)Î¶
Î¶
( 1
PA âˆ’1)Î¶
1 âˆ’Î¶ ],Sâ€² =
â¡â¢â¢â¢â¢â£
1 âˆ’( 1
P â€²
A âˆ’1)Î¾
Î¾
( 1
P â€²
A âˆ’1)Î¾
1 âˆ’Î¾
â¤â¥â¥â¥â¥â¦
(7.14)
for Î¶ âˆˆ(0,min{ PA
1âˆ’PA,1}] and Î¾ âˆˆ(0,min{
P â€²
A
1âˆ’P â€²
A,1}].
By the deliberate construction of S
and Sâ€², the ï¬rst entry of the Perron-Frobenius eigenvector of S is indeed PA for every Î¶
and the ï¬rst entry of the Perron-Frobenius eigenvector of Sâ€² is indeed P â€²
A for every Î¾. For
PA â‰ P â€²
A, the ï¬rst entry of the Perron-Frobenius eigenvector of pS + (1 âˆ’p)Sâ€², which gives
P comb
A
, varies continuously in the interval (min{PA,P â€²
A},max{PA,P â€²
A}) as Î¶,Î¾ vary over their
allowed values, approaching the extreme values only as either Î¶ or Î¾ go to zero since it is a
linear rational function in Î¶ and Î¾. For PA = P â€²
A, P comb
A
shares this common value for all Î¶,Î¾.
For PA = 0, P â€²
A âˆˆ(0,1], express S as [ 1 âˆ’Î¶
0
Î¶
1 ] for Î¶ âˆˆ(0,1] and Sâ€² as above. Then the
ï¬rst entry of the Perron-Frobenius eigenvector of S is PA = 0 for every Î¶. The ï¬rst entry
2The eigenvectors of a matrix are continuous functions of the entries of the matrix in any open set where
the eigenvalues are distinct.

CHAPTER 7. PARRONDOâ€™S PARADOX
72
of the Perron-Frobenius eigenvector of pS + (1 âˆ’p)Sâ€², which gives P comb
A
, varies continuously
in the interval (0,P â€²
A) as Î¶,Î¾ vary over their allowed values, approaching the bounds as
either Î¶ or Î¾ go to zero. The symmetric situation holds for P â€²
A = 0, PA âˆˆ(0,1]. Finally, for
PA = P â€²
A = 0, express S as [ 1 âˆ’Î¶
0
Î¶
1 ] for Î¶ âˆˆ(0,1] and Sâ€² as [ 1 âˆ’Î¾
0
Î¾
1 ] for Î¾ âˆˆ(0,1]. Then
P comb
A
= 0 for all Î¶,Î¾. â—»
Understanding the cause of the paradox
While surprising when approached from the game context, mathematically the cause of the
paradox is straightforward: the coeï¬ƒcients of the Perron-Frobenius eigenvector of a convex
combination of two matrices, M1,M2 â†’tM1 + (1 âˆ’t)M2, need not be in the convex hull
of the coeï¬ƒcients of the Perron-Frobenius eigenvectors of each matrix. Large discrepancies
are possible for certain slivers of parameter values near where eigenvalues coalesce and the
resulting eigenvectors are discontinuous functions of the parameters.
A similar cause is at play in the following analogous hidden classic and quantum versions
of the preceding game. In each case, there is a convex space of matrices of spectral radius
one determining the behavior of the system. A coin ï¬‚ip determining the rule to employ for
the next round has the eï¬€ect of forming a convex combination of the matrices for each rule.
In the limit as the number of rounds goes to inï¬nity, only the eigenvector of the matrix with
eigenvalue one is of importance, but the coeï¬ƒcients for this eigenvector are not in the convex
hull of the coeï¬ƒcients of the eigenvectors of each matrix, leading to the paradox.
7.3
Classical hidden-Markov chain game
Deï¬ning the combined game
As will be proved below, it is possible to have Parrondoâ€™s paradox with a game for a system
with two states if the system is hidden. The game arises from a generalization of the of
the commonly utilized hidden-Markov model [38] to include imagined back-reaction on the
hypothesized hidden state. The standard graphical model (with hidden nodes in gray) is:
k
k
k
k
k
-
-
-
-â‹¯â‹¯
-























k
k
k
k
1
2
3
n
J
J
JJ^
J
J
JJ^
J
J
JJ^
(7.15)
However, as has been mentioned in Â§2.2, this requires interpreting probabilities and/or condi-
tional probabilities concerning unobservable events, which are meaningless in both Bayesian
and frequentist interpretations of probability. Also, this approach has no analogy in the
quantum case.

CHAPTER 7. PARRONDOâ€™S PARADOX
73
Therefore, following the program we have laid out in the ï¬rst part of this dissertation,
the information for hidden nodes can simply be regarded as linear maps on measures, which
is preferable in both avoiding metaphysical notions and in having analogous meaning in the
quantum case. (As has been mentioned in Â§2.2, this may allow additional maps which do
not arise from transition probability functions, but these are not of great interest and are
not an important motivation for making the change.) Using the pince-nez construction (see
Â§4.1), this becomes:


k
k
k
k


-
-
â‹¯
-
-
-
k
k
k
k
1
2
n âˆ’1
n
(7.16)
Employing option Iâ€™ (the results can be readily recast for option II or more general forms of
option Iâ€“see Â§3.2), we have the following deï¬nition:
Deï¬nition 7.3.1
A hidden-Markov-with-back-reaction-model (R, Ï„, H, Âµ, L, Î½0) is com-
posed of: an observation set R with base measure Î·, a hidden set H with base measure Âµ,
a pince-nez map L âˆˆB (L1(H;Âµ),L1(R Ã— H;Î· Ã— Âµ)), and an initial, unit-norm measure Î½0 on
H that is absolutely continuous with respect to Âµ.
Then the joint probability to observe (x1,x2,...,xn) âˆˆA1Ã—A2Ã—â‹¯Ã—An, for any Î·-measurable
A1,A2,...,An, is
âˆ«H (SAn â—‹L â—‹â‹¯â—‹SA1 â—‹LdÎ½0
dÂµ )dÂµ
(7.17)
for SA the linear map from L1(R Ã— H;Î· Ã— Âµ) to L1(H;Âµ) given by the partial integration
SAf = âˆ«A f dÎ·. Employing this model for the game, then the marginal probability for the
observation to be in A at the nth round (so Alice wins) is
PA,n = âˆ«H
â›
âœ
â
SA â—‹L â—‹N â—‹â‹¯â—‹N
Â´Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¸Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¶
nâˆ’1
dÎ½0
dÂµ
â
âŸ
â 
dÂµ
(7.18)
where N âˆˆB (L1(H;Âµ)) is deï¬ned as the map N = SR â—‹L. Because of the deï¬nition of
the game, it is possible to reduce to the case where the event space for R is simply E =
{âˆ…,A, ËœA,X} and its base measure Î· is the measure with Î·(A) = Î·( ËœA) = 1.
Now suppose there is a second model with the same data except for a diï¬€erent pince-nez
Lâ€² for each round (it is also possible to have a diï¬€erent initial measure, but since the limit
as n â†’âˆwill be taken, this is of no consequence). Once again, the two models can be

CHAPTER 7. PARRONDOâ€™S PARADOX
74
combined by ï¬‚ipping a (possibly biased) coin at each round. The graphical model is:


k
k
k
k


-
-
-
â‹¯
-
-
k
k
k
k
1
2
n âˆ’1
n
k
k
k
k
C
CCW
C
CCW
C
CCW
C
CCW
{heads,tails} {heads,tails} {heads,tails} {heads,tails}
(7.19)
Let Î³ be the previously given probability measure for the coin of p for heads and 1 âˆ’p for
tails, with base measure the counting measure. For simplicity of notation, we will identify Î³
with its Radon-NikodÂ´ym derivative
dÎ³
dcount. For the combined game, the map for each round
is
M(f âŠ—Î³) = pLf + (1 âˆ’p)Lâ€²f = Lâ€²â€²f
(7.20)
for Lâ€²â€² = pL+(1âˆ’p)Lâ€². Let N â€²,N â€²â€² âˆˆB (L1(H;Âµ)) be deï¬ned using Lâ€²,Lâ€²â€² as N was following
(7.18), N â€² = SR â—‹Lâ€² and N â€²â€² = SR â—‹Lâ€²â€². Then the marginal probability for the observation to
be in A for the nth round (so Alice wins) is
P comb
n
= âˆ«H SA â—‹M (â‹¯(SR â—‹M ((SR â—‹M dÎ½0
dÂµ ) âŠ—Î³)) âŠ—Î³â‹¯)dÂµ
(7.21)
= âˆ«H
â›
âœ
â
SA â—‹Lâ€²â€² â—‹N â€²â€² â—‹â‹¯â—‹N â€²â€²
Â´Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¸Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¶
nâˆ’1
dÎ½0
dÂµ
â
âŸ
â 
dÂµ
Bounds on the extent of the paradox
One may expect the paradox to be present to an equal or greater degree for this more general
class of games. This is indeed the case, as is seen by comparing the statements of theorem
7.2.3 and 7.2.4 with the following theorem 7.3.3 and 7.3.4. Restrict the space of pince-nez
maps to those where N,N â€²,N â€²â€² = pN + (1 âˆ’p)N â€² all have the Perron-Frobenius property,
where N,N â€²,N â€²â€² âˆˆB (L1(H;Âµ)) are deï¬ned from L,Lâ€²,Lâ€²â€² as above. Then, once again, let
PA, P â€²
A, and P comb
A
be the limits as n â†’âˆof PA,n, P â€²
A,n and P comb
A,n
respectively.
Deï¬nition 7.3.2
The classical-hidden allowed region, denoted CH(A,R,Î·,H,Âµ,p), is the
set of all (PA,P â€²
A,P comb
A
) âˆˆ[0,1]Ã—3 that occur, for ï¬xed A, R, Ï„, H, Âµ, and p, over all allowed
pince-nez maps L and Lâ€².
As in the classical observed case, the existence of the paradox is then determined by the
intersection of CH with the cube ( 1
2,1] Ã— ( 1
2,1] Ã— [0, 1
2). For p = 1, P comb
A
= PA and for p = 0,
P comb
A
= P â€²
A; clearly no paradox is possible. We have the following theorems for p âˆˆ(0,1),
which indicate that, once again, there are basically only two possibilities, depending on
whether we have eï¬€ectively a two-state hidden system or one with more than two states, as
determined by the hidden base measure Âµ.

CHAPTER 7. PARRONDOâ€™S PARADOX
75
Theorem 7.3.3
For p âˆˆ(0,1), if there are disjoint, Âµ-measurable subsets B,C,D with
B âˆªC âˆªD = H and Âµ(B), Âµ(C), and Âµ(D) all strictly positive, then CH âŠƒ(0,1)Ã—3.
Proof
Pick any Îµ > 0 and let Îº be the map from L1(H;Âµ) to R3 given by
Îº(f) =
â¡â¢â¢â¢â¢â¢â£
âˆ«B f dÂµ
âˆ«C f dÂµ
âˆ«D f dÂµ
â¤â¥â¥â¥â¥â¥â¦
(7.22)
Let hB, hC, and hD be unit-norm functions in L1(B;Âµ)+, L1(C;Âµ)+, and L1(D;Âµ)+ respec-
tively, each extended to all of H by zero. Such functions certainly exist by the Ïƒ-ï¬niteness
of Âµ. Then deï¬ne the pince-nez maps L and Lâ€² by
Lf = 1A âŠ—([ hB
0
0 ]TÎº(f)) + 1 Ëœ
A âŠ—([ 0
hC
hD ]TÎº(f))
(7.23)
Lâ€²f = 1A âŠ—([ hB
0
0 ]Tâ€²Îº(f)) + 1 Ëœ
A âŠ—([ 0
hC
hD ]Tâ€²Îº(f))
for T,Tâ€² as in theorem 7.2.3. Because of the properties of B, C, D, hB, hC, hD, and Îº, the
required calculation reduces to matrix products.
Then, by the deliberate construction of the maps, the row vector
[ 1
1
1 ]T
â¡â¢â¢â¢â¢â¢â£
1
0
0
0
0
0
0
0
0
â¤â¥â¥â¥â¥â¥â¦
= [ 1
0
0 ]
(7.24)
acting on the Perron-Frobenius eigenvector of T is its the ï¬rst entry, which is indeed PA for
every s âˆˆ[0,1]. Similarly, [ 1
0
0 ]Tâ€² acting on the Perron-Frobenius eigenvector of Tâ€² is
its ï¬rst entry, which is indeed P â€²
A. For the combined game, P comb
A
is given by the row vector
[ 1
1
1 ](pT + (1 âˆ’p)Tâ€²)
â¡â¢â¢â¢â¢â¢â£
1
0
0
0
0
0
0
0
0
â¤â¥â¥â¥â¥â¥â¦
= [ 1
0
0 ]
(7.25)
acting on the Perron-Frobenius eigenvector of pT + (1 âˆ’p)Tâ€², which is once again its ï¬rst
entry. As in theorem 7.2.3, this varies continuously from 0+O(Îµ) to 1âˆ’O(Îµ) as Î¶ goes from
zero to one. Since Îµ may be taken arbitrarily small, every value for P comb
A
âˆˆ(0,1) is in the
allowed region for the ï¬xed values of PA and P â€²
A. â—»
Theorem 7.3.4
For p âˆˆ(0,1),if the base measure Âµ is such that there is a Âµ-measurable
subset B with Âµ(B) and Âµ( ËœB) both strictly positive, but the conditions of the preceding
theorem do not hold, then CH(p) is given by the relatively open region
min{pPA,(1 âˆ’p)P â€²
A} < P comb
A
< max{1 âˆ’p + pPA,p + (1 âˆ’p)P â€²
A}

CHAPTER 7. PARRONDOâ€™S PARADOX
76
Proof
Represent measures Î½ on H absolutely continuous with respect to Âµ by column
vectors with column sum one, [ Î½(B)
Î½( ËœB) ]. Then all the linear maps from L1(H;Âµ) to L1(H;Âµ)
are represented by 2 Ã— 2-matrices acting by the usual matrix product.
Firstly, we will show that CH(p) contains the given region. Fix any PA,P â€²
A âˆˆ(0,1]. Then
take any Îµ > 0 suï¬ƒciently small such that the matrix
N = [ 1 âˆ’( 1
PA âˆ’1)Îµ
Îµ
( 1
PA âˆ’1)Îµ
1 âˆ’Îµ ]
(7.26)
is stochastic. Let
L = 1A âŠ—[ 1 âˆ’( 1
PA âˆ’1)Îµ
0
( 1
PA âˆ’1)Îµ
0 ] + 1 Ëœ
A âŠ—[ 0
Îµ
0
1 âˆ’Îµ ]
(7.27)
and, for s âˆˆ[0,1],
N â€² = [
1
2(1 + s)
1
2s
1
2(1 âˆ’s)
1 âˆ’1
2s ],Lâ€² = P â€²
A1A âŠ—N â€² + (1 âˆ’P â€²
A)1 Ëœ
A âŠ—N â€²
(7.28)
Then [ 1
1 ]SAâ—‹L = [ 1
0 ] acting on the Perron-Frobenius eigenvector of N is its ï¬rst
entry, which is indeed PA by the deliberate construction of the maps. Similarly, [ 1
1 ]SAâ—‹
Lâ€² = P â€²
A [ 1
1 ] acting on the Perron-Frobenius eigenvector of N â€² is indeed P â€²
A for all s. For
the combined game, P comb
A
is given by
[ 1
1 ]SA â—‹(pL + (1 âˆ’p)Lâ€²) = p[ 1
0 ] + (1 âˆ’p)P â€²
A [ 1
1 ]
(7.29)
acting on the Perron-Frobenius eigenvector of pN + (1 âˆ’p)N â€².
This varies continuously
from (1 âˆ’p)P â€²
A + O(Îµ) to p + (1 âˆ’p)P â€²
A âˆ’O(Îµ) as s goes from zero to one. Since Îµ may be
taken arbitrarily small, every value in the interval ((1 âˆ’p)P â€²
A,p + (1 âˆ’p)P â€²
A) can be taken
by P comb
A
for the ï¬xed values of PA and P â€²
A. Repeating the process with primedâ†”unprimed
and p â†”1 âˆ’p, every value in the interval (pPA,1 âˆ’p + pPA) can be taken by P comb
A
for the
ï¬xed values of PA and P â€²
A. A similar argument using appropriately modiï¬ed maps holds for
either PA or P â€²
A or both of them being zero.
Now, we will show that CH(p) is contained in the given region. A key observation is
that instead of varying over all maps SA â—‹L and SA â—‹L with positive entries subject to the
constraint that N = SR â—‹L is stochastic, one may equivalently vary over all stochastic maps
N and row vectors v with entries in [0,1] (with v = [ 1
1 ]S â—‹L). The same situation
holds for the primed maps. Write v = [ a
b ], N = [ 1 âˆ’c
d
c
1 âˆ’d ], vâ€² = [ aâ€²
bâ€² ], and
N â€² = [ 1 âˆ’câ€²
dâ€²
câ€²
1 âˆ’dâ€² ], with a,b,c,d,aâ€²,bâ€²,câ€²,dâ€² âˆˆ[0,1] except c = d = 0, c = d = 1, câ€² = dâ€² = 0,
and câ€² = dâ€² = 1 are not allowed since the maps must have the Perron-Frobenius property.

CHAPTER 7. PARRONDOâ€™S PARADOX
77
Fixing the values of PA and P â€²
A and using explicit expressions for the Perron-Frobenius
eigenvector gives the optimization problem:
constraints: ad + bc = PA(c + d),aâ€²dâ€² + bâ€²câ€² = P â€²
A(câ€² + dâ€²)
(7.30)
extremize: P comb
A
= (pa + (1 âˆ’p)aâ€²)(pd + (1 âˆ’p)dâ€²) + (pb + (1 âˆ’p)bâ€²)(pc + (1 âˆ’p)câ€²)
p(c + d) + (1 âˆ’p)(câ€² + dâ€²)
The quantity to be extremized is a rational linear function of c,d,câ€²,dâ€²; furthermore, the
constraints are homogeneous in the sense that they are unaï¬€ected by c â†’Î¾c, d â†’Î¾d for any
positive Î¾ and câ€² â†’Î¾â€²câ€², dâ€² â†’Î¾â€²dâ€² for any positive Î¾â€². Therefore, the extreme values can only
be attained as either c,d â†’0 or câ€²,dâ€² â†’0. In the ï¬rst case, using the remaining condition,
the quantity to be extremized is (1 âˆ’p)P â€²
A + p(adâ€² + bcâ€²)
(câ€² + dâ€²)
. The term on the right is between
0 and p. In the second case, using the remaining condition, the quantity to be extremized is
pPA + (1 âˆ’p)(aâ€²d + bâ€²c)
(c + d)
. The term on the right is between 0 and 1 âˆ’p. The actual extreme
values cannot be attained because the maps corresponding to those parameter values are
not allowed. â—»
7.4
Deï¬ning a quantum analogue of the Markov
model
An analogous game
As we showed in Â§3.3, one may consider the analogous game to the above one employing
maps on density matrices rather than maps on measures. This leads to the following Bayesian
network model:
Deï¬nition 7.4.1
A Markov-Bayesian-quantum model (R, Î·, H, L, Ï0) is composed of: an
observation set R with base measure Î·, a Hilbert space H, a pince-nez map
L âˆˆB (D(H),L1(R;Î·;D(H))) that is norm-preserving (on the positive cone) and completely-
positive, and an initial density-matrix Ï0 on H with tr Ï0 = 1.
The use of the word quantum will be justiï¬ed below. The accompanying graphical model is
(note it is the same as (7.16), illustrating the analogy graphically):


k
k
k
k


-
-
â‹¯
-
-
-
k
k
k
k
1
2
n âˆ’1
n
(7.31)
Then the joint probability to observe (x1,x2,...,xn) âˆˆA1Ã—A2Ã—â‹¯Ã—An, for any Î·-measurable
A1,A2,...,An âˆˆR, is (compare to (7.17))
tr SAn â—‹L â—‹â‹¯â—‹SA1 â—‹LÏ0
(7.32)

CHAPTER 7. PARRONDOâ€™S PARADOX
78
for SA âˆˆB (L1(R;Î·;D(H)),D(H)) the linear map given by the integration SAÏ• = âˆ«A Ï•dÎ·.
Employing this model for the game, then the marginal probability for the observation to
be in A at the nth round (so Alice wins) is (compare to (7.18))
PA,n = tr SA â—‹L â—‹N â—‹â‹¯â—‹N
Â´Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¸Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¶
nâˆ’1
Ï0
(7.33)
where N âˆˆB (D(H)) is deï¬ned as the map SR â—‹L. Because of the deï¬nition of the game, it
is possible to reduce to the case where the event space for R is simply E = {âˆ…,A, ËœA,X} and
its base measure Î· is the measure with Î·(A) = Î·( ËœA) = 1.
An alternate game using textbook quantum mechanics
Consider the following quantum game that is a generalization of that employed by [28], but
using our simpler winning criterion.
Deï¬nition 7.4.2
A Markov-quantum process (H, q, U ) with: Hilbert space H, number of
quantum channels q, and unitary operator U âˆ¶HâŠ—q â†’HâŠ—qâ€“is the operator
Ïˆ â†’(IHâŠ—(qâˆ’1)(nâˆ’1) âŠ—U)â‹¯(IHâŠ—(qâˆ’1) âŠ—U âŠ—IHâŠ—(qâˆ’1)(nâˆ’2))(U âŠ—IHâŠ—(qâˆ’1)(nâˆ’1))Ïˆ
for any Ïˆ âˆˆHâŠ—((qâˆ’1)n+1).
The corresponding quantum circuit for the case of q = 4 is:


 


 


 


 


 
......
...
â‹¯
â‹¯
......
q1
q2
q3
q4
q5
q6
q(3n âˆ’2)
q(3n âˆ’1)
q(3n)
q(3n + 1)
(7.34)
This may be compared to the quantum process with accompanying quantum circuit employed
in [28].
Let {PA1Ã—â‹¯Ã—An} over all Ï„-measurable A1,...,An be a complete set of mutually commut-
ing, orthogonal projectors3 on HâŠ—((qâˆ’1)n+1).
A textbook quantum model is then provided by the following:
3A complete set of mutually commuting, orthogonal projectors relative to a base measure Âµ is deï¬ned
similarly with that relative to a Ïƒ-algebra except the condition Eâˆ…= 0 is replaced by the condition that
Âµ(B) = 0 â‡’EB = 0.

CHAPTER 7. PARRONDOâ€™S PARADOX
79
Deï¬nition 7.4.3
A Markov-quantum-model (R, Ï„, H, q, U, {PA1Ã—â‹¯Ã—An}, Ïˆi) is composed
of: an observation set R with base measure Ï„, a Markov-quantum process (H, q, U ), a
collection of orthogonal projectors {PA1Ã—â‹¯Ã—An} as described above, and an initial length-one
vector Ïˆi âˆˆHâŠ—((qâˆ’1)n+1).
The joint probability to observe (x1,x2,...,xn) âˆˆA1Ã—A2Ã—â‹¯Ã—An is then âˆ¥PA1Ã—â‹¯Ã—AnÏˆfâˆ¥2, where
Ïˆf is given by applying the Markov-quantum process to Ïˆi. In particular, the marginal proba-
bility for the observation to be in A at the nth round (so Alice wins) is PA,n = âˆ¥PXÃ—â‹¯Ã—XÃ—AÏˆfâˆ¥2.
Equivalence of the two models
Start with any Markov-quantum model. The joint probability to observe (x1,x2,...,xn) in
A1 Ã— â‹¯Ã— An is given by
âˆ¥PA1Ã—â‹¯Ã—AnÏˆfâˆ¥2 = âŸ¨PA1Ã—â‹¯Ã—AnÏˆf,ÏˆfâŸ©= tr PA1Ã—â‹¯Ã—AnÏˆfÏˆâˆ—
f
(7.35)
This has a graphical representation as the following tensor network (illustrated for q = 4):
d

 


 


 
d

 


 


 


 


 


 


 


 


 


 


 


 
...
...
...
...
...
...
...
...
...
q1
q2
q3
q4
q5
q6
q7
q(3n âˆ’1)
q(3n)
q(3n + 1)
(7.36)
The initial wavefunction Ïˆi = Ïˆ0 âŠ—(Ïˆ1)âŠ—n is on the left, with its conjugate on the right. The
unitary operators U are on the left diagonal, with the adjoints U âˆ—on the right diagonal.
The projectors are down the center.
Rather than performing the calculation in the diï¬ƒcult manner (left-to-right), the calcu-
lation can be done the easy way (top-to-bottom). This reordering gives rise to the following
graphical model for a Bayesian network, where the labels indicate where the quantum chan-
nels from the quantum circuit and tensor network models go in the latter:


i
 


 
i
 


 
i
 


 








-
-
-



-
-



-
-



6
6
6
â‹¯â‹¯
0
1
2
n
-
i
i
i
1
2
n
q1
q2,q3,
q4
q5,q6,
q7
q(3n âˆ’1),q(3n),
q(3n + 1)
q1,q2,
q3
q4,q5,
q6
q(3n âˆ’2),
q(3n âˆ’1),
q(3n)
q(3n + 1)
n
(7.37)

CHAPTER 7. PARRONDOâ€™S PARADOX
80
By replacing each repeated module by a pince-nez, this becomes (7.31). (Note the eï¬ƒciency
of the graphical model for the Bayesian network compared to the tensor networkâ€“there is
no need to place every operator and initial condition twice in the graph.) The preceding
graphical manipulation inspires the following:
Theorem 7.4.4
If a Markov-quantum model is of the form
(R,Ï„,H,q,U,{QA1 âŠ—â‹¯âŠ—QAn âŠ—IH},Ïˆ0 âŠ—(ÏˆâŠ—n
1 ))
for some unit-length vectors Ïˆ0 âˆˆH and Ïˆ1 âˆˆHâŠ—(qâˆ’1) and collection of orthogonal projec-
tors {QC}CâˆˆE on HâŠ—(qâˆ’1), then there is an equivalent (in the sense of giving the same joint
probabilities) Markov-Bayesian-quantum model (R, Ï„, H, L, Ï0).
Proof
Start with any such Markov-quantum model.
The joint probability to observe
(x1,x2,...,xn) in A1 Ã— â‹¯Ã— An is given by
âˆ¥PA1Ã—â‹¯Ã—AnÏˆfâˆ¥2 = âŸ¨PA1Ã—â‹¯Ã—AnÏˆf,ÏˆfâŸ©= tr PA1Ã—â‹¯Ã—AnÏˆfÏˆâˆ—
f
(7.38)
Write the trace as the tensor product of reduced traces,
trHâŠ—((qâˆ’1)n+1) = (trHâŠ—(qâˆ’1))âŠ—n âŠ—trH
(7.39)
This tensor product of maps is well-deï¬ned using A1.3, B4.1, B5.5, and B5.8. Using the
given forms, PA1Ã—â‹¯Ã—An = QA1 âŠ—â‹¯âŠ—QAn âŠ—IH and Ïˆi = Ïˆ0 âŠ—(ÏˆâŠ—n
1 ), then â€œpushingâ€ the partial
traces into the expression as far as possible gives the joint probability as
(K(â‹…;An) âŠ—trH)(U (((K(â‹…;Anâˆ’1) âŠ—IB(H))(â‹¯
(K(â‹…;A2)âŠ—IB(H))(U(((K(â‹…;A1)âŠ—IB(H))(U(Ïˆ0Ïˆâˆ—
0 âŠ—(Ïˆ1Ïˆâˆ—
1))U âˆ—))âŠ—(Ïˆ1Ïˆâˆ—
1))U âˆ—)
â‹¯)) âŠ—(Ïˆ1Ïˆâˆ—
1))U âˆ—)
(7.40)
where IB(H) is the identity map on operators in B(H) and
K âˆ¶D (HâŠ—(qâˆ’1)) Ã— ( Ï„ âˆ’measurable
subsets of R
) â†’R
(7.41)
is given by K(Ï;C) = tr QCÏ. The various tensor products of maps in the expression are still
well-deï¬ned by the above propositions. K is countably-additive in its second argument by
the countable-additivity of the projectors {QC} (with convergence in the weak* topology).
K(â‹…;C) is manifestly completely-positive for any C âˆˆE. Then, by B5.5, and B5.8, âˆ¥K(â‹…;C)âŠ—
IB(H)âˆ¥op = âˆ¥K(â‹…;C)âˆ¥op. Therefore, for any ï¬xed Ï âˆˆD (HâŠ—(qâˆ’1))
+, K(Ï;â‹…) is a measure on R.
Furthermore, this measure is clearly absolutely continuous with respect to Ï„ since QC = 0 if
Ï„(C) = 0.

CHAPTER 7. PARRONDOâ€™S PARADOX
81
Let N âˆ¶D (H) Ã— E â†’D (H) be the map given by
MNÏ;C) = (K(â‹…;C) âŠ—IB(H))(U(Ï âŠ—(Ïˆ1Ïˆâˆ—
1))U âˆ—)
(7.42)
By the above properties of K, for any ï¬xed Ï âˆˆD (H)+, N(Ï;â‹…) is a D (H)+-valued vector mea-
sure on R that is absolutely continuous with respect to Ï„. D (H) has the Radon-NikodÂ´ym
property, so N(Ï;â‹…) has Radon-NikodÂ´ym derivative dN(Ï;â‹…)
dÏ„
âˆˆL1(R;Ï„;D (H)+) with the prop-
erty that N(Ï;C) = âˆ«C
dN(Ï;â‹…)
dÏ„
dÏ„ for any Ï„-measurable subset C. Then deï¬ne the pince-nez
map L by LÏ = dN(Ï;â‹…)
dÏ„
. The required completely-positive and norm-preserving (on the posi-
tive cone) properties of L are readily demonstrated. â—»
More remarkable (and requiring theorem 5.1.1 to prove) is the following result:
Theorem 7.4.5
If a Markov-Bayesian-quantum model is of the form (R, Ï„, H, L, Ïˆ0Ïˆâˆ—
0),
then there is an equivalent (in the sense of giving the same joint probabilities) Markov-
quantum-model
(Râ€²,Ï„ â€²,H,q,U,{PA1Ã—â‹¯Ã—An},Ïˆi)
Proof
Start with any such Markov-Bayesian-quantum model. From theorem 5.1.1 and
the Radon-NikodÂ´ym property of D(H), L can be written in terms of the Radon-NikodÂ´ym
derivative, LÏ = dN(Ï;â‹…)
dÏ„
, with
N(Ï;B) = (trK âŠ—P(B) âŠ—IB(H))(V ÏV âˆ—)
(7.43)
for some Hilbert space K, some partial isometry V âˆ¶L2(H â†’K âŠ—L2(R;Ï„) âŠ—H, and where
P(B) is the functional on D(L2(R;Ï„)) given by P(B)Ï„ = âˆ«xâˆˆB Ï„(x,x) dÎ½(x). Furthermore,
by the theorem, if all the Hilbert spaces have ï¬nite dimension, the dimension of K less than
or equal to (dimH)2.
The dimension of L2(R;Ï„) then determines the minimum number of quantum channels,
q. If dimL2(R;Ï„) â‰¤(dimH), take q = 4. If dimH < dimL2(R;Ï„) â‰¤(dimH)2, take q = 5.
If (dimH)2 < dimL2(R;Ï„) â‰¤(dimH)3, take q = 6. For any of these three cases, take Q
to be any partial isometry from L2(R;Ï„) to HâŠ—(qâˆ’3). For (dimH)3 < dimL2(R;Ï„), let G
be the subspace of L2(R;Ï„) which is relevant, given by the norm-closure of the span of
{(Ïˆâˆ—âŠ—Ï€(1) âŠ—Î¾âˆ—)V Ï†âˆ£Ï†,Ïˆ âˆˆH,Î¾ âˆˆK}. Then dimG â‰¤(dimH)2 dimK â‰¤(dimH)4, so take q = 7
and Q to be any partial isometry from G to HâŠ—4.
Now select any unit-length Ïˆ1 âˆˆHâŠ—(qâˆ’1) and any partial isometry R âˆ¶K â†’H âŠ—H. Then
there is some unitary U âˆ¶HâŠ—q â†’HâŠ—q such that
U(Ï† âŠ—Ïˆ1) = (R âŠ—Q âŠ—IH)V Ï† for every Ï† âˆˆH
(7.44)
Hence, by the spectral theorem for compact operators,
U(Ï âŠ—Ïˆ1Ïˆâˆ—
1)U âˆ—= (R âŠ—Q âŠ—IH)V ÏV âˆ—(Râˆ—âŠ—Qâˆ—âŠ—IH) for every Ï âˆˆD(H)+
(7.45)

CHAPTER 7. PARRONDOâ€™S PARADOX
82
Take Ïˆi = Ïˆ0âŠ—(ÏˆâŠ—n
1 ). Finally, if dimL2(X;Âµ) = (dimH)qâˆ’3 or dimG = (dimH)4, take X â€² = X,
Ï„ â€² = Ï„, and PA1Ã—â‹¯Ã—An to be
(IHâŠ—2âŠ—QÏ€(1A1)Qâˆ—) âŠ—â‹¯âŠ—(IHâŠ—2âŠ—QÏ€(1An)Qâˆ—)âŠ—IH
(7.46)
Otherwise, add one point x0 to X to form X â€². Add an atom of weight one at x0 to Ï„ to form
Ï„ â€². For A1,...,An âˆˆE, let PA1Ã—â‹¯Ã—An be deï¬ned as above. Replacing any of the Ajâ€™s with
{x0}, replace QÏ€(1Aj)Qâˆ—with IHâŠ—(qâˆ’3) âˆ’Qâˆ—Q. (Note that with the given initial wavefunction
and time-evolution, the probabilities for observing {x0} are all zeroâ€“it is only added so the
projectors form a complete set with PX â€²Ã—n = IHâŠ—((qâˆ’1)n+1.) â—»
7.5
Parrondoâ€™s paradox for the quantum game
Deï¬ning the combined game
As a reward for our eï¬€orts in part I and in the preceding section, we can now ignore the
complicated Markov-quantum model and instead utilize the far simpler Markov-Bayesian-
quantum model. Furthermore, since the latter model uses maps that live on a convex space,
it is possible to utilize coin ï¬‚ips to combine two games instead of the recourse to more
complicated alternating rules for rounds previously used by [28] [52]. This combined game
has graphical model (note it is the same as (7.19)):


k
k
k
k


-
-
-
â‹¯
-
-
k
k
k
k
1
2
n âˆ’1
n
k
k
k
k
C
CCW
C
CCW
C
CCW
C
CCW
{heads,tails} {heads,tails} {heads,tails} {heads,tails}
(7.47)
Again, let Î³ be the previously given probability measure for the coin of p for heads and 1âˆ’p
for tails, and, for simplicity of notation, identify Î³ with its Radon-NikodÂ´ym derivative with
respect to the counting measure. For the combined game, the map for each round is
M(Ï âŠ—Î³) = pLÏ + (1 âˆ’p)Lâ€²Ï = Lâ€²â€²Ï
(7.48)
for Lâ€²â€² = pL + (1 âˆ’p)Lâ€². Let N â€²,N â€²â€² âˆˆB (D(H)) be deï¬ned using Lâ€²,Lâ€²â€² as N was following
(7.33),as N â€² = SR â—‹Lâ€² and N â€²â€² = SR â—‹Lâ€²â€². Then the marginal probability for the observation
to be in A for the nth round (so Alice wins) is (compare to (7.21))
P comb
A,n
= tr SA â—‹M (â‹¯(SR â—‹M ((SR â—‹MÏ0) âŠ—Î³)) âŠ—Î³â‹¯)dÂµ
(7.49)
= tr SA â—‹Lâ€²â€² â—‹N â€²â€² â—‹â‹¯â—‹N â€²â€²
Â´Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¸Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¹Â¶
nâˆ’1
Ï0
Because of the deï¬nition of the game, it is possible to reduce to the case where E =
{âˆ…,A, ËœA,X}.

CHAPTER 7. PARRONDOâ€™S PARADOX
83
Bounds on the paradox for the quantum game
Since it is possible to embed a classical hidden system within a quantum one (see Â§3.6),
one may expect the paradox to be present to an equal or greater degree for these quantum
games. This is indeed the case, as is seen by comparing the statements of theorems 7.3.3
and 7.3.4 with the following theorem 7.5.3 and claim 7.5.5. By analogy to deï¬nition 7.2.1,
we have:
Deï¬nition 7.5.1
A linear map L from D(H)+ to D(H)+ has the quantum-Perron-Frobenius
property, QPF(H), if there is a density matrix Ï, termed the quantum-Perron-Frobenius
eigenvector, such that the sequence âŸ¨LjÏ0âŸ©converges in total-variation norm to Ï regardless
of the initial unit-norm density matrix Ï0.
Restrict the space of pince-nez maps L,Lâ€² to those where N ,N â€², and their convex combi-
nation, pN + (1 âˆ’p)N â€², are all in QPF(H). Then, once again, let PA, P â€²
A, and P comb
A
be the
limits as n â†’âˆof PA,n, P â€²
A,n and P comb
A,n
respectively.
Deï¬nition 7.5.2
The quantum allowed region, denoted Q(A,X,E,H,p), is the set of all
(PA,P â€²
A,P comb
A
) âˆˆ[0,1]Ã—3 that occur, for ï¬xed A, X, E, H, and p, over all allowed pince-nez
maps L and Lâ€².
As in the classical case, the existence of the paradox is then determined by the intersection
of Q with the cube ( 1
2,1] Ã— ( 1
2,1] Ã— [0, 1
2). For p = 1, P comb
A
= PA and for p = 0, P comb
A
= P â€²
A;
clearly no paradox is possible. We have the following theorem and claims for p âˆˆ(0,1), which
indicate that, once again, there are basically only two possibilities, depending on whether
we have dimH = 2 or dimH > 2.
Theorem 7.5.3
For p âˆˆ(0,1), if dimH > 2, then Q âŠƒ(0,1)Ã—3.
Proof
Pick any Îµ > 0 Let H1,H2,H3 be three non-trivial subspaces of H such that H =
H1 âŠ•H2 âŠ•H3. Choose any density matrices Î½1 âˆˆD(H1)+, Î½2 âˆˆD(H2)+, Î½3 âˆˆD(H3)+ with unit
trace. Let Îº âˆ¶D(H)+ â†’R3 be the map
Îº(Ï) =
â¡â¢â¢â¢â¢â¢â£
tr Ïâˆ£H1
tr Ïâˆ£H2
tr Ïâˆ£H3
â¤â¥â¥â¥â¥â¥â¦
(7.50)
and deï¬ne the pince-nez maps L and Lâ€² by
LÏ = 1A âŠ—[ Î½1
0
0 ]TÎº(Ï) + 1 Ëœ
A âŠ—[ 0
Î½2
Î½3 ]TÎº(Ï)
(7.51)
Lâ€²Ï = 1A âŠ—[ Î½1
0
0 ]Tâ€²Îº(Ï) + 1 Ëœ
A âŠ—[ 0
Î½2
Î½3 ]Tâ€²Îº(Ï)
for T,Tâ€² as in theorem 7.2.3. Because of the properties of Î½1, Î½2, Î½3, and Îº, the required
calculation reduces to matrix products, which then proceeds as in the proof for theorem

CHAPTER 7. PARRONDOâ€™S PARADOX
84
7.3.3. â—»
Employing a similar construction, for dimH = 2 we have Q(p) âŠƒCH(p). We have the
following two claims, backed by extensive numerical calculation:
Claim 7.5.4
For any ï¬xed p,PA,P â€²
A âˆˆ(0,1), the minimum and maximum values of P comb
A
are achieved for pince-nez maps L and Lâ€² each of the form Ï â†’1A âŠ—JÏJâˆ—+ 1 Ëœ
A âŠ—KÏKâˆ—.
Claim 7.5.5
For any ï¬xed p,PA,P â€²
A âˆˆ(0,1), the minimum and maximum values of P comb
A
lie outside the bounds given in theorem 7.3.3.
Assuming the validity of the ï¬rst claim, the extremizing maps can be expressed as
LÏ = 1A âŠ—[ u1
v1
u2
v2 ]Ï[ u1
u2
v1
v2 ] + 1 Ëœ
A âŠ—[ u3
v3
u4
v4 ]Ï[ u3
u4
v3
v4 ]
(7.52)
Lâ€²Ï = 1A âŠ—[ uâ€²
1
vâ€²
1
uâ€²
2
vâ€²
2
]Ï[ uâ€²
1
uâ€²
2
vâ€²
1
vâ€²
2
] + 1 Ëœ
A âŠ—[ uâ€²
3
vâ€²
3
uâ€²
4
vâ€²
4
]Ï[ uâ€²
3
uâ€²
4
vâ€²
3
vâ€²
4
]
for âˆ¥âƒ—uâˆ¥2 = âˆ¥âƒ—vâˆ¥2 = 1, âƒ—u âŠ¥âƒ—v except for points excluded by the requirement of the quantum
Perron-Frobenius property. We are then faced by the following optimization problem, which
may be treated numerically:
constraints: âƒ—wMâˆ’1
â¡â¢â¢â¢â¢â¢â¢â¢â£
0
0
0
1
â¤â¥â¥â¥â¥â¥â¥â¥â¦
= PA, âƒ—wâ€²Mâ€²âˆ’1
â¡â¢â¢â¢â¢â¢â¢â¢â£
0
0
0
1
â¤â¥â¥â¥â¥â¥â¥â¥â¦
= P â€²
A
(7.53)
extremize: P comb
A
= (p âƒ—w + (1 âˆ’p) âƒ—wâ€²)(pM + (1 âˆ’p)Mâ€²)âˆ’1
â¡â¢â¢â¢â¢â¢â¢â¢â£
0
0
0
1
â¤â¥â¥â¥â¥â¥â¥â¥â¦
for
âƒ—w = [ âˆ£u1âˆ£2 + âˆ£u2âˆ£2
u1v1 + u2v2
u1v1 + u2v2
âˆ£v1âˆ£2 + âˆ£v2âˆ£2 ]
(7.54)
âƒ—wâ€² = [ âˆ£uâ€²
1âˆ£2 + âˆ£uâ€²
2âˆ£2
uâ€²
1vâ€²
1 + uâ€²
2vâ€²
2
uâ€²
1vâ€²
1 + uâ€²
2vâ€²
2
âˆ£vâ€²
1âˆ£2 + âˆ£vâ€²
2âˆ£2 ]
M =
â¡â¢â¢â¢â¢â¢â¢â¢â£
âˆ£u1âˆ£2 + âˆ£u3âˆ£2 âˆ’1
u1v1 + u3v3
v1u1 + v3u3
âˆ£v1âˆ£2 + âˆ£v3âˆ£2
u1u2 + u3u4
u1v2 + u3v4 âˆ’1
v1u2 + v3u4
v1v2 + v3v4
u2u1 + u4u3
u2v1 + u4v3
v2u1 + v4u3 âˆ’1
v2v1 + v4v3
1
0
0
1
â¤â¥â¥â¥â¥â¥â¥â¥â¦
Mâ€² =
â¡â¢â¢â¢â¢â¢â¢â¢â¢â£
âˆ£uâ€²
1âˆ£2 + âˆ£uâ€²
3âˆ£2 âˆ’1
uâ€²
1vâ€²
1 + uâ€²
3vâ€²
3
vâ€²
1uâ€²
1 + vâ€²
3uâ€²
3
âˆ£vâ€²
1âˆ£2 + âˆ£vâ€²
3âˆ£2
uâ€²
1uâ€²
2 + uâ€²
3uâ€²
4
uâ€²
1vâ€²
2 + uâ€²
3vâ€²
4 âˆ’1
vâ€²
1uâ€²
2 + vâ€²
3uâ€²
4
vâ€²
1vâ€²
2 + v3vâ€²
4
uâ€²
2uâ€²
1 + uâ€²
4uâ€²
3
uâ€²
2vâ€²
1 + uâ€²
4vâ€²
3
vâ€²
2uâ€²
1 + vâ€²
4uâ€²
3 âˆ’1
vâ€²
2vâ€²
1 + vâ€²
4vâ€²
3
1
0
0
1
â¤â¥â¥â¥â¥â¥â¥â¥â¥â¦

CHAPTER 7. PARRONDOâ€™S PARADOX
85
Graphs, for certain representative values of p, of the minimum achievable P comb
A
given PA,P â€²
A,
are given in the following section.
7.6
Summary of results
In summary, for the considered classical game whose event space E is eï¬€ectively three or
more states, the analogous classical hidden game whose Ïƒ-algebra F for its hidden set is
eï¬€ectively three or more states, and the analogous quantum game whose Hilbert space is
three or more dimensions, we have proven there is no limitation on the probability for Alice
to win the combined game, P comb
A
, given her probabilities to win the individual games, PA
and P â€²
A. For the classical game with two-states, E = {âˆ…,A, ËœA,O}, we have proven the paradox
cannot occur. For the analogous classical hidden game with two-states, F = {âˆ…,B, ËœB,H},
we have
min{pPA,(1 âˆ’p)P â€²
A} < P comb
A
< max{1 âˆ’p + pPA,p + (1 âˆ’p)P â€²
A}
(7.55)
where p âˆˆ(0,1) is the probability for the coin to land heads.
The following contour plots illustrate the lower bounds on P comb
A
for the two represen-
tative values of p = 0.5 (the fair coin) and p = 0.1. The paradox is displayed by minimum
achievable values of P comb
A
being less than one-half in the region (PA,P â€²
A) âˆˆ( 1
2,1]Ã—( 1
2,1]. For
comparison, plots of the minimum achieved P comb
A
for the analogous quantum game whose
Hilbert space H has dimension two, which were numerically calculated from the optimization
problem posed in (7.53), are given as well.

CHAPTER 7. PARRONDOâ€™S PARADOX
86
 0.05 
 0.1 
 0.15 
 0.2 
 0.25 
 0.3 
 0.35 
 0.4 
 0.45 
0.0
0.2
0.4
0.6
0.8
1.0
0.0
0.2
0.4
0.6
0.8
1.0
PA
P â€²
A
Figure 7.1: Minimum achievable values of P comb
A
for p = 0.5 for the two-state, classical hidden
game.
 0.02 
 0.04 
 0.06 
 0.08 
0.0
0.2
0.4
0.6
0.8
1.0
0.0
0.2
0.4
0.6
0.8
1.0
PA
P â€²
A
Figure 7.2: Minimum achievable values of P comb
A
for p = 0.1 for the two-state, classical hidden
game.

CHAPTER 7. PARRONDOâ€™S PARADOX
87
 0.02 
 0.04 
 0.06 
 0.08 
 0.1 
 0.12 
 0.14 
 0.16 
 0.18 
0.0
0.2
0.4
0.6
0.8
1.0
0.0
0.2
0.4
0.6
0.8
1.0
PA
P â€²
A
Figure 7.3: Minimum achievable values of P comb
A
for p = 0.5 for the two-dimensional, quantum
game.
 0.02 
 0.04 
 0.06 
 0.08 
0.0
0.2
0.4
0.6
0.8
1.0
0.0
0.2
0.4
0.6
0.8
1.0
PA
P â€²
A
Figure 7.4: Minimum achievable values of P comb
A
for p = 0.1 for the two-dimensional, quantum
game.

88
Chapter 8
A Parrondo-like paradox for an
one-round game
8.1
Deï¬ning the game
Instead of the multi-round game considered in the preceding chapter, now consider a single
round quantum game where the winning criteria is still taken to be that the observation is
in some speciï¬ed set A. Instead of having two maps which are combined by a coin ï¬‚ip, the
map is now ï¬xed and only the initial states are varied. If they were combined in a convex
combination by ï¬‚ipping a coin, there would clearly be no Parrondoâ€™s paradox since the prob-
abilities depend linearly on the initial state. However, if the initial states were constrained
to be rank one (hence, described by a wavefunction), instead of a convex combination, one
may consider the minimizing geodesic joining them. If two initial states both give probabil-
ity greater than one-half for the ï¬rst player, Alice, to win, but there is somewhere on the
minimizing geodesic where the second player, Bob, has probability greater than one-half to
win, we will term that a Parrondo-like paradox.
Suppose there is a continuous control, say a slider with continuous values from zero to
one, which varies the initial state along a geodesic in the space of rank-one density matrices.
Using the Bayesian network model, this initial state is input into a ï¬xed pince-nez map and
the outcome observed. The graphical model is:




-
{ S âˆˆ[0,1]
C
C
CCW
k
(8.1)
Employing option Iâ€™ (see Â§3.2), the data for the initial node is ([0,1],Lebesgue;H;K) for
some given Hilbert space H. The map K will be determined below in Â§8.2. The data for the
pince-nez is (H;R,Ï„;;L) for some given observable set R with base measure Ï„. By the rules

CHAPTER 8. A PARRONDO-LIKE PARADOX FOR AN ONE-ROUND GAME
89
of the game, it is possible to reduce to the case where the Ïƒ-algebra is {âˆ…,A, ËœA,R} with base
measure Ï„ assigning both A and ËœA the value one. Suppose L is also given.
The probability for the observation to be in set A (so Alice wins) is then
âˆ«A(L â—‹K)Î½ dÏ„ = ((L â—‹K)Î½)âˆ£A
(8.2)
8.2
Deï¬ning geodesics on the space of wavefunctions
Let SH âŠ‚H be the unit ball. For any Î¶,Î· âˆˆS, let âˆ¼be the equivalence relation Î¶ âˆ¼Î· if Î¶ = Ï‰Î·
for some phase Ï‰ âˆˆS1 âŠ‚C and let [â‹…] denote the equivalence classes. Consider a wavefunction
Ïˆ âˆˆSH. Since only the rank-one density matrix ÏˆÏˆâˆ—= ÏˆâŸ¨â‹…,ÏˆâŸ©is meaningful, Ïˆ is only deï¬ned
up to an overall phase, so what should actually be considered is the equivalence class [Ïˆ]
in the quotient space SH/ âˆ¼. The question is then what is the correct topology and metric
structure to place on this quotient space.
Choice oneâ€“using the trace norm
Using the topology and metric structure inherited from the placement of rank-one density
matrices within all density matrices, consider the choice of metric disttrace on SH/ âˆ¼given by,
for any [Î¾],[Ïˆ] âˆˆS/ âˆ¼,
disttrace([Î¾],[Ïˆ]) = tr âˆ£Î¾Î¾âˆ—âˆ’ÏˆÏˆâˆ—âˆ£= 2
âˆš
1 âˆ’âˆ£âŸ¨Ïˆ,Î¾âŸ©âˆ£2
(8.3)
The last equality holds since spanC{Î¾,Ïˆ} is an invariant subspace of the operator
(Î¾Î¾âˆ—âˆ’ÏˆÏˆâˆ—)âˆ—(Î¾Î¾âˆ—âˆ’ÏˆÏˆâˆ—) = (Î¾Î¾âˆ—âˆ’ÏˆÏˆâˆ—)2
(8.4)
with eigenvalue 1 âˆ’âˆ£âŸ¨Ïˆ,Î¾âŸ©âˆ£2 while the orthogonal subspace is the kernel of the operator.
Choice twoâ€“using the round metric on SH
Let distround be the round metric on SH, which is the standard metric induced by its embed-
ding in H equipped with its norm, so, for any Î¶,Î· âˆˆSH,
distround(Î¶,Î·) = arccosRâŸ¨Î¶,Î·âŸ©
(8.5)
Then let the metric distâˆ¼round on SH/ âˆ¼be given by the usual prescription for quotient spaces,
so, for any [Î¾],[Ïˆ] âˆˆSH/ âˆ¼,
distâˆ¼round([Î¾],[Ïˆ]) = min
wâˆˆS1âŠ‚Cdistround(Î¾,wÏˆ) = arccos max
wâˆˆS1âŠ‚CRâŸ¨Ïˆ,wÎ¾âŸ©= arccosâˆ£âŸ¨Ïˆ,Î¾âŸ©âˆ£
(8.6)
Then
disttrace([Î¾],[Ïˆ]) = 2sindistâˆ¼round([Î¾],[Ïˆ])
(8.7)
â‡”distâˆ¼round([Î¾],[Ïˆ]) = arcsin 1
2disttrace([Î¾],[Ïˆ])
In particular, the metrics are equivalent and give rise to the same topology on SH/ âˆ¼.

CHAPTER 8. A PARRONDO-LIKE PARADOX FOR AN ONE-ROUND GAME
90
Geodesics on the quotient space
Fix any Î¾,Ïˆ âˆˆSH with corresponding equivalence classes [Î¾],[Ïˆ] âˆˆSH/ âˆ¼.
Let Ë†Î¾ be an
element of [Î¾] such that distround(Ë†Î¾,Ïˆ) = distâˆ¼round([Î¾],[Ïˆ]) â‡”âŸ¨Ïˆ, Ë†Î¾âŸ©= âˆ£âŸ¨Ïˆ,Î¾âŸ©âˆ£, so Ë†Î¾ =
âŸ¨Ïˆ,Î¾âŸ©
âˆ£âŸ¨Ïˆ,Î¾âŸ©âˆ£Î¾ if âŸ¨Ïˆ,Î¾âŸ©â‰ 0 while Ë†Î¾ can be any element of [Î¾] if âŸ¨Ïˆ,Î¾âŸ©= 0. Now take the arc
Î³ âˆ¶[0,distround(Ë†Î¾,Ïˆ)] â†’SH of the great circle in SH connecting Ïˆ and Ë†Î¾ with the standard
parametrization, given by
Î³(Î¸) = (cosÎ¸)Ïˆ + (sinÎ¸)
Ë†Î¾ âˆ’âŸ¨Ë†Î¾,ÏˆâŸ©Ïˆ
âˆ¥Ë†Î¾ âˆ’âŸ¨Ë†Î¾,ÏˆâŸ©Ïˆâˆ¥
(8.8)
where âˆ¥Ë†Î¾ âˆ’âŸ¨Ë†Î¾,ÏˆâŸ©Ïˆâˆ¥=
âˆš
âŸ¨Ë†Î¾ âˆ’âŸ¨Ë†Î¾,ÏˆâŸ©Ïˆ, Ë†Î¾ âˆ’âŸ¨Ë†Î¾,ÏˆâŸ©ÏˆâŸ©=
âˆš
1 âˆ’âŸ¨Ë†Î¾,ÏˆâŸ©2.
Proposition 8.2.1
The curve [Î³] in SH/ âˆ¼is an unit speed geodesic with respect to the
metric distâˆ¼round.
Proof
For any Î¸ âˆˆ(0,distround(Ë†Î¾,Ïˆ)),
distâˆ¼round([Î³(Î¸)],[Ïˆ]) + distâˆ¼round([Î¾],[Î³(Î¸)]) = distround(Î³(Î¸),Ïˆ) + distround(Ë†Î¾,Î³(Î¸)) (8.9)
= distround(Ë†Î¾,Ïˆ)
= distâˆ¼round([Î¾],[Ïˆ])
so not only is the curve [Î³] a geodesic, but by further partitioning, the metric is seen to be
precisely the arclength of the geodesic. Also, for any Î¸ âˆˆ(0,distround(Ë†Î¾,Ïˆ)),
lim
Îµâ†’0+
1
Îµ distâˆ¼round([Î³(Î¸ + Îµ)],[Î³(Î¸)]) = lim
Îµâ†’0+
1
Îµ arccos(cos(Îµ)) = lim
Îµâ†’0+
âˆ£Îµâˆ£
Îµ = 1
(8.10)
so the curve is unit speed. â—»
Proposition 8.2.2
The curve [Î³] in SH/ âˆ¼is a geodesic with respect to the metric disttrace.
Proof
Since 2sinz = 2z + O(z3) as z â†’0, the arclength of a curve with respect to the
metric disttrace is simply twice the arclength with respect to the metric distâˆ¼round. Hence, the
two metrics have the same geodesics.â—»
Completing the deï¬nition of the game.
We still need to deï¬ne the initialization map K from Â§8.1 which uses the slider position to
determine a point on the geodesic. From the preceding results on geodesics, K is determined

CHAPTER 8. A PARRONDO-LIKE PARADOX FOR AN ONE-ROUND GAME
91
by ï¬rst ï¬xing the endpoints [Î¾],[Ïˆ] âˆˆSH/ âˆ¼. Let Î´ = distâˆ¼round([Î¾],[Ïˆ]). Then, for Î½ a
measure on [0,1] absolutely continuous with respect to Lebesgue measure Î»,
K dÎ½
dÎ» = âˆ«xâˆˆ[0,1] Î³(xÎ´)Î³(xÎ´)âˆ—dÎ½(x)
(8.11)
If Î½ is suï¬ƒciently concentrated, then, as desired, the image of K is approximately rank-one.
The complication of dealing with a concentrated measure Î½ for the slider position is another
instance of the previously mentioned problem (see Â§3.2 and Â§4.5) of inputting parameters
encountered when employing option Iâ€™â€“the value of the slider cannot be read in directly.
For purposes of simplicity and clarity, in the remainder we will instead simply suppose we
can directly select the desired point on the geodesic and work with strictly rank-one density
matrices.
8.3
Bounds on the extent of the Parrondo-like
paradox
To quantify the extent of the Parrondo-like paradox, by analogy to Â§7 we have PA, P â€²
A, as
the probability Alice wins with initial wavefunction [Î¾] and [Ïˆ] respectively. Deï¬ne P geo
A
as the probability Alice wins with initial wavefunction for a speciï¬ed point on the geodesic
joining [Î¾] and [Ïˆ]. Analogously to deï¬nition 7.5.2, we have the following:
Deï¬nition 8.3.1
The quantum allowed region, denoted Q(A,R,Ï„,H), is the set of all
(PA,P â€²
A,P geo
A ) âˆˆ[0,1]Ã—3 that occurâ€“for ï¬xed A, R, Ï„, and Hâ€“over all allowed pince-nez maps
L, initial wavefunctions [Î¾] and [Ïˆ], and points on the geodesic joining them.
The paradox can occur if Q intersects the cube ( 1
2,1] Ã— ( 1
2,1] Ã— [0, 1
2). We have the following
theorem giving Q precisely:
Theorem 8.3.2
If the Hilbert space H is nontrivial, Q is the closed region
max{0,PA + P â€²
A âˆ’1} â‰¤P geo
A
â‰¤min{PA + P â€²
A,1}
Proof
Since the bounded operators are dual to the trace-class ones, there is some self-
adjoint operator Î· âˆˆB(H) such that L(Ï)âˆ£A = tr Î·Ï for every Ï âˆˆD(H)+ and, by B5.15 and
B5.16, every Ï âˆˆS1(H). The condition on Î· is that it is in the order interval 0 â‰¤Î· â‰¤IH. Let
the 2 Ã— 2-, Hermitian matrix B = [bjk] be given by
[ L(ÏˆÏˆâˆ—)âˆ£A
L(ÏˆË†Î¾âˆ—)âˆ£A
L(Ë†Î¾Ïˆâˆ—)âˆ£A
L(Î¾Î¾âˆ—)âˆ£A
] = [ âŸ¨Î·Ïˆ,ÏˆâŸ©
âŸ¨Î·Ïˆ, Ë†Î¾âŸ©
âŸ¨Î·Ë†Î¾,ÏˆâŸ©
âŸ¨Î·Î¾,Î¾âŸ©]
(8.12)
Let B be the set of all such matrices over 0 â‰¤Î· â‰¤IH and Ïˆ,Î¾ âˆˆSH.

CHAPTER 8. A PARRONDO-LIKE PARADOX FOR AN ONE-ROUND GAME
92
To get a simpler characterization of B, let C be the union of order intervals of 2 Ã— 2-,
Hermitian matrices given by
â‹ƒ
Î´âˆˆ[0, Ï€
2 ]
{0 â‰¤C â‰¤[
1
cosÎ´
cosÎ´
1
]}
(8.13)
The claim is that B = C. To see this is true, take any B âˆˆB. Since Î· â‰¥0, for any a,b âˆˆC,
[ a
b ]B [ a
b ] = [ a
b ][ âŸ¨Î·Ïˆ,ÏˆâŸ©
âŸ¨Î·Ïˆ, Ë†Î¾âŸ©
âŸ¨Î·Ë†Î¾,ÏˆâŸ©
âŸ¨Î·Î¾,Î¾âŸ©][ a
b ] = âŸ¨Î·(aÏˆ + bË†Î¾),aÏˆ + bË†Î¾âŸ©â‰¥0
(8.14)
Therefore, B â‰¥0. Similarly, since IH âˆ’Î· â‰¥0, for cosÎ´ = âŸ¨Ïˆ, Ë†Î¾âŸ©,
[ a
b ]([
1
cosÎ´
cosÎ´
1
] âˆ’B)[ a
b ] = [ a
b ][ âŸ¨(IH âˆ’Î·)Ïˆ,ÏˆâŸ©
âŸ¨(IH âˆ’Î·)Ïˆ, Ë†Î¾âŸ©
âŸ¨(IH âˆ’Î·)Ë†Î¾,ÏˆâŸ©
âŸ¨(IH âˆ’Î·)Î¾,Î¾âŸ©][ a
b ]
(8.15)
= âŸ¨(IH âˆ’Î·)(aÏˆ + bË†Î¾),aÏˆ + bË†Î¾âŸ©
which is always greater than or equal to zero, so B â‰¤[
1
cosÎ´
cosÎ´
1
] for Î´ = arccosâŸ¨Ïˆ, Ë†Î¾âŸ©âˆˆ
[0, Ï€
2]. Hence, B âŠ‚C.
Now take any C âˆˆC, so there is some Î´ âˆˆ[0, Ï€
2] such that C â‰¤[
1
cosÎ´
cosÎ´
1
]. Since
H is nontrivial, it has a pair of orthonormal vectors, {e1,e2}. Take Ïˆ = e1 and Î¾ = Ë†Î¾ =
cosÎ´e1 + sinÎ´e2, which are both clearly of unit norm. Take the operator Î· to be zero on the
complement of the span of {e1,e2}. On the span, using {e1,e2} as the basis, let Î· be given
by
C = [ âŸ¨Î·Ïˆ,ÏˆâŸ©
âŸ¨Î·Ïˆ, Ë†Î¾âŸ©
âŸ¨Î·Ë†Î¾,ÏˆâŸ©
âŸ¨Î·Î¾,Î¾âŸ©] = [
1
0
cosÎ´
sinÎ´ ]Î· [ 1
cosÎ´
0
sinÎ´ ]
(8.16)
â‡”Î· = [
1
0
cosÎ´
sinÎ´ ]
âˆ’1
C [ 1
cosÎ´
0
sinÎ´ ]
âˆ’1
Then, since C â‰¥0, clearly Î· â‰¥0. Since C â‰¤[
1
cosÎ´
cosÎ´
1
], for v = [ 1
cosÎ´
0
sinÎ´ ]
âˆ’1
[ a
b ],
[ a
b ](IH âˆ’Î·)[ a
b ] = vâˆ—([
1
cosÎ´
cosÎ´
1
] âˆ’C)v â‰¥0
(8.17)
Hence, Î· â‰¤IH, so C âŠ‚B and B = C.
Therefore, using the above expression (8.8) for the geodesic and âˆ¥Ë†Î¾ âˆ’âŸ¨Ë†Î¾,ÏˆâŸ©Ïˆâˆ¥= sinÎ´, we
wish to extremize
P geo
A
=
1
sin2 Î´ [ sin(Î´ âˆ’Î¸)
sinÎ¸ ]B [ sin(Î´ âˆ’Î¸)
sinÎ¸
]
(8.18)

CHAPTER 8. A PARRONDO-LIKE PARADOX FOR AN ONE-ROUND GAME
93
over all 0 â‰¤B â‰¤[
1
cosÎ´
cosÎ´
1
], Î´ âˆˆ[0, Ï€
2], and Î¸ âˆˆ[0,Î´] for ï¬xed PA = b11 and P â€²
A = b22.
Setting the imaginary parts of the oï¬€-diagonal entries of B to zero keeps B in the allowed
order interval and does not change the value of PA, P â€²
A, or P geo
A , so B can be taken real.
For ï¬xed Î´ and Î¸, the expression in (8.18) is linear in B. Since the allowed B form a
convex set, the extrema are achieved on the set of extreme points, so B can be restricted
to either (i) being rank one or (ii) having [
1
cosÎ´
cosÎ´
1
] âˆ’B be rank one. For case (i), we
have two subcases for the choice of either + or âˆ’in
B = [
b11
Â±âˆšb11b22
Â±âˆšb11b22
b22
]
(8.19)
Choosing the +, then b11,b22 âˆˆ[0,1] with
max{0,
âˆš
b11b22 âˆ’
âˆš
(1 âˆ’b11)(1 âˆ’b22)} â‰¤cosÎ´ â‰¤min{1,
âˆš
b11b22 +
âˆš
(1 âˆ’b11)(1 âˆ’b22)} (8.20)
and Î¸ âˆˆ[0,Î´]. Let f max
1
(b11,b22) be the maximum of (8.18) over all allowed Î´,Î¸ for the given
b11,b22 and f min
1
(b11,b22) be the minimum. Then f max
1
(b11,b22) = min{b11 + b22,1}, with the
maximizing Î´0,Î¸0 given by Î´0 = Ï€
2, sinÎ¸0 =
âˆš
b22
b11+b22 if b11 + b22 â‰¤1 and by cosÎ´0 = âˆšb11b22 âˆ’
âˆš
(1 âˆ’b11)(1 âˆ’b22), sinÎ¸0 = âˆš1 âˆ’b11 if b11 + b22 > 1. The minimum bound is f min
1
(b11,b22) =
min{b11,b22}, with the minimizing Î´0,Î¸0 given by Î¸0 = 0 if b11 â‰¤b22 and Î¸0 = Î´0 if b11 > b22,
with Î´0 arbitrary. Choosing the âˆ’, then (b11,b22) âˆˆ[0,1]Ã—2 âˆ©{b11 + b22 â‰¤1} with
0 â‰¤cosÎ´ â‰¤min{1,
âˆš
(1 âˆ’b11)(1 âˆ’b22) âˆ’
âˆš
b11b22}
(8.21)
and Î¸ âˆˆ[0,Î´]. Let f max
2
(b11,b22) be the maximum of (8.18) over all allowed Î´,Î¸ for the given
b11,b22 and f min
2
(b11,b22) be the minimum.
Then f max
2
(b11,b22) = max{b11,b22}, with the
maximizing Î´0,Î¸0 given complementary to that for the preceding f min
1
. The minimum bound
is f min
2
(b11,b22) = 0, with the minimizing Î´0,Î¸0 given by Î´0 = Ï€
2, sinÎ¸0 =
âˆš
b11
b11+b22.
For case (ii), once again we have two subcases for the choice of either + or âˆ’in
B = [
b11
cosÎ´ Â±
âˆš
(1 âˆ’b11)(1 âˆ’b22)
cosÎ´ Â±
âˆš
(1 âˆ’b11)(1 âˆ’b22)
b22
]
(8.22)
Choosing the +, then (b11,b22) âˆˆ[0,1]Ã—2 âˆ©{b11 + b22 â‰¥1} with
0 â‰¤cosÎ´ â‰¤min{1,
âˆš
b11b22 âˆ’
âˆš
(1 âˆ’b11)(1 âˆ’b22)}
(8.23)
and Î¸ âˆˆ[0,Î´]. Let f max
3
(b11,b22) be the maximum of (8.18) over all allowed Î´,Î¸ for the given
b11,b22 and f min
3
(b11,b22) be the minimum. Then f max
3
(b11,b22) = 1, with the minimizing Î´0,Î¸0
given by Î´0 = Ï€
2, sinÎ¸0 =
âˆš
1âˆ’b11
2âˆ’b11âˆ’b22. The minimum bound is f min
3
(b11,b22) = min{b11,b22} with

CHAPTER 8. A PARRONDO-LIKE PARADOX FOR AN ONE-ROUND GAME
94
the minimizing Î´0,Î¸0 given similarly to that for the preceding f min
1
. Choosing the âˆ’, then
b11,b22 âˆˆ[0,1] with
max{0,
âˆš
(1 âˆ’b11)(1 âˆ’b22) âˆ’
âˆš
b11b22} â‰¤cosÎ´ â‰¤min{1,
âˆš
(1 âˆ’b11)(1 âˆ’b22) +
âˆš
b11b22} (8.24)
and Î¸ âˆˆ[0,Î´].
Let f max
4
(b11,b22) be the maximum of (8.18) over all allowed Î´,Î¸ for the
given b11,b22 and f min
4
(b11,b22) be the minimum. Then f max
4
(b11,b22) = min{b11,b22} with
the maximizing Î´0,Î¸0 given similarly to that for the preceding f min
1
. The minimum bound is
f min
4
(b11,b22) = max{0,b11 + b22 âˆ’1}, with the minimizing Î´0,Î¸0 given by cosÎ´0 = âˆš1 âˆ’b11
âˆš1 âˆ’b22 âˆ’âˆšb11b22, sinÎ¸0 = âˆšb11 if b11 + b22 â‰¤1 and Î´0 = Ï€
2, sinÎ¸0 =
âˆš
1âˆ’b22
2âˆ’b11âˆ’b22 if b11 + b22 > 1.
Putting the cases and subcases together, the minimum value of P geo
A
for ï¬xed PA,P â€²
A is
given by
(f min
1
âˆ§f min
2
âˆ§f min
3
âˆ§f min
4
)(PA,P â€²
A) = f min
4
(PA,P â€²
A) = max{0,PA + P â€²
A âˆ’1}
(8.25)
The maximum value of P geo
A
for ï¬xed PA,P â€²
A is given by
(f max
1
âˆ¨f max
2
âˆ¨f max
3
âˆ¨f max
4
)(PA,P â€²
A) = f max
1
(PA,P â€²
A) = min{PA + P â€²
A,1}
(8.26)
With ï¬xed values for PA and P â€²
A, within each case and subcase P geo
A
is a continuous function
of Î´ and Î¸, so all intermediate values for P geo
A
are achieved. â—»
Note that, by the result of the preceding theorem, the paradox can only occur for values of
(PA,P â€²
A) in the triangle bounded by PA > 1
2, P â€²
A > 1
2, and PA + P â€²
A < 3
2.
8.4
Conditions for the occurrence of the
Parrondo-like paradox
The matrix B deï¬ned in the proof of the preceding theorem (8.12) puts restrictions on the
occurrence of the paradox. If B â‰¤1
2I2 then both PA and P â€²
A are less than or equal to one-
half, so the paradox cannot occur for any choices of [Ïˆ], [Î¾], or point on the geodesic joining
them. Similarly, if the trace of B is less than or equal to one, then either PA or P â€²
A is less
than one-half, so the paradox also cannot occur. From these obvious statements, we then
have the following nontrivial result:
Theorem 8.4.1
If, for any particular orthonormal e1,e2 âˆˆH,
tr [ L(e1eâˆ—
1)âˆ£A
L(e1eâˆ—
2)âˆ£A
L(e2eâˆ—
1)âˆ£A
L(e2eâˆ—
2)âˆ£A ] â‰¤1
then, for any normalized Ïˆ,Î¾ âˆˆspanC{e1,e2} and point on the geodesic joining [Ïˆ] and [Î¾],
the paradox cannot occur.

CHAPTER 8. A PARRONDO-LIKE PARADOX FOR AN ONE-ROUND GAME
95
Proof
Let Ïˆ = [ e1
e2 ][ a
b ] and Ë†Î¾ = [ e1
e2 ][ c
d ] with âˆ£aâˆ£2 + âˆ£bâˆ£2 = âˆ£câˆ£2 + âˆ£dâˆ£2 = 1 and
ac + bd = cosÎ´ real and greater than or equal to zero. Let
C = [ L(e1eâˆ—
1)âˆ£A
L(e1eâˆ—
2)âˆ£A
L(e2eâˆ—
1)âˆ£A
L(e2eâˆ—
2)âˆ£A ]
(8.27)
If C â‰¤1
2I2, then
tr B = tr [ a
b
c
d ]C [ a
c
b
d ] â‰¤1
(8.28)
so, by the comment preceding the theorem, the paradox cannot occur. Therefore, the only
remaining case is where C, whose eigenvalues are necessarily real, has one eigenvalue, Î»1 > 1
2,
and one eigenvalue, Î»2 < 1
2, with Î»1+Î»2 â‰¤1. There are corresponding normalized eigenvectors
v1 and v2, necessarily orthogonal. Writing [ a
c ] = f1v1 + f2v2 and [ b
d ] = g1v1 + g2v2, the
above conditions on a,b,c,d become the following conditions on f1,f2,g1,g2: âˆ£f1âˆ£2 + âˆ£f2âˆ£2 = 1,
âˆ£g1âˆ£2 + âˆ£g2âˆ£2 = 1, and f1g1 + f2g2 = cosÎ´ is a positive real or zero.
For the paradox to occur, it must be that both âˆ£f1âˆ£2Î»1 + âˆ£f2âˆ£2Î»2 = b11 = PA >
1
2 and
âˆ£g1âˆ£2Î»1 + âˆ£g2âˆ£2Î»2 = b22 = P â€²
A > 1
2; hence,
âˆ£f1âˆ£>
Â¿
Ã
Ã
Ã€
1
2 âˆ’Î»2
Î»1 âˆ’Î»2
and âˆ£f2âˆ£<
Â¿
Ã
Ã
Ã€ Î»1 âˆ’1
2
Î»1 âˆ’Î»2
â‡’âˆ£f1âˆ£>
Â¿
Ã
Ã
Ã€
1
2 âˆ’Î»2
Î»1 âˆ’1
2
âˆ£f2âˆ£
(8.29)
âˆ£g1âˆ£>
Â¿
Ã
Ã
Ã€
1
2 âˆ’Î»2
Î»1 âˆ’Î»2
and âˆ£g2âˆ£<
Â¿
Ã
Ã
Ã€ Î»1 âˆ’1
2
Î»1 âˆ’Î»2
â‡’âˆ£g1âˆ£>
Â¿
Ã
Ã
Ã€
1
2 âˆ’Î»2
Î»1 âˆ’1
2
âˆ£g2âˆ£
(8.30)
Then, since
âˆ£f1g1âˆ£= âˆ£f1âˆ£âˆ£g1âˆ£>
1
2 âˆ’Î»2
Î»1 âˆ’1
2
âˆ£f2âˆ£âˆ£g2âˆ£> âˆ£f2âˆ£âˆ£g2âˆ£= âˆ£f2g2âˆ£
(8.31)
it must be that f1g1 + f2g2 is actually strictly positive and that Rf1g1 > 0. Furthermore,
since the imaginary parts of f1g1 and f2g2 are equal in magnitude, it must be that the real
part of f1g1 is greater than
1
2 âˆ’Î»2
Î»1âˆ’1
2 times the magnitude of the real part of f2g2 and, therefore,
is greater than
1
2 âˆ’Î»2
Î»1âˆ’1
2 times the real part of f2g2. Hence, rearranging terms,
R(Î»1f1g1 + Î»2f2g2) > 1
2 (f1g1 + f2g2) = 1
2 cosÎ´
(8.32)

CHAPTER 8. A PARRONDO-LIKE PARADOX FOR AN ONE-ROUND GAME
96
However, then
P geo
A
=
1
sin2 Î´ [ sin(Î´ âˆ’Î¸)
sinÎ¸ ]B [ sin(Î´ âˆ’Î¸)
sinÎ¸
]
(8.33)
=
1
sin2 Î´ ((âˆ£f1âˆ£2Î»1 + âˆ£f2âˆ£2Î»2)sin2(Î´ âˆ’Î¸) + (âˆ£g1âˆ£2Î»1 + âˆ£g2âˆ£2Î»2)sin2 Î¸
+2R(Î»1f1g1 + Î»2f2g2)sin(Î´ âˆ’Î¸)sinÎ¸)
>
1
sin2 Î´ (1
2 sin2(Î´ âˆ’Î¸) + 1
2 sin2 Î¸ + cosÎ´ sin(Î´ âˆ’Î¸)sinÎ¸)
=
1
2sin2 Î´ (sin(Î´ âˆ’Î¸)(sin(Î´ âˆ’Î¸) + cosÎ´ sinÎ¸)
+sinÎ¸ (sin(Î´ âˆ’(Î´ âˆ’Î¸)) + cosÎ´ sin(Î´ âˆ’Î¸)))
=
1
2sin2 Î´ (sin(Î´ âˆ’Î¸)sinÎ´ cosÎ¸ + sinÎ¸ sinÎ´ cos(Î´ âˆ’Î¸))
= sin2 Î´
2sin2 Î´ = 1
2
Therefore, if both b11 = PA > 1
2 and b22 = P â€²
A > 1
2, then P geo
A
> 1
2 everywhere on the geodesic.
â—»

97
Chapter 9
Quantum walks and the Parrondo-like
paradox
9.1
Classical random and classical hidden walks
Deï¬nitions of classical random and classical hidden walks
A classical random walk is a special case of the observable Markov chain earlier discussed,
with graphical model given in ï¬gure (7.1). It models a walker who is in one of a ï¬nite
number of internal states and occupies one of a countable number of positions at one time,
so the space X is either J Ã— Z+ for a walk on the half-line, or J Ã— Z for a walk on the
full line. After each time-step, the walker is at the same or a neighboring location and its
internal state can change as well. The process is random, with the transition probability
functions possibly dependent on the internal state as well as on the location. This constrains
the transition probability functions further than the constraints already imposed by the
Markov conditions, but these further constraints are not indicated in the graphical model.
If the transition probability functions are spatially translation invariant, the walk is termed
homogeneous.
Now we may consider a classical hidden walk.
This is in some ways a special case
of the classical hidden-Markov chain earlier discussed (7.16), while in other ways it is a
generalization. The hidden set H is required to be either J Ã— Z+ for a walk on the half-line,
or J Ã—Z for a walk on the full line. The base measure for the hidden set is required to be the
counting measure, and L1 (H;counting measure) â‰…â„“1, so all integrals can be taken to just be
sums. The space â„“1 has a natural basis of sequences that have a single nonzero entry with
value one. There is a dual â€œbasisâ€ of sequences in â„“âˆof the same sequences, which is not a
basis in the norm topology, but is one in the weak* topology. This basis and dual â€œbasisâ€
can be used to assign matrix elements to any operator in B(â„“1). Then any operator, A, in
B(â„“1) is in one-to-one correspondence to a certain sequence of matrices, {An}, which may
be considered the truncations of the inï¬nite matrix corresponding to the operator. By the

CHAPTER 9. QUANTUM WALKS AND THE PARRONDO-LIKE PARADOX
98
triangle inequality, these sequences converge to the operator in the strong-operator topology:
lim
nâ†’âˆâˆ¥Ax âˆ’Anxâˆ¥= lim
nâ†’âˆâˆ¥Ax âˆ’PnAPnxâˆ¥â‰¤lim
nâ†’âˆ(âˆ¥Ax âˆ’PnAxâˆ¥+ âˆ¥PnAx âˆ’PnAPnxâˆ¥)
(9.1)
â‰¤lim
nâ†’âˆ(âˆ¥(Ax) âˆ’Pn(Ax)âˆ¥+ âˆ¥PnAâˆ¥opâˆ¥x âˆ’Pnxâˆ¥) = 0
for any x âˆˆâ„“1, where {Pn} are the usual, diagonal projectors onto the span of the ï¬rst n
basis elements.
Conversely, given a sequence of matrices, each of which is the truncation of the following,
the condition on the sequence so that it actually corresponds to a bounded operator is that
the induced operator norm of all the matrices is bounded. However, the operator norm
induced by the â„“1 norm is simply the supremum over all columns of the column sum of
the magnitudes of the entries, so it is readily calculated. With this form for the maps, the
condition that this is a walk (rather than some other sort of hidden-Markov process) is that
matrix entries connecting spatial locations that are not neighboring are all zero.
The generalization from the classical hidden-Markov chain is that the last pince-nez map
in the chain is no longer required to be the same as the preceding ones; in particular, all the
preceding pince-nez can be taken to be simply nodes, so the graphical model is


k
k
k


-
-
-
â‹¯â‹¯
-
-
1
2
n
k
n + 1
(9.2)
Note there is nothing graphically that distinguishes this from a more general Markov processâ€“
the constraints that make it a walk are not represented graphically.
Connection to orthogonal polynomials and measures on R
Orthogonal polynomials1 {pj} result from the Gram-Schmidt algorithm applied to {1,x,x2,...}
on the real line with inner-product given with respect to some Borel measure Âµ, âŸ¨f,gâŸ©=
âˆ«R fg dÂµ. These polynomials all have the maximal number of real roots, which are all sim-
ple, else they would not change signs enough times to be orthogonal. For the same reason,
the roots are all within the convex hull of the support of Âµ and they interlace as j increases
by one. By orthogonality, the polynomials necessarily obey a three-term recurrence relation,
which may be written in matrix form as
x[ p0
p1
â‹¯] = [ p0
p1
â‹¯]
â¡â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â£
b0
c1
a0
b1
c2
a1
...
...
...
...
â¤â¥â¥â¥â¥â¥â¥â¥â¥â¥â¥â¦
(9.3)
1The following results on orthogonal polynomials are well known and included for comparison to the
results for quantum walks given below. For details, see[119].

CHAPTER 9. QUANTUM WALKS AND THE PARRONDO-LIKE PARADOX
99
If the polynomials are normalized to have value one at x = 1, the tridiagonal, inï¬nite matrix
on the right has column sum one for each of its columns. If Âµ is such that all the entries
in that matrix are positive, then it is a stochastic matrix and can be used for the map per
time step for a classical random or classical hidden walk on the half-line where the internal
states are trivial.
Conversely, given such a walk, then there is an inï¬nite, stochastic matrix
â¡â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â£
b0
c1
a0
b1
c2
a1
...
...
...
...
â¤â¥â¥â¥â¥â¥â¥â¥â¥â¥â¥â¦
(9.4)
giving the map per time step. If all the aâ€™s and câ€™s are strictly positive, then each n Ã— n-
truncation An of the matrix is similar to a Hermitian matrix via
â¡â¢â¢â¢â¢â¢â¢â¢â¢â¢â£
1
1
d1
...
1
dnâˆ’1
â¤â¥â¥â¥â¥â¥â¥â¥â¥â¥â¦
â¡â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â£
b0
c1
a0
b1
c2
a1
...
...
...
...
cnâˆ’1
anâˆ’2
bnâˆ’1
â¤â¥â¥â¥â¥â¥â¥â¥â¥â¥â¥â¥â¥â¦
â¡â¢â¢â¢â¢â¢â¢â¢â¢â£
1
d1
...
dnâˆ’1
â¤â¥â¥â¥â¥â¥â¥â¥â¥â¦
(9.5)
where d2
j =
c1â‹¯cj
a0â‹¯ajâˆ’1. Therefore, for each such truncation, the eigenvalues {x(n)
1 ,...,x(n)
n } are
all real. These eigenvalues are all necessarily less than or equal to one in magnitude since
the spectral radius of An is less than or equal to its operator norm induced by the â„“1-norm,
which is one. By the Courant-Fischer minimax theorem [16] the eigenvalues are all simple
and they interlace as n increases, so they are actually all less than one in magnitude. Deï¬ne
the polynomials {pn} by
pn(x) = det(xIn âˆ’An)
det(In âˆ’An) = (x âˆ’x(n)
1 )â‹¯(x âˆ’x(n)
n )
(1 âˆ’x(n)
1 )â‹¯(1 âˆ’x(n)
n )
(9.6)
By adding the ï¬rst row to the second, the second to the third, and so on, it is easy to see
that det(In âˆ’An) = a0a1â‹¯anâˆ’1. Then, by expanding det(xIn âˆ’An) by minors along its last
column and evaluation at the n values x âˆˆ{x(n)
1 ,...,x(n)
n } (which is enough to determine a
degree-n polynomial), the polynomial xpnâˆ’1(x) obeys the recurrence relation in (9.3).
Let Âµ1 be the single atom measure Î´b0 and, for n > 1, let Âµn be the atomic measure
âˆ‘n
j=1 w(n)
j
Î´x(n)
j , where
w(n)
j
=
k
âˆ‘
l=1
w(k)
l
pn (x(k)
l
)
(x(k)
l
âˆ’x(n)
j
)pâ€² (x(n)
j
)
(9.7)

CHAPTER 9. QUANTUM WALKS AND THE PARRONDO-LIKE PARADOX
100
for any k âˆˆ{âŒˆn
2âŒ‰,...,n âˆ’1} (they all give the same result). Furthermore, the sequence of
measures âŸ¨ÂµnâŸ©stabilizes for any ï¬xed polynomial in the sense that for any degree-n polyno-
mial q, âˆ«R q dÂµk is the same for all k â‰¥âŒŠn
2 + 1âŒ‹. Therefore, the Âµn are indeed measures (and
not just signed measures) since
w(n)
j
=
nâˆ’1
âˆ‘
l=1
w(nâˆ’1)
l
â›
âœ
â
pn (x(nâˆ’1)
l
)
(x(nâˆ’1)
l
âˆ’x(n)
j
)pâ€² (x(n)
j
)
â
âŸ
â 
2
(9.8)
so all the wâ€™s are positive.
Hence, Âµn(R) = âˆ«R 1dÂµn = 1 is the total-variation norm of Âµn for each n. Since the Âµn are
all Radon measures and the interval [âˆ’1,1] is compact, by the Riesz-Markov theorem [78] and
Alaogluâ€™s theorem [85], the sequence âŸ¨ÂµnâŸ©has a weak* limit point. Since, by the Weierstrass
theorem [112], polynomials are dense in the supremum norm among continuous functions
on the compact interval [âˆ’1,1], by the above stabilizing property of the sequence, the limit
point is unique and the entire sequence converges to it in the weak* topology. Let this limit
be denoted Âµ. Then {pn} are the orthogonal polynomials corresponding to the measure
Âµ on R. The measure Âµ is unique among Radon measures since any other measure with
this property agrees with Âµ on polynomials, but, as stated above, they are dense in norm
among continuous functions on [âˆ’1,1], which separate Radon measures; hence, polynomials
separate these measures as well.
Furthermore, one may ask if, starting with Î½ such that the tridiagonal, inï¬nite matrix
has all positive entries, then forming the measure Âµ following the procedure outlined, it is
necessarily the case that Î½ âˆÂµ (there may be a scale factor since Âµ necessarily has total-
variation norm one). This is true since Âµ and Î½ agree (up to the scale factor) when integrated
with polynomials on R; however, Âµ is supported on [âˆ’1,1] so its moments (and, hence, those
of Î½) are bounded. Therefore, by [22], the moment problem on R has a unique solution in
this case.
Finally, there is the question of whether every Radon measure on [âˆ’1,1] corresponds to a
classical random walk. The answer is no, as is seen by the Jacobi polynomials [1], normalized2
to have the value one at x = 1, {
n!
(1+Î±)nP (Î±,Î²)
n
}. These have measure with support on [âˆ’1,1],
given there by the measure absolutely continuous with respect to Lebesgue measure and
with Radon-NikodÂ´ym derivative (1 + x)Î²(1 âˆ’x)Î±. For the recurrence relation, the entries in
the tridiagonal, inï¬nite matrix for {an} and {cn} are always strictly positive (as they must
be for any measure with its support on (âˆ’âˆ,1]), but the {bn} are given by
bn = (Î²2 âˆ’Î±2)(2n + Î± + Î² + 1)
(2n + Î± + Î²)3
(9.9)
which are negative for Î± > Î². (However, for the Jacobi polynomials shifted to live on the
interval [0,1] with Radon-NikodÂ´ym derivative xÎ±(1 âˆ’x)Î², {(âˆ’1)nn!
(1+Î²)n P (Î±,Î²)
n
(1 âˆ’2x)}, there is
an associated walkâ€“see [30]).
2Using Pochhammerâ€™s symbol, (a)0 = 1 and (a)n = a(a + 1)â‹¯(a + n âˆ’1).

CHAPTER 9. QUANTUM WALKS AND THE PARRONDO-LIKE PARADOX
101
9.2
Quantum walks
Deï¬nition of a quantum walk
Similarly to the classical hidden walk, the quantum walk is in some ways a special case of the
quantum Markov chain earlier discussed (7.31), while in other ways it is a generalization. The
Hilbert space H is required to be either L2(J Ã—Z+;counting measure) for a walk on the half-
line, or L2(J Ã—Z;counting measure) for a walk on the full line; both are clearly isometrically
isomorphic to â„“2, so all integrals can be taken to just be sums. The space â„“2 has a natural
basis of sequences that each have a single nonzero entry with value one. This basis and the
inner-product can be used to assign matrix elements to any operator B(â„“2). Any operator A
in B(â„“2) is in one-to-one correspondence to a certain sequence of matrices, {An}, which may
be considered the truncations of the inï¬nite matrix corresponding to the operator. By the
triangle inequality, these sequences converge to the operator in the strong-operator topology:
lim
nâ†’âˆâˆ¥AÏˆ âˆ’AnÏˆâˆ¥= lim
nâ†’âˆâˆ¥AÏˆ âˆ’PnAPnÏˆâˆ¥â‰¤lim
nâ†’âˆ(âˆ¥AÏˆ âˆ’PnAÏˆâˆ¥+ âˆ¥PnAÏˆ âˆ’PnAPnÏˆâˆ¥) (9.10)
â‰¤lim
nâ†’âˆ(âˆ¥(AÏˆ) âˆ’Pn(AÏˆ)âˆ¥+ âˆ¥PnAâˆ¥opâˆ¥Ïˆ âˆ’PnÏˆâˆ¥) = 0
for any Ïˆ âˆˆâ„“2, where {Pn} are the orthogonal projectors onto the span of the ï¬rst n basis
elements.
Conversely, given a sequence of matrices, each of which is the truncation of the following,
the condition on the sequence so that it actually corresponds to a bounded operator is that
the induced operator norm of all the matrices is bounded. The operator norm induced by the
â„“2 norm is the largest singular value, which, unfortunately, is not generally readily calculated.
However, for this sequence to correspond to a partial isometry, it is only necessary to show
that for all ï¬xed, ï¬nite collections of columns, those columns of the {An} are mutually
orthonormal in the limit as n â†’âˆ.
It is readily shown that this condition implies the
induced operator norm of each An is less than or equal to one. With this form for the maps,
the condition that this is a walk (rather than some other sort of quantum Markov process)
is that matrix entries connecting spatial locations that are not neighboring are all zero.
The generalization from the quantum Markov chain is that the last pince-nez in the
chain is no longer required to be the same as the preceding. In particular, all the preceding
pince-nez can be taken to be simply nodes, so the graphical model is


k
k
k


-
-
-
â‹¯â‹¯
-
-
1
2
n
k
n + 1
(9.11)
Note, as for the classical random walks, there is nothing graphically that distinguishes this
from a more general quantum Markov processâ€“the constraints that make it a walk are not
represented in the graphical model.

CHAPTER 9. QUANTUM WALKS AND THE PARRONDO-LIKE PARADOX
102
Orthogonal trigonometric polynomials and measures on S1
Trigonometric orthogonal polynomials3 {qj} result from the Gram-Schmidt algorithm applied
to {1,z,zâˆ’1,z2,zâˆ’2,...} on the unit circle S1 within C with sesquilinear inner-product given
with respect to some Borel measure Âµ, âŸ¨f,gâŸ©= âˆ«S1 fg dÂµ. To form these, it is useful to start
with the monic orthogonal polynomials on the unit circle, the SzegÂ¨o polynomials, {sn}. For
any polynomial, deï¬ne the reciprocal polynomial to be the polynomial with its coeï¬ƒcients
conjugated and ï¬‚ipped in order, so, if p is a nth order polynomial,
preciprocal(z) = znp(1
z) = znp(1
z)
(9.12)
where the overline only over the function means to conjugate its coeï¬ƒcients.
On S1,
preciprocal(z) = znp(z). In particular, if z is a root of p, then 1
z is a root of preciprocal.
Deï¬ne the Verblunsky coeï¬ƒcients by the values of the SzegÂ¨o polynomials at zero, Î±n =
âˆ’sn+1(0). Then, by orthogonality, we have the following SzegÂ¨o recurrence identities for all
z âˆˆC:
z sn(z) = sn+1(z) + Î±n sreciprocal
n
(z)
(9.13)
â‡”sreciprocal
n+1
(z) = sreciprocal
n
(z) âˆ’Î±nz sn(z)
and
sn(z) = âˆ’Î±nâˆ’1 sreciprocal
n
(z) + (1 âˆ’âˆ£Î±nâˆ’1âˆ£2)z snâˆ’1(z)
(9.14)
â‡”sreciprocal
n
(z) = âˆ’Î±nâˆ’1 sn(z) + (1 âˆ’âˆ£Î±nâˆ’1âˆ£2)sreciprocal
nâˆ’1
(z)
From the ï¬rst identity, it follows that
âˆ¥snâˆ¥2 = âˆ«zâˆˆS1 âˆ£sn(z)âˆ£2 dÂµ(z) = (1 âˆ’âˆ£Î±nâˆ’1âˆ£2)â‹¯(1 âˆ’âˆ£Î±0âˆ£2)Âµ(S1)
(9.15)
By Verblunskyâ€™s theorem, the measure Âµ, the moments of the measure {mj}, and the
Verblunsky coeï¬ƒcients {Î±j} all determine each other. The only condition on the Verblunsky
coeï¬ƒcients that they do indeed correspond to some measure is that âˆ£Î±jâˆ£â‰¤1 for all j.
The monic orthogonal trigonometric polynomials are then given by q0 = 1, and, for
j âˆˆ{1,2,...},
qj(z) = zâˆ’(jâˆ’1)s2jâˆ’1(z),qâˆ’j(z) = zâˆ’jsreciprocal
2j
(z)
(9.16)
3Only a few basic results that are most applicable to quantum walks of this rich topic are presented here.
See [117] for details and elaboration.

CHAPTER 9. QUANTUM WALKS AND THE PARRONDO-LIKE PARADOX
103
The orthogonal trigonometric polynomials necessary satisfy a pentadiagonal recurrence re-
lation, with ï¬rst z q0(z) = q1(z) + Î±0q1(z), then, using (9.13) and (9.14) repeatedly,
zqj(z) = zâˆ’jz2s2jâˆ’1(z) = zâˆ’jz (s2j(z) + Î±2jâˆ’1sreciprocal
2jâˆ’1
(z))
(9.17)
= zâˆ’j (s2j+1(z) + Î±2jsreciprocal
2j
(z) + Î±2jâˆ’1z sreciprocal
2jâˆ’1
(z))
= zâˆ’j (s2j+1(z) + Î±2jsreciprocal
2j
(z)
+zÎ±2jâˆ’1 (âˆ’Î±2jâˆ’2 s2jâˆ’1(z) + (1 âˆ’âˆ£Î±2jâˆ’2âˆ£2)sreciprocal
2jâˆ’2
(z)))
= qj+1(z) + Î±2jqâˆ’j(z) âˆ’Î±2jâˆ’1Î±2jâˆ’2qj(z) + Î±2jâˆ’1 (1 âˆ’âˆ£Î±2jâˆ’2âˆ£2)qâˆ’(jâˆ’1)(z)
and
zqâˆ’j(z) = zâˆ’jz sreciprocal
2j
(z) = zâˆ’jz (âˆ’Î±2jâˆ’1 s2j + (1 âˆ’âˆ£Î±2jâˆ’1âˆ£2)sreciprocal
2jâˆ’1
)
(9.18)
= zâˆ’j (âˆ’Î±2jâˆ’1 (s2j+1 + Î±2jsreciprocal
2j
)
+z (1 âˆ’âˆ£Î±2jâˆ’1âˆ£2)(âˆ’Î±2jâˆ’2 s2jâˆ’1 + (1 âˆ’âˆ£Î±2jâˆ’2âˆ£2)sreciprocal
2jâˆ’2
))
= âˆ’Î±2jâˆ’1qj+1(z) âˆ’Î±2jÎ±2jâˆ’1qâˆ’j(z) âˆ’Î±2jâˆ’2 (1 âˆ’âˆ£Î±2jâˆ’1âˆ£2)qj
+ (1 âˆ’âˆ£Î±2jâˆ’1âˆ£2)(1 âˆ’âˆ£Î±2jâˆ’2âˆ£2)qâˆ’(jâˆ’1)(z)
Following Cantero, Moral, and VelÂ´azquez [8] [9], writing this in matrix form as
[ zq0(z)
zq1(z)
zqâˆ’1(z)
â‹¯] = [ q0(z)
q1(z)
qâˆ’1(z)
â‹¯]Z
(9.19)
gives the CMV-matrix Z for the monic orthogonal trigonometric polynomials,
Z =
â¡â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â£
Î±0
Î±1 (1 âˆ’âˆ£Î±0âˆ£2)
(1 âˆ’âˆ£Î±1âˆ£2)(1 âˆ’âˆ£Î±0âˆ£2)
0
â‹¯
1
âˆ’Î±1Î±0
âˆ’(1 âˆ’âˆ£Î±1âˆ£2)Î±0
0
â‹¯
0
Î±2
âˆ’Î±1Î±2
Î±3 (1 âˆ’âˆ£Î±2âˆ£2)
â‹¯
0
1
âˆ’Î±1
âˆ’Î±3Î±2
â‹¯
0
0
0
Î±4
â‹¯
...
...
...
...
...
â¤â¥â¥â¥â¥â¥â¥â¥â¥â¥â¥â¥â¥â¥â¦
(9.20)
The matrix Z can be written as the product of two block-diagonal matrices (the columns
within each 2 Ã— 2-block correspond to the identities in (9.13) and (9.14))
â¡â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â£
Î±0
1 âˆ’âˆ£Î±0âˆ£2
1
âˆ’Î±0
Î±2
1 âˆ’âˆ£Î±2âˆ£2
1
âˆ’Î±2
...
â¤â¥â¥â¥â¥â¥â¥â¥â¥â¥â¥â¥â¦
â¡â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â£
1
Î±1
1 âˆ’âˆ£Î±1âˆ£2
1
âˆ’Î±1
Î±3
â‹¯
...
...
â¤â¥â¥â¥â¥â¥â¥â¥â¥â¥â¥â¥â¦
(9.21)

CHAPTER 9. QUANTUM WALKS AND THE PARRONDO-LIKE PARADOX
104
Using (9.15), the CMV-matrix U for the orthonormal trigonometric polynomials is then
given by
â¡â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â£
Î±0
Ï0
Ï0
âˆ’Î±0
Î±2
Ï2
Ï2
âˆ’Î±2
...
â¤â¥â¥â¥â¥â¥â¥â¥â¥â¥â¥â¥â¦
â¡â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â£
1
Î±1
Ï1
Ï1
âˆ’Î±1
Î±3
â‹¯
...
...
â¤â¥â¥â¥â¥â¥â¥â¥â¥â¥â¥â¥â¦
(9.22)
for Ïj =
âˆš
1 âˆ’âˆ£Î±jâˆ£2.
Connection to quantum walksâ€“the CMV-matrix
Consider the quantum walk on the half-line Z+âˆª{0} with internal state set J = {â†‘,â†“}, so the
Hilbert space H is â„“2(ZÃ—{â†‘,â†“}). Then, taking the indices as 0 â†‘,0 â†“,1 â†‘,1 â†“,2 â†‘,..., following
a proposal of GrÂ¨unbaum in [10], the CMV-matrix U above can be used as the map for a
quantum walk. With an abuse of notation, for a quantum walk on the line Z with the same
internal state set and with indices ...,âˆ’2 â†“,âˆ’1 â†‘,âˆ’1 â†“,0 â†‘,0 â†“,1 â†‘,1 â†“,2 â†‘,..., the matrix
(underlines indicate indices corresponding spatial location zero) given by the product:
â¡â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â£
...
Î±âˆ’2
Ïâˆ’2
Ïâˆ’2
âˆ’Î±âˆ’2
Î±0
Ï0
Ï0
âˆ’Î±0
Î±2
Ï2
Ï2
âˆ’Î±2
...
â¤â¥â¥â¥â¥â¥â¥â¥â¥â¥â¥â¥â¥â¥â¥â¥â¥â¥â¥â¥â¦
(9.23)
â¡â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â£
...
...
â‹¯
Î±âˆ’3
Î±âˆ’1
Ïâˆ’1
Ïâˆ’1
âˆ’Î±âˆ’1
0
0
Î±1
Ï1
Ï1
âˆ’Î±1
Î±3
â‹¯
...
...
â¤â¥â¥â¥â¥â¥â¥â¥â¥â¥â¥â¥â¥â¥â¥â¥â¥â¥â¥â¥â¦
will also be called a CMV-matrix and the {Î±j} called the Verblunsky coeï¬ƒcients, although
there is no longer a connection to the orthogonal trigonometric polynomials.

CHAPTER 9. QUANTUM WALKS AND THE PARRONDO-LIKE PARADOX
105
Coined quantum walks
Once again, consider the quantum walk on the half-line Z+ âˆª{0} with internal state set
J = {â†‘,â†“}, so the Hilbert space H is â„“2(Z Ã— {â†‘,â†“}). Then, taking the indices as 0 â†‘,0 â†“,1 â†‘
,1 â†“,2 â†‘,..., if it is either of the form
â¡â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â£
a0
b0
c0
d0
a2
b2
c2
d2
...
â¤â¥â¥â¥â¥â¥â¥â¥â¥â¥â¥â¥â¦
â¡â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â£
1
0
1
1
0
0
â‹¯
...
...
â¤â¥â¥â¥â¥â¥â¥â¥â¥â¥â¥â¥â¦
(9.24)
or
â¡â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â£
1
0
1
1
0
0
â‹¯
...
...
â¤â¥â¥â¥â¥â¥â¥â¥â¥â¥â¥â¥â¦
â¡â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â£
a0
b0
c0
d0
a2
b2
c2
d2
...
â¤â¥â¥â¥â¥â¥â¥â¥â¥â¥â¥â¥â¦
(9.25)
then it is termed a coined walk with coins {[ a2j
b2j
c2j
d2j ]}, which are unitary matrices. The
ï¬rst form is a CMV-matrix if b2j = c2j is a positive real or zero and if a2j = âˆ’d2j; then all the
Verblunsky coeï¬ƒcients with odd index are zero and the Verblunsky coeï¬ƒcients with even
index are given by Î±2j = âˆ’d2j. The second form is the adjoint of a CMV-matrix if the same
conditions hold. The diï¬€erence between the two forms for a quantum walk is clearly just a
matter of transforming the initial state by the unitary matrix
â¡â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â£
1
0
1
1
0
0
â‹¯
...
...
â¤â¥â¥â¥â¥â¥â¥â¥â¥â¥â¥â¥â¦
(9.26)
Therefore, which form is adopted is largely a matter of convention, except for possible
restrictions on the initial state.
If all the coins are the same, the quantum walk is termed a coined walk with constant
coin. Since the overall phase of the wavefunction is irrelevant, the phase of the determinant
of the coin is arbitrary. Choosing it to be âˆ’1, the coin is necessarily of the form [ Î±
Î²
Î²
âˆ’Î± ]
for some Î±,Î² âˆˆC with âˆ£Î±âˆ£2 + âˆ£Î²âˆ£2 = 1. Then the condition for the unitary matrix for the
walk to be a CMV-matrix (or the adjoint of one) is that Î² is positive real or zero. Similar
terminology may be employed for walks on the full line.

CHAPTER 9. QUANTUM WALKS AND THE PARRONDO-LIKE PARADOX
106
9.3
The Parrondo-like paradox for quantum walks
Set-up
Consider the quantum walk on the line Z with internal state set J = {â†‘,â†“}, so the Hilbert
space H is â„“2(Z Ã— {â†‘,â†“}). Let P+ be the orthogonal projector onto spatial locations with
positive index, Pâˆ’be the orthogonal projector onto spatial locations with negative index,
and P0 be the orthogonal projector onto spatial location zero, so Pâˆ’+P0 +P+ is the identity.
Let U be the unitary operator that gives time evolution for one time step, Ï â†’UÏU âˆ—.
Then, after n time steps, an observation is made with an observation set R with Ïƒ-algebra
{âˆ…,A, ËœA,R} and base measure Ï„ given by Ï„(A) = Ï„( ËœA) = 1. The pince-nez map L is given
by
LÏ = 1Atr ÏP+ + 1 Ëœ
Atr Ï(P0 + Pâˆ’)
(9.27)
Then, by considering two diï¬€erent initial states, ÏˆÏˆâˆ—and Î¾Î¾âˆ—, and the geodesic joining them,
we can analyze the occurrence and extent of the Parrondo-like paradox.
Showing the paradox is impossible for certain classes of quantum
walks
Let Î·0â†‘be the wavefunction with one for â†‘at location zero and all other amplitudes zero
and Î·0â†“be the wavefunction with one for â†“at location zero and all other amplitudes zero.
Consider the six following cases for the Verblunsky coeï¬ƒcients determining the CMV-matrix
U : (i) Î±j = Ï‰jÎ±âˆ’j for some Ï‰ âˆˆS1 âŠ‚C and all j âˆˆZ; (ii) Î±2j = âˆ’Ï‰2jÎ±âˆ’2j,Î±2j+1 = Ï‰2j+1Î±âˆ’2jâˆ’1
for some Ï‰ âˆˆS1 âŠ‚C and all j âˆˆZ; (iii) Î±j = Î±âˆ’j for all j âˆˆZ; (iv) Î±j = âˆ’Î±âˆ’j for all j âˆˆZ; (v)
Î±2j = Î±âˆ’2j,Î±2j+1 = âˆ’Î±âˆ’2jâˆ’1 for all j âˆˆZ; and (vi) Î±2j = âˆ’Î±âˆ’2j,Î±2j+1 = Î±âˆ’2jâˆ’1 for all j âˆˆZ. With
the preceding set-up, we have the following result:
Theorem 9.3.1
If the Verblunsky coeï¬ƒcients are in any of the preceding six cases, then
for any initial wavefunctions Ïˆ,Î¾ in the subspace for spatial location zero, spanC{Î·0â†‘,Î·0â†“},
the Parrondo-like paradox cannot occur.
Proof
Let Ïˆ(n) = U nÎ·0â†‘and Î¾(n) = U nÎ·0â†“. Then Î¾(n) is related to Ïˆ(n) by the following, for
each n âˆˆ{1,...} and j âˆˆZ, depending on the case:
i)
Î¾(n)
j,â†‘= âˆ’Ï‰jâˆ’nÏˆ(n)
âˆ’j,â†“
Î¾(n)
j,â†“= Ï‰âˆ’jâˆ’nÏˆ(n)
âˆ’j,â†‘
ii)
Î¾(n)
j,â†‘= (âˆ’Ï‰)jâˆ’nÏˆ(n)
âˆ’j,â†“
Î¾(n)
j,â†“= (âˆ’Ï‰)âˆ’jâˆ’nÏˆ(n)
âˆ’j,â†‘
iii)
Î¾(n)
j,â†‘= âˆ’Ïˆ(n)
âˆ’j,â†“
Î¾(n)
j,â†“= Ïˆ(n)
âˆ’j,â†‘
iv)
Î¾(n)
j,â†‘= Ïˆ(n)
âˆ’j,â†“
Î¾(n)
j,â†“= Ïˆ(n)
âˆ’j,â†‘
v)
Î¾(n)
j,â†‘= (âˆ’1)j+n+1Ïˆ(n)
âˆ’j,â†“
Î¾(n)
j,â†“= (âˆ’1)j+nÏˆ(n)
âˆ’j,â†‘
vi)
Î¾(n)
j,â†‘= (âˆ’1)j+nÏˆ(n)
âˆ’j,â†“
Î¾(n)
j,â†“= (âˆ’1)j+nÏˆ(n)
âˆ’j,â†‘
(9.28)

CHAPTER 9. QUANTUM WALKS AND THE PARRONDO-LIKE PARADOX
107
Therefore, in any of the six cases,
tr [ L(U nÎ·0â†‘Î·âˆ—
0â†‘U âˆ—n)âˆ£A
L(U nÎ·0â†‘Î·âˆ—
0â†“U âˆ—n)âˆ£A
L(U nÎ·0â†“Î·âˆ—
0â†‘U âˆ—n)âˆ£A
L(U nÎ·0â†“Î·âˆ—
0â†“U âˆ—n)âˆ£A ] = tr [ tr P+Ïˆ(n)Ïˆ(n)âˆ—
tr P+Ïˆ(n)Î¾(n)âˆ—
tr P+Î¾(n)Ïˆ(n)âˆ—
tr P+Î¾(n)Î¾(n)âˆ—]
(9.29)
= âŸ¨(P+ + Pâˆ’)Ïˆ(n),Ïˆ(n)âŸ©â‰¤1
Hence, by theorem 8.4.1, for any initial wavefunctions Ïˆ,Î¾ in the subspace for spatial loca-
tion zero and any point on the geodesic joining [Ïˆ] and [Î¾], the paradox cannot occur. â—»
In particular, note this rules out the paradox for the case of constant coin walks of the
ï¬rst form with initial wavefunctions Ïˆ,Î¾ in the subspace for spatial location zero where the
coin is of the form [
Î±
âˆš
1 âˆ’âˆ£Î±âˆ£2
âˆš
1 âˆ’âˆ£Î±âˆ£2
âˆ’Î±
] for some Î± âˆˆC with âˆ£Î±âˆ£2 â‰¤1. Using a limit
theorem by Konno [42] [41], we have the following limiting result for more general constant
coin walks (not necessarily in the CMV-matrix form) adopting the second form of coined
quantum walks:
Theorem 9.3.2
If a quantum walk has constant coin presented in the second form, then
for any initial wavefunctions Ïˆ,Î¾ in the subspace for spatial location zero, spanC{Î·0â†‘,Î·0â†“},
the Parrondo-like paradox cannot occur in the limit as n â†’âˆ.
Proof
Adapting the terminology of Konno to our notation, let the coin be given by
[ b
a
d
c ]. The wavefunctions Î·0â†‘and Î·0â†“are given by Î² = 1,Î± = 0 and Î² = 0,Î± = 1 re-
spectively. Then, employing Konnoâ€™s limit theorem, the limit of the sum of probabilities,
lim
nâ†’âˆ(âŸ¨P+U nÏ„0â†‘,U nÏ„0â†‘âŸ©+ âŸ¨P+U nÏ„0â†“,U nÏ„0â†“âŸ©)
(9.30)
is given by
âˆ«
âˆ£aâˆ£
0
2
âˆš
1 âˆ’âˆ£aâˆ£2
Ï€(1 âˆ’x2)
âˆš
âˆ£aâˆ£2 âˆ’x2dx = 1
(9.31)
Hence, by theorem 8.4.1, for any initial wavefunctions Ïˆ,Î¾ in the subspace for spatial location
zero and any point on the geodesic joining [Ïˆ] and [Î¾], the paradox cannot occur in the limit
as n â†’âˆ. â—»
Examples of quantum walks displaying the paradox to the
maximal extent
Example 9.3.3
With the above set-up, take initial wavefunctions Ïˆ =
1
âˆš
2 (Î·0â†‘+ Î·0â†“) and
Î¾ =
1
âˆš
2 (Î·0â†‘âˆ’Î·0â†“).
Then, halfway on the minimizing geodesic between them, the initial

CHAPTER 9. QUANTUM WALKS AND THE PARRONDO-LIKE PARADOX
108
wavefunction is Î·0â†‘. Take all the Verblunsky coeï¬ƒcients to be zero except for Î±âˆ’1, which has
value
1
âˆš
3. Let U be the corresponding CMV-matrix.
Let Ïˆ(n) = U nÏˆ, Î¾(n) = U nÎ¾, and Ï‡(n) = U nÎ·0â†‘for n â‰¥1. Then Ïˆ(n) has all amplitudes
zero except for
1
âˆš
2 for â†“at location n, âˆ’1
âˆš
6 for â†“at location n âˆ’1, and
1
âˆš
3 for â†‘at location
âˆ’n; Î¾(n) has all amplitudes zero except for âˆ’1
âˆš
2 for â†“at location n, âˆ’1
âˆš
6 for â†“at location
n âˆ’1, and
1
âˆš
3 for â†‘at location âˆ’n; and Ï‡(n) has all amplitudes zero except for
âˆš
2
3 for â†‘at
location âˆ’n and âˆ’1
âˆš
3 for â†“at location n âˆ’1. Consequently, PA,n = P â€²
A,n = 2
3 for all n > 1, yet
P geo
A,n = 1
3 for the initial wavefuntion halfway on the minimizing geodesic. By theorem 8.3.2,
this example is on the boundary of allowed values of (PA,n,P â€²
A,n,P geo
A,n) for the paradox.
Example 9.3.4
Again with the above set-up, let U be the matrix for the constant coin walk
in the second form with coin
1
âˆš
2 [ 1
1
âˆ’1
1 ]. Take Îµ > 0 small. Take Ïƒ1 > 0 suï¬ƒciently small
relative to Îµ such that the normal distribution with mean Îµ and variance Ïƒ2
1 has neglectfully
small measure for (âˆ’âˆ,0). Take a âˆˆ(âˆ’Ï€
2,0) and Ïƒ2 > 0 such that: (i) the normal distribution
with mean a and variance Ïƒ2
2 has neglectfully small measure outside (âˆ’Ï€
2,0) and (ii) we have
âˆ«kâˆˆ(âˆ’Ï€
2 ,0)
âˆ’sink
âˆš
1 + cos2 k
dNormal(a,Ïƒ2)(k) = 1
3
(9.32)
Let Ï•,Î¶ âˆ¶Z â†’C be given by
Ï•j =
4
âˆš
2Ïƒ2
1
Ï€ eâˆ’Ïƒ2
1j2+Ä±( Ï€
2 âˆ’Îµ)j =
1
âˆš
2Ï€ âˆ«
âˆ
âˆ’âˆ
exp(âˆ’
(kâˆ’( Ï€
2 âˆ’Îµ))2
4Ïƒ2
1
+ Ä±jk)
4âˆš
2Ï€Ïƒ2
1
dk
(9.33)
â‰ˆ
1
âˆš
2Ï€ âˆ«
Ï€
âˆ’Ï€
exp(âˆ’
(kâˆ’( Ï€
2 âˆ’Îµ))2
4Ïƒ2
1
+ Ä±jk)
4âˆš
2Ï€Ïƒ2
1
dk
Î¶j =
4
âˆš
2Ïƒ2
2
Ï€ eâˆ’Ïƒ2
2j2+Ä±aj =
1
âˆš
2Ï€ âˆ«
âˆ
âˆ’âˆ
exp(âˆ’(kâˆ’a)2
4Ïƒ2
2
+ Ä±jk)
4âˆš
2Ï€Ïƒ2
2
dk
(9.34)
â‰ˆ
1
âˆš
2Ï€ âˆ«
Ï€
âˆ’Ï€
exp(âˆ’(kâˆ’a)2
4Ïƒ2
2
+ Ä±jk)
4âˆš
2Ï€Ïƒ2
2
dk

CHAPTER 9. QUANTUM WALKS AND THE PARRONDO-LIKE PARADOX
109
Then, by the inversion of Fourier series,
âˆ‘
jâˆˆZ
âˆ£Ï•jâˆ£2 = âˆ«
âˆ
âˆ’âˆ
exp(âˆ’
(kâˆ’( Ï€
2 âˆ’Îµ))2
2Ïƒ2
1
)
âˆš
2Ï€Ïƒ2
1
dk = 1
(9.35)
âˆ‘
jâˆˆZ
âˆ£Î¶jâˆ£2 = âˆ«
âˆ
âˆ’âˆ
exp(âˆ’(kâˆ’a)2
2Ïƒ2
2 )
âˆš
2Ï€Ïƒ2
2
dk = 1
âˆ‘
jâˆˆZ
Ï•jÎ¶j = âˆ«
âˆ
âˆ’âˆ
exp(âˆ’
(kâˆ’( Ï€
2 âˆ’Îµ))2
2Ïƒ2
1
âˆ’(kâˆ’a)2
4Ïƒ2
2 )
4âˆš
2Ï€Ïƒ2
1
4âˆš
2Ï€Ïƒ2
2
dk â‰ˆ0
Hence, if the initial wavefunctions are taken to be Ïˆ = 1
2(Î¶+Ï•)âŠ—[ Ä±
1 ] and Î¾ = 1
2(Î¶âˆ’Ï•)âŠ—[ Ä±
1 ],
they will be properly normalized and approximately orthogonal. Midway on the geodesic
joining them, we have Ï‡ =
1
âˆš
2Î¶ âŠ—[ Ä±
1 ].
Now suppose for the observations we always lump the internal states for any spatial sites,
so the Ïƒ-algebra for the observations is that generated by only the spatial locations. Let
{QB} be the complete set of mutually commuting, orthogonal projectors for this Ïƒ-algebra.
Deï¬ne Îº âˆ¶R â†’[âˆ’Ï€,Ï€] by
Îº(x) =
â§âªâªâªâªâªâ¨âªâªâªâªâªâ©
arccos
x
âˆš
1âˆ’x2
if x âˆˆ[âˆ’1
âˆš
2,
1
âˆš
2]
0
if x âˆˆ[ 1
âˆš
2,âˆ)
Ï€
if x âˆˆ(âˆ’âˆ,âˆ’1
âˆš
2]
(9.36)
Then, for each n, let the complete set of commuting projectors {R(n)
C } for the Borel Ïƒ-
algebra on [0,Ï€] be given by R(n)
C
= Q(nâ‹…Îºâˆ’1(C))âˆ©Z. By Machidaâ€™s limit theorem [48] [49], the
weak*-limit of the measures Âµ(n) = âŸ¨R(n)U nÏˆ,U nÏˆâŸ©exists and is given by
Âµ(âˆ) â‰ˆ1
2Normal(Ï€
2 âˆ’Îµ,Ïƒ2
2) + 1
4 (1 âˆ’
sink
âˆš
1 + cos2 k
)Normal(âˆ’a,Ïƒ2)
(9.37)
+ 1
4 (1 +
sink
âˆš
1 + cos2 k
)Normal(Ï€ + a,Ïƒ2)
Similarly, the weak*-limit of the measures Î½(n) = âŸ¨Q(n)U nÎ¾,U nÎ¾âŸ©exists and is given by the
same expression. For both of these, there is approximately 1
2 + 1
4 (1 âˆ’1
3) = 2
3 probability to
have k âˆˆ[0, Ï€
2), which corresponds to spatial locations with positive index j. The weak*-limit
of the measures Ï„ (n) = âŸ¨Q(n)U nÏ‡,U nÏ‡âŸ©also exists and is given by
Ï„ (âˆ) â‰ˆ1
2 (1 âˆ’
sink
âˆš
1 + cos2 k
)Normal(âˆ’a,Ïƒ2) + 1
2 (1 +
sink
âˆš
1 + cos2 k
)Normal(Ï€ + a,Ïƒ2)
(9.38)

CHAPTER 9. QUANTUM WALKS AND THE PARRONDO-LIKE PARADOX
110
However, now there is only approximately 1
2 (1 âˆ’1
3) = 1
3 probability to have k âˆˆ[0, Ï€
2). These
values of two-thirds for PA, two-thirds for P â€²
A, and one-third for P geo
A
can be arbitrarily
closely approached by taking Îµ, Ïƒ1, and Ïƒ2 suï¬ƒciently small. By theorem 8.3.2, this example
can approach arbitrarily closely to the boundary of allowed values of (PA,P â€²
A,P geo
A ) for the
paradox.
Remark
The results of the preceding example also hold for the commonly employed
Hadamard coin
1
âˆš
2 [ 1
1
1
âˆ’1 ]. Then the matrix U is the adjoint of a CMV-matrix with
all Verblunsky coeï¬ƒcients with even index equal to
1
âˆš
2. For the Hadamard coin, we take
initial wavefunctions to be Ïˆ = 1
2(Î¶ + Ï•) âŠ—[ Ä±
âˆ’1 ] and Î¾ = 1
2(Î¶ âˆ’Ï•) âŠ—[ Ä±
âˆ’1 ], so we have
Ï‡ =
1
âˆš
2Î¶ âŠ—[ Ä±
âˆ’1 ], where
Ï•j =
4
âˆš
2Ïƒ2
1
Ï€ eâˆ’Ïƒ2
1j2+Ä±Îµj
(9.39)
Î¶j =
4
âˆš
2Ïƒ2
2
Ï€ eâˆ’Ïƒ2
2j2âˆ’Ä±( Ï€
2 +a)j
(9.40)
for a, Îµ, Ïƒ1, and Ïƒ2 as in the given example. The coin utilized in the example was chosen to
agree with that used by Machida [48] [49].

111
Bibliography
[1]
M. Abramowitz and I.A. Stegun, eds. Handbook of Mathematical Functions. National
Bureau of Standards, Applied Mathematics Series 55. Washington: U.S. Government
Printing Oï¬ƒce, 1964, pp. 773â€“774.
[2]
Y. Aharonov, S. Popescu, and J. Tollaksen. â€œA time-symmetric formulation of quan-
tum mechanicsâ€. In: Physics Today (2010).
[3]
S.L. Altmann. Is Nature Supernatural? A Philosophical Exploration of Nature and
Science. New York: Prometheus Books, 2002.
[4]
J. Baggott. Farewell to Reality: How Modern Physics has Betrayed the Search for
Scientiï¬c Truth. New York: Pegasus Books, 2013.
[5]
E. Beckenstein and L. Narici. Topological Vector Spaces. Monographs and Textbooks
in Pure and Applied Mathematics 95. New York: Marcel Dekker, Inc., 1985, pp. 87â€“
88.
[6]
J.S. Bell. â€œOn the Einstein-Podolsky-Rosen Paradoxâ€. In: Physics 1 (1964).
[7]
B.H. Bennet et al. â€œTeleporting an unknown quantum state via dual classical and
Einstein-Podolsky-Rosen channelsâ€. In: Physical Review Letters 70.13 (1993).
[8]
M.J. Cantero, L. Moral, and L. VelÂ´azquez. â€œFive-dimensional matrices and zeros
of orthogonal polynomials on the unit circleâ€. In: Linear Algebra Applications 362
(2003), pp. 29â€“56.
[9]
M.J. Cantero, L. Moral, and L. VelÂ´azquez. â€œMinimal representations of unitary oper-
ators and orthogonal polynomials on the unit circleâ€. In: Linear Algebra Applications
408 (2005), pp. 40â€“65.
[10]
M.J. Cantero et al. â€œMatrix valued SzegÂ¨o polynomials and quantum random walksâ€.
In: Communications on Pure and Applied Mathematics 63 (2010), pp. 464â€“507.
[11]
N. Cartwright. A Dappled World: A Sudy of the Boundaries of Science. Cambridge:
Cambridge University Press, 1999.
[12]
N. Cartwright. How the Laws of Physics Lie. New York: Oxford University Press,
1983.
[13]
A. Cho. â€œFurtive approach rolls back the limits of quantum uncertaintyâ€. In: Science
(2011), pp. 690â€“693.

BIBLIOGRAPHY
112
[14]
B. Cirelâ€™son. â€œQuantum Generalizations of Bellâ€™s Inequalityâ€. In: Letters un Mathe-
matical Physics 4 (1980).
[15]
J.F. Clauser et al. â€œProposed experiment to test local hidden-variable theoriesâ€. In:
Physical Review Letters 23 (1969).
[16]
J.W. Demmel. Applied Numerical Linear Algebra. Society for Industrial and Applied
Mathematics 199-200. Philadelphia: American Mathematical Society, 1997.
[17]
J. Diestel, J.H. Fourie, and J. Swart. The Metric Theory of Tensor Products: Grothendieckâ€™s
Resume Revisited. Providence: American Mathematical Society, 2008, p. 7.
[18]
J. Diestel and J.J. Uhl. Vector Measures. Mathematical surveys 15. Providence: Amer-
ican Mathematical Society, 1977, pp. 217â€“219.
[19]
P.A.M. Dirac. The Principles of Quantum Mechanics. Oxford: Claredon Press, 1930,
p. 35.
[20]
P.A.M. Dirac. The Principles of Quantum Mechanics. Oxford: Claredon Press, 1930,
p. 36.
[21]
H.R. Dowson. Spectral Theory of Linear Operators. London Mathematics Society
Monograms 12. London: Academic Press, Inc., 1978, pp. 50â€“52.
[22]
R. Durrett. Probability Theory and Examples. 3rd ed. Belmont: Brooks/Cole, 2005,
p. 108.
[23]
E.G. Eï¬€ros and Z.J. Ruan. Operator Spaces. London Mathematical Society Monographsâ€“
New Series 23. Oxford: Clarendon Press, 2000, p. 25.
[24]
F. Engels. Dialectics of Nature. Written between 1872 and 1882. Translated and edited
by C. Dutt. New York: International Publishers, 1940, p. 243.
[25]
W. Feller. An Introduction to Probability Theory and its Applications. New York: John
Wiley & Sons, Inc., 1950, pp. 430â€“432.
[26]
F.Hausdorï¬€. Set Theory. 2nd ed. New York: Chelsea Publishing Company, 1962,
pp. 96â€“108.
[27]
F.Hausdorï¬€. Set Theory. 2nd ed. New York: Chelsea Publishing Company, 1962, p. 72.
[28]
A.P. Flitney, J. Ng, and D. Abbott. â€œQuantum Parrondoâ€™s Gamesâ€. In: Physica A
314 (2002), pp. 35â€“42.
[29]
A.M. Gleason. â€œMeasures on the closed subspaces of a Hilbert spaceâ€. In: Journal of
Mathematics and Mechanics 6.6 (1957), pp. 885â€“893.
[30]
F.A. GrÂ¨unbaum. â€œAn urn model associated with Jacobi polynomialsâ€. In: Communi-
cations in Applied Mathematics and Computational Science 5.1 (2010), pp. 55â€“63.
[31]
F.A. GrÂ¨unbaum and M. Pejic. â€œMaximal Parrondoâ€™s Paradox for Classical and Quan-
tum Markov Chainsâ€. In: Letters in Mathematical Physics (2015). submitted.
[32]
M.B. Hesse. The Structure of Scientiï¬c Inference. London: Macmillan, 1974.

BIBLIOGRAPHY
113
[33]
J. Hopkins. Nicholas of Cusa On Learned Ignorance: A Translation and Appraisal of
De Docta Ignorantia. Written in 1440. Minneapolis: The Arthur J. Banning Press,
1981, p. 51.
[34]
W. James. Pragmatism: A new name for some old ways of thinking. New York: Long-
mans, Green & Co., 1907. Chap. What pragmatism means.
[35]
W. James. Some Problems of Philosophy. New York: Longmans, Green & Co., 1911.
Chap. Precept and conceptâ€“the import of concepts.
[36]
J. Jeans. Physics and Philosophy. New York: The Macmillan Company, 1943.
[37]
F.V. Jensen. Bayesian Networks and Decision Graphs. Statistics for Engineering and
Information Science. New York: Springer-Verlang, 2001, pp. 35â€“44.
[38]
F.V. Jensen. Bayesian Networks and Decision Graphs. Statistics for Engineering and
Information Science. New York: Springer-Verlang, 2001, pp. 37,65.
[39]
S. Kochen and E.P. Specker. â€œThe Problem of Hidden Variables in Quantum Mechan-
icsâ€. In: Journal of Mathematics and Mechanics 17.1 (1967), pp. 75â€“81.
[40]
S. Kochen and E.P. Specker. â€œThe Problem of Hidden Variables in Quantum Mechan-
icsâ€. In: Journal of Mathematics and Mechanics 17.1 (1967).
[41]
N. Konno. â€œA new type of limit theorem for the one-dimensional quantum random
walkâ€. In: Journal of the Mathematical Society of Japan 57 (2005), pp. 1179â€“1195.
[42]
N. Konno. â€œLimit theorems and absorption problems for quantum random walks in
one dimensionâ€. In: Quantum Information and Computation 2 (2002). Special issue,
pp. 578â€“595.
[43]
K. Kuratowski. Topology. Vol. 1.
[44]
K. Kuratowski. Topology. Vol. 1.
[45]
G. Lackoï¬€and M. Johnson. Philosphy in the Flesh: The embodied mind and its chal-
lenge to Western Thought. New York: Basic Books, 1999.
[46]
R.E. Lee. The Background and Foundation of Modern Science: An Integration of the
Natural Sciences for the Orientation of College Freshmen. Baltimore: The Williams
& Wilkens Company, 1935.
[47]
A.D. Lorenzo. â€œReassessment of Leggett Inequalityâ€. In: Foundations of Physics 43
(2011), pp. 685â€“698.
[48]
T. Machida. â€œA quantum walk with a delocalized initial state: contribution from a
coin-ï¬‚ip operatorâ€. In: International Journal of Quantum Information ().
[49]
T. Machida. â€œRealization of the probability laws in the quantum central limit the-
orems by a quantum walkâ€. In: Quantum Information and Computation 13 (2013),
pp. 430â€“438.
[50]
J.J. Martin. Bayesian Decision Problem and Markov Chains. New York: John Wiley
& Sons, Inc., 1967, p. 62.

BIBLIOGRAPHY
114
[51]
N.D. Mermin. Quantum Computer Science. Cambridge: Cambridge University Press,
2007, pp. 21â€“23.
[52]
D.A. Meyer. â€œNoisy quantum Parrondo gameâ€.
[53]
J.R. Munkres. Topology. 2nd ed. Upper Saddle River: Prentice Hall, 2000, p. 167.
[54]
J.R. Munkres. Topology. 2nd ed. Upper Saddle River: Prentice Hall, 2000, pp. 182â€“
185.
[55]
J.R. Munkres. Topology. 2nd ed. Upper Saddle River: Prentice Hall, 2000, pp. 62â€“74.
[56]
J.R. Munkres. Topology. 2nd ed. Upper Saddle River: Prentice Hall, 2000, pp. 252â€“
257.
[57]
J.R. Munkres. Topology. 2nd ed. Upper Saddle River: Prentice Hall, 2000, pp. 169â€“
170.
[58]
J.R. Munkres. Topology. 2nd ed. Upper Saddle River: Prentice Hall, 2000, p. 225.
[59]
J.R. Munkres. Topology. 2nd ed. Upper Saddle River: Prentice Hall, 2000, p. 176.
[60]
F.W. Nietzsche. Der Wille zur Macht: Versuch einer Umwertung aller Werte. Com-
pilation of notes written in 1883-1888. Leipzig: Naumann, 1906.
[61]
J.R. Norris. Markov Chains. Cambridge Series in Statistical and Probabilistic Math-
ematics. Cambridge: Cambridge University Press, 1997, pp. 40â€“46.
[62]
N.R. Norris. Markov Chains. Cambridge Series in Statistical and Probabilistic Math-
ematics. Cambridge: Cambridge University Press, 1997, pp. 33â€“39.
[63]
J.C. Oxtoby. â€œInvariant measures in groups which are not locally compactâ€. In: Trans-
actions of the American Mathematical Society 60.2 (1946), pp. 215â€“237.
[64]
J. Parrondo and P. Espagnol. â€œCriticism of Feynmanâ€™ analysis of the ratchet as an
engineâ€. In: American Journal of Physics 64 (1996).
[65]
G.K. Pedersen. C*-algebras and their Automorphism Groups. London: Academic Press,
Inc., 1979, p. 52.
[66]
A.L. Peressini. Ordered Topological Vector Spaces. Harperâ€™s Series in Modern Mathe-
matics. New York: Harper & Row, 1967, p. 7.
[67]
H. PoincarÂ´e. La Science et lâ€™Hypoth`ese. Paris: Ernest Flammarion, 1902.
[68]
K.R. Popper. Objective Knowledge: An Evolutionary Approach. New York: Oxford
University Press, 1972.
[69]
M.M. Rao. Measure Theory and Integration. New York: John Wiley & Sons, Inc.,
1987, pp. 339â€“344.
[70]
M.M. Rao. Measure Theory and Integration. New York: John Wiley & Sons, Inc.,
1987, pp. 413â€“439.
[71]
N. Rescher. The Limits of Science. Berkeley: University of California Press, 1984.

BIBLIOGRAPHY
115
[72]
H.L. Royden. Real Analysis. 3rd ed. Upper Saddle River: Prentice Hall, 1988, pp. 276â€“
278.
[73]
H.L. Royden. Real Analysis. 3rd ed. Upper Saddle River: Prentice Hall, 1988, pp. 256â€“
257.
[74]
H.L. Royden. Real Analysis. 3rd ed. Upper Saddle River: Prentice Hall, 1988, pp. 307â€“
309.
[75]
H.L. Royden. Real Analysis. 3rd ed. Upper Saddle River: Prentice Hall, 1988, p. 267.
[76]
H.L. Royden. Real Analysis. 3rd ed. Upper Saddle River: Prentice Hall, 1988, p. 278.
[77]
H.L. Royden. Real Analysis. 3rd ed. Upper Saddle River: Prentice Hall, 1988, pp. 268â€“
270.
[78]
H.L. Royden. Real Analysis. 3rd ed. Upper Saddle River: Prentice Hall, 1988, p. 357.
[79]
H.L. Royden. Real Analysis. 3rd ed. Upper Saddle River: Prentice Hall, 1988, pp. 331â€“
335.
[80]
H.L. Royden. Real Analysis. 3rd ed. Upper Saddle River: Prentice Hall, 1988, pp. 197â€“
198.
[81]
H.L. Royden. Real Analysis. 3rd ed. Upper Saddle River: Prentice Hall, 1988, p. 201.
[82]
H.L. Royden. Real Analysis. 3rd ed. Upper Saddle River: Prentice Hall, 1988, p. 274.
[83]
H.L. Royden. Real Analysis. 3rd ed. Upper Saddle River: Prentice Hall, 1988, p. 284.
[84]
H.L. Royden. Real Analysis. 3rd ed. Upper Saddle River: Prentice Hall, 1988, pp. 248â€“
249.
[85]
H.L. Royden. Real Analysis. 3rd ed. Upper Saddle River: Prentice Hall, 1988, pp. 237â€“
238.
[86]
H.L. Royden. Real Analysis. 3rd ed. Upper Saddle River: Prentice Hall, 1988, p. 240.
[87]
H.L. Royden. Real Analysis. 3rd ed. Upper Saddle River: Prentice Hall, 1988, p. 223.
[88]
H.L. Royden. Real Analysis. 3rd ed. Upper Saddle River: Prentice Hall, 1988, p. 25.
[89]
H.L. Royden. Real Analysis. 3rd ed. Upper Saddle River: Prentice Hall, 1988, p. 259.
[90]
H.L. Royden. Real Analysis. 3rd ed. Upper Saddle River: Prentice Hall, 1988, p. 53.
[91]
H.L. Royden. Real Analysis. 3rd ed. Upper Saddle River: Prentice Hall, 1988, pp. 204â€“
206.
[92]
H.L. Royden. Real Analysis. 3rd ed. Upper Saddle River: Prentice Hall, 1988, pp. 291â€“
298.
[93]
H.L. Royden. Real Analysis. 3rd ed. Upper Saddle River: Prentice Hall, 1988, p. 406.
[94]
H.L. Royden. Real Analysis. 3rd ed. Upper Saddle River: Prentice Hall, 1988, p. 396.
[95]
H.L. Royden. Real Analysis. 3rd ed. Upper Saddle River: Prentice Hall, 1988, p. 397.

BIBLIOGRAPHY
116
[96]
H.L. Royden. Real Analysis. 3rd ed. Upper Saddle River: Prentice Hall, 1988, p. 309.
[97]
H.L. Royden. Real Analysis. 3rd ed. Upper Saddle River: Prentice Hall, 1988, p. 260.
[98]
H.L. Royden. Real Analysis. 3rd ed. Upper Saddle River: Prentice Hall, 1988, p. 191.
[99]
H.L. Royden. Real Analysis. 3rd ed. Upper Saddle River: Prentice Hall, 1988, pp. 17â€“
19.
[100]
H.L. Royden. Real Analysis. 3rd ed. Upper Saddle River: Prentice Hall, 1988, p. 274.
[101]
H.L. Royden. Real Analysis. 3rd ed. Upper Saddle River: Prentice Hall, 1988, p. 408.
[102]
H.L. Royden. Real Analysis. 3rd ed. Upper Saddle River: Prentice Hall, 1988, pp. 303â€“
304.
[103]
H.L. Royden. Real Analysis. 3rd ed. Upper Saddle River: Prentice Hall, 1988, p. 200.
[104]
H.L. Royden. Real Analysis. 3rd ed. Upper Saddle River: Prentice Hall, 1988, p. 157.
[105]
H.L. Royden. Real Analysis. 3rd ed. Upper Saddle River: Prentice Hall, 1988, p. 179.
[106]
H.L. Royden. Real Analysis. 3rd ed. Upper Saddle River: Prentice Hall, 1988, p. 53.
[107]
R.A. Ryan. Introduction to Tensor Products of Banach Spaces. Springer Monographs
in Mathematics. London: Springer-Verlag, 2002.
[108]
R.A. Ryan. Introduction to Tensor Products of Banach Spaces. Springer Monographs
in Mathematics. London: Springer-Verlag, 2002, p. 94.
[109]
ShË†oichirË†o Sakai. Markov Chains. Ergebnisse der Mathematik und ihrer Grenzgebiete
60. New York: Springer-Verlang, 1971, pp. 102â€“103.
[110]
ShË†oichirË†o Sakai. Markov Chains. Ergebnisse der Mathematik und ihrer Grenzgebiete
60. New York: Springer-Verlang, 1971, p. 48.
[111]
Z. Semadeni. Banach Spaces of Continuous Functions. Vol. 1.
[112]
Z. Semadeni. Banach Spaces of Continuous Functions. Vol. 1.
[113]
Z. Semadeni. Banach Spaces of Continuous Functions. Vol. 1.
[114]
E. Seneta. Non-negative Matrices and Markov Chains. Springer series in Statistics.
New York: Springer-Verlang, 2002, pp. 35â€“44.
[115]
C.E. Shannon and W. Weaver. The Mathematical Theory of Communication. Urbana:
University of Illinois Press, 1949.
[116]
W. SierpiÂ´nnski. Cardinal and Ordinal Numbers. Monograï¬e Matematyczne 34. War-
saw: PaÂ´nstwowe Wydawnictwo Naukowe.
[117]
B. Simon. Orthogonal Polynomials on the Unit Circle. Vol. 2. American Mathematical
Society Colloquium Publications 54. Providence: American Mathematical Society,
2005.
[118]
W.F. Stinespring. â€œPositive functions on C*-algebrasâ€. In: Proceedings of the Amer-
ican Mathematical Society 6.2 (1955), pp. 211â€“216.

BIBLIOGRAPHY
117
[119]
G. SzegÂ¨o. Orthogonal Polynomials. American Mathematical Society Colloquium Pub-
lications 23. New York: American Mathematical Society, 1939.
[120]
T. Traynor. â€œAn elementary proof of the Lifting theoremâ€. In: Paciï¬c Journal of
Mathematics 53 (1974), pp. 267â€“272.
[121]
A.I. Tulcea. Topics in the theory of lifting. Ergebnisse der Mathematik und ihrer
Grenzgebiete 48. Berlin: Springer, 1969.
[122]
H. Vaihinger. Die Philosophie des Als Ob: System der theoretischen, praktischen, und
religiÂ¨osen Fiktionen der Menschenheit auf Grund eines idealistischen Positivismus.
Mit einem Anhag Â¨uber Kant und Nietzsche. Written as a dissertation in 1877. Leipzig:
Felix Meiner Verlag, 1911.
[123]
W.F. Wertz. Towards a New Council of Florence: On the Peace of Faith and Other
Works by Nicolaus of Cusa. Chap. On Conjectures.
[124]
A. Wilansky. Modern Methods in Topological Vector Spaces. New York: McGraw-Hill,
Inc., 1978, p. 237.
[125]
A. Wilansky. Modern Methods in Topological Vector Spaces. New York: McGraw-Hill,
Inc., 1978, p. 17.
[126]
W.K. Wooters and W.H. Zureck. â€œA single quantum cannot be clonedâ€. In: Nature
299 (1982), pp. 802â€“803.

118
Appendix A
General propositions
A.1
Banach space propositions
Notation
Let A, B,. . . denote Banach spaces.
Proposition A1.1
Maps in B(A,B) are continuous in the weak topologies on A and B.
Proof
Take any such map L. For any weak neighborhood
N(La;Ï†1,...,Ï†n;Îµ) = {b âˆˆBâˆ£âˆ£Ï†j(b âˆ’La)âˆ£< Îµ for j âˆˆ{1,...,n}}
(A.1)
with a âˆˆA, Ï†1,...,Ï†n âˆˆBâˆ—, and Îµ > 0 we have
L(N(a;Lâˆ—Ï†1,...,Lâˆ—Ï†n;Îµ)) = N(La;Ï†1,...,Ï†n;Îµ)
â—»
(A.2)
Corollary A1.2
A map in L âˆˆB(A,B) is uniquely determined by its values on a weakly
dense subset.
Comment
Starting with a weakly dense subset that is a vector space, its norm closure
is necessarily a linear subspace by the properties of Cauchy sequences. Since this subspace
is convex, by the separating theorem [86], it cannot be weakly dense unless it is the entire
space; hence, a weakly dense subset is necessarily also norm-dense. This argument is not
entirely satisfactory since the separating theorem uses the Hahn-Banach theorem [87], which
depends on the axiom of choice [88]. This deï¬ciency will be rectiï¬ed for the situation of
interest by proposition B1.3 below.
The following important proposition is assigned as an exercise in [125].
Proposition A1.3
Let A and B be Banach spaces. A subset V of A that is a vector space
uniquely determines a map L âˆˆB(A,B) if V is dense in the norm topology on A and the
operator norm of L restricted to V is bounded. The operator norm of L shares the bound to
the operator norm of its restriction.

APPENDIX A. GENERAL PROPOSITIONS
119
Proof
Since a continuous function is uniquely determined by its values on a weakly dense
subset, and since the norm topology is ï¬ner than the weak topology, if L exists, it is unique
by A1.2. For any a âˆˆA, deï¬ne La as the limit of the Cauchy sequence âŸ¨LajâŸ©âˆ
j=1, where
âŸ¨ajâŸ©âˆ
j=1 is any Cauchy sequence converging to a composed of elements of V. The choice of
Cauchy sequence does not matter because, given another Cauchy sequence âŸ¨bjâŸ©âˆ
j=1 converging
to a composed of elements of V, then âŸ¨aj âˆ’bjâŸ©âˆ
j=1 is a Cauchy sequence converging to zero,
so âŸ¨L(aj âˆ’bj)âŸ©âˆ
j=1 is a Cauchy sequence converging to zero. Since the product of a Cauchy
sequence with a scalar is a Cauchy sequence and the sum of two Cauchy sequences is a
Cauchy sequence, L is linear. â—»
A.2
Hilbert space propositions
Notation
Let H be a Hilbert space.
Proposition A2.1
Convergence of a countable sum of disjoint (PjPk = 0 if j â‰ k), or-
thogonal projectors, âˆ‘j Pj, to an orthogonal projector P is equivalent in the following four
topologies on B(H): ultrastrong-operator, strong-operator, ultraweak-operator1, and weak-
operator.
Proof
The weak-operator topology is courser than the other three, so convergence in any
of the others implies convergence in it. Suppose convergence occurs in the weak-operator
topology, so for any Ïˆ,Ïˆâ€² âˆˆH,
lim
kâ†’âˆâŸ¨(P âˆ’
k
âˆ‘
j=1
Pj)Ïˆ,Ïˆâ€²âŸ©= 0
(A.3)
Then, for any ï¬xed k,
âŸ¨P
k
âˆ‘
j=1
PjÏˆ,Ïˆâ€²âŸ©= lim
mâ†’âˆâŸ¨
m
âˆ‘
l=1
Pj
k
âˆ‘
j=1
PjÏˆ,Ïˆâ€²âŸ©= âŸ¨
k
âˆ‘
j=1
PjÏˆ,Ïˆâ€²âŸ©
(A.4)
Since Ïˆ,Ïˆâ€² were arbitrary, P âˆ‘k
j=1 Pj = âˆ‘k
j=1 Pj. Similarly, (âˆ‘k
j=1 Pj)P = âˆ‘k
j=1 Pj. Therefore,
(P âˆ’âˆ‘k
j=1 Pj)
2 = P âˆ’âˆ‘k
j=1 Pj, so P âˆ’âˆ‘k
j=1 Pj is itself an orthogonal projector (it is clearly
self-adjoint). Then, by taking Ïˆ = Ïˆâ€², this implies
lim
kâ†’âˆâˆ¥(P âˆ’
k
âˆ‘
j=1
Pj)Ïˆâˆ¥= 0
(A.5)
so convergence necessarily also occurs in the strong-operator topology. Since the sequence
of operators âŸ¨P âˆ’âˆ‘k
j=1 PjâŸ©
âˆ
k=1 is bounded in operator norm (all being projectors), the con-
vergence necessarily occurs in the ultrastrong-operator topology as well.
However, the
1Same as the weak* topology.

APPENDIX A. GENERAL PROPOSITIONS
120
ultrastrong-operator topology is ï¬ner than the others, so convergence in it implies con-
vergence in the other three. â—»
A.3
Transition function propositions
Notation
For the following, sets will be denoted X, Y,... and Ïƒ-algebras by E, F,.... The
spaces of ï¬nite, signed-measures on the given set with the given Ïƒ-algebra will be denoted
M(X;E), M(Y;F),.... These are Banach spaces using the total variation norm. Noteâ€“by
convention product measures are written using Ã— although they are actually tensor products
and should be written using âŠ—(see [111] for a use of the latter notation).
Following [69], we have the following:
Deï¬nition A3.1
For Ïƒ-algebras E on X and F on Y, a function Ï„(â‹…âˆ£â‹…) âˆ¶F Ã— X â†’R is a
transition function if: (i) for each x âˆˆX, Ï„(â‹…âˆ£x) âˆˆM(Y;F); and (ii) for each B âˆˆF, Ï„(Bâˆ£â‹…)
is a bounded, E-measurable function on X.
If Ï„(â‹…âˆ£â‹…) is positive and has the additional property that Ï„(Yâˆ£â‹…) = 1X, then it is termed a
transition probability function. The transition functions for speciï¬ed (E, X, F, Y) clearly
form a vector space. They form a Banach space using the norm
âˆ¥Ï„(â‹…âˆ£â‹…)âˆ¥= sup
xâˆˆX
âˆ¥Ï„(â‹…âˆ£x)âˆ¥total variation
(A.6)
A transition function Ï„(â‹…âˆ£â‹…) with speciï¬ed data (E, X, F, Y) induces a linear map L âˆˆ
B(M(X;E),M(Y;F)) via
(LÂµ)(B) = âˆ«xâˆˆX Ï„(Bâˆ£x)dÂµ(x)
(A.7)
Not every bounded linear map is induced by a transition function; in general, a pseudo-
transition â€œfunctionâ€ is required (see B2.7 and B2.8). However, we do have the following:
Proposition A3.2
If L âˆˆB(M(X;E),M(Y;F)) and K âˆˆB(M(Y;F),M(Z;G)) are both
induced by transition functions, then the composition K â—‹L is also induced by a transition
function.
Proof
Let L and K be such maps, with associated transition functions Ï„(â‹…âˆ£â‹…) and Î½(â‹…âˆ£â‹…).
Deï¬ne Ï‰(â‹…âˆ£â‹…) by
Ï‰(Câˆ£x) = âˆ«yâˆˆY Î½(Câˆ£y)d(Ï„(â‹…âˆ£x))(y)
(A.8)
for C âˆˆG and x âˆˆX. Then Ï‰(â‹…âˆ£x) âˆˆM(Z;G). To see that Ï‰(Câˆ£â‹…) is E-measurable, note
that, since Î½(Câˆ£â‹…) is F-measurable and bounded, there is a sequence of simple functions

APPENDIX A. GENERAL PROPOSITIONS
121
âŸ¨âˆ‘k bjk1BjkâŸ©converging uniformly to it. By the Dominated Convergence theorem [75], we
then have
Ï‰(Câˆ£x) = lim
jâ†’âˆâˆ‘
k
bjkÏ„(Bjkâˆ£x)
(A.9)
By [89], ï¬nite sums of measurable functions are measurable and the pointwise limit of a
sequence of measurable functions is measurable, so Ï‰(Câˆ£â‹…) is measurable. Hence, Ï‰(â‹…âˆ£â‹…) is a
transition function.
Now take any Âµ âˆˆM(X;E) and C âˆˆG. Then, using the preceding results,
((K â—‹L)(Âµ))(C) = âˆ«yâˆˆY Î½(Câˆ£y)d(LÂµ)(y) = lim
jâ†’âˆâˆ‘
k
bjk(LÂµ)(Bjk)
(A.10)
= lim
jâ†’âˆâˆ‘
k
bjk âˆ«xâˆˆX Ï„(Bjkâˆ£x)dÂµ(x) = âˆ«xâˆˆX Ï‰(Câˆ£x)dÂµ(x)
Hence, K â—‹L is induced by the transition function Ï‰(â‹…âˆ£â‹…). â—»
Proposition A3.3
If L âˆˆB(M(X;E),M(Z;G)) and K âˆˆB(M(Y;F),M(W;H)) are both
induced by transition functions, then the tensor product map K âŠ—L is well-deï¬ned and also
induced by a transition function.
Proof
Let L and K be such maps, with associated transition functions Ï„(â‹…âˆ£â‹…) and Î½(â‹…âˆ£â‹…).
Deï¬ne Ï‰(â‹…âˆ£â‹…) by Ï‰(â‹…âˆ£x,y) = Ï„(â‹…âˆ£x) Ã— Î½(â‹…âˆ£y) for each x âˆˆX and y âˆˆY. Then Ï‰(â‹…âˆ£x,y) is clearly
in M(X Ã— Y;I), where I is the Ïƒ-algebra generated by the rectangular subsets R = E Ã— F.
The rectangular subsets form a semialgebra2 Then the ï¬nite union of rectangular sets is an
algebra.
Following Hausdorï¬€[26], let R0 be the rectangular subsets R. For each ordinal Î±, let
RÎ± be the collection of subsets of X Ã— Y that are the countable intersection of subsets from
the various collections RÎ² for ordinals Î² < Î± if Î± is even and that are the countable union of
subsets from the various collections GÎ² for ordinals Î² < Î± if Î± is odd (where all limit ordinalsâ€“
those without a predecessorâ€“taken even). For clariï¬cation, using the standard notation [90],
R1 = RÏƒ, R2 = RÏƒÎ´, and so on for the ï¬nite ordinals.
Fix any ordinal Î± and suppose that for all subsets B in all collections RÎ² for Î² < Î± we
have the following property: there is an I-measurable Ï‰(Bâˆ£â‹…) such that
((L âŠ—K)Âµ)(B) = âˆ«(x,y)âˆˆXÃ—Y Ï‰(Bâˆ£x,y)dÂµ(x,y)
(A.11)
for any I-measure Âµ on X Ã— Y. Take any C âˆˆRÎ±. If Î± is odd, we have a sequence âŸ¨BjâŸ©of
subsets from the various RÎ² with Î² < Î± such that C = â‹ƒj Bj. Let Ï‰(Câˆ£â‹…) = â‹j Ï‰(Bjâˆ£â‹…). Then
Ï‰(Câˆ£â‹…) is I-measurable (see [89]) and we can extend L âŠ—K by
((L âŠ—K)Âµ)(C) = âˆ«(x,y)âˆˆXÃ—Y Ï‰(Câˆ£x,y)dÂµ(x,y)
(A.12)
2A collection of sets is a semialgebra if it is closed under intersection and the complement of any set is
a ï¬nite union of sets in the collection.

APPENDIX A. GENERAL PROPOSITIONS
122
for any I-measure Âµ on X Ã—Y; hence, since C was arbitrary, RÎ± has the property. Similarly,
if Î± is even, we have a sequence âŸ¨BjâŸ©of subsets from the various RÎ² with Î² < Î± such that
C = â‹‚j Bj. Let Ï‰(Câˆ£â‹…) = â‹€j Ï‰(Bjâˆ£â‹…). Then Ï‰(Câˆ£â‹…) is measurable and we can extend L âŠ—K by
(A.12); hence, RÎ± also has the property.
However, R0 has the propertyâ€“for any I-measure Âµ, (LâŠ—K)Âµ is uniquely determined on
the rectangular subsets by
((L âŠ—K)Âµ)(A Ã— B) = âˆ«(x,y)âˆˆXÃ—Y Ï„(Aâˆ£x)Î½(Bâˆ£y)dÂµ(x,y)
(A.13)
and Ï‰(AÃ—Bâˆ£x,y) = Ï„(Aâˆ£x)Î½(Bâˆ£y) is I-measurable (see [89])â€“so by transï¬nite induction [27] [116]
all the RÎ± have the property. Following Kuratowski [43], the Ïƒ-algebra I is given by the
union â‹ƒÎ± RÎ±. Therefore, Ï‰(â‹…âˆ£â‹…) is a transition function and induces a well-deï¬ned tensor
product map K âŠ—L. â—»
Comment
The preceding proof does not depend on the axiom of choice since the union
only needs to be taken up to the ordinal number for the minimal uncountable well-ordered
set [26] [43], whose existence does not depend on the axiom of choice [55].
Lemma A3.4
For any measure space (X,E,Âµ), any â€œfunctionâ€ f âˆˆL0(X;Âµ) contains some
E-measurable function.
Proof
Take any function g âˆˆf. For each x âˆˆX where g(x) âˆˆ{Â±âˆ,undeï¬ned}, redeï¬ne
g so g(x) = 0. The new g is still in f. Now construct the sequence of Âµ-measurable simple
functions âŸ¨gkâŸ©converging pointwise to g by
g0 = 0,g1 = 1{gâ‰¥1} âˆ’1{gâ‰¤âˆ’1}
(A.14)
and for k âˆˆ{1,2...},
gk+1 = 2k â‹…1{gâ‰¥2k} +
4kâˆ’1
âˆ‘
m=1
m
2k 1{ m+1
2k >gâ‰¥m
2k } +
âˆ’1
âˆ‘
m=âˆ’4k+1
m
2k 1{ mâˆ’1
2k <gâ‰¤âˆ’m
2k } âˆ’2k â‹…1{gâ‰¤âˆ’2k}
(A.15)
By the deï¬nition of the completion E0 of E [73], for each E0-measurable subset B, there is
some D âˆˆE such that D âŠƒâˆ¼B and Âµ(D) = Âµ(âˆ¼B); hence C =âˆ¼D is in E, is contained within
B, and has Âµ(C) = Âµ(B). Using this, for k âˆˆ{0,1,2...} there are subsets {Ck
m} âˆˆE such

APPENDIX A. GENERAL PROPOSITIONS
123
that:
C(k+1)
2k
âŠ‚{g â‰¥2k} and Âµ(D(k+1)
2k
) = 0 for D(k+1)
2k
= {g â‰¥2k} âˆ–C(k+1)
2k
(A.16)
C(k+1)
m
âŠ‚{m + 1
2k
> g â‰¥m
2k } and Âµ(C(k+1)
m
) = 0
for D(k+1)
m
= {m + 1
2k
> g â‰¥m
2k } âˆ–C(k+1)
2k
,m âˆˆ{1,2,...,4k âˆ’1}
(A.17)
C(k+1)
m
âŠ‚{m âˆ’1
2k
< g â‰¤âˆ’m
2k } and Âµ(D(k+1)
m
) = 0
for D(k+1)
m
= {m âˆ’1
2k
< g â‰¤âˆ’m
2k } âˆ–C(k+1)
2k
,m âˆˆ{âˆ’1,âˆ’2,...,âˆ’4k + 1}
(A.18)
C(k+1)
âˆ’2k
âŠ‚{g â‰¤âˆ’2k} and Âµ(D(k+1)
âˆ’2k ) = 0 for D(k+1) = {g â‰¤âˆ’2k} âˆ–C(k+1)
âˆ’2k
(A.19)
Hence, there is a sequence of E-measurable simple functions âŸ¨hkâŸ©, where
h0 = 0,h1 = 1C(1)
1
âˆ’1C(1)
âˆ’1 ,hk+1 =
4k
âˆ‘
m=âˆ’4k,mâ‰ 0
m
2k 1C(k+1)
m
(A.20)
Then âŸ¨hkâŸ©converges pointwise to a E-measurable function h [89]. The function h diï¬€ers from
g on at most the subset â‹ƒk â‹ƒm D(k)
m , which is the countable union of Âµ-null subsets; hence,
itself Âµ-null. Therefore, h is necessarily in f. â—»
For the following, (X,E,Âµ) is a measure space with Âµ(X) = 1 and F is a Ïƒ-algebra on Y.
Deï¬nition 3.5
A conditional probability Î½(â‹…âˆ£â‹…) is a L1(X;Âµ)+-valued, vector F-measure on
Y with the property that Ï„(Yâˆ£â‹…) = [1X].
Deï¬nition 3.6
A transition probability function Ï„(â‹…âˆ£â‹…) is a lift of a conditional probability
Î½(â‹…âˆ£â‹…) if Ï„(Bâˆ£â‹…) âˆˆÎ½(Bâˆ£â‹…) for every subset B âˆˆF.
Proposition A3.7
If either: (i) F is generated by countably many atoms; (ii) Y is an
uncountable, complete, separable, metric space with F the Borel Ïƒ-algebra; or (iii) E is gen-
erated by countably many atomsâ€“then for any marginal probability Âµ on X and conditional
probability Î½(â‹…âˆ£â‹…), there is some (generally non-unique) lift Ï„(â‹…âˆ£â‹…).
Proofâ€“case(i)
For each atom A âˆˆF, choose a particular, E-measurable function Ë†Î½(Aâˆ£â‹…) âˆˆ
Ë†Î½(Aâˆ£â‹…) (these exist by A3.4). The function Ë†Î½(Aâˆ£â‹…) can only be less than zero on a set of
Âµ-measure zero; hence, the set B1 where any of these functions is less than zero is still of
Âµ-measure zero. Furthermore, since the union of all atoms is X, we have
âˆ‘
atoms AâˆˆF
Ë†Î½(Aâˆ£â‹…) âˆˆÎ½(Xâˆ£â‹…) = [1X]
(A.21)

APPENDIX A. GENERAL PROPOSITIONS
124
where the sum on the left-hand side converges pointwise; hence, the function given by the
left-hand side has value one almost everywhere with respect to Âµ. Let B2 be the set with Âµ-
measure zero where it is not equal to one. Let B be a set in E with Âµ-measure zero containing
B1 âˆªB2 (such a set necessarily exists by the deï¬nition of Âµ-measure zero [89]). Then, deï¬ne
Ï„(â‹…âˆ£â‹…) by
Ï„(Bâˆ£x) =
â§âªâªâ¨âªâªâ©
âˆ‘atoms AâˆˆF,AâŠ‚B Ë†Î½(Aâˆ£x)
if x âˆ‰B
âˆ«X Î½(Bâˆ£â‹…) dÂµ
if x âˆˆB
(A.22)
for any B âˆˆF and x âˆˆX. It is readily seen that Ï„(â‹…âˆ£â‹…) is a lift of Î½(â‹…âˆ£â‹…).
Case(ii)
The obvious approach is to use the separable and metric properties to form
countable, locally ï¬nite open covers of decreasing radii using the paracompact property of
metric spaces [91] [56]â€“from these a sequence of reï¬ning partitions can be formed.
The
Ïƒ-algebra generated by these partitions is the Borel Ïƒ-algebra; one may then hope that a
procedure similar to the preceding with a choice for each element of each partition would
give the lift Ï„(â‹…âˆ£â‹…). However, while it easily seen this approach succeeds if a lift exists (and we
will show one does below), it cannot be used to prove the existence of a lift; the problem is
that to employ the Extension theorem [92] pointwise to get a measure, unlike the situation
above, there are an uncountable number of conditions that must be met. While each fails on
a set of measure zero, it is not clear that taken altogether the set where any one of them fails
is still only of measure zero. (The existence of a lift would give this, but that is what we are
trying to prove!) Instead, we will proceed in a diï¬€erent direction. The plan is to add in an
auxiliary measure space, namely [0,1] with the standard topology, the Borel Ïƒ-algebra, and
Lebesgue measure. Then we will construct a deterministic transition probability function3
(see A3.9 for the connection to another common concept of determinism); integrating over
the auxiliary space will then provide the desired lift.
Start with the result due to Kuratowski that Y is Borel equivalent4 to the interval [0,1]
with the standard topology [93]; let Ïˆ âˆ¶[0,1] â†’Y be the corresponding bijection. For Î»
Lebesgue measure on [0,1], let the Ïƒ-ideal5 N be the ÂµÃ—Î»-null subsets of Ïƒ (E Ã— Borel([0,1])).
For each Î± âˆˆ[0,1], let Ë†Î½(Ïˆ([0,Î±))âˆ£â‹…) be a particular E-measurable (not merely Âµ-measurable)
function from Î½(Ïˆ([0,Î±))âˆ£â‹…) (these exist by A3.4). Deï¬ne the equivalence class AÎ± of subsets
of X Ã— [0,1] by
â¡â¢â¢â¢â¢â£
â‹ƒ
sâˆˆ[0,1]
{xâˆ£Ë†Î½(Ïˆ([0,Î±))âˆ£x) > s} Ã— {s}
â¤â¥â¥â¥â¥â¦
=
â¡â¢â¢â¢â¢â£
â‹ƒ
qâˆˆQÃ—[0,1]
{xâˆ£Ë†Î½(Ïˆ([0,Î±))âˆ£x) > q} Ã— [0,q]
â¤â¥â¥â¥â¥â¦
(A.23)
3One taking only the values zero and one.
4Two topological spaces X and Y are Borel equivalent if there is a bijection Ïˆ âˆ¶X â†’Y such that both Ïˆ
and Ïˆâˆ’1 take Borel sets to Borel sets (so both Ïˆâˆ’1 and Ïˆ are Borel measurable).
5A Ïƒ-ideal is a subcollection of a Ïƒ-algebra that contains all subsets of member sets within the Ïƒ-algebra
and is closed under countable unions.

APPENDIX A. GENERAL PROPOSITIONS
125
where the equivalence class is taken over sets that diï¬€er by subsets in the Ïƒ-ideal N. Clearly
this is independent of the choice of Ë†Î½(Ïˆ([0,Î±))âˆ£â‹…). Note AÎ± = [X] for Î± > 1 and AÎ± = N for
Î± â‰¤0.
Then the collection {AÎ±} is a soma6 By [95], there is a Ïƒ (E Ã— Borel([0,1]))-measurable
function Ï• âˆ¶X Ã— [0,1] â†’[0,1] for which the soma7 of [Ï•] is AÎ±. (Note Ï• is not unique; any
particular function in [Ï•] will do.)
Now deï¬ne Ï„(Ïˆ([0,Î±))âˆ£â‹…) by
Ï„(Ïˆ([0,Î±))âˆ£x) = essential sup{s âˆˆ[0,1]âˆ£Ï•(x,s) âˆˆ[0,Î±)}
(A.24)
where the essential supremum is taken over equivalence classes of sets diï¬€ering by Lebesgue-
null sets. By Tonelliâ€™s theorem [96] , Ï„(Ïˆ([0,Î±))âˆ£â‹…) is an E-measurable function. Furthermore,
it is it Î½(Ïˆ([0,Î±))âˆ£â‹…). To see this, note that by Tonelliâ€™s theorem, for almost every x âˆˆX
with respect to Âµ, the sets
{s âˆˆ[0,1]âˆ£Ë†Î½(Ïˆ([0,Î±))âˆ£x) > s} and {s âˆˆ[0,1]âˆ£Ï•(x,s) âˆˆ[0,Î±)}
(A.25)
diï¬€er by only a Lebesgue measure zero subset. Taking the essential supremum over each set,
we have that Ë†Î½(Ïˆ([0,Î±))âˆ£â‹…) = Ï„(Ïˆ([0,Î±))âˆ£â‹…) almost everywhere with respect to Âµ.
More generally, for any B âˆˆBorel(Y), deï¬ne Ï„(Bâˆ£â‹…) by
Ï„(Bâˆ£x) = Î»({s âˆˆ[0,1]âˆ£Ïˆ â—‹Ï•(x,s) âˆˆB})
(A.26)
Since the composition of measurable functions is measurable (readily seen by the deï¬nition
of measurability), then, by Tonelliâ€™s theorem, Ï„(Bâˆ£â‹…) is E-measurable.
For each x âˆˆX,
Ï„(â‹…âˆ£x) is a Borel measure on Y with Ï„(Yâˆ£x) = 1. Finally, since the collection {[0,Î±)} over
Î± âˆˆR generates the Borel Ïƒ-algebra on [0,1], the collection {Ïˆ([0,Î±))} generates the Borel
Ïƒ-algebra on Y, so Ï„(Bâˆ£â‹…) âˆˆÎ½(Bâˆ£â‹…) for any B âˆˆBorel(Y).
Case(iii)
For each atom A âˆˆE with Âµ(A) > 0, Î½(Bâˆ£x) is well-deï¬ned for any x âˆˆA and
B âˆˆF, so Ï„(Bâˆ£x) is necessarily Î½(Bâˆ£x). On the remaining atoms, Ï„(â‹…âˆ£â‹…) can be set rather
arbitrarily; take it to be âˆ«X Î½(Bâˆ£â‹…) dÂµ for concreteness. â—»
Examining the proof of the preceding theorem, we have the following interesting result:
Proposition A3.8
If either: (i) F is generated by countably many atoms; or (ii) Y
is an uncountable, complete, separable, metric space with F the Borel Ïƒ-algebraâ€“then for
6Following [94], for Ïƒ-algebra E with Ïƒ-ideal given by null sets N, the collection of equivalence classes
indexed by reals {AÎ±} of E/N is a soma if: (i) AÎ± â‰¤AÎ² for Î± â‰¤Î²; and (ii) AÎ± = â‹j AÎ²j for any countable,
increasing sequence âŸ¨Î²jâŸ©converging to Î±.
7The soma of the equivalence class [f] of a real valued function f is the collection of equivalence classes
of preimages, [f âˆ’1((âˆ’âˆ,Î±))], over Î± âˆˆR.

APPENDIX A. GENERAL PROPOSITIONS
126
any transition probability function Ï„(â‹…âˆ£â‹…) âˆ¶F Ã— X â†’[0,1] there is a deterministic transition
probability function Î¾(â‹…âˆ£â‹…) âˆ¶F Ã— X Ã— [0,1] â†’{0,1} such that
Ï„(Bâˆ£x) = âˆ«sâˆˆ[0,1] Î¾(Bâˆ£x,s) dÎ»(s)
where Î» is Lebesgue measure on R.
Proof
First take case (i). By the deï¬nition of being countable, there is an ordering of the
atoms {Aj} for j âˆˆ{1,2,...} (with the indexing set truncating to j âˆˆ{1,2,...,n} if there are
only ï¬nitely many atoms). For m âˆˆ{1,2,...} (or m âˆˆ{1,2,...,n}), deï¬ne Bm by â‹ƒm
j=1 Aj
and Cm âŠ‚X Ã— [0,1] by
â‹ƒ
sâˆˆ[0,1]
{xâˆ£Ï„(Bmâˆ£x) > s} Ã— {s} =
â‹ƒ
qâˆˆQÃ—[0,1]
{xâˆ£Ï„(Bmâˆ£x) > q} Ã— [0,q]
(A.27)
Then âŸ¨CmâŸ©is an increasing, nested sequence of subsets in Ïƒ(E Ã— [0,1]) such that â‹ƒm Cm =
X Ã— [0,1].
Deï¬ne the function Ï• âˆ¶X Ã— [0,1] â†’Z+ by
Ï•(x,s) = âˆ‘
j
1Xâˆ–Cj
(A.28)
Deï¬ne Î¾(â‹…âˆ£â‹…) by
Î¾ (Bâˆ£x,s) =
â§âªâªâ¨âªâªâ©
1
if AÏ•(x,s) âŠ‚B
0
otherwise
(A.29)
for any B âˆˆF, x âˆˆX, and s âˆˆ[0,1]. Deï¬ne Ï„ â€²(â‹…âˆ£â‹…) by
Ï„ â€²(B â‹…x) = âˆ«sâˆˆ[0,1] Î¾(Bâˆ£x,s) dÎ»(s)
(A.30)
for any B âˆˆF and x âˆˆX. It is readily seen that Î¾(â‹…âˆ£â‹…) is a deterministic transition probability
function and Ï„ â€²(â‹…âˆ£â‹…) is a transition probability function. Furthermore, for any m âˆˆ{1,2,...}
(or m âˆˆ{1,2,...,n}),
Ï„ â€²(Bmâˆ£x) = âˆ«sâˆˆ[0,1] Î¾(Bmâˆ£x,s) dÎ»(s) = Î»(Cm âˆ©{x} Ã— [0,1]) = Ï„(Bmâˆ£x)
(A.31)
Since the collection {Bm} generates F, Ï„(â‹…âˆ£â‹…) = Ï„ â€²(â‹…âˆ£â‹…).
Now take case (ii). As with the proof of the preceding theorem, start with the proposition
that Y is Borel equivalent to the interval [0,1] with the standard topology; let Ïˆ âˆ¶[0,1] â†’Y
be the corresponding bijection. Deï¬ne the Ïƒ(E Ã— Borel([0,1]))-measurable subsets AÎ± of
X Ã— [0,1] by
AÎ± =
â‹ƒ
sâˆˆ[0,1]
{xâˆ£Ï„(Ïˆ([0,Î±))âˆ£x) > s} Ã— {s}
(A.32)
=
â‹ƒ
qâˆˆQÃ—[0,1]
{xâˆ£Ï„(Ïˆ([0,Î±))âˆ£x) > q} Ã— [0,q]
(A.33)

APPENDIX A. GENERAL PROPOSITIONS
127
Note AÎ± = X for Î± > 1 and AÎ± = âˆ…for Î± â‰¤0.
Then, following [97] the collection of ordinate sets {AÎ±} deï¬nes a Ïƒ(E Ã— Borel([0,1]))-
measurable function Ï• âˆ¶X Ã— [0,1] â†’[0,1] by
Ï•(x,s) = inf{Î± âˆˆRâˆ£(x,s) âˆˆAÎ±}
(A.34)
Deï¬ne Î¾(â‹…âˆ£â‹…) by
Î¾ (Bâˆ£x,s) =
â§âªâªâ¨âªâªâ©
1
if Ïˆ â—‹Ï•(x,s) âˆˆB
0
otherwise
(A.35)
for any B âˆˆF, x âˆˆX, and s âˆˆ[0,1]. Deï¬ne Ï„ â€²(â‹…âˆ£â‹…) by
Ï„ â€²(B â‹…x) = âˆ«sâˆˆ[0,1] Î¾(Bâˆ£x,s) dÎ»(s)
(A.36)
for any B âˆˆF and x âˆˆX. It is readily seen that Î¾(â‹…âˆ£â‹…) is a deterministic transition probability
function and Ï„ â€²(â‹…âˆ£â‹…) is a transition probability function. Furthermore, for any Î± âˆˆR,
Ï„ â€²(Ïˆ([0,Î±))âˆ£x) = âˆ«sâˆˆ[0,1] Î¾(Ïˆ([0,Î±))âˆ£x,s) dÎ»(s)
= Î»(AÎ± âˆ©{x} Ã— [0,1]) = Ï„(Ïˆ([0,Î±))âˆ£x)
(A.37)
Finally, since the collection {[0,Î±)} over Î± âˆˆR generates the Borel Ïƒ-algebra on [0,1], the
collection {Ïˆ([0,Î±))} generates the Borel Ïƒ-algebra on Y, so Ï„(â‹…âˆ£â‹…) = Ï„(â‹…âˆ£â‹…). â—»
Comment
Note the preceding can be readily extended to cover cases where Âµ is the zero
measure apart from a sub-Ïƒ-algebra of E generated by countably many atoms or the marginal
probability on Y formed from Î½(â‹…âˆ£â‹…) and Âµ is the zero measure apart from a sub-Ïƒ-algebra of
F generated by countably many atoms.
Proposition A3.9
If either: (i) F is generated by countably many atoms; or (ii) Y is an
uncountable, complete, separable, metric space with F the Borel Ïƒ-algebraâ€“then any deter-
ministic transition probability function Ï„(â‹…âˆ£â‹…) âˆ¶F Ã—X â†’{0,1} is induced by some measurable
point transformation f âˆ¶X â†’Y, Ï„(Bâˆ£x) = (1B â—‹f)(x).
Proof
First take case (i). For each x âˆˆX, take f(x) to be any value in the atom A âˆˆX
with the property Ï„(Aâˆ£x) = 1 â‡”Ï„(Y âˆ–Aâˆ£x) = 0.
Now take case (ii). As with the preceding proofs, start with the proposition that Y is
Borel equivalent to the interval [0,1] with the standard topology; let Ïˆ âˆ¶[0,1] â†’Y be the
corresponding bijection. For each x âˆˆX, take f(x) to be deï¬ned by
f(x) = Ïˆ (sup{Î± âˆˆ[0,1]âˆ£Ï„(Ïˆ([0,Î±))âˆ£x) = 0})
(A.38)
Then f is measurable since {(Î±,1]âˆ£Î± âˆˆR} generate the Borel subsets of [0,1], so {Ïˆ((Î±,1])âˆ£Î± âˆˆ
R} generate the Borel subsets of Y, and
f âˆ’1 (Ïˆ((Î±,1])) = {xâˆ£Ïˆâˆ’1 â—‹f(x) > Î±} = {xâˆ£Ï„(Ïˆ((Î±,1])âˆ£x) = 1} âˆˆE
â—»
(A.39)

APPENDIX A. GENERAL PROPOSITIONS
128
Proposition A3.10
If the marginal probability Âµ on X and conditional probability Î½(â‹…âˆ£â‹…)
are such that the resulting joint probability is absolutely continuous with respect to the
product measure ÂµÃ—Î· for some F-measure Î· on Y, then there is some (generally non-unique)
lift Ï„(â‹…âˆ£â‹…).
Proof
The joint probability measure Ï resulting from Âµ and Î½(â‹…âˆ£â‹…) is
Ï(A Ã— B) = âˆ«A Î½(Bâˆ£â‹…);dÂµ
(A.40)
for any rectangular subset A Ã— B âˆˆE Ã— F. By the Radon-NikodÂ´ym theorem [72], there is
a â€œfunctionâ€ g âˆˆL1(X Ã— Y;Âµ Ã— Î·), the Radon-NikodÂ´ym derivative g =
dÏ
d(Âµ Ã— Î·), such that
Ï = g Âµ Ã— Î·. Choose any particular Ïƒ(E Ã— F)-measurable function Ë†g âˆˆg (such a function
necessarily exists by A3.4). The function Ë†g is less than zero on a subset of Âµ Ã— Î·-measure
zero; by changing Ë†g to be zero there, the new Ë†g is still in g. By Tonelliâ€™s theorem, Î¾(Bâˆ£â‹…) =
âˆ«yâˆˆB Ë†g(â‹…,y) dÎ·(y) is E-measurable. Take Ï„(Bâˆ£x) to be Î¾(Bâˆ£x) for all x where Î¾(Xâˆ£x) = 1; on
the E-measurable, Âµ-null subset where Î¾(Xâˆ£â‹…) â‰ 1, take Ï„(Bâˆ£x) to be Ï(X Ã— B). â—»
Comment
Instead of the approach of A3.7, one may attempt a simpler approach using
the notion of liftings from Lâˆ(X;Âµ) to E-measurable functions on X. [70] [120] [121]
Deï¬nition A3.11
A map from L âˆ¶Lâˆ(X;Âµ) â†’Âµ-measurable functions on X is a linear
lifting if it has the following properties: (i) L is positive, linear, and continuous (bounded);
(ii) Lf âˆˆf for any f âˆˆLâˆ(X;Âµ); and (iii) L[1X] = 1X.
Deï¬nition A3.12
A linear lifting is a lifting if it also respects the multiplicative structure8
of Lâˆ(X;Âµ): (iv) K(fg) = Kf Kg for any f,g âˆˆLâˆ(X;Âµ).
Deï¬nition A3.13
A lifting is an E-lifting if it maps into E-measurable functions (rather
than simply Âµ-measurable ones).
The existence of E-liftings is in general an open question, even in simple cases.9 Note the
Lifting theorem [70] [120] does give the existence of a lifting K âˆ¶Lâˆ(X;Âµ) â†’E0-measurable
functions on X. However, the completed Ïƒ-algebra E0 depends on the marginal probability
Âµ, so this is not what we desire. Furthermore, the proof of the Lifting theorem relies on the
Axiom of Choice and is nonconstructive [70], so it is of little practical use. In addition, as
the following example demonstrates, this approach cannot work in general:
8Then the lifting K necessarily takes â€œfunctionsâ€ containing characteristic sets to characteristic sets,
which reduces the problem of the existence of liftings to that of the existence of set liftings.
9For instance, X = [0,1], G being the Borel Ïƒ-algebra, and Âµ being Lebesgue measure. [121]

APPENDIX A. GENERAL PROPOSITIONS
129
Counter-example A3.14
Let X = Y = [0,1] with the usual topology. Let E = F be the
resulting Borel Ïƒ-algebra. Let Î» be Lebesgue measure on [0,1] and the joint probability Ï
be the diagonal measure
Ï(E) = Î»({x âˆˆ[0,1]âˆ£(x,x) âˆˆE})
(A.41)
Then the marginal probability Âµ = Î» and the conditional probability Î½(Bâˆ£â‹…) = [1B]. There
is an obvious lift given by Ï„(Bâˆ£â‹…) = 1B. However, this cannot be written as a lifting applied
to Î½(Bâˆ£â‹…); else, since Ï„(Bâˆ£â‹…) â‰ Ï„(Bâ€²âˆ£â‹…) for B â‰ Bâ€² yet B and Bâ€² diï¬€er by a Î»-null subset, so
[1B] = [1Bâ€²], we have the contradiction
1B = Ï„(Bâˆ£â‹…) = K [1B] = K [1Bâ€²] = Ï„(Bâ€²âˆ£â‹…) = 1Bâ€²
We now claim that there is no lift Ï„(â‹…âˆ£â‹…) of Î½(â‹…âˆ£â‹…) which can be written as Ï„(Bâˆ£â‹…) = KÎ½(Bâˆ£â‹…)
for all Borel subsets B for a lifting map K.
Proof
Suppose there were such a lift coming from a lifting map K. Since liftings take
characteristic functions to characteristic functions, K induces a set lifting Îº by K[1B] =
1C â‡”C = ÎºB.
Let A0 = [0,1].
Then ÎºA0 diï¬€ers from A0 by a Î»-null set.
(Actually,
Îº[0,1] = [0,1], but we are seeking to establish a general pattern.) By deï¬nition, there is an
open set B0 that covers A0 âˆ–ÎºA0 with Î»(B0) < 1
4 (one-quarter can be replaced by anything
strictly between one-half and zero). Now, iteratively, deï¬ne Aj = [ mj
2j , mj+1
2j ] to be either the
subset [ mjâˆ’1
2jâˆ’1 , 2mjâˆ’1+1
2j
] or [ 2mjâˆ’1+1
2j
, mjâˆ’1+1
2jâˆ’1 ] depending on which one has
jâˆ’1
âˆ‘
k=0
Î»(Aj âˆ©Bk) â‰¤1
2
jâˆ’1
âˆ‘
k=0
Î»(Ajâˆ’1 âˆ©Bk)
(A.42)
Once we have Aj, we take Bj to be an open set that covers Aj âˆ–ÎºAj with Î»(Bj) <
1
4j+1, then
continue to Aj+1.
Since [0,1] is compact and each Aj is closed, the decreasing nested sequence of subsets
âŸ¨AjâŸ©has nonempty intersection by the ï¬nite intersection property [98] [57]. Since the diam-
eters of the Aj tend to zero, this intersection is a single pointâ€“call it x0. Then x0 is also
in the intersection â‹‚j ÎºAj. Suppose otherwise, so it is not in some ÎºAj; hence, it is in Bj.
Since Bj is open, then there is some ball, (x0 âˆ’Îµ,x0 + Îµ), also in Bj. Then, for k suï¬ƒciently
large so Îµ > 2âˆ’k, Ak âŠ‚Bj. However,
Î»(Ak âˆ–
k
â‹ƒ
m=0
Bm) â‰¥1
2k âˆ’
k
âˆ‘
m=0
Î»(Ak âˆªBm)
â‰¥1
2k âˆ’1
2
kâˆ’1
âˆ‘
m=0
Î»(Akâˆ’1 âˆªBm) âˆ’
1
4k+1
(A.43)
Continuing, we eventually arrive at
Î»(Ak âˆ–
k
â‹ƒ
m=0
Bm) â‰¥1
2k âˆ’
k
âˆ‘
m=0
1
2kâˆ’m4m+1 > 1
2 â‹…1
2k > 0
(A.44)

APPENDIX A. GENERAL PROPOSITIONS
130
which is a contradiction to Ak âŠ‚Bj. Hence, x0 âˆˆâ‹‚j ÎºAj. Note, by the positivity of K,
âŸ¨ÎºAjâŸ©is also a decreasing nested sequence (with ÎºAj âŠ‚Aj) and x0 is the only point in the
intersection.
However, this leads to a contradiction. For each j, let Ej = Aj âˆ–{x0}, so â‹ƒj Ej = âˆ…. Then,
since Aj âˆ¼Ej âˆ¼ÎºAj, pointwise
lim
jâ†’âˆKÎ½ (Ejâˆ£â‹…) = lim
jâ†’âˆK [1Ej] = lim
jâ†’âˆ1ÎºAj
(A.45)
which is zero except at x0, where it has the value one. For each j, let Fj = Ej âˆ–Ej+1, so {Fj}
is a disjoint collection. Then, pointwise, by the countable additivity of measures,
âˆ‘
j
KÎ½ (Fjâˆ£â‹…) = KÎ½ (â‹ƒ
j
Fjâˆ£â‹…) = KÎ½ ([0,1] âˆ–{x0}âˆ£â‹…) = 1Îº[0,1] = 1[0,1]
(A.46)
However, for any m,
1[0,1] = KÎ½ (â‹ƒ
j
Fjâˆ£â‹…) = KÎ½ (
mâˆ’1
â‹ƒ
j=1
Fj âˆªEmâˆ£â‹…) =
m
âˆ‘
j=1
KÎ½ (Fjâˆ£â‹…) + KÎ½ (Emâˆ£â‹…)
(A.47)
Taking the limit as m â†’âˆgives the right-hand side as
âˆ‘
j
KÎ½ (Fjâˆ£â‹…) + lim
mâ†’âˆKÎ½ (Emâˆ£â‹…) = 1[0,1] + 1{x0}
(A.48)
which is a contradiction. Hence, there is no lift Ï„(â‹…âˆ£â‹…) arising from a lifting map K for the
conditional probability Î½(â‹…âˆ£â‹…). â—»

131
Appendix B
Propositions for option I
B.1
Measures
Notation
For the following, sets will be denoted X, Y,... and Ïƒ-algebras by E, F,.... The
spaces of ï¬nite, signed-measures on the given set with the given Ïƒ-algebra will be denoted
M(X;E), M(Y;F),.... These are Banach spaces using the total variation norm. For a given
measure space (X,E,Âµ), let E0 be the Ïƒ-algebra given by the completion of E with respect
to Âµ (see [73]). The extension of Âµ to E0 will still be denoted Âµ. Then we will say Âµ is a
F-measure if F is a sub-Ïƒ-algebra of E0. An element of E0 will be termed Âµ-measurable.
Deï¬nition B1.1
A subset of signed-measures, M âŠ‚M(X;E), is absolutely-continuous-
complete if, for any Âµ in M, all signed-measures in mathcalM(X;E) absolutely continuous
with respect to âˆ£Âµâˆ£are also in M.
Proposition B1.2
Any absolutely-continuous-complete subset that is a vector space is
directed-complete1.
Proof
Let M âŠ‚M(X;E) be such a subset. Given any upward-directed subset B âŠ‚M,
bounded by above by some Ï âˆˆM, deï¬ne â‹ÂµâˆˆB Âµ by, for any E âˆˆE,
( â‹
ÂµâˆˆB
Âµ)(E) = sup
ÂµâˆˆB
Âµ(E)
(B.1)
This exists since it is bounded from above by Ï(E). It is readily seen that â‹ÂµâˆˆB Âµ is greater
than or equal to (using the partial ordering) any Âµ âˆˆB and that, given any other Î½ âˆˆM
with that property, â‹ÂµâˆˆB Âµ â‰¤Î½. Given any countable collection of disjoint, measurable sets,
1A partially-ordered subset is upward-directed if, given any two elements, there is a third that is greater
than or equal to both. A set is directed-complete if any bounded, upward-directed subset has a supremum.

APPENDIX B. PROPOSITIONS FOR OPTION I
132
{E}âˆ
j=1 âŠ‚E, by the upward-directed property and the countable additivity of each Âµ âˆˆB,
n
âˆ‘
j=1
( â‹
ÂµâˆˆB
Âµ)(Ej) + ( â‹
ÂµâˆˆB
Âµ)(
âˆ
â‹ƒ
j=n+1
Ej) â‰¤( â‹
ÂµâˆˆB
Âµ)(
âˆ
â‹ƒ
j=1
Ej) â‰¤
âˆ
âˆ‘
j=1
( â‹
ÂµâˆˆB
Âµ)(Ej)
(B.2)
for any n âˆˆ{1,2,...}. Since Î½ â‰¤â‹ÂµâˆˆB Âµ â‰¤Ï for any Î½ âˆˆB, and both Ï and Î½ are countably
additive, both (â‹ÂµâˆˆB Âµ)(â‹ƒâˆ
j=n+1 Ej) â†’0 and the tail sum âˆ‘âˆ
j=n+1 (â‹ÂµâˆˆB Âµ)(Ej) â†’0 as n â†’âˆ,
so
âˆ
âˆ‘
j=1
( â‹
ÂµâˆˆB
Âµ)(Ej) â‰¤( â‹
ÂµâˆˆB
Âµ)(
âˆ
â‹ƒ
j=1
Ej) â‰¤
âˆ
âˆ‘
j=1
( â‹
ÂµâˆˆB
Âµ)(Ej)
(B.3)
Therefore, â‹ÂµâˆˆB Âµ is countably additive, so it is a signed E-measure.
Its total variation
norm is bounded by the total variation norm of Ï âˆ¨(âˆ’Î½) for any particular Î½ âˆˆB. Since
Î½ â‰¤â‹ÂµâˆˆB Âµ â‰¤Ï, â‹ÂµâˆˆB Âµ is absolutely continuous with respect to âˆ£Ïâˆ£+ âˆ£Î½âˆ£, so â‹ÂµâˆˆB Âµ âˆˆM. â—»
Comment
The following proposition corrects the defect mentioned after A1.2 for the
particular case required.
For the following two propositions, let G be the Ïƒ-algebra generated2 by the rectangular
subsets E Ã— F, denoted G = Ïƒ(E Ã— F). Let the absolutely-continuous-complete subsets M âŠ‚
M(X;E), N âŠ‚M(Y;F), and Q âŠ‚M(X Ã— Y;G) also be vector spaces.
Proposition B1.3
If M âŠ—N is weakly dense in Q, then it is norm-dense in Q.
Proof
Suppose there were some measure Âµ âˆˆQ+ not in the norm-closure of M âŠ—N, so there
is some Ïµ > 0 such that âˆ¥Âµâˆ’Î½âˆ¥total variation > Îµ for all Î½ âˆˆM âŠ—N. By Hahn-decomposition [100]
and the absolutely-continuous-completeness property of M and N, if Î½ âˆˆM âŠ—N, then
âˆ£Î½âˆ£âˆˆM âŠ—N.
Let Âµ âŠ¥âˆ£Î½âˆ£be the singular part of Âµ with respect to âˆ£Î½âˆ£using Lebesgue
decomposition [76]. The set of G-measures {Âµ âŠ¥âˆ£Î½âˆ£âˆ£Î½ âˆˆM âŠ—N} is lower-bound by the zero-
measure. It is downward-directed since Âµ âŠ¥(âˆ£Î½âˆ£+ âˆ£Î½â€²âˆ£) is less than or equal to (in the partial
ordering) both Âµ âŠ¥âˆ£Î½âˆ£and Âµ âŠ¥âˆ£Î½â€²âˆ£for any Î½,Î½â€² âˆˆM âŠ—N. Hence, by the preceding proposition,
the G-measure Ï„ = â‹€Î½âˆˆMâŠ—N Âµ âŠ¥âˆ£Î½âˆ£exists. Furthermore, from its deï¬nition in the preceding
proof, this measure has total-variation norm greater than or equal to Îµ. Let Ïâˆ¥Ï„ be the ab-
solutely continuous part of Ï with respect to Ï„ using Lebesgue decomposition. Now consider
the bounded, linear functional Î¦ âˆˆM(X Ã— Y;G)âˆ—given by Î¦Ï = (Ïâˆ¥Ï„)(X Ã— Y). This is zero
on M âŠ—N, yet Î¦Âµ = âˆ¥Ï„âˆ¥total variation â‰¥Îµ; hence, Âµ is not in the weak-closure of M âŠ—N. â—»
Proposition B1.4
If M âŠ—N is norm-dense in Q, then M + âŠ—R+ N + is norm-dense in Q+.
2For any collection A of subsets of X, the Ïƒ-algebra generated by A, Ïƒ(A), is the smallest Ïƒ-algebra of
subsets of X containing A. [99]

APPENDIX B. PROPOSITIONS FOR OPTION I
133
Proof
By Hahn-decomposition and the absolutely-continuous-completeness property of M
and N, the measures in M âŠ—N are total-variation norm-dense for the measures Q+. Given
any measure Âµ = âˆ‘j Î½j âŠ—Ï„j âˆˆM âŠ—N, it is absolutely continuous with respect to the prod-
uct measure Ï = (âˆ‘j âˆ£Î½jâˆ£) âŠ—(âˆ‘k âˆ£Ï„kâˆ£), which is in M âŠ—N by Hahn-decomposition and the
absolutely-continuous-completeness property of M and N. By the Radon-NikodÂ´ym theo-
rem [72], there is a positive â€œfunctionâ€ dÂµ
dÏ âˆˆL1(X Ã— Y;Ï) such that Âµ = dÂµ
dÏÏ. By proposition
B3.1 below, dÂµ
dÏ can be arbitrarily well approximated in total-variation norm by elements of
L1 (X;âˆ‘j âˆ£Î½jâˆ£)
+ âŠ—R+ L1 (Y;âˆ‘k âˆ£Ï„kâˆ£)+. â—»
Proposition B1.5
The total-variation norm is a cross-norm for product measures.
Proof
Let Âµ âˆˆM(X;E) and Î½ âˆˆM(Y;F). By Hahn decomposition, âˆ£Âµ Ã— Î½âˆ£= âˆ£Âµâˆ£Ã— âˆ£Î½âˆ£, so
âˆ¥Âµ Ã— Î½âˆ¥= âˆ£Âµ Ã— Î½âˆ£(X Ã— Y) = âˆ£Âµâˆ£(X)âˆ£Î½âˆ£(Y) = âˆ¥Âµâˆ¥âˆ¥Î½âˆ¥
â—»
(B.4)
Proposition B1.6
If Âµ is a Ïƒ-ï¬nite measure on X, then there is no uncountable collection
{AÎ±} of subsets of X with the properties that Âµ(AÎ±) > 0 for all Î± and Âµ(AÎ± âˆ©AÎ²) = 0 for all
Î± â‰ Î².
Proof
Suppose otherwise. Since Âµ is Ïƒ-ï¬nite, there is a countable, disjoint collection {Bj}
of subsets of X such that each Bj has ï¬nite Âµ-measure and their union âˆªjBj is the entire
space X. Now suppose there is some Îµ > 0 and j such that for inï¬nitely many of the {AÎ±},
Âµ(Bj âˆ©AÎ±) > Îµ. That immediately contradicts Âµ(Bj) being ï¬nite. Therefore, it must be
the case that for any Îµ > 0 and j, only ï¬nitely many of the {AÎ±} satisfy Âµ(Bj âˆ©AÎ±) > Îµ.
Let {Ak} be the countable collection formed by taking the union over all j and over all
Îµ âˆˆ{1,2âˆ’1,2âˆ’2,...} of such {AÎ±}. However, this also leads to a contradiction, since for any
AÎ² âˆ‰{Ak}, Âµ(AÎ² âˆ©Bj) = 0 for all j, yet 0 < Âµ(AÎ²) = âˆ‘j Âµ(AÎ² âˆ©Bj) = 0. â—»
Proposition B1.7
If a Ïƒ-ï¬nite measure is inï¬nitely-divisible3, then it has no atoms-for-
the-measure4.
Proof
Consider the following property: a measure Ïƒ-ï¬nite Âµ for a measure space (X,E,Âµ)
has the once-divisible property if for any subset A âˆˆE with ï¬nite Âµ(A) > 0, there are disjoint
B,C âˆˆE with B âˆªC = A such that both Âµ(B) and Âµ(C) are less than 3
4Âµ(A). This property
is readily seen to be equivalent to being inï¬nitely-divisible. Furthermore, if there is an atom-
for-the-measure, then the once-divisible property does not hold. Hence, it remains to show
if the once-divisible property does not hold, there is necessarily an atom for the measure.
3A Ïƒ-ï¬nite measure Âµ for a measure space (X,E,Âµ) is inï¬nitely-divisible if for any Îµ > 0, there is a
countable (ï¬nite if Âµ is ï¬nite) partition of X, {Bj}, with each Âµ(Bj) < Îµ.
4For a measure space (X,E,Âµ), a subset A âˆˆE is an atom-for-the-measure Âµ if for any B âˆˆE with B âˆˆA,
either Âµ(B) = 0 or Âµ(A âˆ–B) = 0.

APPENDIX B. PROPOSITIONS FOR OPTION I
134
Suppose there is a subset A âˆˆE with ï¬nite Âµ(A) > 0 such that there are no disjoint B,C âˆˆE
with B âˆªC = A such that both Âµ(B) and Âµ(C) are less than 3
4Âµ(A). Let c be the inï¬num
over b âˆˆ[ 3
4,1] such that the division is possible for both Âµ(B) and Âµ(C) are less than bâ‹…Âµ(A).
If c = 1, then A is an atom-for-the-measure Âµ. If there is a division with Âµ(B) = c â‹…Âµ(A),
then B is an atom-for-the-measure Âµ. The only remaining possibility is that for every Îµ > 0,
there is a division with Âµ(B) < (c + Îµ)Âµ(A). By taking Îµ âˆˆ{20,2âˆ’1,2âˆ’2,...} successively, we
get a sequence of subsets âŸ¨BjâŸ©with c â‹…Âµ(A) < Âµ(Bj) < (c + 2âˆ’j)Âµ(A). For every j < k in Z+,
c â‹…Âµ(A) < Âµ(Bj âˆ©Bk) < (c + 2âˆ’k)Âµ(A); hence, â‹‚âˆ
j=0 Bj is in E with Âµ(â‹‚âˆ
j=0 Bj) = c â‹…Âµ(A)â€“a
contradiction. Hence, this possibility cannot occur. â—»
Comment
Note that an atom-for-the-measure need not be an atom for the Ïƒ-algebra.
For instance, the atomic measure Î´{0} on R has all subsets containing 0 as atoms-for-the-
measure. For separable, metric spaces with the Borel Ïƒ-algebra, all atoms-for-the-measure
are induced by atomic measures in this manner. [101] However, there are other ways atoms-
for-the-measure can occur. Consider the measure on [0,1] assigning zero to all countable
subsets and one to their complements. Then all the subsets with countable complement are
atoms-for-the-measure.
Take the measure Âµ ï¬nite. Then by successive partitioning and an arguments similar to
that used in the preceding proof, for any Îµ > 0 it is possible, with only ï¬nitely many steps,
to ï¬nd disjoint atoms-for-the-measure {Aj} such that any atoms-for-the-measure A in the
restriction of Âµ to X âˆ–â‹ƒj Aj have Âµ(A) < Îµ. By taking Îµ âˆˆ{20,2âˆ’1,2âˆ’2,...} successively, we
get a countable partition of subsets in E
(X âˆ–â‹ƒ
j
Aj) âˆªâ‹ƒ
j
Aj
(B.5)
where Âµ restricted to X âˆ–â‹ƒj Aj is inï¬nitely-divisible and each Aj is an atom-for-the-measure.
This can clearly be extended to Ïƒ-ï¬nite Âµ.
Proposition B1.8
For the ï¬nite, Borel measure Ï on [0,1] Ã— [0,1] (with the standard
topology) and linear map K of Â§3.2, KÏ is the zero measure.
Proof
Take any ï¬nite Borel measures Âµ,nu on [0,1] (with the standard topology). By the
preceding comment,
Âµ = Âµ0 + âˆ‘
j
ajÎ´{xj}, Î½ = Î½0 + âˆ‘
j
bjÎ´{yj}
(B.6)
where Âµ0,nu0 are inï¬nitely-divisible, âŸ¨ajâŸ©,âŸ¨bjâŸ©are summable sequences of strictly positive
reals, and {xj},{yj} are countable subsets of [0,1]. Consider the partition of [0,1] Ã— [0,1]
given by A âˆªB âˆªC, where B = (({xj} âˆª{yj) Ã— [0,1]) âˆª([0,1] Ã— ({xj} âˆª{yj)), C = {(x,x)âˆ£x âˆˆ
[0,1]} âˆ–B, and A = [0,1] Ã— [0,1] âˆ–{(x,x)âˆ£x âˆˆ[0,1]} âˆ–B. Then Ï is clearly the zero measure
on AâˆªB and both ÂµÃ—âˆ‘j bjÎ´{yj} and (âˆ‘j ajÎ´{xj})Ã—Î½0 are clearly the zero measure on C. Take

APPENDIX B. PROPOSITIONS FOR OPTION I
135
any Îµ > 0. Since Âµ0 is inï¬nitely-divisible, we have a ï¬nite partition {Bj} of [0,1]âˆ–({xj}âˆª{yj)
where Âµ0(Bj) is less than Îµ for every j. Then
Âµ0 Ã— Î½0(C) â‰¤âˆ‘
j
Âµ0 Ã— Î½0(Bj Ã— Bj) = âˆ‘
j
Âµ0(Bj)Î½0(Bj)
â‰¤Îµâˆ‘
j
Î½0(Bj) = ÎµÎ½0([0,1] âˆ–({xj} âˆª{yj))
(B.7)
Since Îµ was arbitrary, it must be that Âµ0 Ã— Î½0 is the zero measure on C as well. Therefore,
Ï âŠ¥Âµ Ã— Î½. Since Âµ,nu were arbitrary, KÏ is the zero measure. â—»
Proposition B1.9
For Ïƒ-ï¬nite, E-measures Âµ,nu on X, If nu is absolutely convergent with
respect to Âµ and Âµ is inï¬nitely-divisible, then Î½ is inï¬nitely-divisible.
Proof
Suppose otherwise, so by B1.7 there is a subset A that is an atom-for-the-measure
Î½. Since Âµ is inï¬nitely-divisible, it has the once-divisible property (see B1.7), so there are
disjoint subsets B1 and C1 in E with B1âˆªC1 = A such that both Âµ(B1) and Âµ(C1) are less than
3
4Âµ(A). Take E1 the one of B1,C1 that is an atom-for-the-measure Î½. Repeat the process
with E1 for A and iterate to get a nested, decreasing sequence of subsets in E, âŸ¨EjâŸ©. Then
Âµ(â‹‚j Ej) = limj Âµ(Ej) = 0 whereas Âµ(â‹‚j Ej) = limj Âµ(Ej) = Âµ(A)â€“a contradiction to Î½ being
absolutely continuous. Hence, Î½ has no atoms-for-the-measure and is inï¬nitely-divisible. â—»
B.2
Maps on subspaces of the space of measures
Let M âŠ‚M(X;E) be any absolutely-continuous-complete, norm-closed subspace.
Proposition B2.1
Any positive linear map L âˆˆB(M,M(Y;F)) has
âˆ¥Lâˆ¥op =
sup
ÂµâˆˆM+,Âµ(X)â‰¤1
LÂµ(Y)
(B.8)
Proof
Since L is positive, âˆ£LÂµâˆ£= âˆ£L(Âµ+âˆ’Âµâˆ’)âˆ£= âˆ£L(Âµ+)âˆ’L(Âµâˆ’)âˆ£â‰¤L(Âµ+)+L(Âµâˆ’) = Lâˆ£Âµâˆ£using
Hahn decomposition, so
sup
ÂµâˆˆM+,Âµ(X)â‰¤1
LÂµ(Y) â‰¤âˆ¥Lâˆ¥op =
sup
âˆ£Âµâˆ£(X)â‰¤1
âˆ£LÂµâˆ£(Y) â‰¤
sup
ÂµâˆˆM+,Âµ(X)â‰¤1
LÂµ(Y)
â—»
(B.9)
Proposition B2.2
The space of maps B(M,M(Y;F)) is a vector lattice5.
5A partially-ordered, vector space A is a vector lattice if for any a,b âˆˆA, there are elements a âˆ¨b and
a âˆ§b such that a âˆ¨b is greater than or equal to both a and b, but is less than or equal to any other element
with that property and a âˆ§b is less than or equal to both a and b, but is greater than or equal to any other
element with that property.

APPENDIX B. PROPOSITIONS FOR OPTION I
136
Proof
For any maps K,L âˆˆB(M,M(Y;F)) deï¬ne K âˆ¨L by (K âˆ¨L)(Âµ)(F) for Âµ âˆˆM +
and F âˆˆF being
sup
â§âªâªâªâªâªâ¨âªâªâªâªâªâ©
n
âˆ‘
j=1
m
âˆ‘
k=1
max{(KÂµj)(Fk),(LÂµj)(Fk)}
RRRRRRRRRRRRRRRRRR
n,m âˆˆ{1,2,...}
Âµ1,...,Âµn âˆˆM +
disjoint F1,...,Fm âˆˆF
âˆ‘n
j=1 Âµj = Âµ,â‹ƒm
j=1 Fj = F
â«âªâªâªâªâªâ¬âªâªâªâªâªâ­
(B.10)
Clearly, K âˆ¨L â‰¥K and K âˆ¨L â‰¥L. Also, for any J âˆˆB(M,M(Y;F)) satisfying J â‰¥K and
J â‰¥L, then J â‰¥K âˆ¨L. Also, clearly (K âˆ¨L)(c â‹…) = c(K âˆ¨L) for any real scalar c > 0. Since
M is a Banach lattice6, it has the Riesz decomposition property [66] that for any Ï,Î½ âˆˆM +,
any Âµ1,...,Âµn âˆˆM + such that âˆ‘n
j=1 Âµj = Ï + Î½ can be decomposed into Âµj = Ïj + Î½j with both
Ïj,Î½j âˆˆM + for each j and with âˆ‘n
j=1 Ïj = Ï and âˆ‘n
j=1 Î½j = Î½. Also, given any partition of
F into disjoint, F-measurable subsets, F = â‹ƒm1
j=1 Gj = â‹ƒm2
j=1 Hj, there is a reï¬nement of both
partitions, F = â‹ƒm1
j=1 â‹ƒm2
k=1 Gj âˆ©Hk. Therefore, (K âˆ¨L)(Ï + Î½)(F) is equal to
sup
â§âªâªâªâªâªâ¨âªâªâªâªâªâ©
n
âˆ‘
j=1
m
âˆ‘
k=1
max{(KÂµj)(Fk),(LÂµj)(Fk)}
RRRRRRRRRRRRRRRRRR
n,m âˆˆ{1,2,...}
Âµ1,...,Âµn âˆˆM +
disjoint F1,...,Fm âˆˆF
âˆ‘n
j=1 Âµj = Ï + Î½,â‹ƒm
j=1 Fj = F
â«âªâªâªâªâªâ¬âªâªâªâªâªâ­
(B.11)
= sup
â§âªâªâªâªâªâªâªâªâªâªâªâªâªâ¨âªâªâªâªâªâªâªâªâªâªâªâªâªâ©
âˆ‘n1
j=1 âˆ‘m1
k=1 max{ (KÏj)(Gk),
(LÏj)(Gk)
}
+âˆ‘n2
j=1 âˆ‘m2
k=1 max{ (KÎ½j)(Hk),
(LÎ½j)(Hk)
}
RRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRR
n1,n2,m1,m2 âˆˆ{1,2,...}
Ï1,...,Ïn1,
Î½1,...,Î½n2 âˆˆM +
disjoint G1,...,Gm1 âˆˆF,
disjoint H1,...,Hm2 âˆˆF
âˆ‘n1
j=1 Ïj = Ï,âˆ‘n2
j=1 Î½j = Î½
â‹ƒm1
j=1 Gj = â‹ƒm2
j=1 Hj = F
â«âªâªâªâªâªâªâªâªâªâªâªâªâªâ¬âªâªâªâªâªâªâªâªâªâªâªâªâªâ­
= (K âˆ¨L)(Ï)(F) + (K âˆ¨L)(Î½)(F)
Since the cone of measures is generating for signed measures by Hahn decomposition and
since M has the absolutely-continuous-complete property, K âˆ¨L extends to a linear map on
all of M.
It remains to show the image of the map K âˆ¨L is indeed the signed measures. Since the
cone of measures is generating, it suï¬ƒces to show this with any Âµ âˆˆM +. Take any countable
collection of disjoint, measurable subsets {Fj}âˆ
j=1 âŠ‚F. By the preceding argument using
Riesz decomposition and reï¬nement of partitions, for any n âˆˆ{1,2,...},
n
âˆ‘
j=1
(K âˆ¨L)(Âµ)(Fj)+(K âˆ¨L)(Âµ)(
âˆ
â‹ƒ
j=n+1
Fj) â‰¤(K âˆ¨L)(Âµ)(
âˆ
â‹ƒ
j=1
Fj) â‰¤
âˆ
âˆ‘
j=1
(K âˆ¨L)(Âµ)(Fj) (B.12)
6A positive cone is normal if 0 â‰¤a â‰¤b implies âˆ¥aâˆ¥â‰¤âˆ¥bâˆ¥. A Banach lattice is a complete, normed vector
lattice with a normal cone and with âˆ¥âˆ£aâˆ£âˆ¥= âˆ¥aâˆ¥.

APPENDIX B. PROPOSITIONS FOR OPTION I
137
However, KÂµ â‰¤(K âˆ¨L)Âµ â‰¤âˆ£KÂµâˆ£+ âˆ£LÂµâˆ£and both KÂµ and âˆ£KÂµâˆ£+ âˆ£LÂµâˆ£are countably additive,
so both the tail of the series, âˆ‘âˆ
j=n+1(K âˆ¨L)(Âµ)(Fj), and (K âˆ¨L)(Âµ)(â‹ƒâˆ
j=n+1 Fj) go to zero
as n â†’âˆ. Therefore, (K âˆ¨L)Âµ is countably additive.
Finally, K â‰¤K âˆ¨L â‰¤âˆ£Kâˆ£+ âˆ£Lâˆ£, so K âˆ¨L is absolutely continuous with respect to âˆ£Kâˆ£+ âˆ£Lâˆ£.
Hence, K âˆ¨L âˆˆM. Therefore, B (M(X;E),M(Y;F)) is a vector lattice. â—»
Proposition B2.3
With the operator norm induced by the total variation norms,
B(M,M(Y;F)) has a normal cone.
Proof
By B2.1, it only necessary to consider elements in the positive cone M + to calculate
the operator norm of any L âˆˆB (M,M(Y;F))+. Hence, for any K âˆˆB (M,M(Y;F))+ with
K â‰¤L, âˆ¥Kâˆ¥op â‰¤âˆ¥Lâˆ¥op. â—»
Proposition B2.4
For any map L âˆˆB (M,M(Y;F)), âˆ¥âˆ£Lâˆ£âˆ¥op = âˆ¥Lâˆ¥op.
Proof
For any such L,
âˆ¥Lâˆ¥op =
sup
ÂµâˆˆM,âˆ¥Âµâˆ¥â‰¤1
âˆ¥LÂµâˆ¥
(B.13)
which, using Hahn decomposition, is equal to (using Âµ âŠ¥Î½ to show they are mutually singular)
âˆ¥Lâˆ¥op = sup{âˆ¥L(Âµ âˆ’Î½)âˆ¥âˆ£Âµ,Î½ âˆˆM +
Âµ âŠ¥Î½,âˆ¥Âµ âˆ’Î½âˆ¥â‰¤1 }
(B.14)
Since Âµ and Î½ are mutually singular,
âˆ¥Âµ âˆ’Î½âˆ¥= âˆ¥Âµâˆ¥+ âˆ¥Î½âˆ¥= âˆ¥Âµ + Î½âˆ¥
(B.15)
Then, since âˆ£LÂµâˆ£< âˆ£Lâˆ£Âµ and âˆ£LÎ½âˆ£< âˆ£Lâˆ£Î½,
âˆ¥Lâˆ¥op â‰¤sup{âˆ£Lâˆ£(Âµ + Î½)(Y)âˆ£Âµ,Î½ âˆˆM +
Âµ âŠ¥Î½,(Âµ + Î½)(Y) â‰¤1 }
(B.16)
which can only be increased by not requiring Âµ and Î½ to be mutually singular, so, rewriting
Âµ + Î½ â†’Âµ, âˆ¥Lâˆ¥op is less than or equal to supÂµâˆˆM+,âˆ¥Âµâˆ¥â‰¤1 âˆ£Lâˆ£(Âµ)(Y), which, by B2.1, is equal to
âˆ¥âˆ£Lâˆ£âˆ¥op.
On the other hand, by B2.1,
âˆ¥âˆ£Lâˆ£âˆ¥op =
sup
ÂµâˆˆM+,âˆ¥Âµâˆ¥â‰¤1
âˆ£Lâˆ£(Âµ)(Y)
(B.17)
which, using âˆ£Lâˆ£= L âˆ¨(âˆ’L) and the form of â€˜âˆ¨â€™ in (B.10), is equal to
sup
â§âªâªâªâªâªâªâªâªâ¨âªâªâªâªâªâªâªâªâ©
n
âˆ‘
j=1
m
âˆ‘
k=1
âˆ£(LÂµj)(Fk)âˆ£
RRRRRRRRRRRRRRRRRRRRRRR
n,m âˆˆ{1,2,...}
Âµ1,...,Âµn âˆˆM +,
âˆ¥âˆ‘n
j=1 Âµjâˆ¥â‰¤1,
disjoint F1,...,Fm âˆˆF,
â‹ƒm
j=1 Fj = Y
â«âªâªâªâªâªâªâªâªâ¬âªâªâªâªâªâªâªâªâ­
(B.18)

APPENDIX B. PROPOSITIONS FOR OPTION I
138
which is less than or equal to
sup
â§âªâªâªâ¨âªâªâªâ©
n
âˆ‘
j=1
âˆ¥LÂµjâˆ¥
RRRRRRRRRRRRRR
n âˆˆ{1,2,...}
Âµ1,...,Âµn âˆˆM +,
âˆ¥âˆ‘n
j=1 Âµjâˆ¥â‰¤1
â«âªâªâªâ¬âªâªâªâ­
(B.19)
Since, by the AL-space7 property of M, âˆ¥âˆ‘n
j=1 Âµjâˆ¥= âˆ‘n
j=1 âˆ¥Âµjâˆ¥, this is less than or equal to
sup
ÂµâˆˆM+,âˆ¥Âµâˆ¥â‰¤1
âˆ¥LÂµâˆ¥â‰¤
sup
ÂµâˆˆM,âˆ¥Âµâˆ¥â‰¤1
âˆ¥LÂµâˆ¥= âˆ¥Lâˆ¥op
â—»
(B.20)
Comment
By B2.2, B2.3, and B2.4, B(M,M(Y;F)) is a Banach lattice.
For the following proposition, let G = Ïƒ(E Ã— F) and J = Ïƒ(H Ã— I).
Let the absolutely-
continuous-complete subsets M âŠ‚M(X;E), N âŠ‚M(Y;F), and Q âŠ‚M(X Ã— Y;G) also be
vector spaces.
Proposition B2.5
If M âŠ—N is norm-dense in Q, then for any linear maps
L âˆˆB(M,M(Z;H)) and K âˆˆB(N,M(W;I)), the map L âŠ—K âˆ¶Q â†’M(Z Ã— W;J )) is
well-deï¬ned and satisï¬es âˆ£L âŠ—Kâˆ£= âˆ£Lâˆ£âŠ—âˆ£Kâˆ£and âˆ¥L âŠ—Kâˆ¥op = âˆ¥Lâˆ¥opâˆ¥Kâˆ¥op.
Proof
Both
L âŠ—K = (L+ âˆ’Lâˆ’) âŠ—(K+ âˆ’Kâˆ’) = L+ âŠ—K+ âˆ’L+ âŠ—Kâˆ’âˆ’Lâˆ’âŠ—K+ + Lâˆ’âŠ—Kâˆ’
(B.21)
and
âˆ’L âŠ—K = âˆ’(L+ âˆ’Lâˆ’) âŠ—(K+ âˆ’Kâˆ’) = âˆ’L+ âŠ—K+ + L+ âŠ—Kâˆ’+ Lâˆ’âŠ—K+ âˆ’Lâˆ’âŠ—Kâˆ’
(B.22)
are clearly less than or equal to (in the partial ordering)
âˆ£Lâˆ£âŠ—âˆ£Kâˆ£= (L+ + Lâˆ’) âŠ—(K+ + Kâˆ’) = L+ âŠ—K+ + L+ âŠ—Kâˆ’+ Lâˆ’âŠ—K+ + Lâˆ’âŠ—Kâˆ’
(B.23)
so âˆ£L âŠ—Kâˆ£â‰¤âˆ£Lâˆ£âŠ—âˆ£Kâˆ£. However, by B1.4, B1.5, B2.1, B2.4, and the deï¬nition of operator
norm, âˆ¥âˆ£Lâˆ£âŠ—âˆ£Kâˆ£âˆ¥â‰¤âˆ¥Lâˆ¥âˆ¥Kâˆ¥. Hence, by A1.3, L âŠ—K is well-deï¬ned.
However, given any measures Î½ âˆˆM + and Ï âˆˆN + and subsets H âˆˆH and I âˆˆI,
âˆ£L âŠ—Kâˆ£(Î½ Ã— Ï)(H Ã— I) = sup
â§âªâªâªâ¨âªâªâªâ©
n
âˆ‘
j=1
âˆ£(L âŠ—K)Âµjâˆ£(H Ã— I)
RRRRRRRRRRRRRR
n âˆˆ{1,2,...}
Âµ1,...,Âµn âˆˆQ+
âˆ‘n
j=1 Âµj = Î½ Ã— Ï
â«âªâªâªâ¬âªâªâªâ­
(B.24)
using a similar argument to that for the proof of B2.4. By Riesz decomposition, this is
equal to
sup
â§âªâªâªâ¨âªâªâªâ©
n
âˆ‘
j=1
m
âˆ‘
k=1
âˆ£(L âŠ—K)(Î½j Ã— Ïk)âˆ£(H Ã— I)
RRRRRRRRRRRRRR
n,m âˆˆ{1,2,...}
Î½1,...,Î½n âˆˆM +,Ï1,...,Ïm âˆˆN +
âˆ‘n
j=1 Î½j = Î½,âˆ‘m
k=1 Ïk = Ï
â«âªâªâªâ¬âªâªâªâ­
(B.25)
7A Banach lattice is an AL-space if âˆ¥a + bâˆ¥= âˆ¥aâˆ¥+ âˆ¥bâˆ¥for a,b in the positive cone.

APPENDIX B. PROPOSITIONS FOR OPTION I
139
which, by the triangle inequality, is greater than or equal to âˆ£(LÎ½) Ã— (KÏ)âˆ£(H Ã— I). By the
property of signed measures that âˆ£Âµ Ã— Âµâ€²âˆ£= âˆ£Âµâˆ£Ã— âˆ£Âµâ€²âˆ£, this is equal to âˆ£LÎ½âˆ£(H)âˆ£KÏâˆ£(I).
The rectangular subsets H Ã— I generate the Ïƒ-algebra J , so âˆ£L âŠ—Kâˆ£(Î½ Ã— Ï)(A)
â‰¥((âˆ£Lâˆ£Î½) Ã— (âˆ£Kâˆ£Ï))(A) for any A âˆˆJ . By the assumption in the proposition and A1.3,
âˆ£L âŠ—Kâˆ£(Âµ)(A) â‰¤(âˆ£Lâˆ£âŠ—âˆ£Kâˆ£)(Âµ)(A) for any Âµ âˆˆQ+. Hence, âˆ£L âŠ—Kâˆ£â‰¥âˆ£Lâˆ£âŠ—âˆ£Kâˆ£, so âˆ£L âŠ—Kâˆ£=
âˆ£Lâˆ£âŠ—âˆ£Kâˆ£.
We already have âˆ¥L âŠ—Kâˆ¥op â‰¤âˆ¥Lâˆ¥opâˆ¥Kâˆ¥op. On the other hand,
âˆ¥âˆ£Lâˆ£âˆ¥opâˆ¥âˆ£Kâˆ£âˆ¥op = sup{âˆ£Lâˆ£(Âµ)(Z)âˆ£Kâˆ£(Î½)(W)âˆ£Âµ âˆˆM +,Âµ(X) â‰¤1,
Î½ âˆˆN +,Î½(Y) â‰¤1
}
(B.26)
â‰¤sup{(âˆ£Lâˆ£âŠ—âˆ£Kâˆ£)(Âµ)(Z Ã— W)âˆ£Âµ âˆˆQ+
Âµ(X Ã— Y) â‰¤1 } = âˆ¥âˆ£Lâˆ£âŠ—âˆ£Kâˆ£âˆ¥op
so âˆ¥L âŠ—Kâˆ¥op = âˆ¥âˆ£Lâˆ£âŠ—âˆ£Kâˆ£âˆ¥op = âˆ¥âˆ£Lâˆ£âˆ¥opâˆ¥âˆ£Kâˆ£âˆ¥op = âˆ¥Lâˆ¥opâˆ¥Kâˆ¥op. â—»
Corollary B2.6
Positive maps L âˆˆB (M,M(Y;F))+ are completely-positive8.
Proof
Use B1.4, B2.5, and the positivity of both maps L and IB(N). â—»
Analogously to the pseudo-functions which compose the doubly-dual space C(Z)âˆ—âˆ—for C(Z)
the continuous functions on some compact space Z (see [113]), we have the following:
Deï¬nition B2.7
A pseudo-transition â€œfunctionâ€ Ï„.(â‹…âˆ£â‹…) with data (M, M(Y;F)) has the
properties: (i) for each measure Âµ âˆˆM +, Ï„Âµ(â‹…âˆ£â‹…) is a L1(X;Âµ)-valued vector F-measure on Y;
(ii) for each B âˆˆF and Âµ âˆˆM +, Ï„Âµ(Bâˆ£â‹…) is essentially bounded with respect to Âµ (so it is in
Lâˆ(X;Âµ)); and (iii) if Âµ âˆˆM + is absolutely continuous with respect to Î½ âˆˆM +, then for any
B âˆˆF, Ï„Âµ(Bâˆ£â‹…) = Ï„Î½(Bâˆ£â‹…) as elements in L1(X;Âµ).
Comment
Using A3.7, it is possible in many commonly encountered situations to lift a
pseudo-transition â€œfunctionâ€ to a pseudo-transition function, but we will not further pursue
this. The space of pseudo-transition â€œfunctionsâ€ is clearly a vector space. It is a Banach
space under the norm
âˆ¥Ï„.(â‹…âˆ£â‹…)âˆ¥=
sup
ÂµâˆˆM+,âˆ¥Âµâˆ¥â‰¤1
âˆ¥Ï„Âµ(â‹…âˆ£â‹…)âˆ¥
(B.27)
Proposition B2.8
The space of maps B (M,M(Y;F)) is isometrically isomorphic to the
space of pseudo-transition â€œfunctionsâ€ with data (M, M(Y;F)). Furthermore, this isomor-
phism takes the positive cones in each space to one another.
8A map L is completely-positive if L âŠ—IB(N) is positive for every N of the form previously given.

APPENDIX B. PROPOSITIONS FOR OPTION I
140
Proof
Given such a pseudo-transition â€œfunctionâ€ Ï„.(â‹…âˆ£â‹…), deï¬ne L by
(LÂµ)(B) = âˆ«xâˆˆX Ï„âˆ£Âµâˆ£(Bâˆ£x)dÂµ(x)
(B.28)
for any B âˆˆF and Âµ âˆˆM. Then LÂµ is indeed a signed measure since it is countably additive
because Ï„ is a vector measure. Since Ï„âˆ£aÂµâˆ£(â‹…âˆ£â‹…) = Ï„âˆ£Âµâˆ£(â‹…âˆ£â‹…) for any a âˆˆR âˆ–{0}, L(aÂµ) = aLÂµ for
any a âˆˆR. Also, for any Î½ âˆˆM,
(L(Âµ + Î½))(B) = âˆ«xâˆˆX Ï„âˆ£Âµâˆ£(Bâˆ£x)dÂµ(x) + âˆ«xâˆˆX Ï„âˆ£Î½âˆ£(Bâˆ£x)dÎ½(x)
(B.29)
= âˆ«xâˆˆX Ï„âˆ£Âµâˆ£+âˆ£Î½âˆ£(Bâˆ£x)d(Âµ + Î½)(x)
(B.30)
= âˆ«xâˆˆX Ï„âˆ£Âµ+Î½âˆ£(Bâˆ£x)d(Âµ + Î½)(x)
(B.31)
Hence, L is linear. To see that it is bounded, we have
âˆ¥Lâˆ¥op =
sup
ÂµâˆˆM,âˆ¥Âµâˆ¥â‰¤1
âˆ¥LÂµâˆ¥=
sup
ÂµâˆˆM,âˆ¥Âµâˆ¥â‰¤1
âˆ£LÂµâˆ£(Y)
(B.32)
By Hahn decomposition [100], this is equal to
sup{(LÂµ)(A) âˆ’(LÂµ)(B)âˆ£Âµ âˆˆM,âˆ¥Âµâˆ¥â‰¤1,
disjoint A,B âˆˆF }
(B.33)
which is equal to
sup{âˆ‘
j
((LÂµ)(Aj) âˆ’(LÂµ)(Bj))âˆ£Âµ âˆˆM,âˆ¥Âµâˆ¥â‰¤1,
ï¬nite, disjoint collections {Aj,Bj} âŠ‚F }
(B.34)
This is bounded above by
sup{âˆ‘
j
âˆ¥Ï„Âµ(Ajâˆ£â‹…)âˆ¥âˆ£Âµ âˆˆM +,âˆ¥Âµâˆ¥â‰¤1,
ï¬nite, disjoint collections {Aj} âŠ‚F } =
sup
ÂµâˆˆM+,âˆ¥Âµâˆ¥â‰¤1
âˆ¥Ï„Âµ(â‹…âˆ£â‹…)âˆ¥= âˆ¥Ï„.(â‹…âˆ£â‹…)âˆ¥
(B.35)
Finally, if Ï„.(â‹…âˆ£â‹…) is positive, L is clearly positive.
Now suppose we are given such a map L. For any measure Âµ âˆˆM +, let MÂµ be the subspace
that is absolutely continuous with respect to Âµ. By the Radon-NikodÂ´ym theorem, MÂµ is
isometrically isomorphic to L1(X;Âµ). Therefore, the adjoint map (Lâˆ£MÂµ)âˆ—takes M(Y;F)âˆ—
to L1(X;Âµ)âˆ—â‰…Lâˆ(X;Âµ), which is a subspace of L1(X;Âµ) since Âµ is ï¬nite. For each B âˆˆF,
deï¬ne Ï„Âµ(Bâˆ£â‹…) to be (Lâˆ£MÂµ)âˆ—Î¦B, where Î¦B âˆˆM(Y;F)âˆ—is the linear functional that evaluates
a signed measure on the set B. Then Ï„Âµ(â‹…âˆ£â‹…) is a L1(X;Âµ)-valued vector measure since the
countable additivity of Âµ implies Ï„Âµ(â‹…âˆ£â‹…) is countably additive. If Âµ is absolutely continuous
with respect to Î½ âˆˆM +, then MÂµ âŠ‚MÎ½, so Ï„Âµ(Bâˆ£â‹…) = Ï„Î½(Bâˆ£â‹…) as elements of L1(X;Âµ).

APPENDIX B. PROPOSITIONS FOR OPTION I
141
Therefore, Ï„.(â‹…âˆ£â‹…) is a pseudo-transition â€œfunctionâ€. To see that Ï„.(â‹…âˆ£â‹…) is bounded in norm,
we have
âˆ¥Ï„.(â‹…âˆ£â‹…)âˆ¥=
sup
ÂµâˆˆM+,âˆ¥Âµâˆ¥â‰¤1
âˆ¥Ï„Âµ(â‹…âˆ£â‹…)âˆ¥
(B.36)
= sup{âˆ‘
j
âˆ¥Ï„Âµ(Ajâˆ£â‹…)âˆ¥âˆ£Âµ âˆˆM +,âˆ¥Âµâˆ¥â‰¤1,
ï¬nite, disjoint collections {Aj},âŠ‚F }
â‰¤sup{âˆ‘
j
Âµ(Aj)âˆ¥Ï„Âµ(Ajâˆ£â‹…)âˆ¥Lâˆ(X;Âµ) âˆ£Âµ âˆˆM +,âˆ¥Âµâˆ¥â‰¤1,
ï¬nite, disjoint collections {Aj},âŠ‚F }
However,
âˆ‘
j
Âµ(Aj)âˆ¥Ï„Âµ(Ajâˆ£â‹…)âˆ¥Lâˆ(X;Âµ) = âˆ‘
j
Âµ(Aj)âˆ¥(Lâˆ£MÂµ)âˆ—Î¦Ajâˆ¥Lâˆ(X;Âµ) â‰¤Âµ(â‹ƒ
j
Aj)âˆ¥(Lâˆ£MÂµ)âˆ—âˆ¥op â‰¤âˆ¥Lâˆ¥op
(B.37)
so âˆ¥Ï„.(â‹…âˆ£â‹…)âˆ¥â‰¤âˆ¥Lâˆ¥op. Lastly, if L is positive, so must be Ï„.(â‹…âˆ£â‹…); otherwise, if there were some
Âµ âˆˆM + and B âˆˆF such that Ï„Âµ(Bâˆ£â‹…) were strictly less than zero on a set A âˆˆE with Âµ(A) > 0,
then
(L(1AÂµ))(B) = âˆ«A(Lâˆ£MÂµ)âˆ—Î¦B dÂµ = âˆ«A Ï„Âµ(Aâˆ£x)dÂµ < 0
(B.38)
which would be a contradiction. â—»
It is also possible to deï¬ne Ï„.(â‹…âˆ£â‹…) in terms of L rather than adjoints of restrictions of L using
the Radon-NikodÂ´ym derivative:
Ï„Âµ(Bâˆ£â‹…) = (Lâˆ£MÂµ)âˆ—Î¦B = d(((Lâˆ£MÂµ)âˆ—Î¦B)Âµ)
dÂµ
= dÂµB
dÂµ
(B.39)
where ÂµB is the E-measure on X given by ÂµB(A) = (L(1AÂµ))(B). Using this, we have the
following:
Proposition B2.9
The positive map L âˆˆB (M,M(Y;F))+ is norm-preserving on the pos-
itive cone if and only if the associated pseudo-transition â€functionâ€ Ï„.(â‹…âˆ£â‹…) satisï¬es Ï„Âµ(Yâˆ£â‹…) =
[1X] for every measure Âµ âˆˆM +.
Proof
Suppose such a positive map L is norm-preserving on the positive cone; then, for
any measure Âµ âˆˆM + and subset A âˆˆE,
(L(1AÂµ))(Y) = (1AÂµ)(X) = Âµ(A)
(B.40)
Therefore, using the notation of the preceding comment, ÂµY = Âµ, so Ï„Âµ(Yâˆ£â‹…) = dÂµ
dÂµ = [1X].
Conversely, suppose Ï„.(â‹…âˆ£â‹…) is such that Ï„Âµ(Yâˆ£â‹…) = [1X] for every measure Âµ âˆˆM +. Then, for
any measure Âµ âˆˆM +,
(LÂµ)(Y) = âˆ«xâˆˆX Ï„(Yâˆ£x)dÂµ(x) = Âµ(X)
(B.41)
so L is norm-preserving on the positive cone. â—»

APPENDIX B. PROPOSITIONS FOR OPTION I
142
B.3
L1-spaces
Notation
In the following, let X, Y,... denote sets and Âµ, Î½,... denote Ïƒ-ï¬nite measures.
Hilbert spaces, denoted H, J,... are complete, sesquilinear inner-product spaces, with no
restriction as to their dimension or separability. D(H), D(J),... denote the spaces of density
matrices (trace-class, self-adjoint operators) on the speciï¬ed Hilbert space. These spaces
are Banach spaces employing the trace norm. L1(X;Âµ), L1(Y;Î½),... denote the space of
integrable, real-valued â€œfunctionsâ€ on the given sets with respect to the given measures.
These spaces are Banach spaces employing the L1-norm. L1(X;Âµ;D(H)), L1(Y;Î½;D(J)),...
denote the space of Bochner-integrable, density-matrix-valued â€œfunctionsâ€ on the given sets
with respect the given measures. These spaces are Banach spaces employing ï¬rst the trace
norm pointwise, then the L1-norm. For n âˆˆ{1,2,...}, Mn is the space of n Ã— n-matrices.
Comment
The following proposition strengthens the well-known result, which is a special
case of a result by Grothendieck [17], that L1(X Ã— Y;Âµ Ã— Î½) = L1(X;Âµ)Ë†âŠ—L1(Y;Î½), where Ë†âŠ—
indicates completion in the projective norm9.
Proposition B3.1
The ï¬nite-nonnegative-tensor-rank10 â€œfunctionsâ€ in L1(X Ã— Y;Âµ Ã— Î½)+,
with respect to â€œfunctionsâ€ in L1(X;Âµ)+ and L1(Y;Î½)+, are dense in the norm topology.
Proof
Take any f âˆˆL1(XÃ—Y;ÂµÃ—Î½)+. f can be arbitrarily well-approximated in L1(XÃ—Y;ÂµÃ—
Î½)-norm by simple functions: âˆ‘j aj1Aj for ï¬nite collections of positive reals {aj} and ï¬nite
Âµ Ã— Î½-measure subsets {Aj}. By the construction of product measures (see [102]), each Aj is
covered by some ï¬nite collection of disjoint, measurable, rectangular subsets {Bk Ã— Ck} with
ÂµÃ—Î½ ((â‹ƒk Bk Ã— Ck) âˆ–Aj) arbitrarily small. Hence, f can be arbitrarily well-approximated in
L1(X Ã— Y;Âµ Ã— Î½)-norm by simple functions: âˆ‘j aj1BjÃ—Cj = âˆ‘j aj1Bj âŠ—1Cj for ï¬nite collections
of positive reals {aj}, ï¬nite Âµ-measure subsets {Bj}, and ï¬nite Î½-measure subsets {Cj}. â—»
B.4
Density-matrix-valued L1-spaces
Proposition B4.1
L1(X;Âµ;D(H)) âŠ—L1(Y;Î½;D(J)) is trace-norm dense within L1(X Ã—
Y;Âµ Ã— Î½;D(H âŠ—J)).
Proof
Given operator Ï âˆˆD(H âŠ—J) , by the spectral theorem for compact operators, Ï
can be arbitrarily well approximated in trace-norm by sums of the form âˆ‘n
j=1 ajej âŠ—eâˆ—
j for
some {aj}n
j=1 âŠ‚R and orthonormal collection of vectors {ej}n
j=1 âŠ‚H âŠ—J. By deï¬nition, each
9The projective norm on AâŠ—B is the norm induced by duality with Bilinear(A,B), âˆ¥câˆ¥âˆ§= inf âˆ‘j âˆ¥ajâˆ¥âˆ¥bjâˆ¥,
where the inï¬num is taken over all âˆ‘j aj âŠ—bj âˆˆA âŠ—B that equal c.
10Using only positive real scalars.

APPENDIX B. PROPOSITIONS FOR OPTION I
143
ej can be arbitrarily well approximated in H âŠ—J-norm (so ej âŠ—eâˆ—
j will be arbitrarily well-
approximated in trace-norm) by sums of the form âˆ‘m
k=1 bkfk âŠ—gk for some bk âˆˆC, fk âˆˆH, and
gk âˆˆJ. Using polarization,
(
m
âˆ‘
k=1
bkfk âŠ—gk) âŠ—(
m
âˆ‘
â„“=1
bâ„“fâ„“âŠ—gâ„“)
âˆ—
(B.42)
=
m
âˆ‘
k,â„“=1
bkbâ„“
1
4 ((fk + fâ„“) âŠ—(fk + fâ„“)âˆ—âˆ’(fk âˆ’fâ„“) âŠ—(fk âˆ’fâ„“)âˆ—
+Ä±(fk + Ä±fâ„“) âŠ—(fk + Ä±fâ„“)âˆ—âˆ’Ä±(fk âˆ’Ä±fâ„“) âŠ—(fk âˆ’Ä±fâ„“)âˆ—)
âŠ—1
4 ((gk + gâ„“) âŠ—(gk + gâ„“)âˆ—âˆ’(gk âˆ’gâ„“) âŠ—(gk âˆ’gâ„“)âˆ—
+Ä±(gk + Ä±gâ„“) âŠ—(gk + Ä±gâ„“)âˆ—âˆ’Ä±(gk âˆ’Ä±gâ„“) âŠ—(gk âˆ’Ä±gâ„“)âˆ—)
=
m
âˆ‘
k=1
âˆ£bkâˆ£2 (fk âŠ—f âˆ—
k ) âŠ—(gk âŠ—gâˆ—
k)
+1
8 âˆ‘
k<â„“
(R(bkbâ„“)(((fk + fâ„“) âŠ—(fk + fâ„“)âˆ—âˆ’(fk âˆ’fâ„“) âŠ—(fk âˆ’fâ„“)âˆ—)
âŠ—((gk + gâ„“) âŠ—(gk + gâ„“)âˆ—âˆ’(gk âˆ’gâ„“) âŠ—(gk âˆ’gâ„“)âˆ—)
+((fk + Ä±fâ„“) âŠ—(fk + Ä±fâ„“)âˆ—âˆ’(fk âˆ’Ä±fâ„“) âŠ—(fk âˆ’Ä±fâ„“)âˆ—)
âŠ—((gk + Ä±gâ„“) âŠ—(gk + Ä±gâ„“)âˆ—âˆ’(gk âˆ’Ä±gâ„“) âŠ—(gk âˆ’Ä±gâ„“)âˆ—))
âˆ’I(bkbâ„“)(((fk + fâ„“) âŠ—(fk + fâ„“)âˆ—âˆ’(fk âˆ’fâ„“) âŠ—(fk âˆ’fâ„“)âˆ—)
âŠ—((gk + Ä±gâ„“) âŠ—(gk + Ä±gâ„“)âˆ—âˆ’(gk âˆ’Ä±gâ„“) âŠ—(gk âˆ’Ä±gâ„“)âˆ—)
+((fk + Ä±fâ„“) âŠ—(fk + Ä±fâ„“)âˆ—âˆ’(fk âˆ’Ä±fâ„“) âŠ—(fk âˆ’Ä±fâ„“)âˆ—)
âŠ—((gk + gâ„“) âŠ—(gk + gâ„“)âˆ—âˆ’(gk âˆ’gâ„“) âŠ—(gk âˆ’gâ„“)âˆ—)))
Then, using the deï¬nition of Bochner integrable functions and following the argument in the
proof of B3.1 gives the desired result. â—»
Corollary B4.2
The Bochner integrable â€œfunctionsâ€11 L1(X;Âµ;S1(H)) âŠ—L1(Y;Î½;S1(J))
are trace-norm dense within L1(X Ã— Y;Âµ Ã— Î½;S1(H âŠ—J)).
Proof
Using Cartesian decomposition12, for any Hilbert space K, S1(K) = D(K) + Ä±D(K).
Then using the preceding proposition gives the desired result. â—»
11The space S1 are the trace-class operators.
12Writing Ï = 1
2(Ï + Ïâˆ—) + Ä± â‹…1
2Ä±(Ï âˆ’Ïâˆ—) for Ï âˆˆS1(K).

APPENDIX B. PROPOSITIONS FOR OPTION I
144
Proposition B4.3
If the Ïƒ-ï¬nite measure Âµ is inï¬nitely-divisible, there is no non-zero,
diagonal13 operator in D(L2(X;Âµ)).
Proof
Take Ï âˆˆD(L2(X;Âµ)) to be diagonal. Take any â€œfunctionâ€ f âˆˆL2(X;Âµ). Take any
Îµ > 0. Since Âµ is inï¬nitely-divisible, the measure âˆ£fâˆ£2Âµ is inï¬nitely-divisible by B1.9, so there
is a countable partition {Bj} of X such that âˆ£fâˆ£2Âµ(Bj) = âˆ«Bj âˆ£fâˆ£2 dÂµ < Îµ for every j. Then,
since Ï is diagonal,
âŸ¨Ïf,fâŸ©= âˆ‘
j,k
âŸ¨Ï1Bjf,1BkfâŸ©= âˆ‘
j
âŸ¨Ï1Bjf,1BjfâŸ©
(B.43)
Using the spectral theorem for compact operators to write Ï = âˆ‘j Î»jÏˆjÏˆâˆ—
j for âŸ¨Î»jâŸ©an
absolutely-summable sequence, orthonormal {Ïˆj} âŠ‚X;Âµ), and Ïˆâˆ—
j the linear functional
âŸ¨â‹…,ÏˆjâŸ©, this becomes
âŸ¨Ïf,fâŸ©= âˆ‘
j
âˆ‘
k
Î»k âˆ£âŸ¨1Bjf,ÏˆkâŸ©âˆ£
2
(B.44)
Since the expression âˆ£âŸ¨1Bjf,ÏˆkâŸ©âˆ£
2 is bounded by the Cauchy-Schwartz inequality and âŸ¨Î»jâŸ©is
absolutely-summable, the sum in k is uniformly convergent, so âŸ¨Ïf,fâŸ©is equal to
âˆ‘
k
âˆ‘
j
Î»k âˆ£âŸ¨1Bjf,ÏˆkâŸ©âˆ£
2
(B.45)
The â€œfunctionsâ€ {1Bjf} are orthogonal, so
âŸ¨Ïf,fâŸ©â‰¤(âˆ‘
k
Î»kâˆ¥Ïˆkâˆ¥2) â‹…sup
j âˆ¥1Bjfâˆ¥2 = âˆ¥Ïâˆ¥trace â‹…Îµ
(B.46)
Since Îµ was arbitrary, it must be that âŸ¨Ïf,fâŸ©= 0. Since f was arbitrary, it must be that Ï is
the zero operator. â—»
B.5
Maps on density-matrix-valued L1-spaces
Proposition B5.1
Any map L âˆˆB (L1(X;Âµ;D(H)),L1(Y;Î½;D(J)) satisï¬es
âˆ¥Lâˆ¥op = sup
â§âªâªâªâ¨âªâªâªâ©
âˆ¥LÏâˆ¥
RRRRRRRRRRRRRR
Ï âˆˆL1(X;Âµ;D(H)),âˆ¥Ïâˆ¥â‰¤1,
Ï is pointwise almost-every-
where rank one
â«âªâªâªâ¬âªâªâªâ­
13An operator Ï âˆˆD(L2(X;Âµ)) is diagonal if âŸ¨Ï1B,1Bâ€²âŸ©= 0 for every disjoint, Âµ-measurable B,Bâ€² with
ï¬nite Âµ-measure.

APPENDIX B. PROPOSITIONS FOR OPTION I
145
Proof
By the deï¬nition of Bochner integrable functions and by the spectral theorem for
compact operators, simple functions with values in the ï¬nite-rank, self-adjoint operators are
L1(X;Âµ;D(H))-norm dense. Therefore, âˆ¥Lâˆ¥op is equal to
sup
â§âªâªâªâªâªâªâªâªâªâªâªâªâªâ¨âªâªâªâªâªâªâªâªâªâªâªâªâªâ©
âˆ¥
n
âˆ‘
j=1
m
âˆ‘
k=1
Î»jkL(1Ajek
j âŠ—ekâˆ—
j )âˆ¥
RRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRR
n,m âˆˆ{1,2,...}, disjoint
Âµ-measurable subsets {A1,...,An},
collections of orthonormal
elements of H
{{e1
1,...,e1
m},...,{en
1,...,en
m}},
{Î»11,...,Î»nm} âŠ‚R,
âˆ‘n
j=1 âˆ‘m
k=1 âˆ£Î»jkâˆ£Âµ(Aj) â‰¤1
â«âªâªâªâªâªâªâªâªâªâªâªâªâªâ¬âªâªâªâªâªâªâªâªâªâªâªâªâªâ­
(B.47)
where ekâˆ—
j
is the functional âŸ¨â‹…,ek
jâŸ©. Now ï¬x a value of j, the A1,...,An, all the collections
of orthonormal vectors, and all the Î»â€™s except Î»j1,...,Î»jm. The set of all elements of of
L1(Y;Î½;D(J) given by âˆ‘n
j=1 âˆ‘m
k=1 Î»jkL(1Ajek
j âŠ—ekâˆ—
j ) for ï¬xed âˆ‘m
k=1 âˆ£Î»jkâˆ£is a ï¬nite-dimensional,
convex subset; hence, its maximum value of norm necessarily occurs at its extreme points
where one Î»jk is nonzero whereas Î»j1,..., Ì‚
Î»jk,...,Î»jm are all zero. Since the choice of j was
arbitrary, this is true for all j, so the supremum is unchanged by restricting to m = 1. â—»
Proposition B5.2
Any positive map L âˆˆB(L1(X;Âµ;D(H)),L1(Y;Î½;D(J))+ satisï¬es
âˆ¥Lâˆ¥op = sup
â§âªâªâªâ¨âªâªâªâ©
âˆ¥LÏâˆ¥
RRRRRRRRRRRRRR
Ï âˆˆL1(X;Âµ;D(H))+,âˆ¥Ïâˆ¥â‰¤1,
Ï is pointwise almost-every-
where rank one
â«âªâªâªâ¬âªâªâªâ­
Proof
By the proof of the preceding proposition, âˆ¥Lâˆ¥op is equal to
sup
â§âªâªâªâªâªâªâªâªâ¨âªâªâªâªâªâªâªâªâ©
âˆ¥
n
âˆ‘
j=1
Î»jL(1Ajej âŠ—eâˆ—
j)âˆ¥
RRRRRRRRRRRRRRRRRRRRRRR
n âˆˆ{1,2,...}, disjoint
Âµ-measurable subsets{A1,...,An},
unit-norm e1,...,en âˆˆH,
{Î»1,...,Î»n} âŠ‚R,
âˆ‘n
j=1 âˆ£Î»jâˆ£Âµ(Aj) â‰¤1
â«âªâªâªâªâªâªâªâªâ¬âªâªâªâªâªâªâªâªâ­
(B.48)
The supremum can only be reduced or stay the same by restricting to positive Î»jâ€™s. However,
since L is positive, by the triangle inequality and the quasi-AL-property14 of L1(Y;Î½;D(J)),
âˆ¥
n
âˆ‘
j=1
Î»jL(1Ajej âŠ—eâˆ—
j)âˆ¥â‰¤
n
âˆ‘
j=1
âˆ£Î»jâˆ£âˆ¥L(1Ajej âŠ—eâˆ—
j)âˆ¥= âˆ¥
n
âˆ‘
j=1
âˆ£Î»jâˆ£L(1Ajej âŠ—eâˆ—
j)âˆ¥
(B.49)
so the supremum can also only be increased or stay the same by restricting to positive Î»jâ€™s.
Therefore, it must have the same value. â—»
14A Banach space has the quasi-AL-property if âˆ¥a + bâˆ¥= âˆ¥aâˆ¥+ âˆ¥bâˆ¥for positive a, b.

APPENDIX B. PROPOSITIONS FOR OPTION I
146
Corollary B5.3
The cone of positive maps B (L1(X;Âµ;D(H)),L1(Y;Î½;D(J)))+ is a normal
cone for the induced operator norm.
Proposition B5.4
If L âˆˆB (L1(X;Âµ;D(H)),L1(Y;Î½;D(J))) is completely bounded15,
then, for any space Z, any measure Ï„, and any Hilbert space K, âˆ¥L âŠ—Iâˆ¥op â‰¤âˆ¥Lâˆ¥matrix with I
the identity map in B (L1(Z;Ï„;D(K))).
Proof
By the deï¬nition of operator norm and the deï¬nition of the tensor product of maps,
âˆ¥L âŠ—Iâˆ¥op is equal to
sup{âˆ¥(L âŠ—I)Ïâˆ¥âˆ£ï¬nite-tensor-rank Ï âˆˆL1(X Ã— Z;Âµ Ã— Ï„;D(H âŠ—K))
with âˆ¥Ïâˆ¥â‰¤1
}
(B.50)
By the proof of B5.1, it is only necessary to take the supremum over simple functions taking
values with rank one. By the argument in the proof of B3.1, the sets in the simple functions
can be restricted to being rectangular. This eliminates consideration of Z and Ï„, replacing
them with positive, real scalars that can be incorporated into the operators. Finally, rank-
one, tensor-rank-n operators live on a n-dimensional subspace of K, which can be identiï¬ed
with Cn.
Making the identiï¬cation L1(one point;trivial measure;D(Cn)) â†”D(Cn) then
gives that âˆ¥L âŠ—Iâˆ¥op is equal to supnâ‰¤dim K âˆ¥L âŠ—IMnâˆ¥op. â—»
Proposition B5.5
If the positive map L âˆˆB (L1(X;Âµ;D(H)),L1(Y;Î½;D(J)))+ is such
that, for some space Z, some measure Ï„, and some Hilbert space K, L âŠ—I is positive with I
the identity map in B (L1(Z;Ï„;D(K))), then âˆ¥L âŠ—Iâˆ¥op = âˆ¥Lâˆ¥op.
Proof
Starting as with the preceding proof, we arrive at the point where âˆ¥LâŠ—Iâˆ¥op is given
as
sup
â§âªâªâªâªâªâªâªâªâªâªâªâªâªâ¨âªâªâªâªâªâªâªâªâªâªâªâªâªâ©
âˆ¥
n
âˆ‘
j=1
(L âŠ—I)(ajvj âŠ—vâˆ—
j 1Aj âŠ—1Bj)âˆ¥
RRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRR
n âˆˆ{1,2,...},
ï¬nite-tensor-rank
{v1,...,vn} âˆˆH âŠ—K,
{a1,...,an} âŠ‚R,
Âµ-measurable {A1,...,An},
Ï„-measurable {B1,...,Bn},
withâˆ‘n
j=1 âˆ£ajâˆ£âˆ¥vjâˆ¥2Âµ(Aj)Ï„(Bj) â‰¤1
â«âªâªâªâªâªâªâªâªâªâªâªâªâªâ¬âªâªâªâªâªâªâªâªâªâªâªâªâªâ­
(B.51)
where vâˆ—
j is the functional âŸ¨â‹…,vjâŸ©. Since L âŠ—I is positive, as in the proof for B5.2, it is
possible to restrict to positive ajâ€™s without changing the result. Then aj can be combined
with Ï„(Bj) and both incorporated into a change in the norm of vj. Furthermore, since vj is
of ï¬nite-tensor-rank, it is necessarily in H âŠ—Lj for some ï¬nite-dimensional subspace Lj âŠ‚K,
so it can be written as âˆ‘
dim Lj
k=1
xj
k âŠ—ej
k with {ej
k} an orthonormal basis for Lj.
15L is completely bounded if it has ï¬nite matrix-norm, âˆ¥Lâˆ¥matrix = supn âˆ¥L âŠ—IMnâˆ¥op.

APPENDIX B. PROPOSITIONS FOR OPTION I
147
Then we have for âˆ¥L âŠ—Iâˆ¥op,
sup
â§âªâªâªâªâ¨âªâªâªâªâ©
n
âˆ‘
j=1
m
âˆ‘
k=1
âˆ¥L(xj
k âŠ—xjâˆ—
k 1Aj)âˆ¥
RRRRRRRRRRRRRRR
n âˆˆ{1,2,...},m âˆˆ{1,2,...},m â‰¤dimK,
Âµ-measurable {A1,...,An},
{xk
j} âŠ‚H,âˆ‘n
j=1 âˆ‘m
k=1 âˆ¥xj
kâˆ¥
2 Âµ(Aj) â‰¤1
â«âªâªâªâªâ¬âªâªâªâªâ­
(B.52)
By taking the xâ€™s to be unit length and introducing new, real scalar variables for their
squared norm, then by following the argument in the proof of B5.1, the supremum is the
same if m = 1. Hence, âˆ¥L âŠ—Iâˆ¥op is equal to
sup
â§âªâªâªâ¨âªâªâªâ©
n
âˆ‘
j=1
tr âˆ¥L(xj âŠ—xâˆ—
j1Aj)âˆ¥
RRRRRRRRRRRRRR
n âˆˆ{1,2,...},
Âµ-measurable {A1,...,An},
{xj} âŠ‚H,âˆ‘n
j=1 âˆ¥xjâˆ¥2 Âµ(Aj) â‰¤1
â«âªâªâªâ¬âªâªâªâ­
(B.53)
which is âˆ¥Lâˆ¥op. â—»
Corollary B5.6
The completely-positive16 maps
B (L1(X;Âµ;D(H)),L1(Y;Î½;D(J)))
cp
are completely bounded.
Corollary B5.7
The cone of completely-positive maps,
B (L1(X;Âµ;D(H)),L1(Y;Î½;D(J)))
cp
is a normal cone for either the induced operator norm or the matrix norm.
Proposition B5.8
If L âˆˆB (L1(X;Âµ;D(H)),L1(Y;Î½;D(J))) is completely positive, then,
for any space Z, any measure Ï„, and any Hilbert space K, LâŠ—I is positive, with I the identity
map in B (L1(Z;Ï„;D(K))).
Proof
Since L is completely positive, by B5.6 it is completely bounded. Hence, L âŠ—I
exists by B5.4. Furthermore, by B4.1 and A1.3, L âŠ—I is unique, so it is meaningful to
speak of it being positive.
Now suppose there were some space Z, some measure Ï„, and some Hilbert space K such
that LâŠ—I were not positive. Then there would be some positive Ï âˆˆL1(X Ã—Z;ÂµÃ—Ï„;D(HâŠ—K))+
such that (L âŠ—I)Ï is not positive.
Since the cone L1(Y Ã— Z;Î½ Ã— Ï„;D(J âŠ—K))+ is norm-
closed and L âŠ—I is continuous, that implies there is a relatively open neighborhood of
Ï in the cone L1(X Ã— Z;Âµ Ã— Ï„;D(H âŠ—K))+ whose image under L âŠ—I does not intersect
L1(Y Ã— Z;Î½ Ã— Ï„;D(J âŠ—K))+.
Now approximating Ï as in the proof of B5.4, one ï¬nds that for this to occur there must
be some n âˆˆ{1,2,...} for which L âŠ—IMn is not positive; however, that is a contradiction. â—»
16L is completely positive if L âŠ—IMn is positive for every n âˆˆ{1,2,...,}.

APPENDIX B. PROPOSITIONS FOR OPTION I
148
Proposition B5.9
If either dimH or dimJ is ï¬nite and if a positive map
L âˆˆB (L1(X;Âµ;D(H)),L1(Y;Î½;D(J)))
+
is such that L âŠ—IMm is positive for m = min{dimH,dimJ}, then L is completely positive.
Proof
Clearly, since L âŠ—IMm is positive, so is L âŠ—IMn for all n < m. Now take n > m.
L âŠ—IMn will be positive if for every Ï âˆˆL1(X;Âµ;D(H âŠ—Cn))+, y âˆˆJ âŠ—Cn, and Î½-measurable
B âŠ‚Y,
âˆ«BâŸ¨((L âŠ—IMn)Ï)y,yâŸ©JâŠ—Cn dÎ½ â‰¥0
(B.54)
By the deï¬nition of Bochner integrable functions and the spectral theorem for compact
operators, it is enough to show this for Ï that are simple functions with value in the rank-
one operators. We then have to consider, for any ï¬nite collection of vectors {xj} âŠ‚H âŠ—Cn
and Âµ-measurable subsets {Aj}
âˆ‘
j âˆ«BâŸ¨(L âŠ—IMn)(xj âŠ—xâˆ—
j 1Aj)y,yâŸ©JâŠ—Cn dÎ½
(B.55)
where xâˆ—
j is the functional âŸ¨â‹…,xjâŸ©. Writing y = âˆ‘n
k=1 vk âŠ—ek and xj = âˆ‘n
k=1 wjk âŠ—ek for {ek}
an orthonormal basis for Cn gives (B.55) as
âˆ‘
j
n
âˆ‘
k,l=1âˆ«BâŸ¨L(wjk âŠ—wâˆ—
jl 1Aj)vl,vkâŸ©J dÎ½
(B.56)
However, âˆ‘n
l=1 wâˆ—
jl âŠ—vl is of rank at most m, so there are { Ëœwjl} and {Ëœvl} such that
n
âˆ‘
l=1
wâˆ—
jl âŠ—vl =
m
âˆ‘
l=1
Ëœwâˆ—
jl âŠ—Ëœvl
(B.57)
The condition for L âŠ—IMn to be positive is then that for every Î½-measurable B âŠ‚Y, ï¬nite
collection of Âµ-measurable subsets {Aj}, and ï¬nite collections of vectors { Ëœwjk} âŠ‚H and
{Ëœvk} âŠ‚J,
âˆ‘
j
m
âˆ‘
k,l=1âˆ«BâŸ¨L( Ëœwjk âŠ—Ëœwâˆ—
jl 1Aj)Ëœvl, ËœvkâŸ©J dÎ½ â‰¥0
(B.58)
However, this condition is independent of n, as long as it is greater than or equal to m. â—»
Proposition B5.10
The space of completely-bounded maps,
CB (L1(X;Âµ;D(H)),L1(Y;Î½;D(J)))
is a Banach space with respect to the matrix norm.

APPENDIX B. PROPOSITIONS FOR OPTION I
149
Proof
Let âŸ¨LjâŸ©be a Cauchy sequence in the matrix norm of such maps. Since the matrix-
norm is greater than or equal to the operator norm, this is a Cauchy sequence in operator
norm, so since the space is a Banach space with respect to the operator norm, it converges
to some Lâˆin that norm. It remains to show that Lâˆis completely bounded. For each
n âˆˆ{1,2,...}, by the triangle inequality, âˆ¥K âŠ—IMnâˆ¥op â‰¤n2âˆ¥Kâˆ¥op for any linear map K âˆˆ
B (L1(X;Âµ;D(H)),L1(Y;Î½;D(J))); hence, the functional K â†’âˆ¥K âŠ—IMnâˆ¥op is continuous in
the operator-norm topology. Since âŸ¨LjâŸ©converges to Lâˆin this topology, it must be that
âˆ¥LâˆâŠ—IMnâˆ¥op = lim
jâ†’âˆâˆ¥Lj âŠ—IMnâˆ¥op â‰¤lim
jâ†’âˆâˆ¥Ljâˆ¥matrix
(B.59)
The right-hand limit necessarily exists since âŸ¨LjâŸ©is a Cauchy sequence. Therefore, âˆ¥Lâˆâˆ¥matrix â‰¤
limjâ†’âˆâˆ¥Ljâˆ¥matrix, so Lâˆis completely bounded. â—»
Proposition B5.11
The subset of B (L1(X;Âµ;D(H)),L1(Y;Î½;D(J))) for which the tensor
product with IMn is positive for some ï¬xed n âˆˆ{1,2,...} is closed in the weak topology.
Proof
We will show the complement is open. Take such a map L that is not in the subset.
By the argument in the proof for B5.9, that implies there are some Î½-measurable B âŠ‚Y,
ï¬nite collection of Âµ-measurable subsets {Aj}, ï¬nite collections of vectors {wjk} âŠ‚H and
{vk} âŠ‚J, and Îµ > 0 such that
m
âˆ‘
j=1
n
âˆ‘
k,l=1âˆ«BâŸ¨L(wjk âŠ—wâˆ—
jl 1Aj)vl,vkâŸ©J dÎ½ < âˆ’Îµ
(B.60)
Then, by the triangle inequality, all the maps in the weak neighborhood
m
â‹‚
j=1
n
â‹‚
k,l=1
N (L;wjkwâˆ—
jk 1Aj;vl âŠ—vâˆ—
l 1B;
Îµ
2n4m)
(B.61)
+
m
â‹‚
j=1
n
â‹‚
k=1
â‹‚
r<l
N (L;(wjr âŠ—wâˆ—
jl + wjl âŠ—wâˆ—
jr)1Aj;vk âŠ—vâˆ—
k 1B;
Îµ
n4m)
+
m
â‹‚
j=1
n
â‹‚
k=1
â‹‚
r<l
N (L;wjk âŠ—wâˆ—
jk 1Aj;(vk âŠ—vâˆ—
m + vm âŠ—vâˆ—
k)1B;
Îµ
n4m)
+
m
â‹‚
j=1 â‹‚
k<l
â‹‚
q<r
N (L;(wjk âŠ—wâˆ—
jl + wjl âŠ—wâˆ—
jk)1Aj;(vq âŠ—vâˆ—
r + vr âŠ—vâˆ—
q)1B; 2Îµ
n4m)
will also fail to yield a positive tensor product with IMn. â—»
Corollary B5.12
The cone of completely positive maps is weakly closed in
B (L1(X;Âµ;D(H)),L1(Y;Î½;D(J))).

APPENDIX B. PROPOSITIONS FOR OPTION I
150
Comment
The preceding result also follows from showing that the spaces are norm-closed,
then using the separating theorem to argue that the weak and norm topologies have the
same closed, convex subsets. The approach followed here is preferable since, as has already
been noted, the separating theorem depends on the axiom of choice through the Hahn-
Banach theorem. For the case where the measures are trivial, the space is a dual space,
D(H) = K(H)âˆ—, so it is possible to do better.
Proposition B5.13
The subset of B (D(H),D(J)) for which the tensor product with IMn
is positive for some ï¬xed n âˆˆ{1,2,...} is closed in the weak* topology.
Proof
Following the proof of B5.9, if L âŠ—IMn is not positive, then there are some ï¬nite
collections of vectors {wk} âŠ‚H and {vk} âŠ‚J, and Îµ > 0 such that all the maps in the weak*
neighborhood
n
â‹‚
k,l=1
N (L;wkwâˆ—
k 1Aj;vl âŠ—vâˆ—
l 1B; Îµ
2n4)
(B.62)
+
n
â‹‚
k=1
â‹‚
r<l
N (L;(wr âŠ—wâˆ—
l + wl âŠ—wâˆ—
r)1Aj;vk âŠ—vâˆ—
k 1B; Îµ
n4)
+
n
â‹‚
k=1
â‹‚
r<l
N (L;wk âŠ—wâˆ—
k 1Aj;(vk âŠ—vâˆ—
m + vm âŠ—vâˆ—
k)1B; Îµ
n4)
+ â‹‚
k<l
â‹‚
q<r
N (L;(wk âŠ—wâˆ—
l + wl âŠ—wâˆ—
k)1Aj;(vq âŠ—vâˆ—
r + vr âŠ—vâˆ—
q)1B; 2Îµ
n4)
will also fail to yield a positive tensor product with IMn. â—»
Corollary B5.14
The cone of completely positive maps in B (D(H),D(J)) is closed in the
weak* topology.
Proposition B5.15
Any bounded, positively-linear map L to L1(Y;Î½;D(J)) that is given
on the positive cone of L1(X;Âµ;D(H)) extends uniquely by linearity to a map
L âˆˆB (L1(X;Âµ;D(H)),L1(Y;Î½;D(J)))+.
Proof
Let L be any such map. Extend L to B(L1(X;Âµ;D(H)),L1(Y;Î½;D(J)))+ by
L(Ï) = L(âˆ£Ïâˆ£+ Ï
2
) âˆ’L(âˆ£Ïâˆ£âˆ’Ï
2
) for any Ï âˆˆL1(X;Âµ;D(H))
(B.63)
where âˆ£â‹…âˆ£is applied pointwise with âˆ£Ïâˆ£(x) = âˆ£Ï(x)âˆ£=
âˆš
Ï(x)2. It is readily seen that positive
linearity implies the extended L is now linear over R. Furthermore, by B5.2, this extension
does not increase the operator norm.

APPENDIX B. PROPOSITIONS FOR OPTION I
151
Proposition B5.16
Any map L âˆˆB (L1(X;Âµ;D(H)),L1(Y;Î½;D(J)))+ extends uniquely
by linearity to a map L âˆˆB (L1(X;Âµ;S1(H)),L1(Y;Î½;S1(J)))+. This extension has operator
norm less than twice that of the restricted map.
Proof
Let L be any such map. Extend L to L âˆˆB(L1(X;Âµ;S1(H)),L1(Y;Î½;S1(J))+) by
using Cartesian decomposition,
L(Ï) = L(Ï + Ïâˆ—
2
) + Ä±L(Ï âˆ’Ïâˆ—
2Ä±
) for any Ï âˆˆL1(X;Âµ;S1(H))
(B.64)
where * is applied pointwise with Ïâˆ—(x) = Ï(x)âˆ—. It is readily seen that real linearity implies
the extended L is now linear over C. By deï¬nition, this extended map is a positive one.
The triangle inequality implies the extension has operator norm less than twice that of the
restricted map. â—»
Comment
Using
S1 (L2(X;Âµ)) âŠ‚S2 (L2(X;Âµ)) â‰…L2 (X Ã— X;Âµ Ã— Âµ)
(B.65)
(where S2 are the Hilbert-Schmidt operators) one might imagine a map diag that extracts
the diagonal of an operator Ï âˆˆS1 (L2 (X;Âµ)) by diag Ï(x) = Ï(x,x). This does not work
since the actual values of Ï are completely arbitrary on the diagonal. However, there is a
useful map which does correspond to this naive notion. By singular-value decomposition,
any Ï âˆˆS1 (L2 (X;Âµ)) can be written as the countable sum âˆ‘j Ïƒjfj âŠ—gâˆ—
j for âŸ¨ÏƒjâŸ©âˆˆâ„“âˆ+ and
some unit length {fj,gj} âŠ‚L2 (X;Âµ). There is a measure Î½ associated to Ï, clearly absolutely
continuous with respect to Âµ, given by for any Âµ-measurable subset B âŠ‚X,
Î½(B) = tr PBÏ = âˆ«B âˆ‘
j
fjgj dÂµ
where PB is the orthogonal projector associated to the subspace of L2 (X;Âµ) that is zero
(almost everywhere with respect to Âµ) outside B. Then we have:
Deï¬nition B5.17
Let the map diag: S1 (L2 (X;Âµ)) â†’L1 (X;Âµ) be deï¬ned by the Radon-
NikodÂ´ym derivative
diag Ï = dÎ½
dÂµ
The diagonal extraction map is clearly linear and positive.
We also have the following
properties:
Proposition B5.18
The diagonal extraction map has operator norm one. Furthermore,
on the equivalence classes S1 (L2 (X;Âµ))/ker diag, it is an isometric bijection.

APPENDIX B. PROPOSITIONS FOR OPTION I
152
Proof
Using the singular-value-decomposition form for the trace-class operator Ï as above,
âˆ¥diag Ïâˆ¥= âˆ«X âˆ£âˆ‘
j
Ïƒjfjgjâˆ£dÂµ
â‰¤âˆ‘
j
Ïƒj âˆ«X âˆ£fjgjâˆ£dÂµ
(B.66)
using the triangle inequality and the Dominated Convergence theorem. Using the Cauchy-
Schwartz inequality, this is less than or equal to
âˆ‘
j
Ïƒjâˆ¥fjâˆ¥âˆ¥gjâˆ¥= âˆ‘
j
Ïƒj = âˆ¥Ïâˆ¥trace
(B.67)
Since Ï was arbitrary, âˆ¥diagâˆ¥op â‰¤1. It is equal to one since diag is clearly an isometry on the
positive cone D (L2(X;Âµ))+.
If the Ïƒ-algebra for X were generated by countably many atomic subsets, it is easy
to see that diag is an isometric bijectionâ€“one simply notes the diagonal operator whose
diagonal agrees with the diagonal of Ï is in the same equivalence class and that for this
particular operator, the map clearly preserves the norm. However, in general, there are
no diagonal, trace-class operators on L2 (X;Âµ), so we need to work a little harder.
Let
s âˆˆLâˆ(X;(diag Ï)Âµ) be the phase valued â€œfunctionâ€ given by
s = diag Ï
âˆ£diag Ïâˆ£
(B.68)
(it can be left undeï¬ned where diag Ï is zero). Then the trace-class operator Î¾ = sâˆšdiag Ï âŠ—
âˆšdiag Ï has the same trace as Ï; hence, it is in the same equivalence class. Therefore,
âˆ¥[Ï]âˆ¥= inf
Ë†Ïâˆˆ[Ï]âˆ¥Ë†Ïâˆ¥trace â‰¤âˆ¥Î¾âˆ¥trace = âˆ¥diag Ïâˆ¥
(B.69)
which by the above result is less than or equal to
inf
Ë†Ïâˆˆ[Ï]âˆ¥Ë†Ïâˆ¥trace
(B.70)
Hence, âˆ¥[Ï]âˆ¥= âˆ¥diag Ïâˆ¥. Since Ï was arbitrary, diag is an isometry. It is surjective since for
any â€œfunctionâ€ f âˆˆL1 (X;Âµ), deï¬ning s similarly to above,
s = f
âˆ£fâˆ£
(B.71)
(it can be left undeï¬ned where f is zero), then the trace-class operator Î¾ = sâˆšf âŠ—âˆšf has
diag Î¾ = f. â—»
Proposition B5.19
Both the diagonal extraction map diag and its inverse diagâˆ’1 âˆ¶L1 (X;Âµ) â†’
S1 (L2 (X;Âµ))/ker diag are completely-positive.

APPENDIX B. PROPOSITIONS FOR OPTION I
153
Proof
By the spectral theorem for compact operators, it is enough to demonstrate posi-
tivity for diag âŠ—IMn acting on rank-one density matrices. Furthermore, since ï¬nite-tensor
rank vectors are dense, it is enough show that
âˆ«E âŸ¨(diag âŠ—IMn)(
m
âˆ‘
j=1
fj âŠ—aj
m
âˆ‘
k=1
f âˆ—
k âŠ—aâˆ—
j)b,bâŸ©dÂµ â‰¥0
(B.72)
for any m,n âˆˆZ+, any {aj} âŠ‚Cn, any b âˆˆCn, any {fj} âŠ‚L2 (X;Âµ), and any Âµ-measurable
subset E âŠ‚X. However, the left-hand side is equal to âˆ«E âˆ£gâˆ£2 dÂµ, where g = âˆ‘m
j=1âŸ¨aj,bâŸ©fj,
which is clearly greater than or equal to zero.
Firstly, note diagâˆ’1 âŠ—IMn is well-deï¬ned since
S1 (L2 (X;Âµ) âŠ—Cn)/ker (diag âŠ—IMn) = (S1 (L2 (X;Âµ))/ker diag)) âŠ—Mn
(B.73)
Furthermore, by A1.3, diagâˆ’1 âŠ—IL1(Y;Î½;S1(H)) is well-deï¬ned for any Y,Î½,H since
(S1 (L2 (X;Âµ))/ker diag)) âŠ—L1(Y;Î½;S1(H))
(B.74)
is norm-dense in
S1 (L2 (X Ã— Y;Âµ Ã— Î½) âŠ—H)/ker (diag âŠ—IL1(Y;Î½;S1(H)))
(B.75)
(This will be needed in further propositions below.)
A notion of positivity is provided
on (S1 (L2 (X;Âµ))/ker diag)) âŠ—Mn by taking equivalence classes with positive members
to be positive; this is equivalent to Î± being positive if tr Î²Î± â‰¥0 for any positive Î² âˆˆ
W(X;Âµ;Cn)+ = diag âˆ—Lâˆ(X;Âµ)+ âŠ—D(Cn)+ (W is deï¬ned below in B5.21, diag âˆ—is deï¬ned
following this proof). Any such positive Î² can be written as Î³âˆ—Î³ for some Î³ âˆˆW(X;Âµ;Cn) =
diag âˆ—Lâˆ(X;Âµ)+ âŠ—B(Cn).
Using the preceding, together with the deï¬nition of Bochner integrability for L1(X;Âµ;D(Cn))
and the (ï¬nite dimensional) spectral theorem, to show diagâˆ’1 is completely positive we need
to show
tr (Î³âˆ—Î³(diagâˆ’1 âŠ—IMn)1Baaâˆ—) â‰¥0
(B.76)
for any Âµ-measurable subset B âŠ‚X, a âˆˆCn, and Î³ âˆˆdiag âˆ—Lâˆ(X;Âµ)+ âŠ—B(Cn). Writing Î³ as
âˆ‘n
i,j=1 fijeieâˆ—
j for {ej} an orthonormal basis for Cn and fij âˆˆLâˆ(X;Âµ), the left-hand side is
n
âˆ‘
i,j,k=1
akai âˆ«B fjifjk dÂµ =
n
âˆ‘
j=1
akai âˆ«B gjgj dÂµ
(B.77)
where ak = âŸ¨a,ekâŸ©and gj = âˆ‘n
k=1 akfjk. This is clearly positive. â—»

APPENDIX B. PROPOSITIONS FOR OPTION I
154
Comment
Using B5.18 with standard results for Banach spaces then gives the following
bijection:
diagâˆ—âˆ¶Lâˆ(X;Âµ) â†’image diagâˆ—âŠ‚B (L2 (X;Âµ))
(B.78)
Note diagâˆ—(f)g is the pointwise multiplication fg for f âˆˆLâˆ(X;Âµ) and g âˆˆL2 (X;Âµ). Then
diag* is clearly isometric and is a representation (clearly weak* continuous) of the von Neu-
mann algebra17 Lâˆ(X;Âµ) (with product given by pointwise multiplication of â€œfunctionsâ€)
as operators in B (L2 (X;Âµ)).
Morally, one would hope for L1 (X;Âµ;S1(H))âˆ—to be Lâˆ(X;Âµ;B(H)), which is a C*-
algebra. That is almost correct, as the following proposition indicates.
Lemma B5.20
For any Î¨ âˆˆL1 (X;Âµ;S1(H))âˆ—,
âˆ¥Î¨âˆ¥op = sup{
1
Âµ(B)Î¨(1BÏˆÎ¾âˆ—)âˆ£Âµ-measurable B âŠ‚X
unit length Ïˆ,Î¾ âˆˆH
}
Proof
By the deï¬nition of the Bochner integrability for L1 (X;Âµ;S1(H)), it is enough to
take the supremum over simple, S1(H)-valued functions:
âˆ¥Î¨âˆ¥op = sup
â§âªâªâªâªâªâ¨âªâªâªâªâªâ©
Î¨(âˆ‘j tj1BjÏ•j)
âˆ‘j tjÂµ(Bj)
RRRRRRRRRRRRRRRRRR
Âµ-measurable, disjoint {Bj}
{Ï•j} âŠ‚S1(H)
each with unit trace-norm
{tj} âŠ‚R+ âˆª{0}
â«âªâªâªâªâªâ¬âªâªâªâªâªâ­
(B.79)
For ï¬xed {Bj} and {Ï•j}, the expression the supremum is being taken over is rational linear
in {tj}; hence it is necessarily maximized when all but one value of tj are zero. Therefore,
it is only necessary to take the supremum over S1(H)-valued functions of the form
1
Âµ(B)1BÏ•
for Âµ-measurable B âŠ‚X and unit-trace-norm Ï• âˆˆS1(H). By a similar argument applied to
the singular-value decomposition of Ï•, it is further only necessary to take Ï• rank-one. â—»
Proposition B5.21
There is a well-deï¬ned, completely-positive, surjective map with op-
erator norm one
diag âŠ—IB(H) âˆ¶S1 (L2(X;Âµ) âŠ—H) â†’L1 (X;Âµ;S1(H))
which is an isometry on the positive cone. This map gives rise to the isometric bijections
diag âŠ—IB(H) âˆ¶S1 (L2 (X;Âµ) âŠ—H)/ker (diag âŠ—IB(H)) â†’L1 (X;Âµ;S1(H))
(diag âŠ—IB(H))âˆ—âˆ¶L1 (X;Âµ;S1(H))âˆ—â†’image (diag âŠ—IB(H))âˆ—= W(X;Âµ;H) âŠ‚B (L2 (X;Âµ) âŠ—H)
17A Banach algebra is a Banach space equipped with an associative, distributive product satisfying âˆ¥abâˆ¥â‰¤
âˆ¥aâˆ¥âˆ¥bâˆ¥. A *-algebra is a Banach algebra with an antilinear involution. A C*-algebra is a *-algebra where
âˆ¥aâˆ—aâˆ¥= âˆ¥aâˆ¥2. A von Neumann algebra (also termed a W*-algebra) is a C*-algebra which, as a Banach space,
is a dual space.

APPENDIX B. PROPOSITIONS FOR OPTION I
155
Proof
Using B4.2, S1 (L2 (X;Âµ)) âŠ—S1 (H) is trace-norm dense in S1 (L2 (X;Âµ) âŠ—H). By
the deï¬nition of Bochner integrability, L1 (X;Âµ;S1(H)) is the norm completion of L1 (X;Âµ)âŠ—
S1(H). Hence, diag âŠ—IB(H) is a well-deï¬ned map for the given domain and range by A1.3.
It has operator norm one by A1.3, B5.19, B5.18, and B5.5. It is completely positive by
B5.18 and B5.8. By the deï¬nition of Bochner integrability, the simple functions of the
form âˆ‘j 1BjÏ•j for disjoint, Âµ-measurable subsets {Bj} and {Ï•j} âŠ‚S1(H) are norm-dense
in L1 (X;Âµ;S1(H)). These have preimages in S1 (L2 (X;Âµ) âŠ—H) given by âˆ‘j (1Bj âŠ—1Bj)Ï•j.
Since diag âŠ—IB(H) is bounded (hence, continuous), it is surjective. To see that it is isometric
on the positive cone D (L2 (X;Âµ) âŠ—H)+, by the spectral theorem for compact operators, it is
only necessary to check the rank-one case. By continuity and the deï¬nition of L2 (X;Âµ)âŠ—H,
it is only necessary to check the case where the vectors are of ï¬nite-tensor-rank, âˆ‘m
j=1 fj âŠ—Î¾j
for {fj} âŠ‚L2 (X;Âµ) and {Î¾j} âŠ‚H. Then,
âˆ¥
m
âˆ‘
j=1
fj âŠ—Î¾j
m
âˆ‘
k=1
f âˆ—
k âŠ—Î¾âˆ—
kâˆ¥
trace
= tr
m
âˆ‘
j=1
fj âŠ—Î¾j
m
âˆ‘
k=1
f âˆ—
k âŠ—Î¾âˆ—
k =
m
âˆ‘
j,k=1âˆ«X fjfk dÂµâŸ¨Î¾j,Î¾kâŸ©
= âˆ¥(diag âŠ—IB(H))(
m
âˆ‘
j=1
fj âŠ—Î¾j
m
âˆ‘
k=1
f âˆ—
k âŠ—Î¾âˆ—
k)âˆ¥
(B.80)
so diag âŠ—IB(H) is indeed isometric on the positive cone.
By the preceding results, the map
diag âŠ—IB(H) âˆ¶S1 (L2 (X;Âµ) âŠ—H)/ker (diag âŠ—IB(H)) â†’L1 (X;Âµ;S1(H))
(B.81)
is certainly a bijection. From the dense set of values considered above to establish surjectivity,
it is isometric. By standard properties of Banach spaces, the adjoint map
(diag âŠ—IB(H))âˆ—âˆ¶L1 (X;Âµ;S1(H))âˆ—â†’image (diag âŠ—IB(H))âˆ—= W(X;Âµ;H) âŠ‚B (L2 (X;Âµ) âŠ—H)
(B.82)
is a bijection. To see it is an isometry, take any Î¨ âˆˆL1 (X;Âµ;S1(H))âˆ—. By the deï¬nition of
operator norm and the Cauchy-Schwartz inequality, there is the well-known formula for the
operator norm in B(J) for any Hilbert space J,
âˆ¥Î²âˆ¥op =
sup
x, y âˆˆJ
âˆ¥xâˆ¥â‰¤1, âˆ¥yâˆ¥â‰¤1
âŸ¨Î²x,yâŸ©
(B.83)
Using this, we have
âˆ¥(diag âŠ—IB(H))âˆ—Î¨âˆ¥op =
sup
Î¶, Î· âˆˆL2 (X; Âµ) âŠ—H
âˆ¥Î¶âˆ¥â‰¤1, âˆ¥Î·âˆ¥â‰¤1
âŸ¨(diag âŠ—IB(H))âˆ—Î¨Î¶,Î·âŸ©
=
sup
Î¶, Î¶ âˆˆL2 (X; Âµ) âŠ—H
âˆ¥Î¶âˆ¥â‰¤1, âˆ¥Î·âˆ¥â‰¤1
Î¨((diag âŠ—IB(H))(Î¶Î·âˆ—))
(B.84)
By the preceding lemma B5.20, this is certainly âˆ¥Î¨âˆ¥op, since we only have to consider Î¶
and Î· of the form 1B âŠ—Ïˆ and 1B âŠ—Î¾ respectively, for Âµ-measurable B âŠ‚X and unit-length
Ïˆ,Î¾ âˆˆH, to get âˆ¥Î¨âˆ¥op. â—»

APPENDIX B. PROPOSITIONS FOR OPTION I
156
Proposition B5.22
The Banach space W(X;Âµ;H) âŠ‚B (L2 (X;Âµ) âŠ—H) deï¬ned in the pre-
ceding proposition is a von Neumann algebra.
Proof
By standard properties of Banach spaces, W(X;Âµ;H) is precisely composed of those
elements that annihilate the kernel of diagâŠ—IB(H); in other words, those Ï† âˆˆB (L2(X;Âµ) âŠ—H)
such that tr Ï•Î± = 0 for any Î± in the kernel. Now take any f âˆˆLâˆ(X;Âµ) and consider the
operator Î³ = diagâˆ—f âŠ—IH. By using singular-value-decomposition (as in the deï¬nition of the
diag map in B5.17) together with approximating each resulting vector by a ï¬nite-tensor-rank
approximation and taking the limit as the approximations become better, it can be shown
that, operating on the left or the right, the kernel is invariant under the action of Î³. Take any
Î² âˆˆS1 (L2(X;Âµ) âŠ—H). By a similar argument, it can be shown that diagâŠ—IB(H)(Î³Î²âˆ’Î²Î³) = 0;
hence,
0 = tr Ï•(Î³Î² âˆ’Î²Î³) = tr Î²(Ï•Î³ âˆ’Î³Ï•)
(B.85)
using the linear and cyclic properties of the trace. Since Î² was arbitrary, it must be that Ï•
commutes with Î³; since f in the deï¬nition of Î³ was arbitrary, Ï• must be in the commutant18
of {diagâˆ—Lâˆ(X;Âµ) âŠ—IH}.
Now suppose Ï• is in the commutant of diagâˆ—Lâˆ(X;Âµ)âŠ—IH. Now we will consider a certain
norm-dense subset of S1 (L2 (X;Âµ) âŠ—H): ï¬rstly note S1 (L2 (X;Âµ)) âŠ—S1 (H) is norm-dense.
Using S1 (L2 (X;Âµ)) âŠ‚S2 (L2 (X;Âµ)) â‰…L2(X Ã— X;Âµ Ã— Âµ), we can consider S1 (L2 (X;Âµ)) as a
space of â€œfunctionsâ€ on X Ã— X. Using Cartesian decomposition and the spectral theorem for
compact operators (or singular value decomposition), truncating the spectral decomposition,
then approximating each of the vectors in L2(X;Âµ)-norm by simple functions, and then
putting everything back together with the proper intersections and relative complements of
subsets of X, the overall eï¬€ect is to get something in the following subset:
A =
â§âªâªâªâ¨âªâªâªâ©
S1 (H)-valued, simple functions with rectangular
subsets A Ã— B for A,B in the ï¬nite, disjoint
collection {C1,...,Cm} of Âµ-measurable subsets of X
â«âªâªâªâ¬âªâªâªâ­
(B.86)
Therefore, the preceding subset is norm-dense.
Now let us consider the subset A0 âŠ‚A which is composed of those S1 (H)-valued, simple
functions that are zero on all the rectangular subsets that include the diagonal; in other
words, those that assign zero to each subset of the form A Ã— A. Then A0 is norm-dense
within the kernel of diag âŠ—IB(H). To see this, take any Î± in the kernel and let âŸ¨ajâŸ©be a
sequence of elements of A converging in norm to it. Each aj can be written as bj + cj, where
bj âˆˆA0 and cj is zero everywhere except for the subsets of the form AÃ—A. It is easy to see that
âˆ¥cjâˆ¥trace = âˆ¥diag âŠ—IB(H)cjâˆ¥. Since Î± is in the kernel, it must be that limjâ†’âˆdiag âŠ—IB(H)cj = 0;
hence, limjâ†’âˆâˆ¥cjâˆ¥trace = 0, so âŸ¨bjâŸ©converges in norm to Î±. Since Î± was arbitrary, A0 is
indeed norm-dense in the kernel.
18The commutant of a subset of an algebra is composed of all elements of the algebra that commute with
the subset.

APPENDIX B. PROPOSITIONS FOR OPTION I
157
Now again take any Î± in the kernel and let âŸ¨bjâŸ©be a sequence of elements of A0 converging
in norm to it. For each j, by the deï¬nition of A, there is some associated ï¬nite, disjoint
collection {Cj
1,...,Cj
mj} of Âµ-measurable subsets of X; take fj to be any function that takes
distinct values on each subset: say fj = âˆ‘
mj
k=1 k 1Cj
k for instance. Then bj can be written as
(diag*fj âŠ—IB(H))dj âˆ’dj (diag*fj âŠ—IB(H))
(B.87)
for a certain, unique dj âˆˆA0. Hence, tr Ï•bj = 0 for every j, so, by continuity, tr Ï•Î± = 0. Since
Î± was arbitrary, Ï• must be in the annihilator of the kernel; hence, it is in W(X;Âµ;H).
The subset diagâˆ—Lâˆ(X;Âµ) âŠ—IH is itself the commutant of the Câˆ—-algebra given by the
closure in norm of diagâˆ—Lâˆ(X;Âµ)âŠ—B(H), which is (since simple â€œfunctionsâ€ are norm-dense
in Lâˆ(X;Âµ)) given by (diag âŠ—IB(H))âˆ—Lâˆ(X;Âµ;B(H)). Since W(X;Âµ;H) is the bicommu-
tant19 of a C*-algebra, it is is a von Neumann algebra by von Neumannâ€™s bicommutant
theorem [110]. â—»
Comment
Using the isometric bijections in B5.20, this induces an algebraic structure on
L1 (X;Âµ;S1(H)). The identity operator in W(X;Âµ;H) corresponds to the linear functional
Î¦ which agrees with the norm on elements in the positive cone L1 (X;Âµ;D(H))+,
Î¦Ï = âˆ«X tr ÏdÂµ
(B.88)
where the trace acts pointwise.
Proposition B5.23
The subspace ker (diag âŠ—IB(H)) is invariant under either left or right
product with elements of W(X;Âµ;H).
Proof
Take any Î± in the kernel, Ï• in W(X;Âµ;H), Âµ-measurable subset E âŠ‚X, and Ïˆ,Ï‡ âˆˆ
H. Then, for PE = diagâˆ—1E the orthogonal projector in B(L2(X;Âµ)) to the subspace of
â€œfunctionsâ€ zero almost everywhere outside of E,
âˆ«EâŸ¨((diag âŠ—IB(H))Î±Ï•)Ïˆ,Ï‡âŸ©dÂµ = tr (PE âŠ—ÏˆÏ‡âˆ—)Î±Ï• = tr Î±â€²Ï• = 0
(B.89)
where Î±â€² = (PE âŠ—ÏˆÏ‡âˆ—)Î± is still in the kernel (as is readily seen by using singular value
decomposition on Î± as in the deï¬nition of diag in B5.17). Since E,Ïˆ,Ï‡ were arbitrary, it
must be that (diagâŠ—IB(H))Î±Ï• = 0; hence, Î±Ï• is still in the kernel. Similarly, using the cyclic
property of the trace,
âˆ«EâŸ¨((diag âŠ—IB(H))Ï•Î±)Ïˆ,Ï‡âŸ©dÂµ = tr (PE âŠ—ÏˆÏ‡âˆ—)Ï•Î± = tr Î±â€²â€²Ï• = 0
(B.90)
where Î±â€²â€² = Î±(PE âŠ—ÏˆÏ‡âˆ—) is still in the kernel. Since E,Ïˆ,Ï‡ were arbitrary, it must be that
(diag âŠ—IB(H))Ï•Î± = 0; hence, Ï•Î± is still in the kernel. â—»
19The bicommutant is the commutant of the commutant.

APPENDIX B. PROPOSITIONS FOR OPTION I
158
Alternate proof
Note W(X;Âµ;H) separates the elements of S1 (L2 (X;Âµ) âŠ—H)/ker (diagâŠ—
IB(H)). To see this, take any Î± âˆˆS1 (L2 (X;Âµ) âŠ—H). Then, by the deï¬nition of Bochner in-
tegrability, (diag âŠ—IB(H))Î± can be arbitrarily well approximated in L1(X;Âµ;S1(H))-norm
by simple, S1(H)-valued functions, âˆ‘j 1BjÏj, where {Bj} is a ï¬nite, disjoint collection of
Âµ-measurable subsets of X. Use singular value decomposition to write each Ïj as UjÎ£jV âˆ—
j ,
where Î£j is a trace-class, diagonal operator in B(â„“2) (or Cdim H if dimH is ï¬nite) and Uj,Vj are
partial isometries from â„“2 (or Cdim H if dimH is ï¬nite) to H. Then, Î² = âˆ‘j(diagâˆ—1Bj)âŠ—VjU âˆ—
j âˆˆ
W(X;Âµ;H) has the property that
tr Î²(diag âŠ—IB(H))âˆ’1 âˆ‘
j
1BjÏj = âˆ¥âˆ‘
j
1BjÏjâˆ¥
(B.91)
Hence, by taking the approximation suï¬ƒciently close, there is some such Î² such that tr Î²Î±
is arbitrarily close to âˆ¥Î±âˆ¥. (Note the Hahn-Banach theorem gives this result more easily, but
it relies on the Axiom of Choice.)
Using this, ker (diag âŠ—IB(H)) can be characterized as
{Î± âˆˆS1 (L2 (X;Âµ) âŠ—H)âˆ£tr Î²Î± = 0 for all Î² âˆˆW(X;Âµ;H)}
(B.92)
Take any Î± âˆˆker (diag âŠ—IB(H)). For any ï¬xed Î² âˆˆW(X;Âµ;H), we then have tr Î³Î²Î± = 0
for all Î³ âˆˆW(X;Âµ;H); hence, Î²Î± âˆˆker (diag âŠ—IB(H)). Also, 0 = tr Î²Î³Î± = tr Î³Î±Î² for all
Î³ âˆˆW(X;Âµ;H); hence, Î±Î² âˆˆker (diag âŠ—IB(H)). â—»
Comment
Now given any bounded, linear map L âˆ¶L1(X;Âµ;D(H))+ â†’L1(Y;Î½;D(J)),
we can extend it to L âˆ¶L1(X;Âµ;S1(H)) â†’L1(Y;Î½;S1(J)) using B5.15. We then have the
following two linear maps:
ËœL âˆ¶S1 (L2 (X;Âµ) âŠ—H)/ker (diag âŠ—IB(H)) â†’S1 (L2 (Y;Î½) âŠ—J)/ker (diag âŠ—IB(J))
(B.93)
ËœLâˆ—âˆ¶W(Y;Î½;J) â†’W(X;Âµ;H)
(B.94)
given by
ËœL = (diagL2(X;Âµ) âŠ—IB(J))âˆ’1 â—‹L â—‹(diagL2(X;Âµ) âŠ—IB(H))
(B.95)
ËœLâˆ—= (diagL2(X;Âµ) âŠ—IB(H))âˆ—â—‹Lâˆ—â—‹(diagL2(X;Âµ) âŠ—IB(J))âˆ’1âˆ—
(B.96)
Proposition B5.24
Given a bounded, completely-positive, linear map L âˆ¶L1(X;Âµ;D(H))+ â†’
L1(Y;Î½;D(J))+, the resulting ËœL, ËœLâˆ—are completely-positive in the sense of Stinespringâ€™s the-
orem [118]:
âˆ‘
i,k
tr Î±âˆ—
kÎ±i ËœL(ÏˆiÏˆâˆ—
k) â‰¥0 â‡â‡’âˆ‘
i,k
âŸ¨ËœLâˆ—(Î±âˆ—
kÎ±i)Ïˆj,ÏˆiâŸ©â‰¥0
for all ï¬nite collections {Î±k} âŠ‚W(Y;Î½;J) and {Ïˆk} âŠ‚L2(X;Âµ) âŠ—H.

APPENDIX B. PROPOSITIONS FOR OPTION I
159
Proof
The two expressions are related by duality, do it is only necessary to prove the left-
hand one. The map ËœL is the composition of completely-positive maps; hence, it is completely-
positive. Therefore, for any ï¬nite whole number n, ËœLâŠ—IMn is completely positive, so for any
Î² âˆˆW(Y;Î½;J âŠ—Cn) and Ï• âˆˆL2(X;Âµ) âŠ—H âŠ—Cn,
tr Î²âˆ—Î²(ËœL âŠ—IMn)(Ï•Ï•âˆ—) â‰¥0
(B.97)
For {ej} an orthonormal basis for Cn, write Î² as âˆ‘n
i,j=1 Î±ijeieâˆ—
j for Î±ij âˆˆW(Y;Î½;J) and Ï• as
âˆ‘n
j=1 Ïˆjej for Ïˆj âˆˆL2(X;Âµ) âŠ—H. Then we have
n
âˆ‘
i,j,k=1
tr âˆ—Î±âˆ—
jkÎ±ji ËœL(ÏˆiÏˆâˆ—
k) â‰¥0
(B.98)
If the Î±ij are chosen to be independent of j, this gives the desired result. â—»
Comment
Following the proof of Stinespringâ€™s theorem, deï¬ne the positive, bilinear form
âŸ¨â‹…,â‹…âŸ©Stinespring on W(Y;Î½;J) âŠ—L2(X;Âµ) âŠ—H by
âŸ¨âˆ‘
j
Î±j âŠ—Ïˆj,âˆ‘
k
Î²k âŠ—Ï•kâŸ©
Stinespring
= âˆ‘
j,k
âŸ¨ËœLâˆ—(Î²âˆ—
kÎ±j)Ïˆj,Ï•kâŸ©= âˆ‘
j,k
tr Î²âˆ—
kÎ±j ËœL(ÏˆjÏ•âˆ—
k)
(B.99)
Let N be the null subspace {Î± âˆˆW(Y;Î½;J) âŠ—L2(X;Âµ) âŠ—Hâˆ£âŸ¨Î±,Î±âŸ©Stinespring = 0}. Take any
Î± âˆˆN and Î² âˆˆW(Y;Î½;J)âŠ—L2(X;Âµ)âŠ—H; by considering âŸ¨Î±+tÎ²,Î±+tÎ²âŸ©Stinespring and âŸ¨Î±+Ä±tÎ²,Î±+
Ä±tÎ²âŸ©Stinespring for small, real t, from the positivity of âŸ¨â‹…,â‹…âŸ©Stinespring, it is evident âŸ¨Î±,Î²âŸ©Stinespring =
0. Then âŸ¨â‹…,â‹…âŸ©Stinespring is an inner product on W(Y;Î½;J) âŠ—L2(X;Âµ) âŠ—H/N; this space can be
completed to give a Hilbert space K.
From the proof of Stinespringâ€™s theorem, N is invariant under the left action of Î² âŠ—
IL2(X;Âµ)âŠ—H for any Î² âˆˆW(Y;Î½;J). This then induces a representation of the von Neumann
algebra, Î¶ âˆ¶W(Y;Î½;J) â†’B(K). The representation is readily seen to be a *-representation20.
Proposition B5.25
The representation Î¶ has operator norm less than or equal to one and
is weak* continuous with pre-adjoint Î¶âˆ—âˆ¶S1(K) â†’S1 (L2 (X;Âµ) âŠ—H)/ker (diagâŠ—IB(H)) being
isometric on the positive cone.
Proof
By the deï¬nition of operator norm and the Cauchy-Schwartz inequality, there is the
well-known formula for the operator norm in B(J) for any Hilbert space M,
âˆ¥Î²âˆ¥op =
sup
x, y âˆˆM
âˆ¥xâˆ¥â‰¤1, âˆ¥yâˆ¥â‰¤1
âŸ¨Î²x,yâŸ©
(B.100)
20A representation Î¶ of a C*-algebra is a *-representation if Î¶(Î±âˆ—) = Î¶(Î±)âˆ—for any Î±.

APPENDIX B. PROPOSITIONS FOR OPTION I
160
Using this and the norm-density of W(Y;Î½;J) âŠ—L2(X;Âµ) âŠ—H/N in K, we have, for any
Î± âˆˆW(Y;Î½;J), âˆ¥Î¶(Î±)âˆ¥op is given by
sup
â§âªâªâ¨âªâªâ©
âŸ¨âˆ‘
j
Î±Î²j âŠ—Ïˆj,âˆ‘
k
Î³k âŠ—Î¾kâŸ©
Stinespring
âˆ£âˆ‘j Î²j âŠ—Ïˆj,âˆ‘k Î³k âŠ—Î¾k âˆˆW(Y;Î½;J) âŠ—L2(X;Âµ) âŠ—H
with unit length using the Stinespring-norm
â«âªâªâ¬âªâªâ­
(B.101)
Absorbing Î± into a redeï¬nition of each Î²j, by the Cauchy-Schwartz inequality, this is less
than or equal to âˆ¥Î±âˆ¥op. Hence, Î¶ has operator-norm less than or equal to one.
To see Î¶ is weak* continuous, take any Î² âˆˆW(Y;Î½;J) and rank-one ÏˆÏ•âˆ—âˆˆS1(K), where
both Ïˆ and Ï• are in the norm-dense subset W(Y;Î½;J) âŠ—L2(X;Âµ) âŠ—H/N. Let Ë†Ïˆ âˆˆÏˆ be
written âˆ‘j Î±j âŠ—Î¾j and Ë†Ï• âˆˆÏ• be written âˆ‘j Î³j âŠ—Î·j. Then
tr Î¶(Î²)ÏˆÏ•âˆ—= âŸ¨Î² âŠ—IL2(X;Âµ)âŠ—H Ë†Ïˆ, Ë†Ï•âŸ©Stinespring = âˆ‘
j,k
âŸ¨ËœLâˆ—(Î³âˆ—
kÎ²Î±j)Î¾j,Î·kâŸ©
= âˆ‘
j,k
tr Î³âˆ—
kÎ²Î±j ËœL(Î¾jÎ·âˆ—
k) = tr Î²Î¶âˆ—(ÏˆÏ•âˆ—)
(B.102)
where Î¶âˆ—(ÏˆÏ•âˆ—) = âˆ‘j,k Î±j ËœL(Î¾jÎ·âˆ—
k)Î³âˆ—
k. Note Î¶âˆ—(ÏˆÏˆâˆ—) is positive since, for any Î² âˆˆW(Y;Î½;J),
âˆ‘
j,k
tr Î²âˆ—Î²Î±j ËœL(Î¾jÎ¾âˆ—
k)Î±âˆ—
k â‰¥0
(B.103)
using the cyclic property of the trace and B5.23. Then,
âˆ¥Î¶âˆ—(ÏˆÏˆâˆ—)âˆ¥= tr Î¶âˆ—(ÏˆÏˆâˆ—) = âˆ¥Ïˆâˆ¥2
(B.104)
Hence, Î¶âˆ—is bounded with operator norm less than or equal to two on rank-one operators
with vectors in W(Y;Î½;J) âŠ—L2(X;Âµ) âŠ—H/N. Using A1.3, by continuity it extends to rank-
one vectors with the same bound. By linearity, it extends to ï¬nite rank operators. Using
the spectral theorem, it is still isometric on the positive cone; hence, it has operator norm
less than or equal to two. By A1.3, it extends to all operators in S1(K) while still being
isometric on the positive cone and with operator norm less than or equal to two. Since
Î¶ = Î¶âˆ—
âˆ—, Î¶âˆ—actually has operator norm less than or equal to one. â—»
Proposition B5.26
There is a Hilbert space M and a partial isometry E âˆ¶K â†’L2 (X;Âµ)âŠ—
HâŠ—M such that the representation Î¶ is given by Î¶(Î±) = Eâˆ—(Î±âŠ—IM)E for any Î± âˆˆW(Y;Î½;J).
The partial isometry E is such that the orthogonal projector EEâˆ—commutes with all {Î±âŠ—IM}.
If all the Hilbert spaces L2 (X;Âµ), H, L2 (Y;Î½), and J have ï¬nite dimension, then M can be
taken to be J âŠ—dimL2 (X;Âµ) âŠ—H.
Proof
From a result by Sakai [109], since Î¶ is a weak*-continuous, *-representation21 by the
preceding proposition, Î¶ is given by the composition of an ampliï¬cation with an induction:
21Termed a Wâˆ—-representation by Sakai.

APPENDIX B. PROPOSITIONS FOR OPTION I
161
there exists a Hilbert space M and a bounded, linear map E âˆ¶K â†’L2 (Y;Î½) âŠ—JM such
that Î¶(Î±) = Eâˆ—(Î± âŠ—IM)E, EEâˆ—is an orthogonal projector commuting with all {Î± âŠ—IM},
EEâˆ—E = E, and Eâˆ—EEâˆ—= Eâˆ—. Then Î¶âˆ—is given by, for any Î² âˆˆS1(K), Î¶âˆ—Î² = tr MEÎ²Eâˆ—,
where tr M is the partial trace over M. Since, by the preceding proposition, Î¶âˆ—is an isometry
on the positive cone, it must be that Eâˆ—E = IK, so E is a partial isometry. Unfortunately,
the proof given by Sakai is non-constructive; the only limitation on the dimension of M is
that it need not be larger than dimK.
If all the Hilbert spaces have ï¬nite dimension, we can be far more concrete in the construc-
tion. Let M = JâŠ—dimL2 (X;Âµ)âŠ—H. Since the Hilbert spaces have ï¬nite dimension, W(Y;Î½;J)
is isomorphic to Lâˆ(Y;Î½) âŠ—B(J), which is isomorphic to the Hilbert space L2 (Y;Î½) âŠ—J âŠ—J
using Lâˆ(Y;Î½) â‰…L2 (Y;Î½) and22 B(J) â‰…J âŠ—J. Then, using this isomorphism, N maps
to a subspace N â€² of the Hilbert space L2 (Y;Î½) âŠ—J âŠ—M.
Also, then K is isomorphic to
L2 (Y;Î½) âŠ—J âŠ—M/N â€² â‰…N â€²âŠ¥with no need for completion. Let E âˆ¶K â†’N â€² be this isomor-
phism. Then the operators Î± âŠ—IL2(X;Âµ)âŠ—H acting on W(Y;Î½;J) âŠ—L2 (X;Âµ) âŠ—H give rise to
a representation Î± âŠ—IM on L2 (Y;Î½) âŠ—J âŠ—M. From the proof to Stinespringâ€™s theorem, N â€²
is invariant under all the {Î± âŠ—IM}, so the orthogonal projector PN â€²âŠ¥commutes with all the
{Î± âŠ—IM}.
Any point in the space L2 (Y;Î½) âŠ—J âŠ—M can be uniquely written as n + m for n âˆˆN â€² and
m âˆˆN â€²âŠ¥. Now put a new inner-product on the space, âŸ¨â‹…,â‹…âŸ©new, deï¬ned by
âŸ¨m + n,mâ€² + nâ€²âŸ©new = âŸ¨Eâˆ’1(m),Eâˆ’1(mâ€²)âŸ©Stinespring + âŸ¨n,nâ€²âŸ©
(B.105)
(This is the step that requires all the spaces to be ï¬niteâ€“the use of ï¬niteness in the preceding
steps is not essential.) With respect to this new inner product, E is a partial isometry. Let
Eâˆ—be the adjoint map with respect to the new inner product. Then the representation Î¶ on
K is provided by, for any k âˆˆK,
Î¶(Î±)(k) = (Eâˆ’1 â—‹PN â€²âŠ¥)(Î± âŠ—IM)E(k) = (Eâˆ—(Î± âŠ—IM)E)(k)
(B.106)
Hence, Î¶(Î±) = Eâˆ—(Î± âŠ—IM)E. â—»
Proposition B5.27
Any completely-positive map L âˆˆCP(L1(X;Âµ;D(H)),L1(Y;Î½;D(J)))
can be expressed as
LÏ = (diagL2(Y;Î½) âŠ—IB(J) âŠ—tr M)V ((diagL2(X;Âµ) âŠ—IB(H))âˆ’1Ï)V âˆ—
for some Hilbert space M and some linear operator V âˆˆB(L2 (X;Âµ) âŠ—H,L2 (Y;Î½) âŠ—J âŠ—M).
If L is an isometry on the positive cone, then V is a partial isometry. If all the Hilbert
spaces L2 (X;Âµ), H, L2 (Y;Î½), and J have ï¬nite dimension, then M can be taken to be
J âŠ—dimL2 (X;Âµ) âŠ—H.
22Using Mn â‰…Cn âŠ—Cn, say by using the Vec operation that stacks columns.

APPENDIX B. PROPOSITIONS FOR OPTION I
162
Proof
By B.16, L extends uniquely to a map in âˆˆCP(L1(X;Âµ;S1(H)),L1(Y;Î½;S1(J)). By
B.24, the resulting ËœLâˆ—(deï¬ned in the comment preceding B.24) is completely-positive in
the sense of Stinespringâ€™s theorem. Also, the von Neumann algebra W(Y;Î½;J) (see B5.21,
B5.22) of course contains the identity. Hence, by Stinespringâ€™s theorem, ËœLâˆ—can be expressed
as, for any Î± âˆˆW(Y;Î½;J), ËœLâˆ—Î± = W âˆ—Î¶(Î±)W for some W âˆˆB(L2 (X;Âµ) âŠ—H,K) (where the
Hilbert space K and the representation Î¶ are deï¬ned in the comment preceding B.25). By
the preceding proposition, Î¶(Î±) = Eâˆ—(Î± âŠ—IM)E for some Hilbert space M and some partial
isometry E âˆ¶K,L2 (Y;Î½) âŠ—J). Also, if all the Hilbert spaces L2 (X;Âµ), H, L2 (Y;Î½), and J
have ï¬nite dimension, then M can be taken to be J âŠ—dimL2 (X;Âµ) âŠ—H.
Let V = EW; then ËœLâˆ—Î± = V âˆ—(Î± âŠ—IM)V , so ËœLÎ² = trM(V Î²V âˆ—) for any Î² âˆˆS1(L2 (X;Âµ) âŠ—
H)/ker (diagL2(X;Âµ) âŠ—IB(H)). (As a check, if Î³ âˆˆker (diagL2(X;Âµ) âŠ—IB(H)), then trM(V Î³V âˆ—) is
indeed in ker (diagL2(Y;Î½) âŠ—IB(J)) by the alternate proof to B5.23 since tr (Î±âŠ—IM)V Î³V âˆ—= 0
for every Î± âˆˆW(Y;Î½;J).) Writing ËœL in terms of L then gives the desired form for L.
If L is isometric on the positive cone, then ËœL is isometric on the positive cone; hence, for
any Î² âˆˆD(L2 (X;Âµ) âŠ—H)+,
tr Î² = tr ËœLÎ² = tr V Î²V âˆ—= tr Î²V âˆ—V
(B.107)
Therefore, it must be that V âˆ—V = IB(L2(X;Âµ)âŠ—H); hence, it is a partial isometry. â—»
Proposition B5.28
Any linear, positive map L âˆˆB(L1(X;Âµ),D(L2(X;Âµ))) satisfying
diag â—‹L = IB(L1(X;Âµ)) has image in the diagonal operators (see B4.3).
Proof
By the deï¬nition of the diagonal extraction map, diag, we have
1B â‹…diagÏ = diag(PBÏPB)
(B.108)
for any Âµ-measurable B âˆˆX with ï¬nite mu-measure, where PB is the orthogonal projector
to the subspace of â€œfunctionsâ€ zero almost everywhere outside B. Take any â€œfunctionâ€ f âˆˆ
L2(X;Âµ). Then,
diag PBL(1âˆ¼Bf)PB = 1B â‹…diag â—‹L(1âˆ¼Bf = 1B1âˆ¼Bf = 0
(B.109)
The operator PBL(1âˆ¼Bf)PB is clearly positive; by the isometry of diag on the positive cone
(see B5.18), it must be the zero operator. Hence, âŸ¨L(1âˆ¼Bf)1C,1CâŸ©= 0 for any Âµ-measurable
C âŠ‚B
Now take any Âµ-measurable, ï¬nite Âµ-measure Bâ€² disjoint from B. By positivity, for any
a âˆˆR,
âŸ¨L(1âˆ¼Bf)(a1C âˆ’1Bâ€²),a1C âˆ’1Bâ€²âŸ©â‰¥0
(B.110)
For this to hold for all a, no matter how large, it must be that
âŸ¨L(1âˆ¼Bf)1C,1Bâ€²âŸ©= âŸ¨L(1âˆ¼Bf)1Bâ€²,1CâŸ©= 0
(B.111)

APPENDIX B. PROPOSITIONS FOR OPTION I
163
Similarly, since Bâ€² âŠ‚âˆ¼B and C is disjoint from âˆ¼B,
âŸ¨L(1Bf)1C,1Bâ€²âŸ©= 0
(B.112)
Then
0 = âŸ¨L(1âˆ¼Bf)1C,1Bâ€²âŸ©+ âŸ¨L(1Bf)1C,1Bâ€²âŸ©= âŸ¨L(f)1C,1Bâ€²âŸ©
(B.113)
Taking C = B, we get âŸ¨L(f)1B,1Bâ€²âŸ©= 0. Since B,Bâ€² were arbitrary, Lf is diagonal. â—»
B.6
Vector measures
Notation
The spaces of ï¬nite-norm, vector measures on the given set with the given Ïƒ-
algebra will be denoted M(X;E;A), M(Y;F;B),.... These are Banach spaces using the
total variation norm (give reference). The subset of these that is atomic will be denoted
A(X;E;A),....
Proposition B6.1
The subset A(X;E;B) is a closed, linear subspace of the Banach space
M(X;E;B) (hence, it is itself a Banach space).
Proof
The subset A(X;E;B) is clearly a linear subspace. To show it is closed, take any
Âµ in the complement of A(X;E;B). Suppose that for any Îµ > 0 there were some countable
collection of atoms {AÎµ
j} âŠ‚E such that âˆ¥Âµ(X âˆ–â‹ƒj AÎµ
j)âˆ¥< Îµ. Then the countable union
B =
â‹ƒ
Îµâˆˆ{1,2âˆ’1,2âˆ’3,...}
â‹ƒ
j
AÎµ
j
(B.114)
would satisfy âˆ¥Âµ(X âˆ–B)âˆ¥= 0, which contradicts Âµ being in the complement. Hence, there
is some Îµ > 0 such that, for any countable collection of atoms {Aj} âŠ‚E, âˆ¥Âµ(X âˆ–â‹ƒj Aj)âˆ¥> Îµ.
Consequently, the distance from Âµ to A(X;E;B) is greater than Îµ. Since Âµ was arbitrary,
the complement of A(X;E;B) is open; hence, A(X;E;B) is closed. â—»
Proposition B6.2
If the Banach spaces A, B, and C are such that A âŠ—B is norm-dense in
C, then A(X;E;A) âŠ—A(Y;F;B) is norm-dense in A(X Ã— Y;G;C), where G = Ïƒ(E Ã— F) is the
Ïƒ-algebra generated by the rectangular subsets E Ã— F.
Proof
The atoms of G are in the rectangular subsets E Ã—F. Therefore, any vector measure
in A(X Ã—Y;G;C) can be arbitrarily well-approximated in norm by vector measures in A(X Ã—
Y;G;C) of the form âˆ‘j cjÎ´Ej Ã—Î´Fj for ï¬nite collections of atoms {Ej} âŠ‚E and {Fj} âŠ‚F and a
ï¬nite collection {cj} âŠ‚C. By assumption, each c âˆˆC can be arbitrarily well-approximated in
norm by elements in AâŠ—B. Hence, A(X;E;A)âŠ—A(Y;F;B) is norm-dense in A(X Ã—Y;G;C).
â—»

164
Appendix C
Propositions for option II
Notation
All topological spaces X,Y,... are compact and Hausdorï¬€.
C(X), C(Y),...
are the spaces of real-valued, continuous functions, which are Banach space employing the
maximum norm. All partitions of unity will be assumed composed of continuous functions.
Hilbert spaces, denoted H, J,... are complete, sesquilinear inner-product spaces, with no
restriction as to their dimension or separability. K(H), K(J),... denote the spaces of com-
pact1, self-adjoint operators on the speciï¬ed Hilbert space; these are Banach spaces using
the operator norm. C(X;K(H)), C(Y;K(J))),... are the spaces of compact-operator-valued,
continuous functions, which are Banach spaces employing the norm given by ï¬rst applying
the operator norm on the operators pointwise, then the maximum norm over the space.
C.1
Real-valued, continuous functions
Comment
The following proposition strengthens the well-known result, which is a special
case of a result by Grothendieck [17], that C(X Ã— Y) = C(X)Ë‡âŠ—C(Y), where Ë‡âŠ—indicates
completion in the injective norm2.
Proposition C1.1
The ï¬nite-nonnegative-tensor-rank3 continuous functions are dense in
the maximum norm topology for positive, continuous functions on X Ã— Y.
Proof
Let f be any positive, continuous function on X Ã— Y and take any Îµ > 0. Since f
is continuous, for each (x,y) âˆˆX there are open subsets U(x,y) âŠ‚X and V(x,y) âŠ‚Y such that
f(U(x,y) Ã— V(x,y)) âŠ‚(f(x,y) âˆ’Îµ
2,f(x,y) + Îµ
2). Since X Ã— Y is necessarily compact, there is a
ï¬nite subcover, {U(x,y)j Ã— V(x,y)j}
n
j=1. For each x âˆˆX, deï¬ne Ux by the intersection over all
1An operator is compact if the image of a bounded sequence necessarily contains a convergent subse-
quence.
2The injective norm on A âŠ—B is the norm induced by its being a subspace of Bilinear(Aâˆ—,Bâˆ—), âˆ¥câˆ¥âˆ¨=
supc(Ï•,Ïˆ), where the supremum is taken over Ï• in the unit ball of Aâˆ—and Ïˆ in the unit ball of Bâˆ—.
3Using only positive real scalars.

APPENDIX C. PROPOSITIONS FOR OPTION II
165
U(x,y)j containing x. Similarly, for each y âˆˆY, deï¬ne Vy by the intersection over all V(x,y)j
containing y. Since X and Y are compact, there are ï¬nite subcovers, {Uxj}
l
j=1 and {Vyj}
m
j=1,
where each Uxi Ã— Vyk is a subset of one of the U(x,y)j Ã— V(x,y)j. Since compact, Hausdorï¬€sets
are normal, there are ï¬nite partitions of unity, {Ï†j}l
j=1 and {Ïˆj}m
j=1, dominated by {Uxj}
l
j=1
and {Vyj}
m
j=1 respectively [58] [103]. Then
l
âˆ‘
i=1
m
âˆ‘
k=1
f(xi,yl)Ï†iÏˆk
(C.1)
is a ï¬nite-nonnegative-tensor-rank continuous function that is everywhere on X Ã— Y within
Îµ of f. â—»
C.2
Maps on real-valued, continuous functions
Corollary C2.1
Positive maps L âˆˆB(C(Y),C(X))+ are completely-positive4.
Proof
Use C1.1 and the positivity of both maps L and IB(C(Z)). â—»
Corollary C2.2
Maps L âˆˆB(C(Z),C(X)) and K âˆˆB(C(W),C(Y)) satisfy (KâŠ—L)âˆ—(ÂµÃ—Î½) =
Kâˆ—Âµ Ã— Lâˆ—Î½ for any Radon measures Âµ on X and Î½ on Y.
Proof
By the preceding proposition, it is suï¬ƒcient to demonstrate that for any ï¬nite
collections {fj} âŠ‚C(Z) and {gj} âŠ‚C(W),
âˆ‘
j âˆ«ZÃ—W fj âŠ—gj d(K âŠ—L)âˆ—(Âµ Ã— Î½) = âˆ‘
j âˆ«ZÃ—W fj âŠ—gj d(Kâˆ—Âµ Ã— Lâˆ—Î½)
(C.2)
but this follows from Tonelliâ€™s theorem [96], which is applicable since Âµ, Î½ are necessarily
ï¬nite measures,
âˆ‘
j âˆ«ZÃ—W fj âŠ—gj d(K âŠ—L)âˆ—(Âµ Ã— Î½) = âˆ‘
j âˆ«XÃ—Y Kfj âŠ—Lgj d(Âµ Ã— Î½) = âˆ‘
j âˆ«X Kfj dÂµâˆ«Y Lgj dÎ½
(C.3)
= âˆ‘
j âˆ«Z fj dKâˆ—Âµâˆ«W gj dLâˆ—Î½ = âˆ‘
j âˆ«ZÃ—W fj âŠ—gj d(Kâˆ—Âµ Ã— Lâˆ—Î½)
â—»
Comment
For any positive map L âˆˆB(C(Y),C(X))+, clearly âˆ¥Lâˆ¥op = âˆ¥L(1Y)âˆ¥max. Hence,
the cone of positive maps is clearly normal.
4A map L is completely-positive if L âŠ—IB(C(Z)) is positive for every Z.

APPENDIX C. PROPOSITIONS FOR OPTION II
166
Proposition C2.3
For any L âˆˆB(C(Y),C(X)), âˆ¥Lâˆ¥op = supxâˆˆX âˆ¥Lâˆ—(Î´x)âˆ¥.
Proof
By deï¬nition of the operator norm,
âˆ¥Lâˆ¥op =
sup
fâˆˆC(Y),âˆ¥fâˆ¥maxâ‰¤1
âˆ¥Lfâˆ¥max = sup
â§âªâªâªâ¨âªâªâªâ©
âˆ£(Lf)(x)âˆ£
RRRRRRRRRRRRRR
f âˆˆC(Y)
âˆ¥fâˆ¥max â‰¤1
x âˆˆX
â«âªâªâªâ¬âªâªâªâ­
(C.4)
= sup
â§âªâªâªâ¨âªâªâªâ©
âˆ£âˆ«X Lf dÎ´xâˆ£
RRRRRRRRRRRRRR
f âˆˆC(Y)
âˆ¥fâˆ¥max â‰¤1
x âˆˆX
â«âªâªâªâ¬âªâªâªâ­
= sup
â§âªâªâªâ¨âªâªâªâ©
âˆ£âˆ«X f dLâˆ—(Î´x)âˆ£
RRRRRRRRRRRRRR
f âˆˆC(Y)
âˆ¥fâˆ¥max â‰¤1
x âˆˆX
â«âªâªâªâ¬âªâªâªâ­
= sup
xâˆˆX
âˆ¥Lâˆ—(Î´x)âˆ¥total variation
â—»
Corollary C2.4
Maps L âˆˆB(C(Z),C(X)) and K âˆˆB(C(W),C(Y)) satisfy âˆ¥K âŠ—Lâˆ¥op =
âˆ¥Kâˆ¥opâˆ¥Lâˆ¥op.
Proof
Using the preceding proposition,
âˆ¥K âŠ—Lâˆ¥op â‰¥
sup
(x,y)âˆˆXÃ—Y
âˆ¥(K âŠ—L)âˆ—(Î´(x,y))âˆ¥total variation
(C.5)
Since Î´(x,y) = Î´x Ã— Î´y, from C2.3, this is equal to
sup
(x,y)âˆˆXÃ—Y
âˆ¥Kâˆ—(Î´x) Ã— Lâˆ—(Î´y)âˆ¥total variation
(C.6)
By B1.5, this is equal to
sup
xâˆˆX
âˆ¥Kâˆ—(Î´x)âˆ¥total
variation
sup
yâˆˆY
âˆ¥Lâˆ—(Î´y)âˆ¥total
variation
(C.7)
which, using the preceding proposition again, is equal to âˆ¥Kâˆ¥opâˆ¥Lâˆ¥op. â—»
Proposition C2.5
B(C(Y),C(X)) is not in general a vector lattice.
Counterexample
Take X = Y = [âˆ’1,1] with the usual topology. Take L âˆˆB(C([âˆ’1,1]))
to be
Lf(x) =
â§âªâªâ¨âªâªâ©
0
if x â‰¤0
f(x) âˆ’f(âˆ’x)
if x > 0
(C.8)
Then L âˆ¨0 should be
(L âˆ¨0)f(x) =
â§âªâªâ¨âªâªâ©
0
if x â‰¤0
f(x)
if x > 0
(C.9)
but this sends some continuous functions to discontinuous ones. â—»

APPENDIX C. PROPOSITIONS FOR OPTION II
167
Proposition C2.6
B(C(Y),C(X)) is not in general directed-complete.
Counterexample
Take X = Y = [âˆ’1,1] with the usual topology. Take Lj âˆˆB(C([0,1]))
to be
Ljf(x) =
â§âªâªâ¨âªâªâ©
0
if x â‰¤0
jâˆšxf(x)
if x > 0
Then supj Lj should be
(L âˆ¨0)f(x) =
â§âªâªâ¨âªâªâ©
0
if x â‰¤0
f(x)
if x > 0
but this sends some continuous functions to discontinuous ones. â—»
Proposition C2.7
For any positive L âˆˆB(C(Y),C(X))+, there is a transition function
Ï„(â‹…âˆ£â‹…) âˆ¶OpenY Ã— X, which is: (i) an additive set function on the open subsets of Y; (ii)
pointwise countably additive on the open subsets of Y; and (iii) lower-semi-continuous for
any ï¬xed open subset O âŠ‚Yâ€“such that
(Lâˆ—Âµ)(O) = âˆ«xâˆˆX Ï„(Oâˆ£x)dÂµ(x)
for any open O âŠ‚Y and Radon measure Âµ on X.
Proof
Let O be any open subset of Y. Then, by the deï¬nition of Radon measures for open
subsets in the proof of the Riesz-Markov theorem [78],
(Lâˆ—Âµ)(O) =
sup
f âˆˆC(Y)
0 â‰¤f â‰¤1O
âˆ«Y f dLâˆ—Âµ =
sup
f âˆˆC(Y)
0 â‰¤f â‰¤1O
âˆ«X Lf dÂµ
=
sup
f âˆˆC(Y)
0 â‰¤f â‰¤1O
âˆ«xâˆˆX (âˆ«xâ€²âˆˆX Lf dÎ´x(xâ€²)) dÂµ(x) =
sup
f âˆˆC(Y)
0 â‰¤f â‰¤1O
âˆ«xâˆˆX (âˆ«Y f d(Lâˆ—Î´x)) dÂµ(x)
(C.10)
Then for any Îµ > 0, there is some continuous f between zero and 1O such that
(Lâˆ—Âµ)(O) > âˆ«xâˆˆX (âˆ«Y f d(Lâˆ—Î´x)) dÂµ(x) âˆ’Îµ
2
(C.11)
Now consider the sequence of continuous functions âŸ¨gjâŸ©, each between zero and 1O, given
by
gj(y) =
â§âªâªâ¨âªâªâ©
1
if dist(y,âˆ¼O) > 2âˆ’j
2j â‹…dist(y,âˆ¼O)
if dist(y,âˆ¼O) â‰¤2âˆ’j
(C.12)

APPENDIX C. PROPOSITIONS FOR OPTION II
168
for j âˆˆZ+ and y âˆˆY. Since Y is compact and metric, f is uniformly continuous [104] [59], so
there is some Î´ such that
f (Ball(y,Î´)) âŠ‚(f(y) âˆ’
Îµ
2âˆ¥Lâˆ¥opÂµ(X),f(y) +
Îµ
2âˆ¥Lâˆ¥opÂµ(X))
(C.13)
for any y âˆˆY.For j suï¬ƒciently large that 2âˆ’j < Î´, then gj is greater than or equal to f
everywhere except for the set {y âˆˆYâˆ£dist(y,âˆ¼O) â‰¤2âˆ’j}, on which it cannot be smaller by
more than
Îµ
22âˆ¥Lâˆ¥opÂµ(X ; hence,
âˆ«xâˆˆX (âˆ«Y f d(Lâˆ—Î´x)) dÂµ(x)âˆ’âˆ«xâˆˆX (âˆ«Y f d(Lâˆ—Î´x)) dÂµ(x) < âˆ«xâˆˆX
Îµ
2âˆ¥Lâˆ¥opÂµ(X (Lâˆ—Î´x)(Y) dÂµ(x) â‰¤Îµ
2
(C.14)
Therefore,
(Lâˆ—Âµ)(O) > âˆ«xâˆˆX (âˆ«Y gj d(Lâˆ—Î´x)) dÂµ(x) âˆ’Îµ
(C.15)
Since Îµ was arbitrary, it must be that
(Lâˆ—Âµ)(O) = lim
jâ†’âˆâˆ«xâˆˆX (lim
jâ†’âˆâˆ«Y gj d(Lâˆ—Î´x)) dÂµ(x)
(C.16)
which is equal to
âˆ«xâˆˆX (lim
jâ†’âˆâˆ«Y gj d(Lâˆ—Î´x)) dÂµ(x)
(C.17)
by the Dominated Convergence theorem [75]. Using the Dominated Convergence theorem
again, we have
(Lâˆ—Âµ)(O) = âˆ«xâˆˆX (âˆ«Y 1O d(Lâˆ—Î´x)) dÂµ(x) = âˆ«xâˆˆX(Lâˆ—Î´x)(O) dÂµ(x)
(C.18)
Also,
(Lâˆ—Î´x)(O) = lim
jâ†’âˆâˆ«Y gj d(Lâˆ—Î´x) = lim
jâ†’âˆ(Lgj)(x)
(C.19)
is measurable by [89] (as the supremum over a sequence of increasing, continuous functions,
it is actually clearly lower-semi-continuous). Hence, Ï„(Oâˆ£x) = (Lâˆ—Î´x)(O) has the desired
properties. â—»
Alternate proof
Let O âŠ‚Y be open. Deï¬ne Ï„(Oâˆ£â‹…) by
Ï„(Oâˆ£x) =
â›
âœâœâœ
â
â‹
f âˆˆC(Y)
0 â‰¤f â‰¤1O
Lf
â
âŸâŸâŸ
â 
(x)
(C.20)

APPENDIX C. PROPOSITIONS FOR OPTION II
169
Then Ï„(Oâˆ£â‹…) is lower-semi-continuous, since, for any a âˆˆR,
Ï„(Oâˆ£â‹…)âˆ’1((a,âˆ)) =
â‹ƒ
f âˆˆC(Y)
0 â‰¤f â‰¤1O
(Lf)âˆ’1((a,âˆ))
(C.21)
which is the union of open sets; hence, it is open. Also, for any Radon measure Âµ, by inner
regularity,
(Lâˆ—Âµ)(O) =
sup
compact KâŠ‚O
(Lâˆ—Âµ)(K)
(C.22)
By Urysohnâ€™s lemma [105], this is equal to
sup
f âˆˆC(Y)
0 â‰¤f â‰¤1O
âˆ«yâˆˆY f(y)d(Lâˆ—Âµ)(y) =
sup
f âˆˆC(Y)
0 â‰¤f â‰¤1O
âˆ«xâˆˆX(Lf)(x)dÂµ(x)
(C.23)
which is less than or equal to âˆ«xâˆˆX Ï„(Oâˆ£x)dÂµ(x), which is less than or equal to
â›
âœâœâœ
â
â‹
f âˆˆC(Y)
0 â‰¤f â‰¤1O
Lâˆ—âˆ—f
â
âŸâŸâŸ
â 
(Âµ)
(C.24)
which exists since dual spaces are necessarily directed-complete. This is in turn less than or
equal to (Lâˆ—Âµ)(O); hence, (Lâˆ—Âµ)(O) = âˆ«xâˆˆX Ï„(Oâˆ£x)dÂµ(x). â—»
The bounded, Borel functions on Y, B(Y), form a Banach space using the supremum
norm. The space B(Y), acting on Radon measures via integration, can be considered a
subspace of the linear functionals C(Y)âˆ—âˆ—. Note the preceding shows Ï„(Oâˆ£x) = (Lâˆ—Î´x)(O)
and that Lâˆ—âˆ—1O = Ï„(Oâˆ£â‹…) is a function in B(X) rather than just a general pseudo-function in
C(X)âˆ—âˆ—[113].
Proposition C2.8
For any positive L âˆˆB(C(Y),C(X))+, if Y is metric there is a transition
function (see A3.1) Ï„(â‹…âˆ£â‹…) âˆ¶BorelY Ã— X such that
(Lâˆ—Âµ)(B) = âˆ«xâˆˆX Ï„(Bâˆ£x)dÂµ(x)
for any Borel subset B âŠ‚Y and ï¬nite Radon measure Âµ on X.
Proof
Note we cannot just immediately begin with Ï„(Bâˆ£x) = LÎ´x(B) for a general Borel
subset B âŠ‚Y because it is not evident that such a construction is measurable in x. Instead,
we must proceed step-by-step in an inductive argument. Following Hausdorï¬€[26], let G0 be
the collection of the open subsets of Y. For each ordinal Î±, let GÎ± be the collection of subsets
of Y that are the countable intersection of subsets from the various collections GÎ² for ordinals

APPENDIX C. PROPOSITIONS FOR OPTION II
170
Î² < Î± if Î± is odd and that are the countable union of subsets from the various collections
GÎ² for ordinals Î² < Î± if Î± is even (where all limit ordinalsâ€“those without a predecessorâ€“are
taken even). For clariï¬cation, using the standard notation [106], G1 = GÎ´, G2 = GÎ´Ïƒ, and so
on for the ï¬nite ordinals.
Fix any ordinal Î± and suppose that for all subsets B in all collections GÎ² for Î² < Î±
we have the following property: there is a Borel measurable Ï„(Bâˆ£â‹…) such that (Lâˆ—Âµ)(B) =
âˆ«xâˆˆX Ï„(Bâˆ£x)dÂµ(x) for any Radon measure Âµ on X.
Take any C âˆˆGÎ±.
If Î± is even, we
have a sequence âŸ¨BjâŸ©of subsets from the various GÎ² with Î² < Î± such that C = â‹ƒj Bj. Let
Ï„(Câˆ£â‹…) = â‹j Ï„(Bjâˆ£â‹…). Then Ï„(Câˆ£â‹…) is measurable (see [89]) and, by the Dominated Convergence
theorem [75], (Lâˆ—Âµ)(C) = âˆ«xâˆˆX Ï„(Câˆ£x)dÂµ(x) for any Radon measure Âµ on X; hence, since C
was arbitrary, GÎ± has the property. Similarly, if Î± is odd, we have a sequence âŸ¨BjâŸ©of subsets
from the various GÎ² with Î² < Î± such that C = â‹‚j Bj. Let Ï„(Câˆ£â‹…) = â‹€j Ï„(Bjâˆ£â‹…). Then Ï„(Câˆ£â‹…)
is measurable and, by the dominated convergence theorem, (Lâˆ—Âµ)(C) = âˆ«xâˆˆX Ï„(Câˆ£x)dÂµ(x)
for any Radon measure Âµ on X; hence, GÎ± also has the property. However, by the above
proposition C2.7, G0 has the property, so by transï¬nite induction [27] [116] all the GÎ± have
the property.
Since Y is metric, its closed subsets are also in G1 = GÎ´ [44]; hence, following Kura-
towski [43], the Borel subsets of Y are in the union â‹ƒÎ± GÎ±. Therefore, the Borel subsets also
have the property. â—»
Comment
The preceding proof does not depend on the axiom of choice since the union
only needs to be taken up to the ordinal number for the minimal uncountable well-ordered
set [26] [43], whose existence does not depend on the axiom of choice [55].
Corollary C2.9
For any positive L âˆˆB(C(Y),C(X))+, if Y is metric then Lâˆ—âˆ—acting on
B(Y) âŠ‚C(Y)âˆ—âˆ—has image in B(X) âŠ‚C(X)âˆ—âˆ—.
Proof
Use the density of simple functions in B(Y) together with the above propositions
C2.8 and A1.3.
C.3
Compact-operator-valued, continuous functions
Proposition C3.1
C(X;K(H)) âŠ—C(Y;K(J)) is norm dense within C(X Ã— Y;K(H âŠ—J)).
Proof
Finite-rank operators are norm-dense among compact operators, so proceed as in
the ï¬rst part of the proof for B4.1. Then following the argument in the proof of C1.1
involving partitions-of-unity gives the desired result. â—»

APPENDIX C. PROPOSITIONS FOR OPTION II
171
C.4
Operator inequalities
Proposition C4.1
For any operators Ï•,Î¾ âˆˆK(H),
âˆ¥âˆ£Ï•âˆ£âˆ’âˆ£Î¾âˆ£âˆ¥op â‰¤
âˆš
âˆ¥Ï• âˆ’Î¾âˆ¥opâˆ¥Ï• + Î¾âˆ¥op
where âˆ£Ï‡âˆ£=
âˆš
Ï‡2.
Proof
By the properties of compact operators, âˆ£Ï•âˆ£âˆ’âˆ£Î¾âˆ£is compact. By the spectral theorem
for compact operators, there is a unit-length Ïˆ âˆˆH which is an eigenvector Ïˆ of âˆ£Ï•âˆ£âˆ’âˆ£Î¾âˆ£and
with corresponding eigenvalue Î» equal to âˆ¥âˆ£Ï•âˆ£âˆ’âˆ£Î¾âˆ£âˆ¥op in magnitude. Then, using the triangle
inequality,
âˆ¥âˆ£Ï•âˆ£âˆ’âˆ£Î¾âˆ£âˆ¥2
op = âˆ£Î»âŸ¨(âˆ£Ï•âˆ£âˆ’âˆ£Î¾âˆ£)Ïˆ,ÏˆâŸ©âˆ£â‰¤âˆ£Î»âŸ¨(âˆ£Ï•âˆ£+ âˆ£Î¾âˆ£)Ïˆ,ÏˆâŸ©âˆ£
(C.25)
= âˆ£1
2 âŸ¨(âˆ£Ï•âˆ£+ âˆ£Î¾âˆ£)(âˆ£Ï•âˆ£âˆ’âˆ£Î¾âˆ£)Ïˆ,ÏˆâŸ©+ 1
2 âŸ¨(âˆ£Ï•âˆ£âˆ’âˆ£Î¾âˆ£)(âˆ£Ï•âˆ£+ âˆ£Î¾âˆ£)Ïˆ,ÏˆâŸ©âˆ£
= âˆ£âŸ¨(Ï•2 âˆ’Î¾2)Ïˆ,ÏˆâŸ©âˆ£â‰¤âˆ¥Ï•2 âˆ’Î¾2âˆ¥op = âˆ¥1
2(Ï• + Î¾)(Ï• âˆ’Î¾) + 1
2(Ï• âˆ’Î¾)(Ï• + Î¾)âˆ¥
op
â‰¤1
2 âˆ¥(Ï• + Î¾)(Ï• âˆ’Î¾)âˆ¥op + 1
2 âˆ¥(Ï• âˆ’Î¾)(Ï• + Î¾)âˆ¥op â‰¤âˆ¥Ï• âˆ’Î¾âˆ¥opâˆ¥Ï• + Î¾âˆ¥op
â—»
The second needed inequality, which involves subsets of direct products of spaces of
operators, is lengthy to state, although it has a very short proof. For real numbers a =
(a1,...,an) in the simplex {x âˆˆ[0,1]Ã—nâˆ£x1 + â‹¯+ xn = 1}, let An(a,H) âŠ‚K(H)Ã—n be the set
â§âªâªâ¨âªâªâ©
(Ï†1,...,Ï†n) âˆˆK(H)Ã—n
RRRRRRRRRRRR
âˆ¥
n
âˆ‘
j=1
ajÏ†jâˆ¥
op
â‰¤1
â«âªâªâ¬âªâªâ­
(C.26)
Let B(B(H)) denote the closed, unit ball (using the operator norm) in B(H). By the triangle
inequality, B(B(H))Ã—n âŠ‚An(a,H) for any allowed choice of a. Now consider the set Cn(Îµ,H) âŠ‚
K(H)Ã—n given by
{(Ï†1,...,Ï†n) âˆˆ{B âˆˆK(H)Ã—n âˆ£max
j<k âˆ¥Ï†j âˆ’Ï†kâˆ¥op â‰¤Îµ}
(C.27)
for Îµ > 0.
Deï¬ne a distance from A âˆˆK(H)Ã—n to a subset F âŠ‚K(H)Ã—n by
dist (A,F) = inf
EâˆˆF max
j
âˆ¥Aj âˆ’Ejâˆ¥op
(C.28)
Using this to deï¬ne a Hausdorï¬€distance between subsets then gives:

APPENDIX C. PROPOSITIONS FOR OPTION II
172
Proposition C4.2
The Hausdorï¬€distance between An(a,H) âˆ©Cn(Îµ,H) and B(B(H))Ã—n âˆ©
Cn(Îµ,H) is bounded by Îµ.
Proof
Take any allowed a and any Ï† âˆˆAn(a,H)âˆ©Cn(Îµ,H). Then, by the triangle inequality,
for any j âˆˆ{1,2,...,n},
âˆ¥Ï†j âˆ’
n
âˆ‘
k=1
akÏ†kâˆ¥
op
â‰¤
n
âˆ‘
k=1
ak âˆ¥Ï†j âˆ’Ï†kâˆ¥op â‰¤Îµ
(C.29)
However, by the deï¬nition of An(a,H), âˆ‘n
k=1 akÏ†k is in B(B(H)). â—»
Note the compactness of the operators was not used in the preceding proof so the proposition
holds for the corresponding subsets of self-adjoint operators in B(H), although we will not
require that generalization.
For the following proposition, let {Aj} be any ï¬nite collection of positive, Hermitian
n Ã— n-matrices and let P be any orthogonal projector.
Proposition C4.3
There is a constant c0, independent of P, n, and r, such that
r
âˆ‘
j=1
âˆ¥Aj âˆ’PAjPâˆ¥trace â‰¤c0
Â¿
Ã
Ã
Ã€(
r
âˆ‘
j=1
tr (Aj âˆ’PAjP))(
r
âˆ‘
j=1
tr Aj)
Proof
Observe that for any a1,...,am âˆˆR âˆ–{0}, the quantity âˆ‘m
j=1
a2
j
xj is minimized over
x1,...,xm âˆˆR+ for ï¬xed âˆ‘m
j=1 xj when for each j, xj = âˆ£ajâˆ£. Now consider the problem of
minimizing the product tr D tr CDâˆ’1Câˆ—over strictly-positive, Hermitian, m Ã— m-matrices
D, given any n Ã— m-matrix C. First take the case of n â‰¥m and Câˆ—C strictly positive. The
minimization over D is the same as minimizing over its eigenvalues, x1,...,xm âˆˆR+, and
eigenvectors, W, with W unitary. For ï¬xed value of W and the trace of D, x1 + â‹¯+ xm,
using the preceding observation, this will occur for
xj = (x1 + â‹¯+ xm)ej
e1 + â‹¯+ em
(C.30)
where ej is the square root of the jth diagonal entry of W âˆ—Câˆ—CW. Then, tr D tr CDâˆ’1Câˆ—=
(e1 + â‹¯+ em)2. Since squaring is monotonic for positive reals and the square root function is
concave, this is minimized over all W when W âˆ—Câˆ—CW is diagonal, so e1+â‹¯+em = tr
âˆš
Câˆ—C.
Therefore, tr D tr CDâˆ’1Câˆ—â‰¥(tr
âˆš
Câˆ—C)
2. By the ability to embed matrices into larger
matrices and the density of invertible matrices, this inequality actually holds for all n Ã— m-
matrices C.
By the triangle inequality,
âˆ¥[ 0
C
Câˆ—
D ]âˆ¥
2
trace
â‰¤(âˆ¥[ 0
C
Câˆ—
0 ]âˆ¥
trace
+ âˆ¥Dâˆ¥trace)
2
= (2tr
âˆš
Câˆ—C + tr D)
2
(C.31)

APPENDIX C. PROPOSITIONS FOR OPTION II
173
By the arithmetic-geometric mean inequality, this is less than or equal to
8(tr
âˆš
Câˆ—C)
2
+ 2(tr D)2 â‰¤8((tr
âˆš
Câˆ—C)
2
+ (tr D)2)
(C.32)
which, by the above result, is less than or equal to
8((tr CDâˆ’1Câˆ—+ tr D)tr D)
(C.33)
For any Hermitian matrix of the form [ B
C
Câˆ—
D ] to be positive, it is necessary (and
suï¬ƒcient) that B âˆ’CDâˆ’1Câˆ—is positive; otherwise, if there were some vector v such that
âŸ¨(B âˆ’CDâˆ’1Câˆ—)v,vâŸ©< 0, then the vector w = [
v
âˆ’Dâˆ’1Câˆ—v ] would give
âŸ¨[ B
C
Câˆ—
D ]w,wâŸ©= âŸ¨(B âˆ’CDâˆ’1Câˆ—)v,vâŸ©+ âŸ¨D [ Dâˆ’1Câˆ—
Im ]w,[ Dâˆ’1Câˆ—
Im ]wâŸ©(C.34)
= âŸ¨(B âˆ’CDâˆ’1Câˆ—)v,vâŸ©< 0
which is a contradiction. Therefore, for any positive, Hermitian matrix of the form [ B
C
Câˆ—
D ]
with D strictly positive,
âˆ¥[ 0
C
Câˆ—
D ]âˆ¥
2
trace
â‰¤8((tr B + tr D)tr D)
(C.35)
By the density of strictly-positive matrices among positive ones, this holds even if D is not
strictly positive. Since any orthogonal projector can be brought into the form where there
are ones along the upper-left diagonal and zeros everywhere else, this proves the case of r = 1,
âˆ¥A âˆ’PAPâˆ¥trace â‰¤c0
âˆš
tr (A âˆ’PAP)tr A
(C.36)
with c0 = 2
âˆš
2.
The case of r > 1 then follows. Take any row vectors a,b,c âŠ‚R+ that are independent
and whose projections to any of the subspace of dimension greater than two using diagonal
projectors are still independent. Then, using Lagrange multipliers, the maximum value of
âˆ‘r
j=1 cjxj over x1,...,xr â‰¥0 for ï¬xed value of the product (âˆ‘r
j=1 ajxj)(âˆ‘r
k=1 bkxk) can only
occur if all but two of the xjâ€™s are zero. Even then, the maximum value can only be attained
for both xjâ€™s nonzero if it is also attained for one of them zero. Since the given conditions on
a,b,c describe a dense subset, then it always the case that the maximizing value is attained
when all the xjâ€™s are zero except for one. Then, since
sup
âˆ‘r
j=1 âˆ¥Aj âˆ’PAjPâˆ¥trace
âˆš
(âˆ‘r
k=1 (tr (Ak âˆ’PAkP)))(âˆ‘r
l=1 tr Al)
(C.37)

APPENDIX C. PROPOSITIONS FOR OPTION II
174
over all P, n, r, and {Aj}, is the same as
sup
âˆ‘r
j=1 xjâˆ¥Aj âˆ’PAjPâˆ¥trace
âˆš
(âˆ‘r
k=1 xk (tr (Ak âˆ’PAkP)))(âˆ‘r
l=1 xltr Al)
(C.38)
over all P, n, r, {xj} âŠ‚R+ âˆª{0}, and {Aj}, it is the same as
sup
âˆ¥A âˆ’PAPâˆ¥trace
âˆš
tr (A âˆ’PAP)tr A
(C.39)
over all P, n, and A, which is bounded by 2
âˆš
2 by the above. â—»
Remark
Apparently c0 = 2 is suï¬ƒcient, since, by numerical calculation, (C.33) can be
replaced by
âˆ¥[ 0
C
Câˆ—
D ]âˆ¥
2
trace
â‰¤4((tr CDâˆ’1Câˆ—+ tr D)tr D)
(C.40)
where the bound is tight since equality is approached as Îµ â†’0+ for D = Îµ
âˆš
Câˆ—C. However,
a proof of this tight bound is lacking.
C.5
Maps on compact-operator-valued, continuous
functions
Proposition C5.1
Any positive map L âˆˆB (C(Y;K(J)),C(X;K(H)))+ satisï¬es
âˆ¥Lâˆ¥op =
sup
f âˆˆC(Y; K(J))+
âˆ¥fâˆ¥â‰¤1
âˆ¥Lfâˆ¥=
sup
ï¬nite-dimensional KâŠ‚J
âˆ¥L(IK1Y)âˆ¥
(C.41)
Proof
From the proof of C3.1, functions of the form âˆ‘j gjÏ†j for ï¬nite collections {Ï†j} âŠ‚
K(J) and partition-of-unity {gj} are norm-dense in C(Y;K(J)). Furthermore, for any Îµ > 0,
it is possible to enforce the constraint that âˆ¥Ï†j âˆ’Ï†kâˆ¥op < Îµ if the support of gj intersects the
support of gk while maintaining the density property.
Then, for any value of Îµ > 0, âˆ¥Lâˆ¥op is equal to
sup
â§âªâªâªâªâªâªâ¨âªâªâªâªâªâªâ©
âˆ¥
n
âˆ‘
j=1
L(Ï†jgj)âˆ¥
RRRRRRRRRRRRRRRRRRR
partition-of-unity {g1,...,gn},
{Ï†j} âŠ‚K(J),âˆ¥Ï†j âˆ’Ï†kâˆ¥op < Îµ
if support gj âˆ©support gk â‰ âˆ…,
âˆ¥âˆ‘n
j=1 Ï†jgjâˆ¥â‰¤1
â«âªâªâªâªâªâªâ¬âªâªâªâªâªâªâ­
(C.42)

APPENDIX C. PROPOSITIONS FOR OPTION II
175
Now consider b(Îµ) given by
sup
â§âªâªâªâªâªâªâ¨âªâªâªâªâªâªâ©
âˆ¥
n
âˆ‘
j=1
L(Ï†jgj)âˆ¥
RRRRRRRRRRRRRRRRRRR
partition-of-unity {g1,...,gn},
{Ï†j} âŠ‚K(J),âˆ¥Ï†j âˆ’Ï†kâˆ¥op < Îµ
if support gj âˆ©support gk â‰ âˆ…,
âˆ¥Ï†jâˆ¥op â‰¤1
â«âªâªâªâªâªâªâ¬âªâªâªâªâªâªâ­
(C.43)
Note b(Îµ) is a decreasing function of Îµ, so its limit as Îµ â†’0+ certainly exists. By C4.2,
b(Îµ) â‰¤âˆ¥Lâˆ¥op â‰¤b(Îµ) + Îµâˆ¥Lâˆ¥op
(C.44)
so
b(Îµ) â‰¤âˆ¥Lâˆ¥op â‰¤b(Îµ)
1 âˆ’Îµ
(C.45)
Hence, âˆ¥Lâˆ¥op is equal to limÎµâ†’0+ b(Îµ).
The additional constraint that all the {Ï†j} are positive can only reduce the supremum
or leave it unchanged. On the other hand, since L is positive
âˆ¥âˆ‘
j
L(gjÏ†j)âˆ¥= sup
xâˆˆX
sup
vâˆˆH,âˆ¥vâˆ¥â‰¤1âˆ‘
j
âŸ¨L(gjÏ†j)(x)v,vâŸ©
(C.46)
is certainly less than
âˆ¥âˆ‘
j
L(gjâˆ£Ï†jâˆ£)âˆ¥= sup
xâˆˆX
sup
vâˆˆH,âˆ¥vâˆ¥â‰¤1âˆ‘
j
âŸ¨L(gjâˆ£Ï†jâˆ£)(x)v,vâŸ©
(C.47)
In addition, examining the constraints on {Ï†j} in (C.43), âˆ¥âˆ£Ï†jâˆ£âˆ¥op = âˆ¥Ï†jâˆ¥op and, by C4.1,
âˆ¥âˆ£Ï†jâˆ£âˆ’âˆ£Ï†kâˆ£âˆ¥op â‰¤
âˆš
âˆ¥Ï†j âˆ’Ï†kâˆ¥op âˆ¥Ï†j + Ï†kâˆ¥op â‰¤âˆšÎµ
âˆš
âˆ¥Ï†j + Ï†kâˆ¥op
(C.48)
By the triangle inequality and the other constraints, this is less than or equal to
âˆš
2Îµ (so
this new condition gives rise to a subset that necessarily includes the previous one), which
can simply be replaced by Îµ since Îµ â†’0. Hence, the additional constraint that all the {Ï†j}
are positive can only reduce the supremum or leave it unchanged. Therefore, it must leave
it unchanged.
However, now starting with sup f âˆˆC(Y; K(J))+
âˆ¥fâˆ¥â‰¤1
âˆ¥Lfâˆ¥and repeating the process would lead
to the same result, so it is only necessary to take the supremum over the positive cone. Finite-
rank operators are norm-dense among compact operators, so it is only necessary to take the
supremum over them. Any collection of ï¬nite-rank operators live collectively on some ï¬nite-
dimensional subspace K âŠ‚J. Since L is positive, the supremum for that particular K then
occurs for the constant function with value IK. â—»

APPENDIX C. PROPOSITIONS FOR OPTION II
176
Proposition C5.2
If L âˆˆB (C(Y;K(J)),C(X;K(H))) is completely bounded, then, for any
compact space Z and any Hilbert space K, âˆ¥L âŠ—Iâˆ¥op â‰¤âˆ¥Lâˆ¥matrix with I the identity map in
B (C(Z;K(K))).
Proof
By the deï¬nition of operator norm and the deï¬nition of the tensor product of maps,
âˆ¥L âŠ—Iâˆ¥op is equal to
sup{âˆ¥(L âŠ—I)fâˆ¥âˆ£ï¬nite-tensor-rank f âˆˆC(Y Ã— Z;K(J âŠ—K)
with âˆ¥fâˆ¥â‰¤1
}
(C.49)
By the preceding proof, this is the same as
lim
Îµâ†’0 sup{âˆ¥
n
âˆ‘
j=1
p
âˆ‘
k=1
m
âˆ‘
l=1
L(Ï†jklgj) âŠ—Ï„jklhkâˆ¥
(C.50)
RRRRRRRRRRRRRRRRRRRRRRRRRRRRR
m âˆˆ{1,2,...},
partition-of-unity {g1,...,gn},partition-of-unity {h1,...,hp},
{Ï†jkl} âŠ‚K(J),{Ï„jkl} âŠ‚K(K),
âˆ¥âˆ‘m
l=1(Ï†jkl âŠ—Ï„jkl âˆ’Ï†jâ€²kâ€²l âŠ—Ï„jâ€²kâ€²l)âˆ¥op < Îµ
if support gj âˆ©support gjâ€² â‰ âˆ…and support hk âˆ©support hkâ€² â‰ âˆ…
âˆ¥âˆ‘m
l=1 Ï†jkl âŠ—Ï„jklâˆ¥op â‰¤1
â«âªâªâªâªâªâªâªâªâªâªâ¬âªâªâªâªâªâªâªâªâªâªâ­
Writing
âˆ¥
n
âˆ‘
j=1
p
âˆ‘
k=1
m
âˆ‘
l=1
L(Ï†jklgj) âŠ—Ï„jklhkâˆ¥
(C.51)
out as
sup
xâˆˆX
sup
zâˆˆZ
âˆ¥
n
âˆ‘
j=1
p
âˆ‘
k=1
m
âˆ‘
l=1
L(Ï†jklgj)(x) âŠ—Ï„jklhk(z)âˆ¥
op
(C.52)
then, since Z is compact, the maximum value is achieved for a certain zâˆ—(which depends on
all the other quantities the supremum is taken over). Incorporating the value of hk(zâˆ—) into
Ï„jkl, then the constraint:
âˆ¥
m
âˆ‘
l=1
Ï†jkl âŠ—Ï„jklâˆ¥
op
â‰¤1
(C.53)
becomes
âˆ¥
m
âˆ‘
l=1
Ï†jkl âŠ—Ï„jklâˆ¥
op
â‰¤hk(zâˆ—)
(C.54)
which implies
p
âˆ‘
k=1
âˆ¥
m
âˆ‘
l=1
Ï†jkl âŠ—Ï„jklâˆ¥
op
â‰¤1
(C.55)

APPENDIX C. PROPOSITIONS FOR OPTION II
177
which by the triangle inequality implies
âˆ¥
p
âˆ‘
k=1
m
âˆ‘
l=1
Ï†jkl âŠ—Ï„jklâˆ¥
op
â‰¤1
(C.56)
Similarly, the constraint:
âˆ¥
m
âˆ‘
l=1
(Ï†jkl âŠ—Ï„jkl âˆ’Ï†jâ€²kâ€²l âŠ—Ï„jâ€²kâ€²l)âˆ¥
op
< Îµ
(C.57)
if support gj âˆ©support gjâ€² â‰ âˆ…and support hk âˆ©support hkâ€² â‰ âˆ…
becomes
âˆ¥
m
âˆ‘
l=1
(Ï†jkl âŠ—Ï„jkl âˆ’Ï†jâ€²kl âŠ—Ï„jâ€²kl)âˆ¥
op
< Îµhk(zâˆ—)
(C.58)
if support gj âˆ©support gjâ€² â‰ âˆ…
which implies
p
âˆ‘
k=1
âˆ¥
m
âˆ‘
l=1
(Ï†jkl âŠ—Ï„jkl âˆ’Ï†jâ€²kl âŠ—Ï„jâ€²kl)âˆ¥
op
< Îµ
(C.59)
if support gj âˆ©support gjâ€² â‰ âˆ…
which, by the triangle inequality, implies
âˆ¥
p
âˆ‘
k=1
m
âˆ‘
l=1
(Ï†jkl âŠ—Ï„jkl âˆ’Ï†jâ€²kl âŠ—Ï„jâ€²kl)âˆ¥
op
< Îµ
(C.60)
if support gj âˆ©support gjâ€² â‰ âˆ…
Using the new Ï„jkl together with the new, weaker constraints can only increase the value
of the supremum. Furthermore, the sums over k and l can now be combined, yielding a
bound to âˆ¥L âŠ—Iâˆ¥op given by
lim
Îµâ†’0 sup
â§âªâªâªâªâªâªâªâªâªâªâ¨âªâªâªâªâªâªâªâªâªâªâ©
âˆ¥
n
âˆ‘
j=1
m
âˆ‘
k=1
L(Ï†jkgj) âŠ—Ï„jkâˆ¥
RRRRRRRRRRRRRRRRRRRRRRRRRRRRR
m âˆˆ{1,2,...},
partition-of-unity {g1,...,gn},
{Ï†jk} âŠ‚K(J),{Ï„jk} âŠ‚K(K),
âˆ¥âˆ‘m
k=1(Ï†jk âŠ—Ï„jk âˆ’Ï†jâ€²k âŠ—Ï„jâ€²kl)âˆ¥op < Îµ
if support gj âˆ©support gjâ€² â‰ âˆ…
âˆ¥âˆ‘m
k=1 Ï†jk âŠ—Ï„jkâˆ¥op â‰¤1
â«âªâªâªâªâªâªâªâªâªâªâ¬âªâªâªâªâªâªâªâªâªâªâ­
(C.61)
Since the ï¬nite-rank operators are norm-dense among the compact operators, this bound
is unchanged by requiring the Ï„jk to be ï¬nite-rank.
However, the ï¬nite-rank operators
collectively live on a ï¬nite-dimensional subspace of K that is isomorphic to CN for some
integer N â‰¤dimK. Incorporating this into the preceding expression for the bound, we have
âˆ¥L âŠ—Iâˆ¥op â‰¤
sup
Nâ‰¤dim K
âˆ¥L âŠ—IMNâˆ¥op
â—»
(C.62)

APPENDIX C. PROPOSITIONS FOR OPTION II
178
Proposition C5.3
If the positive map L âˆˆB (C(Y;K(J)),C(X;K(H)))+, compact space Z,
and Hilbert space K are such that LâŠ—I is positive, for I the identity map in B (C(Z;K(K))),
then âˆ¥L âŠ—Iâˆ¥op = âˆ¥Lâˆ¥op.
Proof
If L âŠ—I is positive, then clearly L âŠ—IMn is positive for every positive integer n less
than or equal to dimK. By the preceding proposition, it is therefore only necessary to show
that if L âŠ—IMn is positive, then âˆ¥L âŠ—IMnâˆ¥op = âˆ¥Lâˆ¥op. However, if L âŠ—IMn is positive, then
by C5.1,
âˆ¥L âŠ—IMnâˆ¥op =
sup
ï¬nite-dimensional LâŠ‚J
âˆ¥(L âŠ—IMn)(ILâŠ—Cn1Y)âˆ¥
(C.63)
=
sup
ï¬nite-dimensional LâŠ‚J
sup
xâˆˆX
âˆ¥L(IL1Y)(x) âŠ—Inâˆ¥op
=
sup
ï¬nite-dimensional LâŠ‚J
sup
xâˆˆX
âˆ¥L(IL1Y)(x)âˆ¥op
which is âˆ¥Lâˆ¥op by C5.1. â—»
Corollary C5.4
The completely-positive maps
B (C(Y;K(J)),C(X;K(H)))cp
are completely bounded.
Corollary C5.5
The cone of completely-positive maps
B (C(Y;K(J)),C(X;K(H)))cp
is normal in either the induced operator norm or the matrix norm.
Proposition C5.6
If L âˆˆB (C(Y;K(J)),C(X;K(H)))cp, then, for any compact space Z
and any Hilbert space K, L âŠ—I is positive, with I the identity map in B (C(Z;K(K))).
Proof
Since L is completely positive, by C5.4 it is completely bounded. Hence, L âŠ—I
exists by C5.2. Furthermore, by C3.1 and A1.3, L âŠ—I is unique, so it is meaningful to
speak of it being positive.
Now suppose there were some compact space Z and some Hilbert space K such that
L âŠ—I were not positive. Then there would be some positive f âˆˆC(Y âŠ—Z;K(J âŠ—K))+ such
that (L âŠ—I)f is not positive.
Since the cone C(X âŠ—Z;K(H âŠ—K))+ is norm-closed and
L âŠ—I is continuous, that implies there is a relatively open neighborhood of f in the cone
C(Y âŠ—Z;K(J âŠ—K))+ whose image under L âŠ—I does not intersect C(X âŠ—Z;K(H âŠ—K))+.
Now approximating f as in the proof of C5.2 as âˆ‘jkl Ï•jkl âŠ—Ï„jkl gj âŠ—hk (but without the
need for any Îµ-constraints), one ï¬nds that for this to occur there must be some n âˆˆ{1,2,...}
for which L âŠ—IMn is not positive; however, that is a contradiction. â—»

APPENDIX C. PROPOSITIONS FOR OPTION II
179
Proposition C5.7
If either dimH or dimJ is ï¬nite and a positive map
L âˆˆB (C(Y;K(J)),C(X;K(H)))+ is such that L âŠ—IMm is positive for m = min{dimH,dimJ},
then L is completely positive.
Proof
Clearly, since L âŠ—IMm is positive, so is L âŠ—IMn for all n < m. Now take n > m.
L âŠ—IMn will be positive if for every f âˆˆC(Y;K(J âŠ—Cn))+, y âˆˆH âŠ—Cn, and x âˆˆX,
âŸ¨((L âŠ—IMn)f)(x)y,yâŸ©â‰¥0
(C.64)
It is enough to show this for f in a dense subset, so f can be restricted to the form âˆ‘j Ï•jgj
for {gj} a partition-of-unity and {Ï•j} a collection of compact operators. By the spectral
theorem for compact operators, it is enough to show this for the Ï•jâ€™s all rank one. Following
the argument of B5.9 then gives the desired result. â—»
Proposition C5.8
The space of completely bounded maps,
CB (C(Y;K(J)),C(X;K(H)))
is a Banach space with respect to the matrix norm.
Proof
Same argument as for B5.10 â—»
Proposition C5.9
The subset of B (C(Y;K(J)),C(X;K(H))) for which the tensor product
with IMn is positive for some ï¬xed n âˆˆ{1,2,...} is closed in the weak topology.
Proof
We will show the complement is open. Take such a map L that is not in the subset.
By the argument in the proof for C5.7 and B5.9, that implies there are some x âˆˆX,
partition-of-unity {gj}, ï¬nite collections of vectors {wjk} âŠ‚J and {vk} âŠ‚H, and Îµ > 0 such
that
m
âˆ‘
j=1
n
âˆ‘
k,l=1
âŸ¨L(wjk âŠ—wâˆ—
jl gj)(x)vl,vkâŸ©< âˆ’Îµ
(C.65)
Then, by the triangle inequality, all the maps in the weak neighborhood
m
â‹‚
j=1
n
â‹‚
k,l=1
N (L;wjkwâˆ—
jk gj;vl âŠ—vâˆ—
l Î´x;
Îµ
2n4m)
(C.66)
+
m
â‹‚
j=1
n
â‹‚
k=1
â‹‚
r<l
N (L;(wjr âŠ—wâˆ—
jl + wjl âŠ—wâˆ—
jr)gj;vk âŠ—vâˆ—
k Î´x;
Îµ
n4m)
+
m
â‹‚
j=1
n
â‹‚
k=1
â‹‚
r<l
N (L;wjk âŠ—wâˆ—
jk gj;(vk âŠ—vâˆ—
m + vm âŠ—vâˆ—
k)Î´x;
Îµ
n4m)
+
m
â‹‚
j=1 â‹‚
k<l
â‹‚
q<r
N (L;(wjk âŠ—wâˆ—
jl + wjl âŠ—wâˆ—
jk)gj;(vq âŠ—vâˆ—
r + vr âŠ—vâˆ—
q)Î´x; 2Îµ
n4m)
will also fail to yield a positive tensor product with IMn. â—»

APPENDIX C. PROPOSITIONS FOR OPTION II
180
Corollary C5.10
The cone of completely positive maps is weakly closed in
B (C(Y;K(J)),C(X;K(H))).
Comment
See the comment following B5.12 concerning the use of the axiom of choice.
Proposition C5.11
For any positive functional Î¦ âˆˆC(X;K(H))âˆ—, there is some D(H)+-
valued, Radon vector measure Âµ such that
Î¦f = âˆ«X fdÂµ
Proof
Since K(H)âˆ—â‰…D(H), there is some Ï âˆˆD(H)+ such that Î¦(Ï†1X) = tr ÏÏ† for any
Ï† âˆˆK(H). Since ï¬nite rank operators are dense in compact ones, Ï lives on a separable
subspace of H; let {ej} be an orthonormal basis for this subspace and âŸ¨PjâŸ©an increasing
sequence of projectors onto the subspaces spanned by the ï¬rst j basis vectors. Applying the
Riesz-Markov theorem entry-wise, there is a sequence of Radon vector measures, âŸ¨ÂµjâŸ©, with
each Âµj taking values in D(PjH)+. Take j > k; then âˆ¥Âµj âˆ’Âµkâˆ¥is given by
sup
â§âªâªâªâ¨âªâªâªâ©
r
âˆ‘
l=1
âˆ¥Âµj(El) âˆ’Âµk(El)âˆ¥trace
RRRRRRRRRRRRRR
r âˆˆ{1,2,...},disjoint, Borel
subsets {E1,...,En}
with â‹ƒr
l=1 El = X
â«âªâªâªâ¬âªâªâªâ­
(C.67)
Applying C4.3, âˆ‘r
l=1 âˆ¥Âµj(El) âˆ’Âµk(El)âˆ¥trace is less than or equal to
c0
Â¿
Ã
Ã
Ã€(
r
âˆ‘
l=1
tr (Âµj(El) âˆ’Âµk(El)))(
r
âˆ‘
l=1
tr Âµj(El))
(C.68)
= c0
âˆš
tr (Âµj(X) âˆ’Âµk(X))tr Âµj(X)
which is less than or equal to c0
âˆš
tr (Ï âˆ’Âµk(X))tr Ï. This goes to zero as k â†’âˆsince
the Âµk(X)â€™s are truncations of Ï, which converge to Ï in trace norm, which can be seen
either by using C4.3 again or by ï¬rst demonstrating that the truncations converge in norm
for rank-one Ï (which is readily shown); by the spectral theorem for compact operators,
the truncations converge in trace norm for every Ï. Therefore, âŸ¨ÂµjâŸ©is a Cauchy sequence.
Since D(H)+-valued vector measures are complete with the given norm [108], the limit is the
desired Âµ. â—»
For the following proposition, restrict the Hilbert space H to be separable. Then there is
some Ï âˆˆD(H)+ that is strictly positive. Let {ej} be an orthonormal basis for H composed
of eigenvectors of Ï, with eigenvalues Î»j in decreasing order. For any Radon measure Âµ on
X, by the preceding proposition there is the induced variation measure Î½ = âˆ£Lâˆ—(Ï1XÂµ)âˆ£on
Y, which is also Radon [108]. Then we have the following result:

APPENDIX C. PROPOSITIONS FOR OPTION II
181
Proposition C5.12
For any positive L âˆˆB (C(Y;K(J)),C(X;K(H)))+, the adjoint map
Lâˆ—induces a map K that sends L1(X;Âµ;D(H))+ into L1(Y;Î½;D(J))+.
Proof
Let C âŠ‚Y be any closed, Î½-null subset. By outer-regularity, there are open sets
containing C with arbitrarily small Î½-measure. Therefore, by Urysohnâ€™s lemma [105],
0 = Î½(A) =
inf
fâˆˆC(Y),1X â‰¥fâ‰¥1C âˆ«Y f dÎ½
(C.69)
Hence, by the deï¬nition of Î½, for any Ï† âˆˆK(J)+,
0 =
inf
fâˆˆC(Y),1Yâ‰¥fâ‰¥1C âˆ«xâˆˆX tr ÏL(Ï†f)(x)dÂµ(x)
(C.70)
For A any Borel subset of X and Ï„ any positive, self-adjoint operator on the span of ï¬nitely
many of the {ej}, any single-term simple function, Ï„1A, can be scaled to be less than Ï1X.
Then
0 =
inf
fâˆˆC(Y),1Yâ‰¥fâ‰¥1C âˆ«xâˆˆX 1A(x)tr Ï„L(Ï†f)(x)dÂµ(x)
(C.71)
Now take {Ï„j} and {Aj} to be ï¬nite collections of such operators and subsets. For allowed
f1,...,fn, the pointwise product f1â‹¯fn is also allowed and is less than or equal to each of
the fj; hence,
inf
fâˆˆC(Y),1Yâ‰¥fâ‰¥1C
n
âˆ‘
j=1âˆ«xâˆˆX 1Aj(x)tr Ï„jL(Ï†f)(x)dÂµ(x)
(C.72)
=
n
âˆ‘
j=1
inf
fâˆˆC(Y),1X â‰¥fâ‰¥1C âˆ«xâˆˆX 1Aj(x)tr Ï„jL(Ï†f)(x)dÂµ(x) = 0
Since simple functions of the form âˆ‘n
j=1 Ï„j 1Aj are dense in L1(X;Âµ;D(H))+, then for any
element Î¾ âˆˆL1(X;Âµ;D(H))+,
0 =
inf
fâˆˆC(Y),1Yâ‰¥fâ‰¥1C âˆ«xâˆˆX tr Î¾(x)L(Ï†f)(x)dÂµ(x) =
inf
fâˆˆC(Y),1Yâ‰¥fâ‰¥1C âˆ«Y f d(Ï†Lâˆ—(Î¾Âµ))
(C.73)
where Ï†Lâˆ—(Î¾Âµ) is a Radon measure. Therefore, it must be that (Ï†Lâˆ—(Î¾Âµ))(C) = 0. Since Ï†
was arbitrary, Lâˆ—(Î¾Âµ)(C) must be zero.
By inner regularity, any Borel set can have its measure approximated arbitrarily well by
closed sets it contains. Therefore, for any Î½-null, Borel subset A, Lâˆ—(Î¾Âµ)(A) is also zero.
Therefore, Lâˆ—(Î¾Âµ) is absolutely continuous with respect to Î½. Since D(H) has the Radon-
NikodÂ´ym property [18], there is a Ïˆ âˆˆL1(Y;Î½;D(J))+ such that Lâˆ—Âµ = ÏˆÎ½, which gives the
desired map K by KÎ¾ = Ïˆ. â—»

