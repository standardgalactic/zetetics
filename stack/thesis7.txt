Quantum Bayesian networks with application to games displaying Parrondo’s
paradox
by
Michael Pejic
A dissertation submitted in partial satisfaction of the
requirements for the degree of
Doctor of Philosophy
in
Mathematics
in the
Graduate Division
of the
University of California, Berkeley
Committee in charge:
Professor F. Alberto Gr¨unbaum, Chair
Professor Nicolai Reshetikhin
Professor Umesh Vazirani
Fall 2014

Quantum Bayesian networks with application to games displaying Parrondo’s
paradox
Copyright 2014
by
Michael Pejic

1
Abstract
Quantum Bayesian networks with application to games displaying Parrondo’s paradox
by
Michael Pejic
Doctor of Philosophy in Mathematics
University of California, Berkeley
Professor F. Alberto Gr¨unbaum, Chair
Bayesian networks and their accompanying graphical models are widely used for prediction
and analysis across many disciplines. We will reformulate these in terms of linear maps. This
reformulation will suggest a natural extension, which we will show is equivalent to standard
textbook quantum mechanics. Therefore, this extension will be termed quantum. However,
the term quantum should not be taken to imply this extension is necessarily only of utility in
situations traditionally thought of as in the domain of quantum mechanics. In principle, it
may be employed in any modeling situation, say forecasting the weather or the stock market–
it is up to experiment to determine if this extension is useful in practice. Even restricting
to the domain of quantum mechanics, with this new formulation the advantages of Bayesian
networks can be maintained for models incorporating quantum and mixed classical-quantum
behavior. The use of these will be illustrated by various basic examples.
Parrondo’s paradox refers to the situation where two, multi-round games with a ﬁxed
winning criteria, both with probability greater than one-half for one player to win, are
combined. Using a possibly biased coin to determine the rule to employ for each round,
paradoxically, the previously losing player now wins the combined game with probability
greater than one-half. Using the extended Bayesian networks, we will formulate and analyze
classical observed, classical hidden, and quantum versions of a game that displays this para-
dox, ﬁnding bounds for the discrepancy from naive expectations for the occurrence of the
paradox. A quantum paradox inspired by Parrondo’s paradox will also be analyzed. We will
prove a bound for the discrepancy from naive expectations for this paradox as well. Games
involving quantum walks that achieve this bound will be presented.

i
To my parents.

ii
Contents
Contents
ii
List of Figures
iv
1
Introduction
1
I
Quantum Bayesian networks
5
2
Bayesian networks-graphical models
6
2.1
Graphical models as the form in which information is presented . . . . . . . . .
6
2.2
Transition probability functions . . . . . . . . . . . . . . . . . . . . . . . . . . . .
10
2.3
Graphical models as constraints . . . . . . . . . . . . . . . . . . . . . . . . . . . .
12
2.4
Directed graphical models as tensor networks . . . . . . . . . . . . . . . . . . . .
14
2.5
The Copy map and restriction maps . . . . . . . . . . . . . . . . . . . . . . . . .
15
2.6
Determinism
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
15
3
Hidden classic and quantum nodes
17
3.1
Principles of linearity and potential universality . . . . . . . . . . . . . . . . . .
17
3.2
Options I and II . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
20
3.3
Quantum nodes . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
24
3.4
No quantum copying . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
26
3.5
Embedding quantum models into classical ones . . . . . . . . . . . . . . . . . . .
30
3.6
Embedding classical models into quantum ones . . . . . . . . . . . . . . . . . . .
36
3.7
Classical physics . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
37
3.8
Additional structures for Bayesian networks? . . . . . . . . . . . . . . . . . . . .
38
4
Constructing the networks
40
4.1
Graphical constructs and rules . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
40
4.2
Data for the structures using Option I’ . . . . . . . . . . . . . . . . . . . . . . . .
41
4.3
Data for the structures using Option II
. . . . . . . . . . . . . . . . . . . . . . .
42
4.4
Example-double-slit experiment . . . . . . . . . . . . . . . . . . . . . . . . . . . .
43
4.5
Quantum model
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
44

iii
4.6
The Bayesian network approach versus the standard textbook approach . . . .
46
4.7
Classical hidden model
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
47
4.8
What is a quantum system? . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
49
5
Relation to textbook quantum mechanics
50
5.1
Textbook rules for quantum mechanics . . . . . . . . . . . . . . . . . . . . . . . .
50
5.2
Weak measurements . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
53
5.3
Comparison of Bayesian networks to quantum circuits and tensor networks . .
56
6
Further examples
58
6.1
No-cloning–classical and quantum . . . . . . . . . . . . . . . . . . . . . . . . . . .
58
6.2
Teleportation-classical and quantum . . . . . . . . . . . . . . . . . . . . . . . . .
59
6.3
Bell’s inequality for Bayesian networks without metaphysical limitations
. . .
62
II Parrondo’s paradox and a Parrondo-like paradox
66
7
Parrondo’s paradox
67
7.1
Deﬁning the paradox
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
67
7.2
Classical observed Markov chain game . . . . . . . . . . . . . . . . . . . . . . . .
68
7.3
Classical hidden-Markov chain game . . . . . . . . . . . . . . . . . . . . . . . . .
72
7.4
Deﬁning a quantum analogue of the Markov model . . . . . . . . . . . . . . . .
77
7.5
Parrondo’s paradox for the quantum game
. . . . . . . . . . . . . . . . . . . . .
82
7.6
Summary of results
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
85
8
A Parrondo-like paradox for an one-round game
88
8.1
Deﬁning the game . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
88
8.2
Deﬁning geodesics on the space of wavefunctions . . . . . . . . . . . . . . . . . .
89
8.3
Bounds on the extent of the Parrondo-like paradox . . . . . . . . . . . . . . . .
91
8.4
Conditions for the occurrence of the Parrondo-like paradox
. . . . . . . . . . .
94
9
Quantum walks and the Parrondo-like paradox
97
9.1
Classical random and classical hidden walks . . . . . . . . . . . . . . . . . . . . .
97
9.2
Quantum walks . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 101
9.3
The Parrondo-like paradox for quantum walks . . . . . . . . . . . . . . . . . . . 106
Bibliography
111
A General propositions
118
A.1 Banach space propositions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 118
A.2 Hilbert space propositions
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 119
A.3 Transition function propositions . . . . . . . . . . . . . . . . . . . . . . . . . . . . 120

iv
B Propositions for option I
131
B.1 Measures . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 131
B.2 Maps on subspaces of the space of measures . . . . . . . . . . . . . . . . . . . . . 135
B.3 L1-spaces
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 142
B.4 Density-matrix-valued L1-spaces . . . . . . . . . . . . . . . . . . . . . . . . . . . . 142
B.5 Maps on density-matrix-valued L1-spaces . . . . . . . . . . . . . . . . . . . . . . 144
B.6 Vector measures
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 163
C Propositions for option II
164
C.1 Real-valued, continuous functions . . . . . . . . . . . . . . . . . . . . . . . . . . . 164
C.2 Maps on real-valued, continuous functions . . . . . . . . . . . . . . . . . . . . . . 165
C.3 Compact-operator-valued, continuous functions . . . . . . . . . . . . . . . . . . . 170
C.4 Operator inequalities
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 171
C.5 Maps on compact-operator-valued, continuous functions . . . . . . . . . . . . . 174
List of Figures
1.1
Traditional conception of the relation of physics to Bayesian networks. . . . . . . .
3
1.2
Proposed relation of physics to Bayesian networks. . . . . . . . . . . . . . . . . . . .
3
7.1
Minimum achievable values of P comb
A
for p = 0.5 for the two-state, classical hidden
game. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
86
7.2
Minimum achievable values of P comb
A
for p = 0.1 for the two-state, classical hidden
game. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
86
7.3
Minimum achievable values of P comb
A
for p = 0.5 for the two-dimensional, quantum
game. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
87
7.4
Minimum achievable values of P comb
A
for p = 0.1 for the two-dimensional, quantum
game. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
87

v
Acknowledgments
Michael Pejic acknowledges support from the Applied Math. Sciences subprogram of the
Oﬃce of Energy Research, US Department of Energy, under Contract DE-AC03-76SF00098,
and from AFOSR grant FA95501210087 through a subcontract to Carnegie Mellon Univer-
sity.

1
Chapter 1
Introduction
Outline of the work
Bayesian networks and graphical models are useful for classical systems because they are
much more intuitive than a list of conditional dependencies. It is also sometimes useful to
introduce additional, hypothesized nodes to break complicated dependencies into simpler,
potentially universal modules.
Usually these are treated just as observable nodes which
are always hidden; however, this imposes constraints that are metaphysical in origin and
raises diﬃculties of interpretation. We will give an alternate approach using linear maps
on measures, with additional constructions to those generally utilized in graphical models,
that resolves those issues. While, in certain situations, this introduces additional maps, not
previously available, these new maps are not only in and of themselves of limited interest,
but also introduce undesired complications. However, what is extremely fruitful is simply the
conceptual leap. Thinking in terms of linear maps on spaces of measures immediately raises
the question of looking at linear maps on other spaces. This approach leads to a natural ex-
tension, which we will prove is equivalent to standard, textbook quantum mechanics (which
is infamous for its apparently unmotivated and incomprehensible formulation). Therefore,
this extension will be termed quantum. To avoid being swept away by a ﬂood of details,
propositions of a more general nature, together with their proofs, needed to show the sensi-
bility and consistency of the extension and its equivalence to quantum mechanics are placed
in appendices.
However, the term quantum should not be taken to imply this extension is necessarily
only of utility in situations traditionally thought of as in the domain of quantum mechanics.
In principle, it may be employed in any modeling situation, say forecasting weather or
stock prices–it is up to experiment to determine if this extension is useful in practice. In
particular, there is no reason for ̷h to necessarily enter into these models if they are outside
the realm of physics. Even restricting to the traditional domain of quantum mechanics, with
this new formulation the advantages of Bayesian networks can be maintained for models
incorporating quantum and mixed classical-quantum behavior.
The use of these will be
illustrated by various examples.
In particular, we will show that some of the supposed

CHAPTER 1. INTRODUCTION
2
hallmarks of quantum mechanics, no-cloning and teleportation, apply for classical hidden
systems as well.
In the second part, we will utilize these extended Bayesian networks in the study of
various games displaying Parrondo’s paradox–the phenomenon of two games each winning
for one player with probability greater than one-half, yet their convex combination (in a
sense to be speciﬁed) paradoxically winning for the previously losing player with probability
greater than one-half. We will prove bounds for the discrepancy from naive expectations for
classical versions of a game; those bounds will then be shown to be broken by a quantum
analogue of the game. [31]
A quantum paradox inspired by Parrondo’s paradox will also be analyzed. We will prove
a bound for the discrepancy from naive expectations for this paradox. Games involving
quantum walks that achieve this bound will be presented.
Philosophical interlude–rejection of metaphysics
For a man will attain unto nothing more perfect than to be found to be most
learned in the ignorance which is distinctly his. The more he knows that he is
unknowing, the more learned he will be.–Nicholas of Cusa [33]
Natural scientists may adopt whatever attitude they please; they are still under
the domination of philosophy.–F. Engels [24]
Physicists generally pretend to ignore philosophy, but since physics (unlike mathematics)
deals with knowledge of external reality, it is not possible to avoid epistemology. A commonly
expressed (although often unacknowledged) philosophy is that of naive realism: While other
sciences have to deal with human-created concepts, physics is a “god’s-eye view” of reality as
it really is. This is presented pictorially in Figure 1.1. However, there are several problems
with this: (i) it does not agree with what physicists actually do in practice [12] [11]; (ii)
it needlessly encumbers physics with many questions that are metaphysical in nature–the
direction of time, the reason for existence of nature, the collapse of the wavefunction, and
so on; and, most importantly for our work in this dissertation, (iii) it makes it seem as if
quantum is a kind of physics with no connection to modeling.
The philosophy we employ in this work is one with a long-standing pedigree [123]: We
know nothing about reality as it really is; hence, external truths are necessarily tentative
and model-dependent. This is presented pictorially in Figure 1.2. This credo was widely
disseminated by Pragmatists in the late nineteenth century who were inﬂuenced by the
methodology of science [122] [60] [67] [34] [35], and it has continued to be advocated by
philosophers of science in the century since [46] [36] [68] [32] [71] [45] [3] [4]. The beneﬁt
of this philosophy is that not only does it resolve the ﬁrst two questions raised above, but,
most pertinent to this present work, it shows quantum is actually a sort of model. Quantum
mechanics is then the overlap of physics with this class of models.

CHAPTER 1. INTRODUCTION
3
Bayesian
networks
physics
classical
quantum
science apart
from physics
Figure 1.1: Traditional conception of the relation of physics to Bayesian networks.
Bayesian networks
physics
science
traditional
non-traditional
classical
quantum
novel?
Figure 1.2: Proposed relation of physics to Bayesian networks.

CHAPTER 1. INTRODUCTION
4
There is no reason to believe reality is doing calculations at all similar to the ones we
employ in our hypothesized models1 or even that it is doing calculations at all. In particular
there is the issue of contextuality–we want to employ potentially universal modules in our
models since only they have predictive ability in novel situations, but perhaps reality is
fundamentally contextual2.
Constraints imposed on our models
In keeping with the expressed philosophy, no metaphysical constraints arising from claims
to know what is “really going on” will be placed upon the mathematical operations and
constructs that can be employed in the models. Rather, there are only three rules that will
be enforced. Firstly, the quantities calculated by the mathematical models must be inter-
pretable as probabilities; in particular, they must be positive3. Secondly, the mathematical
models must be composed of linear maps (which we will show is the weakening of a principle
already in wide use, if not always acknowledged). Thirdly, the mathematical models must
be composed of potentially universal modules (in a manner that we will precisely deﬁne).
Of course, the particular model employed in a particular situation may fail to be universal
when actually employed in a diﬀerent context; the point is that this failure should be as a
result of experiment and not be preordained as result of our choice of mathematics employed
in modeling.
These constraints are extremely restrictive. For maps to be linear, they must clearly
live on linear spaces. Furthermore, the constraints also impose strong restrictions on the
linear spaces these maps live on.
Thus far, we are only aware of three classes of linear
spaces that meet the imposed restrictions: (i) certain subspaces of measures; (ii) density
matrices on complex Hilbert spaces ; and (iii) tensor products of these. The former gives
what is traditionally thought of as classical behavior and we will prove the latter two give
behavior that has traditionally been taken the domain of quantum mechanics. However,
since we do not start from quantum mechanics, but instead only from the above principles,
models involving maps on density matrices may be found to be of utility in situations not
traditionally thought of as related to quantum mechanics.
1Human mathematics is an abstraction from our experiences as embodied beings [45]–perhaps reality
uses a form of mathematics that cannot be conceived of in this manner.
2Gravity–a long-range force that cannot be screened–is a clue that this may indeed be the case. Isolated
subsystems are only possible since gravity is so weak it can be generally ignored.
3To aid readability, positive is used instead of nonnegative throughout. Wherever strict positivity is
required, the word strict will be added.

5
Part I
Quantum Bayesian networks

6
Chapter 2
Bayesian networks-graphical models
2.1
Graphical models as the form in which
information is presented
There are many ways to present joint probability in terms of other quantities and mathe-
matical constructs. Graphical models [37] are a useful way to sort through what otherwise
can seem hopelessly complicated in the usual notation. For instance, suppose we are given
a probability space (Ω,E,π), with Ωa set, E a σ-algebra 1 of subsets of Ω, and π ∶E →R
a probability measure.
Furthermore suppose we have two generalized random variables,
X ∶Ω→X and Y ∶Ω→Y for sets X and Y. Then, for any A ∈X(E) and B ∈Y (E),
the joint probability Prob(X ∈A and Y ∈B) is π (X−1(A) ∩Y −1(B)). The graphical model
corresponding to presenting the joint probability in this manner–namely by giving (Ω, E, π,
X, X, Y, Y )–is
m
m
m
X
Ω
Y



/




S
S
SSw
S
S
SS
(2.1)
where the double arrows stand for deterministic causation.
The resulting joint probability determines a probability space (X × Y,F,ρ) with the
probability measure ρ given on rectangular subsets by ρ(A × B) = π (X−1(A) ∪Y −1(B)),
which can be readily extended to a probability measure for the σ-algebra F = (X × Y)(E).
The graphical model corresponding to presenting the joint probability in this manner–namely
1A σ-algebra is a collection of subsets of a set X, including both ∅and X, that is closed under relative
complementation and countable unions.

CHAPTER 2. BAYESIAN NETWORKS-GRAPHICAL MODELS
7
by giving (X × Y, F, ρ)–is
m
m
X
Y
(2.2)
For each B ∈Y (E), the probability for X determines a probability space (X,G,µB)
with σ-algebra G = X(E) and with probability measure µB given by µB(A) = ρ(A × B) =
π(X−1(A) ∪Y −1(B)) = Prob(X ∈A and Y ∈B). The marginal probability for X is then
given by µ = µY. Let G × Y signify the σ-algebra of all rectangular sets of the form A × Y
for A ∈G. Since µ is a ﬁnite measure (hence, σ-ﬁnite2) and µB is absolutely continuous3
with respect to µ, by the Radon-Nikod´ym theorem [72], the measures {µB} determine the
conditional probability (shown in two common notations) τ(B∣G × Y)(x) or τ(B∣x) as the
Radon-Nikod´ym derivative dµB
dµ (x).
The Radon-Nikod´ym derivative dµB
dµ (x) is actually an equivalence class of functions4. Let
L0(X;µ) denote the space of equivalence classes of µ-measurable functions5 that diﬀer on µ-
null subsets. As usual, for p ∈[0,∞), let Lp(X;µ) be the space of “functions” f in L0(X;µ)
such that ∫X ∣f∣p dµ is ﬁnite (the value of the integral is independent of the representative
function in the equivalence class). For p ∈[1,∞), these are Banach spaces for the usual norm
∥f∥=
p
√
∫X ∣f∣p dµ
(2.3)
Furthermore, let L∞(X;µ) be the space of “functions” f in L0(X;µ) that are essentially
bounded6 in magnitude. This is a Banach space with the norm ∥f∥being the least essential
bound on ∣f∣. Then dµB
dµ = τ(B∣x) is actually a “function” in L1(X;µ) ∩L∞(X;µ). This
space is clearly isometrically isomorphic to L1(X × Y;ρ∣G×Y) ∩L∞(X × Y;ρ∣G×Y), which is
emphasized by the notation τ(B∣G × Y)(x).
Let H be the σ-algebra Y (E). For any disjoint, countable collection {Bj} ⊂H,
µ⋃j Bj = ρ(⋅× ⋃
j
Bj) = ∑
j
ρ(⋅× Bj) = ∑
j
µBj
(2.4)
2A measure µ on set X is σ-ﬁnite if there are a countable collection of µ-measurable subsets {Bj} such
that ⋃j Bj = X with each µ(Bj) ﬁnite.
3For measure spaces (X,E,mu) and (X,E,nu), ν is absolutely continuous with respect to µ if µ(A) = 0
implies ν(A) = 0 for all subsets A ∈E.
4By abuse of nomenclature it is by convention termed a “function”–we will maintain the quotes for this
latter case since we need to maintain the distinction.
5For a given measure space (X,E,µ), let E0 be the σ-algebra given by the completion of E with respect to
µ (see [73]). The extension of µ to E0 will still be denoted µ. Then we will say µ is a F-measure if F is a sub-
σ-algebra of E0. An element of E0 will be termed µ-measurable. A function f ∶X →R ∪{∞,−∞,undeﬁned}
is µ-measurable if it takes the later three values only on a µ-null subset and is elsewhere measurable with
respect to E0 in the usual sense.
6Bounded on all but a µ-null subset

CHAPTER 2. BAYESIAN NETWORKS-GRAPHICAL MODELS
8
with convergence in norm. Since ∥dµB
dµ ∥
L1(X;µ)
= ∥µB∥,
τ (⋃
j
Bj∣⋅) = ∑
j
τ (Bj∣⋅)
(2.5)
with convergence in L1(X;µ)-norm. Hence, the conditional probability τ(⋅∣⋅) is a L1(X;µ)-
valued vector measure7 on Y.
Then the joint probability Prob(X ∈A and Y ∈B) is given by
∫x∈A τ(B∣x)dµ(x)
(2.6)
The directed graphical model corresponding to presenting the joint probability in this manner–
namely by giving (X, G, Y, H,µ, τ(⋅∣⋅))–is
m
m
X
Y
-
(2.7)
Let ν be the marginal probability for Y, ν(B) = ρ(X × B). Then τ(⋅∣⋅) is absolutely
continuous with respect to ν in the sense that τ(B∣⋅) is the zero “function” for every B such
that ν(B) = 0. However, unless we are in the common case where the σ-algebra on X is
generated by a countable collection of atoms8, L1(X;µ) does not have the Radon-Nikod´ym
property9 [107] (the example given above demonstrates this); hence, there is in general no
f ∈L1(Y;ν;L1(X;µ)) (which by Fubini’s theorem [74] is the same as L1(X × Y;µ × ν) for
the product measure10 µ×ν) such that the joint probability Prob(X ∈A and Y ∈B) is given
by ∫(x,y)∈A×B f(x,y)d(µ × ν)(x,y).
Lastly, deﬁning ζ(⋅∣⋅) symmetrically to τ(⋅∣⋅), the directed graphical model corresponding
to presenting the joint probability
Prob(X ∈A and Y ∈B) = ∫y∈B ζ(A∣y)dν(y)
(2.8)
by giving the marginal probability ν and the conditional probability ζ(⋅∣⋅) is
m
m
X
Y

(2.9)
7A vector measure is a countably-additive set function with values in a Banach space where the conver-
gence for the countably-additivity is in norm.
8A set in a set algebra is an atom if it is indivisible in the set algebra.
9A Banach space B has the Radon-Nikod´ym property if, for any B-valued vector measure ν on a set X
which is absolutely continuous with respect to some σ-ﬁnite measure µ on X, there is a Bochner integrable,
B-valued “function”, dν
dµ, such that ν(A) = ∫A
dν
dµ dµ for any ν-measurable A.
10Unfortunately, by convention the tensor product of measures is called the product measure and written
using × instead of the more appropriate ⊗(however, see [111] for a use of the latter notation).

CHAPTER 2. BAYESIAN NETWORKS-GRAPHICAL MODELS
9
As an example, consider calculating the conditional probability
Prob(Y ∈B∣X ∈A) = Prob(Y ∈B and X ∈A)
Prob(X ∈A)
(2.10)
(for Prob(X ∈A) ≠0–otherwise the joint probability does not determine the conditional
probability) using the information presented in the manner corresponding to each of the
four graphical models (the ﬁlled circle indicates which node is being conditioned on):
}
m
m
X ∈A
Ω
Y



/




S
S
SSw
S
S
SS
π (X−1(A) ∩Y −1(B))
π (X−1(A))
(2.11)
}
m
X ∈A
Y
ρ(A × B)
ρ(A × Y)
(2.12)
}
m
X ∈A
Y
-
∫x∈A τ(B∣x)dµ(x)
µ(A)
(2.13)
}
m
X ∈A
Y

∫y∈B ζ(A∣y)dν(y)
∫y∈Y ζ(A∣y)dν(y)
(2.14)
For instance, Bayes’ theorem is simply the calculation corresponding to the presentation of
information by the last graphical model.
A similar situation holds for any ﬁnite number of random variables [69], with a graphical
model with deterministic causation emanating from a fundamental, hidden probability space,
a graphical model with a clique of all the nodes for the random variables, and various directed
models with probabilistic causation. For the common case where the various σ-algebras are
generated by ﬁnitely many atoms, the various measures become vectors, the conditional
probabilities become stochastic matrices11 or tensors, and the integrations become sums.
11A matrix is stochastic if all entries are either positive or zero and all column sums are one.

CHAPTER 2. BAYESIAN NETWORKS-GRAPHICAL MODELS
10
2.2
Transition probability functions
Depending on how the information for the calculation of the joint probability is presented,
we may imagine diﬀerent ways of varying it. For (2.1), it is most natural to imagine indepen-
dently varying the maps X and Y. For (2.2), there is nothing to independently vary other
than the joint probability itself. For (2.7), we would like to imagine varying the marginal
probability µ and the conditional probability τ(⋅∣⋅) independently. This is a problem because
the space τ(⋅∣⋅) lives in–the L1(X;µ)-valued vector measures–depends on µ. This problem
will exist even in the commonly occurring case where the σ-algebra G is generated by a
countable collection of atoms if µ is zero on some atom (other than the empty set), since
then the conditional probability when conditioning on that atom is not well-deﬁned.
One solution to this problem, following [69], is provided by introducing the following
notion:
Deﬁnition 2.2.1
For σ-algebras G on X and H on Y, a function τ(⋅∣⋅) ∶H × X →R is a
transition probability function if: (i) for each x ∈X, τ(⋅∣x) is a probability measure on Y
with event σ-algebra H; and (ii) for each B ∈H, τ(B∣⋅) is a bounded, G-measurable function
on X.
By taking τ(⋅∣⋅) to be a transition probability function rather than a conditional probability,
it is now possible to vary µ and τ(⋅∣⋅) independently.
Following [69], one interpretation of the transition probability function is a function on X
with values in the probability measures on Y; naively, one is tempted to imagine τ(⋅∣x) is the
probability given X = x, although this is meaningless unless the marginal probability µ has
a strictly positive mass atom at x. Note the function is not generally Bochner integrable12
unless the σ-algebra H on Y is generated by a countable collection of atoms. For example,
if X = Y and the random variables X and Y are the same, then τ(B∣x) = 1B(x) = δx(B),
where the second interpretation as τ(⋅∣x) = δx is not Bochner integrable unless the σ-algebra
on X is generated by a countable collection of atoms.
Also note that the interpretation as a function-valued measure is potentially problematic
since the result is not generally a vector measure because convergence for countable additivity
is generally pointwise rather than in norm (using the supremum norm which is natural for
functions); for instance, consider the preceding example. By the Dominated Convergence
theorem, however, this pointwise convergence is adequate for integration. [75]
We now raise the question of whether it is always possible to upgrade a conditional
probability to a transition probability function. Under rather broad conditions, this is indeed
possible. Firstly, to make things precise we have the following deﬁnition:
12For any Banach space B, a B-valued function on a set X with a measure µ is Bochner integrable if there
is a sequence of simple functions (functions taking only ﬁnitely many values with each value achieved on a
set with ﬁnite µ-measure) converging to it, both pointwise in B-norm almost everywhere and in L1(X;µ;B)-
norm.

CHAPTER 2. BAYESIAN NETWORKS-GRAPHICAL MODELS
11
Deﬁnition 2.2.2
A transition probability function τ(⋅∣⋅) is a lift of a conditional probability
ν(⋅∣⋅) if τ(B∣⋅) ∈ν(B∣⋅) for every subset B in the σ-algebra.
Then, by A3.7, for any conditional probability there is a lift to a transition probability
function (not unique in general) given either of the following suﬃcient conditions (which are
generally met in practice): (i) the σ-algebra H on Y is generated by countably many atoms;
(ii) Y is an uncountable, complete, separable, metric space with H the Borel σ-algebra; or
(iii) the σ-algebra G on X is generated by countably many atoms. See A3.10 for additional
suﬃcient conditions.
Removing metaphysical constraints
Imagining one can vary µ and keep the transition probability function τ(⋅∣⋅) ﬁxed, there is an
intuitive interpretation of τ(⋅∣⋅) as an idealized conditional probability13, with τ(B∣x) being
the probability to observe B given the event {x}, even if the latter has probability zero or
is not even in the event σ-algebra (although in this latter case it is constant within any
atom). This leads to a metaphysical notion of the actual existence of a variable taking an
actual value with probability reﬂecting our ignorance of its value. This may be of value for
nodes in a graphical model which are observable; however, it is common to add hypothesized,
hidden nodes to a directed graphical model in order to (hopefully) break it up into smaller,
more manageable pieces [38]. For these, there is no justiﬁcation to necessarily limit oneself
to transition probability functions. Furthermore, the probabilities and conditional proba-
bilities involving the hidden nodes lack any meaning in either the Bayesian or frequentist
interpretations–the word probability then only means positive and norm-one.
For a ﬁxed choice of τ(⋅∣⋅), there is a convex linear map L from probability measures on
X to probability measures on Y given by
(Lµ)(B) = ∫x∈X τ(B∣x)dµ(x)
(2.15)
The map L extends to a linear map on more general measures and signed measures. Hence,
another solution (among many others) to the above posed problem is therefore to take the
independently varied objects to be the marginal probability µ and the linear map L. Not
all linear maps that take probability measures to probability measures are necessarily in-
duced by some transition probability function as in (2.15) (however, they are all induced by
some pseudo-transition “function”–see B2.7, B2.8, and B2.9), so this generally introduces
additional maps. These additional maps, involving operations such as Lebesgue decompo-
sition [76], are not in and of themselves of great interest; in fact the raise rather undesired
complications (see §3.2). Furthermore, in the common case where the σ-algebras are gen-
erated by countably many atoms, any linear map is induced by some transition probability
function, so there are no additional maps. However, what is fruitful is the conceptual shift;
as will be explored in the following chapter, once we are thinking in terms of linear maps,
13As noted in [69].

CHAPTER 2. BAYESIAN NETWORKS-GRAPHICAL MODELS
12
we are immediately drawn to consider the question of looking at linear maps between spaces
other than spaces of measures.
2.3
Graphical models as constraints
In addition to showing the form in which information is presented, graphical models can
also show constraints on the information in a far simpler form than the usual notation. For
instance, consider the Markov chain with three random variables X,Y,Z. For the graphical
model
m
m
m
m
X
Ω
Y
Z



/




?
S
S
SSw
S
S
SS
(2.16)
with the joint probability Prob(X ∈A and Y ∈B and Z ∈C) given by π (X−1(A)∩Y −1(B)∩
Z−1(C)), it is necessary to explicitly add the constraint that for every C ∈Z(E), the con-
ditional probability τ(C∣x,y) = dµC
dµ , for µC(A × B) = π (X−1(A) ∩Y −1(B) ∩Z−1(C)) and
µ = µZ, is independent of x (in the almost-everywhere, probabilistic sense). If, as above, we
imagine varying the maps X and Y, it is not at all clear how to do this while maintaining
the constraint.
Similarly, for the graphical model
m
m
m
X
Y
Z




S
S
SS
(2.17)
with the joint probability Prob(X ∈A and Y ∈B and Z ∈C) given by ρ(A × B × C), it
is necessary to explicitly add the constraint that for every C ∈I = Z(E), the conditional
probability τ(C∣x,y) = dµC
dµ , for µC(A × B) = ρ(A × B × C) and µ = µZ, is independent of x
(in the almost-everywhere, probabilistic sense). If, as above, we imagine varying the joint
probability ρ, it is not at all clear how to do this while maintaining the constraint.
However, consider the directed graphical model:
m
m
m
X
Y
Z
-
-
(2.18)

CHAPTER 2. BAYESIAN NETWORKS-GRAPHICAL MODELS
13
which corresponds to presenting the information to calculate the joint probability as φ, η(⋅∣⋅),
and τ(⋅∣⋅) where
Prob(X ∈A,Y ∈B, and Z ∈C) = ∫(x,y)∈A×B τ(C∣y)dµ(x,y) = ∫y∈B τ(C∣y)dξ(y)
(2.19)
for the marginal probabilities µ on X × Y and ξ on Y given by
µ(A × B) = ∫x∈A η(B∣x)dφ(x),ξ(B) = µ(X × B) = ∫x∈X η(B∣x)dφ(x)
(2.20)
The restriction is that the conditional probability τ(⋅∣⋅) is independent of x (in the almost-
everywhere, probabilistic sense). It is not necessary to give this constraint explicitly since it
is indicated by the graphical model through the lack of an arrow directly from X to Z. If,
as above, we take η(⋅∣⋅) and τ(⋅∣⋅) as transition probability functions instead of conditional
probabilities, it is now easy to see how to vary φ, η(⋅∣⋅), and τ(⋅∣⋅) while maintaining the
constraint–namely, by only allowing τ(⋅∣⋅) that are independent of x.
Note if the wrong directed model is chosen, the constraint can be masked. For instance,
for the graphical model
m
m
m
X
Y
Z



/
S
S
S
So

(2.21)
which corresponds to presenting the information to calculate the joint probability as ν, θ(⋅∣⋅),
and ζ(⋅∣⋅) where
Prob(X ∈A,Y ∈B, and Z ∈C) = ∫(y,z)∈B×C ζ(A∣y,z)dκ(y,z)
(2.22)
for the marginal probability κ on Y × Z given by
κ(B × C) = ∫z∈C× θ(B∣z)dν(z)
(2.23)
Once again, it is necessary to explicitly add the constraint that for every C ∈I, the condi-
tional probability τ(C∣x,y) = dµC
dµ , for µC(A×B) = ∫(y,z)∈B×C ζ(A∣y,z)dκ(y,z) and µ = µZ, is
independent of x (in the almost-everywhere, probabilistic sense).
This can be readily generalized to more complicated graphical models–any graph that is
not simply a clique14 of all the nodes implies constraints on the allowed joint probabilities.
In this manner the various dependencies are displayed in a far more intuitive manner than
through a long list of opaque constraints. Of course, it is always possible to impose additional
constraints explicitly.
14A clique is a group of nodes that are all connected to one another.

CHAPTER 2. BAYESIAN NETWORKS-GRAPHICAL MODELS
14
2.4
Directed graphical models as tensor networks
Tensor networks are a commonly employed, diagrammatic device for contracting tensors and
vectors. For the common case where the various σ-algebras are generated by ﬁnitely many
atoms, a directed graphical model together with all its information corresponds to a tensor
network or, if conditioning is present, the ratio of tensor networks. If the conditioning is only
on nodes without parents, the denominator is necessarily one, so these can also be considered
tensor networks. Each node in the graphical model with either no children or only one child
becomes one node in the tensor network. For nodes in the graphical model with multiple
children, it is best to replace them with two nodes, one of which takes in all the inputs and
has a single connection to the other, which is a copying or diagonal node that is zero unless
all its connections are the same, when it has the value one, which branches out to all the
outputs.
For example, consider the graphical model:
m
m
m
m
}
X
Y
V
Z
W

1
PPPPPP
q

1
PPPPPP
q
(2.24)
with corresponding information Prob(X = x), Prob(Y = y), Prob(V = v∣X = x,Y = y),
Prob(Z = z∣V = v), and Prob(W = w∣V = v), so the conditional probability Prob(X = x,Y =
y,Z = z∣W = w) is
∑v∈V (Prob(X = x)Prob(Y = y)Prob(V = v∣X = x,Y = y)
Prob(Z = z∣V = v)Prob(W = w∣V = v))
∑x′∈X,y′∈Y,v′∈V (Prob(X = x′)Prob(Y = y′)Prob(V = v′∣X = x′,Y = y′)
Prob(W = w∣V = v′))
(2.25)
The corresponding tensor network for the numerator is:
v
v
v
v
x
y
A
C
B
Copy
z
w

PPPPPPP

HHHHH
(2.26)
where Axyv = Prob(X = x)Prob(Y = y)Prob(V = v∣X = x,Y = y), which is equal to Prob(V =
v,X = x,Y = y), the Copy tensor is zero unless all its subscript are equal, in which case it
has value one, Bvw = Prob(W = w∣V = v) and Cvz = Prob(Z = z∣V = v). The value for the
tensor network is then
∑
v,v′,v′′∈V
AxyvCopyvv′v′′Bv′wCv′′z = ∑
v∈V
AxyvBvwCvz
(2.27)

CHAPTER 2. BAYESIAN NETWORKS-GRAPHICAL MODELS
15
which equals the numerator. For the denominator, the tensor network in this case is simply
v
w
D
(2.28)
where
Dw =
∑
x∈X,y∈Y,v∈V
Prob(X = x)Prob(Y = y)Prob(V = v∣X = x,Y = y)Prob(W = w∣V = v)
(2.29)
which is equal to Prob(W = w).
As this example illustrates, the advantages of the Bayesian network over the tensor net-
work are that: (i) it is possible to show which nodes are being observed, marginalized, or
conditioned on; and (ii) the nodes in the Bayesian network have a more intuitive interpre-
tation. On the other hand, the tensor network does highlight the importance of copying for
there to be multiple child nodes, which will be important later for incorporating quantum
nodes (see §3.2, §3.4, and §4.1).
2.5
The Copy map and restriction maps
Going along with the linear maps on measures induced by transition probability function
(see (2.15)), we have the following additional useful linear maps for the evaluation of the
joint probability for a directed graphical model. For a set X with σ-algebra E, there is
a Copy map from E-measures on X to F-measures on X × X, where F is the σ-algebra
generated by the rectangular sets E × E. It is given by, for any set A ∈F and E-measure
µ, Copy(µ)(A) = µ({x ∈X∣(x,x) ∈A}). It is induced by the transition probability function
τ(⋅∣⋅) given by
τ(A∣x) =
⎧⎪⎪⎨⎪⎪⎩
1
if (x,x) ∈A
0
otherwise
(2.30)
This can clearly be generalized for creating any ﬁnite number of copies.
For each A ∈E, there is a restriction map, which is an idempotent, sending E-measures
on X to E-measures15 on X, µ →1Aµ = µ(A ∩⋅). It is induced by the transition probability
function τ(⋅∣⋅) given by τ(A∣x) = 1A(x).
2.6
Determinism
An additional restriction that can be placed on the directed graphical models is one of
determinism, which we will interpret to mean that each node with a parent is associated to
15We adopt the convention that a function (or “function”) before a measure, fµ, is the signed measure
fµ(A) = ∫A f dµ.

CHAPTER 2. BAYESIAN NETWORKS-GRAPHICAL MODELS
16
a transition probability function (rather than merely a conditional probability) and that all
transition probability functions take values only zero or one. In that way, all uncertainty is
due to the input probability measures coming from parentless nodes, which can be interpreted
as arising from our uncertainty on initial values which are imagined to actually have speciﬁc,
unknown values. For rather broad conditions (speciﬁed in the following), it is always possible
to replace a directed graphical model with one that is deterministic and gives identical
results for the joint probability. For each transition probability function, we add an auxiliary
measure space, namely [0,1] with the standard topology, the Borel σ-algebra, and Lebesgue
measure as its marginal probability. We then constrict a deterministic transition probability
function involving this additional space such that when the auxiliary space is marginalized,
we recover the original transition probability function. Graphically, this means making the
replacement for each node with a parent
m
m
m

>
ZZZ
~

>
ZZZ
~

>
ZZZ
~

>
ZZZ
~
?

ZZZ
Y
Y
Ô⇒
(2.31)
where the double arrows are used to indicate the associated transition probability function
is deterministic.
By A3.8, suﬃcient conditions for this are given by similar suﬃcient conditions (which
are generally met in practice) for the existence of a lift in §2.2, so either: (i) the σ-algebra
H on Y is generated by countably many atoms; or (ii) Y is an uncountable, complete,
separable, metric space with H the Borel σ-algebra. Then for any transition probability
function τ(⋅∣⋅) ∶H × X →[0,1] there is a deterministic transition probability function ξ(⋅∣⋅) ∶
F × X × [0,1] →{0,1} such that
τ(B∣x) = ∫s∈[0,1] ξ(B∣x,s) dλ(s)
where λ is Lebesgue measure on R. By A3.9, deterministic transition probability functions
are induced by point transformations, which is another common interpretation of determin-
ism.
Of course, just because we can restrict to working with deterministic models does not
mean we must or that we should–there are many arbitrary choices made in the construction
of ξ(⋅∣⋅) and it is more straightforward in general to simply work directly with τ(⋅∣⋅). Hence,
we will discard the restriction of determinism. (Similarly, in §5.1, we will show commonly
employed restrictions for quantum models, such as unitarity, are equally without merit.)

17
Chapter 3
Hidden classic and quantum nodes
3.1
Principles of linearity and potential universality
The traditional approach to using Bayesian networks with directed graphical models gives
a marginal probability measure for each input1 node and a transition probability function
for each of the remaining nodes. Then the following principle [47] is utilized, which is so
reasonable it almost always goes unmentioned, but is just implicitly assumed:
Principle 3.1.1–Measurement independence
The input marginal probabilities can be
varied independently of each other and the transition probability functions.2
As an example of both the utility and reasonableness of this principle, consider a box with
a horn and a switch. Suppose we know the horn buzzes with 0.9 probability if the switch
is in the left position, and buzzes with 0.3 probability if the switch is in the right position.
The graphical model for this is:
}
m
switch
horn
box
-
(3.1)
Now suppose we have a balanced stick that falls with equal probability to the left or the
right when we release it. Now suppose we arrange it so it activates the switch when it falls.
The graphical model now is:
m
m
m
stick
switch
horn
box
-
-
(3.2)
1All nodes without parents.
2Also known as the free choice or free will principle.

CHAPTER 3. HIDDEN CLASSIC AND QUANTUM NODES
18
The initial probability measure here is 0.5 to fall to the right and 0.5 to fall to the left. The
action of the stick on the switch is deterministic, as is indicated by the double arrow. Once
the switch has been activated, which we observe, the incoming probability measure will be
either 1 for the switch to be right, 0 to be left or 0 for the switch to be right, 1 to be left,
so we can reuse the transition probability function from above. Then, marginalizing the
observations of which way the stick fell and the resulting position of the switch, there is a
0.5 ⋅0.9 + 0.5 ⋅0.3 = 0.6 marginal probability the horn will sound.
Now consider placing a screen that blocks our view of which way the stick falls, but still
allows us to hear the horn if it sounds. The graphical model is
m
m
m
stick
switch
horn
box
-
-
(3.3)
If we wish to predict the marginal probability the horn will sound, we have a problem. We
are given the behavior of the box for incoming probability measures either: 1 for the switch
to be right, 0 to be left; or 0 for the switch to be right, 1 to be left–but not for 0.5 for the
switch to be right, 0.5 to be left. This is where we must appeal to the preceding principle,
which gives that there is still 0.5 ⋅0.9 + 0.5 ⋅0.3 = 0.6 probability the horn will sound.
From the metaphysical viewpoint this principle makes perfect sense. If there are actually
existing variables that take actual values (such as the position of the switch), observed
outcomes depend only these and not on probability measures, which are only a reﬂection of
our ignorance. As has already been commented on, this justiﬁcation fails for hidden nodes,
which are hypothetical constructs we introduce. Without this metaphysical backing, the
principle is actually far stronger than what is required in that it assumes the existence of
transition probability functions.
If the principle is assumed to hold, then, from (2.15), the calculation of the joint prob-
ability reduces to some combination of composition and tensor product of of linear maps,
involving both those induced by the given transition probability functions, restriction maps,
and possibly the Copy map (the last two of which are also induced by certain transition
probability functions–see §2.5). By A3.2 and A3.3, this calculation is well-deﬁned. For
instance, the calculation of the joint probability for (2.21), with θ(⋅∣⋅) and ζ(⋅∣⋅) as transition
probability functions, can be given as3,4
(RA ○K ○((RB ○L) ⊗I) ○Copy ○RCν)(X)
(3.4)
3We adopt the usual mathematical convention of maps acting on the left. The opposite convention of
maps acting on the right is also commonly employed in the literature for the classical observed case [62].
4We will follow the convention that the tensor product of vector spaces consists of all ﬁnite linear
combinations (the algebraic tensor product) except if both are Hilbert spaces, in which case it is the Hilbert
space given by the completion using the standard induced inner-product. The tensor product K ⊗L of linear
maps L ∶A →C and K ∶B →D is, for closed, linear spaces E ⊂A ⊗B and F ⊂C ⊗F, the set of all linear maps
M ∶E →F which, when restricted to A ⊗B, agree with K ⊗L. If this set consists of a single map, K ⊗L is
termed well-deﬁned.

CHAPTER 3. HIDDEN CLASSIC AND QUANTUM NODES
19
for L the map induced by θ(⋅∣⋅), K the map induced by ζ(⋅∣⋅), I the identity map on measures,
and RA, RB, RC restriction maps. By introducing an initializing map, Li, on the trivial
measure space5, which is isomorphic to R, with constant value µ and a terminal map, Lt,
which evaluates the measure on X (hence, is a map to the trivial measure space), this can
be written purely in terms of maps:
Lt ○RA ○K ○((RB ○L) ⊗I) ○Copy ○RC ○Li
(3.5)
Later, we will introduce hidden nodes of a special form to account for initializing or termi-
nating maps (see §4.1).
Therefore, the joint probability is a multilinear functional on the input marginal prob-
abilities. Furthermore, by a convergence theorem for sequences of measures [77], it is not
just linear for ﬁnite linear combinations in each marginal measure, but absolutely convergent
countable linear combinations as well. Hence, for any one input node, if Φ is the functional
(with all the marginal probability measures for other nodes ﬁxed) and ⟨µj⟩is a sequence of
marginal probability measures for that node with ∑j ∥µj∥ﬁnite, then Φ(∑j µj) = ∑j Φµj. It
is obvious that it would still be possible to make the calculation for the above example with
the box based simply on this linearity property, which is weaker than the above principle.
As we have already mentioned, we will consider hidden nodes associated to maps on
spaces other than the space of measures. Therefore, we introduce the following weaker and
more general version of the above principle:
Principle 3.1.2–Linearity
The maps for a Bayesian network are linear and bounded
(hence, continuous).
Moreover, we want the maps for graph fragments to be universal in the sense that the
modules (such as the box in the preceding example) can be used to make predictions in novel
situations. While this may fail in practice, this should be as a result of experiment and not
be preordained by the mathematical models employed. We insist, therefore, on potential
universality in the sense that any possible tensor product (not just those for a particular
network) of the linear maps employed should always be well-deﬁned.
Principle 3.1.3–Potential universality
The space of linear maps employed must be
such that any tensor product of maps in the space is well-deﬁned.
The repercussions of the latter two principles will be studied in the following.
5A measure on a set X is trivial if the only subsets in its σ-algebra are {∅,X}.

CHAPTER 3. HIDDEN CLASSIC AND QUANTUM NODES
20
3.2
Options I and II
A problem arising from potential universality
Generalizing from maps induced by transition probability functions to more general linear
maps, composition is not an issue. However, the principle of potential universality does not
hold in general for maps on measures on speciﬁed sets for speciﬁed σ-algebras of events. One
problem is the lack of uniqueness. Suppose one has the identity map I on Borel6 measures
on the interval [0,1] with the usual topology. Deﬁne I ⊗I to be the set of all bounded, linear
maps L on the Borel measures on [0,1] × [0,1], with the usual product topology, such that,
restricted to product measures, µ × ν, L(µ × ν) = (Iµ) × (Iν) = µ × ν. One obvious member
of I ⊗I is simply the identity map on the Borel measures on [0,1] × [0,1]. This is the only
weak*-continuous7 map in the set. Another map in the set is given by K ∶ρ →⋁(ρ ∥(µ×ν)),
where the supremum is taken over all product, ﬁnite, Borel measures and ρ ∥(µ × ν) is the
part of ρ absolutely continuous with respect to µ × ν using Lebesgue decomposition [76].
This is a well-deﬁned map by B2.1 that diﬀers from the identity map. For instance, let ρ
be the diagonal Lebesgue measure,
ρ(A) = λ({a ∈[0,1]∣(a,a) ∈A})
(3.6)
Then the identity map sends ρ to itself, whereas Kρ = 0 (see B1.8 for details).
Another possible problem is the lack of existence. Not every linear map can be extended.
For example, the space of sequences with limit zero, c0, is a norm-closed8, weak*-dense9
subset of the bounded sequences, ℓ∞. However, there is no extension of the identity map
c0 →c0 to a projection ℓ∞→c0. [5] [124] However, it is not clear whether there is a similar
problem with extending the tensor product of linear maps.
Resolving the problem–two options
There are various ways to resolve this dilemma. One is to revert to only considering linear
maps induced by transition probability functions, which works by A3.3. We will not pursue
this approach since it has no ready generalization to linear maps on spaces other than those
of measures. Instead, we will consider two approaches which do. The ﬁrst, which will be
termed option I, is to limit the space of measures so as to eliminate measures such as ρ
6The Borel σ-algebra on a topological space is that generated by the open subsets.
7Using the Riesz theorem [78] which states that Radon (deﬁned in the following) measures on a compact
set are dual to the continuous functions on that set. A measure on a topological space is inner regular if
the measure of any set is approximated by the measure of compact sets it contains. It is outer regular if the
measure of any set is approximated by the open sets that contain it. A measure is Radon if it is Borel and
inner regular. If the space is compact and Hausdorﬀ, and the measure is ﬁnite, then it is also necessarily
outer regular. If the space is compact, Hausdorﬀ, metric, and separable, then Borel measures are necessarily
Radon [79].
8Using the supremum norm.
9Using the duality of ℓ1 and ℓ∞.

CHAPTER 3. HIDDEN CLASSIC AND QUANTUM NODES
21
above. The alternative, which will be termed option II, is to impose additional structure on
the sets and then to limit the space of maps, so as to eliminate maps such as K above.
To implement option I, a basic property that we want for our subsets of measures is
deﬁned by:
Deﬁnition 3.2.1
A subset A of measures is absolutely-continuous-complete if, for any µ
in A, all measures absolutely continuous with respect to µ are also in A.
By the Radon-Nikod´ym theorem and the density of simple functions10 in L1-spaces, a subset
of ﬁnite measures A will have this property if, given any measure µ ∈A, all the restrictions µ∣E
over µ-measurable subsets E are also in A. Hence, this property is the minimal requirement
to show that a map is indeed positive. Then from A1.2, A1.3, B1.3, B1.4, and B2.5, the
necessary and suﬃcient condition to implement option I is that the tensor product of the
subsets of measures for each set is norm-dense11 in the subset of measures for the product
set.
A suﬃcient method, termed option I’, to insure this is met is for each set to have an
associated base measure. The base measure need not be ﬁnite, but it must be σ-ﬁnite. Then
the associated subset of measures is the set of all ﬁnite measures absolutely continuous with
respect to the base measure, which by the Radon-Nikod´ym theorem is equivalent to the space
of L1-functions with respect to the base measure. The base measure for the direct product
of sets must be the product of the base measures for the individual sets. The suﬃciency of
this prescription is given by B3.1.
Another suﬃcient method is to instead use the space of atomic measures12. If there are
uncountably many atoms in the σ-algebra, this is distinct from option I’; otherwise, the
counting measure that assigns one to each atom is a base measure. The suﬃciency of this
prescription is given by B6.1 and B6.2. It is also possible to combine these two suﬃcient
approaches, say by using the atomic, L1(X;µ)-valued vector E-measures on Y.
This is
suﬃcient by B3.1, B6.1, and B6.2.
The implementation of option II is more straightforward. Each set has a topological
structure that makes it a compact, Hausdorﬀspace. By Tychonoﬀ’s theorem [53] [80], the
direct product of compact spaces with the product topology is necessarily compact. All the
σ-algebras are required to be the Borel σ-algebra. The linear maps are restricted to those
that are weak* continuous; in other words, those maps that are the adjoints to linear maps
on continuous functions going in the opposite direction. In practice, rather that working with
the adjoint maps, one works with the linear maps in the opposite direction. The propositions
A1.3, C1.1, and C2.4 gives the suﬃciency of this prescription.
10A simple function takes on only ﬁnitely many values.
11Using the total-variation norm.
12A measure is atomic if there is a union of countably many atoms in the σ-algebra such that the
complement of the union has measure zero.

CHAPTER 3. HIDDEN CLASSIC AND QUANTUM NODES
22
Comments on the two options
For option I’, the need for base measures is not generally a troublesome issue. For σ-algebras
generated by a countable number of atomic subsets13, the counting measure that assigns one
to each atom is a base measure for any ﬁnite measure. For classical physics, with conﬁgura-
tion space X and phase-space given by the cotangent bundle T ∗X, the symplectic phase-space
volume-form14 Ωprovides a natural base measure, since by Heisenberg’s uncertainty princi-
ple, not even all measures absolutely-continuous with respect to Ωare accessible, let alone
more singular measures.
Note that allowing the base measure to be a σ-ﬁnite measure is only for purposes of
convenience in allowing the commonly employed Lebesgue measure on unbounded subsets
of Rn, as the following theorem shows:
Theorem 3.2.2
Given any σ-ﬁnite measure µ on a set X, there is a ﬁnite measure ν such
that L1(X;µ) is isometric to L1(X;ν), where the isomorphism is a pointwise scaling.
Proof
If µ is ﬁnite, there is nothing to show, so assume it is not. Since µ is σ-ﬁnite, there is
a countable collection of disjoint subsets {Bj} of X such that µ(Bj) is ﬁnite and nonzero for
each j ∈{1,2,...} and ⋃∞
j=1 Bj = X. Then let the ﬁnite measure ν be given by ν∣Bj =
µ∣Bj
2jµ(Bj).
◻
However, there are two complaints with option I’. One is that for base measures with an
inﬁnitely-divisible15 part (see B1.7), there is no Copy map (by the same argument as in the
proof of B1.8); hence, except for this (eﬀectively discrete) case, hidden nodes either have
only one child node or are terminated. The second complaint is that passing a continuously
variable parameter to a hidden node as a simple number is not permitted (unless that
particular value corresponds to an atom in the base measure); instead, one must use a
sharply peaked measure.
This adds signiﬁcant complexity for little gain in cases where
one is not especially interested in modeling uncertainty in the inputs (see §4.5 and §8.2 for
instances).
For option II, the restriction to topological spaces and Borel σ-algebras is also not trou-
blesome, since these are typically used in any case. The limitation of using compact spaces
appears severe, but locally compact spaces16 can also be used with the restriction that the
13A subset in a σ-algebra is atomic if it is indivisible in the σ-algebra.
14As a measure, locally Ωis simply Lebesgue measure with respect to any canonical choice of local position
and momentum coordinates.
15A σ-ﬁnite measure µ for a measure space (X,E,µ) is inﬁnitely-divisible if for any ε > 0, there is a
countable (ﬁnite if µ is ﬁnite) partition of X, {Bj}, with each µ(Bj) < ε.
16A space is locally compact if it can be compactiﬁed by the addition of one point, the point-at-
inﬁnity. [54]. [81]

CHAPTER 3. HIDDEN CLASSIC AND QUANTUM NODES
23
maps take continuous functions vanishing at inﬁnity to continuous functions vanishing at
inﬁnity, so the adjoint maps on measures do not “leak away” measure at inﬁnity.
In addition, for option II, the ﬁrst complaint above does not occur since the Copy map is
adjoint to the map Copy∗that takes continuous functions on X × X to continuous functions
on X by (Copy∗f)(x) = f(x,x) (which can obviously be generalized to make any ﬁnite
number of copies). The second complaint does not occur either since the evaluation map is
well-deﬁned for continuous functions. However, there is now the opposite problem in that we
wish to calculate probabilities on sets, so we need maps on characteristic functions, not just
continuous ones. One solution is to extend each map to one from bounded, Borel measurable
functions to bounded, Borel measurable functions; by C2.9 this can always be done in a
unique manner. Another solution is to use the results on continuous functions to get the
result for characteristic functions of open sets as in the proof of the Riesz theorem [78]; then
outer regularity gives the result on any characteristic function of a Borel set.
Note that for option I’, the considered linear map L ∶L1(X;µ) →L1(Y;ν) is always
induced by a conditional probability ξ(⋅∣⋅) which is given by, for ν-measurable sets B,
ξ(B∣⋅) = L∗1B (which is of course actually an equivalence class of functions that agree almost
everywhere with respect to µ) with the adjoint map L∗∶L∞(Y;ν) →L∞(X;µ):
∫y∈B(Lf)(y)dν(y) = ∫y∈Y 1B(Lf)(y)dν(y) = ∫x∈X f(x)(L∗1B)(x)dµ(x)
(3.7)
= ∫x∈X f(x)ξ(B∣x)dµ(x)
for any f ∈L1(X;µ). By A3.7, if either: (i) the σ-algebra for Y is generated by countably
many atoms; or (ii) Y is an uncountable, complete, separable, metric space with the Borel σ-
algebra–then a transition probability function τ(⋅∣⋅) does exist that is a lift of ξ(⋅∣⋅). Similarly,
if we use option I with the measures limited to the atomic measures, the considered linear
map L ∶A(X;E) →A(Y;F) is always induced by an object τ(⋅∣⋅) which is given by, for sets
B ∈F, τ(B∣x) = (LδA)(B) for x in the atomic set A ∈E:
(Lµ)(B) = ∫x∈X τ(B∣x)dµ(x)
(3.8)
for any atomic measure µ ∈A(X;E). However, in general τ(⋅∣⋅) will not be a transition
probability function since there is no reason for τ(B∣⋅) to necessarily be E-measurable. Also,
for option II, if Y is metric, by C2.8, for the considered linear map L ∶C(Y) →C(X), the
adjoint map L∗∶M(X) →M(Y) is induced by the transition probability function τ(⋅∣⋅)
given by τ(B∣x) = (Lδx)(B) for any x ∈X and Borel subset B ⊂Y:
(L∗µ)(B) = ∫x∈X τ(B∣x)dµ(x)
(3.9)
for any Radon measure µ ∈M(X). However, despite the existence of transition probability
functions (or similar objects) in most encountered cases, it is still more fruitful to consider
the linear maps themselves as the primary objects of interest rather than the transition

CHAPTER 3. HIDDEN CLASSIC AND QUANTUM NODES
24
probability functions (or similar objects). As is shown in the following section, the linear
maps can be generalized to linear maps on structures other than measures, whereas the
transition probability functions or similar objects do not generalize.
3.3
Quantum nodes
Expanding the space of considered maps
As an alternative to linear maps on measures, consider linear maps on density matrices17,18
or, more generally, density matrix-valued vector measures. We will show below that, with
some restrictions on the maps, this can be made to work consistently with the propositions
given in §3.1. We will show in §5.1 that this gives rise to models that are consistent with
the usual, textbook quantum mechanics; therefore, nodes whose linear maps involve density
matrices will be termed quantum. However, the term quantum should not be taken to imply
these maps are necessarily only of utility in situations traditionally thought of as in the
domain of quantum mechanics–in principle, any hidden node in any forecasting situation,
say forecasting weather or stock prices, could be a quantum node. It is up to experiment to
determine if these are of utility. Thus far, we are unaware of any structures besides measures
and density matrices that have the requisite properties to be employed in modelling. The
question of whether or not there are such additional structures will be further explored in
§3.8 below.
Following our work in the preceding section, for option I, instead of linear maps on subsets
of real-valued measures, we have linear maps on subsets of the D(H)+-valued vector measures.
For option I’, we will require the vector measures to be absolutely continuous with respect
to a base measure. Since D(H) has the Radon-Nikod´ym property [18], this is equivalent to
having D(H)+-valued, Bochner-integrable functions. The constraint of potential universality
mandates having well-deﬁned tensor product of maps; this is maintained by A1.3 and B4.1
if the tensor product is bounded.
Similarly to the classical case, another suﬃcient approach to implementing option I is to
take the atomic, D(H)+-valued vector measures, as is shown by B6.1 and B6.2. It is also
possible to combine these two suﬃcient approaches, say by using the atomic, L1(X;µ;D(H))-
valued vector E-measures on Y. This is suﬃcient by B4.1, B6.1, and B6.2.
17A Hilbert space will be taken to be any complete, sesquilinear inner-product space, without regard to
cardinality of dimension or separability. The density matrices D(H)+ will be taken to be the self-adjoint,
positive operators on a given Hilbert space H.
18A linear map from D(H) to D(J) is commonly referred to as a superoperator in the literature. We choose
not to employ this terminology for the following reasons: (i) linear maps is already standard mathematical
terminology and is in common use in the analogous classical situation, for instance Markov maps; (ii)
superoperator seems to imply a map on all bounded operators, B(H), when in general it is not possible to
extend the domain of the map beyond the trace-class operators, S1(H); and (iii) the use of super- risks
confusion with the unrelated supersymmetry and superstrings.

CHAPTER 3. HIDDEN CLASSIC AND QUANTUM NODES
25
For option II, instead of maps on real-valued, positive, continuous functions, one has maps
on continuous functions that take values in the self-adjoint, positive, compact19 operators on
a Hilbert space H, K(H)+. Self-adjoint, compact operators are used since they are the predual
to the self-adjoint trace-class operators. [65] Once again, potential universality mandates
having well-deﬁned tensor products of maps; as before, this is maintained if the tensor
product is bounded, now by A1.3 and C3.1.
Problem arising from positivity and potential universality
Of course, everything is not really that simple. The tensor product of bounded maps may
not be bounded. Also, even if both maps are positive, their tensor product need not be.
To illustrate these problems, take a separable, inﬁnite-dimensional Hilbert space H, ﬁx some
orthonormal basis {ej}, and consider the transpose map T relative to that basis:
T ⎛
⎝∑
j,k
ajkej ⊗e∗
k
⎞
⎠= ∑
j,k
akjej ⊗e∗
k
(3.10)
where e∗
k is the functional ⟨⋅,ek⟩. This is well-deﬁned on the space of density-matrices on
H, D(H)+, since, by the spectral theorem for compact operators [21], any such operator
can be written in the form of an inﬁnite matrix with ﬁnite rank operators corresponding
to truncated matrices converging in trace norm. (Of course, since density-matrices are self-
adjoint, T could also be termed the conjugate map relative to the basis). This map is clearly
positive and has operator norm one.
However, consider the tensor product map T ⊗IMn acting on density matrices D(H⊗Cn)+,
where IMn is the identity map acting on n × n-matrices. For the rank-one operator ψ ⊗ψ∗
with
ψ =
n−1
∑
j=0
e(n+1)j+1
(3.11)
we have (T ⊗IMn)(ψ ⊗ψ∗) = S.
Truncating S to the span of {e1,...,en2} (it is zero
elsewhere), it is the matrix form of the transpose map acting on Mn written in vector form
using the Vec operation20. Therefore, S clearly has eigenvalue one with multiplicity n(n+1)
2
and eigenvalue minus one with multiplicity n(n−1)
2
. Hence, T ⊗IMn is not positive, and
∥T ⊗IMn∥op ≥
1
∥ψ∥2 (n(n + 1)
2
∣1∣+ n(n −1)
2
∣−1∣) = n2
n = n
(3.12)
By [23], ∥T ⊗IMn∥op = n and this example is maximal. This is clearly unbounded as n →∞.
19An operator is compact if the image of any bounded sequence has a convergent subsequence.
20Vec takes a n × n-matrix to a column vector of height n2 by stacking columns.

CHAPTER 3. HIDDEN CLASSIC AND QUANTUM NODES
26
Solution to the problem
The solution to both the positivity and the boundedness problem is to require complete-
positivity for the maps. This has several deﬁnitions (see B2.6, B5.6, C2.1) that are equiv-
alent (see B5.8, C5.6); the basic notion is that all tensor products with various identity
maps should be positive. Since the composition of positive maps is positive, this immediately
implies that complete-positivity is preserved under both composition and tensor products.
Furthermore, from B2.5, B2.5, C2.4, and C5.3, the operator norm is a cross-norm21 for
completely-positive maps, so this resolves the boundedness problem as well. The completely-
positive maps clearly form a convex cone within the space of all maps; this cone is closed in
the norm topology and in various weaker topologies by B5.12, B5.14, and C5.10; however,
unlike the cone of positive maps, in inﬁnite dimensions it has no interior in any of these
topologies, which raises issues for approximation in numerical calculation.
3.4
No quantum copying
It is commonly stated that cloning is something that is possible classically, but is impossible
in quantum mechanics. This is based on false analogy. The correct situation is that there
are two diﬀerent notions, that of copying and that of cloning, that are being confused. Once
these two have been separated, we have the following situation:
classical
quantum
copying
Exists
and
implementable
since linear.
Does not exist.
cloning
Exists
but
not
imple-
mentable
since
neither
linear nor the ratio of linear
maps.
Exists
but
not
imple-
mentable
since
neither
linear nor the ratio of linear
maps.
The confusion is comparing the upper left and lower right entries instead of correctly going
across. Cloning is possible for neither classical nor quantum Bayesian networks (as will be
shown below in §6.1) for exactly the same reason, so it does not diﬀerentiate the two. On the
other hand, copying is possible classically (except for issues arising from potential universality
considered above in §3.2), but cannot even be deﬁned as a mathematical operation on density
matrices.
21A norm is a cross-norm if ∥a ⊗b∥≤∥a∥∥b∥. Note the property of being a cross-norm depends on the
choice of norms for the individual spaces as well as for the larger space containing the tensor products.

CHAPTER 3. HIDDEN CLASSIC AND QUANTUM NODES
27
Classical copying
As has already been mentioned (see §2.5), there is a Copy map from measures on a set X
to measures on X × X. When X is a compact set, this map is weak*-continuous, being the
adjoint of the previously discussed map (Copy∗f)(x) = f(x,x). The Clone map is given by
µ →µ×µ. For the single atom measure for atom C, where for any measurable subset A ⊂X,
δC(A) =
⎧⎪⎪⎨⎪⎪⎩
1
if A ⊃C
0
otherwise
(3.13)
we have
Copy δC = δC × δC = Clone δC
(3.14)
This is likely the source of confusion between the Copy and Clone maps for the classical
case.
Instead of using this explicit form for Copy, an approach that will prove useful in the
quantum case is to start with some basic properties, then ﬁnd the implications. One property
of what is commonly accepted as the notion of a copy is that the probability for both copies
to have a speciﬁed property is equal to that for each copy to have it, which is equal to that
of the original having it, so for any unit-norm measure µ on X and any µ-measurable set
A ⊂X,
Property C
Copy µ(A × A) = Copy µ(A × X) = Copy µ(X × A) = µ(A)
Note this property implies Copy µ(A × (X ∖A))) = Copy µ((X ∖A) × A) = 0. Now given
a σ-algebra E of subsets of X, let F be the σ-algebra generated by the rectangular subsets
E × E. Then we have the following:
Theorem 3.4.1
Any map L from unit-norm E-measures on X to unit-norm F-measures
on X × X obeying property C is linear for convex linear combinations.
Comment
Since any ﬁnite measure can be scaled to have unit-norm, this implies the
map can be extended to all ﬁnite measures, with the extended map being positively linear.
By the generating property of measures among signed measures as a result of Jordan de-
composition [82], this implies the map can further be extended to a linear map on signed
measures.
Proof
Let L be such a map and µ an unit-norm E-measure on X. For any subsets A,B ∈E,
by the properties of measures,
(Lµ)(A × B) =(Lµ)((A ∩B) × (A ∩B)) + (Lµ)((A ∩B) × (B ∖(A ∩B)))
(3.15)
+ (Lµ)((A ∖B) × B)

CHAPTER 3. HIDDEN CLASSIC AND QUANTUM NODES
28
However, (A ∩B) × (B ∖(A ∩B)) ⊂(A ∩B) × (X ∖(A ∩B)) and (A ∖B) × B ⊂(X ∖B) × B,
so, by property C and its implication,
(Lµ)(A × B) = (Lµ)((A ∩B) × (A ∩B)) = µ(A ∩B) = (Lµ)(B × A)
(3.16)
Let ρ be another unit-norm E-measure on X. Then for any t ∈[0,1], (1 −t)ρ + tµ will be
a unit-norm E-measure on X. Consider the signed measure on X × X given by
νt = L((1 −t)ρ + tµ) −(1 −t)Lρ −tLµ
(3.17)
Take any A ∈E. Then, by property C, νt(A × A) = 0. However, by the above symmetry
property of L,
νt(A × B) = 1
2 (νt(A × B) + νt(B × A))
(3.18)
which is equal to
1
2 (νt((A ∪B) × (A ∪B)) −νt((A ∖B) × (A ∖B))
(3.19)
−νt((B ∖A) × (B ∖A)) + νt((A ∩B) × (A ∩B)))
which is zero by the preceding property of νt. Since A,B were arbitrary, νt must be the zero
measure. ◻
Quantum Copying
The Clone map taking a density matrix on the Hilbert space H to one on H ⊗H is deﬁned
as ρ →ρ ⊗ρ. How to deﬁne a Copy map is not obvious. By analogy to the classical case, it
should have the following properties for any unit-trace density matrix ρ and any projector
E:
Property Q
tr (E ⊗E) Copy ρ = tr (E ⊗IH) Copy ρ = tr (IH ⊗E) Copy ρ = tr Eρ
Note this implies tr (E ⊗(IH −E)) Copy ρ = tr ((IH −E) ⊗E) Copy ρ = 0. Then we have
the following:
Theorem 3.4.2
Any map L from unit-trace density matrices on H to unit-trace density
matrices on H ⊗H obeying property Q is linear for convex linear combinations.
Comment
Since any density matrix can be scaled to have trace one, this implies the map
can be extended to all density matrices with the extended map being positively linear. By
the generating property of density matrices among signed density matrices as a result of the
spectral theorem for compact operators, this implies the map can further be extended to a
linear map.

CHAPTER 3. HIDDEN CLASSIC AND QUANTUM NODES
29
Proof
Let L be such a map and ρ an unit-trace density matrix on H. For any commuting
projectors E, F,
tr (E ⊗F)(Lρ) =tr (EF ⊗EF)(Lρ)
(3.20)
+ tr (EF ⊗(F −EF))(Lρ) + tr ((E −EF) ⊗F)(Lρ)
However, by positivity and the implication of Q,
0 ≤tr (EF ⊗(F −EF))(Lρ) ≤tr (EF ⊗(IH −EF))(Lρ) = 0
(3.21)
and
0 ≤tr ((E −EF) ⊗F)(Lρ) ≤tr ((IH −F) ⊗F)(Lρ) = 0
(3.22)
so, using Q,
tr (E ⊗F)(Lρ) = tr (EF ⊗EF)(Lρ) = tr EFρ = tr (F ⊗E)(Lρ)
(3.23)
Let τ be another unit-trace density matrix on H. Then for any t ∈[0,1], (1 −t)ρ + tτ will
be a unit-trace density matrix on H. Consider the signed density matrix on H ⊗H given by
νt = L((1 −t)ρ + tτ) −(1 −t)Lρ −tLτ
(3.24)
Take any projector E. Then, by property Q, tr (E ⊗E)νt = 0.
However, by the above
symmetry property of L, for any commuting projectors E, F,
tr (E ⊗F)νt = 1
2 (tr (E ⊗F)νt + tr (F ⊗E)νt)
(3.25)
which is equal to
1
2 (tr ((E + F −EF) ⊗(E + F −EF))νt −tr ((E −EF) ⊗(E −EF))νt
(3.26)
−tr ((F −EF) ⊗(F −EF))νt + tr (EF ⊗EF)νt)
which is zero by the preceding property of νt. Since E,F were arbitrary, νt must be the zero
operator. ◻
We then have the following theorem, based on the argument of Wooters and Zurek [126] that
density matrices of rank greater than one can be expressed in more than one way (inﬁnitely
many ways actually) to create a contradiction.
Theorem 3.4.3
There is no quantum Copy map for non-trivial22 H.
22A trivial Hilbert space has dimension one.

CHAPTER 3. HIDDEN CLASSIC AND QUANTUM NODES
30
Proof
Take any orthonormal {u,v} ⊂H with corresponding adjoint operators u∗= ⟨⋅,u⟩H
and v∗= ⟨⋅,v⟩H. Consider ρ = 1
2 (u ⊗u∗+ v ⊗v∗). By linearity,
Copy ρ = 1
2 ( Copy (u ⊗u∗) + Copy (v ⊗v∗))
(3.27)
By property Q, for rank one density matrices Copy must be the same as Clone, so Copy ρ
is uniquely given as
1
2 (u ⊗u ⊗u∗⊗u∗+ v ⊗v ⊗v∗⊗v∗)
(3.28)
However, it is also possible to write ρ as
1
4 ((u + v) ⊗(u + v)∗+ (u −v) ⊗(u −v)∗)
(3.29)
Then Copy ρ is uniquely given as
1
8 ((u + v) ⊗(u + v) ⊗(u + v)∗⊗(u + v)∗
(3.30)
+(u −v) ⊗(u −v) ⊗(u −v)∗⊗(u −v)∗)
= 1
4 (u ⊗u ⊗u∗⊗u∗+ u ⊗u ⊗v∗⊗v∗+ u ⊗v ⊗u∗⊗v∗
+ u ⊗v ⊗v∗⊗u∗+ v ⊗u ⊗u∗⊗v∗+ v ⊗u ⊗v∗⊗u∗+
+v ⊗v ⊗u∗⊗u∗+ v ⊗v ⊗v∗⊗v∗)
(3.31)
Clearly, (3.28) and (3.31) are unequal, which is a contradiction. ◻
3.5
Embedding quantum models into classical ones
A construction for option I’ using atomic measures
For option I’, there is a way to embed quantum behavior into a purely classical, but contex-
tual, model. For any Hilbert space H, let SH be the closed unit ball within H. Let SH/ ∼be
the quotient set formed from SH by the equivalence relation ψ ∼ξ if there is a phase23 w such
that ψ = wξ. Clearly SH/ ∼is in one-to-one correspondence to rank-one projectors on H. Let
E be any σ-algebra on SH/ ∼such that all points are atoms (such as the Borel σ-algebra).
For any set X and base measure µ denote the space of atomic, ﬁnite-norm, L1(X;µ)-valued
vector E-measures on SH/ ∼by A(SH/ ∼;E;L1(X;µ)). This is a Banach space by B6.1.
Given τ ∈A(SH/ ∼;E;L1(X;µ)), for any µ-measurable subset B ⊂X, deﬁne τB to be the
atomic, signed E-measure on SH/ ∼deﬁned by τB(A) = ∫B τ(A)dµ for any A ∈E. Let ∼′ be
23Elements of C with magnitude one.

CHAPTER 3. HIDDEN CLASSIC AND QUANTUM NODES
31
the equivalence relation on A(SH/ ∼;E;L1(X;µ)) given by τ ∼′ χ if, for any µ-measurable
subset B ⊂X,
∫s∈SH/∼ss∗dτB(s) = ∫s∈SH/∼ss∗dχB(s)
(3.32)
Since the equivalence class using ∼′ of zero is a closed, linear subspace, the quotient space
A(SH/ ∼;E;L1(X;µ))/ ∼′ is a Banach space using the standard norm for quotient spaces,
∥[τ]∥= infχ∈[τ] ∥χ∥. Deﬁne the positive cone on the quotient space to be those equivalence
classes with a positive member, using the obvious notion of positivity on A(SH/ ∼;E;L1(X;µ)).
Then we have the following theorem:
Theorem 3.5.1
There is a positive, linear, isometric isomorphism,
L1 (X;µ;D(H)) ≅A(SH/ ∼;E;L1(X;µ))/ ∼′
Proof
If the measure µ is trivial, then L1 (X;µ;D(H)) ≅D(H).
Deﬁne the map Ψ ∶
L1 (X;µ;D(H)) →A(SH/ ∼;E;L1(X;µ))/ ∼′ by Ψ(ρ) being the equivalence class of ∑j ajδ[ψj]
for ρ = ∑j ajψjψ∗
j with countable collections {ψj} ∈SH and {aj} ⊂R, which is always possible
by the spectral theorem for compact operators.
For more general measures on X, ﬁrst start with the observation that, given any ρ ∈
L1 (X;µ;D(H)), each ρ(x) lives in the same separable subspace of H for almost every x with
respect to µ, namely the subspace G that the operator ∫x∈X ∣ρ(x)∣dµ ∈D(H) lives in. Let {ej}
be an orthonormal basis for G. For each j ∈{1,2,...}, let Pj be the orthogonal projector
onto the span of {e1,e2,...,ej}.
Since simple functions (more properly, the “functions”
which are equivalence classes containing simple functions) are norm-dense in L1 (X;µ;D(H)),
the sequence ⟨PjρPj⟩is a Cauchy sequence by C4.3; hence, it converges in norm by the
completeness of the Banach space L1 (X;µ;D(H)). It is readily seen that the limit point
is ρ. Now deﬁne the map Ψ ∶L1 (X;µ;D(H)) →A(SH/ ∼;E;L1(X;µ))/ ∼′ by ﬁrst deﬁning
Ψ(ψψ∗f), for ψ ∈H and f ∈L1(X;µ) to be the equivalence class of the vector measure
f ⊗δ[ψ]. Since the linear space D(PmH) is spanned by the m2 operators
{eje∗
j}j∈{1,...,m} ∪{(ej + ek)(ej + ek)∗,(ej + ıek)(ej + ıek)∗}j,k∈{1,...,m},j<k
(3.33)
the map Ψ can be extended by linearity to all ρ with the property that ρ(x) lives on the
same ﬁnite-dimensional subspace of H for almost every x with respect to µ.
Now take any ρ with this property which is also a simple function. Then, applying the
(ﬁnite-dimensional) spectral theorem to each of the ﬁnitely many values ρ takes, Ψ is readily
seen to be a positive isometry. Since simple functions are norm-dense, by A1.2, Ψ is a
positive isometry on all ρ with the property that ρ(x) lives on the same ﬁnite-dimensional
subspace of H for almost every x with respect to µ. However, by an above argument, such ρ
are norm-dense in L1 (X;µ;D(H)). Hence, using A1.3 to extend Ψ to all of L1 (X;µ;D(H)),
Ψ is a positive isometry. It remains to show it is surjective, but that is easily seen, with
Ψ−1 ([∑
j
fj ⊗δ[ψj]]) = ∑
j
fjψjψ∗
j
(3.34)

CHAPTER 3. HIDDEN CLASSIC AND QUANTUM NODES
32
for any ∑j fj ⊗δ[ψj] ∈A(SH/ ∼;E;L1(X;µ)). ◻
Comment
Since SH×SJ ≇SH⊗J if neither H nor J are trivial, this construction is necessarily
contextual. Therefore, it does not violate Bells’ inequality (see §6.3 below).
The nonexistence of the corresponding construction using a base
measure
The corresponding construction using a base measure ν would be for there to be a positive
isometry from L1(X;µ;D(H)) to a quotient space of some L1(Y;ν). This is impossible, as
the following theorem shows:
Theorem 3.5.2
If the Hilbert space H is non-trivial, there are no: (i) set Y; (ii) σ-ﬁnite
measure ν; and (iii) equivalence relation ∼induced by a closed, linear subspace B ⊂L1(Y;ν)–
such that there is a positive, linear isomorphism, Ψ ∶L1 (X;µ;D(H)) →L1(Y;ν)/ ∼, which
is also an isometry on the positive cone.
Proof
Suppose otherwise. Then there is a L1 (X;µ;D(H))-valued vector measure τ on Y
provided by τ(A) = Ψ−1 ([1A]) for any ν-measurable subset A ⊂Y. The spaces L1(Y;ν)∗≅
L∞(Y;ν) by Riesz’s theorem [83]. The dual to L1(Y;ν)/ ∼is provided by the annihilator B⊥:
the closed, linear subspace of L∞(Y;ν) that annihilates B. (Note, in particular that since Ψ
is an isometry on the positive cone, the constant “function” [1Y] ∈B⊥.) Therefore, there is
an adjoint map Ψ∗∶B⊥→L1 (X;µ;D(H))∗given by
∫Y f Ψρdν = (Ψ∗f)ρ
(3.35)
for any f ∈B⊥and ρ ∈L1 (X;µ;D(H)). By the basic properties of Banach spaces, (Ψ∗)−1 =
(Ψ−1)∗, Ψ∗is positive, and Ψ∗is an isometry on the positive cone.
Then,
∫A Ψ∗−1Φdν = Φ(τ(A))
(3.36)
for any linear functional Φ ∈L1 (X;µ;D(H))∗and ν-measurable subset A ⊂Y. For IH the
identity operator, Ψ∗−1 (IH1X) is the element of B⊥that agrees with the norm when integrated
with any positive “function” in L1(Y;ν)/ ∼; hence, it must be 1Y. Therefore,
∫X tr τ(A)dµ = ∫A Ψ∗−1 (IH1X) dν = ν(A)
(3.37)
However, this gives rise to a contradiction. Fix some subset B ⊂X with 0 < µ(B) < ∞.
Take any unit norm ψ ∈H. Since Ψ is positive, by deﬁnition, the equivalence class Ψ(ψψ∗1B)
has a positive member, call it gψ. There must be some ψ ≠ξ such that A = {gψ > 0}∩{gξ > 0}
has strictly positive ν-measure; otherwise, there would be an uncountable collection {gψ > 0}

CHAPTER 3. HIDDEN CLASSIC AND QUANTUM NODES
33
indexed by unit norm ψ ∈H of subsets of Y, each with strictly positive ν measure, but whose
pairwise intersections all have ν-measure zero.
The existence of such a collection would
contradict ν being σ-ﬁnite by B1.6. Since Ψ is an isometry on the positive cone,
∫Y gψ dν = µ(B)tr Iψψ∗= µ(B) = µ(B)tr ψψ∗ψψ∗= ∫y∈Y gψ(y)d⟨τψ,ψ⟩(y)
(3.38)
Hence, ⟨τψ,ψ⟩≤tr τ = ν must be equal to ν when restricted to {gψ > 0} ⊃A. By a similar
argument, ⟨τξ,ξ⟩must must be equal to ν when restricted to {gξ > 0} ⊃A. These conditions
are impossible to satisfy. ◻
The special case of two-dimensional Hilbert spaces
It is possible to circumvent the conclusion of the preceding theorem if the positive isomor-
phism is with a closed, linear subspace of L1(Y;ν)/ ∼. Specialize to Y = X ×Z and ν = µ×η and
let C be the closed, linear subspace of L1(X ×Z;µ×η)/ ∼. Using the notation of the preceding
proof, let ∼′ be the equivalence relation on the annihilator B⊥⊂L∞(X ×Z;µ×η) induced by
the annihilator C⊥⊂L∞(X × Z;µ × η), so f ∼′ g if ∫X×Z[h]f d(µ × η) = ∫X×Z[h]g d(µ × η) for
all [h] ∈L1(X × Z;µ × η)/ ∼. From the proof of the preceding theorem, it is then necessary
that Ψ∗−1(IH1X) = [1X×Z]. A suﬃcient way to accomplish this would be for there to be a
positive map (not necessarily linear in ψψ∗) Λ ∶SH/ ∼phase→L∞(Z;η), where ∼phase is the
equivalence relation on SH given above, such that
Ψ∗−1(ψψ∗1X) = [1X ⊗Λ(ψ)] for all ψ ∈SH/ ∼phase
(3.39)
and, for almost every z ∈Z with respect to η, the map ψ →Λ(ψ)(z) is a frame function with
weight one24.
For H of dimension two, we then have the following based on a construction by Kochen
and Specker [39]. Let ω be the usual measure on the sphere S2 ⊂R3, so, with Cartesian
coordinates (x1,x2,x3) for R3,
ω(A) = ∫(x1,x2,x3)∈A = (x1 dx2 ∧dx3 −x2 dx1 ∧dx3 + x3 dx1 ∧dx2)
(3.40)
for any Borel subset A ⊂S2. Let ∼be the equivalence relation on L1(X × S2;µ × ω) given
by f ∼g if ∫B×H f d(µ × ω) = ∫B×H g d(µ × ω) for all µ-measurable subsets B ⊂X and all
hemispheres H ⊂S2 (whether the hemispheres are taken open or closed is irrelevant). Equip
the quotient space L1(X × S2;µ × ω)/ ∼with a norm in the usual way via ∥[f]∥= infg∈[f] ∥g∥.
Deﬁne the positive cone on L1(X × S2;µ × ω)/ ∼by those equivalence classes that contain a
positive element of L1(X × S2;µ × ω).
Theorem 3.5.3
There is a positive, linear isometry, Ψ ∶L1 (X;µ;D(H)) →L1(X × S2;µ ×
ω)/ ∼with an associated map Λ ∶SH/ ∼phase→L∞(S2;ω) with the above properties.
24A function f ∶SH/ ∼phase→R is a frame function with weight w if it is zero except for a separable
subspace of H and ∑j f(ej) = w for any orthonormal basis {ej} of that subspace.

CHAPTER 3. HIDDEN CLASSIC AND QUANTUM NODES
34
Proof
Take any orthonormal basis {e1,e2} for H ≅C2. Let Ψ ∶L1 (X;µ;D(H)) →L1(X ×
S2;µ × ω)/ ∼be given by ﬁrst taking Ψ on elements of the form ψψ∗f for ψ ∈SH and
f ∈L1(X;µ) to be the equivalence class of the positive “function”
f ⋅
⎧⎪⎪⎪⎨⎪⎪⎪⎩
1
πys
if ys > 0
0
otherwise
(3.41)
for y = [ ∣ψ1∣2 −∣ψ2∣2
R2ψ1ψ2
I2ψ1ψ2 ] and s =
⎡⎢⎢⎢⎢⎢⎣
s1
s2
s3
⎤⎥⎥⎥⎥⎥⎦
S2 ∈
where ψj = ⟨ψ,ej⟩.
Since H is two-dimensional, D(H) is four-dimensional, with basis
{e1e∗
1,e2e∗
2,(e1+e2)(e1+e2)∗,(e1+ıe2)(e1+ıe2)∗}. Therefore, Ψ can be extended by linearity
to all of L1 (X;µ;D(H)).
For ρ a simple function, by using the spectral theorem for the each of the ﬁnite num-
ber of values ρ attains, the map Ψ is readily seen to be positive and an isometry. Since
simple functions (more properly, the “functions” containing simple functions) are dense in
L1 (X;µ;D(H)), by A1.2, Ψ is a positive isometry for all of L1 (X;µ;D(H)).
For this Ψ, an associated Λ does exist. It is given by ﬁrst deﬁning
zT = [ ∣ξ1∣2 −∣ξ2∣2
R2ξ1ξ2
I2ξ1ξ2 ] ⇔ξ ∝
√
1 + z1
2
e1 +
z2 + ız3
√
2(1 + z1)
e2
(3.42)
where the proportionality for ξ is up to an irrelevant phase.
Then Λ(ξ) = 1Hz, where
Hz is the hemisphere centered at z.
This has the required properties since (i) for any
orthonormal {ξ,ζ}, Λ(ξ) + Λ(ζ) = 1Hz + 1H−z = 1S2, with equality in the L∞(S2;ω)-sense of
almost everywhere with respect to ω and (ii) for any ξ,ψ ∈SH and f ∈L1(X;µ),
∫X×S2 (1X ⊗Λ(ξ))Ψ(ψψ∗f)d(µ × ω) = 1
2(1 + yz)(∫X f dµ) = ∣⟨ξ,ψ⟩∣2 (∫X f dµ)
◻
However, for Hilbert space H of dimension greater than two, there is no construction of this
form because Gleason proved [29] that all frame functions on Hilbert spaces of dimension
greater than two are regular25.
Theorem 3.5.4
There are no: (i) set Z; (ii) σ-ﬁnite measure η; and (iii) equivalence
relation ∼induced by a closed, linear subspace B ⊂L1(X × Z;µ × η)–such that there is a
positive, linear isometry, Ψ ∶L1 (X;µ;D(H)) →L1(X × Z;µ × η)/ ∼, which has an associated
map Λ ∶SH/ ∼phase→L∞(Z;η) with the properties given above.
25A frame function is regular if it is given by ψ →⟨Tψ,ψ⟩for some trace-class, self-adjoint operator T.

CHAPTER 3. HIDDEN CLASSIC AND QUANTUM NODES
35
Proof
Suppose otherwise. By Gleason’s result, there is a T ∈L1(Z;η;D(H)+) such that
T(z) has trace one for almost every z ∈Z with respect to η and
∫X×Z (1X ⊗⟨Tξ,ξ⟩)Ψ(ψψ∗1B)d(µ × η) = ∣⟨ξ,ψ⟩∣2µ(B)
(3.43)
for all ψ,ξ ∈SH/ ∼phase and µ-measurable B ⊂X. However, then following the argument of
theorem 3.5.2, there is a contradiction. Fix some subset B ⊂X with 0 < µ(B) < ∞. Take
any unit norm ψ ∈H. Since Ψ is positive, by deﬁnition, the equivalence class Ψ(ψψ∗[1B]) has
a positive member, call it gψ. There must be some ψ ≠ξ such that A = {gψ > 0}∩{gξ > 0} has
strictly positive ν-measure (Since gψ,gξ are “functions”, A is actually an equivalence class
of sets that diﬀer by sets of ν-measure zero). Since Ψ is an isometry on the positive cone,
∫X×Z gψ d(µ × η) = µ(B)tr Iψψ∗= µ(B) = µ(B)tr ψψ∗ψψ∗
(3.44)
= ∫X×Z (1X ⊗⟨Tψ,ψ⟩)gψ d(µ × η)
Hence, ⟨Tψ,ψ⟩≤tr T = 1 must be equal to one almost everywhere with respect to η when
restricted to {gψ > 0} ⊃A (once again, this is actually an equivalence class of sets that
diﬀer by sets of ν-measure zero). By a similar argument, ⟨Tξ,ξ⟩≤tr T = 1 must be equal
to one almost everywhere with respect to η when restricted to {gξ > 0} ⊃A (also actually
an equivalence class of sets that diﬀer by sets of ν-measure zero). These conditions are
impossible to satisfy. ◻
A construction for option II
For option II, there is also a way to embed quantum behavior into a purely classical, but
contextual, model. For any Hilbert space H, let BH be the closed unit ball within H. Equip
BH with the weak topology; denote the resulting space by Bweak
H
. Since Hilbert spaces are
reﬂexive, with H∗≅H by Riesz’s theorem [84], then this is the same as the weak* topology, so
by Alaoglu’s theorem [85], Bweak
H
is a compact space. Furthermore, it is Hausdorﬀsince, given
any distinct points b0,b1, there are separating weak neighborhoods N (b0;b1 −b0; 1
2∥b0 −b1∥2)
and N (b1;b1 −b0; 1
2∥b0 −b1∥2).
Then, for any compact, Hausdorﬀspace X, we have the following theorem:
Theorem 3.5.5
There is a positive, isometric isomorphism between C (X;K(H)) and a
closed, linear subspace of C (X × Bweak
H
).
Proof
Consider the map Ψ ∶C (X;K(H)) →C (X × Bweak
H
) given by
(Ψϕ)(x,b) = ⟨ϕ(x)b,b⟩
(3.45)
The map Ψ is clearly both positive and an isometry. From the latter property, its image is
a closed, linear subspace. The functions in the image of the map are also clearly continuous

CHAPTER 3. HIDDEN CLASSIC AND QUANTUM NODES
36
in x; the following lemma shows that they are continuous in b, so, as claimed above, they
are indeed continuous functions. ◻
Lemma 3.5.6
For any compact operator φ ∈K(H), the map Φ ∶Bweak
H
→R given by
Φ(b) = ⟨φb,b⟩is continuous.
Proof
First take the case of φ positive and rank one, so φ = ψψ∗for some ψ ∈H. Then,
given any b0 ∈BH and ε > 0, there is a weak neighborhood N (b0;ψ;
√
∣⟨ψ,b0⟩∣2 + ε −∣⟨ψ,b0⟩∣)
such that for every b in the neighborhood, using the triangle inequality repeatedly,
∣Φ(b) −Φ(b0)∣= ∣∣⟨ψ,b⟩∣2 −∣⟨ψ,b⟩∣2∣≤(∣⟨ψ,b⟩∣+ ∣⟨ψ,b0⟩∣)∣⟨ψ,b⟩−⟨ψ,b0⟩∣
(3.46)
< (∣⟨ψ,b⟩∣+ ∣⟨ψ,b0⟩∣)(
√
∣⟨ψ,b0⟩∣2 + ε −∣⟨ψ,b0⟩∣)
< (2∣⟨ψ,b0⟩∣+
√
∣⟨ψ,b0⟩∣2 + ε −∣⟨ψ,b0⟩∣)(
√
∣⟨ψ,b0⟩∣2 + ε −∣⟨ψ,b0⟩∣)
which is equal to ε.
Since ﬁnite rank operators are norm-dense in K(H), for any φ ∈K(H) and ε > 0 there
is are ﬁnite collections {ψj} ⊂SH (for SH the unit sphere in H) and {aj} ⊂R such that
∥φ −∑n
j=1 ajψjψ∗
j ∥op ≤1
2ε. Then, by the triangle equality and the above result, for every b in
the neighborhood
n
⋂
j=1
N ⎛
⎝b0;ψj;
√
∣aj∣∣⟨ψj,b0⟩∣2 + 1
2nε −
√
∣aj∣∣⟨ψ,b0⟩∣⎞
⎠
(3.47)
we have ∣Φ(b) −Φ(b0)∣< ε. ◻
Comment
Since BH×BJ ≇BH⊗J if neither H nor J are trivial, this construction is necessarily
contextual. Therefore, it does not violate Bells’ inequality (see §6.3 below). Also, for H ﬁnite-
dimensional, it is possible to use SH instead of BH and the norm topology (which is equivalent
to the weak topology in ﬁnite dimensions). In this case, it is also possible to further reduce
the space by the equivalence relation on SH used in the preceding construction for option I.
3.6
Embedding classical models into quantum ones
For σ-algebras generated by a countable collection of atoms, using option I’ it is always
possible to duplicate classical behavior using quantum nodes; one simply embeds L1(X;µ)
as the diagonal operators in D(L2(X;µ))+. Similarly, using option II, if X is a ﬁnite set
of points with the discrete topology, C(X) can be embedded as the diagonal operators in
K(L2(X;counting measure))+.
By 5.28, this is the only way to linearly embed L1(X;µ)+ in D(L2(X;µ))+ if we want
to take advantage of the one-to-one correspondence between functions 1B in L∞(X;µ) ≅

CHAPTER 3. HIDDEN CLASSIC AND QUANTUM NODES
37
L1(X;µ)∗and the orthogonal projectors PB ∈B(L2(X;µ)) to the subspace of “functions”
zero almost everywhere outside B provided by the the map diag* deﬁned in the comment
following B5.19. However, if the measure has an inﬁnitely-divisible part, then unless f ∈
L1(X;µ)+ is zero on this part, by B4.3 there is no corresponding diagonal operator in
D(L2(X;µ))+.
One alternative is the map diag−1 into equivalence classes of trace-class
operators with common diagonals deﬁned in B5.17 and used in §5.1 below.
3.7
Classical physics
Classical mechanics
Another approach, which is that of classical mechanics, is to not completely duplicate quan-
tum behavior, but instead approximate it. The key is to recognize that L1(T ∗X;Ω)+ inter-
sects the Hilbert space L2(T ∗X;Ω). Similarly, D(L2(X;µ))+ intersects the Hilbert space26
S2(L2(X;µ)), which is isomorphic to L2(X × X;µ × µ). Therefore, if we have an isomor-
phism Ψ between L2(T ∗X;Ω) and L2(X × X;µ × µ), we can associate some of the elements
of L1(T ∗X;Ω)+ with those in D(L2(X;µ))+.
For X = Rn and µ mutually absolutely continuous with respect to Lebesgue measure λ,
this is indeed possible, with f(q,p) = (Ψρ)(q,p) given by
1
(π̷h)n ∫u∈Rn exp(−2ıp ●u
̷h
)ρ(q + u,q −u)
√
dµ
dλ(q + u)
√
dµ
dλ(q + u)dλ(u)
(3.48)
and inverse ρ(x,x′) = (Ψ−1f)(x,x′) = (π̷h)n(Ψ∗f)(x,x′) given by
√
dλ
dµ(x)
√
dλ
dµ(x′)∫p∈Rn exp(ıp ●(x −x′)
̷h
)f (x + x′
2
,p) dλ(p)
(3.49)
Intuitively, f ∈L1(T ∗X;Ω)+ will be paired with some ρ ∈D(L2(X;µ))+ if ρ is very close
to being diagonal and varies slowly along the diagonal whereas f obeys a local version of
Heisenberg’s uncertainty relation, with sharp features in q being spread out in p and vice
versa. Also, these pairs exist for the ground state of the harmonic oscillators, despite ρ
not being very close to being diagonal. Note that when these pairs exist, as a map from
D(L2(X;µ))+ to L1(T ∗X;Ω)+, Ψ is actually an isometry.
Two observations arise from this.
Firstly, if we believe that a quantum description
gives better predictions and that a formulation in terms of classical physics is merely an
approximation, then the classical predictions are completely untrustworthy for non-integrable
classical systems where f rapidly develops ﬁne tendrils under time evolution. Evolving the
quantum analogue of the system and then using Ψ would give very diﬀerent behavior. Either
the ﬁne tendrils would not form or the correlation would break down, with f = Ψρ no longer
26S2 denotes the Hilbert-Schmidt operators.

CHAPTER 3. HIDDEN CLASSIC AND QUANTUM NODES
38
being positive. Secondly, classical physics is simpler than quantum mechanics only because
the time evolution for a Hamiltonian system is so simple, being merely a point transformation
on a ﬁnite dimensional space, T ∗X →T ∗X. Working with full stochastic generality using
non-Hamiltonian systems in classical physics, the analogous quantum description is no more
complicated.
The preceding is evidently dependent on the existence of Lebesgue measure. Since there
is no inﬁnite-dimensional analogue of Lebesgue measure [63], it cannot be extended directly
to ﬁeld theories. Instead, some measure which itself depends on ̷h must be utilized.
Distinguishable versus indistinguishable particles
It is usually said that there are no indistinguishable particles classically because it is possible
to follow trajectories, which are the time-evolution point transformations T ∗X →T ∗X. The
above analysis gives a diﬀerent interpretation that is valid in the more general case where
there are no trajectories: if indistinguishability is important in a model, so the density matrix
ρ is taken symmetric (or anti-symmetric) under interchange,
ρ(x1,x2,x′
1,x′
2) = ±ρ(x2,x1,x′
1,x′
2) = ±ρ(x1,x2,x′
2,x′
1) = ρ(x2,x1,x′
2,x′
1)
(3.50)
then it is necessarily far from being diagonal, so there is likely no partner in L1(T ∗X;Ω)+
to ρ and a classical model is invalid.
A similar situation holds for the case of σ-algebras generated by a countable collection
of atoms. If there is classical indistinguishability (such as dollars in a bank account), the
measures assigned to certain atoms by any allowed measure must be the same. No issues
are raised by embedding the measure as the diagonal in D(L2(X;µ))+. However, trying to
recast this as quantum indistinguishability then creates oﬀ-diagonal entries without classical
interpretation.
3.8
Additional structures for Bayesian networks?
It may be possible that additional mathematical structures besides measures and density
matrices could be used as the base and target spaces of linear maps to calculate probabilities
using Bayesian networks. To avoid topological complications, only the ﬁnite-dimensional case
will be sought. Looking through the properties of measures and density matrices that are
essential, we have the following properties required for an additional mathematical structure,
given by a collection A of ﬁnite-dimensional, normed vector spaces: (i)for any vector spaces
A,B ∈A, the vector space A ⊗B is also in A; (ii) each B ∈A has a positive cone, B+ that
is generating27; (iii) each B ∈A has the quasi-AL-property that ∥x∥+ ∥y∥= ∥x + y∥for any
x,y ∈B+; and (iv) for any x ∈A+, y ∈B+, x ⊗y is in (A ⊗B)+ with ∥x ⊗y∥= ∥x∥∥y∥.
In addition, (v) it is required that there be some nontrivial (other than the identity) maps
27Any x in each B ∈A can be written as y −z for some y,z ∈B.

CHAPTER 3. HIDDEN CLASSIC AND QUANTUM NODES
39
between these vector spaces that are simultaneously both completely positive and completely
bounded.
Evidently, for measures A is a collection of n-dimensional vector spaces for n a natural
number, {1,2,3,...}. For density matrices it is a collection of n-dimensional vector spaces
for n a square number, {1,4,9,...}. The question, which is open, is whether there are a
collection of vector spaces A satisfying the preceding properties other than spaces isomorphic
to measures, density matrices, or various tensor products of measures and density matrices.
Obviously, this question is of vital interest–if the answer is negative, then we are limited to
linear maps on measures, density matrices, and their tensor products in formulating Bayesian
networks; if the answer is aﬃrmative, then there is the immediate additional question of
whether or not the additional structure is of practical utility in making predictions.

40
Chapter 4
Constructing the networks
4.1
Graphical constructs and rules
Recall the graphical model simply gives the form for the needed information and illustrates
constraints. The actual needed data is given in an accompanying table. In the following,
ﬁrst the rules for the graphical model are given, then what accompanying data needs to be
supplied depending on which option, I’ or II, is chosen.
Nodes and terminators
Nodes that are observable, with the traditional emphasis on the transition probability func-
tion, will be indicated in black. Hidden classical nodes, where the linear map on measures is
taken to be fundamental, will be red. Quantum nodes, whose linear maps involve non-trivial
spaces of density matrices, will be blue. Arrows share the color of their parent. Observable
nodes that are being incorporated into the calculation of probability will be crossed. Those
that are being marginalized will be left open. Those that are being conditioned on will be
ﬁlled. Hidden (classical or quantum) nodes will always be left open. To make it visually
clear whether or not a graph is complete and represents the calculation of a number (the
probability) or is just a graph fragment with unresolved maps, terminal nodes which are
either maps from the trivial space (giving initialization) or to the trivial space (giving the
evaluation map) will be indicated by half-circle-half-box shapes, with the half-box being the
terminating end.

	
-


-
(4.1)

CHAPTER 4. CONSTRUCTING THE NETWORKS
41
Splitters
As has been pointed out (see §2.4), the usual Bayesian network construction depends heavily
on the ability to copy, with each child node receiving a copy. Without this ability (see §3.2
and §3.4), an additional graphical structure is required, the splitter. This is an oval with
one or more arrows coming in and more than one arrow coming out–if only one arrow comes
out, the splitter can be dispensed with and all the incoming arrows can be redirected to the
following node.


 
-
HHHH
j
-

*
(4.2)
Pince-nez
There is a certain construction that occurs so often for joining hidden nodes to observable
ones that it is replaced by its own structure, the pince-nez. As the name suggests, this is
two circles, one an observable node, the other a hidden one, joined by a bar.
m
1
Ô⇒
m
1
HHH
j

1
@@
R m


 
mPPPP
q
-
- HHH
j
-
(4.3)
The neutral term pince-nez is employed since the concept of “measurement”1 applied to
hidden nodes is so fraught with metaphysical connotations.
4.2
Data for the structures using Option I’
Using option I’, for each hidden node, the most general data is
(I,µ,H;O,ν,J;L)
where I is the input set, µ the accompanying base measure, H the input Hilbert space,
O the output set, ν the accompanying base measure, J the output Hilbert space, and L a
completely-positive, norm-preserving (on the positive cone) map in B(L1(I;µ;D(H)),L1(O;
ν;D(J))). If either Hilbert spaces are the trivial space C, it can be left oﬀthe list. Similarly,
if either base measure is trivial, for instance, if µ(∅) = 0, µ(I) = 1 with no other sets
measurable, then it and its set can be left out as well.
1We will always place “measurement” in quotation marks to emphasize its problematic nature.

CHAPTER 4. CONSTRUCTING THE NETWORKS
42
For each splitter, the most general data is
(I,µ,H;O1,ν1,J1,...,Om,νm,Jm;Ψ)
where I ≅O1 ×⋯×Om, µ ≅ν1 ×⋯×νm, and H ≅J1 ⊗⋯⊗Jm, with Ψ giving the isomorphisms,
which should be trivial except for possible permutations to make sure everything goes to the
correct place, with more complicated behavior placed in separate nodes. Once again, trivial
entries can be left out.
For each pince-nez, the most general data is
(I,µ,H;R,τ;O,ν,J;L)
where I is the input set, µ the accompanying base measure, H the input Hilbert space, R
the observable set, τ the accompanying base measure, O the output set, ν the accompanying
base measure, J the output Hilbert space, and L a completely-positive, norm-preserving (on
the positive cone) map in B (L1(I;µ;D(H)),L1(R × O;τ × ν;D(J))). Again, trivial entries
can be left out (however, if τ is trivial, then the pince-nez is actually just a node).
4.3
Data for the structures using Option II
Using option II, for each hidden node, the most general data is
(I,H;O,J;L)
where I is the input compact space, H the input Hilbert space, O the output compact
space, J the output Hilbert space, and L a completely-positive, norm-preserving (on the
positive cone) map in B (C(O;K(J)),C(I;K(H))). As previously noted, the spaces can be
locally-compact if L is further restricted. Trivial entries can be left oﬀthe list.
For each splitter, the most general data is
(I,H;O1,J1,...,Om,Jm;Ψ)
where I ≅O1 × ⋯× Om with the product topologies agreeing as well, and H ≅J1 ⊗⋯⊗Jm,
with Ψ giving the isomorphisms, which should be trivial except for possible permutations to
make sure everything goes to the correct place, with more complicated behavior placed in
separate nodes. Once again, trivial entries can be left out.
For each pince-nez, the most general data is
(I,H;R;O,J;L)
where I is the input compact space, H the input Hilbert space, R the observable compact
space, O the output compact space, J the output Hilbert space, and L a completely-positive,
norm-preserving (on the positive cone) map in B (C(R × O;K(J)),C(I;K(H))). As previ-
ously noted (see §3.2), the spaces can be locally-compact if L is further restricted. Again,
trivial entries can be left out (however, if R is trivial in the sense of being the one-point set,
then the pince-nez is actually just a node).

CHAPTER 4. CONSTRUCTING THE NETWORKS
43
4.4
Example-double-slit experiment
So far, the exposition has been quite abstract. To make things more concrete and demon-
strate how to use Bayesian networks with linear maps (both classical and quantum) in
practice, consider the following example. There is a black-box with a dial which can be set
to any position θ on a circle, a switch with two settings, and four lights, with lights one and
two forming one pair and lights three and four forming another. After study, it is determined
to have the following properties: if the switch is oﬀ, periodically one of the second pair of
lights ﬂashes while the ﬁrst pair never ﬂashes, whereas, if the switch is on, one of each pair
ﬂashes. After more study, it is determined the behavior of each round is independent and,
if the switch is oﬀ, with probability cos2 θ the third light alone ﬂashes and with probability
sin2 θ the fourth light alone ﬂashes. If the switch is on, the joint probabilities are as follows:
ﬁrst on, third on, others oﬀ
1
4
ﬁrst on, fourth on, others oﬀ
1
4
second on, third on, others oﬀ
1
4
second on, fourth on, others oﬀ
1
4
(4.4)
with the other probabilities being zero. Presenting the information in the manner of the
preceding joint probabilities corresponds to the following graphical model:
m
m
}
}
dial
switch
ﬁrst pair of lights
second pair of lights
HHHHHHH







(4.5)
Suppose the box is now opened and is found to be composed of ﬁve modules. A cable
runs from the ﬁrst module to the second. Two cables come from the second module, one
each running to a pair of seemingly identical modules, each of which has one of the ﬁrst pair
of lights. The switch activates switches on the pair in unison. These modules have cables
running to the last, which has the dial as a control. If possible, given the joint probabilities,
we should conﬁne ourselves to models which are consistent with the constraints implied by
these observations because we would like to be able to predict what would happen if these
modules were rewired or taken out and placed in a diﬀerent context.

CHAPTER 4. CONSTRUCTING THE NETWORKS
44
4.5
Quantum model
Consider ﬁrst a quantum model with graphical model:

	
-
1
m
2
-


 
3

*
HHHHHHHH
j m
5
m
4

*
PPPPPPPPPP
q

6
m
m
m
second light
ﬁrst light
third and fourth
light
}
}
Θ
S
J
J
JJ^





-
(4.6)
The blue 1,2,3,4,5,6 are for reference. The information presented in the form indicated by
the graphical model is as follows:
node 1
(;C2;L1), where L1 is the constant map with value [
1
√
2
1
√
2
][
1
√
2
1
√
2 ] = [
1
2
1
2
1
2
1
2
].
node 2
(C2;C4;L2), where L2(ρ) is
⎡⎢⎢⎢⎢⎢⎢⎢⎣
0
0
0
0
0
0
ρ
0
0
0
0
0
0
⎤⎥⎥⎥⎥⎥⎥⎥⎦
(4.7)
splitter 3
(C4;C2,C2)
pince-nez 4
⎛
⎜⎜⎜
⎝
{ switch on,
switch oﬀ}, counting
measure ,C2;
⎧⎪⎪⎪⎪⎪⎨⎪⎪⎪⎪⎪⎩
light one on and switch on,
light one on and switch oﬀ,
light one oﬀand switch on,
light one oﬀand switch oﬀ,
⎫⎪⎪⎪⎪⎪⎬⎪⎪⎪⎪⎪⎭
, counting
measure ;C2;L4
⎞
⎟⎟⎟
⎠
(4.8)

CHAPTER 4. CONSTRUCTING THE NETWORKS
45
where L4(τ) is
⎧⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎨⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎩
τ∣switch oﬀ
if light one oﬀand switch oﬀ
0
if light one on and switch oﬀ
⎡⎢⎢⎢⎢⎣
1
0
0
0
⎤⎥⎥⎥⎥⎦
τ∣switch on
⎡⎢⎢⎢⎢⎣
1
0
0
0
⎤⎥⎥⎥⎥⎦
if ﬁrst on and switch on
⎡⎢⎢⎢⎢⎣
0
0
0
1
⎤⎥⎥⎥⎥⎦
τ∣switch on
⎡⎢⎢⎢⎢⎣
0
0
0
1
⎤⎥⎥⎥⎥⎦
if ﬁrst oﬀand switch on
(4.9)
pince-nez 5
Same as for pince-nez 4 except the second light replaces the ﬁrst light.
pince-nez 6
⎛
⎜⎜⎜
⎝
[0,2π), Lebesgue
measure
,C4;
⎧⎪⎪⎪⎪⎪⎨⎪⎪⎪⎪⎪⎩
third and fourth on,
third on,
fourth on,
third and fourth oﬀ
⎫⎪⎪⎪⎪⎪⎬⎪⎪⎪⎪⎪⎭
, counting
measure ;;L6
⎞
⎟⎟⎟
⎠
where L6(τ) is
∫
2π
0
[ 1
0
0
0 ]τ(θ)
⎡⎢⎢⎢⎢⎢⎢⎢⎣
1
0
0
0
⎤⎥⎥⎥⎥⎥⎥⎥⎦
dθ if both third and fourth on
(4.10)
∫
2π
0
[ 0
1
√
2eıθ
1
√
2e−ıθ
0 ]τ(θ)
⎡⎢⎢⎢⎢⎢⎢⎢⎢⎣
0
1
√
2e−ıθ
1
√
2eıθ
0
⎤⎥⎥⎥⎥⎥⎥⎥⎥⎦
dθ if third on
∫
2π
0
[ 0
1
√
2eıθ
−1
√
2e−ıθ
0 ]τ(θ)
⎡⎢⎢⎢⎢⎢⎢⎢⎢⎣
0
1
√
2e−ıθ
−1
√
2eıθ
0
⎤⎥⎥⎥⎥⎥⎥⎥⎥⎦
dθ if fourth on
∫
2π
0
[ 0
0
0
1 ]τ(θ)
⎡⎢⎢⎢⎢⎢⎢⎢⎣
0
0
0
1
⎤⎥⎥⎥⎥⎥⎥⎥⎦
dθ if both third and fourth oﬀ
Using this information, the joint probability, given that the switch is oﬀand the dial is set

CHAPTER 4. CONSTRUCTING THE NETWORKS
46
to θ, for both the ﬁrst pair being oﬀ, the third light being on, and the fourth light being oﬀ,
is then given by, for positive, unit-norm g ∈L1([0,2π),Lebesgue),
L6
⎛
⎝(L4 ⊗L5)(L2 (L1)1switch oﬀ)∣ﬁrst pair is oﬀ,
switch is oﬀ
g⎞
⎠
RRRRRRRRRRRR third is on,
fourth is oﬀ
(4.11)
= ∫
2π
0
RRRRRRRRRRRRRRRRRRR
[ 0
1
√
2eıθ′
1
√
2e−ıθ′
0 ]
⎡⎢⎢⎢⎢⎢⎢⎢⎢⎣
0
1
√
2
1
√
2
0
⎤⎥⎥⎥⎥⎥⎥⎥⎥⎦
RRRRRRRRRRRRRRRRRRR
2
g(θ′)dθ′ = ∫
2π
0
cos2 θ′ g(θ′)dθ′
(4.12)
For g suﬃciently peaked about θ, the result is approximately cos2 θ.
Similarly, the joint probability, given that the switch is on and the dial is set to θ, for
both the ﬁrst and the third light being on, with the second and fourth being oﬀ, is then
given by
L6
⎛
⎜⎜⎜
⎝
(L4 ⊗L5)(L2 (L1)1switch on)∣ﬁrst is on,
second is oﬀ
switch is on
g
⎞
⎟⎟⎟
⎠
RRRRRRRRRRRRRRRRRR third is on,
fourth is oﬀ
(4.13)
= ∫
2π
0
RRRRRRRRRRRRRRRRRRR
[ 0
1
√
2eıθ′
1
√
2e−ıθ′
0 ]
⎡⎢⎢⎢⎢⎢⎢⎢⎣
0
1
√
2
0
0
⎤⎥⎥⎥⎥⎥⎥⎥⎦
RRRRRRRRRRRRRRRRRRR
2
g(θ′)dθ′ = 1
4
(4.14)
The other joint probabilities can be calculated similarly and agree with the joint probabilities
originally determined for the black box.
Comments on the use of option I’
Note the use of option I’ leads to extra complexity concerning the dial position Θ, forcing
the introduction of a function g peaked at θ, although in this example we are not concerned
about modelling the uncertainty of that value. In this case, using option II would have
been slightly simpler. Then, instead of using counting measure as the base measure on the
discrete sets, the discrete topology would be used to make the discrete sets into compact
spaces.
4.6
The Bayesian network approach versus the
standard textbook approach
Interpreting the switch as controlling the operation of a position “measurement” at two
slits and the dial as selecting a point on a backing screen for another position “measure-

CHAPTER 4. CONSTRUCTING THE NETWORKS
47
ment”, there is a well-known standard textbook approach using wavefunctions, projectors,
and Bohm’s postulate that replicates the outcome. By comparison, the Bayesian network
for this particular problem may appear cumbersome; however, that is largely a result of
familiarity with the ﬁrmer. With the network approach, there are none of the seemingly ad
hoc rules for dealing with quantum systems; instead, only the simple conditions of positivity,
linearity and potential universality. Also, the graphical model is highly intuitive and guides
the writing of the correct expression (4.13). This is of great importance in dealing with more
complicated systems.
In addition, as will be illustrated by more complicated examples to follow (see §7.4), the
network approach is far more ﬂexible. Of particular interest, in some special cases it allows
the needed Hilbert spaces to be kept to reasonable sizes in the course of the calculation
instead of ballooning exponentially. To be more explicit, for a Hilbert space of dimension n,
the space of operators has dimension of order n2, and the space of maps on these operators
has dimension of order n4, which is why it appears cumbersome. However, if, by utilizing
the ﬂexibility of the network approach, one is able to avoid dealing with Hilbert spaces of
dimension nN and operator spaces of dimension n2N, where N is the number of particles,
the potential savings is tremendous (as will be seen in §7.4).
4.7
Classical hidden model
For the same black box, now consider a classical hidden model with the same graphical model
(4.6) (except now the hidden nodes and connecting arrows will be red).
For simplicity,
functions on discrete spaces indexed by numbers will be given as column vectors.
The
information presented in the form indicated by the graphical model is as follows:
node 1
(;{1,2}, counting
measure ;L1), where L1 is the constant map with value [
1
21
2
].
node 2
({1,2}, counting
measure ;{(1,1),(1,2),...,(4,4)}, counting
measure ;L2), where L2(ρ) is
[ 0
0
0
0
0
0
ρ1
0
0
0
0
0
ρ2
0
0
0 ]
T
(4.15)
splitter 3
({(1,1),(1,2),...,(4,4)};{1,2,3,4},{1,2,3,4}) with the obvious identiﬁcation.

CHAPTER 4. CONSTRUCTING THE NETWORKS
48
pince-nez 4
({ switch on,
switch oﬀ} × {1,2,3,4}, counting
measure ;
(4.16)
⎧⎪⎪⎪⎪⎪⎨⎪⎪⎪⎪⎪⎩
light one on and switch on,
light one on and switch oﬀ,
light one oﬀand switch on,
light one oﬀand switch oﬀ,
⎫⎪⎪⎪⎪⎪⎬⎪⎪⎪⎪⎪⎭
, counting
measure ;{1,2,3,4}, counting
measure ;L4
⎞
⎟⎟⎟
⎠
where L4(τ) is
⎧⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎨⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎩
τ∣switch oﬀ
if light one oﬀand switch oﬀ
0
if light one on and switch oﬀ
⎡⎢⎢⎢⎢⎢⎢⎢⎢⎢⎣
0
0
0
0
1
1
0
0
0
0
0
0
0
0
0
0
⎤⎥⎥⎥⎥⎥⎥⎥⎥⎥⎦
τ∣switch on
if ﬁrst on and switch on
⎡⎢⎢⎢⎢⎢⎢⎢⎢⎢⎣
0
0
0
0
0
0
0
0
0
0
0
0
0
0
1
1
⎤⎥⎥⎥⎥⎥⎥⎥⎥⎥⎦
τ∣switch on
if ﬁrst oﬀand switch on
(4.17)
pince-nez 5
Same as for pince-nez 4 except the second light replaces the ﬁrst light.
pince-nez 6
({(1,1),(1,2),...,(4,4)} × [0,2π), counting
measure × Lebesgue
measure
;
(4.18)
⎧⎪⎪⎪⎪⎪⎨⎪⎪⎪⎪⎪⎩
third and fourth on,
third on,
fourth on,
third and fourth oﬀ
⎫⎪⎪⎪⎪⎪⎬⎪⎪⎪⎪⎪⎭
, counting
measure ;;L6
⎞
⎟⎟⎟
⎠
where L6(τ) is
∫
2π
0
[ 1
1
1
1
1
1
0
0
0
0
0
0
0
0
0
0 ]τ(θ)dθ
(4.19)
if both third and fourth lights are on,
∫
2π
0
[ 0
0
0
0
0
0
cos2 θ
1
2
0
0
0
0
cos2 θ
1
2
0
0 ]τ(θ)dθ
(4.20)

CHAPTER 4. CONSTRUCTING THE NETWORKS
49
if the third light is on and the fourth is oﬀ,
∫
2π
0
[ 0
0
0
0
0
0
sin2 θ
1
2
0
0
0
0
sin2 θ
1
2
0
0 ]τ(θ)dθ
(4.21)
if the fourth light is on and the third is oﬀ, and
∫
2π
0
[ 0
0
0
0
0
0
0
0
1
1
1
1
0
0
1
1 ]τ(θ)dθ
(4.22)
if both third and fourth lights are oﬀ.
Using this information, the joint probability, given that the switch is oﬀand the dial is set
to θ, for both the ﬁrst pair being oﬀ, the third light being on, and the fourth light being oﬀ,
is then given by (4.11), which is ∫
2π
0
cos2 θ′ g(θ′)dθ′ ≈cos2 θ. Similarly, the joint probability,
given that the switch is on and the dial is set to θ, for both the ﬁrst and the third light being
on, with the second and fourth being oﬀ, is then given by (4.13), which is ∫
2π
0
1
4g(θ′)dθ′ = 1
4.
The other joint probabilities can be calculated similarly and agree with the joint probabilities
originally given for the black box.
4.8
What is a quantum system?
For the two-slit experiment, which only required ﬁnite-dimensional linear algebra in the
quantum model (apart from the already commented on problem of inputting the dial setting
Θ), a classical model with the same behavior also only required ﬁnite-dimensional linear
algebra. This is atypical. As we have seen in §3.5, a classical model that duplicates the
behavior of a quantum model is generally far more complicated. Also, these classical models
are generally inherently contextual.
A reason why the name “quantum system” could still be applied to this example is
universality: while both models have been constructed to be potentially universal, testing
will reveal if they fail in this regard. If the black boxes were opened to reveal a laser, beam-
splitters, photon detectors, and so on, from experience we would have a lot of conﬁdence
that the modules in the quantum model are universal, whereas we would have very little
conﬁdence for the modules in the classic model to have that property. Conversely, if the
boxes were opened to reveal regular computer circuits, the situation would be reversed.

50
Chapter 5
Relation to textbook quantum
mechanics
5.1
Textbook rules for quantum mechanics
The quantum Bayesian network structure developed so far has constraints only arising from
the requirements of positivity, linearity, and potential universality. It is not obvious that it
has any connection necessarily to what is usually thought of as quantum mechanics. Using
option I’, that is not the situation, as is shown below.
However, while the following justiﬁes the usage of the name quantum for the extended
Bayesian networks, it should not be taken as a justiﬁcation of them–quite the opposite. The
Bayesian network approach is predicated on a very reasonable basis. The textbook approach
to quantum mechanics is only comfortable due to familiarity; on its own merits its rules are
incomprehensible and unmotivated. Hence, the following is better taken as a justiﬁcation
of the textbook approach. In other words, if quantum behavior had ﬁrst been discovered
as forecasting arising from a reasonable extension of Bayesian networks, and the usual list
of textbook rules were later discovered picking out a certain subset of networks that were
suﬃcient to model any situation, no one would take those rules as primary.
Rule one
Textbook quantum mechanics imposes an additional rule: only networks in the form of
chains are permitted and all the Hilbert spaces along a chain must be the same (apart for
terminating trivial spaces). (This rule may arise from imagining that we have some sort
of universal, initial-value, dynamical system). Mathematically, this rule puts no additional
constraints on the network formulation; it is always possible to obey this by working in a
suﬃciently large Hilbert space and waiting until the end of the calculation to perform the
reduced traces arising from terminal nodes. However, doing this in practice is unnecessarily
diﬃcult–the whole point of Bayesian networks is to try to ﬁnd a model made of simple and

CHAPTER 5. RELATION TO TEXTBOOK QUANTUM MECHANICS
51
(hopefully) universal parts where the calculations can be done in a manageable manner.
Therefore, similarly our treatment of determinism in §2.6, we will discard this rule.
Rule two
Another rule from textbook quantum mechanics is: the linear map for a quantum node can
only be of the form Lρ = UρU ∗, where U is unitary. As we prove in theorem 5.1.1 below,
this is no limitation at all mathematically if option I’ is employed. If option II is used,
the theorem still holds if H is separable and if there is some strictly positive1, ﬁnite Radon
measure on X. For any node with data (I,µ,H;O,ν,J;L), the map L can be represented
as the sequence of three operations, using some auxiliary Hilbert space M: (i) injecting
ρ ∈L1(I;µ;D(H)) as a density matrix on a Hilbert space K ⊗L2(O;ν) ⊗J utilizing a partial
isometry; (ii) taking a reduced trace of the density matrix over K; (iii) mapping the resulting
density matrix on L2(O;ν)⊗J into L1(O;ν;D(J)). By introducing an auxiliary Hilbert space
L with
L2(X;µ) ⊗H ⊗L = L2(O;ν) ⊗J ⊗M
(5.1)
and some ﬁxed template density-matrix on L, the partial isometry can be upgraded to an
unitary operator. In terms of the graphical model, this means replacing a node with the
graph fragment:
m

	




 
m
m
unitary
- 
1
PPP
q
PP
P
q
I,µ,H
L
M
O,ν,J
-
  
-
(5.2)
Of course, just because we can do this does not mean we must, or that we should. To obey
this rule, a great deal of extra computation and irrelevant, arbitrary choices must be made
to no practical beneﬁt. Therefore, this rule will also be discarded.
Rule three
Yet another rule from textbook quantum mechanics is: the linear map for a terminal pince-
nez (a destructive “measurement”) can only be of the form ∫B Lρdν = tr EBρ, where {EB}B∈E
are a complete set of mutually commuting, orthogonal projectors2. For the other pince-nez,
1Every open set gets measure greater than zero.
2{EB}B∈E is a complete set of mutually commuting, orthogonal projectors for a σ-algebra E of subsets of
a set X if they are all mutually commuting, orthogonal projectors with E∅= 0, EX = I, and E⋃j Bj = ∑j EBj
for all countable, disjoint collections {Bj} ⊂E, with convergence of the sum in the weak* topology induced
on B (H) by its being dual to the trace-class operators S1 (H). In this case, convergence in the ultrastrong-
operator, strong-operator, ultraweak-operator (same as weak*), and weak-operator topologies on B (H) are
all equivalent (see A2.1).

CHAPTER 5. RELATION TO TEXTBOOK QUANTUM MECHANICS
52
only σ-algebras generated by a countable set of atoms are allowed, and the map must be of
the form
∫B Lρdν = ∑
j
EAjρEAj for {Aj} a partition of B
(5.3)
This rule can also be stated in the form that every “measurement” has an associated op-
erator, which are the coordinates r (taking values as coordinates in the discrete case) for
R acting on L2(R;τ) in this formulation. An even stronger formulation requires the result
of any “measurement” to be an eigenvalue of the associated operator [19]. This implicitly
assumes any results accrued to unions of atoms is due to post-“measurement” garbling and
not inherent in the “measurement”. Furthermore, if the eigenspace corresponding to any
eigenvalue has dimension greater than one, this formulation fails to distinguish among the
myriad of possible complete sets of mutually commuting, orthogonal projectors consistent
with its prescription, giving rise to the “three-box paradox” [2] if there is post-conditioning.
Again employing option I’, as we prove in theorem 5.1.1 below, this third textbook
rule also imposes no mathematical limitation. Using option II, the theorem still holds with
the same limitations given before.
For any pince-nez with data (I,µ,H;R,τ;O,ν,J;L),
the map L can be represented as the sequence of four operations, using some auxiliary
Hilbert space M: (i) injecting ρ ∈L1(I;µ;D(H)) as a density matrix on a Hilbert space
L2(R×O;τ ×ν)⊗J⊗M utilizing a partial isometry; (ii) making a projective “measurement”
on the L2(R;τ) portion; (iii) taking a reduced trace of the density matrix over L; and (iv)
mapping the resulting density matrix on L2(O;ν) ⊗J into L1(O;ν;D(J)). By introducing
an auxiliary Hilbert space L with
L2(X;µ) ⊗H ⊗L = L2(R × O;τ × ν) ⊗J ⊗M
(5.4)
and some ﬁxed template density-matrix on L, the partial isometry can be upgraded to an
unitary operator. In terms of the graphical model, this means replacing a pince-nez with the
graph fragment:
m
m

	




 
m
m


unitary
projective
-
-
PPP
q



7
PPP
q
I,µ,H
L
M
O,ν,J
L2(R;τ)
-
  
-
(5.5)
Once again, just because we can do this does not mean we must, or that we should. To obey
this rule, a great deal of extra computation and irrelevant, arbitrary choices must be made
to no beneﬁt. Therefore, this rule will also be discarded.
The main theorem
The statement of the aforementioned theorem is:

CHAPTER 5. RELATION TO TEXTBOOK QUANTUM MECHANICS
53
Theorem 5.1.1
Any completely-positive map L ∈CP(L1(I;µ;D(H)),L1(R×O;τ×ν;D(J)))
that is an isometry on the positive cone can be expressed as
Lρ = (diagL2(R;τ) ⊗(diagL2(O;ν) ⊗IB(J)) ⊗tr M)V ((diagL2(I;µ) ⊗IB(H))−1ρ)V ∗
for some Hilbert space M and some partial isometry V ∈B(L2 (I;µ) ⊗H,L2 (R × O;τ × ν) ⊗
J⊗M). If all the Hilbert spaces L2 (I;µ), H, L2 (R;ν), L2 (O;ν), and J have ﬁnite dimension,
then M can be taken to be J ⊗dimL2 (I;µ) ⊗H.
Proof
Apply B5.27. ◻
Comments
The full proof is quite lengthy, occupying from B5.17 to B5.27 in the ap-
pendix.
The following is an outline: First a diagonal extraction map diag is deﬁned in
B5.17. Using this, we ﬁnd that the dual space to density-matrix-valued, L1-“functions”
is a von Neumann algebra3. Then one theorem by Stinespring [118] on completely-positive
maps on C∗-algebras and another by Sakai [109] on representations of von Neumann algebras
complete the proof.
For the inverse map in the statement of the theorem, (diagL2(I;µ)⊗IB(H))−1, any particular
choice in the preimage can be taken–the ﬁnal result is the same regardless of which choice is
made. Also, as claimed, introducing an auxiliary Hilbert space L satisfying (5.4), the partial
isometry can be certainly be upgraded (although not in a unique fashion) to an unitary
operator U satisfying, for some ﬁxed template density-matrix χ ∈D(L),
V ((diagL2(I;µ) ⊗IB(H))−1ρ)V ∗= U(((diagL2(I;µ) ⊗IB(H))−1ρ) ⊗χ)U ∗
(5.6)
for all ρ ∈L1(I;µ;D(H)). In addition, the statement of the theorem does indeed indicate
a projective “measurement”. Let B be any τ-measurable subset of R. Then, for any ϕ ∈
D(L2(R;τ)), 1B as an element of L∞(R;τ) ≅L1(R;τ)∗acting on diagL2(R;τ)ϕ is
∫B diagL2(R;τ)ϕ dτ = tr PBϕ
(5.7)
where PB = diag∗
L2(R;τ)1B is the orthogonal projector to the subspace of “functions” in
L2(R;τ) that are zero almost everywhere outside B.
5.2
Weak measurements
Reproducibility as a criteria
One motivation for the restriction to projective maps, emphasized by Dirac [20], is repro-
ducibility: if two successive pince-nez have the same data (and the incoming and outgoing
3A Banach algebra is a Banach space equipped with an associative, distributive product satisfying ∥ab∥≤
∥a∥∥b∥. A *-algebra is a Banach algebra with an antilinear involution. A C*-algebra is a *-algebra where
∥a∗a∥= ∥a∥2. A von Neumann algebra (also termed a W*-algebra) is a C*-algebra which, as a Banach space,
is a dual space.

CHAPTER 5. RELATION TO TEXTBOOK QUANTUM MECHANICS
54
data are compatible), then conditioning on the observation for the ﬁrst being in some mea-
surable subset B ⊂R, the probability measure for the second observation has the property
that on measurable sets that do not intersect B, it gives zero, whereas on measurable sets
that contain B, it gives one. The Bayesian network for this set-up is:
}
m
m
m

	


-
-
-
1
1
(5.8)
where the repeated ‘1’s indicate the data for the two pince-nez are the same.
While this criteria looks superﬁcially attractive–as is implied in the saw “measure twice,
cut once”–its ﬂaw is readily apparent. Suppose I were asked to see whether or not a light
in another room were oﬀ. If I see the light is oﬀ, I return and report it being oﬀ. If I see
it is on, I turn it oﬀ, then return and also report it being oﬀ. This is repeatable, but does
not correspond to what we generally mean by the measurement of the state of the light.
While this example may seem obtuse, the point is that mathematically projective maps in
quantum mechanics act in this manner–they have a signiﬁcant eﬀect even if the results are
ignored.
Weak versus strong maps for pince-nez
Building from the preceding example, if the incoming and outgoing data for a pince-nez are
compatible, then the map L is termed strong if, when marginalizing over the observation, the
result (using option I’), ∫R L(ρ)dτ, is far from ρ for all but a small subset of ρ’s. Conversely,
the map L is termed weak if ∫R L(ρ)dτ is close to ρ for a large subset of ρ’s. Obviously, there
is a continuum of possibilities; the strength could be varied depending on an input parameter.
For instance, in the double-slit example previously considered, the switch control could be
replaced by a continuous slider that would slowly vary the joint probabilities of the output.
Now we can easily understand the misconception leading to the repeatability criteria; in
the classic case, restriction maps (using diagonal projectors) are both repeatable and the
weakest possible, having no eﬀect if their observations are ignored. In the quantum case,
however, while projective maps (using orthogonal projectors) are still repeatable, they can
also be very strong.
Information as a criteria
Another misconception is that the result of any pince-nez map can be duplicated by a
projective map followed by a garbling of the observation data4. If this were the case, then,
by convexity, the information5 using a projective map would always be higher than for any
4For instance, Dirac seemed to believe “measurements” were always inherently projective. [20]
5Information in the sense of the Shannon deﬁnition [115] for the probability measure on the observation
set R.

CHAPTER 5. RELATION TO TEXTBOOK QUANTUM MECHANICS
55
other map in every situation. Consequently, the claim by Kochen and Specker that projective
“measurements” give maximal knowledge [40] would be correct. However, it is easy to see
this is false. For instance, the matrices
φ1 = [
2
3
0
0
1
3
],φ2 = [
1
6
1
5
1
5
1
3
],φ3 = [
1
6
−1
5
−1
5
1
3
]
(5.9)
are all positive, sum to the identity, and do not mutually commute. The map L ∶D(C2) →R3
given by L(ρ) = (tr φ1ρ,tr φ2ρ,tr φ3ρ) is completely-positive and norm-preserving (on the
positive cone), yet cannot be duplicated by any garbling of a projective map, ∑2
k=1 gjktr Ekρ,
for stochastic matrix G = [gjk] and commuting, complete, orthogonal projectors {E1,E2}
on C2 since the matrices {g11E1 + g12E2,g21E1 + g22E2,g31E1 + g32E2} necessarily mutually
commute.
Also, even if it were possible to duplicate the behavior of a particular pince-nez map by
an projective map followed by a garbling of the observation data when the module is used in
isolation, if the module is then inserted into a larger Bayesian network where conditioning
is taking place, the diﬀerence in behavior between the particular pince-nez map and the
projective map followed by a garbling may become quite large. In particular, for so-called
“weak-measurements” [2], which employ both strong and weak pince-nez maps together with
both pre- and post-conditioning, the information can be very large. The typical Bayesian
network for one of these has the form:
}
}
}
m
}
}
}

	

	
...

	
m


 




...


-
-
-
HHHHHH
j
      
-

3
QQQQQQQ
s
(5.10)
There is both pre- and post-conditioning; those pince-nez have projective maps. The central
pince-nez has a map that uses “fuzzy” projectors with spread of order
√
N for N particles.
Hence, the relative standard deviation in the values assigned to the observation set is only of
order
1
√
N , so the information is high; furthermore, the center of the peak of the distribution
can be in unexpected ranges of the observation set, as has been well-publicized recently [13].

CHAPTER 5. RELATION TO TEXTBOOK QUANTUM MECHANICS
56
5.3
Comparison of Bayesian networks to quantum
circuits and tensor networks
A commonly-used, alternative graphical approach for quantum systems is quantum cir-
cuits [51]. For example consider the following quantum circuit:


 


 


 


 
ψi
U
V
ψf
K
J
H
(5.11)
Then for Hilbert spaces H, J, and K, termed the quantum channels, and initial state ψi ∈
H ⊗J ⊗K, the ﬁnal state ψf is given by (IH ⊗V )(U ⊗IK)ψi for some unitary U ∶H ⊗J →
H ⊗J and V ∶J ⊗K →J ⊗K. Quantum circuits are obviously directly related to the usual
textbook quantum mechanics working with wavefunctions. Following the ﬁrst textbook rule
from above, there is a single overall Hilbert space, the tensor product of all the Hilbert
spaces for each quantum channel, that is used throughout. Only unitary operators can be
accommodated, following the second textbook rule above.
It is possible to incorporate projective “measurements” into the quantum circuit, giving
a tensor network, but this requires doubling the graph–clearly not an eﬃcient approach
graphically. For instance, suppose the initial state is a product state, ψi = ψ1 ⊗ψ2 ⊗ψ3
and that a projective “measurement” is made on the ﬁnal state, where the projector is of
the form IH ⊗P. Then the calculation of the probability ∥IH ⊗Pψf∥2 = ⟨IH ⊗Pψf,ψf⟩is
represented by the tensor network
f
f
f


 


 


 


 


 
f
f
f
U
V
P
V *
U *
ψ3
ψ2
ψ1
ψ∗
3
ψ∗
2
ψ∗
1
(5.12)
The tensor network has some of the advantages of the Baysian network in that once it is set
up, it is possible to look for computational shortcuts.
On the other hand, the Bayesian network has many advantages. It does not depend
on the incomprehensible and unmotivated textbook rules, but instead stands on its own
reasonable basis. It is graphically more eﬃcient in not having to duplicate itself to include
observations. It is also potentially more eﬃcient in allowing non-unitary nodes and non-
projective pince-nez, hence avoiding the need to introduce auxiliary spaces, and in having the
splitter construction, so it is not necessary to maintain all the quantum circuits throughout

CHAPTER 5. RELATION TO TEXTBOOK QUANTUM MECHANICS
57
the diagram. The Bayesian network indicates which observable nodes are being marginalized
or conditioned on and works seamlessly with the usual observable Bayesian networks that
are already in common use, so it easily allows models with information coming from previous
observations or random factors (such as coin ﬂips). For instance, a tensor network coming
from a quantum circuit for the “weak measurement” example (5.10) would be far more
complicated, with the need for auxiliary spaces, yet would still not be able to indicate the
post-conditioning graphically (the pre-conditioning could be incorporated into the initial
values for the wavefunction).

58
Chapter 6
Further examples
6.1
No-cloning–classical and quantum
No-cloning is taken as a hallmark of quantum mechanics.
However, it is a property of
Bayesian networks more generally, holding even if all the Hilbert spaces are trivial. The
non-linear map Clone sends the density matrix-valued vector measure ρ to ρ ⊗ρ.
This
cannot be implemented by any device that can be modelled by a Bayesian network since
such a network, no matter how complicated, altogether gives rise to a linear map on ρ by
the principle of linearity.
One may still consider something a cloning device if it does not always clone, but only
clones conditioned on a observation; for instance, suppose there is a green light for success
and a red light for failure. However, to be a cloning device, it must have a ﬁnite probability
of success for at least two distinct inputs, µ and ν. By the principle of linearity, then every
convex combination tµ+(1−t)ν of the two has a ﬁnite probability for success. Now consider
the following graphical model:

	
-
-
cloning
device
testing
device
mlight
(6.1)
For the device to be cloning, then conditioning on the light being green, the joint probability
for the observations on the testing device must be the same as those for the graphical model

CHAPTER 6. FURTHER EXAMPLES
59
with the Clone map

	
-
-
Clone
testing
device
(6.2)
with the same corresponding data for the testing device for each model. For every possibility
of what is put in the dashed boxes and what the corresponding information is, there are some
linear maps L from D(H)-valued vector measures on X to D(H ⊗H)-valued vector measures
on X ×X and K, M from the latter space to [0,1] such that the joint probability (conditioning
on the light being green) using the purported cloning device is (K ○L)ρ
(M ○L)ρ, whereas the joint
probability using the mathematical Clone map is KClone(ρ) = K(ρ × ρ). With the above
assumption, (M ○L)(tµ + (1 −t)ν)) ≠0; however, then we must have
(M ○L)(tµ + (1 −t)ν)K((tµ + (1 −t)ν) × (tµ + (1 −t)ν)) = (K ○L)(tµ + (1 −t)ν)
(6.3)
for all t ∈[0,1], which is impossible.
6.2
Teleportation-classical and quantum
Teleportation is also generally taken as a hallmark of quantum mechanics. However, as will
be shown, teleportation is also possible in classical hidden models.
A device is a teleportation device if, when modelled by a Bayesian network, for a ﬁxed set
X, base measure µ, Hilbert space H, and template density-matrix-valued function σ ∈L1(X ×
X;µ×µ;D(H⊗H)+), it takes the product function ρ⊗σ ∈L1(X ×X ×X;µ×µ×µ;D(H⊗H⊗H)+)
back to ρ for any ρ ∈L1(X;µ;D(H)+) and where a splitter is used so only Alice gets the
(X,µ,H) that ρ lives on, Bob gets the ﬁnal ρ, and there are no hidden connections between
Alice and Bob, but only classic, observable information. Note that because the ﬁrst textbook
rule that the overall Hilbert space is the same throughout is unnecessary for the Bayesian
network formulation, there is no need to have another output from Alice (whose value is
irrelevant in the context of being a teleportation device)–this leads to simpliﬁcation in the
required calculations.
There is a Bayesian network for such a device using quantum nodes (based on, but
extending, the calculations of Bennett, Brassard, Cr´epeau, Josza, Peres, and Wootters [7])
if X = {1,2,...,m}, µ is the counting measure, H is Cn, and σ is the density-matrix-valued
function (written as a column vector with m2 entries, each a n2 × n2-matrix) 1
m Vec Im ⊗
(1
n Vec In ( Vec In)T). Note σ is the Kronecker product of Copy applied to the uniform

CHAPTER 6. FURTHER EXAMPLES
60
distribution with the usual maximally-entangled state. The graphical model is:

	

	

:
XXXXXX
z


 


m
   
QQQQQQQQQQQ
s

*
1
2
4
5
3
m
m
@
@
@
@
@
@@
R
@
@
@
@
@
@
@
?
Alice
Bob
teleportation
device
(6.4)
The double arrow indicates Bob’s observations are identical to Alice’s (perfect communica-
tion). The information presented in the form according to the graphical model is:
node 1
(;{1,2,...,m}, counting
measure ,Cn;L1) where L1 is the constant map with value ρ.
node 2
(;{1,2,...,m} × {1,2,...,m}, counting
measure ,Cn ⊗Cn;L2) where L2 is the constant
map with value σ.
splitter 3
({1,2,...,m}×3, counting
measure ,Cn3;
{1,2,...,m} × {1,2,...,m}, counting
measure ,Cn ⊗Cn,{1,2,...,m}, counting
measure ,Cn)
pince-nez 4
({1,2,...,m} × {1,2,...,m}, counting
measure ,Cn ⊗Cn;
{1,2,...,m} × {1,2,...,n} × {1,2,...,n}, counting
measure ;;L4)
Let Ωbe the n × n-matrix with the nth roots of unity along its diagonal, S be the n × n-
shift-matrix with a one in the upper-right corner and ones on the subdiagonal, and Q be
the m × m-shift-matrix with a one in the upper-right corner and ones on the subdiagonal.
For k,l ∈{1,2,...,n}, let wkl be the column vector (In ⊗(Ωl−1Sk−1)) Vec In.
Then for
(j,k,l) ∈{1,2,...,m} × {1,2,...,n} × {1,2,...,n}, L4(τ)jkl is given by
( Vec Qj−1)
T ((Im2 ⊗w∗
kl)τ(Im2 ⊗wkl))
(6.5)

CHAPTER 6. FURTHER EXAMPLES
61
node 5
({1,2,...,m} × {1,2,...,m} × {1,2,...,n} × {1,2,...,n}, counting
measure ,Cn;
{1,2,...,m}, counting
measure, Cn;L5)
The incoming density-matrix-valued function τ will be considered as a m×n×n-array, indexed
by j,k,l, of column vectors of m entries each, where each entry is a n × n-matrix. With this
convention, L5(τ) is given by
m
∑
j=1
n
∑
k,l=1
((Qj−1)T ⊗In)((Im ⊗(Ωl−1(Sk−1)T))τjkl(Im ⊗(Sk−1Ω
l−1))
(6.6)
Then, for any following testing device, the incoming density-matrix-valued function from
Bob if Alice observes (j,k,l) ∈{1,2,...,m} × {1,2,...,n} × {1,2,...,n} is
L5 (((L4 ⊗IB(L1(X;µ;H))))(L1 ⊗L2))∣j,k,l 1{(j,k,l)})
(6.7)
This apparently complicated expression is just ρ, regardless of which particular values of
j,k,l were observed by Alice and sent to Bob.
The classical case
Note the preceding is meaningful for the case of trivial Hilbert space, n = 1, so teleportation
is not a quantum phenomenon. Another way to achieve the same output in this purely-
classical case is to not have a template shared by Alice and Bob, but rather to have the
pince-nez for Alice have simply the identity for its map (so the hidden node is not really
hidden, but is actually observable). Then Alice sends her information to Bob, who makes
a copy using the information. Finally, Alice and Bob forget what the information was (so
their nodes are marginalized). The result is that the incoming probability distribution to
Alice is the same as that outgoing from Bob.
However, this second approach is not teleportation because of the forgetting step. Also,
for the classical case of the teleportation given above, an eavesdropper to the information
sent from Alice to Bob without access to the template cannot replicate the probability
distribution, whereas in the second, non-teleportation approach, the eavesdropper could not
only replicate the probability distribution by making his own copy, then forgetting, but by
not forgetting, would actually have more information.
Does a teleportation device really teleport?
Note the graphical model for the teleportation device is simply a graph fragment since the
output from Bob is not terminated. One may hope its behavior is universal, but is always

CHAPTER 6. FURTHER EXAMPLES
62
possible that additional testing will reveal it is not.
For instance, before the discovery
of quantum mechanics, it may have been believed that the classical teleportation discussed
above was “true” teleportation. It is possible that additional mathematical structures besides
measures and density matrices (see §3.8 above) can be used to calculate probabilities in
Bayesian networks and that these are found to be useful in practice–then the current belief
that quantum telportation is “true” teleportation will also be shown false.
6.3
Bell’s inequality for Bayesian networks without
metaphysical limitations
Introduction
The standard proofs of Bell’s inequality [6] make assumptions based on assuming the un-
derlying reality of hidden variables, which in our language is equivalent to the existence of
transition probability function. As we explored in §2.2, this is a metaphysical notion for
hidden nodes. For our Bayesian networks, no such limitation is placed, which enlarges the
space of possible maps that can be employed. Although, as we already mentioned in §2.2,
these additional maps are not necessarily of great interest, we would like to show that Bell’s
inequality still necessarily holds.
Set-up
Following Clauser, Horne, Shimony, and Holt [15], consider the case of two observers, Alice
and Bob, who are at distant locations. Each has a box, connected by a long cable to the
other, with a dial and two lights, marked zero and one, which light periodically.
They
record their observations, then come together later to compare notes. They ﬁnd that the
ﬂashes are independent in time and depend on the settings of the dial, α for Alice and β for
Bob, but for each round the lights they each saw were not independent of each other, but
had a joint probability distribution given by the four functions of α,β: Prob((0,0)∣α,β),
Prob((0,1)∣α,β), Prob((1,0)∣α,β), and Prob((1,1)∣α,β). Presenting the information in
this manner corresponds to the graphical model:
m
B
B
B
B
B
BBm
}
}
hh
h
e
e
e
e
e
ee








Alice
Bob
α
β
(6.8)

CHAPTER 6. FURTHER EXAMPLES
63
There are the additional no-signalling constraints on the probabilities arising from relativity:
Prob((0,0)∣α,β) + Prob((0,1)∣α,β) is independent of β
(6.9)
Prob((1,0)∣α,β) + Prob((1,1)∣α,β) is independent of β
Prob((0,0)∣α,β) + Prob((1,0)∣α,β) is independent of α
Prob((0,1)∣α,β) + Prob((1,1)∣α,β) is independent of α
If these constraints were not met, then Alice and Bob could use their dial settings to trans-
mit information superluminally. However, relativity places no additional constraint on the
bounds for the value of, for α,α′ two settings of Alice’s dial and β,β′ two settings of Bob’s
dial,
Prob((0,0)∣α,β) + Prob((1,1)∣α,β) −Prob((0,1)∣α,β) −Prob((1,0)∣α,β)
(6.10)
+Prob((0,0)∣α′,β) + Prob((1,1)∣α′,β) −Prob((0,1)∣α′,β) −Prob((1,0)∣α′,β)
+Prob((0,0)∣α,β′) + Prob((1,1)∣α,β′) −Prob((0,1)∣α,β′) −Prob((1,0)∣α,β′)
−Prob((0,0)∣α′,β) −Prob((1,1)∣α′,β) + Prob((0,1)∣α′,β) + Prob((1,0)∣α′,β)
which can still achieve its bound in magnitude arising from the rules of probability, namely
four.
The standard hidden variable approach
A suﬃcient way to insure the restrictions from relativity are met is to restrict the possible
graphical model to the local model:
m

1
XXXXXXXXXXX
z
m
m
}
}
-

:
Alice
Bob
α
β
(6.11)
Then, if the space of values for the marginalized node is X and its probability measure is ρ,
the joint probability both Alice and Bob get 1 is
∫x∈X Prob(1 for Alice∣α,x)Prob(1 for Bob∣β,x) dρ(x)
(6.12)
with the other joint probabilities given similarly. Using the standard approach for Bell’s
inequality [15], it can be shown that for the combination of probabilities in (6.10), the
bound on its magnitude has now been reduced to two.

CHAPTER 6. FURTHER EXAMPLES
64
Using classical hidden nodes
A suﬃcient way to insure the restrictions from relativity are met using classical hidden nodes
is to restrict the possible graphical model to to the local model:

	






 
- 

3
PPPPPPPP
q
1
4
2
3
m
m
}
}
XX
X
z

:
Alice
Bob
α
β
(6.13)
The boxes are drawn around the two separate locations to indicate these are potentially
universal modules.
Theorem 6.3.1
Employing either option I or II, Bell’s inequality still holds.
Proof
Using option II, by the Riesz theorem [78], each Prob((j,k)∣α,β) is necessarily of
the form
∫Y×Z fj(y;α)gk(z;α) dµ(y,z)
(6.14)
for some positive, continuous functions f1,f2,g1,g2 with f1 + f2 = 1Y×[0,2π), g1 + g2 = 1Z×[0,2π)
and some unit-norm, Radon measure µ on Y × Z. This is mathematically the same form
as (6.12), if lacking the interpretation in terms of conditional probabilities and probability
measures, so the standard argument [15] still applies with bound two for (6.10).
Using option I, each Prob((j,k)∣α,β) is necessarily of the form
(L2 ⊗L3)(µ × ρ × ν)({(j,k)})
(6.15)
where µ is some unit-norm measure on [0,2π) concentrated about α from a collection of
measures M5, ν is some unit-norm measure on [0,2π) concentrated about β from the same
collection of measures, ρ is some unit-norm measure on Y×Z from some collection of measures
M4, L2 is a norm-preserving (on the positive cone) map from measures on [0,2π) × Y
in some collection of measures M2 to measures on {0,1} with set algebra the power set
{∅,{0},{1},{0,1}}, and L3 is a norm-preserving (on the positive cone) map from measures
on Z × [0,2π) in some collection of measures M3 to measures on {0,1} with set algebra the
power set {∅,{0},{1},{0,1}}. From the rules for option I, all the collections of measures are
absolutely-continuous-complete and are such that L2⊗L3 is well-deﬁned. However, by A1.2,

CHAPTER 6. FURTHER EXAMPLES
65
A1.3, B1.3, B1.4, and B2.5, this implies the bound can be established just be considering
Prob((j,k)∣α,β) of the form
(L2 ⊗L3)(∑
l
τl × σl)({(j,k)})
(6.16)
where ∑l τl × σl is a unit-norm, ﬁnite-tensor-rank measure in M2 ⊗M3. Using this form for
Prob((j,k)∣α,β), the usual bound of two readily follows for (6.10). ◻
Comments
Using the well-known quantum model of Clauser, Horne, Shimony, and Holt [15] (which
reuses some of the modules from the double-slit experiment (see §4.5) in a diﬀerent arrangement–
an example of universality), it is possible to violate Bell’s inequality and the combination of
probabilities in (6.10) can even achieve Tsirelson’s bound of 2
√
2 [14]. Any classical hidden
model duplicating these results must be nonlocal; hence, contextual–certainly the modules
we used for the classical hidden model for the double slit experiment (see §4.7) would be of
no use.
We then have the question of whether Tsirelson’s bound can be broken.
This may
be possible if there are additional mathematical structures besides measures and density
matrices that can be utilized in Bayesian networks while respecting the principles of positivity
and potential universality (see §3.8 above).

66
Part II
Parrondo’s paradox and a
Parrondo-like paradox

67
Chapter 7
Parrondo’s paradox
7.1
Deﬁning the paradox
Suppose a two-player (or one-player versus the house) repeated game wins with probability
greater than one-half for one player as does a second repeated game. Naively, it may seem
that the convex combination of the two games using a (possibly biased) coin to determine
which rule to employ for each round must also win for that player. However, it is possible
that this combined game actually wins with probability greater than one-half for the second
player. This paradoxical result is termed Parrondo’s paradox [64].
Criteria for winning
While this paradox is displayed for several diﬀerent winning criteria (see [28] for instance),
here the following very simple criteria will be employed for all the following games: in total,
n rounds of a game with observation set R are played. Let E be the σ-algebra of observable
events for each round. For a ﬁxed set A ∈E, if the state is in A at the nth round, the ﬁrst
player (call her Alice) wins; otherwise, the second player (call him Bob) wins–regardless of
what was observed at the preceding rounds. (For one traditional formulation of Parrondo’s
paradox, X = Z, E is its power set, and A = Z+. [64]) It is easy to see the applicability of this
criterion for many diﬀerent real-life situations–for instance, the diﬀerence of scores in sports
games or stock options in ﬁnance.

CHAPTER 7. PARRONDO’S PARADOX
68
7.2
Classical observed Markov chain game
Deﬁning the game
Following the traditional method for Bayesian networks, the graphical model for the Markov
chain game is:
k
k
k
1
2
3
-
-
- ⋯⋯
- k
n
(7.1)
Let µ be the initial marginal probability measure. For the subsequent nodes, take all the
transition probability functions to be the same τ(⋅∣⋅). The joint probability to observe out-
comes (x1,x2,...,xn) ∈A1 × A2 × ⋯× An, for any A1,A2,...,An ∈E, is then
(RAn ○L ○⋯○RA2 ○L ○RA1µ)(X)
(7.2)
for L the map induced by τ(⋅∣⋅) (see 2.15) and RA the restriction map (see §2.5). Then the
probability to observe the system has state in A at the nth round (so Alice wins), denoted
PA,n, is given by
(RA ○L ○⋯○L
´¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¸¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¶
n−1
µ)(X)
(7.3)
In the common case where the events E are generated by a ﬁnite number of sets, the transition
probability functions are stochastic transition matrices, the initial measure is a stochastic
column vector, and the maps are given by having the matrices act on the vector in the usual
matrix product.
Combining two games
Now suppose we have a second game with the same structure, but a diﬀerent transition
probability function for each round, τ ′(⋅∣⋅) (there can also be a diﬀerent initial marginal
probability, but that will be of no consequence for the limit we will take). The probability
to observe the system has its state in A at the nth round is denoted P ′
A,n. The two games
can be combined by ﬂipping a (possibly biased) coin at each round, playing according to the
ﬁrst game if the coin is heads, which occurs with probability p, and according to the second
if the coin is tails, which occurs with probability 1−p. The graphical model for the combined
game is:
k
k
k
1
2
3
-
-
- ⋯⋯
- k
n
k
k
k
B
B
BBN
B
B
BBN
B
B
BBN
heads,tails heads,tails
heads,tails
(7.4)

CHAPTER 7. PARRONDO’S PARADOX
69
For the combined game, the transition probability function for each round is
τ(⋅∣⋅,c) =
⎧⎪⎪⎨⎪⎪⎩
τ(⋅∣⋅)
if c = heads
τ ′(⋅∣⋅)
if c = tails
(7.5)
Let Mc be the map induced by τ(⋅∣⋅,c). The marginal probability to then observe the system
is in A for the nth round, denoted P comb
A,n , is then
∑
c2∈{ heads
tails
}
⋯
∑
cn∈{ heads
tails
}
(
n
∏
k=1
Prob(ck))(RA○Mcn ○⋯○Mc2µ)(X) = (RA○L′′ ○⋯○L′′
´¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¸¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¶
n−1
µ)(X) (7.6)
for L′′ the map induced by τ ′′(⋅∣⋅) = pτ(⋅∣⋅) + (1 −p)τ ′(⋅∣⋅).
Note that we have a convex
combination of maps, L′′ = pL + (1 −p)L′.
Bounds on the extent of the paradox
Let p be the probability for the coin to give heads. Then, for p ∈(0,1), one may expect the
probability for Alice to win the combined game would necessarily be between the probabilities
for the individual games, with
min{PA,n,P ′
A,n} < P comb
A,n
< max{PA,n,P ′
A,n}
(7.7)
if PA,n ≠P ′
A,n and P comb
A,n
= PA,n = P ′
A,n if PA,n = P ′
A,n. Parrondo’s paradox is that not only is
that expectation false, but it is possible for Alice to have probability greater than one-half
of winning each of the individual games, yet less than one-half for the combined game.
In the common case where the events E are generated by a ﬁnite number of sets, the
Perron-Frobenius theorem [114] [61] gives the conditions on L for there to be a stochastic
vector ν, termed the Perron-Frobenius eigenvector1, such that the sequence ⟨Ljν0⟩converges
in norm to ν regardless of the initial stochastic vector ν0. By generalization, we introduce
the following deﬁnition:
Deﬁnition 7.2.1
A linear map L from F-measures on X to F-measures on a set X has the
Perron-Frobenius property, PF(X,E), if there is a measure ν, termed the Perron-Frobenius
eigenvector, such that the sequence ⟨Ljν0⟩converges in total-variation norm to ν regardless
of the initial unit-norm measure ν0.
Now assume the transition probability functions τ and τ ′ are such that induced maps L and
L′ each are in PF(X;E), as well is their convex combination, pL + (1 −p)L′. Then let PA,
P ′
A, and P comb
A
be the limits as n →∞of PA,n, P ′
A,n and P comb
A,n
respectively. We then have
the question of what values of (PA,P ′
A,P comb
A
) ∈[0,1]×3 occur.
1Also termed the invariant probability distribution [25], the steady-state probability vector [50], or the
invariant measure [62] in the literature.

CHAPTER 7. PARRONDO’S PARADOX
70
Deﬁnition 7.2.2
The classically allowed region, denoted C(A,X,E,p), is the set of all
(PA,P ′
A,P comb
A
) ∈[0,1]×3 that occur, for ﬁxed A, X, E, and p, over all possible transition
probability functions τ and τ ′.
The existence of the paradox is then determined by the intersection of C with the cube
( 1
2,1] × ( 1
2,1] × [0, 1
2). For p = 1, P comb
A
= PA and for p = 0, P comb
A
= P ′
A; clearly no paradox
is possible. We have the following theorems for p ∈(0,1), which indicate that there are
basically only two possibilities, depending on whether we have eﬀectively a two-state system
or one with more than two states, as determined by the event σ-algebra E.
Theorem 7.2.3
For p ∈(0,1), if there are nonempty, disjoint subsets A,B,C ∈E with
A ∪B ∪C = X, then C ⊃(0,1)×3.
Proof
Fix any PA,P ′
A ∈(0,1). Then take any ε > 0 suﬃciently small such that both the
matrices
T =
⎡⎢⎢⎢⎢⎢⎢⎣
1 −(1 −s)ε −( 1
PA −1 −ε)ε2
ε2
1 −s
( 1
PA −1 −ε)ε2
1 −
PAsε
1−(1+ε)PA −ε2
s
(1 −s)ε
PAsε
1−(1+ε)PA
0
⎤⎥⎥⎥⎥⎥⎥⎦
(7.8)
T′ =
⎡⎢⎢⎢⎢⎢⎢⎣
1 −
1−P ′
A
P ′
A ε2
ε2
1
2
1−P ′
A
P ′
A ε2
1 −ε2
1
2
0
0
0
⎤⎥⎥⎥⎥⎥⎥⎦
are stochastic matrices for all values of s ∈[0,1]. Take the transition probability functions
to be
⎡⎢⎢⎢⎢⎢⎣
τ(A∣x ∈A)
τ(A∣x ∈B)
τ(A∣x ∈C)
τ(B∣x ∈A)
τ(B∣x ∈B)
τ(B∣x ∈C)
τ(C∣x ∈A)
τ(C∣x ∈B)
τ(C∣x ∈C)
⎤⎥⎥⎥⎥⎥⎦
= T
(7.9)
⎡⎢⎢⎢⎢⎢⎣
τ ′(A∣x ∈A)
τ ′(A∣x ∈B)
τ ′(A∣x ∈C)
τ ′(B∣x ∈A)
τ ′(B∣x ∈B)
τ ′(B∣x ∈C)
τ ′(C∣x ∈A)
τ ′(C∣x ∈B)
τ ′(C∣x ∈C)
⎤⎥⎥⎥⎥⎥⎦
= T′
Then the required calculations reduce to matrix products. Since the maps are assumed to
have the Perron-Frobenius property, the initial probabilities chosen for A, B, and C are
irrelevant.
By the deliberate construction of T and T′, the ﬁrst entry of the Perron-Frobenius
eigenvector of T is indeed PA for every s ∈[0,1] and the ﬁrst entry of the Perron-Frobenius
eigenvector of T′ is indeed P ′
A. The ﬁrst entry of the Perron-Frobenius eigenvector of pT +

CHAPTER 7. PARRONDO’S PARADOX
71
(1 −p)T′, which gives P comb
A
, varies continuously2 from
ε
p(1−p)
2
+ ε( p
PA + 1−p
P ′
A )
= O(ε)
(7.10)
to
1
1 +
2ε( 1
PA −1 −ε + εp)( p
PA + 1−p
P ′
A −1 −εp)
p(1 −p) + 2ε( 1
PA −1 −ε)
= 1 −O(ε)
(7.11)
as s goes from zero to one. Since ε may be taken arbitrarily small, every value for P comb
A
∈
(0,1) is in the allowed region for the ﬁxed values of PA and P ′
A. ◻
Theorem 7.2.4
If E = {∅,A, ˜A,X}, then C is given by (7.7), so the paradox cannot occur.
Proof
Deﬁne the stochastic matrix S by
S = [ τ(A∣x ∈A)
τ(A∣x ∈˜A)
τ( ˜A∣x ∈A)
τ( ˜A∣x ∈˜A) ]
(7.12)
and the stochastic matrix S′ by
S′ = [ τ ′(A∣x ∈A)
τ ′(A∣x ∈˜A)
τ ′( ˜A∣x ∈A)
τ ′( ˜A∣x ∈˜A) ]
(7.13)
For ﬁxed PA,P ′
A ∈(0,1], express S and S′ as
S = [ 1 −( 1
PA −1)ζ
ζ
( 1
PA −1)ζ
1 −ζ ],S′ =
⎡⎢⎢⎢⎢⎣
1 −( 1
P ′
A −1)ξ
ξ
( 1
P ′
A −1)ξ
1 −ξ
⎤⎥⎥⎥⎥⎦
(7.14)
for ζ ∈(0,min{ PA
1−PA,1}] and ξ ∈(0,min{
P ′
A
1−P ′
A,1}].
By the deliberate construction of S
and S′, the ﬁrst entry of the Perron-Frobenius eigenvector of S is indeed PA for every ζ
and the ﬁrst entry of the Perron-Frobenius eigenvector of S′ is indeed P ′
A for every ξ. For
PA ≠P ′
A, the ﬁrst entry of the Perron-Frobenius eigenvector of pS + (1 −p)S′, which gives
P comb
A
, varies continuously in the interval (min{PA,P ′
A},max{PA,P ′
A}) as ζ,ξ vary over their
allowed values, approaching the extreme values only as either ζ or ξ go to zero since it is a
linear rational function in ζ and ξ. For PA = P ′
A, P comb
A
shares this common value for all ζ,ξ.
For PA = 0, P ′
A ∈(0,1], express S as [ 1 −ζ
0
ζ
1 ] for ζ ∈(0,1] and S′ as above. Then the
ﬁrst entry of the Perron-Frobenius eigenvector of S is PA = 0 for every ζ. The ﬁrst entry
2The eigenvectors of a matrix are continuous functions of the entries of the matrix in any open set where
the eigenvalues are distinct.

CHAPTER 7. PARRONDO’S PARADOX
72
of the Perron-Frobenius eigenvector of pS + (1 −p)S′, which gives P comb
A
, varies continuously
in the interval (0,P ′
A) as ζ,ξ vary over their allowed values, approaching the bounds as
either ζ or ξ go to zero. The symmetric situation holds for P ′
A = 0, PA ∈(0,1]. Finally, for
PA = P ′
A = 0, express S as [ 1 −ζ
0
ζ
1 ] for ζ ∈(0,1] and S′ as [ 1 −ξ
0
ξ
1 ] for ξ ∈(0,1]. Then
P comb
A
= 0 for all ζ,ξ. ◻
Understanding the cause of the paradox
While surprising when approached from the game context, mathematically the cause of the
paradox is straightforward: the coeﬃcients of the Perron-Frobenius eigenvector of a convex
combination of two matrices, M1,M2 →tM1 + (1 −t)M2, need not be in the convex hull
of the coeﬃcients of the Perron-Frobenius eigenvectors of each matrix. Large discrepancies
are possible for certain slivers of parameter values near where eigenvalues coalesce and the
resulting eigenvectors are discontinuous functions of the parameters.
A similar cause is at play in the following analogous hidden classic and quantum versions
of the preceding game. In each case, there is a convex space of matrices of spectral radius
one determining the behavior of the system. A coin ﬂip determining the rule to employ for
the next round has the eﬀect of forming a convex combination of the matrices for each rule.
In the limit as the number of rounds goes to inﬁnity, only the eigenvector of the matrix with
eigenvalue one is of importance, but the coeﬃcients for this eigenvector are not in the convex
hull of the coeﬃcients of the eigenvectors of each matrix, leading to the paradox.
7.3
Classical hidden-Markov chain game
Deﬁning the combined game
As will be proved below, it is possible to have Parrondo’s paradox with a game for a system
with two states if the system is hidden. The game arises from a generalization of the of
the commonly utilized hidden-Markov model [38] to include imagined back-reaction on the
hypothesized hidden state. The standard graphical model (with hidden nodes in gray) is:
k
k
k
k
k
-
-
-
-⋯⋯
-























k
k
k
k
1
2
3
n
J
J
JJ^
J
J
JJ^
J
J
JJ^
(7.15)
However, as has been mentioned in §2.2, this requires interpreting probabilities and/or condi-
tional probabilities concerning unobservable events, which are meaningless in both Bayesian
and frequentist interpretations of probability. Also, this approach has no analogy in the
quantum case.

CHAPTER 7. PARRONDO’S PARADOX
73
Therefore, following the program we have laid out in the ﬁrst part of this dissertation,
the information for hidden nodes can simply be regarded as linear maps on measures, which
is preferable in both avoiding metaphysical notions and in having analogous meaning in the
quantum case. (As has been mentioned in §2.2, this may allow additional maps which do
not arise from transition probability functions, but these are not of great interest and are
not an important motivation for making the change.) Using the pince-nez construction (see
§4.1), this becomes:


k
k
k
k


-
-
⋯
-
-
-
k
k
k
k
1
2
n −1
n
(7.16)
Employing option I’ (the results can be readily recast for option II or more general forms of
option I–see §3.2), we have the following deﬁnition:
Deﬁnition 7.3.1
A hidden-Markov-with-back-reaction-model (R, τ, H, µ, L, ν0) is com-
posed of: an observation set R with base measure η, a hidden set H with base measure µ,
a pince-nez map L ∈B (L1(H;µ),L1(R × H;η × µ)), and an initial, unit-norm measure ν0 on
H that is absolutely continuous with respect to µ.
Then the joint probability to observe (x1,x2,...,xn) ∈A1×A2×⋯×An, for any η-measurable
A1,A2,...,An, is
∫H (SAn ○L ○⋯○SA1 ○Ldν0
dµ )dµ
(7.17)
for SA the linear map from L1(R × H;η × µ) to L1(H;µ) given by the partial integration
SAf = ∫A f dη. Employing this model for the game, then the marginal probability for the
observation to be in A at the nth round (so Alice wins) is
PA,n = ∫H
⎛
⎜
⎝
SA ○L ○N ○⋯○N
´¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¸¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¶
n−1
dν0
dµ
⎞
⎟
⎠
dµ
(7.18)
where N ∈B (L1(H;µ)) is deﬁned as the map N = SR ○L. Because of the deﬁnition of
the game, it is possible to reduce to the case where the event space for R is simply E =
{∅,A, ˜A,X} and its base measure η is the measure with η(A) = η( ˜A) = 1.
Now suppose there is a second model with the same data except for a diﬀerent pince-nez
L′ for each round (it is also possible to have a diﬀerent initial measure, but since the limit
as n →∞will be taken, this is of no consequence). Once again, the two models can be

CHAPTER 7. PARRONDO’S PARADOX
74
combined by ﬂipping a (possibly biased) coin at each round. The graphical model is:


k
k
k
k


-
-
-
⋯
-
-
k
k
k
k
1
2
n −1
n
k
k
k
k
C
CCW
C
CCW
C
CCW
C
CCW
{heads,tails} {heads,tails} {heads,tails} {heads,tails}
(7.19)
Let γ be the previously given probability measure for the coin of p for heads and 1 −p for
tails, with base measure the counting measure. For simplicity of notation, we will identify γ
with its Radon-Nikod´ym derivative
dγ
dcount. For the combined game, the map for each round
is
M(f ⊗γ) = pLf + (1 −p)L′f = L′′f
(7.20)
for L′′ = pL+(1−p)L′. Let N ′,N ′′ ∈B (L1(H;µ)) be deﬁned using L′,L′′ as N was following
(7.18), N ′ = SR ○L′ and N ′′ = SR ○L′′. Then the marginal probability for the observation to
be in A for the nth round (so Alice wins) is
P comb
n
= ∫H SA ○M (⋯(SR ○M ((SR ○M dν0
dµ ) ⊗γ)) ⊗γ⋯)dµ
(7.21)
= ∫H
⎛
⎜
⎝
SA ○L′′ ○N ′′ ○⋯○N ′′
´¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¸¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¶
n−1
dν0
dµ
⎞
⎟
⎠
dµ
Bounds on the extent of the paradox
One may expect the paradox to be present to an equal or greater degree for this more general
class of games. This is indeed the case, as is seen by comparing the statements of theorem
7.2.3 and 7.2.4 with the following theorem 7.3.3 and 7.3.4. Restrict the space of pince-nez
maps to those where N,N ′,N ′′ = pN + (1 −p)N ′ all have the Perron-Frobenius property,
where N,N ′,N ′′ ∈B (L1(H;µ)) are deﬁned from L,L′,L′′ as above. Then, once again, let
PA, P ′
A, and P comb
A
be the limits as n →∞of PA,n, P ′
A,n and P comb
A,n
respectively.
Deﬁnition 7.3.2
The classical-hidden allowed region, denoted CH(A,R,η,H,µ,p), is the
set of all (PA,P ′
A,P comb
A
) ∈[0,1]×3 that occur, for ﬁxed A, R, τ, H, µ, and p, over all allowed
pince-nez maps L and L′.
As in the classical observed case, the existence of the paradox is then determined by the
intersection of CH with the cube ( 1
2,1] × ( 1
2,1] × [0, 1
2). For p = 1, P comb
A
= PA and for p = 0,
P comb
A
= P ′
A; clearly no paradox is possible. We have the following theorems for p ∈(0,1),
which indicate that, once again, there are basically only two possibilities, depending on
whether we have eﬀectively a two-state hidden system or one with more than two states, as
determined by the hidden base measure µ.

CHAPTER 7. PARRONDO’S PARADOX
75
Theorem 7.3.3
For p ∈(0,1), if there are disjoint, µ-measurable subsets B,C,D with
B ∪C ∪D = H and µ(B), µ(C), and µ(D) all strictly positive, then CH ⊃(0,1)×3.
Proof
Pick any ε > 0 and let κ be the map from L1(H;µ) to R3 given by
κ(f) =
⎡⎢⎢⎢⎢⎢⎣
∫B f dµ
∫C f dµ
∫D f dµ
⎤⎥⎥⎥⎥⎥⎦
(7.22)
Let hB, hC, and hD be unit-norm functions in L1(B;µ)+, L1(C;µ)+, and L1(D;µ)+ respec-
tively, each extended to all of H by zero. Such functions certainly exist by the σ-ﬁniteness
of µ. Then deﬁne the pince-nez maps L and L′ by
Lf = 1A ⊗([ hB
0
0 ]Tκ(f)) + 1 ˜
A ⊗([ 0
hC
hD ]Tκ(f))
(7.23)
L′f = 1A ⊗([ hB
0
0 ]T′κ(f)) + 1 ˜
A ⊗([ 0
hC
hD ]T′κ(f))
for T,T′ as in theorem 7.2.3. Because of the properties of B, C, D, hB, hC, hD, and κ, the
required calculation reduces to matrix products.
Then, by the deliberate construction of the maps, the row vector
[ 1
1
1 ]T
⎡⎢⎢⎢⎢⎢⎣
1
0
0
0
0
0
0
0
0
⎤⎥⎥⎥⎥⎥⎦
= [ 1
0
0 ]
(7.24)
acting on the Perron-Frobenius eigenvector of T is its the ﬁrst entry, which is indeed PA for
every s ∈[0,1]. Similarly, [ 1
0
0 ]T′ acting on the Perron-Frobenius eigenvector of T′ is
its ﬁrst entry, which is indeed P ′
A. For the combined game, P comb
A
is given by the row vector
[ 1
1
1 ](pT + (1 −p)T′)
⎡⎢⎢⎢⎢⎢⎣
1
0
0
0
0
0
0
0
0
⎤⎥⎥⎥⎥⎥⎦
= [ 1
0
0 ]
(7.25)
acting on the Perron-Frobenius eigenvector of pT + (1 −p)T′, which is once again its ﬁrst
entry. As in theorem 7.2.3, this varies continuously from 0+O(ε) to 1−O(ε) as ζ goes from
zero to one. Since ε may be taken arbitrarily small, every value for P comb
A
∈(0,1) is in the
allowed region for the ﬁxed values of PA and P ′
A. ◻
Theorem 7.3.4
For p ∈(0,1),if the base measure µ is such that there is a µ-measurable
subset B with µ(B) and µ( ˜B) both strictly positive, but the conditions of the preceding
theorem do not hold, then CH(p) is given by the relatively open region
min{pPA,(1 −p)P ′
A} < P comb
A
< max{1 −p + pPA,p + (1 −p)P ′
A}

CHAPTER 7. PARRONDO’S PARADOX
76
Proof
Represent measures ν on H absolutely continuous with respect to µ by column
vectors with column sum one, [ ν(B)
ν( ˜B) ]. Then all the linear maps from L1(H;µ) to L1(H;µ)
are represented by 2 × 2-matrices acting by the usual matrix product.
Firstly, we will show that CH(p) contains the given region. Fix any PA,P ′
A ∈(0,1]. Then
take any ε > 0 suﬃciently small such that the matrix
N = [ 1 −( 1
PA −1)ε
ε
( 1
PA −1)ε
1 −ε ]
(7.26)
is stochastic. Let
L = 1A ⊗[ 1 −( 1
PA −1)ε
0
( 1
PA −1)ε
0 ] + 1 ˜
A ⊗[ 0
ε
0
1 −ε ]
(7.27)
and, for s ∈[0,1],
N ′ = [
1
2(1 + s)
1
2s
1
2(1 −s)
1 −1
2s ],L′ = P ′
A1A ⊗N ′ + (1 −P ′
A)1 ˜
A ⊗N ′
(7.28)
Then [ 1
1 ]SA○L = [ 1
0 ] acting on the Perron-Frobenius eigenvector of N is its ﬁrst
entry, which is indeed PA by the deliberate construction of the maps. Similarly, [ 1
1 ]SA○
L′ = P ′
A [ 1
1 ] acting on the Perron-Frobenius eigenvector of N ′ is indeed P ′
A for all s. For
the combined game, P comb
A
is given by
[ 1
1 ]SA ○(pL + (1 −p)L′) = p[ 1
0 ] + (1 −p)P ′
A [ 1
1 ]
(7.29)
acting on the Perron-Frobenius eigenvector of pN + (1 −p)N ′.
This varies continuously
from (1 −p)P ′
A + O(ε) to p + (1 −p)P ′
A −O(ε) as s goes from zero to one. Since ε may be
taken arbitrarily small, every value in the interval ((1 −p)P ′
A,p + (1 −p)P ′
A) can be taken
by P comb
A
for the ﬁxed values of PA and P ′
A. Repeating the process with primed↔unprimed
and p ↔1 −p, every value in the interval (pPA,1 −p + pPA) can be taken by P comb
A
for the
ﬁxed values of PA and P ′
A. A similar argument using appropriately modiﬁed maps holds for
either PA or P ′
A or both of them being zero.
Now, we will show that CH(p) is contained in the given region. A key observation is
that instead of varying over all maps SA ○L and SA ○L with positive entries subject to the
constraint that N = SR ○L is stochastic, one may equivalently vary over all stochastic maps
N and row vectors v with entries in [0,1] (with v = [ 1
1 ]S ○L). The same situation
holds for the primed maps. Write v = [ a
b ], N = [ 1 −c
d
c
1 −d ], v′ = [ a′
b′ ], and
N ′ = [ 1 −c′
d′
c′
1 −d′ ], with a,b,c,d,a′,b′,c′,d′ ∈[0,1] except c = d = 0, c = d = 1, c′ = d′ = 0,
and c′ = d′ = 1 are not allowed since the maps must have the Perron-Frobenius property.

CHAPTER 7. PARRONDO’S PARADOX
77
Fixing the values of PA and P ′
A and using explicit expressions for the Perron-Frobenius
eigenvector gives the optimization problem:
constraints: ad + bc = PA(c + d),a′d′ + b′c′ = P ′
A(c′ + d′)
(7.30)
extremize: P comb
A
= (pa + (1 −p)a′)(pd + (1 −p)d′) + (pb + (1 −p)b′)(pc + (1 −p)c′)
p(c + d) + (1 −p)(c′ + d′)
The quantity to be extremized is a rational linear function of c,d,c′,d′; furthermore, the
constraints are homogeneous in the sense that they are unaﬀected by c →ξc, d →ξd for any
positive ξ and c′ →ξ′c′, d′ →ξ′d′ for any positive ξ′. Therefore, the extreme values can only
be attained as either c,d →0 or c′,d′ →0. In the ﬁrst case, using the remaining condition,
the quantity to be extremized is (1 −p)P ′
A + p(ad′ + bc′)
(c′ + d′)
. The term on the right is between
0 and p. In the second case, using the remaining condition, the quantity to be extremized is
pPA + (1 −p)(a′d + b′c)
(c + d)
. The term on the right is between 0 and 1 −p. The actual extreme
values cannot be attained because the maps corresponding to those parameter values are
not allowed. ◻
7.4
Deﬁning a quantum analogue of the Markov
model
An analogous game
As we showed in §3.3, one may consider the analogous game to the above one employing
maps on density matrices rather than maps on measures. This leads to the following Bayesian
network model:
Deﬁnition 7.4.1
A Markov-Bayesian-quantum model (R, η, H, L, ρ0) is composed of: an
observation set R with base measure η, a Hilbert space H, a pince-nez map
L ∈B (D(H),L1(R;η;D(H))) that is norm-preserving (on the positive cone) and completely-
positive, and an initial density-matrix ρ0 on H with tr ρ0 = 1.
The use of the word quantum will be justiﬁed below. The accompanying graphical model is
(note it is the same as (7.16), illustrating the analogy graphically):


k
k
k
k


-
-
⋯
-
-
-
k
k
k
k
1
2
n −1
n
(7.31)
Then the joint probability to observe (x1,x2,...,xn) ∈A1×A2×⋯×An, for any η-measurable
A1,A2,...,An ∈R, is (compare to (7.17))
tr SAn ○L ○⋯○SA1 ○Lρ0
(7.32)

CHAPTER 7. PARRONDO’S PARADOX
78
for SA ∈B (L1(R;η;D(H)),D(H)) the linear map given by the integration SAϕ = ∫A ϕdη.
Employing this model for the game, then the marginal probability for the observation to
be in A at the nth round (so Alice wins) is (compare to (7.18))
PA,n = tr SA ○L ○N ○⋯○N
´¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¸¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¶
n−1
ρ0
(7.33)
where N ∈B (D(H)) is deﬁned as the map SR ○L. Because of the deﬁnition of the game, it
is possible to reduce to the case where the event space for R is simply E = {∅,A, ˜A,X} and
its base measure η is the measure with η(A) = η( ˜A) = 1.
An alternate game using textbook quantum mechanics
Consider the following quantum game that is a generalization of that employed by [28], but
using our simpler winning criterion.
Deﬁnition 7.4.2
A Markov-quantum process (H, q, U ) with: Hilbert space H, number of
quantum channels q, and unitary operator U ∶H⊗q →H⊗q–is the operator
ψ →(IH⊗(q−1)(n−1) ⊗U)⋯(IH⊗(q−1) ⊗U ⊗IH⊗(q−1)(n−2))(U ⊗IH⊗(q−1)(n−1))ψ
for any ψ ∈H⊗((q−1)n+1).
The corresponding quantum circuit for the case of q = 4 is:


 


 


 


 


 
......
...
⋯
⋯
......
q1
q2
q3
q4
q5
q6
q(3n −2)
q(3n −1)
q(3n)
q(3n + 1)
(7.34)
This may be compared to the quantum process with accompanying quantum circuit employed
in [28].
Let {PA1×⋯×An} over all τ-measurable A1,...,An be a complete set of mutually commut-
ing, orthogonal projectors3 on H⊗((q−1)n+1).
A textbook quantum model is then provided by the following:
3A complete set of mutually commuting, orthogonal projectors relative to a base measure µ is deﬁned
similarly with that relative to a σ-algebra except the condition E∅= 0 is replaced by the condition that
µ(B) = 0 ⇒EB = 0.

CHAPTER 7. PARRONDO’S PARADOX
79
Deﬁnition 7.4.3
A Markov-quantum-model (R, τ, H, q, U, {PA1×⋯×An}, ψi) is composed
of: an observation set R with base measure τ, a Markov-quantum process (H, q, U ), a
collection of orthogonal projectors {PA1×⋯×An} as described above, and an initial length-one
vector ψi ∈H⊗((q−1)n+1).
The joint probability to observe (x1,x2,...,xn) ∈A1×A2×⋯×An is then ∥PA1×⋯×Anψf∥2, where
ψf is given by applying the Markov-quantum process to ψi. In particular, the marginal proba-
bility for the observation to be in A at the nth round (so Alice wins) is PA,n = ∥PX×⋯×X×Aψf∥2.
Equivalence of the two models
Start with any Markov-quantum model. The joint probability to observe (x1,x2,...,xn) in
A1 × ⋯× An is given by
∥PA1×⋯×Anψf∥2 = ⟨PA1×⋯×Anψf,ψf⟩= tr PA1×⋯×Anψfψ∗
f
(7.35)
This has a graphical representation as the following tensor network (illustrated for q = 4):
d

 


 


 
d

 


 


 


 


 


 


 


 


 


 


 


 
...
...
...
...
...
...
...
...
...
q1
q2
q3
q4
q5
q6
q7
q(3n −1)
q(3n)
q(3n + 1)
(7.36)
The initial wavefunction ψi = ψ0 ⊗(ψ1)⊗n is on the left, with its conjugate on the right. The
unitary operators U are on the left diagonal, with the adjoints U ∗on the right diagonal.
The projectors are down the center.
Rather than performing the calculation in the diﬃcult manner (left-to-right), the calcu-
lation can be done the easy way (top-to-bottom). This reordering gives rise to the following
graphical model for a Bayesian network, where the labels indicate where the quantum chan-
nels from the quantum circuit and tensor network models go in the latter:


i
 


 
i
 


 
i
 


 








-
-
-



-
-



-
-



6
6
6
⋯⋯
0
1
2
n
-
i
i
i
1
2
n
q1
q2,q3,
q4
q5,q6,
q7
q(3n −1),q(3n),
q(3n + 1)
q1,q2,
q3
q4,q5,
q6
q(3n −2),
q(3n −1),
q(3n)
q(3n + 1)
n
(7.37)

CHAPTER 7. PARRONDO’S PARADOX
80
By replacing each repeated module by a pince-nez, this becomes (7.31). (Note the eﬃciency
of the graphical model for the Bayesian network compared to the tensor network–there is
no need to place every operator and initial condition twice in the graph.) The preceding
graphical manipulation inspires the following:
Theorem 7.4.4
If a Markov-quantum model is of the form
(R,τ,H,q,U,{QA1 ⊗⋯⊗QAn ⊗IH},ψ0 ⊗(ψ⊗n
1 ))
for some unit-length vectors ψ0 ∈H and ψ1 ∈H⊗(q−1) and collection of orthogonal projec-
tors {QC}C∈E on H⊗(q−1), then there is an equivalent (in the sense of giving the same joint
probabilities) Markov-Bayesian-quantum model (R, τ, H, L, ρ0).
Proof
Start with any such Markov-quantum model.
The joint probability to observe
(x1,x2,...,xn) in A1 × ⋯× An is given by
∥PA1×⋯×Anψf∥2 = ⟨PA1×⋯×Anψf,ψf⟩= tr PA1×⋯×Anψfψ∗
f
(7.38)
Write the trace as the tensor product of reduced traces,
trH⊗((q−1)n+1) = (trH⊗(q−1))⊗n ⊗trH
(7.39)
This tensor product of maps is well-deﬁned using A1.3, B4.1, B5.5, and B5.8. Using the
given forms, PA1×⋯×An = QA1 ⊗⋯⊗QAn ⊗IH and ψi = ψ0 ⊗(ψ⊗n
1 ), then “pushing” the partial
traces into the expression as far as possible gives the joint probability as
(K(⋅;An) ⊗trH)(U (((K(⋅;An−1) ⊗IB(H))(⋯
(K(⋅;A2)⊗IB(H))(U(((K(⋅;A1)⊗IB(H))(U(ψ0ψ∗
0 ⊗(ψ1ψ∗
1))U ∗))⊗(ψ1ψ∗
1))U ∗)
⋯)) ⊗(ψ1ψ∗
1))U ∗)
(7.40)
where IB(H) is the identity map on operators in B(H) and
K ∶D (H⊗(q−1)) × ( τ −measurable
subsets of R
) →R
(7.41)
is given by K(ρ;C) = tr QCρ. The various tensor products of maps in the expression are still
well-deﬁned by the above propositions. K is countably-additive in its second argument by
the countable-additivity of the projectors {QC} (with convergence in the weak* topology).
K(⋅;C) is manifestly completely-positive for any C ∈E. Then, by B5.5, and B5.8, ∥K(⋅;C)⊗
IB(H)∥op = ∥K(⋅;C)∥op. Therefore, for any ﬁxed ρ ∈D (H⊗(q−1))
+, K(ρ;⋅) is a measure on R.
Furthermore, this measure is clearly absolutely continuous with respect to τ since QC = 0 if
τ(C) = 0.

CHAPTER 7. PARRONDO’S PARADOX
81
Let N ∶D (H) × E →D (H) be the map given by
MNρ;C) = (K(⋅;C) ⊗IB(H))(U(ρ ⊗(ψ1ψ∗
1))U ∗)
(7.42)
By the above properties of K, for any ﬁxed ρ ∈D (H)+, N(ρ;⋅) is a D (H)+-valued vector mea-
sure on R that is absolutely continuous with respect to τ. D (H) has the Radon-Nikod´ym
property, so N(ρ;⋅) has Radon-Nikod´ym derivative dN(ρ;⋅)
dτ
∈L1(R;τ;D (H)+) with the prop-
erty that N(ρ;C) = ∫C
dN(ρ;⋅)
dτ
dτ for any τ-measurable subset C. Then deﬁne the pince-nez
map L by Lρ = dN(ρ;⋅)
dτ
. The required completely-positive and norm-preserving (on the posi-
tive cone) properties of L are readily demonstrated. ◻
More remarkable (and requiring theorem 5.1.1 to prove) is the following result:
Theorem 7.4.5
If a Markov-Bayesian-quantum model is of the form (R, τ, H, L, ψ0ψ∗
0),
then there is an equivalent (in the sense of giving the same joint probabilities) Markov-
quantum-model
(R′,τ ′,H,q,U,{PA1×⋯×An},ψi)
Proof
Start with any such Markov-Bayesian-quantum model. From theorem 5.1.1 and
the Radon-Nikod´ym property of D(H), L can be written in terms of the Radon-Nikod´ym
derivative, Lρ = dN(ρ;⋅)
dτ
, with
N(ρ;B) = (trK ⊗P(B) ⊗IB(H))(V ρV ∗)
(7.43)
for some Hilbert space K, some partial isometry V ∶L2(H →K ⊗L2(R;τ) ⊗H, and where
P(B) is the functional on D(L2(R;τ)) given by P(B)τ = ∫x∈B τ(x,x) dν(x). Furthermore,
by the theorem, if all the Hilbert spaces have ﬁnite dimension, the dimension of K less than
or equal to (dimH)2.
The dimension of L2(R;τ) then determines the minimum number of quantum channels,
q. If dimL2(R;τ) ≤(dimH), take q = 4. If dimH < dimL2(R;τ) ≤(dimH)2, take q = 5.
If (dimH)2 < dimL2(R;τ) ≤(dimH)3, take q = 6. For any of these three cases, take Q
to be any partial isometry from L2(R;τ) to H⊗(q−3). For (dimH)3 < dimL2(R;τ), let G
be the subspace of L2(R;τ) which is relevant, given by the norm-closure of the span of
{(ψ∗⊗π(1) ⊗ξ∗)V φ∣φ,ψ ∈H,ξ ∈K}. Then dimG ≤(dimH)2 dimK ≤(dimH)4, so take q = 7
and Q to be any partial isometry from G to H⊗4.
Now select any unit-length ψ1 ∈H⊗(q−1) and any partial isometry R ∶K →H ⊗H. Then
there is some unitary U ∶H⊗q →H⊗q such that
U(φ ⊗ψ1) = (R ⊗Q ⊗IH)V φ for every φ ∈H
(7.44)
Hence, by the spectral theorem for compact operators,
U(ρ ⊗ψ1ψ∗
1)U ∗= (R ⊗Q ⊗IH)V ρV ∗(R∗⊗Q∗⊗IH) for every ρ ∈D(H)+
(7.45)

CHAPTER 7. PARRONDO’S PARADOX
82
Take ψi = ψ0⊗(ψ⊗n
1 ). Finally, if dimL2(X;µ) = (dimH)q−3 or dimG = (dimH)4, take X ′ = X,
τ ′ = τ, and PA1×⋯×An to be
(IH⊗2⊗Qπ(1A1)Q∗) ⊗⋯⊗(IH⊗2⊗Qπ(1An)Q∗)⊗IH
(7.46)
Otherwise, add one point x0 to X to form X ′. Add an atom of weight one at x0 to τ to form
τ ′. For A1,...,An ∈E, let PA1×⋯×An be deﬁned as above. Replacing any of the Aj’s with
{x0}, replace Qπ(1Aj)Q∗with IH⊗(q−3) −Q∗Q. (Note that with the given initial wavefunction
and time-evolution, the probabilities for observing {x0} are all zero–it is only added so the
projectors form a complete set with PX ′×n = IH⊗((q−1)n+1.) ◻
7.5
Parrondo’s paradox for the quantum game
Deﬁning the combined game
As a reward for our eﬀorts in part I and in the preceding section, we can now ignore the
complicated Markov-quantum model and instead utilize the far simpler Markov-Bayesian-
quantum model. Furthermore, since the latter model uses maps that live on a convex space,
it is possible to utilize coin ﬂips to combine two games instead of the recourse to more
complicated alternating rules for rounds previously used by [28] [52]. This combined game
has graphical model (note it is the same as (7.19)):


k
k
k
k


-
-
-
⋯
-
-
k
k
k
k
1
2
n −1
n
k
k
k
k
C
CCW
C
CCW
C
CCW
C
CCW
{heads,tails} {heads,tails} {heads,tails} {heads,tails}
(7.47)
Again, let γ be the previously given probability measure for the coin of p for heads and 1−p
for tails, and, for simplicity of notation, identify γ with its Radon-Nikod´ym derivative with
respect to the counting measure. For the combined game, the map for each round is
M(ρ ⊗γ) = pLρ + (1 −p)L′ρ = L′′ρ
(7.48)
for L′′ = pL + (1 −p)L′. Let N ′,N ′′ ∈B (D(H)) be deﬁned using L′,L′′ as N was following
(7.33),as N ′ = SR ○L′ and N ′′ = SR ○L′′. Then the marginal probability for the observation
to be in A for the nth round (so Alice wins) is (compare to (7.21))
P comb
A,n
= tr SA ○M (⋯(SR ○M ((SR ○Mρ0) ⊗γ)) ⊗γ⋯)dµ
(7.49)
= tr SA ○L′′ ○N ′′ ○⋯○N ′′
´¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¸¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¹¶
n−1
ρ0
Because of the deﬁnition of the game, it is possible to reduce to the case where E =
{∅,A, ˜A,X}.

CHAPTER 7. PARRONDO’S PARADOX
83
Bounds on the paradox for the quantum game
Since it is possible to embed a classical hidden system within a quantum one (see §3.6),
one may expect the paradox to be present to an equal or greater degree for these quantum
games. This is indeed the case, as is seen by comparing the statements of theorems 7.3.3
and 7.3.4 with the following theorem 7.5.3 and claim 7.5.5. By analogy to deﬁnition 7.2.1,
we have:
Deﬁnition 7.5.1
A linear map L from D(H)+ to D(H)+ has the quantum-Perron-Frobenius
property, QPF(H), if there is a density matrix ρ, termed the quantum-Perron-Frobenius
eigenvector, such that the sequence ⟨Ljρ0⟩converges in total-variation norm to ρ regardless
of the initial unit-norm density matrix ρ0.
Restrict the space of pince-nez maps L,L′ to those where N ,N ′, and their convex combi-
nation, pN + (1 −p)N ′, are all in QPF(H). Then, once again, let PA, P ′
A, and P comb
A
be the
limits as n →∞of PA,n, P ′
A,n and P comb
A,n
respectively.
Deﬁnition 7.5.2
The quantum allowed region, denoted Q(A,X,E,H,p), is the set of all
(PA,P ′
A,P comb
A
) ∈[0,1]×3 that occur, for ﬁxed A, X, E, H, and p, over all allowed pince-nez
maps L and L′.
As in the classical case, the existence of the paradox is then determined by the intersection
of Q with the cube ( 1
2,1] × ( 1
2,1] × [0, 1
2). For p = 1, P comb
A
= PA and for p = 0, P comb
A
= P ′
A;
clearly no paradox is possible. We have the following theorem and claims for p ∈(0,1), which
indicate that, once again, there are basically only two possibilities, depending on whether
we have dimH = 2 or dimH > 2.
Theorem 7.5.3
For p ∈(0,1), if dimH > 2, then Q ⊃(0,1)×3.
Proof
Pick any ε > 0 Let H1,H2,H3 be three non-trivial subspaces of H such that H =
H1 ⊕H2 ⊕H3. Choose any density matrices ν1 ∈D(H1)+, ν2 ∈D(H2)+, ν3 ∈D(H3)+ with unit
trace. Let κ ∶D(H)+ →R3 be the map
κ(ρ) =
⎡⎢⎢⎢⎢⎢⎣
tr ρ∣H1
tr ρ∣H2
tr ρ∣H3
⎤⎥⎥⎥⎥⎥⎦
(7.50)
and deﬁne the pince-nez maps L and L′ by
Lρ = 1A ⊗[ ν1
0
0 ]Tκ(ρ) + 1 ˜
A ⊗[ 0
ν2
ν3 ]Tκ(ρ)
(7.51)
L′ρ = 1A ⊗[ ν1
0
0 ]T′κ(ρ) + 1 ˜
A ⊗[ 0
ν2
ν3 ]T′κ(ρ)
for T,T′ as in theorem 7.2.3. Because of the properties of ν1, ν2, ν3, and κ, the required
calculation reduces to matrix products, which then proceeds as in the proof for theorem

CHAPTER 7. PARRONDO’S PARADOX
84
7.3.3. ◻
Employing a similar construction, for dimH = 2 we have Q(p) ⊃CH(p). We have the
following two claims, backed by extensive numerical calculation:
Claim 7.5.4
For any ﬁxed p,PA,P ′
A ∈(0,1), the minimum and maximum values of P comb
A
are achieved for pince-nez maps L and L′ each of the form ρ →1A ⊗JρJ∗+ 1 ˜
A ⊗KρK∗.
Claim 7.5.5
For any ﬁxed p,PA,P ′
A ∈(0,1), the minimum and maximum values of P comb
A
lie outside the bounds given in theorem 7.3.3.
Assuming the validity of the ﬁrst claim, the extremizing maps can be expressed as
Lρ = 1A ⊗[ u1
v1
u2
v2 ]ρ[ u1
u2
v1
v2 ] + 1 ˜
A ⊗[ u3
v3
u4
v4 ]ρ[ u3
u4
v3
v4 ]
(7.52)
L′ρ = 1A ⊗[ u′
1
v′
1
u′
2
v′
2
]ρ[ u′
1
u′
2
v′
1
v′
2
] + 1 ˜
A ⊗[ u′
3
v′
3
u′
4
v′
4
]ρ[ u′
3
u′
4
v′
3
v′
4
]
for ∥⃗u∥2 = ∥⃗v∥2 = 1, ⃗u ⊥⃗v except for points excluded by the requirement of the quantum
Perron-Frobenius property. We are then faced by the following optimization problem, which
may be treated numerically:
constraints: ⃗wM−1
⎡⎢⎢⎢⎢⎢⎢⎢⎣
0
0
0
1
⎤⎥⎥⎥⎥⎥⎥⎥⎦
= PA, ⃗w′M′−1
⎡⎢⎢⎢⎢⎢⎢⎢⎣
0
0
0
1
⎤⎥⎥⎥⎥⎥⎥⎥⎦
= P ′
A
(7.53)
extremize: P comb
A
= (p ⃗w + (1 −p) ⃗w′)(pM + (1 −p)M′)−1
⎡⎢⎢⎢⎢⎢⎢⎢⎣
0
0
0
1
⎤⎥⎥⎥⎥⎥⎥⎥⎦
for
⃗w = [ ∣u1∣2 + ∣u2∣2
u1v1 + u2v2
u1v1 + u2v2
∣v1∣2 + ∣v2∣2 ]
(7.54)
⃗w′ = [ ∣u′
1∣2 + ∣u′
2∣2
u′
1v′
1 + u′
2v′
2
u′
1v′
1 + u′
2v′
2
∣v′
1∣2 + ∣v′
2∣2 ]
M =
⎡⎢⎢⎢⎢⎢⎢⎢⎣
∣u1∣2 + ∣u3∣2 −1
u1v1 + u3v3
v1u1 + v3u3
∣v1∣2 + ∣v3∣2
u1u2 + u3u4
u1v2 + u3v4 −1
v1u2 + v3u4
v1v2 + v3v4
u2u1 + u4u3
u2v1 + u4v3
v2u1 + v4u3 −1
v2v1 + v4v3
1
0
0
1
⎤⎥⎥⎥⎥⎥⎥⎥⎦
M′ =
⎡⎢⎢⎢⎢⎢⎢⎢⎢⎣
∣u′
1∣2 + ∣u′
3∣2 −1
u′
1v′
1 + u′
3v′
3
v′
1u′
1 + v′
3u′
3
∣v′
1∣2 + ∣v′
3∣2
u′
1u′
2 + u′
3u′
4
u′
1v′
2 + u′
3v′
4 −1
v′
1u′
2 + v′
3u′
4
v′
1v′
2 + v3v′
4
u′
2u′
1 + u′
4u′
3
u′
2v′
1 + u′
4v′
3
v′
2u′
1 + v′
4u′
3 −1
v′
2v′
1 + v′
4v′
3
1
0
0
1
⎤⎥⎥⎥⎥⎥⎥⎥⎥⎦

CHAPTER 7. PARRONDO’S PARADOX
85
Graphs, for certain representative values of p, of the minimum achievable P comb
A
given PA,P ′
A,
are given in the following section.
7.6
Summary of results
In summary, for the considered classical game whose event space E is eﬀectively three or
more states, the analogous classical hidden game whose σ-algebra F for its hidden set is
eﬀectively three or more states, and the analogous quantum game whose Hilbert space is
three or more dimensions, we have proven there is no limitation on the probability for Alice
to win the combined game, P comb
A
, given her probabilities to win the individual games, PA
and P ′
A. For the classical game with two-states, E = {∅,A, ˜A,O}, we have proven the paradox
cannot occur. For the analogous classical hidden game with two-states, F = {∅,B, ˜B,H},
we have
min{pPA,(1 −p)P ′
A} < P comb
A
< max{1 −p + pPA,p + (1 −p)P ′
A}
(7.55)
where p ∈(0,1) is the probability for the coin to land heads.
The following contour plots illustrate the lower bounds on P comb
A
for the two represen-
tative values of p = 0.5 (the fair coin) and p = 0.1. The paradox is displayed by minimum
achievable values of P comb
A
being less than one-half in the region (PA,P ′
A) ∈( 1
2,1]×( 1
2,1]. For
comparison, plots of the minimum achieved P comb
A
for the analogous quantum game whose
Hilbert space H has dimension two, which were numerically calculated from the optimization
problem posed in (7.53), are given as well.

CHAPTER 7. PARRONDO’S PARADOX
86
 0.05 
 0.1 
 0.15 
 0.2 
 0.25 
 0.3 
 0.35 
 0.4 
 0.45 
0.0
0.2
0.4
0.6
0.8
1.0
0.0
0.2
0.4
0.6
0.8
1.0
PA
P ′
A
Figure 7.1: Minimum achievable values of P comb
A
for p = 0.5 for the two-state, classical hidden
game.
 0.02 
 0.04 
 0.06 
 0.08 
0.0
0.2
0.4
0.6
0.8
1.0
0.0
0.2
0.4
0.6
0.8
1.0
PA
P ′
A
Figure 7.2: Minimum achievable values of P comb
A
for p = 0.1 for the two-state, classical hidden
game.

CHAPTER 7. PARRONDO’S PARADOX
87
 0.02 
 0.04 
 0.06 
 0.08 
 0.1 
 0.12 
 0.14 
 0.16 
 0.18 
0.0
0.2
0.4
0.6
0.8
1.0
0.0
0.2
0.4
0.6
0.8
1.0
PA
P ′
A
Figure 7.3: Minimum achievable values of P comb
A
for p = 0.5 for the two-dimensional, quantum
game.
 0.02 
 0.04 
 0.06 
 0.08 
0.0
0.2
0.4
0.6
0.8
1.0
0.0
0.2
0.4
0.6
0.8
1.0
PA
P ′
A
Figure 7.4: Minimum achievable values of P comb
A
for p = 0.1 for the two-dimensional, quantum
game.

88
Chapter 8
A Parrondo-like paradox for an
one-round game
8.1
Deﬁning the game
Instead of the multi-round game considered in the preceding chapter, now consider a single
round quantum game where the winning criteria is still taken to be that the observation is
in some speciﬁed set A. Instead of having two maps which are combined by a coin ﬂip, the
map is now ﬁxed and only the initial states are varied. If they were combined in a convex
combination by ﬂipping a coin, there would clearly be no Parrondo’s paradox since the prob-
abilities depend linearly on the initial state. However, if the initial states were constrained
to be rank one (hence, described by a wavefunction), instead of a convex combination, one
may consider the minimizing geodesic joining them. If two initial states both give probabil-
ity greater than one-half for the ﬁrst player, Alice, to win, but there is somewhere on the
minimizing geodesic where the second player, Bob, has probability greater than one-half to
win, we will term that a Parrondo-like paradox.
Suppose there is a continuous control, say a slider with continuous values from zero to
one, which varies the initial state along a geodesic in the space of rank-one density matrices.
Using the Bayesian network model, this initial state is input into a ﬁxed pince-nez map and
the outcome observed. The graphical model is:




-
{ S ∈[0,1]
C
C
CCW
k
(8.1)
Employing option I’ (see §3.2), the data for the initial node is ([0,1],Lebesgue;H;K) for
some given Hilbert space H. The map K will be determined below in §8.2. The data for the
pince-nez is (H;R,τ;;L) for some given observable set R with base measure τ. By the rules

CHAPTER 8. A PARRONDO-LIKE PARADOX FOR AN ONE-ROUND GAME
89
of the game, it is possible to reduce to the case where the σ-algebra is {∅,A, ˜A,R} with base
measure τ assigning both A and ˜A the value one. Suppose L is also given.
The probability for the observation to be in set A (so Alice wins) is then
∫A(L ○K)ν dτ = ((L ○K)ν)∣A
(8.2)
8.2
Deﬁning geodesics on the space of wavefunctions
Let SH ⊂H be the unit ball. For any ζ,η ∈S, let ∼be the equivalence relation ζ ∼η if ζ = ωη
for some phase ω ∈S1 ⊂C and let [⋅] denote the equivalence classes. Consider a wavefunction
ψ ∈SH. Since only the rank-one density matrix ψψ∗= ψ⟨⋅,ψ⟩is meaningful, ψ is only deﬁned
up to an overall phase, so what should actually be considered is the equivalence class [ψ]
in the quotient space SH/ ∼. The question is then what is the correct topology and metric
structure to place on this quotient space.
Choice one–using the trace norm
Using the topology and metric structure inherited from the placement of rank-one density
matrices within all density matrices, consider the choice of metric disttrace on SH/ ∼given by,
for any [ξ],[ψ] ∈S/ ∼,
disttrace([ξ],[ψ]) = tr ∣ξξ∗−ψψ∗∣= 2
√
1 −∣⟨ψ,ξ⟩∣2
(8.3)
The last equality holds since spanC{ξ,ψ} is an invariant subspace of the operator
(ξξ∗−ψψ∗)∗(ξξ∗−ψψ∗) = (ξξ∗−ψψ∗)2
(8.4)
with eigenvalue 1 −∣⟨ψ,ξ⟩∣2 while the orthogonal subspace is the kernel of the operator.
Choice two–using the round metric on SH
Let distround be the round metric on SH, which is the standard metric induced by its embed-
ding in H equipped with its norm, so, for any ζ,η ∈SH,
distround(ζ,η) = arccosR⟨ζ,η⟩
(8.5)
Then let the metric dist∼round on SH/ ∼be given by the usual prescription for quotient spaces,
so, for any [ξ],[ψ] ∈SH/ ∼,
dist∼round([ξ],[ψ]) = min
w∈S1⊂Cdistround(ξ,wψ) = arccos max
w∈S1⊂CR⟨ψ,wξ⟩= arccos∣⟨ψ,ξ⟩∣
(8.6)
Then
disttrace([ξ],[ψ]) = 2sindist∼round([ξ],[ψ])
(8.7)
⇔dist∼round([ξ],[ψ]) = arcsin 1
2disttrace([ξ],[ψ])
In particular, the metrics are equivalent and give rise to the same topology on SH/ ∼.

CHAPTER 8. A PARRONDO-LIKE PARADOX FOR AN ONE-ROUND GAME
90
Geodesics on the quotient space
Fix any ξ,ψ ∈SH with corresponding equivalence classes [ξ],[ψ] ∈SH/ ∼.
Let ˆξ be an
element of [ξ] such that distround(ˆξ,ψ) = dist∼round([ξ],[ψ]) ⇔⟨ψ, ˆξ⟩= ∣⟨ψ,ξ⟩∣, so ˆξ =
⟨ψ,ξ⟩
∣⟨ψ,ξ⟩∣ξ if ⟨ψ,ξ⟩≠0 while ˆξ can be any element of [ξ] if ⟨ψ,ξ⟩= 0. Now take the arc
γ ∶[0,distround(ˆξ,ψ)] →SH of the great circle in SH connecting ψ and ˆξ with the standard
parametrization, given by
γ(θ) = (cosθ)ψ + (sinθ)
ˆξ −⟨ˆξ,ψ⟩ψ
∥ˆξ −⟨ˆξ,ψ⟩ψ∥
(8.8)
where ∥ˆξ −⟨ˆξ,ψ⟩ψ∥=
√
⟨ˆξ −⟨ˆξ,ψ⟩ψ, ˆξ −⟨ˆξ,ψ⟩ψ⟩=
√
1 −⟨ˆξ,ψ⟩2.
Proposition 8.2.1
The curve [γ] in SH/ ∼is an unit speed geodesic with respect to the
metric dist∼round.
Proof
For any θ ∈(0,distround(ˆξ,ψ)),
dist∼round([γ(θ)],[ψ]) + dist∼round([ξ],[γ(θ)]) = distround(γ(θ),ψ) + distround(ˆξ,γ(θ)) (8.9)
= distround(ˆξ,ψ)
= dist∼round([ξ],[ψ])
so not only is the curve [γ] a geodesic, but by further partitioning, the metric is seen to be
precisely the arclength of the geodesic. Also, for any θ ∈(0,distround(ˆξ,ψ)),
lim
ε→0+
1
ε dist∼round([γ(θ + ε)],[γ(θ)]) = lim
ε→0+
1
ε arccos(cos(ε)) = lim
ε→0+
∣ε∣
ε = 1
(8.10)
so the curve is unit speed. ◻
Proposition 8.2.2
The curve [γ] in SH/ ∼is a geodesic with respect to the metric disttrace.
Proof
Since 2sinz = 2z + O(z3) as z →0, the arclength of a curve with respect to the
metric disttrace is simply twice the arclength with respect to the metric dist∼round. Hence, the
two metrics have the same geodesics.◻
Completing the deﬁnition of the game.
We still need to deﬁne the initialization map K from §8.1 which uses the slider position to
determine a point on the geodesic. From the preceding results on geodesics, K is determined

CHAPTER 8. A PARRONDO-LIKE PARADOX FOR AN ONE-ROUND GAME
91
by ﬁrst ﬁxing the endpoints [ξ],[ψ] ∈SH/ ∼. Let δ = dist∼round([ξ],[ψ]). Then, for ν a
measure on [0,1] absolutely continuous with respect to Lebesgue measure λ,
K dν
dλ = ∫x∈[0,1] γ(xδ)γ(xδ)∗dν(x)
(8.11)
If ν is suﬃciently concentrated, then, as desired, the image of K is approximately rank-one.
The complication of dealing with a concentrated measure ν for the slider position is another
instance of the previously mentioned problem (see §3.2 and §4.5) of inputting parameters
encountered when employing option I’–the value of the slider cannot be read in directly.
For purposes of simplicity and clarity, in the remainder we will instead simply suppose we
can directly select the desired point on the geodesic and work with strictly rank-one density
matrices.
8.3
Bounds on the extent of the Parrondo-like
paradox
To quantify the extent of the Parrondo-like paradox, by analogy to §7 we have PA, P ′
A, as
the probability Alice wins with initial wavefunction [ξ] and [ψ] respectively. Deﬁne P geo
A
as the probability Alice wins with initial wavefunction for a speciﬁed point on the geodesic
joining [ξ] and [ψ]. Analogously to deﬁnition 7.5.2, we have the following:
Deﬁnition 8.3.1
The quantum allowed region, denoted Q(A,R,τ,H), is the set of all
(PA,P ′
A,P geo
A ) ∈[0,1]×3 that occur–for ﬁxed A, R, τ, and H–over all allowed pince-nez maps
L, initial wavefunctions [ξ] and [ψ], and points on the geodesic joining them.
The paradox can occur if Q intersects the cube ( 1
2,1] × ( 1
2,1] × [0, 1
2). We have the following
theorem giving Q precisely:
Theorem 8.3.2
If the Hilbert space H is nontrivial, Q is the closed region
max{0,PA + P ′
A −1} ≤P geo
A
≤min{PA + P ′
A,1}
Proof
Since the bounded operators are dual to the trace-class ones, there is some self-
adjoint operator η ∈B(H) such that L(ρ)∣A = tr ηρ for every ρ ∈D(H)+ and, by B5.15 and
B5.16, every ρ ∈S1(H). The condition on η is that it is in the order interval 0 ≤η ≤IH. Let
the 2 × 2-, Hermitian matrix B = [bjk] be given by
[ L(ψψ∗)∣A
L(ψˆξ∗)∣A
L(ˆξψ∗)∣A
L(ξξ∗)∣A
] = [ ⟨ηψ,ψ⟩
⟨ηψ, ˆξ⟩
⟨ηˆξ,ψ⟩
⟨ηξ,ξ⟩]
(8.12)
Let B be the set of all such matrices over 0 ≤η ≤IH and ψ,ξ ∈SH.

CHAPTER 8. A PARRONDO-LIKE PARADOX FOR AN ONE-ROUND GAME
92
To get a simpler characterization of B, let C be the union of order intervals of 2 × 2-,
Hermitian matrices given by
⋃
δ∈[0, π
2 ]
{0 ≤C ≤[
1
cosδ
cosδ
1
]}
(8.13)
The claim is that B = C. To see this is true, take any B ∈B. Since η ≥0, for any a,b ∈C,
[ a
b ]B [ a
b ] = [ a
b ][ ⟨ηψ,ψ⟩
⟨ηψ, ˆξ⟩
⟨ηˆξ,ψ⟩
⟨ηξ,ξ⟩][ a
b ] = ⟨η(aψ + bˆξ),aψ + bˆξ⟩≥0
(8.14)
Therefore, B ≥0. Similarly, since IH −η ≥0, for cosδ = ⟨ψ, ˆξ⟩,
[ a
b ]([
1
cosδ
cosδ
1
] −B)[ a
b ] = [ a
b ][ ⟨(IH −η)ψ,ψ⟩
⟨(IH −η)ψ, ˆξ⟩
⟨(IH −η)ˆξ,ψ⟩
⟨(IH −η)ξ,ξ⟩][ a
b ]
(8.15)
= ⟨(IH −η)(aψ + bˆξ),aψ + bˆξ⟩
which is always greater than or equal to zero, so B ≤[
1
cosδ
cosδ
1
] for δ = arccos⟨ψ, ˆξ⟩∈
[0, π
2]. Hence, B ⊂C.
Now take any C ∈C, so there is some δ ∈[0, π
2] such that C ≤[
1
cosδ
cosδ
1
]. Since
H is nontrivial, it has a pair of orthonormal vectors, {e1,e2}. Take ψ = e1 and ξ = ˆξ =
cosδe1 + sinδe2, which are both clearly of unit norm. Take the operator η to be zero on the
complement of the span of {e1,e2}. On the span, using {e1,e2} as the basis, let η be given
by
C = [ ⟨ηψ,ψ⟩
⟨ηψ, ˆξ⟩
⟨ηˆξ,ψ⟩
⟨ηξ,ξ⟩] = [
1
0
cosδ
sinδ ]η [ 1
cosδ
0
sinδ ]
(8.16)
⇔η = [
1
0
cosδ
sinδ ]
−1
C [ 1
cosδ
0
sinδ ]
−1
Then, since C ≥0, clearly η ≥0. Since C ≤[
1
cosδ
cosδ
1
], for v = [ 1
cosδ
0
sinδ ]
−1
[ a
b ],
[ a
b ](IH −η)[ a
b ] = v∗([
1
cosδ
cosδ
1
] −C)v ≥0
(8.17)
Hence, η ≤IH, so C ⊂B and B = C.
Therefore, using the above expression (8.8) for the geodesic and ∥ˆξ −⟨ˆξ,ψ⟩ψ∥= sinδ, we
wish to extremize
P geo
A
=
1
sin2 δ [ sin(δ −θ)
sinθ ]B [ sin(δ −θ)
sinθ
]
(8.18)

CHAPTER 8. A PARRONDO-LIKE PARADOX FOR AN ONE-ROUND GAME
93
over all 0 ≤B ≤[
1
cosδ
cosδ
1
], δ ∈[0, π
2], and θ ∈[0,δ] for ﬁxed PA = b11 and P ′
A = b22.
Setting the imaginary parts of the oﬀ-diagonal entries of B to zero keeps B in the allowed
order interval and does not change the value of PA, P ′
A, or P geo
A , so B can be taken real.
For ﬁxed δ and θ, the expression in (8.18) is linear in B. Since the allowed B form a
convex set, the extrema are achieved on the set of extreme points, so B can be restricted
to either (i) being rank one or (ii) having [
1
cosδ
cosδ
1
] −B be rank one. For case (i), we
have two subcases for the choice of either + or −in
B = [
b11
±√b11b22
±√b11b22
b22
]
(8.19)
Choosing the +, then b11,b22 ∈[0,1] with
max{0,
√
b11b22 −
√
(1 −b11)(1 −b22)} ≤cosδ ≤min{1,
√
b11b22 +
√
(1 −b11)(1 −b22)} (8.20)
and θ ∈[0,δ]. Let f max
1
(b11,b22) be the maximum of (8.18) over all allowed δ,θ for the given
b11,b22 and f min
1
(b11,b22) be the minimum. Then f max
1
(b11,b22) = min{b11 + b22,1}, with the
maximizing δ0,θ0 given by δ0 = π
2, sinθ0 =
√
b22
b11+b22 if b11 + b22 ≤1 and by cosδ0 = √b11b22 −
√
(1 −b11)(1 −b22), sinθ0 = √1 −b11 if b11 + b22 > 1. The minimum bound is f min
1
(b11,b22) =
min{b11,b22}, with the minimizing δ0,θ0 given by θ0 = 0 if b11 ≤b22 and θ0 = δ0 if b11 > b22,
with δ0 arbitrary. Choosing the −, then (b11,b22) ∈[0,1]×2 ∩{b11 + b22 ≤1} with
0 ≤cosδ ≤min{1,
√
(1 −b11)(1 −b22) −
√
b11b22}
(8.21)
and θ ∈[0,δ]. Let f max
2
(b11,b22) be the maximum of (8.18) over all allowed δ,θ for the given
b11,b22 and f min
2
(b11,b22) be the minimum.
Then f max
2
(b11,b22) = max{b11,b22}, with the
maximizing δ0,θ0 given complementary to that for the preceding f min
1
. The minimum bound
is f min
2
(b11,b22) = 0, with the minimizing δ0,θ0 given by δ0 = π
2, sinθ0 =
√
b11
b11+b22.
For case (ii), once again we have two subcases for the choice of either + or −in
B = [
b11
cosδ ±
√
(1 −b11)(1 −b22)
cosδ ±
√
(1 −b11)(1 −b22)
b22
]
(8.22)
Choosing the +, then (b11,b22) ∈[0,1]×2 ∩{b11 + b22 ≥1} with
0 ≤cosδ ≤min{1,
√
b11b22 −
√
(1 −b11)(1 −b22)}
(8.23)
and θ ∈[0,δ]. Let f max
3
(b11,b22) be the maximum of (8.18) over all allowed δ,θ for the given
b11,b22 and f min
3
(b11,b22) be the minimum. Then f max
3
(b11,b22) = 1, with the minimizing δ0,θ0
given by δ0 = π
2, sinθ0 =
√
1−b11
2−b11−b22. The minimum bound is f min
3
(b11,b22) = min{b11,b22} with

CHAPTER 8. A PARRONDO-LIKE PARADOX FOR AN ONE-ROUND GAME
94
the minimizing δ0,θ0 given similarly to that for the preceding f min
1
. Choosing the −, then
b11,b22 ∈[0,1] with
max{0,
√
(1 −b11)(1 −b22) −
√
b11b22} ≤cosδ ≤min{1,
√
(1 −b11)(1 −b22) +
√
b11b22} (8.24)
and θ ∈[0,δ].
Let f max
4
(b11,b22) be the maximum of (8.18) over all allowed δ,θ for the
given b11,b22 and f min
4
(b11,b22) be the minimum. Then f max
4
(b11,b22) = min{b11,b22} with
the maximizing δ0,θ0 given similarly to that for the preceding f min
1
. The minimum bound is
f min
4
(b11,b22) = max{0,b11 + b22 −1}, with the minimizing δ0,θ0 given by cosδ0 = √1 −b11
√1 −b22 −√b11b22, sinθ0 = √b11 if b11 + b22 ≤1 and δ0 = π
2, sinθ0 =
√
1−b22
2−b11−b22 if b11 + b22 > 1.
Putting the cases and subcases together, the minimum value of P geo
A
for ﬁxed PA,P ′
A is
given by
(f min
1
∧f min
2
∧f min
3
∧f min
4
)(PA,P ′
A) = f min
4
(PA,P ′
A) = max{0,PA + P ′
A −1}
(8.25)
The maximum value of P geo
A
for ﬁxed PA,P ′
A is given by
(f max
1
∨f max
2
∨f max
3
∨f max
4
)(PA,P ′
A) = f max
1
(PA,P ′
A) = min{PA + P ′
A,1}
(8.26)
With ﬁxed values for PA and P ′
A, within each case and subcase P geo
A
is a continuous function
of δ and θ, so all intermediate values for P geo
A
are achieved. ◻
Note that, by the result of the preceding theorem, the paradox can only occur for values of
(PA,P ′
A) in the triangle bounded by PA > 1
2, P ′
A > 1
2, and PA + P ′
A < 3
2.
8.4
Conditions for the occurrence of the
Parrondo-like paradox
The matrix B deﬁned in the proof of the preceding theorem (8.12) puts restrictions on the
occurrence of the paradox. If B ≤1
2I2 then both PA and P ′
A are less than or equal to one-
half, so the paradox cannot occur for any choices of [ψ], [ξ], or point on the geodesic joining
them. Similarly, if the trace of B is less than or equal to one, then either PA or P ′
A is less
than one-half, so the paradox also cannot occur. From these obvious statements, we then
have the following nontrivial result:
Theorem 8.4.1
If, for any particular orthonormal e1,e2 ∈H,
tr [ L(e1e∗
1)∣A
L(e1e∗
2)∣A
L(e2e∗
1)∣A
L(e2e∗
2)∣A ] ≤1
then, for any normalized ψ,ξ ∈spanC{e1,e2} and point on the geodesic joining [ψ] and [ξ],
the paradox cannot occur.

CHAPTER 8. A PARRONDO-LIKE PARADOX FOR AN ONE-ROUND GAME
95
Proof
Let ψ = [ e1
e2 ][ a
b ] and ˆξ = [ e1
e2 ][ c
d ] with ∣a∣2 + ∣b∣2 = ∣c∣2 + ∣d∣2 = 1 and
ac + bd = cosδ real and greater than or equal to zero. Let
C = [ L(e1e∗
1)∣A
L(e1e∗
2)∣A
L(e2e∗
1)∣A
L(e2e∗
2)∣A ]
(8.27)
If C ≤1
2I2, then
tr B = tr [ a
b
c
d ]C [ a
c
b
d ] ≤1
(8.28)
so, by the comment preceding the theorem, the paradox cannot occur. Therefore, the only
remaining case is where C, whose eigenvalues are necessarily real, has one eigenvalue, λ1 > 1
2,
and one eigenvalue, λ2 < 1
2, with λ1+λ2 ≤1. There are corresponding normalized eigenvectors
v1 and v2, necessarily orthogonal. Writing [ a
c ] = f1v1 + f2v2 and [ b
d ] = g1v1 + g2v2, the
above conditions on a,b,c,d become the following conditions on f1,f2,g1,g2: ∣f1∣2 + ∣f2∣2 = 1,
∣g1∣2 + ∣g2∣2 = 1, and f1g1 + f2g2 = cosδ is a positive real or zero.
For the paradox to occur, it must be that both ∣f1∣2λ1 + ∣f2∣2λ2 = b11 = PA >
1
2 and
∣g1∣2λ1 + ∣g2∣2λ2 = b22 = P ′
A > 1
2; hence,
∣f1∣>
¿
Á
Á
À
1
2 −λ2
λ1 −λ2
and ∣f2∣<
¿
Á
Á
À λ1 −1
2
λ1 −λ2
⇒∣f1∣>
¿
Á
Á
À
1
2 −λ2
λ1 −1
2
∣f2∣
(8.29)
∣g1∣>
¿
Á
Á
À
1
2 −λ2
λ1 −λ2
and ∣g2∣<
¿
Á
Á
À λ1 −1
2
λ1 −λ2
⇒∣g1∣>
¿
Á
Á
À
1
2 −λ2
λ1 −1
2
∣g2∣
(8.30)
Then, since
∣f1g1∣= ∣f1∣∣g1∣>
1
2 −λ2
λ1 −1
2
∣f2∣∣g2∣> ∣f2∣∣g2∣= ∣f2g2∣
(8.31)
it must be that f1g1 + f2g2 is actually strictly positive and that Rf1g1 > 0. Furthermore,
since the imaginary parts of f1g1 and f2g2 are equal in magnitude, it must be that the real
part of f1g1 is greater than
1
2 −λ2
λ1−1
2 times the magnitude of the real part of f2g2 and, therefore,
is greater than
1
2 −λ2
λ1−1
2 times the real part of f2g2. Hence, rearranging terms,
R(λ1f1g1 + λ2f2g2) > 1
2 (f1g1 + f2g2) = 1
2 cosδ
(8.32)

CHAPTER 8. A PARRONDO-LIKE PARADOX FOR AN ONE-ROUND GAME
96
However, then
P geo
A
=
1
sin2 δ [ sin(δ −θ)
sinθ ]B [ sin(δ −θ)
sinθ
]
(8.33)
=
1
sin2 δ ((∣f1∣2λ1 + ∣f2∣2λ2)sin2(δ −θ) + (∣g1∣2λ1 + ∣g2∣2λ2)sin2 θ
+2R(λ1f1g1 + λ2f2g2)sin(δ −θ)sinθ)
>
1
sin2 δ (1
2 sin2(δ −θ) + 1
2 sin2 θ + cosδ sin(δ −θ)sinθ)
=
1
2sin2 δ (sin(δ −θ)(sin(δ −θ) + cosδ sinθ)
+sinθ (sin(δ −(δ −θ)) + cosδ sin(δ −θ)))
=
1
2sin2 δ (sin(δ −θ)sinδ cosθ + sinθ sinδ cos(δ −θ))
= sin2 δ
2sin2 δ = 1
2
Therefore, if both b11 = PA > 1
2 and b22 = P ′
A > 1
2, then P geo
A
> 1
2 everywhere on the geodesic.
◻

97
Chapter 9
Quantum walks and the Parrondo-like
paradox
9.1
Classical random and classical hidden walks
Deﬁnitions of classical random and classical hidden walks
A classical random walk is a special case of the observable Markov chain earlier discussed,
with graphical model given in ﬁgure (7.1). It models a walker who is in one of a ﬁnite
number of internal states and occupies one of a countable number of positions at one time,
so the space X is either J × Z+ for a walk on the half-line, or J × Z for a walk on the
full line. After each time-step, the walker is at the same or a neighboring location and its
internal state can change as well. The process is random, with the transition probability
functions possibly dependent on the internal state as well as on the location. This constrains
the transition probability functions further than the constraints already imposed by the
Markov conditions, but these further constraints are not indicated in the graphical model.
If the transition probability functions are spatially translation invariant, the walk is termed
homogeneous.
Now we may consider a classical hidden walk.
This is in some ways a special case
of the classical hidden-Markov chain earlier discussed (7.16), while in other ways it is a
generalization. The hidden set H is required to be either J × Z+ for a walk on the half-line,
or J ×Z for a walk on the full line. The base measure for the hidden set is required to be the
counting measure, and L1 (H;counting measure) ≅ℓ1, so all integrals can be taken to just be
sums. The space ℓ1 has a natural basis of sequences that have a single nonzero entry with
value one. There is a dual “basis” of sequences in ℓ∞of the same sequences, which is not a
basis in the norm topology, but is one in the weak* topology. This basis and dual “basis”
can be used to assign matrix elements to any operator in B(ℓ1). Then any operator, A, in
B(ℓ1) is in one-to-one correspondence to a certain sequence of matrices, {An}, which may
be considered the truncations of the inﬁnite matrix corresponding to the operator. By the

CHAPTER 9. QUANTUM WALKS AND THE PARRONDO-LIKE PARADOX
98
triangle inequality, these sequences converge to the operator in the strong-operator topology:
lim
n→∞∥Ax −Anx∥= lim
n→∞∥Ax −PnAPnx∥≤lim
n→∞(∥Ax −PnAx∥+ ∥PnAx −PnAPnx∥)
(9.1)
≤lim
n→∞(∥(Ax) −Pn(Ax)∥+ ∥PnA∥op∥x −Pnx∥) = 0
for any x ∈ℓ1, where {Pn} are the usual, diagonal projectors onto the span of the ﬁrst n
basis elements.
Conversely, given a sequence of matrices, each of which is the truncation of the following,
the condition on the sequence so that it actually corresponds to a bounded operator is that
the induced operator norm of all the matrices is bounded. However, the operator norm
induced by the ℓ1 norm is simply the supremum over all columns of the column sum of
the magnitudes of the entries, so it is readily calculated. With this form for the maps, the
condition that this is a walk (rather than some other sort of hidden-Markov process) is that
matrix entries connecting spatial locations that are not neighboring are all zero.
The generalization from the classical hidden-Markov chain is that the last pince-nez map
in the chain is no longer required to be the same as the preceding ones; in particular, all the
preceding pince-nez can be taken to be simply nodes, so the graphical model is


k
k
k


-
-
-
⋯⋯
-
-
1
2
n
k
n + 1
(9.2)
Note there is nothing graphically that distinguishes this from a more general Markov process–
the constraints that make it a walk are not represented graphically.
Connection to orthogonal polynomials and measures on R
Orthogonal polynomials1 {pj} result from the Gram-Schmidt algorithm applied to {1,x,x2,...}
on the real line with inner-product given with respect to some Borel measure µ, ⟨f,g⟩=
∫R fg dµ. These polynomials all have the maximal number of real roots, which are all sim-
ple, else they would not change signs enough times to be orthogonal. For the same reason,
the roots are all within the convex hull of the support of µ and they interlace as j increases
by one. By orthogonality, the polynomials necessarily obey a three-term recurrence relation,
which may be written in matrix form as
x[ p0
p1
⋯] = [ p0
p1
⋯]
⎡⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎣
b0
c1
a0
b1
c2
a1
...
...
...
...
⎤⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎦
(9.3)
1The following results on orthogonal polynomials are well known and included for comparison to the
results for quantum walks given below. For details, see[119].

CHAPTER 9. QUANTUM WALKS AND THE PARRONDO-LIKE PARADOX
99
If the polynomials are normalized to have value one at x = 1, the tridiagonal, inﬁnite matrix
on the right has column sum one for each of its columns. If µ is such that all the entries
in that matrix are positive, then it is a stochastic matrix and can be used for the map per
time step for a classical random or classical hidden walk on the half-line where the internal
states are trivial.
Conversely, given such a walk, then there is an inﬁnite, stochastic matrix
⎡⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎣
b0
c1
a0
b1
c2
a1
...
...
...
...
⎤⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎦
(9.4)
giving the map per time step. If all the a’s and c’s are strictly positive, then each n × n-
truncation An of the matrix is similar to a Hermitian matrix via
⎡⎢⎢⎢⎢⎢⎢⎢⎢⎢⎣
1
1
d1
...
1
dn−1
⎤⎥⎥⎥⎥⎥⎥⎥⎥⎥⎦
⎡⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎣
b0
c1
a0
b1
c2
a1
...
...
...
...
cn−1
an−2
bn−1
⎤⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎦
⎡⎢⎢⎢⎢⎢⎢⎢⎢⎣
1
d1
...
dn−1
⎤⎥⎥⎥⎥⎥⎥⎥⎥⎦
(9.5)
where d2
j =
c1⋯cj
a0⋯aj−1. Therefore, for each such truncation, the eigenvalues {x(n)
1 ,...,x(n)
n } are
all real. These eigenvalues are all necessarily less than or equal to one in magnitude since
the spectral radius of An is less than or equal to its operator norm induced by the ℓ1-norm,
which is one. By the Courant-Fischer minimax theorem [16] the eigenvalues are all simple
and they interlace as n increases, so they are actually all less than one in magnitude. Deﬁne
the polynomials {pn} by
pn(x) = det(xIn −An)
det(In −An) = (x −x(n)
1 )⋯(x −x(n)
n )
(1 −x(n)
1 )⋯(1 −x(n)
n )
(9.6)
By adding the ﬁrst row to the second, the second to the third, and so on, it is easy to see
that det(In −An) = a0a1⋯an−1. Then, by expanding det(xIn −An) by minors along its last
column and evaluation at the n values x ∈{x(n)
1 ,...,x(n)
n } (which is enough to determine a
degree-n polynomial), the polynomial xpn−1(x) obeys the recurrence relation in (9.3).
Let µ1 be the single atom measure δb0 and, for n > 1, let µn be the atomic measure
∑n
j=1 w(n)
j
δx(n)
j , where
w(n)
j
=
k
∑
l=1
w(k)
l
pn (x(k)
l
)
(x(k)
l
−x(n)
j
)p′ (x(n)
j
)
(9.7)

CHAPTER 9. QUANTUM WALKS AND THE PARRONDO-LIKE PARADOX
100
for any k ∈{⌈n
2⌉,...,n −1} (they all give the same result). Furthermore, the sequence of
measures ⟨µn⟩stabilizes for any ﬁxed polynomial in the sense that for any degree-n polyno-
mial q, ∫R q dµk is the same for all k ≥⌊n
2 + 1⌋. Therefore, the µn are indeed measures (and
not just signed measures) since
w(n)
j
=
n−1
∑
l=1
w(n−1)
l
⎛
⎜
⎝
pn (x(n−1)
l
)
(x(n−1)
l
−x(n)
j
)p′ (x(n)
j
)
⎞
⎟
⎠
2
(9.8)
so all the w’s are positive.
Hence, µn(R) = ∫R 1dµn = 1 is the total-variation norm of µn for each n. Since the µn are
all Radon measures and the interval [−1,1] is compact, by the Riesz-Markov theorem [78] and
Alaoglu’s theorem [85], the sequence ⟨µn⟩has a weak* limit point. Since, by the Weierstrass
theorem [112], polynomials are dense in the supremum norm among continuous functions
on the compact interval [−1,1], by the above stabilizing property of the sequence, the limit
point is unique and the entire sequence converges to it in the weak* topology. Let this limit
be denoted µ. Then {pn} are the orthogonal polynomials corresponding to the measure
µ on R. The measure µ is unique among Radon measures since any other measure with
this property agrees with µ on polynomials, but, as stated above, they are dense in norm
among continuous functions on [−1,1], which separate Radon measures; hence, polynomials
separate these measures as well.
Furthermore, one may ask if, starting with ν such that the tridiagonal, inﬁnite matrix
has all positive entries, then forming the measure µ following the procedure outlined, it is
necessarily the case that ν ∝µ (there may be a scale factor since µ necessarily has total-
variation norm one). This is true since µ and ν agree (up to the scale factor) when integrated
with polynomials on R; however, µ is supported on [−1,1] so its moments (and, hence, those
of ν) are bounded. Therefore, by [22], the moment problem on R has a unique solution in
this case.
Finally, there is the question of whether every Radon measure on [−1,1] corresponds to a
classical random walk. The answer is no, as is seen by the Jacobi polynomials [1], normalized2
to have the value one at x = 1, {
n!
(1+α)nP (α,β)
n
}. These have measure with support on [−1,1],
given there by the measure absolutely continuous with respect to Lebesgue measure and
with Radon-Nikod´ym derivative (1 + x)β(1 −x)α. For the recurrence relation, the entries in
the tridiagonal, inﬁnite matrix for {an} and {cn} are always strictly positive (as they must
be for any measure with its support on (−∞,1]), but the {bn} are given by
bn = (β2 −α2)(2n + α + β + 1)
(2n + α + β)3
(9.9)
which are negative for α > β. (However, for the Jacobi polynomials shifted to live on the
interval [0,1] with Radon-Nikod´ym derivative xα(1 −x)β, {(−1)nn!
(1+β)n P (α,β)
n
(1 −2x)}, there is
an associated walk–see [30]).
2Using Pochhammer’s symbol, (a)0 = 1 and (a)n = a(a + 1)⋯(a + n −1).

CHAPTER 9. QUANTUM WALKS AND THE PARRONDO-LIKE PARADOX
101
9.2
Quantum walks
Deﬁnition of a quantum walk
Similarly to the classical hidden walk, the quantum walk is in some ways a special case of the
quantum Markov chain earlier discussed (7.31), while in other ways it is a generalization. The
Hilbert space H is required to be either L2(J ×Z+;counting measure) for a walk on the half-
line, or L2(J ×Z;counting measure) for a walk on the full line; both are clearly isometrically
isomorphic to ℓ2, so all integrals can be taken to just be sums. The space ℓ2 has a natural
basis of sequences that each have a single nonzero entry with value one. This basis and the
inner-product can be used to assign matrix elements to any operator B(ℓ2). Any operator A
in B(ℓ2) is in one-to-one correspondence to a certain sequence of matrices, {An}, which may
be considered the truncations of the inﬁnite matrix corresponding to the operator. By the
triangle inequality, these sequences converge to the operator in the strong-operator topology:
lim
n→∞∥Aψ −Anψ∥= lim
n→∞∥Aψ −PnAPnψ∥≤lim
n→∞(∥Aψ −PnAψ∥+ ∥PnAψ −PnAPnψ∥) (9.10)
≤lim
n→∞(∥(Aψ) −Pn(Aψ)∥+ ∥PnA∥op∥ψ −Pnψ∥) = 0
for any ψ ∈ℓ2, where {Pn} are the orthogonal projectors onto the span of the ﬁrst n basis
elements.
Conversely, given a sequence of matrices, each of which is the truncation of the following,
the condition on the sequence so that it actually corresponds to a bounded operator is that
the induced operator norm of all the matrices is bounded. The operator norm induced by the
ℓ2 norm is the largest singular value, which, unfortunately, is not generally readily calculated.
However, for this sequence to correspond to a partial isometry, it is only necessary to show
that for all ﬁxed, ﬁnite collections of columns, those columns of the {An} are mutually
orthonormal in the limit as n →∞.
It is readily shown that this condition implies the
induced operator norm of each An is less than or equal to one. With this form for the maps,
the condition that this is a walk (rather than some other sort of quantum Markov process)
is that matrix entries connecting spatial locations that are not neighboring are all zero.
The generalization from the quantum Markov chain is that the last pince-nez in the
chain is no longer required to be the same as the preceding. In particular, all the preceding
pince-nez can be taken to be simply nodes, so the graphical model is


k
k
k


-
-
-
⋯⋯
-
-
1
2
n
k
n + 1
(9.11)
Note, as for the classical random walks, there is nothing graphically that distinguishes this
from a more general quantum Markov process–the constraints that make it a walk are not
represented in the graphical model.

CHAPTER 9. QUANTUM WALKS AND THE PARRONDO-LIKE PARADOX
102
Orthogonal trigonometric polynomials and measures on S1
Trigonometric orthogonal polynomials3 {qj} result from the Gram-Schmidt algorithm applied
to {1,z,z−1,z2,z−2,...} on the unit circle S1 within C with sesquilinear inner-product given
with respect to some Borel measure µ, ⟨f,g⟩= ∫S1 fg dµ. To form these, it is useful to start
with the monic orthogonal polynomials on the unit circle, the Szeg¨o polynomials, {sn}. For
any polynomial, deﬁne the reciprocal polynomial to be the polynomial with its coeﬃcients
conjugated and ﬂipped in order, so, if p is a nth order polynomial,
preciprocal(z) = znp(1
z) = znp(1
z)
(9.12)
where the overline only over the function means to conjugate its coeﬃcients.
On S1,
preciprocal(z) = znp(z). In particular, if z is a root of p, then 1
z is a root of preciprocal.
Deﬁne the Verblunsky coeﬃcients by the values of the Szeg¨o polynomials at zero, αn =
−sn+1(0). Then, by orthogonality, we have the following Szeg¨o recurrence identities for all
z ∈C:
z sn(z) = sn+1(z) + αn sreciprocal
n
(z)
(9.13)
⇔sreciprocal
n+1
(z) = sreciprocal
n
(z) −αnz sn(z)
and
sn(z) = −αn−1 sreciprocal
n
(z) + (1 −∣αn−1∣2)z sn−1(z)
(9.14)
⇔sreciprocal
n
(z) = −αn−1 sn(z) + (1 −∣αn−1∣2)sreciprocal
n−1
(z)
From the ﬁrst identity, it follows that
∥sn∥2 = ∫z∈S1 ∣sn(z)∣2 dµ(z) = (1 −∣αn−1∣2)⋯(1 −∣α0∣2)µ(S1)
(9.15)
By Verblunsky’s theorem, the measure µ, the moments of the measure {mj}, and the
Verblunsky coeﬃcients {αj} all determine each other. The only condition on the Verblunsky
coeﬃcients that they do indeed correspond to some measure is that ∣αj∣≤1 for all j.
The monic orthogonal trigonometric polynomials are then given by q0 = 1, and, for
j ∈{1,2,...},
qj(z) = z−(j−1)s2j−1(z),q−j(z) = z−jsreciprocal
2j
(z)
(9.16)
3Only a few basic results that are most applicable to quantum walks of this rich topic are presented here.
See [117] for details and elaboration.

CHAPTER 9. QUANTUM WALKS AND THE PARRONDO-LIKE PARADOX
103
The orthogonal trigonometric polynomials necessary satisfy a pentadiagonal recurrence re-
lation, with ﬁrst z q0(z) = q1(z) + α0q1(z), then, using (9.13) and (9.14) repeatedly,
zqj(z) = z−jz2s2j−1(z) = z−jz (s2j(z) + α2j−1sreciprocal
2j−1
(z))
(9.17)
= z−j (s2j+1(z) + α2jsreciprocal
2j
(z) + α2j−1z sreciprocal
2j−1
(z))
= z−j (s2j+1(z) + α2jsreciprocal
2j
(z)
+zα2j−1 (−α2j−2 s2j−1(z) + (1 −∣α2j−2∣2)sreciprocal
2j−2
(z)))
= qj+1(z) + α2jq−j(z) −α2j−1α2j−2qj(z) + α2j−1 (1 −∣α2j−2∣2)q−(j−1)(z)
and
zq−j(z) = z−jz sreciprocal
2j
(z) = z−jz (−α2j−1 s2j + (1 −∣α2j−1∣2)sreciprocal
2j−1
)
(9.18)
= z−j (−α2j−1 (s2j+1 + α2jsreciprocal
2j
)
+z (1 −∣α2j−1∣2)(−α2j−2 s2j−1 + (1 −∣α2j−2∣2)sreciprocal
2j−2
))
= −α2j−1qj+1(z) −α2jα2j−1q−j(z) −α2j−2 (1 −∣α2j−1∣2)qj
+ (1 −∣α2j−1∣2)(1 −∣α2j−2∣2)q−(j−1)(z)
Following Cantero, Moral, and Vel´azquez [8] [9], writing this in matrix form as
[ zq0(z)
zq1(z)
zq−1(z)
⋯] = [ q0(z)
q1(z)
q−1(z)
⋯]Z
(9.19)
gives the CMV-matrix Z for the monic orthogonal trigonometric polynomials,
Z =
⎡⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎣
α0
α1 (1 −∣α0∣2)
(1 −∣α1∣2)(1 −∣α0∣2)
0
⋯
1
−α1α0
−(1 −∣α1∣2)α0
0
⋯
0
α2
−α1α2
α3 (1 −∣α2∣2)
⋯
0
1
−α1
−α3α2
⋯
0
0
0
α4
⋯
...
...
...
...
...
⎤⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎦
(9.20)
The matrix Z can be written as the product of two block-diagonal matrices (the columns
within each 2 × 2-block correspond to the identities in (9.13) and (9.14))
⎡⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎣
α0
1 −∣α0∣2
1
−α0
α2
1 −∣α2∣2
1
−α2
...
⎤⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎦
⎡⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎣
1
α1
1 −∣α1∣2
1
−α1
α3
⋯
...
...
⎤⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎦
(9.21)

CHAPTER 9. QUANTUM WALKS AND THE PARRONDO-LIKE PARADOX
104
Using (9.15), the CMV-matrix U for the orthonormal trigonometric polynomials is then
given by
⎡⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎣
α0
ρ0
ρ0
−α0
α2
ρ2
ρ2
−α2
...
⎤⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎦
⎡⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎣
1
α1
ρ1
ρ1
−α1
α3
⋯
...
...
⎤⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎦
(9.22)
for ρj =
√
1 −∣αj∣2.
Connection to quantum walks–the CMV-matrix
Consider the quantum walk on the half-line Z+∪{0} with internal state set J = {↑,↓}, so the
Hilbert space H is ℓ2(Z×{↑,↓}). Then, taking the indices as 0 ↑,0 ↓,1 ↑,1 ↓,2 ↑,..., following
a proposal of Gr¨unbaum in [10], the CMV-matrix U above can be used as the map for a
quantum walk. With an abuse of notation, for a quantum walk on the line Z with the same
internal state set and with indices ...,−2 ↓,−1 ↑,−1 ↓,0 ↑,0 ↓,1 ↑,1 ↓,2 ↑,..., the matrix
(underlines indicate indices corresponding spatial location zero) given by the product:
⎡⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎣
...
α−2
ρ−2
ρ−2
−α−2
α0
ρ0
ρ0
−α0
α2
ρ2
ρ2
−α2
...
⎤⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎦
(9.23)
⎡⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎣
...
...
⋯
α−3
α−1
ρ−1
ρ−1
−α−1
0
0
α1
ρ1
ρ1
−α1
α3
⋯
...
...
⎤⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎦
will also be called a CMV-matrix and the {αj} called the Verblunsky coeﬃcients, although
there is no longer a connection to the orthogonal trigonometric polynomials.

CHAPTER 9. QUANTUM WALKS AND THE PARRONDO-LIKE PARADOX
105
Coined quantum walks
Once again, consider the quantum walk on the half-line Z+ ∪{0} with internal state set
J = {↑,↓}, so the Hilbert space H is ℓ2(Z × {↑,↓}). Then, taking the indices as 0 ↑,0 ↓,1 ↑
,1 ↓,2 ↑,..., if it is either of the form
⎡⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎣
a0
b0
c0
d0
a2
b2
c2
d2
...
⎤⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎦
⎡⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎣
1
0
1
1
0
0
⋯
...
...
⎤⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎦
(9.24)
or
⎡⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎣
1
0
1
1
0
0
⋯
...
...
⎤⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎦
⎡⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎣
a0
b0
c0
d0
a2
b2
c2
d2
...
⎤⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎦
(9.25)
then it is termed a coined walk with coins {[ a2j
b2j
c2j
d2j ]}, which are unitary matrices. The
ﬁrst form is a CMV-matrix if b2j = c2j is a positive real or zero and if a2j = −d2j; then all the
Verblunsky coeﬃcients with odd index are zero and the Verblunsky coeﬃcients with even
index are given by α2j = −d2j. The second form is the adjoint of a CMV-matrix if the same
conditions hold. The diﬀerence between the two forms for a quantum walk is clearly just a
matter of transforming the initial state by the unitary matrix
⎡⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎢⎣
1
0
1
1
0
0
⋯
...
...
⎤⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎥⎦
(9.26)
Therefore, which form is adopted is largely a matter of convention, except for possible
restrictions on the initial state.
If all the coins are the same, the quantum walk is termed a coined walk with constant
coin. Since the overall phase of the wavefunction is irrelevant, the phase of the determinant
of the coin is arbitrary. Choosing it to be −1, the coin is necessarily of the form [ α
β
β
−α ]
for some α,β ∈C with ∣α∣2 + ∣β∣2 = 1. Then the condition for the unitary matrix for the
walk to be a CMV-matrix (or the adjoint of one) is that β is positive real or zero. Similar
terminology may be employed for walks on the full line.

CHAPTER 9. QUANTUM WALKS AND THE PARRONDO-LIKE PARADOX
106
9.3
The Parrondo-like paradox for quantum walks
Set-up
Consider the quantum walk on the line Z with internal state set J = {↑,↓}, so the Hilbert
space H is ℓ2(Z × {↑,↓}). Let P+ be the orthogonal projector onto spatial locations with
positive index, P−be the orthogonal projector onto spatial locations with negative index,
and P0 be the orthogonal projector onto spatial location zero, so P−+P0 +P+ is the identity.
Let U be the unitary operator that gives time evolution for one time step, ρ →UρU ∗.
Then, after n time steps, an observation is made with an observation set R with σ-algebra
{∅,A, ˜A,R} and base measure τ given by τ(A) = τ( ˜A) = 1. The pince-nez map L is given
by
Lρ = 1Atr ρP+ + 1 ˜
Atr ρ(P0 + P−)
(9.27)
Then, by considering two diﬀerent initial states, ψψ∗and ξξ∗, and the geodesic joining them,
we can analyze the occurrence and extent of the Parrondo-like paradox.
Showing the paradox is impossible for certain classes of quantum
walks
Let η0↑be the wavefunction with one for ↑at location zero and all other amplitudes zero
and η0↓be the wavefunction with one for ↓at location zero and all other amplitudes zero.
Consider the six following cases for the Verblunsky coeﬃcients determining the CMV-matrix
U : (i) αj = ωjα−j for some ω ∈S1 ⊂C and all j ∈Z; (ii) α2j = −ω2jα−2j,α2j+1 = ω2j+1α−2j−1
for some ω ∈S1 ⊂C and all j ∈Z; (iii) αj = α−j for all j ∈Z; (iv) αj = −α−j for all j ∈Z; (v)
α2j = α−2j,α2j+1 = −α−2j−1 for all j ∈Z; and (vi) α2j = −α−2j,α2j+1 = α−2j−1 for all j ∈Z. With
the preceding set-up, we have the following result:
Theorem 9.3.1
If the Verblunsky coeﬃcients are in any of the preceding six cases, then
for any initial wavefunctions ψ,ξ in the subspace for spatial location zero, spanC{η0↑,η0↓},
the Parrondo-like paradox cannot occur.
Proof
Let ψ(n) = U nη0↑and ξ(n) = U nη0↓. Then ξ(n) is related to ψ(n) by the following, for
each n ∈{1,...} and j ∈Z, depending on the case:
i)
ξ(n)
j,↑= −ωj−nψ(n)
−j,↓
ξ(n)
j,↓= ω−j−nψ(n)
−j,↑
ii)
ξ(n)
j,↑= (−ω)j−nψ(n)
−j,↓
ξ(n)
j,↓= (−ω)−j−nψ(n)
−j,↑
iii)
ξ(n)
j,↑= −ψ(n)
−j,↓
ξ(n)
j,↓= ψ(n)
−j,↑
iv)
ξ(n)
j,↑= ψ(n)
−j,↓
ξ(n)
j,↓= ψ(n)
−j,↑
v)
ξ(n)
j,↑= (−1)j+n+1ψ(n)
−j,↓
ξ(n)
j,↓= (−1)j+nψ(n)
−j,↑
vi)
ξ(n)
j,↑= (−1)j+nψ(n)
−j,↓
ξ(n)
j,↓= (−1)j+nψ(n)
−j,↑
(9.28)

CHAPTER 9. QUANTUM WALKS AND THE PARRONDO-LIKE PARADOX
107
Therefore, in any of the six cases,
tr [ L(U nη0↑η∗
0↑U ∗n)∣A
L(U nη0↑η∗
0↓U ∗n)∣A
L(U nη0↓η∗
0↑U ∗n)∣A
L(U nη0↓η∗
0↓U ∗n)∣A ] = tr [ tr P+ψ(n)ψ(n)∗
tr P+ψ(n)ξ(n)∗
tr P+ξ(n)ψ(n)∗
tr P+ξ(n)ξ(n)∗]
(9.29)
= ⟨(P+ + P−)ψ(n),ψ(n)⟩≤1
Hence, by theorem 8.4.1, for any initial wavefunctions ψ,ξ in the subspace for spatial loca-
tion zero and any point on the geodesic joining [ψ] and [ξ], the paradox cannot occur. ◻
In particular, note this rules out the paradox for the case of constant coin walks of the
ﬁrst form with initial wavefunctions ψ,ξ in the subspace for spatial location zero where the
coin is of the form [
α
√
1 −∣α∣2
√
1 −∣α∣2
−α
] for some α ∈C with ∣α∣2 ≤1. Using a limit
theorem by Konno [42] [41], we have the following limiting result for more general constant
coin walks (not necessarily in the CMV-matrix form) adopting the second form of coined
quantum walks:
Theorem 9.3.2
If a quantum walk has constant coin presented in the second form, then
for any initial wavefunctions ψ,ξ in the subspace for spatial location zero, spanC{η0↑,η0↓},
the Parrondo-like paradox cannot occur in the limit as n →∞.
Proof
Adapting the terminology of Konno to our notation, let the coin be given by
[ b
a
d
c ]. The wavefunctions η0↑and η0↓are given by β = 1,α = 0 and β = 0,α = 1 re-
spectively. Then, employing Konno’s limit theorem, the limit of the sum of probabilities,
lim
n→∞(⟨P+U nτ0↑,U nτ0↑⟩+ ⟨P+U nτ0↓,U nτ0↓⟩)
(9.30)
is given by
∫
∣a∣
0
2
√
1 −∣a∣2
π(1 −x2)
√
∣a∣2 −x2dx = 1
(9.31)
Hence, by theorem 8.4.1, for any initial wavefunctions ψ,ξ in the subspace for spatial location
zero and any point on the geodesic joining [ψ] and [ξ], the paradox cannot occur in the limit
as n →∞. ◻
Examples of quantum walks displaying the paradox to the
maximal extent
Example 9.3.3
With the above set-up, take initial wavefunctions ψ =
1
√
2 (η0↑+ η0↓) and
ξ =
1
√
2 (η0↑−η0↓).
Then, halfway on the minimizing geodesic between them, the initial

CHAPTER 9. QUANTUM WALKS AND THE PARRONDO-LIKE PARADOX
108
wavefunction is η0↑. Take all the Verblunsky coeﬃcients to be zero except for α−1, which has
value
1
√
3. Let U be the corresponding CMV-matrix.
Let ψ(n) = U nψ, ξ(n) = U nξ, and χ(n) = U nη0↑for n ≥1. Then ψ(n) has all amplitudes
zero except for
1
√
2 for ↓at location n, −1
√
6 for ↓at location n −1, and
1
√
3 for ↑at location
−n; ξ(n) has all amplitudes zero except for −1
√
2 for ↓at location n, −1
√
6 for ↓at location
n −1, and
1
√
3 for ↑at location −n; and χ(n) has all amplitudes zero except for
√
2
3 for ↑at
location −n and −1
√
3 for ↓at location n −1. Consequently, PA,n = P ′
A,n = 2
3 for all n > 1, yet
P geo
A,n = 1
3 for the initial wavefuntion halfway on the minimizing geodesic. By theorem 8.3.2,
this example is on the boundary of allowed values of (PA,n,P ′
A,n,P geo
A,n) for the paradox.
Example 9.3.4
Again with the above set-up, let U be the matrix for the constant coin walk
in the second form with coin
1
√
2 [ 1
1
−1
1 ]. Take ε > 0 small. Take σ1 > 0 suﬃciently small
relative to ε such that the normal distribution with mean ε and variance σ2
1 has neglectfully
small measure for (−∞,0). Take a ∈(−π
2,0) and σ2 > 0 such that: (i) the normal distribution
with mean a and variance σ2
2 has neglectfully small measure outside (−π
2,0) and (ii) we have
∫k∈(−π
2 ,0)
−sink
√
1 + cos2 k
dNormal(a,σ2)(k) = 1
3
(9.32)
Let ϕ,ζ ∶Z →C be given by
ϕj =
4
√
2σ2
1
π e−σ2
1j2+ı( π
2 −ε)j =
1
√
2π ∫
∞
−∞
exp(−
(k−( π
2 −ε))2
4σ2
1
+ ıjk)
4√
2πσ2
1
dk
(9.33)
≈
1
√
2π ∫
π
−π
exp(−
(k−( π
2 −ε))2
4σ2
1
+ ıjk)
4√
2πσ2
1
dk
ζj =
4
√
2σ2
2
π e−σ2
2j2+ıaj =
1
√
2π ∫
∞
−∞
exp(−(k−a)2
4σ2
2
+ ıjk)
4√
2πσ2
2
dk
(9.34)
≈
1
√
2π ∫
π
−π
exp(−(k−a)2
4σ2
2
+ ıjk)
4√
2πσ2
2
dk

CHAPTER 9. QUANTUM WALKS AND THE PARRONDO-LIKE PARADOX
109
Then, by the inversion of Fourier series,
∑
j∈Z
∣ϕj∣2 = ∫
∞
−∞
exp(−
(k−( π
2 −ε))2
2σ2
1
)
√
2πσ2
1
dk = 1
(9.35)
∑
j∈Z
∣ζj∣2 = ∫
∞
−∞
exp(−(k−a)2
2σ2
2 )
√
2πσ2
2
dk = 1
∑
j∈Z
ϕjζj = ∫
∞
−∞
exp(−
(k−( π
2 −ε))2
2σ2
1
−(k−a)2
4σ2
2 )
4√
2πσ2
1
4√
2πσ2
2
dk ≈0
Hence, if the initial wavefunctions are taken to be ψ = 1
2(ζ+ϕ)⊗[ ı
1 ] and ξ = 1
2(ζ−ϕ)⊗[ ı
1 ],
they will be properly normalized and approximately orthogonal. Midway on the geodesic
joining them, we have χ =
1
√
2ζ ⊗[ ı
1 ].
Now suppose for the observations we always lump the internal states for any spatial sites,
so the σ-algebra for the observations is that generated by only the spatial locations. Let
{QB} be the complete set of mutually commuting, orthogonal projectors for this σ-algebra.
Deﬁne κ ∶R →[−π,π] by
κ(x) =
⎧⎪⎪⎪⎪⎪⎨⎪⎪⎪⎪⎪⎩
arccos
x
√
1−x2
if x ∈[−1
√
2,
1
√
2]
0
if x ∈[ 1
√
2,∞)
π
if x ∈(−∞,−1
√
2]
(9.36)
Then, for each n, let the complete set of commuting projectors {R(n)
C } for the Borel σ-
algebra on [0,π] be given by R(n)
C
= Q(n⋅κ−1(C))∩Z. By Machida’s limit theorem [48] [49], the
weak*-limit of the measures µ(n) = ⟨R(n)U nψ,U nψ⟩exists and is given by
µ(∞) ≈1
2Normal(π
2 −ε,σ2
2) + 1
4 (1 −
sink
√
1 + cos2 k
)Normal(−a,σ2)
(9.37)
+ 1
4 (1 +
sink
√
1 + cos2 k
)Normal(π + a,σ2)
Similarly, the weak*-limit of the measures ν(n) = ⟨Q(n)U nξ,U nξ⟩exists and is given by the
same expression. For both of these, there is approximately 1
2 + 1
4 (1 −1
3) = 2
3 probability to
have k ∈[0, π
2), which corresponds to spatial locations with positive index j. The weak*-limit
of the measures τ (n) = ⟨Q(n)U nχ,U nχ⟩also exists and is given by
τ (∞) ≈1
2 (1 −
sink
√
1 + cos2 k
)Normal(−a,σ2) + 1
2 (1 +
sink
√
1 + cos2 k
)Normal(π + a,σ2)
(9.38)

CHAPTER 9. QUANTUM WALKS AND THE PARRONDO-LIKE PARADOX
110
However, now there is only approximately 1
2 (1 −1
3) = 1
3 probability to have k ∈[0, π
2). These
values of two-thirds for PA, two-thirds for P ′
A, and one-third for P geo
A
can be arbitrarily
closely approached by taking ε, σ1, and σ2 suﬃciently small. By theorem 8.3.2, this example
can approach arbitrarily closely to the boundary of allowed values of (PA,P ′
A,P geo
A ) for the
paradox.
Remark
The results of the preceding example also hold for the commonly employed
Hadamard coin
1
√
2 [ 1
1
1
−1 ]. Then the matrix U is the adjoint of a CMV-matrix with
all Verblunsky coeﬃcients with even index equal to
1
√
2. For the Hadamard coin, we take
initial wavefunctions to be ψ = 1
2(ζ + ϕ) ⊗[ ı
−1 ] and ξ = 1
2(ζ −ϕ) ⊗[ ı
−1 ], so we have
χ =
1
√
2ζ ⊗[ ı
−1 ], where
ϕj =
4
√
2σ2
1
π e−σ2
1j2+ıεj
(9.39)
ζj =
4
√
2σ2
2
π e−σ2
2j2−ı( π
2 +a)j
(9.40)
for a, ε, σ1, and σ2 as in the given example. The coin utilized in the example was chosen to
agree with that used by Machida [48] [49].

111
Bibliography
[1]
M. Abramowitz and I.A. Stegun, eds. Handbook of Mathematical Functions. National
Bureau of Standards, Applied Mathematics Series 55. Washington: U.S. Government
Printing Oﬃce, 1964, pp. 773–774.
[2]
Y. Aharonov, S. Popescu, and J. Tollaksen. “A time-symmetric formulation of quan-
tum mechanics”. In: Physics Today (2010).
[3]
S.L. Altmann. Is Nature Supernatural? A Philosophical Exploration of Nature and
Science. New York: Prometheus Books, 2002.
[4]
J. Baggott. Farewell to Reality: How Modern Physics has Betrayed the Search for
Scientiﬁc Truth. New York: Pegasus Books, 2013.
[5]
E. Beckenstein and L. Narici. Topological Vector Spaces. Monographs and Textbooks
in Pure and Applied Mathematics 95. New York: Marcel Dekker, Inc., 1985, pp. 87–
88.
[6]
J.S. Bell. “On the Einstein-Podolsky-Rosen Paradox”. In: Physics 1 (1964).
[7]
B.H. Bennet et al. “Teleporting an unknown quantum state via dual classical and
Einstein-Podolsky-Rosen channels”. In: Physical Review Letters 70.13 (1993).
[8]
M.J. Cantero, L. Moral, and L. Vel´azquez. “Five-dimensional matrices and zeros
of orthogonal polynomials on the unit circle”. In: Linear Algebra Applications 362
(2003), pp. 29–56.
[9]
M.J. Cantero, L. Moral, and L. Vel´azquez. “Minimal representations of unitary oper-
ators and orthogonal polynomials on the unit circle”. In: Linear Algebra Applications
408 (2005), pp. 40–65.
[10]
M.J. Cantero et al. “Matrix valued Szeg¨o polynomials and quantum random walks”.
In: Communications on Pure and Applied Mathematics 63 (2010), pp. 464–507.
[11]
N. Cartwright. A Dappled World: A Sudy of the Boundaries of Science. Cambridge:
Cambridge University Press, 1999.
[12]
N. Cartwright. How the Laws of Physics Lie. New York: Oxford University Press,
1983.
[13]
A. Cho. “Furtive approach rolls back the limits of quantum uncertainty”. In: Science
(2011), pp. 690–693.

BIBLIOGRAPHY
112
[14]
B. Cirel’son. “Quantum Generalizations of Bell’s Inequality”. In: Letters un Mathe-
matical Physics 4 (1980).
[15]
J.F. Clauser et al. “Proposed experiment to test local hidden-variable theories”. In:
Physical Review Letters 23 (1969).
[16]
J.W. Demmel. Applied Numerical Linear Algebra. Society for Industrial and Applied
Mathematics 199-200. Philadelphia: American Mathematical Society, 1997.
[17]
J. Diestel, J.H. Fourie, and J. Swart. The Metric Theory of Tensor Products: Grothendieck’s
Resume Revisited. Providence: American Mathematical Society, 2008, p. 7.
[18]
J. Diestel and J.J. Uhl. Vector Measures. Mathematical surveys 15. Providence: Amer-
ican Mathematical Society, 1977, pp. 217–219.
[19]
P.A.M. Dirac. The Principles of Quantum Mechanics. Oxford: Claredon Press, 1930,
p. 35.
[20]
P.A.M. Dirac. The Principles of Quantum Mechanics. Oxford: Claredon Press, 1930,
p. 36.
[21]
H.R. Dowson. Spectral Theory of Linear Operators. London Mathematics Society
Monograms 12. London: Academic Press, Inc., 1978, pp. 50–52.
[22]
R. Durrett. Probability Theory and Examples. 3rd ed. Belmont: Brooks/Cole, 2005,
p. 108.
[23]
E.G. Eﬀros and Z.J. Ruan. Operator Spaces. London Mathematical Society Monographs–
New Series 23. Oxford: Clarendon Press, 2000, p. 25.
[24]
F. Engels. Dialectics of Nature. Written between 1872 and 1882. Translated and edited
by C. Dutt. New York: International Publishers, 1940, p. 243.
[25]
W. Feller. An Introduction to Probability Theory and its Applications. New York: John
Wiley & Sons, Inc., 1950, pp. 430–432.
[26]
F.Hausdorﬀ. Set Theory. 2nd ed. New York: Chelsea Publishing Company, 1962,
pp. 96–108.
[27]
F.Hausdorﬀ. Set Theory. 2nd ed. New York: Chelsea Publishing Company, 1962, p. 72.
[28]
A.P. Flitney, J. Ng, and D. Abbott. “Quantum Parrondo’s Games”. In: Physica A
314 (2002), pp. 35–42.
[29]
A.M. Gleason. “Measures on the closed subspaces of a Hilbert space”. In: Journal of
Mathematics and Mechanics 6.6 (1957), pp. 885–893.
[30]
F.A. Gr¨unbaum. “An urn model associated with Jacobi polynomials”. In: Communi-
cations in Applied Mathematics and Computational Science 5.1 (2010), pp. 55–63.
[31]
F.A. Gr¨unbaum and M. Pejic. “Maximal Parrondo’s Paradox for Classical and Quan-
tum Markov Chains”. In: Letters in Mathematical Physics (2015). submitted.
[32]
M.B. Hesse. The Structure of Scientiﬁc Inference. London: Macmillan, 1974.

BIBLIOGRAPHY
113
[33]
J. Hopkins. Nicholas of Cusa On Learned Ignorance: A Translation and Appraisal of
De Docta Ignorantia. Written in 1440. Minneapolis: The Arthur J. Banning Press,
1981, p. 51.
[34]
W. James. Pragmatism: A new name for some old ways of thinking. New York: Long-
mans, Green & Co., 1907. Chap. What pragmatism means.
[35]
W. James. Some Problems of Philosophy. New York: Longmans, Green & Co., 1911.
Chap. Precept and concept–the import of concepts.
[36]
J. Jeans. Physics and Philosophy. New York: The Macmillan Company, 1943.
[37]
F.V. Jensen. Bayesian Networks and Decision Graphs. Statistics for Engineering and
Information Science. New York: Springer-Verlang, 2001, pp. 35–44.
[38]
F.V. Jensen. Bayesian Networks and Decision Graphs. Statistics for Engineering and
Information Science. New York: Springer-Verlang, 2001, pp. 37,65.
[39]
S. Kochen and E.P. Specker. “The Problem of Hidden Variables in Quantum Mechan-
ics”. In: Journal of Mathematics and Mechanics 17.1 (1967), pp. 75–81.
[40]
S. Kochen and E.P. Specker. “The Problem of Hidden Variables in Quantum Mechan-
ics”. In: Journal of Mathematics and Mechanics 17.1 (1967).
[41]
N. Konno. “A new type of limit theorem for the one-dimensional quantum random
walk”. In: Journal of the Mathematical Society of Japan 57 (2005), pp. 1179–1195.
[42]
N. Konno. “Limit theorems and absorption problems for quantum random walks in
one dimension”. In: Quantum Information and Computation 2 (2002). Special issue,
pp. 578–595.
[43]
K. Kuratowski. Topology. Vol. 1.
[44]
K. Kuratowski. Topology. Vol. 1.
[45]
G. Lackoﬀand M. Johnson. Philosphy in the Flesh: The embodied mind and its chal-
lenge to Western Thought. New York: Basic Books, 1999.
[46]
R.E. Lee. The Background and Foundation of Modern Science: An Integration of the
Natural Sciences for the Orientation of College Freshmen. Baltimore: The Williams
& Wilkens Company, 1935.
[47]
A.D. Lorenzo. “Reassessment of Leggett Inequality”. In: Foundations of Physics 43
(2011), pp. 685–698.
[48]
T. Machida. “A quantum walk with a delocalized initial state: contribution from a
coin-ﬂip operator”. In: International Journal of Quantum Information ().
[49]
T. Machida. “Realization of the probability laws in the quantum central limit the-
orems by a quantum walk”. In: Quantum Information and Computation 13 (2013),
pp. 430–438.
[50]
J.J. Martin. Bayesian Decision Problem and Markov Chains. New York: John Wiley
& Sons, Inc., 1967, p. 62.

BIBLIOGRAPHY
114
[51]
N.D. Mermin. Quantum Computer Science. Cambridge: Cambridge University Press,
2007, pp. 21–23.
[52]
D.A. Meyer. “Noisy quantum Parrondo game”.
[53]
J.R. Munkres. Topology. 2nd ed. Upper Saddle River: Prentice Hall, 2000, p. 167.
[54]
J.R. Munkres. Topology. 2nd ed. Upper Saddle River: Prentice Hall, 2000, pp. 182–
185.
[55]
J.R. Munkres. Topology. 2nd ed. Upper Saddle River: Prentice Hall, 2000, pp. 62–74.
[56]
J.R. Munkres. Topology. 2nd ed. Upper Saddle River: Prentice Hall, 2000, pp. 252–
257.
[57]
J.R. Munkres. Topology. 2nd ed. Upper Saddle River: Prentice Hall, 2000, pp. 169–
170.
[58]
J.R. Munkres. Topology. 2nd ed. Upper Saddle River: Prentice Hall, 2000, p. 225.
[59]
J.R. Munkres. Topology. 2nd ed. Upper Saddle River: Prentice Hall, 2000, p. 176.
[60]
F.W. Nietzsche. Der Wille zur Macht: Versuch einer Umwertung aller Werte. Com-
pilation of notes written in 1883-1888. Leipzig: Naumann, 1906.
[61]
J.R. Norris. Markov Chains. Cambridge Series in Statistical and Probabilistic Math-
ematics. Cambridge: Cambridge University Press, 1997, pp. 40–46.
[62]
N.R. Norris. Markov Chains. Cambridge Series in Statistical and Probabilistic Math-
ematics. Cambridge: Cambridge University Press, 1997, pp. 33–39.
[63]
J.C. Oxtoby. “Invariant measures in groups which are not locally compact”. In: Trans-
actions of the American Mathematical Society 60.2 (1946), pp. 215–237.
[64]
J. Parrondo and P. Espagnol. “Criticism of Feynman’ analysis of the ratchet as an
engine”. In: American Journal of Physics 64 (1996).
[65]
G.K. Pedersen. C*-algebras and their Automorphism Groups. London: Academic Press,
Inc., 1979, p. 52.
[66]
A.L. Peressini. Ordered Topological Vector Spaces. Harper’s Series in Modern Mathe-
matics. New York: Harper & Row, 1967, p. 7.
[67]
H. Poincar´e. La Science et l’Hypoth`ese. Paris: Ernest Flammarion, 1902.
[68]
K.R. Popper. Objective Knowledge: An Evolutionary Approach. New York: Oxford
University Press, 1972.
[69]
M.M. Rao. Measure Theory and Integration. New York: John Wiley & Sons, Inc.,
1987, pp. 339–344.
[70]
M.M. Rao. Measure Theory and Integration. New York: John Wiley & Sons, Inc.,
1987, pp. 413–439.
[71]
N. Rescher. The Limits of Science. Berkeley: University of California Press, 1984.

BIBLIOGRAPHY
115
[72]
H.L. Royden. Real Analysis. 3rd ed. Upper Saddle River: Prentice Hall, 1988, pp. 276–
278.
[73]
H.L. Royden. Real Analysis. 3rd ed. Upper Saddle River: Prentice Hall, 1988, pp. 256–
257.
[74]
H.L. Royden. Real Analysis. 3rd ed. Upper Saddle River: Prentice Hall, 1988, pp. 307–
309.
[75]
H.L. Royden. Real Analysis. 3rd ed. Upper Saddle River: Prentice Hall, 1988, p. 267.
[76]
H.L. Royden. Real Analysis. 3rd ed. Upper Saddle River: Prentice Hall, 1988, p. 278.
[77]
H.L. Royden. Real Analysis. 3rd ed. Upper Saddle River: Prentice Hall, 1988, pp. 268–
270.
[78]
H.L. Royden. Real Analysis. 3rd ed. Upper Saddle River: Prentice Hall, 1988, p. 357.
[79]
H.L. Royden. Real Analysis. 3rd ed. Upper Saddle River: Prentice Hall, 1988, pp. 331–
335.
[80]
H.L. Royden. Real Analysis. 3rd ed. Upper Saddle River: Prentice Hall, 1988, pp. 197–
198.
[81]
H.L. Royden. Real Analysis. 3rd ed. Upper Saddle River: Prentice Hall, 1988, p. 201.
[82]
H.L. Royden. Real Analysis. 3rd ed. Upper Saddle River: Prentice Hall, 1988, p. 274.
[83]
H.L. Royden. Real Analysis. 3rd ed. Upper Saddle River: Prentice Hall, 1988, p. 284.
[84]
H.L. Royden. Real Analysis. 3rd ed. Upper Saddle River: Prentice Hall, 1988, pp. 248–
249.
[85]
H.L. Royden. Real Analysis. 3rd ed. Upper Saddle River: Prentice Hall, 1988, pp. 237–
238.
[86]
H.L. Royden. Real Analysis. 3rd ed. Upper Saddle River: Prentice Hall, 1988, p. 240.
[87]
H.L. Royden. Real Analysis. 3rd ed. Upper Saddle River: Prentice Hall, 1988, p. 223.
[88]
H.L. Royden. Real Analysis. 3rd ed. Upper Saddle River: Prentice Hall, 1988, p. 25.
[89]
H.L. Royden. Real Analysis. 3rd ed. Upper Saddle River: Prentice Hall, 1988, p. 259.
[90]
H.L. Royden. Real Analysis. 3rd ed. Upper Saddle River: Prentice Hall, 1988, p. 53.
[91]
H.L. Royden. Real Analysis. 3rd ed. Upper Saddle River: Prentice Hall, 1988, pp. 204–
206.
[92]
H.L. Royden. Real Analysis. 3rd ed. Upper Saddle River: Prentice Hall, 1988, pp. 291–
298.
[93]
H.L. Royden. Real Analysis. 3rd ed. Upper Saddle River: Prentice Hall, 1988, p. 406.
[94]
H.L. Royden. Real Analysis. 3rd ed. Upper Saddle River: Prentice Hall, 1988, p. 396.
[95]
H.L. Royden. Real Analysis. 3rd ed. Upper Saddle River: Prentice Hall, 1988, p. 397.

BIBLIOGRAPHY
116
[96]
H.L. Royden. Real Analysis. 3rd ed. Upper Saddle River: Prentice Hall, 1988, p. 309.
[97]
H.L. Royden. Real Analysis. 3rd ed. Upper Saddle River: Prentice Hall, 1988, p. 260.
[98]
H.L. Royden. Real Analysis. 3rd ed. Upper Saddle River: Prentice Hall, 1988, p. 191.
[99]
H.L. Royden. Real Analysis. 3rd ed. Upper Saddle River: Prentice Hall, 1988, pp. 17–
19.
[100]
H.L. Royden. Real Analysis. 3rd ed. Upper Saddle River: Prentice Hall, 1988, p. 274.
[101]
H.L. Royden. Real Analysis. 3rd ed. Upper Saddle River: Prentice Hall, 1988, p. 408.
[102]
H.L. Royden. Real Analysis. 3rd ed. Upper Saddle River: Prentice Hall, 1988, pp. 303–
304.
[103]
H.L. Royden. Real Analysis. 3rd ed. Upper Saddle River: Prentice Hall, 1988, p. 200.
[104]
H.L. Royden. Real Analysis. 3rd ed. Upper Saddle River: Prentice Hall, 1988, p. 157.
[105]
H.L. Royden. Real Analysis. 3rd ed. Upper Saddle River: Prentice Hall, 1988, p. 179.
[106]
H.L. Royden. Real Analysis. 3rd ed. Upper Saddle River: Prentice Hall, 1988, p. 53.
[107]
R.A. Ryan. Introduction to Tensor Products of Banach Spaces. Springer Monographs
in Mathematics. London: Springer-Verlag, 2002.
[108]
R.A. Ryan. Introduction to Tensor Products of Banach Spaces. Springer Monographs
in Mathematics. London: Springer-Verlag, 2002, p. 94.
[109]
Shˆoichirˆo Sakai. Markov Chains. Ergebnisse der Mathematik und ihrer Grenzgebiete
60. New York: Springer-Verlang, 1971, pp. 102–103.
[110]
Shˆoichirˆo Sakai. Markov Chains. Ergebnisse der Mathematik und ihrer Grenzgebiete
60. New York: Springer-Verlang, 1971, p. 48.
[111]
Z. Semadeni. Banach Spaces of Continuous Functions. Vol. 1.
[112]
Z. Semadeni. Banach Spaces of Continuous Functions. Vol. 1.
[113]
Z. Semadeni. Banach Spaces of Continuous Functions. Vol. 1.
[114]
E. Seneta. Non-negative Matrices and Markov Chains. Springer series in Statistics.
New York: Springer-Verlang, 2002, pp. 35–44.
[115]
C.E. Shannon and W. Weaver. The Mathematical Theory of Communication. Urbana:
University of Illinois Press, 1949.
[116]
W. Sierpi´nnski. Cardinal and Ordinal Numbers. Monograﬁe Matematyczne 34. War-
saw: Pa´nstwowe Wydawnictwo Naukowe.
[117]
B. Simon. Orthogonal Polynomials on the Unit Circle. Vol. 2. American Mathematical
Society Colloquium Publications 54. Providence: American Mathematical Society,
2005.
[118]
W.F. Stinespring. “Positive functions on C*-algebras”. In: Proceedings of the Amer-
ican Mathematical Society 6.2 (1955), pp. 211–216.

BIBLIOGRAPHY
117
[119]
G. Szeg¨o. Orthogonal Polynomials. American Mathematical Society Colloquium Pub-
lications 23. New York: American Mathematical Society, 1939.
[120]
T. Traynor. “An elementary proof of the Lifting theorem”. In: Paciﬁc Journal of
Mathematics 53 (1974), pp. 267–272.
[121]
A.I. Tulcea. Topics in the theory of lifting. Ergebnisse der Mathematik und ihrer
Grenzgebiete 48. Berlin: Springer, 1969.
[122]
H. Vaihinger. Die Philosophie des Als Ob: System der theoretischen, praktischen, und
religi¨osen Fiktionen der Menschenheit auf Grund eines idealistischen Positivismus.
Mit einem Anhag ¨uber Kant und Nietzsche. Written as a dissertation in 1877. Leipzig:
Felix Meiner Verlag, 1911.
[123]
W.F. Wertz. Towards a New Council of Florence: On the Peace of Faith and Other
Works by Nicolaus of Cusa. Chap. On Conjectures.
[124]
A. Wilansky. Modern Methods in Topological Vector Spaces. New York: McGraw-Hill,
Inc., 1978, p. 237.
[125]
A. Wilansky. Modern Methods in Topological Vector Spaces. New York: McGraw-Hill,
Inc., 1978, p. 17.
[126]
W.K. Wooters and W.H. Zureck. “A single quantum cannot be cloned”. In: Nature
299 (1982), pp. 802–803.

118
Appendix A
General propositions
A.1
Banach space propositions
Notation
Let A, B,. . . denote Banach spaces.
Proposition A1.1
Maps in B(A,B) are continuous in the weak topologies on A and B.
Proof
Take any such map L. For any weak neighborhood
N(La;φ1,...,φn;ε) = {b ∈B∣∣φj(b −La)∣< ε for j ∈{1,...,n}}
(A.1)
with a ∈A, φ1,...,φn ∈B∗, and ε > 0 we have
L(N(a;L∗φ1,...,L∗φn;ε)) = N(La;φ1,...,φn;ε)
◻
(A.2)
Corollary A1.2
A map in L ∈B(A,B) is uniquely determined by its values on a weakly
dense subset.
Comment
Starting with a weakly dense subset that is a vector space, its norm closure
is necessarily a linear subspace by the properties of Cauchy sequences. Since this subspace
is convex, by the separating theorem [86], it cannot be weakly dense unless it is the entire
space; hence, a weakly dense subset is necessarily also norm-dense. This argument is not
entirely satisfactory since the separating theorem uses the Hahn-Banach theorem [87], which
depends on the axiom of choice [88]. This deﬁciency will be rectiﬁed for the situation of
interest by proposition B1.3 below.
The following important proposition is assigned as an exercise in [125].
Proposition A1.3
Let A and B be Banach spaces. A subset V of A that is a vector space
uniquely determines a map L ∈B(A,B) if V is dense in the norm topology on A and the
operator norm of L restricted to V is bounded. The operator norm of L shares the bound to
the operator norm of its restriction.

APPENDIX A. GENERAL PROPOSITIONS
119
Proof
Since a continuous function is uniquely determined by its values on a weakly dense
subset, and since the norm topology is ﬁner than the weak topology, if L exists, it is unique
by A1.2. For any a ∈A, deﬁne La as the limit of the Cauchy sequence ⟨Laj⟩∞
j=1, where
⟨aj⟩∞
j=1 is any Cauchy sequence converging to a composed of elements of V. The choice of
Cauchy sequence does not matter because, given another Cauchy sequence ⟨bj⟩∞
j=1 converging
to a composed of elements of V, then ⟨aj −bj⟩∞
j=1 is a Cauchy sequence converging to zero,
so ⟨L(aj −bj)⟩∞
j=1 is a Cauchy sequence converging to zero. Since the product of a Cauchy
sequence with a scalar is a Cauchy sequence and the sum of two Cauchy sequences is a
Cauchy sequence, L is linear. ◻
A.2
Hilbert space propositions
Notation
Let H be a Hilbert space.
Proposition A2.1
Convergence of a countable sum of disjoint (PjPk = 0 if j ≠k), or-
thogonal projectors, ∑j Pj, to an orthogonal projector P is equivalent in the following four
topologies on B(H): ultrastrong-operator, strong-operator, ultraweak-operator1, and weak-
operator.
Proof
The weak-operator topology is courser than the other three, so convergence in any
of the others implies convergence in it. Suppose convergence occurs in the weak-operator
topology, so for any ψ,ψ′ ∈H,
lim
k→∞⟨(P −
k
∑
j=1
Pj)ψ,ψ′⟩= 0
(A.3)
Then, for any ﬁxed k,
⟨P
k
∑
j=1
Pjψ,ψ′⟩= lim
m→∞⟨
m
∑
l=1
Pj
k
∑
j=1
Pjψ,ψ′⟩= ⟨
k
∑
j=1
Pjψ,ψ′⟩
(A.4)
Since ψ,ψ′ were arbitrary, P ∑k
j=1 Pj = ∑k
j=1 Pj. Similarly, (∑k
j=1 Pj)P = ∑k
j=1 Pj. Therefore,
(P −∑k
j=1 Pj)
2 = P −∑k
j=1 Pj, so P −∑k
j=1 Pj is itself an orthogonal projector (it is clearly
self-adjoint). Then, by taking ψ = ψ′, this implies
lim
k→∞∥(P −
k
∑
j=1
Pj)ψ∥= 0
(A.5)
so convergence necessarily also occurs in the strong-operator topology. Since the sequence
of operators ⟨P −∑k
j=1 Pj⟩
∞
k=1 is bounded in operator norm (all being projectors), the con-
vergence necessarily occurs in the ultrastrong-operator topology as well.
However, the
1Same as the weak* topology.

APPENDIX A. GENERAL PROPOSITIONS
120
ultrastrong-operator topology is ﬁner than the others, so convergence in it implies con-
vergence in the other three. ◻
A.3
Transition function propositions
Notation
For the following, sets will be denoted X, Y,... and σ-algebras by E, F,.... The
spaces of ﬁnite, signed-measures on the given set with the given σ-algebra will be denoted
M(X;E), M(Y;F),.... These are Banach spaces using the total variation norm. Note–by
convention product measures are written using × although they are actually tensor products
and should be written using ⊗(see [111] for a use of the latter notation).
Following [69], we have the following:
Deﬁnition A3.1
For σ-algebras E on X and F on Y, a function τ(⋅∣⋅) ∶F × X →R is a
transition function if: (i) for each x ∈X, τ(⋅∣x) ∈M(Y;F); and (ii) for each B ∈F, τ(B∣⋅)
is a bounded, E-measurable function on X.
If τ(⋅∣⋅) is positive and has the additional property that τ(Y∣⋅) = 1X, then it is termed a
transition probability function. The transition functions for speciﬁed (E, X, F, Y) clearly
form a vector space. They form a Banach space using the norm
∥τ(⋅∣⋅)∥= sup
x∈X
∥τ(⋅∣x)∥total variation
(A.6)
A transition function τ(⋅∣⋅) with speciﬁed data (E, X, F, Y) induces a linear map L ∈
B(M(X;E),M(Y;F)) via
(Lµ)(B) = ∫x∈X τ(B∣x)dµ(x)
(A.7)
Not every bounded linear map is induced by a transition function; in general, a pseudo-
transition “function” is required (see B2.7 and B2.8). However, we do have the following:
Proposition A3.2
If L ∈B(M(X;E),M(Y;F)) and K ∈B(M(Y;F),M(Z;G)) are both
induced by transition functions, then the composition K ○L is also induced by a transition
function.
Proof
Let L and K be such maps, with associated transition functions τ(⋅∣⋅) and ν(⋅∣⋅).
Deﬁne ω(⋅∣⋅) by
ω(C∣x) = ∫y∈Y ν(C∣y)d(τ(⋅∣x))(y)
(A.8)
for C ∈G and x ∈X. Then ω(⋅∣x) ∈M(Z;G). To see that ω(C∣⋅) is E-measurable, note
that, since ν(C∣⋅) is F-measurable and bounded, there is a sequence of simple functions

APPENDIX A. GENERAL PROPOSITIONS
121
⟨∑k bjk1Bjk⟩converging uniformly to it. By the Dominated Convergence theorem [75], we
then have
ω(C∣x) = lim
j→∞∑
k
bjkτ(Bjk∣x)
(A.9)
By [89], ﬁnite sums of measurable functions are measurable and the pointwise limit of a
sequence of measurable functions is measurable, so ω(C∣⋅) is measurable. Hence, ω(⋅∣⋅) is a
transition function.
Now take any µ ∈M(X;E) and C ∈G. Then, using the preceding results,
((K ○L)(µ))(C) = ∫y∈Y ν(C∣y)d(Lµ)(y) = lim
j→∞∑
k
bjk(Lµ)(Bjk)
(A.10)
= lim
j→∞∑
k
bjk ∫x∈X τ(Bjk∣x)dµ(x) = ∫x∈X ω(C∣x)dµ(x)
Hence, K ○L is induced by the transition function ω(⋅∣⋅). ◻
Proposition A3.3
If L ∈B(M(X;E),M(Z;G)) and K ∈B(M(Y;F),M(W;H)) are both
induced by transition functions, then the tensor product map K ⊗L is well-deﬁned and also
induced by a transition function.
Proof
Let L and K be such maps, with associated transition functions τ(⋅∣⋅) and ν(⋅∣⋅).
Deﬁne ω(⋅∣⋅) by ω(⋅∣x,y) = τ(⋅∣x) × ν(⋅∣y) for each x ∈X and y ∈Y. Then ω(⋅∣x,y) is clearly
in M(X × Y;I), where I is the σ-algebra generated by the rectangular subsets R = E × F.
The rectangular subsets form a semialgebra2 Then the ﬁnite union of rectangular sets is an
algebra.
Following Hausdorﬀ[26], let R0 be the rectangular subsets R. For each ordinal α, let
Rα be the collection of subsets of X × Y that are the countable intersection of subsets from
the various collections Rβ for ordinals β < α if α is even and that are the countable union of
subsets from the various collections Gβ for ordinals β < α if α is odd (where all limit ordinals–
those without a predecessor–taken even). For clariﬁcation, using the standard notation [90],
R1 = Rσ, R2 = Rσδ, and so on for the ﬁnite ordinals.
Fix any ordinal α and suppose that for all subsets B in all collections Rβ for β < α we
have the following property: there is an I-measurable ω(B∣⋅) such that
((L ⊗K)µ)(B) = ∫(x,y)∈X×Y ω(B∣x,y)dµ(x,y)
(A.11)
for any I-measure µ on X × Y. Take any C ∈Rα. If α is odd, we have a sequence ⟨Bj⟩of
subsets from the various Rβ with β < α such that C = ⋃j Bj. Let ω(C∣⋅) = ⋁j ω(Bj∣⋅). Then
ω(C∣⋅) is I-measurable (see [89]) and we can extend L ⊗K by
((L ⊗K)µ)(C) = ∫(x,y)∈X×Y ω(C∣x,y)dµ(x,y)
(A.12)
2A collection of sets is a semialgebra if it is closed under intersection and the complement of any set is
a ﬁnite union of sets in the collection.

APPENDIX A. GENERAL PROPOSITIONS
122
for any I-measure µ on X ×Y; hence, since C was arbitrary, Rα has the property. Similarly,
if α is even, we have a sequence ⟨Bj⟩of subsets from the various Rβ with β < α such that
C = ⋂j Bj. Let ω(C∣⋅) = ⋀j ω(Bj∣⋅). Then ω(C∣⋅) is measurable and we can extend L ⊗K by
(A.12); hence, Rα also has the property.
However, R0 has the property–for any I-measure µ, (L⊗K)µ is uniquely determined on
the rectangular subsets by
((L ⊗K)µ)(A × B) = ∫(x,y)∈X×Y τ(A∣x)ν(B∣y)dµ(x,y)
(A.13)
and ω(A×B∣x,y) = τ(A∣x)ν(B∣y) is I-measurable (see [89])–so by transﬁnite induction [27] [116]
all the Rα have the property. Following Kuratowski [43], the σ-algebra I is given by the
union ⋃α Rα. Therefore, ω(⋅∣⋅) is a transition function and induces a well-deﬁned tensor
product map K ⊗L. ◻
Comment
The preceding proof does not depend on the axiom of choice since the union
only needs to be taken up to the ordinal number for the minimal uncountable well-ordered
set [26] [43], whose existence does not depend on the axiom of choice [55].
Lemma A3.4
For any measure space (X,E,µ), any “function” f ∈L0(X;µ) contains some
E-measurable function.
Proof
Take any function g ∈f. For each x ∈X where g(x) ∈{±∞,undeﬁned}, redeﬁne
g so g(x) = 0. The new g is still in f. Now construct the sequence of µ-measurable simple
functions ⟨gk⟩converging pointwise to g by
g0 = 0,g1 = 1{g≥1} −1{g≤−1}
(A.14)
and for k ∈{1,2...},
gk+1 = 2k ⋅1{g≥2k} +
4k−1
∑
m=1
m
2k 1{ m+1
2k >g≥m
2k } +
−1
∑
m=−4k+1
m
2k 1{ m−1
2k <g≤−m
2k } −2k ⋅1{g≤−2k}
(A.15)
By the deﬁnition of the completion E0 of E [73], for each E0-measurable subset B, there is
some D ∈E such that D ⊃∼B and µ(D) = µ(∼B); hence C =∼D is in E, is contained within
B, and has µ(C) = µ(B). Using this, for k ∈{0,1,2...} there are subsets {Ck
m} ∈E such

APPENDIX A. GENERAL PROPOSITIONS
123
that:
C(k+1)
2k
⊂{g ≥2k} and µ(D(k+1)
2k
) = 0 for D(k+1)
2k
= {g ≥2k} ∖C(k+1)
2k
(A.16)
C(k+1)
m
⊂{m + 1
2k
> g ≥m
2k } and µ(C(k+1)
m
) = 0
for D(k+1)
m
= {m + 1
2k
> g ≥m
2k } ∖C(k+1)
2k
,m ∈{1,2,...,4k −1}
(A.17)
C(k+1)
m
⊂{m −1
2k
< g ≤−m
2k } and µ(D(k+1)
m
) = 0
for D(k+1)
m
= {m −1
2k
< g ≤−m
2k } ∖C(k+1)
2k
,m ∈{−1,−2,...,−4k + 1}
(A.18)
C(k+1)
−2k
⊂{g ≤−2k} and µ(D(k+1)
−2k ) = 0 for D(k+1) = {g ≤−2k} ∖C(k+1)
−2k
(A.19)
Hence, there is a sequence of E-measurable simple functions ⟨hk⟩, where
h0 = 0,h1 = 1C(1)
1
−1C(1)
−1 ,hk+1 =
4k
∑
m=−4k,m≠0
m
2k 1C(k+1)
m
(A.20)
Then ⟨hk⟩converges pointwise to a E-measurable function h [89]. The function h diﬀers from
g on at most the subset ⋃k ⋃m D(k)
m , which is the countable union of µ-null subsets; hence,
itself µ-null. Therefore, h is necessarily in f. ◻
For the following, (X,E,µ) is a measure space with µ(X) = 1 and F is a σ-algebra on Y.
Deﬁnition 3.5
A conditional probability ν(⋅∣⋅) is a L1(X;µ)+-valued, vector F-measure on
Y with the property that τ(Y∣⋅) = [1X].
Deﬁnition 3.6
A transition probability function τ(⋅∣⋅) is a lift of a conditional probability
ν(⋅∣⋅) if τ(B∣⋅) ∈ν(B∣⋅) for every subset B ∈F.
Proposition A3.7
If either: (i) F is generated by countably many atoms; (ii) Y is an
uncountable, complete, separable, metric space with F the Borel σ-algebra; or (iii) E is gen-
erated by countably many atoms–then for any marginal probability µ on X and conditional
probability ν(⋅∣⋅), there is some (generally non-unique) lift τ(⋅∣⋅).
Proof–case(i)
For each atom A ∈F, choose a particular, E-measurable function ˆν(A∣⋅) ∈
ˆν(A∣⋅) (these exist by A3.4). The function ˆν(A∣⋅) can only be less than zero on a set of
µ-measure zero; hence, the set B1 where any of these functions is less than zero is still of
µ-measure zero. Furthermore, since the union of all atoms is X, we have
∑
atoms A∈F
ˆν(A∣⋅) ∈ν(X∣⋅) = [1X]
(A.21)

APPENDIX A. GENERAL PROPOSITIONS
124
where the sum on the left-hand side converges pointwise; hence, the function given by the
left-hand side has value one almost everywhere with respect to µ. Let B2 be the set with µ-
measure zero where it is not equal to one. Let B be a set in E with µ-measure zero containing
B1 ∪B2 (such a set necessarily exists by the deﬁnition of µ-measure zero [89]). Then, deﬁne
τ(⋅∣⋅) by
τ(B∣x) =
⎧⎪⎪⎨⎪⎪⎩
∑atoms A∈F,A⊂B ˆν(A∣x)
if x ∉B
∫X ν(B∣⋅) dµ
if x ∈B
(A.22)
for any B ∈F and x ∈X. It is readily seen that τ(⋅∣⋅) is a lift of ν(⋅∣⋅).
Case(ii)
The obvious approach is to use the separable and metric properties to form
countable, locally ﬁnite open covers of decreasing radii using the paracompact property of
metric spaces [91] [56]–from these a sequence of reﬁning partitions can be formed.
The
σ-algebra generated by these partitions is the Borel σ-algebra; one may then hope that a
procedure similar to the preceding with a choice for each element of each partition would
give the lift τ(⋅∣⋅). However, while it easily seen this approach succeeds if a lift exists (and we
will show one does below), it cannot be used to prove the existence of a lift; the problem is
that to employ the Extension theorem [92] pointwise to get a measure, unlike the situation
above, there are an uncountable number of conditions that must be met. While each fails on
a set of measure zero, it is not clear that taken altogether the set where any one of them fails
is still only of measure zero. (The existence of a lift would give this, but that is what we are
trying to prove!) Instead, we will proceed in a diﬀerent direction. The plan is to add in an
auxiliary measure space, namely [0,1] with the standard topology, the Borel σ-algebra, and
Lebesgue measure. Then we will construct a deterministic transition probability function3
(see A3.9 for the connection to another common concept of determinism); integrating over
the auxiliary space will then provide the desired lift.
Start with the result due to Kuratowski that Y is Borel equivalent4 to the interval [0,1]
with the standard topology [93]; let ψ ∶[0,1] →Y be the corresponding bijection. For λ
Lebesgue measure on [0,1], let the σ-ideal5 N be the µ×λ-null subsets of σ (E × Borel([0,1])).
For each α ∈[0,1], let ˆν(ψ([0,α))∣⋅) be a particular E-measurable (not merely µ-measurable)
function from ν(ψ([0,α))∣⋅) (these exist by A3.4). Deﬁne the equivalence class Aα of subsets
of X × [0,1] by
⎡⎢⎢⎢⎢⎣
⋃
s∈[0,1]
{x∣ˆν(ψ([0,α))∣x) > s} × {s}
⎤⎥⎥⎥⎥⎦
=
⎡⎢⎢⎢⎢⎣
⋃
q∈Q×[0,1]
{x∣ˆν(ψ([0,α))∣x) > q} × [0,q]
⎤⎥⎥⎥⎥⎦
(A.23)
3One taking only the values zero and one.
4Two topological spaces X and Y are Borel equivalent if there is a bijection ψ ∶X →Y such that both ψ
and ψ−1 take Borel sets to Borel sets (so both ψ−1 and ψ are Borel measurable).
5A σ-ideal is a subcollection of a σ-algebra that contains all subsets of member sets within the σ-algebra
and is closed under countable unions.

APPENDIX A. GENERAL PROPOSITIONS
125
where the equivalence class is taken over sets that diﬀer by subsets in the σ-ideal N. Clearly
this is independent of the choice of ˆν(ψ([0,α))∣⋅). Note Aα = [X] for α > 1 and Aα = N for
α ≤0.
Then the collection {Aα} is a soma6 By [95], there is a σ (E × Borel([0,1]))-measurable
function ϕ ∶X × [0,1] →[0,1] for which the soma7 of [ϕ] is Aα. (Note ϕ is not unique; any
particular function in [ϕ] will do.)
Now deﬁne τ(ψ([0,α))∣⋅) by
τ(ψ([0,α))∣x) = essential sup{s ∈[0,1]∣ϕ(x,s) ∈[0,α)}
(A.24)
where the essential supremum is taken over equivalence classes of sets diﬀering by Lebesgue-
null sets. By Tonelli’s theorem [96] , τ(ψ([0,α))∣⋅) is an E-measurable function. Furthermore,
it is it ν(ψ([0,α))∣⋅). To see this, note that by Tonelli’s theorem, for almost every x ∈X
with respect to µ, the sets
{s ∈[0,1]∣ˆν(ψ([0,α))∣x) > s} and {s ∈[0,1]∣ϕ(x,s) ∈[0,α)}
(A.25)
diﬀer by only a Lebesgue measure zero subset. Taking the essential supremum over each set,
we have that ˆν(ψ([0,α))∣⋅) = τ(ψ([0,α))∣⋅) almost everywhere with respect to µ.
More generally, for any B ∈Borel(Y), deﬁne τ(B∣⋅) by
τ(B∣x) = λ({s ∈[0,1]∣ψ ○ϕ(x,s) ∈B})
(A.26)
Since the composition of measurable functions is measurable (readily seen by the deﬁnition
of measurability), then, by Tonelli’s theorem, τ(B∣⋅) is E-measurable.
For each x ∈X,
τ(⋅∣x) is a Borel measure on Y with τ(Y∣x) = 1. Finally, since the collection {[0,α)} over
α ∈R generates the Borel σ-algebra on [0,1], the collection {ψ([0,α))} generates the Borel
σ-algebra on Y, so τ(B∣⋅) ∈ν(B∣⋅) for any B ∈Borel(Y).
Case(iii)
For each atom A ∈E with µ(A) > 0, ν(B∣x) is well-deﬁned for any x ∈A and
B ∈F, so τ(B∣x) is necessarily ν(B∣x). On the remaining atoms, τ(⋅∣⋅) can be set rather
arbitrarily; take it to be ∫X ν(B∣⋅) dµ for concreteness. ◻
Examining the proof of the preceding theorem, we have the following interesting result:
Proposition A3.8
If either: (i) F is generated by countably many atoms; or (ii) Y
is an uncountable, complete, separable, metric space with F the Borel σ-algebra–then for
6Following [94], for σ-algebra E with σ-ideal given by null sets N, the collection of equivalence classes
indexed by reals {Aα} of E/N is a soma if: (i) Aα ≤Aβ for α ≤β; and (ii) Aα = ⋁j Aβj for any countable,
increasing sequence ⟨βj⟩converging to α.
7The soma of the equivalence class [f] of a real valued function f is the collection of equivalence classes
of preimages, [f −1((−∞,α))], over α ∈R.

APPENDIX A. GENERAL PROPOSITIONS
126
any transition probability function τ(⋅∣⋅) ∶F × X →[0,1] there is a deterministic transition
probability function ξ(⋅∣⋅) ∶F × X × [0,1] →{0,1} such that
τ(B∣x) = ∫s∈[0,1] ξ(B∣x,s) dλ(s)
where λ is Lebesgue measure on R.
Proof
First take case (i). By the deﬁnition of being countable, there is an ordering of the
atoms {Aj} for j ∈{1,2,...} (with the indexing set truncating to j ∈{1,2,...,n} if there are
only ﬁnitely many atoms). For m ∈{1,2,...} (or m ∈{1,2,...,n}), deﬁne Bm by ⋃m
j=1 Aj
and Cm ⊂X × [0,1] by
⋃
s∈[0,1]
{x∣τ(Bm∣x) > s} × {s} =
⋃
q∈Q×[0,1]
{x∣τ(Bm∣x) > q} × [0,q]
(A.27)
Then ⟨Cm⟩is an increasing, nested sequence of subsets in σ(E × [0,1]) such that ⋃m Cm =
X × [0,1].
Deﬁne the function ϕ ∶X × [0,1] →Z+ by
ϕ(x,s) = ∑
j
1X∖Cj
(A.28)
Deﬁne ξ(⋅∣⋅) by
ξ (B∣x,s) =
⎧⎪⎪⎨⎪⎪⎩
1
if Aϕ(x,s) ⊂B
0
otherwise
(A.29)
for any B ∈F, x ∈X, and s ∈[0,1]. Deﬁne τ ′(⋅∣⋅) by
τ ′(B ⋅x) = ∫s∈[0,1] ξ(B∣x,s) dλ(s)
(A.30)
for any B ∈F and x ∈X. It is readily seen that ξ(⋅∣⋅) is a deterministic transition probability
function and τ ′(⋅∣⋅) is a transition probability function. Furthermore, for any m ∈{1,2,...}
(or m ∈{1,2,...,n}),
τ ′(Bm∣x) = ∫s∈[0,1] ξ(Bm∣x,s) dλ(s) = λ(Cm ∩{x} × [0,1]) = τ(Bm∣x)
(A.31)
Since the collection {Bm} generates F, τ(⋅∣⋅) = τ ′(⋅∣⋅).
Now take case (ii). As with the proof of the preceding theorem, start with the proposition
that Y is Borel equivalent to the interval [0,1] with the standard topology; let ψ ∶[0,1] →Y
be the corresponding bijection. Deﬁne the σ(E × Borel([0,1]))-measurable subsets Aα of
X × [0,1] by
Aα =
⋃
s∈[0,1]
{x∣τ(ψ([0,α))∣x) > s} × {s}
(A.32)
=
⋃
q∈Q×[0,1]
{x∣τ(ψ([0,α))∣x) > q} × [0,q]
(A.33)

APPENDIX A. GENERAL PROPOSITIONS
127
Note Aα = X for α > 1 and Aα = ∅for α ≤0.
Then, following [97] the collection of ordinate sets {Aα} deﬁnes a σ(E × Borel([0,1]))-
measurable function ϕ ∶X × [0,1] →[0,1] by
ϕ(x,s) = inf{α ∈R∣(x,s) ∈Aα}
(A.34)
Deﬁne ξ(⋅∣⋅) by
ξ (B∣x,s) =
⎧⎪⎪⎨⎪⎪⎩
1
if ψ ○ϕ(x,s) ∈B
0
otherwise
(A.35)
for any B ∈F, x ∈X, and s ∈[0,1]. Deﬁne τ ′(⋅∣⋅) by
τ ′(B ⋅x) = ∫s∈[0,1] ξ(B∣x,s) dλ(s)
(A.36)
for any B ∈F and x ∈X. It is readily seen that ξ(⋅∣⋅) is a deterministic transition probability
function and τ ′(⋅∣⋅) is a transition probability function. Furthermore, for any α ∈R,
τ ′(ψ([0,α))∣x) = ∫s∈[0,1] ξ(ψ([0,α))∣x,s) dλ(s)
= λ(Aα ∩{x} × [0,1]) = τ(ψ([0,α))∣x)
(A.37)
Finally, since the collection {[0,α)} over α ∈R generates the Borel σ-algebra on [0,1], the
collection {ψ([0,α))} generates the Borel σ-algebra on Y, so τ(⋅∣⋅) = τ(⋅∣⋅). ◻
Comment
Note the preceding can be readily extended to cover cases where µ is the zero
measure apart from a sub-σ-algebra of E generated by countably many atoms or the marginal
probability on Y formed from ν(⋅∣⋅) and µ is the zero measure apart from a sub-σ-algebra of
F generated by countably many atoms.
Proposition A3.9
If either: (i) F is generated by countably many atoms; or (ii) Y is an
uncountable, complete, separable, metric space with F the Borel σ-algebra–then any deter-
ministic transition probability function τ(⋅∣⋅) ∶F ×X →{0,1} is induced by some measurable
point transformation f ∶X →Y, τ(B∣x) = (1B ○f)(x).
Proof
First take case (i). For each x ∈X, take f(x) to be any value in the atom A ∈X
with the property τ(A∣x) = 1 ⇔τ(Y ∖A∣x) = 0.
Now take case (ii). As with the preceding proofs, start with the proposition that Y is
Borel equivalent to the interval [0,1] with the standard topology; let ψ ∶[0,1] →Y be the
corresponding bijection. For each x ∈X, take f(x) to be deﬁned by
f(x) = ψ (sup{α ∈[0,1]∣τ(ψ([0,α))∣x) = 0})
(A.38)
Then f is measurable since {(α,1]∣α ∈R} generate the Borel subsets of [0,1], so {ψ((α,1])∣α ∈
R} generate the Borel subsets of Y, and
f −1 (ψ((α,1])) = {x∣ψ−1 ○f(x) > α} = {x∣τ(ψ((α,1])∣x) = 1} ∈E
◻
(A.39)

APPENDIX A. GENERAL PROPOSITIONS
128
Proposition A3.10
If the marginal probability µ on X and conditional probability ν(⋅∣⋅)
are such that the resulting joint probability is absolutely continuous with respect to the
product measure µ×η for some F-measure η on Y, then there is some (generally non-unique)
lift τ(⋅∣⋅).
Proof
The joint probability measure ρ resulting from µ and ν(⋅∣⋅) is
ρ(A × B) = ∫A ν(B∣⋅);dµ
(A.40)
for any rectangular subset A × B ∈E × F. By the Radon-Nikod´ym theorem [72], there is
a “function” g ∈L1(X × Y;µ × η), the Radon-Nikod´ym derivative g =
dρ
d(µ × η), such that
ρ = g µ × η. Choose any particular σ(E × F)-measurable function ˆg ∈g (such a function
necessarily exists by A3.4). The function ˆg is less than zero on a subset of µ × η-measure
zero; by changing ˆg to be zero there, the new ˆg is still in g. By Tonelli’s theorem, ξ(B∣⋅) =
∫y∈B ˆg(⋅,y) dη(y) is E-measurable. Take τ(B∣x) to be ξ(B∣x) for all x where ξ(X∣x) = 1; on
the E-measurable, µ-null subset where ξ(X∣⋅) ≠1, take τ(B∣x) to be ρ(X × B). ◻
Comment
Instead of the approach of A3.7, one may attempt a simpler approach using
the notion of liftings from L∞(X;µ) to E-measurable functions on X. [70] [120] [121]
Deﬁnition A3.11
A map from L ∶L∞(X;µ) →µ-measurable functions on X is a linear
lifting if it has the following properties: (i) L is positive, linear, and continuous (bounded);
(ii) Lf ∈f for any f ∈L∞(X;µ); and (iii) L[1X] = 1X.
Deﬁnition A3.12
A linear lifting is a lifting if it also respects the multiplicative structure8
of L∞(X;µ): (iv) K(fg) = Kf Kg for any f,g ∈L∞(X;µ).
Deﬁnition A3.13
A lifting is an E-lifting if it maps into E-measurable functions (rather
than simply µ-measurable ones).
The existence of E-liftings is in general an open question, even in simple cases.9 Note the
Lifting theorem [70] [120] does give the existence of a lifting K ∶L∞(X;µ) →E0-measurable
functions on X. However, the completed σ-algebra E0 depends on the marginal probability
µ, so this is not what we desire. Furthermore, the proof of the Lifting theorem relies on the
Axiom of Choice and is nonconstructive [70], so it is of little practical use. In addition, as
the following example demonstrates, this approach cannot work in general:
8Then the lifting K necessarily takes “functions” containing characteristic sets to characteristic sets,
which reduces the problem of the existence of liftings to that of the existence of set liftings.
9For instance, X = [0,1], G being the Borel σ-algebra, and µ being Lebesgue measure. [121]

APPENDIX A. GENERAL PROPOSITIONS
129
Counter-example A3.14
Let X = Y = [0,1] with the usual topology. Let E = F be the
resulting Borel σ-algebra. Let λ be Lebesgue measure on [0,1] and the joint probability ρ
be the diagonal measure
ρ(E) = λ({x ∈[0,1]∣(x,x) ∈E})
(A.41)
Then the marginal probability µ = λ and the conditional probability ν(B∣⋅) = [1B]. There
is an obvious lift given by τ(B∣⋅) = 1B. However, this cannot be written as a lifting applied
to ν(B∣⋅); else, since τ(B∣⋅) ≠τ(B′∣⋅) for B ≠B′ yet B and B′ diﬀer by a λ-null subset, so
[1B] = [1B′], we have the contradiction
1B = τ(B∣⋅) = K [1B] = K [1B′] = τ(B′∣⋅) = 1B′
We now claim that there is no lift τ(⋅∣⋅) of ν(⋅∣⋅) which can be written as τ(B∣⋅) = Kν(B∣⋅)
for all Borel subsets B for a lifting map K.
Proof
Suppose there were such a lift coming from a lifting map K. Since liftings take
characteristic functions to characteristic functions, K induces a set lifting κ by K[1B] =
1C ⇔C = κB.
Let A0 = [0,1].
Then κA0 diﬀers from A0 by a λ-null set.
(Actually,
κ[0,1] = [0,1], but we are seeking to establish a general pattern.) By deﬁnition, there is an
open set B0 that covers A0 ∖κA0 with λ(B0) < 1
4 (one-quarter can be replaced by anything
strictly between one-half and zero). Now, iteratively, deﬁne Aj = [ mj
2j , mj+1
2j ] to be either the
subset [ mj−1
2j−1 , 2mj−1+1
2j
] or [ 2mj−1+1
2j
, mj−1+1
2j−1 ] depending on which one has
j−1
∑
k=0
λ(Aj ∩Bk) ≤1
2
j−1
∑
k=0
λ(Aj−1 ∩Bk)
(A.42)
Once we have Aj, we take Bj to be an open set that covers Aj ∖κAj with λ(Bj) <
1
4j+1, then
continue to Aj+1.
Since [0,1] is compact and each Aj is closed, the decreasing nested sequence of subsets
⟨Aj⟩has nonempty intersection by the ﬁnite intersection property [98] [57]. Since the diam-
eters of the Aj tend to zero, this intersection is a single point–call it x0. Then x0 is also
in the intersection ⋂j κAj. Suppose otherwise, so it is not in some κAj; hence, it is in Bj.
Since Bj is open, then there is some ball, (x0 −ε,x0 + ε), also in Bj. Then, for k suﬃciently
large so ε > 2−k, Ak ⊂Bj. However,
λ(Ak ∖
k
⋃
m=0
Bm) ≥1
2k −
k
∑
m=0
λ(Ak ∪Bm)
≥1
2k −1
2
k−1
∑
m=0
λ(Ak−1 ∪Bm) −
1
4k+1
(A.43)
Continuing, we eventually arrive at
λ(Ak ∖
k
⋃
m=0
Bm) ≥1
2k −
k
∑
m=0
1
2k−m4m+1 > 1
2 ⋅1
2k > 0
(A.44)

APPENDIX A. GENERAL PROPOSITIONS
130
which is a contradiction to Ak ⊂Bj. Hence, x0 ∈⋂j κAj. Note, by the positivity of K,
⟨κAj⟩is also a decreasing nested sequence (with κAj ⊂Aj) and x0 is the only point in the
intersection.
However, this leads to a contradiction. For each j, let Ej = Aj ∖{x0}, so ⋃j Ej = ∅. Then,
since Aj ∼Ej ∼κAj, pointwise
lim
j→∞Kν (Ej∣⋅) = lim
j→∞K [1Ej] = lim
j→∞1κAj
(A.45)
which is zero except at x0, where it has the value one. For each j, let Fj = Ej ∖Ej+1, so {Fj}
is a disjoint collection. Then, pointwise, by the countable additivity of measures,
∑
j
Kν (Fj∣⋅) = Kν (⋃
j
Fj∣⋅) = Kν ([0,1] ∖{x0}∣⋅) = 1κ[0,1] = 1[0,1]
(A.46)
However, for any m,
1[0,1] = Kν (⋃
j
Fj∣⋅) = Kν (
m−1
⋃
j=1
Fj ∪Em∣⋅) =
m
∑
j=1
Kν (Fj∣⋅) + Kν (Em∣⋅)
(A.47)
Taking the limit as m →∞gives the right-hand side as
∑
j
Kν (Fj∣⋅) + lim
m→∞Kν (Em∣⋅) = 1[0,1] + 1{x0}
(A.48)
which is a contradiction. Hence, there is no lift τ(⋅∣⋅) arising from a lifting map K for the
conditional probability ν(⋅∣⋅). ◻

131
Appendix B
Propositions for option I
B.1
Measures
Notation
For the following, sets will be denoted X, Y,... and σ-algebras by E, F,.... The
spaces of ﬁnite, signed-measures on the given set with the given σ-algebra will be denoted
M(X;E), M(Y;F),.... These are Banach spaces using the total variation norm. For a given
measure space (X,E,µ), let E0 be the σ-algebra given by the completion of E with respect
to µ (see [73]). The extension of µ to E0 will still be denoted µ. Then we will say µ is a
F-measure if F is a sub-σ-algebra of E0. An element of E0 will be termed µ-measurable.
Deﬁnition B1.1
A subset of signed-measures, M ⊂M(X;E), is absolutely-continuous-
complete if, for any µ in M, all signed-measures in mathcalM(X;E) absolutely continuous
with respect to ∣µ∣are also in M.
Proposition B1.2
Any absolutely-continuous-complete subset that is a vector space is
directed-complete1.
Proof
Let M ⊂M(X;E) be such a subset. Given any upward-directed subset B ⊂M,
bounded by above by some ρ ∈M, deﬁne ⋁µ∈B µ by, for any E ∈E,
( ⋁
µ∈B
µ)(E) = sup
µ∈B
µ(E)
(B.1)
This exists since it is bounded from above by ρ(E). It is readily seen that ⋁µ∈B µ is greater
than or equal to (using the partial ordering) any µ ∈B and that, given any other ν ∈M
with that property, ⋁µ∈B µ ≤ν. Given any countable collection of disjoint, measurable sets,
1A partially-ordered subset is upward-directed if, given any two elements, there is a third that is greater
than or equal to both. A set is directed-complete if any bounded, upward-directed subset has a supremum.

APPENDIX B. PROPOSITIONS FOR OPTION I
132
{E}∞
j=1 ⊂E, by the upward-directed property and the countable additivity of each µ ∈B,
n
∑
j=1
( ⋁
µ∈B
µ)(Ej) + ( ⋁
µ∈B
µ)(
∞
⋃
j=n+1
Ej) ≤( ⋁
µ∈B
µ)(
∞
⋃
j=1
Ej) ≤
∞
∑
j=1
( ⋁
µ∈B
µ)(Ej)
(B.2)
for any n ∈{1,2,...}. Since ν ≤⋁µ∈B µ ≤ρ for any ν ∈B, and both ρ and ν are countably
additive, both (⋁µ∈B µ)(⋃∞
j=n+1 Ej) →0 and the tail sum ∑∞
j=n+1 (⋁µ∈B µ)(Ej) →0 as n →∞,
so
∞
∑
j=1
( ⋁
µ∈B
µ)(Ej) ≤( ⋁
µ∈B
µ)(
∞
⋃
j=1
Ej) ≤
∞
∑
j=1
( ⋁
µ∈B
µ)(Ej)
(B.3)
Therefore, ⋁µ∈B µ is countably additive, so it is a signed E-measure.
Its total variation
norm is bounded by the total variation norm of ρ ∨(−ν) for any particular ν ∈B. Since
ν ≤⋁µ∈B µ ≤ρ, ⋁µ∈B µ is absolutely continuous with respect to ∣ρ∣+ ∣ν∣, so ⋁µ∈B µ ∈M. ◻
Comment
The following proposition corrects the defect mentioned after A1.2 for the
particular case required.
For the following two propositions, let G be the σ-algebra generated2 by the rectangular
subsets E × F, denoted G = σ(E × F). Let the absolutely-continuous-complete subsets M ⊂
M(X;E), N ⊂M(Y;F), and Q ⊂M(X × Y;G) also be vector spaces.
Proposition B1.3
If M ⊗N is weakly dense in Q, then it is norm-dense in Q.
Proof
Suppose there were some measure µ ∈Q+ not in the norm-closure of M ⊗N, so there
is some ϵ > 0 such that ∥µ−ν∥total variation > ε for all ν ∈M ⊗N. By Hahn-decomposition [100]
and the absolutely-continuous-completeness property of M and N, if ν ∈M ⊗N, then
∣ν∣∈M ⊗N.
Let µ ⊥∣ν∣be the singular part of µ with respect to ∣ν∣using Lebesgue
decomposition [76]. The set of G-measures {µ ⊥∣ν∣∣ν ∈M ⊗N} is lower-bound by the zero-
measure. It is downward-directed since µ ⊥(∣ν∣+ ∣ν′∣) is less than or equal to (in the partial
ordering) both µ ⊥∣ν∣and µ ⊥∣ν′∣for any ν,ν′ ∈M ⊗N. Hence, by the preceding proposition,
the G-measure τ = ⋀ν∈M⊗N µ ⊥∣ν∣exists. Furthermore, from its deﬁnition in the preceding
proof, this measure has total-variation norm greater than or equal to ε. Let ρ∥τ be the ab-
solutely continuous part of ρ with respect to τ using Lebesgue decomposition. Now consider
the bounded, linear functional Φ ∈M(X × Y;G)∗given by Φρ = (ρ∥τ)(X × Y). This is zero
on M ⊗N, yet Φµ = ∥τ∥total variation ≥ε; hence, µ is not in the weak-closure of M ⊗N. ◻
Proposition B1.4
If M ⊗N is norm-dense in Q, then M + ⊗R+ N + is norm-dense in Q+.
2For any collection A of subsets of X, the σ-algebra generated by A, σ(A), is the smallest σ-algebra of
subsets of X containing A. [99]

APPENDIX B. PROPOSITIONS FOR OPTION I
133
Proof
By Hahn-decomposition and the absolutely-continuous-completeness property of M
and N, the measures in M ⊗N are total-variation norm-dense for the measures Q+. Given
any measure µ = ∑j νj ⊗τj ∈M ⊗N, it is absolutely continuous with respect to the prod-
uct measure ρ = (∑j ∣νj∣) ⊗(∑k ∣τk∣), which is in M ⊗N by Hahn-decomposition and the
absolutely-continuous-completeness property of M and N. By the Radon-Nikod´ym theo-
rem [72], there is a positive “function” dµ
dρ ∈L1(X × Y;ρ) such that µ = dµ
dρρ. By proposition
B3.1 below, dµ
dρ can be arbitrarily well approximated in total-variation norm by elements of
L1 (X;∑j ∣νj∣)
+ ⊗R+ L1 (Y;∑k ∣τk∣)+. ◻
Proposition B1.5
The total-variation norm is a cross-norm for product measures.
Proof
Let µ ∈M(X;E) and ν ∈M(Y;F). By Hahn decomposition, ∣µ × ν∣= ∣µ∣× ∣ν∣, so
∥µ × ν∥= ∣µ × ν∣(X × Y) = ∣µ∣(X)∣ν∣(Y) = ∥µ∥∥ν∥
◻
(B.4)
Proposition B1.6
If µ is a σ-ﬁnite measure on X, then there is no uncountable collection
{Aα} of subsets of X with the properties that µ(Aα) > 0 for all α and µ(Aα ∩Aβ) = 0 for all
α ≠β.
Proof
Suppose otherwise. Since µ is σ-ﬁnite, there is a countable, disjoint collection {Bj}
of subsets of X such that each Bj has ﬁnite µ-measure and their union ∪jBj is the entire
space X. Now suppose there is some ε > 0 and j such that for inﬁnitely many of the {Aα},
µ(Bj ∩Aα) > ε. That immediately contradicts µ(Bj) being ﬁnite. Therefore, it must be
the case that for any ε > 0 and j, only ﬁnitely many of the {Aα} satisfy µ(Bj ∩Aα) > ε.
Let {Ak} be the countable collection formed by taking the union over all j and over all
ε ∈{1,2−1,2−2,...} of such {Aα}. However, this also leads to a contradiction, since for any
Aβ ∉{Ak}, µ(Aβ ∩Bj) = 0 for all j, yet 0 < µ(Aβ) = ∑j µ(Aβ ∩Bj) = 0. ◻
Proposition B1.7
If a σ-ﬁnite measure is inﬁnitely-divisible3, then it has no atoms-for-
the-measure4.
Proof
Consider the following property: a measure σ-ﬁnite µ for a measure space (X,E,µ)
has the once-divisible property if for any subset A ∈E with ﬁnite µ(A) > 0, there are disjoint
B,C ∈E with B ∪C = A such that both µ(B) and µ(C) are less than 3
4µ(A). This property
is readily seen to be equivalent to being inﬁnitely-divisible. Furthermore, if there is an atom-
for-the-measure, then the once-divisible property does not hold. Hence, it remains to show
if the once-divisible property does not hold, there is necessarily an atom for the measure.
3A σ-ﬁnite measure µ for a measure space (X,E,µ) is inﬁnitely-divisible if for any ε > 0, there is a
countable (ﬁnite if µ is ﬁnite) partition of X, {Bj}, with each µ(Bj) < ε.
4For a measure space (X,E,µ), a subset A ∈E is an atom-for-the-measure µ if for any B ∈E with B ∈A,
either µ(B) = 0 or µ(A ∖B) = 0.

APPENDIX B. PROPOSITIONS FOR OPTION I
134
Suppose there is a subset A ∈E with ﬁnite µ(A) > 0 such that there are no disjoint B,C ∈E
with B ∪C = A such that both µ(B) and µ(C) are less than 3
4µ(A). Let c be the inﬁnum
over b ∈[ 3
4,1] such that the division is possible for both µ(B) and µ(C) are less than b⋅µ(A).
If c = 1, then A is an atom-for-the-measure µ. If there is a division with µ(B) = c ⋅µ(A),
then B is an atom-for-the-measure µ. The only remaining possibility is that for every ε > 0,
there is a division with µ(B) < (c + ε)µ(A). By taking ε ∈{20,2−1,2−2,...} successively, we
get a sequence of subsets ⟨Bj⟩with c ⋅µ(A) < µ(Bj) < (c + 2−j)µ(A). For every j < k in Z+,
c ⋅µ(A) < µ(Bj ∩Bk) < (c + 2−k)µ(A); hence, ⋂∞
j=0 Bj is in E with µ(⋂∞
j=0 Bj) = c ⋅µ(A)–a
contradiction. Hence, this possibility cannot occur. ◻
Comment
Note that an atom-for-the-measure need not be an atom for the σ-algebra.
For instance, the atomic measure δ{0} on R has all subsets containing 0 as atoms-for-the-
measure. For separable, metric spaces with the Borel σ-algebra, all atoms-for-the-measure
are induced by atomic measures in this manner. [101] However, there are other ways atoms-
for-the-measure can occur. Consider the measure on [0,1] assigning zero to all countable
subsets and one to their complements. Then all the subsets with countable complement are
atoms-for-the-measure.
Take the measure µ ﬁnite. Then by successive partitioning and an arguments similar to
that used in the preceding proof, for any ε > 0 it is possible, with only ﬁnitely many steps,
to ﬁnd disjoint atoms-for-the-measure {Aj} such that any atoms-for-the-measure A in the
restriction of µ to X ∖⋃j Aj have µ(A) < ε. By taking ε ∈{20,2−1,2−2,...} successively, we
get a countable partition of subsets in E
(X ∖⋃
j
Aj) ∪⋃
j
Aj
(B.5)
where µ restricted to X ∖⋃j Aj is inﬁnitely-divisible and each Aj is an atom-for-the-measure.
This can clearly be extended to σ-ﬁnite µ.
Proposition B1.8
For the ﬁnite, Borel measure ρ on [0,1] × [0,1] (with the standard
topology) and linear map K of §3.2, Kρ is the zero measure.
Proof
Take any ﬁnite Borel measures µ,nu on [0,1] (with the standard topology). By the
preceding comment,
µ = µ0 + ∑
j
ajδ{xj}, ν = ν0 + ∑
j
bjδ{yj}
(B.6)
where µ0,nu0 are inﬁnitely-divisible, ⟨aj⟩,⟨bj⟩are summable sequences of strictly positive
reals, and {xj},{yj} are countable subsets of [0,1]. Consider the partition of [0,1] × [0,1]
given by A ∪B ∪C, where B = (({xj} ∪{yj) × [0,1]) ∪([0,1] × ({xj} ∪{yj)), C = {(x,x)∣x ∈
[0,1]} ∖B, and A = [0,1] × [0,1] ∖{(x,x)∣x ∈[0,1]} ∖B. Then ρ is clearly the zero measure
on A∪B and both µ×∑j bjδ{yj} and (∑j ajδ{xj})×ν0 are clearly the zero measure on C. Take

APPENDIX B. PROPOSITIONS FOR OPTION I
135
any ε > 0. Since µ0 is inﬁnitely-divisible, we have a ﬁnite partition {Bj} of [0,1]∖({xj}∪{yj)
where µ0(Bj) is less than ε for every j. Then
µ0 × ν0(C) ≤∑
j
µ0 × ν0(Bj × Bj) = ∑
j
µ0(Bj)ν0(Bj)
≤ε∑
j
ν0(Bj) = εν0([0,1] ∖({xj} ∪{yj))
(B.7)
Since ε was arbitrary, it must be that µ0 × ν0 is the zero measure on C as well. Therefore,
ρ ⊥µ × ν. Since µ,nu were arbitrary, Kρ is the zero measure. ◻
Proposition B1.9
For σ-ﬁnite, E-measures µ,nu on X, If nu is absolutely convergent with
respect to µ and µ is inﬁnitely-divisible, then ν is inﬁnitely-divisible.
Proof
Suppose otherwise, so by B1.7 there is a subset A that is an atom-for-the-measure
ν. Since µ is inﬁnitely-divisible, it has the once-divisible property (see B1.7), so there are
disjoint subsets B1 and C1 in E with B1∪C1 = A such that both µ(B1) and µ(C1) are less than
3
4µ(A). Take E1 the one of B1,C1 that is an atom-for-the-measure ν. Repeat the process
with E1 for A and iterate to get a nested, decreasing sequence of subsets in E, ⟨Ej⟩. Then
µ(⋂j Ej) = limj µ(Ej) = 0 whereas µ(⋂j Ej) = limj µ(Ej) = µ(A)–a contradiction to ν being
absolutely continuous. Hence, ν has no atoms-for-the-measure and is inﬁnitely-divisible. ◻
B.2
Maps on subspaces of the space of measures
Let M ⊂M(X;E) be any absolutely-continuous-complete, norm-closed subspace.
Proposition B2.1
Any positive linear map L ∈B(M,M(Y;F)) has
∥L∥op =
sup
µ∈M+,µ(X)≤1
Lµ(Y)
(B.8)
Proof
Since L is positive, ∣Lµ∣= ∣L(µ+−µ−)∣= ∣L(µ+)−L(µ−)∣≤L(µ+)+L(µ−) = L∣µ∣using
Hahn decomposition, so
sup
µ∈M+,µ(X)≤1
Lµ(Y) ≤∥L∥op =
sup
∣µ∣(X)≤1
∣Lµ∣(Y) ≤
sup
µ∈M+,µ(X)≤1
Lµ(Y)
◻
(B.9)
Proposition B2.2
The space of maps B(M,M(Y;F)) is a vector lattice5.
5A partially-ordered, vector space A is a vector lattice if for any a,b ∈A, there are elements a ∨b and
a ∧b such that a ∨b is greater than or equal to both a and b, but is less than or equal to any other element
with that property and a ∧b is less than or equal to both a and b, but is greater than or equal to any other
element with that property.

APPENDIX B. PROPOSITIONS FOR OPTION I
136
Proof
For any maps K,L ∈B(M,M(Y;F)) deﬁne K ∨L by (K ∨L)(µ)(F) for µ ∈M +
and F ∈F being
sup
⎧⎪⎪⎪⎪⎪⎨⎪⎪⎪⎪⎪⎩
n
∑
j=1
m
∑
k=1
max{(Kµj)(Fk),(Lµj)(Fk)}
RRRRRRRRRRRRRRRRRR
n,m ∈{1,2,...}
µ1,...,µn ∈M +
disjoint F1,...,Fm ∈F
∑n
j=1 µj = µ,⋃m
j=1 Fj = F
⎫⎪⎪⎪⎪⎪⎬⎪⎪⎪⎪⎪⎭
(B.10)
Clearly, K ∨L ≥K and K ∨L ≥L. Also, for any J ∈B(M,M(Y;F)) satisfying J ≥K and
J ≥L, then J ≥K ∨L. Also, clearly (K ∨L)(c ⋅) = c(K ∨L) for any real scalar c > 0. Since
M is a Banach lattice6, it has the Riesz decomposition property [66] that for any ρ,ν ∈M +,
any µ1,...,µn ∈M + such that ∑n
j=1 µj = ρ + ν can be decomposed into µj = ρj + νj with both
ρj,νj ∈M + for each j and with ∑n
j=1 ρj = ρ and ∑n
j=1 νj = ν. Also, given any partition of
F into disjoint, F-measurable subsets, F = ⋃m1
j=1 Gj = ⋃m2
j=1 Hj, there is a reﬁnement of both
partitions, F = ⋃m1
j=1 ⋃m2
k=1 Gj ∩Hk. Therefore, (K ∨L)(ρ + ν)(F) is equal to
sup
⎧⎪⎪⎪⎪⎪⎨⎪⎪⎪⎪⎪⎩
n
∑
j=1
m
∑
k=1
max{(Kµj)(Fk),(Lµj)(Fk)}
RRRRRRRRRRRRRRRRRR
n,m ∈{1,2,...}
µ1,...,µn ∈M +
disjoint F1,...,Fm ∈F
∑n
j=1 µj = ρ + ν,⋃m
j=1 Fj = F
⎫⎪⎪⎪⎪⎪⎬⎪⎪⎪⎪⎪⎭
(B.11)
= sup
⎧⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎨⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎩
∑n1
j=1 ∑m1
k=1 max{ (Kρj)(Gk),
(Lρj)(Gk)
}
+∑n2
j=1 ∑m2
k=1 max{ (Kνj)(Hk),
(Lνj)(Hk)
}
RRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRR
n1,n2,m1,m2 ∈{1,2,...}
ρ1,...,ρn1,
ν1,...,νn2 ∈M +
disjoint G1,...,Gm1 ∈F,
disjoint H1,...,Hm2 ∈F
∑n1
j=1 ρj = ρ,∑n2
j=1 νj = ν
⋃m1
j=1 Gj = ⋃m2
j=1 Hj = F
⎫⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎬⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎭
= (K ∨L)(ρ)(F) + (K ∨L)(ν)(F)
Since the cone of measures is generating for signed measures by Hahn decomposition and
since M has the absolutely-continuous-complete property, K ∨L extends to a linear map on
all of M.
It remains to show the image of the map K ∨L is indeed the signed measures. Since the
cone of measures is generating, it suﬃces to show this with any µ ∈M +. Take any countable
collection of disjoint, measurable subsets {Fj}∞
j=1 ⊂F. By the preceding argument using
Riesz decomposition and reﬁnement of partitions, for any n ∈{1,2,...},
n
∑
j=1
(K ∨L)(µ)(Fj)+(K ∨L)(µ)(
∞
⋃
j=n+1
Fj) ≤(K ∨L)(µ)(
∞
⋃
j=1
Fj) ≤
∞
∑
j=1
(K ∨L)(µ)(Fj) (B.12)
6A positive cone is normal if 0 ≤a ≤b implies ∥a∥≤∥b∥. A Banach lattice is a complete, normed vector
lattice with a normal cone and with ∥∣a∣∥= ∥a∥.

APPENDIX B. PROPOSITIONS FOR OPTION I
137
However, Kµ ≤(K ∨L)µ ≤∣Kµ∣+ ∣Lµ∣and both Kµ and ∣Kµ∣+ ∣Lµ∣are countably additive,
so both the tail of the series, ∑∞
j=n+1(K ∨L)(µ)(Fj), and (K ∨L)(µ)(⋃∞
j=n+1 Fj) go to zero
as n →∞. Therefore, (K ∨L)µ is countably additive.
Finally, K ≤K ∨L ≤∣K∣+ ∣L∣, so K ∨L is absolutely continuous with respect to ∣K∣+ ∣L∣.
Hence, K ∨L ∈M. Therefore, B (M(X;E),M(Y;F)) is a vector lattice. ◻
Proposition B2.3
With the operator norm induced by the total variation norms,
B(M,M(Y;F)) has a normal cone.
Proof
By B2.1, it only necessary to consider elements in the positive cone M + to calculate
the operator norm of any L ∈B (M,M(Y;F))+. Hence, for any K ∈B (M,M(Y;F))+ with
K ≤L, ∥K∥op ≤∥L∥op. ◻
Proposition B2.4
For any map L ∈B (M,M(Y;F)), ∥∣L∣∥op = ∥L∥op.
Proof
For any such L,
∥L∥op =
sup
µ∈M,∥µ∥≤1
∥Lµ∥
(B.13)
which, using Hahn decomposition, is equal to (using µ ⊥ν to show they are mutually singular)
∥L∥op = sup{∥L(µ −ν)∥∣µ,ν ∈M +
µ ⊥ν,∥µ −ν∥≤1 }
(B.14)
Since µ and ν are mutually singular,
∥µ −ν∥= ∥µ∥+ ∥ν∥= ∥µ + ν∥
(B.15)
Then, since ∣Lµ∣< ∣L∣µ and ∣Lν∣< ∣L∣ν,
∥L∥op ≤sup{∣L∣(µ + ν)(Y)∣µ,ν ∈M +
µ ⊥ν,(µ + ν)(Y) ≤1 }
(B.16)
which can only be increased by not requiring µ and ν to be mutually singular, so, rewriting
µ + ν →µ, ∥L∥op is less than or equal to supµ∈M+,∥µ∥≤1 ∣L∣(µ)(Y), which, by B2.1, is equal to
∥∣L∣∥op.
On the other hand, by B2.1,
∥∣L∣∥op =
sup
µ∈M+,∥µ∥≤1
∣L∣(µ)(Y)
(B.17)
which, using ∣L∣= L ∨(−L) and the form of ‘∨’ in (B.10), is equal to
sup
⎧⎪⎪⎪⎪⎪⎪⎪⎪⎨⎪⎪⎪⎪⎪⎪⎪⎪⎩
n
∑
j=1
m
∑
k=1
∣(Lµj)(Fk)∣
RRRRRRRRRRRRRRRRRRRRRRR
n,m ∈{1,2,...}
µ1,...,µn ∈M +,
∥∑n
j=1 µj∥≤1,
disjoint F1,...,Fm ∈F,
⋃m
j=1 Fj = Y
⎫⎪⎪⎪⎪⎪⎪⎪⎪⎬⎪⎪⎪⎪⎪⎪⎪⎪⎭
(B.18)

APPENDIX B. PROPOSITIONS FOR OPTION I
138
which is less than or equal to
sup
⎧⎪⎪⎪⎨⎪⎪⎪⎩
n
∑
j=1
∥Lµj∥
RRRRRRRRRRRRRR
n ∈{1,2,...}
µ1,...,µn ∈M +,
∥∑n
j=1 µj∥≤1
⎫⎪⎪⎪⎬⎪⎪⎪⎭
(B.19)
Since, by the AL-space7 property of M, ∥∑n
j=1 µj∥= ∑n
j=1 ∥µj∥, this is less than or equal to
sup
µ∈M+,∥µ∥≤1
∥Lµ∥≤
sup
µ∈M,∥µ∥≤1
∥Lµ∥= ∥L∥op
◻
(B.20)
Comment
By B2.2, B2.3, and B2.4, B(M,M(Y;F)) is a Banach lattice.
For the following proposition, let G = σ(E × F) and J = σ(H × I).
Let the absolutely-
continuous-complete subsets M ⊂M(X;E), N ⊂M(Y;F), and Q ⊂M(X × Y;G) also be
vector spaces.
Proposition B2.5
If M ⊗N is norm-dense in Q, then for any linear maps
L ∈B(M,M(Z;H)) and K ∈B(N,M(W;I)), the map L ⊗K ∶Q →M(Z × W;J )) is
well-deﬁned and satisﬁes ∣L ⊗K∣= ∣L∣⊗∣K∣and ∥L ⊗K∥op = ∥L∥op∥K∥op.
Proof
Both
L ⊗K = (L+ −L−) ⊗(K+ −K−) = L+ ⊗K+ −L+ ⊗K−−L−⊗K+ + L−⊗K−
(B.21)
and
−L ⊗K = −(L+ −L−) ⊗(K+ −K−) = −L+ ⊗K+ + L+ ⊗K−+ L−⊗K+ −L−⊗K−
(B.22)
are clearly less than or equal to (in the partial ordering)
∣L∣⊗∣K∣= (L+ + L−) ⊗(K+ + K−) = L+ ⊗K+ + L+ ⊗K−+ L−⊗K+ + L−⊗K−
(B.23)
so ∣L ⊗K∣≤∣L∣⊗∣K∣. However, by B1.4, B1.5, B2.1, B2.4, and the deﬁnition of operator
norm, ∥∣L∣⊗∣K∣∥≤∥L∥∥K∥. Hence, by A1.3, L ⊗K is well-deﬁned.
However, given any measures ν ∈M + and ρ ∈N + and subsets H ∈H and I ∈I,
∣L ⊗K∣(ν × ρ)(H × I) = sup
⎧⎪⎪⎪⎨⎪⎪⎪⎩
n
∑
j=1
∣(L ⊗K)µj∣(H × I)
RRRRRRRRRRRRRR
n ∈{1,2,...}
µ1,...,µn ∈Q+
∑n
j=1 µj = ν × ρ
⎫⎪⎪⎪⎬⎪⎪⎪⎭
(B.24)
using a similar argument to that for the proof of B2.4. By Riesz decomposition, this is
equal to
sup
⎧⎪⎪⎪⎨⎪⎪⎪⎩
n
∑
j=1
m
∑
k=1
∣(L ⊗K)(νj × ρk)∣(H × I)
RRRRRRRRRRRRRR
n,m ∈{1,2,...}
ν1,...,νn ∈M +,ρ1,...,ρm ∈N +
∑n
j=1 νj = ν,∑m
k=1 ρk = ρ
⎫⎪⎪⎪⎬⎪⎪⎪⎭
(B.25)
7A Banach lattice is an AL-space if ∥a + b∥= ∥a∥+ ∥b∥for a,b in the positive cone.

APPENDIX B. PROPOSITIONS FOR OPTION I
139
which, by the triangle inequality, is greater than or equal to ∣(Lν) × (Kρ)∣(H × I). By the
property of signed measures that ∣µ × µ′∣= ∣µ∣× ∣µ′∣, this is equal to ∣Lν∣(H)∣Kρ∣(I).
The rectangular subsets H × I generate the σ-algebra J , so ∣L ⊗K∣(ν × ρ)(A)
≥((∣L∣ν) × (∣K∣ρ))(A) for any A ∈J . By the assumption in the proposition and A1.3,
∣L ⊗K∣(µ)(A) ≤(∣L∣⊗∣K∣)(µ)(A) for any µ ∈Q+. Hence, ∣L ⊗K∣≥∣L∣⊗∣K∣, so ∣L ⊗K∣=
∣L∣⊗∣K∣.
We already have ∥L ⊗K∥op ≤∥L∥op∥K∥op. On the other hand,
∥∣L∣∥op∥∣K∣∥op = sup{∣L∣(µ)(Z)∣K∣(ν)(W)∣µ ∈M +,µ(X) ≤1,
ν ∈N +,ν(Y) ≤1
}
(B.26)
≤sup{(∣L∣⊗∣K∣)(µ)(Z × W)∣µ ∈Q+
µ(X × Y) ≤1 } = ∥∣L∣⊗∣K∣∥op
so ∥L ⊗K∥op = ∥∣L∣⊗∣K∣∥op = ∥∣L∣∥op∥∣K∣∥op = ∥L∥op∥K∥op. ◻
Corollary B2.6
Positive maps L ∈B (M,M(Y;F))+ are completely-positive8.
Proof
Use B1.4, B2.5, and the positivity of both maps L and IB(N). ◻
Analogously to the pseudo-functions which compose the doubly-dual space C(Z)∗∗for C(Z)
the continuous functions on some compact space Z (see [113]), we have the following:
Deﬁnition B2.7
A pseudo-transition “function” τ.(⋅∣⋅) with data (M, M(Y;F)) has the
properties: (i) for each measure µ ∈M +, τµ(⋅∣⋅) is a L1(X;µ)-valued vector F-measure on Y;
(ii) for each B ∈F and µ ∈M +, τµ(B∣⋅) is essentially bounded with respect to µ (so it is in
L∞(X;µ)); and (iii) if µ ∈M + is absolutely continuous with respect to ν ∈M +, then for any
B ∈F, τµ(B∣⋅) = τν(B∣⋅) as elements in L1(X;µ).
Comment
Using A3.7, it is possible in many commonly encountered situations to lift a
pseudo-transition “function” to a pseudo-transition function, but we will not further pursue
this. The space of pseudo-transition “functions” is clearly a vector space. It is a Banach
space under the norm
∥τ.(⋅∣⋅)∥=
sup
µ∈M+,∥µ∥≤1
∥τµ(⋅∣⋅)∥
(B.27)
Proposition B2.8
The space of maps B (M,M(Y;F)) is isometrically isomorphic to the
space of pseudo-transition “functions” with data (M, M(Y;F)). Furthermore, this isomor-
phism takes the positive cones in each space to one another.
8A map L is completely-positive if L ⊗IB(N) is positive for every N of the form previously given.

APPENDIX B. PROPOSITIONS FOR OPTION I
140
Proof
Given such a pseudo-transition “function” τ.(⋅∣⋅), deﬁne L by
(Lµ)(B) = ∫x∈X τ∣µ∣(B∣x)dµ(x)
(B.28)
for any B ∈F and µ ∈M. Then Lµ is indeed a signed measure since it is countably additive
because τ is a vector measure. Since τ∣aµ∣(⋅∣⋅) = τ∣µ∣(⋅∣⋅) for any a ∈R ∖{0}, L(aµ) = aLµ for
any a ∈R. Also, for any ν ∈M,
(L(µ + ν))(B) = ∫x∈X τ∣µ∣(B∣x)dµ(x) + ∫x∈X τ∣ν∣(B∣x)dν(x)
(B.29)
= ∫x∈X τ∣µ∣+∣ν∣(B∣x)d(µ + ν)(x)
(B.30)
= ∫x∈X τ∣µ+ν∣(B∣x)d(µ + ν)(x)
(B.31)
Hence, L is linear. To see that it is bounded, we have
∥L∥op =
sup
µ∈M,∥µ∥≤1
∥Lµ∥=
sup
µ∈M,∥µ∥≤1
∣Lµ∣(Y)
(B.32)
By Hahn decomposition [100], this is equal to
sup{(Lµ)(A) −(Lµ)(B)∣µ ∈M,∥µ∥≤1,
disjoint A,B ∈F }
(B.33)
which is equal to
sup{∑
j
((Lµ)(Aj) −(Lµ)(Bj))∣µ ∈M,∥µ∥≤1,
ﬁnite, disjoint collections {Aj,Bj} ⊂F }
(B.34)
This is bounded above by
sup{∑
j
∥τµ(Aj∣⋅)∥∣µ ∈M +,∥µ∥≤1,
ﬁnite, disjoint collections {Aj} ⊂F } =
sup
µ∈M+,∥µ∥≤1
∥τµ(⋅∣⋅)∥= ∥τ.(⋅∣⋅)∥
(B.35)
Finally, if τ.(⋅∣⋅) is positive, L is clearly positive.
Now suppose we are given such a map L. For any measure µ ∈M +, let Mµ be the subspace
that is absolutely continuous with respect to µ. By the Radon-Nikod´ym theorem, Mµ is
isometrically isomorphic to L1(X;µ). Therefore, the adjoint map (L∣Mµ)∗takes M(Y;F)∗
to L1(X;µ)∗≅L∞(X;µ), which is a subspace of L1(X;µ) since µ is ﬁnite. For each B ∈F,
deﬁne τµ(B∣⋅) to be (L∣Mµ)∗ΦB, where ΦB ∈M(Y;F)∗is the linear functional that evaluates
a signed measure on the set B. Then τµ(⋅∣⋅) is a L1(X;µ)-valued vector measure since the
countable additivity of µ implies τµ(⋅∣⋅) is countably additive. If µ is absolutely continuous
with respect to ν ∈M +, then Mµ ⊂Mν, so τµ(B∣⋅) = τν(B∣⋅) as elements of L1(X;µ).

APPENDIX B. PROPOSITIONS FOR OPTION I
141
Therefore, τ.(⋅∣⋅) is a pseudo-transition “function”. To see that τ.(⋅∣⋅) is bounded in norm,
we have
∥τ.(⋅∣⋅)∥=
sup
µ∈M+,∥µ∥≤1
∥τµ(⋅∣⋅)∥
(B.36)
= sup{∑
j
∥τµ(Aj∣⋅)∥∣µ ∈M +,∥µ∥≤1,
ﬁnite, disjoint collections {Aj},⊂F }
≤sup{∑
j
µ(Aj)∥τµ(Aj∣⋅)∥L∞(X;µ) ∣µ ∈M +,∥µ∥≤1,
ﬁnite, disjoint collections {Aj},⊂F }
However,
∑
j
µ(Aj)∥τµ(Aj∣⋅)∥L∞(X;µ) = ∑
j
µ(Aj)∥(L∣Mµ)∗ΦAj∥L∞(X;µ) ≤µ(⋃
j
Aj)∥(L∣Mµ)∗∥op ≤∥L∥op
(B.37)
so ∥τ.(⋅∣⋅)∥≤∥L∥op. Lastly, if L is positive, so must be τ.(⋅∣⋅); otherwise, if there were some
µ ∈M + and B ∈F such that τµ(B∣⋅) were strictly less than zero on a set A ∈E with µ(A) > 0,
then
(L(1Aµ))(B) = ∫A(L∣Mµ)∗ΦB dµ = ∫A τµ(A∣x)dµ < 0
(B.38)
which would be a contradiction. ◻
It is also possible to deﬁne τ.(⋅∣⋅) in terms of L rather than adjoints of restrictions of L using
the Radon-Nikod´ym derivative:
τµ(B∣⋅) = (L∣Mµ)∗ΦB = d(((L∣Mµ)∗ΦB)µ)
dµ
= dµB
dµ
(B.39)
where µB is the E-measure on X given by µB(A) = (L(1Aµ))(B). Using this, we have the
following:
Proposition B2.9
The positive map L ∈B (M,M(Y;F))+ is norm-preserving on the pos-
itive cone if and only if the associated pseudo-transition ”function” τ.(⋅∣⋅) satisﬁes τµ(Y∣⋅) =
[1X] for every measure µ ∈M +.
Proof
Suppose such a positive map L is norm-preserving on the positive cone; then, for
any measure µ ∈M + and subset A ∈E,
(L(1Aµ))(Y) = (1Aµ)(X) = µ(A)
(B.40)
Therefore, using the notation of the preceding comment, µY = µ, so τµ(Y∣⋅) = dµ
dµ = [1X].
Conversely, suppose τ.(⋅∣⋅) is such that τµ(Y∣⋅) = [1X] for every measure µ ∈M +. Then, for
any measure µ ∈M +,
(Lµ)(Y) = ∫x∈X τ(Y∣x)dµ(x) = µ(X)
(B.41)
so L is norm-preserving on the positive cone. ◻

APPENDIX B. PROPOSITIONS FOR OPTION I
142
B.3
L1-spaces
Notation
In the following, let X, Y,... denote sets and µ, ν,... denote σ-ﬁnite measures.
Hilbert spaces, denoted H, J,... are complete, sesquilinear inner-product spaces, with no
restriction as to their dimension or separability. D(H), D(J),... denote the spaces of density
matrices (trace-class, self-adjoint operators) on the speciﬁed Hilbert space. These spaces
are Banach spaces employing the trace norm. L1(X;µ), L1(Y;ν),... denote the space of
integrable, real-valued “functions” on the given sets with respect to the given measures.
These spaces are Banach spaces employing the L1-norm. L1(X;µ;D(H)), L1(Y;ν;D(J)),...
denote the space of Bochner-integrable, density-matrix-valued “functions” on the given sets
with respect the given measures. These spaces are Banach spaces employing ﬁrst the trace
norm pointwise, then the L1-norm. For n ∈{1,2,...}, Mn is the space of n × n-matrices.
Comment
The following proposition strengthens the well-known result, which is a special
case of a result by Grothendieck [17], that L1(X × Y;µ × ν) = L1(X;µ)ˆ⊗L1(Y;ν), where ˆ⊗
indicates completion in the projective norm9.
Proposition B3.1
The ﬁnite-nonnegative-tensor-rank10 “functions” in L1(X × Y;µ × ν)+,
with respect to “functions” in L1(X;µ)+ and L1(Y;ν)+, are dense in the norm topology.
Proof
Take any f ∈L1(X×Y;µ×ν)+. f can be arbitrarily well-approximated in L1(X×Y;µ×
ν)-norm by simple functions: ∑j aj1Aj for ﬁnite collections of positive reals {aj} and ﬁnite
µ × ν-measure subsets {Aj}. By the construction of product measures (see [102]), each Aj is
covered by some ﬁnite collection of disjoint, measurable, rectangular subsets {Bk × Ck} with
µ×ν ((⋃k Bk × Ck) ∖Aj) arbitrarily small. Hence, f can be arbitrarily well-approximated in
L1(X × Y;µ × ν)-norm by simple functions: ∑j aj1Bj×Cj = ∑j aj1Bj ⊗1Cj for ﬁnite collections
of positive reals {aj}, ﬁnite µ-measure subsets {Bj}, and ﬁnite ν-measure subsets {Cj}. ◻
B.4
Density-matrix-valued L1-spaces
Proposition B4.1
L1(X;µ;D(H)) ⊗L1(Y;ν;D(J)) is trace-norm dense within L1(X ×
Y;µ × ν;D(H ⊗J)).
Proof
Given operator ρ ∈D(H ⊗J) , by the spectral theorem for compact operators, ρ
can be arbitrarily well approximated in trace-norm by sums of the form ∑n
j=1 ajej ⊗e∗
j for
some {aj}n
j=1 ⊂R and orthonormal collection of vectors {ej}n
j=1 ⊂H ⊗J. By deﬁnition, each
9The projective norm on A⊗B is the norm induced by duality with Bilinear(A,B), ∥c∥∧= inf ∑j ∥aj∥∥bj∥,
where the inﬁnum is taken over all ∑j aj ⊗bj ∈A ⊗B that equal c.
10Using only positive real scalars.

APPENDIX B. PROPOSITIONS FOR OPTION I
143
ej can be arbitrarily well approximated in H ⊗J-norm (so ej ⊗e∗
j will be arbitrarily well-
approximated in trace-norm) by sums of the form ∑m
k=1 bkfk ⊗gk for some bk ∈C, fk ∈H, and
gk ∈J. Using polarization,
(
m
∑
k=1
bkfk ⊗gk) ⊗(
m
∑
ℓ=1
bℓfℓ⊗gℓ)
∗
(B.42)
=
m
∑
k,ℓ=1
bkbℓ
1
4 ((fk + fℓ) ⊗(fk + fℓ)∗−(fk −fℓ) ⊗(fk −fℓ)∗
+ı(fk + ıfℓ) ⊗(fk + ıfℓ)∗−ı(fk −ıfℓ) ⊗(fk −ıfℓ)∗)
⊗1
4 ((gk + gℓ) ⊗(gk + gℓ)∗−(gk −gℓ) ⊗(gk −gℓ)∗
+ı(gk + ıgℓ) ⊗(gk + ıgℓ)∗−ı(gk −ıgℓ) ⊗(gk −ıgℓ)∗)
=
m
∑
k=1
∣bk∣2 (fk ⊗f ∗
k ) ⊗(gk ⊗g∗
k)
+1
8 ∑
k<ℓ
(R(bkbℓ)(((fk + fℓ) ⊗(fk + fℓ)∗−(fk −fℓ) ⊗(fk −fℓ)∗)
⊗((gk + gℓ) ⊗(gk + gℓ)∗−(gk −gℓ) ⊗(gk −gℓ)∗)
+((fk + ıfℓ) ⊗(fk + ıfℓ)∗−(fk −ıfℓ) ⊗(fk −ıfℓ)∗)
⊗((gk + ıgℓ) ⊗(gk + ıgℓ)∗−(gk −ıgℓ) ⊗(gk −ıgℓ)∗))
−I(bkbℓ)(((fk + fℓ) ⊗(fk + fℓ)∗−(fk −fℓ) ⊗(fk −fℓ)∗)
⊗((gk + ıgℓ) ⊗(gk + ıgℓ)∗−(gk −ıgℓ) ⊗(gk −ıgℓ)∗)
+((fk + ıfℓ) ⊗(fk + ıfℓ)∗−(fk −ıfℓ) ⊗(fk −ıfℓ)∗)
⊗((gk + gℓ) ⊗(gk + gℓ)∗−(gk −gℓ) ⊗(gk −gℓ)∗)))
Then, using the deﬁnition of Bochner integrable functions and following the argument in the
proof of B3.1 gives the desired result. ◻
Corollary B4.2
The Bochner integrable “functions”11 L1(X;µ;S1(H)) ⊗L1(Y;ν;S1(J))
are trace-norm dense within L1(X × Y;µ × ν;S1(H ⊗J)).
Proof
Using Cartesian decomposition12, for any Hilbert space K, S1(K) = D(K) + ıD(K).
Then using the preceding proposition gives the desired result. ◻
11The space S1 are the trace-class operators.
12Writing ρ = 1
2(ρ + ρ∗) + ı ⋅1
2ı(ρ −ρ∗) for ρ ∈S1(K).

APPENDIX B. PROPOSITIONS FOR OPTION I
144
Proposition B4.3
If the σ-ﬁnite measure µ is inﬁnitely-divisible, there is no non-zero,
diagonal13 operator in D(L2(X;µ)).
Proof
Take ρ ∈D(L2(X;µ)) to be diagonal. Take any “function” f ∈L2(X;µ). Take any
ε > 0. Since µ is inﬁnitely-divisible, the measure ∣f∣2µ is inﬁnitely-divisible by B1.9, so there
is a countable partition {Bj} of X such that ∣f∣2µ(Bj) = ∫Bj ∣f∣2 dµ < ε for every j. Then,
since ρ is diagonal,
⟨ρf,f⟩= ∑
j,k
⟨ρ1Bjf,1Bkf⟩= ∑
j
⟨ρ1Bjf,1Bjf⟩
(B.43)
Using the spectral theorem for compact operators to write ρ = ∑j λjψjψ∗
j for ⟨λj⟩an
absolutely-summable sequence, orthonormal {ψj} ⊂X;µ), and ψ∗
j the linear functional
⟨⋅,ψj⟩, this becomes
⟨ρf,f⟩= ∑
j
∑
k
λk ∣⟨1Bjf,ψk⟩∣
2
(B.44)
Since the expression ∣⟨1Bjf,ψk⟩∣
2 is bounded by the Cauchy-Schwartz inequality and ⟨λj⟩is
absolutely-summable, the sum in k is uniformly convergent, so ⟨ρf,f⟩is equal to
∑
k
∑
j
λk ∣⟨1Bjf,ψk⟩∣
2
(B.45)
The “functions” {1Bjf} are orthogonal, so
⟨ρf,f⟩≤(∑
k
λk∥ψk∥2) ⋅sup
j ∥1Bjf∥2 = ∥ρ∥trace ⋅ε
(B.46)
Since ε was arbitrary, it must be that ⟨ρf,f⟩= 0. Since f was arbitrary, it must be that ρ is
the zero operator. ◻
B.5
Maps on density-matrix-valued L1-spaces
Proposition B5.1
Any map L ∈B (L1(X;µ;D(H)),L1(Y;ν;D(J)) satisﬁes
∥L∥op = sup
⎧⎪⎪⎪⎨⎪⎪⎪⎩
∥Lρ∥
RRRRRRRRRRRRRR
ρ ∈L1(X;µ;D(H)),∥ρ∥≤1,
ρ is pointwise almost-every-
where rank one
⎫⎪⎪⎪⎬⎪⎪⎪⎭
13An operator ρ ∈D(L2(X;µ)) is diagonal if ⟨ρ1B,1B′⟩= 0 for every disjoint, µ-measurable B,B′ with
ﬁnite µ-measure.

APPENDIX B. PROPOSITIONS FOR OPTION I
145
Proof
By the deﬁnition of Bochner integrable functions and by the spectral theorem for
compact operators, simple functions with values in the ﬁnite-rank, self-adjoint operators are
L1(X;µ;D(H))-norm dense. Therefore, ∥L∥op is equal to
sup
⎧⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎨⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎩
∥
n
∑
j=1
m
∑
k=1
λjkL(1Ajek
j ⊗ek∗
j )∥
RRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRR
n,m ∈{1,2,...}, disjoint
µ-measurable subsets {A1,...,An},
collections of orthonormal
elements of H
{{e1
1,...,e1
m},...,{en
1,...,en
m}},
{λ11,...,λnm} ⊂R,
∑n
j=1 ∑m
k=1 ∣λjk∣µ(Aj) ≤1
⎫⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎬⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎭
(B.47)
where ek∗
j
is the functional ⟨⋅,ek
j⟩. Now ﬁx a value of j, the A1,...,An, all the collections
of orthonormal vectors, and all the λ’s except λj1,...,λjm. The set of all elements of of
L1(Y;ν;D(J) given by ∑n
j=1 ∑m
k=1 λjkL(1Ajek
j ⊗ek∗
j ) for ﬁxed ∑m
k=1 ∣λjk∣is a ﬁnite-dimensional,
convex subset; hence, its maximum value of norm necessarily occurs at its extreme points
where one λjk is nonzero whereas λj1,..., ̂
λjk,...,λjm are all zero. Since the choice of j was
arbitrary, this is true for all j, so the supremum is unchanged by restricting to m = 1. ◻
Proposition B5.2
Any positive map L ∈B(L1(X;µ;D(H)),L1(Y;ν;D(J))+ satisﬁes
∥L∥op = sup
⎧⎪⎪⎪⎨⎪⎪⎪⎩
∥Lρ∥
RRRRRRRRRRRRRR
ρ ∈L1(X;µ;D(H))+,∥ρ∥≤1,
ρ is pointwise almost-every-
where rank one
⎫⎪⎪⎪⎬⎪⎪⎪⎭
Proof
By the proof of the preceding proposition, ∥L∥op is equal to
sup
⎧⎪⎪⎪⎪⎪⎪⎪⎪⎨⎪⎪⎪⎪⎪⎪⎪⎪⎩
∥
n
∑
j=1
λjL(1Ajej ⊗e∗
j)∥
RRRRRRRRRRRRRRRRRRRRRRR
n ∈{1,2,...}, disjoint
µ-measurable subsets{A1,...,An},
unit-norm e1,...,en ∈H,
{λ1,...,λn} ⊂R,
∑n
j=1 ∣λj∣µ(Aj) ≤1
⎫⎪⎪⎪⎪⎪⎪⎪⎪⎬⎪⎪⎪⎪⎪⎪⎪⎪⎭
(B.48)
The supremum can only be reduced or stay the same by restricting to positive λj’s. However,
since L is positive, by the triangle inequality and the quasi-AL-property14 of L1(Y;ν;D(J)),
∥
n
∑
j=1
λjL(1Ajej ⊗e∗
j)∥≤
n
∑
j=1
∣λj∣∥L(1Ajej ⊗e∗
j)∥= ∥
n
∑
j=1
∣λj∣L(1Ajej ⊗e∗
j)∥
(B.49)
so the supremum can also only be increased or stay the same by restricting to positive λj’s.
Therefore, it must have the same value. ◻
14A Banach space has the quasi-AL-property if ∥a + b∥= ∥a∥+ ∥b∥for positive a, b.

APPENDIX B. PROPOSITIONS FOR OPTION I
146
Corollary B5.3
The cone of positive maps B (L1(X;µ;D(H)),L1(Y;ν;D(J)))+ is a normal
cone for the induced operator norm.
Proposition B5.4
If L ∈B (L1(X;µ;D(H)),L1(Y;ν;D(J))) is completely bounded15,
then, for any space Z, any measure τ, and any Hilbert space K, ∥L ⊗I∥op ≤∥L∥matrix with I
the identity map in B (L1(Z;τ;D(K))).
Proof
By the deﬁnition of operator norm and the deﬁnition of the tensor product of maps,
∥L ⊗I∥op is equal to
sup{∥(L ⊗I)ρ∥∣ﬁnite-tensor-rank ρ ∈L1(X × Z;µ × τ;D(H ⊗K))
with ∥ρ∥≤1
}
(B.50)
By the proof of B5.1, it is only necessary to take the supremum over simple functions taking
values with rank one. By the argument in the proof of B3.1, the sets in the simple functions
can be restricted to being rectangular. This eliminates consideration of Z and τ, replacing
them with positive, real scalars that can be incorporated into the operators. Finally, rank-
one, tensor-rank-n operators live on a n-dimensional subspace of K, which can be identiﬁed
with Cn.
Making the identiﬁcation L1(one point;trivial measure;D(Cn)) ↔D(Cn) then
gives that ∥L ⊗I∥op is equal to supn≤dim K ∥L ⊗IMn∥op. ◻
Proposition B5.5
If the positive map L ∈B (L1(X;µ;D(H)),L1(Y;ν;D(J)))+ is such
that, for some space Z, some measure τ, and some Hilbert space K, L ⊗I is positive with I
the identity map in B (L1(Z;τ;D(K))), then ∥L ⊗I∥op = ∥L∥op.
Proof
Starting as with the preceding proof, we arrive at the point where ∥L⊗I∥op is given
as
sup
⎧⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎨⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎩
∥
n
∑
j=1
(L ⊗I)(ajvj ⊗v∗
j 1Aj ⊗1Bj)∥
RRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRR
n ∈{1,2,...},
ﬁnite-tensor-rank
{v1,...,vn} ∈H ⊗K,
{a1,...,an} ⊂R,
µ-measurable {A1,...,An},
τ-measurable {B1,...,Bn},
with∑n
j=1 ∣aj∣∥vj∥2µ(Aj)τ(Bj) ≤1
⎫⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎬⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎭
(B.51)
where v∗
j is the functional ⟨⋅,vj⟩. Since L ⊗I is positive, as in the proof for B5.2, it is
possible to restrict to positive aj’s without changing the result. Then aj can be combined
with τ(Bj) and both incorporated into a change in the norm of vj. Furthermore, since vj is
of ﬁnite-tensor-rank, it is necessarily in H ⊗Lj for some ﬁnite-dimensional subspace Lj ⊂K,
so it can be written as ∑
dim Lj
k=1
xj
k ⊗ej
k with {ej
k} an orthonormal basis for Lj.
15L is completely bounded if it has ﬁnite matrix-norm, ∥L∥matrix = supn ∥L ⊗IMn∥op.

APPENDIX B. PROPOSITIONS FOR OPTION I
147
Then we have for ∥L ⊗I∥op,
sup
⎧⎪⎪⎪⎪⎨⎪⎪⎪⎪⎩
n
∑
j=1
m
∑
k=1
∥L(xj
k ⊗xj∗
k 1Aj)∥
RRRRRRRRRRRRRRR
n ∈{1,2,...},m ∈{1,2,...},m ≤dimK,
µ-measurable {A1,...,An},
{xk
j} ⊂H,∑n
j=1 ∑m
k=1 ∥xj
k∥
2 µ(Aj) ≤1
⎫⎪⎪⎪⎪⎬⎪⎪⎪⎪⎭
(B.52)
By taking the x’s to be unit length and introducing new, real scalar variables for their
squared norm, then by following the argument in the proof of B5.1, the supremum is the
same if m = 1. Hence, ∥L ⊗I∥op is equal to
sup
⎧⎪⎪⎪⎨⎪⎪⎪⎩
n
∑
j=1
tr ∥L(xj ⊗x∗
j1Aj)∥
RRRRRRRRRRRRRR
n ∈{1,2,...},
µ-measurable {A1,...,An},
{xj} ⊂H,∑n
j=1 ∥xj∥2 µ(Aj) ≤1
⎫⎪⎪⎪⎬⎪⎪⎪⎭
(B.53)
which is ∥L∥op. ◻
Corollary B5.6
The completely-positive16 maps
B (L1(X;µ;D(H)),L1(Y;ν;D(J)))
cp
are completely bounded.
Corollary B5.7
The cone of completely-positive maps,
B (L1(X;µ;D(H)),L1(Y;ν;D(J)))
cp
is a normal cone for either the induced operator norm or the matrix norm.
Proposition B5.8
If L ∈B (L1(X;µ;D(H)),L1(Y;ν;D(J))) is completely positive, then,
for any space Z, any measure τ, and any Hilbert space K, L⊗I is positive, with I the identity
map in B (L1(Z;τ;D(K))).
Proof
Since L is completely positive, by B5.6 it is completely bounded. Hence, L ⊗I
exists by B5.4. Furthermore, by B4.1 and A1.3, L ⊗I is unique, so it is meaningful to
speak of it being positive.
Now suppose there were some space Z, some measure τ, and some Hilbert space K such
that L⊗I were not positive. Then there would be some positive ρ ∈L1(X ×Z;µ×τ;D(H⊗K))+
such that (L ⊗I)ρ is not positive.
Since the cone L1(Y × Z;ν × τ;D(J ⊗K))+ is norm-
closed and L ⊗I is continuous, that implies there is a relatively open neighborhood of
ρ in the cone L1(X × Z;µ × τ;D(H ⊗K))+ whose image under L ⊗I does not intersect
L1(Y × Z;ν × τ;D(J ⊗K))+.
Now approximating ρ as in the proof of B5.4, one ﬁnds that for this to occur there must
be some n ∈{1,2,...} for which L ⊗IMn is not positive; however, that is a contradiction. ◻
16L is completely positive if L ⊗IMn is positive for every n ∈{1,2,...,}.

APPENDIX B. PROPOSITIONS FOR OPTION I
148
Proposition B5.9
If either dimH or dimJ is ﬁnite and if a positive map
L ∈B (L1(X;µ;D(H)),L1(Y;ν;D(J)))
+
is such that L ⊗IMm is positive for m = min{dimH,dimJ}, then L is completely positive.
Proof
Clearly, since L ⊗IMm is positive, so is L ⊗IMn for all n < m. Now take n > m.
L ⊗IMn will be positive if for every ρ ∈L1(X;µ;D(H ⊗Cn))+, y ∈J ⊗Cn, and ν-measurable
B ⊂Y,
∫B⟨((L ⊗IMn)ρ)y,y⟩J⊗Cn dν ≥0
(B.54)
By the deﬁnition of Bochner integrable functions and the spectral theorem for compact
operators, it is enough to show this for ρ that are simple functions with value in the rank-
one operators. We then have to consider, for any ﬁnite collection of vectors {xj} ⊂H ⊗Cn
and µ-measurable subsets {Aj}
∑
j ∫B⟨(L ⊗IMn)(xj ⊗x∗
j 1Aj)y,y⟩J⊗Cn dν
(B.55)
where x∗
j is the functional ⟨⋅,xj⟩. Writing y = ∑n
k=1 vk ⊗ek and xj = ∑n
k=1 wjk ⊗ek for {ek}
an orthonormal basis for Cn gives (B.55) as
∑
j
n
∑
k,l=1∫B⟨L(wjk ⊗w∗
jl 1Aj)vl,vk⟩J dν
(B.56)
However, ∑n
l=1 w∗
jl ⊗vl is of rank at most m, so there are { ˜wjl} and {˜vl} such that
n
∑
l=1
w∗
jl ⊗vl =
m
∑
l=1
˜w∗
jl ⊗˜vl
(B.57)
The condition for L ⊗IMn to be positive is then that for every ν-measurable B ⊂Y, ﬁnite
collection of µ-measurable subsets {Aj}, and ﬁnite collections of vectors { ˜wjk} ⊂H and
{˜vk} ⊂J,
∑
j
m
∑
k,l=1∫B⟨L( ˜wjk ⊗˜w∗
jl 1Aj)˜vl, ˜vk⟩J dν ≥0
(B.58)
However, this condition is independent of n, as long as it is greater than or equal to m. ◻
Proposition B5.10
The space of completely-bounded maps,
CB (L1(X;µ;D(H)),L1(Y;ν;D(J)))
is a Banach space with respect to the matrix norm.

APPENDIX B. PROPOSITIONS FOR OPTION I
149
Proof
Let ⟨Lj⟩be a Cauchy sequence in the matrix norm of such maps. Since the matrix-
norm is greater than or equal to the operator norm, this is a Cauchy sequence in operator
norm, so since the space is a Banach space with respect to the operator norm, it converges
to some L∞in that norm. It remains to show that L∞is completely bounded. For each
n ∈{1,2,...}, by the triangle inequality, ∥K ⊗IMn∥op ≤n2∥K∥op for any linear map K ∈
B (L1(X;µ;D(H)),L1(Y;ν;D(J))); hence, the functional K →∥K ⊗IMn∥op is continuous in
the operator-norm topology. Since ⟨Lj⟩converges to L∞in this topology, it must be that
∥L∞⊗IMn∥op = lim
j→∞∥Lj ⊗IMn∥op ≤lim
j→∞∥Lj∥matrix
(B.59)
The right-hand limit necessarily exists since ⟨Lj⟩is a Cauchy sequence. Therefore, ∥L∞∥matrix ≤
limj→∞∥Lj∥matrix, so L∞is completely bounded. ◻
Proposition B5.11
The subset of B (L1(X;µ;D(H)),L1(Y;ν;D(J))) for which the tensor
product with IMn is positive for some ﬁxed n ∈{1,2,...} is closed in the weak topology.
Proof
We will show the complement is open. Take such a map L that is not in the subset.
By the argument in the proof for B5.9, that implies there are some ν-measurable B ⊂Y,
ﬁnite collection of µ-measurable subsets {Aj}, ﬁnite collections of vectors {wjk} ⊂H and
{vk} ⊂J, and ε > 0 such that
m
∑
j=1
n
∑
k,l=1∫B⟨L(wjk ⊗w∗
jl 1Aj)vl,vk⟩J dν < −ε
(B.60)
Then, by the triangle inequality, all the maps in the weak neighborhood
m
⋂
j=1
n
⋂
k,l=1
N (L;wjkw∗
jk 1Aj;vl ⊗v∗
l 1B;
ε
2n4m)
(B.61)
+
m
⋂
j=1
n
⋂
k=1
⋂
r<l
N (L;(wjr ⊗w∗
jl + wjl ⊗w∗
jr)1Aj;vk ⊗v∗
k 1B;
ε
n4m)
+
m
⋂
j=1
n
⋂
k=1
⋂
r<l
N (L;wjk ⊗w∗
jk 1Aj;(vk ⊗v∗
m + vm ⊗v∗
k)1B;
ε
n4m)
+
m
⋂
j=1 ⋂
k<l
⋂
q<r
N (L;(wjk ⊗w∗
jl + wjl ⊗w∗
jk)1Aj;(vq ⊗v∗
r + vr ⊗v∗
q)1B; 2ε
n4m)
will also fail to yield a positive tensor product with IMn. ◻
Corollary B5.12
The cone of completely positive maps is weakly closed in
B (L1(X;µ;D(H)),L1(Y;ν;D(J))).

APPENDIX B. PROPOSITIONS FOR OPTION I
150
Comment
The preceding result also follows from showing that the spaces are norm-closed,
then using the separating theorem to argue that the weak and norm topologies have the
same closed, convex subsets. The approach followed here is preferable since, as has already
been noted, the separating theorem depends on the axiom of choice through the Hahn-
Banach theorem. For the case where the measures are trivial, the space is a dual space,
D(H) = K(H)∗, so it is possible to do better.
Proposition B5.13
The subset of B (D(H),D(J)) for which the tensor product with IMn
is positive for some ﬁxed n ∈{1,2,...} is closed in the weak* topology.
Proof
Following the proof of B5.9, if L ⊗IMn is not positive, then there are some ﬁnite
collections of vectors {wk} ⊂H and {vk} ⊂J, and ε > 0 such that all the maps in the weak*
neighborhood
n
⋂
k,l=1
N (L;wkw∗
k 1Aj;vl ⊗v∗
l 1B; ε
2n4)
(B.62)
+
n
⋂
k=1
⋂
r<l
N (L;(wr ⊗w∗
l + wl ⊗w∗
r)1Aj;vk ⊗v∗
k 1B; ε
n4)
+
n
⋂
k=1
⋂
r<l
N (L;wk ⊗w∗
k 1Aj;(vk ⊗v∗
m + vm ⊗v∗
k)1B; ε
n4)
+ ⋂
k<l
⋂
q<r
N (L;(wk ⊗w∗
l + wl ⊗w∗
k)1Aj;(vq ⊗v∗
r + vr ⊗v∗
q)1B; 2ε
n4)
will also fail to yield a positive tensor product with IMn. ◻
Corollary B5.14
The cone of completely positive maps in B (D(H),D(J)) is closed in the
weak* topology.
Proposition B5.15
Any bounded, positively-linear map L to L1(Y;ν;D(J)) that is given
on the positive cone of L1(X;µ;D(H)) extends uniquely by linearity to a map
L ∈B (L1(X;µ;D(H)),L1(Y;ν;D(J)))+.
Proof
Let L be any such map. Extend L to B(L1(X;µ;D(H)),L1(Y;ν;D(J)))+ by
L(ρ) = L(∣ρ∣+ ρ
2
) −L(∣ρ∣−ρ
2
) for any ρ ∈L1(X;µ;D(H))
(B.63)
where ∣⋅∣is applied pointwise with ∣ρ∣(x) = ∣ρ(x)∣=
√
ρ(x)2. It is readily seen that positive
linearity implies the extended L is now linear over R. Furthermore, by B5.2, this extension
does not increase the operator norm.

APPENDIX B. PROPOSITIONS FOR OPTION I
151
Proposition B5.16
Any map L ∈B (L1(X;µ;D(H)),L1(Y;ν;D(J)))+ extends uniquely
by linearity to a map L ∈B (L1(X;µ;S1(H)),L1(Y;ν;S1(J)))+. This extension has operator
norm less than twice that of the restricted map.
Proof
Let L be any such map. Extend L to L ∈B(L1(X;µ;S1(H)),L1(Y;ν;S1(J))+) by
using Cartesian decomposition,
L(ρ) = L(ρ + ρ∗
2
) + ıL(ρ −ρ∗
2ı
) for any ρ ∈L1(X;µ;S1(H))
(B.64)
where * is applied pointwise with ρ∗(x) = ρ(x)∗. It is readily seen that real linearity implies
the extended L is now linear over C. By deﬁnition, this extended map is a positive one.
The triangle inequality implies the extension has operator norm less than twice that of the
restricted map. ◻
Comment
Using
S1 (L2(X;µ)) ⊂S2 (L2(X;µ)) ≅L2 (X × X;µ × µ)
(B.65)
(where S2 are the Hilbert-Schmidt operators) one might imagine a map diag that extracts
the diagonal of an operator ρ ∈S1 (L2 (X;µ)) by diag ρ(x) = ρ(x,x). This does not work
since the actual values of ρ are completely arbitrary on the diagonal. However, there is a
useful map which does correspond to this naive notion. By singular-value decomposition,
any ρ ∈S1 (L2 (X;µ)) can be written as the countable sum ∑j σjfj ⊗g∗
j for ⟨σj⟩∈ℓ∞+ and
some unit length {fj,gj} ⊂L2 (X;µ). There is a measure ν associated to ρ, clearly absolutely
continuous with respect to µ, given by for any µ-measurable subset B ⊂X,
ν(B) = tr PBρ = ∫B ∑
j
fjgj dµ
where PB is the orthogonal projector associated to the subspace of L2 (X;µ) that is zero
(almost everywhere with respect to µ) outside B. Then we have:
Deﬁnition B5.17
Let the map diag: S1 (L2 (X;µ)) →L1 (X;µ) be deﬁned by the Radon-
Nikod´ym derivative
diag ρ = dν
dµ
The diagonal extraction map is clearly linear and positive.
We also have the following
properties:
Proposition B5.18
The diagonal extraction map has operator norm one. Furthermore,
on the equivalence classes S1 (L2 (X;µ))/ker diag, it is an isometric bijection.

APPENDIX B. PROPOSITIONS FOR OPTION I
152
Proof
Using the singular-value-decomposition form for the trace-class operator ρ as above,
∥diag ρ∥= ∫X ∣∑
j
σjfjgj∣dµ
≤∑
j
σj ∫X ∣fjgj∣dµ
(B.66)
using the triangle inequality and the Dominated Convergence theorem. Using the Cauchy-
Schwartz inequality, this is less than or equal to
∑
j
σj∥fj∥∥gj∥= ∑
j
σj = ∥ρ∥trace
(B.67)
Since ρ was arbitrary, ∥diag∥op ≤1. It is equal to one since diag is clearly an isometry on the
positive cone D (L2(X;µ))+.
If the σ-algebra for X were generated by countably many atomic subsets, it is easy
to see that diag is an isometric bijection–one simply notes the diagonal operator whose
diagonal agrees with the diagonal of ρ is in the same equivalence class and that for this
particular operator, the map clearly preserves the norm. However, in general, there are
no diagonal, trace-class operators on L2 (X;µ), so we need to work a little harder.
Let
s ∈L∞(X;(diag ρ)µ) be the phase valued “function” given by
s = diag ρ
∣diag ρ∣
(B.68)
(it can be left undeﬁned where diag ρ is zero). Then the trace-class operator ξ = s√diag ρ ⊗
√diag ρ has the same trace as ρ; hence, it is in the same equivalence class. Therefore,
∥[ρ]∥= inf
ˆρ∈[ρ]∥ˆρ∥trace ≤∥ξ∥trace = ∥diag ρ∥
(B.69)
which by the above result is less than or equal to
inf
ˆρ∈[ρ]∥ˆρ∥trace
(B.70)
Hence, ∥[ρ]∥= ∥diag ρ∥. Since ρ was arbitrary, diag is an isometry. It is surjective since for
any “function” f ∈L1 (X;µ), deﬁning s similarly to above,
s = f
∣f∣
(B.71)
(it can be left undeﬁned where f is zero), then the trace-class operator ξ = s√f ⊗√f has
diag ξ = f. ◻
Proposition B5.19
Both the diagonal extraction map diag and its inverse diag−1 ∶L1 (X;µ) →
S1 (L2 (X;µ))/ker diag are completely-positive.

APPENDIX B. PROPOSITIONS FOR OPTION I
153
Proof
By the spectral theorem for compact operators, it is enough to demonstrate posi-
tivity for diag ⊗IMn acting on rank-one density matrices. Furthermore, since ﬁnite-tensor
rank vectors are dense, it is enough show that
∫E ⟨(diag ⊗IMn)(
m
∑
j=1
fj ⊗aj
m
∑
k=1
f ∗
k ⊗a∗
j)b,b⟩dµ ≥0
(B.72)
for any m,n ∈Z+, any {aj} ⊂Cn, any b ∈Cn, any {fj} ⊂L2 (X;µ), and any µ-measurable
subset E ⊂X. However, the left-hand side is equal to ∫E ∣g∣2 dµ, where g = ∑m
j=1⟨aj,b⟩fj,
which is clearly greater than or equal to zero.
Firstly, note diag−1 ⊗IMn is well-deﬁned since
S1 (L2 (X;µ) ⊗Cn)/ker (diag ⊗IMn) = (S1 (L2 (X;µ))/ker diag)) ⊗Mn
(B.73)
Furthermore, by A1.3, diag−1 ⊗IL1(Y;ν;S1(H)) is well-deﬁned for any Y,ν,H since
(S1 (L2 (X;µ))/ker diag)) ⊗L1(Y;ν;S1(H))
(B.74)
is norm-dense in
S1 (L2 (X × Y;µ × ν) ⊗H)/ker (diag ⊗IL1(Y;ν;S1(H)))
(B.75)
(This will be needed in further propositions below.)
A notion of positivity is provided
on (S1 (L2 (X;µ))/ker diag)) ⊗Mn by taking equivalence classes with positive members
to be positive; this is equivalent to α being positive if tr βα ≥0 for any positive β ∈
W(X;µ;Cn)+ = diag ∗L∞(X;µ)+ ⊗D(Cn)+ (W is deﬁned below in B5.21, diag ∗is deﬁned
following this proof). Any such positive β can be written as γ∗γ for some γ ∈W(X;µ;Cn) =
diag ∗L∞(X;µ)+ ⊗B(Cn).
Using the preceding, together with the deﬁnition of Bochner integrability for L1(X;µ;D(Cn))
and the (ﬁnite dimensional) spectral theorem, to show diag−1 is completely positive we need
to show
tr (γ∗γ(diag−1 ⊗IMn)1Baa∗) ≥0
(B.76)
for any µ-measurable subset B ⊂X, a ∈Cn, and γ ∈diag ∗L∞(X;µ)+ ⊗B(Cn). Writing γ as
∑n
i,j=1 fijeie∗
j for {ej} an orthonormal basis for Cn and fij ∈L∞(X;µ), the left-hand side is
n
∑
i,j,k=1
akai ∫B fjifjk dµ =
n
∑
j=1
akai ∫B gjgj dµ
(B.77)
where ak = ⟨a,ek⟩and gj = ∑n
k=1 akfjk. This is clearly positive. ◻

APPENDIX B. PROPOSITIONS FOR OPTION I
154
Comment
Using B5.18 with standard results for Banach spaces then gives the following
bijection:
diag∗∶L∞(X;µ) →image diag∗⊂B (L2 (X;µ))
(B.78)
Note diag∗(f)g is the pointwise multiplication fg for f ∈L∞(X;µ) and g ∈L2 (X;µ). Then
diag* is clearly isometric and is a representation (clearly weak* continuous) of the von Neu-
mann algebra17 L∞(X;µ) (with product given by pointwise multiplication of “functions”)
as operators in B (L2 (X;µ)).
Morally, one would hope for L1 (X;µ;S1(H))∗to be L∞(X;µ;B(H)), which is a C*-
algebra. That is almost correct, as the following proposition indicates.
Lemma B5.20
For any Ψ ∈L1 (X;µ;S1(H))∗,
∥Ψ∥op = sup{
1
µ(B)Ψ(1Bψξ∗)∣µ-measurable B ⊂X
unit length ψ,ξ ∈H
}
Proof
By the deﬁnition of the Bochner integrability for L1 (X;µ;S1(H)), it is enough to
take the supremum over simple, S1(H)-valued functions:
∥Ψ∥op = sup
⎧⎪⎪⎪⎪⎪⎨⎪⎪⎪⎪⎪⎩
Ψ(∑j tj1Bjϕj)
∑j tjµ(Bj)
RRRRRRRRRRRRRRRRRR
µ-measurable, disjoint {Bj}
{ϕj} ⊂S1(H)
each with unit trace-norm
{tj} ⊂R+ ∪{0}
⎫⎪⎪⎪⎪⎪⎬⎪⎪⎪⎪⎪⎭
(B.79)
For ﬁxed {Bj} and {ϕj}, the expression the supremum is being taken over is rational linear
in {tj}; hence it is necessarily maximized when all but one value of tj are zero. Therefore,
it is only necessary to take the supremum over S1(H)-valued functions of the form
1
µ(B)1Bϕ
for µ-measurable B ⊂X and unit-trace-norm ϕ ∈S1(H). By a similar argument applied to
the singular-value decomposition of ϕ, it is further only necessary to take ϕ rank-one. ◻
Proposition B5.21
There is a well-deﬁned, completely-positive, surjective map with op-
erator norm one
diag ⊗IB(H) ∶S1 (L2(X;µ) ⊗H) →L1 (X;µ;S1(H))
which is an isometry on the positive cone. This map gives rise to the isometric bijections
diag ⊗IB(H) ∶S1 (L2 (X;µ) ⊗H)/ker (diag ⊗IB(H)) →L1 (X;µ;S1(H))
(diag ⊗IB(H))∗∶L1 (X;µ;S1(H))∗→image (diag ⊗IB(H))∗= W(X;µ;H) ⊂B (L2 (X;µ) ⊗H)
17A Banach algebra is a Banach space equipped with an associative, distributive product satisfying ∥ab∥≤
∥a∥∥b∥. A *-algebra is a Banach algebra with an antilinear involution. A C*-algebra is a *-algebra where
∥a∗a∥= ∥a∥2. A von Neumann algebra (also termed a W*-algebra) is a C*-algebra which, as a Banach space,
is a dual space.

APPENDIX B. PROPOSITIONS FOR OPTION I
155
Proof
Using B4.2, S1 (L2 (X;µ)) ⊗S1 (H) is trace-norm dense in S1 (L2 (X;µ) ⊗H). By
the deﬁnition of Bochner integrability, L1 (X;µ;S1(H)) is the norm completion of L1 (X;µ)⊗
S1(H). Hence, diag ⊗IB(H) is a well-deﬁned map for the given domain and range by A1.3.
It has operator norm one by A1.3, B5.19, B5.18, and B5.5. It is completely positive by
B5.18 and B5.8. By the deﬁnition of Bochner integrability, the simple functions of the
form ∑j 1Bjϕj for disjoint, µ-measurable subsets {Bj} and {ϕj} ⊂S1(H) are norm-dense
in L1 (X;µ;S1(H)). These have preimages in S1 (L2 (X;µ) ⊗H) given by ∑j (1Bj ⊗1Bj)ϕj.
Since diag ⊗IB(H) is bounded (hence, continuous), it is surjective. To see that it is isometric
on the positive cone D (L2 (X;µ) ⊗H)+, by the spectral theorem for compact operators, it is
only necessary to check the rank-one case. By continuity and the deﬁnition of L2 (X;µ)⊗H,
it is only necessary to check the case where the vectors are of ﬁnite-tensor-rank, ∑m
j=1 fj ⊗ξj
for {fj} ⊂L2 (X;µ) and {ξj} ⊂H. Then,
∥
m
∑
j=1
fj ⊗ξj
m
∑
k=1
f ∗
k ⊗ξ∗
k∥
trace
= tr
m
∑
j=1
fj ⊗ξj
m
∑
k=1
f ∗
k ⊗ξ∗
k =
m
∑
j,k=1∫X fjfk dµ⟨ξj,ξk⟩
= ∥(diag ⊗IB(H))(
m
∑
j=1
fj ⊗ξj
m
∑
k=1
f ∗
k ⊗ξ∗
k)∥
(B.80)
so diag ⊗IB(H) is indeed isometric on the positive cone.
By the preceding results, the map
diag ⊗IB(H) ∶S1 (L2 (X;µ) ⊗H)/ker (diag ⊗IB(H)) →L1 (X;µ;S1(H))
(B.81)
is certainly a bijection. From the dense set of values considered above to establish surjectivity,
it is isometric. By standard properties of Banach spaces, the adjoint map
(diag ⊗IB(H))∗∶L1 (X;µ;S1(H))∗→image (diag ⊗IB(H))∗= W(X;µ;H) ⊂B (L2 (X;µ) ⊗H)
(B.82)
is a bijection. To see it is an isometry, take any Ψ ∈L1 (X;µ;S1(H))∗. By the deﬁnition of
operator norm and the Cauchy-Schwartz inequality, there is the well-known formula for the
operator norm in B(J) for any Hilbert space J,
∥β∥op =
sup
x, y ∈J
∥x∥≤1, ∥y∥≤1
⟨βx,y⟩
(B.83)
Using this, we have
∥(diag ⊗IB(H))∗Ψ∥op =
sup
ζ, η ∈L2 (X; µ) ⊗H
∥ζ∥≤1, ∥η∥≤1
⟨(diag ⊗IB(H))∗Ψζ,η⟩
=
sup
ζ, ζ ∈L2 (X; µ) ⊗H
∥ζ∥≤1, ∥η∥≤1
Ψ((diag ⊗IB(H))(ζη∗))
(B.84)
By the preceding lemma B5.20, this is certainly ∥Ψ∥op, since we only have to consider ζ
and η of the form 1B ⊗ψ and 1B ⊗ξ respectively, for µ-measurable B ⊂X and unit-length
ψ,ξ ∈H, to get ∥Ψ∥op. ◻

APPENDIX B. PROPOSITIONS FOR OPTION I
156
Proposition B5.22
The Banach space W(X;µ;H) ⊂B (L2 (X;µ) ⊗H) deﬁned in the pre-
ceding proposition is a von Neumann algebra.
Proof
By standard properties of Banach spaces, W(X;µ;H) is precisely composed of those
elements that annihilate the kernel of diag⊗IB(H); in other words, those φ ∈B (L2(X;µ) ⊗H)
such that tr ϕα = 0 for any α in the kernel. Now take any f ∈L∞(X;µ) and consider the
operator γ = diag∗f ⊗IH. By using singular-value-decomposition (as in the deﬁnition of the
diag map in B5.17) together with approximating each resulting vector by a ﬁnite-tensor-rank
approximation and taking the limit as the approximations become better, it can be shown
that, operating on the left or the right, the kernel is invariant under the action of γ. Take any
β ∈S1 (L2(X;µ) ⊗H). By a similar argument, it can be shown that diag⊗IB(H)(γβ−βγ) = 0;
hence,
0 = tr ϕ(γβ −βγ) = tr β(ϕγ −γϕ)
(B.85)
using the linear and cyclic properties of the trace. Since β was arbitrary, it must be that ϕ
commutes with γ; since f in the deﬁnition of γ was arbitrary, ϕ must be in the commutant18
of {diag∗L∞(X;µ) ⊗IH}.
Now suppose ϕ is in the commutant of diag∗L∞(X;µ)⊗IH. Now we will consider a certain
norm-dense subset of S1 (L2 (X;µ) ⊗H): ﬁrstly note S1 (L2 (X;µ)) ⊗S1 (H) is norm-dense.
Using S1 (L2 (X;µ)) ⊂S2 (L2 (X;µ)) ≅L2(X × X;µ × µ), we can consider S1 (L2 (X;µ)) as a
space of “functions” on X × X. Using Cartesian decomposition and the spectral theorem for
compact operators (or singular value decomposition), truncating the spectral decomposition,
then approximating each of the vectors in L2(X;µ)-norm by simple functions, and then
putting everything back together with the proper intersections and relative complements of
subsets of X, the overall eﬀect is to get something in the following subset:
A =
⎧⎪⎪⎪⎨⎪⎪⎪⎩
S1 (H)-valued, simple functions with rectangular
subsets A × B for A,B in the ﬁnite, disjoint
collection {C1,...,Cm} of µ-measurable subsets of X
⎫⎪⎪⎪⎬⎪⎪⎪⎭
(B.86)
Therefore, the preceding subset is norm-dense.
Now let us consider the subset A0 ⊂A which is composed of those S1 (H)-valued, simple
functions that are zero on all the rectangular subsets that include the diagonal; in other
words, those that assign zero to each subset of the form A × A. Then A0 is norm-dense
within the kernel of diag ⊗IB(H). To see this, take any α in the kernel and let ⟨aj⟩be a
sequence of elements of A converging in norm to it. Each aj can be written as bj + cj, where
bj ∈A0 and cj is zero everywhere except for the subsets of the form A×A. It is easy to see that
∥cj∥trace = ∥diag ⊗IB(H)cj∥. Since α is in the kernel, it must be that limj→∞diag ⊗IB(H)cj = 0;
hence, limj→∞∥cj∥trace = 0, so ⟨bj⟩converges in norm to α. Since α was arbitrary, A0 is
indeed norm-dense in the kernel.
18The commutant of a subset of an algebra is composed of all elements of the algebra that commute with
the subset.

APPENDIX B. PROPOSITIONS FOR OPTION I
157
Now again take any α in the kernel and let ⟨bj⟩be a sequence of elements of A0 converging
in norm to it. For each j, by the deﬁnition of A, there is some associated ﬁnite, disjoint
collection {Cj
1,...,Cj
mj} of µ-measurable subsets of X; take fj to be any function that takes
distinct values on each subset: say fj = ∑
mj
k=1 k 1Cj
k for instance. Then bj can be written as
(diag*fj ⊗IB(H))dj −dj (diag*fj ⊗IB(H))
(B.87)
for a certain, unique dj ∈A0. Hence, tr ϕbj = 0 for every j, so, by continuity, tr ϕα = 0. Since
α was arbitrary, ϕ must be in the annihilator of the kernel; hence, it is in W(X;µ;H).
The subset diag∗L∞(X;µ) ⊗IH is itself the commutant of the C∗-algebra given by the
closure in norm of diag∗L∞(X;µ)⊗B(H), which is (since simple “functions” are norm-dense
in L∞(X;µ)) given by (diag ⊗IB(H))∗L∞(X;µ;B(H)). Since W(X;µ;H) is the bicommu-
tant19 of a C*-algebra, it is is a von Neumann algebra by von Neumann’s bicommutant
theorem [110]. ◻
Comment
Using the isometric bijections in B5.20, this induces an algebraic structure on
L1 (X;µ;S1(H)). The identity operator in W(X;µ;H) corresponds to the linear functional
Φ which agrees with the norm on elements in the positive cone L1 (X;µ;D(H))+,
Φρ = ∫X tr ρdµ
(B.88)
where the trace acts pointwise.
Proposition B5.23
The subspace ker (diag ⊗IB(H)) is invariant under either left or right
product with elements of W(X;µ;H).
Proof
Take any α in the kernel, ϕ in W(X;µ;H), µ-measurable subset E ⊂X, and ψ,χ ∈
H. Then, for PE = diag∗1E the orthogonal projector in B(L2(X;µ)) to the subspace of
“functions” zero almost everywhere outside of E,
∫E⟨((diag ⊗IB(H))αϕ)ψ,χ⟩dµ = tr (PE ⊗ψχ∗)αϕ = tr α′ϕ = 0
(B.89)
where α′ = (PE ⊗ψχ∗)α is still in the kernel (as is readily seen by using singular value
decomposition on α as in the deﬁnition of diag in B5.17). Since E,ψ,χ were arbitrary, it
must be that (diag⊗IB(H))αϕ = 0; hence, αϕ is still in the kernel. Similarly, using the cyclic
property of the trace,
∫E⟨((diag ⊗IB(H))ϕα)ψ,χ⟩dµ = tr (PE ⊗ψχ∗)ϕα = tr α′′ϕ = 0
(B.90)
where α′′ = α(PE ⊗ψχ∗) is still in the kernel. Since E,ψ,χ were arbitrary, it must be that
(diag ⊗IB(H))ϕα = 0; hence, ϕα is still in the kernel. ◻
19The bicommutant is the commutant of the commutant.

APPENDIX B. PROPOSITIONS FOR OPTION I
158
Alternate proof
Note W(X;µ;H) separates the elements of S1 (L2 (X;µ) ⊗H)/ker (diag⊗
IB(H)). To see this, take any α ∈S1 (L2 (X;µ) ⊗H). Then, by the deﬁnition of Bochner in-
tegrability, (diag ⊗IB(H))α can be arbitrarily well approximated in L1(X;µ;S1(H))-norm
by simple, S1(H)-valued functions, ∑j 1Bjρj, where {Bj} is a ﬁnite, disjoint collection of
µ-measurable subsets of X. Use singular value decomposition to write each ρj as UjΣjV ∗
j ,
where Σj is a trace-class, diagonal operator in B(ℓ2) (or Cdim H if dimH is ﬁnite) and Uj,Vj are
partial isometries from ℓ2 (or Cdim H if dimH is ﬁnite) to H. Then, β = ∑j(diag∗1Bj)⊗VjU ∗
j ∈
W(X;µ;H) has the property that
tr β(diag ⊗IB(H))−1 ∑
j
1Bjρj = ∥∑
j
1Bjρj∥
(B.91)
Hence, by taking the approximation suﬃciently close, there is some such β such that tr βα
is arbitrarily close to ∥α∥. (Note the Hahn-Banach theorem gives this result more easily, but
it relies on the Axiom of Choice.)
Using this, ker (diag ⊗IB(H)) can be characterized as
{α ∈S1 (L2 (X;µ) ⊗H)∣tr βα = 0 for all β ∈W(X;µ;H)}
(B.92)
Take any α ∈ker (diag ⊗IB(H)). For any ﬁxed β ∈W(X;µ;H), we then have tr γβα = 0
for all γ ∈W(X;µ;H); hence, βα ∈ker (diag ⊗IB(H)). Also, 0 = tr βγα = tr γαβ for all
γ ∈W(X;µ;H); hence, αβ ∈ker (diag ⊗IB(H)). ◻
Comment
Now given any bounded, linear map L ∶L1(X;µ;D(H))+ →L1(Y;ν;D(J)),
we can extend it to L ∶L1(X;µ;S1(H)) →L1(Y;ν;S1(J)) using B5.15. We then have the
following two linear maps:
˜L ∶S1 (L2 (X;µ) ⊗H)/ker (diag ⊗IB(H)) →S1 (L2 (Y;ν) ⊗J)/ker (diag ⊗IB(J))
(B.93)
˜L∗∶W(Y;ν;J) →W(X;µ;H)
(B.94)
given by
˜L = (diagL2(X;µ) ⊗IB(J))−1 ○L ○(diagL2(X;µ) ⊗IB(H))
(B.95)
˜L∗= (diagL2(X;µ) ⊗IB(H))∗○L∗○(diagL2(X;µ) ⊗IB(J))−1∗
(B.96)
Proposition B5.24
Given a bounded, completely-positive, linear map L ∶L1(X;µ;D(H))+ →
L1(Y;ν;D(J))+, the resulting ˜L, ˜L∗are completely-positive in the sense of Stinespring’s the-
orem [118]:
∑
i,k
tr α∗
kαi ˜L(ψiψ∗
k) ≥0 ⇐⇒∑
i,k
⟨˜L∗(α∗
kαi)ψj,ψi⟩≥0
for all ﬁnite collections {αk} ⊂W(Y;ν;J) and {ψk} ⊂L2(X;µ) ⊗H.

APPENDIX B. PROPOSITIONS FOR OPTION I
159
Proof
The two expressions are related by duality, do it is only necessary to prove the left-
hand one. The map ˜L is the composition of completely-positive maps; hence, it is completely-
positive. Therefore, for any ﬁnite whole number n, ˜L⊗IMn is completely positive, so for any
β ∈W(Y;ν;J ⊗Cn) and ϕ ∈L2(X;µ) ⊗H ⊗Cn,
tr β∗β(˜L ⊗IMn)(ϕϕ∗) ≥0
(B.97)
For {ej} an orthonormal basis for Cn, write β as ∑n
i,j=1 αijeie∗
j for αij ∈W(Y;ν;J) and ϕ as
∑n
j=1 ψjej for ψj ∈L2(X;µ) ⊗H. Then we have
n
∑
i,j,k=1
tr ∗α∗
jkαji ˜L(ψiψ∗
k) ≥0
(B.98)
If the αij are chosen to be independent of j, this gives the desired result. ◻
Comment
Following the proof of Stinespring’s theorem, deﬁne the positive, bilinear form
⟨⋅,⋅⟩Stinespring on W(Y;ν;J) ⊗L2(X;µ) ⊗H by
⟨∑
j
αj ⊗ψj,∑
k
βk ⊗ϕk⟩
Stinespring
= ∑
j,k
⟨˜L∗(β∗
kαj)ψj,ϕk⟩= ∑
j,k
tr β∗
kαj ˜L(ψjϕ∗
k)
(B.99)
Let N be the null subspace {α ∈W(Y;ν;J) ⊗L2(X;µ) ⊗H∣⟨α,α⟩Stinespring = 0}. Take any
α ∈N and β ∈W(Y;ν;J)⊗L2(X;µ)⊗H; by considering ⟨α+tβ,α+tβ⟩Stinespring and ⟨α+ıtβ,α+
ıtβ⟩Stinespring for small, real t, from the positivity of ⟨⋅,⋅⟩Stinespring, it is evident ⟨α,β⟩Stinespring =
0. Then ⟨⋅,⋅⟩Stinespring is an inner product on W(Y;ν;J) ⊗L2(X;µ) ⊗H/N; this space can be
completed to give a Hilbert space K.
From the proof of Stinespring’s theorem, N is invariant under the left action of β ⊗
IL2(X;µ)⊗H for any β ∈W(Y;ν;J). This then induces a representation of the von Neumann
algebra, ζ ∶W(Y;ν;J) →B(K). The representation is readily seen to be a *-representation20.
Proposition B5.25
The representation ζ has operator norm less than or equal to one and
is weak* continuous with pre-adjoint ζ∗∶S1(K) →S1 (L2 (X;µ) ⊗H)/ker (diag⊗IB(H)) being
isometric on the positive cone.
Proof
By the deﬁnition of operator norm and the Cauchy-Schwartz inequality, there is the
well-known formula for the operator norm in B(J) for any Hilbert space M,
∥β∥op =
sup
x, y ∈M
∥x∥≤1, ∥y∥≤1
⟨βx,y⟩
(B.100)
20A representation ζ of a C*-algebra is a *-representation if ζ(α∗) = ζ(α)∗for any α.

APPENDIX B. PROPOSITIONS FOR OPTION I
160
Using this and the norm-density of W(Y;ν;J) ⊗L2(X;µ) ⊗H/N in K, we have, for any
α ∈W(Y;ν;J), ∥ζ(α)∥op is given by
sup
⎧⎪⎪⎨⎪⎪⎩
⟨∑
j
αβj ⊗ψj,∑
k
γk ⊗ξk⟩
Stinespring
∣∑j βj ⊗ψj,∑k γk ⊗ξk ∈W(Y;ν;J) ⊗L2(X;µ) ⊗H
with unit length using the Stinespring-norm
⎫⎪⎪⎬⎪⎪⎭
(B.101)
Absorbing α into a redeﬁnition of each βj, by the Cauchy-Schwartz inequality, this is less
than or equal to ∥α∥op. Hence, ζ has operator-norm less than or equal to one.
To see ζ is weak* continuous, take any β ∈W(Y;ν;J) and rank-one ψϕ∗∈S1(K), where
both ψ and ϕ are in the norm-dense subset W(Y;ν;J) ⊗L2(X;µ) ⊗H/N. Let ˆψ ∈ψ be
written ∑j αj ⊗ξj and ˆϕ ∈ϕ be written ∑j γj ⊗ηj. Then
tr ζ(β)ψϕ∗= ⟨β ⊗IL2(X;µ)⊗H ˆψ, ˆϕ⟩Stinespring = ∑
j,k
⟨˜L∗(γ∗
kβαj)ξj,ηk⟩
= ∑
j,k
tr γ∗
kβαj ˜L(ξjη∗
k) = tr βζ∗(ψϕ∗)
(B.102)
where ζ∗(ψϕ∗) = ∑j,k αj ˜L(ξjη∗
k)γ∗
k. Note ζ∗(ψψ∗) is positive since, for any β ∈W(Y;ν;J),
∑
j,k
tr β∗βαj ˜L(ξjξ∗
k)α∗
k ≥0
(B.103)
using the cyclic property of the trace and B5.23. Then,
∥ζ∗(ψψ∗)∥= tr ζ∗(ψψ∗) = ∥ψ∥2
(B.104)
Hence, ζ∗is bounded with operator norm less than or equal to two on rank-one operators
with vectors in W(Y;ν;J) ⊗L2(X;µ) ⊗H/N. Using A1.3, by continuity it extends to rank-
one vectors with the same bound. By linearity, it extends to ﬁnite rank operators. Using
the spectral theorem, it is still isometric on the positive cone; hence, it has operator norm
less than or equal to two. By A1.3, it extends to all operators in S1(K) while still being
isometric on the positive cone and with operator norm less than or equal to two. Since
ζ = ζ∗
∗, ζ∗actually has operator norm less than or equal to one. ◻
Proposition B5.26
There is a Hilbert space M and a partial isometry E ∶K →L2 (X;µ)⊗
H⊗M such that the representation ζ is given by ζ(α) = E∗(α⊗IM)E for any α ∈W(Y;ν;J).
The partial isometry E is such that the orthogonal projector EE∗commutes with all {α⊗IM}.
If all the Hilbert spaces L2 (X;µ), H, L2 (Y;ν), and J have ﬁnite dimension, then M can be
taken to be J ⊗dimL2 (X;µ) ⊗H.
Proof
From a result by Sakai [109], since ζ is a weak*-continuous, *-representation21 by the
preceding proposition, ζ is given by the composition of an ampliﬁcation with an induction:
21Termed a W∗-representation by Sakai.

APPENDIX B. PROPOSITIONS FOR OPTION I
161
there exists a Hilbert space M and a bounded, linear map E ∶K →L2 (Y;ν) ⊗JM such
that ζ(α) = E∗(α ⊗IM)E, EE∗is an orthogonal projector commuting with all {α ⊗IM},
EE∗E = E, and E∗EE∗= E∗. Then ζ∗is given by, for any β ∈S1(K), ζ∗β = tr MEβE∗,
where tr M is the partial trace over M. Since, by the preceding proposition, ζ∗is an isometry
on the positive cone, it must be that E∗E = IK, so E is a partial isometry. Unfortunately,
the proof given by Sakai is non-constructive; the only limitation on the dimension of M is
that it need not be larger than dimK.
If all the Hilbert spaces have ﬁnite dimension, we can be far more concrete in the construc-
tion. Let M = J⊗dimL2 (X;µ)⊗H. Since the Hilbert spaces have ﬁnite dimension, W(Y;ν;J)
is isomorphic to L∞(Y;ν) ⊗B(J), which is isomorphic to the Hilbert space L2 (Y;ν) ⊗J ⊗J
using L∞(Y;ν) ≅L2 (Y;ν) and22 B(J) ≅J ⊗J. Then, using this isomorphism, N maps
to a subspace N ′ of the Hilbert space L2 (Y;ν) ⊗J ⊗M.
Also, then K is isomorphic to
L2 (Y;ν) ⊗J ⊗M/N ′ ≅N ′⊥with no need for completion. Let E ∶K →N ′ be this isomor-
phism. Then the operators α ⊗IL2(X;µ)⊗H acting on W(Y;ν;J) ⊗L2 (X;µ) ⊗H give rise to
a representation α ⊗IM on L2 (Y;ν) ⊗J ⊗M. From the proof to Stinespring’s theorem, N ′
is invariant under all the {α ⊗IM}, so the orthogonal projector PN ′⊥commutes with all the
{α ⊗IM}.
Any point in the space L2 (Y;ν) ⊗J ⊗M can be uniquely written as n + m for n ∈N ′ and
m ∈N ′⊥. Now put a new inner-product on the space, ⟨⋅,⋅⟩new, deﬁned by
⟨m + n,m′ + n′⟩new = ⟨E−1(m),E−1(m′)⟩Stinespring + ⟨n,n′⟩
(B.105)
(This is the step that requires all the spaces to be ﬁnite–the use of ﬁniteness in the preceding
steps is not essential.) With respect to this new inner product, E is a partial isometry. Let
E∗be the adjoint map with respect to the new inner product. Then the representation ζ on
K is provided by, for any k ∈K,
ζ(α)(k) = (E−1 ○PN ′⊥)(α ⊗IM)E(k) = (E∗(α ⊗IM)E)(k)
(B.106)
Hence, ζ(α) = E∗(α ⊗IM)E. ◻
Proposition B5.27
Any completely-positive map L ∈CP(L1(X;µ;D(H)),L1(Y;ν;D(J)))
can be expressed as
Lρ = (diagL2(Y;ν) ⊗IB(J) ⊗tr M)V ((diagL2(X;µ) ⊗IB(H))−1ρ)V ∗
for some Hilbert space M and some linear operator V ∈B(L2 (X;µ) ⊗H,L2 (Y;ν) ⊗J ⊗M).
If L is an isometry on the positive cone, then V is a partial isometry. If all the Hilbert
spaces L2 (X;µ), H, L2 (Y;ν), and J have ﬁnite dimension, then M can be taken to be
J ⊗dimL2 (X;µ) ⊗H.
22Using Mn ≅Cn ⊗Cn, say by using the Vec operation that stacks columns.

APPENDIX B. PROPOSITIONS FOR OPTION I
162
Proof
By B.16, L extends uniquely to a map in ∈CP(L1(X;µ;S1(H)),L1(Y;ν;S1(J)). By
B.24, the resulting ˜L∗(deﬁned in the comment preceding B.24) is completely-positive in
the sense of Stinespring’s theorem. Also, the von Neumann algebra W(Y;ν;J) (see B5.21,
B5.22) of course contains the identity. Hence, by Stinespring’s theorem, ˜L∗can be expressed
as, for any α ∈W(Y;ν;J), ˜L∗α = W ∗ζ(α)W for some W ∈B(L2 (X;µ) ⊗H,K) (where the
Hilbert space K and the representation ζ are deﬁned in the comment preceding B.25). By
the preceding proposition, ζ(α) = E∗(α ⊗IM)E for some Hilbert space M and some partial
isometry E ∶K,L2 (Y;ν) ⊗J). Also, if all the Hilbert spaces L2 (X;µ), H, L2 (Y;ν), and J
have ﬁnite dimension, then M can be taken to be J ⊗dimL2 (X;µ) ⊗H.
Let V = EW; then ˜L∗α = V ∗(α ⊗IM)V , so ˜Lβ = trM(V βV ∗) for any β ∈S1(L2 (X;µ) ⊗
H)/ker (diagL2(X;µ) ⊗IB(H)). (As a check, if γ ∈ker (diagL2(X;µ) ⊗IB(H)), then trM(V γV ∗) is
indeed in ker (diagL2(Y;ν) ⊗IB(J)) by the alternate proof to B5.23 since tr (α⊗IM)V γV ∗= 0
for every α ∈W(Y;ν;J).) Writing ˜L in terms of L then gives the desired form for L.
If L is isometric on the positive cone, then ˜L is isometric on the positive cone; hence, for
any β ∈D(L2 (X;µ) ⊗H)+,
tr β = tr ˜Lβ = tr V βV ∗= tr βV ∗V
(B.107)
Therefore, it must be that V ∗V = IB(L2(X;µ)⊗H); hence, it is a partial isometry. ◻
Proposition B5.28
Any linear, positive map L ∈B(L1(X;µ),D(L2(X;µ))) satisfying
diag ○L = IB(L1(X;µ)) has image in the diagonal operators (see B4.3).
Proof
By the deﬁnition of the diagonal extraction map, diag, we have
1B ⋅diagρ = diag(PBρPB)
(B.108)
for any µ-measurable B ∈X with ﬁnite mu-measure, where PB is the orthogonal projector
to the subspace of “functions” zero almost everywhere outside B. Take any “function” f ∈
L2(X;µ). Then,
diag PBL(1∼Bf)PB = 1B ⋅diag ○L(1∼Bf = 1B1∼Bf = 0
(B.109)
The operator PBL(1∼Bf)PB is clearly positive; by the isometry of diag on the positive cone
(see B5.18), it must be the zero operator. Hence, ⟨L(1∼Bf)1C,1C⟩= 0 for any µ-measurable
C ⊂B
Now take any µ-measurable, ﬁnite µ-measure B′ disjoint from B. By positivity, for any
a ∈R,
⟨L(1∼Bf)(a1C −1B′),a1C −1B′⟩≥0
(B.110)
For this to hold for all a, no matter how large, it must be that
⟨L(1∼Bf)1C,1B′⟩= ⟨L(1∼Bf)1B′,1C⟩= 0
(B.111)

APPENDIX B. PROPOSITIONS FOR OPTION I
163
Similarly, since B′ ⊂∼B and C is disjoint from ∼B,
⟨L(1Bf)1C,1B′⟩= 0
(B.112)
Then
0 = ⟨L(1∼Bf)1C,1B′⟩+ ⟨L(1Bf)1C,1B′⟩= ⟨L(f)1C,1B′⟩
(B.113)
Taking C = B, we get ⟨L(f)1B,1B′⟩= 0. Since B,B′ were arbitrary, Lf is diagonal. ◻
B.6
Vector measures
Notation
The spaces of ﬁnite-norm, vector measures on the given set with the given σ-
algebra will be denoted M(X;E;A), M(Y;F;B),.... These are Banach spaces using the
total variation norm (give reference). The subset of these that is atomic will be denoted
A(X;E;A),....
Proposition B6.1
The subset A(X;E;B) is a closed, linear subspace of the Banach space
M(X;E;B) (hence, it is itself a Banach space).
Proof
The subset A(X;E;B) is clearly a linear subspace. To show it is closed, take any
µ in the complement of A(X;E;B). Suppose that for any ε > 0 there were some countable
collection of atoms {Aε
j} ⊂E such that ∥µ(X ∖⋃j Aε
j)∥< ε. Then the countable union
B =
⋃
ε∈{1,2−1,2−3,...}
⋃
j
Aε
j
(B.114)
would satisfy ∥µ(X ∖B)∥= 0, which contradicts µ being in the complement. Hence, there
is some ε > 0 such that, for any countable collection of atoms {Aj} ⊂E, ∥µ(X ∖⋃j Aj)∥> ε.
Consequently, the distance from µ to A(X;E;B) is greater than ε. Since µ was arbitrary,
the complement of A(X;E;B) is open; hence, A(X;E;B) is closed. ◻
Proposition B6.2
If the Banach spaces A, B, and C are such that A ⊗B is norm-dense in
C, then A(X;E;A) ⊗A(Y;F;B) is norm-dense in A(X × Y;G;C), where G = σ(E × F) is the
σ-algebra generated by the rectangular subsets E × F.
Proof
The atoms of G are in the rectangular subsets E ×F. Therefore, any vector measure
in A(X ×Y;G;C) can be arbitrarily well-approximated in norm by vector measures in A(X ×
Y;G;C) of the form ∑j cjδEj ×δFj for ﬁnite collections of atoms {Ej} ⊂E and {Fj} ⊂F and a
ﬁnite collection {cj} ⊂C. By assumption, each c ∈C can be arbitrarily well-approximated in
norm by elements in A⊗B. Hence, A(X;E;A)⊗A(Y;F;B) is norm-dense in A(X ×Y;G;C).
◻

164
Appendix C
Propositions for option II
Notation
All topological spaces X,Y,... are compact and Hausdorﬀ.
C(X), C(Y),...
are the spaces of real-valued, continuous functions, which are Banach space employing the
maximum norm. All partitions of unity will be assumed composed of continuous functions.
Hilbert spaces, denoted H, J,... are complete, sesquilinear inner-product spaces, with no
restriction as to their dimension or separability. K(H), K(J),... denote the spaces of com-
pact1, self-adjoint operators on the speciﬁed Hilbert space; these are Banach spaces using
the operator norm. C(X;K(H)), C(Y;K(J))),... are the spaces of compact-operator-valued,
continuous functions, which are Banach spaces employing the norm given by ﬁrst applying
the operator norm on the operators pointwise, then the maximum norm over the space.
C.1
Real-valued, continuous functions
Comment
The following proposition strengthens the well-known result, which is a special
case of a result by Grothendieck [17], that C(X × Y) = C(X)ˇ⊗C(Y), where ˇ⊗indicates
completion in the injective norm2.
Proposition C1.1
The ﬁnite-nonnegative-tensor-rank3 continuous functions are dense in
the maximum norm topology for positive, continuous functions on X × Y.
Proof
Let f be any positive, continuous function on X × Y and take any ε > 0. Since f
is continuous, for each (x,y) ∈X there are open subsets U(x,y) ⊂X and V(x,y) ⊂Y such that
f(U(x,y) × V(x,y)) ⊂(f(x,y) −ε
2,f(x,y) + ε
2). Since X × Y is necessarily compact, there is a
ﬁnite subcover, {U(x,y)j × V(x,y)j}
n
j=1. For each x ∈X, deﬁne Ux by the intersection over all
1An operator is compact if the image of a bounded sequence necessarily contains a convergent subse-
quence.
2The injective norm on A ⊗B is the norm induced by its being a subspace of Bilinear(A∗,B∗), ∥c∥∨=
supc(ϕ,ψ), where the supremum is taken over ϕ in the unit ball of A∗and ψ in the unit ball of B∗.
3Using only positive real scalars.

APPENDIX C. PROPOSITIONS FOR OPTION II
165
U(x,y)j containing x. Similarly, for each y ∈Y, deﬁne Vy by the intersection over all V(x,y)j
containing y. Since X and Y are compact, there are ﬁnite subcovers, {Uxj}
l
j=1 and {Vyj}
m
j=1,
where each Uxi × Vyk is a subset of one of the U(x,y)j × V(x,y)j. Since compact, Hausdorﬀsets
are normal, there are ﬁnite partitions of unity, {φj}l
j=1 and {ψj}m
j=1, dominated by {Uxj}
l
j=1
and {Vyj}
m
j=1 respectively [58] [103]. Then
l
∑
i=1
m
∑
k=1
f(xi,yl)φiψk
(C.1)
is a ﬁnite-nonnegative-tensor-rank continuous function that is everywhere on X × Y within
ε of f. ◻
C.2
Maps on real-valued, continuous functions
Corollary C2.1
Positive maps L ∈B(C(Y),C(X))+ are completely-positive4.
Proof
Use C1.1 and the positivity of both maps L and IB(C(Z)). ◻
Corollary C2.2
Maps L ∈B(C(Z),C(X)) and K ∈B(C(W),C(Y)) satisfy (K⊗L)∗(µ×ν) =
K∗µ × L∗ν for any Radon measures µ on X and ν on Y.
Proof
By the preceding proposition, it is suﬃcient to demonstrate that for any ﬁnite
collections {fj} ⊂C(Z) and {gj} ⊂C(W),
∑
j ∫Z×W fj ⊗gj d(K ⊗L)∗(µ × ν) = ∑
j ∫Z×W fj ⊗gj d(K∗µ × L∗ν)
(C.2)
but this follows from Tonelli’s theorem [96], which is applicable since µ, ν are necessarily
ﬁnite measures,
∑
j ∫Z×W fj ⊗gj d(K ⊗L)∗(µ × ν) = ∑
j ∫X×Y Kfj ⊗Lgj d(µ × ν) = ∑
j ∫X Kfj dµ∫Y Lgj dν
(C.3)
= ∑
j ∫Z fj dK∗µ∫W gj dL∗ν = ∑
j ∫Z×W fj ⊗gj d(K∗µ × L∗ν)
◻
Comment
For any positive map L ∈B(C(Y),C(X))+, clearly ∥L∥op = ∥L(1Y)∥max. Hence,
the cone of positive maps is clearly normal.
4A map L is completely-positive if L ⊗IB(C(Z)) is positive for every Z.

APPENDIX C. PROPOSITIONS FOR OPTION II
166
Proposition C2.3
For any L ∈B(C(Y),C(X)), ∥L∥op = supx∈X ∥L∗(δx)∥.
Proof
By deﬁnition of the operator norm,
∥L∥op =
sup
f∈C(Y),∥f∥max≤1
∥Lf∥max = sup
⎧⎪⎪⎪⎨⎪⎪⎪⎩
∣(Lf)(x)∣
RRRRRRRRRRRRRR
f ∈C(Y)
∥f∥max ≤1
x ∈X
⎫⎪⎪⎪⎬⎪⎪⎪⎭
(C.4)
= sup
⎧⎪⎪⎪⎨⎪⎪⎪⎩
∣∫X Lf dδx∣
RRRRRRRRRRRRRR
f ∈C(Y)
∥f∥max ≤1
x ∈X
⎫⎪⎪⎪⎬⎪⎪⎪⎭
= sup
⎧⎪⎪⎪⎨⎪⎪⎪⎩
∣∫X f dL∗(δx)∣
RRRRRRRRRRRRRR
f ∈C(Y)
∥f∥max ≤1
x ∈X
⎫⎪⎪⎪⎬⎪⎪⎪⎭
= sup
x∈X
∥L∗(δx)∥total variation
◻
Corollary C2.4
Maps L ∈B(C(Z),C(X)) and K ∈B(C(W),C(Y)) satisfy ∥K ⊗L∥op =
∥K∥op∥L∥op.
Proof
Using the preceding proposition,
∥K ⊗L∥op ≥
sup
(x,y)∈X×Y
∥(K ⊗L)∗(δ(x,y))∥total variation
(C.5)
Since δ(x,y) = δx × δy, from C2.3, this is equal to
sup
(x,y)∈X×Y
∥K∗(δx) × L∗(δy)∥total variation
(C.6)
By B1.5, this is equal to
sup
x∈X
∥K∗(δx)∥total
variation
sup
y∈Y
∥L∗(δy)∥total
variation
(C.7)
which, using the preceding proposition again, is equal to ∥K∥op∥L∥op. ◻
Proposition C2.5
B(C(Y),C(X)) is not in general a vector lattice.
Counterexample
Take X = Y = [−1,1] with the usual topology. Take L ∈B(C([−1,1]))
to be
Lf(x) =
⎧⎪⎪⎨⎪⎪⎩
0
if x ≤0
f(x) −f(−x)
if x > 0
(C.8)
Then L ∨0 should be
(L ∨0)f(x) =
⎧⎪⎪⎨⎪⎪⎩
0
if x ≤0
f(x)
if x > 0
(C.9)
but this sends some continuous functions to discontinuous ones. ◻

APPENDIX C. PROPOSITIONS FOR OPTION II
167
Proposition C2.6
B(C(Y),C(X)) is not in general directed-complete.
Counterexample
Take X = Y = [−1,1] with the usual topology. Take Lj ∈B(C([0,1]))
to be
Ljf(x) =
⎧⎪⎪⎨⎪⎪⎩
0
if x ≤0
j√xf(x)
if x > 0
Then supj Lj should be
(L ∨0)f(x) =
⎧⎪⎪⎨⎪⎪⎩
0
if x ≤0
f(x)
if x > 0
but this sends some continuous functions to discontinuous ones. ◻
Proposition C2.7
For any positive L ∈B(C(Y),C(X))+, there is a transition function
τ(⋅∣⋅) ∶OpenY × X, which is: (i) an additive set function on the open subsets of Y; (ii)
pointwise countably additive on the open subsets of Y; and (iii) lower-semi-continuous for
any ﬁxed open subset O ⊂Y–such that
(L∗µ)(O) = ∫x∈X τ(O∣x)dµ(x)
for any open O ⊂Y and Radon measure µ on X.
Proof
Let O be any open subset of Y. Then, by the deﬁnition of Radon measures for open
subsets in the proof of the Riesz-Markov theorem [78],
(L∗µ)(O) =
sup
f ∈C(Y)
0 ≤f ≤1O
∫Y f dL∗µ =
sup
f ∈C(Y)
0 ≤f ≤1O
∫X Lf dµ
=
sup
f ∈C(Y)
0 ≤f ≤1O
∫x∈X (∫x′∈X Lf dδx(x′)) dµ(x) =
sup
f ∈C(Y)
0 ≤f ≤1O
∫x∈X (∫Y f d(L∗δx)) dµ(x)
(C.10)
Then for any ε > 0, there is some continuous f between zero and 1O such that
(L∗µ)(O) > ∫x∈X (∫Y f d(L∗δx)) dµ(x) −ε
2
(C.11)
Now consider the sequence of continuous functions ⟨gj⟩, each between zero and 1O, given
by
gj(y) =
⎧⎪⎪⎨⎪⎪⎩
1
if dist(y,∼O) > 2−j
2j ⋅dist(y,∼O)
if dist(y,∼O) ≤2−j
(C.12)

APPENDIX C. PROPOSITIONS FOR OPTION II
168
for j ∈Z+ and y ∈Y. Since Y is compact and metric, f is uniformly continuous [104] [59], so
there is some δ such that
f (Ball(y,δ)) ⊂(f(y) −
ε
2∥L∥opµ(X),f(y) +
ε
2∥L∥opµ(X))
(C.13)
for any y ∈Y.For j suﬃciently large that 2−j < δ, then gj is greater than or equal to f
everywhere except for the set {y ∈Y∣dist(y,∼O) ≤2−j}, on which it cannot be smaller by
more than
ε
22∥L∥opµ(X ; hence,
∫x∈X (∫Y f d(L∗δx)) dµ(x)−∫x∈X (∫Y f d(L∗δx)) dµ(x) < ∫x∈X
ε
2∥L∥opµ(X (L∗δx)(Y) dµ(x) ≤ε
2
(C.14)
Therefore,
(L∗µ)(O) > ∫x∈X (∫Y gj d(L∗δx)) dµ(x) −ε
(C.15)
Since ε was arbitrary, it must be that
(L∗µ)(O) = lim
j→∞∫x∈X (lim
j→∞∫Y gj d(L∗δx)) dµ(x)
(C.16)
which is equal to
∫x∈X (lim
j→∞∫Y gj d(L∗δx)) dµ(x)
(C.17)
by the Dominated Convergence theorem [75]. Using the Dominated Convergence theorem
again, we have
(L∗µ)(O) = ∫x∈X (∫Y 1O d(L∗δx)) dµ(x) = ∫x∈X(L∗δx)(O) dµ(x)
(C.18)
Also,
(L∗δx)(O) = lim
j→∞∫Y gj d(L∗δx) = lim
j→∞(Lgj)(x)
(C.19)
is measurable by [89] (as the supremum over a sequence of increasing, continuous functions,
it is actually clearly lower-semi-continuous). Hence, τ(O∣x) = (L∗δx)(O) has the desired
properties. ◻
Alternate proof
Let O ⊂Y be open. Deﬁne τ(O∣⋅) by
τ(O∣x) =
⎛
⎜⎜⎜
⎝
⋁
f ∈C(Y)
0 ≤f ≤1O
Lf
⎞
⎟⎟⎟
⎠
(x)
(C.20)

APPENDIX C. PROPOSITIONS FOR OPTION II
169
Then τ(O∣⋅) is lower-semi-continuous, since, for any a ∈R,
τ(O∣⋅)−1((a,∞)) =
⋃
f ∈C(Y)
0 ≤f ≤1O
(Lf)−1((a,∞))
(C.21)
which is the union of open sets; hence, it is open. Also, for any Radon measure µ, by inner
regularity,
(L∗µ)(O) =
sup
compact K⊂O
(L∗µ)(K)
(C.22)
By Urysohn’s lemma [105], this is equal to
sup
f ∈C(Y)
0 ≤f ≤1O
∫y∈Y f(y)d(L∗µ)(y) =
sup
f ∈C(Y)
0 ≤f ≤1O
∫x∈X(Lf)(x)dµ(x)
(C.23)
which is less than or equal to ∫x∈X τ(O∣x)dµ(x), which is less than or equal to
⎛
⎜⎜⎜
⎝
⋁
f ∈C(Y)
0 ≤f ≤1O
L∗∗f
⎞
⎟⎟⎟
⎠
(µ)
(C.24)
which exists since dual spaces are necessarily directed-complete. This is in turn less than or
equal to (L∗µ)(O); hence, (L∗µ)(O) = ∫x∈X τ(O∣x)dµ(x). ◻
The bounded, Borel functions on Y, B(Y), form a Banach space using the supremum
norm. The space B(Y), acting on Radon measures via integration, can be considered a
subspace of the linear functionals C(Y)∗∗. Note the preceding shows τ(O∣x) = (L∗δx)(O)
and that L∗∗1O = τ(O∣⋅) is a function in B(X) rather than just a general pseudo-function in
C(X)∗∗[113].
Proposition C2.8
For any positive L ∈B(C(Y),C(X))+, if Y is metric there is a transition
function (see A3.1) τ(⋅∣⋅) ∶BorelY × X such that
(L∗µ)(B) = ∫x∈X τ(B∣x)dµ(x)
for any Borel subset B ⊂Y and ﬁnite Radon measure µ on X.
Proof
Note we cannot just immediately begin with τ(B∣x) = Lδx(B) for a general Borel
subset B ⊂Y because it is not evident that such a construction is measurable in x. Instead,
we must proceed step-by-step in an inductive argument. Following Hausdorﬀ[26], let G0 be
the collection of the open subsets of Y. For each ordinal α, let Gα be the collection of subsets
of Y that are the countable intersection of subsets from the various collections Gβ for ordinals

APPENDIX C. PROPOSITIONS FOR OPTION II
170
β < α if α is odd and that are the countable union of subsets from the various collections
Gβ for ordinals β < α if α is even (where all limit ordinals–those without a predecessor–are
taken even). For clariﬁcation, using the standard notation [106], G1 = Gδ, G2 = Gδσ, and so
on for the ﬁnite ordinals.
Fix any ordinal α and suppose that for all subsets B in all collections Gβ for β < α
we have the following property: there is a Borel measurable τ(B∣⋅) such that (L∗µ)(B) =
∫x∈X τ(B∣x)dµ(x) for any Radon measure µ on X.
Take any C ∈Gα.
If α is even, we
have a sequence ⟨Bj⟩of subsets from the various Gβ with β < α such that C = ⋃j Bj. Let
τ(C∣⋅) = ⋁j τ(Bj∣⋅). Then τ(C∣⋅) is measurable (see [89]) and, by the Dominated Convergence
theorem [75], (L∗µ)(C) = ∫x∈X τ(C∣x)dµ(x) for any Radon measure µ on X; hence, since C
was arbitrary, Gα has the property. Similarly, if α is odd, we have a sequence ⟨Bj⟩of subsets
from the various Gβ with β < α such that C = ⋂j Bj. Let τ(C∣⋅) = ⋀j τ(Bj∣⋅). Then τ(C∣⋅)
is measurable and, by the dominated convergence theorem, (L∗µ)(C) = ∫x∈X τ(C∣x)dµ(x)
for any Radon measure µ on X; hence, Gα also has the property. However, by the above
proposition C2.7, G0 has the property, so by transﬁnite induction [27] [116] all the Gα have
the property.
Since Y is metric, its closed subsets are also in G1 = Gδ [44]; hence, following Kura-
towski [43], the Borel subsets of Y are in the union ⋃α Gα. Therefore, the Borel subsets also
have the property. ◻
Comment
The preceding proof does not depend on the axiom of choice since the union
only needs to be taken up to the ordinal number for the minimal uncountable well-ordered
set [26] [43], whose existence does not depend on the axiom of choice [55].
Corollary C2.9
For any positive L ∈B(C(Y),C(X))+, if Y is metric then L∗∗acting on
B(Y) ⊂C(Y)∗∗has image in B(X) ⊂C(X)∗∗.
Proof
Use the density of simple functions in B(Y) together with the above propositions
C2.8 and A1.3.
C.3
Compact-operator-valued, continuous functions
Proposition C3.1
C(X;K(H)) ⊗C(Y;K(J)) is norm dense within C(X × Y;K(H ⊗J)).
Proof
Finite-rank operators are norm-dense among compact operators, so proceed as in
the ﬁrst part of the proof for B4.1. Then following the argument in the proof of C1.1
involving partitions-of-unity gives the desired result. ◻

APPENDIX C. PROPOSITIONS FOR OPTION II
171
C.4
Operator inequalities
Proposition C4.1
For any operators ϕ,ξ ∈K(H),
∥∣ϕ∣−∣ξ∣∥op ≤
√
∥ϕ −ξ∥op∥ϕ + ξ∥op
where ∣χ∣=
√
χ2.
Proof
By the properties of compact operators, ∣ϕ∣−∣ξ∣is compact. By the spectral theorem
for compact operators, there is a unit-length ψ ∈H which is an eigenvector ψ of ∣ϕ∣−∣ξ∣and
with corresponding eigenvalue λ equal to ∥∣ϕ∣−∣ξ∣∥op in magnitude. Then, using the triangle
inequality,
∥∣ϕ∣−∣ξ∣∥2
op = ∣λ⟨(∣ϕ∣−∣ξ∣)ψ,ψ⟩∣≤∣λ⟨(∣ϕ∣+ ∣ξ∣)ψ,ψ⟩∣
(C.25)
= ∣1
2 ⟨(∣ϕ∣+ ∣ξ∣)(∣ϕ∣−∣ξ∣)ψ,ψ⟩+ 1
2 ⟨(∣ϕ∣−∣ξ∣)(∣ϕ∣+ ∣ξ∣)ψ,ψ⟩∣
= ∣⟨(ϕ2 −ξ2)ψ,ψ⟩∣≤∥ϕ2 −ξ2∥op = ∥1
2(ϕ + ξ)(ϕ −ξ) + 1
2(ϕ −ξ)(ϕ + ξ)∥
op
≤1
2 ∥(ϕ + ξ)(ϕ −ξ)∥op + 1
2 ∥(ϕ −ξ)(ϕ + ξ)∥op ≤∥ϕ −ξ∥op∥ϕ + ξ∥op
◻
The second needed inequality, which involves subsets of direct products of spaces of
operators, is lengthy to state, although it has a very short proof. For real numbers a =
(a1,...,an) in the simplex {x ∈[0,1]×n∣x1 + ⋯+ xn = 1}, let An(a,H) ⊂K(H)×n be the set
⎧⎪⎪⎨⎪⎪⎩
(φ1,...,φn) ∈K(H)×n
RRRRRRRRRRRR
∥
n
∑
j=1
ajφj∥
op
≤1
⎫⎪⎪⎬⎪⎪⎭
(C.26)
Let B(B(H)) denote the closed, unit ball (using the operator norm) in B(H). By the triangle
inequality, B(B(H))×n ⊂An(a,H) for any allowed choice of a. Now consider the set Cn(ε,H) ⊂
K(H)×n given by
{(φ1,...,φn) ∈{B ∈K(H)×n ∣max
j<k ∥φj −φk∥op ≤ε}
(C.27)
for ε > 0.
Deﬁne a distance from A ∈K(H)×n to a subset F ⊂K(H)×n by
dist (A,F) = inf
E∈F max
j
∥Aj −Ej∥op
(C.28)
Using this to deﬁne a Hausdorﬀdistance between subsets then gives:

APPENDIX C. PROPOSITIONS FOR OPTION II
172
Proposition C4.2
The Hausdorﬀdistance between An(a,H) ∩Cn(ε,H) and B(B(H))×n ∩
Cn(ε,H) is bounded by ε.
Proof
Take any allowed a and any φ ∈An(a,H)∩Cn(ε,H). Then, by the triangle inequality,
for any j ∈{1,2,...,n},
∥φj −
n
∑
k=1
akφk∥
op
≤
n
∑
k=1
ak ∥φj −φk∥op ≤ε
(C.29)
However, by the deﬁnition of An(a,H), ∑n
k=1 akφk is in B(B(H)). ◻
Note the compactness of the operators was not used in the preceding proof so the proposition
holds for the corresponding subsets of self-adjoint operators in B(H), although we will not
require that generalization.
For the following proposition, let {Aj} be any ﬁnite collection of positive, Hermitian
n × n-matrices and let P be any orthogonal projector.
Proposition C4.3
There is a constant c0, independent of P, n, and r, such that
r
∑
j=1
∥Aj −PAjP∥trace ≤c0
¿
Á
Á
À(
r
∑
j=1
tr (Aj −PAjP))(
r
∑
j=1
tr Aj)
Proof
Observe that for any a1,...,am ∈R ∖{0}, the quantity ∑m
j=1
a2
j
xj is minimized over
x1,...,xm ∈R+ for ﬁxed ∑m
j=1 xj when for each j, xj = ∣aj∣. Now consider the problem of
minimizing the product tr D tr CD−1C∗over strictly-positive, Hermitian, m × m-matrices
D, given any n × m-matrix C. First take the case of n ≥m and C∗C strictly positive. The
minimization over D is the same as minimizing over its eigenvalues, x1,...,xm ∈R+, and
eigenvectors, W, with W unitary. For ﬁxed value of W and the trace of D, x1 + ⋯+ xm,
using the preceding observation, this will occur for
xj = (x1 + ⋯+ xm)ej
e1 + ⋯+ em
(C.30)
where ej is the square root of the jth diagonal entry of W ∗C∗CW. Then, tr D tr CD−1C∗=
(e1 + ⋯+ em)2. Since squaring is monotonic for positive reals and the square root function is
concave, this is minimized over all W when W ∗C∗CW is diagonal, so e1+⋯+em = tr
√
C∗C.
Therefore, tr D tr CD−1C∗≥(tr
√
C∗C)
2. By the ability to embed matrices into larger
matrices and the density of invertible matrices, this inequality actually holds for all n × m-
matrices C.
By the triangle inequality,
∥[ 0
C
C∗
D ]∥
2
trace
≤(∥[ 0
C
C∗
0 ]∥
trace
+ ∥D∥trace)
2
= (2tr
√
C∗C + tr D)
2
(C.31)

APPENDIX C. PROPOSITIONS FOR OPTION II
173
By the arithmetic-geometric mean inequality, this is less than or equal to
8(tr
√
C∗C)
2
+ 2(tr D)2 ≤8((tr
√
C∗C)
2
+ (tr D)2)
(C.32)
which, by the above result, is less than or equal to
8((tr CD−1C∗+ tr D)tr D)
(C.33)
For any Hermitian matrix of the form [ B
C
C∗
D ] to be positive, it is necessary (and
suﬃcient) that B −CD−1C∗is positive; otherwise, if there were some vector v such that
⟨(B −CD−1C∗)v,v⟩< 0, then the vector w = [
v
−D−1C∗v ] would give
⟨[ B
C
C∗
D ]w,w⟩= ⟨(B −CD−1C∗)v,v⟩+ ⟨D [ D−1C∗
Im ]w,[ D−1C∗
Im ]w⟩(C.34)
= ⟨(B −CD−1C∗)v,v⟩< 0
which is a contradiction. Therefore, for any positive, Hermitian matrix of the form [ B
C
C∗
D ]
with D strictly positive,
∥[ 0
C
C∗
D ]∥
2
trace
≤8((tr B + tr D)tr D)
(C.35)
By the density of strictly-positive matrices among positive ones, this holds even if D is not
strictly positive. Since any orthogonal projector can be brought into the form where there
are ones along the upper-left diagonal and zeros everywhere else, this proves the case of r = 1,
∥A −PAP∥trace ≤c0
√
tr (A −PAP)tr A
(C.36)
with c0 = 2
√
2.
The case of r > 1 then follows. Take any row vectors a,b,c ⊂R+ that are independent
and whose projections to any of the subspace of dimension greater than two using diagonal
projectors are still independent. Then, using Lagrange multipliers, the maximum value of
∑r
j=1 cjxj over x1,...,xr ≥0 for ﬁxed value of the product (∑r
j=1 ajxj)(∑r
k=1 bkxk) can only
occur if all but two of the xj’s are zero. Even then, the maximum value can only be attained
for both xj’s nonzero if it is also attained for one of them zero. Since the given conditions on
a,b,c describe a dense subset, then it always the case that the maximizing value is attained
when all the xj’s are zero except for one. Then, since
sup
∑r
j=1 ∥Aj −PAjP∥trace
√
(∑r
k=1 (tr (Ak −PAkP)))(∑r
l=1 tr Al)
(C.37)

APPENDIX C. PROPOSITIONS FOR OPTION II
174
over all P, n, r, and {Aj}, is the same as
sup
∑r
j=1 xj∥Aj −PAjP∥trace
√
(∑r
k=1 xk (tr (Ak −PAkP)))(∑r
l=1 xltr Al)
(C.38)
over all P, n, r, {xj} ⊂R+ ∪{0}, and {Aj}, it is the same as
sup
∥A −PAP∥trace
√
tr (A −PAP)tr A
(C.39)
over all P, n, and A, which is bounded by 2
√
2 by the above. ◻
Remark
Apparently c0 = 2 is suﬃcient, since, by numerical calculation, (C.33) can be
replaced by
∥[ 0
C
C∗
D ]∥
2
trace
≤4((tr CD−1C∗+ tr D)tr D)
(C.40)
where the bound is tight since equality is approached as ε →0+ for D = ε
√
C∗C. However,
a proof of this tight bound is lacking.
C.5
Maps on compact-operator-valued, continuous
functions
Proposition C5.1
Any positive map L ∈B (C(Y;K(J)),C(X;K(H)))+ satisﬁes
∥L∥op =
sup
f ∈C(Y; K(J))+
∥f∥≤1
∥Lf∥=
sup
ﬁnite-dimensional K⊂J
∥L(IK1Y)∥
(C.41)
Proof
From the proof of C3.1, functions of the form ∑j gjφj for ﬁnite collections {φj} ⊂
K(J) and partition-of-unity {gj} are norm-dense in C(Y;K(J)). Furthermore, for any ε > 0,
it is possible to enforce the constraint that ∥φj −φk∥op < ε if the support of gj intersects the
support of gk while maintaining the density property.
Then, for any value of ε > 0, ∥L∥op is equal to
sup
⎧⎪⎪⎪⎪⎪⎪⎨⎪⎪⎪⎪⎪⎪⎩
∥
n
∑
j=1
L(φjgj)∥
RRRRRRRRRRRRRRRRRRR
partition-of-unity {g1,...,gn},
{φj} ⊂K(J),∥φj −φk∥op < ε
if support gj ∩support gk ≠∅,
∥∑n
j=1 φjgj∥≤1
⎫⎪⎪⎪⎪⎪⎪⎬⎪⎪⎪⎪⎪⎪⎭
(C.42)

APPENDIX C. PROPOSITIONS FOR OPTION II
175
Now consider b(ε) given by
sup
⎧⎪⎪⎪⎪⎪⎪⎨⎪⎪⎪⎪⎪⎪⎩
∥
n
∑
j=1
L(φjgj)∥
RRRRRRRRRRRRRRRRRRR
partition-of-unity {g1,...,gn},
{φj} ⊂K(J),∥φj −φk∥op < ε
if support gj ∩support gk ≠∅,
∥φj∥op ≤1
⎫⎪⎪⎪⎪⎪⎪⎬⎪⎪⎪⎪⎪⎪⎭
(C.43)
Note b(ε) is a decreasing function of ε, so its limit as ε →0+ certainly exists. By C4.2,
b(ε) ≤∥L∥op ≤b(ε) + ε∥L∥op
(C.44)
so
b(ε) ≤∥L∥op ≤b(ε)
1 −ε
(C.45)
Hence, ∥L∥op is equal to limε→0+ b(ε).
The additional constraint that all the {φj} are positive can only reduce the supremum
or leave it unchanged. On the other hand, since L is positive
∥∑
j
L(gjφj)∥= sup
x∈X
sup
v∈H,∥v∥≤1∑
j
⟨L(gjφj)(x)v,v⟩
(C.46)
is certainly less than
∥∑
j
L(gj∣φj∣)∥= sup
x∈X
sup
v∈H,∥v∥≤1∑
j
⟨L(gj∣φj∣)(x)v,v⟩
(C.47)
In addition, examining the constraints on {φj} in (C.43), ∥∣φj∣∥op = ∥φj∥op and, by C4.1,
∥∣φj∣−∣φk∣∥op ≤
√
∥φj −φk∥op ∥φj + φk∥op ≤√ε
√
∥φj + φk∥op
(C.48)
By the triangle inequality and the other constraints, this is less than or equal to
√
2ε (so
this new condition gives rise to a subset that necessarily includes the previous one), which
can simply be replaced by ε since ε →0. Hence, the additional constraint that all the {φj}
are positive can only reduce the supremum or leave it unchanged. Therefore, it must leave
it unchanged.
However, now starting with sup f ∈C(Y; K(J))+
∥f∥≤1
∥Lf∥and repeating the process would lead
to the same result, so it is only necessary to take the supremum over the positive cone. Finite-
rank operators are norm-dense among compact operators, so it is only necessary to take the
supremum over them. Any collection of ﬁnite-rank operators live collectively on some ﬁnite-
dimensional subspace K ⊂J. Since L is positive, the supremum for that particular K then
occurs for the constant function with value IK. ◻

APPENDIX C. PROPOSITIONS FOR OPTION II
176
Proposition C5.2
If L ∈B (C(Y;K(J)),C(X;K(H))) is completely bounded, then, for any
compact space Z and any Hilbert space K, ∥L ⊗I∥op ≤∥L∥matrix with I the identity map in
B (C(Z;K(K))).
Proof
By the deﬁnition of operator norm and the deﬁnition of the tensor product of maps,
∥L ⊗I∥op is equal to
sup{∥(L ⊗I)f∥∣ﬁnite-tensor-rank f ∈C(Y × Z;K(J ⊗K)
with ∥f∥≤1
}
(C.49)
By the preceding proof, this is the same as
lim
ε→0 sup{∥
n
∑
j=1
p
∑
k=1
m
∑
l=1
L(φjklgj) ⊗τjklhk∥
(C.50)
RRRRRRRRRRRRRRRRRRRRRRRRRRRRR
m ∈{1,2,...},
partition-of-unity {g1,...,gn},partition-of-unity {h1,...,hp},
{φjkl} ⊂K(J),{τjkl} ⊂K(K),
∥∑m
l=1(φjkl ⊗τjkl −φj′k′l ⊗τj′k′l)∥op < ε
if support gj ∩support gj′ ≠∅and support hk ∩support hk′ ≠∅
∥∑m
l=1 φjkl ⊗τjkl∥op ≤1
⎫⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎬⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎭
Writing
∥
n
∑
j=1
p
∑
k=1
m
∑
l=1
L(φjklgj) ⊗τjklhk∥
(C.51)
out as
sup
x∈X
sup
z∈Z
∥
n
∑
j=1
p
∑
k=1
m
∑
l=1
L(φjklgj)(x) ⊗τjklhk(z)∥
op
(C.52)
then, since Z is compact, the maximum value is achieved for a certain z∗(which depends on
all the other quantities the supremum is taken over). Incorporating the value of hk(z∗) into
τjkl, then the constraint:
∥
m
∑
l=1
φjkl ⊗τjkl∥
op
≤1
(C.53)
becomes
∥
m
∑
l=1
φjkl ⊗τjkl∥
op
≤hk(z∗)
(C.54)
which implies
p
∑
k=1
∥
m
∑
l=1
φjkl ⊗τjkl∥
op
≤1
(C.55)

APPENDIX C. PROPOSITIONS FOR OPTION II
177
which by the triangle inequality implies
∥
p
∑
k=1
m
∑
l=1
φjkl ⊗τjkl∥
op
≤1
(C.56)
Similarly, the constraint:
∥
m
∑
l=1
(φjkl ⊗τjkl −φj′k′l ⊗τj′k′l)∥
op
< ε
(C.57)
if support gj ∩support gj′ ≠∅and support hk ∩support hk′ ≠∅
becomes
∥
m
∑
l=1
(φjkl ⊗τjkl −φj′kl ⊗τj′kl)∥
op
< εhk(z∗)
(C.58)
if support gj ∩support gj′ ≠∅
which implies
p
∑
k=1
∥
m
∑
l=1
(φjkl ⊗τjkl −φj′kl ⊗τj′kl)∥
op
< ε
(C.59)
if support gj ∩support gj′ ≠∅
which, by the triangle inequality, implies
∥
p
∑
k=1
m
∑
l=1
(φjkl ⊗τjkl −φj′kl ⊗τj′kl)∥
op
< ε
(C.60)
if support gj ∩support gj′ ≠∅
Using the new τjkl together with the new, weaker constraints can only increase the value
of the supremum. Furthermore, the sums over k and l can now be combined, yielding a
bound to ∥L ⊗I∥op given by
lim
ε→0 sup
⎧⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎨⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎩
∥
n
∑
j=1
m
∑
k=1
L(φjkgj) ⊗τjk∥
RRRRRRRRRRRRRRRRRRRRRRRRRRRRR
m ∈{1,2,...},
partition-of-unity {g1,...,gn},
{φjk} ⊂K(J),{τjk} ⊂K(K),
∥∑m
k=1(φjk ⊗τjk −φj′k ⊗τj′kl)∥op < ε
if support gj ∩support gj′ ≠∅
∥∑m
k=1 φjk ⊗τjk∥op ≤1
⎫⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎬⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎭
(C.61)
Since the ﬁnite-rank operators are norm-dense among the compact operators, this bound
is unchanged by requiring the τjk to be ﬁnite-rank.
However, the ﬁnite-rank operators
collectively live on a ﬁnite-dimensional subspace of K that is isomorphic to CN for some
integer N ≤dimK. Incorporating this into the preceding expression for the bound, we have
∥L ⊗I∥op ≤
sup
N≤dim K
∥L ⊗IMN∥op
◻
(C.62)

APPENDIX C. PROPOSITIONS FOR OPTION II
178
Proposition C5.3
If the positive map L ∈B (C(Y;K(J)),C(X;K(H)))+, compact space Z,
and Hilbert space K are such that L⊗I is positive, for I the identity map in B (C(Z;K(K))),
then ∥L ⊗I∥op = ∥L∥op.
Proof
If L ⊗I is positive, then clearly L ⊗IMn is positive for every positive integer n less
than or equal to dimK. By the preceding proposition, it is therefore only necessary to show
that if L ⊗IMn is positive, then ∥L ⊗IMn∥op = ∥L∥op. However, if L ⊗IMn is positive, then
by C5.1,
∥L ⊗IMn∥op =
sup
ﬁnite-dimensional L⊂J
∥(L ⊗IMn)(IL⊗Cn1Y)∥
(C.63)
=
sup
ﬁnite-dimensional L⊂J
sup
x∈X
∥L(IL1Y)(x) ⊗In∥op
=
sup
ﬁnite-dimensional L⊂J
sup
x∈X
∥L(IL1Y)(x)∥op
which is ∥L∥op by C5.1. ◻
Corollary C5.4
The completely-positive maps
B (C(Y;K(J)),C(X;K(H)))cp
are completely bounded.
Corollary C5.5
The cone of completely-positive maps
B (C(Y;K(J)),C(X;K(H)))cp
is normal in either the induced operator norm or the matrix norm.
Proposition C5.6
If L ∈B (C(Y;K(J)),C(X;K(H)))cp, then, for any compact space Z
and any Hilbert space K, L ⊗I is positive, with I the identity map in B (C(Z;K(K))).
Proof
Since L is completely positive, by C5.4 it is completely bounded. Hence, L ⊗I
exists by C5.2. Furthermore, by C3.1 and A1.3, L ⊗I is unique, so it is meaningful to
speak of it being positive.
Now suppose there were some compact space Z and some Hilbert space K such that
L ⊗I were not positive. Then there would be some positive f ∈C(Y ⊗Z;K(J ⊗K))+ such
that (L ⊗I)f is not positive.
Since the cone C(X ⊗Z;K(H ⊗K))+ is norm-closed and
L ⊗I is continuous, that implies there is a relatively open neighborhood of f in the cone
C(Y ⊗Z;K(J ⊗K))+ whose image under L ⊗I does not intersect C(X ⊗Z;K(H ⊗K))+.
Now approximating f as in the proof of C5.2 as ∑jkl ϕjkl ⊗τjkl gj ⊗hk (but without the
need for any ε-constraints), one ﬁnds that for this to occur there must be some n ∈{1,2,...}
for which L ⊗IMn is not positive; however, that is a contradiction. ◻

APPENDIX C. PROPOSITIONS FOR OPTION II
179
Proposition C5.7
If either dimH or dimJ is ﬁnite and a positive map
L ∈B (C(Y;K(J)),C(X;K(H)))+ is such that L ⊗IMm is positive for m = min{dimH,dimJ},
then L is completely positive.
Proof
Clearly, since L ⊗IMm is positive, so is L ⊗IMn for all n < m. Now take n > m.
L ⊗IMn will be positive if for every f ∈C(Y;K(J ⊗Cn))+, y ∈H ⊗Cn, and x ∈X,
⟨((L ⊗IMn)f)(x)y,y⟩≥0
(C.64)
It is enough to show this for f in a dense subset, so f can be restricted to the form ∑j ϕjgj
for {gj} a partition-of-unity and {ϕj} a collection of compact operators. By the spectral
theorem for compact operators, it is enough to show this for the ϕj’s all rank one. Following
the argument of B5.9 then gives the desired result. ◻
Proposition C5.8
The space of completely bounded maps,
CB (C(Y;K(J)),C(X;K(H)))
is a Banach space with respect to the matrix norm.
Proof
Same argument as for B5.10 ◻
Proposition C5.9
The subset of B (C(Y;K(J)),C(X;K(H))) for which the tensor product
with IMn is positive for some ﬁxed n ∈{1,2,...} is closed in the weak topology.
Proof
We will show the complement is open. Take such a map L that is not in the subset.
By the argument in the proof for C5.7 and B5.9, that implies there are some x ∈X,
partition-of-unity {gj}, ﬁnite collections of vectors {wjk} ⊂J and {vk} ⊂H, and ε > 0 such
that
m
∑
j=1
n
∑
k,l=1
⟨L(wjk ⊗w∗
jl gj)(x)vl,vk⟩< −ε
(C.65)
Then, by the triangle inequality, all the maps in the weak neighborhood
m
⋂
j=1
n
⋂
k,l=1
N (L;wjkw∗
jk gj;vl ⊗v∗
l δx;
ε
2n4m)
(C.66)
+
m
⋂
j=1
n
⋂
k=1
⋂
r<l
N (L;(wjr ⊗w∗
jl + wjl ⊗w∗
jr)gj;vk ⊗v∗
k δx;
ε
n4m)
+
m
⋂
j=1
n
⋂
k=1
⋂
r<l
N (L;wjk ⊗w∗
jk gj;(vk ⊗v∗
m + vm ⊗v∗
k)δx;
ε
n4m)
+
m
⋂
j=1 ⋂
k<l
⋂
q<r
N (L;(wjk ⊗w∗
jl + wjl ⊗w∗
jk)gj;(vq ⊗v∗
r + vr ⊗v∗
q)δx; 2ε
n4m)
will also fail to yield a positive tensor product with IMn. ◻

APPENDIX C. PROPOSITIONS FOR OPTION II
180
Corollary C5.10
The cone of completely positive maps is weakly closed in
B (C(Y;K(J)),C(X;K(H))).
Comment
See the comment following B5.12 concerning the use of the axiom of choice.
Proposition C5.11
For any positive functional Φ ∈C(X;K(H))∗, there is some D(H)+-
valued, Radon vector measure µ such that
Φf = ∫X fdµ
Proof
Since K(H)∗≅D(H), there is some ρ ∈D(H)+ such that Φ(φ1X) = tr ρφ for any
φ ∈K(H). Since ﬁnite rank operators are dense in compact ones, ρ lives on a separable
subspace of H; let {ej} be an orthonormal basis for this subspace and ⟨Pj⟩an increasing
sequence of projectors onto the subspaces spanned by the ﬁrst j basis vectors. Applying the
Riesz-Markov theorem entry-wise, there is a sequence of Radon vector measures, ⟨µj⟩, with
each µj taking values in D(PjH)+. Take j > k; then ∥µj −µk∥is given by
sup
⎧⎪⎪⎪⎨⎪⎪⎪⎩
r
∑
l=1
∥µj(El) −µk(El)∥trace
RRRRRRRRRRRRRR
r ∈{1,2,...},disjoint, Borel
subsets {E1,...,En}
with ⋃r
l=1 El = X
⎫⎪⎪⎪⎬⎪⎪⎪⎭
(C.67)
Applying C4.3, ∑r
l=1 ∥µj(El) −µk(El)∥trace is less than or equal to
c0
¿
Á
Á
À(
r
∑
l=1
tr (µj(El) −µk(El)))(
r
∑
l=1
tr µj(El))
(C.68)
= c0
√
tr (µj(X) −µk(X))tr µj(X)
which is less than or equal to c0
√
tr (ρ −µk(X))tr ρ. This goes to zero as k →∞since
the µk(X)’s are truncations of ρ, which converge to ρ in trace norm, which can be seen
either by using C4.3 again or by ﬁrst demonstrating that the truncations converge in norm
for rank-one ρ (which is readily shown); by the spectral theorem for compact operators,
the truncations converge in trace norm for every ρ. Therefore, ⟨µj⟩is a Cauchy sequence.
Since D(H)+-valued vector measures are complete with the given norm [108], the limit is the
desired µ. ◻
For the following proposition, restrict the Hilbert space H to be separable. Then there is
some ρ ∈D(H)+ that is strictly positive. Let {ej} be an orthonormal basis for H composed
of eigenvectors of ρ, with eigenvalues λj in decreasing order. For any Radon measure µ on
X, by the preceding proposition there is the induced variation measure ν = ∣L∗(ρ1Xµ)∣on
Y, which is also Radon [108]. Then we have the following result:

APPENDIX C. PROPOSITIONS FOR OPTION II
181
Proposition C5.12
For any positive L ∈B (C(Y;K(J)),C(X;K(H)))+, the adjoint map
L∗induces a map K that sends L1(X;µ;D(H))+ into L1(Y;ν;D(J))+.
Proof
Let C ⊂Y be any closed, ν-null subset. By outer-regularity, there are open sets
containing C with arbitrarily small ν-measure. Therefore, by Urysohn’s lemma [105],
0 = ν(A) =
inf
f∈C(Y),1X ≥f≥1C ∫Y f dν
(C.69)
Hence, by the deﬁnition of ν, for any φ ∈K(J)+,
0 =
inf
f∈C(Y),1Y≥f≥1C ∫x∈X tr ρL(φf)(x)dµ(x)
(C.70)
For A any Borel subset of X and τ any positive, self-adjoint operator on the span of ﬁnitely
many of the {ej}, any single-term simple function, τ1A, can be scaled to be less than ρ1X.
Then
0 =
inf
f∈C(Y),1Y≥f≥1C ∫x∈X 1A(x)tr τL(φf)(x)dµ(x)
(C.71)
Now take {τj} and {Aj} to be ﬁnite collections of such operators and subsets. For allowed
f1,...,fn, the pointwise product f1⋯fn is also allowed and is less than or equal to each of
the fj; hence,
inf
f∈C(Y),1Y≥f≥1C
n
∑
j=1∫x∈X 1Aj(x)tr τjL(φf)(x)dµ(x)
(C.72)
=
n
∑
j=1
inf
f∈C(Y),1X ≥f≥1C ∫x∈X 1Aj(x)tr τjL(φf)(x)dµ(x) = 0
Since simple functions of the form ∑n
j=1 τj 1Aj are dense in L1(X;µ;D(H))+, then for any
element ξ ∈L1(X;µ;D(H))+,
0 =
inf
f∈C(Y),1Y≥f≥1C ∫x∈X tr ξ(x)L(φf)(x)dµ(x) =
inf
f∈C(Y),1Y≥f≥1C ∫Y f d(φL∗(ξµ))
(C.73)
where φL∗(ξµ) is a Radon measure. Therefore, it must be that (φL∗(ξµ))(C) = 0. Since φ
was arbitrary, L∗(ξµ)(C) must be zero.
By inner regularity, any Borel set can have its measure approximated arbitrarily well by
closed sets it contains. Therefore, for any ν-null, Borel subset A, L∗(ξµ)(A) is also zero.
Therefore, L∗(ξµ) is absolutely continuous with respect to ν. Since D(H) has the Radon-
Nikod´ym property [18], there is a ψ ∈L1(Y;ν;D(J))+ such that L∗µ = ψν, which gives the
desired map K by Kξ = ψ. ◻

