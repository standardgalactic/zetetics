Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
Introduction to Bayesian Modeling of 
Epidemiologic Data 
David Dunson1, Amy Herring2 & Rich MacLehose1 
1National Institute of Environmental Health Sciences, NIH & 2Department of 
Biostatistics, UNC at Chapel Hill 
June 19, 2007 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 

Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
Outline of Workshop 
1. Introduction to Bayesian modeling (David Dunson) 
2. Bayesian modeling in SAS (Amy Herring) 
3. Hierarchical models (Rich MacLehose) 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 

Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 

-
Outline 
Illustrative example 
Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 
Background on Perchlorate 
I Contaminant found in groundwater, drinking water & soils ­
mainly in southwest US 

-
I
I
Outline 
Illustrative example 
Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 
Background on Perchlorate 
Contaminant found in groundwater, drinking water & soils ­
mainly in southwest US 
Primary source industrial & military - perchlorate used as 
oxidizing agent (e.g., in rocket fuel) 

-
I
I
I
Outline 
Illustrative example 
Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 
Background on Perchlorate 
Contaminant found in groundwater, drinking water & soils ­
mainly in southwest US 
Primary source industrial & military - perchlorate used as 
oxidizing agent (e.g., in rocket fuel) 
Concern about eﬀects of perchlorate on the thyroid (known to 
inhibit thyroid’s ability to absorb iodine from the blood) 

-
I
I
I
I
Outline 
Illustrative example 
Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 
Background on Perchlorate 
Contaminant found in groundwater, drinking water & soils ­
mainly in southwest US 
Primary source industrial & military - perchlorate used as 
oxidizing agent (e.g., in rocket fuel) 
Concern about eﬀects of perchlorate on the thyroid (known to 
inhibit thyroid’s ability to absorb iodine from the blood) 
EPA conducted extensive risk assessment - NAS review of 
health eﬀects (recommended new reference dose) 

-
I
Outline 
Illustrative example 
Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 
Two Generation Rodent Study (Argus, 1999) 
Male rats were exposed to ammonium perchlorate through 
drinking water 

-
I
I
Outline 
Illustrative example 
Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 
Two Generation Rodent Study (Argus, 1999) 
Male rats were exposed to ammonium perchlorate through 
drinking water 
30 rats/group with doses of 0, 0.01, 0.1, 1.0 & 30 mg/kg/day 

-
I
I
I
Outline 
Illustrative example 
Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 
Two Generation Rodent Study (Argus, 1999) 
Male rats were exposed to ammonium perchlorate through 
drinking water 
30 rats/group with doses of 0, 0.01, 0.1, 1.0 & 30 mg/kg/day 
Male rats in P1 generation exposed 70+ days before mating, 
through mating period & until sacriﬁce at 21-22 weeks 

-
I
I
I
I
Outline 
Illustrative example 
Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 
Two Generation Rodent Study (Argus, 1999) 
Male rats were exposed to ammonium perchlorate through 
drinking water 
30 rats/group with doses of 0, 0.01, 0.1, 1.0 & 30 mg/kg/day 
Male rats in P1 generation exposed 70+ days before mating, 
through mating period & until sacriﬁce at 21-22 weeks 
F1 generation treated similarly, with additional exposure 
during gestation & lactation 

-
I
I
I
I
I
Outline 
Illustrative example 
Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 
Two Generation Rodent Study (Argus, 1999) 
Male rats were exposed to ammonium perchlorate through 
drinking water 
30 rats/group with doses of 0, 0.01, 0.1, 1.0 & 30 mg/kg/day 
Male rats in P1 generation exposed 70+ days before mating, 
through mating period & until sacriﬁce at 21-22 weeks 
F1 generation treated similarly, with additional exposure 
during gestation & lactation 
At 19 weeks for F1 rats, thyroid tissues examined histologically 

-
I
I
I
I
I
I
Outline 
Illustrative example 
Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 
Two Generation Rodent Study (Argus, 1999) 
Male rats were exposed to ammonium perchlorate through 
drinking water 
30 rats/group with doses of 0, 0.01, 0.1, 1.0 & 30 mg/kg/day 
Male rats in P1 generation exposed 70+ days before mating, 
through mating period & until sacriﬁce at 21-22 weeks 
F1 generation treated similarly, with additional exposure 
during gestation & lactation 
At 19 weeks for F1 rats, thyroid tissues examined histologically 
2/30 male rats in 30 mg/kg/day dose group had thyroid 
follicular cell adenomas, with one of these rats having two 
adenomas. 

-
I
Outline 
Illustrative example 
Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
 
 
 
 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 
Analyzing the Perchlorate data
Frequentist analysis: comparing 0/30 tumors in control rats 
with 2/30 tumors in the high dose group - non-signiﬁcant 
(Fisher’s exact test p-value=0.49) 

-
I
I
Outline 
Illustrative example 
Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
 
 
 
 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Analyzing the Perchlorate data
Frequentist analysis: comparing 0/30 tumors in control rats 
with 2/30 tumors in the high dose group - non-signiﬁcant 
(Fisher’s exact test p-value=0.49) 
Ignores the prior knowledge that thyroid follicular cell 
adenomas are very rare in 19 week rats 
Introduction to Bayesian Modeling of Epidemiologic Data 

-
I
I
I
Outline 
Illustrative example 
Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 
Frequentist analysis
Analyzing the Perchlorate data 
: comparing 0/30 tumors in control rats 
with 2/30 tumors in the high dose group - non-signiﬁcant 
(Fisher’s exact test p-value=0.49) 
Ignores the prior knowledge that thyroid follicular cell 
adenomas are very rare in 19 week rats 
The National Toxicology Program (NTP) routinely collects 
tumor incidence data for control rats in two year studies. 

-
I
I
I
I
Outline 
Illustrative example 
Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 
Analyzing the Perchlorate data 
Frequentist analysis: comparing 0/30 tumors in control rats 
with 2/30 tumors in the high dose group - non-signiﬁcant 
(Fisher’s exact test p-value=0.49) 
Ignores the prior knowledge that thyroid follicular cell 
adenomas are very rare in 19 week rats 
The National Toxicology Program (NTP) routinely collects 
tumor incidence data for control rats in two year studies. 
Would our conclusion change if we included information from 
the NTP data base? 

-
I
Outline 
Illustrative example 
Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 
Some prior information 
In 67 recent NTP studies, 38/3419 = 1.1% of male rats 
developed thyroid follicular cell adenomas by death in a two 
year study. 

-
I
I
Outline 
Illustrative example 
Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
 
 
 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 
Some prior information
In 67 recent NTP studies, 38/3419 = 1.1% of male rats 
developed thyroid follicular cell adenomas by death in a two 
year study. 
Results from Portier et al. (1986) suggest probability of 
developing thyroid follicular cell adenoma increases in 
proportion to age4.78

-
I
I
I
Outline 
Illustrative example 
Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Some prior information
Introduction to Bayesian Modeling of Epidemiologic Data 
In 67 recent NTP studies, 38/3419 = 1.1% of male rats 
developed thyroid follicular cell adenomas by death in a two 
year study. 
Results from Portier et al. (1986) suggest probability of 
developing thyroid follicular cell adenoma increases in 
4.78
proportion to age
Average survival time in NTP study for control male rat is 
95.2 weeks 

-
I
I
I
I
Outline 
Illustrative example 
Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 
In 67 recent NTP studies, 38/3419 = 1.1% of male rats 
developed thyroid follicular cell adenomas by death in a two 
year study. 
Some prior information 
Results from Portier et al. (1986) suggest probability of 
developing thyroid follicular cell adenoma increases in 
4.78
proportion to age
Average survival time in NTP study for control male rat is 
95.2 weeks 
Suggests that the ratio of probability of thyroid follicular cell 
adenomas at 19 weeks to the lifetime probability in a 2-year 
study is (19/95.2)4.78 = 0.0005 

-
I
I
I
I
I
Outline 
Illustrative example 
Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 
Some prior information 
In 67 recent NTP studies, 38/3419 = 1.1% of male rats 
developed thyroid follicular cell adenomas by death in a two 
year study. 
Results from Portier et al. (1986) suggest probability of 
developing thyroid follicular cell adenoma increases in 
4.78
proportion to age
Average survival time in NTP study for control male rat is 
95.2 weeks 
Suggests that the ratio of probability of thyroid follicular cell 
adenomas at 19 weeks to the lifetime probability in a 2-year 
study is (19/95.2)4.78 = 0.0005 
Question: How do we incorporate this information in analysis? 

I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 
Frequentist vs Bayes 
Suppose we are interested in a parameter α (e.g., probability 
of thyroid FCA by 19 weeks in control rats) 

I
I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 
Frequentist vs Bayes 
Suppose we are interested in a parameter α (e.g., probability 
of thyroid FCA by 19 weeks in control rats) 
Frequentists would typically rely on the MLE, which would be 
α = 0/30 = 0 in the perchlorate example 
e

I
I
I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 
Frequentist vs Bayes 
Suppose we are interested in a parameter α (e.g., probability 
of thyroid FCA by 19 weeks in control rats) 
Frequentists would typically rely on the MLE, which would be 
α = 0/30 = 0 in the perchlorate example 
e
Bayesians instead rely on the posterior distribution of α 

I
I
I
I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 
Frequentist vs Bayes 
Suppose we are interested in a parameter α (e.g., probability 
of thyroid FCA by 19 weeks in control rats) 
Frequentists would typically rely on the MLE, which would be 
α = 0/30 = 0 in the perchlorate example 
e
Bayesians instead rely on the posterior distribution of α 
Obtained in updating one’s prior distribution with the 
likelihood for the data. 

I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 
Bayes’ Rule 
Let γ(α) = prior distribution of parameter α  

I
I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 
Bayes’ Rule 
Let γ(α) = prior distribution of parameter α 
Let L(y |α) = likelihood of data y given parameter α 

I
I
I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 
Bayes’ Rule 
Let γ(α) = prior distribution of parameter α 
Let L(y |α) = likelihood of data y given parameter α 
Then, the posterior is deﬁned as: 
γ(α) L(y |α)
γ(α | y) = 
,
f 
γ(α) L(y | α)dα 
which is the prior × the likelihood divided by a normalizing 
constant 

I
I
I
I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 
Bayes’ Rule 
Let γ(α) = prior distribution of parameter α 
Let L(y |α) = likelihood of data y given parameter α 
Then, the posterior is deﬁned as: 
γ(α) L(y |α)
γ(α | y) = 
,
f 
γ(α) L(y | α)dα 
which is the prior × the likelihood divided by a normalizing 
constant 
The posterior, γ(α | y), represents the state of knowledge 
about α after updating the prior, γ(α), with the information in 
the data, y. 

I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 
Bayesian Updating 
As an example of Bayesian updating, let α=probability of 
preterm birth (PTB) 

I
I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 
Bayesian Updating 
As an example of Bayesian updating, let α=probability of 
preterm birth (PTB) 
Typical choice of prior for α is the beta(a, b) distribution 

I
I
I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 
Bayesian Updating 
As an example of Bayesian updating, let α=probability of 
preterm birth (PTB) 
Typical choice of prior for α is the beta(a, b) distribution 
a, b=hyperparameters characterizing uncertainty in α before 
incorporating information in data from current study 

I
I
I
I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 
Bayesian Updating 
As an example of Bayesian updating, let α=probability of 
preterm birth (PTB) 
Typical choice of prior for α is the beta(a, b) distribution 
a, b=hyperparameters characterizing uncertainty in α before 
incorporating information in data from current study 
a/(a + b)=prior expectation for α & a + b=prior sample size 

I
I
I
I
I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 
As an example of Bayesian updating, let α=probability of 
preterm birth (PTB) 
Bayesian Updating 
Typical choice of prior for α is the beta(a, b) distribution 
a, b=hyperparameters characterizing uncertainty in α before 
incorporating information in data from current study 
a/(a + b)=prior expectation for α & a + b=prior sample size 
beta(1, 1) corresponds to uniform distribution - has as much 
information as two subjects (one with PTB & one without) 

Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
0 
0.1 
0.2 
0.3 
0.4 
0.5 
0.6 
0.7 
0.8 
0.9 
1 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 
Beta prior distributions for diﬀerent hyperparameters 
Be
ta p
ri
or d
is
trib
utions for different hyperparameters

I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 
Preterm Birth Example 
α=probability of preterm birth  

I
I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 
Preterm Birth Example 
α=probability of preterm birth 
Consider two diﬀerent priors: (1) a uniform prior expressing 
ignorance; and (2) a beta(10,90) prior. 

I
I
I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 
Preterm Birth Example 
α=probability of preterm birth 
Consider two diﬀerent priors: (1) a uniform prior expressing 
ignorance; and (2) a beta(10,90) prior. 
The beta(10,90) prior implies a 95% prior probability of 
α E [0.05, 0.17] (wide range of plausible values for probability 
preterm birth) 

I
I
I
I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 
Preterm Birth Example 
α=probability of preterm birth 
Consider two diﬀerent priors: (1) a uniform prior expressing 
ignorance; and (2) a beta(10,90) prior. 
The beta(10,90) prior implies a 95% prior probability of 
α E [0.05, 0.17] (wide range of plausible values for probability 
preterm birth) 
We collect data for 100 women & observe 7/100 preterm 
births. 

Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 
Diﬀerent Priors 
Gr
ap
h 
of
 p
rob
abi
lit
y of pr
et
erm b
irth
 vs. 
prio
rs

I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 
Updating the beta prior 
The beta prior is conjugate to the binomial likelihood  

I
I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
 
 
 
 
Updating the beta prior
The beta prior is conjugate to the binomial likelihood 
For conjugate priors, the posterior γ(α | y) is available 
analytically and has the same form as the prior 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 

I
I
I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
Updating the beta prior 
The beta prior is conjugate to the binomial likelihood 
For conjugate priors, the posterior γ(α | y) is available 
analytically and has the same form as the prior 
Let yi = 1 if woman i has a preterm birth and yi = 0 
otherwise, with Pr(yi = 1) = α 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 

I
I
I
I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
Updating the beta prior 
The beta prior is conjugate to the binomial likelihood 
For conjugate priors, the posterior γ(α | y) is available 
analytically and has the same form as the prior 
Let yi = 1 if woman i has a preterm birth and yi = 0 
otherwise, with Pr(yi = 1) = α 
Likelihood is Bernoulli: L(y | α) = I αyi (1 − α)1−yi 
i 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 

I
I
I
I
I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
Updating the beta prior 
The beta prior is conjugate to the binomial likelihood 
For conjugate priors, the posterior γ(α | y) is available 
analytically and has the same form as the prior 
Let yi = 1 if woman i has a preterm birth and yi = 0 
otherwise, with Pr(yi = 1) = α 
Likelihood is Bernoulli: L(y | α) = I αyi (1 − α)1−yi 
i 
The posterior distribution of α is then 

L
L 
 
γ(α | y) = beta a + 
yi , b + 
(1 − yi ) . 
i
i 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 

Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
Prior and Posteriors 
Gr
ap
h 
of
 p
rob
abi
lit
y o
f p
ret
erm
 birth vs. priors
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 

I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
Returning to the Perchlorate Example 
Let α = ' × p, α=prob tumor in 19 weeks, '=prob tumor in 
lifetime & p=proportion of tumors developing by 19 weeks 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 

I
I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
Returning to the Perchlorate Example 
Let α = ' × p, α=prob tumor in 19 weeks, '=prob tumor in 
lifetime & p=proportion of tumors developing by 19 weeks 
We choose beta(38, 3381) prior for probability of developing 
thyroid FCA for a control male rat in a two-year study (') 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 

I
I
I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
Returning to the Perchlorate Example 
Let α = ' × p, α=prob tumor in 19 weeks, '=prob tumor in 
lifetime & p=proportion of tumors developing by 19 weeks 
We choose beta(38, 3381) prior for probability of developing 
thyroid FCA for a control male rat in a two-year study (') 
Based on the 38/(38 + 3381) rats observed with these tumors 
in NTP studies 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 

I
I
I
I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
Returning to the Perchlorate Example 
Let α = ' × p, α=prob tumor in 19 weeks, '=prob tumor in 
lifetime & p=proportion of tumors developing by 19 weeks 
We choose beta(38, 3381) prior for probability of developing 
thyroid FCA for a control male rat in a two-year study (') 
Based on the 38/(38 + 3381) rats observed with these tumors 
in NTP studies 
We choose beta(0.11, 2.6) prior for ratio: 
probability of developing tumor by 19 weeks 
p = 
. 
probability of developing tumor in two year study 
Centered on 0.0005 with 95% probability of falling within 
[0.0000,0.379] 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 

Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
Prior for proportion of thyroid FCA by 19 weeks () 
Gr
aph
 of
 pr
oba
bili
ty o
f pr
opor
tion
 of 
tumors vs. pri
or
 densi
ty
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 

I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
Conclusions from Perchlorate Example 
α = ' × p=probability of developing thyroid FCA by 19 weeks 
for control male rat 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 

I
I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
Conclusions from Perchlorate Example 
α = ' × p=probability of developing thyroid FCA by 19 weeks 
for control male rat 
We update priors for ' and p with data from the Argus 
(1999) study to obtain posterior distribution for α. 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 

I
I
I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
Conclusions from Perchlorate Example 
α = ' × p=probability of developing thyroid FCA by 19 weeks 
for control male rat 
We update priors for ' and p with data from the Argus 
(1999) study to obtain posterior distribution for α. 
The posterior mean of α is 1/100, 000 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 

I
I
I
I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
Conclusions from Perchlorate Example 
α = ' × p=probability of developing thyroid FCA by 19 weeks 
for control male rat 
We update priors for ' and p with data from the Argus 
(1999) study to obtain posterior distribution for α. 
The posterior mean of α is 1/100, 000 
How likely it is to observe 2 or more rats out of 30 with 
tumors under the null hypothesis of no eﬀect of perchlorate? 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 

I
I
I
I
I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
Conclusions from Perchlorate Example 
α = ' × p=probability of developing thyroid FCA by 19 weeks 
for control male rat 
We update priors for ' and p with data from the Argus 
(1999) study to obtain posterior distribution for α. 
The posterior mean of α is 1/100, 000 
How likely it is to observe 2 or more rats out of 30 with 
tumors under the null hypothesis of no eﬀect of perchlorate? 
This probability is < 1/100, 000 - data support causal eﬀect 
of perchlorate on increased thyroid tumor incidence 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 

I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
More Complex Models 
Posterior calculation for preterm birth example relied on 
conjugate prior 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 

I
I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
More Complex Models 
Posterior calculation for preterm birth example relied on 
conjugate prior 
Posterior calculation for perchlorate example relied on numeric 
integration - easy for two parameters 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 

I
I
I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
More Complex Models 
Posterior calculation for preterm birth example relied on 
conjugate prior 
Posterior calculation for perchlorate example relied on numeric 
integration - easy for two parameters 
For epidemiologic analyses (e.g., logistic regression, survival 
analysis), conjugate priors not available & dimension high 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 

I
I
I
I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
Posterior calculation for preterm birth example relied on 
More Complex Models 
conjugate prior 
Posterior calculation for perchlorate example relied on numeric 
integration - easy for two parameters 
For epidemiologic analyses (e.g., logistic regression, survival 
analysis), conjugate priors not available & dimension high 
In such settings, there are multiple parameters in α and one 
needs to compute the joint posterior: 
γ(α) L(y |α)
γ(α | y) = 
.
f 
γ(α) L(y | α)dα 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 

I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
Example: Bayesian Logistic Regression 
Logistic regression model: 
'
logit Pr(yi = 1 | xi , () = x (,
i 
with xi = (1, xi2, . . . , xip)' a vector of predictors & 
( = (ρ1, . . . , ρp )' coeﬃcients for these predictors 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 

I
I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
Example: Bayesian Logistic Regression 
Logistic regression model: 
' 
logit Pr(yi = 1 | xi , () = xi (, 
with xi = (1, xi2, . . . , xip)' a vector of predictors & 
( = (ρ1, . . . , ρp )' coeﬃcients for these predictors 
A Bayesian speciﬁcation of the model is completed with a 
prior for the coeﬃcients, γ(() = Np((0, I). 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 

I
I
I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
Example: Bayesian Logistic Regression 
Logistic regression model: 
' 
logit Pr(yi = 1 | xi , () = xi (, 
with xi = (1, xi2, . . . , xip)' a vector of predictors & 
( = (ρ1, . . . , ρp )' coeﬃcients for these predictors 
A Bayesian speciﬁcation of the model is completed with a 
prior for the coeﬃcients, γ(() = Np((0, I). 
Here, (0 is one’s best guess at the coeﬃcient values prior to 
observing the data from the current study 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 

I
I
I
I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
Example: Bayesian Logistic Regression 
Logistic regression model: 
' 
logit Pr(yi = 1 | xi , () = xi (, 
with xi = (1, xi2, . . . , xip)' a vector of predictors & 
( = (ρ1, . . . , ρp )' coeﬃcients for these predictors 
A Bayesian speciﬁcation of the model is completed with a 
prior for the coeﬃcients, γ(() = Np((0, I). 
Here, (0 is one’s best guess at the coeﬃcient values prior to 
observing the data from the current study 
I=covariance matrix quantifying uncertainty in this guess 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 

I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
Some Diﬀerent Possibilities for the Prior 
I. Informative Prior 
Review literature & choose a prior to be centered on previous 
estimates of coeﬃcients. 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 

I
I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
Some Diﬀerent Possibilities for the Prior 
I. Informative Prior 
Review literature & choose a prior to be centered on previous 
estimates of coeﬃcients. 
In the absence of previous estimates, choose a subjective value 
synthesizing knowledge of the literature 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 

I
I
I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
Some Diﬀerent Possibilities for the Prior 
I. Informative Prior 
Review literature & choose a prior to be centered on previous 
estimates of coeﬃcients. 
In the absence of previous estimates, choose a subjective value 
synthesizing knowledge of the literature 
Prior variance chosen so that a 90 or 95% prior interval 
contains a wide range of plausible values 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 

I
I
I
I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
Some Diﬀerent Possibilities for the Prior 
I. Informative Prior 
Review literature & choose a prior to be centered on previous 
estimates of coeﬃcients. 
In the absence of previous estimates, choose a subjective value 
synthesizing knowledge of the literature 
Prior variance chosen so that a 90 or 95% prior interval 
contains a wide range of plausible values 
Useful to choose informative priors for intercept and 
confounding coeﬃcients, as there is typically substantial 
information about these coeﬃcients 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 

I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
Some Possible Priors (continued) 
II. Shrinkage Priors 
Choose a prior centered on zero with modest variance 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 

I
I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
Some Possible Priors (continued) 
II. Shrinkage Priors 
Choose a prior centered on zero with modest variance 
When little information is available about a parameter, results 
in shrinkage towards zero 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 

I
I
I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
Some Possible Priors (continued) 
II. Shrinkage Priors 
Choose a prior centered on zero with modest variance 
When little information is available about a parameter, results 
in shrinkage towards zero 
Avoids unstable estimates - particularly problematic in high 
dimensions & for correlated predictors. 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 

I
I
I
I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
Some Possible Priors (continued) 
II. Shrinkage Priors 
Choose a prior centered on zero with modest variance 
When little information is available about a parameter, results 
in shrinkage towards zero 
Avoids unstable estimates - particularly problematic in high 
dimensions & for correlated predictors. 
As more information becomes available that the parameter 
(e.g., the exposure odds ratio) is non-zero, the likelihood will 
dominate. 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 

I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
Some Possible Priors (continued)
 
 
 
 
III. Non-Informative Priors 
Choose a prior that has high variance or is ﬂat in some sense 
to express ignorance about the parameter value 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 

I
I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
Some Possible Priors (continued) 
III. Non-Informative Priors 
Choose a prior that has high variance or is ﬂat in some sense 
to express ignorance about the parameter value 
Often yields similar results to maximum likelihood - what’s 
the point? 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 

I
I
I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
Some Possible Priors (continued) 
III. Non-Informative Priors 
Choose a prior that has high variance or is ﬂat in some sense 
to express ignorance about the parameter value 
Often yields similar results to maximum likelihood - what’s 
the point? 
No prior is truly non-informative - ﬂat or high variance priors 
assign most of their probability outside a plausible range for 
the parameter values. 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 

I
I
I
I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
Some Possible Priors (continued) 
III. Non-Informative Priors 
Choose a prior that has high variance or is ﬂat in some sense 
to express ignorance about the parameter value 
Often yields similar results to maximum likelihood - what’s 
the point?  
No prior is truly non-informative - ﬂat or high variance priors  
assign most of their probability outside a plausible range for  
the parameter values.  
Can lead to poor results when insuﬃcient information 
available about a given parameter in the current data set ­
typically, the case when many predictors are collected. 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 

I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
Bayes Logistic Regression (continued) 
Posterior distribution: 
Np((; (0, I) In 
L(yi ; xi , ()
l=1
γ(( | y) = 
,
f 
Np ((; (0, I) In 
L(yi ; xi , ()d(
l=1 
where L(yi ; xi , () is the likelihood contribution for individual i 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 

I
I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
Bayes Logistic Regression (continued) 
Posterior distribution: 
Np((; (0, I) In 
L(yi ; xi , ()
l=1
γ(( | y) = 
,
f 
Np ((; (0, I) In 
L(yi ; xi , ()d(
l=1 
where L(yi ; xi , () is the likelihood contribution for individual i 
Note that we can write the numerator in this expression in 
closed form 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 

I
I
I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
Bayes Logistic Regression (continued) 
Posterior distribution: 
Np((; (0, I) In 
L(yi ; xi , ()
l=1
γ(( | y) = 
,
f 
Np ((; (0, I) In 
L(yi ; xi , ()d(
l=1 
where L(yi ; xi , () is the likelihood contribution for individual i 
Note that we can write the numerator in this expression in 
closed form 
However, the denominator involves a nasty high-dimensional 
integral that has no analytic solution. 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 

I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
Calculating the Posterior Distribution 
To calculate the posterior, one can potentially rely on a large 
sample approximation 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 

I
I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
Calculating the Posterior Distribution 
To calculate the posterior, one can potentially rely on a large 
sample approximation 
As n - o, the posterior is normally distributed centered on 
the maximum likelihood estimate 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 

I
I
I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
Calculating the Posterior Distribution 
To calculate the posterior, one can potentially rely on a large 
sample approximation 
As n - o, the posterior is normally distributed centered on 
the maximum likelihood estimate 
Impact of the prior decreases as the sample size increases in 
general 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 

I
I
I
I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
Calculating the Posterior Distribution 
To calculate the posterior, one can potentially rely on a large 
sample approximation 
As n - o, the posterior is normally distributed centered on 
the maximum likelihood estimate 
Impact of the prior decreases as the sample size increases in 
general 
However, even for moderate to large samples, asymptotic 
normal approximation may be inaccurate 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 

I
I
I
I
I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
Calculating the Posterior Distribution 
To calculate the posterior, one can potentially rely on a large 
sample approximation 
As n - o, the posterior is normally distributed centered on 
the maximum likelihood estimate 
Impact of the prior decreases as the sample size increases in 
general 
However, even for moderate to large samples, asymptotic 
normal approximation may be inaccurate 
In logistic regression for rare outcomes or rare exposure 
categories, posterior can be highly skewed 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 

I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
MCMC - Basic Idea 
Markov chain Monte Carlo (MCMC) provides an approach for 
generating samples from the posterior distribution 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 

I
I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
MCMC - Basic Idea 
Markov chain Monte Carlo (MCMC) provides an approach for 
generating samples from the posterior distribution 
This does not give us an approximation to γ(α | y) directly 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 

I
I
I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
MCMC - Basic Idea 
Markov chain Monte Carlo (MCMC) provides an approach for 
generating samples from the posterior distribution 
This does not give us an approximation to γ(α | y) directly 
However, from these samples we can obtain summaries of the 
posterior distribution for α 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 

I
I
I
I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
MCMC - Basic Idea 
Markov chain Monte Carlo (MCMC) provides an approach for 
generating samples from the posterior distribution 
This does not give us an approximation to γ(α | y) directly 
However, from these samples we can obtain summaries of the 
posterior distribution for α 
Summaries of exact posterior distributions of g(α), for any 
functional g(·), can also be obtained. 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 

I
I
I
I
I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
MCMC - Basic Idea 
Markov chain Monte Carlo (MCMC) provides an approach for 
generating samples from the posterior distribution 
This does not give us an approximation to γ(α | y) directly 
However, from these samples we can obtain summaries of the 
posterior distribution for α 
Summaries of exact posterior distributions of g(α), for any 
functional g(·), can also be obtained. 
For example, if α is the log-odds ratio, then we could choose 
g(α) = exp(α) to obtain the odds ratio 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 

I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
How does MCMC work? 
Let αt = (α1
t , . . . , αp
t ) denote the value of the p × 1 vector of 
parameters at iteration t. 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 

I
I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
How does MCMC work? 
Let αt = (α1
t , . . . , αp
t ) denote the value of the p × 1 vector of 
parameters at iteration t. 
α0 = initial value used to start the chain (shouldn’t be 
sensitive) 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 

I
I
I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
How does MCMC work? 
Let αt = (αt , . . . , αt ) denote the value of the p × 1 vector of 
1
p
parameters at iteration t.  
α0 = initial value used to start the chain (shouldn’t be  
sensitive)  
MCMC generates αt from a distribution that depends on the  
data & potentially on αt−1, but not on α1, . . . , αt−2 .  
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 

I
I
I
I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
How does MCMC work? 
Let αt = (α1
t , . . . , αp
t ) denote the value of the p × 1 vector of 
parameters at iteration t.  
α0 = initial value used to start the chain (shouldn’t be  
sensitive)  
MCMC generates αt from a distribution that depends on the  
data & potentially on αt−1, but not on α1, . . . , αt−2 .  
This results in a Markov chain with stationary distribution  
γ(α | y) under some conditions on the sampling distribution  
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 

I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
Diﬀerent ﬂavors of MCMC 
The most commonly used MCMC algorithms are:  
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 

I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
Diﬀerent ﬂavors of MCMC 
The most commonly used MCMC algorithms are: 
I Metropolis sampling (Metropolis et al., 1953) 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 

I
I
I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
Diﬀerent ﬂavors of MCMC 
The most commonly used MCMC algorithms are: 
Metropolis sampling (Metropolis et al., 1953) 
Metropolis-Hastings (MH) (Hastings, 1970) 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 

I
I
I
I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
Diﬀerent ﬂavors of MCMC 
The most commonly used MCMC algorithms are: 
Metropolis sampling (Metropolis et al., 1953) 
Metropolis-Hastings (MH) (Hastings, 1970) 
Gibbs sampling (Geman & Geman, 1984; Gelfand & Smith, 
1990) 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 

I
I
I
I
I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
Diﬀerent ﬂavors of MCMC 
The most commonly used MCMC algorithms are: 
Metropolis sampling (Metropolis et al., 1953)  
Metropolis-Hastings (MH) (Hastings, 1970)  
Gibbs sampling (Geman & Geman, 1984; Gelfand & Smith,  
1990)  
Easy overview of Gibbs - Casella & George (1992, The 
American Statistician, 46, 167-174) 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 

I
I
I
I
I
I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
Diﬀerent ﬂavors of MCMC 
The most commonly used MCMC algorithms are: 
Metropolis sampling (Metropolis et al., 1953)  
Metropolis-Hastings (MH) (Hastings, 1970)  
Gibbs sampling (Geman & Geman, 1984; Gelfand & Smith,  
1990)  
Easy overview of Gibbs - Casella & George (1992, The 
American Statistician, 46, 167-174) 
Easy overview of MH - Chib & Greenberg (1995, The 
American Statistician) 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 

I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
Gibbs Sampling 
Start with initial value α0 = (α1
0, . . . , αp
0) 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 

I
I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
Gibbs Sampling 
Start with initial value α0 = (α1
0, . . . , αp
0) 
For iterations t = 1, . . . , T , 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 

I
I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
Gibbs Sampling 
Start with initial value α0 = (α1
0, . . . , αp
0) 
For iterations t = 1, . . . , T , 
1. Sample Bt from the conditional posterior distribution 
1 
= Bt−1 
= Bt−1
(B1 | B2
2 
, . . . , Bp
p 
, y) 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 

I
I


Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
Gibbs Sampling 
Start with initial value α0 = (α1
0, . . . , αp
0) 
For iterations t = 1, . . . , T , 
1. Sample Bt from the conditional posterior distribution 
1 
= Bt−1 
= Bt−1
(B1 | B2
2 
, . . . , Bp
p 
, y) 
2. Sample Bt from the conditional posterior distribution 
2 
(B2 | B1 = Bt , B3 = Bt−1, . . . , Bp = Bt−1 , y)
1
3 
p 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 

I
I


Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
Gibbs Sampling 
Start with initial value α0 = (α1
0, . . . , αp
0) 
For iterations t = 1, . . . , T , 
1. Sample Bt from the conditional posterior distribution 
1 
= Bt−1 
= Bt−1
(B1 | B2
2 
, . . . , Bp
p 
, y) 
2. Sample Bt from the conditional posterior distribution 
2 
(B2 | B1 = Bt , B3 = Bt−1, . . . , Bp = Bt−1 , y)
1
3 
p 
3. Similarly, sample B3
t , . . . , Bp
t from the conditional posterior 
distributions given current values of other parameters. 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 

I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
Gibbs Sampling (continued) 
Under mild regularity conditions, samples converge to 
stationary distribution γ(α | y) 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 

I
I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
Gibbs Sampling (continued) 
Under mild regularity conditions, samples converge to 
stationary distribution γ(α | y) 
At the start of the sampling, the samples are not from the 
posterior distribution γ(α | y). 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 

I
I
I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
Gibbs Sampling (continued) 
Under mild regularity conditions, samples converge to  
stationary distribution γ(α | y)  
At the start of the sampling, the samples are not from the  
posterior distribution γ(α | y).  
It is necessary to discard the initial samples as a burn-in to 
allow convergence 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 

I
I
I
I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
Gibbs Sampling (continued) 
Under mild regularity conditions, samples converge to  
stationary distribution γ(α | y)  
At the start of the sampling, the samples are not from the  
posterior distribution γ(α | y).  
It is necessary to discard the initial samples as a burn-in to  
allow convergence  
In simple models such as logistic regression, convergence 
typically occurs quickly & burn-in of 100 iterations should be 
suﬃcient (to be conservative SAS uses 2,000 as default) 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 

I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
Example - DDE & Preterm Birth 
Scientiﬁc interest: Association between DDE exposure &  
preterm birth adjusting for possible confounding variables  
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 

I
I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
Example - DDE & Preterm Birth 
Scientiﬁc interest: Association between DDE exposure & 
preterm birth adjusting for possible confounding variables 
Data from US Collaborative Perinatal Project (CPP) - n = 
2380 children out of which 361 were born preterm 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 

I
I
I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
Example - DDE & Preterm Birth 
Scientiﬁc interest: Association between DDE exposure & 
preterm birth adjusting for possible confounding variables 
Data from US Collaborative Perinatal Project (CPP) - n = 
2380 children out of which 361 were born preterm 
Analysis: Bayesian analysis using a probit model: 
Pr(yi = 1 | xi , ρ) = (ρ1 + ρ2ddei + ρ3zi1 + · · · + ρ7zi5). 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 

I
I
I
I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
Example - DDE & Preterm Birth 
Scientiﬁc interest: Association between DDE exposure & 
preterm birth adjusting for possible confounding variables 
Data from US Collaborative Perinatal Project (CPP) - n = 
2380 children out of which 361 were born preterm 
Analysis: Bayesian analysis using a probit model: 
Pr(yi = 1 | xi , ρ) = (ρ1 + ρ2ddei + ρ3zi1 + · · · + ρ7zi5). 
Chose normal prior with mean 0 and variance 4. 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 

I
I
I
I
I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
Example - DDE & Preterm Birth 
Scientiﬁc interest: Association between DDE exposure & 
preterm birth adjusting for possible confounding variables 
Data from US Collaborative Perinatal Project (CPP) - n = 
2380 children out of which 361 were born preterm 
Analysis: Bayesian analysis using a probit model: 
Pr(yi = 1 | xi , ρ) = (ρ1 + ρ2ddei + ρ3zi1 + · · · + ρ7zi5). 
Chose normal prior with mean 0 and variance 4. 
Probit model is similar to logistic regression, but with diﬀerent 
link 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 

Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
Gibbs Sampling output for preterm birth example Gibbs sampling output
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 

Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
Estimated Posterior Density Graph of DDE slope (beta 1) vs. Posterior Density
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 

I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
Some MCMC Terminology 
Convergence: initial drift in the samples towards a stationary 
distribution 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 

I
I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
Some MCMC Terminology 
Convergence: initial drift in the samples towards a stationary 
distribution 
Burn-in: samples at start of the chain that are discarded to 
allow convergence 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 

I
I
I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
Some MCMC Terminology 
Convergence: initial drift in the samples towards a stationary 
distribution 
Burn-in: samples at start of the chain that are discarded to 
allow convergence 
Slow mixing: tendency for high autocorrelation in the samples. 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 

I
I
I
I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
Some MCMC Terminology 
Convergence: initial drift in the samples towards a stationary 
distribution 
Burn-in: samples at start of the chain that are discarded to 
allow convergence 
Slow mixing: tendency for high autocorrelation in the samples. 
Thinning: practice of collecting every kth iteration to reduce 
autocorrelation 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 

I
I
I
I
I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
Some MCMC Terminology 
Convergence: initial drift in the samples towards a stationary 
distribution 
Burn-in: samples at start of the chain that are discarded to 
allow convergence 
Slow mixing: tendency for high autocorrelation in the samples. 
Thinning: practice of collecting every kth iteration to reduce 
autocorrelation 
Trace plot: plot of sampled values of a parameter vs iteration 
# 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 

Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
David Dun
miologic Data 
Example - trace plot with poor mixing 
G Non-Centered
V1

I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
Poor mixing Gibbs sampler 
Exhibits “snaking” behavior in trace plot with cyclic local 
trends in the mean 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 

I
I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
Poor mixing Gibbs sampler 
Exhibits “snaking” behavior in trace plot with cyclic local 
trends in the mean 
Poor mixing in the Gibbs sampler caused by high posterior 
correlation in the parameters 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 

I
I
I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
Poor mixing Gibbs sampler 
Exhibits “snaking” behavior in trace plot with cyclic local 
trends in the mean 
Poor mixing in the Gibbs sampler caused by high posterior 
correlation in the parameters 
Decreases eﬃciency & many more samples need to be 
collected to maintain low Monte Carlo error in posterior 
summaries 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 

I
I
I
I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
Poor mixing Gibbs sampler 
Exhibits “snaking” behavior in trace plot with cyclic local 
trends in the mean 
Poor mixing in the Gibbs sampler caused by high posterior 
correlation in the parameters 
Decreases eﬃciency & many more samples need to be 
collected to maintain low Monte Carlo error in posterior 
summaries 
For very poor mixing chain, may even need millions of 
iterations. 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 

I
I
I
I
I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
Poor mixing Gibbs sampler 
Exhibits “snaking” behavior in trace plot with cyclic local 
trends in the mean 
Poor mixing in the Gibbs sampler caused by high posterior 
correlation in the parameters 
Decreases eﬃciency & many more samples need to be 
collected to maintain low Monte Carlo error in posterior 
summaries 
For very poor mixing chain, may even need millions of 
iterations. 
Routinely examine trace plots! 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 

Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
David Dunso
Example - trace plot with good mixing 
Gamma Cent Const
Epidemiologic Data 

I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
How to summarize results from the MCMC chain? 
Posterior mean: estimated by average of samples collected 
after discarding burn-in 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 

I
I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
How to summarize results from the MCMC chain? 
Posterior mean: estimated by average of samples collected 
after discarding burn-in 
Posterior mean provides alternative to maximum likelihood 
estimate as a single summary. 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 

I
I
I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
How to summarize results from the MCMC chain? 
Posterior mean: estimated by average of samples collected 
after discarding burn-in 
Posterior mean provides alternative to maximum likelihood 
estimate as a single summary. 
As a Bayesian alternative to the conﬁdence interval, one can 
use a credible interval 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 

I
I
I
I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
How to summarize results from the MCMC chain? 
Posterior mean: estimated by average of samples collected 
after discarding burn-in 
Posterior mean provides alternative to maximum likelihood 
estimate as a single summary. 
As a Bayesian alternative to the conﬁdence interval, one can 
use a credible interval 
The 100(1 − a)% credible interval ranges from the a/2 to 
1 − a/2 empirical percentiles of the collected samples 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 

I
I
I
I
I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
How to summarize results from the MCMC chain? 
Posterior mean: estimated by average of samples collected 
after discarding burn-in 
Posterior mean provides alternative to maximum likelihood 
estimate as a single summary. 
As a Bayesian alternative to the conﬁdence interval, one can 
use a credible interval 
The 100(1 − a)% credible interval ranges from the a/2 to 
1 − a/2 empirical percentiles of the collected samples 
Credible intervals can be calculated for functionals (e.g., odds 
ratios) by ﬁrst applying the function to each MCMC sample 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 

I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
Posterior probabilities 
Often interest focuses on the weight of evidence of H1 : αj > 0 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 

I
I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
Posterior probabilities 
Often interest focuses on the weight of evidence of H1 : αj > 0 
The posterior probability of H1 can be calculated easily from 
the MCMC output as simply the proportion of collected 
samples having αj > 0. 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 

I
I
I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
Posterior probabilities 
Often interest focuses on the weight of evidence of H1 : αj > 0 
The posterior probability of H1 can be calculated easily from 
the MCMC output as simply the proportion of collected 
samples having αj > 0. 
A high value (e.g., greater than 0.95) suggests strong 
evidence in favor of H1 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 

I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
Marginal posterior density estimation 
Summary statistics such as the mean, median, standard 
deviation, etc provide an incomplete picture 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 

I
I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
Marginal posterior density estimation 
Summary statistics such as the mean, median, standard 
deviation, etc provide an incomplete picture 
Since we have many samples from the posterior, we can 
accurately estimate the exact posterior density 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 

I
I
I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
Marginal posterior density estimation 
Summary statistics such as the mean, median, standard 
deviation, etc provide an incomplete picture 
Since we have many samples from the posterior, we can 
accurately estimate the exact posterior density 
This can be done using a kernel-smoothed density estimation 
procedure applied to the samples 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 

I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
How to get started? 
It is not necessary to understand MCMC theory to implement 
Bayesian analyses 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 

I
I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
How to get started? 
It is not necessary to understand MCMC theory to implement 
Bayesian analyses 
WinBUGS is a general software package for implementing 
MCMC in a very broad variety of models 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 

I
I
I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
How to get started? 
It is not necessary to understand MCMC theory to implement 
Bayesian analyses 
WinBUGS is a general software package for implementing 
MCMC in a very broad variety of models 
WinBUGS can accommodate hierarchical models, missing 
data, spatial correlation, etc (Rich will illustrate) 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 

I
I
I
I
Outline 
Illustrative example - Perchlorate & thyroid tumors 
Introduction to Bayesian Statistics 
Bayesian Logistic Regression 
Markov chain Monte Carlo 
How to get started? 
It is not necessary to understand MCMC theory to implement 
Bayesian analyses 
WinBUGS is a general software package for implementing 
MCMC in a very broad variety of models 
WinBUGS can accommodate hierarchical models, missing 
data, spatial correlation, etc (Rich will illustrate) 
SAS also has several new Bayes Procs available (Amy will 
illustrate) 
David Dunson1, Amy Herring2 & Rich MacLehose1 
Introduction to Bayesian Modeling of Epidemiologic Data 

